./  ADD  SSI=33380065,NAME=IEE0603D
         TITLE 'SET COMMAND SYNTAX CHECKER - MODULE IEE0603D'           00030002
IEE0603D CSECT                                                          00032001
* C 000798,001874-001877,128292-128392                           YM4026 00032401
* D 000983-000984,001762,126792-127292,146792-148292             YM4026 00032801
*********************************************************************** 00034001
*                                                                     * 00036001
*TITLE:  IEE0603D---SET COMMAND SYNTAX CHECKER - MODULE IEE0603D      * 00038002
*                                                                     * 00038401
*FUNCTION: ACCEPTS THE PARAMETERS OF THE SET COMMAND: CLOCK,    Y01040* 00038801
*   DATE, RESET, AND IPS, PLUS THE GMT AND ADDR PARAMETERS      Y02759* 00039202
*   (VALID ONLY DURING IPL, VARY CPU ONLINE, AND TOD CLOCK      Y02759* 00039902
*   RECOVERY) AND PROCEEDS AS FOLLOWS:                          Y02759* 00040602
*   IF TIME AND/OR DATE IS SPECIFIED WITHOUT GMT, OR IF RESET   Y02759* 00041302
*   IS SPECIFIED, IEE6503D IS CALLED.  IF GMT OR ADDR IS        Y02759* 00042002
*   SPECIFIED, IEE6603D IS CALLED.  ON RETURN FROM EITHER,      Y02759* 00042702
*   IF IPS WAS SPECIFIED, CONTROL IS PASSED TO IEE0803D.        Y02759* 00043402
*   OTHERWISE, CONTROL IS RETURNED TO THE CALLER.               Y02759* 00044102
*   IN ADDITION, POSITIVE SYNTAX CHECKING IS PERFORMED ON KEYWORDS    * 00044802
*   AND PARAMETERS.                                                   * 00046002
*                                                                     * 00047202
*ENTRY POINT: IEE0603D - FROM COMMAND ROUTER MODULE, IEE0403D.        * 00048402
*ATTRIBUTES: REENTRANT, READ ONLY AND SELF-RELOCATABLE.         Y01040* 00049602
*                                                                     * 00050802
*EXTERNAL REFERENCES:                                                 * 00052002
*   MASTER RESIDENT CORE, USING MACRO IEEBASEA                        * 00053202
*   EXTENDED SAVE AREA(XSA), USING MACRO IEEXSA                       * 00054402
*   COMMUNICATIONS VECTOR TABLE USING MACRO CVT                       * 00055602
*   TIMER SUPERVISOR WORKAREA(TPC), USING MACRO IEAVVTPC        Y02759* 00056002
*   TOD CLOCK WORKAREA                                          Y02759* 00056402
*                                                                     * 00056802
*MACROS: IEEXSA, IEEBASEA, AND CVT                              Y01040* 00058002
*                                                                     * 00059202
*INPUT: REGISTER 2 POINTING TO THE EXTENDED SAVE AREA WHICH MUST      * 00060402
*   CONTAIN: IN XAR, A POINTER TO THE COMMAND BUFFER                  * 00061602
*            IN XAL, A POINTER TO THE PARAMETER LIST (FIRST KEYWORD)  * 00062802
*       REGISTER 10 POINTING TO MASTER RESIDENT CORE (IEEBASEA)   M2081 00064002
*                                                                     * 00065202
*OUTPUT: FOR A NORMAL EXIT TO IEE6503D, THE SET LOCAL TIME ROUTINE:   * 00066402
*          R2 POINTS TO THE EXTENDED SAVE AREA:                 Y02759* 00068402
*          XAS CONTAINS THE TIME (IF SPECIFIED)                 Y02759* 00069002
*          XAV CONTAINS THE DATE (IF SPECIFIED)                 Y02759* 00069602
*                                                                     * 00070402
*        FOR A NORMAL EXIT TO IEE6603D, THE SET TOD CLOCK ROUTINE:    * 00072002
*          R2 POINTS TO THE EXTENDED SAVE AREA:                 Y02759* 00072102
*          XAS CONTAINS THE TIME (IF SPECIFIED)                 Y02759* 00072302
*          XAV CONTAINS THE DATE (IF SPECIFIED)                 Y02759* 00072502
*          IF ADDR WAS SPECIFIED, THE FIRST LOGICAL TCWA        Y02759* 00072702
*          ENTRY AND THE ONE FOR THE SPECIFIED ADDRESS HAVE     Y02759* 00072902
*          BEEN EXCHANGED.                                      Y02759* 00073102
*                                                                     * 00073802
*        FOR A NORMAL EXIT TO IEE0803D, THE CSCB CREATION ROUTINE:    * 00073902
*          R2 POINTS TO THE EXTENDED SAVE AREA:                 Y02759* 00074702
*          XAL CONTAINS A POINTER TO THE FIRST PARAMETER        Y02759* 00075302
*          XAU CONTAINS THE UCMI                                Y02759* 00075902
*          XAR CONTAINS A POINTER TO THE COMMAND BUFFER         Y02759* 00076502
*          XAA CONTAINS THE ASID                                Y02759* 00077102
*          XAN CONTAINS THE VERB CODE                           Y02759* 00077702
*                                                                     * 00078602
*        FOR AN ERROR EXIT TO IEE0503D, THE MESSAGE ASSEMBLER:        * 00078902
*          R2 POINTS TO THE EXTENDED SAVE AREA WHICH CONTAINS:        * 00079202
*           IN XAE, THE MESSAGE CODE (SEE ERROR MESSAGES BELOW)       * 00079802
*           IN XAV, THE VERB IN EBCDIC, LEFT ADJUSTED WITH BLANKS     * 00080602
*                                                                     * 00081402
*EXITS: NORMAL - TO IEE0803D,CALLER                             Y02759* 00082202
*       ERROR  - TO THE MESSAGE ASSEMBLY MODULE, IEE0503D             * 00083002
*                                                                     * 00083802
         EJECT                                                          00084602
*ERROR MESSAGES: THE FOLLOWING CONDITIONS GENERATE THE INDICATED      * 00085402
*   MESSAGES:                                                         * 00086202
*      1.NON-INTERNAL SET COMMAND ISSUED IN TOD CLOCK SYSTEM      20071 00087002
*        'IEE305I SET      COMMAND INVALID'         (CODE=5)    Y01040* 00088602
*      2.NON-NUMERIC OR EXCESSIVE CHARACTERS IN TIME OR DATE, OR THE  * 00089402
*        DAY DATE IS ZERO, OR A NON-LEAP YEAR HAVING 366 DAYS   YM1821* 00090202
*        'IEE306I          INVALID NUMERICS'        (CODE=6)    Y01040* 00091002
*      3.MISPLACED PERIODS IN CLOCK OR DATE PARAMETER                 * 00091802
*        'IEE307I          DELIMITER ERROR'         (CODE=7)    Y01040* 00092602
*      4.FAILURE TO FIND BLANK, COMMA OR END OF BUFFER AFTER PARAMETER* 00093402
*        'IEE308I          TERM LENGTH ERROR'       (CODE=8)    Y01040* 00094202
*      5.KEYWORD NOT FOUND IN KEYWORD TABLE                           * 00095002
*        'IEE309I          KEYWORD MISSPELLED'      (CODE=9)    Y01040* 00095802
*      6.NO KEYWORD,                                                  * 00096602
*        DATE NOT SPECIFIED WHEN CLOCK HAS TO BE SET            Y02759* 00097402
*        'IEE310I          KEYWORD MISSING'         (CODE=10)   Y01040* 00098202
*      7.BLANK AFTER KEYWORD                                          * 00099002
*        'IEE311I          PARAMETER MISSING'       (CODE=11)   Y01040* 00099802
*      8.REPEATED KEYWORD                                             * 00100602
*        'IEE312I SET      PARAMETERS CONFLICT'     (CODE=12)   Y01040* 00103802
*      9.KEYWORD SPECIFIED IS INVALID IN THIS CONTEXT                 * 00104202
*        'IEE535I          INVALID PARAMETER'       (CODE=62)   Y02759* 00104302
*                                                                     * 00104602
* NOTE- IF AN ERROR OCCURS, A CODE OF X'FF' IS PLACED IN        Y02759* 00105602
*       BAIPL(IPL ECB) TO INDICATE THAT AN ERROR OCCURRED       Y02759* 00106502
*       ON THE SET COMMAND.                                     Y02759* 00107402
*                                                                       00108401
*OPERATION:                                                             00108602
*   EACH INCOMING COMMAND HAS ITS LEADING KEYWORD COMPARED WITH A     * 00108701
*   TABLE (KEYTAB) CONTAINING EACH OF THE SIX POSSIBLE          Y01040* 00110101
*   KEYWORDS: CLOCK, DATE, ADDR, GMT, RESET, AND IPS.           Y02759* 00112102
*   SUCCESSFUL COMPARISON RESULTS IN TRANSFER BEING MADE, USING Y01040* 00112501
*   KEYTAB, TO THE APPROPRIATE KEYWORD SUBROUTINE.  SUCCESSFUL  Y01040* 00112601
*   RECOGNITION OF A KEYWORD CAUSES THE SETTING OF AN ID MASK   Y01040* 00112701
*   FOR THAT KEYWORD IN THE XSA.  THE SUBROUTINES FOR CLOCK,    Y01040* 00112802
*   TIME, AND ADDR CHECK FOR VALID NUMERICS THAT DO NOT         Y02759* 00112902
*   EXCEED THE PRE-DETERMINED MAXIMUMS. VALID TIME, DATE, OR    Y01040* 00113202
*   ADDR IS PACKED AND HELD IN THE XSA.                         Y02759* 00113602
*                                                                     * 00113702
*   AFTER RETURNING FROM THE SUBROUTINES, A CHECK IS MADE FOR         * 00113902
*   SUCCESSIVE KEYWORDS. IF THERE ARE MORE, THE KEYTAB SCAN IS        * 00115102
*   REPEATED.                                                         * 00117102
*                                                                     * 00129301
         EJECT                                                          00129401
*TABLES/WORK AREAS: THE EXTENDED SAVE AREA AS USED INTERNALLY IN      * 00129501
*   IEE0603D IS MAPPED AS FOLLOWS:                                    * 00130801
*                                                                     * 00132801
*       ***************************************************           * 00133201
*       *XAP                     *XAD                     *           * 00133301
*       *SAVE AREA FOR PTR TO    *                        *           * 00133401
*       * END OF COMMAND BUFFER. *                        *           * 00134701
*       ***************************************************           * 00136701
*       *XAX                                              *           * 00137102
*       *      CPU ADDRESS IN PACKED DECIMAL              *             00137202
*       *                                                 *           * 00139602
*       ***************************************************           * 00140302
*       *XAE   *XAR+1            *XAL                     *           * 00141602
*       *ID/ER *BUFFER           *SAVE AREA FOR CURRENT   *           * 00143602
*       *CODE  *POINTER          * PARAMETER POINTER.     *           * 00145602
*       ***************************************************           * 00146001
*       *XAV                     *XAV+4                   *           * 00146101
*       *                        * DATE IN PACKED         *           * 00146201
*       *                        *     DECIMAL.           *           * 00146301
*       ***************************************************           * 00146401
*       *XAS                     *XAS+4                   *           * 00147501
*       *                        * TIME IN PACKED         *           * 00149501
*       *                        *     DECIMAL.           *           * 00149601
*       ***************************************************           * 00149701
*                                                                     * 00149801
*   A KEYWORD TABLE (KEYTAB), WHICH CONTROLS KEYWORD SCANNING AND     * 00150102
*   KEYWORD SUBROUTINE BRANCHING.                                     * 00150802
*                                                                     * 00151502
*                                                                     * 00152701
*CHARACTER SET  THE OPERATION OF THIS MODULE DEPENDS UPON AN INTERNAL * 00153101
*   REPRESENTATION OF THE EXTERNAL CHARACTER SET WHICH IS EQUIVALENT  * 00153201
*   TO THE ONE USED AT ASSEMBLY TIME. THE CODING HAS BEEN ARRANGED SO * 00153301
*   THAT REDEFINITION OF 'CHARACTER' CONSTANTS, BY REASSEMBLY, WILL   * 00153401
*   RESULT IN A CORRECT MODULE FOR THE NEW DEFINITIONS.               * 00153701
*                                                                     * 00154101
*********************************************************************** 00154201
         EJECT                                                          00154301
*      REGISTER ASSIGNMENTS        FUNCTION(S)                          00154401
R0       EQU   0                   ENTRY CODE TO ESTAE EXIT      Y02759 00155302
R1       EQU   1                   POST                                 00155402
R2       EQU   2                   BASE REGISTER FOR XSA                00155701
R3       EQU   3                   CURRENT PARAMETER PTR AND LINK REG   00156101
R4       EQU   4                   KEYTAB POINTER AND WORK REGISTER     00156501
R5       EQU   5                   ERROR LINKER AND WORK REGISTER       00156901
R6       EQU   6                   WORK REGISTER                 Y02759 00157002
R7       EQU   7                   WORK REGISTER                 Y02759 00157102
R8       EQU   8                   WORK REGISTER                        00157201
R9       EQU   9                   PARAMETER POINTER AND WORK REGISTER  00157601
R10      EQU   10                  BASE FOR MASTER RESIDENT CORE        00158001
R11      EQU   11                  WORK REGISTER                        00158401
SBASE    EQU   12                  BASE REGISTER FOR PROGRAM            00158501
R13      EQU   13                  WORK REGISTER                  20071 00162202
R14      EQU   14                  BRANCH REGISTER                20071 00164201
R15      EQU   15                  LINKAGE REGISTER              Y02759 00166202
*                                                                     * 00166601
* DISPLACEMENTS OF INFORMATION WITHIN KEYWORD TABLE ELEMENTS          * 00166801
KEYTBL   EQU   83                  KEYWORD TABLE LENGTH MINUS ONE       00167202
KEYELN   EQU   14                  KEYWORD TABLE ELEMENT LENGTH         00167302
KEYLNG   EQU   0                   DISPLACEMENT OF KEYWORD LENGTH       00168301
KEYDIS   EQU   1                   DISPLACEMENT OF DELIMITER            00170301
KEYWRD   EQU   2                   DISPLACEMENT OF KEYWORD              00170401
KEYBRN   EQU   8                   DISPLACEMENT OF BRANCH               00170501
KEYIDM   EQU   12                  DISPLACEMENT OF ID MASK              00171501
KEYFLD   EQU   13                  DISPLACEMENT OF FOLD COUNT    Y02759 00171902
* ERROR CODES FOR MESSAGE MODULE                                        00173501
ERR5     EQU   5                    ERROR CODE                   Y02759 00173602
ERR6     EQU   6                    ERROR CODE                   Y02759 00173902
ERR7     EQU   7                    ERROR CODE                   Y02759 00174202
ERR8     EQU   8                    ERROR CODE                   Y02759 00174502
ERR9     EQU   9                    ERROR CODE                   Y02759 00174802
ERR10    EQU   10                   ERROR CODE                   Y02759 00175102
ERR11    EQU   11                   ERROR CODE                   Y02759 00175402
ERR12    EQU   12                   ERROR CODE                   Y02759 00175702
ERR13    EQU   62                   ERROR CODE                   Y02759 00176002
* PERIOD DISPLACEMENTS FOR DATE AND CLOCK                             * 00176601
PERD1    EQU   2                   DISPLACEMENT OF PERIOD               00176701
PERD2    EQU   5                   DISPLACEMENT OF PERIOD               00176801
D0       EQU   0                                                 Y02759 00177202
D1       EQU   1                   OFFSET TO GET TO KEYWORD      Y01040 00179502
D2       EQU   2                                                  20071 00179902
D3       EQU   3                                                  20071 00180302
D8       EQU   8                                                  20071 00181502
FOX      EQU   15                                                       00181902
D30      EQU   30                                                       00182302
XFF      EQU   X'FF'                                              20071 00183201
C6       EQU   C'6'                                               20071 00184401
C9       EQU   C'9'                                               20071 00184801
LOC16    EQU   16                                                Y02759 00184902
ZERO     EQU   X'00'               NO PARAMETER FOLLOWING        Y01040*00185101
                                        KEYWORD                  Y01040 00185501
CLOCK    EQU   X'01'               SPECIFIC CODE FOR CLOCK       Y02759 00186202
DATE     EQU   X'02'               SPECIFIC CODE FOR DATE        Y02759 00186502
GMT      EQU   X'04'               SPECIFIC CODE FOR GMT         Y02759 00186802
ADDR     EQU   X'08'               SPECIFIC CODE FOR ADDR        Y02759 00187102
RESET    EQU   X'10'               SPECIFIC CODE FOR RESET       Y02759 00187402
IPS      EQU   X'20'               SPECIFIC CODE FOR IPS         Y02759 00187702
* UPPER AND LOWER COMPARANDS FOR SCHECK                               * 00188001
SNUMHI   EQU   C'9'                HIGH NUMERIC                         00188301
SNAWT    EQU   C'0'                CHARACTER ZERO                       00188601
SEINS    EQU   X'01'               BINARY ONE                           00188901
SNUMLO   EQU   SNAWT-SEINS         LOW NUMERIC COMPARAND                00189201
         EJECT                                                          00189501
* MAIN ROUTINE - ESTABLISHES ADDRESSABILITY FOR PROGRAM, XSA, AND     * 00189902
*    MASTER RESIDENT CORE.  USES XSA POINTERS TO COMMAND BUFFER AND   * 00190302
*    LEADING KEYWORD TO IDENTIFY THE KEYWORD. KEYWORD RECOGNITION     * 00190702
*    LEADS TO BRANCHING TO THE KEYWORD'S SUBROUTINE.                  * 00191002
*                                                                     * 00191601
*/*IEE0603D: CHART (FMODE) */                                           00191702
*/* HEADER                                                              00191801
*/*MASTER SCHEDULER (COMMANDS)                             GMT AND L    00196101
*/*OCAL TIME                                                IEE0603D    00198101
*/*                                                              PAG    00198201
*/*E #                                                               */ 00198301
*/*IEE0603D:1A2 E ENTRY FROM IEE0403D */                                00198502
*/*1B2 M ESTABLISH ADDRESSIBILITY */                                    00198602
         BALR  SBASE,0             ESTABLISH PROGRAM ADDRESSABILITY     00198701
         USING MODBASE,SBASE                                     Y02759 00198802
MODBASE  EQU   *                                                 Y02759 00199002
IEE0603D MODID BRANCH=YES                                        Y01886 00199202
         USING XSA,R2              BASE FOR EXTENDED SAVE AREA          00199701
         USING BASE,R10            ESTABLISH BASEA ADDRESSABLTY         00199801
*/*1C2 P SET POINTER TO START OF KEYWORDS AND ESTABLISH RECOVERY EXIT*/ 00199902
         SR    R15,R15             ZEROES TO INITIALIZE ERROR    Y02759 00213302
*                                       EXIT FLAGS               Y02759 00213602
         L     R9,XAL              USE REG 9 AS PTR TO PARMS     Y04925 00213902
         STM   R9,R15,REGSAVE      SAVE REGS 9-15                Y02759 00216702
         LA    R9,0(R9)            ZERO H.O. BYTE TO TEST PTR    Y04925 00216902
         MVC   ESTAELST(ESTAELN),ESTAEL  COPY ESTAE PARAMETER           00217102
*                                       LIST TO XSA                     00217502
         LA    R1,ESTAELST         GET ADDR OF ESTAE LIST FORM          00217602
         LA    R7,EXITPARM         GET RECVY EXIT PARMLIST ADDRESS      00217702
         ESTAE ,CT,PARAM=(7),MF=(E,(1))  ESTABLISH RECOVERY EXIT        00217902
*/*1D2 D (NO,SERR10,YES,) ANY KEYWORDS */                               00218602
         LTR   R9,R9               IS PARAMETER PTR 0?            20071 00218802
         BZ    SERR10              YES, KEYWORDS MISSING          20071 00219002
*/*1E2 P SET UP REGISTERS FOR KEYWORD SCAN TABLE */                     00219902
         L     R7,XAR              LOAD POINTER TO BUFFER               00220902
         LA    R7,0(R7)                 CONTAINING COMMAND              00221902
         LH    R6,0(R7)            LOAD BUFFER LENGTH                   00222902
         N     R6,SFFFF-2          CLEAR POSSIBLE GARBAGE               00223902
*/*1F2 P COMPUTE END OF BUFFER AND SAVE */                              00224902
         AR    R7,R6               COMPUTE END OF BUFFER                00225902
         ST    R7,XAP              SAVE IN FIRST WORD OF XSA            00226902
*/*1G2 M CLEAR KEYWORD MASK BYTE */                                     00227902
         NI    XAE,X'00'           CLEAR ID MASK AREA                   00228902
         SPACE                                                          00229902
*/*SNEWKY:1H2 M SET UP TO CHECK KEYWORD AGAINST TABLE */                00230902
SNEWKY   EQU   *                   EXAMINE KEYWORD                      00231902
         LA    R6,KEYELN           LOAD KEYTAB ELEMENT LENGTH           00232902
*                                       FOR INCREMENT IN BXLE           00233902
         LA    R4,KEYTAB           GET ADDRESS OF KEYWORD TABLE         00234902
         LA    R7,KEYTBL(R4)       GET END OF TABLE ADDRESS             00235902
*                                       FOR COMPARAND IN BXLE           00236902
         SR    R5,R5               LOAD LENGTH OF A                     00237902
SNXTWRD  IC    R5,KEYLNG(R4)            PARTICULAR KEYWORD              00238902
*/*SETCLK:1J2 D (YES,BUFFERCK,NO,) KEYWORD A MATCH */                   00239902
         EX    R5,SETMVC           MOVE POTENTIAL PARM TO WKAREA        00240902
         IC    R5,KEYFLD(R4)       GET LENGTH TO FOLD TO CAPS           00241902
         EX    R5,SETOC            FOLD TO UPPER CASE                   00242902
         IC    R5,KEYLNG(R4)       GET LENGTH TO COMPARE                00243902
         EX    R5,SETCLC           IS THIS THE KEYWORD?                 00244902
         BE    CKPARM              YES, NOW GO CHECK PARAMETER          00245902
*/*1K2 D (YES,SERR09,NO,) END OF TABLE */                               00246902
         BXLE  R4,R6,SNXTWRD       RECHECK IF NOT END OF TABLE          00247902
*/*1K1 P (,SETCLK) INCREMENT TO NEXT KEYWORD */                         00248902
         B     SERR09              ERROR, KEYWORD NOT FOUND             00249902
         SPACE                                                          00250902
*/*BUFFERCK:1B4 D (NO,INCRMT,YES,) SHOULD KEYWORD HAVE PARM */          00251902
CKPARM   LA    R9,1(R9,R5)         POINT REGISTER TO PARAMETER          00252902
         CLI   D1(R4),ZERO         SHOULD THERE BE A PARMETER?   Y01040 00253902
         BE    INCRMT              NO, SKIP CHECK FOR ONE        Y01040 00254902
*/*1C4 D (NO,SERR11,YES,) IS THERE A PARAMETER */                       00255902
         CLI   0(R9),C' '          IS PARAMETER BLANK?                  00256902
         BE    SERR11              YES, ERROR                           00257902
         SPACE                                                          00258902
*/*INCRMT:1D4 D (YES,SERR08,NO,) BUFFER EXCEEDED */                     00259902
INCRMT   EQU   *                                                 Y01040 00260902
         SR    R3,R3               POINT A REGISTER TO THE END OF       00261902
         IC    R3,KEYDIS(R4)            PARAMETER                       00262902
         LA    R3,0(R3,R9)                                              00263902
         C     R3,XAP              IS BUFFER EXCEEDED?                  00264902
         BH    SERR08              YES, ERROR                           00265902
         SPACE                                                          00266902
*/*1E4 P GET KEYWORD */                                                 00267902
         SR    R5,R5               NO, PREPARE TO                       00268902
         IC    R5,KEYIDM(R4)            LOAD KEYWORD'S ID MASK          00269902
*/*1F4 D (YES,SERR12,NO,) KEYWORD A REPEAT */                           00270902
         EX    R5,SETTMP           IS THIS KEYWORD A REPEAT?            00271902
         BO    SERR12              YES, ERROR                           00272902
         SPACE                                                          00273902
*/*1G4 P SAVE KEYWORD ID */                                             00274902
         OC    XAE(1),KEYIDM(R4)   SAVE KEYWORD'S ID IN XSA             00275902
         ST    R3,XAL              SAVE POINTER TO END OF PARAMETER     00276902
*/*1H4 D (CLOK,SCLOCK,DATE,SDATE,ADDR,SADDR,IPS,SETNXT,RSET,SETNXT,GMT, 00277902
*/*SETNXT)                                                              00278902
*/* GO TO APPROPRIATE PROCESSING ROUTINE */                             00279902
         EX    0,KEYBRN(R4)        GO TO THE APPROPRIATE SUBROUTINE     00280902
         EJECT                                                          00281902
* KEYWORD=CLOCK SUBROUTINE - SYNTAX CHECKS THE CLOCK PARAMETER FOR    * 00282902
*    PROPER POSITIONING OF PERIODS, NUMERIC CHARACTERS, AND THE EX-   * 00283902
*    CEEDING OF PROPER LIMITS FOR HOUR, MINUTE OR SECOND. A VALID     * 00284902
*    PARAMETER IS PACKED IN THE XSA TEMPORARILY, IN XAS.              * 00285902
*                                                                     * 00286902
*/*SCLOCK:2A3 D (NO,SERR07,YES,) ARE PERIODS CORRECT */                 00287902
SCLOCK   EQU   *                                                        00288902
         CLI   PERD1(R9),C'.'      CHECK FOR PROPER PLACEMENT           00289902
         BNE   SERR07                        INCORRECT                  00290902
         CLI   PERD2(R9),C'.'           OF PERIODS                      00291902
         BNE   SERR07                        INCORRECT                  00292902
*/*2B3 P REMOVE PERIODS AND SAVE HHMMSS */                              00293902
         MVC   XAS(2),0(R9)        CONSOLIDATE TIME WITHOUT             00294902
         MVC   XAS+2(2),3(R9)           PERIODS                         00295902
         MVC   XAS+4(2),6(R9)                                           00296902
         LA    R11,6               SET LOOP CONTROLLER TO 6             00297902
         LA    R9,XAS              SET POINTER TO TIME                  00298902
*/*2C3 S SCHECK: VALIDATE TIME DIGITS */                                00299902
         BAL R13,SCHECK            VERIFY TIME DIGITS             20071 00300902
*/*2D3 D (YES,SERR06,NO,) DO HOURS EXCEED 23 */                         00301902
         CLC   XAS(2),SETCHR       DO HOURS EXCEED 23?                  00302902
         BH    SERR06              YES, ERROR                           00303902
*/*2E3 D (YES,SERR06,NO,) DO MINUTES EXCEED 59 */                       00304902
         CLC   XAS+2(2),SETCMS     DO MINUTES EXCEED 59?                00305902
         BH    SERR06              YES, ERROR                           00306902
*/*2F3 D (YES,SERR06,NO,) DO SECONDS EXCEED 59 */                       00307902
         CLC   XAS+4(2),SETCMS     DO SECONDS EXCEED 59?                00308902
         BH    SERR06              YES, ERROR                           00309902
*/*2G3 P (,SETNXT) SAVE TIME IN PACKED DECIMAL */                       00310902
         PACK  XAS+4(4),XAS(6)     PACK TIME FOR CONVERSION             00311902
         B     SETNXT              GO CHECK NEXT KEYWORD                00312902
         EJECT                                                          00313902
* KEYWORD=DATE SUBROUTINE - SYNTAX CHECKS THE DATE PARAMETER FOR      * 00314902
*    PROPER POSITIONING OF PERIODS, NUMERIC CHARACTERS, AND THE EX-   * 00315902
*    CEEDING OF PROPER LIMITS FOR THE DAY. A VALID PARAMETER IS       * 00316902
*    PACKED IN THE XSA TEMPORARILY, IN XAV.                           * 00317902
*                                                                     * 00318902
*/*SDATE:2A1 D (NO,SERR07,YES,) IS THE PERIOD CORRECT */                00319902
SDATE    EQU   *                                                        00320902
         CLI   PERD1(R9),C'.'      IS PERIOD POSITIONED?                00321902
         BNE   SERR07              NO, ERROR                            00322902
*/*2B1 P REMOVE THE PERIOD AND SAVE YYDDD */                            00323902
         MVC   XAV(2),0(R9)        CONSOLIDATE DATE WITHOUT             00324902
         MVC   XAV+2(3),3(R9)           PERIODS                         00325902
         LA    R11,5               SET LOOP CONTROLLER TO 5             00326902
         LA    R9,XAV              SET POINTER TO DATE                  00327902
*/*2C1 S SCHECK: VALIDATE DATE DIGITS */                                00328902
         BAL   R13,SCHECK          VERIFY DATE DIGITS             20071 00329902
*/*2D1 D (YES,SERR06,NO,) IS THE DAY 000? */                            00330902
         CLC   XAV+D2(D3),SETDD0   IS DDD = 000?                 YM1821 00331902
         BE    SERR06              YES, INVALID NUMERICS         YM1821 00332902
*/*2E1 M PRESET EXITING ADDRESS TO 'SETNXT' IN REGISTER 13 */           00333902
         LA    R13,SETNXT          SET BRANCH TO NEXT KEYWORD    YM1821 00334902
*/*2F1 D (GT,SERR06,LT,SYEAR,EQ,) DDD = 366? */                         00335902
         CLC   XAV+2(3),SETDDY     DO DAYS EXCEED 366?                  00336902
         BH    SERR06              YES, ERROR                           00337902
         BL    SYEAR               BRANCH IF LESS THAN 366 DAYS  YM1821 00338902
*/*2G1 M PRESET EXITING ADDRESS TO 'LEAPYEAR' IN REGISTER 13 */         00339902
         LA    R13,LEAPYEAR        SET BRANCH TO YEAR VALIDITY   YM1821 00340902
SYEAR    EQU   *                                                 YM1821 00341902
*/*SYEAR:2H1 P SAVE YYDDD IN PACKED DECIMAL */                          00342902
         PACK  XAV+4(4),XAV(5)     PACK DATE FOR CONVERSION             00343902
*/*2J1 D (YES,SETNXT,NO,LEAPYEAR) REGISTER 13 POINTING TO 'SETNXT'? */  00344902
         BR    R13                                               YM1821 00345902
*********************************************************************** 00346902
*                                                                     * 00347902
* THIS ROUTINE, ENTERED ONLY AFTER A DATE WITH 366 DAYS         Y02759* 00348902
* IS ENCOUNTERED, CHECKS FOR THE VALIDITY OF THE 366 DAYS IN    YM1821* 00349902
* THE YEAR.  THE YEAR IN QUESTION IS DIVIDED BY 4, AND IF A     YM1821* 00350902
* REMAINDER IS PRESENT, THE ROUTINE LEADS TO AN ERROR MESSAGE   YM1821* 00351902
* ISSUED.  NORMAL PROCESSING IS CONTINUED FOR A VALID LEAP      YM1821* 00352902
* YEAR.                                                         YM1821* 00353902
*                                                                     * 00354902
*********************************************************************** 00355902
*/*LEAPYEAR:2J2 P OBTAIN THE YEAR */                                    00356902
LEAPYEAR EQU   *                                                 YM1821 00357902
         SR    R4,R4               CLEAR REGISTER                YM1821 00358902
         ST    R4,XAV              CLEAR FIRST WORD FOR 'CVB'    YM1821 00359902
         CVB   R5,XAV              CONVERT TO BINARY             YM1821 00360902
         D     R4,D1000            SHIFT OFF DDD                        00361902
*/*2J3 D (YES,SERR06,NO,) IS IT 1900? */                                00363902
         LTR   R5,R5               TEST FOR 1900                        00371902
         BZ    SERR06              ERROR IF 1900                        00381902
*/*2J4 D (NO,SERR06,YES,SETNXT) IS IT PERFECTLY DIVISIBLE BY 4? */      00383902
         SLL   R5,D30              SHIFT OFF ALL BUT BITS 30-31         00391902
         LTR   R5,R5               EITHER 0NE ON?                       00392302
         BNZ   SERR06              YES, ERROR.  NOT A LEAP YEAR         00402202
         B     SETNXT              GO CHECK NEXT KEYWORD         YM1821 00599602
      EJECT                                                             00629201
* KEYWORD=ADDR SUBROUTINE - VALIDITY CHECKS THE CPU ADDRESS SPECIFIED.* 00631202
*    A VALID ADDRESS IS PACKED IN THE XSA TEMPORARILY, IN XAX.        * 00633202
*                                                                     * 00635202
*/*SADDR:2A2 P SAVE CPU ADDRESS */                                      00639602
SADDR    EQU   *                                                        00640002
         MVC   XAX(2),D0(R9)       SAVE SPECIFIED CPU ADDRESS    Y02759 00641202
         LA    R11,D2              SET LOOP CONTROLLER TO 2      Y02759 00646202
*/*2B2 S SCHECK:VALIDATE ADDRESS DIGITS */                              00651202
         BAL   R13,SCHECK          VERIFY ADDRESS DIGITS         Y02759 00659202
*/*2C2 D (YES,SERR06,NO,) DOES ADDR EXCEED 15? */                       00669202
         CLC   XAX(2),SETCADDR     DOES ADDRESS EXCEED 15?       Y02759 00671202
         BH    SERR06              YES, ERROR                    Y02759 00673202
*/*2D2 P (,SETNXT) SAVE ADDR IN PACKED DECIMAL */                       00675202
         PACK  XAX(8),XAX(2)       PACK CPU ADDRESS FOR          Y02759 00677202
*                                  FURTHER VERIFICATION          Y02759 00677602
         B     SETNXT              GO CHECK NEXT KEYWORD         Y02759 00678002
      EJECT                                                             00678402
* THE FOLLOWING CLOSED SUBROUTINE IS USED BY SCLOCK, SDATE, AND       * 00679202
*    SADDR TO CHECK THAT ALL PARAMETER CHARACTERS ARE NUMERIC. R11    * 00689202
*    IS THE LOOP COUNTER; R3 IS THE RETURN REGISTER; R9 POINTS TO     * 00729202
*    THE PARAMETER.                                                   * 00779202
*                                                                     * 00829201
*/*SCHECK:2A5 E NUMERIC CHECK SUBRT */                                  00879202
SCHECK   EQU   *                                                        00929201
*/*2B5 P CHECK FOR NUMERIC DIGITS */                                    00979202
         SR    R4,R4               SET INCREMENT REGISTERS TO ZERO      01029201
         SR    R6,R6                                                    01079201
         LA    R5,SNUMLO           SET LOWER LIMIT OF DIGIT             01129201
         LA    R7,SNUMHI           SET UPPER LIMIT OF DIGIT             01179201
*/*SDGTLP:2C5 D (YES,SERR06,NO,) DIGIT LESS THAN 0? */                  01229202
SDGTLP   SR    R8,R8               CLEAR FOR LOADING                    01279201
         IC    R8,0(R9)            TAKE ONE CHARACTER                   01329201
         BXLE  R8,R4,SERR06        TEST FOR LOW                         01379201
*/*2D5 D (YES,SERR06,NO,) DIGIT GREATER THAN 9? */                      01429202
         BXH   R8,R6,SERR06        TEST FOR HIGH                        01479201
*/*2E5 P INCREMENT TO NEXT DIGIT */                                     01529202
         LA    R9,1(R9)            INCREMENT CHARACTER POINTER          01579201
*/*2F5 D (NO,SDGTLP,YES,) LAST DIGIT CHECKED? */                        01629202
         BCT   R11,SDGTLP          IS LOOP DONE?                        01679201
*/*2G5 R RETURN TO CALLER */                                            01729202
         BR    R13                 YES, RETURN                    20071 01779201
         EJECT                                                          08129201
* RETURNED TO FROM A KEYWORD SUBROUTINE, THIS PORTION OF THE MAIN     * 08179201
*    ROUTINE CHECKS IF THE SET COMMAND IS COMPLETE OR IF THERE ARE    * 08229201
*    MORE KEYWORDS. A COMMA AS DELIMITER RESULTS IN THE RETURN TO     * 08279201
*    THE KEYWORD TABLE SCAN FOR THE NEW KEYWORD. SUCCESSFUL COMPLE-   * 08329201
*    TION LEADS TO 'SETOUT'.                                          * 08379201
*                                                                     * 08429201
*/*SETNXT:1D1 D (YES,SETOUT,NO,) END OF BUFFER? */                      08479202
SETNXT   EQU   *                                                        08529201
         C     R3,XAP              IS IT VALID END OF BUFFER?           08579201
         BE    SETOUT              YES, END OF SET COMMAND              08629201
*/*1E1 D (YES,SETOUT,NO,) END OF COMMAND? */                            08679202
         CLI   0(R3),C' '          IS NEXT CHARACTER A BLANK?           08729201
         BE    SETOUT              YES, END OF SET COMMAND              08779201
*/*1F1 D (NO,SERR08,YES,) IS THERE A COMMA? */                          08829202
         CLI   0(R3),C','          IS NEXT CHARACTER A COMMA?           08879201
         BNE   SERR08              NO, MUST BE ERROR                    08929201
         LA    R9,1(R3)            YES, BUMP CURRENT PARAMETER          08979201
*/*1G1 D (NO,SERR07,YES,SNEWKY) ANOTHER PARAMETER FOLLOWING? */         09029202
         CLI   0(R9),C' '          IS NEXT CHARACTER BLANK?             09079201
         BE    SERR07              YES, DELIMITER ERROR                 09129201
         B     SNEWKY              GO CHECK NEXT KEYWORD                09179201
         EJECT                                                          09229201
*/*SETOUT:3A1 M PRESET REGISTER 14 TO THE ADDRESS OF 'CKIPS' */         09249202
SETOUT   LA    R14,CKIPS              PICKUP RETURN ADDRESS             09279202
*/*3B1 D (NO,SERR05,YES,) IS IT IPL AND INTERNAL? */                    09329202
         TM    BASFL,BAIN+BAINTSET    IS IT IPL/VARY AND INTERNAL?      12939202
         BZ    SERR05                 IPL/VARY, BUT NOT INTERNAL        12941202
*/*3C1 D (YES,INTSET,NO,) IS IT INTERNAL ONLY? */                       12941602
         TM    BASFL,BAINTSET         IS IT INTERNAL?                   12943202
         BO    INTSET                 YES, BRANCH                       12945202
*/*3D1 D (YES,SERR13,NO,) GMT/ADDR AFTER IPL? */                        12945602
         TM    XAE,GMT+ADDR           GMT OR ADDR SPECFD AFTER IPL?     12947202
         BNZ   SERR13                 YES, ERROR                        12947602
*/*3E1 D (NO,NORESET,YES,) RESET SPECIFIED? */                          12947702
         TM    XAE,RESET              RESET SPECIFIED?                  12948002
         BZ    NORESET                NO, BRANCH                        12948402
*/*3F1 D (YES,SERR12,NO,LCL) RESET WITH DATE/CLOCK? */                  12948502
         TM    XAE,DATE+CLOCK         RESET SPECFD WITH DATE/CLOCK?     12948802
         BNZ   SERR12                 YES, ERROR                        12948902
         B     LCL                                                      12949002
*/*NORESET:3E2 D (NO,CKIPS,YES,) CLOCK/DATE SPECIFIED? */               12952302
NORESET  TM    XAE,CLOCK+DATE         CLOCK AND/OR DATE SPECFD?         12955802
         BCR   D8,R14                 NO, GO CHECK FOR IPS              12959102
*/*LCL:3G1 P GET ADDRESS OF IEE6503D */                                 12961102
LCL      L     R15,VCON65             GET ADDR OF SET LOCAL TIME        12969102
*/*3H1 S (,CKIPS) IEE6503D:SET LOCAL TIME */                            12971102
CALLMOD  BR    R15                    ROUTINE AND BALR TO IT            12972402
         DROP  SBASE                                                    12974402
         USING *,R14                                                    12974802
*/*CKIPS:3J1 D (NO,NOIPS:BT,YES,DESTAE1:RL) IPS SPECIFIED? */           12974902
CKIPS    LM    R9,R14,REGSAVE         RESTORE REGS 9-14                 12975202
         DROP  R14                                                      12975602
         USING MODBASE,SBASE                                            12975702
         TM    XAE,IPS                IPS SPECIFIED?                    12975802
         BZ    NOIPS                  NO, BRANCH                        12989102
         ST    R9,XAL                 RESTORE VERB CODE AND      Y04925 12991102
*                                          POINTER TO FIRST PARM Y04925 12995102
         MVC   XAV(8),SETSET          MOVE VERB NAME TO XSA      Y04925 12999102
*/*DESTAE1:3J2 P DELETE RECOVERY EXIT */                                12999202
         ESTAE 0                      DELETE RECOVERY EXIT              12999302
*/*3K2 R GET ADDRESS OF IEE0803D AND BRANCH TO IT */                    12999702
         L     R15,VCON08             GET ADDR OF CSCB CREATION RTN     13001102
         BR    15                     BRANCH TO CSCB CREATION RTN       13009802
*/*NOIPS:3K1 R DELETE RECOVERY EXIT AND RETURN TO IEE0403D */           13011902
NOIPS    ESTAE 0                      DELETE RECOVERY EXIT              13012302
         BR    R14                    RETURN IF NO IPS                  13014202
         EJECT                                                          13016402
*/*INTSET:3A4 M ESTABLISH ADDRESSABILITY TO TOD CLOCK WORKAREA */       13018602
INTSET   L     R6,LOC16               GET CVT POINTER                   13020802
         USING CVT,R6                                                   13023002
         L     R6,CVTTPC              GET TPC POINTER                   13025202
         USING TPC,R6                                                   13027402
         L     R6,TPCTCWA             GET TCWA POINTER                  13029602
         USING TCWA,R6                                                  13031802
*/*3B4 D (YES,SERR13,NO,) RESET SPECIFIED? */                           13034002
         TM    XAE,RESET              RESET SPECIFIED                   13036202
         BO    SERR13                 YES, RESET IS ERROR ON INT SET    13038402
*/*3C4 D (YES,CKZZZ,NO,) ADDR SPECIFIED? */                             13040602
         TM    XAE,ADDR               ADDR SPECIFIED?                   13042802
         BO    CKZZZ                  YES, BRANCH                       13045002
*/*3D4 D (YES,CKDATE,NO,) MSG IEA886A OR IEA887A ISSUED? */             13047202
         TM    TCWAGFLG,MSGYYY+MSGZZZ  MSG YYY OR ZZZ OUTSTANDING       13049402
         BNZ   CKDATE                 YES, SEE IF DATE SPECFD           13051602
*/*3E4 D (NO,CKGMT,YES,) DATE/CLOCK SPECIFIED? */                       13053802
         TM    XAE,DATE+CLOCK         NO, MUST BE XXX OUTSTANDING       13056002
*                                         SEE IF CLOCK/DATE SPECFD      13058202
         BZ    CKGMT                  IF NOT, CHECK FOR GMT             13060402
*/*3F4 D (NO,LCL,YES,) GMT SPECIFIED? */                                13062602
         TM    XAE,GMT                IF SO, IS GMT SPECIFIED?          13064802
         BZ    LCL                    NO, GO TO LCL TIME RTN            13067002
*/*TOD:3H4 P GET ADDRESS OF IEE6603D */                                 13069202
TOD      L     R15,VCON66             GET ADDR OF SET TOD CLOCK RTN     13071402
*/*3J4 S (,CKIPS) IEE6603D:SET TOD CLOCK */                             13073602
         BR    R15                        AND GO THERE                  13075802
*/*CKDATE:3D5 D (NO,SERR10,YES,TOD) DATE SPECIFIED? */                  13078002
CKDATE   TM    XAE,DATE               DATE SPECIFIED?                   13080202
         BZ    SERR10                 NO, ERROR                         13082402
         B     TOD                    YES, GO TO TOD CLOCK RTN          13084602
*/*CKGMT:3E5 D (YES,SERR13,NO,CKIPS) GMT SPECIFIED? */                  13086802
CKGMT    TM    XAE,GMT                GMT SPECIFIED?                    13089002
         BO    SERR13                 YES, GMT WITHOUT DATE/CLOCK       13091202
*                                         IS AN ERROR                   13093402
         B     CKIPS                  NO, GO CHECK FOR IPS              13095602
*                                                                       13097802
* ADDR WAS SPECIFIED.  SEE IF IT IS VALID, AND ACT ACCORDINGLY          13100002
*                                                                       13102202
*/*CKZZZ:3C3 D (NO,SERR13,YES,) MSG IEA887A ISSUED? */                  13104402
CKZZZ    TM    TCWAGFLG,MSGZZZ        MSG ZZZ OUTSTANDING?              13106602
         BZ    SERR13                 WITHOUT IT, ADDR IS AN ERROR      13108802
*/*3D3 P SEARCH TOD CLOCK WORKAREA ENTRIES FOR SPECIFIED ADDR */        13111002
         CVB   R5,XAX                 CONVERT THE ADDR TO BINARY        13113202
         LA    R7,LTCWA(,R6)          GET PTR TO FIRST TCWA ENTRY       13115402
         USING TCENTRY,R7                                               13117602
         LH    R8,TCCPUCNT            GET NUMBER OF ENTRIES             13119802
NEXT     CH    R5,TCWAIADD            COMPARE SPECIFIED CPU ADDR        13122002
*                                          WITH ADDR IN ENTRY           13124202
         BE    MATCH                  BRANCH IF THEY MATCH              13126402
         LA    R7,LENTRY(,R7)         POINT TO NEXT ENTRY               13128602
         BCT   R8,NEXT                BRANCH IF MORE ENTRIES            13130802
*/*3E3 D (NO,SERR06,YES,) CORRECT ENTRY FOUND? */                       13133002
         B     SERR06                 ELSE, NO MATCH FOUND, ERROR       13135202
*/*3F3 D (NO,SERR06,YES,) IS THIS CLOCK SET? */                         13137402
MATCH    TM    TCWALFLG,TCLCC         THIS CLOCK SET?                   13139602
         BNZ   SERR06                 NO, ERROR                         13141802
         LA    R8,LTCWA(,R6)          GET PTR TO FIRST ENTRY            13144002
*/*3G3 D (YES,NOSWAP:RR,NO,) IS THIS 1ST ENTRY? */                      13146202
         CR    R7,R8                  IS MATCHING ENTRY THE FIRST?      13148402
         BE    NOSWAP                 YES, NO SWAP REQUIRED             13150602
*/*3H3 M SWAP 1ST AND MATCHING ENTRIES */                               13152802
         XC    D0(LENTRY,R7),D0(R8)   EXCHANGE FIRST                    13155002
         XC    D0(LENTRY,R8),D0(R7)         AND MATCHING                13157202
         XC    D0(LENTRY,R7),D0(R8)               ENTRIES               13159402
*/*NOSWAP:3J3 M (,CKIPS:B ) INDICATE TOD CLOCK O.K. */                  13161602
NOSWAP   NI    TCWAGFLG,XFF-TCGNSET   INDICATE TOD CLOCK OK             13163802
         B     CKIPS                  GO CHECK FOR IPS                  13166002
         EJECT                                                          13168202
* THE FOLLOWING INSTRUCTIONS PASS A DESIGNATED ERROR CODE TO THE      * 13170402
*    SET COMMAND ERROR SUBROUTINE, 'SETERR', IN REGISTER 5.           * 13172602
*                                                                     * 13174802
*/*SERR05:4A3 M (,SETERR) SET ERROR CODE FOR COMMAND INVALID */         13177002
SERR05   BAL   R5,SETERR           ERROR CODE = 5                 20071 13179201
         DC    AL1(ERR5)                                          20071 13229201
*                                                                 20071 13279201
*/*SERR06:4B2 M (,SETERR) SET ERROR CODE FOR INVALID NUMERICS */        13329202
SERR06   BAL   R5,SETERR           ERROR CODE = 6                       13379201
         DC    AL1(ERR6)                                                13429201
*                                                                     * 13479201
*/*SERR07:4B4 M (,SETERR) SET ERROR CODE FOR DELIMITER ERROR */         13529202
SERR07   BAL   R5,SETERR           ERROR CODE = 7                       13579201
         DC    AL1(ERR7)                                                13629201
*                                                                     * 13679201
*/*SERR08:4C2 M (,SETERR) SET ERROR CODE FOR TERM LENGTH ERROR */       13729202
SERR08   BAL   R5,SETERR           ERROR CODE = 8                       13779201
         DC    AL1(ERR8)                                                13829201
*                                                                     * 13879201
*/*SERR09:4C4 M (,SETERR) SET ERROR CODE FOR UNIDENTIFIBLE KEYWORD */   13929202
SERR09   BAL   R5,SETERR           ERROR CODE = 9                       13979201
         DC    AL1(ERR9)                                                14029201
*                                                                     * 14079201
*/*SERR10:4D2 M (,SETERR) SET ERROR CODE FOR KEYWORD MISSING */         14129202
SERR10   BAL   R5,SETERR           ERROR CODE = 10                      14179201
         DC    AL1(ERR10)                                               14229201
*                                                                     * 14279201
*/*SERR11:4D4 M (,SETERR) SET ERROR CODE FOR PARAMETER MISSING */       14329202
SERR11   BAL   R5,SETERR           ERROR CODE = 11                      14379201
         DC    AL1(ERR11)                                               14429201
*                                                                     * 14479201
*/*SERR12:4E2 M (,SETERR) SET ERROR CODE FOR PARAMETERS CONFLICT */     14529202
SERR12   BAL   R5,SETERR           ERROR CODE = 12                      14579201
         DC    AL1(ERR12)                                               14629201
*                                                                       14679202
*/*SERR13:4E4 M (,SETERR) SET ERROR CODE FOR INVALID PARAMETER */       14689202
SERR13   BAL   R5,SETERR           ERROR CODE = 62              Y02759  14729202
         DC    AL1(ERR13)                                       Y02759  14799202
         EJECT                                                          14879201
* ERROR SUBROUTINE - RECEIVES IN REGISTER 5 AN ERROR MESSAGE CODE     * 14929201
*    WHICH IS PLACED IN THE XSA (IN XAE). CONTROL GOES TO THE MESSAGE * 14979202
*    ASSEMBLY MODULE, IEE0503D, BY BRANCH.                      Y01040* 15029201
*/*SETERR:4F3 M SET UP TO ISSUE MESSAGE */                              15079202
SETERR   DS    0H                                                       15129201
         TM    BASFL,BAINTSET      INTERNAL COMMAND?                    15131202
         BNO   EXTCMD              NO, BRANCH                           15133202
         MVC   XAV(8),SETRPLY      MOVE VARIABLE TEXT TO XSA     Y02759 15139202
         B     INSERRC             GO GET ERROR CODE                    15149202
EXTCMD   MVC   XAV(8),SETSET       MOVE VARIABLE TEXT TO XSA            15179202
INSERRC  MVC   XAE(1),0(R5)        INSERT ERROR CODE                    15229202
*/*4G3 M INDICATE PARAMETERS NOT ACCEPTED */                            15279202
         MVI   BAIPLCC,XFF         PUT RETURN CODE IN IPL ECB    Y01040 15329202
         LM   R9,R14,REGSAVE       RESTORE REGS 9-14             Y02759 15339202
*/*4H3 P DELETE RECOVERY EXIT */                                        15349202
         ESTAE 0                   DELETE RECOVERY EXIT                 15359202
*/*4J3 P GET ADDRESS OF IEE0503D */                                     15379202
         L    R15,VCON05           GET ADDRESS OF IEE0503D       Y01029 15429201
*/*4K3 R BRANCH TO IEE0503D */                                          15479202
         BR   R15                  BRANCH TO IEE0503D            Y01029 15529201
         EJECT                                                          15629201
*                                                                       15639202
* ERROR RECOVERY EXIT                                                   15649202
*                                                                       15659202
*/*SERREXIT:5A3 E ESTAE EXIT ROUTINE */                                 15661202
SERREXIT BALR  SBASE,0             ESTABLISH ADDRESSABILITY             15669202
         USING *,SBASE                                                  15671202
*/*5B3 M INDICATE PERCOLATION IN REG 15 */                              15671602
         SR    R15,R15             SET RC FOR PERCOLATION               15673202
*/*5C3 D (NO,CMDFAIL,YES,) SDWA SUPPLIED? */                            15673602
         CH    R0,H12              SEE IF SDWA SUPPLIED                 15675202
         BE    FAILCMND            BRANCH IF NOT                        15677202
         L     R2,0(R1)            IF SO, GET PARMLIST ADDR INTO R2     15677602
         USING EXITPARM,R2         PARMLIST ADDRESSABILITY              15677702
*/*5D3 P ISSUE SETRP */                                                 15677802
         SETRP RECPARM=SETID,RC=0, ESTABLISH INTERFACE BACK TO RTM     *15678002
               DUMP=NO                                                  15678102
*/*5E3 M DETERMINE CSECT WHERE ERROR OCCURRED AND SET NAME IN SDWA */   15680102
         TM    CSECTCDE,X'C0'      DETERMINE WHERE ERROR OCCURRED       15682102
         BZ    FAILCMND            BRANCH IF ERROR IN IEE0603D          15684102
*                                     AS CSECT NAME IS CORRECT          15686102
         BO    CSECT66             BRANCH TO CHANGE CSECT NAME IF       15688102
*                                     ERROR IN IEE6603D                 15690102
         USING SDWA,R1                                                  15695802
         MVC   SDWACSCT+3(2),C65   CHANGE CSECT NAME TO IEE6503D        15705802
         B     FAILCMND            BRANCH TO SET FAIL FLAG              15707802
CSECT66  MVC   SDWACSCT+3(2),C66   CHANGE CSECT NAME TO IEE6603D        15709802
         DROP  R1                                                       15711802
*/*CMDFAIL:5F3 M INDICATE PARAMETERS NOT ACCEPTED */                    15711902
FAILCMND L     R10,R10SAVE         GET ADDRESS OF BASEA                 15712202
         MVI   BAIPLCC,XFF         INDICATE COMMAND FAILED              15712302
*/*5G3 R RETURN TO RTM */                                               15719702
         BR    R14                 RETURN TO RTM                        15727402
*/*IEE0603D: END */                                                     15734802
         USING MODBASE,SBASE       RE-ESTABLISH ORIGINAL ADDRESSABILITY 15742202
         USING XSA,R2                                                   15749602
         EJECT                                                          15757002
* THE FOLLOWING TABLE CONTROLS THE SCAN OF INCOMING KEYWORDS AND THE  * 15764402
*   BRANCHING TO SPECIFIC KEYWORD SUBROUTINES.                        * 15771802
*                                                                     * 15779201
         DS    0H                                                       15829201
KEYTAB   EQU   *                                                        15879201
         DC    X'5'                KEYWORD LENGTH MINUS ONE             15929201
         DC    X'8'                PARAMETER DELIMITER                  15979201
         DC    C'CLOCK='           KEYWORD                              16029201
         B     SCLOCK              SPECIFIC CODING                      16079201
         DC    X'01'               KEYWORD ID MASK PATTERN              16129201
         DC    X'4'                CHARS TO FOLD MINUS ONE       Y02759 16179202
*                                                                     * 16229201
         DC    X'4'                KEYWORD LENGTH MINUS ONE             16279201
         DC    X'6'                PARAMETER DELIMITER                  16329201
         DC    C'DATE='            KEYWORD                              16379201
         DC    C' '                FILLER                               16429201
         B     SDATE               SPECIFIC CODING                      16479201
         DC    X'02'               KEYWORD ID MASK PATTERN              16529201
         DC    X'3'                CHARS TO FOLD MINUS ONE       Y02759 16539202
*                                                                     * 16629201
         DC    X'2'                KEYWORD LENGTH MINUS ONE      Y01040 16679202
         DC    X'0'                PARAMETER DELIMITER           Y01040 16729202
         DC    C'GMT'              KEYWORD                       Y01040 16779202
         DC    C'   '              FILLER                        Y01040 16829202
         B     SETNXT              SPECIFIC CODING               Y01040 16879202
         DC    X'04'               KEYWORD ID MASK PATTERN       Y01040 16929202
         DC    X'2'                CHARS TO FOLD MINUS ONE       Y02759 16939202
*                                                                     * 17029202
         DC    X'4'                KEYWORD LENGTH MINUS ONE      Y02759 17079202
         DC    X'2'                PARAMETER DELIMITER           Y02759 17129202
         DC    C'ADDR='            KEYWORD                       Y02759 17179202
         DC    C' '                FILLER                        Y02759 17229202
         B     SADDR               SPECIFIC CODING               Y02759 17279202
         DC    X'08'               KEYWORD ID MASK PATTERN       Y02759 17329202
         DC    X'3'                CHARS TO FOLD MINUS ONE       Y02759 17379202
*                                                                     * 17429201
         DC    X'4'                KEYWORD LENGTH MINUS ONE      Y02759 17479202
         DC    X'0'                PARAMETER DELIMITER           Y02759 17529202
         DC    C'RESET'            KEYWORD                       Y02759 17579202
         DC    C' '                FILLER                        Y02759 17629202
         B     SETNXT              SPECIFIC CODING               Y02759 17679202
         DC    X'10'               KEYWORD ID MASK PATTERN       Y02759 17729202
         DC    X'4'                CHARS TO FOLD MINUS ONE       Y02759 17779202
*                                                                     * 17829202
         DC    X'3'                KEYWORD LENGTH MINUS ONE      Y02759 17879202
         DC    X'2'                PARAMETER DELIMITER           Y02759 17929202
         DC    C'IPS='             KEYWORD                       Y02759 17979202
         DC    C'  '               FILLER                        Y02759 18029202
         B     SETNXT              SPECIFIC CODING               Y02759 18079202
         DC    X'20'               KEYWORD ID MASK PATTERN       Y02759 18129202
         DC    X'2'                CHARS TO FOLD MINUS ONE       Y02759 18179202
         EJECT                                                          18229201
* LIST FORM OF ESTAE MACRO                                              18239202
*                                                                       18249202
ESTAEL   ESTAE SERREXIT,PURGE=NONE,ASYNCH=NO,RECORD=YES,MF=L            18259202
ESTAELN  EQU   *-ESTAEL            LENGTH OF ESTAE PARMLIST             18269202
         EJECT                                                          18271202
* CONSTANTS USED BY THE IMMEDIATE COMMANDS ROUTINE                    * 18279201
*                                                                     * 18329201
         DS    0F                                                       18379201
         DC    X'0000'                                                  18429201
SFFFF    DC    X'FFFF'                                                  18479201
*                                                                     * 18529201
SETCADDR DC    C'15'               MAXIMUM CPU ADDR              Y02759 18539202
SETCHR   DC    C'23'               MAXIMUM HOUR                         18579201
SETCMS   DC    C'59'               MAXIMUM MINUTE OR SECOND             18629201
SETDDY   DC    C'366'              MAXIMUM DAY                          18679201
SET99    DC    C'99'               HIGH DATE COMPRAND                   18729201
C65      DC    C'65'               CHARS TO CHANGE CSECT NAME           18739202
C66      DC    C'66'               CHARS TO CHANGE CSECT NAME           18749202
*                                                                     * 18779201
SETSET   DC    C'SET     '         VERB FOR MESSAGE MODULE              18829201
SETRPLY  DC    C'RPLY HAS'                                       Y02759 18879202
SETDD0   DC    C'000'              DDD PORTION OF DATE, 000      Y01040 18929201
SETUC    DC    6X'40'              FOR FOLDING TO UPPER CASE     Y02759 18939202
SETID    DS    0CL24               ID FOR RECOVERY RECORD               18949202
         DC    CL8'IGC0003D'       LOAD MODULE NAME                     18959202
         DC    CL8'IEE0603D'       CSECT NAME                           18969202
         DC    CL8'SETCMFRR'       ERROR IDENTIFIER                     18971202
*                                                                     * 18979201
SETCLC   CLC   FOLDAREA(1),KEYWRD(R4) COMPARE NEW KEYWORD WITH TABLE    19029202
SETTMP   TM    XAE,X'00'           TEST ID MASK PATTERN                 19079202
SETMVC   MVC   FOLDAREA(1),0(R9)   MOVE TEXT TO WORKAREA                19089202
SETOC    OC    FOLDAREA(1),SETUC   FOLD TO CAPS                         19099202
*                                                                     * 19129201
H12      DC    H'12'               TEST VALUE FOR NO SDWA               19139202
D1000    DC    F'1000'             CONSTANT FOR SHIFTING OFF DDD OF     19179202
*                                      YYDDD CONVERTED TO BINARY        19189202
*                                                                     * 19229202
         DS   0F                                                 Y01029 19379201
VCON05   DC   V(IEE0503D)          ADDRESS OF IEE0503D           Y01029 19429201
VCON08   DC   V(IEE0803D)          ADDRESS OF IEE0803D           Y02759 19439202
VCON65   DC   V(IEE6503D)          ADDRESS OF IEE6503D           Y01029 19479201
VCON66   DC   V(IEE6603D)          ADDRESS OF IEE6603D           Y02759 19499202
         EJECT                                                          19509202
SETTCWA  DSECT                                                          19519202
TCWA     DS    0D                      TOD CLOCK WORKAREA               19521202
         DS    52C                                                      19523202
TCWAGFLG DS    1C                      GLOBAL TCWA FLAGS                19525202
MSGXXX   EQU   X'80'                   MSG XXX OUTSTANDING              19527202
MSGYYY   EQU   X'40'                   MSG YYY OUTSTANDING              19527302
MSGZZZ   EQU   X'20'                   MSG ZZZ OUTSTANDING              19527402
TCGNSET  EQU   X'08'                   TOD CLOCK NOT SET                19527502
         DS    1C                                                       19528602
TCCPUCNT DS    1H                      NUMBER OF TCWA ENTRIES           19528702
         DS    56C                                                      19528802
LTCWA    EQU   *-TCWA                  LENGTH OF TCWA                   19528902
         SPACE 10                                                       19529002
SETTCENT DSECT                                                          19529102
TCENTRY  DS    0D                      TOD CLOCK WORKAREA ENTRY         19529202
         DS    12C                                                      19545802
TCWAIADD DS    1H                      I-STREAM ADDRESS                 19555802
         DS    1C                                                       19557802
TCWALFLG DS    1C                      LOCAL FLAGS                      19558202
TCLCC    EQU   X'30'                                                    19558602
LENTRY   EQU   *-TCENTRY               LENGTH OF ENTRY                  19559802
         EJECT                                                          19562502
         IHASDWA                                                        19572502
         EJECT                                                          19574502
SETXSA   DSECT                                                          19579201
         IEEXSA                                                         19629201
         EJECT                                                          19639202
*                                                                       19649202
* THIS MAPS THE XASAVSTD FIELD OF THE EXTENDED XSA. IT IS USED          19659202
* FOR A REGISTER SAVEAREA, AND A WORKAREA FOR BOTH MAINLINE AND         19669202
* RECOVERY.                                                             19673202
*                                                                       19675202
         ORG   XASAVSTD            MAP ON EXTENDED SAVEAREA             19677202
FOLDAREA DS    8C                  WORKAREA FOR FOLDING KEYWORDS        19677602
EXITPARM DS    0CL28               PARM AREA USED BY ESTAE EXIT RTN     19678002
REGSAVE  EQU   EXITPARM            SAVEAREA FOR REGS 9 THRU 15          19678402
R9SAVE   DS    F                                                        19678802
R10SAVE  DS    F                                                        19678902
R11SAVE  DS    F                                                        19679002
R12SAVE  DS    F                                                        19679102
R13SAVE  DS    F                                                        19682402
R14SAVE  DS    F                                                        19684402
R15SAVE  DS    F                                                        19684802
         ORG   R15SAVE             MAP ON FIELD R15SAVE                 19685002
EXITFLGS EQU   *                   FLAGS FOR ESTAE EXIT RTN             19685202
CSECTCDE DS    C                   BITS 0 AND 1 ARE THE ONLY BITS USED  19685602
*                                    '00'B IS MODULE IEE0603D           19685702
*                                    '01'B IS MODULE IEE6503D           19685802
*                                    '11'B IS MODULE IEE6603D           19692002
         DS    3C                  RESERVED                             19695202
ESTAELST ESTAE SERREXIT,PURGE=NONE,ASYNCH=NO,RECORD=YES,MF=L            19697202
         EJECT                                                          19698202
         CVT   DSECT=YES                                                19704402
         EJECT                                                          19710602
         IEAVVTPC                                                       19716802
         EJECT                                                          19723002
         IEEBASEA                                                       19729201
         END                                                            19779201
./  ADD  SSI=30292090,NAME=IEE0703D
         TITLE 'IEE0703D--STOP AND MODIFY COMMANDS'                     00200019
*********************************************************************** 00420015
*                                                                     * 00620015
*  MODULE NAME =  IEE0703D                                       Y02669 00620202
*                                                                     * 01020015
*  DESCRIPTIVE NAME =  MODIFY AND STOP COMMAND HANDLER           Y02669 01020202
*                                                                       01020402
*  COPYRIGHT =  NONE                                             Y02669 01020602
*                                                                       01020802
*  STATUS =  OS/VS2 - RELEASE 2                                  Y02669 01021002
*                                                                       01021202
*  FUNCTION =                                                    Y02669 01021402
*   PROCESS MODIFY AND NON-PERIODIC STOP COMMANDS, BOTH OF WHICH      * 01220002
*   INVOLVE SEARCHING THE CSCB FOR CONTROL ELEMENTS. THIS MODULE      * 01420002
*   PERFORMS POSITIVE SYNTAX CHECKING, MARKS CHAIN ELEMENTS, POSTS    * 01620002
*   APPROPRIATE ECB'S, AS WELL AS BUILDING AND CHAINING CIBS.    Y02669 01820002
*                                                                     * 02020015
*     OPERATION =                                                Y02669 02020202
*        1.  OPERAND SYNTAX IS CHECKED.                          Y02669 02020402
*            STOP  -  ONLY 'TASKNAME' OR 'PROCNAME.TASKNAME',    Y02669 02020602
*                     DELIMITED BY A BLANK OR END OF BUFFER, ARE Y02669 02020802
*                     PERMITTED.                                 Y02669 02021002
*            MODIFY - THE FIRST OPERAND MUST BE 'TASKNAME' OR    Y02669 02021202
*                     'PROCNAME.TASKNAME', DELIMITED BY A COMMA. Y02669 02021402
*            IF THESE CONDITIONS ARE NOT MET, CONTROL WILL PASS  Y02669 02021602
*            TO THE MESSAGE MODULE TO ISSUE THE MESSAGES         Y02669 02021802
*            AT THE ERROR EXITS.                                 Y02669 02022002
*                                                                       02022202
*        2.  ENQ EXCLUSIVE ON THE CSCB CHAIN AND SEARCH CHAIN    Y02669 02022602
*            FOR CSCB CORRESPONDING TO THE NAME SPECIFIED ON THE Y02669 02022702
*            COMMAND.  THE DETAILS OF THIS SCAN APPEAR IN THE    Y02669 02022802
*            BLOCK COMMENT IMMEDIATELY PRECEEDING THE SCAN.  IF  Y02669 02023002
*            NO SUCH CSCB IS FOUND, CONTROL IS PASSED TO THE     Y02669 02023202
*            MESSAGE MODULE TO ISSUE THE MESSAGE INDICATED AT    Y02669 02023402
*            THE ERROR EXIT.                                     Y02669 02023602
*                                                                       02023802
*        3. IF THE CSCB IS FOUND, A COMMAND INPUT BUFFER (CIB)   Y02669 02024002
*           IS CONSTRUCTED IN SUBPOOL 245 TO CONTAIN THE COMMAND Y02669 02024202
*           OPERANDS, THE COMMAND CODE, AND THE CONSOLE ID.  IT  Y02669 02024402
*           IS CHAINED TO THE CSCB, UNLESS DOING SO WOULD CAUSE  Y02669 02024602
*           THE CIB COUNT IN THE CSCB TO BE EXCEEDED. THIS WOULD Y02669 02025002
*           INDICATE THAT THE NUMBER OF OUTSTANDING MODIFIES AC- Y02669 02025102
*           CEPTED BY THIS JOB WOULD BE EXCEEDED.  THE CIB,      Y02669 02025202
*           THEREFORE, IS NOT CHAINED.  THE SEARCH OF THE CSCB   Y02669 02025302
*           CHAIN THEN CONTINUES UNTIL THE CHAIN IS EXHAUSTED.   Y02669 02025702
*           A STOP CIB IS CHAINED UNCONDITIONALLY.               Y02669 02026102
*                                                                       02026402
*        4.  POST THE STOP/MODIFY ECB IN THE CSCB AND SCAN FOR   Y02669 02026602
*            THE NEXT CSCB. WHEN ALL CSCBS ON THE CHAIN HAVE     Y02669 02027002
*            BEEN EXAMINED AND PROCESSED, IF NECESSARY, DEQ OFF  Y02669 02029502
*            THE CSCB CHAIN RESOURCE. CONTROL THEN RETURNS TO    Y02669 02039502
*            THE CALLER.                                         Y02669 02039902
*                                                                       02040002
*        5.  IF THE CONDITIONAL GETMAIN FOR THE CIB FAILS,       Y02669 02042502
*            CONTROL WILL PASS TO THE APPROPRIATE ERROR EXIT.    Y02669 02045002
*                                                                       02047502
*  NOTES =                                                       Y02669 02050002
*          BECAUSE OF THE IMPLEMENTATION OF THE MASTER SUBSYSTEM Y02669 02052502
*          IN OS/VS2-2, ALL REFERENCES TO THE GROUP CONTROL      Y02669 02055002
*          BLOCK (GCB) HAVE BEEN REMOVED FROM THIS MODULE.       Y02669 02057502
*                                                                       02060002
*          THIS MODULE FORMERLY PROCESSED PERIODIC STOP COMMANDS Y02669 02062502
*          IN ADDITION TO ITS PRESENT FUNCTIONS.  AS OF RELEASE  Y02669 02065002
*          18, PERIODIC STOP COMMANDS WERE PROCESSED IN MODULE   Y02669 02067502
*          IEE4503D AND NON-PERIODIC STOP COMMANDS WERE SYNTAX   Y02669 02070002
*          CHECKED IN THE SAME MODULE.  IN 0S/VS2-2, IEE4503D    Y02669 02072502
*          WAS SPLIT, AS IT NO LONGER HAD TO RUN IN A 1K         Y02669 02075002
*          TRANSIENT AREA.  IN OS/VS2-2, THEREFORE, NON-PERIODIC Y02669 02077502
*          STOP AND MODIFY COMMANDS ARE SYNTAX CHECKED AND       Y02669 02080002
*          PROCESSED IN IEE0703D, WHILE PERIODIC COMMANDS ARE    Y02669 02082502
*          PROCESSED IN IEE5503D.  IEE4503D NO LONGER EXISTS IN  Y02669 02085002
*          OS/VS2-2.                                             Y02669 02087502
*                                                                       02090002
*     CHARACTER CODE DEPENDENCIES =                              Y02669 02092502
*          THIS MODULE HAS BEEN CODED IN SUCH A WAY THAT IF THE  Y02669 02095002
*          EXTERNAL CHARACTER SET IS CHANGED FROM EBCDIC,        Y02669 02097502
*          REASSEMBLY WILL YIELD A VALID MODULE.                 Y02669 02100002
*                                                                       02102502
*     DEPENDENCIES = CROSS MEMORY POST, ENQ, DEQ, GETMAIN,       Y02669 02105002
*                    FREEMAIN, SYSEVENT                          Y02669 02107502
*                    FIB (SVC 100) - TO PREVENT MODIFY FROM      Y02669 02109502
*                    BEING ISSUED FROM A TIME-SHARING TERMINAL   Y02669 02109902
*                    IN OPERATOR MODE.                           Y02669 02112402
*                                                                       02117502
*     RESTRICTIONS =  THIS MODULE EXPECTS REGISTER TWO TO        Y02669 02120002
*                     CONTAIN THE ADDRESS OF THE EXTENDED SAVE   Y02669 02122502
*                     AREA.                                      Y02669 02125002
*                                                                       02127502
*     REGISTER CONVENTIONS =                                     Y02669 02130002
*                  REGISTER 0       POST CODE REGISTER           Y02669 02132502
*                  REGISTER 9       ADDRESS OF COMMAND OPERANDS  Y02669 02135002
*                  REGISTER 10      ADDRESS OF MASTER RESIDENT   Y02669 02137502
*                                   CORE (IEEBASEA)              Y02669 02140002
*                  REGISTER 11      ADDRESS OF CSCB              Y02669 02142502
*                  REGISTER 12      MODULE BASE                  Y02669 02145002
*                  REGISTER 14      RETURN ADDRESS               Y02669 02147502
*                  REGISTER 15      BRANCH ADDRESS OF SUCCESSOR  Y02669 02150002
*                                                                       02152502
*     PATCH-LABEL =  PATCH                                       Y02669 02155002
*                                                                       02157502
*  MODULE-TYPE =  CSECT                                          Y02669 02160002
*                                                                       02162502
*     PROCESSOR =  ASSEMBLER                                     Y02669 02165002
*                                                                       02167502
*     MODULE-SIZE =                                              Y02669 02170002
*                                                                       02172502
*     ATTRIBUTES =                                               Y02669 02175002
*                 PAGED LPA                 REENTRANT            Y02669 02177502
*                 ZERO PSW PROTECT KEY      REUSABLE             Y02669 02180002
*                 SUPERVISOR MODE           REFRESHABLE          Y02669 02182502
*                                                                       02185002
*  ENTRY POINT =  IEE0703D, FROM IEE0403D                        Y02669 02187502
*                                                                       02190002
*     PURPOSE =  TO SCHEDULE EXECUTION OF A STOP OR A MODIFY     Y02669 02192502
*                COMMAND BY BUILDING A CIB, CHAINING IT TO THE   Y02669 02195002
*                CSCB CORRESPONDING TO THE SPECIFIED TASK, AND   Y02669 02197502
*                POSTING THE STOP/MODIFY ECB IN THAT CSCB.       Y02669 02200002
*                                                                       02202502
*     LINKAGE =  REGISTER TWO CONTAINS THE ADDRESS OF AN XSA     Y02669 02205002
*                INITIALIZED AS FOLLOWS:                         Y02669 02207502
*                  XAR POINTS TO THE COMMAND BUFFER.                  * 02210002
*                  XAN CONTAINS THE VERB CODE.                        * 02212502
*                  XAL POINTS TO THE COMMAND PARAMETER LIST.          * 02215002
*                  XAV CONTAINS THE VERB IN EBCDIC.                   * 02217502
*                  XAA CONTAINS THE ASID                         Y02669 02220002
*                                                                     * 04620015
*     INPUT DATA =  AS DESCRIBED ABOVE                           Y02669 04620202
*                                                                       04620402
*     REGISTERS SAVED =  NONE                                    Y02669 04620602
*                                                                       04620802
*     REGISTER CONTENTS DURING PROCESSING =                      Y02669 04621002
*                       SEE REGISTER CONVENTIONS                 Y02669 04621202
*                                                                       04621402
*     REGISTERS RESTORED =  NONE                                 Y02669 04621602
*                                                                       04621802
*  EXIT-NORMAL =  GOBACK                                         Y02669 04622002
*     CONDITIONS =  PROCESSING COMPLETED SUCCESSFULLY            Y02669 04622202
*                   EXIT TAKEN VIA BRANCH TO THE ADDRESS IN      Y02669 04622402
*                   REGISTER 14.                                 Y02669 04622602
*                                                                       04622802
*     OUTPUT DATA =  CIB, CHAINED TO POSTED CSCB.                Y02669 04623002
*                                                                       04623202
*     RETURN CODES =  REGISTER 15 IS SET TO ZERO                 Y02669 04623402
*                                                                       04623602
*  EXIT-ERROR =  CMERR8                                          Y02669 04623802
*     CONDITIONS =  EITHER PROCNAME OR TASKNAME EXCEEDS EIGHT    Y02669 04624002
*                   CHARACTERS, OR A PARAMETER OTHER THAN THESE  Y02669 04624402
*                   APPEARS ON STOP.                             Y02669 04624502
*                   EXIT TO MESSAGE MODULE (IEE0503D) VIA BRANCH Y02669 04624602
*                   ON VCON TO ISSUE MESSAGE IEE308I.            Y02669 04624802
*                                                                       04625002
*     OUTPUT DATA =  REGISTER TWO POINTS TO AN XSA CONTAINING:   Y02669 04625202
*                    XAE     MESSAGE CODE X'08'                  Y02669 04625402
*                    XAV     COMMAND VERB                        Y02669 04625602
*                    XAU     CONSOLE ID FOR WTO                  Y02669 04625702
*                    XAA     ASID FOR TPUT                       Y02669 04625802
*                                                                       04632902
*     RETURN CODES =  REGISTER 15 IS SET TO FOUR.                Y02669 04633002
*                                                                       04633102
*  EXIT-ERROR =  CMERRC                                          Y02669 04633202
*     CONDITIONS =  NO OPERANDS APPEAR ON THE COMMAND, OR ON     Y02669 04633302
*                   MODIFY, ONLY TASKNAME (OR PROCNAME.TASKNAME) Y02669 04633402
*                   APPEARS.                                     Y02669 04633502
*                   EXIT TO MESSAGE MODULE (IEE0503D) VIA BRANCH Y02669 04633602
*                   ON VCON TO ISSUE MESSAGE IEE311I.            Y02669 04633702
*                                                                       04633802
*     OUTPUT DATA =  REGISTER TWO POINTS TO AN XSA CONTAINING:   Y02669 04633902
*                    XAE     MESSAGE CODE X'0B'                  Y02669 04634002
*                    XAV     COMMAND VERB                        Y02669 04634102
*                    XAU     CONSOLE ID FOR WTO                  Y02669 04634202
*                    XAA     ASID FOR TPUT                       Y02669 04636002
*                                                                       04638102
*     RETURN CODES =  REGISTER 15 IS SET TO FOUR.                Y02669 04638202
*                                                                       04638302
*  EXIT-ERROR =  CMERR36                                         Y02669 04638402
*     CONDITIONS =  SPECIFIED TASK HAS NO CSCB, AND IS, THUS,    Y02669 04638502
*                   NOT ACTIVE.                                  Y02669 04638602
*                   EXIT TO MESSAGE MODULE (IEE0503D) VIA BRANCH Y02669 04638702
*                   ON VCON TO ISSUE MESSAGE IEE341I.            Y02669 04638802
*                                                                       04638902
*     OUTPUT DATA =  REGISTER TWO POINTS TO AN XSA CONTAINING:   Y02669 04639002
*                    XAE     MESSAGE CODE X'24'                  Y02669 04639102
*                    XAV     TASK NAME                           Y02669 04639202
*                    XAU     CONSOLE ID FOR WTO                  Y02669 04639302
*                    XAA     ASID FOR TPUT                       Y02669 04641002
*                                                                       04642902
*     RETURN CODES =  REGISTER 15 IS SET TO FOUR.                Y02669 04643002
*                                                                       04643102
*  EXIT-ERROR =  CMERR37                                         Y02669 04643202
*     CONDITIONS =  COMMAND NOT EXECUTED, FOR ALL CSCB'S WITH    Y02669 04643302
*                   APPROPRIATE NAME HAVE REACHED THEIR MAXIMUM  Y02669 04643402
*                   CIB COUNT.  SINCE STOP CIB'S ARE CHAINED     Y02669 04643502
*                   UNCONDITIONALLY, THIS MESSAGE APPLIES ONLY   Y02669 04643602
*                   TO MODIFY.                                   Y02669 04643702
*                   THIS MESSAGE IS ALSO ISSUED IF AN ATTEMPT IS Y02669 04645202
*                   MADE TO STOP OR MODIFY A TASK CREATED IN     Y02669 04647202
*                   RESPONSE TO A MOUNT COMMAND.                 Y02669 04647602
*                   EXIT TO MESSAGE MODULE (IEE0503D) VIA BRANCH Y02669 04647902
*                   ON VCON TO ISSUE MESSAGE IEE342I.            Y02669 04649402
*                                                                       04650902
*     OUTPUT DATA =  REGISTER TWO POINTS TO AN XSA CONTAINING:   Y02669 04652402
*                    XAE     MESSAGE CODE X'25'                  Y02669 04653902
*                    XAV     COMMAND VERB                        Y02669 04655402
*                    XAU     CONSOLE ID FOR WTO                  Y02669 04656902
*                    XAA     ASID FOR TPUT                       Y02669 04658402
*                                                                       04659902
*                                                                       04661402
*     RETURN CODES =  REGISTER 15 IS SET TO FOUR.                Y02669 04662902
*                                                                       04664402
*  EXTERNAL REFERENCES =                                         Y02669 04666402
*                                                                       04668402
*     REFERENCES =  IEE0503D  MESSAGE MODULE                     Y02669 04668802
*                                                                       04669202
*     DATA AREAS =  25 BYTE ENQ/DEQ PRARMETER LIST IN SP 255     Y02669 04670402
*                                                                       04672402
*     CONTROL BLOCKS =                                           Y02669 04674402
*             XSA     USED                                       Y02669 04676402
*             CSCB    USED                                       Y02669 04678402
*             BASEA   USED                                       Y02669 04680402
*             CIB     CREATED                                    Y02669 04682402
*             ASVT    USED                                       Y02657 04682802
*                                                                       04683202
*     TABLES =                                                   Y02669 04684402
*                                                                       04686402
*     MACROS =  IEECHAIN, IEEBASEA, IEEXSA, IEZCIB, CVT,         Y02669 04688402
*               GETMAIN, FREEMAIN, ENQ, DEQ, MODID, SYSEVENT     Y02669 04690402
*               IHAASVT                                          Y02657 04690802
*                                                                       04692402
*     ENQUEUE RESOURCES =       QNAME             RNAME          Y02669 04694402
*                               SYSIEFSD          Q10            Y02669 04696402
*                                                                       04698402
*     CHANGE LEVEL =  Y02651, Y02657, Y02669                     Y02669 04700402
*                                                                       04702402
*  MESSAGES =                                                    Y02669 04704402
*        CODE                   TEXT                             Y02669 04706402
*        X'08'          IEE308I  (VERB)      TERM LENGTH ERROR   Y02669 04708402
*        X'0B'          IEE311I  (VERB)      PARAMETER MISSING   Y02669 04710402
*        X'24'          IEE341I  (TASKNAME)  NOT ACTIVE          Y02669 04712402
*        X'25'          IEE342I  (VERB)      REJECTED-TASK BUSY  Y02669 04714402
*                                                                     * 04766402
*        ALL MESSAGES CONTAINED IN AND ISSUED BY IEE0503D.       Y02669 04816402
*                                                                     * 14620015
*  SYSGEN =  THIS MODULE IS IN LOAD MODULE IGC0003D IN           Y02669 14620202
*            SYS1.LPALIB.  IT IS INCLUDED AT SYSGEN FROM DLIB    Y02669 14620402
*            AOSB3 BY SYSGEN MACRO SGIEF441.                     Y02669 14620602
*                                                                       14620802
*  SYSTEM LIBRARIES =  THIS MODULE MAKES REFERENCE TO NO SYSTEM  Y02669 14621002
*                      LIBRARIES.                                Y02669 14621202
*                                                                     * 15220015
*********************************************************************** 15420015
         EJECT                                                          15620015
**************************************************************** Y02669 15670002
*                                                                       15672002
*        REGISTER EQUATES                                        Y02669 15674002
*                                                                       15676002
**************************************************************** Y02669 15678002
         SPACE 2                                                        15678402
IEE0703D CSECT                                                          15680020
R0       EQU   0                             POST CODE REG              16220015
R1       EQU   1                                                        16420015
R2       EQU   2                             XSA BASE                   16620015
R3       EQU   3                             WORK                       16820015
R4       EQU   4                             ECB POINTER                17020015
R5       EQU   5                                                        17220015
R6       EQU   6                                                        17420015
R7       EQU   7                                                        17620015
R8       EQU   8                                                        17820015
R9       EQU   9                             DATA POINTER               18020015
R10      EQU   10                            MASTER RESIDENT CORE       18220015
R11      EQU   11                            CSCB POINTER               18420015
R12      EQU   12                            MODULE BASE                18620015
R13      EQU   13                                                       18820015
R14      EQU   14                                                       19020015
R15      EQU   15                                                       19220015
         EJECT                                                          19260002
**************************************************************** Y02669 19262002
*                                                                       19264002
*        EQUATES FOR LENGTHS, OFFSETS, AND CONSTANTS             Y02669 19264402
*                                                                       19264802
**************************************************************** Y02669 19265202
         SPACE 2                                                        19265602
D0       EQU   0                                                  20030 19266020
D1       EQU   1                                                  20030 19272020
D2       EQU   2                                                  20030 19278020
D3       EQU   3                                                    O99 19280002
D4       EQU   4                                                  20030 19284020
D5       EQU   5                                                 Y02669 19286002
D7       EQU   7                                                  20030 19296020
D8       EQU   8                                                  20030 19302020
D9       EQU   9                                                 Y02669 19312002
D24      EQU   24                                                 20030 19326020
D255     EQU   255                                                20030 19326402
ZERO     EQU   X'00'                                              20030 19332020
X28      EQU   28                                                 20030 19338020
XFF      EQU   X'FF'                                              20030 19344020
BLANK    EQU   C' '               CHARACTER BLANK                Y02669 19346002
COMMA    EQU   C','               CHARACTER COMMA                Y02669 19356002
PERIOD   EQU   C'.'               CHARACTER PERIOD               Y02669 19366002
SUBCIB   EQU   245                SUBPOOL FOR CIB                Y02669 19378402
         SPACE                                                          19380018
* VERB CODES FOR THIS MODULE                                          * 19420015
STOPCOD  EQU   64                  STOP CODE                     Y02669 19470002
MODCOD   EQU   68                  MODIFY CODE                   Y02669 20020002
MTERR    EQU   X'0C'               MOUNT CODE                     24131 20030002
* POST CODES FOR THIS MODULE                                     Y02669 20070002
CMMDCODE EQU   X'08'               MODIFY NON GROUP POST CODE           20220015
CMSTCODE EQU   X'10'               STOP NON GROUP POST CODE             20620015
* ERROR CODES FOR MESSAGE MODULE                                      * 21020015
CMCD05   EQU   5                             INVALID COMMAND     Y02669 21070002
CMCD08   EQU   8                             TERM LENGTH ERROR          21620015
CMCD0B   EQU   11                            PARAMETER MISSING          22020015
CMCD36   EQU   36                            TASK NOT FOUND             22420015
CMCD37   EQU   37                            MODIFY NOT PROCESSED       22470002
CMCD58   EQU   58                            COMMAND ABORTED     Y02669 22520002
         EJECT                                                          22720002
* ENTRY ROUTINE - THIS PORTION OF CODE ESTABLISHES ADDRESSABILITY FOR * 25020015
*   THE PROGRAM AND THE VARIOUS DSECTS, SETS UP THE EXTENDED SAVE AREA* 25220015
*                                                                     * 25820015
         BALR  R12,0              ESTABLISH ADDRESSABILITY              26020002
         USING *,R12              FOR PROGRAM                           26220002
         MODID BRANCH=YES                                        Y01886 26270001
         USING XSA,R2             FOR XSA                               26420002
         L     R3,CVTPTR                                          20030 26460020
         USING CVT,R3                                             20030 26500002
         L     R10,CVTMSER                                        20030 26540020
         DROP  R3                 DROP CVT ADDRESSABILITY        Y02657 26590002
         USING BASE,R10           FOR MASTER CORE                       26620002
         L     R11,BACHN          BASE FOR CHAIN IS R11                 26820002
         USING CMCHAIN,R11                                              27020015
* SEE IF POINTER TO COMMAND OPERANDS IS ZERO. ERROR IF SO.       Y02669 27070002
         L     R9,XAL             PNTR TO COMMAND OPERANDS       Y02669 27120002
         LA    R9,D0(R9)          CLEAR HI ORDER BYTE            Y02669 27170002
         LTR   R9,R9              ANY PARMS                      Y02669 27180002
         BZ    CMERRC             NO. PARAM MISSING ERROR        Y02669 27190002
* ACCESS LENGTH INDICATOR OF COMMAND BUFFER TO CALCULATE ADDRESS Y02669 27200002
* OF END OF COMMAND BUFFER.  STORE THIS ADDRESS IN XSA.          Y02669 27210002
         L     R7,XAR             PNTR TO LNGTH INDICATOR        Y02669 27212002
         LA    R7,D0(R7)          CLEAR HI ORDER BYTE            Y02669 27214002
         LH    R6,D0(R7)          GET LENGTH                     Y02669 27216002
         AR    R7,R6              GET ADDRS END OF CIB           Y02669 27218002
         ST    R7,XAP             SAVE IN XSA                    Y02669 27218402
         MVI   XAX,BLANK          JOBNAME HOLDING AREA           Y02669 27219602
         MVC   XAX+D1(D7),XAX     IS PADDED WITH BLANKS          Y02669 27219702
         MVC   XAS(D8),XAX        XAS AS WELL                    Y02669 27219802
CMSTTASK EQU   *                                                 Y02669 27219902
         LR    R7,R9              PARAMETER AREA PTR             Y02669 27269902
         LA    R3,D9              MAX LENGTH INDICATOR           Y02669 27279902
         EJECT                                                          27280302
**************************************************************** Y02669 27281902
*                                                                Y02669 27283902
*   THE SYNTAX CHECK ROUTINE CHECKS FOR A STOP OR MODIFY COMMAND Y02669 27284002
*   WITH EITHER A TASKNAME OR A PROCNAME IN ONE OF THE FOLLOWING Y02669 27284102
*   FORMATS WHERE A IS PROCNAME AND B IS TASKNAME.               Y02669 27284202
*   (1) P A (2) P B (3) P A, (4) P B, (5) P A.B                  Y02669 27285102
*   (6) P A.B,                                                   Y02669 27285502
*   IN ADDITION, ON THE MODIFY COMMAND, A BLANK AFTER THE FIRST  Y02669 27285902
*   OPERAND IS INVALID AND THE PARM MISSING ERROR MSG IS         Y02669 27286302
*   ISSUED. IF THE PROCNAME IS SPECIFIED AS WELL AS THE TASK-    Y02669 27286702
*   NAME, THE PROCNAME IS MOVED TO XAS AND THE TASKNAME IS       Y02669 27286802
*   MOVED TO XAV AND XAX.  IF ONLY ONE OF THE TWO IS SPECIFIED   Y02669 27286902
*   IT IS PLACED IN XAV AND XAX.  IN THE CSCB SEARCH ROUTINE     Y02669 27289502
*   THESE FIELDS ARE USED AS COMPARANDS IN THE SCAN AGAINST      Y02669 27291502
*   CHKEY (OR CHUNIT) AND CHCLS.                                 Y02669 27291902
*                                                                Y02669 27292102
**************************************************************** Y02669 27294702
CMSTNEXT EQU   *                                                 Y02669 27297302
         C     R7,XAP             HAS END OF BUFFER BEEN REACHED Y02669 27299902
         BE    MDFYTEST           YES. TEST FOR MODIFY COMMAND   Y02669 27309902
         CLI   D0(R7),BLANK       IS CHARACTER A BLANK           Y02669 27311902
         BE    MDFYTEST           YES. TEST FOR MODIFY           Y02669 27313902
         CLI   D0(R7),COMMA       IS CHAR A COMMA                Y02669 27315902
         BE    STOPTST            YES, TEST FOR STOP COMMAND     Y02669 27317902
         CLI   D0(R7),PERIOD      IS CHAR A PERIOD               Y02669 27318302
         BE    CMPRCNME           YES. MOVE PARM TO XSA          Y02669 27318702
         LA    R7,D1(R7)          INCREMENT PTR                  Y02669 27319102
         BCT   R3,CMSTNEXT        TEST NEXT CHARACTER            Y02669 27319502
         B     CMERR8             TERM LENGTH ERROR              Y02669 27319602
STOPTST  EQU   *                                                 Y02669 27329602
         CLI   XAN,STOPCOD        STOP COMMAND                   Y02669 27331602
         BE    CMERR8             YES, TERM LENGTH ERROR -  NO   Y02669 27333602
*                                 OPERANDS ALLOWED AFTER NAME    Y02669 27336002
         B     CMTSKNME           NO, MOVE TASKNAME TO XSA       Y02669 27336102
MDFYTEST EQU   *                                                 Y02669 27336402
         CLI   XAN,MODCOD         MODIFY COMMAND                 Y02669 27344802
         BE    CMERRC             YES. PARM MISSING-ERROR        Y02669 27353202
CMTSKNME EQU   *                                                 Y02669 27363202
         LA    R4,D8              NAME LENGTH                    Y02669 27373202
         SR    R4,R3              TEST FOR LENGTH ERROR          Y02669 27383202
         EX    R4,CMMVCX          MOVE TASKNAME TO XAX           Y02669 27385602
         MVC   XAV(D8),XAX        MOVE TASKNAME TO XAV           Y02669 27386002
         LA    R7,D1(R7)          INCREMENT PTR                  Y02669 27386402
         C     R7,XAP             PAST END OF BUFFER?            Y02669 27388402
         BL    CMST1              NO, CONTINUE PROCESSING        Y02669 27390402
         BCTR  R7,0               YES, BRING OPERAND POINTER     Y02669 27392402
*                                 BACK INTO BUFFER               Y02669 27394402
         B     CMST1              CONTINUE PROCESSING            Y02669 27396402
CMPRCNME EQU   *                                                 Y02669 27415702
         CLI   XAX,BLANK          HAS PROCNAME BEEN RECEIVED     Y02669 27416102
         BNE   CMERR8             YES, TERM LENGTH ERROR         Y02669 27416202
         LA    R4,D8              PROCNAME LENGTH CHECK          Y02669 27466202
         SR    R4,R3              EXCEED MAXIMUM?                Y02669 27476202
         BM    CMERR8             TERM LENGTH ERROR              Y02669 27486202
         EX    R4,CMMVCY          MOVE PROCNAME TO XAS           Y02669 27496202
         LA    R7,D1(R7)          UPDATE TO NEXT CHAR            Y02669 27506202
         LR    R9,R7              POINT TO TASKNAME              Y02669 27508202
         B     CMSTTASK           RETURN TO SCAN                 Y02669 27510202
         EJECT                                                          50020002
**********************************************************************  52620015
*                                                                       52820015
* CSCB SCAN ROUTINE SCANS CSCB CHAIN STARTING WITH PTR IN R11,     I272 52900019
* SEARCHING 1ST FOR EQUAL ON CHKEY AND TASKNAME IN XAX AND, IF     I272 52980019
* NO MATCH, THEN FOR EQUAL ON CHUNIT AND TASKNAME. CSCB NOT        I272 53060019
* FOUND RESULTS IN AN ERROR MESSAGE.                               I272 53140019
*                                                                       53220015
* THE CSCB CHAIN RESOURCE IS SERIALIZED VIA ENQ ON Q10. THE      Y02651 53270002
* RESOURCE IS RELEASED IN SUBROUTINE CMDEQ.                      Y02651 53320002
*                                                                       53370002
* THE HOLDER OF THE CSCB ENQ MUST BE NON-SWAPPABLE TO PREVENT    Y02651 53380002
* SWAP OUT WHILE HOLDING THE RESOURCE, WITH THE PERFORMANCE      Y02651 53390002
* DEGRADATION WHICH WOULD RESULT WHEN ANOTHER ENQ IS ISSUED TO   Y02651 53400002
* OBTAIN THE RESOURCE.                                           Y02651 53410002
**********************************************************************  53420015
CMST1    EQU   *                                                        53620015
         SYSEVENT DONTSWAP        DON'T SWAP CURRENT MEMORY      Y02651 53630002
         MVC   XASAVSTD(LNE),ENQCSCB MOVE IN ENQ PARM LIST       Y02651 53654402
         ENQ   MF=(E,XASAVSTD)    RESERVE CSCB CHAIN             Y02651 53654802
         SPACE 2                                                        53656002
         MVI   XAE,ZERO            CLEAR EXIT CONDITION SWITCH   Y02669 53658002
*                                  BYTE                          Y02669 53658402
CMSCAN1  LTR   R11,R11             END OF CSCB CHAIN               I272 53660019
         BZ    CMFAIL              YES. CHECK FOR POSTED CSCB      I272 53680019
         TM    CHSTS,CHAP          ASSIGNMENT PENDING              I272 53720019
         BNZ   CMCONT              YES. CONTINUE SCAN            Y02669 53740002
         CLC   CHKEY,XAX           DO TASKNAMES MATCH              I27I 53760019
         BE    CMGO                YES                              O99 53780019
         CLC   CHUNIT(D3),XAX      DO UNIT NAMES MATCH              O99 53800019
         BNE   CMCONT              NO. GET NEXT CSCB             Y02669 53820002
         CLI   XAX+D3,BLANK        INSURE PROPER UNIT NAME LENGTH   O99 53840019
         BNE   CMCONT              UNEQUAL LNS. CHECK NEXT CSCB     O99 53860002
CMGO     EQU   *                   CORRECT CSCB FOUND            Y02669 53880002
         CLI   XAS,BLANK                     WAS PROCNAME SPECIFIED     54020015
         BE    CMSTHIT                       NO. THIS CSCB              54220015
         CLC   CHCLS(8),XAS        PROCNAMES EQUAL                      54420015
         BE    CMSTHIT             YES. THIS CSCB                  I272 54500019
         B     CMCONT              CSCB NOT FOUND. GO GET        Y02669 54580002
*                                  PTR TO NEXT CSCB              Y02669 54660002
CMSTHIT  EQU   *                                                        54820015
         CLI   CHVCD,MTERR         IS CSCB FOR MOUNT              24131 55470002
         BNE   NOTMOUNT            YES.ERROR                     Y02669 55510002
         BAL   R9,CMDEQ            DEQ OFF CSCB CHAIN            Y02651 55520002
         B     CMERR37             SET TASK BUSY MSG CODE        Y02669 55530002
NOTMOUNT EQU   *                   NOT A MOUNT CSCB              Y02669 55540002
*                                                                       55590002
* THE CSCB IS A CANDIDATE TO ACCEPT A STOP OR MODIFY.  SO,       Y02669 55670002
*         GO BUILD A CIB AND ATTEMPT TO CHAIN IT TO THE CSCB.    Y02669 55720002
*                                                                       55770002
         BAL   R9,CMCIBLD          LINK TO CIB BUILD ROUTINE            68020002
         LTR   R15,R15             HAS CIB BEEN CHAINED?         Y02669 68070002
         BZ    CM003               YES. GO TO POST CSCB.         Y02669 68120002
         SPACE                                                          68520002
* THE CIB CANNOT BE CHAINED BECAUSE THE CHCIBCTR IN THE CSCB            68820018
*        INDICATED THAT THIS COMMAND WOULD EXCEED THE MAXIMUM NBR       69020018
*        ALLOWED BY THE PROCESSING TASK.  THE CIB IS FREED AND          69220018
*        THE NEXT CSCB IS TRIED.                                        69420018
*                                                                       69620018
         USING CIBDSECT,R1                                        20030 69820020
         SR    R0,R0              GET THE EXACT LENGTH OF THE CIB       70020018
         IC    R0,CIBLEN              FROM THE COUNT OF DOUBLE WORDS    70220018
         SLL   R0,3                   PREVIOUSLY STORED.                70420018
         O     R0,CMSUB245         SET SUBPOOL NUMBER 245         20030 70620020
         FREEMAIN R,LV=(0),A=(1)                                        71020018
         CLI   XAE,XFF            TEST FOR POSTED ECB                   71420002
         BE    CMCONT             POSTED.  GET NEXT CSCB.               71620018
         MVI   XAE,CMCD37         MODIFY PENDING INDICATOR              71820002
CMCONT   DS    0H                                                       72020018
         L     R11,CHPTR          GET POINTER TO NEXT CSCB.             72220018
         B     CMSCAN1            PROCESS IT                     Y02669 72420002
         SPACE                                                          72430002
* SET POST CODE IN REGISTER ZERO                                 Y02669 72440002
*        MODIFY                    X'00000008'                   Y02669 72450002
*        STOP                      X'00000010'                   Y02669 72460002
         SPACE                                                          72462002
CM003    DS    0H                                                       72470002
         MVC   CHUCMP,XAU          UPDATE UCMI IN CSCB           Y02669 72520002
         CLI   XAN,MODCOD          MODIFY COMMAND                Y02669 72620002
         BE    MPOSTCOD            YES. GET MODIFY POST CODE     Y02669 72670002
         LA    R0,CMSTCODE         LOAD STOP POST CODE           Y02669 72720002
         MVI   CHCIBCTR,ZERO       STOP ALL COMMANDS             Y02669 72770002
         B     SETECB              LOCATE ECB FOR XMPOST         Y02669 72820002
MPOSTCOD LA    R0,CMMDCODE         LOAD MODIFY POST CODE         Y02669 73070002
         EJECT                                                          73320002
* POST ROUTINE HAS AS INPUT, R0 CONTAINING A COMPLETION CODE, R4 Y02657 73420002
*   CONTAINING A POINTER TO AN ECB, R6 CONTAINING A POINTER TO   Y02657 73620002
*   THE ASCB AND R7 CONTAINGIN A POINTER TO THE CVT.  THE        Y02657 73670002
*   THE ADDRESS OF THE ASCB ASSOCIATED WITH THE ASID IN CHASID   Y02657 74270002
*   IS CALCULATED FOR CROSS MEMORY POST USING THIS FORMULA:      Y02657 74320002
*     ASCBPTR = ((CHASID*4) + ADDR(ASVTENTY) - 4),               Y02657 74370002
*   WHERE ASVTENTY IS THE FIRST ASCB POINTER IN THE ASVT, AND    Y02657 74380002
*   ASCBPTR IS THE ASVT FIELD CONTAINING THE ADDRESS OF THE ASCB.Y02657 74390002
         SPACE                                                          74420015
SETECB   EQU   *                                                 Y02669 74470002
         L     R4,CHECBP           COMMUNICATIONS ECB PTR          I272 74820019
         LTR   R4,R4               IS ECB PTR SET TO ZERO         20030 74880002
         BZ    CMCONT              YES, GET ANOTHER CSCB         Y02669 74940002
         MVI   XAE,XFF             SET CSCB POSTED INDICATOR            75020002
         MVC   XASAVLOC(LNP),POSTL MOVE POST PARM LIST TO XSA    Y02657 75070002
         SLL   R0,D24              POSITION POST CODE                   75220002
*                                                                       75430002
*  LOCATE ASCB FOR XMPOST                                        Y02657 75440002
*                                                                       75450002
         L     R3,CVTPTR           CVT...                        Y02657 75470002
         USING CVT,R3              ...ADDRESSABILITY             Y02657 75520002
         L     R5,CVTASVT          ASVT...                       Y02657 75570002
         USING ASVT,R5             ...ADDRESSABILITY             Y02657 75580002
         LA    R5,ASVTENTY         ADDRESS FIRST ASVT ENTRY      Y02657 75590002
         DROP  R5                  DROP ASCB ADDRESSABILITY      Y02657 75592002
         S     R5,FOUR             DECREMENT TO FIRST SLOT       Y02657 75600002
         SR    R6,R6               ZERO ASID REG FOR INSERT      Y02657 75610002
         ICM   R6,3,CHASID         ASID FROM CSCB                Y02657 75620002
         SLL   R6,D2               QUADRUPLE IT FOR OFFSET       Y02657 75622002
         AR    R5,R6               ADDRESS ASVT ENTRY FOR ASID   Y02657 75624002
         L     R6,D0(R5)           LOAD IT FOR XMPOST            Y02657 75626002
*                                                                       75626402
*  XMPOST THE STOP/MODIFY ECB                                    Y02657 75626802
*                                                                       75627202
         POST  (R4),(0),ASCB=(R6),ERRET=CVTBRET,MF=(E,XASAVLOC)  Y02657 75628002
         DROP  R3                  DROP CVT ADDRESSABILITY       Y02657 75628402
         B     CMCONT              NEXT PASS THROUGH CSCB        Y02669 75629402
         EJECT                                                          75679402
*                                                                       75729402
*   CSCB SCAN COMPLETE.  PREPARE TO EXIT.                               75779402
*                                                                       75829402
CMFAIL   EQU   *                                                        80020015
         BAL   R9,CMDEQ            DEQ OFF CSCB CHAIN RESOURCE   Y02651 80080002
         SPACE 2                                                        80130002
*   IN THE FOLLOWING TESTS:                                      Y02669 80180002
*     XAE IS    ZERO    IF      NO CSCB WAS FOUND WITH THE       Y02669 80230002
*                               PROPER NAME(S) WHICH WOULD       Y02669 80280002
*                               ACCEPT ANOTHER CIB.              Y02669 80330002
*               CMCD37  IF      ONE OR MORE CSCBS WITH PROPER    Y02669 80380002
*                               NAMES WERE FOUND, BUT NONE WOULD Y02669 80430002
*                               ACCEPT ANOTHER CIB.              Y02669 80480002
*               XFF     IF      AT LEAST ONE CSCB WITH PROPER    Y02669 80530002
*                               NAME(S) WAS FOUND WHICH ACCEPTED Y02669 80580002
*                               THE CIB. THE ECB IN EACH OF THE  Y02669 80630002
*                               CSCB(S) WAS POSTED.              Y02669 80680002
         SPACE                                                          80730002
         CLI   XAE,ZERO            ANY CSCBS POSTED?             Y02669 80820002
         BE    CMERR36             NO. TASK NOT FOUND ERROR             81020015
         CLI   XAE,CMCD37          TEST FOR MODIFY PENDING              81220002
         BE    CMERR37             YES. COMMAND NOT PROCESSED MSG       81420015
         SPACE                                                          81430002
*                                                                       81440002
*   EXIT FROM MODULE VIA BR 14                                   Y02669 81450002
*                                                                       81460002
GOBACK   SR    R15,R15             SET SUCCESSFUL RETURN CODE    Y02669 81470002
         BR    R14                 EXIT                                 81820015
         EJECT                                                          81820202
*  THE CSCB CHAIN RESOURCE (Q10) IS RELEASED HERE. IT WAS        Y02651 81820502
*   OBTAINED AT CMST1. SWAPPING IS THEN AGAIN MADE POSSIBLE.     Y02651 81820902
*   THIS SUBROUTINE EXPECTS TO RETURN CONTROL TO THE ADDRESS IN  Y02651 81821002
*   REGISTER 9.                                                  Y02651 81821402
         SPACE 2                                                        81821602
CMDEQ    EQU   *                   ENTRY TO DEQ SUBROUTINE       Y02651 81821702
         MVC   XASAVSTD(LND),DEQCSCB MOVE IN PARM DEQ LIST       Y02651 81821802
         DEQ   MF=(E,XASAVSTD)     RELEASE CSCB RESOURCE         Y02651 81821902
         SPACE 1                                                        81822002
         SYSEVENT  OKSWAP          ALLOW SWAP FOR THIS MEMORY    Y02651 81822102
         BR    R9                  RETURN TO CALLER              Y02651 81822202
         EJECT                                                          81822302
         SPACE 4                                                        81822402
*                                                                       81822502
*   CIB CHAINING ROUTINE                                                81822602
*                                                                       81822702
         SPACE 2                                                        81822802
*   CALCULATE LENGTH OF CIB FOR GETMAIN                                 81823102
CMCIBLD  DS    0H                                                       81823602
         L     R3,XAP              ONE PAST END OF BUFFER        Y02669 81823702
         BCTR  R3,0                END OF BUFFER                 Y02669 81823802
CM001    DS    0H                                                       81824102
         CLI   D0(R3),BLANK        TEST FOR DATA                        81824202
         BNE   CM0015              BRANCH ON LAST BYTE OF DATA          81824302
         BCT   R3,CM001            DECREMENT PTR AND TRY AGAIN          81824402
CM0015   DS    0H                                                       81824502
         SR    R3,R7                                                    81824818
         BNM   CM0016              DATA AREA LENGTH IS NOT NEG.  A34824 81824920
         SR    R3,R3               INSURE LENGTH OF DATA IS PLUS A34824 81827001
CM0016   LA    R3,D2(R3)           RECTIFY LENGTH                A34824 81827701
         SPACE                                                          81828102
*   GETMAIN STORAGE FOR CIB FROM SUBPOOL 245                     Y02669 81828202
         LA    R0,CIBDATA-CIBNEXT(R3) LENGTH OF CIB                     81830602
         O     R0,CMSUB245         SET SUBPOOL NUMBER 245               81830702
         GETMAIN R,LV=(0)          GET STORAGE FOR CIB                  81831002
         USING CIBDSECT,R1                                       Y02669 81833002
*   INITIALIZE THE CIB                                           Y02669 81833402
         XC    CIBNEXT(CIBDATA-CIBNEXT),CIBNEXT  CLEAR CIB BASE  Y02669 81834302
         SPACE                                                          81834402
*                                 COMPUTE THE NUMBER OF DOUBLE          81834702
         LA    R0,CIBDATA-CIBNEXT+D7(R3)                         A30025 81834802
         SRL   R0,3                WORDS OF CIB GOTTEN CORE AND         81835402
         STC   R0,CIBLEN           STORE INTO THE CIB                   81836101
         MVC   CIBVERB(D1),XAN    SET THE VERB CODE                     81836801
         MVC   CIBASID(D2),XAA     MOVE ASID TO CIB              Y02669 81837502
         MVC   CIBCONID,XAU        MOVE CONSOLE ID TO CIB          I272 81838201
CM0015B  EQU   *                                                  20030 81838901
         LTR   R3,R3              IS LENGTH OF DATA ZERO                81839601
         BZ    CM002              YES BYPASS MOVE                       81841001
         BCTR  R3,0               DECREMENT BY ONE                      81841701
         STH   R3,CIBDATLN        STORE THE LENGTH OF THE DATA FIELD    81842401
         BCTR  R3,0               DECREMENT BY ONE                      81843101
         EX    R3,CMMVCZ          MOVE DATA TO CIB.                     81844501
*    CHAIN THE CIB                                               Y02669 81844902
CM002    DS    0H                                                       81845201
         LA    R0,CHCIBP           PTR TO CIB PTR                  I272 81852201
*                                 R1 ALREADY CONTAINS A PTR TO THE CIB  81854301
         LR    R4,R11                                             20030 81856420
         L     R11,BACHN          GET ADDR FIRST CSCB             20030 81966402
XTEST2   EQU   *                                                  20030 81976420
         LTR   R11,R11            TEST FOR END OF CHAIN           20030 81986420
         BZ    XERR                                               20030 81996420
         LA    R15,CHCIBP         GET ADDR CIB ORIGIN             20030 82006420
         CR    R0,R15                                             20030 82016420
         BE    XFRST                                              20030 82026420
         L     R11,CHPTR          GET NEXT CSCB ADDR              20030 82036420
         B     XTEST2                                             20030 82046420
XFRST    EQU   *                                                  20030 82056420
         LR    R15,R0                                             20030 82066420
         L     R11,D0(R15)        GET FIRST BLOCK PTR             20030 82076420
         LA    R11,D0(R11)                                        20030 82086420
XSCHN    EQU   *                                                  20030 82096420
         LTR   R11,R11             END OF CHAIN                   20030 82106402
         BZ    XCHER                                              20030 82116420
         LR    R15,R11            SAVE ORIGIN PTR                 20030 82126420
         L     R11,D0(R11)        GET NEXT ELEMENT                20030 82136420
         B     XSCHN                                              20030 82146420
XCHER    EQU   *                                                  20030 82156420
         CLI   CIBVERB,CIBSTOP    IS VERB STOP                    20030 82176420
         BE    XCHND                                              20030 82186420
         LR    R3,R0                                              20030 82196420
         SR    R13,R13                                            20030 82206420
XTEST3   EQU   *                                                  20030 82216420
         L     R3,D0(R3)          GET ADDR OF BLOCK               20030 82226420
         LA    R3,D0(R3)                                          20030 82236420
         LTR   R3,R3              IS PTR ZERO                     20030 82246420
         BZ    XENDCNT                                            20030 82256420
         LA    R13,D1(R13)        INCREMENT CIB COUNT             20030 82266420
         B     XTEST3                                             20030 82276420
XENDCNT  EQU   *                                                  20030 82286420
         LR    R11,R4                                             20030 82296420
         SR    R3,R3              CLEAR COUNT REGISTER            20030 82306420
         IC    R3,CHCIBCTR        GET CIB COUNT                   20030 82316420
         CR    R13,R3             IS LIMIT EXCEEDED               20030 82326420
         BL    XCHND                                              20030 82336420
*   INDICATE STATUS OF CHAINING REQUEST TO THE CALLER            Y02669 82338402
XERR     EQU   *                                                  20030 82346420
         LA    R15,D8             INDICATE CHAINING NOT DONE      20030 82356420
         BR    R9                                                 20030 82366420
XCHND    EQU   *                                                  20030 82376420
         ST    R1,D0(R15)         INSERT CIB PTR IN CHAIN         20030 82386420
         SR    R15,R15                                            20030 82396420
         ST    R15,CIBNEXT        MAKE NEXT CIB PTR ZERO         Y02669 82406402
         LR    R11,R4             RESTORE CSCB PTR                20030 82416420
         BR    R9                                                 20030 82426402
         EJECT                                                          82436402
*                                                                       84920019
*        THE FOLLOWING CODE SETS ERROR CODES FOR MESSAGES        Y02669 84970002
*        AND BRANCHES TO IEE0503D TO ISSUE THE MESSAGES          Y02669 85020002
*                                                                     * 85220015
CMERR36  MVI   XAE,CMCD36          ERROR CODE TASK NOT FOUND            85420002
         B     CBRANCH             ERROR MSG EXIT IEE0503D       Y02669 85820002
CMERR05  MVI   XAE,CMCD05          INVALID COMMAND               Y02669 85870002
         B     SETVERB             SET VERB IN XAV               Y02669 85920002
CMERR8   MVI   XAE,CMCD08          TERM LENGTH ERROR             Y02669 85970002
         B     SETVERB             SET VERB IN XAV               Y02669 86020002
CMERRC   MVI   XAE,CMCD0B          MISSING PARAMETER             Y02669 86070002
         B     SETVERB             SET VERB IN XAV               Y02669 86120002
CMERR37  MVI   XAE,CMCD37          TASK BUSY                     Y02669 86170002
         B     SETVERB             SET VERB IN XAV               Y02669 86220002
         SPACE                                                          86370002
*        SET PROPER COMMAND VERB IN XAV FOR IEE0503D             Y02669 86380002
         SPACE                                                          86390002
SETVERB  CLI   XAN,MODCOD          PROCESSING MODIFY COMMAND?    Y02669 86400002
         BNE   STOPCODE            NO, MUST BE STOP              Y02669 86410002
         MVC   XAV,CMMODIFY        MOVE 'MODIFY  ' TO XAV        Y02669 86412002
         B     CBRANCH             BRANCH TO MESSAGE MODULE      Y02669 86414002
STOPCODE MVC   XAV,CMSTOP          MOVE 'STOP    ' TO XAV        Y02669 86416002
CBRANCH  L     R9,VCON05           VCON FOR MSG MODULE IEE0503D  Y02669 86580002
         LA    R15,D4              SET UNSUCCESSFUL RETURN CODE  Y02669 86590002
         BR    R9                  BRANCH TO WRITE ERROR MSGS    Y02669 86600002
         EJECT                                                          86610002
* CONSTANTS AND EXECUTABLE INSTRUCTIONS FOR THIS MODULE               * 86620015
*                                                                     * 86820015
         DS    0F                  FULL WORD ALIGNMENT           Y02669 86870002
CMSUB245 DC    X'F5'               SUBPOOL 245                    20030 87690020
ZEROS    DC    X'000000'           INDICATION                     20030 87750020
*                                                                     * 87820015
VCON05   DC    V(IEE0503D)         FOR BRANCH TO MESSAGE MODULE  Y02669 88020002
FOUR     DC    F'4'                CONSTANT FOR ASID CONVERSION  Y02657 88070002
*                                                                       88220015
* EXECUTABLE INSTRUCTIONS                                             * 89420015
*                                                                       89520019
CMMVCZ   MVC   CIBDATA-CIBNEXT(1,R1),0(R7)   MOVE DATA TO CIB           90020018
CMMVCX   MVC   XAX(D1),D0(R9)                MOVE TASK TO XAX    Y02669 90130002
CMMVCY   MVC   XAS(D1),D0(R9)                MOVE PROC TO XAS    Y02669 90140002
         SPACE 2                                                        90190002
* ENQ PARAMETER LIST FOR CSCB RESOURCE                           Y02651 90200002
ENQCSCB  ENQ  (IEESCSCB,IEESQ10,E,3,SYSTEM),MF=L                 Y02651 90220002
LNE      EQU   *-ENQCSCB           LENGTH OF ENQ PARM LIST       Y02651 90270002
         SPACE                                                          90320002
* DEQ PARAMETER LIST FOR CSCB RESOURCE                           Y02651 90370002
DEQCSCB  DEQ  (IEESCSCB,IEESQ10,3,SYSTEM),MF=L                   Y02651 90380002
LND      EQU   *-DEQCSCB           LENGTH OF DEQ PARM LIST       Y02651 90390002
         SPACE                                                          90400002
IEESCSCB DC    C'SYSIEFSD'         MAJOR NAME                    Y02651 90420002
IEESQ10  DC    C'Q10'              MINOR NAME                    Y02651 90620002
         SPACE 2                                                        90790002
POSTL    POST  MF=L                POST PARM LIST                Y02657 90792002
LNP      EQU   *-POSTL             LENGTH OF POST PARM LIST      Y02657 90794002
         SPACE                                                          90796002
CMMODIFY DC    CL8'MODIFY  '       COMMAND VERBS                 Y02669 90798002
CMSTOP   DC    CL8'STOP    '       FOR MESSAGES                  Y02669 90798402
         SPACE                                                          90798802
PATCH    DC    CL50'****   IEE0703D   PATCH AREA  ****'          Y02669 90848802
         TITLE 'IEE0703D--XSA MAP'                                      94220019
CMXSA    DSECT                                                          94420015
         IEEXSA                                                         94620015
         TITLE 'IEE0703D--CVT MAP'                                      94820019
CVT      DSECT                                                          95020002
         CVT                                                            95220001
         TITLE 'IEE0703D--MASTER RESIDENT CORE MAP'                     95420019
         IEEBASEA                                                       95620015
         TITLE 'IEE0703D--CSCB MAP'                                     95820019
CMCHAIN  DSECT                                                          96020015
         IEECHAIN                                                       96220015
         TITLE 'IEE0703D--CIB MAP'                                      96270019
CIBDSECT DSECT                                                          96320018
         IEZCIB                                                         96370018
         TITLE 'IEE0703D--ASVT MAP'                                     96380002
         IHAASVT                                                 Y02657 96390002
         END                                                            96420015
./  ADD  SSI=61350399,NAME=IEE0803D
IEE0803D TITLE 'COMMAND SCHEDULE MODULE'                                00200002
*********************************************************************** 00400002
* MODULE NAME = IEE0803D                                              * 00600002
* DESCRIPTIVE NAME = CSCB, ASCB CREATION                              * 00800002
*                                                                     * 01000002
* COPYRIGHT = N/A                                                     * 01200002
*                                                                     * 01400002
* STATUS    =    OS/VS2 - SERVICE DATA IMPROVEMENTS           @G17SPTJ* 01420041
*                                                                     * 01800002
* FUNCTION =  FOR MOUNT, START, LOGON, DUMP, UNLOAD, DISPLAY,         * 02000002
*             TRACK, SET, VARY STORAGE, VARY CHANNEL, VARY CPU,       * 02200002
*             VARY ONLINE, VARY OFFLINE, VARY CONSOLES, RESET, SEND   * 02250002
*             QUIESCE, SWITCH, HALT, PAGEADD AND SLIP         @G17SPTJ* 02300041
*             COMMANDS.                                       @G17SPTJ* 02400041
*             IEE0803D BUILDS A CSCB TO HOLD THE COMMAND,     @Z40WPSS* 02450040
*             ENCODES THE COMMAND AND STORES IT IN THE CSCB.  @Z40WPSS* 02500040
*             FOR START, MOUNT AND LOGON, AN ASCB IS CREATED  @Z40WPSS* 02550040
*             AS PART OF INITIALIZATION FOR A NEW MEMORY.     @Z40WPSS* 02600040
*             FOR HOLD AND RELEASE TP, CONTROL IS PASSED TO   @Z40WPSS* 02650040
*             IED1303D.                                       @Z40WPSS* 02700040
*                                                                     * 03600002
* OPERATION = A CONDITIONAL GETMAIN IS DONE FOR THE CORE FOR          * 03800002
*             THE CSCB.  IN THE CASE OF INSUFFICIENT CORE,            * 04000002
*             AN ERROR CODE IS PASSED TO IEE0503D (MESSAGE            * 04200002
*             MODULE). THE CSCB IS INITIALIZED WITH THE               * 04400002
*             VERB CODE,CSCB SIZE, CONSOLE ID, SCREEN AND             * 04600002
*             AREA ID, ASID AND OPERAND DATA. ALSO,FOR DISPLAY        * 04800002
*             AND TRACK PROCESSING, AN INDICATOR IS SET TO            * 05000002
*             DESIGNATE STARTED TASK OR LOGON FOR DISPLAY JOBS        * 05200002
*             OR DISPLAY TS.  (STARTED JOBS ONLY.)  FOR               * 05400002
*             START, MOUNT AND LOGON, IEAVEMRQ IS USED FOR            * 05600002
*             ASCB CREATION. A PTR TO THE CSCB WILL BE PASSED         * 05800002
*             TO IEAVEMRQ FROM THIS MODULE IN A PARMLIST              * 06200002
*             POINTED TO BY REG1. ON RETURN  FROM IEAVEMRQ            * 06400002
*             THE CSCB CONTAINS THE ASID FOR THE NEW MEMORY.          * 06600002
*             REG0 ALSO CONTAINS THE ASID.                            * 06800002
*             RETURN CODES FROM THE ROUTINE ARE PROCESSED.            * 07200002
*             IF ASCB CREATION FAILS, THE CSCB IS FREED AND           * 07400002
*             AN ERROR CODE IS NORMALLY PASSED TO IEE0503D.   @Z30BPSV* 07600003
*             IF A START COMMAND NOT ISSUED UNDER THE         @Z30BPSV* 07700003
*             COMMUNICATIONS TASK IS BEING PROCESSED, A       @Z30BPSV* 07800003
*             SUBSYSTEM EXIT IS TAKEN AND                     @Z30BPSV* 07900003
*             A RETURN CODE OF 8 IS PASSED TO THE CALLER      @Z30BPSV* 08000003
*             IF ASCB CREATION IS SUCCESSFUL, AN ENQ IS DONE ON       * 08200002
*             THE CSCB CHAIN, THE NEW CSCB IS ENCHAINED, AND A        * 08400002
*             DEQ IS DONE.  THE ASSIGNMENT PENDING BIT HAS BEEN       * 08600002
*             SET IN THE CSCB AND THE MASTER SCHEDULER WAIT           * 08800002
*             ROUTINE IS CROSS MEMORY POSTED.                         * 09000002
*                                                                     * 09200002
* CHARACTER CODE DEPENDENCIES =                                       * 09400002
*             ANY CHARACTER CODE OTHER THAN EBCDIC WILL REQUIRE       * 09600002
*             REASSEMBLY OF MODULE.                                   * 09800002
         EJECT                                                          10050002
* DEPENDENCIES =                                                      * 10200002
*             MERGE OF IEE2103D AND IEE0503D INTO IEE0503D.           * 10400002
*             IEAVEMRQ - MEMORY CREATE                                * 10600002
*                                                                     * 10800002
* RESTRICTIONS =                                                      * 11000002
*             NONE                                                    * 11200002
*                                                                     * 11400002
* REGISTER CONVENTIONS =                                              * 11600002
*             R0  - MACRO USAGE                                       * 11800002
*             R1  - MACRO USAGE                                       * 12000002
*             R14 - RETURN ADDRESS                                    * 12200002
*             R15 - RETURN CODES                                      * 12400002
*                                                                     * 12600002
* PATCH LABEL =                                                       * 12800002
*             PTCH803D: RESERVED PATCH AREA 70 BLANKS.                * 13000002
*                                                                     * 13200002
* MODULE TYPE =                                                       * 13400002
*             CSECT                                                   * 13600002
* MODULE SIZE =                                                       * 13800002
*             FORMER DESIGN POINT CONSTRAINTS OF 1 K LOADS            * 14000002
*             FOR SVCS HAVE BEEN REMOVED. N.A.                        * 14200002
* ATTRIBUTES =                                                        * 14400002
*             REENTRANT, PAGED LPA, ZERO PSW KEY, SUPERVISOR          * 14600002
*             MODE                                                    * 14800002
* ENTRY POINT =                                                       * 15000002
*             IEE0803D FROM THE FOLLOWING MODULES:                    * 15200002
*                IEE0403D  START, MOUNT, LOGON, HOLD, RELEASE,        * 15250041
*                          UNLOAD, RESET, QUIESCE, DUMP,      @G17SPTJ* 15400041
*                          PAGEADD AND SLIP.                  @G17SPTJ* 15600041
*                          NO TEST IS MADE FOR THE PAGEADD    @Z40WPSS* 15603041
*                          COMMAND IN THIS MODULE.            @Z40WPSS* 15610041
*                IEE0603D  SET                                        * 15650002
*                IKJ5803D  SEND                                       * 15800002
*                IEE3203D  VARY CHANNEL, VARY CPU, VARY STORAGE       * 16000002
*                          VARY ONLINE, VARY OFFLINE, VARY CONSOLES   * 16050002
*                          VARY PATH, VARY CN                         * 16120040
*                IEE1403D  HALT, SWITCH                               * 16200002
*                IEE3503D  DISPLAY PFK                                * 16400002
*                IEE7503D  TRACK AND OTHER DISPLAY OPERANDS.          * 16600002
*                                                                     * 16800002
* PURPOSE =   CSCB CREATION FOR TASK CREATING COMMANDS.               * 17000002
*             ASCB & CSCB CREATION FOR MEMORY CREATING                * 17200002
*             COMMANDS.                                               * 17400002
*                                                                     * 17600002
* LINKAGE =   BRANCH VIA VCONS.                                       * 17800002
         EJECT                                                          17850002
*                                                                     * 18000002
* INPUT DATA =                                                        * 18200002
*             R2 POINTS TO THE EXTENDED SAVE AREA (XSA).              * 18400002
*             R14 CONTAINS RETURN ADDRESS.                            * 18600002
*             XSA INITIALIZED AS FOLLOWS:                             * 18800002
*                XAU CONTAINS UCMI                                    * 19000002
*                XAL CONTAINS PTR TO COMMAND OPERANDS IN              * 19200002
*                    BUFFER.                                          * 19400002
*                XAR CONTAINS PTR TO COMMAND INPUT BUFFER             * 20000002
*                XAS CONTAINS SCREEN AREA ID IN XASDID                * 20200002
*                XAS CONTAINS ROUTED CONSOLE ID FROM                  * 20400002
*                    L=CCA IN XASCID                                  * 20600002
*                XAA CONTAINS ASID FROM TSO ISSUED                    * 20800002
*                    COMMANDS (SEND, DISPLAY). THIS                   * 21000002
*                    FIELD WAS FORMERLY THE TJID.                     * 21200002
*                XAN CONTAINS THE VERB CODE                           * 21400002
*                XAV CONTAINS COMMAND VERB AS ENTERED                 * 21600002
*                XAX CONTAINS INFORMATION ON DISPLAY                  * 21800002
*                    COMMAND OPERANDS IN A BIT MASK.                  * 22200002
*                                                                     * 22400002
* REGISTERS SAVED =  NONE                                             * 22600002
* REGISTER CONTENTS DURING PROCESSING =                               * 22800002
*             R2  - XSA BASE                                          * 23000002
*             R3  - PROGRAM BASE ADDRESSIBILITY                       * 23200002
*             R4  - BASEA ADDRESSIBILITY                              * 23400002
*                                                                     * 23600002
*             R5  - ADDRESSIBILITY TO CSCB CHAIN                      * 23800002
*                   ACCESS COMMAND BUFFER THROUGH XAL                 * 24000002
*             R6  - CSCB CHAIN POINTERS                               * 24200002
*             R7  - CVT ADDRESSIBILITY                                * 24400002
*             R8  - ADDRESSIBILITY TO NEWLY CREATED CSCB              * 24600002
*             R13 - SAVE AREA ADDRESS FOR IEAVEMRQ                    * 24650002
*                                                                     * 24800002
* REGISTERS RESTORED =                                                * 25000002
*             NONE                                                    * 25200002
         EJECT                                                          25250002
**********************************************************************  25400002
* EXIT - NORMAL =                                                     * 25600002
*             POSTEXIT                                                * 25800002
* CONDITIONS =                                                        * 26000002
*             COMPLETION OF SVC34 PROCESSING FOR TASK AND             * 26200002
*             MEMORY CREATING COMMANDS.  EXIT IS A RETURN             * 26400002
*             TO CALLER.                                              * 26600002
* OUTPUT DATA =                                                       * 26800002
*             CSCB, ASCB, ASID                                        * 27000002
* RETURN CODE =                                                       * 27200002
*             R15 = 0                                                 * 27400002
*********************************************************************** 27600002
* EXIT - NORMAL =                                                     * 27800002
*             EXIT13                                                  * 28000002
* CONDITIONS =                                                        * 28200002
*             A VALID HOLD TP OR RELEASE TP COMMAND HAS BEEN          * 28400002
*             ENTERED. EXIT IS TO IED1303D TO PROCESS THE             * 28600002
*             COMMAND.                                                * 28800002
* OUTPUT DATA =                                                       * 29000002
*             SAME AS INPUT DATA IF VALID.                            * 29200002
* RETURN CODES =                                                      * 29400002
*             NONE                                                    * 29600002
*********************************************************************** 32000002
* EXIT - ERROR =                                                      * 32200002
*             EXIT3A                                                  * 32400002
* CONDITIONS =                                                        * 32600002
*             NO CSCB (OR ASID IF FOR LOGON, MOUNT OR START)  @Z30BPSV* 32800003
*             CREATED.                                        @Z30BPSV* 32900003
*             XAE FIELD CONTAINS ERROR CODE. DUE TO                   * 33000002
*             GETMAIN FAILURE FOR CSCB. TAKEN VIA BRANCH              * 33200002
*             ON VCON TO IEE0503D MESSAGE MODULE, PROVIDED    @Z30BPSV* 33400003
*             THE SUBSYSTEM INDICATED THAT THE MESSAGE IS TO  @Z30BPSV* 33450003
*             BE ISSUED FOR FAILING START COMMANDS ISSUED     @Z30BPSV* 33500003
*             UNDER A TASK OTHER THAN COMMTASK.               @Z30BPSV  33550003
*             THE SAME EXIT IS TAKEN IF ASCB CREATION FAILS           * 33600002
*             WITH A RETURN CODE OF 4, 8, OR 12.  THE EXACT           * 33800002
*             MEANING OF THESE CODES ARE LISTED IN A BLOCK            * 34000002
*             COMMENT WHERE THE MACRO IS CALLED.                      * 34200002
* OUTPUT DATA =                                                       * 34400002
*             ERROR CODE IN XAE FIELD OF XSA IS X'3A'.                * 34600002
* RETURN CODES =                                                      * 34800002
*             R15 = 8                                         @Z30BPSV* 35000003
**********************************************************************  35010002
         EJECT                                                          35050002
*********************************************************************** 35200002
* EXIT - ERROR =                                                      * 35400002
*             EXIT05                                                  * 35600002
* CONDITIONS =                                                        * 35800002
*             HOLD OR RELEASE COMMAND AND NO TP= KEYWORD              * 36000002
*             IN OPERAND. TAKEN VIA BRANCH ON VCON TO                 * 36200002
*             IEE0503D MESSAGE MODULE.                                * 36400002
* OUTPUT DATA =                                                       * 36600002
*             XAE FIELD CONTAINS ERROR CODE OF X'05'.                 * 36800002
* RETURN CODES =                                                      * 37000002
*             NONE                                                    * 37200002
*********************************************************************** 37400002
* EXIT - ERROR =                                                      * 37600002
*             EXIT0B                                                  * 37800002
* CONDITIONS =                                                        * 38000002
*             A COMMAND WAS ISSUED WITH NO PARAMETERS.                * 38200002
*             TAKEN VIA BRANCH ON VCON TO IEE0503D.                   * 38250002
* OUTPUT DATA =                                                       * 38400002
*             XAE CONTAINS ERROR CODE X'0B' IN XSA.                   * 38600002
* RETURN CODES =                                                      * 38800002
*             NONE                                                    * 39000002
*********************************************************************** 39250002
* EXIT - ERROR =                                                      * 39400002
*             EXIT3E                                                  * 39600002
* CONDITIONS =                                                        * 39800002
*             DUMP COMMAND WAS ISSUED WITHOUT COMM PARM.              * 40000002
*             EXIT IS TO IEE0503D MESSAGE MODULE.                     * 40200002
* OUTPUT DATA =                                                       * 40400002
*             XAE CONTAINS ERROR CODE X'3E' IN XSA.                   * 40600002
* RETURN CODES =                                                      * 40800002
*             NONE                                                    * 41000002
*********************************************************************** 41200002
         EJECT                                                          41210002
*********************************************************************** 41250002
* EXTERNAL REFERENCES =                                               * 41400002
* ROUTINES =  IEE0503D ERROR MESSAGE MODULE                           * 41600002
*             IED1303D TP PROCESSING MODULE                           * 42000002
*             IEAVEMRQ MEMORY REQUEST MODULE                          * 42050002
* DATA AREAS =                                                        * 42200002
*             NONE                                                    * 42400002
* CONTROL BLOCKS =                                                    * 42600002
*             IEECHAIN CSCB CREATED IN MODULE                         * 42800002
*             ASCB     ASCB CREATED IN MODULE                         * 43000002
*             IEEXSA   EXTENDED SAVE AREA                             * 43200002
*             IEEBASEA MASTER RESIDENT CORE                           * 43400002
*             IEFPTRS  NEW/OLD TCB ASCB POINTERS              @Z30BPSV* 43430003
*             IEECUCM  UNIT CONTROL MODULE                    @Z30BPSV* 43460003
*             IEFJESCT JES CONTROL TABLE                      @Z30BPSV* 43490003
*             IEFJSSOB SUBSYSTEM OPTION BLOCK                 @Z30BPSV* 43520003
*             IEFJSSIB SUBSYSTEM IDENTIFICATION BLOCK         @Z30BPSV* 43550003
* TABLES =    NONE                                                    * 43600002
* MACROS =    GETMAIN, FREEMAIN, ENQ, DEQ, POST,                      * 43800002
*             IEFJESCT, IEFJSSOB, IEFJSSIB, IEFSSREQ          @Z30BPSV* 43900003
*             ENQ AND DEQ FOR CSCB CHAIN.   ENQ IS EXCLUSIVE.         * 44000002
*             MINOR NAME = Q10.                                       * 44200002
*             MAJOR NAME = SYSIEFSD.                                  * 44250002
*                                                                     * 44400002
* MESSAGES =                                                          * 44600002
*             MSGID    CODE   MSG                                     * 44800002
*             IEE305I  05     COMMAND INVALID                         * 45000002
*             IEE311I  0B     PARM MISSING                            * 45200002
*             IEE328I  3A     COMMAND ABORTED                         * 45400002
*             IEE535I  3E     INVALID DUMP PARAMETER                  * 45600002
*                                                                     * 45800002
*             IEE0503D ISSUES THE MESSAGES AND                        * 46000002
*             CONTAINS THE TEXT.                                      * 46200002
*                                                                     * 46600002
* SYSGEN =    MODULE INCLUDED IN IGC0003D, IN SYSGEN MACRO            * 46800002
*             SGIEF441 FROM AOSB3 DISTLIB. TARGLIB IS                 * 47000002
*             SYS1.LPALIB.                                            * 47050002
* SYSTEM LIBRARIES =                                                  * 47200002
*             NONE.                                                   * 47400002
*********************************************************************** 47600002
         TITLE 'CSCB EXPANSION'                                         47650002
CHFIRST  DSECT                                                          47800002
         IEECHAIN                                                       48000002
         TITLE 'BASEA EXPANSION'                                        48050002
         IEEBASEA                                                       48200002
         TITLE 'XSA EXPANSION'                                          48250002
IEEXSA   DSECT                                                          48400002
         IEEXSA                                                         48600002
         TITLE 'CVT ENTRIES'                                            49800002
CVT      DSECT                                                          50000002
         CVT                                                            50200002
         TITLE 'NEW/OLD TCB ASCB POINTERS'                              50204003
         IEFPTRS                                                        50208003
         TITLE 'UNIT CONTROL MODULE'                                    50212003
         IEECUCM FORMAT=NEW                                             50216003
         TITLE 'JOB ENTRY SUBSYSTEM CONTROL TABLE'                      50220003
         IEFJESCT                                                       50224003
         TITLE 'SUBSYSTEM OPTIONS BLOCK'                                50228003
         IEFJSSOB CF                                                    50232003
         TITLE 'SUBSYSTEM IDENTIFICATION BLOCK'                         50236003
         IEFJSSIB                                                       50240003
         TITLE 'EQUATES'                                                50250002
IEE0803D CSECT                                                          50400002
*********************************************************************** 50600002
*                                                                     * 50800002
*                     REGISTER USAGE                                  * 51000002
*                                                                     * 51200002
*********************************************************************** 51400002
R0       EQU   0                  SIZE REGISTER FOR FREEMAIN     Y02669 51450002
R1       EQU   1                  GOTTEN CORE POINTER FROM GETMAIN.     51600002
R2       EQU   2                  PTR TO EXTENDED SAVE AREA.            51800002
R3       EQU   3                  BASE REGISTER.                        52000002
R4       EQU   4                  RESIDENT CORE BASE REGISTER.          52200002
R5       EQU   5                  CSCB CHAIN ADDRESSIBILITY             52400002
R6       EQU   6                  WORK REGISTER.                        52600002
R7       EQU   7                  CVT ADDRESSIBILITY                    52800002
R8       EQU   8                  NEW CSCB ADDRESSIBILITY               53000002
R9       EQU   9                  WORK REGISTER.                        53010002
R10      EQU   10                 WORK REGISTER.                        53020002
R11      EQU   11                 BAL REGISTER                   A00042 53030002
R12      EQU   12                 WORK REGISTER                  A00042 53040002
R13      EQU   13                 SAVE AREA ADDRESS REGISTER     Y02669 53050002
R14      EQU   14                 RETURN REGISTER.                      53200002
R15      EQU   15                 EXIT REGISTER                  Y02669 53400002
*********************************************************************** 53600002
*                                                                     * 53800002
*                    DISPLACEMENTS                                    * 54000002
*                                                                     * 54200002
*********************************************************************** 54400002
D0       EQU   0                        *                         20002 54600002
D1       EQU   1                        *                               54800002
D2       EQU   2                  LENGTH OF ASID                 Y02669 55000002
D3       EQU   3                  LENGTH OF 'TP='                Y02669 55200002
D4       EQU   4                  OFFSET IN GETMAIN LIST FOR     Y02669 55250002
*                                 GOTTEN CORE PTR                Y02669 55300002
D6       EQU   6                  LENGTH OF 'COMM=(' PARM        Y02669 55400002
D8       EQU   8                  LENGTH OF XSA MSG FILL         Y02669 55600002
D124     EQU   124                LENGTH OF BUFFER AREA          Y01012 56000002
BLANK    EQU   C' '               BLANK FOR PADDING CHBUF       YM25013 56050002
         EJECT                                                          56200002
*********************************************************************** 56400002
*                                                                       56600002
*                     VERB CODES                                        56800002
*                                                                       57000002
*********************************************************************** 57200002
START    EQU   X'04'              START COMMAND VERB CODE        Y01012 57400002
MOUNT    EQU   X'0C'              MOUNT COMMAND VERB CODE        Y02669 57600002
VARY     EQU   X'28'              VARY COMMAND VERB CODE         Y02669 57650002
VPATH    EQU   X'50'              VARY PATH COMMAND VERB CODE    Y02669 57652002
VCPU     EQU   X'54'              VARY CPU COMMAND VERB CODE     Y02669 57654002
VCH      EQU   X'58'              VARY CHANNEL COMMAND VERB CODE Y02669 57656002
VSTOR    EQU   X'5C'              VARY STORAGE COMMAND VERB CODE Y02669 57658002
QUIESCE  EQU   X'60'              QUIESCE COMMAND VERB CODE      Y02669 57660002
HOLD     EQU   X'6C'              HOLD COMMAND VERB CODE         Y02669 57700002
RELEASE  EQU   X'70'              RELEASE COMMAND VERB CODE      Y02669 57750002
LOGON    EQU   X'98'              LOGON COMMAND VERB CODE        Y02669 58050002
DUMP     EQU   X'AC'              DUMP COMMAND VERB CODE         Y02669 58200002
TRACK    EQU   X'C4'              TRACK COMMAND VERB CODE        Y02669 58250002
*********************************************************************** 58400002
*                                                                       58600002
*                   ERROR CODES                                         58800002
*                                                                       59000002
*********************************************************************** 59200002
INVCODE  EQU   X'05'              COMMAND INVALID MSG CODE       Y02669 59400002
PARMCDE  EQU   X'0B'              PARAMETER MISSING MSG CODE     Y02669 59600002
NOCORECD EQU   X'3A'              CODE FOR NO CORE MSG           A34263 59800002
DUMPCDE  EQU   X'3E'              INVALID DUMP CMD ERROR CODE    Y01012 60000002
*********************************************************************** 60030003
*                                                                     * 60060003
*                         MISCELLANEOUS CONSTANTS              @Z30BPSV 60090003
*                                                                     * 60120003
*********************************************************************** 60150003
CSCBSZE  EQU   CHLAST-CHFIRST     SIZE OF CSCB                   Y02669 60200002
PTR      EQU   4                  INDIRECT ADDRESS             @Z30BPSV 60204003
SSSTORE  EQU   SSIBSIZE+SSOBLN16+PTR  SIZE OF SUBSYSTEM        @Z30BPSV 60213003
*                                 INTERFACE STORAGE            @Z30BPSV 60222003
HYBITON  EQU   X'80'              MASK FOR END-OF-LIST         @Z30BPSV 60231003
LOBYTES  EQU   7                  MASK FOR ICM                 @Z30BPSV 60240003
         TITLE 'COMMAND SCHEDULE MODULE'                                60250002
*********************************************************************** 60300002
*     ESTABLISH ADDRESSIBILITY AND BASE FOR XSA, BASEA.          Y02669 60310002
*     CHECK IF NO OPERANDS ON COMMAND. IF NONE, SET UP           Y02669 60320002
*     ERROR CODE FOR PARM MISSING MESSAGE, IEE311I.              Y02669 60330002
*     (QUIESCE AND LOGON ARE EXCEPTIONS AND CAN HAVE NO          M00875 60340002
*     OPERANDS.) IF OPERANDS PRESENT, CONTINUE WITH              Y02669 60342002
*     PROCESSING.                                                Y02669 60344002
*********************************************************************** 60350002
         BALR  R3,0               BASE                           Y02669 60400002
         USING *,R3               REGISTER.                             60600002
         MODID BRANCH=YES                                               60800002
         USING IEEXSA,R2          EXTENDED SAVE AREA BASE               61000002
         L     R7,CVTPTR          ADDRESS OF CVT                        61200002
         USING CVT,R7             ESTABLISH CVT ADDRESSABILITY   Y01012 61400002
         L     R4,CVTMSER         MASTER RESIDENT CORE ADDRESSING.      61600002
         USING BASE,R4            ESTABLISH ADDRESSIBILITY              61800002
         ST    R14,XASAVLOC       SAVE RETURN ADDRESS            Y02669 61850002
         L     R5,XAL             GET PTR TO LIST POSITION              62000002
         LA    R5,D0(R5)          CLEAR HIGH ORDER GARBAGE              62200002
         CLI   XAN,QUIESCE        IS THIS QUIESCE COMMAND?       Y02651 62250002
         BE    CSCB               YES, BYPASS OPERAND CHECK      Y02651 62300002
         CLI   XAN,LOGON          IS THIS LOGON COMMAND?         M00875 62350002
         BE    CSCB               YES,BYPASS OPERAND CHECK       M00875 62400002
         LTR   R5,R5              ARE THERE ANY OPERANDS?        Y02669 62600002
         BZ    EXIT0B             NO. ERROR                      Y02669 62800002
         EJECT                                                          62810002
*********************************************************************** 62850002
*     IF DUMP COMMAND, VALIDITY CHECK FOR 'COMM=(' IN THE        Y02669 62860002
*     FIRST PART OF OPERAND. IF NONE, SET UP ERROR CODE          Y02669 62870002
*     IN THE XSA  FOR PARM INVALID MESSAGE, IEE535I.             Y02669 62880002
*     IF OK, GO GET CSCB CORE.                                   Y02669 62890002
*     ON HOLD AND RELEASE COMMANDS, CHECK FOR TP= AS THE         Y02669 62892002
*     OPERAND. IF IT IS NOT TP=, SET UP ERROR CODE FOR           Y02669 62894002
*     INVALID PARM MESSAGE, IEE305I. IF OK, BRANCH TO            Y02669 62896002
*     IED1303D TO PROCESS COMMAND.                               Y02669 62898002
*********************************************************************** 62900002
CHECDUMP EQU   *                                                 Y02651 62960002
         CLI   XAN,DUMP           THIS DUMP COMMAND?             Y02669 63000002
         BNE   CHECHOLD           NO, CHECK FOR HOLD CMD         Y02669 63200002
         CLC   D0(D6,R5),COMM     YES, THIS 'COMM=(' PARAMETER?  Y02669 63400002
         BE    CSCB               YES,THEN SET UP THE CSCB       Y02669 63600002
         B     EXIT3E             NO, INVALID PARM RTN           Y02669 63800002
CHECHOLD EQU   *                                                        64000002
         CLI   XAN,HOLD           IS IT HOLD COMMAND              20002 64200002
         BE    CHECKTP            YES, CHECK FOR 'TP='            20002 64400002
         CLI   XAN,RELEASE        IS IT RELEASE COMMAND           20002 64600002
         BNE   CSCB               NO, CONTINUE                   Y02669 64800002
CHECKTP  EQU   *                                                  20002 65000002
         CLC   TPEQLS(D3),D0(R5)  CHECK FOR 'TP='                Y01012 65200002
         BE    EXIT13             YES, BRANCH TO IED1303D        Y02669 65400002
         B     EXIT05             NO, INVALID PARM RTN           Y02669 65600002
         EJECT                                                          68400002
*********************************************************************** 68450002
*     DO CONDITIONAL GETMAIN IN SP245 FOR CSCB. IF NO            Y02669 68460002
*     CORE, SET UP COMMAND ABORTED MESSAGE, IEE328I. IF          Y02669 68470002
*     OK, INITIALIZE CSCB WITH INFORMATION IN XSA.               Y02669 68480002
*********************************************************************** 68500002
         SPACE                                                          68550002
CSCB     EQU   *                                                        68600002
         MVC   XASAVSTD(GETLNG),GETLIST                          Y02669 68800002
         LA    R1,XASAVSTD+D4     XAD SHOULD POINT TO            Y02669 69000002
         ST    R1,XASAVSTD+D4     GOTTEN CORE                    Y02669 69200002
         LA    R1,XASAVSTD        PREPARE R1 FOR GETMAIN         A34263 69400002
         GETMAIN MF=(E,(1))       EXECUTE FORM OF GETMAIN        A34263 69600002
         LTR   R15,R15            WAS CORE AVAILABLE             A34263 69800002
         BZ    GOTCSCB            YES,CONTINUE                 @Z30BPSV 69850003
         LA    R8,SSCFCSFL        SET CSCB FAIL CODE           @Z30BPSV 69920003
         ST    R8,XAK             FOR SUBSYSTEM                @Z30BPSV 69990003
         B     EXIT3A             SET UP FOR MESSAGE           @Z30BPSV 70060003
GOTCSCB  EQU   *                                               @Z30BPSV 70130003
         L     R8,XASAVSTD+D4     PREPARE ADDRESSABILITY         Y02669 70200002
         USING CHAIN,R8           R8 CONTAINS PTR TO GOTTEN CORE Y02669 70400002
         XC    CHAIN(CSCBSZE),CHAIN     CLEAR CSCB TO ZEROES     Y01012 70600002
         MVI   CHBUF,BLANK              CLEAR CHBUF TO BLANKS   YM25013 70650002
         MVC   CHBUF+D1(L'CHBUF-1),CHBUF                        YM25013 70700002
         MVC   CHVCD(D1),XAN      MOVE VERB CODE TO GOTTEN CORE. Y02669 70800002
         MVI   CHSZE,(CSCBSZE/D8) CSCB SIZE IN DOUBLE WORDS      Y01012 71000002
         MVC   CHUCMP(D1),XAU     PUT UCMI INTO CSCB                MCS 71400002
*                                 DISPLAY OPERANDS MASK          Y02669 71410002
         MVC   CHTRSTAT(D1),XAXMASK                                     71450002
         MVC   CHASID,XAA         MOVE ASID FOR TSO IN OP. MODE YM01854 71460002
         EJECT                                                          71500002
*********************************************************************** 71550002
*                                                                       71600002
*     THE FOLLOWING CODE ANSWERS A PROBLEM FOUND IN FIELD TEST   A00042 71602002
*     FOR RELEASE 1 OF VS/2.                                            71602402
*     A USER WAS ISSUING COMMANDS AFTER GETTING INTO KEY ZERO.   A00042 71604002
*     THE COMMAND BUFFER IN HIS PROGRAM ENDED NEAR A 4K BOUN-    A00042 71606002
*     DARY. THE PREVIOUS CODE BLINDLY MOVED 124 CHARACTERS INTO  A00042 71608002
*     CHBUF FROM THE COMMAND INPUT BUFFER. WITH THE INTRODUC-    A00042 71608402
*     TION OF VIRTUAL STORAGE, IT WAS POSSIBLE TO HIT THE BOUN-  A00042 71608802
*     DARY OF AN UNITIALIZED PAGE IN THE MOVE, RESULTING IN AN   A00042 71609202
*     0C4.  NOW THE LENGTH OF THE OEPRANDS IS CALCULATED VIA     A00042 71609602
*     THE LENGTH FIELD OF THE INPUT BUFFER AND THE ADDRESS OF    A00042 71609702
*     WHERE THE OPERANDS BEGIN.                                  A00042 71609802
*                                                                       71609902
*********************************************************************** 71623202
         CLI   CHVCD,QUIESCE      IS IT QUIESCE COMMAND?         A00042 71625202
         BE    INITREST           YES, BYPASS OPERAND MOVE AS    A00042 71627202
*                                 QUIESCE HAS NO OPERANDS.       A00042 71629202
         CLI   CHVCD,LOGON        IS IT LOGON COMMAND?           M00875 71631202
         BE    INITREST           LOGON HAS NO OPERANDS          M00875 71631602
         L     R12,XAR            ADDRESS COMMAND INPUT BUFFER   A00042 71633202
         LA    R12,D0(R12)        CLEAR HIGH ORDER BYTE          A00042 71633602
         AH    R12,D0(R12)        COMPUTE END OF BUFFER          A00042 71635202
         SR    R12,R5             SUBTRACT BEGINNING OF          A00042 71635602
*                                 OPERANDS FROM END OF BUFFER    A00042 71635702
*                                 TO GET LENGTH                  A00042 71635802
         CH    R12,CHBUFLNG       DO OPERANDS EXCEED CSCB        A00042 71636002
*                                 BUFFER LENGTH?                 A00042 71636402
         BNH   CHKONES            NO, CHECK IF LESS THAN ONE     A00042 71636502
         LH    R12,CHBUFLNG       YES, MOVE CSCB BUFFER LENGTH   A00042 71636602
         B     MOVEOPS            GO EXECUTE MOVE                A00042 71641002
CHKONES  EQU   *                                                 A00042 71643002
         CH    R12,HALFONE        IS LENGTH AT LEAST ONE?        A00042 71645002
         BNL   MOVEOPS            YES, MOVE OPERANDS TO CSCB     M00837 71645402
         BAL   R11,FREECSCB       NO, FREE GOTTEN CORE           A00042 71649902
         B     EXIT0B             ISSUE ERROR MSG, IEE311I       A00042 71651902
MOVEOPS  EQU   *                                                 A00042 71654602
         BCTR  R12,D0             DECREMENT BY ONE FOR MOVE      A00042 71659102
         EX    R12,MVECHBUF       MOVE OPERANDS TO CSCB          A00042 71669102
INITREST EQU   *                                                 A00042 71671102
         OI    CHSTS,CHAP         SET ASSIGNMENT PENDING BIT     Y02669 71672802
         TM    XASSDS,XASSDS1     IS THIS A STATUS DISPLAY       Y02669 71686402
         BZ    SETCONID           NO, USE ISSUING CONSOLE ID     Y02669 71700002
         MVC   CHCNID(D1),XASCID  SAVE CONSOLE ID                Y02669 71750002
         MVC   CHARID(D1),XASDID  SAVE DISPLAY AREA ID           Y02669 71760002
         B     CHKVARY            CHECK FOR VARY COMMAND         Y02669 71770002
SETCONID EQU   *                                                 Y02669 71780002
         MVC   CHCNID(D1),CHUCMP  CONSOLE ID OF ISSUING CON      Y02669 71790002
         EJECT                                                          71792002
*********************************************************************   71800002
*     FOR VARY COMMANDS, THE READER'S COMMAND AUTHORITY          Y02669 71810002
*     IS STORED IN THE XAS FIELD BY IEE5403D. IEE0803D           Y02669 71820002
*     TRANSFERS THIS TO THE CHINC FIELD SO THAT THE              Y02669 71830002
*     ATTACHED VARY PROCESSORS CAN ACCESS THE INFORMA-           Y02669 71832002
*     TION AFTER THE XSA IS FREED.                               Y02669 71834002
*********************************************************************   71836002
         SPACE                                                          71836402
CHKVARY  EQU   *                                                 Y02669 71838002
         CLI   CHVCD,VARY         IS IT VARY COMMAND?            Y02669 71838402
         BE    SETAUTH            YES, MOVE RDR AUTHORIZATION    Y02669 71838502
         CLI   CHVCD,VPATH        IS IT VARY PATH COMMAND?       Y02669 71838602
         BE    SETAUTH            YES, MOVE RDR AUTHORIZATION    Y02669 71838702
         CLI   CHVCD,VCPU         IS IT VARY CPU COMMAND?        Y02669 71840802
         BE    SETAUTH            YES, MOVE RDR AUTHORIZATION    Y02669 71842802
         CLI   CHVCD,VCH          IS IT VARY CHANNEL COMMAND?    Y02669 71843202
         BE    SETAUTH            YES, MOVE RDR AUTHORIZATION    Y02669 71845602
         CLI   CHVCD,VSTOR        IS IT VARY STORAGE COMMAND?    Y02669 71847602
         BE    SETAUTH            YES, MOVE RDR AUTHORIZATION    Y02669 71847702
         B     CHKSTART           NO, CHECK NEED FOR IEAVEMRQ    Y02669 71848002
SETAUTH  EQU   *                                                 Y02669 71850102
         MVC   CHINC(D2),XAS      MOVE READER CMND AUTH          Y02669 71850402
         B     ENQCSCB            GO CHAIN CSCB FOR VARY         Y02669 71852802
         SPACE                                                          71855202
**********************************************************************  71857602
*     FOR DISPLAY AND TRACK PROCESSORS, (IEECB800), THE CHTRKID  Y02669 71860002
*     FIELD IS SET BELOW ON ALL STARTS OR MOUNTS AND LOGONS.     Y02669 71870002
*     TO SUPPORT D JOBS, CHJOBID IS SET HERE FOR ALL STARTS      Y02669 71880002
*     AND MOUNTS. TO SUPPORT D TS, CHTSID IS SET HERE FOR ALL    Y02669 71890002
*     LOGON COMMANDS.                                            Y02669 71892002
**********************************************************************  71900002
         SPACE                                                          71910002
CHKSTART  EQU   *                                                Y02669 71950002
         CLI   CHVCD,START        IS IT START COMMAND?           Y02669 71960002
         BE    SETJOB             YES, SET JOB IDENTIFICATION    Y02669 71970002
         CLI   CHVCD,MOUNT        IS IT MOUNT COMMAND?           Y02669 71980002
         BNE   CHKLOGON           NO, CHECK FOR LOGON            Y02669 71990002
SETJOB   EQU   *                                                 Y02669 71992002
         OI    CHTRKID,CHJOBID    YES, SET JOB IDENTIFICATION    Y02669 71994002
         B     GETASCB            GO TO MEMORY CREATE FOR        Y02669 71996002
*                                 START AND MOUNT                Y02669 71996402
CHKLOGON EQU   *                                                 Y02669 71998002
         CLI   CHVCD,LOGON        IS IT LOGON COMMAND?           Y02669 71998402
         BNE   CHKTRACK           NO, GO TO CHECK TRACK          Y02669 71998802
SETLOGON EQU   *                                                 M00875 71998902
         OI    CHTRKID,CHTSID     YES, SET TIME SHARING ID       Y02669 71999202
         B     GETASCB            GO TO MEMORY CREATE FOR LOGON  Y02669 71999602
         EJECT                                                          72000002
*********************************************************************   72001602
*     THE TRACK COMMAND PROCESSOR NEEDS TO BE POSTED BY          Y02669 72002002
*     DIDOCS CONSOLE CLOSE WHEN A CONSOLE IS VARIED OFFLINE      Y02669 72002402
*     OR SUFFERS ASYNCHRONOUS FAILURE. THE FOLLOWING ROUTINE     Y02669 72002802
*     SETS UP THE COMMUNICATIONS FIELD FOR THE POST: THE         Y02669 72003202
*     CHCECB ADDRESS IS STORED IN THE DCMATRECB FIELD. THE       Y02669 72003302
*     ADDRESS OF THE LATTER IS PICKED UP FROM XAXSACB AS SET UP  Y02669 72003402
*     BY IEE7503D. (OTHERWISE DIDOCS COULD NOT ACCESS THE        Y02669 72003502
*     TRACK CSCB.)                                               Y02669 72006402
*********************************************************************   72009802
CHKTRACK EQU   *                                                        72012702
         CLI   CHVCD,TRACK        IS IT TRACK COMMAND?           Y02669 72015602
         BNE   ENQCSCB            NO, GO TO ENCHAIN CSCB         Y02669 72018502
         LA    R9,CHCECB          ADDRESS OF CANCEL ECB          Y02669 72021402
         L     R10,XAXSACB        ADDRESS OF DCM FIELD IN SACB   Y02669 72024302
         ST    R9,D0(R10)         ECB ADDRESS STORED FOR DIDOCS  Y02669 72027202
         B     ENQCSCB            GO CHAIN CSCB FOR TRACK        Y02669 72029202
         SPACE                                                          72030102
*********************************************************************   72033002
*     FOR STARTS, MOUNTS AND LOGONS A NEW MEMORY MUST BE CREATED.       72049702
*     THE FOLLOWING CODE SETS UP THE PARM LIST TO IEAVEMRQ, THE         72059702
*     MEMORY CREATE MODULE, BALR'S TO THAT MODULE, AND PROCESSES        72069702
*     RETURN CODES. AS INPUT, R1 POINTS TO THE CSCB PTR, AND R13        72079702
*     CONTAINS THE ADDRESS OF A REGISTER SAVE AREA.                     72089702
*********************************************************************   72099702
         SPACE                                                          72101702
GETASCB  EQU   *                                                 Y02669 72109702
         ST    R8,XAP             SET UP PARM CSCB PTR           Y02669 72119702
         LA    R1,XAP             GET PARAMETER ADDRESS          Y02669 72121702
         LA    R13,XASAVSTD       SAVE AREA ADDRESS              Y02669 72129702
         L     R15,VCONMRQ        IEAVEMRQ ADDRESS               Y02669 72139702
         BALR  R14,R15            BRANCH TO IEAVEMRQ             Y02669 72141702
         EJECT                                                          72142102
*********************************************************************   72143702
*     ON RETURN FROM IEAVEMRQ, THE ASCB IS GOTTEN AND            Y02669 72144102
*     CONTAINS THE CSCB POINTER. THE CSCB CONTAINS THE           Y02669 72144502
*     ASID. REG0 CONTAINS THE ASID. R15 CONTAINS THE             Y02669 72144902
*     RETURN CODES.                                              Y02669 72145302
*          R15=0  -  SUCCESSFUL                                  Y02669 72145402
*          R15=4  -  NO GO FROM OPTIMIZER                        Y02669 72145502
*          R15=8  -  SYSTEM OVERLOAD                             Y02669 72145602
*          R15=12 -  UNEXPECTED SYSTEM FAILURE                   Y02669 72159202
*     IN THE CASE OF FAILURE, THE CORE OBTAINED FOR THE          Y02669 72169202
*     CSCB IS FREED.                                             Y02669 72169602
*********************************************************************   72172802
         SPACE                                                          72174802
         LTR   R15,R15            WAS MEMORY CREATE SUCCESSFUL?  Y02669 72182802
         BZ    ENQCSCB            IF YES, GO TO CHAIN NEW CSCB   Y02669 72184802
         ST    R15,XAK            SAVE RET CODE FOR SUBSYSTEM  @Z30BPSV 72184903
         BAL   R11,FREECSCB       NO, FREE GOTTEN CORE           A00042 72185103
         B     EXIT3A             NO, ERROR EXIT FOR IEE328I     A00042 72187102
FREECSCB EQU   *                                                 A00042 72189902
         LA    R0,CSCBSZE         NO, GET SIZE CSCB FOR FREEMAIN Y02669 72190002
         O     R0,SP245MSK        INSERT SUPBOOL               @Z30BPSV 72192003
         LR    R1,R8              GET PTR TO CSCB FOR FREEMAIN   Y02669 72194002
         FREEMAIN R,LV=(0),A=(1)                                 Y02669 72196002
         BR    R11                RETURN TO INTERNAL CALLER      A00042 72197002
         EJECT                                                          72206002
*********************************************************************   72208002
*     AN EXCLUSIVE ENQ ON Q10 IS DONE ON THE CSCB CHAIN          Y02651 72210002
*     RESOURCE TO ADD THE NEWLY CREATED CSCB TO THE              Y02651 72220002
*     CHAIN.  THEN THE RESOURCE IS DEQ'D.                        Y02651 72230002
*     THE SYSEVENT MACRO IS ISSUED PRIOR TO THE ENQ TO           Y02651 72240002
*     MAKE THE MEMORY NON-SWAPPABLE, AND AFTER THE DEQ           Y02651 72242002
*     TO MAKE THE MEMORY SWAPPABLE AGAIN.                        Y02651 72244002
*********************************************************************   72246502
         SPACE                                                          72248502
ENQCSCB  EQU   *                                                 Y02651 72256502
         ST   R0,XAP              SAVE ASID FROM MEMORY CREATE   M00881 72256902
*                                 FOR TIOC ON LOGON COMMAND      M00881 72257302
         SYSEVENT DONTSWAP        MAKE MEMORY NON=SWAPPABLE      Y02651 72258502
         MVC   XASAVSTD(ENQLNG),ENQLIST                          Y02651 72266502
         LA    R1,XASAVSTD        SET UP ADDRESS FOR ENQ         Y02651 72276502
         ENQ   ,MF=(E,(1))                                       Y02651 72286502
         LA    R6,BACHN           ADDR OF CHAIN PTR TO R6.              72346502
         DROP  R8                                                       72400002
         USING CHAIN,R5                                                 72600002
CSCBSRCH EQU   *                                                        72800002
         LR    R5,R6              UPDATE BASE REGISTER                  73000002
         L     R6,CHPTR           UPDATE SEARCH REG WITH CHAIN PTR      73200002
         LTR   R6,R6              THIS LAST CSCB                 Y01012 73400002
         BNE   CSCBSRCH           NO KEEP SEARCHING FOR LAST ONE Y01012 73600002
         ST    R8,CHPTR           CHAIN ELEMENT BY PUTTING CORE  Y02669 73800002
*                                 ADDR IN LAST CHAIN PTR AREA.          74000002
         DROP R5                                                        74200002
         USING CHAIN,R8           REESTAB BASE FOR CSCB            I283 74400002
         MVC   XASAVSTD(DEQLNG),DEQLIST                          Y02651 74450002
         LA    R1,XASAVSTD        SETUP DEQ LIST FORM FOR DEQ    Y02651 74500002
         DEQ   ,MF=(E,(1))        RELEASE CSCB RECOURSE          Y02651 74550002
         SYSEVENT OKSWAP          MAKE MEMORY SWAPPABLE          Y02651 74560002
         EJECT                                                          74560402
*********************************************************************   74562002
*     POST THE MASTER SCHEDULER WAIT ROUTINE, IEEVWAIT,          Y02669 74562402
*     VIA CROSS MEMORY POST FUNCTION.                            Y02657 74562802
*********************************************************************   74564002
         MVC   XASAVSTD(POSTLNG),POSTLIST                        Y02657 74566002
         LA    R1,XASAVSTD        ADDRESS LIST FORM MACRO        Y02657 74568002
         L     R6,BAASCB          GET ASCB ADDRESS FOR POST      Y02657 74568402
         POST BALAD,ASCB=(R6),MF=(E,(1)),ERRET=CVTBRET           Y02657 74570002
         L     R14,XASAVLOC       RESTORE RETURN ADDRESS         Y02669 74572002
         L     R0,XAP             RESTORE ASID FOR TIOC          M00881 74574002
         SR    R15,R15            SUCCESSFUL RETURN CODE         M00879 74576002
         BR    R14                RETURN TO CALLER               Y02669 74580002
         EJECT                                                          74610002
*********************************************************************** 75200002
*                                                                Y02669 75400002
*     VALID EXIT FOR HOLD OR RELEASE TP COMMAND TO IED1303D.     Y02669 75600002
*                                                                Y02669 75800002
*********************************************************************** 76000002
EXIT13   EQU   *                                                 Y02669 76200002
         L     R15,VCON13         ADDRESS OF IED1303D            Y01029 76400002
         BR    R15                GO TO IED1303D                 Y01029 76600002
         SPACE                                                          77100003
*********************************************************************** 77600003
*                                                                Y02669 79000002
*     GENERAL ERROR EXITS FOR COMMANDS TO IEE0503D.              Y02669 79200002
*                                                                Y02669 79400002
*********************************************************************** 79600002
EXIT0B   EQU   *                                                 Y02669 79800002
         MVI   XAE,PARMCDE        (VERB) PARAMETER MISSING       Y01012 80000002
         B     EXIT               BRANCH TO IEE0503D             Y01012 80200002
EXIT05   EQU   *                                                 Y02669 80400002
         MVI   XAE,INVCODE        COMMAND INVALID ERROR CODE     Y02669 80600002
         B     EXIT               BRANCH TO IEE0503D             Y02669 80800002
EXIT3E   EQU   *                                                 Y02669 81250002
         MVI   XAE,DUMPCDE        PARAMETER INVALID ERROR CODE   Y02669 81300002
EXIT     EQU   *                                                 Y01029 81400002
         L     R14,XASAVLOC       RESTORE RETURN ADDRESS         A00042 81450002
         L     R15,VCON05         GET ADDRESS OF IEE0503D        Y01029 81600002
         BR    R15                BRANCH TO IEE0503D             Y01029 81800002
         EJECT                                                          81802003
*********************************************************************** 81804003
*                                                                       81806003
*      ERROR EXIT FOR START, MOUNT AND LOGON.                  @Z30BPSV 81810003
*                                                              @Z30BPSV 81819003
*     IF A START CMD WAS NOT ISSUED UNDER THE COMMUNICATIONS   @Z30BPSV 81828003
*     TASK (I.E., POTENTIALLY ISSUED BY A SUBSYSTEM),          @Z30BPSV 81837003
*     NOTIFICATION THAT THE COMMAND IS FAILING IS SENT TO ALL  @Z30BPSV 81846003
*     ACTIVE SUBSYSTEMS.  UNLESS AT LEAST ONE SUBSYSTEM        @Z30BPSV 81855003
*     INDICATES THAT IEE328I IS TO BE SUPPRESSED, CONTROL      @Z30BPSV 81864003
*     PASSES TO IEE0503D.  OTHERWISE, CONTROL RETURNS TO       @Z30BPSV 81873003
*     THE CALLER.                                              @Z30BPSV 81882003
*                                                              @Z30BPSV 81891003
*     IN ANY EVENT, A RETURN CODE OF EIGHT IS SET IN           @Z30BPSV 81900003
*     REGISTER FIFTEEN.  THE MESSAGE IS ALWAYS ISSUED FOR      @Z30BPSV 81909003
*     LOGON AND MOUNT.                                         @Z30BPSV 81918003
*                                                                       81933003
*********************************************************************** 81936003
          SPACE                                                         81940003
EXIT3A   EQU   *                                               @Z30BPSV 81950003
         L     R14,XASAVLOC      RESTORE RETURN ADDRESS        @Z30BPSV 81955003
         CLI   XAN,START         IF NOT A START COMMAND,       @Z30BPSV 81960003
         BNE   SETRC             SET RC AND GO TO MSG MOD      @Z30BPSV 81965003
         L     R9,CVTTCBP        GET ADDR NEW/OLD PTRS         @Z30BPSV 81970003
         USING TCBASCB,R9        ADD RESSABILITY TO NEW/OLD    @Z30BPSV 81975003
         L     R9,TCBPTR         GET ADDR OF CALLER'S TCB      @Z30BPSV 81980003
         DROP  R9                RELEASE NEW/OLD ADDR'LITY     @Z30BPSV 81985003
         L     R10,CVTCUCB       GET ADDR OF UCM               @Z30BPSV 81990003
         USING UCM,R10           ADDRESSABILITY TO UCM         @Z30BPSV 81995003
         C     R9,UCMPXA         IS CALLER COMMTASK            @Z30BPSV 82000003
         BE    SETRC             YES, SET RC AND GO TO MSG MOD @Z30BPSV 82005003
         DROP  R10               RELEASE UCM ADDRESSABILITY    @Z30BPSV 82010003
         LA    R1,XASAVSTD       GET ADDR FOR GETMAIN LIST     @Z30BPSV 82015003
         MVC   XASAVSTD(SSLNG),SSLIST MOVE IN LIST             @Z30BPSV 82020003
         LA    R9,XASAVSTD+D4    SET ADDRESS FOR               @Z30BPSV 82025003
         ST    R9,XASAVSTD+D4    GOTTEN STORAGE IN LIST        @Z30BPSV 82030003
         GETMAIN MF=(E,(1))      GET STORAGE FROM SP255        @Z30BPSV 82035003
         LTR   R15,R15           SUCCESS?                      @Z30BPSV 82040003
         MVC   XAS(D4),SP255     SAVE SUBPOOL/LENGTH           @Z30BPSV 82045003
         L     R1,XASAVSTD+D4    GET ADDRESS OF STORAGE        @Z30BPSV 82050003
         ST    R1,XAS+D4         SAVE IT                       @Z30BPSV 82055003
         BZ    GOTSSBLX          YES,SET UP FOR SUBSYSTEMS     @Z30BPSV 82060003
*                                AND BRANCH AROUND SP245       @Z30BPSV 82065003
*                                GETMAIN                       @Z30BPSV 82070003
         GETMAIN R,LV=SSSTORE,SP=245 TRY AGAIN                 @Z30BPSV 82075003
         MVC   XAS(D4),SP245     SAVE SUBPOOL/LENGTH           @Z30BPSV 82080003
         ST    R1,XAS+D4         SAVE STORAGE ADDRESS          @Z30BPSV 82085003
GOTSSBLX EQU   *                                               @Z30BPSV 82090003
         XC    D0(SSSTORE,R1),D0(R1) ZERO GOTTEN STORAGE       @Z30BPSV 82095003
         EJECT                                                          82116003
*********************************************************************** 82117003
*                                                                       82118003
*                                                                       82120003
*        INITIALIZE THE SSIB AND SSOB                          @Z30BPSV 82125003
*                                                                       82130003
*                                                                       82131003
*********************************************************************** 82132003
         SPACE                                                          82133003
         LA    R9,D4(R1)         BUILD INTERFACE TO IEFSSREQ:  @Z30BPSV 82135003
         ST    R9,D0(R1)         SET SSOB ADDR IN PARM LIST    @Z30BPSV 82140003
         OI    D0(R1),HYBITON    WITH END-OF-LIST ON           @Z30BPSV 82145003
         USING SSOB,R9           R9 ADDRESSES SSOB             @Z30BPSV 82150003
         LA    R10,SSOBLN16(R9)  GET ADDRESS OF SSIB           @Z30BPSV 82155003
         USING SSIB,R10          R10 ADDRESSES SSIB            @Z30BPSV 82160003
         SPACE                                                          82165003
*        INITIALIZE THE SSOB                                   @Z30BPSV 82170003
         SPACE                                                          82175003
         ST    R10,SSOBSSIB      SET SSIB PTR IN SSOB          @Z30BPSV 82180003
         MVC   SSOBID,SSOBNAME   MOVE'SSOB' TO SSOB            @Z30BPSV 82184003
         MVI   SSOBLEN+1,SSOBHSIZ MOVE IN LENGTH               @Z30BPSV 82188003
         MVI   SSOBFUNC+1,SSOBCFCD MOVE IN FUNCTION CODE       @Z30BPSV 82192003
         LA    R6,SSCFBGN        ADDR FUNCTION DEPENDENT       @Z30BPSV 82196003
*                                EXTENSION                     @Z30BPSV 82200003
         ST    R6,SSOBINDV       STORE IN SSOB BASE            @Z30BPSV 82204003
         MVI   SSCFLEN+1,SSCFSIZE STORE SIZE IN EXTENSION      @Z30BPSV 82208003
         MVC   SSCFBFAD+1(D3),XAR+1 PROVIDE ADDRESS OF COMMAND @Z30BPSV 82212003
*                                BUFFER TO SUBSYSTEM, AND      @Z30BPSV 82216003
         MVC   SSCFMRRC(D4),XAK  THE RETURN CODE FROM MEMORY   @Z30BPSV 82220003
*                                REQUEST OR CSCB FAILURE       @Z30BPSV 82224003
         SPACE                                                          82233003
*        INITIALIZE THE SSIB                                   @Z30BPSV 82236003
         SPACE                                                          82239003
         MVI   SSIBLEN+1,SSIBSIZE MOVE IN LENGTH OF SSIB       @Z30BPSV 82242003
         MVC   SSIBSSNM,SUBNAME  MOVE IN SUBSYSTEM NAME        @Z30BPSV 82244003
         MVC   SSIBID,SSIBNAME   MOVE'SSIB' TO SSIB            @Z30BPSV 82246003
         LA    R13,XASAVSTD      GET SAVE AREA POINTER         @Z30BPSV 82248003
         LR    R6,R14            SAVE RETURN ADDRESS           @Z30BPSV 82250003
         IEFSSREQ                ISSUE SUBSYSTEM INTERFACE     @Z30BPSV 82252003
         EJECT                                                          82257703
*********************************************************************** 82258403
*                                                                       82259103
*        FREE THE SSIB AND SSOB STORAGE                        @Z30BPSV 82263003
*                                                                       82264003
*********************************************************************** 82265003
         SPACE                                                          82266003
         LR    R14,R6            RESTORE RETURN ADDRESS        @Z30BPSV 82269003
         L     R10,SSOBRETN      SAVE SUBSYSTEM RETURN CODE    @Z30BPSV 82272003
         LR    R9,R15            SAVE INTERFACE RETURN CODE    @Z30BPSV 82275003
         DROP  R9                RELEASE SSOB AND              @Z30BPSV 82278003
         DROP  R10               SSIB ADDRESSABILITY           @Z30BPSV 82281003
         LM    R0,R1,XAS         LOAD STORAGE ADDRESS,         @Z30BPSV 82284003
*                                SUBPOOL AND LENGTH FOR        @Z30BPSV 82287003
         FREEMAIN R,LV=(0),A=(1) FREEMAIN                      @Z30BPSV 82290003
         LTR   R9,R9             SUBSYS INTERFACE SUCCESSFUL   @Z30BPSV 82293003
         BNZ   SETRC             NO, SET RC AND GOTO MSG MOD   @Z30BPSV 82296003
         LTR   R10,R10           IEE328I TO BE ISSUED          @Z30BPSV 82299003
         BNZ   NOMSG             NO, SET RC AND RETURN         @Z30BPSV 82302003
         SPACE                                                          82305003
*        SET RETURN CODE, SET MESSAGE CODE, AND BRANCH         @Z30BPSV 82308003
         SPACE                                                          82311003
SETRC    EQU   *                                                        82314003
         LA    R15,D8            SET FAILING RETURN CODE       @Z30BPSV 82317003
         MVI   XAE,NOCORECD      IEE328I MESSAGE CODE          @Z30BPSV 82320003
         L     R8,VCON05         GET ADDRESS OF IEE0503D       @Z30BPSV 82323003
         BR    R8                BRANCH TO IT                  @Z30BPSV 82326003
         SPACE                                                          82329003
*        SET RETURN CODE AND RETURN                            @Z30BPSV 82332003
         SPACE                                                          82335003
NOMSG    EQU   *                                               @Z30BPSV 82338003
         LA    R15,D8            SET FAILING RETURN CODE       @Z30BPSV 82341003
         BR    R14               RETURN                        @Z30BPSV 82344003
         EJECT                                                          82347003
*********************************************************************** 82347503
*                                                                       82348003
*        CONSTANTS AND MACRO LISTS                             @Z30BPSV 82348503
*                                                                       82349003
*********************************************************************** 82349503
         DS    0F                                                       82350003
VCON05   DC    V(IEE0503D)       MESSAGE MODULE CSECT.           Y01029 82400003
VCON13   DC    V(IED1303D)       TCAM                            Y01029 82500003
VCONMRQ  DC    V(IEAVEMRQ)       MEMORY REQUEST MODULE           Y02669 82600003
SP245MSK DC    X'F5000000'       SUBPOOL 245 FOR FREEMAIN MAC  @Z30BPSV 82700003
COMM     DC    C'COMM=('         FORMAT OF COMM PARAMETER        Y02669 82800003
TPEQLS   DC    C'TP='            FORMAT OF TP PARAMETERS         Y02669 82900003
SSOBNAME DC    C'SSOB'           SSOB NAME                     @Z30BPSV 83401003
SSIBNAME DC    C'SSIB'           SSIB NAME                     @Z30BPSV 83402003
SUBNAME  DC    C'MSTR'           MASTER SUBSYSTEM NAME         @Z30BPSV 83403003
SP245    DC    AL1(245)          SUBPOOL 245 AND               @Z30BPSV 83404003
         DC    AL3(SSSTORE)      LENGTH FOR FREEMAIN           @Z30BPSV 83405003
SP255    DC    AL1(255)          SUBPOOL 255 AND               @Z30BPSV 83406003
         DC    AL3(SSSTORE)      LENGTH FOR FREEMAIN           @Z30BPSV 83407003
         DS    0F                                                       83410002
MVECHBUF MVC   CHBUF(D0),D0(R5)  MOVE OPERANDS TO CSCB BUFFER    A00042 83420003
CHBUFLNG DC    AL2(L'CHBUF)      LENGTH OF CSCB BUFFER           A00042 83430003
HALFONE  DC    X'0001'           CHECK FOR MINIMUM TO MOVE       A00042 83440003
         DS    0D                                                       83450002
ENQLIST  ENQ   (SYSNAME,RNAME,E,3,SYSTEM),RET=HAVE,MF=L          Y02651 83500002
ENQEND   EQU   *                  LABLE USED TO CALCULATE LENGTH Y02651 83550002
         DS    0D                                                       83552002
DEQLIST  DEQ   (SYSNAME,RNAME,3,SYSTEM),RET=HAVE,MF=L            Y02651 83560002
DEQEND   EQU   *                  LABLE USED TO CALCULATE LENGTH Y02651 83570002
CANUSE   DS    0F                 FOR BOUNDARY ALIGNMENT         A34263 83572002
GETLIST  GETMAIN EC,LV=CSCBSZE,A=0,SP=245,MF=L                   Y02669 83574003
GETEND   EQU   *                  LABLE USED TO CALCULATE LENGTH Y02669 83578003
SSLIST   GETMAIN EC,LV=SSSTORE,A=0,SP=255,MF=L SSOB/SSIB LIST  @Z30BPSV 83583003
SSEND    EQU   *                  LABEL USED TO CALCULATE LEN  @Z30BPSV 83593003
POSTLIST POST  MF=L                                              Y02657 83607003
POSTEND  EQU   *                  LABLE USED TO CALCULATE LENGTH Y02657 83615003
ENQLNG   EQU   ENQEND-ENQLIST     LENGTH TO MOVE TO GOTTEN CORE  Y02651 83623003
DEQLNG   EQU   DEQEND-DEQLIST     LENGTH TO MOVE TO GOTTEN CORE  Y02651 83631003
GETLNG   EQU   GETEND-GETLIST     LENGTH TO MOVE TO GOTTEN CORE  Y02669 83640002
SSLNG    EQU   SSEND-SSLIST       LENGTH TO MOVE TO GOTEN CORE @Z30BPSV 83660003
POSTLNG  EQU   POSTEND-POSTLIST   LENGTH TO MOVE TO GOTTEN CORE  Y02657 83690002
SYSNAME  DC    C'SYSIEFSD'        MAJOR NAME IS SYSIEFSD         Y02651 83810002
RNAME    DC    C'Q10'             MINOR NAME IS Q10              Y02651 83820002
PATCH    DC    CL50'* * * * IEE0803D * * * *'                           83850003
         EJECT                                                          84000002
         END                                                            84200002
./  ADD  SSI=41301365,NAME=IEE1403D
         TITLE 'HALT, SWITCH SYNTAX CHECK; TRACE PROCESSING'            00020002
*****************************************************************Y02669 00070002
*                                                                Y02669 00120002
*  MODULE NAME =  IEE1403D                                       Y02669 00130002
*                                                                Y02669 00132002
*  DESCRIPTIVE NAME =  HALT/ SWITCH SYNTAX CHECKER; TRACE      @Y02669P 00134002
*                      PROCESSOR                               @Y02669P 00135002
*                                                                Y02669 00136002
*  COPYRIGHT =                                                   Y02669 00138002
*                                                                Y02669 00138402
*  STATUS =  OS/VS2 - RELEASE 3                                @Y30LPSV 00138803
*                                                                Y02669 00139202
*  FUNCTION =                                                    Y02669 00139602
*              THIS MODULE SYNTAX CHECKS THE HALT (Z) AND        Y02669 00139702
*              SWITCH (I) COMMANDS, AND EXECUTES THE TRACE     @Y02669P 00139802
*              COMMAND.                                        @Y02669P 00139902
*                                                                Y02669 00149902
*     OPERATION =                                                Y02669 00159902
*              A. PERFORMS VALIDITY CHECKING OF THE EOD OPERAND TO    * 00180000
*                 ASCERTAIN WHETHER THE OPERAND OF HALT IS NULL OR    * 00200000
*                 MISPELLED.                                          * 00220000
*                                                                     * 00240000
*              B. IF THE OPERAND IS NULL, CONTROL PASSES TO THE  Y02669 00260002
*                 APPROPRIATE ERROR ERROR EXIT TO SET UP THE     Y02669 00262002
*                 INTERFACE TO THE MESSAGE MODULE (IEE0503D)     Y02669 00264002
*                 TO ISSUE MESSAGE IEE311I.                      Y02669 00266002
*                                                                     * 00340000
*              C. IF THE OPERAND WAS MISSPELLED, CONTROL PASSES  Y02669 00360002
*                 TO THE APPROPRIATE ERROR ERROR EXIT TO SET UP  Y02669 00362002
*                 THE INTERFACE TO THE MESSAGE MODULE (IEE0503D) Y02669 00364002
*                 TO ISSUE MESSAGE IEE309I.                      Y02669 00366002
*                                                                     * 00440000
*                 (IF THE OPERAND BEGINS WITH 'TP,' OR 'TP',      20002 00444002
*                 THIS MODULE BRANCHES TO IED1303D FOR TCAM      Y02669 00448002
*                 PROCESSING)                                     20002 00452020
*                                                                 20002 00456020
*                 (IF THE OPERAND BEGINS WITH 'NET,'  OR 'NET ', Y02674 00466002
*                 THIS MODULE BRANCHES TO ISTCFF3D FOR VTAM      Y02674 00476002
*                 PROCESSING)                                    Y02674 00486002
*                                                                Y02669 00496002
*              D. IF THE OPERAND IS 'SMF' OR 'EOD', CONTROL      Y02669 00506002
*                 PASSES TO IEE0803D TO BUILD A CSCB.            Y02669 00515602
*                 THIS IS TO AVOID PROCESSING HALT/SWITCH CMDS     R271 00518001
*                 UNDER THE COMMUNICATIONS TASK.                   R271 00518401
*                                                                     * 00520000
*              E. IF THE OPERAND ON TRACE IS 'ON', BIT BATRACE @Y02669P 00523002
*                 IS SET 'ON', AND THE INTERFACE TO THE        @Y02669P 00526002
*                 MESSAGE MODULE (IEE0503D) IS SET UP TO ISSUE @Y02669P 00529002
*                 MESSAGE IEE712I.                             @Y02669P 00532002
*                                                              @Y02669P 00535002
*                 IF THE OPERAND ON TRACE IS 'OFF', BIT        @Y02669P 00538002
*                 BATRACE IS SET 'OFF', AND THE MESSAGE        @Y02669P 00541002
*                 INTERFACE IS AGAIN SET FOR MESSAGE IEE712I.  @Y02669P 00544002
*                                                              @Y02669P 00547002
*                 IF THE OPERAND ON TRACE IS 'STATUS' OR       @Y02669P 00550002
*                 NULL, CVTTRACE IS TESTED.                    @Y02669P 00576002
*                 IF THE FIELD CONTAINS X'07FB', INDICATING    @Y02669P 00579002
*                 THAT THE SYSTEM TRACE IS INACTIVE, THE       @Y02669P 00582002
*                 MESSAGE INTERFACE IS AGAIN SET FOR MESSAGE   @Y02669P 00585002
*                 IEE341I.  OTHERWISE, THE SYSTEM TRACE IS     @Y02669P 00588002
*                 ACTIVE, AND THE MESSAGE INTERFACE IS         @Y02669P 00591002
*                 SET FOR MESSAGE IEE382I.                     @Y02669P 00594002
*                                                              @Y02669P 00597002
*                 IF NONE OF THE ABOVE OPERANDS IS PRESENT,    @Y02669P 00600002
*                 THE MESSAGE INTERFACE IS SET FOR MESSAGE     @Y02669P 00603002
*                 IEE535I.                                     @Y02669P 00606002
*                                                              @Y30LPSV 00607003
*              F. IF THE OPERAND ON HALT IS 'DINIT','LONG',    @Y30LPSV 00608003
*                 OR 'SNAP' THE INTERFACE TO THE MESSAGE       @Y30LPSV 00609003
*                 MODULE IS SET UP TO ISSUE MESSAGE IEE084I.   @Y30LPSV 00610003
*                                                              @Y30LPSV 00611003
*                 IF THE OPERAND BEGINS WITH 'S,', THIS MODULE @Y30LPSV 00612003
*                 BRANCHES TO IEE9403D FOR SS/1 PROCESSING.    @Y30LPSV 00616003
*                                                                     * 00620002
*  NOTES =                                                       Y02669 00624002
*                                                              @Y02669P 00628002
*           TO BE EFFECTIVE, 'TRACE ON' AND 'TRACE OFF'        @Y02669P 00632002
*           MUST BE ISSUED BEFORE THE SYSTEM TRACE IS          @Y02669P 00636002
*           TERMINATED BY IEEVWAIT, WHEN INITIALIZATION        @Y02669P 00640002
*           OF THE PRIMARY JOB ENTRY SUBSYSTEM IS COMPLETE.    @Y02669P 00644002
*                                                              @Y02669P 00648002
*           TRACE IS INVALID IN THE INPUT STREAM.              @Y30LPSV 00652003
*                                                              @Y02669P 00656002
*     CHARACTER CODE DEPENDENCIES =  THIS MODULE HAS BEEN WRITTENY02669 00660002
*                                    IN SUCH A WAY THAT, IF THE  Y02669 00670002
*                                    CHARACTER CODE IS CHANGED   Y02669 00720002
*                                    FROM EBCDIC, REASSEMBLY WILLY02669 00770002
*                                    YIELD A VALID MODULE.       Y02669 00820002
*                                                                     * 00870002
*     DEPENDENCIES =                                             Y02669 00920002
*                                                                     * 00970002
*     RESTRICTIONS =  THIS MODULE EXPECTS REGISTER TWO TO POINT  Y02669 01020002
*                     AN EXTENDED SAVE AREA (XSA), AND         @Y02669P 01070002
*                     REGISTER TEN TO POINT TO MASTER          @Y02669P 01100002
*                     RESIDENT DATA AREA(BASEA).               @Y02669P 01130002
*                                                                     * 01160002
*     REGISTER CONVENTIONS =                                     Y02669 01220002
*                   REGISTER 2     ADDRESS OF XSA                Y02669 01270002
*                   REGISTER 5     ADDRESS OF CVT              @Y02669P 01320002
*                   REGISTER 7     ADDRESS OF TRACE TABLE      @Y02669P 01340002
*                   REGISTER 8     MESSAGE CODE                  Y02669 01370002
*                   REGISTER 9     EXIT BRANCH ADDRESS           Y02669 01372002
*                   REGISTER 10    ADDRESS OF BASEA            @Y02669P 01392002
*                   REGISTER 11    ADDRESS OF COMMAND OPERAND    Y02669 01420002
*                   REGISTER 12    MODULE BASE                   Y02669 01470002
*                   REGISTER 15    RETURN CODE                   Y02669 01472002
*                                                                     * 01474002
*     PATCH-LABEL =  PATCH                                       Y02669 01476002
*                                                                     * 01478002
*  MODULE-TYPE =  CSECT                                          Y02669 01478402
*                                                                       01478802
*     PROCESSOR =  ASSEMBLER                                     Y02669 01479202
*                                                                       01479602
*     MODULE-SIZE =  APPROXIMATELY X'200'                      @Y30LPSV 01479703
*                                                                       01479902
*     ATTRIBUTES =                                               Y02669 01480002
*                  PAGED LPA                REENTRANT            Y02669 01480402
*                  ZERO PSW PROTECT KEY     REUSABLE             Y02669 01480502
*                  SUPERVISOR MODE          REFRESHABLE          Y02669 01480602
*                                                                       01480702
*  ENTRY POINT =  IEE1403D, FROM IEE0403D                        Y02669 01480802
*                                                                       01481302
*     PURPOSE =  TO SYNTAX CHECK THE HALT AND SWITCH COMMANDS    Y02669 01481402
*                AND PROCESS THE TRACE COMMAND                 @Y02669P 01481502
*                                                                       01481602
*     LINKAGE =  VIA BRANCH FROM IEE0403D                        Y02669 01481802
*                                                                       01481902
*     INPUT DATA =  REGISTER TWO CONTAINS THE ADDRESS OF AN XSA  Y02669 01482002
*                   INITIALIZED AS FOLLOWS:                      Y02669 01482102
*                                                                       01482202
*                   XAN       VERB CODE (HALT, SWITCH OR TRACE)@Y02669P 01482302
*                   XAL       ADDRESS OF COMMAND OPERAND         Y02669 01482402
*                   REGISTER TEN CONTAINS THE ADDRESS OF BASEA @Y02669P 01482502
*                                                                       01482802
*     REGISTERS SAVED =  NONE                                    Y02669 01483202
*                                                                       01483702
*     REGISTER CONTENTS DURING PROCESSING =  SEE REGISTER CON-   Y02669 01484202
*                                            VENTIONS            Y02669 01484702
*                                                                       01485202
*     REGISTERS RESTORED =  NONE                                 Y02669 01485302
*                                                                       01485402
*  EXIT-NORMAL =  MSGBRCH                                      @Y02669P 01485502
*                                                                       01485602
*     CONDITIONS =  OPERAND ON TRACE WAS 'ON' OR 'OFF'         @Y02669P 01485702
*                                                                       01485802
*     OUTPUT DATA =  REGISTER TWO POINTS TO AN XSA CONTAINING: @Y02669P 01485903
*                    XAE      MESSAGE CODE X'03'               @Y02669P 01487902
*                    XAV      COMMAND VERB                     @Y02669P 01488302
*                    ***      OTHER FIELDS ARE UNCHANGED       @Y02669P 01488702
*                                                                       01489102
*     RETURN CODES =  ZERO                                     @Y02669P 01489502
*                                                                       01489902
*  EXIT-NORMAL = CSCBBRCH                                        Y02669 01490302
*                                                                       01490702
*     CONDITIONS =  COMMAND IS 'HALT EOD' OR 'SWITCH SMF'        Y02669 01491102
*                   EXIT TO CSCB CREATION MODULE (IEE0803D) VIA  Y02669 01491502
*                   BRANCH ON VCON.                              Y02669 01491902
*                                                                       01492302
*  OUTPUT DATA =  REGISTER TWO POINTS TO THE XSA CONTAINING:     Y02669 01492702
*                 XAV   COMMAND VERB                             Y02669 01493102
*                 OTHER FIELDS ARE UNCHANGED                     Y02669 01493502
*                                                                       01493902
*     RETURN CODES =  NONE                                       Y02669 01494302
*                                                                       01495202
*  EXIT-NORMAL =  TPBRCH                                         Y02669 01495302
*                                                                       01495402
*     CONDITIONS =  OPERAND ON HALT WAS 'TP ' OR 'TP,'           Y02669 01495502
*                   EXIT TO TCAM PROCESSOR (IED1303D) VIA BRANCH Y02669 01495602
*                   ON VCON.                                     Y02669 01495802
*                                                                       01496002
*     OUTPUT DATA =  SAME AS EXIT CSCBBRCH                       Y02669 01496202
*                                                                       01496402
*     RETURN CODES =  NONE                                       Y02669 01496602
*                                                                       01496802
*  EXIT-NORMAL =  NETBRCH                                        Y02674 01497002
*                                                                       01497102
*     CONDITIONS =  OPERAND ON HALT WAS 'NET ' OR 'NET,'         Y02674 01497302
*                   EXIT TO VTAM PROCESSOR (ISTCFF3D) VIA        Y02674 01497502
*                   BRANCH ON VCON.                              Y02674 01497802
*                                                                       01498002
*     OUTPUT DATA =  SAME AS EXIT CSCBBRCH                       Y02669 01498202
*                                                                       01498402
*     RETURN CODES =  NONE                                       Y02669 01498602
*                                                                       01498802
*  EXIT-NORMAL = SS1BRCH                                       @Y30LPSV 01498903
*                                                                       01500103
*     CONDITIONS = OPERAND ON HALT WAS 'S,LONG' OR             @Y30LPSV 01500803
*                  'S,SNAP'. EXIT TO SS/1 PROCESSOR (IEE9403D) @Y30LPSV 01501203
*                  VIA BRANCH ON VCON.                         @Y30LPSV 01501603
*                                                                       01501703
*     OUTPUT DATA = SAME AS EXIT CSCBBRCH                      @Y30LPSV 01501803
*                                                                       01501903
*  EXIT-NORMAL =  MSGBRCH                                      @Y02669P 01502003
*                                                                       01502203
*     CONDITIONS = OPERAND ON TRACE WAS 'STATUS' OR NULL, AND  @Y02669P 01503403
*                  SYSTEM TRACING WAS IN EFFECT                @Y02669P 01504603
*                                                                       01505603
*     OUTPUT DATA =  REGISTER TWO POINTS TO AN XSA CONTAINING  @Y02669P 01506603
*                    XAE      MESSAGE CODE X'34'               @Y02669P 01508203
*                    XAV      COMMAND VERB                     @Y02669P 01509403
*                    ***      OTHER FIELDS ARE UNCHANGED       @Y02669P 01510603
*                                                                       01512603
*     RETURN CODES =  ZERO                                     @Y02669P 01513003
*                                                                       01515003
*  EXIT-NORMAL =  MSGBRCH                                      @Y02669P 01516003
*                                                                       01517003
*     CONDITIONS =  OPERAND ON TRACE WAS 'STATUS' OR NULL,     @Y02669P 01518203
*                   AND SYSTEM TRACING WAS NOT ACTIVE.         @Y02669P 01520003
*                                                                       01520903
*     OUTPUT DATA =  REGISTER TWO POINTS TO AN XSA CONTAINING  @Y02669P 01521803
*                    XAE      MESSAGE CODE X'24'               @Y02669P 01523603
*                    XAV      COMMAND VERB                     @Y02669P 01524503
*                    ***      OTHER FIELDS ARE UNCHANGED       @Y02669P 01525403
*                                                                       01527202
*     RETURN CODES =  ZERO                                     @Y02669P 01528103
*                                                                       01529003
*  EXIT-ERROR =  MSGBRCH                                         Y02669 01530803
*                                                                       01531803
*     CONDITIONS = MISSING OPERAND ON HALT OR SWITCH.          @Y02669P 01533003
*                  EXIT TO MESSAGE MODULE (IEE0503D) VIA         Y02669 01534003
*                  BRANCH ON VCON TO ISSUE MESSAGE IEE311I.      Y02669 01535003
*                                                                       01536003
*     OUTPUT DATA =  REGISTER TWO POINTS TO AN XSA CONTAINING:   Y02669 01538003
*                    XAE      MESSAGE CODE X'0B'                 Y02669 01539003
*                    XAV      COMMAND VERB                       Y02669 01540003
*                    ***      OTHER FIELDS ARE UNCHANGED         Y02669 01541003
*                                                                       01542003
*     RETURN CODES =  FOUR.                                      Y02669 01544003
*                                                                       01545003
*  EXIT-ERROR =  MSGBRCH                                         Y02669 01546003
*                                                                       01547003
*     CONDITIONS = OPERAND NEITHER 'SMF' FOR SWITCH NOR 'EOD',   Y02669 01548003
*                  'TP ', 'TP,', 'NET ', OR 'NET,' FOR HALT.     Y02669 01550003
*                  EXIT TO MESSAGE MODULE (IEE0503D) VIA         Y02669 01551003
*                  BRANCH ON VCON TO ISSUE MESSAGE IEE309I.      Y02669 01552003
*                                                                       01553003
*     OUTPUT DATA =  REGISTER TWO POINTS TO AN XSA CONTAINING:   Y02669 01554003
*                    XAE      MESSAGE CODE X'09'                 Y02669 01555003
*                    XAV      COMMAND VERB                       Y02669 01556003
*                    ***      OTHER FIELDS ARE UNCHANGED         Y02669 01557003
*                                                                       01558003
*     RETURN CODES =  FOUR.                                      Y02669 01560003
*                                                                       01562002
*  EXIT-ERROR =  MSGBRCH                                       @Y02669P 01563003
*                                                                       01564003
*     CONDITIONS =  OPERAND ON TRACE WAS NOT AMONG 'ON',       @Y02669P 01565003
*                   'OFF', 'STATUS' AND NULL.                  @Y02669P 01566003
*                                                                       01568003
*     OUTPUT DATA =  REGISTER TWO POINTS TO AN XSA CONTAINING  @Y02669P 01569003
*                    XAE      MESSAGE CODE X'3E'               @Y02669P 01570003
*                    XAV      COMMAND VERB                     @Y02669P 01571003
*                    ***      OTHER FIELDS ARE UNCHANGED       @Y02669P 01572003
*                                                                       01574003
*     RETURN CODES =  FOUR                                     @Y02669P 01575003
*                                                                       01575503
*  EXIT-ERROR = MSGBRCH                                        @Y30LPSV 01576003
*                                                                       01576103
*     CONDITIONS = OPERAND ON HALT WAS EITHER 'LONG'           @Y30LPSV 01576203
*                  OR 'SNAP'. EXIT TO MESSAGE MODULE           @Y30LPSV 01576303
*                  (IEE0503D) TO ISSUE MESSAGE IEE084I.        @Y30LPSV 01576403
*                                                                       01576503
*     OUTPUT DATA = REGISTER TWO POINTS TO AN XSA CONTAINING   @Y30LPSV 01577003
*                   XAE      MESSAGE CODE X'19'                @Y30LPSV 01577203
*                   XAV      COMMAND VERBS                     @Y30LPSV 01577403
*                   ***      OTHER FIELDS ARE UNCHANGED        @Y30LPSV 01577603
*                                                                       01577803
*     RETURN CODES = FOUR                                      @Y30LPSV 01578003
*                                                                       01578303
*  EXTERNAL REFERENCES =                                         Y02669 01578603
*                                                                       01579003
*     ROUTINES = IEE0503D - TO ISSUE MESSAGES, VIA BRANCH        Y02669 01580003
*                IEE0803D - TO BUILD CSCB, VIA BRANCH            Y02669 01581003
*                IED1303D - TO PROCESS TCAM COMMANDS, VIA BRANCH Y02669 01582003
*                ISTCFF3D - TO PROCESS VTAM COMMANDS, VIA BRANCH Y02674 01583003
*                IEE9403D - TO PROCESS SS/1 COMMANDS, VIA BRCH @Y30LPSV 01584003
*                                                                       01584503
*     DATA AREAS =  NONE                                         Y02669 01586003
*                                                                       01587003
*     CONTROL BLOCKS =  XSA, CVT, BASEA                        @Y02669P 01588003
*                                                                       01589003
*     TABLES =  NONE                                             Y02669 01590803
*                                                                       01591603
*     MACROS =  MODID, IEEXSA, CVT, IEEBASEA                   @Y02669P 01593203
*                                                                       01594003
*     CHANGE LEVEL =  Y02669, Y02674, @Y30LPSV                 @Y30LPSV 01595603
*                                                                       01596303
*  MESSAGES =                                                    Y02669 01598003
*            CODE                         TEXT                   Y02669 01599003
*            X'09'       IEE309I  (VERB)  UNIDENTIFIABLE KEYWORD Y02669 01600003
*            X'0B'       IEE311I  (VERB)  PARAMETER MISSING      Y02669 01601003
*            X'24'       IEE341I  (VERB)  NOT ACTIVE           @Y02669P 01602003
*            X'34'       IEE382I  (VERB)  CURRENTLY ACTIVE     @Y02669P 01603003
*            X'3E'       IEE535I  (VERB)  INVALID PARAMETER    @Y02669P 01605003
*            X'03'       IEE712I  (VERB)  PROCESSING COMPLETE  @Y02669P 01606003
*            X'19'       IEE084I  (VERB)  SS/1 PARAMETER       @Y30LPSV 01606703
*                                         MISSING              @Y30LPSV 01607403
*                                                                       01608103
*            ALL MESSAGES CONTAINED IN AND ISSUED BY IEE0503D.   Y02669 01608803
*                                                                       01609503
*  SYSGEN =  THIS MODULE IS IN LOAD MODULE IGC0003D IN           Y02669 01610503
*            SYS1.LPALIB.  IT IS INCLUDED AT SYSGEN FROM DLIB    Y02669 01611503
*            AOSB3 BY SYSGEN MACRO SGIEF441.                     Y02669 01612503
*                                                                       01613503
*  SYSTEM LIBRARIES =  THIS MODULE MAKES REFERENCE TO NO SYSTEM  Y02669 01614503
*                      LIBRARIES.                                Y02669 01615503
*                                                                       01616503
*********************************************************************** 01617503
         EJECT                                                          01620003
*********************************************************************** 01622003
*   SYNTAX =                                                            01623003
*             ************                                              01624003
*             *  ON      *                                              01625003
*      TRACE  *  OFF     *     TRACE CANNOT BE ABBREVIATED; STATUS      01626003
*             *  STATUS  *     IS THE DEFAULT                           01627003
*             ************                                              01628003
*                                                                       01629003
***************************************************************@Y02669P 01630003
         EJECT                                                          01631003
* REGISTERS USED                                                        01632003
PARREG    EQU  2                       USED FOR ADDRESSABILITY TO XSA   01633003
R5       EQU   5                       REG POINTS CVT          @Y02669P 01634003
WKREG    EQU   8                       CODE REGISTER                    01635003
BRCHREG  EQU   9                       EXIT BRANCH REGISTER      Y02669 01636003
LISTREG  EQU   11                      REG POINTS TO EOD OPERAND        01640000
R10      EQU   10                      BASEA ADDRESS REGISTER  @Y02669P 01660002
BASEREG  EQU   12                      BASE   REGISTER                  01700000
RETCDREG EQU   15                      RETURN CODE REGISTER      Y02669 01702002
E0       EQU   0                                                  20002 01740901
E1       EQU   1                       *                       @Y02669P 01741902
E2       EQU   2                       *                       @Y30LPSV 01742903
E3       EQU   3                                                  20002 01744101
E4       EQU   4                                                 Y02669 01744502
E5       EQU   5                       *                       @Y30LPSV 01744703
E6       EQU   6                       *                       @Y30LPSV 01744903
E7       EQU   7                       *                       @Y02669P 01745102
E8       EQU   8                                                  20002 01745701
SWITCHCD EQU   52                      SWITCH VERB CODE        @Y02669P 01748702
TRACECD  EQU   20                      TRACE VERB CODE         @Y02669P 01751702
HALTCD   EQU   60                      HALT VERB CODE          @Y02669P 01756902
FOUR     EQU   4                       COMMAND NOT EXECUTED      Y02669 01758902
*                                      RETURN CODE               Y02669 01759402
XFF      EQU   255                     MASK FOR TURNING OFF    @Y02669P 01759902
*                                      BITS                    @Y02669P 01760402
IEE084I  EQU   X'19'                ERROR CODE- MESSAGE MODULE @Y30LPSV 01767803
*                                   C'SS/1 PARAMETER MISSING'  @Y30LPSV 01767903
*                                                                       01768003
IEE309I  EQU   X'09'                   ERROR CODE- MESSAGE MODULE       01774003
*                                      C'UNIDENTIFIABLE KEYWORD.'Y02669 01775003
*                                                              @Y30LPSV 01776003
IEE311I  EQU   X'0B'                   ERROR CODE- MESSAGE MODULEY02669 01779303
*                                      C' PARAMETER MISSING.'    Y02669 01781303
*                                                                       01784003
IEE341I  EQU   X'24'                   ERROR CODE- MSG MODULE  @Y02669P 01786003
*                                      C' NOT ACTIVE '         @Y02669P 01788703
*                                                                       01790703
IEE382I  EQU   X'34'                   ERROR CODE- MSG MODULE  @Y02669P 01792703
*                                      C' CURRENTLY ACTIVE '   @Y02669P 01793703
*                                                                       01794703
IEE535I  EQU   X'3E'                   ERROR CODE- MSG MODULE  @Y02669P 01798103
*                                      C' INVALID PARAMETER '  @Y02669P 01800103
*                                                                       01802803
IEE712I  EQU   X'03'                   ERROR CODE- MSG MODULE  @Y02669P 01803803
*                                      C' PROCESSING COMPLETE '@Y02669P 01804803
*                                                                       01807503
         EJECT                                                          01809503
IEE1403D CSECT                                                   Y02669 01812203
         BALR  BASEREG,0               ESTABLISH ADDRESSIBILITY FOR     01814203
         USING *,BASEREG               MODULE                    Y02669 01816903
         MODID BRANCH=YES                                        Y02669 01817903
         USING EXSAVSEC,PARREG         SET ADDRESSIBILITY FOR ESA       01818903
*                                                                       01821603
         L     LISTREG,XAL             LOAD POINTER TO OPERAND          01823603
*                                                                       01826303
         LA    LISTREG,0(LISTREG)      GET ADDR OF OPERAND              01828303
*                                                                       01831003
         LA    WKREG,IEE311I           SET FOR MSG IEE311I       Y02669 01835703
         CLI   XAN,SWITCHCD            ENTRY FOR SWITCH?       @Y02669P 01836702
         BE    SWITCH                  YES, BRANCH TO SWITCH   @Y02669P 01837302
*                                      CODE                    @Y02669P 01837903
         CLI   XAN,TRACECD             ENTRY FOR TRACE?        @Y02669P 01839403
         BE    TRACE                   YES, BRANCH TO TRACE    @Y02669P 01841703
*                                      CODE                    @Y02669P 01843503
*                                                                       01845503
*        OTHERWISE, ENTRY IS FOR HALT                          @Y02669P 01847503
*                                                                       01849503
         EJECT                                                          01851503
***************************************************************@Y02669P 01853503
*                                                              @Y02669P 01855503
* ENTRY WAS MADE FOR A HALT COMMAND                            @Y02669P 01859202
*                                                              @Y02669P 01862202
***************************************************************@Y02669P 01865202
         SPACE 2                                                        01868602
         MVC   XAV(E8),AHALT           MOVE HALT VERB TO XSA   @Y02669P 01920302
*                                      FOR MSG                 @Y02669P 01929702
         LTR   LISTREG,LISTREG         OPERAND NULL?           @Y02669P 01934402
         BZ    MSGBRCH                 YES, BRANCH FOR MSG     @Y02669P 01939102
*                                      IEE311I                 @Y02669P 01948502
         SPACE 2                                                        01954502
*                                                                       01960502
*        TEST FOR TCAM OPERANDS                                  Y02669 01966502
*                                                                       01972502
         SPACE                                                          01978502
         CLC   E0(E3,LISTREG),TPCOMMA  Q. 'TP,'                  Y02669 01984502
         BE    TPBRCH                  YES, BRANCH TO 1303D      Y02669 01990502
         CLC   E0(E3,LISTREG),TPBLANK  Q. 'TP '                  Y02669 01996502
         BE    TPBRCH                  YES, BRANCH TO 1303D      Y02669 02002502
           SPACE                                                        02008502
*                                                                       02014502
*        TEST FOR VTAM OPERANDS                                  Y02674 02020502
*                                                                       02026502
         SPACE                                                          02032502
         CLC   E0(E4,LISTREG),NETCOMMA Q. 'NET,'                 Y02674 02038502
         BE    NETBRCH                 YES, BRANCH TO ISTCFF3D   Y02674 02044502
         CLC   E0(E4,LISTREG),NETBLANK Q. 'NET '                 Y02674 02050502
         BE    NETBRCH                 YES, BRANCH TO ISTCFF3D   Y02674 02056502
         SPACE 1                                               @Y30LPSV 02057103
*                                                              @Y30LPSV 02057703
*        TEST FOR SS/1 OPERANDS                                @Y30LPSV 02058303
*                                                              @Y30LPSV 02058903
         SPACE 1                                               @Y30LPSV 02059503
         CLC   E0(E2,LISTREG),S        Q. 'S,'                 @Y30LPSV 02060103
         BE    SS1BRCH                 YES, BRANCH TO IEE9403D @Y30LPSV 02060703
         LA    WKREG,IEE084I           SET UP FOR ERROR MSG    @Y30LPSV 02061303
         CLC   E0(E5,LISTREG),LONG     Q. 'LONG'               @Y30LPSV 02068503
         BE    MSGBRCH                 YES,TAKE ERROR MSG EXIT @Y30LPSV 02070503
         CLC   E0(E5,LISTREG),SNAP     Q. 'SNAP'               @Y30LPSV 02072503
         BE    MSGBRCH                 YES,TAKE ERROR MSG EXIT @Y30LPSV 02074503
         EJECT                                                 @Y30LPSV 02076503
*                                                              @Y30LPSV 02078503
*        TEST FOR END OF DAY                                   @Y30LPSV 02080503
*                                                              @Y30LPSV 02081503
         SPACE 1                                               @Y30LPSV 02082503
         CLC   E0(E4,LISTREG),AEOD     OPERAND = EOD?            Y02669 02083503
         BE    CSCBBRCH                YES- GO TO IEE0803D       Y02669 02084503
ERROR    LA    WKREG,IEE309I           SET UP FOR ERROR          A40296 02086503
         B     MSGBRCH                 TAKE ERROR EXIT           A40296 02089503
          EJECT                                                         02092503
***************************************************************@Y02669P 02098503
*                                                                A40296 02104503
* ENTRY WAS MADE FOR A SWITCH COMMAND                            A40296 02110503
*                                                                A40296 02116503
***************************************************************@Y02669P 02122503
          SPACE 2                                                       02128503
SWITCH   MVC   XAV(E8),ASWITCH         MOVE SWITCH VERB TO     @Y02669P 02134503
*                                      XSA FOR MSG             @Y02669P 02140503
         LTR   LISTREG,LISTREG         OPERAND NULL?           @Y02669P 02146503
         BZ    MSGBRCH                 YES, BRANCH FOR MSG     @Y02669P 02152503
*                                      IEE311I                 @Y02669P 02158503
         CLC   E0(E4,LISTREG),ASMF     OPERAND = SMF?            Y02669 02167503
         BNE   ERROR                   NO - BAD OPERAND          A40296 02170503
         B     CSCBBRCH                YES - GOTO IEE0803D     @Y02669P 02176503
       EJECT                                                            02182503
***************************************************************@Y02669P 02188503
*                                                              @Y02669P 02194503
* ENTRY WAS MADE FOR A TRACE COMMAND                           @Y02669P 02200503
*                                                              @Y02669P 02206503
***************************************************************@Y02669P 02212503
        SPACE 2                                                         02218503
TRACE    MVC   XAV(E8),ATRACE          MOVE TRACE VERB TO XSA  @Y02669P 02224503
*                                      FOR MSG                 @Y02669P 02230503
         LTR   LISTREG,LISTREG         OPERAND NULL?           @Y02669P 02236503
         BZ    TRACESTS                YES, DO STATUS          @Y02669P 02242503
*                                      PROCESSING              @Y02669P 02248503
         USING BASE,R10                BASEA ADDRESSABILITY    @Y02669P 02254502
         LA    WKREG,IEE712I           SET UP FOR MSG IEE712I; @Y02669P 02260502
*                                      USED FOR BOTH ON AND OFF@Y02669P 02266502
         CLC   E0(E3,LISTREG),ON       TRACE ON?               @Y02669P 02272502
         BE    TRACEON                 YES, DO ON PROCESSING   @Y02669P 02278502
         CLC   E0(E4,LISTREG),OFF      TRACE OFF?              @Y02669P 02284502
         BE    TRACEOFF                YES, DO OFF PROCESSING  @Y02669P 02290502
         CLC   E0(E7,LISTREG),STATUS   TRACE STATUS            @Y02669P 02296502
         BE    TRACESTS                YES, DO STATUS          @Y02669P 02302502
*                                      PROCESSING              @Y02669P 02308502
         LA    WKREG,IEE535I           SET UP FOR IEE535I;     @Y02669P 02314502
         B     MSGBRCH                 TAKE MSG EXIT           @Y02669P 02320502
         SPACE 2                                                        02326502
* TRACE ON ROUTINE                                             @Y02669P 02332502
         SPACE                                                          02338502
TRACEON  OI    BASPBYTE,BATRACE        SET TRACE BIT ON        @Y02669P 02344502
         B     MSGBRCH1                TAKE MSG EXIT FOR       @Y02669P 02354502
*                                      IEE712I                 @Y02669P 02378802
         SPACE 2                                                        02378902
* TRACE OFF ROUTINE                                            @Y02669P 02379302
         SPACE                                                          02379402
TRACEOFF NI    BASPBYTE,XFF-BATRACE    SET TRACE BIT OFF       @Y02669P 02379502
         B     MSGBRCH1                TAKE MSG EXIT FOR       @Y02669P 02379602
*                                      IEE712I                 @Y02669P 02379702
         SPACE 2                                                        02379902
* TRACE STATUS ROUTINE                                         @Y02669P 02380102
         SPACE                                                          02380402
TRACESTS L     R5,CVTPTR               CVT...                  @Y02669P 02380502
         USING CVT,R5                  ...ADDRESSABILITY       @Y02669P 02380602
         CLC   CVTTRACE,TRACNACT       CVT TRACE BRCH INACTIVE @Y02669P 02380702
         BE    MIEE341I                YES - NO TRACE ACTIVE   @Y02669P 02380802
         LA    WKREG,IEE382I           SET UP FOR MSG IEE382I  @Y02669P 02380902
         B     MSGBRCH1                TAKE MSG EXIT           @Y02669P 02381002
MIEE341I LA    WKREG,IEE341I           SET UP FOR MSG IEE341I  @Y02669P 02381102
         B     MSGBRCH1                TAKE MSG EXIT           @Y02669P 02381302
         EJECT                                                          02381402
**************************************************************** Y02669 02381502
*                                                                Y02669 02381602
*        BRANCH EXIT ROUTINES                                    Y02669 02381702
*                                                                Y02669 02381802
**************************************************************** Y02669 02381902
       SPACE 2                                                          02382002
*                                                                Y02669 02382102
*        EXIT TO CSCB CREATION                                   Y02669 02382202
*                                                                Y02669 02382302
          SPACE                                                         02382402
CSCBBRCH EQU   *                                                 Y02669 02382502
         L     BRCHREG,CSCBMOD         GET ADDRESS OF CSCB       Y02669 02383302
*                                      CREATION MODULE           Y02669 02383402
         BR    BRCHREG                 BRANCH TO IT              Y02669 02384002
       SPACE 2                                                          02384602
*                                                                Y02669 02385202
*        EXIT TO TCAM PROCESSOR                                  Y02669 02385802
*                                                                Y02669 02386402
          SPACE                                                         02387002
TPBRCH EQU   *                                                   Y02669 02387602
         L     BRCHREG,TPMOD           GET ADDRESS OF TCAM       Y02669 02388202
*                                      PROCESSOR MODULE          Y02669 02388802
         BR    BRCHREG                 BRANCH TO IT              Y02669 02389402
       SPACE 2                                                          02390002
*                                                                Y02674 02390602
*        EXIT TO VTAM PROCESSOR                                  Y02674 02391202
*                                                                Y02674 02391802
          SPACE                                                         02392402
NETBRCH EQU   *                                                  Y02674 02393002
         L     BRCHREG,NETMOD          GET ADDRESS OF VTAM       Y02674 02393602
*                                      PROCESSOR MODULE          Y02674 02394202
         BR    BRCHREG                 BRANCH TO IT              Y02674 02394802
         SPACE 2                                                        02394903
*                                                              @Y30LPSV 02395003
*              EXIT TO SS/1 PROCESSOR                          @Y30LPSV 02399003
*                                                              @Y30LPSV 02403303
SS1BRCH  EQU   *                                               @Y30LPSV 02407303
         L     BRCHREG,SS1MOD          GET ADDRESS OF SS/1     @Y30LPSV 02411303
*                                      PROCESSOR MODULE        @Y30LPSV 02413303
         BR    BRCHREG                 BRANCH TO IT            @Y30LPSV 02417303
         EJECT                                                 @Y30LPSV 02419303
*                                                                Y02669 02423303
*        EXIT TO MESSAGE MODULE                                  Y02669 02425303
*                                                                Y02669 02431303
          SPACE                                                         02433303
MSGBRCH EQU   *                        ERROR MESSAGE EXIT      @Y02669P 02435303
         STC   WKREG,XAE               STORE CODE IN EXT SAVE AREA.     02439303
         L     BRCHREG,MSGMOD          GET ADDRESS OF MESSAGE    Y02669 02443303
*                                      MODULE                    Y02669 02446303
         LA    RETCDREG,FOUR           SET FAILING RET CODE      Y02669 02449303
         BR    BRCHREG                 BRANCH TO MESSAGE MODULE  Y02669 02452303
         SPACE                                                          02455303
MSGBRCH1 EQU  *                        SUCCESS MESSAGE EXIT    @Y02669P 02458303
         STC   WKREG,XAE               STORE CODE IN EXT SAVE AREA.     02463302
         L     BRCHREG,MSGMOD          GET ADDRESS OF MESSAGE    Y02669 02483302
*                                      MODULE                    Y02669 02503302
         SR    RETCDREG,RETCDREG       SET SUCCESS RET CODE      Y02669 02523302
         BR    BRCHREG                 BRANCH TO MESSAGE MODULE  Y02669 02543302
        EJECT                                                           02610002
**************************************************************** Y02669 02630002
*                                                                Y02669 02632002
*        MODULE CONSTANTS                                        Y02669 02634002
*                                                                Y02669 02636002
**************************************************************** Y02669 02638002
        SPACE 3                                                         02688002
AHALT    DC    CL8'HALT'               VERB                             02700000
TPMOD    DC    V(IED1303D)             TCAM MODULE               Y02669 02708002
NETMOD   DC    V(ISTCFF3D)             VTAM MODULE               Y02674 02710002
MSGMOD   DC    V(IEE0503D)             MESSAGE MODULE            Y02669 02717002
CSCBMOD  DC    V(IEE0803D)             CSCB CREATE MODULE        Y02669 02719002
SS1MOD   DC    V(IEE9403D)             SS1 MODULE              @Y30LPSV 02729003
*                                                                       02740000
AEOD     DC    C'EOD '                 EOD OPERAND                      02920000
ATRACE   DC    CL8'TRACE'              TRACE VERB FOR MESSAGES @Y02669P 02920102
ASWITCH  DC    C'SWITCH  '                                       A40296 02920202
TPCOMMA  DC    C'TP,'                  TCAM                       20002 02920302
TPBLANK  DC    C'TP '                  PARAMETERS                 20002 02922002
NETCOMMA DC    C'NET,'                 VTAM                      Y02674 02924002
NETBLANK DC    C'NET '                 PARAMETERS                Y02674 02926002
ASMF     DC    C'SMF '                                           A35849 02928002
TRACNACT DC    X'07FB'                 TRACE INACTIVE INDICATOR@Y02669P 02930002
*                                      IN CVT                  @Y02669P 02932002
ON       DC    C'ON '                  TRACE                   @Y02669P 02934002
OFF      DC    C'OFF '                 COMMAND                 @Y02669P 02936002
STATUS   DC    C'STATUS '              OPERANDS                @Y02669P 02938002
*                                                                       02940002
S        DC   C'S,'                    SS/1 TRIGGER            @Y30LPSV 02940303
LONG     DC   C'LONG '                 SS/1-ONLY               @Y30LPSV 02940903
SNAP     DC   C'SNAP '                 SECONDARY OPERANDS      @Y30LPSV 02941203
*                                                              @Y30LPSV 02941503
PATCH    DC    CL50'***  IEE1403D  PATCH AREA ***'             @Y02669P 02942002
*                                                                       02944002
         TITLE 'CVT'                                           @Y02669P 02950002
         CVT   DSECT=YES                                       @Y02669P 02952002
         TITLE 'MASTER RESIDENT DATA AREA'                     @Y02669P 02954002
         IEEBASEA                                              @Y02669P 02956002
         TITLE 'EXTENDED SAVE AREA'                                     02957002
EXSAVSEC DSECT                          DSECT FOR EXTENDED SAVE AREA.   02958002
         IEEXSA                                                         02960002
         END                                                            03630201
./  ADD  SSI=61730190,NAME=IEE1603D
         TITLE 'IEE1603D - LOG AND WRITELOG PROCESSOR'                  00100018
         TITLE 'COMMAND HANDLER  LOG AND WRITELOG'                      00300013
**********************************************************************  19550002
*                                                                       19600002
*   MODULE NAME=                                                        19650002
*              IEE1603D                                                 19700002
*                                                                       19750002
*   DESCRIPTIVE NAME=                                                   19800002
*              COMMANDS ROUTINE FOR  'LOG' AND 'WRITELOG'               19850002
*                                                                       19900002
*   COPYRIGHT=                                                          19950002
*              MISSING                                                  20000002
*                                                                       20050002
*   STATUS=                                                             20060002
*              OS/VS2 RELEASE 3                                @ZA07784 20062003
*                                                                       20070002
*   FUNCTION=                                                           20080002
*              TO PROCESS THE COMMANDS :                                20090002
*                        LOG 'TEXT'                                     20092002
*                        WRITELOG                                       20094002
*                        WRITELOG CLOSE / START / CLASS                 20096002
*                                                                       20098002
*      OPERATION=                                                       20098402
*              ENTRY TO THIS MODULE IS VIA A BRANCH FROM                20148402
*              IEE0403D - COMMAND ROUTER .                              20158402
*              ADDRESSIBILITY TO CONTROL BLOCKS IS AS FOLLOWS -         20168402
*              . EXTENDED SAVE AREA ( XSA ) - REG 2                     20178402
*              . MASTER RESIDENT CORE ( BASEA ) - REG 10                20180402
*              . LOG CONTROL TABLE ( LCA ) - REG 11                     20182402
*              1- SET UP POINTERS TO XSA FIELDS -                       20184402
*                 . BUFFER LENGTH                                       20186402
*                 . COMMAND OPERAND                                     20186802
*              2- CHECK IF LOG SUPPORTED - BASEA(BALOG) = ZERO .       20187202
*                 . IF NOT SUPPORTED , PROCESS AT REF(11) TO            20187302
*                   DETERMINE IF OPERAND IS 'START' .                   20187402
*              3- CHECK FOR 'LOG' VERB IN XSA(XAN) = X'1C' .            20187502
*                 . IF YES , PROCESS AT REF(10) .                       20189002
*              4- THE VERB IS 'WRITELOG' . CHECK FOR OPERANDS .         20191002
*                 . VALID COMBINATIONS OF OPERANDS ARE :                20193002
*                   . WRITELOG CLOSE - REF(5)                           20193402
*                   . WRITELOG CLASS - REF(6)                           20193502
*                   . WRITELOG       - REF(6)                           20193602
*                 . IF THE OPERAND IS  START  , IT WILL NOT BE          20193702
*                   PROCESSED BECAUSE THE SYSTEM LOG IS ALREADY ACTIVE. 20193802
*                   . SET MSG CODE = 52 .                               20194602
*                   . PROCESS AT REF(12) .                              20196602
*              5- CLOSE OPERAND PROCESSING .                            20198202
*                 . CHECK FOR DELIMITER - (' ')- IF ERROR ,             20199002
*                   SET MSG CODE = 7 , PROCESS AT REF(12) .             20199802
*                 . IF LOG IS ALREADY PROCESSING TERMINATION -          20200602
*                   LCA(POSTCLOZ) = ON , ISSUE WTO IEE033I ,            20201402
*                   PROCESS AT REF(9) .                                 20202202
*                 . VERIFY LOG = HARDCOPY STATUS .                      20203002
*                   IF LOG = HARDCOPY - UCM(UCMSYSG) = ON ,             20203802
*                   . SET UP , ISSUE WTO IEE532I ,                      20204602
*                   . PROCESS AT REF(9) .                               20205402
*                 . CHECK IF LCA(POSTCLOZ) = ON -                       20206202
*                   . IF YES , BYPASS POST OF LOG TERMINATION ECB       20207002
*                     PROCESS AT REF(9) .                               20207802
*                 . SET LCA(POSTCLOZ) = ON .                            20208602
*                 . POST LOG TERMINATION ECB - BASEA(MSLGCLOZ) .        20209402
*                 . PROCESS AT REF(9) .                                 20210202
*              6- CLASS OR NULL OPERAND PROCESSING .                    20211002
*                 IF THE OPERAND FIELD IS NULL , PROCESS AT REF(7).     20211802
*                 CHECK FOR DELIMITER - (' ') .                         20212602
*                 . IF ERROR , SET MSG CODE = 7 ,                       20213402
*                   PROCESS AT REF(12) .                                20214202
*                 CHECK FOR VALID CLASS - (A-Z,0-9 ) .                  20215002
*                 . IF INVALID , SET MSG CODE = 23 ,                    20215802
*                   PROCESS AT REF(12) .                                20216602
*                 STORE CLASS TYPE IN LCA(LCCLASS) FIELD .              20217402
*              7- IF A 'WRITELOG' COMMAND IS ALREADY BEING PROCESSED -  20218202
*                 OR A 'WRITELOG CLOSE' COMMAND IS BEING PROCESSED -    20219002
*                 LCA(POSTWLOG , POSTCLOZ ) = ON , ISSUE                20219802
*                 APPROPRIATE WTO :                                     20220602
*                 . WRITELOG - IEE032I .                                20221402
*                 . WRITELOG CLOSE - IEE033I .                          20222202
*                 . PROCESS AT REF(9) .                                 20223002
*              8- SET LCA(POSTWLOG) = ON .                              20223802
*                 POST LOG DATA SET SWITCH ECB - BASEA(MSLGWLOG)        20224602
*              9- RETURN TO CALLER .                                    20225402
*             10- VERB='LOG' . SYNTAX CHECK THE TEXT INPUT              20226202
*                 FOR THE FOLLOWING ERRORS , SET APPROPRIATE            20227002
*                 ERROR MSG CODE IN XSA(XAE) ,                          20227802
*                 . INVALID TEXT PTR - MSG CODE(11)                     20228602
*                 . FIRST CHAR NOT A QUOTE - MSG CODE(19)               20229402
*                 . IF ERROR , PROCESS AT REF(12) .                     20230202
*                 GET CORE FOR WTL MSG BUFFER . SET UP 4 BYTE           20231002
*                 HEADER FOR MSG LENGTH , MOVE MSG TO BUFFER VIA        20231802
*                 SCAN LOOP OF TEXT , SET LENGTH IN HEADER .            20232602
*                 . IF LENGTH = ZERO , FREE CORE ,                      20233402
*                 . PROCESS AT REF(9) .                                 20234202
*                 ISSUE WTL MACRO                                       20235002
*                 FREE MSG CORE .                                       20235802
*                 PROCESS AT REF(9) .                                   20236602
*             11- WRITELOG 'START' PROCESSING .                         20237402
*                 VERIFY WRITELOG VERB CODE - XSA(XAN) = X' '           20238202
*                 . IF NOT , SET ERROR CODE = 26 ,                      20239002
*                   PROCESS AT REF(12) .                                20239802
*                 VERIFY OPERAND IS 'START' .                           20240602
*                 . IF NOT , SET ERROR CODE = 11 ,                      20241402
*                   PROCESS AT REF(12) .                                20242202
*                 RE-ACTIVATE THE LOG RECORDING FUNCTION VIA A POST     20243002
*                 OF THE WRITELOG START ECB - BASEA(        ) .         20243802
*                 PROCESS AT REF(9) .                                   20244602
*             12- SET UP TO BRANCH TO MSG MODULE IGC0503D .             20245402
*                 . XSA(XAE) = ERROR MSG CODE .                         20246202
*                 BRANCH TO IGC0503D .                                  20247002
*                                                                       20247802
*   NOTES                                                               20248602
*                                                                       20249402
*      CHARACTER CODE DEPENDENCIES=                                     20250202
*              THIS MODULE HAS BEEN WRITTEN IN SUCH A WAY THAT          20251002
*              IF THE CHARACTER CODE IS CHANGED FRON EBCDIC ,           20251802
*              REASSEMBLY WILL YIELD A VALID MODULE .                   20252602
*                                                                       20253402
*      DEPENDENCIES=                                                    20254202
*              REFER TO MACRO SECTION .                                 20255002
*                                                                       20255802
*      RESTRICTIONS=                                                    20256602
*              NONE .                                                   20257402
*                                                                       20258202
*      REGISTER CONVENTIONS=                                            20259002
*              REFER TO REG. CONTENTS SECTION .                         20259802
*                                                                       20260602
*      PATCH-LABEL=                                                     20261402
*              PATCH                                                    20262202
*                                                                       20263002
*   MODULE TYPE=                                                        20263802
*              CSECT                                                    20264602
*                                                                       20265402
*      PROCESSOR=                                                       20266202
*              ASSEMBLER                                                20276202
*                                                                       20286202
*      MODULE SIZE=                                                     20288202
*             1000 BYTES                                                20290202
*                                                                       20292202
*      ATTRIBUTES=                                                      20294202
*              REENTRANT                                                20294602
*              SELF-RELOCATING                                          20295002
*              PAGED LPA                                                20295102
*                                                                       20295402
*   ENTRY POINT=                                                        20295802
*              IEE1603D FROM COMMAND ROUTER  IEE0403D .                 20295902
*                                                                       20296002
*      PURPOSE=                                                         20296102
*              TO PROCESS 'LOG' , 'WRITELOG' COMMANDS .                 20312802
*                                                                       20322802
*      LINKAGE=                                                         20324802
*              VIA BRANCH REG 15 FROM IEE0403D .                        20326802
*                                                                       20328802
*      INPUT DATA=                                                      20329202
*              REG 2 POINTS TO THE  XSA :                               20329302
*                        XAR POINTS TO COMMAND BUFFER .                 20329402
*                        XAN CONTAINS VERB CODE .                       20335002
*                        XAL POINTS TO COMMAND PARM LIST .              20337002
*                        XAV CONTAINS THE VERB .                        20339002
*                                                                       20339402
*      REGISTERS SAVED=                                                 20339802
*              NONE .                                                   20340202
*                                                                       20340302
*      REGISTER CONTENTS DURING PROCESSING=                             20340402
*              R0            WORK REG .                                 20340502
*              R1            GETMAIN RETURN REG .                       20355302
*              R2            XSA BASE .                                 20365302
*              R3            CVT BASE .                                 20367302
*              R4            WORK REG                                   20369302
*              R5            WORK REG                                   20369702
*              R6            WORK REG.                                  20370102
*              R7            UCB TABLE STOPPER .                        20370202
*              R8            WORK REG .                                 20370302
*              R9            UNIT NAME PTR .                            20375202
*              RA            MSRDA BASE .                               20377202
*              RB            LCA PTR .                                  20379202
*              RC            PROGRAM BASE .                             20379602
*              RD            NOT REFERENCED .                           20380002
*              RE            RETURN REG .                               20380102
*              RF            BRANCH REG .                               20380202
*                                                                       20385102
*      REGISTERS RESTORED=                                              20387102
*              NONE .                                                   20389102
*                                                                       20389502
*   EXIT - NORMAL=                                                      20389902
*              RETURN TO CALLER                                         20390002
*                                                                       20390102
*      CONDITIONS=                                                      20440102
*              NORMAL PROCESSING OF 'LOG' , 'WRITELOG' COMMANDS         20450102
*                                                                       20460102
*      OUTPUT DATA=                                                     20470102
*              FOR 'LOG' ;  A WTL MESSAGE .                             20480102
*              FOR 'WRITELOG':POST THE MSLGWLOG ECB .                   20482102
*              FOR 'WRITELOG CLOSE' ;POST THE MSLGCLOZ ECB.             20482502
*      RETURN CODES=                                                    20484102
*              NONE .                                                   20486102
*                                                                       20488102
*   EXIT - ERROR=                                                       20488502
*              IEE0503D  MSG MODULE , VIA BR 14 .                       20488902
*                                                                       20489302
*      CONDITIONS=                                                      20489702
*              INVALID COMMAND OPERANDS .                               20489802
*                                                                       20489902
*      OUTPUT DATA=                                                     20490002
*              ERROR MESSAGE CODES IN XSA FIELD  - XAE .                20506702
*                CODE        ERROR MSG .                                20516702
*                 7           'IEE307I  XXXXXXXX DELIMITER              20518702
*                              ERROR.'                                  20520702
*                11           'IEE311I CCCC PARAMETER                   20522702
*                              MISSING .'                               20523102
*                19           'IEE019I        QUOTES MISSING .'         20523202
*                23           'IEE023I        CLASSNAME ERROR'          20525702
*                26           'IEE026I        NOT SUPPORTED.'           20528302
*                52           'IEE382I        CURRENTLY ACTIVE'         20530302
*                                                                       20530802
*      RETURN CODES=                                                    20533302
*              NONE .                                                   20535802
*                                                                       20538302
*   EXTERNAL REFERENCES=                                                20540802
*              IEEMB803  VIA POST                                       20543302
*              IEE0503D  VIA VCON - BR 14                               20545802
*                                                                       20548302
*      ROUTINES=                                                        20550802
*              NONE                                                     20553302
*                                                                       20555802
*      DATA AREAS=                          REFERENCES                  20558302
*              LCA  - LOG CONTROL TABLE       U,M                       20560302
*              XSA  - EXTENDED SAVE AREA      U,M                       20560702
*              WTO MSG BUFFER                 U,M                       20561102
*                                                                       20561502
*      CONTROL BLOCKS=                                                  20561902
*              CVT                            U                         20562002
*              BASEA                          U,M                       20562102
*              UCM                            U                         20564602
*              UCB                            U                         20566602
*                                                                       20567102
*      TABLE=                                                           20569602
*                                                                       20572102
*      MACROS=                                                          20574602
*              POST                                                     20579602
*              GETMAIN / FREEMAIN                                       20582102
*              WTL                                                      20584602
*              WTO                                                      20587102
*                                                                       20592102
*      SERIALIZATION=                                                   20594602
*              NONE .                                                   20596602
*                                                                       20599602
*      CHANGE LEVEL=                                                    20624602
*              Y02669                                                   20626602
*              ZA07784                                                  20630603
*                                                                       20637403
*      SYSGEN=                                                          20641403
*              LOAD MODULE NAME - IGC0003D                              20645402
*                                                                       20665202
*      SYSTEM LIBRARIES=                                                20683802
*              NONE .                                                   20693802
*                                                                       20702402
*   MESSAGES=                                                           20721002
*              'IEE032I WRITELOG IS PENDING. CLASSNAME=  ',             20771002
*              'IEE033I PREVIOUS HALT OR WRITELOG CLOSE COMMAND         20871002
*               HAS BEEN ISSUED'                                        20881002
*              'IEE532I SYSTEM LOG DEFINED AS HARDCOPY-WRITELOG         20881802
*               CLOSE CMND REJECTED'                                    20883802
*                                                                       20888402
**********************************************************************  20907002
IEE1603D CSECT                                                          20925602
* LOGSTART (C)                                                 @ZA07784 20934603
R0       EQU   0                                                        20944202
R1       EQU   1                       GETMAIN RETURN REGISTER          20962802
R2       EQU   2                       XSA BASE                         20981402
R3       EQU   3                       CVT BASE                         21000013
R4       EQU   4                             DELIMITER POINTER          21300013
R5       EQU   5                       LINK REGISTER                    21600013
R6       EQU   6                       END OF PARAMETER POINTER         21900013
R7       EQU   7                       UCB TABLE STOPPER                22200013
R8       EQU   8                       UCB BASE                         22500013
R9       EQU   9                       UNIT NAME POINTER                22800013
R10      EQU   10                            RESIDENT CORE BASE         23100013
R11      EQU   11                      LCA BASE REG              Y02669 23200002
VBASE    EQU   12                            BASE FOR PROGRAM           23400013
R14      EQU   14                      RETURN REGISTER                  23700013
R15      EQU   15                            XCTL REGISTER              24000013
DEC10    EQU   10                                                       24120018
DEC1     EQU   1                                                        24180018
DEC4     EQU   4                                                        24260018
DEC3     EQU   3                                                        24270018
DEC2     EQU   2                                                        24271018
DEC5     EQU   5                                                        24272018
DEC8     EQU   8                                                 Y02669 24272102
DEC12    EQU   12                                                Y02669 24272402
DEC64    EQU   64                 OFFSET TO XSA SAVE AREA        Y02669 24272802
HEX40    EQU   X'40'                                                    24273018
BLANK    EQU   C' '                                                     24274018
CHARA    EQU   C'A'                                                     24275018
DEC0     EQU   0                                                        24280018
DISP     EQU   45                                                       24290018
*                                                                     * 24300013
* ERROR CODES FOR MESSAGE MODULE                                      * 24600013
ERR7     EQU   7                                                        25500013
ERR11    EQU   11                                                       26400013
ERR19    EQU   19                                                       27000013
ERR23    EQU   23                                                       27300013
ERR26    EQU   26                                                       27600013
ERR52    EQU   52                                                Y02669 27650002
*                                                                     * 27900013
LOGCOD   EQU   X'1C'                         VERB = LOG                 28800013
WRITLOG  EQU   X'20'                   VERB = WRITELOG           Y02669 28850002
HIBIT    EQU   X'80'                                             Y02669 28900002
*                                                                     * 29100013
QUOTE    EQU   C''''                         LOG TEXT DELIMITER         29700013
         EJECT                                                          30000013
*MAIN ROUTINE - ADDRESSABILITY, END OF BUFFER, AND PARAMETER POINTERS   30300018
*               ARE ESTABLISHED                                         30600018
*             - DETERMINES WHICH VERB IS SPECIFIED, LOG OR WRITELOG,    30900018
*               BY THE VERB CODE SET IN XAN(IN THE XSA)                 31200018
*                                                                     * 31500013
         BALR  VBASE,DEC0                   ESTABLISH PROGRAM           31800018
         USING *,VBASE                       ADDRESSABILITY             32100013
         MODID BR=YES                                            Y01886 32150001
         USING XSA,R2                  BASE FOR EXTENDED SAVE AREA      32400018
         USING SETCVT,R10                    ADDRESS TO CVT             32700013
         L     R10,CVTPTR                    TO GET POINTER             33000013
         L     R10,CVTMSER                   TO MASTER RESIDENT CORE    33300013
         USING BASE,R10                      TO ESTABLISH ADDRESSABLTY  33600013
         L     R9,XAL                        USE REGISTER 9 AS POINTER  33900013
         LA    R9,DEC0(R9)                  TO PARAMETER KEYWORD        34500018
         L     R7,XAR                        LOAD PTR TO BUFFER         35100013
         LA    R7,DEC0(R7)                  CONTAINING COMMAND          35400018
         LH    R6,DEC0(R7)                  LOAD BUFFER LENGTH          35700018
         N     R6,V00FF                   CLEAR POSSIBLE GARGAGE Y02669 36000002
         AR    R7,R6                         COMPUTE END OF BUFFER      36300013
         ST    R7,XAP                        SAVE IN FIRST WORD OF XSA  36600013
         L     R11,BALOG               LCA ADDRESS               Y02669 36650002
         USING LCABASE,R11                                       Y02669 36660002
         CLC   BALOG,VZEROS            IS LOG SUPPORTED          Y02669 36670002
         BE    LOGSTRT            IF NOT, CHECK  OPERAND 'START' Y02669 36750002
         CLI   XAN,LOGCOD              IS THIS THE 'LOG' VERB    Y02669 36970002
         BE    VERBLOG                       YES. GO TO LOG ROUTINE     37200013
         EJECT                                                          37500013
* W R I T E L O G       COMMAND PROCESSOR                               37800002
         SPACE                                                          38100013
         SPACE                                                          39900013
         CLC   DEC0(DEC5,R9),VSTART         PARAMETER = START    Y02669 39950002
         BE    LERR52                  YES, INVALID - LOG ACITVE Y02669 40000002
         CLC   DEC0(DEC5,R9),VCLOSE         PARAMETER = CLOSE           40200018
         BNE   VCLASS                       *                           40500018
         CLI   DEC5(R9),HEX40               DELIMITED BY BLANK          40800018
         BE    *+DEC10                           OR                     41100018
         LA    R6,DEC5(R9)                                       Y02669 41400002
         CR    R6,R7                                             Y02669 41700002
         BNE   VERR07              DELIMITER ERROR                      42000013
         TM    LCAPOSTT,POSTCLOZ            IS WRITELOG CLOSE PENDING   42080018
         BO    FINISH                       BRANCH IF YES               42170018
         B     HRDCOPY               CHECK LOG = HARDCOPY STATUS Y02669 42220002
VCLASS   EQU   *                                                        42900013
         C     R9,VZEROS                    WRITELOG COMMAND IS NOW     42960018
         BE    PENDINGG                     VALID WITHOUT A PARAMETER   43020018
*                                           DEFAULT CLASS FOR WRITELOG  43080018
*                                           COMMAND WILL BE USED        43140018
         CLI   DEC1(R9),BLANK               DELIMITED BY BLANK          43240018
         BE    *+DEC10                           OR                     43440018
         LA    R6,DEC1(R9)                  DELIMITED BY EOB     Y02669 43740002
         CR    R6,R7                                             Y02669 44100002
         BNE   VERR07              DELIMITER ERROR                      44400013
         CLI   DEC0(R9),CHARA               CHAR LT A                   44700018
         BL    LERR23              IF SO, NOT ALPHAMERRIC               45000013
         SR    R6,R6                                             Y02669 45300002
         IC    R6,DEC0(R9)                  GET CHAR AND USE     Y02669 45600002
         IC    R6,T(R6)           AS INDEX TO VMTAB              Y02669 45900002
         B     *+4(R6)                      *                    Y02669 46200002
         B     LERR23             NOT ALPHANUMERIC               Y02669 46500002
PENDINGG  EQU  *                                                        46510018
         TM    LCAPOSTT,POSTWLOG  IS A WRITELOG COMMAND          Y02669 46520002
*                                      PENDING                   Y02669 46530002
         BO    WRITEUP            BRANCH IF YES                  Y02669 46560002
         TM    LCAPOSTT,POSTCLOZ  IS A WRITELOG CLOSE COMMAND    Y02669 46680002
*                                      PENDING                   Y02669 46720002
         BO    FINISH             BRANCH IF YES                  Y02669 46770002
         STM   R5,R7,DEC64(R2)    SAVE REGS ACCROSS OIL MACRO    Y02669 46770402
         OIL   LCAPOSTT,POSTWLOG,WREGS=(5,6,7),REF=LCABASE       Y02669 46770802
         LM    R5,R7,DEC64(R2)       RESTORE REGS                Y02669 46771202
         C     R9,VZEROS                    IF NO CLASSNAME PROVIDED    46780018
         BE    DEFAULT                              WITH COMMAND        46790018
*                                           THEN THE DEFAULT CLASS      46800018
*                                           WILL BE USED                46810018
         MVC   LCCLASS(DEC1),DEC0(R9)       ALPHANUMERIC, STORE IN LCA  46840018
DEFAULT  EQU   *                                                        46870018
         B     POSTRTN                 SET UP POST OF LOG TASK   Y02669 47040002
         EJECT                                                          47050002
LOGSTRT  EQU   *                                                 Y02669 47090002
* LOG PTR IS ZERO - TEST IF VERB IS WRITELOG START . IF IT IS ,  Y02669 47140002
* PROCESS TO RE-ACTIVATE THE LOG FUNCTION .                      Y02669 47190002
* IF NOT , SET UP ERROR MSG FOR MODULE IGC0503D .                Y02669 47240002
         TM    MSECBFL,MSWTL       BUFFER RECOVERY?            @ZA07784 47250003
         BO    LERR26              YES, SET ERROR MSG          @ZA07784 47260003
         CLI   XAN,WRITLOG             WRITELOG CMND VERB CODE ? Y02669 47290002
         BNE   LERR26                  NO , SET ERROR MSG        Y02669 47340002
*                                      PROCESSING                Y02669 47350002
         CLC   DEC0(DEC5,R9),VSTART    OPERAND = START ?         Y02669 47390002
         BNE   LERR26                  NO , INVALID FOR INACTIVE Y02669 47440002
*                                      LOG                       Y02669 47450002
         CLI   DEC5(R9),HEX40          VALID DELIMITER ?         Y02669 47490002
         BE    POSTRTN                 YES, CONTINUE PROCESSING  Y02669 47540002
         LA    R6,DEC5(R9)             END OF OPERAND ADDRESS    Y02669 47590002
         CR    R6,R7                   EQUAL END OF BUFFER ?     Y02669 47640002
         BNE   VERR07                  NO , DELIMITER ERROR      Y02669 47690002
POSTRTN  EQU   *                                                 Y02669 47740002
*                                                                Y02669 47750002
* ENTRY IS TO SET UP AND ISSUE POSTS OF  LOG ECBS                Y02669 47790002
*                                                                Y02669 47840002
         LA    R4,XASAVLOC             RTN USES XSA SAVE AREA    Y02669 47850002
         USING POSTCORE,R4           ADDRESSIBILITY TO SAVE AREA Y02669 47860002
         MVC   POSTCORE(DEC12),POSTLIST  LIST FORM OF POST       Y02669 47890002
         L     R6,CVTPTR               CVT ADDR                  Y02669 47940002
         USING SETCVT,R6                                         Y02669 47990002
         LA    R1,CVTBRET              ADDR OF POST RETURN RTN   Y02669 48040002
         ST    R1,ERRAD                STORE IN POST LIST        Y02669 48090002
         CLC   DEC0(DEC5,R9),VSTART    START COMMAND ECB POST ?  Y02669 48240002
         BNE   CLOSELOG                NO , CHECK CLOSE          Y02669 48290002
         MVC   ASCBAD(DEC4),BAASCB     SET MASTER REGION ASCB    Y02669 48300002
         LA    R6,MSLGSTRT             START ECB ADDRESS         Y02669 48340002
         B     ISSUPOST                POST LOG TASK             Y02669 48390002
CLOSELOG EQU   *                                                 Y02669 48392002
         MVC   ASCBAD(DEC4),LCAASCB    SET LOG TASK ASCB         Y02669 48392402
         CLC   DEC0(DEC5,R9),VCLOSE    CLOSE COMMAND ECB POST ?  Y02669 48394002
         BNE   LOGSWTCH                NO , SWITCH LOG DATA SET  Y02669 48396002
*                                      ECB                       Y02669 48396402
         LA    R6,MSLGCLOZ             CLOSE ECB ADDRESS         Y02669 48398002
         STM   R5,R7,DEC64(R2)        SAVE REGS ACROSS OIL MACRO Y02669 48398202
         OIL   LCAPOSTT,POSTCLOZ,WREGS=(5,6,7),REF=LCABASE       Y02669 48398602
         LM    R5,R7,DEC64(R2)         RESTORE REGS              Y02669 48398702
         B     ISSUPOST                POST LOG TASK             Y02669 48399002
LOGSWTCH EQU   *                                                 Y02669 48399202
         LA    R6,MSLGWLOG             SWITCH ECB ADDRESS        Y02669 48399402
ISSUPOST EQU   *                                                 Y02669 48399702
         ST    R6,ECBAD                ECB ADDRESS TO LIST       Y02669 48399802
         LR    R1,R4                   PARM LIST REG FOR POST    Y02669 48400002
         POST  MF=(E,(1))                                        Y02669 48449902
         BR    R14                     RETURN                    Y02669 48469902
         EJECT                                                   Y02669 48471902
HRDCOPY  EQU   *                                                 Y02669 48479902
* ENTRY HERE IS TO VERIFY IF LOG = HARDCOPY . SET UP             Y02669 48489902
*       ADDRESSIBILITY                                           Y02669 48490302
* TO UCM PREFIX , CHECK UCM(UCMFLAGS(UCMSYSG)) = ON .            Y02669 48491902
* IF YES , SET UP FOR 'COMMAND REJECTED' WTO , BRANCH TO MSG     Y02669 48493902
*       PROCESSING                                               Y02669 48494302
* IF NO , BRANCH TO POST RTN TO TERMINATE LOG FUNCTION .         Y02669 48495902
         DROP  R6                                                Y02669 48496302
         USING SETCVT,R3               PTR TO CVT                Y02669 48497902
         L     R3,CVTPTR                                         Y02669 48498302
         L     R3,CVTCUCB              PTR TO UCM                Y02669 48498502
         USING UCM,R3                                            Y02669 48498602
         LR    R5,R3                   SET UP , CALCULATE        Y02669 48498702
         SH    R5,FOUR                   UCM PREFIX ADDRESS      Y02669 48523902
         L     R5,DEC0(R5)             PTR TO UCM PREFIX         Y02669 48573902
         USING UCMPRFX,R5                                        Y02669 48574302
         TM    UCMSFLGS,UCMSYSG        LOG = HARDCOPY ?          Y02669 48574402
         BZ    POSTRTN                NO, TERMINATE LOG FUNCTION YO2669 48574502
         B     REJECTIT                YES , ISSUE WTO IEE532I   Y02669 48574602
         EJECT                                                          48574702
VERBLOG   EQU  *                                                 Y02669 48600002
* VERB=LOG ROUTINE - SYNTAX CHECKS THE TEXT FOR THE LOG COMMAND, Y02669 48900002
*    MOVES ALL THE CHARACTERS BETWEEN THE QUOTES TO GOTTEN CORE,      * 49200013
*    AND WRITES TO LOG (WTL MACRO) FROM GOTTEN CORE. RETURN IS BR 14. * 49500013
*                                                                     * 49800013
         XC    XASAVLOC(DEC4),XASAVLOC      ZERO OUT SWITCH FIELDY02669 49850002
         C     R9,VZEROS                    IS PARAMETER POINTER ZERO   49900018
         BE    VERR11                       YES, PARAMETER IS MISSING   50000018
         CLI   DEC0(R9),QUOTE               IS FIRST CHARACTER A QROTE  50200018
         BNE   LERR19                        NO. QUOTE ERROR            50400013
         L     R0,SP                   WTL CORE SUBPOOL = 231    Y02669 50450002
         OR    R0,R6                   GETMAIN LENGTH            Y02669 50500002
         LR    R5,R0                   SAVE SP AND LENGTH OF     Y02669 50550002
*                                      GETMAIN                   Y02669 50600002
         GETMAIN R,LV=(0)              CORE FOR WTL              Y02669 50700002
         LR    R8,R1                         GOTTEN CORE STARTING PT.   51000013
         LA    R7,DEC4(R8)                  LEAVE ROOM OFR HEADER       51300018
LOGLOOP  LA    R9,DEC1(R9)                  UPDATE CHARACTER POINTER    51600018
         C     R9,XAP                        IS IT END OF BUFFER        51900013
         BC    10,TXTERR                     YES, PREMATURELY    Y02669 52200002
         CLI   0(R9),QUOTE                   IS THIS CHAR A QUOTE       52500013
         BE    LOGQUT                        YES. GO CHECK FOR FINAL QT 52800013
LOGMOV   MVC   0(1,R7),0(R9)                 NO. MOVE A VALID CHAR      53100013
         LA    R7,1(R7)                      UPDATE WTL BUFFER          53400013
         B     LOGLOOP                       GO CHECK NEXT CHARACTER    53700013
* QUOTE IS ENCOUNTERED, CHECK FOR FINAL QUOTE                         * 54000013
LOGQUT   LA    R9,1(R9)                      UPDATE CHARACTER POINTER   54300013
         C     R9,XAP                        IS IT END OF BUFFER        54600013
         BE    LOGOUT                        YES. TEXT IS COMPLETE      54900013
         CLI   0(R9),QUOTE                   IS THIS DOUBLE QUOTE       55200013
         BE    LOGMOV                        YES. MOVE ONE QUOTE        55500013
LOGOUT   SR    R7,R8                         COMPUTE LNGTH OF WTL BUFFR 55800013
         CH    R7,LOGFOR                     IS TEXT NULL               56100013
         BE    LOGFRE                        YES. DO NOT WTL            56400013
         SLL   R7,16                         STORE LENGTH IN BUFFER IN  56700013
         ST    R7,0(R8)                      PRESCRIBED MANNER          57000013
* W R I T E   T O   L O G.                                            * 57300013
         WTL   MF=(E,(R8))                   LOG MESSAGE                57600013
         EJECT                                                          57650002
LOGFRE   LR    R1,R8                         R1 POINTS TO WTL BUFFER    57900013
         LR    R0,R5                   SP AND LENGTH TO FREE     Y02669 57950002
         FREEMAIN R,LV=(0),A=(1)       WTL BUFFER CORE           Y02669 58200002
         TM    XASAVLOC,HIBIT          DELIMITER ERROR ?         Y02669 58250002
         BO    LERR19                  YES , SET ERROR MSG CODE  Y02669 58300002
         BR    R14                 RETURN                               58500013
TXTERR   EQU   *                                                 Y02669 58550002
         OI    XASAVLOC,HIBIT          SET DELIMITER ERROR FOR   Y02669 58600002
*                                      RETURN                    Y02669 58610002
         B     LOGFRE                  FREE WTL CORE             Y02669 58650002
         EJECT                                                          58800013
* THE FOLLOWING INSTRUCTIONS PASS A DESIGNATED ERROR CODE TO THE      * 59100013
*   ERROR SUBROUTINE, VULERR, IN REGISTER 6.                     Y02669 59400002
*                                                                     * 59700013
VERR07   BAL   R6,VULERR                     ERROR CODE = 7      Y02669 60000002
         DC    AL1(ERR7)                                                60300013
*                                                                     * 60600013
VERR11   BAL   R6,VULERR                     ERROR CODE =11      Y02669 60900002
         DC    AL1(ERR11)                                               61200013
*                                                                     * 61500013
LERR19   BAL   R6,VULERR                     MESG CODE =19       Y02669 61800002
         DC    AL1(ERR19)                                               62100013
*                                                                       62400013
LERR23   BAL   R6,VULERR                     MESG CODE =23       Y02669 62700002
         DC    AL1(ERR23)                                               63000013
*                                                                       63300013
LERR26   BAL   R6,VULERR                     MESG CODE =26       Y02669 63600002
         DC    AL1(ERR26)                                               63900013
*                                                                       63950002
LERR52   XC    XAV(DEC8),XAV           ZERO FIELD                Y02669 63960002
         MVC   XAV(DEC4),LOGWORD       SET COMMAND='LOG' FOR MSG Y02669 64000002
         BAL   R6,VULERR               MESG CODE = 52            Y02669 64050002
         DC    AL1(ERR52)                                        Y02669 64100002
         SPACE                                                          64200013
         SPACE                                                          64500013
* ERROR SUBROUTINE - RECEIVES, IN REGISTER 6, A POINTER TO A     Y02669 64800002
*   MESSAGE CODE WHICH IS PLACED IN THE XSA (XAE). CONTROL GOES  Y02669 65100002
*   TO THE MESSAGE ASSEMBLY MODULE, IEE0503D, VIA BRANCH         Y02669 65400002
*                                                                     * 65700013
VULERR   MVC   XAE(1),0(R6)           INSERT ERROR CODE          Y02669 66000002
         L     R15,VMSGMOD            ADDRESS OF MSG MODULE      Y02669 66100002
*                                     IGC0503D                   Y02669 66110002
         BR    R15                    PASS CONTROL TO MSG MODULE Y02669 66150002
REJECTIT EQU   *                                                 Y02669 66200002
         LA    R7,M2                                             Y02669 66250002
         B     TELLOP                                            Y02669 66300002
WRITEUP  EQU   *                                                        68108018
         LA    R7,M1                                             Y02669 68138002
         B     TELLOP                       *                           68168018
FINISH   EQU   *                                                        68236018
         LA    R7,M3                                             Y02669 68237002
TELLOP   EQU   *                            THIS SECTION WIRTES MSGS    68238018
         SR    R8,R8                                                    68239018
         IC    R8,MSGLENS-DEC1(R7)                               Y02669 68240002
         LA    R1,XASAVSTD            USE XSA SAVE AREA FOR MSG  Y02669 68242002
*                                     BUFFER                     Y02669 68244002
         SR    R15,R15                                                  68245018
         IC    R15,MSGLOC-DEC1(R7)        LOCATE MSG             Y02669 68246002
         LA    R6,MESSAGES(R15)                                  Y02669 68247002
         LA    R15,DEC3(R8)                 LENGTH FOR EXECUTE          68248018
         EX    R15,MOVEMSG                  MOVE MSG TO GOTTON CORE     68249018
         STH   R8,DEC0(R1)                                              68250018
         C     R7,FOX1                    IS THIS MSG1           Y02669 68251002
         BNE   NO                           BRANCH IF NOT               68252018
         C     R9,VZEROS                                                68253018
         BNE   PROVIDED                     *                           68254018
         MVC   DISP(DEC1,R1),MSLOGCLS  SYSGEN DEFAULT CLASSNAME  Y02669 68255002
         B     NO                      BYPASS NEXT INSTRUCTION   Y02669 68255402
PROVIDED EQU   *                                                        68256018
         MVC   DISP(DEC1,R1),LCCLASS                                    68257018
NO       EQU   *                                                        68258018
         XR    R0,R0                                                    68260018
         IC    R0,XAU                                                   68261018
         WTO   MF=(E,(1))                                        Y02669 68262002
         BR    R14                                                      68267018
MOVEMSG  MVC   DEC0(DEC0,R1),DEC0(R6)                            Y02669 68268002
M1       EQU   1                                                        68269018
M2       EQU   2                                                        68270018
M3       EQU   3                                                        68271018
MSGLENS  EQU   *                                                        68272018
         DC    AL1(MSG1END-MSG1-DEC4)  LENGTH OF MSG1            Y02669 68273002
         DC    AL1(MSG2END-MSG2-DEC4)  LENGTH OF MSG2            Y02669 68273402
         DC    AL1(MSG3END-MSG3-DEC4)  LENGTH OF MSG3            Y02669 68275002
MSGLOC   EQU   *                                                        68276018
         DC    AL1(MSG1-MESSAGES)           *                           68277018
         DC    AL1(MSG2-MESSAGES)           *                    Y02669 68277402
         DC    AL1(MSG3-MESSAGES)           *                           68279018
MESSAGES EQU   *                                                        68280018
MSG1     WTO   'IEE032I WRITELOG IS PENDING. CLASSNAME =  .',MF=L,     *68290018
               DESC=(5),MCSFLAG=(RESP,REG0)                             68316018
MSG1END  EQU   *                                                        68320018
MSG2     WTO   'IEE532I SYSTEM LOG DEFINED AS HARDCOPY-WRITELOG CLOSE C*68330002
               MND REJECTED',MF=L,DESC=(5),MCSFLAG=(RESP,REG0)          68332002
MSG2END  EQU   *                                                 Y02669 68334002
MSG3     WTO   'IEE033I HALT OR WRITELOG CLOSE COMMAND HAS BEEN ISSUED'*68340018
               ,MF=L,DESC=(5),MCSFLAG=(RESP,REG0)                       68348018
MSG3END  EQU   *                                                        68352018
         EJECT                                                          68400013
* CONSTANTS USED BY IEE1103D.                                         * 68700013
*                                                                     * 69000013
VZEROS   DS    0F                                                       69600013
         DC    F'0'                         *                           69900018
VMSGMOD  DC    V(IGC0503D)                                       Y02669 69950002
LOGWORD  DC    CL4'LOG '                                         Y02669 70000002
V00FF    DC    X'0000FFFF'                      *                Y02669 70800002
LOGFOR   DC    H'4'                          LOG TEXT LENGTH COMPARAND  71100013
FOUR     DC    H'4'                    UCM PREFIX OFFSET         Y02669 71150002
*                                                                     * 71400013
VMTAB    EQU   *                                                        71700013
         DC    X'00'     'C0'                                           72000013
         DC    9X'04'    A - I                                          72300013
         DC    7X'00'    'CA' - 'D0'                                    72600013
         DC    9X'04'    J - R                                          72900013
         DC    8X'00'    'DA' - 'E1'                                    73200013
         DC    8X'04'    S - Z                                          73500013
         DC    6X'00'    'EA' - 'EF'                                    73800013
         DC    10X'04'   0 - 9                                          74100013
         DC    6X'00'    'FA' - 'FF'                                    74400013
T        EQU   VMTAB-192                                                74700013
VCLOSE   DC    CL5'CLOSE'          WRITELOG PARAMETER                   75000013
VSTART   DC    CL5'START'              WRITELOG OPERAND          Y02669 75050002
         DS    0F                                                       75070018
SP       DC    AL1(231),AL3(0)              *                    Y02669 75140002
POSTLIST POST  ASCB=0,ERRET=0,MF=L                               Y02669 75190002
FOX1     DC    F'1'                         *                           75220018
PATCH    DS    CL52                    TEMP FIX AREA             Y02669 75270002
         EJECT                                                          75300013
POSTCORE DSECT                                                   Y02669 75350002
ECBAD    DS    F                                                 Y02669 75400002
ASCBAD   DS    F                                                 Y02669 75450002
ERRAD    DS    F                                                 Y02669 75500002
         EJECT                                                          75570002
SETXSA   DSECT                                                          75600013
         IEEXSA                                                         75900013
         EJECT                                                          76200013
SETCVT   DSECT                                                          76500013
         CVT                                                            76800013
         EJECT                                                          77100013
         IEEBASEA                                                       77400013
         EJECT                                                          77700013
         IEELCA                                                         78600013
         EJECT                                                          78700002
UCM      DSECT                                                          78710002
         IEECUCM                                                        78750002
         EJECT                                                          78800002
         IEFPTRS                                                        78850002
         END                                                            78900013
./  ADD  SSI=53010116,NAME=IEE2303D
         TITLE 'IEE2303D - SMF VARY RECORD HANDLER'                     00100003
* TITLE        SMF VARY RECORD HANDLER                                * 00200002
* * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * 00300002
* MODULE NAME      = IEE2303D                                           00400002
*    CSECT NAME    = IEE2303D                                           00500002
*                                                                       00600002
* LOAD MODULE NAME = IEE3603D                                           00700002
*                                                                       00800002
* DESCRIPTIVE NAME = SMF-VARY ONLINE AND CONSOLE RECORD HANDLER         00900002
*                                                                       01000002
* COPYRIGHT        = MISSING                                            01100002
*                                                                       01200002
* STATUS           = OS/VS/2 RELEASE 3                         @Z30LPTJ 01300003
*                                                                       01400002
* FUNCTION         = WRITE AN SMF RECORD FOR DEVICES VARIED TO THE      01500002
*                    ONLINE OR CONSOLE STATUS.                          01600002
*                                                                       01700002
* OPERATION        = ALL DEVICES SPECIFIED IN THE VARY COMMAND          01800002
*                    ARE CHECKED FOR VALIDITY.  THEN, IF AT LEAST       01900002
*                    ONE DEVICE IS VALID, A VARY RECORD, TYPE 9         02000002
*                    IS WRITTEN TO SYS1.MAN DATA SET.                   02100002
*                    AN SMF VARY IS FORMATTED THUSLY,                   02200002
*                       LL0009TTTTDDDDCCCCXXKYUU......KYHU              02300002
*                                           *            *              02400002
*                                           ** VARIABLE  *              02500002
*                       LL   -TWO BYTE LENGTH OF RECORD                 02600002
*                       9    -ONE BYTE RECORD TYPE                      02700002
*                       TTTT -FOUR BYTE TIME OF DAY (BINARY)            02800002
*                       DDDD -FOUR BYTE DAY OF YEAR (BINARY)            02900002
*                       CCC  -FOUR BYTE CPU ID                          03000002
*                       XX   -TWO BYTE LENGTH OF VARIABLE DATA FIELD    03100002
*                       KYHU -VARIABLE DATA FIELDS. THERE ARE AS        03200002
*                             MANY OF THESE FIELDS AS THERE ARE         03300002
*                             VALID DEVICES IN THE VARY COMMAND.        03400002
*                             K   -ONE BYTE DEVICE CHARACTERISTICS      03500002
*                             Y   -ONE BYTE UNIT TYPE                   03600002
*                             H   -ONE BYTE                             03700002
*                                      BITS 0-3, UNUSED                 03800002
*                                      BITS 4-7, CHANNEL ADDRESS        03900002
*                             U   -ONE BYTE UNIT ADDRESS                04000002
*                    THE LOGIC FLOW IS AS FOLLOWS:                      04100002
*                    ON ENTRY FROM IEE3303D, A 168 BYTE AREA   @ZA03202 04200003
*                    IS GOTTEN FOR THE SMF RECORD.  (THIS      @ZA03202 04250003
*                    NUMBER WAS CHOSEN ARBITRARILY.  THE LOGIC @ZA03202 04300003
*                    RECOGNIZES THIS AS SOON AS THIS AREA IS   @ZA03202 04350003
*                    FULL AND FIRST WRITES OUT THE SMF RECORD  @ZA03202 04400003
*                    AND REINITIALIZES THE AREA).              @ZA03202 04450003
*                                                                       04700002
*                    FIRST 20 BYTES ARE INITIALIZED AS FOLLOWS:         04800002
*                       'LL' FIELD IS INITIALIZED TO '20'               04900002
*                       'XX' FIELD IS INITIALIZED TO '00'               05000002
*                                                                       05100002
*                    THE PTR TO THE COMMAND IMAGE IS OBTAINED           05200002
*                    IN REG9                                            05300002
*                                                                       05400002
*                    IN CASE OF AN I-UNIT SPECIFICATION, FOLLOWING      05500002
*                    CHECKS ARE MADE:                                   05600002
*                       . CHARACTERS ',O-' SHOULD BE THERE WITH  THE    05700002
*                            I-UNIT SPECIFICATION.                      05800002
*                       . RIGHT PARENS IMMEDIATLY AFTER 'O-UNIT'        05900002
*                            SPECIFICATION SHOULD BE FOUND.             06000002
*                       . UCME SHOULD BE AVAILABLE FOR THE I-UNIT.      06100002
*                       . THIS UCME SHOULD HAVE INPUT CAPABILITY        06200002
*                            (UCMIF SHOULD BE 'ON')                     06300002
*                       . DEVICE AS POINTED TO BY THIS UCME SHOULD      06400002
*                            NOT BE ONLINE                              06500002
*                       . DEVICE AS POINTED TO BY THIS UCME SHOULE      06600002
*                            NOT BE UNDER TEST BY OLTEP.                06700002
*                       . THIS UCME SHOULD POINT TO A COMPOSITE         06800002
*                            CONSOLE UCME.                              06900002
*                       . THE 'UCBNAME' IN THE UCB AS POINTED TO BY     07000002
*                            THIS COMPOSITE CONSOLE UCME SHOULD BE      07100002
*                            SAME AS IN THE 'O-UNIT' SPECIFICATION.     07200002
*                    NOTE: IF ANY OF THE ABOVE CONDITIONS IS NOT MET,   07300002
*                            THIS UNIT SPECIFICATION IS IGNORED         07400002
*                       . A CHECK IS MADE IF SPACE TO PUT TWO ENTRIES   07500002
*                            IN THE SMF RECORD EXIST.  IT NOT, THE      07600002
*                            CURRENT SMF RECORD IS WRITTEN BY ISSUING   07700002
*                            AN SVC 83 .                                07800002
*                       . ENTRIES ARE MADE IN THE RECORD                07900002
*                       . REG9 IS UPDATED TO POINT TO THE NEXT UNIT     08000002
*                            SPECIFICATION.                             08100002
*                       . BRANCH IS TAKEN TO PROCESS                    08200002
*                            EITHER THE NEXT UNIT SPECIFICATION OR TO   08300002
*                            DETERMINE IF IT IS THE END OF THE PROCESS. 08400002
*                                                                       08500002
*                    IN CASE OF O-UNIT SPECIFICATION, THE FOLLOWING     08600002
*                    CHECKS ARE MADE:                                   08700002
*                       . THERE SHOULD BE A UCME PERTAINING TO THE      08800002
*                            O-UNIT                                     08900002
*                       . THIS UCME SHOULD HAVE 'OUTPUT ONLY'           09000002
*                            CAPABILITIES  (SPECIFIED  BY               09100002
*                            UCMDISPD SHOULD BE 'ON')                   09200002
*                       . THE UNIT SHOULD NOT BE 'ONLINE'               09300002
*                       . THE UNIT SHOULD NO BE UNDER TEST              09400002
*                            BY OLTEP                                   09500002
*                       . SEE IF SPACE FOR ONE ENTRY EXISTS IN THE      09600002
*                            168 BYTE BUFFER, IF NOT WRITE THE @ZA03202 09700003
*                            RECORD FIRST (ISSUE SVC 83).      @ZA03202 09750003
*                       . PUT AN ENTRY IN THE RECORD                    09900002
*                       . UPDATE REG9 TO POINT TO THE NEXT UNIT         10000002
*                       . BRANCH IS TAKEN TO PROCESS                    10100002
*                            EITHER NEXT  UNIT SPECIFICATION OR         10200002
*                            TO DETERMINE IF IT IS THE END OF THE       10300002
*                            PROCESSING.                                10400002
*                                                                       10500002
*                    IF IT IS NEITHER (I-UNIT,O-UNIT) COMBINATION NOR   10600002
*                    THE O-UNIT SPECIFICATION, THEN CONTROL PASSES TO   10700002
*                    THIS POINT, WHERE WE DETERMINE IF THE UNIT         10800002
*                    SPECIFICATION IF CAPABLE OF BOTH INPUT AND OUTPUT  10900002
*                    THE FOLLOWING CHECKS ARE MADE:                     11000002
*                       . THERE SHOULD BE A UCME FOR THE UNIT SPECIFIED 11100002
*                    NOTE: IF THE ABOVE IS NOT TRUE, THE UNIT IS        11200002
*                       PROCESSED AS IF IT WAS AN I/O UNIT AND NOT AS   11300002
*                       A SYSGENED CONSOLE UNIT.                        11400002
*                       . THE UCME SHOULD INDICATE BOTH INPUT AND       11500002
*                            OUTPUT CAPABILITY OF THE UNIT (UCMIF AND   11600002
*                            UCMOF SHOULD BE 'ON')                      11700002
*                       . THE UNIT SPECIFIED SHOULD NOT BE 'ONLINE'     11800002
*                       . THE UNIT SPECIFIED SHOULD NOT BE UNDER        11900002
*                            TEST BY OLTEP                              12000002
*                    NOTE: IF EITHER OF THE ABOVE IS NOT TRUE, THE      12100002
*                       UNIT SPECIFIED IS IGNORED.                      12200002
*                       . SPACE IS CHECKED IN THE SMF RECORD BUFFER     12300002
*                            FOR PUTTING ONE ENTRY. IF NOT AVAILABLE    12400002
*                            THE RECORD IS WRITTEN FIRST                12500002
*                       . BRANCH TO PROCESS EITHER NEXT                 12600002
*                            UNIT OR TO DETERMINE IF IT IS THE END OF   12700002
*                            THE PROCESSING.                            12800002
*                                                                       12900002
*                    CONTROL IS RECEIVED AT THIS POINT WHEN THE UNIT    13000002
*                    SPECIFIED IS TO BE VARIED ONLINE ONLY AND ANY      13100002
*                    UNIT WITH THE 'VARY CONSOLE' KEYWORD AT THIS       13200002
*                    POINT OF CONTROL IS TO BE IGNORED.                 13300002
*                    FOLLOWING CHECKS ARE MADE:                         13400002
*                       . IF THE COMMAND IS 'VARY CONSOLE' THE UNIT     13500002
*                            IS IGNORED.                                13600002
*                       . IF IT IS A 'VARY ONLINE' THE UNIT WILL BE     13700002
*                            PROCESSED                                  13800002
*                       . THE PTR TO THE UCBLIST IS OBTAINED FROM THE   13900002
*                            CVT.                                       14000002
*                       . THE PTR TO THE MAIN UCB PERTAINING TO THE     14100002
*                            UNIT SPECIFICATION IS OBTAINED.            14200002
*                       . THE UCB IS CHECKED TO SEE IF THE UNIT IS      14300002
*                            ALREADY ONLINE                             14400002
*                       . IN CASE IT IS MARKED ALREADY ONLINE, THE      14500002
*                            UNIT IS IGNORED.                           14600002
*                       . IN CASE IT IS UNDER TEST BY OLTEP, THE        14700002
*                            UNIT IS IGNORED.                           14800002
*                       . OTHERWISE SPACE IS CHECKED IN THE SMF         14900002
*                            RECORD TO PUT AN ENTRY .                   15000002
*                       . IF SPACE IS NOT AVAILABLE, FIRST THE RECORD   15100002
*                            IS WRITTEN AND THEN ANY ENTRY IS MADE.     15200002
*                       . WHEN THE COMMAND IS COMPLETE, AN EXIT IS      15300002
*                            MADE TO  IEE4203D                          15400002
*                            OR       IEE4403D                          15500002
*                            DEPENDING ON THE SWITCHES SET BY           15600002
*                            IEE3303D IN THE XSWITCH BYTE OF THE XSA.   15700002
*                                                                       15800002
* NOTES                                                                 15900002
*    DEPENDENCIES  = NONE                                               16000002
*    CHARACTER/CODE DEPENDENCIES                                        16100002
*                  = THIS MODULE CAN BE ASSEMBLED WITH ANY NEW          16200002
*                    CHARACTER/CODE SET.                                16300002
*                                                                       16400002
* RESTRICTIONS     = REG2 PTR TO THE DUMMY XSA ON INPUT AND OUTPUT      16500002
*     REGISTER CONVENTIONS                                              16600002
*                  = REGISTERS ARE DEFINED AT LABEL: DEFREG             16700002
*    PATCH LABEL   = PATCH                                              16800002
*                                                                       16900002
* MODULE TYPE      = CSECT                                              17000002
*    PROCESSOR     = ASSEMBLER                                          17100002
*    MODULE SIZE   = VS/2 = '43A'                              @ZA03202 17200003
*    ATTRIBUTES    = REENTRANT, REUSABLE, REFRESHABLE,PAGED LPA,        17300002
*                    ZERO PSW PROTECT KEY                               17400002
*                                                                       17500002
* ENTRY POINTS     = IEE2303D FROM IEE3303D                             17600002
*    PURPOSE       = TO WRITE AN SMF RECORD FOR VALID DEVICES VARIED    17700002
*                    TO THE ONLINE OR CONSOLE STATES.                   17800002
*    LINKAGE       = BRANCH                                             17900002
*    INPUT         = REG2 PTS TO THE DUMMY XSA                          18000002
*                       XSWITCH BYTE OF XSA CONTAINS SWITCHES TELLING   18100002
*                       WHICH MODULE TO GO NEXT (4403D OR 4203D)        18200002
*                     REG13 PTS TO THE SAVE AREA GOTTEN IN 3603D        18300002
*                     WORD 17 OF THE SAVE AREA HAVE THE PTR TO THE CSCB 18400002
*    REGISTERS SAVED= ALL                                               18500002
*    REGISTER USAGE = R1  RECORD PTR                                    18600002
*                     R2 = DUMMY XSA PTR                                18700002
*                     R3  SMCA REG / OR CVT PTR, LATER = UCME PTR OF    18800002
*                        COMPOSITE OF 0 IF NONE THERE                   18900002
*                     R4  EOB PTR                                       19000002
*                     R5  UCME REG                                      19100002
*                     R8  UNIT REG                                      19200002
*                     R9  UNIT PTR                                      19300002
*                     R10 UCB PTR                                       19400002
*                     R11 UCB PTR OF COMPOSITE OR 0 IF NOT COMP.        19500002
*                     R13 SAVE AREA PTR STORED IN THIS MODULE IN THE    19600002
*                        IN THE XAA+2 OF THE DUMMY XSA. REG13 IS THEN   19700002
*                        USED AS THE PAREN SWITCH.                      19800002
*    REGISTERS RESTORED                                                 19900002
*                  = ALL                                                20000002
*                                                                       20100002
* EXITS - NORMAL   = TO IEE4203D OR IEE4403D DEPENDING ON THE           20200002
*                    SWITCHES SET BY IEE3303D IN XSWITCH BYTE           20300002
*                    OF THE XSA. (VIA BRANCH)                           20400002
*                    EXIT TO 4203D FOR VARY ONLINE/CONSOLE.             20500002
*                    EXIT TO 4403D FOR VARY CONSOLE WHEN THE CMD IS     20600002
*                    FOLLOWED BY THE CONSOLE CMD SUBPARAMETERS          20700002
*    CONDITIONS    = EXIT IS TAKEN WHEN THE FULL COMMAND HAS            20800002
*                    BEEN CHECKED AND SMF RECORDS HAVE BEEN             20900002
*                    WRITTEN FOR ALL ELIGIBLE DEVICES.                  21000002
*    OUTPUT        = REG2 PTS TO THE DUMMY XSA                          21100002
*                  = REG1 HAS XAD SWITCHES AS PRESET BY 3303D FOR       21200002
*                    4203D (SEE PROLOGUE OF IEE3303D AND 4203D)         21300002
*                    REG13 PTS TO THE SAVE AREA GOTTEN IN 3303D         21400002
*    RETURN CODES  = NONE                                               21500002
*                                                                       21600002
* EXITS - ERROR    = NONE                                               21700002
*                                                                       21800002
* EXTERNAL REFERENCES                                                   21900002
*    ROUTINES      = IEE4203D                                           22000002
*                    IEE4403D                                           22100002
*    DATA AREAS    = SEE EXITS - OUTPUT DATA                            22200002
*                                                                       22300002
* CONTROL BLOCKS   = . DUMMY EXTENDED SAVE AREA (XSA)                   22400002
*                    . SYSTEM MANAGMENT FACILITIES CONTROL BLOCK (SMCA) 22500002
*                       FIELDS TESTED  - SMCAID                         22600002
*                       FIELDS UPDATED - NONE                           22700002
*                    . CVT                                              22800002
*                       FIELDS TESTED  - CVTCUCB                        22900002
*                                        CVTILK2                        23000002
*                                        CVTSMCA                        23100002
*                       FIELDS UPDATED - NONE                           23200002
*                    . UNIT CONTROL MODULE (UCM)                        23300002
*                       FIELDS TESTED  -                                23400002
*                       FIELDS UPDATED = NONE                           23500002
*                    . UNIT CONTROL BLOCK (UCB)                         23600002
*                       FIELDS TESTED  = UCBCHA                         23700002
*                                        UCBFL5-BIT= UCBNALOC           23800002
*                                        UCBNAME                        23900002
*                                        SRTESTAT-BIT= SRTEONLI         24000002
*                                        UCBTBYT3                       24100002
*                       FIELDS UPDATED = NONE                           24200002
*                                                                       24300002
* TABLES           = 168 BYTES GOTTEN FOR SMF RECORD           @ZA03202 24400003
*                                                                       24500002
* MACROS           = GETMAIN, FREEMAIN, SVC 83(SMFRECORD WTR),SVC 11    24600002
*                                                                       24700002
* MAPPING MACROS   = IEEXSA                                             24800002
*                    CVT                                                24900002
*                    IEECUCM                                            25000002
*                    IEFUCBOB                                           25100002
*                    IEESMCA                                            25200002
*    SERIALIZATION = THE MODULE EXECUTES UNDER ENQ FOR PROTECTION       25300002
*                    AGAINST ANOTHER VARY/UNLOAD,ALLOCATION AND         25400002
*                    OLTEP.                                             25500002
*                    THIS ENQ WAS ISSUED EARLIER IN IEE3603D AND A      25600002
*                    DEQ WILL NOT BE ISSUED HERE SINCE THERE ARE        25700002
*                    NO TERMINAL CONDITION EXITS FROM THIS MODULE.      25800002
*                    NO PROTECTION IS REQUIRED AGAINST COMM TASK        25900002
*                    AND THEREFORE NO LOCKS WILL BE GOTTEN IN THIS      26000002
*                    ROUTINE                                            26100002
*                                                                       26200002
* CHANGE LEVEL     = Y02669, Z30LPTJ, ZA03202                  @ZA03202 26300003
*                                                                       26400002
* CHANGE ACTIVITY  = N/A                                                26500002
*                                                                       26600002
* MESSAGES         = NONE                                               26700002
*                                                                       26800002
* ABEND CODES      = NONE                                               26900002
*                                                                       27000002
* PACKAGING        = IEE2303D WILL BE PART OF LOAD MODULE               27100002
*                       = IEE3603D                                      27200002
*                    THIS LOAD MODULE ALIASES ARE                       27300002
*                       = NONE                                          27400002
*                    THIS LOAD MODULE ENTRY POINTS ARE                  27500002
*                       = IEE3603D                                      27600002
*                    MODULE WILL RESIDE IN: LPALIB                      27700002
*                                                                       27800002
* SYSGEN           = SUPPLIED BY SECTIONS                               27900002
*                       LOAD MODULE NAME                                28000002
*                       PACKAGING                                       28100002
*                    THIS CSECT WILL BE INCLUDED AT SYSGEN FROM         28200002
*                    DLIB -AOSB3- BY MACRO -SGIEF441-                   28300002
*                                                                       28400002
* SYSTEM LIBRARIES = NONE                                               28500002
*                                                                       28600002
*********************************************************************** 28700002
         EJECT                                                          28800002
IEE2303D CSECT                                                          28850002
* C 343000,768000                                              @YM07237 28855002
* ENTRY (A)                                                    @ZA03202 28857003
 SPACE 3                                                                28860002
TWENTY   EQU   20                                                       28900002
ONESIXTY EQU   160                                                      29000002
ONESXTY5 EQU   165                     CONSTANT OF 165         @ZA03202 29030003
ONESXTY8 EQU   168                     CONSTANT OF 168         @ZA03202 29060003
ONEFORTY EQU   140                                               Y02669 29100002
RECTYP   EQU   5                       OFFSET FOR REC. TYPE             29200002
SMFON    EQU   9                       SMF RECORD TYPE                  29300002
VARLNTH  EQU   18                      OFFSET FOR VARIABLE LNTH SLOT    29500002
*                                                                       29600002
* R E G I S T E R   U S A G E                                           29700002
*                                                                       29800002
DEFREG   EQU   *                                                 Y02669 29900002
R0       EQU   0                                                        30000002
R1       EQU   1                       PTR TO START OF SMF RECORD       30100002
R2       EQU   2                       XSA PTR                          30200002
R3       EQU   3                       UCME OF COMPOSITE OF 0 IF NONE   30300002
R4       EQU   4                       EOB PTR                          30400002
R5       EQU   5             WORKING REG(INITIALISING HEADER RECORD),   30500002
*                            UCME PTR(DURING UCME SEARCH)               30600002
R6       EQU   6                                                        30700002
R7       EQU   7                                                        30800002
R8       EQU   8                       TEMP UNIT PTR                    30900002
R9       EQU   9                       UNIT PTR                         31000002
R10      EQU   10                      UCB PTR                          31100002
R11      EQU   11                      UCB PTR OF COMP. OR 0 IF NONE    31200002
R12      EQU   12                      MODULE BASE REG                  31300002
R13      EQU   13                      SAVE AREA PTR ON INPUT           31400002
*                        SAVE AREA PTR IS STORED IN XAD AND REG  Y02669 31500002
*                        USED AS NUMBER OF PARENS SWITCH         Y02669 31600002
R14      EQU   14                      VARIABLE DATA FIELD REG          31700002
R15      EQU   15                                                       31800002
DEC0     EQU   0                                                        31900002
DEC1     EQU   1                                                        32000002
DEC2     EQU   2                                                        32100002
DEC3     EQU   3                                                        32200002
DEC4     EQU   4                                                        32300002
DEC5     EQU   5                                                        32400002
DEC6     EQU   6                                                        32500002
DEC8     EQU   8                                                        32600002
DEC9     EQU   9                                                        32700002
DEC12    EQU   12                                                 M2935 32800002
DEC13    EQU   13                                                       32900002
DEC20    EQU   20                                                       33000002
*                                                                       33200002
LPAREN   EQU   C'('                                                     33300002
COMMA    EQU   C','                                                     33400002
RPAREN   EQU   C')'                                                     33500002
COMP     EQU   X'80'                                                    33600002
OUNITBT  EQU   X'40'                                                    33700002
XZERO    EQU   X'00'                                                    33800002
REGUNT   EQU   X'20'                                                    33900002
NRECI    EQU   X'08'                                                    34000002
NRECO    EQU   X'04'                                                    34100002
HEX0F    EQU   X'0F'                                           @YM07237 34300002
VUNIT    EQU   X'80'                   HIGH ORDER BIT MASK     @Z30LPTJ 34350003
XC1      EQU   X'C1'                   COMPRAND FOR 'A'        @ZA03202 34360003
XC6      EQU   X'C6'                   COMPRAND FOR 'F'        @ZA03202 34370003
*                                                                       34400002
         EJECT                                                          34500002
         BALR  R12,0                   ESTABLISH ADDRESSABILITY         34700002
         USING *,R12                                                    34800002
         MODID BR=YES                                            Y01886 34900002
         USING XSA,R2                                                   35000002
         STM   R0,R15,DEC0(R13)                                  Y02669 35100002
         ST    R13,XAK                 STORE SAVE AREA ADDRESS @Z30LPTJ 35200003
         L     R3,CVTPTR               OBTAIN CVTPTR TO SEE IF          35300002
         USING SETCVT,R3                                                35400002
         L     R3,CVTSMCA              CVTSMCA FIELD WILL BE ZEROS IF   35500002
         USING SMCABASE,R3                                              35600002
*                                                                       35700002
*                                                                       35800002
*                                                                       35900002
         LA    R0,ONESXTY8             OBTAIN 168 BYTE CORE    @ZA03202 36000003
*                                 FROM SUBPOOL 0 OF VARY'S REGIONY02669 36200002
         GETMAIN R,LV=(0)                                               36300002
         XC    DEC0(ONESXTY8,R1),DEC0(R1) CLEAR HEADER AREA    @ZA03202 36400003
         MVI   RECTYP(R1),SMFON        MOVE IN THE RECORD TYPE          36500002
         MVI   DEC1(R1),TWENTY         MOVE IN TOTAL LENTH '20'         36600002
*                                      THIS LENGTH WILL BE              36700002
*                                      UPDATED AS AND WHEN VAR.         36800002
*                                      DATA RECORDS ARE ADDED   )       36900002
         MVC   VARLNTH(DEC2,R1),TWOCON    MOVE IN '2' AS VAR LNTH       37800002
         USING UCBOB,R10                                                37900002
         L     R9,XAL                  OBTAIN PTR TO PARAMETER LIST     38000002
         DROP  R3                                                       38100002
         LA    R9,DEC0(R9)             OBTAIN PTR TO COMMAND            38200002
         L     R4,XAR                                                   38300002
         AR    R4,R9              COMPUTE END OF BUFFER INTO REG4Y02669 38400002
         LA    R14,DEC20(R1)           REG 14 POINTS TO THE BEGINNING   38500002
*                                      OF THE VARIABLE DATA FIELD)      38600002
         SR    R13,R13                 IT WILL CONTAIN THE NUMBR        38700002
*                                      OF LEFT PARENS                   38800002
         XC    XAP(DEC4),XAP       ZERO OUT SWITCH AREA                 38900002
*                                                                       39000002
         EJECT                                                          39100002
START    EQU   *                                                 Y02669 39200002
         CLC   DEC0(DEC3,R9),CON  IS IT THE CONSOLE KEYWORD      Y02669 39300002
         BE    SEXIT              YES, FINISHED                  Y02669 39400002
         CLC   DEC0(DEC3,R9),ONL  IS IT THE ONLINE KEYWORD       Y02669 39500002
         BE    SEXIT              YES, FINISHED                  Y02669 39600002
SPRNCK   EQU   *                                                 Y02669 39700002
         CLI   DEC0(R9),LPAREN    IS THERE AN EXTERIOR PAREN     Y02669 39800002
         BNE   SINGLE             NO SINGLE UNIT SPECIFIED       Y02669 39900002
         CLC   DEC0(DEC3,R9),PARENI    IS IT A COP  SPECIFICATIONY02669 40000002
         BE    SCOMP              YES, GO PROCESS A COMPOSITE UNIY02669 40100002
         AH    R13,HONE           SET EXTERIOR PAREN SWITCH      Y02669 40200002
         LA    R9,DEC1(R9)        UPDATE PAST THE PAREN          Y02669 40300002
         CR    R9,R4              IS IT END OF BUFFER            Y02669 40400002
         BE    SEXIT              YES, FINISHED                  Y02669 40500002
         B     SPRNCK             NO, CHECK MORE FOR A UNIT      Y02669 40600002
*                                                                Y02669 40700002
SINGLE   EQU   *                                                 Y02669 40800002
         CLC   DEC0(DEC2,R9),OUNIT     IS A SINGLE OUTPUT-ONLY UNY02669 40900002
         BE    SOUNIT             YES, GO PROCESS OUTPUT-ONLY UNIY02669 41000002
         CLI   DEC3(R9),COMMA     NO, IS IT A XXX, REGULAR UNIT  Y02669 41100002
         BE    REGUNIT            YES, GO PROCESS REGULAR UNIT   Y02669 41200002
         CLI   DEC3(R9),RPAREN    MAYBE IT IS A XXX)             Y02669 41300002
         BE    REGUNIT            YES, GO PROCESS REGULAR UNIT   Y02669 41400002
*                                                                Y02669 41500002
* NOTHING RECOGNIZABLE, SCAN TO MEAREST COMMA OF EOB             Y02669 41600002
*                                                                Y02669 41700002
ENDSCAN  EQU   *                                                 Y02669 41800002
         CLI   DEC0(R9),COMMA                                    Y02669 41900002
         BE    SOMEMORE           YES,MAYBE MORE UNITS PRESENT   Y02669 42000002
ENDSCAN2 EQU   *                                                 Y02669 42100002
         CR    R9,R4              IS IT END OF BUFFER            Y02669 42200002
         BE    SEXIT              YES, FINISHED                  Y02669 42300002
         LA    R9,DEC1(R9)        NO, UPDATE PTR BY ONE          Y02669 42400002
         CLI   DEC0(R9),COMMA     SCAN TO NEARES COMMA           Y02669 42500002
         BNE   ENDSCAN2           NO COMMA YET, KEEP CHECKING    Y02669 42600002
SOMEMORE EQU   *                                                 Y02669 42700002
         LA    R9,DEC1(R9)        UP BY ONE TO PT TO NEXT UNT    Y02669 42800002
         LTR   R13,R13            FOUND ',' MULTIPL UNTS?        Y02669 42900002
*                                 IF NO MULT UNITS WERE PRESENT  Y02669 43000002
*                                 THEN REACHING A COMMA WITHOUT  Y02669 43100002
*                                 UNIT IS AN ERROR               Y02669 43200002
         BZ    SEXIT              AND WERE ARE FINISHED          Y02669 43300002
*                                 WE DID HAVE MULT UNITS, THERE- Y02669 43400002
*                                 FORE THERE ARE MORE THAN ONE UNY02669 43500002
*                                 AND JUST THIS ONE IS IN ERROR. Y02669 43600002
         B     START              GO FIND A NEW UNIT TO PROCESS  Y02669 43700002
*                                                                Y02669 43800002
         EJECT                                                          43900002
SCOMP    EQU   *                                                 Y02669 44000002
*                                                                Y02669 44100002
*  PROCESSING A COMPOSITE UNIT    (I-XXX,O-XXX)                  Y02669 44200002
*                                                                Y02669 44300002
         CLC   DEC6(DEC3,R9),CMAO      IS IT (I-XXX,O-           Y02669 44400002
         BNE   ENDSCAN            NO ERROR IN COMPOSITE SPECIF   Y02669 44500002
         CLI   DEC12(R9),RPAREN   IS IT (I-XXX,O-XXX)            Y02669 44600002
         BNE   ENDSCAN            NO,ERROR IN COMPOSITE SPECIFI  Y02669 44700002
         OI    XAP+DEC0,COMP      SET 'COMPOSITE SWITCH'         Y02669 44800002
         LA    R8,DEC3(R9)        INDEX TO POINT TO INPUT UNTNME Y02669 44900002
         BAL   R15,SEARCH         GO GET UCME                    Y02669 45000002
         LTR   R5,R5              IF R5 (UCME PTR)IS 0 = NO UCME Y02669 45100002
         BNZ   GOTUCME            OK, WE HAVE AN INPUT UNIT UCME Y02669 45200002
BADCOMP  EQU   *                                                 Y02669 45300002
         LA    R9,DEC13(R9)       INDEX PAST UNIT                Y02669 45400002
         MVI   XAP+DEC0,XZERO     CLEAR 'COMPOSITE SWITHC'       Y02669 45500002
         B     ENDSCAN            GO FIND NEXT UNIT IS ANY       Y02669 45600002
         USING UCMLIST,R5                                        Y02669 45700002
GOTUCME  EQU   *                                                 Y02669 45800002
         TM    UCMATR,UCMIF       IS IT REALLY AN INPUT DEV.     Y02669 45900002
         BZ    BADCOMP            NO ERROR IN COMP. SPECIFIED    Y02669 46000002
         L     R3,UCMCOMPC        GET PTR TO UCME OF COMPOSITE   Y02669 46100002
         LTR   R3,R3              ANY COMPOSITE, SHOULD BE       Y02669 46200002
         BZ    BADCOMP            NO, ERROR IN COMP. SPECIFIED   Y02669 46300002
         DROP  R10                                               Y02669 46400002
         USING UCBOB,R11                                         Y02669 46500002
         DROP  R5                                                Y02669 46600002
         USING UCMLIST,R3                                        Y02669 46700002
         L     R11,UCMUCB         GET UCB PTR TO THE COMPOSITE   Y02669 46800002
         CLC   DEC9(DEC3,R9),UCBNAME   DO THE UNITNAMES MATCH    Y02669 46900002
         BNE   BADCOMP            NO, ERROR IN COMP SPECIFIED    Y02669 47000002
         DROP  R11                                               Y02669 47100002
         USING UCBOB,R10                                         Y02669 47200002
         DROP  R3                                                Y02669 47300002
         USING UCMLIST,R5                                        Y02669 47400002
*                                                                Y02669 47500002
*        R9 PTS TO THE BEGINNING OF UNIT OPERAND (I-XXX,O-XXX)   Y02669 47600002
*        R8 PTS TO THE INPUT UNITNAME                            Y02669 47700002
*        R10 HAS PTR TO INPUT UNIT UCB                           Y02669 47800002
*        R11 HAS PTR TO OUTPUT UNIT UCB                          Y02669 47900002
*        R5 HAS PTR TO INPUT UNIT UCME                           Y02669 48000002
*        R3 HAS PTR TO OUTPUT UNIT UCME                          Y02669 48100002
*                                                                Y02669 48200002
*  MUST CHECK VIA BOTH UCBS IF ANY OR BOTH DEVICES ARE ONLINE OR Y02669 48300002
*  UNDER TEST BY OLTEP.                                          Y02669 48400002
*  IF ANY OR BOTH ARE SO, ITS AN ERR AND NO RECD WILL BE PUT OUT Y02669 48500002
*                                                                Y02669 48600002
         BAL   R6,CHECKUCB        GO CHECK UCB'S                 Y02669 48700002
         LTR   R15,R15          IS INPT OFFL AND NOT UNDER OLTP  Y02669 48800002
         BNZ   CHECKERI           SOMETHING IS WRONG             Y02669 48900002
CHECKONT EQU   *                                                 Y02669 49000002
         BAL   R6,COMPUCB         I- IS OK, GO CHECK OUTPUT UNIT Y02669 49100002
         LTR   R15,R15          IS OUTPT OFFL AND NOT UNDER OLTP Y02669 49200002
         BNZ   CHECKERO           SOMETHING IS WRONG             Y02669 49300002
RECCOMP  EQU   *                                                 Y02669 49400002
         LA    R9,DEC13(R9)       UPDATE PAST COMP.              Y02669 49500002
         B     COMPSPAC          GO PUT RECORDS SINCE ALL IS OK  Y02669 49600002
*                                                                Y02669 49700002
CHECKERI EQU   *                                                 Y02669 49800002
         C     R15,EIGHT          IS I-UNIT ONLINE               Y02669 49900002
         BNE   BADCOMP            NO, IT IS UNDER TEST BY OLTEP  Y02669 50000002
*                                 MUST OMIT PUTTING RECORD FOR   Y02669 50100002
*                                 THE WHOLE COMPOSITE UNIT       Y02669 50200002
         OI    XAP+DEC0,NRECI     INPUT IS ONLINE, SET FLAG      Y02669 50300002
*                             NOT TO PRINT RECORD FOR INPUT BUT  Y02669 50400002
*                              CHECK OUTPUT SINCE IT MAY BE OFFL Y02669 50500002
         B     CHECKONT           GO CHECK OUTPUT                Y02669 50600002
*                                                                Y02669 50700002
CHECKERO EQU   *                                                 Y02669 50800002
         C     R15,EIGHT          IS O-UNIT ONLINE               Y02669 50900002
         BNE   BADCOMP            NO, IT IS UNDER TEST BY OLTEP  Y02669 51000002
*                                 MUST OMIT PUTTING RECORD FOR   Y02669 51100002
*                                 WHOLE COMPOSITE UNIT           Y02669 51200002
         OI    XAP+DEC0,NRECO     SET 'NOREC FOR OUPUT UNT SWTCH'Y02669 51300002
         B     RECCOMP            GO ISSUE RECORD FOR INPUT MAYBEY02669 51400002
*                                                                Y02669 51500002
         EJECT                                                          51600002
SOUNIT   EQU   *                                                 Y02669 51700002
*                                                                Y02669 51800002
*  PROCESSING OUTPUT ONLY UNIT  O-XXX                            Y02669 51900002
*                                                                Y02669 52000002
         OI    XAP+DEC0,OUNITBT   SET OUTPUT-ONLY SWITCH         Y02669 52100002
         LA    R8,DEC2(R9)        UPDATE TO UNIT NAME            Y02669 52200002
         BAL   R15,SEARCH         GO GET UCME                    Y02669 52300002
         LTR   R5,R5              IS THERE A UCME                Y02669 52400002
         BNZ   GOTUCME2           YEP                            Y02669 52500002
BADOUNT  EQU   *                                                 Y02669 52600002
         LA    R9,DEC5(R9)        NO UCME, ERROR UPDATE PAST UNITY02669 52700002
         MVI   XAP+DEC0,XZERO     CLEAR OUTPUT-ONLY SWITCH       Y02669 52800002
         B     ENDSCAN            GO GET NEW UNIT, IF ANY        Y02669 52900002
*                                                                Y02669 53000002
GOTUCME2 EQU   *                                                 Y02669 53100002
         TM    UCMDISP,UCMDISPD   IS IT REALLY AN OUTPUT-ONLY UNTY02669 53200002
         BZ    BADOUNT            NO, BAD OUTPUT-ONLY SPECIFIED  Y02669 53300002
         SR    R11,R11            NO UCB FOR COMPORITE           Y02669 53400002
         SR    R3,R3              NO UCME FOR COMPOSITE          Y02669 53500002
*                                                                Y02669 53600002
*        R9 PTS TO THE UNIT SPECIFICATION   O-XXX                Y02669 53700002
*        R8 PTS TO THE UNIT NAME                                 Y02669 53800002
*        R10 HAS UCB PTR FOR UNIT                                Y02669 53900002
*        R11 = 0 NO COMPOSITE UCB PTR                            Y02669 54000002
*        R5 HAS PTR TO UNIT'S UCME                               Y02669 54100002
*        R3 = 0 NO COMPOSITE UCME PTR                            Y02669 54200002
*                                                                Y02669 54300002
*  MUST CHECK VIA UCB IF DEVICE IS ONLINE OR UNDER TEST BY OLTEP Y02669 54400002
*  EITHER OF BOTH ARE ERRORS, AND NO RECORD CAN BE WRITTEN       Y02669 54500002
*                                                                Y02669 54600002
         BAL   R6,CHECKUCB        GO CHECK UCB                   Y02669 54700002
         LTR   R15,R15         WAS UNT OFFL AND NOT UNDER OLTEP  Y02669 54800002
         BNZ   BADOUNT            NO, NO RECORD ISSUED           Y02669 54900002
         LA    R9,DEC5(R9)        INDEX PAST UNIT                Y02669 55000002
         B     SEESPACE           GO PUT RECORD                  Y02669 55100002
*                                                                Y02669 55200002
         EJECT                                                          55300002
REGUNIT  EQU   *                                                 Y02669 55400002
*                                                                Y02669 55500002
*  PROCESSING REGULAR 3 CHARACTER UNIT  XXX                      Y02669 55600002
*                                                                Y02669 55700002
         OI    XAP+DEC0,REGUNT    SET 'REG-UNIT SWITCH'          Y02669 55800002
         LR    R8,R9              SET REG8 TO THE UNITNAME       Y02669 55900002
         BAL   R15,SEARCH         GET UCME, IF ANY               Y02669 56000002
         LTR   R5,R5              ANY UCME                       Y02669 56100002
         BZ    IOUNIT             NO, THIS IS A REGULAR I/O UNT  Y02669 56200002
         TM    UCMATR,UCMOF+UCMIF HAS UCME, DOES IT HAVE INPUT   Y02669 56300002
*                                 OUTPUT CAPABILITIES            Y02669 56400002
         BC    DEC12,BADREG       NO, ERROR IN REG. UNIT         Y02669 56500002
         SR    R11,R11            NO COMPOSITE UCB PTR           Y02669 56600002
         SR    R3,R3              NO COMPOSITE UCME PTR          Y02669 56700002
*                                                                Y02669 56800002
*        R8 = R9 PTR TO UNIT NAME                                Y02669 56900002
*        R10 HAS PTR TO UNIT'S UCB                               Y02669 57000002
*        R11 = 0 NO COMPOSITE PTR                                Y02669 57100002
*        R5 HAS PTR TO UNIT'S UCME                               Y02669 57200002
*        R3 = 0 NO COMPOSITE UCME                                Y02669 57300002
*                                                                Y02669 57400002
*  MUST CHECK VIA UCB IF DEVICE IS ONLINE OF UNDER TEST BY OLTEP Y02669 57500002
*  EITHER OR BOTH ARE ERRORS, AND NO RECORD CAN BE PRINTED       Y02669 57600002
*                                                                Y02669 57700002
         BAL   R6,CHECKUCB        GO CHECK UCB                   Y02669 57800002
CODECHK  EQU   *                                                 Y02669 57900002
         LTR   R15,R15            UNIT OFFL AND NOT UNDER OLTEP  Y02669 58000002
         BNZ   BADREG             NO, NO RECORD PRINTED          Y02669 58100002
         LA    R9,DEC3(R9)        INDEX PAST UNIT                Y02669 58200002
         B     SEESPACE           GO PUT RECORD FOR UNIT         Y02669 58300002
*                                                                Y02669 58400002
BADREG   EQU   *                                                 Y02669 58500002
         LA    R9,DEC3(R9)        INDEX PAST UNIT                Y02669 58600002
         MVI   XAP+DEC0,XZERO     CLEAR 'REG-UNIT SWITCH'        Y02669 58700002
         B     ENDSCAN            GO FIND ANOTHER UNIT           Y02669 58800002
*                                                                Y02669 58900002
         EJECT                                                          59000002
IOUNIT   EQU   *                                                 Y02669 59100002
*                                                                Y02669 59200002
* PROCESSING REG UNIT WHICH IS I/O ONLY (NO CONSOLE CAPABILITIES)Y02669 59300002
*                                                                Y02669 59400002
         TM    XASOPCOD,XAON      IS IT AN ONLINE KEYWORD?     @Z30LPTJ 59500003
         BZ    BADREG             NO, NO CONSL KEY ALLOWED HERE  Y02669 59600002
         DROP  R5                                                Y02669 59700002
         USING SETCVT,R5                                         Y02669 59800002
         L     R5,CVTPTR          CVT PTR                        Y02669 59900002
         L     R5,CVTILK2         UCB LOOK-UP TABLE              Y02669 60000002
         DROP  R5                                                Y02669 60100002
VULOOK   EQU   *                                                 Y02669 60200002
         LH    R10,DEC0(R5)       OBTAIN UCB PTR                 Y02669 60300002
         LTR   R10,R10            ANY                            Y02669 60400002
         BZ    VBUMP              TAKE BRANCH TO TEST THE NEXT   Y02669 60500002
         LH    R6,VFFFF           CHECK END OF UCBLIST           Y02669 60600002
         CLR   R6,R10             COMPARING THE FFFF'S           Y02669 60700002
         BE    BADREG             NO UCB FOUND, ERROR            Y02669 60800002
         N     R10,VFFFF-DEC2     ZERO OUT HIGH ORDER BITS       Y02669 60900002
         CLC   UCBNAME(DEC3),DEC0(R9)  DOES THE UNITNAMES MATCH  Y02669 61000002
         BE    GOTUCB            YES, FOUND THE UCB              Y02669 61100002
VBUMP    EQU   *                                                 Y02669 61200002
         LA    R5,DEC2(R5)        UPDATE UCBLIST PTR             Y02669 61300002
         B     VULOOK             CHECK NEXT UCB                 Y02669 61400002
*                                                                Y02669 61500002
*                                                                Y02669 61600002
GOTUCB   EQU   *                                                 Y02669 61700002
         SR    R11,R11            NO COMPOSITE UCB PTR           Y02669 61800002
*                                                                Y02669 61900002
*        R8 = R9 PTR TO THE UNITNAME                             Y02669 62000002
*        R11 = 0 NO COMPOSITE UCB PTR                            Y02669 62100002
*        R10 UCB PTR OF UNIT                                     Y02669 62200002
*        R5 = R3 = 0 NO UNITS OR NO COMPOSITES UCME              Y02669 62300002
*                                                                Y02669 62400002
         SR    R5,R5                                             Y02669 62500002
         SR    R3,R3                                             Y02669 62600002
*                                                                Y02669 62700002
*  MUST CHECK VIA UCB IF DEVICE IS ONLINE OF UNDER TEST BY OLTEP Y02669 62800002
*  EITHER OR BOTH ARE ERRORS AND NO RECORD CAN BE WRITTEN        Y02669 62900002
*                                                                Y02669 63000002
         BAL   R6,CHECKUCB        GO CHECK UCB                   Y02669 63100002
         B     CODECHK            AND CHECK RESULTS              Y02669 63200002
*                                                                Y02669 63300002
         EJECT                                                          63400002
CHECKUCB EQU   *                                                 Y02669 63500002
*                                                                Y02669 63600002
*  THIS SUBROUTINE WILL CHECK VIA THE UCB POINTED BY REG10,      Y02669 63700002
*  IF THE DEVICE IS ONLINE/OFFLINE AND IF THE DEVICE IS          Y02669 63800002
*  UNDER TEST UNDER OLTEP.                                       Y02669 63900002
*  IF THE DEVICE IS ONLINE, NO RECORD SHOULD BE WRITTEN AND THIS Y02669 64000002
*  SUBROUTINE RETURNS A RETURN CODE OF : 8                       Y02669 64100002
*  IF THE DEVICE IS UNDER TEST BY OLTEP, THEN AGAIN NO RECORD    Y02669 64200002
*  SHOULD BE WRITTEN AND THIS SUBROUTINE RETURNS A RETCODE OF :4 Y02669 64300002
*                                                                Y02669 64400002
*  ON ENTRY THE FOLLOWING INPUTS ARE EXPECTED                    Y02669 64500002
*        R8 PTS TO THE UNITNAME                                  Y02669 64600002
*        R10 PTS TO THE UCB OF THE UNIT                          Y02669 64700002
*                                                                Y02669 64800002
         LA    R15,DEC4           PRESET FOR AN OLTEP ERROR      Y02669 64900002
         TM    UCBFL5,UCBNALOC    DEVICE IS UNDER OLTEP          Y02669 65000002
         BO    RET                YES, ERROR, NO RECORD          Y02669 65100002
         LA    R15,DEC8           PRESET FOR ONLINE ERROR        Y02669 65200002
         TM    SRTESTAT,SRTEONLI  IS DEVICE ONLINE               Y02669 65300002
         BO    RET                YES, ERROR, NO RECORD          Y02669 65400002
         SR    R15,R15            ALL OK, CODE IS 0 ON RETURN    Y02669 65500002
RET      EQU   *                                                 Y02669 65600002
         BR    R6                 RETURN TO CALLER               Y02669 65700002
*                                                                Y02669 65800002
COMPUCB  EQU   *                                                 Y02669 65900002
*                                                                Y02669 66000002
*  THIS SUBROUTINE WILL CHECK SAME AS THE 'CHECKUCB' BUT IT WILL Y02669 66100002
*  PERFORM THIS FUNCTION FOR THE OUTPUT UNIT OF A COMPOSITE UNIT Y02669 66200002
*                                                                Y02669 66300002
*        R8 PTS TO THE UNITNAME                                  Y02669 66400002
*        R11 PTS TO THE UCB OF THE OUTPUT UNIT OF THE COMPOSITE  Y02669 66500002
*                                                                Y02669 66600002
         DROP  R10                                               Y02669 66700002
         USING UCBOB,R11                                         Y02669 66800002
         LA    R15,DEC8           PRESET FOR THE ONLINE ERROR    Y02669 66900002
         TM    SRTESTAT,SRTEONLI  IS UNIT ONLINE                 Y02669 67000002
         BO    RET                RETURN, ERROR                  Y02669 67100002
         LA    R15,DEC4           PRESET FOR OLTEP ERROR         Y02669 67200002
         TM    UCBFL5,UCBNALOC    IS COMP UNDER TEST BY OLTEP    Y02669 67300002
         BO    RET                YES, ERROR NO RECORD           Y02669 67400002
         SR    R15,R15            ALL IS OK, RETURN CODE = 0     Y02669 67500002
         BR    R6                 RETURN TO CALLER               Y02669 67600002
         DROP  R11                                               Y02669 67700002
         USING UCBOB,R10                                         Y02669 67800002
*                                                                Y02669 67900002
         EJECT                                                          68000002
SEESPACE EQU   *                                                 Y02669 68100002
*                                                                Y02669 68200002
*  THIS SUBROUTINE WILL CHECK IF ENOUGH SPACE IS AVAILABLE IN THEY02669 68300002
*  SMF RECORD BUFFER TO INSERT ONE MORE RECD (FOR A SINGLE DEV)  Y02669 68400002
*  (HANDLED UNDER SEESPACE), OR FOR TWO DEVICES IF THE UNIT IS A Y02669 68500002
*  COMPOSITE DEVICE (HANDLED UNDER COMPSPACE).                   Y02669 68600002
*  IF THERE IS ENOUGH SPACE, THEN THE RECORD IS INSERTED, PTRS   Y02669 68700002
*  ARE UPDATED AND WE RETURN TO SEE IF MORE UNITS ARE TO BE      Y02669 68800002
*  PROCESSED.                                                    Y02669 68900002
*  IF NO SPACE IS AVAILABLE, THEN WE WRITE THIS RECORD FIRST, ANDY02669 69000002
*  THEN WE UPDATED A BRANK-NEW RECORD WITH THIS DEVICE'S INFO    Y02669 69100002
*                                                                Y02669 69200002
         LH    R3,DEC0(R1)    OBTAIN TOTAL LENGTH TO DETERMINE   Y02669 69300002
*                                 IF SPACE FOR PUTTING AN ENTRY  Y02669 69400002
*                                 EXISTS OR NOT                  Y02669 69500002
         CH    R3,CONS156         TEST FOR ONE ENTRY ONLY        Y02669 69600002
         BL    ITISOK             YES, ENOUGH ROOM               Y02669 69700002
         BAL   R6,WRITEIT         NO, MUST WRITE THIS REC FIRST  Y02669 69800002
*                                                                Y02669 69900002
ITISOK   EQU   *                                                 Y02669 70000002
         BAL   R6,ENTRY           UPDATE REC WITH THIS DEV'S INFOY02669 70100002
SMORE    EQU   *                                                 Y02669 70200002
         MVI   XAP+DEC0,XZERO     CLEAR UNTYPE SWITCHS SINCE REC Y02669 70300002
*                            HAS BEEN PUT DOWN IN THE BUFFER AND Y02669 70400002
*                                 FINISHED WITH THIS DEVICE      Y02669 70500002
PARENCHK EQU   *                                                 Y02669 70600002
         LTR   R13,R13            WAS THIS A MULTIPLE UNIT COMD  Y02669 70700002
         BZ    SEXIT              NO, NOMORE UNITS, WERE FINISHEDY02669 70800002
         CLI   DEC0(R9),RPAREN    IS THERE AN EXT PAREN HERE     Y02669 70900002
         BNE   NOPAREN            NO, NO CLOSING PARENS HERE     Y02669 71000002
         BCTR  R13,DEC0           YES, DECREMNT PARNS SWITH BY 1 Y02669 71100002
         LA    R9,DEC1(R9)        UPDATE PTR PAST THE PARENS     Y02669 71200002
         B     PARENCHK           SEE IF WE ARE FINISHED         Y02669 71300002
NOPAREN  EQU   *                                                 Y02669 71400002
         CLI   DEC0(R9),COMMA     IS THERE A COMMA HERE          Y02669 71500002
         BNE   ENDSCAN            NO, SOMETHING IS WRONG         Y02669 71600002
         LA    R9,DEC1(R9)        YES, UPDATE PAST THE COMMA     Y02669 71700002
         B     START              GO CHECK FOR A NEW UNIT        Y02669 71800002
*                                                                Y02669 71900002
*                                                                Y02669 72000002
COMPSPAC EQU   *                                                 Y02669 72100002
         LH    R3,DEC0(R1)        OBTAIN TOTAL LNG TO DETERMINE  Y02669 72200002
*                                 IF SPACE FOR PUTTING ENTRIES   Y02669 72300002
*                                 EXISTS OR NOT                  Y02669 72400002
         CH    R3,CONS152         TST FOR 2 ENTRIES (I AND O)    Y02669 72500002
         BL    SIZEOK             YES, ENOUGH ROOM               Y02669 72600002
         BAL   R6,WRITEIT         NO, WRITE CURRENT RECORD FIRST Y02669 72700002
*                                                                Y02669 72800002
SIZEOK   EQU   *                                                 Y02669 72900002
         TM    XAP+DEC0,NRECI     IS INPUT UNT TO HAVE A REC     Y02669 73000002
         BO    RECORDO            NO CHECK IF THE OUTPUT IS      Y02669 73100002
         BAL   R6,ENTRY           GO FILL ENTRY FOR INPUT UNIT   Y02669 73200002
*                                                                Y02669 73300002
RECORDO  EQU   *                                                 Y02669 73400002
         TM    XAP+DEC0,NRECO     IS THE O UNIT TO HAVE A RECORD Y02669 73500002
         BO    SMORE              NO, FINISHED                   Y02669 73600002
         LR    R10,R11        GET R10 TO PT TO OUTPUT UNIT'S UCB Y02669 73700002
         BAL   R6,ENTRY           FILL ENTRY FOR OUTPUT UNIT     Y02669 73800002
         B     SMORE              FINISHED                       Y02669 73900002
*                                                                Y02669 74000002
         EJECT                                                          74100002
WRITEIT  EQU   *                                                 Y02669 74200002
*                                                                Y02669 74300002
*  THIS ROUTINE ISSUES AN SVC83 TO WRITE AN SMF RECORD           Y02669 74400002
*                                                                Y02669 74500002
         LR    R7,R1              SAVE POINTER ACROSS SVC CALL @YM3500P 74550002
         SVC   83                                                Y02669 74700002
         LR    R1,R7            RESTORE POINTER AFTER SVC CALL @YM3500P 74750002
         MVI   DEC1(R1),TWENTY    REINIT TOTAL LENGTH TO 20      Y02669 74800002
         MVC   VARLNTH(DEC2,R1),TWOCON REINIT VARY LENGTH TO 2   Y02669 74900002
         LA    R14,DEC20(R1)      REINIT R14 TO PT TO NEXT AREA  Y02669 75000002
         XC    DEC0(ONEFORTY,R14),DEC0(R14)  ZERO OUT PREV. DATA Y02669 75100002
         BR    R6                 RETURN TO CALLER               Y02669 75200002
*                                                                Y02669 75300002
         EJECT                                                          75400002
ENTRY    EQU   *                                                 Y02669 75500002
*                                                                Y02669 75600002
*  THIS SUBROUTINE WILL ENTER THE APPROPRIATE INFO INTO THE SMF  Y02669 75700002
*  RECORD BUFFER FOR THE DEVICE WHOSE UCB PTR IS IN REG10        Y02669 75800002
*                                                                Y02669 75900002
         LH    R3,DEC0(R1)        OBTAIN TOTAL LENGTH AND        Y02669 76000002
         LA    R3,DEC4(R3)        ADD FOUR TO IT                 Y02669 76100002
         STH   R3,DEC0(R1)        PUT IN THE UPDATED FIGURE      Y02669 76200002
         LH    R3,VARLNTH(R1)     UPDATE THE VARIABLE LENGTH ALSOY02669 76300002
         LA    R3,DEC4(R3)        BY ADDING FOUR IN IT           Y02669 76400002
         STH   R3,VARLNTH(R1)     AND PUT IT BACK                Y02669 76500002
         MVC   DEC0(DEC2,R14),UCBTBYT3 COPY DEVICE'S INFO        Y02669 76600002
         LR    R7,R1              WORKING ADDRESS REGISTER     @ZA03202 76606003
         LA    R3,DEC3            LIMIT OF 3 LOOPS             @ZA03202 76612003
         MVC   ONESXTY5(DEC3,R7),UCBNAME OBTAIN UNIT NAME      @ZA03202 76618003
LOOP3X   EQU   *                                               @ZA03202 76624003
         CLI   ONESXTY5(R7),XC1   IS CHAR. BELOW X'C1' (A)?    @ZA03202 76630003
         BL    TESTLOOP           YES, CHECK NEXT BYTE IN LOOP @ZA03202 76636003
         CLI   ONESXTY5(R7),XC6   IS CHAR. ABOVE X'C6' (F)?    @ZA03202 76642003
         BH    TESTLOOP           YES, CHECK NEXT BYTE IN LOOP @ZA03202 76645003
         TR    ONESXTY5(DEC1,R7),TABLE ALTER BYTE FOR PACK     @ZA03202 76648003
TESTLOOP EQU   *                                               @ZA03202 76654003
         LA    R7,DEC1(R7)        BUMP TO NEXT BYTE            @ZA03202 76660003
         BCT   R3,LOOP3X          LOOP UNTIL DONE              @ZA03202 76666003
         PACK  ONESIXTY(DEC4,R1),ONESXTY5(DEC3,R1) DELETE ZONES@ZA03202 76672003
         L     R3,ONESIXTY(R1)    SAVE PACKED ADDRESS          @ZA03202 76678003
         SRL   R3,DEC4            SHIFT OUT THE SIGN BIT       @ZA03202 76684003
         STH   R3,DEC2(R14)       INSERT IN THE SMF FILE       @ZA03202 76690003
         NI    DEC2(R14),HEX0F    CLEAR UNUSED BITS            @YM07237 76800002
         TM    UCBTBYT2,UCBRVDEV  IS IT A VIRTUAL DEVICE?      @Z30LPTJ 76810003
         BNO   NOHIGHBT           NO, DO NOT SET HIGH ORDER BIT@Z30LPTJ 76820003
         CLC   UCBTBYT3(DEC2),THRTY330 IS IT A 3330 DEVICE?    @Z30LPTJ 76830003
         BNE   NOHIGHBT           NO, DO NOT SET HIGH ORDER BIT@Z30LPTJ 76840003
         OI    DEC2(R14),VUNIT    SET HIGH ORDER BIT           @Z30LPTJ 76850003
NOHIGHBT EQU   *                                               @Z30LPTJ 76860003
         LA    R14,DEC4(R14)      UPDATE THE VAR. DATA PTR       Y02669 76900002
         BR    R6                 RETURN TO CALLER               Y02669 77000002
*                                                                Y02669 77100002
         EJECT                                                          77200002
SEARCH   EQU   *                                                 Y02669 77300002
*                                                                Y02669 77400002
*  THIS SUBROUTINE WILL SEARCH AND FIND IF THERE IS ANY THE      Y02669 77500002
*  UCME FOR THE DEVICE WHOSE UNITNAME IS POINTED BY REG8         Y02669 77600002
*  ON RETURN THE UCB PTR WILL BE IN REG 10 AND THE UCME WILL     Y02669 77700002
*  BE POINTED BY REG5                                            Y02669 77800002
*  OTHERWISE THESE REGS WILL BE 0                                Y02669 77900002
*                                                                Y02669 78000002
         L     R5,CVTPTR                                         Y02669 78100002
         USING SETCVT,R5                                         Y02669 78200002
         L     R5,CVTCUCB                                        Y02669 78300002
         DROP  R5                                                Y02669 78400002
         USING UCM,R5                                            Y02669 78500002
         LM    R5,R7,UCMVEA                                      Y02669 78600002
         USING UCMLIST,R5                                        Y02669 78700002
UCMESRCH EQU   *                                                 Y02669 78800002
         L     R10,UCMUCB                                        Y02669 78900002
         CLC   DEC0(DEC3,R8),UCBNAME   UNITNAMES MATCH           Y02669 79000002
         BCR   DEC8,R15           NAMES MATCH, FINISHED          Y02669 79100002
         CLR   R5,R7              IS IT END OF UCME LIST         Y02669 79200002
         BE    NOUCME             YES, ERROR, NO UCME FOUND      Y02669 79300002
         AR    R5,R6              NO, GO TO CHECK NEXT UCME      Y02669 79400002
         B     UCMESRCH           LOOP TO SEE IF THIS THE UCME   Y02669 79500002
*                                                                Y02669 79600002
NOUCME   EQU   *                                                 Y02669 79700002
         SR    R5,R5              NO UCME FOUND                  Y02669 79800002
         SR    R10,R10            AND, THEREFORE NO UCB          Y02669 79900002
         BR    R15                RETURN TO CALLER               Y02669 80000002
         DROP  R5                                                Y02669 80100002
*                                                                Y02669 80200002
         EJECT                                                          80300002
SEXIT    EQU   *                                                 Y02669 80400002
*                                                                Y02669 80500002
*  THIS SUBROUTINE CLEANS UP AND EXITS TO 4403D OR TO 4303D      Y02669 80600002
*  DEPENDING ON WHAT WAS PRESET BY 3303D                         Y02669 80700002
*                                                                Y02669 80800002
OVER     EQU   *                                                 Y02669 80900002
         CLC   VARLNTH(DEC2,R1),TWOCON HAS ANY ENTRY BEEN MADEIN Y02669 81000002
*                                 THE SMF RECORD                 Y02669 81100002
         BE    NORECORD           DO NOT WRITE THE RECORD        Y02669 81200002
*                                 IN THAT CASE                   Y02669 81300002
         BAL   R6,WRITEIT         GO AND WRITE THE RECORD, FIRST Y02669 81400002
NORECORD EQU   *                                                 Y02669 81500002
         LA    R0,ONESXTY8        SIZE OF SMF RECORD BUFFER    @ZA03202 81600003
         FREEMAIN  R,LV=(0),A=(1)                                Y02669 81700002
VEXIT    EQU   *                                                 Y02669 81800002
         L     R13,XAK            RESTORE SAVE AREA PTR        @Z30LPTJ 81900003
         XC    XAP(DEC4),XAP                                     Y02669 82000002
         MVC   XAX+DEC3(DEC2),X4203    ASSUME GOING TO 4203D     Y02669 82100002
         L     R15,VCON42         GET ADDRESS OF 4203D           Y02669 82200002
         TM    XASWITCH,XASMF42   IS IT A 4203D EXIT           @Z30LPTJ 82300003
         BO    VEXIT2             YES, GO TO BRANCH              Y02669 82400002
         MVC   XAX+DEC3(DEC2),X4403      NO, EXIT IS TO 4403D    Y02669 82500002
         L     R15,VCON44                                        Y02669 82600002
VEXIT2   EQU   *                                                 Y02669 82700002
         LM    R0,R14,DEC0(R13)                                  Y02669 82800002
         BR    R15                EXIT                           Y02669 82900002
*                                                                Y02669 83000002
         EJECT                                                          83600002
X4203    DC    C'42'               4203D VARY MODULE             Y02669 83700002
X4403    DC    C'44'               4403D VARY MODULE             Y02669 83800002
         DS    0F                                                       83900002
VCON42   DC    V(IEE4203D)                                       Y02669 84000002
VCON44   DC    V(IEE4403D)                                       Y02669 84100002
         DS    0F                                                Y02669 84200002
TWOCON   DC    H'2'                                                     84300002
CONS152  DC    H'152'                                                   84400002
CONS156  DC    H'156'                                                   84500002
CON      DC    C'CON'                                            Y02669 84600002
ONL      DC    C'ONL'                                            Y02669 84700002
PARENI   DC    C'(I-'                                            Y02669 84800002
HONE     DC    H'1'                                              Y02669 84900002
CMAO     DC    C',O-'                                            Y02669 85000002
OUNIT    DC    C'O-'                                             Y02669 85100002
         DS    0F                                                Y02669 85200002
EIGHT    DC    X'00000008'                                       Y02669 85300002
         DS    0F                                                       85400002
         DC    X'0000'        THESE TWO CONSTANTS MUST BE LEFT   Y02669 85500002
VFFFF    DC    X'FFFF'        TOGETHER                           Y02669 85600002
THRTY330 DC    X'2009'        3330 UCB DEFINITION              @Z30LPTJ 85650003
TABLE    EQU   *-C'A'                                          @ZA03202 85660003
         DC    X'FAFBFCFDFEFF'                                 @ZA03202 85670003
         SPACE 5                                                        85700002
PATCH    DC    CL50'***IEE2303D***'                                     85800002
         EJECT                                                          85900002
EXSAVEC  DSECT                                                          86000002
         IEEXSA                                                         86100002
         EJECT                                                          87100002
         IEESMCA                                                        87200002
         EJECT                                                          87300002
SETCVT   DSECT                                                          87400002
         CVT                                                            87500002
         EJECT                                                          87600002
UUCM     DSECT                                                          87700002
         IEECUCM  FORMAT=NEW                                            87800002
         EJECT                                                          87900002
UCB      DSECT                                                          88000002
         IEFUCBOB                                                       88100002
         EJECT                                                          88200002
         END                                                            88300002
./  ADD  SSI=83110941,NAME=IEE3103D
      TITLE 'IEE3103D - VARY ONLINE/OFFLINE'                            00100002
*********************************************************************** 00200002
*                                                                     * 00300002
* TITLE    IEE3103D:                                                  * 00400002
*                           VARY ONLINE/OFFLINE                       * 00500002
*                                                                     * 00600002
*********************************************************************** 00700002
*                                                                       00800002
* MODULE NAME      = IEE3103D                                           00900002
*    CSECT NAME    = IEE3103D                                           01000002
*                                                                       01100002
* LOAD MODULE NAME = IEE3603D                                           01200002
*                                                                       01300002
* DESCRIPTIVE NAME = VARY COMMAND FOR ONLINE/OFFLINE KEYWORDS           01400002
*                    FOR NON CONSOLE UNITS                              01500002
*                                                                       01600002
* COPYRIGHT        = MISSING                                            01700002
*                                                                       01800002
* STATUS           = OS/VS/2 RELEASE 3                         @OZ11847 01820003
*                                                                       02000002
* FUNCTION         = THIS MODULE VALIDATES UNIT AND VARIES ONLINE OR    02100002
*                    OFFLINE ANY UNITS IN THE COMMAND WHICH ARE         02200002
*                    FOUND TO BE NON-CONSOLE UNITS                      02300002
*                                                                       02400002
* OPERATION        = FOR VARY, A UCB SEARCH IS ACCOMPLISHED TO ENSURE A 02500002
*                    VALID UNITNAME.                                    02600002
*                    ANY UNITS VARIED IMMEDIATELY BY THIS               02700002
*                    ROUTINE, HAVE AN ONLINE OR OFFLINE MSG             02800002
*                    ISSUED TO THE OPERATOR.  IF VARY RANGE    @Z30LPTJ 02900003
*                    IS BEING PROCESSED, SUCH MESSAGES ARE     @Z30LPTJ 02930003
*                    SUPPRESSED.                               @Z30LPTJ 02960003
*                                                                       03000002
*                    IF DEVICE IS ONLINE AND CMD IS V ONLINE            03100002
*                    STATUS IS NOT CHANGED.                             03200002
*                    THE FOLLOWING BITS ARE SET:                        03300002
*                       ONLINE BIT          UCB  N/A                    03400002
*                       ON/OFF CHANGE STS   UCB  OFF                    03500002
*                       MP-OPERATOR BIT     UCB  N/A                    03600002
*                    IF DEVICE IS OFFLINE AND CMD IS V ONLINE           03700002
*                    THE STATUS IS CHANGED IMMEDIATELY.  THE            03800002
*                    FOLLOWING BITS ARE SET:                            03900002
*                       ONLINE              UCB  ON                     04000002
*                       ON/OFF CHANGE STS   UCB  OFF                    04100002
*                       MP-OPERATOR BIT     UCB  OFF                    04200002
*                    IF DEVICE IS OFFLINE AND CMD IS V OFFLINE          04300002
*                    THE STATUS IS NOT CHANGED.                         04400002
*                    THE FOLLOWING BITS ARE SET:                        04500002
*                       ONLINE              UCB  N/A                    04600002
*                       ON/OFF CHANGE STS   UCB  OFF                    04700002
*                       MP-OPERATOR BIT     UCB  N/A                    04800002
*                    IF DEVICE IS ONLINE,(ALLOCATED OR NOT) AND THE     04900002
*                    CMD IS V OFFLINE, STATUS WILL BE CHANGED           05000002
*                    BY TERMINATION WHENEVER THE DEVICE BECOMES         05100002
*                    UNALLOCATED IF IT WAS ALLOC., OR WHENEVER          05200002
*                    TERMINATION GETS CONTROL IN THE SYSTEM.            05300002
*                    THE FOLLOWING BITS ARE SET:                        05400002
*                       ON/OFF CHANGE STS   UCB  OFF                    05500002
*                       MSSUM-UCB SEARCH BIT MRC ON                     05600002
*                       MP-OPERATOR BIT     UCB  ON                     05700002
*                                                                       05800002
* NOTES                                                                 05900002
*    DEPENDENCIES    = NONE                                             06000002
*    CHARACTER/CODE DEPENDECIES                                         06100002
*                  = THIS MODULE CAN BE ASSEMBLED WITH ANY NEW          06200002
*                    CHARACTER CODE SET.                                06300002
*   RESTRICTIONS   = ON ENTRY REG2 PTR TO THE PARM LIST (DUMMY XSA)     06400002
* REGISTER CONVENTIONS                                                  06500002
*                  = REGISTERS ARE DEFINED AT: REGDEF                   06600002
*    PATCH LABEL   = PATCH                                              06700002
*                                                                       06800002
* MODULE TYPE      = CSECT                                              06900002
*    PROCESSOR     = ASSEMBLER                                          07000002
*    MODULE SIZE   = VS/2 = X'59B'                             @OZ11847 07020003
*    ATTRIBUTES    = REENTRANT,REUSABLE,REFRESHABLE,PAGED LPA,          07400002
*                    ZERO PSW PROTECT KEY                               07500002
*                                                                       07600002
* ENTRY POINTS     = IEE3103D FROM IEE4203D OR/AND IEE4603D             07700002
*    PURPOSE       = TO PROCESS VARY COMMAND                            07800002
*    LINKAGE       = BRANCH                                             07900002
*    INPUT         = REGISTER 2 POINTS TO THE DUMMY EXTENDED SAVE AREA  08000002
*                    XAR PTS TO THE LOGICAL END OF BUFFER               08100002
*                      (PTS TO COMMA BEFORE 'KEYWORD')                  08200002
*                    XAL POINTS TO THE COMMAND PARAM LIST               08300002
*                    XAV CONATINS THE VERB                              08400002
*                    XAS+0 (XOPCODE) AND XAS+1 (XSWITCH) CONTAINS       08500002
*                    BIT DESIGNATING THE KEYWORD:                       08600002
*                       ONLINE                                          08700002
*                       OFFLINE                                         08800002
*                    REG13 PTR TO THE SAVE AREA GOTTEN IN IEE3603D      08900002
*                    WORD 17 OR THE SAVE AREA HAS THE PTR TO THE CSCB   09000002
*    REGISTERS SAVED=ALL                                                09100002
*    REGISTER USAGE= R1  LINKAGE REG                                    09200002
*                    R2  DUMMY XSA PTR                                  09300002
*                    R6  EOBUFFER PTR                                   09400002
*                    R7  UCB TABLE STOPPER                              09500002
*                    R9  UNIT PTR                                       09600002
*                    R11 RESIDENT CORE BASE                             09700002
*                    R13 USED AS PTR TO 1ST UCME, SAVE AREA PTR STORED  09800002
*                        IN XAA+2 OF XSA                                09900002
*    REGISTERS RESTORED                                                 10000002
*                  = ALL                                                10100002
*                                                                       10200002
* OUTPUT DATA      = .IF THE UNIT IS A DATA STAGING MANAGER    @Z30LPTJ 10220003
*                     DEVICE AND A SS/1 PARAMETER IS NOT       @Z30LPTJ 10260003
*                     SPECIFIED, MESSAGE IEE084I IS ISSUED.    @Z30LPTJ 10300003
*                    .IF ONLINE IS SPECIFIED, BUT THE UNIT IS  @Z30LPTJ 10340003
*                     IN USE BY A SYSTEM COMPONENT, THE REQUEST@YM07231 10400002
*                     IS DENIED AND MESSAGE IEE329I IS ISSUED. @YM07231 10500002
*                    .OTHERWISE THE FOLLOWING IS DONE                   10600002
*                       THE ONLINE MESSAGE (IEE302I) IS WRITTEN         10700002
*                    .IF OFFLINE IS SPECIFIED AND THE UNIT IS           10900002
*                     ALREADY OFFLINE, THE OFFLINE MESSAGE              11000002
*                     (IEE303I) IS WRITTEN.                             11100002
*                    .IF UNIT IS ONLINE AND ALLOCATED,                  11200002
*                       SRTECHGS IS TURNED ON                           11300002
*                    .IF THE UNIT IS ONLINE BUT NOT ALLOCATED           11400002
*                       THE UNIT IS MADE OFFLINE IMMEDIATELY AND        11500002
*                       AN OFFLINE MESSAGE IS SENT TO THE OPERATOR      11600002
*                    .ALL THE ABOVE CASES CAUSE THE MP-OPERATOR BIT     11700002
*                     TO BE TURNED ON                                   11800002
*                    .IEE302I AND IEE303I MESSAGES ARE         @Z30LPTJ 11900003
*                     SUPPRESSED IF VARY RANGE IS BEING        @Z30LPTJ 11920003
*                     PROCESSED.                               @Z30LPTJ 11940003
*                                                                       11960003
* EXITS - NORMAL-1-= RETURN TO CALLER                          @Z30LPTJ 12000003
*   CONDITIONS     = IF ALL IS OK AND SATISFIED.                        12100002
*   OUTPUT         = ON RETURN TO THE CALLER                            12200002
*                    THE CSCB IS FREED VIA AN MGCR MACRO                12300002
*                    THE SAVE AREA AND DUMMY XSA ARE ALSO FREED.        12400002
*   RETURN CODES   = NONE                                               12500002
*                                                                       12600002
* EXITS - NORMAL-2-= TO IEECB904 VIA BRANCH                    @Z30LPTJ 12610003
*   CONDITIONS     = IF ALL IS OK AND SATISFIED AND VARY RANGE @Z30LPTJ 12620003
*                    IS BEING PROCESSED                        @Z30LPTJ 12630003
*   OUTPUT         = REGISTER 2 POINTING TO THE XSA WHICH HAS  @Z30LPTJ 12640003
*                    THE XAL POINTING TO THE VARY RANGE WORK   @Z30LPTJ 12650003
*                    AREA.                                     @Z30LPTJ 12660003
*   RETURN CODES   = NONE                                      @Z30LPTJ 12670003
*                                                                       12680003
* EXITS - ERROR    = NONE, ALL ERRORS ARE HANDLED INTERNALLY            12700002
*                                                                       12800002
* EXTERNAL REFERENCES                                                   12900002
*    ROUTINES      = RETURN TO CALLER                                   13000002
*                    IEECB904     VARY RANGE PROCESSOR         @Z30LPTJ 13050003
*    DATA AREAS    = SEE EXITS - OUTPUT DATA -                          13100002
*                                                                       13200002
*    CONTROL BLOCKS= 1. DUMMY EXTENDED SAVE AREA (XSA)                  13300002
*                    2. UNIT CONTROL BLOCK (UCB)                        13400002
*                       FIELDS TESTED-  UCBFL2- BIT= X'40'              13500002
*                                       UCBNAME                         13600002
*                                       UCBTBYT3- BIT= UCB3DACC         13700002
*                                                      UCB3UREC@Z30LPTJ 13730003
*                                       UCBTBYT4- BIT= UCBDSM  @Z30LPTJ 13760003
*                                       SRTESTAT- BIT= SRTESYSR         13800002
*                                                      SRTEONLI         13900002
*                       FIELDS UPDATED- UCBFL2- BIT= X'40'              14000002
*                                       SRTESTAT- BIT= SRTECHGS         14100002
*                                                      SRTEONLI         14200002
*                                       UCBWGT BIT= UCBVORSN            14300002
*                    3. COMMAND SCHEDULING CONTROL BLOCK (CSCB)         14400002
*                       FIELDS UPDATED- CHSTS - BIT= CHFC               14500002
*                       FIELDS TESTED-  NONE                            14600002
*                    4. CVT                                             14700002
*                       FIELDS UPDATED- NONE                            14800002
*                       FIELDS TESTED-  CVTILK2                         14900002
*                                       CVTMSER                         15000002
*                    5. UNIT CONTROL MODULE (UCM)                       15100002
*                       FIELDS UPDATED- NONE                            15200002
*                       FIELDS TESTED-  UCMUCB                          15300002
*                                       UCMVEA                          15400002
*                    6. MASTER SCHEDULER RESIDENT DATA AREA (MRC)       15500002
*                       FIELDS TESTED  - NONE                           15600002
*                       FIELDS UPDATED - MSECBFL - BIT= MSSUM           15700002
*                                                                       15800002
* TABLES           = NONE                                               15900002
*                                                                       16000002
* MACROS           = 1. IOSGEN  -  FOR SIMULATED INTERRUPT              16100002
*                    2. WTO     -  FOR MSGS                             16200002
*                    3. DEQ     -  FOR TESTING                          16300002
*                                  CHANGEABLE UCB BITS                  16400002
*                    4. FREEMAIN - TO FREE SAVE AREA AND DUMMY XSA      16500002
*                    5. MGCR     - TO FREE CSCB ON EXIT                 16550003
*                    6. IOSGEN   - FOR TURNING OFF QUIESCE     @OZ11847 16650003
*                                                                       16700002
* MAPPING MACRO    = IEEXSA                                             16800002
*                    IEECHAIN                                           16900002
*                    IEFUCBOB                                           17000002
*                    CVT                                                17100002
*                    IEECUCM                                            17200002
*                    IEEBASEA                                           17300002
*                    IECDIOCM                                  @0Z11847 17350003
*    SERIALIZATION = NO LOCKS ARE REQUIRED IN THIS MODULE SINCE         17400002
*                    THERE IS NO NEED FOR SERIALIZATION WITH            17500002
*                    COMM. TASK                                         17600002
*                    PROTECTION FROM VARY/UNLOAD,ALLOCATION             17700002
*                    AND SYSTEM COMPONENT IS ACCOMPLISHED VIA  @YM07231 17800002
*                    AN ENQ ISSUED IN MODULE IEE3603D.         @YM07231 17900002
*                    THIS ENQ IS RELEASED VIA A DEQ WHEN                18000002
*                    THIS MODULE COMPLETES PROCESSING AND IS            18100002
*                    READY TO EXIT, AT: VDEQUE                          18200002
*                    AT ALL TIMES, WHEN BITS ARE SET IN THE UCB AND     18300002
*                    MRC, THEY ARE DONE VIA THE COMPARE-AND-SWAP        18400002
*                    INSTRUCTION, FOR PROTECTION                        18500002
*                                                                       18600002
* CHANGE LEVEL     = Y02669, Y02651, Z30LPTJ, ZM30481, OZ05159 @OZ05159 18700003
*                    OZ07161, @OZ11847                         @OZ11847 18720003
*                                                                       18800002
* MESSAGES         = NORMAL - WHEN SPECIFIED VARY CONTIONS IS           19100002
*                             ALREADY SATISFIED                         19200002
*                             'IEE302I XXX ONLINE'                      19300002
*                             'IEE303I XXX OFFLINE'                     19400002
*                             (XXX IS THE UNITNAME)                     19500002
*                             THE ABOVE MESSAGES ARE SUPPRESSED@Z30LPTJ 19520003
*                             WHEN VARY RANGE IS BEING         @Z30LPTJ 19540003
*                             PROCESSED.                       @Z30LPTJ 19560003
*                                                                       19600002
*                    ERROR -                                            19700002
*                             'IEE313I XXX UNIT REF. INVALID'           19800002
*                             WHEN UNITNAME IS NOT IDENTIFIED           19900002
*                             THIS MESSAGE IS SUPPRESSED WHEN  @ZM30481 19910003
*                             VARY RANGE IS BEING PROCESSED,   @ZM30481 19920003
*                             EXCEPT WHEN A SYSRES DEVICE IS   @ZM30481 19930003
*                             BEING ATTEMPTED TO BE VARIED     @ZM30481 19940003
*                             OFFLINE.                         @ZM30481 19950003
*                                                                       19960003
*                             'IEE329I XXX IN USE BY A SYSTEM  @YM07231 20000002
*                                                  COMPONENT'  @YM07231 20050002
*                             WHEN UNIT SPECIFIED CANNOT BE             20100002
*                             BROUGHT ONLINE                            20200002
*                                                                       20205003
*                             'IEE084I XXX 3851 PARAMETER      @Z30LPTJ 20210003
*                                                MISSING'      @Z30LPTJ 20220003
*                             WHEN A DATA STAGING MANAGER UNIT @Z30LPTJ 20230003
*                             IS SPECIFIED WITHOUT A SS/1      @Z30LPTJ 20240003
*                             PARAMETER                        @Z30LPTJ 20250003
*                                                                       20300002
* ABEND CODES      = NONE                                               20400002
*                                                                       20500002
* PACKAGING        = IEE3103D IS PART OF LOAD MODULE                    20600002
*                       = IEE3603D                                      20700002
*                    THIS LOAD MODULE ALIASES ARE                       20800002
*                       = NONE                                          20900002
*                    THIS LOAD MODULE ENTRY POINTS ARE                  21000002
*                       = IEE3603D                                      21100002
*                    MODULE WILL RESIDE IN:  LPALIB                     21200002
*                                                                       21300002
* SYSGEN           = SUPPLIED BY SECTIONS:                              21400002
*                       .LOAD MODULE NAME                               21500002
*                       .PACKAGING                                      21600002
*                       .THIS CSECT WILL BE INCLUDED AT SYSGEN FROM     21700002
*                        DLIB -AOSB3- BY MACRO -SGIEF441-               21800002
*                                                                       21900002
* SYSTEM LIBRARIES = NONE                                               22000002
*                                                                       22100002
*********************************************************************** 22200002
    EJECT                                                               22300002
*****************************************************************Y02669 22400002
*   ***       ***                                                Y02669 22500002
*   *           *                                                Y02669 22600002
* V * XXX       *,ONLINE /OR/OFFLINE                             Y02669 22700002
*   *           *                                                Y02669 22800002
*   ***       ***                                                Y02669 22900002
*****************************************************************Y02669 23000002
    EJECT                                                               23100002
IEE3103D CSECT                                                          23200002
* C 104000-105000,178000-179000,200000-200500,275000-276000,   @YM07231 23220002
* C 331000-332000,592000,594000,597000,599000-602000,          @YM07231 23240002
* C 631000-632000                                              @YM07231 23270002
* A 102200-102600,137300-137600,202100-202500,274500,          @Z30LPTJ 23276003
* A 278500,330080-330880,500500,626300-626600                  @Z30LPTJ 23282003
* C 019000,071000,103000,187000,386000                         @Z30LPTJ 23288003
* D 072000-073000,108000                                       @Z30LPTJ 23294003
* A 573100-573700                                              @ZM30481 23297003
* C 071000,584000                                              @ZM30481 23298003
* A 476100-476500                                              @OZ05159 23299003
* FIX A                                                        @ZA07161 23299503
* VONLIN1 (D)                                                  @ZA08705 23299703
* VONLIN1 (A)                                                  @OZ11847 23299803
*       REGISTER EQUATES                                                23380003
REGDEF   EQU   *                                                 Y02669 23400002
R0       EQU   0                                                        23500002
R1       EQU   1                                                        23600002
R2       EQU   2                             XSA BASE                   23700002
R3       EQU   3                             CVT BASE                   23800002
R4       EQU   4                             DATA CELL BIN NUM CHECK    23900002
R5       EQU   5                             LINK REG                   24000002
R6       EQU   6                             END OF PARM PTR            24100002
R7       EQU   7                             UCB TABLE STOPPER          24200002
R8       EQU   8                             SAVE AREA PTR STORE Y02669 24300002
R9       EQU   9                             UNIT NAME POINTER          24400002
R10      EQU   10                                                       24500003
R11      EQU   11                                                       24600002
*                                                                       24700002
*                                                                       24800002
*                                                                       24900002
VBASE    EQU   12                                                       25000002
*                                                                       25100002
*                                                                       25200002
*                                                                       25300002
R13      EQU   13                       USED AS PTR TO 1ST UCM   Y02669 25400002
R14      EQU   14                                                       25500002
R15      EQU   15                                                       25600002
*                                                                       25700002
* CODE EQUATES                                                          25800002
*                                                                       25900002
*                                                                       26000002
HEX80    EQU   X'80'                                                    26100002
ZERO     EQU   0                                                        26300002
ONE      EQU   1                                                        26400002
TWO      EQU   2                                                        26500002
TRI      EQU   3                                                        26600002
FOR      EQU   4                                                        26700002
SVN      EQU   7                                                        26800002
EIT      EQU   8                                                        26900002
FIFTN    EQU   15                                                 19084 27200002
SXTN     EQU   16                                                       27300002
SVTN     EQU   17                                                       27400002
TWENTY3  EQU   23                                              @Z30LPTJ 27450003
TWENTY9  EQU   29                                              @YM07231 27500002
FORTY9   EQU   49                                              @YM07231 27600002
TWTY8    EQU   28                                                       27700003
THRTY7   EQU   37                                                       27800002
FORTY3   EQU   43                                              @Z30LPTJ 27850003
D64      EQU   64                                                Y02669 27900002
D68      EQU   68                                                Y02669 28000002
D76      EQU   76                                                Y02669 28100002
D132     EQU   132                                               Y02669 28200002
SIXTY    EQU   60                                                Y02669 28300002
EIGHTY   EQU   80                                                Y02669 28400002
*                                                                       28500002
*                                                                       28600002
ZEROCD   EQU   X'00'                                                    28700002
LPAREN   EQU   C'('                                                     28800002
BLANK    EQU   C' '                                                     28900002
         EJECT                                                          29000002
* INITIALIZATION - SETS UP MODULE ADDRESSABILITY, AND ESTABLISHES     * 29100002
*   THE END OF BUFFER AND PARAMETER POINTERS.                         * 29200002
*                                                                       29300002
         BALR   VBASE,ZERO            ESTABLISH PROGRAM                 29400002
         USING  *,VBASE            ADDRESSABILITY                       29500002
         MODID BR=YES                                            Y01886 29600002
         USING  XSA,R2             BASE FOR EXTENDED SAVE A             29700002
         USING  SETCVT,R3          CVT ADDRESSABILITY                   29800002
*                                                                       29900002
         STM   R0,R15,ZERO(R13)                                  Y02669 30000002
         ST    R13,XAK             STORE SAVE AREA PTR         @Z30LPTJ 30100003
         L     R3,CVTPTR           CVT PTR TO REG3                      30200002
         L      R9,XAL                                                  30400002
*                                  USE REG 9 AS POINTER                 30500002
         LA     R9,ZERO(R9)           TO PARAMETER KEYWORD              30600002
         EJECT                                                          30700002
*                                                                       30800002
*                                                                       30900002
         L     R11,CVTCUCB        OPTAIN PTR TO UCM (HEADER)            31000002
         USING UCM,R11           ..                                     31100002
         DROP  R3                                                 19084 31200002
*                                                                       31300002
*                                                                       31400002
*********************************************************************** 31500002
*                                                                       31600002
*        AFTER LOCATING THE UCB, CHECK TO SEE                           31700002
*        IF UNIT IS A CONSOLE BY LOOKING FOR A UCME WHICH               31800002
*        CORRESPONDS TO THE UCB.  IF FOUND, UNIT IS A CONSOLE           31900002
*        AND HAS BEEN PROCESSED BEFORE BY CONSOLE ROUTINES              32000002
*********************************************************************** 32100002
         MVI   XAE,ZEROCD          CLEAR HIGH ORDER BYTE          19084 32400002
         CLI   ZERO(R9),LPAREN     ONE UNIT ONLY                        32500002
         BE    VMLTUNT            NO, MORE THAN ONE                     32600002
         BAL   R5,VULUCB          GO LOOK UP UCBS                       32700002
VDCHK    EQU   *                  ..                                    32800002
         USING UCBOB,R3           SET UP BASE                     19084 32900002
         CLI   UCBTBYT3,UCB3UREC  TEST 1ST BYTE FOR DSM        @Z30LPTJ 33008003
         BNE   NOTDSM             DATA STAGING MANAGER NOT UP  @Z30LPTJ 33016003
         CLI   UCBTBYT4,UCBDSM    TEST 2ND BYTE FOR DSM        @Z30LPTJ 33024003
         BNE   NOTDSM             DATA STAGING MANAGER NOT UP  @Z30LPTJ 33032003
         BAL   R6,VMOVE           GET UNIT NAME                @Z30LPTJ 33040003
         SR    R0,R0              CLEAR REG                    @Z30LPTJ 33041003
         TM    XAU,HEX80          WAS ISSUER THE R/I           @Z30LPTJ 33042003
         BO    OKAY               YES, OK                      @Z30LPTJ 33043003
         IC    R0,XAU             NO, GET CONSOLE ID           @Z30LPTJ 33044003
OKAY     EQU   *                                               @Z30LPTJ 33046003
         MVC   XAI(EIT),SS1ID     GET MESSAGE ID               @Z30LPTJ 33048003
         MVC   XAT(TWENTY3),SS1TEXT GET MESSAGE TEXT           @Z30LPTJ 33056003
         MVC   XAT+TWENTY3(FOR),ROUTDESC GET ROUT & DESC CODES @Z30LPTJ 33064003
         LA    R6,FORTY3          GET MESSAGE LENGTH           @Z30LPTJ 33072003
         B     VMSG1              PREPARE FOR WTO              @Z30LPTJ 33080003
NOTDSM   EQU   *                                               @Z30LPTJ 33088003
         TM    UCBFL5,UCBNALOC    IS DEVICE IN USE BY A SYSTEM @YM07231*33100002
                                   COMPONENT?                  @YM07231 33150002
         BO    COMPUNT            YES, ISSUE MESSAGE           @YM07231 33200002
         TM    XASOPCOD,XAON      ONLINE                       @Z30LPTJ 33300003
         BO    VONLIN             YES                             19084 33400002
         EJECT                                                    19084 33500002
*                                                                 19084 33600002
* VARY OFFLINE                                                    19084 33700002
*                                                                 19084 33800002
VOFFLN   EQU    *                  ..                             19084 33900002
         TM    SRTESTAT,SRTESYSR   SYSRES                               34000002
         BO    VUBDUN              YES, INVALID UNIT REFERENCE    19726 34100002
*        NI    SRTESTAT,F-SRTECHGS TURN OFF THE ON/OFF CHGE STATSY02651 34200002
*                                                                Y02651 34300002
********** THE ABOVE INSTRUCTION WILL BE PROTECTED VIA THE       Y02651 34400002
*          COMPARE-AND-SWAP INSTRUCTION                          Y02651 34500002
*                                                                Y02651 34600002
         L     R6,XAK                                          @Z30LPTJ 34700003
         STM   R4,R5,D68(R6)  SAVE R4,R5 AND R15 FOR MACRO USE.  Y02651 34800002
         ST    R15,D76(R6)    R3 POINTS TO UCB FOR MACRO ADDR    Y02651 34900002
NICHGS   EQU   *                                                 Y02651 35000002
FSRTECGS EQU   X'BF'  X'FF'-SRTECHGS-                            Y02651 35100002
         NIL   SRTESTAT,FSRTECGS,WREGS=(15,4,5),REF=UCBOB        Y02651 35200002
*        OI    UCBWGT,UCBVORSN    INDICATE V OFFL FOR V DEVICE   Y02651 35300002
OILOPER  EQU   *                                                 Y02651 35400002
         OIL   UCBWGT,UCBVORSN,WREGS=(15,4,5),REF=UCBOB          Y02651 35500002
         LM    R4,R5,D68(R6)                                     Y02651 35600002
         L     R15,D76(R6)    RESTORE R4,R5,AND R15              Y02651 35700002
*                                                                Y02651 35800002
         TM     SRTESTAT,SRTEONLI  NO. IS UNIT ONLINE NOW        Y02651 35900002
         BO     VSBAVU             UES. GO SET BIT TO SEARCH     Y02651 36000002
VWOFF    EQU    *                  ..                             19084 36100002
         BAL    R6,VMOVE           INSET UNIT FOR MESSAGE         19084 36200002
         MVC    XAT(EIT),VARYOFF     SET WTO TEXT                 19084 36300003
         MVC    XAI(EIT),VOFFID      OFFLINE IDENT                19084 36400002
         B      VUNIT              GO TO MSG WRITER.              19084 36500002
VMLTUNT  EQU   *                                                  19084 36600002
         LA    R3,FIFTN              ASSUME (I-XXX,O-XXX) SPECIFI 19084 36700002
         CLC   ONE(TRI,R9),LPARENI     IS IT '(I-'                19084 36800002
         BE    VMLTUNT2           YES,OMIT. GO CHECK IF E O BUFFER19084 36900002
         LA    R3,SVN               ASSUME O-XXX SPECIFIED        19084 37000002
         CLC   ONE(TWO,R9),OUNITDSH    IS IS 'O-'                 19084 37100002
         BE    VMLTUNT2           YES,OMIT.  CHECK E O BUFFER     19084 37200002
         LA    R9,ONE(R9)           NO, MAY BE REGULAR UNIT       19084 37300002
         BAL   R5,VULUCB          GO LOOK UCBS                    19084 37400002
         LM    R13,R15,UCMVEA     R13 PTS TO THE FIRST UCME       19084 37500002
*                                 R14 INDICATES UCME SIXE         19084 37600002
*                                 R15 PTS TO THE LST UCME         19084 37700002
         USING UCMLIST,R13        ..                              19084 37800002
ULOOP    EQU   *                  ..                              19084 37900002
         C     R3,UCMUCB          IS THERE A UCME FOR THIS UCB    19084 38000002
         BE    VMAINN             YES,OMIT. GO CHECK E / BUFFER  Y02651 38100002
         BXLE  R13,R14,ULOOP      UCME NOT FOUND                  19084 38200002
         B     VDCHK              RETURN ADDRESS                  19084 38300002
         SPACE 2                                                  19084 38400002
VMOVE    EQU    *                  ..                             19084 38500002
         LM    R4,R5,XAR         STORE XAR AND XAL IN REGS     @Z30LPTJ 38600003
         L     R3,XAS              SAVE XAS SWITCHES              19084 38700002
         L     R7,XAK             STORE SAVE AREA POINTER      @Z30LPTJ 38750003
         L     R8,XAU             STORE UCM ID                          38800002
         MVC    XAV(EIT),XAX         ALTER POSITION FOR UNIT      19084 38900002
         MVC    XAF(EIT),XAV         TO KEEP FORM OVERLAYING UNIT 19084 39000002
         BR    R6                  RETURN TO CALLING SUBROUTINE   19084 39100002
VSBAVU   EQU   *                                                  19084 39200002
*        OI    SRTESTAT,SRTECHGS  SET THE ON/OFF CHAG STATS BIT  Y02651 39300002
*                                                                Y02651 39400002
********** THE ABOVE INSTRUCTION WILL BE PROTECTED VIA THE       Y02651 39500002
*          COMPARE-AND-SWAP INSTRUCTION                          Y02651 39600002
*                                                                Y02651 39700002
         L     R6,XAK             SAVE AREA POINTER            @Z30LPTJ 39800003
         STM   R4,R5,D68(R6)                                     Y02651 39900002
         ST    R15,D76(R6)     R3 PTS TO UCB FOR MACRO ADDR.     Y02651 40000002
OICHGS   EQU   *                                                 Y02651 40100002
         OIL   SRTESTAT,SRTECHGS,WREGS=(15,4,5),REF=UCBOB        Y02651 40200002
         LM    R4,R5,D68(R6)                                     Y02651 40300002
         L     R15,D76(R6)     RESTORE R4,R5,AND R15             Y02651 40400002
*                                                                Y02651 40500002
         L     R1,CVTPTR                                         Y02651 40600002
         USING SETCVT,R1                                         Y02651 40700002
         L     R1,CVTMSER         MSTER RESIDENT CORE POINTER    Y02651 40800002
         DROP  R1                                                Y02651 40900002
         USING BASE,R1                                           Y02651 41000002
*        OI    MSECBFL,MSSUM      NO, SET UCB SEARCH FLAG IN     Y02651 41100002
*                                                                Y02651 41200002
********** THE ABOVE INSTRUCTION WILL BE PROTECTED VIA THE       Y02651 41300002
*          COMPARE AND SWAP INSTRUCTION                          Y02651 41400002
*                                                                Y02651 41500002
OIMSSUM  EQU   *                                                 Y02651 41600002
         OIL   MSECBFL,MSSUM,WREGS=(15,4,5),REF=BASE             Y02651 41700002
         LM    R4,R5,D68(R6)                                     Y02651 41800002
         L     R15,D76(R6)    RESTORE REGS 4,5,AND 15            Y02651 41900002
*                                                                Y02651 42000002
         DROP R1                                                 Y02651 42100002
*                                  MASTER RESIDENT CORE          Y02651 42200002
         B     VMAINN              GO CHECK ANYMORE              Y02651 42300002
         EJECT                                                    19084 42400002
*                                                                 19084 42500002
* VARY ONLINE                                                     19084 42600002
*                                                                 19084 42700002
VONLIN   EQU    *                  ..                             19084 42800002
*        OI     SRTESTAT,SRTEONLI  SET UCB BIT                   Y02651 42900002
*        NI     SRTESTAT,F-SRTECHGS                              Y02651 43000002
*                                                                Y02651 43100002
********** THE ABOVE TWO INSTRUCTIONS WILL BE PROTECTED VIA THE  Y02651 43200002
*          COMPARE-AND-SWAP INSTRUCTION                          Y02651 43300002
*                                                                Y02651 43400002
         L     R6,XAK             SAVE AREA POINTER            @Z30LPTJ 43500003
         STM   R4,R5,D68(R6)                                     Y02651 43600002
         ST    R15,D76(R6)       R3 PTS TO UCB FOR MACRO ADDR.   Y02651 43700002
OIONLI   EQU   *                                                 Y02651 43800002
         OIL   SRTESTAT,SRTEONLI,WREGS=(15,4,5),REF=UCBOB        Y02651 43900002
CHGSNI   EQU   *                                                 Y02651 44000002
FSRTECHS EQU   X'BF'  X'FF'-SRTECHGS-                            Y02651 44100002
         NIL   SRTESTAT,FSRTECHS,WREGS=(15,4,5),REF=UCBOB        Y02651 44200002
*        NI    UCBWGT,F-UCBVORSN                                 Y02651 44300002
NILOPER  EQU   *                                                 Y02651 44400002
FUCBVORS EQU   X'FB'  X'FF'-UCBVORSN-                            Y02651 44500002
         NIL   UCBWGT,FUCBVORS,WREGS=(15,4,5),REF=UCBOB          Y02651 44600002
         LM    R4,R5,D68(R6)                                     Y02651 44700002
         L     R15,D76(R6)         RESTORE R4,R5,AND R15         Y02651 44800002
*                                                                Y02651 44900002
READYBIT EQU    X'40'              FOR 'ANDING OFF NOT READY BIT Y02651 45000002
         EJECT                                                          45100002
         L     R13,XAK            POINTER TO SAVE AREA         @Z30LPTJ 45200003
         STM   R0,R13,ZERO(R13)   STORE ALL MY REGS EXCEPT R14   Y02669 45300002
         ST    R15,SIXTY(R13)                                    Y02669 45400002
         LA    R4,IOSGENST        START OR FIXED AREA            Y02669 45500002
         LA    R5,IOSGEND         END+1 ADDRESS OR FIXED AREA    Y02669 45600002
         LA    R6,EIGHTY(R13)     ECB ADDR                       Y02669 45700002
         STM   R4,R6,D68(R13)      SAVE THIS INFO                Y02669 45800002
         XC    EIGHTY(FOR,R13),EIGHTY(R13)  CLEAR ECB            Y02669 45900002
FIX      EQU   *                                                 Y02669 46000002
         PGFIX R,A=(4),EA=(5),ECB=(6),LONG=N                            46100002
         LTR   R15,R15             TEST THE RETURN CODE        @ZA07161 46130003
         BZ    IOSGENST            DON'T WAIT ON POSTED ECB    @ZA07161 46160003
         WAIT  1,ECB=(6)                                                46200002
*                                                                Y02669 46300002
IOSGENST EQU   *                                                 Y02669 46400002
*    THE IOSGEN MACRO WAS ADDED FOR APAR 20947 AND PTM 2947             46500002
         IOSGEN SIMINT,UCB=(3),REG=(15)                                 46600002
IOSGEND  EQU   *                                                 Y02669 46700002
         LM    R4,R5,D68(R13)     START AND END ADDR             Y02669 46800002
FREE     EQU   *                                                 Y02669 46900002
         PGFREE  R,A=(4),EA=(5)                                         47000002
*                                                                Y02669 47100002
         LM    R0,R15,ZERO(R13)   RESTORE 3103D"S REGS           Y02669 47200002
         EJECT                                                          47300002
VONLIN1  EQU    *                  ..                             19084 47400002
         TM     UCBTBYT3,UCB3DACC  IS CEVICE DIRECT ACCESS        19084 47500002
         BZ     VWON               NO-DO NOT SET NOT READY BIT OFF19084 47600002
         TM     UCBTBYT2,UCBRVDEV  IS THIS A VIRTUAL DEVICE?   @OZ11847 47610003
         BNO    NONVIRT            NO, SKIP RESETTING UCBQISCE @OZ11847 47618003
*   SET THE QUIESCE BIT OFF FOR VIRTUAL UNIT COMING ONLINE     @OZ11847 47626003
*                                                              @OZ11847 47634003
         IOSGEN UCBFLG,UCB=(3),TABLE=UCBQISCE,VAR=OFF          @OZ11847 47642003
         EJECT                                                          47660003
NONVIRT  EQU   *                                               @OZ11847 47670003
*        NI     UCBFL2,READYBIT    TURN OFF NOT READY BIT        Y02651 47700002
*                                                                Y02651 47800002
********** THE ABOVE INSTRUCTION WILL BE PROTECTED VIA THE       Y02651 47900002
*          COMPARE-AND-SWAP INSTRUCTION                          Y02651 48000002
*                                                                Y02651 48100002
         L     R6,XAK              SAVE AREA POINTER           @Z30LPTJ 48200003
         STM   R4,R5,D68(R6)                                     Y02651 48300002
         ST    R15,D76(R6)                                       Y02651 48400002
NIREADY  EQU   *                                                 Y02651 48500002
NOTRDY   EQU   X'BF'  X'FF'-READYBIT-                            Y02651 48600002
         NIL   UCBFL2,NOTRDY,WREGS=(15,4,5),REF=UCBOB            Y02651 48700002
         LM    R4,R5,D68(R6)                                     Y02651 48800002
         L     R15,D76(R6)                                       Y02651 48900002
VWON     EQU    *                                                       49000002
         BAL    R6,VMOVE           INSET UNIT FOR MESSAGE               49100002
         MVC    XAT(EIT),VARYON    SET WTO TEXT                         49200003
         MVC    XAI(EIT),VONID       ID FOR VARY ON WTO                 49300002
         EJECT                                                          49400002
*                                                                       49500002
* MESSAGE WRITER                                                        49600002
*                                                                       49700002
VUNIT    EQU   *                                                        49800002
         LA    R6,TWTY8              LENGTH OF WTO LINE                 49900003
         MVC   XAT+EIT(FOR),ROUTDESC MOVE IN ROUTE AND DESC CODES FLAGS 50000003
         SR    R0,R0               CLEAR REG                     Y02669 50100002
         TM    XAU,HEX80           WAS ISSUER THE R/I            Y02669 50200002
         BO    VMSG                YES, OK                              50300002
         IC    R0,XAU              NO, GET CONSOLE ID                   50400002
VMSG     EQU   *                                                        50500002
         TM     XAAVRANG,XAARNG1  VARY RANGE BEING PROCESSED?  @Z30LPTJ 50520003
         BO     PROCEED           YES, SUPPRESS THE MESSAGE    @Z30LPTJ 50540003
VMSG1    EQU   *                                               @Z30LPTJ 50560003
         SLL    R6,SXTN              SHIFT TO FIRST HALF OR GEG         50600002
         ST     R6,XAH             PUT LEN IN FIRST HALF AND ZERO       50700002
         MVC   XAH+TWO(TWO),MCSFLAGS     MOVE IN MCSFLAGS               50800002
*                                  NEXT HALF WORD OF WTO BUFF LEN       50900002
         WTO    MF=(E,(R2))        WRITE LINE                           51000002
PROCEED  EQU   *                                               @Z30LPTJ 51050003
         STM   R4,R5,XAR           RESTORE XAR AND XAL                  51100002
         ST    R3,XAS              RESTORE XAS                    19084 51200002
         ST    R7,XAK             RESTORE SAVE AREA POINTER    @Z30LPTJ 51250003
         ST    R8,XAU             RESTORE UCMID                  Y02669 51300002
         B     VMAINN             GO,CHECK IF ANYMORE             19084 51400002
VMLTUNT2 EQU   *                                                  19084 51500002
         AR    R9,R3               R9 PTR TO DELIMITER            19084 51600002
*                                                                 19084 51700002
         SPACE 2                                                  19084 51800002
VMAINN   EQU   *                                                  19084 51900002
         C     R9,XAR             END OF BUFFER REACHED           19084 52000002
         BCTR  R9,ZERO            MINUS 1                               52100002
         BL    VMLTUNT            NO, GO CHECK NEXT UNIT          19084 52200002
         TM    XAAVRANG,XAARNG1   VARY RANGE BEING PROCESSED?  @Z30LPTJ 52210003
         BNO   NORMEXIT           NO, AVOID EXIT TO IEECB904   @Z30LPTJ 52220003
         L     R15,VCON904        GET IEECB904 ADDRESS         @Z30LPTJ 52230003
         BR    R15                GO TO VARY RANGE PROCESSOR   @Z30LPTJ 52240003
NORMEXIT EQU   *                                               @Z30LPTJ 52250003
         EJECT                                                          52300002
**************************************************               Y02651 52400002
*                                                                Y02651 52500002
*  THIS IS A TERMINAL EXIT AND THEREFORE THE ENQ THAT WAS        Y02651 52600002
*  ISSUED IN IEE3603D MUST BE RELEASED VIA A DEQ.                Y02651 52700002
*                                                                Y02651 52800002
         DEQ   MF=(E,IEFDEQUE)                                   Y02651 52900002
**************************************************               Y02651 53000002
         SPACE 10                                                       53100002
         L     R13,XAK             RESTORE SAVE AREA PTR       @Z30LPTJ 53200003
         L     R1,D64(R13)         GET CSCB PTR INTO REG1        Y02669 53300002
         USING CHAIN1,R1                                         Y02669 53400002
         OI    CHSTS,CHFC          SET TO FREE CSCB              Y02669 53500002
         MGCR  (1),CHAIN                                         Y02669 53600002
         LM    R0,R15,ZERO(R13)    RESTORE ALL REGS              Y02669 53700002
         LR    R4,R14              SAVE RETURN ADDRESS           Y02669 53800002
*                                  FREE SAVE AREA GOTTEN IN 3303DY02669 53900002
         LR    R1,R2               DUMMY XSA PTR INTO REG1       Y02669 54000002
         LA    R0,D132             DUMMY XSA SIZE AND SVAREA SIZ Y02669 54100002
         FREEMAIN R,LV=(0),A=(1)                                 Y02669 54200002
*                                  FREE XSA CORE GOTTEN IN 3603D Y02669 54300002
         LR    R14,R4              RESTORE RETURN ADDRESS        Y02669 54400002
         BR    R14                 RETURN                        Y02669 54500002
*                                                                Y02669 54600002
*                                                                       54700002
         EJECT                                                          54800002
* UCB LOOK-UP SUBROUTINE - THE TWO BYTE UCB POINTERS ARE EXAMINED TO  * 54900002
*  VERIFY THE UNITNAME.  SATISFACTORY IDENTIF. LEADS TO A RETURN 19084* 55000002
*  TO CALLER (EITHER VARY OR UNLOAD ROUTINE).  IF THE UNITNAME IS19084* 55100002
*  NOT FOUND, AN INVALID REFERENCE MESSAGE IS CALLED FOR.        19084* 55200002
*                                                                 19084 55300002
VULUCB   EQU    *                  ..                             19084 55400002
         MVI   XAX,BLANK           BLANK DEV HOLD AREA            19084 55500002
         MVC   XAX+ONE(SVN),XAX                                   19084 55600002
         LR    R3,R9                    SAVE UNITNAME POINTER     19084 55700002
         LA    R6,ONE                     SET BUFFER UPDATE COUNT 19084 55800002
         LA    R9,TRI(ZERO,R9)              SET FOR DELIMITER CHEK19084 55900002
         MVC   XAX(TRI),ZERO(R3)             SET UNITNAME         19084 56000002
VULUCB1  EQU   *                                                  19084 56100002
         AR    R9,R6                   POINT TO NEXT DEVICE       19084 56200002
         L     R6,CVTPTR                                          19084 56300002
         USING SETCVT,R6                                          19084 56400002
         L      R6,CVTILK2         POINT TO 2 BYTE UCB PTRS       19084 56500002
         DROP  R6                                                 19084 56600002
VULOOK   LH     R3,ZERO(R6)           LOAD A UCB POINTER          19084 56700002
         LTR    R3,R3              IS ADDRESS ZERO (A VOID)       19084 56800002
         BZ     VUBUMP             YES. LOOK AT NEXT              19084 56900002
         LH     R7,VFFFF           TABLE STOPPER - FFFF           19084 57000002
         CLR    R7,R3              IS IT TABLE END                19084 57100002
         BNE    VUUCB              NO. CHECK UCB NAME             19084 57200002
VUBDUN   EQU    *                  ..                             19084 57300002
         TM    XAAVRANG,XAARNG1    VARY RANGE BEING PROCESSED? @ZM30481 57310003
         BNO   INSERT              NO, PROCESS NORMALLY        @ZM30481 57320003
         TM    XASOPCOD,XAON       AN 'ONLINE' COMMAND?        @ZM30481 57330003
         BO    VMAINN              YES, AVOID MESSAGE OUTPUT   @ZM30481 57340003
         TM    SRTESTAT,SRTESYSR   A SYSRES DEVICE?            @ZM30481 57350003
         BNO   VMAINN              NO, AVOID MESSAGE OUTPUT    @ZM30481 57360003
INSERT   EQU   *                                               @ZM30481 57370003
         BAL   R6,VMOVE            INSERT UNIT FOR MSG            19084 57400002
         MVC   XAI(EIT),UNITERR          SET UP MSG ID            19084 57500002
         SR    R0,R0                                              19084 57600002
         TM    XAU,HEX80           R/I COMMAND                    19084 57700002
         BO    VMSGCONT            YES, GO CONTINUE WITH MSG BUILD19084 57800002
         IC    R0,XAU              NO, GET CONID IN REG0 FOR WTO  19084 57900002
VMSGCONT EQU   *                                                  19084 58000002
         MVC    XAT(SVTN),UNITTXT    SET UP MSG TEXT              19084 58100002
         MVC   XAT+SVTN(FOR),ROUTDESC     MOVE IN ROUT AND DESC   19084 58200002
         LA    R6,THRTY7               SET WTO LENGTH             19084 58300002
         B     VMSG1               PUT OUT ERROR MESSAGE       @ZM30481 58400003
VUUCB    EQU    *                  ..                             19084 58500002
         N      R3,VFFFF-TWO         CLEAR ANY HIGH ORDER BITS    19084 58600002
         CLC   UCBNAME(TRI),XAX          IS THIS THE SOUGHT UCB   19084 58700002
         BCR     EIT,R5            RETURN                         19084 58800002
VUBUMP   LA    R6,TWO(R6)            NO. BUMP UCB ADDR PTR        19084 58900002
         B     VULOOK              GO LOOK AT NEXT UCB            19084 59000002
         SPACE 5                                                        59100002
COMPUNT  EQU   *                                               @YM07231 59200002
         BAL   R6,VMOVE           INSET UNIT IN MSG              Y02669 59300002
         MVC   XAI(EIT),COMPID    SET UP MESSAGE ID            @YM07231 59400002
         SR    R0,R0                                             Y02669 59500002
         TM    XAU,HEX80          IS IT A R/I COMMAND            Y02669 59600002
         BO    COMP2              YES, R0 IS PRESET            @YM07231 59700002
         IC    R0,XAU             GET CONSOLE ID IN R0           Y02669 59800002
COMP2    EQU   *                                               @YM07231 59900002
         MVC   XAT(TWENTY9),COMPMSG MOVE MESSAGE INTO BUFFER   @YM07231 59970002
         MVC   XAT+TWENTY9(FOR),ROUTDESC MOVE IN ROUTING AND   @YM07231*60040002
                                          DESCRIPTOR CODES     @YM07231 60110002
         LA    R6,FORTY9          OBTAIN SIZE OF MESSAGE ID    @YM07231 60200002
         B     VMSG1              GO ISSUE MSG                 @Z30LPTJ 60300003
         EJECT                                                          60400002
**************************************************               Y02651 60500002
*  THE LIST FORM OF THE DEQ MACRO FOLLOWS                        Y02651 60600002
*                                                                Y02651 60700002
IEFDEQUE DEQ   (IEFSQCBS,IEFQ4QCB,TWO,SYSTEM,IEFSQCBS,IEFVQCBS,SVN,    *60800002
               SYSTEM),RET=HAVE,MF=L                           @YM5443P 60830002
IEFVQCBS DC    C'VARYDEV'                                               60860002
IEFSQCBS DC    C'SYSIEFSD'                                       Y02651 60900002
IEFQ4QCB DC    C'Q4'                                             Y02651 61000002
**************************************************               Y02651 61100002
         EJECT                                                          61200002
*                                                                       61300002
*                                                                       61400002
VARYON   DC    C' ONLINE '         POSITIONAL OPERAND                   61500003
VARYOFF  DC    C' OFFLINE'         POSITIONAL OPERAND                   61600003
*                                                                       61700002
MCSFLAGS DC    B'1110000000000000'  MCS FLAGS=RESP AND REG0             61800002
*                                                                       61900002
ROUTDESC DC B'0000100000000000'        DESC CODE = 5                    62000002
         DC    B'0000000000000000'     ROUTCODE IS NONE                 62100002
*                                                                       62200002
VONID    DC    C'IEE302I '         MESSAGE ID FOR ONLINE                62300002
VOFFID   DC    C'IEE303I '         MESSAGE ID FOR OFFLINE               62400002
UNITERR  DC    C'IEE313I '         MSG ID FOR UNIT REF INVALID          62500002
UNITTXT  DC    C' UNIT REF INVALID'    MSG TEXT                         62600002
SS1ID    DC    C'IEE084I '                                     @Z30LPTJ 62630003
SS1TEXT  DC    C' 3851 PARAMETER MISSING'                      @Z30LPTJ 62660003
*                                                                       62700002
         DS    0F                                                       62800002
VCON904  DC    V(IEECB904)                                     @Z30LPTJ 62850003
         DC    X'0000'             MASK OF ZEROES                       62900002
VFFFF    DC    X'FFFF'             MASK FOR UCB TABLE END               63000002
COMPID   DC    C'IEE329I '         SYSTEM COMPONENT MESSAGE ID @YM07231 63100002
COMPMSG  DC    C' IN USE BY A SYSTEM COMPONENT' MESSAGE TEXT   @YM07231 63200002
LPARENI  DC    C'(I-'              BEGINNING OF A COMPOSITE             63300002
OUNITDSH DC    C'O-'               O-XXX SPECIFICATION                  63400002
*                                                                       63500002
*                                                                       63600002
*                                                                       63700002
PATCH    DC    CL65'***IEE3103D***'                            @Z30LPTJ 63800003
         EJECT                                                          63900002
UUCM     DSECT                                                          64000002
         IEECUCM  FORMAT=NEW                                            64100002
         EJECT                                                          64200002
SETXSA   DSECT                                                          64300002
         IEEXSA                                                         64400002
         EJECT                                                          65600002
SETCVT   DSECT                                                          65700002
         CVT                                                            65800002
         EJECT                                                          65900002
UCB      DSECT                                                          66000002
         IEFUCBOB                                                       66100002
         IECDIOCM                                                       66150003
         EJECT                                                          66200002
CHAIN1   DSECT                                                          66300002
         IEECHAIN                                                       66400002
         EJECT                                                          66500002
         IEEBASEA                                                       66600002
         EJECT                                                          66700002
         IHAPSA                                                         66800002
         END                                                            66900002
./  ADD  SSI=73180025,NAME=IEE3203D
         TITLE 'IEE3203D - VARY KEYWORD SCAN ROUTINE'             M4957 00200003
IEE3203D CSECT                                                          00400003
* (C) BEFORE PARENSCN   OPERAND COMPARE LENGTHS                @ZA07514 00450003
* (C) KEYTAB   ADDED LEFT PAREN TO COMPARE VALUES              @ZA07514 00500003
* (C) TABSCAN,TEST FOR ZERO OPERAND LENGTH                     @ZA27029 00550003
*********************************************************************** 00600003
*                                                                       00800003
* MODULE NAME       = IEE3203D                                          01000003
*    CSECT NAME     = IEE3203D                                          01200003
*                                                                       01400003
* LOAD MODULE NAME  = IGC0003D                                          01600003
*                                                                       01800003
* DESCRIPTIVE NAME  = VARY KEYWORD SCAN MODULE                          02000003
*                                                                       02200003
* COPYRIGHT         = MISSING                                           02400003
*                                                                       02600003
* STATUS            = OS/VS2 RELEASE 3                                  02800003
*                                                                       03000003
* FUNCTION          = THIS MODULE SCANS THE VARY PRIMARY KEYWORDS       03200003
*                     NET, CH, CPU, STOR, PATH, CN AND GIVES CONTROL TO 03400003
*                     THE ATCAM PROCESSOR FOR NET OR TO IEE0803D FOR    03600003
*                     THE OTHER KEYWORDS.  IF THERE IS NO MATCH ON THE  03800003
*                     PRIMARY KEYWORDS THEN THIS ROUTINE SCANS FOR THE  04000003
*                     SECONDARY KEYWORDS IN THE COMMAND FIELD AND THEN  04200003
*                     COMPARES THIS KEYWORD TO EACH ENTRY IN A TABLE    04400003
*                     OF VALID VARY KEYWORDS.  SUCH KEYWORDS ARE:       04600003
*                        ONLINE        HARDCPY                          05200003
*                        OFFLINE       MSTCONS                          05400003
*                        CONSOLE       ONTP/OFFTP (TCAM)                05600003
*                                                                       06400003
* OPERATION         = IEE3203D FIRST SCANS THE VARY COMMAND OPERAND FOR 06600003
*                     THE PRIMARY KEYWORD WHICH IS DEFINED AS THE WORD  06800003
*                     FOLLOWING THE VERB 'VARY'.                        07000003
*                     THE PRIMARY KEYWORDS THAT ARE SUPPORTED ARE:      07200003
*                        V NET   FOR ATCAM                              07400003
*                        V PATH  FOR MP                                 07600003
*                        V CH    FOR MP                                 07800003
*                        V CPU   FOR MP                                 08000003
*                        V STOR  FOR MP                                 08200003
*                        V CN    FOR SUBSYSTEM                          08300003
*                     IF NET IS FOUND THEN THIS ROUTINE WILL ROUTE      08400003
*                     TO THE ATCAM PROCESSOR TO SERVICE THE COMMAND.    08600003
*                     IF THE OTHERS ARE FOUND, THEN THIS ROUTINE WILL   08800003
*                     CHANGE THE VERB CODE IN THE XAN FOR THEM AS       09000003
*                     FOLLOWS:                                          09200003
*                        V PATH = X'50'                                 09400003
*                        V CH   = X'58'                                 09600003
*                        V CPU  = X'54'                                 09800003
*                        V STOR = X'5C'                                 10000003
*                        V CN   = X'78'                                 10100003
*                     AND CONTROL IS PASSED TO IEE0803D TO CREATE A     10200003
*                     CSCB FOR THEM SO THAT THEY CAN EVENTUALLY BE      10400003
*                     ATTACHED.                                         10600003
*                     IF NONE OF THE ABOVE, THEN THIS ROUTINE SCANS FOR 10800003
*                     THE SECONDARY KEYWORD WHICH IS DEFINED AS THE     11000003
*                     WORD FOLLOWING THE FIRST COMMA NOT EMBEDDED IN    11200003
*                     PARENS.  R9 IS USED TO INDEX THROUGH THE OPERAND  11400003
*                     TO FIND THE ',KEYWORD'.  COMMANDS OF THE FOLLOW-  11600003
*                     ING FORMS ARE ACCEPTABLE:                         11800003
*                        V ,SECONDARY KEYWORD                           11900003
*                        V UNIT,SECONDARY KEYWORD                       12000003
*                        V UNIT,(MULTIPLE UNITS),SECONDARY KEYWORD      12200003
*                        V (MULTIPLE UNITS),SECONDARY KEYWORD           12400003
*                        V (MULTIPLE UNITS),UNIT,SECONDARY KEYWORD      12600003
*                     (ANY NUMBER OF BALANCED INNER/OUTER PARENS MAY BE 12800003
*                     SPECIFIED)                                        13000003
*                     WHEN THE COMMA PRECEDING THE KEYWORD IS FOUND, A  13200003
*                     POINTER TO THE START OF THE KEYWORD IS SAVED AND  13400003
*                     THE SCAN CONTINUES UNTIL A COMMA, BLANK OR THE    13600003
*                     END OF BUFFER IS FOUND.  WHEN THE COMPLETE        13800003
*                     KEYWORD IS FOUND, IT IS COMPARED TO EACH ENTRY    14000003
*                     IN THE VALID KEYWORD TABLE UNTIL A MATCH OR THE   14200003
*                     END OF THE TABLE IS FOUND. EACH ENTRY CONSISTS    14400003
*                     OF AN EIGHT (8) BYTE KEYWORD FOLLOWED BY THE      14600003
*                     ADDRESS OF THE RESPECTIVE PROCESSOR.              14800003
*                     THE TABLE SCAN IS DONE BY ESTABLISHING ADDRESS-   15000003
*                     ABILITY TO THE TABLE AND THEN INCREMENTING THE    15200003
*                     BASE REGISTER BY THE LENGTH OF AN ENTRY AS EACH   15400003
*                     NON-MATCH IS FOUND.  THIS METHOD INSURES FUTURE   15600003
*                     FLEXIBILITY BECAUSE NO MATTER HOW MANY NEW        15800003
*                     KEYWORDS ARE ADDED TO THE TABLE, THE LABEL        16000003
*                     'KEYTAB', WITH AN INDEX WILL ALWAYS POINT TO THE  16200003
*                     CURRENT KEYWORD AND ITS EXITING POINT.  WHEN A    16400003
*                     MATCH IS FOUND, EXIT IS MADE BY BRANCHING TO THE  16600003
*                     MODULE INDICATED IN THE TABLE.  FOR AN ERROR,     16800003
*                     EXIT IS MADE TO IEE0503D.  WHEN AN 'OFFLINE' OR   16880003
*                     'ONLINE' KEYWORD IS FOUND WITH A ',S', THIS       16960003
*                     INDICATES A SS/1 VARY REQUEST.  CONTROL IS THEN   17040003
*                     PASSED TO IEE9403D.                               17200003
*                                                                       17320003
* NOTES                                                                 17400003
*    DEPENDENCIES   = KEYWORDS SUCH AS ONLINE/OFFLINE/CONSOLE/HARDCPY/  17600003
*                     MSTCONS/ONTP/OFFTP ARE STANDARD.                  17800003
*                     THE NET (ATCAM), AND CH, CPU, STOR, PATH, AND CN  18000003
*                     PRIMARY KEYWORDS ARE CONSIDERED STANDARD ALSO.    18200003
*    CHARACTER/CODE DEPENDENCIES                                        18400003
*                   = THIS MODULE CAN BE ASSEMBLED WITH ANY NEW         18600003
*                     CHARACTER/CODE SET.                               18800003
*                                                                       19000003
* RESTRICTIONS      = ON ENTRY, REG2 PTR TO THE PARAM LIST (XSA)        19200003
* REGISTER CONVENTIONS                                                  19400003
*                   = REGISTERS ARE DEFINED AT LABEL: DEFREG            19600003
*    PATCH LABEL    = N/A                                               19800003
*                                                                       20000003
* MODULE TYPE       = CSECT                                             20200003
*    PROCESSOR      = ASSEMBLER                                         20400003
*    MODULE SIZE    = VS/2 R3  = X'3A6'                        @ZM30466 20600003
*    ATTRIBUTES     = REENTRANT, REUSABLE, REFRESHABLE, PAGED LPA,      20800003
*                     ZERO PSW PROTECT KEY, SUPERVISOR MODE             21000003
*                                                                       21200003
* ENTRY POINTS      = IEE3203D FROM COMMAND ROUTER RTN IEE0403D         21400003
*   PURPOSE         = VARY COMMAND ROUTER                               21600003
*   LINKAGE         = BRANCH                                            21800003
*   INPUT           = XSA PTR IN REG 2                                  22000003
*                     THE XSA CONTAINS:                                 22200003
*                        PTR TO PARMLIST IN XAR                         22400003
*                        PTR TO LIST AND VERB CODE IN XAL               22600003
*                        VERB = VARY IN XAV                             22800003
*                        UCM ID IN XAU                                  23000003
*   REGISTERS SAVED = NONE                                              23200003
*   REGISTER USAGE  = R2  = XSA BASE                                    23400003
*                     R4  = COUNTER FOR KEYWORD CHARACTER               23600003
*                     R6  = PTR TO FIRST CHARACTER OF KEYWORD           23800003
*                     R7  = END OF BUFFER REG                           24000003
*                     R9  = PTR TO CURRENT CHARACTER OF OPERAND FIELD   24200003
*                     R11 = BASE FOR VALID KEYWORD TABLE                24400003
*                     R12 = ADDRESSABILITY                              24600003
*   REGISTERS RESTORED                                                  24800003
*                   = NONE                                              25000003
*                                                                       25200003
* EXITS - NORMAL    =  IN THIS SYSTEM IEE3203D EXITS TO:                25400003
*   CONDITIONS           IEE0803D FOR KEYWORDS - ONLINE, CONSOLE        25600003
*                                                AND OFFLINE            25800003
*                        IEE4703D FOR KEYWORDS - HARDCPY                26000003
*                        ISTCFF3D FOR KEYWORDS(PRIMARY) - NET           26200003
*                        IEE0803D FOR KEYWORDS(PRIMARY) - CH, CPU,      26400003
*                                     PATH, STOR, AND CN                26600003
*                        IEE4303D FOR KEYWORDS - MSTCONS                26800003
*                        IED1303D FOR KEYWORDS - ONTP, OFFTP            26900003
*                        IEE9403D FOR KEYWORDS - ONLINE AND OFFLINE     27000003
*                                      WITH SS/1 PARAMETER              27100003
*   OUTPUT          = SAME AS INPUT TO THIS MODULE                      27200003
*   RETURN CODES    = NONE                                              27400003
*                                                                       27600003
* EXITS - ERROR     = EXIT TO MESSAGE MODULE IEE0503D                   27800003
*   CONDITIONS      = WHEN AN ERROR IS DETECTED                         28000003
*   OUTPUT          = REG 2 PTS TO THE XSA WHICH CONTAINS:              28200003
*                     ERROR MSG CODE IN THE XAE                         28400003
*                     VERB IN THE XAV                                   28600003
*                     UCM ID IN THE XAU                                 28800003
*   RETURN CODES    = NONE                                              29000003
*                                                                       29200003
* EXTERNAL REFERENCES                                                   29400003
*   ROUTINES        = ISTCFF3D  FOR NET IN ATCAM                        29600003
*                   = IEE0803D  FOR CH, CPU, STOR, PATH, AND CN         29800003
*                     IEE0803D  FOR OFFLINE/ONLINE/CONSOLE              30000003
*                     IEE4703D  FOR HARDCPY                             30200003
*                     IEE4303D  FOR MSTCONS                             30400003
*                     IED1303D  FOR ONTP/OFFTP                          30600003
*                     IEE0503D  FOR ERROR MESSAGES                      30800003
*                     IEE9403D  FOR OFFLINE/ONLINE WITH ',S'            30900003
*   DATA AREAS      = SEE EXITS - OUTPUT DATA                           31000003
*                                                                       31200003
* CONTROL BLOCKS    = EXTENDED SAVE AREA (XSA)                          31400003
*                        FOR FORMAT SEE - INPUT DATA AND                31600003
*                        OUTPUT DATA SECTIONS                           31800003
*                                                                       32000003
* TABLES            = NONE                                              32200003
*                                                                       32400003
* MACROS            = NONE                                              32600003
*                                                                       32800003
* MAPPING MACROS    = IEEXSA                                            33000003
*    SERIALIZATION = NONE REQUIRED IN THIS MODULE                       33200003
*                                                                       33400003
* CHANGE LEVEL      = Y02669, Y02674, Z30LPTJ, Z309PTJ,        @ZM30466 33600003
*                     ZM30466,ZA07514,ZA27029                  @ZA27029 33700003
*                                                                       33800003
* CHANGE ACTIVITY  = N/A                                                34000003
*                                                                       34200003
* MESSAGES          = 'IEE307I VARY DELIMITER ERROR'                    34400003
*                        WHEN THERE IS:                                 34410003
*                         A) NO COMMA AFTER PARENTHESES                 34420003
*                         B) UNBALANCED PARENTHESES                     34430003
*                         C) NO COMMA BEFORE KEYWORD                    34440003
*                         D) A KEYWORD FOUND IN A SET OF PARENTHESIS    34445003
*                         E) A SET OF PARENTHESIS THAT DOES NOT START   34446003
*                            IN THE FIRST POSITION FOR SECONDARY KYWDS  34447003
*                         F) MULTIPLE COMMA BEFORE KEYWORD     @ZA27029 34448003
*                     'IEE308I VARY TERM LENGTH ERROR'                  34450003
*                        WHEN COMMAND CONTAINS AT LEAST ONE BLANK       34460003
*                     'IEE309I VARY UNIDENTIFIABLE KEYWORD'             34470003
*                        WHEN KEYWORD DOES NOT MATCH ANY TABLE ENTRY    34480003
*                     'IEE311I VARY PARAMETER MISSING'                  34490003
*                        WHEN THERE IS:                                 34500003
*                         A) NO POINTER TO THE COMMAND PARAMETER LIST   34600003
*                         B) NO UNIT SPECIFIED BEFORE CERTAIN           34680003
*                            SECONDARY KEYWORDS                         34720003
*                     'IEE312I VARY PARAMETERS CONFLICT'                34760003
*                        WHEN A VARY CONSOLE COMMAND IS SPECIFIED WITH  34840003
*                        A SS/1 PARAMETER                               34920003
*                     'IEE908I VARY CMD LENGTH EXCEEDS MAX.'            36200003
*                        WHEN A VARY ONLINE/OFFLINE/CONSOLE COMMAND'S   36400003
*                        PARAMETER LIST IS GREATER THAN 124 CHARACTERS, 36480003
*                        OR WHEN A VARY ONLINE/OFFLINE WITH ',S'        36560003
*                        COMMAND'S PARAMETER LIST IS GREATER THAN 126   36640003
*                        CHARACTERS                                     36720003
*                                                                       36950003
* ABEND CODES       = NONE                                              37000003
*                                                                       37200003
* PACKAGING         = IEE3203D WILL BE PART OF LOAD MODULE              37400003
*                        = IGC0003D                                     37600003
*                     THIS LOAD MODULE ALIASES ARE                      37800003
*                        = NONE                                         38000003
*                     THIS LOAD MODULE ENTRY POINTS ARE                 38200003
*                        = IGC0003D                                     38400003
*                     MODULE WILL RESIDE IN: LPALIB                     38600003
*                                                                       38800003
* SYSGEN            = SUPPLIED BY SECTIONS:                             39000003
*                        LOAD MODULE NAME                               39200003
*                        PACKAGING                                      39400003
*                                                                       39600003
* SYSTEM LIBRARIES  = NONE                                              39800003
*                                                                       40000003
*********************************************************************** 40200003
          EJECT                                                         40400003
*  REGISTER ASSIGNMENTS                                                 40600003
*                                                                       40800003
DEFREG   EQU   *                                                 Y02669 41000003
R1       EQU   1                                                        41200003
R2       EQU   2              XSA BASE                                  41400003
R3       EQU   3                                                        41600003
R4       EQU   4              COUNTER FOR KEYWORD CHARC.                41800003
R5       EQU   5                                                        42000003
R6       EQU   6              PTR TO FIRST CHAR OF KEYWORD              42200003
R7       EQU   7                   POINTER TO END OF BUFFER             42400003
R8       EQU   8                   WORK REG                             42600003
R9       EQU   9                   PTR TO CURRENT CHAR OF OPERAND FIELD 42800003
R10      EQU   10                                                       43000003
R11      EQU   11                  BASE FOR VALID KEYWORD TABLE         43200003
R12      EQU   12                  PGM BASE                             43400003
R13      EQU   13                                                       43600003
R14      EQU   14                                                       43800003
R15      EQU   15                                                       44000003
*    EQUATES                                                            44200003
C0       EQU   0                                                        44400003
C1       EQU   1                                                        44600003
C2       EQU   2                                                        44800003
C3       EQU   3                                                        45000003
C4       EQU   4                                                        45200003
C5       EQU   5                                               @ZA07514 45250003
C6       EQU   6                                                 Y02669 45400003
C7       EQU   7                                                 Y01029 45600003
C8       EQU   8                                                        45800003
D124     EQU   124                                                      46000003
D126     EQU   126                                             @Z30LPTJ 46100003
ERRX39   EQU   X'39'                                             Y02669 46200003
LENG     EQU   12           LENGTH OF KEYWORD-MODULE CODE ENTRY  Y01029 46400003
COMMA    EQU   C','                COMMA CHAR                           46600003
LFTPAREN EQU   C'('                LEFT PAREN CHAR                      46800003
RGTPAREN EQU   C')'                RIGHT PAREN CHAR                     47000003
BLANK    EQU   C' '                BLANK CHAR                           47200003
PARENSW  EQU   3                   SWITCH FOR BALANCED PARENS           47400003
ERR7     EQU   07                  ERROR CODE   DELIM ERROR             47600003
ERR8     EQU   8                   ERROR CODE   TERM LENGTH    @Z309PTJ 47650003
ERR9     EQU   9                   ERROR CODE   UNIDENT KEYWORD         47700003
ERR11    EQU   11                  ERROR CODE   PARAM MISSING           47800003
ERR12    EQU   12                  ERROR CODE   PARAMETER CONFLICT      47900003
CHCODE   EQU   X'58'                                             Y02669 48200003
CPUCODE  EQU   X'54'                                             Y02669 48400003
STORCODE EQU   X'5C'                                             Y02669 48600003
PATHCODE EQU   X'50'                                             Y02669 48800003
CNCODE   EQU   X'78'                                           @Z309PTJ 49000003
         EJECT                                                          49200003
*********************************************************************** 49400003
* FUNCTIONS OF THIS ROUTINE-                                          * 49600003
*     1. ESTABLISHES PROGRAM AND XSA ADDRESSABILITY                   * 49800003
*     2. INITIALIZES A BALANCED PAREN SWITCH AND A CHARACTER COUNTER  * 50000003
*     3. CHECKS XAL FOR 0. (IF 0, BRANCHES TO ERROR ROUTINE.)         * 50200003
*     4. COMPUTES THE END OF BUFFER                                   * 50400003
*********************************************************************** 50600003
         BALR  R12,C0              ESTABLISH PGM ADDRESSABILITY         50800003
         USING *,R12                                                    51000003
         MODID BR=YES                                            Y01886 51200003
         USING XSA,R2              BASE FOR EXTENDED SAVE AREA          51400003
         L     R9,XAL              REG 9 POINTS TO OPERAND FIELD OF    *51600003
                                   VARY COMMAND                         51800003
         LA    R9,C0(R9)           ZERO OUT HIGH ORDER BYTE             52000003
         LA    R5,ERR11            SET ERR CODE FOR MSG 'PARAM MISSING' 52100003
         LTR   R9,R9               IS PARAMETER PTR 0 (NO KEYWORD)      52200003
         BZ    ERREXIT             YES,PTR IS 0, GO TO ERROR ROUTINE    52600003
         L     R7,XAR              LOAD POINTER TO THE BUFFER THAT      52800003
         LA    R7,C0(R7)           CONTAINS THE VARY COMMAND            53000003
         AH    R7,C0(R7)           COMPUTE END OF BUFFER                53200003
         CLC   C0(C4,R9),CNET        IS IT 'NET'FOR VTAM       @ZA07514 53600003
         BE    VTAMEXT               YES, EXIT TO VTAM MOD.      Y02674 53800003
         CLC   C0(C3,R9),CCH        IS IT CHANNEL FOR MP       @ZA07514 54000003
         BE    CHANNEL               YES,CHANGE CODE AND EXIT    Y02669 54200003
         CLC   C0(C4,R9),CCPU        IS IT CPU FOR MP          @ZA07514 54400003
         BE    CPU                   YES, CHANGE CODE AND EXIT   Y02669 54600003
         CLC   C0(C5,R9),CSTOR       IS IT STOR FOR MP         @ZA07514 54800003
         BE    STORAGE               YES, CHANGE CODE AND EXIT   Y02669 55000003
         CLC   C0(C5,R9),CPATH       IS IT PATH FOR MP         @ZA07514 55200003
         BE    PATH                  YES, CHANGE CODE AND EXIT   Y02669 55400003
         CLC   C0(C3,R9),CCN         IS IT CN FOR SUBSYSTEM?   @ZA07514 55460003
         BE    CN                    YES, CHANGE CODE AND EXIT @Z309PTJ 55530003
* NO PRIMARY KEYWORD, SET UP AND CHECK THE SECONDARY KEYWORDS    Y02669 55600003
*                                                                Y02669 55800003
         SR    PARENSW,PARENSW     INITIALIZE PAREN SWITCH TO 0         56000003
         SR    R4,R4               INITIALIZE CHARACTER COUNTER TO 0    56200003
         EJECT                                                          56400003
*********************************************************************** 56600003
* THE COMMAND OPERAND IS SCANNED FOR A LEFT PAREN OR A COMMA.  IF A   * 56700003
* COMMA IS FOUND IN THE FIRST POSITION, A CHECK IS MADE TO SEE IF THE * 56800003
* KEYWORD AFTER THE COMMA IS VALID FOR THIS CASE.  IF NOT, AN ERROR   * 56860003
* EXIT IS MADE TO ISSUE AN IEE311I MESSAGE TO THIS EFFECT.  IF A LEFT * 56920003
* PARENTHESIS IS FOUND, THE OPERAND IS SCANNED FOR BALANCED PARENS    * 57000003
* AND THEN THE KEYWORD.  IF THERE IS NO LEFT PAREN, AND A COMMA IS    * 57200003
* FOUND IN THE SCAN, THE KEYWORD SHOULD FOLLOW.                       * 57400003
*********************************************************************** 57600003
         CLI   C0(R9),COMMA        IS FIRST CHAR. A COMMA?     @Z309PTJ 57620003
         BNE   PARENSCN            NO, START SCANNING          @Z309PTJ 57640003
         CLC   C1(C7,R9),ONL       IS IT 'ONLINE' PLUS BLANK?  @ZM30466 57740003
         BE    ERREXIT             YES, TAKE ERROR EXIT        @ZM30466 57780003
         CLC   C1(C7,R9),ONLCOMA   IS IT 'ONLINE' PLUS COMMA?  @ZM30466 57781003
         BE    ERREXIT             YES, TAKE ERROR EXIT        @ZM30466 57782003
         CLC   C1(C8,R9),OFL       IS IT 'OFFLINE' PLUS BLANK? @ZM30466 57783003
         BE    ERREXIT             YES, TAKE ERROR EXIT        @ZM30466 57784003
         CLC   C1(C8,R9),OFLCOMA   IS IT 'OFFLINE' PLUS COMMA? @ZM30466 57785003
         BE    ERREXIT             YES, TAKE ERROR EXIT        @ZM30466 57786003
         CLC   C1(C8,R9),CONS      IS IT 'CONSOLE' PLUS BLANK? @ZM30466 57787003
         BE    ERREXIT             YES, TAKE ERROR EXIT        @ZM30466 57788003
         CLC   C1(C8,R9),CONSCOMA  IS IT 'CONSOLE' PLUS COMMA? @ZM30466 57789003
         BE    ERREXIT             YES, TAKE ERROR EXIT        @ZM30466 57790003
         CLC   C1(C8,R9),MSTC      IS IT 'MSTCONS' PLUS BLANK? @ZM30466 57791003
         BE    ERREXIT             YES, TAKE ERROR EXIT        @ZM30466 57792003
         CLC   C1(C8,R9),MSTCCOMA  IS IT 'MSTCONS' PLUS COMMA? @ZM30466 57794003
         BE    ERREXIT             YES, TAKE ERROR EXIT        @ZM30466 57796003
PARENSCN EQU   *                                                        57800003
         SR    R6,R6               CLEAR 'BIT TEST' REGISTER   @Z30LPTJ 57830003
         CLI   C0(R9),LFTPAREN     IS FIRST CHAR. A '('?       @Z30LPTJ 57860003
         BNE   SCANCHAR            NO, AVOID INDICATOR SETTING @Z30LPTJ 57890003
         LA    R6,C1(R6)           YES, SET INDICATOR          @Z30LPTJ 57920003
SCANCHAR EQU   *                                               @Z30LPTJ 57950003
         CLI   C0(R9),LFTPAREN     IS CURRENT CHAR. A '('?     @Z30LPTJ 58000003
         BE    INCSWTCH            YES,GO TO CHECK FOR BAL PARENS       58200003
         CLI   C0(R9),COMMA        IS CURRENT CHAR A COMMA              58400003
         BE    SAVEPTR             YES, GO TO SCAN KEYWORD              58600003
         CLI   C0(R9),BLANK        IS CURRENT CHAR. A BLANK?   @Z309PTJ 58660003
         BE    TERMERR             YES, TAKE ERROR EXIT        @Z309PTJ 58730003
         CLI   C0(R9),RGTPAREN     A RIGHT PARENTHESIS EXISTS? @Z30LPTJ 58750003
         BE    DELIMERR            YES, TAKE ERROR EXIT        @Z30LPTJ 58770003
         LA    R9,C1(R9)           INCREMENT PTR TO NEXT CHAR           58800003
         CR    R9,R7               HAS END OF BUFFER BEEN REACHED       59000003
         BE    DELIMERR            YES,GO TO ERR RTN, COMMA MISSING     59200003
         B     SCANCHAR            GO BACK TO CHECK NEXT CHAR. @Z30LPTJ 59400003
*********************************************************************** 59600003
* THIS ROUTINE SCANS THE PARAMETER LIST FOR BALANCED PARENS. WHEN A   * 59800003
* LEFT PAREN IS FOUND, PARENSW IS INCREMENTED BY 1, FOR A RIGHT PAREN * 60000003
* IT IS DECREMENTED BY 1. WHEN PARENSW IS 0, BALANCED PARENS HAVE BEEN* 60200003
* FOUND, AND A COMMA AND THE KEYWORD SHOULD FOLLOW.                   * 60400003
*********************************************************************** 60600003
INCSWTCH LA    PARENSW,C1(PARENSW) INCREMENT BY 1 FOR LEFT PAREN        60800003
         CLI   C1(R9),BLANK        IS NEXT CHARACTER A BLANK?  @Z309PTJ 60860003
         BE    TERMERR             YES, TAKE ERROR EXIT        @Z309PTJ 60930003
CHARSCAN LA    R9,C1(R9)           INCREMENT PTR TO NEXT CHAR           61000003
         CLI   C0(R9),LFTPAREN     IS CURRENT CHAR A LEFT PAREN         61200003
         BE    INCSWTCH            YES,CHAR IS'(',SET SWTCH,CHECK AGAIN 61400003
         CLI   C0(R9),BLANK        IS CURRENT CHAR. A BLANK?   @Z309PTJ 61460003
         BE    TERMERR             YES, TAKE ERROR EXIT        @Z309PTJ 61530003
         CLI   C0(R9),RGTPAREN     IS CURRENT CHAR A RIGHT PAREN        61600003
         BNE   CHKSWTCH            NO,CHECK PAREN SWITCH FOR 0          61800003
         BCTR  PARENSW,C0          DECREMENT BY 1 FOR RIGHT PAREN       62000003
CHKSWTCH LTR   PARENSW,PARENSW     IS SWITCH 0 (BALANCED PARENS)        62200003
         BZ    KEYSCAN             YES,GO TO SCAN KEYWORD AFTER PARENS  62400003
         CLI   C0(R9),COMMA        IS THE CHARACTER A COMMA?   @Z30LPTJ 62420003
         BNE   CHKBUFF             NO, CHECK FOR END OF BUFFER @Z30LPTJ 62440003
         CLC   C1(C6,R9),ONL       IS IT AN 'ONLINE' KEYWORD?  @Z30LPTJ 62460003
         BE    DELIMERR            YES, TAKE ERROR EXIT        @Z30LPTJ 62480003
         CLC   C1(C7,R9),OFL       IS IT AN 'OFFLINE' KEYWORD? @Z30LPTJ 62500003
         BE    DELIMERR            YES, TAKE ERROR EXIT        @Z30LPTJ 62520003
         CLC   C1(C7,R9),CONS      IS IT A 'CONSOLE' KEYWORD?  @Z30LPTJ 62540003
         BE    DELIMERR            YES, TAKE ERROR EXIT        @Z30LPTJ 62560003
CHKBUFF  EQU   *                                               @Z30LPTJ 62580003
         CR    R9,R7               NO, CHECK FOR END OF BUFFER REACHED  62600003
         BNE   CHARSCAN            NO,GO BACK TO CHECK NEXT CHAR        62800003
DELIMERR LA    R5,ERR7             DELIM ERR UNBAL PARENS OR NO COMMA   63000003
         B     ERREXIT             GO TO ERROR RTN TO SET UP XCTL       63200003
TERMERR  EQU   *                                               @Z309PTJ 63250003
         LA    R5,ERR8             SET TERM LENGTH ERROR CODE  @Z309PTJ 63300003
         B     ERREXIT             GO TO ERROR EXIT ROUTINE    @Z309PTJ 63350003
         EJECT                                                          63400003
*********************************************************************** 63600003
* THIS ROUTINE CHECKS FOR A COMMA PRECEDING A KEYWORD AND IF THE COMMA* 63800003
* IS PRESENT, SCANS THE KEYWORD. A POINTER TO THE FIRST CHAR OF THE   * 64000003
* KEYWORD IS SAVED. (A KEYWORD IS DEFINED AS THE FIRST WORD FOLLOWING * 64200003
* A COMMA NOT EMBEDDED IN PARENS.) THE KEYWORD IS COMPLETE WHEN A     * 64400003
* COMMA, A BLANK, OR END OF BUFFER IS FOUND.                          * 64600003
*********************************************************************** 64700003
KEYSCAN  EQU   *                                                        64800003
         LTR   R6,R6               IS FIRST CHAR. A '('?       @Z30LPTJ 64860003
         BZ    DELIMERR            NO, TAKE ERROR EXIT         @Z30LPTJ 64920003
         LA    R9,C1(R9)           INCREMENT PTR TO NEXT CHAR           65000003
         CLI   C0(R9),COMMA        IS CURRENT CHAR A COMMA              65200003
         BNE   DELIMERR            NO.COMMA MUST PRECEDE KEYWORD        65400003
SAVEPTR  LA    R6,C1(R9)           SAVE PTR TO 1ST CHAR OF KEYWORD      65600003
SCAN1    LA    R9,C1(R9)           INCREMENT PTR TO CURR CHAR OF KEYWD  65800003
         CLI   C0(R9),COMMA        IS CURRENT CHAR A COMMA              66000003
         BE    TABSCAN             YES,COMMA MEANS END OF KEYWD FOUND   66200003
         CLI   C0(R9),BLANK        NO,CHECK CURRENT CHAR FOR BLANK      66400003
         BE    TABSCAN             YES,BLANK MEANS END OF KEYWD FOUND   66600003
         CR    R9,R7               NO,CHECK FOR END OF BUFFER           66800003
         BE    TABSCAN             GO TO SCAN TABLE                     67000003
         LA    R4,C1(R4)           INCREMENT KEYWORD CHAR COUNTER       67200003
         B     SCAN1               GO BACK TO CHECK NEXT CHAR OF KEYWD  67400003
         EJECT                                                          67600003
*********************************************************************** 67800003
* THIS ROUTINE COMPARES THE KEYWORD WITH EACH ENTRY IN A TABLE OF     * 68000003
* VALID VARY KEYWORDS UNTIL A MATCH, OR THE END OF THE TABLE IS FOUND.* 68200003
* WHEN A MATCH IS FOUND, THE ADDRESS FOLLOWING THE KEYWORD IN   Y01029* 68400003
* THE TABLE IS USED TO EXIT BY.                                 Y01029* 68600003
*********************************************************************** 68800003
TABSCAN  EQU   *                                                        69000003
         LA    R11,KEYTAB          PUT ADDRESS OF KEYWORD TABLE IN A    69200003
         USING KEYTAB,R11          REG AND ESTABLISH ADDRESSABILITY     69400003
         LA    R8,TABEND           PUT ADDRESS OF END OF TABLE IN A REG 69600003
         LTR   R4,R4               VALID OPERAND LENGTH        @ZA27029 69650003
         BZ    DELIMERR            NO, SET ERROR CODE          @ZA27029 69700003
         BCTR  R4,C0               DECREMENT CHAR COUNTER FOR EX INSTR  69800003
         LA    R5,ERR9             PRESET CODE FOR UNIDENT KEYWORD MSG  69900003
SCAN2    EQU   *                                                        70000003
         CLR   R11,R8              HAS END OF TABLE BEEN REACHED        70200003
         BH    ERREXIT             YES, THE VERB IS INVALID             70600003
         EX    R4,DOCLC            INSERT KEYWORD LENGTH IN CLC INSTR   70800003
         BE    XMOD                IF KEYWDS MATCH,GOTO SET UP EXIT MOD 71000003
INCPTR   LA    R11,LENG(R11)       IF NOT, INCREMENT PTR TO NEXT KEYWD  71200003
         B     SCAN2         GO TO CHECK NEXT ENTRY                     71400003
XMOD     LA    R3,C1(R11)          COMPUTE A POINTER TO THE FIRST       71600003
         AR    R3,R4               CHARACTER AFTER THE KEYWORD          71800003
         CLI   C7(R11),BLANK           IF THE EIGHTH CHARACTER   Y01029 72000003
*                      OF THE TABLE ENTRY IS NOT A BLANK, THE    Y01029 72200003
*                      KEYWORD IS EIGHT CHARACTERS.  IT IS A     Y01029 72400003
*                      MATCH AND EXIT SHOULD BE MADE TO THE      Y01029 72600003
*                      MODULE INDICATED IN THAT TABLE ENTRY      Y01029 72800003
         BNE   EXIT                    BRANCH TO APPROPRIATE RT  Y01029 73000003
         CLI   C0(R3),BLANK        IS THE CHARACTER BLANK               73200003
         BNE   INCPTR              IF NOT, A FALSE MATCH HAS BEEN FOUND 73400003
*                                  EG. KEYWORD 'ABC' WOULD MATCH TABLE  73600003
*                                  ENTRY 'ABCD' BECAUSE ONLY THE FIRST  73800003
*                                  3 CHARACTERS WERE COMPARED.          74000003
         DROP  R11                                             @Z30LPTJ 74050003
         EJECT                                                          74100003
*                                                                       74400003
*  THIS CODE WAS ADDED FOR THE ONLINE/OFFLINE/CONSOLE KEYWORDS   Y02669 74600003
*  BECAUSE SINCE THEY ARE ATTACHED TASKS, A CSCB IS CREATED FOR  Y02669 74800003
*  THEM WHOSE COMMAND BUFFER LENGTH IS ONLY 124 BYTES.           Y02669 75000003
*  IF THE COMMAND WAS ISSUED FROM A CONSOLE WHOSE CHARACTER SPAN Y02669 75200003
*  IS GREATED THAN 124 CHARACTERS, THE COMMAND WILL BE TRUNCATED Y02669 75400003
*  AND SUBSEQUENTLY, VARY PROCESSORS WILL THINK IT IS INVALID.   Y02669 75600003
*  TO PREVENT THIS EARLY, A SCAN IS DONE OF THE PARM LIST OF THE Y02669 75800003
*  BUFFER AND IF IT EXCEEDS 124 CHARACTERS, MSG 'IEE908I VARY    Y02669 76000003
*  CMD LENGTH EXCEEDS MAX.' WILL BE ISSUED IMMEDIATELY AND THE   Y02669 76200003
*  COMMAND WILL NOT BE PROCESSED.                                Y02669 76400003
*                                                                Y02669 76600003
EXIT     EQU   *                                                 Y01029 76700003
         LR    R3,R11     SAVE REG11 PTR SINCE IT WILL BE USED   Y02669 76800003
         CLC   C0(C6,R11),ONL     IS IT AN ONLINE COMMAND        Y02669 77000003
         BE    BUFFCHK            YES, GO CHECK BUFFER LENGTH    Y02669 77200003
         CLC   C0(C7,R11),OFL     IS IT AN OFFLINE COMMAND       Y02669 77400003
         BE    BUFFCHK            YES, GO CHECK BUFFER LENGTH    Y02669 77600003
         CLC   C0(C7,R11),CONS    IS IT A CONSOLE COMMAND        Y02669 77800003
         BE    BUFFCHK            YES, GO CHECK BUFFER LENGTH    Y02669 78000003
*  IT IS NOT THE ABOVE, THEREFORE CAN EXIT NORMALLY              Y02669 78200003
*                                                                Y02669 78400003
EXITOK   EQU   *                                                 Y02669 78600003
         LR    R11,R3             RESTORE REG11                  Y01029 78800003
         L     R15,C8(R11)             GET ADDRESS OF EXIT RT    Y01029 79000003
         BR    R15                     EXIT TO APPROPRIATE RT    Y01029 79200003
BUFFCHK  EQU   *                                                 Y02669 79600003
         L     R9,XAL             PTR TO LIST POSITION OF PARAM  Y02669 79800003
         LA    R9,C0(R9)                                         Y02669 80000003
         LA    R10,C1             INCREMENTER                    Y02669 80200003
         LR    R11,R7             OBTAIN END OF BUFFER POINTER          80400003
         BCTR  R11,C0             MINUS ONE                      Y02669 81000003
EOBLOOP  EQU   *                                                 Y02669 81200003
         CLI   C0(R9),BLANK  IS THE NEXT CHAR AN ENDING BLANK    Y02669 81400003
         BE    EXITCHK            YES GO COMPUT LENTH OF CMD     Y02669 81600003
         CLC   C0(C3,R9),SS1      NEXT 3 CHAR INDICATE A SS/1  @Z30LPTJ*81660003
                                   REQUEST?                    @Z30LPTJ 81680003
         BE    SS1YES             YES, BRANCH                  @Z30LPTJ 81700003
         CLC   C0(C3,R9),SS1COMMA NEXT 3 CHAR INDICATE A SS/1  @Z30LPTJ*81720003
                                   REQUEST?                    @Z30LPTJ 81740003
         BE    SS1YES             YES, BRANCH                  @Z30LPTJ 81760003
         BXLE  R9,R10,EOBLOOP     NO GO CHECK NEXT CHARACTER     Y02669 81800003
*                                                                Y02669 82000003
EXITCHK  EQU   *                                                 Y02669 82200003
         L     R10,XAL            POINTER TO BEGINNING           Y02669 82400003
         LA    R10,C0(R10)                                       Y02669 82600003
         SR    R9,R10             SIZE OF CMD IN REG9            Y02669 82800003
         LA    R10,D124           MAX SIZE                       Y02669 83000003
         CR    R9,R10             IS IT LONGER OR NOT?           Y02669 83200003
         BNH   EXITOK             NO, IT IS SAFE, GO PROCESS CMD Y02669 83600003
SIZEERR  EQU   *                                               @Z30LPTJ 83900003
         LA    R5,ERRX39          ERROR CODE                     Y02669 84200003
         EJECT                                                          84800003
*********************************************************************** 85000003
* EXIT ROUTINE-                                                       * 85200003
* THE CORRECT ERROR CODE IS PUT IN XAE IN THE XSA AND CONTROL   Y01029* 85400003
* IS PASSED TO IEE0503D                                         Y01029* 85600003
*********************************************************************** 85800003
ERREXIT  EQU   *                                                        86000003
         STC   R5,XAE              PUT ERROR CODE IN XAE                86200003
         L     R15,VCON05              GET ADDRESS OF IEE0503D   Y01029 86400003
         BR    R15                     BRANCH TO IEE0503D        Y01029 86600003
*                                                                       86800003
SS1YES   EQU   *                                               @Z30LPTJ 86810003
         CLC   C0(C7,R3),CONS     IS IT CONSOLE KEYWORD?       @Z30LPTJ 86814003
         BE    SS1ERROR           YES, ERROR                   @Z30LPTJ 86818003
         LA    R9,C2(R9)          INCREMENT COUNTER FOR SS/1   @Z30LPTJ 86822003
SS1LOOP  EQU   *                                               @Z30LPTJ 86826003
         CLI   C0(R9),BLANK       AN ENDING BLANK CHARACTER?   @Z30LPTJ 86830003
         BE    ENDLOOP            YES, COMPUTE COMMAND LENGTH  @Z30LPTJ 86834003
         BXLE  R9,R10,SS1LOOP     NO, CHECK NEXT CHARACTER     @Z30LPTJ 86838003
ENDLOOP  EQU   *                                               @Z30LPTJ 86842003
         L     R10,XAL            POINTER TO BEGINNING OF      @Z30LPTJ*86846003
                                   BUFFER                      @Z30LPTJ 86850003
         LA    R10,C0(R10)        CLEAR HIGH ORDER BYTE        @Z30LPTJ 86854003
         SR    R9,R10             COMPUTE SIZE OF BUFFER       @Z30LPTJ 86858003
         LA    R10,D126           MAXIMUM SIZE                 @Z30LPTJ 86862003
         CR    R9,R10             IS IT < OR = MAXIMUM SIZE?   @Z30LPTJ 86866003
         BH    SIZEERR            NO, ERROR EXIT               @Z30LPTJ 86870003
         L     R15,VCON94         GET SS/1 PREPROCESSOR MODULE @Z30LPTJ 86874003
         BR    R15                GO TO SS/1 SYSTEM            @Z30LPTJ 86878003
SS1ERROR EQU   *                                               @Z30LPTJ 86882003
         LA    R5,ERR12           INSERT ERROR CODE            @Z30LPTJ 86886003
         B     ERREXIT                                         @Z30LPTJ 86890003
*                                                                       86900003
VTAMEXT  EQU   *                                                 Y02674 87000003
         L     R15,VVTAM          GET VCON VTAM MOD              Y02674 87200003
         BR    R15                EXIT TO IT                     Y02674 87400003
CHANNEL  EQU   *                                                 Y02669 87600003
         MVI   XAN,CHCODE         CHANGE THE COMMAND CODE        Y02669 87800003
         B     EXIT08             GO TO 0803D EXIT               Y02669 88000003
CPU      EQU   *                                                 Y02669 88200003
         MVI   XAN,CPUCODE        CHANGE THE COMMAND CODE        Y02669 88400003
         B     EXIT08             GO TO 0803D EXIT               Y02669 88600003
STORAGE  EQU   *                                                 Y02669 88800003
         MVI   XAN,STORCODE       CHANGE THE COMMAND CODE        Y02669 89000003
         B     EXIT08             GO TO 0803D EXIT               Y02669 89200003
PATH     EQU   *                                                 Y02669 89400003
         MVI   XAN,PATHCODE       CHANGE THE COMMAND CODE        Y02669 89600003
         B     EXIT08                GO TO 0803D EXIT          @Z309PTJ 89650003
CN       EQU   *                                               @Z309PTJ 89700003
         MVI   XAN,CNCODE            CHANGE THE COMMAND CODE   @Z309PTJ 89750003
EXIT08   EQU   *                                                 Y02669 89800003
         L     R15,VCON08         GET ADDRESS OF 0803D           Y02669 90000003
         BR    R15                EXIT TO IEE0803D               Y02669 90200003
*                                                                Y02669 90400003
         EJECT                                                          90600003
DOCLC    CLC   C0(C0,R11),C0(R6)   DOES CURRENT TABLE ENTRY EQU KEYWD   90800003
         DS    0F                  ALIGN ON FULL WORD BOUNDARY          91000003
VCON05   DC    V(IEE0503D)         ERROR MSG MODULE              Y01029 91200003
VVTAM    DC    V(ISTCFF3D)                                       Y02674 91400003
VCON08   DC    V(IEE0803D)                                       Y02669 91600003
VCON94   DC    V(IEE9403D)         SS/1 PREPROCESSOR MODULE    @Z30LPTJ 91700003
ONLCOMA  DC    CL7'ONLINE,'                                    @ZM30466 91800003
OFLCOMA  DC    CL8'OFFLINE,'                                   @ZM30466 91900003
CONSCOMA DC    CL8'CONSOLE,'                                   @ZM30466 92000003
MSTCCOMA DC    CL8'MSTCONS,'                                   @ZM30466 92100003
         DS    0F                  ALIGN ON FULL WORD BOUNDARY          92200003
*********************************************************************** 92400003
KEYTAB   EQU   *                   START OF VALID KEYWORD TABLE         92600003
*                                  ****KEYWORD FOLLOWED BY ITS****      92800003
*                                  ****    MODULE ADDR    ****   Y01029 93000003
*                                                              @ZM30466 93020003
*             ***********************************************  @ZM30466 93040003
*             *  ADDITIONAL TABLE ENTRIES MAY BE INSERTED   *  @ZM30466 93060003
*             *  INTO THIS TABLE AS LONG AS THEY CONFORM    *  @ZM30466 93080003
*             *  TO THE PRESENT TABLE STRUCTURE.            *  @ZM30466 93100003
*             ***********************************************  @ZM30466 93120003
*                                                              @ZM30466 93140003
ONL      DC    CL8'ONLINE'                                     @ZM30466 93200003
         DC    V(IEE0803D)                 ..                    Y02669 93600003
OFL      DC    CL8'OFFLINE'                ..                  @ZM30466 93800003
         DC    V(IEE0803D)                 ..                    Y02669 94000003
CONS     DC    CL8'CONSOLE'                ..                  @ZM30466 94200003
         DC    V(IEE0803D)                 ..                    Y02669 94400003
HARDC    DC    CL8'HARDCPY'                ..                  @ZM30466 94600003
         DC    V(IEE4703D)                 ..                    Y01029 94800003
MSTC     DC    CL8'MSTCONS'                ..                  @ZM30466 95000003
         DC    V(IEE4303D)                 ..                    Y01029 95200003
ONT      DC    CL8'ONTP'                   ..                  @ZM30466 95400003
         DC    V(IED1303D)                 ..                    Y01029 95600003
OFFT     DC    CL8'OFFTP'                  ..                  @ZM30466 95800003
         DC    V(IED1303D)                 ..                    Y01029 96000003
TABEND   EQU   *-LENG                                                   96200003
*                                                                       96400003
CNET     DC    C'NET,'                                         @ZA07514 96600003
CCH      DC    C'CH('                                          @ZA07514 96800003
CCPU     DC    C'CPU('                                         @ZA07514 96850003
CSTOR    DC    C'STOR('                                        @ZA07514 96900003
CPATH    DC    C'PATH('                                        @ZA07514 96950003
CCN      DC    C'CN('                                          @ZA07514 97000003
SS1      DC    C',S '                                          @Z30LPTJ 97480003
SS1COMMA DC    C',S,'                                          @Z30LPTJ 97510003
PATCH    DC    CL50'*** IEE3202D PATCH AREA ***'               @Z30LPTJ 97540003
*********************************************************************** 97600003
         EJECT                                                          97700003
SETXSA   DSECT                                                          97800003
         IEEXSA                                                         98000003
         END                                                            98200003
./  ADD  SSI=83110945,NAME=IEE3303D
 TITLE 'IEE3303D - VARY COMMAND SYNTAX SCANNER'                         00883103
IEE3303D CSECT                                                          00883202
**********************************************************************  00883402
* MODULE NAME      = IEE3303D                                           00883802
*   CSECT NAME     = IEE3303D                                           00883902
*                                                                       00888502
* LOAD MODULE NAME = IEE3603D                                           00890502
*                                                                       00892502
* DESCRIPTIVE NAME = VARY COMMAND SYNTAX SCANNER FOR KEYWORDS:          00892902
*                            ONLINE                                     00893302
*                            OFFLINE                                    00893702
*                            CONSOLE                                    00894102
*                                                                       00894702
* COPYRIGHT        = MISSING                                            00895102
*                                                                       00895502
* STATUS           = OS/VS/2 RELEASE 3                         @Z30LPTJ 00895903
*                                                                       00896602
* FUNCTION         = THIS ROUTINE SYNTAX SCANS THE UNIT FIELDS IN THE   00897002
*                    COMMAND FOR:                                       00897402
*                    . VALID UNIT SPECIFICATION                         00897802
*                    . CORRECT NUMBER AND LOCATION OF COMMAS, PARENS    00898202
*                      BLANKS, END OF BUFFER DELIMITING END OF          00898402
*                      COMMAND                                          00898502
*                    . CHECKS COMMAND AUTHORITY,MUST BE EITHER 2 OR 3   00898602
*                    . IF SMF IS IN THE SYSTEM, CONTROL IS GIVEN TO     00899202
*                      MODULE IEE2303D WITH CODES SPECIFYING WHICH      00899602
*                      MODULE SHOULD IT RETURN TO.                      00900002
*                    . CHECKS FOR COMMA FOLLOWING 'CONSOLE'             00900402
*                      KEYWORD. IN THIS CASE CONTROL IS PASSED          00900502
*                      TO 4403D FIRST FROM HERE (IF SMF IS NOT          00900602
*                      ACTIVE, IF IT IS ACTIVE THEN A FLAG IS SET       00900702
*                      FOR 2303D TO GO TO 4403D FIRST WHEN IT IS        00901402
*                      READY TO RELINQUISH CONTROL)                     00901802
*                                                                       00902202
* OPERATION        = THIS ROUTINE VALIDATES THE SYNTAX OF UNITS:        00903202
*                       XXX            (SINGLE UNIT)                    00903302
*                       O-XXX          (OUTPUT ONLY UNIT)               00904402
*                       (I-XXX,O-XXX)  (COMPOSITE SPECIFICATION)        00906402
*                    IT VALIDATES THAT PARENS ENCLOSE MULTIPLE UNITS    00906502
*                    AND THAT EACH UNIT IS SEPARATED BY COMMAS          00906802
*                    IF THE KEYWORD IS 'CONSOLE', IT VALIDATES THAT     00907202
*                    THE ISSUER HAS COMMAND AUTHORITY OF 3              00907602
*                    IF THE KEYWORD IS 'ONLINE/OFFLINE' THAN IT         00908402
*                    VALIDATES THAT THE ISSUER HAS COMMAND              00908802
*                    AUTHORITY OF 2 OR 3                                00909202
*                    IT CHECKS WHETHER ADDITIONAL PARAMETERS ARE        00909602
*                    PRESENT ON THE 'CONSOLE' KEYWORD. IF SO, IT SETS   00909702
*                    A BIT INFORMING THAT 4403D MUST RECEIVE CONTROL    00910102
*                    FIRST, AND IT STORES THE POINTER TO THESE          00910502
*                    ADDITIONAL KEYWORDS IN XAS+4 FOR 4403D             00910602
*                    IF SMF IS ACTIVE, IT GIVES CONTROL TO              00910702
*                    2303D FIRST, FOR THE CONSOLE AND ONLINE            00911002
*                    KEYWORDS.                                          00911402
*                    TO FIND WHETHER SMF IS ACTIVE, THIS MODULE         00911502
*                    CHECKS THE CVTSMCA BYTE IN THE CVT TO SEE IF       00911602
*                    IT HAS BEEN INITIALIZED WITH THE ADDRESS OF THE    00911702
*                    SMCA.  IF NOT, THEN WE KNOW THAT SMF HAS NOT       00912102
*                    BEEN INITIALIZED AS YET AND NO RECORD CAN BE       00912702
*                    WRITTEN.  THEREFORE, IEE2303D'S FUNCTION IS        00913102
*                    BYPASSED.  IF CVTSMCA CONTAINS AN ADDRESS          00913502
*                    (WHICH IS THE PTR TO THE SMCA) WE TEST THE         00913902
*                    SMCAUSER AND THE SMCAMAN BITS IN THE SMCA          00914502
*                    (BYTE = SMCAMISC) TO SEE IF SMF IS OPERATING.      00914902
*                    IF NONE OR ONLY ONE IS ON, WE CANNOT WRITE         00915302
*                    A RECORD AND, THEREFORE, IEE2303D'S FUNCTION       00915702
*                    IS AGAIN BYPASSED.  IF BOTH BITS ARE ON, THEN      00916102
*                    WE DETERMINE IF JOB ACCOUNTING WAS REQUESTED       00916202
*                    BY THE USER BY TESTING THE SMCAOPT BYTE OF THE     00916302
*                    SMCA, BIT = SMCAOPT1.  IF IT IS OFF, THEN JOB      00916502
*                    ACCOUNTING WAS NOT REQUESTED AND IEE2303D'S        00916902
*                    FUNCTION IS BYPASSED.                              00917502
*                    IF THIS BIT IS ON, THEN WE KNOW THAT SMF IS UP     00917902
*                    AND RUNNING AND THAT JOB ACCOUNTING WAS            00918302
*                    REQUESTED AND THEREFORE, WE GIVE CONTROL TO        00918702
*                    IEE2303D TO WRITE THE SMF RECORD FOR ALL VALID     00919402
*                    DEVICES CHANGING TO THE 'ONLINE' AND               00919802
*                    'CONSOLE' STATES.                                  00920202
*                    IT ALSO SETS BITS IN THE XOPCODE BYTE OF THE       00921102
*                    DUMMY XSA TO SHOW WHICH KEYWORD WAS SPECIFIED:     00921402
*                    X'80' = CONSOLE                                    00921802
*                    X'20' = ONLINE                                     00921902
*                    X'10' = OFFLINE                                    00922002
*                                                                       00922202
* NOTES                                                                 00922302
*   DEPENDENCIES   = NONE                                               00922402
*   CHARACTER/CODE DEPENDENCIES                                         00922502
*                  = THIS MODULE CAN BE ASSEMBLED WITH ANY NEW          00923002
*                    CHARACTER/CODE SET.                                00923402
*                                                                       00923502
* RESTRICTIONS     = R1 OUTPUT = XAD SWITCHES FOR 4203D                 00923802
*                       INCLUDING CCAHOLD                               00924202
*                    R2 ADDRESSABILITY FOR DUMMY XSA                    00924602
*   REGISTER CONVENTIONS                                                00924702
*                  = REGISTERS ARE DEFINED AT LABEL: DEFREG             00924802
*   PATCH LABEL    = PATCH                                              00924902
*                                                                       00925002
* MODULE TYPE      = CSECT                                              00925102
*   PROCESSOR      = ASSEMBLER                                          00925202
*   MODULE SIZE    = VS/2 = '354'                              @Z30LPTJ 00925403
*   ATTRIBUTES     = REENTRANT, REUSABLE, REFRESHABLE,                  00925802
*                    ZERO PSW PROTECT KEY, PAGED LPA                    00925902
*                                                                       00926402
* ENTRY POINTS     = IEE3303D FROM IEE3603D                             00926802
*   PURPOSE        = VARY ONLINE/OFFLINE/CONSOLE COMMANDS TO BE         00927202
*                    PROCESSED                                          00927302
*   LINKAGE        = BRANCH                                             00927402
*   INPUT          = DUMMY XSA POINTED BY REG 2                         00928002
*                    IN THE DUMMY XSA THE FOLLOWING FIELDS:             00928402
*                       XAS AND XAS+1 CONTAIN READER/INTERPRETER        00928802
*                       COMMAND AUTHORITY                               00929202
*                       XAR CONTAINS THE SIZE OF THE COMMAND BUFFER     00929302
*                       XAL CONTAINS THE PTR TO THE LIST POSITION       00929402
*                       XAV CONTAINS THE VERB OF THE COMMAND 'VARY'     00929502
*                       XAU CONTAINS THE CONSOLE ID OF THE ISSUER       00929602
*                       OF THE COMMAND                                  00929702
*                    R13 POINTS TO THE SAVE AREA, WORD17 = CSCB PTR     00929802
*   REGISTERS SAVED  = ALL                                              00929902
*   REGISTER USAGE = R1 R/I COMMAND AUTHORITY                           00930002
*                    R2 PTR TO THE DUMMY XSA                            00930102
*                    R3 ADDRESSABILITY                                  00930202
*                    R4 UCME PTR                                        00930302
*                    R6 CVT PTR                                         00930402
*                    R7 EOB REG                                         00930502
*                    R9 PARAM LIST REG                                  00930602
*                    R10 UCM REG                                        00930702
*                    R11 UCMPRFX REG                                    00930802
*                    R12 UCME REG                                       00930902
*                    R13 SAVE AREA REG                                  00931002
*   REGISTERS RESTORED                                                  00931102
*                  = ALL                                                00931602
*                                                                       00932002
* EXITS - NORMAL   = IF SMF IS IN THE SYSTEM = IEE2303D VIA BRANCH      00932402
*   CONDITIONS     = WITH INDICATOR WHETHER IT SHOULD GO TO             00932802
*                    4203D OR 4403D WHEN RETURNING                      00932902
* EXITS - NORMAL-2-  = IF SMF IS NOT ACTIVE = TO:                       00933002
*   CONDITIONS     = IEE4203D FOR ONLINE/OFFLINE                        00933102
*                    IEE4403D OR IEE4203D FOR CONSOLE                   00933202
*                    FOR VARY OFFLINE, AN EXIT IS TAKEN ALWAYS          00933602
*                    DIRECTLY TO 4203D SINCE NO RECORD HAS TO BE        00933702
*                    WRITTEN FOR AN OFFLINE COMMAND.                    00934102
*   OUTPUT         = DUMMY XSA POINTED BY REG2                          00934202
*                    REG1 HAS THE XAD SWITCHES FOR 4203D                00934602
*                            BYTE 1 = USWITCH SWITCHES                  00935002
*                            BYTE 2 = USWTWO - UNUSED SWITCHES          00935402
*                            BYTE 3 AND 4 = CCAHOLD - HAS COMMAND       00935802
*                                           AUTHORITY OF ISSUER         00936202
*                    XAS                                                00936302
*                            BYTE 1 = XOPCODE - HAS INDICATION OF       00936402
*                                      KEYWORD                          00936502
*                            BYTE 2 = XSWITCH - UNUSED IN THIS MODULE   00936702
*                            BYTE3&4= UNUSED IN THIS MODULE             00936802
*                            BYTE5-8= TEMPORARITY HAS PTR TO END OF     00936902
*                                      KEYWORD FOR 4403D                00937002
*                    SAVE AREA PTR IN REG 13                            00937102
*   RETURN CODES   = NONE                                               00937202
*                                                                       00937302
* EXITS - ERROR-1- = TO IEE0503D AND IEE2103D VIA BALR                  00937403
*                    ON RETURN, THE CSCB IS FREED VIA AN MGCR MACRO     00937502
*                    THE SAVE AREA AND THE DUMMY XSA                    00937602
*                    GOTTEN IN 3603D IS ALSO FREED VIA FREEMAIN         00938002
*                    AND A RETURN IS TAKEN TO THE CALLER OF THE SVC     00938402
*   CONDITIONS     = AN ERROR SITUATION WAS DETECTED                    00938802
*   OUTPUT         = DUMMY XSA PTR IN REG 2 AND THE FOLLOWING:          00939202
*                       XAE = ERROR MESSAGE CODE                        00939302
*                       XAV = VERB 'VARY'                               00939402
*                       XAU = UCM ID                                    00939502
*   RETURN CODES = NONE                                                 00939602
*                                                                       00939702
* EXITS - ERROR-2- = TO IEE0503D AND IEE2103D VIA BALR.        @Z30LPTJ 00940103
*                    ON RETURN, AN EXIT IS MADE TO IEECB904    @Z30LPTJ 00940503
*                    FOR FURTHER VARY RANGE PROCESSING.        @Z30LPTJ 00940603
*   CONDITIONS     = AN ERROR SITUATION WAS DETECTED AND VARY  @Z30LPTJ 00942603
*                    RANGE IS BEING PROCESSED.                 @Z30LPTJ 00944603
*   OUTPUT         = DUMMY XSA PTR IN REG 2 AND THE FOLLOWING: @Z30LPTJ 00946603
*                        XAE = ERROR MESSAGE CODE              @Z30LPTJ 00948603
*                        XAV = VERB 'VARY'                     @Z30LPTJ 00950603
*                        XAU = UCM ID                          @Z30LPTJ 00952603
*   RETURN CODES   = NONE                                      @Z30LPTJ 00954603
* EXTERNAL REFERENCES                                                   00956603
*   ROUTINES       = IEE2303D     SMF ROUTINE                           00960803
*                    IEE4203D     ONLINE/OFFLINE/CONSOLE PROCESSOR      00962903
*                    IEE4403D     CONSOLE SUBKEYWORD PROCESSOR          00963603
*                    IEECB904     VARY RANGE PROCESSOR         @Z30LPTJ 00964303
*                    IEE0503D     MESSAGE MODULE                        00965003
*                    IEE2103D     MESSAGE MODULE                        00965703
*   DATA AREAS     = SEE EXITS - OUTPUT DATA                            00967103
*                                                                       00968503
* CONTROL BLOCKS   = . DUMMY EXTENDED SAVE AREA (XSA)                   00969603
*                    . CVT                                              00972003
*                       FIELDS TESTED  - CVTCUCB                        00972703
*                                        CVTSMCA                        00973403
*                       FIELDS UPDATED - NONE                           00974803
*                    . UNIT CONTROL MODULE (UCM)                        00976203
*                       FIELDS TESTED  - UCMVEZ                         00977603
*                                        UCMVEA                         00979003
*                                        UCMAUTH                        00981103
*                       FIELDS UPDATED - NONE                           00981803
*                    . SYSTEM MANAGMENT FACILITIES CONTROL TAB (SMCA)   00982503
*                       FIELDS TESTED  - SMCAMISC - BIT=SMCAUSER        00983903
*                                                       SMCAMAN         00985303
*                                        SMCAOPT  - BIT=SMCAOPT1        00986703
*                       FIELDS UPDATED - NONE                           00988103
*                    . COMMAND SCHEDULING CONTROL BLOCK (CSCB)          00990203
*                       FIELDS TESTED  - NONE                           00990903
*                       FIELDS UPDATED - CHSTS - BIT= CHFC              00991603
*                                                                       00993003
* TABLES           = SAVEAREA AND SAVE WORK AREA =                      00994403
*                    84 BYTES                                           00995803
*                                                                       00997203
* MACROS           = MGCR, FREEMAIN, LOAD, DELETE ,DEQ                  00999303
*                                                                       01000003
* MAPPING MACROS   = IEEXSA                                             01001003
*                    IEECUCM                                            01002403
*                    CVT                                                01004303
*                    IEESMCA                                            01005203
*                    IEECHAIN                                           01006203
*   SERIALIZATION  = PROTECTION AGAINST ALLOC, OLTEP AND ANOTHER VARY   01008103
*                    IS DONE VIA AN ENQ ISSUE EARLIER IN MODULE         01009003
*                    IEE3603D. A DEQ WILL BE ISSUED HERE IF A TERMINAL  01010003
*                    ERROR CONDITION IS FOUND. THIS IS DONE AT:  SDEQUE 01012303
*                    PROTECTION AGAINST COMM TASK IS STILL NOT REQUIRED 01013103
*                    AND THEREFORE THIS MODULE WILL NOT ISSUE ANY       01013803
*                    SETLOCKS                                           01015703
*                                                                       01016603
* CHANGE LEVEL     = Y02669, Y02651, Z30LPTJ                   @Z30LPTJ 01017603
*                                                                       01019503
* CHANGE ACTIVITY  = N/A                                                01021403
*                                                                       01022303
* MESSAGES         = IEE345I AUTHORITY INVALID - FROM IEE2103D          01023303
*                    IEE307I DELIMITER ERROR - FROM IEE0503D            01025203
*                    IEE308I TERM LENGTH ERROR - FROM IEE0503D          01026103
*                                                                       01027103
* ABEND CODES      = NONE                                               01029003
*                                                                       01030003
* PACKAGING        = IEE3303D WILL BE PART OF LOAD MODULE               01031003
*                       IEE3603D                                        01032803
*                    THIS LOAD MODULE ALIASES ARE                       01033703
*                       NONE                                            01034703
*                    THIS LOAD MODULE ENTRY POINTS ARE                  01036603
*                       IEE3603D                                        01037503
*                    MODULE WILL RESIDE IN:  LPALIB                     01038503
*                                                                       01040403
* SYSGEN           = SUPPLIED BY THE FOLLOWING SECTIONS:                01041403
*                       LOAD MODULE NAME                                01042403
*                       PACKAGING                                       01044203
*                       THIS CSECT WILL BE INCLUDED AT SYSGEN FROM      01046103
*                       DLIB -AOSB3- BY MACRO -SGIEF441-                01047003
*                                                                       01048003
* SYSTEM LIBRARIES = NONE                                               01049903
*                                                                       01050803
**********************************************************************  01051803
         EJECT                                                          01053703
*                                                                       01054603
*  REGISTER ASSIGNMENTS                                                 01055603
*                                                                       01057503
DEFREG   EQU   *                                                 Y02669 01058503
R0       EQU   0                                                        01059503
R1       EQU   1                  R/I COMMAND AUTHORITY                 01060503
R2       EQU   2                  DUMMY XSA PTR                         01061503
R3       EQU   3                  ADDRESSABILITY                        01062503
R4       EQU   4                  UCME PTR                              01065103
R5       EQU   5                  WORK REG - SAVE FOR UCME SIZE         01066003
R6       EQU   6                  WORK REG - SAVE FOR LAST UCME PTR     01067003
R7       EQU   7                  END OF BUFFER REG                     01068903
R8       EQU   8                                                        01069903
R9       EQU   9                  PARAM LIST REG                        01070903
RA       EQU   10                 UCM ADDR REG                          01072503
RB       EQU   11                 UCMPRFX REG                           01073503
RC       EQU   12                  UCMPFX REG                     19084 01074803
RD       EQU   13                                                 19084 01075803
RE       EQU   14                  RET ADD REG                    19084 01078403
RF       EQU   15                  WORK AND XCTL REG              19084 01079403
*                                                                 19084 01080403
         EJECT                                                    19084 01082203
*                                                                 19084 01083203
*        CONSTANTS AND CODES                                      19084 01084203
*                                                                 19084 01085203
CA3      EQU   X'20'               COMD AUTH OF 3 - CONS          19084 01086203
CA2OR3   EQU   X'60'                                              19084 01087903
URI      EQU   X'80'                                              19084 01089803
USYST    EQU   X'00'                                              19084 01090703
SYSCODE  EQU   X'E0'                                              19084 01091703
XFF      EQU   X'FF'                                           @Z30LPTJ 01092703
*                                                                 19084 01095503
         SPACE 10                                                 19084 01096403
*                                                                 19084 01097403
*        NUMBER ASSIGNMENTS                                       19084 01099303
*                                                                 19084 01100203
ZERO     EQU   0                                                  19084 01101203
ONE      EQU   1                                                  19084 01103103
TWO      EQU   2                                                  19084 01104003
TRE      EQU   3                                                  19084 01105003
FOR      EQU   4                                                  19084 01106903
SIX      EQU   6                                                  19084 01107903
SVN      EQU   7                                                  19084 01108903
EIT      EQU   8                                                  19084 01110103
TEN      EQU   10                                                 19084 01111103
TWLV     EQU   12                                                 19084 01113403
FIFTN    EQU   15                                                 19084 01114403
D14      EQU   14                                                Y02669 01115403
D64      EQU   64                                                Y02669 01116403
D132     EQU   132                                               Y02669 01117403
*                                                                 19084 01118403
         EJECT                                                    19084 01120803
*                                                                 19084 01121803
*        CHARACTER CONSTANTS                                      19084 01123603
*                                                                 19084 01124603
BLANK    EQU   C' '                                               19084 01126403
CONSOLE  EQU   C'C'                                               19084 01127403
RPAREN   EQU   C')'                                               19084 01129203
LPAREN   EQU   C'('                                               19084 01130103
COMMA    EQU   C','                                               19084 01131003
*                                                                 19084 01132003
*        ERROR CONSTANTS                                          19084 01133003
*                                                                 19084 01134803
ERR41    EQU   41                       AUTH INVALID              19084 01135803
ERR7     EQU   7                        DELIMITER ERROR           19084 01137603
ERR8     EQU   8                                                  19084 01138603
         EJECT                                                    19784 01140403
*********************************************************************** 01141403
*                                                                 19084 01143203
*        ADDRESSABILITY AND HOUSE KEEPING                         19084 01144203
*                                                                 19084 01146003
*********************************************************************** 01147003
         BALR  R3,ZERO                                                  01148803
         USING *,R3                                               19084 01149703
         USING XSA,R2                                             19084 01150603
         MODID BR=YES                                            Y01886 01151603
*                                                                       01152603
         LH    R8,XAA              SAVE VARY RANGE BITS        @Z30LPTJ 01154403
         STM   R0,RF,ZERO(RD)                                    Y02669 01155403
         L     R9,XAL              PTR TO LIST POSITION           19084 01157203
         LA    R9,ZERO(R9)         CLEAR HIGH ORDER BYTE          19084 01158203
         L     R7,XAR                                             19084 01160003
         AR    R7,R9               COMPUTE END OF BUFFER INTO R7 Y02669 01161003
         XC    XAD(FOR),XAD        CLEAR SWITCH AREA              19084 01162803
         MVC   XACAHOLD(TWO),XAS  MOVE OVER R/I CMD AUTH TO XAS@Z30LPTJ 01163803
         XC    XAS(EIT),XAS        ZERO INDICATOR AREA            19084 01165603
         L     R6,CVTPTR                                          19084 01166503
         USING CVT,R6                                            Y01012 01167403
*                                                                 19084 01168403
*********************************************************************** 01169403
*        START  OF SCAN                                           19084 01171203
*********************************************************************** 01172203
*                                                                 19084 01174003
         CLI   ZERO(R9),LPAREN    ONE PAREN                             01176003
         BNE   CONTINUE           NOPE, SINGLE UNIT                     01176403
         CLI   ONE(R9),LPAREN     OUTPAREN IS HERE, SECON PAREN?        01177403
         BNE   CONTINUE           NOPE, JUST SINGLE PAREN               01178803
         CLI   TWO(R9),LPAREN     DOUBLE PAREN, IS THERE MORE?          01179803
         BE    SERR4              YES, NO GOOD TO HAVE 3PAREN LEVELS    01180803
CONTINUE EQU   *                                                        01183203
*                                                                       01184203
         CLI   ZERO(R9),LPAREN     PAREN FOR COMP OR MULT UNITS   19084 01185303
         BNE   S1UNIT              NO,SINGLE UNIT                 19084 01187403
         CLC   ONE(TWO,R9),HIUNIT+ONE  IS IT A SINGLE COMPOSITE   19084 01188403
         BE    S1COMP              YES,SINGLE COMP SPECIFIED      19084 01189503
         OI    XADUSWIT,XAXPAREN   NO,MULTIPLE UNITS,SET PAREN @Z30LPTJ 01191603
SINDEX   EQU   *                                                  19084 01192603
         LA    R9,ONE(R9)           INDEX TO UNIT                 19084 01193703
S1UNIT   EQU   *                                                  19084 01194703
         CLC   ZERO(TRE,R9),HIUNIT  DO WE HAVE A COMPOSITE        19084 01195803
         BE    S1COMP                                             19084 01197903
         CLC   ZERO(TWO,R9),HOUNIT+ONE   DO WE HAVE AN O-XXX      19084 01198903
         BNE   SCOMACK             NO, THIS IS A REGULAR XXX            01200003
SOUNIT   EQU   *                   INDEX PLUS 2 INTO UNIT         19084 01202003
         LA    R9,TWO(R9)                                         19084 01203003
SCOMACK  EQU   *                                                  19084 01204003
         LA    R9,TRE(R9)          INDEX TO WHERE COMMA SHOULD BE 19084 01206003
         TM    XADUSWIT,XAXPAREN   IS THE XTR PAREN ON         @Z30LPTJ 01207003
         BO    SPARNCK             YES,CHECK FOR RPAREN           19084 01208003
         CLI   ZERO(R9),COMMA      COMMA ENDS UNIT FIELD          19084 01209003
         BNE   SERR4    ANY OTHER VALID UNIT SHOULD BE 3 CHAR    Y01012 01210003
SKEYCK   EQU   *                                                 Y02669 01212003
         CLI   ZERO(R9),COMMA  DOES A COMMA FOLLOW THE LAST UNT? Y02669 01213003
         BE    KEYTST             YES,OK                         Y02669 01214003
         LA    R9,ONE(R9)         UP BY ONE TO NEXT UNIT         Y02669 01216003
         B     SKEYCK             CHECK IF COMMA EXISTS NOW      Y02669 01217003
KEYTST   EQU   *                                                 Y02669 01218003
         CLI   ONE(R9),CONSOLE     IS THIS A CONSOLE KEYWORD     Y02669 01219003
         BNE   SONOFF              NO,MUST BE ON/OFFLINE          19084 01220003
         OI    XASOPCOD,XACON    TURN ON CONSOLE KEY INDICATOR @Z30LPTJ 01222003
         BAL   R5,SUCMID           GO GET REQUESTORS COMD AUTH    19084 01224003
         TM    XACAHOLD,CA3      CA PLACED IN CCAHOLD OF XAD   @Z30LPTJ 01225003
         BZ    SERR1               AUTHORITY IS INVALID           19084 01226003
         LA    R9,EIT(R9)          INDEX PAST CONSOLE KEYWORD     19084 01228003
SMFRTN   EQU   *                                                  19084 01229003
         ST    R9,XAS+FOR          PTR TO KEYWORD FOR 4403D       19084 01230003
         SR    R5,R5                                              19084 01232003
         TM    XASOPCOD,XAOFF       IS IT OFFLINE              @Z30LPTJ 01233003
         BO    FOR2EXT                                            19084 01234003
*                                                                 19084 01235003
*        PRESET FOR SMF TO RETURN TO 4203D                        19084 01236003
*                                                                 19084 01237003
         TM    XASOPCOD,XACON      IS IT CONSOLE KEY           @Z30LPTJ 01238003
         BZ    SMFEXT              NO, GOTO  SMF                  19084 01240003
         CR    R9,R7               EOB                            19084 01242003
         BE    SMFEXT              YES, COMMAND FINISHED          19084 01243003
         CLI   ZERO(R9),BLANK      BALNK DELIMITS END             19084 01244003
         BE    SMFEXT              YES,GO CHECK FOR SMF           19084 01246003
*                                                                 19084 01247003
*   PRESET FOR SMF TO GO TO 4403D- XAS+4 WILL PT TO,KEYWORDS      19084 01248003
*                                                                 19084 01249003
         OI    XASWITCH,XASMF44   MODULE TO RETURN TO IS 4403D @Z30LPTJ 01250003
         B     SMFEXT2             GO TO SMF ROUTINE                    01252803
SMFEXT   EQU   *                                                  19084 01253203
         OI    XASWITCH,XASMF42    RETURN TO 4203D SWITCH      @Z30LPTJ 01254203
SMFEXT2  EQU   *                                                  19084 01255903
         L     R6,CVTPTR                                         Y02669 01257903
         USING CVT,R6                                            Y02669 01258903
         L     R7,CVTSMCA          ADDRESS IF SNCA               Y02669 01259903
         LTR   R7,R7               ANY THERE                     Y02669 01261903
         BZ    NOSMF               NO, EXIT NOT TAKEN TO 2303D   Y02669 01262703
         USING SMCABASE,R7                                       Y02669 01263603
         TM    SMCAMISC,SMCAUSER+SMCAMAN  TEST TO SEE IF RECD IS Y02669 01264603
*                                  TO BE WRITTEN OUT             Y02669 01265603
         BC    D14,NOSMF           NO, EXIT NOT TAKEN TO 2303D   Y02669 01266603
         TM    SMCAOPT,SMCAOPT1    IS HOB ACCOUNTING REQUESTED   Y02669 01267603
         BO    YESSMF              YES, GO TO 2303D              Y02669 01268603
NOSMF    EQU   *                                                 Y02669 01269603
*                                                                Y02669 01273602
*    NO 2303D, CHECK IF MUST GO TO 4203D OF 4403D                Y02669 01275602
*                                                                Y02669 01277602
         TM    XASWITCH,XASMF42    EXIT TO 4203D?              @Z30LPTJ 01278003
         BO    FOR2EXT             4203D                         Y02669 01278402
         B     FOR4EXT             NO, 4403D                     Y02669 01278502
YESSMF   EQU   *                                                 Y02669 01278602
         MVC   XAX+TRE(TWO),MOD23                                Y02669 01280602
         L     RF,SMFMOD           GET ADDRESS OF IEE2303D       Y02669 01282102
         B     COMONEXT            GO TO EXIT ROUTINE            Y02669 01285502
S1COMP   EQU   *                                                  19084 01288902
         CLC   SIX(TRE,R9),HOUNIT   IS ,O- SPECIFIED              19084 01290602
         BNE   SERR3               NO, DELIMITER ERROR            19084 01292302
         CLI   TWLV(R9),RPAREN     RPAREN ENDS COMPOSITE          19084 01295702
         BNE   SERR3               NO, ERROR                      19084 01297402
         LA    R9,TEN(R9)          INDEX PAST UNIT                19084 01300802
         B     SCOMACK             GO TO CHECK ENDING             19084 01302502
*                                                                 19084 01304202
SPARNCK  EQU   *                                                  19084 01307602
         CLI   ZERO(R9),RPAREN     ARE WE AT END OF UNIT FLD      19084 01309302
         BNE   SMOREUNT            NO, APPARENTLY MORE UNITS      19084 01311002
         LA    R9,ONE(R9)          INDEX PAST 'PARENS'            19084 01314402
         B     SKEYCK              GO TO CONTINUE                 19084 01316102
SMOREUNT EQU   *                                                  19084 01319502
         CLI   ZERO(R9),COMMA      COMMA DELIMITS UNITS           19084 01321202
         BE    SINDEX              YES,CONTINEU UNIT SCAN         19084 01322902
         B     SERR4               TERM LENGTH ERROR              19084 01324602
SONOFF   EQU   *                                                  19084 01329702
         CLC   ONE(TWO,R9),ONLINE  IS IT ONLINE KEY               19084 01331402
         BNE   SOFFLINE            NO,MUST BE OFFLINE             19084 01333102
         OI    XASOPCOD,XAON       TURN ON ONLINE BIT          @Z30LPTJ 01336503
         LA    R9,SVN(R9)          INDEX PAST KEYWORD             19084 01339902
SCOMDATH EQU   *                                                  19084 01343302
         BAL   R5,SUCMID           GO GET COMD AUTH OF ISSUER     19084 01345002
         TM    XACAHOLD,CA2OR3   IS C A  TWO OR THREE          @Z30LPTJ 01348403
         BZ    SERR1               NO, AUTH IS INVALID            19084 01350102
         B     SMFRTN              YES, GO CHECK SMF              19084 01351802
*                                                                 19084 01353502
SOFFLINE EQU   *                                                  19084 01356902
         OI    XASOPCOD,XAOFF     TURN OFFLINE BIT             @Z30LPTJ 01358603
         LA    R9,EIT(R9)          INDEX PAST KEYWORD             19084 01362002
         B     SCOMDATH            GO TO CHECK EOB               Y01012 01363702
*                                                                 19084 01365402
SUCMID   EQU   *                                                  19084 01368802
         CLI   XAU,URI             WAS R/I ISSER                  19084 01372202
         BCR   EIT,R5              YES,RETURN                     19084 01376002
*                                                                 19084 01378002
         CLI   XAU,USYST           WAS A SYSTEM COMMAND           19084 01382002
         BNE   UCONS               NO,FROM CONSOLE                19084 01384002
         XC    XACAHOLD(TWO),XACAHOLD  YES, ZERO CAHOLD        @Z30LPTJ 01388003
         OI    XACAHOLD,SYSCODE    AND INSERT ALL C.A.            19084 01390003
         BCR   FIFTN,R5            RETURN                         19084 01394002
*                                                                 19084 01396002
UCONS    EQU   *                                                  19084 01400001
         LR    RE,RD              SAVE SAVE AREA REG IN R14      Y02669 01400402
         SR    RD,RD               ZERO FOR IC                   Y02669 01401002
         IC    RD,XAU              CONSOLE ID                    Y02669 01402002
         BCTR  RD,ZERO             MINUS ONE                     Y02669 01404002
         L     R4,CVTCUCB                                         19084 01405001
         USING UCM,R4                                                   01406202
         L     RC,UCMVEZ           PTR TO FIRST UCME              19084 01407902
         L     R4,UCMVEA           AND SIZE                       19084 01409602
         DROP  R4                                                 19084 01411302
         MR    RC,RC               ID TIMES SIZE                  19084 01413002
         AR    R4,RD               PLUS ADDR OF FIRST UCME       Y02669 01414702
         USING UCMLIST,R4          GIVES ISSUERS UCME             19084 01416402
         MVC   XACAHOLD(TWO),UCMAUTH    MOVE OVER HIS C.A.     @Z30LPTJ 01419803
         LR    RD,RE              RESTORE REG13 SAVE AREA PTR    Y02669 01421802
         BCR   FIFTN,R5            RETURN                         19084 01423202
         EJECT                                                          01424902
*********************************************************************** 01426602
*                                                                 19084 01428302
*        EXIT ROUTINES                                            19084 01430002
*                                                                 19084 01431702
*********************************************************************** 01433402
FOR2EXT  EQU   *                                                 Y01029 01436802
         MVC   XAX+TRE(TWO),MOD42                                Y02669 01438802
         L     RF,UCMMOD     ADDRESS OF IEE4203D                 Y01029 01441902
         B     COMONEXT      GO TO EXIT RTN                      Y02669 01445302
*                                                                Y02669 01448002
FOR4EXT  EQU   *                                                 Y02669 01448402
         MVC   XAX+TRE(TWO),MOD44                                Y02669 01448502
         L     RF,VCON44           ADDRESS OF 4403D              Y02669 01448602
COMONEXT EQU   *                                                 Y02669 01448702
         LM    R0,RE,ZERO(RD)    RESTORE ALL REGS BUT BRANCH REG Y02669 01448802
         BR    RF                  BRANCH TO NEXT RTN            Y02669 01449002
*                                                                       01449202
SERR3    MVI   XAE,ERR7                 DELIMITER ERROR          Y01029 01450402
         B     SERR05                   MSG MOD IS 0503D         Y01029 01452102
*                                                                 19084 01453802
SERR4    MVI   XAE,ERR8                 TERM LENGTH ERROR        Y01029 01457202
*                                                                 19084 01458902
SERR05   EQU   *                                                        01462302
         SPACE 5                                                        01462702
**************************************************               Y02651 01463102
*                                                                Y02651 01463202
*  THIS IS A TERMINAL ERROR CONDITION. A DEQ WILL BE             Y02651 01463602
*  ISSUED BEFORE EXITING TO THE ERROR MESAGE MODULE.             Y02651 01464002
*                                                                Y02651 01464102
         BAL   R4,SDEQUE                                         Y02651 01464202
*                                                                Y02651 01464302
**************************************************               Y02651 01465302
         SPACE 5                                                        01465402
         LOAD  EP=IEE0503D                                       Y02669 01465502
         LR    RF,R0               GET ADDRESS OF RTN IN REG15   Y02669 01465602
         MVC   XAX+TRE(TWO),MOD05                                Y02669 01465702
         XC    XAA(TWO),XAA        CLEAR OUT VARY RANGE BITS   @Z30LPTJ 01466003
         BALR  RE,RF               GO TO 0503D                   Y02669 01468203
* ON RETURN                                                      Y02669 01468403
         LM    R0,RF,ZERO(RD)      RESTORE ALL REGS              Y02669 01468803
         STH   R8,XAA              RESTORE VARY RANGE BITS     @Z30LPTJ 01469003
         DELETE EP=IEE0503D                                      Y02669 01469203
EXIT     EQU   *                                                 Y02669 01469403
         TM    XAAVRANG,XAARNG1    VARY RANGE BEING PROCESSED? @Z30LPTJ 01469703
         BO    CB904EXT            YES, EXIT VIA IEECB904      @Z30LPTJ 01469803
         L     R1,D64(RD)          GET CSCB PTR                  Y02669 01469903
         USING CHAIN1,R1                                         Y02669 01470103
         OI    CHSTS,CHFC          SET FREE CSCB                 Y02669 01470303
         MGCR  (1),CHAIN                                         Y02669 01470503
         LM    R0,RF,ZERO(RD)      RESTORE ALL REGS              Y02669 01470703
         LR    R4,RE               SAVE RETURN ADDRESS           Y02669 01471003
         LA    R0,D132             SAVE AREA SIZE                Y02669 01471303
         LR    R1,R2               SAVE AREA POINTER             Y02669 01471603
         FREEMAIN R,LV=(0),A=(1)                                 Y02669 01471903
*                                  FREE SAVE AREA                Y02669 01472203
*                                  FREE DUMMY XSA GOTTEN IN 3603DY02669 01472503
         LR    RE,R4               RESTORE RETURN REG            Y02669 01472803
         BR    RE                  RETURN                        Y02669 01473103
*                                                                Y02669 01473403
*                                                                 19084 01473703
SERR1    MVI   XAE,ERR41                 AUTHORITY INVALID MSG   Y01029 01474203
         SPACE 5                                                        01474602
**************************************************               Y02651 01475002
*                                                                Y02651 01475202
*  THIS IS A TERMINAL ERROR CONDITION. A DEQ WILL BE             Y02651 01475302
*  ISSUED BEFORE EXITING TO THE ERROR MESSAGE MODULE.            Y02651 01475402
*                                                                Y02651 01475502
         BAL   R4,SDEQUE                                         Y02651 01475602
*                                                                Y02651 01475702
**************************************************               Y02651 01476402
         SPACE 5                                                        01476602
         LOAD  EP=IEE2103D                                       Y02669 01476802
         LR    RF,R0               GET RTN'S ADDRESS INTO REG15  Y02669 01477002
         MVC   XAX+TRE(TWO),MOD21                                Y02669 01477202
         XC    XAA(TWO),XAA        CLEAR OUT VARY RANGE BITS   @Z30LPTJ 01477303
         BALR  RE,RF               GO TO 2103D                   Y02669 01477402
*  ON RETURN                                                     Y02669 01477602
         LM    R0,RF,ZERO(RD)      RESTORE ALL REGS              Y02669 01477702
         STH   R8,XAA              RESTORE VARY RANGE BITS     @Z30LPTJ 01483203
         DELETE EP=IEE2103D                                      Y02669 01483303
         B     EXIT                                              Y02669 01493703
*                                                                 19084 01498003
CB904EXT EQU   *                                               @Z30LPTJ 01503103
         OI    XAAVRANG,XAARNG3    TURN TERMINATION EXIT BIT ON@Z30LPTJ 01504103
         L     RF,VCON904          GET IEECB904 ADDRESS        @Z30LPTJ 01505103
         BR    RF                  GO TO VARY RANGE PROCESSOR  @Z30LPTJ 01506103
         EJECT                                                          01507103
*****************************************************************Y02651 01508203
*                                                                Y02651 01513303
*  THIS IS THE DEQ SUBROUTINE                                    Y02651 01523503
*  THE ENQ WAS ISSUED IN MODULE IEE3603D                         Y02651 01526903
SDEQUE   EQU   *                                                 Y02651 01530303
         TM    XAAVRANG,XAARNG1    VARY RANGE BEING PROCESSED? @Z30LPTJ 01531303
         BO    PROCEED             YES, AVOID DEQUEING         @Z30LPTJ 01532303
         DEQ   MF=(E,IEFDEQUE)                                   Y02651 01535403
PROCEED  EQU   *                                               @Z30LPTJ 01545203
         BR     R4                                               Y02651 01546203
*****************************************************************Y02651 01547303
         EJECT                                                          01552403
*****************************************************************Y02651 01560903
*                                                                Y02651 01562603
*  THE LIST FORM OF THE DEQ MACRO INTRUCTION FOLLOWS             Y02651 01567703
*                                                                Y02651 01576203
IEFDEQUE DEQ   (IEFSQCBS,IEFQ4QCB,TWO,SYSTEM,IEFSQCBS,IEFVQCBS,SVN,    *01579603
               SYSTEM),RET=HAVE,MF=L                           @YM5443P 01584603
IEFVQCBS DC    C'VARYDEV'                                               01589603
IEFSQCBS DC    C'SYSIEFSD'                                       Y02651 01594603
IEFQ4QCB DC    C'Q4'                                             Y02651 01599603
*                                                                Y02651 01604603
*****************************************************************Y02651 01609603
         EJECT                                                          01614603
*********************************************************************** 01619603
*                                                                 19084 01624603
*        CONSTANTS USED BY 3303D                                  19084 01629603
*                                                                 19084 01634603
*********************************************************************** 01639603
HIUNIT    DC    C'(I-'                   BEGINNING OF COMPOSITE   19084 01644603
HOUNIT   DC    C',O-'                   MIDDLE OF COMPOSITE       19084 01649603
*                                       OR OUTPUT UNIT            19084 01654603
ONLINE   DC    C'ON'                    ONLINE KEYWORD            19084 01659603
*                                                                 19084 01664603
         DS    0F                                                Y02669 01669603
SMFMOD   DC    V(IEE2303D)              SMF MODULE               Y02669 01674603
UCMMOD   DC    V(IEE4203D)              MCS UCM SCANNER          Y02669 01679603
VCON44   DC    V(IEE4403D)                                       Y02669 01684603
VCON904  DC    V(IEECB904)                                     @Z30LPTJ 01689603
*                                                                Y02669 01694603
MOD23    DC    C'23'                                             Y02669 01699603
MOD42    DC    C'42'                                             Y02669 01704603
MOD44    DC    C'44'                                             Y02669 01709603
MOD05    DC    C'05'                                             Y02669 01714603
MOD21    DC    C'21'                                             Y02669 01719603
*                                                                Y02669 01724603
         SPACE 5                                                        01729603
PATCH    DC    CL50'***IEE3303D***'                            @Z30LPTJ 01734603
         EJECT                                                          01739603
SXSA     DSECT                                                          01744603
         IEEXSA                                                         01749603
         EJECT                                                          01771002
CVT      DSECT                                                   Y01029 01774002
         CVT                                                            01777002
         EJECT                                                          01780002
UUCM     DSECT                                                   Y01029 01783002
         IEECUCM   FORMAT=NEW                                           01786002
         EJECT                                                          01790002
CHAIN1   DSECT                                                          01790402
         IEECHAIN                                                       01792002
         EJECT                                                          01794002
         IEESMCA                                                        01796002
         END                                                            01800001
./  ADD  SSI=70030431,NAME=IEE3503D
         TITLE 'IEE3503D - DISPLAY / TRACK ROUTER'                      00100002
*********************************************************************** 00150002
*                                                                     * 00200002
*  MODULE NAME  =  IEE3503D                                     Y02669* 00250002
*                                                                     * 00300002
*  DESCRIPTION  =  ROUTER FOR DISPLAY AND TRACK COMMANDS        Y02669* 00350002
*                                                                     * 00400002
*  COPYRIGHT    =  N/A                                          Y02669* 00450002
*                                                                     * 00500002
*  STATUS       =  VS/2 - DUMPING IMPROVEMENTS                @G33CPMR* 00501043
*                                                                     * 00600002
*  FUNCTION     =  THIS MODULE DETERMINES THE DISPLAY COMMAND   Y02669* 00650002
*                  OPERANDS: D  A          ACTIVE               Y02669* 00700002
*                               C,K        K COMMAND OPERANDS   Y02669* 00800002
*                               DMN        DOMAIN             @Z40BPSV* 00805041
*                               DUMP       DUMP               @G33CPMR* 00825043
*                               CONSOLES(C)CONSOLES             YM1916* 00850002
*                               JOBS (J)   JOBS, STARTED TASKS  Y02669* 00950002
*                               M          MATRIX               Y02651* 01000002
*                               NET        VTAM                 Y02674* 01010002
*                               PFK        PGM FUNCTION KEYS    Y02669* 01050002
*                               R          REQUESTS             Y02669* 01100002
*                               SLIP       SERVICEABILITY     @G17SPTJ* 01110041
*                                           LEVEL INDICATOR   @G17SPTJ* 01120041
*                                            PROGRAM          @G17SPTJ* 01130041
*                               T          TIME                 Y02669* 01150002
*                               TP         TCAM                 Y02669* 01200002
*                               TS         TIME SHARING USERIDS Y02669* 01250002
*                               U          UNITS                Y02669* 01300002
*                               3850       MSS COMMAND        @Z40LPTA* 01310041
*                                                                     * 01350002
*                  AND THE TRACK OPERANDS:                      Y02669* 01400002
*                           TR  A          ACTIVE               Y02669* 01450002
*                               JOBS (J)   JOBS, STARTED TASKS  Y02669* 01550002
*                               TS         TIME SHARING USERIDS Y02669* 01600002
*                  (THE TRACK COMMAND IS A TIMER INTERVAL       Y02669* 01650002
*                  DRIVEN DISPLAY.)                             Y02669* 01660002
*                                                                     * 01670002
*                  IT THEN ROUTES SPECIFIC INFORMATION IN THE   Y02669* 01680002
*                  XSA (EXTENTED SAVE AREA) TO THE APPROPIATE   Y02669* 01690002
*                  PROCESSOR.                                   Y02669* 01692002
*                                                                     * 01694002
*                  ONLY D T (DISPLAY TIME) IS HANDLED           Y02669* 01696002
*                  EXCLUSIVELY IN IEE3503D.                     Y02669* 01698002
*                                                                     * 01700002
     EJECT                                                              01710041
*                                                                     * 01720041
*   OPERATION   =  FOR D U; U,; THE VERB CODE IN XAN IS CHANGED Y02669* 01750002
*                  TO X'52', IEE3503D BRANCHES TO IEE7503D TO   Y02669* 01800002
*                  RESOLVE THE ROUTING OPERAND (L=CCA) OR       Y02669* 01850002
*                  DETERMINE THE DEFAULTS.                      Y02669* 01900002
*                                                                     * 01950002
*                  FOR D M; M,; M= THE VERB CODE IN XAN IS      Y02651* 02000002
*                  CHANGED TO X'32', IEE3503D BRANCHES TO       Y02651* 02010002
*                  IEE7503D TO RESOLVE THE ROUTING OPERAND      Y02651* 02050002
*                  (L=CCA) OR DETERMINE THE DEFAULTS.           Y02651* 02100002
*                                                                     * 02150002
*                  FOR D TS; TS,; JOBS(J); JOBS,(J,); A; A,;    Y02669* 02200002
*                  A BIT IS SET IN XAX (XAXMASK), IEE3503D      Y02669* 02250002
*                  BRANCHES TO IEE7503D TO ESTABLISH ROUTING    Y02669* 02300002
*                  INFORMATION FROM THE L=CCA OPERAND OR        Y02669* 02350002
*                  DETERMINE THE APPROPIATE DEFAULTS            Y02669* 02360002
*                  AND CHECK FOR AND PROCESS THE 'LIST'(L)      Y02669* 02400002
*                  OPERAND. (SEE OUTPUT FOR BIT SETTINGS)       Y02669* 02500002
*                                                                     * 02550002
*                  FOR D C,K; C,K,; CONSOLES(C); CONSOLES,(C,); YM1916* 02600002
*                  THE VERB CODE IN XAN IS CHANGED TO X'2C'     Y02669* 02630002
*                  FOR C,K AND X'3E' FOR CONSOLES; IEE3503D     YM1916* 02660002
*                  BRANCHES TO IEE7503D TO RESOLVE THE ROUTING  Y02669* 02690002
*                  OPERAND (L=CCA) OR DETERMINE THE DEFAULTS.   Y02669* 02720002
*                                                                     * 02750002
*                  FOR D R; R,; THE VERB CODE IN XAN IS         Y02669* 02800002
*                  CHANGED TO X'42', IEE3503D BRANCHES TO       Y02669* 02804002
*                  IEE7503D TO RESOLVE THE ROUTING OPERAND      Y02669* 02810002
*                  (L=CCA) OR DETERMINE THE DEFAULTS.           Y02669* 02820002
*                                                                     * 02900002
*                  FOR D PFK; THE VERB CODE IN XAN IS CHANGED   Y02669* 02950002
*                  TO X'36'AND XAS IS SET TO ZEROES, IEE3503D   Y02669* 02960002
*                  BRANCHES TO IEE0803D TO CREATE A CSCB.       Y02669* 03000002
*                                                                     * 03050002
*                  FOR D T; THE FOLLOWING MESSAGE IS WRITTEN    Y02669* 03100002
*                  TO THE OPERATOR VIA WTO OR TPUT:             Y02669* 03150002
*                    IEE136I    TIME=XX.XX.XX    DATE=XX.XXX    Y02669* 03200002
*                  CONTROL IS RETURNED.                         Y02669* 03250002
*                                                                     * 03300002
*                  FOR D TP,; IEE3503D BRANCHES TO IED1303D.    Y02669* 03350002
*                                                                     * 03400002
*                  FOR D NET,; IEE3503D BRANCHES TO ISTCFF3D.   Y02674* 03450002
*                                                                     * 03460040
*                  FOR D 3850; IEE3503D BRANCHES TO IEE7503D  @Z40LPTA* 03465041
*                                                                     * 03480040
*                  FOR D DMN; IEE3503D BRANCHES TO IEE7503D   @Z40BPSV* 03482041
*                                                                     * 03500002
         EJECT                                                          03503041
*                                                                     * 03506041
*                  FOR D SLIP, THE VERB CODE IN XAN IS        @G17SPTJ* 03509041
*                  CHANGED TO X'A8'.  IEE3503D BRANCHES TO    @G17SPTJ* 03512041
*                  IEE7503D TO RESOLVE THE ROUTING OPERAND    @G17SPTJ* 03515041
*                  (L=CCA) OR TO DETERMINE THE DEFAULTS       @G17SPTJ* 03518041
*                                                                     * 03518443
*                  FOR D DUMP, THE VERB CODE IN XAN IS        @G33CPMR* 03518843
*                  CHANGED TO X'B0'.  IEE3503D BRANCHES TO    @G33CPMR* 03519143
*                  IEE7503D TO RESOLVE THE ROUTING OPERAND    @G33CPMR* 03519443
*                  (L=CCA) OR TO DETERMINE THE DEFAULTS       @G33CPMR* 03519743
*                                                                     * 03520443
*                  **** NOTE ****                             @G17SPTJ* 03524041
*                    FOR 'D DMN', 'D SLIP' AND 'D DUMP':      @G33CPMR* 03525043
*                  WHENEVER THE ABOVE-MENTIONED COMMANDS ARE  @G17SPTJ* 03530041
*                  ENTERED, THEY ARE CHECKED OUT FURTHER TO   @G17SPTJ* 03533041
*                  SEE IF THE SYSTEM SUPPORTS THE SU'S THAT   @G17SPTJ* 03536041
*                  ARE ASSOCIATED WITH THE COMMAND.           @G17SPTJ* 03539041
*                                                             @G17SPTJ* 03542041
*                  FOR TR TS; TS,; JOBS(J); JOBS,(J,); A; A,;   Y02669* 03550002
*                  A BIT IS SET IN XAX (XAXMASK), IEE3503D      Y02669* 03600002
*                  BRANCHES TO IEE7503D TO ESTABLISH ROUTING    Y02669* 03650002
*                  INFORMATION FROM THE L=CCA OPERAND OR        Y02669* 03700002
*                  DETERMINE THE APPROPIATE DEFAULTS AND        Y02669* 03710002
*                  CHECK FOR AND PROCESS THE 'LIST' (L)         Y02669* 03750002
*                  OPERAND.(SEE OUTPUT FOR BIT SETTINGS)        Y02669* 03820002
*                                                                     * 03900002
         EJECT                                                          03910041
*                                                                     * 03920041
*  NOTES                                                        Y02669* 03950002
*                                                                     * 04000002
*  CHARACTER/                                                   Y02669* 04050002
*  CODE                                                         Y02669* 04100002
*  DEPENDENCIES =  ANY CHARACTER CODE OTHER THAN EBCDIC WILL    Y02669* 04150002
*                  REQUIRE REASSEMBLY OF THIS MODULE.           Y02669* 04200002
*                                                                     * 04250002
*  DEPENDENCIES =  IEE0403D TO RECOGNIZE THE DISPLAY AND        Y02669* 04300002
*                  TRACK COMMANDS AND PASS THE OPERAND          Y02669* 04350002
*                  INFORMATION IN THE XSA.                      Y02669* 04400002
*                                                                     * 04450002
*                  SVC 100 WILL REJECT AS INVALID D A AND       Y02669* 04500002
*                  THE TRACK COMMAND FROM ANY TIME SHARING      Y02669* 04550002
*                  TERMINAL INCLUDING THOSE IN OPERATOR MODE.   Y02669* 04600002
*                                                                     * 04650002
*                  ISTCFF3D WILL VALIDITY CHECK FOR NET,.       Y02674* 04700002
*                                                                     * 04920002
*                  MP WILL BE SUPPORTED AS A STANDARD           Y02651* 04930002
*                  AND D M (MATRIX) WILL BE INCLUDED.           Y02651* 04940002
*                                                                     * 04950002
*                  THE MSGRT COMMAND WILL PROVIDE SUPPORT FOR   Y02669* 05000002
*                  A ROUTING DEFAULT FOR D TS; JOBS; A; R;      Y02669* 05050002
*                  AND TR TS; JOBS; AND A.                      Y02669* 05100002
*                                                                     * 05110002
*                  JOBS AND J AND JOBS,LIST AND J,L WILL BE     Y02669* 05120002
*                  SUPPORTED. L CAN SUBSTITUTE FOR 'LIST'.      Y02669* 05130002
*                                                                     * 05150002
*                  A SU TABLE (IHASUBIT) REFLECTING THE SU'S  @G17SPTJ* 05160041
*                  INSTALLED ON THIS SYSTEM.                  @G17SPTJ* 05170041
*                                                                     * 05180041
*  RESTRICTIONS =  TIME SHARING TERMINALS INCLUDING THOSE IN    Y02669* 05200002
*                  OPERATOR MODE ARE NOT PERMITTED TO ISSUE D A.Y02669* 05250002
*                                                                     * 05260002
*                  THE 'L' OPERAND FROM A TIME SHARING USER     Y02669* 05300002
*                  ON D C,K; CONSOLES(C); JOBS; M; TS; R; U     YM1916* 05350002
*                  WILL BE DETECTED AS INVALID IN IEE7503D.     Y02669* 05400002
*                                                                     * 05450002
*                  NO TIME SHARING TERMINAL IS PERMITTED TO     Y02669* 05500002
*                  ISSUE THE TRACK COMMAND.                     Y02669* 05550002
*                                                                     * 05600002
*  REGISTER/                                                    Y02669* 05650002
*  CONVENTIONS  =  NONE                                         Y02669* 05700002
*                                                                     * 05750002
*  PATCH-LABEL  =  PATCH                                        Y02669* 05800002
*                                                                     * 05850002
* MODULE TYPE   =  CSECT                                        Y02669* 05900002
*                                                                     * 05950002
*  PROCESSOR    =  N/A                                          Y02669* 05960002
*                                                                     * 05970002
*  MODULE SIZE  =  X'3DD'                                     @G33CPMR* 05972043
*                                                                     * 05982002
*                                                                     * 05983241
*   ATTRIBUTES  =  REENTRANT, SUPERVISOR MODE, KEY ZERO,        Y02669* 05984002
*                  PAGED LPA                                    Y02669* 05986002
*                                                                     * 05988002
*  ENTRY POINT  =  IEE3503D FROM IEE0403D                       Y02669* 05988402
*  PURPOSE      =  TO ROUTE THE DISPLAY OR TRACK                Y02669* 05988802
*                  COMMAND TO THE PROPER PROCESSOR.             Y02669* 05989202
*  LINKAGE      =  BRANCH                                       Y02669* 05989602
*  INPUT DATA   =  REGISTER 2 POINTS TO XSA                     Y02669* 05989702
*                    XAL POINTS TO 1ST OPERAND IN BUFFER        Y02669* 05989802
*                    XAU IS 1-BYTE UCMI (X'00' COMMAND ISSUED   Y02669* 05989902
*                        INTERNALLY OR FROM THE INPUT STREAM)   Y02669* 05990302
*                    XAA CONTAINS THE ASID (X'0000' = NON-TS)   Y02669* 05990602
*                    XAN CONTAINS THE VERB CODE X'68' - DISPLAY Y02669* 06010002
*                                               X'C4' - TRACK   Y02669* 06012002
*                    XAR POINTS TO THE LENGTH FIELD AT THE      Y02669* 06014002
*                        BEGINNING OF THE COMMAND BUFFER        Y02669* 06016002
*                    XAV CONTAINS THE COMMAND VERB              Y02669* 06018002
*                    XAP CONTAINS ADDRESS OF END OF BUFFER +1   Y02669* 06020002
*                                                                     * 06022002
*   REGISTERS                                                   Y02669* 06024002
*    SAVED      =  NONE  (REGISTER 14 REMAINS UNTOUCHED)        Y02669* 06026002
*                                                                     * 06028002
*    CONTENTS DURING                                            Y02669* 06032002
*     PROCESSING=  R0   WORK REGISTER                           Y02669* 06034002
*                  R1   WORK REGISTER                           Y02669* 06036002
*                  R2   INPUT REGISTER - POINTER TO XSA         Y02669* 06038002
*                  R3   MODULE BASE REGISTER                    Y02669* 06040002
*                  R4   USED TO CONTAIN UCMI FOR WTO            Y02669* 06042002
*                  R5   PTR TO COMMAND BUFFER AND               Y02669* 06044002
*                       CONTAINS ASID FOR TPUT                  Y02669* 06046002
*                  R6   USED TO ADDRESS COMPARE TABLE ENTRIES   Y02669* 06048002
*                        AND THE SU BIT STRING                @G17SPTJ* 06049041
*                  R7   UNUSED                                  Y02669* 06050002
*                  R8   UNUSED                                  Y02669* 06052002
*                  R9   WORK REGISTER                           Y02669* 06054002
*                  R10  CONTAINS SU NUMBER                    @G17SPTJ* 06055041
*                  R11  ADDRESSES END OF COMPARE TABLE          Y02669* 06058002
*                  R12  UNUSED                                  Y02669* 06060002
*                  R13  UNUSED                                  Y02669* 06062002
*                  R14  RETURN ADDRESS                          Y02669* 06064002
*                  R15  USED FOR BAL, RC FROM TPUT, AND BR EXIT Y02669* 06066002
*                                                                     * 06068002
*    RESTORED    = NONE                                         Y02669* 06070002
*                                                                     * 06072002
      EJECT                                                             06073041
*  *  *  *  *  *  *  *  *  *  *  *  *  *  *  *  *  *  *  *  *  *  *  *  06074002
*                                                                     * 06076002
** EXIT - NORMAL = RETURN VIA BR R14 FROM DDTIM                 Y02669* 06078002
*   CONDITIONS   = FOR D T                                      Y02669* 06080002
*   OUTPUT DATA  = IEE136I  TIME=XX.XX.XX   DATE=XX.XXX VIA WTO Y02669* 06082002
*   RETURN CODES = NONE                                         Y02669* 06084002
*                                                                     * 06086002
*  *  *  *  *  *  *  *  *  *  *  *  *  *  *  *  *  *  *  *  *  *  *  *  06088002
*                                                                     * 06090002
** EXIT - NORMAL = RETURN VIA BR R14 FROM XTPUT                 Y02669* 06092002
*   CONDITIONS   = FOR D T                                      Y02669* 06094002
*   OUTPUT DATA  = IEE136I  TIME=XX.XX.XX  DATE=XX.XXX VIA TPUT Y02669* 06096002
*   RETURN CODES = NONE                                         Y02669* 06098002
*                                                                     * 06100002
*  *  *  *  *  *  *  *  *  *  *  *  *  *  *  *  *  *  *  *  *  *  *  *  06102002
*                                                                     * 06104002
** EXIT - NORMAL = BRANCH TO IEE0803D FROM DDPFK                Y02669* 06106002
*   CONDITIONS   = TO CREATE A CSCB FOR D PFK                   Y02669* 06108002
*   OUTPUT DATA  = R2 POINTS TO XSA                             Y02669* 06110002
*                    XAN NOW CONTAINS X'36'                     Y02669* 06112002
*                    XAS CLEARED (WILL CONTAIN ZEROES)          Y02669* 06112402
*                        CONTAINS VALID INPUT TO IEE0803D.      Y02669* 06112502
*                        FOR ALL OTHER DISPLAY FUNCTIONS        Y02669* 06112602
*                        THIS FIELD IS FILLED IN IN IEE7503D    Y02699* 06112702
*                    XAX CLEARED (WILL CONTAIN ZEROES)          Y02669* 06112802
*   RETURN CODES = NONE                                         Y02669* 06114002
*                                                                     * 06116002
*  *  *  *  *  *  *  *  *  *  *  *  *  *  *  *  *  *  *  *  *  *  *  *  06134002
*                                                                     * 06136002
** EXIT - NORMAL = BRANCH TO IEE7503D FROM DD7503D              Y02669* 06138002
* 1 CONDITIONS   = TO VALIDITY CHECK:                           Y02669* 06140002
*                    L=CCA,LIST FOR  D A,  AND A                Y02669* 06142002
*                                      TS,  AND TS              Y02669* 06144002
*                                      JOBS, AND JOBS (J, & J)  Y02669* 06146002
*                                    TR A, AND A                Y02669* 06148002
*                                       TS, AND TS              Y02669* 06150002
*                                       JOBS, & JOBS (J, & J)   Y02669* 06152002
*   OUTPUT DATA  = R2 POINTS TO XSA                             Y02669* 06154002
*                    XAP CONTAINS ADDRESS OF END OF BUFFER +1   Y02669* 06156002
*                    XAN STILL CONTAINS X'68' FOR DISPLAY       Y02669* 06158002
*                                       X'C4' FOR TRACK         Y02669* 06160002
*                    XAXMASK WILL CONTAIN AN INDICATOR          Y02669* 06162002
*                      SPECIFYING THE DESIRED DISPLAY OR        Y02669* 06164002
*                      TRACK FUNCTION:                          Y02669* 06166002
*                      X'80' FOR JOBS                           Y02669* 06168002
*                      X'08' FOR TS                             Y02669* 06170002
*                      X'88' FOR A                              Y02669* 06172002
*   RETURN CODES = NONE                                         Y02669* 06174002
* 2 CONDITIONS   = TO VALIDITY CHECK L=CCA FOR D U AND U,       Y02669* 06176002
*   OUTPUT DATA  = R2 POINTS TO XSA                             Y02669* 06178002
*                    XAP CONTAINS ADDRESS OF END OF BUFFER +1   Y02669* 06180002
*                    XAN NOW CONTAINS X'52'                     Y02669* 06182002
*                    XAXMASK WILL CONTAIN ZEROES                Y02669* 06184002
*   RETURN CODES = NONE                                         Y02669* 06186002
* 3 CONDITIONS   = TO VALIDITY CHECK L=CCA FOR D C,K; C,K,;     Y02669* 06188002
*                    CONSOLES(C); AND CONSOLES,(C,)             YM1916* 06190002
*   OUTPUT DATA  = R2 POINTS TO XSA                             Y02669* 06192002
*                    XAP CONTAINS ADDRESS OF END OF BUFFER +1   Y02669* 06194002
*                    XAN NOW CONTAINS X'2C' FOR C,K             Y02669* 06196002
*                                     X'3E' FOR CONSOLES(C)     YM1916* 06198002
*                    XAXMASK WILL CONTAIN ZEROES                Y02669* 06200002
*   RETURN CODES = NONE                                         Y02669* 06202002
* 4 CONDITIONS   = TO VALIDITY CHECK L=CCA FOR D M; M=; AND M,  Y02651* 06204002
*   OUTPUT DATA  = R2 POINTS TO XSA                             Y02651* 06206002
*                    XAP CONTAINS ADDRESS OF END OF BUFFER +1   Y02669* 06208002
*                    XAN NOW CONTAINS X'32'                     Y02651* 06210002
*                    XAXMASK WILL CONTAIN ZEROES                Y02651* 06212002
*   RETURN CODES = NONE                                         Y02651* 06214002
* 5 CONDITIONS   = TO VALIDITY CHECK L=CCA FOR D R AND R,       Y02669* 06214402
*   OUTPUT DATA  = R2 POINTS TO XSA                             Y02669* 06214802
*                    XAP CONTAINS ADDRESS OF END OF BUFFER +1   Y02669* 06214902
*                    XAN NOW CONTAINS X'42'                     Y02651* 06215002
*                    XAXMASK WILL CONTAIN ZEROES                Y02651* 06215102
*   RETURN CODES = NONE                                         Y02669* 06215202
* 6 CONDITIONS   = TO VALIDITY CHECK L=CCA FOR D 3850 AND     @Z40LPTA* 06216041
*                    3850,                                    @Z40LPTA* 06216241
*   OUTPUT DATA  = R2 POINTS TO XSA                           @Z40LPTA* 06216441
*                    XAP CONTAINS ADDRESS OF END OF BUFFER +1 @Z40LPTA* 06216641
*                    XAN NOW CONTAINS X'F3'                   @Z40LPTA* 06216841
*                    XAXMASK WILL CONTAIN ZEROES              @Z40LPTA* 06217041
*   RETURN CODES = NONE                                       @Z40LPTA* 06217241
* 7 CONDITIONS   = TO VALIDITY CHECK L=CCA FOR D DMN; DMN=;   @Z40BPSV* 06218041
*                    DMN,                                     @Z40BPSV* 06218141
*   OUTPUT DATA  = R2 POINTS TO XSA                           @Z40BPSV* 06218241
*                    XAP CONTAINS ADDRESS OF END OF BUFFER +1 @Z40BPSV* 06218341
*                    XAN NOW CONTAINS X'88'                   @Z40BPSV* 06218441
*                    XAXMASK WILL CONTAIN ZEROES              @Z40BPSV* 06218541
*   RETURN CODES = NONE                                       @Z40BPSV* 06218641
* 8 CONDITIONS   = TO VALIDITY CHECK L=CCA FOR D SLIP; SLIP=; @G17SPTJ* 06218741
*                    SLIP,                                    @G17SPTJ* 06218841
*   OUTPUT DATA  = R2 POINTS TO XSA                           @G17SPTJ* 06218941
*                    XAP CONTAINS ADDRESS OF END OF BUFFER +1 @G17SPTJ* 06219041
*                    XAN NOW CONTAINS X'A8'                   @G17SPTJ* 06219141
*                    XAXMASK WILL CONTAIN ZEROES              @G17SPTJ* 06219241
*   RETURN CODES = NONE                                       @Z40BPSV* 06219341
* 9 CONDITIONS   = TO VALIDITY CHECK L=CCA FOR D DUMP AND     @G33CPMR* 06219443
*                    D DUMP,                                  @G33CPMR* 06219743
*   OUTPUT DATA  = R2 POINTS TO XSA                           @G33CPMR* 06220043
*                    XAP CONTAINS ADDRESS OF END OF BUFFER +1 @G33CPMR* 06220343
*                    XAN NOW CONTAINS X'B0'                   @G33CPMR* 06220643
*                    XAXMASK WILL CONTAIN ZEROES              @G33CPMR* 06220943
*   RETURN CODES = NONE                                       @G33CPMR* 06221243
*                                                                     * 06221943
*  *  *  *  *  *  *  *  *  *  *  *  *  *  *  *  *  *  *  *  *  *  *  *  06222343
*                                                                     * 06222743
** EXIT - NORMAL = BRANCH TO IED1303D FROM DDTP                 Y02669* 06223643
*   CONDITIONS   = FOR D TP,                                    Y02669* 06224002
*   OUTPUT DATA  = R2 POINTS TO XSA                             Y02669* 06226002
*   RETURN CODES = NONE                                         Y02669* 06228002
*                                                                     * 06230002
*  *  *  *  *  *  *  *  *  *  *  *  *  *  *  *  *  *  *  *  *  *  *  *  06234402
*                                                                     * 06236002
** EXIT - NORMAL = BRANCH TO ISTCFF3D FROM DDNET                Y02674* 06238002
*   CONDITIONS   = FOR D NET,                                   Y02674* 06240002
*   OUTPUT DATA  = R2 POINTS TO XSA                             Y02674* 06242002
*   RETURN CODES = NONE                                         Y02674* 06244002
*                                                                     * 06246002
*  *  *  *  *  *  *  *  *  *  *  *  *  *  *  *  *  *  *  *  *  *  *  *  06248002
*                                                                     * 06253040
** EXIT - ERROR  = RETURN VIA BR R14 FROM XTPUT                 Y02669* 06253840
*   CONDITIONS   = FOR D T; TPUT FAILED DUE TO OUTSTANDING TPUT Y02669* 06254002
*   OUTPUT DATA  = NONE                                         Y02669* 06256002
*   RETURN CODES = REG 15 CONTAINS X'00000014'                  Y02669* 06258002
*                                                                     * 06260002
*  *  *  *  *  *  *  *  *  *  *  *  *  *  *  *  *  *  *  *  *  *  *  *  06262002
*                                                                     * 06264002
** EXIT - ERROR  = BRANCH TO IEE0503D FROM D0503D               Y02669* 06266002
*   CONDITIONS   = TO ISSUE MESSAGE 'IEE305I COMMAND INVALID',  Y02669* 06268002
*                  IF AN INVALID DISPLAY OR TRACK OPERAND IS    Y02669* 06270002
*                  FOUND.                                       Y02669* 06270402
*                  TO ISSUE MESSAGE 'IEE026I COMMAND NOT      @G17SPTJ* 06270841
*                  SUPPORTED' WHEN SYSTEM DOES NOT SUPPORT    @G17SPTJ* 06271241
*                  THE SU REQUIRED BY THE COMMAND.            @G17SPTJ* 06271641
*                  TO ISSUE MESSAGE 'IEE311I PARAMETER MISSING',Y02669* 06272002
*                  IF NO OPERAND IS FOUND IN THE COMMAND BUFFER.Y02669* 06274002
*                  TO ISSUE MESSAGE 'IEE341I CLOCK NOT ACTIVE', Y02669* 06274402
*                  IF THE TIME MACRO RETURNS AN ERROR CODE      Y02669* 06274802
*                  FOR DISPLAY TIME (D T).                      Y02669* 06275202
*   OUTPUT DATA  = ERROR CODES FOR MESSAGES ISSUED IN IEE0503D  Y02669* 06276002
*                  IN XSA POINTED TO BY REG 2                   Y02669* 06278002
*                    XAE WILL CONTAIN  X'05' FOR IEE305I        Y02669* 06280002
*                                      X'0B' FOR IEE311I        Y02669* 06282002
*                                      X'24' FOR IEE341I        Y02669* 06282402
*                    XAV STILL CONTAINS THE COMMAND VERB        Y02669* 06284002
*                        OR THE WORD 'CLOCK' FOR IEE341I        Y02669* 06286002
*                    XAU STILL CONTAINS THE CONSOLE ID          Y02669* 06286802
*                    XAA STILL CONTAINS ASID IF REQUESTER       Y02669* 06287202
*                        IS TIME SHARING USER ELSE X'0000'.     Y02669* 06287602
*   RETURN CODES = NONE                                         Y02669* 06287702
*                                                                     * 06288002
      EJECT                                                             06289041
*  *  *  *  *  *  *  *  *  *  *  *  *  *  *  *  *  *  *  *  *  *  *  *  06290002
*  EXTERNAL                                                     Y02669* 06292002
*   REFERENCES                                                  Y02669* 06294002
*   ROUTINES     = BRANCHES TO   IEE0803D   IEE0503D            Y02669* 06296002
*                                IED1303D   IEE7503D            Y02669* 06298002
*                                ISTCFF3D                       Y02674* 06302002
*                                                                     * 06304002
*   DATA AREAS   = PSEUDO-SACB TO BE USED THROUGHOUT SVC 34     Y02669* 06306002
*                    ORG   XAX                                  Y02669* 06308002
*                  XAXMASK  DS    C       REQUEST FLAGS         Y02669* 06310002
*                  XAXJOBS  EQU   X'80'   JOBS      (J)         Y02669* 06312002
*                  XAXJOBSL EQU   X'40'   JOBS,LIST (J,L)       Y02669* 06314002
*                  XAXTS    EQU   X'08'   TS                    Y02669* 06316002
*                  XAXTSL   EQU   X'04'   TS,LIST   (TS,L)      Y02669* 06318002
*                  XAXA     EQU   X'88'   A                     Y02669* 06320002
*                  XAXAL    EQU   X'44'   A,LIST    (A,L)       Y02669* 06322002
*                  XAXFREE  DS    C       RESERVED              Y02669* 06324002
*                  XAXUTME  DS    H       UTME=NNN VALUE        Y02669* 06326002
*                  XAXSACB  DS    F       ADDRESS OF SACB       Y02669* 06328002
*                                                                     * 06332002
*   CONTROL                                                     Y02669* 06334002
*    BLOCKS      = IEEXSA     R - INPUT - COMMAND BUFFER ADDR   Y02669* 06336002
*                             W - OUTPUT - BITS SET             Y02669* 06338002
*                  IHASUBIT   R                               @G17SPTJ* 06338641
*                  CVT        R                               @G17SPTJ* 06339241
*                                                                     * 06340002
         EJECT                                                          06340402
*    TABLES      = A COMPARE TABLE IS USED TO  DETERMINE THE    Y02669* 06342002
*                  VALIDITY OF THE OPERANDS ON THE DISPLAY AND  Y02669* 06344002
*                  TRACK COMMANDS.                              Y02669* 06376702
*                  THE FORMAT OF EACH ENTRY IS THE SAME.        Y02669* 06384402
*                                                                     * 06392102
*                  DLEN   DC   AL1(L'XXX-1) - LENGTH OF         Y02669* 06399802
*                                             SPECIFIC OPERAND  Y02669* 06407502
*                  XXX    DC   C'YYYYY' - CHARACTER OPERAND     Y02669* 06415202
*                                         REPRESENTATION        Y02669* 06422902
*                                                                     * 06430602
*                  DLEN AND 'XXX' ARE USED IN AN EX OF A CLC.   Y02669* 06438302
*                  IF THE OPERANDS MATCH, A BRANCH IS TAKEN TO  Y02669* 06446002
*                  THE CODE WHICH IN TURN BRANCHES TO THE       Y02669* 06453702
*                  PROPER PROCESSOR OR HANDLES THE COMMAND.     Y02669* 06461402
*                  OTHERWISE, THE REGISTER USED TO ADDRESS THE  Y02669* 06469102
*                  TABLE IS INCREMENTED BY TWO + THE VALUE OF   Y02669* 06476802
*                  DLEN TO REACH THE NEXT TABLE ENTRY.          Y02669* 06484502
*                  THE VALID TRACK OPERANDS ARE PLACED AT THE   Y02669* 06492202
*                  END OF THE COMPARE TABLE AND ADDRESSING OF   Y02669* 06499902
*                  THE TABLE IS ADJUSTED WHEN VALIDITY          Y02669* 06507602
*                  CHECKING THE TRACK COMMAND.                  Y02669* 06515302
*                                                                     * 06523002
*                  A BRANCH TABLE IS USED IN CONNECTION WITH    Y02669* 06530702
*                  THE COMPARE TABLE. IT CONSISTS OF BRANCHES   Y02669* 06538402
*                  TO THE PROPER OPERAND PROCESSORS. AN INDEX   Y02669* 06546102
*                  REGISTER IS MAINTAINED THROUGHOUT THE SCAN   Y02669* 06553802
*                  OF THE COMPARE TABLE. THIS IS USED AT        Y02669* 06561502
*                  DBRANCH TO GIVE CONTROL TO THE INDICATED     Y02669* 06569202
*                  PROCESSOR VIA THE BRANCH TABLE.              Y02669* 06576902
*                                                                     * 06586902
*   MACROS       = MODID                                        Y02669* 06600002
*                  TIME                                         Y02669* 06610002
*                  WTO                                          Y02669* 06620002
*                  TPUT                                         Y02669* 06630002
*                                                                     * 06640002
*   ENQUEUE                                                     Y02669* 06650002
*     RESOURCES  = NONE                                         Y02669* 06660002
*                                                                     * 06664002
*   LOCKS HELD   = NONE                                         Y02669* 06670002
*                                                                     * 06680002
*   CHANGE LEVEL = Y02669                                       Y02669* 06700002
*                  Y02674                                       Y02674* 06750002
*                  Y02651                                       Y02651* 06800002
*                  YM1916                                       YM1916* 07800002
*                  Z40LPTA                                    @Z40LPTA* 07820041
*                  Z40BPSV                                    @Z40BPSV* 07850041
*                  G17SPTJ                                    @G17SPTJ* 07870041
*                  G33CPMR                                    @G33CPMR* 07920043
*                                                                     * 09800019
         EJECT                                                          09820002
*   MESSAGES     = THE FOLLOWING MESSAGE IS CONTAINED IN AND    Y02669* 09850002
*                  ISSUED FROM THIS MODULE:                     Y02669* 09853002
*                                                                     * 09856002
*                   IEE136I  TIME=HH.MM.SS  DATE=YY.DDD         Y02669* 09859002
*                                                                     * 09862002
*                  THE FOLLOWING MESSAGES ARE CONTAINED IN      Y02669* 09865002
*                  AND ISSUED FROM IEE0503D:                    Y02669* 09868002
*                                                                     * 09871002
*                    MSGID    CODE    MESSAGE TEXT              Y02669* 09874002
*                    _____    ____    ____________              Y02669* 09877002
*                   IEE026I   X'1A'   NOT SUPPORTED           @G17SPTJ* 09878041
*                   IEE305I   X'05'   COMMAND INVALID           Y02669* 09880002
*                   IEE311I   X'11'   PARAMETER MISSING         Y02669* 09883002
*                   IEE341I   X'24'   'CLOCK' NOT ACTIVE        Y02669* 09886002
*                                                                     * 09900002
*   SYSGEN       = INCLUDED WITH SVC 34 IN LOAD MODULE          Y02669* 09950002
*                  IGC0003D, SYSGEN MACRO SGIEF441,             Y02669* 09960002
*                  DLIB ASOB3, TARGLIB LPALIB.                  Y02669* 09970002
*                                                                     * 10000002
*   SYSTEM                                                      Y02669* 10050002
*    LIBRARIES   = NONE                                         Y02669* 10100002
*********************************************************************** 14000019
         EJECT                                                          16400019
IEE3503D CSECT                                                          16600019
*********************************************************************** 16800019
*                                                                     * 17000019
*                         REGISTER    EQUATES                         * 17200019
*                                                                     * 17400019
*********************************************************************** 17600019
R0       EQU   0                  WORK REGISTER                         17800019
R1       EQU   1                  WORK REGISTER                         18000019
R2       EQU   2                  INPUT - BASE REG FOR XSA              18200002
R3       EQU   3                  MODULE BASE REGISTER                  18400019
R4       EQU   4                  USED FOR UCMI                  Y02669 18600002
R5       EQU   5                  PTR TO OPERAND BUFFER AND ASID Y02669 18800002
R6       EQU   6                  USED TO ADDRESS TABLE ENTRIES         19000019
*                                  AND THE SU BIT STRING       @G17SPTJ 19050041
R7       EQU   7    (UNUSED)      UNUSED                         Y02669 19200002
R8       EQU   8    (UNUSED)      UNUSED                         Y02669 19400002
R9       EQU   9                  WORK REGISTER                         19600019
R10      EQU   10                 SU NUMBER STORAGE AREA       @G17SPTJ 19650041
R11      EQU   11                 ADDRESSES END OF TABLE                20000019
R12      EQU   12   (UNUSED)      UNUSED                         Y02669 20200002
R13      EQU   13   (UNUSED)      UNUSED                         Y02669 20400002
R14      EQU   14                 RETURN ADDRESS                        20600019
R15      EQU   15                 USED FOR BAL AND BRANCH EXIT          20800002
         SPACE                                                          20820041
*********************************************************************** 21000019
*                                                                     * 21200019
*                      DISPLACEMENTS AND LENGTHS                      * 21400019
*                                                                     * 21600019
*********************************************************************** 21800019
D0       EQU   0                  DISPLACEMENTS                         22000002
D1       EQU   1                                                        22200019
D2       EQU   2                                                        22400019
D3       EQU   3                                                        22600019
D4       EQU   4                                                        22650002
D5       EQU   5                                                        23000019
D6       EQU   6                                                        23200019
D7       EQU   7                                                        23400019
L0       EQU   0                  LENGTHS                        Y02669 23450002
L1       EQU   1                                                        23600019
L2       EQU   2                                                        23800019
L3       EQU   3                                                        24000019
L4       EQU   4                                                        24200019
L8       EQU   8                                                        24400019
         EJECT                                                          24420041
*********************************************************************** 24450002
*                                                                     * 24500002
*                           VERB CODES                           Y02669 24550002
*                                                                     * 24600002
*********************************************************************** 24650002
TR       EQU   X'C4'              VERB CODE FOR TRACK            Y02669 25050002
CK       EQU   X'2E'              VERB CODE FOR DISPLAY C,K      Y02669 25652002
DOMAIN   EQU   X'88'              VERB CODE FOR DISPLAY DMN    @Z40BPSV 25653040
MATRIX   EQU   X'32'              VERB CODE FOR DISPLAY MATRIX   Y02669 25656002
PFK      EQU   X'36'              VERB CODE FOR DISPLAY PFK      Y02669 25658002
CONSOLES EQU   X'3E'              VERB CODE FOR DISPLAY CONSOLES Y02669 25658402
REQUESTS EQU   X'42'              VERB CODE FOR DISPLAY REQUESTS Y02669 25660002
UNITS    EQU   X'52'              VERB CODE FOR DISPLAY UNITS    Y02669 25660402
D38      EQU   X'F3'              VERB CODE FOR DISPLAY 3850   @Z40LPTA 25661240
SLIP     EQU   X'A8'              VERB CODE FOR DISPLAY SLIP   @G17SPTJ 25661341
DUMP     EQU   X'B0'              VERB CODE FOR DISPLAY DUMP   @G33CPMR 25661443
         SPACE                                                          25662243
*********************************************************************** 25662343
*                                                                     * 25662443
*                           SU TEST BIT MASKS                  @G17SPTJ 25662543
*                                                                     * 25662643
*********************************************************************** 25662743
MASK7    EQU   7                  SU 7 BIT MASK                @G17SPTJ 25662843
MASK17   EQU   17                 SU 17 BIT MASK               @G17SPTJ 25662943
MASK33   EQU   33                 SU 33 BIT MASK               @G33CPMR 25663043
         SPACE                                                          25663643
*********************************************************************** 25663843
*                                                                     * 25664002
*                           MASKS                                Y02669 25666002
*                                                                     * 25668002
*********************************************************************** 25668402
FLAG     EQU   X'80'              FLAG - DENOTES TPUT RETRY       20030 25670002
XF0      EQU   X'F0'              MASK FOR OI                    Y02669 25680002
X0F      EQU   15                 MASK FOR STORING ALL BYTES     Y02669 25700002
*                                 IN A REGISTER                  Y02669 25702002
M7       EQU   7                  MASK FOR MOVING ADDRESS IN ICM Y02669 25712002
         SPACE                                                          25732041
*********************************************************************** 25752002
*                                                                     * 25802002
*                           ERROR CODES                          Y02669 25852002
*                                                                     * 25902002
*********************************************************************** 25952002
ERR305   EQU   X'05'              MASK FOR IEE305I-INVALID CMD   Y02669 26002002
ERR311   EQU   X'0B'              MASK FOR IEE311I-PARM MISSING  Y02669 26052002
ERR341   EQU   X'24'              MASK FOR IEE341I-NOT ACTIVE    Y02669 26062002
ERR026   EQU   X'1A'              MASK FOR IEE026I-NOT         @G17SPTJ 26072041
*                                                   SUPPORTED  @G17SPTJ 26077041
         EJECT                                                          26100019
*********************************************************************** 26150002
*                                                                     * 26152002
*            ESTABLISH ADDRESSABILITY FOR MODULE AND XSA         Y02669 26152402
*               GET POINTER TO OPERANDS FROM XAL                 Y02669 26152802
*  ERR - IEE311I PARAMETER MISSING - IF THERE ARE NO OPERANDS    Y02669 26153202
*                                                                     * 26154002
*********************************************************************** 26160002
         BALR  R3,0               ESTABLISH PROGRAM ADDRESSABILITY      26200019
         USING *,R3                                                     26300019
         MODID BRANCH=YES                                        Y01886 26350001
         USING IEEXSA,R2          ADDRESS EXTENDED SAVE AREA            26400019
         SR    R5,R5              CLEAR THE REGISTER             Y02669 26450002
         ICM   R5,M7,XAL+1        GET 3 BYTE ADDR OF OPERANDS    Y02669 26500002
         BZ    DERR311            NONE, ERR - PARAMETER MISSING  Y02669 27300002
         SPACE  2                                                       27350002
*********************************************************************** 27360002
*                                                                     * 27370002
*                 IS THIS A DISPLAY OR TRACK COMMAND?            Y02669 27380002
*                                                                     * 27390002
*********************************************************************** 27392002
         SPACE 2                                                        27394002
         SR    R9,R9              CLEAR REGISTER FOR OPERAND LENGTH     27400002
         SR    R15,R15            USED TO INDEX BRANCH TABLE            27500019
         XC    XAX(L8),XAX        CLEAR DISPLAY/TRACK FIELDS     Y02669 27550002
         LA    R11,DENTAB         CALCULATE COMPARE TABLE END ADDRESS   27562002
         CLI   XAN,TR             IS THIS A TRACK COMMAND?       Y02669 27570002
         BNE   DISPLAY            NO, USE WHOLE COMPARE TABLE    Y02669 27580002
         EJECT                                                          27582002
*********************************************************************** 27582402
*                                                                     * 27582802
*    LOOP THROUGH COMPARE TABLE LOOKING FOR VALID TRACK OPERAND  Y02669 27583202
*                                                                     * 27583302
*********************************************************************** 27583402
         SPACE 2                                                        27583602
TRACK    EQU   *                                                 Y02669 27583702
         LA    R6,DTRTAB          OTHERWISE, USE ONLY VALID      Y02669 27583802
         USING DTRTAB,R6          TRACK COMPARES                 Y02669 27585102
TRLOOP   EQU   *                                                 Y02669 27587502
         IC    R9,DTRLEN          LENGTH OF COMPARE TABLE ENTRY  Y02669 27587902
         EX    R9,COMPARE         CHECK FOR MATCH                Y02669 27588302
         BE    TRTABLE(R15)       IF MATCH,PROCESS ACCORDINGLY   Y02669 27588702
         LA    R6,D2(R9,R6)       NO MATCH, GO TO NEXT ENTRY     Y02669 27589102
         LA    R15,D4(R15)        INCRE INDEX FOR BRANCH TABLE   Y02669 27589502
         CR    R6,R11             END OF COMPARE TABLE REACHED?  Y02669 27589902
         BL    TRLOOP             NO, GO BACK AND CHECK NEXT     Y02669 27590402
*                                 TABLE ENTRY                    Y02669 27590802
         DROP  R6                 NECESSARY TO RE-EST BASE REG   Y02669 27591202
         B     DERR305            YES, INVALID OPERAND-ERROR     Y02669 27591302
         SPACE 2                                                        27591402
*********************************************************************** 27591802
*                                                                     * 27591902
* LOOP THROUGH COMPARE TABLE LOOKING FOR VALID DISPLAY OPERAND   Y02669 27592002
*                                                                     * 27592302
*********************************************************************** 27592402
         SPACE 2                                                        27692402
DISPLAY  EQU   *                                                 Y02669 27694402
         LA    R6,DTAB            COMPARE TABLE BEGINNING ADDR   Y02669 27700002
         USING DTAB,R6            EST. ADDRESSABILITY TO TABLE          27800019
DLOOP    EQU   *                                                 Y02669 27850002
         IC    R9,DLEN            LENGTH OF COMPARE TABLE ENTRY         27900002
         EX    R9,COMPARE         CHECK FOR MATCH                Y02669 28000002
         BE    BRTABLE(R15)       IF MATCH, PROCESS ACCORDINGLY  Y02669 28100002
         LA    R6,D2(R9,R6)       NO MATCH, GO TO NEXT ENTRY            28200002
         LA    R15,D4(R15)        INCRE INDEX FOR BRANCH TABLE          28300019
         CR    R6,R11             END OF COMPARE TABLE REACHED?   M0467 28340002
         BL    DLOOP              NO, GO BACK AND CHECK NEXT      20030 28380020
*                                 TABLE ENTRY                     20030 28460002
         DROP  R6                 NECESSARY TO RE-EST BASE REG   Y02669 28510002
         B     DERR305            YES, INVALID OPERAND-ERROR     Y02669 28560002
         EJECT                                                          29550002
*********************************************************************** 29600019
*                                                                     * 29700019
*                       DISPLAY UNITS                              O111 29800002
*                                                                     * 29900019
*********************************************************************** 30000019
DDUNIT   EQU   *                                                 Y02669 30100002
         MVI   XAN,UNITS          CHANGE VERB CODE IN XSA        Y02669 30200002
         B     DD7503D            BRANCH TO IEE7503D             Y02669 30200402
         SPACE  5                                                       30200602
*********************************************************************** 30200702
*                                                                     * 30204002
*                DISPLAY CONFIGURATION MATRIX                    Y02651 30206002
*                                                                     * 30206402
*********************************************************************** 30206802
DDMATRIX EQU   *                                                 Y02651 30207202
         MVI   XAN,MATRIX         CHANGE VERB CODE IN XSA        Y02651 30209902
         B     DD7503D            BRANCH TO IEE7503D             Y02651 30212702
         SPACE   5                                                      30215402
*********************************************************************** 30218102
*                                                                     * 30220802
*            TRACK OR DISPLAY JOBS  (J)                          Y02669 30230802
*                             TS                                 Y02669 30234802
*                             A                                  Y02669 30235202
*                                                                     * 30235602
*********************************************************************** 30235702
DDACTIVE EQU   *                                                 Y02669 30235802
         OI    XAXMASK,XAXJOBS+XAXTS  INDICATE ACTIVE OPTION     Y02669 30235902
         B     DD7503D             BRANCH TO IEE7503D            Y02669 30240702
DDJOBS   EQU   *                                                 Y02669 30247002
         OI    XAXMASK,XAXJOBS     INDICATE JOBS OPTION          Y02669 30249002
         B     DD7503D             BRANCH TO IEE7503D            Y02669 30249402
DDTS     EQU   *                                                 Y02669 30249802
         OI    XAXMASK,XAXTS       INDICATE TS OPTION            Y02669 30249902
         B     DD7503D             BRANCH TO IEE7503D            Y02669 30251902
         EJECT                                                          30253202
*********************************************************************** 30263202
*                                                                     * 30265202
*                       DISPLAY CONSOLES (C)                     YM1916 30266702
*                                                                     * 30270002
*********************************************************************** 30280002
DDCONS   EQU   *                                                 Y02669 30330002
         MVI   XAN,CONSOLES       CHANGE VERB CODE IN XSA        Y02669 30380002
         B     DD7503D            BRANCH TO IEE7503D             Y02669 30430002
         SPACE   5                                                      30990802
*********************************************************************** 32900019
*                                                                     * 33000019
*                      DISPLAY REQUESTS                          Y02669 33100002
*                                                                     * 33200019
*********************************************************************** 33300019
DDREQ    EQU   *                                                 Y02669 33400002
         MVI   XAN,REQUESTS       CHANGE VERB CODE IN XSA        Y02669 33450002
         B     DD7503D            BRANCH TO IEE7503D             Y02669 33460002
         SPACE   5                                                      33510002
*********************************************************************** 33510240
*                                                                     * 33510340
*                       DISPLAY 3850                           @Z40LPTA 33510440
*                                                                     * 33510640
*********************************************************************** 33511040
DD3850   EQU   *                                               @Z40LPTA 33511240
         MVI   XAN,D38          RE-SET VERB INDICATOR          @Z40LPTA 33511440
         B     DD7503D          BRANCH TO IEE7503D             @Z40LPTA 33511640
         EJECT                                                          33511941
*********************************************************************** 33512641
*                                                                     * 33512941
*                       DISPLAY DOMAIN                         @Z40BPSV 33513241
*                                                                     * 33513540
*********************************************************************** 33513740
DDDOMAIN EQU   *                                               @Z40BPSV 33513840
         MVI   XAN,DOMAIN       CHANGE VERB CODE IN XSA        @Z40BPSV 33513940
         LA    R10,MASK7        SET SU NUMBER FOR TESTING      @G17SPTJ 33514041
         B     TESTSU           BRANCH TO TEST SU NUMBER       @G17SPTJ 33514341
         SPACE 5                                                        33514441
*********************************************************************** 33514541
*                                                                     * 33514841
*                       DISPLAY SLIP                           @G17SPTJ 33515541
*                                                                     * 33515741
*********************************************************************** 33515941
DDSLIP   EQU   *                                               @G17SPTJ 33516141
         MVI   XAN,SLIP         CHANGE VERB CODE IN XSA        @G17SPTJ 33516341
         LA    R10,MASK17       SET SU NUMBER FOR TESTING      @G17SPTJ 33516441
         B     TESTSU           BRANCH TO TEST SU NUMBER       @G17SPTJ 33516741
         SPACE 5                                                        33516843
*********************************************************************** 33516943
*                                                                     * 33517043
*                       DISPLAY DUMP                           @G33CPMR 33517143
*                                                                     * 33517543
*********************************************************************** 33517643
DDDUMP   EQU   *                                               @G33CPMR 33517743
         MVI   XAN,DUMP         CHANGE VERB CODE IN XSA        @G33CPMR 33517843
         LA    R10,MASK33       SET SU NUMBER FOR TESTING      @G33CPMR 33517943
         B     TESTSU           BRANCH TO TEST SU NUMBER       @G33CPMR 33518043
         SPACE 5                                                        33518543
*********************************************************************** 33518943
*                                                                     * 33519043
*                       DISPLAY C,K                              Y02669 33519143
*                                                                     * 33519243
*********************************************************************** 33519543
DDCK     EQU   *                                                 Y02669 33519643
         MVI   XAN,CK             CHANGE VERB CODE IN XSA        Y02669 33519743
DD7503D  EQU   *                                                 Y02669 33519840
         L     R15,VCON7503       GET ADDRESS OF IEE7503D        Y02669 33539840
         BR    R15                BRANCH TO CHECK ROUTING INFO   Y02669 33590040
         EJECT                                                          33596040
*********************************************************************** 33610002
*                                                                     * 38450001
*                       DISPLAY PFK                               21002 38500002
*                                                                     * 38550001
*********************************************************************** 38600001
DDPFK    EQU   *                                                 Y02669 38650002
         MVI   XAN,PFK            CHANGE VERB CODE IN XSA        Y02669 38700002
         XC    XAS(L8),XAS        CLEAR DEFAULT ROUTING FIELD    Y02669 38710002
*                                 FOR ALL OTHER DISPLAY FUNCTIONSY02669 38720002
*                                 FIELD IS SET IN IEE7503D       Y02669 38730002
         L     R15,VCON0803       GET ADDR OF IEE0803D           Y02669 38750002
         BR    R15                BRANCH TO CSCB CREATION        Y02669 38800002
         SPACE   5                                                      38850002
*********************************************************************** 38900002
*                                                                     * 38950002
*                        DISPLAY TP,                              20002 39000002
*                                                                     * 39050002
*********************************************************************** 39100002
DDTP     EQU   *                                                 Y02669 39150002
         L     R15,VCON1303       GET ADDR OF IED1303D           Y02669 39200002
         BR    R15                BRANCH TO D TP MODULE          Y02669 39250002
         SPACE  5                                                       39300002
*********************************************************************** 39350002
*                                                                     * 39400002
*                       DISPLAY NET,                             Y02674 39450002
*                                                                     * 39500002
*********************************************************************** 39550002
DDNET    EQU   *                                                 Y02674 39600002
         L     R15,VCONCFF3       GET ADDR OF ISTCFF3D           Y02674 39650002
         BR    R15                BRANCH TO D NET MODULE         Y02674 39700002
         EJECT                                                          39750002
*********************************************************************** 54400019
*                                                                     * 54600019
*                      DISPLAY  TIME                                  * 54800002
*                                                                     * 55000019
*********************************************************************** 55200019
DDTIME   EQU   *                                                 Y02669 55400002
         SR    R4,R4                 CLEAR FOR IC                       56000002
         IC    R4,XAU                SAVE UCMI FOR WTO                  56200002
         LH    R5,XAA                SAVE ASID FOR TPUT          Y02669 56300002
         TIME  DEC,ERRET=DERR341                                 Y02669 56350002
         MVC   XSA(DDLN),DDMSG       MOVE IN INCOMPLETE WTO MSG  Y02669 56400002
         STCM  R0,X0F,XTM            TIME IN XSA AFTER 'TIME='   Y02669 56800002
         UNPK  XTM(L8),XTM(L4)       UNPACK TIME                        57000002
         MVC   XTM(L2),XTM+D1        LEFT ADJUST HOURS                  57200002
         MVI   XTM+D2,C'.'           INSERT PERIOD                      57400002
         MVC   XTM+D7(L1),XTM+D6     RIGHT ADJUST  ....                 57600002
         MVC   XTM+D6(L1),XTM+D5     ....SECONDS                        57800002
         MVI   XTM+D5,C'.'           INSERT PERIOD                      58000002
         STCM  R1,X0F,XDATE          DATE IN XSA AFTER 'DATE= '  Y02669 58200002
         UNPK  XDATE(L8),XDATE(L4)   UNPACK DATE                        58400002
         OI    XDATE+D7,XF0          SET LOW ORDER BYTE  EBCDIC  Y02669 58600002
         MVC   XDATE(L2),XDATE+D3    LEFT ADJUST YEAR                   58800002
         MVI   XDATE+D2,C'.'         INSERT PERIOD                      59000002
         MVC   XDATE+D3(L3),XDATE+D5 LEFT ADJUST DAY                    59200002
         MVC   XDATE+D6(L2),DDBLNK   BLANK OUT ANY LEFT-OVERS           59400002
         LTR   R5,R5                 TERMINAL REQUEST             20030 59460002
         BNZ   XTPUT                 YES, PUT TIME MSG TO TERM    20030 59520002
         LR    R0,R4                 PUT UCMI INTO REG 0                59600002
         WTO   MF=(E,(R2))           WRITE TO OPERATOR - TIME AND DATE  59800002
         BR    R14                   RETURN TO SYSTEM                   60000002
         EJECT                                                          60002002
*********************************************************************** 60004002
*                                                                     * 60006002
*      FOR TPUTS REGISTER 1 POINTS TO THE BEGINNING OF THE       Y02669 60008002
*      MESSAGE TEXT NOT TO THE PRECEDING WORD OF TEXT LENGTH     Y02669 60008102
*      AND MCS FLAGS.  THEREFORE THE HI ORDER BYTE OF THIS WORD  Y02669 60008202
*      IS USED AS THE RETRY INDICATOR. IT WILL BE SET TO X'80'   Y02669 60008302
*      THE FIRST TIME A RETRY IS ATTEMPTED AND CONTROL WILL BE   Y02669 60010602
*      RETURNED TO THE SYSTEM IF THE RETRY FAILS.                Y02669 60012602
*                                                                     * 60013102
*********************************************************************** 60015402
         SPACE 2                                                        60017402
XTPUT    EQU   *                                                  20030 60017702
         LH    R0,XAH                TEXT BY 4 FOR TPUT (MSFLAGS) 20030 60020002
         SH    R0,FOUR                                            20030 60030020
         LA    R1,XAI                ADDR OF MSG TEXT             20030 60040002
         TPUT  (1),(0),TJID=(5)      PUT MSG TO TERMINAL          20030 60050002
         CH    R15,ERRCODE           CHECK TPUT RETURN CODE       20030 60060002
         BCR   D7,R14                OK, RETURN TO SYSTEM         20030 60070002
         SPACE  1                                                       60072002
         TM    XAH,FLAG              HAS A RETRY BEEN ATTEMPTED  Y02669 60080002
         BCR   D1,R14                YES, RETURN TO SYSTEM        20030 60090002
         OI    XAH,FLAG              SET FLAG TO DENOTE RETRY    Y02669 60100002
         B     XTPUT                 RETRY TPUT                   20030 60110002
         EJECT                                                          60110141
*********************************************************************** 60110243
*                                                                     * 60111043
*     FOR SU-DEPENDENT COMMANDS, EXECUTION PASSES HERE TO             * 60113043
*     ASCERTAIN IF THE SYSTEM SUPPORTS THE COMMAND IN QUESTION.       * 60113843
*     THE TEST IS MADE AGAINST A FOUR WORD SU BIT MASK IN THE         * 60114643
*     NUCLEUS WHICH IS POINTED TO BY THE CVTIHASU FIELD.  ON          * 60115443
*     ENTRY TO THIS SUBROUTINE, REGISTER 10 CONTAINS THE SU           * 60116243
*     NUMBER TO BE USED AS THE TEST AGAINST THE BIT MASK FIELD.       * 60117043
*     IF THE SU IS INSTALLED, PROCESSING CONTINUES.  OTHERWISE,       * 60117843
*     AN IEE026I ERROR MESSAGE IS ISSUED.                      @G33CPMR 60118643
*                                                                     * 60119443
*********************************************************************** 60119543
         SPACE                                                          60119643
TESTSU   EQU   *                                               @G17SPTJ 60119743
         L     R6,CVTPTR          ESTABLISH CVT ADDRESSABILITY @G17SPTJ 60119843
         USING CVT,R6                                          @G17SPTJ 60119943
         L     R6,CVTIHASU        ESTABLISH SU ADDRESSABILITY  @G17SPTJ 60120043
         USING SUBITS,R6                                       @G17SPTJ 60120143
         C     R10,SIXFOUR        IS SU NUMBER BELOW 64?       @G17SPTJ 60120943
         BL    BELOW64            YES, BRANCH AROUND REDUCTION @G17SPTJ 60121943
         LM    R4,R5,SUBYTE9      OBTAIN 2ND 2 SU WORDS        @G33CPMR 60122943
         S     R10,SIXFOUR        REDUCE SU NUMBER BY 64       @G17SPTJ 60123943
         B     SHIFT              BRANCH AROUND NEXT INSTR.    @G17SPTJ 60124943
BELOW64  EQU   *                                               @G17SPTJ 60125943
         LM    R4,R5,SUBYTE1      OBTAIN 1ST 2 SU WORDS        @G33CPMR 60126943
SHIFT    EQU   *                                               @G17SPTJ 60130041
         LTR   R10,R10            IS IT SU 0 OR SU 64?         @G17SPTJ 60134041
         BZ    SHIFTED            YES, AVOID SHIFTING          @G17SPTJ 60148041
LOOP     EQU   *                                               @G17SPTJ 60157041
         SLDL  R4,D1              SHIFT ACCORDING TO SU NUMBER @G17SPTJ 60166041
         BCT   R10,LOOP           CONTINUE SHIFTING UNTIL ZERO @G17SPTJ 60175041
SHIFTED  EQU   *                                               @G17SPTJ 60184041
         LTR   R4,R4              IS SU INSTALLED ON SYSTEM?   @G17SPTJ 60193041
         BM    DD7503D            YES, BRANCH TO IEE7503D      @G17SPTJ 60202041
         B     DERR026            NO, SU NOT INSTALLED - ERROR @G33CPMR 60206043
         EJECT                                                          60229041
*********************************************************************** 60249902
*                                                                     * 60259902
*                         ERROR EXITS                            Y02669 60269902
*                                                                     * 60279902
*********************************************************************** 60289902
         SPACE 2                                                        60291902
DERR026  EQU   *                                               @G33CPMR 60293943
         MVI   XAE,ERR026         ERROR CODE = 26 - NO SUPPORT @G33CPMR 60294943
         B     D0503D             BRANCH TO IEE0503D           @G33CPMR 60295943
DERR311  EQU   *                                                 Y02669 60299902
         MVI   XAE,ERR311         ERROR CODE=11 FOR PARM MISSING Y02669 60400002
         B     D0503D             BRANCH TO IEE0503D             Y02669 60450002
DERR305  EQU   *                                                 Y02669 60500002
         MVI   XAE,ERR305         ERROR CODE=5 FOR INVALID COMD  Y02669 60550002
         B     D0503D             BRANCH TO IEE0503D             Y02669 60560002
DERR341  EQU   *                                                 Y02669 60570002
         MVI   XAE,ERR341         ERROR CODE=36 FOR NOT ACTIVE   Y02669 60580002
         MVC   XAV(L8),CLOCKERR   GET KEYWORD 'CLOCK'            Y02669 60590002
D0503D   EQU   *                                                 Y02669 60600002
         L     R15,VCON0503       GET ADDR OF IEE0503D           Y02669 60650002
         BR    R15                BRANCH TO MESSAGE MODULE       Y02669 60700002
         EJECT                                                          66450002
*********************************************************************** 66500002
*                                                                     * 66550002
*                         CONSTANTS                              Y02669 66560002
*                                                                     * 66570002
*********************************************************************** 66580002
         SPACE   5                                                      66590002
FOUR     DC    H'4'               USED IN SH INSTRUCTION         Y02669 66592002
SIXFOUR  DC    F'00000064'        COMPARAND OF 64              @G17SPTJ 66593041
ERRCODE  DC    X'0014'            TPUT RETURN CODE - MSG DID NOT  20030 66594002
*                                 GO DUE TO AN OUTSTANDING TPUT   20030 66596002
DDBLNK   DC    C'        '        USED FOR PADDING                      66598002
CLOCKERR DC    C'CLOCK   '        USED FOR D T ERROR MESSAGE     Y02669 66598402
VCON0503 DC    V(IEE0503D)        ADDRESS OF MESSAGE MODULE      Y02669 66598802
VCON0803 DC    V(IEE0803D)        ADDRESS OF CSCB CREATION MOD   Y02669 66599202
VCON1303 DC    V(IED1303D)        ADDRESS OF D TP MODULE         Y02669 66599602
VCON7503 DC    V(IEE7503D)        ADDRESS OF SDS MODULE          Y02669 66599802
VCONCFF3 DC    V(ISTCFF3D)        ADDRESS OF NET MODULE          Y02674 66599902
         SPACE                                                          66649902
DDMSG    WTO   'IEE136I  TIME=         DATE=        ',MF=L,            X66659902
               DESC=(5),MCSFLAG=(REG0,RESP)                      Y02669 66669902
DDLN     EQU   *-DDMSG                                                  66679902
         SPACE                                                          66689902
COMPARE  CLC   D1(L0,R6),D0(R5)   LOOK FOR MATCH IN TABLE        Y02669 66691902
         SPACE   5                                                      66693902
*********************************************************************** 66695902
*                                                                     * 66697902
*                        PATCH AREA                              Y02669 66698302
*                                                                     * 66698702
*********************************************************************** 66699102
         SPACE   2                                                      66699341
PATCH    DC      CL50'*****PATCH AREA - IEE3503D******'          Y02669 66699602
         EJECT                                                          66699702
*********************************************************************** 66699902
*                                                                     * 66899902
*                         BRANCH  TABLE                          Y02669 67000002
*                                                                     * 67200019
*        THIS TABLE MUST BE IN A ONE-TO-ONE CORRESPONDENCE WITH  Y02669 67260002
*        THE 'COMPARE TABLE'                                     Y02669 67320002
*        THE BRANCH TABLE FOR THE TRACK COMMAND STARTS WITH      Y02669 67370002
*        TRTABLE                                                 Y02669 67380002
*                                                                     * 67390002
*********************************************************************** 67400019
         SPACE   5                                                      67450002
BRTABLE  DS    0H                                                Y02669 67600002
         B     DDTIME             BRANCH TO PROCESS D T          Y02669 68360002
         B     DDREQ              BRANCH TO PROCESS D R          Y02669 68400002
         B     DDREQ              BRANCH TO PROCESS D R,LIST     Y02669 68450002
         B     DDUNIT             BRANCH TO PROCESS D U          Y02669 68600002
         B     DDUNIT             BRANCH TO PROCESS D U,         Y02669 68700002
         B     DDMATRIX           BRANCH TO PROCESS D M          Y02651 68750002
         B     DDMATRIX           BRANCH TO PROCESS D M=         Y02651 68800002
         B     DDMATRIX           BRANCH TO PROCESS D M,         Y02651 68850002
         B     DDTP               BRANCH TO PROCESS DISPLAY TP,  Y02669 69500002
         B     DDNET              BRANCH TO PROCESS DISPLAY NET, Y02674 69520002
         B     DDCK               BRANCH TO PROCESS DISPLAY C,K  Y02669 69550002
         B     DDCK               BRANCH TO PROCESS DISPLAY C,K, Y02669 69600002
         B     DDCONS             BRANCH TO PROCESS D CONSOLES   YM1916 69630002
         B     DDCONS             BRANCH TO PROCESS D CONSOLES,  YM1916 69670002
         B     DDCONS             BRANCH TO PROCESS D C          YM1916 69710002
         B     DDCONS             BRANCH TO PROCESS D C,         YM1916 69750002
         B     DDPFK              BRANCH TO PROCESS D PFK        Y02669 69790002
         B     DD3850             BRANCH TO PROCESS D 3850     @Z40LPTA 69790140
         B     DD3850             BRANCH TO PROCESS D 3850,    @Z40LPTA 69790240
         B     DDDOMAIN           BRANCH TO PROCESS D DMN      @Z40BPSV 69790340
         B     DDDOMAIN           BRANCH TO PROCESS D DMN=     @Z40BPSV 69790540
         B     DDDOMAIN           BRANCH TO PROCESS D DMN,     @Z40BPSV 69791140
         B     DDSLIP             BRANCH TO PROCESS D SLIP     @G17SPTJ 69791641
         B     DDSLIP             BRANCH TO PROCESS D SLIP,    @G17SPTJ 69792141
         B     DDSLIP             BRANCH TO PROCESS D SLIP=    @G17SPTJ 69792641
         B     DDDUMP             BRANCH TO PROCESS D DUMP     @G33CPMR 69792843
         B     DDDUMP             BRANCH TO PROCESS D DUMP,    @G33CPMR 69792943
         B     DDDUMP             BRANCH TO PROCESS D D        @G33CPMR 69793043
         B     DDDUMP             BRANCH TO PROCESS D D,       @G33CPMR 69793143
TRTABLE  DS    0H                                                Y02669 69793340
         B     DDACTIVE           BRANCH TO PROCESS D OR TR A    Y02669 69795340
         B     DDACTIVE           BRANCH TO PROCESS D OR TR A,   Y02669 69802540
         B     DDJOBS             BRANCH TO PROCESS D OR TR J    Y02669 69804540
         B     DDJOBS             BRANCH TO PROCESS D OR TR J,   Y02669 69806540
         B     DDJOBS             BRANCH TO PROCESS D OR TR JOBS Y02669 69808502
         B     DDJOBS             BRANCH TO PROCESS D OR TR JOBS,Y02669 69818502
         B     DDTS               BRANCH TO PROCESS D OR TR TS   Y02669 69825202
         B     DDTS               BRANCH TO PROCESS D OR TR TS,  Y02669 69841902
         EJECT                                                          69891902
*********************************************************************** 69941902
*   NOTE:  THE FOLLOWING TABLE MUST BE THE LAST ITEM IN THIS     Y02669 69991902
*          MODULE SINCE A USING FOR THE TABLE IS ISSUED ON       Y02669 69993902
*          REGISTER 6 AND THUS CAN REESTABLISH THE MODULE'S      Y02669 69995902
*          BASE REGISTER FOR ANY CODE WHICH FOLLOWS THIS TABLE.  Y02669 69997902
*                                                                     * 70000019
*                        COMPARE TABLE                           Y02669 70200002
*                                                                     * 70400019
*           THIS TABLE MUST BE IN A ONE-TO-ONE CORRESPONDENCE    Y02669 70460002
*           WITH THE BRANCH TABLE                                Y02669 70520002
*           TRACK COMMANDS START WITH DTRTAB                     Y02669 70570002
*********************************************************************** 70600019
DTAB     EQU   *                                                        70800019
DLEN     EQU   *                                                        71000019
         DC    AL1(L'DTIME-1)     LENGTH OF DISPLAY OPERAND       20030 73920002
DTIME    DC    C'T '              DISPLAY OPERAND                 20030 73960002
         DC    AL1(L'DREQ-1)            *                        Y02669 74000002
DREQ     DC    C'R '                    *                        Y02669 74200002
         DC    AL1(L'DREQA-1)           *                        Y02669 74250002
DREQA    DC    C'R,'                    *                        Y02669 74300002
         DC    AL1(L'DUNIT-1)           *                        Y02669 74756002
DUNIT    DC    C'U '                    *                        Y02669 74760002
         DC    AL1(L'DUNITA-1)          *                        Y02669 74840002
DUNITA   DC    C'U,'                    *                        Y02669 74920002
         DC    AL1(L'DMATRIX-1)         *                        Y02651 74970002
DMATRIX  DC    C'M '                    *                        Y02651 75020002
         DC    AL1(L'DMATRIXA-1)        *                        Y02651 75070002
DMATRIXA DC    C'M='                    *                        Y02651 75120002
         DC    AL1(L'DMATRIXB-1)        *                        Y02651 75130002
DMATRIXB DC    C'M,'                    *                        Y02651 75132002
         DC    AL1(L'DTP-1)             *                        Y02669 75140002
DTP      DC    C'TP,'                   *                        Y02669 75160002
         DC    AL1(L'DNET-1)            *                        Y02674 75166002
DNET     DC    C'NET,'                  *                        Y02674 75168002
         DC    AL1(L'DCK-1)             *                         21002 75170002
DCK      DC    C'C,K '                  *                         21002 75180002
         DC    AL1(L'DCKA-1)            *                         21002 75190002
DCKA     DC    C'C,K,'                  *                         21002 75192002
         DC    AL1(L'DCONSOLE-1)        *                         20030 75200002
DCONSOLE DC    C'CONSOLES '             *                         20030 75208002
         DC    AL1(L'DCONSOLA-1)        *                         21002 75216002
DCONSOLA DC    C'CONSOLES,'             *                         21002 75224002
         DC    AL1(L'DC-1)              *                        YM1916 75232002
DC       DC    C'C '                    *                        YM1916 75241002
         DC    AL1(L'DCA-1)             *                        YM1916 75250002
DCA      DC    C'C,'                    *                        YM1916 75259002
         DC    AL1(L'DPFK-1)            *                        Y02669 75269902
DPFK     DC    C'PFK '                  *                        Y02669 75279902
         DC    AL1(L'D3850-1)           *                      @Z40LPTA 75280240
D3850    DC    C'3850 '                 *                      @Z40LPTA 75280440
         DC    AL1(L'D3850C-1)          *                      @Z40LPTA 75280840
D3850C   DC    C'3850,'                 *                      @Z40LPTA 75281140
         DC    AL1(L'DDOMAIN-1)         *                      @Z40BPSV 75281240
DDOMAIN  DC    C'DMN '                  *                      @Z40BPSV 75281340
         DC    AL1(L'DDOMAINE-1)        *                      @Z40BPSV 75282340
DDOMAINE DC    C'DMN='                  *                      @Z40BPSV 75282640
         DC    AL1(L'DDOMAINC-1)        *                      @Z40BPSV 75282940
DDOMAINC DC    C'DMN,'                  *                      @Z40BPSV 75283240
         DC    AL1(L'DSLIP-1)           *                      @G17SPTJ 75283441
DSLIP    DC    C'SLIP '                 *                      @G17SPTJ 75283741
         DC    AL1(L'DSLIPA-1)          *                      @G17SPTJ 75284241
DSLIPA   DC    C'SLIP,'                 *                      @G17SPTJ 75284741
         DC    AL1(L'DSLIPA-1)          *                      @G17SPTJ 75285241
DSLIPB   DC    C'SLIP='                 *                      @G17SPTJ 75285741
         DC    AL1(L'DDUMP-1)           *                      @G33CPMR 75286043
DDUMP    DC    C'DUMP '                 *                      @G33CPMR 75286243
         DC    AL1(L'DDUMPA-1)          *                      @G33CPMR 75286443
DDUMPA   DC    C'DUMP,'                 *                      @G33CPMR 75286643
         DC    AL1(L'DD-1)              *                      @G33CPMR 75286743
DD       DC    C'D '                    *                      @G33CPMR 75286843
         DC    AL1(L'DDA-1)             *                      @G33CPMR 75286943
DDA      DC    C'D,'                    *                      @G33CPMR 75287043
         EJECT                                                          75287441
DTRTAB   EQU   *                                                 Y02669 75287940
DTRLEN   EQU   *                                                 Y02669 75289902
         DC    AL1(L'DACTIVE-1)   LENGTH OF DISPLAY/TRACK OPERANDY02669 75293902
DACTIVE  DC    C'A '              DISPLAY/TRACK OPERAND          Y02669 75295902
         DC    AL1(L'DACTIVEA-1)        *                        Y02669 75297902
DACTIVEA DC    C'A,'                    *                        Y02669 75298302
         DC    AL1(L'DJ-1)              *                        Y02669 75299702
DJ       DC    C'J '                    *                        Y02669 75299802
         DC    AL1(L'DJA-1)             *                        Y02669 75316502
DJA      DC    C'J,'                    *                        Y02669 75326502
         DC    AL1(L'DJOBS-1)           *                        Y02669 75326902
DJOBS    DC    C'JOBS '                 *                        Y02669 75327302
         DC    AL1(L'DJOBSA-1)          *                        Y02669 75327702
DJOBSA   DC    C'JOBS,'                 *                        Y02669 75328102
         DC    AL1(L'DTS-1)             *                        Y02669 75328502
DTS      DC    C'TS '                   *                        Y02669 75330502
         DC    AL1(L'DTSA-1)            *                        Y02669 75332502
DTSA     DC    C'TS,'                   *                        Y02669 75332902
DENTAB   EQU   *                                                 Y02669 75333202
         EJECT                                                          75349902
IEEXSA   DSECT                                                          75599702
         IEEXSA                                                         75649702
XTM      EQU   XAT-D2                                            Y02669 75781602
XDATE    EQU   XAS                                               Y02669 75783602
         EJECT                                                          75785641
         IHASUBIT                                                       75787641
         EJECT                                                          75789641
CVT      DSECT                                                          75791641
         CVT                                                            75793641
         END                                                            75799602
./  ADD  SSI=83110937,NAME=IEE3603D
 TITLE 'IEE3603D - VARY ONLINE/CONSOLE PATH VERIFICATION ROUTINE'       00150003
IEE3603D CSECT                                                 @Z30LPTJ 00180003
         ENTRY IEE36ENT                                        @Z30LPTJ 00210003
* C 011665-011815,013404-013584,014120-014180,014362-014402,   @YM07231 00260002
* C 014524-014584,015679-015719,705858,705718-705738,          @YM07231 00330002
* C 820200-820340                                              @YM07231 00360002
* C 012922,015679,488000,820460-820487                         @ZM30436 00380003
* C 012922                                                     @ZM30445 00384003
* A 015699,133293,226958-226978,227038,705911-705912,705915,   @ZM30445 00388003
* A 707148-707178,707318                                       @ZM30445 00392003
* C 012922,015699,492000                                       @ZM30479 00396003
* LOOPENQ(C) - STIMER CODED INCORRECTLY                        @ZA09414 00397003
* LOOPENQ(C) - INTERLOCK PROBLEM WITH ALLOCATION               @ZA09166 00398003
         SPACE 1                                                        00400000
* * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * *         00600000
*                                                             *         00800000
* MODULE NAME       = IEE3603D                                          00850002
*   CSECT NAME      = IEE3603D                                          00900002
*                                                                       00950002
* LOAD MODULE NAME  = IEE3603D                                          00960002
*                                                                       00970002
* DESCRIPTIVE NAME  = MP VARY COMMAND PRE-PROCESSOR AND FIRST           00980002
*                     VARY ONLIN/OFFLINE/CONSOLE ATTACHED RTN           00990002
*                     PATH AVAILABILITY CHECKER                         00992002
*                                                                       00994002
* COPYRIGHT         = MISSING                                           00996002
*                                                                       00998002
* STATUS            = OS/VS/2 RELEASE 3 PTF UZ03709            @ZA09166 00998403
*                                                                       00998802
* FUNCTION          = THIS ROUTINE SETS UP THE ENVIRONMENT FOR          00999202
*                     THE VARY ONLINE/OFFLINE/AND CONSOLE PROCESSOR     00999602
*                     AND THEN IT WILL PREVENT DEVICES WHICH HAVE       00999702
*                     NO AVAILABLE PATHS FROM BECOMING ONLINE           00999802
*                     OR CONSOLES                                       00999902
*                                                                       01049902
* OPERATION         = AS THE FIRST THING, IT WILL HAVE A STAE           01059902
*                     ENVIRONMENT CREATED BY IEECB860.                  01069902
*                     THEN, THIS ROUTINE WILL GETMAIN ENOUGH CORE       01079902
*                     FOR A DUMMY XSA,SAVE AREA AND WORK AREA,          01089902
*                     AND IT WILL INITIALIZE THE TABLES                 01090302
*                     FOR THE REST OF THE ONLINE/OFFLINE/CONSOLE        01091902
*                     COMMAND PROCESSOR TO USE.                         01093902
*                     AT THIS POINT, AN ENQ ON SYSIEFSD, Q4 IS @ZA09166 01094003
*                     ATTEMPTED. IF THE RESOURCE IS OBTAINED,  @ZA09166 01094103
*                     PROCESSING CONTINUES. IF THE RESOURCE    @ZA09166 01094203
*                     CAN'T BE OBTAINED, AN STIMER WAIT IS     @ZA09166 01094303
*                     ISSUED FOR 5 SECONDS AND THE ENQ IS      @ZA09166 01094403
*                     RE-ISSUED. IF THE RESOURCE STILL CAN'T   @ZA09166 01094503
*                     BE OBTAINED, A WTOR FOR IEE799I IS       @ZA09166 01094603
*                     ISSUED WITH THE OPTION OF RETRY,CANCEL OR@ZA09166 01094703
*                     WAIT. IF THE OPERATOR REPLIES RETRY,     @ZA09166 01094803
*                     THE WHOLE PROCESS IS REPEATED. IF THE    @ZA09166 01094903
*                     OPERATOR REPLIES CANCEL, MESSAGE IEE756I @ZA09166 01095003
*                     IS ISSUED AND PROCESSING IS TERMINATED.  @ZA09166 01095103
*                     IF THE OPERATOR REPLIES WAIT, AN         @ZA09166 01095203
*                     UNCONDITIONAL ENQ IS ISSUED.             @ZA09166 01095303
*                     THE FOLLOWING FIELDS WILL BE INITIALIZED          01095902
*                       XAL WILL POINT TO CHBUF=PTR TO PARAMS           01097902
*                            IN THE VARY COMMAND                        01098302
*                       XAU WILL CONTAIN THE UCM ID OF THE ISSUING      01098702
*                            CONSOLE FROM THE INFOR IN THE CSCB         01099102
*                       XAV IS INIT TO THE COMMAND VERB = VARY          01099502
*                       XAR IS INIT TO THE LENGTH OF THE COMMAND        01099602
*                            THIS IS ALWAYS THE LENGTH OF THE CMD       01099702
*                            BUFFER IN THE CSCB = 124 BYTES             01099802
*                       XAS IS INIT TO THE R/I COMMAND AUTH.            01133202
*                            FROM THE CSCB (IF THE R/I ISSUED THE       01143202
*                            COMMAND, ELSE THIS FIELD IN THE CSCB       01153202
*                            IS ZEROES AND IT IS COPIED AS SUCH)        01163202
*                     IF A VARY RANGE COMMAND IS PRESENT, THEN @Z30LPTJ 01163603
*                     A BRANCH IS MADE TO IEECB904 TO EXPAND   @Z30LPTJ 01164003
*                     THE UNITS IN THE COMMAND INTO A VARY     @Z30LPTJ 01164403
*                     COMMAND WITH INDIVIDUAL DEVICES.         @Z30LPTJ 01164803
*                     THEN THE COMMAND SYNTAX IS CHECKED.               01165202
*                     A NORMAL EXIT IS TAKEN FOR INVALID SYNTAX.        01165602
*                     THEN, EACH UNIT IS CHECKED FOR GOOD PATHS.        01166002
*                     A MESSAGE IS WRITTEN FOR EACH UNIT HAVING NO      01166402
*                     GOOD PATHS OR EACH UNIT IN USE BY A      @YM07231 01166502
*                     SYSTEM COMPONENT AND THE UNIT IS DELETED @YM07231 01171502
*                     FROM THE BUFFER.  UNITS HAVING GOOD      @YM07231 01176502
*                     PATHS ARE LEFT IN THE COMMAND BUFFER.    @YM07231 01181502
*                     FINALLY, WHEN ALL UNITS HAVE BEEN CHECKED, A      01188002
*                     NORMAL EXIT IS TAKEN IF ANY UNITS ARE LEFT IN     01188402
*                     THE COMMAND BUFFER. OTHERWISE, AN ERROR EXIT      01188802
*                     IS TAKEN.                                         01192502
*                                                                       01194502
* NOTES                                                                 01194902
*   DEPENDENCIES    = NONE                                              01195302
*   CHARACTER/CODE DEPENDENCIES                                         01195702
*                   = THIS MODULE CAN BE ASSEMBLED WITH ANY NEW         01196102
*                     CHARACTER/CODE SET                                01196202
*   RESTRICTIONS    = R2 CONTAINS THE PTR TO THE DUMMY XSA ON OUTPUT    01246202
*   REGISTER CONVENTIONS                                                01256202
*                   = REGISTERS ARE DEFINED AT LABEL: DEFREG            01266202
*   PATCH LABEL     = PATCH                                             01276202
*                                                                       01286202
* MODULE TYPE       = CSECT                                             01288202
*   PROCESSOR       = ASSEMBLER                                         01290202
*   MODULE SIZE     = VS/2 = 'B00'                             @ZM30479 01292203
*   ATTRIBUTES      = REENTRANT,REUSABLE,REFRESHABLE,                   01294202
*                     PAGED LPA,ZERO PSW PROTECT KEY                    01294602
*                                                                       01295002
* ENTRY POINTS      = IEE3603D FROM IEEVWAIT                            01295402
*   PURPOSE         = TO PRESET THE ENVIRONMENT FOR THE VARY ONLINE/    01295802
*                     OFFLINE/CONSOLE CMDS, TO ROUT THE OFFLINE CMD     01295902
*                     DIRECTLY TO IEE3303D, TO TEST PATH-AVAILABILITY   01296002
*                     FOR UNITS GOING TO THE ONLINE AND CONSOLE STATES  01296102
*   LINKAGE         = ATTACH                                            01312802
*   INPUT           = REG1 HAS A PTR TO THE CSCB                        01322802
*   REGISTERS SAVED = R14 = RETURN ADDRESS REG IS SAVED ON ENTRY        01324802
*                     R1  = CSCB PTR                                    01326802
*   REGISTER USAGE  = R2 PTR TO DUMMY XSA                               01328802
*                     R3 PTR TO THE CSCB UNTIL IT IS STORED             01329202
*                     R12 ADDRESSABILITY REGISTER                       01329302
*                     R13 PTR TO WORK AREA                              01329402
*   REGISTER RESTORED                                                   01335002
*                   = R14                                               01337002
*                                                              @Z30LPTJ 01337203
* ENTRY POINTS      = IEE36ENT FROM IEECB904                   @Z30LPTJ 01337803
*   PURPOSE         = TO EXECUTE NORMAL VARY PROCESSING AFTER  @Z30LPTJ 01338403
*                     EXPANSION OF THE VARY RANGE COMMAND INTO @Z30LPTJ 01339003
*                     INDIVIDUAL DEVICE UNITS HAS TAKEN PLACE. @Z30LPTJ 01339603
*   LINKAGE         = BRANCH                                   @Z30LPTJ 01340203
*   INPUT           = REGISTER 2 POINTING TO THE XSA           @Z30LPTJ 01340803
*   REGISTERS SAVED = NONE                                     @Z30LPTJ 01341403
*   REGISTER USAGE  = REGISTER 2 POINTING TO THE DUMMY XSA     @Z30LPTJ 01342003
*                     REGISTER 12 IS THE ADDRESSABILITY BASE   @Z30LPTJ 01342603
*                     REGISTER 13 POINTS TO THE WORK AREA      @Z30LPTJ 01343203
*   REGISTERS RESTORED                                         @Z30LPTJ 01343803
*                   = REGISTER 14                              @Z30LPTJ 01344403
*                                                                       01345203
* EXITS - NORMAL -1 = IEE3303D VIA BRANCH                               01346403
*   CONDITIONS      = A NORMAL EXIT IS TAKEN IF THE COMMAND HAS A       01347403
*                     GROSS SYNTAX ERROR, WHICH WOULD MAKE THE TOTAL    01348403
*                     COMMAND, INVALID.  OR IF AFTER DELETION OF        01349403
*                     ALL UNAVAILABLE UNITS, AND UNITS IN USE  @YM07231 01352403
*                     BY A SYSTEM COMPONENT, AT LEAST ONE UNIT @YM07231 01354403
*                     IS LEFT IN THE COMMAND, OR BEFORE        @YM07231 01356403
*                     PROCESSING IF A 'VARY OFFLINE' IS FOUND. @YM07231 01358402
*   OUTPUT          = IF EXIT IS TAKEN TO IEE3303D, REGISTER 2          01365302
*                     POINTS TO THE DUMMY XSA                           01367302
*                     R13 PTS TO THE SAVE AREA WORD 17 =CSCB PTR        01369302
*   RETURN CODES    = NONE                                              01369702
*                                                                       01370102
* EXITS - NORMAL -2 = IEEVDEV - MP PATH VERIFICATION SUBROUTINE         01370202
*   CONDITIONS      = A UNIT HAS BEEN FOUND THAT IS VALID AND THE       01370302
*                     PATH NOW HAS TO BE VERIFIED AS BEING OPEN OR NOT  01375202
*                     EVEN THOUGH 3603D WILL GO TO IEEVDEV AS MANY      01375302
*                     TIMES AS THERE ARE UNITS IN THE COMMAND WHICH     01375402
*                     ARE NOT ONLINE AT THE TIME OF THIS MODULE'S       01375502
*                     EXECUTION, ONLY ONE LOAD/DELETE AND ONE           01378302
*                     GETMAIN/FREEMAIN FOR VDEV'S PARAM CORE IS         01380302
*                     EXECUTED. ONE THE LOAD IS PERFORMED, THE ADDR     01380702
*                     OF IEEVDEV IS STORED IN THE XAP FOR FUTURE        01381102
*                     USE. ELSE THIS AREA IS 0 (PRESET AT XSA           01381503
*                     INIT TIME).                                       01382403
*                     ONCE THE CORE FOR IEEVDEV'S PARAM LIST AND        01385003
*                     SAVE AREA IS GOTTEN, ITS ADDRESS IS STORED        01386403
*                     IN THE XAD FOR FUTURE USE. ELSE THIS AREA         01387103
*                     IS 0 (PRESET AT XSA INIT TIME).                   01388103
*                     THE FREEMAIN OF VDEV'S PARAM AND SAVE AREA        01390003
*                     CORE AND THE DELETE OF IEEVDEV ARE DONE EITHER    01391003
*                     ON EXIT TO IEE3303D OR UPON THE 'RETURN'          01392803
*                     EXIT, WHICHEVER IS TAKEN.                         01394803
*   OUTPUT          = REG1 PTS TO A PTR WHICH PTS TO A TWO WORD PARAM   01395803
*                     LIST:                                             01396803
*                          WORD 1: PTR TO THE UCB TO HAVE PATH SEARCHED 01397803
*                          WORD 2,BYTE1 : FUNCTION CODE = VARY = X'00'  01401203
*                                  REST OF WORD 2 IS NOT APPLICABLE     01402203
*                     R13 PTS TO A 72 SAVE AREA                       P 01404003
*   RETURN CODES    = RETURN CODE 4 OR 12 MEANS THAT THERE IS NO        01405003
*                     AVAILABLE PATH TO THIS DEVICE AND THEREFORE       01406803
*                     IT CANNOT BE VARIED ONLINE OR THE CONSOLE         01407803
*                     STATE.                                            01409603
*                     RET CODE OF 16 MEANS THAT THE UNIT HAS BEEN       01412003
*                     FOUND TO BE IN USE BY A SYSTEM COMPONENT @YM07231 01413003
*                     RIGHT NOW, THEREFORE IT CANNOT BE VARIED @YM07231 01414003
*                     ONLINE, OR TESTED FOR PATHS , OR VARIED  @YM07231 01416003
*                     TO THE CONSOLE STATE.                    @YM07231 01418002
*                     A RET CODE OF 8 MEANS THE IEEVDEV COULD NOT       01421702
*                     GET ENOUGH CORE TO PROCESS AND THEREFORE          01422702
*                     NO PATH VERIFICATION WAS DONE.                    01424602
*                     THE COMMAND AS ABORTED AT THIS TIME.              01427502
*                                                              @Z30LPTJ 01427803
* EXITS - NORMAL -3 = IEECB904 - VARY RANGE PROCESSOR ROUTINE  @Z30LPTJ 01428303
*   CONDITIONS      = WHENEVER IEE3603D DETECTS A VARY RANGE   @Z30LPTJ 01428803
*                     COMMAND IN THE COMMAND BUFFER AND IT HAS @Z30LPTJ 01429303
*                     SOME PRIMARY GOOD SYNTAX.  A RETURN FROM @Z30LPTJ 01429803
*                     IEECB904 WILL HAVE A NEW BUFFER (POINTED @Z30LPTJ 01430303
*                     TO BY THE XAL FIELD IN THE XSA) WHICH    @Z30LPTJ 01430803
*                     WILL CONTAIN THE EXPANDED FORM OF THE    @Z30LPTJ 01431303
*                     VARY RANGE COMMAND (UP TO 28 SINGLE      @Z30LPTJ 01431803
*                     DEVICE UNITS).                           @Z30LPTJ 01432303
*   OUTPUT          = REGISTER 2 POINTING TO THE XSA           @Z30LPTJ 01432803
*   RETURN CODES    = NONE                                     @Z30LPTJ 01433303
*                                                                       01434303
* EXITS - ERROR     = BR14 (RETURN TO THE SVC HANDLER)                  01435203
*   CONDITIONS      = AN ERROR EXIT IS TAKEN IF NOTHING IS LEFT         01436203
*                     IN THE COMMAND BUFFER AFTER ALL UNITS             01440203
*                     ARE DELETED, OR WHEN THE STAE ENVIRONMENT@YM07231 01444003
*                     CANNOT BE CREATED SUCCESSFULLY.          @YM07231 01448003
*                     THE ABOVE-MENTIONED CONDITIONS HOLD TRUE @Z30LPTJ 01448603
*                     ONLY IF THE VARY RANGE BIT IS NOT ON.    @Z30LPTJ 01449303
*                     OR, THE FIRST TIME THAT IEEVDEV RETURNS A         01450003
*                     RETURN CODE OF 8 (INSUFF. CORE FOR PROCESSING)    01452003
*                     ALSO, AN ERROR EXIT IS MADE IF THE VARY  @Z30LPTJ 01453003
*                     RANGE COMMAND IS SYNTAXICALLY INCORRECT. @Z30LPTJ 01455003
*   OUTPUT          = FOR EACH UNIT IN THE VARY ONLINE OR      @Z30LPTJ 01457003
*                     VARY CONSOLE COMMAND THAT HAS:           @Z30LPTJ 01459003
*                      A) NO AVAILABLE PATHS -                 @Z30LPTJ 01461003
*                          NO PATHS MESSAGE (IEE025I)          @Z30LPTJ 01463003
*                      B) THE UNIT IN USE BY A SYSTEM          @Z30LPTJ 01465003
*                         COMPONENT -                          @Z30LPTJ 01467003
*                          SYSTEM COMPONENT MESSAGE (IEE329I)  @Z30LPTJ 01469003
*                      C) NO UCB -                             @Z30LPTJ 01471003
*                          UNIT REF INVALID MESSAGE (IEE313I)  @Z30LPTJ 01473003
*                      D) CHARACTERS AFTER THE 'OFFLINE' OR    @Z30LPTJ 01473503
*                         'ONLINE' KEYWORDS -                  @Z30LPTJ 01474003
*                          TERM LENGTH ERROR MESSAGE (IEE303I) @Z30LPTJ 01474503
*                     THE FOLLOWING ERROR MESSAGES ARE ISSUED  @Z30LPTJ 01475003
*                     WHEN A VARY RANGE COMMAND HAS SYNTAX     @Z30LPTJ 01477003
*                     ERRORS:                                  @Z30LPTJ 01479003
*                      A) RIGHT PARENTHESIS AND COMMA NOT      @Z30LPTJ 01481003
*                         PRESENT WHEN EXPECTED                @Z30LPTJ 01483003
*                          DELIMITER ERROR MESSAGE (IEE307I)   @Z30LPTJ 01485003
*                      B) MIXTURE OF SINGLE AND RANGE UNITS -  @Z30LPTJ 01487003
*                          TERM LENGTH ERROR MESSAGE (IEE308I) @Z30LPTJ 01489003
*                      C) 'CONSOLE' KEYWORD SPECIFIED -        @Z30LPTJ 01491003
*                          PARAMETER CONFLICT MESSAGE (IEE312I)@Z30LPTJ 01493003
*   RETURN CODES    = NONE                                              01495203
*                                                                       01496203
* EXTERNAL REFERENCES                                                   01498202
*   ROUTINE         = IEE3303D                                          01500202
*                     IEEVDEV = (PATH CHECKER SUBROUTINE)               01500602
*                     IEECB860 = (STAE PROCESSOR)                       01501002
*                     IEECB904 = (VARY RANGE PROCESSOR)        @Z30LPTJ 01501203
*   DATA AREAS      = SEE EXITS - OUTPUT DATA                           01501402
*                                                                       01501802
* CONTROL BLOCKS    = DUMMY EXTENDED SAVE AREA (XSA)                    01501902
*                     COMMAND SCHEDULING CONTROL BLOCK (CSCB)           01502002
*                       FIELDS TESTED  - CHBUF                          01502102
*                                        CHUCMP                         01506802
*                       FIELDS UPDATED - CHSTS -BIT= CHFC               01508802
*                     CVT                                               01510802
*                       FIELDS TESTED  - CVTILK2                        01511202
*                                        CVTPTR                         01511302
*                       FIELDS UPDATED - NONE                           01511402
*                     UNIT CONTROL BLOCK (UCB)                          01523002
*                       FIELDS TESTED  - UCBNAME                        01533002
*                       FIELDS UPDATED - NONE                           01533402
*                                                                       01533802
* TABLES            = 136 BYTE WORK AREA IN SUBPOOL 229 OF LSQA         01534202
*                     48 BYTES FOR USE AS A DUMMY XSA FOR               01534602
*                     THE VARY ONLINE/OFFLINE/CONSOLE PROCESSORS        01534702
*                     84 BYTES FOR THE SAVE AREA FOR VARY AND           01534802
*                     THE ONE WORD-CSCB-POINTER-STORE                   01538702
*                     AND 4-WORD SAVE FOR REGS AT SETLOCK TIME          01540702
*                                                                       01540802
* MACROS            = GETMAIN,FREEMAIN,WTO,LOAD,DELETE,MGCR,ENQ,DEQ     01541102
*                                                                       01541502
* MAPPING MACROS    = IEEXSA                                            01541902
*                     CVT                                               01542302
*                     IEFUCBOB                                          01542402
*                     IEECHAIN                                          01542502
*   SERIALIZATION   = NO LOCKS ARE OBTAINED IN THIS ROUTINE             01546402
*                    FOR PROTECTION AGAINST ALLOC, ANOTHER VARY OR      01546802
*                     UNLOAD COMMAND THIS ROUTINE ISSUES THE ENQ ON     01547202
*                     Q4 WHICH WILL PROTECT ALL OR THE COMMAND PROCESOR 01547602
*                                                                       01548002
*                     THE ENQ IS ISSUED IN THIS MODULE                  01548103
*                     THE DEQ ARE ISSUED IN THE FOLLOWING PLACES:       01548302
*                          IEEDEQUE IN THIS MODULE WHEN ERRORS ARE      01550403
*                              ENCOUNTERED                              01551403
*                          SDEQUE IN IEE3303D                           01552802
*                          UDEQUE IN IEE4203D                           01553202
*                          KDEQUE IN IEE4403D                           01554302
*                          ODEQUE IN IEE4603D                           01556302
*                          CDEQUE IN IEE4903D                           01556702
*                          VDEQUE IN IEE3103D                           01556902
*                          CDEQUE IN IEE7303D                           01557302
*                          CDEQUE IN IEE4803D                           01557402
*                          CDEQUE IN IEECB904                  @Z30LPTJ 01557503
*                                                                       01561703
* CHANGE LEVEL      = Y02669, Y02651, Y02653, Z30LPTJ, ZM30436 @ZM30436 01567903
*                     ZM30445, ZM30479, ZA09166, ZA09414       @ZA09166 01569903
*                                                                       01571903
* CHANGE ACTIVITY   = N/A                                               01576003
*                                                                       01578003
* MESSAGES          = 'IEE025I UNIT XXX HAS NO LOGICAL  PATHS'          01581003
*                     'IEE025I UNIT XXX HAS NO PHYSICAL PATHS'          01584203
*                     'IEE329I XXX IN USE BY A SYSTEM          @YM07231 01588203
*                                               COMPONENT'     @YM07231 01592303
*                     'IEE313I XXX UNIT REF INVALID'           @Z30LPTJ 01594303
*                     'IEE084I XXX 3851 PARAMETER MISSING'     @Z30LPTJ 01595303
*                       WHERE XXX IS THE UNIT NAME             @Z30LPTJ 01596303
*                     'IEE328I VARY COMMAND ABORTED'                    01598303
*                     'IEE307I VARY DELIMITER ERROR'           @Z30LPTJ 01600403
*                     'IEE308I VARY TERM LENGTH ERROR'         @Z30LPTJ 01601403
*                     'IEE312I VARY PARAMETERS CONFLICT'       @Z30LPTJ 01602403
*                     'IEE799A VARY CONSOLE DELAYED - REPLY    @ZA09166 01602903
*                      RETRY,CANCEL OR WAIT'                   @ZA09166 01603003
*                                                                       01603403
* ABEND CODES       = NONE                                              01604403
*                                                                       01608503
* PACKAGING         = IEE3603D WILL BE PART OF LOAD MODULE              01613503
*                       IEE3603D                                        01618502
*                     THIS LOAD MODULE ALIASES ARE                      01628502
*                       NONE                                            01638502
*                     THIS LOAD MODULE ENTRY POINTS ARE                 01640502
*                       IEE3603D                                        01642502
*                     THIS MODULE WILL RESIDE IN: LPALIB                01644502
*                                                                       01646502
* SYSGEN            = SUPPLIED BY SECTIONS                              01646602
*                       LOAD MODULE NAME                                01646702
*                       PACKAGING                                       01659502
*                       THIS CSECT WILL BE INCLUDED AT SYSGEN FROM      01661502
*                       DLIB -AOSB3- BY MACRO -SGIEF441-                01663502
*                                                                       01669502
* SYSTEM LIBRARIES  = NONE                                              01671502
*                                                                       01671902
* * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * *         01672302
         EJECT                                                          01685102
* * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * *         01723402
*                                                             *         01761702
* EQUATES                                                     *         01800000
*                                                             *         02000000
* * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * *         02200000
         SPACE 1                                                        02400000
DEFREG   EQU   *                                                 Y02669 02450002
R0       EQU   0                                                        02600002
R1       EQU   1                   INPUT = CSCB POINTER          Y02669 02800002
R2       EQU   2                   DUMMY XSA POINTER             Y02669 03000002
R3       EQU   3                   MODULE'S CSCB POINTER         Y02669 03200002
R4       EQU   4                   EOB POINTER                   Y02669 03400002
R5       EQU   5                                                        03600002
R6       EQU   6                                                        03800002
R7       EQU   7                                                        04000002
R8       EQU   8                   WORK AREA POINTER             Y02669 04200002
R9       EQU   9                                                        04400002
R10      EQU   10                                                       04600002
R11      EQU   11                                                       04800002
R12      EQU   12                  ADDRESSABILITY                Y02669 05000002
R13      EQU   13                  SAVE AREA POINTER             Y02669 05200002
R14      EQU   14                                                       05400002
R15      EQU   15                                                       05600002
         SPACE 1                                                        07800000
BE       EQU   8                   BCR CONDITION MASK                   08000000
BNE      EQU   7                   BCR CONDITION MASK                   08200000
         SPACE 1                                                        08800000
K0       EQU   0                                                        09000002
K1       EQU   1                                                        09200002
K2       EQU   2                                                        09400002
K3       EQU   3                                                        09600002
K4       EQU   4                                                        09800002
K5       EQU   5                                                 Y02669 09850002
K6       EQU   6                                                        10000002
K7       EQU   7                                                        10200002
K8       EQU   8                                                        10400002
K9       EQU   9                                               @YM3411P 10420002
K12      EQU   12                                                Y02669 10450002
K13      EQU   13                                                       10600002
K16      EQU   16                                                Y02669 10650002
K17      EQU   17                                                       10670002
K24      EQU   24                                                Y02669 10700002
K28      EQU   28                                              @YM3369P 10750002
K130     EQU   130                                             @Z30LPTJ 10770003
K136     EQU   136                                             @Z30LPTJ 10780003
K140     EQU   140                                             @Z30LPTJ 10790003
         SPACE 1                                                        10800000
XC1      EQU   X'C1'                                           @YM3411P 10850002
XC6      EQU   X'C6'                                           @YM3411P 10900002
XF0      EQU   X'F0'                                           @YM3411P 10950002
X4D      EQU   C'('                                                     12000002
X40      EQU   C' '                                                     12200002
X5D      EQU   C')'                                                     12400002
X6B      EQU   C','                                                     12600002
TWELV    EQU   12                                                Y02669 13050002
FOR      EQU   4                                                 Y02669 13100002
ZERO     EQU   0                                                 Y02669 13150002
EIT      EQU   8                                                 Y02669 13160002
SIXTEEN  EQU   16                                                Y02669 13170002
D132     EQU   132                                               Y02669 13180002
*              NOTE: IF THE SIZE OF THIS 'D132' IS CHANGED     @Z30LPTJ 13181003
*                    (REFLECTING CHANGE IN XSA MACRO SIZE),    @Z30LPTJ 13182003
*                    SUCH CHANGE MUST ALSO BE MADE TO THE SAME @Z30LPTJ 13183003
*                    LABEL IN THE FOLLOWING MODULES:           @Z30LPTJ 13184003
*                      IEE3103D  IEE4403D  IEE4903D            @Z30LPTJ 13185003
*                      IEE3303D  IEE4603D  IEE7303D            @Z30LPTJ 13186003
*                      IEE4203D  IEE4803D  IEECB904            @Z30LPTJ 13187003
D124     EQU   124                                               Y02669 13190002
D48      EQU   48                                                Y02669 13192002
D64      EQU   64                                                Y02669 13194002
D68      EQU   68                                                Y02669 13194402
D512     EQU   512                                               Y02669 13195202
TWENTY   EQU   20                                                     P 13198002
TREE08   EQU   308                                             @Z30LPTJ 13198403
*              NOTE: IF THE SIZE OF THIS 'TREE08' IS           @Z30LPTJ 13198603
*                    CHANGED, SUCH CHANGE MUST ALSO BE MADE    @Z30LPTJ 13198803
*                    AT THE 'SPSIZEC' LABEL IN IEECB904.       @Z30LPTJ 13199003
ECBPOST  EQU   X'40'                                                    13199202
BLANK    EQU   C' '                                            @Z30LPTJ 13199303
LEFPAREN EQU   C'('                                            @Z30LPTJ 13219303
RTPAREN  EQU   C')'                                            @Z30LPTJ 13239303
COMMA    EQU   C','                                            @Z30LPTJ 13259303
HYPHEN   EQU   C'-'                                            @Z30LPTJ 13279303
OHDASH   EQU   C'O'                                            @Z30LPTJ 13299303
EYEDASH  EQU   C'I'                                            @Z30LPTJ 13319303
RI       EQU   X'80'                                           @ZM30445 13329303
         EJECT                                                          13350003
* * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * *         13400000
*                                                             *         13600000
* ENTRY CODE AND INITIALIZATION                               *         13800000
*                                                             *         14000000
* * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * *         14200000
         USING CHAIN1,R3                                         Y02669 14450002
         USING IEE36XSA,R2         TO REF EXTENDED SAVE AREA            14600000
         USING IEE36WRK,R8        TO REFERENCE WORK AREA                15000002
         SPACE 1                                                        15200000
         BALR  R12,R0              INITIALIZE BASE REGISTER             15400000
         USING *,R12        TO ESTAB BASE OF ADDRBILITY          Y02669 15450002
         SPACE 1                                                        15500002
         MODID BR=YES                                                   15550002
         SPACE 1                                                        15600000
         LR    R3,R1              CSCB PTR                       Y02669 15650002
         LR    R4,R14             SAVE RET ADDRESS               Y02653 15700002
         LOAD  EP=IEECB860                                       Y02653 15750002
         LR    R6,R0              SAVE RTN'S ADDRESS             Y02653 15760002
*                                                                       15770002
         L     R0,IEE36GMP         INIT GETMAIN LV PARAM REG            15800002
       GETMAIN R,LV=(0)            GETMAIN WORK/SAVE AREA               16000000
         LR    R8,R1              INIT SAVE AREA REG             Y02653 16050002
         ST    R3,K12(R8)         SAVE CSCB POINTER              Y02653 16100002
         ST    R3,K0(R8)          SAVE CSCB PTR FOR STAE         Y02653 16110002
         ST    R4,K8(R8)          SAVE REUTRN ADDRESS            Y02653 16120002
         LA    R4,K16(R8)         GET ADDR OF STAE CMD PARAM     Y02653 16130002
         ST    R4,K4(R8)          AND STORE FOR STAE             Y02653 16140002
         MVC   K16(K5,R8),LVARY   INIT CMD PARAM TO HAVE SIZE    Y02653 16142002
*                                 OF CMD AND COMMAND VERB        Y02653 16144002
         LR    R15,R6             ADDRESS OF STAE RTN            Y02653 16146002
         LR    R13,R8             SAVE SA PTR                   YM02653 16146202
         STM   R0,R15,K24(R13) STR REGS SO CB860 DOESN'T CLOBBERYM02653 16146402
         BALR  R14,R15            GO TO SET UP STAE ENVIRONMNT   Y02653 16148002
*                                                                Y02653 16148402
         LM    R0,R14,K24(R13)    RESTORE REGS                  YM02653 16148502
         LR    R5,R15             SAVE RETURN CODE FROM STAE     Y02653 16148802
         DELETE EP=IEECB860                                      Y02653 16149202
         L     R3,K12(R8)         RE-OBTAIN CSCB PTR             Y02653 16149602
         L     R4,K8(R8)          RE-OBTAIN RETURN ADDRESS       Y02653 16149702
         LTR   R5,R5              STAE IS OK?                    Y02653 16149802
         BZ    STAEOK             YES                            Y02653 16149902
         LR    R1,R8              NO, GOTTEN CORE PTR INTO R1    Y02653 16166602
         L     R0,IEE36GMP        AND SIZE INTO R0 FOR FREE      Y02653 16176602
         FREEMAIN R,LV=(0),A=(1)                                 Y02653 16178602
         LR    R1,R3              CSCB PTR                       Y02653 16180602
         OI    CHSTS,CHFC         SET - FREE CSCB BIT            Y02653 16182602
         MGCR  (1),CHAIN                                         Y02653 16183002
         LR    R14,R4             RETURN ADDRESS TO R14          Y02653 16183102
         BR    R14                RETURN                         Y02653 16183202
*                                                                Y02653 16188802
STAEOK   EQU   *                                                 Y02653 16190802
         ST    R4,IEE36S14        SAVE RETURN REGISTER           Y02669 16192802
         LA    R0,D132            DUMMY XSA AND SAVE AREA CORE   Y02669 16193602
         GETMAIN R,LV=(0)                                        Y02669 16194002
         LR    R2,R1              DUMMY XSA POINTER              Y02669 16194102
         LA    R13,D48(R1)        SAVE AREA POINTER              Y02669 16194202
         XC    K0(D48,R2),K0(R2)  ZERO OUT DUMMY XSA             Y02669 16194302
         LR    R1,R3              CSCB PTR INTO REG1 FOR STORE   Y02669 16244302
         L     R14,IEE36S14         RESTORE REG14 FOR SAVE       Y02669 16246302
         STM   R0,R15,K0(R13)     SAVE REGS                      Y02669 16254302
         ST    R3,D64(R13)        CSCB PTR TO WORD17 OF SAVEAREA Y02669 16264302
         LA    R4,CHBUF           PTR TO CMD PARAM LIST          Y02669 16274302
         LA    R4,K0(R4)                                         Y02669 16284302
         ST    R4,XAL             STORE PTR TO PARAMS IN D XSA   Y02669 16286302
         MVC   XAU(K1),CHUCMP     UCMID INTO DUMMY XSA           Y02669 16288302
         MVC   XAV(K8),VARY       VARY VERB                      Y02669 16290302
         LA    R4,D124            SIZE OF PARAM LIST BUFFER      Y02669 16292702
         ST    R4,XAR             INTO DUMMY XSA                 Y02669 16293102
         MVC   XAS(K2),CHINC      MOVE R/I AUTH OR 0             Y02669 16293502
         DROP  R3                                                Y02669 16373502
*                                                                Y02669 16400002
         L     R3,XAL              GET PTR TO BEGIN OF OPERANDS         17200000
         LA    R3,K0(R3)           CLEAR HIGH ORDER BYTE OF ADR         17400000
         MVC   XAX(K8),IEE3303D     SET EXIT IDENTIFIER          Y02669 18400002
*                       XAP (1WORD) IS ZEROES NOW = NO LOAD FOR  Y02669 18450002
*                       IEEVDEV WAS PERFORMED AS YET             Y02669 18500002
*                       XAD (1 WORD) IS ALSO 0, NO GOTTEN        Y02669 18550002
*                       CORE FOR IEEVDEV PARAM AS YET            Y02669 18600002
         EJECT                                                          19200000
* * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * *         19450002
*                                                             *         19600000
* DETERMINE LENGTH OF OPERANDS                                *         19800000
*                                                             *         20000000
* * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * *         20200000
         SPACE 1                                                        20400000
         LR    R6,R3               GET POINTER TO BEG OF BUFFER         20600002
         AR    R4,R6              POINTER TO EOB INTO REG4       Y02669 20850002
IEE36030 EQU   *                                                        21600003
         CLI   K0(R6),BLANK       IS THIS CHARACTER A BLANK?   @Z30LPTJ 21700003
         BE    IEE3603A           EXIT IF A BLANK IS FOUND     @Z30LPTJ 21800003
         CLC   K0(K6,R6),ONLINE   IS IT NOW 'ONLINE' KEYWORD?  @Z30LPTJ 21820003
         BE    CHKON              YES, CHECK FOR ITS VALIDITY  @Z30LPTJ 21840003
         CLC   K0(K7,R6),OFFLINE  IS IT NOW 'OFFLINE' KEYWORD? @Z30LPTJ 21860003
         BE    CHKOFF             YES, CHECK FOR ITS VALIDITY  @Z30LPTJ 21880003
         LA    R6,K1(R6)          INCREMENT TO NEXT CHARACTER  @Z30LPTJ 21900003
         CR    R6,R4              PAST END OF BUFFER?          @Z30LPTJ 22000003
         BNH   IEE36030           NO, LOOP UNTIL LAST END BLANK@Z30LPTJ 22100003
IEE3603A EQU   *                                               @Z30LPTJ 22200003
         LR    R4,R6              SAVE 'END OF COMMAND' POINTER@Z30LPTJ 22210003
         BCTR  R4,R0              DECREMENT IT BY ONE          @Z30LPTJ 22220003
         LR    R5,R4              POINTER TO  LAST NON-BLANK     Y02669 22250002
         SH    R5,FOUR            POINTER TO 'NLINE,'FLINE,OR    Y02669 22300002
*                                 'NSOLE                         Y02669 22350002
         LR    R6,R3              GET POINTER TO BEG OF BUFFER @Z30LPTJ 22350103
         B     STRTSCAN           START SCANNING THE COMMAND   @Z30LPTJ 22350703
         SPACE                                                          22351303
CHKON    EQU   *                                               @Z30LPTJ 22351903
         LA    R6,K6(R6)          POINT PAST 'ONLINE' KEYWORD  @Z30LPTJ 22352503
         B     CHECKER            AVOID 'OFFLINE' INCREMENTER  @Z30LPTJ 22353103
CHKOFF   EQU   *                                               @Z30LPTJ 22360803
         LA    R6,K7(R6)          POINT PAST 'OFFLINE' KEYWORD @Z30LPTJ 22361403
CHECKER  EQU   *                                               @Z30LPTJ 22362003
         CLI   K0(R6),BLANK       IS THERE A REQUIRED BLANK?   @Z30LPTJ 22362603
         BE    IEE3603A           YES, A BLANK IS FOUND        @Z30LPTJ 22363203
         B     TERM               NO, TAKE ERROR EXIT          @Z30LPTJ 22363803
         EJECT                                                          22364803
************************************************************** @Z30LPTJ 22367803
*                                                            * @Z30LPTJ 22370803
* DETERMINE IF THERE IS A VARY RANGE COMMAND                 * @Z30LPTJ 22378803
*                                                            * @Z30LPTJ 22385803
************************************************************** @Z30LPTJ 22392803
STRTSCAN EQU   *                                               @Z30LPTJ 22395803
         LR    R10,R6             OBTAIN AN INDEXING REGISTER  @Z30LPTJ 22399803
         CLI   K0(R10),LEFPAREN   IS THERE A LEFT PARENTHESIS? @Z30LPTJ 22406803
         BNE   SCANHERE           NO, AVOID INDEXING           @Z30LPTJ 22413803
         LA    R10,K1(R10)        INDEX TO NEXT CHARACTER      @Z30LPTJ 22420803
SCANHERE EQU   *                                               @Z30LPTJ 22427803
         CLI   K3(R10),HYPHEN     IS 3RD CHARACTER A HYPHEN?   @Z30LPTJ 22430803
         BNE   ONVARY             NO, DO NOT ENTER VARY RANGE  @Z30LPTJ 22434803
         CLI   K2(R10),EYEDASH    IS 2ND CHARACTER AN 'I'      @Z30LPTJ 22441803
         BE    ONVARY             YES, DO NOT ENTER VARY RANGE @Z30LPTJ 22448803
         CLI   K2(R10),OHDASH     IS 2ND CHARACTER AN 'O'      @Z30LPTJ 22455803
         BE    ONVARY             YES, DO NOT ENTER VARY RANGE @Z30LPTJ 22462803
         CLC   K0(K5,R5),FLINE    IS THIS VARY OFFLINE?        @Z30LPTJ 22465803
         BE    RANGLOOP           YES, AVOID ONLINE BIT SETTING@Z30LPTJ 22469803
         CLC   K0(K5,R5),NLINE    IS THIS VARY ONLINE?         @Z30LPTJ 22476803
         BNE   CONFLICT           NO, ISSUE ERROR MESSAGE      @Z30LPTJ 22483803
         OI    XAAVRANG,XAARNG4   TURN ONLINE BIT ON           @Z30LPTJ 22490803
RANGLOOP EQU   *                                               @Z30LPTJ 22497803
         CLI   K7(R10),COMMA      IS 7TH CHARACTER A COMMA?    @Z30LPTJ 22500803
         BNE   CHECK              NO, CHECK END DELIMTER       @Z30LPTJ 22504803
         CLC   K8(K6,R10),ONLINE  IS IT ONLINE KEYWORD NOW?    @Z30LPTJ 22511803
         BE    NEXTMOD            YES, GO TO IEECB904          @Z30LPTJ 22518803
         CLC   K8(K7,R10),OFFLINE IS IT OFFLINE KEYWORD NOW?   @Z30LPTJ 22525803
         BE    NEXTMOD            YES, GO TO IEECB904          @Z30LPTJ 22532803
         CLC   K8(K7,R10),CONSOLE IS IT CONSOLE KEYWORD?       @Z30LPTJ 22534803
         BE    CONFLICT           YES, ISSUE ERROR MESSAGE     @Z30LPTJ 22536803
         LA    R10,K8(R10)        INDEX TO NEXT SET OF RANGE   @Z30LPTJ 22539803
         CLI   K3(R10),HYPHEN     IS 3RD CHARACTER A HYPHEN?   @Z30LPTJ 22546803
         BE    RANGLOOP           YES, CHECK FURTHER           @Z30LPTJ 22553803
         B     TERM               NO, ISSUE ERROR MESSAGE      @Z30LPTJ 22560803
CHECK    EQU   *                                               @Z30LPTJ 22567803
         CLI   K7(R10),RTPAREN    IS IT A RIGHT PARENTHESIS?   @Z30LPTJ 22574803
         BNE   DELIMIT            NO, ISSUE ERROR MESSAGE      @Z30LPTJ 22581803
         CLI   K8(R10),COMMA      IS NEXT CHARACTER A COMMA?   @Z30LPTJ 22588803
         BNE   DELIMIT            NO, ISSUE ERROR MESSAGE      @Z30LPTJ 22595803
         CLC   K9(K6,R10),ONLINE  IS IT ONLINE KEYWORD NOW?    @Z30LPTJ 22602803
         BE    NEXTMOD            YES, GO TO IEECB904          @Z30LPTJ 22609803
         CLC   K9(K7,R10),OFFLINE IS IT OFFLINE KEYWORD NOW?   @Z30LPTJ 22616803
         BE    NEXTMOD            YES, GO TO IEECB904          @Z30LPTJ 22623803
         CLC   K9(K7,R10),CONSOLE IS IT CONSOLE KEYWORD?       @Z30LPTJ 22625803
         BNE   TERM               NO, ISSUE ERROR MESSAGE      @Z30LPTJ 22627803
         EJECT                                                          22630803
************************************************************** @Z30LPTJ 22631803
*                                                            * @Z30LPTJ 22632803
* ERROR MESSAGES ARE ISSUED HERE DUE TO BAD VARY RANGE       * @Z30LPTJ 22633803
* COMMANDS                                                   * @Z30LPTJ 22634803
*                                                            * @Z30LPTJ 22635803
************************************************************** @Z30LPTJ 22636803
CONFLICT EQU   *                                               @Z30LPTJ 22637803
         MVC   XSA(CONFLNG),CONFMSG SET UP MESSAGE BUFFER      @Z30LPTJ 22640803
         B     MSGOUT             GO TO WTO ISSUER             @Z30LPTJ 22644803
TERM     EQU   *                                               @Z30LPTJ 22651803
         MVC   XSA(TERMLNG),TERMMSG SET UP MESSAGE BUFFER      @Z30LPTJ 22658803
         B     MSGOUT             GO TO WTO ISSUER             @Z30LPTJ 22665803
DELIMIT  EQU   *                                               @Z30LPTJ 22672803
         MVC   XSA(DELIMLNG),DELIMMSG SET UP MESSAGE BUFFER    @Z30LPTJ 22679803
MSGOUT   EQU   *                                               @Z30LPTJ 22686803
         SR    R0,R0              CLEAR FOR NEXT INSTRUCTION   @Z30LPTJ 22693803
         TM    XAU,RI             IS THIS FROM INPUT STREAM?   @ZM30445 22695803
         BO    XAUIN1             YES, DON'T INSERT CONSOLE ID @ZM30445 22697803
         IC    R0,XAU             INSERT CONSOLE ID            @Z30LPTJ 22700803
XAUIN1   EQU   *                                               @ZM30445 22703803
         LA    R1,XSA             GET POINTER TO MESSAGE BUFFER@Z30LPTJ 22707803
         WTO   MF=(E,(1))         ISSUE ERROR MESSAGE          @Z30LPTJ 22707903
         LM    R0,R15,K0(R13)     RESTORE REGISTERS            @Z30LPTJ 22716803
         LR    R4,R14             PREPARE FOR RETURN EXECUTION @Z30LPTJ 22718803
         B     NODELETE           PREPARE TO RETURN TO CALLER  @Z30LPTJ 22719803
         EJECT                                                          22721803
************************************************************** @Z30LPTJ 22729803
*                                                            * @Z30LPTJ 22730803
* A GOOD VARY RANGE COMMAND HAS BEEN ISSUED                  * @Z30LPTJ 22731803
*                                                            * @Z30LPTJ 22732803
************************************************************** @Z30LPTJ 22733803
NEXTMOD  EQU   *                                               @Z30LPTJ 22734803
         LR    R10,R14            SAVE RETURN TO CALLER ADDRESS@Z30LPTJ 22735803
         L     R0,WORKAREA        OBTAIN CORE SPECIFICATION    @Z30LPTJ 22749803
         GETMAIN R,LV=(0)         GET THE DATA AREA CORE       @Z30LPTJ 22756803
         LR    R9,R1              SET DATA AREA ADDRESSABILITY @Z30LPTJ 22759803
NEXTMODA EQU   *                                               @Z30LPTJ 22761803
         XC    XAD(K4),XAD        CLEAR XAD ACROSS VARY AREA   @Z30LPTJ 22765803
         XC    XAP(K4),XAP        CLEAR XAP ACROSS VARY AREA   @Z30LPTJ 22767803
         L     R15,VCON904        GET IEECB904 ADDRESS         @Z30LPTJ 22770803
         BR    R15                GO TO VARY RANGE PROCESSOR   @Z30LPTJ 22791803
         EJECT                                                          22819803
************************************************************** @Z30LPTJ 22820803
*                                                            * @Z30LPTJ 22821803
* SECONDARY ENTRY POINT AFTER A VARY RANGE COMMAND HAS BEEN  * @Z30LPTJ 22822803
* PROPAGATED INTO INDIVIDUAL UNITS                           * @Z30LPTJ 22823803
*                                                            * @Z30LPTJ 22824803
************************************************************** @Z30LPTJ 22826803
IEE36ENT EQU   *                                               @Z30LPTJ 22827003
         LR    R14,R10            GET RETURN TO CALLER ADDRESS @Z30LPTJ 22827203
         L     R5,D64(R13)        OBTAIN THE CSCB POINTER      @Z30LPTJ 22848803
         USING CHAIN1,R5          ESTABLISH CSCB ADDRESSABILITY@Z30LPTJ 22849803
         MVC   XAU(K1),CHUCMP     RE-SET UCM ID                @Z30LPTJ 22850803
         MVC   XAS(K2),CHINC      RE-SET R/I AUTHORITY         @Z30LPTJ 22851803
         DROP  R5                                              @Z30LPTJ 22852803
         MVC   XAV(K8),VARY       RE-SET VARY VERB INDICATOR   @Z30LPTJ 22853803
         MVC   XAX(K8),IEE3303D   RE-SET EXIT IDENTIFIER       @Z30LPTJ 22854803
         L     R3,XAL             GET POINTER TO NEW COMMAND   @Z30LPTJ 22855803
         LA    R3,K0(R3)          CLEAR HIGH ORDER BYTE        @Z30LPTJ 22856803
         L     R6,K136(R3)        OBTAIN SAVED XAD             @Z30LPTJ 22857803
         ST    R6,XAD             RESTORE XAD INTO THE XSA     @Z30LPTJ 22858803
         L     R6,K140(R3)        OBTAIN SAVED XAP             @Z30LPTJ 22864803
         ST    R6,XAP             RESTORE XAP INTO THE XSA     @Z30LPTJ 22869803
         LR    R6,R3              NEEDED FOR VARY PROCESSING   @Z30LPTJ 22875803
         LA    R4,D124            RE-ESTABLISH BUFFER SIZE     @Z30LPTJ 22881803
         ST    R4,XAR             PUT INTO XSA SLOT            @Z30LPTJ 22889803
         AR    R4,R6              OBTAIN END OF BUFFER POINTER @Z30LPTJ 22896803
BUFFLOOP EQU   *                                               @Z30LPTJ 22903803
         BCTR  R4,R0              DECREMENT END ADDRESS BY ONE @Z30LPTJ 22906803
         CLI   K0(R4),BLANK       IS THIS CHARACTER A BLANK?   @Z30LPTJ 22910803
         BE    BUFFLOOP           YES, LOOK FOR LAST END BLANK @Z30LPTJ 22917803
         LR    R5,R4              POINTER TO LAST NON-BLANK    @Z30LPTJ 22924803
         SH    R5,FOUR            POINTER TO 'NLINE' OR 'FLINE'@Z30LPTJ 22931803
         TM    XAAVRANG,XAARNG2   ENQ DONE ALREADY?            @Z30LPTJ 22938803
         BO    DIDENQ             YES, PROCESS THE COMMAND     @Z30LPTJ 22957803
ENQBIT   EQU   *                                               @Z30LPTJ 22961803
         OI    XAAVRANG,XAARNG2   TURN ENQ RESOURCE BIT ON     @Z30LPTJ 22965803
         EJECT                                                          22973803
************************************************************** @Z30LPTJ 22977803
*                                                            * @Z30LPTJ 22981803
* COMMON VARY PROCESSING                                     * @Z30LPTJ 22989803
*                                                            * @Z30LPTJ 22993803
************************************************************** @Z30LPTJ 23000003
ONVARY   EQU   *                                               @Z30LPTJ 23006003
         CLC   K0(K5,R5),FLINE    IS IT AN OFFLINE COMMAND?      Y02669 23012003
         BE    OFFLENQ            YES, DO ENQ FOR THIS COMMAND @YM5443P 23020003
         CLC   K0(K5,R5),NLINE    IS IT AN ONLINE COMMAND?     @YM5443P 23040003
         BE    ONLENQ             YES, DO ENQ FOR THIS COMMAND @YM5443P 23060003
         LA    R11,K5             OBTAIN MAXIMUM CTR COMPRAND  @YM5443P 23080003
         LA    R10,K1             SET INCREMENTER TO ONE       @YM5443P 23100003
         LR    R9,R10             SET COUNTER TO ONE           @YM5443P 23120003
         ENQ   MF=(E,IEFSCONA)                                 @YM5443P 23160003
LOOPENQ  EQU   *                                               @YM5443P 23180003
         XC    ECBAREA(K4),ECBAREA CLEAR ECB AREA              @YM5443P 23190003
         MVC   ENQMVC(ENQLNTH),IEFSCONB                        @YM5443P 23200003
         LA    R1,ENQMVC                                       @YM5443P 23220003
         ENQ   MF=(E,(1)),ECB=ECBAREA                          @YM5443P 23240003
         LTR   R15,R15            IS RESOURCE OBTAINED?        @YM5443P 23260003
         BZ    DIDENQ             YES,EXIT                     @YM5443P 23280003
         STIMER WAIT,DINTVL=TIMELOC NO, WAIT 5 SECONDS?        @ZA09414 23300003
         TM    ECBAREA,ECBPOST    ECB POSTED?                  @YM5443P 23320003
         BO    DIDENQ             YES,EXIT                     @YM5443P 23340003
         DEQ   MF=(E,IEFSCONC)    NO, DEQUEUE                  @YM5443P 23360003
         BXLE  R9,R10,LOOPENQ     FIFTH ENQUEUE ATTEMPTED?     @YM5443P 23380003
REISSUE  EQU   *                  SET UP TO ISSUE WTOR         @ZA09166 23400803
         MVC   IEE799D(IEE799L),IEE799B MOVE LIST FORM TO DSECT@ZA09166 23401603
         SR    R0,R0              CLEAR WORK REGISTER          @ZA09166 23402403
         ST    R0,ECBAREA         CLEAR THE ECB                @ZA09166 23403203
         TM    XAU,RI             IS THE CMD FROM INPUT STREAM @ZA09166 23404003
         BO    NOCNSID            YES, NO CONSOLE ID NEEDED    @ZA09166 23404803
         IC    R0,XAU             GET THE CONSOLE ID           @ZA09166 23405603
NOCNSID  EQU   *                  ISSUE THE WTOR               @ZA09166 23406403
         WTOR   ,RPYAREA,6,ECBAREA,MF=(E,IEE799) ISSUE MSG     @ZA09166 23407203
         WAIT  ECB=ECBAREA        WAIT FOR A REPLY             @ZA09166 23408003
         OC    RPYAREA(L'RPYAREA),BLANKS CAPITALIZE REPLY      @ZA09166 23408803
         CLC   RPYAREA(L'CANCEL),CANCEL IS REPLY CANCEL        @ZA09166 23409603
         BNE   NOTCANCL           YES, EXIT THIS MODULE        @ZA09166 23410403
         SR    R0,R0               CLEAR R0 FOR CONS. ID       @ZA09166 23410503
         TM    XAU,RI              IS THIS FROM INPUT STREAM   @ZA09166 23410603
         BO   NOCNSID1             YES, DON'T INSERT CONSOLE ID@ZA09166 23410703
         IC    R0,XAU              CONSOLE ID FOR WTO          @ZA09166 23410803
NOCNSID1 EQU   *                                               @ZA09166 23410903
         WTO   MF=(E,IEE756I)      ISSUE VARY CNACELLED MSG    @ZA09166 23411003
         B     IEE36050            TERMINATE THE VARY COMMAND  @ZA09166 23411103
NOTCANCL EQU   *                                               @ZA09166 23411203
         CLC   RPYAREA(L'RETRY),RETRY IS REPLY RETRY           @ZA09166 23411903
         BNE   NOTRETRY           NO, CHECK FOR WAIT           @ZA09166 23412003
         LA    R11,K5             GET COUNTER FOR ENQ LOOP     @ZA09166 23412803
         LA    R10,K1             GET INCREMENT FOR ENQ LOOP   @ZA09166 23413603
         LR    R9,R10             START COUNT AT ONE           @ZA09166 23414403
         XC    ECBAREA(L'ECBAREA),ECBAREA CLEAR THE ECB        @ZA09166 23415203
         B     LOOPENQ            TRY THE ENQ LOOP AGAIN       @ZA09166 23416003
NOTRETRY EQU   *                  REPLY NOT RETRY, CHECK WAIT  @ZA09166 23416803
         CLC   RPYAREA(L'WAIT),WAIT WAS REPLY WAIT             @ZA09166 23417603
         BNE   REISSUE            NO, REISSUE WTOR             @ZA09166 23418403
         ENQ   MF=(E,IEFSCOND)    YES, OBTAIN RESOURCE         @YM5443P 23419203
         B     DIDENQ                                          @YM5443P 23420003
OFFLENQ  EQU   *                                               @YM5443P 23440003
         ENQ   MF=(E,IEFSOFFA)                                 @YM5443P 23460003
         ENQ   MF=(E,IEFSOFFB)                                 @YM5443P 23480003
         TM    XAAVRANG,XAARNG1   VARY RANGE BEING PROCESSED?  @Z30LPTJ 23490003
         BO    DIDENQ             YES, PROCESS THE COMMAND     @Z30LPTJ 23500003
         B     IEE360D0           EXIT TO IEE3303D             @YM5443P 23520003
ONLENQ   EQU   *                                               @YM5443P 23540003
         ENQ   MF=(E,IEFSDONA)                                 @YM5443P 23560003
         ENQ   MF=(E,IEFSDONB)                                 @YM5443P 23580003
DIDENQ   EQU   *                                               @YM5443P 23600003
         SR    R4,R6               CALCULATE LENGTH OF OPERANDS         23620003
         BCTR  R6,R0               DECREMENT BUFFER ADDRESS             23640003
         SPACE 1                                                        24000000
         BAL   R14,IEE36140        LINK TO FIND NEXT TERM LGTH          24200000
         LA    R7,K0(R5,R6)        GET ADDR OF CHAR AFTER TERM          24400000
         BAL   R11,IEE36120        SEE IF SINGLE VALID TERM             25800002
         BNE   IEE36060            IF NOT, CHECK FOR MULT TERMS         26000000
         SPACE 1                                                        26200000
* * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * *         26400000
*                                                             *         26600000
* VERIFY PATHS FOR SINGLE OPERAND (DEVICE) SPECIFIED          *         26800000
*                                                             *         27000000
* * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * *         27200000
         SPACE 1                                                        27400000
         BAL   R10,IEE360E0        SEE IF UNIT HAS GOOD PATHS           27600000
         B     IEE360D0            IF SO, TAKE NORMAL EXIT              27800000
         EJECT                                                          28000003
* * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * *         28200000
*                                                             *         28400000
* ERROR EXIT CODE (RETURN TO SYSTEM                           *         28600002
*                                                             *  Y02669 28800002
* * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * *         29000000
         SPACE 1                                                        29200000
IEE36050 EQU   *                                                 Y02651 29250002
         TM    XAAVRANG,XAARNG1   VARY RANGE BEING PROCESSED?  @Z30LPTJ 29250403
         BNO   IEEDEQUE           NO, AVOID EXIT TO IEECB904   @Z30LPTJ 29250803
         OI    XAAVRANG,XAARNG3   TURN TERMINATION BIT ON      @Z30LPTJ 29251603
         LM    R0,R15,K0(R13)     RESTORE REGISTERS            @Z30LPTJ 29252003
         B     NEXTMODA           EXIT VIA IEECB904            @Z30LPTJ 29256003
         SPACE 2                                                        29260003
IEE36904 EQU   *                                               @Z30LPTJ 29261003
         TM    XAAVRANG,XAARNG1   VARY RANGE BEING PROCESSED?  @Z30LPTJ 29262003
         BO    NEXTMODA           YES, PROCESS MORE UNITS      @Z30LPTJ 29263003
         SPACE 2                                                        29264003
*****************************************************************Y02651 29265003
*                                                                Y02651 29270002
*  SINCE THIS IS A TERMINAL EXIT WE MUST DEQUE OFF BEFORE GETTINGY02651 29280002
*  OUT OF THIS COMMAND PROCESSOR                                 Y02651 29292002
*                                                                Y02541 29294002
IEEDEQUE EQU   *                                                 Y02651 29296002
         DEQ   MF=(E,IEFDEQUE)                                   Y02651 29298002
*                                                                Y02651 29298402
*****************************************************************Y02651 29300002
         SPACE 5                                                        29360003
         LM    R0,R15,K0(R13)           RESTORE REGS             Y02669 29370002
         LR    R4,R14             SAVE RET ADDRESS               Y02669 29410002
         L     R15,XAP            GET IEEVDEV ADDRESS          @Z30LPTJ 29413003
         LTR   R15,R15            IS THERE AN ADDRESS?         @Z30LPTJ 29416003
         BZ    NODELETE           NOPE, NO DELETE REQUIRED     @Z30LPTJ 29419003
         XC    XAP(K4),XAP        MUST ISSUED DELETE FOR VDEV  @Z30LPTJ 29422003
         DELETE EP=IEEVDEV                                     @Z30LPTJ 29425003
         L     R1,XAD             ADDR OF VDEV PARAM CORE      @Z30LPTJ 29428003
         LTR   R1,R1              ANY PTR?, JUST IN CASE       @Z30LPTJ 29431003
         BZ    NODELETE           NOPE, NOTHING TO FREE        @Z30LPTJ 29434003
         LA    R0,TREE08         SIZE OF THAT CORE             @Z30LPTJ 29437003
         FREEMAIN R,LV=(0),A=(1)                               @Z30LPTJ 29440003
         XC    XAD(K4),XAD        ZERO OUT CORE PTR            @Z30LPTJ 29443003
NODELETE EQU   *                                               @Z30LPTJ 29446003
         L     R0,IEE36GMP        3603D WORK AREA SIZE         @Z30LPTJ 29455003
         LR    R1,R8              AND POINTER                  @Z30LPTJ 29458003
         FREEMAIN R,LV=(0),A=(1)                               @Z30LPTJ 29461003
         L     R1,D64(R13)        CSCB PTR                       Y02669 29480003
         USING CHAIN1,R1                                         Y02669 29510002
         OI    CHSTS,CHFC         SET - FREE CSCB BIT            Y02669 29560002
         MGCR  (1),CHAIN                                         Y02669 29570002
         LA    R0,D132            CORE GOTTEN FOR VARY = SIZE    Y02669 29587202
         LR    R1,R2              POINTER INTO REG1              Y02669 29590002
      FREEMAIN R,LV=(0),A=(1)      FREE UP WORK/SAVE AREA               29600000
         LR    R14,R4             RESTORE RETURN REG             Y02669 29760002
         BR    R14                 EXIT - NO VARY ONLINE DONE           29800000
         EJECT                                                          30000000
* * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * *         30200000
*                                                             *         30400000
* LOOP TO CHECK SYNTAX OF EACH TERM                           *         30600000
*   EXIT - TO IEE360D0 FOR ANY INVALID TERM                   *         30800000
*        - TO IEE36080 (NSI) IF ALL TERMS ARE VALID           *         31000000
*                                                             *         31200000
* * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * *         31400000
         SPACE 1                                                        31600000
IEE36060 LR    R6,R3               GET PTR TO BEG OF OPERANDS           31800000
         SPACE 1                                                        32000000
IEE36070 BAL   R11,IEE36110        LINK TO VALIDATE NEXT TERM           32200000
         BNE   IEE360D0            TAKE NORMAL EXIT ON INV TERM         32400000
         ALR   R6,R5               UPDATE INDEX TO NEXT TERM            32600000
         CLC   K0(K2,R6),IEE36END  SEE IF DELIMETED BY C'),'            32800000
         BNE   IEE36070            LOOP UNTIL END OF LIST FOUND         33000000
         SPACE 1                                                        33200000
         LR    R6,R3               GET PTR TO BEG OF OPERANDS           33400000
         SPACE 1                                                        33600000
* * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * *         33800000
*                                                             *         34000000
* LOOP TO VERIFY PATHS FOR EACH OPERAND (DEVICE) SPECIFIED    *         34200000
*                                                             *         34400000
* * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * *         34600000
         SPACE 1                                                        34800000
IEE36080 BAL   R14,IEE36140        LINK TO LOCATE NEXT TERM             35000000
         BAL   R10,IEE360E0        LINK TO CHECK UNIT'S PATHS           35200000
         SPACE 1                                                        35400000
         B     IEE360B0            UPDATE INDEX FOR GOOD PATH           35600000
         SPACE 1                                                        35800000
* * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * *         36000000
*                                                             *         36200000
* CODE TO DELETE UNIT HAVING NO PATHS FROM THE XSA            *         36400000
*                                                             *         36600000
* * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * *         36800000
         SPACE 1                                                        37000000
         SLR   R4,R5               SUBTR LGTH TO DELETE FR TOTL         37200000
         LA    R7,K1(R6,R4)        GET ADDR OF NEW END OF BUFFR         37400000
         LA    R9,K0(R5,R6)        GET ADDR OF NEXT TERM                37600000
         EX    R4,IEE36090         OVERLAY DELETED TERM                 37800000
         BCTR  R5,R0               DECREMENT LENGTH BY ONE              38000000
         BCTR  R5,R0               DECREMENT LENGTH BY ONE              38200000
         MVI   K0(R7),X40          MOVE BLANK INTO END OF BUFFR         38400000
         EX    R5,IEE360A0         BLANK OUT END OF BUFFER              38600000
         B     IEE360C0            GO TO SEE IF FINISHED                38800000
         SPACE 1                                                        39000000
IEE36090 MVC   K0(K0,R6),K0(R9)    EX TO OVERLAY DELETED UNIT           39200000
IEE360A0 MVC   K1(K0,R7),K0(R7)    EX TO BLANK REMAINDER OF BUF         39400000
         EJECT                                                          39600000
* * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * *         39800000
*                                                             *         40000000
* CODE TO UPDATE INDEX, LEAVING GOOD UNIT IN THE XSA          *         40200000
*                                                             *         40400000
* * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * *         40600000
         SPACE 1                                                        40800000
IEE360B0 MVI   K0(R3),X4D          SET SWITCH FOR GOOD UNIT             41000000
         ALR   R6,R5               UPDATE OPERANDS INDEX                41200000
         SLR   R4,R5               DECREMENT REMAINING LENGTH           41400000
         SPACE 1                                                        41600000
* * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * *         41800000
*                                                             *         42000000
* CODE TO LOOP UNTIL SCAN IS COMPLETE                         *         42200000
*   EXIT - TO IEE36080 IF SCAN IS NOT COMPLETE                *         42400000
*        - TO IEE360D0 (NSI) IF ANY UNIT IS LEFT IN THE XSA   *         42600000
*        - TO IEE36050 IF NO UNIT IS LEFT IN THE XSA          *         42800000
*                                                             *         43000000
* * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * *         43200000
         SPACE 1                                                        43400000
IEE360C0 CLI   K0(R6),X5D          SEE IF SCAN IS COMPLETE              43600000
         BNE   IEE36080            LOOP UNTIL SCAN IS COMPLETED         43800000
         CLI   K0(R3),X4D          SEE IF ANY TERMS LEFT IN XSA         44000000
         BNE   IEE36904            IF NOT, IGNORE THE COMMAND  @Z30LPTJ 44200003
        SPACE 1                                                         44400003
* * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * *         44600000
*                                                             *         44800000
* NORMAL EXIT CODE (EXIT TO VARY COMMAND PROCESSOR)           *  Y02669 45000002
*                                                             *         45200002
* * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * *         45400000
         SPACE 1                                                        45600000
IEE360D0 EQU   *                                                 Y02669 45650002
         TM    XAAVRANG,XAARNG1   VARY RANGE BEING PROCESSED?  @Z30LPTJ 45660003
         BO    EXIT33             YES, DO NOT FREE AREAS       @Z30LPTJ 45670003
         LR    R1,R8              3603D'S WORK AREA POINTER      Y02669 45700002
         L     R0,IEE36GMP        AND ITS SIZE                   Y02669 45750002
      FREEMAIN R,LV=(0),A=(1)      FREE UP WORK/SAVE AREA               46000000
         L     R15,XAP                                           Y02669 46010002
         LTR   R15,R15            DID WE EVER LOAD IEEVDEV?      Y02669 46020002
         BZ    EXIT33             NOPE, NO DELETE REQUIRED       Y02669 46030002
         XC    XAP(K4),XAP        WE MUST DELETE VDEV FIRST      Y02669 46040002
         DELETE EP=IEEVDEV                                       Y02669 46042002
         L     R1,XAD             GET ADDR OF VDEV PARAM CORE    Y02669 46042402
         LTR   R1,R1              ANY PTR, JUST IN CASE          Y02669 46042802
         BZ    EXIT33             NOPE, NOTHING TO FREE          Y02669 46043202
         LA    R0,TREE08         GET SIZE INTO R0               YM01603 46043602
         FREEMAIN R,LV=(0),A=(1)                                 Y02669 46043702
         XC    XAD(K4),XAD        ZERO PARAM PTR                 Y02669 46043802
EXIT33   EQU   *                                                 Y02669 46044002
         L     R15,VCON33         ADDRESS OF IEE3303D          @Z30LPTJ 46047003
         LM    R0,R14,K0(R13)     RESTORE THE REGISTERS        @Z30LPTJ 46050003
         BR    R15                EXIT TO 3303D                  Y02669 46150002
         EJECT                                                          46400000
* * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * *         46600000
*                                                             *         46800000
* ROUTINE TO SET INDEX AND LINK TO CHECK PATHS FOR AN OPERAND *         47000000
*   EXIT - TO K0(R10) IF TERM IS SATISFACTORY (GOOD PATHS)    *         47200000
*        - TO K4(R10) IF TERM SHOULD BE REJECTED (NO PATHS)   *         47400000
*                                                             *         47600000
* * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * *         47800000
         SPACE 1                                                        48000000
IEE360E0 LR    R7,R6               GET PATH TEST OPERAND INDEX          48200000
         CLC   K1(K3,R7),IEE36CIN  SEE IF COMPOSITE CONSOLE    @ZM30436 48800003
         BE    IEE36100            IF SO, GO TEST BOTH UNITS            49000000
         CLC   K1(K2,R7),IEE36OUT  SEE IF OUTPUT-ONLY CONSOLE  @ZM30479 49200003
         BNE   IEE360F0            IF NOT, GO TEST NON-MCS UNIT         49400000
         LA    R7,K2(R7)           UPDATE INDEX FOR O-UNIT              49600000
IEE360F0 BAL   R11,IEE361A0        LINK TO TEST UNIT'S PATHS            49800000
         LTR   R15,R15            DOES THE UNIT HAVE A PATH?     Y02669 49850002
         BNZ   K4(R10)            NOPE, OMIT THIS UNIT           Y02669 49900002
         BR    R10                 ELSE TAKE A NORMAL EXIT              50200000
IEE36100 LA    R7,K3(R7)           UPDATE INDEX FOR I-UNIT              50400000
         BAL   R11,IEE361A0        LINK TO CHECK I-UNIT'S PATHS         50600000
         ST    R15,D68(R13)   STORE RET CODE FOR FUTURE USE      Y02669 50650002
         LA    R7,K6(R7)           UPDATE TEST INDEX FOR O-UNIT         50800000
         BAL   R11,IEE361A0        LINK TO CHECK O-UNIT'S PATHS         51000000
         BALR  R7,R0               SAVE CONDITION CODE BITS             51200000
         LTR   R15,R15            IS THE O-UNIT PATHABLE?        Y02669 51250002
         BNZ   K4(R10)            NOPE, OMIT THIS COMPOSITE      Y02669 51300002
         L     R15,D68(R13)    GET CODE FROM I-UNIT              Y02669 51350002
         LTR   R15,R15            IS THE I-UNIT PATHABLE?        Y02669 51360002
         BNZ   K4(R10)            NOPE, OMIT THIS COMPOSITE UNIT Y02669 51370002
         BR    R10           YES, ALL IS OK WITH THIS UN IT      Y02669 51380002
         EJECT                                                          52800000
* * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * *         53000000
*                                                             *         53200000
* ROUTINE TO VALIDATE SYNTAX OF SPECIFIED TERM                *         53400000
*   EXIT - CC=0 ONLY IF SYNTAX OF TERM IS VALID               *         53600000
* THE FOLLOWING TERMS ARE CONSIDERED VALID                    *         53800000
*        DDD      - ANY I/O DEVICE DDD                        *         54000000
*       DDD/B     - BIN B OF DATA CELL DDD                    *         54200000
*       O-DDD     - OUTPUT-ONLY CONSOLE DDD                   *         54400000
*   (I-DDD,O-DDD) - COMPOSITE CONSOLE DDD/DDD                 *         54600000
*                                                             *         54800000
* * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * *         55000000
         SPACE 1                                                        55200000
IEE36110 BAL   R14,IEE36140        LINK TO IDENTIFY NEXT TERM           55400000
IEE36120 CH    R5,IEE36H04         SEE IF LENGTH IS 4                   55600000
         BCR   BE,R11              IF SO, EXIT (VALID TERM)             55800000
         CH    R5,IEE36H06         SEE IF LENGTH IS 6                   56000000
         BNE   IEE36130            IF NOT, CHECK FOR COMPOS CON         56200002
         CLC   K1(K2,R6),IEE36OUT  SEE IF OUTPUT-ONLY CONSOLE           56800000
         BR    R11                 EXIT (VALID OR INVALID TERM)         57000000
IEE36130 CH    R5,IEE36H14         SEE IF LENGTH OF TERM IS 14          57200000
         BCR   BNE,R11             IF NOT, EXIT (INVALID TERM)          57400000
         CLC   K1(K3,R6),IEE36CIN  SEE IF BEGIN WITH C'(I-'             57600000
         BCR   BNE,R11             IF NOT, EXIT (INVALID TERM)          57800000
         CLC   K7(K3,R6),IEE36COU  SEE IF 6TH ON ARE C',O-'             58000000
         BCR   BNE,R11             IF NOT, EXIT (INVALID TERM)          58200000
         CLI   K13(R6),X5D         SEE IF LAST CHAR IS C')'             58400000
         BR    R11                 EXIT (VALID OR INVALID TERM)         58600000
         EJECT                                                          58800000
* * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * *         59000000
*                                                             *         59200000
* ROUTINE TO LOCATE NEXT COMMA NOT WITHIN PARENTHESES         *         59400000
*   EXIT - TO IEE360D0 IF SCAN EXCEEDS LOGICAL END OF BUFFER  *         59600000
*        - TO IEE360D0 IF MORE THAN 2 LEVELS OF PARENTHESES   *         59800000
*        - TO K0(R14) IF COMMA NOT WITHIN PARENTHESES LOCATED *         60000000
*        - TO K0(R14) IF UNPAIRED PARENTHESES ENCOUNTERED     *         60200000
*                                                             *         60400000
* * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * *         60600000
         SPACE 1                                                        60800000
IEE36140 STM   R9,R11,K8(R8)      SAVE WORK REGISTER CONTENTS    Y02669 61000002
         SR    R9,R9               ZERO PARENTHESES COUNTER             61200000
         LA    R10,K1              INITIALIZE BXLE INCREMENT            61400000
         LA    R11,K0(R4,R6)       INITIALIZE BXLE COMPARAND            61600000
         LR    R5,R6               INITIALIZE OPERANDS INDEX            61800000
IEE36150 CLI   K1(R5),X4D          SEE IF NEXT CHAR IS C'('             62000000
         BE    IEE36170            IF SO, ADD 1 TO PAREN COUNTR         62200000
         CLI   K1(R5),X5D          IF NOT, SEE IF IT IS C')'            62400000
         BE    IEE36180            IF SO, DECREM PAREN COUNTER          62600000
         CLI   K1(R5),X6B          SEE IF IT IS A COMMA                 62800000
         BNE   IEE36160            IF NOT, KEEP SEARCHING               63000000
         LTR   R9,R9               SEE IF COMMA IS WITHIN ( )'S         63200000
         BZ    IEE36190            IF NOT, EXIT-END OF TERM FND         63400000
IEE36160 BXLE  R5,R10,IEE36150     LOOP TO CHECK NEXT CHARACTER         63600000
         B     IEE360D0            NORMAL EXIT IF END OF BUFFER         63800000
IEE36170 CR    R9,R10              SEE IF MORE THAN 2 LEVELS ()         64000000
         BH    IEE360D0            IF SO, TAKE A NORMAL EXIT            64200000
         BXLE  R9,R10,IEE36160     IF NOT, INC PAREN COUNT,LOOP         64400000
IEE36180 SR    R9,R10              DECREMENT PAREN COUNTER              64600000
         BNM   IEE36160            LOOP IF ()'S ARE PAIRED              64800000
IEE36190 SLR   R5,R6               CALCULATE LENGTH OF TERM             65000000
         ALR   R5,R10                  UPDATE LENGTH BY ONE             65200000
         LM    R9,R11,K8(R8)       RESTORE THE WORK REGISTERS    Y02669 65400002
         BR    R14                 RETURN WITH LGTH IN REG R5           65600000
         EJECT                                                          65800000
* * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * *         66100002
*                                                             *         66400002
*  ROUTINE TO VALIDATE GOOD PATHS FOR DDD AT DISPL K1(R7)     *         66700002
*                                                             *         67000002
* * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * *         67300002
IEE361A0 EQU   *                                                 Y02669 67850002
         STM   R0,R6,K8(R8)                                      Y02669 67900002
         MVC   IOSAREA+K5(K3),K1(R7) MOVE UNIT INTO WORK AREA  @YM3411P 68060002
         LA    R3,K9               ESTABLISH ADDER OF 9        @YM3411P 68060902
         LA    R5,K3               ESTABLISH BYTE COUNTER      @YM3411P 68061502
TRILOOP  LA    R6,IOSAREA+K4(R5)   GET CURRENT BYTE ADDRESS    @YM3411P 68062102
         TM    K0(R6),XF0          IS IT NUMERIC?              @YM3411P 68062702
         BO    AROUND              YES, BRANCH                 @YM3411P 68063302
         CLI   K0(R6),XC1          NO, IS IT BELOW 'A'?        @YM3411P 68063902
         BL    UNITMSG             YES, ERROR EXIT             @YM3411P 68064502
         CLI   K0(R6),XC6          NO, IS IT ABOVE 'F'?        @YM3411P 68065402
         BH    UNITMSG             YES, ERROR EXIT             @YM3411P 68067202
         IC    R4,K0(R6)           NO, PREPARE FOR ADDITION    @YM3411P 68068202
         AR    R4,R3               CHANGE NUMBER TO ALPHA      @YM3411P 68070002
         STC   R4,IOSAREA+K4(R5)   STORE BACK INTO WORKAREA    @YM3411P 68072002
AROUND   BCT   R5,TRILOOP          THREE BYTES DONE?           @YM3411P 68074002
         PACK  IOSAREA(K4),IOSAREA+K5(K3) YES, TAKE OUT ZONES  @YM3411P 68076002
         L     R6,IOSAREA          PREPARE FOR IOSGEN MACRO    @YM3411P 68078002
         SRL   R6,K4               SHIFT OUT SIGN BIT          @YM3411P 68080002
         LR    R9,R13              SAVE SAVE AREA POINTER      @YM3411P 68110002
         LR    R1,R7               SAVE BUFFER POINTER         @YM3411P 68140002
         LA    R13,IOSAREA         POINTER TO IOSGEN SAVE AREA @YM3411P 68170002
         IOSGEN UCBLOOK            SCAN FOR SPECIFIED UCB      @YM3411P 68200002
         LR    R13,R9              RESTORE SAVE AREA POINTER   @YM3411P 68250002
         LR    R9,R7               PUT UCB ADDRESS INTO R9     @YM3411P 68260002
         LR    R7,R1               RESTORE BUFFER POINTER      @YM3411P 68270002
         LTR   R15,R15             RETURN CODE 0?              @YM3411P 68300002
         BNZ   UNITMSG             NO, ISSUE ERROR MESSAGE     @YM3411P 68350002
         USING OUCB,R9             YES, ESTABLISH UCB BASE     @YM3411P 68450002
         TM    UCBWGT,UCBMTPXP     SUB-UCB'S EXIST?            @YM3411P 68550002
         BNO   GOODUCB             NO, BRANCH                  @YM3411P 68650002
         L     R1,UCBBASE          YES, GET MASTER UCB ADDRESS @YM3411P 68750002
         LA    R1,D512(R1)         GET POINTER TO BASE UCB     @YM3411P 68850002
         CR    R9,R1               DOES UCB ADDRESSES MATCH?   @YM3411P 68900002
         BNE   UNITMSG             NO, ISSUE ERROR MESSAGE     @YM3411P 68950002
GOODUCB  EQU   *                   YES, PROCEED WITH EXECUTION @YM3411P 69050002
************************************************************** @Z30LPTJ 69060003
*                                                            * @Z30LPTJ 69070003
* IF VARY RANGE IS PRESENT, INCREMENT GOOD UNIT COUNTER FOR  * @Z30LPTJ 69080003
* THE DISPLAY UNIT COMMAND WHICH WILL BE ISSUED AT THE END   * @Z30LPTJ 69090003
* OF THE VARY RANGE PROCESS.  IF THE UCB INDICATES THAT THIS * @Z30LPTJ 69100003
* IS AN ALTERNATE PATH, OR IS A DEVICE WITHOUT AN UCB DEVICE * @Z30LPTJ 69102003
* NAME, THE COUNT IS NOT INCREMENTED.  INSTEAD A BIT IS      * @Z30LPTJ 69103003
* MARKED AND AIDS IN THE OUTPUT FROM IEECB904.               * @Z30LPTJ 69104003
*                                                            * @Z30LPTJ 69110003
************************************************************** @Z30LPTJ 69120003
         TM    XAAVRANG,XAARNG1    VARY RANGE BEING PROCESSED? @Z30LPTJ 69130003
         BNO   GOODUCB1            NO, PROCEED NORMALLY        @Z30LPTJ 69200003
         CLC   UCBNAME(K3),K1(R7)  DOES UCB NAMES MATCH?       @Z30LPTJ 69220003
         BNE   ALTMARK             NO, DO NOT INCLUDE IN COUNT @Z30LPTJ 69240003
         SR    R1,R1               PREPARE FOR NEXT INSTRUCTION@Z30LPTJ 69247003
         C     R1,UCBTYP           DEVICE TYPE INFO. PRESENT?  @Z30LPTJ 69254003
         BE    ALTMARK             NO, DO NOT INCLUDE IN COUNT @Z30LPTJ 69261003
         L     R1,XAL              GET VARY RANGE BUFFER @     @Z30LPTJ 69270003
         LH    R6,K130(R1)         GET VALID UNIT COUNTER      @Z30LPTJ 69340003
         LA    R6,K1(R6)           INCREMENT IT BY ONE         @Z30LPTJ 69410003
         STH   R6,K130(R1)         STORE THE COUNTER           @Z30LPTJ 69480003
         B     GOODUCB1            AVOID BIT SETTING           @Z30LPTJ 69490003
ALTMARK  EQU   *                                               @Z30LPTJ 69500003
         OI    XAAVRANG,XAARNG5    INDICATE A NON-COUNTED      @Z30LPTJ*69510003
                                    DEVICE                     @Z30LPTJ 69530003
GOODUCB1 EQU   *                                               @Z30LPTJ 69550003
         CLI   UCBTBYT3,UCB3UREC   TEST FIRST BYTE FOR DSM     @Z30LPTJ 69560003
         BNE   GOODUCB2            DATA STAGING MANAGER NOT UP @Z30LPTJ 69570003
         CLI   UCBTBYT4,UCBDSM     TEST SECOND BYTE FOR DSM    @Z30LPTJ 69580003
         BE    SS1MSG              IT IS A DSM, PUT OUT MSG.   @Z30LPTJ 69590003
GOODUCB2 EQU   *                                               @Z30LPTJ 69600003
         TM    UCBSTAT,UCBONLI     IF DEV IS ONLINE, THEN THERE  Y02669 69650002
         BO    IEE36200            IS NOT REASON TO CHECK PATHS  Y02669 69700002
         TM    XAAVRANG,XAARNG1    VARY RANGE BEING PROCESSED? @Z30LPTJ 69750003
         BNO   CHKPATH             NO, PROCEED NORMALLY        @Z30LPTJ 69800003
         TM    XAAVRANG,XAARNG4    OFFLINE BEING PROCESSED?    @Z30LPTJ 69850003
         BNO   IEE36200            YES, AVOID CHECKING PATHS   @Z30LPTJ 69900003
CHKPATH  EQU   *                                               @Z30LPTJ 69950003
         L     R1,XAD             PTR TO CORE FOR VDEV           Y02669 70050002
         LTR   R1,R1              CORE GOTTEN BEFORE?            Y02669 70100002
         BNZ   GOTBEFOR           WE ALREADY HAVE IT             Y02669 70150002
         GETMAIN R,LV=308       CORE FOR IEEVDEV SUBROUTINE     YM01603 70250002
         ST    R1,XAD             STORE FOR FUTURE USE           Y02669 70260002
         TM    XAAVRANG,XAARNG1   VARY RANGE BEING PROCESSED?  @Z30LPTJ 70262003
         BNO   GOTBEFOR           NO, AVOID SAVING XAD         @Z30LPTJ 70264003
         L     R5,XAL             GET VARY RANGE BUFFER        @Z30LPTJ 70266003
         ST    R1,K136(R5)        SAVE XAD INTO BUFFER SLOT    @Z30LPTJ 70268003
GOTBEFOR EQU   *                                                 Y02669 70270002
         ST    R14,TWELV(R1)      STORE RETURN ADDRESS           Y02669 70300002
         ST    R13,SIXTEEN(R1)    SAVE 3603D'S SAVE AREA PTR    YM01603 70310002
         LA    R14,FOR(R1)        GET ADDR OF PARAM LST ITSELF   Y02669 70350002
         ST    R14,ZERO(R1)       STORE ADDR IN PARAMLIST PTR    Y02669 70360002
         XC    FOR(EIT,R1),FOR(R1)                               Y02669 70370002
*  BYTE ONE OF THE SECND WORD OF THE PARAMLIST HAS A X'00'       Y02669 70380002
*  THIS IS A FUNCTION CODE = VARY ONLINE AND CONSOLE             Y02669 70390002
*  PROCESSING                                                    Y02669 70392002
         ST    R9,FOR(R1)         UCB PTR INTO WORD 1            Y02669 70394002
         LA    R13,TWENTY(R1)   INIT R13 TO IEEVDEV'S SAVE AREA YM01603 70394102
         L     R15,XAP            XAP IS 0 IF NO LOAD FOR VDEV   Y02669 70394402
*                                 WAS EVER DONE BEFORE,OR IT WILLY02669 70394602
         LTR   R15,R15            HAVE THE ADDR IF LOAD DONE     Y02669 70394802
         BNZ   EXTVDEV                                           Y02669 70395202
*                                 FOUND ADDR OF VDEV, NO LOAD    Y02669 70395602
         LR    R6,R1              SAVE PTR TO PARAM IN REG6(TEMP)Y02669 70396002
         LOAD  EP=IEEVDEV                                        Y02669 70398002
         LR    R1,R6              RESTORE PARAM LIST PTR         Y02669 70398402
         LR    R15,R0             SUBROUTINE'S ADDRES INTO R15   Y02669 70398802
         ST    R15,XAP            STORE FOR FUTURE USE           Y02669 70398902
         TM    XAAVRANG,XAARNG1   VARY RANGE BEING PROCESSED?  @Z30LPTJ 70399003
         BNO   EXTVDEV            NO, AVOID SAVING XAP         @Z30LPTJ 70404003
         L     R5,XAL             GET VARY RANGE BUFFER        @Z30LPTJ 70409003
         ST    R15,K140(R5)       SAVE XAP INTO BUFFER SLOT    @Z30LPTJ 70414003
EXTVDEV  EQU   *                                                 Y02669 70419003
         BALR  R14,R15            GO TO SUBROUTINE TO CHECK      Y02669 70424003
*                                 PATH TO THIS DEVICE            Y02669 70429003
         LR    R6,R15             SAVE RETURN CODE FROM SUBRTN   Y02669 70434003
         L     R14,TWELV(R1)      RESTORE CALLERS ADDRESS        Y02669 70439003
         L     R13,SIXTEEN(R1) REINIT R13 TO PTR TO 3603D'S SAVEYM01603 70449802
         SR    R15,R15                                           Y02669 70471902
         LTR   R6,R6              IS PATH TO DEVICE AVAILABLE    Y02669 70479902
         BZ    IEE36200           YES, ALL IS OK FOR THIS DEV.   Y02669 70489902
         MVC   IEE36MSG(LENG),IEE36INT INITIALIZE MSG BUFFER   @YM3411P 70490102
         LA    R15,K4             CHECK FOR RETCODE OR 4         Y02669 70490302
         CR    R6,R15             IS IT RETCODE OF 4?            Y02669 70490702
         BE    NOPATHB            YES, NO LOGICAL PATH         @YM3369P 70491102
         LA    R15,K12            CHECK RETCODE OR 12            Y02669 70491502
         CR    R6,R15             IS IT 12? NO PATH AGAIN.       Y02669 70491602
         BE    NOPATHA            YES, NO PHYSICAL PATH        @YM3369P 70491702
         LA    R15,K8             CHECK RETCODE OR 8             Y02669 70491802
         CR    R6,R15             IS IT 8? INSUF CORE?           Y02669 70541802
         BE    INSUFCOR           YES, ABORT COMMAND             Y02669 70551802
         L     R1,XAD             DEVICE IS IN USE BY SYSTEM   @YM07231*70571802
                                   COMPONENT                   @YM07231 70576802
*                                 GET CORE PTR TO MSG            Y02669 70581802
         LA    R1,TWENTY(R1)      INDEX TO MSG BUFFER            Y02669 70583802
         MVC   K0(COMPLN,R1),COMPMSG MOVE MESSAGE              @YM07231 70585802
         MVC   K12(K3,R1),K1(R7)  MOVE IN UNIT NAME              Y02669 70587802
         B     MESSG              GO ISSUE MSG                   Y02669 70589802
INSUFCOR EQU   *                  INSUFF CORE FOR PROCC          Y02669 70590202
         LA    R1,INSUFMSG        GET PTR TO MSG                 Y02669 70590602
         SR    R0,R0              CLEAR R0 FOR CONSOLE ID        Y02669 70591002
         TM    XAU,RI             IS THIS FROM INPUT STREAM?   @ZM30445 70591103
         BO    XAUIN2             YES, DON'T INSERT CONSOLE ID @ZM30445 70591203
         IC    R0,XAU                                            Y02669 70591402
XAUIN2   EQU   *                                               @ZM30445 70591503
         WTO   MF=(E,(1))         ISSUE MSG                      Y02669 70595503
         B     IEE36050           RETURN EXIT, ABORT COMMAND     Y02669 70599503
*                                                                Y02669 70603503
*                                                                Y02669 70608402
NOPATHA  EQU   *                                               @YM3369P 70611402
         MVC   IEE36FIL(K8),IEEPHYS    MOVE IN 'PHYSICAL'      @YM3369P 70614402
         B     NOPATH             AVOID NEXT INSTRUCTION       @YM3369P 70616402
NOPATHB  EQU   *                                               @YM3369P 70618402
         MVC   IEE36FIL(K8),IEELOGIC   MOVE IN 'LOGICAL '      @YM3369P 70620402
NOPATH   EQU   *                  NOPATHS MSG RTN                Y02669 70622402
         MVC   IEE36BUF(K3),K1(R7)     MOVE BAD UNIT INTO MSG    Y02669 70625102
*                                 BUFFER                         Y02669 70641802
ADDRMSG  EQU   *                                               @YM3411P 70681802
         LA    R1,IEE36MSG        GET ADDR OF MESSAGE FOR WTO    Y02669 70691802
MESSG    EQU   *                                                 Y02669 70701802
         SR    R0,R0              CLEAR R0 FOR CONS. ID          Y02669 70711802
         TM    XAU,RI             IS THIS FROM INPUT STREAM?   @ZM30445 70714803
         BO    XAUIN3             YES, DON'T INSERT CONSOLE ID @ZM30445 70717803
         IC    R0,XAU                                            Y02669 70721802
XAUIN3   EQU   *                                               @ZM30445 70731803
         WTO   MF=(E,(1))         WRITE NO PATHS MESSAGE         Y02669 70741802
NOUNIT   EQU   *                                               @Z30LPTJ 72741803
         LA    R15,K4             INDICATE NO PATH UNIT          Y02669 75650002
         SPACE 1                                                        75800000
IEE36200 LM    R0,R6,K8(R8)       RESTORE REGISTER CONTENTS      Y02669 76000002
         BR    R11                 RETURN TO CALLER                     76200000
UNITMSG  EQU   *                                               @YM3411P 76240002
         TM    XAAVRANG,XAARNG1   VARY RANGE BEING PROCESSED?  @Z30LPTJ 76248003
         BO    NOUNIT             YES, SKIP MESSAGE OUTPUT     @Z30LPTJ 76264003
         MVC   IEE36MSG(REFLNG),REFMSG  LOAD IEE313I MSG       @YM3411P 76280002
MOVEUNIT EQU   *                                               @Z30LPTJ 76300003
         MVC   IEE36DEV(K3),K1(R7)  MOVE BAD UNIT INTO MSG     @YM3411P 76320002
         B     ADDRMSG                                         @YM3411P 76360002
         SPACE                                                          76368003
SS1MSG   EQU   *                                               @Z30LPTJ 76376003
         MVC   IEE36MSG(SS1LENG),SS1TEXT LOAD IEE084I MESSAGE  @Z30LPTJ 76384003
         B     MOVEUNIT            BRANCH TO LOAD UNIT VALUE   @Z30LPTJ 76392003
         EJECT                                                          76400002
* * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * *  Y02651 76410002
*                                                                Y02651 76412002
*  THE LIST FORM OF THE ENQ AND DEQ INSTRUCTION ISSUED IN THIS   Y02651 76414002
*  MODULE FOLLOW:                                                Y02651 76416002
*                                                                Y02651 76418002
IEFSCONA ENQ   (IEFSQCBS,IEFVQCBS,S,K7,SYSTEM),MF=L            @YM5443P 76418202
ENQBEGIN EQU *                                                 @ZA09166 76419203
IEFSCONB ENQ   (IEFSQCBS,IEFQ4QCB,E,K2,SYSTEM),MF=L,ECB=ZERO   @YM5443P 76421202
ENQEND   EQU   *                                               @YM5443P 76424202
ENQLNTH  EQU   ENQEND-ENQBEGIN                                 @ZA09166 76427203
IEFSCONC DEQ   (IEFSQCBS,IEFQ4QCB,K2,SYSTEM),RET=HAVE,MF=L     @YM5443P 76431402
IEFSCOND ENQ   (IEFSQCBS,IEFQ4QCB,E,K2,SYSTEM),MF=L            @YM5443P 76434502
IEFSOFFA ENQ   (IEFSQCBS,IEFVQCBS,E,K7,SYSTEM),MF=L            @YM5443P 76435502
IEFSOFFB ENQ   (IEFSQCBS,IEFQ4QCB,S,K2,SYSTEM),MF=L            @YM5443P 76515502
IEFSDONA ENQ   (IEFSQCBS,IEFVQCBS,E,K7,SYSTEM),MF=L            @YM5443P 76595502
IEFSDONB ENQ   (IEFSQCBS,IEFQ4QCB,S,K2,SYSTEM),MF=L            @YM5443P 76675502
IEFDEQUE DEQ   (IEFSQCBS,IEFQ4QCB,K2,SYSTEM,IEFSQCBS,IEFVQCBS,K7,      *76755502
               SYSTEM),RET=HAVE,MF=L                           @YM5443P 76845502
IEFSQCBS DC    C'SYSIEFSD'                                       Y02651 76937602
IEFQ4QCB DC    C'Q4'                                             Y02651 77037602
IEFVQCBS DC    C'VARYDEV'                                      @YM5443P 77137602
*                                                                Y02651 77237602
* * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * *  Y02651 77337602
         EJECT                                                          77437602
* * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * *         77600000
*                                                             *         77800000
* CONSTANTS SECTION (READ-ONLY)                               *         78000000
*                                                             *         78200000
* * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * *         78400000
         SPACE 1                                                        78600000
IEE36GMP DS    0F                  GETMAIN/FREEMAIN LV PARAM            78800000
         DC    X'E5'               SUBPOOL 229 INDICATOR                79000002
         DC    AL3(GETLEN)         LGTH OF GETMAIN'ED WORK AREA         79200002
WORKAREA DC    X'E5000020'         DATA AREA CORE SPECIFICATION@Z30LPTJ 79300003
*              NOTE: IF THE SIZE OF 'WORKAREA' IS CHANGED IN   @Z30LPTJ 79320003
*                    IEECB904, SUCH CHANGE MUST ALSO BE MADE   @Z30LPTJ 79340003
*                    TO 'WORKAREA' HERE.                       @Z30LPTJ 79360003
IEE36CIN DC    C'(I-'              MASK FOR COMPOSITE I-UNIT            79400000
IEE36END DC    C')'                MASK FOR END OF OPR SUBLIST          79600000
IEE36COU DC    C','                MASK FOR COMPOSITE O-UNIT            79800000
IEE36OUT DC    C'O-'               MASK FOR OUTPUT-ONLY CONSOLE         80000000
IEE3303D DC    C'IEE3303D'                                       Y02669 80800002
IEEPHYS  DC    C'PHYSICAL'         'PHYSICAL' INSERTION        @YM3369P 80900002
IEELOGIC DC    C'LOGICAL '         'LOGICAL ' INSERTION        @YM3369P 80950002
IEE36H04 DC    H'04'               TO COMPARE FOR TERM LENGTH 4         81000000
IEE36H06 DC    H'06'               TO COMPARE FOR TERM LENGTH 6         81200000
IEE36H14 DC    H'14'               TO COMPARE FOR TERM LGTH 14          81400000
IEE36INT WTO   'IEE025I UNIT DDD HAS NO LOGICAL  PATHS',MF=L,DESC=(5), *81600002
               MCSFLAG=(REG0,RESP) NO PATHS MESSAGE FOR VARY   @YM3369P 81800002
LENG     EQU   *-IEE36INT                                               82000002
COMPMSG  WTO   'IEE329I     IN USE BY A SYSTEM COMPONENT',             *82020002
               MF=L,DESC=(5),MCSFLAG=(REG0,RESP)               @YM07231 82027002
COMPLN   EQU   *-COMPMSG                                       @YM07231 82034002
INSUFMSG WTO   'IEE328I VARY     COMMAND ABORTED',MF=L,DESC=(5),       *82046003
               MCSFLAG=(REG0,RESP)                             @ZM30436 82046903
REFMSG   WTO   'IEE313I DDD      UNIT REF INVALID',MF=L,DESC=(5),      *82047803
               MCSFLAG=(REG0,RESP)                             @ZM30436 82048703
REFLNG   EQU   *-REFMSG                                        @YM3411P 82049602
TERMMSG  WTO   'IEE308I VARY     TERM LENGTH ERROR',MF=L,DESC=(5),     *82049703
               MCSFLAG=(REG0,RESP)                             @Z30LPTJ 82049803
TERMLNG  EQU   *-TERMMSG                                       @Z30LPTJ 82055903
DELIMMSG WTO   'IEE307I VARY     DELIMITER ERROR',MF=L,DESC=(5),       *82060003
               MCSFLAG=(REG0,RESP)                             @Z30LPTJ 82062003
DELIMLNG EQU   *-DELIMMSG                                      @Z30LPTJ 82064003
CONFMSG  WTO   'IEE312I VARY     PARAMETERS CONFLICT',MF=L,DESC=(5),   *82066003
               MCSFLAG=(REG0,RESP)                             @Z30LPTJ 82070003
CONFLNG  EQU   *-CONFMSG                                       @Z30LPTJ 82072003
SS1TEXT  WTO   'IEE084I          3851 PARAMETER MISSING',MF=L,         *82074003
               DESC=(5),MCSFLAG=(REG0,RESP)                    @Z30LPTJ 82076003
         DS    0F                                              @ZA09166 82077003
SS1LENG  EQU   *-SS1TEXT                                       @Z30LPTJ 82078003
IEE799B  EQU   *                  BEGINNING OF WTOR LIST       @ZA09166 82078403
IEE799LS WTOR  'IEE799A VARY CONSOLE DELAYED - REPLY RETRY,CANCEL,OR WA*82078603
               IT',,6,DESC=(5),MCSFLAG=(REG0,RESP),MF=L        @ZA09166 82078803
IEE799L  EQU   *-IEE799B          LENGTH OF WTOR LIST          @ZA09166 82079003
IEE756I  WTO   'IEE756I VARY COMMAND CANCELLED BY OPERATOR',   @ZA09166*82079203
               MF=L,DESC=(5),MCSFLAG=(REG0,RESP)               @ZA09166 82079403
         DS    0F                                                Y02669 82080003
VCON33   DC    V(IEE3303D)                                       Y02669 82100002
VCON904  DC    V(IEECB904)                                     @Z30LPTJ 82120003
LVARY    DC    X'04E5C1D9E8'                                     Y02653 82150002
VARY     DC    CL8'VARY    '                                     Y02653 82160002
         DS    0H                                                Y02669 82180002
FOUR     DC    H'4'                                              Y02669 82190002
FLINE    DC    C'FLINE'                                          Y02669 82192002
NLINE    DC    C'NLINE'                                                 82192502
ONLINE   DC    C'ONLINE'                                       @Z30LPTJ 82202703
OFFLINE  DC    C'OFFLINE'                                      @Z30LPTJ 82212703
CONSOLE  DC    C'CONSOLE'                                      @Z30LPTJ 82222703
BLANKS   DC    CL6'      '        BLANKS TO CAPITALIZE REPLY   @ZA09166 82224703
CANCEL   DC    C'CANCEL'          REPLY OF CANCEL              @ZA09166 82226703
RETRY    DC    C'RETRY'           REPLY OF RETRY               @ZA09166 82228703
WAIT     DC    C'WAIT'            REPLY OF WAIT                @ZA09166 82230703
         DS    0D                                                       82233003
TIMELOC  DC    C'00000500'                                              82253003
         SPACE 3                                                        82273003
PATCH    DC    CL120'***IEE3603D***'                           @Z30LPTJ 82293003
         EJECT                                                          82313003
* * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * *         82400000
*                                                             *         82600000
* DSECT TO REFERENCE GETMAIN'ED WORK/SAVE AREA                *         82800000
*                                                             *         83000000
* * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * *         83200000
         SPACE 1                                                        83400000
IEE36WRK DSECT                                                          83600000
         DS    18F                 REGISTER SAVE AREA                   83800000
IEE36S14 DS    F                   WORD TO SAVE REGISTER 14             84000000
         DS    F                   WORD TO SAVE REGISTER 15             84200000
         DS    F                   WORD TO SAVE REGISTER 0              84400000
         DS    F                   WORD TO SAVE REGISTER 1              84600000
IEE36MSG DS    CL(LENG)            BUFFER TO BUILD NO PATHS MSG         84800002
IEE36DEV EQU   IEE36MSG+K12        LOC OF UNIT IN UNIT REF MSG @YM3411P 84850002
IEE36BUF EQU   IEE36MSG+K17        LOC OF UNIT IN NO PATHS MSG          84900002
IEE36FIL EQU   IEE36MSG+K28        LOCATION OF FILLER IN NO    @YM3369P 84970002
*                                       PATHS MESSAGE          @YM3369P 85050002
IOSAREA  DS    16F                 IOSGEN SAVE AREA            @YM3411P 85070002
ECBAREA  DS    F                   ECB POST AREA               @YM5443P 85100002
ENQMVC   EQU   *                   ENQ LIST AREA               @YM5443P 85150002
OFFSET   ENQ   (,,E,K2,SYSTEM),ECB=ZERO,MF=L ENQ LIST          @ZA09166 85152003
RPYAREA  DS    CL6                REPLY BUFFER                 @ZA09166 85153003
         DS    0F                                              @ZA09166 85156003
IEE799D  EQU   *                  AREA FOR WTOR LIST FOR       @ZA09166 85158003
IEE799   WTOR  'IEE799A VARY CONSOLE DELAYED - REPLY RETRY,CANCEL,OR WA*85166003
               IT',,6,DESC=(5),MCSFLAG=(REG0,RESP),MF=L        @ZA09166 85174003
         DS    0D                  END OF GETMAIN'ED WORK AREA          85200000
GETLEN   EQU   *-IEE36WRK          LGTH OF GETMAIN'ED WORK AREA@Z30LPTJ 85400003
*              NOTE: IF THE SIZE OF THIS 'GETLEN' IS           @Z30LPTJ 85450003
*                    CHANGED, SUCH CHANGE MUST ALSO BE MADE    @Z30LPTJ 85500003
*                    AT THE 'SPSIZEA' LABEL IN IEECB904.       @Z30LPTJ 85550003
         EJECT                                                          85600000
IEE36XSA DSECT                                                          85800000
         IEEXSA                                                         86000000
         EJECT                                                          86650002
         CVT   DSECT=YES                                                86651002
         EJECT                                                          86652002
         IECDIOCM                                                       86653002
         EJECT                                                          86654002
         IECDIOCX                                                       86655002
         EJECT                                                          86656002
CHAIN1   DSECT                                                          86660002
         IEECHAIN                                                       86700002
         SPACE 1                                                        86800000
        EJECT                                                           86850002
OUCB    DSECT                                                           86900002
        IEFUCBOB                                                        86950002
         END                                                            87000000
./  ADD  SSI=61350389,NAME=IEE3703D
         TITLE 'IEE3703D--VS2 CANCEL/FORCE COMMAND'                     00050041
*********************************************************************** 00400018
*                                                                     * 00800018
*  MODULE NAME =  IEE3703D                                       Y02669 00850002
*                                                                     * 01600018
*  DESCRIPTIVE NAME =  CANCEL/FORCE COMMAND HANDLER            @G17FPSS 01620041
*                                                                     * 02400018
*                                                                     * 02450041
*  STATUS =  OS/VS2 - SERVICE DATA IMPROVEMENTS                @G17FPSS 02470041
*                                                                     * 04000018
*  FUNCTION =  CANCEL/FORCE BOTH FOREGROUND AND BACKGROUND     @G17FPSS 04000141
*              JOBS IN EXECUTION                               @G17FPSS 04000241
*     OPERATION =                                                Y02669 04000602
*        0.  IF THE COMMAND WAS FORCE THEN CHECK TO SEE IF IT  @ZD00106 04000741
*            WAS ISSUED ON THE MASTER CONSOLE. IF NOT THEN A   @ZD00106 04000841
*            BRANCH IS MADE TO MODULE IEE0503D TO ISSUE        @ZD00106 04000941
*            MESSAGE IEE345I.                                  @ZD00106 04001041
*                                                                       04001441
*        1.  OPERAND SYNTAX IS CHECKED.  VALID SYNTAX IS:        Y02669 04002041
*                CANCEL                FORCE                   @G17FPSS 04002341
*             A) NAME               E) NAME                    @G17FPSS 04002441
*             B) NAME,DUMP          F) U=NAME                  @G17FPSS 04002641
*             C) U=NAME                                                 04002741
*             D) U=NAME,DUMP                                            04002841
*            WHERE NAME IN A,B AND E MAY BE THE NAME OF A      @G17FPSS 04003041
*            BACKGROUND JOB OR A DEVICE ID (CANCEL/FORCE       @G17FPSS 04003141
*            IS INDIFFERENT TO THE EXTERNAL SIGNIFICANCE OF THE  Y02669 04003241
*            NAME). NAME IN C,D AND F IS THE USERID OF A TIME  @G17FPSS 04003341
*            SHARING USER.  IN ALL CASES, THE FINAL DELIMITER    Y02669 04003441
*            MUST BE A BLANK OR END OF BUFFER, THE INTERMEDIATE  Y02669 04003541
*            DELIMITER, A COMMA.                                 Y02669 04003641
*                                                                       04003741
*            IF THE SYNTAX IS INVALID, CONTROL PASSES TO THE     Y02669 04003841
*            MESSAGE MODULE TO ISSUE THE MESSAGE INDICATED AT    Y02669 04003941
*            THE ERROR EXIT.                                     Y02669 04004041
*                                                                       04004141
*        2.  ENQ SHARE ON THE CSCB CHAIN RESOURCE AND SEARCH THE Y02651 04004202
*            CHAIN FOR A CSCB WITH NAME IN THE CHKEY OR CHUNIT   Y02669 04004402
*            FIELDS MATCHING THE NAME IN THE OPERAND FIELD OF THEY02669 04004602
*            COMMAND.  IF NONE IS FOUND, CONTROL IS PASSED TO    Y02669 04004802
*            THE MESSAGE MODULE TO ISSUE THE MESSAGE INDICATED   Y02669 04005002
*            AT THE EXIT.                                        Y02669 04005202
*                                                                       04005402
*        3.  IF A CSCB IS FOUND, WITH THE ASSIGNMENT PENDING     Y02669 04005602
*            BIT (CHAP) OFF, THE TYPE IS CHECKED AGAINST THE     Y02669 04005802
*            TYPE SPECIFIED IN THE COMMAND:  FOREGROUND OR       Y02669 04006002
*            BACKGROUND.  IF CHAP IS ON, OR THE TYPES DO NOT     Y02669 04006202
*            MATCH, THE SCAN CONTINUES.                          Y02669 04006402
*                                                                       04006602
*        4.  IF THE TYPES MATCH AND FORCE WAS THE COMMAND THEN @G17FPSS 04006741
*            A TEST IS MADE TO SEE IF A CANCEL COMMAND WAS     @G17FPSS 04006841
*            ISSUED FOR THE JOB OR TSO USER(IF BIT CHAFORCE IS @G17FPSS 04007241
*            ON IN THE CSCB).  IF NOT THEN CONTROL IS PASSED   @G17FPSS 04007341
*            TO THE MESSAGE MODULE TO ISSUE MESSAGE IEE838I.   @G17FPSS 04007441
*            IF CANCEL WAS ISSUED BEFORE THE FORCE             @G17FPSS 04008441
*            THEN A CALLRTM TYPE=MEMTERM IS ISSUED WITH THE    @G17FPSS 04009541
*            JOBS ASID GOTTEN FROM THE CSCB. A COMPLETION CODE @G17FPSS 04010541
*            OF X'A22' IS PASSED TO CALLRTM. CONTROL IS THEN   @G17FPSS 04013541
*            GIVEN TO STEP 6.                                  @G17FPSS 04016541
*                                                                       04025341
*        5.  A CANCEL COMMAND WAS ISSUED.                      @G17FPSS 04026341
*            IF THE TYPES MATCH, AND FOREGROUND WAS SPECIFIED    Y02669 04026641
*            (BIT CHTSID IN BYTE CHTRKID IS ON AND U=NAME        Y02669 04027341
*            APPEARS ON THE COMMAND), THE BRANCH TO SIC IS TAKEN,Y02669 04028341
*            AND THE CANCEL ECB (CHCECB) IN THE CSCB IS POSTED,  Y02669 04028641
*            WITHIN SIC, WITH ONE OF THE FOLLOWING COMPLETION    Y02669 04029341
*            CODES:                                              Y02669 04029541
*                           00000122          DUMP               Y02669 04029741
*                           00000222          NO DUMP            Y02669 04029941
*            IF BACKGROUND CANCEL WAS SPECIFIED, AND BIT CHJOBID Y02669 04030141
*            IN BYTE CHTRKID IS ON, INDICATING A BACKGROUND JOB  Y02669 04030341
*            CSCB.  THE ABOVE BRANCH TO SIC IS TAKEN (SIC WILL @ZA05360 04031341
*            NOT POST THE CANCEL ECB FOR BACKGROUND JOBS)      @ZA05360 04033341
*            AND THE CANCEL ECB IS POSTED WITH ONE OF THE      @ZA05360 04035341
*            ABOVE COMPLETION CODES. BIT CHAFORCE IS TURNED ON @G17FPSS 04038341
*            TO SHOW THAT A CANCEL HAS BEEN ISSUED FOR THIS    @G17FPSS 04041341
*            JOB.                                              @G17FPSS 04051341
*                                                                       04101002
*        6.  DEQ OFF THE CSCB CHAIN RESOURCE AND PASS CONTROL TO Y02651 04111041
*            EXIT CMBRCH TO CAUSE THE MESSAGE MODULE TO INDICATE Y02669 04144002
*            ACCEPTANCE OF THE COMMAND, AFTER ISSUING SYSEVENT @YM6770P 04154002
*            BRINGIN TO SWAP IN THE CANCELLED MEMORY --        @YM6770P 04161002
*            OTHERWISE, THE MEMORY, IF SWAPPED-OUT AT THE      @YM6770P 04168002
*            TIME OF CANCEL, COULD REMAIN SWAPPED-OUT FOR      @YM6770P 04175002
*            A SUBSTANTIAL PERIOD OF TIME.                     @YM6770P 04182002
*                                                                       04193002
*        7.  IF A SATISFACTORY CSCB IS NOT FOUND, AND FOREGROUND Y02669 04203041
*            CANCEL/FORCE WAS SPECIFIED, OR IF A CSCB WAS NOT  @G17FPSS 04216041
*            FOUND FOR A BACKGROUND CANCEL/FORCE, CONTROL PASSES Y02669 04239041
*            TO EXITS NOTFORE, NOTBACK AND NONCAN TO SET UP    @G17FPSS 04262041
*            APPROPRIATE PARAMETER LISTS FOR THE MESSAGE       @G17FPSS 04312041
*            MODULE.                                           @G17FPSS 04362041
*                                                                     * 05600018
*  NOTES=  THE CSCB CHAIN ENQ ON Q10 MUST BE ISSUED BEFORE THE   Y02651 05600202
*          CHAIN SEARCH AND RETAINED UNTIL AFTER THE POST, TO    Y02651 05600402
*          ASSURE THAT A CSCB FOUND WILL REMAIN ON THE CHAIN     Y02651 05600602
*          UNTIL POSTED.                                         Y02651 05601602
*                                                                       05601741
*          SIC IS ENTERED FOR BACKGROUND JOBS TO CAUSE THE     @ZA05360 05601841
*          INITIATOR TO BE FORCED DISPATCHABLE IF THE          @ZA05360 05601941
*          RCT IS HUNG; THE XMPOST IS ISSUED IN THIS           @ZA05360 05602041
*          MODULE BECAUSE SIC HAS NO WAY TO PROPERLY           @ZA05360 05602141
*          PROCESS JOBS WITH MORE THAN ONE CSCB.  THE          @ZA05360 05602241
*          EXTERNAL WRITER (XWTR) IS AN EXAMPLE.               @ZA05360 05602341
*                                                                       05602602
*     CHARACTER CODE DEPENDENCIES =                              Y02669 05603602
*          THIS MODULE HAS BEEN CODED IN SUCH A WAY THAT IF THE  Y02669 05604602
*          EXTERNAL CHARACTER SET IS CHANGED FROM EBCDIC,        Y02669 05605602
*          REASSEMBLY WILL YIELD A VALID MODULE.                 Y02669 05606602
*                                                                       05607602
*     DEPENDENCIES =  ENQ, DEQ, SIC, CROSS MEMORY POST,          Y02669 05608602
*                     SYSEVENT, CALLRTM                        @G17FPSS 05608841
*                                                                       05609602
*     RESTRICTIONS =  THIS MODULE EXPECTS REGISTER TWO TO CON-   Y02669 05610602
*                     TAIN THE ADDRESS OF AN EXTENDED SAVE AREA. Y02669 05611602
*                     IT SAVES NO REGISTERS, BUT WILL NOT ALTER  Y02669 05612602
*                     REGISTERS 13 AND 14.                       Y02669 05613602
*                                                                       05614602
*     REGISTER CONVENTIONS =                                     Y02669 05615602
*              REGISTER 7         BUFFER SCAN POINTER            Y02669 05616602
*              REGISTER 8         CVT POINTER                    Y02657 05617002
*              REGISTER 11        CSCB POINTER                   Y02669 05617602
*              REGISTER 12        MODULE BASE                    Y02669 05618602
*              REGISTER 14        RETURN ADDRESS                 Y02669 05619602
*              REGISTER 15        ADDRESS OF SUCCESSOR MODULE    Y02669 05620602
*                                                                       05621602
*     PATCH-LABEL =  PATCH                                       Y02669 05622602
*                                                                       05623602
*  MODULE-TYPE =  CSECT                                          Y02669 05624602
*                                                                       05625602
*     PROCESSOR =  ASSEMBLER                                     Y02669 05626602
*                                                                       05627602
*     MODULE-SIZE =  N/A                                         Y02669 05628602
*                                                                       05629602
*     ATTRIBUTES =                                               Y02669 05630602
*                  PAGED LPA              REENTRANT              Y02669 05631602
*                  ZERO PSW PROTECT KEY   REUSABLE               Y02669 05632602
*                  SUPERVISOR MODE        REFRESHABLE            Y02669 05633602
*                                                                     * 06400018
*  ENTRY-POINT =  IEE3703D, FROM IEE0403D                        Y02669 06401002
*                                                                       06402002
*     PURPOSE =  CANCEL A JOB IN EXECUTION                     @G17FPSS 06402241
*                FORCE A JOB THAT WAS NOT REMOVED BY A         @G17FPSS 06402541
*                      CANCEL COMMAND.                         @G17FPSS 06402841
*                                                                       06404002
*     LINKAGE =  REGISTER TWO CONTAINS THE ADDRESS OF AN XSA,    Y02669 06405002
*                INITIALIZED AS FOLLOWS:                         Y02669 06406002
*                    XAR    POINTS TO COMMAND BUFFER                    07600002
*                    XAV    CONTAINS THE VERB IN EBCDIC                 08000002
*                    XAV    CONTAINS THE VERB CODE                      08400041
*                    XAL    POINTS TO THE COMMAND PARAMETER LIST        08401002
*                    XAU    CONTAINS THE ID OF ISSUING CONSOLE   Y02669 08401202
*                    XAA    CONTAINS ASID OF TIME-SHARING USER   Y02669 08401402
*                                                                       08402002
*     INPUT DATA =  AS DESCRIBED ABOVE                           Y02669 08403002
*                                                                       08404002
*     REGISTERS SAVED =  NONE                                    Y02669 08405002
*                                                                       08406002
*     REGISTER CONTENTS DURING PROCESSING =                      Y02669 08407002
*                        SEE REGISTER CONVENTIONS                Y02669 08408002
*                                                                       08409002
*     REGISTERS RESTORED =  NONE                                 Y02669 08410002
*                                                                       08411002
*  EXIT-NORMAL =  CMBRCH                                         Y02669 08412002
*     CONDITIONS =  THE CANCEL ECB IN THE CSCB CORRESPONDING TO  Y02669 08413002
*                   THE JOB SPECIFIED ON THE COMMAND IS POSTED.  Y02669 08414002
*                   CONTROL IS PASSED VIA BRANCH TO IEE0503D TO  Y02669 08415002
*                   ISSUE MESSAGE IEE301I.                       Y02669 08416002
*                                                                       08417002
*     OUTPUT DATA =  REGISTER TWO POINTS TO AN XSA CONTAINING:   Y02669 08418002
*                    XAE     MESSAGE INDEX X'01'                 Y02669 08419002
*                    XAV     JOBNAME                             Y02669 08421002
*                    XAU     CONSOLE ID FOR WTO                  Y02669 08421202
*                    XAA     ASID FOR TPUT                       Y02669 08422002
*                                                                       08423002
*                    CSCB FOR THIS JOB WITH CANCEL ECB (CHCECB)  Y02669 08424002
*                    POSTED AND CHCLD BIT SET ON.                Y02669 08425002
*                                                                       08426002
*     RETURN CODES =  NONE                                       Y02669 08427002
*                                                                       08447041
*  EXIT-NORMAL =  CMBRCH                                         Y02669 08467041
*     CONDITIONS =  CALLRTM TYPE=MEMTERM IS DONE. CONTROL IS   @G17FPSS 08487041
*                   PASSED VIA BRANCH TO IEE0503D TO ISSUE     @G17FPSS 08497041
*                   MESSAGE IEE301I.                           @G17FPSS 08527041
*                                                                       08547041
*     OUTPUT DATA =  REGISTER TWO POINTS TO AN XSA CONTAINING: @G17FPSS 08567041
*                    XAE     MESSAGE INDEX X'02'               @G17FPSS 08587041
*                    XAV     JOBNAME                           @G17FPSS 08607041
*                    XAU     CONSOLE ID FOR WTO                @G17FPSS 08627041
*                    XAA     ASID FOR TPUT                     @G17FPSS 08647041
*                                                                       08667041
*     RETURN CODES =  NONE                                     @G17FPSS 08687041
*                                                                     * 08800018
*  EXIT-ERROR =  NOTFORE                                         Y02669 08801002
*     CONDITIONS =  FOREGROUND CANCEL/FORCE SPECIFIED FOR A    @G17FPSS 08801541
*                   USER NOT LOGGED ON.                          Y02669 08802041
*                   CONTROL IS PASSED VIA BRANCH ON VCON TO      Y02669 08804002
*                   MESSAGE MODULE (IEE0503D) TO ISSUE MESSAGE   Y02669 08805002
*                   IEE324I.                                     Y02669 08806002
*                                                                       08807002
*     OUTPUT DATA =  REGISTER TWO CONTAINS THE ADDRESS OF AN     Y02669 08808002
*                    XSA INITIALIZED AS FOLLOWS:                 Y02669 08809002
*                    XAE     MESSAGE INDEX  X'35'                Y02669 08810002
*                    XAV     USERID (NAME FROM THE COMMAND)      Y02669 08811002
*                    XAU     CONSOLE ID FOR WTO                  Y02669 08811202
*                    XAA     ASID FOR TPUT                       Y02669 08811402
*                                                                       08812002
*     RETURN CODES =  NONE                                       Y02669 08813002
*                                                                     * 08814002
*  EXIT-ERROR =  NOTBACK                                         Y02669 08815002
*     CONDITIONS =  BACKGROUND CANCEL/FORCE SPECIFIED FOR A    @G17FPSS 08815541
*                   NAME WITH NO CORRESPONDING CSCB ON THE CHAIN.Y02669 08816041
*                   CONTROL IS PASSED VIA BRANCH ON VCON TO      Y02669 08818002
*                   MESSAGE MODULE (IEE0503D) TO ISSUE MESSAGE   Y02669 08819002
*                   IEE341I.                                     Y02669 08820002
*                                                                       08821002
*     OUTPUT DATA =  REGISTER TWO CONTAINS THE ADDRESS OF AN     Y02669 08822002
*                    XSA INITIALIZED AS FOLLOWS:                 Y02669 08823002
*                    XAE     MESSAGE INDEX  X'24'                Y02669 08824002
*                    XAV     JOBNAME (NAME FROM THE COMMAND)     Y02669 08825002
*                    XAU     CONSOLE ID FOR WTO                  Y02669 08825202
*                    XAA     ASID FOR TPUT                       Y02669 08825402
*                                                                       08826002
*     RETURN CODES =  NONE                                       Y02669 08827002
*                                                                     * 08828002
*  EXIT-ERROR =  CMERRC                                          Y02669 08843041
*     CONDITIONS =  NO OPERAND ON THE COMMAND                    Y02669 08844002
*                   CONTROL IS PASSED VIA BRANCH ON VCON TO      Y02669 08845002
*                   MESSAGE MODULE (IEE0503D) TO ISSUE MESSAGE   Y02669 08846002
*                   IEE311I.                                     Y02669 08847002
*                                                                       08848002
*     OUTPUT DATA =  REGISTER TWO CONTAINS THE ADDRESS OF AN     Y02669 08849002
*                    XSA INITIALIZED AS FOLLOWS:                 Y02669 08850002
*                    XAE     MESSAGE INDEX  X'0B'                Y02669 08851002
*                    XAV     COMMAND VERB                        Y02669 08852002
*                    XAU     CONSOLE ID FOR WTO                  Y02669 08852202
*                    XAA     ASID FOR TPUT                       Y02669 08852402
*                                                                       08853002
*     RETURN CODES =  NONE                                       Y02669 08854002
*                                                                     * 08855002
*  EXIT-ERROR =  AUTHERR                                       @ZD00106 08855141
*    CONDITIONS =  THE FORCE COMMAND WAS NOT ISSUED ON THE     @ZD00106 08855941
*                  MASTER CONSOLE. CONTROL IS PASSED VIA       @ZD00106 08856341
*                  BRANCH TO IEE0503D TO ISSUE MESSAGE         @ZD00106 08857341
*                  IEE345I.                                    @ZD00106 08858341
*                                                                       08859441
*    OUTPUT DATA = REGISTER TWO CONTAINS THE ADDRESS OF AN     @ZD00106 08859541
*                  XSA INITIALIZED AS FOLLOWS:                 @ZD00106 08860441
*                  XAE     MESSAGE INDEX X'29'                 @ZD00106 08861441
*                  XAV     JOBNAME (NAME FROM THE COMMAND)     @ZD00106 08862441
*                  XAU     CONSOLE ID FOR WTO                  @ZD00106 08863441
*                  XAA     ASID FOR TPUT                       @ZD00106 08863641
*                                                                       08863941
*    RETURN CODES =  NONE                                      @ZD00106 08864041
*                                                                     * 08864641
*  EXIT-ERROR =  CMERR8A                                         Y02669 08864741
*     CONDITIONS =  LENGTH OF AN OPERAND EXCEEDS EIGHT           Y02669 08864841
*                   CHARACTERS.                                  Y02669 08864941
*                   CONTROL IS PASSED VIA BRANCH ON VCON TO      Y02669 08865041
*                   MESSAGE MODULE (IEE0503D) TO ISSUE MESSAGE   Y02669 08865141
*                   IEE308I.                                     Y02669 08865241
*                                                                       08865341
*     OUTPUT DATA =  REGISTER TWO CONTAINS THE ADDRESS OF AN     Y02669 08865441
*                    XSA INITIALIZED AS FOLLOWS:                 Y02669 08865541
*                    XAE     MESSAGE INDEX  X'08'                Y02669 08865641
*                    XAV     COMMAND VERB                        Y02669 08865741
*                    XAU     CONSOLE ID FOR WTO                  Y02669 08865841
*                    XAA     ASID FOR TPUT                       Y02669 08865941
*                                                                       08866002
*     RETURN CODES =  NONE                                       Y02669 08867002
*                                                                     * 08868002
*  EXIT-ERROR =  CMERR8                                          Y02669 08869002
*     CONDITIONS =  LENGTH OF AN OPERAND EXCEEDS EIGHT           Y02669 08870002
*                   CHARACTERS.                                  Y02669 08871002
*                   CONTROL IS PASSED VIA BRANCH ON VCON TO      Y02669 08872002
*                   MESSAGE MODULE (IEE0503D) TO ISSUE MESSAGE   Y02669 08873002
*                   IEE308I.                                     Y02669 08874002
*                                                                       08875002
*     OUTPUT DATA =  REGISTER TWO CONTAINS THE ADDRESS OF AN     Y02669 08876002
*                    XSA INITIALIZED AS FOLLOWS:                 Y02669 08877002
*                    XAE     MESSAGE INDEX  X'08'                Y02669 08878002
*                    XAV     COMMAND VERB                        Y02669 08879002
*                    XAU     CONSOLE ID FOR WTO                  Y02669 08879202
*                    XAA     ASID FOR TPUT                       Y02669 08879402
*                                                                       08880002
*     RETURN CODES =  NONE                                       Y02669 08881002
*                                                                     * 08882002
*  EXIT-ERROR =  INVAL                                           Y02669 08883002
*     CONDITIONS =  NAME NOT SPECIFIED OR AN INVALID PARAMETER   Y02669 08884002
*                   ON THE COMMAND.                              Y02669 08885002
*                   CONTROL IS PASSED VIA BRANCH ON VCON TO      Y02669 08886002
*                   MESSAGE MODULE (IEE0503D) TO ISSUE MESSAGE   Y02669 08887002
*                   IEE305I.                                     Y02669 08888002
*                                                                       08889002
*     OUTPUT DATA =  REGISTER TWO CONTAINS THE ADDRESS OF AN     Y02669 08890002
*                    XSA INITIALIZED AS FOLLOWS:                 Y02669 08891002
*                    XAE     MESSAGE INDEX  X'05'                Y02669 08892002
*                    XAV     COMMAND VERB                        Y02669 08893002
*                    XAU     CONSOLE ID FOR WTO                  Y02669 08893202
*                    XAA     ASID FOR TPUT                       Y02669 08893402
*                                                                       08894002
*     RETURN CODES =  NONE                                       Y02669 08895002
*                                                                       08945041
*  EXIT-ERROR =  NONCAN                                        @G17FPSS 08995041
*    CONDITIONS =  CANCEL/FORCE WAS ISSUED FOR A JOB WHICH IS  @G17FPSS 09045041
*                  MARKED NON-CANCELABLE. CONTROL IS PASSED    @G17FPSS 09095041
*                  VIA BRANCH ON VCON TO MESSAGE MODULE        @G17FPSS 09145041
*                  (IEE0503D) TO ISSUE MESSAGE IEE841I.        @G17FPSS 09195041
*                                                                       09215041
*    OUTPUT DATA = REGISTER TWO CONTAINS THE ADDRESS OF AN     @G17FPSS 09245041
*                  XSA INITIALIZED AS FOLLOWS:                 @G17FPSS 09295041
*                  XAE     MESSAGE INDEX X'1C' FOR CANCEL      @G17FPSS 09345041
*                                        X'16' FOR FORCE       @G17FPSS 09395041
*                  XAV     JOBNAME (NAME FROM THE COMMAND)     @G17FPSS 09445041
*                  XAU     CONSOLE ID FOR WTO                  @G17FPSS 09495041
*                  XAA     ASID FOR TPUT                       @G17FPSS 09545041
*                                                                       09565041
*    RETURN CODES =  NONE                                      @G17FPSS 09595041
*                                                                     * 10800018
*  EXTERNAL REFERENCES =                                         Y02669 10801041
*                                                                       10802002
*     REFERENCES =  IEE0503D - MESSAGE MODULE                    Y02669 10803002
*                   SIC INTERFACE                                Y02669 10803402
*                                                                       10804002
*     DATA AREAS =  NONE                                         Y02669 10805002
*                                                                       10806002
*     CONTROL BLOCKS =  XSA, CSCB, PSA, ASVT                     Y02669 10807002
*                                                                       10808002
*     TABLES =                                                   Y02669 10809002
*                                                                       10810002
*     MACROS =  MODID, ENQ, DEQ, POST, SYSEVENT, IEEXSA,         Y02669 10811002
*               IEECHAIN, SETLOCK, IHAPSA, IHAASVT, CALLRTM    @G17FPSS 10811241
*                                                                       10812002
*     SERIALIZATION =                                            Y02651 10812102
*        ENQUEUE RESOURCES =       QNAME             RNAME       Y02651 10812202
*                                  SYSIEFSD          Q10         Y02651 10812402
*        LOCKS HELD =  CMS, LOCAL                                Y02651 10812502
*                                                                       10812602
*     CHANGE LEVEL =  Y02651, Y02657, Y02669, @YM6770P         @YM6770P 10813002
*                     ZA05360, G17FPSS, ZD00106                @ZD00106 10833041
*                                                                     * 13200018
         EJECT                                                          13200541
*  MESSAGES =                                                    Y02669 13201002
*        CODE                   TEXT                             Y02669 13202002
*        X'01'       IEE301I  (JOBNAME)  CANCEL COMMAND ACCEPTED Y02669 13203002
*        X'02'       IEE301I  (JOBNAME)  FORCE COMMAND ACCEPTED@G17FPSS 13203341
*        X'05'       IEE305I  (VERB)     COMMAND INVALID         Y02669 13204002
*        X'08'       IEE308I  (VERB)     TERM LENGTH ERROR       Y02669 13205002
*        X'0B'       IEE311I  (VERB)     PARAMETER MISSING       Y02669 13206002
*        X'16'       IEE841I  (JOBNAME)  NON-FORCIBLE          @G17FPSS 13206141
*        X'1B'       IEE838I  (JOBNAME)  CANCELABLE-ISSUE CANCEL        13206341
*                                           BEFORE FORCE       @G17FPSS 13206441
*        X'1C'       IEE841I  (JOBNAME)  NON-CANCELABLE        @G17FPSS 13206541
*        X'24'       IEE341I  (JOBNAME)  NOT ACTIVE                     13207041
*        X'29'       IEE345I  (VERB)     AUTHORITY INVALID     @ZD00106 13207241
*        X'35'       IEE324I  (USERID)   NOT LOGGED ON           Y02669 13207541
*                                                                       13210002
*        ALL MESSAGES CONTAINED IN AND ISSUED BY IEE0503D.       Y02669 13210402
*                                                                       13211002
*  COMPLETION CODE =                                                    13211341
*        A22 - PASSED TO CALLRTM WHEN FORCING AN ADDRESS SPACE @G17FPSS 13211641
*                                                                       13211841
*  SYSGEN =  THIS MODULE IS IN LOAD MODULE IGC0003D IN           Y02669 13212002
*            SYS1.LPALIB.  IT IS INCLUDED AT SYSGEN FROM DLIB    Y02669 13213002
*            AOSB3 BY SYSGEN MACRO SGIEF441.                     Y02669 13214002
*                                                                       13215002
*  SYSTEM LIBRARIES =  THIS MODULE MAKES REFERENCE TO NO SYSTEM  Y02669 13216002
*                      LIBRARIES.                                Y02669 13218002
*                                                                     * 16400018
*********************************************************************** 17600018
         EJECT                                                          17650002
**************************************************************** Y02669 17700002
*                                                                       17750002
*        REGISTER EQUATES                                        Y02669 17800002
*                                                                       17850002
**************************************************************** Y02669 17860002
         SPACE 2                                                        17900002
IEE3703D  CSECT                                                         18000018
R0       EQU   0                                                        18800018
R1       EQU   1                                                        19200018
R2       EQU   2                                                        19600018
R3       EQU   3                                                        20000018
R4       EQU   4                                                        20400018
R5       EQU   5                                                        20800018
R6       EQU   6                                                        21200018
R7       EQU   7                                                        21600018
R8       EQU   8                                                        22000018
R9       EQU   9                                                        22400018
R10      EQU   10                                                       22800018
R11      EQU   11                                                       23200018
R12      EQU   12                                                       23600018
R13      EQU   13                                                       24000018
R14      EQU   14                                                       24400018
R15      EQU   15                                                       24800018
         EJECT                                                          24850002
**************************************************************** Y02669 24900002
*                                                                       24950002
*        EQUATES FOR LENGTHS OFFSETS, AND CONSTANTS              Y02669 25000002
*                                                                       25050002
**************************************************************** Y02669 25060002
         SPACE 2                                                        25100002
D0       EQU   0                                                        25200018
D1       EQU   1                                                        25250002
D2       EQU   2                                                        25400019
D3       EQU   3                                                   I272 25600019
D4       EQU   4                                                        26000018
D5       EQU   5                                                   O102 26003002
D6       EQU   6                                                  20035 26100020
D7       EQU   7                                                  20030 26200020
D8       EQU   8                                                        26400018
D9       EQU   9                                                        26450002
FIVE     EQU   5                                                   O102 27606002
CMCOMP   EQU   X'40'              COMPLETION CODE ECB                   30800018
BLANK    EQU   C' '                                                     31200018
UNCK     EQU   X'01'              UNCHECKED PARAMETER INDICATOR   M0232 31430020
EOS      EQU   X'02'              END OF SCAN SWITCH             Y02669 31432002
BOTHALF  EQU   X'03'              MASK FOR LAST TWO BYTES        Y02669 31433002
*                                 OF REGISTER                    Y02669 31436002
DUMPSW   EQU   X'04'              DUMP SWITCH                    Y02669 31486002
NONCANSW EQU   X'10'              NON-CANCELABLE SWITCH        @G17FPSS 31489041
COMMA    EQU   C','                                                     31500018
FOX      EQU   255                                                20030 31570020
FORCE    EQU   132                FORCE CMD VERB CODE          @G17FPSS 31575041
A22      EQU   2594               COMPLETION CODE FOR FORCE    @G17FPSS 31577041
SYSISSUD EQU   X'00'              CMD ISSUED BY SYSTEM         @ZD00106 31578041
         SPACE                                                          31580002
*                                                                       31582002
*        MESSAGE CODE EQUATES                                    Y02669 31584002
*                                                                       31586002
         SPACE                                                          31588002
CMCD01   EQU   1                                                        31590002
CMCD02   EQU   2                  FORCE CMD ACCEPTED           @G17FPSS 31590541
CMCD05   EQU   5                                                   O102 31592002
CMCD08   EQU   8                                                        31594002
CMCD0B   EQU   11                                                  O102 31596002
CMCD12   EQU   12                                                  O102 31598002
CMCD17   EQU   17                                                  O102 31598402
CMCD22   EQU   22                 NON-FORCIBLE MSG CODE        @G17FPSS 31598541
CMCD27   EQU   27                 ISSUE CANCEL FOR JOB MSG     @G17FPSS 31598641
CMCD28   EQU   28                 NON-CANCELABLE MSG CODE      @G17FPSS 31599041
CMCD36   EQU   36                 NOT ACTIVE MSG CODE            Y02669 31599141
CMCD41   EQU   41                 AUTHORITY INVALID MSG CODE   @G17FPSS 31599241
CMCD53   EQU   53                 MSG CODE- NOT LOGGED ON        Y02669 31599541
         EJECT                                                          31599941
*********************************************************************** 31600018
*  ENTRY ROUTINE- THIS PORTION OF CODE ESTABLISHES ADDRESSABILITY FOR * 32000018
*        THE MODULE AND THE VARIOUS DSECTS, SET UP THE EXTENDED SAVE  * 32400018
*        AREA.                                                        * 32800018
*********************************************************************** 33200018
         BALR  R12,0              ESTABLISH ADDRESSABILITY              33600018
         USING  *,R12                                                   34000018
         MODID BRANCH=YES                                        Y01886 34050001
         USING XSA,R2             ADDR. FOR XSA                         34400020
         USING CMCVT,R8           CVT...                         Y02657 34800002
         L     R8,CVTPTR          ...ADDRESSABILITY              Y02657 35200002
         L     R10,CVTMSER        PTR TO MASTER RESIDENT CORE           35600018
         USING BASE,R10           ADDR. FOR MRC                         36000018
         L     R11,BACHN                                                36800018
         USING CMCHAIN,R11        ADDR. FOR CHAIN                       37200018
         L     R9,XAL             PTR TO COMMAND PARM LIST              37600018
         LA    R9,D0(R9)          CLEAR HIGH ORDER BYTE           M2420 37800018
         L     R7,XAR             PTR TO CIB                            38000018
         LA    R7,D0(R7)                                                38400018
         AH    R7,D0(R7)          ABSOLUTE END OF BUFFER                38800018
         ST    R7,XAP             SAVE IN 1ST WORD OF XSA               39200018
         MVI   XAX,BLANK                                                39600018
         MVC   XAX+D1(D7),XAX     BLANK OUT JOBNAME                     40000020
         MVC   XAS(D8),XAX        XAS AS WELL                           40400018
         EJECT                                                          40430041
*********************************************************************** 40460041
*                                                                     * 40490041
* IF THIS IS THE FORCE COMMAND THEN CHECK TO SEE IF IT WAS     @ZD00106 40500041
* ISSUED FROM THE MASTER CONSOLE. IF NOT THEN MODULE IEE0503D  @ZD00106 40525041
* IS CALLED TO ISSUE MESSAGE IEE345I.                          @ZD00106 40545041
*                                                                     * 40610041
* TO FIND ISSUING CONSOLE'S UCME THE FOLLOWING FORMULA IS USED @ZD00106 40620041
*    UCME ADDR = UCMVEA + UCMVEZ * (XAU - 1)                   @ZD00106 40630041
*       UCMVEA - ADDR OF FIRST UCME                            @ZD00106 40670041
*       UCMVEZ - LENGTH OF A UCME                              @ZD00106 40700041
*       XAU    - CONSOLE ID WHERE THE COMMAND WAS ISSUED       @ZD00106 40730041
*                                                                     * 40790041
*********************************************************************** 40820041
         SPACE                                                          40850041
         CLI   XAN,FORCE          WAS THIS A FORCE CMD ?       @ZD00106 40860041
         BNE   AUTHOK             NO, CONTINUE                 @ZD00106 40880041
         CLI   XAU,SYSISSUD       WAS FORCE ISSUED BY SYSTEM?  @ZD00106 40940041
         BE    AUTHERR            YES, ERROR, GO ISSUED MSG    @ZD00106 40950041
         L     R5,CVTCUCB         ADDR OF UCM BASE             @ZD00106 40960041
         USING UCM,R5             UCM ADDRESSABILITY           @ZD00106 41000041
         L     R3,UCMVEA          ADDR OF 1ST UCME             @ZD00106 41030041
         L     R6,UCMVEZ          LENGTH OF A UCME             @ZD00106 41060041
         DROP  R5                                              @ZD00106 41090041
         SR    R5,R5              CLEAR REGISTER               @ZD00106 41120041
         IC    R5,XAU             GET CONSOLE ID OF ISSUER     @ZD00106 41150041
         BCTR  R5,D0              SUBRTACT 1                   @ZD00106 41180041
         MR    R4,R6              MULT LENGTH * ID-1           @ZD00106 41210041
         AR    R5,R3              ADD TO ADDR OF 1ST UCME      @ZD00106 41240041
         USING UCMLIST,R5         UCME ADDRESSABILITY          @ZD00106 41270041
         TM    UCMDISP1,UCMDISPA  IS THIS THE MASTER CONSOLE ? @ZD00106 41310041
         BZ    AUTHERR            NO GO TO ISSUE MESSAGE       @ZD00106 41320041
         DROP  R5                                              @ZD00106 41360041
         SPACE                                                          41420041
*********************************************************************** 41450041
*                                                                     * 41480041
* WAS A PARAMETER SPECIFIED WITH THE COMMAND ?                 @ZD00106 41490041
*                                                                     * 41540041
*********************************************************************** 41570041
         SPACE                                                          41600041
AUTHOK   EQU   *                  AUTH HAS BEEN CHECKED AND OK @ZD00106 41610041
         LA    R4,D9              *INITIALIZE COUNTER          *   O102 41800019
         LTR   R7,R9              PARAMETER AREA PTR=0                  42400018
         BZ    CMERRC             IF ZERO GO TO ERROR MESSAGE           42800018
         XC    XAE,XAE            *ZERO PARM BYTE              *   O102 42900019
         EJECT                                                          42950002
*                                                                 20030 43010020
* SCAN BUFFER- CHECK IF FIRST TWO CHARACTERS ARE 'U=', CHECK      20030 43020020
*        LENGTH OF JOBNAME, CHECK FOR DUMP                        20030 43030020
*                                                                 20030 43040020
         CLC   D0(L'UEQUAL,R9),UEQUAL CANCEL TS USER             Y02669 43050002
         BNE   CMSTNEXT           NO, PROCESS BATCH              Y02669 43060002
         LA    R9,D2(R9)          POINT TO BEGINNING OF JOBNAME   20030 43160020
         LR    R7,R9                                              20030 43170020
CMSTNEXT EQU   *                                                        43200018
         C     R7,XAP             HAS END OF BUFFER BEEN REACHED        43600018
         BE    CMTSKNME           END OF SCAN, CHECK NAME          O102 44000019
         CLI   D0(R7),BLANK       CHARACTER  A BLANK                    44400018
         BE    CMTSKNME           END OF SCAN, CHECK NAME          O102 44800019
         CLI   D0(R7),COMMA                                             45200018
         BE    PERAMS             *CONTINUE SCAN               *   O102 45700019
         OI    XAE,UNCK           SET UNCHECKED PARM BIT          M0232 46200020
         LA    R7,1(R7)           INCREMENT  PTR                        46800018
         BCT   R4,CMSTNEXT        *CONTINUE SCAN               *   O102 47200019
         B     CMERR8A                                             O102 47600019
CMTSKNME  EQU  *                                                        48000018
         OI    XAE,EOS            END OF SCAN INDICATOR          Y02669 48060002
PERAMS   EQU   *                                                   O102 48120019
         CLI   XAX,BLANK         *JOBNAME GOTTEN YET?     *        O102 48180019
         BNE   JOBCK                                               O102 48240019
         LA    R3,D8              * MAX NAME LENGTH       *        O102 48300019
         SR    R3,R4                                               O102 48360019
         BM    CMERR8             TERM LENGTH ERROR                O102 48420019
         EX    R3,CMMVCX          MOVE TASKNAME TO XAX             O102 48480019
         MVC   XAV(D8),XAX         NAME FOR CANCEL AND MSG         O102 48540019
         NI    XAE,FOX-UNCK       TURN OFF UNCHECKED PARM BIT     M0232 48600020
JOBCK    EQU   *                                                   O102 48660019
         TM    XAE,EOS                 IS THIS END OF SCAN?      Y02669 48720002
         BNO   NXPARM                  NO, CHECK NEXT FIELD        O102 48780019
         TM    XAE,UNCK           YES; UNCHECKED PARM BIT ON?     M0232 48840020
         BO    INVAL                   YES, COMMAND INVALID        O102 48900019
         B     ENDCK                   NO, SEARCH CSCB'S           O102 48960019
NXPARM   EQU   *                                                   O102 49020019
         NI    XAE,FOX-UNCK       TURN OFF UNCHECKED PARM BIT     M0232 49080020
         LA    R4,FIVE                                             O102 49140019
         CLI   XAN,FORCE          WAS THIS A FORCE COMMAND?    @G17FPSS 49190041
         BE    INVAL              YES. NO ACCEPTABLE KEYWORDS  @G17FPSS 49240041
         CLC   D1(D4,R7),PDUMP                                     O102 49680019
         BE    DUMP               *IF NO HITS,GIVE ERROR MSG-*     O102 49740019
         B     INVAL              *NO OTHER ACCEPTABLE KEYWORDS*   O102 49800019
DUMP     EQU   *                                                   O102 51840019
         OI    XAE,DUMPSW         *  SET DUMP SWITCH           * Y02669 52080002
         LA    R7,D5(R7)          * UPDATE PARM POINTER            O102 52140019
         B     CMSTNEXT           *AND BRANCH TO CONTINUE SCAN *   O102 52200019
ENDCK    EQU   *                                                   O102 52260019
         EJECT                                                          52310002
*                                                                  I272 52840019
* CSCB SCAN ROUTINE COMPARES FIRST ON CHKEY FOR TASKNAME EQUAL     I272 52880019
* TO TASKNAME IN XSA.  IF NO MATCH, A CHECK IS MADE ON 3-BYTE      I272 52920019
* UNIT NAME FIELD. IF NO MATCH IN CSCB CHAIN, BRANCH TO          Y02669 52960002
* IEE0503D, MESSAGE MODULE.                                      Y02669 52970002
        SPACE                                                           53010002
* THE CSCB CHAIN RESOURCE IS SERIALIZED VIA ENQ ON Q10. THE      Y02651 53050002
* RESOURCE IS RELEASED AT CMBRCH.  THE HOLDER OF THE CSCB ENQ    Y02651 53060002
* MUST BE NON-SWAPPABLE TO PREVENT SWAP OUT WHILE HOLDING THE    Y02651 53080002
* RESOURCE, WITH THE PERFORMANCE DEGRADATION WHICH WOULD RESULT  Y02651 53082002
* WHEN ANOTHER ENQ IS ISSUED TO OBTAIN THE RESOURCE.             Y02651 53084002
         SPACE                                                          53086002
         SYSEVENT DONTSWAP         DON'T SWAP CURRENT MEMORY     Y02651 53088002
         SPACE                                                          53090002
         MVC   XASAVSTD(LNE),ENQCSCB MOVE ENQ PARM LIST TO XSA   Y02651 53100002
         ENQ   MF=(E,XASAVSTD)     ENQ ON CSCB CHAIN RESOURCE    Y02651 53110002
CMSCAN   EQU   *                                                   I272 53120019
         LTR   R11,R11             END OF CHAIN                    I272 53160019
         BZ    CMBRCH              YES. GO SET UP NOT FOUND MSG  Y02669 53200002
         TM    CHSTS,CHAP          ASSIGNMENT PENDING              I272 53240019
         BNZ   CMNOGO              GO GET NEXT CSCB                I272 53280019
         CLC   CHKEY,XAX           DO IDS MATCH                    I272 53320019
         BE    FOUND               YES                             I272 53360019
         CLC   CHUNIT(D3),XAX      DO UNIT NAMES MATCH             I272 53400019
         BNE   CMNOGO              NO. GO GET NEXT CSCB            I272 53440019
FOUND    EQU   *                                                   I272 53480019
         TM    CHACT,CHCL         IS JOB CANCELLABLE                    53600018
         BZ    CMNOCAN            NO. SCAN REMAINIMG CSCB'S    @G17FPSS 53620041
*                                                                 20030 54002020
* THIS CHECK IS TO ASSURE THAT WHEN A FOREGROUND JOBNAME IS       20030 54004020
*        SPECIFIED TO BE CANCELLED, A BACKGROUND JOB OF THE SAME  20030 54006020
*        NAME WILL NOT ACCIDENTLY BE CANCELLED AND VICA VERSA.    20030 54008020
*                                                                 20030 54010020
         L     R5,XAL             PTR TO COMMAND PARM LIST        20030 54014020
         LA    R5,D0(R5)          CLEAR HIGH ORDER BYTE           20030 54016020
         CLR   R5,R9              WAS FORE OR BACKGROUND SPECIFIED20030 54018020
         BNE   CHPOST             FOREGROUND. BRANCH TO CHECK CSCBM6205 54020020
* BACKGROUND SPECIFIED, CHECK CSCB FOUND                          20030 54022020
         TM    CHTRKID,CHJOBID    IS THIS A BACKGROUND JOB CSCB  Y02669 54024002
         BNO   CMNOGO             NO. BRANCH TO SCAN THE NEXT    Y02669 54026002
*                                 CSCB                           Y02669 54028002
         B     CANJOB             BYPASS FOREGROUND TEST         Y02669 54036002
CMNOCAN  EQU   *                  JOB WAS NON-CANCELABLE       @G17FPSS 54037041
         OI    XAE,NONCANSW       SET NON-CANCELABLE SWITCH    @G17FPSS 54037641
         B     CMNOGO                                                   54039041
CHPOST   EQU   *                                                  20030 54040020
         TM    CHTRKID,CHTSID     VERIFY FOREGROUND CSCB         Y02669 54042002
         BO    CANJOB             YES, CANCEL IT.                Y02669 54044002
CMNOGO   EQU   *                                                 Y02669 54047002
         L     R11,CHPTR          NEXT CSCB                      Y02669 54050002
         B     CMSCAN             GO TEST CSCB                   Y02669 54053002
CANJOB   EQU   *                                                   O102 54350019
         CLI   XAN,FORCE          THIS A FORCE CMD ?           @G17FPSS 54350241
         BE    FORCEMEM           YES, GO FORCE THE ADDR SPACE @G17FPSS 54350341
         MVC   CHUCMP,XAU          UPDATE UCMI IN CSCB             I272 54350602
         OI    CHACT,CHCLD        POSITION POST CODE                    57200018
         TM    CHCECB,CMCOMP       COMPLETION CODE SET             I272 57600019
         BZ    POST                NO                              I272 57800019
         XC    CHCECB,CHCECB       YES. CLEAR ECB                  I272 58000019
*                                                                       58000402
* LOCATE THE ASCB FOR SIC AND XMPOST                             Y02657 58002002
*                                                                       58010002
* THE ADDRESS OF THE ASCB ASSOCIATED WITH THE ASID IN CHASID     Y02657 58050002
* IS CALCULATED FOR USING THIS FORMULA:                          Y02657 58100002
*   ASCBPTR = ((CHASID*4) + ADDR(ASVTENTY) - 4),                 Y02657 58150002
* WHERE ASVTENTY IS THE FIRST ASCB POINTER IN THE ASVT AND       Y02657 58160002
* ASCBPTR IS THE ASVT FIELD CONTAINING THE ADDRESS OF THE ASCB.  Y02657 58170002
*                                                                       58192002
POST     EQU   *                                                   I272 58192402
         L     R5,CVTASVT          ASVT...                       Y02657 58194002
         USING ASVT,R5             ...ADDRESSABILITY             Y02657 58196002
         LA    R5,ASVTENTY         ADDRESS FIRST ASVT ENTRY      Y02657 58198002
         DROP  R5                  DROP ASCB ADDRESSABILITY      Y02657 58198402
         S     R5,FOUR             DECREMENT TO FIRST SLOT       Y02657 58198802
         SR    R6,R6               ZERO ASID REG FOR INSERT      Y02657 58199202
         ICM   R6,BOTHALF,CHASID   ASID FROM CSCB                Y02657 58199602
         SLL   R6,D2               QUADRUPLE IT FOR OFFSET       Y02657 58199702
         AR    R5,R6               ADDRESS ASVT ENTRY FOR ASID   Y02657 58199802
         L     R6,D0(R5)           LOAD IT FOR SIC AND XMPOST    Y02657 58199902
*                                                                       58209902
* PLACE COMPLETION CODE IN REGISTER ZERO FOR CROSS MEMORY POST. Y02657  58219902
* THE POST IS DONE IN SIC FOR CANCELLATION OF FOREGROUND JOBS,  Y02657  58229902
* AND IN THIS MODULE FOR CANCELLATION OF BACKGROUND JOBS.       Y02657  58239902
*                                                                       58241902
         L     R0,CNODUMP          CANCEL JOB WITHOUT DUMP       Y02657 58243902
         TM    XAE,DUMPSW          DUMP SWITCH ON                Y02657 58249902
         BZ    CNCJBN              * NO,                       * Y02657 58299902
         L     R0,CDUMP            CANCEL JOB WITH DUMP          Y02657 58349902
         EJECT                                                          58380602
*        SCHEDULE SRB TO CANCELLED ADDRESS SPACE               @ZA05360 58381241
*                                                                Y02669 58383202
*        TO DO SO, A BRANCH ENTRY TO SYSTEM INITIATED CANCEL     Y02669 58391202
*        (SIC) WILL BE TAKEN, WITH THE LOCAL AND CMS LOCKS HELD. Y02669 58403202
*        THE LOCKS ARE FREED IMMEDIATELY UPON RETURN FROM SIC.   Y02669 58405202
*        THE REGISTERS ON ENTRY TO SIC:                          Y02669 58405602
*              REGISTER 0          COMPLETION CODE FOR POST      Y02669 58406002
*              REGISTER 1          TARGET MEMORY ASCB ADDR       Y02669 58406402
*              REGISTER 13         ADDRESS OF FULL SAVE AREA     Y02669 58406802
*              REGISTER 14         RETURN POINT IN IEE3703D      Y02669 58406902
*              REGISTER 15         SIC ENTRY POINT ADDRESS       Y02669 58407002
CNCJBN   EQU   *                                               @ZA05360 58417041
         SPACE                                                          58428102
         STM   R11,R14,XASAVLOC    SAVE REGISTERS ACROSS LOCKS   Y02651 58438102
SETLOCK1 SETLOCK OBTAIN,TYPE=LOCAL,MODE=UNCOND,                  Y02651X58448102
               RELATED=(SIC,IEE3703D(CLRLOCK1))                  Y02651 58448502
SETLOCK2 SETLOCK OBTAIN,TYPE=CMS,MODE=UNCOND,                    Y02651X58448902
               RELATED=(SIC,IEE3703D(CLRLOCK2))                  Y02651 58449302
         LR    R1,R6               GET ADDRESS OF ASCB           Y02669 58456502
         LA    R13,XASAVSTD        GET ADDRESS OF SAVE AREA      Y02669 58460502
         L     R15,CVTSIC          GET ADDR OF SIC ENTRY POINT   Y02669 58462502
         BALR  R14,R15             BRANCH TO SIC                 Y02669 58462902
CLRLOCK2 SETLOCK RELEASE,TYPE=CMS,                               Y02651X58463302
               RELATED=(SIC,IEE3703D(GETLOCK2))                  Y02651 58463402
CLRLOCK1 SETLOCK RELEASE,TYPE=LOCAL,                             Y02651X58463502
               RELATED=(SIC,IEE3703D(GETLOCK1))                  Y02651 58470602
         LM    R11,R14,XASAVLOC    RESTORE REGS SAVED ACR0SS     Y02651 58472702
*                                  LOCKS                         Y02651 58474702
         TM    CHTRKID,CHTSID    IS THIS A FOREGROUND JOB CSCB @ZA05360 58474841
         BO    CMCCA            YES, GO SET UP FOR MSG IEE301I @ZA05360 58475041
         EJECT                                                          58476241
*                                                                       58476702
* POST THE CANCEL ECB IN THE CSCB                                Y02669 58477702
*                                                                       58478102
DOPOST   EQU   *                                                  M6205 58491920
*                                  MOVE POST PARM LIST TO XSA    Y02657 58572302
         MVC   XASAVLOC(POSTLEN),POSTER                          Y02657 58573902
*                                                                       59095302
* XMPOST CANCEL ECB                                              Y02657 59095702
*                                                                       59096102
         POST  CHCECB,(0),ASCB=(R6),ERRET=CVTBRET,               Y02657X59096902
               MF=(E,XASAVLOC)     XMPOST CANCEL ECB             Y02657 59097302
CMCCA    EQU   *                                                 Y02669 59099302
         SYSEVENT  BRINGIN,ASIDL=CHASID   INFORM SRM THAT      @YM6770P 59099402
*                                  ADDRESS SPACE IS TO BE      @YM6770P 59099602
*                                  SWAPPED IN FOR CANCELLATION @YM6770P 59099802
         OI    CHACT,CHAFORCE  MARK JOB AS CANCEL ISSUED FOR IT@G17FPSS 59099941
         MVI   XAE,CMCD01          CANCEL COMMAND ACCEPTED         I272 59100002
         B     CMBRCH              GO FREE RESOURCES           @G17FPSS 59120041
         EJECT                                                          59150002
*********************************************************************** 59151041
*                                                                     * 59152041
*            FORCE COMMAND PROCESSING                                 * 59153041
*                                                                     * 59154041
*********************************************************************** 59155041
*********************************************************************** 59155141
*                                                                     * 59155241
*        CALL RTM TO FORCE THE ADDRESS SPACE TO TERMINATE             * 59155341
*                                                                     * 59155441
*********************************************************************** 59155541
         SPACE 2                                                        59156041
FORCEMEM EQU    *                                              @G17FPSS 59157041
         TM     CHACT,CHAFORCE   WAS A CANCEL ISSUED FOR THIS           59157441
*                                ASID?                         @G17FPSS 59157941
         BO     CALLRTM          YES, GO FORCE ASID            @G17FPSS 59158441
         MVI    XAE,CMCD27       CODE FOR ISSUE CANCEL FOR JOB @G17FPSS 59158541
         B      CMBRCH           GO RELEASE REASOURCES         @G17FPSS 59158641
         SPACE                                                          59159541
CALLRTM  EQU    *                                                       59159741
         SR     R6,R6            ZERO ASID REG FOR INSERT      @G17FPSS 59160041
         ICM    R6,BOTHALF,CHASID GET ASID FROM CSCB           @G17FPSS 59160841
         STM    R11,R14,XASAVLOC SAVE REGS ACROSS CALLRTM      @G17FPSS 59161641
         LA     R13,XASAVSTD     CALLRTM NEEDS A WORK AREA     @G17FPSS 59162041
         LR     R5,R2            SAVE ADDR OF XSA              @G17FPSS 59163241
         SPACE                                                          59164141
         CALLRTM TYPE=MEMTERM,COMPCOD=A22,ASID=(R6)   CANCEL THE       X59165041
                                 ADDRESS SPACE                 @G17FPSS 59165441
         SPACE                                                          59165941
         LR     R2,R5            RESTORE XSA ADDR              @G17FPSS 59166441
         LM     R11,R14,XASAVLOC RESTORE THE REGS              @G17FPSS 59167441
         MVI    XAE,CMCD02       CODE FOR FORCE CMD ACCEPTED   @G17FPSS 59168441
         EJECT                                                          59175041
*  THE CSCB CHAIN RESOURCE (Q10) IS RELEASED HERE. IT WAS        Y02651 59200002
*  OBTAINED AT ENDCK. SWAPPING IS THEN AGAIN MADE POSSIBLE.      Y02651 59250002
CMBRCH   EQU    *                                                Y02669 69600002
         MVC   XASAVSTD(LND),DEQCSCB MOVE DEQ PARM LIST TO XSA   Y02651 69610002
         DEQ   MF=(E,XASAVSTD)     DEQ OFF CSCB CHAIN RESOURCE   Y02651 69650002
         SPACE                                                          69700002
         SYSEVENT OKSWAP          ALLOW SWAP FOR THIS MEMORY     Y02651 69750002
         SPACE                                                          69800002
         LTR   R11,R11            END OF CSCB CHAIN                I272 70400002
         BC    7,CMBRCH5                                                70800002
         L     R5,XAL             PTR TO COMMAND PARM LIST        20030 70840020
         LA    R5,D0(R5)          CLEAR HIGH ORDER BYTE           20030 70880020
         CLR   R5,R9              WAS A BACKGROUND JOB SPECIFIED  20030 70920020
         BNE   NOTFORE            NO, GO ISSUE NOT LOGGED ON MSG Y02669 70960002
NOTBACK  EQU   *                                                 Y02669 70963002
         TM    XAE,NONCANSW       WAS JOB NONCANCELABLE?       @G17FPSS 70963641
         BO    NONCAN             YES, GO USE NON-CAN MSG      @G17FPSS 70963941
         MVI   XAE,CMCD36         MSG CODE - NOT ACTIVE        @G17FPSS 70964241
         B     CMBRCH5            GO TO IEE0503D               @G17FPSS 70964541
NONCAN   EQU   *                  JOB NON-CANCELABLE           @G17FPSS 70964841
         MVI   XAE,CMCD28         MSG CODE - NON-CANCELABLE    @G17FPSS 70965141
         CLI   XAN,FORCE          WAS THIS A FORCE CMD?        @G17FPSS 70965241
         BNE   CMBRCH5            NO, GO TO IEE0503D           @G17FPSS 70965341
         MVI   XAE,CMCD22         MSG CODE NON-FORCIBLE        @G17FPSS 70965441
         B     CMBRCH5            GO TO IEE0503D               @G17FPSS 70965641
NOTFORE  EQU   *                   USER NOT LOGGED ON            Y02669 70966002
         MVI   XAE,CMCD53         MSG CODE- NOT LOGGED ON        Y02669 71000002
         B     CMBRCH5            GO BRANCH TO IEE0503D          Y02669 71080002
CMERRC   EQU   *                                                   O102 74060019
         MVI   XAE,CMCD0B         PARAMETER MISSING CODE         Y02669 74120002
         B     CMBRCH5F           GO OVERLAY XAV WITH COMMAND  @G17FPSS 74230041
*                                 VERB AND BRANCH TO IEE0503D    Y02669 74232002
AUTHERR  EQU   *                  THE AUTH OF ISSUING CONSOLE WAS      *74233041
                                  INVALID                      @ZD00106 74233541
         MVI   XAE,CMCD41         AUTH INVALID CODE            @ZD00106 74234041
         B     CMBRCH5F           GO OVERLAY XAV WITH COMMAND VERB     *74236041
                                  AND BRANCH TO IEE0503D       @ZD00106 74236541
CMERR8A  EQU   *                                                   O102 74240019
CMERR8   EQU    *                                                       74400018
         MVI   XAE,CMCD08         TERM LENGTH ERROR                     74800018
         B     CMBRCH5F           GO OVERLAY JOBNAME W/ CMD    @G17FPSS 74870041
*                                 VERB AND BRANCH TO IEE0503D    Y02669 74930002
INVAL    MVI   XAE,CMCD05     * CODE FOR 'COMMAND INVALID'     * Y02669 75410002
         SPACE 2                                                        75430002
**************************************************************** Y02669 75440002
*                                                              * Y02669 75450002
*       EXIT CODE FOR BRANCH TO:                               * Y02669 75452002
*                                                              * Y02669 75454002
*              MESSAGE MODULE         IEE0503D                 * Y02669 75454102
*                                                              * Y02669 75454802
**************************************************************** Y02669 75456002
CMBRCH5F EQU   *                                               @G17FPSS 75456341
         MVC   XAV(D8),CANC       MOVE CANCEL VERB TO MESSAGE  @G17FPSS 75456641
         CLI   XAN,FORCE          THIS A FORCE CMD ?           @G17FPSS 75456941
         BNE   CMBRCH5            NO                           @G17FPSS 75457241
         MVC   XAV(D8),FORCNAM    YES, MOVE FORCE INTO MSG     @G17FPSS 75457541
CMBRCH5  EQU   *                                                 Y02669 75458802
         L     R11,VCON05         GET ADDRESS OF IEE0503D        Y02669 75459202
         BR    R11                GO BRANCH TO MESSAGE MODULE    Y02669 75459302
         EJECT                                                          75709602
*********************************************************************** 78000018
*                                                                     * 78400018
*                       DEFINED CONSTANTS                             * 78800018
*                                                                     * 79200018
*********************************************************************** 79600018
         DS    0F                                                       80000018
VCON05   DC    V(IEE0503D)        ADDRESS OF MESSAGE MODULE      Y02669 80050002
CDUMP    DC    X'00000122'        CANCEL WITH A DUMP             Y02669 80500002
CNODUMP  DC    X'00000222'        CANCEL WITHOUT A DUMP          Y02669 80600002
FOUR     DC    F'4'               CONSTANT FOR ASID CONVERSION   Y02657 80750002
CANC     DC    C'CANCEL  '        CANCEL COMMAND                   O102 80900002
FORCNAM  DC    C'FORCE   '        FORCE COMMAND                @G17FPSS 80901041
PDUMP    DC    C'DUMP'            DUMP COMPARAND                   O102 80903002
UEQUAL   DC    C'U='              TS USER INDICATOR              Y02669 80953002
CMMVCX   MVC   XAX(1),0(R9)                                             81600018
         SPACE                                                          81602002
POSTER   POST  MF=L                LIST FORM OF MACRO            Y02657 81603002
         SPACE                                                          81613002
POSTLEN  EQU   *-POSTER            LENGTH OF PARMLIST FOR MOVE   Y02657 81615002
         SPACE                                                          81617002
* ENQ PARAMETER LIST FOR CSCB RESOURCE                           Y02651 81623002
ENQCSCB  ENQ   (IEECSCB,IEESQ10,S,3,SYSTEM),MF=L                 Y02651 81633002
LNE      EQU   *-ENQCSCB           LENGTH OF ENQ PARM LIST       Y02651 81633402
         SPACE                                                          81633802
* DEQ PARAMETER LIST FOR CSCB RESOURCE                           Y02651 81634202
DEQCSCB  DEQ   (IEECSCB,IEESQ10,3,SYSTEM),MF=L                   Y02651 81634602
LND      EQU   *-DEQCSCB           LENGTH OF DEQ PARM LIST       Y02651 81634702
         SPACE                                                          81634802
IEECSCB  DC    C'SYSIEFSD'         QNAME                         Y02651 81635002
IEESQ10  DC    C'Q10'              RNAME                         Y02651 81637002
         SPACE                                                          81687002
PATCH    DC    CL50'***   IEE3703D  PATCH AREA  ***'             Y02669 81737002
         TITLE 'IEE3703D--XSA MAP'                                      82206002
CMXSA    DSECT                                                          82400018
        IEEXSA                                                          82800018
         TITLE 'IEE3703D--CVT MAP'                                      83000019
CMCVT    DSECT                                                          83200018
         CVT   DSECT=NO                                          Y01012 83600001
         TITLE 'IEE3703D--MASTER RESIDENT CORE MAP'                     83800019
         IEEBASEA                                                       84000018
         TITLE 'IEE3703D--CSCB MAP'                                     84053002
CMCHAIN  DSECT                                                          84400018
         IEECHAIN                                                       84800018
         TITLE  'IEE3703D--PREFIX STORAGE AREA MAP'                     84900002
         IHAPSA                                                         84950002
         TITLE 'IEE3703D--ADDRESS SPACE VECTOR TABLE MAP'               85000002
         IHAASVT                                                 Y02657 85050002
         TITLE 'IEE3703D--UNIT CONTROL MODULE(UCM)'            @G17FPSS 85100041
         IEECUCM  FORMAT=NEW                                   @G17FPSS 85150041
         END                                                            86000018
./  ADD  SSI=42960086,NAME=IEE4103D
      TITLE 'IEE4103D - VARY HARDCOPY MESSAGE MODULE'                   00300002
IEE4103D CSECT                                                          00600018
*********************************************************************** 00650002
*                                                                       01100002
* MODULE NAME      = IEE4103D                                           01150002
*    CSECT NAME    = IEE4103D                                           01160002
*                                                                       01162002
* LOAD MODULE NAME = IGC0003D                                           01170002
*                                                                       01180002
* DESCRIPTIVE NAME = HARDCOPY INFORMATIONAL MESSAGE MODULE              01194002
*                                                                       01196002
* COPYRIGHT        = MISSING                                            01198802
*                                                                       01199202
* STATUS           = OS/VS/2 RELEASE 3                         @Z30LPTJ 01199603
*                                                                       01199702
* FUNCTION         = ISSUES A HEADER AND A HARDCPY INFORMATIONAL        01249902
*                    MESSAGE FOR A DEVICE THAT HAS JUST BEEN VARIED     01259902
*                    AS A HARDCPY DEVICE.                               01269902
*                                                                       01279902
* OPERATION        = THIS MODULE, USES THE INFO IN THE UNIT CONTROL     01289902
*                    MODULE (UCM),THE UNIT CONTROL MODULE ENTRY (UCME), 01293902
*                    AND THE MODULE PREFIX (UCMPRFX) TO CONSTRUCT THE   01295902
*                    HARDCPY MESSAGE.                                   01297902
*                    THE MESSAGE CONTAINS THE PHYSICAL DEVICE ADDRS OF  01298302
*                    THE HARDCPY DEVICE, INFO AS TO WHETHER IT IS       01298702
*                    A STAND-ALONE O-UNIT, AN I/O UNIT, OR PART OF      01299102
*                    A COMPOSITE, IT WILL SHOW ITS ALTERNATE, ITS       01299502
*                    ROUTE CODES AND WHAT INFORMATION IS TO GO TO       01299602
*                    HARDCPY (STCMDS,INCMDS,NOCMDS,CMDS,OFF).           01299702
*                                                                       01299802
* NOTES                                                                 01309802
*    DEPENCENCIES  = NONE                                               01349802
*    CHARACTER/CODE DEPENDENCIES                                        01351802
*                  = THIS MODULE CAN BE ASSEMBLED WITH ANY NEW          01353802
*                    CHARACTER/CODE SET.                                01355802
*                                                                       01359802
* RESTRICTIONS     = REG2 PTR TO THE XSA ON INPUT                       01361802
*                    REG5 PTR TO THE MESSAGE BUFFER GETMAIN'ED          01389802
*                    BY IEE7203D                                        01391802
*    REGISTER CONVENTIONS                                               01392202
*                  = REGISTERS ARE DEFINED AT LABEL: DEFREG             01392602
*    PATCH LABEL   = PATCH                                              01393002
*                                                                       01393802
* MODULE TYPE      = CSECT                                              01394202
*    PROCESSOR     = ASSEMBLER                                          01394602
*    MODULE SIZE   = VS/2 = '38A'                              @ZM30445 01395003
*    ATTRIBUTES    = REENTRANT, REUSABLE, REFRESHABLE, PAGED LPA,       01395802
*                    ZERO PSW PROTECT KEY, SUPERVISOR MODE              01397802
*                                                                       01398202
* ENTRY POINT      = IEE4103D FROM IEE7203D                             01399402
*    PURPOSE       = TO ISSUE HARDCPY MESSAGE                           01399502
*    LINKAGE       = BRANCH                                             01399602
*    INPUT         = REG2 POINTS TO THE XSA                             01399702
*                    REG1 POINTS TO THE MESSAGE AREA GETMAIN'ED         01449702
*                    BY 7203D                                           01459702
*                    REG12 POINTS TO THE UNIT FIELD OR IS ZERO          01469702
*                    IF THE UNIT IN THE COMMAND IS SYSLOG               01479702
*                    REG14 CONTAINS THE RETURN ADDRESS                  01489702
*    REGISTERS SAVED= NONE                                              01491702
*    REGISTER USAGE= R0      UCMID REG FOR WTO                          01495702
*                    R1      INDEX IN MSG BUFFER AND WTO PTR            01497702
*                    R2      XSA PTR                                    01498102
*                    R3      UCM PTR                                    01498502
*                    R4      UCMPRFX PTR                                01498902
*                    R5      MESSAGE FBUFFER PTR                        01499302
*                    R9      UCME PTR                                   01499402
*                    R11     UCME'S OF ALTERNATE CONSOLE PTR            01499502
*                    R12     PTR TO UNIT FIELD OF 0 IF UNIT IS SYSLOG   01499602
*                    R13     COMPOSITE'S UCME PTR IF ANY                01533002
*                    R15     UCB PTR                                    01543002
*    REGISTERS RESTORED                                                 01553002
*                  = NONE                                               01563002
*                                                                       01565002
* EXITS - NORMAL   = BR14 TO CALLER OF SVC 34                           01565402
*    CONDITIONS    = MESSAGE WAS ISSUED                                 01566202
*    OUTPUT        = R2 PTS TO THE XSA                                  01566302
*    RETURN CODES  = NONE                                               01566402
*                                                                       01577602
* EXITS - ERROR    = NONE                                               01587602
*                                                                       01588002
* EXTERNAL REFERENCES                                                   01588402
*    ROUTINES      = NONE                                               01588802
*    DATA AREAS    = NONE                                               01594502
*                                                                       01594902
* CONTROL BLOCKS   = . EXTENDED SAVE AREA (XSA)                         01595302
*                    . UNIT CONTROL BLOCK (UCB)                         01595702
*                       FIELDS TESTED  - UCBNAME                        01596102
*                       FIELDS UPDATED - NONE                           01596202
*                    . UNIT CONTROL MODULE (UCM)                        01646202
*                       FIELDS TESTED  - UCMALTEN                       01656202
*                                        UCMATR - BIT= UCMOF            01666202
*                                        UCMCOMPC                       01676202
*                                        UCMHRDRT                       01686202
*                                        UCMID                          01688202
*                                        UCMSDS1 - BIT= UCMSDS1A        01690202
*                                                       UCMSDS1B        01692202
*                                        UCMSFLGS - BIT= UCMSYSC        01694202
*                                        UCMUCB                         01694602
*                                        UCMVEA                         01695002
*                                        UCMXECB                        01695402
*                       FIELDS UPDATED - NONE                           01695802
*                    . CVT                                              01695902
*                       FIELDS TESTED  - CVTCUCB                        01696002
*                       FIELDS UPDATED - NONE                           01696102
*                                                                       01712802
* TABLES           = MESSAGE BUFFER GETMAIN'ED BY IEE7203D              01722802
*                                                                       01724802
* MACROS           = WTO, FREEMAIN, SETLOCK                             01726802
*                                                                       01728802
* MAPPING MACROS   = IEEXSA                                             01729202
*                    IEECUCM                                            01729302
*                    IEFUCBOB                                           01729402
*                    CVT                                                01735002
*                    IHAPSA                                             01735102
*    SERIALIZATION = NO LOCKS ARE REQUIRED IN THIS MODULE FOR THE UCB.  01735402
*                    THE ONE FIELD USED IN HERE IS UCBNAME WHICH        01735802
*                    ALWAYS REMAINS UNCHANGED.                          01736202
*                    THE UCM IS PROTECTED VIA THE LOCAL AND CMS LOCKS.  01736602
*                    THIS PROTECTION IS REQUIRED AGAINST ANOTHER VARY   01736702
*                    COMMAND OR COMM. TASK.                             01736802
*                    THESE LOCKS ARE OBTAINED AT:                       01736902
*                         HSETLK IN MODULE IEE7203D                     01739502
*                    AND RELEASED AT:                                   01741502
*                         HUNSTLK IN THIS MODULE                        01741902
*                    AS SOON AS UCM FIELDS ARE NOT REQUIRED ANY LONGER. 01742302
*                    FIELDS WHICH MUST BE PROTECTED:                    01745202
*                         UCMALTEN - ALTERNATE CONSOLE PTR - UCM        01747202
*                         UCMSDS1  - BIT =UCMSDS1A,UCMSDS1B,            01747602
*                                         STCMDS,  INCMDS  - UCM        01748002
*                                    HARDCPY BITS IN THE UCM            01748402
*                         UCMSFLGS - BIT = UCMSYSC         - UCM        01748502
*                                    CMDS SET FOR HARDCPY BIT           01749002
*                         UCMHRDRT - HARDCPY ROUTCODES     - UCM        01749402
*                                                                       01750202
* CHANGE LEVEL     = Y02669, Y02651, Z30LPTJ, ZM30445          @ZM30445 01751503
*                                                                       01754402
* CHANGE ACTIVITY  = N/A                                                01757302
*                                                                       01760202
* MESSAGES         = 'IEE349I HARDCOPY CONSOLE'                         01760502
*                    'CONSOLE/ALT  COND  AUTH  ID  ROUTCD'              01770502
*                    'MESSAGE CONTAINING THE INFO FOR THE DEVICE AS     01780502
*                    CAPTIONED ABOVE'                                   01790502
*                                                                       01800502
* ABEND CODES      = NONE                                               01830502
*                                                                       01832502
* PACKAGING        = IEE4103D WILL BE PART OF LOAD MODULE               01838502
*                       = IGC0003D                                      01838902
*                    THIS LOAD MODULE ALIASES ARE                       01839302
*                       = NONE                                          01839702
*                    THIS LOAD MODULE ENTRY POINTS ARE                  01840102
*                       = IGC0003D                                      01840202
*                    MODULE WILL RESIDE IN: LPALIB                      01849802
*                                                                       01859502
* SYSGEN           = SUPPLIED BY SECTIONS:                              01869102
*                    LOAD MODULE NAME                                   01871102
*                    PACKAGING                                          01873102
*                    THIS CSECT WILL BE INCLUDED AT SYSGEN FROM         01873202
*                    DLIB -AOSB3- BY MACRO -SGIEF441-                   01873302
*                                                                       01873502
* SYSTEM LIBRARIES = NONE                                               01873602
*                                                                       01873702
*********************************************************************** 01873802
         EJECT                                                          01883802
*                                                                       01890302
DEFREG   EQU   *                                                 Y02669 01890402
R0       EQU   0                                                        01890502
R1       EQU   1                                                        02400018
CXSA     EQU   2                   PTR TO XSA                           03200018
R3       EQU   3                                                        04000018
R4       EQU   4                   ON ENTRY HAS CONTENTS OF XAD         04800018
R5       EQU   5                                                        05600018
R6       EQU   6                   ADDRESSABILITY REG                   06400018
R7       EQU   7                                                        07200018
R8       EQU   8                   ON ENTRY,HAS PTR T O GOTTEN CORE     08000018
R9       EQU   9                                                        08800018
R10      EQU   10                                                       09600018
R11      EQU   11                                                       10400018
R12      EQU   12                                                       11200018
R13      EQU   13                                                       12000018
R14      EQU   14                                                Y02651 12050002
CRETURN  EQU   14                  RETRN REGISTER                       12800018
R15      EQU   15                                                       13600018
*                                                                       14400018
*        LENGTH DEFINITIONS                                             15200018
*                                                                       16000018
COMMA    EQU   C','                                                     17600018
CSLASH   EQU   C'/'                                                     17720002
CDASH    EQU   C'-'                                                     17810018
CHRDCPY  EQU   C'H'                    CONSOLE IS HARDCOPY              17950018
L3       EQU   3                       LENGTH OF PHYSICAL DEV ADDR      18020018
L6       EQU   6                       DISPLACEMENT OF O-UNITPAST I-    18090018
CBACK    EQU   X'FF'                                                    20000018
*                                                                       20800018
ZERO     EQU   0                                                        20850018
ONE      EQU   1                                                        20900018
TWO      EQU   2                                                        20950018
TRE      EQU   3                                                        21000018
FOR      EQU   4                                                        21050018
SIX      EQU   6                                                        21100018
TWLV     EQU   12                                                       21250018
FIFTN    EQU   15                                                       21300018
ONEDGT   EQU   X'F0'                                                    21450018
LENMSG   EQU   X'7C'                   LENGTH OF MLWTO MSG        21002 21596001
ZONEBIT  EQU   X'0F'                   ZONE BIT FOR UNPACK        21002 21598001
BLNK     EQU   X'40'                   BLANK                      21002 21598401
WORD     EQU   3                       OFFSET TO DOUBLE WORD      21002 21599601
WORDZONE EQU   10                      OFFSET TO ZONE BYTE        21002 21599701
WORDID   EQU   9                       OFFSET TO CONSOLE ID       21002 21599801
RI       EQU   X'80'                                           @ZM30445 21599903
         EJECT                                                          21600018
         BALR  R6,ZERO                  ADDRESSABILITY                  22400018
         USING *,R6                ADDRESSABILITY                       23200018
         MODID BR=YES                                            Y01886 23250001
         USING XSASET,CXSA              ADDRESSABILITY FOR XSA          24000018
*                                                                       24800018
         L     R3,CVTPTR                                                28800018
         USING CVTSET,R3                                                29600018
         L     R3,CVTCUCB          PTR TO UCM                           30400018
         DROP  R3                                                       31200018
         USING UCM,R3           ADDRESSABILITY FOR UCM           Y02669 32000002
         LR    R5,R1               GET MSG CORE PTR INTO REG5    Y02669 32050002
*                                                                       32800018
         USING CMESSAGE,R5                                        19084 33200019
         LA    R1,CHEADR           POINTER TO DECLARED HEADER     19084 33300019
         MVC   ZERO(LENMSG,R5),ZERO(R1)  MOVE MLWTO INTO BUFFER   21002 33400001
*                                                                       34100019
*********************************************************************** 34200019
*        HARDCOPY MESSAGE ROUTINE                                       34300019
*********************************************************************** 34400019
*                                                                       34500019
         LR    R4,R3                                             Y02669 34700002
         SH    R4,CFOUR                                                 34800019
         L     R4,ZERO(R4)                                              34900019
         USING UCMPRFX,R4                                               35000019
         LTR   R12,R12             IS IT SYSLOG                   19084 35400019
         BZ    CSYSLG              YES                                  35500019
         LM    R9,R11,UCMVEA          1ST,SIZE AND LAST UCME            35600019
         USING UCMLIST,R9             UCME ADDRESSIBILITY               35700019
         USING UCBSET,R15              UCB ADDRESSIBILITY               35800019
CLOOP1   L     R15,UCMUCB              PTR TO UCME'S UCB                35900019
         CLC   ZERO(L3,R12),UCBNAME        IS UCME FOR UNIT IN CIB19084 36000019
         BE    CHRDIN                  YES,PROCESS                      36100019
         BXLE  R9,R10,CLOOP1          TRY NEXT ONE                      36200019
*                                                                       36300019
*********************************************************************** 36400019
* PREPARE FOR MESSAGE BUILDING BY MOVING IN HEADER AND BASIC SYNTAX   * 36500019
*********************************************************************** 36600019
*                                                                       36700019
CHRDIN   EQU   *                                                        36800019
         L     R13,UCMCOMPC            GET COMPOSITE PTR,IF IT IS       36900019
         LTR   R13,R13                 NOT ZERO,UNIT IS A COMPOSITE     37000019
         BZ    CONEU                   IF ZERO ONLY ONE UNIT            37100019
         TM    UCMATR,UCMOF             IS IT O-UNIT                    37200019
         BZ   CHMOVE              NO, OK                                37300019
         LR    R9,R13              R9 PTR TO UCME OF I-UNIT NOW         37400019
         L     R13,UCMCOMPC        R13, NOT PTS TO UCME OF OUTPUT UNIT  37500019
         L     R15,UCMUCB                                               37600019
CHMOVE   EQU   *                                                        37700019
         MVC   XUNIT1(L3),UCBNAME        INSERT I-UNIT ADDR             37800019
         MVI   XBLANK,COMMA            INSERT DELIMITER                 37900019
         L    R15,TWLV(R13)                                             38000019
CONEU    EQU   *                                                        38100019
         MVC   XUNIT2(L3),UCBNAME        INSERT UNIT                    38200019
         MVI   XCOMMA,CSLASH           SET DELIMITER                    38400019
         L     R11,UCMALTEN            OBTAIN ALTERNATE PTR (I-UNIT)    38500019
         DROP  R9                      ..                               38600019
         USING UCMLIST,R11             ..                               38700019
         LTR   R11,R11                 DO WE HAVE A COMPOSITE?   Y02669 38750002
         BZ    CATTRBTE                NOPE, IT IS ONE CONS SYSTEY02669 38760002
         L     R15,UCMUCB              OBTAIN ALTERNATE'S UCB PTR       38800019
         MVC   XAUNIT1(L3),UCBNAME     PLACE ALT'S ADDR IN MSG          38900019
         L     R11,UCMCOMPC            OBTAIN O-UNIT PTR                39000019
         LTR   R11,R11                 IF PTR=0,NO O-UNIT               39100019
         BZ    CATTRBTE            RETURN                               39200019
         MVI   XBLK,COMMA              ALT=COMPOSITE,SET DELIMITER      39300019
         L     R15,UCMUCB              ..                               39400019
         MVC   XAUNIT2(L3),UCBNAME     INSERT 2ND ALTCON ADDR           39500019
         DROP  R11,R15                 ..                               39600019
         USING UCMLIST,R9              ..                               39700019
CATTRBTE EQU   *                                                        39800019
*********************************************************************** 39850001
* AUTHORITY CODE DETERMINATION.                                   21002 39852001
*********************************************************************** 39860001
         MVI   XMSGSTAT,CHRDCPY    ASSUME HARDCOPY                      39900019
         MVC   XMSGAUTH(SIX),CNO       INSERT NOCMDS              21002 40110001
         TM    UCMSDS1,UCMSDS1A        IS THIS STCMDS             21002 40120001
         BO    CHDCPST                 YES, MOVE STCMDS INTO MSG  21002 40130001
         TM    UCMSDS1,UCMSDS1B        IS THIS INCMDS             21002 40460001
         BO    CHRDCPIN                NO, CK TO SEE IF CMDS      21002 40470001
         TM    UCMSFLGS,UCMSYSC        IS THIS CMDS               21002 40480001
         BZ    CRT7A                   NO COMMANDS ASSUMED        21002 40490001
         MVC   XMSGAUTH(SIX),CMDS      MOVE CMDS TO MSG AREA      21002 40494001
         B     CRT7A                   CONTINUE                   21002 40496001
CHRDCPIN EQU   *                                                  21002 40598401
         MVC   XMSGAUTH(TWO),CIN       MOVE IN INCMDS             21002 40598801
         B     CRT7A                   CONTINUE                   21002 40598901
CHDCPST  EQU   *                                                  21002 40599001
         MVC   XMSGAUTH(TWO),CST       MOVE IN STCMDS             21002 40599101
         B     CRT7A                   CONTINUE                   21002 40602501
*********************************************************************** 40604501
*          FILL IN CONSOLE ID                                    21002* 40604901
*********************************************************************** 40605301
CRT7A    EQU   *                                                  21002 40605701
         LTR   R12,R12             IS THIS SYSLOG ?               21002 40606001
         BZ    RTCDET              YES, NO CONSOLE ID.            21002 40609401
         CLI   XUNIT2,BLNK             COMPOSITE CONSOLE          21002 40612801
         BNE   NOCOMP                  NO, USE UCME IN REG 9      21002 40616201
         L     R9,UCMCOMPC             UCME OF OUTPUT CONSOLE     21002 40619601
NOCOMP   EQU   *                                                  21002 40620001
         SR    R11,R11                 CLEAR FOR CONSOLE ID       21002 40620901
         IC    R11,UCMID               GET CONSOLE ID             21002 40632201
         CVD   R11,XMSGWK+WORD         CONVERT TO DECIMAL         21002 40643501
         OI    XMSGWK+WORDZONE,ZONEBIT                            21002 40654801
         UNPK  XMSGID(TRE),XMSGWK+WORDID(TWO)                     21002 40666101
         MVI   XMSGID,BLNK             BLNAK OUT FIRST BYTE       21002 40677401
*********************************************************************** 40688701
*                                                                     * 40700019
* ROUTING CODE DETERMINATION                                          * 40800019
*                                                                     * 40900019
*********************************************************************** 41000019
RTCDET   EQU   *                                                  21002 41050001
         LH    R11,UCMHRDRT        PRESET TO CHECK ROUT CODE            41200019
         SPACE 10                                                       41250002
***************************************************              Y02651 41260002
*                                                                Y02651 41260402
* AT THIS POINT NO LOCKS ARE NEEDE ANY LONGER                    Y02651 41260802
*  THESE LOCKS WERE OBTAINED AT:                                 Y02651 41261202
*              HSETLK                                            Y02651 41261602
HUNSTLK EQU   *                                                  Y02651 41261702
         STM   R11,R14,XASAVLOC                                  Y02651 41264602
         SETLOCK RELEASE,TYPE=CMS,RELATED=(IEE7203D(HSETLK))     Y02651 41267602
         SETLOCK RELEASE,TYPE=LOCAL,RELATED=(IEE7203D(HSETLK))   Y02651 41270502
         LM    R11,R14,XASAVLOC                                  Y02651 41272502
*                                                                Y02651 41273402
***************************************************              Y02651 41281002
         SPACE 10                                                       41290502
         LTR   R11,R11             ARE NO ROUTCDES ALLOWED              41300019
         BZ    CNONE1                  NO ROUT RTN                      41400019
         CH    R11,CRTALL                                               41500019
         BE    CRTALLL                 ALL ROUT RTN                     41600019
*                                                                       41700019
* PROCESSING OF INDIVIDUAL ROUTING CODES                                41800019
*                                                                       41900019
         SLL   R11,FIFTN              LEFT JUSTIFY                      42100019
         LA    R10,CTABLE          GET PTR TO CONVERSION TABLE          42200019
         LA    R1,XMSGWK+ONE           GET POINTER TO WORK AREA-  21002 42300001
*                                      MUST BE ON WORD BOUNDARY   21002 42350001
NEXT     EQU   *                                                        42400019
         SLL   R11,ONE                                                  42500019
         LTR   R11,R11             IS BIT ON                            42600019
         BZ    NOMORE              NO, NOMORE,GO TO TRANCRIBE RT CODES  42700019
         BNM   NEXT1               NO, BUT OTHERS ON                    42800019
         MVC   ZERO(TWO,R1),ZERO(R10)   MOVE IN RT CDE                  42900019
         LA    R1,TWO(R1)            PT TO NEXT SPACE TO WRITE          43000019
NEXT1    EQU   *                                                        43100019
         LA    R10,TWO(R10)          PT TO NEXT CODE IN TABLE           43200019
         B     NEXT                    GO PROCESS NEXT RTCD             43300019
NOMORE   EQU   *                                                        43400019
         SR    R7,R7               ZERO OUT COUNTER               19084 43500019
         MVI   ZERO(R1),CBACK           PLACE END DELIMITER             43600019
         LA    R10,XMSGWK+ONE          ADDRESS OF WORK AREA       21002 43700001
*                                      MUST BE ON WORD BOUNDARY   21002 43750001
         LA    R1,XMSGRTCD         GET PTR TO RT CD AREA                43800019
BEGIN    EQU   *                                                        43900019
         MVC   ZERO(TWO,R1),ZERO(R10)                                   44000019
         CLI   ZERO(R10),ONEDGT         ONE OR TWO DIGITS NUMBER        44100019
         BNE   MOVED                   ALREADY FULLY MOVED              44200019
         MVC   ZERO(ONE,R1),ONE(R10)                                    44300019
         BCTR  R1,ZERO                  MINUS 1                         44400019
MOVED    EQU   *                                                        44500019
         LA    R1,TWO(R1)                                               44600019
ENDCHK   EQU   *                                                        44700019
         CLI   TWO(R10),CBACK                                           44800019
         BE    CISSUE1                  GO ISSUE MSG                    44900019
         MVI   ZERO(R1),COMMA                                           45000019
         SR    R7,R7               ZERO OUT COUNTER               19084 45100019
ENDCHK2  EQU   *                                                        45200019
         LH    R11,ZERO(R10)                                            45300019
         MVC   ONE(TWO,R1),TWO(R10)                                     45400019
         CH    R11,TAB09           IS NEXT NUMB A  TWO DIGIT NUMB       45500019
         BNE   ENDCHK3             NO, OK, GO PROCESS NORMAL            45600019
         AH    R11,FOX7            YES, ADD SPECIAL CAHRACTER           45700019
         B     ENDCHK5             GO PROCESS NORMAL                    45800019
ENDCHK3  EQU   *                                                        45900019
         AH    R11,HONE            ADD ONE TO COMPARE REG               46000019
ENDCHK5  EQU   *                                                        46100019
         LA    R10,TWO(R10)                                             46200019
         CH    R11,ZERO(R10)                                            46300019
         BE    SLASH                    GO MOVE IN A DASH               46400019
ENDSLASH EQU   *                                                        46500019
         CLI   ONE(R1),ONEDGT           ONE OR TWO DIGITS NUMBER        46600019
         BE    MOVEOVER                 ONE DIGIT, GO MOVE IT 1 MORE    46700019
         LA    R1,ONE(R1)               UPDATE PTR                      46800019
CONT     EQU   *                                                        46900019
         LA    R1,TWO(R1)                                               47000019
         LTR   R7,R7               FIRST TIME AROUND              19084 47100019
         BNZ   ENDCHK              NO, BRANCH                           47200019
         CLI   TWO(R10),CBACK          IS IT A DELIMITER                47300019
         BE    CISSUE1                  YES,GO ISSUE MSG                47400019
         MVI   ZERO(R1),COMMA           MOVE IN ','                     47500019
         B     ENDCHK2             CHECK NEXT DIGIT                     47600019
MOVEOVER EQU   *                                                        47700019
         MVC   ONE(ONE,R1),TWO(R1)                                      47800019
         B     CONT                     MOVED OVER, CONTINUE PROCESS    47900019
SLASHRTN EQU   *                                                        48000019
         LA    R10,TWO(R10)                                             48100019
         CLI   TWO(R10),CBACK      END DELIMITER                        48200019
         BE    SLASH6              YES, GO FINISH UP                    48300019
SLASH    EQU   *                                                        48400019
         MVI   ZERO(R1),CDASH         MOVE IN DASH                      48500019
         CH    R11,TAB09           2S IT GOING TO A TWO UNIT DIGIT      48600019
         BNE   SLASH2              (O, CONTINUE NORMAL PROCESS          48700019
         AH    R11,FOX7            YES, ADD F7  TO  THE COMPARE REG     48800019
         B     SLASH4              RETURN TO NORMAL PROCESS             48900019
SLASH2   EQU   *                                                        49000019
         AH    R11,HONE            ADD ONE TO COMPARE REG               49100019
SLASH4   EQU   *                                                        49200019
         CH    R11,TWO(R10)                                             49300019
         BE    SLASHRTN                GO TO RTN TO CHECK DASH          49400019
SLASH6   EQU   *                                                        49500019
         MVC   ONE(TWO,R1),ZERO(R10)                                    49600019
         BCTR  R7,ZERO             MAKE IT SECOND TIME AROUND SWTH19084 49700019
         B     ENDSLASH                 GO,CONTINUE PROCESS             49800019
*                                                                 19084 49900019
CSYSLG   EQU   *                                                  19084 50000019
         MVC   XUNIT1(L6),CSYSLOG      INSERT 'SYSLOG'            19084 50100019
         B     CATTRBTE                GO MOVE ATTRIBUTE          19084 50200019
*                                                                       50300019
CNONE1   EQU   *                                                        50400019
         MVC   XMSGRTCD(FOR),CNONE   INSERT NONE                        50500019
         LA    R1,XMSGRTCD+FOR       PRT PAST ROUTCDE PARM              50600019
         B     CISSUE1                 GO ISSUE MSG                     50700019
*                                                                       50800019
CRTALLL  MVC   XMSGRTCD(TRE),CALL                                       50900019
         LA    R1,XMSGRTCD+TRE                                          51000019
         EJECT                                                          51100019
*                                                                       51200019
*         REG 1 MUST PT TO THE CHARACTER AFTER LAST ROUT CODE           51300019
*                                                                       51400019
*                                                                       51500019
*********************************************************************** 51600019
*                                                                     * 51700019
*  MESSAGE ISSUING ROUTINE                                            * 51800019
*                                                                     * 51900019
*********************************************************************** 52000019
CISSUE1  EQU   *                                                        52100019
         LA    R9,XMSGHDR              ADDR OF BEGIN OF DATA LINE 21002 52450001
         SR    R1,R9                   LENGTH OF DATA LINE        21002 52460001
         STH   R1,XMSGHDR              LENGTH OF LABEL LINE       21002 52470001
         LR    R1,R5                   PTR TO WTO LIST            19084 52500019
         SR    R0,R0                                                    52600019
         TM    XAU,RI              IS THIS FROM INPUT STREAM?  @ZM30445 52630003
         BO    XAUIN               YES, DON'T INSERT CONSOLE ID@ZM30445 52660003
         IC    R0,XAU              UCM ID OF ISSUER                     52700019
XAUIN    EQU   *                                               @ZM30445 52750003
*                                                                       52800019
         WTO   MF=(E,(1))                                               52900019
         LR    R1,R5               PTR TO GOTTEN CORE             19084 53000019
         FREEMAIN R,LV=160,A=(1),SP=229                          Y02669 53100002
         BR    CRETURN             RETURN                         19084 53200019
*                                                                 19084 53300019
*********************************************************************** 65568018
*                                                                       65568218
         EJECT                                                          65572018
*                                                                       65600018
*              CONSTANT DEFINITION AREA                                 66400018
*                                                                       67200018
*                                                                       68000018
CHEADR   WTO   ('IEE349I HARDCOPY CONSOLE',C),('CONSOLE/ALT     COND   *68040001
               AUTH   ID  ROUTCD',L),('                                *68050001
                       ',DE),MF=L,DESC=(5),MCSFLAG=(QREG0,RESP)   21002 68060001
         DS    0F                                                       68120018
CRTALL   DC    X'FFFF'                 ALL CURRENT RT CODES             68180018
CALL     DC    C'ALL'              USED FOR ROUT AND AUTH               68240018
CNONE    DC    C'NONE'             USED FOR ROUT AND AUTH               68300018
CNO      DC    C'NO'               DO NOT SEPARATE THIS                 68360018
CMDS     DC    C'CMDS  '               ANY CMDS CONSTANT          21002 68474001
CIN      DC    C'IN'                   INCMDS                     21002 68476001
CST      DC    C'ST'                   STCMDS                     21002 68478001
CSYSLOG  DC    C'SYSLOG'           IF HCPY IS SYSLOG                    68480018
CFOUR    DC    H'4'                USED TO GET UCMPFX PTR               68540018
         DS    0F                                                       68600018
FOX7     DC    X'00F7'             CONSTANT FOR ROUT RTN                68660018
HONE     DC    X'0001'                 **                               68730018
*                                                                       71200018
*********************************************************************** 71220018
CTABLE   DC    C'01'               ROUT CONVERSION TABLE                71240018
         DC    C'02'                   **                               71260018
         DC    C'03'                   **                               71280018
         DC    C'04'                   **                               71300018
         DC    C'05'                   **                               71320018
         DC    C'06'                   **                               71340018
         DC    C'07'                   **                               71360018
         DC    C'08'                   **                               71380018
TAB09    DC    C'09'                   **                               71400018
         DC    C'10'                   **                               71420018
         DC    C'11'                   **                               71440018
         DC    C'12'                   **                               71460018
         DC    C'13'                   **                               71480018
         DC    C'14'                   **                               71500018
         DC    C'15'                   **                               71520018
         DC    C'16'                   **                               71530003
PATCH    DC    CL50'**IEE4103D***'                             @Z30LPTJ 71540003
*********************************************************************** 71560018
CMESSAGE DSECT                                                          71600018
CONTROL  DS    CL36                    CONTROL LINE               21002 71634001
LABEL    DS    CL44                    LABEL LINE                 21002 71636001
XMSGHDR  DS    CL4                     HEADER FOR DISPLAY LINE    21002 71638001
XTEXT    EQU   *                                                        71640018
*         MESSAGE CONFIGURATION OF  UNITS FOR 1ST WTO ISSUED            71660018
*                                                                       71680018
XUNIT1   DS    CL3                     1ST PHYSICAL UNIT ADDRESS        71700018
XBLANK   DS    CL1                     DELIMITER BETWEEN CONSOLES       71720018
XUNIT2   DS    CL3                     ADDR OF O-UNIT IF ANY            71740018
XCOMMA   DS    CL1                     DELIMITER-FOLLOWING ARE ALTCONS  71760018
XAUNIT1  DS    CL3                     1ST ADDR OF ALTCON UNIT          71780018
XBLK     DS    CL1                     DELIMITER BETWEEN ALTCONS        71800018
XAUNIT2  DS    CL3                     O-UNIT (COMPOSITE) FIELD         71820018
XMSGPAD1 DS    CL2                     BLANK AREA                       71840018
XMSGSTAT DS    CL1                     CONDITION INDICATOR              71860018
XMSGPAD2 DS    CL3                     BLANK AREA                       71880018
XMSGAUTH DS    CL1                     INDICATION BEGINNING AUTH FIELD  71900018
XMSGPAD3 DS    CL7                     BLANKS                     21002 71920001
XMSGID   DS    CL3                     CONSOLE ID                 21002 71930001
XMSGPAD4 DS    CL1                     BLANKS                     21002 71932001
XMSGRTCD DS    CL8                BEGGINIG OF ROUTE CODE FIELD          71940018
XMSGWK   DS    CL30                 ROUTE CODE WORRK AREA               71960018
         SPACE 3                                                        71980002
         EJECT                                                          72000018
UCBSET   DSECT                                                          72800018
         IEFUCBOB                                                       73600018
         EJECT                                                          74400018
CVTSET   DSECT                                                          75200018
         CVT                                                            76000018
         EJECT                                                          76800018
XSASET   DSECT                                                          77600018
         IEEXSA                                                         78400018
         EJECT                                                          94400018
UCMSET   DSECT                                                          95200018
         IEECUCM     FORMAT=NEW                                         96000002
         EJECT                                                          96050002
         IHAPSA                                                         96100002
         END                                                            96800018
./  ADD  SSI=83110946,NAME=IEE4203D
 TITLE 'IEE4203D - UCME SCANNER FOR VARY ONLINE/OFFLINE/CONSOLE'        00110003
IEE4203D CSECT                                                          00120002
* A 121900,361400-362150,363500,477700                         @YM07231 00127002
* C 046984-046986,050993-051053,191400-191700,192084-192086,   @YM07231 00134002
* C 344700,344900,439200                                       @YM07231 00141002
* C 312700                                                     @ZM30481 00144003
* D 326980-327480                                              @ZM30481 00147003
*********************************************************************** 00150002
*                                                                       00200002
* MODULE NAME      = IEE4203D                                           00250002
*   CSECT NAME     = IEE4203D                                           00300002
*                                                                       00350002
* LOAD MODULE NAME = IEE3603D                                           00400002
*                                                                       00450002
* DESCRIPTIVE NAME = UCME SCANNER FOR VARY ONLINE/OFFLINE/CONSOLE       00500002
*                                                                       00550002
* COPYRIGHT        = MISSING                                            00600002
*                                                                       00650002
* STATUS           = OS/VS/2 RELEASE 3                         @Z30LPTJ 00700003
*                                                                       00750002
* FUNCTION         = TO CONTINUE SYNTAX VALIDATION OF THE COMMAND       00800002
*                                                                       00850002
* OPERATION        = CONSOLE KEYWORD:                                   00900002
*                       . VALIDATE THAT UNIT SPECIFIED HAS A UCME       00950002
*                       . VALIDATE THAT AN O-XXX STANDS FOR AN          01000002
*                            OUTPUT ONLY UNIT                           01050002
*                       . VALIDATE THAT A (I-XXX,O-XXX) IS A VALID      01100002
*                            COMPOSITE CONSOLE UNIT                     01150002
*                       . VALIDATE THAT A XXX UNIT HAS I/O              01200002
*                            CAPABILITIES                               01250002
*                       . CHECK TO SEE IF UNIT IS CURRENTLY BUSY        01300002
*                            CHANGING STATUS                            01350002
*                       . VALIDATE THAT THE COMMAND AUTHORITY OF THE    01400002
*                            ISSUER IS 3                                01450002
*                       .VALIDATE THAT IF THE ALTCONS PARAMETER         01500002
*                            WAS USED, THAN THE ALTERNATE UNIT IS NOT   01550002
*                            SAME AS THE CONSOLE ITSELF, OR THAT AN     01600002
*                            OUTPUT ONLY UNIT IS NOT AN ALTERNATE TO    01650002
*                            AN I/O CONSOLE.                            01700002
*                       .INDICATE IF ANY CONSOLES ARE GRAPHICS          01750002
*                    ONLINE/OFFLINE KEYWORDS:                           01800002
*                       . CHECK IF CONSOLE UNIT OR REGULAR UNIT         01850002
*                            IS BEING CHANGED. THIS IS DONE BY          01900002
*                            TRYING TO FIND A UCME FOR THE UNIT         01950002
*                       . VALIDATE THAT AN O-XXX STANDS FOR AN          02050002
*                            OUTPUT ONLY UNIT                           02052002
*                       . VALIDATE THAT A (I-XXX,O-XXX) IS A VALID      02060002
*                            COMPOSITE CONSOLE UNIT                     02070002
*                       . VALIDATE THAT A XXX UNIT HAS I/O              02080002
*                            CAPABILITIES                               02090002
*                       . CHECK TO SEE IF UNIT IS CURRENTLY BUSY        02092002
*                            CHANGING STATUS                            02094002
*                       . VALIDATE THE COMMAND AUTHORITY OF THE         02144002
*                            ISSUER:                                    02194002
*                                 IF UNIT HAS UCME - MUST BE 3 -        02244002
*                                 IF UNIT DOES NOT HAVE UCME -2-        02294002
*                       . MAKE SURE THE ONLINE/OFFLINE COMMAND IS       02344002
*                            NOT FOR THE MASTER CONSOLE OF THE          02394002
*                            HARDCPY DEVICE.                            02444002
*                                                                       02494002
* NOTES                                                                 02544002
*   DEPENDENCIES   = NONE                                               02594002
*   CHARACTER/CODE DEPENDENCIES                                         02644002
*                  = THIS MODULE CAN BE ASSEMBLED WITH ANY NEW          02694002
*                    CHARACTER/CODE SET                                 02744002
*                                                                       02794002
* RESTRICTIONS     = REG2 PTS TO THE DUMMY XSA ON INPUT AND ON OUTPUT   02844002
*   REGISTER CONVENTIONS                                                02894002
*                  = REGS ARE DEFINED AT LABEL: DEFREG                  02944002
*   PATCH LABEL    = PATCH                                              02994002
*                                                                       03044002
* MODULE TYPE      = CSECT                                              03094002
*   PROCESSOR      = ASSEMBLER                                          03144002
*   MODULE SIZE    = VS/2 = '4C6'                              @ZM30481 03194003
*   ATTRIBUTES     = REENTRANT, REUSABLE, REFRESHABLE, PAGED LPA,       03244002
*                    ZERO PSW PROTECT KEY                               03294002
*                                                                       03344002
* ENTRY POINT      = IEE4203D FROM IEE3303D OR IEE2303D OR IEE4403D     03394002
*   PURPOSE        = TO CONTINUE SCANNING THE VARY CONSOLE/ONLINE/      03444002
*                    OFFLINE COMMAND FOR ERRORS                         03494002
*   LINKAGE        = BRANCH                                             03544002
*   INPUT          = REG2 PTS TO THE DUMMY XSA                          03594002
*                    XAD HAS THE FLAGS DETERMINED BY 3303D SUCH AS      03644002
*                       WHETHER MULTIPLE UNITS OR A SINGLE UNIT         03694002
*                       ARE PRESENT IN THE COMMAND                      03744002
*                    XAD+2 CONTAINS THE ISSUER COMMAND AUTHORITY        03754002
*                    XAR CONTAINS THE SIZE OF THE COMMAND BUFFER        03794002
*                    XAL PTS TO THE COMMAND PARAMETERS                  03844002
*                    XAV HAS THE VERB (VARY)                            03894002
*                    XAU HAS THE UCMID OF THE ISSUER                    03894402
*                    SAVE AREA WORD 17 CONTAINS THE CSCB PTR            03900002
*   REGISTERS SAVED= ALL                                                03904002
*   REGISTER USAGE =    R0   WTO - CONSOLE ID                           03914002
*                       R2   DUMMY XSA PTR                              03934002
*                       R3   ADDRESSABILITY                             03936002
*                       R4   UCME PTR                                   03938002
*                       R5   UCME PTR                                   03940002
*                       R7   EOB REG                                    03942002
*                       R8   PROCESS BITS                               03942102
*                       R9   UNIT PTR                                   03942402
*                       R10  UCM REG                                    03942802
*                       R11  UCMPRFX REG                                03943202
*                       R12  PROCESS BITS REG                           03943602
*                       R13  SAVE AREA PTR                              03943702
*   REGISTERS RESTORED                                                  03943902
*                  = ALL                                                03962602
*                                                                       03972602
* EXITS - NORMAL-1-  = TO IEE4903D VIA BRANCH                           03982602
*   CONDITIONS     = VARY CONSOLE COMMAND                               03992602
*   OUTPUT         = REG2 PTS TO THE DUMMY XSA                          03994602
*                    XAD HAS THE SWITCHES SUCH AS:                      03996602
*                       MULTIPLE OR SINGLE UNIT IN COMMAND              03998602
*                    AND COMMAND AUTHORITY OF ISSUER                    03998702
*                    XAR HAS THE PROCESSING BITS SHOWING:               03999002
*                       ON - PROCESS THIS UNIT                          03999402
*                       OFF- DO NOT PROCESS THIS UNIT                   03999802
*                    REG4 HAS A GRAPHICS INDICATOR                      03999902
*                    REG 13 PTR TO THE SAVE AREA                        04009902
*   RETURN CODES   = NONE                                               04033202
*                                                                       04083202
* EXITS - NORMAL-2-  = TO IEE4603D VIA BRANCH                           04093202
*   CONDITIONS     = V ONLINE/OFFLINE OF CONSOLE UNITS                  04095202
*   OUTPUT         = REG2 PTS TO THE DUMMY XSA                          04097202
*                    XAD HAS SWITCHES SUCH AS:                          04099202
*                       MULTIPLE OF SINGLE UNIT IN COMMAND              04099602
*                       WHETHER A REGULAR (I/O) UNIT IS PRESENT         04099702
*                    XAR HAS THE PROCESSING BITS SHOWING:               04099802
*                       ON - PROCESS THIS UNIT                          04099902
*                       OFF- DO NOT PROCESS THIS UNIT                   04133202
*                    REG 13 PTR TO THE SAVE AREA                        04185202
*   RETURN CODES   = NONE                                               04193202
*                                                                       04195202
* EXITS - NORMAL-3-  = TO IEE3103D VIA BRANCH                           04197202
*   CONDITIONS     = ONLINE/OFFLINE FOR ONLY I/O UNITS                  04199202
*   OUTPUT         = REG2 PTS TO THE DUMMY XSA                          04199602
*                    XAD HAS THE SWITCHES SUCH AS:                      04199702
*                       MULTIPLE OR SINGLE UNIT IN COMMAND              04199802
*                       I/O UNITS PRESENT TO PROCESS                    04199902
*                    XAR HAS THE END OF BUFFER POINTER                  04233202
*                    REG13 PTS TO THE SAVE AREA                         04293602
*   RETURN CODES   = NONE                                               04295202
*                                                                       04297202
* EXIT - NORMAL-4- = RETURN TO CALLER VIA A BR 14                       04297602
*    CONDITIONS    = WHEN NO VALID UNITS ARE LEFT IN THE CMD.           04298002
*    OUTPUT        = COMMAND WAS REJECTED AND AN ERROR MSG              04298402
*                    WAS SENT TO THE OPERATOR.                          04298802
*                    THE CSCB IS FREED VIA AN MGCR MACRO AND            04298902
*                    DUMMY XSA GOTTEN BY 3603D AND THE SAVE             04299002
*                    AREA GOTTEN BY 3603D ARE FREED.                    04299102
*    RETURN CODES  = NONE                                               04299202
*                                                                       04299303
* EXIT - NORMAL-5- = TO IEECB904 VIA BRANCH                    @Z30LPTJ 04302303
*   CONDITIONS     = WHEN NO VALID UNITS ARE LEFT IN THE       @Z30LPTJ 04305303
*                    COMMAND AND VARY RANGE IS BEING PROCESSED @Z30LPTJ 04308303
*   OUTPUT         = REGISTER 2 POINTING TO THE XSA WHICH HAS  @Z30LPTJ 04311303
*                    THE XAL POINTING TO THE VARY RANGE WORK   @Z30LPTJ 04314303
*                    AREA                                      @Z30LPTJ 04317303
*   RETURN CODES   = NONE                                      @Z30LPTJ 04320303
*                                                                       04323303
* EXITS - ERROR    = NONE, ALL ERROR CONDITIONS ARE HANDLED             04333203
*                    INTERNALLY                                         04341203
*                                                                       04349203
* EXTERNAL REFERENCES                                                   04357203
*   ROUTINES       = IEE4903D                                           04365203
*                    IEE4603D                                           04373203
*                    IEE3103D                                           04383202
*                    IEECB904                                  @Z30LPTJ 04388203
*   DATA AREAS     = SEE OUTPUT - DATA                                  04393202
*                                                                       04395202
* CONTROL BLOCKS   = 1. DUMMY EXTENDED SAVE AREA (XSA)                  04397202
*                    2. CVT                                             04399202
*                       FIELDS TESTED  - CVTCUCB                        04399602
*                       FIELDS UPDATED - NONE                           04399702
*                    2. UNIT CONTROL MODULE (UCM)                       04399802
*                       FIELDS TESTED  - UCMATR - BIT= UCMIF            04399902
*                                                       UCMOF           04433202
*                                        UCMCOMPC                       04483202
*                                        UCMDISP - BIT=UCMDISPA         04493202
*                                                       UCMDISPB        04495202
*                                                       UCMDISPC        04497202
*                                                       UCMDISPD        04499202
*                                        UCMID                          04499602
*                                        UCMUCB                         04499702
*                                        UCMVEA                         04499802
*                                        UCMVEZ                         04499902
*                       FIELDS UPDATED - NONE                           04533202
*                    3. UNIT CONTROL BLOCK (UCB)                        04583202
*                       FIELDS TESTED  - SRTESTAT - BIT = SRTEDADI      04593202
*                                        UCBNAME                        04595202
*                                        UCBFL5    - BIT =UCBNALOC      04595602
*                       FIELDS UPDATED - NONE                           04597202
*                    4. COMMAND SCHEDULING CONTROL BLOCK (CSCB)         04597602
*                       FIELDS TESTED  - NONE                           04598002
*                       FIELDS UPDATED - CHSTS - BIT= CHFC              04598402
*                                                                       04599202
* TABLES           = NONE                                               04599602
*                                                                       04599702
* MACROS           = WTO,FREEMAIN,MGCR,DEQ                              04599802
*                                                                       04599902
* MAPPING MACROS   = IEEXSA                                             04633202
*                    IEECUCM                                            04683202
*                    IEFUCBOB                                           04693202
*                    CVT                                                04695202
*                    IEECHAIN                                           04695602
*   SERIALIZATION  = NO PROTECTION FROM COMM TASK IS REQUIRED HERE      04697202
*                    THEREFORE NO LOCKS WILL BEE GOTTEN IN THIS RTN     04697602
*                    THIS MODULE HOWEVER EXECUTES PROTECTED FROM        04698002
*                    VARY/UNLOAD, ALLOCATION, AND SYSTEM       @YM07231 04698402
*                    COMPONENT VIA AN ENQ ISSUED IN IEE3603D.  @YM07231 04698602
*                    IF THIS MODULE FINDS THAT THE TOTAL COMMAND MUST   04698902
*                    BE ABORTED DUE TO AN ERROR CONDITION, BEFORE       04699002
*                    IT EXITS , IT ISSUED A DEQ AT LOC: UDEQUE          04699102
*                                                                       04699202
* CHANGE LEVEL     = Y02669, Y02651, Z30LPTJ, ZM30455, ZM30481 @ZM30481 04699603
*                                                                       04699702
* CHANGE ACTIVITY  = N/A                                                04699802
*                                                                       04699902
* MESSAGES         = 'IEE313I UNIT REF. INVALID'                        04733202
*                       WHEN AN I-UNIT OF A COMPOSITE DOES NOT HAVE     04783202
*                       INPUT CAPABILITIES.                             04793202
*                       WHEN THE UCME OF AN INPUT UNIT OF A COMPOSITE   04795202
*                       DOES NOT HAVE AN OUTPUT UCME PTR.               04797202
*                       WHEN THE OUTPUT UNIT OF A COMPOSITE AS SPECI-   04799202
*                       FIED IN THE COMMAND DOES NOT MATCH WITH THE     04799602
*                       OUTPUT UNIT SPECIFIED IN THE UCME OF THE COMP.  04799702
*                       WHEN AN OUTPUT ONLY UNIT IS NOT REALLY AN       04799802
*                       OUTPUT ONLY AS SPECIFIED BY THE UCME.           04799902
*                       WHEN AN I/O CONSOLE UNIT DOES NOT HAVE INPUT/   04833202
*                       OUTPUT CAPABILITIES AS SHOWN BY ITS UCME.       04883202
*                       WHEN THE UNIT SPECIFIED HAS NO UCME BUT THE     04893202
*                       VARY COMMAND IS A VARY CONSOLE, OR THE          04895202
*                       UNIT SPECIFICATION IS A COMPOSITE OR AN         04897202
*                       OUTPUT ONLY SPECIFICATION.                      04899202
*                       WHEN A VARY ONLINE/OFFLINE COMES IN FOR         04899602
*                       THE MASTER CONSOLE UNIT.                        04899702
*                    'IEE345I AUTHORITY INVALID'                        04915803
*                       WHEN A VARY CONSOLE IS ISSUED FROM CONSOLE      04923803
*                       WHOSE AUTHORITY IS NOT 3                        04933202
*                       WHEN A VARY ONLINE/OFFLINE IS ISSUED FROM       04983202
*                       CONSOLE WHOSE AUTHORITY IS NOT 3 OR 2           04993202
*                    'IEE299I REQ'D FOR HARDCPY'                        04995202
*                       WHEN A VARY ONLINE/OFFLINE IS ISSUED FOR A      04997202
*                       DEVICE WHICH IS THE HARDCPY LOG.                04999202
*                    ' IEE300I INVALID ALTCON'                          04999602
*                       WHEN THE ALTERNATE CONSOLE SPECIFIED            04999702
*                       DOES NOT HAVE I/O CAPABILITIES BUT THE          04999902
*                       PRIMARY CONSOLE DOES.                           05000002
*                       WHEN THE ALTERNATE CONSOLE SPECIFIED            05033202
*                       IS THE SAME AS THE PRIMARY CONSOLE.             05083202
*                    'IEE339I CHANGING STATUS'                          05093202
*                       WHEN A VARY COMMAND HAS BEEN ISSUED BUT THE     05095202
*                       DEVICE IS CHANGING FROM ITS STATE TO SOME       05097202
*                       OTHER STATE AND CANNOT BE USED NOW.             05099202
*                    'IEE329I XXX IN USE BY A SYSTEM COMPONENT'@YM07231 05099302
*                       WHEN THE DEVICE TO BE VARIED IS IN USE @YM07231 05101302
*                       BY A SYSTEM COMPONENT AND CAN NOT      @YM07231 05103302
*                       CHANGE STATUS.                         @YM07231 05105302
*                                                                       05109502
* ABEND CODES      = NONE                                               05114502
*                                                                       05119502
* PACKAGING        = IEE4203D WILL BE PART OF LOAD MODULE               05124502
*                       IEE3603D                                        05133202
*                    THIS LOAD MODULE ALIASES ARE                       05183202
*                       NONE                                            05193202
*                    THIS LOAD MODULE ENTRY POINTS ARE                  05195202
*                       IEE3603D                                        05197202
*                    MODULE WILL RESIDE IN:  LPALIB                     05197602
*                                                                       05199202
* SYSGEN           = SUPPLIED BY SECTIONS:                              05199602
*                       LOAD MODULE NAME                                05199702
*                       PACKAGING                                       05199802
*                    THIS CSECT WILL BE INCLUDED AT SYSGEN FROM         05210902
*                    DLIB -AOSB3- BY MACRO -SGIEF441-                   05220902
*                                                                       05222102
* SYSTEM LIBRARIES = NONE                                               05233202
*                                                                       05300002
*********************************************************************** 08900019
         EJECT                                                          09000019
DEFREG   EQU   *           REGISTER EQUATES                      Y02669 09100002
R0       EQU   0                   WTO-CONSOLE ID                 19084 09200019
R1       EQU   1                   INPUT AND OUTPUT-XAD           19084 09300019
R2       EQU   2                   XSA                            19084 09400019
R3       EQU   3                   ADDRESS                        19084 09500019
R4       EQU   4                   UCME                          Y02669 09600002
R5       EQU   5                   UCME PTR                      Y02669 09700002
R6       EQU   6                                                  19084 09800019
R7       EQU   7                   EOB REG                        19084 09900019
R8       EQU   8                   PROCESS BITS                  Y02669 10000002
R9       EQU   9                   UNIT PTR                       19084 10100019
R10      EQU   10                  UCM REG                        19084 10200019
R11      EQU   11                  UCMPFX REG                     19084 10300019
R12      EQU   12                  PROCESS BITS                   19084 10400019
R13      EQU   13                  SAVE AREA PTR                 Y02669 10500002
R14      EQU   14                                                       10600002
R15      EQU   15                                                 19084 10700019
*                                                                 19084 10800019
         SPACE 5                                                  19084 10900019
ZERO     EQU   0                                                  19084 11000019
ONE      EQU   1                                                  19084 11100019
TWO      EQU   2                                                  19084 11200019
TRE      EQU   3                                                  19084 11300019
FOR      EQU   4                                                  19084 11400019
FIV      EQU   5                                                  19084 11500019
SIX      EQU   6                                                  19084 11600019
SVN      EQU   7                                                  19084 11700019
EIT      EQU   8                                                  19084 11800019
ELEV     EQU   11                                                 19084 11860019
SIXTN    EQU   16                                                Y02669 11910002
TWENTY   EQU   20                                                Y02669 11920002
TWENTY2  EQU   22                                                Y02669 12010002
TWENTY4  EQU   24                                                 19084 12100019
TWENTY8  EQU   28                                              @YM07231 12190002
THIRTY1  EQU   31                                                 19084 12280019
EASY     EQU   14                      BRANCH NOT ON              21002 12330001
D64      EQU   64                                                Y02669 12350002
D132     EQU   132                                               Y02669 12360002
*                                                                 19084 12370019
         SPACE 10                                                 19084 12460019
*        CHARACTER AND HEXADECIMAL CONSTANTS                      19084 12550019
URI      EQU   X'80'                                              19084 12640019
OUNCOMP  EQU   X'06'                                              19084 12820019
RTC2     EQU   X'40'                                              19084 12910019
CA2      EQU   X'40'                                              19084 13000019
CA3      EQU   X'20'                                              19084 13090019
*                                                                 19084 13180019
SLASH    EQU   C'/'                                               19084 13270019
COMMA    EQU   C','                                               19084 13360019
VARY     EQU   C'V'                                               19084 13450019
GRPX     EQU   X'FF'                   GRAPHICS INDICATOR         21002 13500001
         EJECT                                                          13540019
*********************************************************************** 13630019
****  UCME SCANNER FOR ONLINE - OFFLINE - CONSOLE                 19084 13720019
*********************************************************************** 13810019
*                                                                 19084 13900019
*                                                                 19084 13990019
*        ADDRESSABILITY AND HOUSEKEEPING                          19084 14080019
         BALR  R3,ZERO                                            19084 14170019
         USING *,R3                                               19084 14260019
         MODID BR=YES                                            Y01886 14310001
         USING XSA,R2                                             19084 14350019
*                                                                       14400002
         STM   R0,R15,ZERO(R13)                                  Y02669 14410002
         L     R9,XAL              PTR TO PARM                    19084 14530019
         LA    R9,ZERO(R9)         CLEAR HIGH ORDER BYTE          19084 14620019
         SR    R12,R12             ZERO OUT UNIT- REG             19084 14710019
         LA    R8,ONE              TURN UNIT DETERMINING ---     Y02669 14800002
         SLL   R8,THIRTY1          REGISTER                      Y02669 14890002
*                                                                 19084 14980019
*********************************************************************** 15070019
******** START SCAN                                               19084 15160019
*********************************************************************** 15250019
*                                                                 19084 15340019
         TM    XADUSWIT,XAXPAREN   MULTIPLE UNITS              @Z30LPTJ 15430003
         BZ    UCOMP2              NO,NO XTERIOR PARENS           19084 15520019
UCOMP    LA    R9,ONE(R9)          YES, INDEX TO UNIT             19084 15610019
UCOMP2   EQU   *                                                  19084 15700019
         USING UCMLIST,R5                                         19084 15790019
         L     R11,CVTPTR          CVT PTR                        19084 15880019
         USING UCVT,R11                                           19084 15970019
         L     R10,CVTCUCB         UCM PTR                        19084 16060019
         DROP  R11                                                19084 16150019
         USING UUCB,R11                                           19084 16240019
         USING UCM,R10            XAS HAS KEY SWITCHES FROM 3303DY02669 16330002
         NI    XADUSWIT,XAXPAREN+XAUDVC  LEAVE XPAREN AND IO   @Z30LPTJ*16420003
                                           SWITCHES            @Z30LPTJ 16460003
         SR    R4,R4               COMPSOTE/NOCOMP SWITCH         19084 16510019
         CLC   ZERO(TRE,R9),UIUNIT (I- FOR COMPOSITE              19084 16600019
         BNE   UOUSCAN             NO, CHECK IF O-UNIT SPECIFIED  19084 16690019
         LA    R9,TRE(R9)          YES, INDEX TO UNIT             19084 16780019
         OI    XADUSWIT,XAIOCOMP    TURN COMP SWITCH ON        @Z30LPTJ 16870003
         BAL   R15,UCMEFND         GO GET UCME                    19084 16960019
         TM    UCMATR,UCMIF        IS THIS AN I-UNIT              19084 17050019
         BZ    UREFINV             NO, UCME NOT FOR I-UNIT        19084 17140019
         L     R4,UCMCOMPC         GET PTR TO OUTPUT COMPOSITE    19084 17230019
         LTR   R4,R4               ANY                            19084 17320019
         BZ    UREFINV             NO, NO COMPOSITE               19084 17410019
         DROP  R5                                                 19084 17500019
         USING UCMLIST,R4                                         19084 17590019
         DROP  R11                                                19084 17680019
         L     R6,UCMUCB           GET PTR TO COMPOSITE'S UCB     19084 17770019
         USING UUCB,R6                                            19084 17860019
         CLC   SIX(TRE,R9),UCBNAME IS THIS THE LOGICAL COMPOSITE  19084 17950019
         BNE   UREFINV             NO, ERROR                      19084 18040019
         DROP  R4                                                 19084 18130019
         DROP  R6                                                 19084 18220019
         USING UCMLIST,R5          ADDR TO I-UNIT UCME            19084 18310019
         USING UUCB,R11                                           19084 18400019
*                                  R5 HAS PTR TO COMP UCME        19084 18490019
UACTVCK  EQU   *                                                  19084 18580019
*                                                                 19084 18670019
** UCB  *CHECK UCB BIT HERE TO SEE IF PENDING TO CHANGE STATUS-(UCHNG)  18760019
*        IF SO ISSUE -CHANGING STATUS MSG                         19084 18850019
*                    -LEAVE PROCESS-BIT OFF                       19084 18940019
         TM    SRTESTAT,SRTEDADI   IS DEVICE CHANGING STATUS      19084 19030019
         BO    UCHNG               YES,CHANGING STATUS MESSAGE    19084 19120002
         TM    UCBFL5,UCBNALOC    DEVICE IN USE BY A SYSTEM    @YM07231*19140002
                                   SYSTEM COMPONENT?           @YM07231 19150002
         BO    COMPMSG            YES, REJECT AND ISSUE MESSAGE@YM07231 19170002
         TM    XADUSWIT,XAIOCOMP   COMP SPECIFIED              @Z30LPTJ 19190003
         BZ    CONTTST            NOPE                           Y02651 19200002
         DROP  R11                                               Y02651 19202002
         USING UUCB,R6                                           Y02651 19204002
         TM    SRTESTAT,SRTEDADI  IS THE O UNIT CHANGING STATUS  Y02651 19206002
         BO    UCHNG              YEP, NO GOOD, MESSAGE ISSUED   Y02651 19208002
         TM    UCBFL5,UCBNALOC    IS THE O-UNIT IN USE BY A    @YM07231*19208402
                                   SYSTEM COMPONENT?           @YM07231 19208502
         BO    COMPMSG            YES, REJECT AND ISSUE MESSAGE@YM07231 19208602
         DROP  R6                                                Y02651 19209202
         USING UUCB,R11                                          Y02651 19209602
CONTTST  EQU   *                                                 Y02651 19209702
         SPACE 10                                                 19084 19210019
*        IF UCB DOES NOT SHOW IT IS CHANGING                      19084 19300019
*                                                                 19084 19390019
         TM    XACAHOLD,CA3       SINCE ITS CONSOLE,CA3 REQ    @Z30LPTJ 19480003
         BZ    UAUTHINV            AUTHORITY IS INVALID           19084 19570019
         TM    XASOPCOD,XACON      CONSOLE KEYWORD             @Z30LPTJ 19660003
         BZ    UOFON               NO,ONLINE OR OFFLINE           19084 19750019
*                                  YES, CONSOLE KEY               19084 19840019
*********************************************************************** 19930019
*                                                                 19084 20020019
******** CONSOLE KEYWORD                                          19084 20110019
*                                                                 19084 20200019
*********************************************************************** 20290019
         TM    XASWITCH,XALTCHG    ALTCONS TO BE CHANGED       @Z30LPTJ 20470003
         BZ    UBITON              NO,OMIT ALTCONS VALIDATION     19084 20560019
         TM    XASOPCOD,XALTCOM    IS ALT-IS-O-UNIT SWITCH ON  @Z30LPTJ 20650003
         BZ    UCKID               NO,GO CHECK IF ALT IS SAME AS CONSL  20740019
         TM    UCMDISP,UCMDISPD    IS THIS AN OUTPUT ONLY CONSOL  19084 20830019
         BZ    UINVALTC            INVALID ALTCONS MSG            19084 20920019
UCKID    EQU   *                   YES,OK,                        19084 21010019
         CLC   UCMID(ONE),XALTPTR  ARE THE CONS AND THE ALTC EQUAL19084 21100019
         BE    UINVALTC            NO GOOD,INVALID ALTCONS MSG    19084 21190019
*                                                                 19084 21280019
UBITON   EQU   *                                                  19084 21370019
         OR    R12,R8              TURN ON PROCESS FLAG          Y02669 21460002
MOVEONE  EQU   *                                               @Z30LPTJ 21500003
         SRL   R8,ONE              SET FOR NEXT UNIT             Y02669 21550002
*                                                                 19084 21640019
UENDCK   EQU   *                                                  19084 21730019
         TM    XADUSWIT,XAIOCOMP   COMPOSITE CONSOLE SPECIFIED @Z30LPTJ 21820003
         BZ    UPARENCK            NO, FOR DELIMITER              19084 21910019
         LA    R9,SVN(R9)                                         19084 22000019
UPARENCK EQU   *                                                  19084 22090019
         LA    R9,TRE(R9)          INDEX TO DELIMITER             19084 22180019
         TM    XADUSWIT,XAXPAREN   SINGLE UNIT                 @Z30LPTJ 22270003
         BZ    UKEYEXIT            YES,CHECK KEYWORD AND GO       19084 22360019
UCOMMA   EQU   *                                                  19084 22450019
         CLI   ZERO(R9),COMMA      ANY MORE UNITS                 19084 22540019
         BE    UCOMP               YES, START NEXT UNIT           19084 22630019
UKEYEXIT  EQU  *                                                  19084 22720019
         NI    XADUSWIT,XAXPAREN+XAUDVC   CLEAR ALL BUT        @Z30LPTJ*22750003
                                     EXTERIOR  PARENTHESIS     @Z30LPTJ*22770003
                                     AND I/O DEVICE SWITCHES   @Z30LPTJ 22790003
         LA    R9,ONE(R9)                                         19084 22810019
*                                                                 19084 22900019
         ST    R12,XAR             STORE PROCESS BITS IN XAR      19084 22990019
*        R9  PTS TO LOGICAL EOB, RIGHT AT END OF UNIT FLD         19084 23170019
*                                                                 19084 23260019
         TM    XASOPCOD,XACON      CONSOLE KEYWORD             @Z30LPTJ 23350003
         BO    U49EXT              YES,GOTO 4903D                 19084 23440019
         LTR   R12,R12             ANY PROCESS BITS ON            19084 23530019
         BNZ   U46EXT              YES,OK GOTO 4603D              19084 23620019
         TM    XADUSWIT,XAUDVC      ANY IO UNITS               @Z30LPTJ 23710003
         BZ    RETEXT              NO, RETURN                    Y02669 23800002
         B     U31EXT              YES,GO TO 310OD                19084 23890019
*                                                                 19084 23980019
U46EXT   MVC   XAX(FIV),ONOFFMOD                                 Y02669 24070002
         L     R15,VCON46          GET ADDRESS OF 4603D          Y02669 24120002
         LM    R0,R14,ZERO(R13)    RESTORE REGS                  Y02669 24130002
         BR    R15                                               Y02669 24160002
*                                                                 19084 24250019
******** OUNIT SCAN                                               19084 24340019
*                                                                 19084 24430019
UOUSCAN  EQU   *                                                  19084 24520019
         CLC   ZERO(TWO,R9),UOUNIT IS IT O-XXX                    19084 24610019
         BNE   UUSCAN              NO,MUST BE REGULAR UNIT OR DTCL19084 24700019
         LA    R9,TWO(R9)          INDEX TO UNIT                  19084 24790019
         OI    XADUSWIT,XAOUNIT                                @Z30LPTJ 24880003
         BAL   R15,UCMEFND         GO GET UCME                    19084 24970019
         TM    UCMDISP,UCMDISPD    OUTPUT ONLY FLAG               19084 25060019
         BO    UACTVCK             YES,GO CHECK VALIDITY          19084 25150019
         B     UREFINV             NO, OUNIT SPEC BUT DEV IS NOT O19084 25240019
*                                                                 19084 25330019
******** UNIT SCAN                                                19084 25420019
*                                                                 19084 25510019
UUSCAN   EQU   *                                                  19084 25600019
         BAL   R15,UCMEFND         NO,REGULAR UNIT,GO GET UCME    19084 25870019
         TM    UCMATR,UCMOF+UCMIF  IO SUPPORT PRESENT             19084 25960019
         BO    UACTVCK             GO CHECK ACTIVITY              19084 26050019
         B     UREFINV             UNIT REF INVALID               19084 26140019
*********************************************************************** 26500019
*                                                                 19084 26590019
******** ROUTINE TO EXTRACT UCME FOR UNIT                         19084 26680019
*                                                                 19084 26770019
UCMEFND  EQU   *                                                  19084 26860019
         LM    R5,R7,UCMVEA        R5 PTS TO FIRST UCME          Y02669 26950002
*                                  R6 HAS SIZE OF EACH UCME      Y02669 27040002
*                                  R7 PTS TO LAST UCME           Y02669 27130002
ULOOP    L     R11,UCMUCB          GET PTR TO UCB                 19084 27220019
         CLC   ZERO(TRE,R9),UCBNAME     IS UCBNAME EQUAL TO UNITNA19084 27310019
         BE    GRAHCK              YES, CK FOR GRPX               21002 27400001
*                                                                 19084 27490019
         BXLE  R5,R6,ULOOP         NO, GO CHECK NEXT UCME         19084 27580019
*                                                                 19084 27670019
******** UCME  NOT FOUND                                          19084 27760019
         TM    XASOPCOD,XACON      CONSOLE KEYWORD             @Z30LPTJ 27940003
         BO    UREFINV                                            19084 28030019
         TM    XADUSWIT,OUNCOMP     IS O-XXX OR COMP           @Z30LPTJ 28120003
         BC    SVN,UREFINV         YES,UNIT REF INVALID           19084 28210019
         TM    XACAHOLD,CA2         COMMAND AUTH SHOULD BE 2   @Z30LPTJ 28300003
         BZ    UAUTHINV            NO, INVALID AUTH              Y02669 28390002
         OI    XADUSWIT,XAUDVC     TURN ON I/O SWITCH FOR 3103 @Z30LPTJ 28480003
         SRL   R8,ONE              OMIT PROCESS SWITCH           Y02669 28570002
         LA    R9,TRE(R9)          INDEX TO NEXT UNIT             19084 28660019
         TM    XADUSWIT,XAXPAREN  ANY MORE UNITS               @Z30LPTJ 28750003
         BZ    U31EXT              NO, GO TO 3103D                19084 28840019
         B     UCOMMA        GO TO FIND WHERE TO GO               19084 28930019
         SPACE                                                          28980001
*********************************************************************** 28990001
* IF THIS CONSOLE IS GRAPHICS SET GRAPHICS INDICATOR IN XAX.  THIS21002 29000001
* IS USED BY IEE4903D AND IEE7303D WHEN BUILDING THE CONSOLE     21002* 29010001
* MESSAGE                                                        21002* 29012001
*********************************************************************** 29014001
         SPACE                                                          29016001
GRAHCK   EQU   *                                                  21002 29018001
         TM    UCMDISP,UCMDISPC        IS THIS CONSOLE GRAPHICS   21002 29018401
         BCR   EASY,R15                NO, DON'T SET GRPX ID      21002 29018801
         MVI   XAX,GRPX                SET GRAPHICS INDICATOR     21002 29019201
         BR    R15                     RETURN TO CALLER           21002 29019601
         SPACE                                                          29019701
U31EXT   EQU   *                                                  19084 29020019
         MVC   XAX(FIV),IODEVMOD                                 Y02669 29110002
         L     R15,VCON31          GET ADDRESS OF 3103D          Y02669 29160002
         ST    R9,XAR                                             19084 29200019
         LM    R0,R14,ZERO(R13)    RESTORE ALL BUT BRANCH REG    Y02669 29250002
*                                  3103 NEEDSPTR TO EOB,-PTRTO COM19084 29290002
         BR    R15                                               Y02669 29380002
*                                                                 19084 29470019
*                                                                 19084 29560019
******** EXIT ROUTINES                                            19084 29650019
*                                                                 19084 29740019
*                                                                 19084 29830019
U49EXT   EQU   *                                                  21002 29880001
         IC    R4,XAX                  INDICATOR OF GRAPHICS      21002 29890001
         MVC   XAX(FIV),CONSMOD                                  Y02669 29920002
         LTR   R12,R12             ANY PROCESS BITS ON            19084 30010019
         BE    RETEXT              NO, RETURN                    Y02669 30100002
         L     R15,VCON49          GET ADDRESS OF 4903D          Y02669 30150002
         ST    R4,SIXTN(R13)       STORE GFX INDIC               Y02669 30150402
         LM    R0,R14,ZERO(R13)    RESTORE ALL BUT BRANCH REG    Y02669 30152002
         BR    R15                                               Y02669 30160002
*                                                                 19084 30820019
*                                                                 19084 30910019
*                                                                 19084 31000019
UOFON    EQU   *                                                  19084 31090019
         TM    UCMDISP,UCMDISPA    IS THIS MASTE CONSOLE          19084 31180019
         BO    UREFINV             YES, UNIT REF INVALID       @ZM30481 31270003
         LTR   R4,R4               COMPOSITE THERE                19084 31360019
         BZ    UHCPYCK             NO, CHECK UCME                 19084 31450019
         LR    R5,R4               GET OUNITS UCME PTR FOR TST    19084 31540019
UHCPYCK  EQU   *                                                  19084 31630019
         TM    UCMDISP,UCMDISPB    IS THIS THE HCPY DEV           19084 31720019
         BO    UREQHCPY            YES,REQ'D FOR HCPY MSG         19084 31810019
         B     UBITON              GO SET PROCESS BIT             19084 31900019
         EJECT                                                    19084 31990019
RETEXT   EQU   *                                                 Y02651 32040002
         TM    XAAVRANG,XAARNG1    VARY RANGE BEING PROCESSED? @Z30LPTJ 32040303
         BNO   PROCEED             NO, PROCEED NORMALLY        @Z30LPTJ 32040603
         L     R15,VCON904         GET IEECB904 ADDRESS        @Z30LPTJ 32040903
         BR    R15                 GO TO VARY RANGE PROCESSOR  @Z30LPTJ 32041203
PROCEED  EQU   *                                               @Z30LPTJ 32041503
         SPACE 5                                                        32042003
***************************************************              Y02651 32044002
*                                                                Y02651 32044102
*  THIS IS A TERMINAL EXIT AND THEREFORE THE ENQ ISSUED IN       Y02651 32044202
*  IN IEE3603D MUST BE DEQUEUED OFF OF                           Y02651 32044302
*                                                                Y02651 32045202
         DEQ   MF=(E,IEFDEQUE)                                   Y02651 32045602
*                                                                Y02651 32046002
***************************************************              Y02651 32047102
         SPACE 5                                                        32048003
         L     R1,D64(R13)         GET CSCB PTR                  Y02669 32050002
         USING CHAIN1,R1                                         Y02669 32060002
         OI    CHSTS,CHFC          SET TO FREE CSCB              Y02669 32070002
         MGCR  (1),CHAIN                                         Y02669 32072002
         LM    R0,R15,ZERO(R13)    RESTORE REGS                  Y02669 32074002
         LR    R4,R14              SAVE RETURN ADDRESS           Y02669 32076002
*                                  FREE SVEAREA GOTTEN IN 3603D  Y02669 32079202
         LA    R0,D132             DUMMY XSA SIZE                Y02669 32079602
         LR    R1,R2               SUMMY XSA POINTER             Y02669 32079702
         FREEMAIN R,LV=(0),A=(1)                                 Y02669 32079802
*                                  FREE DUMMY XSA GOTTEN IN 3603DY02669 32079902
         LR    R14,R4              RESTORE BRANCH REG            Y02669 32109902
         BR    R14                 RETURN                        Y02669 32119902
         EJECT                                                          32129902
*                                                                 19084 32140002
*                                                                 19084 32170019
*                                                                 19084 32260019
*        MSG  SUBROUTINE                                          19084 32350019
*                                                                 19084 32440019
*                                                                 19084 32530019
         SPACE 10                                                 19084 32620019
        DS    0F                                                 Y02651 32670002
UREFINV  EQU   *                                               @Z30LPTJ 32678003
         BAL   R15,UMSGS           GO TO MESSAGE PROCESSOR     @Z30LPTJ 32768003
UA       DC    C'313'                  MSG ID FOR UNIT REF INVALID19084 32800019
UONE     DC    C'UNIT REF INVALID    '  REQ CONSOLE,UNIT - XXX - Y02651 32890002
*                                                                 19084 32980019
UAUTHINV BAL   R15,UMSGS               **                         19084 33070019
UB       DC    C'345'              ID FOR AUTHORITY  INVALID      19084 33160019
UTWO     DC    C'AUTHORITY INVALID   ' REQ CONSOL, UNIT -V XXX-  Y02651 33250002
*                                                                 19084 33340019
UREQHCPY BAL   R15,UMSGS               **                         19084 33430019
UC       DC    C'299'                  ID FOR REQ'D FOR HARDCPY   19084 33520019
UTRE     DC    C'REQ''D FOR HARDCPY   ' REQ CONS AND MSTR,UN -XXXY02651 33610002
*                                                                 19084 33700019
UINVALTC BAL   R15,UMSGS               **                         19084 33790019
UD       DC    C'300'                  ID FOR INVALID ALTCONS     19084 33880019
UFOR     DC    C'INVALID ALTCON      ' REQ CONS, UNIT -XXX/AAA-  Y02651 33970002
*                                                                 19084 34060019
UCHNG    BAL   R15,UMSGS               **                         19084 34150019
UE       DC    C'339'                  ID FOR CHANGING STATUS     19084 34240019
UFIVE    DC    C'CHANGING STATUS     ' REQ CONS,UNT-XXX-OR-COMPO Y02651 34330002
*                                                                 19084 34420019
COMPMSG  BAL   R15,UMSGS          SYSTEM COMPONENT MESSAGE     @YM07231 34470002
UF       DC    C'329'             ID                             Y02651 34480002
USIX     DC    C'IN USE BY A SYSTEM COMPONENT'                 @YM07231 34490002
*                                                                 19084 34510019
         EJECT                                                    19084 34600019
         DS    0F                                                Y02651 34650002
UMSGS    EQU   *                                                  19084 34690019
         DROP  R11                                                19084 34780019
         SRL   R8,ONE              OMIT UNIT,SET NO PROCESS BIT  Y02669 34870002
*                                                                 19084 34960019
         MVC   XAH(FOR),UINTRO     MOVE IN MCSFLAGS AND LENGTH    19084 35050019
         L     R7,XAD              STORE XAD                      19084 35140019
         LM    R4,R6,XAS           STORE XAS IN 4,5 AND XAU IN 6  19084 35230019
         LM    R10,R11,XAE         STORE XAEXAR AND XAN-XAL       19084 35320019
         SR    R0,R0                                              19084 35410019
         TM    XAU,URI             R/I COMMAND                    19084 35500019
         BO    URDR                YES, ISSUE MSG TO MSTR CONSOLE 19084 35590019
         IC    R0,XAU              NO, GET COMS ID IN REG0 FOR WTO19084 35680019
URDR     EQU   *                                                  19084 35770019
         MVC   XAI(EIT),UBASIC     MOVE IN MSG ID                 19084 35860019
         MVC   XAF(EIT),XAI+SVN    BLANK REST OF AREA             19084 35950019
         MVC   XAI+TRE(TRE),ZERO(R15)  FILL IN MSG NUMBERS        19084 36040002
         LA    R15,TRE(R15)        INDEX TO MSG TEST              19084 36130019
         CLC   XAI+TRE(TRE),UF     IN USE BY SYSTEM COMPONENT? @YM07231 36140002
         BNE   NOSYSCOM            NO, ISSUE DIFFERENT MESSAGE @YM07231 36150002
         MVC   XAT(TWENTY8),ZERO(R15) MOVE IN MESSAGE TEXT     @YM07231 36160002
         MVC   XAT+TWENTY8(FOR),UEND MOVE IN DESCRIPTOR AND    @YM07231*36170002
                                      ROUTING CODES            @YM07231 36180002
         MVC   XAH(TWO),UINTRO8    MOVE IN LENGTH              @YM07231 36200002
         B     AROUND                                          @YM07231 36210002
NOSYSCOM EQU   *                                               @YM07231 36215002
         MVC   XAT(TWENTY),ZERO(R15)    MOVE IT IN               Y02651 36220002
         MVC   XAT+TWENTY(FOR),UEND     MOVE IN DESC AND ROUTCDS Y02651 36310002
AROUND   EQU   *                                               @YM07231 36350002
         CLC   XAI+TRE(TRE),UB     AUTHORITY INVALID              19084 36400019
         BE    UAUTH               YES,GO PROCESS                 19084 36490019
*                                                                 19084 36580019
*        MOVE UNIT                                                19084 36670019
*                                                                 19084 36760019
         MVC  XAF(TRE),ZERO(R9)   MOVE IN UNIT                    19084 36850019
         CLC   XAI+TRE(TRE),UC     REQ'D FOR HCPY                 19084 36940019
         BNE   UCONT               NO CHECK FOR OTHER MSGS        19084 37030019
         MVI   XAT+TWENTY2,RTC2      YES,MOVE ROUTCODE OF TWO    Y02651 37120002
         LR    R1,R7               NEEDED SWITCHES INTO R1        19084 37720019
         SLL   R1,FIV              SHIFT THEM TO HIGH ORDER       19084 38320019
         LTR   R1,R1               IS IT ON                       19084 38920019
         BC    ELEV,UISSUE         NO IK PROCESS AS NORMAL        19084 39520019
         MVC   XAF(TRE),SIX(R9)    MOVE IN OUTPUT UNIT            19084 39620019
         B     UISSUE              GO TO MASTER CONSOLE ALSO      19084 39720019
*                                                                 19084 39820019
UAUTH    EQU   *                                                  19084 39920019
         MVI   XAF,VARY            AUTHORITY INVALID,MOVE IN      19084 40020019
         MVC   XAF+TWO(TRE),ZERO(R9)   VARY AND UNIT              19084 40120019
         B     UISSUE              FINISHED                       19084 40220019
*                                                                 19084 40320019
UCONT    EQU   *                                                  19084 40420019
        CLC   XAI+TRE(TRE),UA     UNIT REF INVALID                19084 40520019
         BE    UCOMINV             YES,SEE IF COMP                M0128 40620001
*                                                                 19084 40720019
        CLC   XAI+TRE(TRE),UD     INVALID ALTCON                  19084 40820019
         BNE   UCHGSTTS            NO, CHANGING STATUS            19084 40920019
*                                                                 19084 41020019
         MVI   XAF+TRE,SLASH       MOVE IN SLASH TO DELIMIT ALTC  19084 41120019
         SR    R15,R15                                            19084 41320019
         LR    R14,R4              GET XAS SWITCHES INTO R14      19084 41420019
        SRDL  R14,EIT             SHIFT ALTCON ID INTO REG15      19084 41520019
         SRL   R15,TWENTY4         ITS LOW ORDER BYTE             19084 41620019
         BCTR  R15,ZERO            MINUS 1                        19084 41720019
         L     R1,CVTPTR                                          19084 41820019
         USING UCVT,R1                                            19084 41920019
         L     R1,CVTCUCB                                         19084 42020019
         DROP  R1                                                 19084 42120019
         DROP  R10                                                19084 42220019
         USING UCM,R1                                                   42320002
         L     R14,UCMVEZ          GET SIZE OF EACH UCME          19084 42420019
         MR    R14,R14             MULTIPLY SIZE BY ID            19084 42520019
         A     R15,UCMVEA          PLUS ADDR OF FIRST UCME        19084 42620019
         DROP  R5                                                 19084 42720019
         DROP  R1                                                 19084 42820019
         USING UCMLIST,R15         ADDR TO UCME OF ALTERNATE      19084 42920019
         L     R15,UCMUCB          AND ITS UCB                    19084 43020019
         DROP  R15                                                19084 43120019
         USING UCMLIST,R5                                         19084 43220019
         USING UUCB,R15                                           19084 43320019
         MVC   XAF+FOR(TRE),UCBNAME    MOVE ALTCONS UNIT NAME     19084 43420019
         DROP  R15                                                19084 43520019
         B     UISSUE              GO ISSUE MSG                   19084 43720019
*                                                                 19084 43820019
UCOMINV  EQU   *                   UNIT REF INVALID OR            M0128 43870001
UCHGSTTS EQU   *                   SYSTEM COMPONENT MESSAGE OR @YM07231 43920002
         LR    R15,R7              CHANGING STATUS MSG            19084 44020019
*                                  XAD SWITCHES INTO REG15        19084 44120019
         SLL   R15,FIV             SHIFT TO GET IOCOMP IN HIGH ORD19084 44220019
         LTR   R15,R15             IS IT ON                       19084 44320019
         BNM   UISSUE              NO, GO ISSUE MSG               19084 44420019
        MVI   XAF+TRE,COMMA       YES,MOVE IN COMMA               19084 44520019
         MVC   XAF+FOR(TRE),SIX(R9)    AND OUNITS UNIT NAME       19084 44620019
*                                                                 19084 44720019
UISSUE   EQU   *                                                  19084 44820019
*                                                                 19084 44920019
         LR    R1,R2               PTR TO WTO BUFFER              19084 45020019
MSG      EQU   *                                                 Y02651 45112002
         WTO   MF=(E,(1))              ISSUE MSG                  19084 45120019
*                                                                 19084 45220019
*                                                                 19084 45320019
*        RESTORE XSA                                              19084 45420019
*                                                                 19084 45520019
*                                                                 19084 45620019
         ST    R7,XAD                                             19084 45720019
         STM   R4,R6,XAS                                          19084 45820019
         STM   R10,R11,XAE                                        19084 45920019
         MVC   XAV(EIT),OVARY                                    Y02669 45970002
         MVC   XAX(EIT),MODNAME                                  Y02669 45980002
         B     UENDCK             GO CHECK END OF CMD             19084 46020019
*                                                                 19084 46120019
*                                                                 19084 46220019
*                                                                 19084 46320019
         EJECT                                                    19084 46420019
***************************************************              Y02651 46430002
*                                                                Y02651 46432002
*  THE LIST FORM OF THE DEQ MACRO INSTRUCTION FOLLOWS:           Y02651 46434002
*                                                                Y02651 46436002
IEFDEQUE DEQ   (IEFSQCBS,IEFQ4QCB,TWO,SYSTEM,IEFSQCBS,IEFVQCBS,SVN,    *46438002
               SYSTEM),RET=HAVE,MF=L                           @YM5443P 46438102
IEFVQCBS DC    C'VARYDEV'                                               46444102
IEFSQCBS DC    C'SYSIEFSD'                                       Y02651 46450102
IEFQ4QCB DC    C'Q4'                                             Y02651 46456102
***************************************************              Y02651 46462102
         EJECT                                                    19084 46470002
*                                                                 19084 46520019
*        DECLARES                                                 19084 46620019
*                                                                 19084 46720019
UIUNIT   DC    C'(I-'                                             19084 46820019
UOUNIT   DC    C'O-'                                              19084 46920019
IODEVMOD DC    C'IEE31'                                          Y02669 47020002
ONOFFMOD DC    C'IEE46'                                          Y02669 47120002
CONSMOD  DC    C'IEE49'                                          Y02669 47220002
         DS    0F                                                       47270002
VCON31   DC    V(IEE3103D)                                              47280002
VCON46   DC    V(IEE4603D)                                              47290002
VCON49   DC    V(IEE4903D)                                              47300002
VCON904  DC    V(IEECB904)                                     @Z30LPTJ 47305003
OVARY    DC    C'VARY    '                                       Y02669 47310002
MODNAME  DC    C'IEE4203D'                                       Y02669 47312002
         SPACE 10                                                 19084 47320019
*        DECLARES FOR MSG ROUTINE                                 19084 47420019
*                                                                 19084 47520019
*                                                                 19084 47620019
UINTRO   DC    X'0028E000'             LENGTH AND MCSFLAGS        19084 47720002
UINTRO8  DC    X'0030'             LENGTH FOR SYSTEM COMPONENT @YM07231 47770002
UBASIC   DC    C'IEE   I '             MSG ID                     19084 47820019
UEND    DC    X'08000000'             DESC AND ROUT CODES         19084 47920019
*                                                                 19084 48020019
PATCH    DC    CL60'***IEE4203D***'                              Y02669 48070002
         EJECT                                                          48700019
UXSA     DSECT                                                          48800019
         IEEXSA                                                         48900019
         EJECT                                                          55200019
UCVT     DSECT                                                          55300019
         CVT                                                            55400019
         EJECT                                                          55500019
UUCM     DSECT                                                          55600019
         IEECUCM  FORMAT=NEW                                            55700002
         EJECT                                                          55800019
UUCB     DSECT                                                          55900019
         IEFUCBOB                                                       56000019
         EJECT                                                          56050002
CHAIN1   DSECT                                                          56052002
         IEECHAIN                                                       56060002
         END                                                            56100019
./  ADD  SSI=42480742,NAME=IEE4303D
 TITLE 'IEE4303D - VARY MASTER CONSOLE COMMAND PROCESSOR'               13960003
*********************************************************************** 13970002
*                                                                       14000002
* MODULE NAME      = IEE4303D                                           14050002
*   CSECT NAME     = IEE4303D                                           14100002
*   LOAD MODULE NAME                                                    14150002
*                  = IGC0003D                                           14200002
*                                                                       14250002
* DESCRIPTIVE NAME = VARY MASTER CONSOLE COMMAND PROCESSOR              14300002
*                                                                       14350002
* COPYRIGHT        = MISSING                                            14400002
*                                                                       14450002
* STATUS           = OS/VS/2 RELEASE 3                         @Z30LPTJ 14460003
*                                                                       14470002
* FUNCTION         = THIS MODULE PROCESSES THE COMMANDS :               14480002
*                    VARY UNIT,MSTCONS AND                              14490002
*                    VARY (I-XXX,O-XXX),MSTCONS                         14492002
*                    FOR THE CONSOLE SWITCH ROUTINE IGCXLO7B            14494002
*                                                                       14496002
* OPERATION        = THIS MODULE RECEIVES CONTROL FROM THE INITIAL      14498002
*                    KEYWORD SCAN MODULE - IEE3203D.                    14498402
*                    THE UNIT CONTROL MODULE ENTRY (UCME) OF THE        14498802
*                    NAMED UNIT IS CHECKED TO ASSURE THAT THE UNIT      14499202
*                    IS A CONSOLE CAPABLE OF INPUT AND OUTPUT.          14499602
*                    IF THE COMMAND NAMES A COMPOSITE CONSOLE,          14499702
*                    INDICATED BY (I-XXX,O-XXX), THE UNITS ARE          14499802
*                    CHECKED TO ASSURE THEY ARE ACTIVE AND THAT         14499902
*                    THEY WERE SYSGENED AS A COMPOSITE CONSOLE.         14549902
*                    IF THE UNIT NAMED DOES NOT MEET THESE              14559902
*                    REQUIREMENTS THE COMMAND IS REJECTED.              14569902
*                    IF THE CONSOLE IS ACTIVE PENDING TO BE CHANGED     14579902
*                    TO AN ACTIVE STATE, THE COMMAND IS ALSO REJECTED.  14589902
*                    HOWEVER, IF THE CONSOLE IS NON-ACTIVE BUT THE      14591902
*                    UCME SHOWS A STATUS WHERE IT IS PENDING TO BE      14593902
*                    CHANGED TO THE CONSOLE STATE, THE OPERATOR IS      14595902
*                    INFORMED VIA A 'DEVICE CHANGING STATUS' MSG.       14597902
*                    PUT OUT BY IEE2103D.  THE COMMAND, THEN IS         14598302
*                    REJECTED AT THIS TIME.                             14598702
*                    THE AUTHORITY OF THE ISSUING CONSOLE IS            14599102
*                    CHECKED.  THE COMMAND IS PROCESSED IF IT IS        14599502
*                    ISSUED BY THE EXISTING MASTER CONSOLE OF THE       14599602
*                    SYSTEM.  IF THE MASTER CONSOLE ALTERNATE CHAIN     14599702
*                    IS EXHAUSTED, THE COMMAND IS ACCEPTED FROM         14599802
*                    ANY CONSOLE.                                       14649802
*                    THE MODULE THEN PASSES TO THE CONSOLE SWITCH       14659802
*                    ROUTINE A FLAG INDICATING THE CAUSE OF THE         14669802
*                    SWITCH, THE ADDRESS OF THE NEW MASTER CONSOLE      14679802
*                    UCME AND THE ADDRESS OF THE OLD MASTER             14689802
*                    CONSOLE UCME OR ZEROES IF THE COMMAND WAS          14691802
*                    ISSUED BY ANY OTHER MEANS THAT THE OLD MASTER.     14693802
*                                                                       14695802
* NOTES                                                                 14697802
*   DEPENDENCIES   = NONE                                               14698202
*   CHARACTER/CODE DEPENDENCIES                                         14698602
*                  = THIS MODULE CAN BE ASSEMBLED WITH ANY NEW          14699002
*                    CHARACTER/CODE SET.                                14699402
*                                                                       14699502
* RESTRICTIONS     = REG2 PTS TO THE XSA ON INPUT                       14699602
*   REGISTER CONVENTIONS                                                14699702
*                  = REGS ARE DEFINED AT LABEL: DEFREG                  14749702
*   PATCH LABEL    = PATCH                                              14759702
*                                                                       14769702
* MODULE TYPE      = CSECT                                              14779702
*   PROCESSOR      = ASSEMBLER                                          14789702
*   MODULE SIZE    = VS/2 = '296'                              @Z30LPTJ 14791703
*   ATTRIBUTES     = REENTRANT, REUSABLE, REFRESHABLE, PAGED LPA,       14793702
*                    ZERO PSW PROTECT KEY, SUPERVISOR MODE              14795702
*                                                                       14797702
* ENTRY POINT      = IEE4303D FROM IEE3203D                             14798102
*   PURPOSE        = TO PROCESS THE V MSTCONS COMMAND                   14798502
*   LINKAGE        = BRANCH                                             14798902
*   INPUT          = THE VARY SCAN AND ROUTER MODULE PASSES A PTR       14799302
*                    TO THE XSA IN REG2.                                14799402
*                    THE XSA CONTAINS A POINTER TO THE COMMAND          14799502
*                    OPERAND FIELD AND ALSO CONTAINS THE COMMAND        14799602
*                    VERB (V OR VARY).                                  14849602
*                    THE CVT POINTER IS LOCATED AT ADDRESS 16,          14859602
*                    THE CVT IS USED TO LOCATE THE UCM AND THE UCME'S   14869602
*                    EACH UCME CONTAINS A POINTER TO ITS UCB.           14879602
*   REGISTERS SAVED  = NONE                                             14889602
*    REGISTER USAGE= R2 PTR TO XSA                                      14891602
*                    R3 UCM PTR                                         14893602
*                    R5 CUME PTR                                        14894002
*                    R9 UNIT PTR                                        14894402
*                    R10 UCB PTR                                        14894802
*                    R13 ADDRESSABILITY                                 14895202
*                    R14 RETURN ADDRESS                                 14895302
*   REGISTERS RESTORED                                                  14895402
*                  = NONE                                               14895502
*                                                                       14945502
* EXIT - NORMAL    = RETURN                                             14955502
*   CONDITIONS     = WHEN THE COMMAND HAS BEEN EXECUTED                 14965502
*   OUTPUT         = A NEW CONSOLE IS THE MASTER CONSOLE                14975502
*   RETURN CODE    = NONE                                               14985502
*                                                                       14987502
* EXIT - ERROR     = IEE2103D OR IEE0503D VIA BRANCH                    14989502
*   CONDITIONS     = ERROR HAS BEEN DETECTED  IN THE V COMMAND          14991502
*   OUTPUT         = REG2 PTS TO THE XSA                                14993502
*                    XAE HAS APPROPRIATE MSG CODE                       14993902
*   RETURN CODES   = NONE                                               14994302
*                                                                       14994702
* EXTERNAL REFERENCES                                                   14995102
*   ROUTINES       = IEE2103D                                           14995202
*                    IEE0503D                                           14995302
*                    COMM. TASK                                         14995402
*   DATA AREAS     = FOR EXIT TO 0503D OR 2103D - SEE OUTPUT-DATA       15012102
*                    FOR COMM. TASK =                                   15022102
*                    IF THE COMMAND IS PROCESSED, THE CONSOLE SWITCH    15024102
*                    ROUTINE IS PASSED THE ADDRESS OF THE XSA           15026102
*                    IN REG1.  THE XSA CONTAINS:                        15028102
*                       PTR TO MODULE NAME                              15028502
*                       UNUSED                                          15028602
*                       NAME OF ROUTINE (IGCXLO7B)                      15028702
*                       X'00' CONSOLE SWITCH TO BE PERFORMED            15034302
*                       X'04' RESULT OF EXTERNAL INTERRUPT              15036302
*                       X'08' RESULT OF VARY MSTCONS COMMAND            15038302
*                       PTR TO NEW MASTER UCME                          15038702
*                       PTR TO COMMAND ISSUER'S UCME                    15039102
*                                                                       15039502
* CONTROL BLOCKS   = 1. EXTENDED SAVE AREA                              15039602
*                    2. UNIT CONTROL MODULE (UCM)                       15039702
*                       FIELDS TESTED  - UCMDISP - BIT=UCMDISPA         15039802
*                                        UCMCOMPC                       15054802
*                                        UCMATR - BIT=UCMOF             15064802
*                                                     UCMIF             15066802
*                                                     UCMUF             15068802
*                                        UCMMODE - BIT=UCMAMFA          15069202
*                                        UCMUCB                         15069602
*                                        UCMVEA                         15069702
*                       FIELDS UPDATED - NONE                           15069802
*                    3. UNIT CONTROL BLOCK (UCB)                        15069902
*                       FIELDS TESTED  - UCBNAME                        15074902
*                                        SRTESTAT- BIT=SRTEDADI         15076902
*                       FIELDS UPDATED - NONE                           15078902
*                    4. CVT                                             15079302
*                       FIELDS TESTED  - CVTCUCB                        15079702
*                       FIELDS UPDATED - NONE                           15079802
*                                                                       15079902
* TABLES           = NONE                                               15084902
*                                                                       15086902
* MACROS           = SVC 72,SETLOCK                                     15088902
*                                                                       15089302
* MAPPING MACROS   = IEEXSA                                             15089702
*                    IEECUCM                                            15089802
*                    IEFUCBOB                                           15089902
*                    CVT                                                15139902
*                    IHAPSA                                             15141902
*   SERIALIZATION  = TESTED FIELDS IN THE UCB AND THE UCM WILL BE       15149902
*                    PROTECTED BY THE CMS AND LOCAL LOCKS               15151902
*                    AGAINST COMM TASK AND ANOTHER VARY COMMAND         15152302
*                    LOCKS ARE GOTTEN AT:                               15153902
*                         MSETLCK                                       15155902
*                    LOCKS ARE RELEASED AT:                             15157902
*                         MUNSTLK                                       15158302
*                    FIELDS PROTECTED ARE:                              15158702
*                         UCMMODE - BIT = UCMAMFA  -UCM                 15159102
*                         UCMATR  - BIT = UCMUF    -UCM                 15159502
*                         UCMDISP - BIT = UCMDISPA -UCM                 15161102
*                                                                       15164902
*                         SRTESTAT- BIT = SRTEDADI -UCB                 15166502
*                                                                       15184102
* CHANGE LEVEL     = Y02669, Y02651, Z30LPTJ                   @Z30LPTJ 15185703
*                                                                       15187302
* CHANGE ACTIVITY  = N/A                                                15188902
*                                                                       15190502
* MESSAGES         = TO IEE0503D FOR ERROR MESSAGES:                    15192102
*                       IEE307I VARY DELIMITER ERROR                    15193702
*                       (ISSUED WHEN THE SYNTAX OF THE UNIT FIELD       15195302
*                       IS NOT CORRECT)                                 15196902
*                       IEE313I XXX UNIT REF INVALID                    15198502
*                       (ISSUED WHEN UNIT CANNOT BECOME THE             15200102
*                       MASTER CONSOLE)                                 15201702
*                    TO IEE2103D FOR ERROR MESSAGES:                    15203302
*                       IEE345I VARY AUTHORITY INVALID                  15204902
*                       (ISSUED WHEN THE COMMANDS SOURCE CONSOLE        15206502
*                       DOES NOT HAVE THE COMMAND AUTHORITY TO          15216502
*                       VARY A MASTER CONSOLE.)                         15218502
*                                                                       15220502
* ABEND CODES      = NONE                                               15222502
*                                                                       15222902
* PACKAGING        = IEE4303D WILL BE PART OF LOAD MODULE               15223002
*                    = IGC0003D                                         15223102
*                    THIS LOAD MODULE ALIASES ARE                       15228702
*                    = NONE                                             15230702
*                    THIS LOAD MODULE ENTRY POINTS ARE                  15232702
*                    = IGC0003D                                         15233102
*                      MODULE WILL RESIDE IN : LPALIB                   15233202
*                                                                       15233502
* SYSGEN           = SUPPLIED BY SECTIONS:                              15233902
*                       LOAD MODULE NAME                                15234002
*                       PACKAGING                                       15234102
*                       THIS CSECT WILL BE INCLUDED AT SYSGEN FROM      15238702
*                       DLIB -AOSB3- BY MACRO -SGIEF441-                15240702
*                                                                       15243502
* SYSTEM LIBRARIES = NONE                                               15248102
*                                                                       15258102
*********************************************************************** 15260102
         EJECT                                                          15260202
*********************************************************************** 15260502
*  COMMAND TO BE PROCESSED IS:                                          15261902
*                                                                       15265902
*    ***           ***                                                  15267902
*    *               *                                                  15269902
*    * XXX           *                                                  15270302
*  V *               *,MSTCONS                                          15270702
*    * (I-XXX,O-XXX) *                                                  15271102
*    *               *                                                  15271602
*    ***           ***                                                  15272902
*********************************************************************** 15273402
         EJECT                                                          15275202
IEE4303D CSECT                                                          15279202
DEFREG   EQU   *                                                 Y02669 15283202
*                                                                       15287202
R0       EQU   0                                                        15291202
R1       EQU   1                                                        15295202
MXSABASE EQU   2         XSA PTR                                        15299202
R2       EQU   2                                                        15303202
UCMBASE  EQU   3         UCM PTR                                 Y02669 15307202
R4       EQU   4                                                 Y02669 15311202
R5       EQU   5       UCME PTR                                  Y02669 15315202
R6       EQU   6                                                        15319202
R7       EQU   7                                                        15323202
R8       EQU   8                                                        15327202
R9       EQU   9       UNIT PTR                                         15331202
R10      EQU   10      UCB PTR                                          15335202
R11      EQU   11                                                       15345202
R12      EQU   12                                                       15355202
MBASE    EQU   13      ADDRESSABILITY                            Y02669 15365202
MRETURN  EQU   14      RETURN ADDRESS                            Y02669 15375202
R14      EQU   14                                                Y02651 15375602
R15      EQU   15                                                       15377202
*                                                                       15379202
*                                                                       15381202
*  TESTING AND BIT SETTING MASKS                                        15383202
*                                                                       15383602
MRI      EQU   X'80'                   READER/INTERPRETER ID            15385202
MSYS     EQU   0                       SYSTEM ID                        15435202
VARMST   EQU   X'08'                                                    15485202
CD44     EQU   44                                                 19084 17900019
*                                                                       18300019
* ERROR MESSAGE CODES                                                   18700019
*                                                                       19100019
ER1      EQU   41                      AUTHORITY INVALID                19500019
ER2      EQU   7                       DELIMITER ERROR                  19900019
ER3      EQU   13                      UNIT REF INVALID                 20300019
*                                                                       21100019
ZERO     EQU   0                                                        21500019
ONE      EQU   1                                                        21900019
TWO      EQU   2                                                        22300019
TRE      EQU   3                                                        22700019
FOR      EQU   4                                                        23100019
SIX      EQU   6                                                        23500019
EIT      EQU   8                                                        23900019
ELEV     EQU   11                                                       24700019
TWLV     EQU   12                                                       25100019
EITN     EQU   18                                                 M0676 25150001
LPAREN   EQU   C'('                                                     25900019
COMMA    EQU   C','                                                     26700019
BLANK    EQU   C' '                                                     27100019
SVCSVN2  EQU   72                                                       27500019
         EJECT                                                          27550002
*********************************************************************** 27900019
*                                                                       28300019
*        START OF THE ROUTINE                                           28350002
*                                                                       28700019
*********************************************************************** 29100019
         BALR  MBASE,ZERO                 ESTABLISH PROGRAM ADDRESS     29500019
         USING *,MBASE                                                  29900019
         MODID BR=YES                                            Y01886 29950001
         USING XSA,MXSABASE            SAVE AREA ADDRESSIBILITY         30300019
         L     R5,CVTPTR               POINTER TO CVT USED              30700019
         USING USETCVT,R5              USE CVT TO PT.TO UCB INFO        31100019
         L     UCMBASE,CVTCUCB         ..                               31500019
         LR    R8,UCMBASE              SAVE UCM BASE ADDRESS   @YM02762 31700002
         DROP  R5                      CVT NO LONGER NEEDED             31900019
         USING UCM,UCMBASE             UCM ADDRESSIBILITY        Y02669 32300002
*********************************************************************** 32700019
*                                                                     * 33100019
* COMMAND AUTHORITY VERIFICATION                                      * 33500019
*                                                                     * 33900019
*********************************************************************** 34300019
           SPACE 10                                                     34350002
*****************************************************************Y02651 34360002
*                                                                Y02651 34362002
*  LOCKS ARE SET HERE USING SUBROUTINE:                          Y02651 34364002
*              MSETLCK                                           Y02651 34366002
*  LOCKS WILL BE RELEASED WHEN NO NEEDED AT:                     Y02651 34368002
*              MUNSTLK                                           Y02651 34368402
*                                                                Y02651 34368802
         BAL   R4,MSETLCK         GO GET LOCKS FOR UCB AND UCM   Y02651 34369202
*                                                                Y02651 34369602
*****************************************************************Y02651 34370002
           SPACE 10                                                     34400002
         L     R9,XAL              UNIT PTR                       19084 34700019
         LA    R9,ZERO(R9)                                        19084 35100019
         XC    XAL(FOR),XAL              ISSUING CONSOLE PTR IN PARM    35500019
         CLI   XAU,MSYS                IF ISSUING SYSTEM-OK             35900019
         BE    MPROCESS                GO PROCESS UNIT                  36300019
         CLI   XAU,MRI                 READER/INTERPRETER ONLY ALLOWED  36700019
         BE    MCHAIN                  IF CHAIN EXHAUSTED-GO CHECK      37100019
*                                                                       37500019
         SR    R11,R11                  IS COMMAND FROM MASTER CONSOLE  37900019
         IC    R11,XAU                 USE ALGORITHUM TO ACCESS UCME    38300019
         LM    R6,R7,UCMVEA            R6 PTS TO FIRST UCM ENTRY        38700019
*                                      R7 CONTAINS SIZE OF ENTRY        39100019
         BCTR  R11,ZERO                   REF. INTO UCME'S              39500019
         MR    R10,R7                  LENGTH 1 ENTRY                   39900019
         AR    R11,R6                  ADD ADDR OF 1ST ENTRY            40300019
         ST    R11,XAL                 SAVE ADR IN PARM LIST            40700019
         USING UCMLIST,R11             REFERENCE TO ISSUER'S UCME       41100019
         TM    UCMDISP,UCMDISPA        WAS ISSUER MASTER CONSOLE Y02669 41500002
         BO    MPROCESS                YES,PROCESS UNIT SPECIFIED       41900019
MCHAIN   EQU   *                                                        41950002
         TM    UCMMODE,UCMAMFA         IF CHAIN NOT EXHAUSTED    Y02669 42300002
         DROP  R11                                                      42700019
         BO    MPROCESS                PROCESS UNIT              Y02669 43100002
         SPACE 10                                                       43150002
*****************************************************************Y02651 43160002
*                                                                Y02651 43162002
*  RELEASE LOCKS HERE.                                           Y02651 43164002
*  EXIT BECAUSE OF ERRORS                                        Y02651 43166002
*                                                                Y02651 43168002
         BAL   R4,MUNSTLK         GO RELEASE THE LOCKS           Y02651 43168402
*                                                                Y02651 43168802
*****************************************************************Y02651 43170002
         SPACE 10                                                       43200002
         B     ERR1                                              Y02651 43250002
         EJECT                                                          43300002
*********************************************************************** 43500019
*                                                                     * 43900019
* UNIT SYNTAX AND VALIDITY CHECK                                      * 44300019
*                                                                     * 44700019
*********************************************************************** 45100019
MPROCESS EQU   *                                                        45500019
         XC    XAD(FOR),XAD        ASSUME NON-COMPOSITE UNIT            45900019
         CLI   ZERO(R9),LPAREN          IS COMPOSITE SPGCIFIED    19084 46300019
         BE    MRTPAR                  YES,GO PROCESS             19084 46700019
         CLI   TRE(R9),COMMA            IF NOT COMPOSITE, TEST FOR19084 47100019
         BNE   ERR2                    DELIMITER ERROR,IF NOT     19084 47500019
         BAL   R1,MCHECK               CHECK FOR VALID UNIT       19084 47900019
         USING UCMLIST,R5               VALID,HAS CORRECT SUPPORT 19084 48300019
         TM    UCMATR,UCMOF+UCMIF       HAS I/O SUPPORT          Y02669 48700002
         BO    MKEYCHK                 UNIT OK,CHECK KEYWORD      M4449 49100019
         SPACE 10                                                       49150002
*****************************************************************Y02651 49200002
*                                                                Y02651 49210002
*  ERROR CONDITION, RELEASE LOCKS FIRST AND THEN ISSUE ERROR MSG Y02651 49220002
*  LOCKS WILL BE RELEASED AT: MUNSTLK                            Y02651 49230002
*  LOCKS WERE SET AT:                                            Y02651 49240002
*              MSETLCK                                           Y02651 49242002
*                                                                Y02651 49244002
         LA    R4,ERR3            ERROR MSG ROUTINE AFTER RELEASEY02651 49246002
         B     MUNSTLK            GO RELEASE ALL LOCKS           Y02651 49248002
*                                                                Y02651 49248402
*****************************************************************Y02651 49250002
         EJECT                                                          49300002
*                                                                 19084 49900019
* COMPOSITE UNIT VERIFICATION CHECK                               19084 50300019
*                                                                 19084 50700019
MRTPAR   EQU   *                                                  19084 51100019
         OI    XADUSWIT,XAIOCOMP        UNIT IS COMPOSITE      @Z30LPTJ 51500003
         CLC   ONE(TWO,R9),MIUNT        I-XXX SPECIFIED PROPERLY  19084 51900019
         BNE   ERR2                    NO,ERROR                   19084 52300019
         CLC   SIX(TRE,R9),MOUNIT       O-XXX SPECIFIED PROPERLY  19084 52700019
         BNE   ERR2                    NO,ERROR                         53100019
         CLC   TWLV(TWO,R9),CMARTPN    IS ), PRESENT              19084 53500019
         BNE   ERR2                    NO,ERROR                         53900019
         LA    R9,TRE(R9)                PTR TO FIRST CHAR OF I-UN19084 54300019
         BAL   R1,MCHECK               CHECK FOR VALID I-UNIT     19084 54700019
         TM    UCMATR,UCMIF             HAS INPUT SUPPORT        Y02669 55100002
         BZ    ERR31                   NO,ERROR                   M0128 55500001
         L     R11,UCMCOMPC             GET PTR TO COMP UCME      M0128 55550001
         LA     R11,ZERO(R11)           CLEAR HIGH ORDER BYTE     M0128 55560001
         LTR   R11,R11                  WAS I-UNIT A VALID COMP   M0128 55600001
         BZ    ERR31                    NO,UNIT REF WAS NOT VALID M0128 55650001
         DROP  R5                                                 M0128 55700001
         USING UCMLIST,R11              ADDRESSABILTY O-UNT UCME  M0128 55750001
         L     R10,UCMUCB               GET PTR TO O-UNT UCB      M0128 55800001
         USING UCB,R10                  ADDRESSABILITY O-UNT UCB  M0128 55850001
         CLC   SIX(TRE,R9),UCBNAME      IS SPEC O-UNT THE LOG COM M0128 55900001
         BNE   ERR31                    NO,UNIT REF WAS NOT VALID M0128 55950001
         CLI   EITN(R9),BLANK           BLANK FOLLOWS KEYWORD     M0128 56000001
         BNE   ERR2                     NO,DELIMETER ERROR        M0128 56050001
         TM    UCMATR,UCMUF             IS O-UNIT ACTIVE          M0676 56100001
         BZ    MNACTIVE                 NO,SEE IF PENDING CHANGE  M0676 56150001
         TM    SRTESTAT,SRTEDADI        IS IT CHNGING TO NONACTIVEM0676 56200001
         BO    ERR31        ERROR, CHANGING STATUS AND THEREFORE Y02669 56250002
*                           CANNOT BECOME THE MASTER CONSOLE     Y02669 56300002
         B     MPARMSET                 GO CHECK I-UNIT           M0676 56350002
         EJECT                                                          56352002
MNACTIVE EQU   *                                                  M0676 56360001
         TM    SRTESTAT,SRTEDADI        IS IT CHNGING TO ACTIVE   M0676 56400001
         BO    ERR4                     CHANGING STATUS MSG       M0676 56450001
         B     ERR31                    NO,INVALID UNIT REF       M0676 56500001
         DROP  R11,R10                                            M0676 56550001
         EJECT                                                          56600002
MKEYCHK  EQU   *                                                  M4449 59260019
         USING UCMLIST,R5               ADDRESSABLTY FOR UNIT CK  M0676 59310001
         CLI   ELEV(R9),BLANK          BLANK FLOOWS KEYWORD       M4449 59340019
         BNE   ERR2                    NO, DELIMITER ERROR        M4449 59420019
         EJECT                                                          59470002
*                                                                       59500019
* PARAMETER LIST FOR SVC 72                                             59900019
*                                                                       60300019
MPARMSET ST    R5,XAR                  PTR TO NEW MSTCONS UCME          60700019
         TM    UCMATR,UCMUF        ACTIVE BIT ON                  19084 60900019
         L     R5,UCMUCB                                          19084 61100019
         USING UCB,R5                                             19084 61500019
         BO    MACTIVE             YES,GO CHECK IF PENDING TO CHNG19084 62300019
         TM    SRTESTAT,SRTEDADI   IS NONACTIVE,IS IT PENDING     19084 62700019
         BZ    ERR31               NO, PURELY NON ACTIVE, NO GOOD 19084 63100019
         B     ERR4                YES, PENDING,CHANGING STATUSMSG19084 63500019
*                                                                 19084 63900019
MACTIVE  EQU   *                                                  19084 64300019
         TM    SRTESTAT,SRTEDADI   PENDING TO CHANGE TO NONACTIVEY02669 64700002
         BO    ERR31               ERR,CHNGING STATS ,THEREFORE  Y02669 65700002
*                                  CANNOT BECOME THE MASTER CONSOLE     65750002
         SPACE 10                                                       65800002
*****************************************************************Y02651 65850002
*                                                                Y02651 65860002
*  FINISHED WITH OUR PROCESSING, AND SVC 72 WILL SOON BE ISSUED  Y02651 65870002
*  MUST RELEASE ALL LOCKS GOTTEN ON ENTRY TO THIS MODULE.        Y02651 65880002
*  LOCKS WERE OBTAINED AT:                                       Y02651 65890002
*     MSETLCK                                                    Y02651 65892002
*                                                                Y02651 65894002
         BAL   R4,MUNSTLK                                        Y02651 65896002
*                                                                Y02651 65898002
*****************************************************************Y02651 65900002
         SPACE 10                                                       65950002
         ST    R8,XAN                 INSERT UCM BASE ADDRESS  @YM02762 66150002
*                                     INTO PARAMETER LIST               66350002
         MVI   XAE,VARMST             SWITCH RESULT VARY MSTCONS        66700002
         MVC   XAX(EIT),MSWTRTN       NAME OF SWITCH RTN                67300002
         LA    R5,XAX                                                   67900018
         ST    R5,XAP                                                   68500018
         LR    R1,R5                  LOAD PTR TO NAME                  69100002
         SVC   SVCSVN2                                                  69700018
         BR    MRETURN                 RETURN                           70300018
         EJECT                                                          70350002
*                                                                       70900018
*********************************************************************** 71500018
*                                                                       72100018
* PHYSICAL UNIT ADDRESS VALIDITY CHECK                                  72700018
*                                                                       73300018
*********************************************************************** 73900018
* ON ENTRY REGISTER 8 POINTS TO FIRST CHARACTER OF UNIT NAME            74500018
MCHECK   LM    R5,R7,UCMVEA            R5 CONTAINS PTR 1ST UCME         75100018
*                                      R6 CONTAINS SIZE UCMES           75700018
*                                      R7 CONTAINS ADDR. OF LAST        76300018
         USING UCMLIST,R5              REFERENCE TO UCME                76900018
MLOOP    L     R10,UCMUCB              PTR TO ASSOCIATED UCB            77500018
         USING UCB,R10                 ..                               78100018
         CLC   ZERO(TRE,R9),UCBNAME         COMPARE PHYSICAL UNIT ADDR  78700019
         BE    MFND                    FOUND,UNIT HAS UCME        19874 79300019
         BXLE  R5,R6,MLOOP             NO,CONTINUE SEARCH         19874 79900019
         B     ERR31                   NOT FOUND,ERROR            M0128 80500001
         DROP  R5,R10                                             19874 81100019
MFND     BR    R1                      RETURN                     19874 81700019
* ON RETURN, REGISTER 5 CONTAINS ADDRESS OF UNITS UCME            19874 82300019
*                                                                 19874 82900019
         EJECT                                                          82950002
*********************************************************************** 83500019
*                                                                 19084 84100019
*  THE FOLLOWING SECTION PASSES A ERROR MESSAGE CODE TO EITHER OF THE   84700019
*  MESSAGE WRITING MODULES IGC0503D OR IGG2103D. THE CODE IS PLACED IN  85300019
*  THE XSA AT XAE.  THE SOURCE TEXT IS PLACED IN THE XSA AT XAV.  19084 85900019
*********************************************************************** 86500019
*                                                                 19084 86800019
ERR1     EQU   *                                                        86850002
         BAL   R5,ERLINK1              MSG MOD IS 2103D           19084 87100002
         DC    AL1(ER1)                ERROR CODE IS 41           19084 87400019
*                                                                 19084 87700019
         DS    0H                                                Y02651 87710002
ERR2     EQU   *                                                 Y02651 87750002
         SPACE 5                                                        87800002
***************************************************              Y02651 87850002
*                                                                Y02651 87860002
*  THIS IS AN ERROR EXIT, LOCKS OBTAINED AT:                     Y02651 87870002
*       MSETLCK                                                  Y02651 87880002
*  MUST BE RELEASED HERE                                         Y02651 87890002
*                                                                Y02651 87892002
         BAL   R4,MUNSTLK                                        Y02651 87894002
*                                                                Y02651 87896002
***************************************************              Y02651 87900002
         SPACE 5                                                        87950002
         BAL   R5,ERLINK               MSG MOD IS 0503D           19084 88000002
         DC    AL1(ER2)                ERROR CODE IS 7            19084 88300019
*                                                                 19084 88600019
ERR3     DS    0F                                                 19084 88670019
         MVI   XAV+TRE,BLANK       PAD WITH BLANKS                19084 88740019
ERR32    EQU   *                                                  19084 88810019
         MVC   XAV(TRE),ZERO(R9)                                  19084 88910019
         BAL   R5,ERLINK               MSG MOD IS 0503D                 89500019
         DC    AL1(ER3)                ERROR CODE IS 13                 89800019
*                                                                       90100019
         DS    0H                                                Y02651 90102002
ERR31    EQU   *                                                 Y02651 90110002
         SPACE 5                                                        90120002
***************************************************              Y02651 90122002
*                                                                Y02651 90122402
*  THIS IS AN ERROR EXIT, LOCKS OBTAINED AT:                     Y02651 90122802
*       MSETLCK                                                  Y02651 90123202
*  MUST BE RELEASED HERE                                         Y02651 90123602
*                                                                Y02651 90123702
         BAL   R4,MUNSTLK                                        Y02651 90123802
*                                                                Y02651 90123902
***************************************************              Y02651 90124002
         SPACE 5                                                        90126002
         TM    XADUSWIT,XAIOCOMP   COMPOSITE CONSOLE?          @Z30LPTJ 90130003
         BZ    ERR3                NO                             19084 90160019
         MVI   XAV+TRE,COMMA       MOVE IN DELIMITER              19084 90250019
         MVC   XAV+FOR(TRE),SIX(R9)    MOVE IN O-UNIT             19084 90280019
         B     ERR32               GO MOVE IN I-UNIT              19084 90310019
*                                                                 19084 90340019
ERR4     DS    0F                                                Y02651 90400002
         SPACE 5                                                        90450002
***************************************************              Y02651 90460002
*                                                                Y02651 90462002
*  THIS IS AN ERROR EXIT, LOCKS OBTAINED AT:                     Y02651 90464002
*       MSETLCK                                                  Y02651 90466002
*  MUST BE RELEASED HERE                                         Y02651 90468002
*                                                                Y02651 90468402
         BAL   R4,MUNSTLK                                        Y02651 90468802
*                                                                Y02651 90469202
***************************************************              Y02651 90470002
         SPACE 5                                                        90500002
         MVI   XAV+TRE,BLANK       BLANK AREA                     19084 91400019
         TM    XADUSWIT,XAIOCOMP   WAS IT A COMPOSITE?         @Z30LPTJ 92542403
         BZ    M1UNT               NO, SINGLE UNIT                      92543118
         MVI   XAV+TRE,COMMA       MOVE IN DELIMITER              19084 92551819
         MVC   XAV+FOR(TRE),SIX(R9)    MOVE IN O-UNIT             19084 92553819
M1UNT    EQU   *                                                        92555819
         MVC   XAV(TRE),ZERO(R9)   MOVE IN UNITNAME INTO MSG      19084 92561819
*                                                                 19084 92591819
MMSG     EQU   *                                                  19084 92597819
         BAL   R5,ERLINK1          GO TO ERROR ROUTINE            19084 92603819
         DC    AL1(CD44)           CHAANGING STATUS MSG           19084 92609819
ERLINK   MVC   XAX(EIT),ERMOD1           ERROR MSGE MODULE NAM   Y02669 92615802
         L     R15,VCON05         GET ADDRESS OF 0503D           Y02669 92617802
         B     MERGO                   EXIT RTN                  Y02669 92621802
ERLINK1  EQU   *                                                        92627819
         MVC   XAX(EIT),ERMOD2                                   Y02669 92633802
         L     R15,VCON21         GET ADDRESS OF 2103D           Y02669 92635802
MERGO    MVC   XAE(ONE),ZERO(R5)            INSERT ERROR CODE IN XSA    92639819
         BR    R15                EXIT                           Y02669 92649802
*                                                                       92681819
         EJECT                                                          92683802
*****************************************************************Y02651 92684202
*                                                                Y02651 92684302
*  SUBROUTINE WHICH OBTAINS AND RELEASES REQUIRED LOCKS          Y02651 92684402
*                                                                Y02651 92684502
MSETLCK  EQU   *                                                 Y02651 92688802
         STM   R11,R14,XASAVLOC                                  Y02651 92689202
         SETLOCK OBTAIN,TYPE=LOCAL,MODE=UNCOND,                  Y02651*92690802
               RELATED=(IEE4303D(MUNSTLK))                       Y02651 92693202
         SETLOCK OBTAIN,TYPE=CMS,MODE=UNCOND,                    Y02651*92693302
               RELATED=(IEE4303D(MUNSTLK))                       Y02651 92693402
         LM    R11,R14,XASAVLOC                                  Y02651 92693502
         BR    R4                                                Y02651 92693602
*                                                                Y02651 92693702
         SPACE 5                                                 Y02651 92693802
*                                                                Y02651 92695202
MUNSTLK  EQU   *                                                 Y02651 92697202
         STM   R11,R14,XASAVLOC                                  Y02651 92697302
         SETLOCK RELEASE,TYPE=CMS,RELATED=(IEE4303D(MSETLCK))    Y02651 92697602
         SETLOCK RELEASE,TYPE=LOCAL,RELATED=(IEE4303D(MSETLCK))  Y02651 92698002
         LM    R11,R14,XASAVLOC                                  Y02651 92699102
         BR    R4                                                Y02651 92701402
*                                                                Y02651 92702502
*****************************************************************Y02651 92703602
         EJECT                                                          92704702
*****************************************************************       92705802
*                                                                       92706502
MIUNT    DC    C'I-'                   I-XXX SPECIFICATION              92710802
MOUNIT   DC    C',O-'                  0-XXX SPECIFICATION              92715102
CMARTPN  DC    C'),'               PAREN, AFTER COMPOSITE         19084 92719402
MSWTRTN  DC    C'IGC0407B'             CONSOLE SWITCH RTN      @YM02762 92723702
ERMOD1   DC    C'IEE0503D'             ERROR MSG MODULE          Y02669 92728002
ERMOD2   DC    C'IEE2103D'             ERROR MSG MODULE          Y02669 92778002
         DS    0F                                                Y02669 92828002
VCON21   DC    V(IEE2103D)                                       Y02669 92838002
VCON05   DC    V(IEE0503D)                                       Y02669 92838402
         SPACE 5                                                        92838802
PATCH    DC    CL50'***IEE4303D***'                            @Z30LPTJ 92839203
        EJECT                                                           92939203
UCB      DSECT                                                          93100018
         IEFUCBOB                                                       93800018
         EJECT                                                          94100018
USETCVT  DSECT                                                          94500018
         CVT      SYS=VMS                                               95200018
         EJECT                                                          95500018
XSADSECT DSECT                                                          95900018
         IEEXSA                                                         96600018
         EJECT                                                          96900018
UUCM     DSECT                                                          97300018
         IEECUCM    FORMAT=NEW                                          98000002
         EJECT                                                          98050002
         IHAPSA                                                         98100002
         END                                                            98700018
./  ADD  SSI=83110947,NAME=IEE4403D
 TITLE 'IEE4403D - KEYWORD SCANNER FOR VARY'                            11752003
IEE4403D CSECT                                                          11754002
* A (K2      ) APPROX 438000  (KK2     ) APPROX 445000         @ZA12703 11757703
* A (KPAR3   ) APPROX 485000                                   @ZA12703 11758203
* D (K2      ) APPROX 433000  (KPAR9   ) APPROX 512000         @ZA12703 11758703
*********************************************************************** 11760002
* MODULE NAME      = IEE4403D                                           11762002
*   CSECT NAME     = IEE4403D                                           11764002
*                                                                       11766002
* LOAD MODULE NAME = IEE3603D                                           11768002
*                                                                       11768402
* DESCRIPTIVE NAME = KEYWORD SCANNER FOR VARY                           11768802
*                                                                       11769202
* COPYRIGHT        = MISSING                                            11769602
*                                                                       11769702
* STATUS           = OS/VS/2 RELEASE 3 PTF UZ05997             @ZA12703 11769803
*                                                                       11769902
* FUNCTION         =THIS MODULE CONTINUES TO SCAN OF THE COMMAND        11779902
*                    INPUT BUFFER. IT DETERMINES THE VALIDITY OF        11789902
*                    THE KEYWORD VALUES OF THE VARY COMMAND AND         11793202
*                    SETS APPROPRIATE BITS IN THE XSA (DUMMY XSA)       11795202
*                    BEFORE PASSING CONTROL TO THE SECOND OPERAND       11795602
*                    PROCESSOR ROUTINE = IEE4203D                       11796002
*                                                                       11796402
* OPERATION        = THIS MODULE SCANS FOR THE CORRECT KEYWORDS AND     11796502
*                    TESTS THE VALIDITY OF THEIR VALUES.  IF ANY OF     11796602
*                    THE KEYWORDS OR THEIR VALUES ARE WRONG, THE        11846602
*                    COMMAND IS IGNORED AND AN ERROR MESSAGE IS         11856602
*                    RETURNED.                                          11866602
*                    IF A KEYWORD IS NOT PRESENT, ITS FIELD IN THE      11876602
*                    XAS CONTAINS ZEROES.                               11886602
*                    KEYWORDS CHECKED FOR ARE:                          11888602
*                       AUTH=                                           11890602
*                       ROUT=                                           11892602
*                       ALTCONS=                                        11894602
*                                                                       11895002
* NOTES                                                                 11895402
*   DEPENDENCIES   = NONE                                               11895802
*   CHARACTER/CODE DEPENDENCIES                                         11896202
*                  = THIS MODULE IS DEPENDENT ON THE EBCDIC             11896302
*                   REPRESENTATION OF DECIMAL CHARACTERS                11904802
*                                                                       11909002
* RESTRICTIONS     = SEE ENTRY POINTS - INPUT DATA                      11913202
*   REGISTER CONVENTIONS                                                11923202
*                  = REGISTERS ARE DEFINED AT LABEL: DEFREG             11925202
*   PATCH LABEL    = PATCH                                              11927202
*                                                                       11929202
* MODULE TYPE      = CSECT                                              11929602
*   PROCESSOR      = ASSEMBLER                                          11929702
*   MODULE SIZE    = VS/2 = '528'                              @Z30LPTJ 11929803
*   ATTRIBUTES      = REENTRANT, REUSABLE, REFRESHABLE,                 11932803
*                    ZERO PSW PROTECT KEY                               11937402
*                                                                       11939402
* ENTRY POINTS     = IEE4404D FROM IEE2303D OR IEE3303D                 11939802
*   PURPOSE        = TO SCAN THE SECONDARY KEYWORDS THAT MAY BE         11940202
*                    PRESENT IN THE VARY CONSOLE COMMAND                11940602
*   LINKAGE        = BRANCH                                             11940702
*   INPUT          = REG13 PTS TO THE SAVE AREA GOTTEN BY IEE3603D      11940802
*                    REG 2 PTS TO THE DUMMY XSA                         11940902
*                       XAR CONTAINS THE BUFFER LENGTH                  11956602
*                       XAL POINTS TO THE COMMAND PARAMTERS             11966602
*                       XAV CONTAINS THE VERB (VARY)                    11968602
*                    REG1 CONTAINS THE COMMAND AUTHORITY OF THE         11969002
*                    READER/INTERPRETER IF IT  ISSUED THE COMMAND       11969402
*                    WORD 17 OF THE SAVE AREA POINTED BY REG13          11969802
*                    CONTAINS THE CSCB POINTER.                         11970202
*   REGISTERS SAVED  = ALL                                              11970302
*   REGISTER USAGE =    R1   XAD SWITCHES ON INPUT AND OUTPUT           11970402
*                            OTHERWISE, CONTAINS THE R/I COMD AUTHORITY 11972302
*                       R2   POINTER TO THE DUMMY XSA                   11977202
*                       R6   INCREMENTER FOR LOOPS                      11979102
*                       R7   END OF BUFFER PTR                          11981002
*                       R9   UNIT PTR                                   11982902
*                       R12  ADDRESSABILITY                             11984802
*                       R13  SAVE AREA PTR STORE HERE IN XAA+2 OF XSA   11986702
*   REGISTERS RESTORED                                                  11988602
*                  = ALL                                                11990502
*                                                                       11992402
* EXITS - NORMAL   = TO IEE4203D VIA BRANCH                             11994302
*   CONDITIONS     = WHEN THE SECONDARY KEYWORDS HAVE BEEN CHECKED      11996202
*                       AND NO ERRORS HAVE BEEN FOUND                   11998102
*   OUTPUT         = REG13 PTS TO THE SAVE AREA                         12000002
*                    WORD 17 HAS THE CSCB PTR                           12032002
*                    REG2 CONTAINS THE DUMMY XSA PTR                    12042002
*                    REG1 HAS XAD FLAGS DETERMINED BY 3303D SUCH AS:    12052002
*                       WHETHER MULTIPLE UNITS OR A SINGLE UNIT         12062002
*                       ARE PRESENT IN THE COMMAND                      12072002
*                    XAR  HAS THE SIZE OF THE BUFFER                    12074002
*                    XAL POINTS TO THE COMMAND PARAMETERS               12074102
*                    XAV HAS THE VERB (VARY)                            12074202
*   RETURN CODES   = NONE                                               12088202
*                                                                       12098202
* EXITS - ERROR    = TO IEE0503D OR IEE2103D VIA BALR                   12100202
*   CONDITIONS     = ERROR HAS BEEN DETECTED IN THE COMMAND             12100602
*                    ON RETURN FROM THE MESSAGE MODULE THE CSCB IS      12100702
*                    FREED VIA THE MGCR MACRO, THE SAVE AREA AND THE    12100802
*                    DUMMY XSA IS FREED ALSO AND EXIT IS TAKEN TO THE   12100902
*                    CALLER OF THE PROCESSOR.                           12103002
*   OUTPUT         = REG13 CONTAINS THE SAVE AREA PTR                   12105702
*                    REG2 CONTAINS A POINTER TO THE DUMMY XSA           12107802
*                       XAE CONTAINS THE ERROR MESSAGE CODE             12109902
*   RETURN CODES   = NONE                                               12112002
*                                                                       12114002
* EXTERNAL REFERENCES                                                   12125002
*   ROUTINES       = IEE4203D                                           12135002
*                    IEE0503D                                           12135402
*                    IEE2103D                                           12135802
*   DATA AREAS     = SEE OUTPUT - DATA                                  12135902
*                                                                       12136002
* CONTROL BLOCKS   = 1. DUMMY EXTENDED SAVE AREA (XSA)                  12139702
*                    2. UNIT CONTROL MODULE (UCM)                       12141702
*                       FIELDS TESTED  - UCMATR -BIT= UCMOF             12142102
*                                                     UCMIF             12142502
*                                        UCMCOMPC                       12142902
*                                        UCMDISP - BIT=UCMDISPA         12143302
*                                        UCMID                          12147002
*                                        UCMUCB                         12149002
*                                        UCMVEA                         12149402
*                       FIELDS UPDATED - NONE                           12149802
*                    3.UNIT CONTROL BLOCK (UCB)                         12150202
*                       FIELDS TESTED  - UCBNAME                        12150602
*                       FIELDS UPDATED - NONE                           12160402
*                    4. CVT                                             12170402
*                       FIELDS TESTED  - CVTCUCB                        12170502
*                       FIELDS UPDATED - NONE                           12208702
*                    5. COMMAND SCHEDULING CONTROL BLOCK (CSCB)         12210702
*                       FIELDS TESTED  - NONE                           12212702
*                       FIELDS UPDATED - CHSTS - BIT= CHFC              12214702
*                                                                       12218702
* TABLES           = NONE                                               12228702
*                                                                       12238702
* MACROS           = MGCR,FREEMAIN,LOAD,DELETE,DEQ                      12239102
*                                                                       12239502
* MAPPING MACROS   = IEEXSA                                             12240702
*                    CVT                                                12242702
*                    IEECUCM                                            12244702
*                    IEFUCBOB                                           12246702
*                    IEECHAIN                                           12246802
*   SERIALIZATION  = THIS MODULE EXECUTES PROTECTED FROM VARY/UNLOAD    12247102
*                    ALLOCATION AND OLTEP VIA AN ENQ ISSUED IN          12257102
*                    MODULE IEE3603D                                    12259102
*                    A DEQ IS ISSUED WHEN THERE IS A TERMINAL           12259502
*                    EXIT CONDITION IS ENCOUNTERED                      12259602
*                    THE DEQ IS ISSUED AT LOCATION:  KDEQUE             12261702
*                    PROTECTION FROM COMM TASK IS NOT REQUIRED          12264402
*                    HERE THEREFORE NO LOCKS WILL BE GOTTEN.            12266502
*                                                                       12268602
* CHANGE LEVEL     = Y02669, Y02651, ZA12703                   @ZA12703 12270703
*                                                                       12272802
* CHANGE ACTIVITY  = N/A                                                12274902
*                                                                       12277002
* MESSAGES         = 'IEE309I VARY UNIDENTIFIABLE KEYWORD'              12279103
*                       INDICATES A SYNTAX ERROR IN THE KEYWORD OR      12281202
*                       ITS VALUE.                                      12283302
*                    'IEE313I XXX UNIT REF. INVALID'                    12285402
*                       UNIT SPECIFIED FOR ALTERNATE CONSOLE HAS NO     12287502
*                       UCME OR COMPOSITE WAS INVALID (XXX,XXX ARE      12289602
*                       COMPOSITE UNIT ADDRESSES SPECIFIED)             12291702
*                    ' IEE306I VARY INVALID NUMERICS'                   12301702
*                       WHEN AN INVALID ROUTCODE WAS SPECIFIED.         12302102
*                    'IEE345I VARY AUTHORITY INVALID'                   12302202
*                       IF THE ISSUING CONSOLE ISN'T THE MASTER         12302302
*                       CONSOLE, THIS MESSAGE IS PUT OUT.               12305802
*                       NOTE: ALL MSGS ARE ISSUED BY IEE0503D           12306202
*                                                                       12307802
* ABEND CODES      = NONE                                               12308202
*                                                                       12308602
* PACKAGING        = IEE4403D WILL BE PART OF LOAD MODULE               12309002
*                       IEE3603D                                        12309402
*                    THIS LOAD MODULE ALIASES ARE                       12312902
*                       NONE                                            12314902
*                    THIS LOAD MODULE ENTRY POINTS ARE                  12315302
*                       IEE3603D                                        12315702
*                    MODULE WILL RESIDE IN:  LPALIB                     12315802
*                                                                       12316102
* SYSGEN           = SUPPLIED BY SECTIONS:                              12316502
*                       LOAD MODULE NAME                                12325502
*                       PACKAGING                                       12327502
*                    THIS CSECT WILL BE INCLUDED AT SYSGEN FROM         12327902
*                    DLIB -AOSB3- BY MACRO -SGIEF441-                   12328302
*                                                                       12329502
* SYSTEM LIBRARIES = NONE                                               12331502
*                                                                       12333502
*********************************************************************** 12334802
         EJECT                                                          12343802
* SCAN REGISTER ASSIGNMENTS        FUNCTIONS:                           12352802
DEFREG   EQU   *                                                 Y02669 12354802
R0       EQU   0                                                        12361802
R1       EQU   1                                                        12400002
R2       EQU   2                       DUMMY XSA BASE                   12600002
R3       EQU   3                                                        12800018
R4       EQU   4                       GENERAL USE                      13000018
R5       EQU   5                       VARIOUS  DSECT BASES             13200018
R6       EQU   6                       INCREMENT FOR LOOPS              13400018
R7       EQU   7                       POINTER TO END OF BUFFER         13600018
R8       EQU   8                                                        13800018
R9       EQU   9                       PTR TO CHARACTER BEING CHECKED   14000018
R10      EQU   10                                                       14200018
R11      EQU   11                                                       14400018
KBASE    EQU   12                      ADDRESSIBILITY BASE-THIS MODULE  14500018
R13      EQU   13                      SAVE AREA PTR ON INPUT    Y02669 14600002
R14      EQU   14                                                       14700018
R15      EQU   15                      USED FOR BRANCHES                14800002
*                                                                       16800019
* ERROR MESSAGE CODES                                                   16900019
*                                                                       17000019
ERR9     EQU   9                       KEYWORD MISSPELLED               17200019
ERR13    EQU   13                      UNIT REF INVALID                 17300019
ERR6     EQU   6                                                  19084 17400019
ERR29    EQU   X'29'                   INVALID AUTHORITY MESSAGE  21002 17450001
*                                                                       17500019
* COMMAND AUTHORITY GROUP BIT SETTINGS                                  17600019
*                                                                       17700019
KG3CONS  EQU   X'20'                   CONS-GROUP3                      17800019
KG2IO    EQU   X'40'                   I/O-GROUP2                       17900019
KGISYS   EQU   X'80'                   SYS-GROUP1                       18000019
KMASK3   EQU   X'E0'                   ALL GROUPS                       18050003
*                                                                       18100019
*                                                                       18600019
ZERO     EQU   0                                                        18700019
ONE      EQU   1                                                        18800019
TWO      EQU   2                                                        18900019
TRE      EQU   3                                                        19000019
FOR      EQU   4                                                        19100019
FIV      EQU   5                                                        19200019
SIX      EQU   6                                                        19300019
SVN      EQU   7                                                        19350002
EIT      EQU   8                                                        19400019
NIN      EQU   9                                                        19500019
TEN      EQU   10                                                       19600019
TWLV     EQU   12                                                       19800019
FIFTN    EQU   15                                                       19900019
SIXTN    EQU   16                                                       20000019
FOX      EQU   255                                                19084 20100019
LEFPAREN EQU   C'('                                                     20200019
RTPAREN  EQU   C')'                                                     20300019
COMMA    EQU   C','                                                     20400019
BLK      EQU   C' '                                                     20500019
F0       EQU   X'F0'                                             A33219 20520020
F1       EQU   X'F1'                                             A33219 20540020
F6       EQU   X'F6'                                             A33219 20560020
F9       EQU   X'F9'                                             A33219 20580020
D64      EQU   64                                                Y02669 20592002
D132     EQU   132                                               Y02669 20594002
SYS      EQU   X'00'                                             Y02669 20594402
RI       EQU   X'80'                                             Y02669 20594802
         EJECT                                                          20596002
*********************************************************************** 20600019
*                                                                       20700019
* SCAN AND ROUTE ROUTINE CONTINUED                                    * 20800019
*                                                                       20900019
*********************************************************************** 21000019
         BALR  KBASE,ZERO                 ESTABLISH ADDRESSIBILITY      21100019
         USING *,KBASE                                                  21200019
         MODID BR=YES                                            Y01886 21250001
         STM   R0,R15,ZERO(R13)                                  Y02669 21260002
         L     R5,CVTPTR               PTR TO CVT                       21300019
         USING SETCVT,R5               USE CVT TO                       21400019
         L     R5,CVTCUCB              OBTAIN PTR TO UCM (HEADER)       21500019
         USING UCM,R5                  UCM ADDRESSIBILITY               21600002
         USING XSA,R2                                                   21700019
         ST    R13,XAK             SAVEAREA POINTER STORED     @Z30LPTJ 21800003
         L     R9,XAS+FOR          RETRIEVE CHARACTER POINTER           21900019
         XC    XAS+FOR(FOR),XAS+FOR ZERO INDICATOR FIELD                22000019
         L     R7,XAR                  LOAD PTR TO COMMAND INPUT BUFFER 22100019
         A     R7,XAL             GET EOB PTR INTO REG7          Y02669 22200002
         MVC   XAX+TRE(TWO),KCONSLE        MOVE IGC4203D INTO XSA       22450002
*                                 IF AN ERROR IS FOUND, THE 42    21002 22460001
*                                 WILL BE OVERLAYED WITH A 21 OR  21002 22470001
*                                      AN 05                      21002 22480001
*                                                                       22500019
*********************************************************************** 22600019
*                                                                       22700019
* DETERMINE WHICH KEYWORD SPECIFIED                                     22800019
*                                                                       22900019
*********************************************************************** 23000019
KEYSCAN  EQU   *                                                        23100019
         CLC   ONE(FIV,R9),KAUTH   AUTH= KEYWORD                        23200019
         BE    K1                  YES                                  23300019
         CLC   ONE(FIV,R9),KROUT   ROUT= KEYWORD                        23400019
         BE    K2                  YES                                  23500019
         CLC   ONE(EIT,R9),KALT    ALTCONS= KEYWORD                     23600019
         BNE   KERR3               NO,ERROR                             23700019
*                                                                       23800019
         EJECT                                                          23900019
*********************************************************************** 24000019
*                                                                       24100019
*   VALUES FOR ALTCONS=                                                 24200019
*                                                                       24300019
*********************************************************************** 24400019
K3       EQU   *                                                        24500019
         OI    XASWITCH,XALTCHG    SET THE ALT TO BE CHANGED BIT IN XSA*24600003
                                                               @Z30LPTJ 24700003
         LA    R9,NIN(R9)          GET PTR TO PARMS ON KEYWORD          24800019
         CLI   ZERO(R9),LEFPAREN   TEST FOR ALTERNATE CONSOLE           24900019
         BE    KPAREN              YES                                  25000019
         CLC   ZERO(TWO,R9),OUNIT+ONE   TST FOR O-XXX SPECIFICATION     25100019
         BNE   KUNTCK2                 CHECK FOR MORE KEYWORDS    21002 25200001
         LA    R9,TWO(R9)              UPDATE POINTER             21002 25260001
         OI    XASOPCOD,XALTCOM      SET BIT INDICATING O-UNIT @Z30LPTJ 25270003
KUNTCK2  EQU   *                                                        25300019
         LR    R10,R9         SAVE PTR TO UNITS                         25400019
         LA    R9,TRE(R9)       UPDATE PTR TO END OF UNIT               25500019
         CR    R9,R7               IS IT END OF BUFFER                  25600019
         BE    KU1                 YES,END OF COMMAND                   25700019
         BH    KERR5               ERROR                          19084 25800019
         CLI   ZERO(R9),COMMA      COMMA INDICATES MORE KEYWORDS        25900019
         BE    KU2                                                      26000019
         CLI   ZERO(R9),BLK        BLANK INDICATES END OF COMMAND       26100019
         BNE   KERR5               OTHERWISE INVALID UNIT SPECIFID19084 26200019
*                                                                       26300019
KU1      EQU   *                                                        26400019
         LA    R1,KDETRM                                                26500019
KU3      EQU   *                                                        26600019
         BAL   R11,KUNTCK          CHECK FOR UNIT VALIDITY              26700019
*        REGISTER 13 CONTAINS ADDRESS OF UCM ENTRY FOR UNIT SPECIFIED   26800019
*        IF UNIT IS VALID                                               26900019
*                                                                       27000019
         USING UCMLIST,R13         ..                                   27100019
         TM    UCMATR,UCMOF+UCMIF  DOES UNT HAVE WTO AND ATENTIONY02669 27200002
         BO    KPUTID                  BOTH WTO AND ATTENTION     21002 27300001
         BZ    KERR5               HAD NEITHER, ERROR             19084 27400019
*                                                                       27900019
KOUNIT   EQU   *                                                        28000019
         TM    XASOPCOD,XALTCOM    WAS O-UNIT SPECIFIED?       @Z30LPTJ 28100003
         BZ    KERR5               NO, ERR                        19084 28200019
         USING UCMLIST,R13                                        19084 28250019
         TM    UCMATR,UCMOF        YES,HAS IT WTO SUPPORT        Y02669 28300002
         BZ    KERR5               NO, ERR                        19084 28400019
         TM    UCMDISP,UCMDISPD   HAS O-SUPPORT, IS IT O-ONLY?   Y02669 28450002
         BZ    KERR5              NO ERROR, IS NOT O-ONLY        Y02669 28460002
KPUTID   EQU   *                                                  21002 28500001
         MVC   XALTPTR(ONE),UCMID      INSERT UCMI FOR ALTERNATE  21002 28550001
         BR    R1                 BRANCH TO APPROPRIATE PROCESSOR 21002 28600001
KU2      EQU   *                                                        28700019
         LA    R1,KEYSCAN          PREST TO CHECK OTHER KEYWORDS        28800019
         B     KU3                 GO CHECK UNIT'S VALIDITY             28900019
*                                                                       29400019
*        PROCESSING OF COMPOSITE CONSOLE SPECIFIED AS ALTCON            29500019
*                                                                       29600019
KPAREN   EQU   *                                                        29700019
         LR    R10,R9                                            Y02669 29750002
         CLC   ONE(TWO,R9),IUNIT   CHECK FOR I-XXX PRESENT              29800019
         BNE   KERR5               NOPE, UNIT REF INVALID        Y02669 29900002
         CLC   SIX(TRE,R9),OUNIT   ,O- SPECIFICATION CHECK              30000019
         BNE   KERR5               NO,ERROR                      Y02669 30100002
         CLI   TWLV(R9),RTPAREN    ')' ENDS IT                          30200019
         BNE   KERR5               NO,ERROR                      Y02669 30300002
*                                                                       30400019
*        COMPOSITE CONSOLE SYNTAX IS OKAY                               30500019
*                                                                       30600019
         OI    XASOPCOD,XALTCON    SET BIT INDICATING COMP ALT @Z30LPTJ 30650003
         LA    R9,TRE(R9)            UPDATE PTR TO UNIT                 30700019
         LR    R10,R9         SAVE POINTER TO UNITS                     30800019
         BAL   R11,KUNTCK          CHECK VALIDITY OF UNIT SPECIFIED     30900019
         USING UCMLIST,R13         VALID                                31000019
         TM    UCMATR,UCMIF        DOES I-UNIT HAVE ATTENTION SUPY02669 31100002
         BZ    KERR4               NO,ERR                               31200019
         L     R4,UCMCOMPC         COMPOSITE POINTER FROM THIS UCME     31300019
         LA    R4,ZERO(R4)            CLEAR HIGH ORDER BYTE             31400019
         DROP  R13                                                      31500019
         LTR   R4,R4               IS UNIT PART OF COMPOSITE            31600019
         BZ    KERR4               NO,ERROR CONDITION                   31700019
         USING UCMLIST,R4          GO INTO COMPOSITE'S UCME TO GET      31800019
         TM    UCMATR,UCMOF        DOES O-UNIT HAVE WTO SUPPORT  Y02669 31900002
         BZ    KERR4               NO,ERROR                             32000019
         L     R10,UCMUCB          GET PTR TO UCB                       32100019
         DROP  R4                                                       32200019
         USING UCB,R10             USING THIS PTR,GET PHYSICAL          32300019
         CLC   SIX(TRE,R9),UCBNAME  UNIT ADDRS AND COMPARE TO COMMAND   32400019
         DROP  R10                                                      32500019
         BNE   KERR4               IF NOT CORRECT,COMPOSITE, ERROR      32600019
         USING UCMLIST,R13                                              32700019
         MVC   XALTPTR(ONE),UCMID    INSERT UCMI FOR ALTERNATE          32800019
         DROP  R13                                                      32900019
         LA    R9,TEN(R9)                                               33100019
*                                                                       33200019
         EJECT                                                          33300019
*                                                                       33400019
*        DETERMINATION OF END OF SYNTAX SCAN                            33500019
*                                                                       33600019
KSK1     EQU   *                                                        33700019
         CR    R9,R7               END OF BUFFER                        33800019
         BE    KDETRM              YES,GOTO DETERMINATION NEXT MOD      33900019
         CLI   ZERO(R9),COMMA      ',' INDICATES MORE KEYWORDS          34000019
         BE    KEYSCAN             CONTINUE SCAN                        34100019
         CLI   ZERO(R9),BLK        BLANK INDICATES END OF COMMAND       34200019
         BNE   KERR3               IF NONE,ERROR                        34300019
*                                                                       34400019
KDETRM   EQU   *                                                        34500019
         L     R13,XAK            RESTORE SAVE AREA PTR        @Z30LPTJ 34600003
         MVC   XAV(EIT),VARY                                     Y02669 34610002
         L     R15,VCON42         GET ADDRESS OF 4203D           Y02669 34650002
         LM    R0,R14,ZERO(R13)   RESTORE REGS                   Y02669 34700002
         BR    R15                GO TO 4203D                    Y02669 34750002
*                                                                       34900019
         EJECT                                                          35000019
*********************************************************************** 35100019
*                                                                       35200019
*              VALUES FOR AUTH=                                         35300019
*                                                                       35400019
*********************************************************************** 35500019
K1       EQU   *                                                        35600019
*********************************************************************** 35650001
* THIS PARM IS VALID ONLY WHEN THE COMMAND IS ISSUED FROM THE    21002* 35660001
* MASTER CONSOLE TO ENSURE THAT NO OTHER CONSOLE CHANGES ITS OWN 21002* 35670001
* OR ANOTHER CONSOLES AUTHORITY                                  21002* 35680001
*********************************************************************** 35690001
         CLI   XAU,RI             READER/INTERPRETER COMMAND     Y02669 35690402
         BE    KERR7              YES,ER,R/I CANT ISSUE THIS CMD Y02669 35690802
         CLI   XAU,SYS             SYSTEM CMD                    Y02669 35691202
         BE    AUTHOK             YES, NO NEED TO CHECK AUTHORITYY02669 35691602
         LR    R1,R7                   SAVE END OF BUFFER PPR     21002 35692001
         SR    R11,R11                                            21002 35694001
         IC    R11,XAU                 USE ALGOR. TO ACCESS UCME  21002 35696001
         LM    R6,R7,UCMVEA            R6 FIRST UCM ENTRY         21002 35698001
         BCTR  R11,ZERO                SUBTRACT ONE               21002 35698401
         MR    R10,R7                  LENGTH OF FIRST ENTRY      21002 35698801
         AR    R11,R6                  ADDRESS OF ENTRY           21002 35699201
         USING UCMLIST,R11                                        21002 35699601
         TM    UCMDISP,UCMDISPA        WAS ISSUER MASTER CONSOLE  21002 35699701
         BZ    KERR7                   NO, INVALID AUTHORITY      21002 35699801
         LR    R7,R1                   RESTORE END OF BUFFER PTR  21002 35699901
AUTHOK   EQU   *                                                 Y02669 35733202
         OI    XASOPCOD,XACMD   SET BIT INDICATING CMD CHANGE  @Z30LPTJ 35766703
         LA    R9,SIX(R9)          GET PTR TO PARM FIELD                35800019
         CLI   ZERO(R9),LEFPAREN   ARE THERE SUBFIELDS OF PARM OF       35900019
*                             KEYWORD                                   36000019
         BE    KPAREN1        YES, GO PROCESS                           36100019
*                                                                       36200019
         CLC   ZERO(TRE,R9),KALL   IS IT 'ALL'                          36300019
         BNE   KOTHRS         NO, GO CHECK OTHER PARAMS                 36400019
*********************************************************************** 36500019
*              AUTH=ALL                                                 36600019
*********************************************************************** 36700019
         OI    XACMDATH,KMASK3  SET CMD AUTH TO ALL            @Z30LPTJ 36800003
         LA    R9,TRE(R9)       UPDATE PTR TO END OF KEYWORD            36900019
         B     KSK1           GO CHECK END OF BUFFER                    37000019
*                                                                       37100019
*                                                                       37200019
KOTHRS   EQU   *                                                        37300019
         CLC   ZERO(FOR,R9),KINFO  IS IT AUTH=INFO                      37400019
         BE    KINFOPRM       YES, GO PROCESS                           37500019
         SR    R6,R6          SET EXTERIROR PARENS SWITCH OFF           37600019
KOTHRS2  EQU   *                                                        37700019
         CLC   ZERO(TRE,R9),KSYS   NO,IS IT AUTH=SYS                    37800019
         BE    KSYSPRM        YES, GO PROCESS                           37900019
         CLC   ZERO(TWO,R9),KIO    NO,IS IT AUTH=10                     38000019
         BE    KIOPRM         YES, GO PROCESS                           38100019
         CLC   ZERO(FOR,R9),KCONS  NO,IS IT AUTH=CONS                   38200019
*                                                                       38300019
         BE    KCONSPRM       YES, GO PROCESS                           38400019
         B     KERR3          NO, ERROR                                 38500019
*                                                                       38600019
KINFOPRM EQU   *                                                        38700019
*********************************************************************** 38800019
*              AUTH=INFO                                                38900019
*********************************************************************** 39000019
         LA    R9,FOR(R9)       PT TO END OF KEYWORD, SINCE AREA IS     39100019
         B     KSK1           ALREADY ZEROES, GO CHECK END OF SCAN      39200019
*                                                                       39300019
*                                                                       39400019
*              PROCESSING OF AUTH=(VALUES WITHIN)                       39500019
*                                                                       39600019
KPAREN1  EQU   *                                                        39700019
         LA    R6,ONE           SET EXTERIOR PAREN SWITCH               39800019
         LA    R9,ONE(R9)       UPDATE PTR TO PARM                      39900019
         B     KOTHRS2        GO CHECK VALIDTY                          40000019
*                                                                       40100019
KSYSPRM  EQU   *                                                        40200019
         OI    XACMDATH,KGISYS  SET INDICATOR BIT FOR SYSTEM   @Z30LPTJ 40300003
         LA    R9,TRE(R9)       UPDATE TO END OF SYS                    40400019
KENDPARM LTR   R6,R6          DID ( START FIELD                         40500019
         BZ    KSK1           NO, GO CHECK END OF SCAN                  40600019
         CLI   ZERO(R9),COMMA      YES,DOES COMMA FOLLOW                40700019
         BE    KOTHRS3        YES, GO CHECK OTHERS                      40800019
         CLI   ZERO(R9),RTPAREN    NO, IS PAREN END KEYWORD             40900019
         LA    R9,ONE(R9)          UPDATE PTR                           41000019
         BE    KSK1           YES, GO CHECK END OF SCAN                 41100019
         B     KERR3          NO - ERROR                                41200019
*                                                                       41300019
KIOPRM   EQU   *                                                        41400019
         OI    XACMDATH,KG2IO      SET INDICATOR BIT FOR IO    @Z30LPTJ 41500003
         LA    R9,TWO(R9)       UPDATE TO END OF PARM                   41600019
         B     KENDPARM       GO CHECK IF END OF KEYWORD                41700019
*                                                                       41800019
KCONSPRM EQU   *                                                        41900019
         OI    XACMDATH,KG3CONS    SET INDICATOR BIT FOR CONS  @Z30LPTJ 42000003
         LA    R9,FOR(R9)          SET PTR TO END OF PARM               42100019
         B     KENDPARM       GO CHECK IF END OF KEYWORD                42200019
*                                                                       42300019
KOTHRS3  EQU   *                                                        42400019
         LA    R9,ONE(R9)          UPDATE PTR                           42500019
         B     KOTHRS2        GO CHECK IF ANY MORE                      42600019
*                                                                       42700019
         EJECT                                                          42800019
*********************************************************************** 42900019
*              VALUES FOR ROUT=                                         43000019
*********************************************************************** 43100019
K2       EQU   *                                                        43200019
         LA    R9,SIX(R9)       UPDATE TO PARM                          43400019
         CLI   ZERO(R9),LEFPAREN   ARE THERE INDIVIDUAL ROUTCODES       43500019
         BE    KPAREN2        YES, GO PROCESS                           43600019
         CLC   ZERO(TRE,R9),KALL   ARE ALL RTCDS TO BE ASSIGNED         43700019
         BNE   KK2            NO, GO CHECK FOR OTHERS                   43800019
         OI    XASWITCH,XAROUT        ROUT CODES TO BE CHANGED @ZA12703 43850003
         MVC   XARTCODE(TWO),KFFFF   SET ALL ROUTING CODES     @Z30LPTJ 43900003
         LA    R9,TRE(R9)       UPDATE TO END OF KEYWORD PARM           44000019
         B     KSK1           GO CHECK END OF SCAN                      44100019
*                                                                       44200019
KK2      EQU   *                                                        44300019
         CLC   ZERO(FOR,R9),KNONE  ARE THERE NO RTCDS TO BE ASSIGNED    44400019
         BNE   KK3            NONE IS NOT THE PARM, GO CHECK AGAIN      44500019
         OI    XASWITCH,XAROUT    ROUT CODES TO BE CHANGED     @ZA12703 44520003
         SR    R0,R0              CLEAR REGISTER               @ZA12703 44540003
         STH   R0,XARTCODE        NO ROUTE CODES WANTED        @ZA12703 44560003
         LA    R9,FOR(R9)       UPDATE PTR TO END OF PARM               44600019
         B     KSK1           ..                                        44700019
KK3      EQU   *                                                        44800019
         SR    R6,R6          SET EXTERIOR PAREN TO AFF                 44900019
         B     KPAR1          GO PROCESS RT CODE                        45000019
*                                                                       45100019
KPAREN2  EQU   *                                                        45200019
         LA    R9,ONE(R9)       UPDATE TO PASS THE PAREN                45300019
         LA    R6,ONE           SET EXT PAREN SWITCH                    45400019
*                                                                       45500019
KPAR1    EQU   *                                                        45600019
         XC    XAV(EIT),XAV       CLEAR AREA FOR CVB OF RT CODES Y02669 45700002
         CLI   ONE(R9),COMMA       ONE DIGIT NUM FOLLOWED BY COMMA      45800019
         BE    KPAR6               YES,GO PROCESS                       45900019
         CLI   ONE(R9),RTPAREN     END OF PARM                          46000019
         BE    KPAR1B              YES, ONE DIGIT UNIT ONLY             46100019
         CLI   TWO(R9),COMMA       TWO DIGIT NUM FOLLOWED BY COMMA      46200019
         BE    KPAR2          YES                                       46300019
KPAR1B   EQU   *                                                        46400019
         LTR   R6,R6          EXTERIOR PAREN SWITH SET                  46500019
         BZ    KPAR8          NO, ERROR                                 46600019
         CLI   ONE(R9),RTPAREN     YES,ONE DIGIT NUM FPLLOWED BY ')'    46700019
         BE    KPAR6          YES, PROCESS                              46800019
         CLI   TWO(R9),RTPAREN     TWO DIGIT NUM FOLLOWED BY ')'        46900019
KPAR1A   EQU   *                   ..                                   47000019
         BNE   KERR3          NO, ERROR                                 47100019
*                                                                       47200019
KPAR2    EQU   *                                                        47300019
         CLI   ZERO(R9),F1        SYNTAX CHECK THE DIGIT USED    A33219 47310020
         BNE   KERR6              AS THE ROUTING CODE. THE 1ST   A33219 47320020
         CLI   ONE(R9),F0         DIGIT MUST BE 1. THE 2ND       A33219 47330020
         BL    KERR6              DIGIT CAN BE 0 THROUGH 6       A33219 47340020
         CLI   ONE(R9),F6         INCLUSIVE. IF NOT THEN AN      A33219 47350020
         BH    KERR6              ERROR CONDITION HAS BEEN       A33219 47360020
*                                 REACHED.                       A33219 47370020
         PACK  XAV+SIX(TWO),ZERO(TWO,R9)  RTCODE IS 2 DIGITS     Y02669 47400002
         LA    R9,TWO(R9)           INDEX PAST DIGITS                   47500019
KPAR3    LA    R13,SIXTN           MAXIMUM VALUE ALLOWED         Y02669 47600002
         CVB   R4,XAV         CONVERT PACKED DECIMAL             Y02669 47700002
         LTR   R4,R4          IS IT ZERO                                47800019
         BZ    KERR6               YES, ILLEGAL                   19084 47900019
         CR    R4,R13         IS IT 16                                  48000019
         BE    KPAR9               YES, NO ROUT CODE TO BE SET    19084 48100019
         BH    KERR6               HIGH, ILLEGAL                  19084 48200019
*                                                                       48300019
         BCTR  R4,ZERO             SET TO ZERO BASE                     48500019
         OI    XASWITCH,XAROUT    ROUT CODES TO BE CHANGED     @ZA12703 48550003
         LA    R3,ONE              SET COUNTER TO ONE FOR SHIFT         48600019
         SLL   R3,FIFTN            SET FIRST BIT OF MASK ON             48700019
         SRL   R3,ZERO(R4)         MOVE TO APPROPRIATE RT CODE BIT      48800019
         O     R3,XACMDATH         SET BIT IN INDICATOR AREA   @Z30LPTJ 48900003
         ST    R3,XACMDATH          AND SAVE IN XSA            @Z30LPTJ 49000003
*                                                                       49100019
KPAR5    EQU   *                                                        49200019
         LTR   R6,R6          EXTERIOR PARENS SET                       49300019
         BZ    KSK1                NO, GO CHECK END OF SCAN       19084 49400019
         CLI   ZERO(R9),RTPAREN    YES,CHECK IF ')' PRESENT             49500019
         LA    R9,ONE(R9)          YES, UPDATE PAST PARENS              49600019
         BNE   KPAR1          NO, MORE ROUT CODES, PROCESS              49700019
         B     KSK1                 GO TO EOB ROUTINE                   49800019
*                                                                       49900019
KPAR6    EQU   *                                                        50000019
         CLI   ZERO(R9),F0        SYNTAX CHECK THE DIGIT USED AS A33219 50020020
         BL    KERR6              THE ROUTCODE. IT MUST BE       A33219 50040020
         CLI   ZERO(R9),F9        0 THROUGH 9 SINCE ROUTCODE IS  A33219 50060020
         BH    KERR6              JUST 1 CHARACTER.              A33219 50080020
         PACK  XAV+SVN(ONE),ZERO(ONE,R9)     ROUT CODE=ONE DIGIT Y02669 50100002
         LA    R9,ONE(R9)                    INDEX PAST DIGIT           50200019
         B     KPAR3          GO TO PROCESS                             50300019
*                                                                       50400019
KPAR8    EQU   *                                                        50500019
         CLI   ONE(R9),BLK         BLANK MAY FOLLOW SINGLE DIGIT        50600019
         BE    KPAR6               YES, GO PROCESS                      50700019
         CLI   TWO(R9),BLK         BLK MAY FOLLOW TWO DIGITS            50800019
         B     KPAR1A              IS NOT - ERROR, IF YES - PROCESS     50900019
*                                                                       51000019
KPAR9    EQU   *                                                  19084 51050019
         LTR   R6,R6               EXTERIOR PARENS SET            19084 51100019
         BNZ   KPAR5               YES, GO CONTINUE ROUTS         19084 51150019
         B     KSK1                GO CHECK IF OTHER KEYWORDS     19084 51300019
         EJECT                                                          51400019
*                                                                       51500019
*              DETERMINATION OF VALID UNIT SPECIFIED                    51600019
*                                                                       51700019
KUNTCK   EQU   *                                                        51800019
         LM    R13,R15,UCMVEA R13 PTR TO THE 1ST UCM ENTRY              51900019
*                             R14 HAS LENGTH OF UCM ENTRY               52000019
*                             R15 HAS PTR TO LAST UCM ENTRY             52100019
         USING UCMLIST,R13                                              52200019
KUNTCK1  EQU   *                                                        52300019
         L     R4,UCMUCB      PT TO UCM ASSOCIATED WITH UCME            52400019
         USING UCB,R4         REFERENCE TO UCB                          52500019
         CLC   ZERO(TRE,R10),UCBNAME    COMPARE PHYSICAL UNIT ADDRESS   52600019
         BE    KSU1           FOUND -                                   52700019
         BXLE  R13,R14,KUNTCK1     NOT FOUND, CONTINUE CHECK FOR UNIT   52800019
         DROP  R4,R13         UNTIL EXHAUST UCME'S                      52900019
         B     KERR5               ERROR                          19084 53000019
*  UNIT GIVEN IN COMMAND IS VALID (HAS UCM ENTRY)                       53100019
*                                                                       53200019
KSU1     EQU   *                                                        53300019
         LA    R13,ZERO(R13)     CLEAR HIGH ORDER BYTE                  53400019
         BR    R11            RETURN                                    53500019
*                                                                       53600019
         EJECT                                                          53700019
*********************************************************************** 53800019
*                                                                       53900019
* TRANSFER OF CONTROL TO VARIOUS MODULES DETERMINATION                  54000019
*                                                                       54100019
*********************************************************************** 54200019
*                                                                       54300019
* ERROR CODE HANDLING                                                   54400019
*                                                                       54500019
KERR3    BAL   R5,KERREXIT    ERROR CODE =9                             54900019
         DC    AL1(ERR9)           ERROR CODE IS 9                      55000019
*                                                                       55100019
KERR5    LR    R9,R10                                             19084 55200019
KERR4    MVC   XAV(TRE),ZERO(R9)   INSERT CHARS OF UNIT                 55300019
         TM    XASOPCOD,XALTCON    WAS COMP. CONS SPECIFIED?   @Z30LPTJ 55350003
         BO    KERR4C              YES,GO MOVE IN O-UNIT          M0128 55360001
         MVI   XAV+TRE,BLK         PAD WITH BLANKS                      55400019
KERR4R   EQU   *                                                  M0128 55450001
         BAL   R5,KERREXT2         GO TO EXIT ROUTINE            Y02669 55500002
         DC    AL1(ERR13)          ERROR CODE IS 13                     55600019
KERR4C   DS    0H                                                 M0128 55650001
         MVI   XAV+TRE,COMMA       MOVE IN COMMA TO DELIM I-UNIT  M0128 55660001
         MVC   XAV+FOR(TRE),SIX(R9) MOVE IN O-UNIT                M0128 55670001
         XI    XASOPCOD,XALTCON    TURN OFF COMP. SPEC. SWITCH @Z30LPTJ 55680003
         B     KERR4R              GO TO PROCESS ERROR MSG        M0128 55690001
*                                                                       55700019
* CONTROL TRANSFERING ROUTINE                                           55800019
KERR7    DS    0H                                                 21002 55900001
         SPACE 5                                                        55910002
**************************************************               Y02651 55920002
*                                                                Y02651 55922002
*  THIS A TERMINAL ERROR EXIT AND THEREFORE A DEQ WILL           Y02651 55924002
*  BE ISSUED BEFORE THE EXIT TO THE ERROR MSG MOD IS TAKEN       Y02651 55926002
*  THE ENQ WAS ISSUED IN MODULE IEE3603D                         Y02651 55928002
*                                                                Y02651 55928402
         BAL   R4,KDEQUE                                         Y02651 55928802
*                                                                Y02651 55929202
**************************************************               Y02651 55930002
         SPACE 5                                                        55940002
         L     R13,XAK            GET SAVEAREA POINTER         @Z30LPTJ 55942003
         STM   R0,R13,ZERO(R13)   STORE REGS                     Y02669 55944002
         MVI   XAE,ERR29               INVALID AUTHORITY          21002 55950001
         MVC   XAX+TRE(TWO),KERMSG2    IGG2103D                  Y02669 56000002
         MVC   XAV(EIT),VARY                                     Y02669 56010002
         LOAD  EP=IEE2103D                                       Y02669 56020002
         LR    R15,R0             SAVE RTN'S ADDRESS IN REG15    Y02669 56030002
         BALR  R14,R15            GO TO MESSAGE RTN              Y02669 56040002
* ON RETURN                                                      Y02669 56042002
         LM    R0,R15,ZERO(R13)   RESTORE REGS                   Y02669 56042102
         ST    R13,XAK            RESTORE SAVEAREA PTR TO XSA  @Z30LPTJ 56042403
         DELETE EP=IEE2103D                                      Y02669 56044002
KEXIT    EQU   *                                                 Y02669 56050002
         L     R1,D64(R13)        GET CSCB PTR                   Y02669 56100002
         USING CHAIN1,R1                                         Y02669 56150002
         OI    CHSTS,CHFC         SET TO FREE CSCB               Y02669 56200002
         MGCR  (1),CHAIN                                         Y02669 56250002
         LR    R4,R14             SAVE RETURN ADDRESS            Y02669 56350002
*                                 FREE SAVE AREA GOTTEN IN 3303D Y02669 56550002
         LA    R0,D132            SIZE OF DUMMY XSA AND SAVE AREAY02669 56600002
         LR    R1,R2              PTR TO DUMMY XSA               Y02669 56650002
         FREEMAIN R,LV=(0),A=(1)                                 Y02669 56660002
*                                 FREE DUMMY XSA GOTTEN IN 3603D Y02669 56670002
         LR    R14,R4             RESTORE RETURN REG             Y02669 56680002
         BR    R14                RETURN                         Y02669 56690002
*                                                                Y02669 56700002
KERREXIT EQU   *                                                 Y02669 56750002
         MVC   XAV(EIT),VARY                                     Y02669 56752002
KERREXT2 EQU   *                                                 Y02669 56754002
         SPACE 5                                                 Y02669 56760002
**************************************************               Y02651 56770002
*                                                                Y02651 56772002
*  THIS A TERMINAL ERROR EXIT AND THEREFORE A DEQ WILL           Y02651 56774002
*  BE ISSUED BEFORE THE EXIT TO THE ERROR MSG MOD IS TAKEN       Y02651 56776002
*  THE ENQ WAS ISSUED IN MODULE IEE3603D                         Y02651 56778002
*                                                                Y02651 56778402
         BAL   R4,KDEQUE                                         Y02651 56778802
*                                                                Y02651 56779202
**************************************************               Y02651 56780002
         SPACE 5                                                        56790002
         L     R13,XAK            SAVE SAVEAREA PTR FROM 2103D @Z30LPTJ 56790403
         STM   R0,R13,ZERO(R13)   STORE REGS                     Y02669 56792002
*        0-13, DO NOT CLOBBER R14 AREA STORED BEFORE, SINCE      Y02669 56794002
*        VALUE OF R14 HAS CHANGED SINCE THEN                     Y02669 56796002
         MVC   XAE(ONE),ZERO(R5)   INSERT ERROR CODE                    56800002
         MVC   XAX+TRE(TWO),KERMSG     IGC0503D                   21002 56900001
         LOAD  EP=IEE0503D                                       Y02669 56960002
         LR    R15,R0             SAVE RTN'S ADDRESS IN REG15    Y02669 56970002
         BALR  R14,R15            GO TO 0503D                    Y02669 56980002
*  ON RETURN                                                     Y02669 56990002
         LM    R0,R15,ZERO(R13)   RESTORE REGS                   Y02669 56990102
         DELETE EP=IEE0503D                                      Y02669 56992002
         B     KEXIT               GO TO EXIT RTN                       57000019
*                                                                 19084 57100019
KERR6    EQU   *                                                  19084 57200019
         BAL   R5,KERREXIT         TO 0503D                       19084 57300019
         DC    AL1(ERR6)           INVALID NUMERICS               19084 57400019
         EJECT                                                          71900018
*****************************************************************Y02651 71910002
*                                                                Y02651 71912002
*  THIS THE DEQ SUBROUTINE                                       Y02651 71914002
*  THE ENQ WAS ISSUED IN MODULE IEE3603D                         Y02651 71916002
         DS    0F                                                Y02651 71918002
KDEQUE   EQU   *                                                 Y02651 71918402
         DEQ   MF=(E,IEFDEQUE)                                   Y02651 71918802
         BR    R4                                                Y02651 71920202
*****************************************************************Y02651 71921202
         EJECT                                                          71922202
*****************************************************************Y02651 71923202
*                                                                Y02651 71924202
*  THE LIST FORM OF THE DEQ MACRO INSTRUCTION FOLLOWS:           Y02651 71925202
*                                                                Y02651 71929902
IEFDEQUE DEQ   (IEFSQCBS,IEFQ4QCB,TWO,SYSTEM,IEFSQCBS,IEFVQCBS,SVN,    *71939902
               SYSTEM),RET=HAVE,MF=L                           @YM5443P 71940902
IEFVQCBS DC    C'VARYDEV'                                               71941902
IEFSQCBS DC    C'SYSIEFSD'                                       Y02651 71943202
IEFQ4QCB DC    C'Q4'                                             Y02651 71945202
*****************************************************************Y02651 71946702
         EJECT                                                          71950002
*********************************************************************** 72250002
*                                                                       72400018
* CONSTANTS USED 34 SCAN AND ROUTING ROUTINE -                          72600018
*                                                                       72800018
*********************************************************************** 73000018
KFFFF    DC    X'FFFF'             MASK FOR ALL ROUT CODES              73300018
*                                                                       73600018
KERMSG   DC    C'05'                   IEE0503D                  Y02669 73900002
KERMSG2  DC    C'21'                  IEE2103D                   Y02669 73950002
KCONSLE  DC    C'42'             CONSOLE,ONLINE,OFFLINE          Y02669 74300002
         DS    0F                                                Y02669 74350002
VCON42   DC    V(IEE4203D)                                       Y02669 74400002
*                                                                       74800018
* CHARACTER STRINGS USED TO DETERMINE KEYWORDS                          75000018
KAUTH    DC    C'AUTH='            KEYWORD TO CHANGE CMD AUTH           75200018
KROUT    DC    C'ROUT='            KEYWORD TO CHANGE ROUT CDS           75400018
KALT     DC    C'ALTCONS='         KEYWD TO CHNG ALTER.CONSL.           75600018
* CHARACTER STRINGS USED TO DETERMINE KEYWORD VALUES                    75900018
KALL     DC    C'ALL'              CHECK FOR ALL AUTH,RTCDS             76100018
KINFO    DC    C'INFO'             CHECK FOR AUTH                       76300018
KSYS      DC    C'SYS'             CHECK FOR AUTH=                      76500018
KIO      DC    C'IO'               CHECK FOR AUTH=                      76700018
KCONS    DC    C'CONS'             CHECK FOR AUTH=                      76900018
KNONE    DC    C'NONE'             CHECK FOR ROUT=                      77100018
IUNIT    DC    C'I-'                   (I-XXX,0-XXX)                    77400018
OUNIT    DC    C',O-'              O-XXX                                78400018
VARY     DC    C'VARY    '                                       Y02669 78450002
         SPACE 5                                                        78500002
PATCH    DC    CL65'***IEE4403D***'                            @Z30LPTJ 78550003
         EJECT                                                          79500018
SUCM     DSECT                                                          79600018
         IEECUCM   FORMAT=NEW                                           79700002
         EJECT                                                          79900018
SETXSA   DSECT                                                          80000018
         IEEXSA                                                         80200018
         EJECT                                                          81500018
SETCVT   DSECT                                                          81600018
         CVT   SYS=VMS                                                  81800018
UCB      DSECT                                                          82000018
         IEFUCBOB                                                       82200018
         EJECT                                                          82250002
CHAIN1   DSECT                                                          82260002
         IEECHAIN                                                       82300002
         END                                                            82400018
./  ADD  SSI=83110949,NAME=IEE4603D
 TITLE 'IEE4603D - VARY ONLINE AND OFFLINE FOR CONSOLE DEVICES'         00090003
IEE4603D CSECT                                                          00180002
* C 072000-072900,234000-234900                                         00210002
* D 246600                                                              00240002
*********************************************************************** 00270002
* MODULE NAME      = IEE4603D                                           00360002
*   CSECT NAME     = IEE4603D                                           00450002
*                                                                       00540002
* LOAD MODULE NAME = IEE3603D                                           00630002
*                                                                       00720002
* DESCRIPTIVE NAME = VARY ONLINE, OFFLINE FOR CONSOLE DEVICES           00810002
*                                                                       00840002
* COPYRIGHT        = MISSING                                            00990002
*                                                                       01080002
* STATUS           = OS/VS/2 RELEASE 3                         @Z30LPTJ 01170003
*                                                                       01260002
* FUNCTION         = IEE4603D WILL PROCESS THE ONLINE/OFFLINE           01350002
*                    KEYWORDS OF THE VARY COMMAND BY SETTING BITS       01440002
*                    IN THE UNIT'S UCB AND UCME                         01530002
*                                                                       01620002
* OPERATION        = IEE4603D IS ENTERED ONLY FROM IEE4203D             01710002
*                    WHICH HAS SCANNED THE UNIT FIELD OF THE VARY       01800002
*                    COMMAND FOR ALL ERRORS.                            01890002
*                    THIS MODULE WILL PROCESS THE ONLINE/OFFLINE        01980002
*                    KEYWORDS OF THE VARY COMMAND                       02070002
*                    IT WILL SET BITS FOR ON/OFFLINE PROCESSING         02160002
*                    IN THE UNIT'S UCB AND UCME                         02250002
*                    WHEN THE UNIT HAS BEEN VARIED, 4603D WILL BALR     02340002
*                    TO IEAVMNTR TO PROCESS ALL BIT CHANGES REQUIRED    02430002
*                    FOR THE FOLLOWING COMANDS:                         02520002
*                            MONITOR JOBNAMES                           02610002
*                            MONITOR STATUS                             02700002
*                            MONITOR SESSIONS                           02790002
*                    FOR THIS DEVICE WHICH IS CHANGING STATUS FROM      02880002
*                    FORM A CONSOLE TO A NON-CONSOLE STATE.             02970002
*                    THIS IS DONE BECAUSE:                              03060002
*                    1. SINCE THIS CONSOLE IS NOT FUNCTIONING AS        03150002
*                    SUCH ANYMORE, WE DO NOT WANT ANY MORE OF THESE     03240002
*                    COMMAND'S MESSAGES BEING QUEUED TO IT (IF IN       03330002
*                    FACT HAD EVER ISSUED ANY OF THE ABOVE THREE        03420002
*                    COMMANDS).                                         03510002
*                    2. IF THIS CONSOLE, WHEN IT WAS ONE, DID IN        03600002
*                    FACT ISSUE ANY OF THE ABOVE THREE COMMANDS,        03690002
*                    AND IT WAS THE ONLY CONSOLE ON THE SYSTEM          03780002
*                    WHICH HAS ISSUED THEM, THEN WE ALSO WANT           03870002
*                    THE BITS INDICATING THESE COMMANDS TURNED          03960002
*                    OFF IN THE MASTER RESIDENT CORE AREA.              04050002
*                    THIS SUBROUTINE (IEAVMNTR) WILL DO ALL THE         04140002
*                    CHECKING AND ALL THE BIT'S SETTING.                04230002
*                    3. DEVICES WHICH ARE CURRENTLY INACTIVE AS         04320002
*                    CONSOLES AND ARE:                                  04410002
*                    OFFLINE                CMD ISSUED: V OFFLINE       04500002
*                    ONLINE,ALLOC           CMD ISSUED: V ONLINE        04590002
*                    ONLINE,UNALLOC         CMD ISSUED: V ONLINE        04680002
*                    OFFLINE                CMD ISSUED: V ONLINE        04770002
*                    ARE ALL HANDLED AS IMMEDIATE COMMANDS AND ALL      04860002
*                    STATUS BITS ARE SET IN THIS MODULE.                04950002
*                    HOWEVER, WHEN THE DEVICE IS:                       05040002
*                    ONLINE                 CMD ISSUED: V OFFLINE       05130002
*                    THEN IT CANNOT BE MADE OFFLINE IMMEDIATELY         05220002
*                    AND TERMINATION WILL HANDLE THIS SITUATION.        05310002
*                    ANY DEVICES FUNCTIONING CURRENTLY AS               05400002
*                    CONSOLES CANNOT BE VARIED TO THE ONLINE/OFFLINE    05490002
*                    STATES IMMEDIATELY AND COMM. TASK AND              05580002
*                    TERMINATION WILL HANDLE THIS CASES.                05670002
*                                                                       05760002
*                    IEE4603D SETS THE FOLLOWING BITS:                  05850002
*                     ..FOR ACTIVE CONSOLE TO ONLINE:                   05940002
*                            CLOSE PENDING       ON   UCME              06030002
*                            ON/OFF CHANGE STATS OFF  UCB               06120002
*                            CONSL.CHANGE STATUS ON   UCB               06210002
*                            MP-OPERATOR BIT     N/A  UCB               06300002
*                                                                       06390002
*                     ..FOR ACTIVE CONSOLE TO OFFLINE:                  06480002
*                            CLOSE PENDING       ON   UCME              06570002
*                            CONSL.CHANGE STATUS ON   UCB               06660002
*                            ON/OFF CHANG STATUS ON   UCB               06750002
*                            OPERATOR-MP BIT     ON   UCB               06840002
*                                                                       06930002
*                       FOR INACTIVE CONSOLE TO ONLINE, THE             07020002
*                       REQUEST IS NOT HONORED IF THE DEVICE            07110002
*                       IS CURRENTLY IN USE BY A SYSTEM        @YM07231 07200002
*                       COMPONENT.                             @YM07231 07290002
*                                                                       07380002
*                     ..FOR INACTIVE CONSOLE TO ONLINE:                 07470002
*                           .IF INACTIVE CONSL = OFFLINE:               07560002
*                            ONLINE BIT            UCB  ON              07650002
*                            ONL/OFF CHANGE STATUS UCB  OFF             07740002
*                            CONSL.CHANGE STATUS   UCB  OFF             07830002
*                            OPERATOR-MP BIT       UCB  OFF             07920002
*                                                                       08010002
*                           .IF INACTIVE CONSOLE = ONLINE,ALLOCATED     08100002
*                            ONLINE BIT            UCB  ON              08190002
*                            ON/OFF CHANGE STATUS  UCB  OFF             08280002
*                            CONSL.CHANGE STATUS   UCB  OFF             08370002
*                            MP-OPERATOR BIT       UCB  N/A             08460002
*                                                                       08550002
*                           .IF INACTIVE CONSOLE = ONLINE,UNALLOCATED   08640002
*                            ONLINE BIT           UCB  ON               08730002
*                            ON/OFF CHANGE STATUS UCB  OFF              08820002
*                            CONSL.CHANGE STATUS  UCB  OFF              08910002
*                            MP-OPERATOR BIT      UCB  N/A              09000002
*                                                                       09090002
*                     ..FOR INACTIVE CONSOLE TO OFFLINE:                09180002
*                           .IF INACTIVE CONSOLE = OFFLINE:             09270002
*                            ON/OFF CHANGE STATS.  UCB  OFF             09360002
*                            CONSL..CHANGE STATUS  UCB  OFF             09450002
*                            MP-OPERATOR BIT       UCB  N/A             09540002
*                                                                       09630002
*                           .IF INACTIVE CONSOLE = ONLINE,ALLOCATED:    09720002
*                            ON/OFF CHANGE STATUS  UCB  ON              09810002
*                            CONSL.CHANGE STATUS   UCB  OFF             09900002
*                            MP-OPERATOR BIT       UCB  ON              09990002
*                                                                       10080002
*                           .IF INACTIVE CONSOLE = ONLINE,UNALLOCATED:  10170002
*                            ON/OFF CHANGE STATUS  UCB  ON              10260002
*                            CONSL.CHANGE STATUS   UCB  OFF             10350002
*                            MP-OPERATOR BIT       UCB  ON              10440002
*                            MRC SEARCH BIT(MSSUM) MRC  ON              10530002
*                                                                       10620002
*                    IEE4603D WILL DISPATCH PROPER MESSAGES TO THE      10710002
*                    VARIED CONSOLES, RESTEP THE UNIT FIELD POINTER,    10800002
*                    AND DETERMINE IF ALL UNITS HAVE BEEN PROCESSED.    10890002
*                    IF ALL UNITS HAVE BEEN PROCESSED AND IF ONLY I/O   10980002
*                    UNITS ARE TO BE VARIED ON/OFF, THEN IT BRANCHES    11070002
*                    TO IEE3103D. IF NO UNITS ARE (INCLUDING            11160002
*                    ANY I/O UNITS IT EXITS TO THE CALLER OF THE SVC    11250002
*                    IF VARY RANGE IS BEING PROCESSED, THEN    @Z30LPTJ 11260003
*                    MESSAGES ARE SUPPRESSED AND WHEN EXIT IS  @Z30LPTJ 11270003
*                    MADE, IT IS A BRANCH TO IEECB904 FOR      @Z30LPTJ 11280003
*                    FURTHER VARY RANGE PROCESSING             @Z30LPTJ 11290003
*                                                                       11340002
* NOTES                                                                 11430002
*    DEPENDENCIES = NONE                                                11520002
*    CHARACTER/CODE DEPENDENCIES                                        11610002
*                 = THIS MODULE CAN BE ASSEMBLER WITH ANY NEW           11700002
*                   CHARACTER/CODE SET.                                 11790002
*                                                                       11880002
* RESTRICTIONS    = R2 CONTAINS THE PTR TO THE XSA ON INPUT AND OUTPUT  11970002
*   REGISTER CONVENTIONS                                                12060002
*                 = REGISTER DEFINITION WILL BE FOUND AT:  REGDEF       12150002
*   PATCH LABEL   = PATCH                                               12240002
*                                                                       12330002
* MODULE TYPE     = CSECT                                               12420002
*   PROCESSOR     = ASSEMBLER                                           12510002
*   MODULE SIZE   = VS/2 = '692'                                        12600003
*   ATTRIBUTES    = REENTRANT, REUSABLE,REFRESHABLE,ZERO PSW            12690002
*                    PROTECT KEY, PAGED LPA                             12780002
*                                                                       12870002
* ENTRY POINTS     = IEE4603D FROM IEE4203D                             12960002
*    PURPOSE       = TO VARY ONLINE AND OFFLINE CONSOLE DEVICES         13050002
*    LINKAGE       = BRANCH                                             13140002
*    INPUT         = REG2 PTR TO THE DUMMY XSA                          13230002
*                    XAD HAS THE SWITCHES COMPUTED BY IEE4203D          13320002
*                    XAR CONTAINS PROCESS SWITCHES FOR THE UNITS        13410002
*                    XAL PTR TO THE PARAMETER OF THE COMMAND            13500002
*                    REG13 PTS TO THE SAVE AREA GOTTEN BY 3603D         13590002
*                    WORD 17 OF THE SAVE AREA HAS THE PTR TO THE CSCB   13680002
*    REGISTERS SAVED= ALL                                               13770002
*    REGISTER USAGE= R0  CONSOLE ID FOR WTO                             13860002
*                    R1  MRC PTR AND WTO                                13950002
*                    R2  DUMMY XSA PTR                                  14040002
*                    R3  ADDRESSABILITY                                 14130002
*                    R4  UCME PTR                                       14220002
*                    R7  PROCESS BIT REG                                14310002
*                    R9  UNIT PTR                                       14400002
*                    R10 UCM PTR                                        14490002
*                    R11 UCMPRFX PTR                                    14580002
*                    R12 UCB PTR                                        14670002
*                    R13 SAVE AREA PTR                                  14760002
*    REGISTERS RESTORED                                                 14850002
*                  = ALL                                                14940002
*                                                                       15030002
* EXITS - NORMAL 1 = TO IEE3103D VIA BRANCH                             15120002
*    CONDITIONS    = IF SOME UNITS (I/O) ARE LEFT TO BE                 15210002
*                       PROCESSED BY IEE3103D (AS INDICATED BY          15300002
*                       XAUDVC BIT IN XAD), EXIT TO IEE3103D VIA BR.    15390003
*    OUTPUT        = 1. WTO'S FOR VARIED DEVICES (SEE MESSAGES)         15480002
*                    2. UCME AND UCB BIT SETTINGS FOR VARIED            15570002
*                       DEVICES (SEE OPERATION)                         15660002
*                    3. IF EXIT TO IEE3103D, THE OUTPUT IS              15750002
*                       REG2 PTS TO THE DUMMY XSA                       15840002
*                            XAR PTR TO THE LOGICAL END OF BUFFER       15930002
*                            (PTS TO COMMA BEFORE KEYWORD)              16020002
*                            XAL HAS COMMAND PARAM LIST                 16110002
*                            XAV HAS THE VERB                           16200002
*                            XAS+0(XASOPCOD) AND XAS+1(XSWITCH)         16290003
*                            HAVE BIT DESIGNATING THE KEYWORD:          16380002
*                                 ONLINE                                16470002
*                                 OFFLINE                               16560002
*                    REG13 HAS PTR TO THE SAVE AREA, WORD17=CSCB PTR    16650002
*    RETURN CODES  = NONE                                               16740002
*                                                                       16830002
* EXIT - NORMAL 2  = IEAVMNTR VIA BALR                                  16920002
*                  = ADDR. OF THIS RTN IS PRESET IN AREA:UCMMNTR        17010002
*                     OF THE UCM                                        17100002
*    CONDITIONS    = MONITOR COMMAND BIT HANDLING RTN. FOR THIS         17190002
*                    CONSOLE GOING OUT OF THIS STATE, AND THEREFORE,    17280002
*                    DOES NOT NEED MONITOR MSGS SENT TO IT ANYLONGER    17370002
*    OUTPUT        = REG1 POINTS TO A POINTER WHICH IN TURN             17460002
*                    POINTS TO A TWO WORD PARAMETER LIST CONTAINING     17550002
*                    THE DEVICE'S ID AND FUNCTION CODES.(SEE DSECT)     17640002
*                    R13 PTS TO A SAVEAREA                              17730002
*                    R14 HAS RETURN ADDRESS                             17820002
*    RETURN CODES  = NONE                                               17910002
*                                                                       18000002
* EXITS - NORMAL -3-= RETURN TO CALLER                                  18090002
*    CONDITIONS    = WHEN NO MORE UNITS AND NO I/O ARE TO BE PROCESSED  18180002
*    OUTPUT        = ALL UNITS IN COMMAND ARE COMPLETED                 18270002
*                    SAVE AREA AND DUMMY XSA ARE FREED                  18360002
*                    CSCB IS FREED VIA THE MGCR MACRO                   18450002
*    RETURN CODES  = NONE                                               18540002
*                                                                       18550003
* EXITS - NORMAL 4 = TO IEECB904 VIA BRANCH                    @Z30LPTJ 18560003
*    CONDITIONS    = WHEN NO MORE UNITS AND NO I/O UNITS ARE   @Z30LPTJ 18570003
*                    TO BE PROCESSED AND VARY RANGE IS BEING   @Z30LPTJ 18580003
*                    PROCESSED                                 @Z30LPTJ 18590003
*    OUTPUT        = REGISTER 2 POINTING TO THE XSA WHICH HAS  @Z30LPTJ 18600003
*                    THE XAL POINTING TO THE VARY RANGE WORK   @Z30LPTJ 18610003
*                    AREA                                      @Z30LPTJ 18620003
*    RETURN CODES  = NONE                                      @Z30LPTJ 18630003
*                                                                       18670003
* EXITS - ERROR    = NONE                                               18720002
*                                                                       18760003
* EXTERNAL REFERENCES                                                   18900002
*    ROUTINES      = IEE3103D                                           18990002
*                    IEECB904                                  @Z30LPTJ 19010003
*                                                                       19030003
*    DATA AREAS    = SEE EXITS - OUTPUT DATA                            19080002
*                                                                       19170002
* CONTROL BLOCKS   = DUMMY EXTENDED SAVE AREA (XSA)                     19260002
*                    CVT                                                19350002
*                       FIELDS UPDATED = NONE                           19440002
*                       FIELDS TESTED  = CVTCUCB                        19530002
*                                        CVTMSER                        19620002
*                    UNIT CONTROL MODULE (UCM)                          19710002
*                       FIELDS UPDATED = UCMSTS - UCMCF                 19800002
*                       FIELDS TESTED  = UCMCOMPC                       19890002
*                                        UCMMSG - BIT= UCMMSGA          19980002
*                                        UCMUCB                         20070002
*                                        UCMVEA                         20160002
*                                        UCMMNTR                        20250002
*                    UNIT CONTROL BLOCK (UCB)                           20340002
*                       FIELDS UPDATED = SRTESTAT - BIT= SRTECHGS       20430002
*                                                        SRTEDADI       20520002
*                                                        SRTEONLI       20610002
*                                        UCBWGT - BIT= UCBVORSN         20700002
*                       FIELDS TESTED  = SRTESTAT - BIT= SRTEALOC       20790002
*                                                        SRTEONLI       20880002
*                                                        SRTESYSR       20970002
*                                        UCBNAME                        21060002
*                     COMMAND SCHEDULING CONTROL BLOCK (CSCB)           21150002
*                       FIELDS TESTED  - NONE                           21240002
*                       FIELDS UPDATED - CHSTS -BIT= CHFC               21330002
*                     MASTER SCHEDULER RESIDENT DATA AREA (MRC)         21420002
*                       FIELDS TESTED  - NONE                           21510002
*                       FIELDS UPDATED - MSECBFL - BIT= MSSUM           21600002
*                                                                       21690002
* TABLES           = NONE                                               21780002
*                                                                       21870002
* MACROS           = WTO,GETMAIN,FREEMAIN,MGCR,GETMAIN,SETLOCK,DEQ      21960002
*                                                                       22050002
* MAPPING MACROS   = IEEXSA                                             22140002
*                    CVT                                                22230002
*                    IEECUCM                                            22320002
*                    IEFUCBOB                                           22410002
*                    IEEBASEA                                           22500002
*                    IEECHAIN                                           22590002
*                    IHAMPL                                             22680002
*                    IHAPSA                                             22770002
*    SERIALIZATION = PROTECTION AGAINST COMM TASK WHEN SETTING ON/OFF   22860002
*                    THE UCME BITS IS ACCOMPLISHED VIA THE CMS AND      22950002
*                    LOCAL LOCKS OBTAINED AT: OSETLOCK                  23040002
*                    AND RELEASED AT: RELEASE                           23130002
*                    BOTH IN THIS MODULE.                               23220002
*                    PROTECTION AGAINST ALLOCATION, VARY/UNLOAD AND     23310002
*                    SYSTEM COMPONENT IS ACCOMPLISHED BY       @YM07231 23400002
*                    EXECUTION OF THIS ROUTINE UNDER AN ENQ    @YM07231 23440002
*                    GOTTEN EARLIER, IN MODULE IEE3603D.       @YM07231 23490002
*                    A DEQ WILL BE ISSUED IN THIS MODULE IF THE         23580002
*                    TERMINAL EXIT IS TAKEN AT LOC: ODEQUE              23670002
*                    ALL UCB AND MRC BITS THAT ARE TURNED ON/OFF IN     23760002
*                    THIS ROUTINE ARE SET BY THE COMPARE-AND-SWAP       23850002
*                    INSTRUCTION.                                       23940002
*                                                                       24030002
* CHANGE LEVEL     = Y02669, Y02651, Z30LPTJ                   @Z30LPTJ 24120003
*                                                                       24210002
* CHANGE ACTIVITY = N/A                                                 24300002
*                                                                       24390002
* MESSAGES         = 'IEE302I XXX ONLINE'                               24480002
*                    'IEE303I XXX OFFLINE'                              24570002
*                       (WHERE XXX IS THE UNIT NAME IN QUESTION)        24750002
*                       THE ABOVE MESSAGES ARE SUPPRESSED      @Z30LPTJ 24780003
*                       WHEN VARY RANGE IS BEING PROCESSED.    @Z30LPTJ 24810003
*                                                                       24840002
* ABEND CODES      = NONE                                               24930002
*                                                                       25020002
* PACKAGING        = IEE4603D WILL BE PART OF LOAD MODULE               25110002
*                       = IEE3603D                                      25200002
*                    THIS LOAD MODULE ALIASES ARE                       25290002
*                       = NONE                                          25380002
*                    THIS LOAD MODULE ENTRY PTS ARE                     25470002
*                       = IEE3603D                                      25560002
*                    MODULE WILL RESIDE IN:  LPALIB                     25650002
*                                                                       25740002
* SYSGEN           = SUPPLIED BY SECTIONS:                              25830002
*                       LOAD MODULE NAME                                25920002
*                       PACKAGING                                       26010002
*                       THIS CSECT WILL BE INCLUDED AT SYSGEN FROM      26100002
*                       DLIB -AOSB3- BY MACRO -SGIEF441-                26190002
*                                                                       26280002
* SYSTEM LIBRARIES = NONE                                               26370002
*********************************************************************** 26460002
         EJECT                                                          26550002
*********************************************************************** 26640002
*                                                                       26730002
*   ***           ***                                                   26820002
*   *               *                                                   26910002
*   * XXX           *                                                   27000002
*   *               * ONLINE                                            27090002
* V * O-XXX         *,                                                  27180002
*   *               * OFFLINE                                           27270002
*   * (I-XXX,O-XXX) *                                                   27360002
*   *               *                                                   27450002
*   ***           ***                                                   27540002
*********************************************************************** 27630002
         EJECT                                                          27720002
*                                                                 19084 27810002
*        REGISTER EQUATES                                         19084 27900002
*                                                                 19084 27990002
DEFREG   EQU   *                                                 Y02669 28080002
R0       EQU   0                   CONSOLE ID FOR WTO             19084 28170002
R1       EQU   1                   IN-XAD,USE-MRC PTR,AND WTO     19084 28260002
R2       EQU   2                   XSA                            19084 28350002
R3       EQU   3                   ADDRESS                        19084 28440002
R4       EQU   4                   UCME                           19084 28530002
R5       EQU   5                                                  19084 28620002
R6       EQU   6                                                  19084 28710002
R7       EQU   7                   PROCESS BIT REG                19084 28800002
R8       EQU   8                                                  19084 28890002
R9       EQU   9                   UNIT PTR                       19084 28980002
R10      EQU   10                  UCM REG                        19084 29070002
R11      EQU   11                  UCMPFX REG                     19084 29160002
R12      EQU   12                  UCB REG                        19084 29250002
R13      EQU   13                                                 19084 29340002
R14      EQU   14                  RET ADDR                       19084 29430002
R15      EQU   15                                                 19084 29520002
*********************************************************************** 29610002
*                                                                 19084 29700002
*        EQUATES                                                  19084 29790002
*                                                                 19084 29880002
*********************************************************************** 29970002
ZERO     EQU   0                                                  19084 30060002
ONE      EQU   1                                                  19084 30150002
TWO      EQU   2                                                  19084 30240002
TRE      EQU   3                                                  19084 30330002
FOR      EQU   4                                                  19084 30420002
SIX      EQU   6                                                  19084 30510002
SVN      EQU   7                                                  19084 30600002
EIT      EQU   8                                                  19084 30690002
TWELV    EQU   12                                                Y02669 30780002
SIXTN    EQU   16                                                Y02669 30870002
NINETEEN EQU   19                      *                          21051 30960002
D64      EQU   64                                                Y02669 31050002
D132     EQU   132                                               Y02669 31140002
D68      EQU   68                                                Y02669 31230002
*                                                                 19084 31320002
FOX      EQU   255                                                19084 31410002
*                                                                 19084 31500002
RIID     EQU   X'80'                                              19084 31590002
         SPACE 10                                                 19084 31770002
ONOFKEY  EQU   C'O'                                               19084 31950002
NLINE    EQU   C'N'                                               19084 32040002
FFLINE   EQU   C'F'                                               19084 32130002
EIGHTY8  EQU   88                                                Y02669 32220002
         EJECT                                                          32310002
*********************************************************************** 32400002
*                                                                 19084 32490002
*        ONLINE AND OFFLINE OF CONSOLE DEVICES PROCESSOR          19084 32580002
*                                                                 19084 32670002
*********************************************************************** 32760002
         BALR  R3,ZERO                                            19084 32850002
         USING *,R3                                               19084 32940002
         MODID BR=YES                                            Y01886 33030002
         USING XSA,R2                                             19084 33120002
*                                                                       33210002
         STM   R0,R15,ZERO(R13)                                  Y02669 33300002
         L     R4,XAR              PROCESS SWITCHES               19084 33390002
         L     R9,XAL              GET PTR TO UNIT BEGIN          19084 33480002
         LA    R9,ZERO(R9)                                        19084 33570002
         L     R10,CVTPTR                                         19084 33660002
         USING OCVT,R10                                           19084 33750002
         L     R10,CVTCUCB         GET PTR TO UCM                 19084 33840002
         DROP  R10                                                19084 33930002
         USING UCM,R10                                           Y02669 34020002
*                                                                 19084 34110002
         SPACE 10                                                 19084 34200002
         TM    XADUSWIT,XAXPAREN   MULTIPLE UNITS              @Z30LPTJ 34290003
         BZ    OSINGLE                                            19084 34380002
OSTART   LA    R9,ONE(R9)          YES,INDEX PAST BEGINNING PARENS19084 34470002
OSINGLE  EQU   *                                                  19084 34560002
         CLC   ZERO(TWO,R9),OOUNIT IS IT AN O-XXX                 19084 34650002
         BNE   OCOMP               NO, MAYBE A COMPOSITE          19084 34740002
         LA    R9,TWO(R9)               YES INDEX TO UNITNAME     19084 34830002
         B     OTEST               GO CHECK IF MUST PROCESS IF    19084 34920002
*                                                                 19084 35010002
OCOMP    EQU   *                                                  19084 35100002
         CLC   ZERO(TRE,R9),OIUNIT     DO WE HAVE A COMPOSITE     19084 35190002
         BNE   OTEST               NO, ITS A REGULAR UNIT        Y02669 35280002
         LA    R9,TRE(R9)               YES,INDEX TO INPUT UNIT   19084 35370002
         OI    XADUSWIT,XAIOCOMP        TURN COMPOSITE SWITCH  @Z30LPTJ 35460003
*                                                                 19084 35550002
OTEST    EQU   *                                                  19084 35640002
         LTR   R4,R4                    DO WE PROCESS THIS UNIT   19084 35730002
         BZ    ONOMORE             NO, AND NOMORE EITHER,FINISHED 19084 35820002
         BM    OPROCES             YES,PROCESS THIS ONE           19084 35910002
*                                       NO, NOT PROCESS THIS ONE  19084 36000002
OOMIT    EQU   *                                                  19084 36090002
         TM    XADUSWIT,XAIOCOMP   IS IT A COMP WE HAVE TO OMIT@Z30LPTJ 36180003
         BZ    OENDCK              NO,                            19084 36270002
         LA    R9,SVN(R9)               YES INDEX OVER            19084 36360002
*                                                                 19084 36450002
OENDCK   EQU   *                                                  19084 36540002
         LA    R9,TRE(R9)          PT AFTER DLIM ADTER UNIT       19084 36630002
         NI    XADUSWIT,XAXPAREN+XAUDVC MULT. UNITS, CLEAN UP  @Z30LPTJ 36720003
         SLL   R4,ONE              ALL SWITCHES EXCEPT XAXPAREN@Z30LPTJ 36810003
         B     OSTART              AND IODEV SWITCH. GO START OVER19084 36900002
*                                                                 19084 36990002
OPROCES  EQU   *                                                  19084 37080002
         LM    R5,R7,UCMVEA        GET UCMES PTRS                 19084 37170002
         USING UCMLIST,R5                                         19084 37260002
OLOOP    L     R12,UCMUCB          AND UCB ADDRESSABILITY         19084 37350002
         USING OUCB,R12                                           19084 37440002
         CLC   ZERO(TRE,R9),UCBNAME     IS THIS THE UCME FOR UNIT 19084 37530002
         BE    OONOFF              YES,                          Y02669 37620002
         BXLE  R5,R6,OLOOP         MUST BE NEXT ONE GO CHECK      19084 37710002
*                                  WILL ALWAYS FIND ONE,CHECKED BY 4203 37800002
         EJECT                                                    19084 37890002
OONOFF   EQU   *                                                 Y02669 37980002
         SPACE 5                                                        38070002
*****************************************************************Y02651 38160002
*                                                                Y02651 38250002
*  LOCKS MUST BE GOTTEN NOW FOR PROTECTION AGAINST COMM TASK     Y02651 38340002
*  THESE LOCKS WILL BE RELEASED IN THIS MODULE AT:               Y02651 38430002
*      RELEASE                                                   Y02651 38520002
*                                                                Y02651 38610002
OSETLOCK EQU   *                                                 Y02651 38700002
         LR    R8,R13             SAVE SAVEAREA POINTER          Y02651 38790002
         STM   R11,R14,D68(R8)                                   Y02651 38880002
         SETLOCK OBTAIN,TYPE=LOCAL,MODE=UNCOND,                  Y02651*38970002
               RELATED=(IEE4603D(RELEASE))                       Y02651 39060002
         SETLOCK OBTAIN,TYPE=CMS,MODE=UNCOND,                    Y02651*39150002
               RELATED=(IEE4603D(RELEASE))                       Y02651 39240002
         LM    R11,R14,D68(R8)                                   Y02651 39330002
*****************************************************************Y02651 39420002
        SPACE 10                                                19084   39510002
*********************************************************************** 39600002
*                                                                 19084 39690002
*        PROCESS KEYWORDS                                         19084 39780002
*                                                                 19084 39870002
*********************************************************************** 39960002
         TM    XASOPCOD,XAON       ONLINE                      @Z30LPTJ 40050003
         BZ    OOFFLN              NO, OFFLINE                    19084 40140002
         EJECT                                                          40230002
*********************************************************************** 40320002
*                                                                 19084 40410002
*        ONLINE KEYWORD                                           19084 40500002
*                                                                 19084 40590002
*********************************************************************** 40680002
OONLINE  EQU   *                                                  19084 40770002
*                                                                 19084 40860002
****************PROCESS TO VARY CONSOLE TO ONLINE STATUS          19084 40950002
*                                                                 19084 41040002
*                                                                 19084 41130002
*                                                                 19084 41220002
         OI    XADUSWIT,XAUBLANK   MSG MUST BE PUT OUT         @Z30LPTJ 41310003
         TM    SRTESTAT,SRTESYSR   IS IT A CONSOLE NOW            19084 41400002
         BZ    ONTEST              NO, FUNCTIONING AS IO DEV      19084 41490002
SETBITS2 EQU   *                                                 Y02669 41580002
         OI    UCMSTS,UCMCF        TURN CLOSE PENDING FOR CTASK  Y02651 41670002
*        OI    SRTESTAT,SRTEDADI   SET CHAGING STATUS IN UCB     Y02651 41760002
*        NI    SRTESTAT,FOX-SRTECHGS  SET ON/OFF CHANGE STTS OFF Y02651 41850002
*                                                                Y02651 41940002
*********** THE ABOVE TWO INSTRUCTION WILL BE PROTECTED VIA THE  Y02651 42030002
*           COMPARE AND SWAP INSTRUCTION                         Y02651 42120002
*                                                                Y02651 42210002
         STM   R4,R6,D68(R13)     SAVE USED REGS                 Y02651 42300002
OIDADI   EQU   *                                                 Y02651 42390002
         OIL   SRTESTAT,SRTEDADI,WREGS=(4,5,6),REF=OUCB          Y02651 42480002
NICHGS   EQU   *                                                 Y02651 42570002
NILCHANG EQU   X'BF'    -X'FF'-SRTECHGS-                                42660002
         NIL   SRTESTAT,NILCHANG,WREGS=(4,5,6),REF=OUCB          Y02651 42750002
         LM    R4,R6,D68(R13)     RESTORE REGS                   Y02651 42840002
*                                                                Y02651 42930002
         TM    XADUSWIT,XAIOCOMP  I-UNIT OF A COMP IN PROCESS? @Z30LPTJ 43020003
         BZ    OUNTTST            NO CHECK FOR OUNIT OF COMP     Y02669 43110002
SETOUNT  EQU   *                  YES, PRCES O-UNIT OF COMP FRST Y02669 43200002
         LR    R8,R9              SAVE I-UNIT'S UNITNAME PTR     Y02669 43290002
         LR    R6,R5              SAVE I-UNIT'S UCME PTR         Y02669 43380002
         LR    R11,R12            SAVE I-UNIT'S UCB PTR          Y02669 43470002
         L     R5,UCMCOMPC        GET O-UNIT'S UCME PTR          Y02669 43560002
         L     R12,UCMUCB         GET O-UNIT'S UCB PTR           Y02669 43650002
         LA    R9,SIX(R9)         GET O-INUT'S UNITNAME PTR      Y02669 43740002
         NI    XADUSWIT,FOX-XAIOCOMP TURN OFF I-UNIT'S FLAG    @Z30LPTJ 43830003
         OI    XADUSWIT,XAIPAREN  SET O-UNIT IN PROCESSED SW   @Z30LPTJ 43920003
         B     SETBITS2           GO TO SET FLAGS FOR O-UNIT     Y02669 44010002
*                                                                Y02669 44100002
OUNTTST  EQU   *                                                 Y02669 44190002
         TM    XADUSWIT,XAIPAREN  IF NOT I-UNIT, IS IT O-UNIT  @Z30LPTJ 44280003
         BZ    OMSGPTR            NO REGUNIT, GO ISSUE MSG       Y02669 44370002
         LR    R9,R8              YES, JUST ENDED PROCESING O-UNTY02669 44460002
         LR    R5,R6              RESTORE REGS TO CONTAIN        Y02669 44550002
         LR    R12,R11            THE I-UNIT'S INFOR             Y02669 44640002
         NI    XADUSWIT,FOX-XAIPAREN TURN OFF O-UNIT FLAG      @Z30LPTJ 44730003
         OI    XADUSWIT,XAIOCOMP  AND TURN ON THE I-UNIT FLAG  @Z30LPTJ 44820003
         B     OMSGPTR            GO ISSUE MSGS FOR BOTH UNITS   Y02669 44910002
*                                                                 19084 45000002
*                                                                 19084 45090002
ONTEST   EQU   *                                                  19084 45180002
*        NI    UCBWGT,FOX-UCBVORSN                               Y02651 45270002
*                                                                Y02669 45360002
*        OI    SRTESTAT,SRTEONLI       TURN ONLINE BIT           Y02651 45450002
*        NI    SRTESTAT,FOX-SRTECHGS+SRTEDADI  TURN OFF THE      Y02651 45540002
*                      ON/OFF AND CONSOLE CHANGE STATUS BITS     Y02651 45630002
*                                                                Y02651 45720002
*********   THE ABOVE TWO INSTRUCTIONS WILL BE PROTECTED VIA THE Y02651 45810002
*            COMPARE-AND-SWAP INSTRUCTION                        Y02651 45900002
*                                                                Y02651 45990002
         STM   R4,R6,D68(R13)     SAVE USED REGS                 Y02651 46080002
NILOPER  EQU   *                                                 Y02651 46170002
NILVORSN EQU    X'FB'     -X'FF'-UCBVORSN-                              46260002
         NIL   UCBWGT,NILVORSN,WREGS=(4,5,6),REF=OUCB            Y02651 46350002
OIONLI   EQU   *                                                 Y02651 46440002
         OIL   SRTESTAT,SRTEONLI,WREGS=(4,5,6),REF=OUCB          Y02651 46530002
NILCHGS  EQU   *                                                 Y02651 46620002
         NIL   SRTESTAT,NILCHANG,WREGS=(4,5,6),REF=OUCB          Y02651 46710002
NIDADI   EQU   *                                                 Y02651 46800002
NILDADI  EQU    X'FE'     -X'FF'-SRTEDADI-                              46890002
         NIL   SRTESTAT,NILDADI,WREGS=(4,5,6),REF=OUCB           Y02651 46980002
         LM    R4,R6,D68(R13)     RESTORE REGS                   Y02651 47070002
         TM    XADUSWIT,XAIOCOMP  I-UNIT OF COMP PROCESSED     @Z30LPTJ 47160003
         BZ    NOTCOMP            NO,CHECK IF O-UNIT OF COMP     Y02669 47250002
         LR    R8,R9              YES,MUST SET UP FOR O-UNIT     Y02669 47340002
         LR    R6,R5              R8=I-UNT'S UTNM PTR AND R15=   Y02669 47430002
         LR    R11,R12            I-UNT'S UCME, R11=I-UNT'S UCB  Y02669 47520002
         L     R5,UCMCOMPC        GET O-UNIT'S UCME PTR          Y02669 47610002
         L     R12,UCMUCB         O-UNIT'S UCB PTR               Y02669 47700002
         LA    R9,SIX(R9)         O-UNIT'S UNITNAME PTR          Y02669 47790002
         NI    XADUSWIT,FOX-XAIOCOMP TURN OFF I-UNIT FLAG      @Z30LPTJ 47880003
         OI    XADUSWIT,XAIPAREN  TURN ON O-UNIT'S FLAG        @Z30LPTJ 47970003
         B     ONTEST             GO SET BITS IN THE O-UNIT      Y02669 48060002
*                                                                Y02669 48150002
NOTCOMP  EQU   *                                                 Y02669 48240002
         TM    XADUSWIT,XAIPAREN  WAS IT THE O-UNIT PROCESSED  @Z30LPTJ 48330003
         BZ    OMSGPTR            NO, REG UNIT, GO ISSUE MSG     Y02669 48420002
         LR    R9,R8              YES, THEREFORE RESTORE I-UNT'S Y02669 48510002
         LR    R12,R11            POINTER REGISTERS              Y02669 48600002
         LR    R5,R6                                             Y02669 48690002
         NI    XADUSWIT,FOX-XAIPAREN TURN OFF O-UNIT FLAG      @Z30LPTJ 48780003
         OI    XADUSWIT,XAIOCOMP  TURN ON I-UNIT FLAG          @Z30LPTJ 48870003
*                                 ISSUE MSG FOR BOTH UNITS       Y02669 48960002
OMSGPTR  EQU   *                                                        49050002
         SPACE 10                                                       49140002
***************************************************              Y02651 49230002
*                                                                Y02651 49320002
*  SINCE A WTO MACRO WILL NOW BE ISSUED FOR THE DEVICE(S) JUST   Y02651 49410002
*  PROCESSED, ALL LOCKS MUST BE TEMPORARITY RELEASED AND RE-     Y02651 49500002
*  OBTAINED IF MORE DEVICES ARE TO BE PROCESSED                  Y02651 49590002
*                                                                Y02651 49680002
         BAL   R8,RELEASE                                        Y02651 49770002
*                                                                Y02651 49860002
***************************************************              Y02651 49950002
         SPACE 10                                                       50040002
*                                                                 19084 50130002
         LA    R15,ONLMSG           PT TO ONLINE MSG              19084 50220002
         B     OMSGS               GO ISSUE MSG FOR UNIT          19084 50310002
*                                                                 19084 50400002
         EJECT                                                          50490002
*********************************************************************** 50580002
*                                                                 19084 50670002
*       OFFLINE KEYWORD                                           19084 50760002
*                                                                 19084 50850002
*********************************************************************** 50940002
OOFFLN   EQU   *                                                  19084 51030002
*                                                                 19084 51120002
*                                                                 19084 51210002
*                                                                 19084 51300002
*************   PROCESS TO VARY CONSOLE TO OFFLINE STATUS         19084 51390002
*                                                                 19084 51480002
         TM    SRTESTAT,SRTESYSR   IS IT CURRENTLY A CONSOLE      19084 51570002
         BZ    UOFFTEST            NO, NOW IS USED AS IO DEV      19084 51660002
SETBITS  EQU   *                                                 Y02669 51750002
         OI    UCMSTS,UCMCF        SET CLOSE PENG BIT FOR C TASK Y02651 51840002
*                                                                Y02651 51930002
*        OI    UCBWGT,UCBVORSN                                   Y02651 52020002
*                                                                Y02669 52110002
*        OI    SRTESTAT,SRTECHGS+SRTEDADI  TURN ON/OFF CHANGEBIT Y02651 52200002
*                                  AND CONSOLE CHANGE STATUS BIT Y02651 52290002
*                                                                Y02651 52380002
*********** THE ABOVE INSTRUCTION WILL BE PROTECTED VIA THE      Y02651 52470002
*           COMPARE-AND-SWAP INSTRCTION                          Y02651 52560002
*                                                                Y02651 52650002
         STM   R4,R6,D68(R13)     SAVE USED REGS                 Y02651 52740002
OILOPER  EQU   *                                                 Y02651 52830002
         OIL   UCBWGT,UCBVORSN,WREGS=(4,5,6),REF=OUCB            Y02651 52920002
OICHGS   EQU   *                                                 Y02651 53010002
         OIL   SRTESTAT,SRTECHGS,WREGS=(4,5,6),REF=OUCB          Y02651 53100002
OILDADI  EQU   *                                                 Y02651 53190002
         OIL   SRTESTAT,SRTEDADI,WREGS=(4,5,6),REF=OUCB          Y02651 53280002
         LM    R4,R6,D68(R13)     RESTORE REGS                   Y02651 53370002
         OI    XADUSWIT,XAUBLANK  INDICATE MSG SENT            @Z30LPTJ 53460003
         TM    XADUSWIT,XAIOCOMP  PROCESSING I-UNIT OF COMP    @Z30LPTJ 53550003
         BZ    OFFPTR1            NO SEE IF IF IS O-UNIT OF COMP Y02669 53640002
         LR    R8,R9         YES,SAVE I-UNT'S REGS R8=UNTNM PTR  Y02669 53730002
         LR    R6,R5              STORE I-UNIT'S UCME PTR        Y02669 53820002
         LR    R11,R12            STORE I-UNIT'S UCB PTR         Y02669 53910002
         L     R5,UCMCOMPC        GET O-UNIT'S UCME PTR          Y02669 54000002
         L     R12,UCMUCB         GET O-UNIT'S UCB PTR           Y02669 54090002
         LA    R9,SIX(R9)         GET O-UNIT'S UNITNAME PTR      Y02669 54180002
         NI    XADUSWIT,FOX-XAIOCOMP TURN OFF I-UNIT FLAG      @Z30LPTJ 54270003
         OI    XADUSWIT,XAIPAREN  SET O-UNIT'S FLAG            @Z30LPTJ 54360003
         B     SETBITS            GO SET BITS IN THE O-UNIT      Y02669 54450002
*                                                                Y02669 54540002
OFFPTR1  EQU   *                                                 Y02669 54630002
         TM    XADUSWIT,XAIPAREN  WAS IF O-UNIT OF COMP        @Z30LPTJ 54720003
         BZ    OFFPTR             NO, REG UNIT, GO ISSUE MSG     Y02669 54810002
         LR    R9,R8              RESTORE I-UNIT'S REGISTER PTRS Y02669 54900002
         LR    R5,R6                                             Y02669 54990002
         LR    R12,R11                                           Y02669 55080002
         NI    XADUSWIT,FOX-XAIPAREN TURN OFF O-UNIT'S FLAG    @Z30LPTJ 55170003
         OI    XADUSWIT,XAIOCOMP  TURN ON I-UNIT FLAG          @Z30LPTJ 55260003
OFFPTR   EQU   *                                                  19084 55350002
         SPACE 10                                                       55440002
***************************************************              Y02651 55530002
*                                                                Y02651 55620002
*  SINCE A WTO MACRO WILL NOW BE ISSUED FOR THE DEVICE(S) JUST   Y02651 55710002
*  PROCESSED, ALL LOCKS MUST BE TEMPORARILY RELEASE AND          Y02651 55800002
*  REOBTAINED IF MORE DEVICES ARE TO BE PROCESSED                Y02651 55890002
*                                                                Y02651 55980002
         BAL   R8,RELEASE                                        Y02651 56070002
*                                                                Y02651 56160002
***************************************************              Y02651 56250002
         SPACE 10                                                       56340002
         LA    R15,OFFLMSG         OFFLINE MSG                    19084 56430002
         B     OMSGS               GO ISSUE MESSAGE               19084 56520002
*                                                                 19084 56610002
*                                                                 19084 56700002
UOFFTEST EQU   *                                                  19084 56790002
*        NI    SRTESTAT,FOX-SRTECHGS+SRTEDADI TURN OFF THE ON/OFFY02651 56880002
*                                  AND CONSOLE CHANGE STATUS BITSY02651 56970002
*                                                                Y02651 57060002
*********** THE ABOVE INSTRUCTION WILL BE PROTECTED VIA THE      Y02651 57150002
*           COMPARE-AND-SWAP INSTRUCTION                         Y02651 57240002
*                                                                Y02651 57330002
         STM   R4,R6,D68(R13)     SAVE REGS                      Y02651 57420002
OFFCHGS  EQU   *                                                 Y02651 57510002
         NIL   SRTESTAT,NILCHANG,WREGS=(4,5,6),REF=OUCB          Y02651 57600002
OFFDADI  EQU   *                                                 Y02651 57690002
         NIL   SRTESTAT,NILDADI,WREGS=(4,5,6),REF=OUCB           Y02651 57780002
*        OI    UCBWGT,UCBVORSN                                   Y02669 57870002
*                                                                Y02651 57960002
*********** THE ABOVE INSTRUCTION WILL BE PROTECTED VIA THE      Y02651 58050002
*           COMPARE-AND-SWAP INSTRUCTION                         Y02651 58140002
*                                                                Y02651 58230002
OILOPER2 EQU   *                                                 Y02651 58320002
         OIL   UCBWGT,UCBVORSN,WREGS=(4,5,6),REF=OUCB            Y02651 58410002
         LM    R4,R6,D68(R13)     RESTORE REGS                          58500002
         TM    SRTESTAT,SRTEONLI  IS DEV NOW IN ONLINE STATE            58590002
         BZ    TESTCOMP           OFFLINE, TO GO OFFLINE                58680002
*        OI    SRTESTAT,SRTECHGS  SET ON/OFF CHNG STTS IN UCB           58770002
ONCHGS   EQU   *                                                 Y02651 58860002
         OIL   SRTESTAT,SRTECHGS,WREGS=(4,5,6),REF=OUCB          Y02651 58950002
         LM    R4,R6,D68(R13)                                    Y02651 59040002
*                                                                Y02651 59130002
         L     R1,CVTPTR                                         Y02669 59220002
         USING OCVT,R1                                           Y02669 59310002
         L     R1,CVTMSER                                        Y02669 59400002
         DROP  R1                                                Y02669 59490002
         USING BASE,R1                                           Y02669 59580002
*        OI    MSECBFL,MSSUM   SET THE UCB-SEARCH FLAG IN MRC    Y02651 59670002
OIMSSUM  EQU  *                                                  Y02651 59760002
         OIL   MSECBFL,MSSUM,WREGS=(4,5,6),REF=BASE              Y02651 59850002
         LM    R4,R6,D68(R13)                                    Y02651 59940002
*                                                                Y02651 60030002
         DROP  R1                                                Y02669 60120002
         NI    XADUSWIT,FOX-XAUBLANK SET TO ISSUE NO-MESSAGES  @Z30LPTJ 60210003
         TM    XADUSWIT,XAIOCOMP  I-UNIT OF COMP PROCESSED     @Z30LPTJ 60300003
         BO    GETOUNT            YES, GET O-UNIT AND PROCESS    Y02669 60390002
         TM    XADUSWIT,XAIPAREN  NO, WAS IT THE O-UNIT        @Z30LPTJ 60480003
         BZ    OCONT2        NO,REGUNT,RELEASE AND GOTO NXT UNT  Y02669 60570002
         LR    R9,R8              YES, RESTORE I-UNITS REG PTRS  Y02669 60660002
*                                 R9 HAS I-UNIT'S UNITNAME PTR   Y02669 60750002
         LR    R5,R6              R5 HAS I-UNIT'S UCME PTR       Y02669 60840002
         LR    R12,R11            R12 HAS I-UNIT'S UCB PTR       Y02669 60930002
         NI    XADUSWIT,FOX-XAIPAREN TURN OFF O-UNIT FLAG      @Z30LPTJ 61020003
         OI    XADUSWIT,XAIOCOMP  TURN ON I-UNIT FLAG          @Z30LPTJ 61110003
OCONT2   EQU   *                                                 Y02669 61200002
         SPACE 10                                                       61290002
***************************************************              Y02651 61380002
*                                                                Y02651 61470002
*  THIS ONE DEVICE OF COMP DEVICES HAS BEEN PROCESSED            Y02651 61560002
*  RELEASE LOCKS BEFORE GOING TO THE NEXT DEVICE BECAUSE         Y02651 61650002
*  THERE MAY NOT BE A DEVICE TO PROCESS ANYWAY                   Y02651 61740002
*                                                                Y02651 61830002
         BAL   R8,RELEASE                                        Y02651 61920002
*                                                                Y02651 62010002
***************************************************              Y02651 62100002
         SPACE 10                                                       62190002
         B     OCONT              CONTINUE DO NO SEND MSG        Y02669 62280002
*                                                                Y02669 62370002
TESTCOMP EQU   *                                                 Y02669 62460002
         OI    XADUSWIT,XAUBLANK  SET TO SEND MSG              @Z30LPTJ 62550003
         TM    XADUSWIT,XAIOCOMP  I-UNIT OF COMP PROCESSED     @Z30LPTJ 62640003
         BZ    TESTO              NO CHECK IF O-UNIT OF COMP     Y02669 62730002
GETOUNT  EQU   *                                                 Y02669 62820002
         LR    R8,R9              SAVE I-UNIT'S UNITNAME PTR     Y02669 62910002
         LR    R6,R5              SAVE I-UNIT'S UCME PTR         Y02669 63000002
         LR    R11,R12            SAVE I-UNIT UCB PTR            Y02669 63090002
         L     R5,UCMCOMPC        GET O-UNIT'S UCME              Y02669 63180002
         L     R12,UCMUCB         GET O-UNIT'S UCB               Y02669 63270002
         LA    R9,SIX(R9)         GET O-UNIT'S UNITNAME PTR      Y02669 63360002
         NI    XADUSWIT,FOX-XAIOCOMP TURN OFF I-UNIT FLAG      @Z30LPTJ 63450003
         OI    XADUSWIT,XAIPAREN  SET O-UNIT FLAG              @Z30LPTJ 63540003
         B     UOFFTEST           GO SET BITS IN THE O-UNIT      Y02669 63630002
TESTO    EQU   *                                                 Y02669 63720002
         TM    XADUSWIT,XAIPAREN  WAS IT THE O-UNIT OF COMP    @Z30LPTJ 63810003
         BZ    OFFPTR             NO REG UNIT                    Y02669 63900002
         LR    R9,R8              YES, RESTORE I-UNIT'S REGS     Y02669 63990002
         LR    R5,R6                                             Y02669 64080002
         LR    R12,R11                                           Y02669 64170002
         NI    XADUSWIT,FOX-XAIPAREN TURN OFF O-UNIT FLAG      @Z30LPTJ 64260003
         OI    XADUSWIT,XAIOCOMP  TURN ON I-UNIT'S FLAG        @Z30LPTJ 64350003
         B     OFFPTR                                            Y02669 64440002
*                                                                Y02669 64530002
         EJECT                                                          64620002
*********************************************************************** 64710002
*                                                                 19084 64800002
*        MESSAGE ROUTINE                                          19084 64890002
*                                                                 19084 64980002
*********************************************************************** 65070002
*                                                                 19084 65160002
OMSGS    EQU   *                                                  19084 65250002
         TM    XAAVRANG,XAARNG1    VARY RANGE BEING PROCESSED? @Z30LPTJ 65280003
         BO    OCONT               YES, SUPPRESS THE MESSAGE   @Z30LPTJ 65330003
         ST    R13,XAK             SAVE SAVEAREA POINTER       @Z30LPTJ 65380003
         L     R11,XAD             STORE SWITCHES                 19084 65430002
         LM    R12,R13,XAS         STORE BITS AND SWITCHES        19084 65520002
         LM    R6,R7,XAR           STORE VERB CODE AND LIST POS  Y02669 65610002
         SR    R0,R0                                              19084 65700002
         L     R8,XAU              CONSOLE ID MUST BE SAVED    @Z30LPTJ 65790003
*                                  ACROSS MULTIPLE WTO'S                65880002
         TM    XAU,RIID            READER INTERPRETER COMMAND     19084 65970002
         BO    ORDR                SEND TO MASTER CONSOLE         19084 66060002
         IC    R0,XAU              NO, PICK UP CONSOLE ID         19084 66150002
ORDR     EQU   *                                                  19084 66240002
         MVC   XAH(FOR),OINTRO2    DECLARED MCSFLGS AND LENGTH    19084 66330002
         MVC   XAI(EIT),OBASIC     MESSAGE ID                     19084 66420002
         MVC   XAF(EIT),XAI+SVN    BLANK OUT REST                 19084 66510002
         MVC   XAI+TRE(TRE),ZERO(R15)   MOVE IN ACCURATE MSG ID   19084 66600002
         LA    R15,TRE(R15)          INDEX TO TEXT                19084 66690002
         MVC   XAT(NINETEEN),ZERO(R15) MOVE IN MESSAGE            21051 66780002
         MVC   XAT+NINETEEN(FOR),OEND  ROUT AND DESC CODES        21051 66870002
         MVC   XAF(TRE),ZERO(R9)   MOVE IN UNITS                  19084 66960002
*                                                                 19084 67050002
         LR    R1,R2                                              19084 67140002
*                                                                 19084 67230002
         WTO   MF=(E,(1))          ISSUE MESSGE                   19084 67320002
*                                                                 19084 67410002
*        RESTORE ENVIRONMENT                                      19084 67500002
*                                                                 19084 67590002
         ST    R11,XAD             RESTORE ALL SWITCHES AND INFO  19084 67680002
         STM   R12,R13,XAS         **                             19084 67770002
         L     R13,XAK             RESTORE SAVE AREA POINTER   @Z30LPTJ 67860003
         STM   R6,R7,XAR             **                          Y02669 67950002
         ST    R8,XAU              RESTORE CONSOLE ID IN XSA   @Z30LPTJ 68040003
         MVC   XAV(EIT),OVARY                                    Y02669 68130002
         MVC   XAX(EIT),MODID                                    Y02669 68220002
*                                                                 19084 68310002
OCONT    EQU   *                                                  19084 68400002
         TM    XADUSWIT,XAIPAREN  O-XXX OF A COMPOSITE         @Z30LPTJ 68490003
         BO    NOMONTR            YES, MNTOR CMD CHECKED ALREADY Y02669 68580002
         GETMAIN R,LV=EIGHTY8     GETMAIN CORE FOR PARAM LIST    Y02669 68670002
         ST    R13,TWELV(R1)      STORE VARY'S SAVE AREA PTR     Y02669 68760002
         LA    R14,FOR(R1)        ADDRESS OF PARAM LIST          Y02669 68850002
         ST    R14,ZERO(R1)                                      Y02669 68940002
         USING MPL,R14                                           Y02669 69030002
         XC    FOR(EIT,R1),FOR(R1)  ZERO PARAM AREA              Y02669 69120002
         OI    MPLPROC1,MPLCONS+MPLSTOP                          Y02669 69210002
*                                 SET THE VARY CONSOLE AND STOP  Y02669 69300002
*                                 ALL MONITOR CMDS - OPTION BITS Y02669 69390002
         OI    MPLTYPE1,MPLALL                                   Y02669 69480002
*                                 SET THE MONITOR JOBNAMES,MNTOR Y02669 69570002
*                                 STATUS AND MNITOR SESSIONS BIT Y02669 69660002
*                                 ON SO THEY WILL STOP ALL THREE Y02669 69750002
*                                 FROM GOING TO THIS CONSOLE     Y02669 69840002
*                                                                Y02669 69930002
*  REG 5 STILL PTS TO THE VARIED DEVICE'S UCME                   Y02669 70020002
*                                                                Y02669 70110002
         SR    R13,R13                                           Y02669 70200002
         IC    R13,UCMID          GET THE CONSOLE ID OF THE DEV  Y02669 70290002
         STC   R13,MPLID+ONE      PLACE IT IN THE PARAMLIST      Y02669 70380002
*                                 RIGHT JUSTIFIED                Y02669 70470002
         LA    R13,SIXTN(R1)       SAVE AREA FOR VMNTR PTR       Y02669 70560002
*                                                                Y02669 70650002
* REG 10 STILL HAS THE ADDRESS OF THE UCM                        Y02669 70740002
*                                                                Y02669 70830002
         L     R15,UCMMNTR        GET ADDRESS OF THE ROUTINE     Y02669 70920002
*                                 IEAVMNTR- FROM THE UCM         Y02669 71010002
         BALR  R14,R15            GO TO IEAVMNTR                 Y02669 71100002
*                                                                Y02669 71190002
         L     R13,TWELV(R1)      RE-ADDRESS R14 WITH CALLER'S   Y02669 71280002
         LA    R0,EIGHTY8         SIZE OF THE PARAM LIST AND SA  Y02669 71370002
         FREEMAIN R,LV=(0),A=(1)  FREE THE CORE                  Y02669 71460002
NOMONTR  EQU   *                                                 Y02669 71550002
         TM    XADUSWIT,XAIOCOMP   PROCESSING COMP I-XXX?      @Z30LPTJ 71640003
         BZ    ONOCOMP             NO                             19084 71730002
         LA    R9,SIX(R9)          INDEX TO O-XXX                 19084 71820002
         NI    XADUSWIT,FOX-XAIOCOMP TURN OFF COMP SWITCH      @Z30LPTJ 71910003
         OI    XADUSWIT,XAIPAREN   BUT TURN ON INTERNPAREN SW  @Z30LPTJ 72000003
         L     R5,UCMCOMPC         GET PTR TO O-UNITS UCME        19084 72090002
         L     R12,UCMUCB          GET PTR TO OUTPUT UCB          19084 72180002
         TM    XADUSWIT,XAUBLANK   MUST ISSUE THE MSG          @Z30LPTJ 72270003
         BZ    ONOCOMP            NO RETURN                             72360002
         LA    R15,OFFLMSG        YES, ASSUME OFFLINE MSG               72450002
         TM    XASOPCOD,XAON        WAS IT THE ONLINE MSG               72540003
         BZ    OMSGS              NO, OFFLINE MSG                       72630002
         LA    R15,ONLMSG         ONLINE MSG                            72720002
         B     OMSGS              GO ISSUE MSG FOR THE O-UNIT           72810002
*                                                                 19084 72900002
ONOCOMP  EQU   *                                                  19084 72990002
         TM    XADUSWIT,XAIPAREN   PROCESSING COMP O-UNIT?     @Z30LPTJ 73080003
         BZ    OENDCK              NO, OF                         19084 73170002
         LA    R9,ONE(R9)          YES,ADD ONE FOR INTERN PAREN   19084 73260002
         B     OENDCK              GO CHECK IF END                19084 73350002
*                                                                 19084 73440002
         SPACE 10                                                 19084 73530002
ONOMORE  EQU   *                                                  19084 73620002
         TM    XADUSWIT,XAUDVC     DO WE HAVE IOUNITS YET      @Z30LPTJ 73710003
         BZ    RETEXT              NO, RETURN                    Y02669 73800002
IOLOOP   EQU   *                                                  19084 73890002
         CLI   ZERO(R9),ONOFKEY    IS AN O-XXX FOR ONLINE/OFFLINE 19084 73980002
         BE    O3103D              YES, GO CHECK FURTHER          19084 74070002
OINDEX   LA    R9,ONE(R9)          INDEX TO NEXT CHARACTER        19084 74160002
         B     IOLOOP              GO CHECK FOR -O-               19084 74250002
*                                                                 19084 74340002
O3103D   EQU   *                                                  19084 74430002
         CLI   ONE(R9),NLINE       MAKE SURE IF KEYWORD, IS IT AN -N-   74520002
         BE    OEXT                YES, GO TO 3103D               19084 74610002
         CLI   ONE(R9),FFLINE      NO, IS IT AN -F- FOR FFLINE    19084 74700002
         BNE OINDEX                NO, KEYWORD NO FOUND YET       19084 74790002
*                                                                 19084 74880002
OEXT     EQU   *                                                  19084 74970002
         BCTR  R9,ZERO             PT TO COMMA BEFORE KEYWORD     19084 75060002
         ST    R9,XAR              3103D NEEDS THIS POINTER       19084 75150002
         MVC   XAX+TRE(TWO),IOMOD      3103D NAME                Y02669 75240002
         LM    R0,R15,ZERO(R13)    RESTORE REGS                  Y02669 75330002
         L     R15,VCON31         ADDRESS OF IEE3103D            Y02669 75420002
         BR    R15                GO TO 3103D                    Y02669 75510002
*                                                                 19084 75600002
*                                                                 19084 75690002
*                                                                 19084 75780002
         SPACE 5                                                        75870002
RETEXT   EQU   *                                                 Y02669 75960002
         TM    XAAVRANG,XAARNG1    VARY RANGE BEING PROCESSED? @Z30LPTJ 75970003
         BNO   PROCEED             NO, PROCEED NORMALLY        @Z30LPTJ 75980003
         L     R15,VCON904         GET IEECB904 ADDRESS        @Z30LPTJ 75990003
         BR    R15                 GO TO VARY RANGE PROCESSOR  @Z30LPTJ 76000003
PROCEED  EQU   *                                               @Z30LPTJ 76010003
         SPACE 5                                                        76050003
***************************************************              Y02651 76140002
*                                                                Y02651 76230002
*  THIS IS A TERMINAL EXIT.  THE ENQ ISSUED IN MODULE            Y02651 76320002
*  IEE3603D                                                      Y02651 76410002
*  WE MUST BE DEQUEUED HERE                                      Y02651 76500002
*                                                                Y02651 76590002
         DEQ   MF=(E,IEFDEQUE)                                   Y02651 76680002
*                                                                Y02651 76770002
***************************************************              Y02651 76860002
         SPACE 5                                                        76950003
         L     R1,D64(R13)         GET CSCB PTR                  Y02669 77040002
         USING CHAIN1,R1                                         Y02669 77130002
         OI    CHSTS,CHFC          SET TO FREE CSCB              Y02669 77220002
         MGCR  (1),CHAIN                                         Y02669 77310002
         LM    R0,R15,ZERO(R13)    RESTORE REGS                  Y02669 77400002
         LR    R4,R14              SAVE RETURN ADDRESS           Y02669 77490002
*                                  FREE SAVE AREA GOTTEN IN 3303DY02669 77580002
         LR    R1,R2               DUMMY XSA POINTER             Y02669 77670002
         LA    R0,D132             DUMMY XSA SIZE                Y02669 77760002
         FREEMAIN R,LV=(0),A=(1)                                 Y02669 77850002
*                                  FREE DUMMY XSA GOTTEN IN 3603DY02669 77940002
         LR    R14,R4              RESTORE RETURN REG            Y02669 78030002
         BR    R14                 RETURN                        Y02669 78120002
         EJECT                                                          78210002
*********************************************************************** 78300002
*                                                                 19084 78390002
*       DECLARES                                                  19084 78480002
*                                                                 19084 78570002
*********************************************************************** 78660002
         DS    0F                                                Y01022 78750002
OOUNIT   DC    C'O-'               O-XXX                          19084 78840002
OIUNIT   DC    C'(I-'              COMPOSITE                      19084 78930002
*                                                                 19084 79020002
OINTRO2  DC    X'0027A100'             LENGTH AND MCSFLAGS        21051 79110002
OBASIC   DC    C'IEE   I '         MSG ID                         19084 79200002
OEND     DC    X'08000000'         DESC AND ROUT CODES            19084 79290002
*                                                                 19084 79380002
         SPACE 10                                                 19084 79470002
*                                                                 19084 79560002
IOMOD    DC    C'31'         IO VARY MODULE                      Y02669 79650002
OVARY    DC    C'VARY    '         VARY COMMAND                   19084 79740002
         DS    0F                                                Y02669 79830002
VCON31   DC    V(IEE3103D)        VCON OF IEE3103D               Y02669 79920002
VCON904  DC    V(IEECB904)        VCON OF IEECB904             @Z30LPTJ 79960003
MODID    DC    C'IEE4603D'                                       Y02669 80010002
*                                                                 19084 80100002
         EJECT                                                          80190002
*****************************************************************Y02651 80280002
*                                                                Y02651 80370002
*  THE LIST FORM OF THE DEQ MACRO INSTRUCTION FOLLOWS            Y02651 80460002
*                                                                Y02651 80550002
IEFDEQUE DEQ   (IEFSQCBS,IEFQ4QCB,TWO,SYSTEM,IEFSQCBS,IEFVQCBS,SVN,    *80660002
               SYSTEM),RET=HAVE,MF=L                           @YM5443P 80680002
IEFVQCBS DC    C'VARYDEV'                                               80700002
IEFSQCBS DC    C'SYSIEFSD'                                       Y02651 80730002
IEFQ4QCB DC    C'Q4'                                             Y02651 80820002
*                                                                Y02651 80910002
*****************************************************************Y02651 81000002
         EJECT                                                          81090002
*****************************************************************Y02651 81180002
*                                                                Y02651 81270002
*  THE RELEASE-LOCKS SUBROUTINE FOLLOWS                          Y02651 81360002
*  THESE LOCKS WERE OBTAINED IN THIS MODULE AT:                  Y02651 81450002
*        OSETLOCK                                                Y02651 81540002
*                                                                Y02651 81630002
         DS    0H                                                       81670002
RELEASE  EQU   *                                                 Y02651 81720002
         LR    R0,R8                                             Y02651 81810002
*                                 SAVE RETURN ADDRESS            Y02651 81900002
         LR    R8,R13             SAVE AREA POINTER              Y02651 81990002
         STM   R11,R14,D68(R8)                                   Y02651 82080002
         SETLOCK RELEASE,TYPE=CMS,RELATED=(IEE4603D(OSETLOCK))   Y02651 82170002
         SETLOCK RELEASE,TYPE=LOCAL,RELATED=(IEE4603D(OSETLOCK)) Y02651 82260002
         LM    R11,R14,D68(R8)                                   Y02651 82350002
         LR    R8,R0              RESTORE RETURN ADRS            Y02651 82440002
         BR    R8                                                Y02651 82530002
*                                                                Y02651 82620002
*****************************************************************Y02651 82710002
         EJECT                                                          82800002
*********************************************************************** 82890002
*                                                                 19084 82980002
*        MESSAGES                                                 19084 83070002
*                                                                 19084 83160002
*********************************************************************** 83250002
*                                                                 19084 83340002
ONLMSG   DC    C'302'              ID OF ONLINE MSG               19084 83430002
         DC    C'ONLINE             '  TEXT                       21051 83520002
*                                                                 19084 83610002
*                                                                 19084 83700002
*                                                                 19084 83790002
OFFLMSG  DC    C'303'              ID OF OFFLINE MSG              19084 83880002
         DC    C'OFFLINE            '  TEXT                       21051 83970002
*                                                                 19084 84060002
         SPACE 5                                                        84150002
PATCH    DC    CL80'***IEE4603D***'                                     84240002
         EJECT                                                          84330002
OXSA     DSECT                                                          84420002
         IEEXSA                                                         84510002
         EJECT                                                          90450002
         IEZMPL                                                         90540002
         EJECT                                                          90630002
OCVT     DSECT                                                          90720002
         CVT                                                            90810002
         EJECT                                                          90900002
OUCM     DSECT                                                          90990002
         IEECUCM  FORMAT=NEW                                            91080002
         EJECT                                                          91170002
OUCB     DSECT                                                          91260002
         IEFUCBOB                                                       91350002
         EJECT                                                          91440002
CHAIN1   DSECT                                                          91530002
         IEECHAIN                                                       91620002
         EJECT                                                          91710002
         IEEBASEA                                                       91800002
         EJECT                                                          91890002
         IHAPSA                                                         91980002
         END                                                            92070002
./  ADD  SSI=83110966,NAME=IEE4703D
 TITLE ' IEE4703D - VARY HARDCPY PROCESSOR'                             00100002
HUCMSET  DSECT                                                          00200018
         IEECUCM  FORMAT=NEW                                            00400002
         EJECT                                                          00600018
         IEEBASEA                                                       00800018
         EJECT                                                          01000018
HXSASET  DSECT                                                          01200018
         IEEXSA                                                         01400018
         EJECT                                                          06400018
HCVTSET  DSECT                                                          06600018
         CVT   SYS=VMS                                                  06800018
         EJECT                                                          07600018
IEE4703D CSECT                                                          07800018
*                                                                       07808003
* A HROUTRTN  APPROX 358500   KK2 APPROX 369000                @ZA12703 07816003
* D HROUTRTN  APPROX 355500   KPAR7 APPROX 400000-403000       @ZA12703 07822003
* A KPAR3     APPROX 387500                                    @ZA12703 07828003
*                                                                       07840003
*****************************************************************Y02669 07850002
*                                                                Y02669 07900002
*  THE COMMAND PROCESSED IN THIS MODULE IS:                      Y02669 07950002
*                                                                Y02669 07960002
*                     ***     *** ***                               *** 07970002
*   ***    ***        *         * *        ***                    *** * 07980002
*   *        *        *  NOCMDS * *        *                        * * 07990002
*   * XXX    *        *  INCMDS * *        * ALL                    * * 07992002
* V *        *,HARDCPY* ,STCMDS * * ,ROUT= * NONE                   * * 07994002
*   * SYSLOG *        *  CMDS   * *        * ROUTCODE(,ROUTCODE...  * * 07996002
*   *        *        *  OFF    * *        *                        * * 07998402
*   ***    ***        *         * *        ***                    *** * 07998802
*                     ***     *** ***                               *** 07999202
*****************************************************************Y02669 08000002
*                                                                       08050002
         EJECT                                                          08060002
**********************************************************************  08070002
* MODULE NAME      = IEE4703D                                           08100002
*    CSECT NAME    = IEE4703D                                           08110002
*                                                                       08150002
* LOAD MODULE NAME = IGC0003D                                           08200002
*                                                                       08250002
* DESCRIPTIVE NAME = VARY HARDCPY OPERAND PROCESSOR                     08400002
*                                                                       08450002
* COPYRIGHT        = MISSING                                            08600002
*                                                                       08650002
* STATUS           = OS/VS/2 RELEASE 3  PTF UZ05997            @ZA12703 08670003
*                                                                       08750002
* FUNCTION         = THIS MODULE INDICATES WHAT CHANGE ARE  TO          08900002
*                    BE MADE BY SETTING BITS IN THE XSA.                08950002
*                    1. IT VALIDITY CHECKS ROUTING CODES IF THEY        09000002
*                       ARE SPECIFIED AND INITIALIZES A FIELD,          09050002
*                       (XRTCODE), WHICH CONTAINS NEW ROUTING           09100002
*                       CODES.  IT ALSO SETS A BIT TO INDICATE          09150002
*                       THAT ROUTING CODES ARE CHANGING.                09200002
*                    2. IT VALIDITY CHECKS THE NEW AUTHORITY IF IT      09250002
*                       IS SPECIFIED.  IT SETS A BIT INDICATING         09300002
*                       WHAT THE NEW AUTHORITY WILL BE AND A BIT        09350002
*                       INDICATING THAT THE AUTHORITY IS CHANGING.      09400002
*                                                                       09450002
* OPERATION        = UPON RECEIVING CONTROL, THE COMMAND AUTHORITY      09500002
*                    OF THE ISSUING CONSOLE IS CHECKED.  IF THE         09550002
*                    ISSUER WAS THE MASTER CONSOLE, THE SYNTAX          09600002
*                    OF THE UNIT FIELD, AND THE PRESENCE OF             09650002
*                    KEYWORDS SUCH AS ROUT=,CMDS,STCMDS,INCMDS,         09700002
*                    NOCMDS,OFF ARE CHECKED.                            09750002
*                    IF HARDCPY,OFF  WAS ISSUED FROM THE MASTER         09800002
*                    CONSOLE, THAN CONTROL IS GIVEN TO ITS              09850002
*                    PROCESSOR - IEE5703D-.                             09900002
*                                                                       09950002
* NOTES                                                                 09960002
*    DEPENDENCIES  = NONE                                               09970002
*    CHARACTER/CODE DEPENDENCIES                                        09980002
*                  = THIS MODULE CAN BE ASSEMBLED WITH ANY NEW          09990002
*                    CHARACTER/CODE SET.                                09992002
*                                                                       10042002
* RESTRICTIONS     = REG2 PTS TO THE XSA ON INPUT                       10150002
*    REGISTER CONVENTIONS                                               10200002
*                  = REGISTER ARE DEFINED AT LABEL: DEFREG              10210002
*    PATCH LABEL   = PATCH                                              10220002
*                                                                       10250002
* MODULE TYPE      = CSECT                                              10260002
*    PROCESSOR     = ASSEMBLER                                          10270002
*    MODULE SIZE   = VS/2 = '2BE'                              @Z30LPTJ 10280003
*    ATTRIBUTES    = REENTRANT, REUSABLE, REFRESHABLE, PAGED LPA,       10300002
*                    ZERO PSW PROTECT KEY, SUPERVISOR MODE              10350002
*                                                                       10400002
* ENTRY POINT      = IEE4703D FROM IEE3203D                             10550002
*    PURPOSE       = TO BEGIN PROCESSING A VARY HARDCPY COMMAND         10600002
*    LINKAGE       = BRANCH                                             10650002
*    INPUT         = REG2 POINTS TO THE XSA                             10700002
*                    XAR POINTS TO THE COMMAND BUFFER                   10750002
*                    XAL POINTS TO THE COMMAND PARAMETERS               10800002
*                    IN THE COMMAND BUFFER                              10850002
*                    XAV CONTAINS THE VERB                              10900002
*    REGISTERS SAVED= NONE                                              10950002
*    REGISTER USAGE= R2  XSA PTR                                        11050002
*                    R5  UCME PTR                                       11100002
*                    R6  EXTERIOR PARENS SWITCH                         11150002
*                    R7  END OF BUFFER PTR                              11200002
*                    R9  UNIT PTR                                       11250002
*                    R10 UCM PTR                                        11300002
*                    R11 UMPRFX PTR                                     11350002
*    REGISTERS RESTORED                                                 11400002
*                  = NONE                                               11450002
*                                                                       11500002
* EXITS - NORMAL 1 = TO IEE7203D                                        11550002
*                    VIA BRANCH                                         11600002
*    CONDITIONS    = WHEN INITIAL UNIT SCAN HAS COMPLETED               11650002
*                    WE EXIT TO 7203D TO PROCESS THE UNIT OR            11700002
*                    SYSLOG PARM AND TO MAKE ANY CHANGES TO THE         11750002
*                    ROUTING OR HARDCPY FUNCTIONS.                      11800002
*   OUTPUT         = R2 PTS TO THE XSA                                  11850002
*   RETURN CODES   = NONE                                               11900002
*                                                                       12000002
* EXITS - NORMAL 2 = TO IEE5703D                                        12050002
*                    VIA BRANCH                                         12100002
*    CONDITIONS    = TO PROCESS A HARDCPY,OFF COMMAND                   12150002
*    OUTPUT        = REG 2 PTS TO THE XSA                               12200002
*                    XAE = X'00'                                        12250002
*    RETURN CODES  = NONE                                               12300002
*                                                                       12400002
* EXITS - ERROR    = TO IEE5703D VIA BRANCH                             12450002
*    CONDITIONS    = ERROR HAS BEEN DETECTED IN THE COMMAND             12550002
*    OUTPUT        = REG2 PTR TO THE XSA                                12600002
*                    XAE = X'20' - MEANS:  IEE5703D MUST GO             12650002
*                                 TO IEE0503D FOR MSG:                  12700002
*                                 'IEE309I UNIDENTIFIABLE KEYWORD'      12750002
*                    XAE = X'24' - MEANS:  IEE5703D MUST GO             12800002
*                                 TO IEE2103D FOR MSG:                  12850002
*                                 'IEE345I AUTHORITY INVALID'           12900002
*                    XAE = X'28' - MEANS: IEE5703D MUST GO              12950002
*                                 TO IEE0503D FOR MSG:                  13000002
*                                 'IEE306I INVALID NUMERICS'            13050002
*    RETURN CODES  = NONE                                               13100002
*                                                                       13200002
* EXTERNAL REFERENCES                                                   13250002
*    ROUTINES      = IEE7203D                                           13300002
*                  = IEE5703D                                           13350002
*    DATA AREAS    = SEE EXITS - OUTPUT - DATA                          13400002
*                                                                       13450002
* CONTROL BLOCKS   = .EXTENDED SAVE AREA (XSA)                          13500002
*                    .UNIT CONTROL MODULE (UCM)                         13550002
*                       FIELDS TESTED  - UCMDISP- BIT= UCMDISPA         13600002
*                                        UCMVEA                         13650002
*                       FIELDS UPDATED - NONE                           13700002
*                    .CVT                                               13750002
*                       FIELDS TESTED  - CVTCUCB                        13800002
*                       FIELDS UPDATED - NONE                           13850002
*                                                                       13900002
* TABLES           = NONE                                               13950002
*                                                                       14000002
* MACROS           = NONE                                               14050002
*                                                                       14100002
* MAPPING MACROS   = IEEXSA                                             14150002
*                    IEECUCM                                            14200002
*                    CVT                                                14250002
*    SERIALIZATION = NO SERIALIZATION IS REQUIRED IN THIS MODULE.       14260002
*                    ONLY FIELD TESTED IS 'UCMDISP' AREA IN THE UCM TO  14270002
*                    CHECK BIT = UCMDISP = DID THE MASTER CONSOLE       14280002
*                    ISSUE THE COMMAND (SINCE IT IS ONLY VALID FROM     14290002
*                    THE MASTER CONSOLE.)                               14292002
*                    A SITUATION COULD ARISE WHERE THE 'MASTER CONSOLE' 14294002
*                    IS CHANGING TO OR FROM THE MASTER CONSOLE STATE    14296002
*                    WHEN CONTROL IS RECEIVED IN THIS MODULE FOR A      14298402
*                    VARY HARDCPY OR VARY HARDCPY,OFF COMMAND.          14298802
*                    HOWEVER, IF IT IS CHANGING TO THE MASTER CONSOLE   14299202
*                    STATE AND THE UCMDISP BIT IS STILL NOT ON, THEN    14299602
*                    THE COMMAND IS REJECTED AS IT WOULD HAPPEN IF THE  14299702
*                    BIT WAS OFF AND TECHNICALLY, AS LONG AS THE        14299802
*                    BIT IS OFF THE DEVICE IS NOT THE MASTER.           14299902
*                    IF IT IS CHANGING TO THE MASTER CONSOLE STATE AND  14333202
*                    AND THIS BIT IS ON ALREADY, THEN IT IS A MASTER    14383202
*                    CONSOLE AND CAN ISSUE THIS COMMAND ANYWAY. (A LOCK 14393202
*                    WOULD NOT CHANGE THESE SITUATIONS)                 14395202
*                    IF IT IS CHANGING OUT OF THE MASTER CONSOLE STATE  14397202
*                    WHETHER A LOCK IS HELD OF NOT IN THIS FIELD, AS    14399202
*                    LONG AS UCMDISPA IS STILL ON, THIS DEVICE IS       14399602
*                    TECHNICALLY STILL THE MASTER CONSOLE AND CAN       14399702
*                    ISSUE THIS COMMANDS.                               14399802
*                                                                       14400002
* CHANGE LEVEL     = Y02669, Y02651, Z30LPTJ, ZA12703          @ZA12703 14420003
*                                                                       14500002
* CHANGE ACTIVITY  = N/A                                                14510002
*                                                                       14520002
* MESSAGES         = REFER TO EXITS - ERROR                             14550002
*                                                                       14600002
* ABEND CODES      = NONE                                               14750002
*                                                                       14800002
* PACKAGING        = IEE4703D WILL BE PART OF LOAD MODULE               14950002
*                       = IGC0003D                                      15000002
*                    THIS LOAD MODULE ALIASES ARE                       15050002
*                       = NONE                                          15100002
*                    THIS LOAD MODULE ENTRY POINTS ARE                  15150002
*                       = IGC0003D                                      15200002
*                    THIS ROUTINE WILL RESIDE IN: LPALIB                15210002
*                                                                       15250002
* SYSGEN           = SUPPLIED BY THE FOLLOWING SECTIONS:                15450002
*                    LOAD MODULE NAME                                   15500002
*                    PACKAGING                                          15550002
*                    THIS CSECT WILL BE INCLUDED AT SYSGEN FROM         15560002
*                    DLIB -AOSB3- BY MACRO -SGIEF441-                   15570002
*                                                                       15600002
* SYSTEM LIBRARIES = NONE                                               15650002
*                                                                       15700002
*********************************************************************** 26000018
      EJECT                                                             26050002
F0       EQU   X'F0'                                              M3945 26060020
F1       EQU   X'F1'                                              M3945 26070020
F6       EQU   X'F6'                                              M3945 26080020
F9       EQU   X'F9'                                              M3945 26090020
         EJECT                                                          26100018
* HARDCOPY PROCESSOR REGISTER ASSIGNMENTS-                            * 26200018
         SPACE 10                                                       26300019
DEFREG   EQU   *                                                 Y02669 26350002
R0      EQU   0                                                         26400018
R1       EQU   1                                                  19084 26450019
R2       EQU   2                   XSA                            19084 26500019
R3       EQU   3                   ADDRESS                        19084 26550019
R4       EQU   4                   UCME                           19084 26600019
R5       EQU   5                                                  19084 26650019
R6       EQU   6                                                        26700019
R7       EQU   7                                                        26750019
R8       EQU   8                   STAE                           19084 26800019
R9       EQU   9                   UNIT PTR                       19084 26850019
R10      EQU   10                  UCM                            19084 26900019
R11      EQU   11                  UCMPFX                         19084 26950019
R12      EQU   12                  UNIT PTR IF 0,ITS SYSLOG       19084 27000019
R13      EQU   13                                                       27050019
R14      EQU   14                      RETURN REGISTER                  27100019
R15      EQU   15                                                 19084 27150019
         SPACE 10                                                       27200019
*                                                                       27250019
* ISSUING CONSOLE IDENT MASKS                                           27300019
*                                                                       27350019
HSYSTEM  EQU   0                       SYSTEM ISSUING ID                27400019
HRI      EQU   X'80'                   READER/INTERPRETER ID            27450019
*                                                                       27500019
         SPACE 5                                                        27550019
*                                                                       27600019
* ERROR MESSAGE CODES                                                   27650019
*                                                                       27700019
ERR41    EQU   24                  AUTHORITY INVALID - 2103D      19084 27750019
ERR9     EQU   20                  KEYWORD MISPELLED - 0503D      19084 27900019
ERR6     EQU   28                  INVALID NUMERICS - 0503D       19084 27950019
*                                                                       28000019
         SPACE 5                                                        28050019
*                                                                 19084 28100019
* GENERAL EQUATES                                                 19084 28150019
*                                                                 19084 28200019
HOFFCD   EQU   X'00'               VARY HARDCPY,OFF      5703D    19084 28400019
*                                                                 19084 28500019
*                                                                 19084 28550019
BLANK    EQU   C' '                                                     28600019
COMMA    EQU   C','                                               19084 28650019
BLK      EQU   C' '                                               19084 28700019
LEFPAREN EQU   C'('                                               19084 28750019
RTPAREN  EQU   C')'                                               19084 28800019
*                                                                       28850019
* NUMERAL EQUATES                                                 19084 28900019
*                                                                 19084 28950019
ZERO     EQU   0                                                        29000019
ONE      EQU   1                                                        29050019
TWO      EQU   2                                                        29100019
TRE      EQU   3                                                        29150019
FOR      EQU   4                                                        29200019
FIV      EQU   5                                                        29250019
SIX      EQU   6                                                        29300019
EIT      EQU   8                                                        29350019
ELEV     EQU   11                                                       29400019
SVN      EQU   7                                                        29450019
TWLV     EQU   12                                                 19084 29500019
SIXTN    EQU   16                                                 19084 29600019
FOX      EQU   255                                                      29650019
         EJECT                                                          29700019
*********************************************************************** 29750019
*                                                                     * 29800019
* HARDCOPY PROCESSING MODULE                                          * 29850019
*                                                                     * 29900019
*********************************************************************** 29950019
         BALR  R3,ZERO             ADDRESSABILITY                 19084 30000019
         USING *,R3                                               19084 30050019
         MODID BR=YES                                            Y01886 30060001
         USING XSA,R2                                             19084 30100019
         MVC   XAX(EIT),HCPYMOD                                  Y02669 30110002
         L     R15,CVTPTR          CVT POINTER                    19084 30150019
         USING HCVTSET,R15                                        19084 30200019
         L     R10,CVTCUCB         PTR TO UCM                     19084 30250019
         USING UCM,R10                                           Y02669 30300002
*                                                                 19084 30350019
         LR    R11,R10             PTR TO UCM                     19084 30400019
         LA    R1,FOR                                             19084 30450019
         SR    R11,R1              MINUS FOUR IS PTR TO PFX       19084 30500019
         L     R11,ZERO(R11)                                      19084 30550019
         USING UCMPRFX,R11                                        19084 30600019
         L     R9,XAL              PTR TO UNITS                   19084 30650019
         LA    R9,ZERO(R9)         CLEAR HIGH ORDER BYTE          19084 30700019
         XC    XAS(EIT),XAS                                       19084 30750019
*********************************************************************** 30800019
*                                                                       30850019
* CHECK OF COMMAND AUTHORITY FOR VARY HARDCPY                           30900019
*                                                                       30950019
*********************************************************************** 31000019
         CLI   XAU,HSYSTEM         DID SYSTEM ISSUE THE COMMAND         31050019
         BE    HSYNTAX                   YES,BEGIN UNIT SCAN      19084 31100019
*                                                                       31150019
         CLI   XAU,HRI             DID THE R/I ISSUE IT                 31200019
         BNE   HCONSOLE                NO,CHECK CONSOLES CMD AUTHORITY  31250019
         MVI   XAU,HSYSTEM             R/I MESSAGES ALSO RETURN MSTCONS 31300019
HERR1    EQU   *                                                  19084 31350019
         MVI   XAE,ERR41           ERROR IS AUTHORITY INVALID     19084 31400019
         B     HOFFMVC             GO TO XCTL ROUTINE             19084 31450019
*                                                                 19084 31500019
HCONSOLE EQU   *                                                  19084 31550019
         SR    R5,R5                                              19084 31600019
         IC    R5,XAU              ISSUING CONSOLE ID             19084 31650019
         LM    R6,R7,UCMVEA        PTR TO 1ST UCME AND SIZE       19084 31700019
*                                                                 19084 31750019
         BCTR  R5,ZERO             MINUS1                         19084 31800019
         MR    R4,R7               TIMES ZIZE                     19084 31850019
         AR    R5,R6               PLUS ADDR OF 1ST UCME          19084 31900019
         USING UCMLIST,R5                                         19084 31950019
         TM    UCMDISP,UCMDISPA    MASTER CONSOLE WAS ISSUED      19084 32000019
         BZ    HERR1               NO, AUTHORITY INVALID          19084 32050019
         DROP  R5                                                 19084 32100019
         EJECT                                                          32150019
*********************************************************************** 32200019
*                                                                 19084 32250019
*        SYNTAX SCAN, TRY TO FIND SECONDARY KEYWORD               19084 32300019
*                                                                 19084 32350019
*********************************************************************** 32400019
*        R9 PTS TO BEGINNING OF UNIT FIELD                        19084 32450019
*                                                                 19084 32500019
*        A.    SCAN TOWARDS -,HARDCPY-                            19084 32550019
*        *******************************                          19084 32600019
HSYNTAX  EQU   *                                                  19084 32650019
         LR    R12,R9              SAVE UNIT PTR                  19084 32700019
HLOOPFND EQU   *                                                  19084 32750019
         CLI   ZERO(R9),COMMA      IS THIS THE UNITS COMMA        19084 32800019
         LA    R9,ONE(R9)          NO, INDEX BY ONE               19084 32850019
         BNE   HLOOPFND            GO CHECK NEXT CHARACTER        19084 32900019
         SPACE 10                                                 19084 32950019
*        FOUND KEYWORD                                            19084 33000019
*        B.    INDEX PAST KEYWORD AND CHECK FOR OTHERS PRESENT    19084 33050019
*        ******************************************************** 19084 33100019
HKEYFND  EQU   *                                                  19084 33150019
         LA    R9,SVN(R9)          INDEX PAST KEYWORD             19084 33200019
         CLI   ZERO(R9),COMMA      COMMA FOLLOWS KEYWORD          19084 33250019
         BNE   HEOB                NO, GO CHECK END OF BUFFER     19084 33300019
         SPACE 10                                                 19084 33350019
*                                                                 19084 33400019
*        OTHER KEYWORDS ARE PRESENT                               19084 33450019
*        C.    CHECK FOR CMDS,NOCMDS,OFF AND ,                    19084 33500019
*        ****************************************                 19084 33550019
         CLC   ONE(FOR,R9),HCMDS       IS IS CMDS TO HCPY KEYWORD 19084 33600019
         BE    HSET1               YES, GO SET SWITCHES           19084 33650019
         CLC   ONE(SIX,R9),HNOCMDS     IS IT CMDS NOT TO HCPY     19084 33700019
         BNE   HSP8                NO MAYBE OTHER KEYWORD         19084 33750019
INCRMT   EQU   *                                                  21002 33760001
         LA    R9,SVN(R9)          INDEX PAST IT                  19084 33800019
HSP6     EQU   *                                                  19084 33850019
         OI    XASOPCOD,XACMD     TURN ON CMD TO BE CHANGED BIT@Z30LPTJ 33900003
         B     HROUTCK                 CHECK ROUT KEYWORD.        21002 33910001
*                                                                 19084 33950019
HSP8     EQU   *                                                  19084 34450019
         CLC   ONE(SIX,R9),HINCMDS     IS THIS INCMDS             21002 34492001
         BE    HSET3                   SET BITS TO INDICATE INCMDS21002 34494001
         CLC   ONE(SIX,R9),HSTCMDS     IS THIS STCMDS             21002 34496001
         BE    HSET4                   YES, SET BITS TO INDICATE  21002 34498001
         LA    R9,ONE(R9)          INDEX BY ONE                   19084 34500019
         CLC   ZERO(TRE,R9),HOFF       IS IT THE HARDCPY,OFF      19084 34550019
         BNE   HROUTCK             NO, CHECK IF ,ROUT= PRESENT    19084 34600019
*                                  FOR HARDCPY,, CMD              19084 34650019
         MVI   XAE,HOFFCD          SER ,OFF CODE FOR 5703D        19084 34700019
         B     HOFFMVC             GO TO 5703D EXIT               19084 34750019
HSET1    EQU   *                                                  19084 34800019
         OI    XASWITCH,XAHRDCMD   TURN TO MEAN THAT CMDS ARE  @Z30LPTJ 34850003
         LA    R9,FIV(R9)          INDEX PAST KEYWORD             19084 34900019
         B     HSP6                GO CHECK ENDINGS               19084 34950019
HSET3    EQU   *                                                  21002 34960001
         OI    XASWITCH,XAINHDCP       INDICATE INCMDS         @Z30LPTJ 34970003
         B     INCRMT                  INCREMENT PAST INCMDS.     21002 34982001
HSET4    EQU   *                                                  21002 34990001
         OI    XASWITCH,XASTHDCP       INDICATE STCMDS         @Z30LPTJ 34992003
         B     INCRMT                  INCREMENT PAST STCMDS.     21002 34994001
         SPACE 6                                                  21002 35000001
*        D.    CHECK FOR PRESENCE OF ROUT= KEYWORD                21002 35010001
*        **********************************************           21002 35020001
HROUTCK  EQU   *                                                  21002 35030001
         CLC   ZERO(SIX,R9),HROUT      IS ,ROUT=PRESENT           21002 35040001
         BE    HROUTRTN                YES,GO CHECK ROUT=         21002 35042001
         CLC   ZERO(FIV,R9),HROUT+ONE  IS IT 'ROUT='              21002 35044001
         BNE   HEOB                    NO, CHECK END OF BUFFER    21002 35046001
         BCTR  R9,ZERO                 MINUS ONE                  21002 35048001
         EJECT                                                    19084 35050019
*                                                                 19084 35100019
*        E.    ROUT= IS PRESENT                                   19084 35150019
*        **************************                               19084 35200019
*                                                                 19084 35250019
*********************************************************************** 35300019
*              VALUES FOR ROUT=                                   19084 35350019
**********************************************************************  35400019
*                                                                 19084 35450019
HROUTRTN EQU   *                                                  19084 35500019
         SR    R6,R6               CLEAR EXTERIOR PARENS SWITCH   19084 35550019
         LA    R9,SIX(R9)       UPDATE TO PARM                    19084 35650019
         CLI   ZERO(R9),LEFPAREN   ARE THERE INDIVIDUAL ROUTCODES 19084 35700019
         BE    KPAREN2        YES, GO PROCESS                     19084 35750019
         CLC   ZERO(TRE,R9),KALL   ARE ALL RTCDS TO BE ASSIGNED   19084 35800019
         BNE   KK2            NO, GO CHECK FOR OTHERS             19084 35850019
         OI    XASWITCH,XAROUT       ROUT CODES TO BE CHANGED  @ZA12703 35870003
         MVC   XARTCODE(TWO),KFFFF   SET ALL ROUTING CODES     @Z30LPTJ 35900003
         BCTR  R9,ZERO                                            19084 35950019
HEOB1    EQU   *                                                  19084 36000019
         LA    R9,FOR(R9)          INDEX PAST KEYWORD JUST CHECKED19084 36050019
HEOB     EQU   *                                                  19084 36100019
         L     R7,XAR             PTR TO LIST POSITION            19084 36150019
         LA    R7,ZERO(R7)         CLEAR HIGH ORDER BYTE          19084 36200019
         AH    R7,ZERO(R7)         COMPUTE END OF BUFFER          19084 36250019
         CR    R9,R7               ARE WE AT THE END              19084 36300019
         BH    HERR2               NO, WE ARE OVER ERROR          19084 36350019
         BE    HSCAN               WE ARE OK, GO START PROCESS    19084 36400019
         CLI   ZERO(R9),BLANK      IS BLANK A DELIMITER FOR END   19084 36450019
         BE    HSCAN               GO START PROCESS               19084 36500019
HERR2    EQU   *                                                  19084 36550019
         MVI   XAE,ERR9            ERROR CODE IS 9KEYWORD MISPELD 19084 36600019
         B     HOFFMVC             GO TO EXIT RTN                 19084 36650019
*                                                                 19084 36700019
*                                                                 19084 36750019
KK2      EQU   *                                                  19084 36800019
         CLC   ZERO(FOR,R9),KNONE  ARE THERE NO RTCDS TO BE ASSGND19084 36850019
         BNE   KPAR1               NONE IS NOT THE PARM CHECK MORE19084 36900019
         OI    XASWITCH,XAROUT     ROUT CODES TO BE CHANGED    @ZA12703 36910003
         SR    R1,R1               CLEAR REGISTER              @ZA12703 36920003
         STH   R1,XARTCODE         NO ROUTE CODES WANTED       @ZA12703 36930003
         B     HEOB1               GO CHECK END OF BUFFER         19084 36950019
*                                                                 19084 37000019
KPAREN2  EQU   *                                                  19084 37050019
         LA    R9,ONE(R9)       UPDATE TO PASS THE PAREN          19084 37100019
         BCTR  R6,ZERO             SET EXTERNAL PARENS SWITCH     19084 37150019
*                                                                 19084 37200019
KPAR1    EQU   *                                                  19084 37250019
         XC    XAP(TWLV),XAP       CLEAR AREA FOR CVB OF RT CDS   19084 37300019
         CLI   ONE(R9),COMMA       ONE DIGIT NUM FOLLOWED BY COMMA19084 37350019
         BE    KPAR6               YES,GO PROCESS                 19084 37400019
         CLI   ONE(R9),RTPAREN     IS A RIGHT PARENS THAT FOLLOWS 19084 37450019
         BE    KPAR1B              FIND IF NEEDED                 19084 37500019
         CLI   TWO(R9),COMMA       TWO DIGIT NUM FOLLOWED BY COMMA19084 37550019
         BE    KPAR2          YES                                 19084 37600019
KPAR1B   EQU   *                                                  19084 37650019
         LTR   R6,R6          EXTERIOR PAREN SWITH SET            19084 37700019
         BZ    KPAR8          NO, ERROR                           19084 37750019
         CLI   ONE(R9),RTPAREN     YES,ONE DIGIT NUMB PLUS )      19084 37800019
         BE    KPAR6          YES, PROCESS                        19084 37850019
         CLI   TWO(R9),RTPAREN     TWO DIGIT NUM FOLLOWED BY ')'  19084 37900019
         BNE   HERR2               NO, KEYWORD IS MISPELLED       19084 38000019
*                                                                 19084 38050019
KPAR2    EQU   *                                                  19084 38100019
         CLI   ZERO(R9),F1             SYNTAX CHECK THE ROUTING   M3945 38107020
         BNE   HERR6                   CODE. THE 1ST DIGIT MUST   M3945 38114020
         CLI   ONE(R9),F0              BE 1, THE 2ND DIGIT MUST   M3945 38121020
         BL    HERR6                   BE 0-6. OTHERWISE, AN      M3945 38128020
         CLI   ONE(R9),F6              ERROR CONDITION HAS BEEN   M3945 38135020
         BH    HERR6                   DETECTED                   M3945 38142020
         PACK  XAD+TWO(TWO),ZERO(TWO,R9)  RTCODE IS 2 DIGITS      19084 38150019
KPAR3    EQU   *                                                  19084 38200019
         LA    R9,TWO(R9)           INDEX PAST DIGITS             19084 38250019
         LA    R13,SIXTN           MAXIMUM VALUE ALLOWED          19084 38300019
         CVB   R4,XAP         CONVERT PACKED DECIMAL              19084 38350019
         LTR   R4,R4          IS IT ZERO                          19084 38400019
         BZ    HERR6          YES, ILLEGAL                        19084 38450019
         CR    R4,R13         IS IT 16                            19084 38500019
         BE    KPAR7               YES, NO ROUT TO BE SET         19084 38550019
         BH    HERR6               HIGH, IT IS ILLEGAL KEYWORD    19084 38600019
*                                                                 19084 38650019
         BCTR  R4,ZERO             SET TO ZERO BASE               19084 38750019
         OI    XASWITCH,XAROUT     ROUT CODES TO BE CHANGED    @ZA12703 38770003
         SLL   R13,ELEV            SET FIRST BIT OF MASK ON       19084 38800019
         SRL   R13,ZERO(R4)        MOVE TO APPROPRIATE RT CODE BIT19084 38850019
         O     R13,XACMDATH     SET BIT IN INDICATOR AREA      @Z30LPTJ 38900003
         ST    R13,XACMDATH     AND SAVE IN XSA                @Z30LPTJ 38950003
*                                                                 19084 39000019
KPAR5    EQU   *                                                  19084 39050019
         LTR   R6,R6          EXTERIOR PARENS SET                 19084 39100019
         BZ    HEOB                GO CHECK IF END OF BUFFER      19084 39150019
         CLI   ZERO(R9),RTPAREN    YES,CHECK IF ')' PRESENT       19084 39200019
         LA    R9,ONE(R9)          YES, UPDATE PAST PARENS        19084 39250019
         BNE   KPAR1          NO, MORE ROUT CODES, PROCESS        19084 39300019
         B     HEOB                GO PUT IT IN ROUT FIELD        19084 39350019
*                                                                 19084 39400019
KPAR8    EQU   *                                                  19084 39450019
         CLI   ONE(R9),BLK         BLANK MAY FOLLOW SINGLE DIGIT  19084 39500019
         BNE   KPAR2               GO PROCESS IT                  19084 39550019
KPAR6    EQU   *                                                  19084 39600019
         CLI   ZERO(R9),F0             SYNTAX CHECK THE DIGIT     M3945 39610020
         BL    HERR6                   USED AS THE ROUTCODE. IT   M3945 39620020
         CLI   ZERO(R9),F9             MUST BE 0-9 SINCE ROUTCODE M3945 39630020
         BH    HERR6                   IS ONE CHARACTER           M3945 39640020
         PACK  XAD+TRE(ONE),ZERO(ONE,R9)     ROUT CODE IS ONE DGT 19084 39650019
         BCTR  R9,ZERO                                            19084 39700019
         B     KPAR3          GO TO PROCESS                       19084 39750019
*                                                                 19084 39800019
KPAR7    EQU   *                                                  19084 39850019
         LTR   R6,R6               ANY MORE ROUTS                 19084 39900019
         BNZ   KPAR5               MAYBE, GO CHECK                19084 39950019
         B     HEOB                GO CHECK ACCURACY OF EOB       19084 40400019
         EJECT                                                          41170019
         EJECT                                                          58700019
*********************************************************************** 58800019
*                                                                       58900019
* ERROR MESSAGE ROUTINES                                                59000019
* AND EXIT ROUTINE                                                19084 59100019
*                                                                       59200019
*********************************************************************** 59300019
*                                                                       59400019
*                                                                       59500019
HSCAN    EQU   *                                                  21002 59700001
         MVC   XAX+TRE(TWO),UNITSCAN       IGC7203D              Y02669 59750002
         L     R15,VCON72              ADDRESS OF 7203D          Y02669 59800002
         BR    R15                                               Y02669 59850002
HERR6    EQU   *                                                  19084 61400019
         MVI   XAE,ERR6            INVALID NUMERICS               19084 61500019
HOFFMVC  EQU   *                                                  21002 61670001
         MVC   XAX+TRE(TWO),OFFMOD         IGC5703D              Y02669 61680002
         L     R15,VCON57          ADDRESS OF IEE5703D           Y02669 61682002
         BR    R15                 XCTL TO HARDCOPY OFF PROCESSORY02669 61690002
         EJECT                                                          61700019
*********************************************************************** 61800019
*                                                                       61900019
* CONSTANTS USED BY HARDCPY PROCESSOR                                   62000019
*                                                                       62100019
*********************************************************************** 62200019
OFFMOD   DC    C'57'         HARDCPY,OFF PROCESSOR               Y02669 62900002
HOFF     DC    C'OFF'              HARDCPY,OFF                    19084 63000019
*                                                                 19084 63100019
*                                                                 19084 63200019
*        DO NOT SEPARATE THE FOLLOWING TWO DECALRES -NO CMDS-     19084 63300019
HNOCMDS  DC    C'NO'               NO CMDS TO HCPY                19084 63400019
HCMDS    DC    C'CMDS'             CMDS TO HARDCPY                19084 63500019
HINCMDS  DC    C'INCMDS'               NO STATUS DISPLAY TO       21002*63550001
                                       HARDCOPY.                  21002 63552001
HSTCMDS  DC    C'STCMDS'               NO DYNAMIC STATUS DISPLAY  21002*63560001
                                       TO HARDCOPY.               21002 63570001
HROUT    DC    C',ROUT='           ROUT KEYWORD                   19084 63600019
KNONE    DC    C'NONE'             CHECK FOR ROUT=                19084 63700019
KFFFF    DC    X'FFFF'             MASK FOR ALL ROUT CODES        19084 63800019
KALL     DC    C'ALL'              CHECK FOR ALL AUTH,RTCDS       19084 63900019
UNITSCAN DC    C'72'           UNIT SCAN PROCESSOR               Y02669 74000002
HCPYMOD  DC    CL8'IEE4703D'                                     Y02669 74010002
         DS    0F                                                Y02669 74050002
VCON57   DC    V(IEE5703D)                                       Y02669 74100002
VCON72   DC    V(IEE7203D)                                       Y02669 74150002
                   SPACE 5                                              74160002
PATCH    DC   CL50'***IEE4703D***'                             @Z30LPTJ 74170003
*                                                                       74180002
         END                                                            74200018
./  ADD  SSI=83110962,NAME=IEE4803D
 TITLE 'IEE4803D - CONSOLE INFORMATION MESSAGE ROUTINE #1'              00100003
IEE4803D CSECT                                                          00200002
*********************************************************************** 00300002
* MODULE NAME      = IEE4803D                                           00400002
*   CSECT NAME     = IEE4803D                                           00500002
*                                                                       00600002
* LOAD MODULE NAME = IEE3603D                                           00700002
*                                                                       00800002
* DESCRIPTIVE NAME = CONSOLE INFORMATIONAL MESSAGE ROUTINE              00900002
*                                                                       01000002
* COPYRIGHT        = MISSING                                            01100002
*                                                                       01200002
* STATUS           = OS/VS/2 RELEASE 3                         @Z30LPTJ 01300003
*                                                                       01400002
* FUNCTION         = THIS MODULE USES THE UCM AND THE UCB TO            01500002
*                    CONSTRUCT A MESSAGE DISPLAYING THE CURRENT         01600002
*                    STATUS OF THE CONSOLE                              01700002
*                    THE MESSAGE CONTAINS THE PHYSICAL DEVICE ADDRESS   01800002
*                    OF THE CONSOLE AND ITS ALTERNATE, AND WHETHER      01900002
*                    THE CONSOLE IS ACTIVE AND/OR THE MASTER CONSOLE.   02000002
*                                                                       02100002
* OPERATION        = ON ENTRY, THIS ROUTINE GETS THE UNIT'S UCM AND     02200002
*                    UCB POINTERS AND FILLS THE MESSAGE BUFFER WITH     02300002
*                    ALL THE PERTINENT INFORMATION ABOUT THE NEW        02400002
*                    CONSOLE SUCH AS ITS COMPOSITE (IF ANY), ITS        02500002
*                    ALTERNATE CONSOLE, WHETHER IT IS A HARDCPY         02600002
*                    DEVICE OR NOT, ITS ROUT CODES AND ITS COMMAND      02700002
*                    COMMAND AUTHORITY.                                 02800002
*                    ALSO INFO SUCH AS WHETHER THE NEW CONSOLE IS       02900002
*                    ALREADY ACTIVE AS A CONSOLE OR WHETHER IT          03000002
*                    IS PENDING TO CHANGE TO THE CONSOLE STATE AS       03100002
*                    SOON AS ANY PREVIOUS WORK THAT IT DID AS A         03200002
*                    SYSTEM DEVICE IS COMPLETE.                         03300002
*                    IT ALSO SHOWS WHETHER THIS IS THE MASTER CONSOLE   03400002
*                    WHEN ALL THE INFO HAS BEEN GATHERED AND PLACED     03500002
*                    IN THE MESSAGE BUFFER, THIS ROUTINE EXITS TO       03600002
*                    IEE7303D TO ACTUALLY ISSUE THE WTO TO THE          03700002
*                    OPERATOR.                                          03800002
*                    IF THE ROUTINE WAS ENTERED FROM IEE7303D TO SET    03900002
*                    UP THE HARDCPY MESSAGE BECAUSE THE CONSOLE IS      04000002
*                    THE SYSTEM HARDCPY DEVICE AS WELL, THEN IT         04100002
*                    PRESETS THE MESSAGE TO TELL THE OPERATOR THAT      04200002
*                    FACT.                                              04300002
*                                                                       04400002
* NOTES                                                                 04500002
*   DEPENDENCIES   = NONE                                               04600002
*   CHARACTER/CODE DEPENDENCIES                                         04700002
*                  = THIS MODULE CAN BE ASSEMBLED WITH ANY NEW          04800002
*                    CHARACTER/CODE SET.                                04900002
*                                                                       05000002
* RESTRICTIONS     = SEE ENTRY POINTS - INPUT DATA                      05100002
*   REGISTER CONVENTIONS                                                05200002
*                  = REGISTERS ARE DEFINED AT LABEL: DEFREG             05300002
*   PATCH LABEL    = PATCH                                              05400002
*                                                                       05500002
* MODULE TYPE      = CSECT                                              05600002
*   PROCESSOR      = ASSEMBLER                                          05700002
*   MODULE SIZE    = VS2 = '38E'                               @ZM30445 05800003
*   ATTIBUTES      = REENTRANT, REFRESHABLE, REUSABLE,                  05900003
*                    ZERO PSW PROTECT KEY                               06000002
*                                                                       06100002
* ENTRY POINTS     = IEE4803D FROM IEE4903D OR IEE7303D                 06200002
*   PURPOSE        = TO SET UP THE CONSOLE INFORMATIONAL MESSAGE        06300002
*                    WHEN A VARY CONSOLE COMMAND WAS ISSUED             06400002
*                    AND TO SET THE HARDCPY MESSAGE IF THAT             06500002
*                    NEW CONSOLE IS THE HARDCPY DEVICE AS WELL.         06600002
*   LINKAGE        = BRANCH                                             06700002
*   INPUT          = REG13 CONTAINS THE SAVE AREA POINTER               06800002
*                    WORD 17 OR THE SAVE AREA HAS THE PTR TO THE CSCB   06900002
*                    REG2 CONTAINS THE PTR TO THE DUMMY XSA             07000002
*                    XAP HAS THE MLWTO ID IN THE THREE HIGH             07100002
*                    ORDER BYTES AND THE GRAPHICS INDICATOR             07200002
*                    IN THE LOW BYTE                                    07300002
*                    REG1 POINTS TO THE MESSAGE CORE GOTTEN BY          07400002
*                    IEE4903D                                           07500002
*                    THE XAD SWITCHES ARE STORED IN THE DUMMY XSA       07600002
*                    XAR OF THE DUMMY XSA HAS THE PROCESS SWITCHES      07700002
*                    XAL HAS THE PTR TO THE PARMS OF THE COMMAND        07800002
*                                                                       07900002
*                    IF ENTRY IS FROM IEE7303D THEN THE FOLLOWING       08000002
*                    IS ALSO TRUE:                                      08100002
*                    REG11 CONTAINS AN INDICATOR FOR THE HARDCPY MSG    08200002
*                    THE XARESV FIELD OF THE DUMMY XSA HAS THE HIGH     08300003
*                    ORDER BIT SET TO MEAN THAT A BRANCH HAS TO BE      08400002
*                    IMMEDIATELY MADE TO 'CENDCHK'                      08500002
*                    REG9 POINTS TO THE CURRENT PROCESSED UNITNAME      08600002
*   REGISTERS SAVED = ALL                                               08700002
*   REGISTER USAGE  =REG1 ON INPUT IS THE POINTER TO THE MESSAGE CORE   08800002
*                    REG2 PTS TO THE DUMMY XSA                          08900002
*                    REG3 ADDRESSABILITY                                09000002
*                    REG4 PROCESS BITS                                  09100002
*                    REG5 UCME PTR                                      09200002
*                    REG9 UNIT PTR                                      09300002
*                    REG10 UCM PTR                                      09400002
*                    REG11 HARDCPY OF NOHCPY MSG SWITCH                 09500002
*                    REG12 MESSAGE ADDRESSABILITY                       09600002
*                    REG13 SAVE AREA PTR                                09700002
*                    REG14 COMPOSITE SWITCH                             09800002
*   REGISTERS RESTORED                                                  09900002
*                  = ALL                                                10000002
*                                                                       10100002
* EXITS - NORMAL-1-= TO IEE7303D VIA BRANCH                             10200002
*   CONDITIONS     = TO FINISH CONSTRUCTION MESSAGE AND TO ISSUE        10300002
*                    IT TO THE OPERATOR                                 10400002
*   OUTPUT         = REG2 PTS TO THE DUMMY XSA                          10500002
*                    R0 HAS THE COMPOSITE UCME PTR OR IS 0              10600002
*                    REG13 PTS TO THE SAVE AREA, WORD17 OF THE          10700002
*                    SAVE AREA HAS THE CSCB PTR                         10800002
*                    REG1 PTS TO THE MESSAGE CORE GOTTEN BY 4903D       10900002
*                    THE XAD SWITCHES ARE STORED IN THE DUMMY XSA       11000002
*                    XAR OF THE DUMMY XSA HAS THE PROCESS SWITCHES      11100002
*                    XAL OF THE DUMMY XSA HAS THE POINTER TO THE        11200002
*                    PARMS OF THE COMMAND                               11300002
*                    XARESV FIELD OF THE DUMMY XSA  HAS BIT1 SET TO     11400003
*                    INDICATE TO TAKE AN IMMEDIATE BRANCH TO            11500002
*                    LABEL: 'CRT2'                                      11600002
*                    XAP HAS THE MLWTO ID                               11700002
*                    REG4 HAS THE PROCESS BITS                          11800002
*                    REG 9 PTS TO THE UNIT                              11900002
*                    REG11 WILL BE 0 UNLESS THE HARDCPY MSG IS NEEDED   12000002
*                    THEN IT WILL CONTAIN THE PTR TO THE UCME OF        12100002
*                    THE HARDCPY UNIT                                   12200002
*                    REG12 HAS THE ADDRESS OF THE MESSAGE AREA          12300002
*   RETURN CODES   = NONE                                               12400002
*                                                                       12500002
* EXITS - NORMAL-2- = RETURN TO CALLER                                  12600002
*   CONDITIONS     = ALL NECESSARY MESSAGES HAVE BEEN ISSUED            12700002
*   OUTPUT         = THE CSCB CORE IS FREED VIA AN MGCR MACRO           12800002
*                    THE DUMMY XSA AND THE SAVE AREA CORE ARE           12900002
*                    FREEMAINED                                         13000002
*                    THE MESSAGE BUFFER IS ALSO FREEMAINED              13100002
*   RETURN CODES   = NONE                                               13200002
*                                                                       13300002
* EXITS - ERROR    = NONE                                               13400002
*                                                                       13500002
* EXTERNAL REFERENCES                                                   13600002
*   ROUTINES       = IEE7303D                                           13700002
*   DATA AREAS     = SEE EXITS - OUTPUT DATA                            13800002
*                                                                       13900002
* CONTROL BLOCKS   = 1. DUMMY EXTENDED SAVE AREA (XSA)                  14000002
*                    2. CVT                                             14100002
*                       FIELDS TESTED  - CVTCUCB                        14200002
*                       FIELDS UPDATED - NONE                           14300002
*                    3. UNIT CONTROL BLOCK (UCB)                        14400002
*                       FIELDS TESTED  - SRTESTAT -BIT= SRTEDADI        14500002
*                                        UCBNAME                        14600002
*                       FIELDS UPDATED - NONE                           14700002
*                    4. UNIT CONTROL MODULE (UCM)                       14800002
*                       FIELDS TESTED  - UCMALTEN                       14900002
*                                        UCMAUTH                        15000002
*                                        UCMCOMPC                       15100002
*                                        UCMDISP -BIT= UCMDISPB         15200002
*                                                      UCMDISPA         15300002
*                                                      UCMDISPD         15400002
*                                        UCMHRDRT                       15500002
*                                        UCMSDS1 - BIT=UCMSDS1A         15600002
*                                                      UCMSDS1B         15700002
*                                        UCMSFLGS - BIT=UCMSYSC         15800002
*                                        UCMUCB                         15900002
*                                        UCMVEA                         16000002
*                       FIELDS UPDATED - NONE                           16100002
*                    5. COMMAND SCHEDULING CONTROL BLOCK (CSCB)         16200002
*                       FIELDS TESTED  - NONE                           16300002
*                       FIELDS UPDATED - CHSTS - BIT=CHFC               16400002
*                                                                       16500002
* TABLES           = NONE                                               16600002
*                                                                       16700002
* MACROS           = MGCR,FREEMAIN,SETLOCK,DEQ                          16800002
*                                                                       16900002
* MAPPING MACROS   = IEEXSA                                             17000002
*                    CVT                                                17100002
*                    IEECUCM                                            17200002
*                    IEFCUBOB                                           17300002
*                    IEECHAIN                                           17400002
*                    IHAPSA                                             17500002
*   SERIALIZATION  = PROTECTION FROM COMM. TASK IS ACCOMPLISHED         17600002
*                    VIA THE CMS AND LOCAL LOCKS OBTAINED AT:           17700002
*                       CSETLOCK IN THIS MODULE                         17800002
*                    THESE LOCKS ARE RELEASED AT:                       17900002
*                       UNSTLOCK IN MODULE IEE7303D                     18000002
*                    PROTECTION AGAINST OLTEP, VARY/UNLOAD AND          18100002
*                    ALLOCATION IS ACCOMPLISHED VIA THE ENQ ISSUED IN   18200002
*                    MODULE IEE3603D.                                   18300002
*                    A DEQ WILL BE ISSUED AT CDEQUE IN THIS MODULE      18400002
*                    IF THE COMAND HAS A TERMINAL EXIT FROM HERE.       18500002
*                    OTHERWISE, THE DEQ WILL BE ISSUED IN MODULE        18600002
*                    IEE7303D  WHERE THE MODULE WILL EXIT IF NOT        18700002
*                    EXITING FROM HERE.                                 18800002
*                                                                       18900002
* CHANGE LEVEL     = Y02669, Y02651, Z30LPTJ, ZM30445          @ZM30445 19000003
*                                                                       19100002
* CHANGE ACTIVITY  = N/A                                                19200002
*                                                                       19300002
* MESSAGES         = REFER TO PROLOGUE OF IEE4903D FOR FULL INFO.       19400002
*                                                                       19500002
* ABEND CODES      = NONE                                               19600002
*                                                                       19700002
* PACKAGING        = IEE4803D WILL BE PART OF LOAD MODULE               19800002
*                       IEE3603D                                        19900002
*                    THIS LOAD MODULE ALIASES ARE                       20000002
*                       NONE                                            20100002
*                    THIS LOAD MODULE ENTRY POINTS ARE                  20200002
*                       IEE3603D                                        20300002
*                    MODULE WILL RESIDE IN:  LPALIB                     20400002
*                                                                       20500002
* SYSGEN           = SUPPLIED BY THE FOLLOWING SECTIONS:                20600002
*                       LOAD MODULE NAME                                20700002
*                       PACKAGING                                       20800002
*                    THIS CSECT WILL BE INCLUDED AT SYSGEN FROM         20900002
*                    DLIB -AOSB3- BY MACRO -SGIEF441-                   21000002
*                                                                       21100002
* SYSTEM LIBRARIES = NONE                                               21200002
*                                                                       21300002
*********************************************************************** 21400002
         EJECT                                                          21500002
*                                                                 19084 21600002
*********************************************************************** 21700002
*                                                                 19084 21800002
*        REGISTER EQUATES                                         19084 21900002
*                                                                 19084 22000002
*********************************************************************** 22100002
DEFREG   EQU   *                                                 Y02669 22200002
R0       EQU   0          OUTPUT TO 7303D = COMPOSITE PTR OR 0   Y02669 22300002
R1       EQU   1                   IN-PTR TO WTO CORE             19084 22400002
R2       EQU   2                   XSA                            19084 22500002
R3       EQU   3                   ADDRESSABILITY                Y02669 22600002
R4       EQU   4                   PROCESS BITS                  Y02669 22700002
R5       EQU   5                   UCME PTR                      Y02669 22800002
R6       EQU   6                                                  19084 22900002
R7       EQU   7                                                        23000002
R8       EQU   8                                                        23100002
R9       EQU   9                   UNIT PTR                       19084 23200002
R10      EQU   10                  UCM                            19084 23300002
R11      EQU   11                  HCPY OR NOHCPY MSG SWITCH      19084 23400002
R12      EQU   12                  MSG ADDRESSABILITY             19084 23500002
R13      EQU   13                  SAVE AREA PTR                        23600002
R14      EQU   14                  COMPOSITE SWITCH IN THIS RTN. Y02669 23700002
R15      EQU   15                                                 19084 23800002
*                                                                 19084 23900002
         SPACE 10                                                       24000002
*********************************************************************** 24100002
*                                                                 19084 24200002
*        CONSOLE MESSAGE PROCESSOR                                19084 24300002
*                                                                 19084 24400002
*********************************************************************** 24500002
*                                                                 19084 24600002
         EJECT                                                          24700002
         SPACE 10                                                       24800002
*********************************************************************** 24900002
*                                                                 19084 25000002
*        EQUATES                                                  19084 25100002
*                                                                 19084 25200002
*********************************************************************** 25300002
ZERO     EQU   0                                                  19084 25400002
ONE      EQU   1                                                  19084 25500002
TWO      EQU   2                                                  19084 25600002
TRE      EQU   3                                                  19084 25700002
FOR      EQU   4                                                  19084 25800002
FIV      EQU   5                                                  19084 25900002
SIX       EQU   6                                                 19084 26000002
SVN      EQU   7                                                  19084 26100002
EIT      EQU   8                                                  19084 26200002
TWLV     EQU   12                                                 19084 26300002
THIRTY6  EQU   36                                                Y02669 26800002
FORTY4   EQU   44                                                Y02669 26900002
BLANK    EQU   C' '                                               19084 27100002
COMMA    EQU   C','                                               19084 27200002
SLASH    EQU   C'/'                                               19084 27300002
CHCPY    EQU   C'H'                                               19084 27400002
CACTIVE  EQU   C'A'                                               19084 27500002
CMSTCONS EQU   C'M'                                               19084 27700002
FOXES    EQU   X'FF'                                              19084 28000002
L3       EQU   3                                                  19084 28400002
L67      EQU   67                                                 19084 28500002
SHIFT16  EQU   16                                                 19084 28700002
SHIFT1   EQU   1                                                  19084 28800002
D64      EQU   64                                                Y02669 29000002
D68      EQU   68                                                Y02669 29100002
D132     EQU   132                                               Y02669 29200002
RI       EQU   X'80'                                           @ZM30445 29300003
         EJECT                                                    19084 29400002
         BALR  R3,ZERO                                            19084 29500002
         USING *,R3                                               19084 29600002
         MODID BR=YES                                            Y01886 29700002
         USING XSA,R2                                             19084 29800002
*                                                                       29900002
         STM   R0,R15,ZERO(R13)                                  Y02669 30000002
         L     R4,XAR              GET PROCESS SWITCHE IN REG 7   19084 30100002
         LR    R12,R1              GOTTEN CORE FOR MSG            19084 30200002
         USING CMESSAGE,R12        ADDRESS MSG AREA               19084 30300002
         L     R10,CVTPTR                                         19084 30400002
         USING XCVT,R10                                           19084 30500002
         L     R10,CVTCUCB         GET PTR TO UCM                 19084 30600002
         DROP  R10                                                19084 30700002
         USING UCM,R10                                                  30800002
         USING UCMLIST,R5                                         19084 30900002
         TM    XARESV,XACENDCK    SHOULD 48 BRANCH TO CENDCHK  @Z30LPTJ 31000003
*                                 BECAUSE THIS IS A 2ND ENTRY           31100002
         BO    CENDCHK            YES, HARDCOPY OR MULTIPLE UNITS 21002 31200002
         L     R9,XAL              GET PTR TO UNITS               19084 31300002
         LA    R9,ZERO(R9)         CLEAR HIGH ORDER BYTE          19084 31400002
         SR    R11,R11                 HARDCOPY INDICATOR         21002 31500002
*                                                                 19084 31600002
         TM    XADUSWIT,XAXPAREN   MULTIPLE UNITS              @Z30LPTJ 31700003
         BZ    CSINGLE             NO,PTR IS OK                   19084 31800002
CPAREN   LA    R9,ONE(R9)          YES, INDEX BY ONE             Y02669 31900002
         NI    XADUSWIT,XAXPAREN   OFF,ALL BUT UDVC AND XPAREN @Z30LPTJ 32000003
CSINGLE  EQU   *                                                  19084 32100002
         CLC   ZERO(TWO,R9),COUNIT UNIT IS O-XXX                  19084 32200002
         BNE   CCOMP               NO,MAYBE COMPOSITE             19084 32300002
         LA    R9,TWO(R9)          INDEX TO UNIT NAME             19084 32400002
         B     CPROCESS            GO PROCESS                     19084 32500002
*                                                                 19084 32600002
CCOMP    EQU   *                                                  19084 32700002
         CLC   ZERO(TRE,R9),CIUNIT IS IT A COMPOSITE              19084 32800002
         BNE   CPROCESS            NO, REG UNIT                  Y02669 32900002
         OI    XADUSWIT,XAIOCOMP   YES, SET COMP SWITCH        @Z30LPTJ 33000003
         LA    R9,TRE(R9)          INDEX TO I-UNIT NAME           19084 33100002
*                                                                 19084 33200002
         EJECT                                                          33300002
         SPACE 10                                                 19084 33400002
CPROCESS EQU   *                                                  19084 33500002
         LTR   R4,R4               IS PROCESS FLAG ON             19084 33600002
         BZ    CHCPYCK                 NO MORE UNITS TO PROCESS   21002 33700002
         BNM   CENDCHK                 DON'T PROCESS THIS UNIT    21002 33800002
CUCME    EQU   *                                                  21002 33900002
         LM    R5,R7,UCMVEA    GET PTR TO FIRST AND LAST UCME     21002 34000002
CLOOP    L     R1,UCMUCB               AND UCB                    21002 34100002
         USING XUCB,R1                                            21002 34200002
         CLC   ZERO(TRE,R9),UCBNAME    IT IS SOUGHT UCME          21002 34300002
         BE    CPROC                   YES                        21002 34400002
         BXLE  R5,R6,CLOOP             NO, TRY ANOTHER            21002 34500002
*                                                                 19084 34600002
         EJECT                                                          34700002
CPROC    MVI   XTEXT,BLANK         BLANK OUT                      19084 34800002
         MVC   XTEXT+ONE(L67),XTEXT AREA                          19084 34900002
         USING XUCB,R1                                            19084 35000002
         SPACE 10                                                       35100002
*************************************************                Y02651 35200002
*                                                                Y02651 35300002
*  LOCKS MUST BE ACQUIRED NOW TO PROTECT AGAINST ANY BIT CHANGES Y02651 35400002
*  BY COMM. TASK                                                 Y02651 35500002
*                                                                Y02651 35600002
CSETLOCK EQU   *                                                 Y02651 35700002
         LR    R8,R13             SAVE AREA POINTER              Y02651 35800002
         STM   R11,R14,D68(R8)    SAVE SETLOCK REGS              Y02651 35900002
         SETLOCK  OBTAIN,TYPE=LOCAL,MODE=UNCOND,                 Y02651*36000002
               RELATED=(IEE7303D(UNSTLOCK))                      Y02651 36100002
         SETLOCK  OBTAIN,TYPE=CMS,MODE=UNCOND,                   Y02651*36200002
               RELATED=(IEE7303D(UNSTLOCK))                      Y02651 36300002
         LM    R11,R14,D68(R8)                                   Y02651 36400002
*************************************************                Y02651 36500002
         SPACE 10                                                       36600002
         TM    UCMDISP,UCMDISPB    IS UNIT ALSO HCPY             Y02669 36700002
         BZ    CNOHCPY             NO, BRANCH AROUND              19084 36800002
         LR    R11,R5              YES, KEEP PTR TO UCME FOR LATER19084 36900002
*                                                                 19084 37000002
CNOHCPY  EQU   *                                                  19084 37100002
         L     R14,UCMCOMPC        PTR TO COMP OR ZEROES IF NONE Y02669 37200002
*                                                                 19084 37300002
         LTR   R14,R14             ANY COMPOSITE                 Y02669 37400002
         BZ    CONEU               NO, SINGLE UNIT                19084 37500002
         DROP  R5                                                 19084 37600002
         USING UCMLIST,R14                                       Y02669 37700002
         TM    UCMDISP,UCMDISPB    MAYBE O-UNIT IS HCPY           19084 37800002
         DROP  R14                                               Y02669 37900002
         USING UCMLIST,R5                                         19084 38000002
         BZ    CMOVE               NO, OK                         19084 38100002
         LR    R11,R5              YES,PTR TO UCME OF I-UNIT FOR  19084 38200002
*                                      HARDCPY MESSAGE            19084 38300002
CMOVE    EQU   *                                                  19084 38400002
         MVC   XUNIT1(L3),UCBNAME  MOVE IN 1-UNIT                 19084 38500002
         MVI   XBLANK,COMMA        MOVE COMMA                     19084 38600002
         L     R1,TWLV(R14)        GET UCB OF O-UNIT             Y02669 38700002
CONEU    EQU   *                                                  19084 38800002
         MVC   XUNIT2(L3),UCBNAME  MOVE IT IN                     19084 38900002
         MVI   XCOMMA,SLASH        MOVE IN SLASH TO DELIMIT ALTERN19084 39000002
         L     R6,UCMALTEN         GET ITS PTR                    19084 39100002
         DROP  R5                                                 19084 39200002
         USING UCMLIST,R6                                         19084 39300002
         LTR   R6,R6               HAVE AN ALTERNATE?            Y02669 39350002
         BZ    CATTRB              NOPE, A ONE CONS SYSTEM       Y02669 39360002
         L     R1,UCMUCB           GET UCB PTR                    19084 39400002
         MVC   XAUNIT1(L3),UCBNAME MOVE IN 1-OF ALTCONS           19084 39500002
         L     R6,UCMCOMPC         GET COMP OF ALTERNATE          19084 39600002
         LTR   R6,R6               ANY                            19084 39700002
         BZ    CATTRB              NO,GO CHECK CONS ATTRIBUTES    19084 39800002
         MVI   XBLK,COMMA          YES, MOVE DELIMITING COMMA     19084 39900002
         L     R1,UCMUCB                                          19084 40000002
         MVC   XAUNIT2(L3),UCBNAME MOVE IN O-ALT UNIT             19084 40100002
         DROP  R6,R1                                              19084 40200002
         USING UCMLIST,R5                                         19084 40300002
         SPACE 10                                                 19084 40400002
CATTRB   EQU   *                                                  19084 40500002
         MVI   XMSGSTAT+ONE,CHCPY  MOVE IN H                      19084 40600002
         LTR   R4,R4                    IS THIS THE HARDCOPY MSG  21002 40700002
         BZ    HARDAUTH                YES, DETERMINE AUTHORITY   21002 40800002
         L     R1,UCMUCB           UCB PTR TO CONSOLE IN CMD      19084 40900002
         USING XUCB,R1                                            19084 41000002
         MVI   XMSGSTAT+ONE,CACTIVE    IT WILL BE EITHER ACTIVE OR19084 41100002
*                                      CHANGING TO ACTIVE         19084 41200002
         TM    SRTESTAT,SRTEDADI   IS IT CHANGING TO ACTIVE       19084 41300002
         BO    PENDING                 YES,BRANCH                 M5933 41400002
         TM    XADUSWIT,XAIOCOMP       COMPOSITE CONSOLE       @Z30LPTJ 41500003
         BZ    CMASTER                 NO, THIS IS XXX CONSOLE   Y02669 41600002
         L     R1,TWLV(R14)            GET UCB OF O-UNIT         Y02669 41700002
         TM    SRTESTAT,SRTEDADI       O-UNIT CHANGING TO ACTIVE  M5933 41800002
         BZ    CMASTER                 NO                         M5933 41900002
         DROP  R1                                                 M5933 42000002
PENDING  MVC   XMSGSTAT+TWO(TWO),CPENG NEW CONS,CHANGING TO ACTIVEM5933 42100002
         B     CAUTHCK             GO CHECK CMD AUTH              19084 42200002
*                                                                 19084 42300002
*                                                                 19084 42400002
COONLY   EQU   *                                                  19084 42500002
         MVC   XMSGAUTH(FOR),CNONE      MOVE IN NO AUTH           19084 42600002
         BR    R15                  GO PROCESS ROUTS              19084 42700002
*                                                                 19084 42800002
*                                                                 19084 42900002
CMASTER  EQU   *                                                  19084 43000002
         TM    UCMDISP,UCMDISPA    MASTER                         19084 43100002
         BZ    CAUTHCK             NO,GO CHECK AUTH               19084 43200002
         MVI   XMSGSTAT+ONE,CMSTCONS    YES, MOVE IN M            19084 43300002
*                                                                 19084 43400002
         EJECT                                                    19084 43500002
CAUTHCK  EQU   *                                                  19084 43600002
         LA    R15,CEXIT               EXIT TO IEE7303D          Y02669 43700002
         LH    R6,UCMAUTH          GET AUTH IN REG5               19084 43800002
         TM    UCMDISP,UCMDISPD        O- ONLY CONSOLE            19084 43900002
         BO    COONLY              YES OUTPUT ONLY, AUTH=NONE    Y02669 44000002
         MVC   XMSGAUTH(TRE),CALL  ASSUME ALL                     19084 44100002
         CH    R6,CCMDALL         IS IT ALL AUTH                  19084 44200002
         BCR   EIT,R15             YES,GO TO EXIT TO 73          Y02669 44300002
*                                                                 19084 44400002
         MVC   XMSGAUTH(FOR),CINFO ASSUME INFO                    19084 44500002
         LTR   R6,R6               IS IT INFO                     19084 44600002
         BCR   EIT,R15             YES, GO CHECK RTCDS IN 73     Y02669 44700002
*                                                                 19084 44800002
         SR    R7,R7               NO, INDIVIDUAL AUTH            19084 44900002
         LA    R1,XMSGAUTH         PTR TO MSG AREA FOR AUTH       19084 45000002
         SLL   R6,SHIFT16          SHIFT AUTH                     19084 45100002
         LTR   R6,R6               IS IT ON                       19084 45200002
         BNM   CIND2               NO, BUT SOMETHING ELSE ON      19084 45300002
         MVC   ZERO(FOR,R1),CSYS   YES, IT IS SYS-MOVE IT IN      19084 45400002
         LA    R1,TRE(R1)          INDEX PAST IT                  19084 45500002
         BCTR  R7,ZERO             SET SECOND TIME SWITCH         19084 45600002
CIND2    EQU   *                                                  19084 45700002
         SLL   R6,SHIFT1          SHIFT ONE MORE                  19084 45800002
         LTR   R6,R6               IS IT ON                       19084 45900002
         BCR   EIT,R15             NO NOMORE, GO CHECK ROUT CODES 19084 46000002
         BNM   CIND4               NOT THIS ONE, GO ASSUME CONS   19084 46100002
         MVC   ZERO(FOR,R1),CIO+ONE     YES, ITS 10, MOVE IN -10- 19084 46200002
         LTR   R7,R7               SECOND TIME                    19084 46300002
         BZ    CIND3               NO,OK CHECK NEXT AUTH          19084 46400002
         MVC   ZERO(FOR,R1),CIO    YES, MOVE IN -,10-             19084 46500002
         BR    R15                 GO CHECK ROUTS IN 7303D       Y02669 46600002
*                                                                 19084 46700002
CIND3    EQU   *                                                  19084 46800002
         BCTR  R7,ZERO             SET SECOND TIME SWITCH         19084 46900002
         LA    R1,TWO(R1)          INDEX PAST -10-                19084 47000002
         SLL   R6,SHIFT1           SHIFT TO NEXT AUTH             19084 47100002
         LTR   R6,R6               ON                             19084 47200002
         BCR   EIT,R15             NO, NOMORE                     19084 47300002
*                                                                 19084 47400002
CIND4    EQU   *                                                  19084 47500002
         MVC   ZERO(FOR,R1),CONS+ONE    YES, MOVE IN -CONS-       19084 47600002
         LTR   R7,R7               SECOND TIME AROUND             19084 47700002
         BCR   EIT,R15             NO, GO CHECK ROUTS             19084 47800002
         MVC   ZERO(FIV,R1),CONS   YES, MOVE IN -,CONS-           19084 47900002
         BR    R15                     GO CHECK ROUT CODES        21002 48000002
         EJECT                                                    19084 48100002
*                                                                 19084 48200002
CENDCHK  EQU   *                                                  19084 48300002
         NI    XARESV,FOXES-XACENDCK   TURN OFF ENTRY BIT      @Z30LPTJ 48400003
         SLL   R4,SHIFT1           PROCESS BITS TO NEXT UNIT      19084 48500002
         ST    R4,XAR                  SAVE NEW PATTERN FOR       21002 48600002
*                                      MULTIPLE UNITS             21002 48700002
         LA    R9,TRE(R9)          INDEX TO NEXT UNIT             19084 48800002
         TM    XADUSWIT,XAIOCOMP   COMPOSITE SPECIFIED         @Z30LPTJ 48900003
         BZ    CMULT               GO CHECK IF MORE UNITS         19084 49000002
         LA    R9,SVN(R9)          INDEX PAST COMP UNIT          Y02669 49100002
CMULT    EQU   *                                                  19084 49200002
         TM    XADUSWIT,XAXPAREN   YES, MULTIPLE UNITS EXISTS? @Z30LPTJ 49300003
         BO    CPAREN              YES, CONTINUE                  19084 49400002
*                                                                 19084 49500002
CHCPYCK  EQU   *                                                  19084 49600002
         LTR   R11,R11             ANY HCPY MSG                   19084 49700002
         BZ    CFREE               NO, GO FINISH UP               19084 49800002
         LR    R5,R11              GET UCME OF HCPY INTO R5       19084 49900002
         L     R1,UCMUCB                                          19084 50000002
         B     CPROC               GO TO ISSUE AND BUILD MSG      19084 50100002
HARDAUTH EQU   *                                                  19084 50200002
         SR    R11,R11                 HARDCOPY MSG PROCESSED     21002 50300002
         LR    R6,R10              UCM PTR                        19084 50400002
         SH    R6,FOUR             MINUS 4 IS PTR TO PFX          19084 50500002
         L     R6,ZERO(R6)         GET PFX ADDR                   19084 50600002
         USING UCMPRFX,R6                                         19084 50700002
         MVC   XMSGAUTH(SIX),CNO       ASSUME NOCMDS              21002 50800002
         TM    UCMSDS1,UCMSDS1A        IS THIS STCMDS             21002 50900002
         BZ    HARDATH1                NO, TEST FOR INCMDS        21002 51000002
         MVC   XMSGAUTH(TWO),STCMDS    INDICATE STCMDS            21002 51100002
         B     HARDROUT                INDICATE CMDS ARE CHANGING 21002 51200002
HARDATH1 EQU   *                                                  21002 51300002
         TM    UCMSDS1,UCMSDS1B        IS THIS INCMDS             21002 51400002
         BZ    HARDATH2                CHECK FOR CMDS             21002 51500002
         MVC   XMSGAUTH(TWO),INCMDS    INDICATE INCMDS            21002 51600002
         B     HARDROUT                CONTINUE                   21002 51700002
HARDATH2 EQU   *                                                  21002 51800002
         TM    UCMSFLGS,UCMSYSC        IS THIS CMDS               21002 51900002
         BZ    HARDROUT                                           21002 52000002
         MVC   XMSGAUTH(SIX),CMDS      MOVE IN CMDS               21002 52100002
HARDROUT EQU   *                                                  19084 52200002
         LH    R6,UCMHRDRT             GET ROUTS OF HARCPY        21002 52300002
         DROP  R6                                                 19084 52400002
         OI    XARESV,XACRT2     INDICATE BRANCH TO CRT2 IN 73 @Z30LPTJ 52500003
CEXIT    EQU   *                                                  21002 52600002
         ST    R14,ZERO(R13)     REG0 SPOT - COMPOSITE SWITCH OR0Y02669 52700002
         STM   R4,R6,SHIFT16(R13) REG 4 HAS CURRENT PROCESS BITS Y02669 52800002
*                                 REG5 HAS UCME POINTER OF UNIT O       52900002
*                                 OR I-UNIT IF THIS IS COMPOSITE        53000002
*                                 REG6 HAS HARDCPY DEV ROUTS IF  Y02669 53050002
*                                 THIS IS THE HARDCPY MSG OR IS  Y02669 53060002
*                                  N/A IF THIS IS THE CONSOLE MSGY02669 53070002
         ST    R9,THIRTY6(R13)    REG9 HAS THE CURRENT UNIT PTR  Y02669 53100002
         STM   R11,R13,FORTY4(R13)   REG11 HAS HARDCPY INDICATOR Y02669 53200002
*                                 REG12 HAS MESSAGE AREA POINTER Y02669 53300002
*                                 REG13 HAS SAVE AREA POINTER    Y02669 53400002
         MVC   XAX+TRE(TWO),EXITNAME         IEE7303D            Y02669 53500002
*                                                                Y02669 53600002
         LM    R0,R15,ZERO(R13)   PRESET ALL REGS FOR 7303D      Y02669 53700002
         L     R15,VCON73                                        Y02669 53800002
         BR    R15            BRANCH TO 7303D                    Y02669 53900002
*                                                                Y02669 54000002
*         R0  = PRESET FOR COMPOSITE SWITCH                      Y02669 54100002
*         R4  = PROCESS BITS                                     Y02669 54200002
*         R1  = MSG POINTER                                      Y02669 54300002
*         R2  = DUMMY XSA POINTER                                Y02669 54400002
*         R5  = UCME PTR OF UNIT OR I-UNIT IF THIS IS COMP       Y02669 54500002
*         R9  = UNIT POINTER                                     Y02669 54600002
*         R11 = HARDCPY MSG INDICATOR OR 0 IF NOT NEEDED         Y02669 54700002
*         R12 = MESSAGE AREA POINTER                             Y02669 54800002
*         R13 = SAVE AREA POINTER                                Y02669 54900002
*         R14 = RETURN ADDRESS                                   Y02669 55000002
*         R15 = ADDRESS OF 7303D                                 Y02669 55100002
*                                                                Y02669 55200002
         EJECT                                                          55300002
CFREE    EQU   *                                                 Y02669 55400002
         L     R0,XAP                  MLWTO ID                   21002 55500002
         IC    R0,XAU             CONSOLE ID IN LOW ORDER BYTE    21002 55600002
         TM    XAU,RI             IS THIS FROM INPUT STREAM?   @ZM30445 55620003
         BNO   XAUIN              NO, AVOID NEXT INSTRUCTION   @ZM30445 55640003
         IC    R0,ZEROZERO        YES, INDICATE MASTER CONSOLE @ZM30445 55660003
XAUIN    EQU   *                                               @ZM30445 55680003
         MVC   ZERO(8,R12),ELINE       LAST LINE OF MLWTO         21002 55700002
         LR    R1,R12                  ADDRESS OF MESSAGE         21002 55800002
         WTO   MF=(E,(1))                                               55900002
         SPACE 10                                                       56000002
**************************************************               Y02651 56100002
*                                                                Y02651 56200002
*  THIS IS A TERMINAL EXIT AND THEREFORE THE ENQ ORIGINALLY      Y02651 56300002
*  ISSUE IN MODULE IEE3603D MUST BE DEQUEUED OF.                 Y02651 56400002
*                                                                Y02651 56500002
CDEQUE   EQU   *                                                 Y02651 56600002
         DEQ   MF=(E,IEFDEQUE)                                   Y02651 56700002
*                                                                Y02651 56800002
**************************************************               Y02651 56900002
         SPACE 10                                                       57000002
         LR    R1,R12                   PTR TO MSG AREA IN 1      19084 57100002
         FREEMAIN R,LV=96,A=(1),SP=229                           Y02669 57200002
         L     R1,D64(R13)         CSCB PTR                      Y02669 57300002
         USING CHAIN1,R1                                         Y02669 57400002
         OI    CHSTS,CHFC          SET TO FREE CSCB              Y02669 57500002
         MGCR  (1),CHAIN                                         Y02669 57600002
         LM    R0,R15,ZERO(R13)    RESTORE REGS                  Y02669 57700002
         LR    R4,R14              SAVE RETURN ADDRESS           Y02669 57800002
*                                  FREE SAVE AREA GOTTEN IN 3303DY02669 57900002
         LR    R1,R2               DUMMY XSA POINTER             Y02669 58000002
         LA    R0,D132             DUMMYXSA SIZE AND SVAREA SIZE Y02669 58100002
         FREEMAIN R,LV=(0),A=(1)                                 Y02669 58200002
*                                  FREE DUMMY XSA GOTTEN IN 3603DY02669 58300002
         LR    R14,R4              RESTORE RETURN REG            Y02669 58400002
         BR    R14                      RETURN                    19084 58500002
         EJECT                                                          58600002
**************************************************               Y02651 58700002
*  DEQ LIST FORM FOLLOWS:                                        Y02651 58800002
*                                                                Y02651 58900002
IEFDEQUE DEQ   (IEFSQCBS,IEFQ4QCB,TWO,SYSTEM,IEFSQCBS,IEFVQCBS,SVN,    *59000002
               SYSTEM),RET=HAVE,MF=L                           @YM5443P 59030002
IEFVQCBS DC    C'VARYDEV'                                               59060002
IEFSQCBS DC    C'SYSIEFSD'                                       Y02651 59100002
IEFQ4QCB DC    C'Q4'                                             Y02651 59200002
**************************************************               Y02651 59300002
         EJECT                                                          59400002
*********************************************************************** 59500002
*                                                                 19084 59600002
*        DECLARE AREA FOR MODULE                                  19084 59700002
*                                                                 19084 59800002
*********************************************************************** 59900002
*                                                                 19084 60000002
         DS    0F                                                Y02669 60100002
VCON73   DC    V(IEE7303D)                                       Y02669 60200002
EXITNAME DC    C'73'                                             Y02669 60300002
CNO      DC    C'NO'               HARDCPY NOCMDS OR CMDS- DO NOT 19084 60400002
CMDS     DC    C'CMDS  '                                          21002 60500002
INCMDS   DC    C'IN'                   INCMDS                     21002 60600002
STCMDS   DC    C'ST'                   STCMDS                     21002 60700002
CNONE    DC    C'NONE'             NO CMD AUTH OR NO ROUTS        19084 60800002
FOUR     DC    H'4'                CONSTANT TO GET PFX PTR        19084 60900002
FOX7     DC    X'00F7'             ..                             19084 61000002
CCMDALL  DC    X'E000'             ALL CMD AUTH                   19084 61100002
CINFO    DC    C'INFO'             INFO COMD AUTH                 19084 61200002
CSYS      DC    C'SYS '              CMD AUTH OF 1                19084 61300002
CIO      DC    C',IO  '            CMD AUTH OF 2                  19084 61400002
CONS     DC    C',CONS'            CMD AUTH OF 3                  19084 61500002
CALL     DC    C'ALL'              ALL ROUT AND CMD AUTH          19084 61600002
COUNIT   DC    C'O-'               OUTPUT ONLY UNIT               19084 61700002
CIUNIT   DC    C'(I-'              BEGINNING OF COMPOSITE         19084 61800002
CPENG    DC    C',P'               PENDING TO GO TO CONSOLE       19084 61900002
OLTTEST  DC    C'N,T'                  DEVICE IS NOT ACTIVE AND   21051 62000002
*                                      UNDER TEST BY OLTEP        21051 62100002
ZEROZERO DC    X'00'                                           @ZM30445 62150003
ELINE    WTO   (,E),MF=L                                          21002 62200002
         SPACE 5                                                        62300002
PATCH    DC    CL50'***IEE4803D***'                            @Z30LPTJ 62400003
         EJECT                                                    19084 62500002
CMESSAGE DSECT                                                    19084 62600002
XMSGHDR  DS    1F                      HEADER FIELD FOR MLWTO     21002 62700002
XTEXT    EQU   *                                                  19084 62800002
*                                                                 19084 62900002
*                                                                 19084 63000002
XUNIT1   DS    CL3                 1ST PHUSICAL UNIT ADDRES       19084 63100002
XBLANK   DS    CL1                 COMMA                          19084 63200002
XUNIT2   DS    CL3                                                19084 63300002
XCOMMA   DS    CL1                                                19084 63400002
XAUNIT1  DS    CL3                                                19084 63500002
XBLK     DS    CL1                                                19084 63600002
XAUNIT2  DS    CL3                                                19084 63700002
XMSGPAD1 DS    CL1                                                19084 63800002
XMSGSTAT DS    CL4                                                19084 63900002
XMSGPAD2 DS    CL1                                                19084 64000002
XMSGAUTH DS    CL1                                                19084 64100002
XMSGPAD3 DS    CL7                     BLANKS                     21002 64200002
XMSGID   DS    CL3                     CONSOLE ID                 21002 64300002
XMSGPAD4 DS    CL1                     BLANK                      21002 64400002
XMSGDID  DS    CL5                     DISPLAY AREA ID            21002 64500002
XMSGPAD5 DS    CL2                     BLANKS                     21002 64600002
XMSGRTCD DS    CL8                                                19084 64700002
XMSGWK   DS    CL30                                               19084 64800002
*                                                                 19084 64900002
         EJECT                                                          65000002
CXSA     DSECT                                                          65100002
         IEEXSA                                                         65200002
         EJECT                                                          72600002
XCVT     DSECT                                                          72700002
         CVT                                                            72800002
         EJECT                                                          72900002
XUCM     DSECT                                                          73000002
         IEECUCM   FORMAT=NEW                                           73100002
         EJECT                                                          73200002
XUCB     DSECT                                                          73300002
         IEFUCBOB                                                       73400002
         EJECT                                                          73500002
CHAIN1   DSECT                                                          73600002
         IEECHAIN                                                       73700002
         EJECT                                                          73800002
         IHAPSA                                                         73900002
         END                                                            74000002
./  ADD  SSI=71290406,NAME=IEE4903D
 TITLE 'IEE4903D - CONSOLE OPERAND PROCESSOR'                           00090003
IEE4903D CSECT                                                          00180002
* A 481600-482200                                              @ZA02592 00210003
* C 080100,220500                                              @ZA02592 00240003
* A 057700-058000,066800-067200,220900,322800,332100,361300,   @ZM34520 00245003
* A 407800-408100,421500-421800,469850-477240,738090-738810,   @ZM34520 00250003
* A 780400-780700,845150-846500,850000,855400                  @ZM34520 00255003
* C 066600,080100                                              @ZM34520 00260003
* D 449100,658800,659700,781200-791100,792900-800100           @ZM34520 00265003
* D (IEFDEQUE) 811800 - 818100                                 @ZA12404 00266051
* C (CDEQUE  ) APPROX. 845400                                  @ZA12404 00267051
* A (IEE36DEQ) APPROX. 890100                                  @ZA12404 00268051
* C (RETURN  )                                                 @ZA13369 00269051
*********************************************************************** 00270002
* MODULE NAME       = IEE4903D                                          00360002
*    CSECT NAME     = IEE4903D                                          00450002
*                                                                       00540002
* LOAD MODULE NAME  = IEE3603D                                          00630002
*                                                                       00720002
* DESCRIPTIVE NAME  = CONSOLE OPERAND PROCESSOR                         00810002
*                                                                       00900002
* COPYRIGHT         = NONE                                              00940051
*                                                                       01080002
* STATUS            = OS/VS/2 MVS 3033 PROCESSOR SUPPORT(SCP)  @G51APSS 01120051
*                                                                       01260002
* FUNCTION          = PROCESSES VARY XXX,CONSOLE,ETC.                   01350002
*                        SETS ALL REQUIRED INTERFACE AND STATUS BITS IN 01440002
*                        THE UCM, UCME, AND UCB                         01530002
*                     PROCESSES PARAMETERS AND CHECKS FOR THEIR         01620002
*                     VALIDITY AND ALLOWABILITY                         01710002
*                     PARAMETERS:                                       01800002
*                        AUTH=                                          01890002
*                        ROUT=                                          01980002
*                        ALTCONS=                                       02070002
*                                                                       02250002
* OPERATION         = THIS MODULE FIRST CHECKS TO SEE IF A     @G51APSS 02290051
*                     NO-CONSOLES CONDITION EXISTS. IF SO THEN @G51APSS 02340051
*                     MESSAGE IEE744I IS ISSUED, A DEQ IS      @G51APSS 02350051
*                     ISSUED FOR Q4 AND VARYDEV, THE GETMAINED @G51APSS 02360051
*                     WORK AREA IS FREED, THE CSCB IS FREED,   @G51APSS 02370051
*                     THE DUMMY XSA IS FREED AND CONTROL IS    @G51APSS 02380051
*                     RETURNED TO THE CALLER. IF A NO-CONSOLES @G51APSS 02390051
*                     CONDITION DOES NOT EXIST THEN A CHECK IS @G51APSS 02400051
*                     MADE TO SEE IF THE DEVICE TO BE          @G51APSS 02410051
*                     VARIED TO THE CONSOLE STATE IS ALREADY A CONSOLE. 02430002
*                     IF IT IS NOT, THEN HARDCPY REQUIREMENTS ARE       02520002
*                     CHECKED SINCE THIS WOULD BE A SECOND OR MORE      02610002
*                     CONSOLE ON THE SYSTEM NOW AND THEREFORE HARDCPY   02700002
*                     IS NOW DEFINITELY REQUIRED.                       02790002
*                     IF HARDCPY ALREADY EXISTS THEN THERE IS NO        02880002
*                     PROBLEM.  THE ONLY THING DONE NOW IS TO CHANGE    02970002
*                     IF REQUIRED, THE AUTHORITY AND ROUTCODES OF THE   03060002
*                     HARDCPY DEVICE TO THE MANDATORY ONES.             03150002
*                     HOWEVER IF HARDCPY DOES NOT EXIST, THEN           03240002
*                     WE CHECK WHETHER SYSLOG IS ACTIVE AND IF SO       03330002
*                     WE MAKE IT HARDCPY AND ISSUE A MSG LETTING THE    03420002
*                     OPERATOR KNOW THIS.                               03510002
*                     IF SYSLOG IS NOT ACTIVE, THEN WE TRY TO MAKE      03600002
*                        1. THE MASTER CONSOLE    OR                    03690002
*                        2. THE NEW CONSOLE COMING ON                   03780002
*                     THE HARDCPY DEVICE. IF ONE OR THE OTHER ARE NOT   03870002
*                     GRAPHIC DEVICES.  IF IT TURNS OUT THAT BOTH ARE   03960002
*                     GRAPHICS, THEN WE ALLOW THIS UNIT TO BECOME A     04050002
*                     CONSOLE BUT WE NOTIFY THE OPERATOR THAT HE WILL   04140002
*                     BE WORKING WITHOUT A HARDCPY DEVICE WHEN IT IS    04230002
*                     REQUIRED TO HAVE ONE.                             04320002
*                     THEN THIS MODULE SETS THE OPEN PENDING FLAG IN    04410002
*                     THE UCME OF THE NEW DEVICE AND CHECKS IF IT IS    04500002
*                     CURRENTLY ONLINE OR OFFLINE.                      04590002
*                     IF OFFLINE, THEN THE ONLINE AND CONSOLE BITS      04680002
*                     ARE SET IN THE UCB OF THE DEVICE AND WE GO AND    04770002
*                     SERVICE ANY FURTHER REQUEST THAT THE OPERATOR     04860002
*                     MIGHT HAVE HAD SUCH AS NEW AUTHORITY, ROUTCODES   04950002
*                     ETC., FOR THIS NEW CONSOLE.                       05040002
*                     IF THE DEVICE IS CURRENTLY ONLINE, WE CHECK IF    05130002
*                     THE DEVICE IS CURRENTLY ALLOCATED.                05220002
*                     IF YES, WE TURN ON THE CHANGE STATUS BIT IN THE   05310002
*                     UCB AND GO PROCESS FURTHER REQUEST FOR CHANGES    05400002
*                     FOR THE UNIT.                                     05490002
*                     IF IT IS NOT ALLOCATED,THEN THE CONSL BIT IS SET  05580002
*                     ON AND WE CONTINUE PROCESSING FURTHER CHANGES AS  05670002
*                     REQUESTED BY THE OPERATOR.                        05760002
*                     IF IT IS NOT ACTIVE AND IS NOT READY, AN @ZM34520 05770003
*                     ERROR MESSAGE (IEE313I) WILL BE ISSUED   @ZM34520 05790003
*                     AND ITS CORRESPONDING PROCESS BIT TURNED @ZM34520 05810003
*                     OFF.                                     @ZM34520 05830003
*                     IN ALL CASES, WHEN THE DEVICE IS VARIED TO THE    05850002
*                     CONSOLE STATE,FROM AN OFFLINE STATE, THIS RTN     05940002
*                     WILL TURN THE MP-OPERATOR BIT IN THE UCB OFF.     06030002
*                     THIS IS DONE SO THAT THE SYSTEM WILL KNOW         06120002
*                     THAT THE UNIT IS IN THE ONLINE/CONSOLE STATE      06210002
*                     DUE TO A 'VARY DEVICE' COMMAND.                   06300002
*                     WHEN ALL UNITS ON THE COMMAND HAVE BEEN PRO-      06390002
*                     CESSED AS DESCRIBED ABOVE, THEN WE ISSUE A        06480002
*                     HEADER MESSAGE AND EXIT TO IEE4803D TO COMPLETE   06570002
*                     THE MESSAGE FOR THIS COMMAND.  IF THERE  @ZM34520 06660003
*                     ARE NO PROCESS BITS REMAINING, A RETURN  @ZM34520 06680003
*                     TO CALLER WILL BE MADE, INSTEAD OF GOING @ZM34520 06700003
*                     TO IEE4803D.                             @ZM34520 06720003
*                                                                       06750002
* NOTES                                                                 06840002
*    DEPENDENCIES   = NONE                                              06930002
*    CHARACTER/CODE DEPENDENCIES                                        07020002
*                  = THIS MODULE CAN BE ASSEMBLED WITH ANY NEW          07110002
*                    CHARACTER/CODE SET.                                07200002
*                                                                       07290002
* RESTRICTIONS     = SEE ENTRY POINTS - INPUT DATA                      07380002
*                    XSA MUST NOT BE FREED BEFORE Q4 AND       @ZA12404 07400051
*                    VARYDEV ARE DEQUEUED AS FIELD XAWORKB     @ZA12404 07420051
*                    CONTAINS POINTER TO THE DYNAMIC DEQUE     @ZA12404 07425051
*                    LIST.                                     @ZA12404 07430051
*                                                              @ZA12404 07440051
*    REGISTER CONVENTIONS                                               07470002
*                  = REGISTERS ARE DEFINED AT LABEL: DEFREG             07560002
*    PATCH LABEL   = PATCH                                              07650002
*                                                                       07740002
* MODULE TYPE      = CSECT                                              07830002
*    PROCESSOR     = ASSEMBLER                                          07920002
*    MODULE SIZE   = X'83C' BYTES                              @G51APSS 07960051
*    ATTRIBUTES    = REENTRANT, REUSABLE, REFRESHABLE, ZERO PSW         08100002
*                    PROTECT KEY,PAGED LPA                              08190002
*                                                                       08280002
* ENTRY POINTS      = IEE4903D FROM IEE4203D                            08370002
*   PURPOSE         = TO PROCESS CONSOLE OPERAND ON THE VARY COMMAND    08460002
*   LINKAGE         = BRANCH                                            08550002
*   INPUT           = REGISTER 2 POINTS TO THE DUMMY XSA                08640002
*                     XAR HAS THE PROCESS SWITCHES FOR THE UNITS        08730002
*                     XAL HAS THE PTR TO THE PARMS OF THE COMMSND       08820002
*                    ADDITIONAL XSA FIELDS ARE DEFINED AT      @ZA13369 08850051
*                    SECTION 'XSA POINTER SAVE AREA'.          @ZA13369 08880051
*                     REGISTER 4 CONTAINS A GRAPHICS INDICATOR          08910002
*                        SET BY IEE4203D                                09000002
*                    REG13 PTS TO THE SAVE AREA GOTTEN IN 3603D         09090002
*                    WORD 17 OF THE SAVE AREA HAS THE CSCB PTR          09180002
*   REGISTERS SAVED = ALL                                               09270002
*   REGISTER USAGE  = R1  OUTPUT=WTO CORE PTR                           09360002
*                     R2  XSA PTR                                       09450002
*                     R3  ADDRESSABILITY                                09540002
*                     R4  UCME PTR                                      09630002
*                     R6  MLWTO AND GFX BYTE INDICATOR                  09720002
*                     R7  PROCESS BITS                                  09810002
*                     R9  UNIT PTR                                      09900002
*                     R10 UCM REGISTER                                  09990002
*                     R11 UCMPRFX REGISTER                              10080002
*                     R12 UCB PTR                                       10170002
*                     R13 SAVE AREA PTR                                 10260002
*   REGISTERS RESTORED                                                  10350002
*                   = ALL                                               10440002
*                                                                       10530002
* EXITS - NORMAL    = TO IEE4803D VIA BRANCH                            10620002
*                     IF ISSUER OF THE COMMAND HAS THE PROPER           10710002
*   CONDITIONS      = AUTHORITY, IF THE UNIT SPECIFIED HAS THE          10800002
*                     ABILITY TO BE VARIED AS A 'CONSOLE' AND           10890002
*                     IF THE PARAMETERS SPECIFIED MAY BE SET,           10980002
*                     IEE4903D WILL EXIT TO IEE4803D SO THAT            11070002
*                     MESSAGES CAN BE SENT INFORMING THE OPERATOR OF    11160002
*                     AUTHORITIES, AND ALTERNATE CONSOLES.              11250002
*   OUTPUT          = XAP CONTAINS THE MLWTO ID AND GRAPHICS ID         11340002
*                     R13 HAS THE SAVE AREA POINTER                     11430002
*                     R2 HAS THE DUMMY XSA POINTER                      11520002
*                     R1 CONTAINS PTR TO BUFFER FOR MSG                 11610002
*                     A MLWTO IS ISSUED FROM THIS MODULE:               11700002
*                     IEE349I CONSOLES                                  11790002
*                     CONSOLE/ALT  COND  AUTH  ID  AREA  ROUTCD         11880002
*                        (IF THIS CONSOLE IS GRAPHICS)                  11970002
*                        OR                                             12060002
*                     IEE349I CONSOLES                                  12150002
*                     CONSOLE/ALT  COND  AUTH  ID  ROUTCD               12240002
*                        ( IF CONSOLE IS NON-GRAPHICS)                  12330002
*                     CONDITIONS SET IN THIS MODULE:                    12420002
*                        OFFLINE TO CONSOLE...                          12510002
*                             SETS UCB BITS:  ON/OFFLINE = ON           12600002
*                                             PRIM CONSL = ON           12690002
*                                             MP-OPERATOR = OFF         12780002
*                             SETS UCME BITS: OPEN PENDG = ON           12870002
*                        IF DEVICE IS UNDER TEST BY OLTEP THEN          12960002
*                        THE 'VARY CONSOLE' REQUEST CANNOT BE           13050002
*                        HONORED                                        13140002
*                        ONLINE ALLOCATED TO CONSOLE...                 13230002
*                             SETS UCB BITS:  CONSOLE CHNG STATUS = ON  13320002
*                                             MP-OPERATOR = N/A         13410002
*                             SETS UCME BITS: OPEN PENDING        = ON  13500002
*                        ONLINE UNALLOCATED TO CONSOLE...               13590002
*                             WHEN ALLOC IS USING THE UCBS:             13680002
*                               SETS UCB BIT:  CONS CHANG STATUS = ON   13770002
*                                              MP-OPERATOR = N/A        13860002
*                               SETS UCME BIT: OPEN PENDING      = ON   13950002
*                             WHEN ALLOC IS NOT USING UCB:              14040002
*                               SETS UCB BIT:  PRIMARY CONSOLE = ON     14130002
*                                              MP-OPERATOR = N/A        14220002
*                               SETS UCME BIT: OPEN PENDING    = ON     14310002
*                     SETS OWN SWITCHES WITHIN XAD OF XSA               14400002
*                     ALSO PUTS OUT THE CONSOLE MESSAGE HEADER WHEN     14490002
*                     ALL THE UNITS IN THE COMMAND HAVE BEEN PROCESSED. 14580002
*                     IN ALL CASES WHERE THE COMMAND WAS HONORED:       14670002
*                             SETS UCB BIT: VARY-OPERATOR-MP  = OFF     14760002
*   RETURN CODES    = NONE                                              14850002
*                                                                       14940002
* EXITS - ERROR     = RETURN TO CALLER                                  15030003
*                     THIS MODULE WILL CLEAN UP ALL CORE BY FREEING     15120003
*                     THE SAVE AREA AND THE DUMMY XSA, FREEING THE      15210003
*                     CSCB CORE VIA AN MGCR MACRO                       15300003
*   CONDITIONS      = A GETMAIN FAILED OR INVALID UNITS HAVE BEEN       15480003
*                     DETECTED AND DELETED, AND HAS RESULTED IN NO      15510003
*                     UNITS LEFT IN THE BUFFER OR THE VARY     @G51APSS 15520051
*                     CONSOLE COMMAND WAS ISSUED WHEN A        @G51APSS 15540051
*                     NO-CONSOLES CONDITION EXISTS.            @G51APSS 15547051
*                                                                       15554051
*   OUTPUT          = 'IEE328I VARY COMMAND ABORTED'                    15570003
*                                                                       15610051
*                              -- OR --                                 15660003
*                                                                       15700051
*                     'IEE313I XXX      UNIT REF INVALID'               15750003
*                                                                       15760051
*                              -- OR --                        @G51APSS 15770051
*                                                                       15776051
*                     'IEE744I VARY CONSOLE REJECTED -         @G51APSS 15790051
*                              NO FULL CAPABILITY CONSOLES'    @G51APSS 15810051
*                     '     TO RESTORE MASTER CONSOLE:'        @G51APSS 15816051
*                     '  1) PRESS ENTER, REQUEST, OR END ON    @G51APSS 15822051
*                           ANY AVAILABLE CONSOLE'             @G51APSS 15826051
*                     '  2) PRESS THE EXTERNAL INTERRUPT KEY'  @G51APSS 15834051
*                                                                       15837051
*   RETURN CODES    = NONE                                              15840002
*                                                                       15930002
* EXTERNAL REFERENCES                                                   16020002
*   ROUTINES        = IEE4803D                                          16110002
*                     IEE2103D                                          16200002
*   DATA AREAS      = SEE EXITS - OUTPUT DATA                           16290002
*                                                                       16380002
* CONTROL BLOCKS    = 1. EXTENDED SAVE AREA (XSA)                       16470002
*                     2. CVT                                            16560002
*                        FIELDS TESTED  = CVTCUCB                       16650002
*                                         CVTMSER                       16740002
*                        FIELDS UPDATED = NONE                          16830002
*                     3. MASTER SCHEDULER RESIDENT DATA AREA (BASEA)    16920002
*                        FIELDS TESTED  = BALOG                         17010002
*                        FIELDS UPDATED = NONE                          17100002
*                     4. UNIT CONTROL MODULE (UCM)                      17190002
*                        FIELDS TESTED = UCMVEA,UCMUCB,UCMATR-BIT UCMUF 17280002
*                                         UCMCOMPC,UCMVEZ,UCMHCUCM      17370002
*                                         UCMSFLG1 BIT-UCMSYSB @G51APSS 17410051
*                                                      UCMSYSE @G51APSS 17460051
*                                                      UCMSYSG          17550002
*                                         UCMDISP BIT -UCMDISPA         17640002
*                                                      UCMDISPC         17730002
*                                         UCMSDS1 BIT -UCMSDS1A         17820002
*                                                      UCMSDS1B         17910002
*                        FIELDS UPDATED = UCMSTS BIT-  UCMTA            18000002
*                                         UCMSFLGS BIT - UCMSYSB        18090002
*                                                        UCMSYSC        18180002
*                                         UCMDISP BIT- UCMDISPB         18270002
*                                         UCMHCUCM,UCMHRDRT,UCMAUTH,    18360002
*                                         UCMRTCD,UCMOAOEN,UCMALTEN     18450002
*                     5. UNIT CONTROL BLOCK (UCB)                       18540002
*                        FIELDS TESTED  = UCBNAME                       18630002
*                                         UCBFL5 BIT- UCBNALOC          18720002
*                                         SRTESTAT BIT- SRTEONLI        18810002
*                                                       SRTEALOC        18900002
*                        FIELDS UPDATED = SRTESTAT BIT- SRTEONLI        18990002
*                                                       SRTESYSR        19080002
*                                                       SRTEDADI        19170002
*                                         UCBWGT BIT - UCBVORSN         19260002
*                     6. COMMAND SCHEDULING CONTROL BLOCK (CSCB)        19350002
*                        FIELDS TESTED  - NONE                          19440002
*                        FIELDS UPDATED - CHSTS - BIT= CHFC             19530002
*                                                                       19620002
* TABLES            = GETMAIN IS ISSUED FOR THE WTO BUFFER.             19710002
*                     96 BYTES FOR SUBPOOL 229.                         19800002
*                                                              @ZA12404 19808051
* XSA POINTER SAVE                                             @ZA12404 19816051
*    AREA          = XAWORKA - LV PARAM FOR DYNAMIC STORAGE    @ZA13369 19824051
*                    XAWORKB - IEE36DEQ POINTER                @ZA12404 19832051
*                    XAWORKC - IEE36WRK POINTER                @ZA13369 19840051
*                    XAWORKD - UNUSED                          @ZA12404 19848051
*                    XAWORKE - UNUSED                          @ZA12404 19856051
*                    XAWORKF - UNUSED                          @ZA12404 19864051
*                    XAWORKG - UNUSED                          @ZA12404 19872051
*                    XAWORKH - UNUSED                          @ZA12404 19880051
*                                                                       19890002
* MACROS            = DEQ,GETMAIN,FREEMAIN,WTO,LOAD,DELETE,MGCR,SETLOCK 19980002
*                                                                       20070002
* MAPPING MACROS    = IEEXSA                                            20160002
*                     CVT                                               20250002
*                     IEEBASEA                                          20340002
*                     IEECUCM                                           20430002
*                     IEFUCBOB                                          20520002
*                     IEECHAIN                                          20610002
*                     IHAPSA                                            20700002
*    SERIALIZATION =  PROTECTION AGAINST COMM. TASK IS ACCOMPLISHED     20790002
*                    IN THIS MODULE BY OBTAINING THE LOCAL AND CMS      20880002
*                    LOCKS AT:                                          20970002
*                       CSETLOCK                                        21060002
*                    AND RELEASING THEM AT:                             21150002
*                       UNSETLOK                                        21240002
*                    PROTECTION AGAINST OLTEP, ALLOCATION AND           21330002
*                    VARY/UNLOAD IS ACCOMPLISHED VIA AN ENQ IN MODULE   21420002
*                    IEE3603D                                           21510002
*                    THE DEQ IS ISSUED AT CDEQUE IN THIS MODULE ONLY IF 21600002
*                    A TERMINAL EXIT IS TAKEN IN THIS MODULE            21690002
*                    ALL BIT SETTINGS IN THE UCB ARE TURNED ON/OFF      21780002
*                    VIA THE COMPARE-AND-SWAP INSTRUCTION.              21870002
*                                                                       21960002
* CHANGE LEVEL      = Y02669, Y02651, Z30LPTJ, ZA02592,        @ZA02592 22050003
*                     ZM34520, OZ12404, OZ13369, G51APSS       @G51APSS 22070051
*                                                                       22320002
* MESSAGES          = IEE349I CONSOLES                                  22410002
*                     CONSOLE/ALT  COND  AUTH  ID  AREA  ROUTCD         22500002
*                        (IF THIS CONSOLE IS GRAPHICS)                  22590002
*                        OR                                             22680002
*                     IEE349I CONSOLES                                  22770002
*                     CONSOLE/ALT  COND  AUTH  ID  ROUTCD               22860002
*                        (IF THIS CONSOLE IS NON-GRAPHICS)              22950002
*                                                                       22990003
*                     'IEE709I HARDCOPY REQUIRED-NO HARDCOPY DEVICE     23040002
*                     AVAILABLE.'                                       23130002
*                     (IF HARCPY IS REQUIRED ON THE SYSTEM, AND YET     23220002
*                     THE MASTER CONSOLE OR THE NEW CONSOLE ARE BOTH    23310002
*                     GRAPHICS DEVICES AND SYSLOG IS INACTIVE.)         23400002
*                                                                       23440003
*                     'IEE710I         NOW RECEIVING HARDCOPY.'         23490002
*                     (WHEN A HARDCPY DEVICE, SUCH AS SYSLOG, OR THE    23580002
*                     MASTER CONSOLE OR THE NEW CONSOLE UNIT IS         23670002
*                     FORCED AS THE HARDCPY, BECAUSE HARDCPY IS NOW     23760002
*                     REQUIRED)                                         23850002
*                                                                       23890003
*                     MESSAGE 'IEE328I VARY COMMAND ABORTED'            23940002
*                     IS ISSUED FROM IEE2103D WHEN THE GETMAIN          24030002
*                     FOR THE WTO BUFFER IS UNSUCCESSFUL.               24120002
*                                                                       24130003
*                     'IEE313I XXX      UNIT REF INVALID'               24140003
*                     (WHEN A NOT ACTIVE & NOT READY CONSOLE DEVICE IS  24150003
*                     DETECTED)                                         24160003
*                                                                       24166051
*                     'IEE744I VARY CONSOLE REJECTED -         @G51APSS 24172051
*                              NO FULL CAPABILITY CONSOLES'    @G51APSS 24178051
*                     '     TO RESTORE MASTER CONSOLE:'        @G51APSS 24184051
*                     '  1) PRESS ENTER, REQUEST, OR END ON    @G51APSS 24190051
*                           ANY AVAILABLE CONSOLE'             @G51APSS 24194051
*                     '  2) PRESS THE EXTERNAL INTERRUPT KEY'  @G51APSS 24202051
*                                                                       24210002
* ABEND CODES       = NONE                                              24300002
*                                                                       24390002
* PACKAGING         = IEE4903D WILL BE PART OF LOAD MODULE              24480002
*                        = IEE3603D                                     24570002
*                     THIS LOAD MODULE ALIASES ARE                      24660002
*                        = NONE                                         24750002
*                     THIS LOAD MODULE ENTRY POINTS ARE                 24840002
*                        = IEE3603D                                     24930002
*                     THIS MODULE WILL RESIDE IN:  LPALIB               25020002
*                                                                       25110002
* SYSGEN            = SUPPLIED BY THE FOLLOWING SECTIONS:               25200002
*                        LOAD MODULE NAME                               25290002
*                        PACKAGING                                      25380002
*                     THIS CSECT WILL BE INCLUDED AT SYSGEN FROM        25470002
*                     DLIB -AOSB3- BY MACRO -SGIEF441-                  25560002
*                                                                       25650002
* SYSTEM LIBRARIES  = NONE                                              25740002
*                                                                       25830002
*********************************************************************** 25920002
         EJECT                                                          26010002
*****************************************************************Y02669 26100002
*                             ***                                ***    26190002
*                             *        ***                     *** *    26280002
*                             *        *                         * *    26370002
*                             *        * ALL                     * *    26460002
*                             *        * INFO                    * *    26550002
*                             * ,AUTH= * **   ** **  ** **    ** * *    26640002
*                             *        * * SYS *,* IO *,* CONS * * *    26730002
*                             *        * **   ** **  ** **    ** * *    26820002
*                             *        *                         * *    26910002
*                             *        ***                     *** *    27000002
*   ***           ***         *                                    *    27090002
*   *               *         *        ***                     *** *    27180002
*   * XXX           *         *        *                         * *    27270002
*   *               *         *        * ALL                     * *    27360002
* V * O-XXX         *,CONSOLE * ,ROUT= * NONE                    * *    27450002
*   *               *         *        * ROUTCODE(,ROUTCODE,...) * *    27540002
*   * (I-XXX,O-XXX) *         *        *                         * *    27630002
*   *               *         *        ***                     *** *    27720002
*   ***           ***         *                                    *    27810002
*                             *           ***           ***        *    27900002
*                             *           *               *        *    27990002
*                             *           * XXX           *        *    28080002
*                             * ,ALTCONS= * O-XXX         *        *    28170002
*                             *           * (I-XXX,O-XXX) *        *    28260002
*                             *           *               *        *    28350002
*                             *           ***           ***        *    28440002
*                             ***                                ***    28530002
*****************************************************************Y02669 28620002
         EJECT                                                          28710002
*                                                                 19084 28800002
*        REGISTER EQUATES                                         19084 28890002
*                                                                 19084 28980002
DEFREG   EQU   *                                                 Y02669 29070002
R0       EQU   0                                                  19084 29160002
R1       EQU   1                   IN-XAD,OUT-WTO CORE PTR        19084 29250002
R2       EQU   2                   XSA                            19084 29340002
R3       EQU   3                   ADDRESS                        19084 29430002
R4       EQU   4                                                        29520002
R5       EQU   5                   UCME                          Y02669 29610002
R6       EQU   6                                                  19084 29700002
R7       EQU   7                   PROCESS BITS                   19084 29790002
R8       EQU   8                   STAE REG                       19084 29880002
R9       EQU   9                   UNIT PTR                       19084 29970002
R10      EQU   10                  UCM REG                        19084 30060002
R11      EQU   11                  UCMPFX REG                     19084 30150002
R12      EQU   12                  UCB PTR                        19084 30240002
R13      EQU   13                                                 19084 30330002
R14      EQU   14                  RET ADDR                       19084 30420002
R15      EQU   15                                                 19084 30510002
         SPACE 3                                               @G51APSS 30600051
*********************************************************************** 30780002
*        EQUATES                                                  19084 30960002
*********************************************************************** 31140002
ZERO     EQU   0                                                  19084 31230002
ONE      EQU   1                                                  19084 31320002
TWO      EQU   2                                                  19084 31410002
TRE      EQU   3                                                  19084 31500002
FOR      EQU   4                                                  19084 31590002
SIX      EQU   6                                                  19084 31680002
SVN      EQU   7                                                  19084 31770002
EIT      EQU   8                                                  19084 31860002
FOX      EQU   255                                                19084 32040002
MSGLEN   EQU   96                      LENGTH FOR GETMAIN.        21002 32130002
GETERRCD EQU   X'3A'                   ERROR MESSAGE INDICATOR.  Y02669 32220002
UNITERR  EQU   X'0D'                   ERROR MESSAGE INDICATOR @ZM34520 32280003
D12      EQU   12                                                Y02669 32400002
D8       EQU   8                                                 Y02669 32490002
D3       EQU   3                                                 Y02669 32580002
D15      EQU   15                                                Y02669 32670002
D5       EQU   5                                                 Y02669 32760002
D64      EQU   64                                                Y02669 32850002
D16      EQU   16                                                Y02669 32940002
D68      EQU   68                                                Y02669 33030002
D46      EQU   46                                                Y02669 33120002
D76      EQU   76                                              @ZM34520 33210003
D132     EQU   132                                               Y02669 33300002
GRPX    EQU   X'FF'                   GRAPHICS INDICATOR          21002 33660002
SHIFT8  EQU   8                       REMOVE ONE BYTE             21002 33750002
MASK00   EQU   X'00'                                             Y02669 33840002
RIID     EQU   X'80'                                              19084 34020002
MC       EQU   X'80'                                              19084 34110002
USYSLG   EQU   X'00'                                              19084 34200002
         EJECT                                                          34290002
*********************************************************************** 34380002
*        CONSOLE PROCESSOR MODULE                                 19084 34470002
         BALR  R3,ZERO                                            19084 34560002
         USING *,R3                                               19084 34650002
         MODID BR=YES                                            Y01886 34740002
         USING XSA,R2                                             19084 34830002
         STM   R0,R15,ZERO(R13)                                  Y02669 34920002
         ST    R13,XAK           STORE SAVE AREA PTR, NEED R13 @Z30LPTJ 35010003
         L     R10,XAD                 SAVE FLAGS.               Y02669 35100002
         MVC   XAD(GETLNTH),GETLIST    MOVE IN GETMAIN LIST.      21002 35190002
         LA    R1,XAX                  GET ADDRESS POINTER.       21002 35280002
         ST    R1,XAX                  GETMAIN ADDRESS.           21002 35370002
         LA    R1,XAD                  GETMAIN LIST POINTER.      21002 35460002
         GETMAIN MF=(E,(1))            DO CONDITIONAL GETMAIN.    21002 35550002
         LTR   R15,R15                 WAS GETMAIN SUCCESSFUL ?   21002 35640002
         BNZ   GETFAIL                 NO,SO TAKE ERROR EXIT.     21002 35730002
* XAX CONTAINS THE ADDRESS OF GOTTEN CORE                               35820002
         STC   R4,XAX+FOR              SAVE GRAPHICS INDICATOR    21002 35910002
         ST    R10,XAD                 SET UP PASSED SWITCHES.    21002 36000002
         L     R4,XAR              PROCESS SWITCHES               19084 36090002
         XC    XAP(ONE),XAP        ZERO OUT THE SHIFT COUNTER  @ZM34520 36130003
         L     R9,XAL              GET PTR TO UNIT BEGIN          19084 36180002
         LA    R9,ZERO(R9)                                        19084 36270002
         L     R10,CVTPTR                                         19084 36360002
         USING CCVT,R10                                           19084 36450002
         L     R10,CVTCUCB         GET PTR TO UCM                 19084 36540002
         DROP  R10                                                19084 36630002
         USING UCM,R10                                                  36720002
*                                                                 19084 36810002
         LR    R11,R10             UCM PTR                        19084 36900002
         SH    R11,FOUR            MINUS FOUR IS UCMPFX ADD PTR   19084 36990002
         L     R11,ZERO(R11)       GET PFX PTR                    19084 37080002
         USING UCMPRFX,R11                                        19084 37170002
         EJECT                                                          37260002
**************************************************               Y02651 37350002
*                                                                Y02651 37440002
* LOCKS ARE NEEDED AT THIS POINT AS PROTECTION AGAINST COMM TASK Y02651 37530002
*  LOCKS WILL BE GOTTEN AT : CSETLOCK                            Y02651 37620002
*  AND THEY WILL BE RELEASED AT: UNSETLOK                        Y02651 37710002
*                                                                Y02651 37800002
         BAL   R8,CSETLOCK                                       Y02651 37890002
**************************************************               Y02651 37980002
         SPACE 2                                               @G51APSS 38020051
*********************************************************************** 38070051
*        IF A NO-CONSOLES CONDITION EXISTS THEN ISSUE MSG      @G51APSS 38074051
*        IEE744I AND IGNORE THE VARY CONSOLE                   @G51APSS 38078051
*********************************************************************** 38082051
         SPACE 1                                               @G51APSS 38086051
         TM    UCMSFLG1,UCMSYSE    DOES A NO-CONSOLES CONDITION EXIST? X38090051
                                                               @G51APSS 38094051
         BNO   OKPROCES            NO, PROCESS THE CMD         @G51APSS 38098051
         SR    R0,R0               READY FOR CONSOLE ID        @G51APSS 38102051
         TM    XAU,RIID            WAS IT READER COMMAND?      @G51APSS 38106051
         BO    ISS744I             YES, R0 IS NOW SET          @G51APSS 38110051
         IC    R0,XAU              GET CONSOLE ID              @G51APSS 38114051
ISS744I  EQU   *                                               @G51APSS 38118051
         BAL   R8,UNSETLOK         RELEASE THE LOCKS           @G51APSS 38122051
         LA    R1,NCCMSG           MSG IEE744I                 @G51APSS 38126051
         WTO   MF=(E,(1))          ISSUE MSG IEE744I           @G51APSS 38130051
         B     CLEANUP             GO FREE RESOURCES           @G51APSS 38134051
         SPACE 3                                               @G51APSS 38138051
OKPROCES EQU   *                                               @G51APSS 38142051
         TM    XADUSWIT,XAXPAREN   MULTIPLE UNITS              @Z30LPTJ 38160003
         BZ    CSINGLE             NO                             19084 38250002
CSTART   LA    R9,ONE(R9)          YES,INDEX PAST BEGINING PARE   19084 38340002
CSINGLE  EQU   *                                                  19084 38430002
         CLC   ZERO(TWO,R9),COUNIT      IS IT AN O-XXX            19084 38520002
         BNE   CCOMP                    NO, MAYBE A COMPOSITE     19084 38610002
         LA    R9,TWO(R9)               YES INDEX TO UNITNAME     19084 38700002
         OI    XADUSWIT,XAOUNIT       SET XAOUNIT SWITCH ON    @Z30LPTJ 38790003
         B     CTEST                    GO CHECK IF MUST PROCESS  19084 38880002
*                                                                 19084 38970002
CCOMP    EQU   *                                                  19084 39060002
         CLC   ZERO(TRE,R9),CIUNIT      DO WE HAVE A COMPOSITE    19084 39150002
         BNE   CTEST                  NO,ITS A REGULAR UNIT     19084   39240002
         LA    R9,TRE(R9)               YES,INDEX TO INPUT UNIT NM19084 39330002
         OI    XADUSWIT,XAIOCOMP        TURN COMPOSITE SWITCH  @Z30LPTJ 39420003
*                                                                 19084 39510002
CTEST    EQU   *                                                  19084 39600002
         LTR   R4,R4                    DO WE PROCESS THIS UNIT   19084 39690002
         BZ    CMSGRDY                  NO, AND NOMOR EITHER, FINI19084 39780002
         BM    CPROCES                  YES, PROCESS THIS ONE     19084 39870002
*                                       NO, NOT PROCESS THIS ONE  19084 39960002
COMIT    EQU   *                        THERE ARE OTHERS          19084 40050002
         TM    XADUSWIT,XAIOCOMP   WAS IT A COMP TO OMIT?      @Z30LPTJ 40140003
         BZ    CENDCK                   NO,                       19084 40230002
         LA    R9,SVN(R9)               YES INDEX OVER            19084 40320002
*                                                                 19084 40410002
CENDCK   EQU   *                                                  19084 40500002
         LA    R9,TRE(R9)               TO THE DELIMITER AFTER UNI19084 40590002
         NI    XADUSWIT,XAXPAREN TURN ALL OFF EXPT EXTR PARENS @Z30LPTJ 40680003
         SLL   R4,ONE              UP ALL SWITCHES               Y02669 40770002
         SR    R8,R8               ZERO OUT FOR NEXT INSTR.    @ZM34520 40780003
         IC    R8,XAP              OBTAIN CURRENT COUNTER      @ZM34520 40800003
         LA    R8,ONE(R8)          INCREMENT COUNTER BY ONE    @ZM34520 40820003
         STC   R8,XAP              STORE UPDATED SHIFT COUNTER @ZM34520 40840003
         B     CSTART              AND START AGAIN               Y02669 40860002
*                                                                 19084 40950002
CPROCES  EQU   *                                                  19084 41040002
         LM    R5,R7,UCMVEA        GET UCMES PTRS                 19084 41130002
         USING UCMLIST,R5                                         19084 41220002
CLOOP    L     R12,UCMUCB          AND UCB ADDRESSABILITY         19084 41310002
         USING CUCB,R12                                           19084 41400002
         CLC   ZERO(TRE,R9),UCBNAME     IS THIS THE UCME FOR UNIT 19084 41490002
         BE    CFIND               YES,                           19084 41580002
         BXLE  R5,R6,CLOOP         MUST BE NEXT ONE GO CHECK      19084 41670002
*                                  WILL ALWAYS FIND ONE,CHECKED BY 4203 41760002
CFIND    EQU   *                                                  19084 41850002
         TM    UCMATR,UCMUF        ACTIVE CONSOLE CURRENTLY       19084 41940002
         BO    CATTRIB             YES, GO CHANGE ATTRIBUTES ONLY 19084 42030002
*                                  CONSOLE IS NON ACTIVE          19084 42120002
         TM    UCBFLA,UCBNRY       IS DEVICE NOT READY?        @ZM34520 42150003
         BO    CONLINE             YES, ISSUE ERROR MESSAGE    @ZM34520 42180003
         TM    XADUSWIT,XAIOCOMP   PROCESSING I-UNIT           @Z30LPTJ 42210003
         BZ    CHCPREQ             NO,GO CHECK HCPY REQ          Y02669 42300002
*                                                                 19084 42390002
CSTATUS  EQU   *                                                  19084 42480002
*                                                                 19084 42570002
*        SET APPRORIATE BITS IN UCME AND UCB TO SHOW THAT THIS DEV19084 42660002
*        IS TO BE A CONSOLE                                       19084 42750002
*                                                                 19084 42840002
         OI    UCMSTS,UCMTA        OPEN FOR COMM TASK            Y02669 42930002
*        NI    SRTESTAT,FOX-SRTEDADI+SRTECHGS  TURN ALL PNDG BITSY02651 43020002
*                                 OFF JUST IN CASE THEY ARE ON   Y02651 43110002
*                                                                Y02651 43200002
********** THE ABOVE INSTRUCTION WILL BE PROTECTED VIA THE       Y02651 43290002
*          COMPARE-AND-SWAP INSTRUCTION                          Y02651 43380002
*                                                                Y02651 43470002
         L     R8,XAK             SAVE AREA POINTER            @Z30LPTJ 43560003
         STM   R4,R6,D68(R8)      STORE USED FOR OIL/NIL         Y02651 43650002
DADINI   EQU   *                                                 Y02651 43740002
NILDADI  EQU   X'FE'     -X'FF'-SRTEDADI-                        Y02651 43830002
         NIL   SRTESTAT,NILDADI,WREGS=(4,5,6),REF=CUCB           Y02651 44010002
CHGSNI   EQU   *                                                 Y02651 44100002
NILCHGS  EQU   X'BF'     -X'FF'-SRTECHGS-                        Y02651 44190002
         NIL   SRTESTAT,NILCHGS,WREGS=(4,5,6),REF=CUCB           Y02651 44370002
         LM    R4,R6,D68(R8)                                     Y02651 44460002
*                                                                Y02651 44550002
         TM    SRTESTAT,SRTEONLI   IS DEV CURRENTLY ONLINE        19084 44640002
         BO    CONLINE             YES,GO TO ONLINE PROCESSOR     19084 44730002
         EJECT                                                          44820002
*       NI    UCBWGT,FOX-UCBVORSN                                Y02669 45000002
*       OI    SRTESTAT,SRTEONLI+SRTESYSR  TURN ONL AND CONS BITS Y02651 45090002
*                                                                Y02651 45180002
********** THE ABOVE INSTRUCTION WILL BE PROTECTED VIA THE       Y02651 45270002
*          COMPARE-AND-SWAP INSTRUCTION                          Y02651 45360002
*                                                                Y02651 45450002
NILOPER  EQU   *                                                 Y02651 45540002
NILVORSN EQU   X'FB'    -X'FF'-UCBVORSN-                         Y02651 45630002
         NIL   UCBWGT,NILVORSN,WREGS=(4,5,6),REF=CUCB            Y02651 45810002
ONLIOI   EQU   *                                                 Y02651 45900002
         OIL   SRTESTAT,SRTEONLI,WREGS=(4,5,6),REF=CUCB          Y02651 45990002
OISYSR   EQU   *                                                 Y02651 46080002
         OIL   SRTESTAT,SRTESYSR,WREGS=(4,5,6),REF=CUCB          Y02651 46170002
         LM    R4,R6,D68(R8)                                     Y02651 46260002
*                                                                Y02651 46350002
*                                                                 19084 46440002
         B     CATTRIB             GO CHECK ATTRIBUTES            19084 46530002
*                                                                 19084 46620002
         EJECT                                                    19084 46710002
CONLINE  EQU   *                                                  19084 46800002
         L     R8,XAK             SAVE AREA POINTER            @Z30LPTJ 46890003
         STM   R4,R6,D68(R8)                                     Y02669 46980002
         TM    UCBFLA,UCBNRY       IS DEVICE NOT READY?        @ZM34520 46985003
         BNO   ITSREADY            NO, IT IS READY, BRANCH     @ZM34520 46991003
         TM    XADUSWIT,XAIOCOMP   IS IT COMPOSITE 'I-UNIT'?   @ZM34520 46997003
         BO    PARTTWO             YES, PROCESS 'O-UNIT'       @ZM34520 47003003
         L     R8,XAX              OBTAIN POINTER TO CORE      @ZM34520 47009003
         STM   R4,R6,D64(R8)       SAVE DATA IN GOTTEN CORE    @ZM34520 47015003
         L     R4,MASKBIT          GET MASK FOR BIT TURN OFF   @ZM34520 47021003
         L     R5,XAR              OBTAIN PROCESS BIT SWITCHES @ZM34520 47027003
         SR    R6,R6               ZERO OUT FOR NEXT INSTR.    @ZM34520 47033003
         IC    R6,XAP              OBTAIN THE SHIFT COUNTER    @ZM34520 47039003
         LTR   R6,R6               IS THERE ANY SHIFT COUNTER? @ZM34520 47045003
         BZ    AROUND              NO, BRANCH AROUND THE LOOP  @ZM34520 47051003
LOOP     EQU   *                                               @ZM34520 47057003
         SRL   R4,ONE              SHIFT RIGHT ONE BIT         @ZM34520 47063003
         BCT   R6,LOOP             LOOP UNTIL CORRECT POSITION @ZM34520 47069003
AROUND   EQU   *                                               @ZM34520 47075003
         XR    R5,R4               TURN OFF THE BAD UNIT BIT   @ZM34520 47081003
         SR    R6,R6               ZERO OUT FOR NEXT INSTR.    @ZM34520 47087003
         IC    R6,XAP              SAVE SHIFT COUNTER          @ZM34520 47093003
         MVI   XAE,UNITERR         SET ERROR MESSAGE CODE      @ZM34520 47099003
         MVC   XAV(D3),ZERO(R9)    MOVE IN INVALID DEVICE NAME @ZM34520 47105003
         MVC   XAV+TRE(D5),BLANKS  BLANK OUT REST OF AREA      @ZM34520 47111003
         MVC   D76(D16,R8),XAP     SAVE IMPORTANT XSA DATA     @ZM34520 47117003
         LR    R4,R8               SAVE THE SAVE AREA POINTER  @ZM34520 47123003
         BAL   R8,UNSETLOK         RELEASE THE LOCKS FOR WTO   @ZM34520 47129003
         L     R13,XAX             OBTAIN POINTER TO CORE      @ZM34520 47135003
         BAL   R8,MSGMODA          ISSUE THE ERROR MESSAGE     @ZM34520 47141003
         BAL   R8,CSETLOCK         OBTAIN THE LOCKS            @ZM34520 47147003
         LR    R8,R4               RESTORE THE SAVE AREA PTR.  @ZM34520 47153003
         MVC   XAP(D16),D76(R8)    RESTORE THE XSA DATA        @ZM34520 47159003
         MVC   XAV(EIT),VARYID     RESTORE 'VARY' CMD. NAME    @ZM34520 47165003
         ST    R5,XAR              STORE UPDATED BIT SWITCHES  @ZM34520 47171003
         STC   R6,XAP              RESTORE THE SHIFT COUNTER   @ZM34520 47177003
         LM    R4,R6,D64(R8)       RESTORE SAVED REGISTERS     @ZM34520 47183003
         B     CRETURN             CHECK FOR MORE UNITS        @ZM34520 47189003
ITSREADY EQU   *                                               @ZM34520 47195003
         TM    SRTESTAT,SRTEALOC   IS DEVICE ALLOCATED            19084 47232003
         BO    ONALLOC             YES, GO PROCESS ACCORDINGLY    19084 47240003
*        OI    SRTESTAT,SRTESYSR   NO, SET CONSOLE BIT IN UCB    Y02651 47250002
         B     OISYSR              GO EXECUTE THE ABOVE INSTR    Y02651 47340002
*                                                                 19084 47430002
ONALLOC  EQU   *                                                  19084 47520002
*        OI    SRTESTAT,SRTEDADI   TURN ON CHANGE STATUS BIT     Y02651 47610002
*                                                                Y02651 47700002
********** THE ABOVE INSTRUCTION WILL BE PROTECTED VIA THE       Y02651 47790002
*          COMPARE-AND-SWAP INSTRUCTION                          Y02651 47880002
*                                                                Y02651 47970002
OIDADI   EQU   *                                                 Y02651 48060002
         OIL   SRTESTAT,SRTEDADI,WREGS=(4,5,6),REF=CUCB          Y02651 48150002
         L     R15,CVTPTR          OBTAIN CVT POINTER          @ZA02592 48160003
         USING CCVT,R15                                        @ZA02592 48170003
         L     R15,CVTMSER         GET MASTER RESIDENT CORE    @ZA02592 48180003
         DROP  R15                                             @ZA02592 48190003
         USING BASE,R15                                        @ZA02592 48200003
         OIL   MSECBFL,MSSUM,WREGS=(4,5,6),REF=BASE            @ZA02592 48210003
         DROP  R15                                             @ZA02592 48220003
         LM    R4,R6,D68(R8)                                     Y02651 48240002
         B     CATTRIB             GO CHECK CONSOLES ATTRIBUTES   19084 48330002
         EJECT                                                          48420002
CHCPREQ  EQU   *                                                  19084 48510002
*                                                                 19084 48600002
*        PROCESING AN OUTPUT ONLY, AN IO CONSOLE, OR THE O-UNIT OF19084 48690002
*        COMPOSITE. THEREFORE HARDCPY REQUIREMENTS MUST BE CHECKED19084 48780002
*        R5    UCME PTR TO NEW CONSOLE                           Y02669 48870002
*        R9    PTS TO UNIT IN COMMAND                             19084 48960002
*        R10   UCM PTR                                            19084 49050002
*        R11   UCMPFX PTR                                         19084 49140002
*        R12   UCB PTR                 *                          21051 49230002
*                                                                 21051 49320002
         OI    UCMSFLGS,UCMSYSB    TURN HCPY EXISTS BIT        @YM08624 49330002
         L     R7,UCMHCUCM         HARDCOPY ADDRESS, IF PRESENT@YM07658 49340002
         LTR   R7,R7               HARDCOPY PRESENT?           @YM07658 49360002
         BNZ   MANDRT              YES, CHECK AUTHORITY        @YM07658 49380002
*        NO HCPY EXISTS, THEREFORE PAST- ONE ACTV CONS - MSTR     19084 49590002
*                                  NOW - NEW CONSOLE WILL MAKE HCP19084 49680002
*                                        MANDATORY                19084 49770002
         TM    UCMSFLGS,UCMSYSG        IS SYSLOG FUNCTIONING     Y02669 49860002
*                                 AS THE HARDCPY LOG NOW         Y02669 49950002
         BO    MANDRT             YES, CK CMD AUTHORITY          Y02669 50040002
         L     R15,CVTPTR                                        Y02669 50220002
         USING CCVT,R15                                          Y02669 50310002
         L     R15,CVTMSER         PICK UP MSTER RES CORE ADDR   Y02669 50400002
         DROP  R15                                               Y02669 50490002
         USING BASE,R15                                          Y02669 50580002
         CLI   BALOG,USYSLG        IS SYSLOG SUPPORTED           Y02669 50670002
         BNE   SYSHCPY             YES, MAKE IT THE HARDCPY      Y02669 50760002
         DROP  R15                                               Y02669 50850002
*                                                                Y02669 50940002
*     CONTINUE TO FIND MASTER'S UCME SINCE SYSLOG IS NOT ACTIVE  Y02669 51030002
*                                                                Y02669 51120002
         LM    R13,R15,UCMVEA                                     19084 51210002
         DROP  R5                                                 19084 51300002
         USING UCMLIST,R13                                        19084 51390002
CTST     EQU   *                                                  19084 51480002
         TM    UCMDISP,UCMDISPA    IS THIS THE MSTR CONSOLE       19084 51570002
         BO    CMSTR               YES,FOUND IF                   19084 51660002
         BXLE  R13,R14,CTST        NO,MUST BE NEXT                19084 51750002
CMSTR    EQU   *                   NO,ERROR CONDITION             19084 51840002
         TM    UCMDISP,UCMDISPC    IS THE MASTER A GRAPHICS      Y02669 51930002
         BO    CXSTS               YES, CHECK THE NEW CONSOLE    Y02669 52020002
         OI    UCMDISP,UCMDISPB    TURN MSTR UCME TO INDICATE HCPY19084 52110002
         ST    R13,UCMHCUCM        AND STORE PTR TO IT IN PFX     19084 52200002
         DROP  R13                                                19084 52290002
         USING UCMLIST,R5                                         19084 52380002
         B     MANDRT01            SET MANDATORY ROUTS AND CMDS  Y02669 52470002
*                                                                 19084 52560002
*        HARDCPY DOES EXIST- CHECK IF IT IS GFX                   19084 52650002
*                                                                 19084 52740002
CXSTS    EQU   *                                                  19084 52830002
         TM    UCMDISP,UCMDISPC    IS NEW CONS. A GFX                   52920002
         BO    CBOTHGFX            OOPS-BOTH ARE GFX CONSOLES           53010002
*                                                                       53100002
*    NEW CONSOLE IS PAPER PROD, THEREFORE MAKE NEW CONSOLE INTO         53190002
*    HARDCPY                                                            53280002
*                                                                       53370002
         OI    UCMDISP,UCMDISPB    TURN HCPY BIT IN NEW CONSOLE         53460002
         ST    R5,UCMHCUCM         STORE ITS UCME PTR IN HCPY PTR       53550002
         B     MANDRT02            GO SET MANDTRY ROUTCDS AND CM Y02669 53640002
*                                                                 19084 53730002
*        BOTH CONSOLES ARE GFX                                    19084 53820002
*                   IF SYSLOG IS PRESENT MAKE IT HCPY             19084 53910002
*                   ELSE LEAVE ALL AS IS                          19084 54000002
*                                                                 19084 54090002
*                                                                 19084 54180002
CBOTHGFX EQU   *                                                 Y02669 54270002
         NI    UCMSFLGS,FOX-UCMSYSB   TURN OFF BIT,CANT GET HCPY Y02669 54360002
*****************************************************************Y02669 54450002
*   MESSAGE - SINCE CANNOT GET A HARDCPY DEVICE                  Y02669 54540002
*****************************************************************Y02669 54630002
         SR    R0,R0                                             Y02669 54720002
         TM    XAU,RIID            WAS IT AN INPUT STREAM COMD.  Y02669 54810002
         BO    RDRCMD              YES, R0 FOR WTO IS PRESET     Y02669 54900002
         IC    R0,XAU              GET CONSL ID INTO R0 FOR WTO  Y02669 54990002
RDRCMD   EQU   *                                                 Y02669 55080002
         SPACE 3                                               @G51APSS 55120051
**************************************************               Y02651 55260002
*                                                                Y02651 55350002
*  LOCKS MUST BE RELEASED AT THIS POINT.  A WTO MACRO            Y02651 55440002
*  MUST BE ISSUED                                                Y02651 55530002
*  LOCKS WERE OBTAINED EARLIER AT:                               Y02651 55620002
*    CSETLOCK                                                    Y02651 55710002
*                                                                Y02651 55800002
         BAL   R8,UNSETLOK                                       Y02651 55890002
*                                                                Y02651 55980002
**************************************************               Y02651 56070002
         SPACE 2                                               @G51APSS 56110051
         LA    R1,NOCPYMSG         GET ADDRESS OF THE MESSAGE    Y02669 56250002
         WTO   MF=(E,(1))          ISSUE THE MESSAGE             Y02669 56340002
         SPACE 2                                               @G51APSS 56380051
**************************************************               Y02651 56520002
*                                                                Y02651 56610002
*  WTO MACRO HAS BEEN ISSUED. NEW LOCKS MUST BE OBTAINED         Y02651 56700002
*  TO PROTECT AGAINST COMM. TASK AND ANOTHER VARY CMD            Y02651 56790002
*  THEY WILL BE RELEASED AT:                                     Y02651 56880002
*      UNSETLOK                                                  Y02651 56970002
*                                                                Y02651 57060002
         BAL   R8,CSETLOCK                                       Y02651 57150002
*                                                                Y02651 57240002
**************************************************               Y02651 57330002
         SPACE 2                                               @G51APSS 57370051
         B     CSTATUS             GO CHANGE CONSOLE'S STATUS           57510002
         SPACE 5                                               @G51APSS 57550051
SYSHCPY  EQU   *                                                 Y02669 57870002
         XC    UCMHCUCM(FOR),UCMHCUCM   ZERO OUT HCPY PTR SHOWING 19084 57960002
         OI    UCMSFLGS,UCMSYSG    TURN BIT IN PRX MEANING SYSLOG 19084 58050002
*                                  IS HARDCPY                     19084 58140002
MANDRTS  EQU   *                                                 Y02669 58230002
         L     R1,XAX             POINTER TO GOTTEN CORE         Y02669 58320002
         MVC   ZERO(D46,R1),HCPYMSG   MOVE MSG INTO DYNAMIC CORE Y02669 58410002
         MVC   D12(D8,R1),SYSLOGUT ISSUE MSG ,SYSLOG IS HCPY NOW Y02669 58500002
         B     READY               CONTINUE MSG PROCESSING       Y02669 58590002
*                                                                 19084 58680002
*                                                                Y02669 58770002
*                                                                Y02669 58860002
MANDRT01 EQU   *                                                 Y02669 58950002
         DROP  R5                                                Y02669 59040002
         DROP  R12                                               Y02669 59130002
         USING UCMLIST,R13         ADDRESS OF MASTER'S UCME      Y02669 59220002
         L     R8,UCMUCB           AND ITS UCB                   Y02669 59310002
         USING CUCB,R8                                           Y02669 59400002
PUTMSG   EQU   *                                                 Y02669 59490002
         L     R1,XAX              POINTER TO GOTTEN CORE        Y02669 59580002
         MVC   ZERO(D46,R1),HCPYMSG     MOVE MSG INTO DYNAM CORE Y02669 59670002
         MVC   D12(D3,R1),UCBNAME  MOVE IN MASTER'S UNITNAME     Y02669 59760002
         MVC   D15(D5,R1),BLANKS   PAD WITH BLANKS               Y02669 59850002
         DROP  R8                                                Y02669 59940002
         USING CUCB,R12                                          Y02669 60030002
READY    EQU   *                                                 Y02669 60120002
         SR    R0,R0               READY CUMID REG FOR WTO       Y02669 60210002
         TM    XAU,RIID            WAS IT A READER COMMAND       Y02669 60300002
         BO    WRITEMSG            YES, R0 IS ALL PRESET         Y02669 60390002
         IC    R0,XAU              PRESET CONSOLE ID             Y02669 60480002
WRITEMSG EQU   *                                                 Y02669 60570002
         SPACE 2                                               @G51APSS 60610051
**************************************************               Y02651 60750002
*                                                                Y02651 60840002
*  LOCKS MUST BE RELEASED AT THIS POINT. A WTO MACRO             Y02651 60930002
*  MUST BE ISSUED.                                               Y02651 61020002
*  LOCKS WERE OBTAINED EARLIER AT:                               Y02651 61110002
*        CSETLOCK                                                Y02651 61200002
*                                                                Y02651 61290002
         BAL   R8,UNSETLOK                                       Y02651 61380002
*                                                                Y02651 61470002
**************************************************               Y02651 61560002
         SPACE 2                                               @G51APSS 61600051
         WTO   MF=(E,(1))          ISSUE MESSAGE                 Y02669 61740002
         SPACE 2                                               @G51APSS 61780051
**************************************************               Y02651 61920002
*                                                                Y02651 62010002
*  WTO MACRO HAS BEEN ISSUED. NEW LOCKS MUST BE OBTAINED         Y02651 62100002
*  TO PROTECT AGAINST COMM. TASK                                 Y02651 62190002
*  THEY WILL BE RELEASED AT:                                     Y02651 62280002
*      UNSETLOK                                                  Y02651 62370002
*                                                                Y02651 62460002
         BAL   R8,CSETLOCK                                       Y02651 62550002
*                                                                Y02651 62640002
**************************************************               Y02651 62730002
         SPACE 2                                               @G51APSS 62770051
         B     MANDRT              CONTINUE CONSOLE PROCESSING   Y02669 62910002
         DROP  R13                                               Y02669 63000002
         USING UCMLIST,R5                                        Y02669 63090002
         SPACE 5                                               @G51APSS 63130051
MANDRT02 EQU   *                                                 Y02669 63450002
         L    R8,UCMUCB            GET UCB ADDRESS OF CONSOLE    Y02669 63540002
         B     PUTMSG                                            Y02669 63630002
*                                                                Y02669 63720002
*                                                                Y02669 63810002
*                                                                Y02669 63900002
MANDRT   EQU   *                                                  21002 63990002
         TM    UCMSDS1,UCMSDS1A+UCMSDS1B STCMDS OR INCMDS         21002 64080002
         BNZ   MANDRT1             YES, DON'T CHANGE AUTHORITY    21002 64170002
CRTCODE  EQU   *                                                  19084 64260002
         OI    UCMSFLGS,UCMSYSC         CMDS TO HCPY              21002 64350002
MANDRT1  EQU   *                                                  21002 64440002
         OC    UCMHRDRT(TWO),CHARTRT    MANDATORY ROUT CDS        19084 64530002
         B     CSTATUS             GO TO CHANGE STATUS TO CONSOLE 19084 64620002
*                                                                 19084 64710002
         EJECT                                                          64800002
CATTRIB  EQU   *                                                  19084 64890002
         TM    UCMDISP,UCMDISPA    MSTR CONSOLE                   19084 64980002
         BNO   NO                      NO                         M0739 65070002
         TM    XADUSWIT,XAIOCOMP       IS MASTER A COMPOSITE?  @Z30LPTJ 65160003
         BNO   CROUT                   NO                         M0739 65250002
         OI    XASWITCH,XACOMPMS     YES,TURN ON MAST COMP BIT @Z30LPTJ 65340003
         B    CROUT                    DO NOT CHANGE CMD AUTH     M0739 65430002
NO       TM    XADUSWIT,XAOUNIT           OUTPUT ONLY          @Z30LPTJ 65520003
         BO    CROUT               YES, DO NOT CHANGE CMD AUTH    19084 65610002
         TM    XADUSWIT,XAIPAREN        O-UNIT OF COMP?        @Z30LPTJ 65700003
         BO    CROUT                    YES,OMIT CMD AUTH CHANGES 19084 65790002
         TM    XASOPCOD,XACMD      ARE CMD AUTHS TO BE CHANGED @Z30LPTJ 66060003
         BZ    CROUT               NO, GO CHECK IF ROUT TO BE CHAN19084 66150002
         MVC   UCMAUTH(TWO),XACMDATH PUT NEW CMD AUTH INTO UCME@Z30LPTJ 66240003
*                                                                 19084 66330002
CROUT    EQU   *                                                  19084 66420002
         TM    XASWITCH,XAROUT     IS ROUTS TO BE CHANGED?     @Z30LPTJ 66510003
         BZ    CALT                NO, SEE IF ALT MUST BE CHANGED 19084 66600002
         TM    XADUSWIT,XAIOCOMP   I-UNIT OF COMP?             @Z30LPTJ 66690003
         BO    CALT                YWA,OMIT ROUT CHANGES          19084 66780002
CMOVERT  MVC   UCMRTCD(TWO),XARTCODE   YES, MOVE RTS INTO UCME @Z30LPTJ 66870003
         TM    UCMDISP,UCMDISPA        MSTR CONSOLE               M0739 66960002
         BO    TURNONE                 YES, BRANCH                M0739 67050002
         TM    XASWITCH,XACOMPMS       COMPOSITE MASTER IF SO, @Z30LPTJ 67140003
         BNO   CALT                    UCME IS OF OUTPUT DEVICE   M0739 67230002
*                                      AND MASTER BIT IS ON ONLY  M0739 67320002
*                                      FOR INPUT DEVICE           M0739 67410002
TURNONE  OI    UCMRTCD,MC              TURN ON ROUT CODE 1        M0739 67500002
         NI    XASWITCH,FOX-XACOMPMS   ENSURE BIT IS TURNED OFF@Z30LPTJ 67590003
CALT     EQU   *                                                  19084 67680002
         TM    XASWITCH,XALTCHG    IS ALTERNATE TO BE CHANGED  @Z30LPTJ 67770003
         BZ    CRETURN             NO, GO MAKE FINAL CHECKS       19084 67860002
         TM    XASOPCOD,XALTCOM    IS ALT AN O-UNIT            @Z30LPTJ 67950003
         BZ    CALTCOMP            NO,MAYBE A COMP                19084 68040002
         BAL   R6,CID              GET UCME OF ALTERNATE          19084 68130002
CCOMPALT XC    UCMOAOEN(FOR),UCMOAOEN   ZERO OUT ALTS-COMPOS PTR  19084 68220002
         B     CRETURN             GO, MAKE FINAL CHECKS          19084 68310002
*                                                                 19084 68400002
CALTCOMP EQU   *                                                  19084 68490002
         TM    XASOPCOD,XALTCON    IS ALTERNATE A COMPOSITE    @Z30LPTJ 68580003
         BZ    CALTREG             NO, IO CONSOLE                 19084 68670002
         BAL   R6,CID              GO GET ALTERNATES UCME         19084 68760002
         DROP  R5                                                 19084 68850002
         USING UCMLIST,R15                                        19084 68940002
         L     R15,UCMCOMPC        GET PTR TO COMPOS OF ALTERNATE 19084 69030002
         DROP  R15                                                19084 69120002
         USING UCMLIST,R5                                         19084 69210002
         ST    R15,UCMOAOEN        STORE  IT IN NEW CONSL UCME    19084 69300002
*                                                                 19084 69390002
CRETURN  EQU   *                                                  19084 69480002
         TM    XADUSWIT,XAIOCOMP   PROCESSIN I-XXX?            @Z30LPTJ 69570003
         BZ    CNOIUNT             NO                             19084 69660002
PARTTWO  EQU   *                       *                          21051 69750002
         LA    R9,SIX(R9)          INDEX TO OUTPUT UNITNAME       19084 69840002
         NI    XADUSWIT,FOX-XAIOCOMP TURN OFF COMPOSITE SWITCH @Z30LPTJ 69930003
         OI    XADUSWIT,XAIPAREN   TURN ON OUT-OF-COMP- SWITCH @Z30LPTJ 70020003
         L     R5,UCMCOMPC         GET OUTPUT UCME PTR            19084 70110002
         B     CLOOP               GO PROCESS IT                  19084 70200002
*                                                                 19084 70290002
CALTREG  EQU   *                                                  19084 70380002
         BAL   R6,CID              GO GET ALTERNATES UCME         19084 70470002
         B     CCOMPALT            GO FIX PTRS                    19084 70560002
*                                                                 19084 70650002
*                                                                 19084 70740002
CNOIUNT  EQU   *                                                  19084 70830002
         TM    XADUSWIT,XAIPAREN   PROCESSIN OUT-OF-COMPOS?    @Z30LPTJ 70920003
         BZ    CENDCK              NO, GO CHECK EOB               19084 71010002
         LA    R9,ONE(R9)          YES, ADD 1 FOR INTERNAL PARENS 19084 71100002
         B     CENDCK              GO CHECK EOB                   19084 71190002
*        GET ALTERNATE UCME ROUTINE                               19084 71280002
*                                                                 19084 71370002
CID      EQU   *                                                  19084 71460002
         SR    R15,R15                                            19084 71550002
         LR    R7,R14              SAVE RET ADDRESS               19084 71640002
         IC    R15,XALTPTR         GETCONS ID OF ALTERNATE        19084 71730002
         BCTR  R15,ZERO            MINUS 1                        19084 71820002
         L     R14,UCMVEZ          GET SIZE OF UCMES              19084 71910002
         MR    R14,R14             TIMES ID                       19084 72000002
         A     R15,UCMVEA          PLUS ADDR OF FIRST UCME        19084 72090002
         ST    R15,UCMALTEN        EQUALS ADDR OF ALT UCME        19084 72180002
         LR    R14,R7              RESTORE RET ADDRESS            19084 72270002
         BR    R6                  RETURN                         19084 72360002
         EJECT                                                    19084 72450002
*        ISSUE HEADER FOR CONSOLES MSG                            19084 72540002
CMSGRDY  EQU   *                                                  19084 72630002
         SPACE 5                                                        72720003
**************************************************               Y02651 72810002
*                                                                Y02651 72900002
*  WE ARE FINISHED PROCESSING THE COMMAND AND WTO MACROS         Y02651 72990002
*  WILL NOW BE ISSUED.  THE LOCKS OBTAINED AT:                   Y02651 73080002
*        CSETLOCK                                                Y02651 73170002
*  WILL NOW BE RELEASED AT:                                      Y02651 73260002
*        UNSETLOK                                                Y02651 73350002
*                                                                Y02651 73440002
         BAL   R8,UNSETLOK                                       Y02651 73530002
*                                                                Y02651 73620002
**************************************************               Y02651 73710002
         SPACE 2                                               @G51APSS 73750051
         L     R4,XAR              OBTAIN THE PROCESS SIWTCHES @ZM34520 73809003
         LTR   R4,R4               ARE THERE ANY BITS LEFT?    @ZM34520 73818003
         BNZ   DISPLAY             YES, PROCEED TO DISPLAY     @ZM34520 73827003
CLEANUP  EQU   *                                               @G51APSS 73831051
         BAL   R8,CDEQUE           NO, PREPARE FOR EXIT        @ZM34520 73836003
         L     R1,XAX              OBTAIN GOTTEN CORE ADDRESS  @ZM34520 73845003
         FREEMAIN R,LV=96,A=(1),SP=229                         @ZM34520 73854003
         L     R13,XAK             GET SAVE AREA ADDRESS       @ZM34520 73863003
         B     RETURN              BRANCH TO SET UP RETURN     @ZM34520 73872003
DISPLAY  EQU   *                                               @ZM34520 73881003
         L     R4,XAX                  ADDRESS OF GOTTEN CORE     21002 73890002
         LR    R1,R4                   SAVE ADDRESS               21002 73980002
         LA    R6,CHEADR                                          19084 74070002
         MVC   ZERO(LCHEADR,R1),ZERO(R6)  MOVE MSG TO BUFFER      21002 74160002
         CLI   XAX+FOR,GRPX            ARE ANY CONSOLES GRAPHICS  21002 74250002
         BE    CONSOLE                 YES, MSG CONTAINS AREA LABE21002 74340002
         USING MSGDSECT,R1                                        21002 74430002
         MVC   AREA(SIX),ROUTCD        REMOVE AREA FIELD          21002 74520002
         MVI   LABEL+ONE,NEWLEN        CHANGE LEN OF LABEL LINE   21002 74610002
         DROP  R1                                                 21002 74700002
CONSOLE  EQU   *                                                  21002 74790002
         SR    R0,R0                                              19084 74880002
         TM    XAU,RIID                 GET CONSOLE ID FOR WTO    19084 74970002
         BO    CHEADER                                            19084 75060002
         IC    R0,XAU                                             19084 75150002
*                                                                 19084 75240002
CHEADER  EQU   *                                                  19084 75330002
         STC   R0,XAU                                             19084 75420002
         WTO   MF=(E,(1))          ISSUE MSG                      19084 75510002
*                                                                 19084 75600002
         SPACE 10                                                 19084 75690002
EXIT     EQU   *                                                  19084 75780002
         L     R13,XAK           RESTORE REG13 TO PT TO SVAREA @Z30LPTJ 75870003
         ST    R4,D16(R13)        STORE MSG ADDR                 Y02669 75960002
         LM    R2,R15,EIT(R13)                                   Y02669 76050002
         LR    R6,R1                GET MLWTO ID FOR IEE7303D     21002 76140002
         SLL   R6,SHIFT8               PUT MLWTO INTO HI ORDER BYT21002 76230002
         IC    R6,XAX+FOR              INSERT GRAPHICS INDICATOR  21002 76320002
         ST    R6,XAP              STORE IT INTO THE XAP OF XSA  Y02669 76410002
         LR    R1,R4                   POINTER TO MSG AREA        21002 76500002
         NI    XADUSWIT,ZERO+XAXPAREN+XAUDVC TURN OFF ALL BUT IO & XPAR*76590003
                                                               @Z30LPTJ 76630003
         MVI   XARESV,MASK00      SET UP 48/7303D SWITCHES     @Z30LPTJ 76700003
*                                 TO 0 SINCE THIS WILL BE THE    Y02669 76770002
*                                 FIRST ENTRY TO 4803D           Y02669 76860002
*                                                                 19084 76950002
*        XAU HAS CONSOLE ID OF CONSOLE,RDR OF SYSTEM              19084 77040002
*        XAR HAS PROCESS SWITCHES                                 19084 77130002
*        XAL HAS PTR TO UNIT FIELD                                19084 77220002
*        XAP HAS MLWTO ID AND GFX INDICATOR                      Y02669 77310002
*                                                                 19084 77400002
         MVC   XAX(EIT),CONSMSG         4803D NAME                19084 77490002
         L     R15,VCON48          GET ADDRESS OF IEE4803D       Y02669 77580002
         BR    R15                 GO TO IT                      Y02669 77670002
         EJECT                                                          77760002
*                                                                Y02669 77850002
*                                                                Y02669 77940002
GETFAIL  EQU   *                                                  21002 78030002
         BAL   R8,CDEQUE           DEQUEUE THE HELD RESOURCES  @ZM34520 78040003
         MVI   XAE,GETERRCD        GETMAIN FAIL MESSAGE CODE   @ZM34520 78240003
         BAL   R8,MSGMOD           ISSUE THE ERROR MESSAGE     @ZM34520 78440003
RETURN   EQU   *                                               @ZM34520 78640003
         L     R13,XAK          RESTORE SAVE AREA PTR INTO R13 @Z30LPTJ 79200003
         L     R1,D64(R13)         GET CSCB ADDRESS              Y02669 80100002
         USING CHAIN1,R1                                         Y02669 80190002
         OI    CHSTS,CHFC          SET FREE CSCB FLAG            Y02669 80280002
         MGCR  (1),CHAIN                                         Y02669 80370002
         LM    R0,R15,ZERO(R13)                                  Y02669 80460002
         LR    R4,R14              SAVE RETURN ADDRESS           Y02669 80550002
         L     R0,XAWORKA          LOAD LV PARAM               @ZA13369 80640051
         LR    R1,R2                                             Y02669 80730002
         FREEMAIN  R,LV=(0),A=(1)  FREE DUMMY XSA                Y02669 80820002
         LR    R14,R4              RESTORE RETURN ADDRESS        Y02669 80910002
         BR    R14                 RETURN                        Y02669 81000002
         EJECT                                                          81090002
**************************************************               Y02651 81900002
*                                                                Y02651 81990002
*  THE OBTAIN LOCKS SUBROUTINE FOLLOWS:                          Y02651 82080002
*  THESE LOCKS ARE RELEASED AT: UNSETLOK                         Y02651 82170002
         DS    0H                                                       82210002
CSETLOCK EQU   *                                                 Y02651 82260002
         L     R15,XAK            SAVE AREA POINTER            @Z30LPTJ 82350003
         STM   R11,R14,D68(R15)                                  Y02651 82440002
         SETLOCK OBTAIN,TYPE=LOCAL,MODE=UNCOND,                  Y02651*82530002
               RELATED=(IEE4903D(UNSETLOK))                      Y02651 82620002
         SETLOCK OBTAIN,TYPE=CMS,MODE=UNCOND,                    Y02651*82710002
               RELATED=(IEE4903D(UNSETLOK))                      Y02651 82800002
         LM    R11,R14,D68(R15)                                  Y02651 82890002
         BR    R8                                                Y02651 82980002
**************************************************               Y02651 83070002
         EJECT                                                          83160002
**************************************************               Y02651 83250002
*                                                                Y02651 83340002
*  THE RELEASE LOCKS SUBROUTINE FOLLOWS.                         Y02651 83430002
*  THESE LOCKS ARE OBTAINED AT: CSETLOCK                         Y02651 83520002
*                                                                Y02651 83610002
UNSETLOK EQU   *                                                 Y02651 83700002
         L     R15,XAK            SAVE AREA POINTER            @Z30LPTJ 83790003
         STM   R11,R14,D68(R15)                                  Y02651 83880002
         SETLOCK  RELEASE,TYPE=CMS,RELATED=(IEE4903D(CSETLOCK))  Y02651 83970002
         SETLOCK  RELEASE,TYPE=LOCAL,RELATED=(IEE4903D(CSETLOCK)) 02651 84060002
*                                                                Y02651 84150002
         LM    R11,R14,D68(R15)                                  Y02651 84240002
         BR    R8                                                Y02651 84330002
**************************************************               Y02651 84420002
         EJECT                                                          84510002
**************************************************             @ZM34520 84515003
*                                                              @ZM34520 84520003
*  THIS A TERMINAL EXIT FROM THIS MODULE.                      @ZM34520 84525003
*  THE ENQ ISSUED IN MODULE IEE3603D MUST BE DEQUEUED OFF.     @ZM34520 84530003
*                                                              @ZM34520 84535003
CDEQUE   EQU   *                                               @ZM34520 84540003
         USING IEE36DEQ,R1                                     @ZA12404 84540651
         L     R1,XAWORKB          REG1, PARM LIST POINTER     @ZA12404 84541251
         DEQ   MF=(E,(R1))         FREE RESOURCES              @ZA12404 84541851
         DROP  R1                                              @ZA12404 84544251
         BR    R8                 RETURN TO CALLER             @ZM34520 84550003
**************************************************             @ZM34520 84555003
         EJECT                                                          84560003
**************************************************             @ZM34520 84565003
MSGMOD   EQU   *                                               @ZM34520 84572003
         L     R13,XAK            RESTORE SAVE AREA POINTER    @ZM34520 84579003
MSGMODA  EQU   *                                               @ZM34520 84586003
         STM   R0,R15,ZERO(R13)                                @ZM34520 84593003
         MVC   XAX(EIT),ERRORMOD  SET IGC2103D NAME            @ZM34520 84600003
         LOAD  EP=IEE2103D                                     @ZM34520 84607003
         LR    R15,R0             STORE ROUTINE'S ADDRESS      @ZM34520 84614003
         BALR  R14,R15            GO TO 2103D TO PUT MESSAGE   @ZM34520 84621003
         LM    R0,R15,ZERO(R13)                                @ZM34520 84628003
         DELETE  EP=IEE2103D                                   @ZM34520 84635003
         BR    R8                 RETURN TO CALLER             @ZM34520 84642003
**************************************************             @ZM34520 84649003
         EJECT                                                          84660003
*********************************************************************** 84670003
*                                                                 19084 84690002
*        DECLARES                                                 19084 84780002
*                                                                 19084 84870002
*********************************************************************** 84960002
MASKBIT  DC    X'80000000'         MASK TO TURN OFF BAD BIT    @ZM34520 85000003
FOUR     DC    H'4'                                               19084 85050002
COUNIT   DC    C'O-'               O-XXX                          19084 85140002
CIUNIT   DC    C'(I-'              COMPOSITE                      19084 85230002
CHARTRT  DC    X'F340'             HARDCPY MANDATORY ROUT CODES   19084 85320002
SYSLOGUT DC    C'SYSLOG  '                                       Y02669 85410002
BLANKS   DC    CL5'     '                                        Y02669 85500002
VARYID   DC    C'VARY    '                                     @ZM34520 85540003
         SPACE 2                                               @G51APSS 85560051
         DS    0F                                                Y02669 85680002
VCON48   DC    V(IEE4803D)                                       Y02669 85770002
CONSMSG  DC    C'IEE4803D'                                       Y02669 85860002
ERRORMOD DC    C'IEE2103D'             ERROR MODULE.             Y02669 85950002
         SPACE 2                                               @G51APSS 86040051
GETLIST  GETMAIN EC,LV=MSGLEN,A=0,SP=229,MF=L                    Y02669 86310002
GETLNTH  EQU   *-GETLIST               LENGTH OF LIST FORM.       21002 86400002
         EJECT                                                          86490002
*********************************************************************** 86670002
*                                                                 19084 86760002
*        MESSAGE LIST FORMS                                    @G51APSS 86800051
*                                                                 19084 86940002
*********************************************************************** 87030002
         SPACE 1                                               @G51APSS 87070051
CHEADR   WTO   ('IEE349I CONSOLES',C),('CONSOLE/ALT     COND   AUTH   I*87120002
               D  AREA    ROUTCD',L),MF=L,DESC=(5),MCSFLAG=(REG0,RESP)  87210002
CEND     EQU   *                       END OF WTO                 21002 87300002
LCHEADR  EQU   CEND-CHEADR             LENGTH OF WTO              21002 87390002
         SPACE 2                                               @G51APSS 87430051
NOCPYMSG WTO   'IEE709I HARDCOPY REQUIRED-NO HARDCOPY DEVICE AVAILABLE'*87570002
               ,MF=L,DESC=(5),MCSFLAG=(REG0,RESP)                Y02669 87660002
         SPACE 2                                               @G51APSS 87700051
HCPYMSG  WTO   'IEE710I         NOW RECEIVING HARDCOPY',MF=L,DESC=(5), *87840002
               MCSFLAG=(REG0,RESP)                               Y02669 87930002
         SPACE 2                                               @G51APSS 87940051
NCCMSG   WTO   ('IEE744I VARY CONSOLE REJECTED - NO FULL CAPABILITY CONX87950051
               SOLES',D),                                              X87960051
               ('     TO RESTORE MASTER CONSOLE:',D),                  X87970051
               ('     1) PRESS ENTER, REQUEST, OR END ON ANY AVAILABLE X87975051
               CONSOLE',D),                                            X87986051
               ('     2) PRESS THE EXTERNAL INTERRUPT KEY',DE),        X88000051
               MF=L,DESC=(5),MCSFLAG=(REG0,RESP)               @G51APSS 88010051
         SPACE 5                                                        88110002
         DS    0F                                              @G51APSS 88140051
PATCH    DC    4CL25'**IEE4903D PATCH AREA **'                 @G51APSS 88170051
         SPACE 5                                                        88290002
MSGDSECT DSECT                                                    21002 88380002
CONTROL  DS    7F                                                 21002 88470002
LABEL    DS    38C                     UP TO AREA FIELD           21002 88560002
AREA     DS    7C                      WHERE ROUTCD SHOULD GO     21002 88650002
END      DS    1C                      END IF NO AREA FIELD       21002 88740002
ROUTCD   DS    6C                      ROUTCD FIELD               21002 88830002
NEWLEN   EQU   END-LABEL          LEN OF LINE IF NO AREA FIELD    21002 88920002
*                                                                 19084 89010002
         EJECT                                                          89014051
* * * * * * * * * * * * * * * * * * * * * * * * * * * * * * *  @ZA12404 89018051
*                                                           *  @ZA12404 89022051
* DSECT TO REFERENCE GETMAIN'D WORK AREA FOR DEQ.  Q4 AND   *  @ZA12404 89026051
* VARYDEV ARE ENQ'D IN IEE3603D AND DEQ'D IN THIS AND       *  @ZA12404 89030051
* OTHER MODULES.                                            *  @ZA12404 89034051
* SEE 'SERIALIZATION' IN MODULE DESCRIPTION FOR IEE3603D.   *  @ZA12404 89038051
*                                                           *  @ZA12404 89046051
* * * * * * * * * * * * * * * * * * * * * * * * * * * * * * *  @ZA12404 89050051
         SPACE 1                                               @ZA12404 89054051
IEE36DEQ DSECT                                                 @ZA12404 89058051
DEQPARM  DEQ   (,,TWO,SYSTEM,,,SVN,SYSTEM),RET=HAVE,MF=L       @ZA12404 89070051
DEQLNTH  EQU   *-DEQPARM           LENGTH OF PARM LIST         @ZA12404 89074051
         DS    0D                  ROUND TO DOUBLE WORD        @ZA12404 89078051
*GETLNTH EQU   *-IEE36DEQ          LENGTH OF GETMAIN'D AREA    @ZA12404 89082051
         EJECT                                                          89100002
CXSA     DSECT                                                          89190002
         IEEXSA                                                         89280002
         EJECT                                                          95580002
CCVT     DSECT                                                          95670002
         CVT                                                            95760002
         EJECT                                                          95850002
         IEEBASEA                                                       95940002
         EJECT                                                          96030002
CUCM     DSECT                                                          96120002
         IEECUCM  FORMAT=NEW                                            96210002
         EJECT                                                          96300002
CUCB     DSECT                                                          96390002
         IEFUCBOB                                                       96480002
         EJECT                                                          96570002
CHAIN1   DSECT                                                          96660002
         IEECHAIN                                                       96750002
         EJECT                                                          96840002
         IHAPSA                                                         96930002
         END                                                            97020002
./  ADD  SSI=63560046,NAME=IEE5103D
         TITLE 'IEE5103D - STAE EXIT PROCESSOR'                         00050002
*********************************************************************** 00100020
* MODULE NAME   = IEE5103D                                            * 00200002
*                                                                     * 00250002
* DESCRIPTION   = STAE EXIT ROUTINE                                   * 00300002
*                                                                     * 00400002
* COPY RIGHT    = N/A                                                 * 00450002
*                                                                     * 00500002
* STATUS        = OS-VS/2-RELEASE 3.7 PTF UZ07650              @ZA15790 00510003
*                                                                     * 00550002
* FUNCTION      = THIS ROUTINE PROVIDES A COMPLETE STORAGE DUMP       * 00600002
*                 WHEN REQUIRED AND INFORMS THE OPERATOR              * 00602002
*                 OF THE ABEND OCCURRED AND THE RESULTS OF THE DUMP.  * 00604002
*                 THEN IT VALIDITY CHECKS THE CSCB ADDRESSES IN THE   * 00610002
*                 CSCB CHAIN, AND THE CIB ADDRESSES IN THE CIB CHAIN. * 00620002
*                 IF AN ERROR IS FOUND, THE CHAIN IS TRUNCATED        * 00630002
*                 AND THE SYSTEM OPERATOR INFORMED.                   * 00640002
*                                                                     * 00700002
* OPERATION     = ONCE ADDRESSABILITY HAS BEEN ESTABLISHED AND A      * 00750002
*                 FULL DIAGNOSTIC DUMP (UNDER CERTAIN CONDITIONS) HAS * 00760002
*                 BEEN TAKEN VIA MEANS OF SDUMP MACRO, THE OPERATOR/  * 00770002
*                 USER IS INFORMED OF THE ABEND AND DUMP STATUS.      * 00772002
*                 CHAINS ARE THEN SCANNED FOR VALIDITY.               * 00780002
*                 THE FIRST CSCB ELEMENT IS FOUND AND CHECKED         * 00790002
*                 TO INSURE THAT IT LIES WITHIN THE BOUNDS OF         * 00792002
*                 SQA, AND ON A DOUBLE WORD BOUNDRY.  IF THE          * 00794002
*                 CSCB ADDRESS IS VALID, THE CIB CHAIN OF THE         * 00796002
*                 CSCB JUST PROCESSED IS SCANNED FOR VALIDITY         * 00796402
*                 (THE SAME TESTS AS THE CSCB).  THIS PROCESS         * 00798002
*                 CONTINUES UNTIL ALL CSCB'S AND CIB'S HAVE           * 00798402
*                 BEEN VALIDITY CHECKED.                              * 00798802
*                 IF AN ERROR IS FOUND, THE PROPER CHAIN              * 00812102
*                 IS TRUNCATED AND THE OPERATOR IS INFORMED.          * 00822102
*                                                                     * 00824602
* NOTES:                                                              * 00824802
*  CHARACTER-                                                         * 00834802
*   CODE        = THIS MODULE MAY BE ASSEMBLED WITH ANY CODE SET      * 00836802
*  DEPENDENCIES = NONE                                                * 00837202
*  RESTRICTIONS = NONE                                                * 00837302
*  REGISTER-                                                          * 00841502
*   CONVENTIONS = NONE                                                * 00843502
*  PATCH LABEL  = PATCH                                               * 00845502
*                                                                     * 00845602
* MODULE TYPE:                                                        * 00845702
*  PROCESSOR    = ASSEMBLER                                           * 00859202
*  MODULE SIZE  = X'492'                                       @ZA15790 00864203
*  ATTRIBUTES   = REENTRANT, REUSEABLE, READ-ONLY, KEY-ZERO, PAGED LPA* 00871202
*                                                                     * 00871602
* ENTRY POINT   = IEE5103D                                            * 00872002
*  PURPOSE      = SVC 34 STAE EXIT ROUTINE                            * 00872402
*  LINKAGE      = SYNCH                                               * 00872802
*  INPUT        = WHEN REGISTER 0 IS EQUAL TO 'C'                     * 00872902
*                       (INDICATES INFORMATION IS IN REGISTERS)       * 00883802
*                      REGISTER 1 - ABEND CODE                        * 00887402
*                      REGISTER 2 - POINTER TO PARAMETER AREA         * 00888102
*                      REGISTER 14 - RETURN ADDRESS                   * 00888802
*                 WHEN REGISTER 0 IS NOT EQUAL TO 'C'                 * 00889502
*                       (INDICATES INFORMATION IS NOT IN REGISTERS)   * 00890202
*                      REGISTER 1 - POINTER TO SDWA                   * 00890902
*                      REGISTER 14 - RETURN ADDRESS                   * 00891602
*  INVOKER      = ABEND STAE INTERFACE ROUTINE                        * 00892802
* REGISTER USAGE:                                                     * 00894802
*  SAVED        = NONE                                                * 00898202
*  RESTORED     = NONE                                                * 00902202
* EXIT - NORMAL:  RETRY ADDRESS PASSED IN PARAMETER AREA              * 00906202
*  CONDITIONS   = ALL                                                 * 00910202
*  OUTPUT DATA  = DUMPS AND MESSAGES                                  * 00914202
* RETURN CODE   = EIGHT                                               * 00920402
* EXIT - ERROR:                                                       * 00926302
*  CONDITIONS   = NONE                                                * 00928302
*  OUTPUT DATA  = NONE                                                * 00930302
*  RETURN CODE  = NONE                                                * 00934202
* EXTERNAL:                                                           * 00938202
*  REFERENCES   = NONE                                                * 00948502
*  ROUTINES     = NONE                                                * 00958502
*  DATA AREAS   = INTERFACE WORK AREA                                 * 00958602
*  CONTROL BLOCK= ESTAE PARM AREA                               R,U   * 00958702
*                 COMMAND SCHEDULING CONTROL BLOCK (CSCB)       R     * 00962102
*                 STAE DIAGNOSTIC WORK AREA                     R,U   * 00964102
*                 MASTER SCHEDULER RESIDENT DATA AREA (BASEA)   R     * 00964502
*                 COMMUNICATION CONTROL TABLE (CVT)             R     * 00965302
*                 UNIT CONTROL MODULE (UCM)                     R     * 00965402
*                  KEY - R = REFERENCE                                * 00965502
*                        U = UPDATE                                   * 00967502
*                        G = GETMAIN                                  * 00969502
*                        F = FREEMIN                                  * 00969602
*  MACROS       = MODID    MODULE IDENTIFICATION                      * 00969902
*                 SDUMP    DIAGNOSTIC DUMP                            * 00971902
*                 ENQ      CSCB RESOURCE                              * 00973902
*                 DEQ      CSCB RESOURCE                              * 00974302
*                 SETRP    TO RETURN TO STAE                          * 00976302
*  TABLES       = NONE                                                * 00977902
*  ENQUEUED                                                           * 00979902
*   RESOURCES   = Q10 (CSCB)                                          * 00981902
*  LOCKS        = NONE                                                * 00983902
*  SYSGEN       = IN THE IEE0003D LOAD - NO ALIASES                   * 00985902
*  LIBRARIES    = NONE                                                * 00987902
*  CHANGE LEVEL = Y02653,ZA15790,ZA15793                       @ZA15790 00989003
* MESSAGES      = IEE480I CCCC COMMAND ABEND XXX, DUMPED, TERMINATED  * 01000002
*                 IEE480I SVC 34 ABEND XXX, DUMPED, TERMINATED        * 01010002
*                   CCCC = COMMAND NAME                               * 01050002
*                   XXX  = ABEND COMPLETION CODE                      * 01100002
*                   'DUMPED' WILL APPEAR ONLY IF A DUMP WAS TAKEN     * 01150002
*                 IEE513I COMMAND PROCESSING LIMITED                  * 01200002
*********************************************************************** 03600020
         EJECT                                                          03650020
*********************************************************************** 03750020
*        DSECTS                                                       * 03850002
*********************************************************************** 03950020
MRC      IEEBASEA                                                       05500020
         EJECT                                                          05550020
CVTSECT  DSECT                                                          06050020
         CVT                                                            06100020
         EJECT                                                          06150020
CSCB     DSECT                                                          06200002
         IEECHAIN                                                       06250020
         EJECT                                                          06300002
         IHASDWA                                                        06350002
         EJECT                                                          06400002
         IHAGDA                                                         06450002
         EJECT                                                          06500002
         IHASPQE                                                        06550002
         EJECT                                                          06600002
         IHADQE                                                         06650002
         EJECT                                                          06700002
IEE5103D CSECT                                                          07250020
* D STAE0010 APPROX 117000                                     @ZA15790 07258003
* C PATCH    APPROX 282747                                     @ZA15790 07266003
* A STAE0050 APPROX 146500                                     @ZA15793 07279003
* C DUMPPARM APPROX 282461                                     @ZA15793 07284003
* A EPARMS   APPROX 284718                                     @ZA15793 07289003
* C INSERT3  APPROX 281419                                     @ZA15793 07291003
* A MSGLEN3A APPROX 282891                                     @ZA15793 07293003
*********************************************************************** 07300002
*        REGISTER EQUATES                                             * 07400002
*********************************************************************** 07500002
R0       EQU   0             INPUT REGISTER WORK REGISTER        Y02653 07550002
R1       EQU   1             INPUT REGISTER WORK REGISTER        Y02653 07600002
R2       EQU   2             INPUT REGISTER PARAMETER AREA BASE  Y02653 07650002
R3       EQU   3             WORK REGISTER                       Y02653 07700002
R4       EQU   4             WORK REGISTER                       Y02653 07750002
R5       EQU   5             WORK REGISTER                       Y02653 07800002
R6       EQU   6             WORK REGISTER                       Y02653 07850002
R7       EQU   7             WORK REGISTER                       Y02653 07900002
R8       EQU   8             WORK REGISTER                       Y02653 07950002
R9       EQU   9             WORK REGISTER                       Y02653 07970003
R10      EQU   10            WORK REGISTER                       Y02653 08050002
R11      EQU   11            BASE OF STAE DIAGNOSTIC WORK AREA   Y02653 08100002
R12      EQU   12            PROGRAM BASE                        Y02653 08150002
R14      EQU   14            RETURN ADDRESS                      Y02653 08250002
R15      EQU   15            SAVE ADDRESS IN EACH SCAN           Y02653 08300002
*********************************************************************** 08350020
*        CHARACTER AND NUMERIC EQUATES                                * 08450020
*********************************************************************** 08550020
E0       EQU   0             CONSTANT 0F 0                       Y02653 09350002
E3       EQU   3             CONSTANT 0F 3                       Y02653 09410002
E4       EQU   4             CONSTANT 0F 4                       Y02653 09450002
E5       EQU   5             CONSTANT 0F 5                       Y02653 09452002
E8       EQU   8             CONSTANT 0F 8                       Y02653 09500002
E12      EQU   12            CONSTANT OF 12                      Y02653 09520002
E29      EQU   29            CONSTANT OF 29                      Y02653 09530002
E38      EQU   38            CONSTANT OF 38                      Y02653 09542002
ALLB     EQU   15            ICM ALL BYTES TO REGISTER           Y02653 09592002
TWOB     EQU   3             ICM LOW TWO BYTES TO REGISTER       Y02653 09642002
CIBDISP  EQU   CHCIBP-CHAIN  DISPLACEMENT TO CIB POINTER IN CSCB Y02653 09650002
BLNK     EQU   C' '          BLANK                               Y02653 10250002
COMA     EQU   C','          COMMA                               Y02653 10300002
X10      EQU   X'10'         MASK FOR DESCRIPTOR CODES           Y02653 10350002
         EJECT                                                          10500020
*********************************************************************** 10550002
*        BASE MODULE                                                  * 10650002
*********************************************************************** 10750002
         BALR  R12,R0        ESTABLISH PROGRAM ADDRESSABILITY    Y02653 10800002
         USING *,R12         SET THE BASE FOR IT                 Y02653 10850002
         MODID BRANCH=YES                                        Y01886 10900001
         EJECT                                                          10902002
*********************************************************************** 10910002
*        THE FOLLOWING CODE WILL DETERMINE THE TYPE ENTRY WAS SET UP  * 10920002
*        AS TO USE THE PROPER LINKAGE IN REENTERING THIS ROUTINE AS A * 10930002
*        RETRY ROUTINE AGAIN UNDER THE PROTECTION OF ESTAE.           * 10940002
*********************************************************************** 10942002
         C     R0,TWELVE     WAS WORK AREA PASSED?               Y02653 10950002
         BE    STAE0005      YES, REQUIRED INFO IS IN REGISTERS: Y02653*10970002
                            REGISTER 1 - ABEND CODE              Y02653*10990002
                            REGISTER 2 - PARAMETER AREA POINTER  Y02653 11010002
         LR    R11,R1        SET ESTAE PARMAREA ADDRESS          Y02653 11050002
         USING SDWA,R11      BASE FOR ABEND WORKAREA             Y02653 11100002
         USING EPARMS,R2     BASE FOR PARMAREA                   Y02653 11150002
         L     R2,SDWAPARM   ADDRESS OF PARMAREA                 Y02653 11200002
         L     R1,SDWAABCC   GET ABEND CODE                      Y02653 11250002
         ST    R2,SDWASR01   PASS PARM ADDRESS INTO ASIR         Y02653 11300002
         TM    SDWAERRC,SDWAPERC                                 Y02653*11460002
                             IS IT PERCOLATION?                  Y02653 11462002
         BO    STAE0010      YES, BYPASS DUMP INDICATOR          Y02653 11470002
         TM    SDWAERRA,SDWAMCHK                               @YM3502P*11477002
                             IS IT A MACHINE CHECK?            @YM3502P 11484002
         BO    STAE0010      YES, BYPASS DUMP INDICATOR        @YM3502P 11491002
STAE0005 EQU   *                                                 Y02653 11500002
         OI    PARMFLGS,PARMDUMP                                 Y02653*11550002
                             INDICATE DUMP REQUIRED              Y02653 11560002
         DROP  R11           RELEASE SDWA BASE                   Y02653 11600002
STAE0010 EQU   *                                                 Y02653 11650002
*        R14 USED TO BE SAVED IN PARMRETY WHICH CAUSED THE     @ZA15790 11660003
*        RETRY ADDR ESTABLISHED BY IEE0003D TO BE OVERLAID.    @ZA15790 11670003
*        CONTROL IS NOW RETURNED TO THE ADDR SPECIFIED IN      @ZA15790 11680003
*        PARMRETY INSTEAD OF THE ABEND STAE INTERFACE ROUTINE  @ZA15790 11690003
         ST    R1,PARMABND   STORE ABEND CODE IN AREA            Y02653 11750002
         ST    R12,PARMWORK  PASS BASE ADDRESS INTO ASIR         Y02653 11800002
         C     R0,TWELVE     WAS WORK AREA PASSED?               Y02653 11850002
         BE    STAE0015      YES, DO QUICK RETRY                 Y02653 11900002
         LR    R1,R11        SET SDWA ADDRESS FOR EXIT           Y02653 11950002
         SETRP RETADDR=STAE0020,RECORD=YES,RETREGS=YES,          Y02653*12000002
               RECPARM=LRECINF,RC=4,FRESDWA=YES,DUMP=NO        @YM3503P 12050002
         BR    R14           RETURN TO ASIR                      Y02653 12100002
STAE0015 EQU   *                                                 Y02653 12150002
         LA    R0,STAE0020   SET RETRY ADDRESS                   Y02653 12200002
         LA    R15,E4        INDICATE RETRY                      Y02653 12250002
         BR    R14           RETURN TO ASIR                      Y02653 12300002
         EJECT                                                          12302002
*********************************************************************** 12310002
*        THIS SECTION OF CODE IS THE ENTRY TO THE RETRY ROUTINE.      * 12312002
*        ITS FUNCTION IS TO RESET THE BASE ADDRESS AND TO FIND        * 12314002
*        AND HANDLE ABEND RECURSIONS BY PICKING UP THE PROCESS        * 12316002
*        CODE AND BRANCHING TO THE FUNCTION TO BE PERFORMED.          * 12318002
*********************************************************************** 12320002
STAE0020 EQU   *             ESTAE RETRY POINT                   Y02653 12350002
         LR    R2,R1         SET PARMAREA ADDRESS                Y02653 12400002
         L     R12,PARMWORK  SET BASE REGISTER                   Y02653 12450002
         LH    R4,PARMCODE   GET RECURSION CODE                  Y02653 12950002
         B     STAE0040(R4)  START STAE PROCESSING               Y02653 13400002
STAE0040 EQU   *                                                 Y02653 13450002
         B     STAE0050      DUMP SYSTEM                         Y02653 13500002
         B     STAE0070      INFORM OPERATOR                     Y02653 13550002
         B     STAE0120      INFORM TERMINAL USER                Y02653 13560002
         B     STAE0140      CLEAN UP CHAINS                     Y02653 13600002
         B     STAE0220      RETURN                              Y02653 13650002
         EJECT                                                          13750002
*********************************************************************** 13800002
*        THE FOLLOWING WILL BUMP THE PROCESS CODE AND THEN WILL       * 13900002
*        DETERMINE IF A DUMP IS NECESSARY.  IF ENTERED BECAUSE        * 13950002
*        OF A SYSTEM FAILURE, A PROGRAM CHECK, OR THE SYSTEM          * 14000002
*        RESTART KEY WAS DEPRESSED THEN A DUMP WILL BE TAKEN.         * 14050002
*********************************************************************** 14150002
STAE0050 EQU   *                                                 Y02653 14200002
         LA    R4,E4(R4)     BUMP PROCESS CODE                   Y02653 14250002
         STH   R4,PARMCODE   PUT IT IN PARAMETER AREA            Y02653 14300002
         TM    PARMFLGS,PARMDUMP                                 Y02653*14450002
                             DUMP REQUIRED?                      Y02653 14460002
         BNO   STAE0070      NO, BYPASS DUMP                     Y02653 14500002
         MVC   PARMMESG(DUMPL),DUMPPARM                          Y02653*14600002
                             MOVE IN LIST FORM OF DUMP           Y02653 14650002
         LA    R6,PARMMESG   SET UP ADDRESSABILITY TO          @ZA15793 14650703
         USING PARMDMP,R6    MESSAGE AREA                      @ZA15793 14651403
         LA    R10,PARMDTIT  ADDR OF DUMP TITLE                @ZA15793 14652103
         TM    PARMFLGS,PARMCOMD  WAS COMMAND ISSUED?          @ZA15793 14653003
         BNO   STAE0060      NO. LEAVE TITLE ALONE             @ZA15793 14655003
         MVC   PARMDVAR(MSGLEN3A),INSERT3  MOVE IN "COMMAND"   @ZA15793 14661003
         LH    R9,PARMLNCM   GET LENGTH OF COMMAND             @ZA15793 14663003
         BCTR  R9,0          DECREMENT FOR EXECUTE             @ZA15793 14665003
         LA    R6,PARMDCMD   ADDR OF WHERE CMD IS TO BE PLACED @ZA15793 14667003
         DROP  R6                                              @ZA15793 14680003
         EX    R9,COMMOVE    MOVE THE COMMAND TO TITLE         @ZA15793 14685003
STAE0060 EQU   *                                               @ZA15793 14690003
         LA    R1,PARMMESG   ADDRESS OF LIST FORM                Y02653 14700002
         SDUMP HDRAD=(R10),MF=(E,(1)) INVOKE DUMP              @ZA15793 14720003
         LR    R10,R15       SAVE RETURN CODE                    Y02653 14800002
         B     STAE0080      INFORM OPERATOR                     Y02653 14850002
STAE0070 EQU   *             RECURSIVE ABEND MESSAGE ENTRY       Y02653 14900002
         LA    R10,E4        INDICATE NO 'DUMPED,' MESSAGE       Y02653 14950002
         EJECT                                                          14952002
*********************************************************************** 14960002
*        THE FOLLOWING CODE WILL CONSTRUCT A MESSAGE TO INFORM        * 14962002
*        THE OPERATOR OF THE PROBLEM, THE STATUS OF THE DUMP,         * 14964002
*        AND THAT THE COMMAND IS BEING TERMINATED.                    * 14966002
*********************************************************************** 14970002
STAE0080 EQU   *             NORMAL MESSAGE ENTRY                Y02653 15000002
         LA    R4,E4(R4)     INDICATE MESSAGE ATTEMPTED          Y02653 15050002
         STH   R4,PARMCODE   PUT IT IN PARAMETER AREA            Y02653 15100002
         MVC   PARMMESG(MSGLEN5),ABMSG                           Y02653*15500002
                             MOVE IN BASE ABEND MESSAGE          Y02653 15502002
         LA    R5,PARMMESG   ADDRESS OF MESSAGE START            Y02653 15510002
         LR    R6,R5         ADDRESS OF MESSAGE START            Y02653 15520002
         AH    R6,MSGLEN     BUMP TO BUFFER STARTING POSITION    Y02653 15530002
         TM    PARMFLGS,PARMCOMD                                 Y02653*15532002
                             WAS A COMMAND ISSUED?               Y02653 15532402
         BNO   STAE0090      NO, THEN INDICATE SVC 34 FAILED     Y02653 15534002
         LH    R9,PARMLNCM   GET LENGTH OF COMMAND               Y02653 15540002
         BCTR  R9,R0         DECREMENT FOR EXECUTE               Y02653 15550002
         EX    R9,COMMOVE    MOVE THE COMMAND                    Y02653 15560002
         AH    R6,PARMLNCM   BUMP TO NEXT POSITION IN BUFFER     Y02653 15570002
         MVC   E0(MSGLEN3,R6),INSERT3                            Y02653*15570402
                             MOVE IN ABEND NAME                  Y02653 15570802
         LA    R6,MSGLEN3(R6)                                    Y02653*15571202
                             BUMP TO NEXT POSITION IN BUFFER     Y02653 15574602
         B     STAE0100      BYPASS SVC 34 FAILED PART           Y02653 15575702
STAE0090 EQU   *                                                 Y02653 15577102
         MVC   E0(MSGLEN2,R6),INSERT2                            Y02653*15578502
                             MOVE IN 'SVC 34 FAILED' MESSAGE     Y02563 15579902
         LA    R6,MSGLEN2(R6)                                    Y02653*15581302
                             BUMP TO NEXT POSITION IN BUFFER     Y02653 15581602
         EJECT                                                          15583202
*********************************************************************** 15585202
*        THE FOLLOWING WILL PUT THE ABEND CODE INTO THE               * 15585602
*        MESSAGE BEING BUILT.  THEN IT WILL ADD THE 'DUMPED' MESSAGE  * 15585702
*        PORTION TO THE MESSAGE, IF REQUIRED AND FINALLY IT           * 15585802
*        WILL ADD THE 'TERMINATED' MESSAGE PORTION AND ISSUE THE WTO. * 15596502
*********************************************************************** 15606502
STAE0100 EQU   *             ABEND CONVERSION CODE               Y02653 15607202
         USING PARMABN0,R6   SET BASE FOR ABEND CODE             Y02653 15617902
         L     R9,PARMABND   PICK UP ABEND CODE                  Y02653 15628602
         N     R9,MASK1      'AND' OFF DUMP BIT                  Y02653 15639302
         SRL   R9,E12        SHIFT TO LOW ORDER BYTES            Y02653 15650002
         STH   R9,PARMWORK   PUT IT IN WORKAREA                  Y02653 15700002
         UNPK  PARMABN1(E5),PARMWORK(E3)                         Y02653*15750002
                             UNPACK FOR TRANSLATE                Y02653 15800002
         TR    PARMABN2(E3),TABLE                                Y02653*15850002
                             TRANSLATE FOR MESSAGE OUTPUT        Y02653 15860002
         MVI   PARMABN1,BLNK BLANK FIRST PART                    Y02653 15900002
         MVI   PARMABN5,COMA ADD COMMA TO END                    Y02653 15950002
         LA    R6,E5(R6)     BUMP TO NEXT POSITION IN BUFFER     Y02653 15960002
         DROP  R6            RELEASE BASE                        Y02653 16000002
         LTR   R10,R10       DUMP SUCCESSFUL?                    Y02653 16200002
         BNZ   STAE0110      NO, BYPASS 'DUMPED,' PART           Y02653 16250002
         MVC   E0(MSGLEN0,R6),INSERT0                            Y02653*16300002
                             MOVE IN 'DUMPED,' MESSAGE           Y02653 16350002
         LA    R6,MSGLEN0(R6)                                    Y02653*16400002
                             BUMP TO NEXT POSITION IN BUFFER     Y02653 16410002
STAE0110 EQU   *                                                 Y02653 16450002
         MVC   E0(MSGLEN4,R6),INSERT4                            Y02653*16600002
                             MOVE IN 'TERMINATED' MESSAGE        Y02653 16650002
         LA    R6,MSGLEN4(R6)                                    Y02653*16700002
                             BUMP TO END OF BUFFER               Y02653 16710002
         MVC   E0(E4,R6),RETCDE5                                 Y02653*16750002
                             INSERT COMMAND STATUS ROUTING CODES Y02653 16760002
         TM    PARMFLGS,PARMCOMD                                 Y02653*16800002
                             IS IT COMMAND STATUS?               Y02653 16810002
         BO    STAE0111      YES, BRANCH                         Y02653 16850002
         MVC   E0(E4,R6),RETCDE4                                 Y02653*16930002
                             INSERT SYSTEM STATUS ROUTING CODES  Y02653 16930402
STAE0111 EQU   *                                                 Y02653 16932002
         SR    R6,R5         CALCULATE LENGTH OF MESSAGE         Y02653 16940002
         STH   R6,MSGLEN     PUT LENGTH IN MESSAGE               Y02653 16942002
         SR    R0,R0         CLEAR INSERTION REGISTER            Y02653 16942102
         ICM   R0,ALLB,PARMTYPE                                  Y02653*16942402
                             GET DESTINATION INFORMATION         Y02653 16942502
         BP    STAE0115      IF POSITIVE, CONTINUE CHECKING      Y02653 16942802
STAE0112 EQU   *             MESSAGE TO MASTER CONSOLE           Y02653 16942902
         SR    R0,R0         INDICATE MASTER CONSOLE             Y02653 16943202
         B     STAE0118      GO ISSUE WTO                        Y02653 16943602
STAE0115 EQU   *             EXAMINE FOR ASID OR CONSOLE ID      Y02653 16943702
         SR    R0,R0         ZERO INSERTION REGISTER             Y02653 16944002
         ICM   R0,TWOB,PARMTPUT                                  Y02653*16944902
                             PULL IN THE ID                      Y02653 16945002
         BM    STAE0112      TOP BIT ON THEN ASID/MASTER         Y02653 16945202
STAE0118 EQU   *                                                 Y02653 16945302
         LA    R1,PARMMESG   ADDRESS OF MESSAGE                  Y02653 16945502
         WTO   MF=(E,(1))    WRITE OUT MESSAGE                   Y02653 16946002
         EJECT                                                          16948002
*********************************************************************** 16948102
*        THE FOLLOWING SECTION OF CODE WILL DETERMINE IF THE          * 16948502
*        COMMAND WAS FROM A TERMINAL.  IF SO, IT WILL SEND THE        * 16948902
*        TERMINATION MESSAGE VIA TPUT TO THE TERMINAL THAT            * 16949002
*        ISSUED THE REQUEST.                                          * 16949102
*********************************************************************** 16949202
STAE0120 EQU   *                                                 Y02653 16949302
         LA    R4,E4(R4)     INDICATE TPUT ATTEMPTED             Y02653 16949502
         STH   R4,PARMCODE   PUT IT IN PARAMETER AREA            Y02653 16949902
         SR    R15,R15       CLEAR INSERTION REGISTER            Y02653 16954102
         ICM   R15,TWOB,PARMTPUT                                 Y02653*16955802
                             IS THERE AN ASID TO TPUT?           Y02653 16958002
         BNM   STAE0140      NO, BYPASS TPUT PROCESS             Y02653 16960202
         N     R15,MASK2     TURN OFF HIGH END BITS              Y02653 16962402
         LH    R5,MSGLEN     GET LENGTH OF WTO MESSAGE           Y02653 16964602
         LA    R6,E4         LENGTH OF UNWANTED INFORMATION      Y02653 16966802
         SR    R5,R6         SUBTRACT IT FROM WTO LENGTH         Y02653 16969002
         LA    R1,PARMPUTM   ADDRESS OF THE TPUT TEXT            Y02653 16971202
         TPUT  (1),(5),TJID=(15)                                 Y02653*16973402
                             TPUT THE MESSAGE                    Y02653 16975602
         EJECT                                                          16977802
*********************************************************************** 16980002
*        THE FOLLOWING WILL VERIFY THE VALIDITY OF THE CSCB'S TO      * 16982202
*        SEE IF IT IS WITHIN THE BOUNDS OF SQA AND ON A DOUBLE        * 16984402
*        WORD BOUNDRY.  IT WILL ALSO CHECK THE CIB'S OF EACH CSCB.    * 16986602
*********************************************************************** 16988802
STAE0140 EQU   *                                                 Y02653 16991002
         LA    R4,E4(R4)     INDICATE SCAN ATTEMPTED             Y02653 16993202
         STH   R4,PARMCODE   PUT IT IN PARAMETER AREA            Y02653 17003202
         SYSEVENT DONTSWAP   DON'T ALLOW SWAP UPDER ENQUEUE      Y02653 17013202
         MVC   PARMMESG(ENQLEN),LISTENQ                          Y02653*17016402
                             SET UP THE LIST FORM OF ENQUEUE     Y02653 17022102
         LA    R1,PARMMESG   SET ADDRESS OF ENQUEUE LIST         Y02653 17024902
         ENQ   MF=(E,(1))    ENQUEUE ON THE CSCB CHAIN           Y02653 17027702
STAE0145 EQU   *                                                 Y02653 17198302
         L     R6,CVTPTR     ADDRESS OF THE CVT                  Y02653 17199602
         USING CVTSECT,R6    BASE THE CVT                        Y02653 17200902
         L     R5,CVTMSER    RELOAD IEEBASEA POINTER             Y02653 17202202
         USING BASE,R5       BASE FOR IEEBASEA                   Y02653 17202602
         LR    R15,R5        GET ADDRESS OF BACHN                Y02653 17203502
         L     R1,BACHN      GET ADDRESS OF CSCB CHAIN           Y02653 17204802
         LR    R8,R1         SAVE CSCB ADDRESS                   Y02653 17206102
         SR    R4,R4         INSERT CSCB CODE OF 0 IN REGISTER 4 Y02653 17207402
         L     R6,CVTGDA     OBTAIN THE GDA ADDRESS              Y02653 17530002
         DROP  R6                                                Y02653 17532002
         USING GDA,R6        ESTABLISH GDA ADDRESSABILITY        Y02653 17540002
         L     R7,SQASPQEP   OBTAIN THE SPQE ADDRESS             Y02653 17550002
         USING SPQESECT,R7   ESTABLISH SPQE ADDRESSABILITY       Y02653 17560002
         DROP  R6                                                Y02653 17562002
         L     R9,SPDQEPTR   OBTAIN THE DQE ADDRESS              Y02653 17564002
STAE0148 EQU   *                                                 Y02653 17564802
         DROP  R5            RELEASE BASE REGISTER               Y02653 17565202
         USING DQESECT,R9    ESTABLISH DQE ADDRESSABILITY        Y02653 17566002
         LR    R5,R9         SAVE THE DQE ADDRESS                Y02653 17566402
         L     R6,DQEBLKAD   LOAD THE STARTING ADDRESS           Y02653 17568002
         LA    R6,E0(R6)     CLEAR THE HIGH ORDER BYTE           Y02653 17568402
         L     R7,DQELNTH    LOAD THE LENGTH OF THE AREA         Y02653 17568802
         AR    R7,R6         COMPUTE THE ENDING ADDRESS          Y02653 17569702
         EJECT                                                          17570002
*********************************************************************** 17600002
*        FIND THE CSCB ADDRESS AND SCAN THE CSCB CHAIN.               * 17700002
*        ALSO, SCAN THE CIB CHAIN OFF EACH CSCB.                      * 17750002
*********************************************************************** 17850002
STAE0150 EQU   *                                                 Y02653 18600002
         LA    R1,E0(R1)     CLEAR HIGH ORDER BYTE               Y02653 18650002
         LTR   R0,R1         IS THE ELEMENT LAST ON CHAIN?       Y02653 18700002
         BZ    STAE0180      YES, GO TO NEXT STEP                Y02653 18750002
STAE0155 EQU   *                                                 Y02653 18760002
         CR    R1,R6         IS THE ADDRESS BEFORE SQA?          Y02653 18800002
         BL    STAE0170      YES, BRANCH                         Y02653 18850002
         CR    R1,R7         IS THE ADDRESS AFTER SQA?           Y02653 18900002
         BNL   STAE0170      YES, BRANCH                         Y02653 18950002
         SLL   R0,E29        SHIFT OFF ALL BUT 3 LOW ORDER BITS  Y02653 19000002
         LTR   R0,R0         IS IT ON A DOUBLE WORD BOUNDARY?    Y02653 19050002
         BNZ   STAE0200      NO, BRANCH                          Y02653 19100002
         LTR   R4,R4         CSCB OR CIB?                        Y02653 19150002
         BZ    STAE0165      A CSCB, BRANCH                      Y02653 19200002
         LR    R15,R1        SAVE OLD CIB ADDRESS                Y02653 19350002
         L     R1,E0(R1)     GET ADDRESS OF NEXT CIB             Y02653 19400002
         B     STAE0148      CONTINUE SCANNING                   Y02653 19450002
STAE0165 EQU   *                                                 Y02653 19452002
         USING CHAIN,R1      BASE THE CSCB                     @YM6166P 19452302
         TM    CHSTS,CHAP    CSCB PROCESSING PENDING?          @YM6166P 19452602
         DROP  R1            TRLRSDR CSCB BASE                 @YM6166P 19452902
         BO    STAE0190      YES - NO CIB POINTER AVAILABLE    @YM6166P 19453202
         LA    R15,CIBDISP(R1)                                   Y02653*19454002
                             ADDRESS OF CIB POINTER              Y02653 19454402
         L     R1,E0(R15)    GET NEXT CIB ADDRESS                Y02653 19456002
         LA    R4,E8         INSERT CODE OF 8 FOR CSCBCIB        Y02653 19458002
         B     STAE0148      SCAN THE CHAIN                      Y02653 19458402
         EJECT                                                          19458802
*********************************************************************** 19459202
*        THE FOLLOWING WILL HANDLE THE MULTIPLE PQE'S OF              * 19459602
*        SQA AND WILL RESET BACK TO THE FIRST PQE PRIOR TO            * 19459702
*        GOING ON AND CHECKING THE NEXT CONTROL BLOCK.                * 19459802
*********************************************************************** 19459902
STAE0170 EQU   *                                                 Y02653 19460002
         DROP  R9                                                Y02653 19460402
         USING DQESECT,R5    ESTABLISH DQE ADDRESSABILITY        Y02653 19462002
         L     R5,DQEPTR     GET NEXT SQA SEGMENT DQE            Y02653 19470002
         LA    R5,E0(R5)     ZERO THE HIGH ORDER BYTE            Y02653 19480002
         LTR   R5,R5         ANY MORE SQA SEGMENTS?              Y02653 19490002
         BZ    STAE0200      NO MORE SQA SEGMENTS                Y02653 19492002
         L     R6,DQEBLKAD   GET THE START OF SQA SEGMENT        Y02653 19494002
         LA    R6,E0(R6)     ZERO THE HIGH ORDER BYTE            Y02653 19496002
         L     R7,DQELNTH    GET THE LENGTH OF SQA SEGMENT       Y02653 19498002
         AR    R7,R6         FIND THE NEW HIGH ADDRESS           Y02653 19498402
         B     STAE0155      RECHECK THE CURRENT CHAIN           Y02653 19498802
STAE0180 EQU   *                                                 Y02653 20350002
         LTR   R4,R4         ANY MORE CSCB'S TO PROCESS?         Y02653 20400002
         BZ    STAE0210      NO, END OF SCANNING                 Y02653 20500002
         SR    R4,R4         INDICATE CSCB CODE OF ZERO          Y02653 20700002
STAE0190 LR    R15,R8        SAVE THE CSCB ADDRESS             @YM6166P 20750002
         L     R8,E0(R15)    GET ADDRESS OF NEXT CSCB            Y02653 20800002
         LR    R1,R8         SAVE CSCB ADDRESS IN REGISTER 8     Y02653 20850002
         B     STAE0150      SCAN THE CHAIN                      Y02653 20900002
         EJECT                                                          20950002
*********************************************************************** 21000002
*        THIS CODE WILL TRUNCATE THE CSCB CHAIN AND INFORM            * 21050002
*        THE OPERATOR VIA MESSAGE IEE513I THAT THE CHAIN WAS          * 21100002
*        TRUNCATED.                                                   * 21150002
*********************************************************************** 21200002
STAE0200 EQU   *                                                 Y02653 22000002
         XC    E0(E4,R15),E0(R15)                                Y02653*22050002
                             TRUNCATE CHAIN                      Y02653 22060002
         OI    PARMFLGS,PARMCHOP                                 Y02653*22100002
                             INDICATE CHAIN WAS CHOPPED          Y02653 22110002
         LTR   R4,R4         CSCB OR CIB CHAIN?                  Y02653 22150002
         BZ    STAE0145      CONTINUE CIB ERROR CHECKING         Y02653 22350002
STAE0210 EQU   *                                                 Y02653 22750002
         MVC   PARMMESG(DEQLEN),LISTDEQ                          Y02653*22800002
                             SET UP THE LIST FORM OF ENQUEUE     Y02653 22850002
         LA    R1,PARMMESG   SET ADDRESS OF DEQUEUE LIST         Y02653 22900002
         DEQ   MF=(E,(1))    DEQUEUE OFF THE CSCB CHAIN          Y02653 22950002
         SYSEVENT OKSWAP     ALLOW SWAPPING AGAIN                Y02653 23000002
         TM    PARMFLGS,PARMCHOP                                 Y02653*23050002
                             IS MESSAGE REQUIRED?                Y02653 23060002
         BNO   STAE0220      BYPASS ERROR MESSAGE                Y02653 23100002
         MVC   PARMMESG(MSGLEN6),CSCBCHOP                        Y02653*23150002
                             MOVE MESSAGE TO BUFFER              Y02653 23200002
         SR    R0,R0         CLEAR INSERTION REGISTER            Y02653 23202002
         ICM   R0,ALLB,PARMTYPE                                  Y02653*23204002
                             GET DESTINATION INFORMATION         Y02653 23206002
         BP    STAE0215      IF POSTIVE, CONTINUE CHECKING       Y02653 23233402
STAE0212 EQU   *             MESSAGE TO MASTER CONSOLE           Y02653 23236702
         SR    R0,R0         INDICATE MASTER CONSOLE             Y02653 23240002
         B     STAE0218      GO ISSUE WTO                        Y02653 23242002
STAE0215 EQU   *             EXAMINE FOR ASID OR CONSOLE ID      Y02653 23244002
         SR    R0,R0         ZERO INSERTION REGISTER             Y02653 23246002
         ICM   R0,TWOB,PARMTPUT                                  Y02653*23248002
                             PULL IN THE ID                      Y02653 23248402
         BM    STAE0212      TOP BIT ON THEN ASID/MASTER         Y02653 23248802
STAE0218 EQU   *                                                 Y02653 23249202
         LA    R1,PARMMESG   ADDRESS OF BUFFER                   Y02653 23250002
         TM    PARMFLGS,PARMCOMD                                 Y02653*23260002
                             IS IT COMMAND STATUS?               Y02653 23270002
         BO    STAE0219      YES, BRANCH                         Y02653 23280002
         MVI   E38(R1),X10   INSERT SYSTEM STATUS ROUTING CODES  Y02653 23290002
STAE0219 EQU   *                                                 Y02653 23292002
         WTO   MF=(E,(1))    WRITE OUT MESSAGE                   Y02653 23300002
         SR    R15,R15       CLEAR INSERTION REGISTER            Y02653 23300402
         ICM   R15,TWOB,PARMTPUT                                 Y02653*23315602
                             IS THERE AN ASID TO TPUT?           Y02653 23316002
         BNM   STAE0220      NO, BYPASS TPUT PROCESS             Y02653 23316702
         N     R15,MASK2     TURN OFF HIGH END BITS              Y02653 23320402
         LA    R5,MSGLEN6    GET LENGTH OF WTO MESSAGE           Y02653 23324102
         LA    R6,E4         LENGTH OF UNWANTED INFORMATION      Y02653 23327802
         SR    R5,R6         SUBTRACT IT FROM WTO LENGTH         Y02653 23331502
         LA    R1,PARMMESG+E4                                    Y02653*23335202
                             ADDRESS OF THE TPUT TEXT            Y02653 23337202
         TPUT  (1),(5),TJID=(15)                                 Y02653*23338902
                             TPUT THE MESSAGE                    Y02653 23342602
         EJECT                                                          23346302
*********************************************************************** 23350002
*        THIS CODE WILL RETURN TO TO A COMMON EXIT POINT              * 23450002
*        WITH A RETURN CODE OF EIGHT.                                 * 23500002
*********************************************************************** 23600002
STAE0220 EQU   *                                                 Y02653 23650002
         LA    R15,E8        SET RETURN CODE                     Y02653 23750002
         L     R14,PARMRETY  GET THE RETURN ADDRESS              Y02653 23800002
         BR    R14           RETURN TO STAE                      Y02653 23850002
         EJECT                                                          28010002
*********************************************************************** 28020002
*        CONSTANTS FOR STAE                                           * 28040002
*********************************************************************** 28044002
         SPACE                                                          28046002
         DS    0F                                                Y02653 28048002
COMMOVE  MVC   E0(E0,R6),PARMCOMM MOVE COMMAND NAME TO BUFFER    Y02653 28048102
TWELVE   DC    F'12'              ESTAE WORKAREA COMPRAND        Y02653 28048402
RETCDE4  DC    X'10004000'        SYSTEM STATUS ROUTING CODES    Y02669 28048502
RETCDE5  DC    X'08004000'        COMMAND STATUS ROUTING CODES   Y02669 28048802
MASK1    DC    X'7FFFFFFF'        'AND' MASK                     Y02653 28049202
MASK2    DC    X'00007FFF'        ASID SETUP MASK                Y02653 28049302
LRECINF  DC    CL8'IGC0003D'      MODULE NAME FOR LOGREC         Y02653 28049602
         DC    CL8'IEE5103D'      CSECT NAME FOR LOGREC          Y02653 28049702
         DC    CL8'        '      PADDING FOR LOGREC WRITE       Y02653 28049802
TABLE    EQU   *-240              TRANSLATE TABLE                Y02653 28049902
         DC    C'0123456789ABCDEF'                               Y02653 28083202
         EJECT                                                          28093202
*********************************************************************** 28103202
*        MESSAGES FOR STAE                                            * 28115202
*********************************************************************** 28116002
         SPACE                                                          28116402
         DS    0F                                                Y02653 28116502
STRT0    EQU   *                                                 Y02653 28116602
INSERT0  DC    C' DUMPED,'        SUCESSFUL DUMP MESSAGE         Y02653 28127702
END0     EQU   *                                                 Y02653 28137702
STRT2    EQU   *                                                 Y02653 28140602
INSERT2  DC    C'SVC 34 ABEND'    SVC 34 ABEND                   Y02653 28140702
END2     EQU   *                                                 Y02653 28140802
STRT3    EQU   *                                                 Y02653 28141002
INSERT3  DC    C' COMMAND '       COMMAND                      @ZA15793 28141403
END3A    EQU   *                                               @ZA15793 28141903
         DC    C'ABEND'           ABEND                        @ZA15793 28142203
END3     EQU   *                                                 Y02653 28142802
STRT4    EQU   *                                                 Y02653 28143702
INSERT4  DC    C' TERMINATED'     INDICATE FAILED                Y02653 28144602
END4     EQU   *                                                 Y02653 28145502
         DS    0F                                                Y02653 28146402
STRT5    EQU   *                                                 Y02653 28147302
ABMSG    WTO   'IEE480I ',MF=L,ROUTCDE=(2),DESC=(4,5),           Y02653*28148202
               MCSFLAG=(RESP,REG0)                               Y02653 28148602
END5     EQU   *                                                 Y02653 28149102
         DS    0F                                                Y02653 28150002
STRT6    EQU   *                                                 Y02653 28196202
CSCBCHOP WTO   'IEE513I COMMAND PROCESSING LIMITED',             Y02653*28206202
               MF=L,ROUTCDE=(2),DESC=(5),MCSFLAG=(RESP,REG0)     Y02653 28216202
END6     EQU   *                                                 Y02653 28226202
         EJECT                                                          28236202
*********************************************************************** 28238202
*        MACRO LIST FORMS FOR STAE                                    * 28242202
*********************************************************************** 28244602
         DS    0F                                                Y02653 28245002
STRT11   EQU   *                                                 Y02653 28246002
DUMPPARM SDUMP HDR='IEE5103D - FAILURE IN SVC 34          ',   @ZA15793*28246103
               MF=L,SDATA=(SQA,PSA,NUC,LSQA,RGN,LPA,TRT,CSA)     Y02653*28251103
                                  DUMP OPTIONS FOR STAE DUMP     Y02653 28262802
END11    EQU   *                                                 Y02653 28272802
DEQST    EQU   *                  START OF DEQUEUE LIST          Y02653 28272902
LISTDEQ  DEQ   (MACSCB,MICSCB,3,SYSTEM),RET=HAVE,MF=L            Y02653 28273202
DEQEND   EQU   *                  END OF DEQUEUE LIST            Y02653 28273602
ENQST    EQU   *                  START OF ENQUEUE LIST          Y02653 28273702
LISTENQ  ENQ   (MACSCB,MICSCB,E,3,SYSTEM),RET=HAVE,MF=L          Y02653 28274002
ENQEND   EQU   *                  END OF DEQUEUE LIST            Y02653 28274402
MACSCB   DC    CL8'SYSIEFSD'      CSCB MAJOR NAME                Y02653 28274502
MICSCB   DC    CL8'Q10'           CSCB MINOR NAME                Y02653 28274602
PATCH    DS    0F                                              @ZA15790 28274703
         DC    CL50'*** IEE5103D PATCH AREA ***'               @ZA15790 28275003
         EJECT                                                          28276103
*********************************************************************** 28276802
*        LENGTH EQUATES                                               * 28279202
*********************************************************************** 28279402
MSGLEN0  EQU   END0-STRT0    LENGTH OF 'DUMPED,' MESSAGE         Y02653 28287002
MSGLEN2  EQU   END2-STRT2    LENGTH OF 'SVC 34 ABEND' MESSAGE    Y02653 28289002
MSGLEN3  EQU   END3-STRT3    LENGTH OF 'COMMAND ABEND' MESSAGE   Y02653 28289102
MSGLEN3A EQU   END3A-STRT3   LENGTH OF ' COMMAND ' MESSAGE     @ZA15793 28289203
MSGLEN4  EQU   END4-STRT4    LENGTH OF 'TERMINATED' MESSAGE      Y02653 28289402
MSGLEN5  EQU   END5-STRT5    LENGTH OF 'IEE480I' MESSAGE         Y02653 28289802
MSGLEN6  EQU   END6-STRT6    LENGTH OF 'IEE513I........' MESSAGE Y02653 28290202
DUMPL    EQU   END11-STRT11  LENGTH OF 'IEE5103D' ID FOR STAE    Y02653 28290402
ENQLEN   EQU   ENQEND-ENQST  LENGTH OF ENQUEUE LIST              Y02669 28290502
DEQLEN   EQU   DEQEND-DEQST  LENGTH OF DEQUEUE LIST              Y02669 28305302
         EJECT                                                          28319302
*********************************************************************** 28319702
*        DSECT FOR STAE WORKAREA                                      * 28320202
*********************************************************************** 28325202
EPARMS   DSECT                                                   Y02653 28329202
PARMCODE DS    F                  STAE RECURSION INDICATOR       Y02653 28329602
PARMABND DS    F                  ABEND CODE IF SUPPLIED         Y02653 28330002
PARMRETY DS    F                  RETURN ADDRESS                 Y02653 28330102
PARMWORK DS    F                  ROUTINE BASE ADDRESS           Y02653 28337202
PARMTYPE DS    H                  DESTINATION INFORMATION        Y02653 28337602
PARMTPUT DS    H                  ASID OR CONSOLE ID             Y02653 28338002
PARMFLGS DS    C                  INDICATOR BYTE                 Y02653 28339202
PARMDUMP EQU   X'80'              FAILURE ENTRY INDICATOR        Y02653 28339602
PARMCHOP EQU   X'40'              CHOPPED MESSAGE INDICATOR      Y02653 28339702
PARMCOMD EQU   X'20'              COMMAND ISSUED INDICATOR       Y02653 28339802
         DS    C                  RESERVED                       Y02653 28340002
PARMLNCM DS    H                  COMMAND LENGTH                 Y02653 28340102
PARMCOMM DS    CL8                COMMAND NAME                   Y02653 28352002
PARMMESG DS    0F                 MESSAGE BUFFER                 Y02653 28362002
MSGLEN   DS    H                  LENGTH OF MESSAGE              Y02653 28364002
MSGFLG   DS    H                  WTO FLAGS                      Y02653 28364102
PARMPUTM DS    CL60               FIRST PART OF MESSAGE          Y02653 28364202
         SPACE                                                          28366203
PARMABN0 DSECT                    FOR CONVERT OF ABEND CODE      Y02653 28368202
PARMABN1 DS    C                  FIRST BYTE OF ABEND CODE       Y02653 28370202
PARMABN2 DS    C                  SECCOND BYTE OF ABEND CODE     Y02653 28370602
PARMABN3 DS    C                  THIRD BYTE OF ABEND CODE       Y02653 28371002
PARMABN4 DS    C                  FOURTH BYTE OF ABEND CODE      Y02653 28371402
PARMABN5 DS    C                  LAST BYTE OF ABEND CODE        Y02653 28371802
         SPACE                                                          28421803
PARMDMP  DSECT                    MAPS SDUMP PARM LIST         @ZA15793 28471803
PARMDFLG DS    CL24               FLAGS AND ADDR'S FOR DUMP    @ZA15793 28521803
PARMDTIT DS    0CL40              DUMP TITLE                   @ZA15793 28621803
PARMDLEN DS    C                  LENGTH OF TITLE              @ZA15793 28631803
PARMDFIX DS    CL21               FIXED PART OF TITLE          @ZA15793 28671803
PARMDVAR DS    CL9                VARIABLE PART OF TITLE       @ZA15793 28721803
PARMDCMD DS    CL8                COMMAND NAME IF AVAILABLE    @ZA15793 28771803
         END                                                            30550020
./  ADD  SSI=63440170,NAME=IEE5403D
IEE5403D TITLE 'PROLOG'                                       @ZA16354  00050003
**********************************************************************  00200002
* MODULE NAME     = IEE5403D                                   Y02669*  00290002
*                                                              Y02669*  00380002
* DESCRIPTIVE NAME= COMMAND TRANSLATOR ROUTINE                 Y02669*  00470002
*                                                              Y02669*  00560002
* COPY RIGHT      = N/A                                       @ZA14128* 00650003
*                                                              Y02669*  00740002
* STATUS          = 0S/VS2 RELEASE 3 PTF UZ08069              @ZA16354* 00830003
*                                                              Y02669*  00920002
* FUNCTION        = THIS MODULE TRANSLATES LOWER CASE LETTERS  Y02669*  01010002
*                   IN COMMANDS TO UPPER CASE, INITIALIZES THE Y02669*  01100002
*                   XSA, SCANS THE INPUT BUFFER FOR THE        Y02669*  01190002
*                   BEGINNING OF THE VERB, AND DIRECTS         Y02669*  01280002
*                   COMMANDS TO HARDCOPY.                      Y02669*  01370002
*                                                              Y02669*  01460002
* OPERATIONS      = UPON ENTRY REGISTER 1 POINTS TO A COMMAND  Y02669*  01550002
*                   INPUT BUFFER AND REGISTER 0 CONTAINS THE   Y02669*  01640002
*                   SOURCE OF THE COMMAND.                     Y02669*  01730002
*                                                              Y02669*  01820002
*                   THE COMMAND BUFFER IS SCANNED FROM LEFT    Y02669*  01870002
*                   TO RIGHT FOR THE FIRST NON-BLANK CHARACTER.Y02669*  01880002
*                   ONCE FOUND, THE FOLLOWING CHARACTERS       Y02669*  01892003
*                   ARE TRANSLATED TO UPPER                  @ZA14128*  01893003
*                   CASE BY MEANS OF AN INTERNAL TRANSLATE     Y02669*  01896002
*                   TABLE.  IF ANY INVALID CHARACTERS ARE      Y02669*  01948002
*                   LOCATED A CODE (X'2B') IS PLACED IN THE    Y02669*  01998002
*                   XAE FIELD OF THE XSA.  AN INVALID          Y02669*  02048002
*                   CHARACTER MESSAGE WILL BE ISSUED BY        Y02669*  02098002
*                   IEE0403D UPON READING THIS CODE.           Y02669*  02148002
*                                                              Y02669*  02360002
*                   IF THE SCAN FINDS APOSTROPHES NO           Y02669*  02900002
*                   TRANSLATION OF THE CHARACTER STRING WITHIN Y02669*  02990002
*                   THE QUOTES IS MADE.  IF NO QUOTES ARE      Y02669*  03080002
*                   FOUND, NORMAL TRANSLATION TO UPPER CASE    Y02669*  03170002
*                   OF THE CHARACTER STRING IS DONE.           Y02669*  03260002
*                                                              Y02669*  03350002
*                   A CHECK IS MADE FOR THE COMMAND SOURCE     Y02669*  03440002
*                   WHETHER INPUT STREAM OR TSO TERMINAL.      Y02669*  03530002
*                   FOR TSO THE ASID FIELD IS SAVED IN THE XAA Y02669*  03620002
*                   FIELD OF THE XSA.  IF FROM THE INPUT       Y02669*  03672002
*                   STREAM THE XAA FIELD IS ZEROED OUT.        Y02669*  03674002
*                                                              Y02669*  03800002
*                   IN SYSTEMS WITH THE MULTIPLE CONSOLE       Y02669*  03810002
*                   SUPPORT (MCS) OPTION, THIS ROUTINE         Y02669*  03820002
*                   DETERMINES WHETHER OR NOT THE COMMAND      Y02669*  03822002
*                   IS TO BE ADDED TO THE HARD COPY LOG.       Y02669*  03824002
*                   IF SO, A CHECK IS MADE TO DETERMINE        Y02669*  03826002
*                   IF THE COMMAND IS 'REPLY' OR 'CONTROL'.    Y02669*  03828002
*                   FOR SECURITY REASONS THESE COMMANDS        Y02669*  03828402
*                   WILL NOT BE WRITTEN TO THE LOG.            Y02669*  03828802
*                   A CHECK IS ALSO MADE TO DETERMINE IF THE @ZA03236*  03868803
*                   COMMAND BEGINS WITH A NUMBER. IF IT DOES,@ZA03236*  03908803
*                   IT WILL NOT BE HARDCOPIED BY THIS MODULE @ZA03236*  03948803
*                   IN CASE IT IS A REPLY COMMAND. BIT       @ZA03236*  03988803
*                   XASSDS4 IN THE XSA IS SET AND IEE0403D   @ZA03236*  04028803
*                   WILL HARDCOPY THE COMMAND IF IT DOES NOT @ZA03236*  04068803
*                   GET CHANGED TO A REPLY COMMAND BY THE    @ZA03236*  04108803
*                   SUBSYSTEM                                 @ZA03236* 04148803
*                                                              Y02669*  04250002
*                   THE SCAN POINTER IS RELOCATED AT THE       Y02669*  04340002
*                   BEGINNING OF THE VERB AND A BRANCH TAKEN   Y02669*  04480002
*                   TO IEE0403D.                               Y02669*  04490002
*                                                              Y02669*  04610002
* NOTES:                                                       Y02669*  04700002
*   CHARACTER-CODE= THIS MODULE IS CHARACTER CODE DEPENDENT.   Y02669*  04790002
*                   IF A CHARACTER SET OTHER THAN EBCDIC       Y02669*  04840002
*                   IS USED, THIS MODULE WILL NOT ASSEMBLE     Y02669*  04890002
*                   CORRECTLY.  THE TRANSLATE TABLE LOCATED    Y02669*  04940002
*                   AT THE END OF THIS MODULE IS WHERE THE     Y02669*  04950002
*                   CHARACTER DEPENDENT CODE IS LOCATED.       Y02669*  04960002
*   DEPENDENCIES  = NONE                                       Y02669*  04970002
*   RESTRICTIONS  = NONE                                       Y02669*  05060002
*   REGISTER-                                                  Y02669*  05150002
*    CONVENTIONS  = NONE                                       Y02669*  05240002
*   PATCH-LABEL   = PATCH                                      Y02669*  05330002
*                                                              Y02669*  05420002
* MODULE TYPE:                                                 Y02669*  05510002
*   PROCESSOR     = ASSEMBLER                                  Y02669*  05600002
*   MODULE SIZE   = X'344'                                    @ZA16354* 05690003
*   ATTRIBUTES    = ZERO PSW PROTECT KEY,REFRESHABLE,          Y02669*  05840002
*                   SUPERVISOR KEY,PAGED LPA                   Y02669*  05850002
*                                                              Y02669*  05870002
* ENTRY POINT     = IEE5403D                                   Y02669*  05960002
*   PURPOSE       = TRANSLATIONS OF COMMANDS TO UPPER CASE.    Y02669*  06010002
*   LINKAGE       = BRANCH FROM IEE0303D                       Y02669*  06050002
*   INPUT DATA    = REG 1 CONTAINS A POINTER TO COMMAND BUFFER Y02669*  06140002
*                   REGISTER 2 CONTAINS XSA POINTER            Y02669*  06230002
*                   REGISTER 0 CONTAINS UCM POINTER,           Y02669*  06320002
*                   READER AUTHORITY AND ASID                  Y02669*  06370002
*                                                              Y02669*  06410002
* REGISTER SAVED  = NONE                                       Y02669*  06500002
* REGISTER CONTENTS DURING                                     Y02669*  06550002
* PROCESSING      = REG 0  - COMMAND SOURCE                    Y02669*  06600002
*                   REG 1  - COMMAND INPUT BUFFER              Y02669*  06650002
*                   REG 2  - XSA                               Y02669*  06660002
*                   REG 3  - BASE REGISTER                     Y02669*  06670002
*                   REG 4  - WORK REGISTER                     Y02669*  06672002
*                   REG 5  - SCAN REGISTER                     Y02669*  06674002
*                   REG 6  - WORK REGISTER                     Y02669*  06676002
*                   REG 7  - UCM POINTER                       Y02669*  06678002
*                   REG 8  - WORK REGISTER                     Y02669*  06678402
*                   REG 9  - (OPEN)                            Y02669*  06678802
*                   REG 10 - SCAN POINTER                      Y02669*  06679202
*                   REG 11 - (OPEN)                            Y02669*  06679602
*                   REG 12 - WORK REGISTER                     Y02669*  06679702
*                   REG 13 - WORK REGISTER                     Y02669*  06679802
*                   REG 14 - RETURN REGISTER                   Y02669*  06679902
*                   REG 15 - LINK REGISTER                     Y02669*  06709902
* REGISTERS                                                    Y02669*  06830002
*   RESTORED      = NONE                                       Y02669*  06840002
*                                                              Y02669*  06860002
* EXIT - NORMAL   = IEE0403D                                   Y02669*  06950002
*   CONDITIONS    = NORMAL SVC 34 PROCESSING                   Y02669*  07040002
*   OUTPUT DATA   = LOWER CASE LETTERS CONVERTED TO UPPER CASE Y02669*  07130002
*                   IF REQUIRED COMMANDS WRITTEN TO HARDCOPY   Y02669*  07220002
*                   XAL POINTS TO BEGINNING OF VERB            Y02669*  07310002
*                   REGISTER 1 POINTS TO COMMAND BUFFER        Y02669*  07400002
*                   IF TSO XAA FIELD OF XSA CONTAINS ASID      Y02669*  07490002
*                   IF COMMAND STARTS WITH NUMBER, XASSDS4    @ZA03236* 07520003
*                   SET ON                                    @ZA03236* 07550003
*   RETURN CODE   = NONE                                       Y02669*  07580002
*                                                              Y02669*  07670002
* EXIT - ERROR    = NONE                                       Y02669*  07760002
*   CONDITIONS    = NONE                                       Y02669*  07850002
*   OUTPUT DATA   = NONE                                       Y02669*  07940002
*   RETURN CODE   = NONE                                       Y02669*  08030002
*                                                              Y02669*  08120002
* EXTERNAL                                                     Y02669*  08210002
*   REFERENCES    =                                            Y02669*  08300002
*   ROUTINES      = IEE0403D                                   Y02669*  08390002
*   DATA AREAS    = COMMAND BUFFER                             Y02669*  08480002
*   CONTROL BLOCKS= EXTENDED SAVE AREA                         Y02669*  08570002
*                   UNIT CONTROL BLOCK                         Y02669*  08660002
*   TABLES        = TRANSLATE TABLE                            Y02669*  08750002
*   MACRO         = NONE                                       Y02669*  08840002
*   ENQUEUED                                                   Y02669*  08930002
*    RESOURCES    = NONE                                       Y02669*  09020002
*   LOCKS         =                                            Y02669*  09110002
*   CHANGE LEVEL  = Y02669,ZA14128,ZA16354                    @ZA16354* 09200003
*                                                              Y02669*  09290002
* SYSGENS         = THIS MODULE IS INCLUDED IN LOAD MODULE     Y02669*  09360002
*                   IGC0003D AND LOADED INTO LPALIB. IT IS     Y02669*  09362002
*                   INCLUDED AT SYSGEN TIME FROM DLIB AOSB3    Y02669*  09364002
*                   USING SYSGEN MACRO SGIEF441.               Y02669*  09366002
*                                                              Y02669*  09366402
* SYSTEM LIBRARIES= NONE                                       Y02669*  09368002
*                                                              Y02669*  09370002
* MESSAGES        = NONE                                       Y02669*  09380002
**********************************************************************  09470002
         TITLE ' COMMUNICATIONS VECTOR TABLE'                           10400018
TRCVT    DSECT                                                          10600018
         CVT                                                            10800018
         TITLE ' EXTENDED SAVE AREA'                                    11200018
TRXSA    DSECT                                                          11400018
         IEEXSA                                                         11600018
         TITLE ' UNIT CONTROL MODULE'                                   11800018
TRUCM    DSECT                                                          12000018
         IEECUCM                                                        12200018
         TITLE ' TRANSLATE'                                             12600018
IEE5403D CSECT                                                          12800018
* A 188500-189000,411500,411820                                  YM1788 12850001
* C 249800,249920,314201,314401,314500,315500,411620,411900      YM1788 12900001
* D 194500-194600                                                YM1788 12950001
* A 249100-249400                                                YM2309 12960001
* A 249784,249920                                              @Y04979P 12970002
* C 249960                                                     @Y04979P 12980002
* D PROLOG APPROX 024100                                       @ZA14128 12986003
* C TRANS0 APPROX 249000-272000                                @ZA14128 12992003
* C TRTAB APPROX 418000                                        @ZA16354 12996003
         SPACE                                                          13000018
* R E G I S T E R   A S S I G N M E N T S                               13200018
         SPACE                                                          13400018
R0       EQU   0     UCM INDICATOR                                 IMCS 13600018
R1       EQU   1    INPUT REG, PTR TO BUFFER                            13800018
R2       EQU   2    XSA BASE REG                                        14000018
R3       EQU   3    MODULE BASE REG                                     14200018
R4       EQU   4    XSA WORKREG                                         14400018
R5       EQU   5    TRANSLATE WORK REG                                  14600018
R6       EQU   6    TRANSLATE WORK REG                                  14800018
R7       EQU   7                                                        15000018
R8       EQU   8                                                        15200018
R9       EQU   9                                                        15400018
R10      EQU   10                                                       15600018
R11      EQU   11                                                       15800018
R12      EQU   12                                                       16000018
R13      EQU   13                                                       16200018
R14      EQU   14                                                       16400018
R15      EQU   15   XCTL PARA-REG                                       16600018
         SPACE                                                          16800018
         SPACE                                                          17200018
* B A S E   M O D U L E                                                 17400018
BLANK    EQU   X'40'                                                    17600018
D3       EQU   3                                                  20030 17630020
D5       EQU   5                                                 A49195 17640001
D7       EQU   7                                                  20030 17660020
IEE298I  EQU   X'2B'                    CODE FOR MESSAGE IEE298I Y01120 17750001
         SPACE                                                          18000018
D0       EQU   0                        USED FOR OFFSETS,LENGTHS,ETC.   18200018
D1       EQU   1                        *                               18400018
D2       EQU   2                        *                               18600018
D4       EQU   4                        *                               18800018
D6       EQU   6                                                 YM1788 18850001
D8       EQU   8                                                 YM1788 18900001
         SPACE                                                          19200018
X80      EQU   X'80'                                                    19400018
UCMEQU   EQU   UCMSDS1A+UCMSDS1B                                  M0130 19500001
         EJECT                                                          19600002
         BALR  R3,0                                                     19800018
         USING *,R3                                                     20000018
         MODID BRANCH=YES                                        Y01886 20050001
         USING TRXSA,R2                                                 22000018
         MVI   XAE,INVALID        ZERO OUT XAE FIELD             Y02669 22050002
         EJECT                                                          23200002
* T R A N S L A T E   T H E   C O M M A N D                             23600018
         SPACE                                                          23800018
TRANS0   LA    R10,D3(R1)         POINT TO BYTE BEFORE TEXT    @ZA14128 24000003
         LA    R8,D1(R10)         POINT TO TEXT                @ZA14128 24050003
         LH    R7,0(R1)            LENGTH OF BUFFER                     24200018
         AR    R7,R1                                                    24400018
         ST    R7,XAP              SAVE FOR LATER USE BY         Y02669 24450002
*                                  MODULES ISSUING IEEBUFSC      Y02669 24500002
         BCTR  R7,0                END OF BUFFER                        24600018
         LA    R6,1                INCREMENT                            24800003
         SPACE                                                          24800903
*********************************************************************** 24801803
*   SKIP OVER CHARACTERS UNTIL THE 1ST NON-BLANK IS FOUND.     @ZA14128 24802703
*   IF NONE ARE FOUND THEN CONTROL IS GIVEN TO LABEL CHKMCS.   @ZA14128 24803603
*   IF A NON-BLANK IS FOUND THEN SEE IF IT IS A //BLANK. IF    @ZA14128 24804503
*   IT IS NOT THEN CONTROL IS GIVEN TO LABEL NOSLASH. IF IT    @ZA14128 24805403
*   IS THEN SKIP OVER IT AND CONTINUE LOOKING FOR A NON-BLANK  @ZA14128 24806303
*   CHARACTER.                                                 @ZA14128 24807203
*********************************************************************** 24808103
         SPACE                                                          24809003
SKIPBLKS EQU   *                                                        24809903
         BXH   R10,R6,CHKMCS      UPDATE PTR. TEST BUFFER END  @ZA14128 24810803
         CLI   D0(R10),BLANK      IS CHAR A BLANK?             @ZA14128 24811703
         BE    SKIPBLKS           YES THEN BRANCH              @ZA14128 24812603
         CLC   D0(D3,R10),XSLASH  NOT BLANK. IS IT A //BLANK?  @ZA14128 24813503
         BNE   NOSLASH            NO THEN BRANCH               @ZA14128 24814403
         LA    R10,D2(R10)        YES IT'S //BLANK. SKIP OVER  @ZA14128 24815303
         B     SKIPBLKS           FIND NEXT NON-BLANK CHAR     @ZA14128 24816203
         EJECT                                                          24817103
*********************************************************************** 24818003
*   THE COMMAND HAS BEEN FOUND. R10 POINTS TO THE BEGINNING    @ZA14128 24818903
*   OF THE COMMAND.                                            @ZA14128 24819803
*                                                                       24820703
*   TRANSLATE ALL CHARACTERS TO UPPER CASE AS LONG AS THEY     @ZA14128 24821603
*   ARE NOT IN SINGLE QUOTES. THESE WILL REMAIN AS THEY WERE   @ZA14128 24822503
*   ENTERED.                                                   @ZA14128 24823403
*                                                                       24824303
*   IF AN INVALID CHARACTER IS FOUND DURING TRANSLATION THEN   @ZA14128 24825203
*   FIELD XAE IN THE XSA IS SET TO INDICATE THIS TO MODULE     @ZA14128 24826103
*   IEE0403D.                                                  @ZA14128 24827003
*                                                                       24827903
*   WHEN THE END OF THE BUFFER IS REACHED THEN CONTROL IS THEN @ZA14128 24828803
*   GIVEN TO LABEL CHKMCS.                                     @ZA14128 24829703
*********************************************************************** 24830603
         SPACE                                                          24831503
NOSLASH  EQU   *                                               @ZA14128 24832403
         LR    R8,R10             SAVE PTR TO COMMAND          @ZA14128 24833303
FNDAPOS  EQU   *                                               @ZA14128 24834203
         CLI   D0(R10),C''''      IS CHAR OPENING APOSTROPHE?  @ZA14128 24835103
         BE    INQUOTE            YES THEN BRANCH              @ZA14128 24836003
         TR    D0(1,R10),TRTAB    TRANSLATE THE CHARACTER      @ZA14128 24836903
         CLI   D0(R10),INVALID    WAS IT AN INVALID CHARACTER? @ZA14128 24837803
         BNE   NEXTCHAR           NO THEN BRANCH               @ZA14128 24838703
         MVI   XAE,IEE298I        INDICATE INVALID CHAR FOUND  @ZA14128 24839603
         B     NEXTCHAR           GET NEXT CHARACTER           @ZA14128 24840503
INQUOTE  EQU   *                                               @ZA14128 24841403
         BXH   R10,R6,CHKMCS      UPDATE PTR. TEST BUFFER END  @ZA14128 24842303
         CLI   D0(R10),C''''      CLOSING APOSTROPHE FOUND?    @ZA14128 24843203
         BNE   INQUOTE            NO THEN BRANCH               @ZA14128 24844103
NEXTCHAR EQU   *                                               @ZA14128 24845003
         BXH   R10,R6,CHKMCS      UPDATE PTR. TEST BUFFER END  @ZA14128 24845903
         B     FNDAPOS            CONTINUE TRANSLATION         @ZA14128 24846803
         EJECT                                                          27250002
* C H E C K  F O R  M C S                                               27400018
CHKMCS   EQU   *                                                        27600018
         USING TRCVT,R7                 ADDRESS CVT                 MCS 27800018
         L     R7,CVTPTR                GET CVT ADDR                    28000018
         L     R7,CVTCUCB               PTR TO UCM BASE             MCS 28200018
         DROP  R7                       NO LONGER NEED CVT          MCS 28400018
         USING TRUCM,R7                 ADDRESS UCM                 MCS 28600018
         MVI   XAU,ZERO            ZERO OUT XAU FIELD             M5521 28602020
         LTR   R0,R0               IS COMMAND FROM INPUT STREAM   M5521 28602420
         BM   INPUTST              YES, ZEROS IN BOTH XAU AND XAJ M5521 28602820
         STH   R0,XAA              SAVE TJID/CONSOLE ID           M5521 28602902
         TM    XAA,X'80'           TEST HIGH ORDER BIT FOR TJID   M5521 28606302
         BZ    NONTSO              NO. NOT TSO TJID               M5521 28608320
         XI    XAA,X'80'           YES. TURN OFF BIT              M5521 28608702
         B     INMCS               CHECK FOR MCS                 Y01939 28609101
NONTSO   STC   R0,XAU              SAVE CONSOLE ID IN XSA         M5521 28609520
INPUTST  MVC   XAA(2),ZEROS        ZERO TJID FLD IN XSA WHEN NON-TSO    28609602
*                                                                 M5521 28685701
         EJECT                                                          28735702
* C H E C K  F O R  Q U E U E  T O  H A R D C O P Y                     30000018
INMCS    EQU   *                                                    MCS 30200018
         SH    R7,FOUR                  PT TO WORD BEFORE UCM BASE  MCS 30400018
         L     R7,D0(R7)                PTR TO MCS UCM PREFIX       MCS 30600018
         DROP  R7                       NO LONGER NEED UCM BASE     MCS 30800018
         USING UCMPRFX,R7               ADDRESS UCM MCS PREFIX      MCS 31000018
         TM    UCMSFLGS,UCMSYSB    IS HARDCOPY REQUIRED?          M0130 31050001
         BZ    NOHCPY              BRANCH IF NO                   M0130 31100001
         TM    UCMSDS1,UCMEQU      STCMDS OR INCMDS TO HARD COPY? M0130 31150001
         BM    HARDEXST            BRANCH IF YES                  M0130 31170001
         TM    UCMSFLGS,UCMSYSC         QUEUE TO HARDCOPY           MCS 31200018
         BZ    NOHCPY                   NO                          MCS 31400018
HARDEXST EQU   *                                                  M0130 31410001
         CLI   D0(R8),NUMBER      IS THIS HASP FORM REPLY?     @ZA03236 31411003
         BL    CHKRPLY            LOOK FOR REPLY               @ZA03236 31412003
         OI    XASSDS,XASSDS4     SHOW COMMAND NOT             @ZA03236 31413003
*                                 HARDCOPIED FOR 0403D         @ZA03236 31414003
         B     NOHCPY             DONT HARDCOPY                @ZA03236 31415003
CHKRPLY  CLC   D0(D2,R8),R        IS THIS THE 'R' COMMAND?       YM1788 31420103
         BE    NOHCPY             YES, BYPASS WTO                Y01012 31430101
         CLC   D0(D6,R8),REPLY    IS THIS THE 'REPLY' COMMAND?   YM1788 31440101
         BE    NOHCPY             YES, BYPASS WTO                Y01012 31442101
         CLC   D0(D2,R8),K        IS THIS THE 'K' COMMAND?       YM1788 31450001
         BE    NOHCPY             YES, DO NOT SEND CMD TO HARDCPY 21002 31500001
         CLC   D0(D8,R8),CONTROL  IS THIS THE 'CONTROL' COMMAND? YM1788 31550001
         BE    NOHCPY             YES, DO NOT SEND CMD TO HARDCPY 21002 31560001
         EJECT                                                          31570002
* H A R D C O P Y  W T O  R O U T I N E                             MCS 31600018
         LH    R5,D0(R1)                GET LENGTH OF CIB           MCS 31800018
         L     R12,D0(R1)               SAVE CONTENTS OF REG 1   A41171 32000001
         AR    R5,R1                    PT TO ONE PAST BUFFER END   MCS 32200018
         LA    R13,D4(R1)               PT TO START OF TEXT AREA    MCS 32400018
TRSCAN   EQU   *                                                    MCS 32600018
         BCTR  R5,D0                    BACK UP ONE BYTE            MCS 32800018
*                                                                   MCS 33000018
* SCAN BACKWARDS IN COMMAND INPUT BUFFER TO FIND A NON-BLANK CHAR-  MCS 33200018
* ACTER. THIS IS TO PREVENT WTO-ING UNNECESSARY TRAILING BLANKS.    MCS 33400018
*                                                                   MCS 33600018
         CLI   D0(R5),BLANK             IS THIS BYTE BLANK          MCS 33800018
         BNE   TRWTO                    NO. GO WRITE COMMAND        MCS 34000018
         CR    R13,R5                   AT THE BEGINNING OF BUFFER  MCS 34200018
         BCR   8,R14                    YES. BLANK CIB. NO-OP       MCS 34400018
         B     TRSCAN                   NO. CONTINUE BACK SCAN      MCS 34600018
TRWTO    EQU   *                                                    MCS 34800018
         SR    R5,R1                    COMMAND LENGTH LESS ONE     MCS 35000018
         LA    R5,D1(R5)                COMMAND LENGTH              MCS 35200018
         STH   R5,D0(R1)                WTO LENGTH FIELD            MCS 35400018
         SPACE                                                          35600018
HCFLG    EQU   X'0200'                  Q-TO-HARDCOPY ONLY FLAG     MCS 35800018
         SPACE                                                          36000018
         LA    R5,HCFLG                 SET Q-TO-HARDCOPY BIT ON    MCS 36200018
         STH   R5,D2(R1)                IN MCSFLAG FLD OF BUFFER    MCS 36400018
         LR    R6,R0                    SAVE PARAMETER REGISTER     MCS 36600018
         LR    R5,R1                    SAVE CIB PTR                MCS 36800018
         WTO   MF=(E,(1))               WRITE COMMAND TO HARDCOPY   MCS 37000018
         LR    R0,R6                    RESTORE  ...                MCS 37200018
         LR    R1,R5                    ...REGISTERS                MCS 37400018
         ST    R12,D0(R1)               RESTORE ORIGINAL REG 1   A41171 37600001
NOHCPY   EQU   *                                                    MCS 37800018
         LTR   R0,R0                    COMMAND FROM INPUT STREAM   MCS 38000018
         BNL   SCANVERB                 NO. FROM A CONSOLE          MCS 38200002
         MVI   XAU,X80                  INPUT STREAM INDICATOR      MCS 38400018
         STH   R0,XAS                   R/I COMMAND AUTHORITY       MCS 38600018
         EJECT                                                          38650002
SCANVERB EQU   *                                                    MCS 39000002
         SPACE                                                          39400018
         CLI   XAE,IEE298I        INVALID CHARACTER              Y01120 39520001
         BE    SETIND             YES SAVE INDICATOR              20030 39560020
         ST    R1,XAR             POINTER TO COMMAND IMAGE        20030 39600020
XBACK    MVI   XAV,BLANK          INIT VERB SLOT TO BLANKS        20030 39640020
         MVC   XAV+D1(D7),XAV                                     20030 39680020
         L     R7,XAP             GET ADDR OF BUFFER END +1 Y02669      39780002
         BCTR  R7,D0              GET END OF BUFFER               20030 39800002
         LA    R4,D4(R1)          BYPASS HEADER                   20030 39840020
         LA    R6,D1         INSERT INCREMENT                     20030 39880020
         CLC   D0(D3,R4),XSLASH   BUFFER PRECEECED BY //BLANK     20030 39920020
         BNE   SCAN               IF NOT, BEGIN VERB SCAN         20030 39960020
         LA    R4,D3(R4)          YES, BYPASS HEADER              20030 40000020
SCAN     EQU   *                                                  20030 40040020
         CLI   D0(R4),BLANK       IS THIS CHARACTER A BLANK       20030 40080020
         BNE   ADJBUFFR           IF NOT, ADJUST BUFFER          A49195 40120001
         BXLE   R4,R6,SCAN        IF SO UPDATE PTR AND TEST NEXT  20030 40160020
*        IF NON BLANK CHAR WAS NOT FOUND ENTIRE BUFFER WAS BLANK  20030 40200020
         BR   R14                                                 20030 40240020
SETIND   EQU   *                                                  20030 40280020
         ST    R1,XAR             INDICATOR MUST BE REPLACED      20030 40320020
         MVI   XAE,IEE298I        ABOVE INSTRCTION OVERLAYS CODE Y01120 40360001
         B     XBACK              CONTINUE PROCESSING             20030 40400020
ADJBUFFR EQU   *                                                 A49195 40410001
         LA    R6,D4(R1)          POINT TO BEGINNING OF BUFFER   A49195 40420001
         CR    R6,R4              VERB IN FIRST BUFFER POSITION? A49195 40430001
         BE    SAVEPTR            YES, NO ADJUSTMENT NEEDED      A49195 40432001
         LR    R6,R7              GET END OF BUFFER ADDRESS      A49195 40434001
         SR    R6,R4              COMPUTE VALID BUFFER LENGTH    A49195 40436001
         EX    R6,SHIFTMVE        MOVE VERB INTO FIRST POSITION  A49195 40438001
         LA    R4,D5(R6,R1)       POINT TO 1ST INVALID POSITION  A49195 40438401
         MVI   D0(R4),BLANK       INSERT BLANK                   A49195 40438801
         LR    R6,R7              GET END OF BUFFER ADDRESS      A49195 40439201
         CR    R6,R4              IS THIS LAST CHAR IN BUFFER    SM4227 40439301
         BE    SETPTR             YES. DONT BLANK OUT ANY MORE   SM4227 40439401
         SR    R6,R4              OBTAIN LENGTH OF BLANKS        A49195 40439601
         BCTR  R6,D0              DECREMENT THE LENGTH BY ONE    A49195 40439701
         EX    R6,PADMOVE         BLANK OUT THE INVALID PART OF  A49195*40439801
                                       BUFFER                           40439901
SETPTR   EQU   *                                                        40449901
         LA    R4,D4(R1)          SET POINTER TO THE VERB TEXT   A49195 40453202
SAVEPTR  EQU   *                                                  20030 40466701
         ST    R4,XAL             PUT PTR TO VERB IN XAL          20030 40480002
         L     R15,V0403D         GET ADDRESS OF ROUTER ROUTINE  Y02669 40530002
         BR    R15                GO TO IEE0403D (ROUTER)        Y02669 40550002
         EJECT                                                          40560002
SHIFTMVE MVC   D4(,R1),D0(R4)     SHIFT BUFFER INSTRUCTION       A49195 40650001
PADMOVE  MVC   D1(,R4),D0(R4)     ADD BLANKS INSTRUCTION         A49195 40700001
*                                 CONSTANT MUST BE CONTIGUOUS    Y01120 40850001
FOUR     DC    H'0004'            WORK CONSTANT                     MCS 41000001
ZEROS    DC    X'0000'                                                  41010020
V0403D   DC    V(IEE0403D)             POINTER TO ROUTER ROUTINE Y02669 41020002
ZERO     EQU   0                                                 A21432 41050018
INVALID  EQU   X'00'                                             A21432 41100018
K        DC    CL2'K '            COMPRAND FOR 'K' COMMAND       YM1788 41150001
CONTROL  DC    CL8'CONTROL '      COMPRAND FOR 'CONTROL' COMMAND YM1788 41162001
XSLASH   DC   CL3'// '                                            20030 41170020
R        DC    CL2'R '            COMPRAND FOR 'R' COMMAND       YM1788 41182001
REPLY    DC    CL6'REPLY '        COMPRAND FOR 'REPLY' COMMAND   YM1788 41190001
PATCH    DS    CL50'*** IEE5403D PATCH AREA ***'               @ZA14128 41192003
NUMBER   EQU   X'F0'              CHECK FOR REPLY CMD          @ZA03236 41196003
         TITLE ' TRANSLATE TABLE'                                       41400018
TRTAB    DS    0F                                                       41600018
         DC    256FL1'00'     ZERO FILLER FOR INVALID CHARACTER CHECK  *41800003
                                                               @ZA16354 41850003
         ORG   TRTAB+C' '                                               42000018
         DC    FL1'64'        BLANK                                     42200018
         ORG   TRTAB+C''''                                              42400018
         DC    FL1'125'       APOSTROPHE                                42600018
         ORG   TRTAB+C'#'                                               42800018
         DC    FL1'123'       POUND SIGN                                43000018
         ORG   TRTAB+C'$'                                               43200018
         DC    FL1'91'        DOLLAR SIGN                               43400018
         ORG   TRTAB+X'50'     EBCDIC                                   43600018
         DC    FL1'80'        AND SIGN                                  43800018
         ORG   TRTAB+C'('                                               44000018
         DC    FL1'77'        LEFT PARENTHESES                          44200018
         ORG   TRTAB+C')'                                               44400018
         DC    FL1'93'        RIGHT PARENTHESES                         44600018
         ORG   TRTAB+C'*'                                               44800018
         DC    FL1'92'        ASTERISK                                  45000018
         ORG   TRTAB+C'+'                                               45200018
         DC    FL1'78'        PLUS SIGN                                 45400018
         ORG   TRTAB+C','                                               45600018
         DC    FL1'107'       COMMA                                     45800018
         ORG   TRTAB+C'-'                                               46000018
         DC    FL1'96'        MINUS SIGN                                46200018
         ORG   TRTAB+C'.'                                               46400018
         DC    FL1'75'        PERIOD                                    46600018
         ORG   TRTAB+C'/'                                               46800018
         DC    FL1'97'        SLASH                                     47000018
         ORG   TRTAB+C''                                               47200018
         DC    FL1'74'             CENT SIGN                            47400018
         ORG   TRTAB+C'<'                                               47600018
         DC    FL1'76'             LESS THAN SIGN                       47800018
         ORG   TRTAB+C'|'                                               48000018
         DC    FL1'79'                                                  48200018
         ORG   TRTAB+C'!'                                               48400018
         DC    FL1'90'             EXCLAMATION POINT                    48600018
         ORG   TRTAB+C';'                                               48800018
         DC    FL1'94'             SEMICOLON                            49000018
         ORG   TRTAB+C''                                               49200018
         DC    FL1'95'                                                  49400018
         ORG   TRTAB+C'%'                                               49600018
         DC    FL1'108'            PERCENT SIGN                         49800018
         ORG   TRTAB+C'_'                                               50000018
         DC    FL1'109'            DASH SIGN                            50200018
         ORG   TRTAB+C'>'                                               50400018
         DC    FL1'110'            GREATER THAN SIGN                    50600018
         ORG   TRTAB+C'?'                                               50800018
         DC    FL1'111'            QUESTION MARK                        51000018
         ORG   TRTAB+C':'                                               51200018
         DC    FL1'122'            COLON                                51400018
         ORG   TRTAB+C'@'                                               51600018
         DC    FL1'124'            AT SIGN                              51800018
         ORG   TRTAB+C'"'                                               52000018
         DC    FL1'127'            QUOTES                               52200018
         ORG   TRTAB+C'0'                                               52400018
         DC    AL1(240)       ZERO                                      52600018
         DC    AL1(241)       ONE                                       52800018
         DC    AL1(242)       TWO                                       53000018
         DC    AL1(243)       THREE                                     53200018
         DC    AL1(244)       FOUR                                      53400018
         DC    AL1(245)       FIVE                                      53600018
         DC    AL1(246)       SIX                                       53800018
         DC    AL1(247)       SEVEN                                     54000018
         DC    AL1(248)       EIGHT                                     54200018
         DC    AL1(249)       NINE                                      54400018
         ORG   TRTAB+C'='                                               54600018
         DC    FL1'126'       EQUAL SIGN                                54800018
         ORG   TRTAB+C'@'                                               55000018
         DC    FL1'124'       AT SIGN                                   55200018
         ORG   TRTAB+C'A'-X'40'    EBCDIC                               55400018
         DC    AL1(193)       A TRANSLATED FROM LOWER CASE              55600018
         DC    AL1(194)       B TRANSLATED FROM LOWER CASE              55800018
         DC    AL1(195)       C TRANSLATED FROM LOWER CASE              56000018
         DC    AL1(196)       D TRANSLATED FROM LOWER CASE              56200018
         DC    AL1(197)       E TRANSLATED FROM LOWER CASE              56400018
         DC    AL1(198)       F TRANSLATED FROM LOWER CASE              56600018
         DC    AL1(199)       G TRANSLATED FROM LOWER CASE              56800018
         DC    AL1(200)       H TRANSLATED FROM LOWER CASE              57000018
         DC    AL1(201)       I TRANSLATED FROM LOWER CASE              57200018
         ORG   TRTAB+C'J'-X'40'    EBCDIC                               57400018
         DC    AL1(209)       J TRANSLATED FROM LOWER CASE              57600018
         DC    AL1(210)       K TRANSLATED FROM LOWER CASE              57800018
         DC    AL1(211)       L TRANSLATED FROM LOWER CASE              58000018
         DC    AL1(212)       M TRANSLATED FROM LOWER CASE              58200018
         DC    AL1(213)       N TRANSLATED FROM LOWER CASE              58400018
         DC    AL1(214)       O TRANSLATED FROM LOWER CASE              58600018
         DC    AL1(215)       P TRANSLATED FROM LOWER CASE              58800018
         DC    AL1(216)       Q TRANSLATED FROM LOWER CASE              59000018
         DC    AL1(217)       R TRANSLATED FROM LOWER CASE              59200018
         ORG   TRTAB+C'S'-X'40'    EBCDIC                               59400018
         DC    AL1(226)       S TRANSLATED FROM LOWER CASE              59600018
         DC    AL1(227)       T TRANSLATED FROM LOWER CASE              59800018
         DC    AL1(228)       U TRANSLATED FROM LOWER CASE              60000018
         DC    AL1(229)       V TRANSLATED FROM LOWER CASE              60200018
         DC    AL1(230)       W TRANSLATED FROM LOWER CASE              60400018
         DC    AL1(231)       X TRANSLATED FROM LOWER CASE              60600018
         DC    AL1(232)       Y TRANSLATED FROM LOWER CASE              60800018
         DC    AL1(233)       Z TRANSLATED FROM LOWER CASE              61000018
         ORG   TRTAB+C'A'                                               61200018
         DC    AL1(193)       A                                         61400018
         DC    AL1(194)       B                                         61600018
         DC    AL1(195)       C                                         61800018
         DC    AL1(196)       D                                         62000018
         DC    AL1(197)       E                                         62200018
         DC    AL1(198)       F                                         62400018
         DC    AL1(199)       G                                         62600018
         DC    AL1(200)       H                                         62800018
         DC    AL1(201)       I                                         63000018
         ORG   TRTAB+C'J'                                               63200018
         DC    AL1(209)       J                                         63400018
         DC    AL1(210)       K                                         63600018
         DC    AL1(211)       L                                         63800018
         DC    AL1(212)       M                                         64000018
         DC    AL1(213)       N                                         64200018
         DC    AL1(214)       O                                         64400018
         DC    AL1(215)       P                                         64600018
         DC    AL1(216)       Q                                         64800018
         DC    AL1(217)       R                                         65000018
         ORG   TRTAB+C'S'                                               65200018
         DC    AL1(226)       S                                         65400018
         DC    AL1(227)       T                                         65600018
         DC    AL1(228)       U                                         65800018
         DC    AL1(229)       V                                         66000018
         DC    AL1(230)       W                                         66200018
         DC    AL1(231)       X                                         66400018
         DC    AL1(232)       Y                                         66600018
         DC    AL1(233)       Z                                         66800018
         END                                                            67000018
./  ADD  SSI=80860117,NAME=IEE5503D
          TITLE 'IEE5503D - STOPMN / STOPTR COMMAND PROCESSOR'          00300002
*********************************************************************** 00800002
*                                                                     * 00900020
* MODULE NAME      =   IEE5503D                                 Y02669* 00900402
*                                                                     * 00900802
* DESCRIPTIVE NAME =   STOPMN AND STOPTR COMMAND PROCESSOR      Y02669* 00901202
*                                                                     * 00901602
* COPYRIGHT        =   N/A                                      Y02669* 00901702
*                                                                     * 00907102
* STATUS           =   OS/VS2 RELEASE 037                     @ZA30198* 00909800
*                                                                     * 00912502
* FUNCTION         =   THIS MODULE DETERMINES AND PROCESSES     Y02669* 00915202
*                      THE STOPMN COMMAND OPERANDS:             Y02669* 00917202
*                      JOBNAMES; STATUS; DSNAME; SPACE; SESS.   Y02669* 00919202
*                                                                     * 00920502
*                      AND THE STOPTR COMMAND OPERANDS:         Y02669* 00922102
*                      JOBS (J); TS; AND A.                     Y02669* 00924002
*                                                                     * 00924302
*  OPERATION       =   THE STOPMN COMMAND OPERANDS RECOGNIZED   Y02669* 00924402
*                      BY IEE5503D AND THEIR VALIDITY BY SOURCE Y02669* 00924502
*                      ARE:                                     Y02669* 00926502
*                                                                     * 00928502
*                                    INPUT   TIME     SUBSYSTEM@Y02668P 00928903
*                                    STREAM  SHARING  CONSOLE  @Y02668P 00929903
*                                    OR      (OPERATOR  (JES3) @Y02668P 00930903
*                                    CONSOLE MODE)             @Y02668P 00931903
*                                                              @Y02668P 00932903
*                        JOBNAMES(,T)  VALID   VALID   INVALID @Y02668P 00933903
*                        STATUS        VALID   VALID   INVALID @Y02668P 00934903
*                        SESS(,T)      VALID   VALID   INVALID @Y02668P 00935903
*                        SPACE         VALID  INVALID   VALID  @Y02668P 00936903
*                        DSNAME        VALID  INVALID   VALID  @Y02668P 00937903
*                                                                     * 00948502
*                      FOR STOPTR THE VALID OPERANDS BY         Y02669* 00950402
*                      SOURCE ARE:                              Y02669* 00952402
*                                                                     * 00954402
*                         OPERAND    OPERATOR     TIME SHARING  Y02669* 00954802
*                                     CONSOLE      (OPERATOR    Y02669* 00954902
*                                ISSUED INTERNALLY    MODE)     Y02669* 00955002
*                        ---------   -------      ------------  Y02669* 00955202
*                         JOBS (J)    VALID         INVALID     Y02669* 00956002
*                         TS          VALID         INVALID     Y02669* 00956102
*                         A           VALID         INVALID     Y02669* 00962902
*                                                                     * 00966202
*                      IEE5503D, DEPENDING ON THE COMMAND       Y02669* 00976202
*                      SOURCE, TERMINATES MONITOR AND TRACK     Y02669* 01026202
*                      REQUESTS BY CLEARING BITS PREVIOUSLY     Y02669* 01032602
*                      SET IN THE APPROPIATE MONITOR AND        Y02669* 01032702
*                      TRACK CONTROL BLOCKS AND COMMON          Y02669* 01036802
*                      DATA AREAS:                              Y02669* 01040802
*                                                                     * 01044802
         EJECT                                                          01045202
*                      FOR STOPMN COMMAND SOURCE:               Y02669* 01045502
*                                                                     * 01045802
*                      SOURCE       CONTROL BLOCK  COMMON AREA  Y02669* 01046202
*                      -------      -------------  -----------  Y02669* 01049002
*                      INTERNALLY ISSUED UCME          BASEA    Y02669* 01050402
*                      INPUT STREAM      UCME          BASEA    Y02669* 01050802
*                      OPERATOR CONSOLE  UCME          BASEA    Y02669* 01051202
*                      TIME SHARING                             Y02669* 01051802
*                       (OPERATOR MODE)  MQE           BASEA    Y02669* 01051902
*                                                                     * 01053202
*                      AND STOPTR COMMAND SOURCE:               Y02669* 01054602
*                                                                     * 01056002
*                      SOURCE             CONTROL BLOCK         Y02669* 01057402
*                      -------            -------------         Y02669* 01059402
*                      INTERNALLY ISSUED  SACB (SCREEN AREA     Y02669* 01059802
*                      OPERATOR CONSOLE    CONTROL BLOCK)       Y02669* 01059902
*                                                                     * 01061002
*                      IEE5503D INTERFACES WITH COMMUNICATIONS  Y02669* 01077202
*                      TASK, IEAVMNTR (MONITOR QUEUE MANAGER),  Y02669* 01077602
*                      VIA THE MONITOR PARM LIST (IEZMPL)       Y02669* 01078402
*                      TO ADJUST THE APPROPIATE FIELDS IN UCME, Y02669* 01078802
*                      BASEA, AND MQE (MONITOR QUEUE ELEMENT)   Y02669* 01079602
*                      IN RESPONSE TO A STOP MONITOR JOBNAMES;  Y02669* 01080802
*                      STATUS; OR SESS COMMAND. THE VECTOR FOR  Y02669* 01080902
*                      IEAVMNTR IS FOUND IN THE UCM (UCMMNTR).  Y02669* 01081202
*                                                                     * 01082002
*                      THE TIME FIELD IN BASEA IS CLEARED, IN   Y02669* 01083202
*                      THIS MODULE, IF THERE ARE NO MORE ACTIVE Y02669* 01084402
*                      MONITOR JOBNAMES OR SESS REQUESTS WITH   Y02669* 01085602
*                      TIME OPTION.                             Y02669* 01086202
*                                                                     * 01086802
*                      THE FIELDS IN BASEA REPRESENTING MONITOR Y02669* 01087202
*                      SPACE AND DSNAME ARE ALSO CLEARED BY     Y02669* 01087602
*                      THIS MODULE.                             Y02669* 01087702
*                                                                     * 01087802
*                      THE FIELDS IN THE SACB, IEERDCM (SCREEN  Y02669* 01088002
*                      AREA CONTROL BLOCK), ARE ADJUSTED IN     Y02669* 01089202
*                      THIS MODULE IN RESPONSE TO A STOP TRACK  Y02669* 01090402
*                      COMMAND. (SEE EXITS)                     Y02669* 01091602
*                                                                     * 01092802
* NOTES                IF THE STOPMN COMMAND IS ENTERED THROUGH Y02669* 01094002
*                      THE INPUT STREAM OR ISSUED INTERNALLY,   Y02669* 01094402
*                      THE CONSOLE ID (XAU) WILL BE X'00'.      Y02669* 01094802
*                      THE MONITORING WILL OCCUR ON THE MASTER  Y02669* 01094902
*                      CONSOLE.                                 Y02669* 01095002
*                                                                       01095102
*                      WHEN THE ISSUING CONSOLE IS PART OF A    Y02669* 01095202
*                      COMPOSITE CONSOLE, XAU WILL CONTAIN THE  Y02669* 01095802
*                      CONSOLE ID OF THE INPUT DEVICE.          Y02669* 01096402
*                                                                     * 01097602
*   CHARACTER/CODE                                              Y02669* 01098202
*    DEPENDENCIES  =   ANY CHARACTER CODE OTHER THAN EBCDIC     Y02669* 01098802
*                      WILL REQUIRE REASSEMBLY OF THIS MODULE.  Y02669* 01100002
*                                                                     * 01100602
*    DEPENDENCIES  =   SVC 100 WILL NOT PERMIT ANY TIME         Y02669* 01101202
*                      SHARING USERS TO ISSUE STOPTR; OR STOPMN Y02669* 01102402
*                      DSNAME; OR SPACE.                        Y02669* 01102802
*                                                                     * 01104002
*                      IEE0403D TO RECOGNIZE THE STOPMN         Y02669* 01104802
*                      COMMAND AND ROUTE THE OPERAND            Y02669* 01106002
*                      INFORMATION IN XSA.                      Y02669* 01107202
*                                                                     * 01107302
*                      MONITOR QUEUE MANGER (IEAVMNTR) TO       Y02669* 01107602
*                      ADJUST THE PROPER BITS IN THE UCME,      Y02669* 01108002
*                      BASEA, AND MQE FOR STOP MONITOR          Y02669* 01108102
*                      JOBNAMES; STATUS; AND SESS.              Y02669* 01108202
*                                                                     * 01108402
*                      THE STAE EXIT FOR SVC 34 SHOULD EXPECT   Y02669* 01108802
*                      AN ABEND 077 FROM COMMUNICATIONS TASK    Y02669* 01109202
*                      (IEAVMNTR) IF THE IEZMPL PARM LIST       Y02669* 01109302
*                      CONTAINS INVALID INFORMATION.            Y02669* 01109402
*                                                                     * 01111402
*                      IEEBASEA, IEECUCM AND IEEXSA WILL BE     Y02669* 01119402
*                      UPDATED TO REFLECT THE NEW FIELDS.       Y02669* 01129402
*                                                                     * 01139202
*                      A MAPPING MACRO FOR IEZMPL MUST BE       Y02669* 01139602
*                      PROVIDED.                                Y02669* 01140002
*                                                                     * 01140102
*                      THE UCME UCMDISPK BIT WILL BE CHECKED   @Y02668P 01140203
*                      IF THE BIT IS ON THE CONSOLE IS A       @Y02668P 01140303
*                      SUBSYSTEM CONSOLE. PM JOBNAMES,STATUS   @Y02668P 01141403
*                      AND SESS ARE INVALID COMMANDS ON A      @Y02668P 01143603
*                      SUBSYSTEM CONSOLE                       @Y02668P 01145803
*                                                                     * 01146803
*                      IEE7503D TO RECOGNIZE THE STOPTR         Y02669* 01148003
*                      COMMAND AND SEND THE ROUTING             Y02669* 01149103
*                      INFORMATION AND THE ADDRESS OF THE       Y02669* 01150103
*                      APPROPIATE SACB IN THE XSA.              Y20669* 01151303
*                                                                     * 01152403
*                      IEE7503D WILL REJECT THE STORTR         @Y02668P 01153503
*                      COMMAND IF IT IS ISSUED TO OR ON        @Y02668P 01153703
*                      A SUBSYSTEM CONSOLE                     @Y02668P 01153903
*                                                                     * 01154103
*                      THE READER/INTERPRETER WILL REJECT AS    Y02669* 01154303
*                      INVALID THE STOPTR (PT) COMMAND FROM THE Y02669* 01154603
*                      THE INPUT STREAM.                        Y02669* 01155703
*                                                                     * 01156703
*                      TWO NEW WORDS WILL BE ADDED TO THE SACB  Y02669* 01157703
*                      (SCREEN AREA CONTROL BLOCK) IEERDCM TO   Y02669* 01158703
*                      ACCOMMODATE THE OPTIONS FIELDS FOR THE   Y02669* 01160103
*                      TRACK COMMAND OPERANDS AND A TRACK ECB.  Y02669* 01161203
*                                                                     * 01162303
*    RESTRICTIONS  =   TIME SHARING USERS ARE NOT PERMITTED     Y02669* 01163403
*                      TO ISSUE THE STOPTR COMMAND OR STOPMN    Y02669* 01164503
*                      DSNAME; OR SPACE. (SEE DEPENDENCIES).    Y02669* 01165603
*                                                                     * 01166703
*                      THE STOPTR COMMAND IS INVALID FROM THE   Y02669* 01167803
*                      INPUT STREAM.                            Y02669* 01168903
*                                                                     * 01170003
*    REGISTER/                                                  Y02669* 01171103
*     CONVENTIONS  =   IEE5503D WILL SUPPLY AN 18 WORD          Y02669* 01172203
*                      SAVE AREA POINTED TO BY REGISTER 13      Y02669* 01173303
*                      WHEN CALLING IEAVMNTR FOR STOPMN.        Y02669* 01174403
*                      THIS SAVE AREA IS PART OF THE XSA.       Y02669* 01175503
*                                                                     * 01176603
*    PATCH-LABEL   =   PATCH                                    Y02669* 01177703
*                                                                     * 01178803
* MODULE TYPE      =   CSECT                                    Y02669* 01179903
*                                                                     * 01181003
*    PROCESSOR     =   N/A                                      Y02669* 01182103
*                                                                     * 01183203
*    MODULE SIZE   =   X'318'                                 @ZA30198* 01184300
*                                                                     * 01185403
*    ATTRIBUTES    =   REENTRANT, KEY 0, SUPERVISOR MODE,       Y02669* 01186403
*                      PAGED LPA                                Y02669* 01187603
*                                                                     * 01188703
* ENTRY POINT      =   IEE5503D FROM IEE0403D                   Y02669* 01189803
*    PURPOSE       =   TO RESET BITS AS THE RESULT OF A         Y02669* 01190903
*                      STOPMN COMMAND.                          Y02669* 01192003
*    LINKAGE       =   BRANCH                                   Y02669* 01193103
*    INPUT DATA    =   REGISTER TWO ADDRESSES THE XSA           Y02669* 01194203
*                      XAL POINTS TO 1ST OPERAND IN BUFFER      Y02669* 01195303
*                      XAU CONTAINS A CONSOLE UCMI (X'00' -     Y02669* 01196403
*                      ISSUED INTERNALLY OR THRU INPUT STREAM)  Y02669* 01197503
*                      XAA CONTAINS AN ASID (X'0000' = NON-TS)  Y02669* 01198603
*                      XAR POINTS TO LENGTH FIELD OF BUFFER     Y02669* 01199703
*                      XAN CONTAINS VERB CODE X'38' - STOPMN    Y02669* 01200803
*                      XAV CONTAINS COMMAND VERB                Y02669* 01201903
*                                                                     * 01203003
* ENTRY POINT      =   IEE5503D FROM IEE7503D                   Y02669* 01204103
*    PURPOSE       =   TO RESET BITS AS THE RESULT OF A         Y02669* 01205203
*                      STOPTR COMMAND.                          Y02669* 01206303
*    LINKAGE       =   BRANCH                                   Y02669* 01207403
*    INPUT DATA    =   REGISTER TWO ADDRESSES THE XSA           Y02669* 01208503
*                      XAL POINTS TO 1ST OPERAND IN BUFFER      Y02669* 01209603
*                      XAU CONTAINS A CONSOLE IDENTIFIER        Y02669* 01210703
*                         (X'00' INDICATES INTERNALLY ISSUED)   Y02669* 01211803
*                      XAA CONTAINS X'0000'(INVALID FROM TS)    Y02669* 01212903
*                      XAS CONTAINS L=CCA INFORMATION           Y02669* 01214003
*                          XASCID - CONSOLE ID OR XAU           Y02669* 01215103
*                          XASDID - AREA ID IF CRT TARGET       Y02669* 01216203
*                          XASSDS - ON IF 'L=' ON COMMAND       Y02669* 01217303
*                          XASSDS5 - ON LOCKS HELD              Y02651* 01218403
*                      XAX CONTAINS X'00' EXCEPT THAT           Y02669* 01219503
*                          XAXSACB CONTAINS ADDRESS OF SACB     Y02669* 01220603
*                      XAR POINTS TO LENGTH FIELD OF BUFFER     Y02669* 01221703
*                      XAV CONTAINS COMMAND VERB                Y02669* 01222803
*                      XAN CONTAINS VERB CODE X'C8' - STOPTR    Y02669* 01223903
*                                                                     * 01225003
         EJECT                                                          01225803
* REGISTERS USAGE  =                                                  * 01227203
*    SAVED         =   REGISTER 14 SAVED IN XSA (XAS) FOR       Y02669* 01228303
*                        STOPMN AT COMINTER WHEN CALLING        Y02669* 01229403
*                        IEAVMNTR                               Y02669* 01230503
*                      REGISTERS 11 - 14 SAVED IN XSA           Y02651* 01231603
*                        (XASAVLOC) BEFORE ISSUING SETLOCK      Y02651* 01232703
*                        FOR STOPTR AT TRUPDATE & TRD0503D      Y02651* 01233803
*                                                                     * 01234903
*    CONTAINED     =   R0    0     USED FOR NIL MACRO           Y02651* 01236003
*                      R1    1     POINTER TO MONITOR PARM LIST Y02669* 01237103
*                                  USED FOR THE NIL MACRO       Y02651* 01238203
*                      R2    2     INPUT-BASE REG FOR XSA       Y02669* 01239303
*                      R3    3     BASE REG FOR CVT             Y02669* 01240403
*                      R4    4     POINTER TO OPERAND BUFFER    Y02669* 01241503
*                      R5    5     WORK REG, AND FOR NIL MACRO  Y02651* 01242603
*                      R6    6     ADDRESS COMPARE TABLE END    Y02669* 01243703
*                      R7    7     ADDRESS COMPARE TABLE ENTRY  Y02669* 01244803
*                      R8    8     BASE REG FOR UCM             Y02669* 01245903
*                      R9    9     CONTAINS ASID OR UCMI        Y02669* 01247003
*                      R10   10    BASE REG FOR BASEA           Y02669* 01248103
*                      R11   11    BASE REG FOR SACB            Y02669* 01249303
*                      R12   12    BASE REG FOR MODULE          Y02669* 01250303
*                      R13   13    SAVE AREA POINTER FOR STOPMN Y02669* 01251303
*                      R14   14    BALR AND RETURN REG          Y02669* 01252303
*                      R15   15    BALR AND BRANCH REG          Y02669* 01253303
*                                                                     * 01254303
*    RESTORE       =   REGISTER 14 RESTORED AT LABEL RETURN     Y02669* 01255303
*                        FOR STOPMN ONLY WHEN RETURNING FROM    Y02669* 01256303
*                        IEAVMNTR (NOT SAVED FOR STOPTR)        Y02669* 01257303
*                      REGISTERS 11 - 14 RESTORED FOR STOPTR    Y02651* 01259802
*                        AFTER ISSUING SETLOCK AT TRUPDATE &    Y02651* 01261002
*                        TRD0503D                               Y02651* 01262202
*                                                                     * 01263402
*  *  *  *  *  *  *  *  *  *  *  *  *  *  *  *  *  *  *  *  *  *  *  *  01264602
*                                                                     * 01265802
**EXIT - NORMAL    =   RETURN VIA BR R14 FROM DDSNAME           Y02669* 01267002
*    CONDITIONS    =   PM DSNAME REQUEST REGISTERED IN BASEA    Y02669* 01268202
*    OUTPUT DATA   =   BIT CLEARED IN BASEA                     Y02669* 01269402
*                        BAMONITR - BADSN X'80'                 Y02669* 01270602
*    RETURN CODES  =   NONE                                     Y02669* 01271802
*                                                                     * 01273002
*  *  *  *  *  *  *  *  *  *  *  *  *  *  *  *  *  *  *  *  *  *  *  *  01274202
*                                                                     * 01275402
**EXIT - NORMAL    =   RETURN VIA BR R14 FROM DDSPACE           Y02669* 01276602
*    CONDITIONS    =   PM SPACE REQUEST REGISTERED IN BASEA     Y02669* 01277802
*    OUTPUT DATA   =   BIT CLEARED IN BASEA                     Y02669* 01279002
*                        BAMONITR - BADSPACE X'40'              Y02669* 01280202
*    RETURN CODES  =   NONE                                     Y02669* 01281402
*                                                                     * 01282602
         EJECT                                                          01283802
*  *  *  *  *  *  *  *  *  *  *  *  *  *  *  *  *  *  *  *  *  *  *  *  01285002
*                                                                     * 01286202
**EXIT - NORMAL    =   BALR 14,15 TO IEAVMNTR FROM COMINTER     Y02669* 01287402
*    CONDITIONS    =   TO HAVE PM JOBNAMES; SESS; OR STATUS     Y02669* 01288602
*                      REQUEST REGISTERED BY COMM TASK          Y02669* 01289802
*    OUTPUT DATA   =   FIELDS SET IN MONITOR PARM LIST          Y02669* 01291002
*                      (IEZMPL), ORG'ED ON XAX, THE ADDRESS OF  Y02669* 01292202
*                      WHICH IS STORED IN XAR, WHICH IN TURN IS Y02669* 01293402
*                      POINTED TO BE REGISTER 1                 Y02669* 01294602
*                      (SEE DATA AREAS)                         Y02669* 01295802
*                      REG 13 POINTS TO 18 WORD SAVE AREA       Y02669* 01297002
*    RETURN CODES  =   NONE (HOWEVER, IEAVMNTR WILL ABEND ITS   Y02669* 01298202
*                      CALLER WITH AN '077' IF THE PARM LIST    Y02669* 01299402
*                      CONTAINS INVALID INFORMATION)            Y02669* 01300602
*                      (SEE DEPENDENCIES)                       Y02669* 01301802
*                                                                     * 01303002
*  *  *  *  *  *  *  *  *  *  *  *  *  *  *  *  *  *  *  *  *  *  *  *  01304202
*                                                                     * 01305402
**EXIT - NORMAL    =   RETURN VIA BR R14 FROM RETURN            Y02669* 01306602
*    CONDITIONS    =   PM JOBNAMES; SESS; OR STATUS REQUEST     Y02669* 01307802
*                      REGISTERED BY COMM TASK                  Y02669* 01309002
*    OUTPUT DATA   =   FIELDS ALTERED IN BASEA AND UCME AND     Y02669* 01310202
*                      MQE VIA COMM TASK.                       Y02669* 01311402
*                      IF THERE ARE NO ACTIVE MN JOBNAMES OR    Y02669* 01312602
*                      SESS REMAINING, THE TIME BIT IN BASEA    Y02669* 01313802
*                      IS CLEARED BY THIS MODULE.               Y02669* 01315002
*                        MSBTN - MSTN  X'02'                    Y02669* 01316202
*    RETURN CODES  =   NONE                                     Y02669* 01317402
*                                                                     * 01318602
*  *  *  *  *  *  *  *  *  *  *  *  *  *  *  *  *  *  *  *  *  *  *  *  01319802
*                                                                     * 01321002
**EXIT - NORMAL    =   RETURN VIA BR R14 FROM TRUPDATE          Y02669* 01322202
*    CONDITIONS    =   FOR STOPTR WHEN THERE IS STILL AN ACTIVE Y02669* 01323402
*                      OPTION TO TRACK IN THAT AREA (L=A)       Y02669* 01324602
*    OUTPUT DATA   =   SACB UPDATED AND LOCKS THAT WERE         Y02669* 01325802
*                        SET IN IEE7503D ARE RELEASED           Y02651* 01327002
*                      REG 2 POINTS TO XSA WITH:                Y02651* 01328202
*                        XASSDS5 - OFF - LOCKS RELEASED         Y02651* 01329402
*    RETURN CODES  =   NONE                                     Y02669* 01330602
*                                                                       01331802
         EJECT                                                          01333002
*  *  *  *  *  *  *  *  *  *  *  *  *  *  *  *  *  *  *  *  *  *  *  *  01334202
*                                                                     * 01335402
* EXIT - NORMAL    =   BRANCH TO IEE6703D FROM D6703D           Y02669* 01336602
*    CONDITIONS    =   FOR THE STOPTR COMMAND ONLY IF THE       Y02669* 01337802
*                      SCREEN NEEDS TO BE CLEARED (I.E.         Y02669* 01339002
*                      A STOPTR A HAS BEEN ISSUED OR AS THE     Y02669* 01340202
*                      RESULT OF THIS STOPTR THERE ARE NO       Y02669* 01341402
*                      ACTIVE OPTIONS TO TRACK IN THIS AREA.    Y02669* 01342602
*    OUTPUT DATA   =   REGISTER TWO ADDRESSES THE XSA           Y02669* 01343802
*                        XAL POINTS TO 1ST OPERAND IN BUFFER    Y02669* 01345002
*                        XAU CONTAINS A CONSOLE IDENTIFIER      Y02669* 01346202
*                           (X'00' INDICATES INTERNALLY ISSUED) Y02669* 01347402
*                        XAA CONTAINS X'0000'(INVALID FROM TS)  Y02669* 01348602
*                        XAS CONTAINS L=CCA INFORMATION         Y02669* 01349802
*                           XASCID - CONSOLE ID OR XAU          Y02669* 01351002
*                           XASDID = AREA ID                    Y02669* 01352202
*                           XASSDS = ON IF 'L=' ON COMMAND      Y02669* 01353402
*                           XASSDS5 = ON - LOCKS HELD           Y02651* 01354602
*                        XAR POINTS TO LENGTH FIELD OF BUFFER   Y02669* 01355802
*                        XAN CONTAINS VERB CODE X'C8' - STOPTR  Y02669* 01357002
*                        XAX CONTAINS ZERO EXCEPT FOR XAXSACB   Y02669* 01358202
*                           BITS CLEARED IN SACB FOR THE        Y02669* 01359402
*                           ASSOCIATED CONSOLE:                 Y02669* 01360602
*                        DCMATJOB & DCMATJBL = X'C0' FOR JOBS(J)Y02669* 01361802
*                        DCMATTS & DCMATTSL =  X'0C' FOR TS     Y02669* 01363002
*                        DCMATA & DCMATAL   =  X'CC' FOR A      Y02669* 01364202
*    RETURN CODES  =   NONE                                     Y02669* 01365402
*                                                                     * 01366602
*  *  *  *  *  *  *  *  *  *  *  *  *  *  *  *  *  *  *  *  *  *  *  *  01367802
*                                                                     * 01369002
* EXIT - ERROR     =   BRANCH TO IEE0503D FROM D0503D FOR       Y20669* 01370202
*                        1 - STOPMN                             Y02669* 01371402
*                        2 - STOPTR AFTER ALL LOCKS RELEASED    Y02651* 01372602
*    CONDITIONS    =   TO ISSUE MESSAGE 'IEE305I COMMAND        Y02669* 01373802
*                      INVALID', IF AN INVALID STOPMN OR        Y02669* 01375002
*                      STOPTR OPERAND IS FOUND.                 Y02669* 01376202
*                      TO ISSUE MESSAGE 'IEE311I PARAMETER      Y02669* 01377402
*                      MISSING', IF NO OPERAND IS FOUND IN      Y02669* 01378602
*                      THE COMMAND BUFFER.                      Y02669* 01379802
*                      TO ISSUE MESSAGE 'IEE777I INVALID      @Y02668P* 01380103
*                      FROM SUBSYSTEM CONSOLE' STOP MONITOR   @Y02668P* 01380403
*                      COMMAND ISSUED FROM A SUBSYSTEM        @Y02668P* 01380703
*    OUTPUT DATA   =   LOCKS RELEASED FOR STOPTR FUNCTION ONLY  Y02669* 01381002
*                      REG 2 POINTS TO XSA IN WHICH:            Y02669* 01382202
*                      XAE WILL CONTAIN  X'05' FOR IEE305I      Y02669* 01383402
*                                        X'11' FOR IEE311I      Y02669* 01384602
*                                        X'15' FOR IEE777I    @Y02668P* 01385203
*                      XAV STILL CONTAINS THE COMMAND VERB FOR  Y02669* 01385802
*                          THE MESSAGE.                         Y02669* 01387002
*                      XAU WILL STILL CONTAIN THE CONSOLE ID    Y02669* 01388202
*                      XAA WILL STILL CONTAIN ASID IF REQUESTER Y02669* 01389402
*                          IS TIME SHARING USER (STOPMN  ONLY)  Y02669* 01390602
*                      XASSDS5 = OFF LOCKS OFF (STOPTR ONLY)    Y02651* 01391802
*    RETURN CODES  =   NONE                                     Y02669* 01393002
*                                                                     * 01394202
*  *  *  *  *  *  *  *  *  *  *  *  *  *  *  *  *  *  *  *  *  *  *  *  01395402
*                                                                     * 01396602
* EXTERNAL                                                      Y02669* 01397802
*    REFERENCES                                                 Y02669* 01399002
*                                                                     * 01400202
*    ROUTINES      =   BALR TO COMMUNICATION TASK TO ADJUST     Y02669* 01401402
*                      FIELDS IN BASEA, UCME AND MQE WITH       Y02669* 01402602
*                      REG 1 POINTING TO THE ADDRESS OF THE     Y02669* 01403802
*                      MONITOR PARM LIST                        Y02669* 01405002
*                      REG 13 POINTING TO REG SAVE AREA IN XSA  Y02669* 01406202
*                                                                     * 01407402
*                      BRANCH TO   IEE6703D    IEE0503D         Y02669* 01408602
*                                                                     * 01409802
*    DATA AREAS    =   IEZMPL - PARAMTER LIST FOR MONITOR       Y02669* 01411002
*                      ( ORG XAX MAPPED BY IEZMPL AND THE       Y02669* 01412202
*                        ADDR OF WHICH IS STORED IN XAR AND     Y02669* 01413402
*                        POINTED TO BE REGISTER 1)              Y02669* 01413802
*                       MPLPROC  DS  H     PROCESSING FLAGS     Y02669* 01414602
*                       MPLCONS  EQU X'80'  MPLID = CONSOLE ID  Y02669* 01415802
*                       MPLTERM  EQU X'40'  MPLID = ASID        Y02669* 01417002
*                       MPLSTRT  EQU X'20'  START MONITOR       Y02669* 01418202
*                       MPLSTOP  EQU X'10'  STOP MONITOR        Y02669* 01419402
*                       MPLID    DS  H     CONSOLE ID/ASID      Y02669* 01420602
*                       MPLTYPE  DS  H     MONITOR TYPE FLAGS   Y02669* 01421802
*                       MPLJBNM  EQU X'80'  MN JOBNAMES         Y02669* 01423002
*                       MPLSTAT  EQU X'40'  MN STATUS           Y02669* 01424202
*                       MPLSESS  EQU X'04'  MN SESSIONS         Y02669* 01425402
*                       MPLRSV10 DS  H     RESERVED             Y02669* 01426602
*                                                                     * 01427802
*   DATA AREAS   = PSEUDO-SACB TO BE USED THROUGHOUT SVC 34     Y02669* 01429002
*                    ORG   XAX                                  Y02669* 01430202
*                  XAXMASK  DS    C       REQUEST FLAGS         Y02669* 01431402
*                  XAXJOBS  EQU   X'80'   JOBS      (J)         Y02669* 01432602
*                  XAXJOBSL EQU   X'40'   JOBS,LIST (J,L)       Y02669* 01433802
*                  XAXTS    EQU   X'08'   TS        (TS)        Y02669* 01435002
*                  XAXTSL   EQU   X'04'   TS,LIST   (TS,L)      Y02669* 01436202
*                  XAXA     EQU   X'88'   A         (A)         Y02669* 01437402
*                  XAXAL    EQU   X'44'   A,LIST    (A,L)       Y02669* 01438602
*                  XAXFREE  DS    C       RESERVED              Y02669* 01439802
*                  XAXUTME  DS    H       UTME=NNN VALUE        Y02669* 01441002
*                  XAXSACB  DS    F       ADDRESS OF SACB       Y02669* 01442202
*                                                                     * 01443402
         EJECT                                                          01443802
*   DATA AREAS  =  SACB (SCREEN AREA CONTROL BLOCK)             Y02669* 01444602
*                  DCMADFLG DS   XL1      DYNAMIC DISPLAY FLAGS Y02669* 01445802
*                  DCMADD   EQU  X'80'    TRACK IN AREA         Y02669* 01447002
*                  DCMAHOLD EQU  X'40'    TRACK IN HOLD MODE    Y02669* 01448202
*                  DCMATRCK DS   X        REQUEST INDICATORS    Y02669* 01449402
*                  DCMATJOB EQU  X'80'    JOBS       (J)        Y02669* 01450602
*                  DCMATJBL EQU  X'40'    JOBS,LIST  (J,L)      Y02669* 01451802
*                  DCMATTS  EQU  X'08'    TS         (TS)       Y02669* 01453002
*                  DCMATTSL EQU  X'04'    TS,LIST    (TS,L)     Y02669* 01454202
*                  DCMATA   EQU  X'88'    A          (A)        Y02669* 01455402
*                  DCMATAL  EQU  X'44'    A,LIST     (A,L)      Y02669* 01456602
*                  DCMAUTME DS   XL2      UTME=NNN VALUE        Y02669* 01457802
*                  DCMATECB DS   F        TRACK CANCEL ECB ADDR Y02669* 01459002
*                                                                     * 01460202
*    CONTROL BLOCKS=   IEERDCM                                  Y02669* 01461402
*                       (SACB)     W  -  CLEAR BITS FOR STOPTR  Y02669* 01462602
*                      CVT         R  -  ADDRESS BASEA AND UCM  Y02669* 01463802
*                      IEEBASEA    R  -  # ACTIVE MN JOBS; SESS Y02669* 01465002
*                                  W  -  CLEAR TIME/DSNAME/     Y02669* 01466202
*                                        SPACE FLAGS            Y02669* 01467402
*                      IEEXSA      R  -  INPUT                  Y02669* 01468602
*                                  W  -  MONITOR PARM LIST      Y02669* 01469802
*                      IEECUCM     R  -  VECTOR FOR IEAVMNTR    Y02669* 01471002
*                      IEZMPL      W  -  INPUT TO IEAVMNTR      Y02669* 01471402
*                      IHAPSA         -  NECESSARY FOR SETLOCK  Y02651* 01471802
*                                                                     * 01472202
*    TABLES        =   TWO COMPARE TABLES ARE USED TO DETERMINE Y02669* 01473402
*                      THE VALIDITY OF THE OPERAND ON THE       Y02669* 01474602
*                      STOPMN AND STOPTR COMMANDS.              Y02669* 01475802
*                      THE FORMAT OF EACH ENTRY IS THE SAME     Y02669* 01477002
*                                                                     * 01478202
*                      DLEN   DC   AL1(L'XXX-1) - LENGTH OF     Y02669* 01479402
*                                              SPECIFIC OPERAND Y02669* 01480602
*                      XXX    DC   C'YYYYY' - CHARACTER OPERAND Y02669* 01481802
*                                             REPRESENTATION    Y02669* 01483002
*                                                                     * 01484202
*                      DLEN AND 'XXX' ARE USED IN AN EX OF A    Y02669* 01485402
*                      CLC. IF THE OPERAND MATCHES WITH THE     Y02669* 01486602
*                      ENTERED OPERAND, A BRANCH IS TAKEN TO    Y02669* 01487802
*                      EITHER HANDLE THE COMMAND IN THIS MODULE Y02669* 01489002
*                      OR ELSE TO BUILD A PARM LIST AND BALR    Y02669* 01490202
*                      TO IEAVMNTR(STOPMN) OR IEE6703D(STOPTR). Y02669* 01491402
*                      OTHERWISE, THE REGISTER USED TO ADDRESS  Y02669* 01492602
*                      THE TABLE IS INCREMENTED BY TWO + THE    Y02669* 01493802
*                      VALUE OF DLEN TO REACH THE NEXT TABLE    Y02669* 01495002
*                      ENTRY.                                   Y02669* 01496202
*                                                                     * 01497402
         EJECT                                                          01497802
*                      TWO BRANCH TABLES ARE USED IN CONNECTION Y02669* 01498602
*                      WITH THE COMPARE TABLES. THEY CONSIST    Y02669* 01499802
*                      OF BRANCHES TO THE PROPER OPERAND        Y02669* 01507702
*                      PROCESSORS. AN INDEX REGISTER IS         Y02669* 01515602
*                      MAINTAINED THROUGHOUT THE SCAN OF THE    Y02669* 01523502
*                      COMPARE TABLE. THIS IS USED AT DBRANCH   Y02669* 01531402
*                      FOR STOPMN AND MATCHTR FOR STOPTR        Y02669* 01533402
*                      TO GIVE CONTROL TO THE INDICATED         Y02669* 01539302
*                      PROCESSOR VIA THE BRANCH TABLE.          Y02669* 01547202
*                                                                     * 01555102
*    MACROS        =   MODID                                    Y02669* 01563002
*                      NIL - SERIALIZATION FOR BASEA BITS       Y02651* 01570902
*                      SETLOCK - CMS AND LOCAL LOCKS RELEASED   Y02651* 01578802
*                                                                     * 01586702
*    SERIALIZATION =   BASEA - NIL FOR TIME/DSNAME/SPACE FIELDS Y02651* 01594602
*                      SACB - SETLOCK FOR STOPTR                YO2651* 01596602
*                                                                     * 01602502
*    ENQUEUE                                                    Y02669* 01610402
*     RESOURCES    =   NONE                                     Y02669* 01618302
*                                                                     * 01626202
*    LOCKS HELD    =   SACB  - CMS AND LOCAL LOCKS OBTAINED BY  Y02651* 01634102
*                              IEE7503D FOR STOPTR, ARE HELD    Y02651* 01642002
*                              THROUGH THIS MODULE AND ARE      Y02651* 01649902
*                              RELEASED BY IEE6703D EXCEPT:     Y02651* 01657802
*                                 1. FOR SYNTAX ERRORS THEN     Y02651* 01659802
*                                    THEY WILL BE RELEASED AT   Y02651* 01665702
*                                    TRD0503D BEFORE BRANCHING  Y02651* 01667702
*                                    TO IEE0503D.               Y02651* 01669702
*                                 2. OR IF SOME TRACK OPTION    Y02651* 01673602
*                                    IS STILL ACTIVE ON THAT    Y02651* 01681502
*                                    SCREEN THEN THEY WILL BE   Y02651* 01683502
*                                    RELEASED BEFORE RETURNING  Y02651* 01685502
*                                    AT TRUPDATE.               Y02651* 01689402
*                              WHEN RELEASED XASSDS5 WILL BE    Y02561* 01697302
*                              TURNED OFF.                      Y02651* 01705202
*                                                                     * 01713102
*    CHANGE LEVEL  =   Y02669, ZA30198                        @ZA30198* 01721000
*                      Y02651                                   Y02651* 01728902
*                      YM1911 (PROLOGUE & COMMENT CHANGES ONLY) YM1911* 01731902
*                      Y02668                                 @Y02668P* 01736803
* MESSAGES         =   THE FOLLOWING MESSAGES ARE CONTAINED IN  Y02669* 01744702
*                      AND ISSUED FROM IEE0503D:                Y02669* 01745702
*                                                                     * 01746702
*                       MSGID    CODE    MESSAGE TEXT           Y02669* 01747702
*                       _____    ____    ____________           Y02669* 01748702
*                      IEE305I   X'05'   COMMAND INVALID        Y02669* 01749702
*                      IEE311I   X'11'   PARAMETER MISSING      Y02669* 01750702
*                      IEE777I   X'15'   INVALID FROM SUBSYSTEM       * 01752603
*                                        CONSOLE              @Y02668P* 01755603
* SYSGEN           =   INCLUDED WITH SVC 34 IN LOAD MODULE      Y02669* 01760502
*                      IGC0003D, DLIB AOSB3, MACRO SGIEF441,    Y02669* 01768402
*                      TARGLIB LPALIB.                          Y02669* 01776302
*                                                                     * 01784202
* SYSTEM LIBRARIES =   NONE                                     Y02669* 01792102
*********************************************************************** 01800002
* C MATCH - TEST FOR ZERO CONSOLE ID                          @ZA30198* 01850000
         EJECT                                                          18600020
IEE5503D CSECT                                                          18650002
*********************************************************************** 18700002
*                                                                     * 18750002
*                   SYMBOLIC REGISTER EQUATES                    Y02669 18900002
*                                                                     * 18910002
*********************************************************************** 18950002
R0       EQU   0                       USED FOR THE NIL MACRO    Y02651 19200002
R1       EQU   1                       ADDRESS OF MN PARM LIST   Y02669 19500002
*                                      USED FOR THE NIL MACRO    Y02651 19510002
R2       EQU   2                       BASE REG FOR XSA                 19800020
R3       EQU   3                       BASE REG FOR CVT                 20100002
R4       EQU   4                       POINTER TO OPERAND BUFFER Y02669 20400002
R5       EQU   5                       WORK REGISTER, NIL MACRO  Y02651 20450002
R6       EQU   6                       ADDRESS END OF TABLE      Y02669 20500002
R7       EQU   7                       USED TO ADDR TAB ENTRIES  Y02669 20550002
R8       EQU   8                       BASE REG FOR UCM          Y02669 21600002
R9       EQU   9                       CONTAINS ASID OR UCMI     Y02669 21900002
R10      EQU   10                      BASE REG FOR BASEA               22200020
R11      EQU   11                      BASE REG FOR SACB         Y02669 22500002
R12      EQU   12                      BASE REG FOR PROGRAM             22800020
R13      EQU   13                      PTR TO SAVE AREA FOR PM   Y02669 23100002
R14      EQU   14                      USED FOR BALR AND RETURN  Y02669 23400002
R15      EQU   15                      USED FOR BALR AND BRANCH  Y02669 23700002
         EJECT                                                          23710002
*********************************************************************** 23750002
*                                                                     * 23800002
*                      DISPLACEMENTS AND LENGTHS                 Y02669 23850002
*                                                                     * 23900002
*********************************************************************** 23950002
D0       EQU   0                       OFFSETS,LENGTHS,ETC.             24000002
D1       EQU   1                        *                               24300020
D2       EQU   2                        *                         20030 24310020
D4       EQU   4                        *                         21002 24320002
L8       EQU   8                        *                        Y02669 24350002
*********************************************************************** 24360002
*                                                                     * 24370002
*                             MASKS                              Y02669 24372002
*                                                                     * 24374002
*********************************************************************** 24376002
OFF      EQU   X'00'                   ALL TRACK OPTIONS OFF     Y02669 24380002
FF       EQU   X'FF'                   MASK FOR NI                      24430002
M7       EQU   7                       MASK FOR ADDRESS IN ICM   Y02669 24440002
*********************************************************************** 24480002
*                                                                     * 24530002
*                          VERB CODES                            Y02669 24580002
*                                                                     * 24590002
*********************************************************************** 24600002
PT       EQU   X'C8'                   STOPTR VERB CODE          Y02669 24610002
*********************************************************************** 24612002
*                                                                     * 24614002
*                          ERROR CODES                           Y02669 24616002
*                                                                     * 24618002
*********************************************************************** 24618402
ERR305   EQU   X'05'                   IEE305I-COMMAND INVALID   Y02669 24620002
ERR311   EQU   X'0B'                   IEE311I-MISSING PARM      Y02669 24650002
ERR777   EQU   X'15'                   IEE777I-SUBSYSTEM CONSL @Y02668P 25050003
         EJECT                                                          25500002
*********************************************************************** 25550002
*            ESTABLISH ADDRESSABILITY FOR MODULE                 Y02669 25650002
*********************************************************************** 25750002
         BALR  R12,D0             ESTABLISH CSECT -                     26100002
         USING *,R12              - ADDRESSABILITY                      26400002
         MODID BRANCH=YES                                        Y01886 26450001
         SPACE 2                                                        26500002
*********************************************************************** 26550002
*            ESTABLISH ADDRESSABILITY FOR XSA                    Y02669 26600002
*  IF ENTERED FOR STOP TRACK COMMAND, BRANCH TO THAT SECTION     Y02669 26610002
*  OTHERWISE, GET ADDRESS OF STOP MONITOR OPERANDS               Y02669 26620002
*  ERR - IEE311I PARAMETER MISSING - IF NO OPERANDS              Y02669 26630002
*********************************************************************** 26650002
         USING XSA,R2             EXTENDED SAVE AREA             Y02669 26700002
         CLI   XAN,PT             IF STOPTR BEING PORCESSED      Y02651 26710002
         BE    STOPTR             GO PROCESS STOPTR OPERANDS     Y02651 26720002
         SPACE                                                          26730002
         SR    R4,R4              CLEAR REGISTER                 Y02669 26750002
         ICM   R4,M7,XAL+1        GET 3 BYTE ADDR OF OPERANDS    Y02669 26800002
         BZ    DERR311            NONE, ERR-IEE311 MISSING PARM  Y02669 26960002
         EJECT                                                          26994402
*********************************************************************** 26996002
*                                                                     * 26996402
*                            STOPMN                              Y02669 26996802
* LOOP THROUGH STOPMN COMPARE TABLE LOOKING FOR VALID OPERAND    Y02669 26996902
*                                                                     * 26997202
*********************************************************************** 26998002
         SPACE                                                          26998102
         SR    R5,R5              CLEAR REG FOR OPERAND LENGTH   Y02669 26999202
         SR    R15,R15            USED TO INDEX BRANCH TABLE     Y02669 26999602
         LA    R6,PARMTABN        ADDR LAST COMPARE TABLE ENTRY  Y02669 26999902
         LA    R7,PARMTAB         ADDR FIRST COMAPRE TABLE ENTRY Y02669 27033302
         USING PARMLEN,R7         ESTABLISH ADDRESSABILITY       Y02669 27049902
LOOP     EQU   *                  MATCH CMD OPERAND WITH ENTRIES Y02669 27069902
         IC    R5,PARMLEN         LENGTH OF COMPARE TABLE ENTRY  Y02669 27089902
         EX    R5,COMPARE         COMPARE OPERAND WITH ENTRY     Y02669 27093902
         BE    MATCH              IF MATCH, PROCESS ACCORDINGLY  Y02669 27096302
         LA    R7,D2(R5,R7)       ELSE INCREMENT TABLE POINTER   Y02669 27096702
         LA    R15,D4(R15)        INCREMENT BRANCH TABLE INDEX   Y02669 27097102
         CR    R7,R6              HAS LAST TABLE ENTRY TESTED?   Y02669 27097902
         BL    LOOP               NO, TEST NEXT TABLE ENTRY      Y02669 27098402
         DROP  R7                 NECESSARY TO RE-EST BASR REG   Y02669 27098502
         B     DERR305            ERROR, IEE305I COMMAND INVALID Y02669 27098702
         SPACE  2                                                       27197802
*********************************************************************** 27197902
*                                                                     * 27198002
* WHEN VALID MATCH IS FOUND ADDRESS CONTROL BLOCKS AND BRANCH    Y02669 27198102
* THEN CHECK, IF THE ISSUING CONSOLE IS JES3 THEN THE          @Y02668P 27208103
* COMMAND IS INVALID                                           @Y02668P 27218103
*                                                                     * 27232002
*********************************************************************** 27242002
         SPACE 2                                                        27252002
MATCH    EQU   *                                                 Y02669 27266102
         L     R3,CVTPTR          GET CVT ADDR                   Y02669 27300002
         USING CVT,R3             CVT ADDRESSABILITY             Y02669 27350002
         L     R10,CVTMSER        MASTER RESIDENT CORE ADDRESS   Y02669 27352002
         USING BASE,R10           BASEA ADDRESSABILITY           Y02669 27360002
         L     R8,CVTCUCB         GET ADDRESS OF UCM FROM CVT    Y02669 27410002
         USING UCM,R8             UCM ADDRESSABILITY             Y02669 27460002
         DROP  R3                                                Y02669 27510002
         USING UCMLIST,R9         EST. UCME ADDRESSABILITY     @Y02668P 27515003
         L     R9,UCMVEA          ADDRESS OF THE FIRST UCME    @Y02668P 27520003
         SR    R5,R5              ZERO OUT REG 5               @Y02668P 27521003
         IC    R5,XAU             CONSOLE ID                   @Y02668P 27522003
         LTR   R5,R5              INTERNAL,INPUT CMND SOURCE?  @ZA30198 27524000
         BZ    CONTINUE           YES,DEFAULT TO MSTR CONS.    @ZA30198 27526000
         BCTR  R5,D0              SUBTRACT ONE FROM CONSOLE ID @Y02668P 27530003
         M     R4,UCMVEZ          DISPLACEMENT OF UCME         @Y02668P 27535003
         AR    R9,R5              ADD TO FIRST UCME            @Y02668P 27540003
         TM    UCMDISP2,UCMDISPK  IS THIS A SUBSYSTEM CONSOLE  @Y02668P 27545003
         BZ    CONTINUE           NOT SUBSYSTEM CONSOLE        @Y02668P 27550003
         MVI   XAE,ERR777         ERROR CODE = 15              @Y02668P 27551003
CONTINUE EQU   *                                               @Y02668P 27552003
         DROP  R9                                              @Y02668P 27555003
         SR    R9,R9              CLEAR FOR CONSOLE TESTING      Y02669 27560002
         LH    R9,XAA             LOAD ASID INTO REG 9           Y02669 27900002
         XC    XAX(L8),XAX        CLEAR AREA IN XSA FOR MNTRPL   Y02669 27902002
         LA    R1,XAX             GET ITS ADDRESS AND            Y02669 27910002
         USING MPL,R1             ORG IEEMPL TO XAX              Y02669 27920002
         B     BRTABLE(R15)       BRANCH TO PROPER PROCESSOR     Y02669 27950002
         EJECT                                                          28994402
*********************************************************************** 29494402
*                                                                     * 29544402
*                    STOP MONITOR JOBNAMES                       Y02669 29594402
*          BUILD PARAMETER LIST FOR COMMUNICATIONS TASK          Y02669 29644402
*                                                                     * 29654402
*********************************************************************** 29694402
         SPACE                                                          29744402
DDJOB    EQU   *                                                 Y02669 29794402
         LTR   R9,R9              TEST FOR COMMAND SOURCE        Y02669 29844402
         BZ    DDJOB2             BRANCH - NOT TIME SHARING USER Y02669 29894402
         OI    MPLPROC1,MPLTERM+MPLSTOP     STOP MN WITH ASID    Y02669 29944402
         OI    MPLTYPE1,MPLJBNM   JONAMES OPTION                 Y02669 29994402
         B     COMINTER           GO TO COMMUNICATIONS TASK      Y02669 30044402
         SPACE                                                          30094402
DDJOB2   EQU   *                                                 Y02669 30144402
         CLI   XAE,ERR777         ?SUBSYSTEM CONSOLE           @Y02668P 30154403
         BE    DERR777            YES, BRANCH COMMAND INVALID  @Y02668P 30164403
         OI    MPLPROC1,MPLCONS+MPLSTOP     STOP MN WITH CONS ID Y02669 30194402
         OI    MPLTYPE1,MPLJBNM   JOBNAMES OPTION                Y02669 30244402
         IC    R9,XAU             GET CONSOLE ID                 Y02669 30294402
         B     COMINTER           GO TO COMMUNICATIONS TASK      Y02669 30344402
         EJECT                                                          30394402
*********************************************************************** 30894402
*                                                                     * 30944402
*                     STOP MONITOR SESS                          Y02669 30994402
*          BUILD PARAMETER LIST FOR COMMUNICATIONS TASK          Y02669 31004402
*                                                                     * 31044402
*********************************************************************** 31094402
         SPACE                                                          31144402
DDSES    EQU   *                                                 Y02669 31194402
         LTR   R9,R9              TEST FOR COMMAND SOURCE        Y02669 31244402
         BZ    DDSES2             BRANCH - NOT TIME SHARING USER Y02669 31294402
         OI    MPLPROC1,MPLTERM+MPLSTOP     STOP MN WITH ASID    Y02669 31344402
         OI    MPLTYPE1,MPLSESS   SESSIONS OPTION                Y02669 31394402
         B     COMINTER           GO TO COMMUNICATIONS TASK      Y02669 31444402
         SPACE                                                          31494402
DDSES2   EQU   *                                                 Y02669 31544402
         CLI   XAE,ERR777         ?SUBSYSTEM CONSOLE           @Y02668P 31554403
         BE    DERR777            YES, BRANCH COMMAND INVALID  @Y02668P 31564403
         OI    MPLPROC1,MPLCONS+MPLSTOP     STOP MN WITH CONS ID Y02669 31594402
         OI    MPLTYPE1,MPLSESS   SESSIONS OPTION                Y02669 31644402
         IC    R9,XAU             GET CONSOLE ID                 Y02669 31694402
         B     COMINTER           GO TO COMMUNICATIONS TASK      Y02669 31744402
         EJECT                                                          31794402
*********************************************************************** 31844402
*                                                                     * 31894402
*                      STOP MONITOR STATUS                       Y02669 31944402
*          BUILD PARAMETER LIST FOR COMMUNICATIONS TASK          Y02669 31954402
*                                                                     * 31994402
*********************************************************************** 32044402
         SPACE                                                          32094402
DDSTAT   EQU   *                                                 Y02669 32144402
         LTR   R9,R9              TEST FOR COMMAND SOURCE        Y02669 32194402
         BZ    DDSTAT2            BRANCH - NOT TIME SHARING USER Y02669 32244402
         OI    MPLPROC1,MPLTERM+MPLSTOP     STOP MN WITH ASID    Y02669 32294402
         OI    MPLTYPE1,MPLSTAT   STATUS OPTION                  Y02669 32344402
         B     COMINTER           GO TO COMMUNICATIONS TASK      Y02669 32394402
         SPACE                                                          32444402
DDSTAT2  EQU   *                                                 Y02669 32494402
         CLI   XAE,ERR777         ?SUBSYSTEM CONSOLE           @Y02668P 32504403
         BE    DERR777            YES, BRANCH COMMAND INVALID  @Y02668P 32514403
         OI    MPLPROC1,MPLCONS+MPLSTOP     STOP MN WITH CONS ID Y02669 32544402
         OI    MPLTYPE1,MPLSTAT   STATUS OPTION                  Y02669 32594402
         IC    R9,XAU             GET CONSOLE ID                 Y02669 32644402
         B     COMINTER           GO TO COMMUNICATIONS TASK      Y02669 32694402
         EJECT                                                          55760002
*********************************************************************** 55762002
*                                                                     * 55764002
*                      STOP MONITOR DSNAME                       Y02669 55766002
*           TURN OFF MONITOR DSNAME BIT IN BASEA AND RETURN      Y02669 55766402
*                                                                     * 55768002
*********************************************************************** 55768402
         SPACE                                                          55768802
DDSNAME  EQU   *                                                 Y02669 55778802
         NIL   BAMONITR,FF-BADSN,WREGS=(0,1,5),REF=BASE                *55790002
                                  CLEAR MN DSNAME BIT IN BASEA   Y02651 55790402
         BR    R14                RETURN                         Y02669 55804402
         EJECT                                                          55807602
*********************************************************************** 55810802
*                                                                     * 55814002
*                      STOP MONITOR SPACE                        Y02669 55817202
*           TURN OFF MONITOR SPACE BIT IN BASEA AND RETURN       Y02669 55820402
*                                                                     * 55823602
*********************************************************************** 55826802
         SPACE                                                          55830002
DDSPACE  EQU   *                                                 Y02669 55833202
         NIL   BAMONITR,FF-BASPACE,WREGS=(0,1,5),REF=BASE              *55836402
                                  CLEAR MN SPACE BIT IN BASEA    Y02651 55839602
         BR    R14                RETURN                         Y02669 55842802
         EJECT                                                          55846002
*********************************************************************** 55849202
*                                                                     * 55859202
*        GO TO COMM TASK VIA BALR 14,15 TO RESET THE APPROPIATE  Y02669 55859302
*        MONITOR FILEDS IN THE APPROPIATE CONTROL BLOCKS.        Y02669 55859402
*             R1 CONTAINS ADDRESS OF XAR WHICH IN TURN           Y02669 55859502
*                POINTS TO IEZMPL (MONITOR PARM LIST)            Y02669 55859602
*             R13 CONTAINS ADRRESS OF THE SAVE AREA IN THE XSA   Y02669 55861502
*             R15 CONTAINS ADDRESS OF IEAVMNTR FROM UCM          Y02669 55869202
*                                                                     * 55912202
*********************************************************************** 55915402
         SPACE   2                                                      55918602
COMINTER EQU   *                                                 Y02669 55921802
         STH   R9,MPLID           GET ASID OR CONSOLE ID         Y02669 55925002
         ST    R14,XAS            SAVE REG 14 - RETURN ADDR      Y02669 55928202
         LA    R13,XASAVSTD       GET ADDRESS OF SAVE AREA       Y02669 55931402
         ST    R1,XAR             PUT ADDR OF MNTRPL IN XAR AND  Y02669 55934602
         LA    R1,XAR             PASS ADDR OF XAR TO COMM TASK  Y02669 55937802
         L     R15,UCMMNTR        GET ADDRESS OF COMM TASK MOD   Y02669 55941002
         BALR  R14,R15            HAVE FIELDS SET BY COMM TASK   Y02669 55944202
         EJECT                                                          55947402
*********************************************************************** 55950602
*                                                                     * 55953802
*        UPON RETURN FROM IEAVMNTR (THERE ARE NO RETURN CODES)   Y02669 55955802
*        IF NO CONSOLE OR TS TERMINAL IN OPERATOR MODE IS        Y02669 55957002
*        MONITORING JOBNAMES OR SESS, THE SYSTEM TIME BIT IN     Y02669 55962302
*        BASEA IS CLEARED. REGARDLESS, AFTER RESTORING REGISTER  Y02669 55968002
*        14 FROM THE XAS, CONTROL IS RETURNED VIA REGISTER 14.   Y02669 55970002
*                                                                     * 55973702
*********************************************************************** 55979402
         SPACE                                                          55981402
         SR    R5,R5                                             Y02669 55985102
         CH    R5,BAJNCNT         ANY ACTIVE MN JOBNAMES?        Y02669 56186002
         BL    RETURN             IF ONE IS ON, RETURN         @YM4797P 56236002
         CH    R5,BASESCT         ANY ACTIVE MN SESSIONS?        Y02669 56246002
         BL    RETURN             IF ONE IS ON, RETURN         @YM4797P 56256002
         NIL   MSBTN,FF-MSTN,WREGS=(0,1,5),REF=BASE                    *56286002
                              ALL OFF, CLEAR BASEA SYSTEM TIME   Y02651 56296002
RETURN   EQU   *                                                 Y02669 56336002
         L     R14,XAS            RESTORE RETURN ADDRESS         Y02669 56338002
         BR    R14                RETURN TO CALLER               Y02669 56340002
         EJECT                                                          56346002
*********************************************************************** 56348002
*                                                                     * 56348102
*                             STOPTR                             Y02669 56348402
* LOOP THROUGH STOPTR COMPARE TABLE LOOKING FOR VALID OPERAND    Y02669 56350002
*    CMS AND LOCAL LOCKS ARE HELD ON ENTRY FROM IEE7503D         Y02651 56350102
*                                                                     * 56350402
*********************************************************************** 56352002
         SPACE                                                          56354002
STOPTR   EQU   *                                                 Y02669 56356002
         SR    R4,R4              CLEAR REGISTER                 Y02651 56366002
         ICM   R4,M7,XAL+1        GET 3 BYTE ADDRESS OF OPERANDS Y02651 56376002
         BZ    TRERR311           NONE, ERR-IEE311I MISSING PARM Y02651 56378002
         SPACE                                                          56380002
         SR    R5,R5              CLEAR REG FOR OPERAND LENGTH   Y02669 56386002
         SR    R15,R15            CLEAR BR TABLE INDEX REGISTER  Y02669 56436002
         LA    R6,PARMTA2N        ADDR LAST COMPARE TABLE ENTRY  Y02669 56586002
         LA    R7,PARMTAB2        ADDR FIRST COMPARE TABLE ENTRY Y02669 56636002
         USING PARMLEN2,R7        ESTABLISH ADDRESSABILITY       Y02669 56686002
LOOPTR   EQU   *                  MATCH CMD OPERAND WITH ENTRIES Y02669 56736002
         IC    R5,PARMLEN2        LENGTH OF COMPARE TABLE ENTRY  Y02669 56786002
         EX    R5,COMPARE         COMPARE CMD OPERAND WITH ENTRY Y02669 56836002
         BE    MATCHTR            IF MATCH, PROCESS ACCORDINGLY  Y02669 56886002
         LA    R7,D2(R5,R7)       INCREMENT TABLE POINTER        Y02669 85153802
         LA    R15,D4(R15)        INCREMENT BRANCH TABLE INDEX   Y02669 85153902
         CR    R7,R6              HAS LAST TABLE ENTRY TESTED?   Y02669 85154502
         BL    LOOPTR             NO, TEST NEXT TABLE ENTRY      Y02669 85156502
         DROP  R7                 NECESSARY TO RE-EST BASR REG   Y02669 85158502
         B     TRERR305           ERROR, IEE305I COMMAND INVALID Y02651 85159802
         SPACE  5                                                       85161502
*********************************************************************** 85161902
*                                                                     * 85162002
*     GET ADDRESS OF SACB FROM XSA (XAXSACB) INPUT FROM IEE7503D Y02669 85162202
*                                                                     * 85164202
*********************************************************************** 85168002
         SPACE                                                          85168402
MATCHTR  EQU   *                                                 Y02669 85170002
         L     R11,XAXSACB        GET ADDRESS OF SACB PASSED BY  Y02669 85170402
         USING DCMACB,R11         IEE7503D                       Y02669 85172002
         B     TRKBRTAB(R15)      GO TO PROPER PROCESSOR         Y02669 85178002
         EJECT                                                          85178402
*********************************************************************** 85181202
*                                                                     * 85181302
*                         STOP TRACK JOBS                        Y02669 85181402
*            TURN OFF JOBS AND JOBS,LIST FLAGS IN SACB           Y02669 85182402
*                      J          J,L                            Y02669 85182802
*                                                                     * 85183902
*********************************************************************** 85184902
         SPACE                                                          85185302
TRKJOBS  EQU   *                                                 Y02669 85185902
         NI    DCMATRCK,FF-(DCMATJOB+DCMATJBL) TURN OFF JOBS (J) Y02669 85186902
         B     TRACKOFF                                          Y02669 85187902
         SPACE  5                                                       85188902
*********************************************************************** 85189902
*                                                                     * 85190902
*                         STOP TRACK TS                          Y02669 85191902
*              TURN OFF TS AND TS,LIST FLAGS IN SACB             Y02669 85192302
*                              TS,L                              Y02669 85192602
*                                                                     * 85192902
*********************************************************************** 85193902
         SPACE                                                          85194302
TRKTS    EQU   *                                                 Y02669 85194902
         NI    DCMATRCK,FF-(DCMATTS+DCMATTSL)   TURN OFF TS      Y02669 85195902
         B     TRACKOFF                                          Y02669 85196902
         SPACE 5                                                        85197902
*********************************************************************** 85198902
*                                                                     * 85199902
*                         STOP TRACK ACTIVE                      Y02669 85200902
*       TURN OFF JOBS; JOBS,LIST; TS AND TS,LIST FLAGS IN SACB   Y02669 85201302
*                  J      J,L            TS,L                    Y02669 85203302
*                                                                     * 85206002
*********************************************************************** 85206902
         SPACE                                                          85207802
TRKA     EQU   *                  TURN OFF ALL INDICATORS        Y02669 85208702
         NI    DCMATRCK,FF-(DCMATJOB+DCMATJBL+DCMATTS+DCMATTSL)  Y02669 85209602
         EJECT                                                          85210502
*********************************************************************** 85210902
*                                                                     * 85211302
*   IF THIS STOPTR COMMAND WIPES OUT THE TRACK DISPLAY FOR THIS  Y02669 85212202
*   AREA, DIDOCS IS GIVEN CONTROL VIA IEE6703D TO CLEAR THE      Y02669 85215102
*   SCREEN OF THE DISPLAY. OTHERWISE, THE LOCKS SET IN IEE7503D  Y02669 85215402
*   ARE RELEASED AND CONTROL IS RETURNED TO THE SYSTEM.          Y02669 85215802
*                                                                     * 85215902
*********************************************************************** 85216202
         SPACE 2                                                        85216402
TRACKOFF EQU   *                                                 Y02669 85216602
         CLI   DCMATRCK,OFF       ALL TRACK OPTIONS OFF?         Y02669 85216802
         BZ    D6703D             YES, HAVE DIDOCS CLEAR SCREEN  Y02669 85217002
         SPACE                                                          85217902
TRUPDATE EQU   *                                                 Y02669 85218802
         BAL   R15,LOCKSOFF       GO RELEASE LOCKS               Y02651 85220802
         BR    R14                AND RETURN                     Y02669 85224202
         SPACE                                                          85225102
D6703D   EQU   *                                                 Y02669 85226002
         L     R15,VCON6703       GET ADDRESS OF IEE6703D        Y02669 85226902
         BR    R15                                               Y02669 85227802
         EJECT                                                          85228702
*********************************************************************** 85229602
*                                                                     * 85230502
*                      STOP MONITOR ERROR EXITS                  Y02669 85231402
*                                                                     * 85232302
*********************************************************************** 85233202
         SPACE                                                          85234102
DERR311  EQU   *                                                 Y02669 85235002
         MVI   XAE,ERR311         ERROR CODE=11 FOR PARM MISSING Y02669 85235902
         B     D0503D             BRANCH TO MESSAGE MODULE       Y02669 85236802
DERR305  EQU   *                                                 Y02669 85237702
         MVI   XAE,ERR305         ERROR CODE=5 FOR COMD INVALID  Y02669 85238602
         B     D0503D             BRANCH TO MESSAGE MODULE       Y02669 85239502
DERR777  EQU   *                                               @Y02668P 85239803
         MVI   XAE,ERR777         ERROR CODE= 15 FOR INVALID   @Y02668P 85240103
         B     D0503D             FROM SUBSYSTEM CONSOLE       @Y02668P 85240403
         SPACE 2                                                        85241303
*********************************************************************** 85251203
*                                                                     * 85251603
*                      STOP TRACK ERROR EXITS                    Y02651 85252103
*     CMS AND LCOAL LOCKS MUST BR RELEASED BEFORE GOING TO       Y02651 85253003
*     IEE0503D SINCE IEE0503D DOES NOT EXPECT LOCKS TO BE SET    Y02651 85253903
*                                                                     * 85254803
*********************************************************************** 85255703
         SPACE                                                          85256603
TRERR311 EQU   *                                                 Y02651 85257503
         MVI   XAE,ERR311         ERROR CODE=11 FOR PARM MISSING Y02651 85258403
         B     TRD0503D           BRANCH TO MESSAGE MODULE       Y02651 85258803
TRERR305 EQU   *                                                 Y02651 85259303
         MVI   XAE,ERR305         ERROR CODE=5 FOR COMD INVALID  Y02651 85260203
TRD0503D EQU   *                                                 Y02651 85261103
         BAL   R15,LOCKSOFF       GO RELEASE LOCKS               Y02651 85262103
D0503D   EQU   *                                                 Y02669 85262803
         L     R15,VCON0503       GET ADDR OF IEE0503D           Y02651 85264003
         BR    R15                BRANCH TO MESSAGE MODULE       Y02651 85264103
         EJECT                                                          85265603
*********************************************************************** 85266003
*                                                                     * 85266503
*  CMS AND LOCAL LOCKS MUST BE RELEASED BEFORE EXITING FOR STOP TRACK * 85267403
*                                                                     * 85268303
*********************************************************************** 85269203
         SPACE 2                                                        85270003
LOCKSOFF EQU   *                                                 Y02651 85271003
         STM   R11,R14,XASAVLOC   SAVE REGISTERS ACROSS SETLOCK  Y02651 85271903
         SETLOCK RELEASE,TYPE=CMS,RELATED=(STOPTR,IEE7503D(LOCKSET))    85272803
         SETLOCK RELEASE,TYPE=LOCAL,RELATED=(STOPTR,IEE7503D(LOCKSET))  85273203
         LM    R11,R14,XASAVLOC   RESTORE REGS AFTER SETLOCK     Y02651 85273703
         NI    XASSDS,FF-XASSDS5  INDICATE LOCKS OFF             Y02651 85274603
         BR    R15                RETURN TO MAIN LINE            Y02651 85275503
         EJECT                                                          85276403
*********************************************************************** 85277303
*                                                                     * 85278203
*                         CONSTANTS                              Y02669 85279103
*                                                                     * 85280003
*********************************************************************** 85280403
         SPACE  2                                                       85280903
VCON0503 DC    V(IEE0503D)        ERROR MESSAGE MODULE ADDRESS   Y02669 85281803
VCON6703 DC    V(IEE6703D)        STOPTR MODULE ADDRESS          Y02669 85282703
COMPARE  CLC   D1(D0,R7),D0(R4)   COMPARE COMMAND OPERAND WITH   Y02669 85283603
*                                 COMPARE TABLE ENTRY            Y02669 85284503
         SPACE   5                                                      85285403
*********************************************************************** 85286303
*                                                                     * 85287203
*                         PATCH AREA                             Y02669 85287603
*                                                                     * 85288103
*********************************************************************** 85289003
         SPACE  2                                                       85289903
PATCH    DC    2CL25'** IEE5503D PATCH AREA **'               @ZA30198* 85290800
         EJECT                                                          85291703
*********************************************************************** 85292603
*                                                                     * 85293503
*                      STOPMN  BRANCH  TABLE                     Y02669 85294403
*                                                                     * 85294803
*        THIS TABLE MUST BE IN A ONE-TO-ONE CORRESPONDENCE WITH  Y02669 85295303
*        THE 'STOPMN COMPARE TABLE'                              Y02669 85296203
*                                                                     * 85297103
*********************************************************************** 85298003
         SPACE                                                          85298903
BRTABLE  DS    0H                                                Y02669 85299803
         B     DDJOB              BRANCH TO PROCESS PM JOBNAMES  Y02669 85300703
         B     DDSTAT             BRANCH TO PROCESS PM STATUS    Y02669 85301603
         B     DDSNAME            BRANCH TO PROCESS PM DSNAME    Y02669 85301703
         B     DDSPACE            BRANCH TO PROCESS PM SPACE     Y02669 85302503
         B     DDSES              BRANCH TO PROCESS PM SESS      Y02669 85303403
         SPACE  2                                                       85304303
*********************************************************************** 85305203
*  NOTE: THE FOLLOWING TABLE AND THE STOPTR OPERAND TABLE MUST   Y02669 85306103
*        BE THE LAST ITEMS IN THIS MODULE SINCE A USING FOR THE  Y02669 85307003
*        TABLES, DEPENDING ON THE FUNCTION BEING PROCESSED, IS   Y02669 85307903
*        ISSUED ON REGISTER 7 AND THUS CAN REESTABLISH THE       Y02669 85308803
*        MODULE'S BASE REGISTER FOR ANY CODE WHICH FOLLOWS THESE Y02669 85309203
*        TABLES.                                                 Y02669 85309703
*                                                                     * 85310603
*            S T O P M N   C O M P A R E   T A B L E             Y02669 85311503
*                                                                     * 85312403
*        THIS TABLE MUST BE IN A ONE-TO-ONE CORRESPONDENCE WITH  Y02669 85313303
*        THE 'STOPMN BRANCH TABLE'                               Y02669 85314203
*********************************************************************** 85315103
         SPACE                                                          85316003
PARMTAB  EQU   *                                                 Y02669 85316403
PARMLEN  EQU   *                                                 Y02669 85316903
         SPACE                                                          85317803
         DC    AL1(L'PMJOBN-1)  LENGTH OF STOPMN OPERAND         Y02669 85318703
PMJOBN   DC    C'JOBNAMES '     STOPMN OPERAND                   Y02669 85319603
         SPACE                                                          85320503
         DC    AL1(L'PMSTAT-1)                                   Y02669 85321403
PMSTAT   DC    C'STATUS '                                        Y02669 85322303
         SPACE                                                          85323203
         DC    AL1(L'PMDSN-1)                                    Y02669 85323603
PMDSN    DC    C'DSNAME '                                        Y02669 85324103
         SPACE                                                          85325003
         DC    AL1(L'PMSPACE-1)                                  Y02669 85325903
PMSPACE  DC    C'SPACE '                                         Y02669 85326803
         SPACE                                                          85327603
         DC    AL1(L'PMSESS-1)                                   Y02669 85328403
PMSESS   DC    C'SESS '                                          Y02669 85329203
         SPACE                                                          85330003
PARMTABN EQU   *                                                 Y02669 85330803
         EJECT                                                          85331603
*********************************************************************** 85332403
*                                                                     * 85333203
*                       STOPTR  BRANCH  TABLE                    Y02669 85334003
*                                                                     * 85334803
*        THIS TABLE MUST BE IN A ONE-TO-ONE CORRESPONDENCE WITH  Y02669 85335603
*        THE 'STOPTR COMPARE TABLE'                              Y02669 85336802
*                                                                     * 85338802
*********************************************************************** 85346802
         SPACE 2                                                        85350002
TRKBRTAB DS    0H                                                Y02669 85365302
         B     TRKJOBS            BRANCH TO PROCESS PT JOBS      Y02669 85415302
         B     TRKJOBS            BRANCH TO PROCESS PT J         Y02669 85425302
         B     TRKTS              BRANCH TO PROCESS PT TS        Y02669 85435302
         B     TRKA               BRANCH TO PROCESS PT A         Y02669 85445302
         SPACE 2                                                        85447302
*********************************************************************** 85449502
*  NOTE: THE FOLLOWING TABLE AND THE STOPMN OPERAND TABLE MUST   Y02669 85452902
*        BE THE LAST ITEMS IN THIS MODULE SINCE A USING FOR THE  Y02669 85454902
*        TABLES, DEPENDING ON THE FUNCTION BEING PROCESSED, IS   Y02669 85455302
*        ISSUED ON REGISTER 7 AND THUS CAN REESTABLISH THE       Y02669 85455702
*        MODULE'S BASE REGISTER FOR ANY CODE WHICH FOLLOWS THESE Y02669 85456102
*        TABLES.                                                 Y02669 85456202
*                                                                     * 85456302
*            S T O P T R    O P E R A N D    T A B L E           Y02669 85459702
*                                                                     * 85463102
*        THIS TABLE MUST BE IN A ONE-TO-ONE CORRESPONDENCE WITH  Y02669 85465102
*        THE 'STOPTR BRANCH TABLE'                               Y02669 85465502
*                                                                     * 85475502
*********************************************************************** 85476502
         SPACE 2                                                        85478502
PARMTAB2 EQU   *                                                 Y02669 85480502
PARMLEN2 EQU   *                                                 Y02669 85482502
         SPACE                                                          85482902
         DC    AL1(L'PTJOB-1)     LENGTH OF STOPTR OPERAND       Y02669 85483002
PTJOB    DC    C'JOBS '           STOPTR OPERAND                 Y02669 85489802
         SPACE                                                          85493102
         DC    AL1(L'PTJ-1)                                      Y02669 85493202
PTJ      DC    C'J '                                             Y02669 85493302
         SPACE                                                          85493402
         DC    AL1(L'PTTS-1)                                     Y02669 85493502
PTTS     DC    C'TS '                                            Y02669 85493902
         SPACE                                                          85494002
         DC    AL1(L'PTA-1)                                      Y02669 85495602
PTA      DC    C'A '                                             Y02669 85497602
         SPACE                                                          85498002
PARMTA2N EQU   *                                                 Y02669 85498102
         EJECT                                                          85498602
         IEEBASEA                                                       85899102
         EJECT                                                          85899502
CMXSA    DSECT                                                          85899902
         IEEXSA                                                         86100020
         EJECT                                                          86150002
         IEZMPL                                                         86200002
         EJECT                                                          86398002
         IEERDCM                                                        86398202
         EJECT                                                          86499902
CVT      DSECT                                                   Y02669 87050002
         CVT                                                            87600020
         EJECT                                                          87650002
         IEECUCM  FORMAT=NEW                                            87710002
         EJECT                                                          87760002
         IHAPSA                                                         87810002
         END                                                            90999302
./  ADD  SSI=41620450,NAME=IEE5603D
         TITLE 'IEE5603D K AND MR MESSAGE MODULE LOAD ONE'              00100002
*********************************************************************** 00150002
*                                                                     * 00200002
*   MODULE NAME         =    IEE5603D                           Y02669* 00250002
*                                                                     * 00300002
*   DESCRIPTIVE NAME    =    CONTROL (K), MSGRT (MR) COMMANDS   Y02669* 00350002
*                            AND L=CCA OPERAND ERROR MESSAGE    Y02669* 00350402
*                            MODULE - LOAD 1                    Y02669* 00352002
*                                                                     * 00400002
*   COPYRIGHT           =    MISSING                            Y02669* 00450002
*                                                                     * 00500002
*   STATUS              =    01 - UPDATE FOR VS/2 RELEASE 1     Y02669* 00550002
*                                                                     * 00600002
*   FUNCTION            =    THIS MODULE HANDLES CONTROL (K),   Y02669* 00650002
*                            MSGRT (MR) COMMANDS AND L=CCA      Y02669* 00700002
*                            OPERAND ERROR MESSAGES.            Y02669* 00710002
*                                                                     * 00800002
*  OPERATION            =    MOST MESSAGES ARE ISSUED BY THE    Y02669* 00840002
*                            WRITE TO OPERATOR (WTO) MACRO      Y02669* 00900002
*                            TO THE SOURCE CONSOLE. INCLUDING @Y02668P* 00950003
*                            ALL MESSAGES ISSUED FROM ANOTHER @Y02668P* 00960003
*                            MEMORY (JES3). THIS INCLUDES THE @Y02668P* 00970003
*                            CONTROL AND MSG ROUTE COMMANDS   @Y02668P* 00980003
*                            IF THE MESSAGE IS TO BE WRITTEN    Y02669* 01000002
*                            IN RESPONSE TO A CONTROL OR MSGRT  YM1914* 01010002
*                            COMMAND ISSUED FROM A CRT CONSOLE  YM1914* 01030002
*                            OR THE MESSAGE ALSO INCLUDES       Y02669* 01050002
*                            'IEE150I CHANGE OPTIONS, IF        Y02669* 01060002
*                            DESIRED', (I.E. IN RESPONSE TO A   Y02669* 01070002
*                            'REF' COMMAND; K T,REF; K A,REF;   Y02669* 01080002
*                            MR REF), THE MESSAGE IS SET UP     Y02669* 01090002
*                            IN THE INSTRUCTION LINE OF THE     Y02669* 01100002
*                            TRANSIENT DCM TO BE WRITTEN BY     Y02669* 01130002
*                            DIDOCS.                            Y02669* 01160002
*                                                                     * 01202002
*                            FOR ALL MESSAGES WHICH ARE PUT IN  Y02651* 01204002
*                            THE TDCM INSTRUCTION LINE, IF THE  Y02651* 01206002
*                            CMS AND LOCAL LOCKS ARE NOT HELD   Y02651* 01208002
*                            ON ENTRY, THEY ARE OBTAINED AND    Y02651* 01208402
*                            XASSDS5 IS TURNED ON. FOR THE WTO  Y02651* 01208802
*                            ISSUED MESSAGES THE LOCKS ARE      Y02651* 01209202
*                            RELEASED BEFORE THE GETMAIN IS     Y02651* 01209602
*                            ISSUED.                            Y02651* 01209702
*                                                                     * 01209802
*                            IF THE COMMAND WAS ISSUED          YM1557* 01209902
*                            INTERNALLY, THE CONSOLE ID FOUND   YM1557* 01210002
*                            IN XAU WILL BE X'00'. IN THESE     YM1557* 01210402
*                            CASES, THE ERROR MESSAGE WILL BE   YM1557* 01211202
*                            ISSUED VIA WTO TO THE MASTER       YM1557* 01222202
*                            CONSOLE.                           YM1557* 01222602
*                                                                     * 01222702
*                            THE MESSAGE CODE FOUND IN XAE      Y02669* 01224702
*                            WHEN DOUBLED SERVES AS AN INDEX    Y02669* 01228002
*                            INTO THE MESSAGE TEXT TABLE.       Y02669* 01230002
*                                                                     * 01232002
*                            EACH ENTRY IN THE TABLE CONTAINS   Y02669* 01244002
*                            MESSAGE FLAGS WHICH INDICATE:      Y02669* 01248002
*                             X'80' - MESSAGE REQUIRES COMMAND  Y02669* 01252002
*                                     VERB FROM XAV             Y02669* 01256002
*                             X'40' - MESSAGE REQUIRES INVALID  Y02669* 01260002
*                                     OPERAND WHOSE ADDRESS IS  Y02669* 01268002
*                                     FOUND IN XASOPTR          Y02669* 01272002
*                             X'20' - MESSAGE REQUIRES          Y02669* 01276002
*                                     ADDITIONAL TEXT FROM      Y02669* 01284002
*                                     IEE5903D                  Y02669* 01288002
*                             X'10' - INVALID OPERAND BELONGS   Y02669* 01292002
*                                     AT END OF TEXT            Y02669* 01300002
*                                                                     * 01305002
*                            IF THE MESSAGE HAS TWO PARTS,      Y02669* 01310002
*                            A BRANCH IS TAKEN TO IEE5903D TO   Y02669* 01315002
*                            COMPLETE THE MESSAGE AND ISSUE IT. Y02669* 01320002
*                            (THIS IS THE ONLY ENTRANCE TO      Y02669* 01325002
*                            IEE5903D.)                         Y02669* 01330002
*                                                                     * 01335002
*   NOTES               =    NONE                               Y02669* 01340002
*                                                                     * 01350002
*    CHARACTER-CODE                                             Y02669* 01400002
*     DEPENDENCIES      =    ANY CHARACTER CODE OTHER THAN      Y02669* 01450002
*                            EBCDIC WILL REQUIRE REASSEMBLY OF  Y02669* 01500002
*                            THIS MODULE. NOTE THAT CHARACTER   Y02669* 01510002
*                            REPRESENTATIONS ARE USED FOR       Y02669* 01520002
*                            ',' AND ')'.                       Y02669* 01530002
*                                                                     * 01600002
*    DEPENDENCIES       =    NONE                               Y02669* 01650002
*                                                                     * 01700002
*    RESTRICTIONS       =    NONE                               Y02669* 01750002
*                                                                     * 01800002
*    REGISTER                                                   Y02669* 01850002
*     CONVENTIONS       =    NONE                               Y02669* 01900002
*                                                                     * 01950002
*     PATCH LABEL       =    PATCH                              Y02669* 02000002
*                                                                     * 02050002
*   MODULE TYPE         =    CSECT (MESSAGE MODULE)             Y02669* 02100002
*                                                                     * 02150002
*    PROCESSOR          =    N/A                                Y02669* 02200002
*                                                                     * 02250002
*    MODULE SIZE        =    X'3E6' + X'48' PATCH AREA          Y02669* 02300002
*                                                                     * 02350002
*    ATTRIBUTES         =    REFRESHABLE, REENTRANT,            Y02669* 02400002
*                            SUPERVISOR MODE, KEY 0,            Y02669* 02450002
*                            PAGED LPA                          Y02669* 02500002
*                                                                     * 02550002
         EJECT                                                          02560002
*   ENTRY POINT         =    IEE5603D FROM (SEE MESSAGES)       Y02669* 02600002
*      PURPOSE          =    TO ISSUE ERROR MESSAGES FOR MSGRT  Y02669* 02650002
*                            AND K COMMANDS AND L=CCA OPERAND   Y02669* 02700002
*      LINKAGE=              BRANCH                             Y02669* 02750002
*      INPUT DATA       =    REGISTER 2 CONTAINS ADDRESS OF XSA Y02669* 02800002
*                            WHICH CONTAINS INFORMATION ABOUT   Y02669* 02850002
*                            THE MESSAGE THAT IS TO BE WRITTEN  Y02669* 02900002
*                              XAE - ONE BYTE MESSAGE CODE      Y02669* 02950002
*                              XASTSAVE - ONE BYTE SECONDARY    Y02669* 03000002
*                            MESSAGE CODE WHEN THE MESSAGE IS   Y02669* 03050002
*                            IN TWO PARTS. THE LAST THREE BYTES Y02669* 03100002
*                            (XASOPTR) CONTAIN AN ADDRESS TO AN Y02669* 03150002
*                            INVALID OPERAND IF IT IS TO BE     Y02669* 03200002
*                            INCLUDED IN THE MESSAGE.           Y02669* 03250002
*                              XAN - COMMAND VERB CODE          Y02669* 03260002
*                              XAR - ADDR OF COMMAND BUFFER     Y02669* 03270002
*                              XASSDS3-ON IF A TASK OTHER     @Y02668P* 03272003
*                                       THAN COMTASK ISSUED   @Y02668P* 03274003
*                                       THE COMMAND (JES3)    @Y02668P* 03276003
*                              XASSDS5 ON IF LOCKS HELD         Y02651* 03280002
*                                      OFF IF NOT               Y02651* 03282002
*                              XAU - SOURCE CONSOLE ID          Y02669* 03290002
*                              XAV - COMMAND VERB               Y02669* 03292002
*                                                                     * 03300002
*      REGISTERS SAVED  =    REGISTER 14 SAVED IN XAS           Y02669* 03350002
*                            (XASAVSTD + 16) AT BADCODE.        Y02669* 03360002
*                            REGISTERS 11 - 14 SAVED BEFORE     Y02651* 03370002
*                            ISSUING SETLOCK AT LOCKSOFF        Y02651* 03390002
*                            AND LOCKSTAT                       Y02651* 03392002
*                                                                     * 03400002
*      REGISTER CONTENTS                                        Y02669* 03450002
*      DURING PROCESSING=    R0  - WORK REG                     Y02669* 03500002
*                            R1  - WORK REG                     Y02669* 03550002
*                            R2  - BASE REG FOR XSA             Y02669* 03600002
*                            R3  - OUTPUT-POSITION IN BUFFER    Y02669* 03650002
*                            R4  - WORK REG                     Y02669* 03700002
*                            R5  - WORK REG                     Y02669* 03750002
*                            R6  - OUTPUT-CURRENT TEXT LENGTH   Y02669* 03800002
*                            R7  - BASE REG UCM ENTRY           Y02669* 03850002
*                            R8  - OUTPUT-BASE REG TRANS DCM    Y02669* 03900002
*                            R9  - BASE REG FOR UCM + RDCM      Y02669* 03950002
*                            R10 - BASE REG FOR CVT + TAB2      Y02669* 04000002
*                            R11 - POINTER TO INVALID OPERAND   Y02669* 04050002
*                            R12 - MODULE BASE REG              Y02669* 04100002
*                            R13 - ADDRESS OF MSG TABLE ENTRY   Y02669* 04150002
*                            R14 - RETURN REG                   Y02669* 04200002
*                            R15 - RETURN CODE + LINK REG       Y02669* 04250002
*                                                                     * 04300002
*      REGISTER RESTORED=    REGISTER 14 RESTORE FROM XASAVSTD  Y02669* 04350002
*                            + 16 BEFORE EXITING AT RETURNOK    Y02669* 04351002
*                            AND NOCORE                         Y02669* 04352002
*                            REGISTERS 11 - 14 RESTORED AFTER   Y02651* 04354002
*                            ISSUING SETLOCK AT LOCKSOFF AND    Y02651* 04356002
*                            LOCKSTAT                           Y02651* 04358002
*                                                                     * 04360002
*  *  *  *  *  *  *  *  *  *  *  *  *  *  *  *  *  *  *  *  *  *  *  *  04433202
*                                                                     * 04443202
*   EXIT - NORMAL       =    RETURN VIA BR R14 FROM RETURNOK    Y02669* 04453202
*      CONDITIONS       =    MESSAGE TO GO TO CRT DEVICE        Y02669* 04463202
*      OUTPUT DATA      =    MESSAGE IN DCM  INSTRUCTION LINE   Y02669* 04465202
*                               DCMIOCM1 - DCMWRINS X'04'       Y02669* 04465302
*                            WITH CURSOR POSITIONING            Y02669* 04466102
*                               DCMINLGN - ZERO OR CURSOR       Y02669* 04466902
*                                          POSITION             Y02669* 04467302
*                            INVALID K COMMAND                  Y02669* 04468902
*                               DCMSVC34 + DCMINVLD (X'40)      Y02669* 04469002
*                            IF DEVICE 2250 OR HAS LIGHT PEN    Y02669* 04469302
*                               DCMIOUNQ = DCMW2250 (X'08')     Y02669* 04470902
*                            DCMIOUNQ SET TO DCMINERR X'02'     Y02669* 04472502
*                            INDICATING AN ERROR MESSAGE IN     Y02669* 04474102
*                            THE DCM INSTRUCTION LINE AND       Y02669* 04475702
*                            'ENTER CANCEL' ADDED TO MSG        Y02669* 04477302
*                            LOCKS RELEASED                     Y02651* 04478902
*      RETURN CODES     =    NONE                               Y02669* 04480502
*                                                                     * 04482102
*  *  *  *  *  *  *  *  *  *  *  *  *  *  *  *  *  *  *  *  *  *  *  *  04483702
*                                                                     * 04485302
*   EXITS - NORMAL      =    RETURN VIA BR R14 FROM             Y02669* 04486902
*                            ISSUEWTO->RETURNOK                 Y02669* 04487702
*      CONDITIONS       =    MESSAGE WRITTEN TO APPROPIATE      Y02669* 04488502
*                            CONSOLE VIA WTO AND MESSAGE        Y02669* 04490102
*                            BUFFER FREED VIA FREEMAIN          Y02669* 04491102
*      OUTPUT DATA      =    MESSAGE                            Y02669* 04493302
*      RETURN CODES     =    NONE                               Y02669* 04494902
*                                                                     * 04496502
*  *  *  *  *  *  *  *  *  *  *  *  *  *  *  *  *  *  *  *  *  *  *  *  04498102
*                                                                     * 04499702
*   EXIT - NORMAL       =    BRANCH TO IEE5903D FROM D5903D     Y02669* 04501302
*      CONDITIONS       =    WHEN THE MESSAGE HAS TWO PARTS     Y02669* 04502902
*                            (BIT 2 IS ON IN MESSAGE TEXT + 5)  Y02669* 04504502
*      OUTPUT DATA      =    REG 2 POINTS TO XSA WHICH CONTAINS Y02669* 04506102
*                                 INFO ABOUT THE MESSAGE        Y02669* 04507702
*                               XASTSAVE - ONE BYTE SECONDARY   Y02669* 04509302
*                                 MESSAGE CODE                  Y02669* 04510902
*                               XAU - SOURCE CONSOLE ID         Y02669* 04512502
*                               XASCID - TARGET CONSOLE ID      Y02669* 04514102
*                               XASDID - TARGET AREA ID (CRT)   Y02669* 04515702
*                               XASSDS1 - ON WTO BUFFER         Y02669* 04516102
*                               XASSDS5 - ON LOCKS HELD         Y02651* 04517302
*                               XASAVSTD+12 - WTO BUFFER ADDR   Y02669* 04518902
*                               XASAVSTD+16 - RETURN ADDRESS    Y02669* 04519702
*                            REG 3 - CURRENT POSITION IN        Y02669* 04520502
*                                    MESSAGE BUFFER             Y02669* 04520602
*                            REG 6 - CURRENT LENGTH OF VARIABLE Y02669* 04520902
*                                    TEXT                       Y02669* 04521302
*                            REG 8 - ADDRESS OF TRANSIANT DCM   Y02669* 04521702
*      RETURN CODES     =    NONE                               Y02669* 04532102
*                                                                     * 04542102
*  *  *  *  *  *  *  *  *  *  *  *  *  *  *  *  *  *  *  *  *  *  *  *  04542502
*                                                                     * 04542902
*   EXIT - ERROR        =    RETURN VIA BR R14 BADCODE->RETURN  Y02669* 04543302
*      CONDITIONS       =    BAD MESSAGE CODE PASSED IN XAE     Y02669* 04543702
*                            LOCKS RELEASED (IF HELD ON ENTRY)  Y02651* 04545302
*      OUTPUT DATA      =    NONE                               Y02669* 04548902
*      RETURN CODES     =    NONE                               Y02669* 04550502
*                                                                     * 04552102
*  *  *  *  *  *  *  *  *  *  *  *  *  *  *  *  *  *  *  *  *  *  *  *  04553702
*                                                                     * 04555302
*   EXIT - ERROR        =    BRANCH TO IEE0503D FROM NOCORE     Y02669* 04556902
*      CONDITIONS       =    BECAUSE GETMAIN FAILED FOR WTO     Y02669* 04558602
*                            BUFFER TO HAVE 'IEE328I COMMAND    Y02669* 04559002
*                            ABORTED' ISSUED                    Y02669* 04561702
*      OUTPUT DATA      =    ERROR CODE FOR MESSAGE IN XSA      Y02669* 04563302
*                            POINTED TO BY REG 2                Y02669* 04564902
*                              XAE CONTAINS X'3A' FOR IEE328I   Y02669* 04566502
*                              XASSDS5 - OFF LOCKS RELEASED     Y02651* 04568102
*                              LOCKS WERE RELEASED BEFORE THE   Y02651* 04568202
*                              GETMAIN                          Y02651* 04568302
*      RETURN CODES     =    NONE                               Y02669* 04568502
*                                                                     * 04568602
*  *  *  *  *  *  *  *  *  *  *  *  *  *  *  *  *  *  *  *  *  *  *  *  04571102
*                                                                     * 04573602
*   EXTERNAL REFERENCES                                         Y02669* 04576102
*                                                                     * 04578602
*      ROUTINES         =    BRANCHES TO IEE5903D  IEE0503D     Y02669* 04581102
*                                                                     * 04583602
*      DATA AREAS       =    NONE                               Y02669* 04586102
*                                                                     * 04588602
*      CONTROL BLOCKS   =    CVT  R - ADDRESS UCM               Y02669* 04591102
*                            UCM  R - ADDRESS UCME AND RDCM     Y02669* 04593602
*                        IEERDCM  R - ADDRESS OF IEETDCM        Y02669* 04595602
*                        IEETDCM  R - INDICATORS CHECKED        Y02669* 04596102
*                                 W - INDICATORS SET            Y02669* 04598602
*                            XSA  R - INPUT INFORMATION         Y02669* 04601102
*                                 W - WORK AREA                 Y02669* 04603602
*                        IHAPSA   NEEDED FOR SETLOCK            Y02651* 04605602
*                                                                     * 04606102
         EJECT                                                          04608102
*        TABLES         =    THIS MODULE CONTAINS TWO MESSAGE   Y02669* 04608602
*                            TABLES. THE FIRST IN INDEXED BY    Y02669* 04611102
*                            TWICE THE MESSAGE CODE PASSED IN   Y02669* 04613602
*                            XAE. THE INDEXED HALF WORD THEN    Y02669* 04616102
*                            POINTS TO AN ELEMENT IN TAB2 WHICH Y02669* 04626102
*                            CONTAINS THE APPROPIATE MESSAGE.   Y02669* 04628102
*                                                                     * 04628502
*                            TAB2 CONTAINS A ONE BYTE LENGTH OF Y02669* 04628902
*                            THE PREFORMATTED MESSAGE TEXT -1,  Y02669* 04629302
*                            FOUR BYTES OF FILLER, ONE BYTE     Y02669* 04629702
*                            OF MESSAGE FLAGS:                  Y02669* 04637502
*                               X'80' - COMMAND VERB IN MSG     Y02669* 04637902
*                               X'40' - INVALID OPERAND IN MSG  Y02669* 04638302
*                               X'20' - IEE5903D CONTAINS REST  Y02669* 04638702
*                                       OF MESSAGE TEXT         Y02669* 04639102
*                               X'10' - OPERAND AT END OF MSG   Y02669* 04639202
*                            AND THE PREFORMATTED MESSAGE TEXT. Y02669* 04639502
*                                                                     * 04641502
*      MACROS           =    MODID                              Y02669* 04643502
*                            WTO                                Y02669* 04643602
*                            GETMAIN SUBPOOL 229                Y02669* 04643902
*                            FREEMAIN SUBPOOL 229               Y02669* 04644302
*                            SETLOCK - CMS AND LOCAL OBTAINED   Y02651* 04644402
*                                                  & RELEASED   Y02651* 04644502
*                                                                     * 04644702
*      ENQUEUE RESOURCES=    NONE                               Y02669* 04645102
*                                                                     * 04652502
*      CHANGE LEVEL     =    Y02669                             Y02669* 04654402
*                            Y02651                             Y02651* 04655002
*                            YM1914                             YM1914* 04655602
*                            Y02668                           @Y02668P* 04655903
*                                                                     * 04656302
*      LOCKS HELD       = FOR NON-DCM INSTRUCTION LINE MESSAGES:      * 04656702
*                            CMS AND LOCAL LOCKS OBTAINED IN    Y02651* 04657602
*                            IEE7503D ARE RELEASED AND XASSDS5  Y02651* 04658602
*                            IS TURNED OFF BEFORE ISSUING       Y02651* 04659002
*                            THE GETMAIN MACRO.                 Y02651* 04659602
*                        FOR DCM INSTRUCTION LINE MESSAGES:           * 04660202
*                            IF LOCKS NOT HELD ON ENTRY,        Y02651* 04661702
*                            (I.E. XASSDS5 IS OFF) THEY ARE     Y02651* 04661802
*                            OBTAINED AND XASSDS5 IS TURNED ON. Y02651* 04664002
*                            IF MESSAGE HAS 2 PARTS, CONTROL    Y02651* 04671202
*                            GOES TO IEE5903D WITH THE LOCKS    Y02651* 04671302
*                            HELD.                              Y02651* 04675102
*                                                                     * 04679002
         EJECT                                                          04681002
*   MESSAGES            =    THE FOLLOWING MESSAGES ARE         Y02669* 04682802
*                            CONTAINED WITHIN THIS MODULE:      Y02669* 04686602
*                             * MEANS AN INVALID COMMAND VERB   Y02669* 04690402
*                               WILL APPEAR WITHIN THE MESSAGE  Y02669* 04694202
*                               (FOUND IN XAV)                  Y02669* 04698002
*                             & MEANS AN INVALID OPERAND WILL   Y02669* 04701802
*                               APPEAR WITHIN THE MESSAGE       Y02669* 04705602
*                               (POINTED TO BY XASOPTR)         Y02669* 04709402
*                             + MEANS A SECOND PART OF THE      Y02669* 04713202
*                               MESSAGE WILL BE FOUND IN        Y02669* 04717002
*                               IEE5903D.                       Y02669* 04720802
*                         XXXXD THE MODULE NAMES FOLLOWING      Y02669* 04724602
*                               EACH MESSAGE INDICATE THE       Y02669* 04725502
*                               MODULES IN WHICH THE ERRORS     Y02669* 04726402
*                               WERE DETECTED AND MESSAGES      Y02669* 04727302
*                               ISSUED.                         Y02669* 04728402
*                                                                     * 04732202
*                            IEE150I  CHANGE OPTIONS IF   X'02' Y02669* 04739802
*                                     DESIRED                   Y02669* 04743602
*                                     6903D,6403D               Y02669* 04747402
*                        +   IEE151I  DELETE REQUEST      X'03' Y02669* 04751202
*                                     INCONSISTENT              Y02669* 04755002
*                                     6703D                     Y02669* 04756002
*                        *&  IEE156I  INVALID OPERAND     X'04' Y02669* 04758802
*                                     6703D,7503D,6903D,6803D,  Y02669* 04762602
*                                     7703D,7803D,6403D,6303D   Y02669* 04763602
*                        +   IEE158I  K REQUEST           X'05' Y02669* 04764602
*                                     INCONSISTENT              Y02669* 04766402
*                                     6703D,6903D               Y02669* 04769402
*                        *   IEE345I  AUTHORITY INVALID   X'08' Y02669* 04774002
*                                     7503D,7703D,6303D         Y02669* 04775002
*                        *+& IEE921I  REJECTED            X'09' Y02669* 04777802
*                                     7503D,7703D               Y02669* 04781602
*                        +   IEE924I  INVALID AREA        X'0A' Y02669* 04785402
*                                     DEFINITION                Y02669* 04793002
*                                     6803D,6903D               Y02669* 04793902
*                        *+& IEE925I  OPERAND             X'0B' Y02669* 04794802
*                                     6703D,7503D,6403D,6303D   Y02669* 04795702
*                        +   IEE926I  L=CCA OPERAND       X'0C' Y02669* 04796802
*                                     INVALID                   Y02669* 04800602
*                                     6703D,7503D,6803D,7703D,  Y02669* 04804402
*                                     6403D,6303D               Y02669* 04805402
*                        *+  IEE927I  REQUEST AMBIGUOUS   X'0D' Y02669* 04808202
*                                     6703D,7503D,7803D         Y02669* 04809202
*                        *&  IEE931I  INSUFFICIENT        X'0E' Y02669* 04812002
*                                     STORAGE FOR COMMAND       Y02669* 04815802
*                                     6903D,6803D,6403D,6303D   Y02669* 04819602
*                                                                     * 04820602
*   SYSGEN              =    INCLUDED WITH SVC 34 IN LOAD       Y02669* 04823402
*                            MODULE IGC0003D, DLIB AOSB3,       Y02669* 04831002
*                            MACRO SGIEF441, TARLIB LPALIB.     Y02669* 04834802
*                                                                     * 04842402
*   SYSTEM                                                      Y02669* 04846202
*    LIBRARIES          =    NONE                               Y02669* 04850002
*                                                                     * 04855002
*********************************************************************** 04860002
         EJECT                                                          04865002
IEE5603D CSECT                                                          04870002
*********************************************************************** 04875002
*                                                                     * 04880002
*                          REGISTERS                                  * 04885002
*                                                                     * 04890002
*********************************************************************** 04895002
WRK0     EQU   0                   WORK REG MUST BE 0 AT MOVECDR Y02669 04900002
WRK1     EQU   1                   WORK REGISTER                        05000001
XSAR2    EQU   2                   INPUT/OUTPUT-XSA BASE REG     Y02669 05100002
WRK3     EQU   3                   OUTPUT-POSITION IN MSG BUFFER Y02669 05200002
WRK4     EQU   4                   WORK REGISTER                        05300002
WRK5     EQU   5                   WORK REGISTER                 Y02669 05400002
WRK6     EQU   6                   OUTPUT-CURRENT TEXT LENGTH    Y02669 05500002
UCMER7   EQU   7                   BASE REG FOR UCM ENTRY        Y02669 05600002
TDCMR8   EQU   8                   OUTPUT-BASE REG FOR TRANS DCM Y02669 05650002
WRK9     EQU   9                   BASE REG FOR UCM + RDCM       Y02669 05800002
WRK10    EQU   10                  BASE REG FOR CVT + TAB2       Y02669 05950002
BADOP11  EQU   11                  POINTER TO INVALID OPERAND    Y02669 06000002
BASE12   EQU   12                  MODULE BASE REGISTER          Y02669 06100002
WRK13    EQU   13                  ADDRESSES MESSAGE TABLE ENTRY Y02669 06200002
RETURN14 EQU   14                  RETURN REGISTER               Y02669 06300002
R15      EQU   15                  RETURN CODE + LINK REGISTER   Y02669 06400002
         EJECT                                                          06450001
*********************************************************************** 06460002
*                                                                     * 06500002
*                        NUMERIC  CONSTANTS                           * 06600002
*                                                                     * 06700002
*********************************************************************** 06750002
N0       EQU   0                   NUMBER CONSTANT                      06800001
N1       EQU   1                   NUMBER CONSTANT                      06900001
N2       EQU   2                   NUMBER CONSTANT                      07000001
N3       EQU   3                   NUMBER CONSTANT                      07100001
N4       EQU   4                   NUMBER CONSTANT                      07200001
N5       EQU   5                   NUMBER CONSTANT                      07300001
N6       EQU   6                   NUMBER CONSTANT                      07400001
N7       EQU   7                   NUMBER CONSTANT                      07500001
N8       EQU   8                   NUMBER CONSTANT                      07600001
N9       EQU   9                   NUMBER CONSTANT                      07700001
N10      EQU   10                  NUMBER CONSTANT                      07800001
N12      EQU   12                  NUMBER CONSTANT               Y02669 07850002
N15      EQU   15                  NUMBER CONSTANT                      08100001
N16      EQU   16                  NUMBER CONSTANT               Y02669 08150002
N25      EQU   25                  NUMBER CONSTANT                      08300001
N59      EQU   59                  NUMBER CONSTANT                      08500001
N60      EQU   60                  NUMBER CONSTANT                      08600001
N64      EQU   64                  NUMBER CONSTANT                      08700001
*********************************************************************** 08750002
*                                                                     * 08760002
*                        CHARACTER CONSTANTS                          * 08770002
*                                                                     * 08780002
*********************************************************************** 08790002
BLANK    EQU   X'40'               BLANK CONSTANT                Y02669 08800002
COMMA    EQU   C','                COMMA CHARACTER                      08900001
PARA2    EQU   C')'                PARENTHSIS CONSTANT                  09000001
*********************************************************************** 09050002
*                                                                     * 09060002
*                           FLAGS                                     * 09070002
*                                                                     * 09080002
*********************************************************************** 09090002
CMDFLAG  EQU   X'80'               COMMAND FLAG IN MSG TABLE     Y02669 09100002
OPFLAG   EQU   X'40'               OPERAND FLAG IN MSG TABLE     Y02669 09200002
VTXTFLAG EQU   X'20'               VARIABLE TEXT FLAG IN TABLE          09300002
OPENDFLG EQU   X'10'               OPERAND AT MSG END FLAG       Y02669 09400002
MCSFG    EQU   X'E0'               MCS FLAGS FOR WTO                    09450002
CODE2HI  EQU   14                  HIGHEST VALID MESSAGE CODE    Y02669 09600002
CODE2LO  EQU   2                   LOWEST VALID MESSAGE CODE     Y02669 09700002
TOOLOW   EQU   4                   CONDITION CODE - LOWER THAN   Y02669 09750002
TOOHIGH  EQU   2                   CONDITION CODE - HIGHER THAN  Y02669 09760002
XFF      EQU   X'FF'               MASK TO TURN OFF FLAGS        Y02669 09800002
KCMD     EQU   X'90'               CODE IN XSA FOR K COMMAND     Y02669 09900002
MRCMD    EQU   X'94'               CODE IN XSA FOR MSGRT COMMAND YM1914 09920002
SP229    EQU   229                 SUBPOOL NUMBER FOR GETMAIN    Y02669 09950002
IEE150I  EQU   X'02'               MSG CODE - CHANGE OPTION MSG  Y02669 10200002
MSG328   EQU   X'3A'               MSG CODE-IEE328I CMD ABORTED  Y02669 10450002
         EJECT                                                          10500001
*********************************************************************** 10550002
*                                                                     * 10600002
*          ESTABLISH ADDRESSABILITY TO MODULE, XSA, UCM, UCME         * 10650002
*                                                                     * 10700002
*********************************************************************** 10750002
         SPACE 2                                                        10800002
         BALR   BASE12,N0          LOAD BASE REG                 Y02669 10900002
         USING *,BASE12                                          Y02669 11000002
         MODID BRANCH=YES                                        Y01886 11050001
         USING DXSA,XSAR2           ADDRESSIBILITY OF XSA        Y02669 11100002
         L     WRK10,CVTPTR         ADDRESS OF CVT               Y02669 11200002
         USING DCVT,WRK10           ADDRESSIBILITY OF CVT        Y02669 11300002
         L     WRK9,CVTCUCB         ADDRESS OF UCM FROM CVT      Y02669 11400002
         USING UCM,WRK9             ADDRESSIBILITY OF UCM        Y02669 11500002
         DROP  WRK10                                             Y02669 11600002
         USING UCMLIST,UCMER7       ADDRESSIBILITY OF UCM ENTRY  Y02669 11700002
         SPACE                                                          11710002
*********************************************************************** 11750002
*                                                                     * 11800002
*             CHECK FOR INCORRECT MESSAGE CODE                        * 11900002
*       IF TOO HIGH OR TOO LOW FREE LOCKS, IF HELD, AND RETURN        * 11950002
*                                                                     * 12000002
*********************************************************************** 12400002
         SPACE 2                                                        12450002
BADCODE  EQU   *                                                 Y02669 12460002
         ST    RETURN14,XASAVSTD+N16   SAVE RETURN ADDRESS       Y02669 12470002
         CLI   XAE,CODE2HI         IS MSG CODE HIGHER THAN MAX?  Y02669 12500002
         BC    TOOHIGH,RETURN      YES, CHECK LOCKS AND RETURN   Y02651 12600002
         SPACE                                                          12650002
         CLI   XAE,CODE2LO         IS MSG CODE LOWER THAN MIN?   Y02669 12700002
         BC    TOOLOW,RETURN       YES, CHECK LOCKS AND RETURN   Y02651 12800002
         EJECT                                                          12850002
*********************************************************************** 13050002
*                                                                     * 13150002
*  TAKE THE SOURCE CONSOLE ID IN REG 1 AND CALCULATE THE ADDRESS Y02669 13160002
*   OF THE UCM ENTRY FOR THAT CONSOLE AND PLACE IT IN REG UCMER7 Y02669 13170002
*                                                                     * 13180002
*********************************************************************** 13182002
         SPACE 3                                                        13184002
         SR    WRK1,WRK1           CLEAR REG                            13190002
         IC    WRK1,XAU            GET SOURCE CONSOLE ID                13190402
         LTR   WRK1,WRK1           IF CONSOLE ID = 0 THEN        YM1557 13190502
         BZ    BUILDWTO            COMMAND ISSUED INTERNALLY     YM1557 13190602
         BCTR  WRK1,N0             SUBTRACT ONE FROM CONSOLE ID         13190802
         L     UCMER7,UCMVEA       FIRST UCM ENTRY FROM UCM      Y02669 13192002
         M     WRK0,UCMVEZ         MULTIPLY ENTRY SIZE BY REDUCED ID    13196002
         DROP  WRK9                                              Y02669 13196402
         AR    UCMER7,WRK1         ADDRESS OF DESIRED UCM ENTRY  Y02669 13198002
*********************************************************************** 13248002
*                                                                     * 13298002
*    DETERMINE WHETHER THE MESSAGE GOES IN DCM INSTRUCTION LINE       * 13348002
*          1 FOR MESSAGES WHICH ALSO INCLUDE 'IEE150I CHANGE          * 13350002
*           OPTIONS' FOR CRT DEVICES                                  * 13352002
*          2 FOR ALL MESSAGES PERTAINING TO K AND MR COMMAND FOR CRT  * 13354002
*    OR WTO BUFFER                                                    * 13356002
*          1 FOR NON-CRT DEVICES OR                                   * 13358002
*          2 FOR ALL OTHER MESSAGES TO CRT DEVICES                    * 13368002
*                                                                     * 13448002
*********************************************************************** 13498002
         TM    UCMDISP,UCMDISPC    IS THIS CONSOLE A CRT?               13600001
         BZ    BUILDWTO            NO, GO ISSUE WTO              Y02669 13700002
         TM    XASSDS,XASSDS3      IS TASK COMTASK?            @Y02668P 13710003
         BO    BUILDWTO            NO,BRANCH A TASK OTHER THAN @Y02668P 13720003
*                                  COMTASK ISSUED THE COMMAND  @Y02668P 13730003
         SPACE                                                          13750002
         CLI   XAN,KCMD            IS THIS A CONTROL (K) COMMAND?Y20669 13760002
         BE    LOCKSTAT            YES, PUT MSG IN DCM INSTRUCTION LINE 13762002
         SPACE                                                          13763002
         CLI   XAN,MRCMD           IS THIS A MSGRT COMMAND?      YM1914 13764002
         BE    LOCKSTAT            YES, PUT MSG IN INSTR LINE    YM1914 13766002
         SPACE                                                          13768002
         CLI   XAE,IEE150I         IS THIS CHANGE OPTIONS MSG?   Y02669 13770002
         BNE   BUILDWTO            NO, ISSUE WTO                 Y02669 13780002
         EJECT                                                          13790002
*********************************************************************** 13790102
* CMS AND LOCAL LOCKS IF NOT ALREADY HELD MUST BE OBTAINED FOR DCM    * 13794202
*********************************************************************** 13799002
LOCKSTAT EQU   *                                                 Y02651 13803102
         TM    XASSDS,XASSDS5      ARE LOCKS STILL ON?           Y02651 13807202
         BO    LOCKSON             YES,NO NEED TO TURN LOCKS ON  Y02651 13811302
         STM   BADOP11,RETURN14,XASAVLOC SAVE REGS FOR SETLOCK   Y02651 13815402
         SETLOCK OBTAIN,TYPE=LOCAL,MODE=UNCOND,                        *13819502
               RELATED=(TR,PT,K,RETURN,IEE5903D(LOCKSOFF))              13823602
         SETLOCK OBTAIN,TYPE=CMS,MODE=UNCOND,                          *13827702
               RELATED=(TR,PT,K,RETURN,IEE5903D(LOCKSOFF))              13831802
         LM    BADOP11,RETURN14,XASAVLOC  RESTORE AFTER SETLOCK  Y02651 13835902
         OI    XASSDS,XASSDS5      INDICATE LOCKS ON             Y02651 13840002
         SPACE 2                                                        13850002
LOCKSON  EQU   *                                                 Y02651 13860002
         L     WRK9,UCMXB          ADDRESS OF RESIDENT DCM       Y02669 13880002
         USING DCMTSRT,WRK9                                      Y02669 13890002
         L     TDCMR8,DCMADTRN     ADDRESS OF TRANSIENT DCM      Y02669 13900002
         USING DCMSTRT,TDCMR8                                    Y02669 13950002
         DROP  WRK9                                              Y02669 14000002
         EJECT                                                          15100002
*********************************************************************** 15150002
*                                                                     * 15200002
*     CONTROL (K), MR OR IEE150I CHANGE OPTIONS MESSAGE FOR CRT  YM1914 15250002
*     WRK4 POINTS TO THE XSA OPERAND BUFFER FOR THE K OR MR      Y02669 15260002
*                 COMMANDS OR THE DCM ENTRY AREA FOR IEE150I     Y02669 15270002
*                                                                     * 15300002
*********************************************************************** 15400002
         SPACE 3                                                        15450002
MOVEDCM  EQU   *                                                        15500001
         L     WRK4,XAR            ADDRESS OF COMMAND BUFFER            15600002
         LA    WRK4,N4(WRK4)       INCREMENT TO COMMAND IN BUFFER       15700002
         CLI   XAE,IEE150I         IS THIS A IEE150I MESSAGE     Y02669 15800002
         BNE   MOVEOPT             NO, K COMMAND                        15900002
         SPACE                                                          15950002
         L     WRK4,DCMAENTR       YES, ADDRESS OF DCM ENTRY AREA       16000002
MOVEOPT  EQU   *                                                        16100001
         SR    BADOP11,BADOP11     NECESSARY FOR ICM             Y02669 16150002
         ICM   BADOP11,N7,XASOPTR  GET CURSOR POSITION           Y02669 16200002
*                                  OR INVALID OPERAND POINTER    Y02669 16250002
*                                  OK IF ZERO                    Y02669 16300002
         SR    BADOP11,WRK4        DISTANCE TO INVALID OPERAND   Y02669 16400002
         STH   BADOP11,DCMINLGN    SET CURSOR POSITIONING        Y02669 16500002
         OI    DCMSVC34,DCMINVLD   SET INVALID K COMMAND BIT            16600002
         CLI   XAE,IEE150I         IS THIS A IEE150I MESSAGE   @YM1919P 16620002
         BE    NOSOUND             YES,NO ALARM                @YM1919P 16640002
         OI    DCMIOCM1,DCMSOUND   NO,SOUND THE ALARM          @YM1919P 16660002
NOSOUND  EQU   *                                               @YM1919P 16680002
         L     WRK3,DCMAINS        ADDRESS OF INSTRUCTION LINE OF DCM   16700001
         LH    WRK4,DCMLGNTH       GET THE LENGTH OF A LINE FROM DCM    16800001
         B     BUILDL              GO BUILD MESSAGE              Y02669 16850002
*                                  WRK3 ADDRESSES DCM INSTRUCTIONY02669 16860002
*      ON EXIT FROM HERE           LINE                          Y02669 16870002
*                                  WRK4 CONTAINS LENGTH OF LINE  Y02669 16880002
         EJECT                                                          16900002
*********************************************************************** 16950002
*                                                                     * 17000002
*            GET CORE FOR A MESSAGE THAT IS A WTO                Y02669 17050002
*        FOR A NON-CRT OR AN ORDINARY MESSAGE FOR A CRT          Y02669 17060002
*        REG 3 - WILL BE THE CURRENT POSITION IN BUFFER PAST MCS Y02669 17070002
*        REG 4 - WILL BE THE LENGTH OF THE BUFFER (60)           Y02669 17080002
*                                                                     * 17100002
*********************************************************************** 17150002
         SPACE 3                                                        17160002
BUILDWTO EQU   *                                                        17170002
         TM    XASSDS,XASSDS5      ARE LOCKS STILL SET?          Y02651 17170402
         BZ    NOLOCKON            NO,NO NEED TO TURN LOCKS OFF  Y02651 17170802
         BAL   R15,LOCKSOFF        YES,GO RELEASE LOCKS          Y02651 17171202
NOLOCKON EQU   *                                                 Y02651 17178802
         LA    WRK1,XASAVSTD+N12   AREA FOR STORAGE ADDRESS      Y02669 17180002
         MVC   XASAVSTD(N10),GETAREA    MOVE PARM LIST TO XSA    Y02669 17190002
         ST    WRK1,XASAVSTD+N4    WHERE GETMAIN TO STORE ADDR   Y02669 17192002
         LA    WRK1,XASAVSTD       ADDR OF PARM LIST FOR GETMAIN Y02669 17194002
         GETMAIN MF=(E,(1))        GET CORE FOR WTO                     17196002
         LTR   R15,R15             WAS GETMAIN SUCESSFUL?        Y02669 17198002
         BC    N7,NOCORE           NO, IEE328I CMD ABORTED(0503D)Y02669 17198402
         SPACE                                                          17198502
         L     WRK3,XASAVSTD+N12   YES,GOTTEN CORE'S ADDRESS     Y02669 17198802
         XC    N0(N4,WRK3),N0(WRK3) ZERO FOUR BYTES                     17199202
         OI    XASSDS,XASSDS1      SET WTO INDICATOR ON          Y02669 17199602
         OI    N2(WRK3),MCSFG      SET MCS FLAGS FOR WTO ON             17199702
         LA    WRK3,N4(WRK3)       INCREMENT BUFFER ADDRESS PAST MCS    17199802
         LA    WRK4,N60            LENGTH OF MSG BUFFER NOW 60          17199902
         EJECT                                                          17233202
*********************************************************************** 17300002
*                                                                     * 17450002
*           BLANK OUT THE BUFFER AREA FOR THE MESSAGE                 * 17460002
*    ON ENTRY:                                                   Y02669 17460402
*     WRK4 CONTAINS LENGTH OF DCM INSTRUCTION LINE               Y02669 17462002
*                OR REMAINING LENGTH OF WTO BUFFER, NOW 60       Y02669 17464002
*     WRK3 CONTAINS ADDRESS OF DCM INSTRUCTION LINE              Y02669 17466002
*                OR WTO BUFFER                                   Y02669 17468002
*    ON EXIT - WRK4 IS DESTROYED                                 Y02669 17468402
*                                                                     * 17470002
*********************************************************************** 17472002
         SPACE 2                                                        17474002
BUILDL   EQU   *                                                        17480002
         BCTR  WRK4,N0             DECREMENT THE LENGTH OF THE BUFFER   17490001
         BCTR  WRK4,N0             AREA BY TWO                          17492001
         MVI   N0(WRK3),BLANK      BLANK FIRST CHARACTER         Y02669 17494002
         EX    WRK4,BLANKOUT       PROPAGATE BLANKS              Y02669 17496002
*********************************************************************** 17498002
*                                                                     * 17498402
*                GET MESSAGE TEXT ENTRY IN TABLE                      * 17498802
*                                                                     * 17499202
*********************************************************************** 17499602
         SR    WRK4,WRK4           CLEAR REG                            17500001
         IC    WRK4,XAE            ERROR CODE FROM XSA                  17600001
         AR    WRK4,WRK4           DOUBLE CODE FOR INDEX                17700001
         LA    WRK13,TAB1(WRK4)    PT TO APPROPRIATE TAB1 ENTRY  Y02669 17800002
         LH    WRK13,N0(WRK13)     LOAD TABLE ELEMENT            Y02669 17900002
         LA    WRK10,TAB2(WRK13)   PT TO APPROPRIATE TAB2 ENTRY  Y02669 17910002
         EJECT                                                          17950001
*********************************************************************** 17960002
*                                                                     * 18000002
*         BUILD MESSAGE IN DCM INSTRUCTION LINE OR WTO BUFFER         * 18100002
*           WRK3 STILL POINTS TO BEGINNING OF WTO BUFFER OR DCM LINE  * 18150002
*                                                                     * 18200002
*********************************************************************** 18500002
         SPACE 2                                                        18550002
         MVC   N0(N3,WRK3),MSGID   MOVE IN IEE                   Y02669 18600002
         MVC   N3(N4,WRK3),N1(WRK10) FILL IN MSG ID              Y02669 18800002
         TM    N5(WRK10),CMDFLAG   DOES MSG REQUIRE CMND VERB?   Y02669 19200002
         BZ    OPDTEST             NO                            Y02669 19250002
         SPACE 2                                                        19310002
*********************************************************************** 19350002
*                                                                     * 19350402
*               MOVE COMMAND VERB INTO MESSAGE BUFFER            Y02669 19352002
*   AT THIS POINT REG 0 CONTAINS ZERO ( FROM M INSTRUCTION)      Y02669 19352402
*                                                                     * 19354002
*********************************************************************** 19360002
         SPACE 2                                                        19400001
MOVECDR  EQU   *                                                        19450002
         MVC   N8(N8,WRK3),XAV     MOVE IN VERB FROM XSA                19500002
         LA    WRK3,N9(WRK3)       INCREMENT MSG PTR AROUND VERB        19550002
         LA    WRK0,N9             INCREMENT VARIABLE TEXT COUNT        19600002
OPDTEST  EQU   *                                                        19800001
         TM    N5(WRK10),OPFLAG    DOES MSG REQUIRE OPERAND?     Y02669 19900002
         BZ    MOVETXT             NO                            Y02669 20000002
         EJECT                                                          20002002
*********************************************************************** 20010002
*                                                                     * 20012002
*        MOVE INVALID OPERAND INTO MESSAGE BUFFER                Y02669 20020002
*        WRK0 - LENGTH OF VARIABLE TEXT SO FAR (0 OR 9)          Y02669 20020402
*        WRK3 - POSITION IN MESSAGE BUFFER                       Y02669 20020802
*        WRK4 - LENGTH OF INVALID OPERAND                        Y02669 20021202
*        BADOP11 - ADDRESS OF INVALID OPERAND                    Y02669 20021602
*                                                                     * 20022002
*********************************************************************** 20030002
         SPACE 2                                                        20040002
MOVEOPD  EQU   *                                                        20050002
         SR    WRK4,WRK4           CLEAR FOR ICM INSTRUCTION     Y02669 20060002
         ICM   WRK4,N7,XASOPTR     ADDRESS OF INVALID OPERAND    Y02669 20070002
         BZ    MOVETXT             IF ZERO NO OPERAND            Y02669 20072002
         LR    BADOP11,WRK4        ADDRESS OF INVALID OPERAND    Y02669 20080002
         LA    WRK5,N8             MAXIMUM OPERAND LENGTH        Y02669 20090002
INCROP   EQU   *                                                        20092002
         LA    WRK4,N1(WRK4)       INCREMENT OPERAND ADDR BY ONE        20094002
         CLI   N0(WRK4),BLANK      IS THIS END OF THE OPERAND?   Y02669 20096002
         BE    GETLEN              YES                                  20098002
         CLI   N0(WRK4),COMMA      IS THIS A COMMA?                     20098402
         BE    GETLEN              YES                                  20098802
         CLI   N0(WRK4),PARA2      IS THIS A PARENTHSIS?                20099202
         BE    GETLEN              YES                                  20099602
         BCT   WRK5,INCROP         DECREMENT AND TEST NEXT CHAR  Y02669 20099702
GETLEN   EQU   *                                                        20099802
         SR    WRK4,BADOP11        LENGTH OF INVALID OPERAND     Y02669 20099902
         BCTR  WRK4,N0             DECREMENT FOR EXECUTE                20133202
         TM    N5(WRK10),OPENDFLG  IS OPERAND AT END OF MSG?     Y02669 20143202
         BZ    OPNOTEND            NO                            Y02669 20153202
         EX    WRK4,OPATEND        PUT BAD OPERAND AT END OF MSG Y02669 20155202
         LA    WRK4,N1(WRK4)       LENGTH OF INVALID OPERAND     Y02669 20157202
         B     CONTOP              CONTINUE TO BUILD MSG         Y02669 20159202
OPNOTEND EQU   *                                                 Y02669 20161202
         EX    WRK4,MOVEINOP       PUT BAD OPERAND IN MSG TEXT   Y02669 20163202
         LA    WRK4,N2(WRK4)       LENGTH OF OPERAND + BLANK     Y02669 20165202
         AR    WRK3,WRK4           INCREMENT DCM PTR AROUND VERB Y02669 20165602
CONTOP   EQU   *                                                        20166002
         AR    WRK0,WRK4           INCREMENT VARIABLE TEXT COUNT        20166402
         EJECT                                                          20188502
*********************************************************************** 20188602
*                                                                     * 20188902
*         MOVE FIXED TEXT FROM TABLE TWO INTO MESSAGE BUFFER          * 20200002
*         WRK3 - POSITION IN MESSAGE BUFFER                           * 20250002
*         WRK6 - TOTAL LENGTH OF VARIABLE TEXT                        * 20260002
*                                                                     * 20300002
*********************************************************************** 20700002
         SPACE 2                                                        20750002
MOVETXT  EQU   *                                                        20800001
         SR    WRK6,WRK6           CLEAR REG                            20900001
         IC    WRK6,N0(WRK10)      GET FIXED MSG TEXT LENGTH - 1 Y02669 21000002
         EX    WRK6,FILLTEXT       MOVE IN FIXED TEXT            Y02669 21100002
         LA    WRK6,N9(WRK6)       LENGTH OF ID,+ BLANK,+ 1             21200001
         AR    WRK3,WRK6           UPDATE BUFFER POINTER TO INCLUDE TXT 21300001
         AR    WRK6,WRK0           LENGTH OF VERB AND OPERAND OR ZERO   21400001
         TM    N5(WRK10),VTXTFLAG  DOES MSG HAVE MORE TEXT?      Y02669 21800002
         BO    D5903D              YES, EXIT TO IEE5903D         Y02669 21900002
         SPACE                                                          22000002
         TM    XASSDS,XASSDS1      IS THIS A WTO?                Y02669 22400002
         BO    ISSUEWTO            YES                                  22500002
         SPACE                                                          22600002
*********************************************************************** 22650002
*       THE MESSAGE WAS PUT IN DCM INSTRUCTION LINE              Y02669 22660002
*********************************************************************** 22700002
         OI    DCMIOCM1,DCMWRINS   SET BIT TO WRITE INST LINE           22900001
         TM    DCMIOUNQ,DCMW2250   DOES DEVICE HAVE A LIGHT PEN?        23300001
         BZ    RETURN              NO                            Y02669 23400002
         SPACE                                                          23450002
         L     WRK3,DCMAINS        POINT TO INSTRUCTION LINE IN DCM     23900002
         MVC   N59(N15,WRK3),ENCANCEL  MOVE ENTER-CANCEL MSG INTO LINE  24000002
         NI    DCMIOUNQ,XFF-DCMINNOR TURN OFF NORMAL LINE BIT    Y02669 24100002
         OI    DCMIOUNQ,DCMINERR   INDICATE ERROR MSG IN INST LINE      24200001
         SPACE 2                                                        24400002
RETURN   EQU   *                                                        24600001
         TM    XASSDS,XASSDS5      ARE LOCKS STILL SET?          Y02651 24660002
         BZ    RETURNOK            NO,NO NEED TO TURN LOCKS OFF  Y02651 24670002
         BAL   R15,LOCKSOFF        GO RELEASE LOCKS              Y02669 24672002
RETURNOK EQU   *                                                 Y02651 24698802
         L     RETURN14,XASAVSTD+N16   RESTORE RETURN ADDRESS    Y02669 24699202
         BR    RETURN14            RETURN TO CALLER              Y02669 24700002
         EJECT                                                          25600001
*********************************************************************** 25800002
*                                                                     * 28800002
*         PREPARE TO WRITE MESSAGE VIA WTO AND FREE CORE         Y02669 28900002
*                                                                     * 29000002
*********************************************************************** 29300002
         SPACE 2                                                        29350002
ISSUEWTO EQU   *                                                        29400002
         L     WRK1,XASAVSTD+N12   ADDRESS OF WTO BUFFER         Y02669 29500002
         LA    WRK6,N4(WRK6)       4 EXTRA BYTES FOR WTO (MCS + LEN)    29600001
         STH   WRK6,N0(WRK1)       PUT LENGTH OF TEXT + 4 IN BUFFER     29700002
         AR    WRK6,WRK1           CALCULATE END OF BUFFER              29800002
         MVC   N0(N4,WRK6),DRCODES MOVE IN DESC AND ROUTE CODES         29900001
         SR    WRK0,WRK0           CLEAR REG                            30000001
         IC    WRK0,XAU            SOURCE CONSOLE ID FROM XSA           30100002
         WTO   MF=(E,(1))          WRITE MESSAGE                        30200001
         SPACE                                                          30250002
         L     WRK1,XASAVSTD+N12   ADDRESS OF AREA FOR FREEMAIN  Y02669 30600002
         FREEMAIN R,LV=N64,A=(1),SP=SP229                        Y02669 30700002
         B     RETURNOK            RETURN TO CALLER              Y02669 31100002
         EJECT                                                          31110002
*********************************************************************** 31160002
*                                                                     * 31210002
*         EXIT TO IEE5903D WITH THE FOLLOWING OUTPUT:            Y02669 31260002
*         XSAR2 - BASE REGISTER FOR XSA                          Y02669 31270002
*                 XASAVSTD + 12 BEGINNING ADDRESS OF WTO BUFFER  Y02669 31272002
*         XASAVSTD + 16 - RETURN ADDRESS                                31276002
*         WRK3 - CURRENT POSITION IN MESSAGE BUFFER              Y02669 31280002
*         WRK6 - TOTAL LENGTH OF VARIABLE TEXT                   Y02669 31290002
*         TDCMR8 - BASE REGISTER FOR TRANSIANT DCM               Y02669 31300002
*                                                                     * 31310002
*********************************************************************** 31360002
         SPACE 2                                                        31410002
D5903D   EQU   *                                                 Y02669 36200002
         L     R15,VCON5903        GET ADDRESS OF SECOND LOAD    Y02669 36300002
         BR    R15                 GO TO IEE5903D                Y02669 36350002
         SPACE  2                                                       37310002
*********************************************************************** 37312002
*                                                                     * 37314002
*                        EXIT TO IEE0503D                        Y02669 37316002
*           LOCKS WERE RELEASED BEFORE ATTEMPTING THE GETMAIN    Y02651 37316402
*                                                                     * 37318002
*********************************************************************** 37318402
         SPACE 2                                                        37318802
NOCORE   EQU   *                                                 Y02669 37320002
         L     RETURN14,XASAVSTD+N16 RESTORE RETURN ADDRESS      Y02669 37325002
         MVI   XAE,MSG328          MSG CODE -IEE328I CMD ABORTED Y02669 37330002
         L     R15,VCON0503        GO TO IEE0503D TO ISSUE MSG   Y02669 37340002
         BR    R15                                               Y02669 37342002
         EJECT                                                          37342102
*********************************************************************** 37342202
*             CMS AND LOCAL LOCKS MUST BE RELEASED BEFORE        Y02651 37342302
*                 ISSUING SVC'S AND RETURNING                    Y02651 37342402
*********************************************************************** 37342502
         SPACE 2                                                        37342602
LOCKSOFF EQU   *                                                 Y02651 37342702
         STM   BADOP11,RETURN14,XASAVLOC SAVE REGS FOR SETLOCK   Y02651 37342802
         SETLOCK RELEASE,TYPE=CMS,                                     *37342902
               RELATED=(TR,PT,K,IEE7503D(LOCKSET))                      37343002
         SETLOCK RELEASE,TYPE=LOCAL,                                   *37343102
               RELATED=(TR,PT,K,IEE7503D(LOCKSET))                      37343502
         LM    BADOP11,RETURN14,XASAVLOC    RESTORE REGS         Y02651 37343602
         NI    XASSDS,XFF-XASSDS5  INDICATE LOCKS OFF            Y02651 37343702
         BR    R15                                                      37343802
         EJECT                                                          37344902
*********************************************************************** 37345002
*                   EXECUTE INSTRCUTIONS                         Y02669 37345102
*********************************************************************** 37345202
         SPACE 2                                                        37345302
OPATEND  MVC   N25(N0,WRK3),N0(BADOP11) PUT OPERAND AT MSG END   Y02669 37345402
BLANKOUT MVC   N1(N0,WRK3),N0(WRK3)  USED TO BLANK MESSAGE BUFFERY02669 37345502
MOVEINOP MVC   N8(N0,WRK3),N0(BADOP11)  PUT OPERAND INTO MSG     Y02669 37345602
FILLTEXT MVC   N8(N0,WRK3),N6(WRK10)  MOVE FIX TEXT INTO BUFFER  Y02669 37345702
         SPACE 2                                                        37345802
*********************************************************************** 37345902
*                   GETMAIN LIST FORM                            Y02669 37346002
*********************************************************************** 37346402
GETAREA  GETMAIN EC,LV=N64,A=NOCORE,SP=SP229,MF=L                Y02669 37348002
         EJECT                                                          37357102
*********************************************************************** 37360002
*                                                                     * 37400002
*  THE FOLLOWING TABLE IS INDEXED BY TWICE THE MESSAGE CODE IN   Y02669 37500002
*  XASTSAVE. EACH HALF-WORD CONTAINS AN INDEX TO THE TAB2        Y02669 37600002
*  ELEMENT CONTAINING THE APPROPRIATE MESSAGE TEXT               Y02669 37650002
*                                                                     * 37700002
*********************************************************************** 37750002
PREMSG   EQU   6                   BYTES BEFORE MESSAGE TEXT            37800001
TAB1     EQU   *                                                        37900001
         DC    AL2(0)                                                   38000001
         DC    X'FFFF'             OBSOLETE MESSAGE              Y02669 38100002
         DC    Y(TM02-TAB2-PREMSG)                                      38200001
         DC    Y(TM03-TAB2-PREMSG)                                      38300001
         DC    Y(TM04-TAB2-PREMSG)                                      38400001
         DC    Y(TM05-TAB2-PREMSG)                                      38500001
         DC    X'FFFF'             OBSOLETE MESSAGE              Y02669 38600002
         DC    X'FFFF'             OBSOLETE MESSAGE              Y02669 38700002
         DC    Y(TM08-TAB2-PREMSG)                                      38800001
         DC    Y(TM09-TAB2-PREMSG)                                      38900001
         DC    Y(TM10-TAB2-PREMSG)                                      39000001
         DC    Y(TM11-TAB2-PREMSG)                                      39100001
         DC    Y(TM12-TAB2-PREMSG)                                      39200001
         DC    Y(TM13-TAB2-PREMSG)                                      39300001
         DC    Y(TM14-TAB2-PREMSG)                                      39400001
         EJECT                                                          39450001
*********************************************************************** 39460002
*                                                                     * 39500002
*  EACH ENTRY IN THE FOLLOWING TABLE CONTAINS:                   Y02669 39600002
*      A 1-BYTE LENGTH OF THE PREFORMATTED MESSAGE TEXT - 1      Y02669 39650002
*        4-BYTE ID FILLER                                        Y02669 39660002
*        1-BYTE MESSAGE FLAGS                                    Y02669 39670002
*               X'80' - MESSAGE REQUIRES COMMAND VERB FROM XAV   Y02669 39680002
*               X'40' - MESSAGE REQUIRES INVALID OPERAND FROM XASOPTR * 39690002
*               X'20' - MESSAGE REQUIRES ADDITIONAL TEXT FROM IEE5903D* 39692002
*               X'10' - INVALID OPERAND BELONGS AT END OF MESSAGE TEXT* 39694002
*        PREFROMATTED MESSAGE TEXT                               Y02669 39800002
*                                                                     * 39900002
*********************************************************************** 39950002
TAB2     EQU   *                                                        40000001
         DC    AL1(L'TM02-1)               LENGTH OF FIXED MSG TEXT     40600002
         DC    C'150I'                     MESSAGE ID FILLER            40700002
         DC    X'00'                       MESSAGE TYPE FLAG            40800002
TM02     DC    C'CHANGE OPTIONS IF DESIRED'  FIXED MSG TEXT             40900002
*                                                                       41000001
         DC    AL1(L'TM03-1)                                            41100001
         DC    C'151I'                                                  41200001
         DC    X'20'                                                    41300001
TM03     DC    C'DELETE REQUEST INCONSISTENT-'                          41400001
*                                                                       41500001
         DC    AL1(L'TM04-1)                                            41600001
         DC    C'156I'                                                  41700001
         DC    X'D0'                                                    41800001
TM04     DC    C'INVALID OPERAND -'                                     41900001
*                                                                       42000001
         DC    AL1(L'TM05-1)                                            42100001
         DC    C'158I'                                                  42200001
         DC    X'20'                                                    42300001
TM05     DC    C'K REQUEST INCONSISTENT-'                               42400001
*                                                                       42500001
         DC    AL1(L'TM08-1)                                            43600001
         DC    C'345I'                                                  43700001
         DC    X'80'                                                    43800001
TM08     DC    C'AUTHORITY INVALID'                                     43900001
*                                                                       44000001
         DC    AL1(L'TM09-1)                                            44100001
         DC    C'921I'                                                  44200001
         DC    X'E0'                                                    44300001
TM09     DC    C'REJECTED '                                             44400001
*                                                                       44500001
         DC    AL1(L'TM10-1)                                            44600001
         DC    C'924I'                                                  44700001
         DC    X'20'                                                    44800001
TM10     DC    C'INVALID AREA DEFINITION '                              44900001
*                                                                       45000001
         DC    AL1(L'TM11-1)                                            45100001
         DC    C'925I'                                                  45200001
         DC    X'E0'                                                    45300001
TM11     DC    C'OPERAND '                                              45400001
*                                                                       45500001
         DC    AL1(L'TM12-1)                                            45600001
         DC    C'926I'                                                  45700001
         DC    X'20'                                                    45800001
TM12     DC    C'L=CCA OPERAND INVALID-'                                45900001
*                                                                       46000001
         DC    AL1(L'TM13-1)                                            46100001
         DC    C'927I'                                                  46200001
         DC    X'A0'                                                    46300001
TM13     DC    C'REQUEST AMBIGUOUS-'                                    46400001
*                                                                       46500001
         DC    AL1(L'TM14-1)                                            46600001
         DC    C'931I'                                                  46700001
         DC    X'C0'                                                    46800001
TM14     DC    C'INSUFFICIENT STORAGE FOR COMMAND'                      46900001
*                                                                       47000001
         EJECT                                                          47050001
*********************************************************************** 47060002
*                                                                     * 47100002
*                             CONSTANTS                               * 47150002
*                                                                     * 47200002
*********************************************************************** 47250002
         SPACE                                                          47300002
VCON5903 DC    V(IEE5903D)         SECOND LOAD OF MSG MODULE     Y02669 47400002
VCON0503 DC    V(IEE0503D)         MESSAGE MODULE TO ISSUE '328I'Y02669 47450002
ENCANCEL DC    C'*ENTER**CANCEL*'  ADDED FOR CRT WITH CURSOR     Y02669 47500002
MSGID    DC    C'IEE'              MESSAGE ID                    Y02669 47600002
DRCODES  DC    X'0800'             DESCRIPTOR CODE                      47700001
         DC    X'0000'             ROUTING CODE                         47800001
         SPACE 5                                                        47810002
*********************************************************************** 47850002
*                                                                     * 47860002
*                             PATCH AREA                              * 47870002
*                                                                     * 47880002
*********************************************************************** 47890002
         SPACE 2                                                        47892002
PATCH    DC    C'****PATCH AREA****'                                    47900001
PATCH2   DC    C'IEE5603D-TEST ONLY'                                    48000001
PATCH3   DC    36C' '                                                   48100001
         EJECT                                                          48200101
         IEETDCM                                                 Y01012 48400101
         EJECT                                                          48500001
         IEERDCM                                                        48550002
         EJECT                                                          48600002
         IEECUCM  FORMAT=NEW                                            48700002
         EJECT                                                          48800001
DXSA     DSECT                                                          48900001
         IEEXSA                                                         49000001
         EJECT                                                          49900001
DCVT     DSECT                                                          50000001
         CVT                                                            50100001
         EJECT                                                          50150002
         IHAPSA                                                         50160002
         END                                                            50200001
./  ADD  SSI=42480763,NAME=IEE5703D
 TITLE 'IEE5703D - VARY HARDCPY,OFF AND HARDCPY MESSAGE ROUTINE'        01061503
IEE5703D CSECT                                                          01061602
*********************************************************************** 01061802
*                                                                       01063002
* MODULE NAME      = IEE5703D                                           01065002
*    CSECT NAME    = IEE5703D                                           01067002
*                                                                       01069002
* LOAD MODULE NAME = IGC0003D                                           01069402
*                                                                       01079402
* DESCRIPTIVE NAME = VARY HARDCPY,OFF  PROCESSOR                        01089402
*                    AND                                                01089802
*                    HARDCPY MESSAGE ROUTER                             01090202
*                                                                       01090602
* COPYRIGHT        = MISSING                                            01091002
*                                                                       01094302
* STATUS           = OS/VS/2 RELEASE 3                         @Z30LPTJ 01096303
*                                                                       01096702
* FUNCTION         = 1. THIS MODULE TAKES THE HARDCPY FUNCTION OUT      01097102
*                    OF A SYSTEM WHEN THE OPERATOR REQUESTS IT.         01097502
*                    IT IS THE RESPONDER TO THE HARDCPY,OFF COMMAND.    01097602
*                    2. IF AN ERROR CONDITION HAS BEEN DETECTED IN      01097702
*                    THE HARDCPY PROCESSOR OR IN THIS MODULE,           01098802
*                    THIS ROUTINE GIVES CONTROL TO THE APPROPRIATE      01100802
*                    ERROR MESSAGE MODULE AND PASSES IT THE CORRECT     01100902
*                    ERROR CODE.                                        01116602
*                                                                       01126602
* OPERATION        = THIS ROUTINE CHECKS THE CODE PASSED TO IT IN       01128602
*                    THE XAE AND EITHER PROCESSES THE COMMAND OR        01130602
*                    SETS UP TO GO TO AN ERROR MESSAGE MODULE.          01131002
*                    IN PROCESSING THE COMMAND, IT CHECKS THAT          01131402
*                    THE SYSTEM DOES NOT REQUIRE HARDCPY, VALIDATES     01131802
*                    THAT THE UNIT SPECIFIED IN THE COMMAND IS THE      01132202
*                    CURRENT HARDCPY LOG.  IF NO UNIT WAS SPECIFIED     01132302
*                    THAN IT VALIDATES THE PRESENCE OF A HARDCPY        01132402
*                    DEVICE.                                            01137602
*                    IF ALL IS CORRECT, THIS ROUTINE SETS THE           01139602
*                    APPROPRIATE INFORMATION INDICATING THAT NO         01141602
*                    HARDCPY EXISTS AND GOES TO IEE2103D TO ISSUE       01142002
*                    A MESSAGE TO THE REQUESTING CONSOLE INFORMING      01142402
*                    THE OPERATOR THAT HIS COMMAND WAS ACCEPTED         01142802
*                    AND PROCESSED                                      01142902
*                                                                       01148102
* NOTES                                                                 01150102
*    DEPENDENCIES  = NONE                                               01152102
*   CHARACTER/CODE DEPENDENCIES                                         01152502
*                  = THIS MODULE CAN BE ASSEMBLED WITH ANY NEW          01152902
*                    CHARACTER/CODE SET.                                01153302
*                                                                       01153402
* RESTRICTIONS     = REG2 PTS TO THE XSA ON INPUT AND ON OUTPUT         01158602
*   REGISTER CONVENTIONS                                                01160602
*                  = REGISTERS ARE DEFINES AT LABEL: DEFREG             01162602
*   PATCH LABEL    = PATCH                                              01163002
*                                                                       01163402
* MODULE TYPE      = CSECT                                              01163802
*   PROCESSOR      = ASSEMBLER                                          01163902
*   MODULE SIZE    = VS/2 = '2BE'                              @Z30LPTJ 01169103
*   ATTRIBUTES     = REENTRANT, REUSABLE, REFRESHABLE, PAGED LPA,       01171102
*                    ZERO PSW PROTECT KEY, SUPERVISOR MODE              01173102
*                                                                       01173502
* ENTRY POINT      = IEE5703D FROM IEE4703D                             01173902
*   PURPOSE        = TO PROCESS THE HARDCPY,OFF COMMAND (FROM 4703D)    01174302
*                    OR TO ROUTE MSG TO IEE0503D OR IEE2103D FOR        01174402
*                    ERROR IN THE V HARDCPY COMMAND (FROM 47 AND 72)    01176102
*   LINKAGE        = BRANCH                                             01178102
*   INPUT          = IF CONTROL IS FROM IEE4703D FOR A                  01178502
*                    V HARDCPY,OFF COMMAND:                             01178902
*                       R2 PTS TO THE XSA                               01179302
*                       XAE = X'00'                                     01179402
*                    IF CONTROL IS FROM 4703D FOR ERROR IN THE          01179502
*                    V HARDCPY COMMAND:                                 01184002
*                       R2 PTR TO THE XSA                               01186002
*                       XAE = X'20' = GOTO 0503D -                      01188002
*                            MSG = UNIDENTIFIABLE KEYWORD               01188402
*                       XAE = X'24' - GOTO 2103D                        01188902
*                            MSG = AUTHORITY INVALID                    01189302
*                       XAE = X'28' - GOTO 0503D                        01189702
*                            MSG = INVALID NUMERICS                     01189802
*                    IF CONTROL IS FROM 7203D FOR ERROR CONDT.          01189902
*                       R2 PTS TO THE XSA                               01190002
*                       XAE = X'12' - GOTO 0503D                        01191302
*                            MSG = UNIT REF INVALID                     01193302
*                       XAE = X'16' - GOTO 0503D                        01193702
*                            MSG = SYSLOG NOT SUPPORTED                 01193802
*                       XAE = X'20' - GOTO 0503D                        01193902
*                            MSG = UNIDENTIFIABLE KEYWORD               01208502
*                       XAE = X'28' - GOTO 0503D                        01218502
*                            MSG = INVALID NUMERICS                     01220502
*   REGISTERS SAVED= NONE                                               01222502
*   REGISTER USAGE = R2 - PTR TO XSA                                    01222902
*                    R3 - ADDRESSABILITY                                01223302
*                    R4 - UCME PTR                                      01228202
*                    R7 - EOB PTR                                       01230202
*                    R9 - UNIT PTR                                      01232202
*                    R10 - UCM REG                                      01232602
*                    R11 - UCMPRFX PTR                                  01233002
*                    R14 - RETURN ADDRESS                               01237902
*   REGISTERS RESTORED                                                  01239902
*                  = NONE                                               01241902
*                                                                       01242302
* EXIT - NORMAL    = TO IEE2103D VIA BRANCH                             01242702
*   CONDITIONS     = HARDCPY,OFF COMMAND WAS SUCCESSFUL                 01247602
*                    INFORMATIONAL MESSAGE HAS TO BE SENT TO            01249602
*                    THE OPERATOR                                       01251602
*   OUTPUT         = REG2 PTR TO THE XSA                                01252002
*                    XAE = X'2A' FOR MESSAGE:                           01252402
*                       INACTIVE AS HARDCOPY                            01252502
*                    XAV HAS 'UNIT' NAME OR SYSLOG (WHATEVER            01257302
*                    WAS THE HARDCPY DEVICE)                            01259302
*   RETURN CODES   = NONE                                               01261302
*                                                                       01261702
* EXIT - ERROR     = TO IEE2103D OR IEE0503D VIA BRANCH                 01262102
*   CONDITIONS     = ERROR HAS BEEN DETECTED EITHER IN THE              01262502
*                    V HARDCPY,OFF OR THE V HARDCPY COMMANDS            01264002
*   OUTPUT         = REG2 PTR TO THE XSA                                01266002
*                    XAE = X'2D' - MSG: 'REQ'D FOR HARDCPY' MOD=2103D   01266402
*                    XAE = X'2C' - MSG: 'CHANGING STATUS  ' MOD=2103D   01266802
*                    XAE = X'1A' - MSG: 'SYSLOG NOT SUPPORTED'          01266902
*                                                           MOD=2103D   01267002
*                    XAE = X'29' - MSG: 'AUTHORITY INVALID' MOD=2103D   01267102
*                    XAE = X'09' - MSG: 'UNIDENTIFIABLE KEYWORD'        01271202
*                                                           MOD=0503D   01273202
*                    XAE = X'06' - MSG: 'INVALID NUMERICS'  MOD=0503D   01275202
*                    XAE = X'0D' - MSG: 'UNIT REF INVALID'  MOD=0503D   01275602
*   RETURN CODES   = NONE                                               01275702
*                                                                       01275802
* EXTERNAL REFERENCES                                                   01276202
*   ROUTINES       = IEE2103D                                           01276602
*                    IEE0503D                                           01276702
*   DATA AREAS     = SEE EXITS - OUTPUT                                 01276802
*                                                                       01276902
* CONTROL BLOCKS   = 1. EXTENDED SAVE AREA (XSA)                        01278102
*                    2. UNIT CONTROL MODULE (UCM)                       01280102
*                       FIELDS TESTED  - UCMATR- BIT=UCMUF              01280502
*                                                    UCMOF              01284302
*                                        UCMDISP-BIT=UCMDISPB           01286302
*                                                    UCMDISPC           01286702
*                                        UCMHCUCM                       01287102
*                                        UCMSFLGS-BIT=UCMSYSG           01287502
*                                        UCMUCB                         01287902
*                                        UCMVEA                         01288002
*                       FIELDS UPDATED - UCMDISP - BIT=UCMDISPB         01288102
*                                        UCMHCUCM                       01289102
*                                        UCMSFLGS- BIT=UCMSYSB          01291102
*                                                      UCMSYSG          01291202
*                    3. UNIT CONTROL BLOCK (UCB)                        01291402
*                       FIELDS TESTED  - SRTESTAT - BIT=SRTEDADI        01291802
*                                        UCBNAME                        01291902
*                       FIELDS UPDATED - NONE                           01292802
*                    4. CVT                                             01293202
*                       FIELDS TESTED  - CVTCUCB                        01293602
*                       FIELDS UPDATED - NONE                           01294002
*                                                                       01294402
* TABLES           = NONE                                               01294502
*                                                                       01294802
* MACROS           = SETLOCK                                            01295202
*                                                                       01301802
* MAPPING MACROS   = IEEXSA                                             01305002
*                    IEECUCM                                            01308202
*                    IEFUCBOB                                           01320202
*                    CVT                                                01320602
*                    IHAPSA                                             01320702
*   SERIALIZATION  = THE CMS AND LOCAL LOCKS WILL PROTECT THE           01321002
*                    UCB AND UCM IN THIS MODULE FOR THE VARY HARDCPY    01322302
*                    AND THE VARY HARDCPY,OFF COMANDS                   01324302
*                    THE LOCKS ARE OBTAINED AT:                         01326302
*                       HSETLCK                                         01326702
*                    AND THEY ARE RELEASED AT:                          01327102
*                       HUNSTLK                                         01327502
*                    THE FOLLOWING AREAS MUST BE PROTECTED:             01327602
*                       UCMDISP   BIT= UCMSYSB         UCM              01327702
*                       UCMSFLGS  BIT= UCMSYSB         UCM              01328102
*                                      UCMSYSG                          01328502
*                       UCMHCUCM                                        01328902
*                       UCMATR    BIT= UCMUF           UCM              01329002
*                                                                       01329102
*                       SRTESTAT  BIT= SRTEDADI        UCB              01329202
*                    NO LOCKS ARE REQUIRED FOR THIS MODULE'S            01329302
*                    MESSAGE ROUTINE FUNCTION.                          01329402
*                                                                       01329602
* CHANGE LEVEL     = Y02669, Y02651, Z30LPTJ                   @Z30LPTJ 01329703
*                                                                       01330402
* CHANGE ACTIVITY  = N/A                                                01331702
*                                                                       01333002
* MESSAGES         = IEE345I VARY AUTHORITY INVALID                     01334302
*                       THE MASTER CONSOLE DID NOT ISSUE THIS COMMAND   01335602
*                    IEE026I SYSLOG NOT SUPPORTED                       01336902
*                       SYSLOG WAS SPECIFIED IN THE COMMAND BUT         01338202
*                       SYSLOG IS NOT SUPPORTED                         01339502
*                    IEE313I UNIT REF INVALID                           01340802
*                       THIS MESSAGE IS WRITTEN WHENEVER AN INCORRECT   01342102
*                       UNIT IS GIVEN OR NO UNIT IS GIVEN BUT NO        01343402
*                       HARDCPY EXISTS.                                 01344702
*                    IEE309I UNIDENTIFIABLE KEYWORD                     01346002
*                       A KEYWORD WAS SPECIFIED IN THE COMMAND, BUT     01347302
*                       IT DOES NOT MATCH SYNTACTICALLY TO ANY          01348602
*                       ALLOWED KEYWORD                                 01349902
*                    IEE338I INACTIVE AS HARDCPY                        01351202
*                       THIS MESSAGE IS ISSUED UPON PROCESSING OF A     01352502
*                       VALID HARDCPY,OFF COMMAND.                      01353802
*                    IEE339I CHANGING STATUS                            01355102
*                       A VARY HARDCPY COMMAND WAS ISSUED FOR A         01356402
*                       DEVICE WHICH IS IN THE PROCESS OF CHANGING      01357702
*                       TO A CONSOLE OR FROM THE CONSOLE STATE.         01359002
*                    IEE299I REQ'D FOR HARDCPY                          01360302
*                       A VARY HARDCPY,OFF WAS ISSUED HOWEVER, THE      01361602
*                       HARDCPY DEVICE IS NEEDED BECAUSE EITHER         01362902
*                       MORE THAN ONE ACTIVE CONSOLE IS PRESENT ON      01364202
*                       THE SYSTEM, OF AT LEAST ONE (OR MORE) ACTIVE    01365502
*                       GRAPHIC CONSOLES ARE PRESENT.                   01366802
*                    IEE306I VARY INVALID NUMERICS                      01368102
*                       MSG COMES OUT WHEN AN INVALID ROUTCODE WAS      01369402
*                       TO BE ASSIGNED TO THE HARDCPY DEVICE.           01370702
*                                                                       01372002
* ABEND CODES      = NONE                                               01373302
*                                                                       01374602
* PACKAGING        = IEE5703D WILL BE PART OF LOAD MODULE               01375902
*                       = IGC0003D                                      01377202
*                    THIS LOAD MODULE ALIASES ARE                       01378502
*                       = NONE                                          01379802
*                    THIS LOAD MODULE ENTRY POINTS ARE                  01381102
*                       = IGC0003D                                      01382402
*                    MODULE WILL RESIDE IN : LPALIB                     01383702
*                                                                       01385002
* SYSGEN           = SUPPLIED BY SECTIONS:                              01386302
*                    PACKAGING                                          01387602
*                    LOAD MODULE NAME                                   01388902
*                    THIS CSECT WILL BE INCLUDED AT SYSGEN FROM         01389302
*                    DLIB -AOSB3- BY MACRO -SGIEF441-                   01389702
*                                                                       01390202
* SYSTEM LIBRARIES = NONE                                               01391502
*                                                                       01392802
*********************************************************************** 01394102
         EJECT                                                          01395402
*                                                                       01396702
*   REGISTER EQUATES                                                    01398002
*                                                                       01399302
DEFREG   EQU   *                                                 Y02669 01400602
R0       EQU   0                                                        01401902
R1       EQU   1                                                        01403202
R2       EQU   2                   XSA                                  01404502
R3       EQU   3                   ADDRESS                              01405802
R4       EQU   4                   UCME                           19784 01407102
R5       EQU   5                                                  19784 01408402
R6       EQU   6                                                  19784 01409702
R7       EQU   7                   EOB REG                        19784 01411019
R8       EQU   8                                                  19784 01511002
R9       EQU   9                   UNIT PTR                       19784 01611019
R10      EQU   10                  UCM REG                        19784 01711019
R11      EQU   11                  UCMPFX REG                     19784 01811019
R12      EQU   12                                                 19784 01911019
R13      EQU   13                                                 19784 02011019
R14      EQU   14                  RET ADDR                       19784 02111019
R15      EQU   15                                                 19784 02211019
         SPACE 10                                                       04200019
*********************************************************************** 04400019
*                                                                 19784 04600019
*        EQUATES                                                  19784 04800019
*                                                                 19784 05000019
*********************************************************************** 05200019
*                                                                 19784 05400019
ZERO     EQU   0                                                  19784 05600019
ONE      EQU   1                                                  19784 05800019
TWO      EQU   2                                                  19784 06000019
TRE      EQU   3                                                  19784 06200019
FOR      EQU   4                                                  19784 06400019
SIX      EQU   6                                                  19784 06600019
EIT      EQU   8                                                  19784 06800019
TWLV     EQU   12                                                 19784 07200019
FIFTN    EQU   15                                                 19784 07400019
*                                                                 19784 07600019
*                                                                 19784 07800019
REQCD    EQU   8                                                  19784 08000019
UREFCD   EQU   12                                                 19784 08200019
KEYCD    EQU   20                                                 19784 08400019
NUM6     EQU   6                                                  19784 08500019
*                                                                 19784 08600019
CD9      EQU   9                                                  19784 08800019
CD13     EQU   13                                                 19784 09000019
CD26     EQU   26                                                 19784 09200019
CD41     EQU   41                                                 19784 09400019
CD44     EQU   44                                                 19784 09600019
CD45     EQU   45                                                 19784 09800019
*                                                                 19784 10000019
*                                                                 19784 10400019
*                                                                 19784 10600019
BLANK    EQU   C' '                                               19784 10800019
*                                                                 19784 11000019
MSG42    EQU   42                                                 19784 11600019
*                                                                 19784 11800019
FOX      EQU   255                                                19784 12400019
*                                                                 19784 12600019
         EJECT                                                          13000019
*********************************************************************** 13200019
*                                                                 19784 13400019
*        HARDCPY,OFF PROCESSOR                                    19784 13600019
*                                                                 19784 13800019
*********************************************************************** 14000019
*                                                                 19784 14200019
*                                                                 19784 14400019
         BALR  R3,ZERO                                            19784 14600019
         USING *,R3                                               19784 14800019
         MODID BR=YES                                            Y01886 14850001
         USING XSA,R2                                             19784 15000019
         L     R5,XAL              GET PTR TO UNIT BEGIN          19784 15200019
         LA    R5,ZERO(R5)                                        19784 15400019
         L     R10,CVTPTR                                         19784 15600019
         USING OCVT,R10                                           19784 15800019
         L     R10,CVTCUCB         GET PTR TO UCM                 19784 16000019
         DROP  R10                                                19784 16200019
        USING UCM,R10                                            Y02669 16400002
*                                                                 19784 16600019
         LR    R11,R10             PTR TO UCM                     19784 16800019
         SH    R11,FOUR             MINUS 4                       19784 17000019
         L     R11,ZERO(R11)       UCMPFX PTR                     19784 17200019
         USING UCMPRFX,R11                                        19784 17400019
         SPACE 10                                                 19784 17600019
*                                                                 19784 17800019
OTABLE   EQU   *                                                  19784 18000019
         SR    R4,R4                                              19784 18200019
         IC    R4,XAE              INSERT CODE FOR WORK BRANCH    19784 18400019
         BC    FIFTN,BRANCH(R4)    GO TO APPROPRIATE WORK         19784 18600019
*                                                                 19784 18800019
*                                                                 19784 19000019
BRANCH   EQU   *                                                  19784 19200019
         B     OSCAN               GO TO PROCESS HARDCPY,OFF      19784 19400019
         B     MSGCHG              GO PUT CHANGING STATUS MSG     19784 19600019
         B     REQHCPY             GO PUT REQ'D FOR HARDCPY MSG   19784 19800019
         B     UTREFINV            XAE 12-UNIT REF INVALID        19784 20000019
         B     NOTSUPP             XAE 16-SYSLOG NOT SUPPORTED    19784 20200019
         B     KEYWORD             XAE 20-KEYWORD MISSPELLED      19784 20400019
         B     AUTHINV             XAE 24- AUTHORITY INVALID      19784 20600019
         B     INVNUM              XAE IS 28 INVALID NUMERICS    Y02669 20700002
*                                                                 19784 20800019
         EJECT                                                    19784 21000019
*                                                                 19784 21200019
OSCAN    EQU   *                                                  19784 21400019
         LR    R12,R5              SAVE UNIT PTR FOR MSG          19784 21800019
OLOOP    EQU   *                                                  19784 22000019
         CLC   ZERO(TWO,R5),HUNIT      ,H FOLLOWS                 19784 22200019
         BE    OFOUND              YES, FOUND IT                  19784 22400019
         LA    R5,ONE(R5)          INDEX BY ONE MORE              19784 22600019
         B     OLOOP                GO CHECK NEXT CHARACTER       19784 22800019
OFOUND   EQU   *                                                  19784 23000019
         LA    R5,TWLV(R5)         INDEX PAST COMD                19784 23200019
         L     R4,XAR              PTR TO PARAMS                  19784 23400019
         LA    R4,ZERO(R4)         CLEAR HIGH ORDER BYTE          19784 23600019
         AH    R4,ZERO(R4)         GET END OF BUFFER ADDRESS      19784 23800019
         CR    R5,R4               IS THIS END OF BUFFER          19784 24000019
         BH    OINVALID            NO,HIGHER,KEYWORD MISSPELLED   19784 24200019
         BE    OCONT               OK, GO PROCESS CMD             19784 24400019
         CLI   ZERO(R5),BLANK      DOES A BLANK FOLLOE COMD       19784 24600019
         BNE   OINVALID            NO,  KEYWORD MISSPELLED        19784 24800019
OCONT    EQU   *                                                  19784 25000019
         LR    R5,R12              RESTORE PTR TO UNIT FIELD      19784 25200019
          EJECT                                                         25250002
***************************************************              Y02651 25300002
*                                                                Y02651 25310002
*  LOCKS ARE REQUIRED AT THIS POINT AND THEY ARE OBTAINED AT:    Y02651 25320002
*              HSETLCK                                           Y02651 25330002
*  THESE LOCKS WILL BE RELEASED AT:                              Y02651 25340002
*              HUNSTLK                                           Y02651 25342002
*                                                                Y02651 25344002
HSETLCK  EQU   *                                                 Y02651 25346002
         STM   R11,R14,XASAVLOC                                  Y02651 25346402
         SETLOCK OBTAIN,TYPE=LOCAL,MODE=UNCOND,                  Y02651*25348002
               RELATED=(IEE5703D(HUNSTLK))                       Y02651 25348402
         SETLOCK OBTAIN,TYPE=CMS,MODE=UNCOND,                    Y02651*25348802
               RELATED=(IEE5703D(HUNSTLK))                       Y02651 25349202
         LM    R11,R14,XASAVLOC                                  Y02651 25349302
*                                                                Y02651 25349602
***************************************************              Y02651 25350002
          SPACE 10                                                      25360002
         CLC   ZERO(TWO,R5),HUNIT     UNIT WAS SPECIFIED          19784 25400019
         BE    HOFFNUNT            NO, GO VARY OFF PRESENTHARDCPY 19784 25600019
*                                                                 19784 25800019
         SPACE 10                                                       26000019
*********************************************************************** 26200019
*                                                                 19784 26400019
*    UNIT WAS SPECIFIED                                           19784 26600019
*                                                                 19784 26800019
*********************************************************************** 27000019
HOFFUNIT EQU   *                                                  19784 27200019
         CLC   ZERO(EIT,R12),HSYSLOG  WAS SYSLOG SPECIFIED        19784 27400019
         BE    HOFFSYLG            YES,GO CHECK IF IT IS HCPY     19784 27600019
*                                                                 19784 27800019
HUNITS   EQU   *                                                  19784 28000019
         LM    R5,R7,UCMVEA       PTR TO 1ST AND LAST UCMES       19784 28200019
         USING UCMLIST,R5                                         19784 28400019
HLOOPOFF EQU   *                                                  19784 28600019
         L     R4,UCMUCB           PTR TO UCB                     19784 28800019
         USING OUCB,R4                                            19784 29000019
         CLC   ZERO(TRE,R12),UCBNAME      IS THE SOUGHT UCME      19784 29200019
         BE    HFNDOFF             YES,BINGO                      19784 29400019
         BXLE  R5,R6,HLOOPOFF      NO, KEEP LOOKING               19784 29600019
         SPACE 5                                                        29650002
***************************************************              Y02651 29700002
*                                                                Y02651 29750002
*  SINCE THE ABOVE DEFAULTS INTO AN ERROR EXIT, WE MUST RELEASE  Y02651 29760002
*  ALL LOCKS FIRST                                               Y02651 29770002
         B     HOFFLCK             SORRY,NO MATCH                Y02651 29800002
*                                                                Y02651 29810002
***************************************************              Y02651 29850002
         SPACE 5                                                        29900002
HFNDOFF  EQU   *                                                  19784 30000019
       TM    UCMDISP,UCMDISPB    IS IT REALLY HCPY                19784 30200019
         SPACE 5                                                        30250002
***************************************************              Y02651 30300002
*                                                                Y02651 30310002
*  SINCE THE ABOVE DEFAULTS INTO AN ERROR EXIT, WE MUST RELEASE  Y02651 30320002
*  ALL LOCKS FIRST                                               Y02651 30330002
         BZ    HOFFLCK                                           Y02651 30340002
***************************************************              Y02651 30350002
         SPACE 5                                                        30360002
         DROP  R5                                                 19784 30600019
         LR    R9,R5                                              19784 30800019
         B     HOFF                YES,GO PROCESS                 19784 31000019
*                                                                 19784 31200019
HOFFSYLG EQU   *                                                  19784 31400019
         SR    R12,R12                                            19784 31500019
         TM    UCMSFLGS,UCMSYSG    IS SYSLOG REALLY HCPY          19784 31600019
         BO    HOFFNUNT            YES,GO PROCESS                 19784 31800019
         EJECT                                                          31850002
*****************************************************************Y02651 31900002
*                                                                Y02651 31950002
*  SINCE THIS IS AN ERROR CONDITION, MUST RELEASE LOCKS FIRST    Y02651 31952002
*                                                                Y02651 31954002
HOFFLCK  EQU   *                                                 Y02651 31956002
         BAL   R4,HUNSTLK         GO TO RELEASE LOCKS SUBROUTINE Y02651 31958002
*                                                                Y02651 31958402
*****************************************************************Y02651 31960002
         SPACE 5                                                        31970002
         B    HERR2               NO, SORRY                       19784 32000019
         EJECT                                                          32200019
*********************************************************************** 32400019
*                                                                 19784 32600019
*        THIS ROUTINE PROCESSED THE HARDCPY OFF COMMAND           19784 32800019
*                                                                 19784 33000019
*                  R5 PTR TO ,H OR UNIT,H                         19784 33200019
*                  R11 HAS PTR TO THE UCMPFX                      19784 33400019
*                  R10 HAS PTR TO THE UCM                         19784 33600019
*                                                                 19784 33800019
*********************************************************************** 34000019
HOFFNUNT EQU   *                   UNIT WAS NOT SPECIFIED IN CMD  19784 34200019
         SR    R12,R12             ZERO UNIT PTR IN CASE OF SYSLOG19784 34400019
         SR    R9,R9               ZERO UCME REG IN CASE OF SYSLOG19784 34600019
         TM    UCMSFLGS,UCMSYSG    IS SYSLOG HARDCPY              19784 34800019
         BO    HOFF                YES,GO PROC%SS                 19784 35000019
         LR    R12,R5                                             19784 35100019
         L     R9,UCMHCUCM         GET PTR TO UCME OF CURRENT HCPY19784 35200019
         LA    R9,ZERO(R9)         CLEAR HIGH ORDER BYTE          19784 35400019
         LTR   R9,R9               ANY PTR                        19784 35600019
         SPACE 5                                                        35650002
*****************************************************************Y02651 35660002
*                                                                Y02651 35662002
*  MUST GO RELEASE ALL LOCKS FIRST                               Y02651 35664002
*                                                                Y02651 35666002
         BZ    HOFFLCK                                           Y02651 35668002
*                                                                Y02651 35668402
*****************************************************************Y02651 35678402
         SPACE 5                                                        35700002
         USING UCMLIST,R9          REG9 PTR TO UCME OF HCPY DEV   19784 36000019
         L     R4,UCMUCB           PTR TO UCM                     19784 36200019
         USING OUCB,R4                                            19784 36400019
         LA    R12,UCBNAME         PTR TO NAME OF DEV IN UCB FOR MG     36600019
         DROP  R4                  MESSAGE                        19784 36800019
         DROP  R9                                                 19784 37000019
HOFF     EQU   *                                                  19784 37200019
*                                                                 19784 37400019
*   CHECK WHETHER CMD CAN BE ACCEPTED AND PROCESS ACCORDINGLY     19784 37600019
*                                                                 19784 37800019
*                   THIS RTN EXPECTS                              19784 38000019
*                                                                 19784 38200019
*                           R11 IS PTR TO UCMPFX                  19784 38400019
*                           R10 IS PTR TO UCM                     19784 38600019
*                             R9 IS PTR TO UCME OF HCPY DEV OR ZERO FOR 38800019
*                             SYSLOG                              19784 39000019
*                           R12 PTS TO UNITNAME OF IS ZERO FOR SYSLOG   39200019
*                                                                 19784 39400019
*                                                                 19784 39600019
         LM    R5,R7,UCMVEA        PTRS TO FIRST AND LAST UCMES   19784 39800019
         USING UCMLIST,R5                                         19784 40000019
         SR    R4,R4               SERO OUT ACTV CONSOLE SWITCH   19784 40200019
         SR    R13,R13             ZERO OUT GFX CONSOLE SWITCH    19784 40400019
HACTVCK  EQU   *                   CHECK FOR NO OF ACTV CONSOLES  19784 40600019
         L     R15,UCMUCB                                         19784 40800019
         USING OUCB,R15                                           19784 41000019
         TM    UCMATR,UCMUF        IS THE ACTIVE BIT ON IN UCME   19784 41200019
         BZ    HNOACTV             NO, CHECK IF CHANGING TO ACTIVE19784 41400019
         TM    SRTESTAT,SRTEDADI   ACTIVE,IS IT PENDING TO CHANGE 19784 41600019
         BO    HBXLE               YES, CHANGING TO NONACTIVE,OMIT19784 41800019
         B     HPLUS1              NOT CHANGING, COUNT IT IN      19784 42000019
*                                                                 19784 42200019
HNOACTV  EQU   *                                                  19784 42400019
         TM    SRTESTAT,SRTEDADI   CHANGING STATUS                19784 42600019
         BZ    HBXLE               NO OMIT                        19784 42800019
HPLUS1   EQU   *                                                  19784 43000019
         TM    UCMATR,UCMOF        WTO SUPPORT                    19784 43200019
         BZ    HBXLE               NO, I-UNIT, OMIT               19784 43400019
         LA    R4,ONE(R4)          PLUS 1 ACTV CONSOLES           19784 43800019
         TM    UCMDISP,UCMDISPC    IS CONSOLE GFX                 19784 44200019
         BO    HPLUS2              YES,TWO STRIKES                19784 44400019
HBXLE    BXLE  R5,R6,HACTVCK       CONTINUE                       19784 44600019
*                                  SORRY,RAN OUT OF UCMES         19784 44800019
         DROP  R15                                                19784 45000019
         BCTR  R4,ZERO             DECREASE ACTIVE CONSOLE SWITCH 19784 45200019
         LTR   R4,R4               IF ZERO MEANS ONLY ONE ACTIVE  19784 45400019
         BNZ   HERR1               NORE THAN 1,BYE TO CMD         19784 45600019
         LTR   R13,R13             IS THERE ONE GFX CONSOLE ACTIVE19784 45800019
         BNZ   HERR1               YES,BYE TO CMD                 19784 46000019
         DROP  R5                                                 19784 46200019
         USING UCMLIST,R9          ALL OK,CAN ACCEPT CMD          19784 46400019
         XC    UCMHCUCM(FOR),UCMHCUCM   ZERO OUT HCPY PTR IN PRFX 19784 46600019
         NI    UCMSFLGS,FOX-UCMSYSB-UCMSYSG    TURN OFF HARDCPY EXISTS  46800019
*                                  ON SYSTEM FLAG - X'40' AND     19784 47000019
*                                  POSSIBLE HARDCPY IS SYSLOG - X'02'   47200019
         LTR   R9,R9               WAS IT FOR SYSLOG              19784 47400019
         BZ    HOFFMSG             YES,GO TO ISSUE  MSG           19784 47600019
         NI    UCMDISP,FOX-UCMDISPB    TURN OFF HCPY FLAG IN UCM  19784 47800019
*                                                                 19784 48000019
         EJECT                                                          48050002
HOFFMSG  EQU   *                                                  19784 48200019
         SPACE 10                                                       48250002
***************************************************              Y02651 48300002
*                                                                Y02651 48310002
*  COMMAND HAS ENDED AND NOW BEFORE EXITING WE MUST RELEASE      Y02651 48320002
*  ALL LOCKS AT HUNSTLK                                          Y02651 48330002
*  LOCKS WERE GOTTEN AT:                                         Y02651 48340002
*    HSETLCK                                                     Y02651 48342002
*                                                                Y02651 48344002
         BAL   R4,HUNSTLK                                        Y02651 48346002
*                                                                Y02651 48348002
***************************************************              Y02651 48350002
         SPACE 10                                                       48360002
*          R12 IS ZERO IF FOR SYSLOG OR PTR TO UNIT NAME          19784 48400019
         MVI   XAE,MSG42            MSG CODE IS 42,MSG IS ---     19784 48600019
*                                  INACTIVE AS HARDCPY            19784 48800019
*                                  MSG MODULE IS 2103D            19784 49000019
HSYLOG   EQU   *                                                  19784 49200019
         MVC   XAV(TRE),ZERO(R12)  ASSUME REG 7 PTS TO UNIT       19784 49400019
         MVI   XAV+TRE,BLANK       NOVE IN BLANK PAST UNIT        19784 49600019
         MVC   XAV+FOR(FOR),XAV+TRE  BLANK REST OF AREA           19784 49800019
         LTR   R12,R12             WAS SYSLOG SPECIFIED           19784 50000019
         BNZ   HERREXIT            NO, UNIT ALREADY IS IN         19784 50200019
         MVC   XAV(SIX),HSYSLOG        YES, MOVE IN SYSLOG        19784 50400019
HERREXIT EQU   *                                                  19784 50600019
         MVC   XAX+TRE(TWO),MSG2103        MSG MODULE IS 2103D   Y02669 50800002
         L     R15,VCON21                                        Y02669 50850002
         BR    R15                                               Y02669 51000002
*                                                                 19784 51200019
HPLUS2   EQU   *                                                  19784 51400019
         LA    R13,ONE(R13)        PLUS 1 GFX CONSOLES            19784 51600019
         B     HBXLE               GO CONTINUE UCME SCAN          19784 51800019
         EJECT                                                          52000019
*********************************************************************** 52200019
*                                                                 19784 52400019
* ERROR MESSAGE ROUTINES                                          19784 52600019
*                                                                 19784 52800019
*********************************************************************** 53000019
*                                                                 19784 53200019
*                                                                 19784 53400019
HERR1    EQU   *                                                  19784 53600019
         SPACE 10                                                       53650002
***************************************************              Y02651 53700002
*                                                                Y02651 53710002
*  THIS IS AN ERROR EXIT AND WE ARE STILL HOLDING SOME LOCKS     Y02651 53720002
*  THESE LOCKS MUST BE RELEASED BEFORE EXITING AT SUBROUTINE:    Y02651 53730002
*              HUNSTLK                                           Y02651 53740002
*  LOCKS WERE OBTAINED AT:                                       Y02651 53742002
*              HSETLCK                                           Y02651 53744002
*                                                                Y02651 53746002
         BAL   R4,HUNSTLK                                        Y02651 53748002
*                                                                Y02651 53748402
***************************************************              Y02651 53750002
         SPACE 10                                                       53760002
         MVI   XAE,REQCD           REQ'D FOR HARDCPY MSG CODE     19784 53800019
         B     OTABLE              GO TO PROCESS IT               19784 54000019
*                                                                 19784 54200019
HERR2    EQU   *                                                  19784 54400019
         MVI   XAE,UREFCD          UNIT REF INVALID               19784 54600019
         B     OTABLE              GO PROCESS                     19784 54800019
*                                                                 19784 55000019
*                                                                 19784 55200019
MSGCHG   EQU   *                                                  19784 55400019
         MVI   XAE,CD44            CHANGING STATUS,2103D          19784 55600019
         B     HSYLOG              GO PROCESS                     19784 55800019
*                                                                 19784 56000019
*                                                                 19784 56200019
REQHCPY  EQU   *                                                  19784 56400019
         MVI   XAE,CD45            REQ'D FOR HCPY,2103D           19784 56600019
         B     HSYLOG              GO PROCESS                     19784 56800019
*                                                                 19784 57000019
*                                                                 19784 57200019
NOTSUPP  EQU   *                                                  19784 57400019
         MVI   XAE,CD26            SYSLOG NOT SUPPORTED,2103D     19784 57600019
         B     HERMOD0             GO XCTL                        19784 57800019
*                                                                 19784 58000019
*                                                                 19784 58200019
AUTHINV  EQU   *                                                  19784 58400019
         MVI   XAE,CD41            AUTHORITY INVALID,2103D        19784 58600019
*                                  NO,UNIT, MSG WILL HAVE 'VARY'  19784 58800019
         B     HERREXIT            GO PROCESS                     19784 59000019
*                                                                 19784 59200019
*                                                                 19784 59400019
KEYWORD  EQU   *                                                  19784 59600019
         MVI   XAE,CD9             KEYWORD MISSPELLED-0503D       19784 59800019
*                                  NO UNIT, MSG WILL HAVE 'VARY'  19784 60000019
         B     HERMOD              GO PROCESS                     19784 60200019
*                                                                 19784 60400019
INVNUM   EQU   *                                                  19784 60440019
         MVI   XAE,NUM6            MOVE IN ERROR CODE             19784 60480019
         MVC   XAV(EIT),HVARY      MOVE IN VARY COMMAND VERB      19784 60520019
         B     HERMOD              XCTL TO 0503D                  19784 60560019
*                                                                 19784 60600019
UTREFINV EQU   *                                                  19784 60800019
         MVI   XAE,CD13            UNIT REF INVALID-0503D         19784 61000019
         MVC   XAV(TRE),ZERO(R12)      MOVE UNIT                  19784 61400019
         MVI   XAV+TRE,BLANK       BLANK OUT REST                 19784 61600019
         CLC   ZERO(TWO,R12),HUNIT     WAS DEVICE SPECIFIED       M0048 61650001
         BNE   UNIT                    YES                        M0048 61700001
         MVC   XAV(EIT),HARDCOPY       MOVE IN HARDCOPY           M0048 61750001
UNIT     LTR   R12,R12                 WAS SYSLOG SPECIFIED       M0048 61800001
         BNZ   HERMOD              NO, OK                         19784 62000019
*                                                                 19784 62200019
HERMOD0  EQU   *                                                  19784 62400019
         MVC   XAV(SIX),HSYSLOG        NO, MOVE IN SYSLOG         19784 62600019
HERMOD   EQU   *                                                  19784 62800019
         MVC   XAX+TRE(TWO),MSG0503        MSG MODULE IS 0503D   Y02669 63000002
         L     R15,VCON05                                        Y02669 63050002
       BR    R15                                                 Y02669 63400002
*                                                                 19784 64600019
OINVALID EQU   *                                                  19784 64800019
         MVI   XAE,KEYCD                                          19784 65000019
         B     OTABLE              GO PROCESS                     19784 65200019
*                                                                 19784 65400019
*                                                                 19784 65600019
         EJECT                                                    19784 65800019
*****************************************************************Y02651 65810002
*                                                                Y02651 65812002
*  THIS IS THE RELEASE-LOCKS SUBROUTINE                          Y02651 65814002
*  ALL LOCKS ARE RELEASED HERE WHEN THIS ROUTINE DOES NO LONGER  Y02651 65816002
*  NEED THEM                                                     Y02651 65818002
*  ALL THESE LOCKS WERE OBTAINED AT LABEL:                       Y02651 65818402
*              HSETLCK                                           Y02651 65818802
*                                                                Y02651 65819202
HUNSTLK  EQU   *                                                 Y02651 65819602
         STM   R11,R14,XASAVLOC                                  Y02651 65821602
         SETLOCK RELEASE,TYPE=CMS,RELATED=(IEE5703D(HSETLCK))    Y02651 65823902
         SETLOCK RELEASE,TYPE=LOCAL,RELATED=(IEE5703D(HSETLCK))  Y02651 65825902
         LM    R11,R14,XASAVLOC                                  Y02651 65826302
         BR    R4                                                Y02651 65827902
*                                                                Y02651 65829902
*****************************************************************Y01651 65840002
         EJECT                                                    19784 65850002
*                                                                 19784 66000019
*                                                                 19784 66200019
*********************************************************************** 66400019
*                                                                 19784 66600019
*       DECLARES                                                  19784 66800019
*                                                                 19784 67000019
*********************************************************************** 67200019
*                                                                 19784 67400019
FOUR     DC    H'4'                USED TO ACCESS UCMPRFX         19784 67600019
*********************************************************************** 67800019
HSYSLOG  DC    C'SYSLOG'           DO NOT SEPARATE THIS AND THE   19784 68000019
HUNIT    DC    C',H'               FOLLOWING CONSTANT             19784 68200019
HVARY    DC    C'VARY    '         VARY COMMAND VERB              19784 68260019
*                                                                       68320019
*********************************************************************** 68400019
*                                                                 19784 68600019
*                                                                 19784 68800019
MSG2103  DC    C'21'                                             Y02669 69000002
MSG0503  DC    C'05'                                             Y02669 69200002
         DS    0F                                                Y02669 69250002
VCON21   DC    V(IEE2103D)                                       Y02669 69300002
VCON05   DC    V(IEE0503D)                                       Y02669 69350002
*                                                                 19784 69400019
HARDCOPY DC    C'HARDCOPY'                                        M0048 69450001
         SPACE 5                                                        69500002
PATCH    DC    CL50'***IEE5703D***'                            @Z30LPTJ 69550003
         EJECT                                                          69600019
OXSA     DSECT                                                          69800019
         IEEXSA                                                         70000019
         EJECT                                                          82600019
OCVT     DSECT                                                          82800019
         CVT                                                            83000019
         EJECT                                                          83200019
OUCM     DSECT                                                          83400019
         IEECUCM    FORMAT=NEW                                          83600002
         EJECT                                                          83800019
OUCB     DSECT                                                          84000019
         IEFUCBOB                                                       84200019
         EJECT                                                          84250002
         IHAPSA                                                         84300002
         END                                                            84800019
./  ADD  SSI=41620379,NAME=IEE5903D
         TITLE 'IEE5903D K AND MR MESSAGE MODULE LOAD TWO'              00200002
*********************************************************************** 00400001
*                                                                     * 00500002
*   MODULE NAME         =    IEE5903D                           Y02669* 00550002
*                                                                     * 00600002
*   DESCRIPTIVE NAME    =    CONTROL (K), MSGRT (MR) COMMANDS   Y02669* 00650002
*                            AND L=CCA OPERAND ERROR MESSAGE    Y02669* 00650402
*                            MODULE - LOAD 2                    Y02669* 00652002
*                                                                     * 00700002
*   COPYRIGHT           =    N/A                                Y02669* 00750002
*                                                                     * 00800002
*   STATUS              =    01 - UPDATE FOR VS/2 RELEASE 2     Y02669* 00850002
*                                                                     * 00900002
*   FUNCTION            =    THIS MODULE HANDLES THE SECOND     Y02669* 00950002
*                            PARTS OF LINES FOR CONTROL (K),    Y02669* 00960002
*                            MSGRT (MR) COMMANDS AND L=CCA      Y02669* 01000002
*                            OPERAND ERROR MESSAGES.            Y02669* 01050002
*                                                                     * 01100002
*  OPERATION            =    THE MESSAGES ARE ISSUED BY THE     Y02669* 01150002
*                            WRITE TO OPERATOR (WTO) MACRO.     Y02669* 01200002
*                            UNLESS THE MESSAGE IS WRITTEN IN   Y02669* 01250002
*                            RESPONSE TO A CONTROL OR MSGRT     Y02669* 01300002
*                            COMMAND ISSUED FROM A CRT CONSOLE, Y02669* 01350002
*                            THEN THE MESSAGE IS SET UP IN THE  Y02669* 01400002
*                            INSTRUCTION LINE OF THE DCM        Y02669* 01450002
*                            TO BE WRITTEN BY DIDOCS.           Y02669* 01452002
*                                                                     * 01454002
*                            THE MESSAGE CODE FOUND IN XASTSAVE Y02669* 01462002
*                            WHEN DOUBLED SERVES AS AN INDEX    Y02669* 01472002
*                            INTO THE MESSAGE TEXT TABLE.       Y02669* 01482002
*                                                                     * 01492002
*                            THE MESSAGE TABLE ENTRIES CONTAIN  Y02669* 01494002
*                            MESSAGE FLAGS WHICH INDICATE:      Y02669* 01496002
*                              X'80' - MESSAGE REQUIRES 'CCA'   Y02669* 01498002
*                              X'40' - MESSAGE REQUIRES 'CC'    Y02669* 01498402
*                            THIS INFORMATION IS FOUND IN XAS,  Y02669* 01498802
*                            CONVERTED AND PLACED IN THE TEXT.  Y02669* 01499202
*                                                                     * 01499602
*                            AFTER THE MESSAGE TEXT HAS BEEN    Y02669* 01499702
*                            ADDED TO THE WTO BUFFER, THE WTO   Y02669* 01499802
*                            IS ISSUED, THE CORE FREED AND      Y02669* 01499902
*                            CONTROL IS RETURNED.               Y02669* 01516602
*                            OTHERWISE, THE TEXT IS ADDED TO    Y02669* 01526602
*                            THE DCM INSTRUCTION LINE, THE      Y02669* 01528602
*                            LOCKS RELEASED AND CONTROL IS      Y02651* 01530602
*                            RETURNED.                          Y02669* 01532602
*                                                                     * 01533302
*   NOTES               =    NONE                               Y02669* 01550002
*                                                                     * 01600002
         EJECT                                                          01610002
*    CHARACTER-CODE                                             Y02669* 01650002
*     DEPENDENCIES      =    ANY CHARACTER CODE OTHER THAN      Y02669* 01700002
*                            EBCDIC WILL REQUIRE REASSEMBLY     Y02669* 01750002
*                            OF THIS MODULE.                    Y02669* 01800002
*                                                                     * 01850002
*    DEPENDENCIES       =    THE ONLY ENTRANCE TO THIS MODULE   Y02669* 01900002
*                            IS FROM IEE5603D WHICH SUPPLIES    Y02669* 01950002
*                            NECESSARY INFORMATION IN THE XSA   Y02669* 01960002
*                            AND REGISTERS.                     Y02669* 01970002
*                                                                     * 02000002
*    RESTRICTIONS       =    NONE                               Y02669* 02050002
*                                                                     * 02100002
*    REGISTER                                                   Y02669* 02150002
*     CONVENTIONS       =    NONE                               Y02669* 02200002
*                                                                     * 02250002
*     PATCH LABEL       =    PATCH                              Y02669* 02300002
*                                                                     * 02350002
*   MODULE TYPE         =    CSECT (MESSAGE MODULE)             Y02669* 02400002
*                                                                     * 02450002
*    PROCESSOR          =    N/A                                Y02669* 02500002
*                                                                     * 02550002
*    MODULE SIZE        =    X'371' + X'48' PATCH AREA          Y02669* 02600002
*                                                                     * 02650002
*    ATTRIBUTES         =    REFRESHABLE, REENTRANT,            Y02669* 02700002
*                            SUPERVISOR MODE, KEY 0,            Y02669* 02750002
*                            PAGED LPA                          Y02669* 02752002
*                                                                     * 02760002
*   ENTRY POINT         =    IEE5903D FROM IEE5603D             Y02669* 02770002
*      PURPOSE          =    TO PICK UP THE SECOND PART OF MSG  Y02669* 02780002
*                            AND TO ISSUE ERROR MESSAGES FOR    Y02669* 02790002
*                            MSGRT AND K COMMANDS AND L=CCA     Y02669* 02790402
*                            OPERAND.                           Y02669* 02790802
*      LINKAGE          =    BRANCH                             Y02669* 02792002
*      INPUT            =    REG 2 - ADDRESS OF THE XSA         Y02669* 02800002
*                                WHICH CONTAINS INFO ABOUT THE  Y02669* 02810002
*                                MESSAGE TO BE WRITTEN          Y02669* 02850002
*                              XASTSAVE - ONE BYTE MESSAGE CODE Y02669* 02860002
*                              XAU - SOURCE CONSOLE ID          Y02669* 02870002
*                              XASSDS=X'80'(XASSDS1) ISSUE WTO  Y02669* 02872002
*                              XASSDS5 ON IF LOCKS STILL HELD   Y02651* 02880002
*                                      OFF LOCKS RELEASED       Y02651* 02882002
*                              XASCID - TARGET CONSOLE ID       Y02669* 02890002
*                              XASDID - TARGET AREA ID (CRT)    Y02669* 02892002
*                              XASAVSTD+12 - MSG BUFFER ADDR    Y02669* 02894002
*                              XASAVSTD+16 - RETURN ADDRESS     Y02669* 02896002
*                            REG 3 - CURRENT POSITION IN        Y02669* 02900002
*                                    MESSAGE BUFFER             Y02669* 02950002
*                            REG 6 - CURRENT MSG TEXT LENGTH    Y02669* 02990002
*                            REG 8 - ADDRESS OF TRANS DCM       Y02669* 03070002
*                                                                     * 04250002
*      REGISTERS SAVED  =    REGISTERS 11 - 14 SAVED IN XSA     Y02651* 04300002
*                            (XASAVLOC) BEFORE ISSUING SETLOCK  Y02651* 04306002
*                            AT LOCKSOFF                        Y02651* 04312002
*                            REGISTER 14 WAS SAVED IN IEE5603D  Y02669* 04320002
*                            IN XASAVSTD + 16.                  Y02669* 04330002
*                                                                     * 04350002
*      REGISTER CONTENTS                                        Y02669* 04360002
*      DURING PROCESSING=    R0  - WORK REG FOR WTO & FREEMAIN  Y02669* 04370002
*                            R1  - WORK REG FOR WTO & FREEMAIN  Y02669* 04380002
*                            R2  - INPUT - BASE REG FOR XSA     Y02669* 04390002
*                            R3  - INPUT - CURRENT POSITION     Y02669* 04392002
*                                          IN BUFFER            Y02669* 04393002
*                            R4  - ADDR DCM INSTRUCTION LINE    Y02669* 04394002
*                            R5  - USED TO CONVERT CONSOLE ID   Y02669* 04396002
*                            R6  - INPUT - CURRENT TEXT LENGTH  Y02669* 04398002
*                            R7  - UNUSED                       Y02669* 04398402
*                            R8  - INPUT - BASE REG TRANS DCM   Y02669* 04398802
*                            R9  - ERR CODE - MSG TABLE INDEX   Y02669* 04399202
*                            R10 - CORRESPONDING TABLE ENTRY    Y02669* 04399602
*                            R11 - MINOR MSG TEXT LENGTH        Y02669* 04399702
*                            R12 - MODULE BASE REG              Y02669* 04399802
*                            R13 - UNUSED                       Y02669* 04399902
*                            R14 - RETURN REGISTER              Y02669* 04449902
*                            R15 - BRANCH REGISTER              Y02651* 04459902
*                                                                     * 04469902
*      REGISTERS RESTORED=   REGISTERS 11 - 14 RESTORE FROM     Y02651* 04481902
*                            XASAVLOC AFTER ISSUING SETLOCK AT  Y02651* 04484902
*                            LOCKSOFF                           Y02651* 04487902
*                            RESISTER 14, RESTORED BEFORE       Y02669* 04490902
*                            RETURNING AT RETURN                Y02669* 04495902
*                                                                     * 04508202
*  *  *  *  *  *  *  *  *  *  *  *  *  *  *  *  *  *  *  *  *  *  *  *  04513202
*                                                                     * 04518202
*   EXIT - NORMAL       =    RETURN BR R14 FROM                 Y02669* 04523202
*                            LOCKSOFF -> RETURN                 Y02669* 04525202
*  1   CONDITIONS       =    MESSAGE TO GO TO CRT DEVICE        Y02669* 04528202
*      OUTPUT DATA      =    MESSAGE IN DCM INSTRUCTION LINE    Y02669* 04533202
*                              DCMIOCM1 = DCMWRINS (X'04')      Y02669* 04535202
*                            IF DEVICE IS 2250 OR HAS LIGHT PEN:Y02669* 04535302
*                              DCMIOUNQ = DCMW2250 (X'08')      Y02669* 04535402
*                            SHOW DCM LINE CONTAINS ERROR MSG   Y02669* 04535602
*                              DCMIOUNQ = DCMINERR (X'02')      Y02669* 04536002
*                            ADD 'ENTER CANCEL' TO MSG          Y02669* 04537202
*      RETURN CODES     =    NONE                               Y02669* 04543202
*                                                                     * 04553202
         EJECT                                                          04555202
*  *  *  *  *  *  *  *  *  *  *  *  *  *  *  *  *  *  *  *  *  *  *  *  04563202
*                                                                     * 04563302
*   EXIT - NORMAL       =    RETURN VIA BR R14 FROM             Y02669* 04563602
*                            ISSUEWTO -> RETURN                 Y02669* 04563802
*      CONDITIONS       =    MESSAGE ISSUED TO REQUESTING       Y02669* 04564002
*                            CONSOLE VIA WTO AND WTO BUFFER     Y02669* 04564102
*                            FREED VIA FREEMAIN                 Y02669* 04564202
*      OUTPUT DATA      =    MESSAGE                            Y02669* 04564402
*      RETURN CODES     =    NONE                               Y02669* 04564802
*                                                                     * 04577602
*  *  *  *  *  *  *  *  *  *  *  *  *  *  *  *  *  *  *  *  *  *  *  *  04587602
*                                                                     * 04589602
*   EXIT - ERROR        =    RETURN VIA BR R14 FROM             Y02651* 04591602
*                            FREEXIT -> RETURN                  Y02651* 04592602
*      CONDITIONS       =    BAD MESSAGE CODE IN XASTSAVE       Y02669* 04593602
*                            MESSAGE BUFFER OBTAINED IN         Y02669* 04593702
*                            IEE5603D FREED VIA FREEMAIN        Y02669* 04593802
*      OUTPUT DATA      =    NONE                               Y02669* 04594002
*      RETURN CODES     =    NONE                               Y02669* 04594402
*                                                                     * 04594802
*  *  *  *  *  *  *  *  *  *  *  *  *  *  *  *  *  *  *  *  *  *  *  ** 04595302
*                                                                     * 04595702
*   EXTERNAL REFERENCES                                         Y02669* 04596102
*                                                                     * 04596202
*      ROUTINES         =    NONE                               Y02669* 04646202
*                                                                     * 04656202
*      DATA AREAS       =    NONE                               Y02669* 04666202
*                                                                     * 04676202
*      CONTROL BLOCKS   = IEETDCM R - DEVICE TYPE INFORMATION   Y02669* 04688202
*                                 W - MSG AND MSG INDICATOR     Y02669* 04688602
*                         IEEXSA  R - INPUT INFORMATION         Y02669* 04690202
*                                 W - WORK AREA                 Y02669* 04690602
*                         IHAPSA  NECESSARY FOR SETLOCK         Y02651* 04690702
*                                                                     * 04692202
*      TABLE            =    THIS MODULE CONTAINS TWO MESSAGE   Y02669* 04694202
*                            TABLES. THE FIRST IN INDEXED BY    Y02669* 04694602
*                            TWICE THE MESSAGE CODE PASSED IN   Y02669* 04695002
*                            XASTSAVE. THE INDEXED HALF WORD    Y02669* 04695402
*                            POINTS TO AN ELEMENT IN TAB4 WHICH Y02669* 04695802
*                            CONTAINS THE APPROPIATE MESSAGE.   Y02669* 04695902
*                                                                     * 04696002
*                            TAB4 CONTAINS A ONE BYTE LENGTH OF Y02669* 04696102
*                            THE PREFORMATTED MESSAGE TEXT -1,  Y02669* 04712802
*                            ONE BYTE OF MESSAGE FLAGS:         Y02669* 04722802
*                                X'80' - 'CCA' REQUIRED IN MSG  Y02669* 04724802
*                                X'40' - 'CC' REQUIRED IN MSG   Y02669* 04725202
*                            AND THE PREFORMATTED MESSAGE TEXT. Y02669* 04726802
*                                                                     * 04728802
*      MACROS           =    MODID                              Y02669* 04729202
*                            WTO                                Y02669* 04729302
*                            FREEMAIN SUBPOOL 229               Y02669* 04729402
*                            SETLOCK CMS AND LOCAL RELEASED     Y02651* 04731402
*                                                                     * 04735002
*      ENQUEUE RESOURCES=    NONE                               Y02669* 04737002
*                                                                     * 04739002
*      CHANGE LEVEL     =    Y02669                             Y02669* 04739402
*                            Y02651                             Y02651* 04739502
*                            YM1911(PROLOGUE & COMMENT CHANGES) YM1911* 04741502
*                                                                     * 04743502
*      LOCKS HELD       =    CMS AND LOCAL LOCKS OBTAINED IN    Y02651* 04745502
*                            IEE7503D OR IEE5603D ARE RELEASED  Y02651* 04749602
*                            AND XASSDS5 IS TURNED OFF AT       Y02651* 04849602
*                            LOCKSOFF BEFORE RETURNING AT       Y02651* 05089702
*                            WTODCM AND FREEXIT.                Y02651* 05092702
*                                                                     * 05095702
*   MESSAGES            =    THE FOLLOWING MESSAGES ARE         Y02669* 05099702
*                            CONTAINED WITHIN THIS MODULE:      Y02669* 05109702
*                             * MEANS 'CCA' WILL APPEAR IN THE  Y02669* 05119702
*                               MESSAGE                         Y02669* 05129702
*                             # MEANS 'CC' WILL APPEAR IN THE   Y02669* 05131702
*                               MESSAGE                         Y02669* 05131802
*                             THE MESSAGE ID INDICATES THE      Y02669* 05132102
*                             MESSAGE FOR WHICH THE FOLLOWING   Y02669* 05133702
*                             TEXT BECOMES THE SECOND PART.     Y02669* 05135702
*                                                                     * 05139702
*                             THE MOD NAME INDICATES THE MODULE Y02669* 05141702
*                             WHICH ENCOUNTERED THE ERROR AND   Y02669* 05143702
*                             ISSUED THE ERROR CODE.            Y02669* 05145702
*                                                                     * 05147702
*     MOD NAME      XASTSAVE  MSG ID   SECOND PART OF MSG       Y02669* 05149702
*     ________      ________  ______  ____________________      Y02669* 05189702
*     IEE6703D        X'06'  IEE151I  NO DISPLAY ON SCREEN      Y02669* 05229702
*     IEE6703D        X'07'           NO DISPLAY IN AREA        Y02669* 05269702
*     IEE6703D        X'04'           USE STOPTR TO DELETE      Y02669* 05309702
*     IEE6703D        X'06'  IEE158I  NO DISPLAY ON SCREEN      Y02669* 05349702
*     IEE6703D        X'07'           NO DISPLAY IN AREA        Y02669* 05389702
*     IEE6703D        X'08'           LAST FRAME DISPLAYED      Y02669* 05429702
*     IEE6703D        X'09'           FRAME NOT COMPLETE        Y02669* 05469702
*     IEE6703D        X'0A'           DISPLAY IS NOT DYNAMIC    Y02669* 05509702
*     IEE6903D        X'1E'           NO TRACK ACTIVE           Y02669* 05549702
*     IEE7503D        X'0C'  IEE921I  DISPLAY ALREADY EXISTS    Y02669* 05589702
*     IEE7503D        X'0D'           DISPLAY AREA BUSY         Y02669* 05629702
*     IEE7503D        X'0E'           NO TRACK TO STOP          Y02669* 05669702
*     IEE7503D        X'19'           NEEDS DISPLAY AREA        Y02669* 05709702
*     IEE7703D        X'1C'           DEVICE NOT SUPPORTED      Y02669* 05749702
*     IEE6803D        X'0F'  IEE924I  SCREEN SIZE EXCEEDED      Y02669* 05789702
*     IEE6803D        X'10'           AREA TOO SMALL            Y02669* 05829702
*     IEE6903D        X'11'           DISPLAY IN OR ABOVE AREA  Y02669* 05869702
*     IEE6803D                                                  Y02669* 05909702
*     IEE7503D        X'12'  IEE926I  *   NOT AN AREA           Y02669* 05989702
*     IEE6303D                        #   SUBSYSTEM CONSOLE     Y02669* 06009703
*     IEE6303D        X'1F'           SUBSYSTEM CONSOLE        @Y02668P 06019703
*     IEE7503D        X'13'           #   NOT A CONSOLE         Y02669* 06039702
*     IEE6303D                                                  Y02669* 06059702
*     IEE7503D        X'14'           #   FULL CAPABILITY       Y02669* 06089702
*     IEE7503D        X'15'           DYNAMIC DISPLAY IN AREA   Y02669* 06109702
*     IEE6703D        X'18'           ON THIS COMMAND           Y02669* 06129702
*     IEE6803D        X'1D'           #   OUTPUT ONLY           Y02669* 06149702
*     IEE7703D                                                  Y02669* 06169702
*     IEE7803D        X'16'  IEE927I  SPECIFY DISPLAY ID        Y02669* 06189702
*     IEE6703D        X'17'           SPECIFY L OPERAND         Y02669* 06239702
*     IEE7503D                                                  Y02669* 06289702
*     IEE6703D        X'1A'  IEE925I  FOR CRT ONLY              Y02669* 06339702
*     IEE7503D                                                  Y02669* 06359702
*     IEE6403D        X'1B'           FOR NON CRT ONLY          Y02669* 06389702
*                                                                     * 06439702
*   SYSGEN              =    INCLUDED WITH SVC 34 IN LOAD       Y02669* 06489702
*                            MODULE IGC0003D, DLIB AOSB3,       Y02669* 06539702
*                            MACRO SGIEF441, TARGLIB LPALIB.    Y02669* 06549702
*                                                                     * 06589702
*   SYSTEM                                                      Y02669* 06639702
*    LIBRARIES          =    NONE                               Y02669* 06689702
*                                                                     * 06739702
*********************************************************************** 08200001
         EJECT                                                          08400001
IEE5903D CSECT                                                          08600001
*********************************************************************** 08650002
*                                                                     * 08800002
*                        REGISTERS                                    * 09000002
*                                                                     * 09200002
*********************************************************************** 09250002
WRK0     EQU   0                   WORK REGISTER-WTO & FREEMAIN         09400002
WRK1     EQU   1                   WORK REGISTER-WTO & FREEMAIN         09600002
XSAR2    EQU   2                   INPUT-BASE REGISTER FOR XSA   Y02669 09800002
WRK3     EQU   3                   INPUT-CURRENT PLACE IN BUFFER Y02669 10000002
WRK4     EQU   4                   ADDR OF DCM INSTRUCTION LINE  Y02669 10200002
WRK5     EQU   5                   USED TO CONVERT CONSOLE ID    Y02669 10400002
WRK6     EQU   6                   INPUT-CURRENT LENGTH OF TEXT  Y02669 10600002
R7       EQU   7      (UNUSED)     UNUSED                        Y02669 10800002
TDCMR8   EQU   8                   INPUT-BASE REG FOR THE DCM    Y02669 10850002
WRK9     EQU   9                   ERR CODE FROM XSA-TABLE INDEX Y02669 11200002
WRK10    EQU   10                  CORRESPONDING TABLE ENTRY     Y02669 11250002
WRK11    EQU   11                  SECONDARY MESSAGE TEXT LENGTH Y02669 11600002
BASE12   EQU   12                  MODULE BASE REGISTER          Y02669 11800002
R13      EQU   13     (UNUSED)     UNUSED                        Y02669 12000002
RETURN14 EQU   14                  RETURN REGISTER               Y02669 12200002
R15      EQU   15                  BRANCH REGISTER               Y02651 12400002
         EJECT                                                          12450001
*********************************************************************** 12500002
*                                                                     * 12600002
*                        CONSTANTS                                    * 12800002
*                                                                     * 13000002
*********************************************************************** 13050002
N0       EQU   0                   NUMBER CONSTANT                      13200001
N1       EQU   1                   NUMBER CONSTANT                      13400001
N2       EQU   2                   NUMBER CONSTANT                      13600001
N3       EQU   3                   NUMBER CONSTANT                      13800001
N4       EQU   4                   NUMBER CONSTANT                      14000001
N6       EQU   6                   NUMBER CONSTANT                      14400001
N12      EQU   12                  NUMBER CONSTANT               Y02669 14450002
N15      EQU   15                  NUMBER CONSTANT                      15800001
N16      EQU   16                  NUMBER CONSTANT               Y02669 15850002
N59      EQU   59                  NUMBER CONSTANT                      16000001
N64      EQU   64                  NUMBER CONSTANT                      16200001
*********************************************************************** 16250002
*                                                                     * 16300002
*                       FLAGS AND MASKS                               * 16350002
*                                                                     * 16400002
*********************************************************************** 16450002
CCAFLAG  EQU   X'80'               CCA FLAG IN MESSAGE TABLE     Y02669 16600002
CCFLAG   EQU   X'40'               CC FLAG IN MESSAGE TABLE      Y02669 16800002
CODE2HI  EQU   31                  HIGHEST VALID MESSAGE CODE  @Y02668P 17400003
CODE2LO  EQU   4                   LOWEST VALID MESSAGE CODE     Y02669 17600002
TOOHIGH  EQU   2                   CONDITION CODE - HIGHER THAN  Y02669 17650002
TOOLOW   EQU   4                   CONDITION CODE - LOWER THAN   Y02669 17700002
XFF      EQU   X'FF'               MASK TO TURN OFF FLAGS        Y02669 17800002
CF0      EQU   X'F0'               EBCDIC ZONE                          18400001
SP229    EQU   229                 SUBPOOL FOR MESSAGE BUFFER    Y02669 18450002
         EJECT                                                          18460002
*********************************************************************** 18500002
*                                                                     * 18550002
*              ESTABLISH ADDRESSABILITY FOR MODULE               Y02669 18600002
*      ADDRESSABILITY FOR XSA AND RESIDENT DCM ARE PART OF INPUT Y02669 18610002
*                                                                     * 18650002
*********************************************************************** 18700002
         BALR  BASE12,N0           LOAD BASE REG                 Y02669 19600002
         USING *,BASE12            ADDRESSIBILITY OF ROUTINE     Y02669 19800002
         MODID BRANCH=YES                                        Y01886 19850001
         USING DXSA,XSAR2          ADDRESSIBILITY OF XSA         Y02669 20000002
         USING DCMSTRT,TDCMR8      ADDRESSIBILITY OF TRANS DCM   Y02669 20050002
         SPACE                                                          20160002
*********************************************************************** 20200002
*                                                                     * 21400002
*                 CHECK FOR INCORRECT MESSAGE CODE                    * 21600002
*                                                                     * 21800002
*********************************************************************** 22600002
         SPACE 3                                                        22610002
         CLI   XASTSAVE,CODE2HI    IS MSG CODE HIGHER THAN MAX?  Y02669 22800002
         BC    TOOHIGH,FREEXIT     YES, CHECK LOCKS AND RETURN   Y02651 23000002
         SPACE                                                          23050002
         CLI   XASTSAVE,CODE2LO    IS MSG CODE LOWER THAN MIN?   Y02669 23200002
         BC    TOOLOW,FREEXIT      YES, CHECK LOCKS AND RETURN   Y02651 23400002
         EJECT                                                          23600002
*********************************************************************** 24000002
*                                                                     * 24050002
*              CALCULATE ENTRY IN MESSAGE TABLE                  Y02669 24100002
*                                                                     * 24150002
*********************************************************************** 26000002
         SPACE                                                          26050002
         SR    WRK9,WRK9           CLEAR REG                     Y02669 26400002
         IC    WRK9,XASTSAVE       SECONDARY ERR CODE FROM XSA   Y02669 26600002
         AR    WRK9,WRK9           DOUBLE CODE FOR INDEX         Y02669 26800002
         LA    WRK10,TAB3(WRK9)    PT TO APPROPRIATE TAB3 ENTRY  Y02669 27000002
         LH    WRK10,N0(WRK10)     LOAD TABLE ELEMENT            Y02669 27200002
         LA    WRK10,TAB4(WRK10)   PT TO APPROPRIATE TAB4 ENTRY  Y02669 27210002
         SPACE 2                                                        27250002
*********************************************************************** 27300002
*                                                                     * 27400002
*        ADD MESSAGE TEXT TO DCM INSTRUCTION LINE OR WTO BUFFER       * 27600002
*            REG 3 - CURRENT POSITION IN MESSAGE BUFFER          Y02669 27650002
*            REG 6 - CURRENT LENGTH OF MESSAGE TEXT              Y02669 27700002
*                                                                     * 27800002
*********************************************************************** 28400002
         SPACE 3                                                        28450002
         SR    WRK11,WRK11         CLEAR REG                     Y02669 28800002
         IC    WRK11,N0(WRK10)     GET FIXED MSG TEXT LENGTH - 1 Y02669 29000002
         EX    WRK11,FXTEXT        MOVE IN FIXED TEXT            Y02669 29200002
         AR    WRK6,WRK11          ORIGINAL TEXT + TEXT LENGTH   Y02669 29400002
         LA    WRK6,N1(WRK6)       INCREMENT POSITION BY ONE     Y02669 29600002
*                                  HAD TO BE 1 LESS FOR EXECUTE  Y02669 29650002
         TM    N1(WRK10),CCAFLAG   DOES MSG REQUIRE 'CCA'?       Y02669 30400002
         BO    MOVEAREA            YES                           Y02669 30600002
         SPACE 1                                                        30800002
         TM    N1(WRK10),CCFLAG    DOES MSG REQUIRE 'CC'?        Y02669 31400002
         BO    UNPACKC             YES                           Y02669 31600002
         SPACE 1                                                        31800002
WTODCM   EQU   *                                                        32400001
         TM    XASSDS,XASSDS1      IS THIS A WTO?                Y02669 32600002
         BO    ISSUEWTO            YES                           Y02669 32800002
         EJECT                                                          33000002
*********************************************************************** 33600002
*                                                                     * 33610002
*              IF MESSAGE IN DCM INSTRUCTION LINE                Y02669 33620002
*                SET BITS, FREE LOCKS AND RETURN                 Y02669 33622002
*                                                                     * 33630002
*********************************************************************** 33650002
         SPACE 2                                                        33700002
         OI    DCMIOCM1,DCMWRINS   SET WRITE INSTRUCTION LINE IN DCM    34400002
         TM    DCMIOUNQ,DCMW2250   DOES DEVICE HAVE A LIGHT PEN?        35200001
         BZ    LOCKSOFF            NO, RELEASE LOCKS, RETURN     Y02651 35400002
         SPACE                                                          35450002
         L     WRK4,DCMAINS        YES,POINT TO INSTRUCTION LINE Y02669 36200002
         MVC   N59(N15,WRK4),ENCANCEL  MOVE ENTER-CANCEL MSG IN  Y02669 36400002
         NI    DCMIOUNQ,XFF-DCMINNOR TURN OFF NORMAL LINE BIT    Y02669 36600002
         OI    DCMIOUNQ,DCMINERR   INDICATE ERROR MSG IN INST LINE      36800001
         SPACE                                                          37000002
*********************************************************************** 37050002
*  CMS AND LOCAL LOCKS MUST BE RELEASED BEFORE EXITING FROM THIS MODULE 37100002
*********************************************************************** 37150002
LOCKSOFF EQU   *                                                        37200002
         STM   WRK11,RETURN14,XASAVLOC  SAVE REGS ACROSS SETLOCK Y02651 37250002
         SETLOCK RELEASE,TYPE=CMS,                                     *37300002
               RELATED=(TR,PT,K,IEE7503D(LOCKSET),IEE5603D(LOCKSTAT))   37350002
         SETLOCK RELEASE,TYPE=LOCAL,                                   *37400002
               RELATED=(TR,PT,K,IEE7503D(LOCKSET),IEE5603D(LOCKSTAT))   37450002
         LM    WRK11,RETURN14,XASAVLOC  RESTORE AFTER SETLOCK    Y02651 37500002
         NI    XASSDS,XASSDS5      INDICATE LOCKS OFF            Y02651 37550002
         B     RETURN                                                   37600002
         EJECT                                                          37850002
*********************************************************************** 37900002
*                                                                     * 38000002
*                 IF MESSAGE IS IN WTO BUFFER                    Y02669 38050002
*    ISSUE WTO FOR MESSAGE, FREE THE CORE AND RETURN             Y02669 38200002
*                                                                     * 38400002
*********************************************************************** 39000002
         SPACE 3                                                        39050002
ISSUEWTO EQU   *                                                 Y02669 39200002
         LA    WRK6,N4(WRK6)       4 EXTRA BYTES FOR WTO (MCS + LEN)    39800001
         L     WRK1,XASAVSTD+N12   BEGINNING ADDR OF MSG         Y02669 39850002
         STH   WRK6,N0(WRK1)       PUT LENGTH OF TEXT + 4 IN BUFFER     40000002
         AR    WRK6,WRK1           END ADDR OF MESSAGE BUFFER           40200002
         MVC   N0(N4,WRK6),DRCODES MOVE IN DESC AND ROUTE CODES         40400001
         SR    WRK0,WRK0           CLEAR REG                            40600001
         IC    WRK0,XAU            GET SOURCE CONSOLE ID FROM XSA       40800002
         WTO   MF=(E,(1))          WRITE MESSAGE                        41000001
         B     OKEXIT              NO LOCKS ON TO RELEASE        Y02651 41050002
         SPACE 3                                                        41200002
*********************************************************************** 41202002
*       COME HERE IF INVALID MESSAGE CODE IN XASTSAVE ONLY       Y02651 41210002
*          IF XASSDS HAS XASSDS1=ON WTO BUFFER MUST BE FREED     Y02651 41212002
*                                   NO LOCKS HELD                Y02651 41214002
*                        XASSDS5=ON LOCKS ARE ALWAYS HELD        Y02651 41216002
*********************************************************************** 41220002
         SPACE 3                                                        41230002
FREEXIT  EQU   *                                                 Y02651 41250002
         TM    XASSDS,XASSDS1      IF ON,LOCKS HAVE BEEN RELEASEDY02651 41300002
         BZ    LOCKSOFF            IF OFF, LOCKS MUST BE RELEASEDY02651 41360002
         SPACE 2                                                        41410002
OKEXIT   EQU   *                   NO NEED TO RELEASE LOCKS      Y02651 41750002
         L     WRK1,XASAVSTD+N12   ADDR OF BUFFER FOR FREEMAIN   Y02669 41800002
         FREEMAIN R,LV=N64,A=(1),SP=SP229 FREE BUFFER            Y02669 42000002
         SPACE                                                          42050002
RETURN   EQU   *                                                        42060002
         L     RETURN14,XASAVSTD+N16  RESTORE R14 SAVED IN 5603D Y02669 42100002
         BR    RETURN14            RETURN TO CALLER              Y02669 42200002
         EJECT                                                          42250002
*********************************************************************** 42300002
*                                                                     * 42400002
*    MOVE CONSOLE ID OR CONSOLE AND AREA ID INTO MESSAGE         Y02669 42600002
*                                                                     * 42800002
*********************************************************************** 43400002
         SPACE 3                                                        43450002
MOVEAREA EQU   *                                                        43600002
         MVC   N2(N1,WRK3),XASDID  MOVE AREA ID FROM XSA INTO MSG TEXT  43800002
         SPACE                                                          44000002
UNPACKC  EQU   *                                                        44800001
         SR    WRK5,WRK5           CLEAR REG                     Y02669 45000002
         IC    WRK5,XASCID         GET CONSOLE ID FROM XSA       Y02669 45200002
         CVD   WRK5,XAP            CONVERT CONSOLE ID TO DECIMAL Y02669 45400002
         UNPK  XAP+N1(N3),XAP+N6(N2) THEN TO PRINTABLE CHARACTERS       45600002
         OI    XAP+N3,CF0          CHANGE ZONE TO EBCDIC                45800002
         MVC   N0(N2,WRK3),XAP+N2  MOVE CONSOLE ID TO MSG TEXT          46000001
         B     WTODCM              BRANCH TO WRITE MESSAGE              46200002
         SPACE 3                                                        46250002
*********************************************************************** 46300002
*          EXECUTE INSTRUCTION TO MOVE TEXT INTO MESSAGE BUFFER         46360002
*********************************************************************** 46370002
FXTEXT   MVC   N0(N0,WRK3),N2(WRK10) MOVE IN TEXT FROM TABLE     Y02669 46400002
         SPACE 2                                                        46410002
         EJECT                                                          47050001
*********************************************************************** 47100002
*                                                                     * 47200002
*   THE FOLLOWING TABLE IS INDEXED BY TWICE THE MESSAGE CODE IN XAE   * 47400002
*   EACH HALF-WORD POINTS TO A TAB4 ELEMENT CONTAINING THE            * 47600002
*   APPROPIATE MESSAGE                                                * 47610002
*                                                                     * 47800002
*********************************************************************** 47850002
PREMSG   EQU   2                                                        48000001
TAB3     EQU   *                                                        48200001
         DC    AL2(0)                                                   48400001
         DC    X'FFFF'                 OBSOLETE MESSAGE CODE     Y02669 48600002
         DC    X'FFFF'                 OBSOLETE MESSAGE CODE     Y02669 48800002
         DC    X'FFFF'                 OBSOLETE MESSAGE CODE     Y02669 49000002
         DC    Y(VM04-TAB4-PREMSG)                               Y02669 49200002
         DC    X'FFFF'                 OBSOLETE MESSAGE CODE     Y02669 49400002
         DC    Y(VM06-TAB4-PREMSG)                               Y02669 49600002
         DC    Y(VM07-TAB4-PREMSG)                               Y02669 49800002
         DC    Y(VM08-TAB4-PREMSG)                               Y02669 50000002
         DC    Y(VM09-TAB4-PREMSG)                               Y02669 50200002
         DC    Y(VM10-TAB4-PREMSG)                               Y02669 50400002
         DC    X'FFFF'                 OBSOLETE MESSAGE CODE     Y02669 50600002
         DC    Y(VM12-TAB4-PREMSG)                               Y02669 50800002
         DC    Y(VM13-TAB4-PREMSG)                               Y02669 51000002
         DC    Y(VM14-TAB4-PREMSG)                               Y02669 51200002
         DC    Y(VM15-TAB4-PREMSG)                               Y02669 51400002
         DC    Y(VM16-TAB4-PREMSG)                               Y02669 51600002
         DC    Y(VM17-TAB4-PREMSG)                               Y02669 51800002
         DC    Y(VM18-TAB4-PREMSG)                               Y02669 52000002
         DC    Y(VM19-TAB4-PREMSG)                               Y02669 52200002
         DC    Y(VM20-TAB4-PREMSG)                               Y02669 52400002
         DC    Y(VM21-TAB4-PREMSG)                               Y02669 52600002
         DC    Y(VM22-TAB4-PREMSG)                               Y02669 52800002
         DC    Y(VM23-TAB4-PREMSG)                               Y02669 53000002
         DC    Y(VM24-TAB4-PREMSG)                               Y02669 53200002
         DC    Y(VM25-TAB4-PREMSG)                               Y02669 53400002
         DC    Y(VM26-TAB4-PREMSG)                               Y02669 53600002
         DC    Y(VM27-TAB4-PREMSG)                               Y02669 53800002
         DC    Y(VM28-TAB4-PREMSG)                               Y02669 53850002
         DC    Y(VM29-TAB4-PREMSG)                               Y02669 53900002
         DC    Y(VM30-TAB4-PREMSG)                               Y02669 53910002
         DC    Y(VM31-TAB4-PREMSG)                             @Y02668P 53930003
         EJECT                                                          53950001
*********************************************************************** 53960002
*                                                                       54000002
*    THE FOLLOWING TABLE CONTAINS:                               Y02669 54200002
*        A 1-BYTE LENGTH OF PREFORMATTED MESSAGE TEXT - 1        Y02669 54210002
*          1-BYTE OF MESSAGE FLAGS                               Y02669 54250002
*             X'80' - MESSAGE REQUIRES 'CCA' VALUE FOUND IN XAS  Y02669 54300002
*             X'40' - MESSAGE REQUIES 'CC' VALUE FOUND IN XAS    Y02669 54350002
*          PREFORMATTED MESSAGE TEXT                             Y02669 54400002
*                                                                     * 54600002
*********************************************************************** 54650002
TAB4     EQU   *                                                        54800001
         DC    AL1(L'VM04-1)              LENGTH OF FIXED TEXT   Y02669 57400002
         DC    X'00'                      FLAGS FOR MESSAGE             57600002
VM04     DC    C'USE STOPTR TO DELETE'    MESSAGE FIXED TEXT     Y02669 57800002
*                                                                       58800001
         DC    AL1(L'VM06-1)                                     Y02669 59000002
         DC    X'00'                                                    59200001
VM06     DC    C'NO DISPLAY ON SCREEN'                           Y02669 59400002
*                                                                       59600001
         DC    AL1(L'VM07-1)                                     Y02669 59800002
         DC    X'00'                                                    60000001
VM07     DC    C'NO DISPLAY IN AREA'                             Y02669 60200002
*                                                                       60400001
         DC    AL1(L'VM08-1)                                     Y02669 60600002
         DC    X'00'                                                    60800001
VM08     DC    C'LAST FRAME DISPLAYED'                           Y02669 61000002
*                                                                       61200001
         DC    AL1(L'VM09-1)                                     Y02669 61400002
         DC    X'00'                                                    61600001
VM09     DC    C'FRAME NOT COMPLETE'                             Y02669 61800002
*                                                                       62000001
         DC    AL1(L'VM10-1)                                     Y02669 62200002
         DC    X'00'                                                    62400001
VM10     DC    C'DISPLAY IS NOT DYNAMIC'                         Y02669 62600002
*                                                                       62800001
         DC    AL1(L'VM12-1)                                     Y02669 63800002
         DC    X'00'                                                    64000001
VM12     DC    C'DISPLAY ALREADY EXISTS'                         Y02669 64200002
*                                                                       64400001
         DC    AL1(L'VM13-1)                                     Y02669 64600002
         DC    X'00'                                                    64800001
VM13     DC    C'DISPLAY AREA BUSY'                              Y02669 65000002
*                                                                       65200001
         DC    AL1(L'VM14-1)                                     Y02669 65400002
         DC    X'00'                                                    65600001
VM14     DC    C'NO TRACK TO STOP'                               Y02669 65800002
*                                                                       66000001
         DC    AL1(L'VM15-1)                                     Y02669 66200002
         DC    X'00'                                                    66400001
VM15     DC    C'SCREEN SIZE EXCEEDED'                           Y02669 66600002
*                                                                       66800001
         DC    AL1(L'VM16-1)                                     Y02669 67000002
         DC    X'00'                                                    67200001
VM16     DC    C'AREA TOO SMALL'                                 Y02669 67400002
*                                                                       67600001
         DC    AL1(L'VM17-1)                                     Y02669 67800002
         DC    X'00'                                                    68000001
VM17     DC    C'DISPLAY IN OR ABOVE AREA'                       Y02669 68200002
*                                                                       68400001
         DC    AL1(L'VM18-1)                                     Y02669 68600002
         DC    X'80'                                                    68800001
VM18     DC    C'    NOT AN AREA'                                Y02669 69000002
*                                                                       69200001
         DC    AL1(L'VM19-1)                                     Y02669 69400002
         DC    X'40'                                                    69600002
VM19     DC    C'   NOT A CONSOLE'                               Y02669 69800002
*                                                                       70000001
         DC    AL1(L'VM20-1)                                     Y02669 70200002
         DC    X'40'                                                    70400002
VM20     DC    C'   FULL CAPABILITY'                             Y02669 70600002
*                                                                       70800001
         DC    AL1(L'VM21-1)                                     Y02669 71000002
         DC    X'00'                                                    71200001
VM21     DC    C'DYNAMIC DISPLAY IN AREA'                        Y02669 71400002
*                                                                       71600001
         DC    AL1(L'VM22-1)                                     Y02669 71800002
         DC    X'00'                                                    72000001
VM22     DC    C'SPECIFY DISPLAY ID'                             Y02669 72200002
*                                                                       72400001
         DC    AL1(L'VM23-1)                                     Y02669 72600002
         DC    X'00'                                                    72800001
VM23     DC    C'SPECIFY L OPERAND'                              Y02669 73000002
*                                                                       73200001
         DC    AL1(L'VM24-1)                                     Y02669 73400002
         DC    X'00'                                                    73600001
VM24     DC    C'ON THIS COMMAND'                                Y02669 73800002
*                                                                       74000001
         DC    AL1(L'VM25-1)                                     Y02669 74200002
         DC    X'00'                                                    74400001
VM25     DC    C'NEEDS DISPLAY AREA'                             Y02669 74600002
*                                                                       74800001
         DC    AL1(L'VM26-1)                                     Y02669 75000002
         DC    X'00'                                                    75200001
VM26     DC    C'FOR CRT ONLY'                                   Y02669 75400002
*                                                                       75600001
         DC    AL1(L'VM27-1)                                     Y02669 75800002
         DC    X'00'                                                    76000001
VM27     DC    C'FOR NON CRT ONLY'                               Y02669 76200002
*                                                                       76400001
         DC    AL1(L'VM28-1)                                     Y02669 76450002
         DC    X'00'                                                    76500001
VM28     DC    C'DEVICE NOT SUPPORTED'                           Y02669 76550002
*                                                                       76560001
         DC    AL1(L'VM29-1)                                     Y02669 76570002
         DC    X'40'                                                    76580001
VM29     DC    C'   OUTPUT ONLY'                                 Y02669 76590002
*                                                                       76592001
         DC    AL1(L'VM30-1)                                     Y02669 76592402
         DC    X'00'                                             Y02669 76592802
VM30     DC    C'NO TRACK ACTIVE'                                Y02669 76593202
*                                                                Y02669 76593602
         DC    AL1(L'VM31-1)                                   @Y02668P 76598603
         DC    X'40'                                           @Y02668P 76603603
VM31     DC    C'    SUBSYSTEM CONSOLE'                        @Y02668P 76608603
*                                                              @Y02668P 76613603
         EJECT                                                          76622002
*********************************************************************** 76636002
*                                                                     * 76650002
*                        CONSTANTS                                    * 76800002
*                                                                     * 77000002
*********************************************************************** 77050002
         SPACE                                                          77100002
ENCANCEL DC    C'*ENTER**CANCEL*'  ADDED FOR CRT WITH CURSOR     Y02669 77200002
DRCODES  DC    X'0800'             DESCRIPTOR CODE                      77400001
         DC    X'0000'             ROUTING CODE                         77600001
         SPACE 5                                                        77610002
*********************************************************************** 77650002
*                                                                     * 77700002
*                        PATCH AREA                                   * 77750002
*                                                                     * 77760002
*********************************************************************** 77770002
PATCH    DC    C'****PATCH AREA****'                                    77800001
PATCH2   DC    C'IEE5903D-TEST ONLY'                                    78000001
PATCH3   DC    36C' '                                                   78200001
         EJECT                                                          78400001
         IEETDCM                                                 Y01012 78800101
         EJECT                                                          79600001
DXSA     DSECT                                                          79800001
         IEEXSA                                                         80000001
         EJECT                                                          80050002
         IHAPSA                                                         80100002
         END                                                            83200001
./  ADD  SSI=70030432,NAME=IEE6303D
 TITLE 'IGC0003D   MSGRT COMMAND PROCESSOR, LOAD ONE'                   00201002
*********************************************************************** 00202002
*                                                                     * 00300001
*  MODULE-NAME =  IEE6303D                                       Y02669 00301002
*                                                                       00302002
*  DESCRIPTIVE NAME =  MSGRT COMMAND HANDLER LOAD ONE            Y02669 00303002
*                                                                       00304002
*  COPYRIGHT =  NONE                                             Y02669 00305002
*                                                                       00306002
*  STATUS =  OS/VS2 - DUMPING IMPROVEMENTS                     @G33CPMR 00306243
*                                                                       00308002
*  FUNCTION =  THIS MODULE BUILDS AND MAINTAINS THE ROUTE CONRTOLY02669 00309002
*  TABLE (RCT) FOR EACH CONSOLE IN ORDER TO PROVIDE DEFAULT      Y02669 00310002
*  ROUTING.                                                      Y02669 00311002
*                                                                       00312002
*     OPERATION =                                                Y02669 00313002
*     O.  IT IS DETERMINED IF THE COMMAND IS CURRENTLY         @Y02668P 00313203
*     EXECUTING UNDER A TASK OTHER THAN THE COMMUNICATIONS     @Y02668P 00313403
*     TASK. IF SO, AN INDICATOR IS SET IN THE XSA. THIS CON-   @Y02668P 00313603
*     DITION IS MOST LIKELY TO OCCUR FOR A COMMAND ISSUED AT   @Y02668P 00314003
*     A JES3 CONSOLE ASSOCIATED WITH AN MCS CONSOLE.           @Y02668P 00315003
*                                                                       00317003
*     1.  EXAMINE THE VERB IN THE OPERAND FIELD, POINTED TO BY   Y02669 00317903
*     THE XAL FIELD OF THE XSA.  THE VALID VERBS ARE 'TR', 'K',  Y02669 00318803
*     'D' AND 'NONE'.  IF NONE IS FOUND, CONTROL PASSES TO EXIT  Y02669 00319703
*     RCTMEXT TO BRANCH TO IEE6403D TO PROCESS A POSSIBLE REF    Y02669 00320603
*     OPERAND OR ISSUE AN ERROR MESSAGE.                         Y02669 00321503
*                                                                       00322403
*     2.  SCAN THE OPERANDS ON THE VERB. THE VALID OPERANDS, AND Y02669 00323303
*     THE ASSOCIATED VERBS, ARE AS FOLLOWS:                      Y02669 00324203
*          D                 K                 TR                Y02669 00325103
*       *******           *******           ********             Y02669 00326003
*          A                NONE               A                 Y02669 00327003
*          C                                                     Y02669 00327703
*          D                                                   @Z40BPSV 00327840
*          M                                                     Y02669 00328403
*          S                                                   @G17SPTJ 00329241
*          U                                                     Y02669 00330003
*       CONSOLES                                                 Y02669 00332003
*        3850                                                  @Z40LPTA 00332240
*        DUMP                                                  @G33CPMR 00332643
*                                                                       00333003
*                                                                       00334002
*     IF AN INVALID OPERAND IS FOUND, CONTROL PASSES TO THE      Y02669 00335003
*     ERROR EXIT TO ISSUE THE MESSSGE INDICATED THERE.           Y02669 00335903
*                                                                       00336803
*     3.  ONCE THE VERB'S OPERANDS ARE SCANNED, SEARCH FOR THE   Y02669 00337703
*     ROUTING OPERAND (L=). IF IT IS FOUND, THE CONSOLE AND AREA Y02669 00338603
*     SPECIFICATIONS ARE VALIDITY CHECKED, ALONG WITH THE        Y02669 00339503
*     AUTHORITY OF THE ISSUING CONSOLE TO USE THE ROUTING        Y02669 00340403
*     OPERAND.  FAILURES IN THIS CHECKING CAUSE CONTROL TO PASS  Y02669 00341303
*        3850                                                  @Z40LPTA 00341740
*     OTHERWISE, THE ROUTING INFORMATION IS SAVED IN THE XSA     Y02669 00343203
*     (XASCID FIELD) FOR LATER USE.                              Y02669 00344203
*                                                                       00346003
*     4.  AFTER OBTAINING THE LOCAL AND CMS LOCKS, THE UCME      Y02651 00346903
*     OF THE ISSUING CONSOLE IS CHECKED TO DETERMINE IF AN       Y02669 00347803
*     RCT ALREADY EXISTS FOR THAT CONSOLE. IF NOT, BRANCH ENTER  Y02651 00348703
*     CONDITIONAL GETMAIN FOR 48 BYTES FROM SUBPOOL 241,         Y02669 00349603
*     TO OBTAIN STORAGE FOR AN RCT.  IF THE GETMAIN FAILS,       Y02669 00350503
*     CONTROL PASSES TO THE ERROR EXIT TO ISSUE THE              Y02669 00351403
*     MESSAGE INDICATED THERE.  IF THE GETMAIN IS SUCCESSFUL,    Y02669 00352303
*     PROCESSING CONTINUES AT STEP 7.  IF AN RCT ALREADY EXISTS, Y02669 00353203
*     PROCESSING CONTINUES WITH STEP 5.                          Y02669 00354103
*                                                                       00355003
*     5.  EACH OF THE FIVE SLOTS IN THE RCT IS CHECKED.  IF THE  Y02669 00355903
*     VERB AND OPERAND IN AN ENTRY MATCH THOSE BEING PROCESSED,  Y02669 00356803
*     THE ENTRY IS MARKED ACTIVE ( BIT RCTACT IN BYTE RCTCODE IS Y02669 00357703
*     SET ON), AND THE CONSOLE AND AREA ARE MOVED INTO THE RCT   Y02669 00358603
*     FROM THE XSA.  IF ANOTHER VERB APPEARS ON THE COMMAND,     Y02669 00359503
*     PROCESSING CONTINUES WITH STEP 1.  IF NO ROUTING OPERAND   Y02669 00360403
*     APPEARED WITH THIS COMMAND, THE ACTIVE BIT IS SET OFF.     Y02669 00361303
*     IF THE VERBS MATCH AND THE OPERANDS DO NOT, OR IF THE      Y02669 00362203
*     VERBS DO NOT MATCH, THE NEXT RCT ENTRY IS LOCATED AND      Y02669 00363103
*     TESTED, AS DESCRIBED ABOVE.                                Y02669 00364003
*                                                                       00364903
*     6.  HOWEVER, IF THE ENTRY JUST TESTED WAS THE LAST IN THIS Y02669 00365803
*     RCT, A TEST IS MADE TO DETERMINE IF THERE IS ANOTHER RCT   Y02669 00366703
*     CHAINED TO THE ONE JUST EXAMINED.  IF NONE EXISTS, STORAGE Y02669 00367603
*     IS OBTAINED FOR ONE AS DESCRIBED IN STEP 4, AND PROCESSING Y02669 00368503
*     CONTINUES WITH STEP 7.  IF ANOTHER RCT EXISTS, IT IS PRO-  Y02669 00369403
*     CESSED AS DESCRIBED IN STEP 5.                             Y02669 00370303
*                                                                       00371203
*     7.  THE FIRST ENTRY IN THE NEW RCT IS INITIALIZED AS       Y02669 00372103
*     DESCRIBED IN STEP 5, IN THE CASE WHERE THE VERB AND        Y02669 00373003
*     OPERAND MATCH.  IN ADDITION, THE END FLAG (BIT RCTEND IN   Y02669 00376203
*     BYTE RCTCODE) IS SET ON TO INDICATE THAT THIS IS THE LAST  Y02669 00377203
*     DEFINED ENTRY.                                             Y02669 00378303
*                                                                       00379303
*     8.  ONCE THE RCT IS SUCCESSFULLY UPDATED OR CREATED,       Y02669 00380303
*     THE CMS AND LOCAL LOCKS ARE RELEASED, AND CONTROL PASSED @YM4788P 00381103
*     TO IEE0503D TO ISSUE MESSAGE IEE712I VIA BRANCH.         @YM4788P 00382103
*                                                                       00383203
*     9.  IF THE OPERAND IS 'NONE', THIS IS A REQUEST TO DELETE  Y02669 00384603
*     ALL ROUTING DEFAULTS FOR THE ISSUING CONSOLE.  ONCE THE    Y02669 00386003
*     LOCAL AND CMS LOCKS HAVE BEEN OBTAINED, THE ADDRESS OF     Y02651 00386703
*     EACH RCT IS FOUND AND STORED IN THE XSA.  THE RCT POINTER  Y02669 00387403
*     IN THE UCME IS CLEARED.  THE LOCKS ARE THEN RELEASED, AND  Y02651 00388803
*     AND EACH RCT FOUND IS FREED VIA FREEMAIN.                  Y02669 00389503
*                                                                       00390203
*    10.  IF THE OPERAND IS 'CONT' AN INDICATOR IS TURNED ON   @Z40LPTA 00390340
*         IN THE XSA. IF THIS IS THE LAST OPERAND, CONTROL IS  @Z40LPTA 00390440
*         PASSED TO EXIT RCTMEXT TO BRANCH TO IEE6403D TO      @Z40LPTA 00390540
*         PROCESS THE OUTPUT. IF THIS IS NOT THE LAST OPERAND, @Z40LPTA 00390640
*         THE REMAINING BUFFER IS SCANNED FOR ADDITIONAL       @Z40LPTA 00390740
*         OPERANDS.(REF 2)                                     @Z40LPTA 00390840
*                                                                       00390940
*  NOTES =                                                       Y02669 00391603
*     CHARACTER CODE DEPENDENCIES =  THIS MODULE HAS BEEN CODED  Y02669 00393003
*     IN SUCH A WAY THAT IF THE EXTERNAL CHARACTER SET IS        Y02669 00393703
*     CHANGED FROM EBCDIC, REASSEMBLY WILL YIELD A VALID MODULE, Y02669 00394403
*     WITH THE FOLLOWING EXCEPTIONS:                             Y02669 00395803
*                                                                       00396503
*     THE CODE REPRESENTATION OF DECIMAL DIGITS MUST HAVE THE    Y02669 00397203
*     FOUR HIGH ORDER BITS 'ON'.  (I.E. X'FZ', WHERE Z IS ANY    Y02669 00398603
*     HEX DIGIT.)                                                Y02669 00400003
*                                                                       00400703
*     THE ALPHABETIC CHARACTERS MUST BE IN COLLATING SEQUENCE.   Y02669 00401403
*                                                                       00402803
*     IF EITHER OR BOTH OF THE ABOVE CHANGES, THE TEST FOR THE   Y02669 00403203
*     VALIDITY OF THE VALUE OF THE ROUTING LOCATION OPERAND (L)  Y02669 00404203
*     MUST BE RECODED.                                           Y02669 00405603
*                                                                       00407002
*     RCT'S ARE FREED ONLY IN RESPONSE TO 'MSGRT NONE'.          Y02669 00407703
*                                                                       00408403
*     DEPENDENCIES =  GETMAIN, MSGRT COMMAND TO BE VALID ONLY    Y02669 00409803
*                     FROM A CONSOLE, SETLOCK                    Y02651 00410503
*                                                                       00411203
*     RESTRICTIONS =  THIS MODULE EXPECTS REGISTER TWO TO CON-   Y02669 00412603
*     TAIN THE ADDRESS OF AN XSA.                                Y02669 00414003
*                                                                       00415003
*     REGISTER CONVENTIONS =  SEE REGISTER USAGE                 Y02669 00416003
*                                                                       00417003
*     PATCH LABEL =  PATCH                                       Y02669 00418003
*                                                                       00419003
*  MODULE TYPE =  CSECT                                          Y02669 00420003
*                                                                       00421003
*     PROCESSOR =  ASSEM                                         Y02669 00422003
*                                                                       00423003
*     MODULE SIZE = X'611'                                     @G33CPMR 00423143
*                                                                       00425002
*     ATTRIBUTES =  SUPERVISOR MODE            REENTRANT         Y02669 00426003
*                   ZERO PSW PROTECT KEY       PAGED LPA         Y02669 00427003
*                                                                       00428003
*  ENTRY POINT =  IEE6303D, FROM IEE0403D                        Y02669 00429003
*                                                                       00430003
*     PURPOSE =  TO SYNTAX CHECK AND PROCESS THE MSGRT COMMAND   Y02669 00431003
*                                                                       00432003
*     LINKAGE =  BRANCH FROM IEE0403D                            Y02669 00433003
*                                                                       00434002
*     INPUT =  REGISTER TWO CONTAINS THE ADDRESS OF AN XSA       Y02669 00435003
*     INITIALIZED AS FOLLOWS:                                    Y02669 00435803
*                                                                       00436603
*     XAL     CONTAINS THE ADDRESS OF THE FIRST OPERAND          Y02669 00437403
*     XAU     CONSOLE ID                                         Y02669 00438203
*     XAV     COMMAND VERB (MR OR MSGRT)                         Y02669 00440003
*     XAE     MESSAGE INDEX  (X'00')                             Y02669 00440803
*                                                                       00441603
*     OUTPUT =  N/A                                              Y02669 00442403
*                                                                       00443203
*     REGISTERS SAVED =  NONE                                    Y02669 00444203
*                                                                       00445103
*     REGISTER USAGE =                                           Y02669 00446103
*     REGISTER 0         WORK REGISTER                           Y02669 00447103
*     REGISTER 1         WORK REGISTER                           Y02669 00448103
*     REGISTER 2         XSA BASE                                Y02669 00449103
*     REGISTER 3         END OF SYNTAX SCAN ADDRESS              Y02669 00450103
*     REGISTER 4         WORK REGISTER                           Y02669 00451103
*     REGISTER 5         WORK REGISTER                           Y02669 00452103
*     REGISTER 6         WORK REGISTER                           Y02669 00453103
*     REGISTER 7         UCME BASE                               Y02669 00454103
*     REGISTER 8         RCT BASE                                Y02669 00455103
*     REGISTER 9         UCM BASE                                Y02669 00456103
*     REGISTER 10        CVT BASE                                Y02669 00457103
*     REGISTER 11        OPERAND POINTER, FROM XSA               Y02669 00458103
*     REGISTER 12        MODULE BASE                             Y02669 00459103
*     REGISTER 13        SAVE REGISTER                           Y02669 00460103
*     REGISTER 14        RETURN REGISTER                         Y02669 00461103
*     REGISTER 15        LINK REGISTER                           Y02669 00462103
*                                                                       00463103
*     FOR THE BRANCH ENTRY TO GETMAIN, REGISTER USAGE IS:        Y02651 00464103
*                                                                       00466002
*     REGISTER 0         LENGTH OF RCT                           Y02651 00486402
*     REGISTER 1         ADDRESS OF STORAGE GOTTEN               Y02651 00486602
*     REGISTER 3         USED BY MACRO                           Y02651 00487002
*     REGISTER 4         TCB ADDRESS                             Y02651 00487202
*     REGISTER 7         ASCB ADDRESS                            Y02651 00487402
*     REGISTER 14        RETURN ADDRESS IN MODULE                Y02651 00487602
*     REGISTER 15        ENTRY POINT OF GETMAIN                  Y02651 00487802
*                                                                       00488002
*     REGISTERS RESTORED =  NONE                                 Y02669 00506902
*                                                                       00527202
*  EXIT-NORMAL =  RET                                            Y02669 00547502
*                                                                       00567802
*     CONDITIONS =  THE RCT HAS BEEN SUCCESSFULLY CREATED OR     Y02669 00588102
*     UPDATED.  THE CMS AND LOCAL LOCKS ARE FREED AND CONTROL    Y02651 00608402
*     IS RETURNED VIA A BRANCH TO THE ADDRESS IN REGISTER 14.    Y02669 00628702
*                                                                       00649002
*     OUTPUT DATA =                                            @YM4788P 00669302
*     RCT            UPDATED OR INITIALIZED                    @YM4788P 00674302
*     REGISTER 2     ADDRESS OF XSA CONTAINING                 @YM4788P 00679302
*     XAE            MESSAGE CODE X'03'                        @YM4788P 00684302
*     XAV            COMMAND VERB (MSGRT)                      @YM4788P 00689602
*     XAU            CONSOLE ID FOR WTO                        @YM4788P 00695602
*                                                                       00701602
*     RETURN CODES =  NONE                                       Y02669 00709902
*                                                                       00730202
*  EXIT-NORMAL =  RCTMEXT                                        Y02669 00750502
*                                                                       00770802
*     CONDITIONS =  THE MR VERB IS NEITHER 'D', NOR 'K',         Y02669 00791102
*     NOR 'TR';  AFTER RELEASING THE CMS AND LOCAL LOCKS, IF     Y02651 00811402
*     HELD, CONTROL IS PASSED VIA BRANCH ON VCON TO              Y02669 00831702
*     IEE6403D TO CHECK FOR AND PROCESS THE 'REF' OPERAND.       Y02669 00852002
*     OR THE 'CONT' INDICATOR IN THE XSA.                      @Z40LPTA 00862040
*                                                                       00872302
*     OUTPUT DATA =                                              Y02669 00892602
*     REGISTER 2                ADDRESS OF XSA                   Y02669 00912902
*     LSTR(REGISTER 11)         ADDRESS OF MR VERB               Y02669 00933202
*     XASSDS(BIT XASPRF1)       'ON', IF A PARENTHESIS APPEARED  Y02669 00953502
*                               FIRST IN THE OPERAND FIELD       Y02669 00973802
*     XAL                       IDENTICAL TO LSTR                Y02669 00994102
*     XAV                       COMMAND VERB (MR OR MSGRT)       Y02669 01014402
*                                                                       01034702
*     RETURN CODES =  NONE                                       Y02669 01055002
*                                                                       01075302
*  EXIT-ERROR =  ERROR                                           Y02669 01095602
*                                                                       01115902
*     CONDITIONS =  A DELIMITER (BLANK, PARENTHESIS, OR COMMA)   Y02669 01136202
*     IS NOT FOUND WHERE EXPECTED, PARENTHESES ARE NOT BALANCED  Y02669 01156502
*     AROUND AN MR VERB-OPERAND PAIR (E.G. 'D=A)'), OR MORE THAN Y02669 01176802
*     THREE CHARACTERS FOLLOW THE ROUTING LOCATION PARAMETER     Y02669 01197102
*     (E.G. 'L=123Z').  EXIT IS TAKEN VIA BRANCH ON VCON TO      Y02669 01217402
*     CAUSE MESSAGE IEE156I TO BE ISSUED BY IEE5603D.            Y02669 01237702
*                                                                       01258002
*     OUTPUT DATA =                                              Y02669 01278302
*     WRK6(REGISTER 6)     ADDRESS OF LAST PARAMETER EXAMINED    Y02669 01298602
*     REGISTER 2           ADDRESS OF XSA CONTAINING             Y02669 01318902
*     XAE                  MESSAGE CODE X'04'                    Y02669 01339202
*     XAV                  COMMAND VERB (MR OR MSGRT)            Y02669 01359502
*     XAU                  CONSOLE ID FOR WTO                    Y02669 01379802
*                                                                       01400102
*     RETURN CODES =  NONE                                       Y02669 01420402
*                                                                       01440702
*  EXIT-ERROR =  ERROR1                                          Y02669 01461002
*                                                                       01481302
*     CONDITIONS =  THE AREA ID ON THE 'L' OPERAND IS NOT A      Y02669 01501602
*     A VALID CHARACTER.                                         Y02669 01521902
*     EXIT IS TAKEN VIA BRANCH ON VCON TO IEE6403D TO SET UP THE Y02669 01542202
*     INTERFACE TO CAUSE IEE5603D TO ISSUE MESSAGE IEE926I.      Y02669 01562502
*                                                                       01582802
*     OUTPUT DATA =  REGISTER TWO POINTS TO AN XSA CONTAINING:   Y02669 01603102
*     XAE                  MESSAGE CODE X'0C'                    Y02669 01623402
*     XAV                  COMMAND VERB (MR OR MSGRT)            Y02669 01643702
*     XAU                  CONSOLE ID FOR WTO                    Y02669 01664002
*     XASTSAVE             SUPPLEMENTARY MESSAGE CODE X'12'      Y02669 01684302
*                          FOR IEE5903D ('NOT AN AREA' SUFFIX)   Y02669 01704602
*                                                                       01724902
*     RETURN CODES =  NONE                                       Y02669 01745202
*                                                                       01765502
*  EXIT-ERROR =  ERROR2                                          Y02669 01785802
*                                                                       01806102
*     CONDITIONS =  THE MR VERB 'K' WAS SPECIFIED FROM A CRT     Y02669 01826402
*     CONSOLE.                                                   Y02669 01846702
*     EXIT IS TAKEN VIA BRANCH ON VCON TO IEE6403D TO SET UP THE Y02669 01867002
*     INTERFACE TO CAUSE IEE5603D TO ISSUE MESSAGE IEE925I.      Y02669 01887302
*                                                                       01907602
*     OUTPUT DATA =  REGISTER TWO POINTS TO AN XSA CONTAINING:   Y02669 01927902
*     XAE                  MESSAGE CODE X'0B'                    Y02669 01948202
*     XAV                  COMMAND VERB (MR OR MSGRT)            Y02669 01968502
*     XAU                  CONSOLE ID FOR WTO                    Y02669 01988802
*     WRK6                 ADDRESS OF 'K ' OR 'K,' IN COMMAND    Y02669 02009102
*                          BUFFER FOR MESSAGE                    Y02669 02029402
*     (XASTSAVE WILL BE SET TO X'1B' BY IEE6403D TO CAUSE        Y02669 02049702
*     IEE5903D TO ADD 'FOR NON CRT ONLY' TO THE MESSAGE)         Y02669 02070002
*                                                                       02090302
*     RETURN CODES =  NONE.                                      Y02669 02110602
*                                                                       02130902
*  EXIT-ERROR =  ERROR3                                          Y02669 02151202
*                                                                       02171502
*     CONDITIONS =  CONDITIONAL GETMAIN FOR 48 BYTE RCT FAILED.  Y02669 02191802
*     AFTER RELEASEING THE CMS AND LOCAL LOCKS, EXIT IS TAKEN    Y02651 02212102
*     VIA BRANCH ON VCON TO IEE6403D TO SET UP THE               Y02669 02232402
*     INTERFACE TO CAUSE IEE5603D TO ISSUE MESSAGE IEE931I.      Y02669 02252702
*                                                                       02273002
*     OUTPUT DATA =  REGISTER TWO POINTS TO AN XSA CONTAINING:   Y02669 02293302
*     XAE                  MESSAGE CODE X'0E'                    Y02669 02313602
*     XAV                  COMMAND VERB (MR OR MSGRT)            Y02669 02333902
*     XAU                  CONSOLE ID FOR WTO                    Y02669 02354202
*                                                                       02374502
*     RETURN CODES =  NONE.                                      Y02669 02394802
*                                                                       02415102
*  EXIT-ERROR =  ERROR4                                          Y02669 02435402
*                                                                       02455702
*     CONDITIONS =  CONSOLE ID SPECIFIED ON ROUTING OPERAND      Y02669 02476002
*     IS NOT THAT OF ANY CONSOLE IN THE SYSTEM.                  Y02669 02496302
*     EXIT IS TAKEN VIA BRANCH ON VCON TO IEE6403D TO SET UP THE Y02669 02516602
*     INTERFACE TO CAUSE IEE5603D TO ISSUE MESSAGE IEE926I.      Y02669 02536902
*                                                                       02557202
*     OUTPUT DATA =  REGISTER TWO POINTS TO AN XSA CONTAINING:   Y02669 02577502
*     XAE                  MESSAGE CODE X'0C'                    Y02669 02597802
*     XAV                  COMMAND VERB (MR OR MSGRT)            Y02669 02618102
*     XAU                  CONSOLE ID FOR WTO                    Y02669 02638402
*     XASTSAVE             SUPPLEMENTARY MESSAGE CODE X'13'      Y02669 02658702
*                          FOR IEE5903D ('NOT A CONSOLE' SUFFIX) Y02669 02679002
*                                                                       02699302
*     RETURN CODES =  NONE                                       Y02669 02719602
*                                                                       02739902
*  EXIT-ERROR =  ERROR6                                          Y02669 02760202
*                                                                       02780502
*     CONDITIONS =  ISSUING CONSOLE DOES NOT HAVE AUTHORITY TO   Y02669 02800802
*     SPECIFY ROUTING OPERAND.  (I.E. IT DOES NOT HAVE AUTHORITY Y02669 02821102
*     X'20'.)                                                    Y02669 02841402
*     EXIT IS TAKEN VIA BRANCH ON VCON TO IEE6403D TO SET UP THE Y02669 02861702
*     INTERFACE TO CAUSE IEE5603D TO ISSUE MESSAGE IEE345I.      Y02669 02882002
*                                                                       02902302
*     OUTPUT DATA =  REGISTER TWO POINTS TO AN XSA CONTAINING:   Y02669 02922602
*     XAE                  MESSAGE CODE X'08'                    Y02669 02942902
*     XAV                  COMMAND VERB (MR OR MSGRT)            Y02669 02963202
*     XAU                  CONSOLE ID FOR WTO                    Y02669 02983502
*                                                                       03003802
*     RETURN CODES =  NONE.                                      Y02669 03024102
*                                                                       03024503
*  EXIT-ERROR = ERROR8                                         @Y02668P 03024903
*                                                              @Y02668P 03025103
*     CONDITIONS = CONSOLE ID SPECIFIED ON THE ROUTING OPERAND @Y02668P 03025303
*                  IS THAT OF A JES3-ONLY CONSOLE. EXIT IS     @Y02668P 03025703
*                  TAKEN VIA BRANCH ON VCON TO IEE6403D TO SET @Y02668P 03026103
*                  UP THE INTERFACE TO CAUSE IEE5603D TO ISSUE @Y02668P 03026503
*                  MESSAGE IEE926I.                            @Y02668P 03026903
*                                                                       03027303
*     OUTPUT DATA = REGISTER TWO POINTS TO AN XSA CONTAINING   @Y02668P 03028103
*     XAE              MESSAGE CODE X'0C'                      @Y02668P 03029103
*     XAV              COMMAND VERB (MR OR MSGRT)              @Y02668P 03030103
*     XAU              CONSOLE ID FOR WTO                      @Y02668P 03031103
*     XASTSAVE         SUPPLEMENTARY MESSAGE CODE X'1F' FOR    @Y02668P 03032103
*                      FOR IEE5903D ('JES3-ONLY CONSOLE')      @Y02668P 03033103
*     XASTOPR          POINTER TO INVALID OPERAND              @Y02668P 03034103
*                                                              @YM2776P 03039103
* EXIT-ERROR =  RET                                            @YM2776P 03040103
*                                                              @YM2776P 03044403
*    CONDITIONS =  XAU IS ZERO. THUS, MSGRT IS UNABLE TO       @YM2776P 03047403
*                  DETERMINE WHAT CONSOLE'S RCT TO PROCESS.    @YM2776P 03053403
*                  CONDITION ORDINARILY ARISES FOR COMMANDS    @YM2776P 03056403
*                  IN SYS1.PARMLIB.                            @YM2776P 03059403
*                  EXIT IS TAKEN VIA A BRANCH TO THE ADDRESS   @YM2776P 03064703
*                  IN REGISTER 14.                             @YM2776P 03068703
*                                                              @YM2776P 03072703
*    OUTPUT DATA =  NONE                                       @YM2776P 03076703
*                                                              @YM2776P 03080703
*    RETURN CODES =  NONE                                      @YM2776P 03085003
*                                                                       03090003
*  EXTERNAL REFERENCES =                                         Y02669 03095003
*                                                                       03100003
*     ROUTINES =  IEE6403D - TO SET UP FOR ISSUING MESSAGES AND  Y02669 03105302
*                            TO PROCESS THE 'REF' OPERAND, VIA   Y02669 03125602
*                            BRANCH.                             Y02669 03145902
*                 IEE0503D - TO ISSUE MESSAGE IEE712I          @YM4788P 03155902
*                                                                       03166202
*     DATA AREAS =  NONE                                         Y02669 03186502
*                                                                       03206802
*     CONTROL BLOCKS =                                           Y02669 03227102
*     RCT    C,R,W,D                                             Y02669 03247402
*     XSA    R,W                                                 Y02669 03267702
*     UCM    R,W                                                 Y02669 03288002
*     CVT    R                                                   Y02669 03308302
*     PTRS   R                                                   Y02651 03328602
*                                                                       03348902
*     KEY:  C=CREATE,D=DELETE,R=READ,W=WRITE                     Y02669 03369202
*                                                                       03389502
*     TABLES =  OPTAB - VALID MAJOR OPERANDS OF TRACK AND        Y02669 03409802
*               DISPLAY COMMANDS                                 Y02669 03430102
*                                                                       03450402
*     MACROS =  GETMAIN, MODID, CVT, IEECUCM, IEEXSA,            Y02669 03470702
*     IEECVMAP RCT, SETLOCK, IHAPSA, IEFPTRS, FREEMAIN           Y02651 03491002
*        SERIALIZATION =                                         Y02651 03511302
*        LOCKS HELD =  CMS, LOCAL                                Y02651 03531602
*                                                                       03551902
*  CHANGE ACTIVITY =  Y02651, Y02669, @YM2776P, @YM0428P       @YM2776P 03572202
*                     @YM4296P, @YM4787P, @YM4788P, @Y02668P   @Y02668P 03582203
*                     @Z40LPTA, @Z40BPSV, @ZA07152, @ZA09261   @ZA09261 03582741
*                     @G17SPTJ, @G33CPMR                       @G33CPMR 03585743
*                                                                       03592502
          EJECT                                                         03612802
*  MESSAGES =                                                    Y02669 03633102
*        CODES                      TEXT                         Y02669 03653402
*   XAE   XASTSAVE                                               Y02669 03673702
*  X'0C'   X'12'      IEE926I (VERB) L=CCA OPERAND INVALID-      Y02669 03694002
*                     (AREAID) NOT AN AREA                       Y02669 03714302
*  X'04'   N/A        IEE156I (VERB) INVALID OPERAND- (OPERAND)  Y02669 03734602
*  X'0B'   N/A        IEE925I (VERB) OPERAND K FOR NON CRT ONLY  Y02669 03754902
*         (X'1B' SET                                             Y02669 03775202
*          BY IEE6403D)                                          Y02669 03795502
*  X'0E'   N/A        IEE931I (VERB) (OPERAND) INSUFFICIENT      Y02669 03815802
*                     STORAGE FOR COMMAND  (IF THE COMMAND IS    Y02669 03836102
*                     'MR D=A', OPERAND IS 'A')                  Y02669 03856402
*  X'0C'   X'13'      IEE926I (VERB) L=CCA OPERAND INVALID-      Y02669 03876702
*                     (CONSID) NOT A CONSOLE                     Y02669 03897002
*  X'08'   N/A        IEE345I (VERB) AUTHORITY INVALID           Y02669 03917302
*  X'03'   N/A        IEE712I MSGRT PROCESSING COMPLETE        @YM4788P 03927302
*  X'0C'   X'1F'      IEE926I (VERB) L=CCA OPERAND INVALID-    @Y02668P 03930303
*                     (CONSID) SUBSYSTEM CONSOLE               @Y02668P 03933303
*                                                                       03937602
*  MESSAGE IEE712I IS ISSUED FROM IEE0503D. OTHERWISE,         @YM4788P 03947602
*  ALL MAJOR TEXT CONTAINED IN IEE5603D.  IF NO MINOR TEXT, THE  Y02669 03957902
*  MESSAGE IS ISSUED FROM THERE.  IF THERE IS MINOR TEXT (SUFFIX)Y02669 03978202
*  IT IS CONTAINED IN IEE5903D, AND THE MESSAGE IS ISSUED FROM   Y02669 03998502
*  THERE.                                                        Y02669 04018802
*                                                                       04039102
*  ABEND CODES =  NONE.                                          Y02669 04059402
*                                                                       04079702
*********************************************************************** 04100001
        EJECT                                                           04200001
IEE6303D CSECT                                                          04300001
* THIS APAR WRITTEN TO SUPPORT MSS 'D 3850' S/C Z40LPTA        @ZA07152 04330040
* C (NEWENBK) APPROX 411000                                    @ZA09261 04350040
* A - CODE ADDED TO SUPPORT 'DISPLAY DUMP'                     @G33CPMR 04370043
********                                                              * 04400001
******** REGISTER EQUATES                                             * 04500001
********                                                              * 04600001
WRK0     EQU   0                   WORK REGISTER                        04700001
WRK1     EQU   1                   WORK REGISTER                        04800001
XSAR     EQU   2                   BASE REGISTER FOR THE XSA            04900001
CDRR     EQU   3                   END OF SYNTAX SCAN ADDRESS           04950001
WRK4     EQU   4                   WORK REGISTER                        05000002
WRK5     EQU   5                   WORK REGISTER                        05100002
WRK6     EQU   6                   WORK REGISTER                        05300001
ENTR     EQU   7                   BASE REGISTER FOR UCM ENTRIES        05400001
RCTR     EQU   8                   BASE REGISTER FOR THE RCT            05500001
UCMR     EQU   9                   BASE REGISTER FOR THE UCM            05600001
CVTR     EQU   10                  BASE REGISTER FOR THE CVT            05700001
LSTR     EQU   11                  LIST POINTER FROM XSA                05800001
BASR     EQU   12                  ROUTINE BASE REGISTER                05900001
SAVR     EQU   13                  SAVE REGISTER                        06000001
RETR     EQU   14                  RETURN REGISTER                      06100001
LNKR     EQU   15                  LINK REGISTER                        06200001
         EJECT                                                          06250001
********                                                              * 06300001
******** OTHER EQUATES                                                * 06400001
********                                                              * 06500001
N0       EQU   0                   NUMBER CONSTANT                      06600001
N1       EQU   1                   NUMBER CONSTANT                      06700001
N2       EQU   2                   NUMBER CONSTANT                      06800001
N3       EQU   3                   NUMBER CONSTANT                      06900001
N4       EQU   4                   NUMBER CONSTANT                      07000001
N5       EQU   5                   NUMBER CONSTANT                      07100001
N6       EQU   6                   NUMBER CONSTANT                      07200001
N7       EQU   7                   NUMBER CONSTANT                      07300001
N8       EQU   8                   NUMBER CONSTANT                      07400001
N9       EQU   9                   NUMBER CONSTANT                      07500001
N10      EQU   10                  NUMBER CONSTANT                      07600001
N11      EQU   11                  NUMBER CONSTANT                      07700001
N12      EQU   12                  NUMBER CONSTANT                      07800001
N16      EQU   16                  NUMBER CONSTANT               Y02669 07850002
CA       EQU   C'A'                A CONSTANT                           07900001
CI       EQU   C'I'                I CONSTANT                           08000001
CJ       EQU   C'J'                J CONSTANT                           08100001
CR       EQU   C'R'                R CONSTANT                           08200001
CS       EQU   C'S'                S CONSTANT                           08300001
CZ       EQU   C'Z'                Z CONSTANT                           08400001
COMMA    EQU   C','                COMMA CHARACTER                      08500001
PARA2    EQU   C')'                PARENTHSIS CONSTANT                  08600001
PARA1    EQU   C'('                PARENTHSIS CONSTANT                  08700001
BLK      EQU   C' '                BLANK CONSTANT                Y02669 08800002
TF       EQU   X'FF'               FLAG TO TURN OF SWITCHES             08900001
SUBP     EQU   241                 SUBPOOL FOR RCT SECTIONS      Y02669 09000002
XF0      EQU   X'F0'               NUMBER ZONE                          09100001
ASTRICK  EQU   X'5C'               AREA ID SPECIAL FILLER      @Z40LPTA 09150040
EQUAL    EQU   C'='                EQUAL CONSTANT                       09200001
LOPER    EQU   C'L'                L CONSTANT                           09300001
KCDR     EQU   C'K'                K CONSTANT                           09400001
CHARC    EQU   C'C'                LETTER CONSTANT               Y02669 09501002
CHARO    EQU   C'O'                LETTER CONSTANT                      09600001
CHARP    EQU   C'P'                LETTER CONSTANT             @G33CPMR 09700043
CHARD    EQU   C'D'                LETTER CONSTANT             @G33CPMR 09730043
ZERO     EQU   X'00'               NUMBER CONSTANT                      09800001
RTCDR    EQU   X'94'               COMMAND CODE FOR ROUTE CDR           09900001
KERROR   EQU   X'0B'               ERROR CODE FOR CRT ONLY MSG          10100001
NCERROR  EQU   X'0E'               ERROR CODE FOR NO CORE MSG           10200001
LIERROR  EQU   X'0C'               ERROR CODE FOR L INVALID MSG         10300001
AIERROR  EQU   X'12'               SECOND ERROR CODE FOR AREA INVALID   10400001
CIERROR  EQU   X'13'               SECOND ERROR CODE FOR CONSOLE INVAL  10500001
JIERROR  EQU   X'1F'               SECOND ERROR CODE FOR       @Y02668P*10530003
                                   SUBSYSTEM CONSOLE INVALID   @Y02668P 10560003
RIERROR  EQU   X'08'               ERROR CODE FOR AUTHORITY INVALID     10600001
IOERROR  EQU   X'04'               ERROR CODE FOR INVALID OPERAND       10700001
IEE712I  EQU   X'03'             MESSAGE CODE FOR PROCESS CPLT @YM4788P 10750002
*********                                                             * 10800001
         EJECT                                                          11000001
*******************************************************************     11300001
         BALR  BASR,N0             SET PROGRAM BASE                     11400001
         USING *,BASR              ESTABLISH ADDRESSIBILITY             11500001
         MODID BRANCH=YES                                        Y01886 11550001
         USING DXSA,XSAR           ADDRESSIBILITY OF XSA                11600001
         L     CVTR,CVTPTR         ADDRESS OF CVT                       11700001
         USING DCVT,CVTR           ADDRESSIBILITY OF THE CVT            11800001
         L     UCMR,CVTCUCB        ADDRESS OF UCM FROM CVT              11900001
         USING UCM,UCMR            ADDRESSIBILITY OF THE UCM     Y02669 12000002
         XC    XAS(N4),XAS         CLEAR FLAG BYTES              Y02669 12001002
         CLI   XAU,ZERO            SYSTEM-ISSUED COMMAND?      @YM2776P 12091002
         BE    RET1                YES, EXIT                   @YM7698P 12181002
         L     WRK4,CVTTCBP        GET ADDR OF NEW/OLD PTRS    @Y02668P 12191003
         USING TCBASCB,WRK4        ADDRESSABILITY TO NEW/OLD   @Y02668P 12201003
         L     WRK4,TCBPTR         GET ADDR OF CALLER'S TCB    @Y02668P 12211003
         DROP  WRK4                RELEASE NEW/OLD ADDR'LITY   @Y02668P 12221003
         C     WRK4,UCMPXA         IS CALLER COMMTASK?         @Y02668P 12231003
         BE    COMMTASK            YES, AVOID SETTING JES3 BIT @Y02668P 12241003
         OI    XASSDS,XASSDS3      NO, INDICATE NON-COMMTASK   @Y02668P 12251003
*                                  CALLER                      @Y02668P 12261003
        SPACE 2                                                         12300002
*******************************************************************     12600001
COMMTASK EQU   *                   HERE TO AVOID BIT           @Y02668P 12650003
STARTSC  EQU   *                                                        12700002
         L     LSTR,XAL            POINTER TO COMMAND PARAMETERS        12800001
         LA    LSTR,N0(LSTR)       CLEAR HIGH ORDER BYTE         Y02669 12801002
         LTR   LSTR,LSTR           OPERAND PRESENT?              Y02669 12802002
         BZ    RCTMEXT             NO, DEFAULT TO MR REF         Y02669 12803002
         LA    WRK4,N1             ONE FOR SCAN INCREMENT AND BXLE      12900002
CONSCAN  EQU   *                                               @Z40LPTA 12950040
         CLI   N0(LSTR),PARA1      IS THERE MORE THEN ONE VERB          13100001
         BNE   TESTVB              BRANCH NO                            13200001
         OI    XASPLS3,XASPRF1     SET VERB PARENTHESIS FLAG  @Y02668P  13300003
         AR    LSTR,WRK4           INCREMENT OVER PARENTHESIS           13400002
         STCM  LSTR,7,XAL+N1       UPDATE LIST POINTER PAST   @YM4296P  13430002
*                                  PARENTHSIS                 @YM4296P  13460002
***                                                                   * 13700001
***   TEST FOR THE VERB OF THE MSGRT COMMAND                          * 13800001
***                                                                   * 13900001
         SPACE 2                                                        14000001
*******************************************************************     14200001
TESTVB   EQU   *                                                        14300001
         CLC   N0(N2,LSTR),DIS     IS THIS A DISPLAY VERB?              14400001
         BE    SCANCHK             BRANCH YES                    Y02669 14500002
         SPACE 2                                                        14600001
*******************************************************************     14800001
         CLC   N0(N3,LSTR),TR      IS THIS A TRACK VERB?         Y02669 14900002
         BE    TRCHK               BRANCH YES                    Y02669 15070002
         SPACE 2                                                        15080002
*******************************************************************     15090002
         CLC   N0(N5,LSTR),NONE    IS THIS NONE?                 Y02669 15092002
         BE    NONERTN             BRANCH YES                    Y02669 15094002
         CLC   N0(N4,LSTR),CONTOP  CONTINUATION OPERAND?       @Z40LPTA 15094340
         BNE   KCHECK              NO,CHECK NEXT               @Z40LPTA 15094640
         OI    XASSDS,XASSDS6      YES,SET 'CONT' FLAG         @Z40LPTA 15094940
         CLI   N4(LSTR),BLK     END OF COMMAND?                @Z40LPTA 15095240
         BE    RCTMEXT             YES,SET UP FOR LOAD 2       @Z40LPTA 15095540
         CLI   N4(LSTR),COMMA   MORE OPERANDS?                 @Z40LPTA 15095840
         BNE   ENDCHCK             NO, CHECK IF END OF BUFFER  @Z40LPTA 15096140
         LA    LSTR,N5(LSTR)       INCREMENT PAST 'CONT,'      @Z40LPTA 15096440
         B     CONSCAN             CONTINUE COMMAND SCAN       @Z40LPTA 15096740
ENDCHCK  EQU   *                                               @Z40LPTA 15097040
         L     ENTR,XAP            END OF BUFFER ADDR + 1      @Z40LPTA 15097340
         BCTR  ENTR,0              DECREMENT BY ONE            @Z40LPTA 15097640
         LR    RCTR,LSTR           SET UP FOR END OF BUFF TEST @Z40LPTA 15097940
         LA    RCTR,N3(RCTR)       BUMP TO OPERAND END         @Z40LPTA 15098240
         CR    ENTR,RCTR           AT END OF BUFFER?           @Z40LPTA 15098540
         BE    RCTMEXT             YES, GO TO LOAD 2           @Z40LPTA 15098840
         B     ERROR               NO, INVALID OPERAND         @Z40LPTA 15099140
         EJECT                                                          15100001
*******************************************************************     15300001
KCHECK   EQU   *                                               @Z40LPTA 15350040
         CLI   N0(LSTR),KCDR       IS THIS A CONTROL (K) VERB?          15400001
         BNE   RCTMEXT             BRANCH NO TO SECOND LOAD             15500001
         OI    XASPLS3,XASKFG      SET K COMMAND FLAG         @Y02668P  15600003
         LR    WRK6,LSTR           SAVE ADDRESS OF VERB IN K CDR        15700001
         B     KCDRCHK             BRANCH TO CHECK FOR L OPERAND        15800001
         SPACE 2                                                        15900001
*******************************************************************     16100001
SCANCHK  EQU   *                                                        16400001
         LA    LSTR,N2(LSTR)       INCREMENT TO FIRST VERB              16500001
         CLI   N0(LSTR),PARA1      IS THERE MORE THAN ONE VERB?         16600001
         BNE   DISTAB1             BRANCH NO                            16700001
         OI    XASPLS3,XASPRF2   SET OPERAND PARENTHESIS FLAG @Y02668P  16800003
         AR    LSTR,WRK4           INCREMENT TO FIRST OPERAND           16900002
DISTAB1  EQU   *                                                        17000001
         LR    WRK6,LSTR           SAVE ADDRESS OF FIRST OPERAND        17100001
***                                                                   * 17200001
***  TEST THE OPERANDS OF THE MSGRT (MR) VERBS                        * 17300001
***                                                                   * 17400001
DISTABS  EQU   *                                                        17500001
         TM    XASPLS3,XASTRFG     IS THIS A TRACK VERB?       @Y02668P 17600003
         BO    TRSCAN              BRANCH YES                    Y02669 17700002
         CLC   N0(N4,LSTR),D3850   THIS D 3850 COMMAND         @Z40LPTA 17710040
         BNE   TESTCONS            NO, CHECK FOR CONSOLES      @Z40LPTA 17720040
         LA    LSTR,N3(LSTR)       INCREMENT BUFFER PTR        @Z40LPTA 17730040
         B     DISCONS             CONTINUE SCAN OF BUFFER     @Z40LPTA 17740040
TESTCONS EQU   *                                               @Z40LPTA 17750040
         CLC   N0(N8,LSTR),CONSOLES IS VERB OPERAND EQUAL TO CONSOLES?  17800001
         BNE   TESTDUMP            BRANCH NO                   @G33CPMR 17850043
         MVI   N0(LSTR),CHARO      CHANGE C OF CONSOLES TO O FOR RCT    18000001
         LA    LSTR,N7(LSTR)       INCREMENT PAST OPERAND               18100001
         B     DISCONS             CONTINUE SCAN OF BUFFER     @G33CPMR 18150043
TESTDUMP EQU   *                                               @G33CPMR 18170043
         CLC   N0(N4,LSTR),DUMP    IS THIS 'D=DUMP'?           @G33CPMR 18190043
         BNE   DISSCAN             BRANCH NO                   @G33CPMR 18210043
         MVI   N0(LSTR),CHARP      CHANGE D OF DUMP TO P FOR RCT        18260043
         LA    LSTR,N3(LSTR)       INCREMENT BUFFER PTR        @G33CPMR 18280043
         SPACE 2                                                        18300043
*******************************************************************     18400001
DISCONS  EQU   *                                                        18500001
         AR    LSTR,WRK4           INCREMENT PAST OPERAND               18600002
         CLI   N0(LSTR),BLK        IS THIS THE END OF THE COMAND        18700001
         BE    ENDSCAN             BRANCH YES                           18800001
         CLI   N0(LSTR),COMMA      IS THERE ANOTHER OPERAND?            18900001
         BE    SINGLED             BRANCH YES                           19000001
         CLI   N0(LSTR),PARA2      IS THIS END OF THE OPERANDS?         19100001
         BNE   ERROR               BRANCH NO                            19200001
         TM    XASPLS3,XASPRF2     WAS THERE AN OPENING       @Y02668P  19300003
*                                             PARENTHESIS     @Y02668P  19350003
         BNO   PARCHK              BRANCH NO                            19400001
         EJECT                                                          19450001
KCDRCHK  EQU   *                                                        19500001
         AR    LSTR,WRK4           INCREMENT PAST PARENTHSIS            19600002
***                                                                   * 19700001
***  WHAT CHARACTER FOLLOWS THE CLOSING OPERAND PARENTHSIS            * 19800001
***                                                                   * 19900001
         CLI   N0(LSTR),BLK        IS THIS THE END?                     20000001
         BE    ENDSCAN             BRANCH YES                           20100001
         SPACE 1                                                        20200001
*******************************************************************     20400001
LCHECK   EQU   *                                                        20500001
         CLC   N0(N3,LSTR),CLEQUAL IS THIS THE LOCATION OPERAND?        20600001
         BNE   TESTEND             BRANCH NO                            20700001
         SPACE 1                                                        20800001
*******************************************************************     21000001
         OI    XASSDS,XASSDS2      INDICATE THAT A L=VERB EXITS  Y02669 21100002
         LA    LSTR,N3(LSTR)       INCREMENT AROUND L=                  21200001
         LR    WRK0,LSTR           SAVE ADDRESS OF L OPERAND            21300001
         LA    WRK5,N3(LSTR)       NUMBER OF PARAMETERS IN L=           21400002
LLOOP    EQU   *                                                        21500001
         CLI   N0(LSTR),BLK        IS THERE A BLANK?                    21600001
         BE    ENDSCAN             BRANCH YES                           21700001
         CLI   N0(LSTR),PARA2      IS THERE AN OPERAND PARENTHESIS?     21800001
         BE    ENDSCAN1            BRANCH YES                           21900001
         BXLE  LSTR,WRK4,LLOOP     INCREMENT LIST PTR AND TRY AGAIN     22000002
         LR    LSTR,WRK0           START OF L OPERAND FOR MSG    Y02669 22001002
         B     ERROR               BRANCH TO INVALID OPERAND MSG        22100001
TESTEND  EQU   *                                                        22200001
         CLI   N0(LSTR),PARA2      IS THIS THE END OF THE VERB?         22300001
         BNE   ERROR               BRANCH NO                            22400001
PARCHK   EQU   *                                                        22500001
         TM    XASPLS3,XASPRF1   WAS THERE A VERB PARENTHESIS @Y02668P  22600003
         BNO   ERROR               BRANCH NO                            22700001
ENDSCAN1 EQU   *                                                        22800001
         AR    LSTR,WRK4           INCREMENT LIST POINTER               22900002
ENDSCAN  EQU   *                                                        23000001
         CLI   N0(LSTR),BLK        IS THIS THE LAST MR VERB             23100001
         BNE   ENDSCAN2            BRANCH NO                            23200001
         NI    XASPLS3,TF-XASPRF1 TURN OFF VERB PARENTHSIS FLAG@Y02668P 23300003
ENDSCAN2 EQU   *                                                        23400001
         AR    LSTR,WRK4           INCREMENT LIST POINTER               23500002
         LR    CDRR,LSTR           SAVE SCAN END FOR VERB               23600001
         LR    LSTR,WRK0           BEGINNING OF L OPERAND               23700001
         SR    WRK1,WRK1           CLEAR REG FOR CONSOLE ID             23800001
         SR    WRK5,WRK5           CLEAR REG FOR CONSOLE ID             23900002
         IC    WRK5,XAU            SOURCE CONSOLE ID                    24000002
         STC   WRK5,XASCID         EQUALS TARGET CONSOLE ID             24100002
         TM    XASSDS,XASSDS2      IS A L OPERAND PRESENT        Y02669 24200002
         BNO   VALIDX              BRANCH NO                            24300001
         EJECT                                                          24350001
***                                                                   * 24400001
***   FOUND THE L= OPERAND AND NOW MUST CHECK IT FOR VALIDITY         * 24500001
***                                                                   * 24600001
         SPACE 1                                                        24700001
*******************************************************************     24900001
LFOUND   EQU   *                                                        25000001
         STCM  LSTR,7,XASOPTR      SAVE OPERAND ADDRESS        @YM4787P 25020002
*                                  FOR CURSOR POSITIONING      @YM4787P 25040002
*                                  IN POSSIBLE ERROR MSG       @YM4787P 25060002
         TM    N0(LSTR),XF0        IS THE FIRST CHAR  A NUMBER?         25100001
         BNO   STOREA              BRANCH NO                            25200001
         TM    N1(LSTR),XF0        IS THE SECOND CHAR A NUMBER?         25300001
         BO    TWODIGIT            BRANCH YES                           25400001
ONEDIGIT EQU   *                                                        25500001
         PACK  XAX(N8),N0(N1,LSTR) PACK CONSOLE ID IN XSA      @Z40LPTA 25600040
         AR    LSTR,WRK4           INCREMENT LIST POINTER               25700002
         B     CHECKCC             BRANCH TO CONVERT NUMBER             25800001
TWODIGIT EQU   *                                                        25900001
         PACK  XAX(N8),N0(N2,LSTR) PACK CONSOLE ID IN XSA      @Z40LPTA 26000040
         LA    LSTR,N2(LSTR)       INCREMENT LIST POINTER               26100001
CHECKCC  EQU   *                                                        26200001
         USING UCMLIST,ENTR        ADDRESSIBILITY OF UCM ENTRY          26300001
         CVB   WRK5,XAX        CONVERT CONSOLE ID TO BINARY    @Z40LPTA 26400040
         L     ENTR,UCMVEL         LAST UCM ENTRY                       26500001
         IC    WRK1,UCMID          CONSOLE ID FROM LAST ENTRY           26600001
         SPACE 1                                                        26700001
*******************************************************************     26900001
         STC   WRK5,XASCID         SAVE VALID CONSOLE ID IN XSA         27000002
         LTR   WRK5,WRK5           IS CONSOLE ID NON-POSITIVE?   Y02669 27001002
         BNP   ERROR4              YES, SET UP FOR MSG IEE926I   Y02669 27002002
         CLR   WRK5,WRK1           IS CONSOLE ID FROM CDR VALID         27100002
         BH    ERROR4              BRANCH NO                            27200001
         CLI   N0(LSTR),BLK        IS THIS THE END OF THE COMMAND?      27300001
         BE    VALIDX              BRANCH YES                           27400001
         CLI   N0(LSTR),PARA2      IS THIS THE END OF A VERB?           27500001
         BE    VALIDX              BRANCH NO                            27600002
***                                                                   * 27700001
***  IS AREA ID A VALID ALPHABETIC CHARACTER                          * 27800001
***                                                                   * 27900001
STOREA   EQU   *                                                        28000001
         MVC   XASDID(N1),N0(LSTR) SAVE VALID AREA ID IN XSA            28100001
         CLI   N0(LSTR),ASTRICK    THIS SPECIAL FILLER         @Z40LPTA 28130040
         BE    STOREA1             BRANCH YES                  @Z40LPTA 28160040
         CLI   N0(LSTR),CA         IS AREA ID EQUAL OR GREATER THAN A?  28200001
         BL    ERROR1              BRANCH NO                            28300001
         CLI   N0(LSTR),CI         IS AREA ID EQUAL OR LESS THAN I?     28400001
         BNH   STOREA1             BRANCH YES                           28500001
         CLI   N0(LSTR),CJ         IS AREA ID EQUAL OR GREATER THAN J   28600001
         BL    ERROR1              BRANCH NO                            28700001
         CLI   N0(LSTR),CR         IS AREA ID EQUAL OR LESS THAN R      28800001
         BNH   STOREA1             BRANCH YES                           28900001
         CLI   N0(LSTR),CS         IS AREA ID EQUAL OR GREATER THAN S   29000001
         BL    ERROR1              BRANCH NO                            29100001
         CLI   N0(LSTR),CZ         IS AREA ID EQUAL OR LESS THAN Z      29200001
         BH    ERROR1              BRANCH NO                            29300001
STOREA1  EQU   *                                                        29400001
         CLI   N1(LSTR),BLK        IS NEXT CHARACTER A BLANK            29500001
         BE    VALIDX              BRANCH YES                           29600001
         CLI   N1(LSTR),PARA2      IS NEXT CHARACTER A PARENTHSIS       29700001
         BNE   ERROR               BRANCH NO TO OPERAND                 29800001
VALIDX   EQU   *                                                        29900001
         LR    WRK1,WRK5           POSITION TARGET ID FOR      @Y02668P 29910003
*                                  FINDUCME                    @Y02668P 29920003
         BAL   LNKR,FINDUCME       GET TARGET UCME ADDRESS     @Y02668P 29930003
         TM    UCMDISP2,UCMDISPK   SUBSYSTEM CONSOLE?          @Y02668P 29940003
         BO    ERROR8              YES, ERROR                  @Y02668P 29950003
         SR    WRK1,WRK1           NO, SET UP FOR INSERT CHAR  @Y02668P 29970003
         IC    WRK1,XAU            GET SOURCE CONSOLE ID                30000001
         LR    LSTR,WRK1           SAVE SOURCE ID                       30100001
         BAL   LNKR,FINDUCME       GET ISSUING UCME ADDRESS      Y02669 30150002
         CR    LSTR,WRK5           IS SOURCE SAME AS TARGET             31200002
         BE    KCDRCK              BRANCH YES                           31300001
         TM    UCMAUTH,UCMAUTH3    DOES SOURCE CONSOLE HAVE AUTHORITY   31400001
*                                   TO ROUTINE (MUST HAVE CONS AUTH.)   31500001
         BZ    ERROR6              BRANCH NO                            31600001
KCDRCK   EQU   *                                                        31700001
         TM    XASPLS3,XASKFG      IS VERB A K COMMAND        @Y02668P  31800003
         BNO   TABLECK             BRANCH NO                            31900001
         TM    UCMDISP,UCMDISPC    IS CONSOLE A CRT?                    32000001
         BO    ERROR2              BRANCH YES TO ERROR MSG              32100001
         EJECT                                                          32200002
*******************************************************************     32400001
***   THE RCT ENTRIES ARE UPDATED, AND THE CHAIN EXTENDED, UNDER Y02651 32401002
***   THE PROTECTION OF THE LOCAL AND CMS LOCKS.  THIS SERIAL-   Y02651 32402002
***   IZATION IS NECESSARY TO PREVENT THE READING OF A PARTIALLY Y02651 32403002
***   COMPLETE, OR PARTIALLY ALTERED, RCT ENTRY BY THE ROUTING   Y02651 32404002
***   OPERAND PROCESSOR (IEE7503D).                              Y02651 32405002
***   ONCE LOCKS ARE ACQUIRED, A SWITCH IS SET TO PREVENT THE    Y02651 32405202
***   OVERHEAD OF REACQUISITION  FOR EACH MSGRT VERB-OPERAND.    Y02651 32405402
***   THIS IS NECESSARY SINCE, ONCE THE RCT UPDATE SUBROUTINE    Y02651 32405602
***   COMPLETES, IT RETURNS TO THE BUFFER SCAN ROUTINE TO        Y02651 32405802
***   PROCESS ANY ADDITIONAL MSGRT VERB-OPERANDS APPEARING IN    Y02651 32405902
***   THE BUFFER.                                                Y02651 32406902
*******************************************************************     32407902
     SPACE 2                                                            32457902
TABLECK  EQU   *                                                        32500001
         BAL   LNKR,GETLOCK        OBTAIN LOCAL AND CMS LOCKS    Y02651 32550002
         L     RCTR,UCMRCT         RCT ADDRESS FROM UCM ENTRY           32600001
         L     LSTR,XAL            BEGINNING OF VERB ADDRESS            32700001
         LA    RCTR,N0(RCTR)       ZERO FLAG BYTE                       32800001
         LTR   RCTR,RCTR           DOES A TABLE EXIST?                  32900002
         BNZ   TESTRCT             BRANCH YES                           33000001
         LA    RCTR,UCMRCT         ADDRESS OF RCT IN UCM                33100001
         EJECT                                                          33200001
*******************************************************************     33400001
STARTRCT EQU   *                                                        33500001
***                                                                   * 33600001
***   ROUTINE TO ISSUE GETMAIN FOR RCT SECTION                        * 33700001
***   BECAUSE THE LOCAL AND CMS LOCKS ARE HELD AT THIS POINT,  @YM00428 33750002
***   GETMAIN MUST BE BRANCH ENTERED.  IT IS REQUIRED TO BRANCH YM00428 33760002
***   ENTER GETMAIN THAT THE CMS AND LOCAL LOCKS BE HELD.      @YM00428 33770002
***                                                                   * 33800001
*******************************************************************     33810002
      SPACE 2                                                           33820002
         STM   XSAR,RETR,XASAVSTD  SAVE ALL REGS ACROSS BRANCH @YM00428 33850002
*                                  ENTRY TO GETMAIN            @YM00428 33950002
         L     WRK4,CVTTCBP        GET ADDR OF NEW/OLD POINTERS YM00428 34000002
         USING TCBASCB,WRK4        ADDRESSABILITY TO NEW/OLD   @YM00428 34010002
         L     ENTR,ASCBPTR        REG7: ADDR CURRENT ASCB     @YM00428 34020002
         L     WRK4,TCBPTR         REG4: ADDR CURRENT TCB      @YM00428 34030002
         DROP  WRK4                RELEASE NEW/OLD ADDR'LITY   @Y02668P 34040003
         LA    WRK0,RCTTEND-RCTBEG REG0: RCT SIZE FOR GETMAIN  @YM00428 34050002
         GETMAIN RC,LV=(0),SP=SUBP,BRANCH=YES GETMAIN RCT      @YM00428 34100002
         LM    XSAR,RETR,XASAVSTD  RESTORE REGS                @YM00428 34150002
         LTR   LNKR,LNKR           IS RETURN CODE NON ZERO?             34500001
         BNZ   ERROR3              BRANCH YES                           34600001
         USING DSTRCT,WRK5                                              34700002
         LR    WRK5,WRK1           ADDRESS OF NEW SECTION OF RCT Y02651 34800002
         XC    RCTBEG(RCTTEND-RCTBEG),RCTBEG CLEAR AREA GOTTEN FOR RCT  34900001
         OI    RCTENT6,RCTCON      SET CONTINUE FLAG IN SECTION         35000001
         DROP  WRK5                                                     35100002
         USING DSTRCT,RCTR         ADDRESSIBILITY OF RCT                35200001
       EJECT                                                            35250002
***                                                                   * 35300001
***   START BUILDING NEW ENTRIES IN THE RCT                           * 35400001
***                                                                   * 35500001
         STCM  WRK5,7,N1(RCTR)     ADDRESS OF RCT INTO UCM OR    Y02669 35600002
*                                  PREVIOUS RCT ON CHAIN         Y02669 35601002
         LR    RCTR,WRK5           ADDRESS OF CORE GOTTEN FOR RCT       35700002
         SPACE 2                                                        35800001
*******************************************************************     36000001
BUILDX   EQU   *                                                        36100001
         OI    RCTCODE,RCTEND       TURN ON END AND ACTIVE FLAG         36200001
VERBCOD  EQU   *                                                        36300001
         MVC   RCTVER(N2),N0(LSTR)  MOVE ROUTE VERB INTO RCT            36400001
         MVC   RCTOPD(N1),N0(WRK6) MOVE OPERAND INTO RCT                36600001
         SPACE 2                                                        36700001
*******************************************************************     36900001
MOVECA   EQU   *                                                        37000001
         NI    XASPLS3,TF-XASTRFG  CLEAR TRACK VERB SWITCH     @Z40LPTA 37050040
         OI    RCTCODE,RCTACT      SET ENTRY ACTIVE IN RCT              37100001
         MVC   RCTCID(N2),XASCID   MOVE CONSOLE AND AREA ID INTO RCT    37200001
         XC    XASDID,XASDID       CLEAR AREA FIELD            @Z40LPTA 37220040
         CLI   RCTAID,N0           AREA ID DEFINED             @Z40LPTA 37240040
         BNE   CONENT              YES, CONTINUE               @Z40LPTA 37260040
         MVI   RCTAID,ASTRICK      NO, SET SPECIAL FILLER      @Z40LPTA 37280040
         EJECT                                                          37300001
*******************************************************************     37500001
CONENT   EQU   *                                                        37600001
         TM    XASSDS,XASSDS2      IS A L OPERAND IN THIS COMMANDY02669 37700002
         BO    CONENT1             BRANCH YES AND LEAVE ACTIVE          37800001
         SPACE 2                                                        37900001
*******************************************************************     38100001
         NI    RCTCODE,TF-RCTACT   TURN OFF ACTIVE BIT IN RCT           38200001
CONENT1  EQU   *                                                        38300001
         CLI   N1(WRK6),COMMA      IS NEXT CHARACTER A COMMA?           38400001
         BE    NEWENBK             BRANCH EQUAL                         38500001
         CLI   N1(WRK6),PARA2      IS NEXT CHARACTER A PARENTHSIS?      38600001
         BE    OPEREND             BRANCH EQUAL                         38700001
         CLI   N1(WRK6),BLK        IS NEXT CHARACTER A BLANK            38800001
         BE    OPEREND             BRANCH YES                           38900001
         CLC   N0(N8,WRK6),OONSOLES CHECK FOR 'D=CONSOLES'     @G33CPMR*38910043
                                   INTERNAL REPRESENATION      @G33CPMR 38916043
         BE    SETCONS             YES, IT IS CONSOLES         @G33CPMR 38930043
         LA    WRK6,N3(WRK6)       BUMP PAST OPERAND           @Z40LPTA 38960040
         B     CONENT              BRANCH TO CONTINUE SCAN     @Z40LPTA 38980040
**                                                                    * 38990043
**   ALL OPERANDS ARE REPRESENTED BY THEIR FIRST CHARACTER EXCEPT:    * 39000043
** A) CONSOLE OPERAND WHICH IS REPRESENTED BY THE CHARACTER 'O'@G33CPMR 39100043
** B) DUMP OPERAND WHICH IS REPRESENTED BY THE CHARACTER 'P'   @G33CPMR 39200043
**                                                                    * 39230043
SETCONS  EQU   *                                               @Z40LPTA 39350040
         LA    WRK6,N7(WRK6)       INCREMENT AROUND OPERAND             39400001
         B     CONENT              BRANCH TO CONTINUE                   39500001
       SPACE 2                                                          39501002
*******************************************************************     39800001
OPEREND  EQU   *                                                        39900001
         TM    XASPLS3,XASPRF1     IS PARENTHSIS FLAG ON       @Y02668P 40000003
         BNO   RET                 NO, EXIT FROM MODULE          Y02669 40100002
         SPACE 2                                                        40501002
***      SET-UP TO PROCESS NEXT MSGRT VERB                       Y02669 40502002
*******************************************************************     40503002
         STCM  CDRR,7,XAL+N1       ADDRESS OF NEXT MSGRT VERB  @YM4296P 40700002
         NI    XASPLS3,TF-XASPRF1+XASPRF2  CLEAR PAREN FLAGS   @Z40LPTA 40750040
         B     STARTSC             BRANCH TO START FOR NEXT VERB        40800001
NEWENBK  EQU   *                                                        40900001
         TM    XASPLS3,XASPRF2    IS SECOND PARENTHSIS FLAG ON @Y02668P 41000003
         BNO   OPEREND             BRANCH NO TO END                     41100001
         MVC   XASDID(N1),RCTAID   RESTORE AREAID FOR MULTIPLE          41130040
*                                  DISPLAY OPERANDS.           @ZA09261 41160040
         LA    WRK6,N2(WRK6)       INCREMENT OPERAND POINTER            41200001
         L     RCTR,UCMRCT         STARTING ADDRESS OF RCT              41300001
         EJECT                                                          41350001
***                                                                   * 41400001
***  SEARCH RCT FOR AN EXISTING ENTRY AND OVERLAY CC AND A IF FOUND   * 41500001
***                                                                   * 41600001
         SPACE 2                                                        41700001
*******************************************************************     41900001
TESTRCT  EQU   *                                                        42000001
         CLC   RCTVER(N1),N0(LSTR) DOES VERB IN RCT EQUAL ROUTE VERB    42100001
         BE    CHKOPD              BRANCH YES                           42200001
INCRCT   EQU   *                                                        42300001
         TM    RCTCODE,RCTCON      IS THIS RCT ENTRY THE END OR CONT    42400001
         BO    NXTPTR              BRANCH YES IT IS CONTINUED           42500001
         BM    LDENT               BRANCH YES IT IS END                 42600001
         LA    RCTR,RCTLEN(RCTR)   INCREMENT TO NEXT RCT ENTRY          42700001
         B     TESTRCT             BRANCH TO TEST NEXT ENTRY            42800001
NXTPTR   EQU   *                                                        42900001
         L     RCTR,N0(RCTR)       LOAD ADDRESS OF NEW SECTION          43000001
         B     TESTRCT             BRANCH TO TEST NEXT ENTRY            43100001
CHKOPD   EQU   *                                                        43200001
         CLC   RCTOPD(N1),N0(WRK6) IS OPERANDS EQUAL TO ONE CHARACTER   43300001
         BNE   INCRCT              BRANCH NO TO CHECK NEXT ENTRY        43400001
         B     MOVECA              BRANCH TO INSERT NEW CC AND A        43500001
***                                                                   * 43600001
***  SEARCH RCT FOR NON ACTIVE ENTRIES OR BUILD A NEW ENTRY           * 43700001
***                                                                   * 43800001
         SPACE 2                                                        43900001
*******************************************************************     44200001
LDENT EQU   *                                                           44300001
         L     RCTR,UCMRCT         ADDRESS OF RCT FROM UCM              44400001
         SPACE 2                                                        44500001
*******************************************************************     44700001
SEARACT  EQU   *                                                        44800001
         TM    RCTCODE,RCTCON      IS THIS ENTRY THE END OR CONTINUED   44900001
         BO    NXTPTR1             BRANCH YES IT IS CONTINUED           45000001
         SPACE 2                                                        45100001
*******************************************************************     45300001
         TM    RCTCODE,RCTACT      IS THIS ENTRY ACTIVE                 45400001
         BNO   VERBCOD             BRANCH NO TO CONSTRUCT ENTRY         45500001
        EJECT                                                           45501002
*******************************************************************     45800001
         TM    RCTCODE,RCTEND      IS THIS ENTRY THE END                45900001
         BO    BUILD1              BRANCH YES IT IS THE END             46000001
         SPACE 2                                                        46100001
*******************************************************************     46300001
         LA    RCTR,RCTLEN(RCTR)   INCREMENT FOR NEXT ENTRY             46400001
         B     SEARACT             BRANCH TO CONTINUE SEARCH            46500001
         SPACE 2                                                        46600001
*******************************************************************     46900001
NXTPTR1  EQU   *                                                        47000001
         L     RCTR,N0(RCTR)       LOAD NEXT SECTION                    47100001
         B     SEARACT             BRANCH TO CONTINUE                   47200001
         SPACE 2                                                        47300001
*******************************************************************     47600001
BUILD1   EQU   *                                                        47700001
         NI    RCTCODE,TF-RCTEND   TURN OFF END INDICATOR               47800001
         LA    RCTR,RCTLEN(RCTR)   NEXT RCT ENTRY                       47900001
         SPACE 2                                                        48000001
*******************************************************************     48200001
         TM    RCTCODE,RCTCON      IS THIS RCT ENTRY CONTINUED          48300001
         BNO   BUILDX              BRANCH NO                            48400001
         B     STARTRCT            BRANCH TO BUILD RCT ENTRY            48500001
         EJECT                                                          48600001
*******************************************************************     48800001
TRCHK    EQU   *                                                 Y02669 48900002
         OI    XASPLS3,XASTRFG     SET TRACK VERB FLAG         @Y02668P 49100003
         AR    LSTR,WRK4           INCREMENT LIST POINTER BY 1,  Y02669 49200002
*                                  SCANCHK WILL ADD 2 MORE, TO   Y02669 49201002
*                                  ADDRESS THE MSGRT VERB        Y02669 49202002
         B     SCANCHK             BRANCH TO CONTINUE SCAN              49300001
SINGLED  EQU   *                                                        49400001
         AR    LSTR,WRK4           INCREMENT LIST POINTER               49500002
         TM    XASPLS3,XASTRFG     IS THIS A TRACK COMMAND?    @Y02668P 49600003
         BO    TRSCAN              YES, BRANCH TO TRACK OPER CHK Y02669 49700002
         B     DISTABS             NO, BRANCH TO CHECK NEXT      Y02669 49900002
*                                  DISPLAY OPERAND               Y02669 49901002
         EJECT                                                          49951002
**************************************************************** Y02669 50001002
***      THIS ROUTINE PROCESSES THE 'NONE' OPERAND.  IF THERE IS Y02669 50051002
***      AT LEASE ONE RCT TO FREE, THE LOCAL AND CMS LOCKS ARE   Y02651 50101002
***      ACQUIRED FOR THE DURATION OF THE SCAN AND TRUNCATION OF Y02651 50151002
***      THE RCT CHAIN.  THE LOCKS ARE FOR THE PROTECTION OF THE Y02651 50201002
***      ROUTING LOCATION OPERAND PROCESSOR (IEE7503D), AND    @Y02668P 50301003
***      THE 'MSG REF' COMMAND PROCESSOR (IEE6303D).           @Y02668P 50321003
***      THE ADDRESSES OF UP TO THREE RCT'S ARE STORED IN THE    Y02669 50351002
***      XSA FOR FREEMAIN.  (THIS NUMBER MUST BE INCREASED IF    Y02669 50401002
***      MORE THAN FIFTEEN ROUTABLE COMMANDS ARE SUPPORTED BY    Y02669 50451002
***      MSGRT.)  AFTER STORING THE ADDRESSES AND TRUNCATING THE Y02669 50501002
***      CHAIN BY SETTING THE UCMRCT FIELD TO ZERO, THE LOCKS    Y02651 50551002
***      ARE RELEASED, AND EACH RCT FOUND IS FREED.              Y02669 50601002
**************************************************************** Y02669 50651002
       SPACE                                                            50701002
NONERTN  SR    WRK1,WRK1           PREPARE TO INSERT SOURCE ID   Y02669 50751002
         IC    WRK1,XAU            INSERT SOURCE CONSOLE ID      Y02669 50801002
         BAL   LNKR,FINDUCME       GET ISSUING CONS UCME ADDR    Y02669 50851002
         L     RCTR,UCMRCT         ADDRESS FIRST RCT, IF ANY     Y02669 50901002
         LA    RCTR,N0(RCTR)       CLEAR FLAG BYTE               Y02669 50951002
         LTR   RCTR,RCTR           ANY RCT'S?                    Y02669 51001002
         BZ    RET                 NO, EXIT                      Y02669 51051002
         BAL   LNKR,GETLOCK        YES, GET LOCAL AND CMS LOCKS  Y02651 51061002
***                                                                     51071002
***      SAVE THE ADDRESSES OF THE RCT'S                         Y02669 51081002
***                                                                     51091002
         XC    XASAVSTD(N16),XASAVSTD ZERO RCT ADDR SAVE AREA    Y02669 51111002
         LA    WRK5,XASAVSTD       ADDRESS FIRST RCT ADDR SLOT   Y02669 51151002
*                                  FOR FREEMAIN                  Y02669 51201002
STORPTR  ST    RCTR,N0(WRK5)       SAVE RCT ADDR                 Y02669 51251002
         LA    WRK5,N4(WRK5)       ADDRESS NEXT RCT SAVE SLOT    Y02669 51301002
         L     RCTR,RCTPTRN        ADDRESS NEXT RCT              Y02669 51311002
         LA    RCTR,N0(RCTR)       CLEAR FLAG BYTE               Y02669 51321002
         LTR   RCTR,RCTR           IS THERE A NEXT RCT?          Y02669 51331002
         BNZ   STORPTR             YES, SAVE IT                  Y02669 51341002
         XC    UCMRCTA(N3),UCMRCTA NO, CLEAR UCME RCT POINTER    Y02669 51343002
         BAL   LNKR,CLRLOCK        RELEASE LOCKS                 Y02651 51345002
***                                                                     51347002
***      FREE THE RCT'S                                          Y02669 51349002
***                                                                     51349402
         LA    WRK5,XASAVSTD       INITIALIZE SLOT POINTER       Y02669 51349802
FREENEXT L     WRK1,N0(WRK5)       GET ADDR OF NEXT RCT TO FREE  Y02669 51349902
         LTR   WRK1,WRK1           IS THERE ONE?                 Y02669 51353302
         BZ    RET                 NO, EXIT, DONE                Y02669 51355302
         FREEMAIN R,LV=RCTTEND-RCTBEG,A=(1),SP=SUBP YES, FREE IT Y02669 51355702
         LA    WRK5,N4(WRK5)       ADDRESS NEXT SLOT             Y02669 51356102
         B     FREENEXT            GO FREE NEXT RCT              Y02669 51356502
         EJECT                                                          51357202
**************************************************************** Y02669 51360602
***      THE FOLLOWING SUBROUTINE COMPARES THE MSGRT VERB        Y02669 51364002
***      OPERAND IN THE COMMAND BUFFER WITH THE TABLE OF VALID   Y02669 51367402
***      TRACK AND DISPLAY OPERANDS.  THERE ARE TWO ENTRY        Y02669 51370802
***      POINTS:  TRSCAN (IF THE VERB IS 'TR') AND DISSCAN (IF   Y02669 51374202
***      THE VERB IS 'D').                                       Y02669 51377602
***                                                              Y02669 51381002
***      INPUT IS THE ADDRESS OF THE OPERAND IN THE BUFFER, IN   Y02669 51384402
***      REGISTER LSTR.  OUTPUT IS LSTR CONTAINING THE ADDRESS   Y02669 51387802
***      OF THE DELIMITER PRECEDING THE VERB.  THIS IS INPUT TO  Y02669 51391202
***      EITHER DISCONS (IF A VALID OPERAND WAS FOUND) OR LCHECK Y02669 51394602
***      (IF NO VALID OPERAND WAS FOUND).                               51398002
***                                                              Y02669 51401402
***      THE TABLE (OPTAB) IS ORGANIZED IN SUCH A WAY THAT THE   Y02669 51404802
***      FIRST SECTION CONSISTS OF OPERANDS VALID FOR BOTH TRACK Y02669 51408202
***      AND DISPLAY, AND THE REMAINDER, OF THOSE VALID ONLY FOR Y02669 51411602
***      DISPLAY.  IF ENTRY IS MADE FOR TRACK, THE SCAN IS       Y02669 51415002
***      LIMITED TO THE FIRST SECTION BY SETTING THE END OF SCAN Y02669 51418402
***      ADDRESS APPROPRIATELY; IF FOR DISPLAY, IT IS SET TO THE Y02669 51421802
***      END OF THE ENTIRE TABLE.                                Y02669 51425202
**************************************************************** Y02669 51428602
         SPACE                                                          51432002
TRSCAN   EQU   *                   TRACK ENTRY POINT             Y02669 51435402
         LA    WRK5,TENTAB         ADDRESS END OF TRACK OPERANDS Y02669 51438802
         B     SCANOP              GO SCAN OPERANDS              Y02669 51442202
DISSCAN  EQU   *                   DISPLAY ENTRY POINT           Y02669 51445602
         LA    WRK5,DENTAB         ADDRESS END OF DISPLAY OPERS  Y02669 51449002
         SPACE                                                          51452402
SCANOP   EQU   *                   SCAN VERB OPERANDS            Y02669 51455802
         LA    WRK1,OPTAB          ADDRESS START OF OPER TABLE   Y02669 51459202
NEXTOP   CLC   N0(N1,LSTR),N0(WRK1) CHECK FOR MATCH              Y02669 51462602
         BE    DISCONS             IF MATCH FOUND, GO SET-UP FOR Y02669 51466002
*                                  NEXT OPERAND                  Y02669 51469402
         LA    WRK1,N1(WRK1)       IF NOT, BUMP TO NXT TAB ENTRY Y02669 51472802
         CR    WRK1,WRK5           END OF TABLE REACHED?         Y02669 51476202
         BNE   NEXTOP              NO, TEST MATCH ON NEXT ENTRY  Y02669 51479602
         BCTR  LSTR,N0             YES, DECREMENT LIST POINTER   Y02669 51483002
*                                  TO DELIMITER                  Y02669 51486402
         B     LCHECK              GO CHECK FOR L OPERAND        Y02669 51489802
         EJECT                                                          51493202
***                                                                   * 51496602
***  SET FLAGS IN XSA TO INDICATE ERROR HAS OCCURRED IN THE FIRST LOAD* 51500002
***                                                                   * 51600001
         SPACE 2                                                        51700001
*******************************************************************     51900001
ERROR2   EQU   *                                                        52000001
         MVI   XAE,KERROR          K CDR WAS ISSUED FROM A CRT          52100001
         B     RCTMEXT             EXIT FOR SECOND LOAD                 52200001
ERROR3   EQU   *                                                        52300001
         CLI   N0(WRK6),CHARO      IS OPERAND CONSOLES?          Y02669 52301002
         BNE   ERROR3A             NO, CHECK FOR 'D=DUMP'      @G33CPMR 52301543
         MVI   N0(WRK6),CHARC      YES, RESTORE C OF 'CONSOLES'  Y02669 52303002
         B     ERROR7              SKIP AROUND 'D=DUMP'        @G33CPMR 52303143
ERROR3A  EQU   *                                               @G33CPMR 52303643
         CLI   N0(WRK6),CHARP      IS OPERAND DUMP?            @G33CPMR 52303743
         BNE   ERROR7              NO, DO NOT CHANGE OPERAND   @G33CPMR 52303843
         MVI   N0(WRK6),CHARD      YES, RESTORE 'D' OF 'DUMP'  @G33CPMR 52303943
ERROR7   EQU   *                                                 Y02669 52304002
         MVI   XAE,NCERROR         NO CORE AVAILABLE FOR ROUTE TABLE    52400001
         B     RCTMEXT             EXIT FOR SECOND LOAD                 52500001
ERROR1   EQU   *                                                        52600001
         MVI   XASTSAVE,AIERROR    AREA ID NOT A VALID LETTER           52700001
         B     ERROR5              EXIT FOR SECOND LOAD                 52800001
ERROR4   EQU   *                                                        52900001
         MVI   XASTSAVE,CIERROR    CONSOLE ID NOT VALID                 53000001
ERROR5   EQU   *                                                        53001002
         MVI   XAE,LIERROR         CCA NOT A VALID L OPERAND            53002002
         B     RCTMEXT             EXIT FOR SECOND LOAD                 53003002
ERROR6   EQU   *                                                        53400001
         MVI   XAE,RIERROR         CONSOLE DID NOT HAVE VALID MR AUTHOR 53500001
         B     RCTMEXT             EXIT FOR SECOND LOAD                 53600001
ERROR8   EQU   *                                               @Y02668P 53650003
         MVI   XASTSAVE,JIERROR    NO MR TO SUBSYSTEM          @Y02668P 53700003
         B     ERROR5              EXIT FOR SECOND LOAD        @Y02668P 53800003
ERROR    EQU   *                                                        54000001
         LR    WRK6,LSTR           OPERAND POINTER FOR ERROR MSG        54100001
         MVI   XAE,IOERROR         INVALID OPERAND IN MR CDR            54200001
         SPACE 2                                                        54200102
*******************************************************************     54200202
***                                                                   * 54200402
***  EXIT FROM FIRST LOAD TO SECOND LOAD OF MSGRT COMMAND HANDLER     * 54200602
***                                                                   * 54200802
*******************************************************************     54200902
         SPACE 2                                                        54201202
RCTMEXT  EQU   *                                                        54201402
         BAL   LNKR,CLRLOCK        RELEASE CMS AND LOCAL LOCKS,  Y02651 54201502
*                                  IF HELD                       Y02651 54201702
         NI    XASSDS,XASSDS3+XASSDS6 CLEAR SWITCH,EXCEPT NON- @Z40LPTA 54203540
*                                     COMMTASK,'CONT'          @Z40LPTA 54203640
*                                  NON-COMMTASK SWITCH         @Y02668P 54204003
         MVI   XASPLS3,ZERO        USED DIFFERENTLY BY IEE6403D Y02668P 54207003
         L     LNKR,RCTM2          ADDRESS OF IEE6403D INTO R15  Y02669 54208003
         BR    LNKR                BRANCH TO IT                  Y02669 54209003
         EJECT                                                          54210003
*******************************************************************     54213403
***   EXIT CODE.  RELEASE CMS AND LOCAL LOCKS, AND             @YM4788P 54213603
***   EXIT TO IEE0503D                                         @YM4788P 54214603
*******************************************************************     54215603
         SPACE                                                          54216603
RET      EQU   *                   EXIT CODE                     Y02669 54220003
         BAL   LNKR,CLRLOCK        RELEASE CMS AND LOCAL LOCKS   Y02651 54221603
         MVI   XAE,IEE712I         PROCESSING COMPLETE CODE    @YM4788P 54223203
         MVC   XAV(N5),MSGRT       COMMAND VERB(MSGRT)         @YM4788P 54224803
         L     LNKR,IEE0503D       ADDRESS OF MESSAGE MODULE   @YM4788P 54225803
         BR    LNKR                BRANCH TO IT                @YM4788P 54226803
         SPACE 2                                                        54227803
*******************************************************************     54232003
***      EXIT CODE.  RETURN VIA BR 14                          @YM7698P 54233003
*******************************************************************     54234003
         SPACE                                                          54235003
RET1     EQU   *                                               @YM7698P 54238003
         BR    RETR                RETURN TO CALLER            @YM7698P 54239003
         SPACE 2                                                        54240003
*******************************************************************     54241003
***      CLRLOCK ROUTINE.  RELEASES CMS AND LOCAL LOCKS, IF HELD.Y02651 54244003
*******************************************************************     54246003
         SPACE                                                          54248003
CLRLOCK  TM    XASSDS,XASSDS5      LOCKS HELD?                   Y02651 54251202
         BZ    N0(LNKR)            NO, RETURN TO CALLING ROUTINE Y02651 54251403
         STM   LSTR,RETR,XASAVLOC  SAVE REGS ACROSS SETLOCKS     Y02651 54252003
CLRLOCK2 SETLOCK RELEASE,TYPE=CMS,                               Y02651X54255003
               RELATED=(RCT,IEE6303D(SETLOCK2))                  Y02651 54256003
CLRLOCK1 SETLOCK RELEASE,TYPE=LOCAL,                             Y02651X54257003
               RELATED=(RCT,IEE6303D(SETLOCK1))                  Y02651 54258003
         LM    LSTR,RETR,XASAVLOC  RESTORE SAVED REGS            Y02651 54259003
         NI    XASSDS,TF-XASSDS5   TURN OFF LOCKS HELD SWITCH  @Y02668P 54260003
         BR    LNKR                RETURN TO CALLING ROUTINE     Y02651 54261003
      EJECT                                                             54266202
*******************************************************************     54276202
***      GETLOCK ROUTINE.                                        Y02651 54296202
***      ACQUIRES LOCAL AND CMS LOCKS, IF NOT ALREADY HELD.      Y02651 54298202
*******************************************************************     54300202
    SPACE 2                                                             54302202
GETLOCK  TM    XASSDS,XASSDS5      LOCKS ALREADY HELD?           Y02651 54306202
         BO    LOKSHELD            YES, DON'T REACQUIRE          Y02651 54356202
         STM   LSTR,RETR,XASAVLOC  SAVE REGS ACROSS SETLOCKS     Y02651 54406202
SETLOCK1 SETLOCK OBTAIN,TYPE=LOCAL,MODE=UNCOND,                  Y02651X54456202
               RELATED=(RCT,IEE6303D(CLRLOCK1))                  Y02651 54506202
SETLOCK2 SETLOCK OBTAIN,TYPE=CMS,MODE=UNCOND,                    Y02651X54556202
               RELATED=(RCT,IEE6303D(CLRLOCK2))                  Y02651 54606202
         LM    LSTR,RETR,XASAVLOC  RESTORE SAVED REGS            Y02651 54656202
         OI    XASSDS,XASSDS5      SET LOCKS HELD SWITCH         Y02651 54706202
LOKSHELD BR    LNKR                RETURN TO CALLER              Y02651 54756202
       EJECT                                                            54806202
*******************************************************************     54856202
***      FINDUCME ROUTINE.                                       Y02669 54906202
***      FIND AND SET BASE FOR UCM ENTRY                         Y02669 54956202
***               - INPUT - WRK1 CONTAINS CONSOLE ID             Y02669 54966202
***               - OUTPUT - UCM ENTRY SPECIFIED BY ID IN ENTR   Y02669 55006202
*******************************************************************     55156202
     SPACE 2                                                            55166202
FINDUCME EQU   *                                                        55206202
         L     ENTR,UCMVEA         FIRST ENTRY FROM UCM                 55256202
         BCTR  WRK1,N0             SUBRRACT ONE FROM CONSOLE ID         55306202
         M     WRK0,UCMVEZ         MULIPLY ENTRY SIZE BY REDUCED ID     55356202
         AR    ENTR,WRK1           ADDRESS OF DESIRED UCM ENTRY         55406202
         BR    LNKR                RETURN TO CALLER              Y02669 55456202
         EJECT                                                          56400001
********                                                              * 56500001
******** CONSTANTS USED BY ROUTINE                                    * 56600002
********                                                              * 56700001
DIS      DC    C'D='               DISPLAY VERB                         56710001
CONSOLES DC    C'CONSOLES'         CONSOLE OPERAND                      56800001
TR       DC    C'TR='              TRACK VERB                    Y02669 57300002
CLEQUAL  DC    C',L='              L OPERAND                            57500001
D3850    DC    C'3850'             D 3850 OPERAND CONSTANT     @Z40LPTA 57500140
CONTOP   DC    C'CONT'             CMND CONTINUATION OPERAND   @Z40LPTA 57500340
OONSOLES DC    C'OONSOLES'         INTERNAL REP. OF 'CONSOLES' @G33CPMR 57500443
DUMP     DC    C'DUMP'             D DUMP OPERAND CONSTANT     @G33CPMR 57500543
NONE     DC    C'NONE '            NONE OPERAND                  Y02669 57500843
MSGRT    DC    C'MSGRT'            MSGRT VERB FOR MSG          @YM4788P 57500943
IEE0503D DC    V(IEE0503D)         MESSAGE MODULE              @YM4788P 57501043
RCTM2    DC    V(IEE6403D)         SECOND MR LOAD                Y02669 57501143
         EJECT                                                          57501202
**************************************************************** Y02669 57501402
***      TABLE OF ROUTABLE TRACK AND DISPLAY COMMAND OPERANDS    Y02669 57501602
**************************************************************** Y02669 57501802
         SPACE 2                                                        57501902
OPTAB    EQU   *                                                 Y02669 57502902
A        DC    CL1'A'              OPERAND TEXT                  Y02669 57505002
TENTAB   EQU   *                   END OF TRACK OPERANDS         Y02669 57505202
***      END OF OPERANDS COMMON TO TRACK AND DISPLAY COMMANDS    Y02669 57505402
         SPACE                                                          57505602
***      START OF OPERANDS VALID ONLY ON DISPLAY COMMAND         Y02669 57505702
         SPACE                                                          57505902
***      NOTE: 'CONSOLES' DOES NOT APPEAR HERE BECAUSE IT IS     Y02669 57506702
***      HANDLED IN-LINE AS A SPECIAL CASE, BECAUSE ITS          Y02669 57506902
***      ABBREVIATION IS 'O'                                     Y02669 57507002
         SPACE                                                          57507102
CK       DC    CL1'C'              *                             Y02669 57507502
DMN      DC    CL1'D'              *                           @Z40BPSV 57507740
MATRIX   DC    CL1'M'              *                             Y02669 57508602
UNITS    DC    CL1'U'              *                             Y02669 57509002
REQUESTS DC    CL1'R'              *                             Y02669 57509402
SLIP     DC    CL1'S'              *                           @G17SPTJ 57509741
DENTAB   EQU   *                   END OF TABLE                  Y02669 57510241
***      END OF OPERAND TABLE                                    Y02669 57510502
         SPACE 3                                                        57510702
PATCH    DC    CL50'***   IEE6303D  PATCH AREA  ******'          Y02669 57511502
IEE6303D  TITLE 'UNIT CONTROL MODULE MAP'                               58001002
         IEECUCM   FORMAT=NEW                                           58200002
          TITLE 'EXTENDED SAVE AREA MAP'                                58201002
DXSA     DSECT                                                          58400001
         IEEXSA                                                         58500001
**                                                                    * 58600001
**  THE XAP AND XAD FIELDS OF THE XSA ARE USED AS A DOUBLE WORD       * 58700001
**   WORK AREA IN THIS MODULE AND ARE RESTORED BEFORE EXIT            * 58800001
**                                                                    * 58900001
**  THE XASSDS FIELD OF THE XSA IS USED AS FOLLOWS IN THIS MODULE     * 59000002
XASKFG   EQU   X'20'               THE VERB IS A K COMMAND              59700001
XASTRFG  EQU   X'10'               THE THE VERB IS TRACK         Y02669 59701002
XASPRF1  EQU   X'02'               THERE IS MORE THAN ONE VERB          60100001
XASPRF2  EQU   X'01'               THERE IS MORE THAN ONE OPERAND       60200001
        TITLE 'CVT MAP'                                                 60201002
DCVT     DSECT                                                          60700001
         CVT                                                            60800001
         TITLE 'ROUTE CONTROL TABLE MAP'                                60801002
DSTRCT   DSECT                                                   Y02669 60901002
         IEECVMAP RCT                                            Y02669 60902002
         TITLE 'PREFIX STORAGE AREA MAP'                                60903002
         IHAPSA                                                         60904002
         TITLE 'NEW/OLD TCB ASCB POINTERS MAP'                          60954002
         IEFPTRS                                                        61004002
         END                                                            64200001
./  ADD  SSI=70030433,NAME=IEE6403D
         TITLE 'IGC0003D  MSGRT COMMAND HANDLER LOAD TWO'               00100002
*********************************************************************** 00200001
*  MODULE NAME=  IEE6403D                                        Y02669 00201002
*                                                                       00202002
*  DESCRIPTIVE NAME =  MSGRT COMMAND HANDLER:                    Y02669 00203002
*                      REF OPERAND                               Y02669 00204002
*                      MESSAGE MODULE INTERFACE                  Y02669 00205002
*                                                                       00206002
*  COPYRIGHT =  NONE                                             Y02669 00207002
*                                                                       00208002
*  STATUS =  OS/VS2 - DUMPING IMPROVEMENTS                     @G33CPMR 00208543
*                                                                       00210002
*  FUNCTION =  THIS MODULE EXAMINES THE ROUTE CONTROL TABLE AND  Y02669 00211002
*  FORMATS ITS CONTENTS AS A MSGRT COMMAND TO DISPLAY THE        Y02669 00212002
*  DEFAULT ROUTING OPTIONS IN EFFECT FOR THE ISSUING CONSOLE. IN Y02669 00213002
*  ADDITION, IT COMPLETES THE INTERFACE TO THE FIRST SDS MESSAGE Y02669 00214002
*  MODULE.                                                       Y02669 00215002
*                                                                       00216002
*     OPERATION =                                                Y02669 00217002
*     1.  IF AN ERROR CODE IS PRESENT IN THE XAE FIELD OF THE    Y02669 00218002
*     XSA, THE INTERFACE TO IEE5603D IS COMPLETED:  UNLESS THE   Y02669 00219002
*     INTENDED ERROR MESSAGE REFERS TO THE 'L' OPERAND, THE      Y02669 00220002
*     XASTSAVE FIELD OF THE XSA IS INITIALIZED WITH THE ADDRESS  Y02669 00221002
*     OF THE INVALID OPERAND TO APPEAR IN THE MESSAGE, THE       Y02669 00222002
*     ADDRESS BEING PASSED IN REGISTER 6 FROM IEE6303D.  THEN,   Y02669 00223002
*     IF THE MESSAGE IS TO BE ABOUT THE CONTROL (K) COMMAND      Y02669 00224002
*     ( MESSAGE IEE925I), THE SECONDARY CODE IS SET IN THE HIGH  Y02669 00225002
*     ORDER BYTE OF XASTSAVE, TO CAUSE 'FOR NON CRT ONLY' TO BE  Y02669 00226002
*     APPENDED TO THE MESSAGE.                                   Y02669 00227002
*                                                                       00227203
*     2.  IF THE COMMAND WAS NOT ISSUED UNDER COMMTASK, AS     @Y02668P 00227403
*     INDICATED BY BIT XASSDS3 BEING ON, THE CMS AND LOCAL     @Y02668P 00235403
*     LOCKS ARE ACQUIPED TO PROTECT AGAINST THE CONCURRENT     @Y02668P 00244003
*     EXECUTION OF 'MR NONE'. THE LIKELY CAUSE OF THIS ENTRY   @Y02668P 00254003
*     IS TO PROCESS 'MR REF' ISSUED FROM A JES3 CONSOLE        @Y02668P 00264003
*                                                                       00265003
*     3.  IF THE COMMAND OPERAND IS OTHER THAN 'REF ', OR THE  @Z40LPTA 00272004
*         'CONT' INDICATOR IN THE XSA IS NOT ON, CONTROL       @Z40LPTA 00277004
*     IS PASSED TO THE ERROR EXIT TO ISSUE THE MESSAGE STATED    Y02669 00288003
*     THERE.  ABSENCE OF OPERANDS IS TREATED AS 'MR REF '.       Y02669 00304003
*                                                                       00336003
*     4.  THE UCME OF THE ISSUING CONSOLE IS FOUND.  FROM THIS @Y02668P 00337003
*     IT IS DETERMINED IF THE CONSOLE IS A CRT.  IF IT IS, THE   Y02669 00353003
*     DISPLAY CONTROL MODULE (DCM) IS LOCATED AND THE            Y02669 00369003
*     INSTRUCTION LINE THEREIN USED FOR THE MESSAGE.  IF THE     Y02669 00385003
*     CONSOLE IS A NON CRT, A CONDITIONAL GETMAIN FOR 150 BYTES  Y02669 00402003
*     FROM SUBPOOL 229 IS ISSUED.  IF THE GETMAIN FAILS, CONTROL Y02669 00417003
*     IS PASSED TO THE ERROR EXIT TO ISSUE THE ERROR MESSAGE     Y02669 00433003
*     INDICATED THERE.  OTHERWISE, THE FIRST 12 BYTES OF THE     Y02669 00449003
*     GOTTEN STORAGE IS INITIALIZED WITH MCSFLAGS AND MESSAGE ID Y02669 00459003
*     IEE930I.  THE REMAINDER WILL BE TREATED AS IF IT WERE THE  Y02669 00469003
*     ENTRY AREA OF THE DCM, AND WILL BE REFERRED TO AS SUCH.    Y02669 00479003
*                                                                       00489003
*     5.  THE ENTRY AREA OF THE DCM IS BLANKED AND THE MSGRT   @Y02668P 00499003
*     COMMAND ('MR') MOVED IN.  A CHECK IS THEN MADE TO          Y02669 00509003
*     DETERMINE IF THERE IS A ROUTE CONTROL TABLE (RCT) FOR THIS Y02669 00519003
*     CONSOLE.                                                   Y02669 00529003
*                                                                       00539003
*     6.  IF NOT, 'NONE' IS MOVED IN AS THE OPERAND.  IF THE   @Y02668P 00549003
*     CONSOLE IS A CRT, THE 'CHANGE OPTIONS' SWITCH IS SET       Y02669 00559003
*     AND CONTROL IS PASSED TO THE EXIT TO ISSUE THE MESSAGE     Y02669 00569003
*     INDICATED THERE.  IF THE CONSOLE IS NOT A CRT,  CONTROL    Y02669 00579003
*     PASSES TO THE WRITE2 EXIT TO WTO THE GOTTEN BUFFER,        Y02669 00589003
*     FREE IT, AND RETURN VIA BRANCH ON REGISTER 14.             Y02669 00599003
*                                                                       00609003
*     7.  IF THERE IS AN RCT, THE FIRST ENTRY IS CHECKED TO    @Y02668P 00619003
*     DETERMINE IF IT IS ACTIVE (BIT RCTACT IN BYTE RCTCODE).    Y02669 00629003
*     IF NOT, THE NEXT ENTRY IS CHECKED.  IF IT IS ACTIVE, THE   Y02669 00639003
*     VERB, OPERAND, AND ROUTING INFORMATION ARE PLACED IN THE   Y02669 00649003
*     ENTRY AREA, FORMATTED AS OPERANDS ON A VALID MSGRT         Y02669 00659003
*     COMMAND, AND THE ENTRY MARKED AS HAVING BEEN DISPLAYED     Y02669 00669003
*     (BIT RCTRES IN BYTE RCTCODE). THEN ALL OTHER ACTIVE RCT    Y02669 00679003
*     ENTRIES ARE CHECKED FOR THIS VERB, AND THOSE FOUND ARE     Y02669 00689003
*     FORMATTED AND ADDED TO THE ENTRY AREA.  ONCE ALL ENTRIES   Y02669 00699003
*     IN ALL RCT'S HAVE BEEN EXAMINED FOR ONE COMMAND, ALL ARE   Y02669 00709003
*     CHECKED FOR THE NEXT, UNTIL ALL ROUTABLE COMMANDS ARE      Y02669 00719003
*     EXHAUSTED.  THE ORDER IN WHICH THE COMMANDS ARE CHECKED IS Y02669 00729003
*     DISPLAY, TRACK, AND CONTROL.                               Y02669 00739003
*                                                                       00749003
*     8.  FOR EACH ACTIVE RCT ENTRY A BRANCH IS TAKEN TO LABEL @Z40LPTA 00749604
*         BUFCHK TO DETERMINE IF THE VERB/OPERAND WILL FIT     @Z40LPTA 00750204
*         INTO THE OUTPUT BUFFER. IF IT WILL FIT, PROCESSING   @Z40LPTA 00750804
*         CONTINUES AS ABOVE.                                  @Z40LPTA 00751404
*         IF IT WILL NOT FIT, THE OPERAND 'CONT' IS SET INTO   @Z40LPTA 00752004
*         THE OUTPUT BUFFER.                                   @Z40LPTA 00752604
*         IF THE 'CONT' OPERAND INDICATOR IS NOT ON, THE       @Z40LPTA 00753204
*         'DISPLAYED' BIT IS TURNED OFF IN EACH RCT ENTRY,     @Z40LPTA 00753804
*         AND THE MESSAGE IS WRITTEN TO THE CONSOLE.           @Z40LPTA 00754404
*         IF THE 'CONT' OPERAND INDICATOR IS ON, BUFFER AND    @Z40LPTA 00755004
*         BUFFER LENGTH PTRS ARE RESET TO BEGINNING OF BUFFER  @Z40LPTA 00755604
*         AND PROCESSING RESUMES AT (REF 4). THIS RESULTS      @Z40LPTA 00756204
*         IN THE CURRENT OUTPUT BUFFER BEING PURGED, AND       @Z40LPTA 00756804
*         RE-INITIALIZED WITH THE RCT ENTRIES THAT HAVE NOT    @Z40LPTA 00757404
*         YET BEEN DISPLAYED.                                  @Z40LPTA 00758004
*     9. ONCE ALL RCT ENTRIES HAVE BEEN EXAMINED FOR ALL VERBS,@Y02668P 00759004
*     IF NO ACTIVE ENTRIES WERE FOUND, 'NONE' IS MOVED IN.       Y02669 00769003
*     THE 'DISPLAYED' BIT IS TURNED OFF IN EACH ENTRY, AND THE   Y02669 00779003
*     MESSAGE WRITTEN AS DESCRIBED IN STEP 5.                    Y02669 00789003
*                                                                       00799003
*  NOTES =                                                       Y02669 00809003
*                                                                       00819003
*     DEPENDENCIES =  GETMAIN, FREEMAIN, DIDOCS, WTO             Y02669 00829003
*                                                                       00839003
*     CHARACTER CODE DEPENDENCIES =  THIS MODULE HAS BEEN CODED  Y02669 00849003
*     IN SUCH A WAY THAT IF THE EXTERNAL CHARACTER SET IS        Y02669 00859003
*     CHANGED FROM EBCDIC, REASSEMBLY WILL YIELD A VALID MODULE, Y02669 00869003
*     WITH THE FOLLOWING EXCEPTION:                              Y02669 00879003
*                                                                       00889003
*     THE CODE REPRESENTATION OF DECIMAL DIGITS MUST HAVE THE    Y02669 00899003
*     FOUR HIGH ORDER BITS 'ON'.  (I.E. X'FZ', WHERE Z IS ANY    Y02669 00909003
*     HEX DIGIT.)                                                Y02669 00919003
*                                                                       00929003
*     RESTRICTIONS =  THIS MODULE EXPECTS REGISTER TWO ON        Y02669 00939003
*     ENTRY TO CONTAIN THE ADDRESS OF AN XSA.                    Y02669 00949003
*                                                                       00959003
*     REGISTER CONVENTIONS =  SEE REGISTER USAGE.                Y02669 00969003
*                                                                       00979003
*     PATCH-LABEL =  PATCH                                       Y02669 00989003
*                                                                       00999003
*  MODULE TYPE =  CSECT                                          Y02669 01009003
*                                                                       01019003
*     PROCESSOR =  ASSEM                                         Y02669 01029003
*                                                                       01039003
*     MODULE SIZE =  X'54C'                                    @G33CPMR 01044043
*                                                                       01059003
*     ATTRIBUTES =  ZERO PSW PROTECT KEY     REENTRANT           Y02669 01069003
*                   SUPERVISOR STATE         PAGED LPA           Y02669 01079003
*                                                                       01089003
*  ENTRY POINT =  IEE6403D, FROM IEE6303D                        Y02669 01099003
*                                                                       01109003
*     PURPOSE =  SET UP INTERFACE TO MESSAGE MODULE IEE5603D     Y02669 01119003
*     ON BEHALF OF IEE6303D, AND PROCESS 'REF ' OPERAND OF       Y02669 01129003
*     THE MSGRT COMMAND.                                         Y02669 01139003
*                                                                       01149003
*     LINKAGE =  BRANCH FROM IEE6303D                            Y02669 01159003
*                                                                       01169003
*     INPUT =                                                    Y02669 01179003
*     REGISTER 2             ADDRESS OF XSA                      Y02669 01189003
*     LSTR(REGISTER 11)      ADDRESS OF FIRST OPERAND            Y02669 01199003
*                            ('REF ' OR ERROR)                   Y02669 01209003
*     XAL                    ADDRESS OF FIRST OPERAND            Y02669 01219003
*     XAU                    CONSOLE ID                          Y02669 01229003
*     XAV                    COMMAND VERB (MR OR MSGRT)          Y02669 01239003
*     XAE                    MESSAGE INDEX OR X'00'              Y02669 01249003
*     XASSDS                 XASSDS3 - ON, FOR NON-            @Y02668P 01259003
*                            XASSDS6 - CONTINUATION BIT        @Z40LPTA 01264004
*                            COMMTASK REQUEST                  @Y02668P 01269003
*     XASTSAVE               ADDRESS OF VARIABLE SUFFIX TEXT FOR Y02669 01279003
*                            ERROR MESSAGE, AND CODE INDICATING  Y02669 01289003
*                            FIXED SUFFIX TEXT FOR IEE5903D      Y02669 01299003
*                                                                       01309003
*     OUTPUT =  N/A                                              Y02669 01319003
*                                                                       01329003
*     REGISTERS SAVED =  NONE                                    Y02669 01339003
*                                                                       01349003
*     REGISTER USAGE =                                           Y02669 01359003
*     REGISTER 0         WORK REGISTER                           Y02669 01369003
*     REGISTER 1         WORK REGISTER                           Y02669 01379003
*     REGISTER 2         XSA BASE                                Y02669 01389003
*     REGISTER 3         END OF SYNTAX SCAN ADDRESS              Y02669 01399003
*     REGISTER 4         WORK REGISTER                           Y02669 01409003
*     REGISTER 5         BRANCH AND LINK REGISTER                Y02669 01419003
*     REGISTER 6         WORK REGISTER                           Y02669 01429003
*     REGISTER 7         UCME BASE                               Y02669 01439003
*     REGISTER 8         RCT BASE                                Y02669 01449003
*     REGISTER 9         UCM BASE                                Y02669 01459003
*     REGISTER 10        CVT BASE                                Y02669 01469003
*     REGISTER 11        OPERAND POINTER, FROM XSA               Y02669 01479003
*     REGISTER 12        MODULE BASE                             Y02669 01489003
*     REGISTER 13        SAVE REGISTER                           Y02669 01499003
*     REGISTER 14        RETURN REGISTER                         Y02669 01509003
*     REGISTER 15        LINK REGISTER                           Y02669 01519003
*                                                                       01529003
*     REGISTERS RESTORED =  NONE                                 Y02669 01539003
*                                                                       01549003
*  EXIT-NORMAL =  WRITE2                                                01559003
*                                                                       01569003
*     CONDITIONS =  MR REF PROCESSED FROM A NON CRT CONSOLE.     Y02669 01579003
*     OPERAND 'CONT' PROCESSING IS THE SAME.                   @Z40LPTA 01584004
*     MESSAGE IEE930I IS WRITTEN VIA WTO TO THE REQUESTING       Y02669 01589003
*     CONSOLE, THE MESSAGE AREA FREED VIA FREEMAIN, AND CONTROL  Y02669 01599003
*     RETURNED TO THE CALLER VIA BRANCH ON REGISTER 14.          Y02669 01609003
*     THIS EXIT IS ALSO TAKEN FOR NON-COMMTASK (I.E. JES3)     @Y02668P 01619003
*     REQUESTS.                                                @Y02668P 01629003
*                                                                       01639003
*     OUTPUT =  MESSAGE IEE930I                                  Y02669 01649003
*                                                                       01659003
*     RETURN CODES =  NONE                                       Y02669 01669003
*                                                                       01679003
*  EXIT-NORMAL =  DISPLAY2                                       Y02669 01689003
*                                                                       01699003
*     CONDITIONS =  MR REF PROCESSED FROM A CRT CONSOLE.  THE MR Y02669 01709003
*     COMMAND WHICH WOULD ESTABLISH THE CURRENT ROUTING DEFAULTS Y02669 01719003
*     FOR THE REQUESTING CONSOLE IS IN THE ENTRY AREA OF ITS DCM Y02669 01729003
*     AND THE APPROPRIATE CODE IS SET IN THE XAE FIELD OF THE    Y02669 01739003
*     XSA TO CAUSE IEE5603D TO ISSUE THE 'CHANGE OPTIONS'        Y02669 01749003
*     MESSAGE.  CONTROL IS PASSED TO IEE5603D VIA BRANCH ON VCON.Y02669 01759003
*     OPERAND 'CONT' PROCESSING IS THE SAME.                   @Z40LPTA 01764004
*                                                                       01769003
*     OUTPUT =                                                   Y02669 01779003
*     ENTRY AREA OF DCM      MSGRT COMMAND                       Y02669 01789003
*     XAE                    MESSAGE CODE X'02'                  Y02669 01799003
*                                                                       01809003
*     RETURN CODES =  NONE.                                      Y02669 01819003
*                                                                       01829003
*  EXIT-ERROR =  ERROR2                                          Y02669 01839003
*                                                                       01849003
*     CONDITIONS =  THE CONDITIONAL GETMAIN FOR THE WTO PARA-    Y02669 01859003
*     METER LIST FAILED.                                         Y02669 01869003
*     CONTROL IS PASSED TO THE MESSAGE MODULE IEE5603D VIA       Y02669 01879003
*     BRANCH ON VCON TO ISSUE MESSAGE IEE931I.                   Y02669 01889003
*                                                                       01899003
*     OUTPUT =                                                   Y02669 01909003
*     XAE              MESSAGE CODE X'0E'                        Y02669 01919003
*     XAV              COMMAND VERB (MR OR MSGRT)                Y02669 01929003
*     XAU              CONSOLE ID FOR WTO                        Y02669 01939003
*     XASTSAVE         ADDRESS OF 'REF '                         Y02669 01949003
*                                                                       01959003
*     RETURN CODES =  NONE                                       Y02669 01969003
*                                                                       01979003
*  EXIT-ERROR =  ERROR1                                          Y02669 01989003
*                                                                       01999003
*     CONDITIONS =  ENTRY TO IEE6403D WAS NOT TO SET UP MESSAGE  Y02669 02009003
*     INTERFACE.  FURTHER, THE OPERAND ON THE COMMAND IS NOT     Y02669 02019003
*     'REF '.  NEITHER IS 'REF ' TO BE DEFAULTED.                Y02669 02029003
*     CONTROL IS PASSED TO THE MESSAGE MODULE IEE5603D VIA       Y02669 02039003
*     BRANCH ON VCON TO ISSUE MESSAGE IEE156I.                   Y02669 02049003
*                                                                       02059003
*     OUTPUT =                                                   Y02669 02069003
*     XAE              MESSAGE CODE X'04'                        Y02669 02079003
*     XAV              COMMAND VERB (MR OR MSGRT)                Y02669 02089003
*     XAU              CONSOLE ID FOR WTO                        Y02669 02099003
*                                                                       02109003
*     RETURN CODES =  NONE                                       Y02669 02119003
*                                                                       02129003
*  EXIT-ERROR =  ERROR                                           Y02669 02139003
*                                                                       02149003
*     CONDITIONS =  ENTRY TO IEE6403D WAS MADE FROM IEE6303D TO  Y02669 02159003
*     SET UP THE INTERFACE TO IEE5603D TO ISSUE A MESSAGE.  IF   Y02669 02169003
*     A MESSAGE OTHER THAN IEE926I IS TO BE ISSUED, REGISTER     Y02669 02179003
*     'WRK6' IS STORED IN XASTSAVE IN THE XSA.  FURTHER, IF      Y02669 02189003
*     MESSAGE IEE925I IS TO BE ISSUED, A CODE OF X'1B' IS MOVED  Y02669 02199003
*     INTO THE HIGH ORDER BYTE OF XASTSAVE TO INDICATE THE       Y02669 02209003
*     SUFFIX TEXT TO IEE5903D.                                   Y02669 02219003
*     CONTROL IS PASSED TO THE MESSAGE MODULE IEE5603D VIA       Y02669 02229003
*     BRANCH ON VCON TO ISSUE THE APPROPRIATE MESSAGE.           Y02669 02239003
*                                                                       02249003
*     OUTPUT =                                                   Y02669 02259003
*     XAE              MESSAGE CODE PASSED FROM IEE6303D         Y02669 02269003
*     XAV              COMMAND VERB (MR OR MSGRT)                Y02669 02279003
*     XAU              CONSOLE ID FOR WTO                        Y02669 02289003
*     XASTSAVE         POSSIBLY POINTER TO VARIABLE TEXT         Y02669 02299003
*                      POSSIBLY A CODE INDICATING SUFFIX TEXT    Y02669 02309003
*                                                                       02319003
*     RETURN CODES =  NONE                                       Y02669 02329003
*                                                                       02339003
*  EXTERNAL REFERENCES =                                         Y02669 02349003
*                                                                       02359003
*     ROUTINES =  IEE5603D - SDS MESSAGE MODULE                  Y02669 02369003
*                                                                       02379003
*     DATA AREAS = NONE                                          Y02669 02389003
*                                                                       02399003
*     CONTROL BLOCKS =                                           Y02669 02409003
*     RCT          R,W                                           Y02669 02419003
*     DCM          R,W                                           Y02669 02429003
*     XSA          R,W                                           Y02669 02439003
*     UCM          R                                             Y02669 02449003
*     CVT          R                                             Y02669 02459003
*     PSA          R                                           @Y02668P 02464003
*                                                                       02469003
*     KEY;  C=CREATE, D=DELETE, R=READ, W=WRITE                  Y02669 02479003
*                                                                       02489003
*  TABLES =  VERTAB - VALID MSGRT VERBS                          Y02669 02499003
*                                                                       02509003
*  MACROS =  CVT, IEEXSA, IEECUCM, IEETDCM, IEECVMAP RCT, MODID  Y02669 02519003
*            IHAPSA, SETLOCK                                   @Y02668P 02524003
*                                                                       02529003
*     SERIALIZATION =                                            Y02669 02539003
*     LOCKS HELD =  CMS, LOCAL                                 @Y02668P 02549003
*                                                                       02559003
*  CHANGE ACTIVITY =  Y02669, Y02651, Y02668, Z40LPTA, G33CPMR @G33CPMR 02564043
*                                                                       02579003
*  MESSAGES =                                                    Y02669 02589003
*  XAE CODE                          TEXT                        Y02669 02599003
*    X'04'         IEE156I (VERB) INVALID OPERAND- (OPERAND)     Y02669 02609003
*    X'0E'         IEE931I (VERB) (OPERAND) INSUFFICIENT         Y02669 02619003
*                  STORAGE FOR COMMAND  (OPERAND IS 'REF ',      Y02669 02629003
*                  OR '   ', IF REF WAS DEFAULTED)               Y02669 02639003
*    X'02'         MR (OPERANDS)  CHANGE OPTIONS IF DESIRED      Y02669 02649003
*                  (OPERANDS ARE THE MR DEFAULTS IN EFFECT)      Y02669 02659003
*    N/A           IEE930I MR (OPERANDS)                         Y02669 02669003
*                  (OPERANDS ARE THE MR DEFAULTS IN EFFECT)      Y02669 02679003
*                                                                       02689003
*  FOR ALL BUT THE LAST MESSAGE, THE TEXT IS CONTAINED IN EITHER Y02669 02699003
*  IEE5603D OR IEE5903D, OR BOTH, AND THE MESSAGE IS ISSUED FROM Y02669 02709003
*  ONE OF THEM.  MESSAGE IEE930I IS CONSTRUCTED BY AND ISSUED BY Y02669 02719003
*  IEE6403D.                                                     Y02669 02729003
*                                                                       02739003
*  ABEND CODES =  NONE.                                          Y02669 02749003
*                                                                       02759003
**********************************************************************  04200002
         EJECT                                                          04300001
IEE6403D CSECT                                                          04400001
* A - CODE ADDED TO SUPPORT 'DISPLAY DUMP'                     @G33CPMR 04450043
********                                                              * 04500001
******** REGISTER EQUATES                                             * 04600001
********                                                              * 04700001
WRK0     EQU   0                   WORK REGISTER                        04800001
WRK1     EQU   1                   WORK REGISTER                        04900001
XSAR     EQU   2                   BASE REGISTER FOR THE XSA            05000001
WRK3     EQU   3                   WORK REGISTER                        05100001
WRK4     EQU   4                   WORK REGISTER                        05200001
BALR     EQU   5                   BRANCH AND LINK REGISTER             05300001
WRK6     EQU   6                   WORK REGISTER                        05400001
ENTR     EQU   7                   BASE REGISTER FOR THE UCM ENTRY      05500001
RCTR     EQU   8                   BASE REGISTER FOR THE RCT            05600001
UCMR     EQU   9                   BASE REGISTER FOR THE UCM            05700001
CVTR     EQU   10                  BASE REGISTER FOR THE CVT            05800001
LSTR     EQU   11                  LIST POINTER FROM XSA                05900001
BASR     EQU   12                  ROUTINE BASE REGISTER                06000001
SAVR     EQU   13                  SAVE REGISTER                        06100001
RETR     EQU   14                  RETURN REGISTER                      06200001
LNKR     EQU   15                  LINK REGISTER                        06300001
         EJECT                                                          06350001
********                                                              * 06400001
******** OTHER EQUATES                                                * 06500001
********                                                              * 06600001
N0       EQU   0                   NUMBER CONSTANT                      06700001
N1       EQU   1                   NUMBER CONSTANT                      06800001
N2       EQU   2                   NUMBER CONSTANT                      06900001
N3       EQU   3                   NUMBER CONSTANT                      07000001
N4       EQU   4                   NUMBER CONSTANT                      07100001
N5       EQU   5                   NUMBER CONSTANT                      07200001
N6       EQU   6                   NUMBER CONSTANT                      07300001
N7       EQU   7                   NUMBER CONSTANT                      07400001
N8       EQU   8                   NUMBER CONSTANT                      07500001
N10      EQU   10                  NUMBER CONSTANT                      07700001
N11      EQU   11                  NUMBER CONSTANT                      07800001
N12      EQU   12                  NUMBER CONSTANT             @Z40LPTA 07807004
N13      EQU   13                  NUMBER CONSTANT             @Z40LPTA 07809004
KCDROP   EQU   14                  NUMBER CONSTANT             @Z40LPTA 07814004
TRACKOP  EQU   18                  NUMBER CONSTANT             @Z40LPTA 07819004
MAXOP    EQU   24                  NUMBER CONSTANT             @Z40LPTA 07830004
BUFFWTO  EQU   118                 NUMBER CONSTANT             @Z40LPTA 07860004
N120     EQU   120                 NUMBER CONSTANT             @Z40LPTA 07900004
N124     EQU   124                 NUMBER CONSTANT             @Z40LPTA 07930004
BUFFDCM  EQU   126                 NUMBER CONSTANT             @Z40LPTA 07960004
N132     EQU   132                 NUMBER CONSTANT             @Z40LPTA 07980004
N136     EQU   136                 NUMBER CONSTANT             @Z40LPTA 08000004
CHARO    EQU   C'O'                CHARACTER CONSTANT: CONSOLES  Y02669 08800002
CHAR3     EQU    X'F3'                D 3850 OPERAND CONSTANT  @Z40LPTA 08830004
CHARD    EQU   C'D'                     DISPLAY VERB           @Z40LPTA 08870004
CHARP    EQU   C'P'                CHARACTER CONSTANT: DUMP    @G33CPMR 08880043
CHARK    EQU   C'K'                CONTROL VERB                         08900001
CHART    EQU   C'T'                TRACK VERB                    Y02669 09000002
COMMA    EQU   C','                COMMA CHARACTER                      09100001
PARA2    EQU   C')'                PARENTHSIS CONSTANT                  09200001
PARA1    EQU   C'('                PARENTHSIS CONSTANT                  09300001
ASTRICK  EQU   X'5C'               CHARACTER CONSTANT          @Z40LPTA 09350004
EQUAL    EQU   C'='                CHARACTER CONSTANT                   09400001
BLK      EQU   X'40'               BLANK CONSTANT                       09500001
TF       EQU   X'FF'               FLAG TO TURN OF SWITCHES             09600001
SUBP     EQU   229                 SUBPOOL FOR GET AND FREEMAIN  Y02669 09700002
XF0      EQU   X'F0'               NUMBER ZONE                          09800001
ZERO     EQU   0                   TO TEST FOR ERROR CODE PRESENT       09900001
CHGOPT   EQU   2                   ERROR CODE FOR CHANGE OPTIONS MSG    10000001
IOERROR  EQU   4                   ERROR CODE FOR INVALID OPERAND       10100001
KERROR   EQU   11                  ERROR CODE FOR INVALID K MSG         10200001
LIERROR  EQU   12                  ERROR CODE FOR INVALID L OPERAND     10300001
NCERROR  EQU   14                  ERROR CODE FOR NO STORAGE MSG Y02669 10301002
NONCRT   EQU   27                  SECONDARY CODE FOR INVALID K MSG     10400001
KVERB    EQU   X'40'               K CDR FLAG                           10500001
MCSFG    EQU   X'E0'               MCS FLAGS FOR WTO                    10600001
CF0      EQU   X'F0'               NUMBER MSSK                          10700001
XFF      EQU   X'FF'               END OF VERB TABLE                    10800001
MOPD1    EQU   X'08'               OPERAND INTO BUFFER FLAG             10900001
MOPD2    EQU   X'04'               MULTIPLE OPERANDS FLAG               11000001
MVRB1    EQU   X'02'               VERB INTO BUFFER FLAG                11100001
MVRB2    EQU   X'01'               MULTIPLE VERB FLAG                   11200001
***                                                                     11300001
         EJECT                                                          11400001
*****************************************************************       11800001
         BALR  BASR,N0             SET PROGRAM BASE                     11900001
         USING *,BASR              ESTABLISH ADDRESSIBILITY             12000001
         MODID BRANCH=YES                                        Y01886 12050001
         USING DXSA,XSAR           ADDRESSIBILITY OF XSA                12100001
         USING DSTRCT,RCTR         ADDRESSIBILITY OF RCT                12200001
         L     CVTR,CVTPTR         ADDRESS OF CVT                       12300001
         USING DCVT,CVTR           ADDRESSIBILITY OF THE CVT            12400001
         L     UCMR,CVTCUCB        ADDRESS OF UCM FROM CVT              12500001
         USING UCM,UCMR            ADDRESSIBILITY OF THE UCM     Y02669 12600002
         USING UCMLIST,ENTR        ADDRESSIBILITY OF UCM ENTRY          12700001
***                                                                   * 12800001
***   SECOND LOAD OF THE MSGRT HANDLER IS ENTERED FOR TWO CONDITIONS  * 12900001
***   IF AN ERROR CONDITION HAS BEEN FOUND IN THE FIRST LOAD          * 13000001
***   OR IF A MR REF COMMAND HAS BEEN ISSUED                          * 13100001
***                                                                   * 13200001
         SPACE 2                                                        13300001
***      IS THERE AN ERROR CODE IN THE XSA                       Y02669 13401002
STARTSC  EQU   *                                                        13600001
         CLI   XAE,ZERO            IS THERE AN ERROR CODE PRESENT?      13700001
         BNE   ERROR               BRANCH YES TO MSG MODULE EXIT        13800001
***                                                                   * 13900001
***   TEST FOR THE VERB OF THE MSGRT COMMAND                          * 14000001
***                                                                   * 14100001
         SPACE 2                                                        14200001
***      IS THIS A MSGRT REF COMMAND                             Y02669 14301002
***      IS THIS A MSGRT 'CONT' FUNCTION?                      @Z40LPTA 14351004
REFFMT   EQU   *                                                        14500001
         TM    XASSDS,XASSDS6      THIS CONTINUATION?          @Z40LPTA 14530004
         BO    REFPROC             YES, PROCESS CONTINUATION   @Z40LPTA 14560004
         CLC   N0(N4,LSTR),REF     IS THIS A REFERENCE VERB?            14600001
         BE    REFPROC             YES, PROCESS REF REQUEST      Y02669 14700004
         LTR   LSTR,LSTR           NO OPERANDS (REF DEFAULT)?    Y02669 14701002
         BNZ   ERROR1              NO, BRANCH TO ERROR EXIT      Y02669 14702002
REFPROC  EQU   *                   PROCESS REF OPERAND           Y02669 14703002
         SR    WRK1,WRK1           CLEAR REG                            14800001
         IC    WRK1,XAU            GET SOURCE CONSOLE ID                14900001
         BAL   BALR,FINDUCME       BRANCH TO FIND UCM ENTRY             15000001
         EJECT                                                          15100003
***      IS THE CONSOLE A SUBSYSTEM CONSOLE OR CRT             @Y02668P 15200003
*****************************************************************       15300001
         TM    XASSDS,XASSDS3      NON-COMMTASK(JES3) REQUEST? @Y02668P 15310003
         BNO   COMTASK1            NO,TEST FOR CRT             @Y02668P 15320003
         B     WRITE1              YES, TREAT AS NON-CRT       @Y02668P 15350003
COMTASK1 EQU   *                   CONTINUE REF PROCESSING     @Y02668P 15360003
         TM    UCMDISP,UCMDISPC    IS THIS CONSOLE A CRT                15400001
         BNO   WRITE1              BRANCH NO                            15500001
         L     CVTR,UCMXB          ADDRESS OF RESIDENT DCM              15600001
         L     CVTR,N0(CVTR)       ADDRESS OF TRANSIENT DCM             15700001
         USING DCMSTRT,CVTR     ADDRESSIBILITY OF TRANSIENT DCM  Y01012 15800101
         EJECT                                                          15900001
***      GET ADDRESS OF DCM ENTRY AREA                           Y02669 15901002
*****************************************************************       16100001
         L     WRK3,DCMAENTR       ADDRESS OF ENTRY AREA OF DCM         16200001
         LH    WRK4,DCMLGNTH       LENGTH OF LINE FROM DCM              16300001
         AR    WRK4,WRK4           TWO LINES IN ENTRY AREA              16400001
         MVI   XASAVLEN,BUFFDCM    SET DCM OUTPUT LENGTH       @Z40LPTA 16450004
BUILDL   EQU   *                                                        16500001
         ST    WRK3,XASAVBUF      SAV OUTPUT BUFFER PTR        @Z40LPTA 16510004
         LR    BALR,WRK3          BEGINNING OF BUFFER AREA     @Z40LPTA 16520004
         SR    WRK1,WRK1          ZERO REG                     @Z40LPTA 16530004
         IC    WRK1,XASAVLEN      GET OUTPUT LENGTH            @Z40LPTA 16540004
         AR    BALR,WRK1          MAXIMUM OUTPUT ADDRESS       @Z40LPTA 16550004
         ST    BALR,XASAVEND      SAVE END OF BUFFER ADDR      @Z40LPTA 16560004
BUILDL2  EQU   *                                               @Z40LPTA 16570004
         BAL   BALR,BLINST         BLANK INST. LINE                     16600001
         SR    WRK6,WRK6           CLEAR COUNT REG                      16700001
         MVC   N0(N3,WRK3),RTVB    MOVE MSGRT COMMAND INTO BUFFER       16800001
         LA    WRK3,N3(WRK3)       INCREMENT BUFFER AROUND MR CDR       16900001
         L     RCTR,UCMRCT         ADDRESS OF RCT FROM UCM              17000001
         LA    RCTR,N0(RCTR)       ZERO FLAG BYTE                       17100001
         SPACE 2                                                        17200001
***      IS THERE AN RCT FOR THIS CONSOLE                        Y02669 17201002
*****************************************************************       17400001
         LTR   RCTR,RCTR           IS THERE A RCT TABLE                 17500001
         BZ    NONEDISP            BRANCH NO                     Y02669 17600002
         LA    WRK1,VERTAB         ADDRESS OF VERB TABLE                17700001
         SPACE 2                                                        17800001
***      HAS THIS ENTRY BEEN DISPLAYED                           Y02669 17801002
*****************************************************************       18000001
SEARACT  EQU   *                                                        18100001
         TM    RCTCODE,RCTRES      HAS THIS ENTRY BEEN DISPLAYED        18200001
         BO    INCRCT              BRANCH YES                           18300001
         SPACE 2                                                        18400001
***      IS THIS ENTRY ACTIVE                                    Y02669 18401002
*****************************************************************       18600001
         TM    RCTCODE,RCTACT      IS THIS ENTRY ACTIVE                 18700001
         BO    TESTACT             BRANCH YES                           18800001
         SPACE 2                                                        18900001
***      IS THIS ENTRY CONTINUED                                 Y02669 18901002
*****************************************************************       19100001
INCRCT   EQU   *                                                        19200001
         TM    RCTCODE,RCTCON      IS THIS ENTRY CONTINUED OR THE END   19300001
         BO    NXTPTR              BRANCH IF CONTINUED                  19400001
         BM    BUILD1              BRANCH IF END                        19800001
         SPACE 2                                                        19900001
***      IF NEITHER CONTINUED NOR END, CHECK NEXT ENTRY          Y02669 19901002
*****************************************************************       20100001
         LA    RCTR,RCTLEN(RCTR)   INCREMENT TO NEXT ENTRY              20200001
         B     SEARACT             BRANCH TO CONTINUE SEARCH            20300001
         EJECT                                                          20400001
*****************************************************************       20700001
NXTPTR   EQU   *                                                        20800001
         L     RCTR,N0(RCTR)       ADDRESS OF NEXT TABLE SECTION        20900001
         B     SEARACT             BRANCH TO CONTINUE SEARCH            21000001
***                                                                   * 21100001
***  BUILD MESSAGE IN DCM INSTRUCTION LINE OR WTO BUFFER                21200001
***                                                                   * 21300001
         SPACE 2                                                        21400001
*****************************************************************       21600001
TESTACT  EQU   *                                                        21700001
         CLC   RCTVER(N1),N0(WRK1) IS THIS ENTRY EQUAL TO PRESENT VERB  21800001
         BNE   INCRCT              BRANCH NO                            21900001
         BAL   BALR,BUFCHK         CHECK BUFFER LENGTH LEFT    @Z40LPTA 21950004
         TM    XASPLS3,MVRB1       IS VERB IN BUFFER           @Y02668P 22000003
         BO    NOMOVE              BRANCH YES                           22100001
         ST    WRK3,XASTSAVE       SAVE ADDRESS IN BUFFER OF VERB       22200002
         OI    XASPLS3,MVRB1       SET VERB IN BUFFER FLAG     @Y02668P 22300003
         MVC   N1(N2,WRK3),RCTVER  MOVE VERB INTO BUFFER                22400001
         MVI   N0(WRK3),PARA1      PLACE PARENTHSIS BEFORE VERB         22500001
         LA    WRK6,N1(WRK6)       INCREMENT COUNT REG                  22600001
         CLI   RCTVER,CHARK        IS THIS A CONTROL VERB               22700001
         BE    MOVELOP             BRANCH YES                           22800001
         CLI   RCTVER,CHART        IS THIS A TRACK VERB          Y02669 22900002
         BNE   NOMOVE              BRANCH NO                            23000001
         MVI   N3(WRK3),EQUAL      MOVE EQUAL INTO BUFFER               23100001
         LA    WRK3,N1(WRK3)       INCREMENT BUFFER POINTER             23200001
NOMOVE   EQU   *                                                        23300001
         BAL   BALR,CVTCID         BRANCH TO CONVERT CC TO EBIDIC       23400001
         TM    XASPLS3,MOPD1       IS ONE OPERAND IN BUFFER    @Y02668P 23500003
         BO    TESTCCA             BRANCH YES TO COMPARE CCA            23600001
         LA    WRK3,N3(WRK3)       INCREMENT BUFFER POINTER             23700001
         MVI   N0(WRK3),PARA1      PLACE PARENTHSIS BEFORE OPERAND      23800001
         LA    WRK3,N1(WRK3)       INCREMENT BUFFER POINTER             23900001
         SPACE 2                                                        24000001
***      SET ENTRY DISPLAYED BIT IN THE RCT ON                   Y02669 24001002
*****************************************************************       24200001
MOVEOP   EQU   *                                                        24300001
         OI    RCTCODE,RCTRES      SET ENTRY DISPLAYED BIT              24400001
         MVC   N0(N1,WRK3),RCTOPD  MOVE OPERAND INTO BUFFER             24500001
         SPACE 2                                                        24501002
***      SPECIAL PROCESSING FOR MULTI-CHARACTER OPERANDS         Y02669 24502002
*****************************************************************       24503002
         CLI   N0(WRK3),CHARO      IS THIS THE CONSOLES OPERAND         24600001
         BNE   D3850CHK            NO, TEST FOR  D 3850        @Z40LPTA 24701004
         MVC   N0(N8,WRK3),CONSOLES MOVE 'CONSOLES' INTO BUFFER         24800002
         LA    WRK3,N7(WRK3)       INCREMENT BUFFER POINTER             24900001
         B     MCOMMA                                          @Z40LPTA 24950004
D3850CHK EQU   *                                                        24957004
         CLI   N0(WRK3),CHAR3      IS THIS D 3850 OPERAND    @Z40LPTA   24964004
         BNE   DDUMPCHK            NO, TEST FOR D DUMP         @G33CPMR 24967043
         MVC   N0(N4,WRK3),D3850   YES, MOVE IN OPERAND      @Z40LPTA   24978004
         LA    WRK3,N3(WRK3)       INCREMENT BUFFER PTR      @Z40LPTA   24985004
         B     MCOMMA                                          @G33CPMR 24987043
DDUMPCHK EQU   *                                               @G33CPMR 24988043
         CLI   N0(WRK3),CHARP      IS THIS D DUMP OPERAND?     @G33CPMR 24989043
         BNE   MCOMMA              NO, MOVE IN 'L='            @G33CPMR 24990043
         MVC   N0(L'DUMP,WRK3),DUMP YES, MOVE IN OPERAND       @G33CPMR 24991043
         LA    WRK3,N3(WRK3)       INCREMENT BUFFER PTR        @G33CPMR 24992043
MCOMMA   EQU   *                                                        25000001
         LA    WRK3,N1(WRK3)       INCREMENT AROUND PARENTHSIS          25100001
         MVC   N1(N3,WRK3),CLEQUAL  MOVE COMMA L AND EQUAL INTO BUFFER  25200001
         MVI   N0(WRK3),PARA2      MOVE IN PARENTHSIS                   25300001
NOPARA   EQU   *                                                        25400001
         MVC   N4(N2,WRK3),XAP+N2  MOVE IN CONSOLE ID                   25500001
         MVC   N6(N1,WRK3),RCTAID  MOVE IN AREA ID                      25600001
         OI    XASPLS3,MOPD1       SET ONE OPERAND FLAG        @Y02668P 25700003
         B     INCRCT              BRANCH FOR NEXT ENTRY                25800001
MOVELOP  EQU   *                                                        25900001
         OI    RCTCODE,RCTRES      SET ENTRY DISPLAYED BIT              26000001
         LA    WRK6,N1(WRK6)       INCREMENT COUNT OF VERBS             26100001
         LA    WRK3,N1(WRK3)       INCREMENT BUFFER PAST VERB           26200001
         BAL   BALR,CVTCID         BRANCH TO CONVERT CC TO EBIDIC       26300001
         B     MCOMMA              BRANCH TO MOVE IN L OPERAND          26400001
TESTCCA  EQU   *                                                        26500001
         CLC   N4(N2,WRK3),XAP+N2  IS THIS CONSOLE ID EQUAL             26600001
         BNE   INCRCT2             BRANCH NO                            26700001
         CLC   N6(N1,WRK3),RCTAID  IS THIS AREA ID EQUAL                26800001
         BNE   INCRCT2             BRANCH NO                            26900001
         MVI   N0(WRK3),COMMA      MOVE COMMA BETWEEN OPERANDS          27000001
         LA    WRK3,N1(WRK3)       INCREMENT BUFFER POINTER             27100001
         OI    XASPLS3,MOPD2       SET MULTIPLE OPERAND FLAG   @Y02668P 27200003
         B     MOVEOP              BRANCH TO MOVE IN OPERAND            27300001
BUILD1   EQU   *                                                        27400001
         L     WRK4,XASTSAVE       ADDRESS OF VERB                      27500001
         L     RCTR,UCMRCT         LOAD BEGINNING OF RCT                27600001
         TM    XASPLS3,MOPD1       WAS AN ENTRY MADE           @Y02668P 27700003
         BNO   NXTTAB              BRANCH NO FOR NEXT VERB SEARCH       27800001
         TM    XASPLS3,MOPD2       IS MULTIPLE OPERAND FLAG ON @Y02668P 27900003
         BO    ONEOPS              BRANCH YES                           28000001
         MVC   N0(N6,WRK3),N1(WRK3) MOVE L OPERAND OVER ONE             28100001
         CLI   N1(WRK4),CHARK      IS THIS A K COMMAND                  28200001
         BE    ONEOPS1             BRANCH YES                           28300001
         LA    BALR,N5(WRK3)       GET LENGTH OF TEXT                   28400001
         SR    BALR,WRK4           LENGTH FOR EXECUTE                   28500001
         EX    BALR,PARMOVE2       MOVE TEXT TO GET RID OF BLANKS       28600001
         CLI   N1(WRK4),CHART      THIS A TWO CHARACTER VERB TR? Y02669 28700002
         BNE   DISTYP              BRANCH NO                            28800001
         MVI   N3(WRK4),EQUAL      MOVE EQUAL AFTER TWO CHARACTER VERB  28900001
DISTYP   EQU   *                                                        29000001
         BCTR  WRK3,N0             ADJUST FOR BLANKS REMOVED            29100001
ONEOPS1  EQU   *                                                        29200001
         BCTR  WRK3,N0             ADJUST FOR BLANKS REMOVED            29300001
         EJECT                                                          29350001
ONEOPS   EQU   *                                                        29400001
         LA    WRK3,N6(WRK3)       INCREMENT BUFFER POINTER             29500001
         NI    XASPLS3,TF-MOPD1-MOPD2-MVRB1 SET OPD AND VERB   @Y02668PX29600003
                                   FLAGS OFF                   @Y02668P 29650003
         MVI   N1(WRK3),PARA2      MOVE PARENTHSIS AROUND VERB          29700001
         MVI   N2(WRK3),COMMA      COMMA INTO BUFFER                    29800001
         LA    WRK3,N3(WRK3)       INCREMENT BUFFER POINTER             29900001
         TM    XASPLS3,MVRB2       DOES VERB HAVE DIFFERENT    @Y02668PX30000003
                                   ROUTED OPERANDS             @Y02668P 30050003
         BNO   NXTTAB              BRANCH NO                            30100001
         NI    XASPLS3,TF-MVRB2    TURN OFF VERB MOVED FLAG    @Y02668P 30200003
         B     SEARACT             BRANCH BACK TO SEARCH RCT            30300001
NXTTAB   EQU   *                                                        30400001
         LA    WRK1,N1(WRK1)       INCREMENT VERB TABLE                 30500001
         CLI   N0(WRK1),XFF        IS THIS THE END                      30600001
         BNE   SEARACT             BRANCH NO                            30700001
         LTR   WRK6,WRK6           ARE THERE ANY ACTIVE ENTRIES IN RCT  30800001
         BZ    NONEDISP            BRANCH NO PUT OUT MESSAGE            30900002
         BCTR  WRK3,N0             DECREMENT BUFFER POINTER             31000001
         MVI   N0(WRK3),BLK        BLANK OUT COMMA CHARACTER            31100001
         CH    WRK6,ONE            IS COUNT OF VERB GREATER THAN ONE    31200001
         BH    DISPLAY             BRANCH YES TO TURN OFF        Y02669 31300002
*                                  'DISPLAYED' FLAG IN RCT       Y02669 31301002
         BCTR  WRK3,N0             DECREMENT BUFFER POINTER             31400001
         MVI   N0(WRK3),BLK        BLANK OUT PARENTHSIS CHARACTER       31500001
         LR    WRK1,WRK3           END ADDRESS OF                       31600001
         SR    WRK1,WRK4           LENGTH OF VERB TEXT                  31700001
         BCTR  WRK1,N0             DECREMENT COUNT BY ONE               31800001
         EX    WRK1,PARMOVE1       MOVE TO BLANK VERB PARENTHSIS        31900001
         BCTR  WRK3,N0             DECREMENT BUFFER POINTER             32000001
*                                  I.E. SHIFT TEXT LEFT ONE BYTE Y02669 32001002
         SPACE 2                                                        32100001
*****************************************************************       32300001
DISPLAY  EQU   *                                                        32400001
         NI    RCTCODE,TF-RCTRES   TURN OFF DISPLAYED FLAG IN RCT       32500002
         TM    RCTCODE,RCTCON      IS THIS ENTRY THE END OR CONTINUED   32600001
         BM    DISPLAY2            BRANCH YES END                       32700001
         BO    NXTPTR3             BRANCH YES CONTINUED                 32800001
         LA    RCTR,RCTLEN(RCTR)   INCREMENT TO NEXT ENTRY              32900001
         B     DISPLAY             BRANCH BACK TO SEARCH                33000001
NXTPTR3  EQU   *                                                        33100001
         L     RCTR,N0(RCTR)       NEXT SECTION OF THE RCT              33200001
         B     DISPLAY             BRANCH BACK TO SEARCH                33300001
         EJECT                                                          33400001
***      NO ACTIVE ENTRIES, OR NO RCT'S, FOUND                  Y02669  33450002
*****************************************************************       33600001
NONEDISP EQU  *                                                 Y02669  33650002
         MVC  N0(N4,WRK3),NONE     MOVE IN 'NONE'               Y02669  33660002
         LA   WRK3,N4(WRK3)        INCREMENT BUFFER PAST 'NONE' Y02669  33660402
     SPACE 2                                                            33662002
*****************************************************************       33670002
DISPLAY2 EQU   *                                                        33700001
         TM    XASSDS,XASSDS3      NON-COMMTASK (JES3) REQUEST?@Y02668P 33710003
         BNO   COMTASK2            NO, CONTINUE CHECKS         @Y02668P 33720003
         BAL   LNKR,CLRLOCK        YES, RELEASE LOCKS          @Y02668P 33730003
         B     WRITE2              GO DO WTO                   @Y02668P 33740003
COMTASK2 EQU   *                                               @Y02668P 33750003
         TM    UCMDISP,UCMDISPC    IS THIS CONSOLE A CRT                33900001
         BNO   WRITE2              BRANCH NO                            34000001
         SPACE 2                                                        34100001
***      SET   CHANGE OPTIONS MESSAGE CODE IN XAE                Y02669 34101002
*****************************************************************       34400001
         L     WRK6,DCMAENTR       ADDRESS OF ENTRY AREA OF DCM         34500001
         LA    WRK6,N3(WRK6)       ADDRESS OF CURSOR FOR MSG RTN        34600001
         MVI   XAE,CHGOPT          MSG CODE FOR CHANGE OPTIONS          34700001
         B     ERROR               BRANCH TO PUT OUT MSG                34800001
INCRCT2  EQU   *                                                        34900001
         OI    XASPLS3,MVRB2       SET MULTIPLE OPERANDS FLAG  @Y02668P 35000003
         B     INCRCT              BRANCH FOR NEXT ENTRY                35100001
CVTCID   EQU   *                                                        35200001
         SR    WRK4,WRK4           CLEAR REG                            35300001
         IC    WRK4,RCTCID         GET CONSOLE ID FROM RCT              35400002
         CVD   WRK4,XAP            CONVERT CONSOLE ID TO DECIMAL        35500001
         UNPK  XAP+N1(N3),XAP+N6(N2) CONVERT TO PRINTABLE CHARACTERS    35600001
         OI    XAP+N3,CF0          CHANGE ZONE TO EBDIC                 35700001
         BR    BALR                BRANCH BACK TO CALLING RTN           35800001
         SPACE 2                                                        35900001
***      GETMAIN STORAGE FOR MESSAGE BUFFER                      Y02669 35901002
*****************************************************************       36100001
WRITE1   EQU   *                                                        36200001
         LA    WRK1,XAX+N4         AREA FOR STORAGE ADDRESS             36300001
         MVC   XAP(N10),GETAREA    MOVE REMOTE PARAMETER LIST TO XSA    36400001
         ST    WRK1,XAD            AREA FOR GETMAIN TO STORE ADDRESS    36500001
         LA    WRK1,XAP            ADDRESS OF REMOTE LIST FOR GETMAIN   36600001
         GETMAIN MF=(E,(1))        GET CORE FOR WTO                     36700001
         LTR   LNKR,LNKR           IS RETURN CODE ZERO                  36800001
         BNZ   ERROR2              NO, GO SET-UP FOR IEE931I     Y02669 36900002
         L     WRK3,XAX+N4         BUFFER ADDRESS                       37000001
         XC    N0(N4,WRK3),N0(WRK3) ZERO FOUR BYTES                     37100001
         OI    N2(WRK3),MCSFG      SET MCS FLAGES FOR WTO               37200001
         LA    WRK3,N4(WRK3)       INCREMENT BUFFER ADDRESS             37300001
         TM    XASSDS,XASSDS3      NON-COMMTASK(JES3) REQUEST? @Y02668P 37310003
         BNO   COMTASK3            NO, UNDER COMMTASK, NO      @Y02668P 37320003
*                                  LOCKS NEEDED                @Y02668P 37330003
         BAL   LNKR,GETLOCK        YES, GET CMS/LOCAL LOCKS    @Y02668P 37340003
COMTASK3 EQU   *                   CONTINUE REF PROCESSING     @Y02668P 37350003
*****************************************************************       37600001
         MVC   N0(N8,WRK3),IEE     MESSAGE ID INTO BUFFER               37700001
         LA    WRK3,N8(WRK3)       INCREMENT BUFFER AROUND MSG ID       37800001
         LA    WRK4,N120           LENGTH OF BUFFER REMAINING           37900004
         MVI   XASAVLEN,BUFFWTO    SET WTO OUTPUT LENGTH       @Z40LPTA 37930004
         B     BUILDL              BRANCH TO BUILD MESSAGE              38000001
         EJECT                                                          38100003
***      WRITE MESSAGE VIA WTO TO NON-CRT CONSOLE                Y02669 38101002
*****************************************************************       38300001
WRITE2   EQU   *                                                        38400001
         LR    WRK6,WRK3           SAVE ADDRESS OF MSG END     @Y02668P 38450003
         L     WRK3,XAX+N4         ADDRESS OF GETMAINED AREA            38500001
         SR    WRK6,WRK3           GET LENGTH OF BUFFER  TEXT           38600001
         STH   WRK6,N0(WRK3)       LENGTH OF WTO MSG PLUS 4             38700001
         AR    WRK6,WRK3           END OF BUFFER                        38800001
         MVC   N0(N4,WRK6),DRCODES MOVE IN DESC AND ROUTE CODES         38900001
         SR    WRK0,WRK0           CLEAR REG                            39000001
         IC    WRK0,XAU            TERMINAL ID FROM XSA                 39100001
         WTO   MF=(E,(WRK3))       WRITE MESSAGE                        39200001
         SPACE 2                                                        39201002
***      FREEMAIN MESSAGE BUFFER                                 Y02669 39202002
*****************************************************************       39500001
         L     WRK1,XAX+N4         ADDRESS OF WORD FOR GETMAIN          39600001
         FREEMAIN R,LV=N132,A=(1),SP=SUBP                      @Z40LPTA 39700004
         SPACE 2                                                        39800001
***      EXIT:  RETURN TO CALLER                                 Y02669 39801002
*****************************************************************       40000001
RET      EQU   *                                                 Y02669 40001002
         BR    RETR                RETURN TO CALLER                     40100001
***                                                                     40150001
***   BLANK BUFFER FOR MESSAGE                                          40160001
***                                                                     40170001
BLINST   EQU   *                                                        40200001
         BCTR  WRK4,N0             DECREMENT THE LENGTH -               40300001
         BCTR  WRK4,N0             BY TWO                               40400001
         MVI   N0(WRK3),BLK        BLANK FIRST CHARACTER                40500001
         EX    WRK4,BLI            PROPAGATE BLANKS                     40600001
         BR    BALR                RETURN FROM SUBROUTINE               40700001
         EJECT                                                          40750001
BUFCHK   EQU   *                                               @Z40LPTA 40751004
* TEST REMAINDER OF THE OUTPUT BUFFER TO DETERMINE IF THE               40752004
* NEXT OPERAND OR VERB WILL CAUSE BUFFER-OVERFLOW. IF IT                40753004
* WILL, SET UP THE 'CONT' OPERAND.                                      40754004
         ST    WRK4,XAD              SAVE REG VALUE                     40755004
         CLI   RCTVER,CHARD        THIS DISPLAY VERB           @Z40LPTA 40755304
         BNE   CHECKTR             NO, TEST FOR TRACK          @Z40LPTA 40755604
         LA    WRK4,MAXOP(WRK3)    LENGTH OF MAX OPERAND +CONT @Z40LPTA 40756004
         B     CHECKPTR            CHECK BUFFER CONTENT        @Z40LPTA 40756104
CHECKTR  EQU   *                                               @Z40LPTA 40756204
         CLI   RCTVER,CHART        THIS TRACK VERB             @Z40LPTA 40756304
         BNE   CHECKKCM            NO, SET UP K CMND. LEN      @Z40LPTA 40756404
         LA    WRK4,TRACKOP(WRK3)  LEN OF TRACK OPERAND + CONT @Z40LPTA 40756504
         B     CHECKPTR            CHECK BUFFER CONTENT        @Z40LPTA 40756604
CHECKKCM EQU   *                                               @Z40LPTA 40756704
         LA    WRK4,KCDROP(WRK3)   LEN OF K CMND + CONT        @Z40LPTA 40756804
CHECKPTR EQU   *                                               @Z40LPTA 40756904
         CLI   N0(WRK3),PARA2      PTR AT '),L=CCA' ?                   40757004
         BNE   NEXTCHK             NO, AT END OF VERB                   40758004
         LA    WRK4,N6(WRK4)       YES,BUMP PAST 'L=' VALVE             40759004
NEXTCHK  EQU   *                                                        40760004
         C     WRK4,XASAVEND      WILL OPERAND FIT?                     40761004
         BH    SETCONT            NO, SET UP CONTINUATION               40762004
         L     WRK4,XAD           RESTORE REG VALUE                     40763004
         BR    BALR               RETURN TO MAIN-LINE                   40764004
SETCONT  EQU   *                                                        40765004
* ENTRY HERE IS TO SET UP THE 'CONT'  OPERAND IN THE OUTPUT             40766004
* BUFFER. DETERMINE WHAT THE LAST CHARACTER IS IN THE BUFFER-           40767004
* ', ' OR '(L=CCA' ; INITIALIZE IT WITH THE 'CONT' OPERAND.             40768004
*                                                                       40769004
         CLI   N0(WRK3),BLK        THIS END OF VERB ?                   40770004
         BNE   MULTOP              NO, MULTIPE OPERAND.                 40771004
         MVC   N0(N4,WRK3),CONT    SET UP 'CONT' OPERAND                40772004
         LA    WRK3,N4(WRK3)       ADJUST BUFFER ADDRESS       @Z40LPTA 40772504
         B     TSTCONT                                                  40773004
MULTOP   EQU   *                                                        40774004
         LR    WRK4,WRK3           GET OUTPUT BUFFER PTR                40774104
         BCTR  WRK4,N0             DECREMENT PTR                        40774204
         BCTR  WRK4,N0                           BY TWO                 40774304
         CLI    N0(WRK4),PARA1      THIS LEFT PAREN                     40774404
         BNE    MULTOP1             NO, CONTINUE                        40774504
         MVC    N0(N8,WRK4),N1(WRK4) YES, DELETE RIGHT PAREN            40774604
         MVC    N1(N6,WRK4),N2(WRK4) DELETE RIGHT PAREN                 40774704
         LR     WRK3,WRK4           RE-SET OUTPUT BUFFER PTR            40774804
MULTOP1  EQU    *                                                       40774904
         CLI   N6(WRK3),ZERO       AREA ID SPECIFIED ?                  40775004
         BNE   MOVEND              YES                                  40776004
         MVI   N6(WRK3),ASTRICK    NO, SET SPECIAL FILLER               40777004
MOVEND   EQU   *                                                        40778004
         MVC   N7(N6,WRK3),PCCONT  MOVE IN ' ),CONT'                    40779004
         LA    WRK3,N13(WRK3)      ADJUST BUFFER ADDRESS       @Z40LPTA 40779504
TSTCONT  EQU   *                                                        40780004
         TM    XASSDS,XASSDS6      ARE WE PROCESSING CONT NOW           40781004
         BNO   SETRCT              NO, ISSUE FIRST MR                   40782004
         XC    XASPLS3,XASPLS3     CLEAR INTERNAL FLAGS        @Z40LPTA 40783004
         NI    XASSDS,TF-XASSDS6   CLEAR 'CONT' INDICATOR               40784004
* SET UP TO BLANK OUT THE OUTPUT BUFFER, SO IT CAN BE RE                40785004
* INITIALIZED WITH THE REMAINING RCT ENTRIES.                           40786004
*                                                                       40787004
         SR    WRK4,WRK4           ZERO LENGTH REG                      40788004
         IC    WRK4,XASAVLEN       GET OUTPUT LENGTH                    40789004
         L     WRK3,XASAVBUF       GET BUFFER ADDRESS                   40790004
         B     BUILDL2             START RE-SCAN                        40791004
SETRCT   EQU   *                                                        40792004
         L     RCTR,UCMRCT         RCT TABLE ADDRESS                    40793004
         LA    RCTR,N0(RCTR)       CLEAR HI-BYTE                        40794004
         B     DISPLAY             PROCESS THIS BUFFER                  40795004
         EJECT                                                          40796004
***                                                                     40800001
***  FIND AND SET BASE FOR UCM ENTRY - INPUT - WRK1 CONTAINS CONSOLE ID 40900001
***                                  - OUTPUT - UCM ENTRY SPECIFIED BY  41000001
*                                              ID IN ENTR REG           41100001
*                                                                     * 41200001
FINDUCME EQU   *                                                        41300001
         L     ENTR,UCMVEA         FIRST ENTRY FROM UCM                 41400001
         BCTR  WRK1,N0             SUBRRACT ONE FROM CONSOLE ID         41500001
         M     WRK0,UCMVEZ         MULIPLY ENTRY SIZE BY REDUCED ID     41600001
         AR    ENTR,WRK1           ADDRESS OF DESIRED UCM ENTRY         41700001
         BR    BALR                RETURN FROM SUBROUTINE               41800001
         SPACE 2                                                        41801002
***      SET NO STORAGE CODE IN XSA                              Y02669 41802002
*****************************************************************       41803002
ERROR2   MVI   XAE,NCERROR         MESSAGE CODE FOR IEE931I      Y02669 41804002
         LR    WRK6,LSTR           ADDRESS OF 'REF ' IN BUFFER   Y02669 41805002
         B     ERROR               GO FINISH MSG INTERFACE       Y02669 41806002
         SPACE 2                                                        41900001
***      SET INVALID OPERAND CODE IN XSA                         Y02669 41901002
*****************************************************************       42100001
ERROR1   EQU   *                                                        42200001
         MVI   XAE,IOERROR         ERROR CODE FOR INVALID OPERAND       42300001
         LR    WRK6,LSTR           ADDRESS OF INVALID OPERAND           42400001
         SPACE 2                                                        42500001
***                                                              Y02669 42501002
***      SET SECONDARY MESSAGE CODE IN XSA                       Y02669 42502002
***                                                              Y02669 42503002
ERROR    EQU   *                                                        42800001
         CLI   XAE,LIERROR         IS THIS AN INVALID L OPERAND MSG     42900001
         BE    EXIT                BRANCH YES TO MSG MODULE             43000001
         ST    WRK6,XASTSAVE       STORE ADDRESS OF INVALID OPERAND     43100001
         CLI   XAE,KERROR          IS THIS A K ERROR MSG                43200001
         BNE   EXIT                BRANCH NO TO MSG MODULE              43300001
         MVI   XASTSAVE,NONCRT     SET SECONDARY ERROR CODE FOR MSG     43400001
         SPACE 2                                                        43500001
***                                                              Y02669 43501002
***      EXIT TO MR MESSAGE MODULE 1     IEE5603D                Y02669 43502002
***                                                              Y02669 43503002
EXIT     EQU   *                                                        43800001
         NI    XASSDS,XFF-XASSDS5  TURN OFF LOCK FLAG TO AVOID   Y02651 43801002
*                                  FALSE INDICATION TO IEE5603D  Y02651 43802002
*                                  THAT LOCKS ARE HELD           Y02651 43803002
         L     LNKR,MSGL1          ADDRESS OF MSG MODULE         Y02669 43900002
         BR    LNKR                BRANCH TO IEE5603D            Y02669 43901002
     EJECT                                                              43931003
******************************************************************      43961003
***      GETLOCK ROUTINE.                                      @Y02668P 43991003
***      ACQUIRES LOCAL AND CMS LOCKS,IF NOT ALREADY HELD.     @Y02668P 44021003
******************************************************************      44051003
     SPACE 2                                                            44081003
GETLOCK  TM    XASSDS,XASSDS5      LOCKS ALREADY HELD?         @Y02668P 44111003
         BO    LOKSHELD            YES, DON'T REACQUIRE        @Y02668P 44141003
         STM   LSTR,RETR,XASAVLOC  SAVE REGS ACROSS SETLOCKS   @Y02668P 44171003
SETLOCK1 SETLOCK OBTAIN,TYPE=LOCAL,MODE=UNCOND,                @Y02668PX44201003
               RELATED=(RCT,IEE6403D(CLRLOCK1))                @Y02668P 44231003
SETLOCK2 SETLOCK OBTAIN,TYPE=CMS,MODE=UNCOND,                  @Y02668PX44261003
               RELATED=(RCT,IEE6403D(CLRLOCK2))                @Y02668P 44291003
         LM    LSTR,RETR,XASAVLOC  RESTORE SAVED REGS          @Y02668P 44321003
         OI    XASSDS,XASSDS5      SET LOCKS HELD SWITCH       @Y02668P 44351003
LOKSHELD BR    LNKR                RETURN TO CALLER            @Y02668P 44381003
         SPACE 2                                                        44500001
******************************************************************      44510003
***      CLRLOCK ROUTINE. RELEASES CMS AND LOCAL LOCKS,IF HELD.@Y02668P 44520003
******************************************************************      44530003
         SPACE                                                          44540003
CLRLOCK  TM    XASSDS,XASSDS5      LOCKS HELD?                 @Y02668P 44550003
         BZ    N0(LNKR)            NO,RETURN TO CALLING ROUTINE@Y02668P 44560003
         STM   LSTR,RETR,XASAVLOC  SAVE REGS ACROSS SETLOCKS   @Y02668P 44570003
CLRLOCK2 SETLOCK RELEASE,TYPE=CMS,                             @Y02668PX44580003
               RELATED=(RCT,IEE6403D(SETLOCK2))                @Y02668P 44590003
CLRLOCK1 SETLOCK RELEASE,TYPE=LOCAL,                           @Y02668PX44600003
               RELATED=(RCT,IEE6403D(SETLOCK1))                @Y02668P 44610003
         LM    LSTR,RETR,XASAVLOC  RESTORE SAVED REGS          @Y02668P 44620003
         NI    XASSDS,XFF-XASSDS5  TURN OFF LOCKS HELD SWITCH  @Y02668P 44630003
         BR    LNKR                RETURN TO CALLING ROUTINE   @Y02668P 44640003
         SPACE 2                                                        44650003
*****************************************************************       44700001
BLI      MVC   N1(N0,WRK3),N0(WRK3)  USED TO BLANK INST LINE            44800001
PARMOVE2 MVC   N3(N0,WRK4),N4(WRK4) ELIMINATE PARENTHSIS                44900001
PARMOVE1 MVC   N0(N0,WRK4),N1(WRK4) ELIMINATE PARENTHSIS                45000001
         EJECT                                                          45050001
********                                                              * 45100001
******** CONSTANT USED BY ROUTINE                                     * 45200001
********                                                              * 45300001
REF      DC    C'REF '             REFERENCE VERB                       45400001
CONSOLES DC    C'CONSOLES'         CONSOLES OPERAND IN RCT IS O         45500001
D3850    DC    C'3850'             D 3850 OPERAND IN RCT IS 3  @Z40LPTA 45530004
DUMP     DC    C'DUMP'             D DUMP OPERAND IN RCT IS P  @G33CPMR 45540043
CONT     DC    C'CONT'             CONTINUATION OPERAND        @Z40LPTA 45560004
PCCONT   DC    C'),CONT'           CONTINUATION + DELIMITER    @Z40LPTA 45570004
IEE      DC    C'IEE930I '         MESSAGE ID FOR MSGRT REF CDR         45600001
RTVB     DC    C'MR '              MSGRT COMMAND                        45700001
VERTAB   DC    C'DTK'              VERB TABLE                    Y02669 45800002
         DC    X'FF'               END OF VERB TABLE                    45900001
CLEQUAL  DC    C',L='              L OPERAND                            46000001
NONE     DC    C'NONE'             NONE OPERAND                  Y02669 46050002
MSGL1    DC    V(IEE5603D)         MSG MODULE LOAD ONE           Y02669 46100002
DRCODES  DC    X'0800'             DESCRIPTOR CODES                     46200001
         DC    X'0000'             ROUTING CODES                        46300001
ONE      DC    H'1'                VALUE ONE                            46400001
GETAREA  GETMAIN EC,LV=N132,A=EXIT,SP=SUBP,MF=L                @Z40LPTA 46500004
PATCH    DC    CL50'***  IEE6403D  PATCH AREA  ***'            @G33CPMR 46550043
          TITLE  'TRANSIENT DISPLAY CONTROL MODULE MAP'                 46601002
         IEETDCM                                                 Y01012 47100101
          TITLE 'UNIT CONTROL MODULE MAP'                               47101102
         IEECUCM  FORMAT=NEW                                     Y02669 47400002
          TITLE 'CVT MAP'                                               47401002
DCVT     DSECT                                                          47600001
         CVT                                                            47700001
          TITLE 'EXTENDED SAVE AREA (XSA) MAP'                          47800002
DXSA     DSECT                                                          47900001
         IEEXSA                                                         48900003
         SPACE 2                                                        48950004
***************************************************************@Z40LPTA 49000004
*        THE FOLLOWING FIELDS ARE USED ONLY BY THIS MODULE,    @Z40LPTA 49050004
*        AS A STORAGE AREA FOR DATA PERTINENT TO THIS MODULES  @Z40LPTA 49100004
*        FUNCTION ONLY.                                        @Z40LPTA 49150004
         ORG   XASAVSTD                                        @Z40LPTA 49200004
XASAVBUF DS    F                   TEXT BEGINNING ADDRESS      @Z40LPTA 49250004
XASAVEND DS    F                   TEXT END ADDRESS            @Z40LPTA 49300004
XASAVLEN DS    X                   TEXT LENGTH                 @Z40LPTA 49350004
IEE6403D  TITLE 'ROUTE CONTROL TABLE MAP'                               50100002
DSTRCT   DSECT                                                   Y02669 50100202
         IEECVMAP RCT                                                   50101002
          TITLE 'PREFIX STORAGE AREA MAP'                               51101003
         IHAPSA                                                         52101003
         END                                                            53300001
./  ADD  SSI=60630217,NAME=IEE6703D
        TITLE 'IEE6703D K AND STOPTR COMMAND HANDLER'                   00100002
*********************************************************************** 00150002
*                                                                     * 00200002
*   MODULE NAME         =       IEE6703D                        Y02669* 00250002
*                                                                     * 00300002
*   DESCRIPTIVE NAME    =       CONTROL (K) AND STOPTR (PT)     Y02669* 00350002
*                               COMMAND HANDLER FOR GRAPHICS    Y02669* 00360002
*                               DEVICES                         Y02669* 00370002
*                                                                     * 00400002
*   COPYRIGHT           =       N/A                             Y02669* 00450002
*                                                                     * 00500002
*   STATUS              =       01 - UPDATE FOR VS/2 RELEASE 3 ZA03632* 00550003
*                                                                     * 00600002
*   FUNCTION            =       SYNTAX CHECK CONTROL (K)        Y02669* 00650002
*                               COMMANDS. SCHEDULES K COMMANDS  Y02669* 00700002
*                               BY POSTING DIDOCS, WHEN THEY    Y02669* 00710002
*                               MUST BE HANDLED BY USING THE    Y02669* 00750002
*                               TRANSIENT PORTION OF THE        Y02669* 00800002
*                               DISPLAY CONTROL MODULE (DCM).   Y02669* 00850002
*                               K COMMANDS WHICH ARE HANDLED    Y02669* 00900002
*                               USING ONLY THE RESIDENT PORTION Y02669* 00950002
*                               OF THE DCM ARE HANDLED BY       Y02669* 01000002
*                               ROUTING THE COMMAND TO THE      Y02669* 01050002
*                               APPROPIATE ROUTINES FOR         Y02669* 01050802
*                               ADDITIONAL PROCESSING.          Y02669* 01051202
*                                                                     * 01052402
*                               FOR STOPTR COMMANDS FOR WHICH   Y02669* 01054002
*                               THE SCREEN MUST BE CLEARED      Y02669* 01054402
*                               (I.E. PT A OR IF THERE IS NO    Y02669* 01054802
*                               REMAINING ACTIVE TRACK OPTION)  Y02669* 01055202
*                               A PARAMETER LIST IS BUILT IN    Y02669* 01055602
*                               SP241 CONTAINING THE COMMAND    Y02669* 01056002
*                               AND OPERANDS, TRACK PROCESSOR   Y02669* 01058002
*                               IS POSTED AND EITHER CONTROL    Y02669* 01058402
*                               IS RETURNED OR DIDOCS POSTED.   Y02669* 01060002
*                                                                     * 01080002
*    OPERATION          =       FOR THE FOLLOWING COMMANDS,     Y02669* 01090002
*                               IF AN L OPERAND WAS SPECIFIED   Y02669* 01090402
*                               MESSAGE 'IEE926I' IS ISSUED VIA Y02669* 01090802
*                               IEE5603D. OTHERWISE A K-PARM    Y02669* 01091202
*                               LIST IS BUILT WITH A MODULE     Y02669* 01092002
*                               IDENTIFIER, THE OPERAND LIST,   Y02669* 01092402
*                               THE AREA ID, AND A CONTROL      Y02669* 01094002
*                               COMMAND INDICATOR.              Y02669* 01096002
*                               (SEE DATA AREAS)                Y02669* 01096402
*                               CONTROL IS THEN EITHER RETURNED Y02669* 01098002
*                               OR DIDOCS IS POSTED (SEE EXITS).Y02669* 01098402
         EJECT                                                          01098502
*                                                                     * 01098802
*                                  COMMANDS     MOD ID          Y02669* 01099702
*                                  ________    _________        Y02669* 01099802
*                                  K  E,       IGC5607B         Y02669* 01100002
*                                  K  E,N      IGC5407B         Y02669* 01110002
*                                  K  S        IGC5A07B         Y02669* 01120002
*                                  K  S,       IGC5A07B         YM1913* 01125002
*                                  K  D        IGC5907B         Y02669* 01130002
*                                  K  D,N      IGC5907D         Y02669* 01140002
*                                  K  D,N,HOLD IGC5907D         Y02669* 01142002
*                                  K  E,PFK    IGC6B07B         Y02669* 01144002
*                                  K  D,PFK    IGC6B07B         Y02669* 01146002
*                                  K  N        IGC6B07B         Y02669* 01148002
*                                  K  E        IGC5807B         Y02669* 01148402
*                                  K  E,SEG    IGC5807B         Y02669* 01148802
*                                                                     * 01149202
*                               FOR THE FOLLOWING COMMANDS,     Y02669* 01149602
*                               NO PROCESSING IS DONE IN THIS   Y02669* 01149702
*                               MODULE:                         Y02669* 01149802
*                                                                     * 01160002
*                                  K  V    BRANCHES TO IEE7703D Y02669* 01162302
*                                  K  C,D  BRANCHES TO IEE7803D Y02669* 01172302
*                                  K  A    BRANCHES TO IEE6803D Y02669* 01174302
*                                  K  T    BRANCHES TO IEE6803D Y02669* 01184302
*                                                                     * 01187002
*                               FOR THE FOLLOWING COMMANDS,     Y02669* 01187402
*                               INITIAL PROCESSING IS DONE IN   Y02669* 01189402
*                               THIS MODULE.                    Y02669* 01191602
*                               THEN THE K-PARM LIST IS BUILT   Y02669* 01193602
*                               AND CONTROL IS EITHER RETURNED  Y02669* 01195602
*                               OR DIDOCS IS POSTED (SEE EXITS).Y02669* 01195702
*                                                                     * 01202002
*                                  COMMAND      MOD ID          Y02669* 01204002
*                                  ________    ________         Y02669* 01206002
*                                  K   E,D     IGC6P07B         Y02669* 01208002
*                                  K   D,F     IGC6N07B         Y02669* 01208402
*                                  K   D,U     IGC6N07B         Y02669* 01208802
*                                  K   D,H     IGC6N07B         Y02669* 01208902
*                                                                     * 01209302
*                               BASED ON THE L=CCA OPERAND ON   Y02669* 01210902
*                               THE COMMAND THE INITIAL         Y02669* 01211302
*                               PROCESSING IS AS FOLLOWS:       Y02669* 01211702
*                          #### IF AN AREA IS SPECIFIED ON THE  Y02669* 01212902
*                               COMMAND AND IT DOES NOT MATCH   Y02669* 01213302
*                               ANY EXISTING AREA - 'IEE151I    Y02669* 01213702
*                               NO DISPLAY IN AREA.'            Y02669* 01214902
         EJECT                                                          01216902
*                                                                     * 01219502
*                             # IF AREAS MATCH AND OPERAND      Y02669* 01219602
*                               FIELD IS D,H OR D,U:            Y02669* 01220802
*                               IF NO DISPLAY IN AREA - IEE158I Y02669* 01222002
*                               IF IT IS NOT DYNAMIC - IEE158I  Y02669* 01223202
*                               OTHERWISE FLAG SET IN SACB FOR  Y02669* 01224402
*                               HOLD AND CLEARED FOR UPDATE:    Y02669* 01225402
*                                  DCMADFLG = DCMAHOLD (X'40')  Y02669* 01226802
*                               AND THE PARM LIST IS BUILT.     Y02669* 01228002
*                                                                     * 01228402
*                             # IF AREAS MATCH AND OPERAND      Y02669* 01229202
*                               FIELD IS D,F:                   Y02669* 01229602
*                               IF NO DISPLAY IN AREA - IEE158I Y02669* 01231602
*                               IF FRAMING IN PROCESS - IEE158I Y02669* 01232802
*                               IF LAST FRAME ON SCREEN-IEE158I Y02669* 01234002
*                               OTHERWISE SET FRAMING IN        Y02669* 01235202
*                               PROCESS BIT IN DCM:             Y02669* 01236402
*                                  DCMAFLG1 - DCMAFRPR (X'10')  Y02669* 01237602
*                               AND THE PARM LIST IS BUILT.     Y02669* 01238802
*                                                                     * 01239202
*                             # IF AREAS MATCH AND OPERAND      Y02669* 01240002
*                               FIELD IS E,D:                   Y02669* 01241202
*                               IF NO DISPLAY IN AREA - IEE158I Y02669* 01242402
*                               IF DISPLAY IS DYNAMIC - IEE151I Y02669* 01243602
*                                 USE STOPTR                    Y02669* 01244402
*                               OTHERWISE, THE PARM LIST IS     Y02669* 01244802
*                               BUILT.                          Y02669* 01246002
*                                                                     * 01247202
*                          #### IF AREA IS NOT SPECIFIED  ON    Y02669* 01248402
*                               THE COMMAND & THERE IS NO AREA  Y02669* 01249602
*                               IN USE OR THERE IS NO DISPLAY   Y02669* 01250802
*                               IN ANY AREA:                    Y02669* 01251202
*                               FOR D,H AND D,U & E,D AND D,F:  Y02669* 01253202
*                                   IEE158I NO DISP ON SCREEN   Y02669* 01253602
*                               OR IF DISPLAY IS NOT DYNAMIC    Y02669* 01254002
*                                   IEE158I-NO DYNAMIC DISPLAY  Y02669* 01260402
*                                                                     * 01261502
*                              # IF AREA IS IN USE AND DISPLAY  Y02669* 01262602
*                               IS ON SCREEN:                   Y02669* 01263702
*                               FOR E,D AND D,F: IF THERE IS    Y02669* 01264802
*                               MORE THAN ONE ON SCREEN -       Y02669* 01265402
*                                   IEE927I SPECIFY L OPERAND   Y02669* 01266002
*                               IF DYNAMIC DISPLAY - IEE151I    Y02669* 01266602
*                                   USE STOPTR TO DELETE        Y02669* 01267202
*                               IF TOP DISPLAY AREA MOVE AREA   Y02669* 01268102
*                               ID FROM DCM (DCMAID) TO XSA     Y02669* 01269202
*                               (XASDID) AND BUILD PARM LIST.   Y02669* 01270302
*                                                                     * 01271402
         EJECT                                                          01272502
*                             # IF AREA IN USE, WITH DISPLAY IN Y02669* 01273602
*                               AREA                            Y02669* 01274702
*                               FOR D,H AND D,U:                Y02669* 01277502
*                               IF NOT A DYNAMIC DISPLAY        Y02669* 01278802
*                               IEE158I - DISPLAY NOT DYNAMIC   Y02669* 01280102
*                               IF SACB DOESN'T INDICATE THAT   Y02669* 01281402
*                               DISPLAY IN DYNAMIC - IEE927I    Y02669* 01282702
*                               SPECIFY L OPERAND               Y02669* 01284002
*                               IF AREA DEFINED IN SACB MOVE    Y02669* 01284102
*                               AREA ID FROM DCM TO XSA AND     Y02669* 01284202
*                               BUILD THE PARM LIST.            Y02669* 01284302
*                                                                     * 01284402
*                               FOR THE K D,U & STOPTR COMMAND  Y02669* 01284502
*                               THE TRACK PROCESSOR IS POSTED.  Y02669* 01284902
*                               POST IS BRANCH ENTERED THE    @Y02668P* 01285103
*                               LOCKS ARE HELD. LOCAL POST    @Y02668P* 01285803
*                               IF THE COMMAND WAS ISSUED IN  @Y02668P* 01286503
*                               COMTASK'S MEMORY. BRANCH      @ZA03632* 01287203
*                               ENTRY POST IF A MEMORY OTHER  @ZA03632* 01287603
*                               THAN COMTASK ISSUED THE CMD.  @Y02668P* 01288603
*                               (JES3)                        @Y02668P* 01289303
*                                                                     * 01291203
*                               FOR THE STOPTR COMMAND, IF THE  Y02669* 01292303
*                               SCREEN MUST BE CLEARED AND THE  Y02669* 01293403
*                               TARGET AND ISSUING CONSOLE ARE  Y02669* 01295603
*                               THE SAME, A PARM LIST IS BUILT  Y02669* 01297803
*                               IN THE DCM (SEE DATA AREAS FOR  Y02669* 01300003
*                               DESCRIPTION) IN WHICH A STOPTR  Y02669* 01302703
*                               FLAG IS SET, CONTROL IS EITHER  Y02669* 01304703
*                               RETURNED OR DIDOCS IS POSTED    Y02669* 01306703
*                               (SEE EXITS FOR CONDITIONS).     Y02669* 01308603
*                               IF THE TARGET CONSOLE IS NOT    Y02669* 01310503
*                               THE SAME AS THE ISSUING, AN     Y02669* 01314303
*                               AREA MUST BE GOTTEN FOR THE     Y02669* 01316203
*                               PARM LIST FROM SUBPOOL 241      Y02269* 01318103
*                               AND CHAINED TO THE TARGET'S     Y02669* 01320003
*                               RESIDENT DCM. OTHERWISE THE     Y02669* 01322003
*                               PARM LIST IS BUILT IN THE       Y02669* 01324003
*                               TARGET'S TRANSIENT DCM.         Y02669* 01326003
*                               CONTROL IS EITHER RETURNED      Y02669* 01328003
*                               OR DIDOCS IS POSTED.(SEE EXITS) Y02669* 01330003
*                                                                     * 01332003
*   NOTES                                                       Y02669* 01334003
*                                                                     * 01336003
*      CHARACTER CODE                                           Y02669* 01338003
*        DEPENDENCIES   =       ANY CHARACTER CODE OTHER THAN   Y02669* 01340003
*                               EBCDIC WILL REQUIRE REASSEMBLY  Y02669* 01342003
*                               OF THIS MODULE.                 Y02669* 01344003
*                                                                     * 01350002
*      DEPENDENCIES     =       NONE                            Y02669* 01420002
*                                                                     * 01450002
*      RESTRICTIONS     =       ALL TARGET CONSOLES MUST BE     Y02669* 01500002
*                               CRT (GRAPHICS) EXCEPT FOR K C,D Y02669* 01510002
*                               THE L OPERAND IS INVALID ON     Y02669* 01520002
*                               MOST OF THE K COMMANDS.         Y02669* 01530002
*                               (SEE OPERATION)                 Y02669* 01540002
*                                                                     * 01550002
*      REGISTER                                                 Y02669* 01600002
*        CONVENTIONS    =       NONE                            Y02669* 01650002
*                                                                     * 01700002
*      PATCH-LABEL      =       PATCH                           Y02669* 01750002
*                                                                     * 01800002
*   MODULE TYPE         =       CSECT                           Y02669* 01850002
*                                                                     * 01900002
*      PROCESSOR        =       N/A                             Y02669* 01950002
*                                                                     * 02000002
*      MODULE SIZE      =       X'504' + X'48' PATCH AREA       Y02669* 02050002
*                                                                     * 02100002
*      ATTRIBUTES       =       REENTRANT, REFRESHABLE,         Y02669* 02150002
*                               SUPERVISOR MODE, KEY 0,         Y02669* 02210002
*                               PAGED LPA                       Y02669* 02220002
*                                                                     * 02250002
*   ENTRY POINT         =       IEE6703D FROM IEE7503D          Y02669* 02300002
*      PURPOSE          =       TO PROCESS ALL K COMMANDS       Y02669* 02350002
*      LINKAGE          =       BRANCH                          Y02669* 02400002
*      INPUT DATA       =       REG 2 POINTS TO THE XSA         Y02669* 02450002
*                                 XAL-POINTS TO OPERANDS        Y02669* 02460002
*                                 XAN-CONTAINS COMMAND CODE     Y02669* 02470002
*                                 XAS-L=CCA INFORMATION         Y02669* 02480002
*                                 XASSDS5-ON LOCKS HELD         Y02651* 02482002
*                                 XAU-ISSUING UCME INDICATOR    Y02669* 02490002
*                               REG 14 CONTAINS THE RETURN ADDR Y02669* 02500002
*                                                                     * 02550002
*   ENTRY POINT         =       IEE6703D FROM IEE5503D          Y02669* 02600002
*      PURPOSE          =       TO PROCESS THE STOPTR COMMAND   Y02669* 02650002
*      LINKAGE          =       BRANCH                          Y02669* 02700002
*      INPUT DATA       =       REG 2 POINTS TO THE XSA         Y02669* 02750002
*                                 XAL-POINTS TO OPERANDS        Y02669* 02760002
*                                 XAN-COMMAND CODE              Y02669* 02770002
*                                 XAS-L=CCA INFORMATION         Y02669* 02780002
*                             XASSDS3 - ON CMD ISSUED FROM    @Y02668P* 02780603
*                                     ANOTHER MEMORY (JES3)   @Y02668P* 02781203
*                                 XASSDS5-ON LOCKS HELD         Y02651* 02782002
*                                 XAU-ISSUING UCME INDICATOR    Y02669* 02790002
*                               REG 14 CONTAINS THE RETURN ADDR Y02669* 02800002
*                                                                     * 02850002
*      REGISTERS SAVED  =       REGISTERS 11 - 14 BEFORE        Y02651* 02900002
*                               ISSUING SETLOCK AT LOCKSOFF.    Y02651* 02920002
*                                                                     * 02950002
         EJECT                                                          02960002
*      REGISTER CONTENTS                                        Y02669* 03000002
*       DURING PROCESSIMG=      R0  WORK REG                    Y02669* 03050002
*                               R1  WORK REG                    Y02669* 03100002
*                               R2  BASE REG FOR XSA            Y02669* 03150002
*                               R3  WORK REG+TEMP BASE FOR UCM  Y02669* 03200002
*                               R4  WORK REG                    Y02669* 03250002
*                               R5  BASE REG FOR TRANSIENT DCM  Y02669* 03300002
*                               R6  OPERAND POINTER             Y02669* 03350002
*                               R7  WORK REG                    Y02669* 03360002
*                               R8  WORK REG+TEMP BASE FOR RDCM Y02669* 03370002
*                               R9  BASE REG FOR UCM ENTRY+ BAL Y02669* 03372002
*                               R10 BASE REG FOR K PARM LIST    Y02669* 03374002
*                               R11 REG FOR MODULE INDICATOR    Y02669* 03376002
*                               R12 BASE REG FOR SACB           Y02669* 03378002
*                               R13 BASE REG FOR THIS MODULE    Y02669* 03378802
*                               R14 RETURN REG                  Y02669* 03379202
*                               R15 LINK REG                    Y02669* 03379602
*                                                                     * 03380002
*      REGISTERS RESTORED=      REGISTERS 11 - 14 AFTER ISSUING Y02651* 03390002
*                               SETLOCK AT LOCKSOFF.            Y02651* 03391002
*                                                                     * 03392002
*  *  *  *  *  *  *  *  *  *  *  *  *  *  *  *  *  *  *  *  *  *  *  *  03392402
*                                                                     * 03392802
**  EXIT - NORMAL       =       RETURN VIA BR R14 FROM RETURN   Y02669* 03394002
*                               AFTER RELEASING LOCKS           Y02651* 03394402
*      CONDITIONS       =       IMMEDIATE COMMAND PROCESSING IF Y02669* 03396002
*                            1  NO GETMAIN WAS NEEDED FOR THE   Y02669* 03398002
*                               K PARM LIST.                    Y02669* 03399702
*                            2  A GETMAIN WAS NEEDED AND THE    Y02669* 03402402
*                               TARGET DEVICE WAS BUSY.         Y02669* 03404102
*                            3  A GETMAIN WAS NEEDED AND THE    Y02669* 03405802
*                               TARGET DEVICE WAS NOT READY.    Y02669* 03407502
*                            4  UPON RETURN FROM THE POST.      Y02669* 03409202
*      OUTPUT DATA      =       COMMAND PARM LIST IN DCM        Y02669* 03410902
*                               (SEE DATA AREAS)                Y02669* 03411302
*      RETURN CODES     =       NONE                            Y02669* 03412602
*                                                                     * 03414302
*  *  *  *  *  *  *  *  *  *  *  *  *  *  *  *  *  *  *  *  *  *  *  *  03427902
*                                                                     * 03429602
**  EXIT - NORMAL       =       BRANCH TO IEE6803D FROM D6803D  Y02669* 03431302
*      CONDITIONS       =       TO PROCESS K A,NN,NN COMMAND    Y02669* 03433002
*      OUTPUT DATA      =       SAME AS INPUT(LOCKS STILL HELD) Y02669* 03434702
*      RETURN CODES     =       NONE                            Y02669* 03436402
*                                                                     * 03438102
         EJECT                                                          03438502
*  *  *  *  *  *  *  *  *  *  *  *  *  *  *  *  *  *  *  *  *  *  *  *  03440102
*                                                                     * 03440302
**  EXIT - NORMAL       =       BRANCH TO IEE6903D FROM D6903D  Y02669* 03440702
*      CONDITIONS       =       TO PROCESS K A COMMAND          Y02669* 03440802
*                                          K A,REF COMMAND      Y02669* 03441002
*                                          K A,NONE COMMAND     Y02669* 03441402
*                                          ALL K T COMMANDS     Y02669* 03441902
*      OUTPUT DATA      =       SAME AS INPUT(LOCKS STILL HELD) Y02669* 03442002
*      RETURN CODES     =       NONE                            Y02669* 03442202
*                                                                     * 03442402
*  *  *  *  *  *  *  *  *  *  *  *  *  *  *  *  *  *  *  *  *  *  *  *  03442602
*                                                                     * 03442802
**  EXIT - NORMAL       =       BRANCH TO IEE7703D FROM D7703D  Y02669* 03443002
*      CONDITIONS       =       TO PROCESS K V COMMAND          Y02669* 03443202
*      OUTPUT DATA      =       SAME AS INPUT(LOCKS STILL HELD) Y02669* 03444302
*      RETURN CODES     =       NONE                            Y02669* 03446302
*                                                                     * 03446702
*  *  *  *  *  *  *  *  *  *  *  *  *  *  *  *  *  *  *  *  *  *  *  *  03447102
*                                                                     * 03447402
**  EXIT - NORMAL       =       BRANCH TO IEE7803D FROM D7803D  Y02669* 03450302
*      CONDITIONS       =       PROCESS K C,D COMMAND           Y02669* 03453202
*      OUTPUT DATA      =       SAME AS INPUT(LOCKS STILL HELD) Y02669* 03465202
*      RETURN CODES     =       NONE                            Y02669* 03466002
*                                                                     * 03466102
*  *  *  *  *  *  *  *  *  *  *  *  *  *  *  *  *  *  *  *  *  *  *  *  03466202
*                                                                     * 03466402
**  EXIT - NORMAL       =       RETURN VIA BR R14 AFTER POSTING Y02669* 03466502
*                               DIDOCS FROM POST                Y02669* 03469802
*                               AFTER RELEASING LOCKS           Y02651* 03471802
*      CONDITIONS       =    1  IF A GETMAIN WAS NEEDED AND     Y02669* 03473302
*                               THE DEVICE IS WAITING.          Y02669* 03476602
*                            2  IF A GETMAIN WAS NEEDED AND     Y02669* 03477002
*                               THE DEVICE WAS READY.           Y02669* 03477402
*      OUTPUT DATA      =       COMMAND PARM LIST IN GETMAINED  Y02669* 03477702
*                               AREA AND CHAINED TO DCM AND     Y02669* 03487702
*                               FLAG SET IN DCM INDICATING      Y02669* 03488102
*                               VALID K COMMAND                 Y02669* 03488502
*                                 DCMSVC34 - DCMMYCMD (X'80')   Y02669* 03489502
*      RETURN CODES     =       NONE                            Y02669* 03490702
*                                                                     * 03491502
         EJECT                                                          03491602
*  *  *  *  *  *  *  *  *  *  *  *  *  *  *  *  *  *  *  *  *  *  *  *  03516002
*                                                                     * 03517402
**  EXIT - ERROR        =       BRANCH TO IEE5603D FROM D5603D  Y02669* 03518802
*      CONDITIONS       =       TO PROCESS ERROR MESSAGES       Y02669* 03520202
*      OUTPUT DATA      =       ERROR CODES FOR MESSAGES ISSUED Y02669* 03521602
*                               IN IEE5603D AND IEE5903D.       Y02669* 03523002
*      RETURN CODES     =       XAE WILL CONTAIN AN INDEX FOR   Y02669* 03524402
*                               THE MAJOR MESSAGE FOR IEE5603D: Y02669* 03525802
*                                  X'03' - IEE151I DELETE       Y02669* 03527202
*                                          REQUEST INCONSISTENT Y02669* 03528602
*                                  X'04' - IEE156I INVALID      Y02669* 03530002
*                                          OPERAND              Y02669* 03531402
*                                  X'05' - IEE158I K REQUEST    Y02669* 03532802
*                                          INCONSISTENT         Y02669* 03534202
*                                  X'09' - IEE921I REJECTED   @Y02668P* 03534403
*                                  X'0B' - IEE925I OPERAND      Y02669* 03534602
*                                  X'0C' - IEE926I L=CCA        Y02669* 03535602
*                                          OPERAND INVALID      Y02669* 03537002
*                                  X'0D' - IEE927I - K REQUEST  Y02669* 03538402
*                                          AMBIGUOUS            Y02669* 03539802
*                                  X'0E' - IEE930I-INSUFFICIENT Y02669* 03540202
*                                          STORAGE FOR COMMAND  Y02669* 03540602
*                               XASTSAVE WILL CONTAIN AN INDEX  Y02669* 03541202
*                               FOR THE MINOR MESSAGE FOR       Y02669* 03542602
*                               IEE5903D:                       Y02669* 03544002
*                                 IEE151I:                              03544402
*                                  X'04' - USE STOPTR TO DELETE Y02669* 03545402
*                                  X'06' - NO DISPLAY ON SCREEN Y02669* 03546802
*                                  X'07' - NO DISPLAY IN AREA   Y02669* 03548202
*                                 IEE158I:                              03548602
*                                  X'06' - NO DISPLAY ON SCREEN Y02669* 03549002
*                                  X'07' - NO DISPLAY IN AREA   Y02669* 03549402
*                                  X'08' - LAST FRAME DISPLAYED Y02669* 03549602
*                                  X'09' - FRAME NOT COMPLETE   Y02669* 03551002
*                                  X'0A' - DISPLAY IS NOT       Y02669* 03552402
*                                          DYNAMIC              Y02669* 03553802
*                                 IEE921I:                    @Y02668P* 03553903
*                                  X'19' - NEEDS DISPLAY AREA @Y02668P* 03555603
*                                 IEE925I:                              03558003
*                                  X'1A' - FOR CRT ONLY         Y02669* 03559403
*                                 IEE926I:                              03560403
*                                  X'18' - ON THIS COMMAND      Y02669* 03562203
*                                 IEE927I:                              03563603
*                                  X'17' - SPECIFY L OPERAND    Y02669* 03565003
*                               XASSDS5 - ON LOCKS HELD         Y02651* 03566403
*                                                                     * 03567803
*  *  *  *  *  *  *  *  *  *  *  *  *  *  *  *  *  *  *  *  *  *  *  *  03569203
*                                                                     * 03570403
*   EXTERNAL                                                    Y02669* 03572003
*    REFERENCES                                                 Y02669* 03573403
*                                                                     * 03576202
*      ROUTINES         =       POSTS DIDOCS UCMECB             Y02669* 03577603
*                                     POSTCODE X'FE'            Y02669* 03578603
*                               POSTS TRACK DCMATECB            Y02669* 03579603
*                                     POSTCODE X'04'            Y02669* 03580603
*                               POSTS TRACK DCMATECB            Y02669* 03581603
*                                     POSTCODE X'08'            Y02669* 03582603
*                               BRANCHES TO  IEE7703D           Y02669* 03583603
*                                            IEE7803D           Y02669* 03584603
*                                            IEE6803D           Y02669* 03585603
*                                            IEE6903D           Y02669* 03586603
*                                            IEE5603D/IEE5903D  Y02669* 03587603
*                                                                     * 03588603
*      DATA AREAS       =       NONE                            Y02669* 03589603
*                                                                     * 03597202
*      CONTROL BLOCKS   =       CVT      R -  ADDRESS UCM       Y02669* 03598602
*                               IEEXSA   R -  INPUT INFORMATION Y02669* 03600002
*                                        W -  GETMAIN WORK AREA Y02669* 03600802
*                               IEECUCM  R -  ADDRESS DCM       Y02669* 03602402
*                                        W -  UPDATE            Y02669* 03604002
*                               IEERDCM  R -  COMPARE           Y02669* 03605602
*                                        W -  UPDATE            Y02669* 03607202
*                               IEECVMAP C -  SUBPOOL 230       Y02669* 03608802
*                               (KPARAM) W -  BUILD PARM LIST   Y02669* 03610402
*                                        R -  KPARAM CHAIN ADDR Y02669* 03612002
*                               IEETDCM  W -  FLAG, CHAIN KPARAMY02669* 03613602
*                               IHAPSA   - NECESSARY FOR SETLOCKY02651* 03614002
*                                                                     * 03615202
*    TABLES      = A COMPARE TABLE IS USED TO  DETERMINE THE    Y02669* 03618402
*                  VALIDITY OF THE OPERANDS ON THE CONTROL      Y02669* 03620002
*                  COMMANDS.                                    Y02669* 03620102
*                  THE FORMAT OF EACH ENTRY IS THE SAME.        Y02669* 03621602
*                                                                     * 03623202
*                  DLEN   DC   AL1(L'XXX-1) - LENGTH OF         Y02669* 03624802
*                                             SPECIFIC OPERAND  Y02669* 03626402
*                  XXX    DC   C'YYYYY' - CHARACTER OPERAND     Y02669* 03628002
*                                         REPRESENTATION        Y02669* 03629602
*                                                                     * 03631202
*                  DLEN AND 'XXX' ARE USED IN AN EX OF A CLC.   Y02669* 03632802
*                  IF THE OPERANDS MATCH, A BRANCH IS TAKEN TO  Y02669* 03634402
*                  EITHER PROCESS THE COMMAND OR IN TURN        Y02669* 03636002
*                  BRANCH TO THE PROPER PROCESSOR.              Y02669* 03637602
*                  OTHERWISE, THE REGISTER USED TO ADDRESS THE  Y02669* 03639202
*                  TABLE IS INCREMENTED BY TWO + THE VALUE OF   Y02669* 03640802
*                  DLEN TO REACH THE NEXT TABLE ENTRY.          Y02669* 03642402
*                                                                     * 03644002
*                  A BRANCH TABLE IS USED IN CONNECTION WITH    Y02669* 03645602
*                  THE COMPARE TABLE. IT CONSISTS OF BRANCHES   Y02669* 03647202
*                  TO THE PROPER OPERAND PROCESSORS. AN INDEX   Y02669* 03648802
*                  REGISTER IS MAINTAINED THROUGHOUT THE SCAN   Y02669* 03650402
*                  OF THE COMPARE TABLE. THIS IS USED AT        Y02669* 03652002
*                  DBRANCH TO GIVE CONTROL TO THE INDICATED     Y02669* 03653602
*                  PROCESSOR VIA THE BRANCH TABLE.              Y02669* 03655202
*                                                                     * 03656802
*      MACROS           =       MODID                           Y02669* 03658402
*                               CONDITIONAL BRANCH ENTRY        Y02651* 03660002
*                                 GETMAIN SP241 FOR KPARAM      Y02651* 03661602
*                               BRANCH ENTRY POST - DIDOCS    @ZA03632* 03662603
*                                 UCMECB - POSTCODE (X'FE')     Y02669* 03664802
*                               BRANCH ENTRY POST - IEECB800    Y02651* 03665002
*                                 DCMATECB - PTCODE (X'04')     Y02651* 03665202
*                                 (FOR STOPTR A COMMAND)        Y02651* 03675202
*                                 DCMATECB - KDUCODE (X'08')    Y02651* 03677202
*                                 (FOR K D,U COMMAND)           Y02651* 03679202
*                               SETLOCK - CMS & LOCAL RELEASED  Y02651* 03681202
*                                                                     * 03684702
*      ENQUEUED                                                 Y02669* 03685102
*       RESOURCES       =       NONE                            Y02669* 03690702
*                                                                     * 03699202
*      CHANGE LEVEL     =       Y02669                          Y02669* 03702202
*                               Y02651                          Y02651* 03706402
*                               YM1913                          YM1913* 03709402
*                               YM7666                        @YM7666P* 03713602
*                               Y02668                        @Y02668P* 03714603
*                               ZA01568                       @ZA01568* 03715603
*                               ZA02576                       @ZA02576* 03716103
*                               ZA03632                       @ZA03632* 03716303
*                               ZA09164                       @ZA09164* 03716403
*      LOCKS HELD       =       CMS AND LOCAL LOCKS WERE        Y02651* 03716602
*                               OBTAINED IN IEE7503D FOR BOTH   Y02651* 03720802
*                               STOPTR AND CONTROL COMMANDS.    Y02651* 03728002
*                               THEY MUST BE RELEASED BEFORE    Y02651* 03731002
*                               RETURNING AT RETURN,          @ZA03632* 03735203
*                               OR BRANCHING                  @ZA03632* 03739203
*                               TO IEE0503D, AT D0503D          Y02651* 03749602
*                               OTHERWISE THEY ARE RELEASED IN  Y02651* 03752602
*                               IEE5603D, IEE5903D, IEE6803D,   Y02651* 03756802
*                               IEE6903D, IEE7703D, OR IEE7803D.Y02651* 03764002
*                                                                     * 03767002
*      MESSAGES         =       THE FOLLOWING MESSAGES ARE      Y02669* 03771202
*                               CONTAINED IN AND ISSUED FROM    Y02669* 03774202
*                               IEE5603D AND IEE5903D:          Y02669* 03778402
*                                                                     * 03779102
*                                MSGID  CODE  IN MESSAGE TEXT   Y02669* 03779802
*                                _____  ____  __ ____________   Y02669* 03780502
*                               IEE151I X'03' 56 DELETE REQUEST Y02669* 03781202
*                                                  INCONSISTENT Y02669* 03781902
*                                       X'04' 59 USE STOPTR TO  Y02669* 03782602
*                                                  DELETE       Y02669* 03783302
*                                       X'06' 59 NO DISPLAY ON  Y02669* 03784002
*                                                  SCREEN       Y02669* 03784702
*                                       X'07' 59 NO DISPLAY IN  Y02669* 03785602
*                                                  AREA         Y02669* 03786602
*                               IEE156I X'04' 56 INVALID OPERND Y02669* 03787602
*                               IEE158I X'05' 56 K REQUEST      Y02669* 03788602
*                                                  INCONSISTENT Y02669* 03789602
*                                       X'06' 59 NO DISPLAY ON  Y02669* 03790602
*                                                  SCREEN       Y02669* 03791602
*                                       X'07' 59 NO DISPLAY IN  Y02669* 03792802
*                                                  AREA         Y02669* 03795802
*                                       X'08' 59 LAST FRAME     Y02669* 03800002
*                                                  DISPLAYED    Y02669* 03801002
*                                       X'09' 59 FRAME NOT      Y02669* 03802002
*                                                  COMPLETE     Y02669* 03803002
*                                       X'0A' 59 DISPLAY IS NOT Y02669* 03804002
*                                                  DYNAMIC      Y02669* 03805002
*                               IEE921I X'09' 56 REJECTED     @Y02668P* 03805203
*                                             59 NEEDS        @Y02668P* 03805403
*                                                DISPLAY AREA @Y02668P* 03805603
*                               IEE925I X'0B' 56 OPERAND        Y02669* 03806002
*                                       X'1A' 59 FOR CRT ONLY   Y02669* 03807002
*                               IEE926I X'0C' 56 L=CCA OPERAND  Y02669* 03808002
*                                                  INVALID      Y02669* 03809002
*                                       X'1A' 59 ON THIS CMND   Y02669* 03810002
*                               IEE927I X'0D' 56 K REQUEST      Y02669* 03811002
*                                                  AMBIGUOUS    Y02669* 03812002
*                                       X'17' 59 SPECIFY L      Y02669* 03813002
*                                                  OPERAND      Y02669* 03814002
*                               IEE930I X'0E' 56 INSUFFICIENT   Y02669* 03815002
*                                                  STORAGE FOR  Y02669* 03816002
*                                                  COMMAND      Y02669* 03817002
*                                                                     * 03818002
*                              THE FOLLOWING MESSAGE IS IN    @Y02668P* 03818203
*                              IEE0503D                       @Y02668P* 03818403
*                                                             @Y02668P* 03818603
*                               MSGID CODE TEXT               @Y02668P* 03819003
*                              IEE777I X'15' INVALID FROM     @Y02668P* 03823003
*                                             SUBSYSTEM       @Y02668P* 03824003
*                                             CONSOLE         @Y02668P* 03825003
*      SYSGEN           =       INCLUDE WITH SVC 34 IN LOAD     Y02669* 03828003
*                               MODULE IGC0003D, DLIB AOSB3,    Y02669* 03831003
*                               MACRO SGIEF441, TARGLIB LPALIB  Y02669* 03834003
*                                                                     * 03837003
*      SYSTEM LIBRARIES =       NONE                            Y02669* 03840003
*                                                                     * 03843003
*********************************************************************** 03846003
         EJECT                                                          03850002
IEE6703D CSECT                                                          03857002
* A- 643196 C- 602500                                         @ZA01568* 03860003
* C-344700,344800                                             @ZA02576* 03862003
* POST (C)                                                    @ZA03632* 03862603
* SACBSCAN (C), PROCESS (D)                                   @ZA09164* 03863203
*********************************************************************** 03864002
*                                                                     * 03871002
*                         REGISTER EQUATES                            * 03878002
*                                                                     * 03885002
*********************************************************************** 03892002
REG0     EQU   0                   WORK REG                             03900001
REG1     EQU   1                   WORK REG                             04000001
XSAREG   EQU   2                   BASE REG FOR XSA                     04100001
REG3     EQU   3                   WORK REG & TEMP BASE FOR UCM  Y02669 04250002
REG4     EQU   4                   WORK REG                             04260002
TDCMREG  EQU   5                   BASE REG FOR TRANSIENT DCM           04400001
REG6     EQU   6                   REGISTER CONTAINING OPERAND POINTER  04500001
REG7     EQU   7                   WORK REG                             04700001
REG8     EQU   8                   BASE FOR RESIDENT DCM & WORK REG     04800002
REG9     EQU   9                   UCME BASE & BAL REG           Y02651 04910002
KREG     EQU   10                  BASE REG FOR K PARAMETER LIST Y02651 04950002
MODREG   EQU   11                  REG FOR MODULE INDICATOR             05100001
SACBREG  EQU   12                  BASE REG FOR SACB                    05200001
BASEREG  EQU   13                  BASE REG FOR THIS MODULE             05300002
REG14    EQU   14                  RETURN REG                           05400001
R15      EQU   15                  LINK REG                             05500001
         EJECT                                                          05600001
*********************************************************************** 05650002
*                                                                     * 05700001
*                          NUMBER CONSTANTS                           * 05800002
*                                                                     * 05900001
*********************************************************************** 05950002
ZERO     EQU   0                   NUMBER CONSTANT                      06100001
ONE      EQU   1                   NUMBER CONSTANT                      06300001
N2       EQU   2                   NUMBER CONSTANT                      06400001
N3       EQU   3                   NUMBER CONSTANT               Y02669 06450002
N4       EQU   4                   NUMBER CONSTANT                      06800001
N5       EQU   5                   NUMBER CONSTANT             @YM7666P 06801002
N7       EQU   7                   NUMBER CONSTANT                      06802002
N8       EQU   8                   NUMBER CONSTANT             @YM7666P 07602002
*********************************************************************** 08450002
*                                                                     * 08500002
*                        CHARACTER CONSTANTS                          * 08550002
*                                                                     * 08560002
*********************************************************************** 08570002
DCHAR    EQU   C'D'                DISPLAY CONSTANT                     08600001
ECHAR    EQU   C'E'                ERASE CONSTANT                       08650002
HCHAR    EQU   C'H'                HOLD CONSTANT                        08900001
UCHAR    EQU   C'U'                UPDATE CONSTANT                      08950002
*********************************************************************** 09450002
*                                                                     * 09460002
*                     SPECIAL CODES AND MASKS                         * 09470002
*                                                                     * 09480002
*********************************************************************** 09490002
PT       EQU   X'C8'               STOPTR CODE                   Y02669 09500002
POSTCODE EQU   X'FE'               CODE USED IN POSTING UCM ECB         09800001
PTCODE   EQU   X'04'               CODE FOR POSTING TRACK ECB    Y02651 09850002
KDUCODE  EQU   X'08'               CODE FOR POSTING TRACK ECB    Y02651 09860002
WAITCODE EQU   X'80'               ECB WAIT CODE                        09900001
REDYCODE EQU   X'00'               ECB READY CODE                       10000001
XFF      EQU   X'FF'               MASK FOR TURNING OFF FLAGS    Y02669 10200002
M7       EQU   7                   MASK FOR ADDRESS FOR ICM      Y02669 10250002
M8       EQU   8                   MASK FOR ICM XMPOST         @Y02668P 10270003
SP241    EQU   241                 SUBP NUMBER FOR KPARM GETMAIN Y02669 10300002
         EJECT                                                          10300402
*********************************************************************** 10302002
*                                                                     * 10304002
*                      ERROR CODES                                    * 10306002
*                                                                     * 10308002
*********************************************************************** 10308402
MSG151   EQU   3                   IEE151I DELETE INCONSISTENT   Y02669 10310002
MSG151A  EQU   4                           USE STOP TRACK        Y02669 10320002
MSG156   EQU   4                   IEE156I INVALID OPERAND       Y02669 10330002
MSG158   EQU   5                   IEE158I K REQUEST INCONSIST   Y02669 10340002
MSG158A  EQU   8                           LAST FRAME DISPLAY    Y02669 10342002
MSG158B  EQU   9                           FRAME NOT COMPLETE    Y02669 10344002
MSG158C  EQU   10                          DISPLAY NOT DYNAMIC   Y02669 10346002
MSG1581A EQU   6                           NO DISPLAY ON SCREEN  Y02669 10348002
MSG1581B EQU   7                           NO DISPLAY IN AREA    Y02669 10348402
MSG921   EQU   9                   IEE921I REJECTED            @Y02668P 10348503
MSG921A  EQU   19                           NEEDS DISPLAY AREA @Y02668P 10348603
MSG925   EQU   11                  IEE925I OPERAND               Y02669 10358603
MSG925A  EQU   26                          FOR CRT ONLY          Y02669 10370802
MSG926   EQU   12                  IEE926I L OPERAND INVALID     Y02669 10378102
MSG926A  EQU   24                          ON THIS COMMAND       Y02669 10385402
MSG927   EQU   13                  IEE927I K REQUEST AMBIGUOUS   Y02669 10392702
MSG927A  EQU   23                          SPECIFY L OPERAND     Y02669 10400002
MSG930   EQU   14                  IEE930I INSUFFICIENT          Y02669 10500002
*                                          STORAGE FOR COMMAND   Y02669 10600002
MSG777   EQU   X'15'               IEE777I INVALID FROM        @Y02668P 10630003
*                                          SUBSYSTEM CONSOLE  @Y02668P* 10660003
         EJECT                                                          10700001
         BALR  BASEREG,ZERO        SET UP ADDRESSIBILITY                11100001
         USING *,BASEREG           FOR PROGRAM                          11200001
         MODID BRANCH=YES                                        Y01886 11250001
*********************************************************************** 11350002
*           INITIALIZATION REGISTER USAGE                        Y02669 11600002
*           2  -  XSA BASE REG                                   Y02669 11610002
*           3  -  UCM BASE - THEN WORK REG                       Y02669 11612002
*           5  -  TDCM BASE REG                                  Y02669 11620002
*           6  -  ADDRESS OF K COMMAND OPERANDS                  Y02669 11630002
*           7  -  WORK REG                                       Y02669 11640002
*           8  -  WORK REG - THEN RESIDENT DCM BASE REG          Y02669 11642002
*           9  -  UCME BASE REG                                  Y02669 11642402
*          11  -  MODREG                                         Y02669 11646002
*          13  -  MODULE BASE REG                                Y02669 11648002
*********************************************************************** 11650002
         USING DXSA,XSAREG         EXTENDED SAVEAREA ADDRESSIBILITY     11660002
         L     REG3,CVTPTR         GET CVT POINTER               Y02669 11700002
         USING DCVT,REG3           ADDRESSIBILITY OF CVT         Y02669 11800002
         L     REG3,CVTCUCB        GET UCM POINTER               Y02669 11900002
         DROP  REG3                                              Y02669 12000002
         SPACE   3                                                      12010002
*********************************************************************** 12050002
*       GET UCM ENTRY ADDRESS                                    Y02669 12052002
*********************************************************************** 12060002
         USING UCM,REG3            ADDRESSABILITY OF UCM         Y02669 12100002
         L     REG7,UCMVEA         GET POINTER TO FIRST UCME            12200002
         SR    REG9,REG9           CLEAR WORK REGISTER           Y02669 12300002
         IC    REG9,XASCID         GET TARGET CONSOLE ID         Y02669 12400002
         BCTR  REG9,ZERO           DECREMENT BY ONE              Y02669 12500002
         M     REG8,UCMVEZ         MULT ID BY SIZE                      12600001
         AR    REG9,REG7           SET PTR TO UCM ENTRY          Y02669 12700002
         DROP  REG3                                              Y02669 12750002
         USING UCMLIST,REG9        ADDRESSIBILITY OF UCM ENTRY   Y02669 12800002
         TM    UCMDISP,UCMDISPC    IS TARGET A GRAPHICS?         Y02669 12802002
         BO    GRAPHICS            YES, CONTINUE                 Y02669 12804002
         SR    REG6,REG6           CLEAR REGISTER                Y02669 12804402
         ICM   REG6,M7,XAL+1       GET 3 BYTE ADDR OF OPERANDS   Y02669 12804802
         CLC   ZERO(N3,REG6),CDCHAR IS COMMAND K C,D?            Y02669 12806802
         BE    D7803D              YES, IEE7803D WILL HANDLE     Y02669 12808002
         B     ERR925A             NO, TARGET MUST BE CRT        Y02669 12808402
         EJECT                                                          12810002
*********************************************************************** 13460002
*       ADDRESS RESIDENT AND TRANSIENT DCM FOR TARGET CONSOLE    Y02669 13472002
*       WILL ALWAYS BE CRT DEVICE.                               Y02669 13474002
*********************************************************************** 13480002
GRAPHICS EQU   *                                                        13530002
         L     REG8,UCMXB          GET ADDRESS OF RESIDENT DCM   Y02669 13600002
         USING DCMTSRT,REG8        ADDRESSIBILITY FOR DCM        Y02669 13700002
         L     TDCMREG,DCMADTRN    GET ADDRESS OF TRAN DCM       Y02669 13750002
         USING DCMSTRT,TDCMREG     ADDRESSIBILITY OF TRANS DCM   Y01012 13760002
         SR    REG6,REG6           CLEAR REGISTER                Y02669 13760402
         ICM   REG6,M7,XAL+1       GET 3 BYTE ADDR OF OPERANDS   Y02669 13760802
         BZ    KALONE              IF BLANK TREAT AS K E         Y02669 13761202
         SPACE   3                                                      13762002
*********************************************************************** 14056202
*       THIS IS A STOPTR COMMAND?                                Y02669 14058802
*  STOPTR OPERANDS WERE VALIDITY CHECKED IN IEE5503D             Y02669 14060802
*********************************************************************** 14061402
         L     MODREG,DCMNINT5     SET CODE FOR SDS INTERFACE 5  Y02669 14063402
         CLI   XAN,PT              IS THIS STOPTR?               Y02669 14064002
         BE    TESTOWN             YES                           Y02669 14066002
        EJECT                                                           14068002
*********************************************************************** 14071802
*       LOOP THROUGH BRANCH TABLE SEARCHING FOR OPERANDS         Y02669 14074402
*          REGISTERS USED FOR LOOP - 1, 3, 7, 15                 Y02669 14077002
*********************************************************************** 14079602
         SPACE  2                                                       14092002
         SR    REG3,REG3           CLEAR REG FOR OP LENGTH       Y02669 14094002
         SR    R15,R15             USED TO INDEX BRANCH TABLE    Y02669 14096002
         LA    REG7,DENTAB         CALCULATE TABLE END ADDRESS   Y02669 14098402
         LA    REG1,DTAB           CALCULATE TABLE BEGIN ADDRESS Y02669 14098802
         USING DTAB,REG1           EST. ADDRESSABILITY TO TABLE  Y02669 14099202
DLOOP    EQU   *                                                        14099302
         IC    REG3,DLEN           LENGTH OF COMPARE TAB ENTRY-1 Y02669 14099602
         EX    REG3,DCOMPARE       CHECK FOR MATCH               Y02669 14099702
         BE    BRTABLE(R15)        IF MATCH,PROCESS ACCORDINGLY  Y02669 14099802
         LA    REG1,N2(REG3,REG1)  NO MATCH, GO TO NEXT ENTRY    Y02669 14099902
         LA    R15,N4(R15)         INCRE INDEX FOR BRANCH TABLE  Y02669 14133202
         CR    REG1,REG7           END OF COMPARE TABLE REACHED  Y02669 14183202
         BL    DLOOP               NO, GO BACK AND CHECK NEXT    Y02669 14193202
*                                  TABLE ENTRY                   Y02669 14195202
         DROP  REG1                NECESSARY TO RE-EST BASE REG         14195602
         B     ERR156              YES, INVALID OPERAND - ERROR  Y02669 14197202
         EJECT                                                          15000001
*********************************************************************** 23950002
*         K   E,                                                 Y02669 23960002
*********************************************************************** 24000002
SEDEL1   EQU   *                                                 Y02669 24050002
         L     MODREG,DCMNDEL1     SET CODE FOR DELETE 1 ROUTINE Y02669 31900002
         B     TESTL               BRANCH TO CHECK FOR L OPERAND Y02669 31950002
         SPACE 3                                                        32000001
*********************************************************************** 32050002
*         K   E,N                                                Y02669 32100002
*********************************************************************** 33100002
SECMD    EQU   *                                                 Y02669 33150002
         L     MODREG,DCMNCMD1     SET CODE FOR COMMAND ROUTINE  Y02669 33200002
         B     TESTL               BRANCH TO CHECK FOR L OPERAND Y02669 33300002
         SPACE 3                                                        33400001
*********************************************************************** 33410002
*         K   S                                                  Y02669 33412002
*********************************************************************** 33420002
SPECOPT  EQU   *                                                 Y02669 33430002
         L     MODREG,DCMNOPT1     SET CODE FOR OPTIONS ROUTINE  Y02669 33450002
         B     TESTL               BRANCH TO CHECK FOR L OPERAND Y02669 33500002
         SPACE 3                                                        33550002
*********************************************************************** 33700002
*         K   D                                                  Y02669 33710002
*         K   D,N                                                Y02669 33720002
*         K   D,N,HOLD                                           Y02669 33730002
*********************************************************************** 33750002
SEDEL4   EQU   *                                                 Y02669 33760002
         L     MODREG,DCMNDEL4     SET CODE FOR DELETE 4 ROUTINE Y02669 33800002
         B     TESTL               BRANCH TO TEST FOR L OPERAND         33900001
         SPACE 3                                                        34000001
*********************************************************************** 34200002
*         K   E,PFK                                              Y02669 34210002
*         K   D,PFK                                              Y02669 34220002
*         K   N                                                  Y02669 34230002
*********************************************************************** 34250002
SEPFK    EQU   *                                                 Y02669 34260002
         L     MODREG,DCMNPFK2     SET CODE FOR PFK 2 ROUTINE    Y02669 34300002
         B     TESTL               BRANCH TO TEST FOR L OPERAND         34400002
         EJECT                                                          34410002
*********************************************************************** 34420002
*         K          (DEFAULT)                                   Y02669 34420402
*         K   E                                                  Y02669 34422002
*         K   E,SEG                                              Y02669 34424002
*********************************************************************** 34430002
KALONE   EQU   *                                                 Y02669 34440002
         L     MODREG,DCMNDEL3     GET FOR DELETE 3              Y02669 34450002
         SPACE   3                                                      34460002
*********************************************************************** 34460402
*  THE L OPERAND IS INVALID ON ALL OF THE ABOVE COMMANDS         Y02669 34460802
*********************************************************************** 34461202
TESTL    EQU   *                                                 Y02669 34462002
         TM    XASSDS,XASSDS3     CMD INVALID FROM ASSOC       @Y02668P 34464003
         BO    DERR777            CNSL BRANCH ERROR MSG        @Y02668P 34466003
         TM    XASSDS,XASSDS2+XASSDS4 WAS L OPERAND SPECIFIED? @ZA02576 34470003
         BM    ERR926              YES, BRANCH FOR  MSG EXIT   @ZA02576 34480003
         OI    DCMSVC34,DCMTYPE1   K COMMAND NOT ROUTABLE               34490002
         B     SETDCM              BRANCH TO SET DCM FLAG AND EXIT      34492002
         SPACE 3                                                        34542002
*********************************************************************** 34544002
*         K   V                                                  Y02669 34546002
*********************************************************************** 34550002
D7703D   EQU   *                                                 Y02669 34552002
         TM    XASSDS,XASSDS3      IF JES3 ISSUED K V          @Y02668P 34554003
         BO    DERR777             BRANCH INVALID FROM         @Y02668P 34556003
*                                  SUBSYSTEM CONSOLE          @Y02668P* 34558003
         L     R15,VCON7703        BRANCH TO HANDLE THE K  V CMD Y02669 34562002
         BR    R15                 BRANCH TO IEE7703D            Y02669 34572002
         SPACE 3                                                        34574002
*********************************************************************** 34574402
*         K   T                                                  Y02669 34574802
*         K   A                                                  Y02669 34578502
*         K   A,REF                                              Y02669 34582802
*         K   A,NONE                                             Y02669 34586502
*********************************************************************** 34590202
D6903D   EQU   *                                                 Y02669 34593902
         L     R15,VCON6903        BRANCH TO HANDLE THE K T & A  Y02669 34597602
         BR    R15                 BRANCH TO IEE6903D            Y20669 34601302
         SPACE 3                                                        34605002
*********************************************************************** 34608702
*         K   A,NN,NN                                            Y02669 34612402
*********************************************************************** 34619802
D6803D   EQU   *                                                 Y02669 34623502
         L     R15,VCON6803        BRANCH TO HANDLE K A,NN,NN    Y02669 34627202
         BR    R15                 BRANCH TO IEE6803D            Y02669 34630902
         EJECT                                                          34632902
*********************************************************************** 34633302
*         K   C,D                                                Y02669 34633702
*********************************************************************** 34634102
D7803D   EQU   *                                                 Y02669 34634502
         L     R15,VCON7803        BRANCH TO HANDLE K C,D,ID     Y02669 34647602
         BR    R15                 BRANCH TO IEE7803D            Y02669 34657602
         SPACE 3                                                        34673802
*********************************************************************** 34686902
*         K   E,D                                                Y02669 34700002
*********************************************************************** 34742002
SETFLG   EQU   *                                                 Y02669 34752002
         L     MODREG,DCMNINT5     SET CODE FOR SDS INTERFACE 5  Y02669 34802002
         B     PROCESS             BRANCH TO PROCESS OPERAND     Y02669 34852002
         SPACE 3                                                        34892002
*********************************************************************** 34942002
*         K   D,F                                                Y02669 34992002
*********************************************************************** 35042002
SETFLGMD EQU   *                                                 Y02669 35052002
         L     MODREG,DCMNINT3     SET CODE FOR SDS INTERFACE 3  Y02669 35062002
         B     PROCESS             BRANCH TO PROCESS OPERAND     Y02669 35102002
         SPACE  3                                                       36600002
*********************************************************************** 36610002
*          K   D,H                                               Y02669 36620002
*          K   D,U                                               Y02669 36630002
*********************************************************************** 36640002
MODSET   EQU   *                                                 Y02669 36640402
         L     MODREG,DCMNINT3     SET CODE FOR SDS INTERFACE 3  Y02669 36642002
         EJECT                                                          36644002
*********************************************************************** 36650002
*                                                                     * 36700001
*           COMMON SUBROUTINE FOR K D,H OR K D,U PROCESSING           * 36800002
*                                                                     * 36910002
*********************************************************************** 36950002
         SPACE   2                                                      37200002
         L     SACBREG,DCMADSDS    GET SACBPTR                 @Y02668P 37500003
         LTR   SACBREG,SACBREG     IF ZERO                     @Y02668P 37510003
         BZ    ERR921              NO AREA EXISTS              @Y02668P 37520003
         USING DCMACB,SACBREG      SET BASE FOR SACB             Y02669 37550002
         CLI   XASDID,ZERO         WAS AREA SPECIFIED ON COMMAND?Y02669 37600002
         BNE   AREA                YES, BRANCH                   Y02669 37650002
SACBTEST EQU   *                                                 Y02669 37750002
         TM    DCMASACB,DCMAUSE    IS AREA IN USE?               Y02669 37800002
         BZ    NOINUSE             NO, BRANCH                    Y02669 37850002
         TM    DCMAFLG1,DCMADISP   IS DISPLAY IN AREA?           Y02669 37900002
         BZ    NXTSACB             NO, TEST OTHER SACB'S         Y02669 37950002
         OI    XASPLS3,ONE         SET DISP ON SCREEN SWITCH RE- Y02669 38000002
*                                  SERVED BIT SET TO 0 IN 7503D  Y02669 38020002
         TM    DCMADFLG,DCMADD     IS IT A DYNAMIC DISPLAY?      Y02669 38050002
         BO    TESTCMD             YES, WHICH COMMAND IS THIS    Y02669 38100002
NXTSACB  EQU   *                                                 Y02669 38150002
         ICM   SACBREG,N7,DCMACBNX+1 GET NEXT SACB POINTER       Y02669 38200002
         BZ    NOINUSE             THERE ARE NO MORE             Y02669 38250002
         B     SACBTEST            CONTINUE SEARCH               Y02669 38300002
         SPACE 2                                                        38310002
NOINUSE  EQU   *                                                 Y02669 38400002
         TM    XASPLS3,ONE         IS DISPLAY ON SCREEN FLAG ON? Y02669 38450002
         BO    DYDISP              YES IEE158 DISP NOT DYNAMIC   Y02669 38500002
         B     NODISPS             NO IEE158 NO DISP ON SCREEN   Y02669 38550002
         EJECT                                                          38560002
AREA     EQU   *                                                 Y02669 38600002
         CLC   DCMAID(ONE),XASDID  COMPARE SACB WITH SPECIFIED A Y02669 38650002
         BE    TFLG                MATCH? YES,                   Y02669 38700002
         ICM   SACBREG,N7,DCMACBNX+1 NO, GET NEXT SACB           Y02669 38750002
         BNZ   AREA                ANYMORE? YES,CONTINUE SEARCH  Y02669 38800002
         B     NODISPA             NO, IEE151 NO DISPLAY IN AREA Y02669 38850002
         SPACE 2                                                        38900002
TFLG     EQU   *                                                 Y02669 39250002
         TM    DCMAFLG1,DCMADISP   IS THERE A DISPLAY IN AREA?   Y02669 39300002
         BZ    NODISPA             ERR IEE158 NO DISP IN AREA    Y02669 39350002
         TM    DCMADFLG,DCMADD     IS DYNAMIC DISPLAY IN AREA?   Y02669 39400002
         BO    TESTUD              YES, WHICH COMMAND IS THIS    Y02669 39450002
         B     DYDISP              ERR IEE158 DISP NOT DYNAMIC   Y02669 39500002
         SPACE 2                                                        39550002
TESTCMD  EQU   *                                                 Y02669 39560002
         MVC   XASDID,DCMAID       PUT AREA ID IN XAS            Y02669 39570002
TESTUD   EQU   *                                                 Y02669 39600002
         CLI   N2(REG6),UCHAR      IS THIS AN UPDATE COMMAND?    Y02669 39650002
         BNE   SETHOLD             NO, BRANCH TO PROCESS D,H     Y02669 39700002
*********************************************************************** 39820002
*     D,U                                                        Y02669 39830002
*********************************************************************** 39840002
UPDATE   EQU   *                                                 Y02669 39842002
         NI    DCMADFLG,XFF-DCMAHOLD TURN OFF HOLD FLAG IN DCM   Y02669 39844002
         ST    SACBREG,XAXSACB     SAVE SACB PTR FOR POST        Y02669 39844402
         B     TESTOWN             BRANCH TO BUILD K PARM LIST   Y02669 39846002
*********************************************************************** 39848402
*     D,H                                                        Y02669 39848802
*********************************************************************** 39849202
SETHOLD  EQU   *                                                 Y02669 39849602
         OI    DCMADFLG,DCMAHOLD   SET ON HOLD FLAG IN DCM       Y02669 39849702
         B     TESTOWN             BRANCH TO BUILD K PARM LIST   Y02669 39849802
         EJECT                                                          39849902
*********************************************************************** 39850002
*                                                                     * 39900002
*           COMMON SUBROUTINE FOR K E,D OR K D,F PROCESSING           * 39950002
*                                                                     * 40000002
*********************************************************************** 40260002
         SPACE   2                                                      40290002
PROCESS  EQU   *                                                        40291003
         L     SACBREG,DCMADSDS    GET SACBPTR                 @Y02668P 40292003
         LTR   SACBREG,SACBREG     IF ZERO                     @Y02668P 40292503
         BZ    ERR921              NO AREA EXISTS              @Y02668P 40293003
         USING DCMACB,SACBREG      SET BASE FOR SACB             Y02669 40296002
         CLI   XASDID,ZERO         WAS AREA SPECIFIED ON COMMAND?Y02669 40298002
         BNE   AREASPEC            YES, BRANCH                   Y02669 40298402
         XC    XASAVSTD(N8),XASAVSTD CLEAR SACB ADDR SAVE AREA @YM7666P 40298602
SACBSCAN EQU   *                                                 Y02669 40298802
         TM    DCMASACB,DCMAUSE    IS AREA IN USE?               Y02669 40299202
         BZ    AREACHEK            NO, CHECK DISPLAY FOUND     @ZA09164 40299603
         TM    DCMADFLG,DCMADD     TRACK IN AREA?              @YM7666P 40301703
         BO    TESTTR              YES, CHECK IT OUT           @YM7666P 40302702
         TM    DCMAFLG1,DCMADISP   IS DISPLAY IN AREA?           Y02669 40305702
         BO    FOUNDONE            YES, IS IT THE RIGHT ONE      Y02669 40307702
NEXTSACB EQU   *                                               @YM7666P 40311002
         ICM   SACBREG,N7,DCMACBNX+1  IS THERE ANOTHER AREA?     Y02669 40314002
         BZ    AREACHEK            NO, GO SEE IF ONE ALREADY   @YM7666P 40317002
*                                  FOUND                       @YM7666P 40319002
         B     SACBSCAN            YES, CHECK IT OUT             Y02669 40321002
AREACHEK EQU   *                                               @YM7666P 40321102
         ICM   SACBREG,M7,XASAVSTD+1 DISPLAY AREA FOUND?       @YM7666P 40322102
*                                  GETS ADDR OF DISPLAY SACB   @YM7666P 40323102
         BZ    NOHITS              NO, CHECK IF TRACK FOUND    @YM7666P 40324102
         B     WHICHONE            YES, DETERMINE COMMAND      @YM7666P 40325102
NOHITS   EQU   *                                               @YM7666P 40326102
         ICM   SACBREG,M7,XASAVSTD+N5 TRACK FOUND?             @YM7666P 40327102
*                                  GETS ADDR OF TRACK SACB     @YM7666P 40328102
         BNZ   TRFOUND             YES, DETERMINE COMMAND      @YM7666P 40329102
         B     NODISPS             NO, ERR NO DISPLAY ON       @YM7666P 40330102
*                                  SCREEN                      @YM7666P 40331102
TRFOUND  EQU   *                                               @YM7666P 40332102
         CLI   N2(REG6),DCHAR      IS THIS ERASE DISPLAY CMD?  @YM7666P 40333102
         BE    USEPT               YES, ERR IEE151I USE STOPTR @YM7666P 40334102
         MVC   XASDID,DCMAID       NO, PUT TRACK AREA ID IN    @YM7666P 40335102
         B     FRAME               XSA AND GO HANDLE FRAME     @YM7666P 40336102
         EJECT                                                          40339202
AREASPEC EQU   *                                                 Y02669 40340202
         CLC   DCMAID(ONE),XASDID  SACB ID MATCH SPECIFIED ID?   Y02669 40341202
         BE    MATCHID             YES, IS DISPLAY IN AREA       Y02669 40342202
         ICM   SACBREG,N7,DCMACBNX+1 GET ADDRESS OF NEXT SACB    Y02669 40343202
         BNZ   AREASPEC            CONTINUE SEARCH OF SACB'S     Y02669 40345202
         B     NODISPA             ERR-NO DISPLAY IN AREA        Y02669 40346202
MATCHID  EQU   *                                                 Y02669 40347202
         TM    DCMAFLG1,DCMADISP   IS THERE A DISPLAY IN AREA?   Y02669 40348202
         BO    WHICHONE            YES, WHICH COMMAND IS THIS    Y02669 40349202
         B     NODISPA             ERR-NO DISPLAY IN AREA        Y02669 40350202
FOUNDONE EQU   *                                                 Y02669 40353202
         CLI   XASDID,ZERO         FIRST TIME DISPLAY FOUND?   @YM7666P 40354202
         BNE   PROCESS             NO, DEFAULT TO LOWEST DISP  @ZA09164 40355203
         MVC   XASDID,DCMAID       SAVE AREA ID FOR LATER      @YM7666P 40356202
         ST    SACBREG,XASAVSTD    SAVE DISPLAY SACB ADDR      @YM7666P 40357202
         B     NEXTSACB            CHECK NEXT AREA             @YM7666P 40358202
WHICHONE EQU   *                                                 Y02669 40359202
         CLI   N2(REG6),DCHAR      IS THIS ERASE DISPLAY CMND?   Y02669 40360202
         BNE   FRAME               BRANCH NO                     Y02669 40363202
         TM    DCMADFLG,DCMADD     IS THIS A DYNAMIC DISPLAY?    Y02669 40365202
         BO    USEPT               YES IEE151 USE STOPTR COMMAND Y02669 40365602
         B     TESTOWN             BRANCH NO  K E,D IS VALID     Y02669 40366002
         SPACE 3                                                        40366402
FRAME    EQU   *                                                 Y02669 40366502
         TM    DCMAFLG1,DCMAFRPR   IS FRAMING IN PROCESS?        Y02669 40366602
         BO    FRMNTCMP            YES IEE158 FRAME NOT COMPLETE Y02669 40377702
         TM    DCMAFLG1,DCMADEND   IS THIS THE LAST FRAME?       Y02669 40387702
         BO    LASTFRAM            YES IEE158 LAST FRAME DISPLAY Y02669 40388102
         OI    DCMAFLG1,DCMAFRPR   SET FRAMING IN PROCESS FLAG   Y02669 40388502
         B     TESTOWN             BRANCH TO BUILD K PARM LIST   Y02669 40388602
         EJECT                                                          53650002
***************************************************************@YM7666P 53651002
*                                                              @YM7666P 53655002
* CHECK FOR TRACK FOUND IN AREA WHILE PROCESSING K E,D OR      @YM7666P 53659002
* K D,F WITHOUT L=CCA                                          @YM7666P 53663002
*                                                              @YM7666P 53667002
* FOR K E,D: AN AREA CONTAINING TRACK WILL NOT BE CONSIDERED,  @YM7666P 53671002
*            SINCE ONLY STOPTR CAN DELETE A TRACK, UNLESS IT   @YM7666P 53675002
*            IS THE ONLY OCCUPIED AREA ON THE SCREEN.  THIS    @YM7666P 53679002
*            WILL BE TREATED AS AN ERROR.                      @YM7666P 53683002
*                                                              @YM7666P 53687002
* FOR K D,F: AN AREA CONTAINING TRACK WILL BE CONSIDERED ONLY  @YM7666P 53691002
*            IF THE DISPLAY IS THE ONLY DISPLAY ON THE SCREEN. @YM7666P 53695002
*            IF ANOTHER DISPLAY IS THERE, IT WILL BE FRAMED IN @YM7666P 53699002
*            PREFERENCE TO THE TRACK.                          @YM7666P 53703002
*                                                              @YM7666P 53707002
***************************************************************@YM7666P 53711002
         SPACE 3                                                        53720002
TESTTR   EQU   *                                               @YM7666P 53725002
         ST    SACBREG,XASAVSTD+N4 SAVE TRACK AREA SACB ADDR   @YM7666P 53735002
         B     NEXTSACB            CHECK NEXT AREA             @YM7666P 53745002
         EJECT                                                          53770002
*********************************************************************** 53775002
*                                                                     * 53780002
* BUILD PARAMETER LIST WITH COMMAND AND OPERANDS.  FIRST DETERMINE IF * 53800001
* GETMAIN HAS TO BE ISSUED IF TARGET AND ISSUING CONSOLE ARE NOT      * 53900002
* THE SAME OR IF THE DCM WILL BE USED FOR THE PARAMETER LIST          * 53950002
*                                                                     * 54100001
*********************************************************************** 54150002
         SPACE 3                                                        54200001
*********************************************************************** 54250002
*   DOES TARGET CONSOLE = ISSUING ?                                   * 54350002
*********************************************************************** 54450002
TESTOWN  EQU   *                                                        54600001
         TM    XASSDS,XASSDS3      IF CMD FROM ASSOC CNSL               54630003
         BO    GETKPARM            GETMAIN KPARM LIST          @Y02668P 54660003
         CLC   XAU(ONE),XASCID     IS THE TARGET ID EQUAL TO THE ISSUE- 54700001
         BE    SETDCM              ING CONSOLE? IF NO, ISSUE GETMAIN.   54800002
*********************************************************************** 54850002
*   TARGET CONSOLE DOES NOT = ISSUING                                 * 54900002
*                        OR                                   @Y02668P* 54910003
*   CMD ISSUED FROM JES3 ASSOCIATED CONSOLE                   @Y02668P* 54920003
*********************************************************************** 54950002
GETKPARM EQU   *                                                        55050003
         L     KREG,DCMADKP        GET POINTER TO PARAMETER LIST        55200001
         USING KPARAM,KREG         ADDRESSIBILITY FOR K LIST            55300001
         LA    REG0,DCMADKP        GET ADDRESS OF POINTER        Y02651 55400002
SRCLST   EQU   *                                                 Y02669 55450002
         LTR   KREG,KREG           K PARM ALREADY ON CHAIN?      Y02669 55800002
         BZ    GETAREA             NO, BRANCH TO GETMAIN ONE            55900002
         L     KREG,KCHAIN         GET POINTER TO NEXT K LIST           56300001
         LA    REG0,KCHAIN         GET ITS POINTER               Y02651 56400002
         B     SRCLST              BRANCH TO SEARCH LISTS               56500001
         EJECT                                                          56600002
*********************************************************************** 56650002
*   LOCKS MUST BE HELD FOR CHAINING THEREFORE DO BRANCH ENTRY TO      * 56700002
*   GETMAIN                                                           * 56710002
*      REGISTERS DESTROYED : 0, 1, 3, 4, 7, 14, 15                    * 56720002
*      INPUT TO GETMAIN : R4 POINTS TO CURRENT TCB                    * 56730002
*                         R7 POINTS TO CURRENT ASCB                   * 56740002
*********************************************************************** 56750002
GETAREA  EQU   *                                                        56900001
         L     REG4,CVTPTR         GET ADDRESS OF CVT            Y02651 56910002
         USING DCVT,REG4           ADDRESSABILITY OF CVT         Y02651 56950002
         L     REG4,CVTTCBP        GET ADDRESS OF TCB & ASCB PTRSY02651 56960002
         DROP  REG4                                              Y02651 56960402
         USING TCBASCB,REG4        ADDRESSABILITY OF IEFPTRS     Y02651 56962002
         L     REG7,ASCBPTR        ADDRESS OF ASCB FOR INTERFACE Y02651 57000002
         L     REG4,TCBPTR         ADDRESS OF TCB FOR INTERFACE  Y02651 57002002
         DROP  REG4                                              Y02651 57010002
         SR    REG4,REG4           INTERFACE FOR BRANCH ENTRY    Y02651 57050002
         ST    REG14,XAP           RETURN ADDRESS MUST BE SAVED  Y02651 57100002
         ST    REG0,XAD            K LIST ADDRESS MUST BE SAVED  Y02651 57150002
         GETMAIN  RC,LV=KPLLNGTH,SP=SP241,BRANCH=YES             Y02651 57300002
         L     REG14,XAP           RESTORE RETURN ADDRESS        Y02651 57350002
         L     REG4,XAD            RESTORE K LIST ADDRESS        Y02651 57360002
         LTR   R15,R15             WAS GETMAIN OK?                      57400002
         BC    N7,ERR930           NO, ISSUE IEE930I             Y02669 57460002
         ST    REG1,0(REG4)        YES, CHAIN K PARM             Y02651 57520002
         LR    KREG,REG1           GET AREA ADDRESS              Y02651 57600002
         XC    KFLGS(N7),KFLGS     ZERO FLAG BYTE AND POINTER           57700001
         OI    KFLGS,KGM           INDICATE AREA WAS GETMAINED          57800001
         B     BLDLST              BRANCH TO BUILD PARAMETER LIST       57900001
         EJECT                                                          58000002
*********************************************************************** 58050002
*   TARGET CONSOLE = ISSUING                                          * 58100002
*********************************************************************** 58150002
SETDCM   EQU   *                                                        58300001
         OI    DCMSVC34,DCMMYCMD   ISSUING CONSOLE TO HANDLE COMMAND    58400002
         LA    KREG,DCMINLGN       GET ADDRESS OF TRANS DCM PARAM LIST  58500002
         MVI   KFLGS,ZERO          ZERO FLAG BYTE ONLY           Y02669 58550002
*********************************************************************** 58600002
*   BUILD PARM LIST FOR ALL REQUESTS                                  * 58650002
*********************************************************************** 58700002
BLDLST   EQU   *                                                        59000001
         SR    REG7,REG7           CLEAR REGISTER                Y02669 59050002
         CR    REG6,REG7           IS OPERAND POINTER ZERO?      Y02669 59100002
         BE    NOPERAND            YES, IGNORE MOVE OF OPERANDS  Y02669 59110002
         L     REG7,XAR            NO, GET BEGINNING ADDRESS OF  Y02669 59120002
*                                  COMMAND BUFFER                Y02669 59130002
         LA    REG7,0(REG7)        CLEAR HI ORDER BYTE           Y02669 59140002
         AH    REG7,0(REG7)        CALCULATE END OF CMD BUFFER   Y02669 59142002
         SR    REG7,REG6           CALCULATE LENGTH OF OPERANDS  Y02669 59144002
         CH    REG7,LGTH125        IS LENGTH LESS THAN 125     @YM3473P 59144102
         BL    EXEC                YES BRANCH AND CONTINUE     @YM3473P 59144202
         LH    REG7,LGTH124        NO MAKE IT 125              @YM3473P 59144302
*  DON'T DECREMENT FOR EXECUTE - MUST HAVE AT LEAST 1 BLANK AT END FOR* 59144402
*  FOR PROPER INTERFACE                                               * 59144802
EXEC     EQU   *                                               @YM3473P 59145402
         EX    REG7,MOVEOPS        MOVE OPERANDS INTO K LIST     Y02669 59146002
NOPERAND EQU   *                                                        59150002
         ST    MODREG,KMOD         PUT MODULE INDICATOR IN DCM   Y02669 59200002
         MVC   KAID(ONE),XASDID    MOVE AREA ID INTO LIST               59300001
         CLI   XAN,PT              IS COMMAND STOP TRACK?        Y02669 59700002
         BE    SETMON              YES BRANCH                           59800001
         OI    KFLGS,KK            SET CONTROL COMD INDICATOR           60200001
         CLC   ZERO(N3,REG6),DUCHAR IS THIS THE K D,U COMMAND? @ZA01568 60250003
         BE    POSTRACK            GO POST TRACK PROCESSOR       Y02669 60260002
         B     INDSET              BRANCH TO TEST FOR GETMAIN           60300001
         EJECT                                                          60310002
*********************************************************************** 60350002
*   BRANCH ENTRY POST FOR STOP TRACK AND K D,U                @Y02668P* 60360003
*    1. LOCAL POST IF THE COMMAND IS ISSUED IN COMTASK        @Y02668P* 60362003
*       MEMORY                                                @Y02668P* 60364003
*    2. CROSS MEMORY POST IF THE COMMAND WAS ISSUED           @Y02668P* 60366003
*       FROM ANOTHER MEMORY (JES3)                            @Y02668P* 60368003
*********************************************************************** 60370002
         SPACE   3                                                      60400002
SETMON   EQU   *                                                 Y02669 60450002
         OI    KFLGS,KPT           SET STOPTR INDICATOR          Y02669 60700002
POSTRACK EQU   *                                                 Y02651 60700402
         STM   KREG,R15,XASAVSTD   SAVE REGS BEFORE POST         Y02651 60702002
         DROP  KREG                                              Y02651 60710002
         L     SACBREG,XAXSACB     GET ADDR OF SACB WITH TRACK   Y02669 60750002
         USING DCMACB,SACBREG      SET UP ADDRESSABILITY         Y02669 60760002
         L     MODREG,DCMATECB     GET ADDR OF TRACK CANCEL ECB  Y02669 60770002
         DROP  SACBREG                                           Y02669 60780002
         CLI   N2(REG6),UCHAR      IS THIS THE K D,U COMMAND?    Y02651 60780402
         BNE   SETPTCDE            NO, SET STOPTR POST CODE      Y02651 60780802
         LA    KREG,KDUCODE        ELSE, SET UPDATE MODE CODE    Y02651 60781202
         B     GOTOPOST            BRANCH ENTER POST ROUTINE     Y02651 60781602
SETPTCDE EQU   *                                                 Y02651 60781702
         LA    KREG,PTCODE         LOAD POST CODE FOR STOPTR     Y02651 60782002
GOTOPOST EQU   *                                                 Y02651 60782402
         L     REG14,CVTPTR        GET ADDRESS OF CVT            Y02651 60784002
         USING DCVT,REG14          ADDRESSABILITY TO CVT         Y02651 60786002
         L     R15,CVT0PT01        GET ADDRESS OF POST ROUTINE   Y02651 60788002
         TM    XASSDS,XASSDS3      DID COMTASK ISSUE THE CMD?  @Y02668P 60788103
         BZ    BRPOST              YES, BRANCH LOCAL POST      @Y02668P 60788203
         LA    SACBREG,CVTBRET     NO, JES3 XMPOST ERRET R12   @Y02668P 60793403
         ICM   MODREG,M8,XPOST     INDICATE XMPOST             @Y02668P 60796403
         L     REG3,CVTCUCB        GET ADDRESS OF UCM BASE     @Y02668P 60800403
         USING UCM,REG3            ADDRESSABILITY TO THE UCM   @Y02668P 60804403
         L     BASEREG,UCMASCB     ASCB TO BE POSTED R13       @Y02668P 60809603
BRPOST   EQU   *                                               @Y02668P 60814603
         DROP  REG14                                             Y02651 60816603
         BALR  REG14,R15           BRANCH ENTER POST             Y02651 60819603
         LM    KREG,R15,XASAVSTD   RESTORE REGS AFTER POST       Y02651 60824603
         USING KPARAM,KREG         RESTORE ADDRESSABILITY        Y02651 60829603
         SPACE 2                                                        60839603
INDSET   EQU   *                                                 Y02669 60850002
         TM    KFLGS,KGM           WAS K PARM GETMAINED HERE?    Y02669 61100002
         BO    TSTBSY              YES, BRANCH                          61200001
         B     RETURN              ELSE RETURN                   Y02669 61250002
         SPACE 2                                                        61700001
TSTBSY   EQU   *                                                 Y02669 61750002
         TM    UCMSTS,UCMBF        IS TARGET DEVICE BUSY?        Y02669 62000002
         BO    RETURN              YES, BRANCH TO RETURN                62100001
         SPACE 2                                                        62200001
         TM    UCMECB,WAITCODE     IS TARGET DEVICE WAITING?            62500002
         BO    POST                YES, BRANCH TO POST                  62600001
         SPACE 3                                                        62700001
         CLI   UCMECB,REDYCODE     IS TARGET DEVICE READY?              63000002
         BNE   RETURN              NO, BRANCH TO RETURN                 63100001
         EJECT                                                          63200002
*********************************************************************** 63210002
*        POST DIDOCS IF THE TARGET DEVICE IS WAITING USING    @Y02668P* 63250003
*          THE POST MACRO                                     @Y02668P* 63256003
*           1. RELEASE THE LOCKS. THE LOCKS ARE ALWAYS HELD   @Y02668P* 63262003
*              ON ENTRY TO IEE6703D                           @Y02668P* 63268003
*           2. LOCAL POST IF THE COMMAND WAS ISSUED IN        @Y02668P* 63274003
*              COMTASK MEMORY                                 @Y02668P* 63280003
*           3. CROSS MEMORY POST IF A MEMORY OTHER THAN       @Y02668P* 63286003
*              COMTASK ISSUED THE COMMAND (JES3)              @Y02668P* 63292003
*********************************************************************** 63300002
         SPACE 2                                                        63350002
POST     EQU   *                                                        63500001
         DROP  REG8                                              Y02669 63510002
         STM   KREG,R15,XASAVSTD   SAVE REGS BEFORE POST       @ZA03632 63512003
         LA    MODREG,UCMECB       ADDR OF ECB TO POST         @ZA03632 63514003
         LA    KREG,POSTCODE       POST CODE REG               @ZA03632 63516003
         L     REG14,CVTPTR        PTR TO CVT                  @ZA03632 63518003
         USING DCVT,REG14          CVT ADDRESSABILITY          @ZA03632 63520003
         L     R15,CVT0PT01        ADDR OF POST ROUTINE        @ZA03632 63522003
         TM    XASSDS,XASSDS3      DID COMM TASK ISSUE CMND?   @ZA03632 63524003
         BZ    LOCPOST             YES, BRANCH TO LOCAL POST   @ZA03632 63526003
         LA    SACBREG,CVTBRET     XMPOST ERRET ADDR           @ZA03632 63528003
         ICM   MODREG,M8,XPOST     INDICATE XMPOST             @ZA03632 63530003
         L     REG3,CVTCUCB        ADDR OF UCM BASE            @ZA03632 63532003
         USING UCM,REG3            UCM ADDRESSABILITY          @ZA03632 63534003
         L     BASEREG,UCMASCB     ASCB TO BE POSTED           @ZA03632 63536003
LOCPOST  EQU   *                                               @ZA03632 63538003
         DROP  REG14                                           @ZA03632 63540003
         BALR  REG14,R15           BRANCH ENTER POST           @ZA03632 63542003
         LM    KREG,R15,XASAVSTD   RESTORE REGISTERS           @ZA03632 63544003
RETURN   EQU   *                                                 Y02669 63752002
         BAL   REG8,LOCKSOFF       GO RELEASE LOCKS              Y02651 63754002
         BR    REG14               RETURN TO CALLER              Y02669 63760002
         EJECT                                                          63760103
*********************************************************************** 63760503
* LOCKS MUST BE RELEASED BEFORE POSTING, RETURNING OR BRANCHING  Y02651 63760603
*                        TO IEE0503D                             Y02651 63760702
*********************************************************************** 63762202
         SPACE 2                                                        63764202
LOCKSOFF EQU   *                                                 Y02651 63768902
         STM   MODREG,REG14,XASAVLOC SAVE REGS AROUND SETLOCK    Y02651 63770802
         SETLOCK RELEASE,TYPE=CMS,RELATED=(K,IEE7503D(LOCKSET))         63772702
         SETLOCK RELEASE,TYPE=LOCAL,RELATED=(K,IEE7503D(LOCKSET))       63774602
         LM    MODREG,REG14,XASAVLOC RESTORE REGS AFTER SETLOCK  Y02651 63776502
         NI    XASSDS,XFF-XASSDS5  INDICATE NO LOCKS SET         Y02651 63778402
         BR    REG8                RETURN TO MAINLINE            Y02651 63780302
         EJECT                                                          63782202
*********************************************************************** 63784102
*                                                                     * 63786002
*                            ERROR EXITS                         Y02669 63787902
*                                                                     * 63789802
* NOTE: LOCKS ARE ALWAYS HELD ON ENTRY TO IEE6703D                    * 63791702
*********************************************************************** 63793602
         SPACE                                                          63795502
ERR156   EQU   *                                                        63797402
         SR    REG7,REG7           CLEAR REGISTER                Y02669 63799302
         CR    REG6,REG7           IS OPERAND POINTER ZERO?      Y02669 63801202
         BE    KEDEFAUT            YES, NO OPERANDS K E DEFAULT  Y02669 63803102
         LA    REG6,ZERO(REG6)     SET OP POINTER                Y02669 63805002
KEDEFAUT EQU   *                   CURSOR POINTER CAN BE ZERO    Y02669 63806902
         ST    REG6,XASTSAVE       CURSOR ADDRESS FOR MSG RTN    Y02669 63808802
         MVI   XAE,MSG156          IEE156I  - INVALID OPERAND    Y02669 63810702
         B     D5603D              BRANCH TO EXIT                Y02669 63812602
         SPACE  2                                                       63814502
USEPT    EQU   *                                                        63816402
         MVI   XASTSAVE,MSG151A    SECOND MSG CODE -USE STOPTR   Y02669 63818302
         SPACE 1                                                        63820202
ERR151   EQU   *                                                        63822102
         MVI   XAE,MSG151          IEE151I  -DELETE INCONSISTENT Y02669 63824002
         B     STOREOP             BRANCH TO MSG EXIT            Y02669 63825902
         SPACE  2                                                       63827802
NODISPA  EQU   *                                                        63829702
         MVI   XASTSAVE,MSG1581B   SECOND CODE - NO DISPLAY IN AREA     63831602
         CLI   ZERO(REG6),ECHAR    IS THIS AN ERASE OPERAND?      M2087 63833502
         BE    ERR151              BRANCH YES FOR DELETE MSG      M2087 63835402
         B     ERR158              NO, K MSG                            63837302
         SPACE  1                                                       63839202
NODISPS  EQU   *                                                        63841102
         MVI   XASTSAVE,MSG1581A   SECOND CODE - NO DISPLAY ON SCREEN   63843002
         CLI   ZERO(REG6),ECHAR    IS THIS AN ERASE OPERAND?      M2087 63844902
         BE    ERR151              BRANCH YES FOR DELETE MSG      M2087 63846802
         B     ERR158              NO, K MSG                            63848702
         SPACE  1                                                       63850602
LASTFRAM EQU   *                                                        63852502
         MVI   XASTSAVE,MSG158A    SECOND CODE - LAST FRAME DISPLAY     63854402
         B     ERR158              BRANCH TO MAJOR MSG CODE             63856302
         SPACE  1                                                       63858202
FRMNTCMP EQU   *                                                        63860102
         MVI   XASTSAVE,MSG158B    SECOND CODE - FRAME NOT COMPLETE     63862002
         B     ERR158              BRANCH TO MAJOR MSG CODE             63863902
         EJECT                                                          63865802
DYDISP   EQU   *                                                        63867702
         MVI   XASTSAVE,MSG158C    SECOND CODE - DISPLAY NOT DYNAMIC    63869602
ERR158   EQU   *                                                        63871502
         MVI   XAE,MSG158          IEE158I  - K REQUEST INCONSISTENT    63873402
         B     STOREOP             BRANCH TO EXIT                Y02669 63875302
ERR921   EQU   *                                                        63875603
         MVI   XAE,MSG921          IEE921I - REJECTED          @Y02668P 63875903
         MVI   XASTSAVE,MSG921A    NEEDS DISPLAY AREA          @Y02668P 63876203
         B     STOREOP             BR, SET CURSOR POINTER      @Y02668P 63876503
         SPACE 2                                                        63877202
ERR925A  EQU   *                                                        63877602
         MVC   XASOPTR(N3),XAL+ONE MOVE OPERAND POINTER IN       Y02669 63878002
         MVI   XASTSAVE,MSG925A    2ND CODE-FOR CRT ONLY         Y02669 63878402
         MVI   XAE,MSG925          MSG CODE-IEE925I OPERAND      Y02669 63878802
         B     D5603D              BRANCH TO EXIT                Y02669 63878902
         SPACE 2                                                        63879002
ERR926   EQU   *                                                        63879102
         MVI   XAE,MSG926          IEE926I  - L OPERAND INVALID         63881002
         MVI   XASTSAVE,MSG926A    SECOND CODE - ON THIS COMMAND        63882902
         B     STOREOP             BRANCH TO STORE OPERAND       Y02669 63884802
         SPACE 2                                                        63886702
ERR927   EQU   *                                                        63888602
         MVI   XASTSAVE,MSG927A    SECOND CODE - SPECIFY L OPERAND      63890502
         MVI   XAE,MSG927          IEE927I  - K REQUEST AMBIGUOUS       63895202
         LA    REG6,N3(REG6)       SET CURSOR TO 'L' POSITION    Y02669 63896202
         B     STOREOP                                                  63896702
         SPACE 2                                                        63897202
ERR930   EQU   *                                                        63897402
         MVI   XAE,MSG930          IEE930I- INSUFFICIENT STORAGE Y02669 63897602
         SPACE 2                                                        63906602
STOREOP  EQU   *                                                        63915602
         STCM  REG6,N7,XASOPTR     SAVE CURSOR POINTER           Y02669 63924602
D5603D   EQU   *                                                        63933602
         L     R15,VCON5603        RT AND K MSG MODULE NAME      Y02669 63942602
         BR    R15                 BRANCH TO IEE5603D            Y02669 63951602
DERR777  EQU   *                                                        63981603
         MVI   XAE,MSG777          INVALID FROM SUBSYSTEM CNSL @Y02668P 64011603
D0503D   EQU   *                                               @Y02668P 64041603
         BAL   REG8,LOCKSOFF       RELEASE THE LOCKS           @Y02668P 64071603
         L     R15,VCON0503        BRANCH TO MESSAGE MODULE    @Y02668P 64101603
         BR    R15                                             @Y02668P 64131603
         EJECT                                                          64176702
*********************************************************************** 64186702
*                                                                     * 64196702
*                 CONSTANTS USED IN THIS ROUTINE                      * 64206702
*                                                                     * 64208702
*********************************************************************** 64210702
         SPACE   3                                                      64212702
VCON5603 DC    V(IEE5603D)         RT AND K MSG RTN NAME         Y02669 64216302
VCON6803 DC    V(IEE6803D)         K A,NN,NN RTN NAME            Y02669 64266402
VCON6903 DC    V(IEE6903D)         K A,REF & K A,NONE RTN NAME   Y02669 64276402
VCON7703 DC    V(IEE7703D)         K V RTN NAME                  Y02669 64298802
VCON7803 DC    V(IEE7803D)         K C,D,ID RTN NAME             Y02669 64299202
VCON0503  DC   V(IEE0503D)                                     @Y02668P 64299303
CDCHAR   DC    C'C,D'              CONSTANT COMPARE              Y02669 64309603
DFCHAR   DC    C'D,F'              CONSTANT COMPARE            @YM7666P 64314603
DUCHAR   DC    C'D,U'              CONSTANT COMPARE            @ZA01568 64319603
LGTH125  DC    H'125'              MAX LENGTH K PARM LIST      @YM3473P 64324603
LGTH124  DC    H'124'              MAX LGTH K PARM LIST MINUS1 @YM3473P 64333203
XPOST    DC    X'80'               FLAG FOR XMPOST             @Y02668P 64336203
         SPACE                                                          64340203
DCOMPARE CLC   ONE(ZERO,REG1),ZERO(REG6) LOOK FOR MATCH IN TABLE Y02669 64347203
MOVEOPS  MVC   KOPN(ZERO),ZERO(REG6)    MOVE OPERANDS INTO KLIST Y02669 64354203
         SPACE   5                                                      64361203
*********************************************************************** 64368203
*                           PATCH AREA                                * 64375203
*********************************************************************** 64383202
PATCH    DC    C'****PATCH AREA****'                                    64393202
PATCH1   DC    C'IEE6703D-TEST ONLY'                                    64395202
PATCH2   DC    36C' '                                                   64397202
         EJECT                                                          64400002
*********************************************************************** 67160002
*                                                                     * 67170002
*                           BRANCH  TABLE                             * 67180002
*                                                                     * 67190002
*        THIS TABLE MUST BE IN A ONE-TO-ONE CORRESPONDENCE WITH  Y02669 67192002
*        THE 'COMPARE TABLE'                                     Y02669 67194002
*********************************************************************** 67196002
         SPACE   5                                                      67198002
BRTABLE  DS    0H                                                Y02669 67198402
         B     KALONE             BRANCH TO PROCESS K  E         Y02669 67198802
         B     SECMD              BRANCH TO PROCESS K  E,N       Y02669 67199202
         B     SEPFK              BRANCH TO PROCESS K  E,PFK     Y02669 67199602
         B     KALONE             BRANCH TO PROCESS K  E,SEG     Y02669 67199702
         B     SETFLG             BRANCH TO PROCESS K  E,D       Y02669 67199802
         B     SEDEL1             BRANCH TO PROCESS K  E,        Y02669 67210002
         B     SEDEL4             BRANCH TO PROCESS K  D         Y02669 67233202
         B     SEDEL4             BRANCH TO PROCESS K  D,N       Y02669 67243202
         B     SEDEL4             BRANCH TO PROCESS K  D,N,HOLD  Y02669 67253202
         B     SETFLGMD           BRANCH TO PROCESS K  D,F       Y02669 67263202
         B     MODSET             BRANCH TO PROCESS K  D,H       Y02669 67265202
         B     MODSET             BRANCH TO PROCESS K  D,U       Y02669 67265402
         B     SEPFK              BRANCH TO PROCESS K  D,PFK     Y02669 67265602
         B     ERR156             BRANCH ERROR K D               Y02669 67266002
         B     SPECOPT            BRANCH TO PROCESS K  S         Y02669 67266102
         B     SPECOPT            BRANCH TO PROCESS K  S,        YM1913 67266202
         B     SEPFK              BRANCH TO PROCESS K  N         Y02669 67266402
         B     D7703D             BRANCH TO PROCESS K  V         Y02669 67266502
         B     D6903D             BRANCH TO PROCESS K  T         Y02669 67276502
         B     D6903D             BRANCH TO PROCESS K A          Y02669 67286502
         B     D6903D             BRANCH TO PROCESS K A,REF      Y02669 67286602
         B     D6903D             BRANCH TO PROCESS K A,NONE     Y02669 67286702
         B     D6803D             BRANCH TO PROCESS K A,NN,NN    Y02669 67286802
         B     D7803D             BRANCH TO PROCESS K C,D        Y02669 67286902
         EJECT                                                          67288502
*********************************************************************** 67288602
*  NOTE: THE FOLLOWING TABLE MUST BE THE LAST ITEM IN THIS            * 67288702
*        MODULE SINCE A USING FOR THE TABLE IS ISSUED ON              * 67288802
*        REGISTER 1 AND THUS CAN REESTABLISH THE MODULE'S             * 67289702
*        BASE REGISTER FOR ANY CODE WHICH FOLLOWS THIS TABLE.         * 67290602
*                                                                     * 67291502
*                          COMPARE TABLE                              * 67295702
*                                                                     * 67296102
*           THIS TABLE MUST BE IN A ONE-TO-ONE CORRESPONDENCE    Y02669 67299102
*           WITH THE BRANCH TABLE                                Y02669 67302102
*********************************************************************** 67305102
DTAB     EQU   *                                                 Y02669 67308102
DLEN     EQU   *                                                 Y02669 67311102
         DC    AL1(L'ERASE-1)       LENGTH OF OPERAND -1         Y02669 67314102
ERASE    DC    C'E '                VALID OPERAND                       67322102
         DC    AL1(L'ERASEN-1)                                   Y02669 67332102
ERASEN   DC    C'E,N '                                           Y02669 67342102
         DC    AL1(L'ERASEPFK-1)                                 Y02669 67344102
ERASEPFK DC    C'E,PFK '                                         Y02669 67346102
         DC    AL1(L'ERASESEG-1)                                 Y02669 67348102
ERASESEG DC    C'E,SEG '                                         Y02669 67356702
         DC    AL1(L'ERASED-1)                                   Y02669 67358702
ERASED   DC    C'E,D '                                           Y02669 67360702
         DC    AL1(L'ERASEC-1)                                   Y02669 67364302
ERASEC   DC    C'E'                                              Y02669 67364402
         DC    AL1(L'DISPLAY-1)                                  Y02669 67364502
DISPLAY  DC    C'D '                                             Y02669 67364702
         DC    AL1(L'DISPLAYN-1)                                 Y02669 67365102
DISPLAYN DC    C'D,N '                                           Y02669 67365202
         DC    AL1(L'DNHOLD-1)                                   Y02669 67365302
DNHOLD   DC    C'D,N,HOLD '                                      Y02669 67365402
         DC    AL1(L'DISPLAYF-1)                                 Y02669 67374002
DISPLAYF DC    C'D,F '                                           Y02669 67376002
         DC    AL1(L'DISPLAYH-1)                                 Y02669 67378002
DISPLAYH DC    C'D,H '                                           Y02669 67380002
         DC    AL1(L'DISPLAYU-1)                                 Y02669 67382002
DISPLAYU DC    C'D,U '                                           Y02669 67382102
         DC    AL1(L'DPFK-1)                                     Y02669 67385202
DPFK     DC    C'D,PFK '                                         Y02669 67391302
         DC    AL1(L'JUSTD-1)                                    Y02669 67393302
JUSTD    DC    C'D'                                              Y02669 67393702
         DC    AL1(L'SPEC-1)                                     Y02669 67394202
SPEC     DC    C'S '                                             Y02669 67397102
         DC    AL1(L'SPECC-1)                                    YM1913 67401102
SPECC    DC    C'S,'                                             YM1913 67405102
         DC    AL1(L'NPFK-1)                                     Y02669 67409302
NPFK     DC    C'N'                                              Y02669 67412802
         DC    AL1(L'VARY-1)                                     Y02669 67416102
VARY     DC    C'V'                                              Y02669 67426102
         DC    AL1(L'TR-1)                                       Y02669 67436102
TR       DC    C'T'                                              Y02669 67438102
         DC    AL1(L'A-1)                                        Y02669 67440102
A        DC    C'A '                                             Y02669 67442102
         DC    AL1(L'AREF-1)                                     Y02669 67442502
AREF     DC    C'A,REF '                                         Y02669 67442902
         DC    AL1(L'ANONE-1)                                    Y02669 67443302
ANONE    DC    C'A,NONE '                                        Y02669 67443702
         DC    AL1(L'ADIGIT-1)                                   Y02669 67443802
ADIGIT   DC    C'A,'                                             Y02669 67443902
         DC    AL1(L'CD-1)                                       Y02669 67444102
CD       DC    C'C,D'                                            Y02669 67444202
DENTAB   EQU   *                                                 Y02669 67500002
         EJECT                                                          68400001
DXSA     DSECT                                                          68450002
         IEEXSA                                                         68460002
         EJECT                                                          68499602
DCVT     DSECT                                                          68500001
         CVT                                                            68600001
         EJECT                                                          68700001
         IEECUCM  FORMAT=NEW                                            68900002
         EJECT                                                          69000001
         IEERDCM                                                        69200002
         EJECT                                                          69250002
DCMSTRT  DSECT                                                          69300002
         IEETDCM                                                        69350002
         EJECT                                                          69600001
PLIST    DSECT                                                          69700001
         IEECVMAP KPARAM                                                69800001
         EJECT                                                          69900001
         IHAPSA                                                         69950002
         EJECT                                                          69960002
         IEFPTRS                                                        69970002
         END                                                            70000001
./  ADD  SSI=52880398,NAME=IEE6803D
         TITLE 'IEE6803D SVC 34 K A COMMAND LOAD 2'                     00950002
*********************************************************************** 01100001
*                                                                     * 01110002
* MODULE NAME         =  IEE6803D                               Y02669* 01150002
*                                                                     * 01152002
* DESCRIPTIVE NAME    =  CONTROL (K) A COMMAND                  Y02669* 01160002
*                                                                     * 01162002
* COPYRIGHT           =  N/A                                    Y02669* 01170002
*                                                                     * 01172002
* STATUS              =  01 - UPDATE FOR VS/2 RELEASE 3       @ZA06992* 01180003
*                                                                     * 01182002
* FUNCTION            =  HANDLES K A,NN,NN...CONTROL COMMAND.   Y02669* 01190002
*                        ALSO REFERRED TO AS K A,LL,LL...               01190602
*                                                                     * 01191202
*   OPERATION         =  BASED ON THE TARGET CONSOLE ID IN      Y02669* 01192002
*                        XASCID, ADDRESSABILITY TO THE UCME,    Y02669* 01192302
*                        DCM, AND SACB IS ESTABLISHED. IF THE   Y02669* 01194302
*                        TARGET IS MESSAGE STREAM ONLY,         Y02669* 01195502
*                        'IEE926I OUTPUT ONLY' IS ISSUED.       Y02669* 01196002
*                                                                     * 01196802
*                        NEXT THE 'NN' OPERANDS ARE VALIDITY    Y02669* 01197202
*                        CHECKED. IF ANY IS NOT A DIGIT,        Y02669* 01197302
*                        'IEE156I INVALID OPERAND' IS ISSUED.   Y02669* 01197402
*                                                                     * 01197602
*                        THE DIGITS ARE THEN PACKED AND         Y02669* 01197902
*                        CONVERTED TO BINARY.  IF ANY OF THE    Y02669* 01198202
*                        AREA DEFINITIONS IS GREATER THAN THE   Y02669* 01198502
*                        TOTAL SCREEN SIZE, 'IEE924I SCREEN     Y02669* 01198802
*                        SIZE EXCEEDED' IS ISSUED.              Y02669* 01199102
*                        IF ANY VALUE IS LESS THAN THE SMALLEST Y02669* 01199502
*                        POSSIBLE AREA SIZE, 'IEE924I AREA TOO  Y02669* 01199602
*                        SMALL' IS ISSUED.                      Y02669* 01204602
*                        IF THE TOTAL OF THE AREA DEFINITIONS   Y02669* 01205602
*                        IS GREATER THAN THE SCREEN SIZE        Y02669* 01206602
*                        'IEE914I SCREEN SIZE EXCEEDED' IS      Y02669* 01207602
*                        ISSUED.                                Y02669* 01208602
*                                                                     * 01209602
*                        IN ALL OF THE ABOVE CASES, NONE OF THE Y02669* 01210002
*                        AREA DEFINITIONS ARE ACCEPTED.         Y02669* 01210402
*                                                                     * 01210502
*                        NEXT THE SACB CHAIN IS EXAMINED TO SEE Y02669* 01210602
*                        IF ANY AREAS ARE PRESENTLY DEFINED.    Y02269* 01211602
*                        IF SO, THEY CAN ONLY BE REDEFINED IF   Y02669* 01212602
*                        THEY CONTAIN NO DISPLAY OR ARE         Y02669* 01213002
*                        LOCATED ABOVE THE HIGHEST AREA         Y02669* 01213202
*                        CONTAINING A DISPLAY. IF THERE IS A    Y02669* 01213502
*                        DISPLAY IN ONE OF THE AREAS AND        Y02669* 01217602
*                        THE NEW DEFINITION IS A DIFFERENT      Y02669* 01221602
*                        LENGTH, 'IEE924I DISPLAY IN OR ABOVE   Y02669* 01222602
*                        AREA' IS ISSUED.                       Y02669* 01224602
*                                                                     * 01225602
         EJECT                                                          01226602
*                        GETMAINING THE AREA NEEDED FOR ALL     Y02669* 01227602
*                        THE SACB'S (SCREEN AREA CONTROL BLOCK) Y02669* 01228602
*                        THE SACB CHAIN IS BUILT AND            Y02669* 01229602
*                        INITIALIZED.                           Y02669* 01230102
*                        EACH SACB IS MARKED IN USE             Y02669* 01230602
*                            DCMASACB - DCMAUSE  X'80'          Y02669* 01231602
*                        IF THE GETMAIN FAILS FOR THE SACB'S,   Y02669* 01232602
*                        'IEE937I INSUFFICIENT STORAGE FOR      Y02669* 01233602
*                        COMMAND' IS ISSUED.                    Y02669* 01235602
*                                                                     * 01236602
*                        FINALLY A GETMAIN IS ISSUED FOR        Y02669* 01237602
*                        'IEE928I'. IF IT FAILS CONTROL IS      Y02669* 01238602
*                        RETURNED TO THE SYSTEM WITH A NON-ZERO Y02669* 01239602
*                        REG 15. IF SUCCESSFUL, A WTO IS        Y02669* 01240102
*                        ISSUED, THE CORE FREED, AND CONTROL    Y02669* 01240602
*                        RETURNED.                              Y02669* 01241102
*                                                                     * 01241602
* NOTES                  FOR FUTURE SCREEN SIZES:               Y02669* 01243602
*                        THIS MODULE WILL HAVE DIFFICULTIES IF  Y02669* 01244102
*                        AN ATTEMPT IS MADE TO DEFINE MORE THAN Y02669* 01244602
*                        12 AREAS OR 48 LINES. THE MESSAGE      Y02669* 01245102
*                        BUFFER FOR 'IEE928I' CAN NOT           Y02669* 01246602
*                        ACCOMMODATE MORE THAN 13 AREAS.        Y02669* 01247602
*                                                                     * 01248602
*   CHARACTER-CODE                                              Y02669* 01249602
*    DEPENDENCIES     =  ANY CHARACTER CODE OTHER THAN EBCDIC   Y02669* 01250602
*                        WILL REQUIRE REASSEMBLY OF THIS MODULE.Y02669* 01251602
*                        NOTE THAT THIS MODULE IS DEPENDENT     Y02669* 01252602
*                        UPON THE CHARACTER REPRESENTATION      Y02669* 01253602
*                        OF THE DECIMAL DIGIT IE. X'F1' = 1.    Y02669* 01254602
*                                                                     * 01255602
*   DEPENDENCIES      =  IEE6703D WILL ISSUE ERROR MESSAGE      Y02669* 01257602
*                        'IEE925I FOR CRT ONLY', IF TARGET      Y02669* 01258602
*                        CONSOLE IS NOT A CRT.                  Y02669* 01259602
*                                                                     * 01260602
*   RESTRICTIONS      =  THE TARGET CONSOLE MUST BE CRT.        Y02669* 01261602
*                        (VERIFIED IN IEE6703D)                 Y02669* 01262602
*                        TARGET CONSOLE CAN NOT BE MESSAGE      Y02669* 01263602
*                        STREAM ONLY.                           Y02669* 01264602
*                        'NN' MUST BE A DIGIT.                  Y02669* 01265602
*                                                                     * 01266602
*   REGISTER                                                    Y02669* 01268602
*    CONVENTIONS      =  NONE                                   Y02669* 01269602
*                                                                     * 01270602
*   PATCH-LABEL       =  PATCH                                  Y02669* 01271602
*                                                                     * 01272602
* MODULE TYPE         =  CSECT                                  Y02669* 01273602
*                                                                     * 01274602
*   PROCESSOR         =  N/A                                    Y02669* 01275602
*                                                                     * 01276602
*   MODULE SIZE       =  X'3C0' + X'48' PATCH AREA              Y02669* 01277602
*                                                                     * 01279602
*   ATTRIBUTES        =  REFRESHABLE, REENTRANT, SUPERVISOR     Y02669* 01280602
*                        MODE, KEY 0, PAGED LPA                 Y02669* 01281102
*                                                                     * 01281602
* ENTRY POINT         =  IEE6803D FROM IEE6703D                 Y02669* 01282602
*   PURPOSE           =  TO PROCESS THE K A,NN,NN COMMAND       Y02669* 01283602
*   LINKAGE           =  BRANCH                                 Y02669* 01284602
*   INPUT DATA        =  REG 2 POINTS TO THE XSA                Y02669* 01285602
*                          XAS CONTAINS L=CCA INFORMATION       Y02669* 01286602
*                             XASSDS5 ON - LOCKS HELD           Y02651* 01287602
*                          XAL ADDRESSES OPERAND BUFFER         Y02669* 01288602
*                     =  REG 14 CONTAINS THE RETURN ADDRESS     Y02669* 01290602
*                                                                     * 01291602
*   REGISTERS SAVED   =  REG 14 IS SAVED IN XSA (XAP)           Y02669* 01292602
*                        REGISTERS 11-14 ARE SAVED BEFORE       Y02651* 01293602
*                        ISSUING SETLOCK AT ZAPSACB.            Y02651* 01294602
*                                                                     * 01295102
*   REGISTER CONTENTS                                           Y02669* 01295602
*    DURING PROCESSING=  R0  - WORK REG                         Y02669* 01296602
*                        R1  - WORK REG                         Y02669* 01297602
*                        R2  - BASE REG FOR XSA                 Y02669* 01298602
*                        R3  - WORK REG                         Y02669* 01299602
*                        R4  - WORK REG & OPERAND POINTER       Y02669* 01301602
*                        R5  - WORK REG                         Y02669* 01302602
*                        R6  - WORK REG                         Y02669* 01303602
*                        R7  - BASE REG FOR SACB                Y02669* 01304602
*                        R8  - BASE REG FOR UCME                Y02669* 01305602
*                        R9  - WORK REG                         Y02669* 01306602
*                        R10 - BASE REG FOR RESIDENT DCM        Y02669* 01307602
*                        R11 - BRANCH REG FOR SUBROUTINE        Y02669* 01308602
*                        R12 - BASE REG UCM                     Y02669* 01309602
*                        R13 - BASE REG FOR MODULE              Y02669* 01310602
*                        R14 - SUBROUTINE AND MODULE RETURN REG Y02669* 01311602
*                        R15 - CODE REG                         Y02669* 01313602
*                                                                     * 01314402
*   REGISTERS RESTORED=  REGISTER 14 RESTORED AT BRANCH14       Y02669* 01315202
*                        REGISTERS 11-14 ARE RESTORED AFTER     Y02651* 01316002
*                        ISSUING SETLOCK AT ZAPSACB.            Y02651* 01316602
*                                                                     * 01317202
*  *  *  *  *  *  *  *  *  *  *  *  *  *  *  *  *  *  *  *  *  *  *  *  01317802
*                                                                     * 01318402
* EXIT - NORMAL       =  RETURN VIA BR 14                       Y02669* 01319402
*   CONDITIONS        =  FOR K A,LL,LL...                       Y02669* 01320802
*   OUTPUT DATA       =  TARGET CONSOLE'S SACBS ARE UPDATED AND Y02669* 01321802
*                        UPDATED STATUS INFORMATION OF SACB     Y02669* 01322802
*                        BLOCKS IS ISSUED TO SOURCE CONSOLE     Y02669* 01323802
*                        DEVICE VIA WTO 'IEE928I'.              Y02669* 01324802
*   RETURN CODES      =  NONE                                   Y02669* 01325802
*                                                                     * 01327802
*  *  *  *  *  *  *  *  *  *  *  *  *  *  *  *  *  *  *  *  *  *  *  *  01328802
*                                                                     * 01329802
* EXIT - ERROR        =  BRANCH TO IEE5603D FROM ERRORMSG       Y02669* 01330802
*   CONDITIONS        =  TO ISSUE ERROR MESSAGES                Y02669* 01331802
*   OUTPUT DATA       =  REG 2 POINTS TO XSA                    Y02669* 01332802
*                           XAE CONTAINS MAJOR MESSAGE INDEX    Y02669* 01333802
*                             X'04' - IEE156I INVALID OPERAND   Y02669* 01334802
*                             X'0A' - IEE924I INVALID AREA      Y02669* 01335802
*                                             DEFINITION        Y02669* 01336802
*                             X'0C' - IEE926I OPERAND INVALID   Y02669* 01340102
*                             X'0E' - IEE928I INSUFFICIENT      Y02669* 01340802
*                                          STORAGE FOR COMMAND  Y02669* 01341202
*                           XASTSAVE POINTS TO INVALID OPERAND  Y02669* 01341602
*                           OR CONTAINS MINOR MESSAGE INDEX     Y02669* 01341702
*                            IEE924I INVALID AREA DEFINITION    Y02669* 01341802
*                             X'0F' - SCREEN SIZE EXCEEDED      Y02669* 01341902
*                             X'10' - AREA TOO SMALL            Y02669* 01342002
*                             X'11' - DISPLAY IN OR ABOVE AREA  Y02669* 01342402
*                            IEE926I OPERAND INVALID            Y02669* 01359502
*                             X'1D' - OUTPUT ONLY               Y02669* 01359902
*                           XASSDS5 STILL ON LOCKS HELD         Y02651* 01360802
*   RETURN CODES      =  NONE                                   Y02669* 01366002
*                                                                     * 01371202
*  *  *  *  *  *  *  *  *  *  *  *  *  *  *  *  *  *  *  *  *  *  *  *  01376402
*                                                                     * 01381602
* EXIT - ERROR        =  RETURN VIA BR 14 FROM RETURN           Y02669* 01386802
*   CONDITIONS        =  IF GETMAIN FAILS FOR MESSAGE BUFFER    Y02669* 01392002
*   OUTPUT DATA       =  LOCKS RELEASED BEFORE GETMAIN          Y02651* 01394002
*                        REG 2 POINTS TO XSA                    Y02669* 01397202
*                           XASSDS5 TURNED OFF - LOCKS RELEASED Y02651* 01399202
*   RETURN CODES      =  REG 15 NON-ZERO                        Y02669* 01402402
*                                                                     * 01407602
*  *  *  *  *  *  *  *  *  *  *  *  *  *  *  *  *  *  *  *  *  *  *  *  01412802
*                                                                     * 01418002
* EXTERNAL REFERENCES                                           Y02669* 01423202
*                                                                     * 01428402
*   ROUTINES          =  IEE5603D                               Y02669* 01433602
*                                                                     * 01438802
*   DATA AREAS        =  NONE                                   Y02669* 01444002
*                                                                     * 01449202
*   CONTROL BLOCKS    =  IEECUCM   R - ADDRESS DCM              Y02669* 01454402
*                        IEEXSA    R - INPUT                    Y02669* 01459602
*                                  W - ERROR CODES              Y02669* 01464802
*                        IEERDCM   G - WHEN AREA DEFINED        Y02669* 01475202
*                         (SACB)   R - CHECK STATUS             Y02669* 01480402
*                                  W - INITIALIZE AND CHAIN     Y02669* 01485602
*                        CVT       R - ADDRESS UCM              Y02669* 01490802
*                        IHAPSA    NECESSARY FOR SETLOCK        Y02651* 01492802
*                        IEFPTRS   GET ADDRESS OF TCB & ASCB    Y02651* 01494802
*                                                                     * 01496002
*   TABLES            =  INTERNAL TABLE OF SACB ID'S  (A-K)     Y02669* 01501202
*                                                                     * 01506402
*   MACROS            =  GETMAIN   FOR SACB FROM SUBPOOL 241    Y02651* 01511602
*                                  (BRANCH ENTRY)               Y02651* 01512602
*                                  FOR WTO FROM SUBPOOL 229     Y02669* 01513602
*                        FREEMAIN  FOR WTO FORM SUBPOOL 229     Y02669* 01516802
*                        WTO                                    Y02669* 01522002
*                        MODID                                  Y02669* 01527202
*                        SETLOCK   CMS AND LOCAL LOCKS RELEASED Y02651* 01532402
*                                                                     * 01537602
*   LOCKS HELD        =  CMS AND LOCAL LOCKS OBTAINED IN        Y02651* 01553202
*                        IEE7503D ARE RELEASED AND XASSDS5      Y02651* 01558402
*                        IS RESET BEFORE ISSUING GETMAIN FOR    Y02651* 01563602
*                        'IEE928I' AT ZAPSACB.                  Y02651* 01565602
*                                                                     * 01568802
*   CHANGE LEVEL      =  Y02669                                 Y02669* 01574002
*                        Y02651                                 Y02651* 01579202
*                        YM1912                                 YM1912* 01581202
*                        ZA06491                              @ZA06491* 01582203
*                        ZA06692                              @ZA06692* 01583203
*                                                                     * 01584402
* MESSAGES            =  THE FOLLOWING MESSAGE IS CONTAINED IN  Y02669* 01589602
*                        AND ISSUED FROM THIS MODULE:           Y02669* 01594602
*                                                                     * 01600002
*                        IEE928I DISPLAY AREA ID'S FOR CONSOLE  Y02669* 01700002
*                                'CC' ARE  '...'                Y02669* 01800002
*                                                                     * 01900002
*                        THE FOLLOWING MESSAGES ARE CONTAINED   Y02669* 02000002
*                        IN AND ISSUED FROM IEE5603D AND        Y02669* 02100002
*                        IEE5903D:                              Y02669* 02200002
*                                                                     * 02300002
*                         MSGID  CODE  IN MESSAGE TEXT          Y02669* 02400002
*                         _____  ____  __ ____________          Y02669* 02500002
*                        IEE156I X'04' 56 INVALID OPERAND       Y02669* 02600002
*                        IEE924I X'0A' 56 INVALID AREA          Y02669* 02700002
*                                            DEFINITION         Y02669* 02800002
*                                X'0F' 59 SCREEN SIZE EXCEEDED  Y02669* 02900002
*                                X'10' 59 AREA TOO SMALL        Y02669* 03000002
*                                X'11' 59 DISPLAY IN OR ABOVE   Y02669* 03100002
*                                            AREA               Y02669* 03200002
*                        IEE926I X'0C' 56 OPERAND INVALID       Y02669* 03300002
*                                X'1D' 59 OUTPUT ONLY           Y02669* 03400002
*                        IEE928I X'0E' 56 INSUFFICIENT STORAGE  Y02669* 03500002
*                                            FOR COMMAND        Y02669* 03600002
*                                                                     * 03700002
* SYSGEN              =  INCLUDE WITH SVC IN LOAD               Y02669* 03900002
*                        MODULE IGC003D,DLIB AOSB3,             Y02669* 04100002
*                        MACRO SGIEF441, TARGLIB LPALIB         Y02669* 04300002
*                                                                     * 04500002
* SYSTEM LIBRARIES    =  NONE                                   Y02669* 04700002
*                                                                     * 04900002
*********************************************************************** 05100001
         EJECT                                                          05200001
IEE6803D CSECT                                                          05250002
* A INCORE                                                     @ZA06491 05258003
* C FREEXTRA                                                   @ZA06491 05266003
* D ZAPSACB                                                    @ZA06491 05274003
* A SACBINIT                                                   @ZA06491 05282003
* C FREESACB                                                   @ZA06491 05290003
* A NEXTSACB                                                   @ZA06992 05295003
*********************************************************************** 05300001
*                                                                     * 05400002
*                             REGISTERS                               * 05500002
*                                                                     * 05600002
*********************************************************************** 05700001
R0       EQU   0                   WORK REG                             05710002
R1       EQU   1                   WORK REG                             05720002
PARMREG  EQU   2                   BASE REG FOR XSA                     05750002
R3       EQU   3                   WORK REG                             05810002
R4       EQU   4                   WORK REG                             05820002
KOPS     EQU   4                   OPERAND POINTER                      05850002
R5       EQU   5                   WORK REG                             06000002
R6       EQU   6                   WORK REG                             06050002
SACBPT   EQU   7                   SACB BASE REG                        06460002
UCMEBASE EQU   8                   UCME BASE REG                        06500002
R8       EQU   8                   PART OF EVEN-ODD PAIR         Y02669 06510002
R9       EQU   9                   PART OF EVEN-ODD PAIR         Y02669 06550002
RDCMBASE EQU   10                  RESIDENT DCM BASE REG                06600002
RB       EQU   11                  SUBROUTINE BRANCH REG                06650002
UCMBASE  EQU   12                  UCM BASE REG                         06700002
MYBASE   EQU   13                  MODULE BASE REG                      06750002
RETURN14 EQU   14                  SUBROUTINE RETURN REG         Y02669 06760002
R15      EQU   15                  CODE REG                      Y02669 08000002
         EJECT                                                          08010002
*********************************************************************** 08050002
*                                                                     * 08100002
*                      MESSAGE FLAG BIT SETTINGS                      * 08200002
*                                                                     * 08210002
*********************************************************************** 08250002
IEE156I  EQU   X'04'               MAJOR - INVALID OPERAND              08300002
IEE924   EQU   X'0A'               MAJOR - INVALID AREA DEFINITION      08500002
IEE924I  EQU   X'11'                 DISPLAY IN OR ABOVE AREA           08600002
IEE924I2 EQU   X'10'                 AREA TOO SMALL                     08700002
IEE924I3 EQU   X'0F'                 SCREEN SIZE EXCEEDED               08800002
IEE926I  EQU   X'0C'               MAJOR - OPERAND INVALID              09150002
IEE926   EQU   X'1D'                 OUTPUT ONLY                 Y02669 09150402
IEE931I  EQU   X'0E'               MAJOR - INSUF. STOR. FOR CMD         09152002
*********************************************************************** 09250002
*                                                                     * 09260002
*                       EQUATES                                       * 09270002
*                                                                     * 09280002
*********************************************************************** 09290002
N0       EQU   0                   FIELD INCREMENT                      09300001
N1       EQU   1                   FIELD INCREMENT                      09400001
N2       EQU   2                   FIELD INCREMENT                      09500001
N3       EQU   3                   FIELD INCREMENT                      09600001
N4       EQU   4                   FIELD INCREMENT                      09700001
N6       EQU   6                   FIELD INCREMENT                      09900001
N7       EQU   7                   FIELD INCREMENT                      10000001
N8       EQU   8                   FIELD INCREMENT                      10100002
N10      EQU   10                  FIELD INCREMENT               Y02669 10110002
N12      EQU   12                  FIELD INCREMENT               Y02669 10150002
N26      EQU   26                  FIELD INCREMENT                      10300002
N42      EQU   42                  FIELD INCREMENT                      10400002
N49      EQU   49                  FIELD SIZE                           10550002
N80      EQU   80                  FIELD SIZE                           10560002
*********************************************************************** 10570002
*                                                                     * 10580002
*                        CHARACTER CONSTANTS                          * 10590002
*                                                                     * 10592002
*********************************************************************** 10594002
BLANK    EQU   C' '                BLANK CHARACTER CONSTANT             11100002
COMMA    EQU   C','                COMMA CHARACTER CONSTANT             11120002
ZERO     EQU   X'00'               ZERO CHARACTER CONSTANT              11140002
XFF      EQU   X'FF'               MASK FOR NI                   Y02651 11170402
SIGN     EQU   X'FC'               USED TO CONVERT F TO C FOR CVB       11180002
DIGIT    EQU   X'F0'               DIGIT CHAR REPRESENTATION     Y02669 11200002
MCSMASK  EQU   X'41'               WTO MCS FLAGS                        11400002
PTRCVT   EQU   16                  CVT ADDRESS                          11600002
SP241    EQU   241                 SUBPOOL FOR SACB              Y02651 11900002
SP229    EQU   229                 SUBPOOL FOR MESSAGE           Y02651 11950002
         EJECT                                                          12200001
*********************************************************************** 12300001
*                                                                     * 12350002
*          ESTABLISH ADDRESSABILITY FOR MODULE AND                    * 12700002
*              BASE REGS FOR UCM, UCME, DCM, SACB                     * 12710002
*        ON ENTRY, REGISTER 2 CONTAINS ADDRESS OF XSA                 * 12750002
*                                                                     * 12800002
*********************************************************************** 12900001
         BALR  MYBASE,N0           ESTABLISH ROUTINE 'S                 13300001
         USING *,MYBASE            BASE REGISTER                        13400001
         MODID BRANCH=YES                                        Y01886 13450001
         USING FAUXSA,PARMREG      ESTABLISH XSA ADDRESSABILITY         13500002
         L     UCMBASE,PTRCVT      GET CVT ADDRESS               Y02669 13700002
         USING CVTSECT,UCMBASE     BASE CVT REG                         13800001
         L     UCMBASE,CVTCUCB     GET UCM POINTER FROM CVT             13900002
         DROP  UCMBASE                                           Y02669 13950002
         USING UCM,UCMBASE         ESTABLISH UCM ADDRESSABILITY  Y02669 14000002
         USING UCMLIST,UCMEBASE    BASE UCM ENTRY LIST                  14100001
         USING DCMTSRT,RDCMBASE    ESTABLISH RDCM BASE REG       Y02669 14200002
         USING DCMACB,SACBPT       BASE SACB REG                        14400001
         SPACE 3                                                        14500001
         ST    RETURN14,XAP        SAVE RETURN POINTER           Y02669 14800002
         EJECT                                                          15760002
*********************************************************************** 15800002
*                                                                     * 18100002
*    FIND AND BASE UCM ENTRY RESIDENT DCM AND SACB                    * 26050002
*    INPUT- REG 1-CONSOLE ID RIGHT JUSTIFIED, HIGH ORDER BYTES ZERO   * 26100002
*    OUTPUT-POINTER TO UCMENTRY SPECIFIED BY CONSOLE ID IN UCMEBASE   * 26150002
*    REG USAGE-DESTROYS CONTENTS OF: REG 0,1,UCMEBASE                 * 26200002
*                                                                     * 26205002
* NOTE: IEE7503D INSURES THAT THE TARGET CONSOLE IS A CRT.            * 26225002
*********************************************************************** 26260002
         SPACE 2                                                        26270002
         SR    R1,R1               CLEAR REG                            26280002
         IC    R1,XASCID           LOAD TARGET CONSOLE ID        Y02669 26290002
         BCTR  R1,ZERO             SUBTRACT ONE FROM CONSOLE ID         26298401
         L     UCMEBASE,UCMVEA     POINT TO FIRST UCME ENTRY            26298502
         M     R0,UCMVEZ           MULTIPLY ENTRY SIZE BY REDUCED ID    26298801
         AR    UCMEBASE,R1         POINT TO DESIRED UCM ENTRY           26299201
         L     RDCMBASE,UCMXB      LOAD ADDRESS OF RESIDENT DCM         26299802
         L     SACBPT,DCMADSDS     LOAD SACB POINTER FROM RDCM          26299902
*********************************************************************** 26310402
*                                                                     * 26310802
*           IF TARGET IS MESSAGE STREAM = IEE926I                Y02669 26314002
*                                                                     * 26316002
*********************************************************************** 26318002
         L     KOPS,XAL            LOAD POINTER TO OPERANDS      Y02669 26318402
         LA    KOPS,N0(KOPS)       CLEAR HI ORDER BYTE           Y02669 26318802
         TM    UCMDISP,UCMDISPF    IS IT A MSG STREAM CONSOLE?          26340002
         BO    MSGSTRM             YES, INVALID TARGET           Y02669 26350002
         EJECT                                                          26366002
*********************************************************************** 26366102
*                                                                     * 26366402
*               PRIME REGS FOR NN SYNTEX CHECKING                Y02669 26366502
*    ON ENTRY K A,DIGIT HAS BEEN VALIDITY CHECKED                Y02669 26366602
*                                                                     * 26366702
*    NOTE: DIGITS CAN BE ONLY 1 OR 2 DIGITS LONG, RANGING FROM 4 Y02669 26373202
*          TO MESSAGE AREA SIZE IN VALUE                         Y02669 26378702
*          2260 - 8; 2250 - 63                                   Y02669 26378802
*    ERR - IEE156I INVALID OPERAND - IF DIGIT INVALID            Y02669 26379102
*                                                                     * 26380202
*********************************************************************** 26386802
         SPACE 2                                                        26388802
         SR    R0,R0               CLEAR REG FOR TOTAL COUNTER   Y02669 26438802
         SR    R1,R1               CLEAR REG FOR NUMBER OF AREAS Y02669 26440802
         LA    R6,XASAVSTD         GET ADDR OF SAVE LENGTHS AREA Y02669 26442802
         LA    KOPS,N2(KOPS)       BUMP POINTER BEYOND COMMA     Y02669 26700002
         ST    KOPS,XASAVLOC       SAVE OP PTR FOR IEE924I(ERROR)Y02669 26750002
LLLOOP   EQU   *                                                        26900001
         XC    XAX(N8),XAX         CLEAR PACKING AREA            Y02669 27100002
         TM    N0(KOPS),DIGIT      IS 1ST CHAR A DIGIT?          Y02669 27170002
         BNO   BADKOP              NO - IEE156I INVALID OPERAND         27180002
         CLI   N1(KOPS),BLANK      IS 2ND CHAR A BLANK?                 27200002
         BE    ONEDIGIT            NO, 1 DIGIT LENGTH                   27300002
         CLI   N1(KOPS),COMMA      IS 2ND CHAR A COMMA?                 27400002
         BE    ONEDIGIT            YES, 1 DIGIT LENGTH                  27450002
         TM    N1(KOPS),DIGIT      IS 2ND CHAR A DIGIT?                 27452002
         BNO   BADKOP              NO, IEE156I INVALID OPERAND          27454002
         CLI   N2(KOPS),BLANK      IS 3RD CHAR A BLANK?                 27460002
         BE    TWODIGIT            NO, 2 DIGIT LENGTH                   27500002
         CLI   N2(KOPS),COMMA      IS 3RD CHAR A COMMA?                 27550002
         BE    TWODIGIT            YES, 2 DIGIT LENGTH                  27560002
         B     BADKOP              NO, IEE156I INVALID OPERAND          27570002
         EJECT                                                          27580002
*********************************************************************** 27582002
*                                                                     * 27590002
*                  PACK AND CONVERT TO BINARY                         * 27592002
*     BUMP OPERAND POINTER TO CHARACTER FOLLOWING LAST VALID DIGIT    * 27592402
*                                                                     * 27594002
*********************************************************************** 27596002
ONEDIGIT EQU   *                                                        27600001
         MVC   XAX+N7(N1),N0(KOPS) MOVE THE DIGIT                Y02669 28000002
         LA    KOPS,N1(KOPS)       BUMP POINTER TO NEXT NN              28100002
         B     GOPACK              GO PACK IT                           28200001
TWODIGIT EQU   *                                                        28400001
         MVC   XAX+N6(N2),N0(KOPS) MOVE THE DIGIT                Y02669 28500002
         LA    KOPS,N2(KOPS)       BUMP POINTER TO NEXT NN              28600002
GOPACK   EQU   *                                                        28800001
         PACK  XAX+N4(N4),XAX+N4(N4)  PACK NUMBER                Y02669 28900002
         NI    XAX+N7,SIGN         CONVERT FOX TO CHARLIE        Y02669 29000002
         SR    R5,R5               CLEAR REG                     Y02669 29050002
         CVB   R5,XAX              CONVERT IT TO A BINARY NUMBER Y02669 29200002
*********************************************************************** 29210002
*                                                                     * 29250002
*    IF NUMBER GREATER THAN MSG AREA = IEE924I - SCREEN SIZE EXCEEDED * 29260002
*    IF NUMBER LESS THAN FOUR = IEE924I - AREA TOO SMALL              * 29270002
*    IF TOTAL NUMBER GREATER THAN MSG AREA = IEE924I - AREA TOO SMALL * 29280002
*                                                                     * 29290002
*********************************************************************** 29340002
         CH    R5,DCMRMSAL         IS NN GREATER THAN MSG AREA?         29400002
         BH    TOOBIG              YES-IT'S AN ERROR             Y02669 29500002
         CH    R5,FOUR             IS IT LESS THAN FOUR?         Y02669 29700002
         BL    TOOSMALL            YES--IT'S AN ERROR            Y02669 29800002
         AR    R0,R5               ADD TO LINE COUNTER                  30200001
         CH    R0,DCMRMSAL         DOES LINE COUNT EXCEED MAX. NUMBER?  30300002
         BH    TOOBIG              YES--IT'S AN ERROR            Y02669 30400002
         STC   R5,N0(R6)           SAVE AREA LENGTH                     30600002
         LA    R6,N1(R6)           BUMP LENGTH SAVE AREA POINTER        30700001
         LA    R1,N1(R1)           BUMP AREA COUNTER                    30800001
         CLI   N0(KOPS),BLANK      ANY MORE DIGITS?                     31300002
         BE    NOMORELL            NO                            Y02669 31400002
         CLI   N0(KOPS),COMMA      NEXT CHAR COMMA?              Y02669 31402002
         BNE   BADKOP              NO, IEE156I                   Y02669 31404002
         LA    KOPS,N1(KOPS)       BUMP POINTER BEYOND COMMA     Y02669 31404402
         B     LLLOOP              CHECK NEXT OPERAND            Y02669 31404802
         EJECT                                                          31406002
NOMORELL EQU   *                                                        31570002
         LTR   SACBPT,SACBPT       ANY SACB'S DEFINED?                  31600002
         BZ    ENDLL               NO - SKIP NEXT 2 LOOPS               31700001
         SPACE 2                                                        32950002
*********************************************************************** 33410002
*                                                                     * 33450002
*    THE FOLLOWING CODE CHECK THAT SACBS ARE REDEFINED ONLY           * 33500002
*    IF THERE IS NO DISPLAY IN OR ABOVE AREAS                         * 33600002
*    IF SACB HAS DIFFERENT LENGTH THAN THE REDEFINITION LENGTH   Y02669 33610002
*    ERR - IEE924I DISPLAY IN OR ABOVE AREA                      Y02669 33620002
*                                                                     * 33650002
*********************************************************************** 33660002
         SPACE 2                                                        33670002
         LA    R6,XASAVSTD         GET POINTER TO AREA LENGTHS   Y02669 33680002
TSTNXTBL EQU   *                                                        33700001
         CLC   DCMAID(N1),DCMTOPDS IS BLOCK ABOVE USED AREA?     Y02669 33950002
         BH    BUMP                NO - COMPARE LENGTHS          Y02669 34000002
COMPLL   EQU   *                                                        34500001
         CLC   DCMALN+N1(N1),N0(R6) YES- ARE LENGTHS THE SAME?   Y02669 34600002
         BNE   ERROR               IF NOT THE SAME IT'S AN ERROR        34700001
BUMP     EQU   *                                                        34800001
         ICM   SACBPT,N7,DCMACBNX+1   IS THERE ANOTHER AREA?     Y02669 35000002
         BZ    ENDLL               NO, LAST SACB INSPECTED              35200002
         LA    R6,N1(R6)           BUMP LENGTHS POINTER          Y02669 35400002
         B     TSTNXTBL            DECRE PTR AND CHK NEXT BLOCK  Y02669 35500002
         EJECT                                                          35550002
*********************************************************************** 35600002
*    ALL THE SACBS HAVE BEEN INSPECTED- INITIALIZE TO DESIRED LENGTH  * 35700002
*    PRIME POINTERS TO ID TABLE, SACB CHAIN START AND LOAD SIZE OF    * 35750002
*    SCREEN                                                           * 35760002
*********************************************************************** 35810002
ENDLL    EQU   *                                                        36000001
         LA    R3,TABLE            LOAD ADDR OF AREA ID TABLE    Y02669 36100002
         LA    R6,XASAVSTD         GET POINTER TO LENGTHS        Y02669 36200002
         L     SACBPT,DCMADSDS     GET ADDRESS OF FIRST SACB            36300002
         LA    R5,DCMADSDS         SAVE ADDR OF CHAIN ORIGIN     Y02669 36400002
         LH    R4,DCMRMSAL         LOAD SIZE OF MSG AREA                36600001
         LA    R4,N1(R4)           BUMP IT BY ONE                       36700001
*********************************************************************** 36710002
*                                                                     * 36750002
*     IF SACB DEFINED AND IN USE, IGNORE IT                           * 36760002
*     IF SACB DEFINED AND NOT IN USE, REINITIALIZE IT                 * 36762002
*     IF NO SACB IS DEFINED, ISSUE GETMAIN AND INITIALIZE IT          * 36764002
*                                                                     * 36770002
*********************************************************************** 36820002
INCORE2  EQU   *                                                        36900001
         LTR   SACBPT,SACBPT       ANY AREA DEFINED?                    37000002
         BZ    GETCORE             NO--GETMAIN MORE SACB'S              37100002
         TM    DCMAFLG1,DCMADISP   IS SACB BEING USED?                  37300002
         BO    NOINIT              YES                           Y02669 37400002
         BAL   R15,SACBINIT        GO INITIALIZE SACB            Y02669 37500002
         B     INCORE              CONTINUE SACB INITIALIZATION  Y02669 37600002
NOINIT   EQU   *                                                 Y02669 37700002
         BCTR  R3,N0               DECREMENT TABLE ID POINTER    Y02669 37900002
         LA    R6,N1(R6)           INCREMENT LL LENGTH POINTER   Y02669 38000002
         SR    R4,R4               INIT STARTING POINT TO               38050002
         IC    R4,DCMATOP          CALCULATE TOP ROW NO.                38060002
         LR    R5,SACBPT           UPDATE PTR TO PREVIOUS BLOCK  Y02669 38100002
INCORE   EQU   *                                                        38300001
         MVC   DCMTOPAR,DCMAID        MOVE TOP SACB AREA ID TO @ZA06491 38350003
         L     SACBPT,N0(SACBPT)   LOAD ADDR OF NEXT SACB               38400001
         BCT   R1,INCORE2          DECR. SACB LL COUNT                  38600001
FREEXTRA EQU   *                                                 YM1912 38620002
         LTR   SACBPT,SACBPT       ARE THERE ANY NOT REDEFINED?  YM1912 38640002
         BZ    ALLDONE             NO, OK TO CONTINUE            YM1912 38660002
         TM    DCMASACB,DCMAGM     IS IT A GETMAINED SACB?     @ZA06491 38662003
         BO    FREESACB            YES, GO FREEMAIN IT         @ZA06491 38664003
         XC    DCMACLR(DCMCLRLN),DCMACLR RE-INITIALIZE SACB    @ZA06491 38666003
         NI    DCMASACB,XFF-DCMAUSE TURN OFF IN-USE BIT        @ZA06491 38668003
         XC    DCMALN(N2),DCMALN   ZERO OUT SACB LENGTH FIELD  @ZA06491 38670003
         LR    R5,SACBPT           SAVE PREVIOUS BLOCK PTR     @ZA06491 38672003
         L     SACBPT,N0(SACBPT)   LOAD ADDR OF NEXT SACB      @ZA06491 38682003
         B     FREEXTRA            LOOP TIL ALL UNUSED ARE FREED YM1912 38730002
ALLDONE  EQU   *                                                 Y02669 38750002
         LR    SACBPT,R5           RESTORE PT TO LAST BLOCK      Y02669 38800002
         B     ZAPSACB                                                  38900001
         EJECT                                                          39750002
*********************************************************************** 39800002
*    GET CORE FOR MULTI SACB'S AND INITIALIZE THEM                    * 39810002
*    BRANCH ENTRY TO GETMAIN USED SINCE LOCKS NEED TO BE HELD         * 39818002
*      REGISTERS DESTROYED: 0, 1, 3, 4, 7, 14, 15                     * 39826002
*      INPUT INFORMATION: R4 POINTS TO CURRENT TCB                    * 39834002
*                         R7 (SACBPT) POINTS TO CURRENT ASCB          * 39842002
*********************************************************************** 39850002
GETCORE  EQU   *                                                        40800001
         ST    R1,XASTSAVE         SAVE SACB COUNT               Y02669 40810002
         LA    R9,DCMACBSZ         LOAD BYTE COUNT WANTED        Y02669 40820002
         M     R8,XASTSAVE         MULTIPLY SACB COUNT BY SIZE   Y02669 40830002
         STM   R3,R4,XASAVLOC      SAVE ACROSS GETMAIN           Y02651 40840002
         L     R4,PTRCVT           GET ADDRESS OF CVT            Y02651 40850002
         USING CVTSECT,R4          ADDRESSABILITY OF CVT         Y02651 40900002
         L     R4,CVTTCBP          GET ADDRESS OF TCBS & ASCBS   Y02651 40950002
         DROP  R4                                                Y02651 40952002
         USING TCBASCB,R4          ADDRESSABILITY OF IEFPTRS     Y02651 40960002
         L     SACBPT,ASCBPTR      ADDRESS OF ASCB FOR INTERFACE Y02651 41000002
         L     R4,TCBPTR           ADDRESS OF TCB FOR INTERFACE  Y02651 41050002
         GETMAIN RC,LV=(9),SP=SP241,BRANCH=YES                   Y02651 41060002
         LTR   R15,R15             TEST RETURN CODE              Y02669 41700002
         BNZ   MSG931              ERROR NO CORE                 Y02669 41800002
         LM    R3,R4,XASAVLOC      RESTORE AFTER GETMAIN         Y02651 41850002
         LR    SACBPT,R1           LOAD ADDR OF SACB CORE        Y02669 42300002
         L     R1,XASTSAVE         RESTORE SACB COUNTER          Y02669 42400002
         B     INIT3               GO INITIALIZE THEM                   42500002
         EJECT                                                          43500002
INIT2    EQU   *                                                        43700001
         LA    SACBPT,DCMACBSZ(SACBPT) BUMP SACB POINTER TO NEXT Y02669 43800002
INIT3    EQU   *                                                        44100001
         OI    DCMASACB,DCMAGM     SET GETMAINED FLAG BIT IN SACB ON    44300002
         BAL   R15,SACBINIT        GO INITIALIZE SACB            Y02669 44500002
         BCT   R1,INIT2            CONTINUE SACB INITIALIZATION  Y02669 46200002
         SPACE 2                                                        46250002
ZAPSACB  EQU   *                                                        46600001
         SR    R1,R1               INITIALIZE TO ZERO          @YM2777P 46650002
         ST    R1,DCMACBNX         ZERO OUT POINTER-TO-NEXT      Y02669 46700002
         EJECT                                                          46850002
*********************************************************************** 46860002
*       GETMAIN CORE FOR AND ISSUE IEE928I                              46870002
*********************************************************************** 46880002
         SPACE 2                                                        46900001
         STM   RB,RETURN14,XASAVLOC                              Y02651 47200002
         SETLOCK RELEASE,TYPE=CMS,RELATED=(K,IEE7503D(LOCKSET))         47250002
         SETLOCK RELEASE,TYPE=LOCAL,RELATED=(K,IEE7503D(LOCKSET))       47260002
         LM    RB,RETURN14,XASAVLOC                              Y02651 47270002
         NI    XASSDS,XFF-XASSDS5                                Y02651 47280002
         LA    R1,XASAVLOC+N12    GET ADDR OF WHERE TO PUT ADDR  Y02669 47282002
         MVC   XASAVLOC(N10),GETAREA     MOVE PARM LIST TO XSA   Y02669 47284002
         ST    R1,XASAVLOC+N4     WHERE TO PUT ADDR FOR GETMAIN  Y02669 47286002
         LA    R1,XASAVLOC        ADDR OF PARM LIST FOR GETMAIN  Y02669 47288002
         GETMAIN  MF=(E,(1))                                     Y02669 47290002
         LTR   R15,R15             TEST RETURN CODE                     47300002
         BNZ   RETURN              IF NOT ZERO;MEANS NO CORE     Y02669 47350002
         SPACE                                                          47400002
         L     R6,XASAVLOC+N12     LOAD GETMAINED ADDR           Y02669 47450002
         LR    R1,R6               SAVE POINTER                         47500001
         MVC   N4(L'IEE928I,R6),IEE928I      MOVE MSG INTO GETMAINED    47550001
         LA    R6,N49(R6)          BUMP MESSAGE POINTER                 47600002
         L     SACBPT,DCMADSDS     RESET SACB PT                        47650002
NEXTSACB EQU   *                                                        48000001
         TM    DCMASACB,DCMAUSE  IS AREA IN USE?               @ZA06992 48050003
         BZ    LASTONE           IF NO, BYPASS ID IN MSG       @ZA06992 48100003
         MVC   N0(N1,R6),DCMAID    MOVE AREA ID INTO MSG                48300002
         MVI   N1(R6),COMMA        MOVE IN COMMA AFTER AREA ID          48350002
         LA    R6,N2(R6)           BUMP MESSAGE POINTER                 48400002
         ICM   SACBPT,N7,DCMACBNX+1   GET POINTER TO NEXT SACB   Y02669 48550002
         BNZ   NEXTSACB            YES-KEEP ON LOOPING                  48650002
LASTONE  EQU   *                                               @ZA06992 48700003
         BCTR  R6,N0               GET RID OF EXTRA COMMA               48850002
         SR    R4,R4               CLEAR REG                     Y02669 49050002
         IC    R4,XASCID           GET TARGET'S CONSOLE ID       Y02669 49100002
         CVD   R4,XAX              CONVERT TO DECIMAL            Y02669 49250002
         UNPK  XAX(N3),XAX+N6(N2)  UNPACK NUMBER                 Y02669 49300002
         OI    XAX+N2,DIGIT        FIX SIGN                      Y02669 49350002
         MVC   N42(N2,R1),XAX+N1   PUT CC INTO MSG               Y02669 49400002
         MVC   N0(N4,R6),DESCR5    MOVE DESCRIPTOR CODE          Y02669 49650002
         SR    R6,R1               GET LENGTH OF MSG                    49750001
         STH   R6,N0(R1)           STORE FOR WTO                        49800001
         MVI   N2(R1),MCSMASK      ID PASSED AND QUEUE BY ID FLAGS      49850001
         MVI   N3(R1),N0           ZERO SECOND MCSFLGS BYTE             49900001
         SR    R0,R0               CLEAR REG                     Y02669 49910002
         IC    R0,XAU              LOAD SOURCE DEVICE ID                49950001
         LR    R6,R1               SAVE POINTER TO PARAMETER LIST       49952001
         SPACE                                                          49960002
         WTO   MF=(E,(1))                                               50000001
         FREEMAIN R,SP=SP229,LV=N80,A=(6)                        Y02669 50020002
RETURN   EQU   *                                                 Y02669 50148002
         L     RETURN14,XAP       RESTORE RETURN REG             Y02669 50150002
         BR    RETURN14           GO BACK TO SYSTEM              Y02669 50200002
         EJECT                                                          50460001
GETAREA  GETMAIN  EC,LV=N80,A=MSG931,SP=SP229,MF=L               Y02669 50702002
         SPACE 2                                                        50702602
SACBINIT EQU   *                                                 Y02669 50703202
         ST    SACBPT,N0(R5)       SET UP CHAINING OF BLOCKS     Y02669 50703802
         XC    DCMALN(N26),DCMALN  CLEAR SACB WITH ZEROS         Y02669 50704402
         LR    R5,SACBPT           SAVE PT TO THIS BLOCK         Y02669 50705002
         MVC   DCMAID(N1),N0(R3)   MOVE AREA ID INTO SACB        Y02669 50705602
         MVC   DCMTOPAR,DCMAID     MOVE TOP SACB AREA ID INTO R@ZA06491 50705903
         BCTR  R3,N0               DECR TABLE POINTER            Y02669 50706202
         MVC   DCMALN+N1(N1),N0(R6)   MOVE LL OF AREA INTO SACB  Y02669 50706802
         LA    R6,N1(R6)           BUMP PT                       Y02669 50707402
         SH    R4,DCMALN           MINUS NO. OF LINES FOR THIS AREA     50708002
         STC   R4,DCMATOP          SAVE TOP ROW NO. OF AREA      Y02669 50708602
         OI    DCMASACB,DCMAUSE    SET IN-USE FLAG BIT ON        Y02669 50709202
         MVC   DCMAFR(N2),F0F0     INITIALIZE FRAME NO.          Y02669 50710002
         BR    R15                                               Y02669 50711002
         EJECT                                                          50712002
*********************************************************************** 50713002
* NOTE: LOCKS HELD ON ENTRY TO IEE6803D - BRANCH ENTRY TO FREEMAIN    * 50714002
*       IS NECESSARY TO DECHAIN AND FREE SACB'S                       * 50715002
*         REGISTERS DESTROYED : 0, 1, 3, 4, 7, 14, 15                 * 50716002
*         INPUT INFORMATION: R4 POINTS TO CURRENT TCB                 * 50720002
*                            R7 POINTS TO CURRENT ASCB                * 50722002
*********************************************************************** 50722202
FREESACB EQU   *                                                 YM1912 50722402
         L     R4,PTRCVT           GET ADDRESS OF CVT            YM1912 50722602
         USING CVTSECT,R4          ADDRESSABILITY FOR CVT        YM1912 50722802
         L     R4,CVTTCBP          ADDRESS OF TCBS & ASCBS       YM1912 50723002
         DROP  R4                                                YM1912 50723202
         USING TCBASCB,R4          ADDRESSABILITY FOR IEFPTRS    YM1912 50723402
         LR    R1,SACBPT           ADDR OF AREA TO FREE UP       YM1912 50723602
         L     SACBPT,N0(SACBPT)   RESET SACB POINTER            YM1912 50723802
         ST    SACBPT,XASAVSTD     SAVE DCM BASE REG             YM1912 50724002
         L     SACBPT,ASCBPTR      ADDRESS OF ASCB FOR INTERFACE YM1912 50724202
         L     R4,TCBPTR           ADDRESS OF TCB FOR INTERFACE  YM1912 50724402
         LA    R0,DCMACBSZ         PASS SACB LENGTH                     50725202
         FREEMAIN RC,LV=(0),A=(1),SP=SP241,BRANCH=YES                   50726002
         L     SACBPT,XASAVSTD     RESTORE DCM BASE REG          YM1912 50726802
         B     FREEXTRA          LOOP TIL ALL UNUSED SACBS FREE@ZA06491 50727603
         EJECT                                                          50728402
*********************************************************************** 50729202
*                                                                     * 50730002
*                          ERROR EXITS                           Y02669 50731002
*                                                                     * 50732002
*********************************************************************** 50736002
         SPACE 2                                                        50740002
TOOSMALL EQU   *                                                 Y02669 50742002
         BCTR  KOPS,N0             POINT TO BAD VALUE            Y02669 50745002
         MVI   XASTSAVE,IEE924I2   AREA TOO SMALL                Y02669 50749602
         B     ERROR2              BRANCH TO ERROR EXIT                 50749702
TOOBIG   EQU   *                                                 Y02669 50752702
         SH    KOPS,TWO            POINT TO INVALID VALUE      @YM4785P 50755702
         CLI   N0(KOPS),COMMA      POINTING TO DIGIT?            Y02669 50758702
         BNE   MSG924I3            YES, GET ERROR CODE           Y02669 50761702
         LA    KOPS,N1(KOPS)       NO, ADVANCE TO DIGIT          Y02669 50764702
MSG924I3 EQU   *                                                 Y02669 50767702
         MVI   XASTSAVE,IEE924I3   SCREEN SIZE EXCEEDED          Y02669 50770702
         B     ERROR2              BRANCH TO ERROR EXIT                 50776602
ERROR    EQU   *                                                        50782602
         MVI   XASTSAVE,IEE924I    DISPLAY IN OR ABOVE AREA      Y02669 50783002
         L     KOPS,XASAVLOC       RETRIEVE OP PTR               Y02669 50783102
ERROR2   EQU   *                                                        50783202
         MVI   XAE,IEE924          SET ON MAJOR FLAG BIT         Y02669 50788802
         B     STOREOP             STORE BAD OPERAND ADDR        Y02669 50790802
         SPACE 2                                                        50791202
MSGSTRM  EQU   *                                                 Y02669 50791602
         MVI   XAE,IEE926I         INDICATE INVALID OP                  50792802
         MVI   XASTSAVE,IEE926     INDICATE MSG STREAM OUTPUT    Y02669 50794802
         B     STOREOP                                           Y02669 50796802
         SPACE 2                                                        50798802
MSG931   EQU   *                                                        50800001
         MVI   XAE,IEE931I         CORE NOT AVAILABLE            Y02669 50850002
         B     D5603D              GO TO PUT OUT MSG             Y02669 50900002
         SPACE 2                                                        52710002
BADKOP   EQU   *                                                        52760001
         MVI   XAE,IEE156I         IEE156I INVALID OPERAND              52770002
STOREOP  EQU   *                                                        52790001
         STCM  KOPS,N7,XASOPTR     SAVE OPERAND POINTER          Y02669 52792002
D5603D   EQU   *                                                 Y02669 52796002
         L     RETURN14,XAP        RESTORE RETURN REG            Y02669 52863202
         L     R15,VCON5603                                      Y02669 52871502
         BR    R15                                               Y02669 52873102
         EJECT                                                          52893301
*********************************************************************** 53510002
*                                                                     * 53520002
*                       SACB AREA ID TABLE                       Y02669 53530002
*          NOTE: FOLLOWING TABLE IS INTERNAL TO THIS MODULE.          * 53550002
*                IT WILL BE NECESSARY TO EXPAND THIS TABLE TO    Y02669 53600002
*                TO SUPPORT MORE THAN 11 AREAS OR A SCREEN       Y02669 53602002
*                WITH MORE THAN 47 LINES.                        Y02669 53604002
*                                                                     * 53610002
*********************************************************************** 53650002
         SPACE 2                                                        53660002
         DC    C'K'                SACB AREA ID                         53700001
         DC    C'J'                SACB AREA ID                         53800001
         DC    C'I'                SACB AREA ID                         53900001
         DC    C'H'                SACB AREA ID                         54000001
         DC    C'G'                SACB AREA ID                         54100001
         DC    C'F'                SACB AREA ID                         54200001
         DC    C'E'                SACB AREA ID                         54300001
         DC    C'D'                SACB AREA ID                         54400001
         DC    C'C'                SACB AREA ID                         54500001
         DC    C'B'                SACB AREA ID                         54600001
TABLE    DC    C'A'                BOTTOM SACB AREA ID                  54700001
         EJECT                                                          54710002
*********************************************************************** 54750002
*                                                                     * 54760002
*                           CONSTANTS                            Y02669 54770002
*                                                                     * 54780002
*********************************************************************** 54790002
         SPACE 2                                                        54790402
TWO      DC    H'2'                CONSTANT                    @YM4785P 54791202
FOUR     DC    H'4'                CONSTANT                             54792002
F0F0     DC    XL2'F0F0'           AREA FRAME NUMBER ZERO               54794002
IEE928I  DC    CL45'IEE928I DISPLAY AREA ID''S FOR CONSOLE CC ARE'      54900001
DESCR5   DC    B'00001000000000000000000000000000' DESCRIPTOR CODE+RT   54950002
VCON5603 DC    V(IEE5603D)         MSG MODULE NAME               Y02669 55000002
         SPACE  5                                                       55160002
*********************************************************************** 55162002
*                                                                     * 55170002
*                           PATCH AREA                           Y02669 55180002
*                                                                     * 55190002
*********************************************************************** 55192002
         SPACE 2                                                        55194002
PATCH    DC    CL68'***PATCH AREA - IEE6803D***'                 Y01939 55200001
         EJECT                                                          55250001
         IEECUCM  FORMAT=NEW                                            56100002
         EJECT                                                          56150002
         IEERDCM                                                        56300002
         EJECT                                                          56350002
FAUXSA   DSECT                                                          56500001
         IEEXSA                                                         56600001
         EJECT                                                          56650002
CVTSECT  DSECT                                                          56700001
         CVT                                                            56800001
         EJECT                                                          56810002
         IEFPTRS                                                        56850002
         EJECT                                                          56900002
         IHAPSA                                                         56950002
         END                                                            57100001
./  ADD  SSI=53250170,NAME=IEE6903D
         TITLE 'IEE6903D SVC 34 K A COMMAND LOAD 5'                     00900002
*********************************************************************** 01000001
*                                                                     * 01050002
* MODULE NAME         =  IEE6903D                               Y02669* 01100002
*                                                                     * 01150002
* DESCRIPTIVE NAME    =  CONTROL (K) A AND T COMMAND HANDLER    Y02669* 01200002
*                                                                     * 01250002
* COPYRIGHT           =  N/A                                    Y02669* 01300002
*                                                                     * 01350002
* STATUS              =  01 - UPDATE FOR VS/2 RELEASE 3 PTF   @ZA07770* 01400003
*                                                                     * 01450002
* FUNCTION            =  HANDLES THE                            Y02669* 01460002
*                             K A            K T                Y02669* 01460502
*                             K A,REF        K A,REF            Y02669* 01461002
*                             K A,NONE       K T,UTME           Y02669* 01461502
*                        COMMANDS WHICH CAN BE HANDLED WITH-    Y02669* 01462002
*                        OUT REFERENCE TO THE TRANSIENT DCM.    Y02669* 01469002
*                        (I.E. NO DIRECT INTERFACE IS           Y02669* 01476002
*                              REQUIRED WITH DIDOCS)            Y02669* 01483002
*                                                                     * 01490002
*   OPERATION         =  THE COMMAND IS VALIDITY CHECKED.       Y02669* 01492002
*                        IF AN INVALID OPERAND IS FOUND,        Y02669* 01492102
*                        'IEE156I INVALID OPERAND' IS ISSUED.   Y02669* 01492402
*                                                                     * 01492802
*                        IF (JES3) A TASK OTHER THAN COMTASK  @Y02668P* 01492903
*                        ISSUED THE COMMAND THEN THE MESSAGE  @Y02668P* 01493003
*                        IS ISSUED VIA WTO. THE XASSDS3 BIT   @Y02668P* 01493103
*                        IN THE XSA IS CHECKED. IF IT IS ON   @Y02668P* 01493803
*                        THEN A JES3 ASSOCIATED CONSOLE       @Y02668P* 01493903
*                        ISSUED THE COMMAND                   @Y02668P* 01497603
*                                                                     * 01498203
*                        K A; K A,REF                           Y02669* 01498903
*                        ___  _______                           Y02669* 01499903
*                        IF NOT A GRAPHICS CONSOLE, MESSAGES    Y02669* 01500403
*                        'IEE929I' AND 'IEE928I' ARE ISSUED     Y02669* 01500903
*                        VIA THE WTO MACRO. THE LOCKS ARE       Y02669* 01501403
*                        RELEASED PRIOR TO THE WTO, FREEMAIN    Y02669* 01502203
*                        AND CONTROL IS RETURNED.               Y02669* 01503203
*                                                                     * 01504203
*                        IF THE CONSOLE IS CRT, THE MESSAGE     Y02669* 01504603
*                        TEXT IS MOVED INTO THE DCM INSTRUCTION Y02669* 01505003
*                        LINE, THE OPTIONS INDICATOR FOR        Y02669* 01505803
*                        MESSAGE 'IEE150I' IS SET IN THE XSA    Y02669* 01507003
*                        AND CONTROL IS GIVEN TO IEE5603D WITH  Y02669* 01507403
*                        THE LOCKS HELD.                        Y02669* 01508403
*                                                                     * 01509103
*                        K T; K T;REF                           Y02669* 01509203
*                        --- --------                           Y02669* 01509903
*                        IF NOT A GRAPHICS CONSOLE, MESSAGE     Y02669* 01511203
*                        'IEE922I' IS ISSUED VIA THE WTO MACRO. Y02669* 01511803
*                        IF NO TRACK IS ACTIVE ON THE TARGET    Y02669* 01512503
*                        CONSOLE 'IEE158I NO TRACK ACTIVE' IS   Y02669* 01513003
*                        ISSUED TO THE SOURCE CONSOLE. THE      Y02669* 01513503
*                        LOCKS ARE RELEASED PRIOR TO THE        Y02669* 01514103
*                        GETMAIN. THE WTO AND FREEMAIN ARE      Y02669* 01514803
*                        ISSUED AND CONTROL IS RETURNED.        Y02669* 01515803
*                                                                     * 01516403
*                        IF THE CONSOLE IS CRT, THE MESSAGE     Y02669* 01517103
*                        TEXT IS MOVED INTO THE DCM INSTRUCTION Y02669* 01518103
*                        LINE, THE OPTIONS INDICATOR FOR        Y02669* 01518703
*                        MESSAGE 'IEE150I' IS SET IN THE XSA    Y02669* 01519403
*                        AND CONTROL IS GIVEN TO IEE5603D WITH  Y02669* 01519903
*                        THE LOCKS HELD.                        Y02669* 01520403
*                                                                     * 01521703
*                        K A,NONE                               Y02669* 01522203
*                        --------                               Y02669* 01522703
*                        THE TARGET CONSOLE'S UCME ADDRESS      Y02669* 01523203
*                        IS FOUND BASED ON THE INDEX IN         Y02669* 01524003
*                        XASCID.  THE GETMAINED SACB'S          Y02669* 01525003
*                        ASSOCIATED WITH THAT UCME ARE THEN     Y02669* 01525503
*                        FREEMAINED.                            Y02669* 01526603
*                                                                     * 01526903
*                        IF THERE IS AN ACTIVE STATUS OR        Y02669* 01527503
*                        DYNAMIC DISPLAY IN ANY OF THE AREAS,   Y02669* 01528603
*                        'IEE924I DISPLAY IN OR ABOVE AREA' IS  Y02669* 01528903
*                        ISSUED.                                Y02669* 01529503
*                                                                     * 01530403
*                        WHEN ALL THE SACB'S ARE FREED,         Y02669* 01530903
*                        'IEE928I' IS ISSUED BY THE WTO MACRO   Y02669* 01531603
*                        AFTER THE LOCKS HAVE BEEN RELEASED.    Y02669* 01532303
*                        CONTROL IS THEN RETURNED.              Y02669* 01533203
*                                                                     * 01534203
*                        K T,UTME=                              Y02669* 01534703
*                        ---------                              Y02669* 01535203
*                        THE TARGET CONSOLE'S UCME ADDRESS IS   Y02669* 01536203
*                        FOUND BASED ON THE INDEX IN XASCID.    Y02669* 01536703
*                        THE SACB'S ARE SEARCHED FOR AN AREA    Y02669* 01537203
*                        WITH AN ACTIVE TRACK DISPLAY. IF NONE  Y02669* 01538203
*                        IS FOUND 'IEE158I' IS ISSUED. OTHER-   Y02669* 01539203
*                        WISE THE NEW TIME INTERVAL VALUE IS    Y02669* 01539703
*                        STORED IN THE SACB, THE LOCKS          Y02669* 01540203
*                        RELEASED AND CONTROL RETURNED.         Y02669* 01541203
*                                                                     * 01541703
* NOTES                                                         Y02669* 01542203
*                                                                     * 01543203
*   CHARACTER-CODE                                              Y02669* 01543903
*    DEPENDENCIES     =  ANY CHARACTER CODE OTHER THAN EBCDIC   Y02669* 01544603
*                        WILL REQUIRE REASSEMBLY OF THIS MODULE.Y02669* 01545303
*                        NOTE: THIS MODULE USES CHARACTER       Y02669* 01546003
*                        REPRESENTATIONS FOR BLANK AND COMMA.   Y02669* 01546703
*                                                                     * 01547403
*   DEPENDENCIES      =  IEE7503D WILL ENSURE THAT ALL TARGET   Y02669* 01548103
*                        CONSOLES ARE CRT DEVICES.              Y02669* 01548803
*                                                                     * 01549503
*   RESTRICTIONS      =  THE TARGET CONSOLE MUST BE A GRAPHICS  Y02669* 01550203
*                        DEVICE.                                Y02669* 01550903
*                                                                     * 01551603
*   REGISTER                                                    Y02669* 01552303
*    CONVENTIONS      =  NONE                                   Y02669* 01553202
*                                                                     * 01563202
*   PATCH-LABEL       =  PATCH                                  Y02669* 01565202
*                                                                     * 01565602
* MODULE TYPE         =  CSECT                                  Y02669* 01566002
*                                                                     * 01566402
*   PROCESSOR         =  N/A                                    Y02669* 01566502
*                                                                     * 01566602
*   MODULE SIZE       =  X'581' + X'41' PATCH AREA              Y02669* 01577702
*                                                                     * 01587702
*   ATTRIBUTES        =  REFRESHABLE, REENTRANT, SUPERVISOR     Y02669* 01588102
*                        MODE, KEY 0, PAGED LPA                 Y02669* 01588302
*                                                                     * 01588602
* ENTRY POINT         =  IEE6903D FROM IEE6703D                 Y02669* 01593302
*   PURPOSE           =  TO PROCESS THE K A AND K A,REF AND     Y02669* 01593402
*                        K A,NONE AND K T AND K T,REF AND       Y02669* 01594402
*                        K T,UTME COMMANDS                      Y02669* 01595802
*   LINKAGE           =  BRANCH                                 Y02669* 01596402
*   INPUT DATA        =  REG 2 POINTS TO THE XSA                Y02669* 01597002
*                           XAL - POINTS TO COMMAND BUFFER      Y02669* 01598802
*                           XAS - L=CCA INFORMATION             Y02669* 01599802
*                           XASSDS3-ON IF CMD ISSUED FROM     @Y02668P* 01600103
*                                   A MEMORY OTHER THAN       @Y02668P* 01601103
*                                   COMTASK (JES3)            @Y02668P* 01602103
*                           XASSDS5 ON - LOCKS HELD             Y02651* 01603103
*                           XAU - ISSUING CONSOLE ID            Y02669* 01604803
*                        REG 14 CONTAINS THE RETURN ADDRESS     Y02669* 01606803
*                                                                     * 01607803
*   REGISTERS SAVED   =  REG 2 IS UNTOUCHED                     Y02669* 01610803
*                        REG 14 IS SAVED IN XSA (XAP)           Y02669* 01611803
*                        REG 11-14 SAVED BEFORE ISSUING         Y02651* 01612803
*                                  SETLOCK AT FREELOCK          Y02651* 01613803
*                                                                     * 01614803
*   REGISTER CONTENTS                                           Y02669* 01615803
*    DURING PROCESSING=  R0 - WORK REGISTER                     Y02669* 01616803
*                        R1 - WORK REGISTER                     Y02669* 01622102
*                        R2 - BASE REG FOR XSA                  Y02669* 01632102
*                        R3 - BASE REG FOR UCM                  Y02669* 01642102
*                        R4 - POINTS TO COMMAND OPERANDS        Y02669* 01644102
*                        R5 - SUBROUTINE BRANCH REG             Y02669* 01646102
*                        R6 - WORK REGISTER                     Y02669* 01648102
*                        R7 - WORK REGISTER                     Y02669* 01656702
*                        R8 - BASE REG FOR UCME                 Y02669* 01658702
*                        R9 - BASE REG FOR TRANSIENT DCM        Y02669* 01660702
*                        R10- BASE REG FOR RESIDENT DCM         Y02669* 01662702
*                        R11- SUBROUTINE BRANCH REG             Y02669* 01664702
*                        R12- BASE REG FOR SACB                 Y02669* 01665102
*                        R13- BASE REG FOR THIS MODULE          Y02669* 01665202
*                        R14- SUBROUTINE BASE REG               Y02669* 01665302
*                        R15- WORK REGISTER                     Y02669* 01665402
*                                                                     * 01674002
*   REGISTERS RESTORED=  REG 14 RESOTRED AT EXIT AND D5603D     Y02669* 01676002
*                        REG 11-14 RESTORED AFTER SETLOCK AT    Y02651* 01676102
*                                  FREELOCK.                    Y02651* 01678002
*                                                                     * 01680002
*  *  *  *  *  *  *  *  *  *  *  *  *  *  *  *  *  *  *  *  *  *  *   * 01680802
*                                                                     * 01682402
* EXIT - NORMAL       =  RETURN VIA BR 14 FROM RETURN           Y02669* 01684402
* 1 CONDITIONS        =  FOR K A & K A,REF & K T & K T,REF &    Y02669* 01686402
*                        K T,UTME                               Y02669* 01688402
*   OUTPUT            =  SACB INFORMATION IS DISPLAYED IN THE   Y02669* 01690402
*                        ENTRY AREA IF SOURCE IS A CRT DEVICE   Y02669* 01692402
*                        OTHERWISE, IT IS ISSUED VIA A WTO      Y02669* 01694402
*                        REG 2 POINTS TO XSA                    Y02669* 01696402
*                            XASSDS5 RESET TO ZERO - LOCKS      Y02651* 01706402
*                                    RELEASED                   Y02651* 01708402
*   RETURN CODES      =  NONE                                   Y02669* 01712802
* 2 CONDITIONS        =  FOR K A,NONE                           Y02669* 01714802
*   OUTPUT            =  ALL GETMAINED SACB'S ARE FREED         Y02669* 01715202
*                        REG 2 POINTS TO XSA                    Y02669* 01715302
*                            XASSDS5 RESET TO ZERO - LOCKS      Y02651* 01715402
*                                    RELEASED                   Y02651* 01715502
*   RETURN CODES      =  NONE                                   Y02669* 01715602
*                                                                     * 01716102
*  *  *  *  *  *  *  *  *  *  *  *  *  *  *  *  *  *  *  *  *  *  *   * 01718102
*                                                                     * 01720102
* EXIT - NORMAL       =  BRANCH TO IEE5603D FROM D5603D         Y02669* 01726102
*   CONDITIONS        =  TO ISSUE MESSAGE 'IEE150I CHANGE       Y02669* 01728102
*                        OPTIONS' FOR A CRT DEVICE ALONG        Y02669* 01728202
*                        WITH K A,LL OR K T,UTME MESSAGE IN     Y02669* 01728302
*                        THE INSTRUCTION LINE                   Y02669* 01728402
*   OUTPUT DATA       =  MESSAGE IN INSTRUCTION LINE OF DCM     Y02669* 01728502
*                        REG 2 - POINTS TO XSA                  Y02669* 01768502
*                          XAE CONTAINS X'02'                   Y02669* 01808502
*                          XASOPTR CONTAINS CURSOR POINTER      Y02669* 01848502
*                           XASSDS5 - ON LOCKS HELD             Y02651* 01888502
*   RETURN CODES      =  NONE                                   Y02669* 01928502
*                                                                     * 01968502
*  *  *  *  *  *  *  *  *  *  *  *  *  *  *  *  *  *  *  *  *  *  *   * 02048502
*                                                                     * 02088502
* EXIT - ERROR        =  BRANCH TO IEE5603D FROM D5603D         Y02669* 02128502
*   CONDITIONS        =  TO ISSUE ERROR MESSAGES                Y02669* 02168502
*   OUTPUT DATA       =  ERROR CODES FOR MESSAGES TO BE         Y02669* 02208502
*                        ISSUED BY IEE5603D AND IEE5903D        Y02669* 02248502
*   RETURN CODES      =  REG 2 POINTS TO XSA                    Y02669* 02288502
*                           XAE WILL CONTAIN AN INDEX FOR THE   Y02669* 02328502
*                           MAJOR MESSAGE FOR IEE5603D:         Y02669* 02368502
*                              X'04' - IEE156I INVALID OPERAND  Y02669* 02448502
*                              X'05' - IEE158I K REQUEST        Y02669* 02488502
*                                              INCONSISTENT     Y02669* 02528502
*                              X'0A' - IEE924I INVALID AREA     Y02669* 02568502
*                                              DEFINITION       Y02669* 02608502
*                              X'0E' - IEE931I INSUFFICIENT     Y02669* 02648502
*                                      STORAGE FOR COMMAND      Y02669* 02688502
*                           XASTSAVE WILL CONTAIN AN INDEX FOR  Y02669* 02728502
*                           THE MINOR MESSAGE FOR IEE5903D:     Y02669* 02768502
*                            IEE924I INVALID AREA DEFINITION    Y02669* 02808502
*                              X'11' - DISPLAY IN OR ABOVE AREA Y02669* 02848502
*                            IEE158I K REQUEST INCONSISTENT     Y02669* 02888502
*                              X'1E' - NO TRACK ACTIVE          Y02669* 02928502
*                           XASSDS5 ON LOCKS HELD               Y02651* 02968502
*                                                                     * 03008502
*  *  *  *  *  *  *  *  *  *  *  *  *  *  *  *  *  *  *  *  *  *  *   * 03048502
*                                                                     * 03088502
* EXTERNAL REFERENCES                                           Y02669* 03128502
*                                                                     * 03168502
*   ROUTINES          =  IEE5603D/IEE5903D                      Y02669* 03208502
*                                                                     * 03248502
*   DATA AREAS        =  NONE                                   Y02669* 03288502
*                                                                     * 03328502
*   CONTROL BLOCKS    =  CVT      R - ADDRESS UCM               Y02669* 03368502
*                        IEEXSA   R - INPUT                     Y02669* 03408502
*                                 W - ERROR MESSAGE CODES       Y02669* 03448502
*                        IEECUCM  R - ADDRESS DCM               Y02669* 03488502
*                        IEETDCM  R - INSTRUCTION LINE INFO     Y02669* 03528502
*                                 W - FILL IN INSTRUCTION LINE  Y02669* 03568502
*                        IEERDCM  R - ADDRESS SACB              Y02669* 03608502
*                          (SACB) R - GET INFO FOR MESSAGE      Y02669* 03648502
*                                 W - INITIALIZE                Y02669* 03688502
*                                 F - WHEN AREAS ARE DELETED    Y02669* 03728502
*                        IHAPSA   NECESSARY FOR SETLOCKS        Y02651* 03768502
*                        IEFPTRS  R - ADDRESS ASCB & TCB FOR    Y02651* 03808502
*                                     BRANCH ENTRIES            Y02651* 03848502
*                                                                     * 03888502
*   TABLES            =  NONE                                   Y02669* 03968502
*                                                                     * 04008502
*   MACROS            =  GETMAIN  SP 229 FOR WTO BUFFERS        Y02669* 04048502
*                        FREEMAIN SP 229 FOR WTO BUFFERS        Y02669* 04088502
*                        BRANCH ENTRY GETMAIN SP229 WTO BUFFERS Y02651* 04128502
*                        BRANCH ENTRY FREEMAIN SP241 SACB'S     Y02651* 04168502
*                        WTO                                    Y02669* 04208502
*                        SETLOCK - CMS AND LOCAL LOCKS RELEASED Y02651* 04248502
*                                                                     * 04288502
*   ENQUEUE RESOURCES =  NONE                                   Y02669* 04328502
*                                                                     * 04368502
*   LOCKS HELD        =  CMS AND LOCAL LOCKS OBTAINED IN        Y02651* 04408502
*                        IEE7503D ARE RELEASED AND XASSDS5 IS   Y02651* 04448502
*                        RESET BEFORE RETURNING AT RETURN.      Y02651* 04488502
*                        OTHERWISE THEY ARE RELEASED IN         Y02651* 04528502
*                        IEE5603D OR IEE5903D.                  Y02651* 04568502
*                                                                     * 04608502
*   CHANGE LEVEL      =  Y02669                                 Y02669* 04648502
*                        Y02651                                 Y02651* 04688502
*                        Y02668 - JES3 SUPPORT                @Y02668P* 04698503
*                        YM1911  (PROLOGUE & COMMENT CHANGES)   YM1911* 04708502
*                        @ZA07770 TIME INTERVAL TO 10 SEC     @ZA07770* 04718503
*                                                                     * 04728502
* MESSAGES            =  THE FOLLOWING MESSAGES ARE CONTAINED   Y02669* 04736502
*                        IN AND ISSUED FROM THIS MODULE:        Y02669* 04744502
*                                                                     * 04752502
*                        FOR K A,NONE: (MSG STRM-CRT & NON-CRT) Y02669* 04760502
*                         IEE928I DISPLAY AREA ID'S FOR CONSOLE Y02669* 04768502
*                                 'CC' ARE NONE                 Y02669* 04788502
*                        FOR K A & K A,REF: (NON-CRT)           Y02669* 04808502
*                         IEE929I K A,LL,LL...,L=CC             Y02669* 04848502
*                         IEE928I DISPLAY AREA ID'S FOR CONSOLESY02669* 04868502
*                                 'CC' ARE A,B...               Y02669* 04888502
*                                           (CRT-ENTRY AREA)    Y02669* 04908502
*                     *   K A,LL,LL...                          Y02669* 04928502
*                        FOR K T & K T,REF: (NON-CRT)           Y02669* 04948502
*                         IEE922I K T,UTME=XXX,L=CC             Y02669* 04968502
*                                           (CRT-ENTRY AREA)    Y02669* 04970502
*                     *   K T,UTME=XXX                          Y02669* 04972502
*                        THE FOLLOWING MESSAGES ARE CONTAINED   Y02669* 04974502
*                        IN AND ISSUED FROM IEE5603D & IEE5903D:Y02669* 04976502
*                         MSGID  CODE  MOD MESSAGE TEXT         Y02669* 04978502
*                         _____  ____  ___ ____________         Y02669* 04980502
*                        IEE150I X'02' 56  CHANGE OPTIONS,      Y02669* 04982502
*                                          IF DESIRED           Y02669* 04984502
*                          (ACCOMPANIES MESSAGES MARKED *)      Y02669* 04986502
*                        IEE156I X'04' 56  INVALID OPERAND      Y02669* 04988502
*                        IEE158I X'05' 56  K REQUEST            Y02669* 04990502
*                                            INCONSISTENT       Y02669* 04992502
*                                X'1E' 59  NO TRACK ACTIVE      Y02669* 04994502
*                        IEE924I X'0A' 56  INVALID AREA         Y02669* 04996502
*                                            DEFINITION         Y02669* 05008502
*                                X'11' 59  DISPLAY IN OR ABOVE  Y02669* 05011502
*                                            AREA               Y02669* 05014502
*                        IEE931I X'0E' 56  INSUFFICIENT STORAGE Y02669* 05017502
*                                            FOR COMMAND        Y02669* 05020502
*                                                                     * 05023502
* SYSGEN              =  INCLUDED WITH SVC 34 IN LOAD MODULE    Y02669* 05026502
*                        IGC0003D, DLIB AOSB3, MACRO SGCIEF441, Y02669* 05029502
*                        TARGLIB LPALIB.                        Y02669* 05032502
*                                                                     * 05035502
* SYSTEM LIBRARIES    =  NONE                                   Y02669* 05038502
*                                                                     * 05041502
*********************************************************************** 05048502
         EJECT                                                          05400001
IEE6903D CSECT                                                          05450002
* C- 301100                                                    @ZM30462 05470003
* PACK(C), CONSTANTS(C)                                        @ZA07770 05480003
*********************************************************************** 05500001
*                                                                     * 05600002
*                             REGISTERS                               * 05700002
*                                                                     * 05800002
*********************************************************************** 05900001
R0       EQU   0                   WORK REG                             07200001
R1       EQU   1                   WORK REG                             07300001
PARMREG  EQU   2                   INPUT BASE REG FOR XSA               07350002
UCMBASE  EQU   3                   UCM BASE REG                  Y02651 07400002
KOPS     EQU   4                   OPERAND POINTER                      07560002
R4       EQU   4                   WORK REG                             07570002
R5       EQU   5                   SUBROUTINE BRANCH REG                07600002
R6       EQU   6                   WORK REG                             07700001
R7       EQU   7                   WORK REG                      Y02651 07850002
UCMEBASE EQU   8                   UCM ENTRY BASE REG                   07860002
TDCMBASE EQU   9                   TRANSIENT DCM BASE REG               07870002
RDCMBASE EQU   10                  RESIDENT DCM BASE REG                07880002
RA       EQU   10                  PART OF EVEN ODD PAIR         Y02669 07882002
RB       EQU   11                  SUBROUTINE BRANCH REG                07890002
SACBPT   EQU   12                  SACB BASE REG                 Y02651 07892002
MYBASE   EQU   13                  THIS MODULE'S BASE REG               07894002
RE       EQU   14                  SUBROUTINE BRANCH REG         Y02669 07896002
R15      EQU   15                  CODE REG                      Y02669 08000002
         EJECT                                                          08200001
*********************************************************************** 08250002
*                                                                     * 08260002
*                    MESSAGE FLAG BIT SETTINGS                        * 08300002
*                                                                     * 08350002
*********************************************************************** 08360002
IEE150I  EQU   X'02'               MAJOR - WRITE OPTIONS MSG     Y02669 08400002
IEE156I  EQU   X'04'               MAJOR - INVALID OPERAND       Y02669 08450002
IEE158I  EQU   X'05'               MAJOR- K REQUEST INCONSISTENT Y02669 08452002
IEE158   EQU   X'1E'                 NO TRACK ACTIVE             Y02669 08454002
IEE924I  EQU   X'0A'               MAJOR - INVALID AREA DEFIN.   Y02669 08460002
IEE924   EQU   X'11'                 DISPLAY IN OR ABOVE AREA    Y02669 08470002
IEE931I  EQU   X'0E'               MAJOR - INSUF. STOR. FOR CMD  Y02669 08850002
*********************************************************************** 08900002
*                                                                     * 08950002
*                          EQUATES                                    * 09000002
*                                                                     * 09050002
*********************************************************************** 09060002
N0       EQU   0                   FIELD INCREMENT                      09200001
N1       EQU   1                   FIELD INCREMENT                      09300001
N2       EQU   2                   FIELD INCREMENT                      09400001
N3       EQU   3                   FIELD INCREMENT                      09500001
N4       EQU   4                   FIELD INCREMENT                      09600001
N5       EQU   5                   FIELD INCREMENT               Y02669 09650002
N6       EQU   6                   FIELD INCREMENT                      09800001
N7       EQU   7                   FIELD INCREMENT + ICM MASK    Y02669 09900002
N8       EQU   8                   FIELD INCREMENT + ICM MASK    Y02669 10000002
N9       EQU   9                   FIELD INCREMENT               Y02669 10002002
N10      EQU   10                  FIELD INCREMENT               Y02669 10010002
N12      EQU   12                  FIELD INCREMENT               Y02669 10050002
N13      EQU   13                  FIELD INCREMENT               Y02669 10052002
N15      EQU   15                  FIELD INCREMENT               Y02669 10060002
N16      EQU   16                  FIELD INCREMENT               Y02669 10062002
N17      EQU   17                  FIELD INCREMENT               Y02669 10070002
N20      EQU   20                  FIELD INCREMENT               Y02669 10080002
N24      EQU   24                  FIELD INCREMENT               Y02669 10090002
N28      EQU   28                  FIELD INCREMENT               Y02669 10092002
N32      EQU   32                  FIELD INCREMENT               Y02669 10094002
N33      EQU   33                  FIELD INCREMENT               Y02669 10096002
N42      EQU   42                  FIELD INCREMENT                      10100001
N49      EQU   49                  FIELD INCREMENT                      10200001
N80      EQU   80                  FIELD SIZE                           10250002
*********************************************************************** 10360002
*                                                                     * 10370002
*                    CHARACTER CONSTANTS                              * 10380002
*                                                                     * 10390002
*********************************************************************** 10392002
BLANK    EQU   C' '                BLANK CHAR                           10600001
COMMA    EQU   C','                COMMA CONSTANT                       10650002
ZERO     EQU   X'00'               CONSTANT                             10700002
         EJECT                                                          10720002
*********************************************************************** 10750002
*                                                                     * 10800002
*                    MASKS AND OTHER EQUATES                          * 10850002
*                                                                     * 10860002
*********************************************************************** 10870002
DIGIT    EQU   X'F0'               CONSTANT                      Y02669 10900002
SIGN     EQU   X'FC'               CONVERT EBCDIC TO SIGN        Y02669 10910002
XFF      EQU   255                 FIELD INCREMENT               Y02669 10950002
PTRCVT   EQU   16                  CVT ADDR                             11000002
NOHDCPY  EQU   X'04'               BIT TO SIGNIFY NO HARD COPY   Y02669 11050002
MCSMASK  EQU   X'41'               ID PASSED + QUEUE BY ID              11200001
SP229    EQU   229                 SUBPOOL FOR WTO BUFFER        Y02669 11250002
SP241    EQU   241                 SUBPOOL FOR SACB'S            Y02669 11300002
         EJECT                                                          11600001
*********************************************************************** 11700001
*                                                                     * 11800002
*                   ESTABLISH ADDRESSABILITY                          * 11900002
*                                                                     * 12000002
*           ON ENTRY, REGISTER 2 CONTAINS ADDRESS OF XSA              * 12400002
*                                                                     * 12500002
*********************************************************************** 12650002
         SPACE 2                                                        12660002
         BALR  MYBASE,N0           ESTABLISH ROUTINE 'S                 12700001
         USING *,MYBASE            BASE REGISTER                        12800001
         MODID BRANCH=YES                                        Y01886 12850001
         USING FAUXSA,PARMREG      ESTABLISH XSA ADDRESSABILITY         12900001
         L     UCMBASE,PTRCVT      GET CVT POINTER               Y02669 13000002
         USING CVTSECT,UCMBASE     BASE CVT REG                         13200001
         L     UCMBASE,CVTCUCB     GET UCM POINTER FROM CVT      Y02669 13300002
         DROP  UCMBASE                                           Y02669 13350002
         USING UCM,UCMBASE         ESTABLISH UCM ADDRESSABILITY  Y02669 13400002
         USING UCMLIST,UCMEBASE    BASE UCM ENTRY LIST                  13500001
         USING DCMTSRT,RDCMBASE    ESTABLISH RDCM BASE REG       Y02669 13600002
         USING DCMSTRT,TDCMBASE    BASE TDCM REG                 Y01012 13700001
         USING DCMACB,SACBPT       BASE SACB REG                        13800001
         SPACE 2                                                        13900002
         ST    RE,XAP              SAVE RETURN POINTER           Y02669 14000002
         SR    R1,R1               CLEAR REG                     Y02669 14050002
         IC    R1,XAU              LOAD SOURCE ID                Y02669 14100002
         BAL   RE,FINDUCME         FIND SOURCE ENTRY UCME        Y02669 14400002
         SPACE 2                                                        14450002
         L     KOPS,XAL            LOAD POINTER TO OPERANDS             14991402
         LA    KOPS,N0(KOPS)       CLEAR HIGH ORDER BYTE                15000001
         ST    KOPS,XASAVSTD+N32   SAVE OPERAND ADDRESS          Y02669 15050002
         EJECT                                                          15110002
*********************************************************************** 15150002
*                                                                     * 15160002
*                    K  A COMMAND                                Y02669 15200002
*                    K  A,REF COMMAND                            Y02669 15210002
*                                                                     * 15220002
*********************************************************************** 15250002
         SPACE                                                          15300002
         CLC   N0(N2,KOPS),KA      IS IT K A?                           15400002
         BE    KREFRTN             YES-GO HANDLE AS K A,REF      Y02669 15500002
         CLC   N0(N6,KOPS),KAREF   IS IT K A,REF?                       15700002
         BE    KREFRTN             YES-PROCESS                   Y02669 15750002
         SPACE 2                                                        15800402
*********************************************************************** 15802002
*                                                                     * 15804002
*                    K  T COMMAND                                Y02669 15806002
*                    K  T,REF COMMAND                            Y02669 15808002
*                                                                     * 15808402
*********************************************************************** 15808802
         SPACE                                                          15809202
         CLC   N0(N2,KOPS),KT      IS IT K T?                    Y02669 15809602
         BE    KREFRTN             YES-GO HANDLE AS K T,REF      Y02669 15809702
         CLC   N0(N6,KOPS),KTREF   IS IT K T,REF?                Y02669 15809802
         BE    KREFRTN             YES-PROCESS                   Y02669 15809902
         SPACE 2                                                        15810002
*********************************************************************** 15850002
*                                                                     * 15850402
*                    K  A,NONE COMMAND                           Y02669 15852002
*                                                                     * 15856002
*********************************************************************** 15860002
         SPACE                                                          15910002
         CLC   N0(N7,KOPS),KANONE+N2 IS IT K A,NONE?             Y02669 16000002
         BE    KNONERTN            YES-PROCESS                          16100002
         SPACE 2                                                        16102002
*********************************************************************** 16110002
*                                                                     * 16120002
*                    K  T,UTME= COMMAND                          Y02669 16130002
*  ERR - IEE156I INVALID OPERAND - IF NOT A; A,REF; A,NONE       Y02669 16140002
*                                         T; T,REF; T,UTME=      Y02669 16140402
*                                                                     * 16142002
*********************************************************************** 16144002
         SPACE                                                          16146002
         CLC   N0(N7,KOPS),KTUTME+N2  IS IT K T,UTME=?           Y02669 16148002
         BE    KUTMERTN            YES-PROCESS                   Y02669 16148402
         LA    KOPS,N1(KOPS)       NO,POINT CURSOR TO COMMA      Y02669 16198402
         B     BADKOP              ERR - IEE156I INVALID OPERAND Y02669 16200002
         EJECT                                                          18400001
*********************************************************************** 18750002
*                                                                     * 18752002
*                       K A AND K A,REF                          Y02669 18760002
*                       K T AND K T,REF                          Y02669 18770002
*         IF SOURCE IS NOT A GRAPHIC CONSOLE,ISSUE WTO FOR       Y02669 18800002
*         MESSAGE OTHERWISE LOAD POINTER TO DCM INSTRUCTION LINE Y02669 18810002
*            CLEARIT  - TO CLEAR ENTIRE LINE WITH BLANKS         Y02669 18820002
*            TARUCME  - TO GET THE TARGET CONSOLE'S UCME         Y02669 18830002
*         FOR K A AND K A,REF:                                   Y02669 18832002
*            MOVEINKA - TO MOVE THE MESSAGE TEXT INTO THE LINE   Y02669 18837002
*             BRANCH TO IEE5603D TO ISSUE THE MESSAGE            Y02669 18839002
*              'K A,LL,LL,...L=CC'                               Y02669 18842402
*              WITH THE CURSOR POINTING TO THE CHARACTER         Y02669 18842902
*              FOLLOWING 'A,' PLUS MESSAGE                       Y02669 18843402
*              'IEE150I CHANGE OPTIONS IF DESIRED'               Y02669 18844002
*         FOR K T AND K T,REF:                                   Y02669 18844402
*            FINDSACB - TO FIND THE SACB WITH TRACK IN IT        Y02669 18844602
*             IF NO TRACK ACTIVE ON THE SPECIFIED DEVICE:        Y02669 18844802
*              'IEE158I K REQUEST INCONSISTENT-NO TRACK ACTIVE'  Y02669 18845002
*            FINDUTME - TO CONVERT THE TIME INTERVAL TO          Y02669 18845202
*              DECIMAL BUILD THE MESSAGE TEXT AND BRANCH TO      Y02669 18846202
*              IEE5603D TO ISSUE: 'K T,UTME=XXX'                 Y02669 18847202
*              WITH THE CURSOR POINTING TO THE CHARACTER         Y02669 18848202
*              FOLLOWING '=,' PLUS MESSAGE                       Y02669 18849202
*              'IEE150I CHANGE OPTIONS IF DESIRED'               Y02669 18853902
*                                                                     * 18870502
*********************************************************************** 18876402
         SPACE 2                                                        18882302
KREFRTN  EQU   *                                                 Y02669 18888202
         TM    UCMDISP,UCMDISPC    IS ISSUING CONSOLE GRAPHICS?         18894102
         BZ    BUILDWTO            NO, GO BUILD MESSAGE          Y02669 18900002
         TM    XASSDS,XASSDS3      IS TASK ISSUING CMD COMTASK @Y02668P 18910003
         BO    BUILDWTO            NO, BRANCH ISSUE WTO        @Y02668P 18920003
         SPACE                                                          18950002
         L     RDCMBASE,UCMXB        LOAD POINTER TO RDCM        Y02669 19000002
         L     TDCMBASE,N0(RDCMBASE) LOAD POINTER TO TDCM        Y02669 19100002
         L     R6,DCMAENTR         LOAD ADDR OF ENTRY AREA              19200001
         LH    R1,DCMLGNTH         LOAD LENGTH OF A LINE                19300002
         BAL   RB,CLEARIT          CLEAR IT                             19500002
         BAL   RB,TARSACB          GET TARGET UCME               Y02669 19550002
         CLC   N0(N1,KOPS),KT      IS IT K T ?                   Y02669 19580002
         BE    KTREFRTN            YES-GO HANDLE AS K T,REF      Y02669 19590002
         LR    R1,R6               SAVE ADDRESS FOR CURSOR       Y02669 19590102
         BAL   RB,MOVEINKA         FILL IN MESSAGE TEXT          Y02669 19590402
         LA    R6,N4(R1)           BUMP POINTER TO , AFTER 'A'   Y02669 19590802
         B     TODIDOCS                                          Y02669 19591202
KTREFRTN EQU   *                                                 Y02669 19592002
         MVC   N0(N9,R6),KTUTME    MOVE COMMAND TO ENTRY AREA    Y02669 19600002
         BAL   RB,FINDSACB         FIND TARGET SACB WITH TRACK   Y02669 19610002
         BAL   RB,FINDUTME         GO CONVERT TIME VALUE         Y02669 19650002
         MVC   N9(N3,R6),XAX       MOVE VALUE INTO MSG           Y02669 19660002
         LA    R6,N9(R6)           SET CURSOR POSITION PAST ,    Y02669 19680002
TODIDOCS EQU   *                                                 Y02669 20350002
         ST    R6,XASTSAVE         SAVE CURSOR POSITION          Y02669 20400002
         MVI   XAE,IEE150I         SET OPTIONS MSG BIT           Y02669 20500002
         B     D5603D              GO TO IEE5603D TO ISSUE MSG   Y02669 20800002
         EJECT                                                          20850002
*********************************************************************** 27150002
*                                                                     * 27152002
*          IF SOURCE IS NOT A CRT DEVICE A WTO IS ISSUED FOR     Y02669 27154002
*               'IEE929I K A,LL,LL,...L=CC'                      Y02669 27154402
*            TARSACB  - TO GET THE TARGET CONSOLE'S UCME         Y02669 27156002
*            GETMAIN  - TO GET CORE FOR THE MESSAGE TEXT         Y02669 27158002
*                       AND CLEAR IT WITH BLANKS                 Y02669 27158102
*                       MUST BE DONE VIA BRANCH ENTRY TO GETMAIN Y02651 27158302
*                       LOCKS HELD DURING GETMAIN                Y02651 27163002
*            MOVEINKA - TO MOVE THE MESSAGE TEXT INTO THE        Y02669 27167802
*                       GETMAINED CORE                           Y02669 27172502
*                                                                     * 27213302
*          IF REPLYING TO K A,REF ALSO INCLUDED IS:              Y02669 27215402
*     'IEE928I DISPLAY AREA ID'S FOR COMSOLE 'CC' ARE ID,ID...'  Y02669 27229502
*            MOVEINLL - TO MOVE THE MESSAGE TEXT INTO THE        Y02669 27239502
*                       GETMAINED CORE                           Y02669 27249502
*            FREELOCK - TO RELEASE LOCKS BEFORE ISSUING SVC'S    Y02651 27251502
*            WRTWTO   - TO ISSUE WTO'S                           Y02669 27259502
*            FREE     - AFTER THE WTO'S ARE ISSUED TO FREE THE   Y02669 27269502
*                       GOTTEN CORE                              Y02669 27271502
*                                                                     * 27273802
*********************************************************************** 27283802
         SPACE 2                                                        27295902
BUILDWTO EQU   *                                                        27300002
         CLC   N0(N1,KOPS),KT      IS IT K T ?                   Y02669 27350002
         BE    KTREFWTO            YES-GO HANDLE AS K T,REF      Y02669 27360002
         SPACE 2                                                        27370002
KAREFWTO EQU   *                                                 Y20669 27380002
         BAL   RB,TARSACB          GO GET TARGET UCME            Y02669 27400002
         BAL   RB,GETMAIN          GET CORE FOR MSG-BRANCH ENTRY Y02651 27600002
         ST    R1,XASAVSTD+N16     SAVE BEGINNING ADDR OF IEE929IY02669 27650002
         MVC   N4(N8,R6),IEE929I   MOVE MESSAGE NUMBER                  27800002
         LA    R6,N13(R6)          BUMP MSG PT PAST MSG NO.      Y02669 27900002
         BAL   RB,MOVEINKA         GO PUT DATA INTO MSG          Y02669 28100002
         MVC   N0(N3,R6),LEQUALS   MOVE L=CC INTO MSG            Y02669 28300002
         MVC   N3(N2,R6),XAX+N1    STORE CC INTO L= PARAM.       Y02669 28400002
         LA    R6,N6(R6)           BUMP MSG LENGTH                      28500001
         ST    R6,XASAVSTD+N20     SAVE ENDING ADDRESS OF IEE929IY02651 28510002
         BAL   RB,GETMAIN          GET CORE FOR MSG-BRANCH ENTRY Y02651 28550002
         ST    R1,XASAVSTD+N24     SAVE BEGINNING ADDR OF IEE928IY02651 28560002
         MVC   N4(L'IEE928I,R6),IEE928I   MOVE MSG INTO AREA     Y02669 28600002
         LA    R6,N49(R6)          BUMP MESSAGE POINTER                 28650002
         BAL   RB,MOVEINLL         FILL IN MESSAGE INFO          Y02669 28670002
         MVC   N42(N2,R1),XAX+N1   MOVE CC INTO MESSAGE          Y02669 28680002
         ST    R6,XASAVSTD+N28     SAVE ENDING ADDRESS OF IEE928IY02651 28680802
         BAL   RB,FREELOCK         TO RELEASE LOCKS              Y02651 28682002
         L     R1,XASAVSTD+N16     GET BEGINNING ADDR OF IEE929I Y02651 28682402
         L     R6,XASAVSTD+N20     GET ENDING ADDRESS OF IEE929I Y02651 28684002
         BAL   RB,WRTWTO           GO WRITE WTO IEE929I          Y02669 28690002
         L     R1,XASAVSTD+N16     GET BEGINNING ADDR OF IEE929I Y02651 28690402
         BAL   RB,FREE             FREEMAIN WTO PARAMETER LIST   Y02669 28692002
         L     R1,XASAVSTD+N24     GET BEGINNING ADDR OF IEE928I Y02651 28692102
         L     R6,XASAVSTD+N28     GET ENDING ADDRESS OF IEE928I Y02651 28692202
         BAL   RB,WRTWTO           GO WRITE WTO IEE928I          Y02669 28692402
         L     R1,XASAVSTD+N24     GET BEGINNING ADDR OF IEE928I Y02651 28692502
         BAL   RB,FREE             FREEMAIN WTO PARAMETER LIST   Y02669 28692802
         B     RETURN              FINISHED, RETURN TO SYSTEM    Y02669 28694002
         EJECT                                                          29820002
*********************************************************************** 29830002
*                                                                     * 29840002
*          IF REPLYING TO K T,REF AND SOURCE IS NOT A CRT        Y02669 29850002
*          DEVICE A WTO IS ISSUED:                               Y02669 29860002
*               ' IEE922I K T,UTME=XXX,L=CC' IS ISSUED           Y02669 29862002
*            TARSACB  - TO GET THE TARGET CONSOLE'S UCME         Y02669 29863002
*            FINDSACB - TO FIND THE SACB WITH TRACK ACTIVE       Y02669 29864002
*              IF NO TRACK ACTIVE ON THE SPECIFIED DEVICE:       Y02669 29865002
*              'IEE158I K REQUEST INCONSISTENT-NO TRACK ACTIVE'  Y02669 29866002
*            FINDUTME - TO CONVERT THE TIME INTERVAL TO DECIMAL  Y02669 29868402
*            GETMAIN  - TO GET CORE FOR THE MESSAGE TEXT         Y02651 29868502
*                       MUST BE DONE VIA BRANCH ENTRY TO GETMAIN Y02651 29868602
*                       LOCKS HELD DURING GETMAIN                Y02651 29868702
*            CONVERT  - TO CONVERT THE 'CC' TO DECIMAL           Y02669 29868802
*            FREELOCK - TO RELEASE LOCKS BEFORE SVC'S            Y02651 29868902
*            WRTWTO   - TO ISSUE WTO                             Y02669 29869202
*            FREE     - AFTER THE WTO IS ISSUED TO FREE THE      Y02669 29869602
*                       GOTTEN CORE                              Y02669 29869702
*                                                                     * 29869802
*********************************************************************** 29869902
KTREFWTO EQU   *                                                 Y02669 29870002
         BAL   RB,TARSACB          GET TARGET UCME ADDRESS       Y02669 30070002
         BAL   RB,FINDSACB         FIND SACB WITH TRACK          Y02669 30080002
         BAL   RB,FINDUTME         CONVERT TIME VALUE TO DECIMAL Y02669 30090002
         BAL   RB,GETMAIN          BRANCH ENTRY GETMAIN          Y02669 30100002
         MVC   N4(N7,R6),IEE922I   MOVE MESSAGE NUMBER TO AREA @YM30462 30110003
         LA    R6,N13(R6)          BUMP MSG PT PAST MSG NO.      Y02669 30112002
         MVC   N0(N9,R6),KTUTME    MOVE COMMAND TO AREA          Y02669 30120002
         MVC   N9(N3,R6),XAX       MOVE EBCDIC TIME VALUE      @YM2775P 30170002
         BAL   R5,CONVERT          CONVERT TARGET CONSOLE ID     Y02669 30180002
         MVC   N12(N3,R6),LEQUALS  MOVE IN ',L='                 Y02669 30220002
         MVC   N15(N2,R6),XAX+N1   MOVE IN CC VALUE              Y02669 30270002
         LA    R6,N17(R6)          BUMP MSG PT TO LAST CHAR      Y02669 30320002
         BAL   RB,FREELOCK         GO RELEASE LOCKS              Y02651 30330002
         L     R1,XASAVSTD+N12     GET BEGINNING ADDRESS         Y02669 30340002
         BAL   RB,WRTWTO           GO ISSUE IEE922I              Y02669 30370002
         L     R1,XASAVSTD+N12     GET BEGINNING ADDRESS         Y02669 30380002
         BAL   RB,FREE             GO FREE GOTTEN CORE           Y02669 30420002
         B     RETURN              RETURN TO SYSTEM              Y02669 30470002
         EJECT                                                          30520002
*********************************************************************** 32050002
*                                                                     * 32052002
*                          K A,NONE                              Y02669 32060002
*         TARUCME - TO GET THE TARGET CONSOLE'S UCME             Y02669 32062002
*                                                                     * 32070002
*   ERR -IEE924I DISPLAY IN OR ABOVE AREA - IF STATUS DISPLAY ACTIVE  * 32080002
*                                                                     * 32082002
*   IF NO AREAS WERE ORIGINALLY DEFINED AND WHEN ALL ARE FREED   Y02669 32082402
*         FREELOCK - TO RELEASE LOCKS BEFORE SVC'S               Y02651 32082802
*         GETCORE - TO GET CORE FOR MESSAGE                      Y02669 32084802
*         CONVERT - TO CONVERT THE 'CC' TO DECIMAL               Y02669 32086002
*         WRTWTO  - TO ISSUE WTO MACRO                           Y02669 32088002
*         FREE    - TO FREEMAIN GOTTEN CORE FOR MESSAGE          Y02669 32088402
*        IEE928I DISPLAY AREA IDS' FOR CONSOLE 'CC' ARE 'NONE'        * 32090002
*                                         - IF NO SACB'S DEFINED      * 32090402
*                                         - WHEN ALL SACB'S FREED     * 32092002
*                                                                     * 32094002
* NOTE: LOCKS HELD ON ENTRY TO IEE6903D, CAN BE RELEASED IF 'NONE'    * 32096002
*********************************************************************** 32116002
        SPACE 2                                                         32150002
KNONERTN EQU   *                                                        35800001
         BAL   RB,TARSACB          GET TARGET CONSOLE'S UCME     Y02669 35900002
         LTR   SACBPT,SACBPT       ANY AREAS DEFINED?                   36100002
         BNZ   FREESACB            YES, TRY TO FREE SACBS        Y02669 36200002
         SPACE 2                                                        36200402
NOSACBS  EQU   *                                                        36200802
         BAL   RB,FREELOCK         GO FREE LOCKS                 Y02651 36200902
         BAL   RB,GETCORE          GET CORE FOR IEE928I MESSAGE  Y02669 36202002
         MVC   N4(L'IEE928I,R6),IEE928I   MOVE IN MESSAGE ID     Y02669 36204002
         LA    R6,N49(R6)          ADJUST POINTER                Y02669 36206002
         MVC   N0(N4,R6),KANONE+N4 MOVE IN WORD 'NONE'           Y02669 36208002
         LA    R6,N4(R6)           ADJUST POINTER TO MSG END     Y02669 36208402
         BAL   R5,CONVERT          CONVERT 'CC' TO DECIMAL       Y02669 36208802
         MVC   N42(N2,R1),XAX+N1   PUT VALUE IN MESSAGE          Y02669 36209202
         L     R1,XASAVSTD+N12     GET BEGINNING ADDRESS         Y02651 36209302
         BAL   RB,WRTWTO           ISSUE WTO MACRO               Y02669 36209602
         L     R1,XASAVSTD+N12     GET BEGINNING ADDRESS         Y02651 36219602
         BAL   RB,FREE             FREE GOTTEN CORE              Y02669 36219702
         B     RETURN              FINISHED, RETURN TO SYSTEM    Y02669 36229802
         EJECT                                                          36239902
*********************************************************************** 36250002
*                                                                     * 36260002
*     THIS CODE WILL FREEMAIN ANY GETMAINED SACB'S AND REINITIALIZE   * 36300002
*     PERMANENT SACB'S AND TURN OFF DCMAUSE BIT IN SACB'S             * 36400002
*                                                                     * 36410002
*********************************************************************** 36450002
         SPACE 2                                                        36500002
FREESACB EQU   *                                                        36550002
         CLI   DCMTOPDS,ZERO       IS THERE A DISPLAY ON SCREEN?        36700002
         BNE   ERROR               YES- ERROR CAN'T FREE IF BUSY        36800002
         SPACE                                                          36850002
         LA    R5,DCMADSDS         PRIME CHAIN BACKWARD POINTER         37600001
RESTART  EQU   *                                                        37900001
         TM    DCMASACB,DCMAGM     IS IT A GETMAINED SACB ?             38000002
         BO    FREEMAIN            YES- GO FREE IT                      38100002
         XC    DCMAROW(DCMCLRLN),DCMAROW  ZERO OUT SACB          Y02669 38300002
         NI    DCMASACB,XFF-DCMAUSE TURN OFF IN-USE BIT          Y02669 38400002
         XC    DCMALN(N2),DCMALN   ZERO OUT LENGTH FIELD OF SACB        38500001
         LR    R5,SACBPT           SAVE PREVIOUS BLOCK ADDR             38600001
RESTART2 EQU   *                                                        38800001
         ICM   SACBPT,N7,DCMACBNX+1   LOAD NEXT SACB POINTER     Y02669 38900002
         BNZ   RESTART             IS THERE ONE? YES-CONTINUE LOOP      39200002
         XC    DCMTOPAR(N2),DCMTOPAR ZERO OUT TOP AREA & TOP DISP. ID'S 39250001
         LA    R6,DCMADSDS         LOAD ADDR OF CHAIN START      Y02669 39400002
         CR    R5,R6               ARE THERE SYSGEN'D SACBS?     Y02669 39500002
         BNE   NOSACBS             YES-                          Y02669 39600002
         XC    DCMADSDS(N4),DCMADSDS ZERO OUT START ADDR                39800001
         B     NOSACBS             GO TELL STATUS IEE928I        Y02669 39900002
         SPACE 2                                                        40000001
*********************************************************************** 40010002
* NOTE: LOCKS HELD ON ENTRY TO IEE6903D - BRANCH ENTRY TO FREEMAIN    * 40050002
*       IS NECESSARY TO DECHAIN AND FREE SACB'S                       * 40070002
*         REGISTERS DESTROYED : 0, 1, 3, 4, 7, 14, 15                 * 40090002
*         INPUT INFORMATION: R4 POINTS TO CURRENT TCB                 * 40110002
*                            R7 POINTS TO CURRENT ASCB                * 40130002
*********************************************************************** 40180002
FREEMAIN EQU   *                                                        40200001
         L     R4,PTRCVT           GET ADDRESS OF CVT            Y02651 40250002
         USING CVTSECT,R4          ADDRESSABILITY FOR CVT        Y02651 40260002
         L     R4,CVTTCBP          ADDRESS OF TCBS & ASCBS       Y02651 40270002
         DROP  R4                                                Y02651 40272002
         USING TCBASCB,R4          ADDRESSABILITY FOR IEFPTRS    Y02651 40280002
         L     R7,ASCBPTR          ADDRESS OF ASCB FOR INTERFACE Y02651 40290002
         L     R4,TCBPTR           ADDRESS OF TCB FOR INTERFACE  Y02651 40292002
         MVC   N0(N4,R5),N0(SACBPT) MOVE PT TO NXT BLK INTO PREV BLK    40300001
         LR    R1,SACBPT           ADDR OF AREA TO FREE UP              40500001
         LR    SACBPT,R5           RESET SACB POINTER                   40600001
         LA    R0,DCMACBSZ         PASS SACB LENGTH                     40700001
         FREEMAIN RC,LV=(0),A=(1),SP=SP241,BRANCH=YES                   40750002
         B     RESTART2            LOOP                                 40800001
         EJECT                                                          40802002
*********************************************************************** 40804002
*                                                                     * 40806002
*      THIS CODE VALIDITY CHECKS THE VALUE FOLLOWING 'UTME='     Y02669 40808002
*      CONVERTS THE VALUE TO BINARY AND STORES THE VALUE         Y02669 40808102
*      IN THE APPROPIATE SACB                                    Y02669 40808202
*                                                                     * 40808402
*********************************************************************** 40808802
KUTMERTN EQU   *                                                 Y02669 40858802
         XC    XAX(N8),XAX         CLEAR CONVERT AREA            Y02669 40908802
         LA    KOPS,N7(KOPS)       BUMP PAST T,UTME= PARMS       Y02669 40910802
         TM    N0(KOPS),DIGIT      IS 1ST CHAR VALID DIGIT?      Y02669 40912802
         BNO   BADUTME             NO, IEE156I                   Y02669 40914802
         CLI   N1(KOPS),BLANK      IS 2ND DIGIT A BLANK?         Y02669 40916802
         BE    ONEDIGIT            YES, GO CONVERT 1 DIGIT       Y02669 40917202
         TM    N1(KOPS),DIGIT      IS 2ND CHAR VALID DIGIT?      Y02669 40917602
         BNO   BADUTME             NO, IEE156I                   Y02669 40918002
         CLI   N2(KOPS),BLANK      IS 3RD DIGIT A BLANK?         Y02669 40922502
         BE    TWODIGIT            YES, GO CONVERT 2 DIGITS      Y02669 40923802
         TM    N2(KOPS),DIGIT      IS 3RD CHAR VALID DIGIT?      Y02669 40925102
         BNO   BADUTME             NO, IEE156I                   Y02669 40926402
         CLI   N3(KOPS),BLANK      IS 4TH CHAR A BLANK?          Y02669 40927702
         BNE   BADUTME             NO, IEE156I                   Y02669 40929002
         B     TRIDIGIT            YES, GO CONVERT 3 DIGITS      Y02669 40930302
         SPACE 2                                                        40931602
ONEDIGIT EQU   *                                                 Y02669 40932902
         MVC   XAX+N7(N1),N0(KOPS) MOVE IN ONE DIGIT TO PACK     Y02669 40934202
         B     PACK                                              Y02669 40935502
TWODIGIT EQU   *                                                 Y02669 40936802
         MVC   XAX+N6(N2),N0(KOPS) MOVE IN TWO DIGITS TO PACK    Y02669 40938102
         B     PACK                                              Y02669 40939402
TRIDIGIT EQU   *                                                 Y02669 40940702
         MVC   XAX+N5(N3),N0(KOPS) MOVE IN THREE DIGITS TO PACK  Y02669 40942002
PACK     EQU   *                                                 Y02669 40943302
         PACK  XAX+N4(N4),XAX+N4(N4)  PACK THE DIGITS            Y02669 40944602
         NI    XAX+N7,SIGN         MAKE FOX A CHARLIE            Y02669 40945902
         SR    R15,R15                                           Y02669 40947202
         CVB   R15,XAX             CONVERT NUMBER TO BINARY      Y02669 40948502
         C     R15,X10             IS VALUE LESS THAN 10?      @ZA07770 40951103
         BL    BADUTME             YES-ERROR IEE156I             Y02669 40952402
         EJECT                                                          40953702
*********************************************************************** 40955002
*                                                                     * 40956302
*    SAVE THE NEW TIME VALUE FOR K T,UTME IN TARGET CONSOLE'S SACB    * 40957602
*    IF THERE IS ONE AND IF THERE IS AN ACTIVE TRACK IN IT            * 40958902
*            TARSACB  - TO GET THE TARGET CONSOLE'S UCME         Y02669 40959202
*            FINDSACB - TO FIND THE SACB WITH TRACK ACTIVE       Y02669 40959502
*              IF NO TRACK ACTIVE ON THE SPECIFIED DEVICE:       Y02669 40959802
*              'IEE158I K REQUEST INCONSISTENT-NO TRACK ACTIVE'  Y02669 40960202
*            FREELOCK - TO RELEASE LOCKS BEFORE SVC'S            Y02669 40965402
*   NOTE: ALWAYS RETURN TO SYSTEM WHEN VALUE HAS BEEN STORED          * 40969402
*                                                                     * 40974102
* NOTE: LOCKS ARE ALWAYS HELD ON ENTRY TO IEE6903D - MUST BE RELEASED * 40977802
*       BEFORE RETURNING TO SYSTEM                                    * 40985202
*********************************************************************** 40988902
         SPACE 2                                                        40996302
         BAL   RB,TARSACB          FIND TARGET UCME              Y02669 41000002
         BAL   RB,FINDSACB         FIND MATCHING SACB            Y02669 41003002
         STH   R15,DCMAUTME        STORE TIME VALUE              Y02669 41006002
         BAL   RB,FREELOCK         GO FREE LOCKS                 Y02651 41009002
         B     RETURN              RETURN TO SYSTEM              Y02669 41012002
         EJECT                                                          41015002
*********************************************************************** 41018002
*                                                                     * 41021002
*                THE FOLLOWING ARE SUBROUTINES                        * 41024002
*                                                                     * 41027002
*********************************************************************** 41030002
         SPACE 2                                                        41033002
*********************************************************************** 41036002
*                                                                     * 41039002
*                GET TARGET CONSOLE UCME                              * 41042002
*                                                                     * 41050002
*********************************************************************** 41150002
         SPACE 2                                                        41200002
TARSACB  EQU   *                                                 Y02669 41250002
         SR    R1,R1               CLEAR REG                            41300002
         IC    R1,XASCID           LOAD TARGET CONSOLE ID        Y02669 41350002
         BAL   RE,FINDUCME         GET CONSOLE'S UCME            Y02669 41400002
         L     RDCMBASE,UCMXB      LOAD POINTER TO RDCM          Y02669 41550002
         L     SACBPT,DCMADSDS     LOAD SACB POINTER FROM RDCM   Y02669 41600002
         BR    RB                  RETURN                               41700002
         SPACE 2                                                        41750002
*********************************************************************** 41800002
*                                                                     * 41850002
*              FIND AND BASE SOURCE OR TARGET UCME                    * 41900002
*                                                                     * 41920002
*    INPUT- REG 1 HAD CONSOLE ID RIGHT JUSTIFIED, HIGH ORDER BYTES ZERO 41950002
*    OUTPUT- POINTER TO DCMENTRY SPECIFIED BY CONSOLE ID IN UCMEBASE  * 42000002
*    REG USAGE-DESTROYS CONTENTS OF: REG 0,1,UCMEBASE                 * 42050002
*                                                                     * 42100002
*********************************************************************** 42150002
         SPACE 2                                                        42200002
FINDUCME EQU   *                                                 Y02669 42250002
         BCTR  R1,ZERO             SUBTRACT ONE FROM CONSOLE ID  Y02669 42300002
         L     UCMEBASE,UCMVEA     POINT TO FIRST ENTRY          Y02669 42310002
         M     R0,UCMVEZ           MULTIPLY SIZE BY REDUCED ID   Y02669 42320002
         AR    UCMEBASE,R1         POINT TO DESIRED UCM ENTRY    Y02669 42330002
         BR    RE                  RETURN                        Y02669 42340002
         EJECT                                                          42340102
*********************************************************************** 42340402
*                                                                     * 42340802
*                       FIND AND BASE SACB                            * 42341202
*                                                                     * 42341302
*    GIVEN A PARTICULAR CRT CONSOLE THIS SUBROUTINE FINDS AND         * 42341602
* BASES THE SCREEN AREA CONTROL BLOCK (SACB) WITH A TRACK ACTIVE.     * 42341702
* IF NONE IS FOUND, 'IEE158I K REQUEST INCONSISTENT NO TRACK ACTIVE'  * 42341802
* IS ISSUED.                                                          * 42351602
*    INPUT -  UCMEBASE - ADDRESS OF UCM ENTRY OF A CRT CONSOLE        * 42356402
*    OUTPUT - SACBBASE - ADDRESS OF SACB WITH TRACK ACTIVE            * 42366402
*                                                                     * 42375702
* ERR - IEE158I REQUEST INCONSISTENT - NO TRACK ACTIVE                * 42376102
*********************************************************************** 42377702
         SPACE 2                                                        42379702
FINDSACB EQU   *                                                 Y02669 42380102
         TM    DCMASACB,DCMAUSE    DOES SACB DEFINE AN AREA?     Y02669 42387402
         BZ    NOTRACK             NO, ERR NO TRACK ACTIVE       Y02669 42389402
         TM    DCMADFLG,DCMADD     TRACK ACTIVE IN AREA?         Y02669 42389802
         BCR   N1,RB               YES, RETURN                   Y02669 42390202
         ICM   SACBPT,N7,DCMACBNX+1  ANY MORE SACBS?             Y02669 42390302
         BZ    NOTRACK             NO, ERR NO TRACK ACTIVE       Y02669 42394202
         B     FINDSACB            CONTINUE SEARCH               Y02669 42396202
         EJECT                                                          42406802
*********************************************************************** 42408402
*                                                                     * 42410002
*              GETMAIN WITH LOCKS RELEASED                            * 42410802
*                                                                     * 42411202
*          GETCORE:  GETS CORE FOR MESSAGE                       Y02669 42411602
*          CLEARIT:  BLANKS OUT MESSAGE AREA IN EITHER           Y02669 42420002
*                    WTO BUFFER OR DCM INSTRUCTION LINE          Y02669 42420402
*  ERR - IEE931I INSUFFICIENT STORAGE FOR COMMAND - IF GETMAIN FAILS  * 42422002
*                                                                     * 42424002
*********************************************************************** 42430002
         SPACE 2                                                        42432002
GETCORE  EQU   *                                                        42440002
         LA    R1,XASAVSTD+N12     AREA FOR STORAGE ADDRESS      Y02669 42442002
         MVC   XASAVSTD(N10),GETAREA   MOVE PARM LIST TO XSA     Y02669 42444002
         ST    R1,XASAVSTD+N4      WHERE GETMAIN TO STORE ADDR   Y02669 42444402
         LA    R1,XASAVSTD         ADDR OF PARM LIST FOR GETMAIN Y02669 42444802
         GETMAIN  MF=(E,(1))                                     Y02669 42445202
         LTR   R15,R15             TEST RETURN CODE              Y02669 42448002
         BNZ   MSG931              IF NOT ZERO;MEANS NO CORE     Y02669 42448402
         SPACE                                                          42448502
CLEARBUF EQU   *                                                 Y02669 42448602
         L     R6,XASAVSTD+N12     LOAD GETMAINED ADDR           Y02669 42448802
         LA    R1,N80              LENGTH OF MSG IS ALWAYS 80    Y02669 42449202
*********************************************************************** 42449302
*   INPUT - REGISTER 1 CONTAINS LENGTH OF AREA TO BE CLEARED     Y02669 42449602
*           REGISTER 6 POINTS TO BEGINNING OF AREA               Y02669 42451602
*********************************************************************** 42452502
CLEARIT  EQU   *                                                        42452802
         MVI   N0(R6),BLANK        CLEAR AREA                           42453102
         BCTR  R1,N0               BY                                   42453402
         BCTR  R1,N0               DECREMENTING LENGTH  BY 2            42454002
         EX    R1,BLANKS           THEN PROPOGATING BLANK               42454602
         LR    R1,R6               SAVE THE BEGINNING ADDRESS    Y02669 42455202
         BR    RB                  RETURN                               42455602
         SPACE                                                          42455702
GETAREA  GETMAIN EC,LV=N80,A=MSG931,SP=SP229,MF=L                Y02669 42456002
         EJECT                                                          42456402
*********************************************************************** 42456702
*                                                                     * 42456802
*  THIS IS THE BRANCH ENTRY TO GETMAIN USED WHEN LOCKS NEED TO BE     * 42456902
*  HELD.                                                              * 42457102
*     REGISTERS DESTROYED: 0, 1, 3, 4, 7, 14, 15                      * 42457302
*     INPUT INFORMATION: R4 POINTS TO CURRENT TCB                     * 42457502
*                        R7 POINTS TO CURRENT ASCB                    * 42457702
*                                                                     * 42457902
*********************************************************************** 42458202
         SPACE 2                                                        42458502
GETMAIN  EQU   *                                                        42458802
         L     R4,PTRCVT           GET ADDRESS OF CVT            Y02651 42459102
         USING CVTSECT,R4          ADDRESSABILITY FOR CVT        Y02651 42459402
         L     R4,CVTTCBP          ADDRESS OF IEFPTRS            Y02651 42459702
         DROP  R4                                                Y02651 42460002
         USING TCBASCB,R4          ADDRESSABILITY FOR IEFPTRS    Y02651 42460502
         L     R7,ASCBPTR          ADDRESS OF ASCB FOR INTERFACE Y02651 42461002
         L     R4,TCBPTR           ADDRESS OF TCB FOR INTERFACE  Y02651 42461502
         GETMAIN RC,LV=N80,SP=SP229,BRANCH=YES                   Y02651 42462002
         LTR   R15,R15             WAS IT SUCCESSFUL?            Y02669 42462402
         BNZ   MSG931              NO ERROR - NO CODE            Y02669 42462802
         ST    R1,XASAVSTD+N12     SAVE ADDR OF CORE             Y02669 42463402
         B     CLEARBUF            GO CLEAR AREA JUST GOTTEN     Y02669 42465402
         EJECT                                                          42467502
*********************************************************************** 42468002
*                                                                     * 42468502
*             THIS CODE WILL CONVERT HEX TO EBCDIC               Y02669 42469002
*                                                                     * 42469502
*********************************************************************** 42470002
         SPACE 2                                                        42470502
FINDUTME EQU   *                                                 Y02669 42471002
         LH    R5,DCMAUTME         LOAD UTME VALUE               Y02669 42471502
         CVD   R5,XAX              CONVERT TO DECIMAL            Y02669 42473002
         UNPK  XAX(N3),XAX+N6(N2)  UNPACK NUMBER                 Y02669 42473502
         OI    XAX+N2,DIGIT        FIX SIGN                      Y02669 42474002
         BR    RB                  RETURN                        Y02669 42474502
         SPACE 2                                                        42475002
CONVERT  EQU   *                                                        42475502
         SR    R4,R4               CLEAR REG                     Y02669 42476002
         IC    R4,XASCID           GET TARGET CONSOLE ID         Y02669 42476502
EBCDIC   EQU   *                                                        42477002
         CVD   R4,XAX              CONVERT TO DECIMAL            Y02669 42477502
         UNPK  XAX(N3),XAX+N6(N2)  UNPACK NUMBER                 Y02669 42478002
         OI    XAX+N2,DIGIT        FIX SIGN                      Y02669 42478502
         BR    R5                  RETURN                        Y02669 42479002
         EJECT                                                          42479502
*********************************************************************** 42480002
*                                                                     * 42480502
*        FILL IS DESCRIPTOR, ROUTING CODES AND MCSFLAGS          Y02669 42481002
*                  ISSUE WTO AND RETURN                          Y02669 42481502
*   INPUT - REGISTER 1 POINTS TO BEGINNING OF WTO BUFFER         Y02669 42481902
*           REGISTER 6 POINTS TO END OF WTO BUFFER               Y02669 42482402
*                                                                     * 42484002
*********************************************************************** 42484502
         SPACE 2                                                        42485002
WRTWTO   EQU   *                                                 Y02669 42485502
         MVC   N0(N4,R6),DESCR     MOVE DESCRIPTOR CODE IN AREA  Y02669 42486002
         SR    R6,R1               GET LENGTH OF MSG             Y02669 42486502
         STH   R6,N0(R1)           STORE FOR WTO                 Y02669 42487002
         MVI   N2(R1),MCSMASK      ID PASSED AND QUEUE BY ID     Y02669 42487502
         MVI   N3(R1),N0           ZERO SECOND MSCFLGS BYTE      Y02669 42488002
         SR    R0,R0               CLEAR REG                     Y02669 42488502
         IC    R0,XAU              LOAD SOURCE DEVICE ID         Y02669 42489002
         WTO   MF=(E,(1))                                        Y02669 42489502
         BR    RB                  RETURN                        Y02669 42490002
         EJECT                                                          42490502
*********************************************************************** 42491002
*                                                                     * 42491502
*                FREEMAIN WTO PARAMETER LIST                     Y02669 42492002
*        INPUT - REGISTER 1 POINTS TO AREA TO BE FREED           Y02669 42500002
*                                                                     * 42504002
*********************************************************************** 42516002
         SPACE 2                                                        42526002
FREE     EQU   *                                                        42528002
         FREEMAIN R,LV=N80,A=(1),SP=SP229                        Y02669 42564002
         BR    RB                  RETURN                        Y02669 42576002
         EJECT                                                          42588002
*********************************************************************** 42588402
*                                                                     * 42588502
*       TO MOVE MESSAGE TEXT INTO DCM INSTRUCTION LINE                * 42588602
*       OR GETMAINED AREA                                             * 42588802
*         EBCDIC  - TO CONVERT TO EBCDIC                              * 42589502
*         CONVERT - TO GET CONSOLE ID                                 * 42590402
*       MOVEINKA - ENTRY POINT FOR IEE929I                            * 42590802
*       MOVEINLL - ENTRY POINT FOR IEE928I                            * 42591502
*                                                                     * 42592902
*********************************************************************** 42593602
         SPACE 2                                                        42594302
MOVEINKA EQU   *                                                 Y02669 42595002
         MVC   N0(N4,R6),KANONE    MOVE  MSG NO. ID ( K A,)      Y02669 42595702
         LA    R6,N4(R6)           BUMP MSG POINTER PAST MSG NO. Y02669 42596402
         LTR   SACBPT,SACBPT       ANY AREA'S DEFINED BY K A,LL? Y02669 42596802
         BZ    NONERTN             NO--INSERT 'NONE'             Y02669 42597202
         SR    R4,R4               CLEAR REG                     Y02669 42597602
NXTSACB  EQU   *                                                 Y02669 42647602
         TM    DCMASACB,DCMAUSE    AREA DEFINED HERE?            Y02669 42649602
         BZ    ANYSACB             NO--CHK NEXT SACB             Y02669 42649702
         IC    R4,DCMALN+N1        LOAD LENGTH OF AREA           Y02669 42650802
         BAL   R5,EBCDIC           GO CONVERT TO EBCDIC          Y02669 42652802
         MVC   N0(N2,R6),XAX+N1    MOVE LL INTO MESSAGE          Y02669 42653202
         MVI   N2(R6),COMMA        MOVE IN COMMA AFTER AREA ID   Y02669 42653602
         LA    R6,N3(R6)           BUMP MESSAGE POINTER          Y02669 42653702
         ICM   SACBPT,N7,DCMACBNX+1  GET POINTER TO NEXT SACB    Y02669 42653802
         BNZ   NXTSACB             ANY MORE? YES-KEEP ON LOOPING Y02669 42653902
         B     ANYSACB             NO, SEE IF THERE WERE ANY     Y02669 42654502
         SPACE 3                                                        42655102
MOVEINLL EQU   *                                                 Y02669 42656202
         L     SACBPT,DCMADSDS     GET ADDRESS OF FIRST SACB     Y02669 42656602
         LTR   SACBPT,SACBPT       ANY AREA'S DEFINED BY K A,LL? Y02669 42657302
         BZ    NONERTN             NO--INSERT 'NONE'             Y02669 42658302
         SR    R4,R4               CLEAR REG                     Y02669 42660002
NEXTSACB EQU   *                                                 Y02669 42662002
         TM    DCMASACB,DCMAUSE    AREA DEFINED HERE?            Y02669 42664002
         BZ    ANYSACB             NO--CHK NEXT SACB             Y02669 42664402
         LA    R4,N1(R4)           BUMP COUNTER                  Y02669 42664802
         MVC   N0(N1,R6),DCMAID    YES,MOVE AREA ID INTO MESSAGE Y02669 42665002
         MVI   N1(R6),COMMA        MOVE IN COMMA AFTER AREA ID   Y02669 42669102
         LA    R6,N2(R6)           BUMP MESSAGE POINTER          Y02669 42671102
NEXTBLK  EQU   *                                                 Y02669 42673102
         ICM   SACBPT,N7,DCMACBNX+1  GET POINTER TO NEXT SACB    Y02669 42673202
         BNZ   NEXTSACB            IF THERE IS ONE KEEP LOOPING  Y02669 42673302
         EJECT                                                          42900902
ANYSACB  EQU   *                                                 Y02669 42908902
         LTR   R4,R4               ANY SACBS AT ALL?             Y02669 42948902
         BZ    NONERTN             NO, INDICATE 'NONE' IN MESSAGEY02669 42958902
         BCTR  R6,N0               YES, BLANK OUT LAST COMMA     Y02669 42968902
         MVI   N0(R6),BLANK                                      Y02669 42978902
         B     FINIT               FINISH MESSAGE                Y02669 42998902
NONERTN  EQU   *                                                 Y02669 43048902
         MVC   N0(N4,R6),KANONE+N4 MOVE IN WORD 'NONE'           Y02669 43098902
         LA    R6,N4(R6)           BUMP MSG LENGTH               Y02669 43108902
         SPACE 2                                                        43148902
FINIT    EQU   *                                                        43198902
         BAL   R5,CONVERT          GO CONVERT CC TO EBCDIC              43248902
         BR    RB                  RETURN                        Y02669 43298902
         EJECT                                                          43548902
*********************************************************************** 43550902
*                                                                     * 43551302
*   CMS AND LOCAL LOCKS ARE ALWAYS HELD ON ENTRY TO IEE6903D.    Y02651 43551702
*   THEY MUST BE RELEASED BEFORE ISSUING SVC'S ( UNLESS BRANCH   Y02651 43552102
*   ENTRY IS USED) OR RETURNING.                                 Y02651 43552502
*                                                                     * 43552902
*********************************************************************** 43554902
         SPACE 3                                                        43556902
FREELOCK EQU   *                                                 Y02651 43558902
         STM   RB,RE,XASAVLOC         SAVE REGS AROUND SETLOCK   Y02651 43598902
         SETLOCK RELEASE,TYPE=CMS,RELATED=(K,IEE7503D(LOCKSET))         43648902
         SETLOCK RELEASE,TYPE=LOCAL,RELATED=(K,IEE7503D(LOCKSET))       43698902
         LM    RB,RE,XASAVLOC         RESTORE REGS AFTER SETLOCK Y02651 43748902
         NI    XASSDS,XFF-XASSDS5     INDICATE NO LOCKS HELD     Y02651 43798902
         BR    RB                     RETURN                     Y02651 43848902
         EJECT                                                          43898902
**********************************************************************  46078402
*                                                                    *  46088402
*                       NORMAL EXITS                                 *  46089302
*                                                                    *  46090202
**********************************************************************  46091202
         SPACE 2                                                        46091602
RETURN   EQU   *                                                 Y02669 46092402
         L     RE,XAP              RESTORE RETURN REG            Y02669 46094002
         BR    RE                  GO BACK TO SYSTEM             Y02669 46096002
         SPACE 2                                                        46098002
**********************************************************************  46100002
*                                                                    *  46150002
*                       ERROR EXITS                                  *  46160002
*                                                                    *  46170002
**********************************************************************  46180002
         SPACE 2                                                        46230002
NOTRACK  EQU   *                                                 Y02669 46280002
         MVI   XAE,IEE158I         INDICATE REQUEST INCONSISTENT Y02669 46282002
         MVI   XASTSAVE,IEE158     INDICATE NO TRACK ACTIVE      Y02669 46284002
         B     STOREOP             STORE ADDRESS OF T            Y02669 46286002
         SPACE 2                                                        46300002
MSG931   EQU   *                                                 Y02669 46550002
         MVI   XAE,IEE931I         CORE NOT AVAILABLE            Y02669 46560002
         B     STOREOP             GO TO PUT OUT MSG             Y02669 46570002
         SPACE  2                                                       46572002
ERROR    EQU   *                                                 Y02669 46580002
         MVI   XAE,IEE924I         SET ON MAJOR FLAG BIT         Y02669 46594002
         MVI   XASTSAVE,IEE924     DISPLAY IN OR ABOVE AREA      Y02669 46594402
         B     STOREOP                                           Y02669 46596002
         SPACE 2                                                        46596402
BADUTME  EQU   *                                                 Y02669 46596802
         SPACE 2                                                        46597802
BADKOP   EQU   *                                                 Y02669 46598002
         MVI   XAE,IEE156I         NONE OF ABOVE,SO ITS BAD      Y02669 46598402
         STCM  KOPS,N7,XASOPTR     GET CURRENT ADDR OF OPERAND   Y02669 46598502
         B     D5603D              EXIT TO MSG MODULE            Y02669 46598602
         SPACE 2                                                        46598702
STOREOP  EQU   *                                                 Y02669 46598802
         MVC   XASOPTR(N3),XASAVSTD+N33  SAVE OPERAND POINTER    Y02669 46599602
D5603D   EQU   *                                                 Y02669 46599702
         L     RE,XAP              RESTORE RETURN REG ADDR       Y02669 46599802
         L     R15,VCON5603                                      Y02669 46628602
         BR    R15                                               Y02669 46630602
         EJECT                                                          46633302
*********************************************************************** 46650002
*                                                                     * 46800002
*                         CONSTANTS                                   * 46820002
*                                                                     * 46840002
*********************************************************************** 46860002
BLANKS   MVC   N1(N0,R6),N0(R6)    FILL WITH BLANKS                     46910002
         DS    0F                                                       46950001
FOUR     DC    H'4'                CONSTANT                      Y02669 46960002
ELEVEN   DC    H'11'               CONSTANT                             47000002
X10      DC    F'10'               CONSTANT                    @ZA07770 47060003
VCON0503 DC    V(IEE0503D)                                       Y02669 47090002
VCON5603 DC    V(IEE5603D)                                       Y02669 47092002
IEE928I  DC    CL45'IEE928I DISPLAY AREA ID''S FOR CONSOLE CC ARE'      47100001
IEE929I  DC    C'IEE929I '                                              47200001
IEE922I  DC    C'IEE922I'                                        Y02669 47210002
LEQUALS  DC    C',L='                                            Y02669 47600002
KA       DC    C'A '                                                    47800001
KAREF    DC    C'A,REF '                                                47900001
KANONE   DC    C'K A,NONE '                                      Y02669 47900102
KT       DC    C'T '                                             Y02669 47900402
KTREF    DC    C'T,REF '                                         Y02669 47900802
KTUTME   DC    C'K T,UTME='                                      Y02669 47901202
DESCR    DC    B'00001000000000000000000000000000' DESCRIPTOR CODE+RT   47901602
         SPACE 2                                                        47902002
*********************************************************************** 47910002
*                                                                     * 47920002
*                          PATCH AREA                                 * 47940002
*                                                                     * 47960002
*********************************************************************** 47980002
PATCH1   DC    C'***PATCH AREA***'                                      48000001
PATCH2   DC    C'IEE6903D-TEST'                                         48100001
PATCH3   DC    36C' '                                                   48150001
         EJECT                                                          48300001
         IEETDCM                                                 Y01012 48800001
         EJECT                                                          48900001
         IEECUCM FORMAT=NEW                                             49100002
         EJECT                                                          49150002
         IEERDCM                                                        49300002
         EJECT                                                          49450002
FAUXSA   DSECT                                                          49500001
         IEEXSA                                                         49600001
         EJECT                                                          49650002
CVTSECT  DSECT                                                          49700001
         CVT                                                            49800001
         EJECT                                                          49850002
         IEFPTRS                                                        49900002
         EJECT                                                          49950002
         IHAPSA                                                         50000002
         END                                                            50100001
./  ADD  SSI=73220183,NAME=IEE70110
         TITLE 'IEE70110, HALT / SWITCH COMMAND PROCESSOR'              00050002
IEE70110 CSECT                                                          00060002
*MODULE NAME= IEE70110                                                  00100002
*                                                                       00200002
*DESCRIPTIVE NAME= HALT END-OF-DAY , SWITCH SMF PROCESSOR               00250002
*                                                                       00300002
*COPYRIGHT= N/A                                                         00350002
*                                                                       00400002
*STATUS= OS/VS2  RELEASE 2                                              00450002
*                                                                       00500002
*FUNCTION= TO PROCESS HALT-E-O-D , AND SWITCH SMF COMMANDS              00550002
*  OPERATION=                                                           00600002
*              ENTRY TO THIS MODULE IS VIA AN ATTACH FROM MODULE        00610002
*              IEEVWAIT .                                               00620002
*              0- ON ENTRY , CORE IS GOTTEN FOR A DUMMY EXTENDED SAVE   00630002
*                 AREA ( XSA ) OF 88 BYTES. (NOT FULL XSA SIZE).        00640002
*                 RETURN ADDRESS IS SAVED FOR EXIT PROCESSING .         00642002
*                 BRANCH TO MODULE IEECB860 TO CREATE A STAE            00644002
*                 ENVIRONMENT .                                         00646002
*                 . IF NOT SUCCESSFUL , (REG15 = ZERO) ,               00648002
*                   . SET XSA( XAE ) = X'80' - STAE FAIL                00648402
*                   . PROCESS AT REF(7)                                 00648802
*              1- ON ENTRY , REG 1 CONTAINS A PTR TO THE CSCB .         00650002
*                 SET MSG CODE REG TO NOT SUCCESSFUL (DEFAULT)          00700002
*                 DETERMINE WHICH VERB TO PROCESS VIA CSCB(CHVCD) -     00710002
*                 . IF SWITCH , CHECK FOR SMF DATA SET PRESENT -        00720002
*                   SMCA(SMCAMAN = ON )                                 00730002
*                   . IF NOT , PROCESS AT REF(6).                       00740002
*                   . IF YES , CHECK FOR SWITCH ALREADY IN EFFECT , OR  00742002
*                     SMF DATA SET UNAVAILABLE - SMCA(SMCADSSW,SMCADSTR 00744002
*                     = ON ) :                                          00744402
*                     . IF EITHER ON , PROCESS AT REF(6) .              00744802
*                 . IF HALT , AN SVC(76) IS EXECUTED TO UPDATE THE      00745202
*                   SYS1.LOGREC DATA SET .                              00745602
*              2- SAVE X OR Y PORTION OF MAN DSN IN XAN FIELD  @ZA27079 00746003
*                 OF BLOCK XSA.                                @ZA27079 00746503
*                 IF THE SMF VOLUME OPTION WAS SELECTED , A SCAN        00747003
*                 OF UCBS FOR DIRECT ACCESS DEVICES IS ENTERED ,        00748002
*                 AND AN SVC(78) LSPACE MACRO IS ISSUED FOR EACH        00748402
*                 DEVICE .                                              00748802
*              3- IF SMF ACTIVE SET UP SMF RECORD FOR SVC(83).          00749202
*                 SET SECOND WORD EQUAL 'HALT' ,                        00749602
*                 ISSUE SVC(83) , TO MAKE SMF AWARE OF HALT / SWITCH    00749702
*                 PROCESSING .                                          00749802
*              4- IF THE COMMAND WAS 'SWITCH SMF' , BYPASS LOG          00766602
*                 PROCESSING , SET MSG CODE REG. = X'FF' ,              00776602
*                 PROCESS AT REF(7) .                                   00778602
*              5- DETERMINE IF THE SYSTEM LOG IS SUPPORTED -            00780602
*                 BASEA(BALOG) =ZERO .                                 00782602
*                 . IF ZERO , SET MSG CODE REG. = 1 FOR E-O-D           00783002
*                   SUCCESSFUL , PROCESS AT REF(6) .                    00783102
*                 SET UP FOR LOG TERMINATION .                          00783202
*                 . IF LOG TERMINATION IS ALREADY TAKING PLACE -        00793202
*                   LCA( POSTCLOZ = ON ) - BYPASS POST OF LOG ECB .     00803202
*                   PROCESS AT REF(6) .                                 00813202
*                 SET LCA( POSTCLOZ ) BIT ON                            00815202
*                 POST LOG CLOSE ECB -                                  00817202
*              6- SET UP TO BRANCH TO MSG MODULE IEE90110 .             00819202
*                 INITIALIZE THE EXTENDED SAVE AREA ( XSA ) FIELDS      00821402
*                 AS REQUIRED BY THE COMMAND BEING PROCESSED .          00821802
*              7- FREE AND DELETE THE CSCB VIA SVC(34) .                00821902
*              8- CHECK MSG CODE IN XSA(XAE) = X'FF'                    00825402
*                 . IF YES, ENTRY IS FOR SWITCH SUCCESSFUL ,            00827402
*                   BYPASS CALL OF MSG MODULE IEE90110 .                00827802
*                   PROCESS AT REF(9) .                                 00828202
*                 CHECK XSA(XAD) = X'80' -                              00828602
*                 . IF YES , ENTRY IS FOR STAE FAILURE .                00828702
*                   PROCESS AT REF(9) .                                 00828802
*                 BRANCH TO IEE90110 , WHICH WILL ISSUE AN APPROP-      00829002
*                 RIATE MSG DEPENDING ON THE MSG CODE IN XSA(XAE) .     00832502
*              9- ON RETURN FROM IEE90110 , RESTORE RETURN ADDRESS IN   00836002
*                 REG 14 , FREE GOTTEN CORE , , RETURN TO CALLER .      00839502
*                                                                       00843002
*NOTES                                                                  00846502
*  DEPENDENCIES= REFER TO MACRO SECTION .                               00850002
*    CHARACTER-CODE DEPENDENCIES=                                       00900002
*              THIS MODULE HAS BEEN CODED IN SUCH A WAY THAT ,          00910002
*              IF THE CHARACTER CODE IS CHANGED FROM EBCDIC ,           00920002
*              REASSEMBLY WILL YIELD A VALID MODULE .                   00930002
*  RESTRICTIONS= NONE .                                                 00950002
*  REGISTER-CONVENTIONS= PROGRAM EQUATES SECTION , 'REGISTERS USED'     01000002
*  PATCH-LABEL= PATCH                                                   01050002
*                                                                       01100002
*MODULE TYPE= CSECT                                                     01150002
*  PROCESSOR= ASSEM                                                     01200002
*  MODULE SIZE= 648 BYTES                                               01250002
*  ATTRIBUTES=                                                          01300002
*              REENTRANT                                                01310002
*              SUPERVISOR PROTECT KEY                                   01320002
*              SUPERVISOR MODE                                          01330002
*              MASTER SCHEDULER REGION .                                01340002
*                                                                       01350002
*ENTRY POINT= IEE70110                                                  01400002
*  PURPOSE= HALT E-O-D , SWITCH SMF                                     01450002
*  LINKAGE= FROM IEEVWAIT , VIA ATTACH .                                01500002
*  INPUT= REG 1 - PTR TO CSCB .                                         01550002
*  REGISTERS SAVED= REG 14 .                                            01600002
*  REGISTER USAGE= REFER TO REG . CONVENTION SECTION .                  01650002
*  REGISTERS RESTORED= REG 14 .                                         01700002
*                                                                       01750002
*EXIT - NORMAL= RETURN TO CALLER .                                      01800002
*  CONDITION= NORMAL PROCESSING OF THE COMMAND .                        01850002
*  OUTPUT=                                                              01900002
*              N/A                                                      01910002
*  RETURN CODES= NONE .                                                 01950002
*                                                                       02000002
*EXIT - ERROR= N/A                                                      02050002
*  CONDITIONS=                                                          02100002
*  OUTPUT=                                                              02150002
*  RETURN CODES=                                                        02200002
*                                                                       02250002
*EXTERNAL REFERENCES= IEEMB803 - LOG TASK - VIA POST .                  02300002
*  ROUTINES= IEE90110 MESSAGE MODULE WITH A MSG CODE -                  02350002
*                   01 - EOD SUCCESSFUL .                               02360002
*                   02 - SWITCH UNSUCCESSFUL .                          02370002
*            IEECB860  STAE ISSUING RTN .                               02380002
*  DATA AREAS=                                                          02400002
*              DUMMY EXTENDED SAVE AREA .                               02410002
*  CONTROL BLOCKS=                   REFERENCES                         02450002
*          SYMBOL DEFINITIONS - C = CREATE, F = FREE, R = READ,         02460002
*                               W = WRITE.                              02470002
*              CVT                     R                                02500002
*              CSCB                    R,F                              02560002
*              BASEA                   R,W                              02570002
*              UCB                     R                                02580002
*              LCA                     R,W                              02590002
*              SMCA                    R                                02592002
*              XSA                   C,R,W,F                            02594002
*                                                                       02600002
*TABLES=                                                                02650002
*                                                                       02700002
*MACROS=                                                                02750002
*              MODID                                                    02760002
*              GETMAIN / FREEMAIN                                       02770002
*              LOAD / DELETE                                            02780002
*              POST                                                     02790002
*              MGCR  (SVC 34 )                                          02792002
*              SVC (76 ) STATISTICAL UPDATE MACRO                       02794402
*              SVC (78 ) LSPACE MACRO                                   02794802
*              SVC ( 83 ) SMF PROCESSING MACRO                          02795202
*                                                                       02796002
*  SERIALIZATION= NONE .                                                02800002
*                                                                       02900002
*CHANGE ACTIVITY= OZ27079                                      @ZA27079 02950003
*                                                                       03000002
*SYSGENS=                                                               03010002
*              LOAD MODULE NAME = IEE70110                              03020002
*              LPALIB NAME = IEE70110                                   03030002
*SYSTEM LIBRARIES = NONE .                                              03032002
*                                                                       03040002
*MESSAGES= NONE .                                                       03050002
*                                                                       03100002
*ABEND CODES= NONE .                                                    03150002
*                                                                       03200002
*********************************************************************** 03250002
         EJECT                                                          04286002
* A-191850                                                     @YM3373P 04386002
* A-126000,126500,126600                                       @YA02504 04486002
* A-NEAR LABEL STARTSMF                                        @ZA27079 04516003
* A-NEAR LABEL ENDSRCH                                         @ZA27079 04546003
* REGISTER USAGE                                                        04600002
PARREG0  EQU   0                        PARAMETER REGISTER.             04650001
R0       EQU   0                                                    SMF 04700001
R1       EQU   1                                                    SMF 04750001
R2       EQU   2                   CSCB BASE REG                 YM1294 04850002
R3       EQU   3                                                        05000002
MRC3     EQU   3                  BASE MASTER RESIDENT DATA AREA        05050002
CVT3     EQU   3                       BASE CVT                         05100002
R4       EQU   4                                                  M4393 05200001
R5       EQU   5                       REG POINTS TO OPERAND            05250002
R6       EQU   6                   DUMMY XSA ADDRESS                    05300002
R7       EQU   7                   SMCA ADDRESS REGISTER            SMF 05350001
R8       EQU   8                                                        05360002
R9       EQU   9                                                        05370002
WKREG    EQU   8                       CODE REGISTER                    05400001
WKREG1   EQU   9                                                    SMF 05450001
*                                      FOR EXTENDED SAVE AREA           05650001
R10      EQU   10                                                       05700002
R11      EQU   11                                                       05750002
R12      EQU   12                                                       05760002
BASEREG  EQU   12                      BASE   REGISTER                  05800001
R13      EQU   13                                                       05810002
R14      EQU   14                  RETURN REGISTER                      05850002
R15      EQU   15                  BRANCH REGISTER                      05900002
LOG15    EQU   15                      POINTER TO LOG CONTROL AREA      05910002
* PROGRAM EQUATES                                                       05920002
EODSUCC  EQU   1                   MSG CODE - 'EOD SUCCESSFUL'          05930002
RECSIZE  EQU   88                  SIZE OF GOTTEN CORE .                05950002
STATS    EQU   76                  SVC STATISTICAL UPDATE               06000002
WRITERCD EQU   83                  SVC NUMBER FOR SMF WRITE         SMF 06350001
D4       EQU   4                                                        06400002
D12      EQU   12                                                       06450002
DEC0     EQU   0                                                        06600002
DEC2     EQU   2                                                        06650002
DEC4     EQU   4                                                        06652002
DEC16    EQU   16                                                       06700002
DEC64    EQU   64                      OFFSET TO XSA SAVE AREA          06750002
HEX40    EQU   64                                                       06850002
HEX3C    EQU   60                                                       06900002
HEX0F    EQU   X'0F'                                              M4393 06950001
HEXFF    EQU   X'FF'                   NO MESSAGE INDICATOR             07000002
LSPACE   EQU   78                                                       07050002
NOEOD    EQU   02                                                YM1294 07100001
         EJECT                                                          07250001
         BALR  BASEREG,0               ESTABLISH ADDRESSIBILITY FOR     07350001
*                                      MODULE                           07400001
         USING *,BASEREG                                                07450001
         MODID BRANCH=YES                                        Y01886 07460002
         LR    R2,R1                    SET UP CSCB WORK REG     Y02669 07462002
         L     R0,SIZE                  GETMAIN SIZE             Y02669 07470002
         GETMAIN R,LV=(0)                                        Y02669 07480002
         LR    R6,R1                    SET XSA ADDRESSIBILITY   Y02669 07490002
         XC    0(RECSIZE,R6),0(R6)      ZERO OUT WORK CORE       Y02669 07500002
         USING EXSAVSEC,R6              XSA ADDRESSIBILITY              07510002
         ST    R14,XASVRB(R6)           SAVE RETURN ADDRESS      Y02669 07520002
         USING CCHAIN,R2                BASE CSCB                YM1294 07550001
         BAL   R5,STAERTN               SET UP STAE ENVIRONMENT  Y02669 07600002
         CLC   XAD,HIORDER              STAE SUCCESSFUL ?        Y02669 07650002
         BE    PXCTL2                   NO , SET UP RETURN TO CALLER    07700002
         L     R7,CVTPTR                SET UP TO CHECK                 09250002
         USING HCVT,R7                  FOR SMF OPTION                  09300002
         L     R7,CVTSMCA               GET OPTION INDICATOR            09350002
         LA    WKREG,NOEOD              SET POSSIBLE NOT         YM1294 09400002
*                                            SUCCESSFUL MESSAGE  YM1294 09410002
         DROP R7                                                        09450002
         USING SMCABASE,R7              SET ADDRESSIBILITY-SMCA         09500002
         CLI   CHVCD,HEX3C              IS THE VERB HALT?        YM1017 09510001
         BE    SWCHK                    YES, BYPASS CHECK FOR    YM1017 09520002
*                                            SWITCH DATA SETS    YM1017 09530002
         LTR   R7,R7                    SMF ACTIVE ?                    09540002
         BZ    PXCTL                    NO , SKIP SWITCH PROCESSING     09542002
         TM    SMCAMISC,SMCAMAN         SYS1.MAN PRESENT?        YM1294 09550001
         BZ    PXCTL                    NO, SKIP SMF PROCESSING  YM1294 09600001
SWCHK    EQU   *                                                 YM1017 09810002
         CLI   CHVCD,HEX3C              ENTRY FOR HALT?          YM1294 09850001
         BNE   SMFSTART                 NO- GO DIRECTLY TO SMF          09900002
*    *    *    *    *    *    *     *     *     *     *     *           09950002
* ENTRY WAS MADE FOR A HALT COMMAND IN A SYSTEM WITH SMF                10000002
*     *     *     *     *     *     *     *     *     *     *           10050002
         SR    PARREG0,PARREG0          CLREA PARM REGISTER             10100002
         SVC   STATS                    UPDATE STATISTICS               10150002
         LTR   R7,R7                    SMF IN SYSTEM ?          Y02669 10200002
         BZ    CKSMF                    NO , BYPASS SMF PROCESSING      10202002
         EJECT                                                          10210002
* THE FOLLOWING ROUTINE WILL GENERATE A HALT MESSAGE FOR SMF,       SMF 10250001
* IF SMF IS SUPPORTED, AND WILL CAUSE THE SMF BUFFER TO BE PURGED.  SMF 10300001
*                                                                   SMF 10350001
SMFSTART EQU   *                                                    SMF 10400001
*                                                              *        10450002
*  THIS IS A COMMON ENTRY POINT FOR BOTH HALT AND SWITCH SMF CMNDS .    10460002
*  THE FOLLOWING CODE ISSUES THE LSPACE SVC AGAINST ALL ONLINE *        10500002
*  DIRECT ACCESS DEVICES. THIS CAUSES SMF TYPE 19 RECORDS TO BE*        10550002
*  ISSUED THUS SUPPLYING VOLUME SPACE USAGE AT HALT TIME       *        10600002
*                                                              *        10650002
         TM    SMCAMISC,SMCAMAN          MAN=ALL?                Y02669 10660002
         BZ    CKSMF               CONTINUE WITH HALT PROCESSING YM1294 10670001
         MVC   XAN,SMCAXORY        SAVE X OR Y BYTE OF         @ZA27079 10680003
*                                  RECORDING DATA SET NAME     @ZA27079 10690003
         TM    SMCAOPT,SMCAVOL     IS VOLUME ACCTING SUPPORTED          10700002
         BZ    ENDSRCH             NO, PROCEED TO BUFFER PURGE          10750002
         L     WKREG,CVTPTR        PT TO CVT AND ESTABLISH ADDR         10900002
         USING   HCVT,WKREG                                             10950002
         L     WKREG,CVTILK2        OF UCB POINTER TABLE                11000002
         LR    R3,WKREG                 SAVE TABLE START ADDR     M4393 11050001
         DROP  WKREG                                                    11100002
         L     R1,HIORDER          SETUP R1 INTERFACE TO LSPACE         11150002
SEARCH   EQU   *                                                        11200002
         LH    WKREG1,DEC0(WKREG)  GET POSSIBLE UCB PTR                 11250002
         LA    WKREG,DEC2(WKREG)   GET ADDR OF NEXT UCB PTR             11300002
         CH    WKREG1,FFFF         HAS END OF TABLE BEEN REACHED        11350002
         BE    ENDSRCH             YES, END SEARCH                      11400002
         LTR   WKREG1,WKREG1       IS THE PTR ZERO                      11450002
         BZ    SEARCH              IF SO, GET NEXT PTR                  11500002
         SLL   WKREG1,DEC16        CLEAR PROPAGATION                    11550002
         SRL   WKREG1,DEC16          BITS                               11600002
         USING UCBOB,WKREG1                                             11650002
         TM    SRTESTAT,SRTEONLI   IS DEVIC ONLINE                      11700002
         BZ    SEARCH              NO                                   11750002
         TM    UCBTBYT3,UCB3DACC   IS DEVICE DIRECT ACCESS              11800002
         BZ    SEARCH              NO                                   11850002
         TM    UCBFL1,UCBNRY       IS DEVICE NOT READY           Y02669 11900002
         BO    SEARCH              DEVICE NOT READY, GET NEXT           11950002
         TM    UCBFL5,UCBALTPH     DEVICE HAVE ALTERNATE PATHS ? Y02669 12000002
         BZ    PATHOK              NO , GO ISSUE LSPACE MACRO     M4393 12050002
*                                                                       12052002
* SET UP TO SCAN UCB TABLE FOR PREVIOUS ENTRY FOR SAME UCB .            12060002
* IF FOUND , BYPASS LSPACE MACRO FOR THIS ENTRY .                       12070002
* IF NOT FOUND , PROCESS LSPACE MACRO FOR ENTRY .                       12080002
*                                                                       12090002
         LR    R4,R3                    INITIALIZE SEARCH INDEX   M4393 12100001
         LR    R10,R8                  PICK UP NEXT ENTRY ADDR   Y02669 12110002
         SH    R10,TWO                 POINT BACK TO CURRENT ENTRY ADDR 12120002
CKPATH   EQU   *                                                        12122002
         CR    R10,R4                  IS THIS CURRENT ENTRY ?   Y02669 12130002
         BE    PATHOK                  YES, NO DUPLICATE FOUND   Y02669 12140002
         CH    WKREG1,DEC0(R4)         DUPLICATE UCB ADDRESS ?   Y02669 12142002
         BE    SEARCH                   BRANCH IF YES             M4393 12400001
         LA    R4,DEC2(R4)              INCREMENT INDEX           M4393 12450001
         B     CKPATH                   CONTINUE SEARCH           M4393 12500001
PATHOK   EQU   *                                                  M4393 12550001
* VTOC POINTER CAN ONLY BE ZERO IF NO VOLUME OR NON-OSVOLUME.  @YA02504 12580002
         OC    UCBVTOC(3),UCBVTOC CHECK FOR INVALID VOLUME     @YA02504 12610002
         BZ    SEARCH             BRANCH NOT VALID FOR LSPACE  @YA02404 12640002
         LR    R0,WKREG1           POINT LSPACE TO UCB                  12700002
         SVC   LSPACE              ISSUE LSPACE SVC                     12750002
         B     SEARCH              GET NEXT UCB CANDIDATE               12800002
ENDSRCH  EQU   *                                                        13550002
         CLC   XAN,SMCAXORY        WAS AN INTERNAL SWITCH DONE @ZA27079 13600003
         BE    HALT                NO CONTINUE                 @ZA27079 13650003
         CLI   CHVCD,HEX3C         IS THIS A HALT COMMAND      @ZA27079 13700003
         BNE   CKSMF               NO, BYPASS THE HALT         @ZA27079 13750003
HALT     EQU   *                                               @ZA27079 13800003
         MVC   4(4,R6),AHALT      PLACE HALT IN RECORD TO        Y01034 19050001
         LR    R1,R6              INDICATE BUFFER PURGE          Y01034 19100001
         SVC   WRITERCD                                           SMF1  19150001
         XC    4(4,R6),4(R6)            ZERO FIELD               Y02669 19160002
         LTR   R15,R15                 SVC SUCCESSFUL ?          Y02669 19170002
         BZ    CKSMF                   YES , CONTINUE PROCESSING Y02669 19180002
         LA    WKREG,NOEOD          RESET NOT SUCCESSFUL CODE  @YM3373P 19185002
         CLI   CHVCD,HEX3C             THIS HALT COMMAND ?       Y02669 19190002
         BNE   PXCTL                   NO , INDICATE SWITCH FAILED      19200002
         EJECT                                                          19210002
CKSMF    EQU   *                                                        19350002
         LA    WKREG,HEXFF             INDICATE NO MESSAGE              19400002
         LA    R5,CHBUF                PICK UP COMMAND OPERAND   YM1294 19410001
         CLC   0(4,R5),ASMF            CHECK SMF                        19450002
         BE    PXCTL3                  BRANCH IF YES             Y02669 19500002
         L     CVT3,16                 SET POINTER TO CVT               19600002
         USING HCVT,CVT3               AND BASE CVT                     19650002
         L     MRC3,CVTMSER            GET POINTER TO MASTER RESIDENT   19700002
         USING BASE,MRC3               CORE AND BASE IT.                19750002
         L     LOG15,BALOG             GET POINTER TO LOG CONTROL       19800002
         LTR   LOG15,LOG15             IS LOG SUPPORTED?                19850002
         BZ    GXCTL                   NO ISSUE EOD SUCCESS MSG.        19900002
         USING LCABASE,LOG15           YES- THEN BASE LCA AND           19950002
*                                      INTERNALLY SIMULATE A            19952002
*                                      WRITELOG CLOSE COMMAND IF        19954002
*                                      ONE IS NOT PENDING               19956002
         TM    LCAPOSTT,POSTCLOZ       IS WRITE CLOSE PENDING ?         19960002
         BO    GXCTL                   IF YES , BRANCH PAST POST        19970002
         STM   R7,R9,DEC64(R6)         SAVE REGS ACCROSS OIL MACRO      19972002
* THE FOLLOWING MACRO SERIALIZES ON THE POSTCLOZ BIT                    19972402
         OIL   LCAPOSTT,POSTCLOZ,WREGS=(7,8,9),REF=LCABASE              19974002
         LM    R7,R9,DEC64(R6)         RESTORE REGS                     19976002
         USING POSTFLD,R1              PARM LIST FOR POST               19990002
         LA    R1,POSTCORE(R6)         ADDRESS OF LIST CORE             19992002
         MVC   POSTFLD(D12),POSTLIST                                    19994002
         USING HCVT,R11                CVT PTR TO CVTBRET               19994402
         L     R11,16                  LOAD CVT PTR                     19994802
         L     R10,LCAASCB             LOG ASCB ADDRESS                 19996002
         POST  MSLGCLOZ,ASCB=(10),ERRET=CVTBRET,MF=(E,(1))              19998002
*                                                                       20102002
         EJECT                                                          20498802
GXCTL    LA    WKREG,EODSUCC           SET FOR XCTL                     20500002
*                                                                       20550001
PXCTL    EQU   *                                                 YM1294 20560001
         CLI   CHVCD,HEX3C             IS VERB HALT?             YM1294 20596001
         BNE   SWITCH                  NO, MUST BE SWITCH        YM1294 20598001
         MVC   XAV(8),AHALT            SET UP XSA FOR HALT       YM1294 20598401
         B     PXCTL2                                            YM1294 20599201
SWITCH   EQU   *                                                 YM1294 20599601
         MVC   XAV(8),ASWITCH          SET UP XSA FOR SWITCH     YM1294 20599701
PXCTL2   EQU   *                                                 YM1294 20599901
         MVC   XAU,CHUCMP              GET UCMI INFO             YM1294 20660001
PXCTL3   EQU   *                                                 Y02669 20670002
         STC   WKREG,XAE               STORE CODE IN EXT SAVE AREA.     20680002
         MVI   CHSTS,CHFC              SET FREE CSCB BITS        YM1294 20710002
         LR    R1,R2                   GET CSCB POINTER          YM1294 20720001
         MGCR (1),CHAIN                FREE CSCB                 YM1294 20730002
         CLC   XAD,HIORDER              STAE IN EFFECT ?         Y02669 20740002
         BE    NOMSG                    NO , BYPASS MSG MODULE   Y02669 20750002
         CLI   XAE,HEXFF                MSG CODE = SWITCH SUCCESSFUL ?  20760002
         BE    NOMSG                    YES, BYPASS MSG MODULE   Y02669 20770002
         LR    R1,R6                    XSA ADDR TO REG          Y02669 20800002
         L     R15,VMSGMOD              MESSAGE MOD ADDR         Y02669 20830002
         BALR  14,15                    ISSUE MSG                Y02669 20880002
NOMSG    EQU   *                                                 Y02669 20890002
         L     R14,XASVRB(R6)           RESTORE RETURN ADDR      Y02669 20930002
         LR    R1,R6                    SET UP FREEMAIN          Y02669 21110002
         L     R0,SIZE                  FREE THIS AMOUNT OF CORE Y02669 21120002
         FREEMAIN R,LV=(0),A=(1)        FREE THE CORE            Y02669 21130002
         BR    R14                      RETURN TO CALLER         Y02669 21140002
         EJECT                                                          21140402
STAERTN  EQU   *                                                 Y02653 21142002
* THE FOLLOWING CODE WAS ADDED FOR OS/VS2 R2 ESTAE SUPPORT ,     Y02653 21142402
* UNDER SUPPORT CODE - Y02653                                    Y02653 21142802
* ENTRY HERE IS TO CREATE A STAE ENVIRONMENT FOR THIS RTN VIA A  Y02653 21144002
* BRANCH TO MODULE IEECB860 . IF STAE FAILS , SET XSA(XAD) FIELD Y02653 21146002
* HI-BIT ON FOR CHECK IN MAIN-LINE PATH , RETURN ON LINK REG 5 . Y02653 21148002
         LA    R7,PARMCORE(R6)          PARM LIST ADDRESS        Y02653 21148402
         USING STAEPARM,R7                                       Y02653 21148802
         ST    R2,CSCBADDR              CSCB ADDR TO LIST        Y02653 21149202
         ST    R5,REG5SAVE              LINK REG TO LIST         Y02653 21149602
         ST    R6,REG6SAVE              XSA PTR                  Y02653 21149702
         ST    R12,REG12SAV             BASE REG                 Y02653 21149802
         LOAD  EP=IEECB860              LOAD STAE CREATE RTN     Y02653 21149902
         CLI   CHVCD,HEX3C              HALT COMMAND ?           Y02653 21166602
         BNE   NOTHALT                  NO , ITS SWITCH COMMAND  Y02653 21176602
         LA    R8,HALTCMD               COMMAND PTR FOR HALT     Y02653 21178602
         B     CALLSTAE                                          Y02653 21180602
NOTHALT  EQU   *                                                 Y02653 21182602
         LA    R8,SWITCHCD              COMMAND PTR FOR SWITCH   Y02653 21183002
CALLSTAE EQU   *                                                 Y02653 21183102
         ST    R8,COMMAND               COMMAND PTR TO LIST      Y02653 21183202
         LR    R15,R0                   STAE RTN ADDRESS         Y02653 21188802
         LR    R1,R7                    PARM LIST REG            Y02653 21190802
         BALR  14,15                    GO ISSUE STAE            Y02653 21192802
         LR    R8,R15                   SAVE STAE RETURN CODE    Y02653 21193202
* RESTORE CRITICAL REGS FROM PARM LIST SAVE AREA .               Y02653 21193302
         LR    R7,R1                    RESTORE PARM LIST ADDR   Y02653 21193402
         L     R2,CSCBADDR              CSCB PTR                 Y02653 21193602
         L     R5,REG5SAVE              LINK REG                 Y02653 21194102
         L     R6,REG6SAVE              XSA PTR                  Y02653 21194202
         L     R12,REG12SAV             BASE REG                 Y02653 21194302
         DELETE EP=IEECB860                                      Y02653 21208202
         LTR   R8,R8                    TEST STAE RETURN CODE    Y02653 21218202
         BZ    LINKBK                   O.K.,RETURN VIA LINK REG Y02653 21220202
         MVC   XAD,HIORDER              SET STAE FAIL SWITCH     Y02653 21220602
LINKBK   EQU   *                                                 Y02653 21220702
         BR    R5                       RETURN                   Y02653 21221002
*                                                                       21222202
*                                                                       21236102
         EJECT                                                          21246102
*                                                                       21260402
*                                                                       21260802
*   PROGRAM CONSTANTS                                                   21264002
         DS    0F                                                       21267202
VMSGMOD  DC    V(IEE90110)                                       Y02669 21270402
SIZE     DC    AL1(250),AL3(88)  SIZE OF GETMAIN                 Y01034 21273602
HALTCMD  DC    AL1(L'HC)                COMMAND LENGTH           Y02653 21276802
HC       DC    C'HALT'                  COMMAND VERB             Y02653 21280002
SWITCHCD DC    AL1(L'SC)                COMMAND LENGTH           Y02653 21290002
SC       DC    C'SWITCH'                COMMAND VERB             Y02653 21300002
PATCH    DS    CL52'IEE70110PATCH' AREA FOR TEMPORARY FIXES             21310002
HIORDER  DS    0F                                                       21450002
         DC    X'80000000'         R1 INTERFACE TO LSPACE               21500002
AHALT    DC    CL8'HALT'           HALT VERB                            21600001
ASWITCH  DC    CL8'SWITCH'         SWITCH VERB                   YM1294 21650001
FFFF     DS    0H                                                       21750002
         DC    X'FFFF'             COMPARAND FOR END OF UCB TBL         21800002
TWO      DC    H'2'                UCB SCAN VALUE                       21810002
ASMF     DC    C'SMF '                                                  21850002
POSTLIST POST  ASCB=0,ERRET=0,MF=L                               Y02669 21900002
*                                                                       22000001
*                                                                       22550001
         EJECT                                                          22552002
EXSAVSEC  DSECT                   DSECT FOR EXTENDED SAVE AREA          22560002
         IEEXSA                                                         22570002
         EJECT                                                          22580002
* THIS DSECT IS USED TO MAP THE PARAMETER LIST USED BY STAE RTN .       22590002
STAEPARM DSECT                                                   Y02669 22592002
CSCBADDR DS    F                                                 Y02669 22594002
COMMAND  DS    F                                                 Y02669 22596002
REG5SAVE DS    F                                                 Y02669 22598002
REG6SAVE DS    F                                                 Y02669 22598402
REG12SAV DS    F                                                 Y02669 22598802
PARMEND  EQU   *                                                 Y02669 22599202
PARMSIZE EQU   PARMEND-STAEPARM                                  Y02669 22599602
PARMCORE EQU  XASVRB+DEC4                 STAE PARM LIST ADDR           22599702
POSTCORE EQU  PARMCORE+PARMSIZE           OFFSET OF POST CORE           22606402
* THIS DSECT IS USED TO MAP THE PARM LIST FOR LOG TERMINATION POST .    22613102
POSTFLD  DSECT                                                   Y02669 22619802
ECBAD    DS    F                                                 Y02669 22626502
ASCBAD   DS    F                                                 Y02669 22633202
ERRAD    DS    F                                                 Y02669 22683202
         EJECT                                                          22693202
         IEESMCA                                                        22695202
         EJECT                                                          22697202
CCHAIN   DSECT                                                          22699202
         IEECHAIN                                                       22699602
         EJECT                                                          22700002
UCBSECT  DSECT                                                          23650002
         IEFUCBOB                                                       23700001
         EJECT                                                          23710002
         TITLE ' COMMUNICATIONS VECTOR TABLE '                          23750001
HCVT     DSECT                                                          23800001
         CVT                                                            23850001
         EJECT                                                          23860002
         TITLE ' MASTER RESIDENT CORE '                                 23900001
         IEEBASEA                                                       23950001
         EJECT                                                          24000001
         TITLE ' LOG CONTROL AREA '                                     24050001
         IEELCA                                                         24100001
         EJECT                                                          24150001
         IEFPTRS                                                        24160002
         END                                                            24299902
./  ADD  SSI=80860118,NAME=IEE7103D
         TITLE 'IEE7103D - MONITOR PROCESSOR'                           00217502
*********************************************************************** 00220202
*                                                                     * 00220602
* MODULE NAME      =   IEE7103D                                 Y02669* 00221002
*                                                                     * 00221602
* DESCRIPTIVE NAME =   MONITOR COMMAND PROCESSOR                Y02669* 00223702
*                                                                     * 00225802
* COPYRIGHT        =   N/A                                      Y02669* 00227902
*                                                                     * 00230002
* STATUS           = OS/VS2 RELEASE 037                       @ZA30320* 00232100
*                                                                     * 00234202
* FUNCTION         =   THIS MODULE DETERMINES AND PROCESSES     Y02669* 00236202
*                      THE MONITOR COMMAND OPERANDS: SESS(,T);  Y02669* 00238202
*                      JOBNAMES(,T); STATUS; DSNAME; SPACE.     Y02669* 00238602
*                                                                     * 00240502
* OPERATION        =   THE MONITOR COMMAND OPERANDS             Y02669* 00242502
*                      RECOGNIZED BY IEE7103D AND THEIR         Y02669* 00242902
*                      VALIDITY ARE AS FOLLOWS:                 Y02669* 00243302
*                                                                     * 00243702
*                                  INPUT   TIME     SUBSYSTEM  @Y02668P 00243803
*                                  STREAM  SHARING  CONSOLE    @Y02668P 00254403
*                                  OR      (OPERATOR  (JES3)   @Y02668P 00256403
*                                  CONSOLE MODE)               @Y02668P 00258403
*                                                              @Y02668P 00260403
*                      JOBNAMES(,T)  VALID   VALID   INVALID   @Y02668P 00262403
*                      STATUS        VALID   VALID   INVALID   @Y02668P 00267003
*                      SESS(,T)      VALID   VALID   INVALID   @Y02668P 00270003
*                      SPACE         VALID  INVALID   VALID    @Y02668P 00273003
*                      DSNAME        VALID  INVALID   VALID    @Y02668P 00276003
*                                                              @Y02668P 00278003
*                      IEE7103D, DEPENDING ON THE COMMAND       Y02669* 00281603
*                      SOURCE, REGISTERS MONITOR REQUESTS BY    Y02669* 00283703
*                      SETTING THE BITS IN THE APPROPIATE       Y02669* 00285903
*                      MONITOR CONTROL BLOCKS AND COMMON        Y02669* 00287903
*                      DATA AREAS:                              Y02669* 00289903
*                                                                     * 00291903
*                      SOURCE       CONTROL BLOCK  COMMON AREA  Y02669* 00293903
*                      -------      -------------  -----------  Y02669* 00295903
*                      ISSUED INTERNALLY UCME          BASEA    Y02669* 00297903
*                      INPUT STREAM      UCME          BASEA    Y02669* 00299903
*                      OPERATOR CONSOLE  UCME          BASEA    Y02669* 00301903
*                      TIME SHARING                             Y02669* 00303903
*                       (OPERATOR MODE)  MQE           BASEA    Y02669* 00305903
*                                                                     * 00307903
*                      IEE7103D INTERFACES WITH COMMUNICATIONS  Y02669* 00309903
*                      TASK, IEAVMNTR (MONIOTR QUEUE MANAGER),  Y02669* 00311903
*                      VIA IEZMPL (MONITOR PARAMETER LIST)      Y02669* 00313903
*                      TO SET THE BITS AND FIELDS FOR MONITOR   Y02669* 00315903
*                      JOBNAMES; SESS; AND STATUS IN BASEA, THE Y02669* 00319903
*                      UCME, AND MQE (MONITOR QUEUE ELEMENT).   Y02669* 00320903
*                      THE VECTOR FOR IEAVMNTR IS FOUND IN THE  Y02669* 00322903
*                      UCM (UCMMNTR).                           Y02669* 00324903
*                                                                     * 00326903
*                      THE BITS IN BASEA FOR THE T (TIME);      Y02669* 00328903
*                      DSNAME; AND SPACE OPERANDS ARE SET       Y02669* 00330903
*                      WITHIN THIS MODULE.                      Y02669* 00332903
*                                                                     * 00334903
* NOTES                IF THE MONITOR COMMAND IS ENTERED THRU   Y02669* 00338903
*                      THE INPUT STREAM OR ISSUED INTERNALLY,   Y02669* 00341003
*                      THE CONSOLE ID (XAU) WILL BE X'00'.      Y02669* 00341703
*                                                                     * 00344103
*                      IF THE ISSUING CONSOLE IS PART OF A      Y02669* 00346103
*                      COMPOSITE CONSOLE XAU WILL CONTAIN       Y02669* 00348503
*                      THE CONSOLE ID OF THE INPUT DEVICE.      Y02669* 00349903
*                                                                     * 00352203
*    CHARACTER-CODE                                             Y02669* 00355703
*     DEPENDENCIES =   ANY CHARACTER CODE OTHER THAN EBCDIC     Y02669* 00356703
*                      WILL REQUIRE REASSEMBLY OF THIS MODULE.  Y02669* 00359203
*                                                                     * 00361203
*    DEPENDENCIES  =   SVC 100 WILL NOT PERMIT ANY TIME SHARING Y02669* 00362203
*                      USERS TO ISSUE MONITOR DSNAME; OR SPACE. Y02669* 00364203
*                                                                     * 00368103
*                      CHECK THE UCMDISPK BIT. IF THE BIT      @Y02668P 00370103
*                      IS ON, A SUBSYSTEM CONSOLE ISSUED THE   @Y02668P 00373103
*                      COMMAND ONLY MN DSNAME AND MN SPACE ARE @Y02668P 00375103
*                      VALID                                   @Y02668P 00377103
*                                                                     * 00380903
*                      IEE0403D TO RECOGNIZE THE MONITOR        Y02669* 00381903
*                      COMMAND AND ROUTE THE OPERAND            Y02669* 00382903
*                      INFORMATION IN THE XSA.                  Y02669* 00383903
*                                                                     * 00384903
*                      MONITOR QUEUE MANAGER (IEAVMNTR) TO      Y02669* 00387203
*                      UPDATE THE PROPER FIELDS IN THE UCME,    Y02669* 00387303
*                      BASEA, AND MQE (MONITOR REQUEST ELEMENT) Y02669* 00390603
*                      BASED ON INFORMATION PASSED TO IT IN     Y02669* 00391603
*                      IEZMPL.                                  Y02669* 00393903
*                                                                     * 00397203
*                      THE STAE EXIT FOR SVC 34 SHOULD EXPECT   Y02669* 00398203
*                      AN ABEND 077 FROM COMMUNICATIONS TASK    Y02669* 00400503
*                      (IEAVMNTR) IF THE IEZMPL PARAMETER LIST  Y02669* 00403803
*                      CONTAINS INVALID INFORMATION.            Y02669* 00404803
*                                                                     * 00405803
*                      IEEBASEA, IEECUCM, IEEXSA WILL BE        Y02669* 00410303
*                      UPDATED TO REFLECT THE NEW FIELDS.       Y02669* 00410403
*                                                                     * 00413703
*                      A MAPPING MACRO MUST BE PROVIDED FOR     Y02669* 00414703
*                      IEZMPL.                                  Y02669* 00417003
*                                                                     * 00420303
*    RESTRICTIONS  =   TIME SHARING USERS ARE NOT PERMITTED     Y02669* 00421303
*                      TO ISSUE MONITOR DSNAME OR SPACE.        Y02669* 00423603
*                      (SEE DEPENDENCIES)                       Y02669* 00426903
*                                                                     * 00427903
*    REGISTER/                                                  Y02669* 00430203
*     CONVENTIONS  =   IEE7103D WILL SUPPLY AN 18 WORD          Y02669* 00431203
*                      SAVE AREA POINTED TO BY REGISTER 13      Y02669* 00433503
*                      WHEN CALLING IEAVMNTR.                   Y02669* 00436803
*                      THE SAVE AREA IS PART OF THE XSA.        Y02669* 00437803
*                                                                     * 00440103
*    PATCH-LABEL   =   PATCH                                    Y02669* 00443403
*                                                                     * 00444403
* MODULE TYPE      =   CSECT                                    Y02669* 00446703
*                                                                     * 00450003
*    PROCESSOR     =   N/A                                      Y02669* 00451003
*                                                                     * 00453303
*    MODULE SIZE   =   X'26B'                                 @ZA30320* 00454300
*                                                                     * 00456603
*    ATTRIBUTES    =   REENTRANT, KEY 0, SUPERVISOR MODE,       Y02669* 00459903
*                      PAGED LPA.                               Y02669* 00460903
*                                                                     * 00463203
* ENTRY POINT      =   IEE7103D FROM IEE0403D                   Y02669* 00466503
*    PURPOSE       =   TO PROCESS THE OPERANDS ON THE MONITOR   Y02669* 00467503
*                      COMMAND                                  Y02669* 00469803
*    LINKAGE       =   BRANCH                                   Y02669* 00471803
*    INPUT DATA    =   REGISTER TWO ADDRESSES THE XSA           Y02669* 00475103
*                       XAL POINTS TO 1ST OPERAND IN THE BUFFER Y02669* 00475503
*                       XAU CONTAINS A CONSOLE UCMI (X'00' -    Y02669* 00479303
*                       ISSUED INTERNALLY OR FROM INPUT STREAM) Y02669* 00480303
*                       XAA CONTAINS AN ASID (X'0000'=NON-TS)   Y02669* 00482503
*                       XAR POINTS TO LENGTH FIELD OF BUFFER    Y02669* 00485503
*                       XAN CONTAINS VERB CODE X'64' - MONITOR  Y02669* 00486503
*                       XAV CONTAINS THE COMMAND VERB           Y02669* 00488503
*                       XAP CONTAINS ADDRESS OF END OF          Y02669* 00490503
*                           BUFFER +1                           Y02669* 00492503
*                                                                     * 00494503
* REGISTERS USAGE                                               Y02669* 00497503
*    SAVED         =   REGISTER 14 IS SAVED, AT COMINTER, IN    Y02669* 00500503
*                      THE XSA (XAS) ONLY WHEN CALLING IEAVMNTR Y02669* 00501503
*                                                                     * 00503503
*    CONTAINED     =   R0    0     USED FOR THE OIL MACRO       Y02651* 00506503
*                      R1    1     PTR TO MONITOR PARM LIST     Y02669* 00507503
*                                  USED FOR THE OIL MACRO       Y02651* 00509503
*                      R2    2     INPUT - POINTER TO XSA       Y02669* 00511503
*                      R3    3     MODULE BASE REGISTER         Y02669* 00513503
*                      R4    4     BASE REG FOR BASEA           Y02669* 00515503
*                      R5    5     PTR TO OPERAND BUFFER        Y02669* 00519502
*                      R6    6     ADDRESS COMPARE TABLE ENTRY  Y02669* 00521502
*                      R7    7     BASE REG FOR CVT             Y02669* 00525602
*                      R8    8     BASE REG FOR UCM             Y02669* 00527302
*                      R9    9     CONTAINS ASID OR UCMI        Y02669* 00529002
*                      R10   10    USED FOR THE OIL MACRO       Y02651* 00530702
*                      R11   11    ADDRESS COMPARE TABLE END    Y02669* 00532402
*                      R12   12    UCM ENTRY BASE REGISTER     @Y02668P 00534103
*                                  DROP IT THEN USE R12 TO     @Y02668P 00534603
*                                  SAVE MPL POINTER            @Y02668P 00535103
*                      R13   13    POINTER TO SAVE AREA         Y02669* 00535802
*                      R14   14    BALR AND RETURN ADDRESS      Y02669* 00537502
*                      R15   15    USED FOR BALR AND BRANCH     Y02669* 00539202
*                                                                     * 00540902
*    RESTORED      =   REGISTER 14 RESTORED AT LABEL COMINTER   Y02669* 00542602
*                      ONLY WHEN RETURNING FROM IEAVMNTR.       Y02669* 00543002
*                                                                     * 00544302
*  *  *  *  *  *  *  *  *  *  *  *  *  *  *  *  *  *  *  *  *  *  *  *  00547702
*                                                                     * 00549402
**EXIT - NORMAL    =   RETURN VIA BR R14 FROM DDSNAME           Y02669* 00551102
*    CONDITIONS    =   MN DSNAME REQUEST REGISTERED IN BASEA    Y02669* 00552802
*    OUTPUT DATA   =   BIT SET IN BASEA                         Y02669* 00563102
*                        BAMONITR - BADSN X'80'                 Y02669* 00573102
*    RETURN CODES  =   NONE                                     Y02669* 00573402
*                                                                     * 00583702
*  *  *  *  *  *  *  *  *  *  *  *  *  *  *  *  *  *  *  *  *  *  *  *  00585702
*                                                                     * 00587702
**EXIT - NORMAL    =   RETURN VIA BR R14 FROM DDSPACE           Y02669* 00588902
*    CONDITIONS    =   MN SPACE REQUEST REGISTERED IN BASEA     Y02669* 00589302
*    OUTPUT DATA   =   BIT SET IN BASEA                         Y02669* 00589402
*                        BAMONITR - BASPACE X'40'               Y02669* 00589502
*    RETURN CODES  =   NONE                                     Y02669* 00589602
*                                                                     * 00590402
*  *  *  *  *  *  *  *  *  *  *  *  *  *  *  *  *  *  *  *  *  *  *  *  00598002
*                                                                     * 00598102
**EXIT - NORMAL    =   BALR 14,15 TO IEAVMNTR FROM COMINTER     Y02669* 00598202
*    CONDITIONS    =   TO HAVE MN JOBNAMES; SESS; OR STATUS     Y02669* 00598402
*                      REQUEST REGISTERED BY COMM TASK          Y02669* 00601002
*    OUTPUT DATA   =   FIELDS SET IN MONITOR PARM LIST          Y02669* 00603002
*                      (IEZMPL) WHOSE ADDRESS IS STORED IN XAR  Y02669* 00603102
*                      WHICH IN TURN IS ADDRESSED BY REG 1.     Y02669* 00604902
*                      (SEE DATA AREAS)                         Y02669* 00608502
*                      REG 13 ADDRESSES 18 WORD SAVE AREA       Y02669* 00610302
*                      IN THE XSA                                       00612102
*    RETURN CODES  =   NONE (HOWEVER, IEAVMNTR WILL ABEND ITS   Y02669* 00613902
*                      CALLER WITH AN '077' IF THE PARM LIST    Y02669* 00615702
*                      CONTAINS INVALID INFORMATION)            Y02669* 00617502
*                      (SEE DEPENDENCIES)                       Y02669* 00619302
*                                                                     * 00621102
*  *  *  *  *  *  *  *  *  *  *  *  *  *  *  *  *  *  *  *  *  *  *  *  00622902
*                                                                     * 00624702
**EXIT - NORMAL    =   RETURN VIA BR R14 FROM COMINTER          Y02669* 00626502
*    CONDITIONS    =   MN JOBNAMES; SESS; OR STATUS REQUEST     Y02669* 00628302
*                      REGISTERED BY COMMUNICATIONS TASK        Y02669* 00630102
*    OUTPUT DATA   =   FIELDS SET IN BASEA AND UCME AND MQE     Y02669* 00631902
*                      VIA COMM TASK (IEAVMNTR)                 Y02669* 00633702
*                      AND IF ,T WAS SPECIFIED THIS MODULE      Y02669* 00635502
*                      WILL HAVE SET MSBTN = X'02' IN BASEA.    Y02669* 00637302
*    RETURN CODES  =   REGISTER 15 WILL CONTAIN A 4 IF A        Y02669* 00639102
*                      GETMAIN ERROR OCCURRED IN IEAVMNTR.      Y02669* 00639502
*                      (MN JOBNAMES; STATUS; SESS FOR TS ONLY)  Y02669* 00639902
*                      SEE ERROR EXIT - IEE0503D                Y02669* 00640302
*                                                                     * 00640902
         EJECT                                                          00642702
*  *  *  *  *  *  *  *  *  *  *  *  *  *  *  *  *  *  *  *  *  *  *  *  00644502
*                                                                     * 00646302
**EXIT - ERROR     =   BRANCH TO IEE0503D FROM D0503D           Y02669* 00648102
*    CONDITIONS    =   TO ISSUE MESSAGE 'IEE305I COMMAND        Y02669* 00649902
*                      INVALID', IF AN INVALID MONITOR OPERAND  Y02669* 00651702
*                      IS FOUND.                                Y02669* 00653502
*                      TO ISSUE MESSAGE 'IEE311I PARAMETER      Y02669* 00655302
*                      MISSING', IF NO OPERAND IS FOUND IN      Y02669* 00657102
*                      THE COMMAND BUFFER.                      Y02669* 00658902
*                      TO ISSUE MESSAGE 'IEE328I COMMAND        Y02669* 00660902
*                      ABORTED', IF IEAVMNTR ENCOUNTERED        Y02669* 00662902
*                      A GETMAIN ERROR FOR A MONITOR REQUEST    Y02669* 00663302
*                      FROM A TIME SHARING USER.                Y02669* 00663702
*                      TO ISSUE MESSAGE 'IEE777I INVALID FROM  @Y02668P 00663903
*                      SUBSYSTEM CONSOLE'. IF MONITOR WAS      @Y02668P 00664103
*                      ISSUED FROM A SUBSYSTEM CONSOLE         @Y02668P 00664303
*    OUTPUT DATA   =   REG 2 POINTS TO XSA WHICH CONTAINS       Y02669* 00668303
*                      ERROR MESSAGE INDEXES FOR IEE0503D:      Y02669* 00672303
*                        XAE WILL CONTAIN  X'05' FOR IEE305I    Y02669* 00676402
*                                          X'0B' FOR IEE311I    Y02669* 00686702
*                                          X'3A' FOR IEE328I    Y02669* 00698902
*                                          X'15' FOR IEE777I   @Y02668P 00699903
*                        XAV STILL CONTAINS THE COMMAND VERB    Y02669* 00701502
*                            FOR THE MESSAGE.                   Y02669* 00703702
*                        XAU STILL CONTAINS THE CONSOLE ID      Y02669* 00705902
*                        XAA STILL CONTAINS ASID IF REQUESTER   Y02669* 00708102
*                            IS TIME SHARING USER ELSE X'0000'  Y02669* 00710302
*    RETURN CODES  =   NONE                                     Y02669* 00712502
*                                                                     * 00714702
*  *  *  *  *  *  *  *  *  *  *  *  *  *  *  *  *  *  *  *  *  *  *  *  00716902
*                                                                     * 00719102
* EXTERNAL                                                      Y02669* 00721302
*    REFERENCES                                                 Y02669* 00723502
*                                                                     * 00725702
*    ROUTINES      =   BALR TO COMMUNICATION TASK (IEAVMNTR)    Y02669* 00727902
*                      TO ADJUST FIELDS IN BASEA, UCME, AND MQE Y02669* 00729902
*                      WITH REG 1 POINTING TO THE ADDRESS       Y02669* 00731902
*                      OF THE IEZMPL (MONITOR PARM LIST)        Y02669* 00732302
*                      AND REG 13 POINTING TO REG SAVE AREA     Y02669* 00733902
*                                                                     * 00735902
*                      BRANCH TO IEE0503D                       Y02669* 00737902
*                                                                     * 00738202
*    DATA AREAS    =   IEZMPL - MONITOR PARAMETER LIST          Y02669* 00748502
*                      ( ORG'ED ON XAX; MAPPED BY IEZMPL;       Y02669* 00758502
*                        ADDRESSED BY XAR WHICH IN TURN         Y02669* 00758602
*                        IS POINTED TO BY REGISTER 1)           Y02669* 00767702
*                         MPLPROC  DS  H     PROCESSING FLAGS   Y02669* 00771502
*                         MPLCONS  EQU X'80'  MPLID=CONSOLE ID  Y02669* 00773402
*                         MPLTERM  EQU X'40'  MPLID=ASID        Y02669* 00775302
*                         MPLSTRT  EQU X'20'  START MONITOR     Y02669* 00777202
*                         MPLSTOP  EQU X'10'  STOP MONITOR      Y02669* 00779102
*                         MPLID    DS  H     CONSOLE ID OR ASID Y02669* 00781002
*                         MPLTYPE  DS  H     MONITOR TYPE FLAGS Y02669* 00782902
*                         MPLJBNM  EQU X'80'  MN JOBNAMES       Y02669* 00784802
*                         MPLSTAT  EQU X'40'  MN STATUS         Y02669* 00786702
*                         MPLSESS  EQU X'04'  MN SESSIONS       Y02669* 00788602
*                         MPLRSV10 DS  H     RESERVED           Y02669* 00790502
*                                                                     * 00792402
*    CONTROL BLOCKS=   CVT        R  -  ADDRESS BASEA & UCM     Y02669* 00796202
*                      IEEBASEA   W  -  TIME/DSNAME/SPACE BITS  Y02669* 00798102
*                      IEEXSA     R  -  INPUT INFORMATION       Y02669* 00800002
*                                 W  -  MONITOR PARM LIST       Y02669* 00839702
*                      IEECUCM    R  -  VECTOR FOR IEAVMNTR     Y02669* 00849702
*                                                                     * 02800001
*    TABLES        =   A COMPARE TABLE IS USED TO VALIDITY      Y02669* 09400002
*                      CHECK THE OPERANDS ON THE MONITOR        Y02669* 09410002
*                      COMMAND.                                 Y02669* 09420002
*                      THE FORMAT OF EACH ENTRY IS THE SAME:    Y02669* 09600002
*                                                                     * 09800001
*                      DLEN   DC   AL1(L'XXX-1) - LENGTH OF     Y02669* 10000002
*                                              SPECIFIC OPERAND Y02669* 10050002
*                      XXX    DC   C'YYYYY' - OPERAND CHARACTER Y02669* 10200002
*                                             REPRESENTATION    Y02669* 10250002
*                                                                     * 10400001
*                      DLEN AND 'XXX' ARE USED IN AN EX OF A    Y02669* 10600002
*                      CLC. IF THE OPERAND MATCHES THE          Y02669* 10800002
*                      ENTERED OPERAND, A BRANCH IS TAKEN TO    Y02669* 10850002
*                      EITHER HANDLE THE COMMAND IN THIS MODULE Y02669* 10900002
*                      OR ELSE BUILT A PARM LIST AND BALR TO    Y02669* 11000002
*                      IEAVMNTR.                                Y02669* 11050002
*                      OTHERWISE, THE REGISTER USED TO ADDRESS  Y02669* 11200002
*                      THE TABLE IS INCREMENTED BY TWO + THE    Y02669* 11400002
*                      VALUE OF DLEN TO REACH THE NEXT TABLE    Y02669* 11650002
*                      ENTRY.                                   Y02669* 11700002
*                                                                     * 11800001
*                      A BRANCH TABLE IS USED IN CONNECTION     Y02669* 12000002
*                      WITH THE COMPARE TABLE. IT CONSISTS OF   Y02669* 12200002
*                      BRANCHES TO THE PROPER OPERAND           Y02669* 12202002
*                      PROCESSORS. AN INDEX REGISTER IS         Y02669* 12400002
*                      MAINTAINED THROUGHOUT THE SCAN OF THE    Y02669* 12450002
*                      COMPARE TABLE. THIS IS USED AT DBRANCH   Y02669* 12600002
*                      TO GIVE CONTROL TO THE INDICATED         Y02669* 12800002
*                      PROCESSOR INDEXED INTO THE BRANCH TABLE. Y02669* 13000002
*                                                                     * 13200001
*    MACROS        =   MODID                                    Y02669* 13210002
*                      OIL FOR SERIALIZATION ON BASEA BITS      Y02651* 13211202
*                                                                     * 13212002
*    SERIALIZATION =   BASEA - OIL FOR TIME/DSNAME/SPACE FIELDS Y02651* 13214002
*                                                                     * 13216002
*    ENQUEUE                                                    Y02669* 13220002
*     RESOURCES    =   NONE                                     Y02669* 13250002
*                                                                     * 13260002
*    CHANGE LEVEL  =   Y02669                                   Y02669* 13350002
*                      Y02651                                   Y02651* 13352002
*                      YM1911 (PROLOGUE & COMMENT CHANGES ONLY) YM1911* 13356002
*                      Y02668                                 @Y02668P* 13360003
*                      ZA30198                                        * 13363000
*                      ZA30320                                        * 13366000
* MESSAGES         =   THE FOLLOWING MESSAGES ARE CONTAINED     Y02669* 13370002
*                      IN AND ISSUED BY IEE0503D:               Y02669* 13371002
*                                                                     * 13372002
*                       MSGID   CODE   MESSAGE TEXT             Y02669* 13373002
*                      IEE305I  X'05'  INVALID COMMAND          Y02669* 13374002
*                      IEE311I  X'11'  PARAMETER MISSING        Y02669* 13375002
*                      IEE328I  X'3A'  COMMAND ABORTED          Y02669* 13376002
*                      IEE777I  X'15'  INVALID FROM SUBSYSTEM  @Y02668P 13377003
*                                      CONSOLE                 @Y02668P 13378003
*                                                                     * 13380002
* SYSGEN           =   INCLUDED WITH SVC 34 IN LOAD MODULE      Y02669* 13390002
*                      IGC0003D, DLIB AOSB3, MACRO SGIEF441,    Y02669* 13390402
*                      TARGLIB LPALIB.                          Y02669* 13390802
*                                                                     * 13392002
* SYSTEM LIBRARIES =   NONE                                     Y02669* 13392402
*                                                                     * 13394002
*********************************************************************** 13400001
* C - DBRANCH, TEST FOR ZERO CONSOLE ID                       @ZA30198* 13450000
* C - COMINTER, CHANGE INVALID BRANCH                         @ZA30320* 13500000
         EJECT                                                          13600001
IEE7103D CSECT                                                          17800001
*********************************************************************** 18800001
*                                                                     * 19000001
*                         REGISTER    EQUATES                         * 19200001
*                                                                     * 19400001
*********************************************************************** 19600001
R0       EQU   0                  USED FOR THE OIL MACRO         Y02651 19800002
R1       EQU   1                  PTR TO MONITOR PARM LIST       Y02669 20000002
*                                 USED FOR THE OIL MACRO         Y02651 20050002
R2       EQU   2                  INPUT - POINTER TO XSA                20200002
R3       EQU   3                  MODULE BASE REGISTER                  20400001
R4       EQU   4                  BASE REG FOR BASEA                    20600002
R5       EQU   5                  PTR TO OPERAND BUFFER          Y02669 20800002
R6       EQU   6                  USED TO ADDRESS TABLE ENTRIES         21000001
R7       EQU   7                  BASE REG FOR CVT                      21200002
R8       EQU   8                  BASE REG FOR UCM               Y02669 21400002
R9       EQU   9                  CONTAINS ASID OR UCMI          Y02669 21600002
R10      EQU   10                 USED FOR THE OIL MACRO         Y02651 21800002
R11      EQU   11                 ADDRESSES END OF OPERAND TABLE        22000002
R12      EQU   12                 BASE FOR UCM ENTRY DROP IT   @Y02668P 22200003
*                                 THEN USE IT TO SAVE MPL PTR  @Y02668P 22300003
R13      EQU   13                 ADDR OF SAVE AREA FOR IEAVMNTR Y02669 22400002
R14      EQU   14                 USED FOR BALR AND RETURN       Y02669 22600002
R15      EQU   15                 USED FOR BALR AND BRANCH       Y02669 22800002
         SPACE  3                                                       22850002
*********************************************************************** 23000001
*                                                                     * 23200001
*                 DISPLACEMENTS AND LENGTHS AND MASK                  * 23400002
*                                                                     * 23600001
*********************************************************************** 23800001
D1       EQU   1                  DISPLACEMENT OF 1                     24050002
D2       EQU   2                  DISPLACEMENT OF 2                     24400002
D4       EQU   4                  DISPLACEMENT OF 4                     24800002
L0       EQU   0                  LENGTH OF 0                    Y02669 24900002
L8       EQU   8                  LENGTH OF 8                    Y02669 25000002
M7       EQU   7                  MASK FOR ADDRESS FOR ICM       Y02669 25010002
         SPACE 2                                                        25020002
*********************************************************************** 25050002
*                                                                     * 25100002
*                         ERROR CODES                            Y02669 25150002
*                                                                     * 25200002
*********************************************************************** 25250002
ERR305   EQU   X'05'              ERR CODE-IEE305I CMD INVALID   Y02669 25260002
ERR311   EQU   X'0B'              ERR CODE-IEE311I MISSING PARM  Y02669 25300002
ERR328   EQU   X'3A'              ERR CODE-IEE328I CMD ABORTED   Y02669 25310002
ERR777   EQU   X'15'              ERR CODE-IEE777I SUBSYSTEM   @Y02668P 25330003
         EJECT                                                          25350002
         BALR  R3,0               ESTABLISH MODULE ADDRESSABILITY       25400002
         USING *,R3                                                     27400001
         MODID BRANCH=YES                                        Y01886 27450001
         SPACE 3                                                        27592002
         USING IEEXSA,R2          ADDRESS EXTENDED SAVE AREA            27600002
         SR    R5,R5              CLEAR REGISTER                 Y02669 27650002
         ICM   R5,M7,XAL+1        GET 3 BYTE ADDR OF OPERANDS    Y02669 27700002
         BZ    DERR311            NONE, ERR-IEE311I MISSING PARM Y02669 28250002
         EJECT                                                          28300002
*********************************************************************** 28350002
*                                                                     * 28400002
* LOOP THROUGH COMPARE TABLE LOOKING FOR MATCHING VALID OPERAND  Y02669 28450002
*                                                                     * 28500002
*********************************************************************** 28550002
         SPACE 2                                                        28560002
         SR    R9,R9              CLEAR REGISTER FOR OPERAND LENGTH     28600002
         SR    R15,R15            USED TO INDEX BRANCH TABLE            28800001
         LA    R11,DENTAB         ADDRESS END OF COMPARE TABLE    21002 29000002
         LA    R6,DTAB            ADDRESS BEGINNING OF COMPARE TABLE    29200002
         USING DTAB,R6            EST. ADDRESSABILITY TO COMPARE TABLE  29400002
DLOOP    EQU   *                                                 Y02669 29450002
         IC    R9,DLEN            GET LENGTH OF COMPARE TABLE ENTRY     29600002
         EX    R9,COMPARE         CHECK FOR MATCH                Y02669 29800002
         BE    DBRANCH            IF MATCH, PROCESS ACCORDINGLY         30000002
         LA    R6,D2(R9,R6)       NO MATCH, INCRE TO NEXT TABLE ENTRY   30200001
         LA    R15,D4(R15)        INCRE INDEX FOR BRANCH TABLE          30400001
         CR    R6,R11             END OF COMPARE TABLE REACHED?   M0467 30600002
         BL    DLOOP              NO, GO BACK AND CHECK NEXT      20030 30800001
*                                 COMPARE TABLE ENTRY             20030 31000002
         DROP  R6                 NECESSARY TO RE-EST BASE REG   Y02669 31010002
         B     DERR305            YES, ERR-IEE305I CMD INVALID   Y02669 31050002
         SPACE  2                                                       31170002
*********************************************************************** 31220002
*                                                                     * 31270002
* WHEN A VALID MATCH IS FOUND ADDRESS CONTROL BLOCKS AND BRANCH  Y02669 31320002
* THEN CHECK, IF THE ISSUING CONSOLE IS JES3 THEN THE          @Y02668P 31330003
* COMMAND IS INVALID                                           @Y02668P 31340003
*                                                                     * 31370002
*********************************************************************** 31380002
         SPACE 2                                                        31390002
DBRANCH  EQU   *                                                        31400001
         L     R7,CVTPTR          GET ADDRESS OF CVT             Y02669 31800002
         USING CVT,R7             ESTABLISH CVT ADDRESSABILITY   Y02669 31850002
         L     R4,CVTMSER         ADDR OF MASTER RESIDENT CORE   Y02669 32000002
         USING BASE,R4            EST. MSTR RES. CORE BASE              32400001
         L     R8,CVTCUCB         GET ADDRESS OF UCM             Y02669 32450002
         USING UCM,R8             ESTABLISH UCM ADDRESSABILITY   Y02669 32500002
         DROP  R7                                                Y02669 32550002
         USING UCMLIST,R12        EST UCME ADDRESSABILITY      @Y02668P 32550803
         L     R12,UCMVEA         ADDRESS OF THE FIRST UCME    @Y02668P 32551603
         SR    R1,R1              ZERO OUT REG1                @Y02668P 32552003
         IC    R1,XAU             CONSOLE ID                   @Y02668P 32552403
         LTR   R1,R1              INTERNAL,INPUT CMND SOURCE?  @ZA30198 32552600
         BZ    CONTINUE           YES,DEFAULT TO MSTR CONS.    @ZA30198 32552800
         BCTR  R1,L0              SUBTRACT ONE FROM CONSOLE ID @Y02668P 32553203
         M     R0,UCMVEZ          DISPLACEMENT OF UCME         @Y02668P 32554003
         AR    R12,R1             ADD TO FIRST UCME            @Y02668P 32554803
         SR    R0,R0              ZERO OUT REG0 FOR OIL        @Y02668P 32555603
         SR    R1,R1              ZERO OUT REG1 FOR OIL        @Y02668P 32556403
         TM    UCMDISP2,UCMDISPK  IS THIS A SUBSYSTEM CONSOLE  @Y02668P 32557203
         BZ    CONTINUE           NOT JES3                     @Y02668P 32557603
         MVI   XAE,ERR777         ERROR CODE 15 JES3           @Y02668P 32558003
         DROP  R12                FINISHED WITH THE UCME       @Y02668P 32558403
CONTINUE EQU   *                                               @Y02668P 32559203
         SR    R9,R9              CLEAR REG FOR CONSOLE TESTING  Y02669 32560002
         LH    R9,XAA             GET ASID                       Y02669 32600002
         XC    XAX(L8),XAX        CLEAR AREA FOR MNTRPL          Y02669 32610002
         LA    R1,XAX             GET ADDRESS OF AREA AND        Y02669 32650002
         USING MPL,R1             ORG IEZMPL ON XAX              Y02669 32700002
         LR    R12,R1             SAVE MPL BASE FROM OIL       @YM4795P 32790002
         B     BRTABLE(R15)       BRANCH TO PROPER PROCESSOR            32899902
         EJECT                                                          32949902
*********************************************************************** 33000001
*                                                                     * 33200001
*                        MONITOR JOBNAMES,T                       20030 33400002
*             SET TIME INDICATOR IN BASEA AND BUILD PARM LIST    Y02669 33450002
*                                                                     * 33600001
*********************************************************************** 33800001
         SPACE                                                          33850002
DDJOBT   EQU   *                                                        34000001
         CLI   XAE,ERR777         ?JES3 CONSOLE-YES            @Y02668P 34200003
         BE    DERR777            BRANCH ERROR                 @Y02668P 34400003
         OIL   MSBTN,MSTN,WREGS=(0,1,10),REF=BASE                      *34800002
                              SET THE TIME BIT IN BASEA          Y02651 34850002
         SPACE  5                                                       34900002
*********************************************************************** 35000001
*                                                                     * 35200001
*                         MONITOR JOBNAMES                        20030 35400001
*                BUILD PARM LIST FOR COMMUNICATIONS TASK         Y02669 35450002
*                                                                     * 35600001
*********************************************************************** 35800001
         SPACE                                                          35850002
DDJOB    EQU   *                                                        36000001
         CLI   XAE,ERR777         ?JES3 CONSOLE-YES            @Y02668P 36030003
         BE    DERR777            BRANCH ERROR                 @Y02668P 36060003
         LR    R1,R12             RESTORE MPL BASE FROM OIL    @YM4795P 36100002
         LTR   R9,R9              TEST FOR COMMAND SOURCE         20030 36200002
         BZ    DDJOB2             BRANCH IF NOT TIME SHARING USER 20030 36400002
         OI    MPLPROC1,MPLTERM+MPLSTRT    START MN WITH ASID    Y02669 36600002
         OI    MPLTYPE1,MPLJBNM   MONITOR JOBNAMES               Y02669 36700002
         B     COMINTER           GO TO COMMUNICATIONS TASK      Y02669 37400002
         SPACE                                                          37450002
DDJOB2   EQU   *                                                  20030 37600001
         OI    MPLPROC1,MPLCONS+MPLSTRT    START MN WITH CONS ID Y02669 37800002
         OI    MPLTYPE1,MPLJBNM   MONITOR JOBNAMES               Y02669 37810002
         IC    R9,XAU             GET CONSOLE ID                 Y02669 37850002
         B     COMINTER           GO TO COMMUNICATIONS TASK      Y02669 37900002
         EJECT                                                          39250002
******************************************************************20030 39400001
*                                                                 20030 39600001
*                         MONITOR SESS,T                          20030 39800002
*             SET TIME INDICATOR IN BASEA AND BUILD PARM LIST    Y02669 39850002
*                                                                 20030 40000001
******************************************************************20030 40200001
         SPACE                                                          40250002
DDSEST   EQU   *                                                  20030 40400001
         CLI   XAE,ERR777         ?JES3 CONSOLE-YES            @Y02668P 40410003
         BE    DERR777            BRANCH ERROR                 @Y02668P 40420003
         OIL   MSBTN,MSTN,WREGS=(0,1,10),REF=BASE                      *40450002
                              SET THE TIME BIT IN BASEA          Y02651 40500002
         SPACE  5                                                       41300002
******************************************************************20030 41400001
*                                                                 20030 41600001
*                          MONITOR SESS                           20030 41800001
*                BUILD PARM LIST FOR COMMUNICATIONS TASK         Y02669 41850002
*                                                                 20030 42000001
******************************************************************20030 42200001
         SPACE                                                          42250002
DDSES    EQU   *                                                  20030 42400001
         LR    R1,R12             RESTORE MPL BASE FROM OIL    @YM4795P 42500002
         LTR   R9,R9              TEST FOR COMMAND SOURCE         20030 42600002
         BZ    DDSES2             BRANCH IF NOT TIME SHARING USER 20030 42800002
         OI    MPLPROC1,MPLTERM+MPLSTRT    START MN WITH ASID    Y02669 42850002
         OI    MPLTYPE1,MPLSESS   MONITOR SESSIONS               Y02669 42910002
         B     COMINTER           GO TO COMMUNICATIONS TASK      Y02669 42950002
         SPACE                                                          43650002
DDSES2   EQU   *                                                  20030 43800001
         CLI   XAE,ERR777         ?JES3 CONSOLE-YES            @Y02668P 43810003
         BE    DERR777            BRANCH ERROR                 @Y02668P 43820003
         OI    MPLPROC1,MPLCONS+MPLSTRT    START MN WITH CONS ID Y02669 43850002
         OI    MPLTYPE1,MPLSESS   MONITOR SESSIONS               Y02669 43900002
         IC    R9,XAU             GET CONSOLE ID                 Y02669 43960002
         B     COMINTER           GO TO COMMUNICATIONS TASK      Y02669 44000002
         EJECT                                                          45450002
*********************************************************************** 45600001
*                                                                     * 45800001
*                           MONITOR STATUS                        20030 46000002
*                BUILD PARM LIST FOR COMMUNICATIONS TASK         Y02669 46050002
*                                                                     * 46200001
*********************************************************************** 46400001
         SPACE                                                          46450002
DDSTAT   EQU   *                                                        46600001
         LTR   R9,R9              TEST FOR COMMAND SOURCE        Y02669 46800002
         BZ    DDSTAT2            BRANCH IF NOT TIME SHARING USER 20030 47000002
         OI    MPLPROC1,MPLTERM+MPLSTRT    START MN WITH ASID    Y02669 47200002
         OI    MPLTYPE1,MPLSTAT   MONITOR STATUS                 Y02669 47600002
         B     COMINTER           GO TO COMMUNICATIONS TASK      Y02669 47800002
         SPACE                                                          47850002
DDSTAT2  EQU   *                                                  20030 48000001
         CLI   XAE,ERR777         ?JES3 CONSOLE-YES            @Y02668P 48010003
         BE    DERR777            BRANCH ERROR                 @Y02668P 48020003
         OI    MPLPROC1,MPLCONS+MPLSTRT    START MN WITH CONS ID Y02669 48050002
         OI    MPLTYPE1,MPLSTAT   MONITOR STATUS                 Y02669 48100002
         IC    R9,XAU             GET CONSOLE ID                 Y02669 48150002
         B     COMINTER           GO TO COMMUNICATIONS TASK      Y02669 48160002
         EJECT                                                          49450002
*********************************************************************** 49600001
*                                                                     * 49800001
*                          MONITOR DSNAME                         20030 50000001
*              SET MONITOR DSNAME BIT IN BASEA AND RETURN        Y02669 50050002
*                                                                     * 50200001
*********************************************************************** 50400001
         SPACE                                                          50450002
DDSNAME  EQU   *                                                 Y02669 50600002
         OIL   BAMONITR,BADSN,WREGS=(0,1,10),REF=BASE                  *52200002
                              SET THE MN DSNAME BIT IN BASEA     Y02651 52250002
         BR    R14                RETURN TO SYSTEM                      52400001
         EJECT                                                          52450002
*********************************************************************** 52600001
*                                                                     * 52800001
*                           MONITOR SPACE                         20030 53000001
*              SET MONITOR SPACE BIT IN BASEA AND RETURN         Y02669 53050002
*                                                                     * 53200001
*********************************************************************** 53400001
         SPACE                                                          53450002
DDSPACE  EQU   *                                                 Y02669 53600002
         OIL   BAMONITR,BASPACE,WREGS=(0,1,10),REF=BASE                *55200002
                              SET THE MN SPACE BIT IN BASEA      Y02651 55250002
         BR    R14                RETURN TO SYSTEM                      55400001
         EJECT                                                          57220002
*********************************************************************** 57230002
*                                                                     * 57240002
*          GO TO COMM TASK VIA BALR 14,15 TO SET THE APPROPIATE  Y02669 57270002
*          MONITOR FIELDS IN THE APPROPIATE CONTROL BLOCKS.      Y02669 57320002
*             R1 CONTAINS ADDRESS OF XAR WHICH IN TURN           Y02669 57330002
*                POINTS TO IEZMPL (MONITOR PARM LIST)            Y02669 57340002
*             R13 CONTAINS ADDRESS OF THE REGISTER SAVE AREA     Y02669 57370002
*                 FOUND IN THE XSA                               Y02669 57372002
*             R15 CONTAINS ADDRESS OF IEAVMNTR FROM THE UCM      Y02669 57374002
*          UPON RETURN FROM IEAVMNTR:                            Y02669 57376002
*             IF THERE WAS A GETMAIN ERROR, (REG 15 = 4          Y02669 57382202
*          INDICATING A GETMAIN FAILURE FOR A MONITOR REQUEST    Y02669 57389002
*          FROM A TIME SHARING USER) CONTROL IS GIVEN TO         Y02669 57395202
*          IEE0503D TO ISSUE 'IEE328I MONITOR COMMAND ABORTED'   Y02669 57395602
*             IF THERE WERE NO ERROR, (REG 15 = ZERO)            Y02669 57397202
*          AFTER RESTORING REGISTER 14 FROM XAS, CONTROL IS      Y02669 57401402
*          RETURNED VIA REGISTER 14.                             Y02669 57407602
*                                                                     * 57413802
*********************************************************************** 57420002
         SPACE   3                                                      57470002
COMINTER EQU   *                                                 Y02669 63600002
         STH   R9,MPLID           GET ASID OR CONSOLE ID         Y02669 63602002
         LA    R13,XASAVSTD       GET ADDRESS OF SAVE AREA       Y02669 63604002
         ST    R14,XAS            SAVE REGISTER 14               Y02669 63604402
         ST    R1,XAR             PUT ADDR OF MNTRPL IN XAR AND  Y02669 63608002
         LA    R1,XAR             PASS ADDRESS OF XAR IN REG 1   Y02669 63608402
         L     R15,UCMMNTR        GET ADDRESS OF COMM TASK MOD   Y02669 63700002
         BALR  R14,R15            HAVE FIELDS SET BY COMM TASK   Y02669 63750002
         SPACE 2                                                        63750402
         L     R14,XAS            RESTORE RETURN ADDRESS         Y02669 63752002
         LTR   R15,R15            WAS THERE A GETMAIN ERROR?     Y02669 63760002
         BNZ   DERR328            YES, ISSUE AN ERROR MSG      @ZA30320 63770000
         BR    R14                RETURN TO CALLER               Y02669 63850002
         EJECT                                                          66250002
*********************************************************************** 66700002
*                                                                     * 66750002
*                       ERROR EXIT                               Y02669 66800002
*                                                                     * 66850002
*********************************************************************** 66900002
DERR328  EQU   *                                                 Y02669 66910002
         MVI   XAE,ERR328         ERROR CODE=28 FOR CMD ABORTED  Y02669 66920002
         B     D0503D             BRANCH TO MESSAGE MODULE       Y02669 66930002
DERR311  EQU   *                                                 Y02669 66932002
         MVI   XAE,ERR311         ERROR CODE=11 FOR PARM MISSING Y02669 66934002
         B     D0503D             BRANCH TO MESSAGE MODULE       Y02669 66936002
DERR777  EQU   *                                              @Y02668P* 66937003
         MVI   XAE,ERR777         ERROR CODE=15 FOR INVALID   @Y02668P* 66938003
         B     D0503D             FROM SUBSYSTEM CONSOLE      @Y02668P* 66939003
DERR305  EQU   *                                                 Y02669 66940002
         MVI   XAE,ERR305         ERROR CODE=5 FOR COMD INVALID  Y02669 66942002
D0503D   EQU   *                                                 Y02669 66944002
         L     R15,VCON0503       GET ADDR OF IEE0503D           Y02669 66946002
         BR    R15                BRANCH TO MESSAGE MODULE       Y02669 66948002
         EJECT                                                          70250002
*********************************************************************** 70300002
*                                                                     * 70350002
*                              CONSTANTS                              * 70400002
*                                                                     * 70450002
*********************************************************************** 70500002
         SPACE                                                          70550002
VCON0503 DC    V(IEE0503D)            ERR MESSAGE MODULE ADDRESS Y02669 70600002
         SPACE                                                          70650002
COMPARE  CLC   D1(L0,R6),L0(R5)       COMPARE TABLE ENTRY WITH   Y02669 70700002
*                                     COMMAND OPERAND            Y02669 70710002
         SPACE   7                                                      70750002
*********************************************************************** 70800002
*                                                                     * 70850002
*                        PATCH AREA                              Y02669 70900002
*                                                                     * 70950002
*********************************************************************** 71000002
         SPACE                                                          71050002
PATCH    DC    2CL25'** IEE7103D PATCH AREA **'                @ZA30320 71100000
         EJECT                                                          71150002
*********************************************************************** 72600001
*                                                                     * 72800001
*                     BRANCH  TABLE                              Y02669 73000002
*                                                                     * 73200001
*        THIS TABLE MUST BE IN A ONE-TO-ONE CORRESPONDENCE WITH       * 73400002
*        THE 'COMPARE TABLE'                                          * 73600002
*                                                                     * 73650002
*********************************************************************** 73800001
         SPACE                                                          73850002
BRTABLE  DS    0H                                                Y02669 74000002
         B     DDJOBT             BRANCH TO PROCESS MN JOBNAMES,T 21002 74200001
         B     DDJOB              BRANCH TO PROCESS MN JOBNAMES   21002 74400001
         B     DDSEST             BRANCH TO PROCESS MN SESS,T     20030 74600001
         B     DDSES              BRANCH TO PROCESS MN SESS       20030 74800001
         B     DDSTAT             BRANCH TO PROCESS MN STATUS    Y02669 75000002
         B     DDSNAME            BRANCH TO PROCESS MN DSNAME    Y02669 75200002
         B     DDSPACE            BRANCH TO PROCESS MN SPACE     Y02669 75400002
         SPACE 2                                                        76000002
*********************************************************************** 76200001
*   NOTE: THE FOLLOWING TABLE MUST BE THE LAST ITEM IN THIS     Y02669* 76250002
*         MODULE SINCE A USING FOR THE TABLE IS ISSUED ON       Y02669* 76300002
*         REGISTER 6 AND THUS CAN REESTABLISH THE MODULE'S BASE Y02669* 76350002
*         REGISTER FOR ANY CODE WHICH FOLLOWS THIS TABLE.       Y02669* 76360002
*                                                                     * 76400001
*                          COMPARE TABLE                              * 76600001
*                                                                     * 76800001
*         THIS TABLE MUST BE IN A ONE-TO-ONE CORRESPONDENCE           * 77000002
*         WITH THE BRANCH TABLE.                                      * 77200002
*                                                                     * 77250002
*********************************************************************** 77400001
         SPACE                                                          77450002
DTAB     EQU   *                                                        77600001
DLEN     EQU   *                                                        77800001
         DC    AL1(L'DJOBNT-1)    LENGTH OF MN OPERAND            20030 78000002
DJOBNT   DC    C'JOBNAMES,T '     MONITOR OPERAND                 20030 78200002
         DC    AL1(L'DJOBN-1)           *                               78400001
DJOBN    DC    C'JOBNAMES '             *                               78600001
         DC    AL1(L'DSESST-1)          *                         20030 78800001
DSESST   DC    C'SESS,T '               *                         20030 79000001
         DC    AL1(L'DSESS-1)           *                         20030 79200001
DSESS    DC    C'SESS '                 *                         20030 79400001
         DC    AL1(L'DSTATUS-1)         *                               79600001
DSTATUS  DC    C'STATUS '               *                               79800001
         DC    AL1(L'DSNAME-1)          *                        Y02669 80000002
DSNAME   DC    C'DSNAME '               *                        Y02669 80200002
         DC    AL1(L'DSPACE-1)          *                               80400001
DSPACE   DC    C'SPACE '                *                               80600001
DENTAB   EQU   *                                                        81600001
         EJECT                                                          81600402
         IEEBASEA                                                       81660002
         EJECT                                                          81710002
IEEXSA   DSECT                                                          81760002
         IEEXSA                                                         81770002
         EJECT                                                          81870002
         IEZMPL                                                         81880002
         EJECT                                                          81931602
CVT      DSECT                                                   Y02669 81948302
         CVT                                                            81998302
         EJECT                                                          82048302
         IEECUCM  FORMAT=NEW                                            82108302
         END                                                            82198302
./  ADD  SSI=53070058,NAME=IEE7203D
 TITLE 'IEE7203D - VARY HARDCPY PROCESSOR-PART TWO'                     00250003
HUCMSET  DSECT                                                          00300002
         IEECUCM  FORMAT=NEW                                            00400002
         EJECT                                                          00600001
         IEEBASEA                                                       00800001
         EJECT                                                          01000001
HXSASET  DSECT                                                          01200001
         IEEXSA                                                         01400001
         EJECT                                                          06800001
HCVTSET  DSECT                                                          07000001
         CVT   SYS=VMS                                                  07200001
         EJECT                                                          07400001
HUCBSET  DSECT                                                          07600001
         IEFUCBOB                                                       07800001
         EJECT                                                          08000001
    IHAPSA                                                              08050002
    EJECT                                                               08100002
IEE7203D CSECT                                                          08200001
*                                                                 21002 08400001
* HADDREQ(A)                                                   @ZA04559 08450003
*********************************************************************** 08600001
*                                                                       08650002
* MODULE NAME      = IEE7203D                                           08700002
*   CSECT NAME     = IEE7203D                                           08750002
*                                                                       08800002
* LOAD MODULE NAME = IGC0003D                                           08850002
*                                                                       08900002
* DESCRIPTIVE NAME = VARY HARDCPY OPERAND PROCESSOR - PART TWO          09050002
*                                                                       09100002
* COPYRIGHT        = MISSING                                            09150002
*                                                                       09200002
* STATUS           = OS/VS/2 RELEASE 3 PTF                     @ZA04559 09250003
*                                                                       09300002
* FUNCTION         = THIS MODULE USING INFORMATION IN THE XSA(SEE       09350002
*                    INPUT BELOW) CHANGES THE HARDCPY CONFIGURATION     09400002
*                    AS FOLLOWS:                                        09450002
*                    1. CAN CHANGE THE ROUTING CODES AND/OR ITS         09500002
*                    ABILITY TO RECEIVE COMANDS AND RESPONSES FOR       09550002
*                    EXISTING HARDCPY.                                  09600002
*                    2. CAN ADD HARDCPY CAPABILITIES TO AN ACTIVE       09650002
*                    CONSOLE                                            09700002
*                    3. WILL CHANGE HARDCPY FUNCTIONS FROM AN ACTIVE    09750002
*                    CONSOLE (OR SYSLOG) TO SYSLOG, OR ANOTHER          09800002
*                    ACTIVE CONSOLE.                                    09850002
*                                                                       09900002
* OPERATION        = IF ROUT=, CMDS, NOCMDS, INCMDS, STCMDS,            09950003
*                    ARE PRESENT AND ARE CORRECT, THIS MODULE           10000002
*                    DETERMINES WHETHER A NEW CONSOLE (OR SYSLOG)       10050002
*                    IS TO HAVE THE ADDED FUNCTION OF HARDCPY LOG       10100002
*                    OR WHETHER THE CAPABILITIES OF THE CURRENT         10150002
*                    HARDCPY LOG ARE TO BE CHANGED.                     10200002
*                    IN ALL CASES, A CHECK FOR MINIMUM MAINTENANCE      10250002
*                    REQUIREMENTS IS MADE AND MAINTENANCE REQUIREMENTS  10300002
*                    ARE ADDED TO THE CHANGES REQUESTED BY THE VARY     10350002
*                    COMMAND IF NECESSARY. (THE CHANGES ARE INDICATED   10400002
*                    IN THE XSA)                                        10450002
*                                                                       10500002
* NOTES                                                                 10550002
*   DEPENDENCIES   = NONE                                               10600002
*   CHARACTER/CODE DEPENDENCIES                                         10650002
*                  = THIS MODULE CAN BE ASSEMBLED WITH ANY NEW          10700002
*                    CHARACTER/CODE SET                                 10750002
*                                                                       10800002
* RESTRICTIONS     = REG2 PTS TO THE XSA ON INPUT                       10850002
*                    REG 12 PTS TO THE UNIT OR SYSLOG                   10900002
*   REGISTER CONVENTIONS                                                10950002
*                  = REGISTERS ARE DEFINED AT LOCATION: DEFREG          11000002
*   PATCH LABEL    = PATCH                                              11050002
*                                                                       11100002
* MODULE TYPE      = CSECT                                              11150002
*   PROCESSOR      = ASSEMBLER                                          11200002
*   MODULE SIZE    = VS/2 = '30C'                              @Z30LPTJ 11250003
*   ATTRIBUTES     = REENTRANT, REUSABLE, REFRESHABLE, PAGED LPA,       11300002
*                    ZERO PSW PROTECT KEY, SUPERVISOR MODE              11350002
*                                                                       11400002
* ENTRY POINT      = IEE7203D FROM IEE4703D                             11450002
*   PURPOSE        = TO COMPLETE PROCESSING THE VARY HARDCPY COMMAND    11500002
*   LINKAGE        = BRANCH                                             11550002
*   INPUT          = REG2 PTS TO THE XSA                                11600002
*                       XAR PTS TO THE COMMAND BUFFER                   11650002
*                       XAL PTS TO THE COMMAND PARAMETERS IN THE        11700002
*                       COMMAND BUFFER                                  11750002
*                       XAV CONTAINS THE VERB                           11800002
*   REGISTERS SAVED= NONE                                               11900002
*   REGISTER USAGE = R2  XSA PTR                                        11950002
*                    R4  UCME PTR                                       12000002
*                    R9  UNIT PTR                                       12050002
*                    R10 UCM PTR                                        12100002
*                    R11 CUMPRFX PTR                                    12150002
*                    R12 PASSED UNIT PTR OR 0 IF SYSLOG                 12200002
*   REGISTERS RESTORED                                                  12250002
*                  = NONE                                               12300002
*                                                                       12350002
* EXIT - NORMAL    = TO IEE4103D VIA BRANCH                             12400002
*   CONDITIONS     = TO ISSUE THE HARDCPY INFORMATIONAL MESSAGE         12450002
*   OUTPUT         = REG1 PTS TO THE MESSAGE BUFFER GOTTEN IN 7203D     12500002
*                    REG2 PTS TO THE XSA                                12510002
*                    REG 12 PTS TO THE UNIT FIELD OR IS 0 IS SYSLOG     12550002
*                    REG 14 HAS THE CALLER'S RETURN ADDRESS             12600002
*   RETURN CODES   = NONE                                               12650002
*                                                                       12700002
* EXIT - ERROR     = 1.      TO IEE5703D VIA BRANCH                     12750002
*   CONDITIONS     =         ERROR WAS DETECTED IN THE COMMAND          12800002
*   OUTPUT         =         REG2 PTS TO THE XSA                        12850002
*                            THE FOLLOWING CODES ARE SET IN THE XAE:    12900002
*                            XAE=X'12'=5703D MUST GO TO MODULE 0503D    12950002
*                                 FOR ERROR MSG                         13000002
*                                 'IEE313I UNIT REF INVALID'            13020002
*                            XAE=X'16'=5703D MUST GO TO MODULE 0503D    13050002
*                                 FOR ERROR MSG                         13100002
*                                 'IEE315I SYSLOG NOT SUPPORTED'        13120002
*                            XAE=X'20'=5703D MUST GO TO MODULE 0503D    13150002
*                                 FOR ERROR MSG                         13200002
*                                 'IEE309I UNIDENTIFIABLE KEYWORD'      13250002
*                            XAE=X'28'=5703D MUST GO TO MODULE 0503D    13300002
*                                 FOR ERROR MSG                         13350002
*                                 'IEE306I INVALID NUMERICS'            13370002
*   RETURN CODES   = NONE                                               13400002
* EXIT - ERROR     = 2.      TO IEE2103D VIA BRANCH                     13450002
*   CONDITIONS     =         ERROR WAS DETECTED IN THE COMMAND          13500002
*   OUTPUT         =         REG2 PTS TO THE XSA                        13550002
*                            XAE IS SET TO X'39' FOR NO STORAGE         13600002
*                            MESSAGE = 'COMMAND ABORTED' MSG.           13650002
*   RETURN CODES   = NONE                                               13700002
*                                                                       13750002
* EXTERNAL REFERENCES                                                   13800002
*                  = NONE                                               13850002
*   ROUTINE        = IEE5703D                                           13900002
*                    IEE2103D                                           13950002
*                    IEE4103D                                           14000002
*   DATA AREAS     = SEE EXITS - OUTPUT                                 14050002
*   CONTROL BLOCKS = 1. EXTENDED SAVE AREA (XSA)                        14100002
*                    2. UNIT CONTROL BLOCK (UCB)                        14150002
*                       FIELDS TESTED  - SRTESTAT- BIT= SRTEDADI        14200002
*                                        UCBNAME                        14250002
*                       FIELDS UPDATED - NONE                           14300002
*                    3. UNIT CONTROL MODULE (UCM)                       14350002
*                       FIELDS TESTED  - UCMATR- BIT= UCMUF             14400002
*                                                     UCMOF             14450002
*                                        UCMDISP-BIT= UCMDISPC          14500002
*                                                     UCMDISPB          14550002
*                                        UCMHCUCM                       14600002
*                                        UMSFLGS-BIT= UCMSYSG           14650002
*                                        UCMUCB                         14700002
*                                        UCMVEA                         14750002
*                       FIELDS UPDATED - UCMDISP- BIT=UCMDISPB          14800002
*                                        UCMHCUCM                       14850002
*                                        UCMHRDRT                       14900002
*                                        UCMSDS1-BIT= UCMSDS1A          14950002
*                                                     UCMSDS1B          15000002
*                                        UCMSFLGS-BIT= UCMSYSG         15050002
*                                                     UCMSYSC           15100002
*                                                     UCMSYSB           15150002
*                    4. CVT                                             15200002
*                       FIELDS TESTED  - CVTCUCB                        15250002
*                                        CVTMSER                        15300002
*                       FIELDS UPDATED - NONE                           15350002
*                    5. MASTER SCHEDULER RESIDENT DATA AREA (BASEA)     15360002
*                       FIELDS TESTED  - BALOG                          15370002
*                       FIELDS UPDATED - NONE                           15380002
*                                                                       15400002
* TABLES           = MESSAGE BUFFER = 160 BYTES GOTTEN IN               15450002
*                    SUBPOOL 255 OF LSQA                                15500002
*                                                                       15550002
* MACROS           = GETMAIN, FREEMAIN, SETLOCK                         15600002
*                                                                       15650002
* MAPPING MACROS   = IEEXSA                                             15700002
*                    IEECUCM                                            15750002
*                    IEFUCBOB                                           15800002
*                    IEEBASEA                                           15850002
*                    CVT                                                15900002
*                    IHAPSA                                             15910002
*   SERIALIZATION  = LOCAL AND CMS LOCKS ARE USED IN THIS MODULE        15950002
*                    TO PROTECT THE UCB AND UCM - UCMPRFX AND UCME      15960002
*                    PROTECTION ON THE UCB IS FROM SVC34 ONLY SINCE     15970002
*                    THE BIT TESTED IS SRTEDADI WHICH CAN ONLY BE       15980002
*                    CHANGED BY SVC34 (VARY) IN THIS MOD'S PROCESSING   15990002
*                    PROTECTION FOR THE UCM'S IS ALSO THE LOCAL AND     15992002
*                    CMS LOCKS AGAINST ANY UPDATES FROM SVC 34          15994002
*                    AND COMM TASK                                      15996002
*                    FIEDLS IN BASEA (BALOG) WILL BE PROTECTED WITH     15998002
*                    THE ABOVE LOCKS ALTHOUGH IT IS NOT NEEDED.         15998402
*                    LOCKS WILL BE SET AT:                              15998802
*                         HSETLCK IN THIS MODULE                        15999202
*                    THEY WILL BE RELEASED AT:                          15999602
*                         HUNSTLK IN IEE4103D FOR VALID COMMANDS        15999702
*                         OR AT LABEL: HUNSTLK IN THIS MODULE FOR ERROR 15999802
*                         CONDITIONS WHERE EXIT IS TAKEN TO ERR MSG MOD 15999902
*                    FIELDS THAT MUST BE PROTECTED ARE:                 16016602
*                        UCMHCUCM - PTR TO CURRENT HARDCPY  -  UCM      16026602
*                        UCMSFLGS - BITS: UCMSYSB - HCPY IS PRESENT     16028602
*                                         UCMSYSG - SYSLOG IS HCPY      16030602
*                                         UCMSYSC - CMDS SET IN HCPY    16032602
*                                   ALL THESE ARE IN THE    -  UCM      16033002
*                        UCMDISP  - BIT: UCMDISPB - THIS DEV IS THE     16033102
*                               HARDCPY DEV- UCME                       16033202
*                        UCMATR   - BIT: UCMUF - ACTV CONSL  - UCM      16038802
*                        UCMSDS1  - BIT: UCMSDS1A                       16040802
*                                        UCMSDS1B                       16042802
*                                   STCMDS AND INCMDS STATUS FOR HCPY   16043202
*                        UCMHRDRT - HDCPY ROUT CODES        -  UCM      16043602
*                                                                       16044002
*                        SRTESTAT - BIT: SRTEDADI-CHANGE STATUS         16044102
*                                                 FOR CONSL. - UCB      16044202
*                                                                       16044402
* CHANGE LEVEL     = Y02669, Y02651, Z30LPTJ, ZA04559          @ZA04559 16050003
*                                                                       16100002
* CHANGE ACTIVITY  = N/A                                                16150002
*                                                                       16200002
* MESSAGES         = REFER TO EXITS - ERROR.                            16250002
*                                                                       16300002
* ABEND CODES      = NONE                                               16350002
*                                                                       16400002
* PACKAGING        = IEE7203D WILL BE PART OF LOAD MODULE               16450002
*                    = IGC0003D                                         16500002
*                    THIS LOAD MODULE ALIASES ARE                       16550002
*                    = NONE                                             16600002
*                  THIS LOAD MODULE ENTRY POINTS ARE                    16650002
*                    = IGC0003D                                         16700002
*                      THE MODULE WILL RESIDE IN: LPALIB                16710002
*                                                                       16750002
* SYSGEN           = SUPPLIED BY SECTIONS:                              16800002
*                       LOAD MODULE NAME                                16850002
*                       PACKAGING                                       16900002
*                       THIS CSECT WILL BE INCLUDED FROM                16910002
*                       DLIB -AOSB3- BY SYSGEN MACRO -SGIEF441-         16920002
*                                                                       16950002
* SYSTEM LIBRARIES = NONE                                               17000002
*********************************************************************** 26200001
          EJECT                                                         26250002
* HARDCOPY PROCESSOR REGISTER ASSIGNMENTS-                            * 26800001
         SPACE 10                                                       27000001
DEFREG   EQU   *                                                 Y02669 27050002
R0      EQU   0                                                         27200001
R1       EQU   1                                                  19084 27400001
R2       EQU   2                   XSA                            19084 27600001
R3       EQU   3                   ADDRESS                        19084 27800001
R4       EQU   4                   UCME                           19084 28000001
R5       EQU   5                                                  19084 28200001
R6       EQU   6                                                        28400001
R7       EQU   7                                                        28600001
R8       EQU   8                                                  19084 28800002
R9       EQU   9                   UNIT PTR                       19084 29000001
R10      EQU   10                  UCM                            19084 29200001
R11      EQU   11                  UCMPFX                         19084 29400001
R12      EQU   12                  UNIT PTR IF 0,ITS SYSLOG       19084 29600001
R13      EQU   13                                                       29800001
R14      EQU   14                      RETURN REGISTER                  30000001
R15      EQU   15                                                 19084 30200001
         SPACE 10                                                       30400001
*                                                                       30600001
* ISSUING CONSOLE IDENT MASKS                                           30800001
*                                                                       31000001
* ERROR MESSAGE CODES                                                   32200001
*                                                                       32400001
ERR13    EQU   12                  UNIT REF. INVALID - 0503D      19084 32800001
ERR26    EQU   16                  SYSLOG NOT SUPPORTED - 0503D   19084 33000001
ERR9     EQU   20                  KEYWORD MISPELLED - 0503D      19084 33200001
GETERCD  EQU   X'3A'                   INSUFFICIENT STORAGE-2103DY02669 33450002
*                                                                       33600001
         SPACE 5                                                        33800001
*                                                                 19084 34000001
* GENERAL EQUATES                                                 19084 34200001
*                                                                 19084 34400001
SYSBALOG EQU   X'00'                                                    34600001
HNUM     EQU   2          MINIMUM NUMBER CONSOLES FOR HARDCOPY REQUIRED 35000003
CHGCD    EQU   X'04'               MSG - CHANGING STATUS  5703D   19084 35400001
BLANK    EQU   C' '                                                     36000001
MSGLEN   EQU   160                     MESSAGE AREA LENGTH.       21002 36850001
*                                                                       37000001
* NUMERAL EQUATES                                                 19084 37200001
*                                                                 19084 37400001
ZERO     EQU   0                                                        37600001
TWO      EQU   2                                                        38000001
TRE      EQU   3                                                        38200001
FOR      EQU   4                                                        38400001
EIT      EQU   8                                                        39000001
FOX      EQU   255                                                      40200001
         EJECT                                                          40400001
*********************************************************************** 40600001
*                                                                     * 40800001
* HARDCOPY PROCESSING MODULE                                          * 41000001
*                                                                     * 41200001
*********************************************************************** 41400001
         BALR  R3,ZERO             ADDRESSABILITY                 19084 41600001
         USING *,R3                                               19084 41800001
         MODID BR=YES                                            Y01886 41850001
         USING XSA,R2                                             19084 42000001
         L     R12,XAL                                           Y02669 42050002
         LA    R12,ZERO(R12)       GET POINTER TO PARAMS         Y02669 42100002
         L     R15,CVTPTR          CVT POINTER                    19084 42200001
         USING HCVTSET,R15                                        19084 42400001
         L     R10,CVTCUCB         PTR TO UCM                     19084 42600001
         USING UCM,R10                                           Y02669 42800002
*                                                                 19084 43000001
         LR    R11,R10             PTR TO UCM                     19084 43200001
         LA    R1,FOR                                             19084 43400001
         SR    R11,R1              MINUS FOUR IS PTR TO PFX       19084 43600001
         L     R11,ZERO(R11)                                      19084 43800001
         USING UCMPRFX,R11                                        19084 44000001
         MVC   XAD(GETLNTH),GETLIST    MOVE IN LIST FORM.         21002 44010001
         LA    R1,XAX                  GET LIST POINTER.          21002 44020001
         ST    R1,XAX                  STORE LIST POINTER.        21002 44030001
         LA    R1,XAD                  GET LIST ADDRESS.          21002 44040001
* DO A CONDITIONAL GETMAIN. THE GOTTEN ADDRESS WILL BE IN XAX.    21002 44042001
         GETMAIN MF=(E,(1))            DO CONDITIONAL GETMAIN.    21002 44050001
         LTR   R15,R15                 GETMAIN SUCCESSFUL ?       21002 44100001
         BNZ   GETERR                  NO,SO TAKE ERROR EXIT.     21002 44150001
         EJECT                                                          44200001
*********************************************************************** 44400001
*                                                                       44600001
* UNIT SCAN                                                             44800001
*                                                                       45000001
*********************************************************************** 45200001
HSCAN    EQU   *                                                        45400002
          SPACE 10                                                      45450002
***************************************************              Y02651 45500002
*                                                                Y02651 45510002
*  LOCKS MUST BE SET AT THIS POINT AT LABEL: HSETLCK             Y02651 45520002
*  THEY WILL BE RELEASED AT: HUNSTLK                             Y02651 45530002
*                                                                Y02651 45540002
HSETLCK  EQU   *                                                 Y02651 45542002
         STM   R11,R14,XASAVLOC                                  Y02651 45542402
         SETLOCK OBTAIN,TYPE=LOCAL,MODE=UNCOND,                  Y02651*45544002
               RELATED=(IEE4103D(HUNSTLK),IEE7203D(HUNSTLK))     Y02651 45546002
         SETLOCK OBTAIN,TYPE=CMS,MODE=UNCOND,                    Y02651*45548002
               RELATED=(IEE4103D(HUNSTLK),IEE7203D(HUNSTLK))     Y02651 45548402
         LM    R11,R14,XASAVLOC                                  Y02651 45548802
***************************************************              Y02651 45550002
          SPACE 10                                                      45560002
         L     R9,UCMHCUCM         PTR TO CURRENT HARDCPY, IF ANY 19084 45600001
         LA    R9,ZERO(R9)                                        19084 45800001
         CLC   ZERO(TWO,R12),HUNIT     IS UNIT SPECIFIED          19084 46000001
         BE    HPRESNT             NO, PRESENT HCPY IS TO BE MODIF19084 46200001
         CLC   TRE(TWO,R12),HUNIT      IS UNIT GIVE               19084 46400001
         BE    HUCHK               YES, GO CHECK VALIDITY         19084 46600001
         CLC   ZERO(EIT,R12),HSYSLOG   IS UNIT SYSLOG             19084 46800001
         BNE   HERR2                   NO,INVALID UNIT REFERENCE        47000001
         SPACE 10                                                       47200001
*********************************************************************** 47400001
*                                                                       47600001
* PROCESSING OF SYSLOG AS UNIT SPECIFIED IN COMMAND                     47800001
*                                                                       48000001
*********************************************************************** 48200001
         SR    R12,R12               SYSLOG,ZERO R12 FOR MOD 4803D19084 48400001
         TM    UCMSFLGS,UCMSYSG     IS SYSLOG EXISTING HARDCPY    19084 48600001
         BO    HMAINCK                 YES, BRANCH TO MAINTENANCE CHECK 48800001
         L     R15,CVTPTR              POINTER TO CVT             21002 48850001
         USING HCVTSET,R15             ADDRESSIBILITY FOR CVT     21002 48900001
         L     R15,CVTMSER              PTR TO MASTER RESIDENT COR19084 49000001
         USING BASE,R15                 USE TO DETERMINE IF SYSLOG19084 49200001
         CLI    BALOG,SYSBALOG      IS SYSLOG SUPPORTED           19084 49400001
         BE    HERR3                   ERROR MESSAGE IS WRITTEN   19084 49600001
         DROP  R15                  OTHERWISE                     19084 49800001
         LTR   R9,R9                   IF IS ZERO,NON-EXISTENT    19084 50000001
         BZ    HSYS1                   HARDCOPY SO DON'T DELETE         50200001
         USING UCMLIST,R9              OTHERWISE,                 19084 50400001
         NI    UCMDISP,FOX-UCMDISPB           TURN OFF HARDCOPY BIT9084 50600001
HSYS1    EQU   *                                                        50800001
         XC    UCMHCUCM(FOR),UCMHCUCM  ZERO OUT SYSLOG PTR              51000001
         OI    UCMSFLGS,UCMSYSG         SET SYSLOG BIT IN UCM ON  19084 51200001
*********************************************************************** 51400001
*                                                                     * 51600001
* CHECK FOR BASIC MAINTENANCE REQUIRED                                * 51800001
*                                                                     * 52000001
*********************************************************************** 52200001
HMAINCK  LA    R13,HNUM                NUMBER OF NON-GRAPHICS     19084 52400001
         LM    R5,R7,UCMVEA        TPR TO FIRST,LAST UCME AND SIZE19084 52600001
         DROP  R9                                                 19084 52800001
         USING UCMLIST,R5                                         19084 53000001
         SPACE                                                          53050001
HGRAPH   EQU   *                                                        53200001
         L     R1,UCMUCB                                          19084 53400001
         USING HUCBSET,R1                                         19084 53600001
         TM    UCMATR,UCMUF        IS AN ACTIVE CONSOLE          Y02669 53800002
         BZ    HNONACT             NO, GO CHECK IF CHANGING TO ACT19084 54000001
         TM    SRTESTAT,SRTEDADI   ACTIVE,CHECK IF CHANGING TO NONACTV  54200001
         BO    HGRAPH1             YES,CHANGING,OMIT              19084 54400001
HGRAPH3  EQU   *                                                  19084 54600001
         TM    UCMDISP,UCMDISPC    IS IT AN ACTIVE GFX CONSOLE    19084 54800001
         BO    HADDREQ             YES,MAKE IT REQ FOR HCPY             55000001
         TM    UCMATR,UCMOF         OUTPUT UNIT                   19084 55200001
         BZ    HGRAPH1             NO, OMIT WILL BE PICKED UP BY O-     55400001
         BCT   R13,HGRAPH1         DECREMENT AND CHECK NEXT UCME  19084 55600001
         SPACE 10                                                       55650001
HADDREQ  EQU   *                                                  19084 55800001
*********************************************************************** 55850001
* IF THERE IS AN ACTIVE GRAPHICS CONSOLE OR IF THERE ARE MORE    21002* 55900001
* THAN ONE ACTIVE CONSOLE, HARDCOPY IS REQUIRED. IF NO AUTH      21002* 55950001
* AND NO HARDCOPY DEVICE ARE SPECIFIED (THE HARDCOPY DEVICE IS   21002* 55960001
* NOT CHANGING) THE AUTH WILL REMAIN UNCHANGED. IF NO DEVICE IS  21002* 55970001
* BEING CHANGED AND AUTH IS NOT SPECIFIED, CMDS IS ASSUMED.      21002* 55980001
*********************************************************************** 55990001
         OC    XARTCODE(TWO),HBASIC1   ADD MANDATORY ROUT CODES@Z30LPTJ 56200003
         OI    XASWITCH,XAHRDREQ    INDICATE HARDCOPY REQUIRED @Z30LPTJ 56260003
         TM    XASOPCOD,XACMD         IS AUTH TO CHANGE.       @Z30LPTJ 56320003
         BO    HARDCPY                 YES, CK AUTH CHANGE.       21002 56400001
         TM    UCMSDS1,UCMSDS1A+UCMSDS1B WAS STCMDS OR INCMDS  @ZA04559X56410003
                                         SPECIFIED BEFORE      @ZA04559 56420003
         BNZ   HROUTCD             YES THEN BRANCH. DON'T USE  @ZA04559X56430003
                                   DEFAULT AUTH (CMDS)         @ZA04559 56440003
         B     DEFAULT             SET MANDAT RT CODES & CMDS    Y02669 56450002
HNONACT  EQU   *                                                  19084 56600001
         TM    SRTESTAT,SRTEDADI   NONACTV CHANGING TO ACTIVE     19084 56800001
         BO    HGRAPH3             YES,COUNT IT IN                19084 57000001
HGRAPH1  BXLE  R5,R6,HGRAPH        CONTINUE CHCK TILL ALL TESTED  19084 57200001
         DROP  R5,R1                                              19084 58000001
         TM    XASOPCOD,XACMD      IS CMDS TO BE CHANGED       @Z30LPTJ 58200003
         BZ    HROUTCD                   NO,CHECK FOR ROUT CHANGES19084 58400001
         SPACE 5                                                        58410001
HARDCPY  EQU   *                                                  21002 58450001
*********************************************************************** 58500001
*   AUTHORITY CODE DETERMINATION.                                     * 58550001
*********************************************************************** 58570001
         NI    UCMSDS1,FOX-UCMSDS1A-UCMSDS1B TURN OFF STCMDS INCMDS     58600001
*                            THE PREVIOUS STMT WAS ADDED FOR      21002 58800001
         NI    UCMSFLGS,FOX-UCMSYSC    TURN OFF CMDS              21002 59000001
         TM    XASWITCH,XASTHDCP       IS THIS STCMDS          @Z30LPTJ 59600003
         BO    HGRAPH2                 YES, SET BITS              21002 59800001
         TM    XASWITCH,XAINHDCP       IS THIS INCMDS          @Z30LPTJ 60000003
         BO    HGRAPH4                 YES, SET BITS              21002 60200001
         TM    XASWITCH,XAHRDCMD       IS THIS CMDS            @Z30LPTJ 60220003
         BO    DEFAULT                 YES SET BITS               21002 60230001
*********************************************************************** 60232001
*  IF HARDCOPY IS REQUIRED AND NOCMDS IS SPECIFIED, CMDS IS USED 21002* 60234001
*********************************************************************** 60236001
         TM    XASWITCH,XAHRDREQ       IS HARDCOPY REQUIRED    @Z30LPTJ 60250003
         BNO   HROUTCD1                NO, NOCMDS IS VALID        21002 60300001
DEFAULT  EQU   *                                                  21002 60350001
         OI    UCMSFLGS,UCMSYSC          SET COMMANDS WANTED BITON19084 60400001
         B     HROUTCD                   GO CHECK FOR ROUT CHANGES19084 60600001
HGRAPH2  EQU   *                                                  21002 60800001
         OI    UCMSDS1,UCMSDS1A        INDICATE STCMDS            21002 61000001
         B     HROUTCD                 CHECK ROUTING CODES        21002 61200001
HGRAPH4  EQU   *                                                  21002 61400001
         OI    UCMSDS1,UCMSDS1B        INDICATE INCMDS            21002 61600001
         SPACE 2                                                        61610001
HROUTCD  EQU   *                                                  21002 61650001
*********************************************************************** 61700001
* IF HARDCOPY IS REQUIRED, EVEN IF NO NEW ROUT CODES WERE SPECIF-21002* 61750001
* IED, THE ROUT CODES WILL CHANGE TO MAKE SURE THAT THE MANDA-   21002* 61800001
* TORY ROUT CODES ARE INCLUDED.                                  21002* 61850001
*********************************************************************** 61900001
         SPACE                                                          61950001
         TM    XASWITCH,XAHRDREQ       IS HARDCOPY REQUIRED    @Z30LPTJ 61960003
         BO    HROUTMVC                INCLUDE MANDAOTRY RT CODES 21002 61970001
HROUTCD1 EQU   *                                                  21002 61980001
         TM    XASWITCH,XAROUT      ARE RT.CODES TO BE CHANGED @Z30LPTJ 62000003
         BZ    HSTOP                   NO,COMMAND FINISHED              62200001
HROUTMVC EQU   *                                                  19084 62400001
         TM    XASWITCH,XAROUT    IF ROUTS WERE SPECIFIED      @Z30LPTJ 62450003
*                                 ON THE CMD THEY ARE ALREADY IN Y02669 62500002
         BO    MOVE               THEN JUST MOVE THEM IN UCME    Y02669 62550002
         OC    XARTCODE(TWO),UCMHRDRT  OR IN OLD ROUTS ALSO    @Z30LPTJ 62560003
MOVE     EQU   *                                                 Y02669 62570002
         MVC   UCMHRDRT(TWO),XARTCODE   CHANGE ROUTING CODES   @Z30LPTJ 62600003
HSTOP    EQU   *                                                        62800001
         L     R1,XAX                  PASS MSG AREA ADDRESS     Y02669 62850002
         MVC   XAX(EIT),HMSG3           HARDCPY MSG MOD 4103D           63000001
         OI    UCMSFLGS,UCMSYSB    TURN BIT MEANING HCPY IS ON SYS19084 63200001
         L     R15,VCON41          GO TO XCTL TO MES MODULE      Y02669 63400002
         BR    R15                 GO TO IT                      Y02669 63450002
*                                                                       63600001
         EJECT                                                          63800001
*********************************************************************** 64000001
*                                                                       64200001
* UNIT IS UNSPECIFIED-CHANGES ARE MADE TO EXISTING HARDCOPY             64400001
*                                                                       64600001
*********************************************************************** 64800001
HPRESNT  EQU   *                                                        65000001
         SR    R12,R12                                            19084 65200001
         TM    UCMSFLGS,UCMSYSG     DOES HARDCPY EXIST (SYSLOG)   19084 65400001
         BO    HMAINCK                 YES,GOTO MAINT. REQUIREMENTS CHK 65600001
         L     R12,XAL             PTR TO BEGINNING               19084 65800001
         LA    R12,ZERO(R12)                                      19084 66000001
         LTR   R9,R9               SETO FOR SYSLOG OR PTR TO HCPY 19084 66200001
         BZ    HERR5                   HARDCOPY EXISTS,OTHERWISE ERROR  66400001
         USING UCMLIST,R9                                         19084 66600001
         L     R9,UCMUCB           PTR TO THE UCB OF THE HARDCPY  19084 66800001
         DROP  R9                                                 19084 67000001
         USING HUCBSET,R9          ADDRESSABILITY FOR THE UCB     19084 67200001
         LA    R12,UCBNAME          PTR TO THE DEVICE NAME FOR 48 19084 67400001
         DROP  R9                                                 19084 67600001
         B     HMAINCK                 ..                               67800001
*                                                                 19084 68000001
         EJECT                                                          68200001
*********************************************************************** 68400001
*                                                                       68600001
* UNIT SPECIFIED                                                        68800001
*                                                                       69000001
*********************************************************************** 69200001
HUCHK    EQU   *                                                  19084 69400001
         LM    R5,R7,UCMVEA        R4 HAS PTR TO FIRST UCME       19084 69600001
*                                  R5 HAS SIZE OF EACH UCME       19084 69800001
*                                  R6 HAS PTR TO LAST UCME        19084 70000001
         USING UCMLIST,R5             REFERENCE TO UCM ENTRY      19084 70200001
HLOOP    EQU   *                                                  19084 70400001
         L     R4,UCMUCB           PTR TO UCB ASSOCIATED WITH UCME19084 70600001
         USING HUCBSET,R4                                         19084 70800001
         CLC   ZERO(TRE,R12),UCBNAME  COMPARE PHYSICAL UNIT ADRS. 19084 71000001
         BE    HFND                    EQUAL, UNIT HAS UCME             71200001
         BXLE  R5,R6,HLOOP         NO, CONTINUE SEARCH TILL EXHAUS19084 71400001
HERR5    EQU   *                                                  19084 71600001
         MVI   XAE,ERR13           UNIT REF INVALID TO 0503D      19084 71800001
         MVC   XAV(TRE),ZERO(R12)  MOVE IN INCORRECT UNIT         19084 72000001
         MVI   XAV+TRE,BLANK       MOVE IN BLANK TO CLEAR AREA    19084 72200001
         B     HOFFMVC             GO TO XCTL RTN                 19084 72400001
*                                                                 19084 72600001
*                                                                       72800001
HFND     EQU   *                                                        73000001
         TM    UCMDISP,UCMDISPB       IS UNIT CURRENT HARDCPY     19084 73200001
         BO    HMAINCK                 YES,CHECK FOR MAINTENANCE        73400001
         TM    UCMDISP,UCMDISPC      IS DEVICE A GRAPHICS         19084 73600001
         BO    HERR5               ERR,HCPY SHOULD NOT BE GFX     19084 73800001
         TM    UCMATR,UCMOF         DOES IT HAVE WTO SUPPORT     Y02669 74000002
         BZ    HERR5               ERROR                          19084 74200001
         TM    UCMATR,UCMUF        ACTIVE BIT ON IN UCME         Y02669 74400002
         BO    HPENG               YES, CHECK IF CHANGING STATUS  19084 74600001
         TM    SRTESTAT,SRTEDADI   NONACTV, IS IT CHANGING TO ACTV19084 74800001
        BO     HERR4               YES, CHANGING STATUS MESSAGE   19084 75000001
         B     HERR5               NO, PURELY NONACTV,UNIT REF INV19084 75200001
HPENG    EQU   *                                                  19084 75400001
         TM    SRTESTAT,SRTEDADI   ACTIVE CHANGING TO NONACTIVE   19084 75600001
         BO    HERR5               YES, UNIT REF INVALID          19084 75800001
*                                                                       76000001
         TM    UCMSFLGS,UCMSYSG         WAS HARDCOPY SYSLOG       19084 76200001
         BO    HSOFF                   YES, GO TURN SYSLOG BIT OFF      76400001
         LTR   R9,R9               ZERO  IS NONEXISTANT HCPY      19084 76600001
         BZ    HON                     ..                               76800001
         DROP  R5                                                 19084 77000001
         USING UCMLIST,R9              GO TO EXISTING HARDCPY UCME19084 77200001
         NI    UCMDISP,FOX-UCMDISPB           TURN OFF HARDCPY BIT19084 77400001
         DROP  R9                                                 19084 77600001
         USING UCMLIST,R5                                         19084 77800001
HON      OI    UCMDISP,UCMDISPB           TURN BIT ON IN NEW HARDC19084 78000001
         ST    R5,UCMHCUCM            STORE POINTER TO UCME       19084 78200001
         B     HMAINCK                 GO CHECK MAINTENANCE REQUIREMET  78400001
*                                                                       78600001
HSOFF    NI    UCMSFLGS,FOX-UCMSYSG        TURN SYSLOG BIT OFF    19084 78800001
         B     HON                     GO CHANGE POINTER                79000001
         EJECT                                                          79200001
*********************************************************************** 79400001
*                                                                       79600001
* ERROR MESSAGE ROUTINES                                                79800001
* AND EXIT ROUTINE                                                19084 80000001
*                                                                       80200001
*********************************************************************** 80400001
*                                                                       80600001
*                                                                       80800001
HERR2    EQU   *                                                  21002 81000001
         MVI   XAE,ERR9                MISSPELLED KEYWORD         21002 81200001
         B     HOFFMVC                 EXIT TO IGC5703D           21002 81400001
HERR3    EQU   *                                                  19084 81600001
         MVI   XAE,ERR26           ERR IS 26,SYSLOG NOT SUPPORTED 19084 81800001
*                                                                 19084 82000001
         B     HOFFMVC                                            19084 82200001
*                                                                 19084 82400001
HERR4    EQU   *                                                  19084 82600001
         MVI   XAE,CHGCD           MOVE CODE TO PUT CHANGING STATU19084 82800001
*                                  MESSAGE FROM 5703D             19084 83000001
HOFFMVC  EQU   *                                                  19084 83200001
         SPACE 10                                                       83210002
***************************************************              Y02651 83220002
*                                                                Y02651 83222002
*  LOCKS ARE NO LONGER NEEDED AND SINCE EXIT WILL BE TAKEN       Y02651 83224002
*  THEY MUST BE RELEASED FIRST AT LABEL:  HUNSTLK                Y02651 83226002
*                                                                Y02651 83228002
         BAL   R11,HUNSTLK        RELEASE ALL LOCKS              Y02651 83228402
*                                                                Y02651 83228802
***************************************************              Y02651 83230002
         SPACE 10                                                       83240002
         L     R1,XAX                  GET MESSAGE AREA ADDRESS.  21002 83250001
* IF WE TAKE THE ERROR PATH THE MESSAGE AREA MUST BE FREED.       21002 83310001
         FREEMAIN R,LV=MSGLEN,A=(1),SP=229                       Y02669 83350002
         MVC   XAX(EIT),OFFMOD     MOD NAME IS IGC5703D           19084 83400001
         L     R15,VCON57          ADDRESS OF 5703D              Y02669 83450002
         BR    R15                 GO TO IT                      Y02669 83500002
*                                                                 19084 85000001
GETERR   EQU   *                                                  21002 85650001
         MVI   XAE,GETERCD             PUT IN MESSAGE INDICATOR.  21002 85700001
         MVC   XAX(EIT),GETERMOD       SET UP ERROR XCTL.         21002 85750001
         L     R15,VCON21              ADDRESS OF 2103D          Y02669 85760002
         BR    R15                     GOTO IT                   Y02669 85770002
         EJECT                                                          85800001
*****************************************************************Y02651 85850002
*                                                                Y02651 85860002
*  THIS IS THE RELEASE-LOCKS SUBROUTINE                          Y02651 85870002
*  BOTH THE LOCAL AND CMS LOCKS WILL BE RELEASED HERE            Y02651 85880002
*                                                                Y02651 85890002
HUNSTLK  EQU   *                                                 Y02651 85892002
         STM   R11,R14,XASAVLOC                                  Y02651 85892402
         SETLOCK RELEASE,TYPE=CMS,RELATED=(IEE7203D(HSETLCK))    Y02651 85894002
         SETLOCK RELEASE,TYPE=LOCAL,RELATED=(IEE7203D(HSETLCK))  Y02651 85896002
         LM    R11,R14,XASAVLOC                                  Y02651 85898002
         BR    R11                                               Y02651 85898402
*                                                                Y02651 85898802
*****************************************************************Y02651 85900002
         EJECT                                                          85950002
*********************************************************************** 86000001
*                                                                       86200001
* CONSTANTS USED BY HARDCPY PROCESSOR                                   86400001
*                                                                       86600001
*********************************************************************** 86800001
HSYSLOG  DC    C'SYSLOG'           DO NOT SEPARATE THESE TWO DCLS 19084 87000001
HUNIT    DC    C',H'               THEY ARE USED TOGHETHER        19084 87200001
*                                                                 19084 87400001
*                                                                       87600001
*                                                                       87800001
HMSG3    DC    C'IGC4103D'         HARDCOPY MSG MOD = 4103D             88000001
OFFMOD   DC    C'IGC5703D'         HARDCPY,OFF PROCESSOR          19084 88200001
GETERMOD DC    C'IGG2103D'             ERROR MODULE.              21002 88250001
HBASIC1  DC    X'F340'                 MASK FOR BASIC ROUTINE CODES     88400001
         DS    0F                                                Y02669 88410002
VCON41   DC    V(IEE4103D)                                       Y02669 88420002
VCON57   DC    V(IEE5703D)                                       Y02669 88430002
VCON21   DC    V(IEE2103D)                                       Y02669 88440002
GETLIST  GETMAIN EC,LV=MSGLEN,A=0,SP=229,MF=L                     21002 88450002
GETLNTH  EQU   *-GETLIST               LENGTH OF LIST FORM.       21002 88500001
         SPACE 5                                                        88550002
PATCH    DC    CL50'***IEE7203D***'                            @Z30LPTJ 88560003
         END                                                            88600001
./  ADD  SSI=83110964,NAME=IEE7303D
 TITLE 'IEE7303D - CONSOLE INFORMATION MESSAGE ROUTINE #2'              00150003
IEE7303D CSECT                                                          00200002
*********************************************************************** 00300001
* MODULE NAME      = IEE7303D                                           00350002
*   CSECT NAME     = IEE7303D                                           00400002
*                                                                       00450002
* LOAD MODULE NAME = IEE3603D                                           00500002
*                                                                       00550002
* DESCRIPTIVE NAME = CONSOLE INFORMATIONAL MESSAGE ROUTINE              00600002
*                                                                       00650002
* COPYRIGHT        = MISSING                                            00700002
*                                                                       00750002
* STATUS           = OS/VS/2 RELEASE 3                         @Z30LPTJ 00800003
*                                                                       00850002
* FUNCTION         = CONSTRUCTS A MESSAGE DISPLAYING THE CURRENT        00900002
*                    STATUS OF THE CONSOLE                              00950002
*                                                                       01000002
* OPERATION        = AFTER A DEVICE HAS BEEN CHANGED INTO THE           01050002
*                    CONSOLE STATE, THIS ROUTINE IN CONJUNCTION         01100002
*                    WITH IEE4803D BUILDS AND SENDS A MESSAGE           01150002
*                    TO THE OPERATOR DISPLAYING THE CURRENT STATUS      01200002
*                    OF THE NEW CONSOLE DEVICE                          01250002
*                    THE MESSAGE CONTAINS THE PHYSICAL DEVICE           01300002
*                    ADDRESS OF THE CONSOLE AND ITS ALTERNATE CONSOLE   01350002
*                    AND WHETHER THE CONSOLE IS ACTIVE AND/OR           01400002
*                    THE MASTER CONSOLE.  IT ALSO HAS THE ROUT CODES    01450002
*                    AND COMMAND AUTHORITY OF THE NEW CONSOLE.          01500002
*                    THIS RTN IS CALLED REPEATEDLY BY 4803D, AS         01510002
*                    MANY TIMES AS THERE ARE UNITS ON THE CMD.          01520002
*                                                                       01550002
* NOTES                                                                 01600002
*   DEPENDENCIES   = NONE                                               01650002
*   CHARACTER/CODE DEPENDENCIES                                         01700002
*                  = THIS MODULE IS DEPENDENT ON THE EBCDIC             01750002
*                    REPRESENTATION OF DECIMAL DIGITS                   01800002
*                                                                       01850002
* RESTRICTIONS     = SEE ENTRY POINTS - INPUT DATA                      01900002
*   REGISTER CONVENTIONS                                                01950002
*                  = REGISTERS ARE DEFINED AT LABEL: DEFREG             02000002
*   PATCH LABEL    = PATCH                                              02050002
*                                                                       02100002
* MODULE TYPE      = CSECT                                              02150002
*   PROCESSOR      = ASSEMBLER                                          02200002
*   MODULE SIZE    = VS/2 = '356'                              @ZM30445 02250003
*   ATTRIBUTES     = REENTRANT, REFRESHABLE, REUSABLE,                  02300002
*                    ZERO PSW PROTECT KEY                               02350002
*                                                                       02400002
* ENTRY POINTS     = IEE7303D                                           02450002
*                    FROM IEE4803D                                      02500002
*   PURPOSE        = TO ISSUE THE INFORMATIONAL CONSOLE MESSAGE         02550002
*                    AND ALSO THE HARDCPY MESSAGE IF THE CONSOLE        02600002
*                    IS ACTING AS THE HARDCPY DEVICE AS WELL            02650002
*   LINKAGE        = BRANCH                                             02700002
*   INPUT          = REG2 PTS TO THE DUMMY XSA                          02750002
*                    REG0 HAS COMPOSITE UCME PTR OR 0 IF NONE           02760002
*                    REG4 HAS THE PROCESS BITS                          02770002
*                    REG5 PTS TO UCME OF UNIT OR I-UNIT IF COMP.        02780002
*                    REG 13 PTS TO THE SAVE AREA, WORD 17 OF THE        02800002
*                       SAVE AREA CONTAINS THE PTR TO THE CSCB          02850002
*                    REG1 PTS TO THE MESSAGE CORE GOTTEN BY             02900002
*                    IEE4903D ( WHO ISSUE THE FIRST INFORMATIONAL       02950002
*                    HEADER MSG).                                       03000002
*                    XAR OF THE DUMMY XSA HAS THE PROCESS SWITCHES      03150002
*                    XAL OF THE DUMMY XSA HAS THE POINTER TO THE        03200002
*                       PARMS OF THE COMMAND                            03250002
*                    XRESV MAY HAVE BIT1 SET TO INDICATE IMMEDIATE      03300002
*                    BRANCH TO LABEL: CRT2                              03350002
*                    REG9 POINTS TO THE UNIT                            03550002
*                    REG11 WILL BE ZERO UNLESS HARDCPY MSG IS NEEDED.   03600002
*                    THEN, IT WILL CONTAIN THE POINTER TO THE UCME      03650002
*                    OF THE HARDCPY UNIT                                03700002
*                    REG12 CONTAINS THE ADDRESS OF THE MSG AREA         03750002
*                    XAP CONTAINS THE MLWTO ID AND  THE GRAPHICS        03900002
*                    INDICATOR.                                         03950002
*   REGISTERS SAVED  = ALL                                              04000002
*   REGISTER USAGE = REG1    PTR TO WTO CORE ON INPUT                   04050002
*                    REG2    PTR TO  THE DUMMY XSA                      04100002
*                    REG3    ADDRESSABILITY                             04150002
*                    REG4    PROCESS BITS                               04200002
*                    REG5    UCME PTR                                   04210002
*                    REG10   UCM PTR                                    04350002
*                    REG11   HCPY OF NOHCPY MSG SWITCH                  04400002
*                    REG12   MSG ADDRESSABILITY                         04450002
*                    REG13   SAVE AREA PTR                              04500002
*                    REG14   COMPOSITE SWITCH                           04550002
*   REGISTERS RESTORED                                                  04600002
*                  = ALL                                                04650002
*                                                                       04700002
* EXITS - NORMAL-1-= TO IEE4803D VIA BRANCH                             04750002
*   CONDITIONS     = IF A HARDCPY MESSAGE IS STILL REQUIRED             04800002
*   OUTPUT         = REG2 PTS TO THE DUMMY XSA                          04850002
*                    REG13 PTS TO THE SAVE AREA                         04900002
*                    REG1 PTS TO THE MESSAGE CORE GOTTEN BY 4903D       04950002
*                    REG11 HAS THE INDICATOR FOR THE HARDCPY MSG        05000002
*                    XRESV OF THE XSA WILL HAVE THE HIGH ORDER BIT      05050002
*                       SET TO IMMEDIATELY BRANCH TO LABEL: CENDCHK     05100002
*                    REG4 CONTAINS THE CURRENT PROCESS SWITCHES         05150002
*   RETURN CODES   = NONE                                               05350002
*                                                                       05400002
* EXITS - NORMAL-2-  = RETURN TO CALLER VIA A BR 14 AFTER THE CSCB      05450002
*                    HAS BEEN FREED VIA AN MGCR MACRO AND THE           05500002
*                    DUMMY XSA GOTTEN BY 3603D, AND THE SAVE AREA       05550002
*                    GOTTEN BY 3303D ARE FREED.                         05600002
*   CONDITIONS     = ALL MESSAGES ARE ISSUED, THE COMMAND IS            05650002
*                    COMPLETED                                          05700002
*   OUTPUT         =  MESSAGES HAVE BEEN SENT AND ALL CORE HAS BEEN     05750002
*                    FREED.                                             05800002
*   RETURN CODES   = NONE                                               05850002
*                                                                       05860002
* EXITS - ERROR    = NONE                                               05870002
*                                                                       05880002
* EXTERNAL REFERENCES                                                   05890002
*   ROUTINES       = IEE4803D                                           05892002
*   DATA AREAS     = SEE EXITS - OUTPUT DATA                            05894002
*                                                                       05896002
* CONTROL BLOCKS   = 1. DUMMY EXTENDED AREA (XSA)                       05898002
*                    2. DISPLAY CONTROL MODULE (DCM)                    05898402
*                       FIELDS TESTED -  DCMTOPAR                       05898802
*                       FIEDLS UPDATED - NONE                           05899202
*                    3. CVT                                             05899602
*                       FIELDS TESTED  - CVTCUCB                        05899702
*                       FIELDS UPDATED - NONE                           05899802
*                    4. UNIT CONTROL MODULE (UCM)                       05899902
*                       FIELDS TESTED  - UCMDISP- BIT=UCMDISPC          05933202
*                                                     UCMDISPG          05935202
*                                        UCMID                          05937202
*                                        UCMRTCD                        05939202
*                                        UCMXB                          05941202
*                       FIELDS UPDATED - NONE                           05943202
*                    5. COMMAND SCHEDULING CONTROL BLOCK (CSCB)         05953202
*                       FIELDS TESTED  - NONE                           05963202
*                       FIELDS UPDATED - CHSTS - BIT= CHFC              05965202
*                                                                       05965602
* TABLES           = MESSAGE BUFFER GOTTEN BY IEE4903D                  05966002
*                                                                       05966402
* MACROS           = MGCR,FREEMAIN,WTO,DEQ,SETLOCK                      05966502
*                                                                       05966602
* MAPPING MACROS   = IEEXSA                                             05977702
*                    CVT                                                05987702
*                    IEECUCM                                            05988102
*                    IEERDCM                                            05988602
*                    IEECHAIN                                           05989602
*                    IHAPSA                                             05991602
*   SERIALIZATION  = PROTECTION AGAINST COMM. TASK IS ACCOMPLISHED      05992002
*                    VIA THE CMS AND LOCAL LOCKS OBTAINED AT:           05992402
*                        CSETLOCK IN MODULE IEE4803D                    05992802
*                    AND RELEASED IN THIS MODULE AT:                    05992902
*                        UNSTLOCK                                       05995802
*                    PROTECTION AGAINST OLTEP, VARY/UNLOAD AND          05997802
*                    ALLOCATION IS ACCOMPLISHED VIA THE ENQ             05998202
*                    ISSUE IN MODULE IEE3603D.                          05998602
*                    A DEQ IS ISSUED IN THIS MODULE AT: CDEQUE          05998702
*                    IF THE COMMAND HAS A TERMINAL EXIT FROM HERE.      05998802
*                    OTHERWISE, THE DEQ WILL BE ISSUED IN 4803D         05998902
*                    WHERE THAT MODULE WILL EXIT IF NOT FROM HERE.      05999202
*                                                                       06000002
* CHANGE LEVEL     = Y02669, Y02651, Z30LPTJ, ZM30445          @ZM30445 06001803
*                                                                       06004702
* CHANGE ACTIVITY  = N/A                                                06007602
*                                                                       06010502
* MESSAGES         = REFER TO PROLOGUE OF IEE4903D FOR FULL INFORMATION 06013402
*                                                                       06016302
* ABEND CODES      = NONE                                               06019202
*                                                                       06022102
* PACKAGING        = IEE7303D WILL BE PART OF LOAD MODULE               06032102
*                       IEE3603D                                        06042102
*                    THIS LOAD MODULE ALIASES ARE                       06044102
*                       NONE                                            06046102
*                    THIS LOAD MODULE ENTRY POINTS ARE                  06048102
*                       IEE3603D                                        06056702
*                    MODULE WILL RESIDE IN: LPALIB                      06057102
*                                                                       06058702
* SYSGEN           = SUPPLIED BY THE FOLLOWING SECTIONS:                06060702
*                       LOAD MODULE NAME                                06062702
*                       PACKAGING                                       06064702
*                    THIS CSECT WILL BE INCLUDED AT SYSGEN FROM         06064802
*                    DLIB -AOSB3- BY MACRO -SGIEF441-                   06073602
*                                                                       06078002
* SYSTEM LIBRARIES = NONE                                               06082402
*                                                                       06086802
*********************************************************************** 06091202
         EJECT                                                          06095602
*                                                                 19084 06100001
*********************************************************************** 06200001
*                                                                 19084 06300001
*        REGISTER EQUATES                                         19084 06400001
*                                                                 19084 06500001
*********************************************************************** 06600001
DEFREG   EQU   *                                                 Y02669 06650002
R0       EQU   0                   INPUT = COMPOSITE SWITCH      Y02669 06700002
R1       EQU   1                   IN-PTR TO WTO CORE            Y02669 06800002
R2       EQU   2                   XSA                            19084 06900001
R3       EQU   3                   ADDRESSABILITY                 19084 07000001
R4       EQU   4                   PROCESS BITS                         07100002
R5       EQU   5                   UCME PTR                             07200002
R6       EQU   6                                                  19084 07300001
R7       EQU   7                                                        07400002
R8       EQU   8                                                        07450002
R9       EQU   9                                                        07600002
R10      EQU   10                  UCM                            19084 07700001
R11      EQU   11                  HCPY OR NOHCPY MSG SWITCH      19084 07800001
R12      EQU   12                  MSG ADDRESSABILITY             19084 07900001
R13      EQU   13                  SAVE AREA PTR                 Y02669 08000002
R14      EQU   14                  USED AS COMPOSITE SWITCH      Y02669 08100002
R15      EQU   15                                                 19084 08200001
*                                                                 19084 08300001
         SPACE 10                                                       09200001
*********************************************************************** 09300001
*                                                                 19084 09400001
*        EQUATES                                                  19084 09500001
*                                                                 19084 09600001
*********************************************************************** 09700001
ZERO     EQU   0                                                  19084 09800001
ONE      EQU   1                                                  19084 09900001
TWO      EQU   2                                                  19084 10000001
FOR      EQU   4                                                        10050003
TRE      EQU   3                                                  19084 10100001
FIV      EQU   5                                                  19084 10300001
FIFTN    EQU   15                                                 19084 10500001
D64      EQU   64                                                Y02669 10560002
D132     EQU   132                                               Y02669 10570002
D68      EQU   68                                                Y02669 10572002
SVN      EQU   7                                                        10573002
*                                                                       10580002
DASH     EQU   C'-'                                               19084 10700001
COMMA    EQU   C','                                               19084 10800001
FOXES    EQU   X'FF'                                              19084 10900001
FOXZERO  EQU   X'F0'                                              19084 11000001
NONE     EQU   X'00'                   NO Z FIELD                 21002 11100001
JUSTA    EQU   C'A'                    NO END OF AREA FIELD       21002 11200001
ZONEBIT  EQU   X'0F'                   UNPACK CONSOLE ID          21002 11400001
LOWORDR  EQU   8                  SHIFT MLWTO TO HI ORDER BITS    21002 11500001
EIT      EQU   8                       LENGTH OF ELINE            21002 11550001
BLNK   EQU     X'40'                   BLANK                      21002 11600001
ELEVEN   EQU   11                                                 21002 11800001
TEN      EQU   10                                                 21002 11900001
DISPLAY1 EQU   C'Z'                    CHARACTER Z FOR MESSAGE    21002 12100001
DISPLAY2 EQU   C','                    COMMA FOR AREA FIELD       21002 12200001
DISPLAY3 EQU   C'A'                    CHARACTER A FOR MSG        21002 12300001
DISPLAY4 EQU   C'-'                    DASH SEPARATOR FOR MSG     21002 12400001
*                                                                 19084 12500001
*        LENGTH AND SHIFT EQUATES                                 19084 12600001
SHIFT1   EQU   1                                                  19084 12700001
GRPX     EQU   X'FF'                   GRAPHICS INDICATOR         21002 12750001
*                                                                 19084 12800001
RI       EQU   X'80'                                           @ZM30445 12850003
         EJECT                                                    19084 12900001
*********************************************************************** 12950002
*                                                                Y02669 12960002
*        CONSOLE MESSAGE PROCESSOR                               Y02669 12970002
*                                                                Y02669 12980002
*********************************************************************** 12990002
*                                                                Y02669 12992002
         SPACE 3                                                        12994002
         BALR  R3,ZERO                                            19084 13000001
         USING *,R3                                               19084 13100001
         MODID BR=YES                                            Y01886 13150001
         USING XSA,R2                                             19084 13200001
         USING CMESSAGE,R12        ADDRESS MSG AREA               19084 13300001
*                                                                Y02669 13350002
         STM   R0,R15,ZERO(R13)                                  Y02669 13360002
*  AS OF NOW THE FOLLOWING REGISTERS HAVE THE FOLLOWING CONTENT  Y02669 13362002
*  R0  = COMPOSITE (O-UNIT) UCME PTR OR IS 0                     Y02669 13364002
*  R1  = MSG AREA POINTER                                        Y02669 13366002
*  R2  = DUMMY XSA POINTER                                       Y02669 13368002
*  R4  = CURRENT PROCESS BITS                                    Y02669 13368402
*  R5  = UNIT OR I-UNIT (IF COMP) UCME POINTER                   Y02669 13368802
*  R9  = CURRENT UNITNAME POINTER                                Y02669 13369202
*  R11 = HCPY INDICATOR OR 0 IF NONE REQUIRED                    Y02669 13369602
*  R12 = MSG AREA POINTER = R1                                   Y02669 13369702
*  R13 = SAVE AREA POINTER                                       Y02669 13369802
*  R14 = RETURN ADDRESS                                          Y02669 13376602
*                                                                Y02669 13379902
         LR    R14,R0              SAVE COMPOSITE SWITCH         Y02669 13400002
         L     R10,CVTPTR                                         19084 13500001
         USING XCVT,R10                                           19084 13600001
         L     R10,CVTCUCB         GET PTR TO UCM                 19084 13700001
         DROP  R10                                                19084 13800001
         USING UCM,R10                                           Y02669 13900002
         USING UCMLIST,R5                                         19084 14000001
*********************************************************************** 14100001
*          CONSOLE ID AND DISPLAY AREA ID                        21002* 14200001
*********************************************************************** 14300001
         LTR   R14,R14                 IS THIS A COMPOSITE CONSL Y02669 14320002
         BZ    NOCOMP                  NO                         21002 14340001
         LR    R5,R14                  USE UCME FOR COMPOSITE    Y02669 14360002
NOCOMP   EQU   *                                                  21002 14380001
*                                                                       14390002
*  REG5  HAS UCME POINTER TO UNIT AS PASSED BY 4803D OR                 14392002
*        UCME POINTER OF THE O-UNIT OF A COMP IF THIS IS A COMP         14394002
*                                                                       14396002
         SR    R8,R8              CLEAR REGISTER FOR CONSOLE ID   21002 14400001
         IC    R8,UCMID                CONSOLE ID                 21002 14500001
         CVD   R8,XMSGWK+FOR           CONVERT TO DECIMAL         21002 14600001
         OI    XMSGWK+ELEVEN,ZONEBIT                              21002 14700001
         UNPK  XMSGID(TRE),XMSGWK+TEN(TWO)                        21002 14800001
         MVI   XMSGID,BLNK         BLANK OUT FIRST BYTE OF AREA   21002 14900001
         SPACE                                                          15000001
*********************************************************************** 15050001
* IF XAX + 3 CONTAINS A X'FF' THERE IS AN AREA FIELD.  AT LEAST   21002 15060001
* ONE CONSOLE BEING VARIED IS A GRAPHICS CONSOLE.  IF THIS UNIT  21002* 15070001
* IS NOT A GRAPHICS CONSOLE, THE FIELD REMAINS BLANK.            21002* 15080001
*********************************************************************** 15090001
         SPACE                                                          15092001
         CLI   XAP+TRE,GRPX            IS THIS CONSOLE GRAPHICS  Y02669 15094002
         BNE   NOGRPX                  NO, NO AREA FIELD          21002 15096001
         TM    UCMDISP,UCMDISPC        IS THIS CONSOLE GRAPHICS   21002 15100001
         BNO   RTCDE                   BLANK AREA FIELD           21002 15200001
         TM    UCMDISP,UCMDISPG        GRPX STATUS DISPLAY ONLY   21002 15300001
         BO    CKAREA                  YES, NO Z IN AREA FIELD    21002 15400001
         MVI   XMSGDID,DISPLAY1        MOVE IN Z FOR MSG AREA     21002 15500001
CKAREA   EQU   *                                                  21002 15600001
         L     R8,UCMXB                ADDRESS OF DCM             21002 15700001
         USING DCMRDST,R8                                         21002 15800001
         CLI   DCMTOPAR,NONE           IF THERE IS A ZERO         21002 15900001
         BE    RTCDE                   NO A FIELD                 21002 16000001
         TM    UCMDISP,UCMDISPG        SHOULD COMMA BE INSERTED   21002 16100001
         BO    NOZ                     NO, NO Z FIELD             21002 16200001
         MVI   XMSGDID+ONE,DISPLAY2    MOVE IN COMMA              21002 16300001
NOZ      EQU   *                                                  21002 16400001
         MVI   XMSGDID+TWO,DISPLAY3    MOVE IN BEGINNING OF DISPLAY     16500001
* THE PREVIOUS STATEMENT WAS ADDED FOR SDS                        21002 16600001
         CLI   DCMTOPAR,JUSTA          IF THERE IS AN A           21002 16700001
         BE    RTCDE                   NO END OF AREA FIELD       21002 16800001
         MVI   XMSGDID+TRE,DISPLAY4    MOVE IN SEPARATOR          21002 16900001
         MVC   XMSGDID+FOR(ONE),DCMTOPAR       INSERT END FIELD   21002 17000001
         DROP  R8                                                 21002 17100001
         B     RTCDE                   DSECT POINTER IS RIGHT     21002 17200001
NOGRPX   EQU   *                                                  21002 17300001
         SH    R12,AREAOFS             CORRECT OFFSET INTO MSG DSECT    17400001
*    THE PREVIOUS STATEMENT WAS ADDED FOR SDS                     21002 17500001
RTCDE    EQU   *                                                  21002 17600001
         TM    XARESV,XACRT2    IS THIS A RETURN FROM IEE4803D @Z30LPTJ 17700003
*     THE PREVIOUS STATEMENT WAS ADDED FOR SDS                    21002 17800001
         BO    CRT2                    YES, BRANCH TO CRT2       Y02669 17900002
*********************************************************************** 18000001
*                                                                 19084 18100001
*        ROUTING CODE  DETERMINATION                              19084 18200001
*                                                                 19084 18300001
*********************************************************************** 18400001
*                                                                 19084 18500001
CRTCHK   EQU   *                                                  19084 18600001
         LH    R6,UCMRTCD          ASSUME 10 UNIT, PICK UP RT CODE19084 18700001
*  ROUTS ARE PICKED UP BY USING REG5 AS A POINTER TO THE UCME.   Y02669 18750002
*  R5 IS THE UCME OF THE UNIT (XXX OR O-XXX)                     Y02669 18800002
*  OR THE UCME OF THE O-UNIT IF THIS IS A COMPOSITE.             Y02669 18850002
*                                                                 19084 19500001
CRT2     EQU   *                                                  19084 19600001
          SPACE 10                                                      19650002
**************************************************               Y02651 19652002
*                                                                Y02651 19652402
*  LOCKS ARE NO LONGER NEEDED AND THEY MUST BE RELEASED. VERY    Y02651 19652802
*  SHORTLY A WTO MACRO WILL BE ISSUED.                           Y02651 19653202
*  THESE LOCKS WERE OBTAINED AT CSETLOCK IN MODULE IEE4803D      Y02651 19653602
*                                                                Y02651 19653702
UNSTLOCK EQU   *                                                 Y02651 19653802
         LR    R7,R13             SAVE AREA POINTER              Y02651 19653902
         STM   R11,R14,D68(R7)    SAVE SETLOCK REGS              Y02651 19665402
         SETLOCK  RELEASE,TYPE=CMS,RELATED=(IEE4803D(CSETLOCK))  Y02651 19675402
         SETLOCK  RELEASE,TYPE=LOCAL,RELATED=(IEE4803D(CSETLOCK))       19675802
         LM    R11,R14,D68(R7)                                   Y02651 19676202
**************************************************               Y02651 19677002
         SPACE 10                                                       19688502
         NI    XARESV,FOXES-XACRT2     TURN OFF BRANCH BIT     @Z30LPTJ 19700003
         LTR   R6,R6               ANY                            19084 19800001
         BZ    CNONERT             NO, ROUT IS -NONE-             19084 19900001
         CH    R6,CRTALL           ALL                            19084 20000001
         BE    CROUTALL            YES, ROUT IS -ALL-             19084 20100001
*                                                                 19084 20200001
*        PROCESS INDIVIDUAL ROUTCODES                             19084 20300001
*                                                                 19084 20400001
*        R5 HAS PTR TO UNTS UCME OR O-UNT'S UCME IF THIS IS COMP Y02669 20500002
*        R6 HAS ROUTCODES                                         19084 20600001
*        R4 HAS XAR PROCESS BITS                                  19084 20700002
*        R14 HAS THE COMPOSITE UCME PTR OR IS 0                  Y02669 20850002
*        R10 PTS TO UCM                                           19084 20900001
*        R11 HAS INDICATION FOR HCPY MSG                          19084 21000001
*        R12 HAS ADDRESSABILITY FOR MSG AREA                      19084 21100001
*                                                                 19084 21400001
*                                                                 19084 21500001
CRTIND   EQU   *                                                  19084 21600001
         SLL   R6,FIFTN            SHIFT ROUTS OVER               19084 21700001
         LA    R7,CTABLE           R7 PTS TO COMPARE TAB          19084 21800001
         LA    R1,XMSGWK           R1 PTS TO WORK AREA            19084 21900001
         CLI   XAP+TRE,GRPX           IS THERE A GRAPHICS CONSOLEY02699 22000002
         BE    GRPX11                  YES, PTR IS TO WORD BOUND  21002 22100001
         LA    R1,ONE(R1)              PTR TO WORD BOUNDARY       21002 22200001
GRPX11   EQU   *                                                  21002 22300001
NEXT     EQU   *                                                  19084 22400001
         SLL   R6,SHIFT1           SHIFT TO HIGH ORDER            19084 22500001
         LTR   R6,R6               IS IT ON                       19084 22600001
         BZ    NOMORE              NO, NOMORE                     19084 22700001
         BNM   NEXT1               NOT THIS ONE                   19084 22800001
         MVC   ZERO(TWO,R1),ZERO(R7)    YES, MOVE ROUT TO WORK ARE19084 22900001
         LA    R1,TWO(R1)          INDEX TO NEXT FREE SPACE       19084 23000001
NEXT1    EQU   *                                                  19084 23100001
         LA    R7,TWO(R7)          INDEX TO NEXT ROUT IN TAB      19084 23200001
         B     NEXT                GO THECK NEXT ROUT CODE        19084 23300001
*                                                                 19084 23400001
NOMORE   EQU   *                                                  19084 23500001
         MVI   ZERO(R1),FOXES      SET END DELIMITER              19084 23600001
         LA    R1,XMSGRTCD         ROUT AREA IN MSG               19084 23700001
         LA    R7,XMSGWK           WORK AREA                      19084 23800001
         CLI   XAP+TRE,GRPX           IS THERE A GRAPHICS CONSOLEY02669 23900002
         BE    GRPX22                  YES, PTR IS TO WORD BOUND  21002 24000001
         LA    R7,ONE(R7)              PTR TO WORD BOUNDARY       21002 24100001
GRPX22   EQU   *                                                  21002 24200001
         MVC   ZERO(TWO,R1),ZERO(R7)    MOVE OVER TO MSG          19084 24300001
         CLI   ZERO(R7),FOXZERO    ONE DIGIT                      19084 24400001
         BNE   MOVED                    NO, OK                    19084 24500001
         MVC   ZERO(ONE,R1),ONE(R7)     YES, ELIMINATE LEADING ZER19084 24600001
         BCTR  R1,ZERO                                            19084 24700001
MOVED    EQU   *                                                  19084 24800001
         LA    R1,TWO(R1)          INDEX PAST ROUT                19084 24900001
ENDCHK   EQU   *                                                  19084 25000001
         CLI   TWO(R7),FOXES       END OF WORK                    19084 25100001
         BE    CISSUE              YES GO ISSUE MSG               19084 25200001
         MVI   ZERO(R1),COMMA      NO, DELIMIT ROUT               19084 25300001
         LH    R8,ZERO(R7)                                        21002 25400001
         MVC   ONE(TWO,R1),TWO(R7) MOVE IN NEXT ROUT INTO MSG     19084 25500001
         CH    R8,TAB09                WAS ROUT A 09              21002 25600001
         BNE   ENDCHK3             NO, GO ADD ONE                 19084 25700001
         AH    R8,FOX7                 YES, ADD SPECIAL ALGORITHM 21002 25800001
         B     ENDCHK5             GO CHECK IF                    19084 25900001
*                                                                 19084 26000001
ENDCHK3  EQU   *                                                  19084 26100001
         AH    R8,HONE                 PLUS ONE                   21002 26200001
ENDCHK5  EQU   *                                                  19084 26300001
         LA    R7,TWO(R7)                                         19084 26400001
         CH    R8,ZERO(R7)             IS LINE ROUTS              21002 26500001
         BE    SLASH1               YES, DELIMIT WITH A DASH      19084 26600001
ENDSLASH EQU   *                                                  19084 26700001
         CLI   ONE(R1),FOXZERO     NO, IS IT ONE DIGIT           Y02669 26800002
         BE    MOVEOVER            YES, GET RID OF LEADING F0     19084 26900001
         LA    R1,ONE(R1)                                         19084 27000001
CONT     EQU   *                                                  19084 27100001
         LA    R1,TWO(R1)          INDEX TO NEXT FREE SPACE       19084 27200001
         B     ENDCHK              GO CHECK ENDINGS               19084 27300001
MOVEOVER EQU   *                                                  19084 27400001
         MVC   ONE(ONE,R1),TWO(R1) MOKE IT A SINGLE DIGIT         19084 27500001
         B     CONT                CONTINUE                       19084 27600001
SLASHRTN EQU   *                                                  19084 27700001
         LA    R7,TWO(R7)          INDEX TO NEXT DIGIT IN WORK    19084 27800001
         CLI   TWO(R7),FOXES       END                            19084 27900001
         BE    SLASH6              YES, GO MAKE FINAL PROCEDURES  19084 28000001
SLASH1   EQU   *                                                  19084 28100001
         MVI   ZERO(R1),DASH       MOVE IN A DASH                 19084 28200001
         CH    R8,TAB09                ROUT IS 09                 21002 28300001
         BNE   SLASH2              NO                             19084 28400001
         AH    R8,FOX7                 YES, ADD SPECIAL ALGORITHM 21002 28500001
         B     SLASH4              GO CHECK                       19084 28600001
SLASH2   EQU   *                                                  19084 28700001
         AH    R8,HONE                 PLUS ONE                   21002 28800001
SLASH4   EQU   *                                                  19084 28900001
         CH    R8,TWO(R7)              EQUAL                      21002 29000001
         BE    SLASHRTN            YES, GO CHECK END              19084 29100001
SLASH6   EQU   *                                                  19084 29200001
         MVC   ONE(TWO,R1),ZERO(R7)     NO,MOVE IN LAST ROUT CODE 19084 29300001
         B     ENDSLASH            GO CHECK END                   19084 29400001
*                                                                 19084 29500001
*                                                                 19084 29600001
CNONERT  EQU   *                                                  19084 29700001
         MVC   XMSGRTCD(FOR),CNONE      MOVE IN NONE              19084 29800001
         LA    R1,XMSGRTCD+FOR          INDEX TO END              19084 29900001
         B     CISSUE                   GO ISSUE                  19084 30000001
*                                                                 19084 30100001
CROUTALL EQU   *                                                  19084 30200001
         MVC   XMSGRTCD(TRE),CALL       MOVE IN ALL               19084 30300001
         LA    R1,XMSGRTCD+TRE          INDEX TO END              19084 30400001
*                                                                 19084 30500001
         EJECT                                                    19084 30600001
CISSUE   EQU   *                                                  19084 30700001
         L     R0,XAP                  GET MLWTO ID              Y02669 30750002
         IC    R0,XAU                  CONSOLE ID                 21002 31200001
         TM    XAU,RI               IS THIS FROM INPUT STREAM? @ZM30445 31220003
         BNO   XAUIN1               NO, AVOID NEXT INSTRUCTION @ZM30445 31240003
         IC    R0,ZEROZERO        YES, INDICATE MASTER CONSOLE @ZM30445 31260003
XAUIN1   EQU   *                                               @ZM30445 31280003
*        REG0 CONTAINS THE MLWTO ID IN THE THREE HIGH ORDER BYTES 21002 31300001
*        AND THE CONSOLE ID IN THE LOW ORDER BYTE                 21002 31400001
         CLI   XAP+TRE,GRPX            GRAPHICS INDICATOR SET    Y02669 31500002
         BE    GRPXH                   YES                        21002 31600001
         AH    R12,AREAOFS             RESET PTR TO MSG DSECT     21002 31700001
GRPXH    EQU   *                                                  21002 31800001
*********************************************************************** 31810001
* A DATA LINE IS ISSUED.  THEN A CHECK MADE TO SEE IF ANY MORE   21002* 31820001
* UNITS EXIST (R4 IS NOT ZERO).  IF THERE ARE MORE UNITS, RETURN 21002* 31830001
* IS MADE TO IEE4803D.  IF THERE ARE NO MORE UNITS, A TEST IS MAD21002* 31840001
* TO SEE IF ONE OF THE UNITS WAS THE HARDCOPY DEVICE (R11 WILL CONTAIN* 31842001
* THE ADDRESS OF A UCME).  IF THERE WAS A HARDCOPY UNIT, RETURN Y02669* 31844002
* TO IEE4803D.  OTHERWISE AN END LINE IS ISSUED AND CONTROL RETURNED  * 31846001
* TO THE COMMUNICATION TASK.                                     21002* 31848001
*********************************************************************** 31849701
         SPACE                                                          31849801
         MVC   ZERO(FOR,R12),DLINE       MCSFLAGS                 21002 32600001
         MVC   ZERO(FOR,R1),DLINE+FIV     LINE TYPE AND LINE NO   21002 32700001
         SR    R1,R12                  CALCULATE LENGTH OF        21002 32800001
         STC   R1,ONE(R12)             PUT LENGTH IN MSG          21002 32900001
         LR    R1,R12                  ADDRESS OF MESSAGE         21002 33000001
         WTO   MF=(E,(1))          ISSUE MSG                      19084 33100001
*                                                                 19084 33200001
         SLL   R1,LOWORDR              MLWTO IN THREE HI ORDER BYT21002 33210001
         IC    R1,XAP+TRE              GET GRAPHICS INDICATOR    Y02669 33220002
         ST    R1,XAP                  SAVE  NEWMLWTO ID         Y02669 33250002
         SLL   R4,SHIFT1               THIS UNIT WAS PROCESSED    21002 33252001
         LTR   R4,R4                   ANY MORE UNITS TO PROCESS  21002 33260001
         BNZ   CEXIT                   MULTIPLE UNITS             21002 33294001
         LTR   R11,R11                 HARDCOPY LINE NEEDED       21002 33296001
         BNZ   CEXIT                   YES, RETURN TO 4803D       21002 33298001
         SPACE 10                                                 19084 33300001
RETURN   EQU   *                                                  21002 33650001
         L     R0,XAP                  GET MLWTO ID              Y02669 33652002
         IC    R0,XAU                  GET CONSOLE ID             21002 33656001
         TM    XAU,RI               IS THIS FROM INPUT STREAM? @ZM30445 33656803
         BNO   XAUIN2               NO, AVOID NEXT INSTRUCTION @ZM30445 33657603
         IC    R0,ZEROZERO        YES, INDICATE MASTER CONSOLE @ZM30445 33658403
XAUIN2   EQU   *                                               @ZM30445 33659203
         MVC   ZERO(EIT,R12),ELINE     END LINE                   21002 33660001
         LR    R1,R12                  ADDRESS OF BUFFER          21002 33670001
         WTO   MF=(E,(1))                                         21002 33680001
         SPACE 10                                                       33690002
***************************************************              Y02651 33692002
*  THIS IS A TERMINAL EXIT AND THEREFORE THE ENQ ISSUED IN       Y02651 33692402
*  MODULE IEE3603D WILL BE RELEASED VIA A DEQ ISSUED HERE        Y02651 33692802
*                                                                Y02651 33693202
CDEQUE   EQU   *                                                 Y02651 33693602
         DEQ   MF=(E,IEFDEQUE)                                   Y02651 33693702
***************************************************              Y02651 33694002
         SPACE 10                                                       33696002
         LR    R1,R12                   PTR TO MSG AREA IN 1      19084 33700001
         FREEMAIN R,LV=96,A=(1),SP=229                           Y02669 33800002
         L     R1,D64(R13)         GET CSCB PTR                  Y02669 33850002
         USING CHAIN1,R1                                         Y02669 33860002
         OI    CHSTS,CHFC          SET TO FREE SCB               Y02669 33870002
         MGCR  (1),CHAIN                                         Y02669 33880002
         LM    R0,R15,ZERO(R13)    RESTORE REGS                  Y02669 33890002
         LR    R4,R14              SAVE RETURN ADDRESS           Y02669 33892002
*                                  FREE SAVE AREA GOTTEN IN 3303DY02669 33898402
         LR    R1,R2               PRT TO DUMMY XSA              Y02669 33898802
         LA    R0,D132             SIZE OF DUMMY XSA             Y02669 33899202
         FREEMAIN R,LV=(0),A=(1)                                 Y02669 33899602
*                                  FREEMAIN DUMMY XSA            Y02669 33899702
         LR    R14,R4              RESTORE RETURN REG            Y02669 33899802
         BR    R14                      RETURN                    19084 33900001
         EJECT                                                    19084 34000001
CEXIT    EQU   *                                                  21002 34100001
         OI    XARESV,XACENDCK       INDICTE BRANCH TO CENDCHK @Z30LPTJ 34200003
         MVC   XAX+TRE(TWO),EXITNAME     NAME OF 4803D           Y02669 34550002
         LM    R0,R15,ZERO(R13)                                  Y02669 34600002
         L     R15,VCON48          GET ADDRESS OF 4803D          Y02669 34650002
         BR    R15                                               Y02669 34700002
         SPACE                                                          35100002
*                                                                Y02669 35150002
*  AS OUTPUT THE REGISTER ARE IN THE FOLLOWING STATUS:           Y02669 35160002
*  R0  = POINTER TO THE JUST PROCESSED O-UCME OF 0 IF NON-COMP   Y02669 35170002
*  R1  = MSG CORE POINTER                                        Y02669 35180002
*  R2  = DUMMY XSA POINTER                                       Y02669 35190002
*  R4  = CURRENT PROCESS BITS                                    Y02669 35192002
*  R5  = POINTER TO JUST PROCESSED UNIT OR I-UNIT UMCE IF COMP   Y02669 35194002
*  R9  = POINTER TO CURRENT UNIT NAME                            Y02669 35196002
*  R11 = HCPY INDICATOR OR 0                                     Y02669 35198002
*  R12 = MSG AREA POINTER                                        Y02669 35198402
*  R13 = SAVE AREA POINTER                                       Y02669 35198802
*  R14 = RETURN ADDRESS                                          Y02669 35199202
*                                                                Y02699 35199602
         EJECT                                                          35199702
**************************************************               Y02651 35199802
*  THE LIST FORM OF THE DEQ MACRO FOLLOWS:                       Y02651 35224802
*                                                                Y02651 35234802
IEFDEQUE DEQ   (IEFSQCBS,IEFQ4QCB,TWO,SYSTEM,IEFSQCBS,IEFVQCBS,SVN,    *35244802
               SYSTEM),RET=HAVE,MF=L                           @YM5443P 35245402
IEFVQCBS DC    C'VARYDEV'                                               35246002
IEFSQCBS DC    C'SYSIEFSD'                                       Y02651 35246802
IEFQ4QCB DC    C'Q4'                                             Y02651 35248802
**************************************************               Y02651 35250002
         EJECT                                                          35275002
*********************************************************************** 35300001
*                                                                 19084 35400001
*        DECLARE AREA FOR MODULE                                  19084 35500001
*                                                                 19084 35600001
*********************************************************************** 35700001
*                                                                 19084 35800001
         DS    0F                                                Y02669 35850002
VCON48   DC    V(IEE4803D)                                       Y02669 35860002
EXITNAME DC    C'48'                                             Y02669 35900002
CNONE    DC    C'NONE'             NO CMD AUTH OR NO ROUTS        19084 36000001
SYSLOG   DC    C'SYSLOG'           SEE IF CONSOLE ID IS NEEDED.   21002 36050001
CRTALL   DC    X'FFFF'             ALL ROUTS                      19084 36100001
FOX7     DC    X'00F7'             ..                             19084 36300001
HONE     DC    X'0001'             ..                             19084 36400001
CALL     DC    C'ALL'              ALL ROUT AND CMD AUTH          19084 36500001
ZEROZERO DC    X'00'                                           @ZM30445 36550003
ELINE    WTO   (' ',E),MF=L                                       21002 36600001
DLINE    WTO   (' ',D),MF=L                                       21002 36700001
AREAOFS  DC    H'7'                    CORRECTION FOR MSG DSECT   21002 36800001
         EJECT                                                          36900001
*********************************************************************** 37000001
         DS    0H                                                 19084 37100001
CTABLE   DC    C'01'               ROUTCODE COMPARE TABLE         19084 37200001
         DC    C'02'                      ---**---                19084 37300001
         DC    C'03'                      ---**---                19084 37400001
         DC    C'04'                      ---**---                19084 37500001
         DC    C'05'                      ---**---                19084 37600001
         DC    C'06'                      ---**---                19084 37700001
         DC    C'07'                      ---**---                19084 37800001
         DC    C'08'                      ---**---                19084 37900001
*********************************************************************** 38000001
TAB09    DC    C'09'                      ---**---                19084 38100001
         DC    C'10'                      ---**---                19084 38200001
         DC    C'11'                      ---**---                19084 38300001
         DC    C'12'                      ---**---                19084 38400001
         DC    C'13'                      ---**---                19084 38500001
         DC    C'14'                      ---**---                19084 38600001
         DC    C'15'                      ---**---                19084 38700001
         DC    C'16'                      ---**---                19084 38800001
*                                                                 19084 38900001
         SPACE 5                                                        38950002
PATCH    DC    CL50'***IEE7303D***'                                     38960003
*                                                                       38970002
         EJECT                                                    19084 39000001
CMESSAGE DSECT                                                    19084 39100001
XTEXT    DS    1F                      HEADER FIELD               21002 39200001
*                                                                 19084 39300001
*                                                                 19084 39400001
XUNIT1   DS    CL3                 1ST PHUSICAL UNIT ADDRES       19084 39500001
XBLANK   DS    CL1                 COMMA                          19084 39600001
XUNIT2   DS    CL3                                                19084 39700001
XCOMMA   DS    CL1                                                19084 39800001
XAUNIT1  DS    CL3                                                19084 39900001
XBLK     DS    CL1                                                19084 40000001
XAUNIT2  DS    CL3                                                19084 40100001
XMSGPAD1 DS    CL1                                                19084 40200001
XMSGSTAT DS    CL4                                                19084 40300001
XMSGPAD2 DS    CL1                                                19084 40400001
XMSGAUTH DS    CL1                                                19084 40500001
XMSGPAD3 DS    CL7                     BLANKS                     21002 40600001
XMSGID   DS    CL3                     CONSOLE ID                 21002 40700001
XMSGPAD4 DS    CL1                     BLANK                      21002 40800001
XMSGDID  DS    CL5                     DSIPLAY AREA ID            21002 40900001
XMSGPAD5 DS    CL2                     BLANKS                     21002 41000001
XMSGRTCD DS    CL8                                                19084 41100001
XMSGWK   DS    CL30                                               19084 41200001
*                                                                 19084 41300001
         EJECT                                                          41400001
CXSA     DSECT                                                          41500001
         IEEXSA                                                         41600001
         EJECT                                                          48800001
DCMRDST  DSECT                                                          48900001
         IEECRDCM                                                       49000001
         EJECT                                                          49100001
XCVT     DSECT                                                          49200001
         CVT                                                            49300001
         EJECT                                                          49400001
XUCM     DSECT                                                          49500001
         IEECUCM    FORMAT=NEW                                          49600002
         EJECT                                                          49650002
CHAIN1   DSECT                                                          49660002
         IEECHAIN                                                       49700002
         EJECT                                                          49750002
         IHAPSA                                                         49800002
         END                                                            50000001
./  ADD  SSI=80790467,NAME=IEE7503D
         TITLE 'IEE7503D -- L=CCA AND LIST PROCESSOR'                   00100002
*********************************************************************** 00150002
*                                                                     * 00152002
* MODULE NAME      =  IEE7503D                                  Y02669* 00160002
*                                                                     * 00170002
* DESCRIPTIVE NAME =  L=CCA AND ITS DEFAULTS AND LIST           Y02669* 00180002
*                     OPERAND PROCESSOR                         Y02669* 00182002
*                                                                     * 00190002
* COPYRIGHT        =  N/A                                       Y02669* 00192002
*                                                                     * 00194002
* STATUS           =  OS/VS2 RELEASE 037  SU 17               @ZA29986* 00194100
*                                                                     * 00198002
* FUNCTION         =  THIS MODULE PROCESSES THE FOLLOWING       Y02669* 00198402
*                     OPERANDS ON THE FOLOWING COMMANDS:        Y02669* 00199702
*                     COMMAND            OPERANDS               Y02669* 00201702
*                     ______             ________               Y02669* 00202102
*                     D  C,K                                    Y02669* 00203702
*                     D  CONSOLES  (C)                          YM1916* 00205702
*                     D  U                                      Y02669* 00206102
*                     D  M                                      Y02669* 00206202
*                     D  3850                                 @Z40LPTA* 00206341
*                     D  DMN                                  @Z40BPSV* 00206441
*                     D  SLIP                                 @G17SPTJ* 00206641
*                     D  DUMP (D)                             @G33CPMR* 00206833
*                     K  COMMANDS       L=CCA AND DEFAULTS      Y02669* 00207141
*                     PT JOBS  (J)                              Y02669* 00207302
*                        TS                                     Y02669* 00207402
*                        A                                      Y02669* 00207502
*                   __________________________________________  Y02669* 00207602
*                     D  JOBS  (J)                              Y02669* 00208102
*                        TS                                     Y02669* 00209702
*                        A               L=CCA AND DEFAULTS     Y02669* 00211702
*                     TR JOBS  (J)          AND ,LIST           Y02669* 00212802
*                        TS                   OR ,L             Y02669* 00213202
*                        A                                      Y02669* 00213302
*                                                                     * 00215002
* SPECIAL NOTE    =   THE FOLLOWING TERMS ARE INTERCHANGABLE:   Y02669* 00216002
*                       NULL AND X'00'                          Y02669* 00217802
*                       GRAPHICS AND CRT                        Y02669* 00218202
*                       'Z' AND IN-LINE                         Y02669* 00219602
*                       SOURCE, ISSUING AND REQUESTING CONSOLE  Y02669* 00220002
*                       'A' AND AREA                            Y02669* 00220902
*                       'CC' AND TARGET CONSOLE ID              Y02669* 00221302
*                       'L' OPERAND AND 'L=CCA';'L=CC';'L=A'    Y02669* 00221702
*                        OUT-OF-LINE, IN AN AREA AND 'A'        Y02669* 00222102
*                     THE FOLLOWING DEFINITIONS MAY BE USEFUL:  Y02669* 00222502
*                       STATUS DISPLAY (SD)-A CRT IN OUTPUT     Y02669* 00222902
*                         ONLY MODE, DIVIDED INTO AREAS INTO    Y02669* 00223002
*                         WHICH ONLY DYNAMIC AND STATUS         Y02669* 00223102
*                         DISPLAYS CAN APPEAR                   Y02669* 00223202
*                       MESSAGE STREAM (MS)-A CRT IN OUTPUT     Y02669* 00223302
*                         ONLY MODE, WHICH CAN NOT BE DIVIDED   Y02669* 00223402
*                         INTO AREAS AND RECEIVES ONLY IN-LINE  Y02669* 00223502
*                         OPERATOR TYPE MESSAGES                Y02669* 00223602
*                       FULL CAPABILITY (FC)-A CRT IN INPUT-    Y02669* 00223702
*                         OUTPUT MODE WHICH CAN BE DIVIDED INTO Y02669* 00223802
*                         AREAS WHICH CAN RECEIVE BOTH DYNAMIC  Y02669* 00223902
*                         AND STATUS DISPLAYS BUT WHICH ALSO    Y02669* 00224002
*                         CONTAINS AN IN-LINE PORTION AT THE    Y02669* 00224102
*                         TOP OF THE SCREEN FOR OPERATOR TYPE   Y02669* 00224402
*                         MESSAGES                              Y02669* 00224502
*                         IT CAN ALSO BE USED TO ENTER COMMANDS Y02669* 00224602
*                       STATUS DISPLAY-A MULTI-LINE WTO ISSUED  Y02669* 00224702
*                         AS THE RESULT OF MOST 'DISPLAY'       Y02669* 00224802
*                         COMMANDS WHICH APPEARS IN AN AREA 'A' Y02669* 00224902
*                         (OUT-OF-LINE) ON A SD OR FC CRT IF    Y02669* 00225002
*                         'L=A' IS SPECIFIED. OR CAN APPEAR     Y02669* 00225102
*                         IN-LINE ON A MS OR FC CRT.            Y02669* 00225202
*                       DYNAMIC DISPLAY-A MULTI-LINE WTO        Y02669* 00225302
*                         RESULTING FROM A TRACK COMMAND WHICH  Y02669* 00225402
*                         IS PERIODICALLY UPDATED BASED ON A    Y02669* 00225702
*                         TIME INTERVAL.                        Y02669* 00226302
*                         THIS DISPLAY CAN ONLY APPEAR IN AN    Y02669* 00226902
*                         AREA (OUT-OF-LINE) ON A SD OR FC CRT. Y02669* 00227502
*                       IN-LINE (Z) REFERS TO THE MESSAGE       Y02669* 00228102
*                         STREAM PRODUCED ON A MS OR FC CRT.    Y02669* 00228702
*                       OUT-OF-LINE REFERS TO THE AREAS         Y02669* 00229302
*                         DEFINED ON A SD OR FC CRT.            Y02669* 00229902
*                                                                     * 00230502
* OPERATION       =   IF THE REQUESTOR IS JES2(XAN=X'22'), THE  Y02669* 00231102
*                     ENTRY POINT IS IEE7603D, REGISTERS 0 - 14 Y02669* 00231202
*                     ARE SAVED IN XASAVSTD,(REGISTER 2 POINTS  Y02669* 00231302
*                     TO XSA ON ENTRY) LOCKS ARE OBTAINED AND   Y02669* 00231402
*                     THE SPECIAL JES2 INTERFACE CODE INVOKED.  Y02669* 00231702
*                                                                     * 00232902
*                     IF THE REQUESTOR IS A JES3 ASSOCIATED   @Y02668P* 00233203
*                     CONSOLE THEN THE COMMAND WAS NOT ISSUED @Y02668P* 00233503
*                     IN COMTASK'S MEMORY. THE CURRENT TCB    @Y02668P* 00233803
*                     POINTER IN IEFPTRS IS COMPARED TO       @Y02668P* 00236703
*                     COMTASK TCB IN THE UCM(TCBPTR=UCMPAX)   @Y02668P* 00237303
*                     IF THE DON'T MATCH XASSDS3 BIT IS SET   @Y02668P* 00237903
*                     ON. ONLY ROUTABLE (L=CCA) COMMANDS      @Y02668P* 00238703
*                     WILL BE VALID. EXECPT FOR K V,USE=.     @Y02668P* 00238903
*                     ALL MESSAGES WILL BE ISSUED VIA WTO.    @Y02668P* 00239103
*                     THE FOLLOWING MODULES WILL CHECK THE    @Y02668P* 00239303
*                     BIT 1. IEE5603D                         @Y02668P* 00239503
*                         2. IEE6703D                         @Y02668P* 00239703
*                         3. IEE6903D                         @Y02668P* 00240203
*                     IN THE FOLLOWING 'A' WILL REPRESENT THE   Y02669* 00240703
*                     A FIELD IN THE L=CCA OPERAND.             Y02669* 00241203
*                                                                     * 00241703
*                     THE ROUTING FIELD IN THE XSA (XAS) IS     Y02669* 00243703
*                     INITIALIZED TO ZEROES.                    Y02669* 00246603
*                                                                     * 00248603
*                     ALL OF THE ABOVE COMMANDS ARE FIRST       Y02669* 00250603
*                     INTERROGATED FOR THE 'L=CCA' OPERAND.     Y02669* 00252603
*                     IF STOPTR (PT) DOES NOT HAVE ANY         @YM2774P 00254603
*                     OPERAND (D AND TR HAVE ALREADY BEEN      @YM2774P 00256603
*                     'CHECKED), 'IEE311I' IS ISSUED.          @YM2774P 00258603
*                     IF FOUND, IT IS TRANSLATED AND PLACED     Y02669* 00260603
*                     IN THE XSA (XAS), THE 'L' OPERAND IS      Y02669* 00264002
*                     REMOVED FROM THE OPERAND BUFFER, AND      Y02669* 00264402
*                     THE VALUES PLACED IN THE XSA ARE THEN     Y02669* 00264802
*                     VALIDITY CHECKED.                         Y02669* 00265202
*                        XASSDS = XASSDS2 (X'40') 'L' WAS       Y02669* 00266002
*                                 SPECIFIED ON THE COMMAND.     Y02669* 00266402
*                        XASCID = THE SPECIFIED 'CC' VALUE      Y02669* 00266802
*                        XASDID = THE SPECIFIED 'A' VALUE       Y02669* 00267202
*                                                                     * 00267602
*                     IF THE 'L' OPERAND IS FOUND ON A COMMAND  Y02669* 00268402
*                     ISSUED FROM A TSO TERMINAL (XAA = X'00'),Y02669* 00268802
*                     'IEE305I COMMAND INVALID' IS ISSUED.      Y02669* 00269202
*                                                                     * 00270002
*                     IF 'CC' SPECIFIES AN INVALID CONSOLE ID,  Y02669* 00270402
*                     I.E. 'CC' IS HIGHER THAN THE CONSOLE ID   Y02669* 00270802
*                     DEFINED BY THE LAST UCME, OR '00'         Y02669* 00271202
*                     'IEE926I 'CC' NOT A CONSOLE' IS ISSUED.   Y02669* 00271602
*                                                                     * 00272202
*                     IF 'A' IS MORE THAN 1 CHARACTER,          Y02669* 00272802
*                     'IEE156I INVALID OPERAND' IS ISSUED.      Y02669* 00273202
*                                                                     * 00274002
*      MSGRT          IF THE 'L' OPERAND IS NOT FOUND ON THE    Y02669* 00274402
*      DEFAULTS       COMMAND, THE RCT (ROUTING CONTROL TABLE), Y02669* 00274802
*                     POINTED TO BY THE REQUESTING UCME AND     Y02669* 00275202
*                     BUILT AS THE RESULT OF A MSGRT COMMAND    Y02669* 00275602
*                     FOR THE REQUESTING CONSOLE, IS SCANNED    Y02669* 00276402
*                     TO SEE IF A DEFAULT ROUTING VALUE WAS     Y02669* 00277002
*                     SPECIFIED FOR THIS COMMAND.               Y02669* 00277202
*                       K= DEFAULTS FOR ALL CONTROL (K)         Y02669* 00277602
*                          COMMANDS                             Y02669* 00278202
*                       T= DEFAULTS FOR ALL TRACK AND STOPTR    Y02669* 00278802
*                          COMMANDS                             Y20669* 00279202
*                       D=O REPRESENTS DISPLAY CONSOLES (C)     Y02669* 00280002
*                     IF SO, THE ROUTING DEFAULTS ARE PLACED    Y02669* 00280402
*                     IN THE XSA AND VALIDITY CHECKED.          Y02669* 00280802
*                        XASCID = THE MSGRT DEFAULT VALUE       Y02669* 00281202
*                        XASDID = THE MSGRT DEFAULT OR X'00'    Y02669* 00282002
*                        XASSDS = X'00' 'L' NOT SPECIFED        Y02669* 00282402
*                                       ON THE COMMAND          Y02669* 00282802
*                                                                     * 00283202
*      INTERNALLY     IF THE ISSUING CONSOLE ID IS ZERO         YM1557* 00284002
*      ISSUED         (XAU=00) THE COMMAND WAS ISSUED           YM1557* 00284402
*      COMMAND        INTERNALLY. IF THE COMMAND WAS CONTROL    YM1557* 00284802
*                     (K), CONTROL IS RETURNED WITHOUT ANY      YM1557* 00285202
*                     ERROR MESSAGE. IF THE COMMAND WAS TRACK   YM1557* 00286002
*                     OR STOPTR, 'IEE927I  SPECIFY L OPERAND'   YM1557* 00286402
*                     IS ISSUED AND CONTROL RETURNED. ALL       YM1557* 00286802
*                     DISPLAY COMMANDS WILL BE ROUTED TO THE    YM1557* 00287202
*                     MASTER CONSOLE.                           YM1557* 00288002
*                                                                       00288402
*      SYSTEM         IF THERE IS NO CORRESPONDING RCT ENTRY    Y02669* 00288802
*      DEFAULTS       FOR THIS COMMAND, THE SYSTEM DEFAULTS     Y02669* 00289202
*                     TO THE REQUESTING CONSOLE. THE ROUTING    Y02669* 00290002
*                     INFORMATION IS PLACED IN THE XSA AND      Y02669* 00290502
*                     VALIDITY CHECKED.                         Y02669* 00291002
*                        XASCID = XAU (REQUESTING CONSOLE ID)   Y02669* 00291502
*                        XASDID = NULL                          Y02669* 00292002
*                        XASSDS = X'00' 'L' NOT SPECIFED        Y02669* 00292402
*                                       ON THE COMMAND          Y02669* 00292802
*                                                                     * 00293202
*      VALIDITY       THE VALUES IN XAS ARE THEN CHECKED FOR    Y02669* 00294002
*      CHECKING       ROUTING AUTHORITY, AND TO ENSURE THAT THE Y02669* 00294402
*                     TARGET CONSOLE IS ACTIVE WITH AREA 'A'    Y02669* 00294802
*                     DEFINED.                                  Y02669* 00295202
*                                                                     * 00295902
*                     IF THE TARGET AND REQUESTING CONSOLES ARE Y02669* 00296302
*                     NOT THE SAME (XASCID = XAU), THE SOURCE  Y02669* 00296702
*                     CONSOLE IS CHECKED FOR ROUTING AUTHORITY  Y02669* 00297502
*                     (UCMAUTH = X'20'). IF IT DOES NOT         Y02669* 00297902
*                     HAVE AUTHORITY TO ROUTE THE COMMAND,      Y02669* 00298302
*                     'IEE345I AUTHORITY INVALID' IS ISSUED.    Y02669* 00298702
*                                                                     * 00299502
*                     IF THE TARGET CONSOLE IS A SUBSYSTEM     @Y02668P 00299603
*                     (JES3) CONSOLE UCMDISPK WILL BE          @Y02668P 00299803
*                     ON. THE COMMAND WILL BE                  @Y02668P 00300003
*                     REJECTED. ERROR MESSAGE IEE926I          @Y02668P 00300203
*                     L=CCA OPERAND INVALID-CC SUBSYSTEM       @Y02668P 00300403
*                     CONSOLE IS ISSUED.                       @Y02668P 00300703
*                                                                     * 00304303
*                     IF THE TARGET CONSOLE IS NOT ACTIVE,      Y02669* 00304703
*                     (UCMATR = X'10') 'IEE926I 'CC' NOT A     Y02669* 00310303
*                     CONSOLE' IS ISSUED.                       Y02669* 00310703
*                                                                     * 00311503
*                     IF THE COMMAND IS OTHER THAN CONTROL VARY Y02669* 00312003
*                     (K V) OR THE TARGET CONSOLE IS NOT        Y02669* 00312503
*                     MESSAGE STREAM (MS) - AN OUTPUT CONSOLE   Y02669* 00312903
*                     WHICH DISPLAYS ALL REGULAR MESSAGES SENT  Y02669* 00313303
*                     TO THE OPERATOR, OR STATUS DISPLAY (SD)   Y02669* 00313703
*                     - AN OUTPUT CONSOLE WHICH DISPLAYS ONLY   Y02669* 00314503
*                     THOSE COMMANDS WHICH POSSESS AN 'L=CCA'   Y02669* 00315003
*                     OPERAND (UCMDISP = X'06'),               Y02669* 00315503
*                     'IEE926I FULL CAPABILITY' IS ISSUED.      Y02669* 00316003
*                     (ONLY K V COMMANDS CAN BE ROUTED TO A     Y02669* 00316503
*                     FULL CAPABILITY CONSOLE)                  Y02669* 00317003
*                                                                     * 00317502
*                     IF 'A' WAS SPECIFIED AND THE TARGET IS    Y02669* 00318003
*                     EITHER A NON-CRT (UCMDISP = X'20') OR    Y02669* 00318503
*                     MESSAGE STREAM ONLY (UCMDISP = X'04'),    Y02669* 00319003
*                     THE AREA FIELD IN THE XAS IS SET TO 'Z'   Y02669* 00319503
*                     (X'E9') TO INDICATE AN IN-LINE DISPLAY    Y02669* 00320003
*                     AREA ( XASDID = X'E9' ).                  Y02669* 00320503
*                     HOWEVER, IF THE TARGET IS A CRT DEVICE    Y02669* 00321003
*                     AND NOT MS ONLY, THE COMMAND IS ROUTED.   Y02669* 00321503
*                     (MS AND NON-CRT HAVE NO AREAS DEFINED.)   Y02669* 00322003
*                                                                     * 00322502
*                     IF 'A' WAS SPECIFIED AND THE TARGET       Y02669* 00323003
*                     DEVICE IS CRT (UCMDISP = X'20'),          Y02669* 00323403
*                     WITH THE AREA DEFINED AS IN-LINE          Y02669* 00323803
*                     (XASDID = 'Z'), AND THE TARGET IS STATUS  Y02669* 00324203
*                     DISPLAY ONLY (UCMDISP = X'02'),           Y02669* 00325003
*                     'IEE926I 'A' NOT AN AREA' IS ISSUED.      Y02669* 00325503
*                     HOWEVER, IF THE TARGET IS NOT STATUS      Y02669* 00326003
*                     DISPLAY ONLY, THE COMMAND IS ROUTED.      Y02669* 00326503
*                     (SD HAVE ONLY AREAS DEFINED, NO IN-LINE.) Y02669* 00327003
*                                                                     * 00327503
*                     IF THE TARGET IS CRT, WITH 'A' DEFINED    Y02669* 00328003
*                     ON THE COMMAND BUT FOR AN AREA THAT IS    Y02669* 00328503
*                     NOT DEFINED TO THE DEVICE; I.E. NO SACB   Y02669* 00329003
*                     (SCREEN AREA CONTROL BLOCK) WAS BUILT AS  Y02669* 00329503
*                     THE RESULT OF A CONTROL (K) A COMMAND,    Y02669* 00330003
*                     'IEE926I 'A' NOT AN AREA' IS ISSUED, BUT  Y02669* 00330503
*                     IF AN SACB EXISTS, THE COMMAND IS ROUTED. Y02669* 00331003
*                     (THE AREA MUST BE DEFINED PRIOR TO THE    Y02669* 00331503
*                     COMMAND BEING ISSUED.)                    Y02669* 00332003
*                                                                     * 00332503
*                     IF THE TARGET IS NON-CRT, WITH THE AREA   Y02669* 00333003
*                     DEFINED ON THE COMMAND 'IEE926I 'A' NOT   Y02669* 00333503
*                     AN AREA' IS ISSUED.                       Y02669* 00334003
*                     HOWEVER, IF THE AREA IS IN-LINE           Y02669* 00334503
*                     (I.E. 'Z') THE COMMAND IS ROUTED.         Y02669* 00335003
*      K COMMANDS     ONLY ROUTABLE K COMMANDS,EXCEPT FOR K V, @ZM30446 00337503
*                     ARE VALID FROM A SUBSYSTEM ( DUMMY )     @ZM30446 00337603
*                     CONSOLE. CONTROL IS PASSED               @ZM30446 00337703
*                     TO IEE6703D FOR ADDITIONAL VALIDITY      @Y02668P 00363703
*                     CHECKING AND ROUTING                     @Y02668P 00364303
*                                                                     * 00364903
*      ALL DISPLAY    ADDITIONAL VALIDITY CHECKING IS PERFORMED Y02669* 00365403
*      COMMANDS       IN THIS MODULE FOR D M; U; C,K; AND       Y02669* 00366003
*      INCLUDING      CONSOLES (C):, D 3850                    @Z40LPTA 00366404
*      DISPLAY        IF THE AREA 'A' HAD ALREADY BEEN DEFINED  Y02669* 00366803
*      ACTIVE         AS IN-LINE (XASDID = 'Z'), CONTROL IS     Y02669* 00367203
*      COMMANDS       GIVEN TO IEE0803D TO BUILD A CSCB.        Y02669* 00368003
*                                                                     * 00368403
*                     IF THE AREA 'A' HAS BEEN DEFINED AS       Y02669* 00369003
*                     OUT-OF-LINE (A WAS SPECIFIED ON THE       Y02669* 00369103
*                     COMMAND OR DEFAULTED AND XASDID CONTAINS  Y02669* 00370003
*                     THAT VALUE) AND THE SACB INDICATES THAT A Y02669* 00370403
*                     A DYNAMIC DISPLAY, (I.E. TR), ALREADY     Y02669* 00370803
*                     EXISTS IN THAT AREA, 'IEE926I DYNAMIC     Y02669* 00371403
*                     DISPLAY IN AREA' IS ISSSUED.              Y02669* 00371903
*                     HOWEVER, IF THE AREA DOES NOT CONTAIN     Y02669* 00372403
*                     A DYNAMIC DISPLAY, CONTROL IS GIVEN TO    Y02669* 00373003
*                     IEE0803D. A DISPLAY MAY OVERLAY ANOTHER   Y02669* 00373403
*                     EXISTING STATUS DISPLAY BUT NOT A         Y02669* 00373803
*                     DYNAMIC DISPLAY.                          Y02669* 00374203
*                                                                     * 00374603
*                     IF THE AREA HAS NOT BEEN GIVEN A DEFAULT  Y02669* 00375403
*                     VALUE (XASDID = NULL) YET, ONE IS NOW     Y02669* 00375803
*                     OBTAINED FROM THE SACB'S AS FOLLOWS:      Y02669* 00376203
*                      1-THE BOTTOM-MOST EMPTY AREA             Y02669* 00376803
*                      2-IF NONE, THE AREA CONTAINING THE       Y02669* 00377503
*                        OLDEST STATIC DISPLAY                  Y02669* 00377903
*                      3-IF NO AREA IS AVAILABLE, THE DISPLAY   Y02669* 00378303
*                        IS PUT IN-LINE (XASDID = 'Z')          Y02669* 00378703
*                      4-IF THE CONSOLE HAS NO MESSAGE STREAM   Y02669* 00379503
*                        ALSO REFERRED TO AS IN-LINE,           Y02669* 00379903
*                        THE COMMAND IS CANCELLED. EITHER       Y02669* 00380303
*                        'IEE921I DISPLAY AREA BUSY OR          Y02669* 00380703
*                        NEEDS DISPLAY AREA' IS ISSUED.         Y02669* 00381303
*                     FOR ALL VALID CONDITIONS, CONTROL GOES    Y02669* 00381903
*                     TO IEE0803D TO BUILD A CSCB.              Y02669* 00382203
*                                                                     * 00382603
*      DISPLAY        FOR D JOBS (J); A; AND TS FURTHER         Y02669* 00383203
*      ACTIVE         VALIDITY CHECKING IS PERFORMED.           Y02669* 00383803
*      COMMANDS       THE OPERAND BUFFER IS SCANNED FOR         Y02669* 00384503
*                     ',LIST' (,L).                             Y02669* 00384803
*                     IF FOUND THE XAXMASK FIELD IS SHIFTED     Y02669* 00385403
*                     RIGHT ONE BIT TO TURN ON THE 'LIST'       Y02669* 00385803
*                     INDICATOR FOR THE APPROPIATE COMMAND.     Y02669* 00386203
*                     CONTROL IS THEN GIVEN TO IEE0803D.        Y02669* 00386603
*                                                                     * 00387503
*       STOPTR        ADDITIONAL VALIDITY CHECKING FOR STOPTR   Y02669* 00387903
*       COMMANDS      IS ALSO PERFORMED IN THIS MODULE.         Y02669* 00388303
*                                                               Y02669* 00388703
*                     STOPTR COMMANDS ARA INVALID ON A         @Y02668P 00389503
*                     SUBSYSTEM CONSOLE. THE UCMDISPK BIT      @Y02668P 00389803
*                     IS CHECKED IN THE CONSOLE UCME           @Y02668P 00390103
*                     IF THE TARGET IS NON-CRT, 'IEE921I        Y02669* 00390603
*                     NEEDS DISPLAY AREA' IS ISSUED.            Y02669* 00391303
*                                                                     * 00392003
*                     IF AREA 'A' IS DEFINED AS 'Z', 'IEE921I   Y02669* 00392303
*                     NEEDS DISPLAY AREA' IS ISSUED.  IT IS     Y02669* 00392703
*                     IMPOSSIBLE TO HAVE A DYNAMIC DISPLAY      Y02669* 00393303
*                     IN-LINE.                                  Y02669* 00393703
*                                                                     * 00394203
*                     IF THE AREA 'A' IS NULL, THE SACB'S ARE   Y02669* 00394703
*                     SEARCHED FOR AN AREA CONTAINING A TRACK   Y02669* 00395503
*                     DISPLAY. IF ONE IS FOUND THE XASDID FIELD Y02669* 00395903
*                     IS OVERLAID WITH THE AREA ID FROM THE     Y02669* 00396303
*                     SACB (DCMAID), AND THE ADDRESS OF THIS    Y02669* 00396703
*                     SACB IS PLACED IN XAXSACB AND CONTROL     Y02669* 00397103
*                     IS GIVEN TO IEE5503D. IF NO AREA IS       Y02669* 00397603
*                     FOUND IN THE SACB'S, 'IEE921I NO TRACK    Y02669* 00398103
*                     TO STOP' IS ISSUED.                       Y02669* 00398603
*                                                                     * 00399303
*                     IF 'A' WAS SPECIFIED ON THE COMMAND AND   Y02669* 00399703
*                     IT DOES NOT MATCH ANY AREA DEFINED BY AN  Y02669* 00400103
*                     SACB'S, 'IEE921I NO TRACK TO STOP' IS     Y02669* 00401003
*                     ISSUED.                                   Y02669* 00401303
*                                                                     * 00401703
*                     IF IT DOES MATCH, THE ADDRESS OF THE      Y02669* 00402203
*                     SACB IS PLACED IN XAXSACB AND CONTROL     Y02669* 00403003
*                     GIVEN TO IEE5503D.                        Y02669* 00403303
*                                                                     * 00404003
*       TRACK         TRACK COMMANDS REQUIRE SLIGHTLY           Y02669* 00404403
*       COMMANDS      DIFFERENT VALIDITY CHECKING.              Y02669* 00405003
*                                                                     * 00405303
*                     IF THE TARGET CONSOLE IS NON-CRT,         Y02669* 00405603
*                     'IEE921I NEEDS DISPLAY AREA' IS           Y02669* 00406203
*                     ISSUED. TRACK IS ONLY VALID TO CRT.       Y02669* 00407003
*                                                                     * 00407303
*                     IF AREA 'A' IS DEFINED AS IN-LINE 'Z',    Y02669* 00407803
*                     'IEE921I NEEDS DISPLAY AREA' IS ISSUED.   Y02669* 00408403
*                     ( TRACK COMMAND CAN NOT APPEAR IN-LINE.)  Y02669* 00409003
*                                                                     * 00409203
*                     IF THERE IS NO EMPTY AREA  ON THE SCREEN  Y02669* 00409603
*                     AND XASDID IS STILL NULL, A DEFAULT IS    Y02669* 00410103
*                     SUPPLIED (SAME AS FOR DISPLAY EXCEPT      Y02669* 00410803
*                     THAT IF NO DISPLAY AREA IS AVAILABLE      Y02669* 00411203
*                     A TRACK COMMAND WILL BE REJECTED AND      Y02669* 00412003
*                     EITHER 'IEE921I DISPLAY AREA BUSY'        Y02669* 00412303
*                     OR 'NEEDS DISPLAY AREA' IS ISSUED.        Y02669* 00412703
*                                                                     * 00413403
*                     IF THE RESULTING AREA OR IF THE AREA      Y02669* 00413703
*                     SPECIFIED ON THE COMMAND CONTAINS A       Y02669* 00414103
*                     DYNAMIC DISPLAY, 'IEE926I DISPLAY         Y02669* 00414803
*                     ALREADY EXISTS' IS ISSUED.                Y02669* 00415503
*                                                                     * 00415803
*                     IN ALL VALID CASES, THE SACB CHAIN IS     Y02669* 00416503
*                     SEARCHED FOR AN AREA CONTAINING A         Y02669* 00416703
*                     TRACK DISPLAY.                            Y02669* 00417203
*                                                                     * 00417603
*                     IF ONE IS NOT FOUND, THIS IS THE FIRST    Y02669* 00418303
*                     TR COMMAND FOR THIS CONSOLE AND CONTROL   Y02669* 00419003
*                     IS GIVEN TO IEE0803D TO CREATE A CSCB     Y02669* 00419303
*                     SO THAT IEEVWAIT CAN ATTACH THE DISPLAY/  Y02669* 00419803
*                     TRACK PROCESSOR FOR THIS CONSOLE.         Y02669* 00420403
*                                                                     * 00420703
*                     IF AN ENTRY IS FOUND, THIS TRACK COMMAND  Y02669* 00421103
*                     WAS ISSUED TO UPDATE THE TRACK ENTRY.     Y02669* 00421603
*                     HOWEVER,  IF THE DISPLAY IS CURRENTLY IN  Y02669* 00422203
*                     THE HOLD MODE (K D,H WAS ISSUED) AND THE  Y02669* 00423003
*                     OPTIONS ON THIS TRACK COMMAND ARE         Y02669* 00423403
*                     IDENTICAL TO THE ONES CURRENT BEING       Y02669* 00423803
*                     DISPLAYED, IT IS ASSUMED THAT THE         Y02669* 00424303
*                     OPERATOR IS ATTEMPTING TO BRING IT OUT    Y02669* 00424603
*                     OF ITS HOLD MODE AND 'IEE921I DISPLAY     Y02669* 00425503
*                     ALREADY EXISTS' IS ISSUED AND CONTROL     Y02669* 00425803
*                     IS RETURNED. ( THE OPERATOR SHOULD HAVE   Y02669* 00426203
*                     ISSED K D,U WHICH BRINGS IT OUT OF THE    Y02669* 00427003
*                     HOLD MODE.) IF THEY DIFFER THE OPTION     Y02669* 00427403
*                     FLAGS IN THE CORRESPONDING SACB ARE       Y02669* 00427803
*                     UPDATED AND CONTROL IS RETURNED.          Y02669* 00428503
*                                                                     * 00428903
*      JES2 SCREEN    FIRST THE CONSOLE ID(XASCID) IS           Y02669* 00429303
*      AREA VALIDITY  INTERROGATED TO INSURE THAT IT IS DEFINED Y02669* 00430003
*      CHECKING       TO THE SYSTEM, ACTIVE, AND CAPABLE OF     Y02669* 00430403
*                     RECEIVING STATUS DISPLAYS. IF NOT, RETURN Y02669* 00430803
*                     CODE =12. THEN THE AREA ID(XASDID) IS     Y02669* 00431203
*                     CHECKED. IF IT IS NOT DEFINED TO THE      Y02669* 00432003
*                     CONSOLE RC = 16. IF IT CONTAINS A DYNAMIC Y02669* 00432403
*                     TRACK DISPLAY RC = 8. IF IT CONTAINS      Y02669* 00432803
*                     A STATUS DISPLAY RC = 4. IF IT IS         Y02669* 00433203
*                     AVAILABLE OR IF THE CONSOLE WAS NON-CRT,  Y02669* 00434003
*                     RC = 0.                                   Y02669* 00434403
*                                                                     * 00434803
*      INVALID        IF ANY COMMAND OTHER THAN THE ONES        Y02669* 00435203
*      COMMANDS       SPECIFIED IN THE FUNCTION SECTION ARE     Y02669* 00436003
*                     ENCOUNTERED, 'IEE305I COMMAND INVALID'    Y02669* 00436403
*                     IS ISSUED.                                Y02669* 00436803
*                                                                     * 00437203
*      JES3 VALIDITY  1. A JES3 CONSOLE CANNOT ISSUE A TRACK   @Y02668P 00438003
*      CHECKING          STOPTRACK OR K COMMAND (EXCEPT K C,D) @Y02668P 00438403
*                        TO ITSELF OR OTHER SUBSYSTEM CONSOLES @Y02668P 00438803
*                     2. SYSTEM COMMANDS CANNOT BE ROUTED TO   @Y02668P 00439203
*                        A SUBSYSTEM CONSOLE BY USING L=CCA    @Y02668P 00439603
*                                                                     * 00440103
*                                                                     * 00440603
* NOTES                                                         Y02669* 00441103
*                                                                     * 00441603
*    CHARACTER-CODE                                             Y02669* 00442403
*    DEPENDENCIES  =  ANY CHARACTER CODE OTHER THEN EBCDIC      Y02669* 00442803
*                     WILL REQUIRE REASSEMBLY OF THIS MODULE,   Y02669* 00443303
*                     PROVIDED THAT DECIMAL DIGITS CONTINUE     Y02669* 00443703
*                     TO BE REPRESENTED IN THE FORM X'FZ',      Y02669* 00444103
*                     WHERE 'Z' IS ANY HEXADECIMAL DIGIT.       Y02669* 00445003
*                     OTHERWISE, THE CODE WHICH VERIFIES THAT   Y02669* 00445403
*                     THE CONSOLE ID ON THE ROUTING OPERAND (L) Y02669* 00445803
*                     IS NUMERIC WILL HAVE TO BE CHANGED, TOO.  Y02669* 00446203
*                                                                     * 00446603
*    DEPENDENCIES  =  MSGRT COMMAND WILL PROVIDE DEFAULT        Y02669* 00447403
*                     ROUTING FOR D JOBS (J); A; TS AND         Y02669* 00447803
*                     TR JOBS (J); TS AND A. TR=A WILL BE USED  Y02669* 00448203
*                     FOR DEFAULT ROUTING ALL TRACK AND STOPTR  Y02669* 00449003
*                     COMMANDS.                                 Y02669* 00449403
*                                                                     * 00449803
*                     SVC 100 WILL REJECT AS INVALID FROM ANY   Y02669* 00450203
*                     TIME SHARING TERMINAL D A AND THE TRACK   Y02669* 00450603
*                     COMMANDS.                                 Y02669* 00451403
*                                                                     * 00451803
*                     DIDOCS WILL NOT PROCESS K D,H AND K D,U   Y02669* 00452203
*                     THE SAME FOR TRACKING AS FOR MONITORING.  Y02669* 00453003
*                     IN ADDITION, 2 WORDS WILL BE ADDED TO THE Y02669* 00453403
*                     SACB TO CONTAIN THE INDICATORS OF THE     Y02669* 00453803
*                     DESIRED TRACK FUNCTIONS FOR THAT CONSOLE  Y02669* 00454203
*                     AND THE TRACK ECB.                        Y02669* 00454603
*                     ALSO A BIT INDICATOR IS BEING ADDED TO    Y02669* 00455303
*                     THE DCM (DCMADFLG) TO INDICATE TO SVC 34  Y02669* 00456003
*                     THAT THIS IS A DIDOCS ISSUED TRACK IN     Y02669* 00456503
*                     RESPONSE TO A K D,U COMMAND.              Y02669* 00457003
*                     (TO BRING A TRACK DISPLAY OUT OF ITS HOLD Y02669* 00457503
*                     MODE, THE OPERATOR ISSUES A K D,U COMMAND Y02669* 00458003
*                     CAUSING DIDOCS TO ISSUE AN INTERNAL       Y02669* 00458503
*                     TRACK COMMAND.)                           Y02669* 00459003
*                                                                     * 00459503
*                     THE UCM, DCM, AND ASSOCIATED CONTROL      Y02669* 00460003
*                     BLOCKS WILL BE ALTERED TO REFLECT THE     Y02669* 00460503
*                     REPLACEMENT OF THE TRACK COMMAND FOR THE  Y02669* 00461003
*                     MONITOR ACTIVE COMMAND.                   Y02669* 00461503
*                                                                     * 00462003
*                     THE READER/INTERPRETER WILL REJECT THE    Y02669* 00462503
*                     TRACK COMMAND FROM THE INPUT STREAM.      Y02669* 00463003
*                                                                     * 00463503
*                     SVC 100 WILL REJECT AS INVALID ANY        Y02669* 00464003
*                     COMMAND WHICH IS NOT VALID FROM A TSO     Y02669* 00464503
*                     TERMINAL.                                 Y02669* 00465003
*                                                                     * 00465503
*                     JES2 WILL USE ENTRY POINT IEE7603D AND    Y02669* 00466003
*                     WILL SUPPLY THE ADDRESS OF A 134 BYTE     Y02669* 00466503
*                     XSA IN REGISTER 2. THE XSA WILL CONTAIN   Y02669* 00467003
*                     BINARY ZEROES EXCEPT FOR:                 Y02669* 00467503
*                           XAN    - X'22' VERBCODE             Y02669* 00468003
*                           XASCID - 1 BYTE BINARY CONSOLE ID   Y02669* 00468503
*                           XASDID - 1 BYTE CHARACTER AREA ID   Y02669* 00469003
*                     JES2 WILL BE IN KEY 0 AND THE XSA IN      Y02669* 00469503
*                     PAGABLE STORAGE.                          Y02669* 00470003
*                                                                     * 00470503
*                     UPON RETURN, REGISTER 15 WILL CONTAIN A   Y02669* 00471003
*                     RETURN CODE                               Y02669* 00471503
*                       0 - AREA IS AVAILABLE; CONSOLE IS       Y02669* 00472003
*                           NON-CRT                             Y02669* 00472503
*                       4 - AREA ALREADY CONTAINS A DISPLAY     Y02669* 00473003
*                       8 - AREA PRESENTLY CONTAINS A TRACK     Y02669* 00473503
*                           DISPLAY                             Y02669* 00474003
*                      12 - INVALID CONSOLE ID                  Y02669* 00474503
*                             CONSOLE NOT DEFINED               Y02669* 00475003
*                             CONSOLE NOT ACTIVE                Y02669* 00475503
*                             CONSOLE INCAPABLE OF RECEIVING    Y02669* 00476003
*                             STATUS DISPLAYS                   Y02669* 00476503
*                      16 - INVALID AREA ID                     Y02669* 00477003
*                     A WTO SHOULD NEVER BE ISSUED TO THE       Y02669* 00477503
*                     REQUESTED CONSOLE AND AREA IF THE         Y02669* 00478003
*                     RETURN CODES ARE 8, 12, 16. THE           Y02669* 00478503
*                     SUBSYSTEM SHOULD DECIDE IF IT IS          Y02669* 00479003
*                     DESIGNED TO OVERLAY THE EXISTING          Y02669* 00479503
*                     DISPLAY IN THE CASE OF RETURN CODE OF 4.  Y02669* 00480003
*                                                                     * 00480503
*    RESTRICTIONS  =  TRACK COMMANDS ARE INVALID FROM ANY       Y02669* 00481003
*                     TIME SHARING TERMINAL.                    Y02669* 00481503
*                                                                     * 00482003
*                     THE L=CCA OPERAND IS NOT VALID ON ANY     Y02669* 00482503
*                     COMMAND ISSUED FROM A TIME SHARING        Y02669* 00483003
*                     TERMINAL.                                 Y02669* 00483503
*                                                                     * 00484003
*                     THE TRACK COMMAND IS ONLY VALID FOR A     Y02669* 00484503
*                     TARGET CRT DEVICE.                        Y02669* 00485003
*                                                                     * 00485503
*                     CONTROL AND TRACK COMMAND ARE NOT VALID   Y02669* 00486003
*                     FROM THE INPUT STREAM.                    Y02669* 00486503
*                                                                     * 00487003
*                     ONLY K V CAN BE ROUTED TO A FULL          Y02669* 00487503
*                     CAPABILITY CONSOLE.                       Y02669* 00488003
*                                                                     * 00488503
*                     ANY TR, OR PT COMMAND ISSUED              YM1557* 00489003
*                     INTERNALLY MUST SPECIFY THE 'L' OPERAND.  YM1557* 00489503
*                     ANY DISPLAY COMMAND ISSUED INTERNALLY     YM1557* 00490003
*                     WILL BE ROUTED TO THE MASTER CONSOLE.     YM1557* 00490503
*                     ANY CONTROL COMMAND ISSUED INTERNALLY     YM1557* 00491003
*                     WILL RESULT IN A RETURN TO THE SYSTEM     YM1557* 00491503
*                     WITH NO MESSAGE ISSUED.                   YM1557* 00492003
*                                                                     * 00492503
*    REGISTER/                                                  Y02669* 00493003
*    CONVENTIONS   =  REGISTERS 0 - 14 SAVED IN XASAVSTD AND    Y02669* 00493503
*                     RESTORED FOR ALL JES2 REQUESTS.           Y02669* 00494003
*                                                                     * 00494503
*    PATCH-LABEL   =  PATCH                                     Y02669* 00495003
*                                                                     * 00495503
* MODULE TYPE      =  CSECT                                     Y02669* 00496003
*                                                                     * 00496503
*    PROCESSOR     =  N/A                                       Y02669* 00497003
*                                                                     * 00497503
*    MODULE SIZE   =  X'989'                                  @ZA29986* 00497600
*                                                                     * 00498503
*    ATTRIBUTES    =  REENTRANT, REFRESHABLE, KEY 0,            Y02669* 00499003
*                     SUPERVISOR MODE, PAGED LPA                Y02669* 00499503
*                                                                     * 00500002
* ENTRY POINT      =  IEE7503D FROM IEE0403D                    Y02669* 01950002
*    PURPOSE       =  TO PROCESS THE K AND STOPTR OPERANDS      Y02669* 01960002
*    LINKAGE       =  BRANCH                                    Y02669* 01970002
*    INPUT DATA    =  REGISTER 2 - POINTER TO THE XSA           Y02669* 01980002
*                        XAL - POINTS TO 1ST OPERAND IN BUFFER  Y02669* 01980402
*                        XAN - CONTAINS VERB CODE X'C8' STOPTR  Y02669* 01980802
*                                                 X'90' CONTROL Y02669* 01980902
*                        XAA - CONTAINS X'00' -INVALID FROM TSO Y02669* 01981202
*                        XAV - CONTAINS COMMAND VERB            Y02669* 01985902
*                        XAR - POINTS TO COMMAND BUFFER LENGTH  Y02669* 01987002
*                        XAU - CONTAINS REQUESTING CONSOLE ID   Y02669* 01988102
*                              (00-INTERNAL OR INPUT STREAM-K)  Y02669* 01988502
*                              (00-INTERNAL - STOPTR)           Y02669* 01988902
*                        XAP - POINTS TO END OF BUFFER +1       Y02669* 01989002
*                              ( FOR IEEBUFSC )                 Y02669* 01989102
*                                                                     * 01989202
* ENTRY POINT      =  IEE7503D FROM IEE3503D                    Y02669* 01991402
*    PURPOSE       =  TO PROCESS THE D AND TR OPERANDS          Y02669* 01992502
*    LINKAGE       =  BRANCH                                    Y02669* 01993602
*    INPUT DATA    =  REGISTER 2 - POINTER TO THE XSA           Y02669* 01994702
*                        XAL - POINTS TO 1ST OPERAND IN BUFFER  Y02669* 01995802
*                        XAN - CONTAINS VERB CODE               Y02669* 01996902
*                                X'2C' - DISPLAY C,K            Y02669* 01997302
*                                X'32' - DISPLAY M              Y02669* 01997802
*                                X'3E' - DISPLAY CONSOLES (C)   YM1916* 01998102
*                                X'42' - DISPLAY R              Y02669* 01998402
*                                X'52' - DISPLAY U              Y02669* 01998702
*                                X'F3' - DISPLAY 3850         @Z40LPTA* 01998841
*                                X'88' - DISPLAY DMN          @Z40BPSV* 01998941
*                                X'A8' - DISPLAY SLIP         @G17SPTJ* 01999041
*                                X'B0' - DISPLAY DUMP (D)     @G33CPMR* 01999133
*                                X'68' - D TS; JOBS (J); A      Y02669* 01999341
*                                X'C4' - TRACK                  Y02669* 01999541
*                        XAA - CONTAINS ASID (X'00'FOR TRACK    Y02669* 01999602
*                              AND D A AND U)                   Y02669* 01999802
*                        XAV - CONTAINS COMMAND VERB            Y02669* 02000002
*                        XAR - POINTS TO COMMAND BUFFER LENGTH  Y02669* 02000202
*                        XAU - CONTAINS REQUESTING CONSOLE ID   Y02669* 02001302
*                              (00-INTERNAL OR INPUT STREAM-D)  Y02669* 02001702
*                              (00-INTERNAL - TRACK)            Y02669* 02002102
*                        XAXMASK - CONTAINS AN INDICATOR        Y02669* 02002402
*                                  SPECIFYING THE DESIRED       Y02669* 02003502
*                                  DISPLAY OR TRACK FUNCTION:   Y02669* 02004602
*                                    X'80' FOR JOBS  (J)        Y02669* 02005702
*                                    X'08' FOR TS               Y02669* 02006702
*                                    X'88' FOR A                Y02669* 02007702
*                                    X'00' FOR ALL OTHER FNS    Y02669* 02010102
*                        XAP - POINTS TO END OF BUFFER +1       Y02669* 02010502
*                              ( FOR IEEBUFSC )                 Y02669* 02010902
*                                                                     * 02011002
* ENTRY POINT      =  IEE7603D FROM JES2                        Y02669* 02012202
*    PURPOSE       =  TO VERIFY THE ROUTING OPERAND 'L=CCA'     Y02669* 02016902
*                     FOR ALL JES2 ORIENTED COMMANDS            Y02669* 02017902
*    LINKAGE       =  BRANCH                                    Y02669* 02018902
*    INPUT DATA    =  REGISTER 2 - POINTER TO XSA               Y02669* 02021102
*                        XAN - CONTAINS VERB CODE X'22'         Y02669* 02022102
*                        XASCID - DESIRED TARGET CONSOLE ID     Y02669* 02023302
*                        XASDID - DESIRED AREA ID ON TARGET     Y02669* 02024402
*                        REST OF XSA ZEROES                     Y02669* 02025502
*                                                                     * 02026902
* REGISTERS USAGE                                               Y02669* 02028802
*    SAVED         =  REGISTER 14 SAVED BEFORE ISSUING IEEBUFSC Y02669* 02029802
*                                 RESTORED AT NOL               Y02669* 02030802
*                                             OPFOUND           Y02669* 02031802
*                                             ERRONL            Y02669* 02032802
*                     REGISTERS 11 - 14 SAVED BEFORE ISSUING    Y02651* 02034802
*                               SETLOCK AT LOCKSET AND LOCKSOFF Y02651* 02035802
*                  =  REGISTERS 0 - 14 SAVED IN XASAVSTD AT     Y02669* 02036802
*                               ENTRY POINT IEE7603D.           Y02669* 02037802
*                                                                     * 02038802
*    CONTAINED     =  R0  -  USED IN ODD EVEN PAIR              Y02669* 02040802
*                     R1  -  PARM REG FOR INTERNAL SUBROUTINES  Y02669* 02041802
*                     R2  -  INPUT - BASE REG FOR XSA           Y02669* 02042802
*                     R3  -  BASE REG FOR UCM                   Y02669* 02043802
*                     R4  -  USED IN ODD EVEN PAIR              Y02669* 02044802
*                     R5  -  USED IN ODD EVEN PAIR              Y02669* 02045802
*                     R6  -  TARGET AREA ID                     Y02669* 02046802
*                     R7  -  TARGET CONSOLE ID                  Y02669* 02048802
*                     R8  -  WORK REG - OPERAND POINTER         Y02669* 02049802
*                     R9  -  WORK REG - USED FOR RCT SCAN       Y02669* 02050802
*                     R10 -  BASE REG FOR RESIDENT DCM          Y02669* 02051802
*                     R11 -  BASE REG FOR RCT & SACB            Y02669* 02052802
*                     R12 -  BASE REG FOR UCME                  Y02669* 02053802
*                     R13 -  MODULE BASE REG                    Y02669* 02054802
*                     R14 -  RETURN ADDRESS                     Y02669* 02055802
*                     R15 -  USED FOR BAL,RETURN CODE                   02058802
*                                                                     * 02059402
*    RESTORED      =  REGISTERS 11 - 14 RESTORED AFTER ISSUING  Y02651* 02079702
*                               SETLOCK AT LOCKSET AND LOCKSOFF Y02651* 02084702
*                  =  REGISTER  0 - 14 RESTORED AT JES2EXIT     Y02669* 02085702
*                               BEFORE RETURNING TO JES2        Y02669* 02086702
*                                                                     * 02089702
*  *  *  *  *  *  *  *  *  *  *  *  *  *  *  *  *  *  *  *  *  *  *  *  02099702
* NOTE: FOR ALL EXITS, IF THE 'L' OPERAND WAS SPECIFIED ON THE  Y02669* 02099802
*       COMMAND, IT WILL BE REMOVED FROM THE COMMAND BUFFER     Y02669* 02100002
*       BEFORE EXITING.                                         Y02669* 02160002
*       THE EXCEPTION, FOR N,PFK THE L= OPERAND IS PASSED TO  @ZA12152* 02180033
*       DIDOCS FOR PROCESSING.                                @ZA12152* 02190033
*                                                                     * 02220002
* EXIT - NORMAL    =  BRANCH TO IEE0803D FROM D0803D            Y02669* 02292402
*    CONDITIONS    =  TO BUILD CSCB'S FOR D COMMANDS            Y02669* 02292802
*    OUTPUT DATA   =  R2 POINTS TO XSA WHICH CONTAINS           Y02669* 02293202
*                        SAME AS INPUT PLUS                     Y02669* 02294002
*                        XASCID = 'CC' VALUE OR XAU             Y02669* 02296002
*                        XASDID = 'A' VALUE OR 'Z'              Y02669* 02296802
*                        XASSDS = XASSDS2 (X'40') IF 'L'        Y02669* 02297602
*                                 OPERAND SPECIFIED ON COMMAND  Y02669* 02298402
*                        XAN - CONTAINS VERB CODE               Y02669* 02299602
*                                 X'2C' - DISPLAY C,K           Y02669* 02299702
*                                 X'32' - DISPLAY M             Y02669* 02299902
*                                 X'3E' - DISPLAY CONSOLES (C)  YM1916* 02300802
*                                 X'52' - DISPLAY U             Y02669* 02301702
*                                 X'68' - D JOBS (J); TS; A     Y02669* 02302602
*                                 X'88' - DISPLAY DMN         @Z40BPSV* 02302941
*                                 X'A8' - DISPLAY SLIP        @G17SPTJ* 02303241
*                                 X'B0' - DISPLAY DUMP (D)    @G33CPMR* 02303333
*                     IF 'LIST' ('L') WAS SPECIFIED:            Y02669* 02303502
*                        XAXMASK  X'40' JOBS,LIST   (J,L)       Y02669* 02304402
*                                 X'04' TS,LIST     (TS,L)      Y02669* 02305302
*                                 X'44' A,LIST      (A,L)       Y02669* 02306202
*    RETURN CODES  =  NONE                                      Y02669* 02307602
* 2  CONDITIONS    =  TO BUILD CSCB'S FOR TR INITIAL COMMANDS   Y02669* 02309802
*    OUTPUT DATA   =  R2 POINTS TO XSA WHICH CONTAINS           Y02669* 02312002
*                        SAME AS INPUT PLUS                     Y02669* 02314202
*                        XASCID = 'CC' VALUE OR XAU             Y02669* 02316402
*                        XASDID = 'A' VALUE OR DEFAULT          Y02669* 02318602
*                        XASSDS = XASSDS2 (X'40') IF 'L'        Y02669* 02320802
*                                 OPERAND SPECIFIED ON COMMAND  Y02669* 02323002
*                        XAXSACB - CONTAINS ADDRESS OF DCMATECB Y02669* 02325002
*                        DCMAUTME - WILL BE SET TO THE DEFAULT  Y02669* 02336202
*                                   TIME INTERVAL - 30 SECONDS  Y02669* 02338202
*                     IF 'LIST' ('L') WAS SPECIFIED:            Y02669* 02342602
*                        DCMTMASK X'40' JOBS,LIST   (J,L)       Y02669* 02343602
*                                 X'04' TS,LIST     (TS,L)      Y02669* 02344602
*                                 X'44' A,LIST      (A,L)       Y02669* 02345602
*                                                                     * 02349102
*  *  *  *  *  *  *  *  *  *  *  *  *  *  *  *  *  *  *  *  *  *  *  *  02351102
*                                                                     * 02351502
* EXIT - NORMAL    =  RETURN VIA BR R14 FROM RETURN             Y02669* 02352002
*    CONDITIONS    =  ADDITIONAL TRACK COMMAND ISSUED FOR       Y02669* 02352402
*                     ALREADY EXISTING TRACK TASK               Y02669* 02352602
*    OUTPUT DATA   =  SACB FIELDS UPDATE                        Y02669* 02353202
*    RETURN CODES  =  NONE                                      Y02669* 02353402
*                                                                     * 02353602
*  *  *  *  *  *  *  *  *  *  *  *  *  *  *  *  *  *  *  *  *  *  *  *  02353802
*                                                                     * 02355202
* EXIT - NORMAL    =  BRANCH TO IEE5503D FROM D5503D            Y02669* 02357602
*    CONDITIONS    =  TO PROCESS THE PT COMMAND                 Y02669* 02360002
*    OUTPUT DATA   =  R2 POINTS TO XSA WHICH CONTAINS           Y02669* 02362402
*                      SAME AS INPUT PLUS                       Y02669* 02364802
*                      XAXSACB CONTAINS ADDRESS OF SACB         Y02669* 02367202
*                      XAS CONTAINS TARGET CONSOLE & AREA ID    Y02669* 02369602
*                        XASCID = 'CC' VALUE OR XAU             Y02669* 02372002
*                        XASDID = 'A' VALUE OR DEFAULT          Y02669* 02374402
*                        XASSDS = XASSDS2 (X'40') IF 'L'        Y02669* 02376802
*                                 OPERAND SPECIFIED ON COMMAND  Y02669* 02379202
*    RETURN CODES  =  NONE                                      Y02669* 02381602
*                                                                     * 02384002
*  *  *  *  *  *  *  *  *  *  *  *  *  *  *  *  *  *  *  *  *  *  *  *  02386402
*                                                                     * 02388802
* EXIT - NORMAL    =  BRANCH TO IEE6703D FROM D6703D            Y02669* 02391202
*    CONDITIONS    =  FOR ALL K COMMANDS                        Y02669* 02393602
*    OUTPUT DATA   =  REG 2 POINTS TO XSA WHICH CONTAINS        Y02669* 02396002
*                      SAME AS INPUT PLUS                       Y02669* 02398402
*                      XAS CONTAINS TARGET CONSOLE & AREA ID    Y02669* 02400802
*                        XASCID = 'CC' VALUE OR XAU             Y02669* 02403202
*                        XASDID = 'A' VALUE OR 'Z'              Y02669* 02405602
*                        XASSDS = XASSDS2 (X'40') IF 'L'        Y02669* 02408002
*                                 OPERAND SPECIFIED ON COMMAND  Y02669* 02410402
*                        XASSDS = XASSDS3 IF A TASK OTHER     @Y02668P* 02411003
*                                 THAN COMTASK ISSUED THE     @Y02668P* 02411603
*                                 COMMAND (JES3)              @Y02668P* 02412203
*    RETURN CODES  =  NONE                                      Y02669* 02412802
*                                                                     * 02422802
*  *  *  *  *  *  *  *  *  *  *  *  *  *  *  *  *  *  *  *  *  *  *  *  02424802
*                                                                     * 02446802
* EXIT - NORMAL    =  BRANCH TO IEE2903D FROM D2903D            Y02669* 02447502
*    CONDITIONS    =  FOR DISPLAY REQUESTS                      Y02669* 02449602
*    OUTPUT DATA   =  REG 2 POINTS TO XSA WHICH CONTAINS        Y02669* 02451702
*                      SAME AS INPUT PLUS                       Y02669* 02453802
*                      XAS CONTAINS TARGET CONSOLE & AREA ID    Y02669* 02455902
*                        XASCID = 'CC' VALUE OR XAU             Y02669* 02458002
*                        XASDID = 'A' VALUE OR 'Z'              Y02669* 02460102
*                        XASSDS = XASSDS2 (X'40') IF 'L'        Y02669* 02462202
*                                 OPERAND SPECIFIED ON COMMAND  Y02669* 02464302
*    RETURN CODES  =  NONE                                      Y02669* 02466402
*                                                                     * 02468502
*  *  *  *  *  *  *  *  *  *  *  *  *  *  *  *  *  *  *  *  *  *  *  *  02469502
*                                                                     * 02470602
** EXIT - NORMAL   =  RETURN VIA BR R14 TO JES2 FROM JES2EXIT   Y02669* 02476902
*     CONDITIONS   =  DESIRED ROUTING REQUEST VALIDITY CHECKED  Y02669* 02477602
*     OUTPUT DATA  =  REGISTER 2 STILL POINTS TO XSA            Y02669* 02478302
*     RETURN CODES =  REGISTER 15 CONTAINS                      Y02669* 02479002
*                        0 IF CONSOLE AND AREA IDS WERE VALID   Y02669* 02479702
*                        4 IF THE AREA PRESENTLY CONTAINS       Y02669* 02480402
*                          ANOTHER DISPLAY                      Y02669* 02481102
*                        8 IF THE AREA PRESENTLY CONTAINS A     Y02669* 02481802
*                          TRACK DISPLAY                        Y02669* 02483202
*                       12 IF THE CONSOLE ID IS INVALID         Y02669* 02483402
*                                 CONSOLE ID TOO HIGH           Y02669* 02483602
*                                 CONSOLE NOT ACTIVE            Y02669* 02483802
*                                 CONSOLE FULL CAPABILITY       Y02669* 02484002
*                       16 IF THE AREA ID IS INVALID            Y02669* 02484202
*                                                                     * 02484702
*  *  *  *  *  *  *  *  *  *  *  *  *  *  *  *  *  *  *  *  *  *  *  *  02485302
*                                                                     * 02490302
* EXIT - NORMAL     =  BRANCH TO IEE9403D FROM D9403D          @Z40LPTA 02490704
*    CONDITIONS     =  FOR DISPLAY 3850 REQUEST                @Z40LPTA 02491104
*    OUTPUT DATA    =  R2 PTR TO XSA WHICH CONTAINS            @Z40LPTA 02491504
*                         SAME AS INPUT PLUS                   @Z40LPTA 02491904
*                         XASCID = 'CC' VALUE OR XAU           @Z40LPTA 02492304
*                         XASDID = 'A' VALUE OR 'Z'            @Z40LPTA 02492704
*                         XAN    = (X'68') DISPLAY VERB CODE   @Z40LPTA 02493104
*    RETURN CODES    =  NONE.                                  @Z40LPTA 02493504
*  *  *  *  *  *  *  *  *  *  *  *  *  *  *  *  *  *  *  *  *  *  *  *  02493904
*                                                                     * 02494304
** EXIT - ERROR  = BRANCH TO IEE0503D FROM D0503D               Y02669* 02495302
*   CONDITIONS   = TO ISSUE MESSAGE 'IEE305I COMMAND INVALID',  Y02669* 02500302
*                  IF AN INVALID COMMAND IS ENCOUNTERED, OR     Y02669* 02505302
*                  IF TSO ISSUES ANY COMMAND OTHER THAN DISPLAY Y02669* 02510302
*                   OR INCLUDES THE 'L' OPERAND ON ANY COMMAND  Y02669* 02515302
*                  IF THE STOP TRACK COMMAND DOES NOT          @YM2774P 02520302
*                   HAVE ANY OPERANDS THEN ISSUE MESSAGE       @YM2774P 02540302
*                   'IEE311I PARAMETER MISSING'                @YM2774P 02560302
*                   TRACK, STOP TRACK, AND K COMMAND           @Y02668P 02565303
*                   (EXCEPT K C, D) ARE INVALID                @Y02668P 02570303
*                   FROM A SUBSYSTEM CONSOLE.                  @Y02668P 02575303
*   OUTPUT DATA  = ERROR CODES FOR MESSAGE ISSUED IN IEE0503D   Y02669* 02585302
*                  IN XSA POINTED TO BY REG 2                   Y02669* 02635302
*                  XAE WILL CONTAIN  X'05' FOR IEE305I          Y02669* 02685302
*                                    X'0B' FOR IEE311I          YM1917* 02735302
*                                    X'15' FPR IEE777I         @Y02668P 02755303
*                  XAV STILL CONTAINS COMMAND VERB FOR MESSAGE  Y02669* 02785302
*   RETURN CODES = NONE                                         Y02669* 02835302
*                                                                     * 02885302
*  *  *  *  *  *  *  *  *  *  *  *  *  *  *  *  *  *  *  *  *  *  *  *  02935302
*                                                                     * 02985302
* EXIT - ERROR     =  BRANCH TO IEE5603D FROM D5603D            Y02669* 03100002
*    CONDITIONS    =  ANY ERROR CONDITIONS REQUIRING A MESSAGE  Y02669* 03160002
*    OUTPUT DATA   =  REG 2 POINTS TO XSA CONTAINING ERROR      Y02669* 03162002
*                     CODES FOR IEE5603D AND IEE5903D.          Y02669* 03164002
*                     XAE WILL CONTAIN AN INDEX FOR THE         Y02669* 03166002
*                     MAJOR MESSAGE FOR IEE5603D:               Y02669* 03168002
*                        X'04' - IEE156I INVALID OPERAND        Y02669* 03169202
*                        X'08' - IEE345I CM AUTHORITY INVALID   Y02669* 03169602
*                        X'09' - IEE921I CM OP REJECTED         Y02669* 03169702
*                        X'0B' - IEE925I 'CMD' OPERAND          Y02669* 03169802
*                        X'0C' - IEE926I L=CCA OPERAND INVALID  Y02669* 03169902
*                        X'0D' - IEE927I REQUEST AMBIGIOUS      YM1557* 03171902
*                     XASTSAVE WILL CONTAIN AN INDEX FOR THE    Y02669* 03176002
*                     MINOR MESSAGE FOR IEE5903D:               Y02669* 03176402
*                      IEE921I CM OP REJECTED:                  Y02669* 03178402
*                        X'0C' - DISPLAY ALREADY EXISTS         Y02669* 03186402
*                        X'0D' - DISPLAY AREA BUSY              Y02669* 03196402
*                        X'0E' - NO TRACK TO STOP               Y02669* 03200402
*                        X'19' - NEEDS DISPLAY AREA             Y02669* 03202402
*                        X'1F' - SUBSYSTEM CONSOLE             @Y02668P 03202503
*                      IEE925I 'XAE' OPERAND:                   Y02669* 03207303
*                        X'1A' - FOR CRT ONLY                   Y02669* 03207703
*                      IEE926I L=CCA OPERAND INVALID:           Y02669* 03211303
*                        X'12' - NOT AN AREA                    Y02669* 03213303
*                        X'13' - NOT A CONSOLE                  Y02669* 03215303
*                        X'14' - FULL CAPABILITY                Y02669* 03217303
*                        X'15' - DYNAMIC DISPLAY IN AREA        Y02669* 03219303
*                        X'1F' - SUBSYSTEM CONSOLE             @Y02668P 03221303
*                      IEE927I REQUEST AMBIGIOUS                YM1557* 03223303
*                        X'17' - SPECIFY L OPERAND              YM1557* 03225303
*                     XAV STILL CONTAINS COMMAND VERB FOR THE   Y02669* 03227303
*                     MESSAGE                                   Y02669* 03229303
*                     XAU CONTAINS CONSOLE ID FOR MESSAGE       Y02669* 03231303
*                     ROUTING (MAY BE X'00' IF INTERNAL)        YM1557* 03233303
*    RETURN CODES  =  NONE                                      Y02669* 03241402
*                                                                     * 03300002
*  *  *  *  *  *  *  *  *  *  *  *  *  *  *  *  *  *  *  *  *  *  *  *  03380202
*                                                                     * 03390102
* EXTERNAL                                                      Y02669* 03400002
*   REFERENCES                                                  Y02669* 03450002
*                                                                     * 03550002
*    ROUTINES      =  BRANCHES TO  IEE6703D   IEE0803D          Y02669* 04399102
*                                  IEE5503D   IEE5603D/IEE5903D Y02669* 04399502
*                                  IEE0503D   IEE2903D          Y02669* 04399902
*                                  IEE9403D                    @Z40LPTA 04400704
*                                                                     * 04401602
*   DATA AREAS   = PSEUDO-SACB TO BE USED THROUGHOUT SVC 34     Y02669* 04403202
*                    ORG   XAX                                  Y02669* 04403302
*                  XAXMASK  DS    C       REQUEST FLAGS         Y02669* 04403402
*                  XAXJOBS  EQU   X'80'   JOBS        (J)       Y02669* 04404502
*                  XAXJOBSL EQU   X'40'   JOBS,LIST   (J,L)     Y02669* 04405502
*                  XAXTS    EQU   X'08'   TS                    Y02669* 04407702
*                  XAXTSL   EQU   X'04'   TS,LIST     (TS,L)    Y02669* 04408102
*                  XAXA     EQU   X'88'   A                     Y02669* 04409102
*                  XAXAL    EQU   X'44'   A,LIST      (A,L)     Y02669* 04410102
*                  XAXFREE  DS    C       RESERVED              Y02669* 04412002
*                  XAXUTME  DS    H       TIME INTERVAL VALUE   Y02669* 04412802
*                  XAXSACB  DS    F       ADDRESS OF SACB       Y02669* 04413602
*                                                                     * 04414402
*   DATA AREAS  =  SACB (SCREEN AREA CONTORL BLOCK)             Y02669* 04415202
*                  DCMADFLG  DS   C       STATUS INDICATORS     Y02669* 04415602
*                  DCMADD    EQU  X'80'   TRACK ACTIVE IN AREA  Y02669* 04415702
*                  DCMAHOLD  EQU  X'40'   TRACK DISPLAY HELD    Y02669* 04415802
*                  DCMATRCK  DS   C       REQUEST INDICATORS    Y02669* 04416002
*                  DCMATJOB  EQU  X'80'   JOBS        (J)       Y02669* 04416802
*                  DCMATJBL  EQU  X'40'   JOBS,LIST   (J,L)     Y02669* 04417802
*                  DCMATTS   EQU  X'08'   TS                    Y02669* 04420002
*                  DCMATTSL  EQU  X'04'   TS,LIST     (TS,L)    Y02669* 04420802
*                  DCMATA    EQU  X'88'   A                     Y02669* 04421602
*                  DCMATAL   EQU  X'44'   A,LIST      (A,L)     Y02669* 04422402
*                  DCMTUTME  DS   H       TIME INTERVAL VALUE   Y02669* 04422802
*                  DCMATECB  DS   F       TRACK ECB             Y02669* 04423402
*                                                                     * 04427202
*    CONTROL BLOCKS=  CVT           R - ADDRESS UCM & BASEA     Y02669* 04428002
*                     IEEXSA        R - INPUT INFORMATION       Y02669* 04429602
*                                   W - OUTPUT INFORMATION      Y02669* 04430402
*                     IEECUCM       R - ADDRESS DCM, RCT        Y02669* 04431202
*                                       DEVICE STATUS           Y02669* 04432002
*                     IEECVMAP (RCT) R - ROUTING DEFAULTS       Y02669* 04432402
*                     IEERDCM       R - ADDRESS SACB            Y02669* 04432802
*                     SACB          R - PRESENT TRACK STATUS    Y02669* 04434402
*                                   W - UPDATE OR INIT STATUS   Y02669* 04435202
*                                       FOR TRACK ONLY          Y02669* 04436002
*                     IHAPSA          - NECESSARY FOR SETLOCK   Y02651* 04436802
*                                                                     * 04437602
*    TABLES        =  NONE                                      Y02669* 04438402
*                                                                     * 04439202
*    MACROS        =  MODID                                     Y02669* 04440002
*                     IEEBUFSC                                  Y02669* 04440802
*                                                                     * 04441602
*    ENQUEUE                                                    Y02669* 04442402
*     RESOURCES    =  NONE                                      Y02669* 04443202
*                                                                     * 04444002
*    LOCKS HELD    =  LOCKS ARE OBTAINED AT LOCKSET AND         Y02651* 04444802
*                     RELEASED:                                 Y02651* 04445402
*                      1) AT RETURN BEFORE RETURNING            Y02651* 04446002
*                      2) AT D0503D BEFORE EXITING TO IEE0503D  Y02651* 04446602
*                      3) AT D0803D BEFORE EXITING TO IEE0803D  Y02651* 04447202
*                      4) AT JES2EXIT BEFORE RETURNING TO JES2  Y02669* 04447502
*                      5) FOR STOPTR IN IEE5503D OR IEE6703D    Y02651* 04447802
*                      6) FOR K IN IEE6703D, IEE7703D, IEE7803D Y02651* 04448402
*                        IEE6803D, IEE6903D, IEE5603D, IEE5903D Y02651* 04449002
*                                                                     * 04449602
*    CHANGE LEVEL  =  Y02669                                    Y02669* 04450402
*                     Y02651                                    Y02651* 04450602
*                     YM1557                                    YM1557* 04450802
*                     YM1916                                    YM1916* 04450902
*                     YM1917                                    YM1917* 04451002
*                     YM1920                                    YM1920* 04451102
*                     Y02668                                   @Y02668P 04455103
*                     ZM30445                                  @ZM30445 04457103
*                     ZM30446                                  @ZM30446 04458103
*                     ZA02576                                  @ZA02576 04459003
*                     ZA03611                                  @ZA03611 04459504
*                     Z40LPTA                                  @Z40LPTA 04459604
*                     Z40BPSV                                 @Z40BPSV* 04459741
*                     G17SPTJ                                 @G17SPTJ* 04459841
*                     ZA10516                                 @ZA10516* 04460441
*                     ZA12152                                 @ZA12152* 04460633
*                     G33CPMR                                 @G33CPMR* 04460933
*                     ZA16595                                 @ZA16595* 04461233
*                     ZA29986                                 @ZA29986* 04461300
*                                                                     * 04461541
* MESSAGES         =  THE FOLLOWING MESSAGE IS CONTAINED IN     Y02669* 04462002
*                     AND ISSUED FROM IEE0503D:                 Y02669* 04464002
*                                                                     * 04468002
*                      MSGID  CODE     MESSAGE TEXT             Y02669* 04474002
*                      _____  ____     ____________             Y02669* 04476002
*                     IEE305I X'05'    COMMAND INVALID          Y02669* 04478002
*                     IEE311I X'0B'    PARAMETER MISSING        YM1917* 04482002
*                                                                     * 04486602
*                     THE FOLLOWING MESSAGES ARE CONTAINED IN   Y02669* 04489602
*                     AND ISSUED FROM IEE5603D AND IEE5903D:    Y02669* 04492602
*                                                                     * 04495602
*                      MSGID  CODE  IN MESSAGE TEXT             Y02669* 04498602
*                      _____  ____  __  ____________            Y02669* 04504602
*                     IEE156I X'04' 56 INVALID OPERAND          Y02669* 04507602
*                     IEE345I X'08' 56 AUTHORITY INVALID        Y02669* 04510602
*                     IEE921I X'09' 56 REJECTED                 Y02669* 04513602
*                             X'0C' 59 DISPLAY ALREADY EXISTS   Y02669* 04516602
*                             X'0D' 59 DISPLAY AREA BUSY        Y02669* 04522602
*                             X'0E' 59 NO TRACK TO STOP         Y02669* 04525602
*                             X'19' 59 NEEDS DISPLAY AREA       Y02669* 04528602
*                             X'1F' - SUBSYSTEM CONSOLE        @Y02668P 04530603
*                     IEE925I X'0B' 56 OPERAND                  Y02669* 04532602
*                             X'1A' 59 FOR CRT ONLY             Y02669* 04536602
*                     IEE926I X'0C' 56 L OPERAND INVALID        Y02669* 04539602
*                             X'12' 59 NOT AN AREA              Y02669* 04542602
*                             X'13' 59 NOT A CONSOLE            Y02669* 04545602
*                             X'14' 59 FULL CAPABILITY          Y02669* 04548602
*                             X'15' 59 DYNAMIC DISPLAY IN AREA  Y02669* 04551602
*                             X'1F' 59 SUBSYSTEM CONSOLE       @Y02668P 04552603
*                                                                     * 04554602
* SYSGEN           =  INCLUDED WITH SVC 34 IN LOAD MODULE       Y02669* 04557602
*                     IGC0003D, DLIB AOSB3, MACRO SGIEF441,     Y02669* 04560602
*                     TARGLIB LPALIB                            Y02669* 04563602
*                                                                     * 04566602
* SYSTEM LIBRARIES =  NONE                                      Y02669* 04569602
*                                                                     * 04572602
*********************************************************************** 04575602
         EJECT                                                          04578602
IEE7503D CSECT                                                   Y02669 04581602
         ENTRY IEE7603D            ENTRY POINT FOR JES2 ONLY     Y02669 04583602
IEE7603D EQU   *                                                 Y02669 04585602
* A-190710,190726,190741 C- 190740,190744                      @ZM30445 04586203
* C- 461000 D - 539043-539122                                  @ZM30446 04586903
* A-208600                                                     @ZA02576 04587203
* THIS APAR WRITTEN TO SUPPORT MSS 'D 3850' S/C Z40LPTA        @ZA07152 04589041
* A - CODE ADDED TO SUPPORT 'DISPLAY DUMP'                     @G33CPMR 04589433
* A (COMTASK ) APPROX. 111724                                  @ZA12152 04589533
* A (KNOL    ) APPROX. 187600                                  @ZA12152 04589633
* A (NCCHAR  ) APPROX. 602920                                  @ZA12152 04589733
* C (ERRONL  ) ADD LABEL LFIRST                                @ZA16595 04590033
* C (NEXTAREA) TEST FOR POSSIBLE GENED AREAS NOT IN USE        @ZA29986 04590100
*                                                                       04590333
* ********************************************************************* 04590433
*                                                                     * 04590602
*                                REGISTER USAGE                       * 04600002
*                                                                     * 04998802
*********************************************************************** 05048802
REG0     EQU   0                   USED WITH REG1 AS EVEN/ODD PAIR      05148202
REG1     EQU   1                   PARM REG FOR INTERNAL SUBROUTINES    05200002
*                                  USED WITH REG0 AS EVEN/ODD PAIR      05400002
XSABASE  EQU   2                   INPUT-BASE REGISTER FOR XSA          05500002
UCMBASE  EQU   3                   BASE REGISTER FOR UCM                05600002
WORK4    EQU   4                   WORK REG, PART OF EVEN/ODD PAIR      06000002
WORK5    EQU   5                   WORK REG, PART OF EVEN/ODD PAIR      06100002
AREA     EQU   6                   TARGET AREA ID                       06500002
CONSID   EQU   7                   TARGET CONSOLE ID                    06600002
OPPTR    EQU   8                   POINTS WITHIN COMMAND OPERAND FIELD  06700002
RCTSCAN  EQU   9                   WORK REG FOR RCT SCAN                06900001
RDCMBASE EQU   10                  BASE REGISTER FOR RESIDENT DCM       07000002
RCTBASE  EQU   11                  BASE ROUTING CONTROL TABLE           07100002
SACBBASE EQU   11                  BASE SCREEN AREA CONTROL BLOCK       07300002
UCMEBASE EQU   12                  BASE REG - UCME (SOURCE THEN TARGET) 07500002
MYBASE   EQU   13                  BASE REGISTER FOR THIS ROUTINE       07700002
RETURN14 EQU   14                  RETURN REGISTER               Y02669 07800002
R15      EQU   15                                                       08050002
         EJECT                                                          08060002
*********************************************************************** 08070002
*                                                                     * 08080002
*                           CONSTANTS                                 * 08090002
*                                                                     * 08092002
*********************************************************************** 08094002
E0       EQU   0                   CONSTANT                             08098002
E1       EQU   1                   CONSTANT                             08098402
E2       EQU   2                   CONSTANT                             08098802
E3       EQU   3                   CONSTANT                             08099202
E4       EQU   4                   CONSTANT                             08099602
E5       EQU   5                   CONSTANT                      Y02669 08100602
E6       EQU   6                   CONSTANT                      Y02669 08101902
E7       EQU   7                   CONSTANT - MASK FOR ICM INSTRUCTION  08107102
E8       EQU   8                   CONSTANT - MASK FOR ICM INSTRUCTION  08109402
*********************************************************************** 08111702
*                                                                     * 08114002
*                         CHARACTER EQUATES                           * 08116302
*                                                                     * 08118602
*********************************************************************** 08120902
BLANK    EQU   C' '                BLANK                                08123202
COMMA    EQU   C','                COMMA                                08125502
ACHAR    EQU   C'A'                CHARACTER A FOR COMPARE       Y02669 08127502
CCHAR    EQU   C'C'                CHARACTER C FOR COMPARE       Y02669 08127802
DCHAR    EQU   C'D'                CHARACTER D FOR COMPARE              08129802
KCHAR    EQU   C'K'                CHARACTER K FOR COMPARE              08130102
OCHAR    EQU   C'O'                CHARACTER O FOR COMPARE              08132402
PCHAR    EQU   C'P'                CHARACTER P FOR COMPARE     @G33CPMR 08133433
VCHAR    EQU   C'V'                CHARACTER V                   Y02669 08134702
TCHAR    EQU   C'T'                CHARACTER T                   Y02669 08136702
Z        EQU   C'Z'                ID OF MESSAGE STREAM AREA (INLINE)   08137002
*********************************************************************** 08171202
*                     BRANCH CONDITION CODES                          * 08173302
*********************************************************************** 08188902
NOMORE   EQU   8                   BRANCH ON ZERO                       08193602
EQ       EQU   8                   BRANCH ON EQUAL                      08198302
NONEON   EQU   8                   BRANCH ON ZERO                       08203002
*********************************************************************** 08212402
*                                                                     * 08217102
*                         VERB CODES                                  * 08221802
*                                                                     * 08226502
*********************************************************************** 08231202
K        EQU   X'90'               VERB CODE FOR K (CONTROL)            08235902
D        EQU   X'68'               VERB CODE FOR D (DISPLAY)            08240602
DR       EQU   X'42'               VERB CODE FOR D R             Y02669 08242602
DU       EQU   X'52'               VERB CODE FOR D U             Y02669 08245302
D38      EQU   X'F3'               VERB CODE FOR D 3850        @Z40LPTA 08247304
TR       EQU   X'C4'               VERB CODE FOR TR (TRACK)      Y02669 08250002
PT       EQU   X'C8'               VERB CODE FOR PT (STOPTR)     Y02669 08300002
JES2     EQU   34                  VERB CODE FOR JES2            Y02669 08305002
NULL     EQU   X'00'               CODE INDICATES NO AREA SPECIFIED     08310402
*                                  OR DEFAULT PROVIDED BY MSGRT         08310802
F0       EQU   X'F0'               MASK FOR DETERMINING NUMERICS        08311702
C0       EQU   X'C0'               MASK FOR DETERMINING LETTERS  Y02669 08311802
DBLWORD  EQU   8                   LENGTH OF A DOUBLE WORD              08311902
PTRCVT   EQU   16                  LOCATION OF POINTER TO CVT           08312002
ASTRICK  EQU   X'5C'               SPECIAL AREA FILLER         @Z40LPTA 08313004
XFF      EQU   X'FF'               MASK FOR NI                   Y02651 08314002
         EJECT                                                          08322002
*********************************************************************** 08348102
*                                                                     * 08348202
*                     ERROR MESSAGE CODES                             * 08348402
*                                                                     * 08348502
*********************************************************************** 08349402
MSG156   EQU   04                  IEE156I CM INVALID OPERAND -  Y02669 08353202
MSG305   EQU   05                  IEE305I CM COMMAND INVALID    Y02669 08353602
MSG311   EQU   11                  IEE311I PARAMETER MISSING     YM1917 08354002
MSG345   EQU   08                  IEE345I CM AUTHORITY INVALID  Y02669 08354402
MSG921   EQU   09                  IEE921I CM OP REJECTED        Y02669 08355602
MSG921A  EQU   12                       DISPLAY ALREADY EXISTS   Y02669 08356802
MSG921B  EQU   13                       DISPLAY AREA BUSY        Y02669 08358002
MSG921C  EQU   14                       NO TRACK TO STOP         Y02669 08359202
MSG921D  EQU   25                       NEEDS DISPLAY AREA       Y02669 08360402
MSG921E  EQU   31                       SUBSYSTEM CONSOLE      @Y02668P 08360603
MSG925   EQU   11                  IEE925I 'COMMAND' OPERAND     Y02669 08360802
MSG925A  EQU   26                       FOR CRT ONLY             Y02669 08361202
MSG926   EQU   12                  IEE926I L=CCA OPERAND INVALID Y02669 08361602
MSG926A  EQU   18                       CCA NOT AN AREA          Y02669 08362802
MSG926B  EQU   19                       CC NOT A CONSOLE         Y02669 08364002
MSG926C  EQU   20                       CC FULL CAPABILITY       Y02669 08365202
MSG926D  EQU   21                       DYNAMIC DISPLAY IN AREA  Y02669 08366402
MSG926E  EQU   31                       SUBSYSTEM CONSOLE      @Y02668P 08366603
MSG927   EQU   13                  IEE927I REQUEST AMBIGIOUS     YM1557 08366802
MSG927A  EQU   23                       SPECIFY L OPERAND        YM1557 08367202
*********************************************************************** 08368802
*                                                                     * 08370002
*                 JES2 INTERFACE RETURN CODES                    Y02669 08371002
*                                                                     * 08372002
*********************************************************************** 08373002
OKCCA    EQU   0                   0 - VALID ROUTING REQUEST     Y02669 08373202
AREANUSE EQU   4                   4 - ANOTHER DISPLAY IN AREA   Y02669 08373402
TRINAREA EQU   8                   8 - TRACK DISPLAY IN AREA     Y02669 08373602
BADCONSL EQU   12                  12 - INVALID CONSOLE ID       Y02669 08374002
*                                       CONSOLE ID TOO HIGH      Y02669 08375002
*                                       CONSOLE NOT ACTIVE       Y02669 08376002
*                                       CONSOLE FULL CAPABILITY  Y02669 08377002
BADAREA  EQU   16                  16 - INVALID AREA REQUEST     Y02669 08380002
         EJECT                                                          08385002
*********************************************************************** 08390002
*                                                                     * 08398002
*                ESTABLISH ADDRESSABILITY                             * 08406002
*                REGISTER 2 POINTS TO XSA                             * 08414002
*                INITIALIZE ROUTING FIELD (XAS) TO ZEROES             * 08422002
*                OBTAIN THE LOCAL AND CMS LOCKS                       * 08430002
* NOTE: IF REQUEST FROM JES2 BRANCH TO SPECIAL CODE AT JES2CODE       * 08438002
*********************************************************************** 08446002
         USING DXSA,XSABASE        BASE XSA                      Y02669 08454002
         STM   REG0,RETURN14,XASAVSTD   SAVE REGISTERS FOR JES2  Y02669 08462002
         SPACE                                                          08478002
         BALR  MYBASE,0                                                 08486002
         USING *,MYBASE            BASE THIS MODULE                     08500001
         MODID BRANCH=YES                                        Y01886 08550001
         L     WORK4,PTRCVT        GET CVT POINTER               Y02669 09200002
         USING DCVT,WORK4          BASE CVT                      Y02669 09300002
         L     WORK5,CVTTCBP       SET TCB POINTER             @Y02668P 09350003
         L     UCMBASE,CVTCUCB     GET UCM POINTER                      09400001
         DROP  WORK4                                             Y02669 09450002
         USING TCBASCB,WORK5       BASE IEFPTRS                @Y02668P 09458003
         L     WORK4,TCBPTR        CURRENT TCB ADDRESS,SAVE    @Y02668P 09466003
*                                  WORK4 UNTIL AFTER THE TCB   @Y02668P 09474003
*                                  IS IDENTIFIED               @Y02668P 09482003
         DROP  WORK5                                                    09490003
         USING UCM,UCMBASE         BASE UCM                      Y02669 09500002
         USING UCMLIST,UCMEBASE    BASE UCM ENTRY                       09600001
         USING DCMTSRT,RDCMBASE    BASE RESIDENT DCM             Y02669 09700002
         USING DRCT,RCTBASE        BASE ROUTING CONTROL TABLE           09800001
         SPACE 2                                                        10610002
LOCKSET  EQU   *                                                 Y02651 10650002
         STM   RCTBASE,RETURN14,XASAVLOC                         Y02651 10700002
         SETLOCK OBTAIN,TYPE=LOCAL,MODE=UNCOND,RELATED=(K,TR,D,PT,     *10750002
               LOCKSOFF,IEE5503D,5603D,5903D,6703D,6803D,6903D,7703D,  *10800002
               7803D)                                                   10810002
         SETLOCK OBTAIN,TYPE=CMS,MODE=UNCOND,RELATED=(K,TR,D,PT,       *10850002
               LOCKSOFF,IEE5503D,5603D,5903D,6703D,6803D,6903D,7703D,  *10900002
               7803D)                                                   10950002
         LM    RCTBASE,RETURN14,XASAVLOC                         Y02651 11000002
         CLI   XAN,JES2                 REQUEST FROM JES2?     @YM4796P 11002602
         BE    JES2CODE                 YES,BR TO  JES2 CODE   @YM4796P 11002902
         XC    XAS(DBLWORD),XAS         ZERO OUT XAS           @YM2773P 11003202
         OI    XASSDS,XASSDS5           INDICATE LOCKS HELD    @YM2773P 11003502
         C     WORK4,UCMPXA        CURRENT TCB = COMTASK?      @Y02668P 11003703
         BE    COMTASK             YES,BRANCH                  @Y02668P 11009703
         OI    XASSDS,XASSDS3      NO,ANOTHER TASK ISSUE CMD   @Y02668P 11015703
COMTASK  EQU   *                                                        11024003
         EJECT                                                          11034003
*********************************************************************** 11044002
*                                                                     * 11044402
*     INVOKE IEEBUFSC TO SCAN THE OPERAND BUFFER POINTED TO BY XAL    * 11044802
*     FOR THE L= OPERAND AND RETURN THE ADDRESS OF THE 'CCA' VALUE    * 11044902
*     AND ITS LENGTH.                                                 * 11047602
*                                                                     * 11053102
*     OPERATION  1. SET UP PTR TO BUFFER -1 AND PTR TO KEYWORD LENGTH * 11055502
*                2. IF BUFFER PTR = SPECIFIED KEYWORD GOTO (3).       * 11057902
*                   A. IF NOT, INCREMENT BUFFER PTR BY ONE.           * 11067902
*                   B. IF PTR IS AT END OF BUFFER SET UP NOT FOUND    * 11069902
*                      RETURN CODE (8) IN R15 AND EXIT.               * 11073902
*                   C. IF PTR IS AT A COMMA, GO BACK TO OPERATION 2.  * 11075902
*                   D. IF PTR IS AT A BLANK SET UP NOT FOUND RETURN   * 11077902
*                      CODE (8) IN R15 AND EXIT.                      * 11081902
*                   E. OTHERWISE GO TO OPERATION 2.A.                 * 11083902
*                3. AT FOUND ROUTINE SET UP R14 TO POINT TO KEYWORD   * 11085902
*                   VALUE                                             * 11088702
*                4. SCAN KEYWORD VALUE TO THE END OF THE BUFFER, A    * 11090702
*                   COMMA OR A BLANK                                  * 11092702
*                5. CALCULATE LENGTH OF KEYWORD VALUE.                * 11093102
*                6. IF LENGTH IS < OR = ZERO, SET UP AN INVALID KEYWORD 11093502
*                   VALUE LENGTH RETURN CODE (4) IN R15 AND EXIT.     * 11093902
*                7. OTHERWISE, SET GOOD RETURN CODE (0) IN R15 AND EXIT 11094302
*                                                                     * 11104202
*    INPUT       R0 - PTR TO LAST BYTE OF BUFFER + 1                  * 11127502
*                R1 - PTR TO BEGINNING OF BUFFER                      * 11129502
*                R15- PTR TO KEYWORD WITH THE LENGTH OF THE KEYWORD   * 11137502
*                     IN THE HIGH ORDER BYTE.                         * 11139502
*                     EG. KEYWORD FORMAT 'DSNAME=' R15 WOULD POINT    * 11139902
*                     TO THE 'D' WITH A 6 IN THE HIGH ORDER BYTE.     * 11140302
*                                                                     * 11140702
*     OUTPUT     R1   LENGTH OF KEYWORD VALUE                         * 11141102
*                R14  PTR TO FIRST BYTE OF KEYWORD VALUE IN BUFFER    * 11141802
*                     OR WORKAREA                                     * 11143802
*                R15  RETURN CODE OF ZERO.                            * 11147302
*                                                                     * 11149302
*     ERROR      R15  CONTAINS 4 IF KEYWORD HAS AN INVALID LENGTH     * 11149702
*     OUTPUT                   8 IF KEYWORD WAS NOT FOUND IN BUFFER   * 11150102
*                                                                     * 11150502
*     EXIT       TO NEXT SEQUENTIAL INSTRUCTION AFTER MACRO CALL      * 11150602
*                                                                     * 11154802
*     NOTES      LISTS OF OPERANDS IN PARENTHESES ARE NOT PROCESSED.  * 11156802
*                THIS MACRO IS INTENDED TO PROCESS ONLY A SINGLE      * 11158802
*                VALUE FOR A GIVEN KEYWORD.                           * 11158902
*                                                                     * 11163202
*********************************************************************** 11165202
         EJECT                                                          11167202
         ICM   REG0,E7,XAP+1       R0 PTR TO BUFFER END + 1      Y02669 11169602
         ICM   REG1,E7,XAL+1       R1 PTR TO BUFFER BEGINNING    Y02669 11172402
         BZ    KNOL                BRANCH IF NO POINTER        @ZA12152 11172533
         CLC   E0(E2,REG1),NCCHAR  IS COMMAND K N,PFK          @ZA12152 11172633
         BE    KNOL                YES, BYPASS SCAN FOR L=     @ZA12152 11172733
         LA    R15,LEQUALS         R15 PTR TO KEYWORD EQUATE     Y02669 11172802
         ICM   R15,E8,C1               HI-ORDER BYTE IS LENGTH   Y02669 11173202
         LR    WORK5,RETURN14      SAVE RETURN ADDRESS           Y02669 11175202
         IEEBUFSC                                                Y02669 11176002
*********************************************************************** 11177502
*                                                                     * 11177602
*        REG1 - LENGTH OF VALUE FOLLOWING THE KEYWORD                 * 11177902
*               STORED IN XASAVSTD                                    * 11178302
*        RETURN14 - PTR TO FIRST BYTE OF KEYWORD VALUE                * 11178602
*                   LOADED INTO OPPTR                                 * 11178702
*        REG15 - RETURN CODE 0 - ALL WENT WELL                        * 11179002
*                            4 - PTR TO END OF BUFFER + 1 WAS WRONG   * 11179402
*                            8 - KEYWORD WAS NOT FOUND                * 11179802
*        XASAVSTD - LENGTH OF 'CCA' INFORMATION                       * 11179902
*        XASTSAVE - PTR TO 'C' OF L=CCA                               * 11180002
*        XASAVSTD+4 - PTR TO , PRECEDING OPERAND                      * 11180102
*        XASAVSTD+8 - PTR TO 'L' OF L=CCA                             * 11190102
*                                                                     * 11199202
*  ERR - IEE156I INVALID OPERAND - L= IS FIRST OPERAND ON COMMAND     * 11201202
*********************************************************************** 11205502
         SPACE 2                                                        11211802
         CH    R15,C4               DETERMINE RETURN CODE        Y02669 11228702
         BH    NOL                  8 - NO 'L' IN OPERAND BUFFER Y02669 11233802
         BL    OPFOUND              0 - L OPERAND WAS FOUND      Y02669 11238902
ERRONL   EQU   *                                                 Y02669 11244002
         SH    RETURN14,C2              POINT TO 'L'           @YM5459P 11245002
LFIRST   LR    OPPTR,RETURN14           FOR IEE5603D           @ZA16595 11245533
         LR    RETURN14,WORK5       4 - ERROR CONDITION          Y02669 11249102
         B     ERR156                   IEE156I INVALID OPERAND  Y02669 11254202
OPFOUND  EQU   *                                                        11259302
         ST    REG1,XASAVSTD        SAVE LENGTH OF KEYWORD VALUE Y02669 11264402
         LR    OPPTR,RETURN14           SAVE ADDR OF 'CCA' VALUE Y02669 11269502
         ST    OPPTR,XASTSAVE           SAVE CURSOR POINTER      Y02669 11271502
         BCTR  RETURN14,0               POINT TO EQUAL SIGN      Y02669 11274602
         BCTR  RETURN14,0               POINT TO 'L'             Y02669 11279702
         ST    RETURN14,XASAVSTD+E8     SAVE ADDR OF 'L'         Y02669 11284802
         BCTR  RETURN14,0               POINT TO PRECEDING ,     Y02669 11287402
         CLI   E0(RETURN14),COMMA       'L=' NOT ALLOWED AS    @ZA16595 11287633
*                                       FIRST OPERAND: TEST IT @ZA16595 11287833
         BE    LCOM                     NOT FIRST: OK          @ZA16595 11288033
         LA    RETURN14,E1(RETURN14)    FIRST: ERROR, POSITION @ZA16959 11288233
*                                       CURSOR TO 'L' AND      @ZA16959 11288433
         B     LFIRST                   GO ISSUE ERROR MESSAGE @ZA16959 11288633
LCOM     ST    RETURN14,XASAVSTD+E4     SAVE ADDR OF ,           Y02669 11289633
         LR    RETURN14,WORK5           RESTORE REGISTER 14      Y02669 11300002
         EJECT                                                          13600001
*********************************************************************** 13650002
*                                                                     * 13660002
*                'L' OPERAND FOUND ON COMMAND                         * 13670002
*                                                                     * 13680002
*  ERR - IEE156I INVALID OPERAND - 'L=CCA' INVALID FROM TSO TERMINAL  * 13682002
*                                   'CC' = 0000                       * 13684002
*********************************************************************** 13690002
         SPACE 2                                                        13692002
LFOUND   EQU   *                                                        13700001
         CLC   XAA(E2),ZERO        IS COMMAND FROM TSO TERMINAL? Y02669 13850002
         BNE   ERR305              YES, NO L OPERAND ALLOWED     YM1917 13860002
         CLC   E0(E2,OPPTR),F0F0   DOES L=00? - INVALID CONSOLE  Y02669 13870002
         BE    ERR926B             ID - ERROR MSG                Y02669 13880002
         OI    XASSDS,XASSDS2      INDICATE L OPERAND SPECIFIED ON CMD  13900002
         TM    E0(OPPTR),F0        1ST CHAR A NUMBER (FIRST 4 BITS F)?  14150002
         BNO   CCNTSPEC            BRANCH IF NOT A NUMBER (NO CC)       14250002
         SPACE 2                                                        14252002
*********************************************************************** 14260002
*                                                                     * 14270002
*                'CC' OR 'C' SPECIFIED ON COMMAND                     * 14280002
*                                                                     * 14290002
*  ERR - IEE926I 'CC' NOT A CONSOLE - TARGET CONSOLE ID WAS INVALID   * 14290402
*********************************************************************** 14292002
         SPACE  2                                                       14294002
         TM    E1(OPPTR),F0        IS SECOND CHARACTER A NUMBER? Y02669 14300002
         BO    TWODIGIT            YES, TWO-DIGIT NUMBER                14800002
         PACK  XAP(DBLWORD),E0(E1,OPPTR)  PACK THE CONSOLE ID           15300001
         LA    OPPTR,E1(OPPTR)     OPPTR=1ST CHAR AFTER 'CC'     Y02669 15400002
         B     CHECKCC             VALIDITY CHECK                       15600002
TWODIGIT EQU   *                                                        15700001
         PACK  XAP(DBLWORD),E0(E2,OPPTR)  PACK THE CONSOLE ID           15800001
         LA    OPPTR,E2(OPPTR)     OPPTR=1ST CHAR AFTER 'CC'     Y02669 15900002
CHECKCC  EQU   *                                                        16100001
         CVB   CONSID,XAP          CONVERT CONSOLE ID TO BINARY         16400002
         STC   CONSID,XASCID       STORE CONSOLE ID IN XSA              16600001
         L     UCMEBASE,UCMVEL     BASE LAST UCMENTRY                   16700001
         CLC   XASCID(E1),UCMID    ID HIGHER THAN HIGHEST VALID  Y02669 17050002
         BH    ERR926B             CONSOLES ID? YES, ERROR       Y02669 17100002
         EJECT                                                          17110002
*********************************************************************** 17150002
*                                                                     * 17160002
*    CHECK IF AREA ID IS SPECIFIED. AT THIS POINT OPPTR POINTS TO     * 17200002
*    THE FIRST CHAR AFTER THE CONSOLE ID                              * 17400002
*    IF NO 'A' IS SPECIFIED XASDID WILL REMAIN X'00' - NULL           * 17410002
*                                                                     * 17450002
*********************************************************************** 17550002
         SPACE  2                                                       17600002
         CLI   E0(OPPTR),BLANK     IS POINTER AT END OF COMMAND? Y02669 17700002
         BE    REMOVEL             YES, NO 'A' IS SPECIFIED             17800002
         CLI   E0(OPPTR),COMMA     IS POINTER AT END OF OPERAND? Y02669 17900002
         BE    REMOVEL             NO , NO 'A' IS SPECIFIED             18000002
         SPACE                                                          18100001
*********************************************************************** 18110002
*                                                                     * 18110402
*                'A' OPERAND FOUND ON COMMAND                         * 18112002
*                                                                     * 18114002
*    IT IS ASSUMED THAT THE FIRST CHAR AFTER THE CONSOLE ID           * 18120002
*    (OR AFTER THE = IF CC IS NOT SPECIFIED) IS THE AREA ID.          * 18130002
*    IF THE ID IS NOT VALID IT WILL BE DISCOVERED WHEN LOOKING FOR    * 18142002
*    AN SACB TO MATCH IT.                                             * 18144002
*                                                                     * 18144402
*  ERR - IEE156I INVALID OPERAND - 'A' WAS MORE THAN 1 CHARACTER      * 18144802
*********************************************************************** 18146002
         SPACE  2                                                       18148002
STOREA   EQU   *                                                        18148402
         TM    E0(OPPTR),C0        1ST CHAR A LETTER (FIRST 3 BITS F)?  18148502
         BNO   ERR926A             IF NOT LETTER-INVALID AREA    Y02669 18148602
         MVC   XASDID(E1),E0(OPPTR)  MOVE AREA ID INTO XSA       Y02669 18148802
         LA    OPPTR,E1(OPPTR)     INCREMENT POINTER TO NEXT CHARY02669 18149202
         CLI   E0(OPPTR),BLANK     IS POINTER AT END OF COMMAND? Y02669 18149602
         BE    REMOVEL             YES, BRANCH TO REMOVE L              18149702
         CLI   E0(OPPTR),COMMA     IS POINTER AT END OF OPERAND  Y02669 18149802
         BE    REMOVEL             YES, BRANCH TO REMOVE L              18149902
         B     ERR156              BRANCH TO ERROR ROUTINE       Y02669 18156502
         EJECT                                                          18171002
*********************************************************************** 18710002
*                                                                     * 18712002
*                'L' OPERAND WAS NOT SPECIFIED ON THE COMMAND         * 18720002
*         CHECK RCT FOR ROUTING DEFAULTS SET BY MSGRT COMMAND         * 18722002
*                                                                     * 18724002
*********************************************************************** 18730002
         SPACE  2                                                       18740002
NOL      EQU   *                   NO L OPERAND WAS FOUND               18750002
         LR    RETURN14,WORK5      RESTORE R14 AFTER IEEBUFSC    Y02669 18760002
KNOL     EQU   *                  COMMAND WAS N,PFK BUFSC SKIP @ZA12152 18780033
         CLC   XAA(E2),ZERO        IS COMMAND FROM TSO TERMINAL? Y02669 18800002
         BNE   TESTOPER            YES, CHECK DISPLAY OPERANDS   Y02669 18830002
         SPACE  2                                                       18860002
*********************************************************************** 18870002
*                                                                     * 18872002
*                'CC' NOR 'C' WAS SPECIFIED ON THE COMMAND            * 18880002
*                                                                     * 18882002
*********************************************************************** 18890002
         SPACE  2                                                       18892002
CCNTSPEC EQU   *                                                        18900002
         SR    REG1,REG1          CLEAR PARAMETER REG                   18950002
         ICM   REG1,E1,XAU        GET SOURCE CONSOLE ID          Y02669 18980002
         BNZ   NOTINTEN           IF ZERO NO DEFAULTING          YM1557 19020002
INTERNAL EQU   *                                                 YM1557 19030002
         CLI   XAV,DCHAR          ONLY A DISPLAY COMMAND CAN BE  YM1557 19040002
*                                 ISSUED INTERNALLY WITHOUT    @YM7698P 19050002
*                                 THE L OPERAND. THE K, TR AND @YM7698P 19050102
*                                 STOPTR COMMANDS CAN NOT BE   @YM7698P 19056002
*                                 ISSUED INTERNALLY WITHOUT    @YM7698P 19057002
         BNE   RETURN             THE L OPERAND                @YM7698P 19058002
         LR    WORK4,UCMBASE      GET ADDRESS OF UCM             YM1557 19059002
         LA    WORK5,E4           PUT 4 IN REG5 FOR SUBSTRACT    YM1557 19060002
         SR    WORK4,WORK5        UCM MINUS 4 AND                YM1557 19063002
         L     WORK4,E0(WORK4)    GET REAL ADDRESS OF UCM PREF @ZA03611 19064004
         USING UCMPRFX,WORK4      ESTABLISH UCM PREFIX BASE      YM1557 19065002
         L     UCMEBASE,UCMMCENT  GET UCME ADDR FOR MASTER       YM1557 19067002
         DROP  WORK4                                             YM1557 19068002
         MVC   XASCID(E1),UCMID   USE MASTER CONSOLE ID AS       YM1557 19070002
         MVC   XAU(E1),UCMID      BOTH SOURCE AND TARGET       @ZM30445 19071003
         MVI   XASDID,Z           DEFAULT WITH INSTREAM          YM1557 19072002
         TM    XASSDS,XASSDS2     L OPERAND SPECIFIED ?        @ZM30445 19072603
         BNO   TSTCMND            NO,CHECK COMND BEING ISSUED  @ZM30445 19074003
         LA    OPPTR,E1(OPPTR)    BUMP OPERAND PTR             @ZM30445 19074603
         B     REMOVEL            YES, GO REMOVE IT            @ZM30445 19075203
*********************************************************************** 19076002
*                  GET ISSUING CONSOLE'S UCM ENTRY                    * 19078002
*********************************************************************** 19080002
NOTINTEN EQU   *                                                 YM1557 19080402
         BAL   R15,FINDUCME        BASE SOURCE UCM ENTRY         Y02669 19082002
         EJECT                                                          19084002
*********************************************************************** 19086002
*                                                                     * 19088002
*                 GET ISSUING CONSOLE'S ROUTING CONTROL TABLE         * 19088402
*                                                                     * 19088802
*********************************************************************** 19089202
         SPACE  2                                                       19090002
         ICM   RCTBASE,E7,UCMRCTA  SEE IF RCT IS PRESENT         Y02669 19100002
         BZ    NOCOMP              NO, ROUTE TO ISSUING CONSOLE         19250002
         ST    RCTBASE,XAD         SAVE BASE RCT ADDRESS         Y02669 19252002
ACTIVE   EQU   *                                                 Y02669 19260002
         TM    RCTCODE,RCTACT      IS ENTRY ACTIVE?              Y02669 19300002
         BO    COMPCMD             YES, GO COMPARE               Y02669 19330002
LASTRCT  EQU   *                                                 Y02669 19360002
         TM    RCTCODE,RCTCON      NO, IS IT LAST ENTRY?         Y02669 19400002
         BO    NEXTRCT             NO, LOAD NEXT POINTER         Y02669 19450002
         BM    NOCOMP              YES, COMPARE NOT FOUND              X19500002
                                        ROUTE TO ISSUING                19550002
         LA    RCTBASE,RCTENT2     POINT TO NEXT ENTRY                  19600002
         B     ACTIVE              GO TEST IT                           19650002
NEXTRCT  EQU   *                                                 Y02669 19660002
         ICM   RCTBASE,E7,RCTCODE+1 LOAD NEW POINTER             Y02669 19700002
         BZ    NOCOMP              IF NONE, ROUTE TO ISSUING     Y02669 19750002
         B     ACTIVE              GO TEST IT                    Y02669 19752002
         SPACE                                                          19754002
*********************************************************************** 19762002
*         CHECK RCT FOR ENTRY FOR COMMAND FOR A DEFAULT 'CC' VALUE    * 19772002
*********************************************************************** 19780002
COMPCMD  EQU   *                                                 Y02669 19800002
         CLC   XAV(E1),RCTVER      DO COMMAND AND TABLE MATCH?          19850002
         BE    OPTEST              YES, GO TEST OPERAND                 19880002
         CLI   XAV,CCHAR          NO, IS COMMAND VERB 'CONTROL'? Y02669 19910002
         BNE   TRCMD               NO, IS CMD VERB TR?           Y02669 19960002
         CLI   RCTVER,KCHAR        YES, IS TABLE ENTRY 'K'?             20050002
         BE    TESTENT             YES, BYPASS OPERAND CHECK     Y02669 20100002
         B     LASTRCT             NO, RETURN TO TABLE SCAN      Y02669 20102002
TRCMD    EQU   *                                                 Y02669 20110002
         CLI   RCTVER,TCHAR        IS TABLE ENTRY 'T'?           Y02669 20140002
         BNE   LASTRCT             NO, RETURN TO TABLE SCAN      Y02669 20140402
         CLI   XAN,PT              IS COMMAND VERB 'STOPTR'?     Y02669 20142002
         BE    TESTENT             YES, BYPASS OPERAND CHECK     Y02669 20154002
         B     LASTRCT             NO, RETURN TO TABLE SCAN      Y02669 20156002
         SPACE  2                                                       20160002
OPTEST   EQU   *                                                        20200002
         CLI   RCTVER,KCHAR        IS TABLE ENTRY 'K'?           Y02669 20210002
         BE    TESTENT             YES, BYPASS OPERAND TEST      Y02669 20230002
         CLI   RCTVER,TCHAR        IS TABLE ENTRY 'T'FOR TR?     Y02669 20240002
         BE    TESTENT             YES, BYPASS OPERAND TEST      Y02669 20242002
         L     RCTSCAN,XAL         POINT TO OPERAND                     20250002
         CLC   E0(E2,RCTSCAN),DCBLANK   IS OPERAND D C         @YM4791P 20260002
         BE    DCOPER                                          @YM4791P 20270002
         CLC   E0(L'CONSOLES,RCTSCAN),CONSOLES   IS OPERAND 'CONSOLES'? 20280002
         BE    DCOPER              YES, COMPARE WITH RCT         YM1916 20290002
         CLI   E0(RCTSCAN),DCHAR   IS 1ST CHAR A 'D'?          @G33CPMR 20293033
         BNE   PROCEED             NO, AVOID 'D' CHAR. TESTS   @G33CPMR 20296033
         CLC   E0(L'DUMP,RCTSCAN),DUMP IS OPERAND 'DUMP'?      @G33CPMR 20300033
         BE    DDOPER              YES, COMPARE WITH RCT       @G33CPMR 20306033
         CLC   E0(L'DMN,RCTSCAN),DMN IS OPERAND 'DMN'?         @G33CPMR 20308033
         BNE   DDOPER              NO, COMPARE WITH RCT        @G33CPMR 20310033
PROCEED  EQU   *                                               @G33CPMR 20312033
         CLC   RCTOPD(E1),E0(RCTSCAN)  DOES OPERAND MATCH TABLE? YM1916 20320002
         BE    TESTENT             YES, GO TO INSERT VALUES      Y02669 20350002
         BNE   DACTCMD             NO                            Y02669 20430002
DCOPER   EQU   *                                                 Y02669 20470002
         CLI   RCTOPD,OCHAR        YES, IS TABLE ENTRY 'O'?             20500002
         BNE   LASTRCT             NO, RETURN TO TABLE SCAN      Y02669 20550002
         B     TESTENT             YES, GO INSERT VALUES         Y02669 20560002
DDOPER   EQU   *                                               @G33CPMR 20562033
         CLI   RCTOPD,PCHAR        IS TABLE ENTRY 'P'?         @G33CPMR 20563033
         BNE   LASTRCT             NO, RETURN TO TABLE SCAN    @G33CPMR 20564033
         B     TESTENT             YES, GO TO VALUE INSERTION  @G33CPMR 20565033
         SPACE 2                                                        20570002
DACTCMD  EQU   *                                                 Y02669 20580002
         CLI   RCTOPD,ACHAR        IS TABLE ENTRY 'A'?           Y02669 20590002
         BNE   LASTRCT             NO, RETURN TO TABLE SCAN      Y02669 20592002
         CLI   XAN,D               IS COMMAND VERB D JOBS; TS; A?Y02669 20594002
         BNE   LASTRCT             NO, RETURN TO TABLE SCAN      Y02669 20596002
         EJECT                                                          20600002
*********************************************************************** 20770002
*                                                                     * 20780002
*  IF NO DEFAULT WAS FOUND IN RCT THE DISPLAY IS ROUTED TO THE        * 20790002
*  ISSUING CONSOLE                                                    * 20792002
*  'CC' EQUALS XAU VALUE AND 'A' EQUALS X'00'                         * 20794002
*  OTHERWISE, THE DEFAULTS FOUND IN THE RCT ARE STORED IN THE XSA.    * 20802002
*                                                                     * 20810002
*  IF 'A' WAS SPECIFIED ON THE COMMAND ITS VALUE OVERRIDES RCT VALUE  * 20818002
*                                                                     * 20826002
*********************************************************************** 20834002
         SPACE  2                                                       20842002
TESTENT  EQU   *                                                        20850002
         OI    XASSDS,XASSDS4      SET 'L' OPERAND FROM RCT    @ZA02576 20860003
         MVC   XASDID(E1),RCTAID   STORE AREA ID (00-NONE)       Y02669 20880002
         CLI   XASDID,ASTRICK       THIS SPECIAL RCTAID FILLER @Z40LPTA 20882004
         BNE   NOTAST              NO, PROCEED                 @Z40LPTA 20884004
         MVI   XASDID,NULL         RE-SET TO NULL (00)         MZ40LPTA 20886004
NOTAST   EQU   *                                               @Z40LPTA 20888004
         CLI   RCTCID,NULL         IS CONSOLE ID PROVIDED IN RCT?Y02669 20894002
         BE    NOCOMP              NO, ROUTE TO ISSUING          Y02669 20894602
         MVC   XASCID(E1),RCTCID   YES,STORE CONSOLE ID FROM RCT Y02669 20895202
         B     LTEST               SEE IF L OPERAND WAS PRESENT         20895802
NOCOMP   EQU   *                                                 Y02669 20896402
         MVC   XASCID(E1),XAU      PUT SOURCE ID IN XSA                 20898002
LTEST    EQU   *                                                        20946702
         TM    XASSDS,XASSDS2      WAS L OPERAND PRESENT ON COMMAND?    20970402
         BO    STOREA              YES, GET AREA OPERAND FROM IT        20994102
         B     VALIDITY            NO, VALIDITY CHECK VALUES     Y02669 21017802
         EJECT                                                          21041502
*********************************************************************** 21065202
*                                                                     * 21065602
*    'L' OPERAND IS REMOVED FROM COMMAND SO THAT OTHER COMMAND        * 21066702
*    HANDLERS WILL NOT SEE IT                                         * 21200002
*    AT ENTRY HERE OPPTR POINTS TO THE BLANK OR COMMA WHICH DELIMITS  * 21400002
*    THE 'L' OPERAND.                                                 * 21600002
*    A POINTER TO THE 'L' IS SAVED IN XASAVSTD + 8                    * 21700002
*                     ',' PRECEDING THE OPERAND IN XASAVSTD+4         * 21750002
*   THE LENGTH OF THE OPERAND IS SAVED IN XASAVSTD                    * 21800002
*                                                                     * 21850002
*********************************************************************** 21950002
         SPACE                                                          21960002
MOVEOP   MVC   E0(E0,WORK5),E0(OPPTR)  PUSH REST OF OPERANDS OVER       21970002
BLANKOUT MVC   E1(E0,WORK5),E0(WORK5)  BLANK OUT FIELD POINTED TO       21980002
*                                       BY WORK5                        21990002
         SPACE                                                          21992002
REMOVEL  EQU   *                                                        22000002
         L     WORK4,XASAVSTD      GET LENGTH OF L OPERAND       Y02669 22100002
         LA    WORK4,E1(WORK4)     LESS 2 FOR PROPAGATE & EX     Y02669 22200002
         CLI   E0(OPPTR),BLANK     IS POINTER AT END OF COMMAND? Y02669 22500002
         BNE   REMOVELC            NO, MOVE REST OF COMMAND OVER        22800002
         SPACE                                                          22850002
*********************************************************************** 22950002
*                                                                     * 22950402
*          'L' OPERAND IS AT END OF COMMAND SO JUST BLANK IT OUT      * 22952002
*                                                                     * 22954002
*********************************************************************** 22960002
         SPACE                                                          22970002
         L     WORK5,XASAVSTD+E4   GET ADDRESS OF COMMA BEFORE L Y02669 23200002
         MVI   E0(WORK5),BLANK     BLANK FIRST BYTE, THEN        Y02669 23300002
         EX    WORK4,BLANKOUT      BLANK OUT REST OF OPERAND     Y02669 23400002
         B     VALIDITY            CHECK CONSOLE AND AREA VALIDITY      23600002
         SPACE 2                                                        23800002
*********************************************************************** 23850002
*                                                                     * 23860002
*        'L' OPERAND IS NOT LAST OPERAND. REMOVE IS, MOVE THE REST OF * 23900002
*       THE COMMAND OVER, AND BLANK WHERE COMMAND WAS MOVED FROM      * 24000002
*                                                                     * 24250002
*********************************************************************** 24350002
         SPACE                                                          24352002
REMOVELC EQU   *                                                        24360002
         L     WORK5,XAR           GET PARM LIST POINTER       @ZA10516 24365041
         LA    WORK5,E0(WORK5)     COMPUTE END OF PARM LIST BY:@ZA10516 24370041
         LR    R15,WORK5           GET BEGINNING ADDR OF LIST  @ZA10516 24380041
         AH    R15,0(WORK5)        ADD LENGTH OF PARM LIST     @ZA10516 24390041
         BCTR  R15,E0              POINT TO LAST CHARACTER       Y02669 24394002
         SR    R15,OPPTR           GET LENGTH OF OPERAND FIELD   Y02669 24700002
*                                  AFTER L OPERAND (-1 FOR EX)   Y02669 24800002
         L     WORK5,XASAVSTD+E4   GET ADDRESS OF COMMA BEFORE L Y02669 25000002
         EX    R15,MOVEOP          PUSH REST OF OPERANDS OVER    Y02669 25100002
         LA    WORK5,E1(WORK5)     CALCULATE ADDRESS OF FIELD TO Y02669 25200002
         AR    WORK5,R15             BE BLANKED                  Y02669 25300002
*                                  (WORK4 STILL HAS ADJUSTED     Y02669 25400002
*                                       LENGTH OF L OPERAND)     Y02669 25500002
         MVI   E0(WORK5),BLANK     BLANK FIRST BYTE THEN         Y02669 25600002
         EX    WORK4,BLANKOUT      PROPAGATE THRU REST OF FIELD  Y02669 25650002
         EJECT                                                          26500001
*********************************************************************** 33000001
*                                                                     * 33100001
*  AT ENTRY TO THIS SECTION OF CODE, THE TARGET CONSOLE ID AND AREA   * 33200002
* ID HAVE BEEN PUT IN THE XSA, EITHER FROM THE 'L' PARAMETER, THE     * 33300002
* DEFAULTS SPECIFIED BY THE MSGRT COMMAND, OR SYSTEM DEFINED          * 33400002
* DEFAULTS (ISSUING CONSOLE)                                          * 33500002
*                                                                     * 33600001
*        THIS CODE CHECKS FOR ROUTING AUTHORITY, AND ENSURES THAT     * 33700001
* 'CC' SPECIFIES AN ACTIVE CONSOLE WITH AREA 'A' DEFINED.             * 33800002
*                                                                     * 33900001
*   ERR - IEE345I AUTHORITY INVALID - ISSUING CONSOLE WASN'T ALLOWED  * 33950002
*                                     TO ISSUE COMMAND                * 33960002
*         IEE926I 'CC' NOT A CONSOLE     - TARGET CONSOLE NOT ACTIVE  * 33970002
*         IEE926I 'CC' FULL CAPABILITY   - COMMAND VALID ONLY TO MS   * 33980002
*                                          OR SD CONSOLE              * 33990002
*                                                                     * 33992002
*********************************************************************** 34000001
         SPACE 2                                                        34100001
VALIDITY EQU   *                                                        34200001
         USING DCMACB,SACBBASE     BASE SCREEN AREA CONTROL BLOCK       34300001
         CLC   XASCID(E1),XAU      IS TARGET AND SOURCE SAME?    Y02669 34350002
         BE    SRCEQTRG            IF YES, BRANCH                       35000001
         SPACE  2                                                       35050002
*********************************************************************** 35150002
*                                                                     * 35150402
*                 TARGET AND SOURCE ARE NOT THE SAME                  * 35150802
*   GET THE UCM ENTRY ADDRESS OF THE SOURCE AND BASE THE UCME         * 35152002
*                                                                     * 35154002
*********************************************************************** 35160002
         SPACE  2                                                       35162002
         SR    REG1,REG1                                         Y02669 35164002
         IC    REG1,XAU            GET SOURCE CONSOLE ID         Y02669 35170002
         LTR   REG1,REG1           IF ZERO, ISSUED INTERNALLY    YM1557 35180002
         BZ    AUTHOK              ASSUME AUTHORITY OK           YM1557 35190002
         BAL   R15,FINDUCME        FIND ITS UCME                 Y02669 35200002
         TM    UCMAUTH,UCMAUTH3    DOES SOURCE CONSOLE HAVE CONS        35700002
*                                       AUTHORITY TO ROUTE?             35800002
         BZ    ERR345              NO,  BRANCH TO ERROR ROUTINE  Y02669 36000002
         EJECT                                                          36050002
*********************************************************************** 36150002
*                                                                     * 36152002
*   GET THE UCM ENTRY ADDRESS OF THE TARGET CONSOLE AND BASE THE UCME * 36158002
*                                                                     * 36164002
*********************************************************************** 36170002
         SPACE  2                                                       36172002
AUTHOK   EQU   *                                                 YM1557 36172402
         SR    REG1,REG1                                         Y02669 36174002
         IC    REG1,XASCID         GET TARGET CONSOLE ID         Y02669 36180002
         BAL   R15,FINDUCME        FIND ITS UCME                 Y02669 36200002
         TM    UCMDISP2,UCMDISPK   IF ON SUBSYSTEM CONSOLE     @Y02668P 36300003
         BO    ERR926E             BRANCH TO ERROR ROUTINE     @Y02668P 36400003
         TM    UCMATR,UCMUF        IS CONSOLE ACTIVE?                   36600002
         BZ    ERR926B             NO,  BRANCH TO ERROR ROUTINE  Y02669 36700002
         CLI   XAN,K               IS THIS CONTROL COMMAND?             36750002
         BNE   CHKFULC             NO, GO CHECK FOR FULL CAPABILITY     36760002
         L     WORK4,XAL           GET POINTER TO 1ST OPERAND    Y02669 36770002
         CLI   E0(WORK4),VCHAR     IS COMMAND K V?               Y02669 36780002
         BE    CHKAREA             YES, ALLOW ROUTING EVEN IF          X36790001
                                        FULL CAPABILITY                 36792002
         SPACE  2                                                       36802002
*********************************************************************** 36842002
*                                                                     * 36842402
*     TARGET CONSOLE MUST BE MESSAGE STREAM OR STATUS DISPLAY         * 36844002
*     OR THE SAME AS ISSUING CONSOLE FOR ALL COMMANDS EXCEPT K V      * 36846002
*                                                                     * 36846102
*   ERR - IEE926I 'CC' FULL CAPABILITY                                * 36846402
*                                                                     * 36846802
*********************************************************************** 36848002
         SPACE  2                                                       36848402
CHKFULC  EQU   *                                                        36850001
         TM    UCMDISP,UCMDISPF+UCMDISPG IS CONSOLE MS OR SD?           36900002
         BZ    ERR926C             NO,  BRANCH TO ERROR ROUTINE  Y02669 37200002
         B     CHKAREA             BRANCH TO CHECK AREA                 37700001
         EJECT                                                          37750002
*********************************************************************** 37850002
*                                                                     * 37852002
*                TARGET IS THE SAME AS THE SOURCE                     * 37852402
*   GET THE UCM ENTY ADDRESS OF THE TARGET CONSOLE AND BASE THE UCME  * 37852502
*                                                                     * 37852802
*********************************************************************** 37860002
         SPACE  2                                                       37870002
SRCEQTRG EQU   *                                                        37900002
         SR    REG1,REG1                                         Y02669 37950002
         IC    REG1,XASCID         FIND TARGET CONSOLE UCME      Y02669 38000002
         BAL   R15,FINDUCME                                      Y02669 38050002
         SPACE  2                                                       38400002
*********************************************************************** 38450002
*                                                                     * 38452002
*   FROM THIS POINT ON IN THIS MODULE, UCMEBASE CONTAINS THE          * 38460002
*   ADDRESS OF THE TARGET CONSOLE'S UCM ENTRY.                        * 38462002
*                                                                     * 38464002
*********************************************************************** 38470002
         SPACE  2                                                       38480002
CHKAREA  EQU   *                                                        38500001
         CLI   XASDID,NULL        IS AREA NULL,NO 'A' SPECIFIED? Y02669 39200002
         BNZ   AREAEXST            NO, DOES AREA EXIST ON TARGET        39400002
         TM    UCMDISP,UCMDISPC    YES, IS TARGET CONSOLE A CRT?        39700002
         BZ    SETZ                NO, BRANCH TO SET AREA=Z             39800001
         TM    UCMDISP,UCMDISPF    YES, IS TARGET MESSAGE STREAM?       39900002
         BZ    CHKCMND             NO,BRANCH TO CHECK COMMAND           39910002
         SPACE  2                                                       39920002
*********************************************************************** 39950002
*                                                                     * 39952002
*   AREA REMAINS NULL AT THIS POINT IF TARGET IS A STATUS DISPLAY     * 39970002
*   OR FULL CAPABILITY CRT CONSOLE                                    * 39980002
*  IF TARGET IS NON-CRT OR MESSAGE STREAM ONLY CRT, INDICATE AREA=Z   * 39980402
*                                                                     * 39982002
*********************************************************************** 39990002
         SPACE  2                                                       40040002
SETZ     EQU   *                                                        40600001
         MVI   XASDID,Z            IF TARGET IS NON-CRT OR MSG STREAM   40800002
         B     CHKCMND             BRANCH TO CHECK COMMAND              41100001
         EJECT                                                          41150002
*********************************************************************** 41250002
*                                                                     * 41260002
*       FIND OUT IF THE AREA SPECIFIED EXISTS ON THE TARGET           * 41400002
*                                                                     * 41450002
*  ERR - IEE926I 'A' NOT AN AREA - TARGET IS STATUS DISPLAY ONLY      * 41460002
*                                  AND AREA 'Z' WAS SPECIFIED         * 41462002
*        IEE926I 'A' NOT AN AREA - TARGET IS NOT A CRT AND AREA IS    * 41470002
*                                  NOT IN-LINE                        * 41480002
*********************************************************************** 41550002
         SPACE  2                                                       41560002
AREAEXST EQU   *                                                        41600002
         TM    UCMDISP,UCMDISPC    IS TARGET A CRT?                     41700002
         BO    CRT                 IF YES, BRANCH                       41800001
         CLI   XASDID,Z            IS AREA = Z?                         41900002
         BNE   ERR926A             NO,  BRANCH TO ERROR ROUTINE  Y02669 42000002
         B     CHKCMND             YES, BRANCH TO CHECK COMMAND         42100001
CRT      EQU   *                   TARGET IS A CRT                      42200001
         CLI   XASDID,Z            IS AREA = Z?                         42300002
         BNE   OUTOLINE            NO, BRANCH                           42400001
         TM    UCMDISP,UCMDISPG    IS TARGET STATUS DISPLAY ONLY?       42500002
         BO    ERR926A             YES, BRANCH TO ERROR ROUTINE  Y02669 42600002
         B     CHKCMND             NO, BRANCH TO CHECK COMMAND          42700001
         SPACE  2                                                       43110002
*********************************************************************** 43150002
*                                                                     * 43150402
*   FIND THE SCREEN CONTROL BLOCK FOR THE SPECIFIED AREA.             * 43151402
*   ADDRESS IS PUT IN SACBBASE, ZERO IF NONE FOUND.                   * 43152402
*                                                                     * 43153402
*  ERR - IEE926I NOT AN AREA - SPECIFIED AREA DOES NOT EXIST (NO SACB)* 43154402
*********************************************************************** 43160002
         SPACE  2                                                       43170002
OUTOLINE EQU   *                                                        43172002
         BAL   R15,FINDSACB                                      Y02669 43200002
         LTR   SACBBASE,SACBBASE   IS SPECIFIED AREA DEFINED?           43700002
         BZ    ERR926A             NO,  BRANCH TO ERROR ROUTINE  Y02669 43800002
         EJECT                                                          43850002
*********************************************************************** 44100001
*                                                                     * 44200001
*    IF THE COMMAND IS CONTROL, 1-IF K COMMAND ISSUED INTERNALLY      * 44300002
*                                 RETURN TO CALLER                    * 44310002
*                               2-IF K COMMAND ISSUED GO TO IEE6703D  * 44350002
*    OTHERWISE CONTINUE                                               * 44400002
*                                                                     * 44600001
*********************************************************************** 44700001
         SPACE 2                                                        44800001
CHKCMND  EQU   *                                                        44900002
         CLI   XAN,K               IS COMMAND CONTROL?                  45100002
         BE    D6703D              YES, BRANCH TO PROCESS CMND @ZM30446 46100003
         SPACE 3                                                        48400002
*********************************************************************** 52910002
*                                                                     * 52920002
*     THE ONLY COMMANDS HANDLED BEYOND THIS POINT ARE:                * 52926002
*         DISPLAY   C,K; CONSOLES (C); MATRIX; UNITS;                 * 52932002
*                   JOBS (J); TS; A                                   * 52938002
*         TRACK     JOBS (J); TS; A                                   * 52944002
*         STOPTR    JOBS (J); TS; A                                   * 52950002
*                                                                     * 52956002
*  ERR - IEE305I COMMAND INVALID - OTHER THAN D, TR, PT               * 52962002
*********************************************************************** 52968002
         SPACE  2                                                       53018002
TSTCMND  EQU   *                                                        53100002
         CLI   XAN,TR              IS COMMAND TRACK?             Y02669 53122102
         BE    DACTIVE             YES, BRANCH                   Y02669 53132102
         CLI   XAN,PT              IS COMMAND STOPTR?            Y02669 53144102
         BE    STOPTR              YES, BRANCH                   Y02669 53146102
TESTOPER EQU   *                                                 Y02669 53156102
         CLI   XAV,DCHAR           IS COMMAND DISPLAY?           Y02669 53175702
         BNE   ERR305              ANY OTHER COMMAND IS ERROR    YM1917 53177202
         SPACE  2                                                       53177302
         CLI   XAN,D               IS COMMAND D JOBS (J); TS; A? Y02669 53177602
         BNE   DISPLAY             NO, BRANCH                    Y02669 53178002
         EJECT                                                          53178702
*********************************************************************** 53178802
*                                                                     * 53178902
*     DISPLAY INIT; JOBS (J); TS; A ARE FIRST SEACHED FOR ,LIST       * 53179602
*         (,L) THEN TREATED LIKE THE OTHER DISPLAY COMMANDS           * 53180302
*                                                                     * 53181002
*********************************************************************** 53181902
         SPACE  2                                                       53186002
DACTIVE  EQU   *                                                 Y02669 53186102
         L     REG1,XAL            GET ADDRESS OF OPERANDS       Y02669 53186202
         CLI   XAXMASK,XAXJOBS     IS THIS JOBS?                 Y02669 53186502
         BH    ACTIVEOP            NO, ACTIVE                    Y02669 53186702
         BL    TS                  NO, TS                        Y02669 53187702
         CLC   E0(E2,REG1),JOCHAR  ARE FIRST 2 CHARS 'JO'?       Y02669 53188102
         BNE   ACTIVEOP            NO, MIGHT BE JUST 'J'         Y02669 53188502
         LA    REG1,E4(REG1)       FOR JOBS BUMP PAST 'S'        Y02669 53189702
         B     COMPARE             END OF OPERANDS?              Y02669 53191702
ACTIVEOP EQU   *                                                 Y02669 53193702
         LA    REG1,E1(REG1)       FOR 'A' AND 'J' BUMP PAST     Y02669 53194102
         B     COMPARE             END OF OPERANDS?              Y02669 53197502
TS       EQU   *                                                 Y02669 53197802
         LA    REG1,E2(REG1)       FOR TS BUMP PAST 'S'          Y02669 53198302
COMPARE  EQU   *                                                 Y02669 53198402
         CLI   E0(REG1),BLANK      IS OPERAND FOLLOWED BY BLANK? Y02669 53198802
         BE    DORTR               YES, CONTINUE                 Y02669 53199502
         CLC   E0(E6,REG1),LIST    IS OPERAND AFTER , 'LIST '?   Y02669 53199902
         BE    LISTOPT             YES, CHANGE BITS              Y02669 53200302
         CLC   E0(E3,REG1),JUSTL   NO, IS IT JUST 'L '?          Y02669 53200702
         BNE   ERR156A             NO, INVALID OPERAND           Y02669 53201102
LISTOPT  EQU   *                                                        53201502
         SR    WORK4,WORK4                                       Y02669 53201902
         IC    WORK4,XAXMASK       GET REQUEST FLAGS FROM XSA    Y02669 53202302
         SRL   WORK4,E1            SHIFT RIGHT 1 FOR 'LIST'      Y02669 53202702
         STC   WORK4,XAXMASK       RESTORE REQUEST FLAGS         Y02669 53203102
DORTR    EQU   *                                                 Y02669 53203502
         CLI   XAN,TR              TRACK COMMAND?                Y02669 53203902
         BE    TRACK               YES                           Y02669 53204302
         EJECT                                                          53205102
*********************************************************************** 53205502
*                                                                     * 53205902
*     DISPLAY CONSOLES (C); C,K; M; AND U ARE CONSIDERED DISPLAYS     * 53206302
*                                                                     * 53206702
*  ERR - IEE926I DYNAMIC DISPLAY IN AREA - DISPLAY ALREADY IN AREA    * 53207102
*********************************************************************** 53207502
         SPACE  2                                                       53207902
DISPLAY  EQU   *                   DISPLAY COMMAND                      53208302
         CLC   XAA(E2),ZERO        IS THIS FROM A TSO USER?      Y02669 53208402
         BNE   D0803D              YES, EXIT                     Y02669 53208702
         CLI   XASDID,Z            IS AREA = Z?                         53209102
         BE    D0803D              YES, EXIT                     Y02669 53209502
         CLI   XASDID,NULL         AREA SPECIFIED IN CMD OR BY DEFAULT  53209902
         BE    DEFAREA             NO, PROVIDE DEFAULT AREA             53210302
         TM    DCMADFLG,DCMADD     TRACK ALREADY IN AREA?               53211002
         BO    ERR926D             YES, BRANCH TO ERROR ROUTINE  Y02669 53213202
         B     D0803D              GO BUILD CSCB - IEE0803D      Y02669 53214302
         EJECT                                                          53215402
*********************************************************************** 53215802
*                                                                     * 53216202
*        IF NO AREA IS SPECIFIED IN THE COMMAND AND NO DEFAULT IS     * 53216302
* FOUND IN THE ROUTING CONTROL TABLE, A DEFAULT AREA IS ESTABLISHED   * 53216402
* AS FOLLOWS:                                                         * 53216502
*        (1) THE BOTTOM-MOST EMPTY AREA                               * 53216602
*        (2) IF NONE EMPTY, THE AREA CONTAINING THE OLDEST STATIC     * 53216702
*            DISPLAY                                                  * 53216802
*        (3) IF NO DISPLAY AREAS AVAILABLE, A TRACK COMMAND IS        * 53217202
*            REJECTED; A STATIC DISPLAY IS PUT IN LINE                * 53217602
*        (4) IF THE CONSOLE HAS NO MESSAGE STREAM, A DISPLAY COMMAND  * 53217702
*            IS REJECTED                                              * 53217802
*                                                                     * 53217902
*   ERR-IEE921I NEEDS DISPLAY AREA - 1 TRACK WITH NO SACB DEFINED     * 53218002
*                                    2 DISPLAY WITH NO SACB DEFINED   * 53218102
*                                    AND TARGET IS STATUS DISPLAY     * 53218202
*               DISPLAY AREA BUSY  - NO STATUS DISPLAY TO OVERLAY     * 53218302
*********************************************************************** 53219102
         SPACE                                                          53219402
DEFAREA  EQU   *                                                        53219702
         L     RDCMBASE,UCMXB      GET ADDRESS OF RESIDENT DCM   Y02669 53220002
         CLI   DCMTOPAR,E0         ANY AREAS DEFINED FOR TARGET?        53220302
         BE    MSGSTRM             NO, PUT IN LINE               Y02669 53220602
         SPACE                                                          53220902
*********************************************************************** 53221202
*     LOOK FOR BOTTOM-MOST EMPTY AREA                                 * 53221502
*********************************************************************** 53221802
         SPACE                                                          53222102
SRCHAREA EQU   *                                                 Y02669 53222402
         SR    WORK4,WORK4                                       Y02669 53222702
         L     SACBBASE,DCMADSDS   GET POINTER TO FIRST SACB     Y02669 53223002
CONTSRCH EQU   *                                                        53223302
         TM    DCMASACB,DCMAUSE    DOES SACB DEFINE AN AREA?            53223602
         BNO   STATIC              NO, ANY STATIC DISPLAY TO OVERLAY    53223902
         TM    DCMAFLG1,DCMADISP   AREA CONTAIN DISPLAY?                53224202
         BO    FIRSTARE            YES, LOOK FOR ANOTHER AREA    Y02669 53224502
         TM    DCMADFLG,DCMADD     AREA RESERVED FOR TRACK?      Y02669 53224802
         BO    UPDATE              YES,LOOK AT NEXT              Y02669 53226902
         B     AFOUND              IF ONLY 1 AREA THIS WILL BE 0 Y02669 53227502
FIRSTARE EQU   *                                                        53227802
         TM    DCMADFLG,DCMADD     AREA RESERVED FOR TRACK?      Y02669 53228102
         BO    UPDATE              YES,LOOK AT NEXT              Y02669 53228402
         LTR   WORK4,WORK4         NO, FIRST DEFAULT AREA?       Y02669 53228702
         BZ    FIRST               YES                           Y02669 53229002
CHKNEXTA EQU   *                                                 Y02669 53229302
         CLC   DCMATIME(L'DCMATIME),DCMATIME-DCMACB(WORK4) NO    Y02669 53229602
         BH    UPDATE              IS THIS DISPLAY OLDER?               53229902
FIRST    EQU   *                                                        53230202
         LR    WORK4,SACBBASE      YES                                  53230502
UPDATE   EQU   *                                                        53230802
         ICM   SACBBASE,E7,DCMACBNX+1 POINT TO NEXT SACB         Y02669 53231102
         BNZ   CONTSRCH            CONTINUE SEARCH               Y02669 53231402
         SPACE                                                          53231702
*********************************************************************** 53232002
*     LOOK FOR OLDEST STATIC DISPLAY TO OVERLAY                  Y02669 53232302
*********************************************************************** 53233102
         SPACE                                                          53233502
STATIC   EQU   *                                                        53233902
         LTR   WORK4,WORK4         WAS ANY STATIC DISPLAY FOUND?        53235502
         BZ    MSGSTRM             NO, TRY TO PUT IN MESS STREAM Y02669 53235902
PUTINOLD EQU   *                                                        53236102
         LR    SACBBASE,WORK4      YES, BASE SACB FOR AREA WITH         53236302
*                                       OLDEST DISPLAY                  53236702
AFOUND   EQU   *                                                 Y02669 53237102
         MVC   XASDID(E1),DCMAID   PUT ID OF AREA FOUND IN XSA   Y02669 53237302
         B     D0803D              GO BUILD CSCB FOR DISPLAY     Y02669 53237502
MSGSTRM  EQU   *                                                        53237902
         TM    UCMDISP,UCMDISPE+UCMDISPF MSG ST OR FULL CAPABILITY?     53238302
         BZ    ERR921D             NO, BRANCH TO ERROR ROUTINE   Y02669 53238502
         MVI   XASDID,Z            INDICATE MSG STREAM IN XSA           53238702
         B     D0803D              EXIT                                 53239102
         EJECT                                                          53239502
*********************************************************************** 53239702
*                                                                     * 53239902
*                  STOPTR HANDLING                                    * 53240302
*   ERR - IEE311I PARAMETER MISSING - PT REQUIRES AN OPERAND   @YM2774P 53240502
*   ERR - IEE925I OPERAND FOR CRT ONLY - TARGET IS NON-CRT            * 53240702
*********************************************************************** 53240902
         SPACE  2                                                       53241102
STOPTR   EQU   *                   STOP TRACK COMMAND            Y02669 53241502
         TM    UCMDISP2,UCMDISPK   IS THIS SUBSYSTEM CONSOLE?  @Y02668P 53243503
         BO    ERR921E             YES, BRANCH FOR ERROR       @Y02668P 53243903
         ICM   REG1,E7,XAL+1       R1 PTR BUFFER BEGINNING     @YM2774P 53245903
         BZ    ERR311              PT MUST HAVE AN OPERAND     @YM2774P 53247903
         TM    UCMDISP,UCMDISPC    IS TARGET A CRT?              Y02669 53251403
         BNO   ERR925A             ERR-COMMAND VALID ONLY TO CRT Y02669 53253003
         CLI   XASDID,Z            AREA = Z (INLINE NOT IN AREA)?       53255003
         BE    ERR921D             YES - TRACK CAN'T BE INLINE   Y02669 53257003
         SPACE  2                                                       53259003
         L     RDCMBASE,UCMXB      GET ADDRESS OF RESIDENT DCM   Y02669 53261003
         CLI   XASDID,NULL         AREA NULL?                           53263003
         BE    FINDTRAR            YES, FIND AREA WITH TRACK     Y02669 53265003
         SPACE  2                                                       53267003
*********************************************************************** 53269803
*                                                                     * 53270303
*     SEE IF AREA SPECIFIED HAS SPECIFIED TRACK IN IT                 * 53272803
*  ERR - IEE921I NO TRACK TO STOP - AREA NOT DEFINED BY SACB          * 53275003
*********************************************************************** 53277003
         SPACE  2                                                       53279003
         TM    DCMADFLG,DCMADD     IS THERE A TRACK IN AREA?     Y02669 53281003
         BNO   ERR921C             NO,  BRANCH TO ERROR ROUTINE  Y02669 53283003
         B     PROCESPT            YES                           Y02669 53285003
         EJECT                                                          53286003
*********************************************************************** 53287403
*                                                                     * 53289003
*    LOOK FOR AREA CONTAINING SPECIFIED DYNAMIC DISPLAY               * 53291003
*                                                                     * 53293003
*  ERR - IEE921I NO TRACK TO STOP - NO AREA CONTAINS TRACK DISPLAY    * 53295003
*********************************************************************** 53297003
         SPACE  2                                                       53299003
FINDTRAR EQU   *                                                        53300003
         L     SACBBASE,DCMADSDS   GET FIRST SACB ADDRESS               53301003
CONTINU1 EQU   *                                                        53302003
         TM    DCMASACB,DCMAUSE    DOES SACB DEFINE AN ACTIVE AREA?     53303003
         BNO   ERR921C             NO,  BRANCH TO ERROR ROUTINE  Y02669 53304003
         TM    DCMADFLG,DCMADD     IS THERE A TRACK IN AREA?     Y02669 53305003
         BO    TRFOUND             YES, BRANCH TO STORE AREA ID  Y02669 53306003
         ICM   SACBBASE,E7,DCMACBNX+1 NO, IS THERE ANOTHER SACB?        53307003
         BZ    ERR921C             NO, NO AREA WITH TRACK        Y02669 53308003
         B     CONTINU1            YES, CONTINUE SEARCH                 53309003
TRFOUND  EQU   *                                                 Y02669 53310003
         MVC   XASDID(E1),DCMAID   PUT AREA ID IN XAS                   53311003
PROCESPT EQU   *                                                        53312003
         ST    SACBBASE,XAXSACB    PUT ADDRESS OF SACB IN XSA    Y02669 53313003
         B     D5503D              GO TO IEE5503D                Y02669 53328702
         EJECT                                                          53331102
*********************************************************************** 53331502
*                                                                     * 53331602
*        IN THE CASE OF A TRACK COMMAND, IF AN OUT-OF-LINE DISPLAY    * 53338402
*  IS REQUESTED, A SPECIFIED TARGET AREA (EITHER BY THE 'L' OPERAND   * 53342402
*  OR THE ROUTING CONTROL TABLE) IS CHECKED FOR AVAILABILITY.         * 53344402
*  IF NO AREA IS SPECIFIED, A DEFAULT AREA IS PROVIDED.               * 53346402
*  CERTAIN CONDITIONS ARE THEN SET UP AND APPROPIATE EXIT TAKEN.      * 53348402
*                                                                     * 53352102
*   ERR-IEE925I OPERAND FOR CRT ONLY - TRACK TO NON-CRT               * 53352502
*       IEE921I NEEDS DISPLAY AREA - TRACK TO AREA = Z (IN-LINE)      * 53352902
*                                    TARGET HAS NO DEFINED AREAS      * 53353302
*********************************************************************** 53354102
         SPACE 2                                                        53356102
TRACK    EQU   *                   TRACK COMMAND                        53375702
         TM    UCMDISP2,UCMDISPK   IS THIS SUBSYSTEM CONSOLE?  @Y02668P 53376103
         BO    ERR921E             YES, BRANCH CMD INVALID     @Y02668P 53376503
         TM    UCMDISP,UCMDISPC    IS TARGET CONSOLE A CRT?             53376902
         BZ    ERR925A             NO, BRANCH TO ERROR ROUTINE   Y02669 53396602
         CLI   XASDID,Z            IS AREA = Z?                         53424002
         BE    ERR921D             YES, ERR TR CAN'T GO INLINE   Y02669 53424402
         L     RDCMBASE,UCMXB      INSURE ADDRESSABILITY TO DCM  Y02669 53425402
         CLI   DCMTOPAR,E0         ANY AREAS DEFINED FOR TARGET? Y02669 53426402
         BE    ERR921D             NO, TR NEEDS DISPLAY AREA     Y02669 53428402
         SPACE                                                          53433902
         SR    WORK4,WORK4         INIT FOR BOTTOM-MOST          Y02669 53434302
         ST    SACBBASE,XAXSACB    SAVE SACB BASE OF 'A'         Y02669 53435902
         L     SACBBASE,DCMADSDS   GET POINTER TO FIRST SACB            53436302
CHKFORTR EQU   *                                                 Y02669 53436702
         TM    DCMADFLG,DCMADD     DOES THIS AREA HAVE TRACK?    Y02669 53436802
         BO    TRHERE              YES, BRANCH TO CHECK FURTHER  Y02669 53442602
         TM    DCMAFLG1,DCMADISP   IS THERE DISPLAY IN AREA    @YM4789P 53444602
         BO    NEXTAREA            YES,CHECK NEXT AREA         @YM4789P 53445002
         LTR   WORK4,WORK4         IS THIS AN EMPTY AREA       @YM4793P 53445602
         BNZ   NEXTAREA            NO CONTINUE SEARCH          @YM4793P 53446202
         LR    WORK4,SACBBASE      YES,EMPTY AREA FOR TRACK    @YM4789P 53447202
NEXTAREA EQU   *                                                        53449102
         ICM   SACBBASE,E7,DCMACBNX+1 BASE NEXT SACB             Y02669 53451702
         BZ    RESTBASE            NO MORE SACBS               @ZA29986 53452700
         TM    DCMASACB,DCMAUSE    SACB DEFINE ACTIVE AREA?    @ZA29986 53453300
         BO    CHKFORTR            YES, CONTINUE SEARCH        @ZA29986 53453900
         SPACE  2                                                       53455402
RESTBASE EQU   *                                                 Y02669 53455502
         CLI   XASDID,NULL        WAS AREA SPECIFIED IN COMMAND? Y02669 53456502
         BE    USEMPTY             NO, DEFAULT AVAILABLE?        Y02669 53457502
         L     SACBBASE,XAXSACB    USE 'A' FROM CMND OR DEFAULT  Y02669 53460902
         B     TRSETUP                                           Y02669 53463602
USEMPTY  EQU   *                                                        53464602
         LTR   WORK4,WORK4         IS THIS AREA EMPTY          @YM4789P 53476302
         BZ    INUSE               NO,DISPLAY IN AREA          @YM4789P 53478302
         LR    SACBBASE,WORK4      YES,AREA IS EMPTY           @YM4789P 53478502
         MVC   XASDID(E1),DCMAID   AREA ID IN THE SACB         @YM4789P 53478702
         B     TRSETUP                                         @YM4789P 53478902
INUSE    EQU   *                   DISPLAY IN AREA             @YM4789P 53479302
         L     SACBBASE,DCMADSDS                               @YM4789P 53479602
         MVC   XASDID(E1),DCMAID                               @YM4789P 53479902
         B     TRSETUP                                           Y02669 53480302
         EJECT                                                          53480802
*********************************************************************** 53481302
* SPECIFIED TR ALREADY ON TARGET CONSOLE.  THIS IS AN ERROR           * 53482302
*  ERR - IEE921I DISPLAY ALREADY EXISTS - HOLD FLAG ON                * 53483302
*********************************************************************** 53486302
         SPACE  2                                                       53487302
TRHERE   EQU   *                                                        53488302
         CLI   XASDID,NULL         WAS AN AREA SPECIFIED       @YM4793P 53489102
         BE    TRHERE1             NO, AREA OK                 @YM4793P 53489902
         C     SACBBASE,XAXSACB    IS TR IN AREA SPECIFIED     @YM4793P 53490702
         BNE   ERR921A             NO, ERROR                   @YM4793P 53491502
TRHERE1  EQU   *                                               @YM4793P 53492302
         TM    DCMADFLG,DCMAHOLD   YES, HOLD MODE FLAG ON?       Y02669 53493302
         BNO   TRSETUP             NO, SET UP FOR TRACK COMMAND  Y02669 53494302
         CLC   DCMATRCK,XAXMASK    YES, CHANGING OPTIONS?        Y02669 53495302
         BE    ERR921A             NO, ERROR - CAN'T GET OUT OF        X53496302
                                   HOLD MODE BY OPERATOR ISSUING TR     53497302
         SPACE 2                                                        53508102
*********************************************************************** 53510102
*  RETURN IF ONLY UPDATING ALREADY EXISTING TRACK DISPLAY             * 53510902
*  GOTO IEE0803D IF THIS IS THE INITIAL TRACK REQUEST                 * 53511502
*********************************************************************** 53512102
         SPACE 2                                                        53518002
TRSETUP  EQU   *                                                 Y02669 53520002
         OC    DCMATRCK(E1),XAXMASK  GET NEW OPTIONS FROM XSA    Y02669 53542002
         TM    DCMADFLG,DCMADD    TRACK ALREADY DEFINED IN AREA? Y02669 53544002
         BO    RETURN              YES, ALTER BITS AND RETURN    Y02669 53545702
         OI    DCMADFLG,DCMADD     RESERVE AREA FOR TRACK        Y02669 53547702
         MVC   DCMAUTME(E2),UDEFAULT SET DEFAULT TIME INTERVAL   Y02669 53548102
         LA    WORK4,DCMATECB      GET ADDRESS OF TRACK ECB      Y02669 53549702
         ST    WORK4,XAXSACB       PASS ADDRESS TO IEE0803D      Y02669 53549802
         B     D0803D              EXIT TO CREATE CSCB           Y02669 53550102
         EJECT                                                          53550502
*********************************************************************** 53746802
*                                                                     * 53747102
* FIND AND BASE UCM ENTRY SUBROUTINE                                  * 53747802
*    INPUT - REG1   - CONSOLE ID, RIGHT JUSTIFIED                     * 53748502
*                     (HIGH ORDER BYTES MUST BE ZERO)                 * 53749202
*    OUTPUT         - POINTER TO UCM ENTRY SPECIFIED BY CONSOLE       * 53749902
*                     ID IN REGISTER UCMEBASE                         * 53750602
*    REGISTER USAGE - DESTROYS CONTENTS OF FOLLOWING REGS:            * 53751302
*                     REG0, REG1, UCMEBASE                            * 53752002
*                     R15 IS RETURN REGISTER                          * 53752702
*                                                                     * 53753402
*********************************************************************** 53754102
         SPACE 2                                                        53754802
FINDUCME EQU   *                                                        53755502
         L     UCMEBASE,UCMVEA     POINT TO FIRST ENTRY IN UCM          53756202
         BCTR  REG1,E0             SUBTRACT ONE FROM CONSOLE ID         53756902
         M     REG0,UCMVEZ         MULTIPLY ENTRY SIZE BY REDUCED ID    53757602
         AR    UCMEBASE,REG1       POINT TO DESIRED UCM ENTRY           53758302
         BR    R15                 RETURN TO MAIN LINE                  53759002
         EJECT                                                          53759702
*********************************************************************** 53760402
*                                                                     * 53761102
* FIND AND BASE SACB SUBROUTINE                                       * 53761802
*    GIVEN A PARTICULAR CRT CONSOLE AND A ONE CHARACTER AREA ID       * 53762502
* THIS SUBROUTINE FINDS AND BASES THE SCREEN AREA CONTROL BLOCK       * 53763202
* (SACB) WHICH MATCHES THAT ID.  IF NONE IS FOUND, A ZERO IS          * 53763902
* RETURNED AS THE BASE.                                               * 53764602
*    INPUT -  XASDID   - ONE CHARACTER AREA ID (POINTED TO BY REG2)   * 53765302
*             UCMEBASE - ADDRESS OF UCM ENTRY OF A CRT CONSOLE        * 53766702
*    OUTPUT - SACBBASE - ADDRESS OF SACB WITH MATCHING ID             * 53767402
*                        (ZERO IF NO MATCH)                           * 53768102
*    REGISTER USAGE    - DESTROYS CONTENTS OF FOLLOWING REGS:         * 53768802
*                         SACBBASE, RDCMBASE                          * 53769502
*                         R15 IS RETURN REGISTER                      * 53770202
*                                                                     * 53770902
*********************************************************************** 53771602
         SPACE 2                                                        53772302
FINDSACB EQU   *                                                        53773002
         L     RDCMBASE,UCMXB      GET RESIDENT DCM ADDRESS             53774402
         ICM   SACBBASE,E7,DCMADSDS+1   GET FIRST SACB ADDRESS   Y02669 53775102
         BZ    SACBEXIT                                          Y02669 53775402
CONTINUE EQU   *                                                        53775802
         TM    DCMASACB,DCMAUSE    DOES SACB DEFINE AN AREA?            53777902
         BNO   ENDOSACB            NO, BRANCH TO RETURN                 53778602
         CLC   XASDID,DCMAID       COMPARE PASSED ID AND SACB ID Y02669 53779302
         BCR   EQ,R15              EQUAL? RETURN TO MAIN LINE           53780702
         ICM   SACBBASE,E7,DCMACBNX+1 NOT EQUAL, GET NEXT SACB   Y02669 53781402
         BZ    SACBEXIT            IF NO MORE SACB'S, RETURN     Y02669 53781902
         B     CONTINUE            CONTINUE SEARCH                      53782102
ENDOSACB EQU   *                                                        53782802
         SR    SACBBASE,SACBBASE   INDICATE NO SACB MATCH FOUND         53783502
SACBEXIT EQU   *                                                 Y02669 53783802
         BR    R15                 RETURN TO MAIN LINE                  53784202
         EJECT                                                          53786202
*********************************************************************** 53786502
*                                                                     * 53786802
*                   RELEASE CMS AND LOCAL LOCKS SUBROUTINE            * 53787102
*                                                                     * 53787402
*********************************************************************** 53787702
LOCKSOFF EQU   *                                                        53788202
         STM   RCTBASE,RETURN14,XASAVLOC  SAVE REGS FOR SETLOCK  Y02651 53790202
         SETLOCK RELEASE,TYPE=CMS,RELATED=(LOCKSET)                     53790302
         SETLOCK RELEASE,TYPE=LOCAL,RELATED=(LOCKSET)                   53790402
         LM    RCTBASE,RETURN14,XASAVLOC  RESTORE REGS AFTER     Y02651 53790502
         NI    XASSDS,XFF-XASSDS5       INDICATE LOCKS NOT HELD  Y02651 53790802
         BR    R15                        RETURN TO MAIN LINE    Y02651 53791102
         EJECT                                                          53791602
*********************************************************************** 53797002
*                                                                     * 53797602
*                      SPECIAL JES2 INTERFACE                         * 53798202
*                                                                     * 53798802
*              SVC 34 WILL RETURN TO THE ADDRESS PROVIDED      @YM7238P 53799002
*              IN REGISTER 14. AT THAT TIME, REGISTER 15       @YM7238P 53799202
*              WILL CONTAIN ONE OF THE FOLLOWING RETURN        @YM7238P 53799402
*              CODES                                           @YM7238P 53800302
*                 0   REQUESTED AREA NOT IN USE                @YM7238P 53802402
*                 4   AREA IN USE BY STATIC DISPLAY            @YM7238P 53802702
*                 8   AREA IN USE BY TRACK;DISPLAY MAY NOT     @YM7238P 53803002
*                     BE OVERLAID                              @YM7238P 53803302
*                 12  SPECIFIED CONSOLE NOT SYSGENED, NOT      @YM7238P 53803602
*                     ACTIVE OR NOT A TARGET FOR STATUS        @YM7238P 53803802
*                     DISPLAYS                                 @YM7238P 53804002
*                 16  REQUESTED AREA NOT DEFINED ON SPECIFIED  @YM7238P 53804202
*                     CONSOLE.                                 @YM7238P 53804502
*                                                                     * 53804802
*********************************************************************** 53805402
JES2CODE EQU   *                                                 Y02669 53805602
         OI    XASSDS,XASSDS5          INDICATE LOCKS HELD     @YM4796P 53805802
         L     UCMEBASE,UCMVEL         BASE LAST UCM ENTRY       Y02669 53806002
         CLC   XASCID(E1),UCMID        ID HIGHER THAN HIGHEST    Y02669 53806302
*                                      VALID CONSOLE ID?         Y02669 53806602
         BNH   VALIDCON                NO, CONSOLE ID IS VALID   Y02669 53807802
         LA    WORK4,BADCONSL          YES, CONSOLE ID TOO HIGH  Y02669 53808402
         B     JES2EXIT                RETURN WITH 12 ERROR CODE Y02669 53809002
VALIDCON EQU   *                                                 Y02669 53809602
         SR    REG1,REG1                                         Y02669 53810802
         IC    REG1,XASCID             GET TARGET CONSOLE ID     Y02669 53811202
         BAL   R15,FINDUCME            FIND ITS UCME             Y02669 53812602
         TM    UCMATR,UCMUF            IS CONSOLE ACTIVE?        Y02669 53813202
         BO    ACTIVEID                YES, CONSOLE IS ACTIVE    Y02669 53813502
         LA    WORK4,BADCONSL          NO, CONSOLE NOT ACTIVE    Y02669 53814502
         B     JES2EXIT                RETURN WITH 12 ERROR CODE Y02669 53815502
ACTIVEID EQU   *                                                 Y02669 53816502
         TM    UCMDISP,UCMDISPC        IS TARGET CONSOLE A CRT?  Y02669 53817502
         BO    CRTCONSL                YES                       Y02669 53818502
         B     OKAREA                  NO, RETURN WITH 0 RETURN  Y02669 53819502
*                                      CODE                      Y02669 53820502
CRTCONSL EQU   *                                                 Y02669 53821502
         CLI   XASDID,Z               IS THE AREA IN LINE Z    @YM7238P 53830602
         BNE   NOTZ                   YES,CHECK TYPE OF CONSL  @YM7238P 53831002
         TM    UCMDISP,UCMDISPF       IS THIS AN MS CONSOLE    @YM7238P 53831402
         BO    OKAREA                 YES,BRANCH Z IS VALID    @YM7238P 53831802
         TM    UCMDISP,UCMDISPE       IS THIS AN FC CONSOLE    @YM7238P 53832202
         BO    FCTEST1                YES,BRANCH CK IN-LINE    @YM7238P 53834202
         B     RTCODE16               BRANCH SD CONSL INVALID  @YM7238P 53836802
NOTZ     EQU   *                                               @YM7238P 53838802
         TM    UCMDISP,UCMDISPG       IS THIS SD CONSOLE       @YM7238P 53839402
         BO    OKCONSL                YES,BR CK FOR VALID AREA @YM7238P 53840002
         TM    UCMDISP,UCMDISPE       IS THIS FC CONSOLE       @YM7238P 53840602
         BO    FCTEST2                YES,BR CK CMD SOURCE     @YM7238P 53841202
         B     RTCODE16               BRANCH MS CONSL INVALID  @YM7238P 53841802
FCTEST1  CLC   XASCID(E1),XAU         DOES SOURCE=TARGET CONSL @YM7238P 53842402
         BE    OKAREA                 YES,BRANCH IN-LINE VALID @YM7238P 53843002
         B     RTCODE12               NO,CAN NOT ROUTE TO FC   @YM7238P 53843202
FCTEST2  CLC   XASCID(E1),XAU         DOES SOURCE=TARGET CONSL @YM7238P 53843402
         BE    OKCONSL                YES,BR OUT-OF-LINE VALID @YM7238P 53843602
RTCODE12 EQU   *                                               @YM7238P 53843802
         LA    WORK4,BADCONSL         RETURN CODE 12           @YM7238P 53844002
         B     JES2EXIT                                        @YM7238P 53844202
OKCONSL  EQU   *                                                 Y02669 53845002
         BAL   R15,FINDSACB            FIND AREA'S SACB          Y02669 53845502
         LTR   SACBBASE,SACBBASE       IS SPECIFIED AREA DEFINED?Y02669 53846002
         BNZ   AREAIS                  YES, AREA EXISTS ON       Y02669 53847002
*                                      CONSOLE                   Y02669 53849902
RTCODE16 EQU   *                                               @YM7238P 53850902
         LA    WORK4,BADAREA           NO, AREA NOT DEFINED TO   Y02669 53852802
*                                      CRT                       Y02669 53854802
         B     JES2EXIT                RETURN WITH 16 ERROR CODE Y02669 53857702
AREAIS   EQU   *                                                 Y02669 53858702
         TM    DCMADFLG,DCMADD         TRACK ALREADY IN AREA?    Y02669 53862602
         BZ    NOTRACK                 NO                        Y02669 53864602
         LA    WORK4,TRINAREA          YES, AREA CONTAINS TRACK  Y02669 53867502
         B     JES2EXIT                RETURN WITH 8 ERROR CODE  Y02669 53869502
NOTRACK  EQU   *                                                 Y02669 53872402
         TM    DCMAFLG1,DCMADISP       AREA CONTAIN DISPLAY?     Y02669 53874402
         BZ    OKAREA                  NO                        Y02669 53877302
         LA    WORK4,AREANUSE          YES, AREA CONTAINS        Y02669 53879302
*                                      ANOTHER DISPLAY           Y02669 53882202
         B     JES2EXIT                RETURN WITH 4 ERROR CODE  Y02669 53886202
OKAREA   EQU   *                                                 Y02669 53888202
         LA    WORK4,OKCCA             CONSOLE & AREA VALID      Y02669 53890202
JES2EXIT EQU   *                                                 Y02669 53892202
         BAL   R15,LOCKSOFF            HAVE LOCKS RELEASED       Y02669 53896202
         LR    R15,WORK4               LOAD RETURN CODE          Y02669 53898202
         LM    REG0,RETURN14,XASAVSTD  RESTORE JES2 REGISTERS    Y02669 53900202
         BR    RETURN14                RETURN TO JES2            Y02669 53904202
         EJECT                                                          53914203
*********************************************************************** 53916203
*                                                                     * 53917203
*                             EXITS                                   * 53919303
*                                                                     * 53923303
*********************************************************************** 53925303
RETURN   EQU   *                                                 Y02669 53927303
         BAL   R15,LOCKSOFF       RELEASE LOCKS HELD             Y02651 53929303
         BR    RETURN14           RETURN TO SYSTEM               Y02669 53931303
         SPACE 2                                                        53935303
D5503D   EQU   *                                                 Y02669 53937303
         L     R15,VCON5503       EXIT TO 2ND LOAD OF STOPTR     Y02669 53939303
         BR    R15                                               Y02669 53941303
         SPACE 2                                                        53943303
D2903D   EQU   *                                                 Y02669 53946303
         L     R15,VCON2903       EXIT TO DISPLAY REQUEST MOD    Y02669 53949303
         BR    R15                                               Y02669 53951303
         SPACE 2                                                        53953303
D6703D   EQU   *                                                 Y02669 53956403
         L     R15,VCON6703       EXIT TO HANDLE CONTROL COMMAND Y02669 53958403
         BR    R15                FOR GRAPHICS CONSOLES          Y02669 53960403
         SPACE 2                                                        53960604
D9403D   EQU   *                                               @Z40LPTA 53960804
         MVI   XAN,D              RE-SET TO DISPLAY VERB       @Z40LPTA 53961204
         L     R15,VCON9403       EXIT TO MSS CMND PROCESSING  @Z40LPTA 53961604
         BR    R15                                             @Z40LPTA 53962004
         SPACE 2                                                        53962403
D0803D   EQU   *                                                        53966403
         BAL   R15,LOCKSOFF       RELEASE LOCKS HELD             Y02651 53968403
         OI    XASSDS,XASSDS1     INDICATE STATUS DISPLAY-MEANS  Y02669 53970403
*                                 SOMETHING IN XASCID, XASDID    Y02669 53972403
         CLI   XAN,DR             IF THIS IS A DISPLAY REQUEST   Y02669 53974403
         BE    D2903D             GO TO IEE2903D, ELSE           Y02669 53974904
         CLI   XAN,D38            THIS A D 3850 COMMAND?       @Z40LPTA 53975404
         BE    D9403D             GO TO IEE9403D               @Z40LPTA 53976404
         L     R15,VCON0803       GO BUILD CSCB                  Y02669 53980403
         BR    R15                                               Y02669 53982403
         EJECT                                                          53984403
*********************************************************************** 53986403
*                                                                     * 53988403
*                          ERROR CODES                                * 53993502
*   XAE = MAJOR ERROR CODE FOR IEE5603D                               * 54030602
*   XASTSAVE = MINOR CODE FOR IEE5903D                                * 54067702
*   XASOPTR (XASTSAVE+1) = OPERAND POINTER FOR IEE5603D & IEE5903D    * 54104802
*                                                                     * 54141902
*********************************************************************** 54179002
         SPACE 2                                                        54216102
*********************************************************************** 54218102
*              IEE156I INVALID OPERAND                                * 54226102
*********************************************************************** 54236102
ERR156A  EQU   *                                                        54246102
         CLC   E0(E6,REG1),LISTC   ADDITIONAL BAD OPERAND?       YM1920 54246402
         BNE   BADAOP              NO, LIST NOT SPECIFIED        YM1920 54246702
         LA    REG1,E5(REG1)       YES, POINT TO INFO AFTER LIST YM1920 54247102
BADAOP   EQU   *                                                 YM1920 54247602
         LR    OPPTR,REG1          SET UP POINTER                Y02669 54248102
ERR156   EQU   *                                                 Y02669 54253202
         MVI   XAE,MSG156          MSG CODE-IEE156I INVALID OP   Y02669 54290302
         ST    OPPTR,XASTSAVE      SAVE POINTER TO BAD OPERAND   Y02669 54300302
         B     D5603D              BRANCH TO ERROR EXIT          Y02669 54327402
         SPACE                                                          54364502
*********************************************************************** 54366502
*              IEE345I AUTHORITY INVALID                              * 54374502
*********************************************************************** 54384502
ERR345   EQU   *                                                 Y02669 54401602
         MVI   XAE,MSG345          MSG CODE-IEE345 AUTH INVALID  Y02669 54438702
         B     STOREOP             BRANCH TO ERROR EXIT          Y02669 54475802
         SPACE                                                          54512902
*********************************************************************** 54514902
*              IEE921I CM OP REJECTED                                 * 54522902
*                      DISPLAY ALREADY EXISTS                         * 54526902
*                      DISPLAY AREA BUSY                              * 54530902
*                      NO TRACK TO STOP                               * 54534902
*                      NEEDS DISPLAY AREA                             * 54538902
*                      SUBSYSTEM CONSOLE                       @Y02668P 54542903
*********************************************************************** 54546902
ERR921A  EQU   *                                                        54550002
         MVI   XASTSAVE,MSG921A    2ND CODE-DISP ALREADY EXISTS  Y02669 54560002
         B     ERR921              BRANCH TO GET MAJOR CODE      Y02669 54570002
         SPACE                                                          54572002
ERR921B  EQU   *                                                 Y02669 54580002
         MVI   XASTSAVE,MSG921B    2ND CODE-DISPLAY AREA BUSY    Y02669 54590002
         B     ERR921              BRANCH TO GET MAJOR CODE      Y02669 54592002
         SPACE                                                          54592402
ERR921C  EQU   *                                                 Y02669 54594002
         MVI   XASTSAVE,MSG921C    2ND CODE-NO TRACK TO STOP     Y02669 54596002
         B     ERR921              BRANCH TO GET MAJOR CODE      Y02669 54598002
ERR921E  EQU   *                                               @Y02668P 54598103
         MVI   XASTSAVE,MSG921E    2ND CODE-CC SUBSYSTEM       @Y02668P 54599203
         B     ERR921              CONSOLE                     @Y02668P 54599903
         SPACE                                                          54600903
ERR921D  EQU   *                                                 Y02669 54601903
         MVI   XASTSAVE,MSG921D    2ND CODE-NEEDS DISPLAY AREA   Y02669 54602903
ERR921   EQU   *                                                 Y02669 54603903
         MVC   XASOPTR(E3),XAL+E1  MOVE OPERAND POINTER IN       Y02669 54604903
         MVI   XAE,MSG921          MSG CODE-IEE921I CM OP REJ    Y02669 54605903
         B     D5603D              BRANCH TO ERROR EXIT          Y02669 54606903
         SPACE                                                          54607903
*********************************************************************** 54609902
*              IEE925I OPERAND                                        * 54611002
*                      FOR CRT ONLY                                   * 54616002
*********************************************************************** 54621402
ERR925A  EQU   *                                                 Y02669 54622102
         MVC   XASOPTR(E3),XAL+E1  MOVE OPERAND POINTER IN       Y02669 54632102
         MVI   XASTSAVE,MSG925A    2ND CODE-FOR CRT ONLY         Y02669 54633202
         MVI   XAE,MSG925          MSG CODE-IEE925I OPERAND      Y02669 54643202
         B     D5603D                                            Y02669 54653202
         SPACE                                                          54663202
*********************************************************************** 54666702
*              IEE926I L OPERAND INVALID                              * 54668702
*                      DYNAMIC DISPLAY IN AREA                        * 54669702
*********************************************************************** 54670802
ERR926D  EQU   *                                                 Y02669 54670902
         MVI   XASTSAVE,MSG926D    2ND CODE-DYNAMIC DISP IN AREA Y02669 54671002
         MVI   XAE,MSG926          MSG CODE-IEE926I L OP INVALID Y02669 54676602
         B     STOREOP                                           Y02669 54682002
         SPACE                                                          54682402
*********************************************************************** 54682702
*              IEE926I L OPERAND INVALID                              * 54688302
*                      CCA NOT AN AREA                                * 54693302
*                      CC NOT A CONSOLE                               * 54698302
*                      CC FULL CAPABILITY                             * 54703302
*                      CC SUBSYSTEM CONSOLE                    @Y02668P 54706303
*********************************************************************** 54710702
ERR926A  EQU   *                                                 Y02669 54716302
         MVI   XASTSAVE,MSG926A    2ND CODE-CCA NOT AN AREA      Y02669 54721902
         B     ERR926              BRANCH TO GET MAJOR CODE      Y02669 54727502
         SPACE                                                          54733102
ERR926B  EQU   *                                                 Y02669 54738702
         MVI   XASTSAVE,MSG926B    2ND CODE-CC NOT A CONSOLE     Y02669 54744302
         BCTR  OPPTR,E0            SET CURSOR POINTER TO         Y02669 54746302
         BCTR  OPPTR,E0            BEGINNING OF OPERAND          Y02669 54748302
         B     ERR926              BRANCH TO GET MAJOR CODE      Y02669 54749902
ERR926E  EQU   *                                               @Y02668P 54750803
         L     OPPTR,XASTSAVE      CURSOR PTR AFTER L=         @Y02668P 54751703
         MVI   XASTSAVE,MSG926E    2ND-CODE-CC OR CCA          @Y02668PX54752603
                                   SUBSYSTEM CONSOLE           @Y02668P 54753503
         B     ERR926                                          @Y02668P 54754403
         SPACE                                                          54755502
ERR926C  EQU   *                                                 Y02669 54761102
         MVI   XASTSAVE,MSG926C    2ND CODE-CC FULL CAPABILITY   Y02669 54766702
ERR926   EQU   *                                                 Y02669 54816702
         MVI   XAE,MSG926          MSG CODE-IEE926I L OP INVALID Y02669 54866702
         B     STOREOP                                           Y02669 54867102
         SPACE                                                          54868702
*********************************************************************** 54876702
*              IEE927I REQUEST AMBIGIOUS                         YM1557 54886702
*                      SPECIFY L OPERAND                         YM1557 54896702
*********************************************************************** 54906702
ERR927   EQU   *                                                 YM1557 54908702
         MVI   XASTSAVE,MSG927A    2ND CODE- SPECIFY L OPERAND   YM1557 54910702
         MVI   XAE,MSG927          MSG CODE-IEE927I REQUEST      YM1557 54912702
         BCTR  OPPTR,E0            POINT INVALID OP              Y02669 54913302
         BCTR  OPPTR,E0            POINTER TO L                  Y02669 54913902
STOREOP  EQU   *                                                 Y02669 54914702
         STCM  OPPTR,E7,XASOPTR    SAVE CURSOR POINTER           Y02669 54915102
         SPACE 3                                                        54916702
*********************************************************************** 54966702
*                                                                     * 55016702
*                         ERROR EXITS                                 * 55066702
*                                                                     * 55116702
*********************************************************************** 55166702
D5603D   EQU   *                                                 Y02669 55216702
         L     R15,VCON5603        GET ADDR OF MSG MOD IEE5603D  Y02669 55266702
         BR    R15                                               Y02669 55316702
         SPACE  2                                                       55366702
ERR305   EQU   *                                                 YM1917 55416702
         MVI   XAE,MSG305          MSG CODE-IEE305I INVALID CMD  YM1917 55417702
         B     D0503D                                            YM1917 55418702
         SPACE                                                          55419702
ERR311   EQU   *                                                 YM1917 55420702
         MVI   XAE,MSG311          MSG CODE-IEE311I PARM MISSING YM1917 55421702
D0503D   EQU   *                                                 YM1917 55422702
         BAL   R15,LOCKSOFF        RELEASE LOCKS HELD            YM1917 55426702
         L     R15,VCON0503        BRANCH TO IEE0503D TO ISSUE   YM1917 55516702
         BR    R15                                               YM1917 56516702
         EJECT                                                          58800001
*********************************************************************** 58900001
*                                                                     * 59000001
*                             CONSTANTS                               * 59100001
*                                                                     * 59200001
*********************************************************************** 59300001
         SPACE 2                                                        59400001
ZERO     DC    H'0'                CONSTANT                      Y02669 59500002
ZEROES   DC    F'0'                CONSTANT                      Y02669 59510002
C1       DC    X'01'                                             Y02669 59550002
C2       DC    H'2'                CONSTANT                    @YM5459P 59620002
C3       DC    H'3'                CONSTANT                             59700002
C4       DC    H'4'                                                     59750002
F0F0     DC    C'00'               INVALID CONSOLE ID COMPARE    Y02669 59800002
UDEFAULT DC    H'0030'             UTME DEFAULT OF 30 SECONDS    Y02669 59850002
CONSOLES DC    C'CONSOLES'         CONSOLES OPERAND FOR COMPARE         60000001
DUMP     DC    C'DUMP'             DUMP OPERAND FOR COMPARE    @G33CPMR 60050033
DMN      DC    C'DMN'              DMN OPERAND FOR COMPARE     @G33CPMR 60070033
CCOMMAK  DC    C'C,K'              C,K OPERAND FOR COMPARE       YM1916 60100002
LEQUALS  DC    C'L='               INPUT FOR IEEBUFSC            Y02669 60250002
LIST     DC    C',LIST '           COMPARE FOR LIST OPERAND      Y02669 60254002
LISTC    DC    C',LIST,'           COMPARE FOR ADDITIONAL OPER   YM1920 60256002
JUSTL    DC    C',L '              COMPARE FOR SHORT L FOR LIST  Y02669 60258002
JOCHAR   DC    C'JO'               COMPARE FOR BEGINNING OF JOBS Y02669 60264002
DCBLANK  DC    C'C '               C OPERAND FOR D CONSOLES     @YM4791 60274002
CDCHAR   DC    C'C,D'              COMPARE FOR D C,D           @Y02668P 60284003
NCCHAR   DC    C'N,'               COMPARE FOR K N,PFK         @ZA12152 60292033
         SPACE                                                          60300001
*********************************************************************** 60350002
*                                                                     * 60360002
*                     MODULE NAMES FOR BRANCHES                       * 60370002
*                                                                     * 60380002
*********************************************************************** 60390002
         SPACE  2                                                       60440002
VCON2903 DC    V(IEE2903D)         DISPLAY REQUESTS              Y02669 60600002
VCON6703 DC    V(IEE6703D)         CONTROL COMMAND - GRAPHICS    Y02669 60610002
VCON5603 DC    V(IEE5603D)         ROUTING MESSAGE MODULE        Y02669 61000002
VCON0803 DC    V(IEE0803D)         CSCB CREATION ROUTINE         Y02669 61060002
VCON5503 DC    V(IEE5503D)         STOPTR HANDLER, SECOND LOAD   Y02669 61080002
VCON0503 DC    V(IEE0503D)         SVC 34 MESSAGE MODULE         Y02669 61082002
VCON9403 DC    V(IEE9403D)         MSS INTERFACE MODULE        @Z40LPTA 61086004
         SPACE  2                                                       61090002
*********************************************************************** 61130002
*                                                                     * 61180002
*                        MAINTAINANCE AREA                            * 61230002
*                                                                     * 61280002
*********************************************************************** 61330002
         SPACE                                                          61380002
PATCH    DC    5CL25'** IEE7503D PATCH AREA **'                @ZA29986 61430000
         EJECT                                                          61480000
         IEFPTRS                                                        64430003
         EJECT                                                          67500001
DXSA     DSECT                                                          67600001
         IEEXSA                                                         67700001
         EJECT                                                          69500001
         IEERDCM                                                        69700002
         EJECT                                                          69800001
DRCT     DSECT                                                          69900001
         IEECVMAP RCT                                                   70000001
         EJECT                                                          70100001
         IEECUCM FORMAT=NEW                                             70300002
         EJECT                                                          70400001
DCVT     DSECT                                                          70500001
         CVT                                                            70600001
         EJECT                                                          71150002
         IHAPSA                                                         71200002
         END                                                            71250002
./  ADD  SSI=33200982,NAME=IEE7703D
         TITLE 'IEE7703D SVC 34 K V COMMAND '                           01200002
*********************************************************************** 02200001
*                                                                     * 02250002
*   MODULE NAME         =      IEE7703D                         Y02669* 02300002
*                                                                     * 02350002
*   DESCRIPTIVE NAME    =      CONTROL VARY (K V) COMMAND       Y02669* 02360002
*                              PROCESSOR                        Y02669* 02362002
*                                                                     * 02370002
*   COPYRIGHT           =      N/A                              Y02669* 02380002
*                                                                     * 02390002
*   STATUS              =      01 - UPDATE FOR VS/2 RELEASE 2   Y02669* 02392002
*                                                                     * 02394002
*   FUNCTION            =      TO VALIDITY CHECK AND PROCESS    Y02669* 02396002
*                              THE K V (CONTROL VARY) COMMAND.  Y02669* 02396102
*                                                                     * 02397202
*      OPERATION        =      THE COMMAND IS FIRST VALIDITY    Y02669* 02398002
*                              CHECKED:  K  V,USE=              Y02669* 02398102
*                              IF INVALID 'IEE156I INVALID      Y02669* 02398202
*                              OPERAND' IS ISSUED.              Y02669* 02399402
*                              THEN THE PARAMETERS ARE          Y02669* 02399802
*                              PROCESSED:                       Y02669* 02401002
*                              THE TARGET CONSOLE IS VARIED TO: Y02669* 02402402
*                               SD - MONITOR ONLY STATUS        Y02669* 02403502
*                                    DISPLAYS (RESULT OF TRACK  Y02669* 02404602
*                                    AND DISPLAY COMMANDS)      Y02669* 02405702
*                               FC - FULL CAPABILITY INPUT/     Y02669* 02407902
*                                    OUTPUT MODE                Y02669* 02409002
*                               MS - MONITOR THE DISPLAY OF     Y02669* 02409402
*                                    NORMAL OPERATOR MASSAGES   Y02669* 02411202
*                              AND THE PROPER BITS ARE SET IN   Y02669* 02411602
*                              THE UCME AND RDCM ACCORDINGLY.   Y02669* 02412602
*                                                                     * 02414202
*                              IF NECESSARY, DIDOCS IS POSTED   Y02669* 02414602
*                              TO COMPLETE THE PROCESSING.      Y02669* 02415002
*                                                                     * 02415402
*   NOTES                                                       Y02669* 02415802
*                                                                     * 02416402
*      CHARACTER CODE                                           Y02669* 02417402
*       DEPENDENCIES    =      ANY CHARACTER CODE OTHER THAN    Y02669* 02418402
*                              EBCDIC WILL REQUIRE REASSEMBLY   Y02669* 02420402
*                              OF THIS MODULE.                  Y02669* 02421402
*                              NOTE: THIS MODULE USES CHARACTER Y02669* 02422702
*                              REPRESENTATION FOR COMMA.        Y02669* 02423302
*                                                                     * 02423902
*      DEPENDENCIES     =      IEE7503D WILL VERIFY THAT ALL    Y02669* 02424702
*                              TARGET CONSOLES ARE GRAPHICS.    Y02669* 02424802
*                                                                     * 02425802
*      RESTRICTIONS     =      THE COMMAND IS INVALID IF:       Y02669* 02428102
*                              THE TARGET CONSOLE IS THE MASTER Y02669* 02429102
*                              THE TARGET CONSOLE IS A 2250     Y02669* 02430102
*                              FC ISSUED FOR OUTPUT-ONLY DEVICE Y02669* 02431602
*                              MS ISSUED WITHOUT PAPER CONSOLE  Y02669* 02432602
*                              ON-LINE                          Y02669* 02433602
*                                                                     * 02434902
*                              THE COMMAND IS APPLICABLE ONLY   Y02669* 02435902
*                              FOR A 2260 0R 3270.              Y02669* 02436902
*                                                                     * 02437902
*                              ONLY A FC CONSOLE CAN K V ITSELF Y02669* 02438902
*                              AND ONLY IF THERE WILL STILL BE  Y02669* 02439902
*                              AN INPUT CONSOLE AVAILABLE.      Y02669* 02440902
*                                                                     * 02441902
*      REGISTER                                                 Y02669* 02442902
*       CONVENTIONS     =      NONE                             Y02669* 02443902
*                                                                     * 02444902
*      PATCH-LABEL      =      PATCH                            Y02669* 02445902
*                                                                     * 02449902
*   MODULE TYPE         =      CSECT                            Y02669* 02459902
*                                                                     * 02461902
*      PROCESSOR        =      N/A                              Y02669* 02469902
*                                                                     * 02471902
*      MODULE SIZE      =      X'19D' + X'48' PATCH             Y02669* 02479902
*                                                                     * 02481902
*      ATTRIBUTES       =      REENTRANT, REFRESHABLE, KEY 0,   Y02669* 02489902
*                              SUPERVISOR MODE, PAGED LPA       Y02669* 02497002
*                                                                     * 02498202
*   ENTRY POINT         =      IEE7703D FROM IEE6703D           Y02669* 02499402
*      PURPOSE          =      TO PROCESS THE K V COMMAND       Y02669* 02500602
*                              FOR CRT DEVICES ONLY             Y02669* 02501002
*      LINKAGE          =      BRANCH                           Y02669* 02501802
*      INPUT DATA       =      REG 2 POINTS TO XSA              Y02669* 02503002
*                                XAS HAS LOCATION ROUTING INFO  Y02669* 02504202
*                                    XASCID - CONSOLE ID OR XAU Y02669* 02504602
*                                    XASDID - AREA ID           Y02669* 02505002
*                                    XASSDS5 - ON LOCKS HELD    Y02651* 02506202
*                                XAU CONTAINS ISSUING CONSOLE IDY02669* 02508802
*                                XAL POINTS TO THE OPERANDS     Y02669* 02510002
*                              REG 14 CONTAINS RETURN ADDRESS   Y02669* 02511202
*                                                                     * 02512402
*      REGISTERS SAVED  =      REG 14 IS SAVED IN XSA. (XAP)    Y02669* 02513602
*                              REGISTERS 11 - 14 ARE SAVED      Y02651* 02513902
*                              BEFORE ISSUING SETLOCK AT        Y02651* 02514202
*                              LOCKSOFF.                        Y02651* 02514502
*                                                                     * 02514802
*      REGISTER CONTENTS                                        Y02669* 02516002
*      DURING PROCESSING=      R0    WORK REG                   Y02669* 02517202
*                              R1    WORK REG                   Y02669* 02518402
*                              R2    XSA BASE REG               Y02669* 02519602
*                              R3    UNUSED                     Y02669* 02520802
*                              R4    OPERAND POINTER            Y02669* 02522002
*                              R5    UNUSED                     Y02669* 02523202
*                              R6    UNUSED                     Y02669* 02524402
*                              R7    UNUSED                     Y02669* 02525602
*                              R8    UCME BASE REG              Y02669* 02526802
*                              R9    UNUSED                     Y02669* 02528002
*                              R10   RESIDENT DCM BASE REG      Y02669* 02529202
*                              R11   UNUSED                     Y02669* 02530402
*                              R12   UCM BASE REG               Y02669* 02531602
*                              R13   MODULE BASE REG            Y02669* 02532802
*                              R14   RETURN REG                 Y02669* 02534002
*                              R15   BRANCH REG                 Y02669* 02535202
*      REGISTERS                                                Y02669* 02536402
*       RESTORED        =      R14 RESTORED AT LABEL RETURN1    Y02669* 02537602
*                              REGISTERS 11 - 14 ARE RESTORED   Y02651* 02537902
*                              AFTER ISSUING SETLOCK AT         Y02651* 02538202
*                              LOCKSOFF.                        Y02651* 02538502
*                                                                     * 02538802
*  *  *  *  *  *  *  *  *  *  *  *  *  *  *  *  *  *  *  *  *  *  *  *  02540002
*                                                                     * 02541202
**  EXIT - NORMAL       =      RETURN FROM RETURN1 -> RETURN    Y02669* 02542402
*      CONDITIONS       =      IF NO PROCESSING IS NECESSARY    Y02669* 02543602
*                              FOR MS OR SD, I.E. THE CONSOLE   Y02669* 02544802
*                              IS ALREADY IN THE DESIRED STATE. Y02669* 02546002
*      OUTPUT DATA      =      CMS AND LOCAL LOCKS RELEASED     Y02651* 02548202
*                              REG 2 POINTS TO XSA              Y02669* 02548602
*                                 XASSDS5 - OFF LOCKS RELEASED  Y02651* 02549002
*      RETURN CODES     =      NONE                             Y02669* 02550202
*                                                                     * 02552202
*  *  *  *  *  *  *  *  *  *  *  *  *  *  *  *  *  *  *  *  *  *  *  *  02552602
*                                                                     * 02553202
**  EXIT - NORMAL       =      POST DIDOCS & RETURN VIA BR R14  Y02669* 02555202
*                              FROM SETPOST -> RETURN           Y02669* 02555602
*      CONDITIONS       =      TO HAVE THE REQUEST FULFILLED    Y02669* 02557202
*                              BY DIDOCS                        Y02669* 02560202
*                              AFTER RELEASING THE LOCKS        Y02651* 02568002
*                              POST UCMECB (POSTCODE = X'FD')   Y02669* 02571002
*                              FOR DIDOCS PROCESSING AND        Y02669* 02574002
*                              RETURN VIA BR 14.                Y02669* 02577002
*      OUTPUT DATA      =      PROPER BITS SET IN UCM ENTRY TO  Y02669* 02580002
*                              INDICATE REQUESTED CONSOLE STATE Y02669* 02583002
*                                SD - UCMDISP = UCMDISPG  X'02' Y02669* 02586002
*                                               UCMDISPD  X'10' Y02669* 02589002
*                                     UCMATR = UCMIF X'40'(OFF) Y02669* 02591002
*                                     UCMSDS5 = UCMSDS5G  X'02' Y02669* 02592002
*                                MS - UCMDISP = UCMDISPF  X'04' Y02669* 02595002
*                                               UCMDISPD  X'10' Y02669* 02598002
*                                     UCMSDS5 = UCMSDS5G  X'02' Y02669* 02601002
*                                     UCMATR = UCMIF X'40'(OFF) Y02669* 02603002
*                                FC - UCMDISP = UCMDISPE  X'08' Y02669* 02604002
*                                     UCMATR = UCMIF      X'40' Y02669* 02607002
*                                     UCMDISP = UCMDISPD  (OFF) Y02669* 02609102
*                                             = UCMDISPF  (OFF) Y02669* 02609502
*                                             = UCMDISPG  (OFF) Y02669* 02609702
*                                     UCMSDS5 = UCMSDS5G  (OFF) Y02669* 02613002
*                              AND BITS SET IN DCM INDICATING   Y02669* 02616002
*                                K V COMMAND                    Y02669* 02625002
*                                     DCMR3FLG = DCMKVIP        Y02669* 02628002
*                                AND CHANGING STATUS            Y02669* 02631002
*                                     DCMR3FLG = DCMSTSWT.      Y02669* 02634002
*                                REINIT WTO HEADERS TO SYSGEN   Y02669* 02637002
*                                VALUE (HARDCOPY & JOBNAME)     Y02669* 02640002
*                                     UCMDISP2 = UCMDISPI (OFF) Y02669* 02643002
*                                                UCMDISPJ (OFF) Y02669* 02646002
*                              REG 2 POINTS TO XSA              Y02669* 02652002
*                                XASSDS5 - OFF LOCKS RELEASED   Y02651* 02655002
*      RETURN CODES     =      NONE                             Y02669* 02658002
*                                                                     * 02661002
*  *  *  *  *  *  *  *  *  *  *  *  *  *  *  *  *  *  *  *  *  *  *  *  02667002
*                                                                     * 02670002
**  EXIT - ERROR        =      BRANCH TO IEE5603D FROM D5603D   Y02669* 02673002
*      CONDITIONS       =      TO ISSUE MESSAGES FOR:           Y02669* 02676002
*                                INVALID OPERAND(S)             Y02669* 02679002
*                                TARGET CONSOLE MASTER OR 2250  Y02669* 02682002
*                                FC ISSUED FOR OUTPUT ONLY      Y02669* 02685002
*                                MS ISSUED WHEN NO PAPER CONSOLEY02669* 02688002
*      OUTPUT DATA      =      REG 2 POINTS TO XSA CONTAINING   Y02669* 02691002
*                              ERROR CODES FOR IEE5603D:        Y02669* 02694002
*                              XAE CONTAINS THE MESSAGE INDEX   Y02669* 02697002
*                                X'04' - IEE156I INVALID        Y02669* 02700002
*                                        OPERAND                Y02669* 02703002
*                                X'08' - IEE345I AUTHORITY      Y02669* 02706002
*                                        INVALID                Y02669* 02709002
*                                X'09' - IEE921I CM OP          Y02669* 02712002
*                                        REJECTED               Y02669* 02715002
*                                X'0C' - IEE926I L=CCA OPERAND  Y02669* 02718002
*                                        INVALID                Y02669* 02721002
*                              XASTSAVE  CONTAINS THE SECONDARY Y02669* 02724002
*                                        THE MESSAGE INDEX      Y02669* 02727002
*                                X'1C' - DEVICE NOT SUPPORTED   Y02669* 02730002
*                                        (IEE921I)              Y02669* 02733002
*                                X'1D' - OUTPUT ONLY            Y02669* 02736002
*                                        (IEE926I)              Y02669* 02739002
*                              XAS CONTAINS TARGET INFO (INPUT) Y02669* 02745002
*                                XASSDS5 - STILL ON LOCKS HELD  Y02651* 02748002
*      RETURN CODES     =      NONE                             Y02669* 02751002
*                                                                     * 02754002
*  *  *  *  *  *  *  *  *  *  *  *  *  *  *  *  *  *  *  *  *  *  *  *  02757002
*                                                                     * 02760002
*   EXTERNAL                                                    Y02669* 02763002
*    REFERENCES                                                 Y02669* 02766002
*                                                                     * 02769002
*      ROUTINES         =      POSTS DIDOCS                     Y02669* 02772002
*                              BRANCHES TO IEE5603D             Y02669* 02775002
*                                                                     * 02777002
*      DATA AREAS       =      NONE                             Y02669* 02781002
*                                                                     * 02784002
*      CONTROL BLOCKS   =      CVT      R - ADDRESS UCM         Y02669* 02787002
*                              IEEXSA   R - PARM LIST & L=CCA   Y02669* 02790002
*                                       W - ERR MESSAGE CODES   Y02669* 02793002
*                              IEECUCM  R - CONSOLE STATUS      Y02669* 02796002
*                                       W - CHANGED STATUS BITS Y02669* 02799002
*                              IEERDCM  R - CONSOLE DEVICE TYPE Y02669* 02802002
*                                       W - SHOW K V & CHANGE   Y02669* 02805002
*                              IHAPSA   NECESSARY FOR SETLOCK   Y02651* 02808002
*                                                                     * 02810402
*      TABLES           =      NONE                             Y02669* 02814002
*                                                                     * 02817002
*      MACROS           =      MODID                            Y02669* 02823002
*                              POST UCMECB POSTCODE X'FD'       Y02669* 02826002
*                              SETLOCK - CMS AND LOCAL RELEASED Y02651* 02829002
*                                                                     * 02832002
*      ENQUEUE RESOURCES=      NONE                             Y02669* 02838002
*                                                                     * 02841002
*      LOCKS HELD       =      LOCKS OBTAINED IN IEE7503D ARE   Y02651* 02844002
*                              RELEASED BEFORE POSTING DIDOCS   Y02651* 02847002
*                              AT SETPOST OR BEFORE RETURNING   Y02651* 02850002
*                              AT RETURN1.                      Y02651* 02853002
*                                                                     * 02856002
*      CHANGE LEVEL     =      Y02669                           Y02669* 02859002
*                              Y02651                           Y02651* 02862002
*                              YM1915                           YM1915* 02863002
*                                                                     * 02865002
*   MESSAGES            =      THE FOLLOWING MESSAGES ARE       Y02669* 02868002
*                              CONTAINED IN AND ISSUED FROM     Y02669* 02868602
*                              IEE5603D AND IEE5903D:           Y02669* 02869202
*                                                                     * 02869802
*                               MSGID  CODE  IN MESSAGE TEXT    Y02669* 02870402
*                               _____  ____  __ _______ ____    Y02669* 02871002
*                              IEE156I X'04' 56 INVALID OPERAND Y02669* 03271002
*                              IEE345I X'08' 56 AUTHORITY       Y02669* 03671002
*                                                 INVALID       Y02669* 04071002
*                              IEE921I X'09' 56 REJECTED        Y02669* 04471002
*                                      X'1C' 59 DEVICE NOT      Y02669* 04871002
*                                                 SUPPORTED     Y02669* 05271002
*                              IEE926I X'0C' 56 L OPERAND       Y02669* 05671002
*                                                 INVALID       Y02669* 06071002
*                                      X'1D' 59 'CC' OUTPUT     Y02669* 06471002
*                                                 ONLY          Y02669* 06871002
*                                                                     * 07271002
*   SYSGEN              =      INCLUDED WITH SVC 34 IN LOAD     Y02669* 07671002
*                              MODULE IGC0003D, DLIB AOSB3,     Y02669* 08071002
*                              MACRO SGIEF441, TARGLIB LPALIB   Y02669* 08471002
*                                                                     * 08871002
*   SYSTEM LIBRARIES    =      NONE                             Y02669* 09271002
*                                                                     * 09671002
*********************************************************************** 10071002
         EJECT                                                          10471002
IEE7703D CSECT                                                          10871002
*********************************************************************** 12400001
*                                                                     * 12600002
*                        REGISTERS                                    * 12800002
*                                                                     * 13000002
*********************************************************************** 13200001
R0       EQU   0                   WORK REG                             13250002
R1       EQU   1                   WORK REG                             13300002
PARMREG  EQU   2                   XSA BASE REG                         13350002
R3       EQU   3      (UNUSED)     UNUSED                        Y02669 13360002
KOPS     EQU   4                   OPERAND POINTER                      13400002
R5       EQU   5      (UNUSED)     UNUSED                        Y02669 13450002
R6       EQU   6      (UNUSED)     UNUSED                        Y02669 13500002
R7       EQU   7      (UNUSED)     UNUSED                        Y02669 13550002
UCMEBASE EQU   8                   UCM EMTRY BASE REG                   15150002
R9       EQU   9      (UNUSED)     UNUSED                        Y02669 15152002
RDCMBASE EQU   10                  RESIDENT DCM BASE REG                15160002
R11      EQU   11     (UNUSED)     UNUSED                        Y02669 15170002
UCMBASE  EQU   12                  UCM BASE REG                         15180002
MYBASE   EQU   13                  MODULE BASE REG                      15190002
RE       EQU   14                  RETURN REG                           16800002
R15      EQU   15                  BRANCH REG                           16850002
         EJECT                                                          16860002
*********************************************************************** 16900002
*                                                                     * 17200002
*                 ERROR MESSAGE FLAG BIT SETTINGS                     * 17300002
*                                                                     * 17400002
*********************************************************************** 17650002
IEE156I  EQU   X'04'               IEE156I INVALID OPERAND              18000002
IEE345I  EQU   X'08'               IEE345I INVALID AUTHORITY            18050002
IEE921I  EQU   X'09'               IEE921I REJECTED                     18600002
ERR28    EQU   X'1C'                       DEVICE NOT SUPPORTED         18610002
IEE926I  EQU   X'0C'               IEE926I L OPERAND INVALID            18650002
ERR29    EQU   X'1D'                       CC OUTPUT ONLY               18700002
*********************************************************************** 19000002
*                                                                     * 19050002
*                 DISPLACEMENTS AND INCREMENTS                        * 19100002
*                                                                     * 19150002
*********************************************************************** 19200002
N0       EQU   0                   FIELD INCREMENT                      19400001
N1       EQU   1                   FIELD INCREMENT                      19600001
N2       EQU   2                   FIELD INCREMENT                      19800001
N3       EQU   3                   FIELD INCREMENT               Y02669 19850002
N4       EQU   4                   FIELD INCREMENT                      20200001
N5       EQU   5                   FIELD INCREMENT                      20400001
*********************************************************************** 22450002
*                                                                       22500002
*                           CONSTANTS                                   22550002
*                                                                       22560002
*********************************************************************** 22570002
M7       EQU   7                   MASK FOR ICM INSTRUCTION      Y02669 22590002
PTRCVT   EQU   16                  ADDR OF CVT                          22600002
ZERO     EQU   X'00'               ZERO CONSTANT                        23000002
COMMA    EQU   C','                COMMA CHARACTER CONSTANT             23600002
XFF      EQU   255                 MASK FOR TURNING OFF BITS     Y02669 23650002
POSTCOD1 EQU   X'FD'               CODE USED IN POSTING UCM ECB         23800001
         EJECT                                                          24200001
*********************************************************************** 24400001
*                                                                     * 24600002
*                     ESTABLISH ADDRESSABILITY                        * 24800002
*                                                                     * 25600002
*           ON ENTRY, REGISTER 2 CONTAINS ADDRESS OF XSA              * 25800002
*            TARGET CONSOLE IS ALWAYS A GRAPHICS DEVICE          Y02669 25850002
*            CHECK MADE IN IEE7503D                              Y02669 25900002
*                                                                     * 26000002
*********************************************************************** 26050002
         SPACE 2                                                        26100002
         BALR  MYBASE,N0           ESTABLISH ROUTINE 'S                 26400001
         USING *,MYBASE            BASE REGISTER                        26600001
         MODID BRANCH=YES                                        Y01886 26650001
         USING FAUXSA,PARMREG      ESTABLISH XSA ADDRESSABILITY         26800001
         L     UCMBASE,PTRCVT      LOAD CVT POINTER              Y02669 27000002
         USING CVTSECT,UCMBASE     BASE CVT REG                         27400001
         L     UCMBASE,CVTCUCB     GET UCM POINTER FROM CVT             27600002
         DROP  UCMBASE                                           Y20669 27650002
         USING UCM,UCMBASE         ESTABLISH UCM ADDRESSABILITY  Y02669 27800002
         USING UCMLIST,UCMEBASE    BASE UCM ENTRY LIST                  29000001
         USING DCMTSRT,RDCMBASE    ESTABLISH RDCM BASE REG       Y02669 29200002
         ST    RE,XAP              SAVE RETURN POINTER                  29800001
         EJECT                                                          30650002
*********************************************************************** 30700002
*                                                                     * 30750002
*    FIND AND BASE TARGET UCM ENTRY AND RESIDENT DCM (ALWAYS CRT)     * 30800002
*    REG 1-TARGET CONSOLE ID RIGHT JUSTIFIED, HIGH ORDER BYTES ZERO   * 30850002
*    OUTPUT-POINTER TO TARGET UCMENTRY IN UCMEBASE REG                * 30900002
*    REG USAGE-DESTROYS CONTENTS OF: REG 0,1,UCMEBASE                 * 30950002
*                                                                     * 31000002
*********************************************************************** 31050002
         SPACE 2                                                        31100002
         SR    R1,R1               CLEAR REG                            31110002
         IC    R1,XASCID           LOAD TARGET CONSOLE ID               31120002
         BCTR  R1,ZERO             SUBTRACT ONE FROM CONSOLE ID         31300002
         L     UCMEBASE,UCMVEA     POINT TO FIRST UCM ENTRY             31310002
         M     R0,UCMVEZ           MULTIPLY ENTRY SIZE BY REDUCED ID    31350002
         AR    UCMEBASE,R1         POINT TO DESIRED UCM ENTRY           31400002
         L     RDCMBASE,UCMXB      LOAD ADDRESS OF RESIDENT DCM         31500002
         EJECT                                                          31550002
*********************************************************************** 31600002
*                                                                     * 31650002
*                      VALIDITY CHECK THE COMMAND                     * 31700002
*                                                                     * 31750002
*  ERR - IEE156I INVALID OPERAND - IF SYNTAX CHECK FAILS         Y02669 31760002
*********************************************************************** 31800002
         SPACE 2                                                        31850002
VALID    EQU   *                                                        69600001
         L     KOPS,XAL            LOAD ADDRESS OF OPERANDS             69610002
         LA    KOPS,N0(KOPS)       CLEAR HIGH ORDER BYTE                69620002
         ST    KOPS,XAD            SAVE CURSOR POSITION          Y02669 69630002
         LA    KOPS,N1(KOPS)       INCREMENT OPERAND POINTER            69650001
         CLI   N0(KOPS),COMMA      IS SECOND CHARACTER A COMMA?         69700002
         BNE   BADKOP              NO, IEE156I INVALID OPERAND          69750002
         SPACE 2                                                        69752002
         LA    KOPS,N1(KOPS)       INCREMENT OPERAND POINTER     Y02669 69762002
         CLC   N0(N4,KOPS),USE     IS NEXT 4 CHARS 'USE='?       Y02669 69770002
         BNE   BADKOP              NO, IEE156I INVALID OPERAND          69780002
         SPACE 2                                                        69780402
*********************************************************************** 69782002
*                                                                     * 69782402
*          TARGET CONSOLE CAN NOT BE MASTER CONSOLE OR A 2250         * 69782802
*                                                                     * 69782902
*  ERR - IEE345I AUTHORITY INVALID - IF TARGET IS MASTER CONSOLE Y02669 69783202
*        IEE921I REJECTED COMMAND-DEVICE NOT SUPPORTED - IF 2250 Y02669 69783602
*                                                                     * 69783702
*********************************************************************** 69784002
         SPACE                                                          69788402
         TM    UCMDISP,UCMDISPA    IS TARGET THE MASTER CONSOLE?        69790002
         BO    NOTMAST             YES, ERROR - CAN'T V MASTER          69792002
*                                  IEE345I AUTHORITY INVALID     Y02669 69792102
         SPACE 2                                                        69792402
         TM    DCMDEVTY,DCMTY50    IS TARGET A 2250?                    69794002
         BO    ERRHARD             YES, ERROR - CAN'T V 2250            69796002
*                                  IEE921I DEVICE NOT SUPPORTED         69796102
         EJECT                                                          69796402
*********************************************************************** 69796802
*        VALIDITY CHECK AND VARY CONSOLE TO FULL CAPABILITY      Y02669 69796902
*********************************************************************** 69797202
         SPACE 2                                                        69797602
         LA    KOPS,N4(KOPS)       INCREMENT OPERAND POINTER     Y02669 69798002
SETFC    EQU   *                                                 Y02669 69798402
         CLC   N0(N3,KOPS),FC      WAS FC SPECIFIED? (& BLANK)   Y02669 69800002
         BNE   SETSD               NO                                   70000002
         SPACE                                                          70050002
         TM    UCMDISP,UCMDISPD    IS CONSOLE HDWARE OUTPUT ONLY?       73200002
         BZ    FCCONS              NO, OK TO CHANGE MODE                73400002
         SPACE                                                          73410002
         TM    UCMSDS5,UCMSDS5G    YES, IS CONSOLE REALLY OUTPUT ONLY?  73450002
         BZ    OUTERROR            IF OFF, OUTPUT ONLY HARDWARE         73500002
*                                  IT'S IN OUTPUT-ONLY MODE BUT NOT AN  73500402
*                                  INPUT-OUTPUT DEVICE IN OUTPUT-ONLY.  73500802
*                                  MUST HAVE BOTH IN & OUT CAPABILITY   73502002
*                                  TO SERVE AS FULL CAPABILITY          73504002
         SPACE  2                                                       73510002
*********************************************************************** 73550002
*   TURN OFF FLAGS IN TARGET UCM ENTRY:                          Y02669 73800002
*        UCMDISPF - CONSOLE IS MESSAGE STREAM ONLY               Y02669 73802002
*        UCMDISPG - CONSOLE IS STATUS DISPLAY ONLY               Y02669 73804002
*        UCMDISPD - OUTPUT ONLY                                  Y02669 73806002
*        UCMSDS5G - I/O HARDWARE IN OUTPUT-ONLY STATUS           Y02669 73808002
*   TURN ON FLAGS IN TARGET UCM ENTRY:                           Y02669 73811002
*        UCMIF    - INPUT-OUTPUT CAPABILITY                      Y02669 73814002
*        UCMDISPE - FULL CAPABILITY MODE                         Y02669 73817002
*********************************************************************** 73820402
         SPACE 2                                                        73820802
FCCONS   EQU   *                                                        73822001
         NI    UCMDISP,XFF-UCMDISPF-UCMDISPG-UCMDISPD            Y02669 73830002
         NI    UCMSDS5,XFF-UCMSDS5G                              Y02669 73832002
         OI    UCMATR,UCMIF        INDICATE I/O STATUS TO MCS           73840002
         OI    UCMDISP,UCMDISPE    SET FULL CAPABILITY BIT ON           73850002
         B     SETPOST             NOTIFY DIDOCS CHANGING STATUS        74000002
         EJECT                                                          74200002
*********************************************************************** 74250002
*            VALIDITY CHECK AND VARY CONSOLE TO STATUS DISPLAY   Y02669 74260002
*********************************************************************** 74300002
         SPACE 2                                                        74350002
SETSD    EQU   *                                                 Y02669 74650002
         CLC   N0(N3,KOPS),SD      WAS SD SPECIFIED? (& BLANK)   Y02669 74700002
         BNE   SETMS               NO                            Y02669 74750002
         TM    UCMDISP,UCMDISPG    IS IT ALREADY IN SD MODE?            74800002
         BO    RETURN1             YES, NO WORK REQUIRED                75000002
         SPACE                                                          75050002
         OI    UCMDISP,UCMDISPG    NO, SET STATUS DISPLAY BIT ON        75200002
         NI    UCMDISP,XFF-UCMDISPE-UCMDISPF  TURN FC & MS OFF   Y02669 75250002
         B     SETOUT              NOTIFY DIDOCS CHANGING STATUS        75400002
         EJECT                                                          75600002
*********************************************************************** 75650002
*            VALIDITY CHECK AND VARY CONSOLE TO MESSAGE STREAM   Y02669 75700002
*********************************************************************** 75750002
         SPACE 2                                                        75800002
SETMS    EQU   *                                                 Y02669 76010002
         CLC   N0(N3,KOPS),MS      WAS MS SPECIFIED? (& BLANK)   Y02669 76020002
         BNE   BADFNS              NO, IEE156I INVALID OPERAND   YM1915 76030002
         SPACE                                                          76080002
         TM    UCMDISP,UCMDISPF    IS IT ALREADY IN MS MODE?            76200002
         BO    RETURN1             YES, NO WORK REQUIRED                76400002
         SPACE                                                          76450002
         TM    UCMMODE,UCMOGCE     ONLY CRT CONSOLES IN SYSTEM?         76570002
         BO    ERRHARD             YES, ERR - MUST HAVE 1 PAPER         76580002
         SPACE                                                          76590002
         OI    UCMDISP,UCMDISPF    NO, SET MSG STREAM BIT ON            76600002
         NI    UCMDISP,XFF-UCMDISPE-UCMDISPG  TURN FC & SD OFF   Y02669 76650002
         SPACE 2                                                        76660002
*********************************************************************** 76670002
*  SET ALL BITS NECESSARY TO VARY A CONSOLE TO OUTPUT-ONLY MODE  Y02669 76680002
*  FOR STATUS DISPLAY AND MESSAGE STREAM:                        Y02669 76682002
*       UCMSDS5G - INPUT-OUTPUT CAPABILITIES BUT IN OUTPUT MODE  Y02669 76684002
*       UCMDISPD - SOFTWARE OUTPUT ONLY MODE                     Y02669 76686002
*********************************************************************** 76690002
SETOUT   EQU   *                                                        76700001
         NI    UCMATR,XFF-UCMIF    INDICATE OUTPUT ONLY TO MCS   Y02669 76710002
         TM    UCMSDS5,UCMSDS5G    IS DEVICE IN OUTPUT ONLY MODE?       76720002
         BO    SETPOST             YES                                  76730002
         SPACE                                                          76740002
         TM    UCMDISP,UCMDISPD    NO, IS THIS AN OUTPUT DEVICE?        76750002
         BO    SETPOST             YES                                  76760002
         SPACE                                                          76762002
         OI    UCMDISP,UCMDISPD    NO, FORCE OUTPUT ONLY                76770002
         OI    UCMSDS5,UCMSDS5G    SET OUTPUT ONLY BIT ON               76780001
         EJECT                                                          76790402
*********************************************************************** 76792002
*                                                                     * 76800001
*    TURN ON BITS IN RESIDENT DCM TO TELL DIDOCS WHAT TO DO      Y02669 76850002
*       DCMSTSWT - CHANGING STATUS OF OUTPUT ONLY CONSOLE        Y02669 76900002
*       DCMKVIP - ENTRY AS THE RESULT OF K VARY COMMAND          Y02669 76950002
*    REINIT HARDCOPY AND JOBNAME BITS TO SYSGEN VALUE            Y02669 77050002
*    INDICTAES ALL HEADER INFORMATION ON MESSAGE SENT TO THE     Y02669 77150002
*    CONSOLE SHOULD BE DELETED I.E. R.C. + TIME STAMP + JOBNAME  Y02669 77250002
*                                                                     * 77600001
* NOTE: LOCKS ARE ALWAYS HELD ON ENTRY TO IEE7703D               Y02651 77610002
*    AND MUST BE RELEASED BEFORE POSTING DIDOCS OR               Y02651 77620002
*    RETURNING CONTROL TO THE SYSTEM                             Y02651 77630002
*********************************************************************** 77650002
         SPACE 3                                                        77800001
SETPOST  EQU   *                                                        78200001
         OI    DCMR3FLG,DCMSTSWT+DCMKVIP                                78400002
         NI    UCMDISP2,XFF-UCMDISPI-UCMDISPJ                    Y02669 78450002
         BAL   R15,LOCKSOFF        GO RELEASE LOCKS AND          Y02651 78500002
         POST  UCMECB,POSTCOD1     POST THE ECB                         78600001
         B     RETURN              THEN RETURN TO SYSTEM         Y02651 78650002
         SPACE 3                                                        78750002
RETURN1  EQU   *                                                        79248002
         BAL   R15,LOCKSOFF                                      Y02651 79298002
RETURN   EQU   *                                                 Y02651 79299902
         L     RE,XAP                                            Y02669 79349902
         BR    RE                  RETURN TO CALLER                     79400001
         SPACE 2                                                        79410002
LOCKSOFF EQU   *                                                 Y02651 79410402
         STM   R11,RE,XASAVLOC     SAVE REGS AROUND SETLOCK      Y02651 79412002
         SETLOCK RELEASE,TYPE=CMS,RELATED=(K,IEE7503D(LOCKSET))         79414002
         SETLOCK RELEASE,TYPE=LOCAL,RELATED=(K,IEE7503D(LOCKSET))       79416002
         LM    R11,RE,XASAVLOC     RESTORE REGS AFTER SETLOCK    Y02651 79418002
         NI    XASSDS,XFF-XASSDS5  INDICATE LOCKS NOW OFF        Y02651 79418402
         BR    R15                                               Y02651 79418502
         EJECT                                                          79418802
*********************************************************************** 79420002
*                                                                     * 79422002
*                        ERROR EXITS                                  * 79424002
*                                                                     * 79426002
*********************************************************************** 79430002
         SPACE  2                                                       79432002
NOTMAST  EQU   *                   CAN'T K VARY MASTER CONSOLE          79440002
         MVI   XAE,IEE345I         IEE345I AUTHORITY INVALID            79442002
         MVC   XASOPTR(N3),XAD+N1  SAVE ADDR INVALID OPERAND   @YM4792P 79443002
         B     D5603D              BRANCH TO ERROR EXIT          Y02669 79444002
         SPACE  2                                                       79446002
OUTERROR EQU   *                   CAN'T VARY OUTPUT ONLY TO FC  Y02669 79450002
         MVI   XASTSAVE,ERR29      SECOND ERROR CODE-OUTPUT ONLY Y02669 79500002
         MVI   XAE,IEE926I         ERROR CODE - L OPERAND INVALID       79550001
         B     STOREOP             BRANCH FOR ERROR EXIT         Y02669 79560002
         SPACE  2                                                       79562002
ERRHARD  EQU   *                   CAN'T K VARY A 2250                  79570002
         MVI   XASTSAVE,ERR28      MINOR - DEVICE NOT SUPPORTED  Y02669 79580002
         MVI   XAE,IEE921I         ERROR CODE - CM OP REJECTED          79590001
         MVC   XASOPTR(N3),XAD+N1  SAVE ADDR OF INVALID OPERAND  Y02669 79592002
         B     D5603D              BRANCH FOR ERROR EXIT         Y02669 79592102
         SPACE  2                                                       79592402
BADFNS   EQU   *                                                 YM1915 79592702
         CLI   N2(KOPS),COMMA      IS FNS FOLLOWED BY ,?         YM1915 79593002
         BNE   BADKOP              NO, WHOLE OPERAND BAD         YM1915 79593302
         LA    KOPS,N2(KOPS)       YES, POINT TO BAD INFO        YM1915 79593602
BADKOP   EQU   *                                                        79594002
         MVI   XAE,IEE156I         IEE156I INVALID OPERAND              79596002
STOREOP  EQU   *                                                        79598002
         STCM  KOPS,M7,XASOPTR     SAVE ADDR OF INVALID OPERAND  Y02669 79598402
D5603D   EQU   *                                                 Y02669 79599202
         L     RE,XAP              RESTORE RETURN ADDRESS        Y02669 79599702
         L     R15,VCON5603        GET ADDRESS OF ERR MODULE     Y02669 79599802
         BR    R15                 GO ISSUE ERROR MESSAGES       Y02669 79599902
         EJECT                                                          79649902
*********************************************************************** 79699902
*                                                                     * 84000002
*                            CONSTANTS                                * 84400002
*                                                                     * 84600002
*********************************************************************** 84650002
         SPACE  2                                                       84700002
VCON5603 DC    V(IEE5603D)         SVC 34 MSG MOD NAME           Y02669 85800002
USE      DC    C'USE='             CONSTANT FOR VARY COMMAND            86800001
FC       DC    C'FC '              FULL CAPCITY CONSTANT         Y02669 87000002
SD       DC    C'SD '              STATUS DISPLAY CONSTANT       Y02669 87200002
MS       DC    C'MS '              MASTER CONSOLE CONSTANT       Y02669 87400002
         SPACE  5                                                       87410002
*********************************************************************** 87450002
*                                                                     * 87500002
*                         PATCH AREA                                  * 87550002
*                                                                     * 87560002
*********************************************************************** 87570002
         SPACE  2                                                       87580002
PATCH    DC    C'****PATCH AREA****'                                    87600001
PATCH2   DC    C'IEE7703D-TEST ONLY'                                    87800001
PATCH3   DC    36C' '                                                   88000001
         EJECT                                                          89200001
         IEECUCM FORMAT=NEW                                             89600002
         EJECT                                                          89650002
         IEERDCM                                                        90000002
         EJECT                                                          90050002
FAUXSA   DSECT                                                          90200001
         IEEXSA                                                         90400001
         EJECT                                                          90450002
CVTSECT  DSECT                                                          93000001
         CVT                                                            93200001
         EJECT                                                          93250002
         IHAPSA                                                         93300002
         END                                                            93800001
./  ADD  SSI=40981125,NAME=IEE7803D
         TITLE 'IEE7803D SVC 34 K C,D,ID COMMAND '                      01400002
*********************************************************************** 01600001
*                                                                     * 01650002
* MODULE NAME         =  IEE7803D                               Y02669* 01700002
*                                                                     * 01750002
* DESCRIPTIVE NAME    =  CONTROL (K) C,D,ID COMMAND             Y02669* 01800002
*                                                                     * 01850002
* COPYRIGHT           =  N/A                                    Y02669* 01900002
*                                                                     * 01950002
* STATUS              =  01 - UPDATE FOR VS/2 RELEASE 2         Y02669* 02000002
*                                                                     * 02050002
* FUNCTION            =  PROCESSES K C,D,MLWTOID CONTROL        Y02669* 02100002
*                        COMMAND WHICH CANCELS AN INLINE        Y02669* 02150002
*                        MLWTO BY PURGING THE UNDISPLAYED       Y02669* 02200002
*                        MINORS FROM THE OUTPUT QUEUE.          Y02669* 02210002
*                                                                     * 02242402
*   OPERATION         =  THE COMMAND BUFFER IS CHECKED FOR      Y02669* 02300002
*                        THE PRESENCE OF A VALID MLWTO ID.      Y02669* 02310002
*                        IF NOT FOUND, 'IEE927I REQUEST         Y02669* 02320002
*                        AMBIGUOUS' IS ISSUED. IF THE VALUE     Y02669* 02330002
*                        FOUND IS INVALID ( NOT A DIGIT ),      Y02669* 02340002
*                        'IEE156I INVALID OPERAND' IS ISSUED.   Y02669* 02342002
*                                                                     * 02342402
*                        THE TARGET CONSOLE ID FOUND IN XASCID  Y02669* 02344002
*                        IS THEN PACKED AND CONVERTED TO BINARY Y02669* 02346002
*                        AND THE RESULTING VALUE IS USED TO     Y02669* 02348002
*                        INDEX THE CORRESPONDING UCME.          Y02669* 02348402
*                                                                     * 02348802
*                        IF THIS CONSOLE'S WQE QUEUE ADDRESS,   Y02669* 02349202
*                        FOUND IN THE UCME, IS ZERO, 'IEE156I   Y02669* 02349302
*                        INVALID OPERAND' IS ISSUED.            Y02669* 02349402
*                                                                     * 02362002
*                        OTHERWISE, THE WQE QUEUE IS SEARCHED   Y02669* 02372002
*                        FOR A MATCHING MLWTO ID. IF NOT FOUND, Y02669* 02374002
*                        'IEE156I INVALID OPERAND' IS ISSUED.   Y02669* 02374402
*                                                                     * 02374502
*                        IF FOUND ISSUE A DOM MACRO TO         @Y02668P 02374602
*                        BUILD AN SSIB AND SSOB TO INFORM      @Y02668P 02374802
*                        THE SUBSYSTEM THAT A MLWTO HAS        @Y02668P 02375802
*                        BEEN DELETED                          @Y02668P 02376802
*                            WMJMSEQ - IS THE DOM SEQUENCE     @Y02668P 02377802
*                                      NUMBER IN THE MAJOR WQE @Y02668P 02378802
*                                                                     * 02379802
*                        THE USE COUNT FOR ALL THE MINOR WQES   Y02669* 02380802
*                        ON EACH MINOR WQE QUEUE IS DECREMENTED Y02669* 02384802
*                        UNTIL THEY ARE ZERO.                   Y02669* 02386802
*                        THE UCME IS RESET TO MAKE IT APPEAR    Y02669* 02391502
*                        AS IF THE MINORS HAD ALL BEEN WRITTEN: Y02669* 02392302
*                           OUTPUT PENDING BIT IS TURNED ON     Y02669* 02395302
*                               UCMSTS - UCMPF X'40'            Y02669* 02398302
*                           WORKING ON INLINE MLWTO TURNED OFF  Y02669* 02402502
*                               UCMSTS - UCMTC X'01'            Y02669* 02405502
*                           WAITING ON INLINE MLWTO TURNED OFF  Y02669* 02408502
*                               UCMSDS5 - UCMSDS5A X'80'        Y02669* 02411502
*                           DEQUEUE OUTPUT QUEUE ENTRIES        Y02669* 02414502
*                               UCMSTS - UCMTB X'04'            Y02669* 02417502
*                           PURGE CQE TURNED ON                 Y02669* 02420502
*                               CQEFLAG - CQEAVAIL X'02'        Y02669* 02423502
*                           CQU ACTIVE FLAG TURNED OFF          Y02669* 02426502
*                               CQEFLAG - CQEENTR               Y02669* 02429502
*                        AND CONTROL IS RETURNED.               Y02669* 02432502
*                                                                     * 02435502
* NOTES                                                         Y02669* 02438502
*                                                                     * 02450002
*   CHARACTER CODE                                              Y02669* 02500002
*    DEPENDENCIES     =  ANY CHARACTER CODE OTHER THAN EBCDIC   Y02669* 02550002
*                        WILL REQUIRE REASSEMBLY OF THIS MODULE.Y02669* 02600002
*                        NOTE THAT THIS MODULE IS DEPENDENT     Y02669* 02610002
*                        UPON THE CHARACTER REPRESENTATION OF   Y02669* 02620002
*                        DECIMAL DIGITS, IE. X'F1' = 1.         Y02669* 02630002
*                                                                     * 02650002
*   DEPENDENCIES      =  THE CMS LOCK AND LOCAL LOCK WILL       Y02651* 02700002
*                        REPLACE SSM (DISABLE AND ENABLE) FOR   Y02651* 02702002
*                        PURGING THE MINOR WQE'S.               Y02651* 02704002
*                                                                     * 02750002
*   RESTRICTIONS      =  NONE                                   Y02669* 02800002
*                                                                     * 02850002
*   REGISTER                                                    Y02669* 02900002
*    CONVENTIONS      =  NONE                                   Y02669* 02950002
*                                                                     * 03000002
*   PATCH-LABEL       =  PATCH                                  Y02669* 03050002
*                                                                     * 03100002
* MODULE TYPE         =  CSECT                                  Y02669* 03150002
*                                                                     * 03200002
*   PROCESSOR         =  N/A                                    Y02669* 03250002
*                                                                     * 03300002
*   MODULE SIZE       =  X'1A8' + X'48' PATCH AREA              Y02669* 03350002
*                                                                     * 03400002
*   ATTRIBUTES        =  REFRESHABLE, REENTRANT, PAGED LPA,     Y02669* 03450002
*                        KEY 0, SUPERVISOR MODE                 Y02669* 03550002
*                                                                     * 03800002
* ENTRY POINT         =  IEE7803D FROM IEE7503D                 Y02669* 03810002
*   PURPOSE           =  TO PROCESS THE K C,D,ID COMMAND FOR    Y02669* 03820002
*                        ALL NON-CRT DEVICES                    Y02669* 03822002
*   LINKAGE           =  BRANCH                                 Y02669* 03840002
*   INPUT DATA        =  REG 2 POINTS TO THE XSA                Y02669* 03842002
*                           XAS CONTAINS ROUTING INFORMATION    Y02669* 03842102
*                              XASCID - TARGET CONSOLE ID       Y02669* 03842202
*                              XASSDS5 ON -  LOCKS HELD         Y02651* 03861602
*                           XAL POINTS TO 1ST OPERAND IN BUFFER Y02669* 03863602
*                     =  REG 14 CONTAINS THE RETURN ADDRESS     Y02669* 03871202
*                                                                     * 03880802
*   REGISTERS SAVED   =  REGISTERS 11, 12, 13, 14 ARE SAVED     Y02651* 03890402
*                        BEFORE ISSUING SETLOCK RELEASE AT      Y02651* 03892402
*                        ENDSRCH.                               Y02651* 03894402
*                                                                     * 03900002
*   REGISTER CONTENTS                                           Y02669* 03950002
*    DURING PROCESSING=  R0  =  WORK REG                        Y02669* 04000002
*                        R1  =  WORK REG                        Y02669* 04050002
*                        R2  =  BASE REG FOR XSA                Y02669* 04100002
*                        R3  =  USUSED                          Y02669* 04150002
*                        R4  =  BASE REG FOR WQE                Y02669* 04200002
*                        R5  =  BASE REG FOR CQE                Y02669* 04250002
*                        R6  =  WORK REG                        Y02669* 04300002
*                        R7  =  WORK REG                        Y02669* 04350002
*                        R8  =  BASE REG FOR UCM ENTRY          Y02669* 04400002
*                        R9  =  UNUSED                          Y02669* 04450002
*                        R10 =  OPERAND POINTER                 Y02669* 04500002
*                        R11 =  BASE REG FOR THIS MODULE        Y02669* 04550002
*                        R12 =  BASE REG FOR UCM                Y02669* 04600002
*                        R13 =  UNUSED                          Y02669* 04650002
*                        R14 =  RETURN ADDRESS                  Y02669* 04700002
*                        R15 =  WORK REG & BRANCH REG           Y02669* 04750002
*                                                                     * 04800002
*   REGISTERS RESTORED=  REGISTERS 11, 12, 13, 14 ARE RESTORED  Y02651* 04850002
*                        AFTER ISSUING SETLOCK AT ENDSRCH.      Y02651* 04860002
*                                                                     * 04900002
*  *  *  *  *  *  *  *  *  *  *  *  *  *  *  *  *  *  *  *  *  *  *  *  04910002
*                                                                     * 04920002
* EXIT - NORMAL       =  RETURN VIA BR 14 FROM ENDSRCH          Y02669* 04950002
*   CONDITIONS        =  PROCESSING OF K C,D COMPLETE           Y02669* 05000002
*   OUTPUT DATA       =  ALL UNDISPLAYED MINORS OF MLWTO        Y02669* 05050002
*                        ARE PURGED AND THE LOCKS RELEASED      Y02651* 05100002
*                        REG 2 STILL POINTS TO XSA              Y02669* 05110002
*                           XASSDS5 IS TURNED OFF -  LOCKS      Y02651* 05150002
*                           RELEASED                            Y02651* 05200002
*   RETURN CODES      =  NONE                                   Y02669* 05250002
*                                                                     * 05300002
*  *  *  *  *  *  *  *  *  *  *  *  *  *  *  *  *  *  *  *  *  *  *  *  05641602
*                                                                     * 05643602
* EXIT - ERROR        =  BRANCH TO IEE5603D FROM D5603D         Y02669* 05644802
*   CONDITIONS        =  TO ISSUE ERROR MESSAGES 'IEE156I       Y02669* 05650002
*                        INVALID OPERAND' AND 'IEE927I REQUEST  Y02669* 05660002
*                        AMBIGUOUS'                             Y02669* 05670002
*   OUTPUT DATA       =  REG 2 POINTS TO XSA                    Y02669* 05700002
*                           XAE CONTAINS MAJOR MESSAGE INDEX    Y02669* 05710002
*                           FOR IEE5603D   X'04' - IEE156I      Y02669* 05712002
*                                          X'0D' - IEE927I      Y02669* 05720002
*                           XASTSAVE POINTS TO INVALID OPERAND  Y02669* 05730002
*                            & CONTAINS ERROR CODE FOR IEE5903D Y02669* 05732002
*                              X'16' - SPECIFY DISPLAY ID       Y02669* 05734002
*                           XASSDS5 IS STILL ON - LOCKS HELD    Y02651* 05740002
*   RETURN CODES      =  NONE                                   Y02669* 05750002
*                                                                     * 05800002
*  *  *  *  *  *  *  *  *  *  *  *  *  *  *  *  *  *  *  *  *  *  *  *  05810002
*                                                                     * 05820002
* EXTERNAL REFERENCES                                           Y02669* 05850002
*                                                                     * 05900002
*   ROUTINES          =  IEE5603D                               Y02669* 05950002
*                                                                     * 06000002
*   DATA AREAS        =  NONE                                   Y02669* 06050002
*                                                                     * 06100002
         EJECT                                                          06110002
*   CONTROL BLOCKS    =  IEECUCM  R - ADDR CONSOLE'S WQE QUEUE  Y02669* 06150002
*                                 W - RESET WQE QUEUE BITS      Y02669* 06160002
*                        IEEXSA   R - INPUT                     Y02669* 06200002
*                                 W - ERROR MSG INDEX           Y02669* 06250002
*                        CVT      R - ADDRESS UCM               Y02669* 06350002
*                        IHAWQE   R - COMPARE ID'S              Y02669* 06400002
*                                 W - DEQUEUE MINORS            Y02669* 06410002
*                        IHAPSA   NECESSARY FOR SETLOCK         Y02651* 06500002
*                        IHACTM   (CQE) R - RIGHT WQE           Y02669* 06510002
*                                       W - RESET BITS          Y02669* 06520002
*                                                                     * 06550002
*   TABLES            =  NONE                                   Y02669* 06600002
*                                                                     * 06610002
*   MACROS            =  SETLOCK - CMS AND LOCK LOCKS RELEASED  Y02651* 06650002
*                                                                     * 06800002
*   ENQUEUE RESOURCES =  NONE                                   Y02669* 06850002
*                                                                     * 06900002
*   LOCKS HELD        =  CMS AND LOCAL LOCKS ARE OBTAINED IN    Y02651* 06950002
*                        IEE7503D AND HELD THROUGHOUT IEE7803D. Y02651* 06952002
*                        UNDER NORMAL CONDITIONS THEY ARE       Y02651* 06962002
*                        RELEASED AND XASSDS5 IS RESET BEFORE   Y02651* 07000002
*                        RETURNING AT ENDSRCH.                  Y02651* 07010002
*                        FOR ERROR CONDITIONS THEY ARE RELEASED Y02651* 07012002
*                        IN IEE5603D OR IEE5903D.               Y02651* 07014002
*                                                                     * 07020002
*   CHANGE LEVEL      =  Y02669                                 Y02669* 07050002
*                        Y02651                                 Y02651* 07060002
*                        YM1911  (PROLOGUE & COMMENT CHANGES)   YM1911* 07080002
*                                                                     * 07100002
* MESSAGES            =  THE FOLLOWING MESSAGES ARE CONTAINED   Y02669* 07157002
*                        IN AND ISSUED FROM IEE5603D & IEE5903D:Y02669* 07164002
*                                                                     * 07171002
*                         MSGID   CODE  IN  MESSAGE TEXT        Y02669* 07178002
*                        IEE156I  X'04' 56  INVALID OPERAND     Y02669* 07185002
*                        IEE927I  X'0D' 56  REQUEST AMBIGUOUS   Y02669* 07192002
*                                 X'16' 59  SPECIFY DISPLAY ID  Y02669* 07199002
*                                                                     * 07206002
* SYSGEN              =  INCLUDED WITH SVC 34 IN LOAD MODULE    Y02669* 07213002
*                        IGC0003D,DLIB AOSB3, MACRO SGIEF441,   Y02669* 07220002
*                        TARGLIB LPALIB.                        Y02669* 07227002
*                                                                     * 07234002
* SYSTEM LIBRARIES    =  NONE                                   Y02669* 07241002
*                                                                     * 07250002
*********************************************************************** 08800001
         EJECT                                                          09000001
IEE7803D CSECT                                                          09050002
*********************************************************************** 09200001
*                                                                     * 09400002
*                            REGISTERS                                * 09600002
*                                                                     * 09800002
*********************************************************************** 10000001
R0       EQU   0                   WORK REGISTER                        13450002
R1       EQU   1                   WORK REGISTER                        13800001
PARMREG  EQU   2                   BASE REGISTER FOR XSA                13810002
R3       EQU   3      (UNUSED)     UNUSED                        Y02669 13860002
WQEREG   EQU   4                   BASE REGISTER FOR MINOR WQE   Y02669 13900002
CQEREG   EQU   5                   BASE REGISTER FOR CQE         Y02669 14010002
R5       EQU   5                   WORK REGISTER                 Y02669 14020002
R6       EQU   6                   WORK REGISTER                        14050002
R7       EQU   7                   WORK REGISTER                        14100002
UCMEBASE EQU   8                   BASE REGISTER FOR UCM ENTRY          14150002
R9       EQU   9                   DOM SEQUENCE NUMBER         @Y02668P 14160002
KOPS     EQU   10                  OPERAND POINTER                      14170002
MYBASE   EQU   11                  THIS ROUTINES BASE REGISTER          14180002
UCMBASE  EQU   12                  UCM BASE REGISTER                    14190002
R13      EQU   13                  UNUSED                        Y02669 14192002
R14      EQU   14                  RETURN REGISTER               Y02669 14194002
R15      EQU   15                  WORK REGISTER                 Y02669 14196002
         EJECT                                                          14246002
*********************************************************************** 14450002
*                                                                     * 14500002
*                          CHARACTER CONSTANTS                        * 14550002
*                                                                     * 14560002
*********************************************************************** 14562002
COMMA    EQU   C','                COMMA CHAR FOR SYNTAX CHECK   Y02669 14572002
BLANK    EQU   C' '                BLANK CHAR FOR SYNTAX CHECK          14590002
ZERO     EQU   X'00'               ZERO CONSTANT                        14592102
*********************************************************************** 14592402
*                                                                     * 14592802
*                             MASKS                                   * 14593202
*                                                                     * 14593602
*********************************************************************** 14593702
DIGIT    EQU   X'F0'               MASK TO TEST FOR VALID DIGIT  Y02669 14649702
XFF      EQU   255                 USED IN NI INSTRUCTIONS TO TURN      14649802
*                                  OFF BITS FOR TM INSTRUCTIONS  Y02669 14652002
*********************************************************************** 14654502
*                                                                     * 14656702
*                       ERROR MESSAGE CODES                           * 14658902
*                                                                     * 14661102
*********************************************************************** 14663302
MSG156   EQU   4                   IEE156I INVALID OPERAND       Y02669 14665502
MSG927   EQU   13                  IEE927I K REQUEST AMBIGUOUS   Y02669 14667702
MSG927I  EQU   22                          SPECIFY DISPLAY ID    Y02669 14669902
*********************************************************************** 14679902
*                                                                     * 14689902
*                   DISPLACEMENTS AND INCREMENTS                      * 14691902
*                                                                     * 14718002
*********************************************************************** 14726702
N0       EQU   0                   FIELD INCREMENT                      14744102
N1       EQU   1                   FIELD INCREMENT                      14752802
N2       EQU   2                   FIELD INCREMENT                      14761502
N3       EQU   3                   FIELD INCREMENT                      14770202
N4       EQU   4                   FIELD INCREMENT                      14778902
N7       EQU   7                   MASK FOR ICM INSTRUCTION      Y02669 14780902
N8       EQU   8                   FIELD INCREMENT                      14787602
         EJECT                                                          14788902
*********************************************************************** 14800001
*                                                                     * 15000001
*      ESTABLISH ADDRESSABILITY                                       * 15200001
*                                                                     * 15400001
*      ON ENTRY, REGISTER 2 CONTAINS ADDRESS OF XSA                   * 16000001
*                                                                     * 16200001
*********************************************************************** 16250001
         BALR  MYBASE,N0           ESTABLISH ROUTINE 'S                 17200001
         USING *,MYBASE            BASE REGISTER                        17400001
         MODID BRANCH=YES                                        Y01886 17450001
         USING FAUXSA,PARMREG      ESTABLISH XSA ADDRESSABILITY         17600001
         L     UCMBASE,CVTPTR      GET CVT POINTER                      17800001
         USING CVTSECT,UCMBASE     BASE CVT REG                         18000001
         L     UCMBASE,CVTCUCB     GET UCM POINTER FROM CVT             18200001
         DROP  UCMBASE                                           Y02669 18250002
         USING UCM,UCMBASE         ESTABLISH UCM ADDRESSABILITY  Y02669 18400002
         USING UCMLIST,UCMEBASE    BASE UCM ENTRY LIST                  18600001
         USING WQE,WQEREG          ADDRESS WQE                   YM2304 18800001
         USING CQE,CQEREG          ESTABLISH BASE FOR CQE        Y02669 18850002
         SPACE 2                                                        18900002
*********************************************************************** 19050002
*                                                                     * 19400001
*              ESTABLISH POINTER TO K OPERANDS                   Y02669 19650002
*           'C,D' IS VALIDITY CHECKED IN IEE7503D                Y02669 19700002
*  IEE7503D ENSURES THAT TARGET CONSOLES ARE ALWAYS GRAPHICS DEVICES  * 19750002
*                                                                     * 19800001
*********************************************************************** 19850002
         SPACE 1                                                        20200001
         L     KOPS,XAL            LOAD POINTER TO OPERANDS             20800002
         LA    KOPS,N0(KOPS)       CLEAR HIGH ORDER BYTE                21000001
         EJECT                                                          21816402
*********************************************************************** 22850002
*                                                                     * 23000002
*                          K C,D                                      * 23010002
*                                                                     * 23020002
*   THE MLWTO ID IS OBTAINED FROM THE COMMAND BUFFER, VALIDITY        * 23050002
*   CHECKED, AND PACKED INTO XAP, FINDUCME IS THEN INVOKED TO         * 23100002
*   CONVERT THE VALUE TO BINARY AND DETERMINE WHETHER IT SPECIFIES    * 23150002
*   A VALID CONSOLE.                                                  * 23200002
*                                                                     * 23250002
*   ERR - IEE927I REQUEST AMBIGIOUS - IF MLWTO ID NOT SPECIFIED       * 24010002
*         IEE156I INVALID OPERAND - IF MLWTO ID NOT DIGIT             * 24020002
*********************************************************************** 24050002
         SPACE 2                                                        24100002
KCDRTN   EQU   *                                                        24200001
         CLI   N3(KOPS),BLANK      IS AN MLWTO ID SPECIFIED?     Y02669 24600002
         BE    DERR927             NO, IEE927I REQUEST AMBIGIOUS Y02669 24800002
         LA    KOPS,N3(KOPS)       INCREMENT POINTER TO COMMA           24802002
         CLI   N0(KOPS),COMMA      IS NEXT CHARACTER COMMA?      Y02669 24810002
         BNE   BADKOP              NO, IEE156I INVALID OPERAND   Y02669 24820002
         SPACE                                                          24850002
         LA    KOPS,N1(KOPS)       INCREMENT OPERAND POINTER TO ID      25000001
         TM    N0(KOPS),DIGIT      IS 1ST CHAR OF ID A DIGIT?    Y02669 25200002
         BNO   BADKOP              NO, IEE156I INVALID OPERAND          25400002
         SPACE                                                          25450002
         TM    N1(KOPS),DIGIT      IS 2ND CHAR OF ID A DIGIT?    Y02669 25600002
         BO    TWODIGIT            YES, BRANCH                          25800002
         CLI   N1(KOPS),BLANK      IS 2ND CHARACTER A BLANK?     Y02669 25900002
         BNE   BADKOP              NO, IEE156I INVALID OPERAND   Y02669 25950002
         SPACE                                                          25960002
         PACK  XAP(N8),N0(N1,KOPS) PACK EBCDIC MLWTO ID                 26000001
         B     FINDUCME            BRANCH TO CONVERT NUMBER             26200001
         SPACE  2                                                       26250002
TWODIGIT EQU   *                                                        26400001
         TM    N2(KOPS),DIGIT      IS 3RD CHAR OF ID A DIGIT?    Y02669 26600002
         BO    THRDIGIT            YES, BRANCH                          26800002
         CLI   N2(KOPS),BLANK      IS 3RD CHARACTER A BLANK?     Y02669 26900002
         BNE   BADKOP              NO, IEE156I INVALID OPERAND   Y02669 26950002
         SPACE                                                          26960002
         PACK  XAP(N8),N0(N2,KOPS) PACK EBCDIC MLWTO ID                 27000001
         B     FINDUCME            BRANCH TO CONVERT NUMBER             27200001
         SPACE  2                                                       27250002
THRDIGIT EQU   *                                                        27400001
         CLI   N3(KOPS),BLANK      IS 4TH CHARACTER A BLANK?     Y02669 27450002
         BNE   BADKOP              NO, IEE156I INVALID OPERAND   Y02669 27500002
         SPACE                                                          27550002
         PACK  XAP(N8),N0(N3,KOPS) PACK EBCDIC MLWTO ID                 27600001
         EJECT                                                          27602002
*********************************************************************** 27610002
*                                                                     * 27650002
*             THE MLWTO ID ENTERED IS IN EBCDIC AND MUST         Y02669 27700002
*             BE CONVERTED TO BINARY FOR COMPARE                 Y02669 27750002
*                                                                     * 27750402
*    FIND AND BASE UCM ENTRY                                          * 27752002
*    INPUT- REG 1-CONSOLE ID RIGHT JUSTIFIED, HIGH ORDER BYTES ZERO   * 27754002
*    OUTPUT-POINTER TO UCMENTRY SPECIFIED BY CONSOLE ID IN UCMEBASE REG 27756002
*    REG USAGE-DESTROYS CONTENTS OF: REG 0,1,UCMEBASE                 * 27758002
*                                                                     * 27758102
*  ERR - IEE156I INVALID OPERAND - IF TARGET CONSOLE'S WQE ADDRESS    * 27758402
*                                  IS ZERO                            * 27758802
*********************************************************************** 27760002
         SPACE 2                                                        27800001
FINDUCME EQU   *                                                        28400001
         CVB   R7,XAP              CONVERT TO BINARY                    28600001
         SR    R1,R1               CLEAR REG                            31600001
         IC    R1,XASCID           LOAD TARGET CONSOLE ID               31800002
         L     UCMEBASE,UCMVEA     POINT TO FIRST UCM ENTRY             32000002
         BCTR  R1,ZERO             SUBTRACT ONE FROM CONSOLE ID         32200001
         M     R0,UCMVEZ           MULTIPLY ENTRY SIZE BY REDUCED ID    32400001
         AR    UCMEBASE,R1         POINT TO DESIRED UCM ENTRY           32600001
         L     CQEREG,UCMOUTQ      GET CQE POINTER FROM UCME     Y02669 32800002
         LTR   CQEREG,CQEREG       IS THERE A CQE CHAIN?         Y02669 33000002
         BZ    BADKOP              NO, IEE156I INVALID OPERAND          33200002
         EJECT                                                          33250001
*********************************************************************** 34400001
*                                                                     * 34402002
*        SEARCH CONSOLE OUTPUT QUEUE FOR PROPER MLWTO WQE        Y02669 34412002
*                                                                     * 34420002
*********************************************************************** 34450002
         SPACE 2                                                        34500002
RETEST   EQU   *                                                        34600001
         TM    CQEFLAG,CQEENTR     IS THIS QUE ENTRY ACTIVE?     Y02669 34800002
         BNO   NXTENTRY            BRANCH NO FOR NEXT ELEMENT    Y02669 35000002
         SPACE 2                                                        35050002
         TM    CQEFLAG,CQEMAJOR    IS THIS A MLWTO?              Y02669 36200002
         BNO   NXTENTRY            BRANCH NO FOR NEXT ELEMENT    Y02669 36400002
         SPACE 2                                                        36450002
         TM    CQEFLAG,CQEMLQHC    IS THIS A HARD COPY MLWTO?    Y02669 36600002
         BO    NXTENTRY            BRANCH YES FOR NEXT ELEMENT   Y02669 36800002
         SPACE 2                                                        36850002
         SR    WQEREG,WQEREG       CLEAR REG FOR ADDRESS         Y02669 36900002
         ICM   WQEREG,N7,CQEWQEA   GET MAJOR WQE POINTER FROM CQEY02669 36950002
         L     R6,WMJMMSGN         LOAD WQE MLWTO ID                    37000002
         SR    R9,R9               ZERO OUT REGISTER           @Y02668P 37003002
         ICM   R9,N7,WMJMSEQ       SAVE DOM SEQUENCE #         @Y02668P 37006002
LOOP     EQU   *                                                 Y02669 37010002
         C     R6,B1000            IS ID GREATER THAN 1000?       M2722 37050002
         BL    COMPARE             NO, GO COMPARE                 M2722 37100001
         S     R6,B1000            YES, REDUCE BY 1000            M2722 37150001
         B     LOOP                TRY AGAIN                      M2722 37200001
         SPACE 2                                                        37400001
COMPARE EQU   *                                                   M2722 37850001
         CR    R6,R7               COMPARE THE 2 MLWTO ID'S             38000001
         BE    SETSUBQ             COMMAND ID EQUALS WQE ID             38200002
         EJECT                                                          38400002
*********************************************************************** 38800001
*                                                                     * 38802002
*    BRANCH HERE IF:  WQE NOT ACTIVE                             Y02669 38810002
*                     WQE NOT MLWTO                              Y02669 38820002
*                     WQE REPRESENTS HARD COPY MLWTO             Y02669 38830002
*                     WQE ID DOES NOT MATCH COMMAND'S ID         Y02669 38840002
*   ERR - IEE156I INVALID OPERAND - IF END OF QUEUE AND NO MATCH Y02669 38842002
*                                                                     * 38844002
*********************************************************************** 38850002
         SPACE 2                                                        38900002
NXTENTRY EQU   *                                                 Y02669 39000002
         TM    CQEFLAG,CQEEOB      IS IT A POINTER TO NEW BLOCK? Y02669 39200002
         BO    BUMPSUBQ            NO, JUST BUMP BLOCK POINTER          39400002
         SPACE 2                                                        39600001
         TM    CQEFLAG,CQEEOQ      END OF LIST?                  Y02669 40200002
         BO    BADKOP              YES, IEE156I INVALID OPERAND         40400002
         SPACE 2                                                        40600001
         LA    CQEREG,N4(CQEREG)   INCREMENT Q PTR TO NEXT ENTRY Y02669 41200002
         B     RETEST              CONTINUE SEARCH                      41400001
         SPACE 2                                                        41600002
BUMPSUBQ EQU   *                                                        42400001
         L     CQEREG,N0(CQEREG)   LOAD POINTER TO NEXT SECTION  Y02669 42600002
         B     RETEST              CONTINUE SEARCH                      42800001
         EJECT                                                          42850002
*********************************************************************** 43650002
*                                                                     * 43800002
*           DELETION OF THE MLWTO                              @Y02669P 44000002
*             1. OBTAIN DOM SEQUENCE NUMBER - WMJMSEQ          @Y02669P 44030002
*             2. THEN MAKE IT LOOK AS IF THE MLWTO HAS         @Y02669P 44120002
*                   BEEN PROCESSED                             @Y02669P 44150002
*                                                                     * 44200002
*********************************************************************** 44250002
         SPACE 3                                                        44400001
SETSUBQ  EQU   *                                                        45000001
         OI    CQEFLAG,CQEAVAIL    SET PURGE BIT ON IN CQE       Y02669 45200002
         NI    CQEFLAG,XFF-CQEENTR TURN OFF ACTIVE BIT IN CQE    Y02669 45400002
         OI    UCMSTS,UCMTB        SET DEQUEUE BIT ON IN UCME           45600001
         SPACE 2                                                        45610002
*********************************************************************** 45650002
*                                                                     * 45800002
*              GET MINOR WQE POINTER FROM UCME                        * 46050002
*                1. IF ZERO, RETURN TO SYSTEM                         * 46100002
*                OR UCMMLAST MAY PT TO THE MINOR                      * 46150002
*                   THAT WAS JUST WRITTEN AND MAY                     * 46160002
*                   HAVE USE COUNT DECREMENTED                        * 46170002
*                1. IF NOT FULL CAPABILITY, GET POINTER TO NEXT       * 46180002
*                2. IF GRAPHICS CONSOLE, GET POINTER TO NEXT          * 46190002
*                                                                     * 46200002
*********************************************************************** 46250002
         SPACE 2                                                        46300002
         L     WQEREG,UCMMLAST     MINOR WQE PTR FROM UCME       YM2304 46400001
         LTR   WQEREG,WQEREG       IS MINOR POINTER ZERO?        YM2304 46600002
         BZ    ENDSRCH             YES, END SEARCH                      46800002
         TM    UCMDISP,UCMDISPE    IS TARGET CONSOLE FULL CAPABILITY?   47200002
         BZ    NXTMINOR            NO, GET NEXT MINOR            Y02669 47400002
         SPACE                                                          47450002
         TM    UCMDISP,UCMDISPC    IS THIS CONSOLE A GRAPHIC DEVICE?    47500002
         BO    NXTMINOR            YES, GET NEXT MINOR           Y02669 47550002
         EJECT                                                          48400002
*********************************************************************** 48450002
*                                                                     * 48500002
*                 DECREMENT USE COUNT IN MINOR WQE'S                  * 48550002
*                                                                     * 48600002
*********************************************************************** 48610002
         SPACE 2                                                        48650002
MINLOOP  EQU   *                                                        49000001
         LA    WQEREG,N0(WQEREG)   ZERO HI ORDER BYTE OF MIN WQE YM2304 49200001
         LTR   WQEREG,WQEREG       IS IT A VALID POINTER?        YM2304 49400002
         BZ    ENDSRCH             NO, END SCAN                         49600002
         DROP  CQEREG                                                   49650002
         SR    R5,R5               CLEAR REG                     Y02669 49800002
         IC    R5,WMNMUC1          GET USE COUNT FROM MINOR      Y02669 50600002
         BCTR  R5,N0               DECREMENT USE COUNT BY ONE    Y02669 50800002
         STC   R5,WMNMUC1          PUT NEW COUNT BACK IN MINOR   Y02669 51000002
         LTR   R5,R5               IS THE USE COUNT ZERO?        Y02669 51200002
         BNZ   NXTMINOR            NO                            Y02669 51400002
         OI    WMJMMLW,WMJMMLWG    SERVICE THIS CHAIN = ON     @YM8168P 51800002
NXTMINOR EQU   *                                                        52200001
         L     WQEREG,N0(WQEREG)   LOAD PTR TO NEXT MINOR WQE    YM2304 52400001
         B     MINLOOP                                                  52600001
         EJECT                                                          55400002
*********************************************************************** 55450002
*                                                                     * 55460002
*                       NORMAL EXIT                                   * 55470002
*                                                                     * 55480002
* NOTE: LOCKS ARE ALWAYS HELD ON ENTRY TO IEE7803D                    * 55490002
*             1. RELEASE LOCKS                                        * 55492002
*             2. ISSUE A DOM MACRO TO BUILD AN SSIB AND SSOB   @Y02669P 55494002
*                   TO INFORM THE SUBSYSTEM THE MLWTO HAS BEEN @Y02669P 55496002
*                   DELETED                                    @Y02669P 55498002
*********************************************************************** 55500002
         SPACE 2                                                        55550002
ENDSRCH  EQU   *                                                        55600002
         OI    UCMSTS,UCMPF        TURN ON OUTPUT PENDING BIT           55650002
         NI    UCMSTS,XFF-UCMTC    WORKING ON INLINE MLWTO=OFF   Y02669 55700002
         NI    UCMSDS5,XFF-UCMSDS5A WAITING ON INLINE MLWTO=OFF  Y02669 55750002
         STM   MYBASE,R14,XASAVLOC SAVE REGS AROUND SETLOCK      Y02651 55900002
         SETLOCK RELEASE,TYPE=CMS,RELATED=(K,IEE7503D(LOCKSET))         55950002
         SETLOCK RELEASE,TYPE=LOCAL,RELATED=(K,IEE7503D(LOCKSET))       56000002
         LM    MYBASE,R14,XASAVLOC RESTORE REGS AFTER SETLOCK    Y02651 56050002
         NI    XASSDS,XFF-XASSDS5  INDICATE LOCKS NOW OFF        Y02651 56100002
         DOM   MSG=(9)                                         @Y02668P 65100002
         BR    R14                 RETURN TO SYSTEM              Y02669 69800002
         EJECT                                                          69802002
*********************************************************************** 69810002
*                                                                     * 69820002
*                       ERROR EXITS                                   * 69830002
*                                                                     * 69840002
*********************************************************************** 69842002
         SPACE 2                                                        69844002
BADKOP   EQU   *                                                 Y02669 69850002
         MVI   XAE,MSG156          IEE156I INVALID OPERAND       Y02669 69900002
         ST    KOPS,XASTSAVE       ADDR OF INVALID OPERAND       Y02669 69950002
         B     D5603D              GO TO WRITE ERROR MSG         Y02669 69960002
         SPACE 2                                                        69970002
DERR927  EQU   *                                                 Y02669 70000002
         ST    KOPS,XASTSAVE       CURSOR ADDRESS FOR MSG RTN           70200001
         MVI   XAE,MSG927          IEE927I REQUEST AMBIGIOUS     Y02669 70400002
         MVI   XASTSAVE,MSG927I    2ND CODE - SPECIFY DISPLAY ID Y02669 70600002
         SPACE 2                                                        70650002
D5603D   EQU   *                                                 Y02669 71400002
         L     R15,VCON5603        GET ADDRESS OF MESSAGE MODULE Y02669 73250002
         BR    R15                 GO ISSUE ERROR MESSAGES       Y02669 73300002
        EJECT                                                           84450002
*********************************************************************** 84600001
*                                                                     * 84800002
*                           CONSTANTS                                 * 85000002
*                                                                     * 85200002
*********************************************************************** 85400001
         SPACE 2                                                        85450002
         DS    0F                  ALIGN ON WORD BOUNDARY               85600001
B1000    DC    F'1000'             COMPARE FOR MLWTOID OVER 1000  M2772 85850002
VCON5603 DC    V(IEE5603D)         MSG MOD                       Y02669 86406002
         SPACE 5                                                        86410002
*********************************************************************** 86412002
*                                                                     * 86420002
*                             PATCH AREA                              * 86430002
*                                                                     * 86450002
*********************************************************************** 86500002
         SPACE 2                                                        86550002
PATCH    DC    C'****PATCH AREA****'                                    86600001
PATCH2   DC    C'IEE7803D-TEST ONLY'                                    86800001
PATCH3   DC    36C' '                                                   87000001
         EJECT                                                          87200001
         IEECUCM  FORMAT=NEW                                            88200002
         EJECT                                                          88400001
         IHACTM CQE                                              Y01939 88410001
         EJECT                                                          88420001
         IHAWQE DSECT=YES                                        YM2304 88450001
         EJECT                                                          89600001
FAUXSA   DSECT                                                          89800001
         IEEXSA                                                         90000001
         EJECT                                                          91800001
CVTSECT  DSECT                                                          92000001
         CVT                                                            92200001
         EJECT                                                          92250002
         IHAPSA                                                         92300002
         END                                                            92800001
./  ADD  SSI=30601279,NAME=IEE90110
IEE90110 CSECT                                                          00050002
         TITLE 'MESSAGE ASSEMBLY MODULE'                                00100002
*********************************************************************** 00150001
*MODULE NAME= IEE90110                                                  00600002
*                                                                       00620002
*DESCRIPTIVE NAME= MESSAGE ASSEMBLY MODULE , HALT / SWITCH COMMANDS     00630002
*                                                                       00640002
*COPYRIGHT= N/A                                                         00650002
*                                                                       00660002
*STATUS= OS/VS2  RELEASE 2                                              00670002
*                                                                       00680002
*FUNCTION= ASSEMBLES AND EDITS MESSAGES FOR HALT/SWITCH COMMANDS AND    00690002
*          ISSUES THE WTO ..                                            00692002
*  OPERATION= FROM THE XAE FIELD IN THE EXTENDED SAVE AREA (XSA), THE   00700002
*             BYTE IS CHECKED TO SEE IF IT IS WITHIN THE CODE TABLE'S   00710002
*             (T1) LIMITS.  THE BYTE ITSELF IS USED AS AN INDEX TO T1,  00720002
*             WHICH CONTAINS, AS ELEMENTS, POINTERS TO THE MESSAGE      00724002
*             TEXT TABLE, T2.  THE MESSAGE IS ASSEMBLED AS FOLLOWS:     00726002
*                1) THE XAH FIELD OF THE XSA IS ZEROED OUT.             00728002
*                2) THE CONSOLE ID IS MOVED FROM XAU                    00728802
*                   INTO REGISTER 0.                                    00729202
*                3) THE MCSFLAG FIELD IS SET FOR THE WTO.               00729302
*                4) THE VERB IS MOVED FROM XAV TO XAF.                  00729602
*                5) THE PRE-FORMATTED TEXT IS MOVED IN.                 00729702
*                6) THE MESSAGE LENGTH IS PUT INTO XAH .                00729802
*                7) THE DESCRIPTOR AND ROUTING CODES                    00733802
*                   ARE MOVED IN.                                       00733902
*                8) THE WTO MACRO IS ISSUED.                            00737102
*                                                                       00743602
*NOTES                                                                  00746802
*  DEPENDENCIES= SEE BELOW                                              00750002
*    CHARACTER-CODE DEPENDENCIES= THE OPERATION OF THIS MODULE DEPENDS  00760002
*                                 UPON AN INTERNAL REPRESENTATION OF    00762002
*                                 THE EXTERNAL CHARACTER SET WHICH IS   00766002
*                                 EQUIVALENT TO THE ONE USED AT         00768002
*                                 ASSEMBLY TIME.  THE CODING HAS BEEN   00768402
*                                 ARRANGED SO THAT A REDEFINITION OF    00768802
*                                 'CHARACTER' CONSTANTS, BY REASSEMBLY, 00769202
*                                 WILL RESULT IN A CORRECT MODULE FOR   00769602
*                                 THE NEW DEFINITIONS.                  00769702
*  RESTRICTIONS= NONE                                                   00770002
*  REGISTER-CONVENTIONS= STANDARD                                       00780002
*  PATCH-LABEL= N/A                                                     00790002
*                                                                       00800002
*MODULE TYPE= CSECT                                                     00810002
*  PROCESSOR= ASSEM                                                     00820002
*  MODULE SIZE= 520 BYTES                                               00830002
*  ATTRIBUTES= REENTRANT, SELF-RELOCATABLE, READ-ONLY, AND TRANSIENT    00840002
*                                                                       00850002
*ENTRY POINT= IEE90110                                                  00860002
*  PURPOSE= SAME AS FUNTION                                             00870002
*  LINKAGE= FROM IEE70110 VIA BRANCH                                    00880002
*  INPUT= REGISTER 1 POINTING TO THE XSA                                00890002
*  REGISTERS SAVED= NONE                                                00900002
*  REGISTER USAGE= R0    UCMI FOR WTO                                   00910002
*                  R1    WORK REGISTER                                  00912002
*                  R2    POINTER TO XSA                                 00914002
*                  R3    WORK REGISTER                                  00916002
*                  R4    MODULE BASE REGISTER                           00918002
*                  R5    POINTER TO THE CVT                             00918402
*                  R6    UNUSED                                         00918802
*                  R7    UNUSED                                         00919202
*                  R8    UNUSED                                         00919602
*                  R9    UNUSED                                         00919702
*                  R10   UNUSED                                         00919802
*                  R11   UNUSED                                         00919902
*                  R12   UNUSED                                         00923202
*                  R13   UNUSED                                         00925202
*                  R14   RETURN ADDRESS                                 00925602
*                  R15   UNUSED                                         00926002
*  REGISTERS RESTORED= NONE                                             00926702
*                                                                       00930002
*EXIT - NORMAL= RETURN TO CALLER                                        00940002
*  CONDITIONS= ALWAYS                                                   00950002
*  OUTPUT= MESSAGE OUTPUT (SEE BELOW)                                   00960002
*  RETURN CODES= NONE                                                   00970002
*                                                                       00980002
*EXIT - ERROR= NONE                                                     00990002
*                                                                       01030002
*EXTERNAL REFERENCES= SEE BELOW                                         01040002
*  ROUTINES= NONE                                                       01050002
*  DATA AREAS= IEEXSA (CONTAINS PERTINENT MESSAGE ASSEMBLY DATA)        01060002
*  CONTROL BLOCKS= IEEXSA - R,W                                         01070002
*                                                                       01100002
*TABLES= T1 (INDEX TABLE TO MESSAGE TABLE)                              01110002
*        T2 (MESSAGE TABLE)                                             01112002
*                                                                       01120002
*                                                                       01160002
*CHANGE ACTIVITY= Y02669                                                01170002
*                                                                       01180002
*SYSGENS=                                                               01180402
*       LOAD MODULE NAME = IEE70110                                     01180802
*       LPALIB NAME = IEE90110                                          01181202
*SYSTEM LIBRARIES = NONE .                                              01181602
*                                                                       01182002
*MESSAGES= IEE334I CCCCCCCC EOD SUCCESSFUL                              01190002
*          IEE706I CCCCCCCC NOT SUCCESSFUL                              01192002
*                                                                       01200002
*ABEND CODES= NONE                                                      01210002
*                                                                       01220002
*********************************************************************** 01230002
         EJECT                                                          03750001
*         REGISTER ASSIGNMENTS                                        * 03800001
R0       EQU   0                        FOR PASSING UCMI                03850001
R1       EQU   1                             T2 POINTER                 03900001
R2       EQU   2                             BASE FOR XSA               03950001
R3       EQU   3                             WORK REGISTER              04000001
MBASE    EQU   4                             BASE FOR PROGRAM           04050001
R14      EQU   14                       RETURN REG                      04100001
R15      EQU   15                       TPUT RETURN CODE REG            04150001
D0       EQU   0                        LENGTHS,OFFSETS,ETC.            04200001
D1       EQU   1                        *                               04250001
D2       EQU   2                        *                               04300001
D3       EQU   3                        *                               04350001
D4       EQU   4                                                        04400001
D5       EQU   5                        *                               04450001
D7       EQU   7                        *                               04500001
D8       EQU   8                        *                               04550001
D9       EQU   9                        *                               04600001
D22      EQU   22                       *                               04700001
BLANK    EQU   C' '                     *                               04800001
CODHI    EQU   X'02'                    HIGHEST VALID MSG CODE   YM1294 04900001
MCS      EQU   X'E0'                    NOTE - IN WTO MCSFLAG FIELD,    04950001
*                                       X'80' MEANS ROUTING AND/OR DE-  05000001
*                                       SCRIPTOR CODES ARE SPECIFIED -  05050001
*                                       X'40' MEANS THE WTO GOES TO THE 05100001
*                                       CONSOLE WHOSE UCMI IS IN REG 0  05150001
*                                       X'20' MEANS THE WTO IS AN IM-   05200001
*                                       MEDIATE COMMAND RESPONSE        05250001
*                                                                     * 05300001
*A  ESTABLISH PROGRAM ADDRESSABILITY                                  * 05550001
         BALR  MBASE,0                                                  05600001
         USING *,MBASE                                                  05650001
         MODID BRANCH=YES                                        Y01886 05660001
         USING XSA,R2                        BASE REGISTER FOR XSA      05700001
         LR    R2,R1                   SET UP XSA ADDRESSIBILITY        05710002
*  SET UP XSA HEADER                                                    05900001
         SR    R3,R3                         CLEAR WORKING REGISTER     05950001
         ST    R3,XAH                   CLEAR OUT XSA HEADER            06000001
* OBTAIN MESSAGE CODE AND COMPUTE APPROPRIATE T1 ELEMENT ADDRESS        06050001
         IC    R3,XAE                        GET MESSAGE CODE           06100001
         AR    R3,R3                    DOUBLE FOR INDEXING             06150001
         LA    R1,T1(R3)                PT TO APPROPRIATE T1 ELEMENT    06200001
         LH    R1,0(R1)                      LOAD TABLE ELEMENT         06250001
         IC    R0,XAU              GET UCMI                             06700002
         OI    XAH+D2,MCS               SET MCSFLAG FOR WTO             06750001
* BUILD MESSAGE IN XSA                                                  06850001
         MVC   XAF(D8),XAV              MOVE SOURCE TEXT                06900001
         MVI   XAT,BLANK                FOLLOW VERB BY BLANK            06950001
* FILL IN MESSAGE ID AND PREFORMATTED TEXT                              07000001
         MVC   XAI(D3),FAUFIX           MOVE IN 'IEE'                   07050001
         LA    R3,T2(R1)                PT TO APPRPRIATE T2 ELEMENT     07100001
         MVC   XAI+D3(D4),D5(R3)        FILL IN MSG ID                  07150001
         MVI   XAI+D7,BLANK             MAKE 8TH CHARACTER BLANK        07200001
         SR    R1,R1                    CLEAR FOR INSERT CHARACTER      07250001
         IC    R1,D4(R3)                GET MSG. TEXT LN.               07300001
         EX    R1,FAUPFT                MOVE MSG. TEXT IN               07350001
* SET UP FOR WTO TO A CONSOLE                                           08400001
         LA    R1,D22(R1)               MSG LN = VARIABLE TEXT LN       08450001
*                                       + 4-BYTE HDR + 8-BYTE ID        08500001
*                                       + BLANK + 8-BYTE VERB           08550001
         STH   R1,XAH                   STORE LN IN BUFFER FOR WTO      08600001
         AR    R1,R2                    PT. R1 TO END OF MSG.           08650001
         MVC   D0(D4,R1),D0(R3)         MOVE IN DESC,ROUTE CODES        08700001
         WTO   MF=(E,(R2))              WRITE MSG.                      08750001
         BR    14                       RETURN TO IEE70110              08800002
         SPACE 2                                                        09000001
FAUFIX   DC    CL3'IEE'                 FIXED PART OF MSG ID            09050001
FAUPFT   MVC   XAT+D1(D1),D9(R3)        MOVE IN PREFORMATTED TEXT       09100001
         EJECT                                                          09150001
* THE FOLLOWING TABLE IS INDEXED BY TWICE THE MSG. CODE. EACH HALF-     09200001
* WORD POINTS TO A T2 ELEMENT CONTAINING THE APPROPRIATE MESSAGE.       09250001
         SPACE 2                                                        09300001
T1       EQU   *                                                        09350001
         SPACE 2                                                        09400001
         DC    AL2(0)                                                   09450001
         DC    Y(TM01-T2-PREMSG)                                        09500001
         DC    Y(TM02-T2-PREMSG)                                 YM1294 09510001
* NEW MESSAGES SHOULD BE ADDED TO THIS TABLE USING THE SAME FORMAT      09550001
* Y(TM0X-T2-PREMSG) WHERE X IS A NUMBER GREATER THAN THE LAST ENTRY.    09650001
* THIS TABLE IS BASED ON THE ONE USED IN MODULE IEE0503D.               09750001
         EJECT                                                          11250001
         SPACE 2                                                        11300001
PREMSG   EQU   9                        NUMBER BYTES BEFORE MSG TEXT    11350001
         SPACE 2                                                        11400001
* THE FOLLOWING TABLE CONTAINS 2-BYTE DESCRIPTOR CODE, 2-BYTE ROUTING   11450001
* CODE, 1-BYTE LENGTH OF PREFORMATTED MSG TEXT, 4-BYTE ID FILLER, AND   11500001
* PREFORMATTED MSG TEXT.                                                11550001
T2       EQU   *                                                        11560001
         SPACE 2                                                        11600001
         DC    X'0800'                                                  11860001
         DC    X'4000'                                                  11870001
         DC    AL1(L'TM01-1)                                            11880001
         DC    C'334I'                                                  11890001
TM01     DC    C'EOD SUCCESSFUL'                                        11892001
         DC    X'0800'                                           YM1294 11902001
         DC    X'0000'                                           YM1294 11912001
         DC    AL1(L'TM02-1)                                     YM1294 11922001
         DC    C'706I'                                           YM1294 11932001
TM02     DC    C'NOT SUCCESSFUL'                                 YM1294 11934001
* NEW MESSAGES SHOULD BE ADDED TO THIS TABLE USING THE SAME FORMAT.     11942001
* THIS TABLE IS BASED ON THE ONE USED IN MODULE IEE0503D.               11992001
         EJECT                                                          20700001
FAUXSA   DSECT                                                          20750001
         IEEXSA                                                         20800001
         END                                                            20850001
./  ADD  SSI=80680113,NAME=IEE9403D
         TITLE 'IEE9403D -  MSS PREPROCESSOR ROUTINE                   *00001000
                        '                                               00002000
IEE9403D CSECT ,                                                   0001 00003000
@MAINENT BALR  @15,0                                               0001 00004000
         USING *,@15                                               0001 00005000
         B     @PROLOG                                             0001 00006000
         DC    AL1(16)                                             0001 00007000
         DC    C'IEE9403D  78.068'                                 0001 00008000
         DROP  @15                                                      00009000
@PROLOG  BALR  @12,0                                               0001 00010000
@PSTART  DS    0H                                                  0001 00011000
         USING @PSTART,@12                                         0001 00012000
DEFREG   DS    0H                                                  0003 00013000
*                                                                  0043 00014000
*/********************************************************************/ 00015000
*/*                                                                  */ 00016000
*/* THE FOLLOWING LOGIC CHECKS FOR  MSS'S PRESENCE AND IF SO, GETS   */ 00017000
*/* CORE FOR A NEW CWB                                               */ 00018000
*/*                                                                  */ 00019000
*/********************************************************************/ 00020000
*                                                                  0043 00021000
         SPACE 1                                                        00022000
*   XASAVSTD(1)=R14;                /* SAVE RETURN REGISTER          */ 00023000
         ST    R14,XASAVSTD(,XSAPTR)                               0043 00024000
*   CMNDCONT=OFF;                   /* COMMAND OK SW OFF     @G24LPSJ*/ 00025000
         NI    CMNDCONT(XSAPTR),B'01111111'                        0044 00026000
*   IF CVTICB=0 THEN               /* IF ICB EXISTS THEN DO @G24LPSJ*/ 00027000
         L     @15,CVTPTR                                          0045 00028000
         L     @15,CVTEXT2(,@15)                                   0045 00029000
         L     @15,CVTICB(,@15)                                    0045 00030000
         LTR   @15,@15                                             0045 00031000
         BZ    @RF00045                                            0045 00032000
*     DO;                           /*                       @G24LPSJ*/ 00033000
*       IF ICBR=ON THEN             /* IF MSS READY THEN     @G24LPSJ*/ 00034000
         TM    ICBR(@15),B'01000000'                               0047 00035000
         BNO   @RF00047                                            0047 00036000
*         CMNDCONT=ON;              /* ALLOW ALL COMMANDS    @G24LPSJ*/ 00037000
         OI    CMNDCONT(XSAPTR),B'10000000'                        0048 00038000
*       ELSE                        /* ELSE                  @G24LPSJ*/ 00039000
*         IF XAN=VARYCMND&          /* IF A VARY CMND AND    @G24LPSJ*/ 00040000
*             ICBB=ON THEN          /* MSS ''BROKEN'' THEN   @G24LPSJ*/ 00041000
         B     @RC00047                                            0049 00042000
@RF00047 CLC   XAN(1,XSAPTR),VARYCMND                              0049 00043000
         BNE   @RF00049                                            0049 00044000
         L     @15,CVTPTR                                          0049 00045000
         L     @15,CVTEXT2(,@15)                                   0049 00046000
         L     @15,CVTICB(,@15)                                    0049 00047000
         TM    ICBB(@15),B'00010000'                               0049 00048000
         BNO   @RF00049                                            0049 00049000
*           DO;                     /*                       @G24LPSJ*/ 00050000
*             ENDSCAN=XAR+BUFFSIZE-LENGTH(MSSCVON);/* FIND END OF  0051 00051000
*                                      BUFFER                @G24LPSJ*/ 00052000
         L     @15,XAR-1(,XSAPTR)                                  0051 00053000
         LA    @15,0(,@15)                                         0051 00054000
         LH    ENDSCAN,BUFFSIZE(,@15)                              0051 00055000
         ALR   ENDSCAN,@15                                         0051 00056000
         SL    ENDSCAN,@CF01438                                    0051 00057000
*             DO SCANPTR=XAL TO ENDSCAN WHILE(CMNDCONT=OFF);       0052 00058000
*                                                                  0052 00059000
         L     @15,XAL-1(,XSAPTR)                                  0052 00060000
         LA    @15,0(,@15)                                         0052 00061000
         B     @DE00052                                            0052 00062000
@DL00052 TM    CMNDCONT(XSAPTR),B'10000000'                        0052 00063000
         BNZ   @DC00052                                            0052 00064000
*               /*****************************************************/ 00065000
*               /*                                                   */ 00066000
*               /* SCAN FOR VARY MSC ONLINE OPERANDS         @G24LPSJ*/ 00067000
*               /*                                                   */ 00068000
*               /*****************************************************/ 00069000
*                                                                  0053 00070000
*               IF CMNDPARM=MSSCVON THEN/* IF TRUE THEN      @G24LPSJ*/ 00071000
         L     @15,SCANPTR(,XSAPTR)                                0053 00072000
         CLC   CMNDPARM(14,@15),MSSCVON                            0053 00073000
         BNE   @RF00053                                            0053 00074000
*                 CMNDCONT=ON;      /* ALLOW VARY MSC CMND   @G24LPSJ*/ 00075000
         OI    CMNDCONT(XSAPTR),B'10000000'                        0054 00076000
*             END;                  /*                       @G24LPSJ*/ 00077000
@RF00053 LA    @15,1                                               0055 00078000
         AL    @15,SCANPTR(,XSAPTR)                                0055 00079000
@DE00052 ST    @15,SCANPTR(,XSAPTR)                                0055 00080000
         CR    @15,ENDSCAN                                         0055 00081000
         BNH   @DL00052                                            0055 00082000
@DC00052 DS    0H                                                  0056 00083000
*           END;                    /*                       @G24LPSJ*/ 00084000
*     END;                          /*                       @G24LPSJ*/ 00085000
@RF00049 DS    0H                                                  0057 00086000
@RC00047 DS    0H                                                  0058 00087000
*   IF CMNDCONT=ON THEN             /*                       @G24LPSJ*/ 00088000
@RF00045 TM    CMNDCONT(XSAPTR),B'10000000'                        0058 00089000
         BNO   @RF00058                                            0058 00090000
*     DO;                           /*                       @G24LPSJ*/ 00091000
*       R0=GETINFO;                 /* SET UP FOR GETMAIN            */ 00092000
         L     R0,GETINFO                                          0060 00093000
*       DO;                         /* GETMAIN (R) LV(R0)            */ 00094000
*         RESPECIFY                                                0062 00095000
*          (GPR01F,                                                0062 00096000
*           GPR00F) RESTRICTED;                                    0062 00097000
*         GPR00F=R0;                /* LENGTH REQUESTED              */ 00098000
*         GPR01F=-1;                /* INDICATE A GETMAIN REQUEST    */ 00099000
         SLR   GPR01F,GPR01F                                       0064 00100000
         BCTR  GPR01F,0                                            0064 00101000
*         SVC(10);                  /* R-FORM OF GETMAIN             */ 00102000
         SVC   10                                                  0065 00103000
*         RESPECIFY                                                0066 00104000
*          (GPR01F,                                                0066 00105000
*           GPR00F) UNRESTRICTED;                                  0066 00106000
*       END;                        /* GETMAIN (R) LV(R0) GET A CWB     00107000
*                                      BLOCK INTO CORE               */ 00108000
         EJECT                                                          00109000
*                                                                  0068 00110000
*/********************************************************************/ 00111000
*/*                                                                  */ 00112000
*/*      THE FOLLOWING LOGIC INITIALIZES A NEWLY GOTTEN CWB          */ 00113000
*/*                                                                  */ 00114000
*/********************************************************************/ 00115000
*                                                                  0068 00116000
         SPACE 1                                                        00117000
*       CWBPTR=R1;                  /* SET UP CWB ADDRESSABILITY     */ 00118000
         LR    CWBPTR,R1                                           0068 00119000
*       CWB(1:LENGTH(CWB))=''B;     /* CLEAR THE CWB BLOCK           */ 00120000
         XC    CWB(144,CWBPTR),CWB(CWBPTR)                         0069 00121000
*       CWBFREE=GETINFO;            /* SAVE INFO FOR FREEMAIN        */ 00122000
         MVC   CWBFREE(4,CWBPTR),GETINFO                           0070 00123000
*       CWBVBCDE=XAN;               /* GET VERB CODE                 */ 00124000
         MVC   CWBVBCDE(1,CWBPTR),XAN(XSAPTR)                      0071 00125000
*       CWBUCMID=XAU;               /* GET UCM ID                    */ 00126000
         IC    @15,XAU(,XSAPTR)                                    0072 00127000
         STC   @15,CWBUCMID(,CWBPTR)                               0072 00128000
*       CWBAUTH(1:2)=XAS(1:2);      /* GET COMMAND AUTHORITY         */ 00129000
         MVC   CWBAUTH(2,CWBPTR),XAS(XSAPTR)                       0073 00130000
*       CWBCMND='';                 /* BLANK CWB OPERAND FIELD       */ 00131000
         MVI   CWBCMND(CWBPTR),C' '                                0074 00132000
         MVC   CWBCMND+1(125,CWBPTR),CWBCMND(CWBPTR)               0074 00133000
*       CWBLCC=XASCID;              /* TARGET CONSOLE ID     @Z40LPTA*/ 00134000
         LA    @15,32                                              0075 00135000
         ALR   @15,XSAPTR                                          0075 00136000
         IC    @04,XASCID(,@15)                                    0075 00137000
         STC   @04,CWBLCC(,CWBPTR)                                 0075 00138000
*       CWBLA=XASDID;               /* TARGET AREA ID        @Z40LPTA*/ 00139000
         MVC   CWBLA(1,CWBPTR),XASDID(@15)                         0076 00140000
*       IF XAL=0 THEN              /* IF NO PARAMETERS, AVOID       */ 00141000
         L     @15,XAL-1(,XSAPTR)                                  0077 00142000
         LA    @15,0(,@15)                                         0077 00143000
         LTR   @15,@15                                             0077 00144000
         BZ    @RF00077                                            0077 00145000
*         DO;                       /* OPERAND SIZE CALCUALATION     */ 00146000
*           SIZE=XAR+BUFFSIZE-XAL;  /* COMPUTE SIZE OF OPERANDS      */ 00147000
         L     @04,XAR-1(,XSAPTR)                                  0079 00148000
         LA    @04,0(,@04)                                         0079 00149000
         LH    SIZE,BUFFSIZE(,@04)                                 0079 00150000
         ALR   SIZE,@04                                            0079 00151000
         SLR   SIZE,@15                                            0079 00152000
*           IF SIZE>126 THEN        /* LIMIT THE MOVING OF THE       */ 00153000
         LA    @15,126                                             0080 00154000
         CR    SIZE,@15                                            0080 00155000
         BNH   @RF00080                                            0080 00156000
*             SIZE=126;             /* OPERAND FIELD                 */ 00157000
         LR    SIZE,@15                                            0081 00158000
*           CWBCMND(1:SIZE)=XALBUFF(1:SIZE);/* MOVE OPERANDS INTO THE   00159000
*                                      CWB                           */ 00160000
@RF00080 LR    @15,SIZE                                            0082 00161000
         BCTR  @15,0                                               0082 00162000
         L     @07,XAL-1(,XSAPTR)                                  0082 00163000
         EX    @15,@SM01471                                        0082 00164000
*         END;                                                     0083 00165000
         EJECT                                                          00166000
*                                                                  0084 00167000
*/********************************************************************/ 00168000
*/*                                                                  */ 00169000
*/* THE FOLLOWING LOGIC OBTAINS A 'SETLOCK' TO PROTECT THE UPDATING  */ 00170000
*/* OF THE CWB CHAIN                                                 */ 00171000
*/*                                                                  */ 00172000
*/********************************************************************/ 00173000
*                                                                  0084 00174000
         SPACE 1                                                        00175000
*       GEN;                                                       0084 00176000
@RF00077 DS    0H                                                  0084 00177000
GETLOCK1 SETLOCK OBTAIN,TYPE=LOCAL,MODE=UNCOND,REGS=USE,              **00178000
               RELATED=(SSC,IEE9403D(CLRLOCK2))                         00179000
GETLOCK2 SETLOCK OBTAIN,TYPE=CMS,MODE=UNCOND,REGS=USE,                **00180000
               RELATED=(SSC,IEE9403D(CLRLOCK1))                         00181000
         EJECT                                                          00182000
*                                                                  0085 00183000
*/********************************************************************/ 00184000
*/*                                                                  */ 00185000
*/* THE FOLLOWING LOGIC SEARCHES FOR AN EMPTY CWB CHAIN-AHEAD        */ 00186000
*/* POINTER AND PLACES THE NEW CWB ON THE CHAIN                      */ 00187000
*/*                                                                  */ 00188000
*/********************************************************************/ 00189000
*                                                                  0085 00190000
         SPACE 1                                                        00191000
*       IF ICBCOMQ=0 THEN           /* IF NO CWB'S CHAINED, THEN     */ 00192000
         L     @15,CVTPTR                                          0085 00193000
         L     @15,CVTEXT2(,@15)                                   0085 00194000
         L     @15,CVTICB(,@15)                                    0085 00195000
         L     @04,ICBCOMQ(,@15)                                   0085 00196000
         LTR   @04,@04                                             0085 00197000
         BNZ   @RF00085                                            0085 00198000
*         ICBCOMQ=CWBPTR;           /* INITIALIZE A CHAIN            */ 00199000
         ST    CWBPTR,ICBCOMQ(,@15)                                0086 00200000
*       ELSE                                                       0087 00201000
*         DO;                                                      0087 00202000
         B     @RC00085                                            0087 00203000
@RF00085 DS    0H                                                  0088 00204000
*           SAVEPTR=CWBPTR;         /* SAVE THE NEW CWB POINTER      */ 00205000
         LR    SAVEPTR,CWBPTR                                      0088 00206000
*           CWBPTR=ICBCOMQ;         /* THERE IS A CWB CHAIN SO       */ 00207000
         L     @15,CVTPTR                                          0089 00208000
         L     @15,CVTEXT2(,@15)                                   0089 00209000
         L     @15,CVTICB(,@15)                                    0089 00210000
         L     CWBPTR,ICBCOMQ(,@15)                                0089 00211000
*           DO WHILE(CWBCHAIN=0);  /* SEARCH FOR AN EMPTY           */ 00212000
         B     @DE00090                                            0090 00213000
@DL00090 DS    0H                                                  0091 00214000
*             CWBPTR=CWBCHAIN;      /* CHAIN-AHEAD POINTER           */ 00215000
         L     CWBPTR,CWBCHAIN(,CWBPTR)                            0091 00216000
*           END;                                                   0092 00217000
@DE00090 L     @15,CWBCHAIN(,CWBPTR)                               0092 00218000
         LTR   @15,@15                                             0092 00219000
         BNZ   @DL00090                                            0092 00220000
*           CWBCHAIN=SAVEPTR;       /* ADD NEW CWB TO THE CHAIN      */ 00221000
         ST    SAVEPTR,CWBCHAIN(,CWBPTR)                           0093 00222000
*         END;                                                     0094 00223000
         EJECT                                                          00224000
*                                                                  0095 00225000
*/********************************************************************/ 00226000
*/*                                                                  */ 00227000
*/* THE FOLLOWING LOGIC RELEASES THE 'SETLOCK' OBTAINED BEFORE IN    */ 00228000
*/* THIS MODULE AND DOES A POST TO THE  MSS SYSTEM                   */ 00229000
*/*                                                                  */ 00230000
*/********************************************************************/ 00231000
*                                                                  0095 00232000
         SPACE 1                                                        00233000
*       GEN;                                                       0095 00234000
@RC00085 DS    0H                                                  0095 00235000
CLRLOCK1 SETLOCK RELEASE,TYPE=CMS,RELATED=(SSC,IEE9403D(GETLOCK2)),   **00236000
               REGS=USE                                                 00237000
CLRLOCK2 SETLOCK RELEASE,TYPE=LOCAL,RELATED=(SSC,IEE9403D(GETLOCK1)), **00238000
               REGS=USE                                                 00239000
*       WKAREA(1)=ADDR(ICBCOM);     /* OBTAIN MSS ECB ADDRESS        */ 00240000
         LA    @15,XASAVSTD+4(,XSAPTR)                             0096 00241000
         L     @03,CVTPTR                                          0096 00242000
         L     @11,CVTEXT2(,@03)                                   0096 00243000
         L     @11,CVTICB(,@11)                                    0096 00244000
         LA    @11,ICBCOM(,@11)                                    0096 00245000
         ST    @11,WKAREA(,@15)                                    0096 00246000
*       WKAREA(2)=ADDR(MYASCB);     /* OBTAIN ASCB ADDRESS           */ 00247000
         L     @11,CVTMSER(,@03)                                   0097 00248000
         L     @11,BAASCB(,@11)                                    0097 00249000
         ST    @11,WKAREA+4(,@15)                                  0097 00250000
*       WKAREA(3)=ADDR(CVTBRET);    /* OBTAIN ERROR RETURN ADDR.     */ 00251000
         LA    @03,CVTBRET(,@03)                                   0098 00252000
         ST    @03,WKAREA+8(,@15)                                  0098 00253000
*       R1=ADDR(WKAREA(1));         /* GET NEEDED POST PARAMETER     */ 00254000
         LR    R1,@15                                              0099 00255000
*       GEN;                                                       0100 00256000
         POST  MF=(E,(1))              POST TO THE  MSS SYSTEM          00257000
*     END;                                                         0101 00258000
         EJECT                                                          00259000
*                                                                  0102 00260000
*/********************************************************************/ 00261000
*/*                                                                  */ 00262000
*/*     IF  MSS IS NOT PRESENT, A MESSAGE IS ISSUED BY IEE0503D      */ 00263000
*/*                                                                  */ 00264000
*/********************************************************************/ 00265000
*                                                                  0102 00266000
         SPACE 1                                                        00267000
*   ELSE                                                           0102 00268000
*     DO;                                                          0102 00269000
         B     @RC00058                                            0102 00270000
@RF00058 DS    0H                                                  0103 00271000
*       XAE='18'X;                  /* SET MSS ERROR CODE            */ 00272000
         MVI   XAE(XSAPTR),X'18'                                   0103 00273000
*       CALL IEE0503D;              /* BRANCH TO MESSAGE MODULE      */ 00274000
         L     @15,@CV01429                                        0104 00275000
         BALR  @14,@15                                             0104 00276000
*     END;                                                         0105 00277000
         EJECT                                                          00278000
*                                                                  0106 00279000
*/********************************************************************/ 00280000
*/*                                                                  */ 00281000
*/*           PROCESSING IS COMPLETE, RETURN TO CALLER               */ 00282000
*/*                                                                  */ 00283000
*/********************************************************************/ 00284000
*                                                                  0106 00285000
         SPACE 1                                                        00286000
*   R14=XASAVSTD(1);                /* RESTORE RETURN REGISTER       */ 00287000
@RC00058 L     R14,XASAVSTD(,XSAPTR)                               0106 00288000
*   DECLARE                         /* GENERAL PURPOSE REGISTERS     */ 00289000
*     GPR00F FIXED(31) REG(0),                                     0107 00290000
*     GPR01F FIXED(31) REG(1);                                     0107 00291000
*   DECLARE                         /* COMMON VARIABLES              */ 00292000
*     I256C CHAR(256) BASED,                                       0108 00293000
*     I031F FIXED(31) BASED,                                       0108 00294000
*     I031P PTR(31) BASED,                                         0108 00295000
*     I015F FIXED(15) BASED,                                       0108 00296000
*     I015P PTR(15) BASED,                                         0108 00297000
*     I008P PTR(8) BASED,                                          0108 00298000
*     I001C CHAR(1) BASED;                                         0108 00299000
*   END                             /* RETURN TO CALLER              */ 00300000
*                                                                  0109 00301000
*/* THE FOLLOWING INCLUDE STATEMENTS WERE FOUND IN THIS PROGRAM.     */ 00302000
*/*%INCLUDE SYSLIB  (CVT     )                                       */ 00303000
*/*%INCLUDE SYSLIB  (IEZCWB  )                                       */ 00304000
*/*%INCLUDE SYSLIB  (IEEXSA  )                                       */ 00305000
*/*%INCLUDE SYSLIB  (IEZSSC  )                                       */ 00306000
*/*%INCLUDE SYSLIB  (IHAPSA  )                                       */ 00307000
*/*%INCLUDE SYSLIB  (IEEBASEA)                                       */ 00308000
*                                                                  0109 00309000
*       ;                                                          0109 00310000
@EL00001 DS    0H                                                  0109 00311000
@EF00001 DS    0H                                                  0109 00312000
@ER00001 BR    @14                                                 0109 00313000
@DATA    DS    0H                                                       00314000
@SM01471 MVC   CWBCMND(0,CWBPTR),XALBUFF(@07)                           00315000
         DS    0F                                                       00316000
         DS    0F                                                       00317000
@CF01438 DC    F'14'                                                    00318000
@CV01429 DC    V(IEE0503D)                                              00319000
         DS    0D                                                       00320000
GETINFO  DS    CL4                                                      00321000
         ORG   GETINFO                                                  00322000
SBPOOL   DC    X'F1'                                                    00323000
SPSIZE   DC    AL3(144)                                                 00324000
         ORG   GETINFO+4                                                00325000
PATCH    DC    CL50'*** IEE9403D PATCH AREA ***'                        00326000
MSSCVON  DC    CL14',ONLINE,S,3851'                                     00327000
VARYCMND DC    X'28'                                                    00328000
@00      EQU   00                      EQUATES FOR REGISTERS 0-15       00329000
@01      EQU   01                                                       00330000
@02      EQU   02                                                       00331000
@03      EQU   03                                                       00332000
@04      EQU   04                                                       00333000
@05      EQU   05                                                       00334000
@06      EQU   06                                                       00335000
@07      EQU   07                                                       00336000
@08      EQU   08                                                       00337000
@09      EQU   09                                                       00338000
@10      EQU   10                                                       00339000
@11      EQU   11                                                       00340000
@12      EQU   12                                                       00341000
@13      EQU   13                                                       00342000
@14      EQU   14                                                       00343000
@15      EQU   15                                                       00344000
ENDSCAN  EQU   @05                                                      00345000
SIZE     EQU   @06                                                      00346000
SAVEPTR  EQU   @06                                                      00347000
CWBPTR   EQU   @05                                                      00348000
R0       EQU   @00                                                      00349000
R1       EQU   @01                                                      00350000
R2       EQU   @02                                                      00351000
R14      EQU   @14                                                      00352000
XSAPTR   EQU   @02                                                      00353000
GPR01F   EQU   @01                                                      00354000
GPR00F   EQU   @00                                                      00355000
R10      EQU   @10                                                      00356000
R11      EQU   @11                                                      00357000
R12      EQU   @12                                                      00358000
R13      EQU   @13                                                      00359000
R15      EQU   @15                                                      00360000
R3       EQU   @03                                                      00361000
R4       EQU   @04                                                      00362000
R5       EQU   @05                                                      00363000
R6       EQU   @06                                                      00364000
R7       EQU   @07                                                      00365000
R8       EQU   @08                                                      00366000
R9       EQU   @09                                                      00367000
CVTPTR   EQU   16                                                       00368000
PSA      EQU   0                                                        00369000
FLCRNPSW EQU   PSA                                                      00370000
FLCROPSW EQU   PSA+8                                                    00371000
FLCICCW2 EQU   PSA+16                                                   00372000
PSAEEPSW EQU   PSA+132                                                  00373000
PSAESPSW EQU   PSA+136                                                  00374000
FLCSVILC EQU   PSAESPSW+1                                               00375000
PSAEPPSW EQU   PSA+140                                                  00376000
FLCPIILC EQU   PSAEPPSW+1                                               00377000
FLCPICOD EQU   PSAEPPSW+2                                               00378000
PSAPICOD EQU   FLCPICOD+1                                               00379000
FLCTEA   EQU   PSAEPPSW+4                                               00380000
FLCPER   EQU   PSA+152                                                  00381000
FLCMCLA  EQU   PSA+168                                                  00382000
FLCIOEL  EQU   FLCMCLA+4                                                00383000
FLCIOA   EQU   FLCMCLA+16                                               00384000
FLCFSA   EQU   FLCMCLA+80                                               00385000
PSASUPER EQU   PSA+552                                                  00386000
PSASUP1  EQU   PSASUPER                                                 00387000
PSASUP2  EQU   PSASUPER+1                                               00388000
PSASUP3  EQU   PSASUPER+2                                               00389000
PSASUP4  EQU   PSASUPER+3                                               00390000
PSACLHT  EQU   PSA+640                                                  00391000
PSALKSA  EQU   PSA+696                                                  00392000
PSAHLHI  EQU   PSA+760                                                  00393000
PSADSSFL EQU   PSA+836                                                  00394000
PSADSSF1 EQU   PSADSSFL                                                 00395000
PSADSSF3 EQU   PSADSSFL+2                                               00396000
PSADSSF4 EQU   PSADSSFL+3                                               00397000
PSARSVT  EQU   PSA+896                                                  00398000
CVTMAP   EQU   0                                                        00399000
CVTDAR   EQU   CVTMAP+72                                                00400000
CVTFLGS1 EQU   CVTDAR                                                   00401000
CVTBRET  EQU   CVTMAP+82                                                00402000
CVTDCB   EQU   CVTMAP+116                                               00403000
CVTIOQET EQU   CVTMAP+120                                               00404000
CVTIERLC EQU   CVTMAP+144                                               00405000
CVTMSER  EQU   CVTMAP+148                                               00406000
CVTHEAD  EQU   CVTMAP+160                                               00407000
CVTSV76C EQU   CVTHEAD                                                  00408000
CVTOPTA  EQU   CVTMAP+182                                               00409000
CVTOPTB  EQU   CVTMAP+183                                               00410000
CVTGTF   EQU   CVTMAP+236                                               00411000
CVTGTFST EQU   CVTGTF                                                   00412000
CVTGTFS  EQU   CVTGTFST                                                 00413000
CVTSTATE EQU   CVTGTFST                                                 00414000
CVTTMODE EQU   CVTGTFST                                                 00415000
CVTFORM  EQU   CVTGTFST                                                 00416000
CVTAQAVT EQU   CVTMAP+240                                               00417000
CVTTCMFG EQU   CVTAQAVT                                                 00418000
CVTVOLM2 EQU   CVTMAP+244                                               00419000
CVTTATA  EQU   CVTVOLM2                                                 00420000
CVTTSKS  EQU   CVTTATA                                                  00421000
CVTVOLF2 EQU   CVTTSKS                                                  00422000
CVTTAT   EQU   CVTTATA+1                                                00423000
CVTATER  EQU   CVTMAP+248                                               00424000
CVTEXT1  EQU   CVTMAP+252                                               00425000
CVTPURG  EQU   CVTMAP+260                                               00426000
CVTQMSG  EQU   CVTMAP+268                                               00427000
CVTDMSR  EQU   CVTMAP+272                                               00428000
CVTRSV37 EQU   CVTDMSR                                                  00429000
CVTDMSRF EQU   CVTRSV37                                                 00430000
CVTERPV  EQU   CVTMAP+316                                               00431000
CVTINTLA EQU   CVTMAP+320                                               00432000
CVTAPF   EQU   CVTMAP+324                                               00433000
CVTEXT2  EQU   CVTMAP+328                                               00434000
CVTHJES  EQU   CVTMAP+332                                               00435000
CVTPGSIA EQU   CVTMAP+348                                               00436000
CVTA1F1  EQU   CVTMAP+356                                               00437000
CVTSYSK  EQU   CVTMAP+357                                               00438000
CVTVOLM1 EQU   CVTMAP+380                                               00439000
CVTVOLF1 EQU   CVTVOLM1                                                 00440000
CVTATMCT EQU   CVTMAP+388                                               00441000
CVTXTNT1 EQU   0                                                        00442000
CVTXTNT2 EQU   0                                                        00443000
CVTDSSV  EQU   CVTXTNT2                                                 00444000
CVTFLGBT EQU   CVTXTNT2+5                                               00445000
CVTQID   EQU   CVTXTNT2+24                                              00446000
CVTICB   EQU   CVTXTNT2+48                                              00447000
CVTRV400 EQU   CVTXTNT2+52                                              00448000
CVTRV409 EQU   CVTXTNT2+53                                              00449000
CVTATCVT EQU   CVTXTNT2+64                                              00450000
CVTRV429 EQU   CVTXTNT2+84                                              00451000
CVTRV438 EQU   CVTXTNT2+85                                              00452000
CVTRV457 EQU   CVTXTNT2+112                                             00453000
CVTRV466 EQU   CVTXTNT2+113                                             00454000
CVTFIX   EQU   0                                                        00455000
CVTRELNO EQU   CVTFIX+252                                               00456000
CWB      EQU   0                                                        00457000
CWBCHAIN EQU   CWB                                                      00458000
CWBFREE  EQU   CWB+4                                                    00459000
CWBVBCDE EQU   CWB+8                                                    00460000
CWBCMND  EQU   CWB+9                                                    00461000
CWBUCMID EQU   CWB+136                                                  00462000
CWBAUTH  EQU   CWB+137                                                  00463000
CWBLCC   EQU   CWB+139                                                  00464000
CWBLA    EQU   CWB+140                                                  00465000
XSAMAP   EQU   0                                                        00466000
XASVRB   EQU   XSAMAP                                                   00467000
XSA      EQU   XASVRB                                                   00468000
XAP      EQU   XSA                                                      00469000
XAD      EQU   XSA+4                                                    00470000
XAX      EQU   XASVRB+8                                                 00471000
@NM00003 EQU   XASVRB+16                                                00472000
XAE      EQU   @NM00003                                                 00473000
XAR      EQU   @NM00003+1                                               00474000
@NM00004 EQU   XASVRB+20                                                00475000
XAN      EQU   @NM00004                                                 00476000
XAL      EQU   @NM00004+1                                               00477000
XAS      EQU   XASVRB+32                                                00478000
XAU      EQU   XASVRB+40                                                00479000
XAA      EQU   XASVRB+42                                                00480000
XAK      EQU   XASVRB+44                                                00481000
XASAVLOC EQU   XSAMAP+48                                                00482000
XASAVLOX EQU   XASAVLOC                                                 00483000
XASAVSTD EQU   XSAMAP+64                                                00484000
XASAVSTR EQU   XASAVSTD                                                 00485000
@NM00006 EQU   XSAMAP+136                                               00486000
XACMFLGS EQU   @NM00006                                                 00487000
XACMFLGA EQU   XACMFLGS                                                 00488000
XACMFLG1 EQU   XACMFLGA                                                 00489000
XACMFLG2 EQU   XACMFLGA+1                                               00490000
XACMFLGB EQU   XACMFLGS+2                                               00491000
XAWORK   EQU   XSAMAP+152                                               00492000
EEXSAS01 EQU   0                                                        00493000
EEXSAS02 EQU   0                                                        00494000
XADUSWIT EQU   EEXSAS02                                                 00495000
EEXSAS03 EQU   0                                                        00496000
XASCID   EQU   EEXSAS03                                                 00497000
XASDID   EQU   EEXSAS03+1                                               00498000
XASDS    EQU   EEXSAS03+2                                               00499000
@NM00008 EQU   EEXSAS03+4                                               00500000
EEXSAS04 EQU   0                                                        00501000
XAXMASK  EQU   EEXSAS04                                                 00502000
EEXSAS05 EQU   0                                                        00503000
XASOPCOD EQU   EEXSAS05                                                 00504000
XASWITCH EQU   EEXSAS05+1                                               00505000
XALTCHG  EQU   XASWITCH                                                 00506000
XACOMPMS EQU   XASWITCH                                                 00507000
XARESV   EQU   EEXSAS05+2                                               00508000
EEXSAS06 EQU   0                                                        00509000
XAAVRANG EQU   EEXSAS06                                                 00510000
XAAVRNG2 EQU   EEXSAS06+1                                               00511000
ICB2SSCB EQU   0                                                        00512000
ICBCOM   EQU   ICB2SSCB+16                                              00513000
ICBCOMQ  EQU   ICB2SSCB+24                                              00514000
ICBOPT   EQU   ICB2SSCB+48                                              00515000
ICBFLG   EQU   ICB2SSCB+52                                              00516000
ICBFG1   EQU   ICBFLG                                                   00517000
ICBR     EQU   ICBFG1                                                   00518000
ICBB     EQU   ICBFG1                                                   00519000
ICBTRACE EQU   ICB2SSCB+112                                             00520000
BASE     EQU   0                                                        00521000
@NM00036 EQU   BASE+13                                                  00522000
BALGSTAT EQU   BASE+24                                                  00523000
BALOG    EQU   BALGSTAT+4                                               00524000
BASFL    EQU   BASE+36                                                  00525000
BARSW    EQU   BASFL                                                    00526000
MSLOGST  EQU   BASE+46                                                  00527000
BASPBYTE EQU   BASE+47                                                  00528000
BAMONITR EQU   BASE+56                                                  00529000
BAASCB   EQU   BASE+100                                                 00530000
@NM00058 EQU   BASE+104                                                 00531000
MSLGCLOZ EQU   BASE+108                                                 00532000
MSCLOSSW EQU   MSLGCLOZ                                                 00533000
MSLGWLOG EQU   BASE+112                                                 00534000
MSWLOGSW EQU   MSLGWLOG                                                 00535000
MSLGWTR  EQU   BASE+116                                                 00536000
MSWTRSW  EQU   MSLGWTR                                                  00537000
MSLGSTRT EQU   BASE+120                                                 00538000
MSSTRTSW EQU   MSLGSTRT                                                 00539000
MS1BASEX EQU   BASE+136                                                 00540000
BASES01  EQU   0                                                        00541000
MSNTAL   EQU   BASES01                                                  00542000
MSSSB    EQU   BASES01+1                                                00543000
MSBTN    EQU   MSSSB                                                    00544000
MSPFG    EQU   BASES01+2                                                00545000
MSECBFL  EQU   BASES01+3                                                00546000
MSTUS    EQU   BASES01+4                                                00547000
MSSSA    EQU   MSTUS                                                    00548000
MSINLSW  EQU   MSSSA                                                    00549000
MSREOF   EQU   MSSSA                                                    00550000
MSNWP    EQU   MSSSA                                                    00551000
MSFHF    EQU   BASES01+5                                                00552000
XALBUFF  EQU   0                                                        00553000
BUFFER   EQU   0                                                        00554000
BUFFSIZE EQU   BUFFER                                                   00555000
MYASCB   EQU   0                                                        00556000
WKAREA   EQU   0                                                        00557000
CMNDPARM EQU   0                                                        00558000
I001C    EQU   0                                                        00559000
I008P    EQU   0                                                        00560000
I015F    EQU   0                                                        00561000
I015P    EQU   0                                                        00562000
I031F    EQU   0                                                        00563000
I031P    EQU   0                                                        00564000
I256C    EQU   0                                                        00565000
CVTS01   EQU   CVTPGSIA                                                 00566000
CVTLPDIA EQU   CVTS01+12                                                00567000
CVTDIRST EQU   CVTLPDIA                                                 00568000
CVTSLIDA EQU   CVTS01+24                                                00569000
CVTCTLFG EQU   CVTS01+50                                                00570000
CVTRV210 EQU   CVTS01+424                                               00571000
CVTRV219 EQU   CVTS01+425                                               00572000
CVTRV228 EQU   CVTS01+426                                               00573000
CVTRV237 EQU   CVTS01+427                                               00574000
CVTMFRTR EQU   CVTS01+452                                               00575000
CVTRV262 EQU   CVTS01+468                                               00576000
CVTRV271 EQU   CVTS01+469                                               00577000
CVTRV280 EQU   CVTS01+470                                               00578000
CVTRV289 EQU   CVTS01+471                                               00579000
CVTGSDA  EQU   CVTS01+600                                               00580000
PSARSVTE EQU   PSARSVT                                                  00581000
SCANPTR  EQU   XAP                                                      00582000
SWITCH   EQU   XAK                                                      00583000
CMNDCONT EQU   SWITCH                                                   00584000
FLC      EQU   PSA                                                      00585000
ICBPTR   EQU   CVTICB                                                   00586000
*                                      START UNREFERENCED COMPONENTS    00587000
@NM00076 EQU   SWITCH                                                   00588000
PSARSAV  EQU   PSARSVTE+60                                              00589000
PSARSTK  EQU   PSARSVTE+56                                              00590000
PSAESAV3 EQU   PSARSVTE+52                                              00591000
PSAESTK3 EQU   PSARSVTE+48                                              00592000
PSAESAV2 EQU   PSARSVTE+44                                              00593000
PSAESTK2 EQU   PSARSVTE+40                                              00594000
PSAESAV1 EQU   PSARSVTE+36                                              00595000
PSAESTK1 EQU   PSARSVTE+32                                              00596000
PSAPSAV  EQU   PSARSVTE+28                                              00597000
PSAPSTK  EQU   PSARSVTE+24                                              00598000
PSAMSAV  EQU   PSARSVTE+20                                              00599000
PSAMSTK  EQU   PSARSVTE+16                                              00600000
PSASSAV  EQU   PSARSVTE+12                                              00601000
PSASSTK  EQU   PSARSVTE+8                                               00602000
PSANSTK  EQU   PSARSVTE+4                                               00603000
PSACSTK  EQU   PSARSVTE                                                 00604000
CVTRV628 EQU   CVTS01+728                                               00605000
CVTRV627 EQU   CVTS01+724                                               00606000
CVTRV626 EQU   CVTS01+720                                               00607000
CVTRV625 EQU   CVTS01+716                                               00608000
CVTRV624 EQU   CVTS01+712                                               00609000
CVTRV623 EQU   CVTS01+708                                               00610000
CVTRV622 EQU   CVTS01+704                                               00611000
CVTRV621 EQU   CVTS01+700                                               00612000
CVTIHASU EQU   CVTS01+696                                               00613000
CVTRV619 EQU   CVTS01+692                                               00614000
CVTRV618 EQU   CVTS01+688                                               00615000
CVTRV617 EQU   CVTS01+684                                               00616000
CVTRV616 EQU   CVTS01+680                                               00617000
CVTRV615 EQU   CVTS01+676                                               00618000
CVTRV614 EQU   CVTS01+672                                               00619000
CVTRV613 EQU   CVTS01+668                                               00620000
CVTTCASP EQU   CVTS01+664                                               00621000
CVT0PT03 EQU   CVTS01+660                                               00622000
CVT0PT0E EQU   CVTS01+656                                               00623000
CVTRV609 EQU   CVTS01+652                                               00624000
CVTCGK   EQU   CVTS01+648                                               00625000
CVTRAC   EQU   CVTS01+644                                               00626000
CVTHSM   EQU   CVTS01+640                                               00627000
CVTRV605 EQU   CVTS01+636                                               00628000
CVTRV604 EQU   CVTS01+632                                               00629000
CVTEFF02 EQU   CVTS01+628                                               00630000
CVTCBBR  EQU   CVTS01+624                                               00631000
CVTSSCR  EQU   CVTS01+620                                               00632000
CVTEVENT EQU   CVTS01+616                                               00633000
CVTCRCA  EQU   CVTS01+612                                               00634000
CVTTPIO  EQU   CVTS01+608                                               00635000
CVTADV   EQU   CVTS01+604                                               00636000
CVTGSDAB EQU   CVTGSDA                                                  00637000
CVTQV3   EQU   CVTS01+596                                               00638000
CVTQV2   EQU   CVTS01+592                                               00639000
CVTQV1   EQU   CVTS01+588                                               00640000
CVTRPT   EQU   CVTS01+584                                               00641000
CVTSSRB  EQU   CVTS01+580                                               00642000
CVTCSDRL EQU   CVTS01+576                                               00643000
CVTEXP1  EQU   CVTS01+572                                               00644000
CVTRMPMT EQU   CVTS01+568                                               00645000
CVTRMPTT EQU   CVTS01+564                                               00646000
CVTVPSA  EQU   CVTS01+560                                               00647000
CVTVSTOP EQU   CVTS01+556                                               00648000
CVTGTFR8 EQU   CVTS01+552                                               00649000
CVTQUIT  EQU   CVTS01+548                                               00650000
CVTVACR  EQU   CVTS01+544                                               00651000
CVTWTCB  EQU   CVTS01+540                                               00652000
CVTSTPRS EQU   CVTS01+536                                               00653000
CVT0PT02 EQU   CVTS01+532                                               00654000
CVTDARCM EQU   CVTS01+528                                               00655000
CVTIRECM EQU   CVTS01+524                                               00656000
CVTJRECM EQU   CVTS01+520                                               00657000
CVTVEMS0 EQU   CVTS01+516                                               00658000
CVTSPFRR EQU   CVTS01+512                                               00659000
CVTRLSTG EQU   CVTS01+508                                               00660000
CVT0TC0A EQU   CVTS01+504                                               00661000
CVTGMBR  EQU   CVTS01+500                                               00662000
CVTLFRM  EQU   CVTS01+496                                               00663000
CVTRMBR  EQU   CVTS01+492                                               00664000
CVTVIOP  EQU   CVTS01+488                                               00665000
CVTRV307 EQU   CVTS01+486                                               00666000
CVTRV306 EQU   CVTS01+484                                               00667000
CVTRV305 EQU   CVTS01+482                                               00668000
CVTRV304 EQU   CVTS01+480                                               00669000
CVTRV303 EQU   CVTS01+478                                               00670000
CVTRV302 EQU   CVTS01+476                                               00671000
CVTTRCA  EQU   CVTS01+472                                               00672000
CVTRV297 EQU   CVTRV289                                                 00673000
CVTRV296 EQU   CVTRV289                                                 00674000
CVTRV295 EQU   CVTRV289                                                 00675000
CVTRV294 EQU   CVTRV289                                                 00676000
CVTRV293 EQU   CVTRV289                                                 00677000
CVTRV292 EQU   CVTRV289                                                 00678000
CVTRV291 EQU   CVTRV289                                                 00679000
CVTRV290 EQU   CVTRV289                                                 00680000
CVTRV288 EQU   CVTRV280                                                 00681000
CVTRV287 EQU   CVTRV280                                                 00682000
CVTRV286 EQU   CVTRV280                                                 00683000
CVTRV285 EQU   CVTRV280                                                 00684000
CVTRV284 EQU   CVTRV280                                                 00685000
CVTRV283 EQU   CVTRV280                                                 00686000
CVTRV282 EQU   CVTRV280                                                 00687000
CVTRV281 EQU   CVTRV280                                                 00688000
CVTRV279 EQU   CVTRV271                                                 00689000
CVTRV278 EQU   CVTRV271                                                 00690000
CVTRV277 EQU   CVTRV271                                                 00691000
CVTRV276 EQU   CVTRV271                                                 00692000
CVTRV275 EQU   CVTRV271                                                 00693000
CVTRV274 EQU   CVTRV271                                                 00694000
CVTRV273 EQU   CVTRV271                                                 00695000
CVTRV272 EQU   CVTRV271                                                 00696000
CVTRV270 EQU   CVTRV262                                                 00697000
CVTRV269 EQU   CVTRV262                                                 00698000
CVTRV268 EQU   CVTRV262                                                 00699000
CVTRV267 EQU   CVTRV262                                                 00700000
CVTRV266 EQU   CVTRV262                                                 00701000
CVTRV265 EQU   CVTRV262                                                 00702000
CVTRV264 EQU   CVTRV262                                                 00703000
CVTRV263 EQU   CVTRV262                                                 00704000
CVTVFP   EQU   CVTS01+464                                               00705000
CVTVSI   EQU   CVTS01+460                                               00706000
CVTVPSIB EQU   CVTS01+456                                               00707000
CVTMFACT EQU   CVTMFRTR                                                 00708000
CVTMFCTL EQU   CVTS01+448                                               00709000
CVTPVBP  EQU   CVTS01+444                                               00710000
CVTPWI   EQU   CVTS01+440                                               00711000
CVTRV254 EQU   CVTS01+438                                               00712000
CVTRV253 EQU   CVTS01+436                                               00713000
CVTRV252 EQU   CVTS01+434                                               00714000
CVTRV251 EQU   CVTS01+433                                               00715000
CVTRV250 EQU   CVTS01+432                                               00716000
CVTRV249 EQU   CVTS01+431                                               00717000
CVTRV248 EQU   CVTS01+430                                               00718000
CVTRV247 EQU   CVTS01+429                                               00719000
CVTRV246 EQU   CVTS01+428                                               00720000
CVTRV245 EQU   CVTRV237                                                 00721000
CVTRV244 EQU   CVTRV237                                                 00722000
CVTRV243 EQU   CVTRV237                                                 00723000
CVTRV242 EQU   CVTRV237                                                 00724000
CVTRV241 EQU   CVTRV237                                                 00725000
CVTRV240 EQU   CVTRV237                                                 00726000
CVTRV239 EQU   CVTRV237                                                 00727000
CVTRV238 EQU   CVTRV237                                                 00728000
CVTRV236 EQU   CVTRV228                                                 00729000
CVTRV235 EQU   CVTRV228                                                 00730000
CVTRV234 EQU   CVTRV228                                                 00731000
CVTRV233 EQU   CVTRV228                                                 00732000
CVTRV232 EQU   CVTRV228                                                 00733000
CVTRV231 EQU   CVTRV228                                                 00734000
CVTRV230 EQU   CVTRV228                                                 00735000
CVTRV229 EQU   CVTRV228                                                 00736000
CVTRV227 EQU   CVTRV219                                                 00737000
CVTRV226 EQU   CVTRV219                                                 00738000
CVTRV225 EQU   CVTRV219                                                 00739000
CVTRV224 EQU   CVTRV219                                                 00740000
CVTRV223 EQU   CVTRV219                                                 00741000
CVTRV222 EQU   CVTRV219                                                 00742000
CVTRV221 EQU   CVTRV219                                                 00743000
CVTRV220 EQU   CVTRV219                                                 00744000
CVTRV218 EQU   CVTRV210                                                 00745000
CVTRV217 EQU   CVTRV210                                                 00746000
CVTRV216 EQU   CVTRV210                                                 00747000
CVTRV215 EQU   CVTRV210                                                 00748000
CVTRV214 EQU   CVTRV210                                                 00749000
CVTRV213 EQU   CVTRV210                                                 00750000
CVTRV212 EQU   CVTRV210                                                 00751000
CVTRV211 EQU   CVTRV210                                                 00752000
CVTLCCAT EQU   CVTS01+420                                               00753000
CVTPCCAT EQU   CVTS01+416                                               00754000
CVTIPCRP EQU   CVTS01+412                                               00755000
CVTIPCRI EQU   CVTS01+408                                               00756000
CVTIPCDS EQU   CVTS01+404                                               00757000
CVTAIDVT EQU   CVTS01+400                                               00758000
CVTSSAP  EQU   CVTS01+396                                               00759000
CVTEHCIR EQU   CVTS01+392                                               00760000
CVTEHDEF EQU   CVTS01+388                                               00761000
CVTDAIR  EQU   CVTS01+384                                               00762000
CVTPERFM EQU   CVTS01+380                                               00763000
CVT044R2 EQU   CVTS01+376                                               00764000
CVTFETCH EQU   CVTS01+372                                               00765000
CVTRSTWD EQU   CVTS01+368                                               00766000
CVTSPOST EQU   CVTS01+364                                               00767000
CVTIOBP  EQU   CVTS01+360                                               00768000
CVTASMVT EQU   CVTS01+356                                               00769000
CVTRECRQ EQU   CVTS01+352                                               00770000
CVTWSAC  EQU   CVTS01+348                                               00771000
CVTRV149 EQU   CVTS01+344                                               00772000
CVTWSAL  EQU   CVTS01+340                                               00773000
CVTSPSA  EQU   CVTS01+336                                               00774000
CVTGLMN  EQU   CVTS01+332                                               00775000
CVTVEAC0 EQU   CVTS01+328                                               00776000
CVT062R1 EQU   CVTS01+324                                               00777000
CVTRPOST EQU   CVTS01+320                                               00778000
CVTDQIQE EQU   CVTS01+316                                               00779000
CVTCSD   EQU   CVTS01+312                                               00780000
CVTLKRMA EQU   CVTS01+308                                               00781000
CVTRSPIE EQU   CVTS01+304                                               00782000
CVTRENQ  EQU   CVTS01+300                                               00783000
CVTLQCB  EQU   CVTS01+296                                               00784000
CVTFQCB  EQU   CVTS01+292                                               00785000
CVTQCS01 EQU   CVTS01+288                                               00786000
CVTAPFT  EQU   CVTS01+284                                               00787000
CVTPARRL EQU   CVTS01+280                                               00788000
CVTVWAIT EQU   CVTS01+276                                               00789000
CVTGSPL  EQU   CVTS01+272                                               00790000
CVTLSMQ  EQU   CVTS01+268                                               00791000
CVTGSMQ  EQU   CVTS01+264                                               00792000
CVTEXPRO EQU   CVTS01+260                                               00793000
CVTOPCTP EQU   CVTS01+256                                               00794000
CVTSIC   EQU   CVTS01+252                                               00795000
CVTTPIOS EQU   CVTS01+248                                               00796000
CVTRTMS  EQU   CVTS01+244                                               00797000
CVTSDBF  EQU   CVTS01+240                                               00798000
CVTSCBP  EQU   CVTS01+236                                               00799000
CVTSDMP  EQU   CVTS01+232                                               00800000
CVTSV60  EQU   CVTS01+228                                               00801000
CVTRTMCT EQU   CVTS01+224                                               00802000
CVTASCBL EQU   CVTS01+220                                               00803000
CVTASCBH EQU   CVTS01+216                                               00804000
CVTGDA   EQU   CVTS01+212                                               00805000
CVTASVT  EQU   CVTS01+208                                               00806000
CVTVVMDI EQU   CVTS01+204                                               00807000
CVTAQTOP EQU   CVTS01+200                                               00808000
CVTIOSCS EQU   CVTS01+196                                               00809000
CVTSDRM  EQU   CVTS01+192                                               00810000
CVTOPTE  EQU   CVTS01+188                                               00811000
CVTSTXU  EQU   CVTS01+184                                               00812000
CVTQUIS  EQU   CVTS01+180                                               00813000
CVTPARS  EQU   CVTS01+176                                               00814000
CVTS1EE  EQU   CVTS01+172                                               00815000
CVTFRAS  EQU   CVTS01+168                                               00816000
CVTQSAS  EQU   CVTS01+164                                               00817000
CVTCRAS  EQU   CVTS01+160                                               00818000
CVTCRMN  EQU   CVTS01+156                                               00819000
CVTDELCP EQU   CVTS01+152                                               00820000
CVTFRECL EQU   CVTS01+148                                               00821000
CVTGETCL EQU   CVTS01+144                                               00822000
CVTBLDCP EQU   CVTS01+140                                               00823000
CVTAUTHL EQU   CVTS01+136                                               00824000
CVTSCAN  EQU   CVTS01+132                                               00825000
CVTRV144 EQU   CVTS01+130                                               00826000
CVTMAXMP EQU   CVTS01+128                                               00827000
CVTSTCK  EQU   CVTS01+124                                               00828000
CVTRV139 EQU   CVTS01+123                                               00829000
CVTDSSAC EQU   CVTS01+122                                               00830000
CVTRV513 EQU   CVTS01+121                                               00831000
CVTIOSPL EQU   CVTS01+120                                               00832000
CVTPTGT  EQU   CVTS01+116                                               00833000
CVTCSPIE EQU   CVTS01+112                                               00834000
CVTSMFEX EQU   CVTS01+108                                               00835000
CVTOLT0A EQU   CVTS01+104                                               00836000
CVTSRBRT EQU   CVTS01+100                                               00837000
CVTPUTL  EQU   CVTS01+96                                                00838000
CVTASCRL EQU   CVTS01+92                                                00839000
CVTASCRF EQU   CVTS01+88                                                00840000
CVTRV326 EQU   CVTS01+84                                                00841000
CVTRV325 EQU   CVTS01+80                                                00842000
CVTRV324 EQU   CVTS01+76                                                00843000
CVT0VL01 EQU   CVTS01+72                                                00844000
CVTSHRVM EQU   CVTS01+68                                                00845000
CVTRV332 EQU   CVTS01+64                                                00846000
CVTTAS   EQU   CVTS01+60                                                00847000
CVTRSCN  EQU   CVTS01+56                                                00848000
CVTTRAC2 EQU   CVTS01+54                                                00849000
CVTTRACE EQU   CVTS01+52                                                00850000
CVTAPG   EQU   CVTS01+51                                                00851000
CVTSDTRC EQU   CVTCTLFG                                                 00852000
CVTGTRCE EQU   CVTCTLFG                                                 00853000
CVTNOMP  EQU   CVTCTLFG                                                 00854000
CVTRSV79 EQU   CVTCTLFG                                                 00855000
CVTDSTAT EQU   CVTCTLFG                                                 00856000
CVTRSV78 EQU   CVTCTLFG                                                 00857000
CVTRV333 EQU   CVTCTLFG                                                 00858000
CVTRV323 EQU   CVTCTLFG                                                 00859000
CVTSPVLK EQU   CVTS01+49                                                00860000
CVTRSV77 EQU   CVTS01+48                                                00861000
CVTRV331 EQU   CVTS01+44                                                00862000
CVTRV330 EQU   CVTS01+40                                                00863000
CVTRV329 EQU   CVTS01+36                                                00864000
CVTRV328 EQU   CVTS01+32                                                00865000
CVTRV322 EQU   CVTS01+28                                                00866000
CVTSLID  EQU   CVTSLIDA+1                                               00867000
CVTSYLK  EQU   CVTSLIDA                                                 00868000
CVTRV321 EQU   CVTS01+20                                                00869000
CVTRV320 EQU   CVTS01+16                                                00870000
CVTLPDIR EQU   CVTLPDIA+1                                               00871000
CVTRSV69 EQU   CVTDIRST                                                 00872000
CVTRSV68 EQU   CVTDIRST                                                 00873000
CVTRSV67 EQU   CVTDIRST                                                 00874000
CVTRSV66 EQU   CVTDIRST                                                 00875000
CVTRSV65 EQU   CVTDIRST                                                 00876000
CVTRSV64 EQU   CVTDIRST                                                 00877000
CVTRSV63 EQU   CVTDIRST                                                 00878000
CVTDICOM EQU   CVTDIRST                                                 00879000
CVTPVTP  EQU   CVTS01+8                                                 00880000
CVTLPDSR EQU   CVTS01+4                                                 00881000
CVTGETL  EQU   CVTS01                                                   00882000
@NM00075 EQU   BUFFER+2                                                 00883000
MSSPARE  EQU   BASES01+48                                               00884000
MSUCBAL  EQU   BASES01+44                                               00885000
MSUCBPR  EQU   BASES01+40                                               00886000
MSBOBECB EQU   BASES01+36                                               00887000
MSSJQ    EQU   BASES01+32                                               00888000
MSECB    EQU   BASES01+28                                               00889000
MSPBP    EQU   BASES01+24                                               00890000
MSERM    EQU   BASES01+22                                               00891000
MSPASS   EQU   BASES01+14                                               00892000
MSVRB    EQU   BASES01+6                                                00893000
MSQHR    EQU   MSFHF                                                    00894000
@NM00074 EQU   MSFHF                                                    00895000
MSPSDT   EQU   MSFHF                                                    00896000
MSREPLYB EQU   MSFHF                                                    00897000
MSFAX    EQU   MSFHF                                                    00898000
MSTTT    EQU   MSFHF                                                    00899000
MSCSD    EQU   MSFHF                                                    00900000
MSNMF    EQU   MSFHF                                                    00901000
MSJNF    EQU   MSSSA                                                    00902000
MSYOUT   EQU   MSNWP                                                    00903000
MSNRP    EQU   MSSSA                                                    00904000
MSSRDR   EQU   MSREOF                                                   00905000
MSWRLOG  EQU   MSSSA                                                    00906000
MSNUPSW  EQU   MSSSA                                                    00907000
MSWRPEN  EQU   MSSSA                                                    00908000
MSSSSIPL EQU   MSINLSW                                                  00909000
MSSUM    EQU   MSECBFL                                                  00910000
MSMCR    EQU   MSECBFL                                                  00911000
MSYSOUT  EQU   MSECBFL                                                  00912000
MSYSIN   EQU   MSECBFL                                                  00913000
MSATTN   EQU   MSECBFL                                                  00914000
MSWTL    EQU   MSECBFL                                                  00915000
MSWTO    EQU   MSECBFL                                                  00916000
MSEXT    EQU   MSECBFL                                                  00917000
MSCCS    EQU   MSPFG                                                    00918000
MSBSP    EQU   MSPFG                                                    00919000
MSSYT    EQU   MSPFG                                                    00920000
MSSYN    EQU   MSPFG                                                    00921000
MSICR    EQU   MSPFG                                                    00922000
MSCMC    EQU   MSPFG                                                    00923000
MSPNB    EQU   MSPFG                                                    00924000
MSDATE   EQU   MSPFG                                                    00925000
@NM00073 EQU   MSBTN                                                    00926000
MSTN     EQU   MSBTN                                                    00927000
@NM00072 EQU   MSBTN                                                    00928000
@NM00071 EQU   MSBTN                                                    00929000
MSSO     EQU   MSBTN                                                    00930000
MSROLFLG EQU   MSBTN                                                    00931000
MSCANFLG EQU   MSBTN                                                    00932000
MSCONFLG EQU   MSBTN                                                    00933000
MSPNIP   EQU   MSNTAL                                                   00934000
MSQNIP   EQU   MSNTAL                                                   00935000
MSCURE34 EQU   MSNTAL                                                   00936000
@NM00070 EQU   MSNTAL                                                   00937000
@NM00069 EQU   MSNTAL                                                   00938000
@NM00068 EQU   MSNTAL                                                   00939000
@NM00067 EQU   MSNTAL                                                   00940000
MSNIP    EQU   MSNTAL                                                   00941000
@NM00066 EQU   MS1BASEX+40                                              00942000
@NM00065 EQU   MS1BASEX+20                                              00943000
@NM00064 EQU   MS1BASEX                                                 00944000
@NM00063 EQU   BASE+128                                                 00945000
MSLGJSCB EQU   BASE+124                                                 00946000
@NM00062 EQU   MSSTRTSW                                                 00947000
MSSTRTP  EQU   MSSTRTSW                                                 00948000
MSSTRTW  EQU   MSSTRTSW                                                 00949000
@NM00061 EQU   MSWTRSW                                                  00950000
MSWTRP   EQU   MSWTRSW                                                  00951000
MSWTRW   EQU   MSWTRSW                                                  00952000
@NM00060 EQU   MSWLOGSW                                                 00953000
MSWLOGP  EQU   MSWLOGSW                                                 00954000
MSWLOGW  EQU   MSWLOGSW                                                 00955000
@NM00059 EQU   MSCLOSSW                                                 00956000
MSCLOSP  EQU   MSCLOSSW                                                 00957000
MSCLOSW  EQU   MSCLOSSW                                                 00958000
MSLOGLMT EQU   @NM00058+1                                               00959000
MSLOGCLS EQU   @NM00058                                                 00960000
MSSMFPRM EQU   BASE+96                                                  00961000
MSCOMMND EQU   BASE+92                                                  00962000
BASP12   EQU   BASE+90                                                  00963000
BASTCNT  EQU   BASE+88                                                  00964000
BASESCT  EQU   BASE+86                                                  00965000
BAJNCNT  EQU   BASE+84                                                  00966000
BASUBECB EQU   BASE+80                                                  00967000
BALOGCOM EQU   BASE+76                                                  00968000
BADACNT  EQU   BASE+74                                                  00969000
BATACNT  EQU   BASE+72                                                  00970000
BAJBNR   EQU   BASE+64                                                  00971000
BASP11   EQU   BASE+62                                                  00972000
BALCCNT  EQU   BASE+61                                                  00973000
BADUMPID EQU   BASE+60                                                  00974000
BABCMAX  EQU   BASE+58                                                  00975000
BAMONTR2 EQU   BASE+57                                                  00976000
@NM00057 EQU   BAMONITR                                                 00977000
BAMACTVE EQU   BAMONITR                                                 00978000
@NM00056 EQU   BAMONITR                                                 00979000
@NM00055 EQU   BAMONITR                                                 00980000
@NM00054 EQU   BAMONITR                                                 00981000
@NM00053 EQU   BAMONITR                                                 00982000
BASPACE  EQU   BAMONITR                                                 00983000
BADSN    EQU   BAMONITR                                                 00984000
BADSO    EQU   BASE+52                                                  00985000
BALOGECB EQU   BASE+48                                                  00986000
@NM00052 EQU   BASPBYTE                                                 00987000
@NM00051 EQU   BASPBYTE                                                 00988000
@NM00050 EQU   BASPBYTE                                                 00989000
@NM00049 EQU   BASPBYTE                                                 00990000
@NM00048 EQU   BASPBYTE                                                 00991000
BAMASCH  EQU   BASPBYTE                                                 00992000
BATRACE  EQU   BASPBYTE                                                 00993000
BAMSSTAR EQU   BASPBYTE                                                 00994000
@NM00047 EQU   MSLOGST                                                  00995000
@NM00046 EQU   MSLOGST                                                  00996000
MSLOGSTA EQU   MSLOGST                                                  00997000
MSLOGIPL EQU   MSLOGST                                                  00998000
MSLOGDAR EQU   MSLOGST                                                  00999000
MSLOGCOM EQU   MSLOGST                                                  01000000
MSLOGTHD EQU   MSLOGST                                                  01001000
MSLOGENQ EQU   MSLOGST                                                  01002000
BAMIPAR2 EQU   BASE+44                                                  01003000
BAMINPAR EQU   BASE+42                                                  01004000
BAPKES   EQU   BASE+40                                                  01005000
BAICTR   EQU   BASE+38                                                  01006000
@NM00045 EQU   BASE+37                                                  01007000
BADSET   EQU   BARSW                                                    01008000
BANOSET  EQU   BARSW                                                    01009000
BAMIDNT  EQU   BARSW                                                    01010000
BAHR     EQU   BARSW                                                    01011000
BAVU     EQU   BARSW                                                    01012000
BAINTSET EQU   BARSW                                                    01013000
MSTODWTO EQU   BARSW                                                    01014000
BAIN     EQU   BARSW                                                    01015000
BACV     EQU   BASE+32                                                  01016000
@NM00044 EQU   BALOG                                                    01017000
@NM00043 EQU   BALOG                                                    01018000
@NM00042 EQU   BALOG                                                    01019000
@NM00041 EQU   BALOG                                                    01020000
@NM00040 EQU   BALOG                                                    01021000
@NM00039 EQU   BALOG                                                    01022000
@NM00038 EQU   BALOG                                                    01023000
BALOGINT EQU   BALOG                                                    01024000
MSLOGSVC EQU   BALGSTAT                                                 01025000
BAPRC    EQU   BASE+20                                                  01026000
BAQ      EQU   BASE+16                                                  01027000
BAIPLCC  EQU   @NM00036+2                                               01028000
@NM00037 EQU   @NM00036                                                 01029000
BAIPL    EQU   BASE+12                                                  01030000
BALAD    EQU   BASE+8                                                   01031000
BATRM    EQU   BASE+4                                                   01032000
BACHN    EQU   BASE                                                     01033000
ICBCPUID EQU   ICB2SSCB+496                                             01034000
ICBLORD  EQU   ICBTRACE+256                                             01035000
ICBOTRC  EQU   ICBTRACE                                                 01036000
ICBFAB   EQU   ICB2SSCB+108                                             01037000
ICBMSSC  EQU   ICB2SSCB+104                                             01038000
ICBRSVP  EQU   ICB2SSCB+100                                             01039000
ICBAEAP  EQU   ICB2SSCB+96                                              01040000
ICBSIOBP EQU   ICB2SSCB+92                                              01041000
ICBIATNA EQU   ICB2SSCB+88                                              01042000
ICBIPRGA EQU   ICB2SSCB+84                                              01043000
ICBSRBP  EQU   ICB2SSCB+80                                              01044000
ICBVVICB EQU   ICB2SSCB+76                                              01045000
ICBVVIC  EQU   ICB2SSCB+72                                              01046000
ICBSIOP  EQU   ICB2SSCB+68                                              01047000
ICBMEP   EQU   ICB2SSCB+64                                              01048000
ICBIORCI EQU   ICB2SSCB+60                                              01049000
ICB2ACTP EQU   ICB2SSCB+56                                              01050000
ICBSAMP  EQU   ICBFLG+2                                                 01051000
ICBFG2   EQU   ICBFLG+1                                                 01052000
@NM00011 EQU   ICBFG1                                                   01053000
ICBMSCA  EQU   ICBFG1                                                   01054000
ICBMSCMP EQU   ICBFG1                                                   01055000
ICBS     EQU   ICBFG1                                                   01056000
ICBV     EQU   ICBFG1                                                   01057000
ICBI     EQU   ICBFG1                                                   01058000
ICBNVT   EQU   ICBOPT                                                   01059000
ICBVN02P EQU   ICB2SSCB+44                                              01060000
ICBTCB   EQU   ICB2SSCB+40                                              01061000
ICBQHEAD EQU   ICB2SSCB+36                                              01062000
ICBAUCB  EQU   ICB2SSCB+32                                              01063000
ICBPUCB  EQU   ICB2SSCB+28                                              01064000
ICBIOR   EQU   ICB2SSCB+20                                              01065000
ICBACTV  EQU   ICB2SSCB+12                                              01066000
ICBECB   EQU   ICB2SSCB+8                                               01067000
ICBSSNAM EQU   ICB2SSCB                                                 01068000
XAARNG16 EQU   XAAVRNG2                                                 01069000
XAARNG15 EQU   XAAVRNG2                                                 01070000
XAARNG14 EQU   XAAVRNG2                                                 01071000
XAARNG13 EQU   XAAVRNG2                                                 01072000
XAARNG12 EQU   XAAVRNG2                                                 01073000
XAARNG11 EQU   XAAVRNG2                                                 01074000
XAARNG10 EQU   XAAVRNG2                                                 01075000
XAARNG9  EQU   XAAVRNG2                                                 01076000
XAARNG8  EQU   XAAVRANG                                                 01077000
XAARNG7  EQU   XAAVRANG                                                 01078000
XAARNG6  EQU   XAAVRANG                                                 01079000
XAARNG5  EQU   XAAVRANG                                                 01080000
XAARNG4  EQU   XAAVRANG                                                 01081000
XAARNG3  EQU   XAAVRANG                                                 01082000
XAARNG2  EQU   XAAVRANG                                                 01083000
XAARNG1  EQU   XAAVRANG                                                 01084000
XARTCODE EQU   EEXSAS05+6                                               01085000
XACMDATH EQU   EEXSAS05+4                                               01086000
XALTPTR  EQU   EEXSAS05+3                                               01087000
XACRT2   EQU   XARESV                                                   01088000
XACENDCK EQU   XARESV                                                   01089000
XARES1   EQU   XASWITCH                                                 01090000
XASMF44  EQU   XASWITCH                                                 01091000
XASMF42  EQU   XASWITCH                                                 01092000
XAHRDREQ EQU   XASWITCH                                                 01093000
XASTHDCP EQU   XACOMPMS                                                 01094000
XAINHDCP EQU   XALTCHG                                                  01095000
XAHRDCMD EQU   XASWITCH                                                 01096000
XAROUT   EQU   XASWITCH                                                 01097000
XALTCON  EQU   XASOPCOD                                                 01098000
XACMD    EQU   XASOPCOD                                                 01099000
XALTCOM  EQU   XASOPCOD                                                 01100000
XARESB   EQU   XASOPCOD                                                 01101000
XAOFF    EQU   XASOPCOD                                                 01102000
XAON     EQU   XASOPCOD                                                 01103000
XARESA   EQU   XASOPCOD                                                 01104000
XACON    EQU   XASOPCOD                                                 01105000
XAXSACB  EQU   EEXSAS04+4                                               01106000
XAXUTME  EQU   EEXSAS04+2                                               01107000
XAXFREE  EQU   EEXSAS04+1                                               01108000
@NM00010 EQU   XAXMASK                                                  01109000
XAXTSL   EQU   XAXMASK                                                  01110000
XAXTS    EQU   XAXMASK                                                  01111000
@NM00009 EQU   XAXMASK                                                  01112000
XAXJOBSL EQU   XAXMASK                                                  01113000
XAXJOBS  EQU   XAXMASK                                                  01114000
XASOPTR  EQU   @NM00008+1                                               01115000
XASTSAVE EQU   @NM00008                                                 01116000
XASPLS3  EQU   EEXSAS03+3                                               01117000
XASSDS8  EQU   XASDS                                                    01118000
XASSDS7  EQU   XASDS                                                    01119000
XASSDS6  EQU   XASDS                                                    01120000
XASSDS5  EQU   XASDS                                                    01121000
XASSDS4  EQU   XASDS                                                    01122000
XASSDS3  EQU   XASDS                                                    01123000
XASSDS2  EQU   XASDS                                                    01124000
XASSDS1  EQU   XASDS                                                    01125000
XACAHOLD EQU   EEXSAS02+2                                               01126000
XADRES1  EQU   EEXSAS02+1                                               01127000
XAUBLANK EQU   XADUSWIT                                                 01128000
XAOUNIT  EQU   XADUSWIT                                                 01129000
XAIOCOMP EQU   XADUSWIT                                                 01130000
XARES3   EQU   XADUSWIT                                                 01131000
XAUDVC   EQU   XADUSWIT                                                 01132000
XARES2   EQU   XADUSWIT                                                 01133000
XAIPAREN EQU   XADUSWIT                                                 01134000
XAXPAREN EQU   XADUSWIT                                                 01135000
@NM00007 EQU   EEXSAS01+44                                              01136000
XAT      EQU   EEXSAS01+20                                              01137000
XAF      EQU   EEXSAS01+12                                              01138000
XAI      EQU   EEXSAS01+4                                               01139000
XAH      EQU   EEXSAS01                                                 01140000
XAWORKH  EQU   XAWORK+28                                                01141000
XAWORKG  EQU   XAWORK+24                                                01142000
XAWORKF  EQU   XAWORK+20                                                01143000
XAWORKE  EQU   XAWORK+16                                                01144000
XAWORKD  EQU   XAWORK+12                                                01145000
XAWORKC  EQU   XAWORK+8                                                 01146000
XAWORKB  EQU   XAWORK+4                                                 01147000
XAWORKA  EQU   XAWORK                                                   01148000
XARESRZ  EQU   @NM00006+12                                              01149000
XARESRY  EQU   @NM00006+8                                               01150000
XARESRX  EQU   @NM00006+4                                               01151000
XACMFLG4 EQU   XACMFLGB+1                                               01152000
XACMFLG3 EQU   XACMFLGB                                                 01153000
XACMF28  EQU   XACMFLG2                                                 01154000
XACMF27  EQU   XACMFLG2                                                 01155000
XACMF26  EQU   XACMFLG2                                                 01156000
XACMF25  EQU   XACMFLG2                                                 01157000
XACMF24  EQU   XACMFLG2                                                 01158000
XACMF23  EQU   XACMFLG2                                                 01159000
XACMF22  EQU   XACMFLG2                                                 01160000
XACMF21  EQU   XACMFLG2                                                 01161000
XACMF18  EQU   XACMFLG1                                                 01162000
XACMF17  EQU   XACMFLG1                                                 01163000
XACMF16  EQU   XACMFLG1                                                 01164000
XACMF15  EQU   XACMFLG1                                                 01165000
XACMF14  EQU   XACMFLG1                                                 01166000
XACMF13  EQU   XACMFLG1                                                 01167000
XACMF12  EQU   XACMFLG1                                                 01168000
XACMF11  EQU   XACMFLG1                                                 01169000
XASAVSDR EQU   XASAVSTR+68                                              01170000
XASAVSDQ EQU   XASAVSTR+64                                              01171000
XASAVSDP EQU   XASAVSTR+60                                              01172000
XASAVSDO EQU   XASAVSTR+56                                              01173000
XASAVSDN EQU   XASAVSTR+52                                              01174000
XASAVSDM EQU   XASAVSTR+48                                              01175000
XASAVSDL EQU   XASAVSTR+44                                              01176000
XASAVSDK EQU   XASAVSTR+40                                              01177000
XASAVSDJ EQU   XASAVSTR+36                                              01178000
XASAVSDI EQU   XASAVSTR+32                                              01179000
XASAVSDH EQU   XASAVSTR+28                                              01180000
XASAVSDG EQU   XASAVSTR+24                                              01181000
XASAVSDF EQU   XASAVSTR+20                                              01182000
XASAVSDE EQU   XASAVSTR+16                                              01183000
XASAVSDD EQU   XASAVSTR+12                                              01184000
XASAVSDC EQU   XASAVSTR+8                                               01185000
XASAVSDB EQU   XASAVSTR+4                                               01186000
XASAVSDA EQU   XASAVSTR                                                 01187000
XASAVLC4 EQU   XASAVLOX+12                                              01188000
XASAVLC3 EQU   XASAVLOX+8                                               01189000
XASAVLC2 EQU   XASAVLOX+4                                               01190000
XASAVLC1 EQU   XASAVLOX                                                 01191000
@NM00005 EQU   XASVRB+41                                                01192000
XAV      EQU   XASVRB+24                                                01193000
CWBRESV  EQU   CWB+141                                                  01194000
CWBCOMQ  EQU   CWB+135                                                  01195000
CWBFLGTH EQU   CWBFREE+1                                                01196000
CWBSBPOL EQU   CWBFREE                                                  01197000
CVTLEVL  EQU   CVTRELNO+2                                               01198000
CVTNUMB  EQU   CVTRELNO                                                 01199000
CVTMDL   EQU   CVTFIX+250                                               01200000
@NM00002 EQU   CVTFIX+248                                               01201000
@NM00001 EQU   CVTFIX                                                   01202000
CVTRV482 EQU   CVTXTNT2+128                                             01203000
CVTRV481 EQU   CVTXTNT2+124                                             01204000
CVTRV480 EQU   CVTXTNT2+120                                             01205000
CVTRV479 EQU   CVTXTNT2+118                                             01206000
CVTRV478 EQU   CVTXTNT2+117                                             01207000
CVTRV477 EQU   CVTXTNT2+116                                             01208000
CVTRV476 EQU   CVTXTNT2+115                                             01209000
CVTRV475 EQU   CVTXTNT2+114                                             01210000
CVTRV474 EQU   CVTRV466                                                 01211000
CVTRV473 EQU   CVTRV466                                                 01212000
CVTRV472 EQU   CVTRV466                                                 01213000
CVTRV471 EQU   CVTRV466                                                 01214000
CVTRV470 EQU   CVTRV466                                                 01215000
CVTRV469 EQU   CVTRV466                                                 01216000
CVTRV468 EQU   CVTRV466                                                 01217000
CVTRV467 EQU   CVTRV466                                                 01218000
CVTRV465 EQU   CVTRV457                                                 01219000
CVTRV464 EQU   CVTRV457                                                 01220000
CVTRV463 EQU   CVTRV457                                                 01221000
CVTRV462 EQU   CVTRV457                                                 01222000
CVTRV461 EQU   CVTRV457                                                 01223000
CVTRV460 EQU   CVTRV457                                                 01224000
CVTRV459 EQU   CVTRV457                                                 01225000
CVTRV458 EQU   CVTRV457                                                 01226000
CVTRV456 EQU   CVTXTNT2+108                                             01227000
CVTRV455 EQU   CVTXTNT2+104                                             01228000
CVTRV454 EQU   CVTXTNT2+100                                             01229000
CVTRV453 EQU   CVTXTNT2+96                                              01230000
CVTRV452 EQU   CVTXTNT2+94                                              01231000
CVTRV451 EQU   CVTXTNT2+92                                              01232000
CVTRV450 EQU   CVTXTNT2+90                                              01233000
CVTRV449 EQU   CVTXTNT2+88                                              01234000
CVTRV448 EQU   CVTXTNT2+87                                              01235000
CVTRV447 EQU   CVTXTNT2+86                                              01236000
CVTRV446 EQU   CVTRV438                                                 01237000
CVTRV445 EQU   CVTRV438                                                 01238000
CVTRV444 EQU   CVTRV438                                                 01239000
CVTRV443 EQU   CVTRV438                                                 01240000
CVTRV442 EQU   CVTRV438                                                 01241000
CVTRV441 EQU   CVTRV438                                                 01242000
CVTRV440 EQU   CVTRV438                                                 01243000
CVTRV439 EQU   CVTRV438                                                 01244000
CVTRV437 EQU   CVTRV429                                                 01245000
CVTRV436 EQU   CVTRV429                                                 01246000
CVTRV435 EQU   CVTRV429                                                 01247000
CVTRV434 EQU   CVTRV429                                                 01248000
CVTRV433 EQU   CVTRV429                                                 01249000
CVTRV432 EQU   CVTRV429                                                 01250000
CVTRV431 EQU   CVTRV429                                                 01251000
CVTRV430 EQU   CVTRV429                                                 01252000
CVTRV428 EQU   CVTXTNT2+80                                              01253000
CVTRV427 EQU   CVTXTNT2+76                                              01254000
CVTRV426 EQU   CVTXTNT2+72                                              01255000
CVTRV425 EQU   CVTXTNT2+68                                              01256000
CVTATACT EQU   CVTATCVT                                                 01257000
CVTRV423 EQU   CVTXTNT2+62                                              01258000
CVTRV422 EQU   CVTXTNT2+60                                              01259000
CVTRV421 EQU   CVTXTNT2+58                                              01260000
CVTRV420 EQU   CVTXTNT2+56                                              01261000
CVTRV419 EQU   CVTXTNT2+55                                              01262000
CVTRV418 EQU   CVTXTNT2+54                                              01263000
CVTRV417 EQU   CVTRV409                                                 01264000
CVTRV416 EQU   CVTRV409                                                 01265000
CVTRV415 EQU   CVTRV409                                                 01266000
CVTRV414 EQU   CVTRV409                                                 01267000
CVTRV413 EQU   CVTRV409                                                 01268000
CVTRV412 EQU   CVTRV409                                                 01269000
CVTRV411 EQU   CVTRV409                                                 01270000
CVTRV410 EQU   CVTRV409                                                 01271000
CVTRV408 EQU   CVTRV400                                                 01272000
CVTRV407 EQU   CVTRV400                                                 01273000
CVTRV406 EQU   CVTRV400                                                 01274000
CVTRV405 EQU   CVTRV400                                                 01275000
CVTRV404 EQU   CVTRV400                                                 01276000
CVTRV403 EQU   CVTRV400                                                 01277000
CVTRV402 EQU   CVTRV400                                                 01278000
CVTRV401 EQU   CVTRV400                                                 01279000
CVTSKTA  EQU   CVTXTNT2+44                                              01280000
CVTCCVT  EQU   CVTXTNT2+40                                              01281000
CVTRSV98 EQU   CVTXTNT2+36                                              01282000
CVTRSV97 EQU   CVTXTNT2+34                                              01283000
CVTRSV96 EQU   CVTXTNT2+32                                              01284000
CVTOLTEP EQU   CVTXTNT2+28                                              01285000
CVTQIDA  EQU   CVTQID+1                                                 01286000
CVTRSV95 EQU   CVTQID                                                   01287000
CVTRSV94 EQU   CVTXTNT2+20                                              01288000
CVTRSV93 EQU   CVTXTNT2+16                                              01289000
CVTRSV92 EQU   CVTXTNT2+12                                              01290000
CVTDEBVR EQU   CVTXTNT2+8                                               01291000
CVTRSV91 EQU   CVTXTNT2+6                                               01292000
CVTRSV9H EQU   CVTFLGBT                                                 01293000
CVTRSV9G EQU   CVTFLGBT                                                 01294000
CVTRSV9F EQU   CVTFLGBT                                                 01295000
CVTRSV9E EQU   CVTFLGBT                                                 01296000
CVTRSV9D EQU   CVTFLGBT                                                 01297000
CVTRSV9C EQU   CVTFLGBT                                                 01298000
CVTVME   EQU   CVTFLGBT                                                 01299000
CVTNPE   EQU   CVTFLGBT                                                 01300000
CVTNUCLS EQU   CVTXTNT2+4                                               01301000
CVTDSSVA EQU   CVTDSSV+1                                                01302000
CVTRSV89 EQU   CVTDSSV                                                  01303000
CVTRSV88 EQU   CVTXTNT1+8                                               01304000
CVTRSV87 EQU   CVTXTNT1+4                                               01305000
CVTFACHN EQU   CVTXTNT1                                                 01306000
CVTRV488 EQU   CVTMAP+412                                               01307000
CVTRV487 EQU   CVTMAP+408                                               01308000
CVTRV486 EQU   CVTMAP+404                                               01309000
CVTRV485 EQU   CVTMAP+400                                               01310000
CVTACTAP EQU   CVTMAP+396                                               01311000
CVTAUTH  EQU   CVTMAP+392                                               01312000
CVTATMCA EQU   CVTATMCT+1                                               01313000
CVTATMST EQU   CVTATMCT                                                 01314000
CVTRSV61 EQU   CVTMAP+384                                               01315000
CVTVOLT1 EQU   CVTVOLM1+1                                               01316000
CVTVOLI1 EQU   CVTVOLF1                                                 01317000
CVTSTOA  EQU   CVTMAP+376                                               01318000
CVTRSV58 EQU   CVTMAP+374                                               01319000
CVTRSV57 EQU   CVTMAP+372                                               01320000
CVTDDCE  EQU   CVTMAP+368                                               01321000
CVTPNWFR EQU   CVTMAP+364                                               01322000
CVTSMF   EQU   CVTMAP+360                                               01323000
CVTSULK  EQU   CVTMAP+358                                               01324000
CVTSLKO  EQU   CVTSYSK                                                  01325000
CVTSLKP  EQU   CVTSYSK                                                  01326000
CVTSLKQ  EQU   CVTSYSK                                                  01327000
CVTSLKR  EQU   CVTSYSK                                                  01328000
CVTRSV56 EQU   CVTSYSK                                                  01329000
CVTRSV55 EQU   CVTSYSK                                                  01330000
CVTRSV54 EQU   CVTSYSK                                                  01331000
CVTRSV53 EQU   CVTSYSK                                                  01332000
CVTRSV52 EQU   CVTA1F1                                                  01333000
CVTRSV51 EQU   CVTA1F1                                                  01334000
CVTRSV50 EQU   CVTA1F1                                                  01335000
CVTRSV49 EQU   CVTA1F1                                                  01336000
CVTRSV48 EQU   CVTA1F1                                                  01337000
CVTRSV47 EQU   CVTA1F1                                                  01338000
CVTSRSW  EQU   CVTA1F1                                                  01339000
CVTPFSW  EQU   CVTA1F1                                                  01340000
CVTPCVT  EQU   CVTMAP+352                                               01341000
CVTRSV46 EQU   CVTMAP+344                                               01342000
CVTRSV45 EQU   CVTMAP+340                                               01343000
CVTRSV44 EQU   CVTMAP+338                                               01344000
CVTRSV43 EQU   CVTMAP+336                                               01345000
CVTHJESA EQU   CVTHJES+1                                                01346000
CVTRSV42 EQU   CVTHJES                                                  01347000
CVTEXT2A EQU   CVTEXT2+1                                                01348000
CVTRSV41 EQU   CVTEXT2                                                  01349000
CVTAPFA  EQU   CVTAPF+1                                                 01350000
CVTRSV40 EQU   CVTAPF                                                   01351000
CVTRV518 EQU   CVTINTLA                                                 01352000
CVTRV517 EQU   CVTERPV                                                  01353000
CVTEORM  EQU   CVTMAP+312                                               01354000
CVTMCHPR EQU   CVTMAP+308                                               01355000
CVTTZ    EQU   CVTMAP+304                                               01356000
CVTJEPS  EQU   CVTMAP+300                                               01357000
CVTJESCT EQU   CVTMAP+296                                               01358000
CVTMODE  EQU   CVTMAP+292                                               01359000
CVTPTRV  EQU   CVTMAP+288                                               01360000
CVTREAL  EQU   CVTMAP+284                                               01361000
CVTRSV39 EQU   CVTMAP+280                                               01362000
CVTRSV38 EQU   CVTMAP+276                                               01363000
CVTDMSRA EQU   CVTDMSR+1                                                01364000
CVTRV634 EQU   CVTDMSRF                                                 01365000
CVTRV633 EQU   CVTDMSRF                                                 01366000
CVTRV632 EQU   CVTDMSRF                                                 01367000
CVTRV631 EQU   CVTDMSRF                                                 01368000
CVTRV630 EQU   CVTDMSRF                                                 01369000
CVTRV629 EQU   CVTDMSRF                                                 01370000
CVTUDUMP EQU   CVTDMSRF                                                 01371000
CVTSDUMP EQU   CVTDMSRF                                                 01372000
CVTQMSGA EQU   CVTQMSG+1                                                01373000
CVTRSV36 EQU   CVTQMSG                                                  01374000
CVTAMFF  EQU   CVTMAP+264                                               01375000
CVTPURGA EQU   CVTPURG+1                                                01376000
CVTRSV35 EQU   CVTPURG                                                  01377000
CVTCBSP  EQU   CVTMAP+256                                               01378000
CVTATERA EQU   CVTATER+1                                                01379000
CVTSYST  EQU   CVTATER                                                  01380000
CVTVOLT2 EQU   CVTTAT                                                   01381000
CVTVOLI2 EQU   CVTVOLF2                                                 01382000
CVTAQAVB EQU   CVTAQAVT+1                                               01383000
CVTRSV34 EQU   CVTTCMFG                                                 01384000
CVTRSV33 EQU   CVTTCMFG                                                 01385000
CVTRSV32 EQU   CVTTCMFG                                                 01386000
CVTRSV31 EQU   CVTTCMFG                                                 01387000
CVTRSV30 EQU   CVTTCMFG                                                 01388000
CVTRSV29 EQU   CVTTCMFG                                                 01389000
CVTRSV28 EQU   CVTTCMFG                                                 01390000
CVTTCRDY EQU   CVTTCMFG                                                 01391000
CVTGTFA  EQU   CVTGTF+1                                                 01392000
CVTRSV27 EQU   CVTGTFST                                                 01393000
CVTRNIO  EQU   CVTGTFST                                                 01394000
CVTUSR   EQU   CVTGTFST                                                 01395000
CVTRV318 EQU   CVTFORM                                                  01396000
CVTRV317 EQU   CVTTMODE                                                 01397000
CVTRV316 EQU   CVTSTATE                                                 01398000
CVTRV315 EQU   CVTGTFS                                                  01399000
CVTGTFAV EQU   CVTGTFS                                                  01400000
CVT0SCR1 EQU   CVTMAP+232                                               01401000
CVTRV515 EQU   CVTMAP+228                                               01402000
CVTRMS   EQU   CVTMAP+224                                               01403000
CVTPATCH EQU   CVTMAP+220                                               01404000
CVTTSCE  EQU   CVTMAP+216                                               01405000
CVTLNKSC EQU   CVTMAP+214                                               01406000
CVTQABST EQU   CVTMAP+212                                               01407000
CVTMDLDS EQU   CVTMAP+208                                               01408000
CVTUSER  EQU   CVTMAP+204                                               01409000
CVTABEND EQU   CVTMAP+200                                               01410000
CVTSMCA  EQU   CVTMAP+196                                               01411000
CVTRSV18 EQU   CVTMAP+192                                               01412000
CVTQLPAQ EQU   CVTMAP+188                                               01413000
CVTQCDSR EQU   CVTMAP+184                                               01414000
CVTRSV17 EQU   CVTOPTB                                                  01415000
CVTRSV16 EQU   CVTOPTB                                                  01416000
CVTFP    EQU   CVTOPTB                                                  01417000
CVTAPTHR EQU   CVTOPTB                                                  01418000
CVTNLOG  EQU   CVTOPTB                                                  01419000
CVTTOD   EQU   CVTOPTB                                                  01420000
CVTCTIMS EQU   CVTOPTB                                                  01421000
CVTPROT  EQU   CVTOPTB                                                  01422000
CVTXPFP  EQU   CVTOPTA                                                  01423000
CVTASCII EQU   CVTOPTA                                                  01424000
CVTRSV13 EQU   CVTOPTA                                                  01425000
CVTRSV12 EQU   CVTOPTA                                                  01426000
CVTNIP   EQU   CVTOPTA                                                  01427000
CVTDDR   EQU   CVTOPTA                                                  01428000
CVTAPR   EQU   CVTOPTA                                                  01429000
CVTCCH   EQU   CVTOPTA                                                  01430000
CVTSNCTR EQU   CVTMAP+180                                               01431000
CVTQMWR  EQU   CVTMAP+176                                               01432000
CVTQOCR  EQU   CVTMAP+172                                               01433000
CVT1EF00 EQU   CVTMAP+168                                               01434000
CVTMZ00  EQU   CVTMAP+164                                               01435000
CVTSV76Q EQU   CVTSV76C                                                 01436000
CVTRSV11 EQU   CVTMAP+156                                               01437000
CVT0PT01 EQU   CVTMAP+152                                               01438000
CVTRV516 EQU   CVTIERLC                                                 01439000
CVTILCH  EQU   CVTMAP+140                                               01440000
CVT0DS   EQU   CVTMAP+136                                               01441000
CVTFBOSV EQU   CVTMAP+132                                               01442000
CVTNUCB  EQU   CVTMAP+128                                               01443000
CVTIXAVL EQU   CVTMAP+124                                               01444000
CVTSV76M EQU   CVTIOQET                                                 01445000
CVTDCBA  EQU   CVTMAP+117                                               01446000
CVTMVS2  EQU   CVTDCB                                                   01447000
CVT6DAT  EQU   CVTDCB                                                   01448000
CVT4MPS  EQU   CVTDCB                                                   01449000
CVTRSV09 EQU   CVTDCB                                                   01450000
CVT4MS1  EQU   CVTDCB                                                   01451000
CVT2SPS  EQU   CVTDCB                                                   01452000
CVT1SSS  EQU   CVTDCB                                                   01453000
CVTRSV08 EQU   CVTDCB                                                   01454000
CVTSTB   EQU   CVTMAP+112                                               01455000
CVTQTD00 EQU   CVTMAP+108                                               01456000
CVTQTE00 EQU   CVTMAP+104                                               01457000
CVTCUCB  EQU   CVTMAP+100                                               01458000
CVTSJQ   EQU   CVTMAP+96                                                01459000
CVTPBLDL EQU   CVTMAP+92                                                01460000
CVTTPC   EQU   CVTMAP+88                                                01461000
CVTSVDCB EQU   CVTMAP+84                                                01462000
CVTEXIT  EQU   CVTMAP+80                                                01463000
CVT0FN00 EQU   CVTMAP+76                                                01464000
CVTDARA  EQU   CVTDAR+1                                                 01465000
CVTRSV07 EQU   CVTFLGS1                                                 01466000
CVTRSV06 EQU   CVTFLGS1                                                 01467000
CVTRSV05 EQU   CVTFLGS1                                                 01468000
CVTRSV04 EQU   CVTFLGS1                                                 01469000
CVTRSV03 EQU   CVTFLGS1                                                 01470000
CVTRSV02 EQU   CVTFLGS1                                                 01471000
CVTRSV01 EQU   CVTFLGS1                                                 01472000
CVTDMPLK EQU   CVTFLGS1                                                 01473000
CVTXITP  EQU   CVTMAP+68                                                01474000
CVTZDTAB EQU   CVTMAP+64                                                01475000
CVTMSLT  EQU   CVTMAP+60                                                01476000
CVTDATE  EQU   CVTMAP+56                                                01477000
CVTBTERM EQU   CVTMAP+52                                                01478000
CVTSYSAD EQU   CVTMAP+48                                                01479000
CVTXTLER EQU   CVTMAP+44                                                01480000
CVTILK2  EQU   CVTMAP+40                                                01481000
CVTILK1  EQU   CVTMAP+36                                                01482000
CVTPRLTV EQU   CVTMAP+32                                                01483000
CVTPCNVT EQU   CVTMAP+28                                                01484000
CVT0VL00 EQU   CVTMAP+24                                                01485000
CVTXAPG  EQU   CVTMAP+20                                                01486000
CVTBUF   EQU   CVTMAP+16                                                01487000
CVTJOB   EQU   CVTMAP+12                                                01488000
CVTLINK  EQU   CVTMAP+8                                                 01489000
CVT0EF00 EQU   CVTMAP+4                                                 01490000
CVTTCBP  EQU   CVTMAP                                                   01491000
CVT      EQU   CVTMAP                                                   01492000
@NM00035 EQU   PSA+3668                                                 01493000
PSASTAK  EQU   PSA+3072                                                 01494000
@NM00034 EQU   PSA+1048                                                 01495000
PSAUSEND EQU   PSA+1048                                                 01496000
PSARV062 EQU   PSA+1044                                                 01497000
PSACDAL  EQU   PSA+1040                                                 01498000
PSAWTCOD EQU   PSA+1036                                                 01499000
PSAATCVT EQU   PSA+1032                                                 01500000
PSAPCPSW EQU   PSA+1024                                                 01501000
PSAPIR2  EQU   PSA+1020                                                 01502000
PSARV059 EQU   PSA+1018                                                 01503000
PSASVC13 EQU   PSA+1016                                                 01504000
PSALSFCC EQU   PSA+1012                                                 01505000
PSASFACC EQU   PSA+1008                                                 01506000
PSASTOP  EQU   PSA+992                                                  01507000
PSASTART EQU   PSA+976                                                  01508000
PSARSPSW EQU   PSA+968                                                  01509000
PSASRPSW EQU   PSA+960                                                  01510000
PSARV045 EQU   PSA+892                                                  01511000
PSARV044 EQU   PSA+888                                                  01512000
PSARV043 EQU   PSA+884                                                  01513000
PSARV042 EQU   PSA+880                                                  01514000
PSARV041 EQU   PSA+876                                                  01515000
PSARV040 EQU   PSA+872                                                  01516000
PSARV025 EQU   PSA+868                                                  01517000
PSADSSED EQU   PSA+868                                                  01518000
PSADSSPR EQU   PSA+864                                                  01519000
PSADSSFW EQU   PSA+860                                                  01520000
PSADSS14 EQU   PSA+856                                                  01521000
PSADSSPP EQU   PSA+848                                                  01522000
PSADSSRP EQU   PSA+840                                                  01523000
PSADSS05 EQU   PSADSSF4                                                 01524000
PSADSS10 EQU   PSADSSF4                                                 01525000
PSADSSVE EQU   PSADSSF4                                                 01526000
PSADSSDE EQU   PSADSSF4                                                 01527000
PSADSSC0 EQU   PSADSSF4                                                 01528000
PSADSSIE EQU   PSADSSF4                                                 01529000
PSADSS12 EQU   PSADSSF4                                                 01530000
PSADSSRC EQU   PSADSSF4                                                 01531000
PSARV057 EQU   PSADSSF3                                                 01532000
PSARV056 EQU   PSADSSF3                                                 01533000
PSARV055 EQU   PSADSSF3                                                 01534000
PSADSSMC EQU   PSADSSF3                                                 01535000
PSADSSRW EQU   PSADSSF3                                                 01536000
PSADSSNM EQU   PSADSSF3                                                 01537000
PSADSSES EQU   PSADSSF3                                                 01538000
PSADSSGP EQU   PSADSSF3                                                 01539000
PSADSSF2 EQU   PSADSSFL+1                                               01540000
PSADSSPI EQU   PSADSSF1                                                 01541000
PSADSSOI EQU   PSADSSF1                                                 01542000
PSADSSSP EQU   PSADSSF1                                                 01543000
PSADSSTP EQU   PSADSSF1                                                 01544000
PSADSSDW EQU   PSADSSF1                                                 01545000
PSADSSDD EQU   PSADSSF1                                                 01546000
PSADSSDM EQU   PSADSSF1                                                 01547000
PSADSSMV EQU   PSADSSF1                                                 01548000
PSADSSTS EQU   PSA+816                                                  01549000
PSADSSWK EQU   PSA+812                                                  01550000
PSADSSR3 EQU   PSA+808                                                  01551000
PSADSSR2 EQU   PSA+804                                                  01552000
PSADSSRS EQU   PSA+800                                                  01553000
PSASTOR  EQU   PSA+796                                                  01554000
PSACPUSA EQU   PSA+794                                                  01555000
PSAVSTAP EQU   PSA+792                                                  01556000
PSAWKVAP EQU   PSA+788                                                  01557000
PSAWKRAP EQU   PSA+784                                                  01558000
PSAMCHIC EQU   PSA+783                                                  01559000
PSARV061 EQU   PSA+782                                                  01560000
PSASYMSK EQU   PSA+781                                                  01561000
PSAMCHFL EQU   PSA+780                                                  01562000
PSACR0   EQU   PSA+776                                                  01563000
PSAPSWSV EQU   PSA+768                                                  01564000
PSALITA  EQU   PSA+764                                                  01565000
PSACLHS  EQU   PSAHLHI                                                  01566000
PSALKR15 EQU   PSALKSA+60                                               01567000
PSALKR14 EQU   PSALKSA+56                                               01568000
PSALKR13 EQU   PSALKSA+52                                               01569000
PSALKR12 EQU   PSALKSA+48                                               01570000
PSALKR11 EQU   PSALKSA+44                                               01571000
PSALKR10 EQU   PSALKSA+40                                               01572000
PSALKR9  EQU   PSALKSA+36                                               01573000
PSALKR8  EQU   PSALKSA+32                                               01574000
PSALKR7  EQU   PSALKSA+28                                               01575000
PSALKR6  EQU   PSALKSA+24                                               01576000
PSALKR5  EQU   PSALKSA+20                                               01577000
PSALKR4  EQU   PSALKSA+16                                               01578000
PSALKR3  EQU   PSALKSA+12                                               01579000
PSALKR2  EQU   PSALKSA+8                                                01580000
PSALKR1  EQU   PSALKSA+4                                                01581000
PSALKR0  EQU   PSALKSA                                                  01582000
PSARV023 EQU   PSACLHT+52                                               01583000
PSALOCAL EQU   PSACLHT+48                                               01584000
PSACMSL  EQU   PSACLHT+44                                               01585000
PSAOPTL  EQU   PSACLHT+40                                               01586000
PSATPACL EQU   PSACLHT+36                                               01587000
PSATPDNL EQU   PSACLHT+32                                               01588000
PSATPNCL EQU   PSACLHT+28                                               01589000
PSAIOSLL EQU   PSACLHT+24                                               01590000
PSAIOSUL EQU   PSACLHT+20                                               01591000
PSAIOSCL EQU   PSACLHT+16                                               01592000
PSAIOSSL EQU   PSACLHT+12                                               01593000
PSASALCL EQU   PSACLHT+8                                                01594000
PSAASML  EQU   PSACLHT+4                                                01595000
PSADISPL EQU   PSACLHT                                                  01596000
PSASRSA  EQU   PSA+636                                                  01597000
PSARV050 EQU   PSA+634                                                  01598000
PSADSSGO EQU   PSA+633                                                  01599000
PSARECUR EQU   PSA+632                                                  01600000
PSAHLHIS EQU   PSA+628                                                  01601000
PSAIPCSA EQU   PSA+624                                                  01602000
@NM00033 EQU   PSA+621                                                  01603000
PSAIPCDM EQU   PSA+620                                                  01604000
PSAIPCD  EQU   PSA+616                                                  01605000
@NM00032 EQU   PSA+613                                                  01606000
PSAIPCRM EQU   PSA+612                                                  01607000
PSAIPCR  EQU   PSA+608                                                  01608000
PSAMCHEX EQU   PSA+600                                                  01609000
PSAMPSW  EQU   PSA+592                                                  01610000
PSAEXPS2 EQU   PSA+584                                                  01611000
PSAEXPS1 EQU   PSA+576                                                  01612000
PSAPIREG EQU   PSA+572                                                  01613000
PSARSREG EQU   PSA+568                                                  01614000
PSAGPREG EQU   PSA+556                                                  01615000
PSARV022 EQU   PSASUP4                                                  01616000
PSARV021 EQU   PSASUP4                                                  01617000
PSARV020 EQU   PSASUP4                                                  01618000
PSARV019 EQU   PSASUP4                                                  01619000
PSARV018 EQU   PSASUP4                                                  01620000
PSARV017 EQU   PSASUP4                                                  01621000
PSARV016 EQU   PSASUP4                                                  01622000
PSARV015 EQU   PSASUP4                                                  01623000
PSARV014 EQU   PSASUP3                                                  01624000
PSAULCMS EQU   PSASUP3                                                  01625000
PSARV012 EQU   PSASUP3                                                  01626000
PSAESTA  EQU   PSASUP3                                                  01627000
PSASPR   EQU   PSASUP3                                                  01628000
PSAPSREG EQU   PSASUP3                                                  01629000
PSAPI2   EQU   PSASUP3                                                  01630000
PSAIOSUP EQU   PSASUP3                                                  01631000
PSALCR   EQU   PSASUP2                                                  01632000
PSARTM   EQU   PSASUP2                                                  01633000
PSAACR   EQU   PSASUP2                                                  01634000
PSAIPCE2 EQU   PSASUP2                                                  01635000
PSAIPCES EQU   PSASUP2                                                  01636000
PSAIPCEC EQU   PSASUP2                                                  01637000
PSAGTF   EQU   PSASUP2                                                  01638000
PSAIPCRI EQU   PSASUP2                                                  01639000
PSATYPE6 EQU   PSASUP1                                                  01640000
PSATCTL  EQU   PSASUP1                                                  01641000
PSADISP  EQU   PSASUP1                                                  01642000
PSALOCK  EQU   PSASUP1                                                  01643000
PSAPI    EQU   PSASUP1                                                  01644000
PSAEXT   EQU   PSASUP1                                                  01645000
PSASVC   EQU   PSASUP1                                                  01646000
PSAIO    EQU   PSASUP1                                                  01647000
PSAAOLD  EQU   PSA+548                                                  01648000
PSAANEW  EQU   PSA+544                                                  01649000
PSATOLD  EQU   PSA+540                                                  01650000
PSATNEW  EQU   PSA+536                                                  01651000
PSALCCAR EQU   PSA+532                                                  01652000
PSALCCAV EQU   PSA+528                                                  01653000
PSAPCCAR EQU   PSA+524                                                  01654000
PSAPCCAV EQU   PSA+520                                                  01655000
PSACPULA EQU   PSA+518                                                  01656000
PSACPUPA EQU   PSA+516                                                  01657000
PSAPSA   EQU   PSA+512                                                  01658000
FLCHDEND EQU   PSA+512                                                  01659000
FLCCRSAV EQU   FLCMCLA+280                                              01660000
FLCGRSAV EQU   FLCMCLA+216                                              01661000
FLCFPSAV EQU   FLCMCLA+184                                              01662000
FLCFLA   EQU   FLCMCLA+88                                               01663000
FLCRGNCD EQU   FLCMCLA+84                                               01664000
FLCFSAA  EQU   FLCFSA+1                                                 01665000
@NM00031 EQU   FLCFSA                                                   01666000
@NM00030 EQU   FLCMCLA+72                                               01667000
FLCMCIC  EQU   FLCMCLA+64                                               01668000
@NM00029 EQU   FLCMCLA+20                                               01669000
FLCIOAA  EQU   FLCIOA+1                                                 01670000
@NM00028 EQU   FLCIOA                                                   01671000
@NM00027 EQU   FLCMCLA+15                                               01672000
@NM00026 EQU   FLCMCLA+14                                               01673000
@NM00025 EQU   FLCMCLA+12                                               01674000
FLCLCL   EQU   FLCMCLA+8                                                01675000
FLCIOELA EQU   FLCIOEL+1                                                01676000
@NM00024 EQU   FLCIOEL                                                  01677000
FLCCHNID EQU   FLCMCLA                                                  01678000
@NM00023 EQU   PSA+160                                                  01679000
FLCMTRCD EQU   PSA+157                                                  01680000
@NM00022 EQU   PSA+156                                                  01681000
FLCPERA  EQU   FLCPER+1                                                 01682000
@NM00021 EQU   FLCPER                                                   01683000
@NM00020 EQU   PSA+151                                                  01684000
FLCPERCD EQU   PSA+150                                                  01685000
FLCMCNUM EQU   PSA+149                                                  01686000
@NM00019 EQU   PSA+148                                                  01687000
FLCTEAA  EQU   FLCTEA+1                                                 01688000
@NM00018 EQU   FLCTEA                                                   01689000
PSAPIPC  EQU   PSAPICOD                                                 01690000
PSAPIMC  EQU   PSAPICOD                                                 01691000
PSAPIPER EQU   PSAPICOD                                                 01692000
PSARV049 EQU   FLCPICOD                                                 01693000
FLCPILCB EQU   FLCPIILC                                                 01694000
@NM00017 EQU   FLCPIILC                                                 01695000
@NM00016 EQU   PSAEPPSW                                                 01696000
FLCSVCN  EQU   PSAESPSW+2                                               01697000
FLCSILCB EQU   FLCSVILC                                                 01698000
@NM00015 EQU   FLCSVILC                                                 01699000
@NM00014 EQU   PSAESPSW                                                 01700000
FLCEICOD EQU   PSAEEPSW+2                                               01701000
PSASPAD  EQU   PSAEEPSW                                                 01702000
@NM00013 EQU   PSA+128                                                  01703000
FLCINPSW EQU   PSA+120                                                  01704000
FLCMNPSW EQU   PSA+112                                                  01705000
FLCPNPSW EQU   PSA+104                                                  01706000
FLCSNPSW EQU   PSA+96                                                   01707000
FLCENPSW EQU   PSA+88                                                   01708000
FLCTRACE EQU   PSA+84                                                   01709000
FLCTIMER EQU   PSA+80                                                   01710000
FLCCVT2  EQU   PSA+76                                                   01711000
FLCCAW   EQU   PSA+72                                                   01712000
FLCCSW   EQU   PSA+64                                                   01713000
FLCIOPSW EQU   PSA+56                                                   01714000
FLCMOPSW EQU   PSA+48                                                   01715000
FLCPOPSW EQU   PSA+40                                                   01716000
FLCSOPSW EQU   PSA+32                                                   01717000
FLCEOPSW EQU   PSA+24                                                   01718000
@NM00012 EQU   FLCICCW2+4                                               01719000
FLCCVT   EQU   FLCICCW2                                                 01720000
FLCICCW1 EQU   FLCROPSW                                                 01721000
FLCIPPSW EQU   FLCRNPSW                                                 01722000
*                                      END UNREFERENCED COMPONENTS      01723000
@ENDDATA EQU   *                                                        01724000
         END   IEE9403D,(C'PLS1740',0701,78068)                         01725000
./  ADD  SSI=72420126,NAME=IEFJSWT
         TITLE 'STC WRITE JCL ROUTINE                                '  00001000
IEFJSWT  CSECT ,                                                   0001 00002000
@MAINENT DS    0H                                                  0001 00003000
         USING *,@15                                               0001 00004000
         B     @PROLOG                                             0001 00005000
         DC    AL1(16)                                             0001 00006000
         DC    C'IEFJSWT   73.165'                                 0001 00007000
         DROP  @15                                                      00008000
@PROLOG  STM   @14,@12,12(@13)                                     0001 00009000
         BALR  @12,0                                               0001 00010000
@PSTART  DS    0H                                                  0001 00011000
         USING @PSTART,@12                                         0001 00012000
         L     @00,@SIZDATD                                        0001 00013000
         GETMAIN R,LV=(0)                                               00014000
         LR    @11,@01                                             0001 00015000
         USING @DATD,@11                                           0001 00016000
         ST    @13,@SA00001+4                                      0001 00017000
         LM    @00,@01,20(@13)                                     0001 00018000
         ST    @11,8(,@13)                                         0001 00019000
         LR    @13,@11                                             0001 00020000
*   PARMPTR=R1;                     /* SET UP THE PARAMETER LIST     */ 00021000
         LR    PARMPTR,R1                                          0029 00022000
*   JCLPTR=JCLSPTR;                 /* SET UP JCLS POINTER FROM PARM    00023000
*                                      LIST                          */ 00024000
         L     JCLPTR,JCLSPTR(,PARMPTR)                            0030 00025000
*   RPLCORE(1:RPLLGH2)=RPLLIST(1:RPLLGH2);/* MOVE IN THE RPL         */ 00026000
         L     @14,RPLLGH2                                         0031 00027000
         BCTR  @14,0                                               0031 00028000
         EX    @14,@SM00433                                        0031 00029000
*   RPLPTR=ADDR(RPLCORE);           /* SET UP THE RPL                */ 00030000
         LA    RPLPTR,RPLCORE                                      0032 00031000
*   RESPECIFY                                                      0033 00032000
*     IFGACB BASED(ACBPTR);         /* BASE THE ACB                  */ 00033000
*   RESPECIFY                                                      0034 00034000
*     IFGRPL BASED(RPLPTR);         /* BASE THE RPL                  */ 00035000
*   IF CHVCD=LOGON THEN             /* IF TSO THE USE TSO DATA SET   */ 00036000
         L     @14,CSCBPTR(,PARMPTR)                               0035 00037000
         CLI   CHVCD(@14),X'98'                                    0035 00038000
         BNE   @RF00035                                            0035 00039000
*     DO;                                                          0036 00040000
*       ACBCORE(1:ACBLGH2)=ACBLIST(1:ACBLGH2);/* MOVE IN THE ACB     */ 00041000
         L     @14,ACBLGH2                                         0037 00042000
         BCTR  @14,0                                               0037 00043000
         EX    @14,@SM00435                                        0037 00044000
*       ACBPTR=ADDR(ACBCORE);       /* POINT TO THE ACB              */ 00045000
         LA    @14,ACBCORE                                         0038 00046000
         ST    @14,ACBPTR                                          0038 00047000
*       ENQCORE(1:ENQLGTH)=ENQLIST(1:ENQLGTH);/* MOVE IN THE ENQ     */ 00048000
         L     @14,ENQLGTH                                         0039 00049000
         BCTR  @14,0                                               0039 00050000
         EX    @14,@SM00437                                        0039 00051000
*       R1=ADDR(ENQCORE);           /* POINT R1 TO ENQ LIST          */ 00052000
         LA    R1,ENQCORE                                          0040 00053000
*     END;                                                         0041 00054000
*   ELSE                                                           0042 00055000
*     IF CHVCD=START THEN                                          0042 00056000
         B     @RC00035                                            0042 00057000
@RF00035 L     @14,CSCBPTR(,PARMPTR)                               0042 00058000
         CLI   CHVCD(@14),X'04'                                    0042 00059000
         BNE   @RF00042                                            0042 00060000
*       DO;                                                        0043 00061000
*         ACBCORE1(1:ACBLGH4)=ACBLIST1(1:ACBLGH4);/* MOVE IN THE ACB */ 00062000
         L     @14,ACBLGH4                                         0044 00063000
         BCTR  @14,0                                               0044 00064000
         EX    @14,@SM00439                                        0044 00065000
*         ACBPTR=ADDR(ACBCORE1);    /* POINT TO THE ACB              */ 00066000
         LA    @14,ACBCORE1                                        0045 00067000
         ST    @14,ACBPTR                                          0045 00068000
*         ENQCORE1(1:ENQLGTH1)=ENQLIST1(1:ENQLGTH1);/* MOVE IN THE 0046 00069000
*                                      ENQ                           */ 00070000
         L     @14,ENQLGTH1                                        0046 00071000
         BCTR  @14,0                                               0046 00072000
         EX    @14,@SM00441                                        0046 00073000
*         R1=ADDR(ENQCORE1);        /* SET UP ENQ LIST               */ 00074000
         LA    R1,ENQCORE1                                         0047 00075000
*       END;                                                       0048 00076000
*     ELSE                                                         0049 00077000
*       IF CHVCD=MOUNT THEN                                        0049 00078000
         B     @RC00042                                            0049 00079000
@RF00042 L     @14,CSCBPTR(,PARMPTR)                               0049 00080000
         CLI   CHVCD(@14),X'0C'                                    0049 00081000
         BNE   @RF00049                                            0049 00082000
*         DO;                                                      0050 00083000
*           ACBCORE1(1:ACBLGH4)=ACBLIST1(1:ACBLGH4);/* MOVE IN THE 0051 00084000
*                                      ACB                           */ 00085000
         L     @14,ACBLGH4                                         0051 00086000
         BCTR  @14,0                                               0051 00087000
         EX    @14,@SM00439                                        0051 00088000
*           ACBPTR=ADDR(ACBCORE1);  /* POINT TO THE ACB              */ 00089000
         LA    @14,ACBCORE1                                        0052 00090000
         ST    @14,ACBPTR                                          0052 00091000
*           ENQCORE1(1:ENQLGTH1)=ENQLIST1(1:ENQLGTH1);/* MOVE IN THE    00092000
*                                      ENQ                           */ 00093000
         L     @14,ENQLGTH1                                        0053 00094000
         BCTR  @14,0                                               0053 00095000
         EX    @14,@SM00441                                        0053 00096000
*           R1=ADDR(ENQCORE1);      /* SET UP ENQ LIST               */ 00097000
         LA    R1,ENQCORE1                                         0054 00098000
*         END;                                                     0055 00099000
*       ELSE                                                       0056 00100000
*         DO;                                                      0056 00101000
         B     @RC00049                                            0056 00102000
@RF00049 DS    0H                                                  0057 00103000
*           R15=FOURFAIL;           /* INDICATE TYPE OF ERROR        */ 00104000
         LA    R15,4                                               0057 00105000
*           GEN(ABEND 184,,,SYSTEM);/* ABEND, UNKNOWN VERB CODE      */ 00106000
         ABEND 184,,,SYSTEM                                             00107000
*         END;                                                     0059 00108000
*                                                                  0059 00109000
*   /*****************************************************************/ 00110000
*   /*                                                               */ 00111000
*   /* IF VERB CODE RECONIZED THEN ENQ                               */ 00112000
*   /*                                                               */ 00113000
*   /*****************************************************************/ 00114000
*                                                                  0060 00115000
*   GEN( ENQ MF=(E,(1)));           /* ENQ ON RESOURCE               */ 00116000
@RC00049 DS    0H                                                  0060 00117000
@RC00042 DS    0H                                                  0060 00118000
@RC00035 DS    0H                                                  0060 00119000
          ENQ MF=(E,(1))                                                00120000
*   R7=ACBPTR;                      /* POINT TO THE ACB              */ 00121000
         L     R7,ACBPTR                                           0061 00122000
*   OPENCORE(1:OPENLGH2)=OPENLIST(1:OPENLGH2);/* MOVE IN OPEN        */ 00123000
         L     @14,OPENLGH2                                        0062 00124000
         BCTR  @14,0                                               0062 00125000
         EX    @14,@SM00443                                        0062 00126000
*   R1=ADDR(OPENCORE);              /* POINT TO OPEN MACRO           */ 00127000
         LA    R1,OPENCORE                                         0063 00128000
*   GEN( OPEN ((7)),MF=(E,(1)));    /* OPEN THE ACB                  */ 00129000
          OPEN ((7)),MF=(E,(1))                                         00130000
*   RPLDACB=ACBPTR;                 /* PUT IN THE ACB PTR            */ 00131000
         MVC   RPLDACB(4,RPLPTR),ACBPTR                            0065 00132000
*   RPLRLEN=LENGTH(THEJCL);         /* PUT IN THE LENTH OF THE CARD  */ 00133000
         MVC   RPLRLEN(4,RPLPTR),@CF00353                          0066 00134000
*   DO WHILE NEXTJCLS=0;           /* PUT THE JCLS                  */ 00135000
         B     @DE00067                                            0067 00136000
@DL00067 DS    0H                                                  0068 00137000
*     RPLAREA=ADDR(THEJCL);         /* PUT IN THE RPL JCL ADDR       */ 00138000
         LA    @14,THEJCL(,JCLPTR)                                 0068 00139000
         ST    @14,RPLAREA(,RPLPTR)                                0068 00140000
*     R7=RPLPTR;                    /* POINT TO THE RPL              */ 00141000
         LR    R7,RPLPTR                                           0069 00142000
*     GEN( PUT  RPL=(7));           /* PUT THE RECORD                */ 00143000
          PUT  RPL=(7)                                                  00144000
*     IF R15=0 THEN                /* IF OPEN OR PUT ERROR RETURN   */ 00145000
         LTR   R15,R15                                             0071 00146000
         BZ    @RF00071                                            0071 00147000
*       DO;                                                        0072 00148000
*         CALL ISSUEDEQ;            /* ISSUE THE DEQ                 */ 00149000
         BAL   @14,ISSUEDEQ                                        0073 00150000
*         RETURN CODE(4);           /* RETURN                        */ 00151000
         L     @13,4(,@13)                                         0074 00152000
         L     @00,@SIZDATD                                        0074 00153000
         LR    @01,@11                                             0074 00154000
         FREEMAIN R,LV=(0),A=(1)                                        00155000
         LA    @15,4                                               0074 00156000
         L     @14,12(,@13)                                        0074 00157000
         LM    @00,@12,20(@13)                                     0074 00158000
         BR    @14                                                 0074 00159000
*       END;                                                       0075 00160000
*     JCLPTR=NEXTJCLS;              /* POINT TO NEXT JCL RECORD      */ 00161000
@RF00071 L     JCLPTR,NEXTJCLS(,JCLPTR)                            0076 00162000
*   END;                                                           0077 00163000
@DE00067 ICM   @14,15,NEXTJCLS(JCLPTR)                             0077 00164000
         BNZ   @DL00067                                            0077 00165000
*   RPLAREA=ADDR(THEJCL);           /* POINT TO THE RECORD           */ 00166000
         LA    @14,THEJCL(,JCLPTR)                                 0078 00167000
         ST    @14,RPLAREA(,RPLPTR)                                0078 00168000
*   R7=RPLPTR;                      /* POINT TO THE RPL              */ 00169000
         LR    R7,RPLPTR                                           0079 00170000
*   GEN( PUT RPL=(7));              /* FORCED PUT                    */ 00171000
          PUT RPL=(7)                                                   00172000
*   IF R15=0 THEN                  /* IF OPEN OR PUT ERROR RETURN   */ 00173000
         LTR   R15,R15                                             0081 00174000
         BZ    @RF00081                                            0081 00175000
*     DO;                                                          0082 00176000
*       CALL ISSUEDEQ;              /* ISSUE THE DEQ                 */ 00177000
         BAL   @14,ISSUEDEQ                                        0083 00178000
*       RETURN CODE(4);             /* RETURN                        */ 00179000
         L     @13,4(,@13)                                         0084 00180000
         L     @00,@SIZDATD                                        0084 00181000
         LR    @01,@11                                             0084 00182000
         FREEMAIN R,LV=(0),A=(1)                                        00183000
         LA    @15,4                                               0084 00184000
         L     @14,12(,@13)                                        0084 00185000
         LM    @00,@12,20(@13)                                     0084 00186000
         BR    @14                                                 0084 00187000
*     END;                                                         0085 00188000
*   GEN(   ENDREQ  RPL=(7));        /* WAIT IN RPL                   */ 00189000
@RF00081 DS    0H                                                  0086 00190000
            ENDREQ  RPL=(7)                                             00191000
*   RESPECIFY                                                      0087 00192000
*     SSIB BASED(SSOBSSIB);         /* BASE THE SSIB                 */ 00193000
*   SSIBJBID=RPLRBAR;               /* PUT JOB ID IN SSIB            */ 00194000
         L     @14,SSOBPTR(,PARMPTR)                               0088 00195000
         L     @14,SSOBSSIB(,@14)                                  0088 00196000
         MVC   SSIBJBID(8,@14),RPLRBAR(RPLPTR)                     0088 00197000
*   R7=ACBPTR;                      /* POINT TO THE ACB              */ 00198000
         L     R7,ACBPTR                                           0089 00199000
*   CLOSECRE(1:CLOSELG2)=CLOSELST(1:CLOSELG2);/* MOVE IN THE CLOSE   */ 00200000
         L     @14,CLOSELG2                                        0090 00201000
         BCTR  @14,0                                               0090 00202000
         EX    @14,@SM00445                                        0090 00203000
*   R1=ADDR(CLOSECRE);              /* POINT TO CLOSE PARM LIST      */ 00204000
         LA    R1,CLOSECRE                                         0091 00205000
*   GEN( CLOSE ((7)),MF=(E,(1)));   /* CLOSE THE ACB                 */ 00206000
          CLOSE ((7)),MF=(E,(1))                                        00207000
*   CALL ISSUEDEQ;                  /* ISSUE THE DEQ                 */ 00208000
         BAL   @14,ISSUEDEQ                                        0093 00209000
*   RETURN CODE(0);                 /* RETURN                        */ 00210000
         L     @13,4(,@13)                                         0094 00211000
         L     @00,@SIZDATD                                        0094 00212000
         LR    @01,@11                                             0094 00213000
         FREEMAIN R,LV=(0),A=(1)                                        00214000
         SR    @15,@15                                             0094 00215000
         L     @14,12(,@13)                                        0094 00216000
         LM    @00,@12,20(@13)                                     0094 00217000
         BR    @14                                                 0094 00218000
*ISSUEDEQ:                                                         0095 00219000
*   PROC;                           /* ISSUE DEQ OFF RESOURCE        */ 00220000
ISSUEDEQ STM   @14,@12,@SA00002                                    0095 00221000
*   IF CHVCD=LOGON THEN             /* CHECK WHICH TO DEQ            */ 00222000
         L     @14,CSCBPTR(,PARMPTR)                               0096 00223000
         CLI   CHVCD(@14),X'98'                                    0096 00224000
         BNE   @RF00096                                            0096 00225000
*     R1=ADDR(ENQCORE);             /* SET UP R1 TO POINT TO DEQ     */ 00226000
         LA    R1,ENQCORE                                          0097 00227000
*   ELSE                                                           0098 00228000
*     R1=ADDR(ENQCORE1);            /* SET UP R1 TO POINT TO DEQ     */ 00229000
         B     @RC00096                                            0098 00230000
@RF00096 LA    R1,ENQCORE1                                         0098 00231000
*   GEN( DEQ   MF=(E,(1)));         /* ISSUE THE DEQ                 */ 00232000
@RC00096 DS    0H                                                  0099 00233000
          DEQ   MF=(E,(1))                                              00234000
*   END;                                                           0100 00235000
@EL00002 DS    0H                                                  0100 00236000
@EF00002 DS    0H                                                  0100 00237000
@ER00002 LM    @14,@12,@SA00002                                    0100 00238000
         BR    @14                                                 0100 00239000
*   END IEFJSWT                                                    0101 00240000
*                                                                  0101 00241000
*/* THE FOLLOWING INCLUDE STATEMENTS WERE FOUND IN THIS PROGRAM.     */ 00242000
*/*%INCLUDE SYSLIB  (IFGACB  )                                       */ 00243000
*/*%INCLUDE SYSLIB  (IFGRPL  )                                       */ 00244000
*/*%INCLUDE SYSLIB  (IEECHAIN)                                       */ 00245000
*/*%INCLUDE SYSLIB  (IEFJSSIB)                                       */ 00246000
*/*%INCLUDE SYSLIB  (IEFJSSOB)                                       */ 00247000
*                                                                  0101 00248000
*       ;                                                          0101 00249000
@EL00001 L     @13,4(,@13)                                         0101 00250000
@EF00001 L     @00,@SIZDATD                                        0101 00251000
         LR    @01,@11                                             0101 00252000
         FREEMAIN R,LV=(0),A=(1)                                        00253000
@ER00001 LM    @14,@12,12(@13)                                     0101 00254000
         BR    @14                                                 0101 00255000
@DATA    DS    0H                                                       00256000
@SM00433 MVC   RPLCORE(0),RPLLIST                                       00257000
@SM00435 MVC   ACBCORE(0),ACBLIST                                       00258000
@SM00437 MVC   ENQCORE(0),ENQLIST                                       00259000
@SM00439 MVC   ACBCORE1(0),ACBLIST1                                     00260000
@SM00441 MVC   ENQCORE1(0),ENQLIST1                                     00261000
@SM00443 MVC   OPENCORE(0),OPENLIST                                     00262000
@SM00445 MVC   CLOSECRE(0),CLOSELST                                     00263000
@DATD    DSECT                                                          00264000
         DS    0F                                                       00265000
@SA00001 DS    18F                                                      00266000
@SA00002 DS    15F                                                      00267000
IEFJSWT  CSECT                                                          00268000
         DS    0F                                                       00269000
@CF00353 DC    F'80'                                                    00270000
@DATD    DSECT                                                          00271000
         DS    0D                                                       00272000
SSIBPTR  DS    A                                                        00273000
ACBPTR   DS    A                                                        00274000
IEFJSWT  CSECT                                                          00275000
         DS    0F                                                       00276000
@SIZDATD DC    AL1(0)                                                   00277000
         DC    AL3(@ENDDATD-@DATD)                                      00278000
         DS    0D                                                       00279000
SSMAJ    DC    CL8'SYSIEFSD'                                            00280000
SSMIN    DC    CL6'TSOQUE'                                              00281000
SSMIN1   DC    CL6'STCQUE'                                              00282000
PATCH    DC    X'00'                                                    00283000
         DS    49XL1                                                    00284000
IEFJSWT  CSECT                                                          00285000
*                                   /* GEN THE ENQ LIST*/               00286000
ENQLIST  ENQ  (SSMAJ,SSMIN,E,6,SYSTEM),RET=HAVE,MF=L                    00287000
ENQLGTH  DC  A(*-ENQLIST)                                               00288000
@DATD    DSECT                                                          00289000
*                            /* GEN THE AREA FOR ENQ*/                  00290000
ENQCORE  ENQ  (SSMAJ,SSMIN,E,6,SYSTEM),RET=HAVE,MF=L                    00291000
IEFJSWT  CSECT                                                          00292000
*                                       /* GEN THE ENQ LIST */          00293000
ENQLIST1  ENQ  (SSMAJ,SSMIN1,E,6,SYSTEM),RET=HAVE,MF=L                  00294000
ENQLGTH1  DC    A(*-ENQLIST1)                                           00295000
@DATD    DSECT                                                          00296000
ENQCORE1  ENQ  (SSMAJ,SSMIN1,E,6,SYSTEM),RET=HAVE,MF=L                  00297000
IEFJSWT  CSECT                                                          00298000
*                                             /*OPEN LIST FORM*/        00299000
OPENLIST  OPEN (7),MF=L                                                 00300000
OPENLGH1  EQU  *                                                        00301000
OPENLGH2  DC   A(OPENLGH1-OPENLIST)                                     00302000
@DATD    DSECT                                                          00303000
*                               /*OPEN MACRO AREA */                    00304000
OPENCORE  OPEN  (7),MF=L                                                00305000
IEFJSWT  CSECT                                                          00306000
*                                             /*CLOSE LIST FORM*/       00307000
CLOSELST  CLOSE  (7),MF=L                                               00308000
CLOSELG1  EQU  *                                                        00309000
CLOSELG2  DC   A(CLOSELG1-CLOSELST)                                     00310000
@DATD    DSECT                                                          00311000
*                                   /*CLOSE MACRO AREA*/                00312000
CLOSECRE CLOSE (7),MF=L                                                 00313000
IEFJSWT  CSECT                                                          00314000
*                                           /*ACB STRUCTURE*/           00315000
ACBLIST ACB DDNAME=TSOINRDR,MACRF=(OUT,ADR,SEQ)                         00316000
ACBLGH1 EQU   *                                                         00317000
ACBLGH2 DC   A(ACBLGH1-ACBLIST)                                         00318000
@DATD    DSECT                                                          00319000
*                              /*ACB AREA*/                             00320000
ACBCORE  ACB DDNAME=TSOINRDR,MACRF=(OUT,ADR,SEQ)                        00321000
IEFJSWT  CSECT                                                          00322000
*                                            /*ACB STRUCTURE*/          00323000
ACBLIST1 ACB DDNAME=STCINRDR,MACRF=(OUT,ADR,SEQ)                        00324000
ACBLGH3 EQU   *                                                         00325000
ACBLGH4 DC   A(ACBLGH3-ACBLIST1)                                        00326000
@DATD    DSECT                                                          00327000
*                               /*ACB AREA*/                            00328000
ACBCORE1 ACB  DDNAME=STCINRDR,MACRF=(OUT,ADR,SEQ)                       00329000
IEFJSWT  CSECT                                                          00330000
*                                         /* RPL DEFINATION*/           00331000
RPLLIST RPL                                                             00332000
RPLLGH1 EQU  *                                                          00333000
RPLLGH2 DC   A(RPLLGH1-RPLLIST)                                         00334000
@DATD    DSECT                                                          00335000
RPLCORE  RPL                                                            00336000
@DATD    DSECT                                                          00337000
         ORG   *+1-(*-@DATD)/(*-@DATD) INSURE DSECT DATA                00338000
@ENDDATD EQU   *                                                        00339000
IEFJSWT  CSECT                                                          00340000
@00      EQU   00                      EQUATES FOR REGISTERS 0-15       00341000
@01      EQU   01                                                       00342000
@02      EQU   02                                                       00343000
@03      EQU   03                                                       00344000
@04      EQU   04                                                       00345000
@05      EQU   05                                                       00346000
@06      EQU   06                                                       00347000
@07      EQU   07                                                       00348000
@08      EQU   08                                                       00349000
@09      EQU   09                                                       00350000
@10      EQU   10                                                       00351000
@11      EQU   11                                                       00352000
@12      EQU   12                                                       00353000
@13      EQU   13                                                       00354000
@14      EQU   14                                                       00355000
@15      EQU   15                                                       00356000
RPLPTR   EQU   @02                                                      00357000
JCLPTR   EQU   @03                                                      00358000
PARMPTR  EQU   @04                                                      00359000
R1       EQU   @01                                                      00360000
R7       EQU   @07                                                      00361000
R15      EQU   @15                                                      00362000
IFGACB   EQU   0                                                        00363000
ACBAMBL  EQU   IFGACB+4                                                 00364000
ACBIXLST EQU   ACBAMBL                                                  00365000
ACBJWA   EQU   ACBIXLST                                                 00366000
ACBMACRF EQU   IFGACB+12                                                00367000
ACBMACR1 EQU   ACBMACRF                                                 00368000
ACBADR   EQU   ACBMACR1                                                 00369000
ACBCNV   EQU   ACBMACR1                                                 00370000
ACBMACR2 EQU   ACBMACRF+1                                               00371000
ACBLFB   EQU   IFGACB+20                                                00372000
ACBBUFPL EQU   ACBLFB                                                   00373000
ACBRECFM EQU   IFGACB+24                                                00374000
ACBCCTYP EQU   IFGACB+25                                                00375000
ACBOPT   EQU   IFGACB+26                                                00376000
ACBDSORG EQU   ACBOPT                                                   00377000
ACBCROPS EQU   ACBDSORG                                                 00378000
ACBEXLST EQU   IFGACB+36                                                00379000
ACBDDNM  EQU   IFGACB+40                                                00380000
ACBOFLGS EQU   IFGACB+48                                                00381000
ACBINFLG EQU   IFGACB+50                                                00382000
ACBUJFCB EQU   IFGACB+52                                                00383000
ACBWAPTR EQU   ACBUJFCB                                                 00384000
IFGRPL   EQU   0                                                        00385000
RPLIDWD  EQU   IFGRPL                                                   00386000
RPLECB   EQU   IFGRPL+8                                                 00387000
RPLSTAT  EQU   IFGRPL+12                                                00388000
RPLFDBK  EQU   IFGRPL+13                                                00389000
RPLRTNCD EQU   RPLFDBK                                                  00390000
RPLCNDCD EQU   RPLFDBK+1                                                00391000
RPLKEYLE EQU   IFGRPL+16                                                00392000
RPLDACB  EQU   IFGRPL+24                                                00393000
RPLAREA  EQU   IFGRPL+32                                                00394000
RPLOPTCD EQU   IFGRPL+40                                                00395000
RPLOPT1  EQU   RPLOPTCD                                                 00396000
RPLOPT2  EQU   RPLOPTCD+1                                               00397000
RPLADR   EQU   RPLOPT2                                                  00398000
RPLOPT3  EQU   RPLOPTCD+2                                               00399000
RPLNXTRP EQU   IFGRPL+44                                                00400000
RPLRLEN  EQU   IFGRPL+48                                                00401000
RPLRBAR  EQU   IFGRPL+60                                                00402000
RPL6RBA  EQU   RPLRBAR+2                                                00403000
CHAIN    EQU   0                                                        00404000
CHFLG    EQU   CHAIN+4                                                  00405000
CHVCD    EQU   CHFLG                                                    00406000
CHSTS    EQU   CHFLG+2                                                  00407000
CHACT    EQU   CHFLG+3                                                  00408000
CHKEY    EQU   CHAIN+8                                                  00409000
CHPKE    EQU   CHAIN+28                                                 00410000
CHTJID   EQU   CHAIN+30                                                 00411000
CHACT1   EQU   CHAIN+35                                                 00412000
CHASM    EQU   CHAIN+40                                                 00413000
CHCIBP   EQU   CHASM+4                                                  00414000
CHRGNSZ  EQU   CHASM+8                                                  00415000
CHSHORT  EQU   CHASM+24                                                 00416000
CHSWT    EQU   CHSHORT                                                  00417000
SSIB     EQU   0                                                        00418000
SSIBFLG1 EQU   SSIB+6                                                   00419000
SSIBJBID EQU   SSIB+12                                                  00420000
SSOB     EQU   0                                                        00421000
SSOBSSIB EQU   SSOB+8                                                   00422000
PARMAREA EQU   0                                                        00423000
JCLSPTR  EQU   PARMAREA                                                 00424000
CSCBPTR  EQU   PARMAREA+4                                               00425000
SSOBPTR  EQU   PARMAREA+8                                               00426000
JCLSAREA EQU   0                                                        00427000
NEXTJCLS EQU   JCLSAREA                                                 00428000
THEJCL   EQU   JCLSAREA+8                                               00429000
CHAINS01 EQU   CHASM                                                    00430000
CHTYPE   EQU   CHAINS01+124                                             00431000
CHTRSTAT EQU   CHAINS01+125                                             00432000
CHCSYSO  EQU   CHAINS01+134                                             00433000
         AGO   .@UNREFD                START UNREFERENCED COMPONENTS    00434000
CHLAST   EQU   CHAINS01+136                                             00435000
CHSPA    EQU   CHAINS01+135                                             00436000
CHUSERID EQU   CHCSYSO                                                  00437000
CHJB     EQU   CHCSYSO                                                  00438000
CHDUMP   EQU   CHCSYSO                                                  00439000
CHQUE    EQU   CHCSYSO                                                  00440000
CHHOLD   EQU   CHCSYSO                                                  00441000
CHOUT    EQU   CHCSYSO                                                  00442000
CHINN    EQU   CHCSYSO                                                  00443000
CHALL    EQU   CHCSYSO                                                  00444000
CHINC    EQU   CHAINS01+132                                             00445000
CHPEND   EQU   CHAINS01+128                                             00446000
CHARID   EQU   CHAINS01+127                                             00447000
CHCNID   EQU   CHAINS01+126                                             00448000
@NM00021 EQU   CHTRSTAT                                                 00449000
CHTSL    EQU   CHTRSTAT                                                 00450000
CHTS     EQU   CHTRSTAT                                                 00451000
CHINITL  EQU   CHTRSTAT                                                 00452000
CHINIT   EQU   CHTRSTAT                                                 00453000
CHJOBSL  EQU   CHTRSTAT                                                 00454000
CHJOBS   EQU   CHTRSTAT                                                 00455000
CHDEF    EQU   CHTYPE                                                   00456000
CHHIAR   EQU   CHTYPE                                                   00457000
CHARSV29 EQU   CHTYPE                                                   00458000
CHARSV28 EQU   CHTYPE                                                   00459000
CHARSV27 EQU   CHTYPE                                                   00460000
CHARSV26 EQU   CHTYPE                                                   00461000
CHARSV25 EQU   CHTYPE                                                   00462000
CHDSTAT  EQU   CHTYPE                                                   00463000
CHBUF    EQU   CHAINS01                                                 00464000
@NM00023 EQU   JCLSAREA+4                                               00465000
SSOBINDV EQU   SSOB+16                                                  00466000
SSOBRETN EQU   SSOB+12                                                  00467000
SSOBFUNC EQU   SSOB+6                                                   00468000
SSOBLEN  EQU   SSOB+4                                                   00469000
SSOBID   EQU   SSOB                                                     00470000
SSIBSUSE EQU   SSIB+32                                                  00471000
SSIBRSV1 EQU   SSIB+28                                                  00472000
SSIBDEST EQU   SSIB+20                                                  00473000
SSIBSSNM EQU   SSIB+8                                                   00474000
SSIBRESV EQU   SSIB+7                                                   00475000
@NM00022 EQU   SSIBFLG1                                                 00476000
SSIBPJES EQU   SSIBFLG1                                                 00477000
SSIBLEN  EQU   SSIB+4                                                   00478000
SSIBID   EQU   SSIB                                                     00479000
CHARSV16 EQU   CHSHORT+108                                              00480000
CHARSV15 EQU   CHSHORT+104                                              00481000
CHJSCBVS EQU   CHSHORT+100                                              00482000
CHUSCVS  EQU   CHSHORT+96                                               00483000
@NM00020 EQU   CHSHORT+92                                               00484000
@NM00019 EQU   CHSHORT+88                                               00485000
CHSQA    EQU   CHSHORT+52                                               00486000
CHQPA    EQU   CHSHORT+16                                               00487000
CHJCL    EQU   CHSHORT+12                                               00488000
CHSPC    EQU   CHSHORT+8                                                00489000
CHSPB    EQU   CHSHORT+4                                                00490000
CHTCB    EQU   CHSHORT+1                                                00491000
CHARSV23 EQU   CHSWT                                                    00492000
CHARSV22 EQU   CHSWT                                                    00493000
CHARSV21 EQU   CHSWT                                                    00494000
CHAC     EQU   CHSWT                                                    00495000
CHPSF    EQU   CHSWT                                                    00496000
CHPSD    EQU   CHSWT                                                    00497000
CHJCT    EQU   CHSWT                                                    00498000
CHARSV20 EQU   CHSWT                                                    00499000
CHCECB   EQU   CHASM+20                                                 00500000
CHECB    EQU   CHASM+16                                                 00501000
CHRGNAD  EQU   CHASM+12                                                 00502000
CHARSV18 EQU   CHRGNSZ+1                                                00503000
CHRPRTY  EQU   CHRGNSZ                                                  00504000
@NM00018 EQU   CHCIBP                                                   00505000
CHEND    EQU   CHCIBP                                                   00506000
CHECBP   EQU   CHASM                                                    00507000
CHDER    EQU   CHAIN+36                                                 00508000
CHARSV10 EQU   CHACT1                                                   00509000
CHARSV09 EQU   CHACT1                                                   00510000
CHARSV08 EQU   CHACT1                                                   00511000
CHARSV07 EQU   CHACT1                                                   00512000
CHARSV06 EQU   CHACT1                                                   00513000
CHARSV05 EQU   CHACT1                                                   00514000
CHARSV04 EQU   CHACT1                                                   00515000
CHRDWTR  EQU   CHACT1                                                   00516000
CHARSV30 EQU   CHAIN+34                                                 00517000
CHQID    EQU   CHAIN+32                                                 00518000
CHASID   EQU   CHTJID                                                   00519000
CHUCMP   EQU   CHAIN+29                                                 00520000
CHTRKID  EQU   CHPKE                                                    00521000
CHCIBCTR EQU   CHAIN+27                                                 00522000
CHUNIT   EQU   CHAIN+24                                                 00523000
CHCLS    EQU   CHAIN+16                                                 00524000
CHPARM   EQU   CHKEY                                                    00525000
CHIFY    EQU   CHACT                                                    00526000
CHAIFX   EQU   CHACT                                                    00527000
CHCLD    EQU   CHACT                                                    00528000
CHCL     EQU   CHACT                                                    00529000
CHDSI    EQU   CHACT                                                    00530000
CHDISC   EQU   CHACT                                                    00531000
CHTERM   EQU   CHACT                                                    00532000
CHSWAP   EQU   CHACT                                                    00533000
CHABTERM EQU   CHSTS                                                    00534000
CHFC     EQU   CHSTS                                                    00535000
CHDL     EQU   CHSTS                                                    00536000
CHAD     EQU   CHSTS                                                    00537000
CHQSPC   EQU   CHSTS                                                    00538000
CHSOUT   EQU   CHSTS                                                    00539000
CHSYS    EQU   CHSTS                                                    00540000
CHAP     EQU   CHSTS                                                    00541000
CHSZE    EQU   CHFLG+1                                                  00542000
CHPTR    EQU   CHAIN                                                    00543000
RPLERMSA EQU   IFGRPL+72                                                00544000
RPLEMLEN EQU   IFGRPL+70                                                00545000
@NM00017 EQU   IFGRPL+68                                                00546000
RPLDDDD  EQU   RPL6RBA+2                                                00547000
RPLS2S2  EQU   RPL6RBA                                                  00548000
RPLS1S1  EQU   RPLRBAR                                                  00549000
@NM00016 EQU   IFGRPL+56                                                00550000
RPLBUFL  EQU   IFGRPL+52                                                00551000
RPLCHAIN EQU   RPLNXTRP                                                 00552000
RPLOPT4  EQU   RPLOPTCD+3                                               00553000
RPLALIGN EQU   RPLOPT3                                                  00554000
RPLFMT   EQU   RPLOPT3                                                  00555000
RPLFLD   EQU   RPLOPT3                                                  00556000
RPLVFY   EQU   RPLOPT3                                                  00557000
RPLBLK   EQU   RPLOPT3                                                  00558000
RPLSFORM EQU   RPLOPT3                                                  00559000
RPLEODS  EQU   RPLOPT3                                                  00560000
RPLNSP   EQU   RPLOPT2                                                  00561000
RPLUPD   EQU   RPLOPT2                                                  00562000
@NM00015 EQU   RPLOPT2                                                  00563000
RPLCNV   EQU   RPLOPT2                                                  00564000
RPLADD   EQU   RPLADR                                                   00565000
RPLKEY   EQU   RPLOPT2                                                  00566000
RPLECBSW EQU   RPLOPT1                                                  00567000
RPLGEN   EQU   RPLOPT1                                                  00568000
RPLKGE   EQU   RPLOPT1                                                  00569000
RPLASY   EQU   RPLOPT1                                                  00570000
RPLSKP   EQU   RPLOPT1                                                  00571000
RPLSEQ   EQU   RPLOPT1                                                  00572000
RPLDIR   EQU   RPLOPT1                                                  00573000
RPLLOC   EQU   RPLOPT1                                                  00574000
RPLARG   EQU   IFGRPL+36                                                00575000
RPLTCBPT EQU   IFGRPL+28                                                00576000
RPLCCHAR EQU   IFGRPL+20                                                00577000
RPLSTRID EQU   IFGRPL+18                                                00578000
RPLKEYL  EQU   RPLKEYLE                                                 00579000
RPLERRCD EQU   RPLCNDCD+1                                               00580000
RPLCMPON EQU   RPLCNDCD                                                 00581000
RPLERREG EQU   RPLRTNCD                                                 00582000
@NM00014 EQU   RPLSTAT                                                  00583000
RPLEDRQI EQU   RPLSTAT                                                  00584000
RPLCHKI  EQU   RPLSTAT                                                  00585000
RPLACTIV EQU   RPLSTAT                                                  00586000
RPLPOST  EQU   RPLECB                                                   00587000
RPLWAIT  EQU   RPLECB                                                   00588000
RPLPLHPT EQU   IFGRPL+4                                                 00589000
RPLLEN   EQU   RPLIDWD+3                                                00590000
RPLREQ   EQU   RPLIDWD+2                                                00591000
RPLSTYP  EQU   RPLIDWD+1                                                00592000
RPLID    EQU   RPLIDWD                                                  00593000
@NM00013 EQU   IFGACB+72                                                00594000
@NM00012 EQU   IFGACB+68                                                00595000
ACBUAPTR EQU   IFGACB+64                                                00596000
ACBLRECL EQU   IFGACB+62                                                00597000
ACBBLKSZ EQU   IFGACB+60                                                00598000
ACBBUFSP EQU   IFGACB+56                                                00599000
@NM00011 EQU   ACBWAPTR+1                                               00600000
ACBOPTN  EQU   ACBWAPTR                                                 00601000
ACBCAT   EQU   ACBINFLG                                                 00602000
ACBIJRQE EQU   ACBINFLG                                                 00603000
ACBJEPS  EQU   ACBINFLG                                                 00604000
@NM00010 EQU   ACBINFLG                                                 00605000
ACBERFLG EQU   IFGACB+49                                                00606000
ACBIOSFG EQU   ACBOFLGS                                                 00607000
ACBEXFG  EQU   ACBOFLGS                                                 00608000
@NM00009 EQU   ACBOFLGS                                                 00609000
ACBDSERR EQU   ACBOFLGS                                                 00610000
ACBOPEN  EQU   ACBOFLGS                                                 00611000
ACBEOV   EQU   ACBOFLGS                                                 00612000
@NM00008 EQU   ACBOFLGS                                                 00613000
ACBDEB   EQU   ACBDDNM+5                                                00614000
ACBERFL  EQU   ACBDDNM+4                                                00615000
ACBAMETH EQU   ACBDDNM+3                                                00616000
ACBINFL  EQU   ACBDDNM+2                                                00617000
ACBTIOT  EQU   ACBDDNM                                                  00618000
ACBUEL   EQU   ACBEXLST                                                 00619000
ACBPASSW EQU   IFGACB+32                                                00620000
@NM00007 EQU   IFGACB+28                                                00621000
@NM00006 EQU   ACBDSORG+1                                               00622000
ACBDORGA EQU   ACBDSORG+1                                               00623000
@NM00005 EQU   ACBDSORG                                                 00624000
ACBCRNRE EQU   ACBCROPS                                                 00625000
ACBCRNCK EQU   ACBCROPS                                                 00626000
ACBASA   EQU   ACBCCTYP                                                 00627000
@NM00004 EQU   ACBCCTYP                                                 00628000
ACBRECAF EQU   ACBRECFM                                                 00629000
ACBJBUF  EQU   ACBBUFPL+2                                               00630000
@NM00003 EQU   ACBBUFPL                                                 00631000
ACBBUFNI EQU   IFGACB+18                                                00632000
ACBBUFND EQU   IFGACB+16                                                00633000
ACBSTRNO EQU   IFGACB+14                                                00634000
@NM00002 EQU   ACBMACR2                                                 00635000
@NM00001 EQU   ACBMACR2                                                 00636000
ACBSKP   EQU   ACBMACR2                                                 00637000
ACBCHN   EQU   ACBMACR2                                                 00638000
ACBCBRD  EQU   ACBMACR2                                                 00639000
ACBCBOPN EQU   ACBMACR2                                                 00640000
ACBUPD   EQU   ACBMACR1                                                 00641000
ACBOUT   EQU   ACBMACR1                                                 00642000
ACBIN    EQU   ACBMACR1                                                 00643000
ACBDIR   EQU   ACBMACR1                                                 00644000
ACBSEQ   EQU   ACBMACR1                                                 00645000
ACBBLK   EQU   ACBCNV                                                   00646000
ACBADD   EQU   ACBADR                                                   00647000
ACBKEY   EQU   ACBMACR1                                                 00648000
ACBINRTN EQU   IFGACB+8                                                 00649000
ACBIBCT  EQU   ACBJWA                                                   00650000
ACBLENG  EQU   IFGACB+2                                                 00651000
ACBSTYP  EQU   IFGACB+1                                                 00652000
ACBID    EQU   IFGACB                                                   00653000
.@UNREFD ANOP                          END UNREFERENCED COMPONENTS      00654000
@PB00002 EQU   @EL00001                                                 00655000
@ENDDATA EQU   *                                                        00656000
         END   IEFJSWT                                                  00657000
./  ADD  SSI=72690048,NAME=IGC0203E
         TITLE 'WRITE TO PROGRAMMER VS/2  MODULE * IEEJB840 *          *00001000
                        '                                               00002000
IGC0203E CSECT ,                                                   0001 00003000
@MAINENT DS    0H                                                  0001 00004000
         USING *,@15                                               0001 00005000
         B     @PROLOG                                             0001 00006000
         DC    AL1(16)                                             0001 00007000
         DC    C'IGC0203E  77.269'                                 0001 00008000
         DROP  @15                                                      00009000
@PROLOG  STM   @14,@12,12(@13)                                     0001 00010000
         BALR  @11,0                                               0001 00011000
@PSTART  DS    0H                                                  0001 00012000
         USING @PSTART,@11                                         0001 00013000
         L     @00,@SIZDATD                                        0001 00014000
         GETMAIN  R,LV=(0)                                              00015000
         LR    @09,@01                                             0001 00016000
         USING @DATD,@09                                           0001 00017000
         ST    @13,@SA00001+4                                      0001 00018000
         LM    @00,@01,20(@13)                                     0001 00019000
         ST    @09,8(,@13)                                         0001 00020000
         LR    @13,@09                                             0001 00021000
         XC    @ZTEMPS(@ZLEN),@ZTEMPS                                   00022000
JSCBDISP EQU 188                                                        00023000
JSCBAOS1 EQU  72                                                        00024000
JSCBAOS2 EQU 192                                                        00025000
RBPRFXLN EQU 64                                                         00026000
RBPRFLNA EQU 32                                                         00027000
PRBLEN   EQU 136                                                        00028000
SIRBLEN  EQU 200                                                        00029000
TIRBLEN  EQU 136                                                        00030000
IRBLEN   EQU 128                                                        00031000
SVRBLEN  EQU 200                                                        00032000
*   REG12=REG5;                     /* PLACE SVRB ADDR IN REG12      */ 00033000
         LR    REG12,REG5                                          0144 00034000
*   TCBPTR2=REG4;                   /* SAVE USERS TCB POINTER        */ 00035000
         ST    REG4,TCBPTR2                                        0145 00036000
*   RESPECIFY                                                      0146 00037000
*     REG4 UNRESTRICTED;                                           0146 00038000
*   CALL GETESTAE;                  /* CREATE STAE ENVIRONMENT       */ 00039000
         BAL   @14,GETESTAE                                        0147 00040000
*   IF REG15=0 THEN                 /* IF STAE ENVIRONMENT CREATED 0148 00041000
*                                      THEN CONTINUE PROCESSING    0148 00042000
*                                      OTHERWISE RETURN TO CALLER    */ 00043000
         SLR   @04,@04                                             0148 00044000
         CR    REG15,@04                                           0148 00045000
         BNE   @RF00148                                            0148 00046000
*     DO;                                                          0149 00047000
*       RESPECIFY                                                  0150 00048000
*         TCB BASED(TCBPTR2);                                      0150 00049000
*       IF TCBJSCBB=0 THEN         /* IF NO JSCB PTR RETURN TO    0151 00050000
*                                      CALLER                        */ 00051000
         L     @02,TCBPTR2                                         0151 00052000
         L     @01,TCBJSCBB-1(,@02)                                0151 00053000
         LA    @01,0(,@01)                                         0151 00054000
         LTR   @01,@01                                             0151 00055000
         BZ    @RF00151                                            0151 00056000
*         DO;                                                      0152 00057000
*                                                                  0152 00058000
*           /*********************************************************/ 00059000
*           /*                                                       */ 00060000
*           /* GET ACTIVE JSCB ADDRESS FROM JSCBACT.CHECK IF TSO     */ 00061000
*           /* USER(FIELD ASCBTSB IN THE ASCB HAS AN ADDRESS IF A TSO*/ 00062000
*           /* USER). IF SO THE MESSAGE IS PUT TO HIS TERMINAL VIA   */ 00063000
*           /* TPUT MACRO. IF THE TPUT IS SUCCESSFUL BYPASS ALL      */ 00064000
*           /* PROCESSING UP TO THE SCAN OF THE UCM TABLE FOR MORE   */ 00065000
*           /* CONSOLES THAT RECEIVE ROUTE CODE 11 MESSAGES. IF NOT  */ 00066000
*           /* SUCCESSFUL TRY TO PUT THE MESSAGE TO HIS MESSAGE DATA */ 00067000
*           /* SET.                                                  */ 00068000
*           /*                                                       */ 00069000
*           /*********************************************************/ 00070000
*                                                                  0153 00071000
*           JSCBADDR=JSCBACT;       /* PUT ACTIVE JSCB ADDR IN REG 5 */ 00072000
         L     @02,TCBJSCB(,@02)                                   0153 00073000
         L     JSCBADDR,JSCBACT(,@02)                              0153 00074000
*           RESPECIFY                                              0154 00075000
*             IEZJSCB BASED(JSCBADDR);                             0154 00076000
*           REG15=4;                /* INITIALIZE REG 15             */ 00077000
         LA    REG15,4                                             0155 00078000
*           IF ASCBTSB=0 THEN      /* CHECK FOR TSO USER IF SO      */ 00079000
         C     @04,ASCBTSB(,ASCBPTR)                               0156 00080000
         BE    @RF00156                                            0156 00081000
*             CALL ISSUTPUT;        /* PUT MSG TO HIS TERMINAL       */ 00082000
         BAL   @14,ISSUTPUT                                        0157 00083000
*           IF REG15=0 THEN        /* IF PUT WASNT SUCCESSFUL THEN  */ 00084000
@RF00156 LTR   REG15,REG15                                         0158 00085000
         BZ    @RF00158                                            0158 00086000
*             DO;                   /* PUT MSG TO SYSTEM MSG DS      */ 00087000
*                                                                  0159 00088000
*               /*****************************************************/ 00089000
*               /*                                                   */ 00090000
*               /* CHECK IF THIS JOBSTEP HAS ISSUED PREVIOUS WTP     */ 00091000
*               /* MSGS. IF NOT THEN INITIALIZE THE JSCB. ENQUEUE TO */ 00092000
*               /* SERIALIZE PROCESSING OF THE PUT TO HASP. ALSO     */ 00093000
*               /* CHECK FOR THE PRESENCE OF AN RPL POINTER.         */ 00094000
*               /*                                                   */ 00095000
*               /*****************************************************/ 00096000
*                                                                  0160 00097000
*               CALL CHECKJOB;      /* CHECK IF JOB HAS ISSUED     0160 00098000
*                                      PREVIOUS WTP MSGS             */ 00099000
         BAL   @14,CHECKJOB                                        0160 00100000
*               CALL ISSUEENQ;      /* ENQ TO SERIALIZE PROCESSING 0161 00101000
*                                      ALSO CHECK RPL POINTER        */ 00102000
         BAL   @14,ISSUEENQ                                        0161 00103000
*               IF REG15=0 THEN     /* IF ENQ SUCCESSFUL CONTINUE  0162 00104000
*                                      PROCESSING                    */ 00105000
         LTR   REG15,REG15                                         0162 00106000
         BNZ   @RF00162                                            0162 00107000
*                 DO;                                              0163 00108000
*                                                                  0163 00109000
*                   /*************************************************/ 00110000
*                   /*                                               */ 00111000
*                   /* IF ENQUEUE IS SUCCESSFUL THEN REG 3 IS        */ 00112000
*                   /* INITIALIZED WITH THE ADDRESS OF THE MESSAGE   */ 00113000
*                   /* AND REG 8 WITH THE LENGTH OF THE MESSAGE. THE */ 00114000
*                   /* MESSAGE IS CHECKED TO SEE IF IT EXCEEDS 126   */ 00115000
*                   /* BYTES (MAX LENGTH). IF IT DOES IT IS BROKEN UP*/ 00116000
*                   /* INTO 126 BYTE SEGMENTS OR LESS DEPENDING WHERE*/ 00117000
*                   /* THE LAST FULL WORD ENDS. EACH SEGMENT WILL BE */ 00118000
*                   /* PUT TO THE SYSTEM MSG DATA SET UNTIL ALL      */ 00119000
*                   /* SEGMENTS HAVE BEEN EXHAUSTED. THE RPL IS      */ 00120000
*                   /* INITIALIZED AND THE PUT TO THE SYSTEM MSG DATA*/ 00121000
*                   /* SET ISSUED. RETURN CODES FROM HASP ARE CHECKED*/ 00122000
*                   /* FOR SUCCESSFUL COMPLETION OF THE PUT.         */ 00123000
*                   /*                                               */ 00124000
*                   /*************************************************/ 00125000
*                                                                  0164 00126000
*                   RESPECIFY                                      0164 00127000
*                    (REG2) RESTRICTED;                            0164 00128000
*                   REG3=ADDR(WPLTXT);/* GET MSG ADDRESS             */ 00129000
         LA    REG3,WPLTXT(,WPLPTR)                                0165 00130000
*                   REG8=XVMSGLGH-4;/* GET MSG LENGTH INTO REG 8     */ 00131000
         LH    REG8,XVMSGLGH(,REG12)                               0166 00132000
         SH    REG8,@CH00090                                       0166 00133000
*                   DO WHILE(REG8=0);/* AS LONG AS A MSG SEGMENT  0167 00134000
*                                      EXIST CONTINUE PROCESSING     */ 00135000
         B     @DE00167                                            0167 00136000
@DL00167 DS    0H                                                  0168 00137000
*                     CALL CHECKMSG;/* CHECK IF MSG > 126 BYTES      */ 00138000
         BAL   @14,CHECKMSG                                        0168 00139000
*                     CALL BUILDRPL;/* INITIALZE RPL FOR PUT         */ 00140000
         BAL   @14,BUILDRPL                                        0169 00141000
*                     GEN(PUT  RPL=(1));/* ISSUE PUT TO SYSTEM MSG DS*/ 00142000
         PUT  RPL=(1)                                                   00143000
*                     CALL CKRETURN;/* CHECK IF PUT SUCCESSFUL       */ 00144000
         BAL   @14,CKRETURN                                        0171 00145000
*                   END;                                           0172 00146000
@DE00167 LTR   REG8,REG8                                           0172 00147000
         BNZ   @DL00167                                            0172 00148000
*                   RESPECIFY                                      0173 00149000
*                    (REG2) UNRESTRICTED;                          0173 00150000
*                   REG8=REG15;     /* SAVE RETURN CODE              */ 00151000
         LR    REG8,REG15                                          0174 00152000
*                   CALL ISSUEDEQ;  /* RELEASE RESOURCE              */ 00153000
         BAL   @14,ISSUEDEQ                                        0175 00154000
*                   REG15=REG8;     /* RESTORE RETURN CODE           */ 00155000
         LR    REG15,REG8                                          0176 00156000
*                 END;                                             0177 00157000
*             END;                                                 0178 00158000
@RF00162 DS    0H                                                  0179 00159000
*         END;                                                     0179 00160000
*                                                                  0179 00161000
@RF00158 DS    0H                                                  0180 00162000
*       /*************************************************************/ 00163000
*       /*                                                           */ 00164000
*       /* IF AN ERROR OCCURRED DURING THE PUT TO HASP OR THE RPL    */ 00165000
*       /* POINTER WAS ZERO AN ERROR MSG WILL BE ISSUED VIA WTO TO   */ 00166000
*       /* HARD COPY.                                                */ 00167000
*       /*                                                           */ 00168000
*       /*************************************************************/ 00169000
*                                                                  0180 00170000
*       IF REG15=0 THEN            /* CK IF I/O ERROR OCCURRED      */ 00171000
@RF00151 LTR   REG15,REG15                                         0180 00172000
         BZ    @RF00180                                            0180 00173000
*         DO;                                                      0181 00174000
*           REG6SAVE=REG6;          /* SAVE WPL POINTER              */ 00175000
         ST    REG6,REG6SAVE                                       0182 00176000
*           CALL BUILDMSG;          /* CREATE WTO MSG FOR HARDCOPY   */ 00177000
         BAL   @14,BUILDMSG                                        0183 00178000
*           CALL ISSUEMSG;          /* ISSUE WTO TO HARD COPY        */ 00179000
         BAL   @14,ISSUEMSG                                        0184 00180000
*           REG6=REG6SAVE;          /* RESTORE WPL POINTER           */ 00181000
         L     REG6,REG6SAVE                                       0185 00182000
*         END;                                                     0186 00183000
*                                                                  0186 00184000
*       /*************************************************************/ 00185000
*       /*                                                           */ 00186000
*       /* TO DETERMINE WHETHER TO TURN ON XVD0USER BIT (RETURN TO   */ 00187000
*       /* USER BIT) CHECKS ARE MADE FOR ADDITIONAL ROUTE CODES ON   */ 00188000
*       /* THE MESSAGE AND IF ANY CONSOLES RECEIVE ROUTE CODE 11     */ 00189000
*       /* MESSAGES. FLAG BITS IN THE WPL ARE ALSO CHECKED. IF ANY OF*/ 00190000
*       /* THE ABOVE CONDITIONS ARE POSITIVE WE RETURN TO WTO WITHOUT*/ 00191000
*       /* TURNING ON XVD0USER BIT.                                  */ 00192000
*       /*                                                           */ 00193000
*       /*************************************************************/ 00194000
*                                                                  0187 00195000
*       RFY                                                        0187 00196000
*        (REG1,                                                    0187 00197000
*         REG11) RESTRICTED;                                       0187 00198000
@RF00180 DS    0H                                                  0188 00199000
*       REG1=0;                                                    0188 00200000
         SLR   REG1,REG1                                           0188 00201000
*STAERETY:                                                         0189 00202000
*       IF REG1=0 THEN             /* STAE RETRY WILL ENTER HERE    */ 00203000
STAERETY LTR   REG1,REG1                                           0189 00204000
         BZ    @RF00189                                            0189 00205000
*         DO;                       /* REG1 WILL POINT TO MY REGS    */ 00206000
*           REG11=REG1->REGBASE2;   /* RESTORE BASE REG              */ 00207000
         L     REG11,REGBASE2(,REG1)                               0191 00208000
*           CALL LOADREGS;          /* LOAD REST OF REGISTERS        */ 00209000
         BAL   @14,LOADREGS                                        0192 00210000
*         END;                                                     0193 00211000
*       RFY                                                        0194 00212000
*        (REG1,                                                    0194 00213000
*         REG11) UNRESTRICTED;                                     0194 00214000
@RF00189 DS    0H                                                  0195 00215000
*       CALL FINALCK;               /* CK FOR ADDITIONAL WTO WORK    */ 00216000
         BAL   @14,FINALCK                                         0195 00217000
*       GEN(ESTAE 0 );              /* CLEAN UP ESTAE ENVIRONMENT    */ 00218000
         ESTAE 0                                                        00219000
*     END;                                                         0197 00220000
*   ELSE                                                           0198 00221000
*     CALL FINALCK;                 /* NO ESTAE, CK IF MORE WTO WK   */ 00222000
         B     @RC00148                                            0198 00223000
@RF00148 BAL   @14,FINALCK                                         0198 00224000
*   RETURN;                         /* RETURN WTO                    */ 00225000
@EL00001 L     @13,4(,@13)                                         0199 00226000
@EF00001 L     @00,@SIZDATD                                        0199 00227000
         LR    @01,@09                                             0199 00228000
         FREEMAIN R,LV=(0),A=(1)                                        00229000
@ER00001 LM    @14,@12,12(@13)                                     0199 00230000
         BR    @14                                                 0199 00231000
*GETESTAE:                                                         0200 00232000
*   PROC OPTIONS(NOSAVEAREA,NOSAVE);                               0200 00233000
*                                                                  0200 00234000
GETESTAE DS    0H                                                  0201 00235000
*   /*****************************************************************/ 00236000
*   /*                                                               */ 00237000
*   /* THIS ROUTINE BUILDS A PARAMETER LIST FOR ESTAE AND ISSUES THE */ 00238000
*   /* ESTAE MACRO.                                                  */ 00239000
*   /*                                                               */ 00240000
*   /*****************************************************************/ 00241000
*                                                                  0201 00242000
*   RESPECIFY                                                      0201 00243000
*    (REG1,                                                        0201 00244000
*     REG2,                                                        0201 00245000
*     REG9,                                                        0201 00246000
*     REG11) RESTRICTED;                                           0201 00247000
*   MSGID='4';                      /* INITIALIZE MSG ISSUER ID TO AN   00248000
*                                      UNPREDICATABLE ERROR          */ 00249000
         MVI   MSGID,C'4'                                          0202 00250000
*   REGWPL=REG6;                    /* SAVE WPL REG PTR              */ 00251000
         ST    REG6,REGWPL                                         0203 00252000
*   REGDATA=REG9;                   /* SAVE DATA REG ADDR IN PARM    */ 00253000
         ST    REG9,REGDATA                                        0204 00254000
*   REGUCM=REG10;                   /* SAVE UCM REG PTR              */ 00255000
         ST    REG10,REGUCM                                        0205 00256000
*   REGBASE=REG11;                  /* SAVE BASE REG ADDR IN PARM    */ 00257000
         ST    REG11,REGBASE                                       0206 00258000
*   REGXSA=REG12;                   /* SAVE XSA REG PTR              */ 00259000
         ST    REG12,REGXSA                                        0207 00260000
*   REGSAVE=REG13;                  /* SAVE SAVEAREA POINTER         */ 00261000
         ST    REG13,REGSAVE                                       0208 00262000
*   STAELIST(1:ESTAELEN)=ELIST(1:ESTAELEN);/* MOVE ESTAE LIST FORM 0209 00263000
*                                      INTO WORKAREA                 */ 00264000
         SLR   @04,@04                                             0209 00265000
         IC    @04,ESTAELEN                                        0209 00266000
         BCTR  @04,0                                               0209 00267000
         EX    @04,@SM02281                                        0209 00268000
*   REG3=ADDR(STAE000);             /* GET STAE EXIT ROUTINE ADDR    */ 00269000
         LA    REG3,STAE000                                        0210 00270000
*   REG2=ADDR(STAEPARM);            /* GET PARM LIST ADDR            */ 00271000
         LA    REG2,STAEPARM                                       0211 00272000
*   GEN REFS(STAELIST);                                            0212 00273000
   ESTAE  (3),CT,RECORD=YES,PARAM=(2),MF=(E,STAELIST)                   00274000
*   RESPECIFY                                                      0213 00275000
*    (REG1,                                                        0213 00276000
*     REG2,                                                        0213 00277000
*     REG9,                                                        0213 00278000
*     REG11) UNRESTRICTED;                                         0213 00279000
*   END;                                                           0214 00280000
@EL00002 DS    0H                                                  0214 00281000
@EF00002 DS    0H                                                  0214 00282000
@ER00002 BR    @14                                                 0214 00283000
*CHECKMSG:                                                         0215 00284000
*   PROC OPTIONS(NOSAVEAREA,NOSAVE);                               0215 00285000
*                                                                  0215 00286000
CHECKMSG DS    0H                                                  0216 00287000
*   /*****************************************************************/ 00288000
*   /*                                                               */ 00289000
*   /* THIS SUB-ROUTINE CHECKS IF THE MESSAGE EXCEEDS 126 CHARACTERS.*/ 00290000
*   /* IF IT DOES THE MESSAGE WILL BE BROKEN UP INTO 126 OR LESS     */ 00291000
*   /* SEGMENTS DEPENDING ON WHERE THE LAST FULL WORD ENDS. THE      */ 00292000
*   /* MESSAGE WILL BE ISSUED SEGMENT BY SEGMENT UNTIL THE ENTIRE    */ 00293000
*   /* MESSAGE HAS BE PUT TO THE SYSTEM MESSAGE DATA SET.            */ 00294000
*   /*                                                               */ 00295000
*   /*****************************************************************/ 00296000
*                                                                  0216 00297000
*   RESPECIFY                                                      0216 00298000
*    (REG2,                                                        0216 00299000
*     REG1,                                                        0216 00300000
*     REG0) RESTRICTED;                                            0216 00301000
*   REG7=REG3;                      /* REG 7 POINTS TO MSG ADDR      */ 00302000
         LR    REG7,REG3                                           0217 00303000
*   IF REG8>126 THEN                /* IF MSG > 126 THEN DO          */ 00304000
         CH    REG8,@CH00622                                       0218 00305000
         BNH   @RF00218                                            0218 00306000
*     DO;                                                          0219 00307000
*       REG2=REG7+125;              /* GET ADDRESS OF 126TH BYTE     */ 00308000
         LA    REG2,125                                            0220 00309000
         ALR   REG2,REG7                                           0220 00310000
*       DO WHILE(REG2->MESSAGE(1)=' '&REG2=REG7);/* SCAN FOR BLANK    00311000
*                                      CHAR OR BEGINNING ADDR OF MSG */ 00312000
         B     @DE00221                                            0221 00313000
@DL00221 DS    0H                                                  0222 00314000
*         REG2=REG2-1;              /* DECREMENT REG 2 FOR BACKWARD     00315000
*                                      SCAN                          */ 00316000
         BCTR  REG2,0                                              0222 00317000
*       END;                                                       0223 00318000
@DE00221 CLI   MESSAGE(REG2),C' '                                  0223 00319000
         BE    @DC00221                                            0223 00320000
         CR    REG2,REG7                                           0223 00321000
         BNE   @DL00221                                            0223 00322000
@DC00221 DS    0H                                                  0224 00323000
*       IF REG2=REG7 THEN           /* CK IF SCAN WAS TERMINATED   0224 00324000
*                                      BECAUSE BLANK WASNT FOUND     */ 00325000
         CR    REG2,REG7                                           0224 00326000
         BNE   @RF00224                                            0224 00327000
*         REG2=REG7+125;            /* YES, THEN POINT REG 2 AT THE     00328000
*                                      126TH BYTE OF MSG             */ 00329000
         LA    REG2,125                                            0225 00330000
         ALR   REG2,REG7                                           0225 00331000
*       REG3=REG2+1;                /* ELSE REG 3 POINTS TO CHAR     */ 00332000
@RF00224 LA    @04,1                                               0226 00333000
         LR    REG3,REG2                                           0226 00334000
         ALR   REG3,@04                                            0226 00335000
*       REG2=REG2-REG7+1;           /* COMPUTE LENGTH TO PUT OUT     */ 00336000
         ST    @04,@TF00001                                        0227 00337000
         LR    @04,REG2                                            0227 00338000
         SLR   @04,REG7                                            0227 00339000
         AL    @04,@TF00001                                        0227 00340000
         LR    REG2,@04                                            0227 00341000
*       REG8=REG8-REG2;             /* REMAINING LENGTH IN REG 8     */ 00342000
         SLR   REG8,REG2                                           0228 00343000
*     END;                                                         0229 00344000
*   ELSE                                                           0230 00345000
*     DO;                                                          0230 00346000
         B     @RC00218                                            0230 00347000
@RF00218 DS    0H                                                  0231 00348000
*       REG2=REG8;                  /* IF LENGTH <126 THEN PUT LENGTH   00349000
*                                      INTO REG 2                    */ 00350000
         LR    REG2,REG8                                           0231 00351000
*       REG8=0;                     /* NO MORE MSG SEGMENTS LEFT PUT    00352000
*                                      ZERO LENGTH INTO REG 8        */ 00353000
         SLR   REG8,REG8                                           0232 00354000
*     END;                                                         0233 00355000
*   END;                                                           0234 00356000
@EL00003 DS    0H                                                  0234 00357000
@EF00003 DS    0H                                                  0234 00358000
@ER00003 BR    @14                                                 0234 00359000
*   RESPECIFY                                                      0235 00360000
*    (REG2) UNRESTRICTED;                                          0235 00361000
*CKROUTCD:                                                         0236 00362000
*   PROC OPTIONS(NOSAVEAREA,NOSAVE);                               0236 00363000
*                                                                  0236 00364000
CKROUTCD DS    0H                                                  0237 00365000
*   /*****************************************************************/ 00366000
*   /*                                                               */ 00367000
*   /* THE MESSAGE IS CHECKED FOR ROUTE CODES OTHER THAN 11. IF THEY */ 00368000
*   /* EXIST THIS MODULE RETURNS TO WTO WITHOUT TURNING ON XVD0USER  */ 00369000
*   /* (RETURN TO USER BIT IN XSA). IF NO OTHER ROUTE CODES EXIST    */ 00370000
*   /* THEN THE UCM TABLE IS SCANNED TO DETERMINE IF ANY CONSOLES ARE*/ 00371000
*   /* TO RECEIVE ROUTE CODE 11 MESSAGES IF SO THEN THIS MODULE      */ 00372000
*   /* RETURNS TO WTO WITHOUT TURNING ON XVD0USER BIT.               */ 00373000
*   /*                                                               */ 00374000
*   /*****************************************************************/ 00375000
*                                                                  0237 00376000
*   IF XVRCSAVE='0020'X THEN        /* OTHER ROUTE CODES WITH MSG    */ 00377000
         CLC   XVRCSAVE(2,REG12),@CB02223                          0237 00378000
         BNE   @RF00237                                            0237 00379000
*     DO;                           /* NO, THEN CK CONSOLES FOR ANY     00380000
*                                      THAT RECEIVE ROUTE CODE 11 MSG*/ 00381000
*       REG7=UCMVEA;                /* ADDRESS OF FIRST UCM          */ 00382000
         L     REG7,UCMVEA(,UCMBASPT)                              0239 00383000
*       REG8=UCMVEZ;                /* LENGTH OF EACH UCM            */ 00384000
         L     REG8,UCMVEZ(,UCMBASPT)                              0240 00385000
*       REG3=UCMVEL;                /* ADDRESS OF LAST UCM           */ 00386000
         L     REG3,UCMVEL(,UCMBASPT)                              0241 00387000
*       DO WHILE(WTPROUTE='1'B&REG7<REG3);/* SCAN ALL UCMS FOR ANY     00388000
*                                      THAT RECEIVE ROUTE CODE 11  0242 00389000
*                                      MSGS                          */ 00390000
         B     @DE00242                                            0242 00391000
@DL00242 DS    0H                                                  0243 00392000
*         REG7=REG7+REG8;           /* INCREMENT REG 7 TO NEXT UCM   */ 00393000
         ALR   REG7,REG8                                           0243 00394000
*       END;                                                       0244 00395000
@DE00242 TM    WTPROUTE(UCMDVEPT),B'00100000'                      0244 00396000
         BO    @DC00242                                            0244 00397000
         CR    REG7,REG3                                           0244 00398000
         BL    @DL00242                                            0244 00399000
@DC00242 DS    0H                                                  0245 00400000
*       IF WTPROUTE='1'B THEN       /* ANY CONSOLES RECEIVE CODE 11  */ 00401000
         TM    WTPROUTE(UCMDVEPT),B'00100000'                      0245 00402000
         BNO   @RF00245                                            0245 00403000
*         REG15=0;                  /* YES, THEN RC = RETURN TO WTO  */ 00404000
         SLR   REG15,REG15                                         0246 00405000
*       ELSE                                                       0247 00406000
*         REG15=4;                  /* NO, RC = RETURN TO USER       */ 00407000
         B     @RC00245                                            0247 00408000
@RF00245 LA    REG15,4                                             0247 00409000
*     END;                                                         0248 00410000
*   ELSE                                                           0249 00411000
*     REG15=0;                      /* OTHER ROUTE CODES RC = RETURN    00412000
*                                      TO WTO                        */ 00413000
         B     @RC00237                                            0249 00414000
@RF00237 SLR   REG15,REG15                                         0249 00415000
*   END;                                                           0250 00416000
@EL00004 DS    0H                                                  0250 00417000
@EF00004 DS    0H                                                  0250 00418000
@ER00004 BR    @14                                                 0250 00419000
*ISSUTPUT:                                                         0251 00420000
*   PROC OPTIONS(NOSAVEAREA,NOSAVE);                               0251 00421000
*                                                                  0251 00422000
ISSUTPUT DS    0H                                                  0252 00423000
*   /*****************************************************************/ 00424000
*   /*                                                               */ 00425000
*   /* A CHECK IS MADE TO SEE IF THE TSO USER WANTS HIS WTP MESSAGES */ 00426000
*   /* PUT TO HIS TERMINAL. IF YES THEN THE TPUT MACRO IS ISSUED TO  */ 00427000
*   /* HIS TERMINAL. THE RC FROM TPUT IS PASSED BACK TO MAINLINE     */ 00428000
*   /* CODE. IF THE USER DOES NOT WANT HIS WTP MESSAGES, RETURN TO   */ 00429000
*   /* MAINLINE WITH A RC OF 4 IN REGISTER 15.                       */ 00430000
*   /*                                                               */ 00431000
*   /*****************************************************************/ 00432000
*                                                                  0252 00433000
*   IF PSCBPTR=0&UPTWTP='1'B THEN  /* DOES USER WANT HIS WTPS       */ 00434000
         L     @04,PSCBPTR(,JSCBADDR)                              0252 00435000
         LTR   @04,@04                                             0252 00436000
         BZ    @RF00252                                            0252 00437000
         L     @04,UPTPTR(,@04)                                    0252 00438000
         TM    UPTWTP(@04),B'00000001'                             0252 00439000
         BNO   @RF00252                                            0252 00440000
*     DO;                           /* YES, ISSUE TPUT               */ 00441000
*       REG1=ADDR(WPLTXT);          /* ADDRESS OF MSG IN REG1        */ 00442000
         LA    REG1,WPLTXT(,WPLPTR)                                0254 00443000
*       REG0=XVMSGLGH-4;            /* LENGTH OF MSG IN REG 0        */ 00444000
         LH    REG0,XVMSGLGH(,REG12)                               0255 00445000
         SH    REG0,@CH00090                                       0255 00446000
*       GEN(TPUT  (1),(0),R);       /* ISSUE TPUT TO TERMINAL        */ 00447000
         TPUT  (1),(0),R                                                00448000
*     END;                                                         0257 00449000
*   ELSE                                                           0258 00450000
*     REG15=4;                      /* PUT TO JOB'S MSG DATA SET     */ 00451000
         B     @RC00252                                            0258 00452000
@RF00252 LA    REG15,4                                             0258 00453000
*   END;                                                           0259 00454000
@EL00005 DS    0H                                                  0259 00455000
@EF00005 DS    0H                                                  0259 00456000
@ER00005 BR    @14                                                 0259 00457000
*CHECKJOB:                                                         0260 00458000
*   PROC OPTIONS(NOSAVEAREA,NOSAVE);                               0260 00459000
*                                                                  0260 00460000
CHECKJOB DS    0H                                                  0261 00461000
*   /*****************************************************************/ 00462000
*   /*                                                               */ 00463000
*   /* IF THIS IS THE FIRST TIME A WTP IS ISSUED BY THIS JOB STEP    */ 00464000
*   /* THEN THE JSCB MUST BE INITIALIZED. IF AN OLD STEP THAT HAS    */ 00465000
*   /* ISSUED PREVIOUS WTPS THEN RETURN TO MAINLINE CODE.            */ 00466000
*   /*                                                               */ 00467000
*   /*****************************************************************/ 00468000
*                                                                  0261 00469000
*   IF JSCBWTSP=JSCBSTEP THEN      /* JOB BEEN HERE BEFORE          */ 00470000
         CLC   JSCBWTSP(1,JSCBADDR),JSCBSTEP(JSCBADDR)             0261 00471000
         BE    @RF00261                                            0261 00472000
*     DO;                           /* NO, THEN INITIALIZE JSCB      */ 00473000
*       JSCBWTP=0;                  /* ZERO OUT SWITHCES             */ 00474000
         SLR   @04,@04                                             0263 00475000
         ST    @04,JSCBWTP(,JSCBADDR)                              0263 00476000
*       JSCBWTSP=JSCBSTEP;          /* MOVE STEP NUM INTO JSCB       */ 00477000
         MVC   JSCBWTSP(1,JSCBADDR),JSCBSTEP(JSCBADDR)             0264 00478000
*     END;                                                         0265 00479000
*   END;                                                           0266 00480000
@EL00006 DS    0H                                                  0266 00481000
@EF00006 DS    0H                                                  0266 00482000
@ER00006 BR    @14                                                 0266 00483000
*BUILDRPL:                                                         0267 00484000
*   PROC OPTIONS(NOSAVEAREA,NOSAVE);                               0267 00485000
*                                                                  0267 00486000
BUILDRPL DS    0H                                                  0268 00487000
*   /*****************************************************************/ 00488000
*   /*                                                               */ 00489000
*   /* THIS ROUTINE OBTAINS THE RPL ADDRESS FROM THE JSCB. THE       */ 00490000
*   /* REQUIRED FIELDS WITHIN THE RPL ARE INITIALIZED.               */ 00491000
*   /*                                                               */ 00492000
*   /*****************************************************************/ 00493000
*                                                                  0268 00494000
*   RESPECIFY                                                      0268 00495000
*     IFGRPL BASED(REG1);                                          0268 00496000
*   RESPECIFY                                                      0269 00497000
*     REG2 RESTRICTED;                                             0269 00498000
*   REG1=ADDR(WORKAREA);            /* GET PTR TO WORKAREA           */ 00499000
         LA    REG1,WORKAREA                                       0270 00500000
*   WORKAREA(1:132)=' ';            /* CLEAR OUT CORE FOR MSG        */ 00501000
         MVI   WORKAREA+1,C' '                                     0271 00502000
         MVC   WORKAREA+2(130),WORKAREA+1                          0271 00503000
         MVI   WORKAREA,C' '                                       0271 00504000
*   REG1->MESSAGE(1:REG2)=REG7->MESSAGE(1:REG2);/* MOVE MSG INTO   0272 00505000
*                                      BUFFER                        */ 00506000
         LR    @04,REG2                                            0272 00507000
         BCTR  @04,0                                               0272 00508000
         EX    @04,@SM02283                                        0272 00509000
*   REG7=REG1;                      /* GET PTR TO MESSAGE            */ 00510000
         LR    REG7,REG1                                           0273 00511000
*   REG1=JSCBSMLR;                  /* GET PTR TO RPL                */ 00512000
         L     REG1,JSCBSMLR(,JSCBADDR)                            0274 00513000
*   RPLAREA=REG7;                   /* MSG LOCATION INTO RPL         */ 00514000
         ST    REG7,RPLAREA(,REG1)                                 0275 00515000
*   RPLRLEN=REG2;                   /* MSG LENGTH INTO RPL           */ 00516000
         ST    REG2,RPLRLEN(,REG1)                                 0276 00517000
*   RPLREQ=RPLPUT;                  /* INDICATE PUT REQUEST          */ 00518000
         MVI   RPLREQ(REG1),X'01'                                  0277 00519000
*   RPLSEQ='1'B;                    /* PUT AFTER LAST MSG IN SYSTEM     00520000
*                                      MSG DATA SET                  */ 00521000
         OI    RPLSEQ(REG1),B'00100000'                            0278 00522000
*   RESPECIFY                                                      0279 00523000
*     REG2 UNRESTRICTED;                                           0279 00524000
*   RETURN;                                                        0280 00525000
@EL00007 DS    0H                                                  0280 00526000
@EF00007 DS    0H                                                  0280 00527000
@ER00007 BR    @14                                                 0280 00528000
*   END;                                                           0281 00529000
*CKRETURN:                                                         0282 00530000
*   PROC OPTIONS(NOSAVEAREA,NOSAVE);                               0282 00531000
*                                                                  0282 00532000
CKRETURN DS    0H                                                  0283 00533000
*   /*****************************************************************/ 00534000
*   /*                                                               */ 00535000
*   /* THIS ROUTINE CHECKS THE RETURN CODES FROM HASP. IF REG 15 IS  */ 00536000
*   /* NOT 0 THEN AN ERROR OCCURRED. REG 8 IS ZEROED TO TERMINATE ANY*/ 00537000
*   /* FURTHER PROCESSING OF MESSAGES AND THE ERROR MSG ID FIELD IS  */ 00538000
*   /* CHANGED TO 3 TO INDICATE A PUT ERROR IN THE WTO MSG.          */ 00539000
*   /*                                                               */ 00540000
*   /*****************************************************************/ 00541000
*                                                                  0283 00542000
*   IF REG15=0 THEN                /* IF PROBLEMS OCCURRED          */ 00543000
         LTR   REG15,REG15                                         0283 00544000
         BZ    @RF00283                                            0283 00545000
*     DO;                                                          0284 00546000
*       REG8=0;                     /* ZERO OUT REG8 TO TERMINATE DO    00547000
*                                      LOOP                          */ 00548000
         SLR   REG8,REG8                                           0285 00549000
*       MSGID='3';                  /* SET MSG ID TO INDICATE A PUT     00550000
*                                      FAILURE.                      */ 00551000
         MVI   MSGID,C'3'                                          0286 00552000
*     END;                                                         0287 00553000
*   RETURN;                                                        0288 00554000
@EL00008 DS    0H                                                  0288 00555000
@EF00008 DS    0H                                                  0288 00556000
@ER00008 BR    @14                                                 0288 00557000
*   END;                                                           0289 00558000
         B     @EL00008                                            0289 00559000
*ISSUEENQ:                                                         0290 00560000
*   PROC OPTIONS(NOSAVEAREA,NOSAVE);                               0290 00561000
*                                                                  0290 00562000
ISSUEENQ DS    0H                                                  0291 00563000
*   /*****************************************************************/ 00564000
*   /*                                                               */ 00565000
*   /* THIS ROUTINE CHECKS FOR A ZERO RPL POINTER. IF ZERO THE ENQ IS*/ 00566000
*   /* NOT ISSUED AND THE ERROR MSG ID IS SET TO 1 TO INDICATE A ZERO*/ 00567000
*   /* RPL POINTER ERROR IN THE WTO MESSAGE TO HARD COPY. IF AN RPL  */ 00568000
*   /* POINTER IS PRESENT THIS ROUTINE MOVES THE ENQUEUE PARM LIST   */ 00569000
*   /* INTO THIS MODULES WORKAREA. IT THEN BUILDS AN RNAME CONSISTING*/ 00570000
*   /* OF THE RPL POINTER (JSCBSMLR) AND THE AND THE ASCBASID.IT THEN*/ 00571000
*   /* ISSUES A UNCONDITIONAL ENQUEUE.                               */ 00572000
*   /*                                                               */ 00573000
*   /*****************************************************************/ 00574000
*                                                                  0291 00575000
*   REG1=ADDR(WORKAREA);            /* WORKAREA ADDR INTO REG1       */ 00576000
         LA    REG1,WORKAREA                                       0291 00577000
*   ENQAREA(1:LENENQ)=ENQLIST(1:LENENQ);/* MOVE ENQ LIST INTO WA     */ 00578000
         SLR   @04,@04                                             0292 00579000
         IC    @04,LENENQ                                          0292 00580000
         BCTR  @04,0                                               0292 00581000
         EX    @04,@SM02286                                        0292 00582000
*   IF JSCBSMLR=0 THEN             /* CK IF WE HAVE A RPL PTR       */ 00583000
         L     @04,JSCBSMLR(,JSCBADDR)                             0293 00584000
         LTR   @04,@04                                             0293 00585000
         BZ    @RF00293                                            0293 00586000
*     DO;                                                          0294 00587000
*       ENQRNAME(1:4)=JSCBSMLR;     /* BUILD RNAME WITH RPL PTR      */ 00588000
         ST    @04,@TF00001                                        0295 00589000
         MVC   ENQRNAME(4),@TF00001                                0295 00590000
*       ENQRNAME(5:6)=ASCBASID;     /* AND ASID FROM ASCB            */ 00591000
         MVC   ENQRNAME+4(2),ASCBASID(ASCBPTR)                     0296 00592000
*       RNAMEFLD=ADDR(ENQRNAME);    /* PUT RNAME ADDR INTO LIST      */ 00593000
         LA    @04,ENQRNAME                                        0297 00594000
         ST    @04,RNAMEFLD(,REG1)                                 0297 00595000
*       GEN(ENQ ,MF=(E,(1)));       /* ISSUE UNCONDITIONAL ENQ       */ 00596000
         ENQ ,MF=(E,(1))                                                00597000
*       REG15=0;                    /* SUCCESSFUL RETURN FROM ENQ    */ 00598000
         SLR   REG15,REG15                                         0299 00599000
*     END;                                                         0300 00600000
*   ELSE                                                           0301 00601000
*     DO;                           /* NO RPL PTR MEANS NO ENQ       */ 00602000
         B     @RC00293                                            0301 00603000
@RF00293 DS    0H                                                  0302 00604000
*       REG15=4;                    /* RC INDICATES ENQ WOULD FAIL   */ 00605000
         LA    REG15,4                                             0302 00606000
*       MSGID='1';                  /* INDICATES WHY ENQ FAILED      */ 00607000
         MVI   MSGID,C'1'                                          0303 00608000
*     END;                                                         0304 00609000
*   END;                                                           0305 00610000
@EL00009 DS    0H                                                  0305 00611000
@EF00009 DS    0H                                                  0305 00612000
@ER00009 BR    @14                                                 0305 00613000
*LOADREGS:                                                         0306 00614000
*   PROC OPTIONS(NOSAVEAREA,NOSAVE);                               0306 00615000
*                                                                  0306 00616000
LOADREGS DS    0H                                                  0307 00617000
*   /*****************************************************************/ 00618000
*   /*                                                               */ 00619000
*   /* THIS ROUTINE IS ENTERED ON THE STAE RETRY ONLY. IT RESTORES   */ 00620000
*   /* THE NECESSARY REGISTERS TO COMPLETE PROCESSING BEFORE         */ 00621000
*   /* RETURNING TO WTO.                                             */ 00622000
*   /*                                                               */ 00623000
*   /*****************************************************************/ 00624000
*                                                                  0307 00625000
*   RFY                                                            0307 00626000
*     REG9 RESTRICTED;                                             0307 00627000
*   REG6=REG1->REGWPL2;             /* RESTORE WPL POINTER           */ 00628000
         L     REG6,REGWPL2(,REG1)                                 0308 00629000
*   REG9=REG1->REGDATA2;            /* RESTORE DATA AREA POINTER     */ 00630000
         L     REG9,REGDATA2(,REG1)                                0309 00631000
*   REG10=REG1->REGUCM2;            /* RESTORE UCM POINTER           */ 00632000
         L     REG10,REGUCM2(,REG1)                                0310 00633000
*   REG12=REG1->REGXSA2;            /* RESTORE XSA POINTER           */ 00634000
         L     REG12,REGXSA2(,REG1)                                0311 00635000
*   REG13=REG1->REGSAVE2;           /* RESTORE SAVEAREA POINTER      */ 00636000
         L     REG13,REGSAVE2(,REG1)                               0312 00637000
*   RFY                                                            0313 00638000
*     REG9 UNRESTRICTED;                                           0313 00639000
*   END;                                                           0314 00640000
@EL00010 DS    0H                                                  0314 00641000
@EF00010 DS    0H                                                  0314 00642000
@ER00010 BR    @14                                                 0314 00643000
*BUILDMSG:                                                         0315 00644000
*   PROC OPTIONS(NOSAVEAREA,NOSAVE);                               0315 00645000
*                                                                  0315 00646000
BUILDMSG DS    0H                                                  0316 00647000
*   /*****************************************************************/ 00648000
*   /*                                                               */ 00649000
*   /* THIS ROUTINE GETS 53 BYTES OF THE MESSAGE THAT WAS PASSED TO  */ 00650000
*   /* WTP. THE MESSAGE WILL BE SCANNED FOR THE LAST FULL WORD AND   */ 00651000
*   /* THE LENGTH ADJUSTED TO THAT WORD. IF NO WORD IS FOUND THEN 55 */ 00652000
*   /* BYTES WILL BE THE LENGTH.                                     */ 00653000
*   /*                                                               */ 00654000
*   /*****************************************************************/ 00655000
*                                                                  0316 00656000
*   REG3=ADDR(WPLTXT);              /* GET ADDR OF MSG TEXT          */ 00657000
         LA    REG3,WPLTXT(,WPLPTR)                                0316 00658000
*   REG6=XVMSGLGH-4;                /* GET MSG LENGTH                */ 00659000
         LH    REG6,XVMSGLGH(,REG12)                               0317 00660000
         SH    REG6,@CH00090                                       0317 00661000
*   IF REG6>53 THEN                 /* DOES MSG EXCEED MAX LENGTH  0318 00662000
*                                      THAT WE CAN PUT OUT           */ 00663000
         LA    @04,53                                              0318 00664000
         CR    REG6,@04                                            0318 00665000
         BNH   @RF00318                                            0318 00666000
*     DO;                                                          0319 00667000
*       REG7=REG3+53;               /* POINT 64 BYTES INTO MSG       */ 00668000
         ALR   @04,REG3                                            0320 00669000
         LR    REG7,@04                                            0320 00670000
*       DO WHILE(REG7->MESSAGE(1)=' '&REG7=REG3);                0321 00671000
         B     @DE00321                                            0321 00672000
@DL00321 DS    0H                                                  0322 00673000
*         REG7=REG7-1;              /* START LOOKING FOR LAST FULL 0322 00674000
*                                      WORD OR BEGINNING OF BUFFER   */ 00675000
         BCTR  REG7,0                                              0322 00676000
*       END;                                                       0323 00677000
@DE00321 CLI   MESSAGE(REG7),C' '                                  0323 00678000
         BE    @DC00321                                            0323 00679000
         CR    REG7,REG3                                           0323 00680000
         BNE   @DL00321                                            0323 00681000
@DC00321 DS    0H                                                  0324 00682000
*       IF REG7=REG3 THEN           /* IF AT THE END OF THE BUFFER 0324 00683000
*                                      THEN ITS ONE BIG WORD         */ 00684000
         CR    REG7,REG3                                           0324 00685000
         BNE   @RF00324                                            0324 00686000
*         REG6=53;                  /* PUT MAX MSG LENGTH INTO REG8  */ 00687000
         LA    REG6,53                                             0325 00688000
*       ELSE                        /* IF NOT AT END OF THE BUFFER 0326 00689000
*                                      THEN LAST FULL WORD FOUND     */ 00690000
*         REG6=REG7-REG3;           /* CALCULATE LENGTH OF MSG       */ 00691000
         B     @RC00324                                            0326 00692000
@RF00324 LR    REG6,REG7                                           0326 00693000
         SLR   REG6,REG3                                           0326 00694000
*     END;                                                         0327 00695000
*   END;                                                           0328 00696000
@EL00011 DS    0H                                                  0328 00697000
@EF00011 DS    0H                                                  0328 00698000
@ER00011 BR    @14                                                 0328 00699000
*ISSUEMSG:                                                         0329 00700000
*   PROC OPTIONS(NOSAVEAREA,NOSAVE);                               0329 00701000
*                                                                  0329 00702000
ISSUEMSG DS    0H                                                  0330 00703000
*   /*****************************************************************/ 00704000
*   /*                                                               */ 00705000
*   /* THIS ROUTINE MOVES THE LIST FORM OF THE MSG TO WTP WORKAREA   */ 00706000
*   /* AND THEN MOVES IN THE 55 BYTES FROM THE MSG SENT TO WTP BEFORE*/ 00707000
*   /* THE ABEND OCCURRED. IT THEN ISSUES THE WTO.                   */ 00708000
*   /*                                                               */ 00709000
*   /*****************************************************************/ 00710000
*                                                                  0330 00711000
*   RESPECIFY                                                      0330 00712000
*     REG2 RESTRICTED;                                             0330 00713000
*   REG1=ADDR(WORKAREA);            /* GET WORKA ADDRESS INTO REG1   */ 00714000
         LA    REG1,WORKAREA                                       0331 00715000
*   MSG(1:LENG1)=MSG1(1:LENG1);     /* MOVE LIST FORM TO WA          */ 00716000
         SLR   @04,@04                                             0332 00717000
         IC    @04,LENG1                                           0332 00718000
         BCTR  @04,0                                               0332 00719000
         EX    @04,@SM02288                                        0332 00720000
*   LENGTH=REG6+MSGLENTH;           /* MOVE IN NEW LENGTH            */ 00721000
         LR    @04,REG6                                            0333 00722000
         MVC   @ZT00002+2(2),MSGLENTH                              0333 00723000
         AL    @04,@ZT00002                                        0333 00724000
         STH   @04,LENGTH(,REG1)                                   0333 00725000
*   MSGID2(1:REG6)=REG3->MESSAGE(1:REG6);/* MOVE IN MSG TO WA        */ 00726000
         LR    @04,REG6                                            0334 00727000
         BCTR  @04,0                                               0334 00728000
         EX    @04,@SM02290                                        0334 00729000
*   REG7=ADDR(MSGID2)+REG6;         /* GET ADDRES OF MSG END         */ 00730000
         LA    REG7,MSGID2(,REG1)                                  0335 00731000
         ALR   REG7,REG6                                           0335 00732000
*   REG7->MESSAGE=MSGDESC;          /* MOVE IN DESC AND ROUTE CODES  */ 00733000
         MVC   MESSAGE(4,REG7),MSGDESC                             0336 00734000
*   IF TCBTIO=0 THEN               /* DOES A TIOT EXIST?            */ 00735000
         L     @04,TCBPTR2                                         0337 00736000
         L     @04,TCBTIO(,@04)                                    0337 00737000
         LTR   @04,@04                                             0337 00738000
         BZ    @RF00337                                            0337 00739000
*     JOBNAME=TIOCNJOB;             /* YES,MOVE JOBNAME TO MSG       */ 00740000
         L     @04,TCBPTR2                                         0338 00741000
         L     @04,TIOTPTR(,@04)                                   0338 00742000
         MVC   JOBNAME(8,REG1),TIOCNJOB(@04)                       0338 00743000
*   IDENT=MSGID;                    /* INDICATE WHY MSG OCCURRED     */ 00744000
@RF00337 MVC   IDENT(1,REG1),MSGID                                 0339 00745000
*   GEN(WTO  MF=(E,(1)));           /* ISSUE WTO                     */ 00746000
         WTO  MF=(E,(1))                                                00747000
*   RESPECIFY                                                      0341 00748000
*     REG2 UNRESTRICTED;                                           0341 00749000
*   END;                                                           0342 00750000
@EL00012 DS    0H                                                  0342 00751000
@EF00012 DS    0H                                                  0342 00752000
@ER00012 BR    @14                                                 0342 00753000
*ISSUEDEQ:                                                         0343 00754000
*   PROC OPTIONS(NOSAVEAREA,NOSAVE);                               0343 00755000
*                                                                  0343 00756000
ISSUEDEQ DS    0H                                                  0344 00757000
*   /*****************************************************************/ 00758000
*   /*                                                               */ 00759000
*   /* THIS ROUTINE IS CALLED BY THE STAE EXIT ROUTINE TO DEQUEUE ANY*/ 00760000
*   /* RESOURCES THAT MAY HAVE BEEN ENQUEUED ON.                     */ 00761000
*   /*                                                               */ 00762000
*   /*****************************************************************/ 00763000
*                                                                  0344 00764000
*   REG1=ADDR(WORKAREA);            /* GET CORE FOR DEQ LIST         */ 00765000
         LA    REG1,WORKAREA                                       0344 00766000
*   WORKAREA(1:LENDEQ)=DEQLIST(1:LENDEQ);/* MOVE IN LIST FORM OF DEQ */ 00767000
         SLR   @04,@04                                             0345 00768000
         IC    @04,LENDEQ                                          0345 00769000
         BCTR  @04,0                                               0345 00770000
         EX    @04,@SM02292                                        0345 00771000
*   RNAMEFLD=ADDR(ENQRNAME);        /* GET ADDR OF RNAME INTO LIST   */ 00772000
         LA    @04,ENQRNAME                                        0346 00773000
         ST    @04,RNAMEFLD(,REG1)                                 0346 00774000
*   GEN(DEQ ,MF=(E,(1)));           /* ISSUE CONDITIONAL DEQ         */ 00775000
         DEQ ,MF=(E,(1))                                                00776000
*   END;                                                           0348 00777000
@EL00013 DS    0H                                                  0348 00778000
@EF00013 DS    0H                                                  0348 00779000
@ER00013 BR    @14                                                 0348 00780000
*CKMCSFLG:                                                         0349 00781000
*   PROC OPTIONS(NOSAVEAREA,NOSAVE);                               0349 00782000
*                                                                  0349 00783000
CKMCSFLG DS    0H                                                  0350 00784000
*   /*****************************************************************/ 00785000
*   /*                                                               */ 00786000
*   /* THIS SUB-ROUTINE CHECKS THE MCS FLAGS IN THE WPL. FLAGS       */ 00787000
*   /* WPLMCSFB,WPLMCSFD, AND WPLMCSFH ARE CHECKED. ADDITIONALLY THE */ 00788000
*   /* WTOR BIT IN CXSA (XVD2WTOR) IS                        @ZA25631*/ 00789000
*   /* CHECKED TO SEE IF THIS                                @ZA25631*/ 00790000
*   /* WPL IS FOR A WTOR.                                    @ZA25631*/ 00791000
*   /* IF ANY OF THESE ARE ON MORE PROCESSING IS TO BE DONE BY WTO.  */ 00792000
*   /* IF THESE FLAGS ARE NOT ON, A CHECK IS MADE TO SEE IF THIS WTP */ 00793000
*   /* SHOULD BE HARD COPIED. IF YES THEN WTO IS THUSLY INFORMED.    */ 00794000
*   /*                                                               */ 00795000
*   /*****************************************************************/ 00796000
*                                                                  0350 00797000
*   IF WPLMCSFB='1'B&WPLMCSFD='1'B&WPLMCSFH='1'B&XVD2WTOR='1'B THEN 00798000
         TM    WPLMCSFB(WPLPTR),B'01010001'                        0350 00799000
         BNZ   @RF00350                                            0350 00800000
         TM    XVD2WTOR(REG12),B'00000010'                         0350 00801000
         BO    @RF00350                                            0350 00802000
*                                   /*                       @ZA25631*/ 00803000
*     DO;                           /* IF ALL FLAGS ARE OFF THEN   0351 00804000
*                                      CHECK IF WTP ARE GOING TO HARD   00805000
*                                      COPY                          */ 00806000
*       IF UCMSYSG='1'B|UCMHCUCM=0 THEN/* CHECK IF HARD COPY EXIST  */ 00807000
         LR    @04,UCMBASPT                                        0352 00808000
         AL    @04,@CF02294                                        0352 00809000
         L     @04,UCMMCSPT(,@04)                                  0352 00810000
         TM    UCMSYSG(@04),B'00000010'                            0352 00811000
         BO    @RT00352                                            0352 00812000
         L     @04,UCMHCUCM(,@04)                                  0352 00813000
         LTR   @04,@04                                             0352 00814000
         BZ    @RF00352                                            0352 00815000
@RT00352 DS    0H                                                  0353 00816000
*         DO;                                                      0353 00817000
*           IF RTCODE11='1'B THEN   /* ARE WTP MSGS BEING HARD COPIED*/ 00818000
         LR    @04,UCMBASPT                                        0354 00819000
         AL    @04,@CF02294                                        0354 00820000
         L     @04,UCMMCSPT(,@04)                                  0354 00821000
         TM    RTCODE11(@04),B'00100000'                           0354 00822000
         BNO   @RF00354                                            0354 00823000
*             XVD0HDCY='1'B;        /* YES, THEN TELL WTO            */ 00824000
         OI    XVD0HDCY(REG12),B'00000001'                         0355 00825000
*           ELSE                                                   0356 00826000
*             XVD0USER='1'B;        /* NO FLAGS OR NO HARD TELL WTO     00827000
*                                      TO RETURN TO RETURN TO USER   */ 00828000
         B     @RC00354                                            0356 00829000
@RF00354 OI    XVD0USER(REG12),B'00000010'                         0356 00830000
*         END;                                                     0357 00831000
*       ELSE                                                       0358 00832000
*         XVD0USER='1'B;            /* OTHERWISE TELL WTO TO TO    0358 00833000
*                                      RETURN TO USER                */ 00834000
         B     @RC00352                                            0358 00835000
@RF00352 OI    XVD0USER(REG12),B'00000010'                         0358 00836000
*     END;                                                         0359 00837000
*   END;                                                           0360 00838000
@EL00014 DS    0H                                                  0360 00839000
@EF00014 DS    0H                                                  0360 00840000
@ER00014 BR    @14                                                 0360 00841000
*FINALCK:                                                          0361 00842000
*   PROC OPTIONS(NOSAVEAREA,NOSAVE);                               0361 00843000
*                                                                  0361 00844000
FINALCK  DS    0H                                                  0362 00845000
*   /*****************************************************************/ 00846000
*   /*                                                               */ 00847000
*   /* THIS SUB-ROUTINE CHECKS IF ANY CONSOLES RECEIVE ROUTE CODE 11 */ 00848000
*   /* MESSAGES, IF MCS FLAGS B,D,H, ARE ON OR IF ROUTE CODE 11      */ 00849000
*   /* MESSAGES ARE HARDCOPIED. IF ANY OF THE ABOVE CHECKS ARE       */ 00850000
*   /* POSITIVE WTO IS FLAGGED FOR ADDITIONAL PROCESSING. OTHERWISE  */ 00851000
*   /* WTO RETURNS TO CALLER                                         */ 00852000
*   /*                                                               */ 00853000
*   /*****************************************************************/ 00854000
*                                                                  0362 00855000
*   REG14SAV=REG14;                 /* SAVE MAINLINE RETURN ADDR     */ 00856000
         ST    REG14,REG14SAV                                      0362 00857000
*   CALL CKROUTCD;                  /* CK FOR OTHER ROUTE CODES ON 0363 00858000
*                                      MSG OR FOR CONSOLES THAT    0363 00859000
*                                      RECEIVE ROUTE CODE 11 MSGS    */ 00860000
         BAL   @14,CKROUTCD                                        0363 00861000
*   IF REG15=4 THEN                 /* IF NONE THEN CK WPL FLAGS     */ 00862000
         CH    REG15,@CH00090                                      0364 00863000
         BNE   @RF00364                                            0364 00864000
*     CALL CKMCSFLG;                /* GO CK MCS FLAGS AND HARDCOPY  */ 00865000
         BAL   @14,CKMCSFLG                                        0365 00866000
*   REG14=REG14SAV;                 /* RESTORE RETURN ADDR           */ 00867000
@RF00364 L     REG14,REG14SAV                                      0366 00868000
*   END;                                                           0367 00869000
@EL00015 DS    0H                                                  0367 00870000
@EF00015 DS    0H                                                  0367 00871000
@ER00015 BR    @14                                                 0367 00872000
*STAE000:                                                          0368 00873000
*   PROC OPTIONS(NOSAVEAREA,NOSAVE);                               0368 00874000
*                                                                  0368 00875000
STAE000  DS    0H                                                  0369 00876000
*   /*****************************************************************/ 00877000
*   /*                                                               */ 00878000
*   /* THIS IS THE STAE EXIT ROUTINE. IT RECEIVES CONTROL ONLY IF AN */ 00879000
*   /* ABEND SITUATION OCCURS.WHEN ENTERED IT RESTORES THIS MODULES  */ 00880000
*   /* BASE REGISTER, XSA POINTER AND DATA REG. 53 BYTES OF THE      */ 00881000
*   /* MESSAGE PASSED TO WTP ARE MOVED INTO A WTO AND ISSUED TO THE  */ 00882000
*   /* HARD COPY. IF REG0 IS EQUAL TO 0 THEN THE SETRP MACRO IS      */ 00883000
*   /* ISSUED WITH RETURN ADDR OF STAERETY. IF REG 0 IS NOT 0 THEN A */ 00884000
*   /* RC OF 4 IS PLACED INTO REG 15, THE RETRY ADDR INTO REG 0 AND A*/ 00885000
*   /* BR 14 TO STAE ISSUED.                                         */ 00886000
*   /*                                                               */ 00887000
*   /*****************************************************************/ 00888000
*                                                                  0369 00889000
*   RESPECIFY                                                      0369 00890000
*    (REG9,                                                        0369 00891000
*     REG2,                                                        0369 00892000
*     REG11) RESTRICTED;                                           0369 00893000
*   REG8=REG14;                     /* SAVE RETURN ADDRESS           */ 00894000
         LR    REG8,REG14                                          0370 00895000
*   REG11=12;                       /* NEED A 12 FOR COMPARE         */ 00896000
         LA    REG11,12                                            0371 00897000
*   GEN;                                                           0372 00898000
       DROP  REG11                       REMOVE REG 11 AS BASE REG      00899000
       USING STAE000,REG15               MAKE REG 15 BASE REG           00900000
       CR    REG0,REG11                  CK REG 0 FOR A 12 RC           00901000
       BE    NOSDWA                      IF 12 THEN REG 2 POINTS        00902000
*                                        TO MY PARAMETER LIST           00903000
       L     REG2,SDWAPARM(,SDWAPTR)     OTHERWISE MY PARM LIST PTR IS  00904000
*                                        IN THE SDWA                    00905000
       LR    REG5,REG1                   SAVE SDWA PTR                  00906000
       L     REG1,SDWAABCC(,SDWAPTR)     GET ABEND COMPLETION CODE      00907000
NOSDWA  EQU   *                                               @ZA19970  00908000
       SLL   REG1,8                      REMOVE HIGH ORDER GARBAGE      00909000
        SRL   REG1,20                    PUT ABEND CODE IN LOW BYTES    00910000
       DROP  REG15                       REMOVE REG15 AS BASE REG       00911000
       USING @PSTART,REG11               RESTORE REG11 AS BASE REG      00912000
*   REG10=REG0;                     /* SAVE STAE RETURN CODE IN 10   */ 00913000
         LR    REG10,REG0                                          0373 00914000
*   REG6=REG2->REGWPL2;             /* RESTORE WPL PTR               */ 00915000
         L     REG6,REGWPL2(,REG2)                                 0374 00916000
*   REG9=REG2->REGDATA2;            /* RESTORE DATA REG              */ 00917000
         L     REG9,REGDATA2(,REG2)                                0375 00918000
*   REG11=REG2->REGBASE2;           /* RESTORE BASE REG              */ 00919000
         L     REG11,REGBASE2(,REG2)                               0376 00920000
*   REG12=REG2->REGXSA2;            /* RESTORE XSA POINTER           */ 00921000
         L     REG12,REGXSA2(,REG2)                                0377 00922000
*   IF REG1=ABENDCDE THEN           /* DID ENQ ABEND                 */ 00923000
         MVC   @TF00001(4),ABENDCDE                                0378 00924000
         CL    REG1,@TF00001                                       0378 00925000
         BNE   @RF00378                                            0378 00926000
*     MSGID='2';                    /* YES, THEN INSERT IDENTIFIER 0379 00927000
*                                      INTO WTO MESSAGE              */ 00928000
         MVI   MSGID,C'2'                                          0379 00929000
*   CALL ISSUEDEQ;                  /* REMOVE POSSIBLE ENQ           */ 00930000
@RF00378 BAL   @14,ISSUEDEQ                                        0380 00931000
*   CALL BUILDMSG;                  /* SET UP TO ISSUE 53 BYTE ERROR    00932000
*                                      MSG                           */ 00933000
         BAL   @14,BUILDMSG                                        0381 00934000
*   CALL ISSUEMSG;                  /* ISSUE WTO FOR ERROR MSG       */ 00935000
         BAL   @14,ISSUEMSG                                        0382 00936000
*   REG1=REG5;                      /* RESTORE SDWA POINTER          */ 00937000
         LR    REG1,REG5                                           0383 00938000
*   REG5=ADDR(STAERETY);            /* GET RETRY ADDRESS             */ 00939000
         LA    REG5,STAERETY                                       0384 00940000
*   REG14=REG8;                     /* RESTORE RETURN ADDRESS        */ 00941000
         LR    REG14,REG8                                          0385 00942000
*   IF REG10=12 THEN                /* CHECK IF SDWA EXIST           */ 00943000
         CH    REG10,@CH00254                                      0386 00944000
         BNE   @RF00386                                            0386 00945000
*     DO;                           /* NO, THEN DO THE FOLLOWING     */ 00946000
*       REG15=4;                    /* TELL STAE TO RETRY            */ 00947000
         LA    REG15,4                                             0388 00948000
*       REG0=REG5;                  /* PUT RETRY ADDR INTO REG 0     */ 00949000
         LR    REG0,REG5                                           0389 00950000
*     END;                                                         0390 00951000
*   ELSE                                                           0391 00952000
*     DO;                           /* SDWA EXIST CONTINUE HERE      */ 00953000
         B     @RC00386                                            0391 00954000
@RF00386 DS    0H                                                  0392 00955000
*       SDWASR01=REG2;              /* SAVE MY PARM ADDR IN SDWA     */ 00956000
         ST    REG2,SDWASR01(,SDWAPTR)                             0392 00957000
*       DO;                         /* SETRP RECORD(YES)RETADDR(STAER   00958000
*                                      ETY)RECPARM(LRECINF)RC(4)RETRE   00959000
*                                      GS(YES)FRESDWA(YES)           */ 00960000
*         RESPECIFY                                                0394 00961000
*          (GPR00P,                                                0394 00962000
*           GPR01P,                                                0394 00963000
*           GPR14P,                                                0394 00964000
*           GPR15P) RSTD;                                          0394 00965000
*         GPR01P->SDWARCDE=4;       /* STORE RC INTO SDWA            */ 00966000
         MVI   SDWARCDE(GPR01P),X'04'                              0395 00967000
*         GPR01P->SDWARTYA=ADDR(STAERETY);/* SAVE RETRY ADDRESS      */ 00968000
         LA    @04,STAERETY                                        0396 00969000
         ST    @04,SDWARTYA(,GPR01P)                               0396 00970000
*         GPR01P->SDWAFREE='1'B;    /* SET FLAG TO FREE SDWA         */ 00971000
*         GPR01P->SDWARCRD='1'B;    /* TURN ON RECORD INDICATOR      */ 00972000
         OI    SDWAFREE(GPR01P),B'10000100'                        0398 00973000
*         GPR15P=ADDR(LRECINF);     /* ACCESS RECORD PARAMETER LIST  */ 00974000
         LA    GPR15P,LRECINF                                      0399 00975000
*         GPR01P->SDWARECP=GPR15P->I256C(1:24);/* COPY RECORD      0400 00976000
*                                      PARAMETERS                    */ 00977000
         MVC   SDWARECP(24,GPR01P),I256C(GPR15P)                   0400 00978000
*         GPR01P->SDWAUPRG='1'B;    /* TURN ON RETREGS INDICATOR     */ 00979000
         OI    SDWAUPRG(GPR01P),B'00001000'                        0401 00980000
*         RESPECIFY                                                0402 00981000
*          (GPR00P,                                                0402 00982000
*           GPR01P,                                                0402 00983000
*           GPR14P,                                                0402 00984000
*           GPR15P) UNRSTD;                                        0402 00985000
*       END;                                                       0403 00986000
*     END;                                                         0404 00987000
*   RETURN;                                                        0405 00988000
@EL00016 DS    0H                                                  0405 00989000
@EF00016 DS    0H                                                  0405 00990000
@ER00016 BR    @14                                                 0405 00991000
*   RESPECIFY                                                      0406 00992000
*    (REG2,                                                        0406 00993000
*     REG9) UNRESTRICTED;                                          0406 00994000
*   END;                                                           0407 00995000
         B     @EL00016                                            0407 00996000
*   GEN;                                                           0408 00997000
ENQLIST ENQ   (QN,RN,E,6,SYSTEM),MF=L                                   00998000
SIZEENQ EQU   *                                                         00999000
ELIST   ESTAE MF=L                                                      01000000
ELISTEND EQU   *                                                        01001000
ELISTLEN EQU   *-ELIST                                                  01002000
DEQLIST  DEQ  (QN,RN,6,SYSTEM),RET=HAVE,MF=L                            01003000
DEQEND   EQU  *                                                         01004000
LRECINF  EQU  *                                                         01005000
         DC   C'IGC0203E'                                               01006000
         DC   C'IGC0203E'                                               01007000
         DC   C'        '                                               01008000
*                                                                  0409 01009000
*   /*****************************************************************/ 01010000
*   /*                                                               */ 01011000
*   /* THIS IS THE MESSAGE SECTION OF THIS MODULE. THE MESSAGE PUT   */ 01012000
*   /* OUT BY THIS MODULE IS CONTAINED HERE AND NOT IN A SEPARATE    */ 01013000
*   /* CSECT. THE MESSAGE IS AN ERROR MESSAGE ISSUED WHEN THERE IS NO*/ 01014000
*   /* RPL POINTER, WHEN A RETURN CODE OF NON ZERO IS RETURNED FROM  */ 01015000
*   /* THE PUT, WHEN THE UNCONDITIONAL ENQUEUE FAILS OR WHEN AN      */ 01016000
*   /* UNPREDICATABLE ABEND OCCURS.                                  */ 01017000
*   /*                                                               */ 01018000
*   /*****************************************************************/ 01019000
*                                                                  0409 01020000
*   GEN;                                                           0409 01021000
MSG1    WTO   'IEF170I            ',MF=L,ROUTCDE=2,DESC=5,            **01022000
               MCSFLAG=(HRDCPY)                                         01023000
LENMSG  EQU   *                                                         01024000
*   DECLARE                         /* GENERAL PURPOSE REGISTERS     */ 01025000
*     GPR00P PTR(31) REG(0),                                       0410 01026000
*     GPR01P PTR(31) REG(1),                                       0410 01027000
*     GPR14P PTR(31) REG(14),                                      0410 01028000
*     GPR15P PTR(31) REG(15);                                      0410 01029000
*   DECLARE                         /* COMMON VARIABLES              */ 01030000
*     I256C CHAR(256) BASED,                                       0411 01031000
*     I031F FIXED(31) BASED,                                       0411 01032000
*     I031P PTR(31) BASED,                                         0411 01033000
*     I015F FIXED(15) BASED,                                       0411 01034000
*     I015P PTR(15) BASED,                                         0411 01035000
*     I008P PTR(8) BASED,                                          0411 01036000
*     I001C CHAR(1) BASED;                                         0411 01037000
*   END                                                            0412 01038000
*                                                                  0412 01039000
*/* THE FOLLOWING INCLUDE STATEMENTS WERE FOUND IN THIS PROGRAM.     */ 01040000
*/*%INCLUDE SYSLIB  (IHACTM  )                                       */ 01041000
*/*%INCLUDE SYSLIB  (IFGRPL  )                                       */ 01042000
*/*%INCLUDE SYSLIB  (IEECUCM )                                       */ 01043000
*/*%INCLUDE SYSLIB  (IEZWPL  )                                       */ 01044000
*/*%INCLUDE SYSLIB  (IEZJSCB )                                       */ 01045000
*/*%INCLUDE SYSLIB  (IKJTCB  )                                       */ 01046000
*/*%INCLUDE SYSLIB  (IHAASCB )                                       */ 01047000
*/*%INCLUDE SYSLIB  (IEFTIOT1)                                       */ 01048000
*/*%INCLUDE SYSLIB  (IHASDWA )                                       */ 01049000
*/*%INCLUDE SYSLIB  (IHARB   )                                       */ 01050000
*/*%INCLUDE SYSLIB  (IKJRB   )                                       */ 01051000
*/*%INCLUDE SYSLIB  (IKJUPT  )                                       */ 01052000
*/*%INCLUDE SYSLIB  (IKJPSCB )                                       */ 01053000
*                                                                  0412 01054000
*       ;                                                          0412 01055000
         B     @EL00001                                            0412 01056000
@DATA    DS    0H                                                       01057000
@CH00090 DC    H'4'                                                     01058000
@CH00254 DC    H'12'                                                    01059000
@CH00622 DC    H'126'                                                   01060000
@SM02281 MVC   STAELIST(0),ELIST                                        01061000
@SM02283 MVC   MESSAGE(0,REG1),MESSAGE(REG7)                            01062000
@SM02286 MVC   ENQAREA(0,REG1),ENQLIST                                  01063000
@SM02288 MVC   MSG(0,REG1),MSG1                                         01064000
@SM02290 MVC   MSGID2(0,REG1),MESSAGE(REG3)                             01065000
@SM02292 MVC   WORKAREA(0),DEQLIST                                      01066000
@DATD    DSECT                                                          01067000
         DS    0F                                                       01068000
@SA00001 DS    18F                                                      01069000
@TF00001 DS    F                                                        01070000
@ZTEMPS  DS    0F                                                       01071000
@ZT00002 DC    F'0'                                                     01072000
@ZTEMPND EQU   *                                                        01073000
@ZLEN    EQU   @ZTEMPND-@ZTEMPS                                         01074000
IGC0203E CSECT                                                          01075000
         DS    0F                                                       01076000
@CF02294 DC    F'-4'                                                    01077000
@DATD    DSECT                                                          01078000
         DS    0D                                                       01079000
UCMEXTPT DS    A                                                        01080000
UCMEILPT DS    A                                                        01081000
UCMUEWPT DS    A                                                        01082000
UCMFXPTR DS    A                                                        01083000
UCMPXPTR DS    A                                                        01084000
TCBPTR2  DS    A                                                        01085000
REG6SAVE DS    A                                                        01086000
REG14SAV DS    A                                                        01087000
STAEADDR DS    A                                                        01088000
WORKAREA DS    CL204                                                    01089000
         ORG   WORKAREA                                                 01090000
@NM00100 DS    CL132                                                    01091000
ENQRNAME DS    CL8                                                      01092000
MSGID    DS    CL1                                                      01093000
@NM00101 DS    CL3                                                      01094000
STAEPARM DS    CL60                                                     01095000
         ORG   STAEPARM                                                 01096000
REGWPL   DS    AL4                                                      01097000
REGDATA  DS    AL4                                                      01098000
REGUCM   DS    AL4                                                      01099000
REGBASE  DS    AL4                                                      01100000
REGXSA   DS    AL4                                                      01101000
REGSAVE  DS    AL4                                                      01102000
STAELIST DS    CL16                                                     01103000
@NM00102 DS    CL20                                                     01104000
         ORG   WORKAREA+204                                             01105000
         ORG   *+1-(*-@DATD)/(*-@DATD) INSURE DSECT DATA                01106000
@ENDDATD EQU   *                                                        01107000
IGC0203E CSECT                                                          01108000
         DS    0F                                                       01109000
@SIZDATD DC    AL1(231)                                                 01110000
         DC    AL3(@ENDDATD-@DATD)                                      01111000
         DS    0D                                                       01112000
SUBPOL   DC    XL4'FF000000'                                            01113000
LENDEQ   DC    AL1(DEQEND-DEQLIST)                                      01114000
LENG1    DC    AL1(LENMSG-MSG1)                                         01115000
LENENQ   DC    AL1(SIZEENQ-ENQLIST)                                     01116000
ESTAELEN DC    AL1(ELISTEND-ELIST)                                      01117000
@CB02223 DC    X'0020'                                                  01118000
QN       DC    CL8'SYSSJWTP'                                            01119000
ABENDCDE DC    X'00000138'                                              01120000
PATCH    DS    CL70                                                     01121000
RN       DS    CL1                                                      01122000
@00      EQU   00                      EQUATES FOR REGISTERS 0-15       01123000
@01      EQU   01                                                       01124000
@02      EQU   02                                                       01125000
@03      EQU   03                                                       01126000
@04      EQU   04                                                       01127000
@05      EQU   05                                                       01128000
@06      EQU   06                                                       01129000
@07      EQU   07                                                       01130000
@08      EQU   08                                                       01131000
@09      EQU   09                                                       01132000
@10      EQU   10                                                       01133000
@11      EQU   11                                                       01134000
@12      EQU   12                                                       01135000
@13      EQU   13                                                       01136000
@14      EQU   14                                                       01137000
@15      EQU   15                                                       01138000
UCMBASPT EQU   @10                                                      01139000
UCMDVEPT EQU   @07                                                      01140000
WPLPTR   EQU   @06                                                      01141000
TCBPTR   EQU   @04                                                      01142000
ASCBPTR  EQU   @07                                                      01143000
SDWAPTR  EQU   @01                                                      01144000
RBSECPTR EQU   @05                                                      01145000
REG0     EQU   @00                                                      01146000
REG1     EQU   @01                                                      01147000
REG2     EQU   @02                                                      01148000
REG3     EQU   @03                                                      01149000
REG4     EQU   @04                                                      01150000
JSCBADDR EQU   @05                                                      01151000
REG5     EQU   @05                                                      01152000
REG6     EQU   @06                                                      01153000
REG7     EQU   @07                                                      01154000
REG8     EQU   @08                                                      01155000
REG9     EQU   @09                                                      01156000
REG10    EQU   @10                                                      01157000
REG11    EQU   @11                                                      01158000
REG12    EQU   @12                                                      01159000
REG13    EQU   @13                                                      01160000
REG14    EQU   @14                                                      01161000
REG15    EQU   @15                                                      01162000
GPR00P   EQU   @00                                                      01163000
GPR01P   EQU   @01                                                      01164000
GPR14P   EQU   @14                                                      01165000
GPR15P   EQU   @15                                                      01166000
IFGRPL   EQU   0                                                        01167000
RPLCOMN  EQU   IFGRPL                                                   01168000
RPLIDWD  EQU   RPLCOMN                                                  01169000
RPLREQ   EQU   RPLIDWD+2                                                01170000
RPLLEN   EQU   RPLIDWD+3                                                01171000
RPLECB   EQU   RPLCOMN+8                                                01172000
RPLFDBWD EQU   RPLCOMN+12                                               01173000
RPLFDBK  EQU   RPLFDBWD+1                                               01174000
RPLRTNCD EQU   RPLFDBK                                                  01175000
RPLCNDCD EQU   RPLFDBK+1                                                01176000
RPLCMPON EQU   RPLCNDCD                                                 01177000
RPLFDB2  EQU   RPLCMPON                                                 01178000
RPLERRCD EQU   RPLCNDCD+1                                               01179000
RPLFDB3  EQU   RPLERRCD                                                 01180000
RPLKEYLE EQU   RPLCOMN+16                                               01181000
RPLAREA  EQU   RPLCOMN+32                                               01182000
RPLARG   EQU   RPLCOMN+36                                               01183000
RPLOPTCD EQU   RPLCOMN+40                                               01184000
RPLOPT1  EQU   RPLOPTCD                                                 01185000
RPLSEQ   EQU   RPLOPT1                                                  01186000
RPLECBSW EQU   RPLOPT1                                                  01187000
RPLOPT2  EQU   RPLOPTCD+1                                               01188000
RPLADR   EQU   RPLOPT2                                                  01189000
RPLOPT3  EQU   RPLOPTCD+2                                               01190000
RPLNXTRP EQU   RPLCOMN+44                                               01191000
RPLRLEN  EQU   RPLCOMN+48                                               01192000
RPLOPTC2 EQU   RPLCOMN+56                                               01193000
RPLOPT5  EQU   RPLOPTC2                                                 01194000
RPLWRTYP EQU   RPLOPT5                                                  01195000
RPLOPT6  EQU   RPLOPTC2+1                                               01196000
RPLUNTYP EQU   RPLOPT6                                                  01197000
RPLOPT7  EQU   RPLOPTC2+2                                               01198000
RPLCNOPT EQU   RPLOPT7                                                  01199000
RPLOPT8  EQU   RPLOPTC2+3                                               01200000
RPLRBAR  EQU   RPLCOMN+60                                               01201000
RPLAIXID EQU   RPLRBAR+2                                                01202000
RPLEXTDS EQU   RPLCOMN+68                                               01203000
RPLEXTD1 EQU   RPLEXTDS                                                 01204000
UCM2EXT  EQU   0                                                        01205000
UCM2STA  EQU   UCM2EXT+8                                                01206000
UCM2SFLG EQU   UCM2STA                                                  01207000
UCMPRFX  EQU   0                                                        01208000
UCMSAVE0 EQU   UCMPRFX+4                                                01209000
UCMSFLGS EQU   UCMPRFX+84                                               01210000
UCMSFLG1 EQU   UCMSFLGS                                                 01211000
UCMSYSG  EQU   UCMSFLG1                                                 01212000
UCMSFLG2 EQU   UCMSFLGS+1                                               01213000
UCMHCUCM EQU   UCMPRFX+92                                               01214000
UCMHRDRT EQU   UCMPRFX+100                                              01215000
UCMXSA   EQU   UCMPRFX+104                                              01216000
UCMSDS1  EQU   UCMPRFX+156                                              01217000
UCMPRFXP EQU   0                                                        01218000
UCM      EQU   0                                                        01219000
UCMDECB  EQU   UCM+12                                                   01220000
UCMRPYI  EQU   UCM+32                                                   01221000
UCMPXB   EQU   UCM+68                                                   01222000
UCMMODE  EQU   UCMPXB                                                   01223000
UCMVDATA EQU   UCM+72                                                   01224000
UCMVEA   EQU   UCMVDATA                                                 01225000
UCMVEZ   EQU   UCMVDATA+4                                               01226000
UCMVEL   EQU   UCMVDATA+8                                               01227000
UCMRSV42 EQU   UCM+300                                                  01228000
UCMRSV51 EQU   UCM+301                                                  01229000
UCMEIL   EQU   0                                                        01230000
UCMRECBA EQU   UCMEIL+24                                                01231000
UCMEXIT  EQU   0                                                        01232000
UCMLIST  EQU   0                                                        01233000
UCMSTS   EQU   UCMLIST+24                                               01234000
UCMATR   EQU   UCMLIST+25                                               01235000
UCMXA    EQU   UCMLIST+26                                               01236000
UCMRTCD  EQU   UCMLIST+32                                               01237000
UCMAUTH  EQU   UCMLIST+40                                               01238000
UCMAUTHA EQU   UCMAUTH                                                  01239000
UCMDISP  EQU   UCMLIST+42                                               01240000
UCMDISP1 EQU   UCMDISP                                                  01241000
UCMDISP2 EQU   UCMDISP+1                                                01242000
UCMMSG   EQU   UCMLIST+60                                               01243000
UCMMSG1  EQU   UCMMSG                                                   01244000
UCMDEVC  EQU   UCMLIST+63                                               01245000
UCMRCT   EQU   UCMLIST+68                                               01246000
UCMSDS5  EQU   UCMRCT                                                   01247000
UCMFEXTA EQU   0                                                        01248000
UCMFMGFS EQU   UCMFEXTA+8                                               01249000
UCMFFLG1 EQU   UCMFMGFS                                                 01250000
UCMPEXTA EQU   0                                                        01251000
UCMPDM1  EQU   UCMPEXTA+4                                               01252000
WPLRF    EQU   0                                                        01253000
WPLRPTR  EQU   WPLRF                                                    01254000
WPL      EQU   0                                                        01255000
WPLMCSF  EQU   WPL+2                                                    01256000
WPLMCSF1 EQU   WPLMCSF                                                  01257000
WPLMCSFB EQU   WPLMCSF1                                                 01258000
WPLMCSFD EQU   WPLMCSF1                                                 01259000
WPLMCSFH EQU   WPLMCSF1                                                 01260000
WPLMCSF2 EQU   WPLMCSF+1                                                01261000
WPLTXT   EQU   WPL+4                                                    01262000
WPLFLGS  EQU   0                                                        01263000
WPLDESC  EQU   WPLFLGS                                                  01264000
WPLDESC1 EQU   WPLDESC                                                  01265000
WPLDESC2 EQU   WPLDESC+1                                                01266000
WPLROUT  EQU   WPLFLGS+2                                                01267000
WPLROUT1 EQU   WPLROUT                                                  01268000
WPLROUT2 EQU   WPLROUT+1                                                01269000
WPLMSGTY EQU   WPLFLGS+4                                                01270000
WPLMSGT1 EQU   WPLMSGTY                                                 01271000
WPLMSGT2 EQU   WPLMSGTY+1                                               01272000
WPLLS01  EQU   0                                                        01273000
WPLLTF   EQU   WPLLS01                                                  01274000
WPLLTF1  EQU   WPLLTF                                                   01275000
WPLML    EQU   0                                                        01276000
WPLMLLTF EQU   WPLML+2                                                  01277000
WPLMLLT1 EQU   WPLMLLTF                                                 01278000
IEZJSCB  EQU   0                                                        01279000
JSCBSEC1 EQU   IEZJSCB+188                                              01280000
JSCHPCE  EQU   JSCBSEC1+4                                               01281000
JSCBDCB  EQU   JSCBSEC1+36                                              01282000
JSCBSTEP EQU   JSCBSEC1+40                                              01283000
JSCBOPTS EQU   JSCBSEC1+48                                              01284000
JSCBSWT1 EQU   JSCBSEC1+55                                              01285000
JSCBWTP  EQU   JSCBSEC1+64                                              01286000
JSCBWTFG EQU   JSCBWTP                                                  01287000
JSCBWTSP EQU   JSCBWTP+1                                                01288000
JSCBEND1 EQU   IEZJSCB+260                                              01289000
TCBFIX   EQU   0                                                        01290000
TCBFRS   EQU   TCBFIX                                                   01291000
TCB      EQU   0                                                        01292000
TCBPIE   EQU   TCB+4                                                    01293000
TCBPMASK EQU   TCBPIE                                                   01294000
TCBTIO   EQU   TCB+12                                                   01295000
TCBCMP   EQU   TCB+16                                                   01296000
TCBCMPF  EQU   TCBCMP                                                   01297000
TCBCPP   EQU   TCBCMPF                                                  01298000
TCBSTCC  EQU   TCBCMPF                                                  01299000
TCBCDBL  EQU   TCBCMPF                                                  01300000
TCBCWTO  EQU   TCBCMPF                                                  01301000
TCBCIND  EQU   TCBCMPF                                                  01302000
TCBCMSG  EQU   TCBCMPF                                                  01303000
TCBTRN   EQU   TCB+20                                                   01304000
TCBABF   EQU   TCBTRN                                                   01305000
TCBMSS   EQU   TCB+24                                                   01306000
TCBPKF   EQU   TCB+28                                                   01307000
TCBFLGS  EQU   TCB+29                                                   01308000
TCBFLGS1 EQU   TCBFLGS                                                  01309000
TCBFLGS2 EQU   TCBFLGS+1                                                01310000
TCBFLGS3 EQU   TCBFLGS+2                                                01311000
TCBFLGS4 EQU   TCBFLGS+3                                                01312000
TCBFLGS5 EQU   TCBFLGS+4                                                01313000
TCBABWF  EQU   TCBFLGS5                                                 01314000
TCBJPQ   EQU   TCB+44                                                   01315000
TCBPURGE EQU   TCBJPQ                                                   01316000
TCBGRS   EQU   TCB+48                                                   01317000
TCBFSA   EQU   TCB+112                                                  01318000
TCBTME   EQU   TCB+120                                                  01319000
TCBJSTCB EQU   TCB+124                                                  01320000
TCBTSFLG EQU   TCB+148                                                  01321000
TCBTSTSK EQU   TCBTSFLG                                                 01322000
TCBSTAB  EQU   TCB+160                                                  01323000
TCBNSTAE EQU   TCBSTAB                                                  01324000
TCBTCT   EQU   TCB+164                                                  01325000
TCBTCTGF EQU   TCBTCT                                                   01326000
TCBSCNDY EQU   TCB+172                                                  01327000
TCBNDSP  EQU   TCBSCNDY                                                 01328000
TCBNDSP1 EQU   TCBNDSP+1                                                01329000
TCBNDSP2 EQU   TCBNDSP+2                                                01330000
TCBNDSP3 EQU   TCBNDSP+3                                                01331000
TCBJSCB  EQU   TCB+180                                                  01332000
TCBRECDE EQU   TCBJSCB                                                  01333000
TCBJSCBB EQU   TCBJSCB+1                                                01334000
TCBEXT1  EQU   TCB+196                                                  01335000
TCBBITS  EQU   TCB+200                                                  01336000
TCBNDSP4 EQU   TCBBITS                                                  01337000
TCBNDSP5 EQU   TCBBITS+1                                                01338000
TCBFLGS6 EQU   TCBBITS+2                                                01339000
TCBFLGS7 EQU   TCBBITS+3                                                01340000
TCBDAR   EQU   TCB+204                                                  01341000
TCBDARC  EQU   TCBDAR                                                   01342000
TCBEXT2  EQU   TCB+208                                                  01343000
TCBFOE   EQU   TCB+244                                                  01344000
TCBESTAE EQU   TCB+264                                                  01345000
TCBESTRM EQU   TCBESTAE+1                                               01346000
TCBFBYT1 EQU   TCB+276                                                  01347000
TCBFBYT2 EQU   TCB+277                                                  01348000
TCBRV124 EQU   TCB+278                                                  01349000
TCBRV133 EQU   TCB+279                                                  01350000
TCBXTNT2 EQU   0                                                        01351000
TCBGTF   EQU   TCBXTNT2                                                 01352000
TCBTFLG  EQU   TCBGTF                                                   01353000
TCBRV146 EQU   TCBXTNT2+28                                              01354000
TCBRV155 EQU   TCBXTNT2+29                                              01355000
TCBRV164 EQU   TCBXTNT2+30                                              01356000
TCBRV173 EQU   TCBXTNT2+31                                              01357000
ASCB     EQU   0                                                        01358000
ASCBASID EQU   ASCB+36                                                  01359000
ASCBTSB  EQU   ASCB+60                                                  01360000
ASCBFW1  EQU   ASCB+100                                                 01361000
ASCBRCTF EQU   ASCBFW1+2                                                01362000
ASCBFLG1 EQU   ASCBFW1+3                                                01363000
ASCBDSP1 EQU   ASCB+114                                                 01364000
ASCBFLG2 EQU   ASCB+115                                                 01365000
TIOT1    EQU   0                                                        01366000
TIOCNJOB EQU   TIOT1                                                    01367000
SDWA     EQU   0                                                        01368000
SDWAFIOB EQU   SDWA+4                                                   01369000
SDWAABCC EQU   SDWAFIOB                                                 01370000
SDWACMPF EQU   SDWAABCC                                                 01371000
SDWACTL1 EQU   SDWA+8                                                   01372000
SDWACMKA EQU   SDWACTL1                                                 01373000
SDWAMWPA EQU   SDWACTL1+1                                               01374000
SDWAPMKA EQU   SDWACTL1+4                                               01375000
SDWACTL2 EQU   SDWA+16                                                  01376000
SDWACMKP EQU   SDWACTL2                                                 01377000
SDWAMWPP EQU   SDWACTL2+1                                               01378000
SDWAPMKP EQU   SDWACTL2+4                                               01379000
SDWAGRSV EQU   SDWA+24                                                  01380000
SDWANAME EQU   SDWA+88                                                  01381000
SDWAEC1  EQU   SDWA+104                                                 01382000
SDWAEMK1 EQU   SDWAEC1                                                  01383000
SDWAMWP1 EQU   SDWAEC1+1                                                01384000
SDWAINT1 EQU   SDWAEC1+2                                                01385000
SDWANXT1 EQU   SDWAEC1+4                                                01386000
SDWAAEC1 EQU   SDWA+112                                                 01387000
SDWAILC1 EQU   SDWAAEC1+1                                               01388000
SDWAINC1 EQU   SDWAAEC1+2                                               01389000
SDWAICD1 EQU   SDWAINC1+1                                               01390000
SDWAEC2  EQU   SDWA+120                                                 01391000
SDWAEMK2 EQU   SDWAEC2                                                  01392000
SDWAMWP2 EQU   SDWAEC2+1                                                01393000
SDWAINT2 EQU   SDWAEC2+2                                                01394000
SDWANXT2 EQU   SDWAEC2+4                                                01395000
SDWAAEC2 EQU   SDWA+128                                                 01396000
SDWAILC2 EQU   SDWAAEC2+1                                               01397000
SDWAINC2 EQU   SDWAAEC2+2                                               01398000
SDWAICD2 EQU   SDWAINC2+1                                               01399000
SDWASRSV EQU   SDWA+136                                                 01400000
SDWASR01 EQU   SDWASRSV+4                                               01401000
SDWAIDNT EQU   SDWA+200                                                 01402000
SDWAMCH  EQU   SDWA+204                                                 01403000
SDWASTCK EQU   SDWAMCH                                                  01404000
SDWAMCHI EQU   SDWAMCH+8                                                01405000
SDWAMCHS EQU   SDWAMCHI                                                 01406000
SDWAMCHD EQU   SDWAMCHI+1                                               01407000
SDWARSR1 EQU   SDWAMCH+12                                               01408000
SDWARSR2 EQU   SDWAMCH+13                                               01409000
SDWAFLGS EQU   SDWA+232                                                 01410000
SDWAERRA EQU   SDWAFLGS                                                 01411000
SDWAERRB EQU   SDWAFLGS+1                                               01412000
SDWAERRC EQU   SDWAFLGS+2                                               01413000
SDWAERRD EQU   SDWAFLGS+3                                               01414000
SDWAIOFS EQU   SDWA+238                                                 01415000
SDWARTYA EQU   SDWA+240                                                 01416000
SDWACPUA EQU   SDWA+248                                                 01417000
SDWAPARQ EQU   SDWA+252                                                 01418000
SDWARCDE EQU   SDWAPARQ                                                 01419000
SDWAACF2 EQU   SDWAPARQ+1                                               01420000
SDWARCRD EQU   SDWAACF2                                                 01421000
SDWAUPRG EQU   SDWAACF2                                                 01422000
SDWAFREE EQU   SDWAACF2                                                 01423000
SDWAACF3 EQU   SDWAPARQ+2                                               01424000
SDWAACF4 EQU   SDWAPARQ+3                                               01425000
SDWALKWA EQU   SDWA+256                                                 01426000
SDWALKWS EQU   SDWALKWA                                                 01427000
SDWARECP EQU   SDWA+292                                                 01428000
SDWASNPA EQU   SDWA+320                                                 01429000
SDWADUMP EQU   SDWASNPA                                                 01430000
SDWADPFS EQU   SDWADUMP+1                                               01431000
SDWADDAT EQU   SDWASNPA+4                                               01432000
SDWASDAT EQU   SDWADDAT                                                 01433000
SDWAPDAT EQU   SDWADDAT+2                                               01434000
SDWADPSA EQU   SDWA+328                                                 01435000
SDWADPSL EQU   SDWADPSA                                                 01436000
SDWARA   EQU   SDWA+400                                                 01437000
SDWADPVA EQU   SDWARA+2                                                 01438000
RBPRFX   EQU   0                                                        01439000
RBBASIC  EQU   0                                                        01440000
RBEXRTNM EQU   RBBASIC                                                  01441000
RBTMFLD  EQU   RBEXRTNM                                                 01442000
RBSTAB   EQU   RBBASIC+10                                               01443000
XSTAB    EQU   RBSTAB                                                   01444000
RBSTAB1  EQU   XSTAB                                                    01445000
XSTAB1   EQU   RBSTAB1                                                  01446000
RBFTCKPT EQU   XSTAB1                                                   01447000
RBSTAB2  EQU   XSTAB+1                                                  01448000
XSTAB2   EQU   RBSTAB2                                                  01449000
RBTCBNXT EQU   XSTAB2                                                   01450000
RBFACTV  EQU   XSTAB2                                                   01451000
RBFDYN   EQU   XSTAB2                                                   01452000
RBECBWT  EQU   XSTAB2                                                   01453000
RBOPSW   EQU   RBBASIC+16                                               01454000
XRBPSW   EQU   RBOPSW                                                   01455000
RBOPSWB2 EQU   XRBPSW+1                                                 01456000
RBLINK   EQU   RBBASIC+28                                               01457000
XRBLNK   EQU   RBLINK                                                   01458000
RBWCF    EQU   XRBLNK                                                   01459000
RBLINKB  EQU   XRBLNK+1                                                 01460000
RBGRSAVE EQU   RBBASIC+32                                               01461000
XRBREG   EQU   RBGRSAVE                                                 01462000
RBGRS0   EQU   XRBREG                                                   01463000
RBGRS1   EQU   XRBREG+4                                                 01464000
RBGRS2   EQU   XRBREG+8                                                 01465000
RBGRS3   EQU   XRBREG+12                                                01466000
RBGRS4   EQU   XRBREG+16                                                01467000
RBGRS5   EQU   XRBREG+20                                                01468000
RBGRS6   EQU   XRBREG+24                                                01469000
RBGRS7   EQU   XRBREG+28                                                01470000
RBGRS8   EQU   XRBREG+32                                                01471000
RBGRS9   EQU   XRBREG+36                                                01472000
RBGRS10  EQU   XRBREG+40                                                01473000
RBGRS11  EQU   XRBREG+44                                                01474000
RBGRS12  EQU   XRBREG+48                                                01475000
RBGRS13  EQU   XRBREG+52                                                01476000
RBGRS14  EQU   XRBREG+56                                                01477000
RBGRS15  EQU   XRBREG+60                                                01478000
XRBESA   EQU   RBBASIC+96                                               01479000
RBEXSAVE EQU   XRBESA                                                   01480000
RBPREFIX EQU   0                                                        01481000
RBRSV019 EQU   RBPREFIX+14                                              01482000
RBRSV028 EQU   RBPREFIX+15                                              01483000
RBRSV041 EQU   RBPREFIX+27                                              01484000
RBRSV054 EQU   RBPREFIX+39                                              01485000
RBRTOPSW EQU   RBPREFIX+40                                              01486000
RBRTPSW2 EQU   RBRTOPSW+8                                               01487000
RBRTICIL EQU   RBRTPSW2                                                 01488000
RBFLAGS1 EQU   RBPREFIX+56                                              01489000
RBINTCDA EQU   RBPREFIX+61                                              01490000
RBSECT   EQU   0                                                        01491000
RBPPSAV  EQU   RBSECT                                                   01492000
@NM00078 EQU   RBSECT+10                                                01493000
@NM00079 EQU   @NM00078                                                 01494000
RBTRSVRB EQU   @NM00079                                                 01495000
@NM00081 EQU   @NM00078+1                                               01496000
RBETXR   EQU   @NM00081                                                 01497000
RBEP     EQU   RBSECT+12                                                01498000
RBPGMQ   EQU   RBSECT+24                                                01499000
@NM00088 EQU   RBSECT+28                                                01500000
IRBEND   EQU   RBSECT+96                                                01501000
@NM00092 EQU   RBSECT+96                                                01502000
RBRSV138 EQU   @NM00092+7                                               01503000
RBRSV150 EQU   RBSECT+167                                               01504000
UPT      EQU   0                                                        01505000
UPTSWS   EQU   UPT+12                                                   01506000
UPTWTP   EQU   UPTSWS                                                   01507000
PSCB     EQU   0                                                        01508000
PSCBATR1 EQU   PSCB+16                                                  01509000
PSCBUPT  EQU   PSCB+52                                                  01510000
MESSAGE  EQU   0                                                        01511000
MSG      EQU   0                                                        01512000
LENGTH   EQU   MSG                                                      01513000
MSGINFO  EQU   MSG+4                                                    01514000
IDENT    EQU   MSGINFO+8                                                01515000
JOBNAME  EQU   MSGINFO+10                                               01516000
MSGID2   EQU   MSGINFO+19                                               01517000
ENQAREA  EQU   0                                                        01518000
RNAMEFLD EQU   ENQAREA+8                                                01519000
EXITPARM EQU   0                                                        01520000
REGWPL2  EQU   EXITPARM                                                 01521000
REGDATA2 EQU   EXITPARM+4                                               01522000
REGUCM2  EQU   EXITPARM+8                                               01523000
REGBASE2 EQU   EXITPARM+12                                              01524000
REGXSA2  EQU   EXITPARM+16                                              01525000
REGSAVE2 EQU   EXITPARM+20                                              01526000
I256C    EQU   0                                                        01527000
CODA     EQU   0                                                        01528000
I001C    EQU   0                                                        01529000
I008P    EQU   0                                                        01530000
I015F    EQU   0                                                        01531000
I015P    EQU   0                                                        01532000
I031F    EQU   0                                                        01533000
I031P    EQU   0                                                        01534000
UCM2PTR  EQU   0                                                        01535000
XVSAV    EQU   RBEXSAVE                                                 01536000
XVRDMSV  EQU   XVSAV+12                                                 01537000
XVRCSAVE EQU   XVRDMSV+2                                                01538000
XVMSGLGH EQU   XVSAV+18                                                 01539000
XVDFLAGS EQU   XVSAV+28                                                 01540000
XVD0     EQU   XVDFLAGS                                                 01541000
XVD0USER EQU   XVD0                                                     01542000
XVD0HDCY EQU   XVD0                                                     01543000
XVD1     EQU   XVDFLAGS+1                                               01544000
XVD2     EQU   XVDFLAGS+2                                               01545000
XVD2WTOR EQU   XVD2                                                     01546000
XVOREAD  EQU   XVSAV+32                                                 01547000
XVWWB    EQU   XVSAV+36                                                 01548000
XVWQEID  EQU   XVSAV+40                                                 01549000
XVRET    EQU   XVSAV+44                                                 01550000
UCMMCSPT EQU   UCMPRFXP                                                 01551000
UCMIECBA EQU   UCMRECBA+4                                               01552000
JSCBSEC2 EQU   JSCBEND1                                                 01553000
JSCBSEC3 EQU   JSCBEND1                                                 01554000
JSCBJCT  EQU   JSCBSEC3                                                 01555000
JSCBJCTA EQU   JSCBJCT+1                                                01556000
JSCBPSCB EQU   JSCBSEC3+4                                               01557000
JSCBASID EQU   JSCBSEC3+8                                               01558000
JSCBFBYT EQU   JSCBSEC3+10                                              01559000
JSCBJNL  EQU   JSCBSEC3+28                                              01560000
JSCBJJSB EQU   JSCBJNL                                                  01561000
JSCBSMLR EQU   JSCBSEC3+36                                              01562000
JSCBSUB  EQU   JSCBSEC3+40                                              01563000
JSCSCT   EQU   JSCBSEC3+68                                              01564000
JSCBACT  EQU   JSCBSEC3+88                                              01565000
JSCRSV45 EQU   JSCBSEC3+112                                             01566000
JSCRSV46 EQU   JSCRSV45                                                 01567000
JSCRSV47 EQU   JSCRSV45+2                                               01568000
TIOTPTR  EQU   TCBTIO                                                   01569000
TIOENTRY EQU   TIOT1+24                                                 01570000
TIOESTTA EQU   TIOENTRY+1                                               01571000
TIOERLOC EQU   TIOENTRY+2                                               01572000
TIOELINK EQU   TIOERLOC+1                                               01573000
TIOESYOT EQU   TIOELINK                                                 01574000
TIOESTTC EQU   TIOENTRY+15                                              01575000
TIOESTTB EQU   TIOENTRY+16                                              01576000
POOLSTAR EQU   TIOENTRY+20                                              01577000
TIOEDEVE EQU   TIOESTTB                                                 01578000
TIOSTTB  EQU   TIOEDEVE                                                 01579000
RBSECS03 EQU   RBEP                                                     01580000
RBCDE    EQU   RBSECS03                                                 01581000
RBCDFLGS EQU   RBCDE                                                    01582000
RBSECS05 EQU   RBPGMQ                                                   01583000
RBSQE    EQU   RBSECS05                                                 01584000
RBSECS06 EQU   RBPGMQ                                                   01585000
RBIQE    EQU   RBSECS06                                                 01586000
RBSECS07 EQU   RBPGMQ                                                   01587000
RBIQE2   EQU   RBSECS07                                                 01588000
RBSECS08 EQU   IRBEND                                                   01589000
RBSECS09 EQU   IRBEND                                                   01590000
UPTPTR   EQU   PSCBUPT                                                  01591000
PSCBPTR  EQU   JSCBPSCB                                                 01592000
ABENDMSG EQU   MSG1                                                     01593000
MSGLENTH EQU   ABENDMSG                                                 01594000
MSGDESC  EQU   ABENDMSG+23                                              01595000
MSGROUTE EQU   UCMRTCD                                                  01596000
WTPROUTE EQU   MSGROUTE+1                                               01597000
HDCYROUT EQU   UCMHRDRT                                                 01598000
RTCODE11 EQU   HDCYROUT+1                                               01599000
*                                      START UNREFERENCED COMPONENTS    01600000
OTHERCDE EQU   HDCYROUT                                                 01601000
RC1TO10  EQU   MSGROUTE                                                 01602000
MSGIDENT EQU   ABENDMSG+4                                               01603000
MSGFLAGS EQU   ABENDMSG+2                                               01604000
RBRSV161 EQU   RBSECS09+64                                              01605000
RBSIRBWA EQU   RBSECS09                                                 01606000
RBIQEWRK EQU   RBSECS08+4                                               01607000
RBNEXAV  EQU   RBSECS08                                                 01608000
RBIQEA   EQU   RBIQE2                                                   01609000
RBIQE1   EQU   RBIQE+1                                                  01610000
RBUSE    EQU   RBIQE                                                    01611000
RBSQEA   EQU   RBSQE+1                                                  01612000
@NM00093 EQU   RBSQE                                                    01613000
RBCDE1   EQU   RBCDE+1                                                  01614000
RBCDLOAD EQU   RBCDFLGS                                                 01615000
RBCDXCTL EQU   RBCDFLGS                                                 01616000
RBCDSYNC EQU   RBCDFLGS                                                 01617000
RBCDNODE EQU   RBCDFLGS                                                 01618000
RBRSV010 EQU   RBCDFLGS                                                 01619000
RBCDATCH EQU   RBCDFLGS                                                 01620000
RBRSV009 EQU   RBCDFLGS                                                 01621000
RBNOCELL EQU   RBCDFLGS                                                 01622000
TIOUCBP  EQU   TIOEDEVE+1                                               01623000
TIOVERF  EQU   TIOSTTB                                                  01624000
TIOUNLD  EQU   TIOSTTB                                                  01625000
TIOMNTD  EQU   TIOSTTB                                                  01626000
TIOSETU  EQU   TIOSTTB                                                  01627000
TIOVLSR  EQU   TIOSTTB                                                  01628000
TIOPVIO  EQU   TIOSTTB                                                  01629000
TIOREQD  EQU   TIOSTTB                                                  01630000
TIOUSED  EQU   TIOSTTB                                                  01631000
TIOTFEND EQU   POOLSTAR+16                                              01632000
TIOPSLOT EQU   POOLSTAR+13                                              01633000
TIOPSTTB EQU   POOLSTAR+12                                              01634000
TIOPPOOL EQU   POOLSTAR+4                                               01635000
TIOPNSRT EQU   POOLSTAR+3                                               01636000
@NM00018 EQU   POOLSTAR+2                                               01637000
TIOPNSLT EQU   POOLSTAR+1                                               01638000
@NM00017 EQU   POOLSTAR                                                 01639000
TIOEFSRT EQU   TIOENTRY+17                                              01640000
TIOSVERF EQU   TIOESTTB                                                 01641000
TIOSUNLD EQU   TIOESTTB                                                 01642000
TIOSMNTD EQU   TIOESTTB                                                 01643000
TIOSSETU EQU   TIOESTTB                                                 01644000
TIOSVLSR EQU   TIOESTTB                                                 01645000
TIOSPVIO EQU   TIOESTTB                                                 01646000
TIOSREQD EQU   TIOESTTB                                                 01647000
TIOSUSED EQU   TIOESTTB                                                 01648000
TIOSBALS EQU   TIOESTTC                                                 01649000
TIOSBALP EQU   TIOESTTC                                                 01650000
TIOSVOLS EQU   TIOESTTC                                                 01651000
TIOSVOLP EQU   TIOESTTC                                                 01652000
TIOSAFFS EQU   TIOESTTC                                                 01653000
TIOSAFFP EQU   TIOESTTC                                                 01654000
TIOSDEFR EQU   TIOESTTC                                                 01655000
TIOSDKCR EQU   TIOESTTC                                                 01656000
TIOEJFCB EQU   TIOENTRY+12                                              01657000
TIOEDDNM EQU   TIOENTRY+4                                               01658000
TIOTREM  EQU   TIOELINK                                                 01659000
TIOESSDS EQU   TIOESYOT                                                 01660000
TIOESYIN EQU   TIOELINK                                                 01661000
TIOEQNAM EQU   TIOELINK                                                 01662000
TIOEDYNM EQU   TIOELINK                                                 01663000
TIOTTERM EQU   TIOELINK                                                 01664000
TIOTRV01 EQU   TIOELINK                                                 01665000
TIOSYOUT EQU   TIOELINK                                                 01666000
TIOEWTCT EQU   TIOERLOC                                                 01667000
TIOSDSP2 EQU   TIOESTTA                                                 01668000
TIOSDSP1 EQU   TIOESTTA                                                 01669000
TIOSLABL EQU   TIOESTTA                                                 01670000
TIOSDADS EQU   TIOESTTA                                                 01671000
TIOSJBLB EQU   TIOESTTA                                                 01672000
TIOSPLTS EQU   TIOESTTA                                                 01673000
TIOSPLTP EQU   TIOESTTA                                                 01674000
TIOSLTYP EQU   TIOESTTA                                                 01675000
TIOELNGH EQU   TIOENTRY                                                 01676000
JSCBEND3 EQU   JSCBSEC3+120                                             01677000
JSCRSV52 EQU   JSCBSEC3+116                                             01678000
JSCRSV51 EQU   JSCRSV47+1                                               01679000
JSCRSV50 EQU   JSCRSV47                                                 01680000
JSCRSV49 EQU   JSCRSV46+1                                               01681000
JSCRSV48 EQU   JSCRSV46                                                 01682000
JSCRSV44 EQU   JSCBSEC3+108                                             01683000
JSCRSV43 EQU   JSCBSEC3+104                                             01684000
JSCRSV42 EQU   JSCBSEC3+100                                             01685000
JSCBASWA EQU   JSCBSEC3+96                                              01686000
JSCBUFPT EQU   JSCBSEC3+92                                              01687000
JSCBSWSP EQU   JSCBSEC3+87                                              01688000
JSCRSV33 EQU   JSCBSEC3+86                                              01689000
JSCDDNUM EQU   JSCBSEC3+84                                              01690000
JSCRSV53 EQU   JSCBSEC3+82                                              01691000
JSCDDNNO EQU   JSCBSEC3+80                                              01692000
JSCBVATA EQU   JSCBSEC3+76                                              01693000
JSCTMCOR EQU   JSCBSEC3+72                                              01694000
JSCSCTP  EQU   JSCSCT+1                                                 01695000
JSCRSV55 EQU   JSCSCT                                                   01696000
JSCRSV54 EQU   JSCBSEC3+64                                              01697000
JSCDSABQ EQU   JSCBSEC3+60                                              01698000
JSCBSSIB EQU   JSCBSEC3+56                                              01699000
JSCBFRBA EQU   JSCBSEC3+48                                              01700000
JSCRSV28 EQU   JSCBSEC3+46                                              01701000
JSCBSONO EQU   JSCBSEC3+44                                              01702000
JSCBSUBA EQU   JSCBSUB+1                                                01703000
JSCRSV31 EQU   JSCBSUB                                                  01704000
JSCBJNLR EQU   JSCBSEC3+32                                              01705000
JSCBJNLA EQU   JSCBJNL+1                                                01706000
JSCBJSBT EQU   JSCBJJSB                                                 01707000
JSCBJSBX EQU   JSCBJJSB                                                 01708000
JSCBJSBA EQU   JSCBJJSB                                                 01709000
JSCBJSBI EQU   JSCBJJSB                                                 01710000
@NM00012 EQU   JSCBJJSB                                                 01711000
JSCBJNLE EQU   JSCBJJSB                                                 01712000
JSCBJNLF EQU   JSCBJJSB                                                 01713000
JSCBJNLN EQU   JSCBJJSB                                                 01714000
@NM00011 EQU   JSCBSEC3+24                                              01715000
JSCBJRBA EQU   JSCBSEC3+16                                              01716000
JSCBIECB EQU   JSCBSEC3+12                                              01717000
JSCBRV08 EQU   JSCBSEC3+11                                              01718000
JSCBRV07 EQU   JSCBFBYT                                                 01719000
JSCBRV06 EQU   JSCBFBYT                                                 01720000
JSCBRV05 EQU   JSCBFBYT                                                 01721000
JSCBRV04 EQU   JSCBFBYT                                                 01722000
JSCBRV03 EQU   JSCBFBYT                                                 01723000
JSCBRV02 EQU   JSCBFBYT                                                 01724000
JSCBADSP EQU   JSCBFBYT                                                 01725000
JSCBRV01 EQU   JSCBFBYT                                                 01726000
JSCBTJID EQU   JSCBASID                                                 01727000
JSCJCTP  EQU   JSCBJCTA                                                 01728000
JSCRSV24 EQU   JSCBJCT                                                  01729000
JSCBEND2 EQU   JSCBSEC2                                                 01730000
UCMIECBP EQU   UCMIECBA+1                                               01731000
UCMIECBF EQU   UCMIECBA                                                 01732000
XVRETCOD EQU   XVRET                                                    01733000
XVCONID  EQU   XVWQEID+3                                                01734000
XVWQEIDA EQU   XVWQEID                                                  01735000
XVEXPMAD EQU   XVWWB                                                    01736000
XVNEWRC  EQU   XVOREAD+2                                                01737000
XVNEWDC  EQU   XVOREAD                                                  01738000
XVD3     EQU   XVDFLAGS+3                                               01739000
XVD2QFHC EQU   XVD2                                                     01740000
XVD2ZERO EQU   XVD2                                                     01741000
XVD2DELW EQU   XVD2                                                     01742000
XVD2VALD EQU   XVD2                                                     01743000
XVD2MSGT EQU   XVD2                                                     01744000
XVD2RDC  EQU   XVD2                                                     01745000
XVD2CON  EQU   XVD2                                                     01746000
XVD1PERR EQU   XVD1                                                     01747000
XVD1AUTH EQU   XVD1                                                     01748000
XVD1PP   EQU   XVD1                                                     01749000
XVRESV01 EQU   XVD1                                                     01750000
XVD1OEXT EQU   XVD1                                                     01751000
XVD1ALDN EQU   XVD1                                                     01752000
XVD1CFPL EQU   XVD1                                                     01753000
XVD1PRIV EQU   XVD1                                                     01754000
XVD0WWB  EQU   XVD0                                                     01755000
XVD0QID  EQU   XVD0                                                     01756000
XVD0NORE EQU   XVD0                                                     01757000
XVD0NWQE EQU   XVD0                                                     01758000
XVD0RPFD EQU   XVD0                                                     01759000
XVD0S250 EQU   XVD0                                                     01760000
XVWQEAD  EQU   XVSAV+24                                                 01761000
XVPARMAD EQU   XVSAV+20                                                 01762000
XVMSGTYP EQU   XVRDMSV+4                                                01763000
XVDESCD  EQU   XVRDMSV                                                  01764000
XVA8     EQU   XVSAV+8                                                  01765000
XVA4     EQU   XVSAV+4                                                  01766000
XVA0     EQU   XVSAV                                                    01767000
QNAMEFLD EQU   ENQAREA+4                                                01768000
ENQRCFLD EQU   ENQAREA+3                                                01769000
FLAGBITS EQU   ENQAREA+2                                                01770000
RNAMELEN EQU   ENQAREA+1                                                01771000
ENQLENTH EQU   ENQAREA                                                  01772000
BLANK2   EQU   MSGINFO+18                                               01773000
BLANK1   EQU   MSGINFO+9                                                01774000
MSGID1   EQU   MSGINFO                                                  01775000
FLAGS    EQU   MSG+2                                                    01776000
PSCBU    EQU   PSCB+64                                                  01777000
PSCBRSZ  EQU   PSCB+60                                                  01778000
PSCBLINE EQU   PSCB+59                                                  01779000
PSCBCHAR EQU   PSCB+58                                                  01780000
PSCBUPTL EQU   PSCB+56                                                  01781000
PSCBRLGB EQU   PSCB+48                                                  01782000
PSCBDEST EQU   PSCB+40                                                  01783000
@NM00099 EQU   PSCB+36                                                  01784000
@NM00098 EQU   PSCB+32                                                  01785000
PSCBSOUT EQU   PSCB+31                                                  01786000
PSCBSUBM EQU   PSCB+30                                                  01787000
PSCBSUBC EQU   PSCB+29                                                  01788000
PSCBSUBH EQU   PSCB+28                                                  01789000
PSCBLTI2 EQU   PSCB+24                                                  01790000
PSCBLTIM EQU   PSCB+20                                                  01791000
PSCBATR2 EQU   PSCB+18                                                  01792000
@NM00097 EQU   PSCBATR1                                                 01793000
@NM00096 EQU   PSCBATR1                                                 01794000
PSCBRCVR EQU   PSCBATR1                                                 01795000
PSCBATTN EQU   PSCBATR1                                                 01796000
PSCBVMNT EQU   PSCBATR1                                                 01797000
PSCBJCL  EQU   PSCBATR1                                                 01798000
PSCBACCT EQU   PSCBATR1                                                 01799000
PSCBCTRL EQU   PSCBATR1                                                 01800000
PSCBGPNM EQU   PSCB+8                                                   01801000
PSCBUSRL EQU   PSCB+7                                                   01802000
PSCBUSER EQU   PSCB                                                     01803000
UPTPREFL EQU   UPT+23                                                   01804000
UPTPREFX EQU   UPT+16                                                   01805000
@NM00095 EQU   UPT+15                                                   01806000
UPTLDEL  EQU   UPT+14                                                   01807000
UPTCDEL  EQU   UPT+13                                                   01808000
UPTMODE  EQU   UPTSWS                                                   01809000
UPTALD   EQU   UPTSWS                                                   01810000
UPTPAUS  EQU   UPTSWS                                                   01811000
UPTNCOM  EQU   UPTSWS                                                   01812000
UPTMID   EQU   UPTSWS                                                   01813000
UPTNPRM  EQU   UPTSWS                                                   01814000
UPTRCVR  EQU   UPTSWS                                                   01815000
UPTUSER  EQU   UPT+2                                                    01816000
@NM00094 EQU   UPT                                                      01817000
SIRBEND  EQU   RBSECT+168                                               01818000
SVRBEND  EQU   RBSECT+168                                               01819000
RBRSV158 EQU   RBRSV150                                                 01820000
RBRSV157 EQU   RBRSV150                                                 01821000
RBRSV156 EQU   RBRSV150                                                 01822000
RBRSV155 EQU   RBRSV150                                                 01823000
RBRSV154 EQU   RBRSV150                                                 01824000
RBRSV153 EQU   RBRSV150                                                 01825000
RBRSV152 EQU   RBRSV150                                                 01826000
RBRSV151 EQU   RBRSV150                                                 01827000
RBRSV149 EQU   RBSECT+166                                               01828000
RBRSV148 EQU   RBSECT+164                                               01829000
RBSCBB   EQU   RBSECT+144                                               01830000
TIRBEND  EQU   @NM00092+8                                               01831000
PRBEND   EQU   @NM00092+8                                               01832000
RBRSV146 EQU   RBRSV138                                                 01833000
RBRSV145 EQU   RBRSV138                                                 01834000
RBRSV144 EQU   RBRSV138                                                 01835000
RBRSV143 EQU   RBRSV138                                                 01836000
RBRSV142 EQU   RBRSV138                                                 01837000
RBRSV141 EQU   RBRSV138                                                 01838000
RBRSV140 EQU   RBRSV138                                                 01839000
RBRSV139 EQU   RBRSV138                                                 01840000
RBRSV137 EQU   @NM00092+6                                               01841000
RBRSV136 EQU   @NM00092+4                                               01842000
RBRSV135 EQU   @NM00092                                                 01843000
@NM00091 EQU   RBSECT+32                                                01844000
@NM00090 EQU   @NM00088+1                                               01845000
@NM00089 EQU   @NM00088                                                 01846000
RBPGMQ1  EQU   RBPGMQ+1                                                 01847000
@NM00087 EQU   RBPGMQ                                                   01848000
@NM00086 EQU   RBSECT+16                                                01849000
@NM00085 EQU   @NM00081                                                 01850000
@NM00084 EQU   @NM00081                                                 01851000
RBIQETP  EQU   @NM00081                                                 01852000
RBUSIQE  EQU   RBETXR                                                   01853000
RBATTN   EQU   @NM00081                                                 01854000
@NM00083 EQU   @NM00081                                                 01855000
@NM00082 EQU   @NM00081                                                 01856000
RBPMSVRB EQU   @NM00079                                                 01857000
RBATNXIT EQU   @NM00079                                                 01858000
@NM00080 EQU   @NM00079                                                 01859000
RBWAITP  EQU   @NM00079                                                 01860000
RBFNSVRB EQU   RBTRSVRB                                                 01861000
RBFTP    EQU   @NM00079                                                 01862000
RBSIZE   EQU   RBSECT+8                                                 01863000
RBABOPSW EQU   RBSECT+4                                                 01864000
RBPPSAV1 EQU   RBPPSAV+1                                                01865000
@NM00077 EQU   RBPPSAV                                                  01866000
RBPRFXND EQU   RBPREFIX+64                                              01867000
RBINTCOD EQU   RBINTCDA+1                                               01868000
RBINLNTH EQU   RBINTCDA                                                 01869000
RBWCSA   EQU   RBPREFIX+60                                              01870000
RBRSV004 EQU   RBPREFIX+57                                              01871000
RBSSSYN  EQU   RBFLAGS1                                                 01872000
RBSCB    EQU   RBFLAGS1                                                 01873000
RBLONGWT EQU   RBFLAGS1                                                 01874000
RBASIR   EQU   RBFLAGS1                                                 01875000
RBRSV159 EQU   RBFLAGS1                                                 01876000
RBABEND  EQU   RBFLAGS1                                                 01877000
RBXWAIT  EQU   RBFLAGS1                                                 01878000
RBSLOCK  EQU   RBFLAGS1                                                 01879000
RBRTRAN  EQU   RBRTPSW2+4                                               01880000
RBRTINCD EQU   RBRTICIL+2                                               01881000
RBRTILC  EQU   RBRTICIL+1                                               01882000
RBRSV160 EQU   RBRTICIL                                                 01883000
RBRTPSW1 EQU   RBRTOPSW                                                 01884000
RBRSV062 EQU   RBRSV054                                                 01885000
RBRSV061 EQU   RBRSV054                                                 01886000
RBRSV060 EQU   RBRSV054                                                 01887000
RBRSV059 EQU   RBRSV054                                                 01888000
RBRSV058 EQU   RBRSV054                                                 01889000
RBRSV057 EQU   RBRSV054                                                 01890000
RBRSV056 EQU   RBRSV054                                                 01891000
RBRSV055 EQU   RBRSV054                                                 01892000
RBRSV053 EQU   RBPREFIX+38                                              01893000
RBRSV052 EQU   RBPREFIX+36                                              01894000
RBRSV051 EQU   RBPREFIX+32                                              01895000
RBPRFXST EQU   RBPREFIX+32                                              01896000
RBRSV050 EQU   RBPREFIX+28                                              01897000
RBRSV049 EQU   RBRSV041                                                 01898000
RBRSV048 EQU   RBRSV041                                                 01899000
RBRSV047 EQU   RBRSV041                                                 01900000
RBRSV046 EQU   RBRSV041                                                 01901000
RBRSV045 EQU   RBRSV041                                                 01902000
RBRSV044 EQU   RBRSV041                                                 01903000
RBRSV043 EQU   RBRSV041                                                 01904000
RBRSV042 EQU   RBRSV041                                                 01905000
RBRSV040 EQU   RBPREFIX+26                                              01906000
RBRSV039 EQU   RBPREFIX+24                                              01907000
RBRSV038 EQU   RBPREFIX+20                                              01908000
RBRSV037 EQU   RBPREFIX+16                                              01909000
RBRSV036 EQU   RBRSV028                                                 01910000
RBRSV035 EQU   RBRSV028                                                 01911000
RBRSV034 EQU   RBRSV028                                                 01912000
RBRSV033 EQU   RBRSV028                                                 01913000
RBRSV032 EQU   RBRSV028                                                 01914000
RBRSV031 EQU   RBRSV028                                                 01915000
RBRSV030 EQU   RBRSV028                                                 01916000
RBRSV029 EQU   RBRSV028                                                 01917000
RBRSV027 EQU   RBRSV019                                                 01918000
RBRSV026 EQU   RBRSV019                                                 01919000
RBRSV025 EQU   RBRSV019                                                 01920000
RBRSV024 EQU   RBRSV019                                                 01921000
RBRSV023 EQU   RBRSV019                                                 01922000
RBRSV022 EQU   RBRSV019                                                 01923000
RBRSV021 EQU   RBRSV019                                                 01924000
RBRSV020 EQU   RBRSV019                                                 01925000
RBRSV018 EQU   RBPREFIX+13                                              01926000
RBRSV017 EQU   RBPREFIX+12                                              01927000
RBSRV016 EQU   RBPREFIX+11                                              01928000
RBRSV015 EQU   RBPREFIX+10                                              01929000
RBRSV014 EQU   RBPREFIX+8                                               01930000
RBRSV013 EQU   RBPREFIX+4                                               01931000
RBRSV012 EQU   RBPREFIX                                                 01932000
XRBREG15 EQU   RBGRS15                                                  01933000
XRBREG14 EQU   RBGRS14                                                  01934000
XRBREG13 EQU   RBGRS13                                                  01935000
XRBREG12 EQU   RBGRS12                                                  01936000
XRBREG11 EQU   RBGRS11                                                  01937000
XRBREG10 EQU   RBGRS10                                                  01938000
XRBREG9  EQU   RBGRS9                                                   01939000
XRBREG8  EQU   RBGRS8                                                   01940000
XRBREG7  EQU   RBGRS7                                                   01941000
XRBREG6  EQU   RBGRS6                                                   01942000
XRBREG5  EQU   RBGRS5                                                   01943000
XRBREG4  EQU   RBGRS4                                                   01944000
XRBREG3  EQU   RBGRS3                                                   01945000
XRBREG2  EQU   RBGRS2                                                   01946000
XRBREG1  EQU   RBGRS1                                                   01947000
XRBREG0  EQU   RBGRS0                                                   01948000
XRBLNKA  EQU   RBLINKB                                                  01949000
XRBWT    EQU   RBWCF                                                    01950000
@NM00076 EQU   RBBASIC+24                                               01951000
RBOPSWPS EQU   RBOPSWB2                                                 01952000
@NM00075 EQU   RBOPSWB2                                                 01953000
@NM00074 EQU   XRBPSW                                                   01954000
@NM00073 EQU   RBBASIC+12                                               01955000
XRBWAIT  EQU   RBECBWT                                                  01956000
XRBFRRB  EQU   RBFDYN                                                   01957000
@NM00072 EQU   XSTAB2                                                   01958000
XRBACTV  EQU   RBFACTV                                                  01959000
XRBTCBP  EQU   RBTCBNXT                                                 01960000
@NM00071 EQU   XSTAB1                                                   01961000
XRBCKPT  EQU   RBFTCKPT                                                 01962000
@NM00070 EQU   XSTAB1                                                   01963000
@NM00069 EQU   RBBASIC+8                                                01964000
@NM00068 EQU   RBEXRTNM+1                                               01965000
RBTMIND3 EQU   RBTMFLD                                                  01966000
RBTMIND2 EQU   RBTMFLD                                                  01967000
RBTMCMP  EQU   RBTMFLD                                                  01968000
RBWLIM   EQU   RBTMFLD                                                  01969000
RBRSV005 EQU   RBTMFLD                                                  01970000
RBTMTOD  EQU   RBTMFLD                                                  01971000
RBTMQUE  EQU   RBTMFLD                                                  01972000
@NM00067 EQU   RBPRFX                                                   01973000
@NM00066 EQU   SDWA+512                                                 01974000
SDWAVRA  EQU   SDWARA+4                                                 01975000
SDWAURAL EQU   SDWARA+3                                                 01976000
@NM00065 EQU   SDWADPVA                                                 01977000
SDWAEBC  EQU   SDWADPVA                                                 01978000
SDWAHEX  EQU   SDWADPVA                                                 01979000
SDWAVRAL EQU   SDWARA                                                   01980000
@NM00064 EQU   SDWA+396                                                 01981000
SDWACOMP EQU   SDWA+392                                                 01982000
SDWARCPL EQU   SDWA+364                                                 01983000
@NM00063 EQU   SDWADPSA+32                                              01984000
SDWATO4  EQU   SDWADPSL+28                                              01985000
SDWAFRM4 EQU   SDWADPSL+24                                              01986000
SDWATO3  EQU   SDWADPSL+20                                              01987000
SDWAFRM3 EQU   SDWADPSL+16                                              01988000
SDWATO2  EQU   SDWADPSL+12                                              01989000
SDWAFRM2 EQU   SDWADPSL+8                                               01990000
SDWATO1  EQU   SDWADPSL+4                                               01991000
SDWAFRM1 EQU   SDWADPSL                                                 01992000
@NM00062 EQU   SDWADDAT+3                                               01993000
@NM00061 EQU   SDWAPDAT                                                 01994000
SDWAUSPL EQU   SDWAPDAT                                                 01995000
SDWADPSW EQU   SDWAPDAT                                                 01996000
SDWATJPA EQU   SDWAPDAT                                                 01997000
SDWATLPA EQU   SDWAPDAT                                                 01998000
SDWADREG EQU   SDWAPDAT                                                 01999000
SDWADSAH EQU   SDWAPDAT                                                 02000000
SDWADSAS EQU   SDWAPDAT                                                 02001000
@NM00060 EQU   SDWADDAT+1                                               02002000
@NM00059 EQU   SDWASDAT                                                 02003000
SDWAQQS  EQU   SDWASDAT                                                 02004000
SDWACBS  EQU   SDWASDAT                                                 02005000
SDWAGTF  EQU   SDWASDAT                                                 02006000
SDWASWA  EQU   SDWASDAT                                                 02007000
SDWALSQA EQU   SDWASDAT                                                 02008000
SDWASQA  EQU   SDWASDAT                                                 02009000
SDWANUC  EQU   SDWASDAT                                                 02010000
@NM00058 EQU   SDWADUMP+2                                               02011000
@NM00057 EQU   SDWADPFS                                                 02012000
SDWASLST EQU   SDWADPFS                                                 02013000
@NM00056 EQU   SDWADPFS                                                 02014000
SDWADLST EQU   SDWADPFS                                                 02015000
SDWADPT  EQU   SDWADPFS                                                 02016000
SDWADPID EQU   SDWADUMP                                                 02017000
SDWADPLA EQU   SDWA+316                                                 02018000
SDWAREXN EQU   SDWARECP+16                                              02019000
SDWACSCT EQU   SDWARECP+8                                               02020000
SDWAMODN EQU   SDWARECP                                                 02021000
@NM00055 EQU   SDWA+290                                                 02022000
SDWAASID EQU   SDWA+288                                                 02023000
SDWATALW EQU   SDWALKWS+28                                              02024000
SDWATDLW EQU   SDWALKWS+24                                              02025000
SDWATNLW EQU   SDWALKWS+20                                              02026000
SDWAAPLW EQU   SDWALKWS+16                                              02027000
SDWAIPLW EQU   SDWALKWS+12                                              02028000
SDWAILLW EQU   SDWALKWS+8                                               02029000
SDWAIULW EQU   SDWALKWS+4                                               02030000
SDWAICLW EQU   SDWALKWS                                                 02031000
SDWAFLLK EQU   SDWAACF4                                                 02032000
SDWACMS  EQU   SDWAACF4                                                 02033000
SDWAOPTM EQU   SDWAACF4                                                 02034000
SDWATADB EQU   SDWAACF4                                                 02035000
SDWATDNB EQU   SDWAACF4                                                 02036000
SDWATNCB EQU   SDWAACF4                                                 02037000
SDWAILCH EQU   SDWAACF4                                                 02038000
SDWAIUCB EQU   SDWAACF4                                                 02039000
SDWAICAT EQU   SDWAACF3                                                 02040000
SDWAIPRG EQU   SDWAACF3                                                 02041000
SDWASALL EQU   SDWAACF3                                                 02042000
SDWAASMP EQU   SDWAACF3                                                 02043000
SDWADISP EQU   SDWAACF3                                                 02044000
@NM00054 EQU   SDWAACF3                                                 02045000
@NM00053 EQU   SDWAACF2                                                 02046000
@NM00052 EQU   SDWAACF2                                                 02047000
SDWASPIN EQU   SDWAACF2                                                 02048000
@NM00051 EQU   SDWAACF2                                                 02049000
SDWALCPU EQU   SDWACPUA+2                                               02050000
@NM00050 EQU   SDWACPUA                                                 02051000
SDWARECA EQU   SDWA+244                                                 02052000
@NM00049 EQU   SDWA+239                                                 02053000
@NM00048 EQU   SDWAIOFS                                                 02054000
SDWANIOP EQU   SDWAIOFS                                                 02055000
SDWANOIO EQU   SDWAIOFS                                                 02056000
SDWAIOHT EQU   SDWAIOFS                                                 02057000
SDWAIOQR EQU   SDWAIOFS                                                 02058000
SDWAFMID EQU   SDWA+236                                                 02059000
@NM00047 EQU   SDWAERRD                                                 02060000
SDWAMCIV EQU   SDWAERRD                                                 02061000
SDWARPIV EQU   SDWAERRD                                                 02062000
SDWAMABD EQU   SDWAERRD                                                 02063000
SDWACTS  EQU   SDWAERRD                                                 02064000
SDWASTAE EQU   SDWAERRD                                                 02065000
SDWANRBE EQU   SDWAERRD                                                 02066000
SDWACLUP EQU   SDWAERRD                                                 02067000
@NM00046 EQU   SDWAERRC                                                 02068000
SDWAEAS  EQU   SDWAERRC                                                 02069000
SDWAPERC EQU   SDWAERRC                                                 02070000
SDWAIRB  EQU   SDWAERRC                                                 02071000
SDWASTAI EQU   SDWAERRC                                                 02072000
SDWASTAF EQU   SDWAERRC                                                 02073000
SDWASRBM EQU   SDWAERRB                                                 02074000
SDWALDIS EQU   SDWAERRB                                                 02075000
SDWAENRB EQU   SDWAERRB                                                 02076000
SDWATYP1 EQU   SDWAERRB                                                 02077000
@NM00045 EQU   SDWAERRB                                                 02078000
SDWAPGIO EQU   SDWAERRA                                                 02079000
SDWATEXC EQU   SDWAERRA                                                 02080000
SDWASVCE EQU   SDWAERRA                                                 02081000
SDWAABTM EQU   SDWAERRA                                                 02082000
SDWASVCD EQU   SDWAERRA                                                 02083000
SDWARKEY EQU   SDWAERRA                                                 02084000
SDWAPCHK EQU   SDWAERRA                                                 02085000
SDWAMCHK EQU   SDWAERRA                                                 02086000
SDWATIME EQU   SDWAMCH+20                                               02087000
SDWARFSA EQU   SDWAMCH+16                                               02088000
@NM00044 EQU   SDWAMCH+14                                               02089000
SDWAVEQR EQU   SDWARSR2                                                 02090000
SDWAPGFX EQU   SDWARSR2                                                 02091000
SDWAFLSQ EQU   SDWARSR2                                                 02092000
SDWAFSQA EQU   SDWARSR2                                                 02093000
SDWANUCL EQU   SDWARSR2                                                 02094000
SDWASPER EQU   SDWARSR2                                                 02095000
SDWAINTC EQU   SDWARSR2                                                 02096000
SDWAOFLN EQU   SDWARSR2                                                 02097000
SDWACHNG EQU   SDWARSR1                                                 02098000
SDWAMSER EQU   SDWARSR1                                                 02099000
@NM00043 EQU   SDWARSR1                                                 02100000
SDWACPID EQU   SDWAMCH+10                                               02101000
SDWATERR EQU   SDWAMCHD                                                 02102000
SDWAFPRX EQU   SDWAMCHD                                                 02103000
SDWAINSF EQU   SDWAMCHD                                                 02104000
SDWAACR  EQU   SDWAMCHD                                                 02105000
SDWASCK  EQU   SDWAMCHD                                                 02106000
SDWAPSWU EQU   SDWAMCHD                                                 02107000
SDWAREGU EQU   SDWAMCHD                                                 02108000
SDWASKYF EQU   SDWAMCHD                                                 02109000
@NM00042 EQU   SDWAMCHS                                                 02110000
SDWARSRF EQU   SDWAMCHS                                                 02111000
SDWARSRC EQU   SDWAMCHS                                                 02112000
SDWAINVP EQU   SDWAMCHS                                                 02113000
SDWATSVL EQU   SDWAMCHS                                                 02114000
SDWARCDF EQU   SDWAMCHS                                                 02115000
SDWASRVL EQU   SDWAMCHS                                                 02116000
SDWASCKE EQU   SDWASTCK+4                                               02117000
SDWASCKB EQU   SDWASTCK                                                 02118000
SDWALNTH EQU   SDWAIDNT+1                                               02119000
SDWASPID EQU   SDWAIDNT                                                 02120000
SDWASR15 EQU   SDWASRSV+60                                              02121000
SDWASR14 EQU   SDWASRSV+56                                              02122000
SDWASR13 EQU   SDWASRSV+52                                              02123000
SDWASR12 EQU   SDWASRSV+48                                              02124000
SDWASR11 EQU   SDWASRSV+44                                              02125000
SDWASR10 EQU   SDWASRSV+40                                              02126000
SDWASR09 EQU   SDWASRSV+36                                              02127000
SDWASR08 EQU   SDWASRSV+32                                              02128000
SDWASR07 EQU   SDWASRSV+28                                              02129000
SDWASR06 EQU   SDWASRSV+24                                              02130000
SDWASR05 EQU   SDWASRSV+20                                              02131000
SDWASR04 EQU   SDWASRSV+16                                              02132000
SDWASR03 EQU   SDWASRSV+12                                              02133000
SDWASR02 EQU   SDWASRSV+8                                               02134000
SDWASR00 EQU   SDWASRSV                                                 02135000
SDWATRN2 EQU   SDWAAEC2+4                                               02136000
SDWAIPC2 EQU   SDWAICD2                                                 02137000
SDWAIMC2 EQU   SDWAICD2                                                 02138000
SDWAIPR2 EQU   SDWAICD2                                                 02139000
@NM00041 EQU   SDWAINC2                                                 02140000
@NM00040 EQU   SDWAILC2                                                 02141000
SDWAIL2  EQU   SDWAILC2                                                 02142000
@NM00039 EQU   SDWAILC2                                                 02143000
@NM00038 EQU   SDWAAEC2                                                 02144000
SDWAADD2 EQU   SDWANXT2+1                                               02145000
@NM00037 EQU   SDWANXT2                                                 02146000
@NM00036 EQU   SDWAEC2+3                                                02147000
SDWASGN2 EQU   SDWAINT2                                                 02148000
SDWAEXP2 EQU   SDWAINT2                                                 02149000
SDWADEC2 EQU   SDWAINT2                                                 02150000
SDWAFPO2 EQU   SDWAINT2                                                 02151000
SDWACC2  EQU   SDWAINT2                                                 02152000
@NM00035 EQU   SDWAINT2                                                 02153000
SDWAPGM2 EQU   SDWAMWP2                                                 02154000
SDWAWAT2 EQU   SDWAMWP2                                                 02155000
SDWAMCK2 EQU   SDWAMWP2                                                 02156000
SDWAECT2 EQU   SDWAMWP2                                                 02157000
SDWAKEY2 EQU   SDWAMWP2                                                 02158000
SDWAEXT2 EQU   SDWAEMK2                                                 02159000
SDWAIO2  EQU   SDWAEMK2                                                 02160000
SDWATRM2 EQU   SDWAEMK2                                                 02161000
@NM00034 EQU   SDWAEMK2                                                 02162000
SDWAPER2 EQU   SDWAEMK2                                                 02163000
@NM00033 EQU   SDWAEMK2                                                 02164000
SDWATRAN EQU   SDWAAEC1+4                                               02165000
SDWAIPC1 EQU   SDWAICD1                                                 02166000
SDWAIMC1 EQU   SDWAICD1                                                 02167000
SDWAIPR1 EQU   SDWAICD1                                                 02168000
@NM00032 EQU   SDWAINC1                                                 02169000
@NM00031 EQU   SDWAILC1                                                 02170000
SDWAIL1  EQU   SDWAILC1                                                 02171000
@NM00030 EQU   SDWAILC1                                                 02172000
@NM00029 EQU   SDWAAEC1                                                 02173000
SDWAADD1 EQU   SDWANXT1+1                                               02174000
@NM00028 EQU   SDWANXT1                                                 02175000
@NM00027 EQU   SDWAEC1+3                                                02176000
SDWASGN1 EQU   SDWAINT1                                                 02177000
SDWAEXP1 EQU   SDWAINT1                                                 02178000
SDWADEC1 EQU   SDWAINT1                                                 02179000
SDWAFPO1 EQU   SDWAINT1                                                 02180000
SDWACC1  EQU   SDWAINT1                                                 02181000
@NM00026 EQU   SDWAINT1                                                 02182000
SDWAPGM1 EQU   SDWAMWP1                                                 02183000
SDWAWAT1 EQU   SDWAMWP1                                                 02184000
SDWAMCK1 EQU   SDWAMWP1                                                 02185000
SDWAECT1 EQU   SDWAMWP1                                                 02186000
SDWAKEY1 EQU   SDWAMWP1                                                 02187000
SDWAEXT1 EQU   SDWAEMK1                                                 02188000
SDWAIO1  EQU   SDWAEMK1                                                 02189000
SDWATRM1 EQU   SDWAEMK1                                                 02190000
@NM00025 EQU   SDWAEMK1                                                 02191000
SDWAPER1 EQU   SDWAEMK1                                                 02192000
@NM00024 EQU   SDWAEMK1                                                 02193000
SDWAIOBR EQU   SDWA+100                                                 02194000
SDWAEPA  EQU   SDWA+96                                                  02195000
@NM00023 EQU   SDWANAME+4                                               02196000
SDWARBAD EQU   SDWANAME                                                 02197000
SDWAGR15 EQU   SDWAGRSV+60                                              02198000
SDWAGR14 EQU   SDWAGRSV+56                                              02199000
SDWAGR13 EQU   SDWAGRSV+52                                              02200000
SDWAGR12 EQU   SDWAGRSV+48                                              02201000
SDWAGR11 EQU   SDWAGRSV+44                                              02202000
SDWAGR10 EQU   SDWAGRSV+40                                              02203000
SDWAGR09 EQU   SDWAGRSV+36                                              02204000
SDWAGR08 EQU   SDWAGRSV+32                                              02205000
SDWAGR07 EQU   SDWAGRSV+28                                              02206000
SDWAGR06 EQU   SDWAGRSV+24                                              02207000
SDWAGR05 EQU   SDWAGRSV+20                                              02208000
SDWAGR04 EQU   SDWAGRSV+16                                              02209000
SDWAGR03 EQU   SDWAGRSV+12                                              02210000
SDWAGR02 EQU   SDWAGRSV+8                                               02211000
SDWAGR01 EQU   SDWAGRSV+4                                               02212000
SDWAGR00 EQU   SDWAGRSV                                                 02213000
SDWANXTP EQU   SDWACTL2+5                                               02214000
SDWASGP  EQU   SDWAPMKP                                                 02215000
SDWAEUP  EQU   SDWAPMKP                                                 02216000
SDWADOP  EQU   SDWAPMKP                                                 02217000
SDWAFPP  EQU   SDWAPMKP                                                 02218000
SDWACCP  EQU   SDWAPMKP                                                 02219000
SDWAILP  EQU   SDWAPMKP                                                 02220000
SDWAINTP EQU   SDWACTL2+2                                               02221000
SDWASPVP EQU   SDWAMWPP                                                 02222000
SDWAWATP EQU   SDWAMWPP                                                 02223000
SDWAMCKP EQU   SDWAMWPP                                                 02224000
@NM00022 EQU   SDWAMWPP                                                 02225000
SDWAKEYP EQU   SDWAMWPP                                                 02226000
SDWAEXTP EQU   SDWACMKP                                                 02227000
SDWAIOP  EQU   SDWACMKP                                                 02228000
SDWANXTA EQU   SDWACTL1+5                                               02229000
SDWASGA  EQU   SDWAPMKA                                                 02230000
SDWAEUA  EQU   SDWAPMKA                                                 02231000
SDWADOA  EQU   SDWAPMKA                                                 02232000
SDWAFPA  EQU   SDWAPMKA                                                 02233000
SDWACCA  EQU   SDWAPMKA                                                 02234000
SDWAILA  EQU   SDWAPMKA                                                 02235000
SDWAINTA EQU   SDWACTL1+2                                               02236000
SDWASPVA EQU   SDWAMWPA                                                 02237000
SDWAWATA EQU   SDWAMWPA                                                 02238000
SDWAMCKA EQU   SDWAMWPA                                                 02239000
@NM00021 EQU   SDWAMWPA                                                 02240000
SDWAKEYA EQU   SDWAMWPA                                                 02241000
SDWAEXTA EQU   SDWACMKA                                                 02242000
SDWAIOA  EQU   SDWACMKA                                                 02243000
SDWACMPC EQU   SDWAABCC+1                                               02244000
@NM00020 EQU   SDWACMPF                                                 02245000
SDWASTCC EQU   SDWACMPF                                                 02246000
@NM00019 EQU   SDWACMPF                                                 02247000
SDWASTEP EQU   SDWACMPF                                                 02248000
SDWAREQ  EQU   SDWACMPF                                                 02249000
SDWAPARM EQU   SDWA                                                     02250000
TIOCSTEP EQU   TIOT1+8                                                  02251000
ASCBEND  EQU   ASCB+208                                                 02252000
ASCBSRBT EQU   ASCB+200                                                 02253000
ASCBSWTL EQU   ASCB+196                                                 02254000
ASCBRS14 EQU   ASCB+195                                                 02255000
ASCBSMCT EQU   ASCB+194                                                 02256000
ASCBRS12 EQU   ASCB+192                                                 02257000
ASCBPCTT EQU   ASCB+188                                                 02258000
ASCBVGTT EQU   ASCB+184                                                 02259000
ASCBLGCB EQU   ASCB+180                                                 02260000
ASCBJBNS EQU   ASCB+176                                                 02261000
ASCBJBNI EQU   ASCB+172                                                 02262000
ASCBMCC  EQU   ASCB+168                                                 02263000
ASCBRTWA EQU   ASCB+164                                                 02264000
ASCBIQEA EQU   ASCB+160                                                 02265000
ASCBXMPQ EQU   ASCB+156                                                 02266000
ASCBRS01 EQU   ASCB+154                                                 02267000
ASCBFMCT EQU   ASCB+152                                                 02268000
ASCBOUXB EQU   ASCB+148                                                 02269000
ASCBOUCB EQU   ASCB+144                                                 02270000
ASCBMECB EQU   ASCB+140                                                 02271000
ASCBQECB EQU   ASCB+136                                                 02272000
ASCBCMSB EQU   ASCB+132                                                 02273000
ASCBCMSF EQU   ASCB+128                                                 02274000
ASCBTCBS EQU   ASCB+124                                                 02275000
ASCBNVSC EQU   ASCB+122                                                 02276000
ASCBVSC  EQU   ASCB+120                                                 02277000
ASCBSRBS EQU   ASCB+118                                                 02278000
ASCBSSRB EQU   ASCB+116                                                 02279000
ASCBRV06 EQU   ASCBFLG2                                                 02280000
ASCBRV05 EQU   ASCBFLG2                                                 02281000
ASCBRV04 EQU   ASCBFLG2                                                 02282000
ASCBSNQS EQU   ASCBFLG2                                                 02283000
ASCBS2S  EQU   ASCBFLG2                                                 02284000
ASCBCEXT EQU   ASCBFLG2                                                 02285000
ASCBPXMT EQU   ASCBFLG2                                                 02286000
ASCBXMPT EQU   ASCBFLG2                                                 02287000
ASCBRF07 EQU   ASCBDSP1                                                 02288000
ASCBRF06 EQU   ASCBDSP1                                                 02289000
ASCBRF05 EQU   ASCBDSP1                                                 02290000
ASCBRF04 EQU   ASCBDSP1                                                 02291000
ASCBRF03 EQU   ASCBDSP1                                                 02292000
ASCBRF02 EQU   ASCBDSP1                                                 02293000
ASCBFAIL EQU   ASCBDSP1                                                 02294000
ASCBNOQ  EQU   ASCBDSP1                                                 02295000
ASCBSWCT EQU   ASCB+112                                                 02296000
ASCBASXB EQU   ASCB+108                                                 02297000
ASCBTMCH EQU   ASCB+104                                                 02298000
ASCBNSWP EQU   ASCBFLG1                                                 02299000
ASCBTYP1 EQU   ASCBFLG1                                                 02300000
ASCBSTND EQU   ASCBFLG1                                                 02301000
ASCBABNT EQU   ASCBFLG1                                                 02302000
ASCBTERM EQU   ASCBFLG1                                                 02303000
ASCBS3S  EQU   ASCBFLG1                                                 02304000
ASCBCMSH EQU   ASCBFLG1                                                 02305000
ASCBTOFF EQU   ASCBFLG1                                                 02306000
ASCBRF01 EQU   ASCBRCTF                                                 02307000
ASCBTMLW EQU   ASCBRCTF                                                 02308000
ASCBOUT  EQU   ASCBRCTF                                                 02309000
ASCBWAIT EQU   ASCBRCTF                                                 02310000
ASCBRV08 EQU   ASCBRCTF                                                 02311000
ASCBFQU  EQU   ASCBRCTF                                                 02312000
ASCBFRS  EQU   ASCBRCTF                                                 02313000
ASCBTMNO EQU   ASCBRCTF                                                 02314000
ASCBAFFN EQU   ASCBFW1                                                  02315000
ASCBDUMP EQU   ASCB+96                                                  02316000
ASCBQSVC EQU   ASCB+92                                                  02317000
ASCBUBET EQU   ASCB+88                                                  02318000
ASCBECB  EQU   ASCB+84                                                  02319000
ASCBJSTL EQU   ASCB+80                                                  02320000
ASCBEWST EQU   ASCB+72                                                  02321000
ASCBEJST EQU   ASCB+64                                                  02322000
ASCBCSCB EQU   ASCB+56                                                  02323000
ASCBRSM  EQU   ASCB+52                                                  02324000
ASCBLDA  EQU   ASCB+48                                                  02325000
ASCBSTOR EQU   ASCB+44                                                  02326000
ASCBDP   EQU   ASCB+43                                                  02327000
ASCBRV07 EQU   ASCB+42                                                  02328000
ASCBIOSM EQU   ASCB+40                                                  02329000
ASCBSEQN EQU   ASCB+38                                                  02330000
ASCBCPUS EQU   ASCB+32                                                  02331000
ASCBSPL  EQU   ASCB+28                                                  02332000
ASCBLSLQ EQU   ASCB+24                                                  02333000
ASCBFSLQ EQU   ASCB+20                                                  02334000
ASCBIOSP EQU   ASCB+16                                                  02335000
ASCBLOCK EQU   ASCB+12                                                  02336000
ASCBBWDP EQU   ASCB+8                                                   02337000
ASCBFWDP EQU   ASCB+4                                                   02338000
ASCBASCB EQU   ASCB                                                     02339000
ASCBEGIN EQU   ASCB                                                     02340000
@NM00016 EQU   TCBXTNT2+32                                              02341000
TCBRV181 EQU   TCBRV173                                                 02342000
TCBRV180 EQU   TCBRV173                                                 02343000
TCBRV179 EQU   TCBRV173                                                 02344000
TCBRV178 EQU   TCBRV173                                                 02345000
TCBRV177 EQU   TCBRV173                                                 02346000
TCBRV176 EQU   TCBRV173                                                 02347000
TCBRV175 EQU   TCBRV173                                                 02348000
TCBRV174 EQU   TCBRV173                                                 02349000
TCBRV172 EQU   TCBRV164                                                 02350000
TCBRV171 EQU   TCBRV164                                                 02351000
TCBRV170 EQU   TCBRV164                                                 02352000
TCBRV169 EQU   TCBRV164                                                 02353000
TCBRV168 EQU   TCBRV164                                                 02354000
TCBRV167 EQU   TCBRV164                                                 02355000
TCBRV166 EQU   TCBRV164                                                 02356000
TCBRV165 EQU   TCBRV164                                                 02357000
TCBRV163 EQU   TCBRV155                                                 02358000
TCBRV162 EQU   TCBRV155                                                 02359000
TCBRV161 EQU   TCBRV155                                                 02360000
TCBRV160 EQU   TCBRV155                                                 02361000
TCBRV159 EQU   TCBRV155                                                 02362000
TCBRV158 EQU   TCBRV155                                                 02363000
TCBRV157 EQU   TCBRV155                                                 02364000
TCBRV156 EQU   TCBRV155                                                 02365000
TCBRV154 EQU   TCBRV146                                                 02366000
TCBRV153 EQU   TCBRV146                                                 02367000
TCBRV152 EQU   TCBRV146                                                 02368000
TCBRV151 EQU   TCBRV146                                                 02369000
TCBRV150 EQU   TCBRV146                                                 02370000
TCBRV149 EQU   TCBRV146                                                 02371000
TCBRV148 EQU   TCBRV146                                                 02372000
TCBRV147 EQU   TCBRV146                                                 02373000
TCBRV145 EQU   TCBXTNT2+26                                              02374000
TCBRV144 EQU   TCBXTNT2+24                                              02375000
TCBRV143 EQU   TCBXTNT2+20                                              02376000
TCBRV142 EQU   TCBXTNT2+16                                              02377000
TCBRSV49 EQU   TCBXTNT2+12                                              02378000
TCBEVENT EQU   TCBXTNT2+8                                               02379000
TCBRCMP  EQU   TCBXTNT2+5                                               02380000
TCBRSVAB EQU   TCBXTNT2+4                                               02381000
TCBGTFA  EQU   TCBGTF+1                                                 02382000
TCBRSV47 EQU   TCBTFLG                                                  02383000
TCBRSV46 EQU   TCBTFLG                                                  02384000
TCBRSV45 EQU   TCBTFLG                                                  02385000
TCBRSV44 EQU   TCBTFLG                                                  02386000
TCBRSV43 EQU   TCBTFLG                                                  02387000
TCBDSPIT EQU   TCBTFLG                                                  02388000
TCBERRTN EQU   TCBTFLG                                                  02389000
TCBASYNC EQU   TCBTFLG                                                  02390000
@NM00015 EQU   TCB+296                                                  02391000
TCBSVCA2 EQU   TCB+292                                                  02392000
TCBSWASA EQU   TCB+288                                                  02393000
TCBDBTB  EQU   TCB+284                                                  02394000
TCBRPT   EQU   TCB+280                                                  02395000
TCBRV141 EQU   TCBRV133                                                 02396000
TCBRV140 EQU   TCBRV133                                                 02397000
TCBRV139 EQU   TCBRV133                                                 02398000
TCBRV138 EQU   TCBRV133                                                 02399000
TCBRV137 EQU   TCBRV133                                                 02400000
TCBRV136 EQU   TCBRV133                                                 02401000
TCBRV135 EQU   TCBRV133                                                 02402000
TCBRV134 EQU   TCBRV133                                                 02403000
TCBRV132 EQU   TCBRV124                                                 02404000
TCBRV131 EQU   TCBRV124                                                 02405000
TCBRV130 EQU   TCBRV124                                                 02406000
TCBRV129 EQU   TCBRV124                                                 02407000
TCBRV128 EQU   TCBRV124                                                 02408000
TCBRV127 EQU   TCBRV124                                                 02409000
TCBRV126 EQU   TCBRV124                                                 02410000
TCBRV125 EQU   TCBRV124                                                 02411000
TCBRV123 EQU   TCBFBYT2                                                 02412000
TCBRV122 EQU   TCBFBYT2                                                 02413000
TCBECBNV EQU   TCBFBYT2                                                 02414000
TCBSSSYN EQU   TCBFBYT2                                                 02415000
TCBFPRAP EQU   TCBFBYT2                                                 02416000
TCBFDW   EQU   TCBFBYT2                                                 02417000
TCBFMW   EQU   TCBFBYT2                                                 02418000
TCBCNCB  EQU   TCBFBYT2                                                 02419000
TCBLLH   EQU   TCBFBYT1                                                 02420000
TCBRV113 EQU   TCBFBYT1                                                 02421000
TCBEOT   EQU   TCBFBYT1                                                 02422000
TCBRTM2  EQU   TCBFBYT1                                                 02423000
TCBPGNLY EQU   TCBFBYT1                                                 02424000
TCBNDIOS EQU   TCBFBYT1                                                 02425000
TCBACTIV EQU   TCBFBYT1                                                 02426000
TCBEOTFM EQU   TCBFBYT1                                                 02427000
TCBAFFN  EQU   TCB+274                                                  02428000
TCBCCPVI EQU   TCB+272                                                  02429000
TCBUKYSP EQU   TCB+268                                                  02430000
TCBMODE  EQU   TCBESTAE+3                                               02431000
TCBERTYP EQU   TCBESTAE+2                                               02432000
TCBRV314 EQU   TCBESTRM                                                 02433000
TCBRV313 EQU   TCBESTRM                                                 02434000
TCBRV312 EQU   TCBESTRM                                                 02435000
TCBRV311 EQU   TCBESTRM                                                 02436000
TCBRV310 EQU   TCBESTRM                                                 02437000
TCBRV309 EQU   TCBESTRM                                                 02438000
TCBRV308 EQU   TCBESTRM                                                 02439000
TCBETERM EQU   TCBESTRM                                                 02440000
TCBSCBKY EQU   TCBESTAE                                                 02441000
TCBRTM12 EQU   TCB+260                                                  02442000
TCBTCBID EQU   TCB+256                                                  02443000
TCBRSV96 EQU   TCB+252                                                  02444000
TCBSWA   EQU   TCB+248                                                  02445000
TCBFOEA  EQU   TCBFOE+1                                                 02446000
TCBRSV42 EQU   TCBFOE                                                   02447000
TCBRV306 EQU   TCB+240                                                  02448000
TCBRSV41 EQU   TCB+239                                                  02449000
TCBTID   EQU   TCB+238                                                  02450000
TCBRSVAA EQU   TCB+237                                                  02451000
TCBABCUR EQU   TCB+236                                                  02452000
TCBTMSAV EQU   TCB+232                                                  02453000
TCBIOTIM EQU   TCB+228                                                  02454000
TCBRTWA  EQU   TCB+224                                                  02455000
TCBBACK  EQU   TCB+220                                                  02456000
TCBTIRB  EQU   TCB+216                                                  02457000
TCBAECB  EQU   TCB+212                                                  02458000
TCBEXT2A EQU   TCBEXT2+1                                                02459000
TCBRSV39 EQU   TCBEXT2                                                  02460000
TCBSTMCT EQU   TCB+207                                                  02461000
TCBSYSCT EQU   TCB+206                                                  02462000
TCBRSV37 EQU   TCB+205                                                  02463000
TCBEXSVC EQU   TCBDAR                                                   02464000
TCBDARMS EQU   TCBDAR                                                   02465000
TCBDARWT EQU   TCBDAR                                                   02466000
TCBDARO  EQU   TCBDAR                                                   02467000
TCBDARMC EQU   TCBDARC                                                  02468000
TCBDARD  EQU   TCBDAR                                                   02469000
TCBDARS  EQU   TCBDAR                                                   02470000
TCBDARP  EQU   TCBDAR                                                   02471000
TCBGTOFM EQU   TCBFLGS7                                                 02472000
TCBADMP  EQU   TCBFLGS7                                                 02473000
TCBRSTSK EQU   TCBFLGS7                                                 02474000
TCBSVCS  EQU   TCBFLGS7                                                 02475000
TCBSTACK EQU   TCBFLGS7                                                 02476000
TCBRSV34 EQU   TCBFLGS7                                                 02477000
TCBRSV33 EQU   TCBFLGS7                                                 02478000
TCBGPECB EQU   TCBFLGS7                                                 02479000
TCBNTJS  EQU   TCBFLGS6                                                 02480000
TCBAPG   EQU   TCBFLGS6                                                 02481000
TCBMIGR  EQU   TCBFLGS6                                                 02482000
TCBRV303 EQU   TCBFLGS6                                                 02483000
TCBSPVLK EQU   TCBFLGS6                                                 02484000
TCBCPU   EQU   TCBFLGS6                                                 02485000
TCBPIE17 EQU   TCBFLGS6                                                 02486000
TCBRV    EQU   TCBFLGS6                                                 02487000
TCBRSV79 EQU   TCBNDSP5                                                 02488000
TCBRSV78 EQU   TCBNDSP5                                                 02489000
TCBRSV77 EQU   TCBNDSP5                                                 02490000
TCBRSV76 EQU   TCBNDSP5                                                 02491000
TCBRSV75 EQU   TCBNDSP5                                                 02492000
TCBRSV74 EQU   TCBNDSP5                                                 02493000
TCBRSV95 EQU   TCBNDSP5                                                 02494000
TCBRSV94 EQU   TCBNDSP5                                                 02495000
TCBRSV93 EQU   TCBNDSP4                                                 02496000
TCBRSV92 EQU   TCBNDSP4                                                 02497000
TCBRSV91 EQU   TCBNDSP4                                                 02498000
TCBRSV90 EQU   TCBNDSP4                                                 02499000
TCBRSV89 EQU   TCBNDSP4                                                 02500000
TCBRSV88 EQU   TCBNDSP4                                                 02501000
TCBRSV87 EQU   TCBNDSP4                                                 02502000
TCBRSV86 EQU   TCBNDSP4                                                 02503000
TCBEXT1A EQU   TCBEXT1+1                                                02504000
TCBRSV32 EQU   TCBEXT1                                                  02505000
TCBEXCPD EQU   TCB+192                                                  02506000
TCBIOBRC EQU   TCB+188                                                  02507000
TCBDDWTC EQU   TCB+186                                                  02508000
TCBDDEXC EQU   TCB+184                                                  02509000
@NM00014 EQU   TCBRECDE                                                 02510000
TCBREC   EQU   TCBRECDE                                                 02511000
TCBMDIDS EQU   TCB+176                                                  02512000
TCBNDINT EQU   TCBNDSP3                                                 02513000
TCBRSV27 EQU   TCBNDSP3                                                 02514000
TCBRSV26 EQU   TCBNDSP3                                                 02515000
TCBRSV25 EQU   TCBNDSP3                                                 02516000
TCBRSV24 EQU   TCBNDSP3                                                 02517000
TCBSRBND EQU   TCBNDSP3                                                 02518000
TCBRV302 EQU   TCBNDSP3                                                 02519000
TCBLJSND EQU   TCBNDSP3                                                 02520000
TCBABE   EQU   TCBNDSP2                                                 02521000
TCBDSS   EQU   TCBNDSP2                                                 02522000
TCBOWAIT EQU   TCBNDSP2                                                 02523000
TCBIWAIT EQU   TCBNDSP2                                                 02524000
TCBNDTS  EQU   TCBNDSP2                                                 02525000
TCBNDSVC EQU   TCBNDSP2                                                 02526000
TCBSTPP  EQU   TCBNDSP2                                                 02527000
TCBABD   EQU   TCBNDSP2                                                 02528000
TCBRSV22 EQU   TCBNDSP1                                                 02529000
TCBPIEND EQU   TCBNDSP1                                                 02530000
TCBTPSP  EQU   TCBNDSP1                                                 02531000
TCBDDRND EQU   TCBNDSP1                                                 02532000
TCBRSPND EQU   TCBNDSP1                                                 02533000
TCBRSTND EQU   TCBNDSP1                                                 02534000
TCBDARPN EQU   TCBNDSP1                                                 02535000
TCBDARTN EQU   TCBNDSP1                                                 02536000
TCBNDSP0 EQU   TCBNDSP                                                  02537000
TCBUSER  EQU   TCB+168                                                  02538000
TCBTCTB  EQU   TCBTCT+1                                                 02539000
TCBRSV9C EQU   TCBTCTGF                                                 02540000
TCBRSV9B EQU   TCBTCTGF                                                 02541000
TCBRSV9A EQU   TCBTCTGF                                                 02542000
TCBRSV99 EQU   TCBTCTGF                                                 02543000
TCBRSV98 EQU   TCBTCTGF                                                 02544000
TCBRSV97 EQU   TCBTCTGF                                                 02545000
TCBRSV20 EQU   TCBTCTGF                                                 02546000
TCBSMFGF EQU   TCBTCTGF                                                 02547000
TCBSTABB EQU   TCBSTAB+1                                                02548000
TCBSTCUR EQU   TCBNSTAE                                                 02549000
TCBRV301 EQU   TCBNSTAE                                                 02550000
TCBSYNCH EQU   TCBNSTAE                                                 02551000
TCBHALT  EQU   TCBNSTAE                                                 02552000
TCBPPSUP EQU   TCBNSTAE                                                 02553000
TCB33E   EQU   TCBNSTAE                                                 02554000
TCBQUIES EQU   TCBNSTAE                                                 02555000
TCBSTABE EQU   TCBNSTAE                                                 02556000
TCBAQE   EQU   TCB+156                                                  02557000
TCBPQE   EQU   TCB+152                                                  02558000
TCBTSDP  EQU   TCB+151                                                  02559000
TCBTSLP  EQU   TCB+150                                                  02560000
TCBSTPCT EQU   TCB+149                                                  02561000
TCBCPUBN EQU   TCBTSFLG                                                 02562000
TCBDYDSP EQU   TCBTSFLG                                                 02563000
TCBRSV18 EQU   TCBTSFLG                                                 02564000
TCBRSV17 EQU   TCBTSFLG                                                 02565000
TCBTIOTG EQU   TCBTSFLG                                                 02566000
TCBATT   EQU   TCBTSFLG                                                 02567000
TCBSTPPR EQU   TCBTSFLG                                                 02568000
TCBRV300 EQU   TCBTSTSK                                                 02569000
TCBECB   EQU   TCB+144                                                  02570000
TCBIQE   EQU   TCB+140                                                  02571000
TCBLTC   EQU   TCB+136                                                  02572000
TCBOTC   EQU   TCB+132                                                  02573000
TCBNTC   EQU   TCB+128                                                  02574000
TCBJSTCA EQU   TCBJSTCB+1                                               02575000
TCBRSV16 EQU   TCBJSTCB                                                 02576000
TCBTQET  EQU   TCBTME                                                   02577000
TCBTCB   EQU   TCB+116                                                  02578000
TCBFSAB  EQU   TCBFSA+1                                                 02579000
TCBQEL   EQU   TCBFSA                                                   02580000
TCBGRS15 EQU   TCBGRS+60                                                02581000
TCBGRS14 EQU   TCBGRS+56                                                02582000
TCBGRS13 EQU   TCBGRS+52                                                02583000
TCBGRS12 EQU   TCBGRS+48                                                02584000
TCBGRS11 EQU   TCBGRS+44                                                02585000
TCBGRS10 EQU   TCBGRS+40                                                02586000
TCBGRS9  EQU   TCBGRS+36                                                02587000
TCBGRS8  EQU   TCBGRS+32                                                02588000
TCBGRS7  EQU   TCBGRS+28                                                02589000
TCBGRS6  EQU   TCBGRS+24                                                02590000
TCBGRS5  EQU   TCBGRS+20                                                02591000
TCBGRS4  EQU   TCBGRS+16                                                02592000
TCBGRS3  EQU   TCBGRS+12                                                02593000
TCBGRS2  EQU   TCBGRS+8                                                 02594000
TCBGRS1  EQU   TCBGRS+4                                                 02595000
TCBGRS0  EQU   TCBGRS                                                   02596000
TCBJPQB  EQU   TCBJPQ+1                                                 02597000
TCBRSV15 EQU   TCBPURGE                                                 02598000
TCBRSV14 EQU   TCBPURGE                                                 02599000
TCBRSV13 EQU   TCBPURGE                                                 02600000
TCBRSV12 EQU   TCBPURGE                                                 02601000
TCBRSV11 EQU   TCBPURGE                                                 02602000
TCBRSV10 EQU   TCBPURGE                                                 02603000
TCBRSV09 EQU   TCBPURGE                                                 02604000
TCBJPQF  EQU   TCBPURGE                                                 02605000
TCBJLB   EQU   TCB+40                                                   02606000
TCBLLS   EQU   TCB+36                                                   02607000
TCBDSP   EQU   TCB+35                                                   02608000
TCBLMP   EQU   TCB+34                                                   02609000
TCBPNDSP EQU   TCBFLGS5                                                 02610000
TCBFCD1  EQU   TCBFLGS5                                                 02611000
TCBSTP   EQU   TCBFLGS5                                                 02612000
TCBSYS   EQU   TCBFLGS5                                                 02613000
TCBANDSP EQU   TCBFLGS5                                                 02614000
TCBPAGE  EQU   TCBFLGS5                                                 02615000
TCBUXNDF EQU   TCBABWF                                                  02616000
TCBFC    EQU   TCBFLGS5                                                 02617000
TCBONDSP EQU   TCBFLGS4                                                 02618000
TCBMPCND EQU   TCBFLGS4                                                 02619000
TCBMPCVQ EQU   TCBFLGS4                                                 02620000
TCBUXNDV EQU   TCBFLGS4                                                 02621000
TCBHNDSP EQU   TCBFLGS4                                                 02622000
TCBRQENA EQU   TCBFLGS4                                                 02623000
TCBSER   EQU   TCBFLGS4                                                 02624000
TCBNDUMP EQU   TCBFLGS4                                                 02625000
TCBDWSTA EQU   TCBFLGS3                                                 02626000
TCBRSV08 EQU   TCBFLGS3                                                 02627000
TCBRSV07 EQU   TCBFLGS3                                                 02628000
TCBRSV06 EQU   TCBFLGS3                                                 02629000
TCBABGM  EQU   TCBFLGS3                                                 02630000
TCBABTRM EQU   TCBFLGS3                                                 02631000
TCBADINP EQU   TCBFLGS3                                                 02632000
TCBFSM   EQU   TCBFLGS3                                                 02633000
TCBFTS   EQU   TCBFLGS2                                                 02634000
TCBFETXR EQU   TCBFLGS2                                                 02635000
TCBFDSOP EQU   TCBFLGS2                                                 02636000
TCBFJMC  EQU   TCBFLGS2                                                 02637000
TCBFSMC  EQU   TCBFLGS2                                                 02638000
TCBFABOP EQU   TCBFLGS2                                                 02639000
TCBFSTI  EQU   TCBFLGS2                                                 02640000
TCBFOINP EQU   TCBFLGS2                                                 02641000
TCBFX    EQU   TCBFLGS1                                                 02642000
TCBFS    EQU   TCBFLGS1                                                 02643000
TCBFT    EQU   TCBFLGS1                                                 02644000
TCBPDUMP EQU   TCBFLGS1                                                 02645000
TCBNONPR EQU   TCBFLGS1                                                 02646000
TCBFERA  EQU   TCBFLGS1                                                 02647000
TCBFE    EQU   TCBFLGS1                                                 02648000
TCBFA    EQU   TCBFLGS1                                                 02649000
TCBZERO  EQU   TCBPKF                                                   02650000
TCBFLAG  EQU   TCBPKF                                                   02651000
TCBMSSB  EQU   TCBMSS+1                                                 02652000
TCBRSV03 EQU   TCBMSS                                                   02653000
TCBTRNB  EQU   TCBTRN+1                                                 02654000
TCBRSV02 EQU   TCBABF                                                   02655000
TCBOLTEP EQU   TCBABF                                                   02656000
TCBTCP   EQU   TCBABF                                                   02657000
TCBTCPP  EQU   TCBABF                                                   02658000
TCBRSV01 EQU   TCBABF                                                   02659000
TCBGRPH  EQU   TCBABF                                                   02660000
TCBNOCHK EQU   TCBABF                                                   02661000
TCBMOD91 EQU   TCBABF                                                   02662000
TCBCMPC  EQU   TCBCMP+1                                                 02663000
TCBRV318 EQU   TCBCMSG                                                  02664000
TCBRV317 EQU   TCBCIND                                                  02665000
TCBRV316 EQU   TCBCWTO                                                  02666000
TCBCASID EQU   TCBCDBL                                                  02667000
TCBNOCC  EQU   TCBSTCC                                                  02668000
TCBDMPO  EQU   TCBCPP                                                   02669000
TCBCSTEP EQU   TCBCMPF                                                  02670000
TCBCREQ  EQU   TCBCMPF                                                  02671000
TCBDEB   EQU   TCB+8                                                    02672000
TCBPIEA  EQU   TCBPIE+1                                                 02673000
TCBPM    EQU   TCBPMASK                                                 02674000
@NM00013 EQU   TCBPMASK                                                 02675000
TCBRBP   EQU   TCB                                                      02676000
TCBFRS6  EQU   TCBFRS+24                                                02677000
TCBFRS4  EQU   TCBFRS+16                                                02678000
TCBFRS2  EQU   TCBFRS+8                                                 02679000
TCBFRS0  EQU   TCBFRS                                                   02680000
JSCBCSCB EQU   JSCBSEC1+68                                              02681000
JSCBPMG  EQU   JSCBWTP+2                                                02682000
JSCRSV23 EQU   JSCBWTFG                                                 02683000
JSCRSV22 EQU   JSCBWTFG                                                 02684000
JSCRSV21 EQU   JSCBWTFG                                                 02685000
JSCRSV20 EQU   JSCBWTFG                                                 02686000
JSCRSV19 EQU   JSCBWTFG                                                 02687000
JSCRSV18 EQU   JSCBWTFG                                                 02688000
JSCBRET  EQU   JSCBWTFG                                                 02689000
JSCBIOFG EQU   JSCBWTFG                                                 02690000
@NM00010 EQU   JSCBSEC1+60                                              02691000
JSCBQMPI EQU   JSCBSEC1+56                                              02692000
JSCBPMSG EQU   JSCBSWT1                                                 02693000
JSCRSV16 EQU   JSCBSWT1                                                 02694000
JSCRSV15 EQU   JSCBSWT1                                                 02695000
JSCRSV14 EQU   JSCBSWT1                                                 02696000
JSCRSV13 EQU   JSCBSWT1                                                 02697000
JSCRSV12 EQU   JSCBSWT1                                                 02698000
JSCRSV11 EQU   JSCBSWT1                                                 02699000
JSCBPASS EQU   JSCBSWT1                                                 02700000
JSCBTTTR EQU   JSCBSEC1+52                                              02701000
JSCRSV10 EQU   JSCBSEC1+49                                              02702000
JSCBAUTH EQU   JSCBOPTS                                                 02703000
JSCSIOTS EQU   JSCBOPTS                                                 02704000
JSCRSV08 EQU   JSCBOPTS                                                 02705000
JSCRSV07 EQU   JSCBOPTS                                                 02706000
JSCRSV06 EQU   JSCBOPTS                                                 02707000
JSCBLONG EQU   JSCBOPTS                                                 02708000
JSCRSV05 EQU   JSCBOPTS                                                 02709000
JSCRSV04 EQU   JSCBOPTS                                                 02710000
JSCBSECB EQU   JSCBSEC1+44                                              02711000
JSCRSV03 EQU   JSCBSEC1+41                                              02712000
JSCBDCBA EQU   JSCBDCB+1                                                02713000
JSCRSV02 EQU   JSCBDCB                                                  02714000
JSCBID   EQU   JSCBSEC1+32                                              02715000
JSCBDBTB EQU   JSCBSEC1+28                                              02716000
JSCBIJSC EQU   JSCBSEC1+24                                              02717000
JSCBTCBP EQU   JSCBSEC1+20                                              02718000
JSCBPCC  EQU   JSCBSEC1+16                                              02719000
JSCBTCP  EQU   JSCBSEC1+12                                              02720000
JSCBSHR  EQU   JSCBSEC1+8                                               02721000
JSCHPCEA EQU   JSCHPCE+1                                                02722000
JSCRSV32 EQU   JSCHPCE                                                  02723000
JSCRSV01 EQU   JSCBSEC1                                                 02724000
@NM00009 EQU   IEZJSCB                                                  02725000
WPLMLTXT EQU   WPLML+4                                                  02726000
WPLMLLT2 EQU   WPLMLLTF+1                                               02727000
WPLRSV24 EQU   WPLMLLT1                                                 02728000
WPLRSV23 EQU   WPLMLLT1                                                 02729000
WPLRSV22 EQU   WPLMLLT1                                                 02730000
WPLRSV21 EQU   WPLMLLT1                                                 02731000
WPLMLLTD EQU   WPLMLLT1                                                 02732000
WPLMLLTC EQU   WPLMLLT1                                                 02733000
WPLMLLTB EQU   WPLMLLT1                                                 02734000
WPLMLLTA EQU   WPLMLLT1                                                 02735000
WPLMLLEN EQU   WPLML+1                                                  02736000
WPLML0   EQU   WPLML                                                    02737000
WPLLINES EQU   WPLLS01+3                                                02738000
WPLAREA  EQU   WPLLS01+2                                                02739000
WPLLTF2  EQU   WPLLTF+1                                                 02740000
WPLRSV20 EQU   WPLLTF1                                                  02741000
WPLRSV19 EQU   WPLLTF1                                                  02742000
WPLRSV18 EQU   WPLLTF1                                                  02743000
WPLRSV17 EQU   WPLLTF1                                                  02744000
WPLLTFD  EQU   WPLLTF1                                                  02745000
WPLLTFC  EQU   WPLLTF1                                                  02746000
WPLLTFB  EQU   WPLLTF1                                                  02747000
WPLLTFA  EQU   WPLLTF1                                                  02748000
WPLQID   EQU   WPLFLGS+6                                                02749000
WPLRSV32 EQU   WPLMSGT2                                                 02750000
WPLRSV31 EQU   WPLMSGT2                                                 02751000
WPLRSV30 EQU   WPLMSGT2                                                 02752000
WPLRSV29 EQU   WPLMSGT2                                                 02753000
WPLRSV28 EQU   WPLMSGT2                                                 02754000
WPLRSV27 EQU   WPLMSGT2                                                 02755000
WPLRSV26 EQU   WPLMSGT2                                                 02756000
WPLRSV25 EQU   WPLMSGT2                                                 02757000
WPLRSV16 EQU   WPLMSGT1                                                 02758000
WPLRSV15 EQU   WPLMSGT1                                                 02759000
WPLMSGTF EQU   WPLMSGT1                                                 02760000
WPLRSV14 EQU   WPLMSGT1                                                 02761000
WPLMSGTD EQU   WPLMSGT1                                                 02762000
WPLMSGTC EQU   WPLMSGT1                                                 02763000
WPLMSGTB EQU   WPLMSGT1                                                 02764000
WPLMSGTA EQU   WPLMSGT1                                                 02765000
WPLRSV13 EQU   WPLROUT2                                                 02766000
WPLROUTO EQU   WPLROUT2                                                 02767000
WPLROUTN EQU   WPLROUT2                                                 02768000
WPLROUTM EQU   WPLROUT2                                                 02769000
WPLROUTL EQU   WPLROUT2                                                 02770000
WPLROUTK EQU   WPLROUT2                                                 02771000
WPLROUTJ EQU   WPLROUT2                                                 02772000
WPLROUTI EQU   WPLROUT2                                                 02773000
WPLROUTH EQU   WPLROUT1                                                 02774000
WPLROUTG EQU   WPLROUT1                                                 02775000
WPLROUTF EQU   WPLROUT1                                                 02776000
WPLROUTE EQU   WPLROUT1                                                 02777000
WPLROUTD EQU   WPLROUT1                                                 02778000
WPLROUTC EQU   WPLROUT1                                                 02779000
WPLROUTB EQU   WPLROUT1                                                 02780000
WPLROUTA EQU   WPLROUT1                                                 02781000
WPLRSV12 EQU   WPLDESC2                                                 02782000
WPLRSV11 EQU   WPLDESC2                                                 02783000
WPLRSV10 EQU   WPLDESC2                                                 02784000
WPLRSV09 EQU   WPLDESC2                                                 02785000
WPLRSV08 EQU   WPLDESC2                                                 02786000
WPLRSV07 EQU   WPLDESC2                                                 02787000
WPLDESCJ EQU   WPLDESC2                                                 02788000
WPLDESCI EQU   WPLDESC2                                                 02789000
WPLDESCH EQU   WPLDESC1                                                 02790000
WPLDESCG EQU   WPLDESC1                                                 02791000
WPLDESCF EQU   WPLDESC1                                                 02792000
WPLDESCE EQU   WPLDESC1                                                 02793000
WPLDESCD EQU   WPLDESC1                                                 02794000
WPLDESCC EQU   WPLDESC1                                                 02795000
WPLDESCB EQU   WPLDESC1                                                 02796000
WPLDESCA EQU   WPLDESC1                                                 02797000
WPLTXTL  EQU   WPLTXT+125                                               02798000
@NM00008 EQU   WPLTXT                                                   02799000
WPLRSV05 EQU   WPLMCSF2                                                 02800000
WPLRSV04 EQU   WPLMCSF2                                                 02801000
WPLMCSFN EQU   WPLMCSF2                                                 02802000
WPLRSV03 EQU   WPLMCSF2                                                 02803000
WPLNOWTP EQU   WPLMCSF2                                                 02804000
WPLMCSFK EQU   WPLMCSF2                                                 02805000
WPLMCSFJ EQU   WPLMCSF2                                                 02806000
WPLMCSFI EQU   WPLMCSF2                                                 02807000
WPLMCSFG EQU   WPLMCSF1                                                 02808000
WPLMCSFF EQU   WPLMCSF1                                                 02809000
WPLMCSFE EQU   WPLMCSF1                                                 02810000
WPLMCSFC EQU   WPLMCSF1                                                 02811000
WPLMCSFA EQU   WPLMCSF1                                                 02812000
WPLLGH   EQU   WPL                                                      02813000
WPLRECB  EQU   WPLRF+4                                                  02814000
WPLRPTRA EQU   WPLRPTR+1                                                02815000
WPLRLN   EQU   WPLRPTR                                                  02816000
UCMPRSV2 EQU   UCMPEXTA+20                                              02817000
UCMPRSV1 EQU   UCMPDM1+8                                                02818000
UCMPNMCC EQU   UCMPDM1+4                                                02819000
UCMPWQE  EQU   UCMPDM1                                                  02820000
UCMPUCMP EQU   UCMPEXTA                                                 02821000
UCMFRSV3 EQU   UCMFEXTA+20                                              02822000
UCMF80WQ EQU   UCMFEXTA+18                                              02823000
UCMF60WQ EQU   UCMFEXTA+16                                              02824000
UCMFRSV2 EQU   UCMFMGFS+4                                               02825000
UCMFRSV1 EQU   UCMFMGFS+2                                               02826000
UCMFFLG2 EQU   UCMFMGFS+1                                               02827000
UCMFBR07 EQU   UCMFFLG1                                                 02828000
UCMFBR06 EQU   UCMFFLG1                                                 02829000
UCMFBR05 EQU   UCMFFLG1                                                 02830000
UCMFBR04 EQU   UCMFFLG1                                                 02831000
UCMFBR03 EQU   UCMFFLG1                                                 02832000
UCMFMSGN EQU   UCMFFLG1                                                 02833000
UCMFMSGA EQU   UCMFFLG1                                                 02834000
UCMFMSGE EQU   UCMFFLG1                                                 02835000
UCMFPPTR EQU   UCMFEXTA+4                                               02836000
UCMFUCMF EQU   UCMFEXTA                                                 02837000
UCMRCTA  EQU   UCMRCT+1                                                 02838000
UCMRSV31 EQU   UCMSDS5                                                  02839000
UCMSDS5G EQU   UCMSDS5                                                  02840000
UCMSDS5F EQU   UCMSDS5                                                  02841000
UCMRSV30 EQU   UCMSDS5                                                  02842000
UCMRSV29 EQU   UCMSDS5                                                  02843000
UCMSDS5C EQU   UCMSDS5                                                  02844000
UCMSDS5B EQU   UCMSDS5                                                  02845000
UCMSDS5A EQU   UCMSDS5                                                  02846000
UCMMLAST EQU   UCMLIST+64                                               02847000
UCMVHRSN EQU   UCMDEVC                                                  02848000
UCMDEVG  EQU   UCMDEVC                                                  02849000
UCMDEVF  EQU   UCMDEVC                                                  02850000
UCMDEVE  EQU   UCMDEVC                                                  02851000
UCMDEVD  EQU   UCMDEVC                                                  02852000
UCMDEVCC EQU   UCMDEVC                                                  02853000
UCMDEVB  EQU   UCMDEVC                                                  02854000
UCMDEVA  EQU   UCMDEVC                                                  02855000
UCMXOR   EQU   UCMLIST+62                                               02856000
UCMMSG2  EQU   UCMMSG+1                                                 02857000
UCMRSV27 EQU   UCMMSG1                                                  02858000
UCMRSV26 EQU   UCMMSG1                                                  02859000
UCMMSGF  EQU   UCMMSG1                                                  02860000
UCMMSGE  EQU   UCMMSG1                                                  02861000
UCMMSGD  EQU   UCMMSG1                                                  02862000
UCMMSGC  EQU   UCMMSG1                                                  02863000
UCMMSGB  EQU   UCMMSG1                                                  02864000
UCMMSGA  EQU   UCMMSG1                                                  02865000
UCMCOMPC EQU   UCMLIST+56                                               02866000
UCMWLAST EQU   UCMLIST+52                                               02867000
UCMOAOEN EQU   UCMLIST+48                                               02868000
UCMALTEN EQU   UCMLIST+44                                               02869000
UCMRV007 EQU   UCMDISP2                                                 02870000
UCMRV006 EQU   UCMDISP2                                                 02871000
UCMRV005 EQU   UCMDISP2                                                 02872000
UCMRV004 EQU   UCMDISP2                                                 02873000
UCMRV003 EQU   UCMDISP2                                                 02874000
UCMDISPK EQU   UCMDISP2                                                 02875000
UCMDISPJ EQU   UCMDISP2                                                 02876000
UCMDISPI EQU   UCMDISP2                                                 02877000
UCMDISPH EQU   UCMDISP1                                                 02878000
UCMDISPG EQU   UCMDISP1                                                 02879000
UCMDISPF EQU   UCMDISP1                                                 02880000
UCMDISPE EQU   UCMDISP1                                                 02881000
UCMDISPD EQU   UCMDISP1                                                 02882000
UCMDISPC EQU   UCMDISP1                                                 02883000
UCMDISPB EQU   UCMDISP1                                                 02884000
UCMDISPA EQU   UCMDISP1                                                 02885000
UCMAUTHB EQU   UCMAUTH+1                                                02886000
UCMRSV23 EQU   UCMAUTHA                                                 02887000
UCMRSV22 EQU   UCMAUTHA                                                 02888000
UCMRSV21 EQU   UCMAUTHA                                                 02889000
UCMRSV20 EQU   UCMAUTHA                                                 02890000
UCMRSV19 EQU   UCMAUTHA                                                 02891000
UCMAUTH3 EQU   UCMAUTHA                                                 02892000
UCMAUTH2 EQU   UCMAUTHA                                                 02893000
UCMAUTH1 EQU   UCMAUTHA                                                 02894000
UCMOUTQ  EQU   UCMLIST+36                                               02895000
UCMRSV18 EQU   UCMLIST+34                                               02896000
UCMXB    EQU   UCMLIST+28                                               02897000
@NM00007 EQU   UCMXA+1                                                  02898000
UCMID    EQU   UCMXA                                                    02899000
UCMRSV17 EQU   UCMATR                                                   02900000
UCMRSV16 EQU   UCMATR                                                   02901000
UCMAT04  EQU   UCMATR                                                   02902000
UCMLF    EQU   UCMATR                                                   02903000
UCMUF    EQU   UCMATR                                                   02904000
UCMXF    EQU   UCMATR                                                   02905000
UCMIF    EQU   UCMATR                                                   02906000
UCMOF    EQU   UCMATR                                                   02907000
UCMTC    EQU   UCMSTS                                                   02908000
UCMTD    EQU   UCMSTS                                                   02909000
UCMTB    EQU   UCMSTS                                                   02910000
UCMTA    EQU   UCMSTS                                                   02911000
UCMCF    EQU   UCMSTS                                                   02912000
UCMBF    EQU   UCMSTS                                                   02913000
UCMPF    EQU   UCMSTS                                                   02914000
UCMAF    EQU   UCMSTS                                                   02915000
UCMNAME  EQU   UCMLIST+16                                               02916000
UCMUCB   EQU   UCMLIST+12                                               02917000
UCMDCB   EQU   UCMLIST+8                                                02918000
UCMSBR   EQU   UCMLIST+4                                                02919000
UCMECB   EQU   UCMLIST                                                  02920000
UCMTPSAV EQU   UCMEXIT+208                                              02921000
UCMXTSAV EQU   UCMEXIT+136                                              02922000
UCMDESCD EQU   UCMEXIT+132                                              02923000
UCMROUTC EQU   UCMEXIT+128                                              02924000
UCMMSTXT EQU   UCMEXIT                                                  02925000
UCMDECBA EQU   UCMEIL+20                                                02926000
UCMOECBA EQU   UCMEIL+16                                                02927000
UCMAECBA EQU   UCMEIL+12                                                02928000
UCMXECBA EQU   UCMEIL+8                                                 02929000
UCMNIPTR EQU   UCMEIL+4                                                 02930000
UCMRSV15 EQU   UCMEIL+3                                                 02931000
UCMRTCT  EQU   UCMEIL+2                                                 02932000
UCMRPYL  EQU   UCMEIL+1                                                 02933000
@NM00006 EQU   UCMEIL                                                   02934000
UCMRSV60 EQU   UCM+302                                                  02935000
UCMRSV59 EQU   UCMRSV51                                                 02936000
UCMRSV58 EQU   UCMRSV51                                                 02937000
UCMRSV57 EQU   UCMRSV51                                                 02938000
UCMRSV56 EQU   UCMRSV51                                                 02939000
UCMRSV55 EQU   UCMRSV51                                                 02940000
UCMRSV54 EQU   UCMRSV51                                                 02941000
UCMRSV53 EQU   UCMRSV51                                                 02942000
UCMRSV52 EQU   UCMRSV51                                                 02943000
UCMRSV50 EQU   UCMRSV42                                                 02944000
UCMRSV49 EQU   UCMRSV42                                                 02945000
UCMRSV48 EQU   UCMRSV42                                                 02946000
UCMRSV47 EQU   UCMRSV42                                                 02947000
UCMRSV46 EQU   UCMRSV42                                                 02948000
UCMRSV45 EQU   UCMRSV42                                                 02949000
UCMRSV44 EQU   UCMRSV42                                                 02950000
UCMRSV43 EQU   UCMRSV42                                                 02951000
UCMJES3T EQU   UCM+296                                                  02952000
UCMWAKUP EQU   UCM+292                                                  02953000
UCMFRRAD EQU   UCM+288                                                  02954000
UCMSWCH  EQU   UCM+284                                                  02955000
UCMASCB  EQU   UCM+280                                                  02956000
UCMWQECP EQU   UCM+276                                                  02957000
UCMORECP EQU   UCM+272                                                  02958000
UCMOECBT EQU   UCM+268                                                  02959000
UCMOECBH EQU   UCM+264                                                  02960000
UCMWECBT EQU   UCM+260                                                  02961000
UCMWECBH EQU   UCM+256                                                  02962000
UCMMBEND EQU   UCM+252                                                  02963000
UCMCTID  EQU   UCM+250                                                  02964000
UCMRSV61 EQU   UCM+248                                                  02965000
UCMRP2AD EQU   UCM+244                                                  02966000
UCMCRAAD EQU   UCM+240                                                  02967000
UCMWQLM1 EQU   UCM+238                                                  02968000
UCMRV001 EQU   UCM+237                                                  02969000
UCMRQLM1 EQU   UCM+236                                                  02970000
UCMMBPTR EQU   UCM+232                                                  02971000
UCMMQNXT EQU   UCM+228                                                  02972000
UCMMQEND EQU   UCM+224                                                  02973000
UCMMQPTR EQU   UCM+220                                                  02974000
UCMTRECB EQU   UCM+216                                                  02975000
UCMMNECB EQU   UCM+212                                                  02976000
UCMMNTR  EQU   UCM+208                                                  02977000
UCMR9SV  EQU   UCM+204                                                  02978000
UCMSAVE4 EQU   UCM+140                                                  02979000
UCMSAVE3 EQU   UCM+84                                                   02980000
UCMINCR  EQU   UCM+71                                                   02981000
UCMMODEL EQU   UCM+70                                                   02982000
UCMCORE  EQU   UCM+69                                                   02983000
UCMFIX   EQU   UCMMODE                                                  02984000
UCMMCS   EQU   UCMMODE                                                  02985000
UCMOGCE  EQU   UCMMODE                                                  02986000
UCMAMFA  EQU   UCMMODE                                                  02987000
UCMRSV14 EQU   UCMMODE                                                  02988000
UCMTPUTA EQU   UCMMODE                                                  02989000
UCMNOCON EQU   UCMMODE                                                  02990000
UCMRSV11 EQU   UCMMODE                                                  02991000
UCMPXA   EQU   UCM+64                                                   02992000
UCMWQEND EQU   UCM+60                                                   02993000
UCMWQNR  EQU   UCM+58                                                   02994000
UCMRQNR  EQU   UCM+56                                                   02995000
UCMWQECB EQU   UCM+52                                                   02996000
UCMRQECB EQU   UCM+48                                                   02997000
UCMWQLM  EQU   UCM+46                                                   02998000
UCMRQLM  EQU   UCM+45                                                   02999000
@NM00005 EQU   UCMRPYI                                                  03000000
UCMRPYQ  EQU   UCM+28                                                   03001000
UCMWTOQ  EQU   UCM+24                                                   03002000
UCMLSTP  EQU   UCM+20                                                   03003000
UCMARECB EQU   UCM+16                                                   03004000
UCMLECB  EQU   UCMDECB                                                  03005000
UCMOECB  EQU   UCM+8                                                    03006000
UCMAECB  EQU   UCM+4                                                    03007000
UCMXECB  EQU   UCM                                                      03008000
UCMGMCNT EQU   UCMPRFX+158                                              03009000
UCMSDS2  EQU   UCMPRFX+157                                              03010000
UCMRSV09 EQU   UCMSDS1                                                  03011000
UCMRSV08 EQU   UCMSDS1                                                  03012000
UCMRSV07 EQU   UCMSDS1                                                  03013000
UCMRSV06 EQU   UCMSDS1                                                  03014000
UCMRSV05 EQU   UCMSDS1                                                  03015000
UCMRSV04 EQU   UCMSDS1                                                  03016000
UCMSDS1B EQU   UCMSDS1                                                  03017000
UCMSDS1A EQU   UCMSDS1                                                  03018000
UCMDTINT EQU   UCMPRFX+152                                              03019000
UCMLOGAD EQU   UCMPRFX+148                                              03020000
UCMNPECB EQU   UCMPRFX+144                                              03021000
UCMTPPTR EQU   UCMPRFX+140                                              03022000
UCMDOMRT EQU   UCMPRFX+136                                              03023000
UCMRUTCK EQU   UCMPRFX+132                                              03024000
UCMQRTN  EQU   UCMPRFX+128                                              03025000
UCM6WD   EQU   UCMXSA+20                                                03026000
UCM5WD   EQU   UCMXSA+16                                                03027000
UCM4WD   EQU   UCMXSA+12                                                03028000
UCM3WD   EQU   UCMXSA+8                                                 03029000
UCM2WD   EQU   UCMXSA+4                                                 03030000
UCM1WD   EQU   UCMXSA                                                   03031000
UCMRSV03 EQU   UCMPRFX+102                                              03032000
UCMUEXIT EQU   UCMPRFX+97                                               03033000
UCMXCT   EQU   UCMPRFX+96                                               03034000
UCMCMID  EQU   UCMPRFX+88                                               03035000
UCMOWTOR EQU   UCMPRFX+86                                               03036000
UCMRSV02 EQU   UCMSFLG2                                                 03037000
UCMSYSO  EQU   UCMSFLG2                                                 03038000
UCMSYSN  EQU   UCMSFLG2                                                 03039000
UCMSYSM  EQU   UCMSFLG2                                                 03040000
UCMSYSL  EQU   UCMSFLG2                                                 03041000
UCMSYSK  EQU   UCMSFLG2                                                 03042000
UCMSYSJ  EQU   UCMSFLG2                                                 03043000
UCMSYSI  EQU   UCMSFLG2                                                 03044000
UCMRSV35 EQU   UCMSFLG1                                                 03045000
UCMSYSF  EQU   UCMSFLG1                                                 03046000
UCMSYSE  EQU   UCMSFLG1                                                 03047000
UCMSYSD  EQU   UCMSFLG1                                                 03048000
UCMSYSC  EQU   UCMSFLG1                                                 03049000
UCMSYSB  EQU   UCMSFLG1                                                 03050000
UCMRSV01 EQU   UCMSFLG1                                                 03051000
UCMWTOX  EQU   UCMPRFX+80                                               03052000
UCMDOME  EQU   UCMPRFX+76                                               03053000
UCMSVR0  EQU   UCMSAVE0+68                                              03054000
UCMSVQ0  EQU   UCMSAVE0+64                                              03055000
UCMSVP0  EQU   UCMSAVE0+60                                              03056000
UCMSVO0  EQU   UCMSAVE0+56                                              03057000
UCMSVN0  EQU   UCMSAVE0+52                                              03058000
UCMSVM0  EQU   UCMSAVE0+48                                              03059000
UCMSVL0  EQU   UCMSAVE0+44                                              03060000
UCMSVK0  EQU   UCMSAVE0+40                                              03061000
UCMSVJ0  EQU   UCMSAVE0+36                                              03062000
UCMSVI0  EQU   UCMSAVE0+32                                              03063000
UCMSVH0  EQU   UCMSAVE0+28                                              03064000
UCMSVG0  EQU   UCMSAVE0+24                                              03065000
UCMSVF0  EQU   UCMSAVE0+20                                              03066000
UCMSVE0  EQU   UCMSAVE0+16                                              03067000
UCMSVD0  EQU   UCMSAVE0+12                                              03068000
UCMSVC0  EQU   UCMSAVE0+8                                               03069000
UCMSVB0  EQU   UCMSAVE0+4                                               03070000
UCMSVA0  EQU   UCMSAVE0                                                 03071000
UCMMCENT EQU   UCMPRFX                                                  03072000
UCM2FEXT EQU   UCM2EXT+12                                               03073000
UCM2STAA EQU   UCM2STA+1                                                03074000
UCMRV008 EQU   UCM2SFLG                                                 03075000
UCMRSV34 EQU   UCM2SFLG                                                 03076000
UCMRSV33 EQU   UCM2SFLG                                                 03077000
UCM2WTOI EQU   UCM2SFLG                                                 03078000
UCM2DSTR EQU   UCM2SFLG                                                 03079000
UCM2DTAK EQU   UCM2SFLG                                                 03080000
UCM2SENT EQU   UCM2SFLG                                                 03081000
UCM2SDWA EQU   UCM2SFLG                                                 03082000
UCM2PST  EQU   UCM2EXT+4                                                03083000
UCM2RID  EQU   UCM2EXT+2                                                03084000
UCM2WID  EQU   UCM2EXT                                                  03085000
RPLERMSA EQU   RPLCOMN+72                                               03086000
RPLEMLEN EQU   RPLCOMN+70                                               03087000
RPLACTIV EQU   RPLCOMN+69                                               03088000
RPLBRANC EQU   RPLEXTD1                                                 03089000
RPLNIB   EQU   RPLEXTD1                                                 03090000
@NM00004 EQU   RPLEXTD1                                                 03091000
RPLEXIT  EQU   RPLEXTD1                                                 03092000
RPLNEXIT EQU   RPLEXTD1                                                 03093000
RPLEXSCH EQU   RPLEXTD1                                                 03094000
RPLDDDD  EQU   RPLRBAR+4                                                03095000
@NM00003 EQU   RPLRBAR+3                                                03096000
@NM00002 EQU   RPLAIXID                                                 03097000
RPLAXPKP EQU   RPLAIXID                                                 03098000
RPLAIXPC EQU   RPLRBAR                                                  03099000
RPLRSV88 EQU   RPLOPT8                                                  03100000
RPLUNCON EQU   RPLOPT8                                                  03101000
RPLACTV  EQU   RPLOPT8                                                  03102000
RPLSESS  EQU   RPLOPT8                                                  03103000
RPLPEND  EQU   RPLOPT8                                                  03104000
RPLODPRM EQU   RPLOPT8                                                  03105000
RPLODACP EQU   RPLOPT8                                                  03106000
RPLODACQ EQU   RPLOPT8                                                  03107000
RPLRSV78 EQU   RPLOPT7                                                  03108000
RPLRSV77 EQU   RPLOPT7                                                  03109000
RPLRLSOP EQU   RPLOPT7                                                  03110000
RPLTPOST EQU   RPLOPT7                                                  03111000
RPLQOPT  EQU   RPLOPT7                                                  03112000
RPLCNIMM EQU   RPLCNOPT                                                 03113000
RPLCNANY EQU   RPLCNOPT                                                 03114000
RPLCNALL EQU   RPLCNOPT                                                 03115000
RPLRSV68 EQU   RPLOPT6                                                  03116000
RPLRSV67 EQU   RPLOPT6                                                  03117000
RPLLOCK  EQU   RPLOPT6                                                  03118000
RPLNCOND EQU   RPLOPT6                                                  03119000
RPLCOND  EQU   RPLOPT6                                                  03120000
RPLEOT   EQU   RPLUNTYP                                                 03121000
RPLEOM   EQU   RPLUNTYP                                                 03122000
RPLEOB   EQU   RPLUNTYP                                                 03123000
RPLWROPT EQU   RPLOPT5                                                  03124000
RPLNODE  EQU   RPLOPT5                                                  03125000
RPLERACE EQU   RPLWRTYP                                                 03126000
RPLEAU   EQU   RPLWRTYP                                                 03127000
RPLNERAS EQU   RPLWRTYP                                                 03128000
RPLPSOPT EQU   RPLOPT5                                                  03129000
RPLSSNIN EQU   RPLOPT5                                                  03130000
RPLDLGIN EQU   RPLOPT5                                                  03131000
RPLBUFL  EQU   RPLCOMN+52                                               03132000
RPLCHAIN EQU   RPLNXTRP                                                 03133000
RPLOPT4  EQU   RPLOPTCD+3                                               03134000
RPLALIGN EQU   RPLOPT3                                                  03135000
RPLFMT   EQU   RPLOPT3                                                  03136000
RPLFLD   EQU   RPLOPT3                                                  03137000
RPLVFY   EQU   RPLOPT3                                                  03138000
RPLBLK   EQU   RPLOPT3                                                  03139000
RPLSFORM EQU   RPLOPT3                                                  03140000
RPLEODS  EQU   RPLOPT3                                                  03141000
RPLNSP   EQU   RPLOPT2                                                  03142000
RPLUPD   EQU   RPLOPT2                                                  03143000
@NM00001 EQU   RPLOPT2                                                  03144000
RPLLRD   EQU   RPLOPT2                                                  03145000
RPLBWD   EQU   RPLOPT2                                                  03146000
RPLCNV   EQU   RPLOPT2                                                  03147000
RPLADD   EQU   RPLADR                                                   03148000
RPLKEY   EQU   RPLOPT2                                                  03149000
RPLECBIN EQU   RPLECBSW                                                 03150000
RPLGEN   EQU   RPLOPT1                                                  03151000
RPLKGE   EQU   RPLOPT1                                                  03152000
RPLASY   EQU   RPLOPT1                                                  03153000
RPLSKP   EQU   RPLOPT1                                                  03154000
RPLDIR   EQU   RPLOPT1                                                  03155000
RPLLOC   EQU   RPLOPT1                                                  03156000
RPLDAF   EQU   RPLARG+2                                                 03157000
RPLSAF   EQU   RPLARG                                                   03158000
RPLTCBPT EQU   RPLCOMN+28                                               03159000
RPLDACB  EQU   RPLCOMN+24                                               03160000
RPLCCHAR EQU   RPLCOMN+20                                               03161000
RPLSTRID EQU   RPLCOMN+18                                               03162000
RPLKEYL  EQU   RPLKEYLE                                                 03163000
RPLRDSOH EQU   RPLFDB3                                                  03164000
RPLRLG   EQU   RPLFDB3                                                  03165000
RPLLGFRC EQU   RPLFDB3                                                  03166000
RPLREOT  EQU   RPLFDB3                                                  03167000
RPLREOM  EQU   RPLFDB3                                                  03168000
RPLREOB  EQU   RPLFDB3                                                  03169000
RPLSV32  EQU   RPLFDB3                                                  03170000
RPLUINPT EQU   RPLFDB3                                                  03171000
RPLSTSAV EQU   RPLFDB2                                                  03172000
RPLCUERR EQU   RPLFDB2                                                  03173000
RPLDLGFL EQU   RPLFDB2                                                  03174000
RPLIOERR EQU   RPLFDB2                                                  03175000
RPLDVUNS EQU   RPLFDB2                                                  03176000
RPLATND  EQU   RPLFDB2                                                  03177000
RPLRVID  EQU   RPLFDB2                                                  03178000
RPLERLK  EQU   RPLFDB2                                                  03179000
RPLERREG EQU   RPLRTNCD                                                 03180000
RPLSTAT  EQU   RPLFDBWD                                                 03181000
RPLPOST  EQU   RPLECB                                                   03182000
RPLWAIT  EQU   RPLECB                                                   03183000
RPLPLHPT EQU   RPLCOMN+4                                                03184000
RPLLEN2  EQU   RPLLEN                                                   03185000
RPLSTYP  EQU   RPLIDWD+1                                                03186000
RPLID    EQU   RPLIDWD                                                  03187000
*                                      END UNREFERENCED COMPONENTS      03188000
@RC00148 EQU   @EL00001                                                 03189000
@RC00218 EQU   @EL00003                                                 03190000
@RC00237 EQU   @EL00004                                                 03191000
@RC00252 EQU   @EL00005                                                 03192000
@RF00261 EQU   @EL00006                                                 03193000
@RF00283 EQU   @EL00008                                                 03194000
@RC00293 EQU   @EL00009                                                 03195000
@RF00318 EQU   @EL00011                                                 03196000
@RC00324 EQU   @EL00011                                                 03197000
@RF00350 EQU   @EL00014                                                 03198000
@RC00352 EQU   @EL00014                                                 03199000
@RC00386 EQU   @EL00016                                                 03200000
@RC00245 EQU   @RC00237                                                 03201000
@RC00354 EQU   @RC00352                                                 03202000
@ENDDATA EQU   *                                                        03203000
         END   IGC0203E,(C'PLS1127',0701,77269)                         03204000
./  ADD  SSI=40350151,NAME=IKJ5803D
IKJ5803D CSECT                                                          00010020
*/*IKJ5803D:  CHART */                                                  00011020
*/*           E  IKJ5803D */                                            00015020
*********************************************************************** 00020020
*                                                                     * 00172002
* MODULE-NAME = IKJ5803D                                              * 00174002
*                                                                     * 00176002
* DESCRIPTIVE-NAME = OPERAND LENGTH CHECK ROUTINE                     * 00178002
*                                                                     * 00178402
* COPYRIGHT = N/A                                                     * 00178802
*                                                                     * 00179202
* STATUS = REL. 02.0                                                  * 00179602
*                                                                     * 00179702
* FUNCTION = THIS MODULE PERFORMS LENGTH CHECKING ON THE              * 00179802
*            SEND OPERAND.                                            * 00179902
*                                                                     * 00180002
*   OPERATION = DETERMINES IF THE COMMAND IMAGE LENGTH IS             * 00180102
*               GREATER THAN 124 CHARACTERS.  IF IT IS LESS           * 00183802
*               THAN OR EQUAL TO 124 CHARACTERS THE MODULE            * 00185802
*               BRANCHES TO IEE0803D (CSCB CREATION MODULE).          * 00186202
*                                                                     * 00186702
*               IF THE COMMAND IMAGE IS  GREATER THAN 124             * 00187102
*               CHARACTERS, THE OPERAND FIELD IS SCANNED FOR          * 00187202
*               A BLANK INDICATING THE END OF THE PARAMETER           * 00187302
*               FIELD.  IF THE BLANK IS IN A POSITION LESS            * 00187402
*               THAN OR EQUAL TO 124 CHARACTERS, THEN THE             * 00187502
*               CHARACTERS TO THE RIGHT OF THE BLANK ARE              * 00187602
*               CONSIDERED AS COMMENTS.  IF IN FACT THE               * 00188002
*               PARAMETER FIELD OF THE COMMAND IS FOUND TO            * 00188402
*               BE GREATER THAN 124 CHARACTERS; THAT IS, A            * 00188802
*               BLANK (DELIMITER) WAS NOT FOUND, THE MODULE           * 00188902
*               BRANCHES TO IEE0503D TO ISSUE AN ERROR                * 00189002
*               MESSAGE INDICATING THE COMMAND LENGTH                 * 00189102
*               EXCEEDED THE MAXIMUM ALLOWABLE.                       * 00189302
*                                                                     * 00189702
* NOTES = N/A                                                         * 00189902
*                                                                     * 00190102
*   DEPENDENCIES = N/A                                                * 00190502
*                                                                     * 00190902
*     CHARACTER-CODE-DEPENDENCIES = NONE                              * 00191102
*                                                                     * 00191502
*   RESTRICTIONS = NONE                                               * 00191902
*                                                                     * 00192302
*   REGISTER-CONVENTIONS = SEE "REGISTER EQUATES"                     * 00192402
*                                                                     * 00192502
*   PATCH-LABEL = PTCHAREA (50 BYTES)                                 * 00192702
*                                                                     * 00193102
* MODULE-TYPE = PROCEDURE                                             * 00193502
*                                                                     * 00193902
*   PROCESSOR = ASSEMBLER                                             * 00194002
*                                                                     * 00194102
*   MODULE-SIZE - APPROXIMATELY 300 DECIMAL BYTES                     * 00194402
*                                                                     * 00194802
*   ATTRIBUTES = REUSABLE                                             * 00194902
*                                                                     * 00195002
* ENTRY-POINT = IKJ5803D                                              * 00195102
*                                                                     * 00195202
*   PURPOSE = THIS MODULE IS ENTERED TO LENGTH CHECK THE              * 00195302
*             OPERAND ON A SEND COMMAND.                              * 00195402
*                                                                     * 00195502
*   LINKAGE = BRANCH FROM THE ROUTING ROUTINE IN SVC 34               * 00195602
*                                                                     * 00195702
*   INPUT = NONE                                                      * 00196102
*                                                                     * 00196202
*   REGISTERS-SAVED = NONE                                            * 00196302
*                                                                     * 00196702
*   REGISTER-USAGE = SEE "REGISTER EQUATES" BELOW                     * 00197102
*                                                                     * 00197202
*   REGISTERS-RESTORED = NONE                                         * 00197302
*                                                                     * 00197402
* EXIT-NORMAL = IEE0803D (CSCB CREATION MODULE)                       * 00197502
*                                                                     * 00197602
*   CONDITION = MODULE IKJ5803D BRANCHES TO IEE0803D AFTER            * 00197702
*               DETERMINING THAT THE OPERAND LENGTH IS WITHIN         * 00197802
*               THE VALID RANGE.                                      * 00197902
*                                                                     * 00198002
*   OUTPUT = REGISTER 2 POINTS TO THE EXTENDED SAVE AREA              * 00198102
*            WHICH HAS NOT BEEN ALTERED FORM INPUT TIME.              * 00198502
*                                                                     * 00199502
*   RETURN-CODE = N/A                                                 * 00199602
*                                                                     * 00199702
* EXIT-ERROR = IEE0503D (MESSAGE MODULE)                              * 00199802
*                                                                     * 00200202
*   CONDITION = MODULE IKJ5803D BRANCHES TO IEE0503D AFTER            * 00200302
*               DETERMINING THAT THE OPERAND LENGTH IS NOT            * 00200502
*               WITHIN THE VALID RANGE.                               * 00200902
*                                                                     * 00201302
*   OUTPUT = REGISTER 2 POINTS TO THE EXTENDED SAVE AREA              * 00201502
*            CONTAINING:                                              * 00201902
*             .  THE XAE FIELD OF THE XSA CONTAINS THE MSG            * 00203602
*                INDEX, AND THE OTHER XSA FIELDS WILL REMAIN          * 00204002
*                AS THEY WERE AT INPUT.                               * 00204202
*                                                                     * 00204802
*   RETURN-CODE = N/A                                                 * 00205002
*                                                                     * 00205202
* EXIT-ERROR = CALLER                                                 * 00205402
*                                                                     * 00205602
*   CONDITION = FOR ERRORS OTHER THAN FOR LENGTH CHECKING,            * 00205802
*               THIS MODULE WILL RETURN TO ITS CALLER.                * 00206002
*                                                                     * 00206302
*   OUTPUT = NONE                                                     * 00208302
*                                                                     * 00208702
*   RETURN-CODE = N/A                                                 * 00209102
*                                                                     * 00209502
* EXTERNAL-REFERENCES = NONE                                          * 00209902
*                                                                     * 00210302
*   ROUTINES = NONE                                                   * 00210702
*                                                                     * 00211102
*   DATA-AREAS = XSA                                                  * 00211502
*                                                                     * 00211902
*   CONTROL-BLOCKS = NONE                                             * 00212302
*                                                                     * 00212402
* TABLES = MESSAGE AREA TABLE                                         * 00212602
*                                                                     * 00213002
* MACROS = NONE                                                       * 00213102
*                                                                     * 00213202
*   SERIALIZATION = NONE                                              * 00213502
*                                                                     * 00213902
* CHANGE-ACTIVITY = Y02676                                            * 00214302
*                                                                     * 00214402
* MESSAGES = MESSAGE ''IEE908I 'COMMAND NAME' CMD LENGTH              * 00214502
*            EXCEED MAX'' WILL BE ISSUED BY IEE0503D WHEN             * 00214802
*            THE OPERAND EXCEEDS THE SPECIFIED LENGTH.                * 00215202
*                                                                     * 00216402
* ABEND-CODES = NONE                                                  * 00216702
*                                                                     * 00217002
*********************************************************************** 00217302
        TITLE 'IKJ5803D - DETERMINE LENGTH OF SEND OPERAND BUFFER'      00217602
*                                                                       00217902
*********************************************************************** 00218202
*              REGISTER EQUATES                                       * 00218502
*********************************************************************** 00218802
REG0     EQU   0                       UNUSED                           00219102
REG1     EQU   1                       PTR TO PARM LIST                 00219402
REG2     EQU   2                       BASE REGISTER FOR IEEXSA         00219702
REG3     EQU   3                       CONTAINS MAX LENGTH OF OPERAND   00220002
*                                      FIELD                            00220802
RND      EQU   4                       LENGTH OF COMMAND OPERAND FIELD  00222002
QCTR     EQU   5                       QUOTE COUNTER                    00223202
REG6     EQU   6                       PTR TO OPERAND FIELD             00224402
REG7     EQU   7                       UNUSED                           00225602
REG8     EQU   8                       INCREMENT REGISTER               00226802
REG9     EQU   9                       COMPARAND FOR BXH                00228002
REGA     EQU   10                      BASE REGISTER FOR CSECT          00229202
REGB     EQU   11                      UNUSED                           00230402
REGC     EQU   12                      UNUSED                           00231602
REGD     EQU   13                      POINTER TO BRANCH NAME    Y02676 00232802
REGF     EQU   15                      POINTER TO BRANCH ADDRESS Y02676 00234002
N0       EQU   0                                                        00235202
ONE      EQU   1                       INCREMENT FOR BXH                00236402
N1       EQU   1                       DISPLACEMENT TO LENGTH OF BUFFER 00237602
N4       EQU   4                                                        00238802
N8       EQU   8                                                        00240020
N16      EQU   16                      DISPLACEMENT TO CVT              00250020
N57      EQU   57                      MSG CODE INDEX FOR 0503D         00252002
N96      EQU   96                      DISPLACEMENT TO XSA FROM THE RB  00260020
MAX      EQU   124                     MAX LENGTH OF OPERAND BUFFER     00260420
BLANK    EQU   X'40'                                                    00260820
*/*           P  SET ADDRESSIBILITY FOR CSECT */                        00261020
         BALR  REGA,N0                 SET UP ADDRESSIBILITY FOR CSECT  00270020
         USING *,REGA                                                   00280020
         MODID  BRANCH=YES                                      Y01886  00282001
*/*         P     SET ADDRESSIBILITY FOR EXTENDED SAVE AREA */          00288820
         USING MXSA,REG2               SET ADDRESSIBILITY FOR IEEXSA    00350020
         LA    REG3,MAX                GET MAX LENGTH OF OP FIELD M1586 00350120
         L     REG1,XAR                GET PTR TO PARM LIST       M1586 00350420
         LH    RND,N0(REG1)            GET LENGTH OF BUFFER       M1586 00350820
         AR    RND,REG1                COMPUTE END OF BUFFER ADDR M1586 00350920
         L     REG6,XAL                GET PTR TO OPERAND FIELD   M1586 00355720
         LA    REG6,N0(REG6)           CLEAR HI ORDER BYTE        M1586 00356120
         LTR   REG6,REG6               TEST FOR NO OPERAND       YM4710 00356602
         BZ    B803D                   NO OPERAND PRESENT        YM4710 00357102
BKSCAN   EQU   *                       START OF BACK SCAN LOOP   YM4710 00357302
         BCTR  RND,N0                  DECREMENT THE BUFFER END  YM4710 00357502
         CLI   N0(RND),BLANK           COMPARE LAST CHAR TO BLANKYM4710 00358502
         BNE   BUFEND                  NONBLANK--END OF OPERAND  YM4710 00359802
         CR    REG6,RND                END = START OF OPERAND    YM4710 00360402
         BC    8,B803D                 BLANK OPERAND--VALID OPER YM4710 00361002
         B     BKSCAN                  END CHAR IS BLANK--BACKUP YM4710 00361602
BUFEND   EQU   *                       END OF OPERAND FOUND      YM4710 00362202
         LA    RND,ONE(RND)            FIRST BLANK AFTER OPERAND YM4710 00362502
         SR    RND,REG6                COMPUTE LENGTH OF OPERAND FIELD  00362802
         CR    RND,REG3                IS LENGTH < OR = TO 124?   M1586 00363402
         BNH   B803D                   GO TO BRANCH TO IEE803D   Y02676 00364002
         SR    QCTR,QCTR               INITIALIZE QUOTE COUNTER TO ZERO 00365602
*                                                                 M1586 00366402
*/*           P  SCAN BUFFER FOR A BLANK (DELIMITER) */                 00368002
         LA    REG8,ONE                SET INCREMENT              M1586 00368802
         LR    REG9,REG6               LOAD PTR TO BEG OF OPERAND FIELD 00370402
*                                                                 M1586 00371202
         LA    REG9,MAX-ONE(REG9)      CALCULATE MAX BUFFER ADDR  M1586 00372802
TEST1    EQU   *                                                  M1586 00373602
*/*TEST1:     D  (YES,,NO,CKBLANK) IS THIS A QUOTE? */                  00375202
         CLI   N0(REG6),C''''          IS THIS CHAR A QUOTE?      M1586 00376002
         BNE   CKBLANK                 NO,CHECK FOR A BLANK       M1586 00377602
*/*           P  (,INCRE) FLIP SWITCH */                                00378402
         X     QCTR,SW                 YES, FLIP SWITCH           M1586 00380002
         B     INCREMNT                BRANCH TO CHECK NEXT CHAR  M1586 00380802
*/*CKBLANK:   D  (YES,,NO,INCRE) IS THIS A BLANK? */                    00382402
CKBLANK  EQU   *                                                  M1586 00383202
         CLI   N0(REG6),BLANK          IS THIS CHAR A BLANK?      M1586 00384802
         BNE   INCREMNT                NO, CHECK NEXT CHAR        M1586 00385602
*/*           D  (YES,B803D,NO,) EVEN NO. OF QUOTES? */          Y02676 00387202
         LTR   QCTR,QCTR               IS QUOTE COUNT EVEN?       M1586 00388002
         BZ    B803D                   GO TO BRANCH TO 803D      Y02676 00388802
*/*INCRE:     P  CHECK NEXT CHARACTER */                                00389802
INCREMNT EQU   *                                                  M1586 00392002
*/*           D  (NO,TEST1,YES,) END OF BUFFER? */                      00392802
         BXLE  REG6,REG8,TEST1         CHECK FOR END OF BUFFER    M1586 00393602
         CLI   N0(REG6),BLANK          IS CHAR 125 A BLANK?       M1586 00395602
         BNE   B0503D                  BRANCH TO SET UP ERR MSG  Y02676 00396602
*/*           D  (YES,B803D,NO,) EVEN NO. QUOTES? */             Y02676 00397602
         LTR   QCTR,QCTR               IS QUOTE COUNTER EVEN?     M1586 00398602
         BZ    B803D                   YES, GO TO B803D          Y02676 00399602
*/*B0503D:    P  (,BRCONT) SET UP FOR ERROR MSG */               Y02676 00401002
B0503D   EQU   *                                                 Y02676 00402002
         MVI   XAE,N57                 SET MSG INDEX FOR 0503D    M1586 00403002
         L     REGF,BCH0503D           LOAD REG 15 FOR BRANCH    Y02676 00404002
         B     BRCONT                  BRANCH TO SET UP XSA       M1586 00405002
*/*B803D:     P  SET UP FOR BRANCH TO IEE0803D */                Y02676 00406002
B803D    EQU   *                                                 Y02676 00407002
         L     REGF,BRCH803D           LOAD REG 15 FOR BRANCH    Y02676 00408002
*/*BRCONT: R GO TO IEE0803D OR IEE0503D TO CONTINUE */           Y02676 00409002
BRCONT   EQU   *                                                 Y02676 00412402
         BCR   15,REGF                 BR TO CONTINUE PROCESSING Y02676 00414002
BRCH803D DC    V(IEE0803D)             BRANCH ADDRESS            Y02676 00432402
BCH0503D DC    V(IEE0503D)             BR ADDRESS FOR ERROR PATH Y02676 00432802
ZERO     DC    F'0'                                               M1586 00434020
SW       DC    F'1'                                               M1586 00436020
MXSA     DSECT                                                          00440020
         IEEXSA                                                         00450020
PTCHAREA DC  CL50'***************PATCH AREA FOR IKJ5803D************'   00450402
*                                                                Y02676 00450502
*/*IKJ5803D:  END END OF IKJ5803D */                                    00451020
         END                                                            00460020
