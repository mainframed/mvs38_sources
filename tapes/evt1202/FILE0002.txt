./  ADD  SSI=83360312,NAME=ISTCC010
         TITLE 'ISTCC010,OLT SCHEDULER'                                 00001000
ISTCC010 CSECT ,                                                   0001 00002000
@MAINENT DS    0H                                                  0001 00003000
         USING *,@15                                               0001 00004000
         B     @PROLOG                                             0001 00005000
         DC    AL1(16)                                             0001 00006000
         DC    C'ISTCC010  78.336'                                 0001 00007000
         DROP  @15                                                      00008000
@PROLOG  STM   @14,@12,12(@13)                                     0001 00009000
         BALR  @12,0                                               0001 00010000
@PSTART  DS    0H                                                  0001 00011000
         USING @PSTART,@12                                         0001 00012000
*   SVECC010(2)=R13;                /* POINT TO PREVIOUS SAVEAREA    */ 00013000
         ST    R13,SVECC010+4(,WAPTR)                              0043 00014000
*   BACKSAVE(3)=ADDR(SVECC010);     /* PUT IN FORWARD SAVE LINK      */ 00015000
         LA    @03,SVECC010(,WAPTR)                                0044 00016000
         ST    @03,BACKSAVE+8(,R13)                                0044 00017000
*   R13=ADDR(SVECC010);             /* POINT TO INTERNALLY USED      */ 00018000
*                                                                  0045 00019000
         LR    R13,@03                                             0045 00020000
*   /*****************************************************************/ 00021000
*   /*                                                               */ 00022000
*   /* DETERMINE THE TYPE OF SCHEDULING THAT IS TO BE PERFORMED FOR  */ 00023000
*   /* THIS CALL. NORMAL PROCESSING WILL CONTINUE THROUGH THIS IF    */ 00024000
*   /* TEST. TRANSFER IS TAKEN TO TERMINATE THE ACTIVE OLT.          */ 00025000
*   /*                                                               */ 00026000
*   /*****************************************************************/ 00027000
*                                                                  0046 00028000
*   IF R0¬=0 THEN                                                  0046 00029000
         LTR   R0,R0                                               0046 00030000
         BNZ   @RT00046                                            0046 00031000
*     GO TO C10C0005;               /* IS REQUEST TO TERM OLT?       */ 00032000
*   $RUNTEST(1:LENGTH($FAMILY))=$FAMILY;/* SET BEGINNING OF SEC      */ 00033000
*                                                                  0048 00034000
         MVC   $RUNTEST(5,WAPTR),$FAMILY(WAPTR)                    0048 00035000
*   /*****************************************************************/ 00036000
*   /*                                                               */ 00037000
*   /* BEGINNING OF THE TEST LOOP. THE VALUES OF THE TEST LOOP THAT  */ 00038000
*   /* CAN BE ENTERED ARE, NTL ($TLCNT=1), TL ($TLCNT=500), TL(N)    */ 00039000
*   /* WHERE N MUST BE GREATER THAN ZERO AND LESS THAN 36768         */ 00040000
*   /* ($TLCNT=N)                                                    */ 00041000
*   /*                                                               */ 00042000
*   /*****************************************************************/ 00043000
*                                                                  0049 00044000
*   DO $CTLCNT=1 TO $TLCNT;         /* LOOP FOR NUMBER OF TIME       */ 00045000
*                                                                  0049 00046000
         LA    @03,1                                               0049 00047000
         B     @DE00049                                            0049 00048000
@DL00049 DS    0H                                                  0050 00049000
*     /***************************************************************/ 00050000
*     /*                                                             */ 00051000
*     /* STEP THROUGH THE TEST TABLE, RESETING ALL SEC. FLAGS EXCEPT */ 00052000
*     /* THE FLAG THAT SAYS THERE IS NO WAY THAT THIS SECTION WOULD  */ 00053000
*     /* EVER RUN                                                    */ 00054000
*     /*                                                             */ 00055000
*     /***************************************************************/ 00056000
*                                                                  0050 00057000
*     DO I=1 TO $TSTCNT;            /* CLEAR SECTION FLAGS           */ 00058000
         LA    I,1                                                 0050 00059000
         B     @DE00050                                            0050 00060000
@DL00050 DS    0H                                                  0051 00061000
*       $SECFLGS(I)=$SECFLGS(I)&'40'X;/* LEAVE ON $CANTRUN           */ 00062000
         LR    @15,I                                               0051 00063000
         SLA   @15,2                                               0051 00064000
         ALR   @15,WAPTR                                           0051 00065000
         NI    $SECFLGS-4(@15),X'40'                               0051 00066000
*     END;                          /* END OF SECTION TBL CLEAR      */ 00067000
*                                                                  0052 00068000
         AL    I,@CF00072                                          0052 00069000
@DE00050 CH    I,$TSTCNT(,WAPTR)                                   0052 00070000
         BNH   @DL00050                                            0052 00071000
*     /***************************************************************/ 00072000
*     /*                                                             */ 00073000
*     /* BEGINNING OF THE DEVICE LOOP. THE VALUES OF THE DEVICE COUNT*/ 00074000
*     /* ARE FOR .NDR ($DEVCNTS=3), AND FOR N DEVICES ENTERED IN THE */ 00075000
*     /* DEVICE FIELD ($DEVCNTS=N+2). THE FIRST TWO POSITIONS ARE    */ 00076000
*     /* ALWAYS RESERVED FOR THE CONTROL TERMINAL AND THE ALTERNATE  */ 00077000
*     /* PRINTER, RESPECTIVELY. THE MAP OF THE CDS IS EQUATED TO THE */ 00078000
*     /* CURRENT ENTRY IN THE DEVICE FIELD, SINCE DEVICE DECODE PUT  */ 00079000
*     /* THE FIRST 20 BYTES THERE.                                   */ 00080000
*     /*                                                             */ 00081000
*     /***************************************************************/ 00082000
*                                                                  0053 00083000
*     RESPECIFY                                                    0053 00084000
*       CDSMAP BASED(ADDR($DEVTBLE($CDEVPT)));                     0053 00085000
*     DO $CDEVPT=3 TO $DEVCNTS;     /* BEGINNING OF DEVICE LOOP      */ 00086000
         LA    @03,3                                               0054 00087000
         B     @DE00054                                            0054 00088000
@DL00054 DS    0H                                                  0055 00089000
*       $PASSONA=$PASSONA&&$PASSONA;/* ZERO PASS ON AREA             */ 00090000
         XC    $PASSONA(56,WAPTR),$PASSONA(WAPTR)                  0055 00091000
*       SCTCDS=CDSMAP;              /* FILL IN SCT WITH PRIMARY DATA */ 00092000
         LH    @03,$CDEVPT(,WAPTR)                                 0056 00093000
         MH    @03,@CH00329                                        0056 00094000
         LA    @03,$DEVTBLE-68(@03,WAPTR)                          0056 00095000
         MVC   SCTCDS(20,WAPTR),CDSMAP(@03)                        0056 00096000
*       $SYMBOLC='';                /* BLANK OUT SYMBOLIC NAME       */ 00097000
         MVI   $SYMBOLC(WAPTR),C' '                                0057 00098000
         MVC   $SYMBOLC+1(7,WAPTR),$SYMBOLC(WAPTR)                 0057 00099000
*       $PRIMADR=NDRNME;            /* ASSUME .NDR ENTRY             */ 00100000
*                                                                  0058 00101000
         MVC   $PRIMADR(4,WAPTR),@CC00674                          0058 00102000
*       /*************************************************************/ 00103000
*       /*                                                           */ 00104000
*       /* IF .NDR WAS ENTERED, THE FIRST SECTION IS NOW READY TO    */ 00105000
*       /* RECEIVE CONTROL.                                          */ 00106000
*       /*                                                           */ 00107000
*       /*************************************************************/ 00108000
*                                                                  0059 00109000
*       IF $NDR='1'B THEN                                          0059 00110000
         TM    $NDR(WAPTR),B'00100000'                             0059 00111000
         BO    @RT00059                                            0059 00112000
*         GO TO C10C0004;           /* IF NDR,ALL SET                */ 00113000
*                                                                  0060 00114000
*       /*************************************************************/ 00115000
*       /*                                                           */ 00116000
*       /* CONVERT UNIT ADDRESS FROM HEX (FIRST 4 BYTES OF CDS) TO   */ 00117000
*       /* EBCDIC (4 BYTES). ITACONV FROM(CDSUA)TO($PRIMADR) INVOKED */ 00118000
*       /*                                                           */ 00119000
*       /*************************************************************/ 00120000
*                                                                  0061 00121000
*       DCL                                                        0061 00122000
*        (ITATCF,                                                  0061 00123000
*         ITATCT) CHAR(*) BASED;    /* GENERATE WORK VARABLES        */ 00124000
         ST    @03,@TF00001                                        0061 00125000
*       DCL                                                        0062 00126000
*         ITATCTS FIXED;            /* TEMP SPOT FOR ALTERED BYTE    */ 00127000
*       RFY                                                        0063 00128000
*         ITATCF BASED(ADDR(CDSUA));/* MAP VARIABLE OVER FROM        */ 00129000
*       RFY                                                        0064 00130000
*         ITATCT BASED(ADDR($PRIMADR));/* MAP VARIBABLE OVER TO      */ 00131000
*       ITATCTS=ITATCT(LENGTH($PRIMADR)+1:LENGTH($PRIMADR)+1);/* SAVE   00132000
*                                      BYTE PAST TO FIELD            */ 00133000
         LA    @15,1598                                            0065 00134000
         ALR   @15,WAPTR                                           0065 00135000
         SLR   ITATCTS,ITATCTS                                     0065 00136000
         IC    ITATCTS,ITATCT+4(,@15)                              0065 00137000
*       UNPK(ITATCT(1:LENGTH($PRIMADR)+1),ITATCF(1:LENGTH(CDSUA)+1));   00138000
         L     @14,@TF00001                                        0066 00139000
         UNPK  ITATCT(5,@15),ITATCF(5,@14)                         0066 00140000
*                                   /* EXPAND HEX TO EBCDIC          */ 00141000
*       TR(ITATCT(1:LENGTH($PRIMADR)),$TRTBL);/* CONVERT FA-FF TO  0067 00142000
*                                      C1-C6                         */ 00143000
         L     @14,RCAPTR(,WAPTR)                                  0067 00144000
         L     @14,$TRTBLA(,@14)                                   0067 00145000
         TR    ITATCT(4,@15),$TRTBL(@14)                           0067 00146000
*       ITATCT(LENGTH($PRIMADR)+1:LENGTH($PRIMADR)+1)=ITATCTS;/*   0068 00147000
*                                      RESTORE BYTE PAST TO FIELD    */ 00148000
         STC   ITATCTS,ITATCT+4(,@15)                              0068 00149000
*       IF CDSREMSY='1'B THEN                                      0069 00150000
         L     @03,@TF00001                                        0069 00151000
         TM    CDSREMSY(@03),B'00000010'                           0069 00152000
         BNO   @RF00069                                            0069 00153000
*         $SYMBOLC=CDSSYMBN;        /* SET SYMB. NAME                */ 00154000
*                                                                  0070 00155000
         L     @03,@TF00001                                        0070 00156000
         MVC   $SYMBOLC(8,WAPTR),CDSSYMBN(@03)                     0070 00157000
*       /*************************************************************/ 00158000
*       /*                                                           */ 00159000
*       /* DETERMINE IF THE DEVICE CANNOT BE USED. IF IT WAS         */ 00160000
*       /* PREVIOUSLY LETGO, OR THE BIT IN THE CDS INDICATES IT      */ 00161000
*       /* CANNOT BE A PRIMARY DEVICE, GO TO THE NEXT DEVICE.        */ 00162000
*       /*                                                           */ 00163000
*       /*************************************************************/ 00164000
*                                                                  0071 00165000
*       IF CDSNTPRI='1'B|$LETGO($CDEVPT)='1'B|$ACQRED($CDEVPT)='0'B|    00166000
*           $NOTDEV($CDEVPT)='1'B THEN                             0071 00167000
@RF00069 LA    @03,68                                              0071 00168000
         LR    @15,@03                                             0071 00169000
         MH    @15,$CDEVPT(,WAPTR)                                 0071 00170000
         LA    @14,$DEVTBLE-68(@15,WAPTR)                          0071 00171000
         TM    CDSNTPRI(@14),B'10000000'                           0071 00172000
         BO    @RT00071                                            0071 00173000
         ST    @15,@TF00001                                        0071 00174000
         ALR   @15,WAPTR                                           0071 00175000
         TM    $LETGO-68(@15),B'10000000'                          0071 00176000
         BO    @RT00071                                            0071 00177000
         LR    @01,WAPTR                                           0071 00178000
         AL    @01,@TF00001                                        0071 00179000
         TM    $NOTDEV-68(@01),B'10000000'                         0071 00180000
         BNZ   @RT00071                                            0071 00181000
         TM    $ACQRED-68(@01),B'01000000'                         0071 00182000
         BNO   @RT00071                                            0071 00183000
*         GO TO C10C0008;           /* SKIP IF IT CANNOT BE USED AS     00184000
*                                      PRIMARY DEV                   */ 00185000
*       $PRIMARY($CDEVPT)='1'B;     /* MARK DEVICE PRIMARY           */ 00186000
         LR    @01,WAPTR                                           0073 00187000
         AL    @01,@TF00001                                        0073 00188000
         OI    $PRIMARY-68(@01),B'00000001'                        0073 00189000
*       $CDSFLGS=CDSFLAG;           /* PUT CDS FLAGS IN SCT          */ 00190000
*                                                                  0074 00191000
         MH    @03,$CDEVPT(,WAPTR)                                 0074 00192000
         LA    @03,$DEVTBLE-68(@03,WAPTR)                          0074 00193000
         MVC   $CDSFLGS(1,WAPTR),CDSFLAG(@03)                      0074 00194000
*       /*************************************************************/ 00195000
*       /*                                                           */ 00196000
*       /* BEGINNING OF THE SECTION LOOP. THE VALUES OF THE SECTION  */ 00197000
*       /* COUNT ARE THE EXACT NUMBER OF SECTIONS ENTERED. IF A RANGE*/ 00198000
*       /* WAS ENTERED, ONE ENTRY FOR EACH SECTION WILL APPEAR IN THE*/ 00199000
*       /* TABLE. THE FLAG BYTE IS MOVED FROM THE SECTION TABLE SO   */ 00200000
*       /* ALL TOLTEP MODULES CAN ACCESS IT EASIER. AT THE END OF THE*/ 00201000
*       /* SECTION THE FLAGS ARE MOVED BACK INTO THE TABLE.          */ 00202000
*       /*                                                           */ 00203000
*       /*************************************************************/ 00204000
*                                                                  0075 00205000
*C10C0004:                                                         0075 00206000
*       DO $CTSTPT=1 TO $TSTCNT;    /* SCHED. TESTS                  */ 00207000
C10C0004 LA    @03,1                                               0075 00208000
         B     @DE00075                                            0075 00209000
@DL00075 DS    0H                                                  0076 00210000
*         $TESTSUF=$SECLST($CTSTPT);/* BUILD NAME                    */ 00211000
         LH    @03,$CTSTPT(,WAPTR)                                 0076 00212000
         SLA   @03,2                                               0076 00213000
         ST    @03,@TF00001                                        0076 00214000
         ALR   @03,WAPTR                                           0076 00215000
         MVC   $TESTSUF(3,WAPTR),$SECLST-4(@03)                    0076 00216000
*         $TESTFLG=$SECFLGS($CTSTPT);/* COPY FLAGS                   */ 00217000
*                                                                  0077 00218000
         LR    @03,WAPTR                                           0077 00219000
         AL    @03,@TF00001                                        0077 00220000
         MVC   $TESTFLG(1,WAPTR),$SECFLGS-4(@03)                   0077 00221000
*         /***********************************************************/ 00222000
*         /*                                                         */ 00223000
*         /* IF THIS SECTION HAS BEEN MARKED AS NOT USEABLE (DUE TO  */ 00224000
*         /* NOT BEING FOUND, OR WRITTEN FOR THE WRONG ARCHITECTURE) */ 00225000
*         /* OR IF IT HAS SET THE $FINAL FIT IN THE SECTION CONTROL  */ 00226000
*         /* TABLE ON A PREVIOUS EXECUTION, THE SECTION IS SKIPPED.  */ 00227000
*         /*                                                         */ 00228000
*         /***********************************************************/ 00229000
*                                                                  0078 00230000
*         IF $FINAL='1'B|$CANTRUN='1'B THEN                        0078 00231000
         TM    $FINAL(WAPTR),B'11000000'                           0078 00232000
         BNZ   @RT00078                                            0078 00233000
*           GO TO C10C0007;         /* SKIP SECTION IF SHOULD'T RUN  */ 00234000
*         LDRNAME=$RUNTEST;         /* PUT IN MODULE NAME            */ 00235000
         MVC   LDRNAME(8),$RUNTEST(WAPTR)                          0080 00236000
*         LDRADR=$LOWADDR;          /* PUT IN LOAD ADDRESS           */ 00237000
         L     @03,$LOWADDR(,WAPTR)                                0081 00238000
         ST    @03,LDRADR                                          0081 00239000
*         LDRCOMP='1'B;             /* SETUP FOR COMPUTE             */ 00240000
         OI    LDRCOMP,B'01000000'                                 0082 00241000
*         R1=ADDR(LDRPARM);         /* POINT TO PARAMETER LIST       */ 00242000
*                                                                  0083 00243000
         LA    R1,LDRPARM                                          0083 00244000
*         /***********************************************************/ 00245000
*         /*                                                         */ 00246000
*         /* DETERMINE IF THE SECTION IN QUESTION EXISTS AND HOW BIG */ 00247000
*         /* IT REALLY IS. THE SIZE IS THEN USED TO DETERMINE IF THE */ 00248000
*         /* SECTION FIT INTO THE CORE AVAILABLE FOR IT.             */ 00249000
*         /*                                                         */ 00250000
*         /***********************************************************/ 00251000
*                                                                  0084 00252000
*         CALL ISTCC013;            /* FIND OUT ABOUT MODULE         */ 00253000
         L     @15,@CV00697                                        0084 00254000
         BALR  @14,@15                                             0084 00255000
*         IF R15='0C'X THEN                                        0085 00256000
         C     R15,@CF00698                                        0085 00257000
         BE    @RT00085                                            0085 00258000
*           GO TO C10C0021;         /* IF NO MODULE, PUT OUT MESSAGE */ 00259000
*         IF R15¬=0 THEN                                           0087 00260000
         LTR   R15,R15                                             0087 00261000
         BNZ   @RT00087                                            0087 00262000
*           GO TO C10C0026;         /* IF I/O ERR, MARK SECTION NOT     00263000
*                                      ACCESSABLE                    */ 00264000
*         R1=R1+R0;                 /* GET HIGH CORE ADDRESS         */ 00265000
         ALR   R1,R0                                               0089 00266000
*         IF R1>$HIGHADR THEN                                      0090 00267000
         C     R1,$HIGHADR(,WAPTR)                                 0090 00268000
         BH    @RT00090                                            0090 00269000
*           GO TO C10C0022;         /* IF MODULE IS TO BIG, PRINT  0091 00270000
*                                      ERROR MESSAGE                 */ 00271000
*         LDRCOMP='0'B;             /* SETUP FOR LOAD REQUEST        */ 00272000
         NI    LDRCOMP,B'10111111'                                 0092 00273000
*         R1=ADDR(LDRPARM);         /* POINT TO PARM LIST            */ 00274000
*                                                                  0093 00275000
         LA    R1,LDRPARM                                          0093 00276000
*         /***********************************************************/ 00277000
*         /*                                                         */ 00278000
*         /* THE SECTION EXISTS AND WILL FIT, NOW BRING IT INTO CORE */ 00279000
*         /*                                                         */ 00280000
*         /***********************************************************/ 00281000
*                                                                  0094 00282000
*         CALL ISTCC013;            /* BRING IN MODULE               */ 00283000
         L     @15,@CV00697                                        0094 00284000
         BALR  @14,@15                                             0094 00285000
*         IF R15¬=0 THEN                                           0095 00286000
         SLR   @14,@14                                             0095 00287000
         CR    R15,@14                                             0095 00288000
         BNE   @RT00095                                            0095 00289000
*           GO TO C10C0026;         /* SKIP IF ERR                   */ 00290000
*                                                                  0096 00291000
*         /***********************************************************/ 00292000
*         /*                                                         */ 00293000
*         /* SECTIONS WRITTEN TO THE PROPER ARCHITECTURE WILL HAVE   */ 00294000
*         /* THE ACTUAL SECTION ID IN THE FIRST 8 BYTES.             */ 00295000
*         /*                                                         */ 00296000
*         /***********************************************************/ 00297000
*                                                                  0097 00298000
*         IF $RUNTEST¬=SECTID THEN  /* EXIT ON OLD OLT               */ 00299000
         L     @03,$LOWADDR(,WAPTR)                                0097 00300000
         CLC   $RUNTEST(8,WAPTR),SECTID(@03)                       0097 00301000
         BNE   @RT00097                                            0097 00302000
*           GO TO C10C0020;         /* NOT SUPPORTED                 */ 00303000
*                                                                  0098 00304000
*         /***********************************************************/ 00305000
*         /*                                                         */ 00306000
*         /* TOLTEP CURRENTLY SUPPORTS ON VIRTUAL OLTS. OLTS         */ 00307000
*         /* REQUIRING REAL CORE TO RUN ARE NOT EXECUTED.            */ 00308000
*         /*                                                         */ 00309000
*         /***********************************************************/ 00310000
*                                                                  0099 00311000
*         IF $VIRTUAL¬='1'B THEN                                   0099 00312000
         LH    @15,RTNDISP(,@03)                                   0099 00313000
         ALR   @15,@03                                             0099 00314000
         TM    $VIRTUAL(@15),B'10000000'                           0099 00315000
         BNO   @RT00099                                            0099 00316000
*           GO TO C10C0024;         /* IF THE OLT WOUN'T RUN VIRTUAL    00317000
*                                      PUT OUT MESSAGE               */ 00318000
*                                                                  0100 00319000
*         /***********************************************************/ 00320000
*         /*                                                         */ 00321000
*         /* IF THE OLT REQUIRES AN SCT LEVEL THAT IS NOT SUPPORTED, */ 00322000
*         /* DO NOT INITIALIZE IT                                    */ 00323000
*         /*                                                         */ 00324000
*         /***********************************************************/ 00325000
*                                                                  0101 00326000
*         IF $SCTREQ>$SCTLEVL THEN                                 0101 00327000
         CLC   $SCTREQ(1,@15),$SCTLEVL(WAPTR)                      0101 00328000
         BH    @RT00101                                            0101 00329000
*           GO TO C10C0023;                                        0102 00330000
*                                                                  0102 00331000
*         /***********************************************************/ 00332000
*         /*                                                         */ 00333000
*         /* MATCH THE 4 BYTE FIELD IN THE SECTION WITH THE 4 BYTE   */ 00334000
*         /* FIELD IN THE CDS TO SEE IF THE OLT IS COMPATABLE WITH   */ 00335000
*         /* THE DEVICE.                                             */ 00336000
*         /*                                                         */ 00337000
*         /***********************************************************/ 00338000
*                                                                  0103 00339000
*         IF(CDSMFCT&OLTMFCT&&OLTMFCT)¬=0|(CDSMFCT&OLTCMFCT)¬=0 THEN    00340000
         LH    @03,$CDEVPT(,WAPTR)                                 0103 00341000
         MH    @03,@CH00329                                        0103 00342000
         LA    @03,$DEVTBLE-68(@03,WAPTR)                          0103 00343000
         L     @03,CDSMFCT(,@03)                                   0103 00344000
         ICM   @11,15,OLTMFCT(@15)                                 0103 00345000
         LR    @10,@03                                             0103 00346000
         NR    @10,@11                                             0103 00347000
         XR    @10,@11                                             0103 00348000
         CLR   @10,@14                                             0103 00349000
         BNE   @RT00103                                            0103 00350000
         ICM   @11,15,OLTCMFCT(@15)                                0103 00351000
         NR    @03,@11                                             0103 00352000
         CLR   @03,@14                                             0103 00353000
         BNE   @RT00103                                            0103 00354000
*           GO TO C10C0027;                                        0104 00355000
*         $ERRLPCT=$COUNT;          /* PUT IN ERROR LOOP COUNT       */ 00356000
         LH    @03,$COUNT(,@15)                                    0105 00357000
         N     @03,@CF00784                                        0105 00358000
         STH   @03,$ERRLPCT(,WAPTR)                                0105 00359000
*         IF $LOOPERR='1'B&$ERRCNT='1'B THEN                       0106 00360000
         TM    $LOOPERR(WAPTR),B'00000010'                         0106 00361000
         BNO   @RF00106                                            0106 00362000
         TM    $ERRCNT(WAPTR),B'00010000'                          0106 00363000
         BNO   @RF00106                                            0106 00364000
*           $ERRLPCT=$ERRCNTA;      /* IF THE OPERATOR SPECIFIED   0107 00365000
*                                      COUNT ON ERROR LOOP         0107 00366000
*                                      OPTION,FILL IN                */ 00367000
         LH    @03,$ERRCNTA(,WAPTR)                                0107 00368000
         STH   @03,$ERRLPCT(,WAPTR)                                0107 00369000
*         #MSGIDAC=#MSGIDAC&&#MSGIDAC;/* ZERO OUT THE ACTIVE MESSAGE    00370000
*                                      ID                            */ 00371000
@RF00106 XC    #MSGIDAC(2,WAPTR),#MSGIDAC(WAPTR)                   0108 00372000
*         IF #MSGIDRQ='1'B THEN     /* DET. IF MESSAGE ID FIELD IS 0109 00373000
*                                      PRESENT                       */ 00374000
         L     @03,$LOWADDR(,WAPTR)                                0109 00375000
         LH    @15,RTNDISP(,@03)                                   0109 00376000
         ALR   @15,@03                                             0109 00377000
         TM    #MSGIDRQ(@15),B'00010000'                           0109 00378000
         BNO   @RF00109                                            0109 00379000
*           #MSGIDAC=#MSGID;        /* STORE FOR CECOM FUNCTIONS     */ 00380000
*                                                                  0110 00381000
         MVC   #MSGIDAC(2,WAPTR),#MSGID(@03)                       0110 00382000
*         /***********************************************************/ 00383000
*         /*                                                         */ 00384000
*         /* IF THE NO CONTROL OPTION IS ON, DO NOT PRINT THE START  */ 00385000
*         /* MESSAGE FOR THIS SECTION, OTHERWISE PRINT THE MESSAGE   */ 00386000
*         /* WITH THE SECTION NAME, DEVICE UNIT ADDRESS AND          */ 00387000
*         /* OPTIONALLY THE DEVICE SYMBOLLIC NAME.                   */ 00388000
*         /*                                                         */ 00389000
*         /***********************************************************/ 00390000
*                                                                  0111 00391000
*         IF $NOCNTRL='1'B THEN                                    0111 00392000
@RF00109 TM    $NOCNTRL(WAPTR),B'00001000'                         0111 00393000
         BNO   @RF00111                                            0111 00394000
*           DO;                     /* MESSAGE 158                   */ 00395000
*             $INBUFR(1:2)=SMSG;    /* FORMAT FOR START MSG          */ 00396000
         MVC   $INBUFR(2,WAPTR),@CC00668                           0113 00397000
*             $INBUFR(3:10)=$RUNTEST;/* PUT IN SECTION NAME          */ 00398000
         MVC   $INBUFR+2(8,WAPTR),$RUNTEST(WAPTR)                  0114 00399000
*             $INBUFR(11:14)=$PRIMADR;/* PUT IN UNIT ADDR            */ 00400000
         MVC   $INBUFR+10(4,WAPTR),$PRIMADR(WAPTR)                 0115 00401000
*             $INBUFR(15:22)=$SYMBOLC;/* PUT IN SYMB. NAME           */ 00402000
*                                                                  0116 00403000
         MVC   $INBUFR+14(8,WAPTR),$SYMBOLC(WAPTR)                 0116 00404000
*             /*******************************************************/ 00405000
*             /*                                                     */ 00406000
*             /* TCEC MSGN(158)SUB(YES) INVOKED                      */ 00407000
*             /*                                                     */ 00408000
*             /*******************************************************/ 00409000
*                                                                  0117 00410000
*             $TCECM='1'B;          /* SET TCEC SW IN RCA            */ 00411000
         OI    $TCECM(WAPTR),B'00000001'                           0117 00412000
*             R1=ADDR($TCA10);      /* SET UP PARM LIST $TR          */ 00413000
         LA    R1,$TCA10                                           0118 00414000
*             CALL #EXIT;           /* CALL CECOM                    */ 00415000
         L     @15,#EXITA(,WAPTR)                                  0119 00416000
         BALR  @14,@15                                             0119 00417000
*             DCL                                                  0120 00418000
*               1 $TCA10,           /* TCEC PARM LIST                */ 00419000
*                2 $TCB10 FIXED(32) INIT(158),/* MSG NUMBER          */ 00420000
*                2 $TCC10 FIXED(32) INIT(0),/* INCT LEN              */ 00421000
*                2 $TCD10 BIT(8) INIT('10000000'B),/* FLAG           */ 00422000
*                2 $TCE10 CHAR(4) INIT('FFFFFFFF'X);/* MSSAGE MASK   */ 00423000
*           END;                    /* DONE WITH MESSAGE 158         */ 00424000
*                                                                  0121 00425000
*         /***********************************************************/ 00426000
*         /*                                                         */ 00427000
*         /* CLEAN UP OLT INDICATORS                                 */ 00428000
*         /*                                                         */ 00429000
*         /***********************************************************/ 00430000
*                                                                  0122 00431000
*         $TESTERR='0'B;            /* TEST ERROR                    */ 00432000
@RF00111 DS    0H                                                  0123 00433000
*         $CATERR='0'B;             /* CATASTROPHIC ERROR            */ 00434000
*         $ASTERIK='0'B;            /* PUT ASTERISK ON TERMINATE     */ 00435000
         NI    $TESTERR(WAPTR),B'00011111'                         0124 00436000
*         $CLEANUP='0'B;            /* CLEAN UP CALL                 */ 00437000
*         $LSTPDEV='0'B;            /* LAST PRIMARY DEVICE FOR SEC   */ 00438000
         NI    $CLEANUP(WAPTR),B'11110011'                         0126 00439000
*         $FSTFE='0'B;              /* FIRST ERROR ALREADY OCCURED   */ 00440000
*         $FSTCAT='0'B;             /* CATASTROPHIC ERROR OCCURED    */ 00441000
         NI    $FSTFE(WAPTR),B'00111111'                           0128 00442000
*         $FSTMCIS='0'B;            /* FREE ALL MORECORES            */ 00443000
         NI    $FSTMCIS(WAPTR),B'11111011'                         0129 00444000
*         $CLEANRT='0'B;            /* CLEAN UP ROUTINE EXISTS       */ 00445000
*         $DYCOM='0'B;              /* OLT SUPPORTS DYNAMIC COMMON   */ 00446000
         NI    $CLEANRT(WAPTR),B'10111110'                         0131 00447000
*         $TALK='0'B;               /* OPERATOR WISHES TO COMMON     */ 00448000
         NI    $TALK(WAPTR),B'01111111'                            0132 00449000
*         $RETMASK=0;               /* RETURN MASK FOR FUNCTIONS     */ 00450000
         MVI   $RETMASK(WAPTR),X'00'                               0133 00451000
*         $CATMSG='0'B;             /* CATASTROPHIC ERROR MESSAGE    */ 00452000
         NI    $CATMSG(WAPTR),B'11111011'                          0134 00453000
*         $TRTN#=0;                 /* CURRENT TRACE ROUTINE NUMBER  */ 00454000
         MVI   $TRTN#(WAPTR),X'00'                                 0135 00455000
*         $GRCNTS=0;                /* SET GRABBED COUNTER TO ZERO   */ 00456000
*                                                                  0136 00457000
         SLR   @03,@03                                             0136 00458000
         STH   @03,$GRCNTS(,WAPTR)                                 0136 00459000
*         /***********************************************************/ 00460000
*         /*                                                         */ 00461000
*         /* RESET ALL DEVICE BITS FOR NEW SECTION           @ZD10859*/ 00462000
*         /*                                                         */ 00463000
*         /***********************************************************/ 00464000
*                                                                  0137 00465000
*         DO I=3 TO $DEVCNTS;       /* DO ONLY ACTIVE ENTRIES        */ 00466000
         LA    I,3                                                 0137 00467000
         B     @DE00137                                            0137 00468000
@DL00137 DS    0H                                                  0138 00469000
*           $GRABBED(I)='0'B;       /* INDICATE NOT GRABBED          */ 00470000
         LR    @15,I                                               0138 00471000
         MH    @15,@CH00329                                        0138 00472000
         ST    @15,@TF00001                                        0138 00473000
         ALR   @15,WAPTR                                           0138 00474000
         NI    $GRABBED-68(@15),B'11011111'                        0138 00475000
*           $SRTEST(I)='0'B;        /* REMOVE FROM TEST      @ZD10859*/ 00476000
*           $OLTERR(I)='0'B;        /* DONT GIVE ERROR RET CODE    0140 00477000
*                                                            @ZD10859*/ 00478000
         LR    @01,WAPTR                                           0140 00479000
         AL    @01,@TF00001                                        0140 00480000
         NI    $SRTEST-68(@01),B'11110011'                         0140 00481000
*         END;                      /* DO NEXT IF APPROPRIATE        */ 00482000
         AL    I,@CF00072                                          0141 00483000
@DE00137 CH    I,$DEVCNTS(,WAPTR)                                  0141 00484000
         BNH   @DL00137                                            0141 00485000
*         $OLTACT='1'B;             /* SHOW OLT NOW RUNNING.         */ 00486000
         OI    $OLTACT(WAPTR),B'00000001'                          0142 00487000
*         R1=ADDR($SCTPTR);         /* POINT TO PARAMETER LST        */ 00488000
*                                                                  0143 00489000
         LA    R1,$SCTPTR(,WAPTR)                                  0143 00490000
*         /***********************************************************/ 00491000
*         /*                                                         */ 00492000
*         /* CALL THE OLT AS A SUBROUTINE TO TEST THE PRIMARY DEVICE */ 00493000
*         /* NORMALLY, CONTROL RETURNS TO THE NEXT SEQUENTIAL        */ 00494000
*         /* INSTRUCTION, BUT CONTROL COULD COME BACK THROUGH        */ 00495000
*         /* ISTCC010 ENTRYPOINT IF THE OLT MUST BE TERMINATED       */ 00496000
*         /* ABNORMALLY.                                             */ 00497000
*         /*                                                         */ 00498000
*         /***********************************************************/ 00499000
*                                                                  0144 00500000
*         CALL OLTENTRY;            /* EXECUTE THE OLT SECTION       */ 00501000
         L     @03,$LOWADDR(,WAPTR)                                0144 00502000
         L     @15,INST(,@03)                                      0144 00503000
         BALR  @14,@15                                             0144 00504000
*         $NRMTERM='1'B;            /* NORMAL TERMINATION BY OLT     */ 00505000
*                                                                  0145 00506000
         OI    $NRMTERM(WAPTR),B'00000010'                         0145 00507000
*         /***********************************************************/ 00508000
*         /*                                                         */ 00509000
*         /* CONTROL IS RECIEVED HERE WHEN AN OLT IS BEING           */ 00510000
*         /* TERMINATED, NORMALLY OR ABNORMALLY.                     */ 00511000
*         /*                                                         */ 00512000
*         /***********************************************************/ 00513000
*                                                                  0146 00514000
*C10C0005:                                                         0146 00515000
*         $NORELDV='1'B;            /* DONT RELEASE DEVICES          */ 00516000
C10C0005 OI    $NORELDV(WAPTR),B'00000010'                         0146 00517000
*         CALL ISTTC035;            /* CLEAN UP AND TERMINATE        */ 00518000
         L     @15,@CV00720                                        0147 00519000
         BALR  @14,@15                                             0147 00520000
*C10C0007:                                                         0148 00521000
*         $SECFLGS($CTSTPT)=$TESTFLG;/* RESTORE FLAGS                */ 00522000
*                                                                  0148 00523000
C10C0007 LH    @03,$CTSTPT(,WAPTR)                                 0148 00524000
         SLA   @03,2                                               0148 00525000
         ALR   @03,WAPTR                                           0148 00526000
         MVC   $SECFLGS-4(1,@03),$TESTFLG(WAPTR)                   0148 00527000
*         /***********************************************************/ 00528000
*         /*                                                         */ 00529000
*         /* IF IT WAS A CATASTROPHIC TERMINATION, RETURN TO THE     */ 00530000
*         /* COMMUNICATION INTERVAL TO CONTINUE PROCESSING THE D/T/O */ 00531000
*         /* REPLY                                                   */ 00532000
*         /*                                                         */ 00533000
*         /***********************************************************/ 00534000
*                                                                  0149 00535000
*         IF $CATERR='1'B THEN      /* CATASTROPHIC RETURN           */ 00536000
         TM    $CATERR(WAPTR),B'00100000'                          0149 00537000
         BNO   @RF00149                                            0149 00538000
*           CALL ISTIC002;          /* CALL COMMUNICATION INT        */ 00539000
*                                                                  0150 00540000
         L     @15,@CV00722                                        0150 00541000
         BALR  @14,@15                                             0150 00542000
*         /***********************************************************/ 00543000
*         /*                                                         */ 00544000
*         /* END OF THE SECTION LOOP                                 */ 00545000
*         /*                                                         */ 00546000
*         /***********************************************************/ 00547000
*                                                                  0151 00548000
*       END;                        /* END OF SECTION                */ 00549000
@RF00149 LA    @03,1                                               0151 00550000
         AH    @03,$CTSTPT(,WAPTR)                                 0151 00551000
@DE00075 STH   @03,$CTSTPT(,WAPTR)                                 0151 00552000
         CH    @03,$TSTCNT(,WAPTR)                                 0151 00553000
         BNH   @DL00075                                            0151 00554000
*       $PRIMARY($CDEVPT)='0'B;     /* RELEASE DEVICE AS PRIM        */ 00555000
*                                                                  0152 00556000
         LH    @03,$CDEVPT(,WAPTR)                                 0152 00557000
         MH    @03,@CH00329                                        0152 00558000
         ALR   @03,WAPTR                                           0152 00559000
         NI    $PRIMARY-68(@03),B'11111110'                        0152 00560000
*       /*************************************************************/ 00561000
*       /*                                                           */ 00562000
*       /* END OF THE DEVICE LOOP                                    */ 00563000
*       /*                                                           */ 00564000
*       /*************************************************************/ 00565000
*                                                                  0153 00566000
*C10C0008:                                                         0153 00567000
*     END;                          /* END OF DEV TESTING            */ 00568000
*                                                                  0153 00569000
C10C0008 LA    @03,1                                               0153 00570000
         AH    @03,$CDEVPT(,WAPTR)                                 0153 00571000
@DE00054 STH   @03,$CDEVPT(,WAPTR)                                 0153 00572000
         CH    @03,$DEVCNTS(,WAPTR)                                0153 00573000
         BNH   @DL00054                                            0153 00574000
*     /***************************************************************/ 00575000
*     /*                                                             */ 00576000
*     /* END OF THE TEST LOOP                                        */ 00577000
*     /*                                                             */ 00578000
*     /***************************************************************/ 00579000
*                                                                  0154 00580000
*   END;                            /* END OF TEST LOOP              */ 00581000
*                                                                  0154 00582000
         LA    @03,1                                               0154 00583000
         AH    @03,$CTLCNT(,WAPTR)                                 0154 00584000
@DE00049 STH   @03,$CTLCNT(,WAPTR)                                 0154 00585000
         CH    @03,$TLCNT(,WAPTR)                                  0154 00586000
         BNH   @DL00049                                            0154 00587000
*   /*****************************************************************/ 00588000
*   /*                                                               */ 00589000
*   /* THE FOLLOWING CALL IS ACTUALLY AN EXIT AND CONTROL CANNOT BE  */ 00590000
*   /* RETURNED FROM THE COMMUNICATION INTERVAL.                     */ 00591000
*   /*                                                               */ 00592000
*   /*****************************************************************/ 00593000
*                                                                  0155 00594000
*   CALL ISTIC002;                  /* EXIT TO COMM INTERVAL         */ 00595000
         L     @15,@CV00722                                        0155 00596000
         BALR  @14,@15                                             0155 00597000
*                                                                  0156 00598000
*   /*****************************************************************/ 00599000
*   /*                                                               */ 00600000
*   /* THE FOLLOWING ROUTINES WILL RECEIVE CONTROL ONLY DUE TO AN    */ 00601000
*   /* ERROR FOR EITHER THE TEST DEVICE OR THE TEST SECTION. IN ALL  */ 00602000
*   /* CASES AN ERROR MESSAGE WILL BE ISSUED TELLING THE OPERATOR WHY*/ 00603000
*   /* HIS REQUEST FAILED. SOME OF THE PROBLEMS CAN BE CORRECTED     */ 00604000
*   /* OTHERS CANNOT AND SHOULD NOT BE TRIED AGAIN. THE MESSAGE      */ 00605000
*   /* DOCUMENTATION DESECRIBES WHICH THESE ARE.                     */ 00606000
*   /*                                                               */ 00607000
*   /*****************************************************************/ 00608000
*                                                                  0156 00609000
*   ;                                                              0156 00610000
*                                                                  0156 00611000
*   /*****************************************************************/ 00612000
*   /*                                                               */ 00613000
*   /* THE OLT WAS WRITTEN TO THE WRONG ARCHITECTURE                 */ 00614000
*   /*                                                               */ 00615000
*   /*****************************************************************/ 00616000
*                                                                  0157 00617000
*C10C0020:                                                         0157 00618000
*   $INBUFR(1:8)=$RUNTEST;          /* FILL IN MODULE ID             */ 00619000
C10C0020 MVC   $INBUFR(8,WAPTR),$RUNTEST(WAPTR)                    0157 00620000
*   $INBUFR(9:10)=OLDOLT;           /* FILL IN REASON CODE           */ 00621000
*                                                                  0158 00622000
         MVC   $INBUFR+8(2,WAPTR),@CC00670                         0158 00623000
*   /*****************************************************************/ 00624000
*   /*                                                               */ 00625000
*   /* TCEC MSGN(227)SUB(YES) INVOKED                                */ 00626000
*   /*                                                               */ 00627000
*   /*****************************************************************/ 00628000
*                                                                  0159 00629000
*   $TCECM='1'B;                    /* SET TCEC SW IN RCA            */ 00630000
         OI    $TCECM(WAPTR),B'00000001'                           0159 00631000
*   R1=ADDR($TCA11);                /* SET UP PARM LIST $TR          */ 00632000
         LA    R1,$TCA11                                           0160 00633000
*   CALL #EXIT;                     /* CALL CECOM                    */ 00634000
         L     @15,#EXITA(,WAPTR)                                  0161 00635000
         BALR  @14,@15                                             0161 00636000
*   DCL                                                            0162 00637000
*     1 $TCA11,                     /* TCEC PARM LIST                */ 00638000
*      2 $TCB11 FIXED(32) INIT(227),/* MSG NUMBER                    */ 00639000
*      2 $TCC11 FIXED(32) INIT(0),  /* INCT LEN                      */ 00640000
*      2 $TCD11 BIT(8) INIT('10000000'B),/* FLAG                     */ 00641000
*      2 $TCE11 CHAR(4) INIT('FFFFFFFF'X);/* MSSAGE MASK             */ 00642000
*   GO TO C10C0026;                 /* MAKE UNUSABLE                 */ 00643000
*                                                                  0163 00644000
         B     C10C0026                                            0163 00645000
*   /*****************************************************************/ 00646000
*   /*                                                               */ 00647000
*   /* THE SECTION WAS NOT FOUND IN THE LIBRARY                      */ 00648000
*   /*                                                               */ 00649000
*   /*****************************************************************/ 00650000
*                                                                  0164 00651000
*C10C0021:                                                         0164 00652000
*   $INBUFR(1:8)=$RUNTEST;          /* SET UP FOR MESSGAE            */ 00653000
*                                                                  0164 00654000
C10C0021 MVC   $INBUFR(8,WAPTR),$RUNTEST(WAPTR)                    0164 00655000
*   /*****************************************************************/ 00656000
*   /*                                                               */ 00657000
*   /* TCEC MSGN(117)SUB(YES) INVOKED                                */ 00658000
*   /*                                                               */ 00659000
*   /*****************************************************************/ 00660000
*                                                                  0165 00661000
*   $TCECM='1'B;                    /* SET TCEC SW IN RCA            */ 00662000
         OI    $TCECM(WAPTR),B'00000001'                           0165 00663000
*   R1=ADDR($TCA12);                /* SET UP PARM LIST $TR          */ 00664000
         LA    R1,$TCA12                                           0166 00665000
*   CALL #EXIT;                     /* CALL CECOM                    */ 00666000
         L     @15,#EXITA(,WAPTR)                                  0167 00667000
         BALR  @14,@15                                             0167 00668000
*   DCL                                                            0168 00669000
*     1 $TCA12,                     /* TCEC PARM LIST                */ 00670000
*      2 $TCB12 FIXED(32) INIT(117),/* MSG NUMBER                    */ 00671000
*      2 $TCC12 FIXED(32) INIT(0),  /* INCT LEN                      */ 00672000
*      2 $TCD12 BIT(8) INIT('10000000'B),/* FLAG                     */ 00673000
*      2 $TCE12 CHAR(4) INIT('FFFFFFFF'X);/* MSSAGE MASK             */ 00674000
*   GO TO C10C0026;                 /* MARK NOT TO USE AGAIN         */ 00675000
*                                                                  0169 00676000
         B     C10C0026                                            0169 00677000
*   /*****************************************************************/ 00678000
*   /*                                                               */ 00679000
*   /* THE SECTION IS TO BIG TO FIT IN THE CORE AVAILABLE            */ 00680000
*   /*                                                               */ 00681000
*   /*****************************************************************/ 00682000
*                                                                  0170 00683000
*C10C0022:                                                         0170 00684000
*   $INBUFR(1:8)=$RUNTEST;          /* SECTION TO BIG TO FIT         */ 00685000
*                                                                  0170 00686000
C10C0022 MVC   $INBUFR(8,WAPTR),$RUNTEST(WAPTR)                    0170 00687000
*   /*****************************************************************/ 00688000
*   /*                                                               */ 00689000
*   /* TCEC MSGN(200)SUB(YES) INVOKED                                */ 00690000
*   /*                                                               */ 00691000
*   /*****************************************************************/ 00692000
*                                                                  0171 00693000
*   $TCECM='1'B;                    /* SET TCEC SW IN RCA            */ 00694000
         OI    $TCECM(WAPTR),B'00000001'                           0171 00695000
*   R1=ADDR($TCA13);                /* SET UP PARM LIST $TR          */ 00696000
         LA    R1,$TCA13                                           0172 00697000
*   CALL #EXIT;                     /* CALL CECOM                    */ 00698000
         L     @15,#EXITA(,WAPTR)                                  0173 00699000
         BALR  @14,@15                                             0173 00700000
*   DCL                                                            0174 00701000
*     1 $TCA13,                     /* TCEC PARM LIST                */ 00702000
*      2 $TCB13 FIXED(32) INIT(200),/* MSG NUMBER                    */ 00703000
*      2 $TCC13 FIXED(32) INIT(0),  /* INCT LEN                      */ 00704000
*      2 $TCD13 BIT(8) INIT('10000000'B),/* FLAG                     */ 00705000
*      2 $TCE13 CHAR(4) INIT('FFFFFFFF'X);/* MSSAGE MASK             */ 00706000
*   GOTO C10C0026;                  /* MARK NOT TO USE AGAIN         */ 00707000
*                                                                  0175 00708000
         B     C10C0026                                            0175 00709000
*   /*****************************************************************/ 00710000
*   /*                                                               */ 00711000
*   /* THE SECTION REQUIRED AN SCT THAT WAS HIGHER THAN TOLTEP       */ 00712000
*   /* SUPPORTS                                                      */ 00713000
*   /*                                                               */ 00714000
*   /*****************************************************************/ 00715000
*                                                                  0176 00716000
*C10C0023:                                                         0176 00717000
*   $INBUFR(1:8)=$RUNTEST;          /* WRONG LEVEL SCT FOR OLT       */ 00718000
C10C0023 MVC   $INBUFR(8,WAPTR),$RUNTEST(WAPTR)                    0176 00719000
*   $INBUFR(9:10)=BDSLEV;           /* FILL IN REASON CODE           */ 00720000
*                                                                  0177 00721000
         MVC   $INBUFR+8(2,WAPTR),@CC00672                         0177 00722000
*   /*****************************************************************/ 00723000
*   /*                                                               */ 00724000
*   /* TCEC MSGN(227)SUB(YES) INVOKED                                */ 00725000
*   /*                                                               */ 00726000
*   /*****************************************************************/ 00727000
*                                                                  0178 00728000
*   $TCECM='1'B;                    /* SET TCEC SW IN RCA            */ 00729000
         OI    $TCECM(WAPTR),B'00000001'                           0178 00730000
*   R1=ADDR($TCA14);                /* SET UP PARM LIST $TR          */ 00731000
         LA    R1,$TCA14                                           0179 00732000
*   CALL #EXIT;                     /* CALL CECOM                    */ 00733000
         L     @15,#EXITA(,WAPTR)                                  0180 00734000
         BALR  @14,@15                                             0180 00735000
*   DCL                                                            0181 00736000
*     1 $TCA14,                     /* TCEC PARM LIST                */ 00737000
*      2 $TCB14 FIXED(32) INIT(227),/* MSG NUMBER                    */ 00738000
*      2 $TCC14 FIXED(32) INIT(0),  /* INCT LEN                      */ 00739000
*      2 $TCD14 BIT(8) INIT('10000000'B),/* FLAG                     */ 00740000
*      2 $TCE14 CHAR(4) INIT('FFFFFFFF'X);/* MSSAGE MASK             */ 00741000
*   GOTO C10C0026;                  /* MARK NOT TO USE AGAIN         */ 00742000
*                                                                  0182 00743000
         B     C10C0026                                            0182 00744000
*   /*****************************************************************/ 00745000
*   /*                                                               */ 00746000
*   /* THE OLT REQUIRES REAL CORE TO EXECUTE, AND IT IS UNAVAILABLE  */ 00747000
*   /*                                                               */ 00748000
*   /*****************************************************************/ 00749000
*                                                                  0183 00750000
*C10C0024:                                                         0183 00751000
*   $INBUFR(1:8)=$RUNTEST;          /* SECTION DOES NOT RUN VIRT     */ 00752000
*                                                                  0183 00753000
C10C0024 MVC   $INBUFR(8,WAPTR),$RUNTEST(WAPTR)                    0183 00754000
*   /*****************************************************************/ 00755000
*   /*                                                               */ 00756000
*   /* TCEC MSGN(246)SUB(YES) INVOKED                                */ 00757000
*   /*                                                               */ 00758000
*   /*****************************************************************/ 00759000
*                                                                  0184 00760000
*   $TCECM='1'B;                    /* SET TCEC SW IN RCA            */ 00761000
         OI    $TCECM(WAPTR),B'00000001'                           0184 00762000
*   R1=ADDR($TCA15);                /* SET UP PARM LIST $TR          */ 00763000
         LA    R1,$TCA15                                           0185 00764000
*   CALL #EXIT;                     /* CALL CECOM                    */ 00765000
         L     @15,#EXITA(,WAPTR)                                  0186 00766000
         BALR  @14,@15                                             0186 00767000
*   DCL                                                            0187 00768000
*     1 $TCA15,                     /* TCEC PARM LIST                */ 00769000
*      2 $TCB15 FIXED(32) INIT(246),/* MSG NUMBER                    */ 00770000
*      2 $TCC15 FIXED(32) INIT(0),  /* INCT LEN                      */ 00771000
*      2 $TCD15 BIT(8) INIT('10000000'B),/* FLAG                     */ 00772000
*      2 $TCE15 CHAR(4) INIT('FFFFFFFF'X);/* MSSAGE MASK             */ 00773000
*                                                                  0187 00774000
*   /*****************************************************************/ 00775000
*   /*                                                               */ 00776000
*   /* MARK THE SECTION AS NEVER TO BE SCHEDULED AGAIN               */ 00777000
*   /*                                                               */ 00778000
*   /*****************************************************************/ 00779000
*                                                                  0188 00780000
*C10C0026:                                                         0188 00781000
*   $CANTRUN='1'B;                  /* SECTION CANNOT BE USED        */ 00782000
C10C0026 OI    $CANTRUN(WAPTR),B'01000000'                         0188 00783000
*   GO TO C10C0007;                 /* GO TO NEXT SECTION            */ 00784000
*                                                                  0189 00785000
         B     C10C0007                                            0189 00786000
*   /*****************************************************************/ 00787000
*   /*                                                               */ 00788000
*   /* THE SECTION IS NOT COMPATABLE WITH THE DEVICE CORRENTLY BEING */ 00789000
*   /* SCHEDULED. THE SECTION IS BYPASSED, BUT IS AVAILABLE FOR      */ 00790000
*   /* SCHEDULING THE NEXT TIME AROUND                               */ 00791000
*   /*                                                               */ 00792000
*   /*****************************************************************/ 00793000
*                                                                  0190 00794000
*C10C0027:                                                         0190 00795000
*   $INBUFR(1:8)=$RUNTEST;          /* SECTION CAN'TRUN ON DEV       */ 00796000
*                                                                  0190 00797000
C10C0027 MVC   $INBUFR(8,WAPTR),$RUNTEST(WAPTR)                    0190 00798000
*   /*****************************************************************/ 00799000
*   /*                                                               */ 00800000
*   /* TCEC MSGN(201)SUB(YES) INVOKED                                */ 00801000
*   /*                                                               */ 00802000
*   /*****************************************************************/ 00803000
*                                                                  0191 00804000
*   $TCECM='1'B;                    /* SET TCEC SW IN RCA            */ 00805000
         OI    $TCECM(WAPTR),B'00000001'                           0191 00806000
*   R1=ADDR($TCA16);                /* SET UP PARM LIST $TR          */ 00807000
         LA    R1,$TCA16                                           0192 00808000
*   CALL #EXIT;                     /* CALL CECOM                    */ 00809000
         L     @15,#EXITA(,WAPTR)                                  0193 00810000
         BALR  @14,@15                                             0193 00811000
*   DCL                                                            0194 00812000
*     1 $TCA16,                     /* TCEC PARM LIST                */ 00813000
*      2 $TCB16 FIXED(32) INIT(201),/* MSG NUMBER                    */ 00814000
*      2 $TCC16 FIXED(32) INIT(0),  /* INCT LEN                      */ 00815000
*      2 $TCD16 BIT(8) INIT('10000000'B),/* FLAG                     */ 00816000
*      2 $TCE16 CHAR(4) INIT('FFFFFFFF'X);/* MSSAGE MASK             */ 00817000
*   $INBUFR(1:8)=$RUNTEST;          /* SE T UP THE MESSGAE           */ 00818000
         MVC   $INBUFR(8,WAPTR),$RUNTEST(WAPTR)                    0195 00819000
*   $INBUFR(9:12)=$PRIMADR;         /* GENERATE FILL IN AREA         */ 00820000
*                                                                  0196 00821000
         MVC   $INBUFR+8(4,WAPTR),$PRIMADR(WAPTR)                  0196 00822000
*   /*****************************************************************/ 00823000
*   /*                                                               */ 00824000
*   /* TCEC MSGN(231)SUB(YES) INVOKED                                */ 00825000
*   /*                                                               */ 00826000
*   /*****************************************************************/ 00827000
*                                                                  0197 00828000
*   $TCECM='1'B;                    /* SET TCEC SW IN RCA            */ 00829000
         OI    $TCECM(WAPTR),B'00000001'                           0197 00830000
*   R1=ADDR($TCA17);                /* SET UP PARM LIST $TR          */ 00831000
         LA    R1,$TCA17                                           0198 00832000
*   CALL #EXIT;                     /* CALL CECOM                    */ 00833000
         L     @15,#EXITA(,WAPTR)                                  0199 00834000
         BALR  @14,@15                                             0199 00835000
*   DCL                                                            0200 00836000
*     1 $TCA17,                     /* TCEC PARM LIST                */ 00837000
*      2 $TCB17 FIXED(32) INIT(231),/* MSG NUMBER                    */ 00838000
*      2 $TCC17 FIXED(32) INIT(0),  /* INCT LEN                      */ 00839000
*      2 $TCD17 BIT(8) INIT('10000000'B),/* FLAG                     */ 00840000
*      2 $TCE17 CHAR(4) INIT('FFFFFFFF'X);/* MSSAGE MASK             */ 00841000
*   GO TO C10C0007;                 /* GO TO NEXT SECTION            */ 00842000
         B     C10C0007                                            0201 00843000
*   DO;                             /* ATDSPLY                       */ 00844000
*   END;                            /* ATDSPLY                       */ 00845000
*   END ISTCC010;                   /* END OF SCHEDULER              */ 00846000
@DATA    DS    0H                                                       00847000
@CH00329 DC    H'68'                                                    00848000
         DS    0F                                                       00849000
@TF00001 DS    F                                                        00850000
         DS    0F                                                       00851000
@CF00072 DC    F'1'                                                     00852000
@CF00784 DC    XL4'0000FFFF'                                            00853000
@CF00698 DC    XL4'0C'                                                  00854000
@CV00697 DC    V(ISTCC013)                                              00855000
@CV00720 DC    V(ISTTC035)                                              00856000
@CV00722 DC    V(ISTIC002)                                              00857000
         DS    0D                                                       00858000
@CC00674 DC    C'NONE'                                                  00859000
@CC00668 DC    C' S'                                                    00860000
@CC00670 DC    C'02'                                                    00861000
@CC00672 DC    C'01'                                                    00862000
         DS    CL2                                                      00863000
LDRPARM  DS    CL8                                                      00864000
         ORG   LDRPARM                                                  00865000
@NM00063 DS    FL4                                                      00866000
@NM00064 DC    AL4(LDRPARME)                                            00867000
         ORG   LDRPARM+8                                                00868000
LDRPARME DS    CL16                                                     00869000
         ORG   LDRPARME                                                 00870000
LDRNAME  DS    CL8                                                      00871000
LDRADR   DS    AL4                                                      00872000
@NM00065 DC    X'00'                                                    00873000
         ORG   @NM00065                                                 00874000
@NM00066 DS    BL1                                                      00875000
LDRCOMP  EQU   @NM00065+0                                               00876000
@NM00067 EQU   @NM00065+0                                               00877000
         ORG   LDRPARME+13                                              00878000
@NM00068 DS    CL1                                                      00879000
@NM00069 DC    H'0'                                                     00880000
         ORG   LDRPARME+16                                              00881000
$TCA10   DS    CL13                                                     00882000
         ORG   $TCA10                                                   00883000
$TCB10   DC    A(158)                                                   00884000
$TCC10   DC    A(0)                                                     00885000
$TCD10   DC    B'10000000'                                              00886000
$TCE10   DC    X'FFFFFFFF'                                              00887000
         ORG   $TCA10+13                                                00888000
         DS    CL3                                                      00889000
$TCA11   DS    CL13                                                     00890000
         ORG   $TCA11                                                   00891000
$TCB11   DC    A(227)                                                   00892000
$TCC11   DC    A(0)                                                     00893000
$TCD11   DC    B'10000000'                                              00894000
$TCE11   DC    X'FFFFFFFF'                                              00895000
         ORG   $TCA11+13                                                00896000
         DS    CL3                                                      00897000
$TCA12   DS    CL13                                                     00898000
         ORG   $TCA12                                                   00899000
$TCB12   DC    A(117)                                                   00900000
$TCC12   DC    A(0)                                                     00901000
$TCD12   DC    B'10000000'                                              00902000
$TCE12   DC    X'FFFFFFFF'                                              00903000
         ORG   $TCA12+13                                                00904000
         DS    CL3                                                      00905000
$TCA13   DS    CL13                                                     00906000
         ORG   $TCA13                                                   00907000
$TCB13   DC    A(200)                                                   00908000
$TCC13   DC    A(0)                                                     00909000
$TCD13   DC    B'10000000'                                              00910000
$TCE13   DC    X'FFFFFFFF'                                              00911000
         ORG   $TCA13+13                                                00912000
         DS    CL3                                                      00913000
$TCA14   DS    CL13                                                     00914000
         ORG   $TCA14                                                   00915000
$TCB14   DC    A(227)                                                   00916000
$TCC14   DC    A(0)                                                     00917000
$TCD14   DC    B'10000000'                                              00918000
$TCE14   DC    X'FFFFFFFF'                                              00919000
         ORG   $TCA14+13                                                00920000
         DS    CL3                                                      00921000
$TCA15   DS    CL13                                                     00922000
         ORG   $TCA15                                                   00923000
$TCB15   DC    A(246)                                                   00924000
$TCC15   DC    A(0)                                                     00925000
$TCD15   DC    B'10000000'                                              00926000
$TCE15   DC    X'FFFFFFFF'                                              00927000
         ORG   $TCA15+13                                                00928000
         DS    CL3                                                      00929000
$TCA16   DS    CL13                                                     00930000
         ORG   $TCA16                                                   00931000
$TCB16   DC    A(201)                                                   00932000
$TCC16   DC    A(0)                                                     00933000
$TCD16   DC    B'10000000'                                              00934000
$TCE16   DC    X'FFFFFFFF'                                              00935000
         ORG   $TCA16+13                                                00936000
         DS    CL3                                                      00937000
$TCA17   DS    CL13                                                     00938000
         ORG   $TCA17                                                   00939000
$TCB17   DC    A(231)                                                   00940000
$TCC17   DC    A(0)                                                     00941000
$TCD17   DC    B'10000000'                                              00942000
$TCE17   DC    X'FFFFFFFF'                                              00943000
         ORG   $TCA17+13                                                00944000
         DS    CL3                                                      00945000
PATCH    DC    40F'0'                                                   00946000
@00      EQU   00                      EQUATES FOR REGISTERS 0-15       00947000
@01      EQU   01                                                       00948000
@02      EQU   02                                                       00949000
@03      EQU   03                                                       00950000
@04      EQU   04                                                       00951000
@05      EQU   05                                                       00952000
@06      EQU   06                                                       00953000
@07      EQU   07                                                       00954000
@08      EQU   08                                                       00955000
@09      EQU   09                                                       00956000
@10      EQU   10                                                       00957000
@11      EQU   11                                                       00958000
@12      EQU   12                                                       00959000
@13      EQU   13                                                       00960000
@14      EQU   14                                                       00961000
@15      EQU   15                                                       00962000
ITATCTS  EQU   @03                                                      00963000
I        EQU   @03                                                      00964000
WAPTR    EQU   @02                                                      00965000
R0       EQU   @00                                                      00966000
R1       EQU   @01                                                      00967000
R13      EQU   @13                                                      00968000
R15      EQU   @15                                                      00969000
$RCAAREA EQU   0                                                        00970000
$POINTER EQU   $RCAAREA+100                                             00971000
$TRTBLA  EQU   $POINTER+124                                             00972000
$CONSTNT EQU   $RCAAREA+244                                             00973000
$RCAFLG  EQU   $RCAAREA+604                                             00974000
$TRTBL   EQU   0                                                        00975000
TOLTEPWA EQU   0                                                        00976000
$SCTTBLE EQU   TOLTEPWA                                                 00977000
$ERRLPCT EQU   $SCTTBLE                                                 00978000
$TESTOPT EQU   $SCTTBLE+2                                               00979000
$ERROPT  EQU   $SCTTBLE+3                                               00980000
$TESTERR EQU   $ERROPT                                                  00981000
$ASTERIK EQU   $ERROPT                                                  00982000
$CATERR  EQU   $ERROPT                                                  00983000
$NOCNTRL EQU   $ERROPT                                                  00984000
$LOOPERR EQU   $ERROPT                                                  00985000
$SCTLEVL EQU   $SCTTBLE+7                                               00986000
$PDEVFLG EQU   $SCTTBLE+10                                              00987000
$CDSFLGS EQU   $SCTTBLE+11                                              00988000
$PDEVADR EQU   $SCTTBLE+12                                              00989000
$CDS8T19 EQU   $SCTTBLE+20                                              00990000
$EXECFLG EQU   $SCTTBLE+33                                              00991000
$ERRCNT  EQU   $EXECFLG                                                 00992000
$LSTPDEV EQU   $EXECFLG                                                 00993000
$CLEANUP EQU   $EXECFLG                                                 00994000
$OLTFLGS EQU   $SCTTBLE+36                                              00995000
$CLEANRT EQU   $OLTFLGS                                                 00996000
$DYCOM   EQU   $OLTFLGS                                                 00997000
$OLTFLG2 EQU   $SCTTBLE+37                                              00998000
$TALK    EQU   $OLTFLG2                                                 00999000
$TOTFLG1 EQU   $SCTTBLE+38                                              01000000
$ROUTMSK EQU   $SCTTBLE+40                                              01001000
$RETMASK EQU   $SCTTBLE+70                                              01002000
#MSGIDAC EQU   $SCTTBLE+78                                              01003000
$CDA     EQU   TOLTEPWA+100                                             01004000
$SCTPTR  EQU   $CDA+16                                                  01005000
$RCA     EQU   $CDA+44                                                  01006000
$OLTPTR  EQU   $CDA+52                                                  01007000
$LOWADDR EQU   $OLTPTR                                                  01008000
$HIMOREC EQU   $CDA+60                                                  01009000
$HIGHADR EQU   $HIMOREC                                                 01010000
$TLCNT   EQU   $CDA+100                                                 01011000
$ERRCNTA EQU   $CDA+102                                                 01012000
$CTLCNT  EQU   $CDA+106                                                 01013000
$GRCNTS  EQU   $CDA+108                                                 01014000
$COMMFLG EQU   TOLTEPWA+224                                             01015000
$FLAG1   EQU   $COMMFLG                                                 01016000
$NORELDV EQU   $FLAG1                                                   01017000
$OLTACT  EQU   $FLAG1                                                   01018000
$FLAG2   EQU   $COMMFLG+1                                               01019000
$NDR     EQU   $FLAG2                                                   01020000
$NRMTERM EQU   $FLAG2                                                   01021000
$FLAG5   EQU   $COMMFLG+4                                               01022000
$FSTFE   EQU   $FLAG5                                                   01023000
$FSTCAT  EQU   $FLAG5                                                   01024000
$EOJ     EQU   $FLAG5                                                   01025000
$CANCEL  EQU   $EOJ                                                     01026000
$FLAG6   EQU   $COMMFLG+5                                               01027000
$FSTMCIS EQU   $FLAG6                                                   01028000
$ABNDBIT EQU   $FLAG6                                                   01029000
$FLAG8   EQU   $COMMFLG+7                                               01030000
$TCECM   EQU   $FLAG8                                                   01031000
$FLAG13  EQU   $COMMFLG+12                                              01032000
$CATMSG  EQU   $FLAG13                                                  01033000
$DEVTBLE EQU   TOLTEPWA+240                                             01034000
$DEVCDS  EQU   $DEVTBLE                                                 01035000
$DEVUNAD EQU   $DEVCDS                                                  01036000
@NM00045 EQU   $DEVUNAD+2                                               01037000
$DEVFEAT EQU   $DEVCDS+4                                                01038000
$DEVCDSF EQU   $DEVCDS+9                                                01039000
$DEVSDCF EQU   $DEVCDS+10                                               01040000
$$SYMNME EQU   $DEVCDS+12                                               01041000
$DEVFLG1 EQU   $DEVTBLE+20                                              01042000
$LETGO   EQU   $DEVFLG1                                                 01043000
$GRABBED EQU   $DEVFLG1                                                 01044000
$EVNCPLT EQU   $DEVFLG1                                                 01045000
$ATTNEXP EQU   $DEVFLG1                                                 01046000
$INTOCC  EQU   $DEVFLG1                                                 01047000
$PRIMARY EQU   $DEVFLG1                                                 01048000
$DEVFLG2 EQU   $DEVTBLE+21                                              01049000
$DEVTECB EQU   $DEVTBLE+22                                              01050000
$OPIS    EQU   $DEVTECB                                                 01051000
$OPND    EQU   $DEVTECB+2                                               01052000
$DEVFLG3 EQU   $DEVTBLE+27                                              01053000
$NOTDEV  EQU   $DEVFLG3                                                 01054000
$ACQRED  EQU   $DEVFLG3                                                 01055000
$SIOFLG  EQU   $DEVFLG3                                                 01056000
$SRTEST  EQU   $DEVFLG3                                                 01057000
$OLTERR  EQU   $DEVFLG3                                                 01058000
$IFTOUT  EQU   $DEVTBLE+36                                              01059000
$DEVSESP EQU   $IFTOUT                                                  01060000
$SSCPDAF EQU   $IFTOUT+6                                                01061000
$LDNCBPT EQU   $DEVTBLE+48                                              01062000
$RNINFO  EQU   $DEVTBLE+56                                              01063000
$DEVFLG5 EQU   $RNINFO+8                                                01064000
$DEVFLG4 EQU   $DEVTBLE+65                                              01065000
$DEVCNTS EQU   TOLTEPWA+1464                                            01066000
$CDEVPT  EQU   TOLTEPWA+1466                                            01067000
$SLTBL   EQU   TOLTEPWA+1468                                            01068000
$FAMILY  EQU   $SLTBL                                                   01069000
$SYMBOLC EQU   $SLTBL+5                                                 01070000
$RUNTEST EQU   $SLTBL+13                                                01071000
$TESTSUF EQU   $RUNTEST+5                                               01072000
$TESTFLG EQU   $SLTBL+21                                                01073000
$FINAL   EQU   $TESTFLG                                                 01074000
$CANTRUN EQU   $TESTFLG                                                 01075000
$SECLST  EQU   $SLTBL+22                                                01076000
$SECFLGS EQU   $SECLST+3                                                01077000
$TSTCNT  EQU   $SLTBL+126                                               01078000
$CTSTPT  EQU   $SLTBL+128                                               01079000
$PRIMADR EQU   $SLTBL+130                                               01080000
$INBUFR  EQU   TOLTEPWA+2104                                            01081000
$PASSONA EQU   TOLTEPWA+2264                                            01082000
#EXITA   EQU   TOLTEPWA+2632                                            01083000
$CCOMDAT EQU   TOLTEPWA+2644                                            01084000
$CFLGS   EQU   $CCOMDAT+16                                              01085000
$24FEMSG EQU   TOLTEPWA+2681                                            01086000
$24CATMG EQU   $24FEMSG+11                                              01087000
@NM00054 EQU   TOLTEPWA+2776                                            01088000
$OUNTPTR EQU   @NM00054+4                                               01089000
$NSPTR   EQU   $OUNTPTR                                                 01090000
$NSCNT   EQU   @NM00054+10                                              01091000
$ENXX    EQU   @NM00054+15                                              01092000
$IMITX   EQU   $ENXX                                                    01093000
$TRTN#   EQU   TOLTEPWA+2815                                            01094000
SVESC033 EQU   TOLTEPWA+3160                                            01095000
SVECC013 EQU   TOLTEPWA+3232                                            01096000
SVEIC003 EQU   TOLTEPWA+3592                                            01097000
SVESC022 EQU   TOLTEPWA+3736                                            01098000
SVECC010 EQU   TOLTEPWA+3952                                            01099000
SVECC011 EQU   TOLTEPWA+4024                                            01100000
#EXIT    EQU   0                                                        01101000
@NM00057 EQU   0                                                        01102000
SECTID   EQU   @NM00057                                                 01103000
RTNDISP  EQU   @NM00057+10                                              01104000
INST     EQU   @NM00057+12                                              01105000
#MSGID   EQU   @NM00057+16                                              01106000
$NEWSPRF EQU   0                                                        01107000
$MODEL   EQU   $NEWSPRF+1                                               01108000
$CMODEL  EQU   $NEWSPRF+5                                               01109000
$SCTREQ  EQU   $NEWSPRF+11                                              01110000
#FLAGS   EQU   $NEWSPRF+16                                              01111000
$VIRTUAL EQU   #FLAGS                                                   01112000
#MSGIDRQ EQU   #FLAGS                                                   01113000
$COUNT   EQU   $NEWSPRF+18                                              01114000
OLTENTRY EQU   0                                                        01115000
CDSMAP   EQU   0                                                        01116000
CDSUA    EQU   CDSMAP                                                   01117000
CDSMFCT  EQU   CDSMAP+4                                                 01118000
CDSFEAT  EQU   CDSMFCT+1                                                01119000
CDSFLAG  EQU   CDSMAP+9                                                 01120000
CDSREMSY EQU   CDSFLAG                                                  01121000
CDSNTPRI EQU   CDSFLAG+1                                                01122000
CDSSYMBN EQU   CDSMAP+12                                                01123000
BACKSAVE EQU   0                                                        01124000
ITATCF   EQU   0                                                        01125000
ITATCT   EQU   0                                                        01126000
RCAPTR   EQU   $RCA                                                     01127000
OLTMFCT  EQU   $MODEL                                                   01128000
OLTCMFCT EQU   $CMODEL                                                  01129000
SCTCDS   EQU   $PDEVADR                                                 01130000
SVECC012 EQU   SVESC022                                                 01131000
SVEIC00A EQU   SVEIC003                                                 01132000
SVEIC004 EQU   SVEIC003                                                 01133000
SVEIC005 EQU   SVEIC003                                                 01134000
SVESC02A EQU   SVESC022                                                 01135000
SVESC02B EQU   SVESC022                                                 01136000
SVESC02D EQU   SVESC022                                                 01137000
SVESC02E EQU   SVESC022                                                 01138000
SVESC02F EQU   SVECC013                                                 01139000
SVESC024 EQU   SVESC022                                                 01140000
SVESC027 EQU   SVESC022                                                 01141000
SVESC029 EQU   SVESC033                                                 01142000
SVESC031 EQU   SVECC013                                                 01143000
SVESC032 EQU   SVECC011                                                 01144000
SVETC037 EQU   SVEIC003                                                 01145000
         AGO   .@UNREFD                START UNREFERENCED COMPONENTS    01146000
CDSEXARA EQU   CDSMAP+20                                                01147000
CDSEXTM  EQU   CDSFLAG+2                                                01148000
CDSEXTB  EQU   CDSFLAG+2                                                01149000
CDSTMERB EQU   CDSFLAG+2                                                01150000
@NM00062 EQU   CDSFLAG+1                                                01151000
CDSDVPRO EQU   CDSFLAG+1                                                01152000
CDSLINCN EQU   CDSFLAG                                                  01153000
CDS2CHAN EQU   CDSFLAG                                                  01154000
CDSSYMB  EQU   CDSFLAG                                                  01155000
CDSEXTPR EQU   CDSFLAG                                                  01156000
CDSFEVOL EQU   CDSFLAG                                                  01157000
CDSSHAR  EQU   CDSFLAG                                                  01158000
CDSFPMD  EQU   CDSFLAG                                                  01159000
CDSBYTCT EQU   CDSMAP+8                                                 01160000
CDSTYPE  EQU   CDSMFCT+3                                                01161000
CDSCLASS EQU   CDSMFCT+2                                                01162000
@NM00061 EQU   CDSFEAT                                                  01163000
CDSDEVM  EQU   CDSFEAT                                                  01164000
CDSDEVT  EQU   CDSFEAT                                                  01165000
CDSASCII EQU   CDSFEAT                                                  01166000
CDSMODEL EQU   CDSMFCT                                                  01167000
$RME     EQU   $NEWSPRF+36                                              01168000
@NM00060 EQU   $NEWSPRF+35                                              01169000
$ECA     EQU   $NEWSPRF+32                                              01170000
$DCHB    EQU   $NEWSPRF+28                                              01171000
$MOSIZE  EQU   $NEWSPRF+24                                              01172000
$RTSIZE  EQU   $NEWSPRF+20                                              01173000
$REFNUM  EQU   $NEWSPRF+17                                              01174000
@NM00059 EQU   #FLAGS                                                   01175000
#PLKMCOR EQU   #FLAGS                                                   01176000
@NM00058 EQU   #FLAGS                                                   01177000
$PLINK$  EQU   $NEWSPRF+12                                              01178000
$RM      EQU   $NEWSPRF+9                                               01179000
$CTYPE   EQU   $NEWSPRF+8                                               01180000
$CCLASS  EQU   $NEWSPRF+7                                               01181000
$CFEAT   EQU   $NEWSPRF+6                                               01182000
$TYPE    EQU   $NEWSPRF+4                                               01183000
$CLASS   EQU   $NEWSPRF+3                                               01184000
$FEAT    EQU   $NEWSPRF+2                                               01185000
$RTN#    EQU   $NEWSPRF                                                 01186000
LEVEL    EQU   @NM00057+8                                               01187000
SVETC035 EQU   TOLTEPWA+3880                                            01188000
SVESC030 EQU   TOLTEPWA+3808                                            01189000
SVESC020 EQU   TOLTEPWA+3664                                            01190000
SVEIC002 EQU   TOLTEPWA+3520                                            01191000
SVECC014 EQU   TOLTEPWA+3376                                            01192000
SVESC120 EQU   TOLTEPWA+3304                                            01193000
SVESC025 EQU   TOLTEPWA+3088                                            01194000
@NM00056 EQU   TOLTEPWA+2980                                            01195000
$RPLERR  EQU   TOLTEPWA+2977                                            01196000
@NM00055 EQU   TOLTEPWA+2976                                            01197000
$R13PR3  EQU   TOLTEPWA+2972                                            01198000
$CEINT2  EQU   TOLTEPWA+2968                                            01199000
$CEINT1  EQU   TOLTEPWA+2964                                            01200000
$MSGGET  EQU   TOLTEPWA+2960                                            01201000
$ACQLIST EQU   TOLTEPWA+2956                                            01202000
$R4SAVE1 EQU   TOLTEPWA+2952                                            01203000
$CLSISS  EQU   TOLTEPWA+2950                                            01204000
$CLSCNT  EQU   TOLTEPWA+2948                                            01205000
$CUTABLE EQU   TOLTEPWA+2868                                            01206000
$BUFSZ2  EQU   TOLTEPWA+2864                                            01207000
$RESID2  EQU   TOLTEPWA+2860                                            01208000
$OLTCCW2 EQU   TOLTEPWA+2856                                            01209000
$ENDBFR2 EQU   TOLTEPWA+2852                                            01210000
$1STBFR2 EQU   TOLTEPWA+2848                                            01211000
$TECB2   EQU   TOLTEPWA+2844                                            01212000
$BUFSZ1  EQU   TOLTEPWA+2840                                            01213000
$RESID1  EQU   TOLTEPWA+2836                                            01214000
$OLTCCW1 EQU   TOLTEPWA+2832                                            01215000
$ENDBFR1 EQU   TOLTEPWA+2828                                            01216000
$1STBFR1 EQU   TOLTEPWA+2824                                            01217000
$TECB1   EQU   TOLTEPWA+2820                                            01218000
$WAITIME EQU   TOLTEPWA+2816                                            01219000
$WIODEV  EQU   TOLTEPWA+2814                                            01220000
$RQSTSZE EQU   TOLTEPWA+2812                                            01221000
$RQSTPTR EQU   TOLTEPWA+2808                                            01222000
$R4SAVE  EQU   TOLTEPWA+2804                                            01223000
$PARTADR EQU   TOLTEPWA+2800                                            01224000
$TBSDATA EQU   TOLTEPWA+2796                                            01225000
$CTWIDTH EQU   TOLTEPWA+2795                                            01226000
$CTLINE  EQU   TOLTEPWA+2794                                            01227000
$APWIDTH EQU   TOLTEPWA+2793                                            01228000
$APLINE  EQU   TOLTEPWA+2792                                            01229000
$INDEX   EQU   $IMITX                                                   01230000
$UMXX    EQU   @NM00054+14                                              01231000
$NSXX    EQU   @NM00054+12                                              01232000
$ATACNT  EQU   $NSCNT                                                   01233000
$CTR     EQU   @NM00054+8                                               01234000
$ATAPTR  EQU   $NSPTR                                                   01235000
$DDRPTR  EQU   @NM00054                                                 01236000
$DTORESP EQU   TOLTEPWA+2712                                            01237000
$APNAME  EQU   TOLTEPWA+2704                                            01238000
$24SYMNE EQU   $24CATMG+4                                               01239000
$24DEVAD EQU   $24CATMG                                                 01240000
$24RTN#  EQU   $24FEMSG+8                                               01241000
$ESECTID EQU   $24FEMSG                                                 01242000
$24FLGS  EQU   TOLTEPWA+2680                                            01243000
$24SAVE2 EQU   TOLTEPWA+2676                                            01244000
$24SAVE1 EQU   TOLTEPWA+2672                                            01245000
$24UNADR EQU   TOLTEPWA+2668                                            01246000
$24SAV13 EQU   TOLTEPWA+2664                                            01247000
$24RETCD EQU   TOLTEPWA+2663                                            01248000
$MACID   EQU   TOLTEPWA+2661                                            01249000
$CSPARE  EQU   $CFLGS                                                   01250000
$C2WAY   EQU   $CFLGS                                                   01251000
$CINCT   EQU   $CCOMDAT+12                                              01252000
$CINADR  EQU   $CCOMDAT+8                                               01253000
$COUTCT  EQU   $CCOMDAT+4                                               01254000
$COUTAD  EQU   $CCOMDAT                                                 01255000
ROOTLOC  EQU   TOLTEPWA+2640                                            01256000
$RETREG  EQU   TOLTEPWA+2636                                            01257000
$WORK    EQU   TOLTEPWA+2376                                            01258000
$EXTA    EQU   TOLTEPWA+2320                                            01259000
$TRMINPT EQU   TOLTEPWA+2184                                            01260000
$BUFFER  EQU   TOLTEPWA+1976                                            01261000
$TLTRPL3 EQU   TOLTEPWA+1856                                            01262000
$TLTRPL2 EQU   TOLTEPWA+1736                                            01263000
$TLTRPL1 EQU   TOLTEPWA+1616                                            01264000
@NM00053 EQU   $SLTBL+135                                               01265000
$HIGHRTN EQU   $SLTBL+134                                               01266000
$SECTION EQU   $SECLST                                                  01267000
$SECACT  EQU   $TESTFLG                                                 01268000
$TESTNUM EQU   $RUNTEST+1                                               01269000
$LETPRF  EQU   $RUNTEST                                                 01270000
$FEEDBCK EQU   $DEVTBLE+66                                              01271000
$WTISUED EQU   $DEVFLG4                                                 01272000
$EXIOISD EQU   $DEVFLG4                                                 01273000
$REMWRIT EQU   $DEVFLG4                                                 01274000
$REMDONE EQU   $DEVFLG4                                                 01275000
$2NDUSED EQU   $DEVFLG4                                                 01276000
$1STUSED EQU   $DEVFLG4                                                 01277000
$IGLXIFB EQU   $DEVFLG4                                                 01278000
$EXIOLV3 EQU   $DEVFLG4                                                 01279000
@NM00052 EQU   $DEVFLG5                                                 01280000
$DVBASIC EQU   $DEVFLG5                                                 01281000
$ASCII   EQU   $DEVFLG5                                                 01282000
$DEVLU   EQU   $DEVFLG5                                                 01283000
$OPNDFAL EQU   $DEVFLG5                                                 01284000
$ACQNCB  EQU   $DEVFLG5                                                 01285000
$REMOTE  EQU   $DEVFLG5                                                 01286000
$ENDNODE EQU   $DEVFLG5                                                 01287000
$LINENME EQU   $RNINFO                                                  01288000
$CID     EQU   $DEVTBLE+52                                              01289000
$DVCOL   EQU   $LDNCBPT+2                                               01290000
$DVROW   EQU   $LDNCBPT                                                 01291000
$NCSPLP  EQU   $DEVTBLE+44                                              01292000
$DVLN    EQU   $SSCPDAF                                                 01293000
$DAF     EQU   $DEVSESP+4                                               01294000
$VARYPAB EQU   $DEVSESP                                                 01295000
$SYSMN   EQU   $DEVTBLE+28                                              01296000
@NM00051 EQU   $DEVFLG3                                                 01297000
$CLRSNT  EQU   $DEVFLG3                                                 01298000
$DVSNDOK EQU   $SIOFLG                                                  01299000
$POLLREQ EQU   $DEVFLG3                                                 01300000
$DVINCT  EQU   $DEVTBLE+26                                              01301000
$DVBRKST EQU   $OPND+1                                                  01302000
$DVBRKSN EQU   $OPND                                                    01303000
$DVSEQNO EQU   $OPIS                                                    01304000
$CEINTRP EQU   $DEVFLG2                                                 01305000
$TESTMDE EQU   $DEVFLG2                                                 01306000
$DEVALOC EQU   $DEVFLG2                                                 01307000
$ALLDATA EQU   $DEVFLG2                                                 01308000
$ENDCNTL EQU   $DEVFLG2                                                 01309000
$CTLDEV  EQU   $DEVFLG2                                                 01310000
$NOCDS   EQU   $DEVFLG2                                                 01311000
$DATAIN  EQU   $DEVFLG2                                                 01312000
$DVCTBYT EQU   $INTOCC                                                  01313000
$DEVACT  EQU   $DEVFLG1                                                 01314000
$DVLGMDE EQU   $ATTNEXP                                                 01315000
$DVSPRM  EQU   $EVNCPLT                                                 01316000
$CATASTR EQU   $DEVFLG1                                                 01317000
$CURELEM EQU   $$SYMNME+4                                               01318000
$MSGOTSD EQU   $$SYMNME                                                 01319000
$EXTDEV  EQU   $DEVCDS+11                                               01320000
@NM00050 EQU   $DEVSDCF                                                 01321000
$NOTPRIM EQU   $DEVSDCF                                                 01322000
@NM00049 EQU   $DEVCDSF                                                 01323000
@NM00048 EQU   $DEVCDSF                                                 01324000
@NM00047 EQU   $DEVCDSF                                                 01325000
$CDSNAME EQU   $DEVCDSF                                                 01326000
$EXTRN   EQU   $DEVCDSF                                                 01327000
$CEVOLUM EQU   $DEVCDSF                                                 01328000
$SHARD   EQU   $DEVCDSF                                                 01329000
$DEVFPM  EQU   $DEVCDSF                                                 01330000
$DEVCNT  EQU   $DEVCDS+8                                                01331000
$DEVTYPE EQU   $DEVFEAT+3                                               01332000
$DEVCLAS EQU   $DEVFEAT+2                                               01333000
$DEVFRRS EQU   $DEVFEAT+1                                               01334000
$DEVMOD  EQU   $DEVFEAT                                                 01335000
$DEVRDGT EQU   @NM00045+1                                               01336000
$DEVCTLU EQU   @NM00045+1                                               01337000
$DEVCHAN EQU   @NM00045                                                 01338000
@NM00046 EQU   @NM00045                                                 01339000
$CTINDX  EQU   $DEVUNAD                                                 01340000
@NM00044 EQU   $COMMFLG+15                                              01341000
@NM00043 EQU   $COMMFLG+14                                              01342000
@NM00042 EQU   $COMMFLG+13                                              01343000
$TEP2ND  EQU   $FLAG13                                                  01344000
$TEP1ST  EQU   $FLAG13                                                  01345000
$PRMPTSW EQU   $FLAG13                                                  01346000
$DEVENT  EQU   $FLAG13                                                  01347000
$OLTMACC EQU   $FLAG13                                                  01348000
$LGON    EQU   $FLAG13                                                  01349000
$CTLOGON EQU   $FLAG13                                                  01350000
@NM00041 EQU   $COMMFLG+11                                              01351000
@NM00040 EQU   $COMMFLG+10                                              01352000
@NM00039 EQU   $COMMFLG+9                                               01353000
@NM00038 EQU   $COMMFLG+8                                               01354000
$VS2     EQU   $FLAG8                                                   01355000
$VS1     EQU   $FLAG8                                                   01356000
$EDOS    EQU   $FLAG8                                                   01357000
@NM00037 EQU   $FLAG8                                                   01358000
$TWOWAY  EQU   $FLAG8                                                   01359000
@NM00036 EQU   $FLAG8                                                   01360000
@NM00035 EQU   $COMMFLG+6                                               01361000
$CIREQ   EQU   $FLAG6                                                   01362000
$ABTERM  EQU   $ABNDBIT                                                 01363000
$DISCREQ EQU   $FLAG6                                                   01364000
$DISCISS EQU   $FLAG6                                                   01365000
$CHANGE  EQU   $FLAG6                                                   01366000
$CTERROR EQU   $FLAG6                                                   01367000
$RECAL11 EQU   $FLAG6                                                   01368000
@NM00034 EQU   $FLAG5                                                   01369000
$PROGCK  EQU   $CANCEL                                                  01370000
$PRINTAP EQU   $FLAG5                                                   01371000
@NM00033 EQU   $FLAG5                                                   01372000
$MSG922  EQU   $FLAG5                                                   01373000
$CT924   EQU   $FLAG5                                                   01374000
@NM00032 EQU   $COMMFLG+3                                               01375000
@NM00031 EQU   $COMMFLG+2                                               01376000
$PARTIAL EQU   $FLAG2                                                   01377000
$VALDTST EQU   $FLAG2                                                   01378000
$VALDDEV EQU   $FLAG2                                                   01379000
$DBLSLSH EQU   $FLAG2                                                   01380000
@NM00030 EQU   $FLAG2                                                   01381000
@NM00029 EQU   $FLAG1                                                   01382000
$OPTCHNG EQU   $FLAG1                                                   01383000
$DEVCHNG EQU   $FLAG1                                                   01384000
$TESTCNG EQU   $FLAG1                                                   01385000
$CNSLFG  EQU   $FLAG1                                                   01386000
$TEP3RD  EQU   $FLAG1                                                   01387000
@NM00028 EQU   $CDA+120                                                 01388000
$CUCNT   EQU   $CDA+118                                                 01389000
@NM00027 EQU   $CDA+117                                                 01390000
$PRTFORM EQU   $CDA+116                                                 01391000
$OPISCNT EQU   $CDA+114                                                 01392000
$OPNDCNT EQU   $CDA+112                                                 01393000
$GETMSZE EQU   $CDA+110                                                 01394000
$ACTLVL  EQU   $CDA+105                                                 01395000
$PRNTLVL EQU   $CDA+104                                                 01396000
$TIMEALW EQU   $CDA+96                                                  01397000
$PTRAREA EQU   $CDA+92                                                  01398000
$GETMPTR EQU   $CDA+88                                                  01399000
$R13PTRT EQU   $CDA+84                                                  01400000
$R13PTR  EQU   $CDA+80                                                  01401000
$TEPEND  EQU   $CDA+76                                                  01402000
$PLINKDL EQU   $CDA+72                                                  01403000
$TEPBEGN EQU   $CDA+68                                                  01404000
$FRELPTR EQU   $CDA+64                                                  01405000
$LOMOREC EQU   $CDA+56                                                  01406000
$ENDCOMM EQU   $CDA+48                                                  01407000
$COMMON  EQU   $RCA                                                     01408000
$SLASHAD EQU   $CDA+32                                                  01409000
$PASSON  EQU   $CDA+28                                                  01410000
$TOLBRTB EQU   $CDA+24                                                  01411000
$SCTPTR8 EQU   $CDA+20                                                  01412000
$TBWDPTR EQU   $CDA+12                                                  01413000
$TFWDPTR EQU   $CDA+8                                                   01414000
@NM00026 EQU   $CDA                                                     01415000
@NM00025 EQU   $SCTTBLE+98                                              01416000
$SCTLWTC EQU   $SCTTBLE+96                                              01417000
$SCTLWTA EQU   $SCTTBLE+92                                              01418000
#EXT     EQU   $SCTTBLE+88                                              01419000
#PASS    EQU   $SCTTBLE+84                                              01420000
#TABLE   EQU   $SCTTBLE+80                                              01421000
@NM00024 EQU   $SCTTBLE+71                                              01422000
$R249255 EQU   $ROUTMSK+29                                              01423000
$R241248 EQU   $ROUTMSK+28                                              01424000
$R233240 EQU   $ROUTMSK+27                                              01425000
$R225232 EQU   $ROUTMSK+26                                              01426000
$R217224 EQU   $ROUTMSK+25                                              01427000
$R209216 EQU   $ROUTMSK+24                                              01428000
$R201208 EQU   $ROUTMSK+23                                              01429000
$R193200 EQU   $ROUTMSK+22                                              01430000
$R185192 EQU   $ROUTMSK+21                                              01431000
$R177184 EQU   $ROUTMSK+20                                              01432000
$R169176 EQU   $ROUTMSK+19                                              01433000
$R161168 EQU   $ROUTMSK+18                                              01434000
$R153160 EQU   $ROUTMSK+17                                              01435000
$R145152 EQU   $ROUTMSK+16                                              01436000
$R137144 EQU   $ROUTMSK+15                                              01437000
$R129136 EQU   $ROUTMSK+14                                              01438000
$R121128 EQU   $ROUTMSK+13                                              01439000
$R113120 EQU   $ROUTMSK+12                                              01440000
$R105112 EQU   $ROUTMSK+11                                              01441000
$R097104 EQU   $ROUTMSK+10                                              01442000
$R089096 EQU   $ROUTMSK+9                                               01443000
$R081088 EQU   $ROUTMSK+8                                               01444000
$R073080 EQU   $ROUTMSK+7                                               01445000
$R065072 EQU   $ROUTMSK+6                                               01446000
$R057064 EQU   $ROUTMSK+5                                               01447000
$R049056 EQU   $ROUTMSK+4                                               01448000
$R041048 EQU   $ROUTMSK+3                                               01449000
$R033040 EQU   $ROUTMSK+2                                               01450000
$R025032 EQU   $ROUTMSK+1                                               01451000
$R017024 EQU   $ROUTMSK                                                 01452000
$TOTFLG2 EQU   $SCTTBLE+39                                              01453000
@NM00023 EQU   $TOTFLG1                                                 01454000
@NM00022 EQU   $TOTFLG1                                                 01455000
@NM00021 EQU   $TOTFLG1                                                 01456000
$CURELOD EQU   $TOTFLG1                                                 01457000
$CTEQTT  EQU   $TOTFLG1                                                 01458000
@NM00020 EQU   $TOTFLG1                                                 01459000
@NM00019 EQU   $TOTFLG1                                                 01460000
$LINESHR EQU   $TOTFLG1                                                 01461000
@NM00018 EQU   $OLTFLG2                                                 01462000
@NM00017 EQU   $OLTFLG2                                                 01463000
@NM00016 EQU   $OLTFLG2                                                 01464000
@NM00015 EQU   $OLTFLG2                                                 01465000
@NM00014 EQU   $OLTFLG2                                                 01466000
@NM00013 EQU   $OLTFLG2                                                 01467000
@NM00012 EQU   $OLTFLG2                                                 01468000
@NM00011 EQU   $OLTFLGS                                                 01469000
$TRACE   EQU   $OLTFLGS                                                 01470000
$RETCODE EQU   $OLTFLGS                                                 01471000
$CONTCB  EQU   $OLTFLGS                                                 01472000
$RETAIN  EQU   $OLTFLGS                                                 01473000
$MANINTV EQU   $OLTFLGS                                                 01474000
$OLTSIZE EQU   $SCTTBLE+34                                              01475000
$QSCTMOD EQU   $EXECFLG                                                 01476000
$CTRLMOD EQU   $EXECFLG                                                 01477000
$RTNSLCT EQU   $EXECFLG                                                 01478000
$MULTDEV EQU   $EXECFLG                                                 01479000
@NM00010 EQU   $EXECFLG                                                 01480000
$RMSKCNT EQU   $SCTTBLE+32                                              01481000
$SYNAME  EQU   $CDS8T19+4                                               01482000
$EXTSIG  EQU   $CDS8T19+3                                               01483000
$CDFLGS  EQU   $CDS8T19+1                                               01484000
$CDSCNT  EQU   $CDS8T19                                                 01485000
$PDEVDSC EQU   $SCTTBLE+16                                              01486000
$COMMCN  EQU   $CDSFLGS                                                 01487000
$CUSTSYM EQU   $CDSFLGS                                                 01488000
$TWOCHSW EQU   $CDSFLGS                                                 01489000
$SYMNAME EQU   $CDSFLGS                                                 01490000
$EXTINTC EQU   $CDSFLGS                                                 01491000
$CEVOL   EQU   $CDSFLGS                                                 01492000
$SHARED  EQU   $CDSFLGS                                                 01493000
$FPM     EQU   $CDSFLGS                                                 01494000
$LASTSUB EQU   $PDEVFLG                                                 01495000
@NM00009 EQU   $PDEVFLG                                                 01496000
@NM00008 EQU   $PDEVFLG                                                 01497000
@NM00007 EQU   $PDEVFLG                                                 01498000
$LASTDEV EQU   $PDEVFLG                                                 01499000
@NM00006 EQU   $PDEVFLG                                                 01500000
$EXFILPT EQU   $PDEVFLG                                                 01501000
$FPMOLD  EQU   $PDEVFLG                                                 01502000
$TSSSYM  EQU   $SCTTBLE+8                                               01503000
$DRIVER  EQU   $SCTTBLE+6                                               01504000
$RT0916  EQU   $SCTTBLE+5                                               01505000
$RT0108  EQU   $SCTTBLE+4                                               01506000
$LOOPTST EQU   $ERROPT                                                  01507000
$NERRPRT EQU   $ERROPT                                                  01508000
$ALTPRNT EQU   $ERROPT                                                  01509000
$FSTCOMM EQU   $TESTOPT                                                 01510000
$INDEFLP EQU   $TESTOPT                                                 01511000
$NOPRT   EQU   $TESTOPT                                                 01512000
$PARAPRT EQU   $TESTOPT                                                 01513000
@NM00005 EQU   $TESTOPT                                                 01514000
$TLTEND  EQU   $RCAAREA+945                                             01515000
$CNSLID  EQU   $RCAAREA+936                                             01516000
$EXITSAV EQU   $RCAAREA+864                                             01517000
$TRASCII EQU   $RCAAREA+608                                             01518000
@NM00004 EQU   $RCAAREA+605                                             01519000
$VTAMEND EQU   $RCAFLG                                                  01520000
$TPPOSTD EQU   $RCAFLG                                                  01521000
$NEWCT   EQU   $RCAFLG                                                  01522000
$ABNDALL EQU   $RCAFLG                                                  01523000
$CUTESTB EQU   $RCAFLG                                                  01524000
$CONSOLE EQU   $RCAFLG                                                  01525000
$TPLOGON EQU   $RCAFLG                                                  01526000
$UPDATE  EQU   $RCAFLG                                                  01527000
$DEVAREA EQU   $RCAAREA+600                                             01528000
$CTDVAR  EQU   $RCAAREA+596                                             01529000
$BUFFS   EQU   $RCAAREA+464                                             01530000
$TLTNIB  EQU   $CONSTNT+140                                             01531000
$TLTPRPL EQU   $CONSTNT+20                                              01532000
@NM00003 EQU   $CONSTNT+4                                               01533000
@NM00002 EQU   $CONSTNT+2                                               01534000
$USECNT  EQU   $CONSTNT                                                 01535000
$CURRTWA EQU   $POINTER+140                                             01536000
$CTNAME  EQU   $POINTER+132                                             01537000
$CTARGX  EQU   $POINTER+128                                             01538000
$COMINT  EQU   $POINTER+120                                             01539000
$QUEHNDL EQU   $POINTER+116                                             01540000
@NM00001 EQU   $POINTER+36                                              01541000
$RTNPTR  EQU   $POINTER+32                                              01542000
$TLTECB2 EQU   $POINTER+28                                              01543000
$TLTECB1 EQU   $POINTER+24                                              01544000
$CLEANP  EQU   $POINTER+20                                              01545000
$ABEND   EQU   $POINTER+16                                              01546000
$LSTAREA EQU   $POINTER+12                                              01547000
$FSTAREA EQU   $POINTER+8                                               01548000
$CVTSAVE EQU   $POINTER+4                                               01549000
$TOLTEP  EQU   $POINTER                                                 01550000
$TLTACB  EQU   $RCAAREA                                                 01551000
.@UNREFD ANOP                          END UNREFERENCED COMPONENTS      01552000
@RT00046 EQU   C10C0005                                                 01553000
@RT00059 EQU   C10C0004                                                 01554000
@RT00071 EQU   C10C0008                                                 01555000
@RT00078 EQU   C10C0007                                                 01556000
@RT00085 EQU   C10C0021                                                 01557000
@RT00087 EQU   C10C0026                                                 01558000
@RT00090 EQU   C10C0022                                                 01559000
@RT00095 EQU   C10C0026                                                 01560000
@RT00097 EQU   C10C0020                                                 01561000
@RT00099 EQU   C10C0024                                                 01562000
@RT00101 EQU   C10C0023                                                 01563000
@RT00103 EQU   C10C0027                                                 01564000
@ENDDATA EQU   *                                                        01565000
         END   ISTCC010,(C'PLS1304',0702,78336)                         01566000
./  ADD  SSI=83360315,NAME=ISTCC012
         TITLE 'ISTCC012,RETURN CODE HANDLING AND TRACE FUNCTION'       00001000
ISTCC012 CSECT ,                                                   0001 00002000
@MAINENT DS    0H                                                  0001 00003000
         USING *,@15                                               0001 00004000
         B     @PROLOG                                             0001 00005000
         DC    AL1(16)                                             0001 00006000
         DC    C'ISTCC012  78.336'                                 0001 00007000
         DROP  @15                                                      00008000
@PROLOG  STM   @14,@15,12(@13)                                     0001 00009000
         STM   @01,@12,24(@13)                                     0001 00010000
         BALR  @04,0                                               0001 00011000
@PSTART  DS    0H                                                  0001 00012000
         USING @PSTART,@04                                         0001 00013000
*                                                                  0047 00014000
*/********************************************************************/ 00015000
*/*      INITIAL PREPARATIONS                                        */ 00016000
*/********************************************************************/ 00017000
*                                                                  0048 00018000
*C12C0010:                                                         0048 00019000
*   ;                                                              0048 00020000
C12C0010 DS    0H                                                  0049 00021000
*   R15=R13;                        /* SET PTE TO BACKSAVE DSECT     */ 00022000
         LR    R15,R13                                             0049 00023000
*   R13=ADDR(SVECC012);             /* SET PTR TO SAVE AREA          */ 00024000
         LA    R13,SVECC012(,WAPTR)                                0050 00025000
*   BACKSAVE(3)=R13;                /* CHAIN SAVE AREAS TOGETHER     */ 00026000
         ST    R13,BACKSAVE+8(,R15)                                0051 00027000
*   SVECC012(2)=R15;                                               0052 00028000
         ST    R15,SVECC012+4(,WAPTR)                              0052 00029000
*   $INBUFR='         ';            /* CLEAR INBUFFER                */ 00030000
         MVI   $INBUFR+9(WAPTR),C' '                               0053 00031000
         MVC   $INBUFR+10(70,WAPTR),$INBUFR+9(WAPTR)               0053 00032000
         MVC   $INBUFR(9,WAPTR),@CC00513                           0053 00033000
*   R0=0;                           /* CLEAR REGISTER 0              */ 00034000
         SLR   R0,R0                                               0054 00035000
*   R15=TRBKSV(5);                  /* GET RETURN CODE               */ 00036000
         L     @01,$R13PTR(,WAPTR)                                 0055 00037000
         L     R15,TRBKSV+16(,@01)                                 0055 00038000
*/********************************************************************/ 00039000
*/*      DETERMINE IF MODE FUNCTION WAS CALLED                       */ 00040000
*/********************************************************************/ 00041000
*                                                                  0056 00042000
*   IF $MACID='40'                  /* WAS MODE CALLED?              */ 00043000
*     THEN                                                         0056 00044000
         CLC   $MACID(2,WAPTR),@CC00515                            0056 00045000
         BNE   @RF00056                                            0056 00046000
*     DO;                           /* YES                           */ 00047000
*       R0=1;                       /* SET ERROR ACTION INDICATOR    */ 00048000
         LA    R0,1                                                0058 00049000
*       $INBUFR(1:8)=$RUNTEST;      /* MOVE IN TEST                  */ 00050000
*                                                                  0059 00051000
         MVC   $INBUFR(8,WAPTR),$RUNTEST(WAPTR)                    0059 00052000
*       /*************************************************************/ 00053000
*       /*                                                           */ 00054000
*       /* TCEC MSGN(229)SUB(YES) INVOKED                            */ 00055000
*       /*                                                           */ 00056000
*       /*************************************************************/ 00057000
*                                                                  0060 00058000
*       $TCECM='1'B;                /* SET TCEC SW IN RCA            */ 00059000
         OI    $TCECM(WAPTR),B'00000001'                           0060 00060000
*       R1=ADDR($TCA08);            /* SET UP PARM LIST $TR          */ 00061000
         LA    R1,$TCA08                                           0061 00062000
*       CALL #EXIT;                 /* CALL CECOM                    */ 00063000
         L     @15,#EXITA(,WAPTR)                                  0062 00064000
         BALR  @14,@15                                             0062 00065000
*       DCL                                                        0063 00066000
*         1 $TCA08,                 /* TCEC PARM LIST                */ 00067000
*          2 $TCB08 FIXED(32) INIT(229),/* MSG NUMBER                */ 00068000
*          2 $TCC08 FIXED(32) INIT(0),/* INCT LEN                    */ 00069000
*          2 $TCD08 BIT(8) INIT('10000000'B),/* FLAG                 */ 00070000
*          2 $TCE08 CHAR(4) INIT('FFFFFFFF'X);/* MSSAGE MASK GO PRINT   00071000
*                                      MODE                          */ 00072000
*       GOTO C12C0070;              /* GO RETURN TO CALLER           */ 00073000
         B     C12C0070                                            0064 00074000
*     END;                                                         0065 00075000
*                                                                  0065 00076000
*/********************************************************************/ 00077000
*/*      IF OLT IS IN CLEANUP, RETURN CODE HANDLING IS NOT PERFORMED */ 00078000
*/********************************************************************/ 00079000
*                                                                  0066 00080000
*   IF $CLEANUP='1'B                /* CLEANUP IN PROGRESS           */ 00081000
*     THEN                                                         0066 00082000
@RF00056 TM    $CLEANUP(WAPTR),B'00000100'                         0066 00083000
         BO    @RT00066                                            0066 00084000
*     GOTO C12C0030;                /* BR IF YES                     */ 00085000
*/********************************************************************/ 00086000
*/*      RETURN CODE HANDLING ROUTINE                                */ 00087000
*/********************************************************************/ 00088000
*                                                                  0068 00089000
*   IF(TRTAB(R15/4+1)&$RETMASK)¬=0  /* CAN OLT HANDLE RC             */ 00090000
*     THEN                                                         0068 00091000
         LR    @14,R15                                             0068 00092000
         SRL   @14,2                                               0068 00093000
         SLR   @12,@12                                             0068 00094000
         IC    @12,TRTAB(@14)                                      0068 00095000
         SLR   @14,@14                                             0068 00096000
         IC    @14,$RETMASK(,WAPTR)                                0068 00097000
         NR    @12,@14                                             0068 00098000
         LTR   @12,@12                                             0068 00099000
         BZ    @RF00068                                            0068 00100000
*     DO;                           /* IF NOT THEN DO FOLLOWING      */ 00101000
*       R0=1;                       /* SET ACTION INDICATOR TO 1     */ 00102000
         LA    R0,1                                                0070 00103000
*       $INBUFR(1)='*';             /* SET ERROR ASTERIK             */ 00104000
         MVI   $INBUFR(WAPTR),C'*'                                 0071 00105000
*       GOTO C12C0050;              /* GO ISSUE TRACE MSG            */ 00106000
         B     C12C0050                                            0072 00107000
*     END;                                                         0073 00108000
*                                                                  0073 00109000
*/********************************************************************/ 00110000
*/*      DETERMINE IF TRACE OPTION IS SELECTED                       */ 00111000
*/********************************************************************/ 00112000
*                                                                  0074 00113000
*C12C0030:                                                         0074 00114000
*   ;                                                              0074 00115000
@RF00068 DS    0H                                                  0074 00116000
C12C0030 DS    0H                                                  0075 00117000
*   IF $TRACE='0'B                  /* IS TRACE ON                   */ 00118000
*     THEN                                                         0075 00119000
         TM    $TRACE(WAPTR),B'00000100'                           0075 00120000
         BZ    @RT00075                                            0075 00121000
*     GOTO C12C0070;                                               0076 00122000
*                                                                  0076 00123000
*/********************************************************************/ 00124000
*/*      TRACE ROUTINE                                               */ 00125000
*/********************************************************************/ 00126000
*                                                                  0077 00127000
*C12C0050:                                                         0077 00128000
*   ;                                                              0077 00129000
C12C0050 DS    0H                                                  0078 00130000
*   IF $MACID='47'&                 /* CHK FOR ROUTINE ZTR2473       */ 00131000
*       TRBKSV(5)=4                 /* CALL WHEN NOT ZTR2473         */ 00132000
*     THEN                          /* RUN IF FOUND ZTR2473          */ 00133000
         CLC   $MACID(2,WAPTR),@CC00533                            0078 00134000
         BNE   @RF00078                                            0078 00135000
         L     @01,$R13PTR(,WAPTR)                                 0078 00136000
         CLC   TRBKSV+16(4,@01),@CF00032                           0078 00137000
         BE    @RT00078                                            0078 00138000
*     GOTO C12C0070;                /* DO NOT TRACE ZTR2473          */ 00139000
*   $PRTONLY='1'B;                  /* SET PRINTER ONLY              */ 00140000
@RF00078 OI    $PRTONLY(WAPTR),B'00001000'                         0080 00141000
*   CVD($TRTN#,TRWK);               /* CONVERT ACTIVE RTN TO DEC.    */ 00142000
         SLR   @14,@14                                             0081 00143000
         IC    @14,$TRTN#(,WAPTR)                                  0081 00144000
         CVD   @14,@TS00001                                        0081 00145000
         MVC   TRWK(4),@TS00001+4                                  0081 00146000
*   UNPK($INBUFR(2:4),TRWK(3:4));   /* UNPACK IT FOR PRINTING        */ 00147000
         UNPK  $INBUFR+1(3,WAPTR),TRWK+2(2)                        0082 00148000
*   $INBUFR(4:4)=$INBUFR(4:4)|'0';  /* GET PRINTABLE CHAR            */ 00149000
         OI    $INBUFR+3(WAPTR),C'0'                               0083 00150000
*   $INBUFR(5:6)=$MACID;            /* MOVE IN MACRO CALL ID         */ 00151000
         MVC   $INBUFR+4(2,WAPTR),$MACID(WAPTR)                    0084 00152000
*   TRWK=TRBKSV(4);                 /* GET RETURN ADDRESS            */ 00153000
*                                                                  0085 00154000
         L     @14,$R13PTR(,WAPTR)                                 0085 00155000
         MVC   TRWK(4),TRBKSV+12(@14)                              0085 00156000
*   /*****************************************************************/ 00157000
*   /*                                                               */ 00158000
*   /* ITACONV FROM(TRWK)TO($INBUFR(7),8) INVOKED                    */ 00159000
*   /*                                                               */ 00160000
*   /*****************************************************************/ 00161000
*                                                                  0086 00162000
*   DCL                                                            0086 00163000
*    (ITATCF,                                                      0086 00164000
*     ITATCT) CHAR(*) BASED;        /* GENERATE WORK VARABLES        */ 00165000
*   DCL                                                            0087 00166000
*     ITATCTS FIXED;                /* TEMP SPOT FOR ALTERED BYTE    */ 00167000
*   RFY                                                            0088 00168000
*     ITATCF BASED(ADDR(TRWK));     /* MAP VARIABLE OVER FROM        */ 00169000
*   RFY                                                            0089 00170000
*     ITATCT BASED(ADDR($INBUFR(7)));/* MAP VARIBABLE OVER TO        */ 00171000
*   ITATCTS=ITATCT(8+1:8+1);        /* SAVE BYTE PAST TO FIELD       */ 00172000
         LA    @12,$INBUFR+6(,WAPTR)                               0090 00173000
         SLR   ITATCTS,ITATCTS                                     0090 00174000
         IC    ITATCTS,ITATCT+8(,@12)                              0090 00175000
*   UNPK(ITATCT(1:8+1),ITATCF(1:LENGTH(TRWK)+1));/* EXPAND HEX TO  0091 00176000
*                                      EBCDIC                        */ 00177000
         LA    @07,TRWK                                            0091 00178000
         UNPK  ITATCT(9,@12),ITATCF(5,@07)                         0091 00179000
*   TR(ITATCT(1:8),$TRTBL);         /* CONVERT FA-FF TO C1-C6        */ 00180000
         L     @01,RCAPTR(,WAPTR)                                  0092 00181000
         L     @01,$TRTBLA(,@01)                                   0092 00182000
         TR    ITATCT(8,@12),$TRTBL(@01)                           0092 00183000
*   ITATCT(8+1:8+1)=ITATCTS;        /* RESTORE BYTE PAST TO FIELD    */ 00184000
         STC   ITATCTS,ITATCT+8(,@12)                              0093 00185000
*/* CONVERT TO EBCDIC                                                */ 00186000
*                                                                  0094 00187000
*   TRWK=TRBKSV(5);                 /* GET RETURN CODE               */ 00188000
         MVC   TRWK(4),TRBKSV+16(@14)                              0094 00189000
*   IF $MACID='47'                  /* WAS ROUTINE CALLED?           */ 00190000
*     THEN                                                         0095 00191000
         CLC   $MACID(2,WAPTR),@CC00533                            0095 00192000
         BNE   @RF00095                                            0095 00193000
*     DO;                           /* YES                           */ 00194000
*       $INBUFR(15:20)=' ';         /* CLEAR PART OF MSG             */ 00195000
         MVI   $INBUFR+15(WAPTR),C' '                              0097 00196000
         MVC   $INBUFR+16(4,WAPTR),$INBUFR+15(WAPTR)               0097 00197000
         MVI   $INBUFR+14(WAPTR),C' '                              0097 00198000
*       GO TO C12C0060;             /* GO OUTPUT TRACE MSG           */ 00199000
         B     C12C0060                                            0098 00200000
*     END;                                                         0099 00201000
*   $INBUFR(15:18)=',RC ';          /* MOVE IN RETURN CODE           */ 00202000
*                                                                  0100 00203000
@RF00095 MVC   $INBUFR+14(4,WAPTR),@CC00550                        0100 00204000
*   /*****************************************************************/ 00205000
*   /*                                                               */ 00206000
*   /* ITACONV FROM(RETCD)TO($INBUFR(19),2) INVOKED                  */ 00207000
*   /*                                                               */ 00208000
*   /*****************************************************************/ 00209000
*                                                                  0101 00210000
*   RFY                                                            0101 00211000
*     ITATCF BASED(ADDR(RETCD));    /* MAP VARIABLE OVER FROM        */ 00212000
*   RFY                                                            0102 00213000
*     ITATCT BASED(ADDR($INBUFR(19)));/* MAP VARIBABLE OVER TO       */ 00214000
*   ITATCTS=ITATCT(2+1:2+1);        /* SAVE BYTE PAST TO FIELD       */ 00215000
         LA    @14,$INBUFR+18(,WAPTR)                              0103 00216000
         SLR   ITATCTS,ITATCTS                                     0103 00217000
         IC    ITATCTS,ITATCT+2(,@14)                              0103 00218000
*   UNPK(ITATCT(1:2+1),ITATCF(1:LENGTH(RETCD)+1));/* EXPAND HEX TO 0104 00219000
*                                      EBCDIC                        */ 00220000
         LA    @12,RETCD                                           0104 00221000
         UNPK  ITATCT(3,@14),ITATCF(2,@12)                         0104 00222000
*   TR(ITATCT(1:2),$TRTBL);         /* CONVERT FA-FF TO C1-C6        */ 00223000
         L     @01,RCAPTR(,WAPTR)                                  0105 00224000
         L     @01,$TRTBLA(,@01)                                   0105 00225000
         TR    ITATCT(2,@14),$TRTBL(@01)                           0105 00226000
*   ITATCT(2+1:2+1)=ITATCTS;        /* RESTORE BYTE PAST TO FIELD    */ 00227000
         STC   ITATCTS,ITATCT+2(,@14)                              0106 00228000
*/* CONVERT TO EBCDIC                                                */ 00229000
*/********************************************************************/ 00230000
*/*      TRACE MESSAGE IS PRINTED                                    */ 00231000
*/********************************************************************/ 00232000
*                                                                  0107 00233000
*C12C0060:                                                         0107 00234000
*   ;                                                              0107 00235000
*                                                                  0107 00236000
C12C0060 DS    0H                                                  0108 00237000
*   /*****************************************************************/ 00238000
*   /*                                                               */ 00239000
*   /* TCEC MSGN(450)SUB(YES) INVOKED                                */ 00240000
*   /*                                                               */ 00241000
*   /*****************************************************************/ 00242000
*                                                                  0108 00243000
*   $TCECM='1'B;                    /* SET TCEC SW IN RCA            */ 00244000
         OI    $TCECM(WAPTR),B'00000001'                           0108 00245000
*   R1=ADDR($TCA11);                /* SET UP PARM LIST $TR          */ 00246000
         LA    R1,$TCA11                                           0109 00247000
*   CALL #EXIT;                     /* CALL CECOM                    */ 00248000
         L     @15,#EXITA(,WAPTR)                                  0110 00249000
         BALR  @14,@15                                             0110 00250000
*   DCL                                                            0111 00251000
*     1 $TCA11,                     /* TCEC PARM LIST                */ 00252000
*      2 $TCB11 FIXED(32) INIT(450),/* MSG NUMBER                    */ 00253000
*      2 $TCC11 FIXED(32) INIT(0),  /* INCT LEN                      */ 00254000
*      2 $TCD11 BIT(8) INIT('10000000'B),/* FLAG                     */ 00255000
*      2 $TCE11 CHAR(4) INIT('FFFFFFFF'X);/* MSSAGE MASK GO PRINT  0111 00256000
*                                      TRACE MSG                     */ 00257000
*   $PRTONLY='0'B;                  /* RESET PRINTER ONLY FLAG       */ 00258000
         NI    $PRTONLY(WAPTR),B'11110111'                         0112 00259000
*/********************************************************************/ 00260000
*/*      RETURN TO THE CALLER                                        */ 00261000
*/********************************************************************/ 00262000
*                                                                  0113 00263000
*C12C0070:                                                         0113 00264000
*   ;                                                              0113 00265000
C12C0070 DS    0H                                                  0114 00266000
*   R13=SVECC012(2);                                               0114 00267000
         L     R13,SVECC012+4(,WAPTR)                              0114 00268000
*   DO;                             /* ATDSPLY                       */ 00269000
*   END;                            /* ATDSPLY                       */ 00270000
*   END;                                                           0117 00271000
@EL00001 DS    0H                                                  0117 00272000
@EF00001 DS    0H                                                  0117 00273000
@ER00001 LM    @14,@15,12(@13)                                     0117 00274000
         LM    @01,@12,24(@13)                                     0117 00275000
         BR    @14                                                 0117 00276000
@DATA    DS    0H                                                       00277000
         DS    0F                                                       00278000
         DS    0F                                                       00279000
@CF00032 DC    F'4'                                                     00280000
         DS    0D                                                       00281000
         DS    0D                                                       00282000
@TS00001 DS    CL8                                                      00283000
@CC00513 DC    C'         '                                             00284000
@CC00550 DC    C',RC '                                                  00285000
@CC00515 DC    C'40'                                                    00286000
@CC00533 DC    C'47'                                                    00287000
TRWK     DS    CL4                                                      00288000
         ORG   TRWK                                                     00289000
@NM00054 DS    CL1                                                      00290000
RETAD    DS    CL3                                                      00291000
         ORG   RETAD                                                    00292000
@NM00055 DS    CL2                                                      00293000
RETCD    DS    CL1                                                      00294000
         ORG   TRWK+4                                                   00295000
         DS    CL3                                                      00296000
$TCA08   DS    CL13                                                     00297000
         ORG   $TCA08                                                   00298000
$TCB08   DC    A(229)                                                   00299000
$TCC08   DC    A(0)                                                     00300000
$TCD08   DC    B'10000000'                                              00301000
$TCE08   DC    X'FFFFFFFF'                                              00302000
         ORG   $TCA08+13                                                00303000
         DS    CL3                                                      00304000
$TCA11   DS    CL13                                                     00305000
         ORG   $TCA11                                                   00306000
$TCB11   DC    A(450)                                                   00307000
$TCC11   DC    A(0)                                                     00308000
$TCD11   DC    B'10000000'                                              00309000
$TCE11   DC    X'FFFFFFFF'                                              00310000
         ORG   $TCA11+13                                                00311000
TRTAB    DC    XL1'00'                                                  00312000
         DC    XL1'80'                                                  00313000
         DC    XL1'40'                                                  00314000
         DC    XL1'20'                                                  00315000
         DC    XL1'10'                                                  00316000
         DC    XL1'08'                                                  00317000
         DC    XL1'04'                                                  00318000
         DC    XL1'02'                                                  00319000
         DC    XL1'01'                                                  00320000
         DS    CL2                                                      00321000
PATCH    DC    15F'0'                                                   00322000
@00      EQU   00                      EQUATES FOR REGISTERS 0-15       00323000
@01      EQU   01                                                       00324000
@02      EQU   02                                                       00325000
@03      EQU   03                                                       00326000
@04      EQU   04                                                       00327000
@05      EQU   05                                                       00328000
@06      EQU   06                                                       00329000
@07      EQU   07                                                       00330000
@08      EQU   08                                                       00331000
@09      EQU   09                                                       00332000
@10      EQU   10                                                       00333000
@11      EQU   11                                                       00334000
@12      EQU   12                                                       00335000
@13      EQU   13                                                       00336000
@14      EQU   14                                                       00337000
@15      EQU   15                                                       00338000
ITATCTS  EQU   @06                                                      00339000
WAPTR    EQU   @02                                                      00340000
R0       EQU   @00                                                      00341000
R1       EQU   @01                                                      00342000
R13      EQU   @13                                                      00343000
R15      EQU   @15                                                      00344000
R10      EQU   @10                                                      00345000
R11      EQU   @11                                                      00346000
R12      EQU   @12                                                      00347000
R14      EQU   @14                                                      00348000
R2       EQU   @02                                                      00349000
R3       EQU   @03                                                      00350000
R4       EQU   @04                                                      00351000
R5       EQU   @05                                                      00352000
R6       EQU   @06                                                      00353000
R7       EQU   @07                                                      00354000
R8       EQU   @08                                                      00355000
R9       EQU   @09                                                      00356000
$RCAAREA EQU   0                                                        00357000
$POINTER EQU   $RCAAREA+100                                             00358000
$TRTBLA  EQU   $POINTER+124                                             00359000
$CONSTNT EQU   $RCAAREA+244                                             00360000
$RCAFLG  EQU   $RCAAREA+604                                             00361000
$TRTBL   EQU   0                                                        00362000
TOLTEPWA EQU   0                                                        00363000
$SCTTBLE EQU   TOLTEPWA                                                 00364000
$TESTOPT EQU   $SCTTBLE+2                                               00365000
$ERROPT  EQU   $SCTTBLE+3                                               00366000
$PDEVFLG EQU   $SCTTBLE+10                                              00367000
$CDSFLGS EQU   $SCTTBLE+11                                              00368000
$CDS8T19 EQU   $SCTTBLE+20                                              00369000
$EXECFLG EQU   $SCTTBLE+33                                              00370000
$CLEANUP EQU   $EXECFLG                                                 00371000
$OLTFLGS EQU   $SCTTBLE+36                                              00372000
$TRACE   EQU   $OLTFLGS                                                 00373000
$OLTFLG2 EQU   $SCTTBLE+37                                              00374000
$TOTFLG1 EQU   $SCTTBLE+38                                              00375000
$ROUTMSK EQU   $SCTTBLE+40                                              00376000
$RETMASK EQU   $SCTTBLE+70                                              00377000
$CDA     EQU   TOLTEPWA+100                                             00378000
$RCA     EQU   $CDA+44                                                  00379000
$OLTPTR  EQU   $CDA+52                                                  00380000
$LOWADDR EQU   $OLTPTR                                                  00381000
$HIMOREC EQU   $CDA+60                                                  00382000
$R13PTR  EQU   $CDA+80                                                  00383000
$COMMFLG EQU   TOLTEPWA+224                                             00384000
$FLAG3   EQU   $COMMFLG+2                                               00385000
$PRTONLY EQU   $FLAG3                                                   00386000
$FLAG8   EQU   $COMMFLG+7                                               00387000
$TCECM   EQU   $FLAG8                                                   00388000
$SLTBL   EQU   TOLTEPWA+1468                                            00389000
$RUNTEST EQU   $SLTBL+13                                                00390000
$TESTFLG EQU   $SLTBL+21                                                00391000
$SECLST  EQU   $SLTBL+22                                                00392000
$INBUFR  EQU   TOLTEPWA+2104                                            00393000
#EXITA   EQU   TOLTEPWA+2632                                            00394000
$CCOMDAT EQU   TOLTEPWA+2644                                            00395000
$CFLGS   EQU   $CCOMDAT+16                                              00396000
$MACID   EQU   TOLTEPWA+2661                                            00397000
$24FEMSG EQU   TOLTEPWA+2681                                            00398000
$24CATMG EQU   $24FEMSG+11                                              00399000
@NM00047 EQU   TOLTEPWA+2776                                            00400000
$OUNTPTR EQU   @NM00047+4                                               00401000
$NSPTR   EQU   $OUNTPTR                                                 00402000
$NSCNT   EQU   @NM00047+10                                              00403000
$ENXX    EQU   @NM00047+15                                              00404000
$IMITX   EQU   $ENXX                                                    00405000
$TRTN#   EQU   TOLTEPWA+2815                                            00406000
SVESC033 EQU   TOLTEPWA+3160                                            00407000
SVECC013 EQU   TOLTEPWA+3232                                            00408000
SVEIC003 EQU   TOLTEPWA+3592                                            00409000
SVESC022 EQU   TOLTEPWA+3736                                            00410000
SVECC011 EQU   TOLTEPWA+4024                                            00411000
#EXIT    EQU   0                                                        00412000
@NM00050 EQU   0                                                        00413000
RTNDISP  EQU   @NM00050+10                                              00414000
INST     EQU   @NM00050+12                                              00415000
$NEWSPRF EQU   0                                                        00416000
#FLAGS   EQU   $NEWSPRF+16                                              00417000
TRBKSV   EQU   0                                                        00418000
BACKSAVE EQU   0                                                        00419000
ITATCF   EQU   0                                                        00420000
ITATCT   EQU   0                                                        00421000
OLTENTRY EQU   0                                                        00422000
RCAPTR   EQU   $RCA                                                     00423000
SVECC012 EQU   SVESC022                                                 00424000
SVEIC00A EQU   SVEIC003                                                 00425000
SVEIC004 EQU   SVEIC003                                                 00426000
SVEIC005 EQU   SVEIC003                                                 00427000
SVESC02A EQU   SVESC022                                                 00428000
SVESC02B EQU   SVESC022                                                 00429000
SVESC02D EQU   SVESC022                                                 00430000
SVESC02E EQU   SVESC022                                                 00431000
SVESC02F EQU   SVECC013                                                 00432000
SVESC024 EQU   SVESC022                                                 00433000
SVESC027 EQU   SVESC022                                                 00434000
SVESC029 EQU   SVESC033                                                 00435000
SVESC031 EQU   SVECC013                                                 00436000
SVESC032 EQU   SVECC011                                                 00437000
SVETC037 EQU   SVEIC003                                                 00438000
         AGO   .@UNREFD                START UNREFERENCED COMPONENTS    00439000
$RME     EQU   $NEWSPRF+36                                              00440000
@NM00053 EQU   $NEWSPRF+35                                              00441000
$ECA     EQU   $NEWSPRF+32                                              00442000
$DCHB    EQU   $NEWSPRF+28                                              00443000
$MOSIZE  EQU   $NEWSPRF+24                                              00444000
$RTSIZE  EQU   $NEWSPRF+20                                              00445000
$COUNT   EQU   $NEWSPRF+18                                              00446000
$REFNUM  EQU   $NEWSPRF+17                                              00447000
@NM00052 EQU   #FLAGS                                                   00448000
#MSGIDRQ EQU   #FLAGS                                                   00449000
#PLKMCOR EQU   #FLAGS                                                   00450000
@NM00051 EQU   #FLAGS                                                   00451000
$VIRTUAL EQU   #FLAGS                                                   00452000
$PLINK$  EQU   $NEWSPRF+12                                              00453000
$SCTREQ  EQU   $NEWSPRF+11                                              00454000
$RM      EQU   $NEWSPRF+9                                               00455000
$CTYPE   EQU   $NEWSPRF+8                                               00456000
$CCLASS  EQU   $NEWSPRF+7                                               00457000
$CFEAT   EQU   $NEWSPRF+6                                               00458000
$CMODEL  EQU   $NEWSPRF+5                                               00459000
$TYPE    EQU   $NEWSPRF+4                                               00460000
$CLASS   EQU   $NEWSPRF+3                                               00461000
$FEAT    EQU   $NEWSPRF+2                                               00462000
$MODEL   EQU   $NEWSPRF+1                                               00463000
$RTN#    EQU   $NEWSPRF                                                 00464000
#MSGID   EQU   @NM00050+16                                              00465000
LEVEL    EQU   @NM00050+8                                               00466000
SECTID   EQU   @NM00050                                                 00467000
SVECC010 EQU   TOLTEPWA+3952                                            00468000
SVETC035 EQU   TOLTEPWA+3880                                            00469000
SVESC030 EQU   TOLTEPWA+3808                                            00470000
SVESC020 EQU   TOLTEPWA+3664                                            00471000
SVEIC002 EQU   TOLTEPWA+3520                                            00472000
SVECC014 EQU   TOLTEPWA+3376                                            00473000
SVESC120 EQU   TOLTEPWA+3304                                            00474000
SVESC025 EQU   TOLTEPWA+3088                                            00475000
@NM00049 EQU   TOLTEPWA+2980                                            00476000
$RPLERR  EQU   TOLTEPWA+2977                                            00477000
@NM00048 EQU   TOLTEPWA+2976                                            00478000
$R13PR3  EQU   TOLTEPWA+2972                                            00479000
$CEINT2  EQU   TOLTEPWA+2968                                            00480000
$CEINT1  EQU   TOLTEPWA+2964                                            00481000
$MSGGET  EQU   TOLTEPWA+2960                                            00482000
$ACQLIST EQU   TOLTEPWA+2956                                            00483000
$R4SAVE1 EQU   TOLTEPWA+2952                                            00484000
$CLSISS  EQU   TOLTEPWA+2950                                            00485000
$CLSCNT  EQU   TOLTEPWA+2948                                            00486000
$CUTABLE EQU   TOLTEPWA+2868                                            00487000
$BUFSZ2  EQU   TOLTEPWA+2864                                            00488000
$RESID2  EQU   TOLTEPWA+2860                                            00489000
$OLTCCW2 EQU   TOLTEPWA+2856                                            00490000
$ENDBFR2 EQU   TOLTEPWA+2852                                            00491000
$1STBFR2 EQU   TOLTEPWA+2848                                            00492000
$TECB2   EQU   TOLTEPWA+2844                                            00493000
$BUFSZ1  EQU   TOLTEPWA+2840                                            00494000
$RESID1  EQU   TOLTEPWA+2836                                            00495000
$OLTCCW1 EQU   TOLTEPWA+2832                                            00496000
$ENDBFR1 EQU   TOLTEPWA+2828                                            00497000
$1STBFR1 EQU   TOLTEPWA+2824                                            00498000
$TECB1   EQU   TOLTEPWA+2820                                            00499000
$WAITIME EQU   TOLTEPWA+2816                                            00500000
$WIODEV  EQU   TOLTEPWA+2814                                            00501000
$RQSTSZE EQU   TOLTEPWA+2812                                            00502000
$RQSTPTR EQU   TOLTEPWA+2808                                            00503000
$R4SAVE  EQU   TOLTEPWA+2804                                            00504000
$PARTADR EQU   TOLTEPWA+2800                                            00505000
$TBSDATA EQU   TOLTEPWA+2796                                            00506000
$CTWIDTH EQU   TOLTEPWA+2795                                            00507000
$CTLINE  EQU   TOLTEPWA+2794                                            00508000
$APWIDTH EQU   TOLTEPWA+2793                                            00509000
$APLINE  EQU   TOLTEPWA+2792                                            00510000
$INDEX   EQU   $IMITX                                                   00511000
$UMXX    EQU   @NM00047+14                                              00512000
$NSXX    EQU   @NM00047+12                                              00513000
$ATACNT  EQU   $NSCNT                                                   00514000
$CTR     EQU   @NM00047+8                                               00515000
$ATAPTR  EQU   $NSPTR                                                   00516000
$DDRPTR  EQU   @NM00047                                                 00517000
$DTORESP EQU   TOLTEPWA+2712                                            00518000
$APNAME  EQU   TOLTEPWA+2704                                            00519000
$24SYMNE EQU   $24CATMG+4                                               00520000
$24DEVAD EQU   $24CATMG                                                 00521000
$24RTN#  EQU   $24FEMSG+8                                               00522000
$ESECTID EQU   $24FEMSG                                                 00523000
$24FLGS  EQU   TOLTEPWA+2680                                            00524000
$24SAVE2 EQU   TOLTEPWA+2676                                            00525000
$24SAVE1 EQU   TOLTEPWA+2672                                            00526000
$24UNADR EQU   TOLTEPWA+2668                                            00527000
$24SAV13 EQU   TOLTEPWA+2664                                            00528000
$24RETCD EQU   TOLTEPWA+2663                                            00529000
$CSPARE  EQU   $CFLGS                                                   00530000
$C2WAY   EQU   $CFLGS                                                   00531000
$CINCT   EQU   $CCOMDAT+12                                              00532000
$CINADR  EQU   $CCOMDAT+8                                               00533000
$COUTCT  EQU   $CCOMDAT+4                                               00534000
$COUTAD  EQU   $CCOMDAT                                                 00535000
ROOTLOC  EQU   TOLTEPWA+2640                                            00536000
$RETREG  EQU   TOLTEPWA+2636                                            00537000
$WORK    EQU   TOLTEPWA+2376                                            00538000
$EXTA    EQU   TOLTEPWA+2320                                            00539000
$PASSONA EQU   TOLTEPWA+2264                                            00540000
$TRMINPT EQU   TOLTEPWA+2184                                            00541000
$BUFFER  EQU   TOLTEPWA+1976                                            00542000
$TLTRPL3 EQU   TOLTEPWA+1856                                            00543000
$TLTRPL2 EQU   TOLTEPWA+1736                                            00544000
$TLTRPL1 EQU   TOLTEPWA+1616                                            00545000
@NM00046 EQU   $SLTBL+135                                               00546000
$HIGHRTN EQU   $SLTBL+134                                               00547000
$PRIMADR EQU   $SLTBL+130                                               00548000
$CTSTPT  EQU   $SLTBL+128                                               00549000
$TSTCNT  EQU   $SLTBL+126                                               00550000
$SECFLGS EQU   $SECLST+3                                                00551000
$SECTION EQU   $SECLST                                                  00552000
$SECACT  EQU   $TESTFLG                                                 00553000
$CANTRUN EQU   $TESTFLG                                                 00554000
$FINAL   EQU   $TESTFLG                                                 00555000
$TESTSUF EQU   $RUNTEST+5                                               00556000
$TESTNUM EQU   $RUNTEST+1                                               00557000
$LETPRF  EQU   $RUNTEST                                                 00558000
$SYMBOLC EQU   $SLTBL+5                                                 00559000
$FAMILY  EQU   $SLTBL                                                   00560000
@NM00045 EQU   TOLTEPWA+1464                                            00561000
$DEVTBLE EQU   TOLTEPWA+240                                             00562000
@NM00044 EQU   $COMMFLG+15                                              00563000
@NM00043 EQU   $COMMFLG+14                                              00564000
@NM00042 EQU   $COMMFLG+13                                              00565000
@NM00041 EQU   $COMMFLG+12                                              00566000
@NM00040 EQU   $COMMFLG+11                                              00567000
@NM00039 EQU   $COMMFLG+10                                              00568000
@NM00038 EQU   $COMMFLG+9                                               00569000
@NM00037 EQU   $COMMFLG+8                                               00570000
$VS2     EQU   $FLAG8                                                   00571000
$VS1     EQU   $FLAG8                                                   00572000
$EDOS    EQU   $FLAG8                                                   00573000
@NM00036 EQU   $FLAG8                                                   00574000
$TWOWAY  EQU   $FLAG8                                                   00575000
@NM00035 EQU   $FLAG8                                                   00576000
@NM00034 EQU   $COMMFLG+6                                               00577000
@NM00033 EQU   $COMMFLG+5                                               00578000
@NM00032 EQU   $COMMFLG+4                                               00579000
@NM00031 EQU   $COMMFLG+3                                               00580000
$NEWAP   EQU   $FLAG3                                                   00581000
$ALTPRTR EQU   $FLAG3                                                   00582000
$OPTERR  EQU   $FLAG3                                                   00583000
$REQSTOR EQU   $FLAG3                                                   00584000
$LOGOFFE EQU   $FLAG3                                                   00585000
$TSTERR  EQU   $FLAG3                                                   00586000
$DEVERR  EQU   $FLAG3                                                   00587000
@NM00030 EQU   $COMMFLG+1                                               00588000
@NM00029 EQU   $COMMFLG                                                 00589000
@NM00028 EQU   $CDA+120                                                 00590000
$CUCNT   EQU   $CDA+118                                                 00591000
@NM00027 EQU   $CDA+117                                                 00592000
$PRTFORM EQU   $CDA+116                                                 00593000
$OPISCNT EQU   $CDA+114                                                 00594000
$OPNDCNT EQU   $CDA+112                                                 00595000
$GETMSZE EQU   $CDA+110                                                 00596000
$GRCNTS  EQU   $CDA+108                                                 00597000
$CTLCNT  EQU   $CDA+106                                                 00598000
$ACTLVL  EQU   $CDA+105                                                 00599000
$PRNTLVL EQU   $CDA+104                                                 00600000
$ERRCNTA EQU   $CDA+102                                                 00601000
$TLCNT   EQU   $CDA+100                                                 00602000
$TIMEALW EQU   $CDA+96                                                  00603000
$PTRAREA EQU   $CDA+92                                                  00604000
$GETMPTR EQU   $CDA+88                                                  00605000
$R13PTRT EQU   $CDA+84                                                  00606000
$TEPEND  EQU   $CDA+76                                                  00607000
$PLINKDL EQU   $CDA+72                                                  00608000
$TEPBEGN EQU   $CDA+68                                                  00609000
$FRELPTR EQU   $CDA+64                                                  00610000
$HIGHADR EQU   $HIMOREC                                                 00611000
$LOMOREC EQU   $CDA+56                                                  00612000
$ENDCOMM EQU   $CDA+48                                                  00613000
$COMMON  EQU   $RCA                                                     00614000
$SLASHAD EQU   $CDA+32                                                  00615000
$PASSON  EQU   $CDA+28                                                  00616000
$TOLBRTB EQU   $CDA+24                                                  00617000
$SCTPTR8 EQU   $CDA+20                                                  00618000
$SCTPTR  EQU   $CDA+16                                                  00619000
$TBWDPTR EQU   $CDA+12                                                  00620000
$TFWDPTR EQU   $CDA+8                                                   00621000
@NM00026 EQU   $CDA                                                     00622000
@NM00025 EQU   $SCTTBLE+98                                              00623000
$SCTLWTC EQU   $SCTTBLE+96                                              00624000
$SCTLWTA EQU   $SCTTBLE+92                                              00625000
#EXT     EQU   $SCTTBLE+88                                              00626000
#PASS    EQU   $SCTTBLE+84                                              00627000
#TABLE   EQU   $SCTTBLE+80                                              00628000
#MSGIDAC EQU   $SCTTBLE+78                                              00629000
@NM00024 EQU   $SCTTBLE+71                                              00630000
$R249255 EQU   $ROUTMSK+29                                              00631000
$R241248 EQU   $ROUTMSK+28                                              00632000
$R233240 EQU   $ROUTMSK+27                                              00633000
$R225232 EQU   $ROUTMSK+26                                              00634000
$R217224 EQU   $ROUTMSK+25                                              00635000
$R209216 EQU   $ROUTMSK+24                                              00636000
$R201208 EQU   $ROUTMSK+23                                              00637000
$R193200 EQU   $ROUTMSK+22                                              00638000
$R185192 EQU   $ROUTMSK+21                                              00639000
$R177184 EQU   $ROUTMSK+20                                              00640000
$R169176 EQU   $ROUTMSK+19                                              00641000
$R161168 EQU   $ROUTMSK+18                                              00642000
$R153160 EQU   $ROUTMSK+17                                              00643000
$R145152 EQU   $ROUTMSK+16                                              00644000
$R137144 EQU   $ROUTMSK+15                                              00645000
$R129136 EQU   $ROUTMSK+14                                              00646000
$R121128 EQU   $ROUTMSK+13                                              00647000
$R113120 EQU   $ROUTMSK+12                                              00648000
$R105112 EQU   $ROUTMSK+11                                              00649000
$R097104 EQU   $ROUTMSK+10                                              00650000
$R089096 EQU   $ROUTMSK+9                                               00651000
$R081088 EQU   $ROUTMSK+8                                               00652000
$R073080 EQU   $ROUTMSK+7                                               00653000
$R065072 EQU   $ROUTMSK+6                                               00654000
$R057064 EQU   $ROUTMSK+5                                               00655000
$R049056 EQU   $ROUTMSK+4                                               00656000
$R041048 EQU   $ROUTMSK+3                                               00657000
$R033040 EQU   $ROUTMSK+2                                               00658000
$R025032 EQU   $ROUTMSK+1                                               00659000
$R017024 EQU   $ROUTMSK                                                 00660000
$TOTFLG2 EQU   $SCTTBLE+39                                              00661000
@NM00023 EQU   $TOTFLG1                                                 00662000
@NM00022 EQU   $TOTFLG1                                                 00663000
@NM00021 EQU   $TOTFLG1                                                 00664000
$CURELOD EQU   $TOTFLG1                                                 00665000
$CTEQTT  EQU   $TOTFLG1                                                 00666000
@NM00020 EQU   $TOTFLG1                                                 00667000
@NM00019 EQU   $TOTFLG1                                                 00668000
$LINESHR EQU   $TOTFLG1                                                 00669000
@NM00018 EQU   $OLTFLG2                                                 00670000
@NM00017 EQU   $OLTFLG2                                                 00671000
@NM00016 EQU   $OLTFLG2                                                 00672000
@NM00015 EQU   $OLTFLG2                                                 00673000
@NM00014 EQU   $OLTFLG2                                                 00674000
@NM00013 EQU   $OLTFLG2                                                 00675000
@NM00012 EQU   $OLTFLG2                                                 00676000
$TALK    EQU   $OLTFLG2                                                 00677000
$DYCOM   EQU   $OLTFLGS                                                 00678000
@NM00011 EQU   $OLTFLGS                                                 00679000
$RETCODE EQU   $OLTFLGS                                                 00680000
$CONTCB  EQU   $OLTFLGS                                                 00681000
$RETAIN  EQU   $OLTFLGS                                                 00682000
$CLEANRT EQU   $OLTFLGS                                                 00683000
$MANINTV EQU   $OLTFLGS                                                 00684000
$OLTSIZE EQU   $SCTTBLE+34                                              00685000
$QSCTMOD EQU   $EXECFLG                                                 00686000
$CTRLMOD EQU   $EXECFLG                                                 00687000
$LSTPDEV EQU   $EXECFLG                                                 00688000
$ERRCNT  EQU   $EXECFLG                                                 00689000
$RTNSLCT EQU   $EXECFLG                                                 00690000
$MULTDEV EQU   $EXECFLG                                                 00691000
@NM00010 EQU   $EXECFLG                                                 00692000
$RMSKCNT EQU   $SCTTBLE+32                                              00693000
$SYNAME  EQU   $CDS8T19+4                                               00694000
$EXTSIG  EQU   $CDS8T19+3                                               00695000
$CDFLGS  EQU   $CDS8T19+1                                               00696000
$CDSCNT  EQU   $CDS8T19                                                 00697000
$PDEVDSC EQU   $SCTTBLE+16                                              00698000
$PDEVADR EQU   $SCTTBLE+12                                              00699000
$COMMCN  EQU   $CDSFLGS                                                 00700000
$CUSTSYM EQU   $CDSFLGS                                                 00701000
$TWOCHSW EQU   $CDSFLGS                                                 00702000
$SYMNAME EQU   $CDSFLGS                                                 00703000
$EXTINTC EQU   $CDSFLGS                                                 00704000
$CEVOL   EQU   $CDSFLGS                                                 00705000
$SHARED  EQU   $CDSFLGS                                                 00706000
$FPM     EQU   $CDSFLGS                                                 00707000
$LASTSUB EQU   $PDEVFLG                                                 00708000
@NM00009 EQU   $PDEVFLG                                                 00709000
@NM00008 EQU   $PDEVFLG                                                 00710000
@NM00007 EQU   $PDEVFLG                                                 00711000
$LASTDEV EQU   $PDEVFLG                                                 00712000
@NM00006 EQU   $PDEVFLG                                                 00713000
$EXFILPT EQU   $PDEVFLG                                                 00714000
$FPMOLD  EQU   $PDEVFLG                                                 00715000
$TSSSYM  EQU   $SCTTBLE+8                                               00716000
$SCTLEVL EQU   $SCTTBLE+7                                               00717000
$DRIVER  EQU   $SCTTBLE+6                                               00718000
$RT0916  EQU   $SCTTBLE+5                                               00719000
$RT0108  EQU   $SCTTBLE+4                                               00720000
$LOOPTST EQU   $ERROPT                                                  00721000
$LOOPERR EQU   $ERROPT                                                  00722000
$NERRPRT EQU   $ERROPT                                                  00723000
$NOCNTRL EQU   $ERROPT                                                  00724000
$ALTPRNT EQU   $ERROPT                                                  00725000
$CATERR  EQU   $ERROPT                                                  00726000
$ASTERIK EQU   $ERROPT                                                  00727000
$TESTERR EQU   $ERROPT                                                  00728000
$FSTCOMM EQU   $TESTOPT                                                 00729000
$INDEFLP EQU   $TESTOPT                                                 00730000
$NOPRT   EQU   $TESTOPT                                                 00731000
$PARAPRT EQU   $TESTOPT                                                 00732000
@NM00005 EQU   $TESTOPT                                                 00733000
$ERRLPCT EQU   $SCTTBLE                                                 00734000
$TLTEND  EQU   $RCAAREA+945                                             00735000
$CNSLID  EQU   $RCAAREA+936                                             00736000
$EXITSAV EQU   $RCAAREA+864                                             00737000
$TRASCII EQU   $RCAAREA+608                                             00738000
@NM00004 EQU   $RCAAREA+605                                             00739000
$VTAMEND EQU   $RCAFLG                                                  00740000
$TPPOSTD EQU   $RCAFLG                                                  00741000
$NEWCT   EQU   $RCAFLG                                                  00742000
$ABNDALL EQU   $RCAFLG                                                  00743000
$CUTESTB EQU   $RCAFLG                                                  00744000
$CONSOLE EQU   $RCAFLG                                                  00745000
$TPLOGON EQU   $RCAFLG                                                  00746000
$UPDATE  EQU   $RCAFLG                                                  00747000
$DEVAREA EQU   $RCAAREA+600                                             00748000
$CTDVAR  EQU   $RCAAREA+596                                             00749000
$BUFFS   EQU   $RCAAREA+464                                             00750000
$TLTNIB  EQU   $CONSTNT+140                                             00751000
$TLTPRPL EQU   $CONSTNT+20                                              00752000
@NM00003 EQU   $CONSTNT+4                                               00753000
@NM00002 EQU   $CONSTNT+2                                               00754000
$USECNT  EQU   $CONSTNT                                                 00755000
$CURRTWA EQU   $POINTER+140                                             00756000
$CTNAME  EQU   $POINTER+132                                             00757000
$CTARGX  EQU   $POINTER+128                                             00758000
$COMINT  EQU   $POINTER+120                                             00759000
$QUEHNDL EQU   $POINTER+116                                             00760000
@NM00001 EQU   $POINTER+36                                              00761000
$RTNPTR  EQU   $POINTER+32                                              00762000
$TLTECB2 EQU   $POINTER+28                                              00763000
$TLTECB1 EQU   $POINTER+24                                              00764000
$CLEANP  EQU   $POINTER+20                                              00765000
$ABEND   EQU   $POINTER+16                                              00766000
$LSTAREA EQU   $POINTER+12                                              00767000
$FSTAREA EQU   $POINTER+8                                               00768000
$CVTSAVE EQU   $POINTER+4                                               00769000
$TOLTEP  EQU   $POINTER                                                 00770000
$TLTACB  EQU   $RCAAREA                                                 00771000
.@UNREFD ANOP                          END UNREFERENCED COMPONENTS      00772000
@RT00066 EQU   C12C0030                                                 00773000
@RT00075 EQU   C12C0070                                                 00774000
@RT00078 EQU   C12C0070                                                 00775000
@ENDDATA EQU   *                                                        00776000
         END   ISTCC012,(C'PLS1305',0702,78336)                         00777000
./  ADD  SSI=83341894,NAME=ISTCC013
         TITLE 'OS/VS LOADER TO BRING IN CDS, PLINK AND ROOT MODULES'   00001000
ISTCC013 CSECT ,                                                   0001 00002000
@MAINENT DS    0H                                                  0001 00003000
         USING *,@15                                               0001 00004000
         B     @PROLOG                                             0001 00005000
         DC    AL1(16)                                             0001 00006000
         DC    C'ISTCC013  78.336'                                 0001 00007000
         DROP  @15                                                      00008000
@PROLOG  ST    @14,12(,@13)                                        0001 00009000
         STM   @02,@12,28(@13)                                     0001 00010000
         BALR  @11,0                                               0001 00011000
@PSTART  DS    0H                                                  0001 00012000
         USING @PSTART,@11                                         0001 00013000
*********************************************************************** 00014000
*                                                                     * 00015000
* STATUS: CHANGE LEVEL 000     SUPPORT CODE: X02008                   * 00016000
*                                                                     * 00017000
* FUNCTION:                                                           * 00018000
*           1. CALCULATES THE SIZE OF THE MODULE (OLT AND PLINK).     * 00019000
*              IF IT IS NOT A CDS LOAD, IT WILL PASS THE SIZE BACK    * 00020000
*              TO THE CALLER. IF IT IS A CDS LOAD, IT WILL LOAD THE   * 00021000
*              REQUESTED NUMBER OF BYTES INTO CORE.                   * 00022000
*                                                                     * 00023000
*           2. LOADS THE REQUESTED OLT, PLINK OR CDS INFORMATION      * 00024000
*              AND RETURNS THE STARTING ADDRESS OF THE LOADED MODULE  * 00025000
*              TO THE CALLER.                                         * 00026000
*                                                                     * 00027000
* ENTRY POINTS: ISTCC013                                              * 00028000
*                                                                     * 00029000
* INPUT: UPON ENTRY TO THIS MODULE REGISTER 1 POINTS TO A LIST WITH   * 00030000
*        THE FOLLOWING PARAMETERS:                                    * 00031000
*                   DS    C  INDICATORS FOR TRANSIENT MANAGER         * 00032000
*                   DS    C  MACRO LEVEL                              * 00033000
*                   DS    2C IDENTITY OF MACRO EXPANSION              * 00034000
*                   DS    F  POINTER TO PARAMETER LIST                * 00035000
*        THIS PARAMETER LIST HAS THE FOLLOWING FORMAT:                * 00036000
*                   DS    8C MODULE NAME                              * 00037000
*                   DS    F  POINTER TO WHERE MODULE SHOULD BE LOADED * 00038000
*                   DS    C  FLAGS                                    * 00039000
*                   DS    C  RESERVED FOR FUTURE USE                  * 00040000
*                   DS    H  CDS MODULE COUNT                         * 00041000
*                                                                     * 00042000
* OUTPUT:  REGISTER 0 WILL CONTAIN MODULE SIZE(FOR COMPUTE REQUEST)   * 00043000
*          REGISTER 1 WILL CONTAIN STARTING ADDRESS OF LOADED MODULE. * 00044000
*          REGISTER 15 WILL CONTAIN RETURN CODES:                     * 00045000
*                   X'00'   LOAD SUCCESSFUL/COMPUTE SUCCESSFUL        * 00046000
*                   X'04'   NO END CARD                               * 00047000
*                   X'08'   READ ERROR                                * 00048000
*                   X'0C'   MODULE NOT FOUND                          * 00049000
*                   X'10'   REP CARD ERROR                            * 00050000
*                   X'14'   LOAD CALLED BEFORE COMPUTE                * 00051000
*                   X'18'   ORDER ERROR                               * 00052000
*                   X'22'   NOT AUTHORIZED TO USE LIBRARY    @ZA31031 * 00053000
*                                                                     * 00054000
*          THE FOLLOWING MESSAGES ARE OUTPUTTED:                      * 00055000
*                                                                     * 00056000
*                 1.    202I  -  THIS MESSAGE WILL INFORM THE USER    * 00057000
*                                THAT AN INVALID REP CARD EXISTS FOR  * 00058000
*                                THE SPECIFIED TEST SECTION.          * 00059000
*                 2.    203I  -  THIS MESSAGE TELLS THE USER THAT AN  * 00060000
*                                END OF FILE INDICATION OCCURED       * 00061000
*                                UNEXPECTANTLY. DATASET MAY HAVE BEEN * 00062000
*                                CREATED INCORRECTLY.                 * 00063000
*                 3.    205I  -  THIS MESSAGE TELLS THE USER THAT AN  * 00064000
*                                I/O ERROR OCCURED DURING THE LOADING * 00065000
*                                OF THE TEST SECTION.                 * 00066000
*                 4.    901I  -  THIS MESSAGE TELLS THE USER THAT THE * 00067000
*                                DD CARD NAMED XXXXXXXX COULD NOT BE  * 00068000
*                                OPENED, THEREFORE THE DATASET IS NOT * 00069000
*                                ACCESSIBLE.                          * 00070000
*                 5.    911I  -  THIS MESSAGE TELLS THE USER THAT AN  * 00071000
*                                INVALID OR UNRECOGNIZEABLE CONTROL   * 00072000
*                                CARD HAS BEEN DETECTED. DATASET MAY  * 00073000
*                                HAVE BEEN CREATED INCORRECTLY.       * 00074000
*                                                                     * 00075000
* EXTERNAL ROUTINES:                                                  * 00076000
*                                                                     * 00077000
*          THIS MODULE WILL ISSUE THE FOLLOWING SYSTEM MACROS:        * 00078000
*                                                                     * 00079000
*                 1. OPEN   TO INITIATE PROCESSING OF REQUIRED DATASET* 00080000
*                 2. CLOSE  TO COMPLETE PROCESSING OF DATA SETS       * 00081000
*                 3. FIND   TO DETERMINE IF A MODULE EXISTS           * 00082000
*                 4. POINT  TO FIND THE RECORD THAT MUST BE READ      * 00083000
*                 5. READ   TO GET THE CONTROL CARDS & MODULE TEXT    * 00084000
*                            INTO CORE                                * 00085000
*                 6. CHECK  TO WAIT FOR COMPLETION OF READ REQUEST    * 00086000
*                 7. NOTE   TO KEEP TRACK OF THE LAST RECORD READ     * 00087000
*                 8. DCB    TO DEFINE THE OLT LIB DCB                 * 00088000
*                                                                     * 00089000
* NORMAL EXITS:                                                       * 00090000
*          TO CALLER WITH RETURN CODE EQUAL TO ZERO.                  * 00091000
*                                                                     * 00092000
* ERROR EXITS:                                                        * 00093000
*          TO CALLER WITH RETURN CODE NOT EQUAL TO ZERO               * 00094000
*                                                                     * 00095000
* TABLES/WORKAREAS:                                                   * 00096000
*          PATCH12 - PATCH AREA                                       * 00097000
*          SAVEAREA- SAVE AREA                                        * 00098000
*          BUFFER  - READ IN BUFFER FOR CONTROL RECORDS(IE ESD, ETC)  * 00099000
*          RLCOREAD- REAL CORE ADDRESS OF MODULE                      * 00100000
*          ASSEMAD - ASSEMBLED ADDRESS OF MODULE(RELATIVE TO ZERO)    * 00101000
*          B28WORK - WORK AREA                                        * 00102000
*          WORK    - WORK AREA                                        * 00103000
*          RELFT   - RELOCATION FACTOR FOR RLD DATA ITEMS             * 00104000
*          RDBUFAD - ADDRESS/POINTER TO READ IN AREA                  * 00105000
*          RDLNGTH - LENGTH OF READ                                   * 00106000
*          RETCODE - RETURN CODE SAVE AREA (DEBUG AID)                * 00107000
*          TTRZ    - TTRZ FOR READ ROUTINE                            * 00108000
*          SIZEAREA- AREA USED TO STORE MODULE SIZE                   * 00109000
*          OLTDCB  - DCB FOR OLT LIBRARY                              * 00110000
*          CHARTBL - TABLE USED TO VALIDATE REP DATA                  * 00111000
*          LDSWITCH- INTERNAL FLAG BYTE                               * 00112000
*             BIT 0- COMPUTE HAS BEEN DONE FOR REQUESTED MODULE       * 00113000
*             BIT 1- THIS IS A TRUNCATED(CDS) LOAD REQUEST            * 00114000
*             BIT 2- TXTHDR & TXT INFORMATION MUST BE PROCESSED       * 00115000
*             BIT 3- COMPUTE HAS BEEN STARTED                         * 00116000
*             BIT 4- FLAG USED TO INDICATE WHICH BYTE OF REP DATA     * 00117000
*                    BEING CONVERTED                                  * 00118000
*             BIT 5- I/O ERROR OCCURED ON LOAD                        * 00119000
*             BIT 6- UNUSED AT PRESENT TIME                           * 00120000
*             BIT 7- UNUSED AT PRESENT TIME                           * 00121000
*                                                                     * 00122000
* CHANGE ACTIVITY:                                                    * 00123000
*      APAR OZ31031                                    @ZA31031       * 00124000
*                                                                     * 00125000
*********************************************************************** 00126000
*   SVECC013(2)=SAVPTR;             /* STORE CALLERS SAVEAREA ADDR   */ 00127000
         ST    SAVPTR,SVECC013+4(,WAPTR)                           0028 00128000
*   BACKSAVE(3)=ADDR(SVECC013);     /* STORE ADDR OF MY SAVEAREA     */ 00129000
         LA    @12,SVECC013(,WAPTR)                                0029 00130000
         ST    @12,BACKSAVE+8(,SAVPTR)                             0029 00131000
*   SAVPTR=ADDR(SVECC013);          /* POINT TO MY SAVEAREA TO CALL  */ 00132000
         LR    SAVPTR,@12                                          0030 00133000
*   GEN CODE SETS(EXITPTR,RCGEN,R1) REFS(MRT202,MRT203,MRT205,MRT901,   00134000
*       MRT911,C13C0091,LDRETMSG,MRT899) FLOWS(LDRETMSG,C13C0091); 0031 00135000
*                               EQUATES                               * 00136000
*********************************************************************** 00137000
*********************************************************************** 00138000
*                              REGISTERS                              * 00139000
*********************************************************************** 00140000
R0       EQU   0                       REGISTER 0                       00141000
*********************************************************************** 00142000
*                     ONE CARD REMOVED SO IT COULD BE DCL IN PLS      * 00143000
*********************************************************************** 00144000
R2       EQU   2                       REGISTER 2                       00145000
R3       EQU   3                       REGISTER 3                       00146000
R4       EQU   4                       REGISTER 4                       00147000
R5       EQU   5                       REGISTER 5                       00148000
R6       EQU   6                       REGISTER 6                       00149000
R7       EQU   7                       REGISTER 7                       00150000
R8       EQU   8                       REGISTER 8                       00151000
R9       EQU   9                       REGISTER 9                       00152000
R10      EQU   10                      REGISTER 10                      00153000
R11      EQU   11                      BASE REGISTER                    00154000
R12      EQU   12                      REGISTER 12                      00155000
R13      EQU   13                      REGISTER 13                      00156000
R14      EQU   14                      REGISTER 14                      00157000
R15      EQU   15                      REGISTER 15                      00158000
DEBREG   EQU   1                   POINTER TO THE DEB FOR AUTH CHECK    00159000
REPPTR   EQU   1                       POINTER TO WHERE REP STARTS      00160000
PLISTREG EQU   3                       PARAMETER LIST POINTER           00161000
FROMADDR EQU   5                       FROM ADDRESS FOR CONVERT         00162000
TOADDR   EQU   6                       TO ADDRESS FOR CONVERT           00163000
LNGTHREG EQU   6                       LENGTH OF READ                   00164000
COUNT    EQU   7                       COUNT FOR CONVERSION ROUTINE     00165000
DATAPTR  EQU   8                       POINTER TO RLD DATA FIELD        00166000
CHAR     EQU   8                       CHARACTER TO BE MATCHED          00167000
NAMEPTR  EQU   8                       POINTER TO MODULE NAME           00168000
RLDBTCNT EQU   9                       NO OF 4 BYTE AREAS IN RLD CARD   00169000
DCBPTR   EQU   9                       POINTER TO NEEDED DCB            00170000
REPBYTE  EQU   9                       CHARACTER TO BE CONVERTED        00171000
TXTBTCNT EQU   9                       TXT BYTE COUNT                   00172000
ESDBTCNT EQU   9                       ESD BYTE COUNT                   00173000
AREAPTR  EQU   10                      POINTER TO READ BUFFER           00174000
TTRZPTR  EQU   10                      POINTER TO TTRZ FOR READ         00175000
INDEX    EQU   10                      INDEX REGISTER                   00176000
*********************************************************************** 00177000
*                       INTERNAL FLAG EQUATES                         * 00178000
*********************************************************************** 00179000
CPTSW    EQU   X'80'                   COMPUTE DONE                     00180000
TRNCL    EQU   X'40'                   TRUNCATED LOAD                   00181000
TWOREADS EQU   X'20'                   TWO READS REQUESTED              00182000
CMPTSTRT EQU   X'10'                   COMPUTE HAS BEEN STARTED         00183000
IOERROR  EQU   X'04'                   I/O ERROR FLAG                   00184000
*********************************************************************** 00185000
*                       PARAMETER LIST EQUATES                        * 00186000
*********************************************************************** 00187000
PLNK     EQU   X'80'                   PLINK REQUESTED                  00188000
CMPTE    EQU   X'40'                   COMPUTE REQUESTED                00189000
CDS      EQU   X'20'                   CDS LOAD                         00190000
SYMBOLIC EQU   X'08'                   SYMBOLIC CDS                     00191000
NAME     EQU   0                       MODULE NAME DISPLACEMENT         00192000
AD       EQU   8                       REAL CORE ADDRESS DISPLACEMENT   00193000
FLAG     EQU   12                      FLAG FIELD DISPLACEMENT          00194000
TCNT     EQU   14                      TRUNCATED COUNT DISPLACEMENT     00195000
*********************************************************************** 00196000
*                       MISCELLANEOUS EQUATES                         * 00197000
*********************************************************************** 00198000
TWICE    EQU   2                       MULTIPLY BY FOUR                 00199000
D0       EQU   0                       DISPLACEMENT ZERO                00200000
SAMEPTR  EQU   1                       SAME ESD ID                      00201000
D1       EQU   1                       DISPLACEMENT ONE                 00202000
D4       EQU   4                       DISPLACEMENT FOUR                00203000
D44      EQU   44                  DEB DISPLACEMENT                     00204000
L3       EQU   3                       LENGTH THREE                     00205000
TMFLG    EQU   X'01'                   TRANSIENT MANAGER FLAG           00206000
OFLGS    EQU   X'10'                   OPEN FLAG                        00207000
ZEROONE  EQU   X'01'                   HEX 01                           00208000
HIHALF   EQU   240                     HIGH HALF OF A BYTE              00209000
ALL      EQU   255                     WHOLE BYTE                       00210000
NEW      EQU   X'10'                   NEW OLT                          00211000
OLD      EQU   X'20'                   OLD OLT                          00212000
TYTST    EQU   X'04'                   ESD TYPE                         00213000
FIRST    EQU   X'F7'                   FIRST BYTE OF DATA FLAG          00214000
SECOND   EQU   X'08'                   SECOND BYTE OF DATA FLAG         00215000
RLDFLG   EQU   X'02'                   POS OR NEG RELOCATION            00216000
MSG202   EQU   100                      DISPLACEMENT TO MSG IFD202I     00217000
MSG203   EQU   104                      DISPLACEMENT TO MSG IFD203I     00218000
MSG205   EQU   108                      DISPLACEMENT TO MSG IFD205I     00219000
MSG911   EQU   112                     DISPLACEMENT TO MSG IFD911I      00220000
MSG901   EQU   116                      DISPLACEMENT TO MSG IFD901I     00221000
         EJECT                                                          00222000
*********************************************************************** 00223000
*                             INITIALIZE                              * 00224000
*********************************************************************** 00225000
         L     PLISTREG,4(R1)          PUT POINTER TO PARAMETER LIST   C00226000
                                       IN REG 3                         00227000
         MVC   RLCOREAD(4),AD(PLISTREG) GET REAL CORE ADDRESS OF WHERE C00228000
                                       MODULE SHOULD BE LOADED          00229000
         NI    LDSWITCH,CPTSW          TURN OFF ALL INTERNAL FLAGS     C00230000
                                       EXCEPT FOR COMPUTE               00231000
         TM    FLAG(PLISTREG),CMPTE    IS THIS A COMPUTE REQUEST        00232000
         BNO   LDTXT006                NO, GO TO CODE THAT WILL LOAD   C00233000
                                       AND RELOCATE THE MODULE          00234000
         NI    LDSWITCH,0              TURN OFF INTERNAL COMPUTE SWITCHC00235000
                                       THIS IS A NEW REQUEST            00236000
         XC    BUFFER(80),BUFFER       CLEAR READ BUFFER                00237000
         SPACE 1                                                        00238000
*********************************************************************** 00239000
*                         ESD CARD HANDLING                           * 00240000
*********************************************************************** 00241000
LDESD001 EQU   *                                                        00242000
         BAL   R4,LDIOSUB              GO TO IO SUBROUTINE TO READ     C00243000
                                       FIRST ESD CARD                   00244000
         CLC   BUFFER+1(L3),=C'ESD'    IS THIS AN ESD CARD              00245000
         BNE   LDESD001                NO, FIND FIRST ESD               00246000
         CLC   BUFFER+14(2),ONE1       IS THIS THE FIRST ESD CARD       00247000
         BNE   LDESD001                NO, FIND FIRST ESD               00248000
         SPACE 1                                                        00249000
LDESD006 EQU   *                                                        00250000
         CLC   BUFFER+16(8),NAME(PLISTREG) DOES THIS ESD CARD HAVE NAMEC00251000
                                       OF REQUESTED UNIT TEST MODULE    00252000
         BE    LDESD011                YES, GO TO ROUTINE THAT WILL    C00253000
                                       CONTINUE ESD PROCESSING          00254000
         CLC   BUFFER+32(8),NAME(PLISTREG) DOES THIS ESD CARD HAVE NAMEC00255000
                                       OF REQUESTED UNIT TEST MODULE    00256000
         BNE   LDESD001                NO, GO TO ROUTINE THAT WILL GET C00257000
                                       NEXT CARD                        00258000
         SPACE 1                                                        00259000
LDESD011 EQU   *                                                        00260000
         OI    LDSWITCH,CPTSW          TURN ON INTERNAL COMPUTE FLAG    00261000
         MVC   B28WORK+1(L3),BUFFER+25 GET THE ADDR OF WHERE THIS      C00262000
                                       MODULE WAS ASSEMBLED AT INTO    C00263000
                                       WORK AREA                        00264000
         SR    R7,R7                   CLEAR ESD LENGTH REG             00265000
         L     R6,B28WORK              PUT ASSEMBLE ADDRESS INTO REG 6  00266000
         ST    R6,ASSEMAD              SAVE THE ASSEMBLED ADDRESS FOR  C00267000
                                       LATTER USE                       00268000
         SPACE 1                                                        00269000
LDESD026 EQU   *                                                        00270000
         SR    ESDBTCNT,ESDBTCNT       CLEAR ESD BYTE COUNT REG         00271000
         IC    ESDBTCNT,BUFFER+11      GET NUMBER OF BYTES OF ESD DATA C00272000
                                       ON THIS CARD                     00273000
         SR    R8,R8                   CLEAR REG 8                      00274000
         LA    R5,16                   SET REG 5 TO CONTAIN LENGTH OF  C00275000
                                       ESD DATA FIELD                   00276000
         DR    R8,R5                   DIVIDE NO. OF BYTES OF ESD DATA C00277000
                                       BY LNGTH OF ESD DATA FLD TO FINDC00278000
                                       NUMBER OF FLDS IN ESD CARD       00279000
         LA    R5,BUFFER+8             PRIME REG 5 WITH ADDRESS OF ESD C00280000
                                       CARD TO SIMPLIFY LOOPING ON     C00281000
                                       ESD DATA FIELDS ON ONE CARD      00282000
         SPACE 1                                                        00283000
LDESD031 EQU   *                                                        00284000
         LA    R5,16(R5)               BUMP POINTER TO ESD CARD TO     C00285000
                                       POINT TO MIDDLE OF ESD DATA     C00286000
                                       FIELD                            00287000
         TM    0(R5),ALL               IS THIS AN SD TYPE               00288000
         BZ    LDESD036                YES, GO TO ROUTINE WHICH WILL   C00289000
                                       SUM ESD LENGTH FIELDS            00290000
         TM    0(R5),TYTST             DOES THIS ESD HAVE ANY LENGTH   C00291000
                                       ATTRIBUTE                        00292000
         BZ    LDESD041                NO, GO TO ROUTINE WHICH         C00293000
                                       DETERMINES IF THERE ARE ANY MOREC00294000
                                       ESD DATA FIELDS                  00295000
         SPACE 1                                                        00296000
LDESD036 EQU   *                                                        00297000
         MVC   B28WORK+1(L3),5(R5)     MOVE LENGTH INTO WORK AREA       00298000
         A     R7,B28WORK              ADD THIS LENGTH TO SUM OF       C00299000
                                       PREVIOUS LENGTHS                 00300000
         SPACE 1                                                        00301000
LDESD041 EQU   *                                                        00302000
         BCT   ESDBTCNT,LDESD031       DECREMENT NUMBER OF ESD DATA    C00303000
                                       FIELDS BY ONE AND IF THERE ARE  C00304000
                                       ANY LEFT, PROCESS THIS ONE       00305000
         BAL   R4,LDIOSUB              GO TO IO SUBROUTINE TO READ NEXTC00306000
                                       CARD                             00307000
         CLC   BUFFER+1(L3),=C'ESD'    IS THIS CARD AN ESD              00308000
         BE    LDESD026                YES, GO TO ROUTINE TO SUM LENGTHC00309000
                                       ON ESD CARDS                     00310000
         CLC   BUFFER+1(L3),=C'TXT'    IS THIS CARD A TXT               00311000
         BNE   LDRLD046                NO, ORDER ERROR OR GARBAGE,     C00312000
                                       GO TO ROUTINE THAT RETURNS 24   C00313000
                                       IN REG 15                        00314000
         EJECT                                                          00315000
*********************************************************************** 00316000
*                         TXT CARD HANDLING                           * 00317000
*********************************************************************** 00318000
LDTXT001 EQU   *                                                        00319000
         NI    LDSWITCH,ALL-TWOREADS   SET FLAG INDICATING TWO READS   C00320000
                                       ARE REQUIRED                     00321000
         ST    R7,SIZEAREA             SAVE MODULE SIZE                 00322000
         LH    R5,TCNT(PLISTREG)       TAKE TRUNCATED LOAD COUNT AND    00323000
         LTR   R5,R5                   LOOK AT IT                       00324000
         BZ    CMPTDONE                IF ZERO, GO TO RETURN TO CALLER C00325000
                                       EXIT ROUTINE                     00326000
         OI    LDSWITCH,TRNCL          SET TRUNCATED LOAD FLAG ON       00327000
         SPACE 1                                                        00328000
LDTXT006 EQU   *                                                        00329000
         LA    R15,20                  PLACE ERROR CODE 20 IN REG 15   C00330000
                                       FOR FAILURE TO DO COMPUTE        00331000
         TM    LDSWITCH,CPTSW          HAS A COMPUTE BEEN DONE          00332000
         BNO   LDRETERR                NO, GO TO ROUTINE THAT          C00333000
                                       DETERMINES IF THIS IS OK         00334000
         L     R6,ASSEMAD              GET ASSEMBLED ADDRESS OF MODULE  00335000
         TM    FLAG(PLISTREG),PLNK     IS THIS MODULE A PLINK MODULE    00336000
         BNO   LDTXT011                NO, BYPASS UPDATING REAL CORE AD 00337000
         A     R6,RLCOREAD             ADD ADDRESS OF OLT TO ASSEMBLED C00338000
                                       ADDRESS OF PLINK MODULE          00339000
         ST    R6,RLCOREAD             SAVE NEW REAL CORE ADDRESS       00340000
         SPACE 1                                                        00341000
LDTXT011 EQU   *                                                        00342000
         L     R6,RLCOREAD             GET REAL CORE ADDRESS OF MODULE  00343000
         S     R6,ASSEMAD              SUBTRACT ASSEMBLED ADDRESS FROM C00344000
                                       TARGET ADDRESS TO GET RELOCATIONC00345000
                                       FACTOR                           00346000
         ST    R6,RELFT                SAVE RELOCATION FACTOR           00347000
         SPACE 1                                                        00348000
LDTXT016 EQU   *                                                        00349000
         LH    TXTBTCNT,BUFFER+22      GET BYTE COUNT OF FOLLOWING DATAC00350000
                                       RECORD FROM TXTHDR CARD INTO    C00351000
                                       REG 9                            00352000
         TM    LDSWITCH,TRNCL          IS THIS A TRUNCATED LOAD- A CDS C00353000
                                       LOAD                             00354000
         BNO   LDTXT026                NO, GO TO ROUTINE THAT HANDLES  C00355000
                                       PLACING TXT CARDS INTO CORE      00356000
         LTR   R5,R5                   HAS IT BEEN DONE-LOOK AT        C00357000
                                       TRUNCATED COUNT IN PARM LIST     00358000
         BZ    LDRLD051                YES, GO TO SUCCESSFUL EXIT      C00359000
                                       SUBROUTINE                       00360000
         CR    R5,TXTBTCNT             CHECK BYTES REQUESTED VS LENGTH C00361000
                                       OF TXT RECORD                    00362000
         BH    LDTXT021                ANOTHER RECORD IS NEEDED, GO TO C00363000
                                       CODE THAT PREPARES FOR THIS      00364000
         LR    TXTBTCNT,R5             SET LENGTH EQUAL TO BYTES       C00365000
                                       REQUESTED                        00366000
         SPACE 1                                                        00367000
LDTXT021 EQU   *                                                        00368000
         SR    R5,TXTBTCNT             SET BYTES REQUESTED EQUAL TO    C00369000
                                       DIFFERENCE OF ORIGINAL REQUEST  C00370000
                                       AND LENGTH                       00371000
         SPACE 1                                                        00372000
LDTXT026 EQU   *                                                        00373000
         MVC   B28WORK+1(L3),BUFFER+17 PUT ASSEMBLED ADDR OF FOLLOWING C00374000
                                       TXT RECORD IN WORK AREA          00375000
         L     R6,B28WORK              GET THIS ASSEMBLED ADDR IN REG 6 00376000
         A     R6,RELFT                ADD RELOCATION FACTOR TO THIS   C00377000
                                       ASSEMBLED ADDRESS                00378000
         ST    R6,RDBUFAD              STORE THIS ADDR IN READ COMMAND  00379000
         ST    R9,RDLNGTH              STORE LENGTH IN READ COMMAND     00380000
         OI    LDSWITCH,TWOREADS       INDICATE 2 READS ARE NECESSARY   00381000
LDTXT031 EQU   *                                                        00382000
         BAL   R4,LDIOSUB              GO TO IO SUBROUTINE TO READ     C00383000
                                       TXT DATA CARD INTO CORE AND     C00384000
                                       READ NEXT TXTHDR CARD            00385000
         CLC   BUFFER+1(L3),=C'TXT'    IS THIS A TXTHDR CARD            00386000
         BNE   LDREP011                NO, GO SEE IF IT IS A REP        00387000
         B     LDTXT016                YES, DECODE AND HANDLE THIS TXT C00388000
                                       CARD                             00389000
         EJECT                                                          00390000
*********************************************************************** 00391000
*                         REP CARD HANDLING                           * 00392000
*********************************************************************** 00393000
LDREP001 EQU   *                                                        00394000
         LA    COUNT,6                 PUT NUMBER OF CHARACTERS TO BE  C00395000
                                       CONVERTED INTO COUNT REG         00396000
         LA    FROMADDR,BUFFER+6       PUT STARTING ADDRESS OF THE     C00397000
                                       CONVERT IN THE FROMADDR REG      00398000
         LA    TOADDR,B28WORK+1        PUT THE TO ADDRESS OF CONVERT   C00399000
                                       IN TOADDR REG                    00400000
         BAL   R4,LDCNV001             GO TO CONVERT ROUTINE AND OBTAINC00401000
                                       WHERE REP SHOULD OCCUR           00402000
         L     REPPTR,B28WORK          PLACE ADDRESS OF WHERE REP      C00403000
                                       SHOULD START IN REPPTR           00404000
         A     REPPTR,RELFT            ADD RELOCATION FACTOR TO THIS   C00405000
                                       AND GET REAL CORE ADDRESS OF    C00406000
                                       WHERE REP SHOULD START           00407000
         L     R4,SIZEAREA             GET MODULE SIZE                  00408000
         A     R4,RLCOREAD             ADD RELATIVE BEGINNING           00409000
         BCTR  R4,0                                                     00410000
         BCTR  R4,0                    BACK UP 2 BYTES IN CORE          00411000
         ST    R4,ENDMIN2              SAVE END ADDRESS                 00412000
         CR    REPPTR,R4               CHECK FOR END OF MODULE          00413000
         BH    LDREP021                ERR, PASTEND OF MODULE           00414000
         C     REPPTR,RLCOREAD         CHECK FOR BEGINNING OF MODULE    00415000
         BL    LDREP021                NO, BEFORE MODULE                00416000
         LA    FROMADDR,BUFFER+16      PUT STARTING ADDRESS OF REP ON  C00417000
                                       THE REP CARD INTO THE FROMADDR  C00418000
                                       REG SO CONVERSION CAN BE DONE    00419000
         SPACE 1                                                        00420000
LDREP006 EQU   *                                                        00421000
         LA    COUNT,4                 PUT NUMBER OF CHARACTERS TO BE  C00422000
                                       CONERTED INTO COUNT REG          00423000
         LA    TOADDR,B28WORK+2        PUT TO ADDRESS OF CONVERT INTO  C00424000
                                       TOADDR REG                       00425000
         BAL   R4,LDCNV001             GO TO CONVERT ROUTINE AND       C00426000
                                       CONVERT TWO BYTES OF THE REP     00427000
         MVC   0(2,REPPTR),B28WORK+2   MOVE THIS TWO BYTES OF REP TO   C00428000
                                       WHERE IT BELONGS IN CORE         00429000
         CLI   0(FROMADDR),C','        IS A COMMA THE NEXT CHARACTER   C00430000
                                       ON THE REP CARD                  00431000
         BE    LDREP016                YES, GO TO ROUTINE WHICH WILL   C00432000
                                       SET UP TO CONVERT NEXT TWO BYTESC00433000
                                       OF REP DATA                      00434000
         CLI   0(FROMADDR),C' '        NO, IS THE REP FINISHED OR IS   C00435000
                                       THERE A BLANK AS NEXT CHARACTER C00436000
                                       ON THE REP CARD                  00437000
         BNE   LDREP021                NO, GO TO REP CARD ERROR EXIT   C00438000
                                       ROUTINE                          00439000
         BAL   R4,LDIOSUB              GO TO IO SUBROUTINE AND READ    C00440000
                                       NEXT RECORD                      00441000
         SPACE 1                                                        00442000
LDREP011 EQU   *                                                        00443000
         CLC   BUFFER+1(L3),=C'REP'    IS THIS NEXT RECORD A REP CARD   00444000
         BE    LDREP001                YES, GO TO REP CARD HANDLING    C00445000
                                       ROUTINE                          00446000
         B     LDRLD041                GO TO RLD CARD HANDLING ROUTINE C00447000
                                       AND SEE IF IT IS AN RLD RECORD   00448000
         SPACE 1                                                        00449000
LDREP016 EQU   *                                                        00450000
         LA    FROMADDR,1(FROMADDR)    INCREMENT FROMADDR BY ONE TO    C00451000
                                       POINT TO NEXT TWO BYTES OF REP  C00452000
                                       DATA                             00453000
         LA    REPPTR,2(REPPTR)        INCREMENT REAL CORE ADDR OF REP C00454000
                                       BY TWO TO POINT TO WHERE NEXT   C00455000
                                       TWO BYTES OF REP DATA SHOULD GO  00456000
         C     REPPTR,ENDMIN2          IS NEW ADDRESS STILL IN MODULE   00457000
         BNH   LDREP006                YES,GO TO ROUTINE TO DECODE NEXTX00458000
                                       TWO BYTES OF REP DATA            00459000
         SPACE 1                                                        00460000
LDREP021 EQU   *                                                        00461000
         LA    R14,MRT202               POINT TO MESSAGE ROUTINE        00462000
         LA    R15,16                  PUT 16 IN RETURN CODE REGISTER, C00463000
                                       INDICATING REP CARD ERROR        00464000
         B     LDRETMSG                GO TO ERROR EXIT LINKAGE         00465000
         EJECT                                                          00466000
*********************************************************************** 00467000
**********  CONVERT SUBROUTINE USED FOR REP CARD HANDLING    ********** 00468000
*********************************************************************** 00469000
         SPACE 1                                                        00470000
LDCNV001 EQU   *                                                        00471000
         SR    CHAR,CHAR               CLEAR REGISTER WHICH WILL BE    C00472000
                                       USED FOR SEARCH OF CHARACTER    C00473000
                                       TABLE                            00474000
         SPACE 1                                                        00475000
LDCNV006 EQU   *                                                        00476000
         NI    LDSWITCH,FIRST          ZERO FLAG WHICH TELLS WHICH BYTEC00477000
                                       OF DATA BEING CONVERTED. ZERO   C00478000
                                       IMPLIES 1ST BYTE, ONE - 2ND BYTE 00479000
         SR    REPBYTE,REPBYTE         CLEAR REGISTER WHICH WILL       C00480000
                                       CONTAIN BYTE OF REP DATA BEING  C00481000
                                       PROCESSED                        00482000
         SPACE 1                                                        00483000
LDCNV011 EQU   *                                                        00484000
         IC    REPBYTE,0(FROMADDR)     PUT CHARACTER TO BE CONVERTED   C00485000
                                       INTO REP DATA BYTE REG           00486000
         LA    INDEX,16                PUT 16 INTO INDEX REGISTER IN   C00487000
                                       PREPARATION FOR SEARCH OF TABLE  00488000
         SPACE 1                                                        00489000
LDCNV016 EQU   *                                                        00490000
         IC    CHAR,CHARTBL-1(INDEX)   GET A CHARACTER FROM TABLE AND  C00491000
                                       PUT IT IN REG USED FOR SEARCH    00492000
         CLR   CHAR,REPBYTE            DOES CHAR ON REP CARD EQUAL     C00493000
                                       THIS CHAR FROM TABLE             00494000
         BE    LDCNV021                YES, GO TO ROUTINE WHICH HANDLESC00495000
                                       A SUCCESSFUL MATCH               00496000
         BCT   INDEX,LDCNV016          TRY NEXT CHARACTER IN TABLE, IF C00497000
                                       ANY LEFT                         00498000
         B     LDREP021                IF NONE ARE LEFT, GO TO ROUTINE C00499000
                                       WHICH WILL INDICATE REP CARD    C00500000
                                       ERROR                            00501000
         SPACE 1                                                        00502000
LDCNV021 EQU   *                                                        00503000
         LA    FROMADDR,1(FROMADDR)    ADVANCE FROM ADDR REG BY ONE TO C00504000
                                       POINT TO NEXT CHARACTER TO BE   C00505000
                                       CONVERTED                        00506000
         BCTR  INDEX,0                 DECREMENT INDEX BY ONE AS THIS  C00507000
                                       IS THE HEX EQUIVALENT OF EBCDIC C00508000
                                       CHARACTER ON REP CARD            00509000
         SPACE 1                                                        00510000
LDCNV026 EQU   *                                                        00511000
         TM    LDSWITCH,SECOND         HAVE TWO BYTES OF REP DATA BEEN C00512000
                                       CONVERTED                        00513000
         BO    LDCNV031                YES, GO TO ROUTINE WHICH WILL   C00514000
                                       PLACE REP DATA IN SPECIFIED AREA 00515000
         LR    R14,INDEX               SAVE FIRST CONVERSION RESULT IN C00516000
                                       REG 14                           00517000
         SR    REPBYTE,REPBYTE         CLEAR REGISTER USED TO CONTAIN  C00518000
                                       BYTE OF REP DATA BEING PROCESSED 00519000
         OI    LDSWITCH,SECOND         SET FLAG WHICH INDICATES WHICH  C00520000
                                       BYTE OF DATA IS BEING CONVERTED C00521000
                                       TO 1, 1 IMPLIES THIS IS 2ND BYTE 00522000
         SLL   R14,4                   LEFT JUSTIFY FIRST CONVERTED    C00523000
                                       BYTE IN REG 14                   00524000
         BCT   COUNT,LDCNV011          GO CONVERT NEXT BYTE OF REP DATAC00525000
                                       IF THERE IS ANY                  00526000
         LA    COUNT,1                 SINCE THERE ARE NONE, SET COUNT C00527000
                                       TO 1 SO PROCESSING WILL NOT LOOPC00528000
                                       FOREVER BELOW                    00529000
         SPACE 1                                                        00530000
LDCNV031 EQU   *                                                        00531000
         OR    R14,INDEX               COMBINE TWO CONVERSIONS TO BE   C00532000
                                       ONE BYTE                         00533000
         STC   R14,0(TOADDR)           PUT TWO CONVERTED BY INTO AREA  C00534000
                                       SPECIFIED BY TO ADDR REG         00535000
         LA    TOADDR,1(TOADDR)        BUMP TO ADDR REG BY ONE TO POINTC00536000
                                       TO NEXT BYTE IN TOADDR FIELD     00537000
         BCT   R7,LDCNV006             GO CONVERT NEXT CHARACTER, IF   C00538000
                                       THERE IS ONE                     00539000
         BR    R4                      NONE LEFT, RETURN TO CALLER      00540000
         SPACE 3                                                        00541000
*********************************************************************** 00542000
*                TABLE USED TO VALIDATE REP INFORMATION               * 00543000
*********************************************************************** 00544000
CHARTBL  DC    C'0123456789ABCDEF'                                      00545000
         EJECT                                                          00546000
*********************************************************************** 00547000
*                         RLD CARD HANDLING                           * 00548000
*********************************************************************** 00549000
         SPACE 1                                                        00550000
LDRLD001 EQU   *                                                        00551000
         SR    RLDBTCNT,RLDBTCNT       CLEAR RLD BYTE COUNT REG         00552000
         IC    RLDBTCNT,BUFFER+11      GET RLD DATA BYTE COUNT          00553000
         SRL   RLDBTCNT,TWICE          DIVIDE COUNT BY FOUR AND GET    C00554000
                                       NUMBER OF POSSIBLE 4 BYTE RLD   C00555000
                                       DATA ITEMS                       00556000
         LA    DATAPTR,BUFFER+16       GET ADDRESS OF FIRST BYTE OF    C00557000
                                       RLD DATA                         00558000
         BCT   RLDBTCNT,LDRLD016       SINCE THIS IS FIRST DATA FIELD, C00559000
                                       DECREMENT NO. OF 4 BYTE RLD DATAC00560000
                                       ITEMS BY 1, GO DECODE RLD DATA   00561000
         SPACE 1                                                        00562000
LDRLD006 EQU   *                                                        00563000
         TM    D0(DATAPTR),SAMEPTR     DOES RLD HAVE SAME R OR P PTR    00564000
         BO    LDRLD016                BRANCH IF YES                    00565000
         SPACE 1                                                        00566000
LDRLD011 EQU   *                                                        00567000
         LA    DATAPTR,D4(DATAPTR)     BUMP RLD DATA POINTER BY 4 TO   C00568000
                                       AVOID THE ESD ID INDICATORS AND C00569000
                                       TO POINT TO DATA FIELD           00570000
         BCTR  RLDBTCNT,0              DECREMENT NUMBER OF 4 BYTE RLD  C00571000
                                       DATA ITEMS BY ONE                00572000
         SPACE 1                                                        00573000
LDRLD016 EQU   *                                                        00574000
         LA    DATAPTR,D4(DATAPTR)     BUMP RLD DATA POINTER BY 4       00575000
         MVC   B28WORK+1(L3),D1(DATAPTR) GET ADDRESS THAT MUST BE      C00576000
                                       UPDATED                          00577000
         L     R6,B28WORK              PLACE THIS ADDRESS IN REG 6      00578000
         A     R6,RELFT                ADD RELOCATION FACTOR            00579000
         SPACE 1                                                        00580000
LDRLD021 EQU   *                                                        00581000
         TM    D0(DATAPTR),HIHALF      IS THIS AN ADCON OR CCW          00582000
         BNZ   LDRLD036                NO, BRANCH TO DECODE NEXT RLD   C00583000
                                       DATA ITEM IF NECESSARY           00584000
         XC    WORK(4),WORK            CLEAR WORK AREA                  00585000
         IC    R7,D0(DATAPTR)          GET LENGTH OF DATA ITEM          00586000
         N     R7,FULL15               STRIP INDICATORS FROM LENGTH     00587000
         SRL   R7,TWICE                ADJUST LENGTH                    00588000
         EX    R7,MVC01                MOVE DATA REQUIRING UPDATE TO   C00589000
                                       WORK AREA                        00590000
         L     R5,WORK                 PUT DATA REQUIRING UPDATE IN    C00591000
                                       REG 5                            00592000
         LA    R1,3                    PLACE MAX SIZE ADDRESS THAT     C00593000
                                       COULD BE UPDATED, THREE IMPLIES C00594000
                                       A FOUR BYTE ADDRESS              00595000
         SR    R1,R7                   SUBTRACT LNGTH OF ITEM FROM MAX C00596000
                                       LNGTH, REMAINDER IS NO. OF BYTESC00597000
                                       NOT USED, I.E. 1 EQ. 3 BYTE ADDR 00598000
         SLL   R1,3                    TAKE REMAINDER AND CONVERT IT TOC00599000
                                       THE BIT SHIFT REQUIRED TO RIGHT C00600000
                                       JUSTIFY ADDR BEING WORKED ON     00601000
         SRL   R5,D0(R1)               RIGHT JUSTIFY THE ADDRESS IN    C00602000
                                       REG 5                            00603000
         TM    D0(DATAPTR),RLDFLG      TEST RLD FLAG BIT- POS OR NEG    00604000
         BO    LDRLD026                BRANCH IF NEGATIVE               00605000
         A     R5,RELFT                ADD RELOCATION FACTOR            00606000
         B     LDRLD031                GO TO ROUTINE THAT STORES       C00607000
                                       UPDATED ADDRESS IN THE PROGRAM   00608000
         SPACE 1                                                        00609000
LDRLD026 EQU   *                                                        00610000
         S     R5,RELFT                SUBTRACT RELOCATION FACTOR       00611000
         SPACE 1                                                        00612000
LDRLD031 EQU   *                                                        00613000
         SLL   R5,D0(R1)               LEFT JUSTIFY UPDATED ADDRESS     00614000
         ST    R5,WORK                 STORE UPDATED ADDRESS IN WORK   C00615000
                                       AREA                             00616000
         EX    R7,MVC02                MOVE UPDATED ADDRESS IN WORK    C00617000
                                       AREA TO ITS HOME IN PROGRAM      00618000
         SPACE 1                                                        00619000
LDRLD036 EQU   *                                                        00620000
         BCT   RLDBTCNT,LDRLD006       DECREMENT NUMBER OF 4 BYTE RLD  C00621000
                                       DATA ITEMS BY ONE, IF THERE ARE C00622000
                                       ANY LEFT, GO DECODE THEM         00623000
         SPACE 1                                                        00624000
         BAL   R4,LDIOSUB              GO TO IO SUBROUTINE AND GET     C00625000
                                       NEXT CARD                        00626000
         SPACE 1                                                        00627000
LDRLD041 EQU   *                                                        00628000
         CLC   BUFFER+1(L3),=C'RLD'    IS THIS CARD AN RLD CARD         00629000
         BE    LDRLD001                YES, GO TO RLD CARD HANDLER      00630000
         CLC   BUFFER+1(L3),=C'END'    IS THIS CARD AN END CARD         00631000
         BE    LDRLD051                YES, END LOADER, GO TO FINISH   C00632000
                                       ROUTINE                          00633000
         SPACE 1                                                        00634000
LDRLD046 EQU   *                                                        00635000
         LA    R14,MRT911               POINT TO MESSAGE ROUTINE        00636000
         LA    R1,NAME(PLISTREG)        POINT TO MODULE NAME            00637000
         LA    R15,24                  PUT 24 IN RETURN CODE REGISTER, C00638000
                                       INDICATING ORDER ERROR OR       C00639000
                                       GARBAGE                          00640000
         B     LDRETMSG                GO TO ERROR EXIT LINKAGE         00641000
         SPACE 1                                                        00642000
LDRLD051 EQU   *                                                        00643000
         L     R1,RLCOREAD             PLACE ADDRESS OF WHERE MODULE   C00644000
                                       WAS LOADED IN REGISTER ONE       00645000
         L     R0,SIZEAREA             GET SIZE OF THE MODULE           00646000
         B     LDRET00                 GO TO SUCCESSFUL EXIT LINKAGE    00647000
MVC01    MVC   WORK(0),D0(R6)          MOVE ADDRESS TO WORK AREA        00648000
MVC02    MVC   D0(0,R6),WORK           MOVE UPDATED ADDRESS TO ITS     C00649000
                                       PLACE IN PROGRAM                 00650000
         EJECT                                                          00651000
*********************************************************************** 00652000
*                           IO SUBROUTINE                             * 00653000
*********************************************************************** 00654000
LDIOSUB  EQU   *                                                        00655000
         LA    DCBPTR,OLTDCB           GET POINTER TO DCB FOR OLT      C00656000
                                       LIBRARY IN DCB REG               00657000
         TM    48(DCBPTR),OFLGS        IS OLT LIB OPEN                  00658000
         BO    LDIO0010                YES, BYPASS DOING OPEN           00659000
         OPEN  ((DCBPTR),(INPUT))      ATTEMPT TO OPEN OLT DCB          00660000
         TM    48(DCBPTR),OFLGS        DID OLT LIB OPEN                 00661000
         BO    LDIO0010                YES, CONTINUE                    00662000
         LA    R1,=C'OLTCDSDD'         POINT TO DD CARD NAME            00663000
LDIO0005 EQU   *                                                        00664000
         LA    R14,MRT901              POINT TO MESSAGE ROUTINE         00665000
         LA    R15,12                  SET MODULE NOT FOUND RC          00666000
         NI    LDSWITCH,ALL-CPTSW      TURN OFF COMPUTE SWITCH          00667000
         B     LDRETMSG                GO TO ERROR EXIT LINKAGE         00668000
         SPACE 1                                                        00669000
LDIO0010 EQU   *                                                        00670000
         USING DEBBASIC,DEBREG     SET UP ADDRESSABILITY                00671000
         L     DEBREG,D44(DCBPTR)  GET ASSOCIATED DEB ADDRESS           00672000
         LA    DEBREG,D0(DEBREG)   CLEAR HIGH ORDER BYTE                00673000
         TM    DEBFLGS1,DEBAPFIN   IS LIBRARY AUTHORIZED                00674000
         BO    LDIO0015            YES,CONTINUE LOAD REQ                00675000
LDIO0013 CLOSE ((DCBPTR))          CLOSE OUT THE DATA SET               00676000
         LA    RC,34               SET THE NOT AUTH RC        @ZA31031  00677000
         B     MRT899              LEAVE MODULE                         00678000
LDIO0015 EQU   *                                                        00679000
         TM    FLAG(PLISTREG),SYMBOLIC IS THIS A SYMBOLIC CDS REQUEST   00680000
         BNO   LDIO0020                NO, PERFORM REQUESTED LOAD       00681000
         LA    DCBPTR,SYMDCB           GET POINTER TO DCB FOR SYMBOLIC C00682000
                                       CDS IN DCB REG                   00683000
         TM    48(DCBPTR),OFLGS        SEE IF ALREADY OPENED.           00684000
         BO    LDIO0020                IF ON ITS OPEN ALREADY           00685000
         OPEN  ((DCBPTR),(INPUT))      ATTEMPT TO OPEN OLT DCB          00686000
         LA    R1,=C'SYMSYM  '         POINT TO DD CARD NAME            00687000
         TM    48(DCBPTR),OFLGS        IS SYMBOLIC DCB OPEN             00688000
         BNO   LDIO0005                NO, INDICATE SYMSYM DD CARD     C00689000
                                       FAILED TO OPEN                   00690000
         L     DEBREG,D44(DCBPTR)  GET ASSOCIATED DEB ADDRESS           00691000
         LA    DEBREG,D0(DEBREG)   CLEAR HIGH ORDER BYTE                00692000
         TM    DEBFLGS1,DEBAPFIN   IS LIBRARY AUTHORIZED                00693000
         BNO   LDIO0013            NO, PRINT EIROR MESSAGE              00694000
         DROP  DEBREG                                                   00695000
         SPACE 1                                                        00696000
LDIO0020 EQU   *                                                        00697000
         TM    FLAG(PLISTREG),CMPTE    IS CALLER ASKING FOR A COMPUTE   00698000
         BNO   LDIO0040                NO, READ NEXT RECORD OF MODULE   00699000
         TM    LDSWITCH,CMPTSTRT       HAS COMPUTE BEEN STARTED         00700000
         BO    LDIO0040                YES, GO TO ROUTINE TO READ NEXT C00701000
                                       RECORD                           00702000
         LA    NAMEPTR,NAME(PLISTREG)  GET POINTER TO REQUESTED DATA   C00703000
                                       SET MEMBER NAME                  00704000
         FIND  (DCBPTR),(NAMEPTR),D    ISSUE FIND FOR REQUESTED MEMBER  00705000
         OI    LDSWITCH,CMPTSTRT       INDICATE COMPUTE HAS STARTED     00706000
         LTR   R15,R15                 WAS FIND SUCCESSFUL              00707000
         BZ    LDIO0050                SUCCESSFUL FIND, GO READ FIRST  C00708000
                                       CARD IN MODULE                   00709000
         SPACE 1                                                        00710000
LDIO0030 EQU   *                                                        00711000
         SR    R0,R0                   CLEAR REGISTER ZERO INDICATING  C00712000
                                       MODULE NOT FOUND                 00713000
         LA    R15,12                  PUT 0C IN REG 15 TO INDICATE    C00714000
                                       MODULE NOT FOUND                 00715000
         B     LDRESET                 RETURN TO CALLER                 00716000
         SPACE 1                                                        00717000
LDIO0040 EQU   *                                                        00718000
         LA    TTRZPTR,TTRZ            GET POINTER TO TTRZ FOR POINT    00719000
         POINT (DCBPTR),(TTRZPTR)      POINT TO RECORD THAT MUST BE    C00720000
                                       READ                             00721000
         SPACE 1                                                        00722000
LDIO0050 EQU   *                                                        00723000
         TM    LDSWITCH,TWOREADS       IS THIS REQUEST FOR TWO READS    00724000
         BNO   LDIO0060                NO, SET UP TO PERFORM ONE READ   00725000
         L     AREAPTR,RDBUFAD         GET POINTER TO BUFFER AREA IN   C00726000
                                       AREA POINTER REG                 00727000
         L     LNGTHREG,RDLNGTH        GET LENGTH OF READ IN LENGTH REG 00728000
         B     LDIO0070                GO TO READ ROUTINE               00729000
         SPACE 1                                                        00730000
LDIO0060 EQU   *                                                        00731000
         LA    AREAPTR,BUFFER          GET POINTER TO MY BUFFER AREA   C00732000
                                       IN  AREA POINTER REG             00733000
         LA    LNGTHREG,80             PUT LENGTH OF 80 IN LENGTH REG   00734000
         SPACE 1                                                        00735000
LDIO0070 EQU   *                                                        00736000
         READ  DECB,SF,(DCBPTR),(AREAPTR),(LNGTHREG) READ A RECORD      00737000
         CHECK DECB                    WAIT UNTIL READ COMPLETES        00738000
         TM    LDSWITCH,IOERROR        WAS THERE AN I/O ERROR           00739000
         BNO   LDIO0075                NO, CONTINUE NORMALLY            00740000
         LA    R14,MRT205              POINT TO MESSAGE ROUTINE         00741000
         NI    LDSWITCH,ALL-IOERROR    CLEAR I/O ERROR FLAG             00742000
         LA    R15,8                   PLACE 08 RETURN CODE IN REG 15   00743000
         B     LDRETMSG                RETURN TO CALLER INDICATING     C00744000
                                       READ ERROR                       00745000
         SPACE 1                                                        00746000
LDIO0075 EQU   *                                                        00747000
         NOTE  (DCBPTR)                FIND OUT WHERE THIS READ WAS     00748000
         ST    R1,TTRZ                 SAVE IT TO PERFORM NEXT READ     00749000
         MVI   TTRZ+3,X'01'            UPDATE TTRZ SO NEXT RECORD MAY  C00750000
                                       BE READ                          00751000
         TM    LDSWITCH,TWOREADS       IS THIS A REQUEST TO DO TWO     C00752000
                                       READS                            00753000
         BNO   LDIO0080                GO TO ROUTINE WHICH RETURNS TO  C00754000
                                       CALLER                           00755000
         NI    LDSWITCH,ALL-TWOREADS   CLEAR TWO READ REQUEST FLAG SO  C00756000
                                       NEXT READ WILL BE LAST           00757000
         B     LDIO0040                GO TO ROUTINE WHICH WILL POINT  C00758000
                                       TO NEXT RECORD AND READ IT       00759000
         SPACE 1                                                        00760000
LDIO0080 EQU   *                                                        00761000
         BR    R4                      RETURN TO CALLER                 00762000
         EJECT                                                          00763000
*********************************************************************** 00764000
*                    RETURN TO CALLER EXIT ROUTINE                    * 00765000
*********************************************************************** 00766000
CMPTDONE EQU   *                                                        00767000
         L     R1,ASSEMAD              GET THE DELTA INTO CORE FOR MOD. 00768000
         A     R1,RLCOREAD             ADD BEGINNING OF AREA            00769000
         LR    R0,R7                   PLACE SIZE OF MODULE IN REGISTERC00770000
                                       ZERO                             00771000
         B     LDRET00                 INDICATE TO CALLER SUCCESSFUL   C00772000
                                       COMPUTE                          00773000
         SPACE 1                                                        00774000
LDEXT006 EQU   *                                                        00775000
         A     R7,ONE                  ADD ONE TO SIZE OF MODULE        00776000
         ST    R7,SIZEAREA             PLACE SIZE OF MODULE IN SIZE    C00777000
                                       AREA                             00778000
         NI    SIZEAREA+3,ALL-TMFLG    INDICATE TO TRANS. MGR. THAT    C00779000
                                       THIS IS A NEW OLT BY SETTING    C00780000
                                       LAST BIT IN MOD. SIZE FLD TO 0   00781000
         L     R0,SIZEAREA             PLACE SIZE OF MODULE IN REGISTERC00782000
                                       ZERO                             00783000
         SPACE 1                                                        00784000
LDRET00  EQU   *                                                        00785000
         SR    R15,R15                 INDICATE TO CALLER SUCCESSFUL   C00786000
                                       LOAD                             00787000
         SPACE 1                                                        00788000
LDRETERR EQU   *                                                        00789000
         TM    FLAG(PLISTREG),CMPTE    IS THIS A COMPUTE REQUEST        00790000
         BO    LDEXTRET                YES, EVERYTHING OK               00791000
LDRESET  EQU   *                                                        00792000
         NI    LDSWITCH,ALL-CPTSW      CLEAR INTERNAL COMPUTE FLAG      00793000
         SPACE 1                                                        00794000
LDEXTRET EQU   *                                                        00795000
         ST    R15,RETCODE             SAVE RET CODE FOR DEBUGGING      00796000
         B     C13C0091                EXIT LOADER MODULE               00797000
         EJECT                                                          00798000
*********************************************************************** 00799000
*                           EODAD ROUTINE                             * 00800000
*********************************************************************** 00801000
ENDATA   EQU   *                                                        00802000
         CLOSE ((DCBPTR))              CLOSE OLT LIB DCB                00803000
         LA    R14,MRT203               POINT TO MESSAGE ROUTINE        00804000
         LA    R15,24                  PLACE 24 RETURN CODE IN REG 15   00805000
         B     LDRETMSG                RETURN TO CALLER INDICATING     C00806000
                                       ORDER ERROR OR GARBAGE           00807000
*********************************************************************** 00808000
*                           SYNAD ROUTINE                             * 00809000
*********************************************************************** 00810000
ERROR    EQU   *                                                        00811000
         OI    LDSWITCH,IOERROR        INDICATE TO SELF THAT AN I/O    C00812000
                                       ERROR HAS OCCURRED               00813000
         CLOSE ((DCBPTR))              CLOSE OLT LIB DCB                00814000
         BR    R14                     RETURN TO CALLER                 00815000
         EJECT                                                          00816000
*********************************************************************** 00817000
*                              DECLARES                               * 00818000
*********************************************************************** 00819000
SAVEAREA DC    18F'0'                  SAVE AREA                        00820000
BUFFER   DC    20F'0'                  READ BUFFER                      00821000
RLCOREAD DC    F'0'                    REAL CORE ADDRESS OF MODULE      00822000
ASSEMAD  DC    F'0'                    ASSEMBLED ADDRESS OF MODULE      00823000
B28WORK  DC    F'0'                    FULLWORD WORK AREA               00824000
WORK     DC    F'0'                    FULLWORD WORK AREA               00825000
RELFT    DC    F'0'                    RELOCATION FACTOR                00826000
RDBUFAD  DC    F'0'                    BUFFER ADDRESS                   00827000
RDLNGTH  DC    F'0'                    LENGTH OF READ                   00828000
RETCODE  DC    F'0'                    RETURN CODE AREA                 00829000
FULL15   DC    F'15'                   FULLWORD CONSTANT EQUAL 15       00830000
ONE      DC    F'1'                    FULLWORD CONSTANT EQUAL 1        00831000
ONE1     EQU   ONE+2                   HALFWORD CONSTANT EQUAL 1        00832000
TTRZ     DC    F'0'                    TTRZ FOR READ ROUTINE            00833000
SIZEAREA DC    F'0'                    SIZE WORK AREA                   00834000
ENDMIN2  DC    F'0'                    END OF MODULE                    00835000
LDSWITCH DC    X'00'                   INTERNAL FLAGS                   00836000
*********************************************************************** 00837000
*                          SYMBOLIC CDS DCB                           * 00838000
*********************************************************************** 00839000
SYMDCB   DCB   BLKSIZE=3600,LRECL=80,DDNAME=SYMSYM,DSORG=PO,           C00840000
               MACRF=R,RECFM=UT,EODAD=ENDATA,SYNAD=ERROR                00841000
*********************************************************************** 00842000
*                           OLT LIB DCB                               * 00843000
*********************************************************************** 00844000
OLTDCB   DCB   BLKSIZE=3600,LRECL=80,DDNAME=OLTCDSDD,DSORG=PO,         C00845000
               MACRF=R,RECFM=UT,EODAD=ENDATA,SYNAD=ERROR                00846000
*********************************************************************** 00847000
*                        DEB AREA DSECT                               * 00848000
*********************************************************************** 00849000
         IEZDEB                                                         00850000
ISTCC013 CSECT                                                          00851000
         LTORG                                                          00852000
*LDRETMSG:                                                         0032 00853000
*   RC=RCGEN;                       /* SAVE RETURNCODE PASSED        */ 00854000
LDRETMSG LR    RC,RCGEN                                            0032 00855000
*   GO TO EXITPTR;                  /* GO TO ROUTINE POINTED TO      */ 00856000
         BR    EXITPTR                                             0033 00857000
*MRT202:                                                           0034 00858000
*                                                                  0034 00859000
*   /*****************************************************************/ 00860000
*   /*                                                               */ 00861000
*   /* TCEC MSGN(202) INVOKED                                        */ 00862000
*   /*                                                               */ 00863000
*   /*****************************************************************/ 00864000
*                                                                  0034 00865000
*   $TCECM='1'B;                    /* SET TCEC SW IN RCA            */ 00866000
MRT202   OI    $TCECM(WAPTR),B'00000001'                           0034 00867000
*   R1=ADDR($TCA04);                /* SET UP PARM LIST $TR          */ 00868000
         LA    R1,$TCA04                                           0035 00869000
*   CALL #EXIT;                     /* CALL CECOM                    */ 00870000
         L     @15,#EXITA(,WAPTR)                                  0036 00871000
         BALR  @14,@15                                             0036 00872000
*   DCL                                                            0037 00873000
*     1 $TCA04,                     /* TCEC PARM LIST                */ 00874000
*      2 $TCB04 FIXED(32) INIT(202),/* MSG NUMBER                    */ 00875000
*      2 $TCC04 FIXED(32) INIT(0),  /* INCT LEN                      */ 00876000
*      2 $TCD04 BIT(8) INIT('00000000'B),/* FLAG                     */ 00877000
*      2 $TCE04 CHAR(4) INIT('FFFFFFFF'X);/* MSSAGE MASK             */ 00878000
*   GO TO C13C0090;                 /* EXIT THE LOADER               */ 00879000
         B     C13C0090                                            0038 00880000
*MRT203:                                                           0039 00881000
*                                                                  0039 00882000
*   /*****************************************************************/ 00883000
*   /*                                                               */ 00884000
*   /* TCEC MSGN(203) INVOKED                                        */ 00885000
*   /*                                                               */ 00886000
*   /*****************************************************************/ 00887000
*                                                                  0039 00888000
*   $TCECM='1'B;                    /* SET TCEC SW IN RCA            */ 00889000
MRT203   OI    $TCECM(WAPTR),B'00000001'                           0039 00890000
*   R1=ADDR($TCA05);                /* SET UP PARM LIST $TR          */ 00891000
         LA    R1,$TCA05                                           0040 00892000
*   CALL #EXIT;                     /* CALL CECOM                    */ 00893000
         L     @15,#EXITA(,WAPTR)                                  0041 00894000
         BALR  @14,@15                                             0041 00895000
*   DCL                                                            0042 00896000
*     1 $TCA05,                     /* TCEC PARM LIST                */ 00897000
*      2 $TCB05 FIXED(32) INIT(203),/* MSG NUMBER                    */ 00898000
*      2 $TCC05 FIXED(32) INIT(0),  /* INCT LEN                      */ 00899000
*      2 $TCD05 BIT(8) INIT('00000000'B),/* FLAG                     */ 00900000
*      2 $TCE05 CHAR(4) INIT('FFFFFFFF'X);/* MSSAGE MASK             */ 00901000
*   GO TO C13C0090;                 /* EXIT THE LOADER               */ 00902000
         B     C13C0090                                            0043 00903000
*MRT205:                                                           0044 00904000
*                                                                  0044 00905000
*   /*****************************************************************/ 00906000
*   /*                                                               */ 00907000
*   /* TCEC MSGN(205) INVOKED                                        */ 00908000
*   /*                                                               */ 00909000
*   /*****************************************************************/ 00910000
*                                                                  0044 00911000
*   $TCECM='1'B;                    /* SET TCEC SW IN RCA            */ 00912000
MRT205   OI    $TCECM(WAPTR),B'00000001'                           0044 00913000
*   R1=ADDR($TCA06);                /* SET UP PARM LIST $TR          */ 00914000
         LA    R1,$TCA06                                           0045 00915000
*   CALL #EXIT;                     /* CALL CECOM                    */ 00916000
         L     @15,#EXITA(,WAPTR)                                  0046 00917000
         BALR  @14,@15                                             0046 00918000
*   DCL                                                            0047 00919000
*     1 $TCA06,                     /* TCEC PARM LIST                */ 00920000
*      2 $TCB06 FIXED(32) INIT(205),/* MSG NUMBER                    */ 00921000
*      2 $TCC06 FIXED(32) INIT(0),  /* INCT LEN                      */ 00922000
*      2 $TCD06 BIT(8) INIT('00000000'B),/* FLAG                     */ 00923000
*      2 $TCE06 CHAR(4) INIT('FFFFFFFF'X);/* MSSAGE MASK             */ 00924000
*   GO TO C13C0090;                 /* EXIT THE LOADER               */ 00925000
         B     C13C0090                                            0048 00926000
*MRT899:                                                           0049 00927000
*                                                                  0049 00928000
*   /*****************************************************************/ 00929000
*   /*                                                               */ 00930000
*   /* TCEC MSGN(899) INVOKED                                        */ 00931000
*   /*                                                               */ 00932000
*   /*****************************************************************/ 00933000
*                                                                  0049 00934000
*   $TCECM='1'B;                    /* SET TCEC SW IN RCA            */ 00935000
MRT899   OI    $TCECM(WAPTR),B'00000001'                           0049 00936000
*   R1=ADDR($TCA07);                /* SET UP PARM LIST $TR          */ 00937000
         LA    R1,$TCA07                                           0050 00938000
*   CALL #EXIT;                     /* CALL CECOM                    */ 00939000
         L     @15,#EXITA(,WAPTR)                                  0051 00940000
         BALR  @14,@15                                             0051 00941000
*   DCL                                                            0052 00942000
*     1 $TCA07,                     /* TCEC PARM LIST                */ 00943000
*      2 $TCB07 FIXED(32) INIT(899),/* MSG NUMBER                    */ 00944000
*      2 $TCC07 FIXED(32) INIT(0),  /* INCT LEN                      */ 00945000
*      2 $TCD07 BIT(8) INIT('00000000'B),/* FLAG                     */ 00946000
*      2 $TCE07 CHAR(4) INIT('FFFFFFFF'X);/* MSSAGE MASK             */ 00947000
*   GO TO C13C0090;                 /* RETURN TO CALLER WITH A BAD 0053 00948000
*                                      RETURN CODE                   */ 00949000
         B     C13C0090                                            0053 00950000
*MRT901:                                                           0054 00951000
*   $INBUFR(1:8)=SUBCHAR;           /* PUT SUB CHAR. IN BUFFER       */ 00952000
*                                                                  0054 00953000
MRT901   MVC   $INBUFR(8,WAPTR),SUBCHAR(R1)                        0054 00954000
*   /*****************************************************************/ 00955000
*   /*                                                               */ 00956000
*   /* TCEC MSGN(901)SUB(YES) INVOKED                                */ 00957000
*   /*                                                               */ 00958000
*   /*****************************************************************/ 00959000
*                                                                  0055 00960000
*   $TCECM='1'B;                    /* SET TCEC SW IN RCA            */ 00961000
         OI    $TCECM(WAPTR),B'00000001'                           0055 00962000
*   R1=ADDR($TCA08);                /* SET UP PARM LIST $TR          */ 00963000
         LA    R1,$TCA08                                           0056 00964000
*   CALL #EXIT;                     /* CALL CECOM                    */ 00965000
         L     @15,#EXITA(,WAPTR)                                  0057 00966000
         BALR  @14,@15                                             0057 00967000
*   DCL                                                            0058 00968000
*     1 $TCA08,                     /* TCEC PARM LIST                */ 00969000
*      2 $TCB08 FIXED(32) INIT(901),/* MSG NUMBER                    */ 00970000
*      2 $TCC08 FIXED(32) INIT(0),  /* INCT LEN                      */ 00971000
*      2 $TCD08 BIT(8) INIT('10000000'B),/* FLAG                     */ 00972000
*      2 $TCE08 CHAR(4) INIT('FFFFFFFF'X);/* MSSAGE MASK             */ 00973000
*   GO TO C13C0090;                 /* EXIT THE LOADER               */ 00974000
         B     C13C0090                                            0059 00975000
*MRT911:                                                           0060 00976000
*   $INBUFR(1:8)=SUBCHAR;           /* PUT SUB CHAR. IN BUFFER       */ 00977000
*                                                                  0060 00978000
MRT911   MVC   $INBUFR(8,WAPTR),SUBCHAR(R1)                        0060 00979000
*   /*****************************************************************/ 00980000
*   /*                                                               */ 00981000
*   /* TCEC MSGN(911)SUB(YES) INVOKED                                */ 00982000
*   /*                                                               */ 00983000
*   /*****************************************************************/ 00984000
*                                                                  0061 00985000
*   $TCECM='1'B;                    /* SET TCEC SW IN RCA            */ 00986000
         OI    $TCECM(WAPTR),B'00000001'                           0061 00987000
*   R1=ADDR($TCA09);                /* SET UP PARM LIST $TR          */ 00988000
         LA    R1,$TCA09                                           0062 00989000
*   CALL #EXIT;                     /* CALL CECOM                    */ 00990000
         L     @15,#EXITA(,WAPTR)                                  0063 00991000
         BALR  @14,@15                                             0063 00992000
*   DCL                                                            0064 00993000
*     1 $TCA09,                     /* TCEC PARM LIST                */ 00994000
*      2 $TCB09 FIXED(32) INIT(911),/* MSG NUMBER                    */ 00995000
*      2 $TCC09 FIXED(32) INIT(0),  /* INCT LEN                      */ 00996000
*      2 $TCD09 BIT(8) INIT('10000000'B),/* FLAG                     */ 00997000
*      2 $TCE09 CHAR(4) INIT('FFFFFFFF'X);/* MSSAGE MASK             */ 00998000
*C13C0090:                                                         0065 00999000
*   RCGEN=RC;                       /* RESTORE RETURN TO BE GIVEN    */ 01000000
C13C0090 LR    RCGEN,RC                                            0065 01001000
*   GEN( NI LDSWITCH,ALL-CPTSW );   /* RESET THE COMPUTE REQUEST     */ 01002000
          NI LDSWITCH,ALL-CPTSW                                         01003000
*C13C0091:                                                         0067 01004000
*   SAVPTR=SVECC013(2);             /* RESTORE SAVEAREA PTR          */ 01005000
C13C0091 L     SAVPTR,SVECC013+4(,WAPTR)                           0067 01006000
*   RETURN;                                                        0068 01007000
@EL00001 DS    0H                                                  0068 01008000
@EF00001 DS    0H                                                  0068 01009000
@ER00001 L     @14,12(,@13)                                        0068 01010000
         LM    @02,@12,28(@13)                                     0068 01011000
         BR    @14                                                 0068 01012000
*   END ISTCC013;                   /* END OF THE OS/VS LOADER       */ 01013000
@DATA    DS    0H                                                       01014000
         DS    0F                                                       01015000
         DS    0F                                                       01016000
         DS    0D                                                       01017000
$TCA04   DS    CL13                                                     01018000
         ORG   $TCA04                                                   01019000
$TCB04   DC    A(202)                                                   01020000
$TCC04   DC    A(0)                                                     01021000
$TCD04   DC    B'00000000'                                              01022000
$TCE04   DC    X'FFFFFFFF'                                              01023000
         ORG   $TCA04+13                                                01024000
         DS    CL3                                                      01025000
$TCA05   DS    CL13                                                     01026000
         ORG   $TCA05                                                   01027000
$TCB05   DC    A(203)                                                   01028000
$TCC05   DC    A(0)                                                     01029000
$TCD05   DC    B'00000000'                                              01030000
$TCE05   DC    X'FFFFFFFF'                                              01031000
         ORG   $TCA05+13                                                01032000
         DS    CL3                                                      01033000
$TCA06   DS    CL13                                                     01034000
         ORG   $TCA06                                                   01035000
$TCB06   DC    A(205)                                                   01036000
$TCC06   DC    A(0)                                                     01037000
$TCD06   DC    B'00000000'                                              01038000
$TCE06   DC    X'FFFFFFFF'                                              01039000
         ORG   $TCA06+13                                                01040000
         DS    CL3                                                      01041000
$TCA07   DS    CL13                                                     01042000
         ORG   $TCA07                                                   01043000
$TCB07   DC    A(899)                                                   01044000
$TCC07   DC    A(0)                                                     01045000
$TCD07   DC    B'00000000'                                              01046000
$TCE07   DC    X'FFFFFFFF'                                              01047000
         ORG   $TCA07+13                                                01048000
         DS    CL3                                                      01049000
$TCA08   DS    CL13                                                     01050000
         ORG   $TCA08                                                   01051000
$TCB08   DC    A(901)                                                   01052000
$TCC08   DC    A(0)                                                     01053000
$TCD08   DC    B'10000000'                                              01054000
$TCE08   DC    X'FFFFFFFF'                                              01055000
         ORG   $TCA08+13                                                01056000
         DS    CL3                                                      01057000
$TCA09   DS    CL13                                                     01058000
         ORG   $TCA09                                                   01059000
$TCB09   DC    A(911)                                                   01060000
$TCC09   DC    A(0)                                                     01061000
$TCD09   DC    B'10000000'                                              01062000
$TCE09   DC    X'FFFFFFFF'                                              01063000
         ORG   $TCA09+13                                                01064000
@00      EQU   00                      EQUATES FOR REGISTERS 0-15       01065000
@01      EQU   01                                                       01066000
@02      EQU   02                                                       01067000
@03      EQU   03                                                       01068000
@04      EQU   04                                                       01069000
@05      EQU   05                                                       01070000
@06      EQU   06                                                       01071000
@07      EQU   07                                                       01072000
@08      EQU   08                                                       01073000
@09      EQU   09                                                       01074000
@10      EQU   10                                                       01075000
@11      EQU   11                                                       01076000
@12      EQU   12                                                       01077000
@13      EQU   13                                                       01078000
@14      EQU   14                                                       01079000
@15      EQU   15                                                       01080000
WAPTR    EQU   @02                                                      01081000
R1       EQU   @01                                                      01082000
EXITPTR  EQU   @14                                                      01083000
SAVPTR   EQU   @13                                                      01084000
RCGEN    EQU   @15                                                      01085000
RC       EQU   @10                                                      01086000
TOLTEPWA EQU   0                                                        01087000
$CDA     EQU   TOLTEPWA+100                                             01088000
$RCA     EQU   $CDA+44                                                  01089000
$OLTPTR  EQU   $CDA+52                                                  01090000
$HIMOREC EQU   $CDA+60                                                  01091000
$COMMFLG EQU   TOLTEPWA+224                                             01092000
$FLAG8   EQU   $COMMFLG+7                                               01093000
$TCECM   EQU   $FLAG8                                                   01094000
$INBUFR  EQU   TOLTEPWA+2104                                            01095000
#EXITA   EQU   TOLTEPWA+2632                                            01096000
$CCOMDAT EQU   TOLTEPWA+2644                                            01097000
$CFLGS   EQU   $CCOMDAT+16                                              01098000
$24FEMSG EQU   TOLTEPWA+2681                                            01099000
$24CATMG EQU   $24FEMSG+11                                              01100000
@NM00022 EQU   TOLTEPWA+2776                                            01101000
$OUNTPTR EQU   @NM00022+4                                               01102000
$NSPTR   EQU   $OUNTPTR                                                 01103000
$NSCNT   EQU   @NM00022+10                                              01104000
$ENXX    EQU   @NM00022+15                                              01105000
$IMITX   EQU   $ENXX                                                    01106000
SVESC033 EQU   TOLTEPWA+3160                                            01107000
SVECC013 EQU   TOLTEPWA+3232                                            01108000
SVEIC003 EQU   TOLTEPWA+3592                                            01109000
SVESC022 EQU   TOLTEPWA+3736                                            01110000
SVECC011 EQU   TOLTEPWA+4024                                            01111000
#EXIT    EQU   0                                                        01112000
SUBCHAR  EQU   0                                                        01113000
BACKSAVE EQU   0                                                        01114000
SVECC012 EQU   SVESC022                                                 01115000
SVEIC00A EQU   SVEIC003                                                 01116000
SVEIC004 EQU   SVEIC003                                                 01117000
SVEIC005 EQU   SVEIC003                                                 01118000
SVESC02A EQU   SVESC022                                                 01119000
SVESC02B EQU   SVESC022                                                 01120000
SVESC02D EQU   SVESC022                                                 01121000
SVESC02E EQU   SVESC022                                                 01122000
SVESC02F EQU   SVECC013                                                 01123000
SVESC024 EQU   SVESC022                                                 01124000
SVESC027 EQU   SVESC022                                                 01125000
SVESC029 EQU   SVESC033                                                 01126000
SVESC031 EQU   SVECC013                                                 01127000
SVESC032 EQU   SVECC011                                                 01128000
SVETC037 EQU   SVEIC003                                                 01129000
         AGO   .@UNREFD                START UNREFERENCED COMPONENTS    01130000
SVECC010 EQU   TOLTEPWA+3952                                            01131000
SVETC035 EQU   TOLTEPWA+3880                                            01132000
SVESC030 EQU   TOLTEPWA+3808                                            01133000
SVESC020 EQU   TOLTEPWA+3664                                            01134000
SVEIC002 EQU   TOLTEPWA+3520                                            01135000
SVECC014 EQU   TOLTEPWA+3376                                            01136000
SVESC120 EQU   TOLTEPWA+3304                                            01137000
SVESC025 EQU   TOLTEPWA+3088                                            01138000
@NM00024 EQU   TOLTEPWA+2980                                            01139000
$RPLERR  EQU   TOLTEPWA+2977                                            01140000
@NM00023 EQU   TOLTEPWA+2976                                            01141000
$R13PR3  EQU   TOLTEPWA+2972                                            01142000
$CEINT2  EQU   TOLTEPWA+2968                                            01143000
$CEINT1  EQU   TOLTEPWA+2964                                            01144000
$MSGGET  EQU   TOLTEPWA+2960                                            01145000
$ACQLIST EQU   TOLTEPWA+2956                                            01146000
$R4SAVE1 EQU   TOLTEPWA+2952                                            01147000
$CLSISS  EQU   TOLTEPWA+2950                                            01148000
$CLSCNT  EQU   TOLTEPWA+2948                                            01149000
$CUTABLE EQU   TOLTEPWA+2868                                            01150000
$BUFSZ2  EQU   TOLTEPWA+2864                                            01151000
$RESID2  EQU   TOLTEPWA+2860                                            01152000
$OLTCCW2 EQU   TOLTEPWA+2856                                            01153000
$ENDBFR2 EQU   TOLTEPWA+2852                                            01154000
$1STBFR2 EQU   TOLTEPWA+2848                                            01155000
$TECB2   EQU   TOLTEPWA+2844                                            01156000
$BUFSZ1  EQU   TOLTEPWA+2840                                            01157000
$RESID1  EQU   TOLTEPWA+2836                                            01158000
$OLTCCW1 EQU   TOLTEPWA+2832                                            01159000
$ENDBFR1 EQU   TOLTEPWA+2828                                            01160000
$1STBFR1 EQU   TOLTEPWA+2824                                            01161000
$TECB1   EQU   TOLTEPWA+2820                                            01162000
$WAITIME EQU   TOLTEPWA+2816                                            01163000
$TRTN#   EQU   TOLTEPWA+2815                                            01164000
$WIODEV  EQU   TOLTEPWA+2814                                            01165000
$RQSTSZE EQU   TOLTEPWA+2812                                            01166000
$RQSTPTR EQU   TOLTEPWA+2808                                            01167000
$R4SAVE  EQU   TOLTEPWA+2804                                            01168000
$PARTADR EQU   TOLTEPWA+2800                                            01169000
$TBSDATA EQU   TOLTEPWA+2796                                            01170000
$CTWIDTH EQU   TOLTEPWA+2795                                            01171000
$CTLINE  EQU   TOLTEPWA+2794                                            01172000
$APWIDTH EQU   TOLTEPWA+2793                                            01173000
$APLINE  EQU   TOLTEPWA+2792                                            01174000
$INDEX   EQU   $IMITX                                                   01175000
$UMXX    EQU   @NM00022+14                                              01176000
$NSXX    EQU   @NM00022+12                                              01177000
$ATACNT  EQU   $NSCNT                                                   01178000
$CTR     EQU   @NM00022+8                                               01179000
$ATAPTR  EQU   $NSPTR                                                   01180000
$DDRPTR  EQU   @NM00022                                                 01181000
$DTORESP EQU   TOLTEPWA+2712                                            01182000
$APNAME  EQU   TOLTEPWA+2704                                            01183000
$24SYMNE EQU   $24CATMG+4                                               01184000
$24DEVAD EQU   $24CATMG                                                 01185000
$24RTN#  EQU   $24FEMSG+8                                               01186000
$ESECTID EQU   $24FEMSG                                                 01187000
$24FLGS  EQU   TOLTEPWA+2680                                            01188000
$24SAVE2 EQU   TOLTEPWA+2676                                            01189000
$24SAVE1 EQU   TOLTEPWA+2672                                            01190000
$24UNADR EQU   TOLTEPWA+2668                                            01191000
$24SAV13 EQU   TOLTEPWA+2664                                            01192000
$24RETCD EQU   TOLTEPWA+2663                                            01193000
$MACID   EQU   TOLTEPWA+2661                                            01194000
$CSPARE  EQU   $CFLGS                                                   01195000
$C2WAY   EQU   $CFLGS                                                   01196000
$CINCT   EQU   $CCOMDAT+12                                              01197000
$CINADR  EQU   $CCOMDAT+8                                               01198000
$COUTCT  EQU   $CCOMDAT+4                                               01199000
$COUTAD  EQU   $CCOMDAT                                                 01200000
ROOTLOC  EQU   TOLTEPWA+2640                                            01201000
$RETREG  EQU   TOLTEPWA+2636                                            01202000
$WORK    EQU   TOLTEPWA+2376                                            01203000
$EXTA    EQU   TOLTEPWA+2320                                            01204000
$PASSONA EQU   TOLTEPWA+2264                                            01205000
$TRMINPT EQU   TOLTEPWA+2184                                            01206000
$BUFFER  EQU   TOLTEPWA+1976                                            01207000
$TLTRPL3 EQU   TOLTEPWA+1856                                            01208000
$TLTRPL2 EQU   TOLTEPWA+1736                                            01209000
$TLTRPL1 EQU   TOLTEPWA+1616                                            01210000
$SLTBL   EQU   TOLTEPWA+1468                                            01211000
@NM00021 EQU   TOLTEPWA+1464                                            01212000
$DEVTBLE EQU   TOLTEPWA+240                                             01213000
@NM00020 EQU   $COMMFLG+15                                              01214000
@NM00019 EQU   $COMMFLG+14                                              01215000
@NM00018 EQU   $COMMFLG+13                                              01216000
@NM00017 EQU   $COMMFLG+12                                              01217000
@NM00016 EQU   $COMMFLG+11                                              01218000
@NM00015 EQU   $COMMFLG+10                                              01219000
@NM00014 EQU   $COMMFLG+9                                               01220000
@NM00013 EQU   $COMMFLG+8                                               01221000
$VS2     EQU   $FLAG8                                                   01222000
$VS1     EQU   $FLAG8                                                   01223000
$EDOS    EQU   $FLAG8                                                   01224000
@NM00012 EQU   $FLAG8                                                   01225000
$TWOWAY  EQU   $FLAG8                                                   01226000
@NM00011 EQU   $FLAG8                                                   01227000
@NM00010 EQU   $COMMFLG+6                                               01228000
@NM00009 EQU   $COMMFLG+5                                               01229000
@NM00008 EQU   $COMMFLG+4                                               01230000
@NM00007 EQU   $COMMFLG+3                                               01231000
@NM00006 EQU   $COMMFLG+2                                               01232000
@NM00005 EQU   $COMMFLG+1                                               01233000
@NM00004 EQU   $COMMFLG                                                 01234000
@NM00003 EQU   $CDA+120                                                 01235000
$CUCNT   EQU   $CDA+118                                                 01236000
@NM00002 EQU   $CDA+117                                                 01237000
$PRTFORM EQU   $CDA+116                                                 01238000
$OPISCNT EQU   $CDA+114                                                 01239000
$OPNDCNT EQU   $CDA+112                                                 01240000
$GETMSZE EQU   $CDA+110                                                 01241000
$GRCNTS  EQU   $CDA+108                                                 01242000
$CTLCNT  EQU   $CDA+106                                                 01243000
$ACTLVL  EQU   $CDA+105                                                 01244000
$PRNTLVL EQU   $CDA+104                                                 01245000
$ERRCNTA EQU   $CDA+102                                                 01246000
$TLCNT   EQU   $CDA+100                                                 01247000
$TIMEALW EQU   $CDA+96                                                  01248000
$PTRAREA EQU   $CDA+92                                                  01249000
$GETMPTR EQU   $CDA+88                                                  01250000
$R13PTRT EQU   $CDA+84                                                  01251000
$R13PTR  EQU   $CDA+80                                                  01252000
$TEPEND  EQU   $CDA+76                                                  01253000
$PLINKDL EQU   $CDA+72                                                  01254000
$TEPBEGN EQU   $CDA+68                                                  01255000
$FRELPTR EQU   $CDA+64                                                  01256000
$HIGHADR EQU   $HIMOREC                                                 01257000
$LOMOREC EQU   $CDA+56                                                  01258000
$LOWADDR EQU   $OLTPTR                                                  01259000
$ENDCOMM EQU   $CDA+48                                                  01260000
$COMMON  EQU   $RCA                                                     01261000
$SLASHAD EQU   $CDA+32                                                  01262000
$PASSON  EQU   $CDA+28                                                  01263000
$TOLBRTB EQU   $CDA+24                                                  01264000
$SCTPTR8 EQU   $CDA+20                                                  01265000
$SCTPTR  EQU   $CDA+16                                                  01266000
$TBWDPTR EQU   $CDA+12                                                  01267000
$TFWDPTR EQU   $CDA+8                                                   01268000
@NM00001 EQU   $CDA                                                     01269000
$SCTTBLE EQU   TOLTEPWA                                                 01270000
.@UNREFD ANOP                          END UNREFERENCED COMPONENTS      01271000
@ENDDATA EQU   *                                                        01272000
         END   ISTCC013,(C'PLS1038',0702,78336)                         01273000
./  ADD  SSI=90781299,NAME=ISTCC014
         TITLE 'RESOURCE MANAGER-ISTCC014'                              00001000
*         IBM DISK OPERATING SYSTEM                                     00002000
*         TOLTEP-5745-SC-TLT                                            00003000
          ISEQ 73,80                                                    00004000
ISTCC014 CSECT ,                                                   0002 00005000
@MAINENT DS    0H                                                  0002 00006000
         USING *,@15                                               0002 00007000
         B     @PROLOG                                             0002 00008000
         DC    AL1(16)                                             0002 00009000
         DC    C'ISTCC014  79.078'                                 0002 00010000
         DROP  @15                                                      00011000
@PROLOG  STM   @14,@12,12(@13)                                     0002 00012000
         BALR  @12,0                                               0002 00013000
@PSTART  DS    0H                                                  0002 00014000
         USING @PSTART,@12                                         0002 00015000
         ST    @13,@SA00001+4                                      0002 00016000
         LA    @14,@SA00001                                        0002 00017000
         ST    @14,8(,@13)                                         0002 00018000
         LR    @13,@14                                             0002 00019000
         PRINT OFF                                                      00020000
         PRINT ON                                                       00021000
         PRINT OFF                                                      00022000
         PRINT ON                                                       00023000
*                                                                  0105 00024000
*/********************************************************************  00025000
*                                                                    */ 00026000
*/*      SAVE  CALLERS REG 13 IN T.W.A                               */ 00027000
*/********************************************************************/ 00028000
*                                                                  0106 00029000
*   BASEREG=R12;                    /* SVEBASE REG FOR C14C0020      */ 00030000
         ST    R12,BASEREG                                         0106 00031000
*   SAVEDR13=R13;                   /* SAVE FOR LATER        @DA04678*/ 00032000
         ST    R13,SAVEDR13                                        0107 00033000
*   GEN;                                                           0108 00034000
         L     R4,L4(R13)               /* PICK UP CALLERS SAVE REG  */ 00035000
L4        EQU   4                                                       00036000
L12      EQU   12                                                       00037000
L16       EQU   16                                                      00038000
L20       EQU   20                                                      00039000
*   IF $TEP2ND='1'B                 /* IS THIS THIRD PASS THOUGH     */ 00040000
*     THEN                                                         0109 00041000
         TM    $TEP2ND(WAPTR),B'00000001'                          0109 00042000
         BNO   @RF00109                                            0109 00043000
*     DO;                                                          0110 00044000
*       $TEP3RD='1'B;               /* SET 3RD IND                   */ 00045000
         OI    $TEP3RD(WAPTR),B'10000000'                          0111 00046000
*       $R13PR3=R4;                 /* SAVE RETURN REG               */ 00047000
         ST    R4,$R13PR3(,WAPTR)                                  0112 00048000
*     END;                                                         0113 00049000
*   ELSE                            /* IF NOT 3RD CHK FOR 2ND/1ST    */ 00050000
*     IF $TEP1ST='1'B               /* IS THIS A CALL FROM           */ 00051000
*       THEN                        /* TOLTEP AS A RESULT OF AN      */ 00052000
         B     @RC00109                                            0114 00053000
@RF00109 TM    $TEP1ST(WAPTR),B'00000010'                          0114 00054000
         BNO   @RF00114                                            0114 00055000
*       DO;                         /* OLT MACRO CALL                */ 00056000
*         $R13PTRT=R4;              /* IF YES SAVE R13 IN DIFFT      */ 00057000
         ST    R4,$R13PTRT(,WAPTR)                                 0116 00058000
*         $TEP2ND='1'B;             /* AREA & SET RECALL BIT ON      */ 00059000
         OI    $TEP2ND(WAPTR),B'00000001'                          0117 00060000
*       END;                                                       0118 00061000
*     ELSE                          /* IF NOT THE SECOND PASS        */ 00062000
*       DO;                         /* THRU SAVE R13 IN NORMAL       */ 00063000
         B     @RC00114                                            0119 00064000
@RF00114 DS    0H                                                  0120 00065000
*         $R13PTR=R4;               /* SPOT                          */ 00066000
         ST    R4,$R13PTR(,WAPTR)                                  0120 00067000
*         $TEP1ST='1'B;             /* SET ON FIRST CALL BIT         */ 00068000
         OI    $TEP1ST(WAPTR),B'00000010'                          0121 00069000
*         IF $TCECM='0'B&           /* TEST FOR 1ST OLT OR           */ 00070000
*             FLAGS='00'X           /* TCEC CALL                     */ 00071000
*           THEN                    /* IF OLT CALL SET BIT ON        */ 00072000
         TM    $TCECM(WAPTR),B'00000001'                           0122 00073000
         BNZ   @RF00122                                            0122 00074000
         CLI   FLAGS(R1),X'00'                                     0122 00075000
         BNE   @RF00122                                            0122 00076000
*           $OLTMACC='1'B;                                         0123 00077000
         OI    $OLTMACC(WAPTR),B'00100000'                         0123 00078000
*         ELSE                      /* IF NO SET BIT OFF             */ 00079000
*           $OLTMACC='0'B;                                         0124 00080000
         B     @RC00122                                            0124 00081000
@RF00122 NI    $OLTMACC(WAPTR),B'11011111'                         0124 00082000
*       END;                                                       0125 00083000
@RC00122 DS    0H                                                  0126 00084000
*   R3=$RCA;                        /* GET PTR TO RES.COMM.AREA      */ 00085000
@RC00114 DS    0H                                                  0126 00086000
@RC00109 L     R3,$RCA(,WAPTR)                                     0126 00087000
*   $INBND='1'B;                    /* SET INBOUND SWITCH            */ 00088000
         OI    $INBND(WAPTR),B'00100000'                           0127 00089000
*   R2=SAVEDR2;                     /* RESET*R2*TO*LAST*USED******   */ 00090000
         L     R2,SAVEDR2                                          0128 00091000
*   IF R2¬=0                        /* IF*ZERO*START*OVER*AGAIN***   */ 00092000
*     THEN                          /* IF*NOT*ZERO*START*WHERE****   */ 00093000
         LTR   R2,R2                                               0129 00094000
         BNZ   @RT00129                                            0129 00095000
*     GOTO C14C0002;                /* LAST*LEFT*OFF**************   */ 00096000
*C14C0001:                                                         0131 00097000
*   ;                                                              0131 00098000
C14C0001 DS    0H                                                  0132 00099000
*   R2=$FSTAREA;                    /* SET R2 TO BASE OF T.W.A.      */ 00100000
         L     R2,$FSTAREA(,RCAPTR)                                0132 00101000
*   IF R2=0 THEN                                                   0133 00102000
         LTR   R2,R2                                               0133 00103000
         BNZ   @RF00133                                            0133 00104000
*     DO;                           /* IF NO TWA, THEN PROCESS IS  0134 00105000
*                                      ENDING AND WE SHOULD EXIT.  0134 00106000
*                                                            @XA15990*/ 00107000
*       R13=SAVEDR13;               /* RESTORE R13           @XA15990*/ 00108000
         L     R13,SAVEDR13                                        0135 00109000
*       RETURN;                     /* RETURN TO CALLER      @XA15990*/ 00110000
@EL00001 L     @13,4(,@13)                                         0136 00111000
@EF00001 DS    0H                                                  0136 00112000
@ER00001 LM    @14,@12,12(@13)                                     0136 00113000
         BR    @14                                                 0136 00114000
*     END;                          /*                       @XA15990*/ 00115000
*   BUSYCNT=0;                      /* SET BUSY COUNT BACK TO ZERO   */ 00116000
@RF00133 SLR   @11,@11                                             0138 00117000
         STH   @11,BUSYCNT                                         0138 00118000
*C14C0002:                                                         0139 00119000
*   ;                                                              0139 00120000
C14C0002 DS    0H                                                  0140 00121000
*   $CURRTWA=R2;                    /* SAVE CURRENT USER ADDRESS     */ 00122000
         ST    R2,$CURRTWA(,RCAPTR)                                0140 00123000
*   R15=R13;                        /* SAVE CALLERS SAVE REG         */ 00124000
         LR    R15,R13                                             0141 00125000
*   R13=ADDR(SVECC014(1));          /* PICK UP MY SAVE REG AREA      */ 00126000
         LA    R13,SVECC014(,WAPTR)                                0142 00127000
*   SVECC014(2)=R15;                /* CHAIN AREAS TOGETHER          */ 00128000
         ST    R15,SVECC014+4(,WAPTR)                              0143 00129000
*   BACKSAVE(3)=R13;                                               0144 00130000
         ST    R13,BACKSAVE+8(,R15)                                0144 00131000
*   R4=ATCLCPTR;                    /*                        @MAK4WX*/ 00132000
         L     R4,ATCLCPTR                                         0145 00133000
*   RESPECIFY                                                      0146 00134000
*     ISTATCVT BASED(R4);                                          0146 00135000
*   IF ATCMTST='1'B                 /* ** IS A CONSOLE INIT WANTED   */ 00136000
*     THEN                          /* ** IF YES GOTO SIM LOGON      */ 00137000
         TM    ATCMTST(R4),B'10000000'                             0147 00138000
         BNO   @RF00147                                            0147 00139000
*     DO;                           /* **                            */ 00140000
*       ATCECTLP=0;                 /* SET ECB TO 0                  */ 00141000
         SLR   @11,@11                                             0149 00142000
         ST    @11,ATCECTLP(,R4)                                   0149 00143000
*       CALL I00C0070;              /* ** I00C0070                   */ 00144000
         L     @15,@CV01973                                        0150 00145000
         BALR  @14,@15                                             0150 00146000
*/***** FOLOWING LINE DELETED BY APAR 0X23476 OZ38432 DY20612  ****  */ 00147000
*/*                   ATCMTST='0'B                                   */ 00148000
*                                                                  0151 00149000
*     END;                                                         0151 00150000
*   R14=ADDR(C14C0004);             /* SET RETURN ADDRESS            */ 00151000
@RF00147 LA    R14,C14C0004                                        0152 00152000
*   IF $HOLD='1'B                   /* CHECK TO STOP SCHEDULING      */ 00153000
*     THEN                          /* IF BIT ON SKIP THIS TEST      */ 00154000
         TM    $HOLD(WAPTR),B'00000001'                            0153 00155000
         BO    @RT00153                                            0153 00156000
*     GOTO C14C0004;                                               0154 00157000
*   IF $EOJ='1'B&                   /* IF CANCEL,LOGOFF,CT I/O ER    */ 00158000
*       $LOGOFFE='0'B&              /* & LOGOFF ROUT NOT ENTERED     */ 00159000
*       $ABTERM='0'B                /* & ABTERM ROUT NOT ENTERED     */ 00160000
*     THEN                          /* BIT WILL BE ON AND TEST IS    */ 00161000
         TM    $EOJ(WAPTR),B'00000010'                             0155 00162000
         BNO   @RF00155                                            0155 00163000
         TM    $LOGOFFE(WAPTR),B'00100000'                         0155 00164000
         BNZ   @RF00155                                            0155 00165000
         TM    $ABTERM(WAPTR),B'00000010'                          0155 00166000
         BNZ   @RF00155                                            0155 00167000
*     DO;                           /* TO BE DROPPED                 */ 00168000
*       R15=ADDR(C14C0020);         /* EXIT TO LOGOFF                */ 00169000
         LA    R15,C14C0020                                        0157 00170000
*       GEN(BR    R15);             /* ROUTINE TO EXIT               */ 00171000
         BR    R15                                                      00172000
*     END;                                                         0159 00173000
*   IF $EXIOWAT='1'B                /* FOR ALL API REQ               */ 00174000
*     THEN                          /* TO BE RETURNED                */ 00175000
@RF00155 TM    $EXIOWAT(WAPTR),B'00100000'                         0160 00176000
         BNO   @RF00160                                            0160 00177000
*     DO;                           /* BY VTAM IF YES                */ 00178000
*       R4=$R13PTR;                 /* GIVE CONTROL BK               */ 00179000
         L     R4,$R13PTR(,WAPTR)                                  0162 00180000
*       GEN(LM    R0,R1,L20(R4));   /* TO EXIO AFTER                 */ 00181000
         LM    R0,R1,L20(R4)                                            00182000
*       R14=ADDR(C14C0007);         /* RESETTING R0 &                */ 00183000
         LA    R14,C14C0007                                        0164 00184000
*       R15=ADDR(ISTSC027);         /* R1                            */ 00185000
         L     R15,@CV01985                                        0165 00186000
*       GEN(BR    R15);             /*                               */ 00187000
         BR    R15                                                      00188000
*     END;                          /*                               */ 00189000
*   IF $REQSTOR='1'B                /* IS SOMEONE WAITING FOR        */ 00190000
*     THEN                          /* STORAGE YES GO TRY AGAIN      */ 00191000
@RF00160 TM    $REQSTOR(WAPTR),B'00010000'                         0168 00192000
         BO    @RT00168                                            0168 00193000
*     GOTO C14C0035;                /* TO GET IT                     */ 00194000
*   IF $ENDTEST='1'B                /* WAS A VARY DETECTED           */ 00195000
*     THEN                          /* FOR THIS TEST IF YES          */ 00196000
         TM    $ENDTEST(WAPTR),B'00001000'                         0170 00197000
         BNO   @RF00170                                            0170 00198000
*     DO;                           /* RESET ALL BITS SO TO          */ 00199000
*       $TEP1ST='0'B;               /* SIMULATE A CANCEL             */ 00200000
*       $TEP2ND='0'B;               /* TEST TO STOP HERE &           */ 00201000
         NI    $TEP1ST(WAPTR),B'11111100'                          0173 00202000
*       $TEP3RD='0'B;               /* GO BACK FOR 105D-ASIF         */ 00203000
         NI    $TEP3RD(WAPTR),B'01111111'                          0174 00204000
*       $REQSTOR='0'B;              /* OLT ISSUED A DTERM            */ 00205000
         NI    $REQSTOR(WAPTR),B'11101111'                         0175 00206000
*       $ENDTEST='0'B;              /*                               */ 00207000
         NI    $ENDTEST(WAPTR),B'11110111'                         0176 00208000
*       $OLTMACC='0'B;              /*                               */ 00209000
         NI    $OLTMACC(WAPTR),B'11011111'                         0177 00210000
*       $ACTOPND='0'B;                                             0178 00211000
*       $CLSSACT='0'B;                                             0179 00212000
         NI    $ACTOPND(WAPTR),B'11111010'                         0179 00213000
*       $WAITFLG='0'B;                                             0180 00214000
         NI    $WAITFLG(WAPTR),B'10111111'                         0180 00215000
*       $POSTFLG='0'B;                                             0181 00216000
         NI    $POSTFLG(WAPTR),B'10111111'                         0181 00217000
*       $CIREQ='0'B;                /*                               */ 00218000
         NI    $CIREQ(WAPTR),B'11111110'                           0182 00219000
*       $SNDRFLG='0'B;              /* WAITING ON SEND        @DM0908*/ 00220000
*       $RCVRFLG='0'B;              /* WAITING ON RECEIVE     @DM0908*/ 00221000
         NI    $SNDRFLG(WAPTR),B'11111001'                         0184 00222000
*       $VARYINP='1'B;              /* SET ON VARY IN PROC           */ 00223000
         OI    $VARYINP(WAPTR),B'00000100'                         0185 00224000
*       R0=4;                       /* BIT                           */ 00225000
         LA    R0,4                                                0186 00226000
*       R15=ADDR(ISTCC010);         /* GOTO DTERM                    */ 00227000
         L     R15,@CV01971                                        0187 00228000
*       GEN(BR    R15);             /*                               */ 00229000
         BR    R15                                                      00230000
*     END;                          /*                               */ 00231000
*   IF $ACTOPND='1'B                /* TEST IS OPEN PENDING          */ 00232000
*     THEN                          /* IF YES GOTO S30C1000 FOR      */ 00233000
@RF00170 TM    $ACTOPND(WAPTR),B'00000001'                         0190 00234000
         BNO   @RF00190                                            0190 00235000
*     DO;                           /* TIME CHECK                    */ 00236000
*       R14=ADDR(C14C0007);         /* SET RTN POINT                 */ 00237000
         LA    R14,C14C0007                                        0192 00238000
*       R15=ADDR(S30C1000);                                        0193 00239000
         L     R15,@CV01980                                        0193 00240000
*       GEN(BR    R15);                                            0194 00241000
         BR    R15                                                      00242000
*     END;                                                         0195 00243000
*   IF $CLSSACT='1'B THEN                                          0196 00244000
@RF00190 TM    $CLSSACT(WAPTR),B'00000100'                         0196 00245000
         BNO   @RF00196                                            0196 00246000
*     DO;                           /* IF ON, WAIT FOR RELEASE       */ 00247000
*       R14=ADDR(C14C0007);         /* SET RTN POINT                 */ 00248000
         LA    R14,C14C0007                                        0198 00249000
*       R15=ADDR(S31C0480);         /* POINT TO ENTRY POINT          */ 00250000
         L     R15,@CV01981                                        0199 00251000
*       GEN(BR    R15);             /* CALL FUNCTION TO CHECK TIME   */ 00252000
         BR    R15                                                      00253000
*     END;                                                         0201 00254000
*   IF $WAITFLG='1'B                /* IF BIT ON TEST IS WAITING     */ 00255000
*       &$POSTFLG='0'B              /* & NOT BUSY                    */ 00256000
*     THEN                          /* POSSIBLE ON A TIME LOOP       */ 00257000
@RF00196 TM    $WAITFLG(WAPTR),B'01000000'                         0202 00258000
         BNO   @RF00202                                            0202 00259000
         TM    $POSTFLG(WAPTR),B'01000000'                         0202 00260000
         BNZ   @RF00202                                            0202 00261000
*     DO;                           /* EXIT TO WAITIO FOR TIME       */ 00262000
*       CALL S2FC1000;              /* GO TO WAITIO FOR CHECKS       */ 00263000
         L     @15,@CV01975                                        0204 00264000
         BALR  @14,@15                                             0204 00265000
*       IF $WAITFLG='0'B THEN       /* IF WAITIO DONE                */ 00266000
         TM    $WAITFLG(WAPTR),B'01000000'                         0205 00267000
         BZ    @RT00205                                            0205 00268000
*         GO TO C14C006A;                                          0206 00269000
*       GOTO C14C0007;                                             0207 00270000
         B     C14C0007                                            0207 00271000
*     END;                                                         0208 00272000
*C14C0003:                                                         0209 00273000
*   IF $POSTFLG='1'B                /* IF BIT ON TEST IS NOT RDY     */ 00274000
*     THEN                          /* TO SATISFY SOME OUTSTANDNG    */ 00275000
@RF00202 DS    0H                                                  0209 00276000
C14C0003 TM    $POSTFLG(WAPTR),B'01000000'                         0209 00277000
         BO    @RT00209                                            0209 00278000
*     GOTO C14C0004;                /* REQUEST GO ON TO NXT USER     */ 00279000
*   IF $SNDRFLG='1'B|$RCVRFLG='1'B THEN/* RECALL SEND OR RECEIVE   0211 00280000
*                                                            @D32JPFR*/ 00281000
         TM    $SNDRFLG(WAPTR),B'00000110'                         0211 00282000
         BZ    @RF00211                                            0211 00283000
*     DO;                           /* YES                   @D32JPFR*/ 00284000
*       R4=$R13PTR;                 /* OLT SAVE AREA PTR     @D32JPFR*/ 00285000
         L     R4,$R13PTR(,WAPTR)                                  0213 00286000
*       GEN(LM R0,R1,L20(R4));      /* RESTORE REGS          @D32JPFR*/ 00287000
         LM R0,R1,L20(R4)                                               00288000
*       R15=ADDR(ISTSC033);         /* GET ADDR OF RTN TO CALL     0215 00289000
*                                                            @D32JPFR*/ 00290000
         L     R15,@CV01984                                        0215 00291000
*       IF $SNDRFLG='1'B THEN       /* GET ADDR OF RTN TO CALL     0216 00292000
*                                                            @D32JPFR*/ 00293000
         TM    $SNDRFLG(WAPTR),B'00000100'                         0216 00294000
         BNO   @RF00216                                            0216 00295000
*         R15=ADDR(ISTSC025);       /* BAD GUESS, DO OTHER MOD     0217 00296000
*                                                            @D32JPFR*/ 00297000
         L     R15,@CV01983                                        0217 00298000
*       GEN(BALR R14,R15);          /* CALL FUNCTION         @D32JPFR*/ 00299000
@RF00216 DS    0H                                                  0218 00300000
         BALR R14,R15                                                   00301000
*       IF $SNDRFLG='0'B&$RCVRFLG='0'B THEN/* DID THE FUNCTION COMP     00302000
*                                                            @D32JPFR*/ 00303000
         TM    $SNDRFLG(WAPTR),B'00000110'                         0219 00304000
         BZ    @RT00219                                            0219 00305000
*         GO TO C14C006A;           /* YES, REDUCE COUNT     @D32JPFR*/ 00306000
*       GO TO C14C0007;             /* NO, CHECK NEXT USER   @D32JPFR*/ 00307000
         B     C14C0007                                            0221 00308000
*     END;                          /* END OF SEND/RECEIVE RECALL  0222 00309000
*                                                            @D32JPFR*/ 00310000
*   IF $RECAL11='1'B                /* RECALL ISTCC011               */ 00311000
*     THEN                          /* IF YES MSGIO HAS ORIG MSG     */ 00312000
@RF00211 TM    $RECAL11(WAPTR),B'10000000'                         0223 00313000
         BNO   @RF00223                                            0223 00314000
*     DO;                           /* TO PUT OUT                    */ 00315000
*       R13=SAVEDR13;               /* USE ORIG AREA         @DA04678*/ 00316000
         L     R13,SAVEDR13                                        0225 00317000
*       CALL ISTCC011;              /* CALL TO START MSGS    @D32JPFR*/ 00318000
         L     @15,@CV01972                                        0226 00319000
         BALR  @14,@15                                             0226 00320000
*       IF $RECAL11='0'B THEN       /* RECALL ISTCC011 LATER?      0227 00321000
*                                                            @D32JPFR*/ 00322000
         TM    $RECAL11(WAPTR),B'10000000'                         0227 00323000
         BZ    @RT00227                                            0227 00324000
*         GO TO C14C006A;           /* NO,REDUCE COUNT       @D32JPFR*/ 00325000
*       GO TO C14C0007;             /* CHECK NEXT USER       @D32JPFR*/ 00326000
         B     C14C0007                                            0229 00327000
*     END;                                                         0230 00328000
*   IF $TWOWAY='1'B                 /* TEST FOR TWOWAY NEEDED FOR    */ 00329000
*     THEN                          /* ALTERNATE PRINTER             */ 00330000
@RF00223 TM    $TWOWAY(WAPTR),B'01000000'                          0231 00331000
         BNO   @RF00231                                            0231 00332000
*     DO;                           /* IF YES PUT REPLY TO AP        */ 00333000
*       $TWOWAY='0'B;               /* RESET BIT INDICATOR           */ 00334000
         NI    $TWOWAY(WAPTR),B'10111111'                          0233 00335000
*       $COUTAD=$CINADR;            /* SET OUTPUT ADDR               */ 00336000
         L     @11,$CINADR(,WAPTR)                                 0234 00337000
         ST    @11,$COUTAD(,WAPTR)                                 0234 00338000
*       R5=$COUTAD;                 /* SET OUTPUT SIZE               */ 00339000
         LR    R5,@11                                              0235 00340000
*       R5=R5-1;                                                   0236 00341000
         BCTR  R5,0                                                0236 00342000
*       R15=REPLYSZE;                                              0237 00343000
         SLR   R15,R15                                             0237 00344000
         IC    R15,REPLYSZE(,R5)                                   0237 00345000
*       $COUTCT=R15;                                               0238 00346000
         ST    R15,$COUTCT(,WAPTR)                                 0238 00347000
*       $CINADR=0;                  /* SET INDICATOR FOR             */ 00348000
         SLR   @11,@11                                             0239 00349000
         ST    @11,$CINADR(,WAPTR)                                 0239 00350000
*       $CINCT=0;                   /* ONE WAY OUTPUT                */ 00351000
         ST    @11,$CINCT(,WAPTR)                                  0240 00352000
*       $C2WAY='0'B;                                               0241 00353000
         NI    $C2WAY(WAPTR),B'01111111'                           0241 00354000
*       $PRTONLY='1'B;              /* SET ON AP ONLY BIT            */ 00355000
         OI    $PRTONLY(WAPTR),B'00001000'                         0242 00356000
*       R15=ADDR(ISTCC011);         /* GOTO PUT OUT REPLY            */ 00357000
         L     R15,@CV01972                                        0243 00358000
*       GEN(BR    R15);             /* RETURN IN R14 ALRDY           */ 00359000
         BR    R15                                                      00360000
*       GO TO C14C0003;             /* CHECK TO SEE IF WRITE DONE    */ 00361000
         B     C14C0003                                            0245 00362000
*     END;                                                         0246 00363000
*                                                                  0246 00364000
*/********************************************************************/ 00365000
*/*      TEST WORK AREA READY TO USE                                 */ 00366000
*/********************************************************************/ 00367000
*                                                                  0247 00368000
*   IF $INBND='1'B                  /* IS REQUEST FROM OLT/TOLTEP    */ 00369000
*     THEN                          /* FOR SOME SERVICE MACRO        */ 00370000
@RF00231 TM    $INBND(WAPTR),B'00100000'                           0247 00371000
         BNO   @RF00247                                            0247 00372000
*     DO;                           /* I.E. INBOUND IF YES           */ 00373000
*       $INBND='0'B;                /* TURN OFF BIT                  */ 00374000
         NI    $INBND(WAPTR),B'11011111'                           0249 00375000
*       IF $TEP3RD='1'B             /* IS THIS THIRD CALL            */ 00376000
*         THEN                                                     0250 00377000
         TM    $TEP3RD(WAPTR),B'10000000'                          0250 00378000
         BNO   @RF00250                                            0250 00379000
*         R4=$R13PR3;               /* YES GET R4 SET                */ 00380000
         L     R4,$R13PR3(,WAPTR)                                  0251 00381000
*       ELSE                        /* IF NO CHK 2ND/1ST             */ 00382000
*         IF $TEP2ND='1'B           /* IS THIS 2ND CALL              */ 00383000
*           THEN                    /* YES R13 SAVED                 */ 00384000
         B     @RC00250                                            0252 00385000
@RF00250 TM    $TEP2ND(WAPTR),B'00000001'                          0252 00386000
         BNO   @RF00252                                            0252 00387000
*           R4=$R13PTRT;            /* IN DIFF SPOT                  */ 00388000
         L     R4,$R13PTRT(,WAPTR)                                 0253 00389000
*         ELSE                      /* NO SAVED IN NORM              */ 00390000
*           R4=$R13PTR;             /* SPOT                          */ 00391000
         B     @RC00252                                            0254 00392000
@RF00252 L     R4,$R13PTR(,WAPTR)                                  0254 00393000
*       GEN(LM    R0,R1,L20(R4));   /* RESTORE 0,1                   */ 00394000
@RC00252 DS    0H                                                  0255 00395000
@RC00250 DS    0H                                                  0255 00396000
         LM    R0,R1,L20(R4)                                            00397000
*       GOTO C14C0010;              /* EXIT TO MACRO ROUTER          */ 00398000
         B     C14C0010                                            0256 00399000
*     END;                                                         0257 00400000
*   IF $TEP3RD='1'B                 /* IS THIS THIRD CALL            */ 00401000
*     THEN                                                         0258 00402000
@RF00247 TM    $TEP3RD(WAPTR),B'10000000'                          0258 00403000
         BNO   @RF00258                                            0258 00404000
*     DO;                           /* IF YES DO THE FOLLOWING       */ 00405000
*       $TEP3RD='0'B;               /* SET IND OFF                   */ 00406000
         NI    $TEP3RD(WAPTR),B'01111111'                          0260 00407000
*       SVECC014(2)=$R13PR3;        /* SET R13 IN SAVE AREA          */ 00408000
         L     @11,$R13PR3(,WAPTR)                                 0261 00409000
         ST    @11,SVECC014+4(,WAPTR)                              0261 00410000
*       RETURN;                                                    0262 00411000
         B     @EL00001                                            0262 00412000
*     END;                                                         0263 00413000
*   IF $TEP2ND='1'B                 /* IS RTN TO BE TO OLT &/        */ 00414000
*     THEN                          /* CALLER(1ST) OR TO THE         */ 00415000
@RF00258 TM    $TEP2ND(WAPTR),B'00000001'                          0264 00416000
         BNO   @RF00264                                            0264 00417000
*     DO;                           /* 2ND CALLER                    */ 00418000
*       $TEP2ND='0'B;               /* 2ND CALLER SET BIT OFF        */ 00419000
         NI    $TEP2ND(WAPTR),B'11111110'                          0266 00420000
*       SVECC014(2)=$R13PTRT;       /* RESET R13                     */ 00421000
         L     @11,$R13PTRT(,WAPTR)                                0267 00422000
         ST    @11,SVECC014+4(,WAPTR)                              0267 00423000
*       RETURN;                                                    0268 00424000
         B     @EL00001                                            0268 00425000
*     END;                                                         0269 00426000
*   IF $NOTRRCH='0'B                /* IS THIS A RTN FROM DPRINT     */ 00427000
*     THEN                          /* FORMS PRINT OR MULTI LINE     */ 00428000
@RF00264 TM    $NOTRRCH(WAPTR),B'00000010'                         0270 00429000
         BNZ   @RF00270                                            0270 00430000
*     DO;                           /* NO--SEE ABOUT TRACING         */ 00431000
*       IF $OLTMACC='1'B            /* IS RETURN TO BE TRACED        */ 00432000
*         THEN                      /* YES MAYBE IT IS OLT CALL      */ 00433000
         TM    $OLTMACC(WAPTR),B'00100000'                         0272 00434000
         BNO   @RF00272                                            0272 00435000
*         DO;                       /* IF NOT ON EXEC CALL           */ 00436000
*           $OLTMACC='0'B;          /* SET BIT OFF                   */ 00437000
         NI    $OLTMACC(WAPTR),B'11011111'                         0274 00438000
*           GEN(BAL   R14,C14C0015);                               0275 00439000
         BAL   R14,C14C0015                                             00440000
*         END;                                                     0276 00441000
*       IF $CIREQ='1'B&             /* HAS A CI BEEN REQ             */ 00442000
*           $TESTMDE(1)='0'B&       /* AND CT NOT IN TEST MODE       */ 00443000
*           $OLTACT='1'B&           /* AND OLT ACTIVE AND NOT        */ 00444000
*           $CLEANUP='0'B           /* IN CLEANUP                    */ 00445000
*         THEN                      /* IF YES SET UP TO              */ 00446000
@RF00272 TM    $CIREQ(WAPTR),B'00000001'                           0277 00447000
         BNO   @RF00277                                            0277 00448000
         TM    $TESTMDE(WAPTR),B'00000010'                         0277 00449000
         BNZ   @RF00277                                            0277 00450000
         TM    $OLTACT(WAPTR),B'00000001'                          0277 00451000
         BNO   @RF00277                                            0277 00452000
         TM    $CLEANUP(WAPTR),B'00000100'                         0277 00453000
         BNZ   @RF00277                                            0277 00454000
*         DO;                       /* CHECK TO SEE IF LINE IS IN  0278 00455000
*                                      TEST MODE                     */ 00456000
*           DO J=3 TO $DEVCNTS;     /* CHECK TESTDEVICES             */ 00457000
         LA    J,3                                                 0279 00458000
         B     @DE00279                                            0279 00459000
@DL00279 DS    0H                                                  0280 00460000
*             IF $TESTMDE(J)='1'B&  /* IS TERMINAL IN TEST MODE      */ 00461000
*                 $LINENME(J)=$LINENME(1)/* AND ON SAVE LINE AS CT   */ 00462000
*               THEN                                               0280 00463000
         LR    @11,J                                               0280 00464000
         MH    @11,@CH00404                                        0280 00465000
         ST    @11,@TF00001                                        0280 00466000
         ALR   @11,WAPTR                                           0280 00467000
         TM    $TESTMDE-68(@11),B'00000010'                        0280 00468000
         BNO   @RF00280                                            0280 00469000
         LR    @11,WAPTR                                           0280 00470000
         AL    @11,@TF00001                                        0280 00471000
         CLC   $LINENME-68(8,@11),$LINENME(WAPTR)                  0280 00472000
         BE    @RT00280                                            0280 00473000
*               GO TO C14C0033;     /* IN TEST MODE, WAIT ON       0281 00474000
*                                      COMMUNICATION INTERVAL        */ 00475000
*           END;                    /* END OF LOOP CHECKING CT LINE     00476000
*                                      IN TEST                       */ 00477000
@RF00280 AL    J,@CF00101                                          0282 00478000
@DE00279 CH    J,$DEVCNTS(,WAPTR)                                  0282 00479000
         BNH   @DL00279                                            0282 00480000
*           GO TO C14C0006;         /* FORCE COMMUNICATION INTERVAL  */ 00481000
         B     C14C0006                                            0283 00482000
*         END;                      /* END OF CHECK FOR COMMUNICATION   00483000
*                                      INTERVAL                      */ 00484000
*C14C0033:                                                         0285 00485000
*       ;                           /* DO NEXT CHECK                 */ 00486000
@RF00277 DS    0H                                                  0285 00487000
C14C0033 DS    0H                                                  0286 00488000
*       IF $CIREQ='1'B&             /* IF OLT NOT ACT                */ 00489000
*           $LGON='1'B              /* CHK FOR 1ST TIME              */ 00490000
*         THEN                      /* IF 1ST TIME GO TO             */ 00491000
         TM    $CIREQ(WAPTR),B'00000001'                           0286 00492000
         BNO   @RF00286                                            0286 00493000
         TM    $LGON(WAPTR),B'01000000'                            0286 00494000
         BO    @RT00286                                            0286 00495000
*         GOTO C14C0006;            /* SERVICE REQ                   */ 00496000
*       $TEP1ST='0'B;               /* SET 1ST TIME BIT OFF          */ 00497000
@RF00286 NI    $TEP1ST(WAPTR),B'11111101'                          0288 00498000
*     END;                                                         0289 00499000
*   SAVEDR2=$TFWDPTR;               /*                               */ 00500000
@RF00270 L     @11,$TFWDPTR(,WAPTR)                                0290 00501000
         ST    @11,SAVEDR2                                         0290 00502000
*   SVECC014(2)=$R13PTR;            /* IF NO RTN TO CALLE            */ 00503000
         L     @11,$R13PTR(,WAPTR)                                 0291 00504000
         ST    @11,SVECC014+4(,WAPTR)                              0291 00505000
*   RETURN;                         /* R13 IS PICKED UP FROM T.W.A &    00506000
*                                      USED TO RESTORE REGS & CONTROL*/ 00507000
         B     @EL00001                                            0292 00508000
*/********************************************************************/ 00509000
*                                                                  0293 00510000
*                                                                  0293 00511000
*/********************************************************************/ 00512000
*/*      ADD  1 TO BUSY COUNT  & TEST FOR EVERY BODY BUSY            */ 00513000
*/********************************************************************/ 00514000
*                                                                  0293 00515000
*C14C0004:                                                         0293 00516000
*   ;                               /*                               */ 00517000
C14C0004 DS    0H                                                  0294 00518000
*   BUSYCNT=BUSYCNT+1;              /* ADD 1 TO # TEST BUSY          */ 00519000
         LA    @11,1                                               0294 00520000
         AH    @11,BUSYCNT                                         0294 00521000
         STH   @11,BUSYCNT                                         0294 00522000
*   IF BUSYCNT<$USECNT              /* IF # BUSY IS LESS THAN        */ 00523000
*     THEN                          /* # OF USERS                    */ 00524000
         CH    @11,$USECNT(,RCAPTR)                                0295 00525000
         BL    @RT00295                                            0295 00526000
*     GOTO C14C0005;                /* GO ON WITH LOOP               */ 00527000
*   R1=5;                           /* SET THE NUMBER OF SECONDS TO     00528000
*                                      WAIT IF NOTING HAPPENS        */ 00529000
         LA    R1,5                                                0297 00530000
*   R13=SAVEDR13;                   /* USE ORIG AREA         @DA04678*/ 00531000
         L     R13,SAVEDR13                                        0298 00532000
*   CALL I00C0300;                  /* CALL RESIDENT MODULE TO SET 0299 00533000
*                                      TIMER                         */ 00534000
         L     @15,@CV01982                                        0299 00535000
         BALR  @14,@15                                             0299 00536000
*   R1=ADDR($TLTECB2);              /* PICK UP ADDRESS OF ECB        */ 00537000
         LA    R1,$TLTECB2(,RCAPTR)                                0300 00538000
*   CALL I00C1002;                  /* WAIT ON ECB           @D32JPPW*/ 00539000
         L     @15,@CV02009                                        0301 00540000
         BALR  @14,@15                                             0301 00541000
*   BUSYCNT=0;                      /* SET COUNT BACK TO ZERO        */ 00542000
         SLR   @11,@11                                             0302 00543000
         STH   @11,BUSYCNT                                         0302 00544000
*/********************************************************************/ 00545000
*                                                                  0303 00546000
*                                                                  0303 00547000
*/********************************************************************/ 00548000
*/*      GET NXT AREA PTR & LOOP                                     */ 00549000
*/********************************************************************/ 00550000
*                                                                  0303 00551000
*C14C0005:                                                         0303 00552000
*   ;                               /*                               */ 00553000
C14C0005 DS    0H                                                  0304 00554000
*   R4=$TFWDPTR;                    /* PICK UP NXT AREA PTR          */ 00555000
         L     R4,$TFWDPTR(,WAPTR)                                 0304 00556000
*   IF R4=0                         /* TEST FOR LAST TABLE ON        */ 00557000
*     THEN                          /* CHAIN FWD PTR=0               */ 00558000
         LTR   R4,R4                                               0305 00559000
         BZ    @RT00305                                            0305 00560000
*     GOTO C14C0001;                /* IF YES GO TO 1ST AREA         */ 00561000
*   R2=R4;                          /* IF NO SET R2 &                */ 00562000
         LR    R2,R4                                               0307 00563000
*   GOTO C14C0002;                  /* LOOP                          */ 00564000
         B     C14C0002                                            0308 00565000
*/********************************************************************/ 00566000
*/*       COMMUNICATION INTERVAL REQUESTED                           */ 00567000
*/********************************************************************/ 00568000
*                                                                  0309 00569000
*C14C0006:                                                         0309 00570000
*   ;                                                              0309 00571000
C14C0006 DS    0H                                                  0310 00572000
*   $CIREQ='0'B;                    /* RESET CIREQ BIT               */ 00573000
         NI    $CIREQ(WAPTR),B'11111110'                           0310 00574000
*   R13=ADDR(SVECC014(19));         /* GET NEW SAVE AREA             */ 00575000
         LA    R13,SVECC014+72(,WAPTR)                             0311 00576000
*   R14=ADDR(C14C0005);             /* SET RETURN POINT              */ 00577000
         LA    R14,C14C0005                                        0312 00578000
*   R15=ADDR(ISTIC002);             /* GET PTR TO CI MODULE          */ 00579000
         L     R15,@CV01974                                        0313 00580000
*   GEN(BR    R15);                                                0314 00581000
         BR    R15                                                      00582000
*C14C006A:                                                         0315 00583000
*   BUSYCNT=BUSYCNT-1;              /* REDUCE THE CURRENT BUSY COUNT    00584000
*                                                            @D32JPFR*/ 00585000
*                                                                  0315 00586000
C14C006A LH    @11,BUSYCNT                                         0315 00587000
         BCTR  @11,0                                               0315 00588000
         STH   @11,BUSYCNT                                         0315 00589000
*   /*****************************************************************/ 00590000
*   /*                                                               */ 00591000
*   /* ROUTINE TO SET RTN CODE AND REG 0 1 FROM TIME ROUTINES        */ 00592000
*   /*                                                               */ 00593000
*   /*****************************************************************/ 00594000
*                                                                  0316 00595000
*C14C0007:                                                         0316 00596000
*   ;                                                              0316 00597000
C14C0007 DS    0H                                                  0317 00598000
*   IF $TEP3RD='1'B                 /* IS THIS THIRD CALL            */ 00599000
*     THEN                                                         0317 00600000
         TM    $TEP3RD(WAPTR),B'10000000'                          0317 00601000
         BNO   @RF00317                                            0317 00602000
*     R4=$R13PR3;                   /* SET R4 WITH THIRD SAVE AREA   */ 00603000
         L     R4,$R13PR3(,WAPTR)                                  0318 00604000
*   ELSE                            /* IF NOT CHK FOR 2ND/1ST        */ 00605000
*     IF $TEP2ND='1'B               /* IS THIS 2ND CALL              */ 00606000
*       THEN                                                       0319 00607000
         B     @RC00317                                            0319 00608000
@RF00317 TM    $TEP2ND(WAPTR),B'00000001'                          0319 00609000
         BNO   @RF00319                                            0319 00610000
*       R4=$R13PTRT;                /* SET UP PTR TO SAVE AREA       */ 00611000
         L     R4,$R13PTRT(,WAPTR)                                 0320 00612000
*     ELSE                                                         0321 00613000
*       R4=$R13PTR;                                                0321 00614000
         B     @RC00319                                            0321 00615000
@RF00319 L     R4,$R13PTR(,WAPTR)                                  0321 00616000
*   GEN(ST    R15,L16(R4));         /* RESET REG IN SAVE AREA        */ 00617000
@RC00319 DS    0H                                                  0322 00618000
@RC00317 DS    0H                                                  0322 00619000
         ST    R15,L16(R4)                                              00620000
*   R14=ADDR(C14C0004);             /* RESET R14 TO ORIG RTN POINT   */ 00621000
         LA    R14,C14C0004                                        0323 00622000
*   GOTO C14C0004;                  /* RETURN AND CHECK $POSTFLG     */ 00623000
         B     C14C0004                                            0324 00624000
*                                                                  0325 00625000
*/********************************************************************/ 00626000
*/*      MACRO ROUTER  R1 HAS PTR TO INPUT PARM                      */ 00627000
*/********************************************************************/ 00628000
*                                                                  0325 00629000
*C14C0010:                                                         0325 00630000
*   ;                                                              0325 00631000
C14C0010 DS    0H                                                  0326 00632000
*   IF $TCECM='1'B                  /* TEST FOR SHORT FORM OF        */ 00633000
*     THEN                          /* CECUM-(TCEC MACRO)            */ 00634000
         TM    $TCECM(WAPTR),B'00000001'                           0326 00635000
         BNO   @RF00326                                            0326 00636000
*     DO;                           /* IF YES                        */ 00637000
*       R14=ADDR(C14C0014);         /* SET RTN POINT                 */ 00638000
         LA    R14,C14C0014                                        0328 00639000
*       R15=ADDR(ISTSC020);         /* SET PTR TO CECUM              */ 00640000
         L     R15,@CV01976                                        0329 00641000
*       GEN(BR    R15);             /* EXIT TO CECUM                 */ 00642000
         BR    R15                                                      00643000
*     END;                                                         0331 00644000
*                                                                  0331 00645000
*/********************************************************************/ 00646000
*/*      NORMAL MACRO CALL                                           */ 00647000
*/********************************************************************/ 00648000
*                                                                  0332 00649000
*   $MACID=IDVAL;                   /* SET ID FOR TRACE USE          */ 00650000
@RF00326 MVC   $MACID(2,WAPTR),IDVAL(R1)                           0332 00651000
*   IF LEVEL<2                      /* CHECK MACRO LEVEL FOR 0       */ 00652000
*     THEN                          /* OR 1 BOTH NOT SUPPORTED       */ 00653000
         CLI   LEVEL(R1),2                                         0333 00654000
         BL    @RT00333                                            0333 00655000
*     GOTO C14C0011;                /* IF LESS THAN 2 IS ERROR       */ 00656000
*   IF IDVAL(1:2)='40'              /* IS REQUESTED SERVICE $MODE    */ 00657000
*     THEN                          /* IF YES CANNOT RTN TO OLT      */ 00658000
         CLC   IDVAL(2,R1),@CC02018                                0335 00659000
         BE    @RT00335                                            0335 00660000
*     GOTO C14C0013;                /* MUST GOTO DTERM IMMEDIATLY    */ 00661000
*/********************************************************************/ 00662000
*/*      DO LOOP SEARCH SERVICE MACRO TABLE TO GIVE CONTROL TO ROUTN */ 00663000
*/********************************************************************/ 00664000
*                                                                  0337 00665000
*   R5=ADDR(MACRTBLE);              /* GET PTR TO TABLE              */ 00666000
         LA    R5,MACRTBLE                                         0337 00667000
*   DO I=1 TO 20 BY 1;                                             0338 00668000
         LA    @11,1                                               0338 00669000
         STH   @11,I                                               0338 00670000
@DL00338 DS    0H                                                  0339 00671000
*     IF IDVAL=SMID(I)              /* COMPARE INPUT ID TO TABLE     */ 00672000
*       THEN                        /* IF EQUAL GOTO INDICATED       */ 00673000
         SLA   @11,3                                               0339 00674000
         ST    @11,@TF00001                                        0339 00675000
         ALR   @11,R5                                              0339 00676000
         AL    @11,@CF02096                                        0339 00677000
         CLC   IDVAL(2,R1),SMID(@11)                               0339 00678000
         BNE   @RF00339                                            0339 00679000
*       DO;                         /* ROUTINE                       */ 00680000
*         IF SMLLEVL(I)>LEVEL       /* TEST LOW LIMIT                */ 00681000
*           THEN                    /* IF YES ERROR                  */ 00682000
         SLR   @11,@11                                             0341 00683000
         IC    @11,LEVEL(,R1)                                      0341 00684000
         L     @10,@TF00001                                        0341 00685000
         AL    @10,@CF02097                                        0341 00686000
         SLR   @09,@09                                             0341 00687000
         IC    @09,SMLLEVL-2(@10,R5)                               0341 00688000
         CR    @11,@09                                             0341 00689000
         BL    @RT00341                                            0341 00690000
*           GOTO C14C0011;                                         0342 00691000
*         IF LEVEL>SMHLEVL(I)       /* TEST HI LIMIT                 */ 00692000
*           THEN                    /* IF YES ERROR                  */ 00693000
         L     @10,@TF00001                                        0343 00694000
         AL    @10,@CF02098                                        0343 00695000
         SLR   @09,@09                                             0343 00696000
         IC    @09,SMHLEVL-3(@10,R5)                               0343 00697000
         CR    @11,@09                                             0343 00698000
         BH    @RT00343                                            0343 00699000
*           GOTO C14C0011;                                         0344 00700000
*         R14=ADDR(C14C0014);       /* SET RTN POINT                 */ 00701000
         LA    R14,C14C0014                                        0345 00702000
*         R15=SMPTR(I);             /* SET ENTRY PTR                 */ 00703000
         L     @11,@TF00001                                        0346 00704000
         AL    @11,@CF02099                                        0346 00705000
         L     R15,SMPTR-4(@11,R5)                                 0346 00706000
*         GEN(BR    R15);           /* GOTO SUBROUTINE               */ 00707000
         BR    R15                                                      00708000
*       END;                                                       0348 00709000
*   END;                            /* END OF DO LOOP                */ 00710000
@RF00339 LA    @11,1                                               0349 00711000
         AH    @11,I                                               0349 00712000
         STH   @11,I                                               0349 00713000
         C     @11,@CF00406                                        0349 00714000
         BNH   @DL00338                                            0349 00715000
*/********************************************************************/ 00716000
*/*      EXIT FROM LOOP IF MACRO NOT FOUND I.E. NOT SUPPORTED        */ 00717000
*/********************************************************************/ 00718000
*                                                                  0350 00719000
*C14C0011:                                                         0350 00720000
*   ;                                                              0350 00721000
C14C0011 DS    0H                                                  0351 00722000
*   R15=4;                          /* SET ERROR INDICATION          */ 00723000
         LA    R15,4                                               0351 00724000
*   GOTO C14C0014;                  /* FOR TRACE                     */ 00725000
         B     C14C0014                                            0352 00726000
*/********************************************************************/ 00727000
*/*     $MODE  MACRO ISSUED                                          */ 00728000
*/********************************************************************/ 00729000
*                                                                  0353 00730000
*C14C0013:                                                         0353 00731000
*   ;                                                              0353 00732000
C14C0013 DS    0H                                                  0354 00733000
*   R15=255;                        /* CODE FOR MODE                 */ 00734000
         LA    R15,255                                             0354 00735000
*/********************************************************************/ 00736000
*/*      EXIT                                                        */ 00737000
*/********************************************************************/ 00738000
*                                                                  0355 00739000
*C14C0014:                                                         0355 00740000
*   ;                                                              0355 00741000
C14C0014 DS    0H                                                  0356 00742000
*   IF $TEP3RD='1'B                 /* IS THIS THE THIRD CALL        */ 00743000
*     THEN                                                         0356 00744000
         TM    $TEP3RD(WAPTR),B'10000000'                          0356 00745000
         BNO   @RF00356                                            0356 00746000
*     R4=$R13PR3;                   /* YES SET R4                    */ 00747000
         L     R4,$R13PR3(,WAPTR)                                  0357 00748000
*   ELSE                            /* NO CHK FOR 2ND/1ST            */ 00749000
*     IF $TEP2ND='1'B               /* TEST FOR SECOND CALLER        */ 00750000
*       THEN                        /* IF YES PICK UP R13 FROM       */ 00751000
         B     @RC00356                                            0358 00752000
@RF00356 TM    $TEP2ND(WAPTR),B'00000001'                          0358 00753000
         BNO   @RF00358                                            0358 00754000
*       R4=$R13PTRT;                /* SPOT                          */ 00755000
         L     R4,$R13PTRT(,WAPTR)                                 0359 00756000
*     ELSE                          /* IF NO PICK UP R13 FROM        */ 00757000
*       R4=$R13PTR;                 /* NORMAL SPOT                   */ 00758000
         B     @RC00358                                            0360 00759000
@RF00358 L     R4,$R13PTR(,WAPTR)                                  0360 00760000
*   GEN(STM   R15,R1,L16(R4));      /* SAVE REGS                     */ 00761000
@RC00358 DS    0H                                                  0361 00762000
@RC00356 DS    0H                                                  0361 00763000
         STM   R15,R1,L16(R4)                                           00764000
*   GOTO C14C0005;                  /* RETURN TO REC MNGR            */ 00765000
         B     C14C0005                                            0362 00766000
*/********************************************************************/ 00767000
*/*      EXIT TO TRACE ROUTINE                                       */ 00768000
*/********************************************************************/ 00769000
*                                                                  0363 00770000
*C14C0015:                                                         0363 00771000
*   ;                               /*                               */ 00772000
C14C0015 DS    0H                                                  0364 00773000
*   R4=R14;                         /* SAVE RETURN ADDR              */ 00774000
         LR    R4,R14                                              0364 00775000
*   R5=R13;                         /* SAVE POINTER TO ORIG SAVE     */ 00776000
         LR    R5,R13                                              0365 00777000
*   R13=ADDR(SVECC014(19));         /* SET PTR TO SAVE AREA          */ 00778000
         LA    R13,SVECC014+72(,WAPTR)                             0366 00779000
*   R15=ADDR(ISTCC012);             /* SET POINTER TO TRACE          */ 00780000
         L     R15,@CV01978                                        0367 00781000
*   GEN(BALR  R14,R15);             /* BALR TO TRACE                 */ 00782000
         BALR  R14,R15                                                  00783000
*   R14=R4;                         /* RESET RETURN ADDR             */ 00784000
         LR    R14,R4                                              0369 00785000
*   R13=R5;                         /* RESET ORIG SAVE PTR           */ 00786000
         LR    R13,R5                                              0370 00787000
*   IF R0=0                         /* TEST RET FROM TRACE           */ 00788000
*     THEN                          /* IF 0 RET TO RESOURCE MNGR     */ 00789000
         LTR   R0,R0                                               0371 00790000
         BNZ   @RF00371                                            0371 00791000
*     GEN(BR    R14);               /* IF NOT 0 EXIT TO SCHED        */ 00792000
         BR    R14                                                      00793000
*   $OLTMACC='0'B;                  /* CLEAN UP ANY BITS SET         */ 00794000
@RF00371 DS    0H                                                  0374 00795000
*   $TEP1ST='0'B;                   /* SO AS NOT TO CONFUSE FLOW     */ 00796000
*   $TEP2ND='0'B;                   /* THROUGH RES MNGER             */ 00797000
         NI    $OLTMACC(WAPTR),B'11011100'                         0375 00798000
*   $TEP3RD='0'B;                                                  0376 00799000
         NI    $TEP3RD(WAPTR),B'01111111'                          0376 00800000
*   R15=ADDR(ISTCC010);             /*                               */ 00801000
         L     R15,@CV01971                                        0377 00802000
*   GEN(BR    R15);                 /*                               */ 00803000
         BR    R15                                                      00804000
*/********************************************************************/ 00805000
*                                                                  0379 00806000
*                                                                  0379 00807000
*/********************************************************************/ 00808000
*/*      LOGOFF (ENTRY WHEN CANCEL,LOGOFF,OR ABEND ENCOUNTERED       */ 00809000
*/********************************************************************/ 00810000
*                                                                  0379 00811000
*C14C0020:                                                         0379 00812000
*   ;                                                              0379 00813000
C14C0020 DS    0H                                                  0380 00814000
*   GEN;                                                           0380 00815000
         USING *,R15                                                    00816000
         L     R12,BASEREG              /* PICK UP SAVED BASE        */ 00817000
         DROP  R15                                                      00818000
*   R15=R13;                        /* SET UP SPECIAL SAVE           */ 00819000
         LR    R15,R13                                             0381 00820000
*   R13=ADDR(SVEIC002);             /* AND CHAIN THEM TOGETHER       */ 00821000
         LA    R13,SVEIC002(,WAPTR)                                0382 00822000
*   SVEIC002(2)=R15;                                               0383 00823000
         ST    R15,SVEIC002+4(,WAPTR)                              0383 00824000
*   BACKSAVE(3)=R13;                                               0384 00825000
         ST    R13,BACKSAVE+8(,R15)                                0384 00826000
*   $LOGOFFE='1'B;                  /* SET LOGOFF ENTERED BIT        */ 00827000
         OI    $LOGOFFE(WAPTR),B'00100000'                         0385 00828000
*   R3=$RCA;                        /* GET PTR TO R.C.A.             */ 00829000
         L     R3,$RCA(,WAPTR)                                     0386 00830000
*   $HOLD='0'B;                     /* RESET BIT TO CANCEL           */ 00831000
         NI    $HOLD(WAPTR),B'11111110'                            0387 00832000
*   $TEP1ST='0'B;                   /* THIS TEST IS OVER             */ 00833000
*   $TEP2ND='0'B;                                                  0389 00834000
         NI    $TEP1ST(WAPTR),B'11111100'                          0389 00835000
*   $TEP3RD='0'B;                                                  0390 00836000
         NI    $TEP3RD(WAPTR),B'01111111'                          0390 00837000
*   $REQSTOR='0'B;                  /* OLT ISSUED A DTERM            */ 00838000
         NI    $REQSTOR(WAPTR),B'11101111'                         0391 00839000
*   $ENDTEST='0'B;                  /*                               */ 00840000
         NI    $ENDTEST(WAPTR),B'11110111'                         0392 00841000
*   $OLTMACC='0'B;                  /*                               */ 00842000
         NI    $OLTMACC(WAPTR),B'11011111'                         0393 00843000
*   $ACTOPND='0'B;                                                 0394 00844000
*   $CLSSACT='0'B;                                                 0395 00845000
         NI    $ACTOPND(WAPTR),B'11111010'                         0395 00846000
*   $WAITFLG='0'B;                                                 0396 00847000
         NI    $WAITFLG(WAPTR),B'10111111'                         0396 00848000
*   $POSTFLG='0'B;                                                 0397 00849000
         NI    $POSTFLG(WAPTR),B'10111111'                         0397 00850000
*   $CIREQ='0'B;                    /*                               */ 00851000
         NI    $CIREQ(WAPTR),B'11111110'                           0398 00852000
*   $SNDRFLG='0'B;                  /* WAITING ON SEND        @DM0908*/ 00853000
*   $RCVRFLG='0'B;                  /* WAITING ON RECEIVE     @DM0908*/ 00854000
         NI    $SNDRFLG(WAPTR),B'11111001'                         0400 00855000
*   R15=ADDR(ISTTC035);             /* GO TO DTERM                   */ 00856000
         L     R15,@CV01977                                        0401 00857000
*   GEN(BALR  R14,R15);                                            0402 00858000
         BALR  R14,R15                                                  00859000
*   R1=R2;                          /* SET PTR TO VFRMAIN            */ 00860000
         LR    R1,R2                                               0403 00861000
*/*VFRMAIN  SIZE(34816)STORAGE((1))SUBPOOL(0)                        */ 00862000
*                                                                  0404 00863000
*   DO;                                                            0404 00864000
*     DO;                           /* CMZMREG (0) RESTRICT          */ 00865000
*       RFY                                                        0406 00866000
*        (GPR00P) RSTD;                                            0406 00867000
*     END;                          /* CMZMREG PUT VALUE PASSED AS 0407 00868000
*                                      SIZE PARM IN THREE LOW-ORDER     00869000
*                                      BYTES OF REG 0                */ 00870000
*     GPR00F=34816&'00FFFFFF'X;                                    0408 00871000
         L     GPR00F,@CF02030                                     0408 00872000
*     DO;                           /* CMZMREG (0,15) RESTRICT       */ 00873000
*       RFY                                                        0410 00874000
*        (GPR15P) RSTD;                                            0410 00875000
*     END;                          /* CMZMREG PUT SUBPOOL PARM IN 0411 00876000
*                                      HIGH- ORDER BYTE OF REG 15    */ 00877000
*     GPR15F=0;                                                    0412 00878000
         SLR   GPR15F,GPR15F                                       0412 00879000
*     SLL(GPR15P,24);               /* COMBINE SUBPOOL AND SIZE IN 0413 00880000
*                                      REGISTER 0                    */ 00881000
         SLL   GPR15P,24                                           0413 00882000
*     GPR00P=GPR00P|GPR15P;                                        0414 00883000
         OR    GPR00P,GPR15P                                       0414 00884000
*     DO;                           /* CMZMREG (0,15) RELEASE        */ 00885000
*       RFY                                                        0416 00886000
*        (GPR15P) UNRSTD;                                          0416 00887000
*     END;                          /* CMZMREG DECLARE AND RESTRICT     00888000
*                                      REG 1                         */ 00889000
*     DO;                           /* CMZMREG (1) RESTRICT          */ 00890000
*       RFY                                                        0419 00891000
*        (GPR01P) RSTD;                                            0419 00892000
*     END;                          /* CMZMREG INVOKE XREGSET MACRO     00893000
*                                      TO CHECK STORAGE PARM AND PUT    00894000
*                                      ADDR IN REGISTER 1            */ 00895000
*/*XREGSET  PID('STORAGE')PPARM((1))RREG(1,GPR01P)                   */ 00896000
*                                                                  0421 00897000
*     DO;                                                          0421 00898000
*                                                                  0421 00899000
*/*PARM ALREADY IN PROPER REGISTER                                   */ 00900000
*                                                                  0422 00901000
*     END;                          /* XREGSET INVOKE FREEMAIN MACRO */ 00902000
*     GEN;                                                         0423 00903000
         FREEMAIN R,LV=(0),A=(1)                                        00904000
*                                   /* UNRESTRICT REG 1              */ 00905000
*     DO;                           /* CMZMREG (1) RELEASE           */ 00906000
*       RFY                                                        0425 00907000
*        (GPR01P) UNRSTD;                                          0425 00908000
*     END;                          /* CMZMREG UNRESTRICT REG 0      */ 00909000
*     DO;                           /* CMZMREG (0) RELEASE           */ 00910000
*       RFY                                                        0428 00911000
*        (GPR00P) UNRSTD;                                          0428 00912000
*     END;                          /* CMZMREG                       */ 00913000
*   END;                            /* VFRMAIN                       */ 00914000
*   R2=$FSTAREA;                    /* GET PTR TO FIRST TWA          */ 00915000
         L     R2,$FSTAREA(,RCAPTR)                                0431 00916000
*   $USECNT=$USECNT-1;              /* DECREMENT NUMBER OF USERS     */ 00917000
         LH    @11,$USECNT(,RCAPTR)                                0432 00918000
         BCTR  @11,0                                               0432 00919000
         STH   @11,$USECNT(,RCAPTR)                                0432 00920000
*   IF R2=0                         /* ANY MORE WORK                 */ 00921000
*     THEN                          /* IF NO MORE USERS              */ 00922000
         SLR   @11,@11                                             0433 00923000
         CR    R2,@11                                              0433 00924000
         BNE   @RF00433                                            0433 00925000
*     DO;                           /* SET FIELDS IN RCA TO ZERO     */ 00926000
*       $USECNT=0;                  /* RESET NUMBER OF USERS         */ 00927000
         STH   @11,$USECNT(,RCAPTR)                                0435 00928000
*       $UPDATE='0'B;                                              0436 00929000
*       $CUTESTB='0'B;              /* INDICATE CUTEST HAS ENDED     */ 00930000
         NI    $UPDATE(RCAPTR),B'01101111'                         0437 00931000
*       $FSTAREA=0;                                                0438 00932000
         ST    @11,$FSTAREA(,RCAPTR)                               0438 00933000
*       $LSTAREA=0;                                                0439 00934000
         ST    @11,$LSTAREA(,RCAPTR)                               0439 00935000
*       $TOLTEP=0;                                                 0440 00936000
         ST    @11,$TOLTEP(,RCAPTR)                                0440 00937000
*       $ABEND=0;                                                  0441 00938000
         ST    @11,$ABEND(,RCAPTR)                                 0441 00939000
*       $CLEANP=0;                                                 0442 00940000
         ST    @11,$CLEANP(,RCAPTR)                                0442 00941000
*       R15=ADDR(I00C0005);                                        0443 00942000
         L     R15,@CV01979                                        0443 00943000
*       GEN(BR    R15);                                            0444 00944000
         BR    R15                                                      00945000
*     END;                                                         0445 00946000
*   ELSE                            /* IF MORE USERS                 */ 00947000
*     DO;                           /* SET UP TO LOOP BACK TO TOP    */ 00948000
         B     @RC00433                                            0446 00949000
@RF00433 DS    0H                                                  0447 00950000
*       R13=ADDR(SVECC014(1));      /* SET SAVE PTR                  */ 00951000
         LA    R13,SVECC014(,WAPTR)                                0447 00952000
*       GOTO C14C0001;                                             0448 00953000
         B     C14C0001                                            0448 00954000
*     END;                                                         0449 00955000
*                                                                  0449 00956000
*/********************************************************************/ 00957000
*                                                                  0450 00958000
*                                                                  0450 00959000
*/********************************************************************/ 00960000
*/*      GET STORAGE ROUTINE                                         */ 00961000
*/********************************************************************/ 00962000
*                                                                  0450 00963000
*C14C0030:                                                         0450 00964000
*   ;                                                              0450 00965000
@RC00433 DS    0H                                                  0450 00966000
C14C0030 DS    0H                                                  0451 00967000
*   GEN;                                                           0451 00968000
         USING *,R15                    /* SET BASE                  */ 00969000
         STM   R14,R12,L12(R13)         /* SAVE CALLERS REGS         */ 00970000
         L     R12,BASEREG              /* PICK UP BASE              */ 00971000
         DROP  R15                      /* DROP 15 BASE              */ 00972000
*   SVECC014(20)=R13;               /* SAVE SAVE PTR                 */ 00973000
         ST    R13,SVECC014+76(,WAPTR)                             0452 00974000
*   R13=ADDR(SVECC014(19));         /* SET R13 TO MY SAVE            */ 00975000
         LA    R13,SVECC014+72(,WAPTR)                             0453 00976000
*C14C0035:                                                         0454 00977000
*   ;                                                              0454 00978000
C14C0035 DS    0H                                                  0455 00979000
*   GEN(STM R0,R13,GTSTSAVE);                                      0455 00980000
         STM R0,R13,GTSTSAVE                                            00981000
*   DO;                             /* GETSTOR SIZE($RQSTSZE)TYPE(PAG   00982000
*                                      EABLE)ADSPACE(COMMON)KEY(VTAM)   00983000
*                                      FETCHP(NO)SAVE(NO)CLEAR(YES)  */ 00984000
*                                                                  0457 00985000
*/* ATBUILD (ISTPAB,ISTDYPAB,ISTATCVT,ISTRPH)                        */ 00986000
*/* END OF ATBUILD                                                   */ 00987000
*                                                                  0457 00988000
*     DO;                                                          0457 00989000
*     END;                                                         0458 00990000
*     DO;                                                          0459 00991000
*       RFY                                                        0460 00992000
*        (GPR00P,                                                  0460 00993000
*         GPR01P,                                                  0460 00994000
*         GPR02P,                                                  0460 00995000
*         GPR03P) RSTD;                                            0460 00996000
*     END;                                                         0461 00997000
*     GPR00F=$RQSTSZE;              /* SIZE IN REG0                  */ 00998000
         LH    GPR00F,$RQSTSZE(,WAPTR)                             0462 00999000
*     DCL                                                          0463 01000000
*       1 CMZA0031 FIXED(31) STATIC LOCAL,                         0463 01001000
*        2 * FIXED(8) INIT(32),     /* OPTION FLAGS                  */ 01002000
*        2 * FIXED(8) INIT(96),     /* STORAGE KEY                   */ 01003000
*        2 * FIXED(8) INIT(241),    /* SUBPOOL NUMBER                */ 01004000
*        2 * FIXED(8) INIT('00'X);  /* REQUEST TYPE                  */ 01005000
*     GPR03F=CMZA0031;                                             0464 01006000
         L     GPR03F,CMZA0031                                     0464 01007000
*     DO;                           /* LISATCVT                    0465 01008000
*                                      CVTBASE(PAGEABLE,(GPR02P))    */ 01009000
*       GPR02P=ATCLCPTR;            /* SET UP ATCVT POINTER          */ 01010000
         L     GPR02P,ATCLCPTR                                     0466 01011000
*     END;                          /* LISATCVT                      */ 01012000
*     CALL GPR02P->ATCGTSTR;        /* CALL ISTORFSR                 */ 01013000
         L     @15,ATCGTSTR(,GPR02P)                               0468 01014000
         BALR  @14,@15                                             0468 01015000
*     DO;                                                          0469 01016000
*       RFY                                                        0470 01017000
*        (GPR00P,                                                  0470 01018000
*         GPR01P,                                                  0470 01019000
*         GPR02P,                                                  0470 01020000
*         GPR03P) UNRSTD;                                          0470 01021000
*     END;                                                         0471 01022000
*   END;                            /* GETSTOR                       */ 01023000
*   R14=R3;                         /* SAVE PTR TO AREA              */ 01024000
         LR    R14,R3                                              0473 01025000
*   GEN(LM R0,R13,GTSTSAVE);                                       0474 01026000
         LM R0,R13,GTSTSAVE                                             01027000
*   $RQSTPTR=R14;                   /* STORE PTR AWAY                */ 01028000
         ST    R14,$RQSTPTR(,WAPTR)                                0475 01029000
*   IF R15=0                        /* CHK RETURN CODE               */ 01030000
*     THEN                          /* IF ZERO RESTORE REGS          */ 01031000
         LTR   R15,R15                                             0476 01032000
         BNZ   @RF00476                                            0476 01033000
*     DO;                           /* & RNT TO CALLER               */ 01034000
*       $REQSTOR='0'B;              /* PTR TO GOTTEN AREA IN         */ 01035000
         NI    $REQSTOR(WAPTR),B'11101111'                         0478 01036000
*       R13=SVECC014(20);           /* $RQSTPTR                      */ 01037000
         L     R13,SVECC014+76(,WAPTR)                             0479 01038000
*       GEN(LM    R14,R12,L12(R13));                               0480 01039000
         LM    R14,R12,L12(R13)                                         01040000
*       GEN(BR    R14);                                            0481 01041000
         BR    R14                                                      01042000
*     END;                                                         0482 01043000
*   ELSE                                                           0483 01044000
*     DO;                           /* IF NOT ZERO NO CORE AVAIL     */ 01045000
         B     @RC00476                                            0483 01046000
@RF00476 DS    0H                                                  0484 01047000
*       $REQSTOR='1'B;              /* SET BIT TO RETRY LATER        */ 01048000
         OI    $REQSTOR(WAPTR),B'00010000'                         0484 01049000
*       R3=$RCA;                    /* RESET R3                      */ 01050000
         L     R3,$RCA(,WAPTR)                                     0485 01051000
*       GOTO C14C0004;              /* GO TO LOOP                    */ 01052000
         B     C14C0004                                            0486 01053000
*     END;                                                         0487 01054000
*   GEN(EJECT);                                                    0488 01055000
@RC00476 DS    0H                                                  0488 01056000
         EJECT                                                          01057000
*                                                                  0489 01058000
*/********************************************************************/ 01059000
*/*      MACRO TABLE  PASSED ID  RELATED TO ADDR                     */ 01060000
*/********************************************************************/ 01061000
*                                                                  0489 01062000
*   GEN(DS    0D);                                                 0489 01063000
         DS    0D                                                       01064000
*MACRTBLE:                                                         0490 01065000
*   ;                                                              0490 01066000
MACRTBLE DS    0H                                                  0491 01067000
*   GEN;                                                           0491 01068000
*                                                                  0491 01069000
         DC    C'37'                                                    01070000
         DC    X'0202'                                                  01071000
         DC    V(ISTSC020)          MACRO CALL IS TO CECOM              01072000
         DC    C'41'                                                    01073000
         DC    X'0202'                                                  01074000
         DC    V(ISTSC021)          MACRO CALL IS TO CONVERT            01075000
         DC    C'AJ'                                                    01076000
         DC    X'0202'                                                  01077000
         DC    V(ISTSC022)          MACRO CALL IS TO $CUTEST            01078000
         DC    C'AA'                                                    01079000
         DC    X'0202'                                                  01080000
         DC    V(ISTSC023)          MACRO CALL IS TO DDATE              01081000
         DC    C'39'                                                    01082000
         DC    X'0202'                                                  01083000
         DC    V(ISTSC024)          MACRO CALL IS TO DPRINT             01084000
         DC    C'AB'                                                    01085000
         DC    X'0202'                                                  01086000
         DC    V(ISTSC026)          MACRO CALL IS TO DTIME              01087000
         DC    C'35'                                                    01088000
         DC    X'0203'                                                  01089000
         DC    V(ISTSC027)          MACRO CALL IS TO EXIO               01090000
         DC    C'43'                                                    01091000
         DC    X'0202'                                                  01092000
         DC    V(ISTSC028)          MACRO CALL IS TO FREECORE           01093000
         DC    C'16'                                                    01094000
         DC    X'0202'                                                  01095000
         DC    V(ISTSC029)          MACRO CALL IS TO GETCONFG           01096000
         DC    C'21'                                                    01097000
         DC    X'0202'                                                  01098000
         DC    V(ISTSC02A)          MACRO CALL IS TO GRAB               01099000
         DC    C'AC'                                                    01100000
         DC    X'0202'                                                  01101000
         DC    V(ISTSC02B)          MACRO CALL IS TO LETGO              01102000
         DC    C'42'                                                    01103000
         DC    X'0203'                                                  01104000
         DC    V(ISTSC02C)          MACRO CALL IS TO MORECORE           01105000
         DC    C'28'                                                    01106000
         DC    X'0202'                                                  01107000
         DC    V(ISTSC02D)          MACRO CALL IS TO PLINK              01108000
         DC    C'47'                                                    01109000
         DC    X'0202'                                                  01110000
         DC    V(ISTSC02E)          MACRO CALL IS TO ROUTINE            01111000
         DC    C'36'                                                    01112000
         DC    X'0203'                                                  01113000
         DC    V(ISTSC02F)          MACRO CALL IS TO WAITIO             01114000
         DC    C'30'                                                    01115000
         DC    X'0202'                                                  01116000
         DC    V(S30C0010)          MACRO CALL IS TO ACQUIRE            01117000
         DC    C'44'                                                    01118000
         DC    X'0202'                                                  01119000
         DC    V(ISTSC032)          MACRO CALL IS TO DIO                01120000
         DC    C'31'                                                    01121000
         DC    X'0202'                                                  01122000
         DC    V(ISTSC031)          MACRO CALL TO RELEASE               01123000
         DC    C'25'                                           @D32JPFR 01124000
         DC    X'0202'                                         @D32JPFR 01125000
         DC    V(ISTSC025)          MACRO CALL TO SEND         @D32JPFR 01126000
         DC    C'33'                                           @D32JPFR 01127000
         DC    X'0202'                                         @D32JPFR 01128000
         DC    V(ISTSC025)          MACRO CALL TO RECEIVE      @D32JPFR 01129000
*/********************************************************************/ 01130000
*                                                                  0492 01131000
*   DO;                             /* TPEPILOG                      */ 01132000
*     GEN(PRINT OFF);                                              0493 01133000
         PRINT OFF                                                      01134000
*     DO;                                                          0494 01135000
*       DCL                                                        0495 01136000
*         GPR00F FIXED(31) REG(00),                                0495 01137000
*         GPR00P PTR(31) REG(00),                                  0495 01138000
*         GPR01F FIXED(31) REG(01),                                0495 01139000
*         GPR01P PTR(31) REG(01),                                  0495 01140000
*         GPR02F FIXED(31) REG(02),                                0495 01141000
*         GPR02P PTR(31) REG(02),                                  0495 01142000
*         GPR03F FIXED(31) REG(03),                                0495 01143000
*         GPR03P PTR(31) REG(03),                                  0495 01144000
*         GPR04F FIXED(31) REG(04),                                0495 01145000
*         GPR04P PTR(31) REG(04),                                  0495 01146000
*         GPR05F FIXED(31) REG(05),                                0495 01147000
*         GPR05P PTR(31) REG(05),                                  0495 01148000
*         GPR06F FIXED(31) REG(06),                                0495 01149000
*         GPR06P PTR(31) REG(06),                                  0495 01150000
*         GPR07F FIXED(31) REG(07),                                0495 01151000
*         GPR07P PTR(31) REG(07),                                  0495 01152000
*         GPR08F FIXED(31) REG(08),                                0495 01153000
*         GPR08P PTR(31) REG(08),                                  0495 01154000
*         GPR09F FIXED(31) REG(09),                                0495 01155000
*         GPR09P PTR(31) REG(09),                                  0495 01156000
*         GPR10F FIXED(31) REG(10),                                0495 01157000
*         GPR10P PTR(31) REG(10),                                  0495 01158000
*         GPR11F FIXED(31) REG(11),                                0495 01159000
*         GPR11P PTR(31) REG(11),                                  0495 01160000
*         GPR12F FIXED(31) REG(12),                                0495 01161000
*         GPR12P PTR(31) REG(12),                                  0495 01162000
*         GPR13F FIXED(31) REG(13),                                0495 01163000
*         GPR13P PTR(31) REG(13),                                  0495 01164000
*         GPR14F FIXED(31) REG(14),                                0495 01165000
*         GPR14P PTR(31) REG(14),                                  0495 01166000
*         GPR15F FIXED(31) REG(15),                                0495 01167000
*         GPR15P PTR(31) REG(15);                                  0495 01168000
*     END;                                                         0496 01169000
*     GEN(PRINT ON);                                               0497 01170000
         PRINT ON                                                       01171000
*   END;                            /* TPEPILOG                      */ 01172000
*   DO;                             /* ATDSPLY                       */ 01173000
*   END;                            /* ATDSPLY                       */ 01174000
*   END                                                            0501 01175000
*                                                                  0501 01176000
*/* THE FOLLOWING INCLUDE STATEMENTS WERE FOUND IN THIS PROGRAM.     */ 01177000
*/*%INCLUDE SYSLIB  (CVT     )                                       */ 01178000
*                                                                  0501 01179000
*       ;                                                          0501 01180000
         B     @EL00001                                            0501 01181000
@DATA    DS    0H                                                       01182000
@CH00404 DC    H'68'                                                    01183000
         DS    0F                                                       01184000
@SA00001 DS    18F                                                      01185000
@TF00001 DS    F                                                        01186000
         DS    0F                                                       01187000
@CF00101 DC    F'1'                                                     01188000
@CF00406 DC    F'20'                                                    01189000
@CF02030 DC    F'34816'                                                 01190000
@CF02096 DC    F'-8'                                                    01191000
@CF02097 DC    F'-6'                                                    01192000
@CF02098 DC    F'-5'                                                    01193000
@CF02099 DC    F'-4'                                                    01194000
@CV01971 DC    V(ISTCC010)                                              01195000
@CV01972 DC    V(ISTCC011)                                              01196000
@CV01973 DC    V(I00C0070)                                              01197000
@CV01974 DC    V(ISTIC002)                                              01198000
@CV01975 DC    V(S2FC1000)                                              01199000
@CV01976 DC    V(ISTSC020)                                              01200000
@CV01977 DC    V(ISTTC035)                                              01201000
@CV01978 DC    V(ISTCC012)                                              01202000
@CV01979 DC    V(I00C0005)                                              01203000
@CV01980 DC    V(S30C1000)                                              01204000
@CV01981 DC    V(S31C0480)                                              01205000
@CV01982 DC    V(I00C0300)                                              01206000
@CV01983 DC    V(ISTSC025)                                              01207000
@CV01984 DC    V(ISTSC033)                                              01208000
@CV01985 DC    V(ISTSC027)                                              01209000
@CV02009 DC    V(I00C1002)                                              01210000
         DS    0D                                                       01211000
BASEREG  DC    F'0'                                                     01212000
SAVEDR2  DC    F'0'                                                     01213000
SAVEDR13 DC    F'0'                                                     01214000
CMZA0031 DS    FL4                                                      01215000
         ORG   CMZA0031                                                 01216000
@NM00112 DC    AL1(32)                                                  01217000
@NM00113 DC    AL1(96)                                                  01218000
@NM00114 DC    AL1(241)                                                 01219000
@NM00115 DC    XL1'00'                                                  01220000
         ORG   CMZA0031+4                                               01221000
BUSYCNT  DC    H'0'                                                     01222000
I        DC    H'0'                                                     01223000
X        DC    H'0'                                                     01224000
@CC02018 DC    C'40'                                                    01225000
PATCH    DC    40F'0'                                                   01226000
GTSTSAVE DS    14F                                                      01227000
@00      EQU   00                      EQUATES FOR REGISTERS 0-15       01228000
@01      EQU   01                                                       01229000
@02      EQU   02                                                       01230000
@03      EQU   03                                                       01231000
@04      EQU   04                                                       01232000
@05      EQU   05                                                       01233000
@06      EQU   06                                                       01234000
@07      EQU   07                                                       01235000
@08      EQU   08                                                       01236000
@09      EQU   09                                                       01237000
@10      EQU   10                                                       01238000
@11      EQU   11                                                       01239000
@12      EQU   12                                                       01240000
@13      EQU   13                                                       01241000
@14      EQU   14                                                       01242000
@15      EQU   15                                                       01243000
J        EQU   @10                                                      01244000
RCAPTR   EQU   @03                                                      01245000
R0       EQU   @00                                                      01246000
R1       EQU   @01                                                      01247000
R2       EQU   @02                                                      01248000
R3       EQU   @03                                                      01249000
R4       EQU   @04                                                      01250000
R5       EQU   @05                                                      01251000
R12      EQU   @12                                                      01252000
R13      EQU   @13                                                      01253000
R14      EQU   @14                                                      01254000
R15      EQU   @15                                                      01255000
WAPTR    EQU   @02                                                      01256000
RPHPTR   EQU   @01                                                      01257000
GPR00P   EQU   @00                                                      01258000
GPR00F   EQU   @00                                                      01259000
GPR15P   EQU   @15                                                      01260000
GPR15F   EQU   @15                                                      01261000
GPR01P   EQU   @01                                                      01262000
GPR02P   EQU   @02                                                      01263000
GPR03P   EQU   @03                                                      01264000
GPR03F   EQU   @03                                                      01265000
GPR01F   EQU   @01                                                      01266000
GPR02F   EQU   @02                                                      01267000
GPR04F   EQU   @04                                                      01268000
GPR04P   EQU   @04                                                      01269000
GPR05F   EQU   @05                                                      01270000
GPR05P   EQU   @05                                                      01271000
GPR06F   EQU   @06                                                      01272000
GPR06P   EQU   @06                                                      01273000
GPR07F   EQU   @07                                                      01274000
GPR07P   EQU   @07                                                      01275000
GPR08F   EQU   @08                                                      01276000
GPR08P   EQU   @08                                                      01277000
GPR09F   EQU   @09                                                      01278000
GPR09P   EQU   @09                                                      01279000
GPR10F   EQU   @10                                                      01280000
GPR10P   EQU   @10                                                      01281000
GPR11F   EQU   @11                                                      01282000
GPR11P   EQU   @11                                                      01283000
GPR12F   EQU   @12                                                      01284000
GPR12P   EQU   @12                                                      01285000
GPR13F   EQU   @13                                                      01286000
GPR13P   EQU   @13                                                      01287000
GPR14F   EQU   @14                                                      01288000
GPR14P   EQU   @14                                                      01289000
R10      EQU   @10                                                      01290000
R11      EQU   @11                                                      01291000
R6       EQU   @06                                                      01292000
R7       EQU   @07                                                      01293000
R8       EQU   @08                                                      01294000
R9       EQU   @09                                                      01295000
         ENTRY C14C0020                                                 01296000
         ENTRY C14C0030                                                 01297000
ATCLCPTR EQU   1032                                                     01298000
$RCAAREA EQU   0                                                        01299000
$POINTER EQU   $RCAAREA+100                                             01300000
$TOLTEP  EQU   $POINTER                                                 01301000
$FSTAREA EQU   $POINTER+8                                               01302000
$LSTAREA EQU   $POINTER+12                                              01303000
$ABEND   EQU   $POINTER+16                                              01304000
$CLEANP  EQU   $POINTER+20                                              01305000
$TLTECB2 EQU   $POINTER+28                                              01306000
$TRTBLA  EQU   $POINTER+124                                             01307000
$CURRTWA EQU   $POINTER+140                                             01308000
$CONSTNT EQU   $RCAAREA+244                                             01309000
$USECNT  EQU   $CONSTNT                                                 01310000
$RCAFLG  EQU   $RCAAREA+604                                             01311000
$UPDATE  EQU   $RCAFLG                                                  01312000
$CUTESTB EQU   $RCAFLG                                                  01313000
TOLTEPWA EQU   0                                                        01314000
$SCTTBLE EQU   TOLTEPWA                                                 01315000
$TESTOPT EQU   $SCTTBLE+2                                               01316000
$ERROPT  EQU   $SCTTBLE+3                                               01317000
$PDEVFLG EQU   $SCTTBLE+10                                              01318000
$CDSFLGS EQU   $SCTTBLE+11                                              01319000
$CDS8T19 EQU   $SCTTBLE+20                                              01320000
$EXECFLG EQU   $SCTTBLE+33                                              01321000
$CLEANUP EQU   $EXECFLG                                                 01322000
$OLTFLGS EQU   $SCTTBLE+36                                              01323000
$OLTFLG2 EQU   $SCTTBLE+37                                              01324000
$TOTFLG1 EQU   $SCTTBLE+38                                              01325000
$ROUTMSK EQU   $SCTTBLE+40                                              01326000
$CDA     EQU   TOLTEPWA+100                                             01327000
$TFWDPTR EQU   $CDA+8                                                   01328000
$RCA     EQU   $CDA+44                                                  01329000
$OLTPTR  EQU   $CDA+52                                                  01330000
$HIMOREC EQU   $CDA+60                                                  01331000
$R13PTR  EQU   $CDA+80                                                  01332000
$R13PTRT EQU   $CDA+84                                                  01333000
$COMMFLG EQU   TOLTEPWA+224                                             01334000
$FLAG1   EQU   $COMMFLG                                                 01335000
$TEP3RD  EQU   $FLAG1                                                   01336000
$OLTACT  EQU   $FLAG1                                                   01337000
$FLAG2   EQU   $COMMFLG+1                                               01338000
$FLAG3   EQU   $COMMFLG+2                                               01339000
$LOGOFFE EQU   $FLAG3                                                   01340000
$REQSTOR EQU   $FLAG3                                                   01341000
$PRTONLY EQU   $FLAG3                                                   01342000
$FLAG4   EQU   $COMMFLG+3                                               01343000
$CLSSACT EQU   $FLAG4                                                   01344000
$ACTOPND EQU   $FLAG4                                                   01345000
$FLAG5   EQU   $COMMFLG+4                                               01346000
$EOJ     EQU   $FLAG5                                                   01347000
$CANCEL  EQU   $EOJ                                                     01348000
$FLAG6   EQU   $COMMFLG+5                                               01349000
$RECAL11 EQU   $FLAG6                                                   01350000
$ABNDBIT EQU   $FLAG6                                                   01351000
$ABTERM  EQU   $ABNDBIT                                                 01352000
$CIREQ   EQU   $FLAG6                                                   01353000
$FLAG7   EQU   $COMMFLG+6                                               01354000
$EXIOWAT EQU   $FLAG7                                                   01355000
$SNDRFLG EQU   $FLAG7                                                   01356000
$RCVRFLG EQU   $FLAG7                                                   01357000
$FLAG8   EQU   $COMMFLG+7                                               01358000
$TWOWAY  EQU   $FLAG8                                                   01359000
$TCECM   EQU   $FLAG8                                                   01360000
$FLAG9   EQU   $COMMFLG+8                                               01361000
$NOTRRCH EQU   $FLAG9                                                   01362000
$HOLD    EQU   $FLAG9                                                   01363000
$FLAG10  EQU   $COMMFLG+9                                               01364000
$WAITFLG EQU   $FLAG10                                                  01365000
$INBND   EQU   $FLAG10                                                  01366000
$FLAG11  EQU   $COMMFLG+10                                              01367000
$FLAG12  EQU   $COMMFLG+11                                              01368000
$POSTFLG EQU   $FLAG12                                                  01369000
$ENDTEST EQU   $FLAG12                                                  01370000
$VARYINP EQU   $FLAG12                                                  01371000
$FLAG13  EQU   $COMMFLG+12                                              01372000
$LGON    EQU   $FLAG13                                                  01373000
$OLTMACC EQU   $FLAG13                                                  01374000
$TEP1ST  EQU   $FLAG13                                                  01375000
$TEP2ND  EQU   $FLAG13                                                  01376000
$DEVTBLE EQU   TOLTEPWA+240                                             01377000
$DEVCDS  EQU   $DEVTBLE                                                 01378000
$DEVUNAD EQU   $DEVCDS                                                  01379000
@NM00039 EQU   $DEVUNAD+2                                               01380000
$DEVFEAT EQU   $DEVCDS+4                                                01381000
$DEVCDSF EQU   $DEVCDS+9                                                01382000
$DEVSDCF EQU   $DEVCDS+10                                               01383000
$$SYMNME EQU   $DEVCDS+12                                               01384000
$DEVFLG1 EQU   $DEVTBLE+20                                              01385000
$EVNCPLT EQU   $DEVFLG1                                                 01386000
$ATTNEXP EQU   $DEVFLG1                                                 01387000
$INTOCC  EQU   $DEVFLG1                                                 01388000
$DEVFLG2 EQU   $DEVTBLE+21                                              01389000
$TESTMDE EQU   $DEVFLG2                                                 01390000
$DEVTECB EQU   $DEVTBLE+22                                              01391000
$OPIS    EQU   $DEVTECB                                                 01392000
$OPND    EQU   $DEVTECB+2                                               01393000
$DEVFLG3 EQU   $DEVTBLE+27                                              01394000
$SIOFLG  EQU   $DEVFLG3                                                 01395000
$IFTOUT  EQU   $DEVTBLE+36                                              01396000
$DEVSESP EQU   $IFTOUT                                                  01397000
$SSCPDAF EQU   $IFTOUT+6                                                01398000
$LDNCBPT EQU   $DEVTBLE+48                                              01399000
$RNINFO  EQU   $DEVTBLE+56                                              01400000
$LINENME EQU   $RNINFO                                                  01401000
$DEVFLG5 EQU   $RNINFO+8                                                01402000
$DEVFLG4 EQU   $DEVTBLE+65                                              01403000
$DEVCNTS EQU   TOLTEPWA+1464                                            01404000
$SLTBL   EQU   TOLTEPWA+1468                                            01405000
$RUNTEST EQU   $SLTBL+13                                                01406000
$TESTFLG EQU   $SLTBL+21                                                01407000
$SECLST  EQU   $SLTBL+22                                                01408000
#EXITA   EQU   TOLTEPWA+2632                                            01409000
$CCOMDAT EQU   TOLTEPWA+2644                                            01410000
$COUTAD  EQU   $CCOMDAT                                                 01411000
$COUTCT  EQU   $CCOMDAT+4                                               01412000
$CINADR  EQU   $CCOMDAT+8                                               01413000
$CINCT   EQU   $CCOMDAT+12                                              01414000
$CFLGS   EQU   $CCOMDAT+16                                              01415000
$C2WAY   EQU   $CFLGS                                                   01416000
$MACID   EQU   TOLTEPWA+2661                                            01417000
$24FEMSG EQU   TOLTEPWA+2681                                            01418000
$24CATMG EQU   $24FEMSG+11                                              01419000
@NM00048 EQU   TOLTEPWA+2776                                            01420000
$OUNTPTR EQU   @NM00048+4                                               01421000
$NSPTR   EQU   $OUNTPTR                                                 01422000
$NSCNT   EQU   @NM00048+10                                              01423000
$ENXX    EQU   @NM00048+15                                              01424000
$IMITX   EQU   $ENXX                                                    01425000
$RQSTPTR EQU   TOLTEPWA+2808                                            01426000
$RQSTSZE EQU   TOLTEPWA+2812                                            01427000
$R13PR3  EQU   TOLTEPWA+2972                                            01428000
SVESC033 EQU   TOLTEPWA+3160                                            01429000
SVECC013 EQU   TOLTEPWA+3232                                            01430000
SVECC014 EQU   TOLTEPWA+3376                                            01431000
SVEIC002 EQU   TOLTEPWA+3520                                            01432000
SVEIC003 EQU   TOLTEPWA+3592                                            01433000
SVESC022 EQU   TOLTEPWA+3736                                            01434000
SVECC011 EQU   TOLTEPWA+4024                                            01435000
ISTAVT   EQU   0                                                        01436000
ISTRETRG EQU   ISTAVT+44                                                01437000
ISTLOK   EQU   0                                                        01438000
LOKCHN   EQU   ISTLOK+1                                                 01439000
LOKCHNG  EQU   LOKCHN                                                   01440000
@NM00052 EQU   LOKCHNG+2                                                01441000
ISTPAB   EQU   0                                                        01442000
PABWQCHN EQU   ISTPAB                                                   01443000
PABWEQA  EQU   PABWQCHN                                                 01444000
PABCHAIN EQU   PABWQCHN+4                                               01445000
PABRUNNG EQU   PABCHAIN                                                 01446000
PABRPHFG EQU   ISTPAB+12                                                01447000
PABFLAGS EQU   PABRPHFG                                                 01448000
PABERLCK EQU   PABFLAGS                                                 01449000
PABERRLK EQU   PABERLCK                                                 01450000
PABEND   EQU   ISTPAB+16                                                01451000
ISTDYPAB EQU   0                                                        01452000
DYPCHAIN EQU   ISTDYPAB+4                                               01453000
DYPPACMD EQU   ISTDYPAB+12                                              01454000
ISTRPH   EQU   0                                                        01455000
RPHCNTL  EQU   ISTRPH                                                   01456000
RPHFLAGS EQU   RPHCNTL+2                                                01457000
RPHFSTLC EQU   RPHFLAGS                                                 01458000
RPHFLGB  EQU   RPHCNTL+3                                                01459000
RPHRPHA  EQU   ISTRPH+4                                                 01460000
RPHTSKID EQU   ISTRPH+8                                                 01461000
RPHRESMA EQU   ISTRPH+16                                                01462000
RPHWPFLG EQU   RPHRESMA                                                 01463000
RPHWEA   EQU   ISTRPH+24                                                01464000
RPHCSPA  EQU   RPHWEA                                                   01465000
RPHSRPRM EQU   ISTRPH+28                                                01466000
RPHPABQA EQU   ISTRPH+36                                                01467000
RPHWORK  EQU   ISTRPH+40                                                01468000
RPHSAVE1 EQU   RPHWORK                                                  01469000
RPHSBITS EQU   RPHSAVE1+1                                               01470000
ISTATCVT EQU   0                                                        01471000
ATCRPTCH EQU   ISTATCVT                                                 01472000
ATCITFLD EQU   ISTATCVT+8                                               01473000
ATCITCDS EQU   ATCITFLD+8                                               01474000
ATCITFLG EQU   ATCITCDS+4                                               01475000
ATCITRA1 EQU   ATCITFLG+2                                               01476000
ATCSMPAB EQU   ISTATCVT+88                                              01477000
ATCVDPAB EQU   ISTATCVT+152                                             01478000
ATCLDTIL EQU   ISTATCVT+408                                             01479000
ATCGTSTR EQU   ISTATCVT+608                                             01480000
ATCLUDVT EQU   ISTATCVT+768                                             01481000
ATCANYDT EQU   ISTATCVT+776                                             01482000
@NM00062 EQU   ISTATCVT+780                                             01483000
ATCPODVT EQU   ISTATCVT+804                                             01484000
ATCSTAT  EQU   ISTATCVT+936                                             01485000
ATCSTAT1 EQU   ATCSTAT                                                  01486000
ATCPOFLG EQU   ATCSTAT+2                                                01487000
ATCSTAT4 EQU   ATCSTAT+3                                                01488000
ATCMTST  EQU   ATCSTAT4                                                 01489000
ATCBITAN EQU   ISTATCVT+940                                             01490000
ATCFLAG2 EQU   ATCBITAN+1                                               01491000
ATCONID  EQU   ISTATCVT+944                                             01492000
ATCSSCPA EQU   ISTATCVT+948                                             01493000
ATCECTLP EQU   ISTATCVT+1000                                            01494000
ATCHPGM  EQU   ISTATCVT+1012                                            01495000
ATCVLCNT EQU   ISTATCVT+1016                                            01496000
ATCRNO   EQU   ISTATCVT+1020                                            01497000
@NM00085 EQU   ISTATCVT+1028                                            01498000
ATCSHRFG EQU   @NM00085+8                                               01499000
ATCCPDVT EQU   ISTATCVT+1096                                            01500000
ATCSMSDQ EQU   ISTATCVT+1140                                            01501000
ATCRID   EQU   ISTATCVT+1152                                            01502000
ATCLDAPP EQU   ISTATCVT+1288                                            01503000
ATCSQAFR EQU   ISTATCVT+1312                                            01504000
ATCORTCB EQU   ATCSQAFR+4                                               01505000
ATCORSRB EQU   ATCORTCB                                                 01506000
ATCICAPP EQU   ISTATCVT+1320                                            01507000
ATCDAPVT EQU   ISTATCVT+1340                                            01508000
ATCGSRBQ EQU   ISTATCVT+1472                                            01509000
ATCGSRBG EQU   ATCGSRBQ                                                 01510000
ATCENFLG EQU   ISTATCVT+1512                                            01511000
@NM00100 EQU   ISTATCVT+1575                                            01512000
ATCVTFLG EQU   ISTATCVT+1576                                            01513000
ATCZFLAG EQU   ISTATCVT+1696                                            01514000
ATCCRA   EQU   ISTATCVT+1720                                            01515000
ATCCRACN EQU   ATCCRA+4                                                 01516000
ATCSRB   EQU   ISTATCVT+1728                                            01517000
ATCSRBCN EQU   ATCSRB+4                                                 01518000
ATCCRPL  EQU   ISTATCVT+1736                                            01519000
ATCRPLCN EQU   ATCCRPL+4                                                01520000
CVTMAP   EQU   0                                                        01521000
CVTDAR   EQU   CVTMAP+72                                                01522000
CVTFLGS1 EQU   CVTDAR                                                   01523000
CVTDCB   EQU   CVTMAP+116                                               01524000
CVTIERLC EQU   CVTMAP+144                                               01525000
CVTOPTA  EQU   CVTMAP+182                                               01526000
CVTOPTB  EQU   CVTMAP+183                                               01527000
CVTGTF   EQU   CVTMAP+236                                               01528000
CVTGTFST EQU   CVTGTF                                                   01529000
CVTGTFS  EQU   CVTGTFST                                                 01530000
CVTSTATE EQU   CVTGTFST                                                 01531000
CVTTMODE EQU   CVTGTFST                                                 01532000
CVTFORM  EQU   CVTGTFST                                                 01533000
CVTAQAVT EQU   CVTMAP+240                                               01534000
CVTTCMFG EQU   CVTAQAVT                                                 01535000
CVTVOLM2 EQU   CVTMAP+244                                               01536000
CVTTATA  EQU   CVTVOLM2                                                 01537000
CVTTSKS  EQU   CVTTATA                                                  01538000
CVTVOLF2 EQU   CVTTSKS                                                  01539000
CVTTAT   EQU   CVTTATA+1                                                01540000
CVTATER  EQU   CVTMAP+248                                               01541000
CVTEXT1  EQU   CVTMAP+252                                               01542000
CVTPURG  EQU   CVTMAP+260                                               01543000
CVTQMSG  EQU   CVTMAP+268                                               01544000
CVTDMSR  EQU   CVTMAP+272                                               01545000
CVTRSV37 EQU   CVTDMSR                                                  01546000
CVTDMSRF EQU   CVTRSV37                                                 01547000
CVTERPV  EQU   CVTMAP+316                                               01548000
CVTINTLA EQU   CVTMAP+320                                               01549000
CVTAPF   EQU   CVTMAP+324                                               01550000
CVTEXT2  EQU   CVTMAP+328                                               01551000
CVTHJES  EQU   CVTMAP+332                                               01552000
CVTPGSIA EQU   CVTMAP+348                                               01553000
CVTA1F1  EQU   CVTMAP+356                                               01554000
CVTSYSK  EQU   CVTMAP+357                                               01555000
CVTVOLM1 EQU   CVTMAP+380                                               01556000
CVTVOLF1 EQU   CVTVOLM1                                                 01557000
CVTXTNT1 EQU   0                                                        01558000
CVTXTNT2 EQU   0                                                        01559000
CVTDSSV  EQU   CVTXTNT2                                                 01560000
CVTFLGBT EQU   CVTXTNT2+5                                               01561000
CVTQID   EQU   CVTXTNT2+24                                              01562000
CVTRV400 EQU   CVTXTNT2+52                                              01563000
CVTRV409 EQU   CVTXTNT2+53                                              01564000
CVTATCVT EQU   CVTXTNT2+64                                              01565000
CVTRV429 EQU   CVTXTNT2+84                                              01566000
CVTRV438 EQU   CVTXTNT2+85                                              01567000
CVTRV457 EQU   CVTXTNT2+112                                             01568000
CVTRV466 EQU   CVTXTNT2+113                                             01569000
CVTFIX   EQU   0                                                        01570000
CVTRELNO EQU   CVTFIX+252                                               01571000
INPARM   EQU   0                                                        01572000
FLAGS    EQU   INPARM                                                   01573000
LEVEL    EQU   INPARM+1                                                 01574000
IDVAL    EQU   INPARM+2                                                 01575000
SMVECTOR EQU   0                                                        01576000
SMID     EQU   SMVECTOR                                                 01577000
SMLLEVL  EQU   SMVECTOR+2                                               01578000
SMHLEVL  EQU   SMVECTOR+3                                               01579000
SMPTR    EQU   SMVECTOR+4                                               01580000
BACKSAVE EQU   0                                                        01581000
REPLYSZE EQU   0                                                        01582000
$TRTBL   EQU   0                                                        01583000
#EXIT    EQU   0                                                        01584000
ISTXDYP  EQU   0                                                        01585000
ISTXPAB  EQU   0                                                        01586000
PABXTNSN EQU   PABEND                                                   01587000
CVTS01   EQU   CVTPGSIA                                                 01588000
CVTLPDIA EQU   CVTS01+12                                                01589000
CVTDIRST EQU   CVTLPDIA                                                 01590000
CVTSLIDA EQU   CVTS01+24                                                01591000
CVTCTLFG EQU   CVTS01+50                                                01592000
CVTRV210 EQU   CVTS01+424                                               01593000
CVTRV219 EQU   CVTS01+425                                               01594000
CVTRV228 EQU   CVTS01+426                                               01595000
CVTRV237 EQU   CVTS01+427                                               01596000
CVTMFRTR EQU   CVTS01+452                                               01597000
CVTRV262 EQU   CVTS01+468                                               01598000
CVTRV271 EQU   CVTS01+469                                               01599000
CVTRV280 EQU   CVTS01+470                                               01600000
CVTRV289 EQU   CVTS01+471                                               01601000
CVTGSDA  EQU   CVTS01+600                                               01602000
SVECC012 EQU   SVESC022                                                 01603000
SVEIC00A EQU   SVEIC003                                                 01604000
SVEIC004 EQU   SVEIC003                                                 01605000
SVEIC005 EQU   SVEIC003                                                 01606000
SVESC02A EQU   SVESC022                                                 01607000
SVESC02B EQU   SVESC022                                                 01608000
SVESC02D EQU   SVESC022                                                 01609000
SVESC02E EQU   SVESC022                                                 01610000
SVESC02F EQU   SVECC013                                                 01611000
SVESC024 EQU   SVESC022                                                 01612000
SVESC027 EQU   SVESC022                                                 01613000
SVESC029 EQU   SVESC033                                                 01614000
SVESC031 EQU   SVECC013                                                 01615000
SVESC032 EQU   SVECC011                                                 01616000
SVETC037 EQU   SVEIC003                                                 01617000
         AGO   .@UNREFD                START UNREFERENCED COMPONENTS    01618000
CVTRV628 EQU   CVTS01+728                                               01619000
CVTRV627 EQU   CVTS01+724                                               01620000
CVTRV626 EQU   CVTS01+720                                               01621000
CVTRV625 EQU   CVTS01+716                                               01622000
CVTRV624 EQU   CVTS01+712                                               01623000
CVTRV623 EQU   CVTS01+708                                               01624000
CVTRV622 EQU   CVTS01+704                                               01625000
CVTRV621 EQU   CVTS01+700                                               01626000
CVTIHASU EQU   CVTS01+696                                               01627000
CVTSUSP  EQU   CVTS01+692                                               01628000
CVTT6SVC EQU   CVTS01+688                                               01629000
CVTCDAL  EQU   CVTS01+684                                               01630000
CVTTCTL  EQU   CVTS01+680                                               01631000
CVTRSUME EQU   CVTS01+676                                               01632000
CVTJTERM EQU   CVTS01+672                                               01633000
CVTASMRM EQU   CVTS01+668                                               01634000
CVTTCASP EQU   CVTS01+664                                               01635000
CVT0PT03 EQU   CVTS01+660                                               01636000
CVT0PT0E EQU   CVTS01+656                                               01637000
CVTRV609 EQU   CVTS01+652                                               01638000
CVTCGK   EQU   CVTS01+648                                               01639000
CVTRAC   EQU   CVTS01+644                                               01640000
CVTRV606 EQU   CVTS01+640                                               01641000
CVTRV605 EQU   CVTS01+636                                               01642000
CVTRV604 EQU   CVTS01+632                                               01643000
CVTEFF02 EQU   CVTS01+628                                               01644000
CVTCBBR  EQU   CVTS01+624                                               01645000
CVTSSCR  EQU   CVTS01+620                                               01646000
CVTEVENT EQU   CVTS01+616                                               01647000
CVTCRCA  EQU   CVTS01+612                                               01648000
CVTTPIO  EQU   CVTS01+608                                               01649000
CVTADV   EQU   CVTS01+604                                               01650000
CVTGSDAB EQU   CVTGSDA                                                  01651000
CVTQV3   EQU   CVTS01+596                                               01652000
CVTQV2   EQU   CVTS01+592                                               01653000
CVTQV1   EQU   CVTS01+588                                               01654000
CVTRPT   EQU   CVTS01+584                                               01655000
CVTSSRB  EQU   CVTS01+580                                               01656000
CVTCSDRL EQU   CVTS01+576                                               01657000
CVTEXP1  EQU   CVTS01+572                                               01658000
CVTRMPMT EQU   CVTS01+568                                               01659000
CVTRMPTT EQU   CVTS01+564                                               01660000
CVTVPSA  EQU   CVTS01+560                                               01661000
CVTVSTOP EQU   CVTS01+556                                               01662000
CVTGTFR8 EQU   CVTS01+552                                               01663000
CVTQUIT  EQU   CVTS01+548                                               01664000
CVTVACR  EQU   CVTS01+544                                               01665000
CVTWTCB  EQU   CVTS01+540                                               01666000
CVTSTPRS EQU   CVTS01+536                                               01667000
CVT0PT02 EQU   CVTS01+532                                               01668000
CVTDARCM EQU   CVTS01+528                                               01669000
CVTIRECM EQU   CVTS01+524                                               01670000
CVTJRECM EQU   CVTS01+520                                               01671000
CVTVEMS0 EQU   CVTS01+516                                               01672000
CVTSPFRR EQU   CVTS01+512                                               01673000
CVTRLSTG EQU   CVTS01+508                                               01674000
CVT0TC0A EQU   CVTS01+504                                               01675000
CVTGMBR  EQU   CVTS01+500                                               01676000
CVTLFRM  EQU   CVTS01+496                                               01677000
CVTRMBR  EQU   CVTS01+492                                               01678000
CVTVIOP  EQU   CVTS01+488                                               01679000
CVTRV307 EQU   CVTS01+486                                               01680000
CVTRV306 EQU   CVTS01+484                                               01681000
CVTRV305 EQU   CVTS01+482                                               01682000
CVTRV304 EQU   CVTS01+480                                               01683000
CVTRV303 EQU   CVTS01+478                                               01684000
CVTRV302 EQU   CVTS01+476                                               01685000
CVTTRCA  EQU   CVTS01+472                                               01686000
CVTRV297 EQU   CVTRV289                                                 01687000
CVTRV296 EQU   CVTRV289                                                 01688000
CVTRV295 EQU   CVTRV289                                                 01689000
CVTRV294 EQU   CVTRV289                                                 01690000
CVTRV293 EQU   CVTRV289                                                 01691000
CVTRV292 EQU   CVTRV289                                                 01692000
CVTRV291 EQU   CVTRV289                                                 01693000
CVTRV290 EQU   CVTRV289                                                 01694000
CVTRV288 EQU   CVTRV280                                                 01695000
CVTRV287 EQU   CVTRV280                                                 01696000
CVTRV286 EQU   CVTRV280                                                 01697000
CVTRV285 EQU   CVTRV280                                                 01698000
CVTRV284 EQU   CVTRV280                                                 01699000
CVTRV283 EQU   CVTRV280                                                 01700000
CVTRV282 EQU   CVTRV280                                                 01701000
CVTRV281 EQU   CVTRV280                                                 01702000
CVTRV279 EQU   CVTRV271                                                 01703000
CVTRV278 EQU   CVTRV271                                                 01704000
CVTRV277 EQU   CVTRV271                                                 01705000
CVTRV276 EQU   CVTRV271                                                 01706000
CVTRV275 EQU   CVTRV271                                                 01707000
CVTRV274 EQU   CVTRV271                                                 01708000
CVTRV273 EQU   CVTRV271                                                 01709000
CVTRV272 EQU   CVTRV271                                                 01710000
CVTRV270 EQU   CVTRV262                                                 01711000
CVTRV269 EQU   CVTRV262                                                 01712000
CVTRV268 EQU   CVTRV262                                                 01713000
CVTRV267 EQU   CVTRV262                                                 01714000
CVTRV266 EQU   CVTRV262                                                 01715000
CVTRV265 EQU   CVTRV262                                                 01716000
CVTRV264 EQU   CVTRV262                                                 01717000
CVTRV263 EQU   CVTRV262                                                 01718000
CVTVFP   EQU   CVTS01+464                                               01719000
CVTVSI   EQU   CVTS01+460                                               01720000
CVTVPSIB EQU   CVTS01+456                                               01721000
CVTMFACT EQU   CVTMFRTR                                                 01722000
CVTMFCTL EQU   CVTS01+448                                               01723000
CVTPVBP  EQU   CVTS01+444                                               01724000
CVTPWI   EQU   CVTS01+440                                               01725000
CVTRV254 EQU   CVTS01+438                                               01726000
CVTRV253 EQU   CVTS01+436                                               01727000
CVTRV252 EQU   CVTS01+434                                               01728000
CVTRV251 EQU   CVTS01+433                                               01729000
CVTRV250 EQU   CVTS01+432                                               01730000
CVTRV249 EQU   CVTS01+431                                               01731000
CVTRV248 EQU   CVTS01+430                                               01732000
CVTRV247 EQU   CVTS01+429                                               01733000
CVTRV246 EQU   CVTS01+428                                               01734000
CVTRV245 EQU   CVTRV237                                                 01735000
CVTRV244 EQU   CVTRV237                                                 01736000
CVTRV243 EQU   CVTRV237                                                 01737000
CVTRV242 EQU   CVTRV237                                                 01738000
CVTRV241 EQU   CVTRV237                                                 01739000
CVTRV240 EQU   CVTRV237                                                 01740000
CVTRV239 EQU   CVTRV237                                                 01741000
CVTRV238 EQU   CVTRV237                                                 01742000
CVTRV236 EQU   CVTRV228                                                 01743000
CVTRV235 EQU   CVTRV228                                                 01744000
CVTRV234 EQU   CVTRV228                                                 01745000
CVTRV233 EQU   CVTRV228                                                 01746000
CVTRV232 EQU   CVTRV228                                                 01747000
CVTRV231 EQU   CVTRV228                                                 01748000
CVTRV230 EQU   CVTRV228                                                 01749000
CVTRV229 EQU   CVTRV228                                                 01750000
CVTRV227 EQU   CVTRV219                                                 01751000
CVTRV226 EQU   CVTRV219                                                 01752000
CVTRV225 EQU   CVTRV219                                                 01753000
CVTRV224 EQU   CVTRV219                                                 01754000
CVTRV223 EQU   CVTRV219                                                 01755000
CVTRV222 EQU   CVTRV219                                                 01756000
CVTRV221 EQU   CVTRV219                                                 01757000
CVTRV220 EQU   CVTRV219                                                 01758000
CVTRV218 EQU   CVTRV210                                                 01759000
CVTRV217 EQU   CVTRV210                                                 01760000
CVTRV216 EQU   CVTRV210                                                 01761000
CVTRV215 EQU   CVTRV210                                                 01762000
CVTRV214 EQU   CVTRV210                                                 01763000
CVTRV213 EQU   CVTRV210                                                 01764000
CVTRV212 EQU   CVTRV210                                                 01765000
CVTRV211 EQU   CVTRV210                                                 01766000
CVTLCCAT EQU   CVTS01+420                                               01767000
CVTPCCAT EQU   CVTS01+416                                               01768000
CVTIPCRP EQU   CVTS01+412                                               01769000
CVTIPCRI EQU   CVTS01+408                                               01770000
CVTIPCDS EQU   CVTS01+404                                               01771000
CVTAIDVT EQU   CVTS01+400                                               01772000
CVTSSAP  EQU   CVTS01+396                                               01773000
CVTEHCIR EQU   CVTS01+392                                               01774000
CVTEHDEF EQU   CVTS01+388                                               01775000
CVTDAIR  EQU   CVTS01+384                                               01776000
CVTPERFM EQU   CVTS01+380                                               01777000
CVT044R2 EQU   CVTS01+376                                               01778000
CVTFETCH EQU   CVTS01+372                                               01779000
CVTRSTWD EQU   CVTS01+368                                               01780000
CVTSPOST EQU   CVTS01+364                                               01781000
CVTIOBP  EQU   CVTS01+360                                               01782000
CVTASMVT EQU   CVTS01+356                                               01783000
CVTRECRQ EQU   CVTS01+352                                               01784000
CVTWSAC  EQU   CVTS01+348                                               01785000
CVTRV149 EQU   CVTS01+344                                               01786000
CVTWSAL  EQU   CVTS01+340                                               01787000
CVTSPSA  EQU   CVTS01+336                                               01788000
CVTGLMN  EQU   CVTS01+332                                               01789000
CVTVEAC0 EQU   CVTS01+328                                               01790000
CVT062R1 EQU   CVTS01+324                                               01791000
CVTRPOST EQU   CVTS01+320                                               01792000
CVTDQIQE EQU   CVTS01+316                                               01793000
CVTCSD   EQU   CVTS01+312                                               01794000
CVTLKRMA EQU   CVTS01+308                                               01795000
CVTRSPIE EQU   CVTS01+304                                               01796000
CVTRENQ  EQU   CVTS01+300                                               01797000
CVTLQCB  EQU   CVTS01+296                                               01798000
CVTFQCB  EQU   CVTS01+292                                               01799000
CVTQCS01 EQU   CVTS01+288                                               01800000
CVTAPFT  EQU   CVTS01+284                                               01801000
CVTPARRL EQU   CVTS01+280                                               01802000
CVTVWAIT EQU   CVTS01+276                                               01803000
CVTGSPL  EQU   CVTS01+272                                               01804000
CVTLSMQ  EQU   CVTS01+268                                               01805000
CVTGSMQ  EQU   CVTS01+264                                               01806000
CVTEXPRO EQU   CVTS01+260                                               01807000
CVTOPCTP EQU   CVTS01+256                                               01808000
CVTSIC   EQU   CVTS01+252                                               01809000
CVTTPIOS EQU   CVTS01+248                                               01810000
CVTRTMS  EQU   CVTS01+244                                               01811000
CVTSDBF  EQU   CVTS01+240                                               01812000
CVTSCBP  EQU   CVTS01+236                                               01813000
CVTSDMP  EQU   CVTS01+232                                               01814000
CVTSV60  EQU   CVTS01+228                                               01815000
CVTRTMCT EQU   CVTS01+224                                               01816000
CVTASCBL EQU   CVTS01+220                                               01817000
CVTASCBH EQU   CVTS01+216                                               01818000
CVTGDA   EQU   CVTS01+212                                               01819000
CVTASVT  EQU   CVTS01+208                                               01820000
CVTVVMDI EQU   CVTS01+204                                               01821000
CVTAQTOP EQU   CVTS01+200                                               01822000
CVTIOSCS EQU   CVTS01+196                                               01823000
CVTSDRM  EQU   CVTS01+192                                               01824000
CVTOPTE  EQU   CVTS01+188                                               01825000
CVTSTXU  EQU   CVTS01+184                                               01826000
CVTQUIS  EQU   CVTS01+180                                               01827000
CVTPARS  EQU   CVTS01+176                                               01828000
CVTS1EE  EQU   CVTS01+172                                               01829000
CVTFRAS  EQU   CVTS01+168                                               01830000
CVTQSAS  EQU   CVTS01+164                                               01831000
CVTCRAS  EQU   CVTS01+160                                               01832000
CVTCRMN  EQU   CVTS01+156                                               01833000
CVTDELCP EQU   CVTS01+152                                               01834000
CVTFRECL EQU   CVTS01+148                                               01835000
CVTGETCL EQU   CVTS01+144                                               01836000
CVTBLDCP EQU   CVTS01+140                                               01837000
CVTAUTHL EQU   CVTS01+136                                               01838000
CVTSCAN  EQU   CVTS01+132                                               01839000
CVTRV144 EQU   CVTS01+130                                               01840000
CVTMAXMP EQU   CVTS01+128                                               01841000
CVTSTCK  EQU   CVTS01+124                                               01842000
CVTRV139 EQU   CVTS01+123                                               01843000
CVTDSSAC EQU   CVTS01+122                                               01844000
CVTRV513 EQU   CVTS01+121                                               01845000
CVTIOSPL EQU   CVTS01+120                                               01846000
CVTPTGT  EQU   CVTS01+116                                               01847000
CVTCSPIE EQU   CVTS01+112                                               01848000
CVTSMFEX EQU   CVTS01+108                                               01849000
CVTOLT0A EQU   CVTS01+104                                               01850000
CVTSRBRT EQU   CVTS01+100                                               01851000
CVTPUTL  EQU   CVTS01+96                                                01852000
CVTASCRL EQU   CVTS01+92                                                01853000
CVTASCRF EQU   CVTS01+88                                                01854000
CVTRV326 EQU   CVTS01+84                                                01855000
CVTRV325 EQU   CVTS01+80                                                01856000
CVTRV324 EQU   CVTS01+76                                                01857000
CVT0VL01 EQU   CVTS01+72                                                01858000
CVTSHRVM EQU   CVTS01+68                                                01859000
CVTRV332 EQU   CVTS01+64                                                01860000
CVTTAS   EQU   CVTS01+60                                                01861000
CVTRSCN  EQU   CVTS01+56                                                01862000
CVTTRAC2 EQU   CVTS01+54                                                01863000
CVTTRACE EQU   CVTS01+52                                                01864000
CVTAPG   EQU   CVTS01+51                                                01865000
CVTSDTRC EQU   CVTCTLFG                                                 01866000
CVTGTRCE EQU   CVTCTLFG                                                 01867000
CVTNOMP  EQU   CVTCTLFG                                                 01868000
CVTRSV79 EQU   CVTCTLFG                                                 01869000
CVTDSTAT EQU   CVTCTLFG                                                 01870000
CVTRSV78 EQU   CVTCTLFG                                                 01871000
CVTRV333 EQU   CVTCTLFG                                                 01872000
CVTRV323 EQU   CVTCTLFG                                                 01873000
CVTSPVLK EQU   CVTS01+49                                                01874000
CVTRSV77 EQU   CVTS01+48                                                01875000
CVTRV331 EQU   CVTS01+44                                                01876000
CVTRV330 EQU   CVTS01+40                                                01877000
CVTRV329 EQU   CVTS01+36                                                01878000
CVTRV328 EQU   CVTS01+32                                                01879000
CVTRV322 EQU   CVTS01+28                                                01880000
CVTSLID  EQU   CVTSLIDA+1                                               01881000
CVTSYLK  EQU   CVTSLIDA                                                 01882000
CVTRV321 EQU   CVTS01+20                                                01883000
CVTRV320 EQU   CVTS01+16                                                01884000
CVTLPDIR EQU   CVTLPDIA+1                                               01885000
CVTRSV69 EQU   CVTDIRST                                                 01886000
CVTRSV68 EQU   CVTDIRST                                                 01887000
CVTRSV67 EQU   CVTDIRST                                                 01888000
CVTRSV66 EQU   CVTDIRST                                                 01889000
CVTRSV65 EQU   CVTDIRST                                                 01890000
CVTRSV64 EQU   CVTDIRST                                                 01891000
CVTRSV63 EQU   CVTDIRST                                                 01892000
CVTDICOM EQU   CVTDIRST                                                 01893000
CVTPVTP  EQU   CVTS01+8                                                 01894000
CVTLPDSR EQU   CVTS01+4                                                 01895000
CVTGETL  EQU   CVTS01                                                   01896000
@NM00054 EQU   PABXTNSN+12                                              01897000
PABNPSSQ EQU   PABXTNSN+8                                               01898000
PABLOCK  EQU   PABXTNSN+4                                               01899000
PABLAST  EQU   PABXTNSN                                                 01900000
CVTLEVL  EQU   CVTRELNO+2                                               01901000
CVTNUMB  EQU   CVTRELNO                                                 01902000
CVTMDL   EQU   CVTFIX+250                                               01903000
@NM00111 EQU   CVTFIX+248                                               01904000
@NM00110 EQU   CVTFIX                                                   01905000
CVTRV482 EQU   CVTXTNT2+128                                             01906000
CVTRV481 EQU   CVTXTNT2+124                                             01907000
CVTRV480 EQU   CVTXTNT2+120                                             01908000
CVTRV479 EQU   CVTXTNT2+118                                             01909000
CVTRV478 EQU   CVTXTNT2+117                                             01910000
CVTRV477 EQU   CVTXTNT2+116                                             01911000
CVTRV476 EQU   CVTXTNT2+115                                             01912000
CVTRV475 EQU   CVTXTNT2+114                                             01913000
CVTRV474 EQU   CVTRV466                                                 01914000
CVTRV473 EQU   CVTRV466                                                 01915000
CVTRV472 EQU   CVTRV466                                                 01916000
CVTRV471 EQU   CVTRV466                                                 01917000
CVTRV470 EQU   CVTRV466                                                 01918000
CVTRV469 EQU   CVTRV466                                                 01919000
CVTRV468 EQU   CVTRV466                                                 01920000
CVTRV467 EQU   CVTRV466                                                 01921000
CVTRV465 EQU   CVTRV457                                                 01922000
CVTRV464 EQU   CVTRV457                                                 01923000
CVTRV463 EQU   CVTRV457                                                 01924000
CVTRV462 EQU   CVTRV457                                                 01925000
CVTRV461 EQU   CVTRV457                                                 01926000
CVTRV460 EQU   CVTRV457                                                 01927000
CVTRV459 EQU   CVTRV457                                                 01928000
CVTRV458 EQU   CVTRV457                                                 01929000
CVTRV456 EQU   CVTXTNT2+108                                             01930000
CVTRV455 EQU   CVTXTNT2+104                                             01931000
CVTRV454 EQU   CVTXTNT2+100                                             01932000
CVTRV453 EQU   CVTXTNT2+96                                              01933000
CVTRV452 EQU   CVTXTNT2+94                                              01934000
CVTRV451 EQU   CVTXTNT2+92                                              01935000
CVTRV450 EQU   CVTXTNT2+90                                              01936000
CVTRV449 EQU   CVTXTNT2+88                                              01937000
CVTRV448 EQU   CVTXTNT2+87                                              01938000
CVTRV447 EQU   CVTXTNT2+86                                              01939000
CVTRV446 EQU   CVTRV438                                                 01940000
CVTRV445 EQU   CVTRV438                                                 01941000
CVTRV444 EQU   CVTRV438                                                 01942000
CVTRV443 EQU   CVTRV438                                                 01943000
CVTRV442 EQU   CVTRV438                                                 01944000
CVTRV441 EQU   CVTRV438                                                 01945000
CVTRV440 EQU   CVTRV438                                                 01946000
CVTRV439 EQU   CVTRV438                                                 01947000
CVTRV437 EQU   CVTRV429                                                 01948000
CVTRV436 EQU   CVTRV429                                                 01949000
CVTRV435 EQU   CVTRV429                                                 01950000
CVTRV434 EQU   CVTRV429                                                 01951000
CVTRV433 EQU   CVTRV429                                                 01952000
CVTRV432 EQU   CVTRV429                                                 01953000
CVTRV431 EQU   CVTRV429                                                 01954000
CVTRV430 EQU   CVTRV429                                                 01955000
CVTRV428 EQU   CVTXTNT2+80                                              01956000
CVTRV427 EQU   CVTXTNT2+76                                              01957000
CVTRV426 EQU   CVTXTNT2+72                                              01958000
CVTRV425 EQU   CVTXTNT2+68                                              01959000
CVTATACT EQU   CVTATCVT                                                 01960000
CVTRV423 EQU   CVTXTNT2+62                                              01961000
CVTRV422 EQU   CVTXTNT2+60                                              01962000
CVTRV421 EQU   CVTXTNT2+58                                              01963000
CVTRV420 EQU   CVTXTNT2+56                                              01964000
CVTRV419 EQU   CVTXTNT2+55                                              01965000
CVTRV418 EQU   CVTXTNT2+54                                              01966000
CVTRV417 EQU   CVTRV409                                                 01967000
CVTRV416 EQU   CVTRV409                                                 01968000
CVTRV415 EQU   CVTRV409                                                 01969000
CVTRV414 EQU   CVTRV409                                                 01970000
CVTRV413 EQU   CVTRV409                                                 01971000
CVTRV412 EQU   CVTRV409                                                 01972000
CVTRV411 EQU   CVTRV409                                                 01973000
CVTRV410 EQU   CVTRV409                                                 01974000
CVTRV408 EQU   CVTRV400                                                 01975000
CVTRV407 EQU   CVTRV400                                                 01976000
CVTRV406 EQU   CVTRV400                                                 01977000
CVTRV405 EQU   CVTRV400                                                 01978000
CVTRV404 EQU   CVTRV400                                                 01979000
CVTRV403 EQU   CVTRV400                                                 01980000
CVTRV402 EQU   CVTRV400                                                 01981000
CVTRV401 EQU   CVTRV400                                                 01982000
CVTICB   EQU   CVTXTNT2+48                                              01983000
CVTSKTA  EQU   CVTXTNT2+44                                              01984000
CVTCCVT  EQU   CVTXTNT2+40                                              01985000
CVTRSV98 EQU   CVTXTNT2+36                                              01986000
CVTRSV97 EQU   CVTXTNT2+34                                              01987000
CVTRSV96 EQU   CVTXTNT2+32                                              01988000
CVTOLTEP EQU   CVTXTNT2+28                                              01989000
CVTQIDA  EQU   CVTQID+1                                                 01990000
CVTRSV95 EQU   CVTQID                                                   01991000
CVTRSV94 EQU   CVTXTNT2+20                                              01992000
CVTRSV93 EQU   CVTXTNT2+16                                              01993000
CVTRSV92 EQU   CVTXTNT2+12                                              01994000
CVTDEBVR EQU   CVTXTNT2+8                                               01995000
CVTRSV91 EQU   CVTXTNT2+6                                               01996000
CVTRSV9H EQU   CVTFLGBT                                                 01997000
CVTRSV9G EQU   CVTFLGBT                                                 01998000
CVTRSV9F EQU   CVTFLGBT                                                 01999000
CVTRSV9E EQU   CVTFLGBT                                                 02000000
CVTRSV9D EQU   CVTFLGBT                                                 02001000
CVTBAH   EQU   CVTFLGBT                                                 02002000
CVTVME   EQU   CVTFLGBT                                                 02003000
CVTNPE   EQU   CVTFLGBT                                                 02004000
CVTNUCLS EQU   CVTXTNT2+4                                               02005000
CVTDSSVA EQU   CVTDSSV+1                                                02006000
CVTRSV89 EQU   CVTDSSV                                                  02007000
CVTRSV88 EQU   CVTXTNT1+8                                               02008000
CVTRSV87 EQU   CVTXTNT1+4                                               02009000
CVTFACHN EQU   CVTXTNT1                                                 02010000
CVTRV488 EQU   CVTMAP+412                                               02011000
CVTRV487 EQU   CVTMAP+408                                               02012000
CVTRV486 EQU   CVTMAP+404                                               02013000
CVTRV485 EQU   CVTMAP+400                                               02014000
CVTACTAP EQU   CVTMAP+396                                               02015000
CVTAUTH  EQU   CVTMAP+392                                               02016000
CVTRV490 EQU   CVTMAP+388                                               02017000
CVTSU    EQU   CVTMAP+384                                               02018000
CVTVOLT1 EQU   CVTVOLM1+1                                               02019000
CVTVOLI1 EQU   CVTVOLF1                                                 02020000
CVTSTOA  EQU   CVTMAP+376                                               02021000
CVTRSV58 EQU   CVTMAP+374                                               02022000
CVTRSV57 EQU   CVTMAP+372                                               02023000
CVTDDCE  EQU   CVTMAP+368                                               02024000
CVTPNWFR EQU   CVTMAP+364                                               02025000
CVTSMF   EQU   CVTMAP+360                                               02026000
CVTSULK  EQU   CVTMAP+358                                               02027000
CVTSLKO  EQU   CVTSYSK                                                  02028000
CVTSLKP  EQU   CVTSYSK                                                  02029000
CVTSLKQ  EQU   CVTSYSK                                                  02030000
CVTSLKR  EQU   CVTSYSK                                                  02031000
CVTRSV56 EQU   CVTSYSK                                                  02032000
CVTRSV55 EQU   CVTSYSK                                                  02033000
CVTRSV54 EQU   CVTSYSK                                                  02034000
CVTRSV53 EQU   CVTSYSK                                                  02035000
CVTRSV52 EQU   CVTA1F1                                                  02036000
CVTRSV51 EQU   CVTA1F1                                                  02037000
CVTRSV50 EQU   CVTA1F1                                                  02038000
CVTRSV49 EQU   CVTA1F1                                                  02039000
CVTRSV48 EQU   CVTA1F1                                                  02040000
CVTRSV47 EQU   CVTA1F1                                                  02041000
CVTSRSW  EQU   CVTA1F1                                                  02042000
CVTPFSW  EQU   CVTA1F1                                                  02043000
CVTPCVT  EQU   CVTMAP+352                                               02044000
CVTRSV46 EQU   CVTMAP+344                                               02045000
CVTRSV45 EQU   CVTMAP+340                                               02046000
CVTRSV44 EQU   CVTMAP+338                                               02047000
CVTRSV43 EQU   CVTMAP+336                                               02048000
CVTHJESA EQU   CVTHJES+1                                                02049000
CVTRSV42 EQU   CVTHJES                                                  02050000
CVTEXT2A EQU   CVTEXT2+1                                                02051000
CVTRSV41 EQU   CVTEXT2                                                  02052000
CVTAPFA  EQU   CVTAPF+1                                                 02053000
CVTRSV40 EQU   CVTAPF                                                   02054000
CVTRV518 EQU   CVTINTLA                                                 02055000
CVTRV517 EQU   CVTERPV                                                  02056000
CVTEORM  EQU   CVTMAP+312                                               02057000
CVTMCHPR EQU   CVTMAP+308                                               02058000
CVTTZ    EQU   CVTMAP+304                                               02059000
CVTJEPS  EQU   CVTMAP+300                                               02060000
CVTJESCT EQU   CVTMAP+296                                               02061000
CVTMODE  EQU   CVTMAP+292                                               02062000
CVTPTRV  EQU   CVTMAP+288                                               02063000
CVTREAL  EQU   CVTMAP+284                                               02064000
CVTRSV39 EQU   CVTMAP+280                                               02065000
CVTRSV38 EQU   CVTMAP+276                                               02066000
CVTDMSRA EQU   CVTDMSR+1                                                02067000
CVTRV634 EQU   CVTDMSRF                                                 02068000
CVTRV633 EQU   CVTDMSRF                                                 02069000
CVTRV632 EQU   CVTDMSRF                                                 02070000
CVTRV631 EQU   CVTDMSRF                                                 02071000
CVTRV630 EQU   CVTDMSRF                                                 02072000
CVTRV629 EQU   CVTDMSRF                                                 02073000
CVTUDUMP EQU   CVTDMSRF                                                 02074000
CVTSDUMP EQU   CVTDMSRF                                                 02075000
CVTQMSGA EQU   CVTQMSG+1                                                02076000
CVTRSV36 EQU   CVTQMSG                                                  02077000
CVTAMFF  EQU   CVTMAP+264                                               02078000
CVTPURGA EQU   CVTPURG+1                                                02079000
CVTRSV35 EQU   CVTPURG                                                  02080000
CVTCBSP  EQU   CVTMAP+256                                               02081000
CVTATERA EQU   CVTATER+1                                                02082000
CVTSYST  EQU   CVTATER                                                  02083000
CVTVOLT2 EQU   CVTTAT                                                   02084000
CVTVOLI2 EQU   CVTVOLF2                                                 02085000
CVTAQAVB EQU   CVTAQAVT+1                                               02086000
CVTRSV34 EQU   CVTTCMFG                                                 02087000
CVTRSV33 EQU   CVTTCMFG                                                 02088000
CVTRSV32 EQU   CVTTCMFG                                                 02089000
CVTRSV31 EQU   CVTTCMFG                                                 02090000
CVTRSV30 EQU   CVTTCMFG                                                 02091000
CVTRSV29 EQU   CVTTCMFG                                                 02092000
CVTLDEV  EQU   CVTTCMFG                                                 02093000
CVTTCRDY EQU   CVTTCMFG                                                 02094000
CVTGTFA  EQU   CVTGTF+1                                                 02095000
CVTRSV27 EQU   CVTGTFST                                                 02096000
CVTRNIO  EQU   CVTGTFST                                                 02097000
CVTUSR   EQU   CVTGTFST                                                 02098000
CVTRV318 EQU   CVTFORM                                                  02099000
CVTRV317 EQU   CVTTMODE                                                 02100000
CVTRV316 EQU   CVTSTATE                                                 02101000
CVTRV315 EQU   CVTGTFS                                                  02102000
CVTGTFAV EQU   CVTGTFS                                                  02103000
CVT0SCR1 EQU   CVTMAP+232                                               02104000
CVTRV515 EQU   CVTMAP+228                                               02105000
CVTRMS   EQU   CVTMAP+224                                               02106000
CVTPATCH EQU   CVTMAP+220                                               02107000
CVTTSCE  EQU   CVTMAP+216                                               02108000
CVTLNKSC EQU   CVTMAP+214                                               02109000
CVTQABST EQU   CVTMAP+212                                               02110000
CVTMDLDS EQU   CVTMAP+208                                               02111000
CVTUSER  EQU   CVTMAP+204                                               02112000
CVTABEND EQU   CVTMAP+200                                               02113000
CVTSMCA  EQU   CVTMAP+196                                               02114000
CVTRSV18 EQU   CVTMAP+192                                               02115000
CVTQLPAQ EQU   CVTMAP+188                                               02116000
CVTQCDSR EQU   CVTMAP+184                                               02117000
CVTVS1B  EQU   CVTOPTB                                                  02118000
CVTVS1A  EQU   CVTOPTB                                                  02119000
CVTFP    EQU   CVTOPTB                                                  02120000
CVTAPTHR EQU   CVTOPTB                                                  02121000
CVTNLOG  EQU   CVTOPTB                                                  02122000
CVTTOD   EQU   CVTOPTB                                                  02123000
CVTCTIMS EQU   CVTOPTB                                                  02124000
CVTPROT  EQU   CVTOPTB                                                  02125000
CVTXPFP  EQU   CVTOPTA                                                  02126000
CVTASCII EQU   CVTOPTA                                                  02127000
CVTRSV13 EQU   CVTOPTA                                                  02128000
CVTRSV12 EQU   CVTOPTA                                                  02129000
CVTNIP   EQU   CVTOPTA                                                  02130000
CVTDDR   EQU   CVTOPTA                                                  02131000
CVTAPR   EQU   CVTOPTA                                                  02132000
CVTCCH   EQU   CVTOPTA                                                  02133000
CVTSNCTR EQU   CVTMAP+180                                               02134000
CVTQMWR  EQU   CVTMAP+176                                               02135000
CVTQOCR  EQU   CVTMAP+172                                               02136000
CVT1EF00 EQU   CVTMAP+168                                               02137000
CVTMZ00  EQU   CVTMAP+164                                               02138000
CVTHEAD  EQU   CVTMAP+160                                               02139000
CVTRSV11 EQU   CVTMAP+156                                               02140000
CVT0PT01 EQU   CVTMAP+152                                               02141000
CVTMSER  EQU   CVTMAP+148                                               02142000
CVTRV516 EQU   CVTIERLC                                                 02143000
CVTILCH  EQU   CVTMAP+140                                               02144000
CVT0DS   EQU   CVTMAP+136                                               02145000
CVTFBOSV EQU   CVTMAP+132                                               02146000
CVTNUCB  EQU   CVTMAP+128                                               02147000
CVTIXAVL EQU   CVTMAP+124                                               02148000
CVTIOQET EQU   CVTMAP+120                                               02149000
CVTDCBA  EQU   CVTMAP+117                                               02150000
CVTMVS2  EQU   CVTDCB                                                   02151000
CVT6DAT  EQU   CVTDCB                                                   02152000
CVT4MPS  EQU   CVTDCB                                                   02153000
CVTRSV09 EQU   CVTDCB                                                   02154000
CVT4MS1  EQU   CVTDCB                                                   02155000
CVT2SPS  EQU   CVTDCB                                                   02156000
CVT1SSS  EQU   CVTDCB                                                   02157000
CVTRSV08 EQU   CVTDCB                                                   02158000
CVTSTB   EQU   CVTMAP+112                                               02159000
CVTQTD00 EQU   CVTMAP+108                                               02160000
CVTQTE00 EQU   CVTMAP+104                                               02161000
CVTCUCB  EQU   CVTMAP+100                                               02162000
CVTSJQ   EQU   CVTMAP+96                                                02163000
CVTPBLDL EQU   CVTMAP+92                                                02164000
CVTTPC   EQU   CVTMAP+88                                                02165000
CVTSVDCB EQU   CVTMAP+84                                                02166000
CVTBRET  EQU   CVTMAP+82                                                02167000
CVTEXIT  EQU   CVTMAP+80                                                02168000
CVT0FN00 EQU   CVTMAP+76                                                02169000
CVTDARA  EQU   CVTDAR+1                                                 02170000
CVTRSV07 EQU   CVTFLGS1                                                 02171000
CVTRSV06 EQU   CVTFLGS1                                                 02172000
CVTRSV05 EQU   CVTFLGS1                                                 02173000
CVTRSV04 EQU   CVTFLGS1                                                 02174000
CVTRSV03 EQU   CVTFLGS1                                                 02175000
CVTRSV02 EQU   CVTFLGS1                                                 02176000
CVTRSV01 EQU   CVTFLGS1                                                 02177000
CVTDMPLK EQU   CVTFLGS1                                                 02178000
CVTXITP  EQU   CVTMAP+68                                                02179000
CVTZDTAB EQU   CVTMAP+64                                                02180000
CVTMSLT  EQU   CVTMAP+60                                                02181000
CVTDATE  EQU   CVTMAP+56                                                02182000
CVTBTERM EQU   CVTMAP+52                                                02183000
CVTSYSAD EQU   CVTMAP+48                                                02184000
CVTXTLER EQU   CVTMAP+44                                                02185000
CVTILK2  EQU   CVTMAP+40                                                02186000
CVTILK1  EQU   CVTMAP+36                                                02187000
CVTPRLTV EQU   CVTMAP+32                                                02188000
CVTPCNVT EQU   CVTMAP+28                                                02189000
CVT0VL00 EQU   CVTMAP+24                                                02190000
CVTXAPG  EQU   CVTMAP+20                                                02191000
CVTBUF   EQU   CVTMAP+16                                                02192000
CVTJOB   EQU   CVTMAP+12                                                02193000
CVTLINK  EQU   CVTMAP+8                                                 02194000
CVT0EF00 EQU   CVTMAP+4                                                 02195000
CVTTCBP  EQU   CVTMAP                                                   02196000
CVT      EQU   CVTMAP                                                   02197000
ATCAOS   EQU   ISTATCVT+1868                                            02198000
@NM00109 EQU   ISTATCVT+1860                                            02199000
@NM00108 EQU   ISTATCVT+1852                                            02200000
@NM00107 EQU   ISTATCVT+1844                                            02201000
@NM00106 EQU   ISTATCVT+1836                                            02202000
@NM00105 EQU   ISTATCVT+1828                                            02203000
@NM00104 EQU   ISTATCVT+1820                                            02204000
ATCHWCSA EQU   ISTATCVT+1816                                            02205000
ATCCACSA EQU   ISTATCVT+1812                                            02206000
ATCMXCSA EQU   ISTATCVT+1808                                            02207000
ATCTPMPB EQU   ISTATCVT+1776                                            02208000
ATCTRMPB EQU   ISTATCVT+1744                                            02209000
ATCRPLAC EQU   ATCRPLCN+2                                               02210000
ATCRPLRC EQU   ATCRPLCN                                                 02211000
ATCCRPLQ EQU   ATCCRPL                                                  02212000
ATCSRBAC EQU   ATCSRBCN+2                                               02213000
ATCSRBRC EQU   ATCSRBCN                                                 02214000
ATCSRBQ  EQU   ATCSRB                                                   02215000
ATCCRAAC EQU   ATCCRACN+2                                               02216000
ATCCRARC EQU   ATCCRACN                                                 02217000
ATCCRAQ  EQU   ATCCRA                                                   02218000
ATCLUFFD EQU   ISTATCVT+1716                                            02219000
ATCVIOPM EQU   ISTATCVT+1712                                            02220000
ATCTPMMI EQU   ISTATCVT+1708                                            02221000
ATCPXSRB EQU   ISTATCVT+1704                                            02222000
ATCRPLCT EQU   ISTATCVT+1702                                            02223000
ATCCRACT EQU   ISTATCVT+1700                                            02224000
ATCSRBCT EQU   ISTATCVT+1698                                            02225000
ATCSTNSM EQU   ISTATCVT+1697                                            02226000
@NM00103 EQU   ATCZFLAG                                                 02227000
ATCZF001 EQU   ATCZFLAG                                                 02228000
ATCTPCP1 EQU   ISTATCVT+1692                                            02229000
ATCTPCP0 EQU   ISTATCVT+1688                                            02230000
ATCZR01  EQU   ISTATCVT+1684                                            02231000
ATCMPLTA EQU   ISTATCVT+1680                                            02232000
ATCASCB  EQU   ISTATCVT+1676                                            02233000
ATCAP86  EQU   ISTATCVT+1672                                            02234000
ATCAP85  EQU   ISTATCVT+1668                                            02235000
ATCAP84  EQU   ISTATCVT+1664                                            02236000
ATCAP83  EQU   ISTATCVT+1660                                            02237000
ATCAP82  EQU   ISTATCVT+1656                                            02238000
ATCAP69  EQU   ISTATCVT+1652                                            02239000
ATCAP66  EQU   ISTATCVT+1648                                            02240000
ATCAP62  EQU   ISTATCVT+1644                                            02241000
ATCAPC59 EQU   ISTATCVT+1640                                            02242000
ATCAP56  EQU   ISTATCVT+1636                                            02243000
ATCAP55  EQU   ISTATCVT+1632                                            02244000
ATCAP41  EQU   ISTATCVT+1628                                            02245000
ATCAPC25 EQU   ISTATCVT+1624                                            02246000
ATCAP23  EQU   ISTATCVT+1620                                            02247000
ATCAPBE  EQU   ISTATCVT+1616                                            02248000
ATCPSTA  EQU   ISTATCVT+1612                                            02249000
ATCSMABF EQU   ISTATCVT+1608                                            02250000
ATCSMAPR EQU   ISTATCVT+1604                                            02251000
ATCTPWQA EQU   ISTATCVT+1600                                            02252000
ATCSMAID EQU   ISTATCVT+1596                                            02253000
ATCSMARA EQU   ISTATCVT+1592                                            02254000
ATCCACXA EQU   ISTATCVT+1588                                            02255000
ATCATA10 EQU   ISTATCVT+1584                                            02256000
ATCHLTCB EQU   ISTATCVT+1580                                            02257000
@NM00102 EQU   ATCVTFLG                                                 02258000
ATCVTACT EQU   ATCVTFLG                                                 02259000
@NM00101 EQU   @NM00100                                                 02260000
ATCVTMAB EQU   @NM00100                                                 02261000
ATCVTBAM EQU   ISTATCVT+1572                                            02262000
@NM00099 EQU   ISTATCVT+1568                                            02263000
@NM00098 EQU   ISTATCVT+1520                                            02264000
ATCCCOOC EQU   ISTATCVT+1516                                            02265000
@NM00097 EQU   ISTATCVT+1513                                            02266000
ATCSNUF  EQU   ATCENFLG                                                 02267000
ATCOPKL  EQU   ATCENFLG                                                 02268000
ATCABEN  EQU   ATCENFLG                                                 02269000
ATCSRDN  EQU   ATCENFLG                                                 02270000
ATCDLDN  EQU   ATCENFLG                                                 02271000
ATCTIMER EQU   ISTATCVT+1508                                            02272000
ATCAIWT  EQU   ISTATCVT+1504                                            02273000
ATCOROBT EQU   ISTATCVT+1500                                            02274000
ATCDMAPP EQU   ISTATCVT+1496                                            02275000
ATCZDVTX EQU   ISTATCVT+1492                                            02276000
ATCPXCRA EQU   ISTATCVT+1488                                            02277000
ATCICNCB EQU   ISTATCVT+1484                                            02278000
ATCCMTCB EQU   ISTATCVT+1480                                            02279000
ATCPRPH  EQU   ISTATCVT+1476                                            02280000
ATCGSRBF EQU   ATCGSRBG                                                 02281000
ATCSRBRT EQU   ISTATCVT+1468                                            02282000
ATCTSCPC EQU   ISTATCVT+1464                                            02283000
@NM00096 EQU   ISTATCVT+1460                                            02284000
ATCCDTCB EQU   ISTATCVT+1456                                            02285000
ATCORFRL EQU   ISTATCVT+1452                                            02286000
ATCORFPX EQU   ISTATCVT+1448                                            02287000
ATCORFMG EQU   ISTATCVT+1444                                            02288000
ATCSMBQ  EQU   ISTATCVT+1440                                            02289000
ATCINFDD EQU   ISTATCVT+1436                                            02290000
ATCAP67  EQU   ISTATCVT+1432                                            02291000
ATCAP65  EQU   ISTATCVT+1428                                            02292000
ATCAP64  EQU   ISTATCVT+1424                                            02293000
ATCAP63  EQU   ISTATCVT+1420                                            02294000
ATCAP61  EQU   ISTATCVT+1416                                            02295000
ATCAP58  EQU   ISTATCVT+1412                                            02296000
ATCAP57  EQU   ISTATCVT+1408                                            02297000
ATCAP54  EQU   ISTATCVT+1404                                            02298000
ATCAP53  EQU   ISTATCVT+1400                                            02299000
ATCAP52  EQU   ISTATCVT+1396                                            02300000
ATCAP51  EQU   ISTATCVT+1392                                            02301000
ATCAP38  EQU   ISTATCVT+1388                                            02302000
ATCAP37  EQU   ISTATCVT+1384                                            02303000
ATCAP34  EQU   ISTATCVT+1380                                            02304000
ATCAP32  EQU   ISTATCVT+1376                                            02305000
ATCAP31  EQU   ISTATCVT+1372                                            02306000
ATCAP12  EQU   ISTATCVT+1368                                            02307000
ATCAP11  EQU   ISTATCVT+1364                                            02308000
ATCDAPDG EQU   ATCDAPVT+20                                              02309000
ATCDXCEA EQU   ATCDAPVT+16                                              02310000
ATCDCEA  EQU   ATCDAPVT+12                                              02311000
ATCDPCIA EQU   ATCDAPVT+8                                               02312000
ATCDSIOA EQU   ATCDAPVT+4                                               02313000
ATCDEOEA EQU   ATCDAPVT                                                 02314000
ATCZAEA  EQU   ATCICAPP+16                                              02315000
ATCZCEA  EQU   ATCICAPP+12                                              02316000
ATCZCPCI EQU   ATCICAPP+8                                               02317000
ATCZSIOA EQU   ATCICAPP+4                                               02318000
ATCCDRPH EQU   ATCICAPP                                                 02319000
ATCORQG  EQU   ATCORSRB                                                 02320000
ATCORTBF EQU   ATCSQAFR                                                 02321000
@NM00095 EQU   ISTATCVT+1308                                            02322000
ATCZLAEA EQU   ATCLDAPP+16                                              02323000
ATCZLCEA EQU   ATCLDAPP+12                                              02324000
ATCZLPCI EQU   ATCLDAPP+8                                               02325000
ATCSMFRR EQU   ATCLDAPP+4                                               02326000
ATCCDTID EQU   ATCLDAPP                                                 02327000
@NM00094 EQU   ISTATCVT+1256                                            02328000
ATCZPAB2 EQU   ISTATCVT+1224                                            02329000
@NM00093 EQU   ISTATCVT+1224                                            02330000
@NM00092 EQU   ISTATCVT+1164                                            02331000
ATCCPCFE EQU   ISTATCVT+1160                                            02332000
@NM00091 EQU   ATCRID+2                                                 02333000
ATCCDRMA EQU   ATCRID                                                   02334000
@NM00090 EQU   ATCSMSDQ+8                                               02335000
@NM00089 EQU   ATCSMSDQ+4                                               02336000
@NM00088 EQU   ATCSMSDQ                                                 02337000
ATCSEQNO EQU   ISTATCVT+1136                                            02338000
ATCSMPMD EQU   ISTATCVT+1132                                            02339000
ATCPAREA EQU   ISTATCVT+1128                                            02340000
ATCCPCSM EQU   ISTATCVT+1124                                            02341000
ATCQLOCK EQU   ISTATCVT+1120                                            02342000
ATCITQLE EQU   ISTATCVT+1116                                            02343000
ATCSQCDS EQU   ISTATCVT+1112                                            02344000
ATCUSSVT EQU   ISTATCVT+1108                                            02345000
ATCNOSQ  EQU   ISTATCVT+1104                                            02346000
ATCINCIP EQU   ATCCPDVT+4                                               02347000
ATCTSCNI EQU   ATCCPDVT                                                 02348000
ATCMGCRT EQU   ISTATCVT+1092                                            02349000
ATCMACRT EQU   ISTATCVT+1088                                            02350000
ATCCSMT  EQU   ISTATCVT+1084                                            02351000
ATCDRUSL EQU   ISTATCVT+1080                                            02352000
ATCDRULL EQU   ISTATCVT+1076                                            02353000
ATCCFCDR EQU   ISTATCVT+1072                                            02354000
@NM00087 EQU   ISTATCVT+1069                                            02355000
ATCMROUT EQU   ISTATCVT+1060                                            02356000
ATCONFIG EQU   ISTATCVT+1052                                            02357000
ATCNODEL EQU   ISTATCVT+1044                                            02358000
@NM00086 EQU   @NM00085+9                                               02359000
ATCLAST  EQU   ATCSHRFG                                                 02360000
ATCSHRTN EQU   @NM00085                                                 02361000
@NM00084 EQU   ISTATCVT+1026                                            02362000
ATCNMCTR EQU   ISTATCVT+1024                                            02363000
ATCPOIA  EQU   ATCRNO+1                                                 02364000
@NM00083 EQU   ATCRNO                                                   02365000
ATCLCLCT EQU   ATCVLCNT+2                                               02366000
ATCRNCNT EQU   ATCVLCNT                                                 02367000
ATCHBSIZ EQU   ATCHPGM+2                                                02368000
ATCHBFNO EQU   ATCHPGM                                                  02369000
@NM00082 EQU   ISTATCVT+1011                                            02370000
ATCXRANG EQU   ISTATCVT+1010                                            02371000
ATCMAXID EQU   ISTATCVT+1009                                            02372000
ATCMSGSP EQU   ISTATCVT+1008                                            02373000
ATCCIDM  EQU   ISTATCVT+1006                                            02374000
ATCACTRM EQU   ISTATCVT+1004                                            02375000
ATCECNET EQU   ISTATCVT+996                                             02376000
ATCECOPC EQU   ISTATCVT+992                                             02377000
ATCECSES EQU   ISTATCVT+988                                             02378000
ATCECDSP EQU   ISTATCVT+984                                             02379000
ATCECVRY EQU   ISTATCVT+980                                             02380000
ATCECHLT EQU   ISTATCVT+976                                             02381000
ATCECMOD EQU   ISTATCVT+972                                             02382000
ATCVDLOK EQU   ISTATCVT+968                                             02383000
ATCRDTLK EQU   ISTATCVT+964                                             02384000
ATCVOCLK EQU   ISTATCVT+960                                             02385000
ATCITLIM EQU   ISTATCVT+958                                             02386000
ATCTMINV EQU   ISTATCVT+956                                             02387000
ATCHOSTA EQU   ISTATCVT+954                                             02388000
ATCPUNSA EQU   ISTATCVT+952                                             02389000
ATCSAF   EQU   ISTATCVT+950                                             02390000
ATCVTMID EQU   ATCSSCPA                                                 02391000
ATCHCNID EQU   ATCONID+2                                                02392000
ATCSCNID EQU   ATCONID                                                  02393000
@NM00081 EQU   ATCBITAN+3                                               02394000
@NM00080 EQU   ATCBITAN+2                                               02395000
@NM00079 EQU   ATCFLAG2                                                 02396000
@NM00078 EQU   ATCFLAG2                                                 02397000
@NM00077 EQU   ATCFLAG2                                                 02398000
ATCCRYPF EQU   ATCFLAG2                                                 02399000
ATCTUNCL EQU   ATCFLAG2                                                 02400000
ATCTUNRQ EQU   ATCFLAG2                                                 02401000
ATCTUNAC EQU   ATCFLAG2                                                 02402000
ATCCDLRA EQU   ATCFLAG2                                                 02403000
@NM00076 EQU   ATCBITAN                                                 02404000
@NM00075 EQU   ATCSTAT4                                                 02405000
@NM00074 EQU   ATCSTAT4                                                 02406000
@NM00073 EQU   ATCSTAT4                                                 02407000
@NM00072 EQU   ATCSTAT4                                                 02408000
@NM00071 EQU   ATCSTAT4                                                 02409000
ATCPRTAT EQU   ATCSTAT4                                                 02410000
ATCNCSD  EQU   ATCSTAT4                                                 02411000
@NM00070 EQU   ATCPOFLG                                                 02412000
@NM00069 EQU   ATCPOFLG                                                 02413000
@NM00068 EQU   ATCPOFLG                                                 02414000
@NM00067 EQU   ATCPOFLG                                                 02415000
@NM00066 EQU   ATCPOFLG                                                 02416000
@NM00065 EQU   ATCPOFLG                                                 02417000
@NM00064 EQU   ATCPOFLG                                                 02418000
ATCPOUNS EQU   ATCPOFLG                                                 02419000
@NM00063 EQU   ATCSTAT+1                                                02420000
ATCHIP   EQU   ATCSTAT1                                                 02421000
ATCMDHLT EQU   ATCSTAT1                                                 02422000
ATCINHLT EQU   ATCSTAT1                                                 02423000
ATCNETSL EQU   ATCSTAT1                                                 02424000
ATCQKHLT EQU   ATCSTAT1                                                 02425000
ATCSNHLT EQU   ATCSTAT1                                                 02426000
ATCACTIV EQU   ATCSTAT1                                                 02427000
ATCSTART EQU   ATCSTAT1                                                 02428000
ATCNOP00 EQU   ISTATCVT+932                                             02429000
ATCTSBUF EQU   ISTATCVT+928                                             02430000
ATCFEPT  EQU   ISTATCVT+924                                             02431000
ATCFDVT  EQU   ISTATCVT+920                                             02432000
ATCCONFT EQU   ISTATCVT+916                                             02433000
ATCRDTH  EQU   ISTATCVT+912                                             02434000
ATCSIBQ  EQU   ISTATCVT+908                                             02435000
ATCHLTMS EQU   ISTATCVT+904                                             02436000
ATCECPRM EQU   ISTATCVT+900                                             02437000
ATCVPARM EQU   ISTATCVT+896                                             02438000
ATCOCHA  EQU   ISTATCVT+892                                             02439000
ATCDSPLQ EQU   ISTATCVT+888                                             02440000
ATCVARYQ EQU   ISTATCVT+884                                             02441000
ATCHALTQ EQU   ISTATCVT+880                                             02442000
ATCMODQ  EQU   ISTATCVT+876                                             02443000
ATCSRT   EQU   ISTATCVT+872                                             02444000
ATCRDT   EQU   ISTATCVT+868                                             02445000
ATCSDVT  EQU   ISTATCVT+864                                             02446000
ATCDLRPT EQU   ISTATCVT+860                                             02447000
ATCBPDA  EQU   ISTATCVT+856                                             02448000
ATCACDA  EQU   ISTATCVT+852                                             02449000
ATCMNT   EQU   ISTATCVT+848                                             02450000
ATCUEP   EQU   ISTATCVT+844                                             02451000
ATCNODDS EQU   ISTATCVT+840                                             02452000
ATCITRT  EQU   ISTATCVT+836                                             02453000
ATCTODVT EQU   ISTATCVT+832                                             02454000
ATCTRCPT EQU   ISTATCVT+828                                             02455000
ATCMODTB EQU   ISTATCVT+824                                             02456000
ATCUSSPT EQU   ISTATCVT+820                                             02457000
ATCTUBUF EQU   ISTATCVT+816                                             02458000
ATCTACB  EQU   ISTATCVT+812                                             02459000
ATCDWA   EQU   ISTATCVT+808                                             02460000
ATCCFCR2 EQU   ATCPODVT                                                 02461000
ATCEPA   EQU   ISTATCVT+800                                             02462000
ATCPULQB EQU   @NM00062+16                                              02463000
ATCMCQAB EQU   @NM00062+12                                              02464000
ATCLUSMQ EQU   @NM00062+8                                               02465000
ATCLUIOQ EQU   @NM00062+4                                               02466000
ATCIOLQB EQU   @NM00062                                                 02467000
ATCTSCAP EQU   ATCANYDT                                                 02468000
ATCTSCCO EQU   ATCLUDVT+4                                               02469000
ATCTSCSR EQU   ATCLUDVT                                                 02470000
ATCVTLOD EQU   ISTATCVT+764                                             02471000
ATCTSCLF EQU   ISTATCVT+760                                             02472000
ATCTSCLE EQU   ISTATCVT+756                                             02473000
ATCTSCLB EQU   ISTATCVT+752                                             02474000
ATCTSCLS EQU   ISTATCVT+748                                             02475000
ATCTSCCF EQU   ISTATCVT+744                                             02476000
ATCTSCFV EQU   ISTATCVT+740                                             02477000
ATCTSCCE EQU   ISTATCVT+736                                             02478000
ATCTSCCB EQU   ISTATCVT+732                                             02479000
ATCTSCWS EQU   ISTATCVT+728                                             02480000
ATCTSCEM EQU   ISTATCVT+724                                             02481000
ATCTSCNS EQU   ISTATCVT+720                                             02482000
ATCTSCER EQU   ISTATCVT+716                                             02483000
ATCTSCPR EQU   ISTATCVT+712                                             02484000
ATCTSCGR EQU   ISTATCVT+708                                             02485000
ATCTSCCI EQU   ISTATCVT+704                                             02486000
ATCTSVT  EQU   ISTATCVT+700                                             02487000
ATCDVLOD EQU   ISTATCVT+696                                             02488000
ATCCDCNR EQU   ISTATCVT+692                                             02489000
ATCCDCNF EQU   ISTATCVT+688                                             02490000
ATCCDCND EQU   ISTATCVT+684                                             02491000
ATCCDCNA EQU   ISTATCVT+680                                             02492000
ATCCDCCP EQU   ISTATCVT+676                                             02493000
ATCCDFDN EQU   ISTATCVT+672                                             02494000
ATCCDFIN EQU   ISTATCVT+668                                             02495000
ATCCDFND EQU   ISTATCVT+664                                             02496000
ATCCDDEL EQU   ISTATCVT+660                                             02497000
ATCCDADD EQU   ISTATCVT+656                                             02498000
ATCTCLIM EQU   ISTATCVT+652                                             02499000
ATCRACTR EQU   ISTATCVT+648                                             02500000
ATCRACTI EQU   ISTATCVT+644                                             02501000
ATCREMOV EQU   ISTATCVT+640                                             02502000
ATCRACIO EQU   ISTATCVT+636                                             02503000
ATCADD   EQU   ISTATCVT+632                                             02504000
ATCPUCRT EQU   ISTATCVT+628                                             02505000
ATCSMRS  EQU   ISTATCVT+624                                             02506000
ATCSMRQ  EQU   ISTATCVT+620                                             02507000
ATCORCPX EQU   ISTATCVT+616                                             02508000
ATCORCAF EQU   ISTATCVT+612                                             02509000
ATCFRSTR EQU   ATCGTSTR                                                 02510000
ATCSTMA  EQU   ISTATCVT+604                                             02511000
ATCSRTAD EQU   ISTATCVT+600                                             02512000
ATCOCRT  EQU   ISTATCVT+596                                             02513000
ATCOCCFS EQU   ISTATCVT+592                                             02514000
ATCOCCFP EQU   ISTATCVT+588                                             02515000
ATCSRTDF EQU   ISTATCVT+584                                             02516000
ATCLUCRT EQU   ISTATCVT+580                                             02517000
ATCINCY5 EQU   ISTATCVT+576                                             02518000
ATCINCW3 EQU   ISTATCVT+572                                             02519000
ATCINCU6 EQU   ISTATCVT+568                                             02520000
ATCINCTQ EQU   ISTATCVT+564                                             02521000
ATCINCS1 EQU   ISTATCVT+560                                             02522000
ATCSRTAB EQU   ISTATCVT+556                                             02523000
ATCINCRD EQU   ISTATCVT+552                                             02524000
ATCINCPH EQU   ISTATCVT+548                                             02525000
ATCINCLQ EQU   ISTATCVT+544                                             02526000
ATCNOCRT EQU   ISTATCVT+540                                             02527000
ATCINCF1 EQU   ISTATCVT+536                                             02528000
ATCINCCI EQU   ISTATCVT+532                                             02529000
ATCINCCO EQU   ISTATCVT+528                                             02530000
ATCBLDLA EQU   ISTATCVT+524                                             02531000
ATCALOAD EQU   ISTATCVT+520                                             02532000
ATCADEL  EQU   ISTATCVT+516                                             02533000
ATCESC02 EQU   ISTATCVT+512                                             02534000
ATCESC01 EQU   ISTATCVT+508                                             02535000
ATCDEC01 EQU   ISTATCVT+504                                             02536000
ATCDEC00 EQU   ISTATCVT+500                                             02537000
ATCCPCRT EQU   ISTATCVT+496                                             02538000
ATCMSGM  EQU   ISTATCVT+492                                             02539000
ATCCPCFR EQU   ISTATCVT+488                                             02540000
ATCCPCGR EQU   ISTATCVT+484                                             02541000
ATCCPCPP EQU   ISTATCVT+480                                             02542000
ATCMSGP  EQU   ISTATCVT+476                                             02543000
ATCCPCNT EQU   ISTATCVT+472                                             02544000
ATCAUTHA EQU   ISTATCVT+468                                             02545000
ATCACCTA EQU   ISTATCVT+464                                             02546000
ATCAP39  EQU   ISTATCVT+460                                             02547000
ATCAP36  EQU   ISTATCVT+456                                             02548000
ATCAP35  EQU   ISTATCVT+452                                             02549000
ATCAP33  EQU   ISTATCVT+448                                             02550000
ATCAPCR5 EQU   ISTATCVT+444                                             02551000
ATCAICPT EQU   ISTATCVT+440                                             02552000
ATCAPI   EQU   ISTATCVT+436                                             02553000
ATCAICTN EQU   ISTATCVT+432                                             02554000
ATCACC01 EQU   ISTATCVT+428                                             02555000
ATCACC00 EQU   ISTATCVT+424                                             02556000
ATCLDECB EQU   ATCLDTIL+12                                              02557000
ATCLDLCK EQU   ATCLDTIL+8                                               02558000
ATCLDLST EQU   ATCLDTIL+4                                               02559000
ATCLDNCS EQU   ATCLDTIL                                                 02560000
ATCNOSPB EQU   ISTATCVT+376                                             02561000
ATCNSPAB EQU   ISTATCVT+344                                             02562000
ATCLUSRT EQU   ISTATCVT+312                                             02563000
ATCPUIOP EQU   ISTATCVT+280                                             02564000
ATCPUPAB EQU   ISTATCVT+248                                             02565000
ATCPXPAB EQU   ISTATCVT+216                                             02566000
ATCPOPAB EQU   ISTATCVT+184                                             02567000
@NM00061 EQU   ATCVDPAB+16                                              02568000
ATCFEPAB EQU   ATCVDPAB                                                 02569000
ATCTCIPB EQU   ISTATCVT+120                                             02570000
ATCCSPAB EQU   ATCSMPAB+16                                              02571000
@NM00060 EQU   ATCSMPAB                                                 02572000
ATCTMRPB EQU   ISTATCVT+56                                              02573000
ATCITPAB EQU   ISTATCVT+24                                              02574000
@NM00059 EQU   ATCITRA1                                                 02575000
ATCITSCP EQU   ATCITRA1                                                 02576000
ATCITMSG EQU   ATCITRA1                                                 02577000
ATCITPIU EQU   ATCITRA1                                                 02578000
ATCITSMS EQU   ATCITRA1                                                 02579000
ATCITPSS EQU   ATCITRA1                                                 02580000
ATCITLCK EQU   ATCITRA1                                                 02581000
ATCITAPI EQU   ATCITRA1                                                 02582000
ATCITCNT EQU   ATCITFLG                                                 02583000
ATCITRPH EQU   ATCITCDS                                                 02584000
ATCITTBL EQU   ATCITFLD+4                                               02585000
ATCITPRM EQU   ATCITFLD                                                 02586000
ATCPTCHA EQU   ATCRPTCH+4                                               02587000
ATCVTLVL EQU   ATCRPTCH                                                 02588000
RPHUPSTA EQU   ISTRPH+104                                               02589000
RPHSAV16 EQU   RPHWORK+60                                               02590000
RPHSAV15 EQU   RPHWORK+56                                               02591000
RPHSAV14 EQU   RPHWORK+52                                               02592000
RPHSAV13 EQU   RPHWORK+48                                               02593000
RPHSAV12 EQU   RPHWORK+44                                               02594000
RPHSAV11 EQU   RPHWORK+40                                               02595000
RPHSAV10 EQU   RPHWORK+36                                               02596000
RPHSAVE9 EQU   RPHWORK+32                                               02597000
RPHSAVE8 EQU   RPHWORK+28                                               02598000
RPHSAVE7 EQU   RPHWORK+24                                               02599000
RPHSAVE6 EQU   RPHWORK+20                                               02600000
RPHSAVE5 EQU   RPHWORK+16                                               02601000
RPHSAVE4 EQU   RPHWORK+12                                               02602000
RPHSAVE3 EQU   RPHWORK+8                                                02603000
RPHSAVE2 EQU   RPHWORK+4                                                02604000
RPHSHALF EQU   RPHSAVE1+2                                               02605000
RPHSBIT8 EQU   RPHSBITS                                                 02606000
RPHSBIT7 EQU   RPHSBITS                                                 02607000
RPHSBIT6 EQU   RPHSBITS                                                 02608000
RPHSBIT5 EQU   RPHSBITS                                                 02609000
RPHSBIT4 EQU   RPHSBITS                                                 02610000
RPHSBIT3 EQU   RPHSBITS                                                 02611000
RPHSBIT2 EQU   RPHSBITS                                                 02612000
RPHSBIT1 EQU   RPHSBITS                                                 02613000
RPHSBYTE EQU   RPHSAVE1                                                 02614000
RPHPABQP EQU   RPHPABQA+1                                               02615000
RPHPABFG EQU   RPHPABQA                                                 02616000
RPHCRR   EQU   ISTRPH+32                                                02617000
RPHSRP34 EQU   RPHSRPRM+2                                               02618000
RPHSRP12 EQU   RPHSRPRM                                                 02619000
RPHWEGT  EQU   RPHCSPA                                                  02620000
RPHMAJCB EQU   ISTRPH+21                                                02621000
RPHPABOF EQU   ISTRPH+20                                                02622000
RPHRESUM EQU   RPHRESMA+1                                               02623000
@NM00058 EQU   RPHWPFLG                                                 02624000
RPHPURGE EQU   RPHWPFLG                                                 02625000
RPHPT    EQU   RPHWPFLG                                                 02626000
RPHWT    EQU   RPHWPFLG                                                 02627000
RPHRSKEY EQU   RPHWPFLG                                                 02628000
RPHDVTA  EQU   ISTRPH+12                                                02629000
RPHTIK   EQU   RPHTSKID+3                                               02630000
@NM00057 EQU   RPHTSKID                                                 02631000
RPHRPHAP EQU   RPHRPHA+1                                                02632000
@NM00056 EQU   RPHRPHA                                                  02633000
RPHGATE  EQU   RPHRPHA                                                  02634000
RPHABEND EQU   RPHFLGB                                                  02635000
RPHUWAIT EQU   RPHFLGB                                                  02636000
RPHRLCRA EQU   RPHFLGB                                                  02637000
@NM00055 EQU   RPHFLGB                                                  02638000
RPHPGCMP EQU   RPHFLGB                                                  02639000
RPHFBAPS EQU   RPHFLGB                                                  02640000
RPHBSSP  EQU   RPHFLGB                                                  02641000
RPHLOCK  EQU   RPHFLGB                                                  02642000
RPHFNFLG EQU   RPHFSTLC                                                 02643000
RPHMLTCP EQU   RPHFLAGS                                                 02644000
RPHSMCLR EQU   RPHFLAGS                                                 02645000
RPHSMTYP EQU   RPHFLAGS                                                 02646000
RPHSMQ   EQU   RPHFLAGS                                                 02647000
RPHAPTYP EQU   RPHFLAGS                                                 02648000
RPHSPGIN EQU   RPHFLAGS                                                 02649000
RPHOGIND EQU   RPHFLAGS                                                 02650000
RPHLNGTH EQU   RPHCNTL+1                                                02651000
RPHTYPE  EQU   RPHCNTL                                                  02652000
DYPPAB   EQU   ISTDYPAB+16                                              02653000
DYPOCRPH EQU   DYPPACMD                                                 02654000
DYPTSKID EQU   ISTDYPAB+8                                               02655000
DYPPACTB EQU   DYPCHAIN                                                 02656000
DYPFLGS  EQU   ISTDYPAB+2                                               02657000
DYPLNGTH EQU   ISTDYPAB+1                                               02658000
DYPTYPE  EQU   ISTDYPAB                                                 02659000
PABRPHA  EQU   PABRPHFG+1                                               02660000
PABNODQ  EQU   PABFLAGS                                                 02661000
PABINHBT EQU   PABFLAGS                                                 02662000
PABERLOK EQU   PABERRLK                                                 02663000
PABSSN   EQU   PABFLAGS                                                 02664000
PABDYNAM EQU   PABFLAGS                                                 02665000
PABXTND  EQU   PABFLAGS                                                 02666000
PABPRIOR EQU   PABFLAGS                                                 02667000
PABAPYP  EQU   PABFLAGS                                                 02668000
PABDVTA  EQU   ISTPAB+9                                                 02669000
PABOFFST EQU   ISTPAB+8                                                 02670000
PABCHNGP EQU   PABCHAIN+1                                               02671000
PABRSV02 EQU   PABCHAIN                                                 02672000
PABDELAY EQU   PABCHAIN                                                 02673000
PABQUED  EQU   PABRUNNG                                                 02674000
PABRESET EQU   PABCHAIN                                                 02675000
PABUNCON EQU   PABCHAIN                                                 02676000
PABCDP   EQU   PABCHAIN                                                 02677000
PABRESCH EQU   PABCHAIN                                                 02678000
PABCHNG  EQU   PABCHAIN                                                 02679000
PABWEQP  EQU   PABWEQA+1                                                02680000
PABRSV01 EQU   PABWEQA                                                  02681000
PABWEQG  EQU   PABWEQA                                                  02682000
LOKXCL   EQU   @NM00052                                                 02683000
LOKPRY   EQU   @NM00052                                                 02684000
@NM00053 EQU   @NM00052                                                 02685000
@NM00051 EQU   LOKCHNG                                                  02686000
LOKCT    EQU   ISTLOK                                                   02687000
ISTRETR7 EQU   ISTRETRG+4                                               02688000
ISTRETR6 EQU   ISTRETRG                                                 02689000
ISTRSV01 EQU   ISTAVT+42                                                02690000
ISTPDAVP EQU   ISTAVT+38                                                02691000
ISTVTTP  EQU   ISTAVT+36                                                02692000
ISTAGTWT EQU   ISTAVT+34                                                02693000
ISTATRT  EQU   ISTAVT+32                                                02694000
ISTARID  EQU   ISTAVT+30                                                02695000
ISTX1    EQU   ISTAVT+29                                                02696000
ISTPHNM  EQU   ISTAVT+24                                                02697000
ISTAPSEX EQU   ISTAVT+20                                                02698000
ISTVTTIK EQU   ISTAVT+18                                                02699000
AVTASID  EQU   ISTAVT+16                                                02700000
ISTAPSTA EQU   ISTAVT+12                                                02701000
ISTAS53  EQU   ISTAVT+8                                                 02702000
ISTAS49  EQU   ISTAVT+4                                                 02703000
ISTACVT  EQU   ISTAVT                                                   02704000
SVECC010 EQU   TOLTEPWA+3952                                            02705000
SVETC035 EQU   TOLTEPWA+3880                                            02706000
SVESC030 EQU   TOLTEPWA+3808                                            02707000
SVESC020 EQU   TOLTEPWA+3664                                            02708000
SVESC120 EQU   TOLTEPWA+3304                                            02709000
SVESC025 EQU   TOLTEPWA+3088                                            02710000
@NM00050 EQU   TOLTEPWA+2980                                            02711000
$RPLERR  EQU   TOLTEPWA+2977                                            02712000
@NM00049 EQU   TOLTEPWA+2976                                            02713000
$CEINT2  EQU   TOLTEPWA+2968                                            02714000
$CEINT1  EQU   TOLTEPWA+2964                                            02715000
$MSGGET  EQU   TOLTEPWA+2960                                            02716000
$ACQLIST EQU   TOLTEPWA+2956                                            02717000
$R4SAVE1 EQU   TOLTEPWA+2952                                            02718000
$CLSISS  EQU   TOLTEPWA+2950                                            02719000
$CLSCNT  EQU   TOLTEPWA+2948                                            02720000
$CUTABLE EQU   TOLTEPWA+2868                                            02721000
$BUFSZ2  EQU   TOLTEPWA+2864                                            02722000
$RESID2  EQU   TOLTEPWA+2860                                            02723000
$OLTCCW2 EQU   TOLTEPWA+2856                                            02724000
$ENDBFR2 EQU   TOLTEPWA+2852                                            02725000
$1STBFR2 EQU   TOLTEPWA+2848                                            02726000
$TECB2   EQU   TOLTEPWA+2844                                            02727000
$BUFSZ1  EQU   TOLTEPWA+2840                                            02728000
$RESID1  EQU   TOLTEPWA+2836                                            02729000
$OLTCCW1 EQU   TOLTEPWA+2832                                            02730000
$ENDBFR1 EQU   TOLTEPWA+2828                                            02731000
$1STBFR1 EQU   TOLTEPWA+2824                                            02732000
$TECB1   EQU   TOLTEPWA+2820                                            02733000
$WAITIME EQU   TOLTEPWA+2816                                            02734000
$TRTN#   EQU   TOLTEPWA+2815                                            02735000
$WIODEV  EQU   TOLTEPWA+2814                                            02736000
$R4SAVE  EQU   TOLTEPWA+2804                                            02737000
$PARTADR EQU   TOLTEPWA+2800                                            02738000
$TBSDATA EQU   TOLTEPWA+2796                                            02739000
$CTWIDTH EQU   TOLTEPWA+2795                                            02740000
$CTLINE  EQU   TOLTEPWA+2794                                            02741000
$APWIDTH EQU   TOLTEPWA+2793                                            02742000
$APLINE  EQU   TOLTEPWA+2792                                            02743000
$INDEX   EQU   $IMITX                                                   02744000
$UMXX    EQU   @NM00048+14                                              02745000
$NSXX    EQU   @NM00048+12                                              02746000
$ATACNT  EQU   $NSCNT                                                   02747000
$CTR     EQU   @NM00048+8                                               02748000
$ATAPTR  EQU   $NSPTR                                                   02749000
$DDRPTR  EQU   @NM00048                                                 02750000
$DTORESP EQU   TOLTEPWA+2712                                            02751000
$APNAME  EQU   TOLTEPWA+2704                                            02752000
$24SYMNE EQU   $24CATMG+4                                               02753000
$24DEVAD EQU   $24CATMG                                                 02754000
$24RTN#  EQU   $24FEMSG+8                                               02755000
$ESECTID EQU   $24FEMSG                                                 02756000
$24FLGS  EQU   TOLTEPWA+2680                                            02757000
$24SAVE2 EQU   TOLTEPWA+2676                                            02758000
$24SAVE1 EQU   TOLTEPWA+2672                                            02759000
$24UNADR EQU   TOLTEPWA+2668                                            02760000
$24SAV13 EQU   TOLTEPWA+2664                                            02761000
$24RETCD EQU   TOLTEPWA+2663                                            02762000
$CSPARE  EQU   $CFLGS                                                   02763000
ROOTLOC  EQU   TOLTEPWA+2640                                            02764000
$RETREG  EQU   TOLTEPWA+2636                                            02765000
$WORK    EQU   TOLTEPWA+2376                                            02766000
$EXTA    EQU   TOLTEPWA+2320                                            02767000
$PASSONA EQU   TOLTEPWA+2264                                            02768000
$TRMINPT EQU   TOLTEPWA+2184                                            02769000
$INBUFR  EQU   TOLTEPWA+2104                                            02770000
$BUFFER  EQU   TOLTEPWA+1976                                            02771000
$TLTRPL3 EQU   TOLTEPWA+1856                                            02772000
$TLTRPL2 EQU   TOLTEPWA+1736                                            02773000
$TLTRPL1 EQU   TOLTEPWA+1616                                            02774000
@NM00047 EQU   $SLTBL+135                                               02775000
$HIGHRTN EQU   $SLTBL+134                                               02776000
$PRIMADR EQU   $SLTBL+130                                               02777000
$CTSTPT  EQU   $SLTBL+128                                               02778000
$TSTCNT  EQU   $SLTBL+126                                               02779000
$SECFLGS EQU   $SECLST+3                                                02780000
$SECTION EQU   $SECLST                                                  02781000
$SECACT  EQU   $TESTFLG                                                 02782000
$CANTRUN EQU   $TESTFLG                                                 02783000
$FINAL   EQU   $TESTFLG                                                 02784000
$TESTSUF EQU   $RUNTEST+5                                               02785000
$TESTNUM EQU   $RUNTEST+1                                               02786000
$LETPRF  EQU   $RUNTEST                                                 02787000
$SYMBOLC EQU   $SLTBL+5                                                 02788000
$FAMILY  EQU   $SLTBL                                                   02789000
$CDEVPT  EQU   TOLTEPWA+1466                                            02790000
$FEEDBCK EQU   $DEVTBLE+66                                              02791000
$WTISUED EQU   $DEVFLG4                                                 02792000
$EXIOISD EQU   $DEVFLG4                                                 02793000
$REMWRIT EQU   $DEVFLG4                                                 02794000
$REMDONE EQU   $DEVFLG4                                                 02795000
$2NDUSED EQU   $DEVFLG4                                                 02796000
$1STUSED EQU   $DEVFLG4                                                 02797000
$IGLXIFB EQU   $DEVFLG4                                                 02798000
$EXIOLV3 EQU   $DEVFLG4                                                 02799000
@NM00046 EQU   $DEVFLG5                                                 02800000
$DVBASIC EQU   $DEVFLG5                                                 02801000
$ASCII   EQU   $DEVFLG5                                                 02802000
$DEVLU   EQU   $DEVFLG5                                                 02803000
$OPNDFAL EQU   $DEVFLG5                                                 02804000
$ACQNCB  EQU   $DEVFLG5                                                 02805000
$REMOTE  EQU   $DEVFLG5                                                 02806000
$ENDNODE EQU   $DEVFLG5                                                 02807000
$CID     EQU   $DEVTBLE+52                                              02808000
$DVCOL   EQU   $LDNCBPT+2                                               02809000
$DVROW   EQU   $LDNCBPT                                                 02810000
$NCSPLP  EQU   $DEVTBLE+44                                              02811000
$DVLN    EQU   $SSCPDAF                                                 02812000
$DAF     EQU   $DEVSESP+4                                               02813000
$VARYPAB EQU   $DEVSESP                                                 02814000
$SYSMN   EQU   $DEVTBLE+28                                              02815000
@NM00045 EQU   $DEVFLG3                                                 02816000
$CLRSNT  EQU   $DEVFLG3                                                 02817000
$OLTERR  EQU   $DEVFLG3                                                 02818000
$SRTEST  EQU   $DEVFLG3                                                 02819000
$DVSNDOK EQU   $SIOFLG                                                  02820000
$POLLREQ EQU   $DEVFLG3                                                 02821000
$ACQRED  EQU   $DEVFLG3                                                 02822000
$NOTDEV  EQU   $DEVFLG3                                                 02823000
$DVINCT  EQU   $DEVTBLE+26                                              02824000
$DVBRKST EQU   $OPND+1                                                  02825000
$DVBRKSN EQU   $OPND                                                    02826000
$DVSEQNO EQU   $OPIS                                                    02827000
$CEINTRP EQU   $DEVFLG2                                                 02828000
$DEVALOC EQU   $DEVFLG2                                                 02829000
$ALLDATA EQU   $DEVFLG2                                                 02830000
$ENDCNTL EQU   $DEVFLG2                                                 02831000
$CTLDEV  EQU   $DEVFLG2                                                 02832000
$NOCDS   EQU   $DEVFLG2                                                 02833000
$DATAIN  EQU   $DEVFLG2                                                 02834000
$PRIMARY EQU   $DEVFLG1                                                 02835000
$DVCTBYT EQU   $INTOCC                                                  02836000
$DEVACT  EQU   $DEVFLG1                                                 02837000
$DVLGMDE EQU   $ATTNEXP                                                 02838000
$DVSPRM  EQU   $EVNCPLT                                                 02839000
$GRABBED EQU   $DEVFLG1                                                 02840000
$CATASTR EQU   $DEVFLG1                                                 02841000
$LETGO   EQU   $DEVFLG1                                                 02842000
$CURELEM EQU   $$SYMNME+4                                               02843000
$MSGOTSD EQU   $$SYMNME                                                 02844000
$EXTDEV  EQU   $DEVCDS+11                                               02845000
@NM00044 EQU   $DEVSDCF                                                 02846000
$NOTPRIM EQU   $DEVSDCF                                                 02847000
@NM00043 EQU   $DEVCDSF                                                 02848000
@NM00042 EQU   $DEVCDSF                                                 02849000
@NM00041 EQU   $DEVCDSF                                                 02850000
$CDSNAME EQU   $DEVCDSF                                                 02851000
$EXTRN   EQU   $DEVCDSF                                                 02852000
$CEVOLUM EQU   $DEVCDSF                                                 02853000
$SHARD   EQU   $DEVCDSF                                                 02854000
$DEVFPM  EQU   $DEVCDSF                                                 02855000
$DEVCNT  EQU   $DEVCDS+8                                                02856000
$DEVTYPE EQU   $DEVFEAT+3                                               02857000
$DEVCLAS EQU   $DEVFEAT+2                                               02858000
$DEVFRRS EQU   $DEVFEAT+1                                               02859000
$DEVMOD  EQU   $DEVFEAT                                                 02860000
$DEVRDGT EQU   @NM00039+1                                               02861000
$DEVCTLU EQU   @NM00039+1                                               02862000
$DEVCHAN EQU   @NM00039                                                 02863000
@NM00040 EQU   @NM00039                                                 02864000
$CTINDX  EQU   $DEVUNAD                                                 02865000
$FLAG16  EQU   $COMMFLG+15                                              02866000
$FLAG15  EQU   $COMMFLG+14                                              02867000
$FLAG14  EQU   $COMMFLG+13                                              02868000
$CATMSG  EQU   $FLAG13                                                  02869000
$PRMPTSW EQU   $FLAG13                                                  02870000
$DEVENT  EQU   $FLAG13                                                  02871000
$CTLOGON EQU   $FLAG13                                                  02872000
@NM00038 EQU   $FLAG12                                                  02873000
$VRYHRD  EQU   $FLAG12                                                  02874000
$VRYSFT  EQU   $FLAG12                                                  02875000
$OPTMSG  EQU   $FLAG12                                                  02876000
$FEORCAT EQU   $FLAG11                                                  02877000
@NM00037 EQU   $FLAG11                                                  02878000
@NM00036 EQU   $FLAG10                                                  02879000
$DPRINT  EQU   $FLAG10                                                  02880000
@NM00035 EQU   $FLAG9                                                   02881000
$COPY    EQU   $FLAG9                                                   02882000
$LSTLNSW EQU   $FLAG9                                                   02883000
$MULLNSW EQU   $FLAG9                                                   02884000
$REMSW   EQU   $FLAG9                                                   02885000
$IGRES   EQU   $FLAG9                                                   02886000
$VS2     EQU   $FLAG8                                                   02887000
$VS1     EQU   $FLAG8                                                   02888000
$EDOS    EQU   $FLAG8                                                   02889000
@NM00034 EQU   $FLAG8                                                   02890000
@NM00033 EQU   $FLAG8                                                   02891000
$RCVMSG  EQU   $FLAG7                                                   02892000
$LDOIS   EQU   $FLAG7                                                   02893000
$DCONTCT EQU   $FLAG7                                                   02894000
$2NDDATA EQU   $FLAG7                                                   02895000
$1STDATA EQU   $FLAG7                                                   02896000
$FSTMCIS EQU   $FLAG6                                                   02897000
$DISCREQ EQU   $FLAG6                                                   02898000
$DISCISS EQU   $FLAG6                                                   02899000
$CHANGE  EQU   $FLAG6                                                   02900000
$CTERROR EQU   $FLAG6                                                   02901000
@NM00032 EQU   $FLAG5                                                   02902000
$PROGCK  EQU   $CANCEL                                                  02903000
$PRINTAP EQU   $FLAG5                                                   02904000
@NM00031 EQU   $FLAG5                                                   02905000
$MSG922  EQU   $FLAG5                                                   02906000
$CT924   EQU   $FLAG5                                                   02907000
$FSTCAT  EQU   $FLAG5                                                   02908000
$FSTFE   EQU   $FLAG5                                                   02909000
$ACQCUTT EQU   $FLAG4                                                   02910000
$BACKINT EQU   $FLAG4                                                   02911000
$DMSGSW  EQU   $FLAG4                                                   02912000
$TSTDEVP EQU   $FLAG4                                                   02913000
$APRQPER EQU   $FLAG4                                                   02914000
$OPCOM   EQU   $FLAG4                                                   02915000
$NEWAP   EQU   $FLAG3                                                   02916000
$ALTPRTR EQU   $FLAG3                                                   02917000
$OPTERR  EQU   $FLAG3                                                   02918000
$TSTERR  EQU   $FLAG3                                                   02919000
$DEVERR  EQU   $FLAG3                                                   02920000
$PARTIAL EQU   $FLAG2                                                   02921000
$NRMTERM EQU   $FLAG2                                                   02922000
$VALDTST EQU   $FLAG2                                                   02923000
$VALDDEV EQU   $FLAG2                                                   02924000
$DBLSLSH EQU   $FLAG2                                                   02925000
$NDR     EQU   $FLAG2                                                   02926000
@NM00030 EQU   $FLAG2                                                   02927000
$FTTHR   EQU   $FLAG2                                                   02928000
$NORELDV EQU   $FLAG1                                                   02929000
@NM00029 EQU   $FLAG1                                                   02930000
$OPTCHNG EQU   $FLAG1                                                   02931000
$DEVCHNG EQU   $FLAG1                                                   02932000
$TESTCNG EQU   $FLAG1                                                   02933000
$CNSLFG  EQU   $FLAG1                                                   02934000
@NM00028 EQU   $CDA+120                                                 02935000
$CUCNT   EQU   $CDA+118                                                 02936000
@NM00027 EQU   $CDA+117                                                 02937000
$PRTFORM EQU   $CDA+116                                                 02938000
$OPISCNT EQU   $CDA+114                                                 02939000
$OPNDCNT EQU   $CDA+112                                                 02940000
$GETMSZE EQU   $CDA+110                                                 02941000
$GRCNTS  EQU   $CDA+108                                                 02942000
$CTLCNT  EQU   $CDA+106                                                 02943000
$ACTLVL  EQU   $CDA+105                                                 02944000
$PRNTLVL EQU   $CDA+104                                                 02945000
$ERRCNTA EQU   $CDA+102                                                 02946000
$TLCNT   EQU   $CDA+100                                                 02947000
$TIMEALW EQU   $CDA+96                                                  02948000
$PTRAREA EQU   $CDA+92                                                  02949000
$GETMPTR EQU   $CDA+88                                                  02950000
$TEPEND  EQU   $CDA+76                                                  02951000
$PLINKDL EQU   $CDA+72                                                  02952000
$TEPBEGN EQU   $CDA+68                                                  02953000
$FRELPTR EQU   $CDA+64                                                  02954000
$HIGHADR EQU   $HIMOREC                                                 02955000
$LOMOREC EQU   $CDA+56                                                  02956000
$LOWADDR EQU   $OLTPTR                                                  02957000
$ENDCOMM EQU   $CDA+48                                                  02958000
$COMMON  EQU   $RCA                                                     02959000
$SLASHAD EQU   $CDA+32                                                  02960000
$PASSON  EQU   $CDA+28                                                  02961000
$TOLBRTB EQU   $CDA+24                                                  02962000
$SCTPTR8 EQU   $CDA+20                                                  02963000
$SCTPTR  EQU   $CDA+16                                                  02964000
$TBWDPTR EQU   $CDA+12                                                  02965000
@NM00026 EQU   $CDA                                                     02966000
@NM00025 EQU   $SCTTBLE+98                                              02967000
$SCTLWTC EQU   $SCTTBLE+96                                              02968000
$SCTLWTA EQU   $SCTTBLE+92                                              02969000
#EXT     EQU   $SCTTBLE+88                                              02970000
#PASS    EQU   $SCTTBLE+84                                              02971000
#TABLE   EQU   $SCTTBLE+80                                              02972000
#MSGIDAC EQU   $SCTTBLE+78                                              02973000
@NM00024 EQU   $SCTTBLE+71                                              02974000
$RETMASK EQU   $SCTTBLE+70                                              02975000
$R249255 EQU   $ROUTMSK+29                                              02976000
$R241248 EQU   $ROUTMSK+28                                              02977000
$R233240 EQU   $ROUTMSK+27                                              02978000
$R225232 EQU   $ROUTMSK+26                                              02979000
$R217224 EQU   $ROUTMSK+25                                              02980000
$R209216 EQU   $ROUTMSK+24                                              02981000
$R201208 EQU   $ROUTMSK+23                                              02982000
$R193200 EQU   $ROUTMSK+22                                              02983000
$R185192 EQU   $ROUTMSK+21                                              02984000
$R177184 EQU   $ROUTMSK+20                                              02985000
$R169176 EQU   $ROUTMSK+19                                              02986000
$R161168 EQU   $ROUTMSK+18                                              02987000
$R153160 EQU   $ROUTMSK+17                                              02988000
$R145152 EQU   $ROUTMSK+16                                              02989000
$R137144 EQU   $ROUTMSK+15                                              02990000
$R129136 EQU   $ROUTMSK+14                                              02991000
$R121128 EQU   $ROUTMSK+13                                              02992000
$R113120 EQU   $ROUTMSK+12                                              02993000
$R105112 EQU   $ROUTMSK+11                                              02994000
$R097104 EQU   $ROUTMSK+10                                              02995000
$R089096 EQU   $ROUTMSK+9                                               02996000
$R081088 EQU   $ROUTMSK+8                                               02997000
$R073080 EQU   $ROUTMSK+7                                               02998000
$R065072 EQU   $ROUTMSK+6                                               02999000
$R057064 EQU   $ROUTMSK+5                                               03000000
$R049056 EQU   $ROUTMSK+4                                               03001000
$R041048 EQU   $ROUTMSK+3                                               03002000
$R033040 EQU   $ROUTMSK+2                                               03003000
$R025032 EQU   $ROUTMSK+1                                               03004000
$R017024 EQU   $ROUTMSK                                                 03005000
$TOTFLG2 EQU   $SCTTBLE+39                                              03006000
@NM00023 EQU   $TOTFLG1                                                 03007000
@NM00022 EQU   $TOTFLG1                                                 03008000
@NM00021 EQU   $TOTFLG1                                                 03009000
$CURELOD EQU   $TOTFLG1                                                 03010000
$CTEQTT  EQU   $TOTFLG1                                                 03011000
@NM00020 EQU   $TOTFLG1                                                 03012000
@NM00019 EQU   $TOTFLG1                                                 03013000
$LINESHR EQU   $TOTFLG1                                                 03014000
@NM00018 EQU   $OLTFLG2                                                 03015000
@NM00017 EQU   $OLTFLG2                                                 03016000
@NM00016 EQU   $OLTFLG2                                                 03017000
@NM00015 EQU   $OLTFLG2                                                 03018000
@NM00014 EQU   $OLTFLG2                                                 03019000
@NM00013 EQU   $OLTFLG2                                                 03020000
@NM00012 EQU   $OLTFLG2                                                 03021000
$TALK    EQU   $OLTFLG2                                                 03022000
$DYCOM   EQU   $OLTFLGS                                                 03023000
@NM00011 EQU   $OLTFLGS                                                 03024000
$TRACE   EQU   $OLTFLGS                                                 03025000
$RETCODE EQU   $OLTFLGS                                                 03026000
$CONTCB  EQU   $OLTFLGS                                                 03027000
$RETAIN  EQU   $OLTFLGS                                                 03028000
$CLEANRT EQU   $OLTFLGS                                                 03029000
$MANINTV EQU   $OLTFLGS                                                 03030000
$OLTSIZE EQU   $SCTTBLE+34                                              03031000
$QSCTMOD EQU   $EXECFLG                                                 03032000
$CTRLMOD EQU   $EXECFLG                                                 03033000
$LSTPDEV EQU   $EXECFLG                                                 03034000
$ERRCNT  EQU   $EXECFLG                                                 03035000
$RTNSLCT EQU   $EXECFLG                                                 03036000
$MULTDEV EQU   $EXECFLG                                                 03037000
@NM00010 EQU   $EXECFLG                                                 03038000
$RMSKCNT EQU   $SCTTBLE+32                                              03039000
$SYNAME  EQU   $CDS8T19+4                                               03040000
$EXTSIG  EQU   $CDS8T19+3                                               03041000
$CDFLGS  EQU   $CDS8T19+1                                               03042000
$CDSCNT  EQU   $CDS8T19                                                 03043000
$PDEVDSC EQU   $SCTTBLE+16                                              03044000
$PDEVADR EQU   $SCTTBLE+12                                              03045000
$COMMCN  EQU   $CDSFLGS                                                 03046000
$CUSTSYM EQU   $CDSFLGS                                                 03047000
$TWOCHSW EQU   $CDSFLGS                                                 03048000
$SYMNAME EQU   $CDSFLGS                                                 03049000
$EXTINTC EQU   $CDSFLGS                                                 03050000
$CEVOL   EQU   $CDSFLGS                                                 03051000
$SHARED  EQU   $CDSFLGS                                                 03052000
$FPM     EQU   $CDSFLGS                                                 03053000
$LASTSUB EQU   $PDEVFLG                                                 03054000
@NM00009 EQU   $PDEVFLG                                                 03055000
@NM00008 EQU   $PDEVFLG                                                 03056000
@NM00007 EQU   $PDEVFLG                                                 03057000
$LASTDEV EQU   $PDEVFLG                                                 03058000
@NM00006 EQU   $PDEVFLG                                                 03059000
$EXFILPT EQU   $PDEVFLG                                                 03060000
$FPMOLD  EQU   $PDEVFLG                                                 03061000
$TSSSYM  EQU   $SCTTBLE+8                                               03062000
$SCTLEVL EQU   $SCTTBLE+7                                               03063000
$DRIVER  EQU   $SCTTBLE+6                                               03064000
$RT0916  EQU   $SCTTBLE+5                                               03065000
$RT0108  EQU   $SCTTBLE+4                                               03066000
$LOOPTST EQU   $ERROPT                                                  03067000
$LOOPERR EQU   $ERROPT                                                  03068000
$NERRPRT EQU   $ERROPT                                                  03069000
$NOCNTRL EQU   $ERROPT                                                  03070000
$ALTPRNT EQU   $ERROPT                                                  03071000
$CATERR  EQU   $ERROPT                                                  03072000
$ASTERIK EQU   $ERROPT                                                  03073000
$TESTERR EQU   $ERROPT                                                  03074000
$FSTCOMM EQU   $TESTOPT                                                 03075000
$INDEFLP EQU   $TESTOPT                                                 03076000
$NOPRT   EQU   $TESTOPT                                                 03077000
$PARAPRT EQU   $TESTOPT                                                 03078000
@NM00005 EQU   $TESTOPT                                                 03079000
$ERRLPCT EQU   $SCTTBLE                                                 03080000
$TLTEND  EQU   $RCAAREA+945                                             03081000
$CNSLID  EQU   $RCAAREA+936                                             03082000
$EXITSAV EQU   $RCAAREA+864                                             03083000
$TRASCII EQU   $RCAAREA+608                                             03084000
@NM00004 EQU   $RCAAREA+605                                             03085000
$VTAMEND EQU   $RCAFLG                                                  03086000
$TPPOSTD EQU   $RCAFLG                                                  03087000
$NEWCT   EQU   $RCAFLG                                                  03088000
$ABNDALL EQU   $RCAFLG                                                  03089000
$CONSOLE EQU   $RCAFLG                                                  03090000
$TPLOGON EQU   $RCAFLG                                                  03091000
$DEVAREA EQU   $RCAAREA+600                                             03092000
$CTDVAR  EQU   $RCAAREA+596                                             03093000
$BUFFS   EQU   $RCAAREA+464                                             03094000
$TLTNIB  EQU   $CONSTNT+140                                             03095000
$TLTPRPL EQU   $CONSTNT+20                                              03096000
@NM00003 EQU   $CONSTNT+4                                               03097000
@NM00002 EQU   $CONSTNT+2                                               03098000
$CTNAME  EQU   $POINTER+132                                             03099000
$CTARGX  EQU   $POINTER+128                                             03100000
$COMINT  EQU   $POINTER+120                                             03101000
$QUEHNDL EQU   $POINTER+116                                             03102000
@NM00001 EQU   $POINTER+36                                              03103000
$RTNPTR  EQU   $POINTER+32                                              03104000
$TLTECB1 EQU   $POINTER+24                                              03105000
$CVTSAVE EQU   $POINTER+4                                               03106000
$TLTACB  EQU   $RCAAREA                                                 03107000
.@UNREFD ANOP                          END UNREFERENCED COMPONENTS      03108000
@RT00129 EQU   C14C0002                                                 03109000
@RT00153 EQU   C14C0004                                                 03110000
@RT00168 EQU   C14C0035                                                 03111000
@RT00205 EQU   C14C006A                                                 03112000
@RT00209 EQU   C14C0004                                                 03113000
@RT00219 EQU   C14C006A                                                 03114000
@RF00219 EQU   C14C0007                                                 03115000
@RT00227 EQU   C14C006A                                                 03116000
@RT00280 EQU   C14C0033                                                 03117000
@RT00286 EQU   C14C0006                                                 03118000
@RT00295 EQU   C14C0005                                                 03119000
@RT00305 EQU   C14C0001                                                 03120000
@RT00333 EQU   C14C0011                                                 03121000
@RT00335 EQU   C14C0013                                                 03122000
@RT00341 EQU   C14C0011                                                 03123000
@RT00343 EQU   C14C0011                                                 03124000
@ENDDATA EQU   *                                                        03125000
         END   ISTCC014,(C'PLS2135',0702,79078)                         03126000
./  ADD  SSI=83351520,NAME=ISTCC015
         TITLE 'TABLE SEARCH - ISTCC015'                                00001000
* IBM DISK OPERATING SYSTEM                                             00002000
* TOLTEP - 5745-SCT-TLT                                                 00003000
         ISEQ 73,80                                                     00004000
ISTCC015 CSECT ,                                                   0002 00005000
@MAINENT DS    0H                                                  0002 00006000
         USING *,@15                                               0002 00007000
         B     @PROLOG                                             0002 00008000
         DC    AL1(16)                                             0002 00009000
         DC    C'ISTCC015  78.336'                                 0002 00010000
         DROP  @15                                                      00011000
@PROLOG  ST    @14,12(,@13)                                        0002 00012000
         STM   @02,@12,28(@13)                                     0002 00013000
         BALR  @12,0                                               0002 00014000
@PSTART  DS    0H                                                  0002 00015000
         USING @PSTART,@12                                         0002 00016000
         USING @DATD,R8                                                 00017000
*   TPQINPUT=TPQ1;                  /* INIT PARAM REGISTER           */ 00018000
         LR    TPQINPUT,TPQ1                                       0043 00019000
*   RCAPTR=TPQRCA;                  /* INIT RCAPTR                   */ 00020000
         L     RCAPTR,TPQRCA(,TPQINPUT)                            0044 00021000
*   REGSAV=WAPTR;                   /* SAVE CURRENT TWA PTR          */ 00022000
         LR    REGSAV,WAPTR                                        0045 00023000
*   IF FSTAREA¬=0                   /* INIT WORK AREA PTR            */ 00024000
*     THEN                                                         0046 00025000
         L     @15,FSTAREA(,RCAPTR)                                0046 00026000
         LTR   @15,@15                                             0046 00027000
         BZ    @RF00046                                            0046 00028000
*     WAPTR=FSTAREA;                                               0047 00029000
*                                                                  0047 00030000
         LR    WAPTR,@15                                           0047 00031000
*   /*****************************************************************/ 00032000
*   /*                                                               */ 00033000
*   /* CHECK INPUT CODE TO TABLE SEARCH                              */ 00034000
*   /*                                                               */ 00035000
*   /*****************************************************************/ 00036000
*                                                                  0048 00037000
*   R8=ADDR($TBSDATA);              /* SET UP COMPILER COVER REG     */ 00038000
@RF00046 LA    R8,$TBSDATA(,WAPTR)                                 0048 00039000
*   CODREG=TPCODE;                                                 0049 00040000
         SLR   CODREG,CODREG                                       0049 00041000
         IC    CODREG,TPCODE(,TPQINPUT)                            0049 00042000
*   IF CODREG>5                     /* CODE INVALID?                 */ 00043000
*     THEN                                                         0050 00044000
         C     CODREG,@CF00380                                     0050 00045000
         BNH   @RF00050                                            0050 00046000
*     RETURN CODE(8);                                              0051 00047000
         LA    @15,8                                               0051 00048000
@EL00001 DS    0H                                                  0051 00049000
@EF00001 DS    0H                                                  0051 00050000
@ER00001 L     @14,12(,@13)                                        0051 00051000
         LM    @02,@12,28(@13)                                     0051 00052000
         BR    @14                                                 0051 00053000
*   IF CODREG<3|                    /* CHECK CID AND SYMBOL CODES    */ 00054000
*       CODREG>4 THEN                                              0052 00055000
@RF00050 C     CODREG,@CF00112                                     0052 00056000
         BL    @RT00052                                            0052 00057000
         C     CODREG,@CF00100                                     0052 00058000
         BNH   @RF00052                                            0052 00059000
@RT00052 DS    0H                                                  0053 00060000
*     IF FSTAREA=0|                 /* FOR VALID CASES               */ 00061000
*         DAF=0 THEN                                               0053 00062000
         SLR   @15,@15                                             0053 00063000
         CL    @15,FSTAREA(,RCAPTR)                                0053 00064000
         BE    @RT00053                                            0053 00065000
         L     @14,TPQDATA(,TPQINPUT)                              0053 00066000
         SLR   @11,@11                                             0053 00067000
         ICM   @11,3,DAF(@14)                                      0053 00068000
         CR    @15,@11                                             0053 00069000
         BNE   @RF00053                                            0053 00070000
@RT00053 DS    0H                                                  0054 00071000
*       RETURN CODE(4);                                            0054 00072000
         LA    @15,4                                               0054 00073000
         L     @14,12(,@13)                                        0054 00074000
         LM    @02,@12,28(@13)                                     0054 00075000
         BR    @14                                                 0054 00076000
*   CODREG=CODREG+1;                /* USE BRANCHING TABLE           */ 00077000
@RF00053 DS    0H                                                  0055 00078000
@RF00052 AL    CODREG,@CF00033                                     0055 00079000
*   GOTO TAB(CODREG);               /* GOTO SUBROUTINE               */ 00080000
         LR    @15,CODREG                                          0056 00081000
         SLA   @15,2                                               0056 00082000
         L     @15,TAB-4(@15)                                      0056 00083000
         BR    @15                                                 0056 00084000
*                                                                  0057 00085000
*   /*****************************************************************/ 00086000
*   /*                                                               */ 00087000
*   /* THIS SUBROUTINE SEARCHES FOR A MATCH ON $SYMNAM. IT IS INVOKED*/ 00088000
*   /* BY PASSING A CODE OF 0                                        */ 00089000
*   /*                                                               */ 00090000
*   /*****************************************************************/ 00091000
*                                                                  0057 00092000
*C15C0000:                                                         0057 00093000
*   ;                                                              0057 00094000
C15C0000 DS    0H                                                  0058 00095000
*C15C0002:                                                         0058 00096000
*   ;                                                              0058 00097000
C15C0002 DS    0H                                                  0059 00098000
*   I=$DEVCNTS;                     /* INITIALIZE COUNTER            */ 00099000
         LH    I,$DEVCNTS(,WAPTR)                                  0059 00100000
*C15C0005:                                                         0060 00101000
*   ;                                                              0060 00102000
C15C0005 DS    0H                                                  0061 00103000
*   IF I=0                          /* IF 0 NO MORE DEVICES          */ 00104000
*     THEN                                                         0061 00105000
         LTR   I,I                                                 0061 00106000
         BZ    @RT00061                                            0061 00107000
*     GOTO C15C0010;                /* CK NEXT WORK AREA             */ 00108000
*   IF $NOTDEV(I)='1'B              /* IS THIS A DEVICE TO CHECK     */ 00109000
*     THEN                                                         0063 00110000
         LR    @15,I                                               0063 00111000
         MH    @15,@CH00405                                        0063 00112000
         ST    @15,@TF00001                                        0063 00113000
         ALR   @15,WAPTR                                           0063 00114000
         TM    $NOTDEV-68(@15),B'10000000'                         0063 00115000
         BO    @RT00063                                            0063 00116000
*     GOTO C15C0007;                                               0064 00117000
*   IF SYM=$SYSMN(I)                /* SYMBOL FOUND?                 */ 00118000
*     THEN                                                         0065 00119000
         L     @15,TPQDATA(,TPQINPUT)                              0065 00120000
         LR    @14,WAPTR                                           0065 00121000
         AL    @14,@TF00001                                        0065 00122000
         CLC   SYM(8,@15),$SYSMN-68(@14)                           0065 00123000
         BNE   @RF00065                                            0065 00124000
*     DO;                           /* YES                           */ 00125000
*C15C0RT0:                                                         0067 00126000
*       ;                                                          0067 00127000
C15C0RT0 DS    0H                                                  0068 00128000
*       TPQ1=WAPTR;                 /* R1 PTS TO WORK AREA           */ 00129000
         LR    TPQ1,WAPTR                                          0068 00130000
*       RETURN CODE(0);             /* RETURN CODE = 0               */ 00131000
         SLR   @15,@15                                             0069 00132000
         L     @14,12(,@13)                                        0069 00133000
         LM    @02,@12,28(@13)                                     0069 00134000
         BR    @14                                                 0069 00135000
*     END;                                                         0070 00136000
*   ELSE                                                           0071 00137000
*     DO;                                                          0071 00138000
@RF00065 DS    0H                                                  0072 00139000
*C15C0007:                                                         0072 00140000
*       ;                                                          0072 00141000
C15C0007 DS    0H                                                  0073 00142000
*       I=I-1;                      /* INCREMENT COUNTER             */ 00143000
         BCTR  I,0                                                 0073 00144000
*       GOTO C15C0005;                                             0074 00145000
         B     C15C0005                                            0074 00146000
*     END;                                                         0075 00147000
*C15C0010:                                                         0076 00148000
*   ;                                                              0076 00149000
C15C0010 DS    0H                                                  0077 00150000
*   IF TFWDPTR=0                    /* ANY MORE WORK AREAS ?         */ 00151000
*     THEN                                                         0077 00152000
         L     @15,TFWDPTR(,WAPTR)                                 0077 00153000
         LTR   @15,@15                                             0077 00154000
         BNZ   @RF00077                                            0077 00155000
*     RETURN CODE(4);               /* NO                            */ 00156000
         LA    @15,4                                               0078 00157000
         L     @14,12(,@13)                                        0078 00158000
         LM    @02,@12,28(@13)                                     0078 00159000
         BR    @14                                                 0078 00160000
*   WAPTR=TFWDPTR;                  /* UPDATE WORK PTR               */ 00161000
@RF00077 L     WAPTR,TFWDPTR(,WAPTR)                               0079 00162000
*   GOTO C15C0002;                                                 0080 00163000
         B     C15C0002                                            0080 00164000
*                                                                  0081 00165000
*   /*****************************************************************/ 00166000
*   /*                                                               */ 00167000
*   /* THIS SUBROUTINE SEARCHES FOR A MATCH ON $CID. IT IS INVOKED BY*/ 00168000
*   /* PASSING A CODE OF 1                                           */ 00169000
*   /*                                                               */ 00170000
*   /*****************************************************************/ 00171000
*                                                                  0081 00172000
*C15C0100:                                                         0081 00173000
*   ;                                                              0081 00174000
C15C0100 DS    0H                                                  0082 00175000
*   RETURN CODE(8);                 /* NOT SUPPORTED         @D32JPPW*/ 00176000
*                                                                  0082 00177000
         LA    @15,8                                               0082 00178000
         L     @14,12(,@13)                                        0082 00179000
         LM    @02,@12,28(@13)                                     0082 00180000
         BR    @14                                                 0082 00181000
*   /*****************************************************************/ 00182000
*   /*                                                               */ 00183000
*   /* THIS SUBROUTINE SEARCHES FOR A MATCH ON $SYSMN. IF THE WORK   */ 00184000
*   /* AREA IS THE CURRENT USER'S, THE NEXT WORK AREA WILL BE        */ 00185000
*   /* SEARCHED FOR A MATCH                                          */ 00186000
*   /*                                                               */ 00187000
*   /*****************************************************************/ 00188000
*                                                                  0083 00189000
*C15C0200:                                                         0083 00190000
*   ;                                                              0083 00191000
C15C0200 DS    0H                                                  0084 00192000
*   IF LNAME¬=BLANKS                /* IF LOCAL DO NOT TEST          */ 00193000
*     THEN                                                         0084 00194000
         L     @15,TPQDATA(,TPQINPUT)                              0084 00195000
         CLC   LNAME(8,@15),BLANKS                                 0084 00196000
         BE    @RF00084                                            0084 00197000
*     DO;                           /* FOR LINE CONFLICT             */ 00198000
*       WAPTR=REGSAV;               /* POINT TO CURRENT TWA          */ 00199000
         LR    WAPTR,REGSAV                                        0086 00200000
*       IF $CTEQTT='0'B THEN        /* IF CT NOT = TT                */ 00201000
         TM    $CTEQTT(WAPTR),B'00010000'                          0087 00202000
         BNZ   @RF00087                                            0087 00203000
*         DO;                       /* TEST FOR LINE CONFLICT        */ 00204000
*           WAPTR=FSTAREA;          /* PNT TO 1ST TWA                */ 00205000
         L     WAPTR,FSTAREA(,RCAPTR)                              0089 00206000
*           DO WHILE WAPTR¬=0;      /* LOOP THRU ALL TWAS            */ 00207000
         B     @DE00090                                            0090 00208000
@DL00090 DS    0H                                                  0091 00209000
*             IF WAPTR¬=REGSAV THEN /* SKIP TEST FOR CURR TWA        */ 00210000
         CR    WAPTR,REGSAV                                        0091 00211000
         BE    @RF00091                                            0091 00212000
*               DO;                                                0092 00213000
*                 IF LNAME=$LINENME(1)/* REQUESTED TT ON SAME        */ 00214000
*                   THEN            /* ANOTHER USER CT               */ 00215000
         L     @15,TPQDATA(,TPQINPUT)                              0093 00216000
         CLC   LNAME(8,@15),$LINENME(WAPTR)                        0093 00217000
         BNE   @RF00093                                            0093 00218000
*                   DO;                                            0094 00219000
*                     IF $CTEQTT¬='0'B/* THAT IS NOT CT=TT           */ 00220000
*                       THEN                                       0095 00221000
         TM    $CTEQTT(WAPTR),B'00010000'                          0095 00222000
         BZ    @RF00095                                            0095 00223000
*                       RETURN CODE(12);                           0096 00224000
         LA    @15,12                                              0096 00225000
         L     @14,12(,@13)                                        0096 00226000
         LM    @02,@12,28(@13)                                     0096 00227000
         BR    @14                                                 0096 00228000
*                   END;            /* FLAG REQUEST WITH RC 12       */ 00229000
@RF00095 DS    0H                                                  0098 00230000
*               END;                                               0098 00231000
@RF00093 DS    0H                                                  0099 00232000
*             WAPTR=$TFWDPTR;       /* POINT TO NEXT TWA             */ 00233000
@RF00091 L     WAPTR,$TFWDPTR(,WAPTR)                              0099 00234000
*           END;                                                   0100 00235000
@DE00090 LTR   WAPTR,WAPTR                                         0100 00236000
         BNZ   @DL00090                                            0100 00237000
*         END;                      /* NO LINE CONFLICT              */ 00238000
*       WAPTR=FSTAREA;              /* POINT TO FIRST TWA            */ 00239000
@RF00087 L     WAPTR,FSTAREA(,RCAPTR)                              0102 00240000
*     END;                                                         0103 00241000
*C15C0202:                                                         0104 00242000
*   I=$DEVCNTS;                     /* INITIALIZE COUNTER            */ 00243000
@RF00084 DS    0H                                                  0104 00244000
C15C0202 LH    I,$DEVCNTS(,WAPTR)                                  0104 00245000
*   IF WAPTR=REGSAV                 /* IF CURRENT WORK AREA          */ 00246000
*     THEN                                                         0105 00247000
         CR    WAPTR,REGSAV                                        0105 00248000
         BE    @RT00105                                            0105 00249000
*     GOTO C15C0210;                /* SKIP IT                       */ 00250000
*C15C0205:                                                         0107 00251000
*   IF I=0                          /* IF 0 NO MORE DEVICES          */ 00252000
*     THEN                                                         0107 00253000
C15C0205 LTR   I,I                                                 0107 00254000
         BZ    @RT00107                                            0107 00255000
*     GOTO C15C0210;                /* CK NEXT WORK AREA             */ 00256000
*   IF $NOTDEV(I)='1'B THEN                                        0109 00257000
         LR    @15,I                                               0109 00258000
         MH    @15,@CH00405                                        0109 00259000
         ST    @15,@TF00001                                        0109 00260000
         ALR   @15,WAPTR                                           0109 00261000
         TM    $NOTDEV-68(@15),B'10000000'                         0109 00262000
         BO    @RT00109                                            0109 00263000
*     GOTO C15C0207;                                               0110 00264000
*   IF SYM=$SYSMN(I)                /* SYMBOL FOUND?                 */ 00265000
*     THEN                                                         0111 00266000
         L     @15,TPQDATA(,TPQINPUT)                              0111 00267000
         LR    @14,WAPTR                                           0111 00268000
         AL    @14,@TF00001                                        0111 00269000
         CLC   SYM(8,@15),$SYSMN-68(@14)                           0111 00270000
         BE    @RT00111                                            0111 00271000
*     GOTO C15C0RT0;                /* YES                           */ 00272000
*   ELSE                                                           0113 00273000
*     DO;                                                          0113 00274000
*C15C0207:                                                         0114 00275000
*       I=I-1;                                                     0114 00276000
C15C0207 BCTR  I,0                                                 0114 00277000
*       GOTO C15C0205;                                             0115 00278000
         B     C15C0205                                            0115 00279000
*     END;                                                         0116 00280000
*C15C0210:                                                         0117 00281000
*   IF TFWDPTR=0                    /* ANY MORE WORK AREAS ?         */ 00282000
*     THEN                                                         0117 00283000
C15C0210 L     @15,TFWDPTR(,WAPTR)                                 0117 00284000
         LTR   @15,@15                                             0117 00285000
         BNZ   @RF00117                                            0117 00286000
*     RETURN CODE(4);               /* NO                            */ 00287000
         LA    @15,4                                               0118 00288000
         L     @14,12(,@13)                                        0118 00289000
         LM    @02,@12,28(@13)                                     0118 00290000
         BR    @14                                                 0118 00291000
*   WAPTR=TFWDPTR;                  /* UPDATE WKPTR                  */ 00292000
@RF00117 L     WAPTR,TFWDPTR(,WAPTR)                               0119 00293000
*   GOTO C15C0202;                  /* CONTINUE SEARCH               */ 00294000
         B     C15C0202                                            0120 00295000
*                                                                  0121 00296000
*   /*****************************************************************/ 00297000
*   /*                                                               */ 00298000
*   /* THIS SUBROUTINE ADDS A WORK AREA ONTO THE QUEUE. IT IS INVOKED*/ 00299000
*   /* BY PASSING A CODE OF 3                                        */ 00300000
*   /*                                                               */ 00301000
*   /*****************************************************************/ 00302000
*                                                                  0121 00303000
*C15C0300:                                                         0121 00304000
*   IF FSTAREA=0                    /* IF NO AREAS ON QUEUE          */ 00305000
*     THEN                                                         0121 00306000
C15C0300 SLR   @15,@15                                             0121 00307000
         CL    @15,FSTAREA(,RCAPTR)                                0121 00308000
         BNE   @RF00121                                            0121 00309000
*     DO;                           /* THEN BUILD 1ST ENTRY          */ 00310000
*       FSTAREA=TPQDATA;            /* FORWARD QUEUE PTR             */ 00311000
         L     @14,TPQDATA(,TPQINPUT)                              0123 00312000
         ST    @14,FSTAREA(,RCAPTR)                                0123 00313000
*       LSTAREA=TPQDATA;            /* BACKWARD QUEUE PTR            */ 00314000
         ST    @14,LSTAREA(,RCAPTR)                                0124 00315000
*       WAPTR=TPQDATA;              /* INIT WORK PTR                 */ 00316000
         LR    WAPTR,@14                                           0125 00317000
*       TFWDPTR=0;                  /* BACKWARD QUEUE PTR            */ 00318000
         ST    @15,TFWDPTR(,WAPTR)                                 0126 00319000
*       TBWDPTR=0;                  /* BACKWARD PTR = 0              */ 00320000
         ST    @15,TBWDPTR(,WAPTR)                                 0127 00321000
*C15C0RT2:                                                         0128 00322000
*       TPQ1=TPQDATA;               /* R1 = TPQDATA                  */ 00323000
C15C0RT2 L     TPQ1,TPQDATA(,TPQINPUT)                             0128 00324000
*       RETURN CODE(0);                                            0129 00325000
         SLR   @15,@15                                             0129 00326000
         L     @14,12(,@13)                                        0129 00327000
         LM    @02,@12,28(@13)                                     0129 00328000
         BR    @14                                                 0129 00329000
*     END;                                                         0130 00330000
*   IF LSTAREA=0                    /* IF BACKWARD PTR = 0           */ 00331000
*     THEN                                                         0131 00332000
@RF00121 L     @15,LSTAREA(,RCAPTR)                                0131 00333000
         LTR   @15,@15                                             0131 00334000
         BNZ   @RF00131                                            0131 00335000
*     RETURN CODE(8);               /* ERROR!                        */ 00336000
*                                                                  0132 00337000
         LA    @15,8                                               0132 00338000
         L     @14,12(,@13)                                        0132 00339000
         LM    @02,@12,28(@13)                                     0132 00340000
         BR    @14                                                 0132 00341000
*   /*****************************************************************/ 00342000
*   /*                                                               */ 00343000
*   /* ADD ENTRY TO AN EXISTING QUEUE                                */ 00344000
*   /*                                                               */ 00345000
*   /*****************************************************************/ 00346000
*                                                                  0133 00347000
*   WAPTR=LSTAREA;                  /* PTR TO LAST ELEMENT ON Q      */ 00348000
@RF00131 L     WAPTR,LSTAREA(,RCAPTR)                              0133 00349000
*   TFWDPTR=TPQDATA;                /* ADD TO END OF Q               */ 00350000
         L     @15,TPQDATA(,TPQINPUT)                              0134 00351000
         ST    @15,TFWDPTR(,WAPTR)                                 0134 00352000
*   WAPTR=TPQDATA;                  /* INITIALIZE FIELDS IN WORK     */ 00353000
         LR    WAPTR,@15                                           0135 00354000
*   TFWDPTR=0;                      /* AREA                          */ 00355000
         SLR   @14,@14                                             0136 00356000
         ST    @14,TFWDPTR(,WAPTR)                                 0136 00357000
*   TBWDPTR=LSTAREA;                                               0137 00358000
         MVC   TBWDPTR(4,WAPTR),LSTAREA(RCAPTR)                    0137 00359000
*   LSTAREA=TPQDATA;                                               0138 00360000
         ST    @15,LSTAREA(,RCAPTR)                                0138 00361000
*   GOTO C15C0RT2;                  /* RETURN CODE = 0               */ 00362000
         B     C15C0RT2                                            0139 00363000
*                                                                  0140 00364000
*   /*****************************************************************/ 00365000
*   /*                                                               */ 00366000
*   /* THIS SUBROUTINE DELETES AN AREA FROM THE CHAIN. IT IS INVOKED */ 00367000
*   /* BY PASSING A CODE OF 4                                        */ 00368000
*   /*                                                               */ 00369000
*   /*****************************************************************/ 00370000
*                                                                  0140 00371000
*C15C0400:                                                         0140 00372000
*   DELAD=TPQDATA;                  /* R7 HAS ADDRESS                */ 00373000
C15C0400 L     DELAD,TPQDATA(,TPQINPUT)                            0140 00374000
*C15C0402:                                                         0141 00375000
*   IF DELAD=WAPTR                  /* MATCH?                        */ 00376000
*     THEN                                                         0141 00377000
C15C0402 CR    DELAD,WAPTR                                         0141 00378000
         BE    @RT00141                                            0141 00379000
*     GOTO C15C0S04;                                               0142 00380000
*   IF TFWDPTR=0                    /* IF NO FORWARD PTR             */ 00381000
*     THEN                                                         0143 00382000
         L     @15,TFWDPTR(,WAPTR)                                 0143 00383000
         LTR   @15,@15                                             0143 00384000
         BNZ   @RF00143                                            0143 00385000
*     RETURN CODE(4);               /* NOT FOUND                     */ 00386000
         LA    @15,4                                               0144 00387000
         L     @14,12(,@13)                                        0144 00388000
         LM    @02,@12,28(@13)                                     0144 00389000
         BR    @14                                                 0144 00390000
*   WAPTR=TFWDPTR;                                                 0145 00391000
@RF00143 L     WAPTR,TFWDPTR(,WAPTR)                               0145 00392000
*   GOTO C15C0402;                                                 0146 00393000
*                                                                  0146 00394000
         B     C15C0402                                            0146 00395000
*   /*****************************************************************/ 00396000
*   /*                                                               */ 00397000
*   /* A MATCH HAS BEEN FOUND                                        */ 00398000
*   /*                                                               */ 00399000
*   /*****************************************************************/ 00400000
*                                                                  0147 00401000
*C15C0S04:                                                         0147 00402000
*   IF DELAD¬=LSTAREA               /* LAST AREA ON CHAIN ?          */ 00403000
*     THEN                                                         0147 00404000
C15C0S04 CL    DELAD,LSTAREA(,RCAPTR)                              0147 00405000
         BNE   @RT00147                                            0147 00406000
*     GOTO C15C0S24;                                               0148 00407000
*                                                                  0148 00408000
*   /*****************************************************************/ 00409000
*   /*                                                               */ 00410000
*   /* LAST AREA ON Q IS TO BE DELETED                               */ 00411000
*   /*                                                               */ 00412000
*   /*****************************************************************/ 00413000
*                                                                  0149 00414000
*   IF FSTAREA=LSTAREA THEN                                        0149 00415000
         CLC   FSTAREA(4,RCAPTR),LSTAREA(RCAPTR)                   0149 00416000
         BNE   @RF00149                                            0149 00417000
*     DO;                                                          0150 00418000
*       LSTAREA=0;                  /* NONE LEFT                     */ 00419000
         SLR   @15,@15                                             0151 00420000
         ST    @15,LSTAREA(,RCAPTR)                                0151 00421000
*       FSTAREA=0;                  /* ON Q                          */ 00422000
         ST    @15,FSTAREA(,RCAPTR)                                0152 00423000
*       GOTO C15C0D04;              /* GOTO WRAP UP                  */ 00424000
         B     C15C0D04                                            0153 00425000
*     END;                                                         0154 00426000
*   ELSE                                                           0155 00427000
*     DO;                           /* REMOVE ONLY LAST ELEMENT      */ 00428000
@RF00149 DS    0H                                                  0156 00429000
*       LSTAREA=TBWDPTR;            /* ZERO OUT NEW                  */ 00430000
         MVC   LSTAREA(4,RCAPTR),TBWDPTR(WAPTR)                    0156 00431000
*       WAPTR=TBWDPTR;              /* LAST ELEMENT'S                */ 00432000
         L     WAPTR,TBWDPTR(,WAPTR)                               0157 00433000
*       TFWDPTR=0;                  /* FORWARD PTR                   */ 00434000
         SLR   @15,@15                                             0158 00435000
         ST    @15,TFWDPTR(,WAPTR)                                 0158 00436000
*       GOTO C15C0D04;              /* GOTO WRAP UP                  */ 00437000
         B     C15C0D04                                            0159 00438000
*     END;                                                         0160 00439000
*                                                                  0160 00440000
*   /*****************************************************************/ 00441000
*   /*                                                               */ 00442000
*   /* CHECK TO SEE IF ELEMENT IS FIRST ON Q                         */ 00443000
*   /*                                                               */ 00444000
*   /*****************************************************************/ 00445000
*                                                                  0161 00446000
*C15C0S24:                                                         0161 00447000
*   IF DELAD=FSTAREA THEN                                          0161 00448000
C15C0S24 CL    DELAD,FSTAREA(,RCAPTR)                              0161 00449000
         BNE   @RF00161                                            0161 00450000
*     DO;                                                          0162 00451000
*       FSTAREA=TFWDPTR;            /* INIT FSTAREA PTR              */ 00452000
         MVC   FSTAREA(4,RCAPTR),TFWDPTR(WAPTR)                    0163 00453000
*       WAPTR=TFWDPTR;                                             0164 00454000
         L     WAPTR,TFWDPTR(,WAPTR)                               0164 00455000
*       TBWDPTR=0;                  /* ZERO OUT 2ND ELEM BK PTR      */ 00456000
         SLR   @15,@15                                             0165 00457000
         ST    @15,TBWDPTR(,WAPTR)                                 0165 00458000
*       GOTO C15C0D04;              /* GOTO TO WRAP UP               */ 00459000
         B     C15C0D04                                            0166 00460000
*     END;                                                         0167 00461000
*                                                                  0167 00462000
*   /*****************************************************************/ 00463000
*   /*                                                               */ 00464000
*   /* ELEMENT IS NOT FIRST ON QUEUE                                 */ 00465000
*   /*                                                               */ 00466000
*   /*****************************************************************/ 00467000
*                                                                  0168 00468000
*   $TFWDPTR->TBWDPTR=              /* RE-CHAIN ELEMENTS             */ 00469000
*       TBWDPTR;                                                   0168 00470000
@RF00161 L     @15,$TFWDPTR(,WAPTR)                                0168 00471000
         MVC   TBWDPTR(4,@15),TBWDPTR(WAPTR)                       0168 00472000
*   $TBWDPTR->TFWDPTR=TFWDPTR;                                     0169 00473000
         L     @15,$TBWDPTR(,WAPTR)                                0169 00474000
         MVC   TFWDPTR(4,@15),TFWDPTR(WAPTR)                       0169 00475000
*C15C0D04:                                                         0170 00476000
*   TPQ1=DELAD;                     /* SET R1                        */ 00477000
C15C0D04 LR    TPQ1,DELAD                                          0170 00478000
*   RETURN CODE(0);                                                0171 00479000
         SLR   @15,@15                                             0171 00480000
         L     @14,12(,@13)                                        0171 00481000
         LM    @02,@12,28(@13)                                     0171 00482000
         BR    @14                                                 0171 00483000
*                                                                  0172 00484000
*   /*****************************************************************/ 00485000
*   /*                                                               */ 00486000
*   /* THIS SUBROUTINE SEARCHES FOR A MATCH ON $TESTCID. IT IS       */ 00487000
*   /* INVOKED BY PASSING A CODE OF 5                                */ 00488000
*   /*                                                               */ 00489000
*   /*****************************************************************/ 00490000
*                                                                  0172 00491000
*C15C0500:                                                         0172 00492000
*   RETURN CODE(8);                 /* NOT SUPPORTED         @D32JPPW*/ 00493000
C15C0500 LA    @15,8                                               0172 00494000
         L     @14,12(,@13)                                        0172 00495000
         LM    @02,@12,28(@13)                                     0172 00496000
         BR    @14                                                 0172 00497000
*   DO;                             /* ATDSPLY                       */ 00498000
*   END;                            /* ATDSPLY                       */ 00499000
*   END ISTCC015;                                                  0175 00500000
@DATA    DS    0H                                                       00501000
@CH00405 DC    H'68'                                                    00502000
@DATD    DSECT                                                          00503000
         DS    0F                                                       00504000
@TF00001 DS    F                                                        00505000
ISTCC015 CSECT                                                          00506000
         DS    0F                                                       00507000
@CF00033 DC    F'1'                                                     00508000
@CF00112 DC    F'3'                                                     00509000
@CF00100 DC    F'4'                                                     00510000
@CF00380 DC    F'5'                                                     00511000
@DATD    DSECT                                                          00512000
         DS    0D                                                       00513000
         ORG   *+1-(*-@DATD)/(*-@DATD) INSURE DSECT DATA                00514000
@ENDDATD EQU   *                                                        00515000
ISTCC015 CSECT                                                          00516000
         DS    0F                                                       00517000
@SIZDATD DC    AL1(0)                                                   00518000
         DC    AL3(@ENDDATD-@DATD)                                      00519000
         DS    0D                                                       00520000
BLANKS   DC    CL8'        '                                            00521000
PATCH    DC    10F'0'                                                   00522000
TAB      DC    AL4(C15C0000)                                            00523000
         DC    AL4(C15C0100)                                            00524000
         DC    AL4(C15C0200)                                            00525000
         DC    AL4(C15C0300)                                            00526000
         DC    AL4(C15C0400)                                            00527000
         DC    AL4(C15C0500)                                            00528000
@00      EQU   00                      EQUATES FOR REGISTERS 0-15       00529000
@01      EQU   01                                                       00530000
@02      EQU   02                                                       00531000
@03      EQU   03                                                       00532000
@04      EQU   04                                                       00533000
@05      EQU   05                                                       00534000
@06      EQU   06                                                       00535000
@07      EQU   07                                                       00536000
@08      EQU   08                                                       00537000
@09      EQU   09                                                       00538000
@10      EQU   10                                                       00539000
@11      EQU   11                                                       00540000
@12      EQU   12                                                       00541000
@13      EQU   13                                                       00542000
@14      EQU   14                                                       00543000
@15      EQU   15                                                       00544000
RCAPTR   EQU   @04                                                      00545000
TPQINPUT EQU   @03                                                      00546000
TPQ1     EQU   @01                                                      00547000
R0       EQU   @00                                                      00548000
R8       EQU   @08                                                      00549000
I        EQU   @05                                                      00550000
CODREG   EQU   @06                                                      00551000
REGSAV   EQU   @09                                                      00552000
DELAD    EQU   @07                                                      00553000
WAPTR    EQU   @02                                                      00554000
TPQUIN   EQU   0                                                        00555000
TPQRCA   EQU   TPQUIN                                                   00556000
TPQDATA  EQU   TPQUIN+4                                                 00557000
TPCODE   EQU   TPQUIN+8                                                 00558000
DAF      EQU   0                                                        00559000
DTAFLD   EQU   0                                                        00560000
SYM      EQU   DTAFLD                                                   00561000
LNAME    EQU   DTAFLD+8                                                 00562000
$RCAAREA EQU   0                                                        00563000
$POINTER EQU   $RCAAREA+100                                             00564000
$FSTAREA EQU   $POINTER+8                                               00565000
$LSTAREA EQU   $POINTER+12                                              00566000
$TRTBLA  EQU   $POINTER+124                                             00567000
$CONSTNT EQU   $RCAAREA+244                                             00568000
$RCAFLG  EQU   $RCAAREA+604                                             00569000
TOLTEPWA EQU   0                                                        00570000
$SCTTBLE EQU   TOLTEPWA                                                 00571000
$TESTOPT EQU   $SCTTBLE+2                                               00572000
$ERROPT  EQU   $SCTTBLE+3                                               00573000
$PDEVFLG EQU   $SCTTBLE+10                                              00574000
$CDSFLGS EQU   $SCTTBLE+11                                              00575000
$CDS8T19 EQU   $SCTTBLE+20                                              00576000
$EXECFLG EQU   $SCTTBLE+33                                              00577000
$OLTFLGS EQU   $SCTTBLE+36                                              00578000
$OLTFLG2 EQU   $SCTTBLE+37                                              00579000
$TOTFLG1 EQU   $SCTTBLE+38                                              00580000
$CTEQTT  EQU   $TOTFLG1                                                 00581000
$ROUTMSK EQU   $SCTTBLE+40                                              00582000
$CDA     EQU   TOLTEPWA+100                                             00583000
$TFWDPTR EQU   $CDA+8                                                   00584000
$TBWDPTR EQU   $CDA+12                                                  00585000
$RCA     EQU   $CDA+44                                                  00586000
$OLTPTR  EQU   $CDA+52                                                  00587000
$HIMOREC EQU   $CDA+60                                                  00588000
$COMMFLG EQU   TOLTEPWA+224                                             00589000
$FLAG1   EQU   $COMMFLG                                                 00590000
$FLAG2   EQU   $COMMFLG+1                                               00591000
$FLAG3   EQU   $COMMFLG+2                                               00592000
$FLAG4   EQU   $COMMFLG+3                                               00593000
$FLAG5   EQU   $COMMFLG+4                                               00594000
$EOJ     EQU   $FLAG5                                                   00595000
$CANCEL  EQU   $EOJ                                                     00596000
$FLAG6   EQU   $COMMFLG+5                                               00597000
$ABNDBIT EQU   $FLAG6                                                   00598000
$FLAG7   EQU   $COMMFLG+6                                               00599000
$FLAG8   EQU   $COMMFLG+7                                               00600000
$FLAG9   EQU   $COMMFLG+8                                               00601000
$FLAG10  EQU   $COMMFLG+9                                               00602000
$FLAG11  EQU   $COMMFLG+10                                              00603000
$FLAG12  EQU   $COMMFLG+11                                              00604000
$FLAG13  EQU   $COMMFLG+12                                              00605000
$DEVTBLE EQU   TOLTEPWA+240                                             00606000
$DEVCDS  EQU   $DEVTBLE                                                 00607000
$DEVUNAD EQU   $DEVCDS                                                  00608000
@NM00039 EQU   $DEVUNAD+2                                               00609000
$DEVFEAT EQU   $DEVCDS+4                                                00610000
$DEVCDSF EQU   $DEVCDS+9                                                00611000
$DEVSDCF EQU   $DEVCDS+10                                               00612000
$$SYMNME EQU   $DEVCDS+12                                               00613000
$DEVFLG1 EQU   $DEVTBLE+20                                              00614000
$EVNCPLT EQU   $DEVFLG1                                                 00615000
$ATTNEXP EQU   $DEVFLG1                                                 00616000
$INTOCC  EQU   $DEVFLG1                                                 00617000
$DEVFLG2 EQU   $DEVTBLE+21                                              00618000
$DEVTECB EQU   $DEVTBLE+22                                              00619000
$OPIS    EQU   $DEVTECB                                                 00620000
$OPND    EQU   $DEVTECB+2                                               00621000
$DEVFLG3 EQU   $DEVTBLE+27                                              00622000
$NOTDEV  EQU   $DEVFLG3                                                 00623000
$SIOFLG  EQU   $DEVFLG3                                                 00624000
$SYSMN   EQU   $DEVTBLE+28                                              00625000
$IFTOUT  EQU   $DEVTBLE+36                                              00626000
$DEVSESP EQU   $IFTOUT                                                  00627000
$SSCPDAF EQU   $IFTOUT+6                                                00628000
$LDNCBPT EQU   $DEVTBLE+48                                              00629000
$RNINFO  EQU   $DEVTBLE+56                                              00630000
$LINENME EQU   $RNINFO                                                  00631000
$DEVFLG5 EQU   $RNINFO+8                                                00632000
$DEVFLG4 EQU   $DEVTBLE+65                                              00633000
$DEVCNTS EQU   TOLTEPWA+1464                                            00634000
$SLTBL   EQU   TOLTEPWA+1468                                            00635000
$RUNTEST EQU   $SLTBL+13                                                00636000
$TESTFLG EQU   $SLTBL+21                                                00637000
$SECLST  EQU   $SLTBL+22                                                00638000
#EXITA   EQU   TOLTEPWA+2632                                            00639000
$CCOMDAT EQU   TOLTEPWA+2644                                            00640000
$CFLGS   EQU   $CCOMDAT+16                                              00641000
$24FEMSG EQU   TOLTEPWA+2681                                            00642000
$24CATMG EQU   $24FEMSG+11                                              00643000
@NM00048 EQU   TOLTEPWA+2776                                            00644000
$OUNTPTR EQU   @NM00048+4                                               00645000
$NSPTR   EQU   $OUNTPTR                                                 00646000
$NSCNT   EQU   @NM00048+10                                              00647000
$ENXX    EQU   @NM00048+15                                              00648000
$IMITX   EQU   $ENXX                                                    00649000
$TBSDATA EQU   TOLTEPWA+2796                                            00650000
SVESC033 EQU   TOLTEPWA+3160                                            00651000
SVECC013 EQU   TOLTEPWA+3232                                            00652000
SVEIC003 EQU   TOLTEPWA+3592                                            00653000
SVESC022 EQU   TOLTEPWA+3736                                            00654000
SVECC011 EQU   TOLTEPWA+4024                                            00655000
$TRTBL   EQU   0                                                        00656000
#EXIT    EQU   0                                                        00657000
FSTAREA  EQU   $FSTAREA                                                 00658000
LSTAREA  EQU   $LSTAREA                                                 00659000
TBWDPTR  EQU   $TBWDPTR                                                 00660000
TFWDPTR  EQU   $TFWDPTR                                                 00661000
SVECC012 EQU   SVESC022                                                 00662000
SVEIC00A EQU   SVEIC003                                                 00663000
SVEIC004 EQU   SVEIC003                                                 00664000
SVEIC005 EQU   SVEIC003                                                 00665000
SVESC02A EQU   SVESC022                                                 00666000
SVESC02B EQU   SVESC022                                                 00667000
SVESC02D EQU   SVESC022                                                 00668000
SVESC02E EQU   SVESC022                                                 00669000
SVESC02F EQU   SVECC013                                                 00670000
SVESC024 EQU   SVESC022                                                 00671000
SVESC027 EQU   SVESC022                                                 00672000
SVESC029 EQU   SVESC033                                                 00673000
SVESC031 EQU   SVECC013                                                 00674000
SVESC032 EQU   SVECC011                                                 00675000
SVETC037 EQU   SVEIC003                                                 00676000
         AGO   .@UNREFD                START UNREFERENCED COMPONENTS    00677000
SVECC010 EQU   TOLTEPWA+3952                                            00678000
SVETC035 EQU   TOLTEPWA+3880                                            00679000
SVESC030 EQU   TOLTEPWA+3808                                            00680000
SVESC020 EQU   TOLTEPWA+3664                                            00681000
SVEIC002 EQU   TOLTEPWA+3520                                            00682000
SVECC014 EQU   TOLTEPWA+3376                                            00683000
SVESC120 EQU   TOLTEPWA+3304                                            00684000
SVESC025 EQU   TOLTEPWA+3088                                            00685000
@NM00050 EQU   TOLTEPWA+2980                                            00686000
$RPLERR  EQU   TOLTEPWA+2977                                            00687000
@NM00049 EQU   TOLTEPWA+2976                                            00688000
$R13PR3  EQU   TOLTEPWA+2972                                            00689000
$CEINT2  EQU   TOLTEPWA+2968                                            00690000
$CEINT1  EQU   TOLTEPWA+2964                                            00691000
$MSGGET  EQU   TOLTEPWA+2960                                            00692000
$ACQLIST EQU   TOLTEPWA+2956                                            00693000
$R4SAVE1 EQU   TOLTEPWA+2952                                            00694000
$CLSISS  EQU   TOLTEPWA+2950                                            00695000
$CLSCNT  EQU   TOLTEPWA+2948                                            00696000
$CUTABLE EQU   TOLTEPWA+2868                                            00697000
$BUFSZ2  EQU   TOLTEPWA+2864                                            00698000
$RESID2  EQU   TOLTEPWA+2860                                            00699000
$OLTCCW2 EQU   TOLTEPWA+2856                                            00700000
$ENDBFR2 EQU   TOLTEPWA+2852                                            00701000
$1STBFR2 EQU   TOLTEPWA+2848                                            00702000
$TECB2   EQU   TOLTEPWA+2844                                            00703000
$BUFSZ1  EQU   TOLTEPWA+2840                                            00704000
$RESID1  EQU   TOLTEPWA+2836                                            00705000
$OLTCCW1 EQU   TOLTEPWA+2832                                            00706000
$ENDBFR1 EQU   TOLTEPWA+2828                                            00707000
$1STBFR1 EQU   TOLTEPWA+2824                                            00708000
$TECB1   EQU   TOLTEPWA+2820                                            00709000
$WAITIME EQU   TOLTEPWA+2816                                            00710000
$TRTN#   EQU   TOLTEPWA+2815                                            00711000
$WIODEV  EQU   TOLTEPWA+2814                                            00712000
$RQSTSZE EQU   TOLTEPWA+2812                                            00713000
$RQSTPTR EQU   TOLTEPWA+2808                                            00714000
$R4SAVE  EQU   TOLTEPWA+2804                                            00715000
$PARTADR EQU   TOLTEPWA+2800                                            00716000
$CTWIDTH EQU   TOLTEPWA+2795                                            00717000
$CTLINE  EQU   TOLTEPWA+2794                                            00718000
$APWIDTH EQU   TOLTEPWA+2793                                            00719000
$APLINE  EQU   TOLTEPWA+2792                                            00720000
$INDEX   EQU   $IMITX                                                   00721000
$UMXX    EQU   @NM00048+14                                              00722000
$NSXX    EQU   @NM00048+12                                              00723000
$ATACNT  EQU   $NSCNT                                                   00724000
$CTR     EQU   @NM00048+8                                               00725000
$ATAPTR  EQU   $NSPTR                                                   00726000
$DDRPTR  EQU   @NM00048                                                 00727000
$DTORESP EQU   TOLTEPWA+2712                                            00728000
$APNAME  EQU   TOLTEPWA+2704                                            00729000
$24SYMNE EQU   $24CATMG+4                                               00730000
$24DEVAD EQU   $24CATMG                                                 00731000
$24RTN#  EQU   $24FEMSG+8                                               00732000
$ESECTID EQU   $24FEMSG                                                 00733000
$24FLGS  EQU   TOLTEPWA+2680                                            00734000
$24SAVE2 EQU   TOLTEPWA+2676                                            00735000
$24SAVE1 EQU   TOLTEPWA+2672                                            00736000
$24UNADR EQU   TOLTEPWA+2668                                            00737000
$24SAV13 EQU   TOLTEPWA+2664                                            00738000
$24RETCD EQU   TOLTEPWA+2663                                            00739000
$MACID   EQU   TOLTEPWA+2661                                            00740000
$CSPARE  EQU   $CFLGS                                                   00741000
$C2WAY   EQU   $CFLGS                                                   00742000
$CINCT   EQU   $CCOMDAT+12                                              00743000
$CINADR  EQU   $CCOMDAT+8                                               00744000
$COUTCT  EQU   $CCOMDAT+4                                               00745000
$COUTAD  EQU   $CCOMDAT                                                 00746000
ROOTLOC  EQU   TOLTEPWA+2640                                            00747000
$RETREG  EQU   TOLTEPWA+2636                                            00748000
$WORK    EQU   TOLTEPWA+2376                                            00749000
$EXTA    EQU   TOLTEPWA+2320                                            00750000
$PASSONA EQU   TOLTEPWA+2264                                            00751000
$TRMINPT EQU   TOLTEPWA+2184                                            00752000
$INBUFR  EQU   TOLTEPWA+2104                                            00753000
$BUFFER  EQU   TOLTEPWA+1976                                            00754000
$TLTRPL3 EQU   TOLTEPWA+1856                                            00755000
$TLTRPL2 EQU   TOLTEPWA+1736                                            00756000
$TLTRPL1 EQU   TOLTEPWA+1616                                            00757000
@NM00047 EQU   $SLTBL+135                                               00758000
$HIGHRTN EQU   $SLTBL+134                                               00759000
$PRIMADR EQU   $SLTBL+130                                               00760000
$CTSTPT  EQU   $SLTBL+128                                               00761000
$TSTCNT  EQU   $SLTBL+126                                               00762000
$SECFLGS EQU   $SECLST+3                                                00763000
$SECTION EQU   $SECLST                                                  00764000
$SECACT  EQU   $TESTFLG                                                 00765000
$CANTRUN EQU   $TESTFLG                                                 00766000
$FINAL   EQU   $TESTFLG                                                 00767000
$TESTSUF EQU   $RUNTEST+5                                               00768000
$TESTNUM EQU   $RUNTEST+1                                               00769000
$LETPRF  EQU   $RUNTEST                                                 00770000
$SYMBOLC EQU   $SLTBL+5                                                 00771000
$FAMILY  EQU   $SLTBL                                                   00772000
$CDEVPT  EQU   TOLTEPWA+1466                                            00773000
$FEEDBCK EQU   $DEVTBLE+66                                              00774000
$WTISUED EQU   $DEVFLG4                                                 00775000
$EXIOISD EQU   $DEVFLG4                                                 00776000
$REMWRIT EQU   $DEVFLG4                                                 00777000
$REMDONE EQU   $DEVFLG4                                                 00778000
$2NDUSED EQU   $DEVFLG4                                                 00779000
$1STUSED EQU   $DEVFLG4                                                 00780000
$IGLXIFB EQU   $DEVFLG4                                                 00781000
$EXIOLV3 EQU   $DEVFLG4                                                 00782000
@NM00046 EQU   $DEVFLG5                                                 00783000
$DVBASIC EQU   $DEVFLG5                                                 00784000
$ASCII   EQU   $DEVFLG5                                                 00785000
$DEVLU   EQU   $DEVFLG5                                                 00786000
$OPNDFAL EQU   $DEVFLG5                                                 00787000
$ACQNCB  EQU   $DEVFLG5                                                 00788000
$REMOTE  EQU   $DEVFLG5                                                 00789000
$ENDNODE EQU   $DEVFLG5                                                 00790000
$CID     EQU   $DEVTBLE+52                                              00791000
$DVCOL   EQU   $LDNCBPT+2                                               00792000
$DVROW   EQU   $LDNCBPT                                                 00793000
$NCSPLP  EQU   $DEVTBLE+44                                              00794000
$DVLN    EQU   $SSCPDAF                                                 00795000
$DAF     EQU   $DEVSESP+4                                               00796000
$VARYPAB EQU   $DEVSESP                                                 00797000
@NM00045 EQU   $DEVFLG3                                                 00798000
$CLRSNT  EQU   $DEVFLG3                                                 00799000
$OLTERR  EQU   $DEVFLG3                                                 00800000
$SRTEST  EQU   $DEVFLG3                                                 00801000
$DVSNDOK EQU   $SIOFLG                                                  00802000
$POLLREQ EQU   $DEVFLG3                                                 00803000
$ACQRED  EQU   $DEVFLG3                                                 00804000
$DVINCT  EQU   $DEVTBLE+26                                              00805000
$DVBRKST EQU   $OPND+1                                                  00806000
$DVBRKSN EQU   $OPND                                                    00807000
$DVSEQNO EQU   $OPIS                                                    00808000
$CEINTRP EQU   $DEVFLG2                                                 00809000
$TESTMDE EQU   $DEVFLG2                                                 00810000
$DEVALOC EQU   $DEVFLG2                                                 00811000
$ALLDATA EQU   $DEVFLG2                                                 00812000
$ENDCNTL EQU   $DEVFLG2                                                 00813000
$CTLDEV  EQU   $DEVFLG2                                                 00814000
$NOCDS   EQU   $DEVFLG2                                                 00815000
$DATAIN  EQU   $DEVFLG2                                                 00816000
$PRIMARY EQU   $DEVFLG1                                                 00817000
$DVCTBYT EQU   $INTOCC                                                  00818000
$DEVACT  EQU   $DEVFLG1                                                 00819000
$DVLGMDE EQU   $ATTNEXP                                                 00820000
$DVSPRM  EQU   $EVNCPLT                                                 00821000
$GRABBED EQU   $DEVFLG1                                                 00822000
$CATASTR EQU   $DEVFLG1                                                 00823000
$LETGO   EQU   $DEVFLG1                                                 00824000
$CURELEM EQU   $$SYMNME+4                                               00825000
$MSGOTSD EQU   $$SYMNME                                                 00826000
$EXTDEV  EQU   $DEVCDS+11                                               00827000
@NM00044 EQU   $DEVSDCF                                                 00828000
$NOTPRIM EQU   $DEVSDCF                                                 00829000
@NM00043 EQU   $DEVCDSF                                                 00830000
@NM00042 EQU   $DEVCDSF                                                 00831000
@NM00041 EQU   $DEVCDSF                                                 00832000
$CDSNAME EQU   $DEVCDSF                                                 00833000
$EXTRN   EQU   $DEVCDSF                                                 00834000
$CEVOLUM EQU   $DEVCDSF                                                 00835000
$SHARD   EQU   $DEVCDSF                                                 00836000
$DEVFPM  EQU   $DEVCDSF                                                 00837000
$DEVCNT  EQU   $DEVCDS+8                                                00838000
$DEVTYPE EQU   $DEVFEAT+3                                               00839000
$DEVCLAS EQU   $DEVFEAT+2                                               00840000
$DEVFRRS EQU   $DEVFEAT+1                                               00841000
$DEVMOD  EQU   $DEVFEAT                                                 00842000
$DEVRDGT EQU   @NM00039+1                                               00843000
$DEVCTLU EQU   @NM00039+1                                               00844000
$DEVCHAN EQU   @NM00039                                                 00845000
@NM00040 EQU   @NM00039                                                 00846000
$CTINDX  EQU   $DEVUNAD                                                 00847000
$FLAG16  EQU   $COMMFLG+15                                              00848000
$FLAG15  EQU   $COMMFLG+14                                              00849000
$FLAG14  EQU   $COMMFLG+13                                              00850000
$TEP2ND  EQU   $FLAG13                                                  00851000
$TEP1ST  EQU   $FLAG13                                                  00852000
$CATMSG  EQU   $FLAG13                                                  00853000
$PRMPTSW EQU   $FLAG13                                                  00854000
$DEVENT  EQU   $FLAG13                                                  00855000
$OLTMACC EQU   $FLAG13                                                  00856000
$LGON    EQU   $FLAG13                                                  00857000
$CTLOGON EQU   $FLAG13                                                  00858000
@NM00038 EQU   $FLAG12                                                  00859000
$VARYINP EQU   $FLAG12                                                  00860000
$ENDTEST EQU   $FLAG12                                                  00861000
$VRYHRD  EQU   $FLAG12                                                  00862000
$VRYSFT  EQU   $FLAG12                                                  00863000
$POSTFLG EQU   $FLAG12                                                  00864000
$OPTMSG  EQU   $FLAG12                                                  00865000
$FEORCAT EQU   $FLAG11                                                  00866000
@NM00037 EQU   $FLAG11                                                  00867000
@NM00036 EQU   $FLAG10                                                  00868000
$INBND   EQU   $FLAG10                                                  00869000
$WAITFLG EQU   $FLAG10                                                  00870000
$DPRINT  EQU   $FLAG10                                                  00871000
$HOLD    EQU   $FLAG9                                                   00872000
$NOTRRCH EQU   $FLAG9                                                   00873000
@NM00035 EQU   $FLAG9                                                   00874000
$COPY    EQU   $FLAG9                                                   00875000
$LSTLNSW EQU   $FLAG9                                                   00876000
$MULLNSW EQU   $FLAG9                                                   00877000
$REMSW   EQU   $FLAG9                                                   00878000
$IGRES   EQU   $FLAG9                                                   00879000
$TCECM   EQU   $FLAG8                                                   00880000
$VS2     EQU   $FLAG8                                                   00881000
$VS1     EQU   $FLAG8                                                   00882000
$EDOS    EQU   $FLAG8                                                   00883000
@NM00034 EQU   $FLAG8                                                   00884000
$TWOWAY  EQU   $FLAG8                                                   00885000
@NM00033 EQU   $FLAG8                                                   00886000
$RCVMSG  EQU   $FLAG7                                                   00887000
$RCVRFLG EQU   $FLAG7                                                   00888000
$SNDRFLG EQU   $FLAG7                                                   00889000
$LDOIS   EQU   $FLAG7                                                   00890000
$DCONTCT EQU   $FLAG7                                                   00891000
$EXIOWAT EQU   $FLAG7                                                   00892000
$2NDDATA EQU   $FLAG7                                                   00893000
$1STDATA EQU   $FLAG7                                                   00894000
$CIREQ   EQU   $FLAG6                                                   00895000
$ABTERM  EQU   $ABNDBIT                                                 00896000
$FSTMCIS EQU   $FLAG6                                                   00897000
$DISCREQ EQU   $FLAG6                                                   00898000
$DISCISS EQU   $FLAG6                                                   00899000
$CHANGE  EQU   $FLAG6                                                   00900000
$CTERROR EQU   $FLAG6                                                   00901000
$RECAL11 EQU   $FLAG6                                                   00902000
@NM00032 EQU   $FLAG5                                                   00903000
$PROGCK  EQU   $CANCEL                                                  00904000
$PRINTAP EQU   $FLAG5                                                   00905000
@NM00031 EQU   $FLAG5                                                   00906000
$MSG922  EQU   $FLAG5                                                   00907000
$CT924   EQU   $FLAG5                                                   00908000
$FSTCAT  EQU   $FLAG5                                                   00909000
$FSTFE   EQU   $FLAG5                                                   00910000
$ACTOPND EQU   $FLAG4                                                   00911000
$ACQCUTT EQU   $FLAG4                                                   00912000
$CLSSACT EQU   $FLAG4                                                   00913000
$BACKINT EQU   $FLAG4                                                   00914000
$DMSGSW  EQU   $FLAG4                                                   00915000
$TSTDEVP EQU   $FLAG4                                                   00916000
$APRQPER EQU   $FLAG4                                                   00917000
$OPCOM   EQU   $FLAG4                                                   00918000
$NEWAP   EQU   $FLAG3                                                   00919000
$ALTPRTR EQU   $FLAG3                                                   00920000
$OPTERR  EQU   $FLAG3                                                   00921000
$PRTONLY EQU   $FLAG3                                                   00922000
$REQSTOR EQU   $FLAG3                                                   00923000
$LOGOFFE EQU   $FLAG3                                                   00924000
$TSTERR  EQU   $FLAG3                                                   00925000
$DEVERR  EQU   $FLAG3                                                   00926000
$PARTIAL EQU   $FLAG2                                                   00927000
$NRMTERM EQU   $FLAG2                                                   00928000
$VALDTST EQU   $FLAG2                                                   00929000
$VALDDEV EQU   $FLAG2                                                   00930000
$DBLSLSH EQU   $FLAG2                                                   00931000
$NDR     EQU   $FLAG2                                                   00932000
@NM00030 EQU   $FLAG2                                                   00933000
$OLTACT  EQU   $FLAG1                                                   00934000
$NORELDV EQU   $FLAG1                                                   00935000
@NM00029 EQU   $FLAG1                                                   00936000
$OPTCHNG EQU   $FLAG1                                                   00937000
$DEVCHNG EQU   $FLAG1                                                   00938000
$TESTCNG EQU   $FLAG1                                                   00939000
$CNSLFG  EQU   $FLAG1                                                   00940000
$TEP3RD  EQU   $FLAG1                                                   00941000
@NM00028 EQU   $CDA+120                                                 00942000
$CUCNT   EQU   $CDA+118                                                 00943000
@NM00027 EQU   $CDA+117                                                 00944000
$PRTFORM EQU   $CDA+116                                                 00945000
$OPISCNT EQU   $CDA+114                                                 00946000
$OPNDCNT EQU   $CDA+112                                                 00947000
$GETMSZE EQU   $CDA+110                                                 00948000
$GRCNTS  EQU   $CDA+108                                                 00949000
$CTLCNT  EQU   $CDA+106                                                 00950000
$ACTLVL  EQU   $CDA+105                                                 00951000
$PRNTLVL EQU   $CDA+104                                                 00952000
$ERRCNTA EQU   $CDA+102                                                 00953000
$TLCNT   EQU   $CDA+100                                                 00954000
$TIMEALW EQU   $CDA+96                                                  00955000
$PTRAREA EQU   $CDA+92                                                  00956000
$GETMPTR EQU   $CDA+88                                                  00957000
$R13PTRT EQU   $CDA+84                                                  00958000
$R13PTR  EQU   $CDA+80                                                  00959000
$TEPEND  EQU   $CDA+76                                                  00960000
$PLINKDL EQU   $CDA+72                                                  00961000
$TEPBEGN EQU   $CDA+68                                                  00962000
$FRELPTR EQU   $CDA+64                                                  00963000
$HIGHADR EQU   $HIMOREC                                                 00964000
$LOMOREC EQU   $CDA+56                                                  00965000
$LOWADDR EQU   $OLTPTR                                                  00966000
$ENDCOMM EQU   $CDA+48                                                  00967000
$COMMON  EQU   $RCA                                                     00968000
$SLASHAD EQU   $CDA+32                                                  00969000
$PASSON  EQU   $CDA+28                                                  00970000
$TOLBRTB EQU   $CDA+24                                                  00971000
$SCTPTR8 EQU   $CDA+20                                                  00972000
$SCTPTR  EQU   $CDA+16                                                  00973000
@NM00026 EQU   $CDA                                                     00974000
@NM00025 EQU   $SCTTBLE+98                                              00975000
$SCTLWTC EQU   $SCTTBLE+96                                              00976000
$SCTLWTA EQU   $SCTTBLE+92                                              00977000
#EXT     EQU   $SCTTBLE+88                                              00978000
#PASS    EQU   $SCTTBLE+84                                              00979000
#TABLE   EQU   $SCTTBLE+80                                              00980000
#MSGIDAC EQU   $SCTTBLE+78                                              00981000
@NM00024 EQU   $SCTTBLE+71                                              00982000
$RETMASK EQU   $SCTTBLE+70                                              00983000
$R249255 EQU   $ROUTMSK+29                                              00984000
$R241248 EQU   $ROUTMSK+28                                              00985000
$R233240 EQU   $ROUTMSK+27                                              00986000
$R225232 EQU   $ROUTMSK+26                                              00987000
$R217224 EQU   $ROUTMSK+25                                              00988000
$R209216 EQU   $ROUTMSK+24                                              00989000
$R201208 EQU   $ROUTMSK+23                                              00990000
$R193200 EQU   $ROUTMSK+22                                              00991000
$R185192 EQU   $ROUTMSK+21                                              00992000
$R177184 EQU   $ROUTMSK+20                                              00993000
$R169176 EQU   $ROUTMSK+19                                              00994000
$R161168 EQU   $ROUTMSK+18                                              00995000
$R153160 EQU   $ROUTMSK+17                                              00996000
$R145152 EQU   $ROUTMSK+16                                              00997000
$R137144 EQU   $ROUTMSK+15                                              00998000
$R129136 EQU   $ROUTMSK+14                                              00999000
$R121128 EQU   $ROUTMSK+13                                              01000000
$R113120 EQU   $ROUTMSK+12                                              01001000
$R105112 EQU   $ROUTMSK+11                                              01002000
$R097104 EQU   $ROUTMSK+10                                              01003000
$R089096 EQU   $ROUTMSK+9                                               01004000
$R081088 EQU   $ROUTMSK+8                                               01005000
$R073080 EQU   $ROUTMSK+7                                               01006000
$R065072 EQU   $ROUTMSK+6                                               01007000
$R057064 EQU   $ROUTMSK+5                                               01008000
$R049056 EQU   $ROUTMSK+4                                               01009000
$R041048 EQU   $ROUTMSK+3                                               01010000
$R033040 EQU   $ROUTMSK+2                                               01011000
$R025032 EQU   $ROUTMSK+1                                               01012000
$R017024 EQU   $ROUTMSK                                                 01013000
$TOTFLG2 EQU   $SCTTBLE+39                                              01014000
@NM00023 EQU   $TOTFLG1                                                 01015000
@NM00022 EQU   $TOTFLG1                                                 01016000
@NM00021 EQU   $TOTFLG1                                                 01017000
$CURELOD EQU   $TOTFLG1                                                 01018000
@NM00020 EQU   $TOTFLG1                                                 01019000
@NM00019 EQU   $TOTFLG1                                                 01020000
$LINESHR EQU   $TOTFLG1                                                 01021000
@NM00018 EQU   $OLTFLG2                                                 01022000
@NM00017 EQU   $OLTFLG2                                                 01023000
@NM00016 EQU   $OLTFLG2                                                 01024000
@NM00015 EQU   $OLTFLG2                                                 01025000
@NM00014 EQU   $OLTFLG2                                                 01026000
@NM00013 EQU   $OLTFLG2                                                 01027000
@NM00012 EQU   $OLTFLG2                                                 01028000
$TALK    EQU   $OLTFLG2                                                 01029000
$DYCOM   EQU   $OLTFLGS                                                 01030000
@NM00011 EQU   $OLTFLGS                                                 01031000
$TRACE   EQU   $OLTFLGS                                                 01032000
$RETCODE EQU   $OLTFLGS                                                 01033000
$CONTCB  EQU   $OLTFLGS                                                 01034000
$RETAIN  EQU   $OLTFLGS                                                 01035000
$CLEANRT EQU   $OLTFLGS                                                 01036000
$MANINTV EQU   $OLTFLGS                                                 01037000
$OLTSIZE EQU   $SCTTBLE+34                                              01038000
$QSCTMOD EQU   $EXECFLG                                                 01039000
$CTRLMOD EQU   $EXECFLG                                                 01040000
$CLEANUP EQU   $EXECFLG                                                 01041000
$LSTPDEV EQU   $EXECFLG                                                 01042000
$ERRCNT  EQU   $EXECFLG                                                 01043000
$RTNSLCT EQU   $EXECFLG                                                 01044000
$MULTDEV EQU   $EXECFLG                                                 01045000
@NM00010 EQU   $EXECFLG                                                 01046000
$RMSKCNT EQU   $SCTTBLE+32                                              01047000
$SYNAME  EQU   $CDS8T19+4                                               01048000
$EXTSIG  EQU   $CDS8T19+3                                               01049000
$CDFLGS  EQU   $CDS8T19+1                                               01050000
$CDSCNT  EQU   $CDS8T19                                                 01051000
$PDEVDSC EQU   $SCTTBLE+16                                              01052000
$PDEVADR EQU   $SCTTBLE+12                                              01053000
$COMMCN  EQU   $CDSFLGS                                                 01054000
$CUSTSYM EQU   $CDSFLGS                                                 01055000
$TWOCHSW EQU   $CDSFLGS                                                 01056000
$SYMNAME EQU   $CDSFLGS                                                 01057000
$EXTINTC EQU   $CDSFLGS                                                 01058000
$CEVOL   EQU   $CDSFLGS                                                 01059000
$SHARED  EQU   $CDSFLGS                                                 01060000
$FPM     EQU   $CDSFLGS                                                 01061000
$LASTSUB EQU   $PDEVFLG                                                 01062000
@NM00009 EQU   $PDEVFLG                                                 01063000
@NM00008 EQU   $PDEVFLG                                                 01064000
@NM00007 EQU   $PDEVFLG                                                 01065000
$LASTDEV EQU   $PDEVFLG                                                 01066000
@NM00006 EQU   $PDEVFLG                                                 01067000
$EXFILPT EQU   $PDEVFLG                                                 01068000
$FPMOLD  EQU   $PDEVFLG                                                 01069000
$TSSSYM  EQU   $SCTTBLE+8                                               01070000
$SCTLEVL EQU   $SCTTBLE+7                                               01071000
$DRIVER  EQU   $SCTTBLE+6                                               01072000
$RT0916  EQU   $SCTTBLE+5                                               01073000
$RT0108  EQU   $SCTTBLE+4                                               01074000
$LOOPTST EQU   $ERROPT                                                  01075000
$LOOPERR EQU   $ERROPT                                                  01076000
$NERRPRT EQU   $ERROPT                                                  01077000
$NOCNTRL EQU   $ERROPT                                                  01078000
$ALTPRNT EQU   $ERROPT                                                  01079000
$CATERR  EQU   $ERROPT                                                  01080000
$ASTERIK EQU   $ERROPT                                                  01081000
$TESTERR EQU   $ERROPT                                                  01082000
$FSTCOMM EQU   $TESTOPT                                                 01083000
$INDEFLP EQU   $TESTOPT                                                 01084000
$NOPRT   EQU   $TESTOPT                                                 01085000
$PARAPRT EQU   $TESTOPT                                                 01086000
@NM00005 EQU   $TESTOPT                                                 01087000
$ERRLPCT EQU   $SCTTBLE                                                 01088000
$TLTEND  EQU   $RCAAREA+945                                             01089000
$CNSLID  EQU   $RCAAREA+936                                             01090000
$EXITSAV EQU   $RCAAREA+864                                             01091000
$TRASCII EQU   $RCAAREA+608                                             01092000
@NM00004 EQU   $RCAAREA+605                                             01093000
$VTAMEND EQU   $RCAFLG                                                  01094000
$TPPOSTD EQU   $RCAFLG                                                  01095000
$NEWCT   EQU   $RCAFLG                                                  01096000
$ABNDALL EQU   $RCAFLG                                                  01097000
$CUTESTB EQU   $RCAFLG                                                  01098000
$CONSOLE EQU   $RCAFLG                                                  01099000
$TPLOGON EQU   $RCAFLG                                                  01100000
$UPDATE  EQU   $RCAFLG                                                  01101000
$DEVAREA EQU   $RCAAREA+600                                             01102000
$CTDVAR  EQU   $RCAAREA+596                                             01103000
$BUFFS   EQU   $RCAAREA+464                                             01104000
$TLTNIB  EQU   $CONSTNT+140                                             01105000
$TLTPRPL EQU   $CONSTNT+20                                              01106000
@NM00003 EQU   $CONSTNT+4                                               01107000
@NM00002 EQU   $CONSTNT+2                                               01108000
$USECNT  EQU   $CONSTNT                                                 01109000
$CURRTWA EQU   $POINTER+140                                             01110000
$CTNAME  EQU   $POINTER+132                                             01111000
$CTARGX  EQU   $POINTER+128                                             01112000
$COMINT  EQU   $POINTER+120                                             01113000
$QUEHNDL EQU   $POINTER+116                                             01114000
@NM00001 EQU   $POINTER+36                                              01115000
$RTNPTR  EQU   $POINTER+32                                              01116000
$TLTECB2 EQU   $POINTER+28                                              01117000
$TLTECB1 EQU   $POINTER+24                                              01118000
$CLEANP  EQU   $POINTER+20                                              01119000
$ABEND   EQU   $POINTER+16                                              01120000
$CVTSAVE EQU   $POINTER+4                                               01121000
$TOLTEP  EQU   $POINTER                                                 01122000
$TLTACB  EQU   $RCAAREA                                                 01123000
.@UNREFD ANOP                          END UNREFERENCED COMPONENTS      01124000
@RT00061 EQU   C15C0010                                                 01125000
@RT00063 EQU   C15C0007                                                 01126000
@RT00105 EQU   C15C0210                                                 01127000
@RT00107 EQU   C15C0210                                                 01128000
@RT00109 EQU   C15C0207                                                 01129000
@RT00111 EQU   C15C0RT0                                                 01130000
@RT00141 EQU   C15C0S04                                                 01131000
@RT00147 EQU   C15C0S24                                                 01132000
@ENDDATA EQU   *                                                        01133000
         END   ISTCC015,(C'PLS1214',0702,78336)                         01134000
./  ADD  SSI=83341897,NAME=ISTCC016
         TITLE 'READ WRITE EXIT - ISTCC016'                             00001000
ISTCC016 CSECT ,                                                   0001 00002000
@MAINENT DS    0H                                                  0001 00003000
         USING *,@15                                               0001 00004000
         B     @PROLOG                                             0001 00005000
         DC    AL1(16)                                             0001 00006000
         DC    C'ISTCC016  78.336'                                 0001 00007000
         DROP  @15                                                      00008000
@PROLOG  DS    0H                                                  0002 00009000
         PRINT OFF                                                      00010000
         PRINT ON                                                       00011000
         PRINT OFF                                                      00012000
         PRINT ON                                                       00013000
         PRINT OFF                                                      00014000
         PRINT ON                                                       00015000
         PRINT OFF                                                      00016000
         PRINT ON                                                       00017000
*                                    /* SET UP BASE AND SCR @ZD10878*/  00018000
         LR    R12,R15             GET THE ENTRY ADDRESS                00019000
         USING ISTCC016,R12                                             00020000
         LA    R9,C16CBUF1   POINT TO EXIT WORK AREA           @ZD10878 00021000
         USING @DATD,R9      SET UP ADDRESSABILITY FOR SCRTCH  @ZD10878 00022000
*   RPLPTR=R1;                      /* SAVE POINTER TO RPL           */ 00023000
         LR    RPLPTR,R1                                           0155 00024000
*   WAPTR=RPLUSFLD;                                                0156 00025000
         L     WAPTR,RPLUSFLD(,RPLPTR)                             0156 00026000
*   R13=ADDR($EXITSAV);             /* SET UP PTR TO MY SAVEAREA     */ 00027000
         L     R13,RCAPTR(,WAPTR)                                  0157 00028000
         LA    R13,$EXITSAV(,R13)                                  0157 00029000
*   C16EXSAV=R14;                   /* SAVE R14 FOR RET TO VTAM      */ 00030000
*                                                                  0158 00031000
         ST    R14,C16EXSAV                                        0158 00032000
*   /*****************************************************************/ 00033000
*   /*                                                               */ 00034000
*   /* CHECK THE RPL SO IT IS NOT ACTIVE                             */ 00035000
*   /*                                                               */ 00036000
*   /*****************************************************************/ 00037000
*                                                                  0159 00038000
*   GEN(CHECK RPL=(RPLPTR));        /* CLEAR UP RPL BEFORE PROCESSING*/ 00039000
         CHECK RPL=(RPLPTR)                                             00040000
*   INDX=AP;                        /* FEEDBACK FOR AP               */ 00041000
         LA    INDX,2                                              0160 00042000
*   IF RPLPTR=ADDR($TLTRPL1) THEN   /* SET UP INDEX INTO TABLE     0161 00043000
*                                                            @D32JPGH*/ 00044000
         LA    @00,$TLTRPL1(,WAPTR)                                0161 00045000
         CR    RPLPTR,@00                                          0161 00046000
         BNE   @RF00161                                            0161 00047000
*     INDX=CT;                      /* FEEDBACK FOR CT               */ 00048000
*                                                                  0162 00049000
         LA    INDX,1                                              0162 00050000
*   /*****************************************************************/ 00051000
*   /*                                                               */ 00052000
*   /* CHK FOR TEMP ERRORS RETRY IF POSSIBLE                         */ 00053000
*   /*                                                               */ 00054000
*   /*****************************************************************/ 00055000
*                                                                  0163 00056000
*   IF(RPLRTNCD='08'X&RPLFDB2='00'X)|(RPLRTNCD='0C'X&(RPLFDB2='03'X|    00057000
*       RPLFDB2='05'X)) THEN                                       0163 00058000
@RF00161 CLI   RPLRTNCD(RPLPTR),8                                  0163 00059000
         BNE   @GL00001                                            0163 00060000
         CLI   RPLFDB2(RPLPTR),0                                   0163 00061000
         BE    @RT00163                                            0163 00062000
@GL00001 CLI   RPLRTNCD(RPLPTR),12                                 0163 00063000
         BNE   @RF00163                                            0163 00064000
         CLI   RPLFDB2(RPLPTR),3                                   0163 00065000
         BE    @RT00163                                            0163 00066000
         CLI   RPLFDB2(RPLPTR),5                                   0163 00067000
         BE    @RT00163                                            0163 00068000
*     GOTO C16C0225;                                               0164 00069000
*   IF RPLRTNCD¬='00'X              /* IF THERE WAS AN ERROR         */ 00070000
*     THEN                                                         0165 00071000
@RF00163 CLI   RPLRTNCD(RPLPTR),0                                  0165 00072000
         BE    @RF00165                                            0165 00073000
*     DO;                                                          0166 00074000
*       IF RPLRTNCD='0C'X&(RPLFDB2>='0A'X&RPLFDB2<='0C'X)/* CHECK TO    00075000
*                                      SEE IF WE SHOULD STOP @D32JPGH*/ 00076000
*         THEN                                                     0167 00077000
         CLI   RPLRTNCD(RPLPTR),12                                 0167 00078000
         BNE   @RF00167                                            0167 00079000
         CLI   RPLFDB2(RPLPTR),10                                  0167 00080000
         BL    @RF00167                                            0167 00081000
         CLI   RPLFDB2(RPLPTR),12                                  0167 00082000
         BH    @RF00167                                            0167 00083000
*         DO;                       /* NOT ERROR, BUT GET OUT NOW    */ 00084000
*           CALL C16C0910;          /* FREE CURRENT ELEMENT          */ 00085000
         BAL   @14,C16C0910                                        0169 00086000
*           GOTO C16C0251;          /* EXIT FROM THIS MODULE         */ 00087000
         B     C16C0251                                            0170 00088000
*         END;                      /* END OF NOT ERROR,BUT STOP CODE*/ 00089000
*       IF RPLRTNCD<=4&$DEVLU(INDX)=ON THEN/* IF LU STATUS PASSED  0172 00090000
*                                      BACK                  @DM00895*/ 00091000
@RF00167 CLI   RPLRTNCD(RPLPTR),4                                  0172 00092000
         BH    @RF00172                                            0172 00093000
         LR    @11,INDX                                            0172 00094000
         MH    @11,@CH00337                                        0172 00095000
         ALR   @11,WAPTR                                           0172 00096000
         TM    $DEVLU-68(@11),B'00001000'                          0172 00097000
         BO    @RT00172                                            0172 00098000
*         GO TO C16C0253;           /* PROCESS THE FEEDBACK          */ 00099000
*       IF RPLRTNCD='0C'X&          /* WAS IT AN RFT RECEIVED        */ 00100000
*           RPLFDB2='02'X&INDX=CT   /* FROM THE CT                   */ 00101000
*         THEN                                                     0174 00102000
@RF00172 CLI   RPLRTNCD(RPLPTR),12                                 0174 00103000
         BNE   @RF00174                                            0174 00104000
         CLI   RPLFDB2(RPLPTR),2                                   0174 00105000
         BNE   @RF00174                                            0174 00106000
         C     INDX,@CF00072                                       0174 00107000
         BNE   @RF00174                                            0174 00108000
*         DO;                       /* IF YES DO THE FOLLOWING       */ 00109000
*           $RETREG=0;                                             0176 00110000
         SLR   @11,@11                                             0176 00111000
         ST    @11,$RETREG(,WAPTR)                                 0176 00112000
*           IF RPLAARLN=0 THEN                                     0177 00113000
         C     @11,RPLAARLN(,RPLPTR)                               0177 00114000
         BE    @RT00177                                            0177 00115000
*             GOTO C16C0100;                                       0178 00116000
*           ELSE                                                   0179 00117000
*             GOTO C16C0225;        /* GO & RETRY ORIG REQ           */ 00118000
         B     C16C0225                                            0179 00119000
*         END;                                                     0180 00120000
*       IF RPLRTNCD='04'X&          /* WAS AN ATTENTION RECEIVED     */ 00121000
*           RPLFDB2='01'X&INDX=CT   /* FROM CT                       */ 00122000
*         THEN                      /* THEN DO THE FOLLOWING         */ 00123000
@RF00174 CLI   RPLRTNCD(RPLPTR),4                                  0181 00124000
         BNE   @RF00181                                            0181 00125000
         CLI   RPLFDB2(RPLPTR),1                                   0181 00126000
         BNE   @RF00181                                            0181 00127000
         C     INDX,@CF00072                                       0181 00128000
         BNE   @RF00181                                            0181 00129000
*         DO;                                                      0182 00130000
*           $CIREQ=ON;              /* SET C. I. REQ ON              */ 00131000
         OI    $CIREQ(WAPTR),B'00000001'                           0183 00132000
*           $RETREG=0;              /* SET ZERO RETURN CODE          */ 00133000
         SLR   @00,@00                                             0184 00134000
         ST    @00,$RETREG(,WAPTR)                                 0184 00135000
*           GOTO C16C0100;                                         0185 00136000
         B     C16C0100                                            0185 00137000
*         END;                                                     0186 00138000
*       $RETREG=8;                  /* SET ERROR RC = 8              */ 00139000
@RF00181 MVC   $RETREG(4,WAPTR),@CF00054                           0187 00140000
*C16C0075:                                                         0188 00141000
*       CALL C16C0920;              /* SET ERROR STATUS              */ 00142000
C16C0075 BAL   @14,C16C0920                                        0188 00143000
*       GO TO C16C0251;             /* EXIT FROM THE MODULE          */ 00144000
         B     C16C0251                                            0189 00145000
*     END;                                                         0190 00146000
*   ELSE                                                           0191 00147000
*     $RETREG=0;                    /* SET GOOD RC OF 00             */ 00148000
@RF00165 SLR   @00,@00                                             0191 00149000
         ST    @00,$RETREG(,WAPTR)                                 0191 00150000
*C16C0100:                                                         0192 00151000
*   ;                                                              0192 00152000
C16C0100 DS    0H                                                  0193 00153000
*   IF $DEVLU(INDX)=ON              /* IF DEVICE IS AN LU            */ 00154000
*     THEN                                                         0193 00155000
         LR    @11,INDX                                            0193 00156000
         MH    @11,@CH00337                                        0193 00157000
         ST    @11,@TF00001                                        0193 00158000
         ALR   @11,WAPTR                                           0193 00159000
         TM    $DEVLU-68(@11),B'00001000'                          0193 00160000
         BO    @RT00193                                            0193 00161000
*     GOTO C16C0253;                /* THIS CODE HANDLES LU        0194 00162000
*                                      INFORMATION                   */ 00163000
*   IF INCT¬=0                      /* ONE WAY MSG?                  */ 00164000
*     THEN                                                         0195 00165000
         L     @11,@TF00001                                        0195 00166000
         L     @11,$CURELEM-68(@11,WAPTR)                          0195 00167000
         CLI   INCT(@11),0                                         0195 00168000
         BE    @RF00195                                            0195 00169000
*     DO;                                                          0196 00170000
*       IF RPLREQ='11'X|(RPLREQ='1D'X&RPLREOT=OFF)/* IF WRITE OR READ   00171000
*                                      FOR EOT                       */ 00172000
*         THEN                                                     0197 00173000
         CLI   RPLREQ(RPLPTR),17                                   0197 00174000
         BE    @RT00197                                            0197 00175000
         CLI   RPLREQ(RPLPTR),29                                   0197 00176000
         BNE   @RF00197                                            0197 00177000
         TM    RPLREOT(RPLPTR),B'00001000'                         0197 00178000
         BNZ   @RF00197                                            0197 00179000
@RT00197 DS    0H                                                  0198 00180000
*         DO;                       /* READING DATA FROM CT          */ 00181000
*           IF $DVINCT(1)¬=0 THEN                                  0199 00182000
         CLI   $DVINCT(WAPTR),0                                    0199 00183000
         BE    @RF00199                                            0199 00184000
*             DO;                                                  0200 00185000
*               RPLBUFL=$DVINCT(1); /* SET READ COUNT                */ 00186000
         SLR   @00,@00                                             0201 00187000
         IC    @00,$DVINCT(,WAPTR)                                 0201 00188000
         ST    @00,RPLBUFL(,RPLPTR)                                0201 00189000
*               RPLAREA=ADDR($TRMINPT);/* POINT TO BUFFER            */ 00190000
         LA    @00,$TRMINPT(,WAPTR)                                0202 00191000
         ST    @00,RPLAREA(,RPLPTR)                                0202 00192000
*             END;                                                 0203 00193000
*           ELSE                                                   0204 00194000
*             DO;                                                  0204 00195000
         B     @RC00199                                            0204 00196000
@RF00199 DS    0H                                                  0205 00197000
*               RPLBUFL=LENGTH(SCRATCH);                           0205 00198000
         MVC   RPLBUFL(4,RPLPTR),@CF00072                          0205 00199000
*               RPLAREA=ADDR(SCRATCH);                             0206 00200000
         LA    @00,SCRATCH                                         0206 00201000
         ST    @00,RPLAREA(,RPLPTR)                                0206 00202000
*             END;                                                 0207 00203000
*           GEN REFS(RPLPTR,ARG,ISTCC016);                         0208 00204000
@RC00199 DS    0H                                                  0208 00205000
*                                 /* READ DATA */                       00206000
 READ RPL=(RPLPTR),EXIT=ISTCC016,OPTCD=(ASY,TRUNC)                      00207000
*           IF R15¬=0 THEN          /* IF ERROR, GET OUT FAST        */ 00208000
         LTR   R15,R15                                             0209 00209000
         BNZ   @RT00209                                            0209 00210000
*             GO TO C16C0075;       /* EXIT THE MODULE               */ 00211000
*           $DVINCT(1)=0;           /* READ NO MORE DATA             */ 00212000
         MVI   $DVINCT(WAPTR),X'00'                                0211 00213000
*           GOTO C16C0251;          /* EXIT                          */ 00214000
         B     C16C0251                                            0212 00215000
*         END;                      /* END OF READ FOR DATA          */ 00216000
*       CALL C16C0900;              /* PUT DATA IN CALLERS BUFFER    */ 00217000
@RF00197 BAL   @14,C16C0900                                        0214 00218000
*     END;                          /* END OF GETTING DATA FOR     0215 00219000
*                                      TERMINAL                      */ 00220000
*C16C0200:                                                         0216 00221000
*   IF INDX=CT&                     /* CHECK FOR LOGOFF RECEIVED     */ 00222000
*       RPLFDB3='04'X               /* IF YES                        */ 00223000
*     THEN                                                         0216 00224000
@RF00195 DS    0H                                                  0216 00225000
C16C0200 C     INDX,@CF00072                                       0216 00226000
         BNE   @RF00216                                            0216 00227000
         CLI   RPLFDB3(RPLPTR),4                                   0216 00228000
         BNE   @RF00216                                            0216 00229000
*     $EOJ=ON;                      /* SET EOJ FLAG TO FORCE CANCEL  */ 00230000
         OI    $EOJ(WAPTR),B'00000010'                             0217 00231000
*C16C0250:                                                         0218 00232000
*   RPLSAVE=$CURELEM(INDX);         /* SAVE PTR TO CURRENT ELEM      */ 00233000
@RF00216 DS    0H                                                  0218 00234000
C16C0250 LR    @11,INDX                                            0218 00235000
         MH    @11,@CH00337                                        0218 00236000
         L     @00,$CURELEM-68(@11,WAPTR)                          0218 00237000
         ST    @00,RPLSAVE                                         0218 00238000
*   RESPECIFY                                                      0219 00239000
*     PTR1 RESTRICTED;              /* DONT LET THIS REG GET ALTERED */ 00240000
*   PTR1=INDX;                      /* POINT TO PARTICULAR ENTRY     */ 00241000
         LR    PTR1,INDX                                           0220 00242000
*   CALL C16C0265;                  /* START THE NEXT RPL            */ 00243000
         BAL   @14,C16C0265                                        0221 00244000
*   RESPECIFY                                                      0222 00245000
*     PTR1 UNRESTRICTED;            /* RELEASE THIS REGISTER FOR USE */ 00246000
*   RPLPTR=RPLSAVE;                 /* RESTORE ELEM PTR              */ 00247000
         L     RPLPTR,RPLSAVE                                      0223 00248000
*   IF RPLPTR¬=0 THEN               /* ONLY RELEASE IF THERE IS    0224 00249000
*                                      SOMETHING TO RELEASE          */ 00250000
         LTR   RPLPTR,RPLPTR                                       0224 00251000
         BZ    @RF00224                                            0224 00252000
*     CALL C16C0270;                /* FREE LAST RPL WE ARE DONE     */ 00253000
         BAL   @14,C16C0270                                        0225 00254000
*C16C0251:                                                         0226 00255000
*   ;                                                              0226 00256000
@RF00224 DS    0H                                                  0226 00257000
C16C0251 DS    0H                                                  0227 00258000
*   R14=C16EXSAV;                   /* RESTORE RET REG               */ 00259000
         L     R14,C16EXSAV                                        0227 00260000
*   RETURN;                         /* RETURN TO VTAM                */ 00261000
@EL00001 DS    0H                                                  0228 00262000
@EF00001 DS    0H                                                  0228 00263000
@ER00001 BR    @14                                                 0228 00264000
*C16C0225:                                                         0229 00265000
*   GEN SETS(RPLPTR);                                              0229 00266000
C16C0225 DS    0H                                                  0229 00267000
         EXECRPL RPL=(RPLPTR)                                           00268000
*   IF R15¬=0 THEN                  /* CHECK FOR AN ERROR            */ 00269000
         LTR   R15,R15                                             0230 00270000
         BNZ   @RT00230                                            0230 00271000
*     GO TO C16C0075;               /* ERROR, GET OUT                */ 00272000
*   GOTO C16C0251;                                                 0232 00273000
         B     C16C0251                                            0232 00274000
*                                                                  0233 00275000
*   /*****************************************************************/ 00276000
*   /*                                                               */ 00277000
*   /* CODE TO HANDLE RECORD MODE                                    */ 00278000
*   /*                                                               */ 00279000
*   /*****************************************************************/ 00280000
*                                                                  0233 00281000
*C16C0253:                                                         0233 00282000
*   R6=0;                           /* SET FLAG FOR STARTING QUEUE 0233 00283000
*                                      AFTER RESPONSE OR NOT         */ 00284000
C16C0253 SLR   R6,R6                                               0233 00285000
*   IF RPLRRESP=OFF                 /* IF IT IS A RESPONSE           */ 00286000
*     THEN                                                         0234 00287000
         LA    @11,16                                              0234 00288000
         ALR   @11,RPLPTR                                          0234 00289000
         TM    RPLRRESP(@11),B'00001000'                           0234 00290000
         BNZ   @RF00234                                            0234 00291000
*     DO;                                                          0235 00292000
*                                                                  0235 00293000
*       /*************************************************************/ 00294000
*       /*                                                           */ 00295000
*       /* NOT A RESPONSE,EITHER NORMAL OR EXPIDITED FLOW            */ 00296000
*       /*                                                           */ 00297000
*       /*************************************************************/ 00298000
*                                                                  0236 00299000
*       IF RPLNFSYN=OFF             /* IF IT IS NOT SYNCHRONEOUS     */ 00300000
*         THEN                                                     0236 00301000
         TM    RPLNFSYN(@11),B'00000100'                           0236 00302000
         BNZ   @RF00236                                            0236 00303000
*         DO;                                                      0237 00304000
*           IF RPLSEQNO¬=$DVSEQNO(INDX)/* CHECK FOR SEQ ERRORS       */ 00305000
*             THEN                                                 0238 00306000
         LR    @11,INDX                                            0238 00307000
         MH    @11,@CH00337                                        0238 00308000
         ALR   @11,WAPTR                                           0238 00309000
         CLC   RPLSEQNO+60(2,RPLPTR),$DVSEQNO-68(@11)              0238 00310000
         BE    @RF00238                                            0238 00311000
*             DO;                                                  0239 00312000
*               RPLSSNSO='0201'X;   /* SET ERROR STATUS              */ 00313000
         MVC   RPLSSNSO(2,RPLPTR),@CB01933                         0240 00314000
*               GOTO C16C0300;      /* SEND RESPONSE                 */ 00315000
         B     C16C0300                                            0241 00316000
*             END;                                                 0242 00317000
*           $DVSEQNO(INDX)=$DVSEQNO(INDX)+1;/* INCREMENT SEQ # BY 1  */ 00318000
@RF00238 LR    @11,INDX                                            0243 00319000
         MH    @11,@CH00337                                        0243 00320000
         LA    @00,1                                               0243 00321000
         LH    @10,$DVSEQNO-68(@11,WAPTR)                          0243 00322000
         N     @10,@CF02031                                        0243 00323000
         ALR   @00,@10                                             0243 00324000
         STH   @00,$DVSEQNO-68(@11,WAPTR)                          0243 00325000
*         END;                                                     0244 00326000
*       IF BINBRAK=ON               /* IF BOUND WITH BRACKETS        */ 00327000
*         THEN                                                     0245 00328000
@RF00236 LR    @11,INDX                                            0245 00329000
         MH    @11,@CH00337                                        0245 00330000
         LA    @10,$DEVSESP-68(@11,WAPTR)                          0245 00331000
         TM    BINBRAK-1(@10),B'00100000'                          0245 00332000
         BNO   @RF00245                                            0245 00333000
*         DO;                                                      0246 00334000
*           IF RPLBB=ON             /* IF BEGIN BRACKET ON           */ 00335000
*             THEN                                                 0247 00336000
         TM    RPLBB+16(RPLPTR),B'10000000'                        0247 00337000
         BNO   @RF00247                                            0247 00338000
*             $DVBRKST(INDX)=INB;   /* GOING INTO BRACKET            */ 00339000
         LA    @00,1                                               0248 00340000
         STC   @00,$DVBRKST-68(@11,WAPTR)                          0248 00341000
*           IF RPLEB=ON             /* IF END BRACKET ON             */ 00342000
*             THEN                                                 0249 00343000
@RF00247 TM    RPLEB+16(RPLPTR),B'01000000'                        0249 00344000
         BNO   @RF00249                                            0249 00345000
*             $DVBRKST(INDX)=BETB;  /* GOING TO BETWEEN BRACKETS     */ 00346000
         LR    @11,INDX                                            0250 00347000
         MH    @11,@CH00337                                        0250 00348000
         SLR   @00,@00                                             0250 00349000
         STC   @00,$DVBRKST-68(@11,WAPTR)                          0250 00350000
*         END;                                                     0251 00351000
@RF00249 DS    0H                                                  0252 00352000
*       N=MIN(RPLBUFL,RPLRLEN);     /* GET NUMBER OF BYTES GIVEN BY     00353000
*                                      VTAM                          */ 00354000
@RF00245 L     @00,RPLBUFL(,RPLPTR)                                0252 00355000
         L     @11,RPLRLEN(,RPLPTR)                                0252 00356000
         CR    @00,@11                                             0252 00357000
         BNH   *+6                                                      00358000
         LR    @00,@11                                             0252 00359000
         STH   @00,N                                               0252 00360000
*       IF $ASCII(INDX)=ON&RPLCSI=ON/* IF ASCII                      */ 00361000
*         THEN                                                     0253 00362000
         LR    @11,INDX                                            0253 00363000
         MH    @11,@CH00337                                        0253 00364000
         ALR   @11,WAPTR                                           0253 00365000
         TM    $ASCII-68(@11),B'00000100'                          0253 00366000
         BNO   @RF00253                                            0253 00367000
         TM    RPLCSI+16(RPLPTR),B'00001000'                       0253 00368000
         BNO   @RF00253                                            0253 00369000
*         DO I=1 TO N;              /* TRANSLATE EACH CHARACTER TO 0254 00370000
*                                      ASCII                         */ 00371000
         LA    @00,1                                               0254 00372000
         B     @DE00254                                            0254 00373000
@DL00254 DS    0H                                                  0255 00374000
*           DO M=1 TO LENGTH($TRASCII);/* SEARCH FOR ASCII MATCH     */ 00375000
         LA    @00,1                                               0255 00376000
         STH   @00,M                                               0255 00377000
@DL00255 DS    0H                                                  0256 00378000
*             IF $TRMINPT(I)=$TRASCII(M)/* IF CHAR FOUND IN TABLE    */ 00379000
*               THEN                                               0256 00380000
         LH    @11,I                                               0256 00381000
         L     @10,RCAPTR(,WAPTR)                                  0256 00382000
         ALR   @11,WAPTR                                           0256 00383000
         ALR   @10,@00                                             0256 00384000
         CLC   $TRMINPT-1(1,@11),$TRASCII-1(@10)                   0256 00385000
         BNE   @RF00256                                            0256 00386000
*               DO;                                                0257 00387000
*                 $TRMINPT(I)=M-1;  /* SET TO EBCDIC VALUE           */ 00388000
         LH    @11,I                                               0258 00389000
         BCTR  @00,0                                               0258 00390000
         STC   @00,$TRMINPT-1(@11,WAPTR)                           0258 00391000
*                 GOTO C16C0254;                                   0259 00392000
         B     C16C0254                                            0259 00393000
*               END;                                               0260 00394000
*           END;                                                   0261 00395000
@RF00256 LA    @00,1                                               0261 00396000
         AH    @00,M                                               0261 00397000
         STH   @00,M                                               0261 00398000
         C     @00,@CF00083                                        0261 00399000
         BNH   @DL00255                                            0261 00400000
*           RPLSSNSO='1001'X;       /* SET ERROR STATUS              */ 00401000
         MVC   RPLSSNSO(2,RPLPTR),@CB01937                         0262 00402000
*           GOTO C16C0300;          /* SEND RESPONSE                 */ 00403000
         B     C16C0300                                            0263 00404000
*C16C0254:                                                         0264 00405000
*         END;                                                     0264 00406000
C16C0254 LA    @00,1                                               0264 00407000
         AH    @00,I                                               0264 00408000
@DE00254 STH   @00,I                                               0264 00409000
         CH    @00,N                                               0264 00410000
         BNH   @DL00254                                            0264 00411000
*       IF RPLDATA=OFF              /* IF NO DATA RECEIVED           */ 00412000
*         THEN                                                     0265 00413000
@RF00253 LA    @11,16                                              0265 00414000
         ALR   @11,RPLPTR                                          0265 00415000
         TM    RPLDATA(@11),B'10000000'                            0265 00416000
         BNZ   @RF00265                                            0265 00417000
*         DO;                       /* THIS IS A CONTROL FUNCTION    */ 00418000
*                                                                  0266 00419000
*           /*********************************************************/ 00420000
*           /*                                                       */ 00421000
*           /* PROCESSING A FUNCTION NOT DATA                        */ 00422000
*           /*                                                       */ 00423000
*           /*********************************************************/ 00424000
*                                                                  0267 00425000
*           IF RPLCNCEL=ON          /* WAS CANCEL REQUESTED          */ 00426000
*             THEN                                                 0267 00427000
         TM    RPLCNCEL(@11),B'01000000'                           0267 00428000
         BNO   @RF00267                                            0267 00429000
*             DO;                                                  0268 00430000
*               $DVINCT(INDX)=LENGTH($TRMINPT);/* READ A NEW MESSAGE */ 00431000
         LR    @11,INDX                                            0269 00432000
         MH    @11,@CH00337                                        0269 00433000
         LA    @00,80                                              0269 00434000
         STC   @00,$DVINCT-68(@11,WAPTR)                           0269 00435000
*               $TRMINPT=$TRMINPT&&$TRMINPT;/* SCRATCH OLD MSG       */ 00436000
         XC    $TRMINPT(80,WAPTR),$TRMINPT(WAPTR)                  0270 00437000
*               GOTO C16C0300;                                     0271 00438000
         B     C16C0300                                            0271 00439000
*             END;                  /* SEND RESPONSE                 */ 00440000
*           IF RPLSIGNL=ON          /* IS IT A SIGNAL                */ 00441000
*             THEN                                                 0273 00442000
@RF00267 TM    RPLSIGNL+16(RPLPTR),B'00010000'                     0273 00443000
         BNO   @RF00273                                            0273 00444000
*             DO;                                                  0274 00445000
*               $CIREQ=ON;          /* COMMUNICATION INTERVAL      0275 00446000
*                                      REQUIRED                      */ 00447000
         OI    $CIREQ(WAPTR),B'00000001'                           0275 00448000
*               GOTO C16C0300;      /* SEND RESPONSE                 */ 00449000
         B     C16C0300                                            0276 00450000
*             END;                                                 0277 00451000
*           IF RPLCHASE=ON          /* IS IT A CHASE                 */ 00452000
*             THEN                                                 0278 00453000
@RF00273 LA    @11,16                                              0278 00454000
         ALR   @11,RPLPTR                                          0278 00455000
         TM    RPLCHASE(@11),B'00001000'                           0278 00456000
         BO    @RT00278                                            0278 00457000
*             GOTO C16C0300;        /* SEND RESPONSE                 */ 00458000
*           IF RPLLUS=ON            /* IS LU STATU BEING SENT        */ 00459000
*             THEN                                                 0280 00460000
         TM    RPLLUS(@11),B'00100000'                             0280 00461000
         BNO   @RF00280                                            0280 00462000
*             IF RPLSSEI=0          /* IS ERROR STATUS ZERO          */ 00463000
*               THEN                                               0281 00464000
         CLI   RPLSSEI(RPLPTR),0                                   0281 00465000
         BE    @RT00281                                            0281 00466000
*               GOTO C16C0300;      /* SEND RESPONSE                 */ 00467000
*             ELSE                                                 0283 00468000
*               GOTO C16C0075;                                     0283 00469000
         B     C16C0075                                            0283 00470000
*           IF RPLSHUTD=ON|RPLSHUTC=ON|RPLRSHUT=ON/* IF ANY SHUTDOWN    00471000
*                                      REQUESTS ARE ON               */ 00472000
*             THEN                                                 0284 00473000
@RF00280 LA    @11,16                                              0284 00474000
         ALR   @11,RPLPTR                                          0284 00475000
         TM    RPLSHUTD(@11),B'00011010'                           0284 00476000
         BNZ   @RT00284                                            0284 00477000
*             GOTO C16C0075;                                       0285 00478000
*           IF RPLRTR=ON            /* IS TERMINAL READY TO RECEIVE     00479000
*                                      DATA                          */ 00480000
*             THEN                                                 0286 00481000
         TM    RPLRTR(@11),B'01000000'                             0286 00482000
         BNO   @RF00286                                            0286 00483000
*             RPLSSNSO='0819'X;     /* SET ERROR STATUS              */ 00484000
         MVC   RPLSSNSO(2,RPLPTR),@CB01939                         0287 00485000
*           ELSE                                                   0288 00486000
*             RPLSSNSO='1007'X;     /* SET ERROR STATUS              */ 00487000
         B     @RC00286                                            0288 00488000
@RF00286 MVC   RPLSSNSO(2,RPLPTR),@CB01940                         0288 00489000
*           GOTO C16C0300;          /* SEND RESPONSE                 */ 00490000
         B     C16C0300                                            0289 00491000
*         END;                                                     0290 00492000
*       IF RPLFMHDR=ON              /* IS THERE AN FM HEADER @DM00898*/ 00493000
*         THEN                      /*                       @DM00898*/ 00494000
@RF00265 TM    RPLFMHDR(RPLPTR),B'00000001'                        0291 00495000
         BNO   @RF00291                                            0291 00496000
*         DO;                       /*                       @DM00898*/ 00497000
*           RPLSSNSO='1008'X;       /* SET ERROR STATUS      @DM00898*/ 00498000
         MVC   RPLSSNSO(2,RPLPTR),@CB01941                         0293 00499000
*           GOTO C16C0300;          /* SEND RESPONSE         @DM00898*/ 00500000
         B     C16C0300                                            0294 00501000
*         END;                      /*                       @DM00898*/ 00502000
*                                                                  0295 00503000
*       /*************************************************************/ 00504000
*       /*                                                           */ 00505000
*       /* DATA RECEIVED,CHECK IF WE MUST WAIT FOR MORE              */ 00506000
*       /*                                                           */ 00507000
*       /*************************************************************/ 00508000
*                                                                  0296 00509000
*       IF RPLONLY¬=ON&RPLLAST¬=ON  /* IS IT END OF CHAIN            */ 00510000
*         THEN                                                     0296 00511000
@RF00291 TM    RPLONLY+16(RPLPTR),B'00110000'                      0296 00512000
         BNZ   @RF00296                                            0296 00513000
*         DO;                                                      0297 00514000
*           $DVINCT(INDX)=0;        /* DON'T READ ANYMORE DATA FROM     00515000
*                                      TERMINAL                      */ 00516000
         LR    @11,INDX                                            0298 00517000
         MH    @11,@CH00337                                        0298 00518000
         SLR   @00,@00                                             0298 00519000
         STC   @00,$DVINCT-68(@11,WAPTR)                           0298 00520000
*           GOTO C16C0300;          /* SEND RESPONSE                 */ 00521000
         B     C16C0300                                            0299 00522000
*         END;                                                     0300 00523000
*       IF $CURELEM(INDX)=0|INCT=0|$DVSNDOK(INDX)='0'B/* IF NO     0301 00524000
*                                      ELEMENTS                      */ 00525000
*         THEN                                                     0301 00526000
@RF00296 LR    @11,INDX                                            0301 00527000
         MH    @11,@CH00337                                        0301 00528000
         L     @10,$CURELEM-68(@11,WAPTR)                          0301 00529000
         LTR   @10,@10                                             0301 00530000
         BZ    @RT00301                                            0301 00531000
         CLI   INCT(@10),0                                         0301 00532000
         BE    @RT00301                                            0301 00533000
         ALR   @11,WAPTR                                           0301 00534000
         TM    $DVSNDOK-68(@11),B'00010000'                        0301 00535000
         BNZ   @RF00301                                            0301 00536000
@RT00301 DS    0H                                                  0302 00537000
*         $CIREQ=ON;                /* COMMUNICATION INTERVAL      0302 00538000
*                                      REQUIRED                      */ 00539000
         OI    $CIREQ(WAPTR),B'00000001'                           0302 00540000
*       ELSE                                                       0303 00541000
*         DO;                       /* DATA RECEIVED FROM CT, PASS IT   00542000
*                                      BACK                          */ 00543000
         B     @RC00301                                            0303 00544000
@RF00301 DS    0H                                                  0304 00545000
*           CALL C16C0900;          /* PASS BACK RESPONSE TO CALLER  */ 00546000
         BAL   @14,C16C0900                                        0304 00547000
*           R6=1;                   /* START NEXT ELEMENT ON QUEUE   */ 00548000
         LA    R6,1                                                0305 00549000
*         END;                      /* END OF DATA RECEIVED FROM CT  */ 00550000
*C16C0300:                                                         0307 00551000
*       IF(RPLNFME=OFF|RPLRRN=ON)&  /* IF RESP TYPE 1 OR 2   @DM00899*/ 00552000
*           (RPLEX=OFF|RPLSSEO¬=0) THEN/* AND NORMAL OR ECEPTION   0307 00553000
*                                                            @DM00899*/ 00554000
@RC00301 DS    0H                                                  0307 00555000
C16C0300 TM    RPLRRN+16(RPLPTR),B'00000001'                       0307 00556000
         BNZ   @GL00018                                            0307 00557000
         TM    RPLNFME+16(RPLPTR),B'00000010'                      0307 00558000
         BO    @RF00307                                            0307 00559000
@GL00018 TM    RPLEX+16(RPLPTR),B'00000100'                        0307 00560000
         BZ    @RT00307                                            0307 00561000
         CLI   RPLSSEO(RPLPTR),0                                   0307 00562000
         BE    @RF00307                                            0307 00563000
@RT00307 DS    0H                                                  0308 00564000
*         DO;                       /* RESPONSE REQUIRED TO INBOUND     00565000
*                                      REQUEST               @DM00899*/ 00566000
*           IF RPLSSEO¬=0 THEN      /* EXCEPTION RESPONSE    @DM00899*/ 00567000
         CLI   RPLSSEO(RPLPTR),0                                   0309 00568000
         BE    @RF00309                                            0309 00569000
*             RPLEX=ON;             /* YES,SET EXCEPTION BIT @DM00899*/ 00570000
         OI    RPLEX+16(RPLPTR),B'00000100'                        0310 00571000
*           ARG=$CID(INDX);         /* PICK UP THE CID               */ 00572000
@RF00309 LR    @11,INDX                                            0311 00573000
         MH    @11,@CH00337                                        0311 00574000
         ALR   @11,WAPTR                                           0311 00575000
         ICM   ARG,15,$CID-68(@11)                                 0311 00576000
*           GEN REFS(RPLPTR,ARG);                                  0312 00577000
*                        /* SEND RESPONSE */                            00578000
 SEND RPL=(RPLPTR),POST=SCHED,STYPE=RESP,OPTCD=SYN,ARG=(ARG)            00579000
*           IF R15¬=0 THEN          /* CHECK FOR ERROR RETURN CODE   */ 00580000
         LTR   R15,R15                                             0313 00581000
         BNZ   @RT00313                                            0313 00582000
*             GO TO C16C0075;       /* ERROR, GET OUT                */ 00583000
*         END;                                                     0315 00584000
*       IF R6¬=0|$CURELEM(INDX)=0   /* SHOULD WE FREE THIS ELEMENT 0316 00585000
*                                      AND START ANEW        @DM00899*/ 00586000
*         THEN                                                     0316 00587000
@RF00307 SLR   @11,@11                                             0316 00588000
         CR    R6,@11                                              0316 00589000
         BNE   @RT00316                                            0316 00590000
         LR    @10,INDX                                            0316 00591000
         MH    @10,@CH00337                                        0316 00592000
         C     @11,$CURELEM-68(@10,WAPTR)                          0316 00593000
         BE    @RT00316                                            0316 00594000
*         GOTO C16C0250;            /* GET NEXT MESSAGE              */ 00595000
*C16C0256:                                                         0318 00596000
*       RPLAREA=ADDR($TRMINPT);     /* POINT TO THE BUFFER           */ 00597000
C16C0256 LA    @00,$TRMINPT(,WAPTR)                                0318 00598000
         ST    @00,RPLAREA(,RPLPTR)                                0318 00599000
*       RPLBUFL=$DVINCT(INDX);      /* SET FOR NUMBER OF BYTES TO  0319 00600000
*                                      READ                          */ 00601000
         LR    @11,INDX                                            0319 00602000
         MH    @11,@CH00337                                        0319 00603000
         SLR   @00,@00                                             0319 00604000
         IC    @00,$DVINCT-68(@11,WAPTR)                           0319 00605000
         ST    @00,RPLBUFL(,RPLPTR)                                0319 00606000
*       ARG=$CID(INDX);             /* PICK UP THE CID               */ 00607000
         ALR   @11,WAPTR                                           0320 00608000
         ICM   ARG,15,$CID-68(@11)                                 0320 00609000
*       GEN REFS(RPLPTR,ARG);                                      0321 00610000
*                      /* DO A RECEIVE */                               00611000
 RECEIVE RPL=(RPLPTR),ARG=(ARG),EXIT=ISTCC016,                         X00612000
               OPTCD=(ASY,TRUNC,Q),RTYPE=(DFSYN,DFASY,RESP)             00613000
*       IF R15¬=0 THEN              /* CHECK FOR ERROR RETURN CODE   */ 00614000
         LTR   R15,R15                                             0322 00615000
         BNZ   @RT00322                                            0322 00616000
*         GO TO C16C0075;           /* IF ERROR,EXIT                 */ 00617000
*       GOTO C16C0251;              /* EXIT                          */ 00618000
         B     C16C0251                                            0324 00619000
*     END;                                                         0325 00620000
*                                                                  0325 00621000
*   /*****************************************************************/ 00622000
*   /*                                                               */ 00623000
*   /* RESPONSE RECEIVED FROM OUR REQUEST                            */ 00624000
*   /*                                                               */ 00625000
*   /*****************************************************************/ 00626000
*                                                                  0326 00627000
*   IF RPLEX=ON                     /* DID REQUEST TERMINATE WITH  0326 00628000
*                                      EXCEPTION                     */ 00629000
*     THEN                                                         0326 00630000
@RF00234 TM    RPLEX+16(RPLPTR),B'00000100'                        0326 00631000
         BNO   @RF00326                                            0326 00632000
*     DO;                           /* YES IT TERMINATED WITH AN   0327 00633000
*                                      EXCEPTION                     */ 00634000
*       IF RPLSSEI='08'X&(RPLSSMI='13'X|RPLSSMI='14'X|RPLSSMI='1B'X)    00635000
*                                   /* IS IT A TEMPORARY ERROR       */ 00636000
*         THEN                                                     0328 00637000
         CLI   RPLSSEI(RPLPTR),X'08'                               0328 00638000
         BNE   @RF00328                                            0328 00639000
         CLI   RPLSSMI(RPLPTR),19                                  0328 00640000
         BE    @RT00328                                            0328 00641000
         CLI   RPLSSMI(RPLPTR),20                                  0328 00642000
         BE    @RT00328                                            0328 00643000
         CLI   RPLSSMI(RPLPTR),27                                  0328 00644000
         BNE   @RF00328                                            0328 00645000
@RT00328 DS    0H                                                  0329 00646000
*         DO;                                                      0329 00647000
*           CALL C16C0280;          /* ADD ELEMENT BACK ON QUE       */ 00648000
         BAL   @14,C16C0280                                        0330 00649000
*           IF $DVSNDOK(INDX)=ON    /* IF OK TO SEND NEXT MSG        */ 00650000
*             THEN                                                 0331 00651000
         LR    @11,INDX                                            0331 00652000
         MH    @11,@CH00337                                        0331 00653000
         ALR   @11,WAPTR                                           0331 00654000
         TM    $DVSNDOK-68(@11),B'00010000'                        0331 00655000
         BO    @RT00331                                            0331 00656000
*             GOTO C16C0250;        /* GET ELEMENT OFF QUE AND START    00657000
*                                      IT                            */ 00658000
*           ELSE                                                   0333 00659000
*             GOTO C16C0256;        /* GOTO RECEIVE INPUT            */ 00660000
         B     C16C0256                                            0333 00661000
*         END;                                                     0334 00662000
*       ELSE                                                       0335 00663000
*         GOTO C16C0075;            /* FLAG CT OR AP AS AN ERROR     */ 00664000
*     END;                                                         0336 00665000
*   $DVSNDOK(INDX)=ON;                                             0337 00666000
@RF00326 LR    @11,INDX                                            0337 00667000
         MH    @11,@CH00337                                        0337 00668000
         ST    @11,@TF00001                                        0337 00669000
         ALR   @11,WAPTR                                           0337 00670000
         OI    $DVSNDOK-68(@11),B'00010000'                        0337 00671000
*   IF BINBRAK=ON                   /* IF BOUND WITH BRACKETS        */ 00672000
*     THEN                                                         0338 00673000
         L     @11,@TF00001                                        0338 00674000
         LA    @11,$DEVSESP-68(@11,WAPTR)                          0338 00675000
         BCTR  @11,0                                               0338 00676000
         TM    BINBRAK(@11),B'00100000'                            0338 00677000
         BNO   @RF00338                                            0338 00678000
*     IF BINBKTR=ON&$DVBRKSN(INDX)=SNDEB/* CHECK BRACKET             */ 00679000
*       THEN                                                       0339 00680000
         TM    BINBKTR(@11),B'00010000'                            0339 00681000
         BNO   @RF00339                                            0339 00682000
         L     @11,@TF00001                                        0339 00683000
         SLR   @00,@00                                             0339 00684000
         IC    @00,$DVBRKSN-68(@11,WAPTR)                          0339 00685000
         C     @00,@CF00139                                        0339 00686000
         BNE   @RF00339                                            0339 00687000
*       $DVBRKST(INDX)=BETB;        /* NOW BETWEEN BRACKETS          */ 00688000
         SLR   @00,@00                                             0340 00689000
         L     @11,@TF00001                                        0340 00690000
         STC   @00,$DVBRKST-68(@11,WAPTR)                          0340 00691000
*     ELSE                                                         0341 00692000
*       IF $DVBRKSN(INDX)=SNDBB     /* WAS BEGIN BRACKET SUCCESSFUL  */ 00693000
*         THEN                                                     0341 00694000
         B     @RC00339                                            0341 00695000
@RF00339 LA    @11,1                                               0341 00696000
         LR    @10,INDX                                            0341 00697000
         MH    @10,@CH00337                                        0341 00698000
         SLR   @00,@00                                             0341 00699000
         IC    @00,$DVBRKSN-68(@10,WAPTR)                          0341 00700000
         CR    @11,@00                                             0341 00701000
         BNE   @RF00341                                            0341 00702000
*         $DVBRKST(INDX)=INB;       /* NOW IN BRACKET                */ 00703000
         STC   @11,$DVBRKST-68(@10,WAPTR)                          0342 00704000
*   IF $CURELEM(INDX)->INCT¬=0      /* POINT TO CURRENT ELEMENT AND     00705000
*                                      CHECK FOR INPUT               */ 00706000
*     THEN                                                         0343 00707000
@RF00341 DS    0H                                                  0343 00708000
@RC00339 DS    0H                                                  0343 00709000
@RF00338 LR    @11,INDX                                            0343 00710000
         MH    @11,@CH00337                                        0343 00711000
         L     @11,$CURELEM-68(@11,WAPTR)                          0343 00712000
         CLI   INCT(@11),0                                         0343 00713000
         BNE   @RT00343                                            0343 00714000
*     GOTO C16C0256;                /* GOTO RECEIVE INPUT            */ 00715000
*   GOTO C16C0250;                  /* GET ELEMENT OFF QUE AND START    00716000
*                                      IT                            */ 00717000
         B     C16C0250                                            0345 00718000
*   RESPECIFY                                                      0346 00719000
*    (R0,                                                          0346 00720000
*     R1) RESTRICTED;               /* DONT LET THESE REGISTERS GET     00721000
*                                      ALTRED                        */ 00722000
*C16C1000:                                                         0347 00723000
*   GEN REFS(C16C1000,BASE,R12,R13,R14,R15,C16CBUF2);              0347 00724000
C16C1000 DS    0H                                                  0347 00725000
*                                                 /*SETUP @ZD10878*/    00726000
         USING C16C1000,R15                                             00727000
         STM   R14,R12,12(R13)     SAVE CALLERS REGISTERS               00728000
         L     R12,BASE            PICK UP COMMON BASE ADDRESS          00729000
         DROP  R15                                                      00730000
         LA    R9,C16CBUF2 POINT TO MAINLINE WORK AREA         @ZD10878 00731000
*   SAVEA(2)=R13;                   /* SAVE ADDRESS OF CALLERS     0348 00732000
*                                      SAVEAREA                      */ 00733000
         ST    R13,SAVEA+4                                         0348 00734000
*   BACKSAVE(3)=ADDR(SAVEA);        /* POINT TO MY SAVEAREA          */ 00735000
         LA    @11,SAVEA                                           0349 00736000
         ST    @11,BACKSAVE+8(,R13)                                0349 00737000
*   R13=ADDR(SAVEA);                /* GET ADDRESS OF MY SAVEAREA    */ 00738000
         LR    R13,@11                                             0350 00739000
*   INDX=R1;                        /* POINT TO ENTRY IN DEV TABLE   */ 00740000
         LR    INDX,R1                                             0351 00741000
*   IF R0=0 THEN                    /* IF CALLED TO START A QUE      */ 00742000
         LTR   R0,R0                                               0352 00743000
         BNZ   @RF00352                                            0352 00744000
*     DO;                           /* THEN START THE QUEUE PASSED IN   00745000
*                                      R1                            */ 00746000
*       CALL C16C0265;              /* START THE QUEUE POINTED TO BY    00747000
*                                      R1                            */ 00748000
         BAL   @14,C16C0265                                        0354 00749000
*       GO TO C16C1050;             /* EXIT THE MODULE               */ 00750000
         B     C16C1050                                            0355 00751000
*     END;                          /* END OF ROUTINE TO START QUEUE */ 00752000
*   IF R0=4 THEN                    /* IF CALLED TO PURGE A QUEUE    */ 00753000
@RF00352 C     R0,@CF00068                                         0357 00754000
         BNE   @RF00357                                            0357 00755000
*     DO;                           /* PURGE QUEUE POINTED TO BY RU  */ 00756000
*       RESPECIFY                                                  0359 00757000
*        (PTR1,                                                    0359 00758000
*         PTR2) RESTRICTED;         /* DONT ALTER REGISTERS          */ 00759000
*       PTR2=PTR1;                  /* SAVE ADDRESS OF QUEUE         */ 00760000
         LR    PTR2,PTR1                                           0360 00761000
*       R0=0;                       /* INDICATE NO ELEMENTS ON CHAIN */ 00762000
         SLR   R0,R0                                               0361 00763000
*C16C1005:                                                         0362 00764000
*       PTR1=LASTCHN;               /* GET CHAIN PTR                 */ 00765000
C16C1005 L     PTR1,LASTCHN(,PTR2)                                 0362 00766000
*       CS(PTR1,R0,LASTCHN);        /* REMOVE ALL ELEMENTS FROM QUEUE*/ 00767000
         CS    PTR1,@00,LASTCHN(PTR2)                              0363 00768000
*       BC(4,C16C1005);             /* COMPARE AND SWAP FAILED, TRY     00769000
*                                      AGAIN                         */ 00770000
         BC    4,C16C1005                                          0364 00771000
*       IF((PTR1&GATEBIT0)¬=0) THEN /* CHECK FOR ANYTHING ON QUE   0365 00772000
*                                                            @ZD10874*/ 00773000
         LR    @11,PTR1                                            0365 00774000
         N     @11,@CF00650                                        0365 00775000
         LTR   @11,@11                                             0365 00776000
         BZ    @RF00365                                            0365 00777000
*         DO;                                                      0366 00778000
*           R8=PTR1;                /* POINT TO NEXT ELEMENT @DA04688*/ 00779000
         LR    R8,PTR1                                             0367 00780000
*C16C1025:                                                         0368 00781000
*           RPLPTR=R8;              /* POINT TO ELE TO BE FREED    0368 00782000
*                                                            @ZD10874*/ 00783000
C16C1025 LR    RPLPTR,R8                                           0368 00784000
*           R8=RPLPTR->CHAIN&GATEBIT0;/* POINT TO NEXT ELE   @ZD10874*/ 00785000
         L     R8,CHAIN(,RPLPTR)                                   0369 00786000
         N     R8,@CF00650                                         0369 00787000
*           CALL C16C0270;          /* FREE THIS ELEMENT     @ZD10874*/ 00788000
         BAL   @14,C16C0270                                        0370 00789000
*           IF R8¬=0 THEN           /* ANY ELEMENTS LEFT ON QUE    0371 00790000
*                                                            @ZD10874*/ 00791000
         LTR   R8,R8                                               0371 00792000
         BNZ   @RT00371                                            0371 00793000
*             GOTO C16C1025;        /* YES FREE IT           @ZD10874*/ 00794000
*         END;                      /* END OF LOOPING THOOUGHT THE 0373 00795000
*                                      ELEMENTS                      */ 00796000
*       GO TO C16C1050;             /* EXIT THE MODULE               */ 00797000
         B     C16C1050                                            0374 00798000
*     END;                          /* END OF FREEING HE QUE CODE    */ 00799000
*C16C1050:                                                         0376 00800000
*   GEN REFS(R13,R12,R14);                                         0376 00801000
@RF00357 DS    0H                                                  0376 00802000
C16C1050 DS    0H                                                  0376 00803000
         L     R13,4(R13)          PICK UP LAST SAVE AREA ADDRESS       00804000
         LM    R14,R12,12(R13)     RESTORE REGISTERS                    00805000
         BR    R14                 RETURN TO CALLER                     00806000
*   RESPECIFY                                                      0377 00807000
*    (PTR1,                                                        0377 00808000
*     PTR2) UNRESTRICTED;           /* REGISTERS ARE FREE AGAIN      */ 00809000
*   RESPECIFY                                                      0378 00810000
*    (R0,                                                          0378 00811000
*     R1) UNRESTRICTED;             /* RELEASE THESE REGISTERS FOR 0378 00812000
*                                      USE                           */ 00813000
*C16C0255:                                                         0379 00814000
*   PROC OPTIONS(NOSAVE,NOSAVEAREA);                               0379 00815000
         B     @PB00002                                            0379 00816000
C16C0255 DS    0H                                                  0380 00817000
*   RESPECIFY                                                      0380 00818000
*    (PTR1,                                                        0380 00819000
*     PTR2) RESTRICTED;             /* DONT ALTER REGISTERS          */ 00820000
*   R7=R14;                         /* SAVE R14 FOR RETRUN           */ 00821000
         LR    R7,R14                                              0381 00822000
*   PTR2=ADDR($MSGOTSD(INDX));      /* SAVE PTR1                     */ 00823000
         LR    @11,INDX                                            0382 00824000
         MH    @11,@CH00337                                        0382 00825000
         LA    PTR2,$MSGOTSD-68(@11,WAPTR)                         0382 00826000
*   PTR1=LASTCHN&GATEBIT0;          /* PTR TO 1ST ELEMENT            */ 00827000
         L     PTR1,LASTCHN(,PTR2)                                 0383 00828000
         N     PTR1,@CF00650                                       0383 00829000
*   IF PTR1=0 THEN                  /* IF NO OUTSTANDING MESSAGES    */ 00830000
         LTR   PTR1,PTR1                                           0384 00831000
         BNZ   @RF00384                                            0384 00832000
*     DO;                           /* HANDLE AS SPECIAL CASE        */ 00833000
*       LASTCHN=PTR1;               /* SET MESSAGES OUTSTANDING TO 0386 00834000
*                                      ZERO                          */ 00835000
         ST    PTR1,LASTCHN(,PTR2)                                 0386 00836000
*       R1=ADDR($TLTECB2);          /* POINT TO ECB TO BE POSTED   0387 00837000
*                                                            @ZD10879*/ 00838000
         L     R1,RCAPTR(,WAPTR)                                   0387 00839000
         LA    R1,$TLTECB2(,R1)                                    0387 00840000
*       IF $CTEQTT='1'B&($SNDRFLG='1'B|$EXIOWAT='1'B)/* POST ECB   0388 00841000
*                                                            @ZD10879*/ 00842000
*         THEN                                                     0388 00843000
         TM    $CTEQTT(WAPTR),B'00010000'                          0388 00844000
         BNO   @RF00388                                            0388 00845000
         TM    $SNDRFLG(WAPTR),B'00100100'                         0388 00846000
         BZ    @RF00388                                            0388 00847000
*         CALL I00C1001;            /* POST ECB              @ZD10879*/ 00848000
         L     @15,@CV01962                                        0389 00849000
         BALR  @14,@15                                             0389 00850000
*       PTR1=0;                     /* SHOW NO ELEMENT FOUND @ZD10879*/ 00851000
@RF00388 SLR   PTR1,PTR1                                           0390 00852000
*       GO TO C16C0260;             /* EXIT FROM THE FUNCTION        */ 00853000
         B     C16C0260                                            0391 00854000
*     END;                          /* END OF THE SPECIAL CASE       */ 00855000
*   DO WHILE((PTR1->CHAIN&GATEBIT0)¬=0);/* LOOP UNTIL LAST ELEMENT   */ 00856000
@RF00384 B     @DE00393                                            0393 00857000
@DL00393 DS    0H                                                  0394 00858000
*     PTR2=PTR1;                    /* ADDR OF PTR TO NEXT ELEMENT   */ 00859000
         LR    PTR2,PTR1                                           0394 00860000
*     PTR1=PTR2->CHAIN;             /* ADDR OF NEXT ELEMENT          */ 00861000
         L     PTR1,CHAIN(,PTR2)                                   0395 00862000
*   END;                            /* END OF LOOP LOOKING FOR LAST     00863000
*                                      ELEMENT                       */ 00864000
@DE00393 L     @00,CHAIN(,PTR1)                                    0396 00865000
         N     @00,@CF00650                                        0396 00866000
         LTR   @00,@00                                             0396 00867000
         BNZ   @DL00393                                            0396 00868000
*   PTR2->LASTCHN=GATEBIT1;         /* ZERO LAST CHAIN PTR           */ 00869000
         MVC   LASTCHN(4,PTR2),@CF00652                            0397 00870000
*C16C0260:                                                         0398 00871000
*   R14=R7;                         /* RETURN TO THE CALLER          */ 00872000
C16C0260 LR    R14,R7                                              0398 00873000
*   END C16C0255;                   /* END OF SUBROUTINE TO REMOVE 0399 00874000
*                                      ELEMENT FROM QUEUE            */ 00875000
@EL00002 DS    0H                                                  0399 00876000
@EF00002 DS    0H                                                  0399 00877000
@ER00002 BR    @14                                                 0399 00878000
*   RESPECIFY                                                      0400 00879000
*    (PTR1,                                                        0400 00880000
*     PTR2) UNRESTRICTED;           /* REGISTERS ARE FREE AGAIN      */ 00881000
*   RESPECIFY                                                      0401 00882000
*     R1 RESTRICTED;                /* DONT LET THIS REG GET ALTERED */ 00883000
*C16C0265:                                                         0402 00884000
*   PROC OPTIONS(NOSAVE,NOSAVEAREA);                               0402 00885000
C16C0265 DS    0H                                                  0403 00886000
*   R8=R14;                         /* SAVE THE RETURN ADDRESS       */ 00887000
         LR    R8,R14                                              0403 00888000
*   CALL C16C0255;                  /* GET AN RPL TO PROCESS         */ 00889000
         BAL   @14,C16C0255                                        0404 00890000
*   $CURELEM(INDX)=PTR1;                                           0405 00891000
         LR    @11,INDX                                            0405 00892000
         MH    @11,@CH00337                                        0405 00893000
         ST    PTR1,$CURELEM-68(@11,WAPTR)                         0405 00894000
*   RPLPTR=ADDR($TLTRPL1);          /* POINT TO THE CT RPL           */ 00895000
         LA    RPLPTR,$TLTRPL1(,WAPTR)                             0406 00896000
*   IF INDX=2 THEN                  /* CHECK TO SEE WHICH RPL IS   0407 00897000
*                                      CORRECT                       */ 00898000
         C     INDX,@CF00139                                       0407 00899000
         BNE   @RF00407                                            0407 00900000
*     RPLPTR=ADDR($TLTRPL2);        /* MUST BE AN AP                 */ 00901000
         LA    RPLPTR,$TLTRPL2(,WAPTR)                             0408 00902000
*   ARG=$CID(INDX);                 /* PICK UP THE CID               */ 00903000
@RF00407 LR    @11,INDX                                            0409 00904000
         MH    @11,@CH00337                                        0409 00905000
         ST    @11,@TF00001                                        0409 00906000
         ALR   @11,WAPTR                                           0409 00907000
         ICM   ARG,15,$CID-68(@11)                                 0409 00908000
*   RPLUSFLD=WAPTR;                 /* SAVE WAPTR            @DM30415*/ 00909000
         ST    WAPTR,RPLUSFLD(,RPLPTR)                             0410 00910000
*   IF R1¬=0 THEN                   /* CHECK FOR ELEMENT TO PROCESS  */ 00911000
         LTR   R1,R1                                               0411 00912000
         BZ    @RF00411                                            0411 00913000
*     DO;                           /* IF THER WAS A RETURNED      0412 00914000
*                                      ELEMENT, START IT             */ 00915000
*       RESPECIFY                                                  0413 00916000
*         R1 UNRESTRICTED;          /* RELEASE THIS REGISTER FOR USE */ 00917000
*       R7=ADDR(MSG);               /* POINT TO MSG TO BE SENT       */ 00918000
         L     @11,@TF00001                                        0414 00919000
         L     @11,$CURELEM-68(@11,WAPTR)                          0414 00920000
         LA    R7,MSG(,@11)                                        0414 00921000
*       R6=OUTCT;                   /* SET UP LENGTH OF OUTBOUND MSG */ 00922000
         SLR   R6,R6                                               0415 00923000
         IC    R6,OUTCT(,@11)                                      0415 00924000
*       IF $DEVLU(INDX)=OFF         /* IF NOT AN LU                  */ 00925000
*         THEN                                                     0416 00926000
         LR    @11,WAPTR                                           0416 00927000
         AL    @11,@TF00001                                        0416 00928000
         TM    $DEVLU-68(@11),B'00001000'                          0416 00929000
         BNZ   @RF00416                                            0416 00930000
*         DO;                                                      0417 00931000
*           IF $DVCTBYT(INDX)=OFF   /* IF NO CONTROL BYTE PRESENT    */ 00932000
*             THEN                                                 0418 00933000
         LR    @11,WAPTR                                           0418 00934000
         AL    @11,@TF00001                                        0418 00935000
         TM    $DVCTBYT-68(@11),B'00000010'                        0418 00936000
         BNZ   @RF00418                                            0418 00937000
*             GEN REFS(RPLPTR,ISTCC016,ARG,R6,R7);                 0419 00938000
 WRITE RPL=(RPLPTR),OPTCD=ASY,EXIT=ISTCC016,ARG=(ARG),                 X00939000
               AREA=(R7),RECLEN=(R6)                                    00940000
*           ELSE                                                   0420 00941000
*             DO;                                                  0420 00942000
         B     @RC00418                                            0420 00943000
@RF00418 DS    0H                                                  0421 00944000
*               R7=R7+1;            /* SKIP OVER CONTROL BYTE        */ 00945000
         AL    R7,@CF00072                                         0421 00946000
*               R6=R6-1;            /* REDUCE THE COUNT              */ 00947000
         BCTR  R6,0                                                0422 00948000
*               IF MSG(1)='1'       /* SHOULD SCREEN BE ERASED       */ 00949000
*                 THEN                                             0423 00950000
         LR    @11,INDX                                            0423 00951000
         MH    @11,@CH00337                                        0423 00952000
         L     @11,$CURELEM-68(@11,WAPTR)                          0423 00953000
         CLI   MSG(@11),C'1'                                       0423 00954000
         BNE   @RF00423                                            0423 00955000
*                 GEN REFS(RPLPTR,ISTCC016,ARG,R6,R7);             0424 00956000
 WRITE RPL=(RPLPTR),EXIT=ISTCC016,ARG=(ARG),RECLEN=(R6),               X00957000
               AREA=(R7),OPTCD=(ASY,LBT,NERASE)                         00958000
*               ELSE                                               0425 00959000
*                 GEN REFS(RPLPTR,ISTCC016,ARG,R6,R7);             0425 00960000
         B     @RC00423                                            0425 00961000
@RF00423 DS    0H                                                  0425 00962000
 WRITE RPL=(RPLPTR),EXIT=ISTCC016,ARG=(ARG),RECLEN=(R6),               X00963000
               AREA=(R7),OPTCD=(ASY,LBT,ERASE)                          00964000
*             END;                                                 0426 00965000
*         END;                                                     0427 00966000
*       ELSE                        /* PROCESS AN LU         @D32JPGH*/ 00967000
*         DO;                                                      0428 00968000
         B     @RC00416                                            0428 00969000
@RF00416 DS    0H                                                  0429 00970000
*           IF BINBRAK=ON           /* DID WE BIND TO USE BRACKETS 0429 00971000
*                                                            @D32JPGH*/ 00972000
*             THEN                                                 0429 00973000
         LR    @11,INDX                                            0429 00974000
         MH    @11,@CH00337                                        0429 00975000
         LA    @10,$DEVSESP-68(@11,WAPTR)                          0429 00976000
         TM    BINBRAK-1(@10),B'00100000'                          0429 00977000
         BNO   @RF00429                                            0429 00978000
*             DO;                                                  0430 00979000
*               RPLBB=OFF;                                         0431 00980000
*               RPLEB=OFF;                                         0432 00981000
         LA    @10,16                                              0432 00982000
         ALR   @10,RPLPTR                                          0432 00983000
         NI    RPLBB(@10),B'00111111'                              0432 00984000
*               $DVBRKSN(INDX)=0;   /* RESET BRACKET TO ZERO @D32JPGH*/ 00985000
         SLR   @00,@00                                             0433 00986000
         STC   @00,$DVBRKSN-68(@11,WAPTR)                          0433 00987000
*               IF $DVBRKST(INDX)¬=INB/* NOT IN BRACKET STATE      0434 00988000
*                                                            @D32JPGH*/ 00989000
*                 THEN              /* THEN                  @D32JPGH*/ 00990000
         SLR   @00,@00                                             0434 00991000
         IC    @00,$DVBRKST-68(@11,WAPTR)                          0434 00992000
         C     @00,@CF00072                                        0434 00993000
         BE    @RF00434                                            0434 00994000
*                 RPLBB=ON;         /* SET BEGIN BRACKET     @D32JPGH*/ 00995000
         OI    RPLBB(@10),B'10000000'                              0435 00996000
*               IF($MSGOTSD(INDX)&GATEBIT0)=0&INCT=0/* IF NO MORE  0436 00997000
*                                      ELEMENTS AND DON'T NEED DATA  */ 00998000
*                 THEN                                             0436 00999000
@RF00434 LR    @11,INDX                                            0436 01000000
         MH    @11,@CH00337                                        0436 01001000
         L     @00,$MSGOTSD-68(@11,WAPTR)                          0436 01002000
         N     @00,@CF00650                                        0436 01003000
         LTR   @00,@00                                             0436 01004000
         BNZ   @RF00436                                            0436 01005000
         L     @11,$CURELEM-68(@11,WAPTR)                          0436 01006000
         CLI   INCT(@11),0                                         0436 01007000
         BNE   @RF00436                                            0436 01008000
*                 RPLEB=ON;         /* END BRACKET           @D32JPGH*/ 01009000
         OI    RPLEB+16(RPLPTR),B'01000000'                        0437 01010000
*               IF RPLBB=ON THEN    /* IF SENDING A BB               */ 01011000
@RF00436 LA    @11,16                                              0438 01012000
         ALR   @11,RPLPTR                                          0438 01013000
         TM    RPLBB(@11),B'10000000'                              0438 01014000
         BNO   @RF00438                                            0438 01015000
*                 IF RPLEB=ON THEN  /* AND IF SENDING AN EB          */ 01016000
         TM    RPLEB(@11),B'01000000'                              0439 01017000
         BNO   @RF00439                                            0439 01018000
*                   $DVBRKST(INDX)=BETB;/* THEN GOING BETEWEEN     0440 01019000
*                                      BRACKET                       */ 01020000
         LR    @11,INDX                                            0440 01021000
         MH    @11,@CH00337                                        0440 01022000
         SLR   @00,@00                                             0440 01023000
         STC   @00,$DVBRKST-68(@11,WAPTR)                          0440 01024000
*                 ELSE              /* IF BB AND NOT EB              */ 01025000
*                   $DVBRKSN(INDX)=SNDBB;/* OTHERWISE, ONLY SENDING     01026000
*                                      BB                            */ 01027000
         B     @RC00439                                            0441 01028000
@RF00439 LR    @11,INDX                                            0441 01029000
         MH    @11,@CH00337                                        0441 01030000
         LA    @00,1                                               0441 01031000
         STC   @00,$DVBRKSN-68(@11,WAPTR)                          0441 01032000
*               ELSE                /* IF NOT SENDING BB             */ 01033000
*                 IF RPLEB=ON THEN  /* IF AN EB WITHOUT A BB         */ 01034000
         B     @RC00438                                            0442 01035000
@RF00438 TM    RPLEB+16(RPLPTR),B'01000000'                        0442 01036000
         BNO   @RF00442                                            0442 01037000
*                   IF BINBKTR=ON THEN/* AND IF CONDITIONAL        0443 01038000
*                                      TERMINATION                   */ 01039000
         LR    @11,INDX                                            0443 01040000
         MH    @11,@CH00337                                        0443 01041000
         LA    @10,$DEVSESP-68(@11,WAPTR)                          0443 01042000
         TM    BINBKTR-1(@10),B'00010000'                          0443 01043000
         BNO   @RF00443                                            0443 01044000
*                     $DVBRKSN(INDX)=SNDEB;/* ONLY SENDING AN EB     */ 01045000
         LA    @00,2                                               0444 01046000
         STC   @00,$DVBRKSN-68(@11,WAPTR)                          0444 01047000
*                   ELSE            /* SENDING EB ONLY,NO CONDITIONAL   01048000
*                                      TERMINATION                   */ 01049000
*                     $DVBRKST(INDX)=BETB;/* GO TO BETWEEN BRACKETS  */ 01050000
         B     @RC00443                                            0445 01051000
@RF00443 LR    @11,INDX                                            0445 01052000
         MH    @11,@CH00337                                        0445 01053000
         SLR   @00,@00                                             0445 01054000
         STC   @00,$DVBRKST-68(@11,WAPTR)                          0445 01055000
*             END;                  /* END OF BRACKET STATE MANAGER  */ 01056000
@RC00443 DS    0H                                                  0446 01057000
@RF00442 DS    0H                                                  0446 01058000
@RC00438 DS    0H                                                  0447 01059000
*           IF $ASCII(INDX)=ON THEN /* IF ASCII, SET ALTERNATE CODE     01060000
*                                      BIT                   @ZD10887*/ 01061000
@RF00429 LR    @11,INDX                                            0447 01062000
         MH    @11,@CH00337                                        0447 01063000
         ALR   @11,WAPTR                                           0447 01064000
         TM    $ASCII-68(@11),B'00000100'                          0447 01065000
         BNO   @RF00447                                            0447 01066000
*             RPLCSI=ON;            /* ITS ASCII, SET BIT            */ 01067000
         OI    RPLCSI+16(RPLPTR),B'00001000'                       0448 01068000
*           $DVSNDOK(INDX)=OFF;     /* DONT SEND ANOTHER MSG         */ 01069000
@RF00447 LR    @11,INDX                                            0449 01070000
         MH    @11,@CH00337                                        0449 01071000
         ST    @11,@TF00001                                        0449 01072000
         ALR   @11,WAPTR                                           0449 01073000
         NI    $DVSNDOK-68(@11),B'11101111'                        0449 01074000
*           IF INCT¬=0&BINFMTRM=BINHDXFF THEN/* IF ANSWER EXPECTED 0450 01075000
*                                      AND HALF- DUPLEX FF CHANGE  0450 01076000
*                                      DIRECTION             @AX11982*/ 01077000
         L     @11,@TF00001                                        0450 01078000
         L     @11,$CURELEM-68(@11,WAPTR)                          0450 01079000
         CLI   INCT(@11),0                                         0450 01080000
         BE    @RF00450                                            0450 01081000
         L     @11,@TF00001                                        0450 01082000
         LA    @11,$DEVSESP-68(@11,WAPTR)                          0450 01083000
         TM    BINFMTRM-1(@11),B'10000000'                         0450 01084000
         BNO   @RF00450                                            0450 01085000
         TM    BINFMTRM-1(@11),B'01000000'                         0450 01086000
         BNZ   @RF00450                                            0450 01087000
*             RPLCMD='1'B;                                         0451 01088000
         OI    RPLCMD+16(RPLPTR),B'00100000'                       0451 01089000
*           GEN REFS(RPLPTR,ARG,R6,R7);                            0452 01090000
@RF00450 DS    0H                                                  0452 01091000
 SEND RPL=(RPLPTR),ARG=(ARG),AREA=(R7),RECLEN=(R6),                    X01092000
               STYPE=REQ,CONTROL=DATA,POST=SCHED,CHAIN=ONLY,           X01093000
               OPTCD=(SYN,NFMHDR),RESPOND=(NEX,FME,NRRN)                01094000
*         END;                      /* END OF LU(RECORD) PROCESSING  */ 01095000
*       IF R15¬=0 THEN              /* CHECK TO SEE THE I/O WENT O.K */ 01096000
@RC00416 LTR   R15,R15                                             0454 01097000
         BZ    @RF00454                                            0454 01098000
*         DO;                       /* BAD R.C., PROCESS             */ 01099000
*           CALL C16C0920;          /* IF ERROR, FREE STORAGE        */ 01100000
         BAL   @14,C16C0920                                        0456 01101000
*           GO TO C16C0266;         /* IF ERROR,GET OUT NOW          */ 01102000
         B     C16C0266                                            0457 01103000
*         END;                      /* END OF BAD R.C, PROCESSING    */ 01104000
*     END;                          /* END OF STARTING A NEW ELEMENT    01105000
*                                      OPERATION                     */ 01106000
@RF00454 DS    0H                                                  0460 01107000
*   IF $DEVLU(INDX)='1'B THEN       /* IF THIS IS AN LU, RECEIVE RESP*/ 01108000
@RF00411 LR    @11,INDX                                            0460 01109000
         MH    @11,@CH00337                                        0460 01110000
         ST    @11,@TF00001                                        0460 01111000
         ALR   @11,WAPTR                                           0460 01112000
         TM    $DEVLU-68(@11),B'00001000'                          0460 01113000
         BNO   @RF00460                                            0460 01114000
*     DO;                           /* LU, GET THE DATA              */ 01115000
*       RPLBUFL=$DVINCT(INDX);      /* POINT TO BUFFER TO READ INTO  */ 01116000
         L     @11,@TF00001                                        0462 01117000
         SLR   @00,@00                                             0462 01118000
         IC    @00,$DVINCT-68(@11,WAPTR)                           0462 01119000
         ST    @00,RPLBUFL(,RPLPTR)                                0462 01120000
*       RPLAREA=ADDR($TRMINPT);     /* LOCATION                      */ 01121000
         LA    @00,$TRMINPT(,WAPTR)                                0463 01122000
         ST    @00,RPLAREA(,RPLPTR)                                0463 01123000
*       GEN REFS(RPLPTR,ARG);                                      0464 01124000
 RECEIVE RPL=(RPLPTR),ARG=(ARG),EXIT=ISTCC016,                         X01125000
               OPTCD=(ASY,TRUNC,Q),RTYPE=(DFSYN,DFASY,RESP)             01126000
*       IF R15¬=0 THEN              /* IF ERROR DURING RECEIVE       */ 01127000
         LTR   R15,R15                                             0465 01128000
         BZ    @RF00465                                            0465 01129000
*         CALL C16C0920;            /* ERROR, GET RID OF EVERYTHING  */ 01130000
         BAL   @14,C16C0920                                        0466 01131000
*     END;                          /* END OF LU RECEIVE FOR RESPONSE*/ 01132000
@RF00465 DS    0H                                                  0468 01133000
*C16C0266:                                                         0468 01134000
*   R14=R8;                         /* RESTORE REG 14                */ 01135000
@RF00460 DS    0H                                                  0468 01136000
C16C0266 LR    R14,R8                                              0468 01137000
*   END C16C0265;                   /* END OF ROUTINE TO START AN  0469 01138000
*                                      ELEMENT ON QUEUE              */ 01139000
@EL00003 DS    0H                                                  0469 01140000
@EF00003 DS    0H                                                  0469 01141000
@ER00003 BR    @14                                                 0469 01142000
*C16C0270:                                                         0470 01143000
*   PROC OPTIONS(NOSAVE,NOSAVEAREA);                               0470 01144000
C16C0270 DS    0H                                                  0471 01145000
*   RESPECIFY                                                      0471 01146000
*     R5 RESTRICTED;                /* RESTRICT RETURN SAVE REGISTER */ 01147000
*   R5=R14;                         /* SAVE REG 14                   */ 01148000
         LR    R5,R14                                              0472 01149000
*   RESPECIFY                                                      0473 01150000
*    (R0,                                                          0473 01151000
*     R1) RESTRICTED;               /* DONT LET THESE REGISTERS GET     01152000
*                                      ALTRED                        */ 01153000
*   R0=RPLPTR->OUTCT+10;            /* GET LENGTH OF GETMAINED AREA  */ 01154000
         LA    R0,10                                               0474 01155000
         SLR   @11,@11                                             0474 01156000
         IC    @11,OUTCT(,RPLPTR)                                  0474 01157000
         ALR   R0,@11                                              0474 01158000
*   R1=RPLPTR;                      /* PTR TO AREA TO BE FREED       */ 01159000
         LR    R1,RPLPTR                                           0475 01160000
*/*VFRMAIN  SIZE((0))STORAGE((1))SUBPOOL(0)                          */ 01161000
*                                                                  0476 01162000
*   DO;                                                            0476 01163000
*     DO;                           /* CMZMREG (0,15) RESTRICT       */ 01164000
*       RFY                                                        0478 01165000
*        (GPR00P,                                                  0478 01166000
*         GPR15P) RSTD;                                            0478 01167000
*     END;                          /* CMZMREG PUT SUBPOOL PARM IN 0479 01168000
*                                      HIGH- ORDER BYTE OF REG 15    */ 01169000
*     GPR15F=0;                                                    0480 01170000
         SLR   GPR15F,GPR15F                                       0480 01171000
*     SLL(GPR15P,24);               /* COMBINE SUBPOOL AND SIZE IN 0481 01172000
*                                      REGISTER 0                    */ 01173000
         SLL   GPR15P,24                                           0481 01174000
*     GPR00P=GPR00P|GPR15P;                                        0482 01175000
         OR    GPR00P,GPR15P                                       0482 01176000
*     DO;                           /* CMZMREG (0,15) RELEASE        */ 01177000
*       RFY                                                        0484 01178000
*        (GPR00P,                                                  0484 01179000
*         GPR15P) UNRSTD;                                          0484 01180000
*     END;                          /* CMZMREG DECLARE AND RESTRICT     01181000
*                                      REG 1                         */ 01182000
*     DO;                           /* CMZMREG (1) RESTRICT          */ 01183000
*       RFY                                                        0487 01184000
*        (GPR01P) RSTD;                                            0487 01185000
*     END;                          /* CMZMREG INVOKE XREGSET MACRO     01186000
*                                      TO CHECK STORAGE PARM AND PUT    01187000
*                                      ADDR IN REGISTER 1            */ 01188000
*/*XREGSET  PID('STORAGE')PPARM((1))RREG(1,GPR01P)                   */ 01189000
*                                                                  0489 01190000
*     DO;                                                          0489 01191000
*                                                                  0489 01192000
*/*PARM ALREADY IN PROPER REGISTER                                   */ 01193000
*                                                                  0490 01194000
*     END;                          /* XREGSET INVOKE FREEMAIN MACRO */ 01195000
*     GEN;                                                         0491 01196000
         FREEMAIN R,LV=(0),A=(1)                                        01197000
*                                   /* UNRESTRICT REG 1              */ 01198000
*     DO;                           /* CMZMREG (1) RELEASE           */ 01199000
*       RFY                                                        0493 01200000
*        (GPR01P) UNRSTD;                                          0493 01201000
*     END;                          /* CMZMREG                       */ 01202000
*   END;                            /* VFRMAIN                       */ 01203000
*   RESPECIFY                                                      0496 01204000
*    (R0,                                                          0496 01205000
*     R1) UNRESTRICTED;             /* RELEASE THESE REGISTERS FOR 0496 01206000
*                                      USE                           */ 01207000
*   R14=R5;                         /* RESTORE REG 14                */ 01208000
         LR    R14,R5                                              0497 01209000
*   END C16C0270;                   /* END OF ROUTINE TO FREE ELEMENT   01210000
*                                      FROM QUEUE                    */ 01211000
@EL00004 DS    0H                                                  0498 01212000
@EF00004 DS    0H                                                  0498 01213000
@ER00004 BR    @14                                                 0498 01214000
*C16C0280:                                                         0499 01215000
*   PROC OPTIONS(NOSAVE,NOSAVEAREA);                               0499 01216000
C16C0280 DS    0H                                                  0500 01217000
*   R5=R14;                         /* SAVE THE RETURN ADDRESS     0500 01218000
*                                                            @D32JPGH*/ 01219000
         LR    R5,R14                                              0500 01220000
*   RESPECIFY                                                      0501 01221000
*     LASTCHN BASED(PTR1);                                         0501 01222000
*   PTR1=ADDR($MSGOTSD(INDX));      /* PTR TO 1ST ELEMENT    @D32JPGH*/ 01223000
         LR    @11,INDX                                            0502 01224000
         MH    @11,@CH00337                                        0502 01225000
         LA    PTR1,$MSGOTSD-68(@11,WAPTR)                         0502 01226000
*   DO WHILE((PTR1->CHAIN&GATEBIT0)¬=0);/* LOOP TILL LAST ELEMENT    */ 01227000
         B     @DE00503                                            0503 01228000
@DL00503 DS    0H                                                  0504 01229000
*     PTR1=PTR1->CHAIN;             /* ADDR OF NEXT ELEMENT  @D32JPGH*/ 01230000
         L     PTR1,CHAIN(,PTR1)                                   0504 01231000
*   END;                            /* END OF LOOP           @D32JPGH*/ 01232000
@DE00503 SLR   @11,@11                                             0505 01233000
         L     @00,CHAIN(,PTR1)                                    0505 01234000
         N     @00,@CF00650                                        0505 01235000
         CR    @00,@11                                             0505 01236000
         BNE   @DL00503                                            0505 01237000
*   PTR1->CHAIN=$CURELEM(INDX);     /* PUT PTR INTO LAST ELEMENT     */ 01238000
         LR    @10,INDX                                            0506 01239000
         MH    @10,@CH00337                                        0506 01240000
         L     @00,$CURELEM-68(@10,WAPTR)                          0506 01241000
         ST    @00,CHAIN(,PTR1)                                    0506 01242000
*   $CURELEM(INDX)=0;               /* SHOW NO CURRENT INDX          */ 01243000
         ST    @11,$CURELEM-68(@10,WAPTR)                          0507 01244000
*   R14=R5;                         /* RETURN TO THE CALLER  @D32JPGH*/ 01245000
         LR    R14,R5                                              0508 01246000
*   END C16C0280;                   /* END OF SUBROUTINE TO ADD    0509 01247000
*                                      ELEMENT TO QUE        @D32JPGH*/ 01248000
@EL00005 DS    0H                                                  0509 01249000
@EF00005 DS    0H                                                  0509 01250000
@ER00005 BR    @14                                                 0509 01251000
*C16C0900:                                                         0510 01252000
*   PROC OPTIONS(NOSAVE,NOSAVEAREA);/* MOVE DATA TO CALLER           */ 01253000
C16C0900 DS    0H                                                  0511 01254000
*   R5=R14;                         /* SAVE RETURN POINT             */ 01255000
         LR    R5,R14                                              0511 01256000
*   IF INADR¬=0 THEN                /* BUFFER AVAILABLE              */ 01257000
         SLR   @11,@11                                             0512 01258000
         LR    @10,INDX                                            0512 01259000
         MH    @10,@CH00337                                        0512 01260000
         ST    @10,@TF00001                                        0512 01261000
         L     @10,$CURELEM-68(@10,WAPTR)                          0512 01262000
         C     @11,INADR(,@10)                                     0512 01263000
         BE    @RF00512                                            0512 01264000
*     DO;                           /* YES, PASSBACK DATA            */ 01265000
*       M=0;                                                       0514 01266000
         STH   @11,M                                               0514 01267000
*       I=1;                        /* INITIAL COUNTERS              */ 01268000
         MVC   I(2),@CH00072                                       0515 01269000
*       IF $DEVFRRS(INDX)='19'X|$DEVFRRS(INDX)='1C'X THEN/* 3270     */ 01270000
         LR    @11,WAPTR                                           0516 01271000
         AL    @11,@TF00001                                        0516 01272000
         CLI   $DEVFRRS-68(@11),X'19'                              0516 01273000
         BE    @RT00516                                            0516 01274000
         LR    @11,WAPTR                                           0516 01275000
         AL    @11,@TF00001                                        0516 01276000
         CLI   $DEVFRRS-68(@11),X'1C'                              0516 01277000
         BNE   @RF00516                                            0516 01278000
@RT00516 DS    0H                                                  0517 01279000
*         I=7;                      /* YES, SKIP CURSOR ADDR         */ 01280000
         MVC   I(2),@CH00215                                       0517 01281000
*       DO I=I TO LENGTH($TRMINPT); /* MOVE DATA BACK TO CALLER      */ 01282000
@RF00516 LH    @00,I                                               0518 01283000
         B     @DE00518                                            0518 01284000
@DL00518 DS    0H                                                  0519 01285000
*         IF $TRMINPT(I)>=' ' THEN  /* DATA                          */ 01286000
         LR    @11,@00                                             0519 01287000
         ALR   @11,WAPTR                                           0519 01288000
         CLI   $TRMINPT-1(@11),C' '                                0519 01289000
         BL    @RF00519                                            0519 01290000
*           DO;                     /* YES, PASS IT BACK             */ 01291000
*             M=M+1;                /* INCREASE BYTES PASSED         */ 01292000
         LA    @11,1                                               0521 01293000
         AH    @11,M                                               0521 01294000
         STH   @11,M                                               0521 01295000
*             CARRAY(M)=$TRMINPT(I)|' ';/* MOVE DATA, PUT IN UPPER 0522 01296000
*                                      CASE                          */ 01297000
         LR    @10,INDX                                            0522 01298000
         MH    @10,@CH00337                                        0522 01299000
         L     @10,$CURELEM-68(@10,WAPTR)                          0522 01300000
         ST    @10,@TF00001                                        0522 01301000
         L     @10,INADR(,@10)                                     0522 01302000
         ALR   @10,@11                                             0522 01303000
         BCTR  @10,0                                               0522 01304000
         LR    @11,@00                                             0522 01305000
         ALR   @11,WAPTR                                           0522 01306000
         MVC   CARRAY(1,@10),$TRMINPT-1(@11)                       0522 01307000
         OI    CARRAY(@10),C' '                                    0522 01308000
*             IF M=INCT THEN        /* MORE ROOM IN THE BUFFER       */ 01309000
         LH    @11,M                                               0523 01310000
         L     @10,@TF00001                                        0523 01311000
         SLR   @00,@00                                             0523 01312000
         IC    @00,INCT(,@10)                                      0523 01313000
         CR    @11,@00                                             0523 01314000
         BE    @RT00523                                            0523 01315000
*               GO TO C16C0905;     /* NO, LEAVE                     */ 01316000
*           END;                    /* END, OF PASS BACK DATA        */ 01317000
*         ELSE                      /* NOT DATA, CONTROL INFO        */ 01318000
*           IF $TRMINPT(I)='11'X THEN/* 3270, IS IT A SBA CHARACTER  */ 01319000
         B     @RC00519                                            0526 01320000
@RF00519 LH    @11,I                                               0526 01321000
         ALR   @11,WAPTR                                           0526 01322000
         CLI   $TRMINPT-1(@11),X'11'                               0526 01323000
         BNE   @RF00526                                            0526 01324000
*             I=I+2;                /* YES, SKIP ADDR CHARACTERS     */ 01325000
         LH    @11,I                                               0527 01326000
         LA    @11,2(,@11)                                         0527 01327000
         STH   @11,I                                               0527 01328000
*       END;                        /* END OF MOVING BACK DATA       */ 01329000
@RF00526 DS    0H                                                  0528 01330000
@RC00519 LA    @00,1                                               0528 01331000
         AH    @00,I                                               0528 01332000
         STH   @00,I                                               0528 01333000
@DE00518 C     @00,@CF00048                                        0528 01334000
         BNH   @DL00518                                            0528 01335000
*C16C0905:                                                         0529 01336000
*       MSGCOUNT=M;                 /* RETURN COUNT                  */ 01337000
C16C0905 LR    @11,INDX                                            0529 01338000
         MH    @11,@CH00337                                        0529 01339000
         L     @11,$CURELEM-68(@11,WAPTR)                          0529 01340000
         L     @11,INADR(,@11)                                     0529 01341000
         LH    @00,M                                               0529 01342000
         BCTR  @11,0                                               0529 01343000
         STC   @00,MSGCOUNT(,@11)                                  0529 01344000
*       IF $ALTPRTR=ON THEN         /* IF AP PRESENT                 */ 01345000
         TM    $ALTPRTR(WAPTR),B'00000010'                         0530 01346000
         BNO   @RF00530                                            0530 01347000
*         $TWOWAY=ON;               /* PUT REPLY THERE               */ 01348000
         OI    $TWOWAY(WAPTR),B'01000000'                          0531 01349000
*       $POSTFLG=OFF;               /* RESET WAITING FLAG            */ 01350000
@RF00530 NI    $POSTFLG(WAPTR),B'10111111'                         0532 01351000
*       R1=ADDR($TLTECB2);          /* POINT TO THE ECB TO POST      */ 01352000
         L     R1,RCAPTR(,WAPTR)                                   0533 01353000
         LA    R1,$TLTECB2(,R1)                                    0533 01354000
*       CALL I00C1001;              /* POST THE ECB                  */ 01355000
         L     @15,@CV01962                                        0534 01356000
         BALR  @14,@15                                             0534 01357000
*     END;                          /* END USE OF BUFFER TRMINPT     */ 01358000
*   $TRMINPT=$TRMINPT&&$TRMINPT;                                   0536 01359000
@RF00512 XC    $TRMINPT(80,WAPTR),$TRMINPT(WAPTR)                  0536 01360000
*   $DVINCT(1)=LENGTH($TRMINPT);                                   0537 01361000
         MVI   $DVINCT(WAPTR),X'50'                                0537 01362000
*   R14=R5;                         /* RESTORE RETURN POINTER        */ 01363000
         LR    R14,R5                                              0538 01364000
*   END C16C0900;                                                  0539 01365000
@EL00006 DS    0H                                                  0539 01366000
@EF00006 DS    0H                                                  0539 01367000
@ER00006 BR    @14                                                 0539 01368000
*C16C0910:                                                         0540 01369000
*   PROC OPTIONS(NOSAVE,NOSAVEAREA);                               0540 01370000
C16C0910 DS    0H                                                  0541 01371000
*   R7=R14;                         /* SAVE RETURN POINT             */ 01372000
         LR    R7,R14                                              0541 01373000
*   RPLPTR=$CURELEM(INDX);          /* POINT TO ELEMENT BEING      0542 01374000
*                                      PROCESSED                     */ 01375000
         LR    @11,INDX                                            0542 01376000
         MH    @11,@CH00337                                        0542 01377000
         L     RPLPTR,$CURELEM-68(@11,WAPTR)                       0542 01378000
*   $CURELEM(INDX)=0;               /* ZERO OUT CURRENT ELEMENT    0543 01379000
*                                      POINTER                       */ 01380000
         SLR   @10,@10                                             0543 01381000
         ST    @10,$CURELEM-68(@11,WAPTR)                          0543 01382000
*   IF RPLPTR¬=0 THEN               /* ONLY CALL IF THERE IS AN    0544 01383000
*                                      ELEMENT TO FREE               */ 01384000
         CR    RPLPTR,@10                                          0544 01385000
         BE    @RF00544                                            0544 01386000
*     CALL C16C0270;                /* FREE THE ELEMENT              */ 01387000
         BAL   @14,C16C0270                                        0545 01388000
*   R14=R7;                         /* RESTORE THE RETURN POINT      */ 01389000
@RF00544 LR    R14,R7                                              0546 01390000
*   END C16C0910;                   /* END OF ROUTINE TO FREE CURRENT   01391000
*                                      ELEMENT                       */ 01392000
@EL00007 DS    0H                                                  0547 01393000
@EF00007 DS    0H                                                  0547 01394000
@ER00007 BR    @14                                                 0547 01395000
*C16C0920:                                                         0548 01396000
*   PROC OPTIONS(NOSAVE,NOSAVEAREA);                               0548 01397000
C16C0920 DS    0H                                                  0549 01398000
*   R6=R14;                         /* SAVE THE RETURN POINT         */ 01399000
         LR    R6,R14                                              0549 01400000
*   IF $ALTPRTR=ON&                 /* IF THERE IS AN AP             */ 01401000
*       INDX=AP                     /* AND THIS IS A TEST TERMINAL   */ 01402000
*     THEN                                                         0550 01403000
         TM    $ALTPRTR(WAPTR),B'00000010'                         0550 01404000
         BNO   @RF00550                                            0550 01405000
         C     INDX,@CF00139                                       0550 01406000
         BNE   @RF00550                                            0550 01407000
*     $ALTPRTR=OFF;                 /* DITCH THE AP                  */ 01408000
         NI    $ALTPRTR(WAPTR),B'11111101'                         0551 01409000
*   ELSE                            /* THE ERROR WAS ON THE CT       */ 01410000
*     DO;                                                          0552 01411000
         B     @RC00550                                            0552 01412000
@RF00550 DS    0H                                                  0553 01413000
*       IF $RPLERR=0 THEN                                          0553 01414000
         L     @00,$RPLERR-1(,WAPTR)                               0553 01415000
         ICM   @00,8,@CB01486                                      0553 01416000
         LTR   @00,@00                                             0553 01417000
         BNZ   @RF00553                                            0553 01418000
*         $RPLERR=RPLFDBK;          /* SET FIRST ERROR FEEDBACK      */ 01419000
         MVC   $RPLERR(3,WAPTR),RPLFDBK(RPLPTR)                    0554 01420000
*       $CANCEL=ON;                 /* CANCEL THIS LOGON             */ 01421000
@RF00553 OI    $CANCEL(WAPTR),B'00000010'                          0555 01422000
*       $CTERROR=ON;                /* CANCEL BECAUSE OF CT ERR      */ 01423000
         OI    $CTERROR(WAPTR),B'01000000'                         0556 01424000
*       $POSTFLG=OFF;               /* STOP WAITING FOR DATA         */ 01425000
         NI    $POSTFLG(WAPTR),B'10111111'                         0557 01426000
*     END;                                                         0558 01427000
*   CALL C16C0910;                  /* FREE THE CURRENT ELEMENT      */ 01428000
@RC00550 BAL   @14,C16C0910                                        0559 01429000
*   R14=R6;                         /* RESTORE THE RETURN POINT      */ 01430000
         LR    R14,R6                                              0560 01431000
*   END C16C0920;                   /* END OF SETTING ERROR STATUS   */ 01432000
@EL00008 DS    0H                                                  0561 01433000
@EF00008 DS    0H                                                  0561 01434000
@ER00008 BR    @14                                                 0561 01435000
@PB00008 DS    0H                                                  0562 01436000
*   DO;                             /* TPEPILOG                      */ 01437000
*     GEN(PRINT OFF);                                              0563 01438000
         PRINT OFF                                                      01439000
*     DO;                                                          0564 01440000
*       DCL                                                        0565 01441000
*         GPR00F FIXED(31) REG(00),                                0565 01442000
*         GPR00P PTR(31) REG(00),                                  0565 01443000
*         GPR01F FIXED(31) REG(01),                                0565 01444000
*         GPR01P PTR(31) REG(01),                                  0565 01445000
*         GPR02F FIXED(31) REG(02),                                0565 01446000
*         GPR02P PTR(31) REG(02),                                  0565 01447000
*         GPR03F FIXED(31) REG(03),                                0565 01448000
*         GPR03P PTR(31) REG(03),                                  0565 01449000
*         GPR04F FIXED(31) REG(04),                                0565 01450000
*         GPR04P PTR(31) REG(04),                                  0565 01451000
*         GPR05F FIXED(31) REG(05),                                0565 01452000
*         GPR05P PTR(31) REG(05),                                  0565 01453000
*         GPR06F FIXED(31) REG(06),                                0565 01454000
*         GPR06P PTR(31) REG(06),                                  0565 01455000
*         GPR07F FIXED(31) REG(07),                                0565 01456000
*         GPR07P PTR(31) REG(07),                                  0565 01457000
*         GPR08F FIXED(31) REG(08),                                0565 01458000
*         GPR08P PTR(31) REG(08),                                  0565 01459000
*         GPR09F FIXED(31) REG(09),                                0565 01460000
*         GPR09P PTR(31) REG(09),                                  0565 01461000
*         GPR10F FIXED(31) REG(10),                                0565 01462000
*         GPR10P PTR(31) REG(10),                                  0565 01463000
*         GPR11F FIXED(31) REG(11),                                0565 01464000
*         GPR11P PTR(31) REG(11),                                  0565 01465000
*         GPR12F FIXED(31) REG(12),                                0565 01466000
*         GPR12P PTR(31) REG(12),                                  0565 01467000
*         GPR13F FIXED(31) REG(13),                                0565 01468000
*         GPR13P PTR(31) REG(13),                                  0565 01469000
*         GPR14F FIXED(31) REG(14),                                0565 01470000
*         GPR14P PTR(31) REG(14),                                  0565 01471000
*         GPR15F FIXED(31) REG(15),                                0565 01472000
*         GPR15P PTR(31) REG(15);                                  0565 01473000
*     END;                                                         0566 01474000
*     GEN(PRINT ON);                                               0567 01475000
         PRINT ON                                                       01476000
*   END;                            /* TPEPILOG                      */ 01477000
*   DO;                             /* ATDSPLY                       */ 01478000
*   END;                            /* ATDSPLY                       */ 01479000
*   END ISTCC016                                                   0571 01480000
*                                                                  0571 01481000
*/* THE FOLLOWING INCLUDE STATEMENTS WERE FOUND IN THIS PROGRAM.     */ 01482000
*/*%INCLUDE SYSLIB  (IFGRPL  )                                       */ 01483000
*/*%INCLUDE SYSLIB  (IFGRPLVT)                                       */ 01484000
*/*%INCLUDE SYSLIB  (ISTRPLFB)                                       */ 01485000
*                                                                  0571 01486000
*       ;                                                          0571 01487000
         B     @EL00001                                            0571 01488000
@DATA    DS    0H                                                       01489000
@CH00215 DC    H'7'                                                     01490000
@CH00337 DC    H'68'                                                    01491000
@DATD    DSECT                                                          01492000
         DS    0F                                                       01493000
@TF00001 DS    F                                                        01494000
ISTCC016 CSECT                                                          01495000
         DS    0F                                                       01496000
@CF00072 DC    F'1'                                                     01497000
@CH00072 EQU   @CF00072+2                                               01498000
@CF00139 DC    F'2'                                                     01499000
@CF00068 DC    F'4'                                                     01500000
@CF00054 DC    F'8'                                                     01501000
@CF00048 DC    F'80'                                                    01502000
@CF00083 DC    F'256'                                                   01503000
@CF00650 DC    XL4'7FFFFFFF'                                            01504000
@CF00652 DC    XL4'80000000'                                            01505000
@CF02031 DC    XL4'0000FFFF'                                            01506000
@DATD    DSECT                                                          01507000
         DS    0D                                                       01508000
RPLSAVE  DS    A                                                        01509000
I        DS    H                                                        01510000
M        DS    H                                                        01511000
N        DS    H                                                        01512000
SCRATCH  DS    CL1                                                      01513000
         ORG   *+1-(*-@DATD)/(*-@DATD) INSURE DSECT DATA                01514000
@ENDDATD EQU   *                                                        01515000
ISTCC016 CSECT                                                          01516000
         DS    0F                                                       01517000
@SIZDATD DC    AL1(0)                                                   01518000
         DC    AL3(@ENDDATD-@DATD)                                      01519000
@CV01962 DC    V(I00C1001)                                              01520000
         DS    0D                                                       01521000
C16EXSAV DC    F'0'                                                     01522000
BASE     DC    AL4(ISTCC016)                                            01523000
@CB01933 DC    X'0201'                                                  01524000
@CB01937 DC    X'1001'                                                  01525000
@CB01939 DC    X'0819'                                                  01526000
@CB01940 DC    X'1007'                                                  01527000
@CB01941 DC    X'1008'                                                  01528000
@CB01486 DC    X'00'                                                    01529000
         DS    CL1                                                      01530000
C16CBUF1 DC    CL52' '                                                  01531000
C16CBUF2 DC    CL52' '                                                  01532000
SAVEA    DC    18F'0'                                                   01533000
PATCH    DC    25F'0'                                                   01534000
@00      EQU   00                      EQUATES FOR REGISTERS 0-15       01535000
@01      EQU   01                                                       01536000
@02      EQU   02                                                       01537000
@03      EQU   03                                                       01538000
@04      EQU   04                                                       01539000
@05      EQU   05                                                       01540000
@06      EQU   06                                                       01541000
@07      EQU   07                                                       01542000
@08      EQU   08                                                       01543000
@09      EQU   09                                                       01544000
@10      EQU   10                                                       01545000
@11      EQU   11                                                       01546000
@12      EQU   12                                                       01547000
@13      EQU   13                                                       01548000
@14      EQU   14                                                       01549000
@15      EQU   15                                                       01550000
WAPTR    EQU   @02                                                      01551000
RPLPTR   EQU   @04                                                      01552000
RPHPTR   EQU   @01                                                      01553000
R1       EQU   @01                                                      01554000
R14      EQU   @14                                                      01555000
R15      EQU   @15                                                      01556000
R0       EQU   @00                                                      01557000
R13      EQU   @13                                                      01558000
R5       EQU   @05                                                      01559000
R8       EQU   @08                                                      01560000
R6       EQU   @06                                                      01561000
R7       EQU   @07                                                      01562000
R9       EQU   @09                                                      01563000
R12      EQU   @12                                                      01564000
PTR2     EQU   @15                                                      01565000
PTR1     EQU   @01                                                      01566000
INDX     EQU   @03                                                      01567000
ARG      EQU   @05                                                      01568000
GPR00P   EQU   @00                                                      01569000
GPR15P   EQU   @15                                                      01570000
GPR15F   EQU   @15                                                      01571000
GPR01P   EQU   @01                                                      01572000
GPR00F   EQU   @00                                                      01573000
GPR01F   EQU   @01                                                      01574000
GPR02F   EQU   @02                                                      01575000
GPR02P   EQU   @02                                                      01576000
GPR03F   EQU   @03                                                      01577000
GPR03P   EQU   @03                                                      01578000
GPR04F   EQU   @04                                                      01579000
GPR04P   EQU   @04                                                      01580000
GPR05F   EQU   @05                                                      01581000
GPR05P   EQU   @05                                                      01582000
GPR06F   EQU   @06                                                      01583000
GPR06P   EQU   @06                                                      01584000
GPR07F   EQU   @07                                                      01585000
GPR07P   EQU   @07                                                      01586000
GPR08F   EQU   @08                                                      01587000
GPR08P   EQU   @08                                                      01588000
GPR09F   EQU   @09                                                      01589000
GPR09P   EQU   @09                                                      01590000
GPR10F   EQU   @10                                                      01591000
GPR10P   EQU   @10                                                      01592000
GPR11F   EQU   @11                                                      01593000
GPR11P   EQU   @11                                                      01594000
GPR12F   EQU   @12                                                      01595000
GPR12P   EQU   @12                                                      01596000
GPR13F   EQU   @13                                                      01597000
GPR13P   EQU   @13                                                      01598000
GPR14F   EQU   @14                                                      01599000
GPR14P   EQU   @14                                                      01600000
         ENTRY C16C1000                                                 01601000
ATCLCPTR EQU   1032                                                     01602000
$RCAAREA EQU   0                                                        01603000
$POINTER EQU   $RCAAREA+100                                             01604000
$TLTECB2 EQU   $POINTER+28                                              01605000
$TRTBLA  EQU   $POINTER+124                                             01606000
$CONSTNT EQU   $RCAAREA+244                                             01607000
$RCAFLG  EQU   $RCAAREA+604                                             01608000
$TRASCII EQU   $RCAAREA+608                                             01609000
$EXITSAV EQU   $RCAAREA+864                                             01610000
TOLTEPWA EQU   0                                                        01611000
$SCTTBLE EQU   TOLTEPWA                                                 01612000
$TESTOPT EQU   $SCTTBLE+2                                               01613000
$ERROPT  EQU   $SCTTBLE+3                                               01614000
$PDEVFLG EQU   $SCTTBLE+10                                              01615000
$CDSFLGS EQU   $SCTTBLE+11                                              01616000
$CDS8T19 EQU   $SCTTBLE+20                                              01617000
$EXECFLG EQU   $SCTTBLE+33                                              01618000
$OLTFLGS EQU   $SCTTBLE+36                                              01619000
$OLTFLG2 EQU   $SCTTBLE+37                                              01620000
$TOTFLG1 EQU   $SCTTBLE+38                                              01621000
$CTEQTT  EQU   $TOTFLG1                                                 01622000
$ROUTMSK EQU   $SCTTBLE+40                                              01623000
$CDA     EQU   TOLTEPWA+100                                             01624000
$RCA     EQU   $CDA+44                                                  01625000
$OLTPTR  EQU   $CDA+52                                                  01626000
$HIMOREC EQU   $CDA+60                                                  01627000
$COMMFLG EQU   TOLTEPWA+224                                             01628000
$FLAG3   EQU   $COMMFLG+2                                               01629000
$ALTPRTR EQU   $FLAG3                                                   01630000
$FLAG4   EQU   $COMMFLG+3                                               01631000
$FLAG5   EQU   $COMMFLG+4                                               01632000
$EOJ     EQU   $FLAG5                                                   01633000
$CANCEL  EQU   $EOJ                                                     01634000
$FLAG6   EQU   $COMMFLG+5                                               01635000
$CTERROR EQU   $FLAG6                                                   01636000
$ABNDBIT EQU   $FLAG6                                                   01637000
$CIREQ   EQU   $FLAG6                                                   01638000
$FLAG7   EQU   $COMMFLG+6                                               01639000
$EXIOWAT EQU   $FLAG7                                                   01640000
$SNDRFLG EQU   $FLAG7                                                   01641000
$FLAG8   EQU   $COMMFLG+7                                               01642000
$TWOWAY  EQU   $FLAG8                                                   01643000
$FLAG12  EQU   $COMMFLG+11                                              01644000
$POSTFLG EQU   $FLAG12                                                  01645000
$DEVTBLE EQU   TOLTEPWA+240                                             01646000
$DEVCDS  EQU   $DEVTBLE                                                 01647000
$DEVUNAD EQU   $DEVCDS                                                  01648000
@NM00043 EQU   $DEVUNAD+2                                               01649000
$DEVFEAT EQU   $DEVCDS+4                                                01650000
$DEVFRRS EQU   $DEVFEAT+1                                               01651000
$DEVCDSF EQU   $DEVCDS+9                                                01652000
$DEVSDCF EQU   $DEVCDS+10                                               01653000
$$SYMNME EQU   $DEVCDS+12                                               01654000
$MSGOTSD EQU   $$SYMNME                                                 01655000
$CURELEM EQU   $$SYMNME+4                                               01656000
$DEVFLG1 EQU   $DEVTBLE+20                                              01657000
$EVNCPLT EQU   $DEVFLG1                                                 01658000
$ATTNEXP EQU   $DEVFLG1                                                 01659000
$INTOCC  EQU   $DEVFLG1                                                 01660000
$DVCTBYT EQU   $INTOCC                                                  01661000
$DEVFLG2 EQU   $DEVTBLE+21                                              01662000
$DEVTECB EQU   $DEVTBLE+22                                              01663000
$OPIS    EQU   $DEVTECB                                                 01664000
$DVSEQNO EQU   $OPIS                                                    01665000
$OPND    EQU   $DEVTECB+2                                               01666000
$DVBRKSN EQU   $OPND                                                    01667000
$DVBRKST EQU   $OPND+1                                                  01668000
$DVINCT  EQU   $DEVTBLE+26                                              01669000
$DEVFLG3 EQU   $DEVTBLE+27                                              01670000
$SIOFLG  EQU   $DEVFLG3                                                 01671000
$DVSNDOK EQU   $SIOFLG                                                  01672000
$IFTOUT  EQU   $DEVTBLE+36                                              01673000
$DEVSESP EQU   $IFTOUT                                                  01674000
$SSCPDAF EQU   $IFTOUT+6                                                01675000
$LDNCBPT EQU   $DEVTBLE+48                                              01676000
$CID     EQU   $DEVTBLE+52                                              01677000
$RNINFO  EQU   $DEVTBLE+56                                              01678000
$DEVFLG5 EQU   $RNINFO+8                                                01679000
$DEVLU   EQU   $DEVFLG5                                                 01680000
$ASCII   EQU   $DEVFLG5                                                 01681000
$DEVFLG4 EQU   $DEVTBLE+65                                              01682000
$TLTRPL1 EQU   TOLTEPWA+1616                                            01683000
$TLTRPL2 EQU   TOLTEPWA+1736                                            01684000
$TRMINPT EQU   TOLTEPWA+2184                                            01685000
#EXITA   EQU   TOLTEPWA+2632                                            01686000
$RETREG  EQU   TOLTEPWA+2636                                            01687000
$CCOMDAT EQU   TOLTEPWA+2644                                            01688000
$CFLGS   EQU   $CCOMDAT+16                                              01689000
$24FEMSG EQU   TOLTEPWA+2681                                            01690000
$24CATMG EQU   $24FEMSG+11                                              01691000
@NM00051 EQU   TOLTEPWA+2776                                            01692000
$OUNTPTR EQU   @NM00051+4                                               01693000
$NSPTR   EQU   $OUNTPTR                                                 01694000
$NSCNT   EQU   @NM00051+10                                              01695000
$ENXX    EQU   @NM00051+15                                              01696000
$IMITX   EQU   $ENXX                                                    01697000
$RPLERR  EQU   TOLTEPWA+2977                                            01698000
SVESC033 EQU   TOLTEPWA+3160                                            01699000
SVECC013 EQU   TOLTEPWA+3232                                            01700000
SVEIC003 EQU   TOLTEPWA+3592                                            01701000
SVESC022 EQU   TOLTEPWA+3736                                            01702000
SVECC011 EQU   TOLTEPWA+4024                                            01703000
IFGRPL   EQU   0                                                        01704000
RPLCOMN  EQU   IFGRPL                                                   01705000
RPLIDWD  EQU   RPLCOMN                                                  01706000
RPLREQ   EQU   RPLIDWD+2                                                01707000
RPLLEN   EQU   RPLIDWD+3                                                01708000
RPLECB   EQU   RPLCOMN+8                                                01709000
RPLEXITP EQU   RPLECB                                                   01710000
RPLFDBWD EQU   RPLCOMN+12                                               01711000
RPLFDBK  EQU   RPLFDBWD+1                                               01712000
RPLRTNCD EQU   RPLFDBK                                                  01713000
RPLCNDCD EQU   RPLFDBK+1                                                01714000
RPLCMPON EQU   RPLCNDCD                                                 01715000
RPLFDB2  EQU   RPLCMPON                                                 01716000
RPLERRCD EQU   RPLCNDCD+1                                               01717000
RPLFDB3  EQU   RPLERRCD                                                 01718000
RPLREOT  EQU   RPLFDB3                                                  01719000
RPLKEYLE EQU   RPLCOMN+16                                               01720000
RPLAREA  EQU   RPLCOMN+32                                               01721000
RPLARG   EQU   RPLCOMN+36                                               01722000
RPLOPTCD EQU   RPLCOMN+40                                               01723000
RPLOPT1  EQU   RPLOPTCD                                                 01724000
RPLECBSW EQU   RPLOPT1                                                  01725000
RPLOPT2  EQU   RPLOPTCD+1                                               01726000
RPLADR   EQU   RPLOPT2                                                  01727000
RPLOPT3  EQU   RPLOPTCD+2                                               01728000
RPLOPT4  EQU   RPLOPTCD+3                                               01729000
RPLNXTRP EQU   RPLCOMN+44                                               01730000
RPLRLEN  EQU   RPLCOMN+48                                               01731000
RPLBUFL  EQU   RPLCOMN+52                                               01732000
RPLOPTC2 EQU   RPLCOMN+56                                               01733000
RPLOPT5  EQU   RPLOPTC2                                                 01734000
RPLWRTYP EQU   RPLOPT5                                                  01735000
RPLOPT6  EQU   RPLOPTC2+1                                               01736000
RPLUNTYP EQU   RPLOPT6                                                  01737000
RPLOPT7  EQU   RPLOPTC2+2                                               01738000
RPLCNOPT EQU   RPLOPT7                                                  01739000
RPLOPT8  EQU   RPLOPTC2+3                                               01740000
RPLRBAR  EQU   RPLCOMN+60                                               01741000
RPLAIXID EQU   RPLRBAR+2                                                01742000
RPLEXTDS EQU   RPLCOMN+68                                               01743000
RPLEXTD1 EQU   RPLEXTDS                                                 01744000
RPLVTEXT EQU   IFGRPL+76                                                01745000
RPLAARLN EQU   RPLVTEXT+4                                               01746000
RPLFDBK2 EQU   RPLVTEXT+12                                              01747000
RPLSSNSI EQU   RPLFDBK2                                                 01748000
RPLDSB   EQU   RPLSSNSI                                                 01749000
RPLDSB1  EQU   RPLDSB                                                   01750000
RPLSSEI  EQU   RPLDSB1                                                  01751000
RPLDSB2  EQU   RPLDSB+1                                                 01752000
RPLSSMI  EQU   RPLDSB2                                                  01753000
RPLUSNSI EQU   RPLFDBK2+2                                               01754000
RPLUSFLD EQU   RPLVTEXT+16                                              01755000
RPLOPTC3 EQU   RPLVTEXT+20                                              01756000
RPLOPT9  EQU   RPLOPTC3                                                 01757000
RPLOPT10 EQU   RPLOPTC3+1                                               01758000
RPLOPT11 EQU   RPLOPTC3+2                                               01759000
RPLOPT12 EQU   RPLOPTC3+3                                               01760000
RPLFMHDR EQU   RPLOPT12                                                 01761000
RPLOSENS EQU   RPLVTEXT+24                                              01762000
RPLSSNSO EQU   RPLOSENS                                                 01763000
RPLSSEO  EQU   RPLSSNSO                                                 01764000
ISTAVT   EQU   0                                                        01765000
ISTRETRG EQU   ISTAVT+44                                                01766000
ISTLOK   EQU   0                                                        01767000
LOKCHN   EQU   ISTLOK+1                                                 01768000
LOKCHNG  EQU   LOKCHN                                                   01769000
@NM00055 EQU   LOKCHNG+2                                                01770000
ISTPAB   EQU   0                                                        01771000
PABWQCHN EQU   ISTPAB                                                   01772000
PABWEQA  EQU   PABWQCHN                                                 01773000
PABCHAIN EQU   PABWQCHN+4                                               01774000
PABRUNNG EQU   PABCHAIN                                                 01775000
PABRPHFG EQU   ISTPAB+12                                                01776000
PABFLAGS EQU   PABRPHFG                                                 01777000
PABERLCK EQU   PABFLAGS                                                 01778000
PABERRLK EQU   PABERLCK                                                 01779000
PABEND   EQU   ISTPAB+16                                                01780000
ISTDYPAB EQU   0                                                        01781000
DYPCHAIN EQU   ISTDYPAB+4                                               01782000
DYPPACMD EQU   ISTDYPAB+12                                              01783000
ISTRPH   EQU   0                                                        01784000
RPHCNTL  EQU   ISTRPH                                                   01785000
RPHFLAGS EQU   RPHCNTL+2                                                01786000
RPHFSTLC EQU   RPHFLAGS                                                 01787000
RPHFLGB  EQU   RPHCNTL+3                                                01788000
RPHRPHA  EQU   ISTRPH+4                                                 01789000
RPHTSKID EQU   ISTRPH+8                                                 01790000
RPHRESMA EQU   ISTRPH+16                                                01791000
RPHWPFLG EQU   RPHRESMA                                                 01792000
RPHWEA   EQU   ISTRPH+24                                                01793000
RPHCSPA  EQU   RPHWEA                                                   01794000
RPHSRPRM EQU   ISTRPH+28                                                01795000
RPHPABQA EQU   ISTRPH+36                                                01796000
RPHWORK  EQU   ISTRPH+40                                                01797000
RPHSAVE1 EQU   RPHWORK                                                  01798000
RPHSBITS EQU   RPHSAVE1+1                                               01799000
ISTATCVT EQU   0                                                        01800000
ATCRPTCH EQU   ISTATCVT                                                 01801000
ATCITFLD EQU   ISTATCVT+8                                               01802000
ATCITCDS EQU   ATCITFLD+8                                               01803000
ATCITFLG EQU   ATCITCDS+4                                               01804000
ATCITRA1 EQU   ATCITFLG+2                                               01805000
ATCSMPAB EQU   ISTATCVT+88                                              01806000
ATCVDPAB EQU   ISTATCVT+152                                             01807000
ATCLDTIL EQU   ISTATCVT+408                                             01808000
ATCGTSTR EQU   ISTATCVT+608                                             01809000
ATCLUDVT EQU   ISTATCVT+768                                             01810000
ATCANYDT EQU   ISTATCVT+776                                             01811000
@NM00065 EQU   ISTATCVT+780                                             01812000
ATCPODVT EQU   ISTATCVT+804                                             01813000
ATCSTAT  EQU   ISTATCVT+936                                             01814000
ATCSTAT1 EQU   ATCSTAT                                                  01815000
ATCPOFLG EQU   ATCSTAT+2                                                01816000
ATCSTAT4 EQU   ATCSTAT+3                                                01817000
ATCBITAN EQU   ISTATCVT+940                                             01818000
ATCFLAG2 EQU   ATCBITAN+1                                               01819000
ATCONID  EQU   ISTATCVT+944                                             01820000
ATCSSCPA EQU   ISTATCVT+948                                             01821000
ATCHPGM  EQU   ISTATCVT+1012                                            01822000
ATCVLCNT EQU   ISTATCVT+1016                                            01823000
ATCRNO   EQU   ISTATCVT+1020                                            01824000
@NM00088 EQU   ISTATCVT+1028                                            01825000
ATCSHRFG EQU   @NM00088+8                                               01826000
ATCCPDVT EQU   ISTATCVT+1096                                            01827000
ATCSMSDQ EQU   ISTATCVT+1140                                            01828000
ATCRID   EQU   ISTATCVT+1152                                            01829000
ATCLDAPP EQU   ISTATCVT+1288                                            01830000
ATCSQAFR EQU   ISTATCVT+1312                                            01831000
ATCORTCB EQU   ATCSQAFR+4                                               01832000
ATCORSRB EQU   ATCORTCB                                                 01833000
ATCICAPP EQU   ISTATCVT+1320                                            01834000
ATCDAPVT EQU   ISTATCVT+1340                                            01835000
ATCGSRBQ EQU   ISTATCVT+1472                                            01836000
ATCGSRBG EQU   ATCGSRBQ                                                 01837000
ATCENFLG EQU   ISTATCVT+1512                                            01838000
@NM00103 EQU   ISTATCVT+1575                                            01839000
ATCVTFLG EQU   ISTATCVT+1576                                            01840000
ATCZFLAG EQU   ISTATCVT+1696                                            01841000
ATCCRA   EQU   ISTATCVT+1720                                            01842000
ATCCRACN EQU   ATCCRA+4                                                 01843000
ATCSRB   EQU   ISTATCVT+1728                                            01844000
ATCSRBCN EQU   ATCSRB+4                                                 01845000
ATCCRPL  EQU   ISTATCVT+1736                                            01846000
ATCRPLCN EQU   ATCCRPL+4                                                01847000
ISTTIE   EQU   0                                                        01848000
TIETIEA  EQU   ISTTIE+4                                                 01849000
TIESNA   EQU   ISTTIE+8                                                 01850000
TIERPHA  EQU   ISTTIE+12                                                01851000
ISTBIND  EQU   0                                                        01852000
BINFMTY  EQU   ISTBIND                                                  01853000
BINPRIP  EQU   ISTBIND+3                                                01854000
BINSECP  EQU   ISTBIND+4                                                01855000
BINCMNP  EQU   ISTBIND+5                                                01856000
BINBRAK  EQU   BINCMNP                                                  01857000
BINBKTR  EQU   BINCMNP                                                  01858000
BINCMNP2 EQU   ISTBIND+6                                                01859000
BINFMTRM EQU   BINCMNP2                                                 01860000
BINTSU   EQU   ISTBIND+7                                                01861000
BINAPACE EQU   BINTSU                                                   01862000
BINRPACE EQU   BINTSU+1                                                 01863000
BINRUSZ  EQU   BINTSU+2                                                 01864000
BINSRUSZ EQU   BINRUSZ                                                  01865000
BINPRUSZ EQU   BINRUSZ+1                                                01866000
BINSPACE EQU   BINTSU+4                                                 01867000
BINBPACE EQU   BINTSU+5                                                 01868000
BINPRSVC EQU   ISTBIND+13                                               01869000
BINLUP   EQU   BINPRSVC                                                 01870000
BINPSCHR EQU   BINPRSVC+1                                               01871000
BINCRYPT EQU   ISTBIND+25                                               01872000
BINCRYRL EQU   0                                                        01873000
BINCRCTL EQU   BINCRYRL                                                 01874000
BINCRPFL EQU   BINCRYRL+1                                               01875000
BINPNAU  EQU   0                                                        01876000
BINAUNML EQU   BINPNAU                                                  01877000
BINAUNM  EQU   BINPNAU+1                                                01878000
BINUSEDT EQU   0                                                        01879000
BINUSDTL EQU   BINUSEDT                                                 01880000
BINUSDTA EQU   BINUSEDT+1                                               01881000
BINURC   EQU   0                                                        01882000
BINURCL  EQU   BINURC                                                   01883000
BINURCD  EQU   BINURC+1                                                 01884000
BINSLUNM EQU   0                                                        01885000
RPLOF16  EQU   0                                                        01886000
RPLRH3   EQU   RPLOF16                                                  01887000
RPLBB    EQU   RPLRH3                                                   01888000
RPLEB    EQU   RPLRH3                                                   01889000
RPLCMD   EQU   RPLRH3                                                   01890000
RPLCSI   EQU   RPLRH3                                                   01891000
RPLSRTYP EQU   RPLOF16+1                                                01892000
RPLSTYPE EQU   RPLSRTYP                                                 01893000
RPLRTYPE EQU   RPLSRTYP                                                 01894000
RPLRRESP EQU   RPLRTYPE                                                 01895000
RPLNFSYN EQU   RPLRTYPE                                                 01896000
RPLCHN   EQU   RPLOF16+2                                                01897000
RPLLAST  EQU   RPLCHN                                                   01898000
RPLONLY  EQU   RPLCHN                                                   01899000
RPLVTFL1 EQU   RPLOF16+3                                                01900000
RPLVTFL2 EQU   RPLOF16+4                                                01901000
RPLPOSTV EQU   RPLVTFL2                                                 01902000
RPLRESP  EQU   RPLVTFL2                                                 01903000
RPLEX    EQU   RPLRESP                                                  01904000
RPLNFME  EQU   RPLRESP                                                  01905000
RPLRRN   EQU   RPLRESP                                                  01906000
RPLCNTRL EQU   RPLOF16+5                                                01907000
RPLCNTDF EQU   RPLCNTRL                                                 01908000
RPLDATA  EQU   RPLCNTDF                                                 01909000
RPLCNCEL EQU   RPLCNTDF                                                 01910000
RPLCHASE EQU   RPLCNTDF                                                 01911000
RPLCNTDC EQU   RPLCNTRL+1                                               01912000
RPLRTR   EQU   RPLCNTDC                                                 01913000
RPLLUS   EQU   RPLCNTDC                                                 01914000
RPLSIGNL EQU   RPLCNTDC                                                 01915000
RPLCNTSC EQU   RPLCNTRL+2                                               01916000
RPLSHUTD EQU   RPLCNTSC                                                 01917000
RPLSHUTC EQU   RPLCNTSC                                                 01918000
RPLRSHUT EQU   RPLCNTSC                                                 01919000
RPLOF60  EQU   0                                                        01920000
RPLOBSQ  EQU   RPLOF60+4                                                01921000
RPLIBSQ  EQU   RPLOF60+5                                                01922000
RPLSEQNO EQU   RPLOF60+6                                                01923000
CARRAY   EQU   0                                                        01924000
MSGCOUNT EQU   0                                                        01925000
ELEMENT  EQU   0                                                        01926000
CHAIN    EQU   ELEMENT                                                  01927000
INADR    EQU   ELEMENT+4                                                01928000
OUTCT    EQU   ELEMENT+8                                                01929000
INCT     EQU   ELEMENT+9                                                01930000
MSG      EQU   ELEMENT+10                                               01931000
BACKSAVE EQU   0                                                        01932000
LASTCHN  EQU   0                                                        01933000
$TRTBL   EQU   0                                                        01934000
#EXIT    EQU   0                                                        01935000
ISTRPL   EQU   0                                                        01936000
ISTXDYP  EQU   0                                                        01937000
ISTXPAB  EQU   0                                                        01938000
RCAPTR   EQU   $RCA                                                     01939000
PABXTNSN EQU   PABEND                                                   01940000
BINLUP1  EQU   BINPSCHR                                                 01941000
BINLUS   EQU   BINPSCHR                                                 01942000
BINFMF1  EQU   BINLUS                                                   01943000
@NM00123 EQU   BINFMF1                                                  01944000
BINDSPF1 EQU   BINLUS+2                                                 01945000
BINMEDIA EQU   BINLUS+4                                                 01946000
BINLUP2  EQU   BINPSCHR                                                 01947000
BINSCRSZ EQU   BINLUP2+5                                                01948000
BINLUP3  EQU   BINPSCHR                                                 01949000
BINBFRSZ EQU   BINLUP3+5                                                01950000
BINBDESC EQU   BINLUP3+9                                                01951000
BINLUP4  EQU   BINPSCHR                                                 01952000
BINPSNDO EQU   BINLUP4                                                  01953000
BINPDSPP EQU   BINPSNDO                                                 01954000
BINADSPP EQU   BINPSNDO+1                                               01955000
BINFMHUP EQU   BINPSNDO+3                                               01956000
BINSSNDO EQU   BINLUP4+4                                                01957000
BINCSO   EQU   BINLUP4+8                                                01958000
BINCSOR  EQU   BINCSO                                                   01959000
BINGENCO EQU   BINLUP4+9                                                01960000
SVECC012 EQU   SVESC022                                                 01961000
SVEIC00A EQU   SVEIC003                                                 01962000
SVEIC004 EQU   SVEIC003                                                 01963000
SVEIC005 EQU   SVEIC003                                                 01964000
SVESC02A EQU   SVESC022                                                 01965000
SVESC02B EQU   SVESC022                                                 01966000
SVESC02D EQU   SVESC022                                                 01967000
SVESC02E EQU   SVESC022                                                 01968000
SVESC02F EQU   SVECC013                                                 01969000
SVESC024 EQU   SVESC022                                                 01970000
SVESC027 EQU   SVESC022                                                 01971000
SVESC029 EQU   SVESC033                                                 01972000
SVESC031 EQU   SVECC013                                                 01973000
SVESC032 EQU   SVECC011                                                 01974000
SVETC037 EQU   SVEIC003                                                 01975000
         AGO   .@UNREFD                START UNREFERENCED COMPONENTS    01976000
BINRSV35 EQU   BINLUP4+10                                               01977000
BINRVS34 EQU   BINGENCO                                                 01978000
BINAAO   EQU   BINGENCO                                                 01979000
BINIAO   EQU   BINGENCO                                                 01980000
BINRSV33 EQU   BINGENCO                                                 01981000
BINWSDF  EQU   BINGENCO                                                 01982000
BINRSV32 EQU   BINGENCO                                                 01983000
BINCSOC2 EQU   BINCSO                                                   01984000
BINCSOC1 EQU   BINCSO                                                   01985000
BINRSV31 EQU   BINCSOR                                                  01986000
BINRSV30 EQU   BINCSOR                                                  01987000
BINCSOAI EQU   BINCSOR                                                  01988000
BINCSOE  EQU   BINCSOR                                                  01989000
BINFMHUS EQU   BINSSNDO+3                                               01990000
BINCSLS  EQU   BINSSNDO+2                                               01991000
BINADSPS EQU   BINSSNDO+1                                               01992000
BINPDSPS EQU   BINSSNDO                                                 01993000
BINKIXS  EQU   BINFMHUP                                                 01994000
BINQFDO  EQU   BINFMHUP                                                 01995000
BINWPFMO EQU   BINFMHUP                                                 01996000
BINPDIRO EQU   BINFMHUP                                                 01997000
BINCOMPO EQU   BINFMHUP                                                 01998000
BINDSSTO EQU   BINFMHUP                                                 01999000
BINSSDAT EQU   BINFMHUP                                                 02000000
BINCSLP  EQU   BINPSNDO+2                                               02001000
BINRSV29 EQU   BINADSPP                                                 02002000
BINADSRF EQU   BINADSPP                                                 02003000
BINADSSF EQU   BINADSPP                                                 02004000
BINADSBE EQU   BINADSPP                                                 02005000
BINADSEC EQU   BINADSPP                                                 02006000
BINADSCD EQU   BINADSPP                                                 02007000
BINADSEP EQU   BINADSPP                                                 02008000
BINPEP   EQU   BINPDSPP                                                 02009000
BINDPP   EQU   BINPDSPP                                                 02010000
BINRSV28 EQU   BINPDSPP                                                 02011000
@NM00134 EQU   BINLUP3+10                                               02012000
BINBFSIZ EQU   BINBDESC                                                 02013000
@NM00133 EQU   BINBDESC                                                 02014000
BINBDRAC EQU   BINBFRSZ+3                                               02015000
BINBFRAR EQU   BINBFRSZ+2                                               02016000
BINBFRDC EQU   BINBFRSZ+1                                               02017000
BINBFRDR EQU   BINBFRSZ                                                 02018000
@NM00132 EQU   BINLUP3                                                  02019000
@NM00131 EQU   BINLUP2+10                                               02020000
BINPRESZ EQU   BINLUP2+9                                                02021000
BINSALTC EQU   BINSCRSZ+3                                               02022000
BINSALTR EQU   BINSCRSZ+2                                               02023000
BINSPRIC EQU   BINSCRSZ+1                                               02024000
BINSPRIR EQU   BINSCRSZ                                                 02025000
@NM00130 EQU   BINLUP2+1                                                02026000
@NM00129 EQU   BINLUP2                                                  02027000
BINSEDS  EQU   BINLUP2                                                  02028000
@NM00128 EQU   BINMEDIA                                                 02029000
BINCDEDS EQU   BINMEDIA                                                 02030000
BINXDOCF EQU   BINMEDIA                                                 02031000
BINXCDF  EQU   BINMEDIA                                                 02032000
BINDISK  EQU   BINMEDIA                                                 02033000
BINXCHNG EQU   BINMEDIA                                                 02034000
BINCARD  EQU   BINMEDIA                                                 02035000
BINDOCMT EQU   BINMEDIA                                                 02036000
@NM00127 EQU   BINDSPF1+1                                               02037000
BINUAALT EQU   BINDSPF1+1                                               02038000
BINUAINT EQU   BINDSPF1+1                                               02039000
BINTRNDS EQU   BINDSPF1                                                 02040000
@NM00126 EQU   BINDSPF1                                                 02041000
BINSLD   EQU   BINDSPF1                                                 02042000
BINVSDS  EQU   BINDSPF1                                                 02043000
BINVTDS  EQU   BINDSPF1                                                 02044000
BINHFDS  EQU   BINDSPF1                                                 02045000
BININTR  EQU   BINDSPF1                                                 02046000
@NM00125 EQU   @NM00123+1                                               02047000
BINXFPD  EQU   @NM00123+1                                               02048000
BINCSDS  EQU   @NM00123+1                                               02049000
BINQDSI  EQU   @NM00123+1                                               02050000
@NM00124 EQU   @NM00123+1                                               02051000
BINARRR  EQU   @NM00123                                                 02052000
BINSIDS  EQU   @NM00123                                                 02053000
BINSAI   EQU   @NM00123                                                 02054000
BINSDSI  EQU   @NM00123                                                 02055000
BINKDDSI EQU   @NM00123                                                 02056000
BINPDIR  EQU   BINFMF1                                                  02057000
BINCMPCT EQU   BINFMF1                                                  02058000
BINDESTS EQU   BINFMF1                                                  02059000
BINSLUS1 EQU   BINLUP1+6                                                02060000
BINPLUS1 EQU   BINLUP1+1                                                02061000
BINDSP1  EQU   BINLUP1                                                  02062000
BINFMHS1 EQU   BINLUP1                                                  02063000
@NM00057 EQU   PABXTNSN+12                                              02064000
PABNPSSQ EQU   PABXTNSN+8                                               02065000
PABLOCK  EQU   PABXTNSN+4                                               02066000
PABLAST  EQU   PABXTNSN                                                 02067000
@NM00157 EQU   RPLIBSQ                                                  02068000
RPLIINV  EQU   RPLIBSQ                                                  02069000
RPLINEG  EQU   RPLIBSQ                                                  02070000
RPLIPOS  EQU   RPLIBSQ                                                  02071000
RPLIIGN  EQU   RPLIBSQ                                                  02072000
RPLIRSET EQU   RPLIBSQ                                                  02073000
RPLITST  EQU   RPLIBSQ                                                  02074000
RPLISET  EQU   RPLIBSQ                                                  02075000
@NM00156 EQU   RPLOBSQ                                                  02076000
RPLOINV  EQU   RPLOBSQ                                                  02077000
RPLONEG  EQU   RPLOBSQ                                                  02078000
RPLOPOS  EQU   RPLOBSQ                                                  02079000
RPLOIGN  EQU   RPLOBSQ                                                  02080000
RPLORSET EQU   RPLOBSQ                                                  02081000
RPLOTST  EQU   RPLOBSQ                                                  02082000
RPLOSET  EQU   RPLOBSQ                                                  02083000
RPLIBSQV EQU   RPLOF60+2                                                02084000
RPLOBSQV EQU   RPLOF60                                                  02085000
@NM00155 EQU   RPLCNTSC                                                 02086000
RPLRQR   EQU   RPLCNTSC                                                 02087000
RPLSTSN  EQU   RPLCNTSC                                                 02088000
RPLCLEAR EQU   RPLCNTSC                                                 02089000
RPLSDT   EQU   RPLCNTSC                                                 02090000
RPLBIS   EQU   RPLCNTDC                                                 02091000
RPLSBI   EQU   RPLCNTDC                                                 02092000
RPLTUNBD EQU   RPLCNTDC                                                 02093000
RPLTBIND EQU   RPLCNTDC                                                 02094000
RPLBID   EQU   RPLCNTDC                                                 02095000
@NM00154 EQU   RPLCNTDF                                                 02096000
RPLQI    EQU   RPLCNTDF                                                 02097000
RPLRELQ  EQU   RPLCNTDF                                                 02098000
RPLQEC   EQU   RPLCNTDF                                                 02099000
RPLQC    EQU   RPLCNTDF                                                 02100000
RPLQRI   EQU   RPLRESP                                                  02101000
@NM00153 EQU   RPLPOSTV                                                 02102000
RPLSCHED EQU   RPLPOSTV                                                 02103000
@NM00152 EQU   RPLVTFL1                                                 02104000
RPLTLGAC EQU   RPLVTFL1                                                 02105000
RPLTNDSP EQU   RPLVTFL1                                                 02106000
RPLAUTUS EQU   RPLVTFL1                                                 02107000
RPLVTUSE EQU   RPLVTFL1                                                 02108000
@NM00151 EQU   RPLVTFL1                                                 02109000
@NM00150 EQU   RPLCHN                                                   02110000
RPLMIDLE EQU   RPLCHN                                                   02111000
RPLFIRST EQU   RPLCHN                                                   02112000
@NM00149 EQU   RPLRTYPE                                                 02113000
RPLDFASY EQU   RPLRTYPE                                                 02114000
@NM00148 EQU   RPLSTYPE                                                 02115000
RPLSRESP EQU   RPLSTYPE                                                 02116000
@NM00147 EQU   RPLRH3                                                   02117000
RPLCHREQ EQU   RPLRH3                                                   02118000
BINSNMD  EQU   BINSLUNM+1                                               02119000
BINSNML  EQU   BINSLUNM                                                 02120000
BINCRKEY EQU   BINCRYRL+2                                               02121000
BINCCIPH EQU   BINCRPFL                                                 02122000
BINCRSV1 EQU   BINCRPFL                                                 02123000
BINCKEYT EQU   BINCRPFL                                                 02124000
BINCLEN  EQU   BINCRCTL                                                 02125000
BINCSESS EQU   BINCRCTL                                                 02126000
BINCEUMB EQU   BINCRCTL                                                 02127000
BINUSE   EQU   ISTBIND+36                                               02128000
BINUSEL  EQU   ISTBIND+35                                               02129000
BINPRIM  EQU   ISTBIND+27                                               02130000
BINPRIML EQU   ISTBIND+26                                               02131000
BINLUTYP EQU   BINLUP                                                   02132000
@NM00122 EQU   BINLUP                                                   02133000
BINBPACM EQU   BINBPACE                                                 02134000
@NM00121 EQU   BINBPACE                                                 02135000
BINSPACM EQU   BINSPACE                                                 02136000
@NM00120 EQU   BINSPACE                                                 02137000
BINPS1ST EQU   BINSPACE                                                 02138000
BINPRUSE EQU   BINPRUSZ                                                 02139000
BINPRUSM EQU   BINPRUSZ                                                 02140000
BINSRUSE EQU   BINSRUSZ                                                 02141000
BINSRUSM EQU   BINSRUSZ                                                 02142000
BINRPACM EQU   BINRPACE                                                 02143000
@NM00119 EQU   BINRPACE                                                 02144000
BINAPACM EQU   BINAPACE                                                 02145000
@NM00118 EQU   BINAPACE                                                 02146000
BINSP2ST EQU   BINAPACE                                                 02147000
BINCONR  EQU   BINCMNP2                                                 02148000
BINRCHN  EQU   BINCMNP2                                                 02149000
BINMDIBK EQU   BINCMNP2                                                 02150000
BINBKFS  EQU   BINCMNP2                                                 02151000
BINRCVR  EQU   BINCMNP2                                                 02152000
@NM00117 EQU   BINCMNP                                                  02153000
BINALT   EQU   BINCMNP                                                  02154000
BINFMHD  EQU   BINCMNP                                                  02155000
@NM00116 EQU   BINCMNP                                                  02156000
BINSSEB  EQU   BINSECP                                                  02157000
BINSCMP  EQU   BINSECP                                                  02158000
@NM00115 EQU   BINSECP                                                  02159000
BINSCHNR EQU   BINSECP                                                  02160000
BINSMCH  EQU   BINSECP                                                  02161000
BINSCHN  EQU   BINSECP                                                  02162000
BINPSEB  EQU   BINPRIP                                                  02163000
BINPCMP  EQU   BINPRIP                                                  02164000
@NM00114 EQU   BINPRIP                                                  02165000
BINPCHNR EQU   BINPRIP                                                  02166000
BINPMCH  EQU   BINPRIP                                                  02167000
BINPCHN  EQU   BINPRIP                                                  02168000
BINTS    EQU   ISTBIND+2                                                02169000
BINFM    EQU   ISTBIND+1                                                02170000
BINTYPE  EQU   BINFMTY                                                  02171000
BINFMT   EQU   BINFMTY                                                  02172000
TIEPTR2  EQU   TIERPHA                                                  02173000
TIEPTR1  EQU   TIESNA                                                   02174000
TIEGATE  EQU   TIETIEA                                                  02175000
TIEREQ   EQU   ISTTIE+3                                                 02176000
TIERETCD EQU   ISTTIE+2                                                 02177000
TIELNGTH EQU   ISTTIE+1                                                 02178000
TIETYPE  EQU   ISTTIE                                                   02179000
ATCAOS   EQU   ISTATCVT+1868                                            02180000
@NM00113 EQU   ISTATCVT+1860                                            02181000
@NM00112 EQU   ISTATCVT+1852                                            02182000
@NM00111 EQU   ISTATCVT+1844                                            02183000
@NM00110 EQU   ISTATCVT+1836                                            02184000
@NM00109 EQU   ISTATCVT+1828                                            02185000
@NM00108 EQU   ISTATCVT+1820                                            02186000
@NM00107 EQU   ISTATCVT+1816                                            02187000
ATCCACSA EQU   ISTATCVT+1812                                            02188000
ATCMXCSA EQU   ISTATCVT+1808                                            02189000
ATCTPMPB EQU   ISTATCVT+1776                                            02190000
ATCTRMPB EQU   ISTATCVT+1744                                            02191000
ATCRPLAC EQU   ATCRPLCN+2                                               02192000
ATCRPLRC EQU   ATCRPLCN                                                 02193000
ATCCRPLQ EQU   ATCCRPL                                                  02194000
ATCSRBAC EQU   ATCSRBCN+2                                               02195000
ATCSRBRC EQU   ATCSRBCN                                                 02196000
ATCSRBQ  EQU   ATCSRB                                                   02197000
ATCCRAAC EQU   ATCCRACN+2                                               02198000
ATCCRARC EQU   ATCCRACN                                                 02199000
ATCCRAQ  EQU   ATCCRA                                                   02200000
ATCLUFFD EQU   ISTATCVT+1716                                            02201000
ATCVIOPM EQU   ISTATCVT+1712                                            02202000
ATCTPMMI EQU   ISTATCVT+1708                                            02203000
ATCPXSRB EQU   ISTATCVT+1704                                            02204000
ATCRPLCT EQU   ISTATCVT+1702                                            02205000
ATCCRACT EQU   ISTATCVT+1700                                            02206000
ATCSRBCT EQU   ISTATCVT+1698                                            02207000
ATCSTNSM EQU   ISTATCVT+1697                                            02208000
@NM00106 EQU   ATCZFLAG                                                 02209000
ATCZF001 EQU   ATCZFLAG                                                 02210000
ATCTPCP1 EQU   ISTATCVT+1692                                            02211000
ATCTPCP0 EQU   ISTATCVT+1688                                            02212000
ATCZR01  EQU   ISTATCVT+1684                                            02213000
ATCMPLTA EQU   ISTATCVT+1680                                            02214000
ATCASCB  EQU   ISTATCVT+1676                                            02215000
ATCAP86  EQU   ISTATCVT+1672                                            02216000
ATCAP85  EQU   ISTATCVT+1668                                            02217000
ATCAP84  EQU   ISTATCVT+1664                                            02218000
ATCAP83  EQU   ISTATCVT+1660                                            02219000
ATCAP82  EQU   ISTATCVT+1656                                            02220000
ATCAP69  EQU   ISTATCVT+1652                                            02221000
ATCAP66  EQU   ISTATCVT+1648                                            02222000
ATCAP62  EQU   ISTATCVT+1644                                            02223000
ATCAPC59 EQU   ISTATCVT+1640                                            02224000
ATCAP56  EQU   ISTATCVT+1636                                            02225000
ATCAP55  EQU   ISTATCVT+1632                                            02226000
ATCAP41  EQU   ISTATCVT+1628                                            02227000
ATCAPC25 EQU   ISTATCVT+1624                                            02228000
ATCAP23  EQU   ISTATCVT+1620                                            02229000
ATCAPBE  EQU   ISTATCVT+1616                                            02230000
ATCPSTA  EQU   ISTATCVT+1612                                            02231000
ATCSMABF EQU   ISTATCVT+1608                                            02232000
ATCSMAPR EQU   ISTATCVT+1604                                            02233000
ATCTPWQA EQU   ISTATCVT+1600                                            02234000
ATCSMAID EQU   ISTATCVT+1596                                            02235000
ATCSMARA EQU   ISTATCVT+1592                                            02236000
ATCCACXA EQU   ISTATCVT+1588                                            02237000
ATCATA10 EQU   ISTATCVT+1584                                            02238000
ATCHLTCB EQU   ISTATCVT+1580                                            02239000
@NM00105 EQU   ATCVTFLG                                                 02240000
ATCVTACT EQU   ATCVTFLG                                                 02241000
@NM00104 EQU   @NM00103                                                 02242000
ATCVTMAB EQU   @NM00103                                                 02243000
ATCVTBAM EQU   ISTATCVT+1572                                            02244000
@NM00102 EQU   ISTATCVT+1568                                            02245000
@NM00101 EQU   ISTATCVT+1520                                            02246000
ATCCCOOC EQU   ISTATCVT+1516                                            02247000
@NM00100 EQU   ISTATCVT+1513                                            02248000
ATCSNUF  EQU   ATCENFLG                                                 02249000
ATCOPKL  EQU   ATCENFLG                                                 02250000
ATCABEN  EQU   ATCENFLG                                                 02251000
ATCSRDN  EQU   ATCENFLG                                                 02252000
ATCDLDN  EQU   ATCENFLG                                                 02253000
ATCTIMER EQU   ISTATCVT+1508                                            02254000
ATCAIWT  EQU   ISTATCVT+1504                                            02255000
ATCOROBT EQU   ISTATCVT+1500                                            02256000
ATCDMAPP EQU   ISTATCVT+1496                                            02257000
ATCZDVTX EQU   ISTATCVT+1492                                            02258000
ATCPXCRA EQU   ISTATCVT+1488                                            02259000
ATCICNCB EQU   ISTATCVT+1484                                            02260000
ATCCMTCB EQU   ISTATCVT+1480                                            02261000
ATCPRPH  EQU   ISTATCVT+1476                                            02262000
ATCGSRBF EQU   ATCGSRBG                                                 02263000
ATCSRBRT EQU   ISTATCVT+1468                                            02264000
ATCTSCPC EQU   ISTATCVT+1464                                            02265000
@NM00099 EQU   ISTATCVT+1460                                            02266000
ATCCDTCB EQU   ISTATCVT+1456                                            02267000
ATCORFRL EQU   ISTATCVT+1452                                            02268000
ATCORFPX EQU   ISTATCVT+1448                                            02269000
ATCORFMG EQU   ISTATCVT+1444                                            02270000
ATCSMBQ  EQU   ISTATCVT+1440                                            02271000
ATCINFDD EQU   ISTATCVT+1436                                            02272000
ATCAP67  EQU   ISTATCVT+1432                                            02273000
ATCAP65  EQU   ISTATCVT+1428                                            02274000
ATCAP64  EQU   ISTATCVT+1424                                            02275000
ATCAP63  EQU   ISTATCVT+1420                                            02276000
ATCAP61  EQU   ISTATCVT+1416                                            02277000
ATCAP58  EQU   ISTATCVT+1412                                            02278000
ATCAP57  EQU   ISTATCVT+1408                                            02279000
ATCAP54  EQU   ISTATCVT+1404                                            02280000
ATCAP53  EQU   ISTATCVT+1400                                            02281000
ATCAP52  EQU   ISTATCVT+1396                                            02282000
ATCAP51  EQU   ISTATCVT+1392                                            02283000
ATCAP38  EQU   ISTATCVT+1388                                            02284000
ATCAP37  EQU   ISTATCVT+1384                                            02285000
ATCAP34  EQU   ISTATCVT+1380                                            02286000
ATCAP32  EQU   ISTATCVT+1376                                            02287000
ATCAP31  EQU   ISTATCVT+1372                                            02288000
ATCAP12  EQU   ISTATCVT+1368                                            02289000
ATCAP11  EQU   ISTATCVT+1364                                            02290000
ATCDAPDG EQU   ATCDAPVT+20                                              02291000
ATCDXCEA EQU   ATCDAPVT+16                                              02292000
ATCDCEA  EQU   ATCDAPVT+12                                              02293000
ATCDPCIA EQU   ATCDAPVT+8                                               02294000
ATCDSIOA EQU   ATCDAPVT+4                                               02295000
ATCDEOEA EQU   ATCDAPVT                                                 02296000
ATCZAEA  EQU   ATCICAPP+16                                              02297000
ATCZCEA  EQU   ATCICAPP+12                                              02298000
ATCZCPCI EQU   ATCICAPP+8                                               02299000
ATCZSIOA EQU   ATCICAPP+4                                               02300000
ATCCDRPH EQU   ATCICAPP                                                 02301000
ATCORQG  EQU   ATCORSRB                                                 02302000
ATCORTBF EQU   ATCSQAFR                                                 02303000
@NM00098 EQU   ISTATCVT+1308                                            02304000
ATCZLAEA EQU   ATCLDAPP+16                                              02305000
ATCZLCEA EQU   ATCLDAPP+12                                              02306000
ATCZLPCI EQU   ATCLDAPP+8                                               02307000
ATCSMFRR EQU   ATCLDAPP+4                                               02308000
ATCCDTID EQU   ATCLDAPP                                                 02309000
@NM00097 EQU   ISTATCVT+1256                                            02310000
ATCZPAB2 EQU   ISTATCVT+1224                                            02311000
@NM00096 EQU   ISTATCVT+1224                                            02312000
@NM00095 EQU   ISTATCVT+1164                                            02313000
ATCCPCFE EQU   ISTATCVT+1160                                            02314000
@NM00094 EQU   ATCRID+2                                                 02315000
ATCCDRMA EQU   ATCRID                                                   02316000
@NM00093 EQU   ATCSMSDQ+8                                               02317000
@NM00092 EQU   ATCSMSDQ+4                                               02318000
@NM00091 EQU   ATCSMSDQ                                                 02319000
ATCSEQNO EQU   ISTATCVT+1136                                            02320000
ATCSMPMD EQU   ISTATCVT+1132                                            02321000
ATCPAREA EQU   ISTATCVT+1128                                            02322000
ATCCPCSM EQU   ISTATCVT+1124                                            02323000
ATCQLOCK EQU   ISTATCVT+1120                                            02324000
ATCITQLE EQU   ISTATCVT+1116                                            02325000
ATCSQCDS EQU   ISTATCVT+1112                                            02326000
ATCUSSVT EQU   ISTATCVT+1108                                            02327000
ATCNOSQ  EQU   ISTATCVT+1104                                            02328000
ATCINCIP EQU   ATCCPDVT+4                                               02329000
ATCTSCNI EQU   ATCCPDVT                                                 02330000
ATCMGCRT EQU   ISTATCVT+1092                                            02331000
ATCMACRT EQU   ISTATCVT+1088                                            02332000
ATCCSMT  EQU   ISTATCVT+1084                                            02333000
ATCDRUSL EQU   ISTATCVT+1080                                            02334000
ATCDRULL EQU   ISTATCVT+1076                                            02335000
ATCCFCDR EQU   ISTATCVT+1072                                            02336000
@NM00090 EQU   ISTATCVT+1069                                            02337000
ATCMROUT EQU   ISTATCVT+1060                                            02338000
ATCONFIG EQU   ISTATCVT+1052                                            02339000
ATCNODEL EQU   ISTATCVT+1044                                            02340000
@NM00089 EQU   @NM00088+9                                               02341000
ATCLAST  EQU   ATCSHRFG                                                 02342000
ATCSHRTN EQU   @NM00088                                                 02343000
@NM00087 EQU   ISTATCVT+1026                                            02344000
ATCNMCTR EQU   ISTATCVT+1024                                            02345000
ATCPOIA  EQU   ATCRNO+1                                                 02346000
@NM00086 EQU   ATCRNO                                                   02347000
ATCLCLCT EQU   ATCVLCNT+2                                               02348000
ATCRNCNT EQU   ATCVLCNT                                                 02349000
ATCHBSIZ EQU   ATCHPGM+2                                                02350000
ATCHBFNO EQU   ATCHPGM                                                  02351000
@NM00085 EQU   ISTATCVT+1011                                            02352000
ATCXRANG EQU   ISTATCVT+1010                                            02353000
ATCMAXID EQU   ISTATCVT+1009                                            02354000
ATCMSGSP EQU   ISTATCVT+1008                                            02355000
ATCCIDM  EQU   ISTATCVT+1006                                            02356000
ATCACTRM EQU   ISTATCVT+1004                                            02357000
ATCECTLP EQU   ISTATCVT+1000                                            02358000
ATCECNET EQU   ISTATCVT+996                                             02359000
ATCECOPC EQU   ISTATCVT+992                                             02360000
ATCECSES EQU   ISTATCVT+988                                             02361000
ATCECDSP EQU   ISTATCVT+984                                             02362000
ATCECVRY EQU   ISTATCVT+980                                             02363000
ATCECHLT EQU   ISTATCVT+976                                             02364000
ATCECMOD EQU   ISTATCVT+972                                             02365000
ATCVDLOK EQU   ISTATCVT+968                                             02366000
ATCRDTLK EQU   ISTATCVT+964                                             02367000
ATCVOCLK EQU   ISTATCVT+960                                             02368000
ATCITLIM EQU   ISTATCVT+958                                             02369000
ATCTMINV EQU   ISTATCVT+956                                             02370000
ATCHOSTA EQU   ISTATCVT+954                                             02371000
ATCPUNSA EQU   ISTATCVT+952                                             02372000
ATCSAF   EQU   ISTATCVT+950                                             02373000
ATCVTMID EQU   ATCSSCPA                                                 02374000
ATCHCNID EQU   ATCONID+2                                                02375000
ATCSCNID EQU   ATCONID                                                  02376000
@NM00084 EQU   ATCBITAN+3                                               02377000
@NM00083 EQU   ATCBITAN+2                                               02378000
@NM00082 EQU   ATCFLAG2                                                 02379000
@NM00081 EQU   ATCFLAG2                                                 02380000
@NM00080 EQU   ATCFLAG2                                                 02381000
ATCCRYPF EQU   ATCFLAG2                                                 02382000
ATCTUNCL EQU   ATCFLAG2                                                 02383000
ATCTUNRQ EQU   ATCFLAG2                                                 02384000
ATCTUNAC EQU   ATCFLAG2                                                 02385000
ATCCDLRA EQU   ATCFLAG2                                                 02386000
@NM00079 EQU   ATCBITAN                                                 02387000
@NM00078 EQU   ATCSTAT4                                                 02388000
@NM00077 EQU   ATCSTAT4                                                 02389000
@NM00076 EQU   ATCSTAT4                                                 02390000
@NM00075 EQU   ATCSTAT4                                                 02391000
@NM00074 EQU   ATCSTAT4                                                 02392000
ATCPRTAT EQU   ATCSTAT4                                                 02393000
ATCNCSD  EQU   ATCSTAT4                                                 02394000
ATCMTST  EQU   ATCSTAT4                                                 02395000
@NM00073 EQU   ATCPOFLG                                                 02396000
@NM00072 EQU   ATCPOFLG                                                 02397000
@NM00071 EQU   ATCPOFLG                                                 02398000
@NM00070 EQU   ATCPOFLG                                                 02399000
@NM00069 EQU   ATCPOFLG                                                 02400000
@NM00068 EQU   ATCPOFLG                                                 02401000
@NM00067 EQU   ATCPOFLG                                                 02402000
ATCPOUNS EQU   ATCPOFLG                                                 02403000
@NM00066 EQU   ATCSTAT+1                                                02404000
ATCHIP   EQU   ATCSTAT1                                                 02405000
ATCMDHLT EQU   ATCSTAT1                                                 02406000
ATCINHLT EQU   ATCSTAT1                                                 02407000
ATCNETSL EQU   ATCSTAT1                                                 02408000
ATCQKHLT EQU   ATCSTAT1                                                 02409000
ATCSNHLT EQU   ATCSTAT1                                                 02410000
ATCACTIV EQU   ATCSTAT1                                                 02411000
ATCSTART EQU   ATCSTAT1                                                 02412000
ATCNOP00 EQU   ISTATCVT+932                                             02413000
ATCTSBUF EQU   ISTATCVT+928                                             02414000
ATCFEPT  EQU   ISTATCVT+924                                             02415000
ATCFDVT  EQU   ISTATCVT+920                                             02416000
ATCCONFT EQU   ISTATCVT+916                                             02417000
ATCRDTH  EQU   ISTATCVT+912                                             02418000
ATCSIBQ  EQU   ISTATCVT+908                                             02419000
ATCHLTMS EQU   ISTATCVT+904                                             02420000
ATCECPRM EQU   ISTATCVT+900                                             02421000
ATCVPARM EQU   ISTATCVT+896                                             02422000
ATCOCHA  EQU   ISTATCVT+892                                             02423000
ATCDSPLQ EQU   ISTATCVT+888                                             02424000
ATCVARYQ EQU   ISTATCVT+884                                             02425000
ATCHALTQ EQU   ISTATCVT+880                                             02426000
ATCMODQ  EQU   ISTATCVT+876                                             02427000
ATCSRT   EQU   ISTATCVT+872                                             02428000
ATCRDT   EQU   ISTATCVT+868                                             02429000
ATCSDVT  EQU   ISTATCVT+864                                             02430000
ATCDLRPT EQU   ISTATCVT+860                                             02431000
ATCBPDA  EQU   ISTATCVT+856                                             02432000
ATCACDA  EQU   ISTATCVT+852                                             02433000
ATCMNT   EQU   ISTATCVT+848                                             02434000
ATCUEP   EQU   ISTATCVT+844                                             02435000
ATCNODDS EQU   ISTATCVT+840                                             02436000
ATCITRT  EQU   ISTATCVT+836                                             02437000
ATCTODVT EQU   ISTATCVT+832                                             02438000
ATCTRCPT EQU   ISTATCVT+828                                             02439000
ATCMODTB EQU   ISTATCVT+824                                             02440000
ATCUSSPT EQU   ISTATCVT+820                                             02441000
ATCTUBUF EQU   ISTATCVT+816                                             02442000
ATCTACB  EQU   ISTATCVT+812                                             02443000
ATCDWA   EQU   ISTATCVT+808                                             02444000
ATCCFCR2 EQU   ATCPODVT                                                 02445000
ATCEPA   EQU   ISTATCVT+800                                             02446000
ATCPULQB EQU   @NM00065+16                                              02447000
ATCMCQAB EQU   @NM00065+12                                              02448000
ATCLUSMQ EQU   @NM00065+8                                               02449000
ATCLUIOQ EQU   @NM00065+4                                               02450000
ATCIOLQB EQU   @NM00065                                                 02451000
ATCTSCAP EQU   ATCANYDT                                                 02452000
ATCTSCCO EQU   ATCLUDVT+4                                               02453000
ATCTSCSR EQU   ATCLUDVT                                                 02454000
ATCVTLOD EQU   ISTATCVT+764                                             02455000
ATCTSCLF EQU   ISTATCVT+760                                             02456000
ATCTSCLE EQU   ISTATCVT+756                                             02457000
ATCTSCLB EQU   ISTATCVT+752                                             02458000
ATCTSCLS EQU   ISTATCVT+748                                             02459000
ATCTSCCF EQU   ISTATCVT+744                                             02460000
ATCTSCFV EQU   ISTATCVT+740                                             02461000
ATCTSCCE EQU   ISTATCVT+736                                             02462000
ATCTSCCB EQU   ISTATCVT+732                                             02463000
ATCTSCWS EQU   ISTATCVT+728                                             02464000
ATCTSCEM EQU   ISTATCVT+724                                             02465000
ATCTSCNS EQU   ISTATCVT+720                                             02466000
ATCTSCER EQU   ISTATCVT+716                                             02467000
ATCTSCPR EQU   ISTATCVT+712                                             02468000
ATCTSCGR EQU   ISTATCVT+708                                             02469000
ATCTSCCI EQU   ISTATCVT+704                                             02470000
ATCTSVT  EQU   ISTATCVT+700                                             02471000
ATCDVLOD EQU   ISTATCVT+696                                             02472000
ATCCDCNR EQU   ISTATCVT+692                                             02473000
ATCCDCNF EQU   ISTATCVT+688                                             02474000
ATCCDCND EQU   ISTATCVT+684                                             02475000
ATCCDCNA EQU   ISTATCVT+680                                             02476000
ATCCDCCP EQU   ISTATCVT+676                                             02477000
ATCCDFDN EQU   ISTATCVT+672                                             02478000
ATCCDFIN EQU   ISTATCVT+668                                             02479000
ATCCDFND EQU   ISTATCVT+664                                             02480000
ATCCDDEL EQU   ISTATCVT+660                                             02481000
ATCCDADD EQU   ISTATCVT+656                                             02482000
ATCTCLIM EQU   ISTATCVT+652                                             02483000
ATCRACTR EQU   ISTATCVT+648                                             02484000
ATCRACTI EQU   ISTATCVT+644                                             02485000
ATCREMOV EQU   ISTATCVT+640                                             02486000
ATCRACIO EQU   ISTATCVT+636                                             02487000
ATCADD   EQU   ISTATCVT+632                                             02488000
ATCPUCRT EQU   ISTATCVT+628                                             02489000
ATCSMRS  EQU   ISTATCVT+624                                             02490000
ATCSMRQ  EQU   ISTATCVT+620                                             02491000
ATCORCPX EQU   ISTATCVT+616                                             02492000
ATCORCAF EQU   ISTATCVT+612                                             02493000
ATCFRSTR EQU   ATCGTSTR                                                 02494000
ATCSTMA  EQU   ISTATCVT+604                                             02495000
ATCSRTAD EQU   ISTATCVT+600                                             02496000
ATCOCRT  EQU   ISTATCVT+596                                             02497000
ATCOCCFS EQU   ISTATCVT+592                                             02498000
ATCOCCFP EQU   ISTATCVT+588                                             02499000
ATCSRTDF EQU   ISTATCVT+584                                             02500000
ATCLUCRT EQU   ISTATCVT+580                                             02501000
ATCINCY5 EQU   ISTATCVT+576                                             02502000
ATCINCW3 EQU   ISTATCVT+572                                             02503000
ATCINCU6 EQU   ISTATCVT+568                                             02504000
ATCINCTQ EQU   ISTATCVT+564                                             02505000
ATCINCS1 EQU   ISTATCVT+560                                             02506000
ATCSRTAB EQU   ISTATCVT+556                                             02507000
ATCINCRD EQU   ISTATCVT+552                                             02508000
ATCINCPH EQU   ISTATCVT+548                                             02509000
ATCINCLQ EQU   ISTATCVT+544                                             02510000
ATCNOCRT EQU   ISTATCVT+540                                             02511000
ATCINCF1 EQU   ISTATCVT+536                                             02512000
ATCINCCI EQU   ISTATCVT+532                                             02513000
ATCINCCO EQU   ISTATCVT+528                                             02514000
ATCBLDLA EQU   ISTATCVT+524                                             02515000
ATCALOAD EQU   ISTATCVT+520                                             02516000
ATCADEL  EQU   ISTATCVT+516                                             02517000
ATCESC02 EQU   ISTATCVT+512                                             02518000
ATCESC01 EQU   ISTATCVT+508                                             02519000
ATCDEC01 EQU   ISTATCVT+504                                             02520000
ATCDEC00 EQU   ISTATCVT+500                                             02521000
ATCCPCRT EQU   ISTATCVT+496                                             02522000
ATCMSGM  EQU   ISTATCVT+492                                             02523000
ATCCPCFR EQU   ISTATCVT+488                                             02524000
ATCCPCGR EQU   ISTATCVT+484                                             02525000
ATCCPCPP EQU   ISTATCVT+480                                             02526000
ATCMSGP  EQU   ISTATCVT+476                                             02527000
ATCCPCNT EQU   ISTATCVT+472                                             02528000
ATCAUTHA EQU   ISTATCVT+468                                             02529000
ATCACCTA EQU   ISTATCVT+464                                             02530000
ATCAP39  EQU   ISTATCVT+460                                             02531000
ATCAP36  EQU   ISTATCVT+456                                             02532000
ATCAP35  EQU   ISTATCVT+452                                             02533000
ATCAP33  EQU   ISTATCVT+448                                             02534000
ATCAPCR5 EQU   ISTATCVT+444                                             02535000
ATCAICPT EQU   ISTATCVT+440                                             02536000
ATCAPI   EQU   ISTATCVT+436                                             02537000
ATCAICTN EQU   ISTATCVT+432                                             02538000
ATCACC01 EQU   ISTATCVT+428                                             02539000
ATCACC00 EQU   ISTATCVT+424                                             02540000
ATCLDECB EQU   ATCLDTIL+12                                              02541000
ATCLDLCK EQU   ATCLDTIL+8                                               02542000
ATCLDLST EQU   ATCLDTIL+4                                               02543000
ATCLDNCS EQU   ATCLDTIL                                                 02544000
ATCNOSPB EQU   ISTATCVT+376                                             02545000
ATCNSPAB EQU   ISTATCVT+344                                             02546000
ATCLUSRT EQU   ISTATCVT+312                                             02547000
ATCPUIOP EQU   ISTATCVT+280                                             02548000
ATCPUPAB EQU   ISTATCVT+248                                             02549000
ATCPXPAB EQU   ISTATCVT+216                                             02550000
ATCPOPAB EQU   ISTATCVT+184                                             02551000
@NM00064 EQU   ATCVDPAB+16                                              02552000
ATCFEPAB EQU   ATCVDPAB                                                 02553000
ATCTCIPB EQU   ISTATCVT+120                                             02554000
ATCCSPAB EQU   ATCSMPAB+16                                              02555000
@NM00063 EQU   ATCSMPAB                                                 02556000
ATCTMRPB EQU   ISTATCVT+56                                              02557000
ATCITPAB EQU   ISTATCVT+24                                              02558000
@NM00062 EQU   ATCITRA1                                                 02559000
ATCITSCP EQU   ATCITRA1                                                 02560000
ATCITMSG EQU   ATCITRA1                                                 02561000
ATCITPIU EQU   ATCITRA1                                                 02562000
ATCITSMS EQU   ATCITRA1                                                 02563000
ATCITPSS EQU   ATCITRA1                                                 02564000
ATCITLCK EQU   ATCITRA1                                                 02565000
ATCITAPI EQU   ATCITRA1                                                 02566000
ATCITCNT EQU   ATCITFLG                                                 02567000
ATCITRPH EQU   ATCITCDS                                                 02568000
ATCITTBL EQU   ATCITFLD+4                                               02569000
ATCITPRM EQU   ATCITFLD                                                 02570000
ATCPTCHA EQU   ATCRPTCH+4                                               02571000
ATCVTLVL EQU   ATCRPTCH                                                 02572000
RPHUPSTA EQU   ISTRPH+104                                               02573000
RPHSAV16 EQU   RPHWORK+60                                               02574000
RPHSAV15 EQU   RPHWORK+56                                               02575000
RPHSAV14 EQU   RPHWORK+52                                               02576000
RPHSAV13 EQU   RPHWORK+48                                               02577000
RPHSAV12 EQU   RPHWORK+44                                               02578000
RPHSAV11 EQU   RPHWORK+40                                               02579000
RPHSAV10 EQU   RPHWORK+36                                               02580000
RPHSAVE9 EQU   RPHWORK+32                                               02581000
RPHSAVE8 EQU   RPHWORK+28                                               02582000
RPHSAVE7 EQU   RPHWORK+24                                               02583000
RPHSAVE6 EQU   RPHWORK+20                                               02584000
RPHSAVE5 EQU   RPHWORK+16                                               02585000
RPHSAVE4 EQU   RPHWORK+12                                               02586000
RPHSAVE3 EQU   RPHWORK+8                                                02587000
RPHSAVE2 EQU   RPHWORK+4                                                02588000
RPHSHALF EQU   RPHSAVE1+2                                               02589000
RPHSBIT8 EQU   RPHSBITS                                                 02590000
RPHSBIT7 EQU   RPHSBITS                                                 02591000
RPHSBIT6 EQU   RPHSBITS                                                 02592000
RPHSBIT5 EQU   RPHSBITS                                                 02593000
RPHSBIT4 EQU   RPHSBITS                                                 02594000
RPHSBIT3 EQU   RPHSBITS                                                 02595000
RPHSBIT2 EQU   RPHSBITS                                                 02596000
RPHSBIT1 EQU   RPHSBITS                                                 02597000
RPHSBYTE EQU   RPHSAVE1                                                 02598000
RPHPABQP EQU   RPHPABQA+1                                               02599000
RPHPABFG EQU   RPHPABQA                                                 02600000
RPHCRR   EQU   ISTRPH+32                                                02601000
RPHSRP34 EQU   RPHSRPRM+2                                               02602000
RPHSRP12 EQU   RPHSRPRM                                                 02603000
RPHWEGT  EQU   RPHCSPA                                                  02604000
RPHMAJCB EQU   ISTRPH+21                                                02605000
RPHPABOF EQU   ISTRPH+20                                                02606000
RPHRESUM EQU   RPHRESMA+1                                               02607000
@NM00061 EQU   RPHWPFLG                                                 02608000
RPHPURGE EQU   RPHWPFLG                                                 02609000
RPHPT    EQU   RPHWPFLG                                                 02610000
RPHWT    EQU   RPHWPFLG                                                 02611000
RPHRSKEY EQU   RPHWPFLG                                                 02612000
RPHDVTA  EQU   ISTRPH+12                                                02613000
RPHTIK   EQU   RPHTSKID+3                                               02614000
@NM00060 EQU   RPHTSKID                                                 02615000
RPHRPHAP EQU   RPHRPHA+1                                                02616000
@NM00059 EQU   RPHRPHA                                                  02617000
RPHGATE  EQU   RPHRPHA                                                  02618000
RPHABEND EQU   RPHFLGB                                                  02619000
RPHUWAIT EQU   RPHFLGB                                                  02620000
RPHRLCRA EQU   RPHFLGB                                                  02621000
@NM00058 EQU   RPHFLGB                                                  02622000
RPHPGCMP EQU   RPHFLGB                                                  02623000
RPHFBAPS EQU   RPHFLGB                                                  02624000
RPHBSSP  EQU   RPHFLGB                                                  02625000
RPHLOCK  EQU   RPHFLGB                                                  02626000
RPHFNFLG EQU   RPHFSTLC                                                 02627000
RPHMLTCP EQU   RPHFLAGS                                                 02628000
RPHSMCLR EQU   RPHFLAGS                                                 02629000
RPHSMTYP EQU   RPHFLAGS                                                 02630000
RPHSMQ   EQU   RPHFLAGS                                                 02631000
RPHAPTYP EQU   RPHFLAGS                                                 02632000
RPHSPGIN EQU   RPHFLAGS                                                 02633000
RPHOGIND EQU   RPHFLAGS                                                 02634000
RPHLNGTH EQU   RPHCNTL+1                                                02635000
RPHTYPE  EQU   RPHCNTL                                                  02636000
DYPPAB   EQU   ISTDYPAB+16                                              02637000
DYPOCRPH EQU   DYPPACMD                                                 02638000
DYPTSKID EQU   ISTDYPAB+8                                               02639000
DYPPACTB EQU   DYPCHAIN                                                 02640000
DYPFLGS  EQU   ISTDYPAB+2                                               02641000
DYPLNGTH EQU   ISTDYPAB+1                                               02642000
DYPTYPE  EQU   ISTDYPAB                                                 02643000
PABRPHA  EQU   PABRPHFG+1                                               02644000
PABNODQ  EQU   PABFLAGS                                                 02645000
PABINHBT EQU   PABFLAGS                                                 02646000
PABERLOK EQU   PABERRLK                                                 02647000
PABSSN   EQU   PABFLAGS                                                 02648000
PABDYNAM EQU   PABFLAGS                                                 02649000
PABXTND  EQU   PABFLAGS                                                 02650000
PABPRIOR EQU   PABFLAGS                                                 02651000
PABAPYP  EQU   PABFLAGS                                                 02652000
PABDVTA  EQU   ISTPAB+9                                                 02653000
PABOFFST EQU   ISTPAB+8                                                 02654000
PABCHNGP EQU   PABCHAIN+1                                               02655000
PABRSV02 EQU   PABCHAIN                                                 02656000
PABDELAY EQU   PABCHAIN                                                 02657000
PABQUED  EQU   PABRUNNG                                                 02658000
PABRESET EQU   PABCHAIN                                                 02659000
PABUNCON EQU   PABCHAIN                                                 02660000
PABCDP   EQU   PABCHAIN                                                 02661000
PABRESCH EQU   PABCHAIN                                                 02662000
PABCHNG  EQU   PABCHAIN                                                 02663000
PABWEQP  EQU   PABWEQA+1                                                02664000
PABRSV01 EQU   PABWEQA                                                  02665000
PABWEQG  EQU   PABWEQA                                                  02666000
LOKXCL   EQU   @NM00055                                                 02667000
LOKPRY   EQU   @NM00055                                                 02668000
@NM00056 EQU   @NM00055                                                 02669000
@NM00054 EQU   LOKCHNG                                                  02670000
LOKCT    EQU   ISTLOK                                                   02671000
ISTRETR7 EQU   ISTRETRG+4                                               02672000
ISTRETR6 EQU   ISTRETRG                                                 02673000
ISTRSV01 EQU   ISTAVT+42                                                02674000
ISTPDAVP EQU   ISTAVT+38                                                02675000
ISTVTTP  EQU   ISTAVT+36                                                02676000
ISTAGTWT EQU   ISTAVT+34                                                02677000
ISTATRT  EQU   ISTAVT+32                                                02678000
ISTARID  EQU   ISTAVT+30                                                02679000
ISTX1    EQU   ISTAVT+29                                                02680000
ISTPHNM  EQU   ISTAVT+24                                                02681000
ISTAPSEX EQU   ISTAVT+20                                                02682000
ISTVTTIK EQU   ISTAVT+18                                                02683000
AVTASID  EQU   ISTAVT+16                                                02684000
ISTAPSTA EQU   ISTAVT+12                                                02685000
ISTAS53  EQU   ISTAVT+8                                                 02686000
ISTAS49  EQU   ISTAVT+4                                                 02687000
ISTACVT  EQU   ISTAVT                                                   02688000
RPLSIGDA EQU   RPLVTEXT+32                                              02689000
RPLSAV13 EQU   RPLVTEXT+28                                              02690000
RPLUSNSO EQU   RPLOSENS+2                                               02691000
RPLSSMO  EQU   RPLSSNSO+1                                               02692000
@NM00146 EQU   RPLSSEO                                                  02693000
RPLRRO   EQU   RPLSSEO                                                  02694000
RPLFIO   EQU   RPLSSEO                                                  02695000
RPLSTATO EQU   RPLSSEO                                                  02696000
RPLCPMO  EQU   RPLSSEO                                                  02697000
@NM00145 EQU   RPLSSEO                                                  02698000
@NM00144 EQU   RPLOPT12                                                 02699000
@NM00143 EQU   RPLOPT12                                                 02700000
@NM00142 EQU   RPLOPT12                                                 02701000
RPLNIBTK EQU   RPLOPT12                                                 02702000
RPLTRUNC EQU   RPLOPT12                                                 02703000
RPLKEEP  EQU   RPLOPT12                                                 02704000
@NM00141 EQU   RPLOPT12                                                 02705000
RPLRSVE8 EQU   RPLOPT11                                                 02706000
RPLRSVE7 EQU   RPLOPT11                                                 02707000
RPLRSVE6 EQU   RPLOPT11                                                 02708000
RPLRSVE5 EQU   RPLOPT11                                                 02709000
RPLRSVE4 EQU   RPLOPT11                                                 02710000
RPLSTOP  EQU   RPLOPT11                                                 02711000
RPLSTART EQU   RPLOPT11                                                 02712000
RPLQUIES EQU   RPLOPT11                                                 02713000
RPLRSVI6 EQU   RPLOPT10                                                 02714000
RPLRSVI5 EQU   RPLOPT10                                                 02715000
RPLRSVI4 EQU   RPLOPT10                                                 02716000
RPLRSVI3 EQU   RPLOPT10                                                 02717000
RPLTSKY  EQU   RPLOPT10                                                 02718000
RPLSPARM EQU   RPLOPT10                                                 02719000
RPLDSPLY EQU   RPLOPT10                                                 02720000
RPLBSCID EQU   RPLOPT10                                                 02721000
RPLTOPL  EQU   RPLOPT9                                                  02722000
RPLCIDE  EQU   RPLOPT9                                                  02723000
RPLRNNM  EQU   RPLOPT9                                                  02724000
RPLAPPST EQU   RPLOPT9                                                  02725000
RPLCOUNT EQU   RPLOPT9                                                  02726000
RPLTERMS EQU   RPLOPT9                                                  02727000
RPLDEVCH EQU   RPLOPT9                                                  02728000
RPLLOGON EQU   RPLOPT9                                                  02729000
RPLESR2  EQU   RPLUSNSI+1                                               02730000
RPLESR1  EQU   RPLUSNSI                                                 02731000
@NM00140 EQU   RPLSSEI                                                  02732000
RPLRRI   EQU   RPLSSEI                                                  02733000
RPLFII   EQU   RPLSSEI                                                  02734000
RPLSTATI EQU   RPLSSEI                                                  02735000
RPLCPMI  EQU   RPLSSEI                                                  02736000
RPLPATHI EQU   RPLSSEI                                                  02737000
RPLARCLN EQU   RPLVTEXT+8                                               02738000
RPLAAREA EQU   RPLVTEXT                                                 02739000
RPLERMSA EQU   RPLCOMN+72                                               02740000
RPLEMLEN EQU   RPLCOMN+70                                               02741000
RPLACTIV EQU   RPLCOMN+69                                               02742000
RPLBRANC EQU   RPLEXTD1                                                 02743000
RPLNIB   EQU   RPLEXTD1                                                 02744000
RPLTCRYP EQU   RPLEXTD1                                                 02745000
@NM00139 EQU   RPLEXTD1                                                 02746000
RPLEXIT  EQU   RPLEXTD1                                                 02747000
RPLNEXIT EQU   RPLEXTD1                                                 02748000
RPLEXSCH EQU   RPLEXTD1                                                 02749000
RPLDDDD  EQU   RPLRBAR+4                                                02750000
@NM00138 EQU   RPLRBAR+3                                                02751000
@NM00137 EQU   RPLAIXID                                                 02752000
RPLAXPKP EQU   RPLAIXID                                                 02753000
RPLAIXPC EQU   RPLRBAR                                                  02754000
RPLRSV88 EQU   RPLOPT8                                                  02755000
RPLUNCON EQU   RPLOPT8                                                  02756000
RPLACTV  EQU   RPLOPT8                                                  02757000
RPLSESS  EQU   RPLOPT8                                                  02758000
RPLPEND  EQU   RPLOPT8                                                  02759000
RPLODPRM EQU   RPLOPT8                                                  02760000
RPLODACP EQU   RPLOPT8                                                  02761000
RPLODACQ EQU   RPLOPT8                                                  02762000
RPLRSV78 EQU   RPLOPT7                                                  02763000
RPLTCRNO EQU   RPLOPT7                                                  02764000
RPLRLSOP EQU   RPLOPT7                                                  02765000
RPLTPOST EQU   RPLOPT7                                                  02766000
RPLQOPT  EQU   RPLOPT7                                                  02767000
RPLCNIMM EQU   RPLCNOPT                                                 02768000
RPLCNANY EQU   RPLCNOPT                                                 02769000
RPLCNALL EQU   RPLCNOPT                                                 02770000
RPLRSV68 EQU   RPLOPT6                                                  02771000
RPLRSV67 EQU   RPLOPT6                                                  02772000
RPLLOCK  EQU   RPLOPT6                                                  02773000
RPLNCOND EQU   RPLOPT6                                                  02774000
RPLCOND  EQU   RPLOPT6                                                  02775000
RPLEOT   EQU   RPLUNTYP                                                 02776000
RPLEOM   EQU   RPLUNTYP                                                 02777000
RPLEOB   EQU   RPLUNTYP                                                 02778000
RPLWROPT EQU   RPLOPT5                                                  02779000
RPLNODE  EQU   RPLOPT5                                                  02780000
RPLERACE EQU   RPLWRTYP                                                 02781000
RPLEAU   EQU   RPLWRTYP                                                 02782000
RPLNERAS EQU   RPLWRTYP                                                 02783000
RPLPSOPT EQU   RPLOPT5                                                  02784000
@NM00136 EQU   RPLOPT5                                                  02785000
RPLDLGIN EQU   RPLOPT5                                                  02786000
RPLCHAIN EQU   RPLNXTRP                                                 02787000
@NM00135 EQU   RPLOPT4                                                  02788000
RPLMKFRM EQU   RPLOPT4                                                  02789000
RPLENDTR EQU   RPLOPT4                                                  02790000
RPLALIGN EQU   RPLOPT3                                                  02791000
RPLFMT   EQU   RPLOPT3                                                  02792000
RPLFLD   EQU   RPLOPT3                                                  02793000
RPLVFY   EQU   RPLOPT3                                                  02794000
RPLBLK   EQU   RPLOPT3                                                  02795000
RPLSFORM EQU   RPLOPT3                                                  02796000
RPLEODS  EQU   RPLOPT3                                                  02797000
RPLNSP   EQU   RPLOPT2                                                  02798000
RPLUPD   EQU   RPLOPT2                                                  02799000
RPLWAITX EQU   RPLOPT2                                                  02800000
RPLLRD   EQU   RPLOPT2                                                  02801000
RPLBWD   EQU   RPLOPT2                                                  02802000
RPLCNV   EQU   RPLOPT2                                                  02803000
RPLADD   EQU   RPLADR                                                   02804000
RPLKEY   EQU   RPLOPT2                                                  02805000
RPLECBIN EQU   RPLECBSW                                                 02806000
RPLGEN   EQU   RPLOPT1                                                  02807000
RPLKGE   EQU   RPLOPT1                                                  02808000
RPLASY   EQU   RPLOPT1                                                  02809000
RPLSKP   EQU   RPLOPT1                                                  02810000
RPLSEQ   EQU   RPLOPT1                                                  02811000
RPLDIR   EQU   RPLOPT1                                                  02812000
RPLLOC   EQU   RPLOPT1                                                  02813000
RPLDAF   EQU   RPLARG+2                                                 02814000
RPLSAF   EQU   RPLARG                                                   02815000
RPLTCBPT EQU   RPLCOMN+28                                               02816000
RPLDACB  EQU   RPLCOMN+24                                               02817000
RPLCCHAR EQU   RPLCOMN+20                                               02818000
RPLSTRID EQU   RPLCOMN+18                                               02819000
RPLKEYL  EQU   RPLKEYLE                                                 02820000
RPLRDSOH EQU   RPLFDB3                                                  02821000
RPLRLG   EQU   RPLFDB3                                                  02822000
RPLLGFRC EQU   RPLFDB3                                                  02823000
RPLREOM  EQU   RPLFDB3                                                  02824000
RPLREOB  EQU   RPLFDB3                                                  02825000
RPLSV32  EQU   RPLFDB3                                                  02826000
RPLUINPT EQU   RPLFDB3                                                  02827000
RPLSTSAV EQU   RPLFDB2                                                  02828000
RPLCUERR EQU   RPLFDB2                                                  02829000
RPLDLGFL EQU   RPLFDB2                                                  02830000
RPLIOERR EQU   RPLFDB2                                                  02831000
RPLDVUNS EQU   RPLFDB2                                                  02832000
RPLATND  EQU   RPLFDB2                                                  02833000
RPLRVID  EQU   RPLFDB2                                                  02834000
RPLERLK  EQU   RPLFDB2                                                  02835000
RPLERREG EQU   RPLRTNCD                                                 02836000
RPLSTAT  EQU   RPLFDBWD                                                 02837000
RPLPOST  EQU   RPLEXITP                                                 02838000
RPLWAIT  EQU   RPLEXITP                                                 02839000
RPLPLHPT EQU   RPLCOMN+4                                                02840000
RPLLEN2  EQU   RPLLEN                                                   02841000
RPLSTYP  EQU   RPLIDWD+1                                                02842000
RPLID    EQU   RPLIDWD                                                  02843000
SVECC010 EQU   TOLTEPWA+3952                                            02844000
SVETC035 EQU   TOLTEPWA+3880                                            02845000
SVESC030 EQU   TOLTEPWA+3808                                            02846000
SVESC020 EQU   TOLTEPWA+3664                                            02847000
SVEIC002 EQU   TOLTEPWA+3520                                            02848000
SVECC014 EQU   TOLTEPWA+3376                                            02849000
SVESC120 EQU   TOLTEPWA+3304                                            02850000
SVESC025 EQU   TOLTEPWA+3088                                            02851000
@NM00053 EQU   TOLTEPWA+2980                                            02852000
@NM00052 EQU   TOLTEPWA+2976                                            02853000
$R13PR3  EQU   TOLTEPWA+2972                                            02854000
$CEINT2  EQU   TOLTEPWA+2968                                            02855000
$CEINT1  EQU   TOLTEPWA+2964                                            02856000
$MSGGET  EQU   TOLTEPWA+2960                                            02857000
$ACQLIST EQU   TOLTEPWA+2956                                            02858000
$R4SAVE1 EQU   TOLTEPWA+2952                                            02859000
$CLSISS  EQU   TOLTEPWA+2950                                            02860000
$CLSCNT  EQU   TOLTEPWA+2948                                            02861000
$CUTABLE EQU   TOLTEPWA+2868                                            02862000
$BUFSZ2  EQU   TOLTEPWA+2864                                            02863000
$RESID2  EQU   TOLTEPWA+2860                                            02864000
$OLTCCW2 EQU   TOLTEPWA+2856                                            02865000
$ENDBFR2 EQU   TOLTEPWA+2852                                            02866000
$1STBFR2 EQU   TOLTEPWA+2848                                            02867000
$TECB2   EQU   TOLTEPWA+2844                                            02868000
$BUFSZ1  EQU   TOLTEPWA+2840                                            02869000
$RESID1  EQU   TOLTEPWA+2836                                            02870000
$OLTCCW1 EQU   TOLTEPWA+2832                                            02871000
$ENDBFR1 EQU   TOLTEPWA+2828                                            02872000
$1STBFR1 EQU   TOLTEPWA+2824                                            02873000
$TECB1   EQU   TOLTEPWA+2820                                            02874000
$WAITIME EQU   TOLTEPWA+2816                                            02875000
$TRTN#   EQU   TOLTEPWA+2815                                            02876000
$WIODEV  EQU   TOLTEPWA+2814                                            02877000
$RQSTSZE EQU   TOLTEPWA+2812                                            02878000
$RQSTPTR EQU   TOLTEPWA+2808                                            02879000
$R4SAVE  EQU   TOLTEPWA+2804                                            02880000
$PARTADR EQU   TOLTEPWA+2800                                            02881000
$TBSDATA EQU   TOLTEPWA+2796                                            02882000
$CTWIDTH EQU   TOLTEPWA+2795                                            02883000
$CTLINE  EQU   TOLTEPWA+2794                                            02884000
$APWIDTH EQU   TOLTEPWA+2793                                            02885000
$APLINE  EQU   TOLTEPWA+2792                                            02886000
$INDEX   EQU   $IMITX                                                   02887000
$UMXX    EQU   @NM00051+14                                              02888000
$NSXX    EQU   @NM00051+12                                              02889000
$ATACNT  EQU   $NSCNT                                                   02890000
$CTR     EQU   @NM00051+8                                               02891000
$ATAPTR  EQU   $NSPTR                                                   02892000
$DDRPTR  EQU   @NM00051                                                 02893000
$DTORESP EQU   TOLTEPWA+2712                                            02894000
$APNAME  EQU   TOLTEPWA+2704                                            02895000
$24SYMNE EQU   $24CATMG+4                                               02896000
$24DEVAD EQU   $24CATMG                                                 02897000
$24RTN#  EQU   $24FEMSG+8                                               02898000
$ESECTID EQU   $24FEMSG                                                 02899000
$24FLGS  EQU   TOLTEPWA+2680                                            02900000
$24SAVE2 EQU   TOLTEPWA+2676                                            02901000
$24SAVE1 EQU   TOLTEPWA+2672                                            02902000
$24UNADR EQU   TOLTEPWA+2668                                            02903000
$24SAV13 EQU   TOLTEPWA+2664                                            02904000
$24RETCD EQU   TOLTEPWA+2663                                            02905000
$MACID   EQU   TOLTEPWA+2661                                            02906000
$CSPARE  EQU   $CFLGS                                                   02907000
$C2WAY   EQU   $CFLGS                                                   02908000
$CINCT   EQU   $CCOMDAT+12                                              02909000
$CINADR  EQU   $CCOMDAT+8                                               02910000
$COUTCT  EQU   $CCOMDAT+4                                               02911000
$COUTAD  EQU   $CCOMDAT                                                 02912000
ROOTLOC  EQU   TOLTEPWA+2640                                            02913000
$WORK    EQU   TOLTEPWA+2376                                            02914000
$EXTA    EQU   TOLTEPWA+2320                                            02915000
$PASSONA EQU   TOLTEPWA+2264                                            02916000
$INBUFR  EQU   TOLTEPWA+2104                                            02917000
$BUFFER  EQU   TOLTEPWA+1976                                            02918000
$TLTRPL3 EQU   TOLTEPWA+1856                                            02919000
$SLTBL   EQU   TOLTEPWA+1468                                            02920000
$CDEVPT  EQU   TOLTEPWA+1466                                            02921000
$DEVCNTS EQU   TOLTEPWA+1464                                            02922000
$FEEDBCK EQU   $DEVTBLE+66                                              02923000
$WTISUED EQU   $DEVFLG4                                                 02924000
$EXIOISD EQU   $DEVFLG4                                                 02925000
$REMWRIT EQU   $DEVFLG4                                                 02926000
$REMDONE EQU   $DEVFLG4                                                 02927000
$2NDUSED EQU   $DEVFLG4                                                 02928000
$1STUSED EQU   $DEVFLG4                                                 02929000
$IGLXIFB EQU   $DEVFLG4                                                 02930000
$EXIOLV3 EQU   $DEVFLG4                                                 02931000
@NM00050 EQU   $DEVFLG5                                                 02932000
$DVBASIC EQU   $DEVFLG5                                                 02933000
$OPNDFAL EQU   $DEVFLG5                                                 02934000
$ACQNCB  EQU   $DEVFLG5                                                 02935000
$REMOTE  EQU   $DEVFLG5                                                 02936000
$ENDNODE EQU   $DEVFLG5                                                 02937000
$LINENME EQU   $RNINFO                                                  02938000
$DVCOL   EQU   $LDNCBPT+2                                               02939000
$DVROW   EQU   $LDNCBPT                                                 02940000
$NCSPLP  EQU   $DEVTBLE+44                                              02941000
$DVLN    EQU   $SSCPDAF                                                 02942000
$DAF     EQU   $DEVSESP+4                                               02943000
$VARYPAB EQU   $DEVSESP                                                 02944000
$SYSMN   EQU   $DEVTBLE+28                                              02945000
@NM00049 EQU   $DEVFLG3                                                 02946000
$CLRSNT  EQU   $DEVFLG3                                                 02947000
$OLTERR  EQU   $DEVFLG3                                                 02948000
$SRTEST  EQU   $DEVFLG3                                                 02949000
$POLLREQ EQU   $DEVFLG3                                                 02950000
$ACQRED  EQU   $DEVFLG3                                                 02951000
$NOTDEV  EQU   $DEVFLG3                                                 02952000
$CEINTRP EQU   $DEVFLG2                                                 02953000
$TESTMDE EQU   $DEVFLG2                                                 02954000
$DEVALOC EQU   $DEVFLG2                                                 02955000
$ALLDATA EQU   $DEVFLG2                                                 02956000
$ENDCNTL EQU   $DEVFLG2                                                 02957000
$CTLDEV  EQU   $DEVFLG2                                                 02958000
$NOCDS   EQU   $DEVFLG2                                                 02959000
$DATAIN  EQU   $DEVFLG2                                                 02960000
$PRIMARY EQU   $DEVFLG1                                                 02961000
$DEVACT  EQU   $DEVFLG1                                                 02962000
$DVLGMDE EQU   $ATTNEXP                                                 02963000
$DVSPRM  EQU   $EVNCPLT                                                 02964000
$GRABBED EQU   $DEVFLG1                                                 02965000
$CATASTR EQU   $DEVFLG1                                                 02966000
$LETGO   EQU   $DEVFLG1                                                 02967000
$EXTDEV  EQU   $DEVCDS+11                                               02968000
@NM00048 EQU   $DEVSDCF                                                 02969000
$NOTPRIM EQU   $DEVSDCF                                                 02970000
@NM00047 EQU   $DEVCDSF                                                 02971000
@NM00046 EQU   $DEVCDSF                                                 02972000
@NM00045 EQU   $DEVCDSF                                                 02973000
$CDSNAME EQU   $DEVCDSF                                                 02974000
$EXTRN   EQU   $DEVCDSF                                                 02975000
$CEVOLUM EQU   $DEVCDSF                                                 02976000
$SHARD   EQU   $DEVCDSF                                                 02977000
$DEVFPM  EQU   $DEVCDSF                                                 02978000
$DEVCNT  EQU   $DEVCDS+8                                                02979000
$DEVTYPE EQU   $DEVFEAT+3                                               02980000
$DEVCLAS EQU   $DEVFEAT+2                                               02981000
$DEVMOD  EQU   $DEVFEAT                                                 02982000
$DEVRDGT EQU   @NM00043+1                                               02983000
$DEVCTLU EQU   @NM00043+1                                               02984000
$DEVCHAN EQU   @NM00043                                                 02985000
@NM00044 EQU   @NM00043                                                 02986000
$CTINDX  EQU   $DEVUNAD                                                 02987000
@NM00042 EQU   $COMMFLG+15                                              02988000
@NM00041 EQU   $COMMFLG+14                                              02989000
@NM00040 EQU   $COMMFLG+13                                              02990000
@NM00039 EQU   $COMMFLG+12                                              02991000
@NM00038 EQU   $FLAG12                                                  02992000
$VARYINP EQU   $FLAG12                                                  02993000
$ENDTEST EQU   $FLAG12                                                  02994000
$VRYHRD  EQU   $FLAG12                                                  02995000
$VRYSFT  EQU   $FLAG12                                                  02996000
$OPTMSG  EQU   $FLAG12                                                  02997000
@NM00037 EQU   $COMMFLG+10                                              02998000
@NM00036 EQU   $COMMFLG+9                                               02999000
@NM00035 EQU   $COMMFLG+8                                               03000000
$TCECM   EQU   $FLAG8                                                   03001000
$VS2     EQU   $FLAG8                                                   03002000
$VS1     EQU   $FLAG8                                                   03003000
$EDOS    EQU   $FLAG8                                                   03004000
@NM00034 EQU   $FLAG8                                                   03005000
@NM00033 EQU   $FLAG8                                                   03006000
$RCVMSG  EQU   $FLAG7                                                   03007000
$RCVRFLG EQU   $FLAG7                                                   03008000
$LDOIS   EQU   $FLAG7                                                   03009000
$DCONTCT EQU   $FLAG7                                                   03010000
$2NDDATA EQU   $FLAG7                                                   03011000
$1STDATA EQU   $FLAG7                                                   03012000
$ABTERM  EQU   $ABNDBIT                                                 03013000
$FSTMCIS EQU   $FLAG6                                                   03014000
$DISCREQ EQU   $FLAG6                                                   03015000
$DISCISS EQU   $FLAG6                                                   03016000
$CHANGE  EQU   $FLAG6                                                   03017000
$RECAL11 EQU   $FLAG6                                                   03018000
@NM00032 EQU   $FLAG5                                                   03019000
$PROGCK  EQU   $CANCEL                                                  03020000
$PRINTAP EQU   $FLAG5                                                   03021000
@NM00031 EQU   $FLAG5                                                   03022000
$MSG922  EQU   $FLAG5                                                   03023000
$CT924   EQU   $FLAG5                                                   03024000
$FSTCAT  EQU   $FLAG5                                                   03025000
$FSTFE   EQU   $FLAG5                                                   03026000
$ACTOPND EQU   $FLAG4                                                   03027000
$ACQCUTT EQU   $FLAG4                                                   03028000
$CLSSACT EQU   $FLAG4                                                   03029000
$BACKINT EQU   $FLAG4                                                   03030000
$DMSGSW  EQU   $FLAG4                                                   03031000
$TSTDEVP EQU   $FLAG4                                                   03032000
$APRQPER EQU   $FLAG4                                                   03033000
$OPCOM   EQU   $FLAG4                                                   03034000
$NEWAP   EQU   $FLAG3                                                   03035000
$OPTERR  EQU   $FLAG3                                                   03036000
$PRTONLY EQU   $FLAG3                                                   03037000
$REQSTOR EQU   $FLAG3                                                   03038000
$LOGOFFE EQU   $FLAG3                                                   03039000
$TSTERR  EQU   $FLAG3                                                   03040000
$DEVERR  EQU   $FLAG3                                                   03041000
@NM00030 EQU   $COMMFLG+1                                               03042000
@NM00029 EQU   $COMMFLG                                                 03043000
@NM00028 EQU   $CDA+120                                                 03044000
$CUCNT   EQU   $CDA+118                                                 03045000
@NM00027 EQU   $CDA+117                                                 03046000
$PRTFORM EQU   $CDA+116                                                 03047000
$OPISCNT EQU   $CDA+114                                                 03048000
$OPNDCNT EQU   $CDA+112                                                 03049000
$GETMSZE EQU   $CDA+110                                                 03050000
$GRCNTS  EQU   $CDA+108                                                 03051000
$CTLCNT  EQU   $CDA+106                                                 03052000
$ACTLVL  EQU   $CDA+105                                                 03053000
$PRNTLVL EQU   $CDA+104                                                 03054000
$ERRCNTA EQU   $CDA+102                                                 03055000
$TLCNT   EQU   $CDA+100                                                 03056000
$TIMEALW EQU   $CDA+96                                                  03057000
$PTRAREA EQU   $CDA+92                                                  03058000
$GETMPTR EQU   $CDA+88                                                  03059000
$R13PTRT EQU   $CDA+84                                                  03060000
$R13PTR  EQU   $CDA+80                                                  03061000
$TEPEND  EQU   $CDA+76                                                  03062000
$PLINKDL EQU   $CDA+72                                                  03063000
$TEPBEGN EQU   $CDA+68                                                  03064000
$FRELPTR EQU   $CDA+64                                                  03065000
$HIGHADR EQU   $HIMOREC                                                 03066000
$LOMOREC EQU   $CDA+56                                                  03067000
$LOWADDR EQU   $OLTPTR                                                  03068000
$ENDCOMM EQU   $CDA+48                                                  03069000
$COMMON  EQU   $RCA                                                     03070000
$SLASHAD EQU   $CDA+32                                                  03071000
$PASSON  EQU   $CDA+28                                                  03072000
$TOLBRTB EQU   $CDA+24                                                  03073000
$SCTPTR8 EQU   $CDA+20                                                  03074000
$SCTPTR  EQU   $CDA+16                                                  03075000
$TBWDPTR EQU   $CDA+12                                                  03076000
$TFWDPTR EQU   $CDA+8                                                   03077000
@NM00026 EQU   $CDA                                                     03078000
@NM00025 EQU   $SCTTBLE+98                                              03079000
$SCTLWTC EQU   $SCTTBLE+96                                              03080000
$SCTLWTA EQU   $SCTTBLE+92                                              03081000
#EXT     EQU   $SCTTBLE+88                                              03082000
#PASS    EQU   $SCTTBLE+84                                              03083000
#TABLE   EQU   $SCTTBLE+80                                              03084000
#MSGIDAC EQU   $SCTTBLE+78                                              03085000
@NM00024 EQU   $SCTTBLE+71                                              03086000
$RETMASK EQU   $SCTTBLE+70                                              03087000
$R249255 EQU   $ROUTMSK+29                                              03088000
$R241248 EQU   $ROUTMSK+28                                              03089000
$R233240 EQU   $ROUTMSK+27                                              03090000
$R225232 EQU   $ROUTMSK+26                                              03091000
$R217224 EQU   $ROUTMSK+25                                              03092000
$R209216 EQU   $ROUTMSK+24                                              03093000
$R201208 EQU   $ROUTMSK+23                                              03094000
$R193200 EQU   $ROUTMSK+22                                              03095000
$R185192 EQU   $ROUTMSK+21                                              03096000
$R177184 EQU   $ROUTMSK+20                                              03097000
$R169176 EQU   $ROUTMSK+19                                              03098000
$R161168 EQU   $ROUTMSK+18                                              03099000
$R153160 EQU   $ROUTMSK+17                                              03100000
$R145152 EQU   $ROUTMSK+16                                              03101000
$R137144 EQU   $ROUTMSK+15                                              03102000
$R129136 EQU   $ROUTMSK+14                                              03103000
$R121128 EQU   $ROUTMSK+13                                              03104000
$R113120 EQU   $ROUTMSK+12                                              03105000
$R105112 EQU   $ROUTMSK+11                                              03106000
$R097104 EQU   $ROUTMSK+10                                              03107000
$R089096 EQU   $ROUTMSK+9                                               03108000
$R081088 EQU   $ROUTMSK+8                                               03109000
$R073080 EQU   $ROUTMSK+7                                               03110000
$R065072 EQU   $ROUTMSK+6                                               03111000
$R057064 EQU   $ROUTMSK+5                                               03112000
$R049056 EQU   $ROUTMSK+4                                               03113000
$R041048 EQU   $ROUTMSK+3                                               03114000
$R033040 EQU   $ROUTMSK+2                                               03115000
$R025032 EQU   $ROUTMSK+1                                               03116000
$R017024 EQU   $ROUTMSK                                                 03117000
$TOTFLG2 EQU   $SCTTBLE+39                                              03118000
@NM00023 EQU   $TOTFLG1                                                 03119000
@NM00022 EQU   $TOTFLG1                                                 03120000
@NM00021 EQU   $TOTFLG1                                                 03121000
$CURELOD EQU   $TOTFLG1                                                 03122000
@NM00020 EQU   $TOTFLG1                                                 03123000
@NM00019 EQU   $TOTFLG1                                                 03124000
$LINESHR EQU   $TOTFLG1                                                 03125000
@NM00018 EQU   $OLTFLG2                                                 03126000
@NM00017 EQU   $OLTFLG2                                                 03127000
@NM00016 EQU   $OLTFLG2                                                 03128000
@NM00015 EQU   $OLTFLG2                                                 03129000
@NM00014 EQU   $OLTFLG2                                                 03130000
@NM00013 EQU   $OLTFLG2                                                 03131000
@NM00012 EQU   $OLTFLG2                                                 03132000
$TALK    EQU   $OLTFLG2                                                 03133000
$DYCOM   EQU   $OLTFLGS                                                 03134000
@NM00011 EQU   $OLTFLGS                                                 03135000
$TRACE   EQU   $OLTFLGS                                                 03136000
$RETCODE EQU   $OLTFLGS                                                 03137000
$CONTCB  EQU   $OLTFLGS                                                 03138000
$RETAIN  EQU   $OLTFLGS                                                 03139000
$CLEANRT EQU   $OLTFLGS                                                 03140000
$MANINTV EQU   $OLTFLGS                                                 03141000
$OLTSIZE EQU   $SCTTBLE+34                                              03142000
$QSCTMOD EQU   $EXECFLG                                                 03143000
$CTRLMOD EQU   $EXECFLG                                                 03144000
$CLEANUP EQU   $EXECFLG                                                 03145000
$LSTPDEV EQU   $EXECFLG                                                 03146000
$ERRCNT  EQU   $EXECFLG                                                 03147000
$RTNSLCT EQU   $EXECFLG                                                 03148000
$MULTDEV EQU   $EXECFLG                                                 03149000
@NM00010 EQU   $EXECFLG                                                 03150000
$RMSKCNT EQU   $SCTTBLE+32                                              03151000
$SYNAME  EQU   $CDS8T19+4                                               03152000
$EXTSIG  EQU   $CDS8T19+3                                               03153000
$CDFLGS  EQU   $CDS8T19+1                                               03154000
$CDSCNT  EQU   $CDS8T19                                                 03155000
$PDEVDSC EQU   $SCTTBLE+16                                              03156000
$PDEVADR EQU   $SCTTBLE+12                                              03157000
$COMMCN  EQU   $CDSFLGS                                                 03158000
$CUSTSYM EQU   $CDSFLGS                                                 03159000
$TWOCHSW EQU   $CDSFLGS                                                 03160000
$SYMNAME EQU   $CDSFLGS                                                 03161000
$EXTINTC EQU   $CDSFLGS                                                 03162000
$CEVOL   EQU   $CDSFLGS                                                 03163000
$SHARED  EQU   $CDSFLGS                                                 03164000
$FPM     EQU   $CDSFLGS                                                 03165000
$LASTSUB EQU   $PDEVFLG                                                 03166000
@NM00009 EQU   $PDEVFLG                                                 03167000
@NM00008 EQU   $PDEVFLG                                                 03168000
@NM00007 EQU   $PDEVFLG                                                 03169000
$LASTDEV EQU   $PDEVFLG                                                 03170000
@NM00006 EQU   $PDEVFLG                                                 03171000
$EXFILPT EQU   $PDEVFLG                                                 03172000
$FPMOLD  EQU   $PDEVFLG                                                 03173000
$TSSSYM  EQU   $SCTTBLE+8                                               03174000
$SCTLEVL EQU   $SCTTBLE+7                                               03175000
$DRIVER  EQU   $SCTTBLE+6                                               03176000
$RT0916  EQU   $SCTTBLE+5                                               03177000
$RT0108  EQU   $SCTTBLE+4                                               03178000
$LOOPTST EQU   $ERROPT                                                  03179000
$LOOPERR EQU   $ERROPT                                                  03180000
$NERRPRT EQU   $ERROPT                                                  03181000
$NOCNTRL EQU   $ERROPT                                                  03182000
$ALTPRNT EQU   $ERROPT                                                  03183000
$CATERR  EQU   $ERROPT                                                  03184000
$ASTERIK EQU   $ERROPT                                                  03185000
$TESTERR EQU   $ERROPT                                                  03186000
$FSTCOMM EQU   $TESTOPT                                                 03187000
$INDEFLP EQU   $TESTOPT                                                 03188000
$NOPRT   EQU   $TESTOPT                                                 03189000
$PARAPRT EQU   $TESTOPT                                                 03190000
@NM00005 EQU   $TESTOPT                                                 03191000
$ERRLPCT EQU   $SCTTBLE                                                 03192000
$TLTEND  EQU   $RCAAREA+945                                             03193000
$CNSLID  EQU   $RCAAREA+936                                             03194000
@NM00004 EQU   $RCAAREA+605                                             03195000
$VTAMEND EQU   $RCAFLG                                                  03196000
$TPPOSTD EQU   $RCAFLG                                                  03197000
$NEWCT   EQU   $RCAFLG                                                  03198000
$ABNDALL EQU   $RCAFLG                                                  03199000
$CUTESTB EQU   $RCAFLG                                                  03200000
$CONSOLE EQU   $RCAFLG                                                  03201000
$TPLOGON EQU   $RCAFLG                                                  03202000
$UPDATE  EQU   $RCAFLG                                                  03203000
$DEVAREA EQU   $RCAAREA+600                                             03204000
$CTDVAR  EQU   $RCAAREA+596                                             03205000
$BUFFS   EQU   $RCAAREA+464                                             03206000
$TLTNIB  EQU   $CONSTNT+140                                             03207000
$TLTPRPL EQU   $CONSTNT+20                                              03208000
@NM00003 EQU   $CONSTNT+4                                               03209000
@NM00002 EQU   $CONSTNT+2                                               03210000
$USECNT  EQU   $CONSTNT                                                 03211000
$CURRTWA EQU   $POINTER+140                                             03212000
$CTNAME  EQU   $POINTER+132                                             03213000
$CTARGX  EQU   $POINTER+128                                             03214000
$COMINT  EQU   $POINTER+120                                             03215000
$QUEHNDL EQU   $POINTER+116                                             03216000
@NM00001 EQU   $POINTER+36                                              03217000
$RTNPTR  EQU   $POINTER+32                                              03218000
$TLTECB1 EQU   $POINTER+24                                              03219000
$CLEANP  EQU   $POINTER+20                                              03220000
$ABEND   EQU   $POINTER+16                                              03221000
$LSTAREA EQU   $POINTER+12                                              03222000
$FSTAREA EQU   $POINTER+8                                               03223000
$CVTSAVE EQU   $POINTER+4                                               03224000
$TOLTEP  EQU   $POINTER                                                 03225000
$TLTACB  EQU   $RCAAREA                                                 03226000
.@UNREFD ANOP                          END UNREFERENCED COMPONENTS      03227000
@RT00163 EQU   C16C0225                                                 03228000
@RT00172 EQU   C16C0253                                                 03229000
@RT00177 EQU   C16C0100                                                 03230000
@RF00177 EQU   C16C0225                                                 03231000
@RT00193 EQU   C16C0253                                                 03232000
@RT00209 EQU   C16C0075                                                 03233000
@RT00230 EQU   C16C0075                                                 03234000
@RT00278 EQU   C16C0300                                                 03235000
@RT00281 EQU   C16C0300                                                 03236000
@RF00281 EQU   C16C0075                                                 03237000
@RT00284 EQU   C16C0075                                                 03238000
@RC00286 EQU   C16C0300                                                 03239000
@RT00313 EQU   C16C0075                                                 03240000
@RT00316 EQU   C16C0250                                                 03241000
@RT00322 EQU   C16C0075                                                 03242000
@RT00331 EQU   C16C0250                                                 03243000
@RF00331 EQU   C16C0256                                                 03244000
@RF00328 EQU   C16C0075                                                 03245000
@RT00343 EQU   C16C0256                                                 03246000
@RT00371 EQU   C16C1025                                                 03247000
@RF00365 EQU   C16C1050                                                 03248000
@RC00418 EQU   @RC00416                                                 03249000
@RC00423 EQU   @RC00416                                                 03250000
@RC00439 EQU   @RC00438                                                 03251000
@RT00523 EQU   C16C0905                                                 03252000
@PB00007 EQU   @PB00008                                                 03253000
@PB00006 EQU   @PB00007                                                 03254000
@PB00005 EQU   @PB00006                                                 03255000
@PB00004 EQU   @PB00005                                                 03256000
@PB00003 EQU   @PB00004                                                 03257000
@PB00002 EQU   @PB00003                                                 03258000
@ENDDATA EQU   *                                                        03259000
         END   ISTCC016,(C'PLS1039',0702,78336)                         03260000
./  ADD  SSI=83351529,NAME=ISTEC000
         TITLE 'DUMMY MODULE- ISTEC000'                                 00001000
*                                                                  0001 00002000
ISTEC000 CSECT ,                                                   0001 00003000
@MAINENT DS    0H                                                  0001 00004000
         USING *,@15                                               0001 00005000
         B     @PROLOG                                             0001 00006000
         DC    AL1(16)                                             0001 00007000
         DC    C'ISTEC000  78.336'                                 0001 00008000
         DROP  @15                                                      00009000
@PROLOG  BALR  @12,0                                               0001 00010000
@PSTART  DS    0H                                                  0001 00011000
         USING @PSTART,@12                                         0001 00012000
*/********************************************************************/ 00013000
*/*         DUMMY MODULE USED TO MARK THE END OF ISTOLTEP            */ 00014000
*/*01* CHANGE-ACTIVITY=AS FOLLOWS                                    */ 00015000
*/*      CHANGE DESCRIPTIONS                                         */ 00016000
*/*      NEW MODULE-FIRST REL 29 @DL29H00                            */ 00017000
*/********************************************************************/ 00018000
*                                                                  0002 00019000
*   END;                                                           0002 00020000
@EL00001 DS    0H                                                  0002 00021000
@EF00001 DS    0H                                                  0002 00022000
@ER00001 BR    @14                                                 0002 00023000
@DATA    DS    0H                                                       00024000
         DS    0F                                                       00025000
         DS    0F                                                       00026000
         DS    0D                                                       00027000
@00      EQU   00                      EQUATES FOR REGISTERS 0-15       00028000
@01      EQU   01                                                       00029000
@02      EQU   02                                                       00030000
@03      EQU   03                                                       00031000
@04      EQU   04                                                       00032000
@05      EQU   05                                                       00033000
@06      EQU   06                                                       00034000
@07      EQU   07                                                       00035000
@08      EQU   08                                                       00036000
@09      EQU   09                                                       00037000
@10      EQU   10                                                       00038000
@11      EQU   11                                                       00039000
@12      EQU   12                                                       00040000
@13      EQU   13                                                       00041000
@14      EQU   14                                                       00042000
@15      EQU   15                                                       00043000
@ENDDATA EQU   *                                                        00044000
         END   ISTEC000,(C'PLS1217',0702,78336)                         00045000
./  ADD  SSI=90381017,NAME=ISTEC123
         TITLE 'ISTEC123 - MESSAGE MODULE #1'                           00001000
ISTEC123 CSECT ,                                                   0001 00002000
@MAINENT DS    0H                                                  0001 00003000
         USING *,@15                                               0001 00004000
         B     @PROLOG                                             0001 00005000
         DC    AL1(16)                                             0001 00006000
         DC    C'ISTEC123  79.038'                                 0001 00007000
         DROP  @15                                                      00008000
@PROLOG  STM   @14,@12,12(@13)                                     0001 00009000
         BALR  @11,0                                               0001 00010000
@PSTART  DS    0H                                                  0001 00011000
         USING @PSTART,@11                                         0001 00012000
         SPACE                                                          00013000
*                                                                  0026 00014000
*/********************************************************************/ 00015000
*/* LOCATE MESSAGE IN TABLE                                          */ 00016000
*/********************************************************************/ 00017000
*                                                                  0027 00018000
*   MSG#=MSGNUM-99;                 /* GET MSG NUMBER                */ 00019000
         L     MSG#,MSGNUM(,WAPTR)                                 0027 00020000
         SL    MSG#,@CF01067                                       0027 00021000
*   IF MSG#<101                     /* IS MSG NUMBER 100-199         */ 00022000
*     THEN                                                         0028 00023000
         C     MSG#,@CF01068                                       0028 00024000
         BNL   @RF00028                                            0028 00025000
*     MSGPTR=MSGTBL1(MSG#)+ADDR(MESSAGES);/* GET PTR TO MSG          */ 00026000
         LR    @12,MSG#                                            0029 00027000
         ALR   @12,@12                                             0029 00028000
         LA    MSGPTR,MESSAGES                                     0029 00029000
         AH    MSGPTR,MSGTBL1-2(@12)                               0029 00030000
*   ELSE                                                           0030 00031000
*     DO;                                                          0030 00032000
         B     @RC00028                                            0030 00033000
@RF00028 DS    0H                                                  0031 00034000
*       MSG#=MSGNUM-199;                                           0031 00035000
         L     MSG#,MSGNUM(,WAPTR)                                 0031 00036000
         SL    MSG#,@CF01069                                       0031 00037000
*       IF MSG#<101                 /* IS MSG NUMBER 200-299         */ 00038000
*         THEN                                                     0032 00039000
         C     MSG#,@CF01068                                       0032 00040000
         BNL   @RF00032                                            0032 00041000
*         MSGPTR=MSGTBL2(MSG#)+ADDR(MESSAGES);/* GET PTR TO MSG      */ 00042000
         LR    @12,MSG#                                            0033 00043000
         ALR   @12,@12                                             0033 00044000
         LA    MSGPTR,MESSAGES                                     0033 00045000
         AH    MSGPTR,MSGTBL2-2(@12)                               0033 00046000
*       ELSE                                                       0034 00047000
*         DO;                                                      0034 00048000
         B     @RC00032                                            0034 00049000
@RF00032 DS    0H                                                  0035 00050000
*           MSG#=MSGNUM-299;        /* MSG NUMBER IS 300-399         */ 00051000
         L     MSG#,MSGNUM(,WAPTR)                                 0035 00052000
         SL    MSG#,@CF01070                                       0035 00053000
*           MSGPTR=MSGTBL3(MSG#)+ADDR(MESSAGES);/* GET PTR TO MSG    */ 00054000
         LR    @12,MSG#                                            0036 00055000
         ALR   @12,@12                                             0036 00056000
         LA    MSGPTR,MESSAGES                                     0036 00057000
         AH    MSGPTR,MSGTBL3-2(@12)                               0036 00058000
*         END;                                                     0037 00059000
*     END;                                                         0038 00060000
*                                                                  0038 00061000
@RC00032 DS    0H                                                  0039 00062000
*/********************************************************************/ 00063000
*/* SEND MESSAGE INFORMATION BACK TO CALLER                          */ 00064000
*/********************************************************************/ 00065000
*                                                                  0039 00066000
*   $COUTCT(4:4)=MSGDAT;            /* GET MSG LENGTH                */ 00067000
@RC00028 MVC   $COUTCT+3(1,WAPTR),MSGDAT(MSGPTR)                   0039 00068000
*   MSGPTR=MSGPTR+1;                /* SET PTR TO START OF MSG       */ 00069000
         AL    MSGPTR,@CF00044                                     0040 00070000
*   MSGNUM=MSGPTR;                  /* SAVE MSG TEXT PTR             */ 00071000
         ST    MSGPTR,MSGNUM(,WAPTR)                               0041 00072000
*   DO;                             /* ATDSPLY                       */ 00073000
*   END;                            /* ATDSPLY                       */ 00074000
*   END;                                                           0044 00075000
@EL00001 DS    0H                                                  0044 00076000
@EF00001 DS    0H                                                  0044 00077000
@ER00001 LM    @14,@12,12(@13)                                     0044 00078000
         BR    @14                                                 0044 00079000
@DATA    DS    0H                                                       00080000
         DS    0F                                                       00081000
         DS    0F                                                       00082000
@CF00044 DC    F'1'                                                     00083000
@CF01067 DC    F'99'                                                    00084000
@CF01068 DC    F'101'                                                   00085000
@CF01069 DC    F'199'                                                   00086000
@CF01070 DC    F'299'                                                   00087000
         DS    0D                                                       00088000
@NM00006 DS    CL5414                                                   00089000
         ORG   @NM00006                                                 00090000
MSGTBL1  DC    AL2(M100-MESSAGES)                                       00091000
         DC    AL2(M101-MESSAGES)                                       00092000
         DC    AL2(M102-MESSAGES)                                       00093000
         DC    AL2(M103-MESSAGES)                                       00094000
         DC    AL2(M104-MESSAGES)                                       00095000
         DC    AL2(M105-MESSAGES)                                       00096000
         DC    AL2(M106-MESSAGES)                                       00097000
         DC    AL2(M107-MESSAGES)                                       00098000
         DC    AL2(M108-MESSAGES)                                       00099000
         DC    AL2(M109-MESSAGES)                                       00100000
         DC    AL2(M110-MESSAGES)                                       00101000
         DC    AL2(M111-MESSAGES)                                       00102000
         DC    AL2(M112-MESSAGES)                                       00103000
         DC    AL2(M113-MESSAGES)                                       00104000
         DC    AL2(M114-MESSAGES)                                       00105000
         DC    AL2(M115-MESSAGES)                                       00106000
         DC    AL2(M116-MESSAGES)                                       00107000
         DC    AL2(M117-MESSAGES)                                       00108000
         DC    AL2(M118-MESSAGES)                                       00109000
         DC    AL2(M119-MESSAGES)                                       00110000
         DC    AL2(M120-MESSAGES)                                       00111000
         DC    AL2(M121-MESSAGES)                                       00112000
         DC    AL2(M122-MESSAGES)                                       00113000
         DC    AL2(M123-MESSAGES)                                       00114000
         DC    AL2(M124-MESSAGES)                                       00115000
         DC    AL2(M125-MESSAGES)                                       00116000
         DC    AL2(M126-MESSAGES)                                       00117000
         DC    AL2(M127-MESSAGES)                                       00118000
         DC    AL2(M128-MESSAGES)                                       00119000
         DC    AL2(M129-MESSAGES)                                       00120000
         DC    AL2(M130-MESSAGES)                                       00121000
         DC    AL2(M131-MESSAGES)                                       00122000
         DC    AL2(M132-MESSAGES)                                       00123000
         DC    AL2(M133-MESSAGES)                                       00124000
         DC    AL2(M134-MESSAGES)                                       00125000
         DC    AL2(M135-MESSAGES)                                       00126000
         DC    AL2(M136-MESSAGES)                                       00127000
         DC    AL2(M137-MESSAGES)                                       00128000
         DC    AL2(M138-MESSAGES)                                       00129000
         DC    AL2(M139-MESSAGES)                                       00130000
         DC    AL2(M140-MESSAGES)                                       00131000
         DC    AL2(M141-MESSAGES)                                       00132000
         DC    AL2(M142-MESSAGES)                                       00133000
         DC    AL2(M143-MESSAGES)                                       00134000
         DC    AL2(M144-MESSAGES)                                       00135000
         DC    AL2(M145-MESSAGES)                                       00136000
         DC    AL2(M146-MESSAGES)                                       00137000
         DC    AL2(M147-MESSAGES)                                       00138000
         DC    AL2(M148-MESSAGES)                                       00139000
         DC    AL2(M149-MESSAGES)                                       00140000
         DC    AL2(M150-MESSAGES)                                       00141000
         DC    AL2(M151-MESSAGES)                                       00142000
         DC    AL2(M152-MESSAGES)                                       00143000
         DC    AL2(M153-MESSAGES)                                       00144000
         DC    AL2(M154-MESSAGES)                                       00145000
         DC    AL2(M155-MESSAGES)                                       00146000
         DC    AL2(M156-MESSAGES)                                       00147000
         DC    AL2(M157-MESSAGES)                                       00148000
         DC    AL2(M158-MESSAGES)                                       00149000
         DC    AL2(M159-MESSAGES)                                       00150000
         DC    AL2(M160-MESSAGES)                                       00151000
         DC    AL2(M161-MESSAGES)                                       00152000
         DC    AL2(M162-MESSAGES)                                       00153000
         DC    AL2(M163-MESSAGES)                                       00154000
         DC    AL2(M164-MESSAGES)                                       00155000
         DC    AL2(M165-MESSAGES)                                       00156000
         DC    AL2(M166-MESSAGES)                                       00157000
         DC    AL2(M167-MESSAGES)                                       00158000
         DC    AL2(M168-MESSAGES)                                       00159000
         DC    AL2(M169-MESSAGES)                                       00160000
         DC    AL2(M170-MESSAGES)                                       00161000
         DC    AL2(M171-MESSAGES)                                       00162000
         DC    AL2(M172-MESSAGES)                                       00163000
         DC    AL2(M173-MESSAGES)                                       00164000
         DC    AL2(M174-MESSAGES)                                       00165000
         DC    AL2(M175-MESSAGES)                                       00166000
         DC    AL2(M176-MESSAGES)                                       00167000
         DC    AL2(M177-MESSAGES)                                       00168000
         DC    AL2(M178-MESSAGES)                                       00169000
         DC    AL2(M179-MESSAGES)                                       00170000
         DC    AL2(M180-MESSAGES)                                       00171000
         DC    AL2(M181-MESSAGES)                                       00172000
         DC    AL2(M182-MESSAGES)                                       00173000
         DC    AL2(M183-MESSAGES)                                       00174000
         DC    AL2(M184-MESSAGES)                                       00175000
         DC    AL2(M185-MESSAGES)                                       00176000
         DC    AL2(M186-MESSAGES)                                       00177000
         DC    AL2(M187-MESSAGES)                                       00178000
         DC    AL2(M188-MESSAGES)                                       00179000
         DC    AL2(M189-MESSAGES)                                       00180000
         DC    AL2(M190-MESSAGES)                                       00181000
         DC    AL2(M191-MESSAGES)                                       00182000
         DC    AL2(M192-MESSAGES)                                       00183000
         DC    AL2(M193-MESSAGES)                                       00184000
         DC    AL2(M194-MESSAGES)                                       00185000
         DC    AL2(M195-MESSAGES)                                       00186000
         DC    AL2(M196-MESSAGES)                                       00187000
         DC    AL2(M197-MESSAGES)                                       00188000
         DC    AL2(M198-MESSAGES)                                       00189000
         DC    AL2(M199-MESSAGES)                                       00190000
MSGTBL2  DC    AL2(M200-MESSAGES)                                       00191000
         DC    AL2(M201-MESSAGES)                                       00192000
         DC    AL2(M202-MESSAGES)                                       00193000
         DC    AL2(M203-MESSAGES)                                       00194000
         DC    AL2(M204-MESSAGES)                                       00195000
         DC    AL2(M205-MESSAGES)                                       00196000
         DC    AL2(M206-MESSAGES)                                       00197000
         DC    AL2(M207-MESSAGES)                                       00198000
         DC    AL2(M208-MESSAGES)                                       00199000
         DC    AL2(M209-MESSAGES)                                       00200000
         DC    AL2(M210-MESSAGES)                                       00201000
         DC    AL2(M211-MESSAGES)                                       00202000
         DC    AL2(M212-MESSAGES)                                       00203000
         DC    AL2(M213-MESSAGES)                                       00204000
         DC    AL2(M214-MESSAGES)                                       00205000
         DC    AL2(M215-MESSAGES)                                       00206000
         DC    AL2(M216-MESSAGES)                                       00207000
         DC    AL2(M217-MESSAGES)                                       00208000
         DC    AL2(M218-MESSAGES)                                       00209000
         DC    AL2(M219-MESSAGES)                                       00210000
         DC    AL2(M220-MESSAGES)                                       00211000
         DC    AL2(M221-MESSAGES)                                       00212000
         DC    AL2(M222-MESSAGES)                                       00213000
         DC    AL2(M223-MESSAGES)                                       00214000
         DC    AL2(M224-MESSAGES)                                       00215000
         DC    AL2(M225-MESSAGES)                                       00216000
         DC    AL2(M226-MESSAGES)                                       00217000
         DC    AL2(M227-MESSAGES)                                       00218000
         DC    AL2(M228-MESSAGES)                                       00219000
         DC    AL2(M229-MESSAGES)                                       00220000
         DC    AL2(M230-MESSAGES)                                       00221000
         DC    AL2(M231-MESSAGES)                                       00222000
         DC    AL2(M232-MESSAGES)                                       00223000
         DC    AL2(M233-MESSAGES)                                       00224000
         DC    AL2(M234-MESSAGES)                                       00225000
         DC    AL2(M235-MESSAGES)                                       00226000
         DC    AL2(M236-MESSAGES)                                       00227000
         DC    AL2(M237-MESSAGES)                                       00228000
         DC    AL2(M238-MESSAGES)                                       00229000
         DC    AL2(M239-MESSAGES)                                       00230000
         DC    AL2(M240-MESSAGES)                                       00231000
         DC    AL2(M241-MESSAGES)                                       00232000
         DC    AL2(M242-MESSAGES)                                       00233000
         DC    AL2(M243-MESSAGES)                                       00234000
         DC    AL2(M244-MESSAGES)                                       00235000
         DC    AL2(M245-MESSAGES)                                       00236000
         DC    AL2(M246-MESSAGES)                                       00237000
         DC    AL2(M247-MESSAGES)                                       00238000
         DC    AL2(M248-MESSAGES)                                       00239000
         DC    AL2(M249-MESSAGES)                                       00240000
         DC    AL2(M250-MESSAGES)                                       00241000
         DC    AL2(M251-MESSAGES)                                       00242000
         DC    AL2(M252-MESSAGES)                                       00243000
         DC    AL2(M253-MESSAGES)                                       00244000
         DC    AL2(M254-MESSAGES)                                       00245000
         DC    AL2(M255-MESSAGES)                                       00246000
         DC    AL2(M256-MESSAGES)                                       00247000
         DC    AL2(M257-MESSAGES)                                       00248000
         DC    AL2(M258-MESSAGES)                                       00249000
         DC    AL2(M259-MESSAGES)                                       00250000
         DC    AL2(M260-MESSAGES)                                       00251000
         DC    AL2(M261-MESSAGES)                                       00252000
         DC    AL2(M262-MESSAGES)                                       00253000
         DC    AL2(M263-MESSAGES)                                       00254000
         DC    AL2(M264-MESSAGES)                                       00255000
         DC    AL2(M265-MESSAGES)                                       00256000
         DC    AL2(M266-MESSAGES)                                       00257000
         DC    AL2(M267-MESSAGES)                                       00258000
         DC    AL2(M268-MESSAGES)                                       00259000
         DC    AL2(M269-MESSAGES)                                       00260000
         DC    AL2(M270-MESSAGES)                                       00261000
         DC    AL2(M271-MESSAGES)                                       00262000
         DC    AL2(M272-MESSAGES)                                       00263000
         DC    AL2(M273-MESSAGES)                                       00264000
         DC    AL2(M274-MESSAGES)                                       00265000
         DC    AL2(M275-MESSAGES)                                       00266000
         DC    AL2(M276-MESSAGES)                                       00267000
         DC    AL2(M277-MESSAGES)                                       00268000
         DC    AL2(M278-MESSAGES)                                       00269000
         DC    AL2(M279-MESSAGES)                                       00270000
         DC    AL2(M280-MESSAGES)                                       00271000
         DC    AL2(M281-MESSAGES)                                       00272000
         DC    AL2(M282-MESSAGES)                                       00273000
         DC    AL2(M283-MESSAGES)                                       00274000
         DC    AL2(M284-MESSAGES)                                       00275000
         DC    AL2(M285-MESSAGES)                                       00276000
         DC    AL2(M286-MESSAGES)                                       00277000
         DC    AL2(M287-MESSAGES)                                       00278000
         DC    AL2(M288-MESSAGES)                                       00279000
         DC    AL2(M289-MESSAGES)                                       00280000
         DC    AL2(M290-MESSAGES)                                       00281000
         DC    AL2(M291-MESSAGES)                                       00282000
         DC    AL2(M292-MESSAGES)                                       00283000
         DC    AL2(M293-MESSAGES)                                       00284000
         DC    AL2(M294-MESSAGES)                                       00285000
         DC    AL2(M295-MESSAGES)                                       00286000
         DC    AL2(M296-MESSAGES)                                       00287000
         DC    AL2(M297-MESSAGES)                                       00288000
         DC    AL2(M298-MESSAGES)                                       00289000
         DC    AL2(M299-MESSAGES)                                       00290000
MSGTBL3  DC    AL2(M300-MESSAGES)                                       00291000
         DC    AL2(M301-MESSAGES)                                       00292000
         DC    AL2(M302-MESSAGES)                                       00293000
         DC    AL2(M303-MESSAGES)                                       00294000
         DC    AL2(M304-MESSAGES)                                       00295000
         DC    AL2(M305-MESSAGES)                                       00296000
         DC    AL2(M306-MESSAGES)                                       00297000
         DC    AL2(M307-MESSAGES)                                       00298000
         DC    AL2(M308-MESSAGES)                                       00299000
         DC    AL2(M309-MESSAGES)                                       00300000
         DC    AL2(M310-MESSAGES)                                       00301000
         DC    AL2(M311-MESSAGES)                                       00302000
         DC    AL2(M312-MESSAGES)                                       00303000
         DC    AL2(M313-MESSAGES)                                       00304000
         DC    AL2(M314-MESSAGES)                                       00305000
         DC    AL2(M315-MESSAGES)                                       00306000
         DC    AL2(M316-MESSAGES)                                       00307000
         DC    AL2(M317-MESSAGES)                                       00308000
         DC    AL2(M318-MESSAGES)                                       00309000
         DC    AL2(M319-MESSAGES)                                       00310000
         DC    AL2(M320-MESSAGES)                                       00311000
         DC    AL2(M321-MESSAGES)                                       00312000
         DC    AL2(M322-MESSAGES)                                       00313000
         DC    AL2(M323-MESSAGES)                                       00314000
         DC    AL2(M324-MESSAGES)                                       00315000
         DC    AL2(M325-MESSAGES)                                       00316000
         DC    AL2(M326-MESSAGES)                                       00317000
         DC    AL2(M327-MESSAGES)                                       00318000
         DC    AL2(M328-MESSAGES)                                       00319000
         DC    AL2(M329-MESSAGES)                                       00320000
         DC    AL2(M330-MESSAGES)                                       00321000
         DC    AL2(M331-MESSAGES)                                       00322000
         DC    AL2(M332-MESSAGES)                                       00323000
         DC    AL2(M333-MESSAGES)                                       00324000
         DC    AL2(M334-MESSAGES)                                       00325000
         DC    AL2(M335-MESSAGES)                                       00326000
         DC    AL2(M336-MESSAGES)                                       00327000
         DC    AL2(M337-MESSAGES)                                       00328000
         DC    AL2(M338-MESSAGES)                                       00329000
         DC    AL2(M339-MESSAGES)                                       00330000
         DC    AL2(M340-MESSAGES)                                       00331000
         DC    AL2(M341-MESSAGES)                                       00332000
         DC    AL2(M342-MESSAGES)                                       00333000
         DC    AL2(M343-MESSAGES)                                       00334000
         DC    AL2(M344-MESSAGES)                                       00335000
         DC    AL2(M345-MESSAGES)                                       00336000
         DC    AL2(M346-MESSAGES)                                       00337000
         DC    AL2(M347-MESSAGES)                                       00338000
         DC    AL2(M348-MESSAGES)                                       00339000
         DC    AL2(M349-MESSAGES)                                       00340000
         DC    AL2(M350-MESSAGES)                                       00341000
         DC    AL2(M351-MESSAGES)                                       00342000
         DC    AL2(M352-MESSAGES)                                       00343000
         DC    AL2(M353-MESSAGES)                                       00344000
         DC    AL2(M354-MESSAGES)                                       00345000
         DC    AL2(M355-MESSAGES)                                       00346000
         DC    AL2(M356-MESSAGES)                                       00347000
         DC    AL2(M357-MESSAGES)                                       00348000
         DC    AL2(M358-MESSAGES)                                       00349000
         DC    AL2(M359-MESSAGES)                                       00350000
         DC    AL2(M360-MESSAGES)                                       00351000
         DC    AL2(M361-MESSAGES)                                       00352000
         DC    AL2(M362-MESSAGES)                                       00353000
         DC    AL2(M363-MESSAGES)                                       00354000
         DC    AL2(M364-MESSAGES)                                       00355000
         DC    AL2(M365-MESSAGES)                                       00356000
         DC    AL2(M366-MESSAGES)                                       00357000
         DC    AL2(M367-MESSAGES)                                       00358000
         DC    AL2(M368-MESSAGES)                                       00359000
         DC    AL2(M369-MESSAGES)                                       00360000
         DC    AL2(M370-MESSAGES)                                       00361000
         DC    AL2(M371-MESSAGES)                                       00362000
         DC    AL2(M372-MESSAGES)                                       00363000
         DC    AL2(M373-MESSAGES)                                       00364000
         DC    AL2(M374-MESSAGES)                                       00365000
         DC    AL2(M375-MESSAGES)                                       00366000
         DC    AL2(M376-MESSAGES)                                       00367000
         DC    AL2(M377-MESSAGES)                                       00368000
         DC    AL2(M378-MESSAGES)                                       00369000
         DC    AL2(M379-MESSAGES)                                       00370000
         DC    AL2(M380-MESSAGES)                                       00371000
         DC    AL2(M381-MESSAGES)                                       00372000
         DC    AL2(M382-MESSAGES)                                       00373000
         DC    AL2(M383-MESSAGES)                                       00374000
         DC    AL2(M384-MESSAGES)                                       00375000
         DC    AL2(M385-MESSAGES)                                       00376000
         DC    AL2(M386-MESSAGES)                                       00377000
         DC    AL2(M387-MESSAGES)                                       00378000
         DC    AL2(M388-MESSAGES)                                       00379000
         DC    AL2(M389-MESSAGES)                                       00380000
         DC    AL2(M390-MESSAGES)                                       00381000
         DC    AL2(M391-MESSAGES)                                       00382000
         DC    AL2(M392-MESSAGES)                                       00383000
         DC    AL2(M393-MESSAGES)                                       00384000
         DC    AL2(M394-MESSAGES)                                       00385000
         DC    AL2(M395-MESSAGES)                                       00386000
         DC    AL2(M396-MESSAGES)                                       00387000
         DC    AL2(M397-MESSAGES)                                       00388000
         DC    AL2(M398-MESSAGES)                                       00389000
         DC    AL2(M399-MESSAGES)                                       00390000
MESSAGES DS    CL4814                                                   00391000
         ORG   MESSAGES                                                 00392000
M100     DC    AL1(18)                                                  00393000
@NM00007 DC    CL18'THIS IS A TEST MSG'                                 00394000
M101     DC    AL1(18)                                                  00395000
@NM00008 DC    CL18'THIS IS A TEST MSG'                                 00396000
M102     DC    AL1(48)                                                  00397000
@NM00009 DC    CL48'102I ISTOLTEP INITIALIZATION IN PROGRESS        '   00398000
M103     DC    AL1(0)                                                   00399000
M104     DC    AL1(0)                                                   00400000
M105     DC    AL1(24)                                                  00401000
@NM00010 DC    CL24'105D ENTER DEV/TEST/OPT/'                           00402000
M106     DC    AL1(42)                                                  00403000
@NM00011 DC    CL42'106I INPUT DATA DOES NOT CONTAIN 3 SLASHES'         00404000
M107     DC    AL1(61)                                                  00405000
@NM00012 DC    CL61'107I OPTIONS ARE %%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%C00406000
               %%%%%%%%%%'                                              00407000
M108     DC    AL1(38)                                                  00408000
@NM00013 DC    CL38'108I INVALID ENTRY IN DEV FLD-%%%%%%%%'             00409000
M109     DC    AL1(0)                                                   00410000
M110     DC    AL1(39)                                                  00411000
@NM00014 DC    CL39'110I TESTABLE DEVICES MAY NOT EXCEED 16'            00412000
M111     DC    AL1(0)                                                   00413000
M112     DC    AL1(39)                                                  00414000
@NM00015 DC    CL39'112I INVALID ENTRY IN TEST FLD-%%%%%%%%'            00415000
M113     DC    AL1(0)                                                   00416000
M114     DC    AL1(0)                                                   00417000
M115     DC    AL1(38)                                                  00418000
@NM00016 DC    CL38'115I INVALID ENTRY IN OPT FLD-%%%%%%%%'             00419000
M116     DC    AL1(0)                                                   00420000
M117     DC    AL1(31)                                                  00421000
@NM00017 DC    CL31'117I SECTION %%%%%%%% NOT FOUND'                    00422000
M118     DC    AL1(0)                                                   00423000
M119     DC    AL1(0)                                                   00424000
M120     DC    AL1(0)                                                   00425000
M121     DC    AL1(0)                                                   00426000
M122     DC    AL1(0)                                                   00427000
M123     DC    AL1(0)                                                   00428000
M124     DC    AL1(0)                                                   00429000
M125     DC    AL1(0)                                                   00430000
M126     DC    AL1(0)                                                   00431000
M127     DC    AL1(24)                                                  00432000
@NM00018 DC    CL24'127I NO CDS FOR %%%%%%%%'                           00433000
M128     DC    AL1(0)                                                   00434000
M129     DC    AL1(62)                                                  00435000
@NM00019 DC    CL62'129I FIRST ERROR COMMUNICATION %%%%%%%% %%% UNIT %%C00436000
               %% %%%%%%%%'                                             00437000
M130     DC    AL1(0)                                                   00438000
M131     DC    AL1(0)                                                   00439000
M132     DC    AL1(0)                                                   00440000
M133     DC    AL1(0)                                                   00441000
M134     DC    AL1(0)                                                   00442000
M135     DC    AL1(0)                                                   00443000
M136     DC    AL1(0)                                                   00444000
M137     DC    AL1(0)                                                   00445000
M138     DC    AL1(0)                                                   00446000
M139     DC    AL1(0)                                                   00447000
M140     DC    AL1(0)                                                   00448000
M141     DC    AL1(33)                                                  00449000
@NM00020 DC    CL33'141I -VERB INPUT-  -ACTION TAKEN-'                  00450000
M141A    DC    AL1(52)                                                  00451000
@NM00021 DC    CL52'141I PROMPT DEV   ILLUSTRATION OF DEVICE FIELD INPUC00452000
               T'                                                       00453000
M141B    DC    AL1(50)                                                  00454000
@NM00022 DC    CL50'141I PROMPT TEST  ILLUSTRATION OF TEST FIELD INPUT' 00455000
M141C    DC    AL1(52)                                                  00456000
@NM00023 DC    CL52'141I PROMPT OPT   ILLUSTRATION OF OPTION FIELD INPUC00457000
               T'                                                       00458000
M141D    DC    AL1(45)                                                  00459000
@NM00024 DC    CL45'141I PROMPT VERB  ILLUSTRATION OF VALID VERBS'      00460000
M141E    DC    AL1(44)                                                  00461000
@NM00025 DC    CL44'141I PROMPT ALL   ILLUSTRATIONS OF ALL ABOVE'       00462000
M141F    DC    AL1(44)                                                  00463000
@NM00026 DC    CL44'141I PROMPT       ILLUSTRATIONS OF ALL ABOVE'       00464000
M141G    DC    AL1(50)                                                  00465000
@NM00027 DC    CL50'141I CT=XXXXXXXX  TRANSFERS CONTROL TO CT XXXXXXXX' 00466000
M141H    DC    AL1(50)                                                  00467000
@NM00028 DC    CL50'141I TALK         INITIATES COMMUNICATION WITH OLT' 00468000
M141I    DC    AL1(39)                                                  00469000
@NM00029 DC    CL39'141I DUMP         SELECTS DUMP FUNCTION'            00470000
M141J    DC    AL1(41)                                                  00471000
@NM00030 DC    CL41'141I CANCEL       TERMINATES TEST SESSION'          00472000
M141K    DC    AL1(41)                                                  00473000
@NM00031 DC    CL41'141I UPDATE       SELECTS UPDATE FUNCTION'          00474000
M142     DC    AL1(0)                                                   00475000
M143     DC    AL1(0)                                                   00476000
M144     DC    AL1(0)                                                   00477000
M145     DC    AL1(0)                                                   00478000
M146     DC    AL1(0)                                                   00479000
M147     DC    AL1(33)                                                  00480000
@NM00032 DC    CL33'147I EXAMPLES OF THE DEVICE FIELD'                  00481000
M147A    DC    AL1(34)                                                  00482000
@NM00033 DC    CL34'147I 0081/           TEST UNIT 081'                 00483000
M147B    DC    AL1(47)                                                  00484000
@NM00034 DC    CL47'147I 082-084/        TEST UNITS 082,083,AND 084'    00485000
M147C    DC    AL1(51)                                                  00486000
@NM00035 DC    CL51'147I 081,082-084/    TEST UNITS 081,082,083,AND 084C00487000
               '                                                        00488000
M147D    DC    AL1(48)                                                  00489000
@NM00036 DC    CL48'147I CHIC1/          TEST SYMBOLIC TP UNIT CHIC1'   00490000
M147E    DC    AL1(59)                                                  00491000
@NM00037 DC    CL59'147I CHIC1,CHIC3/    TEST SYMBOLIC TP UNITS CHIC1 AC00492000
               ND CHIC3'                                                00493000
M147F    DC    AL1(50)                                                  00494000
@NM00038 DC    CL50'147I SNA3275A(S3270)/  USE LOGMODE S3270 ON OPNDST' 00495000
M147G    DC    AL1(58)                                                  00496000
@NM00039 DC    CL58'147I D3770A(X''030321913040'')/  BIND WITH SESSPARMC00497000
               S GIVEN'                                                 00498000
M147H    DC    AL1(33)                                                  00499000
@NM00040 DC    CL33'147I */ TEST THE CONTROL TERMINAL'                  00500000
M147I    DC    AL1(53)                                                  00501000
@NM00041 DC    CL53'147I / (SLASH ALONE) TEST PREVIOUSLY SELECTED DEVICC00502000
               ES'                                                      00503000
M148     DC    AL1(27)                                                  00504000
@NM00042 DC    CL27'148I EXAMPLES OF TEST FIELD'                        00505000
M148A    DC    AL1(43)                                                  00506000
@NM00043 DC    CL43'148I 3270/          TEST T3270, SEC. A TO Z'        00507000
M148B    DC    AL1(42)                                                  00508000
@NM00044 DC    CL42'148I T3700OLT/      SEC. OLT OF TEST T3700'         00509000
M148C    DC    AL1(40)                                                  00510000
@NM00045 DC    CL40'148I R3270B/        SEC. B OF TEST R3270'           00511000
M148D    DC    AL1(65)                                                  00512000
@NM00046 DC    CL65'148I T3700OLT,2,11-13/   RTN 2,11,12,13 IN SEC. OLTC00513000
                OF TEST T3700'                                          00514000
M148H    DC    AL1(50)                                                  00515000
@NM00047 DC    CL50'148I / (SLASH ALONE) RUN PREVIOUSLY SELECTED TESTS' 00516000
M149     DC    AL1(21)                                                  00517000
@NM00048 DC    CL21'149I TABLE OF OPTIONS'                              00518000
M149A    DC    AL1(49)                                                  00519000
@NM00049 DC    CL49'149I OPTION               TO REQUEST  TO OMIT  BY'  00520000
M149B    DC    AL1(54)                                                  00521000
@NM00050 DC    CL54'149I                      OPTION      OPTION   DEFAC00522000
               ULT'                                                     00523000
M149C    DC    AL1(50)                                                  00524000
@NM00051 DC    CL50'149I TESTING LOOP         TL          NTL      NTL' 00525000
M149D    DC    AL1(49)                                                  00526000
@NM00052 DC    CL49'149I                      TL(VALUE) VALUE=1-32767'  00527000
M149E    DC    AL1(50)                                                  00528000
@NM00053 DC    CL50'149I ERROR LOOP           EL          NEL      NEL' 00529000
M149F    DC    AL1(49)                                                  00530000
@NM00054 DC    CL49'149I                      EL(VALUE) VALUE=1-32767'  00531000
M149G    DC    AL1(49)                                                  00532000
@NM00055 DC    CL49'149I ERROR PRINT          EP          NEP      EP'  00533000
M149H    DC    AL1(49)                                                  00534000
@NM00056 DC    CL49'149I CONTROL PRINT        CP          NCP      CP'  00535000
M149I    DC    AL1(50)                                                  00536000
@NM00057 DC    CL50'149I PARALLEL PRINT       PP          NPP      NPP' 00537000
M149J    DC    AL1(45)                                                  00538000
@NM00058 DC    CL45'149I                      PP(LEVEL) LEVEL=0-3'      00539000
M149K    DC    AL1(49)                                                  00540000
@NM00059 DC    CL49'149I PRINT                PR          NPR      PR'  00541000
M149L    DC    AL1(50)                                                  00542000
@NM00060 DC    CL50'149I ALTERNATE PRINTER    AP(TERM)    NAP      NAP' 00543000
M149M    DC    AL1(49)                                                  00544000
@NM00061 DC    CL49'149I FIRST ERROR-         FE          NFE      FE'  00545000
M149N    DC    AL1(18)                                                  00546000
@NM00062 DC    CL18'149I COMMUNICATION'                                 00547000
M149O    DC    AL1(50)                                                  00548000
@NM00063 DC    CL50'149I MANUAL INTERVENTION  MI          NMI      NMI' 00549000
M149P    DC    AL1(50)                                                  00550000
@NM00064 DC    CL50'149I TRACE                TR          NTR      NTR' 00551000
M149Q    DC    AL1(30)                                                  00552000
@NM00065 DC    CL30'149I EXTERNAL DATA        EXT='                     00553000
M149R    DC    AL1(29)                                                  00554000
@NM00066 DC    CL29'149I EXAMPLES OF OPTION FIELD'                      00555000
M149S    DC    AL1(12)                                                  00556000
@NM00067 DC    CL12'149I PP,NMI/'                                       00557000
M149T    DC    AL1(26)                                                  00558000
@NM00068 DC    CL26'149I EP,TL(50),FE,EXT=A,B/'                         00559000
M150     DC    AL1(0)                                                   00560000
M151     DC    AL1(0)                                                   00561000
M152     DC    AL1(0)                                                   00562000
M153     DC    AL1(0)                                                   00563000
M154     DC    AL1(0)                                                   00564000
M155     DC    AL1(36)                                                  00565000
@NM00069 DC    CL36'155I TEST SECTIONS MAY NOT EXCEED 26'               00566000
M156     DC    AL1(0)                                                   00567000
M157     DC    AL1(47)                                                  00568000
@NM00070 DC    CL47'157I CATASTROPHIC ERROR ON DEVICE %%%% %%%%%%%%'    00569000
M158     DC    AL1(35)                                                  00570000
@NM00071 DC    CL35'158I %% %%%%%%%% UNIT %%%% %%%%%%%%'                00571000
M159     DC    AL1(0)                                                   00572000
M160     DC    AL1(0)                                                   00573000
M161     DC    AL1(26)                                                  00574000
@NM00072 DC    CL26'161I FOR HELP ENTER PROMPT'                         00575000
M162     DC    AL1(0)                                                   00576000
M163     DC    AL1(0)                                                   00577000
M164     DC    AL1(0)                                                   00578000
M165     DC    AL1(0)                                                   00579000
M166     DC    AL1(30)                                                  00580000
@NM00073 DC    CL30'166I OLT DOES NOT SUPPORT TALK'                     00581000
M167     DC    AL1(0)                                                   00582000
M168     DC    AL1(0)                                                   00583000
M169     DC    AL1(0)                                                   00584000
M170     DC    AL1(34)                                                  00585000
@NM00074 DC    CL34'170I NO PREVIOUSLY SELECTED DEVICE'                 00586000
M170A    DC    AL1(32)                                                  00587000
@NM00075 DC    CL32'170I NO PREVIOUSLY SELECTED TEST'                   00588000
M171     DC    AL1(0)                                                   00589000
M172     DC    AL1(0)                                                   00590000
M173     DC    AL1(0)                                                   00591000
M174     DC    AL1(0)                                                   00592000
M175     DC    AL1(0)                                                   00593000
M176     DC    AL1(0)                                                   00594000
M177     DC    AL1(0)                                                   00595000
M178     DC    AL1(0)                                                   00596000
M179     DC    AL1(0)                                                   00597000
M180     DC    AL1(0)                                                   00598000
M181     DC    AL1(0)                                                   00599000
M182     DC    AL1(0)                                                   00600000
M183     DC    AL1(0)                                                   00601000
M184     DC    AL1(0)                                                   00602000
M185     DC    AL1(0)                                                   00603000
M186     DC    AL1(0)                                                   00604000
M187     DC    AL1(0)                                                   00605000
M188     DC    AL1(0)                                                   00606000
M189     DC    AL1(0)                                                   00607000
M190     DC    AL1(0)                                                   00608000
M191     DC    AL1(0)                                                   00609000
M192     DC    AL1(0)                                                   00610000
M193     DC    AL1(0)                                                   00611000
M194     DC    AL1(0)                                                   00612000
M195     DC    AL1(0)                                                   00613000
M196     DC    AL1(0)                                                   00614000
M197     DC    AL1(0)                                                   00615000
M198     DC    AL1(39)                                                  00616000
@NM00076 DC    CL39'198I NOT ALL ROUTINES SELECTED WERE RUN'            00617000
M199     DC    AL1(0)                                                   00618000
M200     DC    AL1(47)                                                  00619000
@NM00077 DC    CL47'200I TEST %%%%%%%% EXCEEDS AVAILABLE CORE SPACE'    00620000
M201     DC    AL1(57)                                                  00621000
@NM00078 DC    CL57'201I DEVICE DESCRIPTORS DO NOT MEET %%%%%%%% REQUIRC00622000
               EMENTS'                                                  00623000
M202     DC    AL1(29)                                                  00624000
@NM00079 DC    CL29'202I READ AN INVALID REP CARD'                      00625000
M203     DC    AL1(41)                                                  00626000
@NM00080 DC    CL41'203I EOF OCCURRED BEFORE READING END CARD'          00627000
M204     DC    AL1(0)                                                   00628000
M205     DC    AL1(32)                                                  00629000
@NM00081 DC    CL32'205I I/O ERROR WHEN LOADING TEST'                   00630000
M206     DC    AL1(0)                                                   00631000
M207     DC    AL1(0)                                                   00632000
M208     DC    AL1(0)                                                   00633000
M209     DC    AL1(0)                                                   00634000
M210     DC    AL1(48)                                                  00635000
@NM00082 DC    CL48'210I ROUTINE %%%% BYPASSED, MANUAL INTV REQUIRED'   00636000
M210A    DC    AL1(55)                                                  00637000
@NM00083 DC    CL55'210I ROUTINE %%%% BYPASSED, CT OR AP ON SAME LINE AC00638000
               S TT'                                                    00639000
M211     DC    AL1(0)                                                   00640000
M212     DC    AL1(0)                                                   00641000
M213     DC    AL1(0)                                                   00642000
M214     DC    AL1(0)                                                   00643000
M215     DC    AL1(0)                                                   00644000
M216     DC    AL1(0)                                                   00645000
M217     DC    AL1(0)                                                   00646000
M218     DC    AL1(0)                                                   00647000
M219     DC    AL1(0)                                                   00648000
M220     DC    AL1(0)                                                   00649000
M221     DC    AL1(0)                                                   00650000
M222     DC    AL1(0)                                                   00651000
M223     DC    AL1(51)                                                  00652000
@NM00084 DC    CL51'223I RE-ENTER ONLY FIELD IN ERROR. FORMAT IS %%%%%%C00653000
               '                                                        00654000
M224     DC    AL1(0)                                                   00655000
M225     DC    AL1(0)                                                   00656000
M226     DC    AL1(0)                                                   00657000
M227     DC    AL1(41)                                                  00658000
@NM00085 DC    CL41'227I INSUFFICIENT SUPPORT FOR %%%%%%%%-%%'          00659000
M228     DC    AL1(0)                                                   00660000
M229     DC    AL1(48)                                                  00661000
@NM00086 DC    CL48'229I SECTION %%%%%%%% CANCELLED FOR MODE REQUEST'   00662000
M230     DC    AL1(0)                                                   00663000
M231     DC    AL1(32)                                                  00664000
@NM00087 DC    CL32'231I %%%%%%%% CANNOT RUN ON %%%%'                   00665000
M232     DC    AL1(0)                                                   00666000
M233     DC    AL1(0)                                                   00667000
M234     DC    AL1(0)                                                   00668000
M235     DC    AL1(0)                                                   00669000
M236     DC    AL1(0)                                                   00670000
M237     DC    AL1(0)                                                   00671000
M238     DC    AL1(0)                                                   00672000
M239     DC    AL1(0)                                                   00673000
M240     DC    AL1(58)                                                  00674000
@NM00088 DC    CL58'240I CAT/FIRST ERROR COMMUNICATION NOT ALLOWED-/// C00675000
               ASSUMED'                                                 00676000
M241     DC    AL1(0)                                                   00677000
M242     DC    AL1(0)                                                   00678000
M243     DC    AL1(0)                                                   00679000
M244     DC    AL1(0)                                                   00680000
M245     DC    AL1(0)                                                   00681000
M246     DC    AL1(52)                                                  00682000
@NM00089 DC    CL52'246I SECTION %%%%%%%% BYPASSED, REQUIRES REAL MEMORC00683000
               Y'                                                       00684000
M247     DC    AL1(61)                                                  00685000
@NM00090 DC    CL61'247E CAN %%%%%%%% TEST %%%%%%%%%%%%%%%%%%%%%%%%%%%%C00686000
               %%%%%%%%%%'                                              00687000
M247A    DC    AL1(67)                                                  00688000
@NM00091 DC    CL67'247E %%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%C00689000
               %%%%%%%%%%%%%%%%'                                        00690000
M247B    DC    AL1(17)                                                  00691000
@NM00092 DC    CL17'247D REPLY Y OR N'                                  00692000
M248     DC    AL1(0)                                                   00693000
M249     DC    AL1(0)                                                   00694000
M250     DC    AL1(0)                                                   00695000
M251     DC    AL1(38)                                                  00696000
@NM00093 DC    CL38'251I DUPLICATE ENTRIES IN DEVICE FIELD'             00697000
M252     DC    AL1(49)                                                  00698000
@NM00094 DC    CL49'252I CANNOT MIX SYMBOLIC NAMES AND UNIT ADDRESSES'  00699000
M253     DC    AL1(45)                                                  00700000
@NM00095 DC    CL45'253I OLT MODULE %%%%%%%% NOT FOUND IN LIBRARY'      00701000
M254     DC    AL1(36)                                                  00702000
@NM00096 DC    CL36'254I NETWORK OPERATOR DENIED REQUEST'               00703000
M255     DC    AL1(0)                                                   00704000
M256     DC    AL1(0)                                                   00705000
M257     DC    AL1(0)                                                   00706000
M258     DC    AL1(0)                                                   00707000
M259     DC    AL1(0)                                                   00708000
M260     DC    AL1(0)                                                   00709000
M261     DC    AL1(0)                                                   00710000
M262     DC    AL1(0)                                                   00711000
M263     DC    AL1(0)                                                   00712000
M264     DC    AL1(0)                                                   00713000
M265     DC    AL1(0)                                                   00714000
M266     DC    AL1(0)                                                   00715000
M267     DC    AL1(0)                                                   00716000
M268     DC    AL1(0)                                                   00717000
M269     DC    AL1(0)                                                   00718000
M270     DC    AL1(0)                                                   00719000
M271     DC    AL1(0)                                                   00720000
M272     DC    AL1(0)                                                   00721000
M273     DC    AL1(0)                                                   00722000
M274     DC    AL1(0)                                                   00723000
M275     DC    AL1(0)                                                   00724000
M276     DC    AL1(0)                                                   00725000
M277     DC    AL1(0)                                                   00726000
M278     DC    AL1(0)                                                   00727000
M279     DC    AL1(0)                                                   00728000
M280     DC    AL1(0)                                                   00729000
M281     DC    AL1(0)                                                   00730000
M282     DC    AL1(0)                                                   00731000
M283     DC    AL1(0)                                                   00732000
M284     DC    AL1(0)                                                   00733000
M285     DC    AL1(0)                                                   00734000
M286     DC    AL1(0)                                                   00735000
M287     DC    AL1(0)                                                   00736000
M288     DC    AL1(0)                                                   00737000
M289     DC    AL1(0)                                                   00738000
M290     DC    AL1(0)                                                   00739000
M291     DC    AL1(0)                                                   00740000
M292     DC    AL1(0)                                                   00741000
M293     DC    AL1(0)                                                   00742000
M294     DC    AL1(0)                                                   00743000
M295     DC    AL1(0)                                                   00744000
M296     DC    AL1(0)                                                   00745000
M297     DC    AL1(0)                                                   00746000
M298     DC    AL1(0)                                                   00747000
M299     DC    AL1(20)                                                  00748000
@NM00097 DC    CL20'299D INCORRECT REPLY'                               00749000
M300     DC    AL1(0)                                                   00750000
M301     DC    AL1(0)                                                   00751000
M302     DC    AL1(0)                                                   00752000
M303     DC    AL1(0)                                                   00753000
M304     DC    AL1(0)                                                   00754000
M305     DC    AL1(0)                                                   00755000
M306     DC    AL1(0)                                                   00756000
M307     DC    AL1(0)                                                   00757000
M308     DC    AL1(0)                                                   00758000
M309     DC    AL1(0)                                                   00759000
M310     DC    AL1(0)                                                   00760000
M311     DC    AL1(0)                                                   00761000
M312     DC    AL1(0)                                                   00762000
M313     DC    AL1(0)                                                   00763000
M314     DC    AL1(0)                                                   00764000
M315     DC    AL1(0)                                                   00765000
M316     DC    AL1(0)                                                   00766000
M317     DC    AL1(0)                                                   00767000
M318     DC    AL1(0)                                                   00768000
M319     DC    AL1(0)                                                   00769000
M320     DC    AL1(0)                                                   00770000
M321     DC    AL1(0)                                                   00771000
M322     DC    AL1(0)                                                   00772000
M323     DC    AL1(0)                                                   00773000
M324     DC    AL1(0)                                                   00774000
M325     DC    AL1(0)                                                   00775000
M326     DC    AL1(0)                                                   00776000
M327     DC    AL1(64)                                                  00777000
@NM00098 DC    CL64'327I EXT=%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%C00778000
               %%%%% %%%%%%%'                                           00779000
M328     DC    AL1(0)                                                   00780000
M329     DC    AL1(0)                                                   00781000
M330     DC    AL1(0)                                                   00782000
M331     DC    AL1(0)                                                   00783000
M332     DC    AL1(0)                                                   00784000
M333     DC    AL1(0)                                                   00785000
M334     DC    AL1(0)                                                   00786000
M335     DC    AL1(0)                                                   00787000
M336     DC    AL1(0)                                                   00788000
M337     DC    AL1(0)                                                   00789000
M338     DC    AL1(0)                                                   00790000
M339     DC    AL1(0)                                                   00791000
M340     DC    AL1(0)                                                   00792000
M341     DC    AL1(0)                                                   00793000
M342     DC    AL1(0)                                                   00794000
M343     DC    AL1(0)                                                   00795000
M344     DC    AL1(0)                                                   00796000
M345     DC    AL1(0)                                                   00797000
M346     DC    AL1(0)                                                   00798000
M347     DC    AL1(0)                                                   00799000
M348     DC    AL1(0)                                                   00800000
M349     DC    AL1(0)                                                   00801000
M350     DC    AL1(0)                                                   00802000
M351     DC    AL1(0)                                                   00803000
M352     DC    AL1(0)                                                   00804000
M353     DC    AL1(0)                                                   00805000
M354     DC    AL1(0)                                                   00806000
M355     DC    AL1(0)                                                   00807000
M356     DC    AL1(0)                                                   00808000
M357     DC    AL1(0)                                                   00809000
M358     DC    AL1(0)                                                   00810000
M359     DC    AL1(0)                                                   00811000
M360     DC    AL1(0)                                                   00812000
M361     DC    AL1(0)                                                   00813000
M362     DC    AL1(0)                                                   00814000
M363     DC    AL1(0)                                                   00815000
M364     DC    AL1(0)                                                   00816000
M365     DC    AL1(0)                                                   00817000
M366     DC    AL1(0)                                                   00818000
M367     DC    AL1(0)                                                   00819000
M368     DC    AL1(0)                                                   00820000
M369     DC    AL1(0)                                                   00821000
M370     DC    AL1(0)                                                   00822000
M371     DC    AL1(0)                                                   00823000
M372     DC    AL1(0)                                                   00824000
M373     DC    AL1(0)                                                   00825000
M374     DC    AL1(0)                                                   00826000
M375     DC    AL1(0)                                                   00827000
M376     DC    AL1(0)                                                   00828000
M377     DC    AL1(0)                                                   00829000
M378     DC    AL1(0)                                                   00830000
M379     DC    AL1(0)                                                   00831000
M380     DC    AL1(52)                                                  00832000
@NM00099 DC    CL52'380I %%%%%%%% CANNOT BE USED, DOES NOT EXIST TO VTAC00833000
               M'                                                       00834000
M380A    DC    AL1(49)                                                  00835000
@NM00100 DC    CL49'380I %%%%%%%% CANNOT BE USED, VTAM ERROR OCCURRED'  00836000
M380B    DC    AL1(56)                                                  00837000
@NM00101 DC    CL56'380I %%%%%%%% CANNOT BE USED, ALREADY IN USE BY ISTC00838000
               OLTEP'                                                   00839000
M380C    DC    AL1(49)                                                  00840000
@NM00102 DC    CL49'380I %%%%%%%% CANNOT BE USED,A CT IS ON SAME LINE'  00841000
M381     DC    AL1(53)                                                  00842000
@NM00103 DC    CL53'381E THE FOLLOWING DEVICES HAVE NOT YET BEEN ACQUIRC00843000
               ED'                                                      00844000
M381A    DC    AL1(66)                                                  00845000
@NM00104 DC    CL66'381E %%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%C00846000
               %%%%%%%%%%%%%%%'                                         00847000
M381B    DC    AL1(53)                                                  00848000
@NM00105 DC    CL53'381E DO YOU WISH TO CONTINUE WAITING(30 SEC) FOR THC00849000
               EM'                                                      00850000
M381C    DC    AL1(19)                                                  00851000
@NM00106 DC    CL19'381D REPLY Y,N,OR P'                                00852000
M382     DC    AL1(44)                                                  00853000
@NM00107 DC    CL44'382I IO ERROR ON %%%%%%%%. RPL FEEDBACK=%%%%'       00854000
M383     DC    AL1(58)                                                  00855000
@NM00108 DC    CL58'383I %%%DST FAILURE FOR DEVICE %%%%%%%%, RPL FEEDBAC00856000
               CK=%%%%'                                                 00857000
M383A    DC    AL1(58)                                                  00858000
@NM00109 DC    CL58'383I OPNDST FAILURE FOR DEVICE %%%%%%%%, DEVICE IS C00859000
               OFFLINE'                                                 00860000
M384     DC    AL1(0)                                                   00861000
M385     DC    AL1(0)                                                   00862000
M386     DC    AL1(0)                                                   00863000
M387     DC    AL1(0)                                                   00864000
M388     DC    AL1(0)                                                   00865000
M389     DC    AL1(0)                                                   00866000
M390     DC    AL1(0)                                                   00867000
M391     DC    AL1(0)                                                   00868000
M392     DC    AL1(0)                                                   00869000
M393     DC    AL1(0)                                                   00870000
M394     DC    AL1(0)                                                   00871000
M395     DC    AL1(0)                                                   00872000
M396     DC    AL1(0)                                                   00873000
M397     DC    AL1(0)                                                   00874000
M398     DC    AL1(0)                                                   00875000
M399     DC    AL1(0)                                                   00876000
@NM00110 DS    0C                                                       00877000
         ORG   @NM00006+5414                                            00878000
         DS    CL2                                                      00879000
PATCH    DC    10F'0'                                                   00880000
@00      EQU   00                      EQUATES FOR REGISTERS 0-15       00881000
@01      EQU   01                                                       00882000
@02      EQU   02                                                       00883000
@03      EQU   03                                                       00884000
@04      EQU   04                                                       00885000
@05      EQU   05                                                       00886000
@06      EQU   06                                                       00887000
@07      EQU   07                                                       00888000
@08      EQU   08                                                       00889000
@09      EQU   09                                                       00890000
@10      EQU   10                                                       00891000
@11      EQU   11                                                       00892000
@12      EQU   12                                                       00893000
@13      EQU   13                                                       00894000
@14      EQU   14                                                       00895000
@15      EQU   15                                                       00896000
MSG#     EQU   @03                                                      00897000
MSGPTR   EQU   @05                                                      00898000
WAPTR    EQU   @02                                                      00899000
MSGDAT   EQU   0                                                        00900000
TOLTEPWA EQU   0                                                        00901000
$BUFFER  EQU   TOLTEPWA+1976                                            00902000
#EXITA   EQU   TOLTEPWA+2632                                            00903000
$CCOMDAT EQU   TOLTEPWA+2644                                            00904000
$COUTCT  EQU   $CCOMDAT+4                                               00905000
$CFLGS   EQU   $CCOMDAT+16                                              00906000
$24FEMSG EQU   TOLTEPWA+2681                                            00907000
$24CATMG EQU   $24FEMSG+11                                              00908000
@NM00003 EQU   TOLTEPWA+2776                                            00909000
$OUNTPTR EQU   @NM00003+4                                               00910000
$NSPTR   EQU   $OUNTPTR                                                 00911000
$NSCNT   EQU   @NM00003+10                                              00912000
$ENXX    EQU   @NM00003+15                                              00913000
$IMITX   EQU   $ENXX                                                    00914000
SVESC033 EQU   TOLTEPWA+3160                                            00915000
SVECC013 EQU   TOLTEPWA+3232                                            00916000
SVEIC003 EQU   TOLTEPWA+3592                                            00917000
SVESC022 EQU   TOLTEPWA+3736                                            00918000
SVECC011 EQU   TOLTEPWA+4024                                            00919000
#EXIT    EQU   0                                                        00920000
@NM00001 EQU   $BUFFER                                                  00921000
MSGNUM   EQU   @NM00001                                                 00922000
SVECC012 EQU   SVESC022                                                 00923000
SVEIC00A EQU   SVEIC003                                                 00924000
SVEIC004 EQU   SVEIC003                                                 00925000
SVEIC005 EQU   SVEIC003                                                 00926000
SVESC02A EQU   SVESC022                                                 00927000
SVESC02B EQU   SVESC022                                                 00928000
SVESC02D EQU   SVESC022                                                 00929000
SVESC02E EQU   SVESC022                                                 00930000
SVESC02F EQU   SVECC013                                                 00931000
SVESC024 EQU   SVESC022                                                 00932000
SVESC027 EQU   SVESC022                                                 00933000
SVESC029 EQU   SVESC033                                                 00934000
SVESC031 EQU   SVECC013                                                 00935000
SVESC032 EQU   SVECC011                                                 00936000
SVETC037 EQU   SVEIC003                                                 00937000
         AGO   .@UNREFD                START UNREFERENCED COMPONENTS    00938000
SVECC010 EQU   TOLTEPWA+3952                                            00939000
SVETC035 EQU   TOLTEPWA+3880                                            00940000
SVESC030 EQU   TOLTEPWA+3808                                            00941000
SVESC020 EQU   TOLTEPWA+3664                                            00942000
SVEIC002 EQU   TOLTEPWA+3520                                            00943000
SVECC014 EQU   TOLTEPWA+3376                                            00944000
SVESC120 EQU   TOLTEPWA+3304                                            00945000
SVESC025 EQU   TOLTEPWA+3088                                            00946000
@NM00005 EQU   TOLTEPWA+2980                                            00947000
$RPLERR  EQU   TOLTEPWA+2977                                            00948000
@NM00004 EQU   TOLTEPWA+2976                                            00949000
$R13PR3  EQU   TOLTEPWA+2972                                            00950000
$CEINT2  EQU   TOLTEPWA+2968                                            00951000
$CEINT1  EQU   TOLTEPWA+2964                                            00952000
$MSGGET  EQU   TOLTEPWA+2960                                            00953000
$ACQLIST EQU   TOLTEPWA+2956                                            00954000
$R4SAVE1 EQU   TOLTEPWA+2952                                            00955000
$CLSISS  EQU   TOLTEPWA+2950                                            00956000
$CLSCNT  EQU   TOLTEPWA+2948                                            00957000
$CUTABLE EQU   TOLTEPWA+2868                                            00958000
$BUFSZ2  EQU   TOLTEPWA+2864                                            00959000
$RESID2  EQU   TOLTEPWA+2860                                            00960000
$OLTCCW2 EQU   TOLTEPWA+2856                                            00961000
$ENDBFR2 EQU   TOLTEPWA+2852                                            00962000
$1STBFR2 EQU   TOLTEPWA+2848                                            00963000
$TECB2   EQU   TOLTEPWA+2844                                            00964000
$BUFSZ1  EQU   TOLTEPWA+2840                                            00965000
$RESID1  EQU   TOLTEPWA+2836                                            00966000
$OLTCCW1 EQU   TOLTEPWA+2832                                            00967000
$ENDBFR1 EQU   TOLTEPWA+2828                                            00968000
$1STBFR1 EQU   TOLTEPWA+2824                                            00969000
$TECB1   EQU   TOLTEPWA+2820                                            00970000
$WAITIME EQU   TOLTEPWA+2816                                            00971000
$TRTN#   EQU   TOLTEPWA+2815                                            00972000
$WIODEV  EQU   TOLTEPWA+2814                                            00973000
$RQSTSZE EQU   TOLTEPWA+2812                                            00974000
$RQSTPTR EQU   TOLTEPWA+2808                                            00975000
$R4SAVE  EQU   TOLTEPWA+2804                                            00976000
$PARTADR EQU   TOLTEPWA+2800                                            00977000
$TBSDATA EQU   TOLTEPWA+2796                                            00978000
$CTWIDTH EQU   TOLTEPWA+2795                                            00979000
$CTLINE  EQU   TOLTEPWA+2794                                            00980000
$APWIDTH EQU   TOLTEPWA+2793                                            00981000
$APLINE  EQU   TOLTEPWA+2792                                            00982000
$INDEX   EQU   $IMITX                                                   00983000
$UMXX    EQU   @NM00003+14                                              00984000
$NSXX    EQU   @NM00003+12                                              00985000
$ATACNT  EQU   $NSCNT                                                   00986000
$CTR     EQU   @NM00003+8                                               00987000
$ATAPTR  EQU   $NSPTR                                                   00988000
$DDRPTR  EQU   @NM00003                                                 00989000
$DTORESP EQU   TOLTEPWA+2712                                            00990000
$APNAME  EQU   TOLTEPWA+2704                                            00991000
$24SYMNE EQU   $24CATMG+4                                               00992000
$24DEVAD EQU   $24CATMG                                                 00993000
$24RTN#  EQU   $24FEMSG+8                                               00994000
$ESECTID EQU   $24FEMSG                                                 00995000
$24FLGS  EQU   TOLTEPWA+2680                                            00996000
$24SAVE2 EQU   TOLTEPWA+2676                                            00997000
$24SAVE1 EQU   TOLTEPWA+2672                                            00998000
$24UNADR EQU   TOLTEPWA+2668                                            00999000
$24SAV13 EQU   TOLTEPWA+2664                                            01000000
$24RETCD EQU   TOLTEPWA+2663                                            01001000
$MACID   EQU   TOLTEPWA+2661                                            01002000
$CSPARE  EQU   $CFLGS                                                   01003000
$C2WAY   EQU   $CFLGS                                                   01004000
$CINCT   EQU   $CCOMDAT+12                                              01005000
$CINADR  EQU   $CCOMDAT+8                                               01006000
$COUTAD  EQU   $CCOMDAT                                                 01007000
ROOTLOC  EQU   TOLTEPWA+2640                                            01008000
$RETREG  EQU   TOLTEPWA+2636                                            01009000
$WORK    EQU   TOLTEPWA+2376                                            01010000
$EXTA    EQU   TOLTEPWA+2320                                            01011000
$PASSONA EQU   TOLTEPWA+2264                                            01012000
$TRMINPT EQU   TOLTEPWA+2184                                            01013000
$INBUFR  EQU   TOLTEPWA+2104                                            01014000
$TLTRPL3 EQU   TOLTEPWA+1856                                            01015000
$TLTRPL2 EQU   TOLTEPWA+1736                                            01016000
$TLTRPL1 EQU   TOLTEPWA+1616                                            01017000
$SLTBL   EQU   TOLTEPWA+1468                                            01018000
@NM00002 EQU   TOLTEPWA+1464                                            01019000
$DEVTBLE EQU   TOLTEPWA+240                                             01020000
$COMMFLG EQU   TOLTEPWA+224                                             01021000
$CDA     EQU   TOLTEPWA+100                                             01022000
$SCTTBLE EQU   TOLTEPWA                                                 01023000
.@UNREFD ANOP                          END UNREFERENCED COMPONENTS      01024000
@ENDDATA EQU   *                                                        01025000
         END   ISTEC123,(C'PLS2142',0702,79038)                         01026000
./  ADD  SSI=83351644,NAME=ISTEC456
         TITLE 'ISTEC456 - MESSAGE MODULE #2'                           00001000
ISTEC456 CSECT ,                                                   0001 00002000
@MAINENT DS    0H                                                  0001 00003000
         USING *,@15                                               0001 00004000
         B     @PROLOG                                             0001 00005000
         DC    AL1(16)                                             0001 00006000
         DC    C'ISTEC456  78.336'                                 0001 00007000
         DROP  @15                                                      00008000
@PROLOG  STM   @14,@12,12(@13)                                     0001 00009000
         BALR  @11,0                                               0001 00010000
@PSTART  DS    0H                                                  0001 00011000
         USING @PSTART,@11                                         0001 00012000
         SPACE                                                          00013000
*                                                                  0026 00014000
*/********************************************************************/ 00015000
*/* LOCATE MESSAGE IN TABLE                                          */ 00016000
*/********************************************************************/ 00017000
*                                                                  0027 00018000
*   MSG#=MSGNUM-399;                /* GET MSG NUMBER                */ 00019000
         L     MSG#,MSGNUM(,WAPTR)                                 0027 00020000
         SL    MSG#,@CF00997                                       0027 00021000
*   IF MSG#<101                     /* IS MSG NUMBER 400-499         */ 00022000
*     THEN                                                         0028 00023000
         C     MSG#,@CF00998                                       0028 00024000
         BNL   @RF00028                                            0028 00025000
*     MSGPTR=MSGTBL1(MSG#)+ADDR(MESSAGES);/* GET PTR TO MSG          */ 00026000
         LR    @12,MSG#                                            0029 00027000
         ALR   @12,@12                                             0029 00028000
         LA    MSGPTR,MESSAGES                                     0029 00029000
         AH    MSGPTR,MSGTBL1-2(@12)                               0029 00030000
*   ELSE                                                           0030 00031000
*     DO;                                                          0030 00032000
         B     @RC00028                                            0030 00033000
@RF00028 DS    0H                                                  0031 00034000
*       MSG#=MSGNUM-499;                                           0031 00035000
         L     MSG#,MSGNUM(,WAPTR)                                 0031 00036000
         SL    MSG#,@CF00999                                       0031 00037000
*       IF MSG#<101                 /* IS MSG NUMBER 500-599         */ 00038000
*         THEN                                                     0032 00039000
         C     MSG#,@CF00998                                       0032 00040000
         BNL   @RF00032                                            0032 00041000
*         MSGPTR=MSGTBL2(MSG#)+ADDR(MESSAGES);/* GET PTR TO MSG      */ 00042000
         LR    @12,MSG#                                            0033 00043000
         ALR   @12,@12                                             0033 00044000
         LA    MSGPTR,MESSAGES                                     0033 00045000
         AH    MSGPTR,MSGTBL2-2(@12)                               0033 00046000
*       ELSE                                                       0034 00047000
*         DO;                                                      0034 00048000
         B     @RC00032                                            0034 00049000
@RF00032 DS    0H                                                  0035 00050000
*           MSG#=MSGNUM-599;        /* MSG NUMBER IS 600-699         */ 00051000
         L     MSG#,MSGNUM(,WAPTR)                                 0035 00052000
         SL    MSG#,@CF01000                                       0035 00053000
*           MSGPTR=MSGTBL3(MSG#)+ADDR(MESSAGES);/* GET PTR TO MSG    */ 00054000
         LR    @12,MSG#                                            0036 00055000
         ALR   @12,@12                                             0036 00056000
         LA    MSGPTR,MESSAGES                                     0036 00057000
         AH    MSGPTR,MSGTBL3-2(@12)                               0036 00058000
*         END;                                                     0037 00059000
*     END;                                                         0038 00060000
*                                                                  0038 00061000
@RC00032 DS    0H                                                  0039 00062000
*/********************************************************************/ 00063000
*/* SEND MESSAGE INFORMATION BACK TO CALLER                          */ 00064000
*/********************************************************************/ 00065000
*                                                                  0039 00066000
*   $COUTCT(4:4)=MSGDAT;            /* GET MSG LENGTH                */ 00067000
@RC00028 MVC   $COUTCT+3(1,WAPTR),MSGDAT(MSGPTR)                   0039 00068000
*   MSGPTR=MSGPTR+1;                /* SET PTR TO START OF MSG       */ 00069000
         AL    MSGPTR,@CF00044                                     0040 00070000
*   MSGNUM=MSGPTR;                  /* SAVE MSG TEXT PTR             */ 00071000
         ST    MSGPTR,MSGNUM(,WAPTR)                               0041 00072000
*   DO;                             /* ATDSPLY                       */ 00073000
*   END;                            /* ATDSPLY                       */ 00074000
*   END;                                                           0044 00075000
@EL00001 DS    0H                                                  0044 00076000
@EF00001 DS    0H                                                  0044 00077000
@ER00001 LM    @14,@12,12(@13)                                     0044 00078000
         BR    @14                                                 0044 00079000
@DATA    DS    0H                                                       00080000
         DS    0F                                                       00081000
         DS    0F                                                       00082000
@CF00044 DC    F'1'                                                     00083000
@CF00998 DC    F'101'                                                   00084000
@CF00997 DC    F'399'                                                   00085000
@CF00999 DC    F'499'                                                   00086000
@CF01000 DC    F'599'                                                   00087000
         DS    0D                                                       00088000
@NM00006 DS    CL4557                                                   00089000
         ORG   @NM00006                                                 00090000
MSGTBL1  DC    AL2(M400-MESSAGES)                                       00091000
         DC    AL2(M401-MESSAGES)                                       00092000
         DC    AL2(M402-MESSAGES)                                       00093000
         DC    AL2(M403-MESSAGES)                                       00094000
         DC    AL2(M404-MESSAGES)                                       00095000
         DC    AL2(M405-MESSAGES)                                       00096000
         DC    AL2(M406-MESSAGES)                                       00097000
         DC    AL2(M407-MESSAGES)                                       00098000
         DC    AL2(M408-MESSAGES)                                       00099000
         DC    AL2(M409-MESSAGES)                                       00100000
         DC    AL2(M410-MESSAGES)                                       00101000
         DC    AL2(M411-MESSAGES)                                       00102000
         DC    AL2(M412-MESSAGES)                                       00103000
         DC    AL2(M413-MESSAGES)                                       00104000
         DC    AL2(M414-MESSAGES)                                       00105000
         DC    AL2(M415-MESSAGES)                                       00106000
         DC    AL2(M416-MESSAGES)                                       00107000
         DC    AL2(M417-MESSAGES)                                       00108000
         DC    AL2(M418-MESSAGES)                                       00109000
         DC    AL2(M419-MESSAGES)                                       00110000
         DC    AL2(M420-MESSAGES)                                       00111000
         DC    AL2(M421-MESSAGES)                                       00112000
         DC    AL2(M422-MESSAGES)                                       00113000
         DC    AL2(M423-MESSAGES)                                       00114000
         DC    AL2(M424-MESSAGES)                                       00115000
         DC    AL2(M425-MESSAGES)                                       00116000
         DC    AL2(M426-MESSAGES)                                       00117000
         DC    AL2(M427-MESSAGES)                                       00118000
         DC    AL2(M428-MESSAGES)                                       00119000
         DC    AL2(M429-MESSAGES)                                       00120000
         DC    AL2(M430-MESSAGES)                                       00121000
         DC    AL2(M431-MESSAGES)                                       00122000
         DC    AL2(M432-MESSAGES)                                       00123000
         DC    AL2(M433-MESSAGES)                                       00124000
         DC    AL2(M434-MESSAGES)                                       00125000
         DC    AL2(M435-MESSAGES)                                       00126000
         DC    AL2(M436-MESSAGES)                                       00127000
         DC    AL2(M437-MESSAGES)                                       00128000
         DC    AL2(M438-MESSAGES)                                       00129000
         DC    AL2(M439-MESSAGES)                                       00130000
         DC    AL2(M440-MESSAGES)                                       00131000
         DC    AL2(M441-MESSAGES)                                       00132000
         DC    AL2(M442-MESSAGES)                                       00133000
         DC    AL2(M443-MESSAGES)                                       00134000
         DC    AL2(M444-MESSAGES)                                       00135000
         DC    AL2(M445-MESSAGES)                                       00136000
         DC    AL2(M446-MESSAGES)                                       00137000
         DC    AL2(M447-MESSAGES)                                       00138000
         DC    AL2(M448-MESSAGES)                                       00139000
         DC    AL2(M449-MESSAGES)                                       00140000
         DC    AL2(M450-MESSAGES)                                       00141000
         DC    AL2(M451-MESSAGES)                                       00142000
         DC    AL2(M452-MESSAGES)                                       00143000
         DC    AL2(M453-MESSAGES)                                       00144000
         DC    AL2(M454-MESSAGES)                                       00145000
         DC    AL2(M455-MESSAGES)                                       00146000
         DC    AL2(M456-MESSAGES)                                       00147000
         DC    AL2(M457-MESSAGES)                                       00148000
         DC    AL2(M458-MESSAGES)                                       00149000
         DC    AL2(M459-MESSAGES)                                       00150000
         DC    AL2(M460-MESSAGES)                                       00151000
         DC    AL2(M461-MESSAGES)                                       00152000
         DC    AL2(M462-MESSAGES)                                       00153000
         DC    AL2(M463-MESSAGES)                                       00154000
         DC    AL2(M464-MESSAGES)                                       00155000
         DC    AL2(M465-MESSAGES)                                       00156000
         DC    AL2(M466-MESSAGES)                                       00157000
         DC    AL2(M467-MESSAGES)                                       00158000
         DC    AL2(M468-MESSAGES)                                       00159000
         DC    AL2(M469-MESSAGES)                                       00160000
         DC    AL2(M470-MESSAGES)                                       00161000
         DC    AL2(M471-MESSAGES)                                       00162000
         DC    AL2(M472-MESSAGES)                                       00163000
         DC    AL2(M473-MESSAGES)                                       00164000
         DC    AL2(M474-MESSAGES)                                       00165000
         DC    AL2(M475-MESSAGES)                                       00166000
         DC    AL2(M476-MESSAGES)                                       00167000
         DC    AL2(M477-MESSAGES)                                       00168000
         DC    AL2(M478-MESSAGES)                                       00169000
         DC    AL2(M479-MESSAGES)                                       00170000
         DC    AL2(M480-MESSAGES)                                       00171000
         DC    AL2(M481-MESSAGES)                                       00172000
         DC    AL2(M482-MESSAGES)                                       00173000
         DC    AL2(M483-MESSAGES)                                       00174000
         DC    AL2(M484-MESSAGES)                                       00175000
         DC    AL2(M485-MESSAGES)                                       00176000
         DC    AL2(M486-MESSAGES)                                       00177000
         DC    AL2(M487-MESSAGES)                                       00178000
         DC    AL2(M488-MESSAGES)                                       00179000
         DC    AL2(M489-MESSAGES)                                       00180000
         DC    AL2(M490-MESSAGES)                                       00181000
         DC    AL2(M491-MESSAGES)                                       00182000
         DC    AL2(M492-MESSAGES)                                       00183000
         DC    AL2(M493-MESSAGES)                                       00184000
         DC    AL2(M494-MESSAGES)                                       00185000
         DC    AL2(M495-MESSAGES)                                       00186000
         DC    AL2(M496-MESSAGES)                                       00187000
         DC    AL2(M497-MESSAGES)                                       00188000
         DC    AL2(M498-MESSAGES)                                       00189000
         DC    AL2(M499-MESSAGES)                                       00190000
MSGTBL2  DC    AL2(M500-MESSAGES)                                       00191000
         DC    AL2(M501-MESSAGES)                                       00192000
         DC    AL2(M502-MESSAGES)                                       00193000
         DC    AL2(M503-MESSAGES)                                       00194000
         DC    AL2(M504-MESSAGES)                                       00195000
         DC    AL2(M505-MESSAGES)                                       00196000
         DC    AL2(M506-MESSAGES)                                       00197000
         DC    AL2(M507-MESSAGES)                                       00198000
         DC    AL2(M508-MESSAGES)                                       00199000
         DC    AL2(M509-MESSAGES)                                       00200000
         DC    AL2(M510-MESSAGES)                                       00201000
         DC    AL2(M511-MESSAGES)                                       00202000
         DC    AL2(M512-MESSAGES)                                       00203000
         DC    AL2(M513-MESSAGES)                                       00204000
         DC    AL2(M514-MESSAGES)                                       00205000
         DC    AL2(M515-MESSAGES)                                       00206000
         DC    AL2(M516-MESSAGES)                                       00207000
         DC    AL2(M517-MESSAGES)                                       00208000
         DC    AL2(M518-MESSAGES)                                       00209000
         DC    AL2(M519-MESSAGES)                                       00210000
         DC    AL2(M520-MESSAGES)                                       00211000
         DC    AL2(M521-MESSAGES)                                       00212000
         DC    AL2(M522-MESSAGES)                                       00213000
         DC    AL2(M523-MESSAGES)                                       00214000
         DC    AL2(M524-MESSAGES)                                       00215000
         DC    AL2(M525-MESSAGES)                                       00216000
         DC    AL2(M526-MESSAGES)                                       00217000
         DC    AL2(M527-MESSAGES)                                       00218000
         DC    AL2(M528-MESSAGES)                                       00219000
         DC    AL2(M529-MESSAGES)                                       00220000
         DC    AL2(M530-MESSAGES)                                       00221000
         DC    AL2(M531-MESSAGES)                                       00222000
         DC    AL2(M532-MESSAGES)                                       00223000
         DC    AL2(M533-MESSAGES)                                       00224000
         DC    AL2(M534-MESSAGES)                                       00225000
         DC    AL2(M535-MESSAGES)                                       00226000
         DC    AL2(M536-MESSAGES)                                       00227000
         DC    AL2(M537-MESSAGES)                                       00228000
         DC    AL2(M538-MESSAGES)                                       00229000
         DC    AL2(M539-MESSAGES)                                       00230000
         DC    AL2(M540-MESSAGES)                                       00231000
         DC    AL2(M541-MESSAGES)                                       00232000
         DC    AL2(M542-MESSAGES)                                       00233000
         DC    AL2(M543-MESSAGES)                                       00234000
         DC    AL2(M544-MESSAGES)                                       00235000
         DC    AL2(M545-MESSAGES)                                       00236000
         DC    AL2(M546-MESSAGES)                                       00237000
         DC    AL2(M547-MESSAGES)                                       00238000
         DC    AL2(M548-MESSAGES)                                       00239000
         DC    AL2(M549-MESSAGES)                                       00240000
         DC    AL2(M550-MESSAGES)                                       00241000
         DC    AL2(M551-MESSAGES)                                       00242000
         DC    AL2(M552-MESSAGES)                                       00243000
         DC    AL2(M553-MESSAGES)                                       00244000
         DC    AL2(M554-MESSAGES)                                       00245000
         DC    AL2(M555-MESSAGES)                                       00246000
         DC    AL2(M556-MESSAGES)                                       00247000
         DC    AL2(M557-MESSAGES)                                       00248000
         DC    AL2(M558-MESSAGES)                                       00249000
         DC    AL2(M559-MESSAGES)                                       00250000
         DC    AL2(M560-MESSAGES)                                       00251000
         DC    AL2(M561-MESSAGES)                                       00252000
         DC    AL2(M562-MESSAGES)                                       00253000
         DC    AL2(M563-MESSAGES)                                       00254000
         DC    AL2(M564-MESSAGES)                                       00255000
         DC    AL2(M565-MESSAGES)                                       00256000
         DC    AL2(M566-MESSAGES)                                       00257000
         DC    AL2(M567-MESSAGES)                                       00258000
         DC    AL2(M568-MESSAGES)                                       00259000
         DC    AL2(M569-MESSAGES)                                       00260000
         DC    AL2(M570-MESSAGES)                                       00261000
         DC    AL2(M571-MESSAGES)                                       00262000
         DC    AL2(M572-MESSAGES)                                       00263000
         DC    AL2(M573-MESSAGES)                                       00264000
         DC    AL2(M574-MESSAGES)                                       00265000
         DC    AL2(M575-MESSAGES)                                       00266000
         DC    AL2(M576-MESSAGES)                                       00267000
         DC    AL2(M577-MESSAGES)                                       00268000
         DC    AL2(M578-MESSAGES)                                       00269000
         DC    AL2(M579-MESSAGES)                                       00270000
         DC    AL2(M580-MESSAGES)                                       00271000
         DC    AL2(M581-MESSAGES)                                       00272000
         DC    AL2(M582-MESSAGES)                                       00273000
         DC    AL2(M583-MESSAGES)                                       00274000
         DC    AL2(M584-MESSAGES)                                       00275000
         DC    AL2(M585-MESSAGES)                                       00276000
         DC    AL2(M586-MESSAGES)                                       00277000
         DC    AL2(M587-MESSAGES)                                       00278000
         DC    AL2(M588-MESSAGES)                                       00279000
         DC    AL2(M589-MESSAGES)                                       00280000
         DC    AL2(M590-MESSAGES)                                       00281000
         DC    AL2(M591-MESSAGES)                                       00282000
         DC    AL2(M592-MESSAGES)                                       00283000
         DC    AL2(M593-MESSAGES)                                       00284000
         DC    AL2(M594-MESSAGES)                                       00285000
         DC    AL2(M595-MESSAGES)                                       00286000
         DC    AL2(M596-MESSAGES)                                       00287000
         DC    AL2(M597-MESSAGES)                                       00288000
         DC    AL2(M598-MESSAGES)                                       00289000
         DC    AL2(M599-MESSAGES)                                       00290000
MSGTBL3  DC    AL2(M600-MESSAGES)                                       00291000
         DC    AL2(M601-MESSAGES)                                       00292000
         DC    AL2(M602-MESSAGES)                                       00293000
         DC    AL2(M603-MESSAGES)                                       00294000
         DC    AL2(M604-MESSAGES)                                       00295000
         DC    AL2(M605-MESSAGES)                                       00296000
         DC    AL2(M606-MESSAGES)                                       00297000
         DC    AL2(M607-MESSAGES)                                       00298000
         DC    AL2(M608-MESSAGES)                                       00299000
         DC    AL2(M609-MESSAGES)                                       00300000
         DC    AL2(M610-MESSAGES)                                       00301000
         DC    AL2(M611-MESSAGES)                                       00302000
         DC    AL2(M612-MESSAGES)                                       00303000
         DC    AL2(M613-MESSAGES)                                       00304000
         DC    AL2(M614-MESSAGES)                                       00305000
         DC    AL2(M615-MESSAGES)                                       00306000
         DC    AL2(M616-MESSAGES)                                       00307000
         DC    AL2(M617-MESSAGES)                                       00308000
         DC    AL2(M618-MESSAGES)                                       00309000
         DC    AL2(M619-MESSAGES)                                       00310000
         DC    AL2(M620-MESSAGES)                                       00311000
         DC    AL2(M621-MESSAGES)                                       00312000
         DC    AL2(M622-MESSAGES)                                       00313000
         DC    AL2(M623-MESSAGES)                                       00314000
         DC    AL2(M624-MESSAGES)                                       00315000
         DC    AL2(M625-MESSAGES)                                       00316000
         DC    AL2(M626-MESSAGES)                                       00317000
         DC    AL2(M627-MESSAGES)                                       00318000
         DC    AL2(M628-MESSAGES)                                       00319000
         DC    AL2(M629-MESSAGES)                                       00320000
         DC    AL2(M630-MESSAGES)                                       00321000
         DC    AL2(M631-MESSAGES)                                       00322000
         DC    AL2(M632-MESSAGES)                                       00323000
         DC    AL2(M633-MESSAGES)                                       00324000
         DC    AL2(M634-MESSAGES)                                       00325000
         DC    AL2(M635-MESSAGES)                                       00326000
         DC    AL2(M636-MESSAGES)                                       00327000
         DC    AL2(M637-MESSAGES)                                       00328000
         DC    AL2(M638-MESSAGES)                                       00329000
         DC    AL2(M639-MESSAGES)                                       00330000
         DC    AL2(M640-MESSAGES)                                       00331000
         DC    AL2(M641-MESSAGES)                                       00332000
         DC    AL2(M642-MESSAGES)                                       00333000
         DC    AL2(M643-MESSAGES)                                       00334000
         DC    AL2(M644-MESSAGES)                                       00335000
         DC    AL2(M645-MESSAGES)                                       00336000
         DC    AL2(M646-MESSAGES)                                       00337000
         DC    AL2(M647-MESSAGES)                                       00338000
         DC    AL2(M648-MESSAGES)                                       00339000
         DC    AL2(M649-MESSAGES)                                       00340000
         DC    AL2(M650-MESSAGES)                                       00341000
         DC    AL2(M651-MESSAGES)                                       00342000
         DC    AL2(M652-MESSAGES)                                       00343000
         DC    AL2(M653-MESSAGES)                                       00344000
         DC    AL2(M654-MESSAGES)                                       00345000
         DC    AL2(M655-MESSAGES)                                       00346000
         DC    AL2(M656-MESSAGES)                                       00347000
         DC    AL2(M657-MESSAGES)                                       00348000
         DC    AL2(M658-MESSAGES)                                       00349000
         DC    AL2(M659-MESSAGES)                                       00350000
         DC    AL2(M660-MESSAGES)                                       00351000
         DC    AL2(M661-MESSAGES)                                       00352000
         DC    AL2(M662-MESSAGES)                                       00353000
         DC    AL2(M663-MESSAGES)                                       00354000
         DC    AL2(M664-MESSAGES)                                       00355000
         DC    AL2(M665-MESSAGES)                                       00356000
         DC    AL2(M666-MESSAGES)                                       00357000
         DC    AL2(M667-MESSAGES)                                       00358000
         DC    AL2(M668-MESSAGES)                                       00359000
         DC    AL2(M669-MESSAGES)                                       00360000
         DC    AL2(M670-MESSAGES)                                       00361000
         DC    AL2(M671-MESSAGES)                                       00362000
         DC    AL2(M672-MESSAGES)                                       00363000
         DC    AL2(M673-MESSAGES)                                       00364000
         DC    AL2(M674-MESSAGES)                                       00365000
         DC    AL2(M675-MESSAGES)                                       00366000
         DC    AL2(M676-MESSAGES)                                       00367000
         DC    AL2(M677-MESSAGES)                                       00368000
         DC    AL2(M678-MESSAGES)                                       00369000
         DC    AL2(M679-MESSAGES)                                       00370000
         DC    AL2(M680-MESSAGES)                                       00371000
         DC    AL2(M681-MESSAGES)                                       00372000
         DC    AL2(M682-MESSAGES)                                       00373000
         DC    AL2(M683-MESSAGES)                                       00374000
         DC    AL2(M684-MESSAGES)                                       00375000
         DC    AL2(M685-MESSAGES)                                       00376000
         DC    AL2(M686-MESSAGES)                                       00377000
         DC    AL2(M687-MESSAGES)                                       00378000
         DC    AL2(M688-MESSAGES)                                       00379000
         DC    AL2(M689-MESSAGES)                                       00380000
         DC    AL2(M690-MESSAGES)                                       00381000
         DC    AL2(M691-MESSAGES)                                       00382000
         DC    AL2(M692-MESSAGES)                                       00383000
         DC    AL2(M693-MESSAGES)                                       00384000
         DC    AL2(M694-MESSAGES)                                       00385000
         DC    AL2(M695-MESSAGES)                                       00386000
         DC    AL2(M696-MESSAGES)                                       00387000
         DC    AL2(M697-MESSAGES)                                       00388000
         DC    AL2(M698-MESSAGES)                                       00389000
         DC    AL2(M699-MESSAGES)                                       00390000
MESSAGES DS    CL3957                                                   00391000
         ORG   MESSAGES                                                 00392000
M400     DC    AL1(0)                                                   00393000
M401     DC    AL1(0)                                                   00394000
M402     DC    AL1(0)                                                   00395000
M403     DC    AL1(0)                                                   00396000
M404     DC    AL1(0)                                                   00397000
M405     DC    AL1(0)                                                   00398000
M406     DC    AL1(0)                                                   00399000
M407     DC    AL1(0)                                                   00400000
M408     DC    AL1(0)                                                   00401000
M409     DC    AL1(0)                                                   00402000
M410     DC    AL1(0)                                                   00403000
M411     DC    AL1(0)                                                   00404000
M412     DC    AL1(0)                                                   00405000
M413     DC    AL1(0)                                                   00406000
M414     DC    AL1(0)                                                   00407000
M415     DC    AL1(0)                                                   00408000
M416     DC    AL1(0)                                                   00409000
M417     DC    AL1(0)                                                   00410000
M418     DC    AL1(0)                                                   00411000
M419     DC    AL1(0)                                                   00412000
M420     DC    AL1(0)                                                   00413000
M421     DC    AL1(0)                                                   00414000
M422     DC    AL1(0)                                                   00415000
M423     DC    AL1(0)                                                   00416000
M424     DC    AL1(0)                                                   00417000
M425     DC    AL1(0)                                                   00418000
M426     DC    AL1(0)                                                   00419000
M427     DC    AL1(0)                                                   00420000
M428     DC    AL1(0)                                                   00421000
M429     DC    AL1(0)                                                   00422000
M430     DC    AL1(0)                                                   00423000
M431     DC    AL1(0)                                                   00424000
M432     DC    AL1(0)                                                   00425000
M433     DC    AL1(0)                                                   00426000
M434     DC    AL1(0)                                                   00427000
M435     DC    AL1(0)                                                   00428000
M436     DC    AL1(0)                                                   00429000
M437     DC    AL1(0)                                                   00430000
M438     DC    AL1(0)                                                   00431000
M439     DC    AL1(0)                                                   00432000
M440     DC    AL1(0)                                                   00433000
M441     DC    AL1(0)                                                   00434000
M442     DC    AL1(0)                                                   00435000
M443     DC    AL1(0)                                                   00436000
M444     DC    AL1(0)                                                   00437000
M445     DC    AL1(0)                                                   00438000
M446     DC    AL1(0)                                                   00439000
M447     DC    AL1(0)                                                   00440000
M448     DC    AL1(0)                                                   00441000
M449     DC    AL1(0)                                                   00442000
M450     DC    AL1(37)                                                  00443000
@NM00007 DC    CL37'450I %RTN %%%,ID %%,AT %%%%%%%%%%%%%%'              00444000
M451     DC    AL1(0)                                                   00445000
M452     DC    AL1(0)                                                   00446000
M453     DC    AL1(0)                                                   00447000
M454     DC    AL1(0)                                                   00448000
M455     DC    AL1(0)                                                   00449000
M456     DC    AL1(0)                                                   00450000
M457     DC    AL1(0)                                                   00451000
M458     DC    AL1(0)                                                   00452000
M459     DC    AL1(0)                                                   00453000
M460     DC    AL1(52)                                                  00454000
@NM00008 DC    CL52'460I CTRL CANNOT BE SHIFTED. YOUR TERMINAL LOGGED OC00455000
               N'                                                       00456000
M460A    DC    AL1(44)                                                  00457000
@NM00009 DC    CL44'460I CTRL CANNOT BE SHIFTED. %%%%%%%% IN USE'       00458000
M460B    DC    AL1(55)                                                  00459000
@NM00010 DC    CL55'460I CTRL CANNOT BE SHIFTED. %%%%%%%% WRONG TYPE DEC00460000
               VICE'                                                    00461000
M460C    DC    AL1(56)                                                  00462000
@NM00011 DC    CL56'460I CTRL CANNOT BE SHIFTED. %%%%%%%% UNKNOWN TO SYC00463000
               STEM '                                                   00464000
M461     DC    AL1(41)                                                  00465000
@NM00012 DC    CL41'461I CTRL SHIFTED BY %%%%%%%% TO %%%%%%%%'          00466000
M462     DC    AL1(53)                                                  00467000
@NM00013 DC    CL53'462D CAN %%%%%%%% SHIFT CONTROL TO %%%%%%%%.REPLY YC00468000
               /N'                                                      00469000
M463     DC    AL1(36)                                                  00470000
@NM00014 DC    CL36'463I OPERATORS REPLY TO ITA%%%D WAS:'               00471000
M463A    DC    AL1(66)                                                  00472000
@NM00015 DC    CL66'463I %%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%C00473000
               %%%%%%%%%%%%%%%'                                         00474000
M464     DC    AL1(62)                                                  00475000
@NM00016 DC    CL62'464I %%%%%% FIELD HAD ERROR. CORRECT FIELD OR ENTERC00476000
                /// TO RUN'                                             00477000
M465     DC    AL1(34)                                                  00478000
@NM00017 DC    CL34'465I CANNOT TEST ALTERNATE PRINTER'                 00479000
M466     DC    AL1(54)                                                  00480000
@NM00018 DC    CL54'466I VARY IN PROGRESS. SECTION ENDING,DEVICES RELEAC00481000
               SED'                                                     00482000
M467     DC    AL1(0)                                                   00483000
M468     DC    AL1(0)                                                   00484000
M469     DC    AL1(0)                                                   00485000
M470     DC    AL1(0)                                                   00486000
M471     DC    AL1(0)                                                   00487000
M472     DC    AL1(0)                                                   00488000
M473     DC    AL1(0)                                                   00489000
M474     DC    AL1(0)                                                   00490000
M475     DC    AL1(0)                                                   00491000
M476     DC    AL1(0)                                                   00492000
M477     DC    AL1(0)                                                   00493000
M478     DC    AL1(0)                                                   00494000
M479     DC    AL1(0)                                                   00495000
M480     DC    AL1(0)                                                   00496000
M481     DC    AL1(0)                                                   00497000
M482     DC    AL1(0)                                                   00498000
M483     DC    AL1(0)                                                   00499000
M484     DC    AL1(0)                                                   00500000
M485     DC    AL1(0)                                                   00501000
M486     DC    AL1(0)                                                   00502000
M487     DC    AL1(0)                                                   00503000
M488     DC    AL1(0)                                                   00504000
M489     DC    AL1(0)                                                   00505000
M490     DC    AL1(0)                                                   00506000
M491     DC    AL1(0)                                                   00507000
M492     DC    AL1(0)                                                   00508000
M493     DC    AL1(0)                                                   00509000
M494     DC    AL1(0)                                                   00510000
M495     DC    AL1(0)                                                   00511000
M496     DC    AL1(0)                                                   00512000
M497     DC    AL1(0)                                                   00513000
M498     DC    AL1(0)                                                   00514000
M499     DC    AL1(0)                                                   00515000
M500     DC    AL1(0)                                                   00516000
M501     DC    AL1(0)                                                   00517000
M502     DC    AL1(0)                                                   00518000
M503     DC    AL1(0)                                                   00519000
M504     DC    AL1(0)                                                   00520000
M505     DC    AL1(0)                                                   00521000
M506     DC    AL1(0)                                                   00522000
M507     DC    AL1(0)                                                   00523000
M508     DC    AL1(0)                                                   00524000
M509     DC    AL1(0)                                                   00525000
M510     DC    AL1(0)                                                   00526000
M511     DC    AL1(0)                                                   00527000
M512     DC    AL1(0)                                                   00528000
M513     DC    AL1(0)                                                   00529000
M514     DC    AL1(0)                                                   00530000
M515     DC    AL1(0)                                                   00531000
M516     DC    AL1(0)                                                   00532000
M517     DC    AL1(0)                                                   00533000
M518     DC    AL1(0)                                                   00534000
M519     DC    AL1(0)                                                   00535000
M520     DC    AL1(0)                                                   00536000
M521     DC    AL1(0)                                                   00537000
M522     DC    AL1(0)                                                   00538000
M523     DC    AL1(0)                                                   00539000
M524     DC    AL1(0)                                                   00540000
M525     DC    AL1(0)                                                   00541000
M526     DC    AL1(0)                                                   00542000
M527     DC    AL1(0)                                                   00543000
M528     DC    AL1(0)                                                   00544000
M529     DC    AL1(0)                                                   00545000
M530     DC    AL1(0)                                                   00546000
M531     DC    AL1(0)                                                   00547000
M532     DC    AL1(0)                                                   00548000
M533     DC    AL1(0)                                                   00549000
M534     DC    AL1(0)                                                   00550000
M535     DC    AL1(0)                                                   00551000
M536     DC    AL1(0)                                                   00552000
M537     DC    AL1(0)                                                   00553000
M538     DC    AL1(0)                                                   00554000
M539     DC    AL1(57)                                                  00555000
@NM00019 DC    CL57'539D DO YOU WISH TO WAIT FOR CUTEST DEVICES. REPLY C00556000
               Y OR N'                                                  00557000
M540     DC    AL1(19)                                                  00558000
@NM00020 DC    CL19'540I ABEND OCCURRED'                                00559000
M540A    DC    AL1(26)                                                  00560000
@NM00021 DC    CL26'540I  AREA   START     END'                         00561000
M540B    DC    AL1(29)                                                  00562000
@NM00022 DC    CL29'540I RCA    %%%%%%%% %%%%%%%%'                      00563000
M540C    DC    AL1(29)                                                  00564000
@NM00023 DC    CL29'540I TOLTEP %%%%%%%% %%%%%%%%'                      00565000
M540D    DC    AL1(29)                                                  00566000
@NM00024 DC    CL29'540I OLT    %%%%%%%% %%%%%%%%'                      00567000
M540E    DC    AL1(29)                                                  00568000
@NM00025 DC    CL29'540I TWA    %%%%%%%% %%%%%%%%'                      00569000
M540F    DC    AL1(27)                                                  00570000
@NM00026 DC    CL27'540I PSW= %%%%%%%%%%%%%%%%%'                        00571000
M540G    DC    AL1(47)                                                  00572000
@NM00027 DC    CL47'540I GR %-% %%%%%%%% %%%%%%%% %%%%%%%% %%%%%%%%'    00573000
M541     DC    AL1(42)                                                  00574000
@NM00028 DC    CL42'541D ENTER DUMP REQUEST OR P FOR PROMPTING'         00575000
M542     DC    AL1(18)                                                  00576000
@NM00029 DC    CL18'542I INPUT--RESULT'                                 00577000
M542A    DC    AL1(36)                                                  00578000
@NM00030 DC    CL36'542I    R   ALL RESIDENT COMMON AREA'               00579000
M542B    DC    AL1(24)                                                  00580000
@NM00031 DC    CL24'542I    T   ALL ISTOLTEP'                           00581000
M542C    DC    AL1(30)                                                  00582000
@NM00032 DC    CL30'542I    W   ALL TEST WORK AREA'                     00583000
M542D    DC    AL1(24)                                                  00584000
@NM00033 DC    CL24'542I    O   ALL OLT AREA'                           00585000
M542E    DC    AL1(44)                                                  00586000
@NM00034 DC    CL44'542I    D XXXXXXXX-YYYYYYYY DISPLAY X THRU Y'       00587000
M542F    DC    AL1(33)                                                  00588000
@NM00035 DC    CL33'542I CANCEL   END DUMP PROCESSING'                  00589000
M543     DC    AL1(31)                                                  00590000
@NM00036 DC    CL31'543I INCORRECT ADDRESS SELECTED'                    00591000
M544     DC    AL1(20)                                                  00592000
@NM00037 DC    CL20'544I DUMP TERMINATED'                               00593000
M545     DC    AL1(25)                                                  00594000
@NM00038 DC    CL25'545I RESIDENT COMMON AREA'                          00595000
M545A    DC    AL1(18)                                                  00596000
@NM00039 DC    CL18'545I ISTOLTEP AREA'                                 00597000
M545B    DC    AL1(19)                                                  00598000
@NM00040 DC    CL19'545I TEST WORK AREA'                                00599000
M545C    DC    AL1(13)                                                  00600000
@NM00041 DC    CL13'545I OLT AREA'                                      00601000
M546     DC    AL1(41)                                                  00602000
@NM00042 DC    CL41'546I DUMP NOT AVAILABLE TO SYSTEM CONSOLE'          00603000
M547     DC    AL1(36)                                                  00604000
@NM00043 DC    CL36'547I ISTOLTEP ABENDED. FORCED CANCEL'               00605000
M548     DC    AL1(41)                                                  00606000
@NM00044 DC    CL41'548I ISTOLTEP NO LONGER REQUIRES %%%%%%%%'          00607000
M548A    DC    AL1(63)                                                  00608000
@NM00045 DC    CL63'548I %%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%C00609000
               %%%%%%%%%%%%'                                            00610000
M549     DC    AL1(58)                                                  00611000
@NM00046 DC    CL58'549I %%%%%%%% HAS RELEASED ALL DEVICES AND IS DONE C00612000
               TESTING'                                                 00613000
M550     DC    AL1(58)                                                  00614000
@NM00047 DC    CL58'550D %%%%%%%% REQUESTS PERMISSION TO DO UPDATES. REC00615000
               PLY Y/N'                                                 00616000
M551     DC    AL1(18)                                                  00617000
@NM00048 DC    CL18'551I UPDATE DENIED'                                 00618000
M551A    DC    AL1(23)                                                  00619000
@NM00049 DC    CL23'551I UPDATE UNAVAILABLE'                            00620000
M552     DC    AL1(0)                                                   00621000
M553     DC    AL1(0)                                                   00622000
M554     DC    AL1(0)                                                   00623000
M555     DC    AL1(0)                                                   00624000
M556     DC    AL1(0)                                                   00625000
M557     DC    AL1(0)                                                   00626000
M558     DC    AL1(0)                                                   00627000
M559     DC    AL1(0)                                                   00628000
M560     DC    AL1(49)                                                  00629000
@NM00050 DC    CL49'560D ENTER EXHIBIT,ADD,CHANGE,DELETE,COPY OR NONE'  00630000
M561     DC    AL1(29)                                                  00631000
@NM00051 DC    CL29'561I CDS DELETED FROM LIBRARY'                      00632000
M562     DC    AL1(25)                                                  00633000
@NM00052 DC    CL25'562I CDS ADDED TO LIBRARY'                          00634000
M563     DC    AL1(0)                                                   00635000
M564     DC    AL1(41)                                                  00636000
@NM00053 DC    CL41'564I DELETE NOT PERMITTED FOR THIS DEVICE'          00637000
M565     DC    AL1(0)                                                   00638000
M566     DC    AL1(0)                                                   00639000
M567     DC    AL1(0)                                                   00640000
M568     DC    AL1(0)                                                   00641000
M569     DC    AL1(25)                                                  00642000
@NM00054 DC    CL25'569I UNABLE TO DELETE CDS'                          00643000
M570     DC    AL1(33)                                                  00644000
@NM00055 DC    CL33'570I LAST OPERATION HAD I/O ERROR'                  00645000
M571     DC    AL1(17)                                                  00646000
@NM00056 DC    CL17'571I LIBRARY FULL'                                  00647000
M572     DC    AL1(18)                                                  00648000
@NM00057 DC    CL18'572I CDS NOT FOUND'                                 00649000
M573     DC    AL1(0)                                                   00650000
M574     DC    AL1(26)                                                  00651000
@NM00058 DC    CL26'574I DEVICE NOT CONFIGURED'                         00652000
M575     DC    AL1(0)                                                   00653000
M576     DC    AL1(35)                                                  00654000
@NM00059 DC    CL35'576I CDS EXISTS. USE CHANGE NOT ADD'                00655000
M576A    DC    AL1(50)                                                  00656000
@NM00060 DC    CL50'576I CDS EXISTS. DELETE IT FIRST BEFORE DOING COPY' 00657000
M577     DC    AL1(0)                                                   00658000
M578     DC    AL1(38)                                                  00659000
@NM00061 DC    CL38'578D ENTER SYMBOLIC NAME OR  UNIT ADDR'             00660000
M579     DC    AL1(48)                                                  00661000
@NM00062 DC    CL48'579I %%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%'   00662000
M580     DC    AL1(47)                                                  00663000
@NM00063 DC    CL47'580D ENTER P/PROMPT OR CDS DATA FOLLOWED BY END'    00664000
M580A    DC    AL1(50)                                                  00665000
@NM00064 DC    CL50'580D ENTER NEXT LINE. USE ''END'' TO TERMINATE I/P' 00666000
M580B    DC    AL1(31)                                                  00667000
@NM00065 DC    CL31'580I ENTER CDS DATA AS FOLLOWS:'                    00668000
M580C    DC    AL1(50)                                                  00669000
@NM00066 DC    CL50'580I  DESCRIPTION    EXAMPLES        OPT  REQ(ADD)' 00670000
M580D    DC    AL1(39)                                                  00671000
@NM00067 DC    CL39'580I MODEL            M=01            X'            00672000
M580E    DC    AL1(39)                                                  00673000
@NM00068 DC    CL39'580I FEATURE          F=02            X'            00674000
M580F    DC    AL1(44)                                                  00675000
@NM00069 DC    CL44'580I CLASS            C=10                 X'       00676000
M580G    DC    AL1(44)                                                  00677000
@NM00070 DC    CL44'580I TYPE             T=08                 X'       00678000
M580H    DC    AL1(44)                                                  00679000
@NM00071 DC    CL44'580I FLAGS            FL=020401            X'       00680000
M580I    DC    AL1(44)                                                  00681000
@NM00072 DC    CL44'580I UNIT ADDR        UA=0090              X'       00682000
M580J    DC    AL1(39)                                                  00683000
@NM00073 DC    CL39'580I SYMBOLIC NAME    SN=SYMBNAME     X'            00684000
M580K    DC    AL1(39)                                                  00685000
@NM00074 DC    CL39'580I DATA             SEE NEXT LINE   X'            00686000
M580L    DC    AL1(44)                                                  00687000
@NM00075 DC    CL44'580I -DATA MUST BE PRECEDED BY A BYTE NUMBER'       00688000
M580M    DC    AL1(62)                                                  00689000
@NM00076 DC    CL62'580I -EBCDIC VALUES MUST BE WITHIN SLASHES AND PRECC00690000
               EDED BY -E-'                                             00691000
M580N    DC    AL1(38)                                                  00692000
@NM00077 DC    CL38'580I -THE FIRST DATA BYTE NUMBER IS 20'             00693000
M580O    DC    AL1(45)                                                  00694000
@NM00078 DC    CL45'580I -ANY UNUSED BYTES WILL CONTAIN HEX ZEROS'      00695000
M580P    DC    AL1(18)                                                  00696000
@NM00079 DC    CL18'580I EX: DB20=1234'                                 00697000
M580Q    DC    AL1(28)                                                  00698000
@NM00080 DC    CL28'580I     DB30=E/TEL-NUMB/ OR'                       00699000
M580R    DC    AL1(39)                                                  00700000
@NM00081 DC    CL39'580I     DB20=1234,DB30=E/TEL-NUMB/,END'            00701000
M580S    DC    AL1(57)                                                  00702000
@NM00082 DC    CL57'580I NOTE-COMMAS MAY BE USED TO SEPARATE ANY OF THEC00703000
                ABOVE'                                                  00704000
M580T    DC    AL1(39)                                                  00705000
@NM00083 DC    CL39'580I      MAXIMUM INPUT IS 70 CHAR/LINE'            00706000
M580U    DC    AL1(64)                                                  00707000
@NM00084 DC    CL64'580I      ENTER AN EVEN # OF BYTES WHEN ENTERING NOC00708000
               N-EBCDIC DATA'                                           00709000
M580V    DC    AL1(61)                                                  00710000
@NM00085 DC    CL61'580I        EX: VALID ENTRY-DBXX=1234, INVALID ENTRC00711000
               Y-DBXX=123'                                              00712000
M581     DC    AL1(44)                                                  00713000
@NM00086 DC    CL44'581I INVALID MODEL FIELD. RE-ENTER LAST LINE'       00714000
M581A    DC    AL1(46)                                                  00715000
@NM00087 DC    CL46'581I INVALID FEATURE FIELD. RE-ENTER LAST LINE'     00716000
M581B    DC    AL1(44)                                                  00717000
@NM00088 DC    CL44'581I INVALID CLASS FIELD. RE-ENTER LAST LINE'       00718000
M581C    DC    AL1(43)                                                  00719000
@NM00089 DC    CL43'581I INVALID TYPE FIELD. RE-ENTER LAST LINE'        00720000
M581D    DC    AL1(43)                                                  00721000
@NM00090 DC    CL43'581I INVALID FLAG FIELD. RE-ENTER LAST LINE'        00722000
M581E    DC    AL1(48)                                                  00723000
@NM00091 DC    CL48'581I INVALID UNIT ADDR FIELD. RE-ENTER LAST LINE'   00724000
M581F    DC    AL1(52)                                                  00725000
@NM00092 DC    CL52'581I INVALID SYMBOLIC NAME FIELD. RE-ENTER LAST LINC00726000
               E'                                                       00727000
M581G    DC    AL1(43)                                                  00728000
@NM00093 DC    CL43'581I INVALID DATA FIELD. RE-ENTER LAST LINE'        00729000
M581H    DC    AL1(42)                                                  00730000
@NM00094 DC    CL42'581I INVALID PARAMETER. RE-ENTER LAST LINE'         00731000
M581I    DC    AL1(50)                                                  00732000
@NM00095 DC    CL50'581I EITHER SYMBOLIC NAME OR SYMBOLIC FLAG INVALID' 00733000
M581J    DC    AL1(57)                                                  00734000
@NM00096 DC    CL57'581I ERROR-ONE OR MORE OF THE REQUIRED FIELDS ARE MC00735000
               ISSING'                                                  00736000
M582     DC    AL1(54)                                                  00737000
@NM00097 DC    CL54'582D ENTER NEW SYMBOLIC NAME OR UNIT ADDR (SN= OR UC00738000
               A=)'                                                     00739000
M583     DC    AL1(0)                                                   00740000
M584     DC    AL1(0)                                                   00741000
M585     DC    AL1(0)                                                   00742000
M586     DC    AL1(0)                                                   00743000
M587     DC    AL1(0)                                                   00744000
M588     DC    AL1(0)                                                   00745000
M589     DC    AL1(0)                                                   00746000
M590     DC    AL1(0)                                                   00747000
M591     DC    AL1(0)                                                   00748000
M592     DC    AL1(0)                                                   00749000
M593     DC    AL1(0)                                                   00750000
M594     DC    AL1(0)                                                   00751000
M595     DC    AL1(0)                                                   00752000
M596     DC    AL1(0)                                                   00753000
M597     DC    AL1(0)                                                   00754000
M598     DC    AL1(0)                                                   00755000
M599     DC    AL1(0)                                                   00756000
M600     DC    AL1(0)                                                   00757000
M601     DC    AL1(0)                                                   00758000
M602     DC    AL1(0)                                                   00759000
M603     DC    AL1(0)                                                   00760000
M604     DC    AL1(0)                                                   00761000
M605     DC    AL1(0)                                                   00762000
M606     DC    AL1(0)                                                   00763000
M607     DC    AL1(0)                                                   00764000
M608     DC    AL1(0)                                                   00765000
M609     DC    AL1(0)                                                   00766000
M610     DC    AL1(0)                                                   00767000
M611     DC    AL1(0)                                                   00768000
M612     DC    AL1(0)                                                   00769000
M613     DC    AL1(0)                                                   00770000
M614     DC    AL1(0)                                                   00771000
M615     DC    AL1(0)                                                   00772000
M616     DC    AL1(0)                                                   00773000
M617     DC    AL1(0)                                                   00774000
M618     DC    AL1(0)                                                   00775000
M619     DC    AL1(0)                                                   00776000
M620     DC    AL1(0)                                                   00777000
M621     DC    AL1(0)                                                   00778000
M622     DC    AL1(0)                                                   00779000
M623     DC    AL1(0)                                                   00780000
M624     DC    AL1(0)                                                   00781000
M625     DC    AL1(0)                                                   00782000
M626     DC    AL1(0)                                                   00783000
M627     DC    AL1(0)                                                   00784000
M628     DC    AL1(0)                                                   00785000
M629     DC    AL1(0)                                                   00786000
M630     DC    AL1(0)                                                   00787000
M631     DC    AL1(0)                                                   00788000
M632     DC    AL1(0)                                                   00789000
M633     DC    AL1(0)                                                   00790000
M634     DC    AL1(0)                                                   00791000
M635     DC    AL1(0)                                                   00792000
M636     DC    AL1(0)                                                   00793000
M637     DC    AL1(0)                                                   00794000
M638     DC    AL1(0)                                                   00795000
M639     DC    AL1(0)                                                   00796000
M640     DC    AL1(0)                                                   00797000
M641     DC    AL1(0)                                                   00798000
M642     DC    AL1(0)                                                   00799000
M643     DC    AL1(0)                                                   00800000
M644     DC    AL1(0)                                                   00801000
M645     DC    AL1(0)                                                   00802000
M646     DC    AL1(0)                                                   00803000
M647     DC    AL1(0)                                                   00804000
M648     DC    AL1(0)                                                   00805000
M649     DC    AL1(0)                                                   00806000
M650     DC    AL1(0)                                                   00807000
M651     DC    AL1(0)                                                   00808000
M652     DC    AL1(0)                                                   00809000
M653     DC    AL1(0)                                                   00810000
M654     DC    AL1(0)                                                   00811000
M655     DC    AL1(0)                                                   00812000
M656     DC    AL1(0)                                                   00813000
M657     DC    AL1(0)                                                   00814000
M658     DC    AL1(0)                                                   00815000
M659     DC    AL1(0)                                                   00816000
M660     DC    AL1(0)                                                   00817000
M661     DC    AL1(0)                                                   00818000
M662     DC    AL1(0)                                                   00819000
M663     DC    AL1(0)                                                   00820000
M664     DC    AL1(0)                                                   00821000
M665     DC    AL1(0)                                                   00822000
M666     DC    AL1(0)                                                   00823000
M667     DC    AL1(0)                                                   00824000
M668     DC    AL1(0)                                                   00825000
M669     DC    AL1(0)                                                   00826000
M670     DC    AL1(0)                                                   00827000
M671     DC    AL1(0)                                                   00828000
M672     DC    AL1(0)                                                   00829000
M673     DC    AL1(0)                                                   00830000
M674     DC    AL1(0)                                                   00831000
M675     DC    AL1(0)                                                   00832000
M676     DC    AL1(0)                                                   00833000
M677     DC    AL1(0)                                                   00834000
M678     DC    AL1(0)                                                   00835000
M679     DC    AL1(0)                                                   00836000
M680     DC    AL1(0)                                                   00837000
M681     DC    AL1(0)                                                   00838000
M682     DC    AL1(0)                                                   00839000
M683     DC    AL1(0)                                                   00840000
M684     DC    AL1(0)                                                   00841000
M685     DC    AL1(0)                                                   00842000
M686     DC    AL1(0)                                                   00843000
M687     DC    AL1(0)                                                   00844000
M688     DC    AL1(0)                                                   00845000
M689     DC    AL1(0)                                                   00846000
M690     DC    AL1(0)                                                   00847000
M691     DC    AL1(0)                                                   00848000
M692     DC    AL1(0)                                                   00849000
M693     DC    AL1(0)                                                   00850000
M694     DC    AL1(0)                                                   00851000
M695     DC    AL1(0)                                                   00852000
M696     DC    AL1(0)                                                   00853000
M697     DC    AL1(0)                                                   00854000
M698     DC    AL1(0)                                                   00855000
M699     DC    AL1(0)                                                   00856000
@NM00098 DS    0C                                                       00857000
         ORG   @NM00006+4557                                            00858000
         DS    CL3                                                      00859000
PATCH    DC    10F'0'                                                   00860000
@00      EQU   00                      EQUATES FOR REGISTERS 0-15       00861000
@01      EQU   01                                                       00862000
@02      EQU   02                                                       00863000
@03      EQU   03                                                       00864000
@04      EQU   04                                                       00865000
@05      EQU   05                                                       00866000
@06      EQU   06                                                       00867000
@07      EQU   07                                                       00868000
@08      EQU   08                                                       00869000
@09      EQU   09                                                       00870000
@10      EQU   10                                                       00871000
@11      EQU   11                                                       00872000
@12      EQU   12                                                       00873000
@13      EQU   13                                                       00874000
@14      EQU   14                                                       00875000
@15      EQU   15                                                       00876000
MSG#     EQU   @03                                                      00877000
MSGPTR   EQU   @05                                                      00878000
WAPTR    EQU   @02                                                      00879000
MSGDAT   EQU   0                                                        00880000
TOLTEPWA EQU   0                                                        00881000
$BUFFER  EQU   TOLTEPWA+1976                                            00882000
#EXITA   EQU   TOLTEPWA+2632                                            00883000
$CCOMDAT EQU   TOLTEPWA+2644                                            00884000
$COUTCT  EQU   $CCOMDAT+4                                               00885000
$CFLGS   EQU   $CCOMDAT+16                                              00886000
$24FEMSG EQU   TOLTEPWA+2681                                            00887000
$24CATMG EQU   $24FEMSG+11                                              00888000
@NM00003 EQU   TOLTEPWA+2776                                            00889000
$OUNTPTR EQU   @NM00003+4                                               00890000
$NSPTR   EQU   $OUNTPTR                                                 00891000
$NSCNT   EQU   @NM00003+10                                              00892000
$ENXX    EQU   @NM00003+15                                              00893000
$IMITX   EQU   $ENXX                                                    00894000
SVESC033 EQU   TOLTEPWA+3160                                            00895000
SVECC013 EQU   TOLTEPWA+3232                                            00896000
SVEIC003 EQU   TOLTEPWA+3592                                            00897000
SVESC022 EQU   TOLTEPWA+3736                                            00898000
SVECC011 EQU   TOLTEPWA+4024                                            00899000
#EXIT    EQU   0                                                        00900000
@NM00001 EQU   $BUFFER                                                  00901000
MSGNUM   EQU   @NM00001                                                 00902000
SVECC012 EQU   SVESC022                                                 00903000
SVEIC00A EQU   SVEIC003                                                 00904000
SVEIC004 EQU   SVEIC003                                                 00905000
SVEIC005 EQU   SVEIC003                                                 00906000
SVESC02A EQU   SVESC022                                                 00907000
SVESC02B EQU   SVESC022                                                 00908000
SVESC02D EQU   SVESC022                                                 00909000
SVESC02E EQU   SVESC022                                                 00910000
SVESC02F EQU   SVECC013                                                 00911000
SVESC024 EQU   SVESC022                                                 00912000
SVESC027 EQU   SVESC022                                                 00913000
SVESC029 EQU   SVESC033                                                 00914000
SVESC031 EQU   SVECC013                                                 00915000
SVESC032 EQU   SVECC011                                                 00916000
SVETC037 EQU   SVEIC003                                                 00917000
         AGO   .@UNREFD                START UNREFERENCED COMPONENTS    00918000
SVECC010 EQU   TOLTEPWA+3952                                            00919000
SVETC035 EQU   TOLTEPWA+3880                                            00920000
SVESC030 EQU   TOLTEPWA+3808                                            00921000
SVESC020 EQU   TOLTEPWA+3664                                            00922000
SVEIC002 EQU   TOLTEPWA+3520                                            00923000
SVECC014 EQU   TOLTEPWA+3376                                            00924000
SVESC120 EQU   TOLTEPWA+3304                                            00925000
SVESC025 EQU   TOLTEPWA+3088                                            00926000
@NM00005 EQU   TOLTEPWA+2980                                            00927000
$RPLERR  EQU   TOLTEPWA+2977                                            00928000
@NM00004 EQU   TOLTEPWA+2976                                            00929000
$R13PR3  EQU   TOLTEPWA+2972                                            00930000
$CEINT2  EQU   TOLTEPWA+2968                                            00931000
$CEINT1  EQU   TOLTEPWA+2964                                            00932000
$MSGGET  EQU   TOLTEPWA+2960                                            00933000
$ACQLIST EQU   TOLTEPWA+2956                                            00934000
$R4SAVE1 EQU   TOLTEPWA+2952                                            00935000
$CLSISS  EQU   TOLTEPWA+2950                                            00936000
$CLSCNT  EQU   TOLTEPWA+2948                                            00937000
$CUTABLE EQU   TOLTEPWA+2868                                            00938000
$BUFSZ2  EQU   TOLTEPWA+2864                                            00939000
$RESID2  EQU   TOLTEPWA+2860                                            00940000
$OLTCCW2 EQU   TOLTEPWA+2856                                            00941000
$ENDBFR2 EQU   TOLTEPWA+2852                                            00942000
$1STBFR2 EQU   TOLTEPWA+2848                                            00943000
$TECB2   EQU   TOLTEPWA+2844                                            00944000
$BUFSZ1  EQU   TOLTEPWA+2840                                            00945000
$RESID1  EQU   TOLTEPWA+2836                                            00946000
$OLTCCW1 EQU   TOLTEPWA+2832                                            00947000
$ENDBFR1 EQU   TOLTEPWA+2828                                            00948000
$1STBFR1 EQU   TOLTEPWA+2824                                            00949000
$TECB1   EQU   TOLTEPWA+2820                                            00950000
$WAITIME EQU   TOLTEPWA+2816                                            00951000
$TRTN#   EQU   TOLTEPWA+2815                                            00952000
$WIODEV  EQU   TOLTEPWA+2814                                            00953000
$RQSTSZE EQU   TOLTEPWA+2812                                            00954000
$RQSTPTR EQU   TOLTEPWA+2808                                            00955000
$R4SAVE  EQU   TOLTEPWA+2804                                            00956000
$PARTADR EQU   TOLTEPWA+2800                                            00957000
$TBSDATA EQU   TOLTEPWA+2796                                            00958000
$CTWIDTH EQU   TOLTEPWA+2795                                            00959000
$CTLINE  EQU   TOLTEPWA+2794                                            00960000
$APWIDTH EQU   TOLTEPWA+2793                                            00961000
$APLINE  EQU   TOLTEPWA+2792                                            00962000
$INDEX   EQU   $IMITX                                                   00963000
$UMXX    EQU   @NM00003+14                                              00964000
$NSXX    EQU   @NM00003+12                                              00965000
$ATACNT  EQU   $NSCNT                                                   00966000
$CTR     EQU   @NM00003+8                                               00967000
$ATAPTR  EQU   $NSPTR                                                   00968000
$DDRPTR  EQU   @NM00003                                                 00969000
$DTORESP EQU   TOLTEPWA+2712                                            00970000
$APNAME  EQU   TOLTEPWA+2704                                            00971000
$24SYMNE EQU   $24CATMG+4                                               00972000
$24DEVAD EQU   $24CATMG                                                 00973000
$24RTN#  EQU   $24FEMSG+8                                               00974000
$ESECTID EQU   $24FEMSG                                                 00975000
$24FLGS  EQU   TOLTEPWA+2680                                            00976000
$24SAVE2 EQU   TOLTEPWA+2676                                            00977000
$24SAVE1 EQU   TOLTEPWA+2672                                            00978000
$24UNADR EQU   TOLTEPWA+2668                                            00979000
$24SAV13 EQU   TOLTEPWA+2664                                            00980000
$24RETCD EQU   TOLTEPWA+2663                                            00981000
$MACID   EQU   TOLTEPWA+2661                                            00982000
$CSPARE  EQU   $CFLGS                                                   00983000
$C2WAY   EQU   $CFLGS                                                   00984000
$CINCT   EQU   $CCOMDAT+12                                              00985000
$CINADR  EQU   $CCOMDAT+8                                               00986000
$COUTAD  EQU   $CCOMDAT                                                 00987000
ROOTLOC  EQU   TOLTEPWA+2640                                            00988000
$RETREG  EQU   TOLTEPWA+2636                                            00989000
$WORK    EQU   TOLTEPWA+2376                                            00990000
$EXTA    EQU   TOLTEPWA+2320                                            00991000
$PASSONA EQU   TOLTEPWA+2264                                            00992000
$TRMINPT EQU   TOLTEPWA+2184                                            00993000
$INBUFR  EQU   TOLTEPWA+2104                                            00994000
$TLTRPL3 EQU   TOLTEPWA+1856                                            00995000
$TLTRPL2 EQU   TOLTEPWA+1736                                            00996000
$TLTRPL1 EQU   TOLTEPWA+1616                                            00997000
$SLTBL   EQU   TOLTEPWA+1468                                            00998000
@NM00002 EQU   TOLTEPWA+1464                                            00999000
$DEVTBLE EQU   TOLTEPWA+240                                             01000000
$COMMFLG EQU   TOLTEPWA+224                                             01001000
$CDA     EQU   TOLTEPWA+100                                             01002000
$SCTTBLE EQU   TOLTEPWA                                                 01003000
.@UNREFD ANOP                          END UNREFERENCED COMPONENTS      01004000
@ENDDATA EQU   *                                                        01005000
         END   ISTEC456,(C'PLS1225',0702,78336)                         01006000
./  ADD  SSI=83351645,NAME=ISTEC789
         TITLE 'ISTEC789 - MESSAGE MODULE #3'                           00001000
ISTEC789 CSECT ,                                                   0001 00002000
@MAINENT DS    0H                                                  0001 00003000
         USING *,@15                                               0001 00004000
         B     @PROLOG                                             0001 00005000
         DC    AL1(16)                                             0001 00006000
         DC    C'ISTEC789  78.336'                                 0001 00007000
         DROP  @15                                                      00008000
@PROLOG  STM   @14,@12,12(@13)                                     0001 00009000
         BALR  @11,0                                               0001 00010000
@PSTART  DS    0H                                                  0001 00011000
         USING @PSTART,@11                                         0001 00012000
         SPACE                                                          00013000
*                                                                  0026 00014000
*/********************************************************************/ 00015000
*/* LOCATE MESSAGE IN TABLE                                          */ 00016000
*/********************************************************************/ 00017000
*                                                                  0027 00018000
*   MSG#=MSGNUM-699;                /* GET MSG NUMBER                */ 00019000
         L     MSG#,MSGNUM(,WAPTR)                                 0027 00020000
         SL    MSG#,@CF00542                                       0027 00021000
*   IF MSG#<101                     /* IS MSG NUMBER 700-799         */ 00022000
*     THEN                                                         0028 00023000
         C     MSG#,@CF00543                                       0028 00024000
         BNL   @RF00028                                            0028 00025000
*     MSGPTR=MSGTBL1(MSG#)+ADDR(MESSAGES);/* GET PTR TO MSG          */ 00026000
         LR    @12,MSG#                                            0029 00027000
         ALR   @12,@12                                             0029 00028000
         LA    MSGPTR,MESSAGES                                     0029 00029000
         AH    MSGPTR,MSGTBL1-2(@12)                               0029 00030000
*   ELSE                                                           0030 00031000
*     DO;                                                          0030 00032000
         B     @RC00028                                            0030 00033000
@RF00028 DS    0H                                                  0031 00034000
*       MSG#=MSGNUM-799;                                           0031 00035000
         L     MSG#,MSGNUM(,WAPTR)                                 0031 00036000
         SL    MSG#,@CF00544                                       0031 00037000
*       IF MSG#<101                 /* IS MSG NUMBER 800-899         */ 00038000
*         THEN                                                     0032 00039000
         C     MSG#,@CF00543                                       0032 00040000
         BNL   @RF00032                                            0032 00041000
*         MSGPTR=MSGTBL2(MSG#)+ADDR(MESSAGES);/* GET PTR TO MSG      */ 00042000
         LR    @12,MSG#                                            0033 00043000
         ALR   @12,@12                                             0033 00044000
         LA    MSGPTR,MESSAGES                                     0033 00045000
         AH    MSGPTR,MSGTBL2-2(@12)                               0033 00046000
*       ELSE                                                       0034 00047000
*         DO;                                                      0034 00048000
         B     @RC00032                                            0034 00049000
@RF00032 DS    0H                                                  0035 00050000
*           MSG#=MSGNUM-899;        /* MSG NUMBER IS 900-999         */ 00051000
         L     MSG#,MSGNUM(,WAPTR)                                 0035 00052000
         SL    MSG#,@CF00545                                       0035 00053000
*           MSGPTR=MSGTBL3(MSG#)+ADDR(MESSAGES);/* GET PTR TO MSG    */ 00054000
         LR    @12,MSG#                                            0036 00055000
         ALR   @12,@12                                             0036 00056000
         LA    MSGPTR,MESSAGES                                     0036 00057000
         AH    MSGPTR,MSGTBL3-2(@12)                               0036 00058000
*         END;                                                     0037 00059000
*     END;                                                         0038 00060000
*                                                                  0038 00061000
@RC00032 DS    0H                                                  0039 00062000
*/********************************************************************/ 00063000
*/* SEND MESSAGE INFORMATION BACK TO CALLER                          */ 00064000
*/********************************************************************/ 00065000
*                                                                  0039 00066000
*   $COUTCT(4:4)=MSGDAT;            /* GET MSG LENGTH                */ 00067000
@RC00028 MVC   $COUTCT+3(1,WAPTR),MSGDAT(MSGPTR)                   0039 00068000
*   MSGPTR=MSGPTR+1;                /* SET PTR TO START OF MSG       */ 00069000
         AL    MSGPTR,@CF00044                                     0040 00070000
*   MSGNUM=MSGPTR;                  /* SAVE MSG TEXT PTR             */ 00071000
         ST    MSGPTR,MSGNUM(,WAPTR)                               0041 00072000
*   DO;                             /* ATDSPLY                       */ 00073000
*   END;                            /* ATDSPLY                       */ 00074000
*   END;                                                           0044 00075000
@EL00001 DS    0H                                                  0044 00076000
@EF00001 DS    0H                                                  0044 00077000
@ER00001 LM    @14,@12,12(@13)                                     0044 00078000
         BR    @14                                                 0044 00079000
@DATA    DS    0H                                                       00080000
         DS    0F                                                       00081000
         DS    0F                                                       00082000
@CF00044 DC    F'1'                                                     00083000
@CF00543 DC    F'101'                                                   00084000
@CF00542 DC    F'699'                                                   00085000
@CF00544 DC    F'799'                                                   00086000
@CF00545 DC    F'899'                                                   00087000
         DS    0D                                                       00088000
@NM00006 DS    CL1259                                                   00089000
         ORG   @NM00006                                                 00090000
MSGTBL1  DC    AL2(M700-MESSAGES)                                       00091000
         DC    AL2(M701-MESSAGES)                                       00092000
         DC    AL2(M702-MESSAGES)                                       00093000
         DC    AL2(M703-MESSAGES)                                       00094000
         DC    AL2(M704-MESSAGES)                                       00095000
         DC    AL2(M705-MESSAGES)                                       00096000
         DC    AL2(M706-MESSAGES)                                       00097000
         DC    AL2(M707-MESSAGES)                                       00098000
         DC    AL2(M708-MESSAGES)                                       00099000
         DC    AL2(M709-MESSAGES)                                       00100000
         DC    AL2(M710-MESSAGES)                                       00101000
         DC    AL2(M711-MESSAGES)                                       00102000
         DC    AL2(M712-MESSAGES)                                       00103000
         DC    AL2(M713-MESSAGES)                                       00104000
         DC    AL2(M714-MESSAGES)                                       00105000
         DC    AL2(M715-MESSAGES)                                       00106000
         DC    AL2(M716-MESSAGES)                                       00107000
         DC    AL2(M717-MESSAGES)                                       00108000
         DC    AL2(M718-MESSAGES)                                       00109000
         DC    AL2(M719-MESSAGES)                                       00110000
         DC    AL2(M720-MESSAGES)                                       00111000
         DC    AL2(M721-MESSAGES)                                       00112000
         DC    AL2(M722-MESSAGES)                                       00113000
         DC    AL2(M723-MESSAGES)                                       00114000
         DC    AL2(M724-MESSAGES)                                       00115000
         DC    AL2(M725-MESSAGES)                                       00116000
         DC    AL2(M726-MESSAGES)                                       00117000
         DC    AL2(M727-MESSAGES)                                       00118000
         DC    AL2(M728-MESSAGES)                                       00119000
         DC    AL2(M729-MESSAGES)                                       00120000
         DC    AL2(M730-MESSAGES)                                       00121000
         DC    AL2(M731-MESSAGES)                                       00122000
         DC    AL2(M732-MESSAGES)                                       00123000
         DC    AL2(M733-MESSAGES)                                       00124000
         DC    AL2(M734-MESSAGES)                                       00125000
         DC    AL2(M735-MESSAGES)                                       00126000
         DC    AL2(M736-MESSAGES)                                       00127000
         DC    AL2(M737-MESSAGES)                                       00128000
         DC    AL2(M738-MESSAGES)                                       00129000
         DC    AL2(M739-MESSAGES)                                       00130000
         DC    AL2(M740-MESSAGES)                                       00131000
         DC    AL2(M741-MESSAGES)                                       00132000
         DC    AL2(M742-MESSAGES)                                       00133000
         DC    AL2(M743-MESSAGES)                                       00134000
         DC    AL2(M744-MESSAGES)                                       00135000
         DC    AL2(M745-MESSAGES)                                       00136000
         DC    AL2(M746-MESSAGES)                                       00137000
         DC    AL2(M747-MESSAGES)                                       00138000
         DC    AL2(M748-MESSAGES)                                       00139000
         DC    AL2(M749-MESSAGES)                                       00140000
         DC    AL2(M750-MESSAGES)                                       00141000
         DC    AL2(M751-MESSAGES)                                       00142000
         DC    AL2(M752-MESSAGES)                                       00143000
         DC    AL2(M753-MESSAGES)                                       00144000
         DC    AL2(M754-MESSAGES)                                       00145000
         DC    AL2(M755-MESSAGES)                                       00146000
         DC    AL2(M756-MESSAGES)                                       00147000
         DC    AL2(M757-MESSAGES)                                       00148000
         DC    AL2(M758-MESSAGES)                                       00149000
         DC    AL2(M759-MESSAGES)                                       00150000
         DC    AL2(M760-MESSAGES)                                       00151000
         DC    AL2(M761-MESSAGES)                                       00152000
         DC    AL2(M762-MESSAGES)                                       00153000
         DC    AL2(M763-MESSAGES)                                       00154000
         DC    AL2(M764-MESSAGES)                                       00155000
         DC    AL2(M765-MESSAGES)                                       00156000
         DC    AL2(M766-MESSAGES)                                       00157000
         DC    AL2(M767-MESSAGES)                                       00158000
         DC    AL2(M768-MESSAGES)                                       00159000
         DC    AL2(M769-MESSAGES)                                       00160000
         DC    AL2(M770-MESSAGES)                                       00161000
         DC    AL2(M771-MESSAGES)                                       00162000
         DC    AL2(M772-MESSAGES)                                       00163000
         DC    AL2(M773-MESSAGES)                                       00164000
         DC    AL2(M774-MESSAGES)                                       00165000
         DC    AL2(M775-MESSAGES)                                       00166000
         DC    AL2(M776-MESSAGES)                                       00167000
         DC    AL2(M777-MESSAGES)                                       00168000
         DC    AL2(M778-MESSAGES)                                       00169000
         DC    AL2(M779-MESSAGES)                                       00170000
         DC    AL2(M780-MESSAGES)                                       00171000
         DC    AL2(M781-MESSAGES)                                       00172000
         DC    AL2(M782-MESSAGES)                                       00173000
         DC    AL2(M783-MESSAGES)                                       00174000
         DC    AL2(M784-MESSAGES)                                       00175000
         DC    AL2(M785-MESSAGES)                                       00176000
         DC    AL2(M786-MESSAGES)                                       00177000
         DC    AL2(M787-MESSAGES)                                       00178000
         DC    AL2(M788-MESSAGES)                                       00179000
         DC    AL2(M789-MESSAGES)                                       00180000
         DC    AL2(M790-MESSAGES)                                       00181000
         DC    AL2(M791-MESSAGES)                                       00182000
         DC    AL2(M792-MESSAGES)                                       00183000
         DC    AL2(M793-MESSAGES)                                       00184000
         DC    AL2(M794-MESSAGES)                                       00185000
         DC    AL2(M795-MESSAGES)                                       00186000
         DC    AL2(M796-MESSAGES)                                       00187000
         DC    AL2(M797-MESSAGES)                                       00188000
         DC    AL2(M798-MESSAGES)                                       00189000
         DC    AL2(M799-MESSAGES)                                       00190000
MSGTBL2  DC    AL2(M800-MESSAGES)                                       00191000
         DC    AL2(M801-MESSAGES)                                       00192000
         DC    AL2(M802-MESSAGES)                                       00193000
         DC    AL2(M803-MESSAGES)                                       00194000
         DC    AL2(M804-MESSAGES)                                       00195000
         DC    AL2(M805-MESSAGES)                                       00196000
         DC    AL2(M806-MESSAGES)                                       00197000
         DC    AL2(M807-MESSAGES)                                       00198000
         DC    AL2(M808-MESSAGES)                                       00199000
         DC    AL2(M809-MESSAGES)                                       00200000
         DC    AL2(M810-MESSAGES)                                       00201000
         DC    AL2(M811-MESSAGES)                                       00202000
         DC    AL2(M812-MESSAGES)                                       00203000
         DC    AL2(M813-MESSAGES)                                       00204000
         DC    AL2(M814-MESSAGES)                                       00205000
         DC    AL2(M815-MESSAGES)                                       00206000
         DC    AL2(M816-MESSAGES)                                       00207000
         DC    AL2(M817-MESSAGES)                                       00208000
         DC    AL2(M818-MESSAGES)                                       00209000
         DC    AL2(M819-MESSAGES)                                       00210000
         DC    AL2(M820-MESSAGES)                                       00211000
         DC    AL2(M821-MESSAGES)                                       00212000
         DC    AL2(M822-MESSAGES)                                       00213000
         DC    AL2(M823-MESSAGES)                                       00214000
         DC    AL2(M824-MESSAGES)                                       00215000
         DC    AL2(M825-MESSAGES)                                       00216000
         DC    AL2(M826-MESSAGES)                                       00217000
         DC    AL2(M827-MESSAGES)                                       00218000
         DC    AL2(M828-MESSAGES)                                       00219000
         DC    AL2(M829-MESSAGES)                                       00220000
         DC    AL2(M830-MESSAGES)                                       00221000
         DC    AL2(M831-MESSAGES)                                       00222000
         DC    AL2(M832-MESSAGES)                                       00223000
         DC    AL2(M833-MESSAGES)                                       00224000
         DC    AL2(M834-MESSAGES)                                       00225000
         DC    AL2(M835-MESSAGES)                                       00226000
         DC    AL2(M836-MESSAGES)                                       00227000
         DC    AL2(M837-MESSAGES)                                       00228000
         DC    AL2(M838-MESSAGES)                                       00229000
         DC    AL2(M839-MESSAGES)                                       00230000
         DC    AL2(M840-MESSAGES)                                       00231000
         DC    AL2(M841-MESSAGES)                                       00232000
         DC    AL2(M842-MESSAGES)                                       00233000
         DC    AL2(M843-MESSAGES)                                       00234000
         DC    AL2(M844-MESSAGES)                                       00235000
         DC    AL2(M845-MESSAGES)                                       00236000
         DC    AL2(M846-MESSAGES)                                       00237000
         DC    AL2(M847-MESSAGES)                                       00238000
         DC    AL2(M848-MESSAGES)                                       00239000
         DC    AL2(M849-MESSAGES)                                       00240000
         DC    AL2(M850-MESSAGES)                                       00241000
         DC    AL2(M851-MESSAGES)                                       00242000
         DC    AL2(M852-MESSAGES)                                       00243000
         DC    AL2(M853-MESSAGES)                                       00244000
         DC    AL2(M854-MESSAGES)                                       00245000
         DC    AL2(M855-MESSAGES)                                       00246000
         DC    AL2(M856-MESSAGES)                                       00247000
         DC    AL2(M857-MESSAGES)                                       00248000
         DC    AL2(M858-MESSAGES)                                       00249000
         DC    AL2(M859-MESSAGES)                                       00250000
         DC    AL2(M860-MESSAGES)                                       00251000
         DC    AL2(M861-MESSAGES)                                       00252000
         DC    AL2(M862-MESSAGES)                                       00253000
         DC    AL2(M863-MESSAGES)                                       00254000
         DC    AL2(M864-MESSAGES)                                       00255000
         DC    AL2(M865-MESSAGES)                                       00256000
         DC    AL2(M866-MESSAGES)                                       00257000
         DC    AL2(M867-MESSAGES)                                       00258000
         DC    AL2(M868-MESSAGES)                                       00259000
         DC    AL2(M869-MESSAGES)                                       00260000
         DC    AL2(M870-MESSAGES)                                       00261000
         DC    AL2(M871-MESSAGES)                                       00262000
         DC    AL2(M872-MESSAGES)                                       00263000
         DC    AL2(M873-MESSAGES)                                       00264000
         DC    AL2(M874-MESSAGES)                                       00265000
         DC    AL2(M875-MESSAGES)                                       00266000
         DC    AL2(M876-MESSAGES)                                       00267000
         DC    AL2(M877-MESSAGES)                                       00268000
         DC    AL2(M878-MESSAGES)                                       00269000
         DC    AL2(M879-MESSAGES)                                       00270000
         DC    AL2(M880-MESSAGES)                                       00271000
         DC    AL2(M881-MESSAGES)                                       00272000
         DC    AL2(M882-MESSAGES)                                       00273000
         DC    AL2(M883-MESSAGES)                                       00274000
         DC    AL2(M884-MESSAGES)                                       00275000
         DC    AL2(M885-MESSAGES)                                       00276000
         DC    AL2(M886-MESSAGES)                                       00277000
         DC    AL2(M887-MESSAGES)                                       00278000
         DC    AL2(M888-MESSAGES)                                       00279000
         DC    AL2(M889-MESSAGES)                                       00280000
         DC    AL2(M890-MESSAGES)                                       00281000
         DC    AL2(M891-MESSAGES)                                       00282000
         DC    AL2(M892-MESSAGES)                                       00283000
         DC    AL2(M893-MESSAGES)                                       00284000
         DC    AL2(M894-MESSAGES)                                       00285000
         DC    AL2(M895-MESSAGES)                                       00286000
         DC    AL2(M896-MESSAGES)                                       00287000
         DC    AL2(M897-MESSAGES)                                       00288000
         DC    AL2(M898-MESSAGES)                                       00289000
         DC    AL2(M899-MESSAGES)                                       00290000
MSGTBL3  DC    AL2(M900-MESSAGES)                                       00291000
         DC    AL2(M901-MESSAGES)                                       00292000
         DC    AL2(M902-MESSAGES)                                       00293000
         DC    AL2(M903-MESSAGES)                                       00294000
         DC    AL2(M904-MESSAGES)                                       00295000
         DC    AL2(M905-MESSAGES)                                       00296000
         DC    AL2(M906-MESSAGES)                                       00297000
         DC    AL2(M907-MESSAGES)                                       00298000
         DC    AL2(M908-MESSAGES)                                       00299000
         DC    AL2(M909-MESSAGES)                                       00300000
         DC    AL2(M910-MESSAGES)                                       00301000
         DC    AL2(M911-MESSAGES)                                       00302000
         DC    AL2(M912-MESSAGES)                                       00303000
         DC    AL2(M913-MESSAGES)                                       00304000
         DC    AL2(M914-MESSAGES)                                       00305000
         DC    AL2(M915-MESSAGES)                                       00306000
         DC    AL2(M916-MESSAGES)                                       00307000
         DC    AL2(M917-MESSAGES)                                       00308000
         DC    AL2(M918-MESSAGES)                                       00309000
         DC    AL2(M919-MESSAGES)                                       00310000
         DC    AL2(M920-MESSAGES)                                       00311000
         DC    AL2(M921-MESSAGES)                                       00312000
         DC    AL2(M922-MESSAGES)                                       00313000
         DC    AL2(M923-MESSAGES)                                       00314000
         DC    AL2(M924-MESSAGES)                                       00315000
         DC    AL2(M925-MESSAGES)                                       00316000
         DC    AL2(M926-MESSAGES)                                       00317000
         DC    AL2(M927-MESSAGES)                                       00318000
         DC    AL2(M928-MESSAGES)                                       00319000
         DC    AL2(M929-MESSAGES)                                       00320000
         DC    AL2(M930-MESSAGES)                                       00321000
         DC    AL2(M931-MESSAGES)                                       00322000
         DC    AL2(M932-MESSAGES)                                       00323000
         DC    AL2(M933-MESSAGES)                                       00324000
         DC    AL2(M934-MESSAGES)                                       00325000
         DC    AL2(M935-MESSAGES)                                       00326000
         DC    AL2(M936-MESSAGES)                                       00327000
         DC    AL2(M937-MESSAGES)                                       00328000
         DC    AL2(M938-MESSAGES)                                       00329000
         DC    AL2(M939-MESSAGES)                                       00330000
         DC    AL2(M940-MESSAGES)                                       00331000
         DC    AL2(M941-MESSAGES)                                       00332000
         DC    AL2(M942-MESSAGES)                                       00333000
         DC    AL2(M943-MESSAGES)                                       00334000
         DC    AL2(M944-MESSAGES)                                       00335000
         DC    AL2(M945-MESSAGES)                                       00336000
         DC    AL2(M946-MESSAGES)                                       00337000
         DC    AL2(M947-MESSAGES)                                       00338000
         DC    AL2(M948-MESSAGES)                                       00339000
         DC    AL2(M949-MESSAGES)                                       00340000
         DC    AL2(M950-MESSAGES)                                       00341000
         DC    AL2(M951-MESSAGES)                                       00342000
         DC    AL2(M952-MESSAGES)                                       00343000
         DC    AL2(M953-MESSAGES)                                       00344000
         DC    AL2(M954-MESSAGES)                                       00345000
         DC    AL2(M955-MESSAGES)                                       00346000
         DC    AL2(M956-MESSAGES)                                       00347000
         DC    AL2(M957-MESSAGES)                                       00348000
         DC    AL2(M958-MESSAGES)                                       00349000
         DC    AL2(M959-MESSAGES)                                       00350000
         DC    AL2(M960-MESSAGES)                                       00351000
         DC    AL2(M961-MESSAGES)                                       00352000
         DC    AL2(M962-MESSAGES)                                       00353000
         DC    AL2(M963-MESSAGES)                                       00354000
         DC    AL2(M964-MESSAGES)                                       00355000
         DC    AL2(M965-MESSAGES)                                       00356000
         DC    AL2(M966-MESSAGES)                                       00357000
         DC    AL2(M967-MESSAGES)                                       00358000
         DC    AL2(M968-MESSAGES)                                       00359000
         DC    AL2(M969-MESSAGES)                                       00360000
         DC    AL2(M970-MESSAGES)                                       00361000
         DC    AL2(M971-MESSAGES)                                       00362000
         DC    AL2(M972-MESSAGES)                                       00363000
         DC    AL2(M973-MESSAGES)                                       00364000
         DC    AL2(M974-MESSAGES)                                       00365000
         DC    AL2(M975-MESSAGES)                                       00366000
         DC    AL2(M976-MESSAGES)                                       00367000
         DC    AL2(M977-MESSAGES)                                       00368000
         DC    AL2(M978-MESSAGES)                                       00369000
         DC    AL2(M979-MESSAGES)                                       00370000
         DC    AL2(M980-MESSAGES)                                       00371000
         DC    AL2(M981-MESSAGES)                                       00372000
         DC    AL2(M982-MESSAGES)                                       00373000
         DC    AL2(M983-MESSAGES)                                       00374000
         DC    AL2(M984-MESSAGES)                                       00375000
         DC    AL2(M985-MESSAGES)                                       00376000
         DC    AL2(M986-MESSAGES)                                       00377000
         DC    AL2(M987-MESSAGES)                                       00378000
         DC    AL2(M988-MESSAGES)                                       00379000
         DC    AL2(M989-MESSAGES)                                       00380000
         DC    AL2(M990-MESSAGES)                                       00381000
         DC    AL2(M991-MESSAGES)                                       00382000
         DC    AL2(M992-MESSAGES)                                       00383000
         DC    AL2(M993-MESSAGES)                                       00384000
         DC    AL2(M994-MESSAGES)                                       00385000
         DC    AL2(M995-MESSAGES)                                       00386000
         DC    AL2(M996-MESSAGES)                                       00387000
         DC    AL2(M997-MESSAGES)                                       00388000
         DC    AL2(M998-MESSAGES)                                       00389000
         DC    AL2(M999-MESSAGES)                                       00390000
MESSAGES DS    CL659                                                    00391000
         ORG   MESSAGES                                                 00392000
M700     DC    AL1(0)                                                   00393000
M701     DC    AL1(0)                                                   00394000
M702     DC    AL1(0)                                                   00395000
M703     DC    AL1(0)                                                   00396000
M704     DC    AL1(0)                                                   00397000
M705     DC    AL1(0)                                                   00398000
M706     DC    AL1(0)                                                   00399000
M707     DC    AL1(0)                                                   00400000
M708     DC    AL1(0)                                                   00401000
M709     DC    AL1(0)                                                   00402000
M710     DC    AL1(0)                                                   00403000
M711     DC    AL1(0)                                                   00404000
M712     DC    AL1(0)                                                   00405000
M713     DC    AL1(0)                                                   00406000
M714     DC    AL1(0)                                                   00407000
M715     DC    AL1(0)                                                   00408000
M716     DC    AL1(0)                                                   00409000
M717     DC    AL1(0)                                                   00410000
M718     DC    AL1(0)                                                   00411000
M719     DC    AL1(0)                                                   00412000
M720     DC    AL1(0)                                                   00413000
M721     DC    AL1(0)                                                   00414000
M722     DC    AL1(0)                                                   00415000
M723     DC    AL1(0)                                                   00416000
M724     DC    AL1(0)                                                   00417000
M725     DC    AL1(0)                                                   00418000
M726     DC    AL1(0)                                                   00419000
M727     DC    AL1(0)                                                   00420000
M728     DC    AL1(0)                                                   00421000
M729     DC    AL1(0)                                                   00422000
M730     DC    AL1(0)                                                   00423000
M731     DC    AL1(0)                                                   00424000
M732     DC    AL1(0)                                                   00425000
M733     DC    AL1(0)                                                   00426000
M734     DC    AL1(0)                                                   00427000
M735     DC    AL1(0)                                                   00428000
M736     DC    AL1(0)                                                   00429000
M737     DC    AL1(0)                                                   00430000
M738     DC    AL1(0)                                                   00431000
M739     DC    AL1(0)                                                   00432000
M740     DC    AL1(0)                                                   00433000
M741     DC    AL1(0)                                                   00434000
M742     DC    AL1(0)                                                   00435000
M743     DC    AL1(0)                                                   00436000
M744     DC    AL1(0)                                                   00437000
M745     DC    AL1(0)                                                   00438000
M746     DC    AL1(0)                                                   00439000
M747     DC    AL1(0)                                                   00440000
M748     DC    AL1(0)                                                   00441000
M749     DC    AL1(0)                                                   00442000
M750     DC    AL1(0)                                                   00443000
M751     DC    AL1(0)                                                   00444000
M752     DC    AL1(0)                                                   00445000
M753     DC    AL1(0)                                                   00446000
M754     DC    AL1(0)                                                   00447000
M755     DC    AL1(0)                                                   00448000
M756     DC    AL1(0)                                                   00449000
M757     DC    AL1(0)                                                   00450000
M758     DC    AL1(0)                                                   00451000
M759     DC    AL1(0)                                                   00452000
M760     DC    AL1(0)                                                   00453000
M761     DC    AL1(0)                                                   00454000
M762     DC    AL1(0)                                                   00455000
M763     DC    AL1(0)                                                   00456000
M764     DC    AL1(0)                                                   00457000
M765     DC    AL1(0)                                                   00458000
M766     DC    AL1(0)                                                   00459000
M767     DC    AL1(0)                                                   00460000
M768     DC    AL1(0)                                                   00461000
M769     DC    AL1(0)                                                   00462000
M770     DC    AL1(0)                                                   00463000
M771     DC    AL1(0)                                                   00464000
M772     DC    AL1(0)                                                   00465000
M773     DC    AL1(0)                                                   00466000
M774     DC    AL1(0)                                                   00467000
M775     DC    AL1(0)                                                   00468000
M776     DC    AL1(0)                                                   00469000
M777     DC    AL1(0)                                                   00470000
M778     DC    AL1(0)                                                   00471000
M779     DC    AL1(0)                                                   00472000
M780     DC    AL1(0)                                                   00473000
M781     DC    AL1(0)                                                   00474000
M782     DC    AL1(0)                                                   00475000
M783     DC    AL1(0)                                                   00476000
M784     DC    AL1(0)                                                   00477000
M785     DC    AL1(0)                                                   00478000
M786     DC    AL1(0)                                                   00479000
M787     DC    AL1(0)                                                   00480000
M788     DC    AL1(0)                                                   00481000
M789     DC    AL1(0)                                                   00482000
M790     DC    AL1(0)                                                   00483000
M791     DC    AL1(0)                                                   00484000
M792     DC    AL1(0)                                                   00485000
M793     DC    AL1(0)                                                   00486000
M794     DC    AL1(0)                                                   00487000
M795     DC    AL1(0)                                                   00488000
M796     DC    AL1(0)                                                   00489000
M797     DC    AL1(0)                                                   00490000
M798     DC    AL1(0)                                                   00491000
M799     DC    AL1(0)                                                   00492000
M800     DC    AL1(0)                                                   00493000
M801     DC    AL1(0)                                                   00494000
M802     DC    AL1(0)                                                   00495000
M803     DC    AL1(0)                                                   00496000
M804     DC    AL1(0)                                                   00497000
M805     DC    AL1(0)                                                   00498000
M806     DC    AL1(0)                                                   00499000
M807     DC    AL1(0)                                                   00500000
M808     DC    AL1(0)                                                   00501000
M809     DC    AL1(0)                                                   00502000
M810     DC    AL1(0)                                                   00503000
M811     DC    AL1(0)                                                   00504000
M812     DC    AL1(0)                                                   00505000
M813     DC    AL1(0)                                                   00506000
M814     DC    AL1(0)                                                   00507000
M815     DC    AL1(0)                                                   00508000
M816     DC    AL1(0)                                                   00509000
M817     DC    AL1(0)                                                   00510000
M818     DC    AL1(0)                                                   00511000
M819     DC    AL1(0)                                                   00512000
M820     DC    AL1(0)                                                   00513000
M821     DC    AL1(0)                                                   00514000
M822     DC    AL1(0)                                                   00515000
M823     DC    AL1(0)                                                   00516000
M824     DC    AL1(0)                                                   00517000
M825     DC    AL1(0)                                                   00518000
M826     DC    AL1(0)                                                   00519000
M827     DC    AL1(0)                                                   00520000
M828     DC    AL1(0)                                                   00521000
M829     DC    AL1(0)                                                   00522000
M830     DC    AL1(0)                                                   00523000
M831     DC    AL1(0)                                                   00524000
M832     DC    AL1(0)                                                   00525000
M833     DC    AL1(0)                                                   00526000
M834     DC    AL1(0)                                                   00527000
M835     DC    AL1(0)                                                   00528000
M836     DC    AL1(0)                                                   00529000
M837     DC    AL1(0)                                                   00530000
M838     DC    AL1(0)                                                   00531000
M839     DC    AL1(0)                                                   00532000
M840     DC    AL1(0)                                                   00533000
M841     DC    AL1(0)                                                   00534000
M842     DC    AL1(0)                                                   00535000
M843     DC    AL1(0)                                                   00536000
M844     DC    AL1(0)                                                   00537000
M845     DC    AL1(0)                                                   00538000
M846     DC    AL1(0)                                                   00539000
M847     DC    AL1(0)                                                   00540000
M848     DC    AL1(0)                                                   00541000
M849     DC    AL1(0)                                                   00542000
M850     DC    AL1(0)                                                   00543000
M851     DC    AL1(0)                                                   00544000
M852     DC    AL1(0)                                                   00545000
M853     DC    AL1(0)                                                   00546000
M854     DC    AL1(0)                                                   00547000
M855     DC    AL1(0)                                                   00548000
M856     DC    AL1(0)                                                   00549000
M857     DC    AL1(0)                                                   00550000
M858     DC    AL1(0)                                                   00551000
M859     DC    AL1(0)                                                   00552000
M860     DC    AL1(0)                                                   00553000
M861     DC    AL1(0)                                                   00554000
M862     DC    AL1(0)                                                   00555000
M863     DC    AL1(0)                                                   00556000
M864     DC    AL1(0)                                                   00557000
M865     DC    AL1(0)                                                   00558000
M866     DC    AL1(0)                                                   00559000
M867     DC    AL1(0)                                                   00560000
M868     DC    AL1(0)                                                   00561000
M869     DC    AL1(0)                                                   00562000
M870     DC    AL1(0)                                                   00563000
M871     DC    AL1(0)                                                   00564000
M872     DC    AL1(0)                                                   00565000
M873     DC    AL1(0)                                                   00566000
M874     DC    AL1(0)                                                   00567000
M875     DC    AL1(0)                                                   00568000
M876     DC    AL1(0)                                                   00569000
M877     DC    AL1(0)                                                   00570000
M878     DC    AL1(0)                                                   00571000
M879     DC    AL1(0)                                                   00572000
M880     DC    AL1(0)                                                   00573000
M881     DC    AL1(0)                                                   00574000
M882     DC    AL1(0)                                                   00575000
M883     DC    AL1(0)                                                   00576000
M884     DC    AL1(0)                                                   00577000
M885     DC    AL1(0)                                                   00578000
M886     DC    AL1(0)                                                   00579000
M887     DC    AL1(0)                                                   00580000
M888     DC    AL1(0)                                                   00581000
M889     DC    AL1(0)                                                   00582000
M890     DC    AL1(0)                                                   00583000
M891     DC    AL1(0)                                                   00584000
M892     DC    AL1(0)                                                   00585000
M893     DC    AL1(0)                                                   00586000
M894     DC    AL1(0)                                                   00587000
M895     DC    AL1(0)                                                   00588000
M896     DC    AL1(0)                                                   00589000
M897     DC    AL1(0)                                                   00590000
M898     DC    AL1(0)                                                   00591000
M899     DC    AL1(48)                                                  00592000
@NM00007 DC    CL48'899I TOLTEP DATA SET NOT AUTHORIZED. LOAD FAILED'   00593000
M900     DC    AL1(0)                                                   00594000
M901     DC    AL1(49)                                                  00595000
@NM00008 DC    CL49'901I %%%%%%%% DDCARD FAILED TO OPEN ****ERROR****'  00596000
M902     DC    AL1(0)                                                   00597000
M903     DC    AL1(0)                                                   00598000
M904     DC    AL1(0)                                                   00599000
M905     DC    AL1(0)                                                   00600000
M906     DC    AL1(0)                                                   00601000
M907     DC    AL1(0)                                                   00602000
M908     DC    AL1(0)                                                   00603000
M909     DC    AL1(0)                                                   00604000
M910     DC    AL1(0)                                                   00605000
M911     DC    AL1(56)                                                  00606000
@NM00009 DC    CL56'911I CANNOT LOAD MODULE %%%%%%%%, INVALID CONTROL RC00607000
               ECORD'                                                   00608000
M912     DC    AL1(0)                                                   00609000
M913     DC    AL1(0)                                                   00610000
M914     DC    AL1(0)                                                   00611000
M915     DC    AL1(0)                                                   00612000
M916     DC    AL1(0)                                                   00613000
M917     DC    AL1(0)                                                   00614000
M918     DC    AL1(0)                                                   00615000
M919     DC    AL1(0)                                                   00616000
M920     DC    AL1(47)                                                  00617000
@NM00010 DC    CL47'920D MAY %%%%%%%% BE USED FOR TESTING-REPLY Y/N'    00618000
M921     DC    AL1(40)                                                  00619000
@NM00011 DC    CL40'921I ISTOLTEP MADE INACTIVE. %%%%%%%%%%%'           00620000
M922     DC    AL1(31)                                                  00621000
@NM00012 DC    CL31'922I VTAM ENDING. FORCED CANCEL'                    00622000
M923     DC    AL1(58)                                                  00623000
@NM00013 DC    CL58'923I %%%%%%%% CANNOT INVOKE ISTOLTEP. %%%%%%%%%%%%%C00624000
               %%%%%%%'                                                 00625000
M924     DC    AL1(30)                                                  00626000
@NM00014 DC    CL30'924I %%%%%%%% LOST TO ISTOLTEP'                     00627000
M925     DC    AL1(0)                                                   00628000
M926     DC    AL1(0)                                                   00629000
M927     DC    AL1(0)                                                   00630000
M928     DC    AL1(0)                                                   00631000
M929     DC    AL1(0)                                                   00632000
M930     DC    AL1(0)                                                   00633000
M931     DC    AL1(0)                                                   00634000
M932     DC    AL1(0)                                                   00635000
M933     DC    AL1(0)                                                   00636000
M934     DC    AL1(0)                                                   00637000
M935     DC    AL1(0)                                                   00638000
M936     DC    AL1(0)                                                   00639000
M937     DC    AL1(0)                                                   00640000
M938     DC    AL1(0)                                                   00641000
M939     DC    AL1(0)                                                   00642000
M940     DC    AL1(0)                                                   00643000
M941     DC    AL1(0)                                                   00644000
M942     DC    AL1(0)                                                   00645000
M943     DC    AL1(0)                                                   00646000
M944     DC    AL1(0)                                                   00647000
M945     DC    AL1(0)                                                   00648000
M946     DC    AL1(0)                                                   00649000
M947     DC    AL1(0)                                                   00650000
M948     DC    AL1(0)                                                   00651000
M949     DC    AL1(0)                                                   00652000
M950     DC    AL1(0)                                                   00653000
M951     DC    AL1(0)                                                   00654000
M952     DC    AL1(0)                                                   00655000
M953     DC    AL1(0)                                                   00656000
M954     DC    AL1(0)                                                   00657000
M955     DC    AL1(0)                                                   00658000
M956     DC    AL1(0)                                                   00659000
M957     DC    AL1(0)                                                   00660000
M958     DC    AL1(0)                                                   00661000
M959     DC    AL1(0)                                                   00662000
M960     DC    AL1(0)                                                   00663000
M961     DC    AL1(0)                                                   00664000
M962     DC    AL1(0)                                                   00665000
M963     DC    AL1(0)                                                   00666000
M964     DC    AL1(0)                                                   00667000
M965     DC    AL1(0)                                                   00668000
M966     DC    AL1(0)                                                   00669000
M967     DC    AL1(0)                                                   00670000
M968     DC    AL1(0)                                                   00671000
M969     DC    AL1(0)                                                   00672000
M970     DC    AL1(0)                                                   00673000
M971     DC    AL1(0)                                                   00674000
M972     DC    AL1(0)                                                   00675000
M973     DC    AL1(0)                                                   00676000
M974     DC    AL1(0)                                                   00677000
M975     DC    AL1(0)                                                   00678000
M976     DC    AL1(0)                                                   00679000
M977     DC    AL1(0)                                                   00680000
M978     DC    AL1(0)                                                   00681000
M979     DC    AL1(0)                                                   00682000
M980     DC    AL1(0)                                                   00683000
M981     DC    AL1(0)                                                   00684000
M982     DC    AL1(0)                                                   00685000
M983     DC    AL1(0)                                                   00686000
M984     DC    AL1(0)                                                   00687000
M985     DC    AL1(0)                                                   00688000
M986     DC    AL1(0)                                                   00689000
M987     DC    AL1(0)                                                   00690000
M988     DC    AL1(0)                                                   00691000
M989     DC    AL1(0)                                                   00692000
M990     DC    AL1(0)                                                   00693000
M991     DC    AL1(0)                                                   00694000
M992     DC    AL1(0)                                                   00695000
M993     DC    AL1(0)                                                   00696000
M994     DC    AL1(0)                                                   00697000
M995     DC    AL1(0)                                                   00698000
M996     DC    AL1(0)                                                   00699000
M997     DC    AL1(0)                                                   00700000
M998     DC    AL1(0)                                                   00701000
M999     DC    AL1(0)                                                   00702000
@NM00015 DS    0C                                                       00703000
         ORG   @NM00006+1259                                            00704000
         DS    CL1                                                      00705000
PATCH    DC    10F'0'                                                   00706000
@00      EQU   00                      EQUATES FOR REGISTERS 0-15       00707000
@01      EQU   01                                                       00708000
@02      EQU   02                                                       00709000
@03      EQU   03                                                       00710000
@04      EQU   04                                                       00711000
@05      EQU   05                                                       00712000
@06      EQU   06                                                       00713000
@07      EQU   07                                                       00714000
@08      EQU   08                                                       00715000
@09      EQU   09                                                       00716000
@10      EQU   10                                                       00717000
@11      EQU   11                                                       00718000
@12      EQU   12                                                       00719000
@13      EQU   13                                                       00720000
@14      EQU   14                                                       00721000
@15      EQU   15                                                       00722000
MSG#     EQU   @03                                                      00723000
MSGPTR   EQU   @05                                                      00724000
WAPTR    EQU   @02                                                      00725000
MSGDAT   EQU   0                                                        00726000
TOLTEPWA EQU   0                                                        00727000
$BUFFER  EQU   TOLTEPWA+1976                                            00728000
#EXITA   EQU   TOLTEPWA+2632                                            00729000
$CCOMDAT EQU   TOLTEPWA+2644                                            00730000
$COUTCT  EQU   $CCOMDAT+4                                               00731000
$CFLGS   EQU   $CCOMDAT+16                                              00732000
$24FEMSG EQU   TOLTEPWA+2681                                            00733000
$24CATMG EQU   $24FEMSG+11                                              00734000
@NM00003 EQU   TOLTEPWA+2776                                            00735000
$OUNTPTR EQU   @NM00003+4                                               00736000
$NSPTR   EQU   $OUNTPTR                                                 00737000
$NSCNT   EQU   @NM00003+10                                              00738000
$ENXX    EQU   @NM00003+15                                              00739000
$IMITX   EQU   $ENXX                                                    00740000
SVESC033 EQU   TOLTEPWA+3160                                            00741000
SVECC013 EQU   TOLTEPWA+3232                                            00742000
SVEIC003 EQU   TOLTEPWA+3592                                            00743000
SVESC022 EQU   TOLTEPWA+3736                                            00744000
SVECC011 EQU   TOLTEPWA+4024                                            00745000
#EXIT    EQU   0                                                        00746000
@NM00001 EQU   $BUFFER                                                  00747000
MSGNUM   EQU   @NM00001                                                 00748000
SVECC012 EQU   SVESC022                                                 00749000
SVEIC00A EQU   SVEIC003                                                 00750000
SVEIC004 EQU   SVEIC003                                                 00751000
SVEIC005 EQU   SVEIC003                                                 00752000
SVESC02A EQU   SVESC022                                                 00753000
SVESC02B EQU   SVESC022                                                 00754000
SVESC02D EQU   SVESC022                                                 00755000
SVESC02E EQU   SVESC022                                                 00756000
SVESC02F EQU   SVECC013                                                 00757000
SVESC024 EQU   SVESC022                                                 00758000
SVESC027 EQU   SVESC022                                                 00759000
SVESC029 EQU   SVESC033                                                 00760000
SVESC031 EQU   SVECC013                                                 00761000
SVESC032 EQU   SVECC011                                                 00762000
SVETC037 EQU   SVEIC003                                                 00763000
         AGO   .@UNREFD                START UNREFERENCED COMPONENTS    00764000
SVECC010 EQU   TOLTEPWA+3952                                            00765000
SVETC035 EQU   TOLTEPWA+3880                                            00766000
SVESC030 EQU   TOLTEPWA+3808                                            00767000
SVESC020 EQU   TOLTEPWA+3664                                            00768000
SVEIC002 EQU   TOLTEPWA+3520                                            00769000
SVECC014 EQU   TOLTEPWA+3376                                            00770000
SVESC120 EQU   TOLTEPWA+3304                                            00771000
SVESC025 EQU   TOLTEPWA+3088                                            00772000
@NM00005 EQU   TOLTEPWA+2980                                            00773000
$RPLERR  EQU   TOLTEPWA+2977                                            00774000
@NM00004 EQU   TOLTEPWA+2976                                            00775000
$R13PR3  EQU   TOLTEPWA+2972                                            00776000
$CEINT2  EQU   TOLTEPWA+2968                                            00777000
$CEINT1  EQU   TOLTEPWA+2964                                            00778000
$MSGGET  EQU   TOLTEPWA+2960                                            00779000
$ACQLIST EQU   TOLTEPWA+2956                                            00780000
$R4SAVE1 EQU   TOLTEPWA+2952                                            00781000
$CLSISS  EQU   TOLTEPWA+2950                                            00782000
$CLSCNT  EQU   TOLTEPWA+2948                                            00783000
$CUTABLE EQU   TOLTEPWA+2868                                            00784000
$BUFSZ2  EQU   TOLTEPWA+2864                                            00785000
$RESID2  EQU   TOLTEPWA+2860                                            00786000
$OLTCCW2 EQU   TOLTEPWA+2856                                            00787000
$ENDBFR2 EQU   TOLTEPWA+2852                                            00788000
$1STBFR2 EQU   TOLTEPWA+2848                                            00789000
$TECB2   EQU   TOLTEPWA+2844                                            00790000
$BUFSZ1  EQU   TOLTEPWA+2840                                            00791000
$RESID1  EQU   TOLTEPWA+2836                                            00792000
$OLTCCW1 EQU   TOLTEPWA+2832                                            00793000
$ENDBFR1 EQU   TOLTEPWA+2828                                            00794000
$1STBFR1 EQU   TOLTEPWA+2824                                            00795000
$TECB1   EQU   TOLTEPWA+2820                                            00796000
$WAITIME EQU   TOLTEPWA+2816                                            00797000
$TRTN#   EQU   TOLTEPWA+2815                                            00798000
$WIODEV  EQU   TOLTEPWA+2814                                            00799000
$RQSTSZE EQU   TOLTEPWA+2812                                            00800000
$RQSTPTR EQU   TOLTEPWA+2808                                            00801000
$R4SAVE  EQU   TOLTEPWA+2804                                            00802000
$PARTADR EQU   TOLTEPWA+2800                                            00803000
$TBSDATA EQU   TOLTEPWA+2796                                            00804000
$CTWIDTH EQU   TOLTEPWA+2795                                            00805000
$CTLINE  EQU   TOLTEPWA+2794                                            00806000
$APWIDTH EQU   TOLTEPWA+2793                                            00807000
$APLINE  EQU   TOLTEPWA+2792                                            00808000
$INDEX   EQU   $IMITX                                                   00809000
$UMXX    EQU   @NM00003+14                                              00810000
$NSXX    EQU   @NM00003+12                                              00811000
$ATACNT  EQU   $NSCNT                                                   00812000
$CTR     EQU   @NM00003+8                                               00813000
$ATAPTR  EQU   $NSPTR                                                   00814000
$DDRPTR  EQU   @NM00003                                                 00815000
$DTORESP EQU   TOLTEPWA+2712                                            00816000
$APNAME  EQU   TOLTEPWA+2704                                            00817000
$24SYMNE EQU   $24CATMG+4                                               00818000
$24DEVAD EQU   $24CATMG                                                 00819000
$24RTN#  EQU   $24FEMSG+8                                               00820000
$ESECTID EQU   $24FEMSG                                                 00821000
$24FLGS  EQU   TOLTEPWA+2680                                            00822000
$24SAVE2 EQU   TOLTEPWA+2676                                            00823000
$24SAVE1 EQU   TOLTEPWA+2672                                            00824000
$24UNADR EQU   TOLTEPWA+2668                                            00825000
$24SAV13 EQU   TOLTEPWA+2664                                            00826000
$24RETCD EQU   TOLTEPWA+2663                                            00827000
$MACID   EQU   TOLTEPWA+2661                                            00828000
$CSPARE  EQU   $CFLGS                                                   00829000
$C2WAY   EQU   $CFLGS                                                   00830000
$CINCT   EQU   $CCOMDAT+12                                              00831000
$CINADR  EQU   $CCOMDAT+8                                               00832000
$COUTAD  EQU   $CCOMDAT                                                 00833000
ROOTLOC  EQU   TOLTEPWA+2640                                            00834000
$RETREG  EQU   TOLTEPWA+2636                                            00835000
$WORK    EQU   TOLTEPWA+2376                                            00836000
$EXTA    EQU   TOLTEPWA+2320                                            00837000
$PASSONA EQU   TOLTEPWA+2264                                            00838000
$TRMINPT EQU   TOLTEPWA+2184                                            00839000
$INBUFR  EQU   TOLTEPWA+2104                                            00840000
$TLTRPL3 EQU   TOLTEPWA+1856                                            00841000
$TLTRPL2 EQU   TOLTEPWA+1736                                            00842000
$TLTRPL1 EQU   TOLTEPWA+1616                                            00843000
$SLTBL   EQU   TOLTEPWA+1468                                            00844000
@NM00002 EQU   TOLTEPWA+1464                                            00845000
$DEVTBLE EQU   TOLTEPWA+240                                             00846000
$COMMFLG EQU   TOLTEPWA+224                                             00847000
$CDA     EQU   TOLTEPWA+100                                             00848000
$SCTTBLE EQU   TOLTEPWA                                                 00849000
.@UNREFD ANOP                          END UNREFERENCED COMPONENTS      00850000
@ENDDATA EQU   *                                                        00851000
         END   ISTEC789,(C'PLS1225',0702,78336)                         00852000
./  ADD  SSI=91290787,NAME=ISTIC00A
         TITLE 'ISTIC00A,PROMPT - IT PROMPTS USER FOR CDS INFO'         00001000
ISTIC00A CSECT ,                                                   0001 00002000
@MAINENT DS    0H                                                  0001 00003000
         USING *,@15                                               0001 00004000
         B     @PROLOG                                             0001 00005000
         DC    AL1(16)                                             0001 00006000
         DC    C'ISTIC00A  79.129'                                 0001 00007000
         DROP  @15                                                      00008000
@PROLOG  ST    @14,12(,@13)                                        0001 00009000
         STM   @00,@12,20(@13)                                     0001 00010000
         BALR  @11,0                                               0001 00011000
@PSTART  DS    0H                                                  0001 00012000
         USING @PSTART,@11                                         0001 00013000
         ST    @13,@SA00001+4                                      0001 00014000
         LA    @12,@SA00001                                        0001 00015000
         ST    @12,8(,@13)                                         0001 00016000
         LR    @13,@12                                             0001 00017000
         EJECT                                                          00018000
         EJECT                                                          00019000
         EJECT                                                          00020000
I00AC01  DS    0H                                                  0096 00021000
*   I00ACWK=$LOWADDR;               /* SET UP BASE FOR SWITHES       */ 00022000
         L     @15,$LOWADDR(,WAPTR)                                0096 00023000
         ST    @15,I00ACWK                                         0096 00024000
*   CDSWKPTR=I00ACWK+80;            /* SET UP BASE FOR CDS WK        */ 00025000
         AL    @15,@CF00050                                        0097 00026000
         ST    @15,CDSWKPTR                                        0097 00027000
*   TOADRPTR=ADDR(CDSEXARA)+256;    /* SET UP TOADDR BASE            */ 00028000
         LA    @15,CDSEXARA(,@15)                                  0098 00029000
         AL    @15,@CF00084                                        0098 00030000
         ST    @15,TOADRPTR                                        0098 00031000
*   $INBUFR(1:1+LENGTH($INBUFR)-1)='';/* BLANK OUT IN BUFFER ENTER 0099 00032000
*                                      CDS PARM OR PROMPT            */ 00033000
         MVI   $INBUFR(WAPTR),C' '                                 0099 00034000
         MVC   $INBUFR+1(79,WAPTR),$INBUFR(WAPTR)                  0099 00035000
*   IF $COPY='1'B THEN              /* IF THIS IS A COPY REQUEST     */ 00036000
         TM    $COPY(WAPTR),B'00001000'                            0100 00037000
         BO    @RT00100                                            0100 00038000
*     GOTO I00AC01C;                /* THEN BR AROUND                */ 00039000
*                                                                  0101 00040000
*   /*****************************************************************/ 00041000
*   /*                                                               */ 00042000
*   /* TCEC MSGN(580)INCT(61)MSGMSK('80000000'X) INVOKED             */ 00043000
*   /*                                                               */ 00044000
*   /*****************************************************************/ 00045000
*                                                                  0102 00046000
*   $TCECM='1'B;                    /* SET TCEC SW IN RCA            */ 00047000
         OI    $TCECM(WAPTR),B'00000001'                           0102 00048000
*   R1=ADDR($TCA09);                /* SET UP PARM LIST $TR          */ 00049000
         LA    R1,$TCA09                                           0103 00050000
*   CALL S20CEC03;                  /* CALL TCEC-MULTIPLE LN         */ 00051000
         L     @15,@CV00781                                        0104 00052000
         BALR  @14,@15                                             0104 00053000
*   DCL                                                            0105 00054000
*     1 $TCA09,                     /* TCEC PARM LIST                */ 00055000
*      2 $TCB09 FIXED(32) INIT(580),/* MSG NUMBER                    */ 00056000
*      2 $TCC09 FIXED(32) INIT(61), /* INCT LEN                      */ 00057000
*      2 $TCD09 BIT(8) INIT('01000000'B),/* FLAG                     */ 00058000
*      2 $TCE09 CHAR(4) INIT('80000000'X);/* MSSAGE MASK             */ 00059000
*   IF PROMPT¬=$INBUFR(2:2) THEN    /* IF PROMPT WAS NOT REQUESTED   */ 00060000
         CLC   PROMPT(1),$INBUFR+1(WAPTR)                          0106 00061000
         BNE   @RT00106                                            0106 00062000
*     GOTO I00AC03;                 /* THEN BR AROUND PROMPT RTN     */ 00063000
*   IF $REMSW='1'B                  /* IF THIS IS A REMOTE ADD       */ 00064000
*     THEN                          /* REQUEST THEN PRINT PROMPT     */ 00065000
         TM    $REMSW(WAPTR),B'01000000'                           0108 00066000
         BNO   @RF00108                                            0108 00067000
*     DO;                           /* MESSAGES MINUS THE SYMB NME   */ 00068000
*                                                                  0109 00069000
*       /*************************************************************/ 00070000
*       /*                                                           */ 00071000
*       /* TCEC MSGN(580)MSGMSK('3FDFFC00'X) INVOKED                 */ 00072000
*       /*                                                           */ 00073000
*       /*************************************************************/ 00074000
*                                                                  0110 00075000
*       $TCECM='1'B;                /* SET TCEC SW IN RCA            */ 00076000
         OI    $TCECM(WAPTR),B'00000001'                           0110 00077000
*       R1=ADDR($TCA10);            /* SET UP PARM LIST $TR          */ 00078000
         LA    R1,$TCA10                                           0111 00079000
*       CALL S20CEC03;              /* CALL TCEC-MULTIPLE LN         */ 00080000
         L     @15,@CV00781                                        0112 00081000
         BALR  @14,@15                                             0112 00082000
*       DCL                                                        0113 00083000
*         1 $TCA10,                 /* TCEC PARM LIST                */ 00084000
*          2 $TCB10 FIXED(32) INIT(580),/* MSG NUMBER                */ 00085000
*          2 $TCC10 FIXED(32) INIT(0),/* INCT LEN                    */ 00086000
*          2 $TCD10 BIT(8) INIT('00000000'B),/* FLAG                 */ 00087000
*          2 $TCE10 CHAR(4) INIT('3FDFFC00'X);/* MSSAGE MASK         */ 00088000
*     END;                                                         0114 00089000
*   ELSE                            /* OTHERWISE PRINT THE PROMPT    */ 00090000
*     DO;                           /* MSG MINUS THE LINE ADR MSG    */ 00091000
*                                                                  0115 00092000
         B     @RC00108                                            0115 00093000
@RF00108 DS    0H                                                  0116 00094000
*       /*************************************************************/ 00095000
*       /*                                                           */ 00096000
*       /* TCEC MSGN(580)MSGMSK('3FBFFC00'X) INVOKED                 */ 00097000
*       /*                                                           */ 00098000
*       /*************************************************************/ 00099000
*                                                                  0116 00100000
*       $TCECM='1'B;                /* SET TCEC SW IN RCA            */ 00101000
         OI    $TCECM(WAPTR),B'00000001'                           0116 00102000
*       R1=ADDR($TCA11);            /* SET UP PARM LIST $TR          */ 00103000
         LA    R1,$TCA11                                           0117 00104000
*       CALL S20CEC03;              /* CALL TCEC-MULTIPLE LN         */ 00105000
         L     @15,@CV00781                                        0118 00106000
         BALR  @14,@15                                             0118 00107000
*       DCL                                                        0119 00108000
*         1 $TCA11,                 /* TCEC PARM LIST                */ 00109000
*          2 $TCB11 FIXED(32) INIT(580),/* MSG NUMBER                */ 00110000
*          2 $TCC11 FIXED(32) INIT(0),/* INCT LEN                    */ 00111000
*          2 $TCD11 BIT(8) INIT('00000000'B),/* FLAG                 */ 00112000
*          2 $TCE11 CHAR(4) INIT('3FBFFC00'X);/* MSSAGE MASK         */ 00113000
*     END;                                                         0120 00114000
*I00AC01B:                                                         0121 00115000
*   INDX1=HWONE;                    /* SET UP INDEX VALUE            */ 00116000
@RC00108 DS    0H                                                  0121 00117000
I00AC01B MVC   INDX1(2),HWONE                                      0121 00118000
*   GOTO I00AC01;                   /* GO GET CDS PARAMETERS         */ 00119000
         B     I00AC01                                             0122 00120000
*I00AC01C:                                                         0123 00121000
*                                                                  0123 00122000
*   /*****************************************************************/ 00123000
*   /*                                                               */ 00124000
*   /* TCEC MSGN(582)INCT(61)MSGMSK('80000000'X) INVOKED             */ 00125000
*   /*                                                               */ 00126000
*   /*****************************************************************/ 00127000
*                                                                  0123 00128000
*   $TCECM='1'B;                    /* SET TCEC SW IN RCA            */ 00129000
I00AC01C OI    $TCECM(WAPTR),B'00000001'                           0123 00130000
*   R1=ADDR($TCA12);                /* SET UP PARM LIST $TR          */ 00131000
         LA    R1,$TCA12                                           0124 00132000
*   CALL S20CEC03;                  /* CALL TCEC-MULTIPLE LN         */ 00133000
         L     @15,@CV00781                                        0125 00134000
         BALR  @14,@15                                             0125 00135000
*   DCL                                                            0126 00136000
*     1 $TCA12,                     /* TCEC PARM LIST                */ 00137000
*      2 $TCB12 FIXED(32) INIT(582),/* MSG NUMBER                    */ 00138000
*      2 $TCC12 FIXED(32) INIT(61), /* INCT LEN                      */ 00139000
*      2 $TCD12 BIT(8) INIT('01000000'B),/* FLAG                     */ 00140000
*      2 $TCE12 CHAR(4) INIT('80000000'X);/* MSSAGE MASK ENTER SYM 0126 00141000
*                                      NME OR CUA                    */ 00142000
*I00AC01D:                                                         0127 00143000
*   INDX1=HWONE;                    /* GET PTR TO ENTRY              */ 00144000
I00AC01D SLR   @15,@15                                             0127 00145000
         ICM   @15,3,HWONE                                         0127 00146000
         STH   @15,INDX1                                           0127 00147000
*   IF $REMSW='1'B                  /* IF THIS IS A REMOTE REQUEST   */ 00148000
*     THEN                                                         0128 00149000
         TM    $REMSW(WAPTR),B'01000000'                           0128 00150000
         BNO   @RF00128                                            0128 00151000
*     DO;                           /* THEN VALIDITY CK ENTRY        */ 00152000
*       IF $INBUFR(INDX1+1:INDX1+LENGTH(SYMNME))=SYMNME THEN       0130 00153000
         ALR   @15,WAPTR                                           0130 00154000
         CLC   $INBUFR(3,@15),SYMNME                               0130 00155000
         BE    @RT00130                                            0130 00156000
*         GOTO I00AC09A;                                           0131 00157000
*                                                                  0131 00158000
*       /*************************************************************/ 00159000
*       /*                                                           */ 00160000
*       /* TCEC MSGN(581)MSGMSK('02000000'X) INVOKED                 */ 00161000
*       /*                                                           */ 00162000
*       /*************************************************************/ 00163000
*                                                                  0132 00164000
*       $TCECM='1'B;                /* SET TCEC SW IN RCA            */ 00165000
         OI    $TCECM(WAPTR),B'00000001'                           0132 00166000
*       R1=ADDR($TCA13);            /* SET UP PARM LIST $TR          */ 00167000
         LA    R1,$TCA13                                           0133 00168000
*       CALL S20CEC03;              /* CALL TCEC-MULTIPLE LN         */ 00169000
         L     @15,@CV00781                                        0134 00170000
         BALR  @14,@15                                             0134 00171000
*       DCL                                                        0135 00172000
*         1 $TCA13,                 /* TCEC PARM LIST                */ 00173000
*          2 $TCB13 FIXED(32) INIT(581),/* MSG NUMBER                */ 00174000
*          2 $TCC13 FIXED(32) INIT(0),/* INCT LEN                    */ 00175000
*          2 $TCD13 BIT(8) INIT('00000000'B),/* FLAG                 */ 00176000
*          2 $TCE13 CHAR(4) INIT('02000000'X);/* MSSAGE MASK INVALID    00177000
*                                      ENTRY                         */ 00178000
*       GOTO I00AC01;               /* BR BACK AND TRY AGAIN         */ 00179000
         B     I00AC01                                             0136 00180000
*     END;                                                         0137 00181000
*   ELSE                                                           0138 00182000
*     DO;                           /* VALIDITY CK CUA ENTRY         */ 00183000
@RF00128 DS    0H                                                  0139 00184000
*       IF $INBUFR(INDX1+1:INDX1+LENGTH(UADR))=UADR THEN           0139 00185000
         LH    @15,INDX1                                           0139 00186000
         N     @15,@CF00965                                        0139 00187000
         ALR   @15,WAPTR                                           0139 00188000
         CLC   $INBUFR(3,@15),UADR                                 0139 00189000
         BE    @RT00139                                            0139 00190000
*         GOTO I00AC08A;            /* IF OK THEN BR AROUND          */ 00191000
*                                                                  0140 00192000
*       /*************************************************************/ 00193000
*       /*                                                           */ 00194000
*       /* TCEC MSGN(581)MSGMSK('04000000'X) INVOKED                 */ 00195000
*       /*                                                           */ 00196000
*       /*************************************************************/ 00197000
*                                                                  0141 00198000
*       $TCECM='1'B;                /* SET TCEC SW IN RCA            */ 00199000
         OI    $TCECM(WAPTR),B'00000001'                           0141 00200000
*       R1=ADDR($TCA14);            /* SET UP PARM LIST $TR          */ 00201000
         LA    R1,$TCA14                                           0142 00202000
*       CALL S20CEC03;              /* CALL TCEC-MULTIPLE LN         */ 00203000
         L     @15,@CV00781                                        0143 00204000
         BALR  @14,@15                                             0143 00205000
*       DCL                                                        0144 00206000
*         1 $TCA14,                 /* TCEC PARM LIST                */ 00207000
*          2 $TCB14 FIXED(32) INIT(581),/* MSG NUMBER                */ 00208000
*          2 $TCC14 FIXED(32) INIT(0),/* INCT LEN                    */ 00209000
*          2 $TCD14 BIT(8) INIT('00000000'B),/* FLAG                 */ 00210000
*          2 $TCE14 CHAR(4) INIT('04000000'X);/* MSSAGE MASK INVALID    00211000
*                                      ENTRY                         */ 00212000
*       GOTO I00AC01;               /* BR BACK AND TRY AGAIN         */ 00213000
         B     I00AC01                                             0145 00214000
*     END;                                                         0146 00215000
*   GEN(EJECT);                                                    0147 00216000
         EJECT                                                          00217000
*I00AC02:                           /* CONTINUE ENTER'G CDS DATA     */ 00218000
*   $INBUFR(1:1+LENGTH($INBUFR)-1)='';/* ZERO OUT BUFFER             */ 00219000
*                                                                  0148 00220000
I00AC02  MVI   $INBUFR(WAPTR),C' '                                 0148 00221000
         MVC   $INBUFR+1(79,WAPTR),$INBUFR(WAPTR)                  0148 00222000
*   /*****************************************************************/ 00223000
*   /*                                                               */ 00224000
*   /* TCEC MSGN(580)INCT(61)MSGMSK('40000000'X) INVOKED             */ 00225000
*   /*                                                               */ 00226000
*   /*****************************************************************/ 00227000
*                                                                  0149 00228000
*   $TCECM='1'B;                    /* SET TCEC SW IN RCA            */ 00229000
         OI    $TCECM(WAPTR),B'00000001'                           0149 00230000
*   R1=ADDR($TCA15);                /* SET UP PARM LIST $TR          */ 00231000
         LA    R1,$TCA15                                           0150 00232000
*   CALL S20CEC03;                  /* CALL TCEC-MULTIPLE LN         */ 00233000
         L     @15,@CV00781                                        0151 00234000
         BALR  @14,@15                                             0151 00235000
*   DCL                                                            0152 00236000
*     1 $TCA15,                     /* TCEC PARM LIST                */ 00237000
*      2 $TCB15 FIXED(32) INIT(580),/* MSG NUMBER                    */ 00238000
*      2 $TCC15 FIXED(32) INIT(61), /* INCT LEN                      */ 00239000
*      2 $TCD15 BIT(8) INIT('01000000'B),/* FLAG                     */ 00240000
*      2 $TCE15 CHAR(4) INIT('40000000'X);/* MSSAGE MASK             */ 00241000
*I00AC03:                                                          0153 00242000
*   INDX1=HWONE;                    /* SET UP INDEX VALUE            */ 00243000
I00AC03  MVC   INDX1(2),HWONE                                      0153 00244000
*I00AC03A:                                                         0154 00245000
*   IF $INBUFR(INDX1+1:INDX1+LENGTH(MODEL))¬=MODEL THEN            0154 00246000
I00AC03A LH    @15,INDX1                                           0154 00247000
         N     @15,@CF00965                                        0154 00248000
         ALR   @15,WAPTR                                           0154 00249000
         CLC   $INBUFR(2,@15),MODEL                                0154 00250000
         BNE   @RT00154                                            0154 00251000
*     GOTO I00AC04;                 /* IF NOT MODEL ENTRY-BR         */ 00252000
*   GEN(BAL LINKR,I00ACLEN);        /* GO GET LENGTH OF MODEL I/P    */ 00253000
         BAL LINKR,I00ACLEN                                             00254000
*   IF IPLEN¬=MLNGTH THEN           /* IF IT DOESN'T = EXPECTED      */ 00255000
         CLC   IPLEN(1),MLNGTH                                     0157 00256000
         BNE   @RT00157                                            0157 00257000
*     GOTO I00AC03B;                /* THEN BR AND PRINT ERROR       */ 00258000
*   GEN(BAL LINKR,I00ACONV);        /* OTHERWISE CONVERT IT          */ 00259000
         BAL LINKR,I00ACONV                                             00260000
*   IF R15¬=0 THEN                  /* IF IT DID NOT CNV OK THEN     */ 00261000
         LTR   R15,R15                                             0160 00262000
         BNZ   @RT00160                                            0160 00263000
*     GOTO I00AC03B;                /* WE MUST HAVE INVALID I/P-BR   */ 00264000
*   CDSMODEL=TOADR(1:1);            /* SET UP MODEL FLD-CNV OK       */ 00265000
         L     @15,TOADRPTR                                        0162 00266000
         IC    @12,TOADR(,@15)                                     0162 00267000
         L     @15,CDSWKPTR                                        0162 00268000
         STC   @12,CDSMODEL(,@15)                                  0162 00269000
*   IF CONTSCAN='0'B THEN           /* IF CONT SCAN SW IS NOT ON     */ 00270000
         L     @15,I00ACWK                                         0163 00271000
         TM    CONTSCAN(@15),B'10000000'                           0163 00272000
         BZ    @RT00163                                            0163 00273000
*     GOTO I00AC02;                 /* THEN GO GET NXT LINE DATA     */ 00274000
*   CONTSCAN='0'B;                  /* OTHERWISE RESET SWITCH AND    */ 00275000
         NI    CONTSCAN(@15),B'01111111'                           0165 00276000
*   GOTO I00AC03A;                  /* CONTINUE ON                   */ 00277000
         B     I00AC03A                                            0166 00278000
*I00AC03B:                                                         0167 00279000
*                                                                  0167 00280000
*   /*****************************************************************/ 00281000
*   /*                                                               */ 00282000
*   /* TCEC MSGN(581)MSGMSK('80000000'X) INVOKED                     */ 00283000
*   /*                                                               */ 00284000
*   /*****************************************************************/ 00285000
*                                                                  0167 00286000
*   $TCECM='1'B;                    /* SET TCEC SW IN RCA            */ 00287000
I00AC03B OI    $TCECM(WAPTR),B'00000001'                           0167 00288000
*   R1=ADDR($TCA16);                /* SET UP PARM LIST $TR          */ 00289000
         LA    R1,$TCA16                                           0168 00290000
*   CALL S20CEC03;                  /* CALL TCEC-MULTIPLE LN         */ 00291000
         L     @15,@CV00781                                        0169 00292000
         BALR  @14,@15                                             0169 00293000
*   DCL                                                            0170 00294000
*     1 $TCA16,                     /* TCEC PARM LIST                */ 00295000
*      2 $TCB16 FIXED(32) INIT(581),/* MSG NUMBER                    */ 00296000
*      2 $TCC16 FIXED(32) INIT(0),  /* INCT LEN                      */ 00297000
*      2 $TCD16 BIT(8) INIT('00000000'B),/* FLAG                     */ 00298000
*      2 $TCE16 CHAR(4) INIT('80000000'X);/* MSSAGE MASK INVALID   0170 00299000
*                                      MODEL FLD                     */ 00300000
*   GOTO I00AC01;                   /* GO GET ENTIRE LAST LINE       */ 00301000
         B     I00AC01                                             0171 00302000
*I00AC04:                                                          0172 00303000
*   IF $INBUFR(INDX1+1:INDX1+LENGTH(FEAT))¬=FEAT THEN              0172 00304000
I00AC04  LH    @15,INDX1                                           0172 00305000
         N     @15,@CF00965                                        0172 00306000
         ALR   @15,WAPTR                                           0172 00307000
         CLC   $INBUFR(2,@15),FEAT                                 0172 00308000
         BNE   @RT00172                                            0172 00309000
*     GOTO I00AC05;                 /* IF NOT FEAT ENTRY BE          */ 00310000
*   GEN(BAL LINKR,I00ACLEN);        /* GO GET LENGTH OF FEAT I/P     */ 00311000
         BAL LINKR,I00ACLEN                                             00312000
*   IF IPLEN¬=FLNGTH THEN           /* IF IT DOESN'T = EXPECTED      */ 00313000
         CLC   IPLEN(1),FLNGTH                                     0175 00314000
         BNE   @RT00175                                            0175 00315000
*     GOTO I00AC04A;                /* THEN BR AND PRINT ERROR       */ 00316000
*   GEN(BAL LINKR,I00ACONV);        /* OTHERWISE CONVERT IT          */ 00317000
         BAL LINKR,I00ACONV                                             00318000
*   IF R15¬=0 THEN                  /* IF IT DID NOT CNV OK THEN     */ 00319000
         LTR   R15,R15                                             0178 00320000
         BNZ   @RT00178                                            0178 00321000
*     GOTO I00AC04A;                /* WE MUST HAVE INVALID I/P-BR   */ 00322000
*   CDSFEAT=TOADR(1:1);             /* SET UP REATURE FLD-CNV OK     */ 00323000
         L     @15,TOADRPTR                                        0180 00324000
         IC    @12,TOADR(,@15)                                     0180 00325000
         L     @15,CDSWKPTR                                        0180 00326000
         STC   @12,CDSFEAT(,@15)                                   0180 00327000
*   IF CONTSCAN='0'B THEN           /* IF CONT SCAN SW IS NOT ON     */ 00328000
         L     @15,I00ACWK                                         0181 00329000
         TM    CONTSCAN(@15),B'10000000'                           0181 00330000
         BZ    @RT00181                                            0181 00331000
*     GOTO I00AC02;                 /* THEN GO GET NXT LINE DATA     */ 00332000
*   CONTSCAN='0'B;                  /* OTHERWISE RESET SWITCH AND    */ 00333000
         NI    CONTSCAN(@15),B'01111111'                           0183 00334000
*   GOTO I00AC03A;                  /* CONTINUE ON                   */ 00335000
         B     I00AC03A                                            0184 00336000
*I00AC04A:                                                         0185 00337000
*                                                                  0185 00338000
*   /*****************************************************************/ 00339000
*   /*                                                               */ 00340000
*   /* TCEC MSGN(581)MSGMSK('40000000'X) INVOKED                     */ 00341000
*   /*                                                               */ 00342000
*   /*****************************************************************/ 00343000
*                                                                  0185 00344000
*   $TCECM='1'B;                    /* SET TCEC SW IN RCA            */ 00345000
I00AC04A OI    $TCECM(WAPTR),B'00000001'                           0185 00346000
*   R1=ADDR($TCA17);                /* SET UP PARM LIST $TR          */ 00347000
         LA    R1,$TCA17                                           0186 00348000
*   CALL S20CEC03;                  /* CALL TCEC-MULTIPLE LN         */ 00349000
         L     @15,@CV00781                                        0187 00350000
         BALR  @14,@15                                             0187 00351000
*   DCL                                                            0188 00352000
*     1 $TCA17,                     /* TCEC PARM LIST                */ 00353000
*      2 $TCB17 FIXED(32) INIT(581),/* MSG NUMBER                    */ 00354000
*      2 $TCC17 FIXED(32) INIT(0),  /* INCT LEN                      */ 00355000
*      2 $TCD17 BIT(8) INIT('00000000'B),/* FLAG                     */ 00356000
*      2 $TCE17 CHAR(4) INIT('40000000'X);/* MSSAGE MASK INVALID FEAT   00357000
*                                      FLD                           */ 00358000
*   GOTO I00AC01;                   /* GO GET ENTIRE LAST LINE       */ 00359000
         B     I00AC01                                             0189 00360000
*I00AC05:                                                          0190 00361000
*   IF $INBUFR(INDX1+1:INDX1+LENGTH(CLASS))¬=CLASS THEN            0190 00362000
I00AC05  LH    @15,INDX1                                           0190 00363000
         N     @15,@CF00965                                        0190 00364000
         ALR   @15,WAPTR                                           0190 00365000
         CLC   $INBUFR(2,@15),CLASS                                0190 00366000
         BNE   @RT00190                                            0190 00367000
*     GOTO I00AC06;                 /* IF NOT CLASS ENTRY - BR       */ 00368000
*   GEN(BAL LINKR,I00ACLEN);        /* GO GET LENGTH OF FEAT I/P     */ 00369000
         BAL LINKR,I00ACLEN                                             00370000
*   IF IPLEN¬=CLNGTH THEN           /* IF IT DOESN'T = EXPECTED      */ 00371000
         CLC   IPLEN(1),CLNGTH                                     0193 00372000
         BNE   @RT00193                                            0193 00373000
*     GOTO I00AC05A;                /* THEN BR AND PRINT ERROR       */ 00374000
*   GEN(BAL LINKR,I00ACONV);        /* OTHERWISE CONVERT IT          */ 00375000
         BAL LINKR,I00ACONV                                             00376000
*   IF R15¬=0 THEN                  /* IF IT DID NOT CNV OK THEN     */ 00377000
         LTR   R15,R15                                             0196 00378000
         BNZ   @RT00196                                            0196 00379000
*     GOTO I00AC05A;                /* WE MUST HAVE INVALID I/P-BR   */ 00380000
*   CDSCLASS=TOADR(1:1);            /* SET UP CLASS FLD-CONV OK      */ 00381000
         L     @15,TOADRPTR                                        0198 00382000
         IC    @12,TOADR(,@15)                                     0198 00383000
         L     @15,CDSWKPTR                                        0198 00384000
         STC   @12,CDSCLASS(,@15)                                  0198 00385000
*   CLASSSW='1'B;                   /* TURN ON CLASS SW              */ 00386000
         L     @15,I00ACWK                                         0199 00387000
         OI    CLASSSW(@15),B'01000000'                            0199 00388000
*   IF CONTSCAN='0'B THEN           /* IF CONT SCAN SW IS NOT ON     */ 00389000
         TM    CONTSCAN(@15),B'10000000'                           0200 00390000
         BZ    @RT00200                                            0200 00391000
*     GOTO I00AC02;                 /* THEN GO GET NXT LINE DATA     */ 00392000
*   CONTSCAN='0'B;                  /* OTHERWISE RESET SWITCH AND    */ 00393000
         NI    CONTSCAN(@15),B'01111111'                           0202 00394000
*   GOTO I00AC03A;                  /* CONTINUE ON                   */ 00395000
         B     I00AC03A                                            0203 00396000
*I00AC05A:                                                         0204 00397000
*                                                                  0204 00398000
*   /*****************************************************************/ 00399000
*   /*                                                               */ 00400000
*   /* TCEC MSGN(581)MSGMSK('20000000'X) INVOKED                     */ 00401000
*   /*                                                               */ 00402000
*   /*****************************************************************/ 00403000
*                                                                  0204 00404000
*   $TCECM='1'B;                    /* SET TCEC SW IN RCA            */ 00405000
I00AC05A OI    $TCECM(WAPTR),B'00000001'                           0204 00406000
*   R1=ADDR($TCA18);                /* SET UP PARM LIST $TR          */ 00407000
         LA    R1,$TCA18                                           0205 00408000
*   CALL S20CEC03;                  /* CALL TCEC-MULTIPLE LN         */ 00409000
         L     @15,@CV00781                                        0206 00410000
         BALR  @14,@15                                             0206 00411000
*   DCL                                                            0207 00412000
*     1 $TCA18,                     /* TCEC PARM LIST                */ 00413000
*      2 $TCB18 FIXED(32) INIT(581),/* MSG NUMBER                    */ 00414000
*      2 $TCC18 FIXED(32) INIT(0),  /* INCT LEN                      */ 00415000
*      2 $TCD18 BIT(8) INIT('00000000'B),/* FLAG                     */ 00416000
*      2 $TCE18 CHAR(4) INIT('20000000'X);/* MSSAGE MASK INVALID   0207 00417000
*                                      CLASS FLD                     */ 00418000
*   GOTO I00AC01;                   /* GO GET ENTIRE LAST LINE       */ 00419000
         B     I00AC01                                             0208 00420000
*I00AC06:                                                          0209 00421000
*   IF $INBUFR(INDX1+1:INDX1+LENGTH(TYPE))¬=TYPE THEN              0209 00422000
I00AC06  LH    @15,INDX1                                           0209 00423000
         N     @15,@CF00965                                        0209 00424000
         ALR   @15,WAPTR                                           0209 00425000
         CLC   $INBUFR(2,@15),TYPE                                 0209 00426000
         BNE   @RT00209                                            0209 00427000
*     GOTO I00AC07;                 /* IF NOT TYPE ENTRY - BR        */ 00428000
*   GEN(BAL LINKR,I00ACLEN);        /* GO GET LENGTH OF TYPE I/P     */ 00429000
         BAL LINKR,I00ACLEN                                             00430000
*   IF IPLEN¬=TLNGTH THEN           /* IF IT DOESN'T = EXPECTED      */ 00431000
         CLC   IPLEN(1),TLNGTH                                     0212 00432000
         BNE   @RT00212                                            0212 00433000
*     GOTO I00AC06A;                /* THEN BR AND PRINT ERROR       */ 00434000
*   GEN(BAL LINKR,I00ACONV);        /* OTHERWISE CONVERT IT          */ 00435000
         BAL LINKR,I00ACONV                                             00436000
*   IF R15¬=0 THEN                  /* IF IT DID NOT CNV OK THE      */ 00437000
         LTR   R15,R15                                             0215 00438000
         BNZ   @RT00215                                            0215 00439000
*     GOTO I00AC06A;                /* WE MUST HAVE INVALID I/P-BR   */ 00440000
*   CDSTYPE=TOADR(1:1);             /* SET UP TYPE FLD-CONV OK       */ 00441000
         L     @15,TOADRPTR                                        0217 00442000
         IC    @12,TOADR(,@15)                                     0217 00443000
         L     @15,CDSWKPTR                                        0217 00444000
         STC   @12,CDSTYPE(,@15)                                   0217 00445000
*   TYPESW='1'B;                    /* TURN ON TYPE SW               */ 00446000
         L     @15,I00ACWK                                         0218 00447000
         OI    TYPESW(@15),B'00100000'                             0218 00448000
*   IF CONTSCAN='0'B THEN           /* IF CONT SCAN SW IS NOT ON     */ 00449000
         TM    CONTSCAN(@15),B'10000000'                           0219 00450000
         BZ    @RT00219                                            0219 00451000
*     GOTO I00AC02;                 /* THEN GO GET NXT LINE DATA     */ 00452000
*   CONTSCAN='0'B;                  /* OTHERWISE RESET SWITCH AND    */ 00453000
         NI    CONTSCAN(@15),B'01111111'                           0221 00454000
*   GOTO I00AC03A;                  /* CONTINUE ON                   */ 00455000
         B     I00AC03A                                            0222 00456000
*I00AC06A:                                                         0223 00457000
*                                                                  0223 00458000
*   /*****************************************************************/ 00459000
*   /*                                                               */ 00460000
*   /* TCEC MSGN(581)MSGMSK('10000000'X) INVOKED                     */ 00461000
*   /*                                                               */ 00462000
*   /*****************************************************************/ 00463000
*                                                                  0223 00464000
*   $TCECM='1'B;                    /* SET TCEC SW IN RCA            */ 00465000
I00AC06A OI    $TCECM(WAPTR),B'00000001'                           0223 00466000
*   R1=ADDR($TCA19);                /* SET UP PARM LIST $TR          */ 00467000
         LA    R1,$TCA19                                           0224 00468000
*   CALL S20CEC03;                  /* CALL TCEC-MULTIPLE LN         */ 00469000
         L     @15,@CV00781                                        0225 00470000
         BALR  @14,@15                                             0225 00471000
*   DCL                                                            0226 00472000
*     1 $TCA19,                     /* TCEC PARM LIST                */ 00473000
*      2 $TCB19 FIXED(32) INIT(581),/* MSG NUMBER                    */ 00474000
*      2 $TCC19 FIXED(32) INIT(0),  /* INCT LEN                      */ 00475000
*      2 $TCD19 BIT(8) INIT('00000000'B),/* FLAG                     */ 00476000
*      2 $TCE19 CHAR(4) INIT('10000000'X);/* MSSAGE MASK INVALID TYPE   00477000
*                                      FLD                           */ 00478000
*   GOTO I00AC01;                   /* GO GET ENTIRE LAST LINE       */ 00479000
         B     I00AC01                                             0227 00480000
*I00AC07:                                                          0228 00481000
*   IF $INBUFR(INDX1+1:INDX1+LENGTH(FLAGS))¬=FLAGS THEN            0228 00482000
I00AC07  LH    @15,INDX1                                           0228 00483000
         N     @15,@CF00965                                        0228 00484000
         ALR   @15,WAPTR                                           0228 00485000
         CLC   $INBUFR(3,@15),FLAGS                                0228 00486000
         BNE   @RT00228                                            0228 00487000
*     GOTO I00AC08;                 /* IF NOT FLAG ENTRY BR          */ 00488000
*   GEN(BAL LINKR,I00ACLEN);        /* GO GET LENGTH OF FLAG ENTRY   */ 00489000
         BAL LINKR,I00ACLEN                                             00490000
*   IF IPLEN¬=FLGLNGTH THEN         /* IF IT DOESN'T EQ EXPECTED     */ 00491000
         CLC   IPLEN(1),FLGLNGTH                                   0231 00492000
         BNE   @RT00231                                            0231 00493000
*     GOTO I00AC07A;                /* THEN BR AND PRINT ERROR       */ 00494000
*   GEN(BAL LINKR,I00ACONV);        /* OTHERWISE CONVERT IT          */ 00495000
         BAL LINKR,I00ACONV                                             00496000
*   IF R15¬=0 THEN                  /* IF IT DID NOT CONV OK THEN    */ 00497000
         LTR   R15,R15                                             0234 00498000
         BNZ   @RT00234                                            0234 00499000
*     GOTO I00AC07A;                /* WE MUST HAVE INVALID I/P-BR   */ 00500000
*   CDSFLAG=TOADR(1:3);             /* CONV OK-SET UP FLAG FLO       */ 00501000
         L     @15,CDSWKPTR                                        0236 00502000
         L     @12,TOADRPTR                                        0236 00503000
         MVC   CDSFLAG(3,@15),TOADR(@12)                           0236 00504000
*   FLAGSW='1'B;                    /* TURN ON FLAG SW               */ 00505000
         L     @15,I00ACWK                                         0237 00506000
         OI    FLAGSW(@15),B'00010000'                             0237 00507000
*   IF CONTSCAN='0'B THEN           /* IF CONT SCAN SW IS NOT ON     */ 00508000
         TM    CONTSCAN(@15),B'10000000'                           0238 00509000
         BZ    @RT00238                                            0238 00510000
*     GOTO I00AC02;                 /* THEN GO GET NXT LINE DATA     */ 00511000
*   CONTSCAN='0'B;                  /* OTHERWISE RESET SWITCH AND    */ 00512000
         NI    CONTSCAN(@15),B'01111111'                           0240 00513000
*   GOTO I00AC03A;                  /* CONTINUE ON                   */ 00514000
         B     I00AC03A                                            0241 00515000
*I00AC07A:                                                         0242 00516000
*                                                                  0242 00517000
*   /*****************************************************************/ 00518000
*   /*                                                               */ 00519000
*   /* TCEC MSGN(581)MSGMSK('08000000'X) INVOKED                     */ 00520000
*   /*                                                               */ 00521000
*   /*****************************************************************/ 00522000
*                                                                  0242 00523000
*   $TCECM='1'B;                    /* SET TCEC SW IN RCA            */ 00524000
I00AC07A OI    $TCECM(WAPTR),B'00000001'                           0242 00525000
*   R1=ADDR($TCA20);                /* SET UP PARM LIST $TR          */ 00526000
         LA    R1,$TCA20                                           0243 00527000
*   CALL S20CEC03;                  /* CALL TCEC-MULTIPLE LN         */ 00528000
         L     @15,@CV00781                                        0244 00529000
         BALR  @14,@15                                             0244 00530000
*   DCL                                                            0245 00531000
*     1 $TCA20,                     /* TCEC PARM LIST                */ 00532000
*      2 $TCB20 FIXED(32) INIT(581),/* MSG NUMBER                    */ 00533000
*      2 $TCC20 FIXED(32) INIT(0),  /* INCT LEN                      */ 00534000
*      2 $TCD20 BIT(8) INIT('00000000'B),/* FLAG                     */ 00535000
*      2 $TCE20 CHAR(4) INIT('08000000'X);/* MSSAGE MASK INVALID FLAG   00536000
*                                      FLD                           */ 00537000
*   GOTO I00AC01;                   /* GO GET ENTIRE LAST LINE       */ 00538000
         B     I00AC01                                             0246 00539000
*I00AC08:                                                          0247 00540000
*   IF $INBUFR(INDX1+1:INDX1+LENGTH(UADR))¬=UADR THEN              0247 00541000
I00AC08  LH    @15,INDX1                                           0247 00542000
         N     @15,@CF00965                                        0247 00543000
         ALR   @15,WAPTR                                           0247 00544000
         CLC   $INBUFR(3,@15),UADR                                 0247 00545000
         BNE   @RT00247                                            0247 00546000
*     GOTO I00AC09;                 /* IF NOT UNIT ADR ENTRY-BR      */ 00547000
*   IF $REMSW='0'B THEN             /* IF NOT A REMOTE REQUEST       */ 00548000
         TM    $REMSW(WAPTR),B'01000000'                           0249 00549000
         BZ    @RT00249                                            0249 00550000
*     GOTO I00AC08B;                /* THEN PRINT INVALID ENTRY      */ 00551000
*I00AC08A:                                                         0251 00552000
*   GEN(BAL LINKR,I00ACLEN);        /* GO GET LENGTH OF UA ENTRY     */ 00553000
I00AC08A BAL LINKR,I00ACLEN                                             00554000
*   IF IPLEN=UALNGTH                /* IF 4 DIGITS INPUT             */ 00555000
*     THEN                          /* THEN                          */ 00556000
         CLC   IPLEN(1),UALNGTH                                    0252 00557000
         BE    @RT00252                                            0252 00558000
*     GOTO I00AC081;                /* GO CONVERT IT AS IS           */ 00559000
*   IF IPLEN¬=3                     /* IF NOT 3 OR 4 CHAR ENTERED    */ 00560000
*     THEN                          /* THEN                          */ 00561000
         CLI   IPLEN,3                                             0254 00562000
         BNE   @RT00254                                            0254 00563000
*     GOTO I00AC08B;                /* PRINT ERROR                   */ 00564000
*   IPLEN=4;                        /* SET LENGTH FOR 4 CHARS      0256 00565000
*                                                            @OX05734*/ 00566000
         MVI   IPLEN,X'04'                                         0256 00567000
*   FRADRPTR=FRADRPTR-1;            /* ELSE BACK UP PTR TO = SIGN    */ 00568000
         L     @15,FRADRPTR                                        0257 00569000
         BCTR  @15,0                                               0257 00570000
         ST    @15,FRADRPTR                                        0257 00571000
*   FRADR(1:1)='F0'X;               /* OVERLAY EQU SIGN WITH 0     0258 00572000
*                                                            @OX05734*/ 00573000
         MVI   FRADR(@15),X'F0'                                    0258 00574000
*I00AC081:                                                         0259 00575000
*   GEN(BAL LINKR,I00ACONV);        /* OTHERWISE CONVERT IT          */ 00576000
I00AC081 BAL LINKR,I00ACONV                                             00577000
*   IF R15¬=0 THEN                  /* IF IT DID NOT CNV OK THEN     */ 00578000
         LTR   R15,R15                                             0260 00579000
         BNZ   @RT00260                                            0260 00580000
*     GOTO I00AC08B;                /* WE MUST HAVE INVALID I/P-BR   */ 00581000
*   GEN(XC CDSWORK,CDSWORK);        /* ZERO OUT CDS WORK AREA        */ 00582000
         XC CDSWORK,CDSWORK                                             00583000
*   CDSWORK(3:4)=TOADR(1:2);        /* GET CONVERTED 2-BYTE ADDR     */ 00584000
         L     @15,TOADRPTR                                        0263 00585000
         MVC   CDSWORK+2(2),TOADR(@15)                             0263 00586000
*   CDSUA=CDSWORK(1:4);             /* SET UP 4-BYTE ADDR            */ 00587000
         L     @15,CDSWKPTR                                        0264 00588000
         MVC   CDSUA(4,@15),CDSWORK                                0264 00589000
*   IF $COPY='1'B                   /* IF THIS IS A COPY REQUEST     */ 00590000
*     THEN                          /* THEN DO THE FOLLOWING         */ 00591000
         TM    $COPY(WAPTR),B'00001000'                            0265 00592000
         BNO   @RF00265                                            0265 00593000
*     DO;                                                          0266 00594000
*       R1=ADDR(VERYTBL);           /* SET UP PARM LIST PTR          */ 00595000
         LA    R1,VERYTBL                                          0267 00596000
*       CDSPTR=ADDR(CDSUA);         /* GET PTR TO CDS DATA           */ 00597000
         ST    @15,CDSPTR                                          0268 00598000
*       CALL ISTSC030;              /* GO VERIFY CDS ADDR-VTAM       */ 00599000
         L     @15,@CV00896                                        0269 00600000
         BALR  @14,@15                                             0269 00601000
*       IF R15¬=0 THEN              /* IF RET CODE DOESN'T EQ ZERO   */ 00602000
         LTR   R15,R15                                             0270 00603000
         BNZ   @RT00270                                            0270 00604000
*         GOTO I00AC08B;            /* INVALID ENTRY - ERROR         */ 00605000
*       RETURN;                     /* RETURN TO CALLER              */ 00606000
@EL00001 L     @13,4(,@13)                                         0272 00607000
@EF00001 DS    0H                                                  0272 00608000
@ER00001 L     @14,12(,@13)                                        0272 00609000
         LM    @00,@12,20(@13)                                     0272 00610000
         BR    @14                                                 0272 00611000
*     END;                                                         0273 00612000
*   UASW='1'B;                      /* TURN ON UNIT ADR SW           */ 00613000
@RF00265 L     @15,I00ACWK                                         0274 00614000
         OI    UASW(@15),B'00001000'                               0274 00615000
*   IF CONTSCAN='0'B THEN           /* IF CONT SCAN SWITCH IS OFF    */ 00616000
         TM    CONTSCAN(@15),B'10000000'                           0275 00617000
         BZ    @RT00275                                            0275 00618000
*     GOTO I00AC02;                 /* THEN GO GET NXT LINE          */ 00619000
*   CONTSCAN='0'B;                  /* OTHERWISE RESET IT AND        */ 00620000
         NI    CONTSCAN(@15),B'01111111'                           0277 00621000
*   GOTO I00AC03A;                  /* CONTINUE ON                   */ 00622000
         B     I00AC03A                                            0278 00623000
*I00AC08B:                                                         0279 00624000
*                                                                  0279 00625000
*   /*****************************************************************/ 00626000
*   /*                                                               */ 00627000
*   /* TCEC MSGN(581)MSGMSK('04000000'X) INVOKED                     */ 00628000
*   /*                                                               */ 00629000
*   /*****************************************************************/ 00630000
*                                                                  0279 00631000
*   $TCECM='1'B;                    /* SET TCEC SW IN RCA            */ 00632000
I00AC08B OI    $TCECM(WAPTR),B'00000001'                           0279 00633000
*   R1=ADDR($TCA21);                /* SET UP PARM LIST $TR          */ 00634000
         LA    R1,$TCA21                                           0280 00635000
*   CALL S20CEC03;                  /* CALL TCEC-MULTIPLE LN         */ 00636000
         L     @15,@CV00781                                        0281 00637000
         BALR  @14,@15                                             0281 00638000
*   DCL                                                            0282 00639000
*     1 $TCA21,                     /* TCEC PARM LIST                */ 00640000
*      2 $TCB21 FIXED(32) INIT(581),/* MSG NUMBER                    */ 00641000
*      2 $TCC21 FIXED(32) INIT(0),  /* INCT LEN                      */ 00642000
*      2 $TCD21 BIT(8) INIT('00000000'B),/* FLAG                     */ 00643000
*      2 $TCE21 CHAR(4) INIT('04000000'X);/* MSSAGE MASK INVALID UNIT   00644000
*                                      ADR FLD                       */ 00645000
*   IF $COPY='1'B THEN              /* IF THIS IS A COPY REQUEST     */ 00646000
         TM    $COPY(WAPTR),B'00001000'                            0283 00647000
         BO    @RT00283                                            0283 00648000
*     GOTO I00AC01C;                /* THEN GO GET NAME AGAIN        */ 00649000
*   GOTO I00AC01;                   /* GO GET ENTIRE LAST LINE       */ 00650000
         B     I00AC01                                             0285 00651000
*I00AC09:                                                          0286 00652000
*   IF $INBUFR(INDX1+1:INDX1+LENGTH(SYMNME))¬=SYMNME THEN          0286 00653000
I00AC09  LH    @15,INDX1                                           0286 00654000
         N     @15,@CF00965                                        0286 00655000
         ALR   @15,WAPTR                                           0286 00656000
         CLC   $INBUFR(3,@15),SYMNME                               0286 00657000
         BNE   @RT00286                                            0286 00658000
*     GOTO I00AC0A;                 /* IF NOT SYMB NEM ENTRY-BR      */ 00659000
*   IF $REMSW='1'B THEN             /* IF ITS A REMOTE REQUEST       */ 00660000
         TM    $REMSW(WAPTR),B'01000000'                           0288 00661000
         BO    @RT00288                                            0288 00662000
*     GOTO I00AC09B;                /* THEM PRINT INVALID ENTRY      */ 00663000
*I00AC09A:                                                         0290 00664000
*   GEN(BAL LINKR,I00ACLEN);        /* GO GET LENGTH OF SYM NAME     */ 00665000
I00AC09A BAL LINKR,I00ACLEN                                             00666000
*   IF IPLEN>SNLNGTH THEN           /* IF I/P LEN IS GREATER THAN    */ 00667000
         CLC   IPLEN(1),SNLNGTH                                    0291 00668000
         BH    @RT00291                                            0291 00669000
*     GOTO I00AC09B;                /* EXPECTED THEN PRINT ERROR     */ 00670000
*   CDSSYMBN='        ';            /* BLANK OUT SYMBOLIC NAME     0293 00671000
*                                                            @DM44548*/ 00672000
         L     @15,CDSWKPTR                                        0293 00673000
         MVC   CDSSYMBN(8,@15),@CC00907                            0293 00674000
*   CDSSYMBN(1:IPLEN)=FRADR(1:IPLEN);/* SET UP SYMBOLIC NAME         */ 00675000
         SLR   @12,@12                                             0294 00676000
         IC    @12,IPLEN                                           0294 00677000
         BCTR  @12,0                                               0294 00678000
         L     @10,FRADRPTR                                        0294 00679000
         EX    @12,@SM00970                                        0294 00680000
*   IF $COPY='1'B                   /* IF THIS IS A COPY REQUEST     */ 00681000
*     THEN                          /* THEN DO THE FOLLOWING         */ 00682000
         TM    $COPY(WAPTR),B'00001000'                            0295 00683000
         BNO   @RF00295                                            0295 00684000
*     DO;                                                          0296 00685000
*       R1=ADDR(VERYTBL);           /* SET UP PARM LIST PTR          */ 00686000
         LA    R1,VERYTBL                                          0297 00687000
*       CDSPTR=ADDR(CDSUA);         /* GET PTR TO CDS DATA           */ 00688000
         ST    @15,CDSPTR                                          0298 00689000
*       CALL ISTSC030;              /* GO VERIFY CDS EXIST TO VTAM   */ 00690000
         L     @15,@CV00896                                        0299 00691000
         BALR  @14,@15                                             0299 00692000
*       IF R15¬=0 THEN              /* IF RET CODE ¬= ZERO-ERROR     */ 00693000
         LTR   R15,R15                                             0300 00694000
         BNZ   @RT00300                                            0300 00695000
*         GOTO I00AC09B;            /* INVALID ENTRY                 */ 00696000
*       RETURN;                     /* RETURN TO CALLER              */ 00697000
         B     @EL00001                                            0302 00698000
*     END;                                                         0303 00699000
*   IF CONTSCAN='0'B THEN           /* IF CONT SCAN SWITCH IS OFF    */ 00700000
@RF00295 L     @15,I00ACWK                                         0304 00701000
         TM    CONTSCAN(@15),B'10000000'                           0304 00702000
         BZ    @RT00304                                            0304 00703000
*     GOTO I00AC02;                 /* THEN GO GET NXT LINE          */ 00704000
*   CONTSCAN='0'B;                  /* OTHERWISE RESET IT AND        */ 00705000
         NI    CONTSCAN(@15),B'01111111'                           0306 00706000
*   GOTO I00AC03A;                  /* CONTINUE ON                   */ 00707000
         B     I00AC03A                                            0307 00708000
*I00AC09B:                                                         0308 00709000
*                                                                  0308 00710000
*   /*****************************************************************/ 00711000
*   /*                                                               */ 00712000
*   /* TCEC MSGN(581)MSGMSK('02000000'X) INVOKED                     */ 00713000
*   /*                                                               */ 00714000
*   /*****************************************************************/ 00715000
*                                                                  0308 00716000
*   $TCECM='1'B;                    /* SET TCEC SW IN RCA            */ 00717000
I00AC09B OI    $TCECM(WAPTR),B'00000001'                           0308 00718000
*   R1=ADDR($TCA22);                /* SET UP PARM LIST $TR          */ 00719000
         LA    R1,$TCA22                                           0309 00720000
*   CALL S20CEC03;                  /* CALL TCEC-MULTIPLE LN         */ 00721000
         L     @15,@CV00781                                        0310 00722000
         BALR  @14,@15                                             0310 00723000
*   DCL                                                            0311 00724000
*     1 $TCA22,                     /* TCEC PARM LIST                */ 00725000
*      2 $TCB22 FIXED(32) INIT(581),/* MSG NUMBER                    */ 00726000
*      2 $TCC22 FIXED(32) INIT(0),  /* INCT LEN                      */ 00727000
*      2 $TCD22 BIT(8) INIT('00000000'B),/* FLAG                     */ 00728000
*      2 $TCE22 CHAR(4) INIT('02000000'X);/* MSSAGE MASK INVALID SYM    00729000
*                                      NAME FLD                      */ 00730000
*   IF $COPY='1'B THEN              /* IF THIS IS A COPY REQUEST     */ 00731000
         TM    $COPY(WAPTR),B'00001000'                            0312 00732000
         BO    @RT00312                                            0312 00733000
*     GOTO I00AC01C;                /* THEN GO GET NAME AGAIN        */ 00734000
*   GOTO I00AC01;                   /* GO GET ENTIRE LAST LINE       */ 00735000
         B     I00AC01                                             0314 00736000
*I00AC0A:                                                          0315 00737000
*   IF $INBUFR(INDX1+1:INDX1+LENGTH(DB))¬=DB THEN                  0315 00738000
I00AC0A  LH    @15,INDX1                                           0315 00739000
         N     @15,@CF00965                                        0315 00740000
         ALR   @15,WAPTR                                           0315 00741000
         CLC   $INBUFR(2,@15),DB                                   0315 00742000
         BNE   @RT00315                                            0315 00743000
*     GOTO I00AC0B;                 /* IF NOT A DATA GROUP THEN BR   */ 00744000
*   DBCOUNT=0;                      /* INITIALIZE DATA BYTE CT       */ 00745000
         MVI   DBCOUNT,X'00'                                       0317 00746000
*   IF $INBUFR(INDX1+LENGTH(DB)+3:INDX1+LENGTH(DB)+3)=EQSIGN THEN  0318 00747000
         LH    @15,INDX1                                           0318 00748000
         N     @15,@CF00965                                        0318 00749000
         ALR   @15,WAPTR                                           0318 00750000
         CLC   $INBUFR+4(1,@15),EQSIGN                             0318 00751000
         BE    @RT00318                                            0318 00752000
*     GOTO I00AC0AA;                /* IF ITS -DBXX=-ITS OK          */ 00753000
*   IF $INBUFR(INDX1+LENGTH(DB)+4:INDX1+LENGTH(DB)+4)¬=EQSIGN THEN 0320 00754000
         LH    @15,INDX1                                           0320 00755000
         N     @15,@CF00965                                        0320 00756000
         ALR   @15,WAPTR                                           0320 00757000
         CLC   $INBUFR+5(1,@15),EQSIGN                             0320 00758000
         BNE   @RT00320                                            0320 00759000
*     GOTO I00AC0AC;                                               0321 00760000
*I00AC0AA:                                                         0322 00761000
*   DBSW='1'B;                      /* TURN ON DATA BYTE SW          */ 00762000
I00AC0AA DS    0H                                                  0323 00763000
*   DATASW='1'B;                    /* SET DATA SW                   */ 00764000
         L     @15,I00ACWK                                         0323 00765000
         OI    DBSW(@15),B'00000011'                               0323 00766000
*   GEN(BAL LINKR,I00ACLEN);        /* GO GET LENGTH OF DATA BYTES   */ 00767000
         BAL LINKR,I00ACLEN                                             00768000
*   IF ERROR=ON                     /* IF NOT NUMERICAL DISPLACEMENT */ 00769000
*     THEN                          /* THEN                          */ 00770000
         L     @15,I00ACWK                                         0325 00771000
         TM    ERROR(@15),B'10000000'                              0325 00772000
         BO    @RT00325                                            0325 00773000
*     GOTO I00AC0AC;                /* REJECT ENTRY                  */ 00774000
*   IF $REMSW=OFF                   /* IF LOCAL CDS                  */ 00775000
*     THEN                          /* THEN                          */ 00776000
         TM    $REMSW(WAPTR),B'01000000'                           0327 00777000
         BNZ   @RF00327                                            0327 00778000
*     INDX2=DB#-12;                 /* START EXTRA DATA IN BYTE 12   */ 00779000
         LH    @15,DB#                                             0328 00780000
         N     @15,@CF00965                                        0328 00781000
         SL    @15,@CF00137                                        0328 00782000
         STC   @15,INDX2                                           0328 00783000
*   ELSE                            /* ELSE FOR REMOTE BYTE 20       */ 00784000
*     INDX2=DB#-20;                 /* SET UP CDSEXARA OFFSET        */ 00785000
         B     @RC00327                                            0329 00786000
@RF00327 LH    @15,DB#                                             0329 00787000
         N     @15,@CF00965                                        0329 00788000
         SL    @15,@CF00379                                        0329 00789000
         STC   @15,INDX2                                           0329 00790000
*   IF EBCDICSW='1'B THEN                                          0330 00791000
@RC00327 L     @15,I00ACWK                                         0330 00792000
         TM    EBCDICSW(@15),B'00000100'                           0330 00793000
         BNO   @RF00330                                            0330 00794000
*     DO;                           /* IF IT WAS EBCDIC CHAR THEN    */ 00795000
*       EBCDICSW='0'B;              /* RESET SW AND                  */ 00796000
         NI    EBCDICSW(@15),B'11111011'                           0332 00797000
*       IF(DB#+IPLEN)>255 THEN                                     0333 00798000
         SLR   @15,@15                                             0333 00799000
         IC    @15,IPLEN                                           0333 00800000
         LH    @12,DB#                                             0333 00801000
         N     @12,@CF00965                                        0333 00802000
         ALR   @12,@15                                             0333 00803000
         C     @12,@CF00919                                        0333 00804000
         BH    @RT00333                                            0333 00805000
*         GOTO I00AC0AC;            /*                       @YA04053*/ 00806000
*       IF $REMSW=OFF THEN                                         0335 00807000
         TM    $REMSW(WAPTR),B'01000000'                           0335 00808000
         BNZ   @RF00335                                            0335 00809000
*         CDSSYMBN(INDX2+1:INDX2+IPLEN)=FRADR;                     0336 00810000
         SLR   @12,@12                                             0336 00811000
         IC    @12,INDX2                                           0336 00812000
         L     @10,CDSWKPTR                                        0336 00813000
         ALR   @10,@12                                             0336 00814000
         BCTR  @15,0                                               0336 00815000
         L     @12,FRADRPTR                                        0336 00816000
         EX    @15,@SM00973                                        0336 00817000
*       ELSE                                                       0337 00818000
*         CDSEXARA(INDX2+1:INDX2+IPLEN)=FRADR;/* MOVE IN EBCDIC      */ 00819000
         B     @RC00335                                            0337 00820000
@RF00335 SLR   @15,@15                                             0337 00821000
         IC    @15,INDX2                                           0337 00822000
         L     @12,CDSWKPTR                                        0337 00823000
         ALR   @12,@15                                             0337 00824000
         SLR   @15,@15                                             0337 00825000
         IC    @15,IPLEN                                           0337 00826000
         BCTR  @15,0                                               0337 00827000
         L     @10,FRADRPTR                                        0337 00828000
         EX    @15,@SM00975                                        0337 00829000
*     END;                                                         0338 00830000
*   ELSE                                                           0339 00831000
*     DO;                                                          0339 00832000
         B     @RC00330                                            0339 00833000
@RF00330 DS    0H                                                  0340 00834000
*       GEN(BAL  LINKR,I00ACONV);   /* GO CONVERT DATA TO HEX        */ 00835000
         BAL  LINKR,I00ACONV                                            00836000
*       IF R15¬=ZERO THEN           /* FI IT DID NOT CONV OK THEN    */ 00837000
         SLR   @12,@12                                             0341 00838000
         IC    @12,ZERO                                            0341 00839000
         CR    R15,@12                                             0341 00840000
         BNE   @RT00341                                            0341 00841000
*         GOTO I00AC0AC;            /* WE MUST HAVE INV I/P          */ 00842000
*       I=IPLEN/2;                  /* DIVIDE INPUT LENGTH IN HALF   */ 00843000
         SLR   @15,@15                                             0343 00844000
         IC    @15,IPLEN                                           0343 00845000
         LR    @12,@15                                             0343 00846000
         SRL   @12,1                                               0343 00847000
         STC   @12,I                                               0343 00848000
*       R=IPLEN//2;                 /* GET REMAINDER                 */ 00849000
         LR    @00,@15                                             0344 00850000
         SRDA  @00,32                                              0344 00851000
         D     @00,@CF00140                                        0344 00852000
         STC   @00,R                                               0344 00853000
*       IF R¬=ZERO THEN             /* IF THERE WAS A REMAINDER      */ 00854000
         CLC   R(1),ZERO                                           0345 00855000
         BNE   @RT00345                                            0345 00856000
*         GOTO I00AC0AC;            /* THEN ITS INVALID ENTRY        */ 00857000
*       IPLEN=I;                    /* SET UP NEW INPUT LENGTH       */ 00858000
         MVC   IPLEN(1),I                                          0347 00859000
*       IF(DB#+IPLEN)>255 THEN      /* IF 255 LIMIT EXCEEDED @YA04053*/ 00860000
         SLR   @15,@15                                             0348 00861000
         IC    @15,IPLEN                                           0348 00862000
         LH    @12,DB#                                             0348 00863000
         N     @12,@CF00965                                        0348 00864000
         ALR   @12,@15                                             0348 00865000
         C     @12,@CF00919                                        0348 00866000
         BH    @RT00348                                            0348 00867000
*         GOTO I00AC0AC;            /* CDS LIMIT THEN BR-INVALID     */ 00868000
*       IF $REMSW=OFF               /* IF LOCAL                      */ 00869000
*         THEN                      /* THEN                          */ 00870000
         TM    $REMSW(WAPTR),B'01000000'                           0350 00871000
         BNZ   @RF00350                                            0350 00872000
*         CDSSYMBN(INDX2+1:INDX2+IPLEN)=TOADR;                     0351 00873000
         SLR   @12,@12                                             0351 00874000
         IC    @12,INDX2                                           0351 00875000
         L     @10,CDSWKPTR                                        0351 00876000
         ALR   @10,@12                                             0351 00877000
         BCTR  @15,0                                               0351 00878000
         L     @12,TOADRPTR                                        0351 00879000
         EX    @15,@SM00977                                        0351 00880000
*       ELSE                                                       0352 00881000
*         CDSEXARA(INDX2+1:INDX2+IPLEN)=TOADR;/* MIVE IN DATA BYTE   */ 00882000
         B     @RC00350                                            0352 00883000
@RF00350 SLR   @15,@15                                             0352 00884000
         IC    @15,INDX2                                           0352 00885000
         L     @12,CDSWKPTR                                        0352 00886000
         ALR   @12,@15                                             0352 00887000
         SLR   @15,@15                                             0352 00888000
         IC    @15,IPLEN                                           0352 00889000
         BCTR  @15,0                                               0352 00890000
         L     @10,TOADRPTR                                        0352 00891000
         EX    @15,@SM00979                                        0352 00892000
*     END;                                                         0353 00893000
@RC00350 DS    0H                                                  0354 00894000
*I00AC0AB:                                                         0354 00895000
*   IF DBCOUNT<DB#+IPLEN            /* IF THE LAST DATA COUNT IS   0354 00896000
*                                                            @YA04053*/ 00897000
*     THEN                          /* LESS THAN THE PRESENT ONE     */ 00898000
@RC00330 DS    0H                                                  0354 00899000
I00AC0AB LH    @15,DB#                                             0354 00900000
         N     @15,@CF00965                                        0354 00901000
         SLR   @12,@12                                             0354 00902000
         IC    @12,IPLEN                                           0354 00903000
         ALR   @15,@12                                             0354 00904000
         SLR   @12,@12                                             0354 00905000
         IC    @12,DBCOUNT                                         0354 00906000
         CR    @15,@12                                             0354 00907000
         BNH   @RF00354                                            0354 00908000
*     DO;                           /* THEN UPDATE THAT COUNT BY     */ 00909000
*       DBCOUNT=DB#+IPLEN;          /* ADDING THE DB # TO THE I/P  0356 00910000
*                                                            @YA04053*/ 00911000
         STC   @15,DBCOUNT                                         0356 00912000
*     END;                          /* LENGTH                        */ 00913000
*   IF CONTSCAN='0'B THEN                                          0358 00914000
@RF00354 L     @15,I00ACWK                                         0358 00915000
         TM    CONTSCAN(@15),B'10000000'                           0358 00916000
         BZ    @RT00358                                            0358 00917000
*     GOTO I00AC02;                                                0359 00918000
*   CONTSCAN='0'B;                                                 0360 00919000
         NI    CONTSCAN(@15),B'01111111'                           0360 00920000
*   GOTO I00AC03A;                                                 0361 00921000
         B     I00AC03A                                            0361 00922000
*I00AC0AC:                                                         0362 00923000
*                                                                  0362 00924000
*   /*****************************************************************/ 00925000
*   /*                                                               */ 00926000
*   /* TCEC MSGN(581)MSGMSK('01000000'X) INVOKED                     */ 00927000
*   /*                                                               */ 00928000
*   /*****************************************************************/ 00929000
*                                                                  0362 00930000
*   $TCECM='1'B;                    /* SET TCEC SW IN RCA            */ 00931000
I00AC0AC OI    $TCECM(WAPTR),B'00000001'                           0362 00932000
*   R1=ADDR($TCA23);                /* SET UP PARM LIST $TR          */ 00933000
         LA    R1,$TCA23                                           0363 00934000
*   CALL S20CEC03;                  /* CALL TCEC-MULTIPLE LN         */ 00935000
         L     @15,@CV00781                                        0364 00936000
         BALR  @14,@15                                             0364 00937000
*   DCL                                                            0365 00938000
*     1 $TCA23,                     /* TCEC PARM LIST                */ 00939000
*      2 $TCB23 FIXED(32) INIT(581),/* MSG NUMBER                    */ 00940000
*      2 $TCC23 FIXED(32) INIT(0),  /* INCT LEN                      */ 00941000
*      2 $TCD23 BIT(8) INIT('00000000'B),/* FLAG                     */ 00942000
*      2 $TCE23 CHAR(4) INIT('01000000'X);/* MSSAGE MASK INVALID DATA   00943000
*                                      FLD                           */ 00944000
*   GOTO I00AC01;                   /* GO GET ENTIRE LAST LINE       */ 00945000
         B     I00AC01                                             0366 00946000
*I00AC0B:                                                          0367 00947000
*   IF $INBUFR(INDX1+1:INDX1+LENGTH(ENDATA))=ENDATA THEN           0367 00948000
I00AC0B  LH    @15,INDX1                                           0367 00949000
         N     @15,@CF00965                                        0367 00950000
         ALR   @15,WAPTR                                           0367 00951000
         CLC   $INBUFR(3,@15),ENDATA                               0367 00952000
         BE    @RT00367                                            0367 00953000
*     GOTO I00ACRET;                /* IF EOD THEN RETURN TO CALL    */ 00954000
*                                                                  0368 00955000
*   /*****************************************************************/ 00956000
*   /*                                                               */ 00957000
*   /* TCEC MSGN(581)MSGMSK('00800000'X) INVOKED                     */ 00958000
*   /*                                                               */ 00959000
*   /*****************************************************************/ 00960000
*                                                                  0369 00961000
*   $TCECM='1'B;                    /* SET TCEC SW IN RCA            */ 00962000
         OI    $TCECM(WAPTR),B'00000001'                           0369 00963000
*   R1=ADDR($TCA24);                /* SET UP PARM LIST $TR          */ 00964000
         LA    R1,$TCA24                                           0370 00965000
*   CALL S20CEC03;                  /* CALL TCEC-MULTIPLE LN         */ 00966000
         L     @15,@CV00781                                        0371 00967000
         BALR  @14,@15                                             0371 00968000
*   DCL                                                            0372 00969000
*     1 $TCA24,                     /* TCEC PARM LIST                */ 00970000
*      2 $TCB24 FIXED(32) INIT(581),/* MSG NUMBER                    */ 00971000
*      2 $TCC24 FIXED(32) INIT(0),  /* INCT LEN                      */ 00972000
*      2 $TCD24 BIT(8) INIT('00000000'B),/* FLAG                     */ 00973000
*      2 $TCE24 CHAR(4) INIT('00800000'X);/* MSSAGE MASK INVALID PARM*/ 00974000
*   GOTO I00AC01;                   /* RE-ENTER LAST LINE            */ 00975000
         B     I00AC01                                             0373 00976000
*I00ACRET:                                                         0374 00977000
*   IF DATASW='1'B                  /* IF THE DATA SW IS ON          */ 00978000
*     THEN                          /* THEN DO THE FOLLOWING         */ 00979000
I00ACRET L     @15,I00ACWK                                         0374 00980000
         TM    DATASW(@15),B'00000001'                             0374 00981000
         BNO   @RF00374                                            0374 00982000
*     DO;                                                          0375 00983000
*       DATASW='0'B;                /* TURN OF DATA SW               */ 00984000
         NI    DATASW(@15),B'11111110'                             0376 00985000
*       IF $CHANGE¬='1'B            /* IF THIS IS NOT A CHANGE       */ 00986000
*         THEN                      /* THEN DO THE FOLLOWING         */ 00987000
         TM    $CHANGE(WAPTR),B'00100000'                          0377 00988000
         BO    @RF00377                                            0377 00989000
*         DO;                                                      0378 00990000
*           CDSBYTCT=DBCOUNT;       /* SET UP NEW BYTE COUNT         */ 00991000
         IC    @15,DBCOUNT                                         0379 00992000
         L     @12,CDSWKPTR                                        0379 00993000
         STC   @15,CDSBYTCT(,@12)                                  0379 00994000
*         END;                                                     0380 00995000
*       ELSE                        /* IF IT IS A CHANGE REQ         */ 00996000
*         DO;                       /* THEN DO THE FOLLOWING         */ 00997000
         B     @RC00377                                            0381 00998000
@RF00377 DS    0H                                                  0382 00999000
*           IF CDSBYTCT<DBCOUNT     /* IF ORIG COUNT IS LESS         */ 01000000
*             THEN                  /* THEN DO THE FOLLOWING         */ 01001000
         L     @15,CDSWKPTR                                        0382 01002000
         CLC   CDSBYTCT(1,@15),DBCOUNT                             0382 01003000
         BNL   @RF00382                                            0382 01004000
*             DO;                                                  0383 01005000
*               CDSBYTCT=DBCOUNT;   /* SET UP NEW BYTE COUNT         */ 01006000
         IC    @12,DBCOUNT                                         0384 01007000
         STC   @12,CDSBYTCT(,@15)                                  0384 01008000
*             END;                                                 0385 01009000
*         END;                                                     0386 01010000
*     END;                                                         0387 01011000
*   ELSE                            /* IF THE DATA SW WAS OFF        */ 01012000
*     DO;                           /* DO THE FOLLOWING              */ 01013000
         B     @RC00374                                            0388 01014000
@RF00374 DS    0H                                                  0389 01015000
*       IF $CHANGE¬='1'B&$COPY¬='1'B/* IF NOT CHNG OR COPY           */ 01016000
*         THEN                      /* THEN DO THE FOLLOWING         */ 01017000
         TM    $CHANGE(WAPTR),B'00100000'                          0389 01018000
         BO    @RF00389                                            0389 01019000
         TM    $COPY(WAPTR),B'00001000'                            0389 01020000
         BO    @RF00389                                            0389 01021000
*         DO;                                                      0390 01022000
*           CDSBYTCT=20;            /* SET MINIMUM BYTE COUNT        */ 01023000
         L     @15,CDSWKPTR                                        0391 01024000
         MVI   CDSBYTCT(@15),X'14'                                 0391 01025000
*         END;                                                     0392 01026000
*     END;                                                         0393 01027000
*   RETURN;                         /* RETURN TO CALLER              */ 01028000
         B     @EL00001                                            0394 01029000
*   GEN(EJECT);                                                    0395 01030000
*                                                                  0395 01031000
         EJECT                                                          01032000
*/********************************************************************/ 01033000
*/*  THIS ROUTINE DETERMINES THE LENGTH OF THE ACTUAL INPUT WHICH    */ 01034000
*/*  IS TO BE PLACED IN THE CDS. IT USES THE EQUAL (=) SIGN AS IT    */ 01035000
*/*  STARTING DELIMETER AND EITHER A BLANK OR A COMMA AS ITS ENDING  */ 01036000
*/*  DELIMETER                                                       */ 01037000
*/********************************************************************/ 01038000
*                                                                  0396 01039000
*I00ACLEN:                                                         0396 01040000
*   RETSAV1=LINKR;                  /* SAVE RET ADR PTR              */ 01041000
I00ACLEN ST    LINKR,RETSAV1                                       0396 01042000
*   EBCDICSW=OFF;                   /* RESET EBCDIC INPUT FLAG       */ 01043000
         L     @15,I00ACWK                                         0397 01044000
         NI    EBCDICSW(@15),B'11111011'                           0397 01045000
*   ERROR=OFF;                      /* RESET ERROR FLAG              */ 01046000
         NI    ERROR(@15),B'01111111'                              0398 01047000
*   IPLEN='0'X;                     /* ZERO OUT INPUT LEN FLD        */ 01048000
         MVI   IPLEN,X'00'                                         0399 01049000
*   IF DBSW='1'B THEN               /* IF THIS IS A DATA REQ         */ 01050000
         TM    DBSW(@15),B'00000010'                               0400 01051000
         BO    @RT00400                                            0400 01052000
*     GOTO I00ACL02;                /* THEN BR AND HANDLE            */ 01053000
*   DO WHILE($INBUFR(INDX1+1:INDX1+1)¬=EQSIGN);                    0402 01054000
         B     @DE00402                                            0402 01055000
@DL00402 DS    0H                                                  0403 01056000
*     INDX1=INDX1+1;                /* UPDATE INDEX PTR              */ 01057000
         LH    @15,INDX1                                           0403 01058000
         LA    @15,1(,@15)                                         0403 01059000
         STH   @15,INDX1                                           0403 01060000
*   END;                                                           0404 01061000
@DE00402 LH    @15,INDX1                                           0404 01062000
         N     @15,@CF00965                                        0404 01063000
         ALR   @15,WAPTR                                           0404 01064000
         CLC   $INBUFR(1,@15),EQSIGN                               0404 01065000
         BNE   @DL00402                                            0404 01066000
*   INDX1=INDX1+1;                  /* GET PAST EQ SIGN              */ 01067000
         LH    @15,INDX1                                           0405 01068000
         N     @15,@CF00965                                        0405 01069000
         LA    @15,1(,@15)                                         0405 01070000
         STH   @15,INDX1                                           0405 01071000
*I00ACL01:                                                         0406 01072000
*   FRADRPTR=ADDR($INBUFR)+INDX1;   /* SET UP FROM ADDR FOR ITACONV  */ 01073000
I00ACL01 LA    @15,$INBUFR(,WAPTR)                                 0406 01074000
         LH    @12,INDX1                                           0406 01075000
         N     @12,@CF00965                                        0406 01076000
         ALR   @15,@12                                             0406 01077000
         ST    @15,FRADRPTR                                        0406 01078000
*   DO WHILE(($INBUFR(INDX1+1:INDX1+1)¬=BLANK)&($INBUFR(INDX1+1:INDX1+1 01079000
*         )¬=COMMA)&($INBUFR(INDX1+1:INDX1+1)¬='00'X));            0407 01080000
         B     @DE00407                                            0407 01081000
@DL00407 DS    0H                                                  0408 01082000
*     INDX1=INDX1+1;                /* UPDATE INDEX PTR              */ 01083000
         LA    @15,1                                               0408 01084000
         LH    @12,INDX1                                           0408 01085000
         N     @12,@CF00965                                        0408 01086000
         ALR   @12,@15                                             0408 01087000
         STH   @12,INDX1                                           0408 01088000
*     IPLEN=IPLEN+1;                /* ADD ONE TO I/P LENGTH CTR     */ 01089000
         SLR   @12,@12                                             0409 01090000
         IC    @12,IPLEN                                           0409 01091000
         ALR   @15,@12                                             0409 01092000
         STC   @15,IPLEN                                           0409 01093000
*   END;                                                           0410 01094000
@DE00407 LH    @15,INDX1                                           0410 01095000
         N     @15,@CF00965                                        0410 01096000
         ALR   @15,WAPTR                                           0410 01097000
         CLC   $INBUFR(1,@15),BLANK                                0410 01098000
         BE    @DC00407                                            0410 01099000
         LH    @15,INDX1                                           0410 01100000
         N     @15,@CF00965                                        0410 01101000
         ALR   @15,WAPTR                                           0410 01102000
         CLC   $INBUFR(1,@15),COMMA                                0410 01103000
         BE    @DC00407                                            0410 01104000
         LH    @15,INDX1                                           0410 01105000
         N     @15,@CF00965                                        0410 01106000
         ALR   @15,WAPTR                                           0410 01107000
         CLI   $INBUFR(@15),X'00'                                  0410 01108000
         BNE   @DL00407                                            0410 01109000
@DC00407 DS    0H                                                  0411 01110000
*   GOTO I00ACL03;                  /* BR AROUND                     */ 01111000
         B     I00ACL03                                            0411 01112000
*I00ACL02:                                                         0412 01113000
*   DBSW='0'B;                      /* RESET DATA BYTE SW            */ 01114000
I00ACL02 L     @15,I00ACWK                                         0412 01115000
         NI    DBSW(@15),B'11111101'                               0412 01116000
*   INDX1=INDX1+2;                  /* GET PAST 'DB'                 */ 01117000
         LH    @15,INDX1                                           0413 01118000
         N     @15,@CF00965                                        0413 01119000
         LA    @15,2(,@15)                                         0413 01120000
         STH   @15,INDX1                                           0413 01121000
*   DB#='0000'X;                    /* ZERO OUT DATA BYTE NUMBER     */ 01122000
         SLR   @12,@12                                             0414 01123000
         STH   @12,DB#                                             0414 01124000
*   DB#LEN='0'X;                    /* ZERO OUT DATA BYTE # LEN      */ 01125000
         MVI   DB#LEN,X'00'                                        0415 01126000
*   FRADRPTR=ADDR($INBUFR)+INDX1;   /* SET UP FROM ADDR FOR ITACONV  */ 01127000
         LA    @12,$INBUFR(,WAPTR)                                 0416 01128000
         ALR   @12,@15                                             0416 01129000
         ST    @12,FRADRPTR                                        0416 01130000
*   INPTR=FRADRPTR;                 /* POINT TO DISPLACEMNT          */ 01131000
         ST    @12,INPTR                                           0417 01132000
*   DO WHILE($INBUFR(INDX1+1:INDX1+1)¬=EQSIGN);                    0418 01133000
         B     @DE00418                                            0418 01134000
@DL00418 DS    0H                                                  0419 01135000
*     INDX1=INDX1+1;                /* UPDATE INDEX PTR              */ 01136000
         LA    @15,1                                               0419 01137000
         LH    @12,INDX1                                           0419 01138000
         N     @12,@CF00965                                        0419 01139000
         ALR   @12,@15                                             0419 01140000
         STH   @12,INDX1                                           0419 01141000
*     DB#LEN=DB#LEN+1;              /* ADD ONE TO DATA BYTE # LEN    */ 01142000
         SLR   @12,@12                                             0420 01143000
         IC    @12,DB#LEN                                          0420 01144000
         ALR   @15,@12                                             0420 01145000
         STC   @15,DB#LEN                                          0420 01146000
*   END;                                                           0421 01147000
@DE00418 LH    @15,INDX1                                           0421 01148000
         N     @15,@CF00965                                        0421 01149000
         ALR   @15,WAPTR                                           0421 01150000
         CLC   $INBUFR(1,@15),EQSIGN                               0421 01151000
         BNE   @DL00418                                            0421 01152000
*   DO INPTR=INPTR TO FRADRPTR+DB#LEN-1;/* LOOK AT DISPLACEMNT       */ 01153000
         L     @15,INPTR                                           0422 01154000
         B     @DE00422                                            0422 01155000
@DL00422 DS    0H                                                  0423 01156000
*     IF INPUT(1:4)¬='1111'B        /* IF INPUT NOT NUMBERS          */ 01157000
*       THEN                        /* THEN                          */ 01158000
         TM    INPUT(@15),B'11110000'                              0423 01159000
         BO    @RF00423                                            0423 01160000
*       DO;                                                        0424 01161000
*         ERROR=ON;                 /* ERROR FLAG SET                */ 01162000
         L     @15,I00ACWK                                         0425 01163000
         OI    ERROR(@15),B'10000000'                              0425 01164000
*         GOTO I00ACL04;            /* RETURN                        */ 01165000
         B     I00ACL04                                            0426 01166000
*       END;                                                       0427 01167000
*   END;                                                           0428 01168000
@RF00423 LA    @15,1                                               0428 01169000
         AL    @15,INPTR                                           0428 01170000
         ST    @15,INPTR                                           0428 01171000
@DE00422 SLR   @12,@12                                             0428 01172000
         IC    @12,DB#LEN                                          0428 01173000
         AL    @12,FRADRPTR                                        0428 01174000
         BCTR  @12,0                                               0428 01175000
         CR    @15,@12                                             0428 01176000
         BNH   @DL00422                                            0428 01177000
*   IF DB#LEN=2                     /* IF DB# IS 20 TO 99            */ 01178000
*     THEN                                                         0429 01179000
         CLI   DB#LEN,2                                            0429 01180000
         BNE   @RF00429                                            0429 01181000
*     DO;                                                          0430 01182000
*       PACK(PKTO(1:2),FRADR(1:2)); /* PACK DB NUMBER                */ 01183000
         L     @15,FRADRPTR                                        0431 01184000
         PACK  PKTO(2),FRADR(2,@15)                                0431 01185000
*     END;                                                         0432 01186000
*   ELSE                            /* IF DB# IS 100-255 THEN DO     */ 01187000
*     DO;                                                          0433 01188000
         B     @RC00429                                            0433 01189000
@RF00429 DS    0H                                                  0434 01190000
*       PACK(PKTO(1:2),FRADR(1:3)); /* PACK 3-BYTE ENTRY             */ 01191000
         L     @15,FRADRPTR                                        0434 01192000
         PACK  PKTO(2),FRADR(3,@15)                                0434 01193000
*     END;                                                         0435 01194000
*   CVB(DB#,PKTO(1:2));             /* CONVERT DB# TO BINARY         */ 01195000
@RC00429 XC    @TS00001(8),@TS00001                                0436 01196000
         MVC   @TS00001+6(2),PKTO                                  0436 01197000
         CVB   @15,@TS00001                                        0436 01198000
         STH   @15,DB#                                             0436 01199000
*   INDX1=INDX1+1;                  /* GET PAST EQUAL SIGN           */ 01200000
         LH    @15,INDX1                                           0437 01201000
         N     @15,@CF00965                                        0437 01202000
         LA    @15,1(,@15)                                         0437 01203000
         STH   @15,INDX1                                           0437 01204000
*   IF $INBUFR(INDX1+1:INDX1+LENGTH(EBCDICEN))¬=EBCDICEN THEN      0438 01205000
         ALR   @15,WAPTR                                           0438 01206000
         CLC   $INBUFR(2,@15),EBCDICEN                             0438 01207000
         BNE   @RT00438                                            0438 01208000
*     GOTO I00ACL01;                /* IF NOT EBCDIC THEN BR         */ 01209000
*   EBCDICSW='1'B;                  /* TURN ON EBCDIC SW             */ 01210000
         L     @15,I00ACWK                                         0440 01211000
         OI    EBCDICSW(@15),B'00000100'                           0440 01212000
*   INDX1=INDX1+2;                  /* GET TO FIRST EBCDIC CHAR      */ 01213000
         LH    @15,INDX1                                           0441 01214000
         N     @15,@CF00965                                        0441 01215000
         LA    @15,2(,@15)                                         0441 01216000
         STH   @15,INDX1                                           0441 01217000
*   FRADRPTR=ADDR($INBUFR)+INDX1;   /* GET STARTING ADDR OF EBCDIC   */ 01218000
         LA    @12,$INBUFR(,WAPTR)                                 0442 01219000
         ALR   @12,@15                                             0442 01220000
         ST    @12,FRADRPTR                                        0442 01221000
*   DO WHILE($INBUFR(INDX1+1:INDX1+1)¬=SINSLASH);                  0443 01222000
         B     @DE00443                                            0443 01223000
@DL00443 DS    0H                                                  0444 01224000
*     INDX1=INDX1+1;                /* UPDATE INDEX PTR              */ 01225000
         LA    @15,1                                               0444 01226000
         LH    @12,INDX1                                           0444 01227000
         N     @12,@CF00965                                        0444 01228000
         ALR   @12,@15                                             0444 01229000
         STH   @12,INDX1                                           0444 01230000
*     IPLEN=IPLEN+1;                /* ADD ONE TO I/P LENGTH CTR     */ 01231000
         SLR   @12,@12                                             0445 01232000
         IC    @12,IPLEN                                           0445 01233000
         ALR   @15,@12                                             0445 01234000
         STC   @15,IPLEN                                           0445 01235000
*   END;                                                           0446 01236000
@DE00443 LH    @15,INDX1                                           0446 01237000
         N     @15,@CF00965                                        0446 01238000
         ALR   @15,WAPTR                                           0446 01239000
         CLC   $INBUFR(1,@15),SINSLASH                             0446 01240000
         BNE   @DL00443                                            0446 01241000
*   INDX1=INDX1+1;                  /* GET PAST SINGLE SLASH         */ 01242000
         LH    @15,INDX1                                           0447 01243000
         N     @15,@CF00965                                        0447 01244000
         LA    @15,1(,@15)                                         0447 01245000
         STH   @15,INDX1                                           0447 01246000
*   GOTO I00ACL03;                                                 0448 01247000
         B     I00ACL03                                            0448 01248000
*I00ACL03:                                                         0449 01249000
*   IF $INBUFR(INDX1+1:INDX1+1)=COMMA THEN                         0449 01250000
I00ACL03 LH    @15,INDX1                                           0449 01251000
         N     @15,@CF00965                                        0449 01252000
         ALR   @15,WAPTR                                           0449 01253000
         CLC   $INBUFR(1,@15),COMMA                                0449 01254000
         BNE   @RF00449                                            0449 01255000
*     DO;                                                          0450 01256000
*       INDX1=INDX1+1;              /* UPDATE INDEX PTR              */ 01257000
         LH    @15,INDX1                                           0451 01258000
         N     @15,@CF00965                                        0451 01259000
         LA    @15,1(,@15)                                         0451 01260000
         STH   @15,INDX1                                           0451 01261000
*       CONTSCAN='1'B;              /* SET THE CONTINUE SCAN SW      */ 01262000
         L     @15,I00ACWK                                         0452 01263000
         OI    CONTSCAN(@15),B'10000000'                           0452 01264000
*     END;                                                         0453 01265000
*I00ACL04:                                                         0454 01266000
*   LINKR=RETSAV1;                  /* GET RET ADDR                  */ 01267000
@RF00449 DS    0H                                                  0454 01268000
I00ACL04 L     LINKR,RETSAV1                                       0454 01269000
*   GEN(BR LINKR);                  /* RETURN TO CALLER              */ 01270000
         BR LINKR                                                       01271000
*   GEN(EJECT);                                                    0456 01272000
*                                                                  0456 01273000
         EJECT                                                          01274000
*/********************************************************************/ 01275000
*/*                  C O N V E R T  R O U T I N E                    */ 01276000
*/********************************************************************/ 01277000
*                                                                  0457 01278000
*I00ACONV:                                                         0457 01279000
*   RETSAV1=LINKR;                  /* SAVE RETURN ADDR              */ 01280000
*                                                                  0457 01281000
I00ACONV ST    LINKR,RETSAV1                                       0457 01282000
*   /*****************************************************************/ 01283000
*   /*                                                               */ 01284000
*   /* ITACONV FROM(FRADR)TO(TOADR)COUNT(IPLEN)TYPE(EH) INVOKED      */ 01285000
*   /*                                                               */ 01286000
*   /*****************************************************************/ 01287000
*                                                                  0458 01288000
*   DCL                                                            0458 01289000
*     1 ITATCPRM BDY(WORD),         /* CONVERT PARAMETER LIST        */ 01290000
*      2 * CHAR(4) INIT('0102F4F1'X),                              0458 01291000
*      2 ITATCFR PTR,               /* ADDRESS OF FROM FIELD         */ 01292000
*      2 ITATCTO PTR,               /* ADDRESS OF TO FIELD           */ 01293000
*      2 * BIT(8) INIT(0),          /* FLAGS FOR CONVERT MODULE      */ 01294000
*       3 ITATCTP BIT(1),           /* TYPE OF CONVERT REQUIRED      */ 01295000
*      2 ITATCNT FIXED(8);          /* NUMBER OF BYTES TO CONVERT    */ 01296000
*   ITATCFR=ADDR(FRADR);            /* SET THE FROM ADDRESS          */ 01297000
         L     @15,FRADRPTR                                        0459 01298000
         ST    @15,ITATCFR                                         0459 01299000
*   ITATCTO=ADDR(TOADR);            /* SET THE TO ADDRESS            */ 01300000
         L     @15,TOADRPTR                                        0460 01301000
         ST    @15,ITATCTO                                         0460 01302000
*   ITATCTP='0'B;                   /* SET THE TYPE OF CONVERT BIT   */ 01303000
         NI    ITATCTP,B'01111111'                                 0461 01304000
*   ITATCNT=IPLEN;                  /* GIVE THE CONVERT BYTE COUNT   */ 01305000
         IC    @15,IPLEN                                           0462 01306000
         STC   @15,ITATCNT                                         0462 01307000
*   R1=ADDR(ITATCPRM);              /* POINT TO CONVERT PARM LIST    */ 01308000
         LA    R1,ITATCPRM                                         0463 01309000
*   CALL ISTSC021;                  /* CALL CONVERT DIRECTLY         */ 01310000
         L     @15,@CV00961                                        0464 01311000
         BALR  @14,@15                                             0464 01312000
*   LINKR=RETSAV1;                  /* GET RETURN ADDR               */ 01313000
         L     LINKR,RETSAV1                                       0465 01314000
*   GEN(BR LINKR);                  /* RETURN TO CALLER              */ 01315000
         BR LINKR                                                       01316000
*   DO;                             /* ATDSPLY                       */ 01317000
*   END;                            /* ATDSPLY                       */ 01318000
*   END ISTIC00A;                                                  0469 01319000
         B     @EL00001                                            0469 01320000
@DATA    DS    0H                                                       01321000
@SM00970 MVC   CDSSYMBN(0,@15),FRADR(@10)                               01322000
@SM00973 MVC   CDSSYMBN(0,@10),FRADR(@12)                               01323000
@SM00975 MVC   CDSEXARA(0,@12),FRADR(@10)                               01324000
@SM00977 MVC   CDSSYMBN(0,@10),TOADR(@12)                               01325000
@SM00979 MVC   CDSEXARA(0,@12),TOADR(@10)                               01326000
         DS    0F                                                       01327000
@SA00001 DS    18F                                                      01328000
         DS    0F                                                       01329000
@CF00140 DC    F'2'                                                     01330000
@CF00137 DC    F'12'                                                    01331000
@CF00379 DC    F'20'                                                    01332000
@CF00050 DC    F'80'                                                    01333000
@CF00919 DC    F'255'                                                   01334000
@CF00084 DC    F'256'                                                   01335000
@CF00965 DC    XL4'0000FFFF'                                            01336000
@CV00781 DC    V(S20CEC03)                                              01337000
@CV00896 DC    V(ISTSC030)                                              01338000
@CV00961 DC    V(ISTSC021)                                              01339000
         DS    0D                                                       01340000
RCAPTR   DS    A                                                        01341000
CECMAP   DS    A                                                        01342000
CDSWKPTR DS    A                                                        01343000
FRADRPTR DS    A                                                        01344000
TOADRPTR DS    A                                                        01345000
INPTR    DS    A                                                        01346000
I00ACWK  DS    A                                                        01347000
DB#      DC    XL2'0000'                                                01348000
INDX1    DS    H                                                        01349000
INDX2    DC    XL1'00'                                                  01350000
MLNGTH   DC    XL1'2'                                                   01351000
FLNGTH   DC    XL1'2'                                                   01352000
CLNGTH   DC    XL1'2'                                                   01353000
TLNGTH   DC    XL1'2'                                                   01354000
FLGLNGTH DC    XL1'6'                                                   01355000
UALNGTH  DC    XL1'4'                                                   01356000
SNLNGTH  DC    XL1'8'                                                   01357000
DBLNGTH  DC    XL1'EB'                                                  01358000
         DS    0D                                                       01359000
@TS00001 DS    CL8                                                      01360000
@CC00907 DC    C'        '                                              01361000
BLANK    DC    CL1' '                                                   01362000
HWONE    DC    X'0001'                                                  01363000
ZERO     DC    X'00'                                                    01364000
I        DC    X'00'                                                    01365000
R        DC    X'00'                                                    01366000
         DS    CL2                                                      01367000
RETSAV1  DS    CL4                                                      01368000
PROMPT   DC    CL1'P'                                                   01369000
EQSIGN   DC    CL1'='                                                   01370000
COMMA    DC    CL1','                                                   01371000
MODEL    DC    CL2'M='                                                  01372000
FEAT     DC    CL2'F='                                                  01373000
CLASS    DC    CL2'C='                                                  01374000
TYPE     DC    CL2'T='                                                  01375000
FLAGS    DC    CL3'FL='                                                 01376000
UADR     DC    CL3'UA='                                                 01377000
SYMNME   DC    CL3'SN='                                                 01378000
DB       DC    CL2'DB'                                                  01379000
CDSWORK  DS    CL20                                                     01380000
DB#LEN   DS    CL1                                                      01381000
DBCOUNT  DC    X'00'                                                    01382000
EBCDICEN DC    CL2'E/'                                                  01383000
ENDATA   DC    CL3'END'                                                 01384000
IPLEN    DS    CL1                                                      01385000
PKTO     DS    CL2                                                      01386000
SINSLASH DC    CL1'/'                                                   01387000
         DS    CL3                                                      01388000
VERYTBL  DS    CL5                                                      01389000
         ORG   VERYTBL                                                  01390000
CDSPTR   DS    AL4                                                      01391000
@NM00053 DC    X'00'                                                    01392000
         ORG   VERYTBL+5                                                01393000
         DS    CL3                                                      01394000
$TCA09   DS    CL13                                                     01395000
         ORG   $TCA09                                                   01396000
$TCB09   DC    A(580)                                                   01397000
$TCC09   DC    A(61)                                                    01398000
$TCD09   DC    B'01000000'                                              01399000
$TCE09   DC    X'80000000'                                              01400000
         ORG   $TCA09+13                                                01401000
         DS    CL3                                                      01402000
$TCA10   DS    CL13                                                     01403000
         ORG   $TCA10                                                   01404000
$TCB10   DC    A(580)                                                   01405000
$TCC10   DC    A(0)                                                     01406000
$TCD10   DC    B'00000000'                                              01407000
$TCE10   DC    X'3FDFFC00'                                              01408000
         ORG   $TCA10+13                                                01409000
         DS    CL3                                                      01410000
$TCA11   DS    CL13                                                     01411000
         ORG   $TCA11                                                   01412000
$TCB11   DC    A(580)                                                   01413000
$TCC11   DC    A(0)                                                     01414000
$TCD11   DC    B'00000000'                                              01415000
$TCE11   DC    X'3FBFFC00'                                              01416000
         ORG   $TCA11+13                                                01417000
         DS    CL3                                                      01418000
$TCA12   DS    CL13                                                     01419000
         ORG   $TCA12                                                   01420000
$TCB12   DC    A(582)                                                   01421000
$TCC12   DC    A(61)                                                    01422000
$TCD12   DC    B'01000000'                                              01423000
$TCE12   DC    X'80000000'                                              01424000
         ORG   $TCA12+13                                                01425000
         DS    CL3                                                      01426000
$TCA13   DS    CL13                                                     01427000
         ORG   $TCA13                                                   01428000
$TCB13   DC    A(581)                                                   01429000
$TCC13   DC    A(0)                                                     01430000
$TCD13   DC    B'00000000'                                              01431000
$TCE13   DC    X'02000000'                                              01432000
         ORG   $TCA13+13                                                01433000
         DS    CL3                                                      01434000
$TCA14   DS    CL13                                                     01435000
         ORG   $TCA14                                                   01436000
$TCB14   DC    A(581)                                                   01437000
$TCC14   DC    A(0)                                                     01438000
$TCD14   DC    B'00000000'                                              01439000
$TCE14   DC    X'04000000'                                              01440000
         ORG   $TCA14+13                                                01441000
         DS    CL3                                                      01442000
$TCA15   DS    CL13                                                     01443000
         ORG   $TCA15                                                   01444000
$TCB15   DC    A(580)                                                   01445000
$TCC15   DC    A(61)                                                    01446000
$TCD15   DC    B'01000000'                                              01447000
$TCE15   DC    X'40000000'                                              01448000
         ORG   $TCA15+13                                                01449000
         DS    CL3                                                      01450000
$TCA16   DS    CL13                                                     01451000
         ORG   $TCA16                                                   01452000
$TCB16   DC    A(581)                                                   01453000
$TCC16   DC    A(0)                                                     01454000
$TCD16   DC    B'00000000'                                              01455000
$TCE16   DC    X'80000000'                                              01456000
         ORG   $TCA16+13                                                01457000
         DS    CL3                                                      01458000
$TCA17   DS    CL13                                                     01459000
         ORG   $TCA17                                                   01460000
$TCB17   DC    A(581)                                                   01461000
$TCC17   DC    A(0)                                                     01462000
$TCD17   DC    B'00000000'                                              01463000
$TCE17   DC    X'40000000'                                              01464000
         ORG   $TCA17+13                                                01465000
         DS    CL3                                                      01466000
$TCA18   DS    CL13                                                     01467000
         ORG   $TCA18                                                   01468000
$TCB18   DC    A(581)                                                   01469000
$TCC18   DC    A(0)                                                     01470000
$TCD18   DC    B'00000000'                                              01471000
$TCE18   DC    X'20000000'                                              01472000
         ORG   $TCA18+13                                                01473000
         DS    CL3                                                      01474000
$TCA19   DS    CL13                                                     01475000
         ORG   $TCA19                                                   01476000
$TCB19   DC    A(581)                                                   01477000
$TCC19   DC    A(0)                                                     01478000
$TCD19   DC    B'00000000'                                              01479000
$TCE19   DC    X'10000000'                                              01480000
         ORG   $TCA19+13                                                01481000
         DS    CL3                                                      01482000
$TCA20   DS    CL13                                                     01483000
         ORG   $TCA20                                                   01484000
$TCB20   DC    A(581)                                                   01485000
$TCC20   DC    A(0)                                                     01486000
$TCD20   DC    B'00000000'                                              01487000
$TCE20   DC    X'08000000'                                              01488000
         ORG   $TCA20+13                                                01489000
         DS    CL3                                                      01490000
$TCA21   DS    CL13                                                     01491000
         ORG   $TCA21                                                   01492000
$TCB21   DC    A(581)                                                   01493000
$TCC21   DC    A(0)                                                     01494000
$TCD21   DC    B'00000000'                                              01495000
$TCE21   DC    X'04000000'                                              01496000
         ORG   $TCA21+13                                                01497000
         DS    CL3                                                      01498000
$TCA22   DS    CL13                                                     01499000
         ORG   $TCA22                                                   01500000
$TCB22   DC    A(581)                                                   01501000
$TCC22   DC    A(0)                                                     01502000
$TCD22   DC    B'00000000'                                              01503000
$TCE22   DC    X'02000000'                                              01504000
         ORG   $TCA22+13                                                01505000
         DS    CL3                                                      01506000
$TCA23   DS    CL13                                                     01507000
         ORG   $TCA23                                                   01508000
$TCB23   DC    A(581)                                                   01509000
$TCC23   DC    A(0)                                                     01510000
$TCD23   DC    B'00000000'                                              01511000
$TCE23   DC    X'01000000'                                              01512000
         ORG   $TCA23+13                                                01513000
         DS    CL3                                                      01514000
$TCA24   DS    CL13                                                     01515000
         ORG   $TCA24                                                   01516000
$TCB24   DC    A(581)                                                   01517000
$TCC24   DC    A(0)                                                     01518000
$TCD24   DC    B'00000000'                                              01519000
$TCE24   DC    X'00800000'                                              01520000
         ORG   $TCA24+13                                                01521000
         DS    CL3                                                      01522000
ITATCPRM DS    CL14                                                     01523000
         ORG   ITATCPRM                                                 01524000
@NM00057 DC    X'0102F4F1'                                              01525000
ITATCFR  DS    AL4                                                      01526000
ITATCTO  DS    AL4                                                      01527000
@NM00058 DC    AL1(0)                                                   01528000
         ORG   @NM00058                                                 01529000
ITATCTP  DS    BL1                                                      01530000
         ORG   ITATCPRM+13                                              01531000
ITATCNT  DS    FL1                                                      01532000
         ORG   ITATCPRM+14                                              01533000
         DS    CL2                                                      01534000
PATCH    DC    40F'0'                                                   01535000
@00      EQU   00                      EQUATES FOR REGISTERS 0-15       01536000
@01      EQU   01                                                       01537000
@02      EQU   02                                                       01538000
@03      EQU   03                                                       01539000
@04      EQU   04                                                       01540000
@05      EQU   05                                                       01541000
@06      EQU   06                                                       01542000
@07      EQU   07                                                       01543000
@08      EQU   08                                                       01544000
@09      EQU   09                                                       01545000
@10      EQU   10                                                       01546000
@11      EQU   11                                                       01547000
@12      EQU   12                                                       01548000
@13      EQU   13                                                       01549000
@14      EQU   14                                                       01550000
@15      EQU   15                                                       01551000
WAPTR    EQU   @02                                                      01552000
R1       EQU   @01                                                      01553000
R15      EQU   @15                                                      01554000
LINKR    EQU   @14                                                      01555000
R0       EQU   @00                                                      01556000
R10      EQU   @10                                                      01557000
R11      EQU   @11                                                      01558000
R12      EQU   @12                                                      01559000
R13      EQU   @13                                                      01560000
R14      EQU   @14                                                      01561000
R2       EQU   @02                                                      01562000
R3       EQU   @03                                                      01563000
R4       EQU   @04                                                      01564000
R5       EQU   @05                                                      01565000
R6       EQU   @06                                                      01566000
R7       EQU   @07                                                      01567000
R8       EQU   @08                                                      01568000
R9       EQU   @09                                                      01569000
$RCAAREA EQU   0                                                        01570000
$POINTER EQU   $RCAAREA+100                                             01571000
$TRTBLA  EQU   $POINTER+124                                             01572000
$CONSTNT EQU   $RCAAREA+244                                             01573000
$RCAFLG  EQU   $RCAAREA+604                                             01574000
TOLTEPWA EQU   0                                                        01575000
$SCTTBLE EQU   TOLTEPWA                                                 01576000
$TESTOPT EQU   $SCTTBLE+2                                               01577000
$ERROPT  EQU   $SCTTBLE+3                                               01578000
$PDEVFLG EQU   $SCTTBLE+10                                              01579000
$CDSFLGS EQU   $SCTTBLE+11                                              01580000
$CDS8T19 EQU   $SCTTBLE+20                                              01581000
$EXECFLG EQU   $SCTTBLE+33                                              01582000
$OLTFLGS EQU   $SCTTBLE+36                                              01583000
$OLTFLG2 EQU   $SCTTBLE+37                                              01584000
$TOTFLG1 EQU   $SCTTBLE+38                                              01585000
$ROUTMSK EQU   $SCTTBLE+40                                              01586000
$CDA     EQU   TOLTEPWA+100                                             01587000
$RCA     EQU   $CDA+44                                                  01588000
$OLTPTR  EQU   $CDA+52                                                  01589000
$LOWADDR EQU   $OLTPTR                                                  01590000
$HIMOREC EQU   $CDA+60                                                  01591000
$COMMFLG EQU   TOLTEPWA+224                                             01592000
$FLAG1   EQU   $COMMFLG                                                 01593000
$FLAG2   EQU   $COMMFLG+1                                               01594000
$FLAG3   EQU   $COMMFLG+2                                               01595000
$FLAG4   EQU   $COMMFLG+3                                               01596000
$FLAG5   EQU   $COMMFLG+4                                               01597000
$EOJ     EQU   $FLAG5                                                   01598000
$CANCEL  EQU   $EOJ                                                     01599000
$FLAG6   EQU   $COMMFLG+5                                               01600000
$CHANGE  EQU   $FLAG6                                                   01601000
$ABNDBIT EQU   $FLAG6                                                   01602000
$FLAG7   EQU   $COMMFLG+6                                               01603000
$FLAG8   EQU   $COMMFLG+7                                               01604000
$TCECM   EQU   $FLAG8                                                   01605000
$FLAG9   EQU   $COMMFLG+8                                               01606000
$REMSW   EQU   $FLAG9                                                   01607000
$COPY    EQU   $FLAG9                                                   01608000
$FLAG10  EQU   $COMMFLG+9                                               01609000
$FLAG11  EQU   $COMMFLG+10                                              01610000
$FLAG12  EQU   $COMMFLG+11                                              01611000
$FLAG13  EQU   $COMMFLG+12                                              01612000
$DEVTBLE EQU   TOLTEPWA+240                                             01613000
$DEVCDS  EQU   $DEVTBLE                                                 01614000
$DEVUNAD EQU   $DEVCDS                                                  01615000
@NM00039 EQU   $DEVUNAD+2                                               01616000
$DEVFEAT EQU   $DEVCDS+4                                                01617000
$DEVCDSF EQU   $DEVCDS+9                                                01618000
$DEVSDCF EQU   $DEVCDS+10                                               01619000
$$SYMNME EQU   $DEVCDS+12                                               01620000
$DEVFLG1 EQU   $DEVTBLE+20                                              01621000
$EVNCPLT EQU   $DEVFLG1                                                 01622000
$ATTNEXP EQU   $DEVFLG1                                                 01623000
$INTOCC  EQU   $DEVFLG1                                                 01624000
$DEVFLG2 EQU   $DEVTBLE+21                                              01625000
$DEVTECB EQU   $DEVTBLE+22                                              01626000
$OPIS    EQU   $DEVTECB                                                 01627000
$OPND    EQU   $DEVTECB+2                                               01628000
$DEVFLG3 EQU   $DEVTBLE+27                                              01629000
$SIOFLG  EQU   $DEVFLG3                                                 01630000
$IFTOUT  EQU   $DEVTBLE+36                                              01631000
$DEVSESP EQU   $IFTOUT                                                  01632000
$SSCPDAF EQU   $IFTOUT+6                                                01633000
$LDNCBPT EQU   $DEVTBLE+48                                              01634000
$RNINFO  EQU   $DEVTBLE+56                                              01635000
$DEVFLG5 EQU   $RNINFO+8                                                01636000
$DEVFLG4 EQU   $DEVTBLE+65                                              01637000
$SLTBL   EQU   TOLTEPWA+1468                                            01638000
$RUNTEST EQU   $SLTBL+13                                                01639000
$TESTFLG EQU   $SLTBL+21                                                01640000
$SECLST  EQU   $SLTBL+22                                                01641000
$INBUFR  EQU   TOLTEPWA+2104                                            01642000
#EXITA   EQU   TOLTEPWA+2632                                            01643000
$CCOMDAT EQU   TOLTEPWA+2644                                            01644000
$CFLGS   EQU   $CCOMDAT+16                                              01645000
$24FEMSG EQU   TOLTEPWA+2681                                            01646000
$24CATMG EQU   $24FEMSG+11                                              01647000
@NM00048 EQU   TOLTEPWA+2776                                            01648000
$OUNTPTR EQU   @NM00048+4                                               01649000
$NSPTR   EQU   $OUNTPTR                                                 01650000
$NSCNT   EQU   @NM00048+10                                              01651000
$ENXX    EQU   @NM00048+15                                              01652000
$IMITX   EQU   $ENXX                                                    01653000
SVESC033 EQU   TOLTEPWA+3160                                            01654000
SVECC013 EQU   TOLTEPWA+3232                                            01655000
SVEIC003 EQU   TOLTEPWA+3592                                            01656000
SVESC022 EQU   TOLTEPWA+3736                                            01657000
SVECC011 EQU   TOLTEPWA+4024                                            01658000
CECOMMAP EQU   0                                                        01659000
CDSMAP   EQU   0                                                        01660000
CDSUA    EQU   CDSMAP                                                   01661000
CDSMFCT  EQU   CDSMAP+4                                                 01662000
CDSMODEL EQU   CDSMFCT                                                  01663000
CDSFEAT  EQU   CDSMFCT+1                                                01664000
CDSCLASS EQU   CDSMFCT+2                                                01665000
CDSTYPE  EQU   CDSMFCT+3                                                01666000
CDSBYTCT EQU   CDSMAP+8                                                 01667000
CDSFLAG  EQU   CDSMAP+9                                                 01668000
CDSSYMBN EQU   CDSMAP+12                                                01669000
CDSEXARA EQU   CDSMAP+20                                                01670000
FRADR    EQU   0                                                        01671000
TOADR    EQU   0                                                        01672000
INPUT    EQU   0                                                        01673000
@NM00054 EQU   0                                                        01674000
I00ACSW  EQU   @NM00054                                                 01675000
CONTSCAN EQU   I00ACSW                                                  01676000
CLASSSW  EQU   I00ACSW                                                  01677000
TYPESW   EQU   I00ACSW                                                  01678000
FLAGSW   EQU   I00ACSW                                                  01679000
UASW     EQU   I00ACSW                                                  01680000
EBCDICSW EQU   I00ACSW                                                  01681000
DBSW     EQU   I00ACSW                                                  01682000
DATASW   EQU   I00ACSW                                                  01683000
@NM00055 EQU   @NM00054+1                                               01684000
ERROR    EQU   @NM00055                                                 01685000
$TRTBL   EQU   0                                                        01686000
#EXIT    EQU   0                                                        01687000
SVECC012 EQU   SVESC022                                                 01688000
SVEIC00A EQU   SVEIC003                                                 01689000
SVEIC004 EQU   SVEIC003                                                 01690000
SVEIC005 EQU   SVEIC003                                                 01691000
SVESC02A EQU   SVESC022                                                 01692000
SVESC02B EQU   SVESC022                                                 01693000
SVESC02D EQU   SVESC022                                                 01694000
SVESC02E EQU   SVESC022                                                 01695000
SVESC02F EQU   SVECC013                                                 01696000
SVESC024 EQU   SVESC022                                                 01697000
SVESC027 EQU   SVESC022                                                 01698000
SVESC029 EQU   SVESC033                                                 01699000
SVESC031 EQU   SVECC013                                                 01700000
SVESC032 EQU   SVECC011                                                 01701000
SVETC037 EQU   SVEIC003                                                 01702000
         AGO   .@UNREFD                START UNREFERENCED COMPONENTS    01703000
@NM00056 EQU   @NM00055                                                 01704000
CDSEXTM  EQU   CDSFLAG+2                                                01705000
CDSEXTB  EQU   CDSFLAG+2                                                01706000
CDSTMERB EQU   CDSFLAG+2                                                01707000
@NM00052 EQU   CDSFLAG+1                                                01708000
CDSDVPRO EQU   CDSFLAG+1                                                01709000
CDSNTPRI EQU   CDSFLAG+1                                                01710000
CDSLINCN EQU   CDSFLAG                                                  01711000
CDSREMSY EQU   CDSFLAG                                                  01712000
CDS2CHAN EQU   CDSFLAG                                                  01713000
CDSSYMB  EQU   CDSFLAG                                                  01714000
CDSEXTPR EQU   CDSFLAG                                                  01715000
CDSFEVOL EQU   CDSFLAG                                                  01716000
CDSSHAR  EQU   CDSFLAG                                                  01717000
CDSFPMD  EQU   CDSFLAG                                                  01718000
@NM00051 EQU   CDSFEAT                                                  01719000
CDSDEVM  EQU   CDSFEAT                                                  01720000
CDSDEVT  EQU   CDSFEAT                                                  01721000
CDSASCII EQU   CDSFEAT                                                  01722000
$CECFLAG EQU   CECOMMAP+20                                              01723000
$CEINCT  EQU   CECOMMAP+16                                              01724000
$CEINADR EQU   CECOMMAP+12                                              01725000
$CEOUTCT EQU   CECOMMAP+8                                               01726000
$CEOUTAD EQU   CECOMMAP+4                                               01727000
$CECIDNT EQU   CECOMMAP+2                                               01728000
$CECLEVL EQU   CECOMMAP+1                                               01729000
$CECTRMG EQU   CECOMMAP                                                 01730000
SVECC010 EQU   TOLTEPWA+3952                                            01731000
SVETC035 EQU   TOLTEPWA+3880                                            01732000
SVESC030 EQU   TOLTEPWA+3808                                            01733000
SVESC020 EQU   TOLTEPWA+3664                                            01734000
SVEIC002 EQU   TOLTEPWA+3520                                            01735000
SVECC014 EQU   TOLTEPWA+3376                                            01736000
SVESC120 EQU   TOLTEPWA+3304                                            01737000
SVESC025 EQU   TOLTEPWA+3088                                            01738000
@NM00050 EQU   TOLTEPWA+2980                                            01739000
$RPLERR  EQU   TOLTEPWA+2977                                            01740000
@NM00049 EQU   TOLTEPWA+2976                                            01741000
$R13PR3  EQU   TOLTEPWA+2972                                            01742000
$CEINT2  EQU   TOLTEPWA+2968                                            01743000
$CEINT1  EQU   TOLTEPWA+2964                                            01744000
$MSGGET  EQU   TOLTEPWA+2960                                            01745000
$ACQLIST EQU   TOLTEPWA+2956                                            01746000
$R4SAVE1 EQU   TOLTEPWA+2952                                            01747000
$CLSISS  EQU   TOLTEPWA+2950                                            01748000
$CLSCNT  EQU   TOLTEPWA+2948                                            01749000
$CUTABLE EQU   TOLTEPWA+2868                                            01750000
$BUFSZ2  EQU   TOLTEPWA+2864                                            01751000
$RESID2  EQU   TOLTEPWA+2860                                            01752000
$OLTCCW2 EQU   TOLTEPWA+2856                                            01753000
$ENDBFR2 EQU   TOLTEPWA+2852                                            01754000
$1STBFR2 EQU   TOLTEPWA+2848                                            01755000
$TECB2   EQU   TOLTEPWA+2844                                            01756000
$BUFSZ1  EQU   TOLTEPWA+2840                                            01757000
$RESID1  EQU   TOLTEPWA+2836                                            01758000
$OLTCCW1 EQU   TOLTEPWA+2832                                            01759000
$ENDBFR1 EQU   TOLTEPWA+2828                                            01760000
$1STBFR1 EQU   TOLTEPWA+2824                                            01761000
$TECB1   EQU   TOLTEPWA+2820                                            01762000
$WAITIME EQU   TOLTEPWA+2816                                            01763000
$TRTN#   EQU   TOLTEPWA+2815                                            01764000
$WIODEV  EQU   TOLTEPWA+2814                                            01765000
$RQSTSZE EQU   TOLTEPWA+2812                                            01766000
$RQSTPTR EQU   TOLTEPWA+2808                                            01767000
$R4SAVE  EQU   TOLTEPWA+2804                                            01768000
$PARTADR EQU   TOLTEPWA+2800                                            01769000
$TBSDATA EQU   TOLTEPWA+2796                                            01770000
$CTWIDTH EQU   TOLTEPWA+2795                                            01771000
$CTLINE  EQU   TOLTEPWA+2794                                            01772000
$APWIDTH EQU   TOLTEPWA+2793                                            01773000
$APLINE  EQU   TOLTEPWA+2792                                            01774000
$INDEX   EQU   $IMITX                                                   01775000
$UMXX    EQU   @NM00048+14                                              01776000
$NSXX    EQU   @NM00048+12                                              01777000
$ATACNT  EQU   $NSCNT                                                   01778000
$CTR     EQU   @NM00048+8                                               01779000
$ATAPTR  EQU   $NSPTR                                                   01780000
$DDRPTR  EQU   @NM00048                                                 01781000
$DTORESP EQU   TOLTEPWA+2712                                            01782000
$APNAME  EQU   TOLTEPWA+2704                                            01783000
$24SYMNE EQU   $24CATMG+4                                               01784000
$24DEVAD EQU   $24CATMG                                                 01785000
$24RTN#  EQU   $24FEMSG+8                                               01786000
$ESECTID EQU   $24FEMSG                                                 01787000
$24FLGS  EQU   TOLTEPWA+2680                                            01788000
$24SAVE2 EQU   TOLTEPWA+2676                                            01789000
$24SAVE1 EQU   TOLTEPWA+2672                                            01790000
$24UNADR EQU   TOLTEPWA+2668                                            01791000
$24SAV13 EQU   TOLTEPWA+2664                                            01792000
$24RETCD EQU   TOLTEPWA+2663                                            01793000
$MACID   EQU   TOLTEPWA+2661                                            01794000
$CSPARE  EQU   $CFLGS                                                   01795000
$C2WAY   EQU   $CFLGS                                                   01796000
$CINCT   EQU   $CCOMDAT+12                                              01797000
$CINADR  EQU   $CCOMDAT+8                                               01798000
$COUTCT  EQU   $CCOMDAT+4                                               01799000
$COUTAD  EQU   $CCOMDAT                                                 01800000
ROOTLOC  EQU   TOLTEPWA+2640                                            01801000
$RETREG  EQU   TOLTEPWA+2636                                            01802000
$WORK    EQU   TOLTEPWA+2376                                            01803000
$EXTA    EQU   TOLTEPWA+2320                                            01804000
$PASSONA EQU   TOLTEPWA+2264                                            01805000
$TRMINPT EQU   TOLTEPWA+2184                                            01806000
$BUFFER  EQU   TOLTEPWA+1976                                            01807000
$TLTRPL3 EQU   TOLTEPWA+1856                                            01808000
$TLTRPL2 EQU   TOLTEPWA+1736                                            01809000
$TLTRPL1 EQU   TOLTEPWA+1616                                            01810000
@NM00047 EQU   $SLTBL+135                                               01811000
$HIGHRTN EQU   $SLTBL+134                                               01812000
$PRIMADR EQU   $SLTBL+130                                               01813000
$CTSTPT  EQU   $SLTBL+128                                               01814000
$TSTCNT  EQU   $SLTBL+126                                               01815000
$SECFLGS EQU   $SECLST+3                                                01816000
$SECTION EQU   $SECLST                                                  01817000
$SECACT  EQU   $TESTFLG                                                 01818000
$CANTRUN EQU   $TESTFLG                                                 01819000
$FINAL   EQU   $TESTFLG                                                 01820000
$TESTSUF EQU   $RUNTEST+5                                               01821000
$TESTNUM EQU   $RUNTEST+1                                               01822000
$LETPRF  EQU   $RUNTEST                                                 01823000
$SYMBOLC EQU   $SLTBL+5                                                 01824000
$FAMILY  EQU   $SLTBL                                                   01825000
$CDEVPT  EQU   TOLTEPWA+1466                                            01826000
$DEVCNTS EQU   TOLTEPWA+1464                                            01827000
$FEEDBCK EQU   $DEVTBLE+66                                              01828000
$WTISUED EQU   $DEVFLG4                                                 01829000
$EXIOISD EQU   $DEVFLG4                                                 01830000
$REMWRIT EQU   $DEVFLG4                                                 01831000
$REMDONE EQU   $DEVFLG4                                                 01832000
$2NDUSED EQU   $DEVFLG4                                                 01833000
$1STUSED EQU   $DEVFLG4                                                 01834000
$IGLXIFB EQU   $DEVFLG4                                                 01835000
$EXIOLV3 EQU   $DEVFLG4                                                 01836000
@NM00046 EQU   $DEVFLG5                                                 01837000
$DVBASIC EQU   $DEVFLG5                                                 01838000
$ASCII   EQU   $DEVFLG5                                                 01839000
$DEVLU   EQU   $DEVFLG5                                                 01840000
$OPNDFAL EQU   $DEVFLG5                                                 01841000
$ACQNCB  EQU   $DEVFLG5                                                 01842000
$REMOTE  EQU   $DEVFLG5                                                 01843000
$ENDNODE EQU   $DEVFLG5                                                 01844000
$LINENME EQU   $RNINFO                                                  01845000
$CID     EQU   $DEVTBLE+52                                              01846000
$DVCOL   EQU   $LDNCBPT+2                                               01847000
$DVROW   EQU   $LDNCBPT                                                 01848000
$NCSPLP  EQU   $DEVTBLE+44                                              01849000
$DVLN    EQU   $SSCPDAF                                                 01850000
$DAF     EQU   $DEVSESP+4                                               01851000
$VARYPAB EQU   $DEVSESP                                                 01852000
$SYSMN   EQU   $DEVTBLE+28                                              01853000
@NM00045 EQU   $DEVFLG3                                                 01854000
$CLRSNT  EQU   $DEVFLG3                                                 01855000
$OLTERR  EQU   $DEVFLG3                                                 01856000
$SRTEST  EQU   $DEVFLG3                                                 01857000
$DVSNDOK EQU   $SIOFLG                                                  01858000
$POLLREQ EQU   $DEVFLG3                                                 01859000
$ACQRED  EQU   $DEVFLG3                                                 01860000
$NOTDEV  EQU   $DEVFLG3                                                 01861000
$DVINCT  EQU   $DEVTBLE+26                                              01862000
$DVBRKST EQU   $OPND+1                                                  01863000
$DVBRKSN EQU   $OPND                                                    01864000
$DVSEQNO EQU   $OPIS                                                    01865000
$CEINTRP EQU   $DEVFLG2                                                 01866000
$TESTMDE EQU   $DEVFLG2                                                 01867000
$DEVALOC EQU   $DEVFLG2                                                 01868000
$ALLDATA EQU   $DEVFLG2                                                 01869000
$ENDCNTL EQU   $DEVFLG2                                                 01870000
$CTLDEV  EQU   $DEVFLG2                                                 01871000
$NOCDS   EQU   $DEVFLG2                                                 01872000
$DATAIN  EQU   $DEVFLG2                                                 01873000
$PRIMARY EQU   $DEVFLG1                                                 01874000
$DVCTBYT EQU   $INTOCC                                                  01875000
$DEVACT  EQU   $DEVFLG1                                                 01876000
$DVLGMDE EQU   $ATTNEXP                                                 01877000
$DVSPRM  EQU   $EVNCPLT                                                 01878000
$GRABBED EQU   $DEVFLG1                                                 01879000
$CATASTR EQU   $DEVFLG1                                                 01880000
$LETGO   EQU   $DEVFLG1                                                 01881000
$CURELEM EQU   $$SYMNME+4                                               01882000
$MSGOTSD EQU   $$SYMNME                                                 01883000
$EXTDEV  EQU   $DEVCDS+11                                               01884000
@NM00044 EQU   $DEVSDCF                                                 01885000
$NOTPRIM EQU   $DEVSDCF                                                 01886000
@NM00043 EQU   $DEVCDSF                                                 01887000
@NM00042 EQU   $DEVCDSF                                                 01888000
@NM00041 EQU   $DEVCDSF                                                 01889000
$CDSNAME EQU   $DEVCDSF                                                 01890000
$EXTRN   EQU   $DEVCDSF                                                 01891000
$CEVOLUM EQU   $DEVCDSF                                                 01892000
$SHARD   EQU   $DEVCDSF                                                 01893000
$DEVFPM  EQU   $DEVCDSF                                                 01894000
$DEVCNT  EQU   $DEVCDS+8                                                01895000
$DEVTYPE EQU   $DEVFEAT+3                                               01896000
$DEVCLAS EQU   $DEVFEAT+2                                               01897000
$DEVFRRS EQU   $DEVFEAT+1                                               01898000
$DEVMOD  EQU   $DEVFEAT                                                 01899000
$DEVRDGT EQU   @NM00039+1                                               01900000
$DEVCTLU EQU   @NM00039+1                                               01901000
$DEVCHAN EQU   @NM00039                                                 01902000
@NM00040 EQU   @NM00039                                                 01903000
$CTINDX  EQU   $DEVUNAD                                                 01904000
$FLAG16  EQU   $COMMFLG+15                                              01905000
$FLAG15  EQU   $COMMFLG+14                                              01906000
$FLAG14  EQU   $COMMFLG+13                                              01907000
$TEP2ND  EQU   $FLAG13                                                  01908000
$TEP1ST  EQU   $FLAG13                                                  01909000
$CATMSG  EQU   $FLAG13                                                  01910000
$PRMPTSW EQU   $FLAG13                                                  01911000
$DEVENT  EQU   $FLAG13                                                  01912000
$OLTMACC EQU   $FLAG13                                                  01913000
$LGON    EQU   $FLAG13                                                  01914000
$CTLOGON EQU   $FLAG13                                                  01915000
@NM00038 EQU   $FLAG12                                                  01916000
$VARYINP EQU   $FLAG12                                                  01917000
$ENDTEST EQU   $FLAG12                                                  01918000
$VRYHRD  EQU   $FLAG12                                                  01919000
$VRYSFT  EQU   $FLAG12                                                  01920000
$POSTFLG EQU   $FLAG12                                                  01921000
$OPTMSG  EQU   $FLAG12                                                  01922000
$FEORCAT EQU   $FLAG11                                                  01923000
@NM00037 EQU   $FLAG11                                                  01924000
@NM00036 EQU   $FLAG10                                                  01925000
$INBND   EQU   $FLAG10                                                  01926000
$WAITFLG EQU   $FLAG10                                                  01927000
$DPRINT  EQU   $FLAG10                                                  01928000
$HOLD    EQU   $FLAG9                                                   01929000
$NOTRRCH EQU   $FLAG9                                                   01930000
@NM00035 EQU   $FLAG9                                                   01931000
$LSTLNSW EQU   $FLAG9                                                   01932000
$MULLNSW EQU   $FLAG9                                                   01933000
$IGRES   EQU   $FLAG9                                                   01934000
$VS2     EQU   $FLAG8                                                   01935000
$VS1     EQU   $FLAG8                                                   01936000
$EDOS    EQU   $FLAG8                                                   01937000
@NM00034 EQU   $FLAG8                                                   01938000
$TWOWAY  EQU   $FLAG8                                                   01939000
@NM00033 EQU   $FLAG8                                                   01940000
$RCVMSG  EQU   $FLAG7                                                   01941000
$RCVRFLG EQU   $FLAG7                                                   01942000
$SNDRFLG EQU   $FLAG7                                                   01943000
$LDOIS   EQU   $FLAG7                                                   01944000
$DCONTCT EQU   $FLAG7                                                   01945000
$EXIOWAT EQU   $FLAG7                                                   01946000
$2NDDATA EQU   $FLAG7                                                   01947000
$1STDATA EQU   $FLAG7                                                   01948000
$CIREQ   EQU   $FLAG6                                                   01949000
$ABTERM  EQU   $ABNDBIT                                                 01950000
$FSTMCIS EQU   $FLAG6                                                   01951000
$DISCREQ EQU   $FLAG6                                                   01952000
$DISCISS EQU   $FLAG6                                                   01953000
$CTERROR EQU   $FLAG6                                                   01954000
$RECAL11 EQU   $FLAG6                                                   01955000
@NM00032 EQU   $FLAG5                                                   01956000
$PROGCK  EQU   $CANCEL                                                  01957000
$PRINTAP EQU   $FLAG5                                                   01958000
@NM00031 EQU   $FLAG5                                                   01959000
$MSG922  EQU   $FLAG5                                                   01960000
$CT924   EQU   $FLAG5                                                   01961000
$FSTCAT  EQU   $FLAG5                                                   01962000
$FSTFE   EQU   $FLAG5                                                   01963000
$ACTOPND EQU   $FLAG4                                                   01964000
$ACQCUTT EQU   $FLAG4                                                   01965000
$CLSSACT EQU   $FLAG4                                                   01966000
$BACKINT EQU   $FLAG4                                                   01967000
$DMSGSW  EQU   $FLAG4                                                   01968000
$TSTDEVP EQU   $FLAG4                                                   01969000
$APRQPER EQU   $FLAG4                                                   01970000
$OPCOM   EQU   $FLAG4                                                   01971000
$NEWAP   EQU   $FLAG3                                                   01972000
$ALTPRTR EQU   $FLAG3                                                   01973000
$OPTERR  EQU   $FLAG3                                                   01974000
$PRTONLY EQU   $FLAG3                                                   01975000
$REQSTOR EQU   $FLAG3                                                   01976000
$LOGOFFE EQU   $FLAG3                                                   01977000
$TSTERR  EQU   $FLAG3                                                   01978000
$DEVERR  EQU   $FLAG3                                                   01979000
$PARTIAL EQU   $FLAG2                                                   01980000
$NRMTERM EQU   $FLAG2                                                   01981000
$VALDTST EQU   $FLAG2                                                   01982000
$VALDDEV EQU   $FLAG2                                                   01983000
$DBLSLSH EQU   $FLAG2                                                   01984000
$NDR     EQU   $FLAG2                                                   01985000
@NM00030 EQU   $FLAG2                                                   01986000
$FTTHR   EQU   $FLAG2                                                   01987000
$OLTACT  EQU   $FLAG1                                                   01988000
$NORELDV EQU   $FLAG1                                                   01989000
@NM00029 EQU   $FLAG1                                                   01990000
$OPTCHNG EQU   $FLAG1                                                   01991000
$DEVCHNG EQU   $FLAG1                                                   01992000
$TESTCNG EQU   $FLAG1                                                   01993000
$CNSLFG  EQU   $FLAG1                                                   01994000
$TEP3RD  EQU   $FLAG1                                                   01995000
@NM00028 EQU   $CDA+120                                                 01996000
$CUCNT   EQU   $CDA+118                                                 01997000
@NM00027 EQU   $CDA+117                                                 01998000
$PRTFORM EQU   $CDA+116                                                 01999000
$OPISCNT EQU   $CDA+114                                                 02000000
$OPNDCNT EQU   $CDA+112                                                 02001000
$GETMSZE EQU   $CDA+110                                                 02002000
$GRCNTS  EQU   $CDA+108                                                 02003000
$CTLCNT  EQU   $CDA+106                                                 02004000
$ACTLVL  EQU   $CDA+105                                                 02005000
$PRNTLVL EQU   $CDA+104                                                 02006000
$ERRCNTA EQU   $CDA+102                                                 02007000
$TLCNT   EQU   $CDA+100                                                 02008000
$TIMEALW EQU   $CDA+96                                                  02009000
$PTRAREA EQU   $CDA+92                                                  02010000
$GETMPTR EQU   $CDA+88                                                  02011000
$R13PTRT EQU   $CDA+84                                                  02012000
$R13PTR  EQU   $CDA+80                                                  02013000
$TEPEND  EQU   $CDA+76                                                  02014000
$PLINKDL EQU   $CDA+72                                                  02015000
$TEPBEGN EQU   $CDA+68                                                  02016000
$FRELPTR EQU   $CDA+64                                                  02017000
$HIGHADR EQU   $HIMOREC                                                 02018000
$LOMOREC EQU   $CDA+56                                                  02019000
$ENDCOMM EQU   $CDA+48                                                  02020000
$COMMON  EQU   $RCA                                                     02021000
$SLASHAD EQU   $CDA+32                                                  02022000
$PASSON  EQU   $CDA+28                                                  02023000
$TOLBRTB EQU   $CDA+24                                                  02024000
$SCTPTR8 EQU   $CDA+20                                                  02025000
$SCTPTR  EQU   $CDA+16                                                  02026000
$TBWDPTR EQU   $CDA+12                                                  02027000
$TFWDPTR EQU   $CDA+8                                                   02028000
@NM00026 EQU   $CDA                                                     02029000
@NM00025 EQU   $SCTTBLE+98                                              02030000
$SCTLWTC EQU   $SCTTBLE+96                                              02031000
$SCTLWTA EQU   $SCTTBLE+92                                              02032000
#EXT     EQU   $SCTTBLE+88                                              02033000
#PASS    EQU   $SCTTBLE+84                                              02034000
#TABLE   EQU   $SCTTBLE+80                                              02035000
#MSGIDAC EQU   $SCTTBLE+78                                              02036000
@NM00024 EQU   $SCTTBLE+71                                              02037000
$RETMASK EQU   $SCTTBLE+70                                              02038000
$R249255 EQU   $ROUTMSK+29                                              02039000
$R241248 EQU   $ROUTMSK+28                                              02040000
$R233240 EQU   $ROUTMSK+27                                              02041000
$R225232 EQU   $ROUTMSK+26                                              02042000
$R217224 EQU   $ROUTMSK+25                                              02043000
$R209216 EQU   $ROUTMSK+24                                              02044000
$R201208 EQU   $ROUTMSK+23                                              02045000
$R193200 EQU   $ROUTMSK+22                                              02046000
$R185192 EQU   $ROUTMSK+21                                              02047000
$R177184 EQU   $ROUTMSK+20                                              02048000
$R169176 EQU   $ROUTMSK+19                                              02049000
$R161168 EQU   $ROUTMSK+18                                              02050000
$R153160 EQU   $ROUTMSK+17                                              02051000
$R145152 EQU   $ROUTMSK+16                                              02052000
$R137144 EQU   $ROUTMSK+15                                              02053000
$R129136 EQU   $ROUTMSK+14                                              02054000
$R121128 EQU   $ROUTMSK+13                                              02055000
$R113120 EQU   $ROUTMSK+12                                              02056000
$R105112 EQU   $ROUTMSK+11                                              02057000
$R097104 EQU   $ROUTMSK+10                                              02058000
$R089096 EQU   $ROUTMSK+9                                               02059000
$R081088 EQU   $ROUTMSK+8                                               02060000
$R073080 EQU   $ROUTMSK+7                                               02061000
$R065072 EQU   $ROUTMSK+6                                               02062000
$R057064 EQU   $ROUTMSK+5                                               02063000
$R049056 EQU   $ROUTMSK+4                                               02064000
$R041048 EQU   $ROUTMSK+3                                               02065000
$R033040 EQU   $ROUTMSK+2                                               02066000
$R025032 EQU   $ROUTMSK+1                                               02067000
$R017024 EQU   $ROUTMSK                                                 02068000
$TOTFLG2 EQU   $SCTTBLE+39                                              02069000
@NM00023 EQU   $TOTFLG1                                                 02070000
@NM00022 EQU   $TOTFLG1                                                 02071000
@NM00021 EQU   $TOTFLG1                                                 02072000
$CURELOD EQU   $TOTFLG1                                                 02073000
$CTEQTT  EQU   $TOTFLG1                                                 02074000
@NM00020 EQU   $TOTFLG1                                                 02075000
@NM00019 EQU   $TOTFLG1                                                 02076000
$LINESHR EQU   $TOTFLG1                                                 02077000
@NM00018 EQU   $OLTFLG2                                                 02078000
@NM00017 EQU   $OLTFLG2                                                 02079000
@NM00016 EQU   $OLTFLG2                                                 02080000
@NM00015 EQU   $OLTFLG2                                                 02081000
@NM00014 EQU   $OLTFLG2                                                 02082000
@NM00013 EQU   $OLTFLG2                                                 02083000
@NM00012 EQU   $OLTFLG2                                                 02084000
$TALK    EQU   $OLTFLG2                                                 02085000
$DYCOM   EQU   $OLTFLGS                                                 02086000
@NM00011 EQU   $OLTFLGS                                                 02087000
$TRACE   EQU   $OLTFLGS                                                 02088000
$RETCODE EQU   $OLTFLGS                                                 02089000
$CONTCB  EQU   $OLTFLGS                                                 02090000
$RETAIN  EQU   $OLTFLGS                                                 02091000
$CLEANRT EQU   $OLTFLGS                                                 02092000
$MANINTV EQU   $OLTFLGS                                                 02093000
$OLTSIZE EQU   $SCTTBLE+34                                              02094000
$QSCTMOD EQU   $EXECFLG                                                 02095000
$CTRLMOD EQU   $EXECFLG                                                 02096000
$CLEANUP EQU   $EXECFLG                                                 02097000
$LSTPDEV EQU   $EXECFLG                                                 02098000
$ERRCNT  EQU   $EXECFLG                                                 02099000
$RTNSLCT EQU   $EXECFLG                                                 02100000
$MULTDEV EQU   $EXECFLG                                                 02101000
@NM00010 EQU   $EXECFLG                                                 02102000
$RMSKCNT EQU   $SCTTBLE+32                                              02103000
$SYNAME  EQU   $CDS8T19+4                                               02104000
$EXTSIG  EQU   $CDS8T19+3                                               02105000
$CDFLGS  EQU   $CDS8T19+1                                               02106000
$CDSCNT  EQU   $CDS8T19                                                 02107000
$PDEVDSC EQU   $SCTTBLE+16                                              02108000
$PDEVADR EQU   $SCTTBLE+12                                              02109000
$COMMCN  EQU   $CDSFLGS                                                 02110000
$CUSTSYM EQU   $CDSFLGS                                                 02111000
$TWOCHSW EQU   $CDSFLGS                                                 02112000
$SYMNAME EQU   $CDSFLGS                                                 02113000
$EXTINTC EQU   $CDSFLGS                                                 02114000
$CEVOL   EQU   $CDSFLGS                                                 02115000
$SHARED  EQU   $CDSFLGS                                                 02116000
$FPM     EQU   $CDSFLGS                                                 02117000
$LASTSUB EQU   $PDEVFLG                                                 02118000
@NM00009 EQU   $PDEVFLG                                                 02119000
@NM00008 EQU   $PDEVFLG                                                 02120000
@NM00007 EQU   $PDEVFLG                                                 02121000
$LASTDEV EQU   $PDEVFLG                                                 02122000
@NM00006 EQU   $PDEVFLG                                                 02123000
$EXFILPT EQU   $PDEVFLG                                                 02124000
$FPMOLD  EQU   $PDEVFLG                                                 02125000
$TSSSYM  EQU   $SCTTBLE+8                                               02126000
$SCTLEVL EQU   $SCTTBLE+7                                               02127000
$DRIVER  EQU   $SCTTBLE+6                                               02128000
$RT0916  EQU   $SCTTBLE+5                                               02129000
$RT0108  EQU   $SCTTBLE+4                                               02130000
$LOOPTST EQU   $ERROPT                                                  02131000
$LOOPERR EQU   $ERROPT                                                  02132000
$NERRPRT EQU   $ERROPT                                                  02133000
$NOCNTRL EQU   $ERROPT                                                  02134000
$ALTPRNT EQU   $ERROPT                                                  02135000
$CATERR  EQU   $ERROPT                                                  02136000
$ASTERIK EQU   $ERROPT                                                  02137000
$TESTERR EQU   $ERROPT                                                  02138000
$FSTCOMM EQU   $TESTOPT                                                 02139000
$INDEFLP EQU   $TESTOPT                                                 02140000
$NOPRT   EQU   $TESTOPT                                                 02141000
$PARAPRT EQU   $TESTOPT                                                 02142000
@NM00005 EQU   $TESTOPT                                                 02143000
$ERRLPCT EQU   $SCTTBLE                                                 02144000
$TLTEND  EQU   $RCAAREA+945                                             02145000
$CNSLID  EQU   $RCAAREA+936                                             02146000
$EXITSAV EQU   $RCAAREA+864                                             02147000
$TRASCII EQU   $RCAAREA+608                                             02148000
@NM00004 EQU   $RCAAREA+605                                             02149000
$VTAMEND EQU   $RCAFLG                                                  02150000
$TPPOSTD EQU   $RCAFLG                                                  02151000
$NEWCT   EQU   $RCAFLG                                                  02152000
$ABNDALL EQU   $RCAFLG                                                  02153000
$CUTESTB EQU   $RCAFLG                                                  02154000
$CONSOLE EQU   $RCAFLG                                                  02155000
$TPLOGON EQU   $RCAFLG                                                  02156000
$UPDATE  EQU   $RCAFLG                                                  02157000
$DEVAREA EQU   $RCAAREA+600                                             02158000
$CTDVAR  EQU   $RCAAREA+596                                             02159000
$BUFFS   EQU   $RCAAREA+464                                             02160000
$TLTNIB  EQU   $CONSTNT+140                                             02161000
$TLTPRPL EQU   $CONSTNT+20                                              02162000
@NM00003 EQU   $CONSTNT+4                                               02163000
@NM00002 EQU   $CONSTNT+2                                               02164000
$USECNT  EQU   $CONSTNT                                                 02165000
$CURRTWA EQU   $POINTER+140                                             02166000
$CTNAME  EQU   $POINTER+132                                             02167000
$CTARGX  EQU   $POINTER+128                                             02168000
$COMINT  EQU   $POINTER+120                                             02169000
$QUEHNDL EQU   $POINTER+116                                             02170000
@NM00001 EQU   $POINTER+36                                              02171000
$RTNPTR  EQU   $POINTER+32                                              02172000
$TLTECB2 EQU   $POINTER+28                                              02173000
$TLTECB1 EQU   $POINTER+24                                              02174000
$CLEANP  EQU   $POINTER+20                                              02175000
$ABEND   EQU   $POINTER+16                                              02176000
$LSTAREA EQU   $POINTER+12                                              02177000
$FSTAREA EQU   $POINTER+8                                               02178000
$CVTSAVE EQU   $POINTER+4                                               02179000
$TOLTEP  EQU   $POINTER                                                 02180000
$TLTACB  EQU   $RCAAREA                                                 02181000
.@UNREFD ANOP                          END UNREFERENCED COMPONENTS      02182000
@RT00100 EQU   I00AC01C                                                 02183000
@RT00106 EQU   I00AC03                                                  02184000
@RT00130 EQU   I00AC09A                                                 02185000
@RT00139 EQU   I00AC08A                                                 02186000
@RT00154 EQU   I00AC04                                                  02187000
@RT00157 EQU   I00AC03B                                                 02188000
@RT00160 EQU   I00AC03B                                                 02189000
@RT00163 EQU   I00AC02                                                  02190000
@RT00172 EQU   I00AC05                                                  02191000
@RT00175 EQU   I00AC04A                                                 02192000
@RT00178 EQU   I00AC04A                                                 02193000
@RT00181 EQU   I00AC02                                                  02194000
@RT00190 EQU   I00AC06                                                  02195000
@RT00193 EQU   I00AC05A                                                 02196000
@RT00196 EQU   I00AC05A                                                 02197000
@RT00200 EQU   I00AC02                                                  02198000
@RT00209 EQU   I00AC07                                                  02199000
@RT00212 EQU   I00AC06A                                                 02200000
@RT00215 EQU   I00AC06A                                                 02201000
@RT00219 EQU   I00AC02                                                  02202000
@RT00228 EQU   I00AC08                                                  02203000
@RT00231 EQU   I00AC07A                                                 02204000
@RT00234 EQU   I00AC07A                                                 02205000
@RT00238 EQU   I00AC02                                                  02206000
@RT00247 EQU   I00AC09                                                  02207000
@RT00249 EQU   I00AC08B                                                 02208000
@RT00252 EQU   I00AC081                                                 02209000
@RT00254 EQU   I00AC08B                                                 02210000
@RT00260 EQU   I00AC08B                                                 02211000
@RT00270 EQU   I00AC08B                                                 02212000
@RT00275 EQU   I00AC02                                                  02213000
@RT00283 EQU   I00AC01C                                                 02214000
@RT00286 EQU   I00AC0A                                                  02215000
@RT00288 EQU   I00AC09B                                                 02216000
@RT00291 EQU   I00AC09B                                                 02217000
@RT00300 EQU   I00AC09B                                                 02218000
@RT00304 EQU   I00AC02                                                  02219000
@RT00312 EQU   I00AC01C                                                 02220000
@RT00315 EQU   I00AC0B                                                  02221000
@RT00318 EQU   I00AC0AA                                                 02222000
@RT00320 EQU   I00AC0AC                                                 02223000
@RT00325 EQU   I00AC0AC                                                 02224000
@RT00333 EQU   I00AC0AC                                                 02225000
@RC00335 EQU   @RC00330                                                 02226000
@RT00341 EQU   I00AC0AC                                                 02227000
@RT00345 EQU   I00AC0AC                                                 02228000
@RT00348 EQU   I00AC0AC                                                 02229000
@RT00358 EQU   I00AC02                                                  02230000
@RT00367 EQU   I00ACRET                                                 02231000
@RC00374 EQU   @EL00001                                                 02232000
@RF00389 EQU   @EL00001                                                 02233000
@RT00400 EQU   I00ACL02                                                 02234000
@RT00438 EQU   I00ACL01                                                 02235000
@RC00377 EQU   @RC00374                                                 02236000
@RF00382 EQU   @RC00374                                                 02237000
@ENDDATA EQU   *                                                        02238000
         END   ISTIC00A,(C'PLS2006',0702,79129)                         02239000
./  ADD  SSI=83360119,NAME=ISTIC003
         TITLE 'ISTIC003-DEVICE DECODE'                                 00001000
ISTIC003 CSECT ,                                                   0001 00002000
@MAINENT DS    0H                                                  0001 00003000
         USING *,@15                                               0001 00004000
         B     @PROLOG                                             0001 00005000
         DC    AL1(16)                                             0001 00006000
         DC    C'ISTIC003  78.336'                                 0001 00007000
         DROP  @15                                                      00008000
@PROLOG  STM   @14,@12,12(@13)                                     0001 00009000
         BALR  @12,0                                               0001 00010000
@PSTART  DS    0H                                                  0001 00011000
         USING @PSTART,@12                                         0001 00012000
*   R4=R13;                         /* CALLERS SAVE AREA             */ 00013000
         LR    R4,R13                                              0048 00014000
*   R13=ADDR(SVEIC003);             /* GET ADDR OF MY SAVE           */ 00015000
         LA    R13,SVEIC003(,WAPTR)                                0049 00016000
*   BACKSAVE(3)=R13;                /* INTO CALLERS SAVE             */ 00017000
         ST    R13,BACKSAVE+8(,R4)                                 0050 00018000
*   SVEIC003(2)=R4;                 /* INTO MY SAVE                  */ 00019000
         ST    R4,SVEIC003+4(,WAPTR)                               0051 00020000
*   R5=ADDR($DTORESP)+1;            /* ADDRESS OF INPUT              */ 00021000
         LA    R5,$DTORESP(,WAPTR)                                 0052 00022000
         AL    R5,@CF00072                                         0052 00023000
*   $VALDDEV='0'B;                  /* NO VALID DEVICES YET          */ 00024000
*   $PARTIAL='0'B;                  /* INIT PARTIAL ERROR FLAG       */ 00025000
*   $NDR='0'B;                      /* NO DEVICE REQ FLAG            */ 00026000
         NI    $VALDDEV(WAPTR),B'11010110'                         0055 00027000
*   $MULTDEV='0'B;                  /* MORE THAN 1 DEVICE            */ 00028000
         NI    $MULTDEV(WAPTR),B'10111111'                         0056 00029000
*   CDSINFO=CDSINFO&&CDSINFO;       /* INIT ACQ INPUT                */ 00030000
         XC    CDSINFO(20),CDSINFO                                 0057 00031000
*DEV005:                            /* START DECODING                */ 00032000
*   X6=1;                           /* DEVICE COUNT                  */ 00033000
DEV005   MVC   X6(4),@CF00072                                      0058 00034000
*   $DEVCNTS=2;                     /* DEVICE COUNT                  */ 00035000
         MVC   $DEVCNTS(2,WAPTR),@CH00139                          0059 00036000
*   X8=3;                           /* SET INDEX TO 3RD TABLE        */ 00037000
         LA    @14,3                                               0060 00038000
         ST    @14,X8                                              0060 00039000
*   DO I=3 TO 18 BY 1;              /* CLEAR DEVTABLE                */ 00040000
         STH   @14,I                                               0061 00041000
@DL00061 DS    0H                                                  0062 00042000
*     $DEVTBLE(I)=$DEVTBLE(I)&&$DEVTBLE(I);                        0062 00043000
         LR    @08,@14                                             0062 00044000
         MH    @08,@CH00375                                        0062 00045000
         ALR   @08,WAPTR                                           0062 00046000
         XC    $DEVTBLE-68(68,@08),$DEVTBLE-68(@08)                0062 00047000
*   END;                                                           0063 00048000
         AL    @14,@CF00072                                        0063 00049000
         STH   @14,I                                               0063 00050000
         C     @14,@CF00085                                        0063 00051000
         BNH   @DL00061                                            0063 00052000
*   IF $DEVERR='1'B THEN            /* PREVIOUS DECODE ERROR         */ 00053000
         TM    $DEVERR(WAPTR),B'10000000'                          0064 00054000
         BO    @RT00064                                            0064 00055000
*     GO TO DEV007;                 /* YES ,TAKE BRANCH              */ 00056000
*   IF INPUTBUF(1:5)=NDR(1:5) THEN  /* CHECK FOR NDR SPECIFIED       */ 00057000
         CLC   INPUTBUF(5,R5),NDR                                  0066 00058000
         BNE   @RF00066                                            0066 00059000
*     DO;                           /* YES                           */ 00060000
*       $NDR='1'B;                  /* YES                           */ 00061000
         OI    $NDR(WAPTR),B'00100000'                             0068 00062000
*       $DEVCNTS=3;                 /* SET DEVICE COUNT              */ 00063000
         MVC   $DEVCNTS(2,WAPTR),@CH00081                          0069 00064000
*       $NOTDEV(X8)='1'B;           /* NOT A DEVICE                  */ 00065000
         L     @14,X8                                              0070 00066000
         MH    @14,@CH00375                                        0070 00067000
         ALR   @14,WAPTR                                           0070 00068000
         OI    $NOTDEV-68(@14),B'10000000'                         0070 00069000
*       $VALDDEV='1'B;              /* INDICATE VALID ENTRY          */ 00070000
         OI    $VALDDEV(WAPTR),B'00001000'                         0071 00071000
*       GO TO DEV840;               /* RETURN TO CALLER              */ 00072000
         B     DEV840                                              0072 00073000
*     END;                                                         0073 00074000
*   IF INPUTBUF(1:2)=CTST(1:2) THEN /* CHK FOR ASTERISK ENT          */ 00075000
@RF00066 CLC   INPUTBUF(2,R5),CTST                                 0074 00076000
         BNE   @RF00074                                            0074 00077000
*     DO;                           /* YES ,CT TEST                  */ 00078000
*                                                                  0075 00079000
*       /*************************************************************/ 00080000
*       /*                                                           */ 00081000
*       /* CANNOT ALLOW SYSTEM CONSOL TO ENTER ,CHECK IT             */ 00082000
*       /*                                                           */ 00083000
*       /*************************************************************/ 00084000
*                                                                  0076 00085000
*       IF $SYSMN(1)=SYSCON THEN                                   0076 00086000
         CLC   $SYSMN(8,WAPTR),SYSCON                              0076 00087000
         BE    @RT00076                                            0076 00088000
*         GO TO DEV007;             /* BAD ENTRY,ERROR               */ 00089000
*       INTAREB=$SYSMN(1);          /* MOVE TO WORK AREA             */ 00090000
         LA    @14,INTAREA                                         0078 00091000
         MVI   INTAREB+8(@14),C' '                                 0078 00092000
         MVC   INTAREB(8,@14),$SYSMN(WAPTR)                        0078 00093000
*       DO I=1 TO 9;                /* NO. OF CHARS TO SCAN          */ 00094000
         LA    @14,1                                               0079 00095000
         STH   @14,I                                               0079 00096000
@DL00079 DS    0H                                                  0080 00097000
*         IF INTAREA(I)=' ' THEN    /* SCAN FOR BLANK                */ 00098000
         LA    @08,INTAREA-1(@14)                                  0080 00099000
         CLI   0(@08),C' '                                         0080 00100000
         BNE   @RF00080                                            0080 00101000
*           DO;                     /* BLANK FOUND                   */ 00102000
*             INTAREA(I)='/';       /* REPLACE WITH SLASH            */ 00103000
         LA    @08,INTAREA-1(@14)                                  0082 00104000
         MVI   0(@08),C'/'                                         0082 00105000
*             GO TO DEV006;         /* DO NORM DECODE                */ 00106000
         B     DEV006                                              0083 00107000
*           END;                                                   0084 00108000
*       END;                                                       0085 00109000
@RF00080 LA    @14,1                                               0085 00110000
         AH    @14,I                                               0085 00111000
         STH   @14,I                                               0085 00112000
         C     @14,@CF00087                                        0085 00113000
         BNH   @DL00079                                            0085 00114000
*DEV006:                            /* FOR CT TEST                   */ 00115000
*       R5=ADDR(INTAREA);           /* INPUT=WORKAREA                */ 00116000
DEV006   LA    R5,INTAREA                                          0086 00117000
*     END;                                                         0087 00118000
*DEV007:                                                           0088 00119000
*   INTFLAGS=INTFLAGS&&INTFLAGS;    /* CLEAR INTERNAL FLAGS          */ 00120000
@RF00074 DS    0H                                                  0088 00121000
DEV007   XC    INTFLAGS(1),INTFLAGS                                0088 00122000
*DEV008:                                                           0089 00123000
*   X7=R5;                          /* SET BEGIN ENTRY PTR           */ 00124000
DEV008   ST    R5,X7                                               0089 00125000
*DEV009:                            /* CHECK FOR TYPE OF ENTRY,UA OR    00126000
*                                      SYM NAME                      */ 00127000
*   IF INPUTBUF(1)>'Z' THEN         /* NUMERIC ENTRY                 */ 00128000
DEV009   CLI   INPUTBUF(R5),C'Z'                                   0090 00129000
         BNH   @RF00090                                            0090 00130000
*     DO;                           /* YES,UNIT ADDRESS              */ 00131000
*       IF SYM='1'B THEN            /* PREVIOUS SYM NME ENTRY        */ 00132000
         TM    SYM,B'10000000'                                     0092 00133000
         BO    @RT00092                                            0092 00134000
*         GO TO DEV600;             /* MIXED MODE ERROR              */ 00135000
*       UNITAD='1'B;                /* SET FLG FOR UNIT ADDR         */ 00136000
*       DEV='1'B;                   /* SET 2ND FLG FOR UA            */ 00137000
         OI    UNITAD,B'01010000'                                  0095 00138000
*       GO TO DEV012;               /* CONTINUE DECODING             */ 00139000
         B     DEV012                                              0096 00140000
*     END;                                                         0097 00141000
*                                                                  0097 00142000
*   /*****************************************************************/ 00143000
*   /*                                                               */ 00144000
*   /* SYMBOLIC NAME ENTERED                                         */ 00145000
*   /*                                                               */ 00146000
*   /*****************************************************************/ 00147000
*                                                                  0098 00148000
*   IF UNITAD='1'B THEN             /* PREVIOUS UA ENTERED           */ 00149000
@RF00090 TM    UNITAD,B'00010000'                                  0098 00150000
         BO    @RT00098                                            0098 00151000
*     GO TO DEV600;                 /* YES,MIXED MODE ERROR          */ 00152000
*   SYM='1'B;                       /* SET FLG FOR SYM NM ENT        */ 00153000
         OI    SYM,B'10000000'                                     0100 00154000
*   IF DASH='1'B|                   /* INCLUSIVE SYM NAMES,ERROR     */ 00155000
*       DEV='1'B THEN               /* CHAR IN SYM NAME              */ 00156000
         TM    DASH,B'01100000'                                    0101 00157000
         BNZ   @RT00101                                            0101 00158000
*     GO TO DEV800;                 /* INCL RANGE NOT ALLOWED        */ 00159000
*DEV010:                                                           0103 00160000
*   IF INPUTBUF(1)='$'|             /* CHK FOR VALID                 */ 00161000
*       INPUTBUF(1)='@'|            /* SYMBOLIC NAME                 */ 00162000
*       INPUTBUF(1)='#'|INPUTBUF(1)>='A' THEN                      0103 00163000
DEV010   CLI   INPUTBUF(R5),C'$'                                   0103 00164000
         BE    @RT00103                                            0103 00165000
         CLI   INPUTBUF(R5),C'@'                                   0103 00166000
         BE    @RT00103                                            0103 00167000
         CLI   INPUTBUF(R5),C'#'                                   0103 00168000
         BE    @RT00103                                            0103 00169000
         CLI   INPUTBUF(R5),C'A'                                   0103 00170000
         BL    @RF00103                                            0103 00171000
@RT00103 DS    0H                                                  0104 00172000
*     DO;                                                          0104 00173000
*       GO TO DEV012;               /* CONTINUE DECODING             */ 00174000
         B     DEV012                                              0105 00175000
*     END;                                                         0106 00176000
*   ELSE                                                           0107 00177000
*     DO;                                                          0107 00178000
@RF00103 DS    0H                                                  0108 00179000
*       GO TO DEV800;               /* INVALID CHAR                  */ 00180000
         B     DEV800                                              0108 00181000
*     END;                                                         0109 00182000
*DEV012:                                                           0110 00183000
*   R5=R5+1;                        /* INCR INPUT PTR                */ 00184000
DEV012   AL    R5,@CF00072                                         0110 00185000
*   IF INPUTBUF(1)='(' THEN         /* SESSPARM SPECIFIED    @D32JPFR*/ 00186000
         CLI   INPUTBUF(R5),C'('                                   0111 00187000
         BE    @RT00111                                            0111 00188000
*     GOTO DEV030;                  /* YES,CONTINUE DECODING @D32JPFR*/ 00189000
*   IF INPUTBUF(1)<'-' THEN         /* CHECK FOR DASH                */ 00190000
         CLI   INPUTBUF(R5),C'-'                                   0113 00191000
         BL    @RT00113                                            0113 00192000
*     GO TO DEV020;                 /* NO                            */ 00193000
*   IF INPUTBUF(1)<=',' THEN        /* CHECK FOR COMMA               */ 00194000
         CLI   INPUTBUF(R5),C','                                   0115 00195000
         BNH   @RT00115                                            0115 00196000
*     GO TO DEV030;                 /* BRANCH IF DELIMITER           */ 00197000
*DEV020:                                                           0117 00198000
*   IF R5=X7+8 THEN                 /* CHK FOR ENTRY> 8 CHARS        */ 00199000
DEV020   LA    @14,8                                               0117 00200000
         AL    @14,X7                                              0117 00201000
         CR    R5,@14                                              0117 00202000
         BE    @RT00117                                            0117 00203000
*     GO TO DEV800;                 /* YES,ERROR                     */ 00204000
*   GO TO DEV010;                   /* CONTINUE DECODING             */ 00205000
         B     DEV010                                              0119 00206000
*DEV030:                            /* CHECK FOR VALID SIZE OF ENTRY */ 00207000
*   DEV='0'B;                       /* RESET 2ND UA FLAG             */ 00208000
DEV030   NI    DEV,B'10111111'                                     0120 00209000
*   X10=R5-X7;                      /* COMPUTE ENTRY SIZE            */ 00210000
         LR    @14,R5                                              0121 00211000
         SL    @14,X7                                              0121 00212000
         ST    @14,X10                                             0121 00213000
*   IF SYM='1'B THEN                /* SYMBOLIC NAME ?               */ 00214000
         TM    SYM,B'10000000'                                     0122 00215000
         BO    @RT00122                                            0122 00216000
*     GO TO DEV040;                 /* GO SET UP FOR CONFIG          */ 00217000
*   IF X10>4|                       /* VALID SIZE FOR UNIT           */ 00218000
*       X10<3 THEN                  /* ADDRESS                       */ 00219000
         C     @14,@CF00068                                        0124 00220000
         BH    @RT00124                                            0124 00221000
         C     @14,@CF00081                                        0124 00222000
         BL    @RT00124                                            0124 00223000
*     GO TO DEV072;                 /* NO,ERROR                      */ 00224000
*   WORKB=EBCF0;                    /* INIT WORK AREA                */ 00225000
         MVC   WORKB(8),EBCF0                                      0126 00226000
*   N=8;                            /* MAX UNIT ADDR SIZE            */ 00227000
         MVC   N(2),@CH00054                                       0127 00228000
*   DO I=X10 TO 1 BY-1;             /* MOVE UNIT ADDRESS             */ 00229000
         STH   @14,I                                               0128 00230000
         B     @DE00128                                            0128 00231000
@DL00128 DS    0H                                                  0129 00232000
*     WORKB(N)=INPUT(I);            /* INTO WORKAREA                 */ 00233000
         LH    @08,N                                               0129 00234000
         LA    @11,WORKB-1(@08)                                    0129 00235000
         L     @10,X7                                              0129 00236000
         ALR   @10,@14                                             0129 00237000
         BCTR  @10,0                                               0129 00238000
         MVC   0(1,@11),INPUT(@10)                                 0129 00239000
*     N=N-1;                        /* DECR INDEX                    */ 00240000
         BCTR  @08,0                                               0130 00241000
         STH   @08,N                                               0130 00242000
*   END;                                                           0131 00243000
         BCTR  @14,0                                               0131 00244000
         STH   @14,I                                               0131 00245000
@DE00128 LTR   @14,@14                                             0131 00246000
         BP    @DL00128                                            0131 00247000
*   IF DASH='0'B THEN               /* IF DASH HAS NOT BEEN          */ 00248000
         TM    DASH,B'00100000'                                    0132 00249000
         BNZ   @RF00132                                            0132 00250000
*     DO;                           /* ENCOUNTERED MOVE UNIT         */ 00251000
*       WORKA=WORKB;                /* ADDR INTO BEGIN OF            */ 00252000
         MVC   WORKA(8),WORKB                                      0134 00253000
*       WORKB=EBCF0;                /* WORKAREA EXTENT AND           */ 00254000
         MVC   WORKB(8),EBCF0                                      0135 00255000
*     END;                          /* INIT END EXTENT               */ 00256000
*   IF X10=4&                       /* IF CHAR CNT IS 4 FOR          */ 00257000
*       INPUT(1)¬='0' THEN          /* UNIT ADDR BUT 1ST CHAR        */ 00258000
@RF00132 CLC   X10(4),@CF00068                                     0137 00259000
         BNE   @RF00137                                            0137 00260000
         L     @14,X7                                              0137 00261000
         CLI   INPUT(@14),C'0'                                     0137 00262000
         BNE   @RT00137                                            0137 00263000
*     GO TO DEV800;                 /* IS NOT ZERO,ERROR             */ 00264000
*   IF INPUTBUF(1)¬='-' THEN        /* IF EXTENT NOT SPECIFIED       */ 00265000
@RF00137 CLI   INPUTBUF(R5),C'-'                                   0139 00266000
         BNE   @RT00139                                            0139 00267000
*     GO TO DEV070;                 /* GO CONVERT UA TO HEX          */ 00268000
*   R5=R5+1;                        /* DASH FOUND,PT TO NEXT         */ 00269000
         AL    R5,@CF00072                                         0141 00270000
*   IF DASH='1'B THEN               /* IF DASH PREVIOUSLY FND        */ 00271000
         TM    DASH,B'00100000'                                    0142 00272000
         BO    @RT00142                                            0142 00273000
*     GO TO DEV800;                 /* GO TO ERROR HNDLING           */ 00274000
*   DASH='1'B;                      /* SET DASH FLAG ON              */ 00275000
         OI    DASH,B'00100000'                                    0144 00276000
*   GO TO DEV008;                   /* GO PROCESS HIGH EXTENT        */ 00277000
         B     DEV008                                              0145 00278000
*DEV040:                            /* SYMBOLIC NAME PROCESS         */ 00279000
*   IF INPUTBUF(1)='-' THEN         /* INCLUSIVE RANGE NOT           */ 00280000
DEV040   CLI   INPUTBUF(R5),C'-'                                   0146 00281000
         BE    @RT00146                                            0146 00282000
*     GO TO DEV800;                 /* ALLOWED W/SYMBOLIC NAME       */ 00283000
*   CDSSYM=' ';                     /* INIT SYMBOLIC NAME AREA       */ 00284000
         MVI   CDSSYM+1,C' '                                       0148 00285000
         MVC   CDSSYM+2(6),CDSSYM+1                                0148 00286000
         MVI   CDSSYM,C' '                                         0148 00287000
*   CDSSYM(1:X10)=INPUT(1:X10);     /* MOVE IN SYMBOLIC NAME         */ 00288000
         L     @14,X10                                             0149 00289000
         BCTR  @14,0                                               0149 00290000
         L     @08,X7                                              0149 00291000
         EX    @14,@SM00814                                        0149 00292000
*   CDSINFO(10)='0A'X;              /* SET REMOTE FILE FLAG          */ 00293000
         MVI   CDSINFO+9,X'0A'                                     0150 00294000
*   GO TO DEV080;                   /* GO GETCONFG                   */ 00295000
         B     DEV080                                              0151 00296000
*DEV050:                            /* CHECK FOR END OF DEVICE FIELD */ 00297000
*   IF INPUTBUF(1)='/' THEN         /* IF END OF DEV FLD GO          */ 00298000
DEV050   CLI   INPUTBUF(R5),C'/'                                   0152 00299000
         BE    @RT00152                                            0152 00300000
*     GO TO DEV120;                 /* SET UP GOOD RETURN            */ 00301000
*   R5=R5+1;                        /* INCR INPUT PTR                */ 00302000
         AL    R5,@CF00072                                         0154 00303000
*   GO TO DEV008;                   /* DECODE NEXT ENTRY             */ 00304000
         B     DEV008                                              0155 00305000
*DEV070:                            /* CONVERT UNIT ADDRESS          */ 00306000
*                                                                  0156 00307000
*   /*****************************************************************/ 00308000
*   /*                                                               */ 00309000
*   /* ITACONV FROM(WORK)TO(WORKC)TYPE(EH)COUNT(16) INVOKED          */ 00310000
*   /*                                                               */ 00311000
*   /*****************************************************************/ 00312000
*                                                                  0156 00313000
*   DCL                                                            0156 00314000
*     1 ITATCPRM BDY(WORD),         /* CONVERT PARAMETER LIST        */ 00315000
*      2 * CHAR(4) INIT('0102F4F1'X),                              0156 00316000
*      2 ITATCFR PTR,               /* ADDRESS OF FROM FIELD         */ 00317000
*      2 ITATCTO PTR,               /* ADDRESS OF TO FIELD           */ 00318000
*      2 * BIT(8) INIT(0),          /* FLAGS FOR CONVERT MODULE      */ 00319000
*       3 ITATCTP BIT(1),           /* TYPE OF CONVERT REQUIRED      */ 00320000
*      2 ITATCNT FIXED(8);          /* NUMBER OF BYTES TO CONVERT    */ 00321000
DEV070   DS    0H                                                  0157 00322000
*   ITATCFR=ADDR(WORK);             /* SET THE FROM ADDRESS          */ 00323000
         LA    @14,WORK                                            0157 00324000
         ST    @14,ITATCFR                                         0157 00325000
*   ITATCTO=ADDR(WORKC);            /* SET THE TO ADDRESS            */ 00326000
         LA    @14,WORKC                                           0158 00327000
         ST    @14,ITATCTO                                         0158 00328000
*   ITATCTP='0'B;                   /* SET THE TYPE OF CONVERT BIT   */ 00329000
         NI    ITATCTP,B'01111111'                                 0159 00330000
*   ITATCNT=16;                     /* GIVE THE CONVERT BYTE COUNT   */ 00331000
         MVI   ITATCNT,X'10'                                       0160 00332000
*   R1=ADDR(ITATCPRM);              /* POINT TO CONVERT PARM LIST    */ 00333000
         LA    R1,ITATCPRM                                         0161 00334000
*   CALL ISTSC021;                  /* CALL CONVERT DIRECTLY         */ 00335000
         L     @15,@CV00739                                        0162 00336000
         BALR  @14,@15                                             0162 00337000
*   IF R15¬=0 THEN                  /* ERROR CONVERTING ?            */ 00338000
         LTR   R15,R15                                             0163 00339000
         BNZ   @RT00163                                            0163 00340000
*     GO TO DEV072;                 /* YES                           */ 00341000
*   IF DASH='1'B THEN               /* INCLUSIVE UA RANGE            */ 00342000
         TM    DASH,B'00100000'                                    0165 00343000
         BNO   @RF00165                                            0165 00344000
*     DO;                           /* YES,CONTINUE                  */ 00345000
*       IF WORKC1>=WORKD THEN       /* VALID INCLU RANGE             */ 00346000
         CLC   WORKC1(4),WORKD                                     0167 00347000
         BL    @RF00167                                            0167 00348000
*         DO;                       /* NO,ERROR                      */ 00349000
*DEV072:                            /* POINT TO ERROR CHARACTER      */ 00350000
*           R5=R5-1;                /* PT TO ERROR                   */ 00351000
DEV072   BCTR  R5,0                                                0169 00352000
*           GO TO DEV800;           /* ISSUE 108 MSG                 */ 00353000
         B     DEV800                                              0170 00354000
*         END;                                                     0171 00355000
*     END;                                                         0172 00356000
@RF00167 DS    0H                                                  0173 00357000
*DEV075:                                                           0173 00358000
*   CDSINFO(3:4)=WORKC(3:4);        /* MOVE UNIT ADDR TO CONFG       */ 00359000
@RF00165 DS    0H                                                  0173 00360000
DEV075   MVC   CDSINFO+2(2),WORKC+2                                0173 00361000
*   CDSINFO(10)='00'X;              /* SET REMOTE FILE FLAG          */ 00362000
         MVI   CDSINFO+9,X'00'                                     0174 00363000
*   CDSSYM=CDSSYM&&CDSSYM;          /* INIT SYM NAME AREA            */ 00364000
         XC    CDSSYM(8),CDSSYM                                    0175 00365000
*DEV080:                                                           0176 00366000
*   R1=ADDR(ACQPARM);               /* ADDR OF PARM LIST             */ 00367000
DEV080   LA    R1,ACQPARM                                          0176 00368000
*   CALL ISTSC030;                  /* ACQUISITION MODULE            */ 00369000
         L     @15,@CV00745                                        0177 00370000
         BALR  @14,@15                                             0177 00371000
*   IF R15¬=0 THEN                  /* ERROR ?                       */ 00372000
         LTR   R15,R15                                             0178 00373000
         BZ    @RF00178                                            0178 00374000
*     DO;                           /* YES                           */ 00375000
*       SKIPENT='1'B;               /* BAD ENTRY                     */ 00376000
         OI    SKIPENT,B'00001000'                                 0180 00377000
*       $PARTIAL='1'B;              /* SET PARTIAL ERROR FLAG        */ 00378000
         OI    $PARTIAL(WAPTR),B'00000001'                         0181 00379000
*       GO TO DEV170;               /* SKIP THIS ENTRY               */ 00380000
         B     DEV170                                              0182 00381000
*     END;                                                         0183 00382000
*   IF NOCDS='0'B THEN                                             0184 00383000
@RF00178 TM    NOCDS,B'00000100'                                   0184 00384000
         BNZ   @RF00184                                            0184 00385000
*     DO;                           /* CDS WAS FOUND         @D32JPFR*/ 00386000
*       IF INPUTBUF(1)='(' THEN     /* SESSPARM SPECIFIED    @D32JPFR*/ 00387000
         CLI   INPUTBUF(R5),C'('                                   0186 00388000
         BNE   @RF00186                                            0186 00389000
*         DO;                       /* YES                   @D32JPFR*/ 00390000
*           IF DEVLU='1'B THEN      /* IS DEV AN LU          @D32JPFR*/ 00391000
         TM    DEVLU+2376(WAPTR),B'00001000'                       0188 00392000
         BNO   @RF00188                                            0188 00393000
*             DO;                   /* YES                   @D32JPFR*/ 00394000
*               IF INPUTBUF(2:3)='X''' THEN/* BIND PARMS SPECIFIED 0190 00395000
*                                                            @ZD10882*/ 00396000
         CLC   INPUTBUF+1(2,R5),@CC00747                           0190 00397000
         BNE   @RF00190                                            0190 00398000
*                 DO;               /* YES                   @D32JPFR*/ 00399000
*                   R5=R5+15;       /* PT TO MATCHING QUOTE  @D32JPFR*/ 00400000
         AL    R5,@CF00058                                         0192 00401000
*                   IF INPUTBUF(1)¬='''' THEN/* IS QUOTE THERE     0193 00402000
*                                                            @D32JPFR*/ 00403000
         CLI   INPUTBUF(R5),C''''                                  0193 00404000
         BNE   @RT00193                                            0193 00405000
*                     GOTO DEV800;  /* NO,MUST CONTAIN 12 CHARS    0194 00406000
*                                                            @D32JPFR*/ 00407000
*                   X7=R5-12;       /* PT TO FIRST CHAR OF INPUT   0195 00408000
*                                                            @D32JPFR*/ 00409000
*                                                                  0195 00410000
         LR    @14,R5                                              0195 00411000
         SL    @14,@CF00136                                        0195 00412000
         ST    @14,X7                                              0195 00413000
*                   /*************************************************/ 00414000
*                   /*                                               */ 00415000
*                   /* ITACONV                                       */ 00416000
*                   /* FROM(INPUT)TO($DEVSESP(X8))TYPE(EH)COUNT(12)  */ 00417000
*                   /* INVOKED                                       */ 00418000
*                   /*                                               */ 00419000
*                   /*************************************************/ 00420000
*                                                                  0196 00421000
*                   ITATCFR=ADDR(INPUT);/* SET THE FROM ADDRESS      */ 00422000
         ST    @14,ITATCFR                                         0196 00423000
*                   ITATCTO=ADDR($DEVSESP(X8));/* SET THE TO ADDRESS */ 00424000
         L     @14,X8                                              0197 00425000
         MH    @14,@CH00375                                        0197 00426000
         LA    @14,$DEVSESP-68(@14,WAPTR)                          0197 00427000
         ST    @14,ITATCTO                                         0197 00428000
*                   ITATCTP='0'B;   /* SET THE TYPE OF CONVERT BIT   */ 00429000
         NI    ITATCTP,B'01111111'                                 0198 00430000
*                   ITATCNT=12;     /* GIVE THE CONVERT BYTE COUNT   */ 00431000
         MVI   ITATCNT,X'0C'                                       0199 00432000
*                   R1=ADDR(ITATCPRM);/* POINT TO CONVERT PARM LIST  */ 00433000
         LA    R1,ITATCPRM                                         0200 00434000
*                   CALL ISTSC021;  /* CALL CONVERT DIRECTLY         */ 00435000
         L     @15,@CV00739                                        0201 00436000
         BALR  @14,@15                                             0201 00437000
*                   IF R15¬=0 THEN  /* GOOD RET FROM CONVERT @D32JPFR*/ 00438000
         LTR   R15,R15                                             0202 00439000
         BNZ   @RT00202                                            0202 00440000
*                     GOTO DEV072;  /* NO                    @D32JPFR*/ 00441000
*                   $DVSPRM(X8)='1'B;/* FLAG INDICATING BIND PARMS 0204 00442000
*                                      SPECIFIED             @D32JPFR*/ 00443000
         L     @14,X8                                              0204 00444000
         MH    @14,@CH00375                                        0204 00445000
         ALR   @14,WAPTR                                           0204 00446000
         OI    $DVSPRM-68(@14),B'00010000'                         0204 00447000
*                   R5=R5+1;        /* SKIP OVER QUOTE       @ZD10882*/ 00448000
         AL    R5,@CF00072                                         0205 00449000
*                   GOTO DEV086;    /*                       @D32JPFR*/ 00450000
         B     DEV086                                              0206 00451000
*                 END;              /* 2D32JPFR                      */ 00452000
*               X7=R5+1;            /* PT TO FIRST CHAR OF NAME    0208 00453000
*                                                            @D32JPFR*/ 00454000
@RF00190 LA    @14,1                                               0208 00455000
         ALR   @14,R5                                              0208 00456000
         ST    @14,X7                                              0208 00457000
*DEV082:                            /* PROCESS NIB NAME      @D32JPFR*/ 00458000
*               R5=R5+1;            /* PT TO FIRST CHAR OF NAME    0209 00459000
*                                                            @D32JPFR*/ 00460000
DEV082   AL    R5,@CF00072                                         0209 00461000
*               IF INPUTBUF(1)='$'| /* CHK FOR VALID SYMBOLIC NAME 0210 00462000
*                                                            @D32JPFR*/ 00463000
*                   INPUTBUF(1)='@'|/*                       @D32JPFR*/ 00464000
*                   INPUTBUF(1)='#'|/*                       @D32JPFR*/ 00465000
*                   INPUTBUF(1)>='A'&/*                      @D32JPFR*/ 00466000
*                   INPUTBUF(1)<='Z' THEN/*                  @D32JPFR*/ 00467000
         CLI   INPUTBUF(R5),C'$'                                   0210 00468000
         BE    @RT00210                                            0210 00469000
         CLI   INPUTBUF(R5),C'@'                                   0210 00470000
         BE    @RT00210                                            0210 00471000
         CLI   INPUTBUF(R5),C'#'                                   0210 00472000
         BE    @RT00210                                            0210 00473000
         CLI   INPUTBUF(R5),C'A'                                   0210 00474000
         BL    @RF00210                                            0210 00475000
         CLI   INPUTBUF(R5),C'Z'                                   0210 00476000
         BH    @RF00210                                            0210 00477000
@RT00210 DS    0H                                                  0211 00478000
*                 DO COUNT=1 TO 8;  /* CHECK TO SEE HOW LONG THE NAME   00479000
*                                      IS                    @ZD10882*/ 00480000
         LA    COUNT,1                                             0211 00481000
@DL00211 DS    0H                                                  0212 00482000
*                   R5=R5+1;        /* POINT TO THE NEXT CHARACTER 0212 00483000
*                                                            @ZD10882*/ 00484000
         AL    R5,@CF00072                                         0212 00485000
*                   IF INPUTBUF(1)=')' THEN/* END OF FIELD   @ZD10882*/ 00486000
         CLI   INPUTBUF(R5),C')'                                   0213 00487000
         BE    @RT00213                                            0213 00488000
*                     GOTO DEV084;  /* CONTINUE DECODING     @DA00893*/ 00489000
*                 END;              /*                       @D32JPFR*/ 00490000
         AL    COUNT,@CF00072                                      0215 00491000
         C     COUNT,@CF00054                                      0215 00492000
         BNH   @DL00211                                            0215 00493000
*               GO TO DEV800;       /* INVALID CHARACTER     @D32JPFR*/ 00494000
         B     DEV800                                              0216 00495000
*DEV084:                            /* SET UP TO MOVE NAME   @D32JPFR*/ 00496000
*               $IFTOUT(X8,1:8)=''; /* BLANK OUT BUFFER      @D32JPFR*/ 00497000
DEV084   L     @14,X8                                              0217 00498000
         MH    @14,@CH00375                                        0217 00499000
         ST    @14,@TF00001                                        0217 00500000
         ALR   @14,WAPTR                                           0217 00501000
         MVI   $IFTOUT-68(@14),C' '                                0217 00502000
         MVC   $IFTOUT-67(7,@14),$IFTOUT-68(@14)                   0217 00503000
*               $IFTOUT(X8,1:COUNT)=INPUT(1:COUNT);/* MOVE DATA TO 0218 00504000
*                                      BUF                   @D32JPFR*/ 00505000
         LR    @14,WAPTR                                           0218 00506000
         AL    @14,@TF00001                                        0218 00507000
         LR    @11,COUNT                                           0218 00508000
         BCTR  @11,0                                               0218 00509000
         L     @10,X7                                              0218 00510000
         EX    @11,@SM00819                                        0218 00511000
*               $DVLGMDE(X8)='1'B;  /* SET FLG INDICATING LOGMODE  0219 00512000
*                                      SPECIFIED             @D32JPFR*/ 00513000
         LR    @14,WAPTR                                           0219 00514000
         AL    @14,@TF00001                                        0219 00515000
         OI    $DVLGMDE-68(@14),B'00001000'                        0219 00516000
*DEV086:                            /* PT TO DELIMITER       @D32JPFR*/ 00517000
*               R5=R5+1;            /* SKIP OVER THE RIGHT PAREN   0220 00518000
*                                                            @ZD10882*/ 00519000
DEV086   AL    R5,@CF00072                                         0220 00520000
*             END;                  /*                       @D32JPFR*/ 00521000
*           ELSE                    /*                       @D32JPFR*/ 00522000
*             GOTO DEV800;          /* LEFT PAREN IS INVALID IF NOT     00523000
*                                      AN LU                 @D32JPFR*/ 00524000
*         END;                      /*                       @D32JPFR*/ 00525000
*       GOTO DEV150;                /* CONTINUE              @D32JPFR*/ 00526000
         B     DEV150                                              0224 00527000
*     END;                          /*                       @D32JPFR*/ 00528000
*   $NOCDS(X8)='1'B;                /* SET NO CDS FLAG               */ 00529000
@RF00184 L     @14,X8                                              0226 00530000
         MH    @14,@CH00375                                        0226 00531000
         ALR   @14,WAPTR                                           0226 00532000
         OI    $NOCDS-68(@14),B'01000000'                          0226 00533000
*   SKIPENT='1'B;                   /* SKIP THIS ENTRY               */ 00534000
         OI    SKIPENT,B'00001000'                                 0227 00535000
*   $PARTIAL='1'B;                  /* SET PARTIAL ERROR FLAG        */ 00536000
         OI    $PARTIAL(WAPTR),B'00000001'                         0228 00537000
*   GO TO DEV170;                   /* SKIP THIS ENTRY               */ 00538000
         B     DEV170                                              0229 00539000
*DEV100:                            /* CHK FOR END OF DEVTAB         */ 00540000
*   DASH='0'B;                      /* RESET INCL RANGE FLAG         */ 00541000
DEV100   NI    DASH,B'11011111'                                    0230 00542000
*   IF SKIPENT='1'B THEN            /* BAD ENTRY                     */ 00543000
         TM    SKIPENT,B'00001000'                                 0231 00544000
         BNO   @RF00231                                            0231 00545000
*     DO;                           /* YES PREVIOUS ERROR            */ 00546000
*       SKIPENT='0'B;               /* RESET SKIP FLAG               */ 00547000
         NI    SKIPENT,B'11110111'                                 0233 00548000
*       GO TO DEV050;               /* YES PROCESS NEXT              */ 00549000
         B     DEV050                                              0234 00550000
*     END;                                                         0235 00551000
*   X8=X8+1;                        /* PT TO NEXT DEVTAB ENTRY       */ 00552000
@RF00231 LA    @14,1                                               0236 00553000
         L     @08,X8                                              0236 00554000
         ALR   @08,@14                                             0236 00555000
         ST    @08,X8                                              0236 00556000
*   X6=X6+1;                        /* IF WE HAVE NOT PROCESS        */ 00557000
         AL    @14,X6                                              0237 00558000
         ST    @14,X6                                              0237 00559000
*   IF 16>=X6 THEN                  /* 16 ENTRIES                    */ 00560000
         C     @14,@CF00061                                        0238 00561000
         BNH   @RT00238                                            0238 00562000
*     GO TO DEV050;                 /* GO GET NEXT                   */ 00563000
*   IF INPUTBUF(1)¬='/' THEN        /* 16 ENTRIES PROCESSED IF       */ 00564000
         CLI   INPUTBUF(R5),C'/'                                   0240 00565000
         BNE   @RT00240                                            0240 00566000
*     GO TO DEV500;                 /* / NOT ENCOUNTERED,ERROR       */ 00567000
*DEV120:                            /* SET UP GOOD RETURN            */ 00568000
*   IF $DEVCNTS<4 THEN              /* MOVE THAN ONE ENTRY ?         */ 00569000
DEV120   LH    @14,$DEVCNTS(,WAPTR)                                0242 00570000
         C     @14,@CF00068                                        0242 00571000
         BL    @RT00242                                            0242 00572000
*     GO TO DEV130;                 /* NO                            */ 00573000
*   $MULTDEV='1'B;                  /* YES,SET MULT ENTRY FLAG       */ 00574000
         OI    $MULTDEV(WAPTR),B'01000000'                         0244 00575000
*DEV130:                            /* SET FLAGS FOR COMM INT FOR  0245 00576000
*                                      GOOD OR BAD DEVS              */ 00577000
*   $DEVENT='0'B;                   /* DEFAULT IS SYMBOLIC NM        */ 00578000
DEV130   NI    $DEVENT(WAPTR),B'11101111'                          0245 00579000
*   IF UNITAD='1'B THEN             /* UNIT ADDRESS                  */ 00580000
         TM    UNITAD,B'00010000'                                  0246 00581000
         BNO   @RF00246                                            0246 00582000
*     $DEVENT='1'B;                 /* YES                           */ 00583000
         OI    $DEVENT(WAPTR),B'00010000'                          0247 00584000
*   IF $DEVCNTS<3 THEN              /* ANY VALID ENTRIES             */ 00585000
@RF00246 LH    @14,$DEVCNTS(,WAPTR)                                0248 00586000
         C     @14,@CF00081                                        0248 00587000
         BNL   @RF00248                                            0248 00588000
*     $DEVERR='1'B;                 /* NO                            */ 00589000
         OI    $DEVERR(WAPTR),B'10000000'                          0249 00590000
*   IF $DEVERR='0'B THEN            /* ANY PREVIOUS ERRORS           */ 00591000
@RF00248 TM    $DEVERR(WAPTR),B'10000000'                          0250 00592000
         BNZ   @RF00250                                            0250 00593000
*     $VALDDEV='1'B;                /* SET VALID ENTRY FLAG          */ 00594000
         OI    $VALDDEV(WAPTR),B'00001000'                         0251 00595000
*   IF $PARTIAL='1'B THEN           /* SOME GOOD ENTRIES?            */ 00596000
@RF00250 TM    $PARTIAL(WAPTR),B'00000001'                         0252 00597000
         BNO   @RF00252                                            0252 00598000
*     $DEVERR='1'B;                 /* INDICATE TO CI                */ 00599000
         OI    $DEVERR(WAPTR),B'10000000'                          0253 00600000
*   GO TO DEV840;                   /* RETURN TO CALLER              */ 00601000
         B     DEV840                                              0254 00602000
*DEV150:                            /* CHK GETCONFG OUTPUT           */ 00603000
*   WORKC(1:4)=CDSINFO(1:4);        /* MOVE UNIT ADDR TO WORK        */ 00604000
DEV150   MVC   WORKC(4),CDSINFO                                    0255 00605000
*   $DEVTBLE(X8,1:20)=CDSINFO(1:20);/* MOVE CDS TO DEVTABLE          */ 00606000
         L     @14,X8                                              0256 00607000
         MH    @14,@CH00375                                        0256 00608000
         ST    @14,@TF00001                                        0256 00609000
         ALR   @14,WAPTR                                           0256 00610000
         MVC   $DEVTBLE-68(20,@14),CDSINFO                         0256 00611000
*   $SYSMN(X8)=SYMNAME;             /* MOVE SYM NM TO DEV TAB        */ 00612000
         LR    @14,WAPTR                                           0257 00613000
         AL    @14,@TF00001                                        0257 00614000
         LA    @08,2376                                            0257 00615000
         ALR   @08,WAPTR                                           0257 00616000
         L     @11,SYMPTR(,@08)                                    0257 00617000
         MVC   $SYSMN-68(8,@14),SYMNAME(@11)                       0257 00618000
*   $LINENME(X8)=LINENME;           /* MOVE LINE NAME TO DEVTB       */ 00619000
         LR    @14,WAPTR                                           0258 00620000
         AL    @14,@TF00001                                        0258 00621000
         MVC   $LINENME-68(8,@14),LINENME(@08)                     0258 00622000
*   $DEVFLG5(X8)=FLG5;              /* MOVE DEV FLG TO DEV TBL       */ 00623000
         LR    @14,WAPTR                                           0259 00624000
         AL    @14,@TF00001                                        0259 00625000
         MVC   $DEVFLG5-68(1,@14),FLG5(@08)                        0259 00626000
*   IF $DEVCNTS=2 THEN              /* 1ST DEVICE ENTRY?             */ 00627000
         CLC   $DEVCNTS(2,WAPTR),@CH00139                          0260 00628000
         BE    @RT00260                                            0260 00629000
*     GO TO DEV165;                 /* YES,DONT MAKE DUP CHK         */ 00630000
*   DO I=3 TO $DEVCNTS BY 1;        /* CHK FOR DUPLICATE DEVS        */ 00631000
         LA    @14,3                                               0262 00632000
         STH   @14,I                                               0262 00633000
         B     @DE00262                                            0262 00634000
@DL00262 DS    0H                                                  0263 00635000
*     IF $SYSMN(I,1:8)=SYMNAME(1:8) THEN/* DUPLICATE FOUND?          */ 00636000
         LR    @08,@14                                             0263 00637000
         MH    @08,@CH00375                                        0263 00638000
         L     @11,SYMPTR+2376(,WAPTR)                             0263 00639000
         ALR   @08,WAPTR                                           0263 00640000
         CLC   $SYSMN-68(8,@08),SYMNAME(@11)                       0263 00641000
         BE    @RT00263                                            0263 00642000
*       GO TO DEV700;               /* YES,ISSUE 251 MSG             */ 00643000
*   END;                                                           0265 00644000
         AL    @14,@CF00072                                        0265 00645000
         STH   @14,I                                               0265 00646000
@DE00262 CH    @14,$DEVCNTS(,WAPTR)                                0265 00647000
         BNH   @DL00262                                            0265 00648000
*DEV165:                            /* UPDATE DEVICE COUNT FOR NEW 0266 00649000
*                                      DEVICE                        */ 00650000
*   $DEVCNTS=$DEVCNTS+1;            /* INCR DEVICE COUNT             */ 00651000
DEV165   LA    @14,1                                               0266 00652000
         AH    @14,$DEVCNTS(,WAPTR)                                0266 00653000
         STH   @14,$DEVCNTS(,WAPTR)                                0266 00654000
*DEV170:                            /* CHECK FOR INCLUSIVE RANGE OF     00655000
*                                      DEVICES                       */ 00656000
*   IF DASH¬='1'B THEN              /* INCLUSIVE RANGE ?             */ 00657000
DEV170   TM    DASH,B'00100000'                                    0267 00658000
         BNO   @RT00267                                            0267 00659000
*     GO TO DEV100;                 /* NO GET NEXT ENTRY             */ 00660000
*   IF WORKC1=WORKD THEN            /* ALL ENTRIES FOR INCL RG       */ 00661000
         CLC   WORKC1(4),WORKD                                     0269 00662000
         BE    @RT00269                                            0269 00663000
*     GO TO DEV100;                 /* YES,CHK FOR END OF INP        */ 00664000
*   WORKC1=WORKC1+1;                /* COMPUTE NEXT DEVICE           */ 00665000
         LA    @14,1                                               0271 00666000
         AL    @14,WORKC1                                          0271 00667000
         ST    @14,WORKC1                                          0271 00668000
*   IF SKIPENT='1'B THEN            /* WAS LAST ENTRY BAD            */ 00669000
         TM    SKIPENT,B'00001000'                                 0272 00670000
         BNO   @RF00272                                            0272 00671000
*     DO;                           /* YES                           */ 00672000
*       SKIPENT='0'B;               /* RESET FLAG                    */ 00673000
         NI    SKIPENT,B'11110111'                                 0274 00674000
*       GO TO DEV075;               /* GO PROCESS NEXT ENTRY         */ 00675000
         B     DEV075                                              0275 00676000
*     END;                                                         0276 00677000
*   X6=X6+1;                        /* INCR DEVICE COUNT             */ 00678000
@RF00272 LA    @14,1                                               0277 00679000
         L     @08,X6                                              0277 00680000
         ALR   @08,@14                                             0277 00681000
         ST    @08,X6                                              0277 00682000
*   X8=X8+1;                        /* PT TO NEXT DEVTAB             */ 00683000
         AL    @14,X8                                              0278 00684000
         ST    @14,X8                                              0278 00685000
*   IF 16>=X6 THEN                  /* MORE THAN 16 ?                */ 00686000
         C     @08,@CF00061                                        0279 00687000
         BNH   @RT00279                                            0279 00688000
*     GO TO DEV075;                 /* NO,PROCESS NEXT DEV           */ 00689000
*DEV500:                            /* ISSUE ERROR MSG               */ 00690000
*                                                                  0281 00691000
*   /*****************************************************************/ 00692000
*   /*                                                               */ 00693000
*   /* TCEC MSGN(110)SUB(NO) INVOKED                                 */ 00694000
*   /*                                                               */ 00695000
*   /*****************************************************************/ 00696000
*                                                                  0281 00697000
*   $TCECM='1'B;                    /* SET TCEC SW IN RCA            */ 00698000
DEV500   OI    $TCECM(WAPTR),B'00000001'                           0281 00699000
*   R1=ADDR($TCA10);                /* SET UP PARM LIST $TR          */ 00700000
         LA    R1,$TCA10                                           0282 00701000
*   CALL #EXIT;                     /* CALL CECOM                    */ 00702000
         L     @15,#EXITA(,WAPTR)                                  0283 00703000
         BALR  @14,@15                                             0283 00704000
*   DCL                                                            0284 00705000
*     1 $TCA10,                     /* TCEC PARM LIST                */ 00706000
*      2 $TCB10 FIXED(32) INIT(110),/* MSG NUMBER                    */ 00707000
*      2 $TCC10 FIXED(32) INIT(0),  /* INCT LEN                      */ 00708000
*      2 $TCD10 BIT(8) INIT('00000000'B),/* FLAG                     */ 00709000
*      2 $TCE10 CHAR(4) INIT('FFFFFFFF'X);/* MSSAGE MASK MORE THAN 16   00710000
*                                      DEVS ENTER                    */ 00711000
*   $PARTIAL='1'B;                  /* SET PARTIAL ERROR FLAG        */ 00712000
         OI    $PARTIAL(WAPTR),B'00000001'                         0285 00713000
*   GO TO DEV120;                   /* CONTINUE DECODING             */ 00714000
         B     DEV120                                              0286 00715000
*DEV600:                            /* MIX SYM NME&UNIT ADDR         */ 00716000
*                                                                  0287 00717000
*   /*****************************************************************/ 00718000
*   /*                                                               */ 00719000
*   /* TCEC MSGN(252)SUB(NO) INVOKED                                 */ 00720000
*   /*                                                               */ 00721000
*   /*****************************************************************/ 00722000
*                                                                  0287 00723000
*   $TCECM='1'B;                    /* SET TCEC SW IN RCA            */ 00724000
DEV600   OI    $TCECM(WAPTR),B'00000001'                           0287 00725000
*   R1=ADDR($TCA11);                /* SET UP PARM LIST $TR          */ 00726000
         LA    R1,$TCA11                                           0288 00727000
*   CALL #EXIT;                     /* CALL CECOM                    */ 00728000
         L     @15,#EXITA(,WAPTR)                                  0289 00729000
         BALR  @14,@15                                             0289 00730000
*   DCL                                                            0290 00731000
*     1 $TCA11,                     /* TCEC PARM LIST                */ 00732000
*      2 $TCB11 FIXED(32) INIT(252),/* MSG NUMBER                    */ 00733000
*      2 $TCC11 FIXED(32) INIT(0),  /* INCT LEN                      */ 00734000
*      2 $TCD11 BIT(8) INIT('00000000'B),/* FLAG                     */ 00735000
*      2 $TCE11 CHAR(4) INIT('FFFFFFFF'X);/* MSSAGE MASK             */ 00736000
*   GO TO DEV825;                   /* CONTINUE DECODING             */ 00737000
         B     DEV825                                              0291 00738000
*DEV700:                            /* DUPLICATE DEV ENTRIES         */ 00739000
*                                                                  0292 00740000
*   /*****************************************************************/ 00741000
*   /*                                                               */ 00742000
*   /* TCEC MSGN(251)SUB(NO) INVOKED                                 */ 00743000
*   /*                                                               */ 00744000
*   /*****************************************************************/ 00745000
*                                                                  0292 00746000
*   $TCECM='1'B;                    /* SET TCEC SW IN RCA            */ 00747000
DEV700   OI    $TCECM(WAPTR),B'00000001'                           0292 00748000
*   R1=ADDR($TCA12);                /* SET UP PARM LIST $TR          */ 00749000
         LA    R1,$TCA12                                           0293 00750000
*   CALL #EXIT;                     /* CALL CECOM                    */ 00751000
         L     @15,#EXITA(,WAPTR)                                  0294 00752000
         BALR  @14,@15                                             0294 00753000
*   DCL                                                            0295 00754000
*     1 $TCA12,                     /* TCEC PARM LIST                */ 00755000
*      2 $TCB12 FIXED(32) INIT(251),/* MSG NUMBER                    */ 00756000
*      2 $TCC12 FIXED(32) INIT(0),  /* INCT LEN                      */ 00757000
*      2 $TCD12 BIT(8) INIT('00000000'B),/* FLAG                     */ 00758000
*      2 $TCE12 CHAR(4) INIT('FFFFFFFF'X);/* MSSAGE MASK             */ 00759000
*   GO TO DEV825;                   /* CONTINUE DECODING             */ 00760000
         B     DEV825                                              0296 00761000
*DEV800:                            /* INVALID ENTRY                 */ 00762000
*   R9=R5;                          /* GET CURRENT INP PTR           */ 00763000
DEV800   LR    R9,R5                                               0297 00764000
*   X4=ADDR($DTORESP)+1;            /* ADDR OF 1ST INPUT CHAR        */ 00765000
         LA    @14,$DTORESP(,WAPTR)                                0298 00766000
         AL    @14,@CF00072                                        0298 00767000
         ST    @14,X4                                              0298 00768000
*   $INBUFR(1:8)=' ';               /* BLK OUT WORK AREA             */ 00769000
         MVI   $INBUFR+1(WAPTR),C' '                               0299 00770000
         MVC   $INBUFR+2(6,WAPTR),$INBUFR+1(WAPTR)                 0299 00771000
         MVI   $INBUFR(WAPTR),C' '                                 0299 00772000
*   DO I=8 TO 1 BY-1;               /* SCAN INPUT                    */ 00773000
         LA    @14,8                                               0300 00774000
         STH   @14,I                                               0300 00775000
@DL00300 DS    0H                                                  0301 00776000
*     $INBUFR(I)=ERRINPUT(1);       /* MOVE ERROR TO SUB FIELD       */ 00777000
         ALR   @14,WAPTR                                           0301 00778000
         MVC   $INBUFR-1(1,@14),ERRINPUT(R9)                       0301 00779000
*     IF X4=R9 THEN                 /* END OF FIELD?                 */ 00780000
         C     R9,X4                                               0302 00781000
         BE    @RT00302                                            0302 00782000
*       GO TO DEV820;               /* YES GO PRT MSG                */ 00783000
*     R9=R9-1;                      /* DECR INPUT PTR                */ 00784000
         BCTR  R9,0                                                0304 00785000
*   END;                                                           0305 00786000
         LH    @08,I                                               0305 00787000
         BCTR  @08,0                                               0305 00788000
         LR    @14,@08                                             0305 00789000
         STH   @14,I                                               0305 00790000
         LTR   @14,@14                                             0305 00791000
         BP    @DL00300                                            0305 00792000
*DEV820:                            /* ISSUE INVALID ENTRY MSG       */ 00793000
*                                                                  0306 00794000
*   /*****************************************************************/ 00795000
*   /*                                                               */ 00796000
*   /* TCEC MSGN(108)SUB(YES) INVOKED                                */ 00797000
*   /*                                                               */ 00798000
*   /*****************************************************************/ 00799000
*                                                                  0306 00800000
*   $TCECM='1'B;                    /* SET TCEC SW IN RCA            */ 00801000
DEV820   OI    $TCECM(WAPTR),B'00000001'                           0306 00802000
*   R1=ADDR($TCA13);                /* SET UP PARM LIST $TR          */ 00803000
         LA    R1,$TCA13                                           0307 00804000
*   CALL #EXIT;                     /* CALL CECOM                    */ 00805000
         L     @15,#EXITA(,WAPTR)                                  0308 00806000
         BALR  @14,@15                                             0308 00807000
*   DCL                                                            0309 00808000
*     1 $TCA13,                     /* TCEC PARM LIST                */ 00809000
*      2 $TCB13 FIXED(32) INIT(108),/* MSG NUMBER                    */ 00810000
*      2 $TCC13 FIXED(32) INIT(0),  /* INCT LEN                      */ 00811000
*      2 $TCD13 BIT(8) INIT('10000000'B),/* FLAG                     */ 00812000
*      2 $TCE13 CHAR(4) INIT('FFFFFFFF'X);/* MSSAGE MASK ISSUE     0309 00813000
*                                      INVALID ENTRY MSG             */ 00814000
*DEV825:                            /* DEVICE ERROR                  */ 00815000
*   $DEVERR='1'B;                   /* SET DEVICE ERR FLAG           */ 00816000
DEV825   OI    $DEVERR(WAPTR),B'10000000'                          0310 00817000
*DEV830:                            /* SCAN REST OF INPUT            */ 00818000
*   IF INPUTBUF(1)=',' THEN         /* AT NEXT ENTRY ?               */ 00819000
DEV830   CLI   INPUTBUF(R5),C','                                   0311 00820000
         BNE   @RF00311                                            0311 00821000
*     DO;                           /* YES,CONTINUE                  */ 00822000
*       R5=R5+1;                    /* POINT TO 1ST CHAR             */ 00823000
         AL    R5,@CF00072                                         0313 00824000
*       GO TO DEV005;               /* GO DECODE ENTRY               */ 00825000
         B     DEV005                                              0314 00826000
*     END;                                                         0315 00827000
*   IF INPUTBUF(1)='/' THEN         /* END OF DEV FIELD?             */ 00828000
@RF00311 CLI   INPUTBUF(R5),C'/'                                   0316 00829000
         BE    @RT00316                                            0316 00830000
*     GO TO DEV840;                 /* YES ,RETURN                   */ 00831000
*   R5=R5+1;                        /* NO,POINT TO NEXT CHAR         */ 00832000
         AL    R5,@CF00072                                         0318 00833000
*   GO TO DEV830;                   /* CONTINUE SCAN                 */ 00834000
         B     DEV830                                              0319 00835000
*DEV840:                            /* SET UP TO RETURN              */ 00836000
*   R13=SVEIC003(2);                /* GET CALLERS SAVE PTR          */ 00837000
DEV840   L     R13,SVEIC003+4(,WAPTR)                              0320 00838000
*   RETURN;                         /* RETURN TO COMM MODULE         */ 00839000
@EL00001 DS    0H                                                  0321 00840000
@EF00001 DS    0H                                                  0321 00841000
@ER00001 LM    @14,@12,12(@13)                                     0321 00842000
         BR    @14                                                 0321 00843000
*   DO;                             /* ATDSPLY                       */ 00844000
*   END;                            /* ATDSPLY                       */ 00845000
*   END ISTIC003;                                                  0324 00846000
@DATA    DS    0H                                                       00847000
@CH00139 DC    H'2'                                                     00848000
@CH00375 DC    H'68'                                                    00849000
@SM00814 MVC   CDSSYM(0),INPUT(@08)                                     00850000
@SM00819 MVC   $IFTOUT-68(0,@14),INPUT(@10)                             00851000
         DS    0F                                                       00852000
@TF00001 DS    F                                                        00853000
         DS    0F                                                       00854000
@CF00072 DC    F'1'                                                     00855000
@CF00081 DC    F'3'                                                     00856000
@CH00081 EQU   @CF00081+2                                               00857000
@CF00068 DC    F'4'                                                     00858000
@CF00054 DC    F'8'                                                     00859000
@CH00054 EQU   @CF00054+2                                               00860000
@CF00087 DC    F'9'                                                     00861000
@CF00136 DC    F'12'                                                    00862000
@CF00058 DC    F'15'                                                    00863000
@CF00061 DC    F'16'                                                    00864000
@CF00085 DC    F'18'                                                    00865000
@CV00739 DC    V(ISTSC021)                                              00866000
@CV00745 DC    V(ISTSC030)                                              00867000
         DS    0D                                                       00868000
CECMAP   DS    A                                                        00869000
@CC00747 DC    C'X'''                                                   00870000
         DS    CL2                                                      00871000
@NM00054 DS    CL100                                                    00872000
         ORG   @NM00054                                                 00873000
X4       DS    AL4                                                      00874000
X6       DS    AL4                                                      00875000
X7       DS    AL4                                                      00876000
X8       DS    AL4                                                      00877000
X10      DS    AL4                                                      00878000
I        DS    FL2                                                      00879000
N        DS    FL2                                                      00880000
@NM00055 DS    CL24                                                     00881000
         ORG   @NM00055                                                 00882000
WORK     DS    CL16                                                     00883000
         ORG   WORK                                                     00884000
WORKA    DS    CL8                                                      00885000
WORKB    DS    CL8                                                      00886000
         ORG   @NM00055+16                                              00887000
WORKC    DS    CL8                                                      00888000
         ORG   WORKC                                                    00889000
WORKC1   DS    CL4                                                      00890000
WORKD    DS    CL4                                                      00891000
         ORG   @NM00054+48                                              00892000
CDSINFO  DS    CL20                                                     00893000
         ORG   CDSINFO                                                  00894000
@NM00056 DS    CL12                                                     00895000
CDSSYM   DS    CL8                                                      00896000
         ORG   @NM00054+68                                              00897000
INTFLAGS DS    CL1                                                      00898000
         ORG   INTFLAGS                                                 00899000
SYM      DS    BL1                                                      00900000
DEV      EQU   INTFLAGS+0                                               00901000
DASH     EQU   INTFLAGS+0                                               00902000
UNITAD   EQU   INTFLAGS+0                                               00903000
SKIPENT  EQU   INTFLAGS+0                                               00904000
@NM00057 EQU   INTFLAGS+0                                               00905000
         ORG   @NM00054+69                                              00906000
INTAREA  DS    9CL1                                                     00907000
         ORG   @NM00054+100                                             00908000
EBCF0    DC    CL8'00000000'                                            00909000
NDR      DC    CL5'.NDR/'                                               00910000
CTST     DC    CL2'*/'                                                  00911000
SYSCON   DC    CL8'SYS CON '                                            00912000
         DS    CL1                                                      00913000
ACQPARM  DS    CL5                                                      00914000
         ORG   ACQPARM                                                  00915000
CDSADDR  DC    AL4(CDSINFO)                                             00916000
@NM00058 DC    B'00000000'                                              00917000
         ORG   @NM00058                                                 00918000
@NM00059 DS    BL1                                                      00919000
@NM00060 EQU   @NM00058+0                                               00920000
NOCDS    EQU   @NM00058+0                                               00921000
@NM00061 EQU   @NM00058+0                                               00922000
         ORG   ACQPARM+5                                                00923000
         DS    CL3                                                      00924000
ITATCPRM DS    CL14                                                     00925000
         ORG   ITATCPRM                                                 00926000
@NM00062 DC    X'0102F4F1'                                              00927000
ITATCFR  DS    AL4                                                      00928000
ITATCTO  DS    AL4                                                      00929000
@NM00063 DC    AL1(0)                                                   00930000
         ORG   @NM00063                                                 00931000
ITATCTP  DS    BL1                                                      00932000
         ORG   ITATCPRM+13                                              00933000
ITATCNT  DS    FL1                                                      00934000
         ORG   ITATCPRM+14                                              00935000
         DS    CL2                                                      00936000
$TCA10   DS    CL13                                                     00937000
         ORG   $TCA10                                                   00938000
$TCB10   DC    A(110)                                                   00939000
$TCC10   DC    A(0)                                                     00940000
$TCD10   DC    B'00000000'                                              00941000
$TCE10   DC    X'FFFFFFFF'                                              00942000
         ORG   $TCA10+13                                                00943000
         DS    CL3                                                      00944000
$TCA11   DS    CL13                                                     00945000
         ORG   $TCA11                                                   00946000
$TCB11   DC    A(252)                                                   00947000
$TCC11   DC    A(0)                                                     00948000
$TCD11   DC    B'00000000'                                              00949000
$TCE11   DC    X'FFFFFFFF'                                              00950000
         ORG   $TCA11+13                                                00951000
         DS    CL3                                                      00952000
$TCA12   DS    CL13                                                     00953000
         ORG   $TCA12                                                   00954000
$TCB12   DC    A(251)                                                   00955000
$TCC12   DC    A(0)                                                     00956000
$TCD12   DC    B'00000000'                                              00957000
$TCE12   DC    X'FFFFFFFF'                                              00958000
         ORG   $TCA12+13                                                00959000
         DS    CL3                                                      00960000
$TCA13   DS    CL13                                                     00961000
         ORG   $TCA13                                                   00962000
$TCB13   DC    A(108)                                                   00963000
$TCC13   DC    A(0)                                                     00964000
$TCD13   DC    B'10000000'                                              00965000
$TCE13   DC    X'FFFFFFFF'                                              00966000
         ORG   $TCA13+13                                                00967000
         DS    CL3                                                      00968000
PATCH    DC    15F'0'                                                   00969000
@00      EQU   00                      EQUATES FOR REGISTERS 0-15       00970000
@01      EQU   01                                                       00971000
@02      EQU   02                                                       00972000
@03      EQU   03                                                       00973000
@04      EQU   04                                                       00974000
@05      EQU   05                                                       00975000
@06      EQU   06                                                       00976000
@07      EQU   07                                                       00977000
@08      EQU   08                                                       00978000
@09      EQU   09                                                       00979000
@10      EQU   10                                                       00980000
@11      EQU   11                                                       00981000
@12      EQU   12                                                       00982000
@13      EQU   13                                                       00983000
@14      EQU   14                                                       00984000
@15      EQU   15                                                       00985000
COUNT    EQU   @08                                                      00986000
WAPTR    EQU   @02                                                      00987000
R1       EQU   @01                                                      00988000
R3       EQU   @03                                                      00989000
R2       EQU   @02                                                      00990000
R4       EQU   @04                                                      00991000
R5       EQU   @05                                                      00992000
R9       EQU   @09                                                      00993000
R13      EQU   @13                                                      00994000
R15      EQU   @15                                                      00995000
$RCAAREA EQU   0                                                        00996000
$POINTER EQU   $RCAAREA+100                                             00997000
$TRTBLA  EQU   $POINTER+124                                             00998000
$CONSTNT EQU   $RCAAREA+244                                             00999000
$RCAFLG  EQU   $RCAAREA+604                                             01000000
TOLTEPWA EQU   0                                                        01001000
$SCTTBLE EQU   TOLTEPWA                                                 01002000
$TESTOPT EQU   $SCTTBLE+2                                               01003000
$ERROPT  EQU   $SCTTBLE+3                                               01004000
$PDEVFLG EQU   $SCTTBLE+10                                              01005000
$CDSFLGS EQU   $SCTTBLE+11                                              01006000
$CDS8T19 EQU   $SCTTBLE+20                                              01007000
$EXECFLG EQU   $SCTTBLE+33                                              01008000
$MULTDEV EQU   $EXECFLG                                                 01009000
$OLTFLGS EQU   $SCTTBLE+36                                              01010000
$OLTFLG2 EQU   $SCTTBLE+37                                              01011000
$TOTFLG1 EQU   $SCTTBLE+38                                              01012000
$ROUTMSK EQU   $SCTTBLE+40                                              01013000
$CDA     EQU   TOLTEPWA+100                                             01014000
$RCA     EQU   $CDA+44                                                  01015000
$OLTPTR  EQU   $CDA+52                                                  01016000
$HIMOREC EQU   $CDA+60                                                  01017000
$COMMFLG EQU   TOLTEPWA+224                                             01018000
$FLAG1   EQU   $COMMFLG                                                 01019000
$FLAG2   EQU   $COMMFLG+1                                               01020000
$NDR     EQU   $FLAG2                                                   01021000
$VALDDEV EQU   $FLAG2                                                   01022000
$PARTIAL EQU   $FLAG2                                                   01023000
$FLAG3   EQU   $COMMFLG+2                                               01024000
$DEVERR  EQU   $FLAG3                                                   01025000
$FLAG4   EQU   $COMMFLG+3                                               01026000
$FLAG5   EQU   $COMMFLG+4                                               01027000
$EOJ     EQU   $FLAG5                                                   01028000
$CANCEL  EQU   $EOJ                                                     01029000
$FLAG6   EQU   $COMMFLG+5                                               01030000
$ABNDBIT EQU   $FLAG6                                                   01031000
$FLAG7   EQU   $COMMFLG+6                                               01032000
$FLAG8   EQU   $COMMFLG+7                                               01033000
$TCECM   EQU   $FLAG8                                                   01034000
$FLAG9   EQU   $COMMFLG+8                                               01035000
$FLAG10  EQU   $COMMFLG+9                                               01036000
$FLAG11  EQU   $COMMFLG+10                                              01037000
$FLAG12  EQU   $COMMFLG+11                                              01038000
$FLAG13  EQU   $COMMFLG+12                                              01039000
$DEVENT  EQU   $FLAG13                                                  01040000
$DEVTBLE EQU   TOLTEPWA+240                                             01041000
$DEVCDS  EQU   $DEVTBLE                                                 01042000
$DEVUNAD EQU   $DEVCDS                                                  01043000
@NM00039 EQU   $DEVUNAD+2                                               01044000
$DEVFEAT EQU   $DEVCDS+4                                                01045000
$DEVCDSF EQU   $DEVCDS+9                                                01046000
$DEVSDCF EQU   $DEVCDS+10                                               01047000
$$SYMNME EQU   $DEVCDS+12                                               01048000
$DEVFLG1 EQU   $DEVTBLE+20                                              01049000
$EVNCPLT EQU   $DEVFLG1                                                 01050000
$DVSPRM  EQU   $EVNCPLT                                                 01051000
$ATTNEXP EQU   $DEVFLG1                                                 01052000
$DVLGMDE EQU   $ATTNEXP                                                 01053000
$INTOCC  EQU   $DEVFLG1                                                 01054000
$DEVFLG2 EQU   $DEVTBLE+21                                              01055000
$NOCDS   EQU   $DEVFLG2                                                 01056000
$DEVTECB EQU   $DEVTBLE+22                                              01057000
$OPIS    EQU   $DEVTECB                                                 01058000
$OPND    EQU   $DEVTECB+2                                               01059000
$DEVFLG3 EQU   $DEVTBLE+27                                              01060000
$NOTDEV  EQU   $DEVFLG3                                                 01061000
$SIOFLG  EQU   $DEVFLG3                                                 01062000
$SYSMN   EQU   $DEVTBLE+28                                              01063000
$IFTOUT  EQU   $DEVTBLE+36                                              01064000
$DEVSESP EQU   $IFTOUT                                                  01065000
$SSCPDAF EQU   $IFTOUT+6                                                01066000
$LDNCBPT EQU   $DEVTBLE+48                                              01067000
$RNINFO  EQU   $DEVTBLE+56                                              01068000
$LINENME EQU   $RNINFO                                                  01069000
$DEVFLG5 EQU   $RNINFO+8                                                01070000
$DEVFLG4 EQU   $DEVTBLE+65                                              01071000
$DEVCNTS EQU   TOLTEPWA+1464                                            01072000
$INBUFR  EQU   TOLTEPWA+2104                                            01073000
$WORK    EQU   TOLTEPWA+2376                                            01074000
#EXITA   EQU   TOLTEPWA+2632                                            01075000
$CCOMDAT EQU   TOLTEPWA+2644                                            01076000
$CFLGS   EQU   $CCOMDAT+16                                              01077000
$24FEMSG EQU   TOLTEPWA+2681                                            01078000
$24CATMG EQU   $24FEMSG+11                                              01079000
$DTORESP EQU   TOLTEPWA+2712                                            01080000
@NM00047 EQU   TOLTEPWA+2776                                            01081000
$OUNTPTR EQU   @NM00047+4                                               01082000
$NSPTR   EQU   $OUNTPTR                                                 01083000
$NSCNT   EQU   @NM00047+10                                              01084000
$ENXX    EQU   @NM00047+15                                              01085000
$IMITX   EQU   $ENXX                                                    01086000
SVESC033 EQU   TOLTEPWA+3160                                            01087000
SVECC013 EQU   TOLTEPWA+3232                                            01088000
SVEIC003 EQU   TOLTEPWA+3592                                            01089000
SVESC022 EQU   TOLTEPWA+3736                                            01090000
SVECC011 EQU   TOLTEPWA+4024                                            01091000
#EXIT    EQU   0                                                        01092000
CECOMMAP EQU   0                                                        01093000
@NM00050 EQU   0                                                        01094000
SYMPTR   EQU   @NM00050                                                 01095000
DVCHRPTR EQU   @NM00050+4                                               01096000
LINENME  EQU   @NM00050+8                                               01097000
FLG5     EQU   @NM00050+16                                              01098000
DEVLU    EQU   FLG5                                                     01099000
INTAREB  EQU   0                                                        01100000
INPUTBUF EQU   0                                                        01101000
ERRINPUT EQU   0                                                        01102000
INPUT    EQU   0                                                        01103000
SYMNAME  EQU   0                                                        01104000
BACKSAVE EQU   0                                                        01105000
$TRTBL   EQU   0                                                        01106000
DEVCHAR  EQU   0                                                        01107000
RCAPTR   EQU   $RCA                                                     01108000
SVECC012 EQU   SVESC022                                                 01109000
SVEIC00A EQU   SVEIC003                                                 01110000
SVEIC004 EQU   SVEIC003                                                 01111000
SVEIC005 EQU   SVEIC003                                                 01112000
SVESC02A EQU   SVESC022                                                 01113000
SVESC02B EQU   SVESC022                                                 01114000
SVESC02D EQU   SVESC022                                                 01115000
SVESC02E EQU   SVESC022                                                 01116000
SVESC02F EQU   SVECC013                                                 01117000
SVESC024 EQU   SVESC022                                                 01118000
SVESC027 EQU   SVESC022                                                 01119000
SVESC029 EQU   SVESC033                                                 01120000
SVESC031 EQU   SVECC013                                                 01121000
SVESC032 EQU   SVECC011                                                 01122000
SVETC037 EQU   SVEIC003                                                 01123000
         AGO   .@UNREFD                START UNREFERENCED COMPONENTS    01124000
@NM00053 EQU   @NM00050+17                                              01125000
@NM00052 EQU   FLG5                                                     01126000
@NM00051 EQU   FLG5                                                     01127000
$CECFLAG EQU   CECOMMAP+20                                              01128000
$CEINCT  EQU   CECOMMAP+16                                              01129000
$CEINADR EQU   CECOMMAP+12                                              01130000
$CEOUTCT EQU   CECOMMAP+8                                               01131000
$CEOUTAD EQU   CECOMMAP+4                                               01132000
$CECIDNT EQU   CECOMMAP+2                                               01133000
$CECLEVL EQU   CECOMMAP+1                                               01134000
$CECTRMG EQU   CECOMMAP                                                 01135000
SVECC010 EQU   TOLTEPWA+3952                                            01136000
SVETC035 EQU   TOLTEPWA+3880                                            01137000
SVESC030 EQU   TOLTEPWA+3808                                            01138000
SVESC020 EQU   TOLTEPWA+3664                                            01139000
SVEIC002 EQU   TOLTEPWA+3520                                            01140000
SVECC014 EQU   TOLTEPWA+3376                                            01141000
SVESC120 EQU   TOLTEPWA+3304                                            01142000
SVESC025 EQU   TOLTEPWA+3088                                            01143000
@NM00049 EQU   TOLTEPWA+2980                                            01144000
$RPLERR  EQU   TOLTEPWA+2977                                            01145000
@NM00048 EQU   TOLTEPWA+2976                                            01146000
$R13PR3  EQU   TOLTEPWA+2972                                            01147000
$CEINT2  EQU   TOLTEPWA+2968                                            01148000
$CEINT1  EQU   TOLTEPWA+2964                                            01149000
$MSGGET  EQU   TOLTEPWA+2960                                            01150000
$ACQLIST EQU   TOLTEPWA+2956                                            01151000
$R4SAVE1 EQU   TOLTEPWA+2952                                            01152000
$CLSISS  EQU   TOLTEPWA+2950                                            01153000
$CLSCNT  EQU   TOLTEPWA+2948                                            01154000
$CUTABLE EQU   TOLTEPWA+2868                                            01155000
$BUFSZ2  EQU   TOLTEPWA+2864                                            01156000
$RESID2  EQU   TOLTEPWA+2860                                            01157000
$OLTCCW2 EQU   TOLTEPWA+2856                                            01158000
$ENDBFR2 EQU   TOLTEPWA+2852                                            01159000
$1STBFR2 EQU   TOLTEPWA+2848                                            01160000
$TECB2   EQU   TOLTEPWA+2844                                            01161000
$BUFSZ1  EQU   TOLTEPWA+2840                                            01162000
$RESID1  EQU   TOLTEPWA+2836                                            01163000
$OLTCCW1 EQU   TOLTEPWA+2832                                            01164000
$ENDBFR1 EQU   TOLTEPWA+2828                                            01165000
$1STBFR1 EQU   TOLTEPWA+2824                                            01166000
$TECB1   EQU   TOLTEPWA+2820                                            01167000
$WAITIME EQU   TOLTEPWA+2816                                            01168000
$TRTN#   EQU   TOLTEPWA+2815                                            01169000
$WIODEV  EQU   TOLTEPWA+2814                                            01170000
$RQSTSZE EQU   TOLTEPWA+2812                                            01171000
$RQSTPTR EQU   TOLTEPWA+2808                                            01172000
$R4SAVE  EQU   TOLTEPWA+2804                                            01173000
$PARTADR EQU   TOLTEPWA+2800                                            01174000
$TBSDATA EQU   TOLTEPWA+2796                                            01175000
$CTWIDTH EQU   TOLTEPWA+2795                                            01176000
$CTLINE  EQU   TOLTEPWA+2794                                            01177000
$APWIDTH EQU   TOLTEPWA+2793                                            01178000
$APLINE  EQU   TOLTEPWA+2792                                            01179000
$INDEX   EQU   $IMITX                                                   01180000
$UMXX    EQU   @NM00047+14                                              01181000
$NSXX    EQU   @NM00047+12                                              01182000
$ATACNT  EQU   $NSCNT                                                   01183000
$CTR     EQU   @NM00047+8                                               01184000
$ATAPTR  EQU   $NSPTR                                                   01185000
$DDRPTR  EQU   @NM00047                                                 01186000
$APNAME  EQU   TOLTEPWA+2704                                            01187000
$24SYMNE EQU   $24CATMG+4                                               01188000
$24DEVAD EQU   $24CATMG                                                 01189000
$24RTN#  EQU   $24FEMSG+8                                               01190000
$ESECTID EQU   $24FEMSG                                                 01191000
$24FLGS  EQU   TOLTEPWA+2680                                            01192000
$24SAVE2 EQU   TOLTEPWA+2676                                            01193000
$24SAVE1 EQU   TOLTEPWA+2672                                            01194000
$24UNADR EQU   TOLTEPWA+2668                                            01195000
$24SAV13 EQU   TOLTEPWA+2664                                            01196000
$24RETCD EQU   TOLTEPWA+2663                                            01197000
$MACID   EQU   TOLTEPWA+2661                                            01198000
$CSPARE  EQU   $CFLGS                                                   01199000
$C2WAY   EQU   $CFLGS                                                   01200000
$CINCT   EQU   $CCOMDAT+12                                              01201000
$CINADR  EQU   $CCOMDAT+8                                               01202000
$COUTCT  EQU   $CCOMDAT+4                                               01203000
$COUTAD  EQU   $CCOMDAT                                                 01204000
ROOTLOC  EQU   TOLTEPWA+2640                                            01205000
$RETREG  EQU   TOLTEPWA+2636                                            01206000
$EXTA    EQU   TOLTEPWA+2320                                            01207000
$PASSONA EQU   TOLTEPWA+2264                                            01208000
$TRMINPT EQU   TOLTEPWA+2184                                            01209000
$BUFFER  EQU   TOLTEPWA+1976                                            01210000
$TLTRPL3 EQU   TOLTEPWA+1856                                            01211000
$TLTRPL2 EQU   TOLTEPWA+1736                                            01212000
$TLTRPL1 EQU   TOLTEPWA+1616                                            01213000
$SLTBL   EQU   TOLTEPWA+1468                                            01214000
$CDEVPT  EQU   TOLTEPWA+1466                                            01215000
$FEEDBCK EQU   $DEVTBLE+66                                              01216000
$WTISUED EQU   $DEVFLG4                                                 01217000
$EXIOISD EQU   $DEVFLG4                                                 01218000
$REMWRIT EQU   $DEVFLG4                                                 01219000
$REMDONE EQU   $DEVFLG4                                                 01220000
$2NDUSED EQU   $DEVFLG4                                                 01221000
$1STUSED EQU   $DEVFLG4                                                 01222000
$IGLXIFB EQU   $DEVFLG4                                                 01223000
$EXIOLV3 EQU   $DEVFLG4                                                 01224000
@NM00046 EQU   $DEVFLG5                                                 01225000
$DVBASIC EQU   $DEVFLG5                                                 01226000
$ASCII   EQU   $DEVFLG5                                                 01227000
$DEVLU   EQU   $DEVFLG5                                                 01228000
$OPNDFAL EQU   $DEVFLG5                                                 01229000
$ACQNCB  EQU   $DEVFLG5                                                 01230000
$REMOTE  EQU   $DEVFLG5                                                 01231000
$ENDNODE EQU   $DEVFLG5                                                 01232000
$CID     EQU   $DEVTBLE+52                                              01233000
$DVCOL   EQU   $LDNCBPT+2                                               01234000
$DVROW   EQU   $LDNCBPT                                                 01235000
$NCSPLP  EQU   $DEVTBLE+44                                              01236000
$DVLN    EQU   $SSCPDAF                                                 01237000
$DAF     EQU   $DEVSESP+4                                               01238000
$VARYPAB EQU   $DEVSESP                                                 01239000
@NM00045 EQU   $DEVFLG3                                                 01240000
$CLRSNT  EQU   $DEVFLG3                                                 01241000
$OLTERR  EQU   $DEVFLG3                                                 01242000
$SRTEST  EQU   $DEVFLG3                                                 01243000
$DVSNDOK EQU   $SIOFLG                                                  01244000
$POLLREQ EQU   $DEVFLG3                                                 01245000
$ACQRED  EQU   $DEVFLG3                                                 01246000
$DVINCT  EQU   $DEVTBLE+26                                              01247000
$DVBRKST EQU   $OPND+1                                                  01248000
$DVBRKSN EQU   $OPND                                                    01249000
$DVSEQNO EQU   $OPIS                                                    01250000
$CEINTRP EQU   $DEVFLG2                                                 01251000
$TESTMDE EQU   $DEVFLG2                                                 01252000
$DEVALOC EQU   $DEVFLG2                                                 01253000
$ALLDATA EQU   $DEVFLG2                                                 01254000
$ENDCNTL EQU   $DEVFLG2                                                 01255000
$CTLDEV  EQU   $DEVFLG2                                                 01256000
$DATAIN  EQU   $DEVFLG2                                                 01257000
$PRIMARY EQU   $DEVFLG1                                                 01258000
$DVCTBYT EQU   $INTOCC                                                  01259000
$DEVACT  EQU   $DEVFLG1                                                 01260000
$GRABBED EQU   $DEVFLG1                                                 01261000
$CATASTR EQU   $DEVFLG1                                                 01262000
$LETGO   EQU   $DEVFLG1                                                 01263000
$CURELEM EQU   $$SYMNME+4                                               01264000
$MSGOTSD EQU   $$SYMNME                                                 01265000
$EXTDEV  EQU   $DEVCDS+11                                               01266000
@NM00044 EQU   $DEVSDCF                                                 01267000
$NOTPRIM EQU   $DEVSDCF                                                 01268000
@NM00043 EQU   $DEVCDSF                                                 01269000
@NM00042 EQU   $DEVCDSF                                                 01270000
@NM00041 EQU   $DEVCDSF                                                 01271000
$CDSNAME EQU   $DEVCDSF                                                 01272000
$EXTRN   EQU   $DEVCDSF                                                 01273000
$CEVOLUM EQU   $DEVCDSF                                                 01274000
$SHARD   EQU   $DEVCDSF                                                 01275000
$DEVFPM  EQU   $DEVCDSF                                                 01276000
$DEVCNT  EQU   $DEVCDS+8                                                01277000
$DEVTYPE EQU   $DEVFEAT+3                                               01278000
$DEVCLAS EQU   $DEVFEAT+2                                               01279000
$DEVFRRS EQU   $DEVFEAT+1                                               01280000
$DEVMOD  EQU   $DEVFEAT                                                 01281000
$DEVRDGT EQU   @NM00039+1                                               01282000
$DEVCTLU EQU   @NM00039+1                                               01283000
$DEVCHAN EQU   @NM00039                                                 01284000
@NM00040 EQU   @NM00039                                                 01285000
$CTINDX  EQU   $DEVUNAD                                                 01286000
$FLAG16  EQU   $COMMFLG+15                                              01287000
$FLAG15  EQU   $COMMFLG+14                                              01288000
$FLAG14  EQU   $COMMFLG+13                                              01289000
$TEP2ND  EQU   $FLAG13                                                  01290000
$TEP1ST  EQU   $FLAG13                                                  01291000
$CATMSG  EQU   $FLAG13                                                  01292000
$PRMPTSW EQU   $FLAG13                                                  01293000
$OLTMACC EQU   $FLAG13                                                  01294000
$LGON    EQU   $FLAG13                                                  01295000
$CTLOGON EQU   $FLAG13                                                  01296000
@NM00038 EQU   $FLAG12                                                  01297000
$VARYINP EQU   $FLAG12                                                  01298000
$ENDTEST EQU   $FLAG12                                                  01299000
$VRYHRD  EQU   $FLAG12                                                  01300000
$VRYSFT  EQU   $FLAG12                                                  01301000
$POSTFLG EQU   $FLAG12                                                  01302000
$OPTMSG  EQU   $FLAG12                                                  01303000
$FEORCAT EQU   $FLAG11                                                  01304000
@NM00037 EQU   $FLAG11                                                  01305000
@NM00036 EQU   $FLAG10                                                  01306000
$INBND   EQU   $FLAG10                                                  01307000
$WAITFLG EQU   $FLAG10                                                  01308000
$DPRINT  EQU   $FLAG10                                                  01309000
$HOLD    EQU   $FLAG9                                                   01310000
$NOTRRCH EQU   $FLAG9                                                   01311000
@NM00035 EQU   $FLAG9                                                   01312000
$COPY    EQU   $FLAG9                                                   01313000
$LSTLNSW EQU   $FLAG9                                                   01314000
$MULLNSW EQU   $FLAG9                                                   01315000
$REMSW   EQU   $FLAG9                                                   01316000
$IGRES   EQU   $FLAG9                                                   01317000
$VS2     EQU   $FLAG8                                                   01318000
$VS1     EQU   $FLAG8                                                   01319000
$EDOS    EQU   $FLAG8                                                   01320000
@NM00034 EQU   $FLAG8                                                   01321000
$TWOWAY  EQU   $FLAG8                                                   01322000
@NM00033 EQU   $FLAG8                                                   01323000
$RCVMSG  EQU   $FLAG7                                                   01324000
$RCVRFLG EQU   $FLAG7                                                   01325000
$SNDRFLG EQU   $FLAG7                                                   01326000
$LDOIS   EQU   $FLAG7                                                   01327000
$DCONTCT EQU   $FLAG7                                                   01328000
$EXIOWAT EQU   $FLAG7                                                   01329000
$2NDDATA EQU   $FLAG7                                                   01330000
$1STDATA EQU   $FLAG7                                                   01331000
$CIREQ   EQU   $FLAG6                                                   01332000
$ABTERM  EQU   $ABNDBIT                                                 01333000
$FSTMCIS EQU   $FLAG6                                                   01334000
$DISCREQ EQU   $FLAG6                                                   01335000
$DISCISS EQU   $FLAG6                                                   01336000
$CHANGE  EQU   $FLAG6                                                   01337000
$CTERROR EQU   $FLAG6                                                   01338000
$RECAL11 EQU   $FLAG6                                                   01339000
@NM00032 EQU   $FLAG5                                                   01340000
$PROGCK  EQU   $CANCEL                                                  01341000
$PRINTAP EQU   $FLAG5                                                   01342000
@NM00031 EQU   $FLAG5                                                   01343000
$MSG922  EQU   $FLAG5                                                   01344000
$CT924   EQU   $FLAG5                                                   01345000
$FSTCAT  EQU   $FLAG5                                                   01346000
$FSTFE   EQU   $FLAG5                                                   01347000
$ACTOPND EQU   $FLAG4                                                   01348000
$ACQCUTT EQU   $FLAG4                                                   01349000
$CLSSACT EQU   $FLAG4                                                   01350000
$BACKINT EQU   $FLAG4                                                   01351000
$DMSGSW  EQU   $FLAG4                                                   01352000
$TSTDEVP EQU   $FLAG4                                                   01353000
$APRQPER EQU   $FLAG4                                                   01354000
$OPCOM   EQU   $FLAG4                                                   01355000
$NEWAP   EQU   $FLAG3                                                   01356000
$ALTPRTR EQU   $FLAG3                                                   01357000
$OPTERR  EQU   $FLAG3                                                   01358000
$PRTONLY EQU   $FLAG3                                                   01359000
$REQSTOR EQU   $FLAG3                                                   01360000
$LOGOFFE EQU   $FLAG3                                                   01361000
$TSTERR  EQU   $FLAG3                                                   01362000
$NRMTERM EQU   $FLAG2                                                   01363000
$VALDTST EQU   $FLAG2                                                   01364000
$DBLSLSH EQU   $FLAG2                                                   01365000
@NM00030 EQU   $FLAG2                                                   01366000
$OLTACT  EQU   $FLAG1                                                   01367000
$NORELDV EQU   $FLAG1                                                   01368000
@NM00029 EQU   $FLAG1                                                   01369000
$OPTCHNG EQU   $FLAG1                                                   01370000
$DEVCHNG EQU   $FLAG1                                                   01371000
$TESTCNG EQU   $FLAG1                                                   01372000
$CNSLFG  EQU   $FLAG1                                                   01373000
$TEP3RD  EQU   $FLAG1                                                   01374000
@NM00028 EQU   $CDA+120                                                 01375000
$CUCNT   EQU   $CDA+118                                                 01376000
@NM00027 EQU   $CDA+117                                                 01377000
$PRTFORM EQU   $CDA+116                                                 01378000
$OPISCNT EQU   $CDA+114                                                 01379000
$OPNDCNT EQU   $CDA+112                                                 01380000
$GETMSZE EQU   $CDA+110                                                 01381000
$GRCNTS  EQU   $CDA+108                                                 01382000
$CTLCNT  EQU   $CDA+106                                                 01383000
$ACTLVL  EQU   $CDA+105                                                 01384000
$PRNTLVL EQU   $CDA+104                                                 01385000
$ERRCNTA EQU   $CDA+102                                                 01386000
$TLCNT   EQU   $CDA+100                                                 01387000
$TIMEALW EQU   $CDA+96                                                  01388000
$PTRAREA EQU   $CDA+92                                                  01389000
$GETMPTR EQU   $CDA+88                                                  01390000
$R13PTRT EQU   $CDA+84                                                  01391000
$R13PTR  EQU   $CDA+80                                                  01392000
$TEPEND  EQU   $CDA+76                                                  01393000
$PLINKDL EQU   $CDA+72                                                  01394000
$TEPBEGN EQU   $CDA+68                                                  01395000
$FRELPTR EQU   $CDA+64                                                  01396000
$HIGHADR EQU   $HIMOREC                                                 01397000
$LOMOREC EQU   $CDA+56                                                  01398000
$LOWADDR EQU   $OLTPTR                                                  01399000
$ENDCOMM EQU   $CDA+48                                                  01400000
$COMMON  EQU   $RCA                                                     01401000
$SLASHAD EQU   $CDA+32                                                  01402000
$PASSON  EQU   $CDA+28                                                  01403000
$TOLBRTB EQU   $CDA+24                                                  01404000
$SCTPTR8 EQU   $CDA+20                                                  01405000
$SCTPTR  EQU   $CDA+16                                                  01406000
$TBWDPTR EQU   $CDA+12                                                  01407000
$TFWDPTR EQU   $CDA+8                                                   01408000
@NM00026 EQU   $CDA                                                     01409000
@NM00025 EQU   $SCTTBLE+98                                              01410000
$SCTLWTC EQU   $SCTTBLE+96                                              01411000
$SCTLWTA EQU   $SCTTBLE+92                                              01412000
#EXT     EQU   $SCTTBLE+88                                              01413000
#PASS    EQU   $SCTTBLE+84                                              01414000
#TABLE   EQU   $SCTTBLE+80                                              01415000
#MSGIDAC EQU   $SCTTBLE+78                                              01416000
@NM00024 EQU   $SCTTBLE+71                                              01417000
$RETMASK EQU   $SCTTBLE+70                                              01418000
$R249255 EQU   $ROUTMSK+29                                              01419000
$R241248 EQU   $ROUTMSK+28                                              01420000
$R233240 EQU   $ROUTMSK+27                                              01421000
$R225232 EQU   $ROUTMSK+26                                              01422000
$R217224 EQU   $ROUTMSK+25                                              01423000
$R209216 EQU   $ROUTMSK+24                                              01424000
$R201208 EQU   $ROUTMSK+23                                              01425000
$R193200 EQU   $ROUTMSK+22                                              01426000
$R185192 EQU   $ROUTMSK+21                                              01427000
$R177184 EQU   $ROUTMSK+20                                              01428000
$R169176 EQU   $ROUTMSK+19                                              01429000
$R161168 EQU   $ROUTMSK+18                                              01430000
$R153160 EQU   $ROUTMSK+17                                              01431000
$R145152 EQU   $ROUTMSK+16                                              01432000
$R137144 EQU   $ROUTMSK+15                                              01433000
$R129136 EQU   $ROUTMSK+14                                              01434000
$R121128 EQU   $ROUTMSK+13                                              01435000
$R113120 EQU   $ROUTMSK+12                                              01436000
$R105112 EQU   $ROUTMSK+11                                              01437000
$R097104 EQU   $ROUTMSK+10                                              01438000
$R089096 EQU   $ROUTMSK+9                                               01439000
$R081088 EQU   $ROUTMSK+8                                               01440000
$R073080 EQU   $ROUTMSK+7                                               01441000
$R065072 EQU   $ROUTMSK+6                                               01442000
$R057064 EQU   $ROUTMSK+5                                               01443000
$R049056 EQU   $ROUTMSK+4                                               01444000
$R041048 EQU   $ROUTMSK+3                                               01445000
$R033040 EQU   $ROUTMSK+2                                               01446000
$R025032 EQU   $ROUTMSK+1                                               01447000
$R017024 EQU   $ROUTMSK                                                 01448000
$TOTFLG2 EQU   $SCTTBLE+39                                              01449000
@NM00023 EQU   $TOTFLG1                                                 01450000
@NM00022 EQU   $TOTFLG1                                                 01451000
@NM00021 EQU   $TOTFLG1                                                 01452000
$CURELOD EQU   $TOTFLG1                                                 01453000
$CTEQTT  EQU   $TOTFLG1                                                 01454000
@NM00020 EQU   $TOTFLG1                                                 01455000
@NM00019 EQU   $TOTFLG1                                                 01456000
$LINESHR EQU   $TOTFLG1                                                 01457000
@NM00018 EQU   $OLTFLG2                                                 01458000
@NM00017 EQU   $OLTFLG2                                                 01459000
@NM00016 EQU   $OLTFLG2                                                 01460000
@NM00015 EQU   $OLTFLG2                                                 01461000
@NM00014 EQU   $OLTFLG2                                                 01462000
@NM00013 EQU   $OLTFLG2                                                 01463000
@NM00012 EQU   $OLTFLG2                                                 01464000
$TALK    EQU   $OLTFLG2                                                 01465000
$DYCOM   EQU   $OLTFLGS                                                 01466000
@NM00011 EQU   $OLTFLGS                                                 01467000
$TRACE   EQU   $OLTFLGS                                                 01468000
$RETCODE EQU   $OLTFLGS                                                 01469000
$CONTCB  EQU   $OLTFLGS                                                 01470000
$RETAIN  EQU   $OLTFLGS                                                 01471000
$CLEANRT EQU   $OLTFLGS                                                 01472000
$MANINTV EQU   $OLTFLGS                                                 01473000
$OLTSIZE EQU   $SCTTBLE+34                                              01474000
$QSCTMOD EQU   $EXECFLG                                                 01475000
$CTRLMOD EQU   $EXECFLG                                                 01476000
$CLEANUP EQU   $EXECFLG                                                 01477000
$LSTPDEV EQU   $EXECFLG                                                 01478000
$ERRCNT  EQU   $EXECFLG                                                 01479000
$RTNSLCT EQU   $EXECFLG                                                 01480000
@NM00010 EQU   $EXECFLG                                                 01481000
$RMSKCNT EQU   $SCTTBLE+32                                              01482000
$SYNAME  EQU   $CDS8T19+4                                               01483000
$EXTSIG  EQU   $CDS8T19+3                                               01484000
$CDFLGS  EQU   $CDS8T19+1                                               01485000
$CDSCNT  EQU   $CDS8T19                                                 01486000
$PDEVDSC EQU   $SCTTBLE+16                                              01487000
$PDEVADR EQU   $SCTTBLE+12                                              01488000
$COMMCN  EQU   $CDSFLGS                                                 01489000
$CUSTSYM EQU   $CDSFLGS                                                 01490000
$TWOCHSW EQU   $CDSFLGS                                                 01491000
$SYMNAME EQU   $CDSFLGS                                                 01492000
$EXTINTC EQU   $CDSFLGS                                                 01493000
$CEVOL   EQU   $CDSFLGS                                                 01494000
$SHARED  EQU   $CDSFLGS                                                 01495000
$FPM     EQU   $CDSFLGS                                                 01496000
$LASTSUB EQU   $PDEVFLG                                                 01497000
@NM00009 EQU   $PDEVFLG                                                 01498000
@NM00008 EQU   $PDEVFLG                                                 01499000
@NM00007 EQU   $PDEVFLG                                                 01500000
$LASTDEV EQU   $PDEVFLG                                                 01501000
@NM00006 EQU   $PDEVFLG                                                 01502000
$EXFILPT EQU   $PDEVFLG                                                 01503000
$FPMOLD  EQU   $PDEVFLG                                                 01504000
$TSSSYM  EQU   $SCTTBLE+8                                               01505000
$SCTLEVL EQU   $SCTTBLE+7                                               01506000
$DRIVER  EQU   $SCTTBLE+6                                               01507000
$RT0916  EQU   $SCTTBLE+5                                               01508000
$RT0108  EQU   $SCTTBLE+4                                               01509000
$LOOPTST EQU   $ERROPT                                                  01510000
$LOOPERR EQU   $ERROPT                                                  01511000
$NERRPRT EQU   $ERROPT                                                  01512000
$NOCNTRL EQU   $ERROPT                                                  01513000
$ALTPRNT EQU   $ERROPT                                                  01514000
$CATERR  EQU   $ERROPT                                                  01515000
$ASTERIK EQU   $ERROPT                                                  01516000
$TESTERR EQU   $ERROPT                                                  01517000
$FSTCOMM EQU   $TESTOPT                                                 01518000
$INDEFLP EQU   $TESTOPT                                                 01519000
$NOPRT   EQU   $TESTOPT                                                 01520000
$PARAPRT EQU   $TESTOPT                                                 01521000
@NM00005 EQU   $TESTOPT                                                 01522000
$ERRLPCT EQU   $SCTTBLE                                                 01523000
$TLTEND  EQU   $RCAAREA+945                                             01524000
$CNSLID  EQU   $RCAAREA+936                                             01525000
$EXITSAV EQU   $RCAAREA+864                                             01526000
$TRASCII EQU   $RCAAREA+608                                             01527000
@NM00004 EQU   $RCAAREA+605                                             01528000
$VTAMEND EQU   $RCAFLG                                                  01529000
$TPPOSTD EQU   $RCAFLG                                                  01530000
$NEWCT   EQU   $RCAFLG                                                  01531000
$ABNDALL EQU   $RCAFLG                                                  01532000
$CUTESTB EQU   $RCAFLG                                                  01533000
$CONSOLE EQU   $RCAFLG                                                  01534000
$TPLOGON EQU   $RCAFLG                                                  01535000
$UPDATE  EQU   $RCAFLG                                                  01536000
$DEVAREA EQU   $RCAAREA+600                                             01537000
$CTDVAR  EQU   $RCAAREA+596                                             01538000
$BUFFS   EQU   $RCAAREA+464                                             01539000
$TLTNIB  EQU   $CONSTNT+140                                             01540000
$TLTPRPL EQU   $CONSTNT+20                                              01541000
@NM00003 EQU   $CONSTNT+4                                               01542000
@NM00002 EQU   $CONSTNT+2                                               01543000
$USECNT  EQU   $CONSTNT                                                 01544000
$CURRTWA EQU   $POINTER+140                                             01545000
$CTNAME  EQU   $POINTER+132                                             01546000
$CTARGX  EQU   $POINTER+128                                             01547000
$COMINT  EQU   $POINTER+120                                             01548000
$QUEHNDL EQU   $POINTER+116                                             01549000
@NM00001 EQU   $POINTER+36                                              01550000
$RTNPTR  EQU   $POINTER+32                                              01551000
$TLTECB2 EQU   $POINTER+28                                              01552000
$TLTECB1 EQU   $POINTER+24                                              01553000
$CLEANP  EQU   $POINTER+20                                              01554000
$ABEND   EQU   $POINTER+16                                              01555000
$LSTAREA EQU   $POINTER+12                                              01556000
$FSTAREA EQU   $POINTER+8                                               01557000
$CVTSAVE EQU   $POINTER+4                                               01558000
$TOLTEP  EQU   $POINTER                                                 01559000
$TLTACB  EQU   $RCAAREA                                                 01560000
.@UNREFD ANOP                          END UNREFERENCED COMPONENTS      01561000
@RT00064 EQU   DEV007                                                   01562000
@RT00076 EQU   DEV007                                                   01563000
@RT00092 EQU   DEV600                                                   01564000
@RT00098 EQU   DEV600                                                   01565000
@RT00101 EQU   DEV800                                                   01566000
@RT00111 EQU   DEV030                                                   01567000
@RT00113 EQU   DEV020                                                   01568000
@RT00115 EQU   DEV030                                                   01569000
@RT00117 EQU   DEV800                                                   01570000
@RT00122 EQU   DEV040                                                   01571000
@RT00124 EQU   DEV072                                                   01572000
@RT00137 EQU   DEV800                                                   01573000
@RT00139 EQU   DEV070                                                   01574000
@RT00142 EQU   DEV800                                                   01575000
@RT00146 EQU   DEV800                                                   01576000
@RT00152 EQU   DEV120                                                   01577000
@RT00163 EQU   DEV072                                                   01578000
@RT00193 EQU   DEV800                                                   01579000
@RT00202 EQU   DEV072                                                   01580000
@RT00213 EQU   DEV084                                                   01581000
@RF00210 EQU   DEV800                                                   01582000
@RF00188 EQU   DEV800                                                   01583000
@RF00186 EQU   DEV150                                                   01584000
@RT00238 EQU   DEV050                                                   01585000
@RT00240 EQU   DEV500                                                   01586000
@RT00242 EQU   DEV130                                                   01587000
@RF00252 EQU   DEV840                                                   01588000
@RT00260 EQU   DEV165                                                   01589000
@RT00263 EQU   DEV700                                                   01590000
@RT00267 EQU   DEV100                                                   01591000
@RT00269 EQU   DEV100                                                   01592000
@RT00279 EQU   DEV075                                                   01593000
@RT00302 EQU   DEV820                                                   01594000
@RT00316 EQU   DEV840                                                   01595000
@ENDDATA EQU   *                                                        01596000
         END   ISTIC003,(C'PLS1233',0702,78336)                         01597000
./  ADD  SSI=83360128,NAME=ISTIC004
         TITLE 'ISTIC004-TEST DECODE'                                   00001000
ISTIC004 CSECT ,                                                   0001 00002000
@MAINENT DS    0H                                                  0001 00003000
         USING *,@15                                               0001 00004000
         B     @PROLOG                                             0001 00005000
         DC    AL1(16)                                             0001 00006000
         DC    C'ISTIC004  78.336'                                 0001 00007000
         DROP  @15                                                      00008000
@PROLOG  STM   @14,@12,12(@13)                                     0001 00009000
         BALR  @12,0                                               0001 00010000
@PSTART  DS    0H                                                  0001 00011000
         USING @PSTART,@12                                         0001 00012000
*   R5=R13;                         /* CALLERS SAVE PTR              */ 00013000
         LR    R5,R13                                              0055 00014000
*   R13=ADDR(SVEIC003);             /* PTR TO MY SAVEAREA            */ 00015000
         LA    R13,SVEIC003(,WAPTR)                                0056 00016000
*   BACKSAVE(3)=R13;                /* INTO CALLERS SAVE             */ 00017000
         ST    R13,BACKSAVE+8(,R5)                                 0057 00018000
*   SVEIC003(2)=R5;                 /* INTO MY SAVE                  */ 00019000
         ST    R5,SVEIC003+4(,WAPTR)                               0058 00020000
*   RCAPTR=$RCA;                    /* GET POINTER TO RCA            */ 00021000
         L     RCAPTR,$RCA(,WAPTR)                                 0059 00022000
*   $CUTESTB='0'B;                  /* TURN OFF CUTEST ACTIVE FLAG   */ 00023000
         NI    $CUTESTB(RCAPTR),B'11101111'                        0060 00024000
*   $CUCNT=0;                       /* SET CUTEST COUNT TO ZERO      */ 00025000
         SLR   @15,@15                                             0061 00026000
         STH   @15,$CUCNT(,WAPTR)                                  0061 00027000
*   R5=$SLASHAD(1)+1;               /* GET INBUFR POINTER            */ 00028000
         LA    R5,1                                                0062 00029000
         AL    R5,$SLASHAD(,WAPTR)                                 0062 00030000
*   GO TO CECTST04;                 /* NO, CONTINUE TO DECODE        */ 00031000
         B     CECTST04                                            0063 00032000
*CECTST03:                                                         0064 00033000
*                                                                  0064 00034000
*   /*****************************************************************/ 00035000
*   /*                                                               */ 00036000
*   /* PWTO MESSAGES IFD112I AND IFD155I                             */ 00037000
*   /*                                                               */ 00038000
*   /*****************************************************************/ 00039000
*                                                                  0064 00040000
*   R9=$SLASHAD(1)+1;               /* PT TO FIRST CHAR OF INPUT     */ 00041000
CECTST03 LA    R9,1                                                0064 00042000
         AL    R9,$SLASHAD(,WAPTR)                                 0064 00043000
*   $INBUFR(1:8)=' ';               /* BLK OUT SUB FIELD             */ 00044000
         MVI   $INBUFR+1(WAPTR),C' '                               0065 00045000
         MVC   $INBUFR+2(6,WAPTR),$INBUFR+1(WAPTR)                 0065 00046000
         MVI   $INBUFR(WAPTR),C' '                                 0065 00047000
*   DO I=8 TO 1 BY-1;               /* SCAN INPUT                    */ 00048000
         LA    I,8                                                 0066 00049000
@DL00066 DS    0H                                                  0067 00050000
*     $INBUFR(I)=INPUTBUF(1);       /* MOVE ERROR IN MSG             */ 00051000
         LR    @15,WAPTR                                           0067 00052000
         ALR   @15,I                                               0067 00053000
         MVC   $INBUFR-1(1,@15),INPUTBUF(R5)                       0067 00054000
*     IF R9=R5 THEN                 /* END OF FIELD ?                */ 00055000
         CR    R9,R5                                               0068 00056000
         BE    @RT00068                                            0068 00057000
*       GO TO CECTST05;             /* GO WRITE MSG                  */ 00058000
*     R5=R5-1;                      /* DECR INPUT PTR                */ 00059000
         BCTR  R5,0                                                0070 00060000
*   END;                                                           0071 00061000
         BCTR  I,0                                                 0071 00062000
         LTR   I,I                                                 0071 00063000
         BP    @DL00066                                            0071 00064000
*CECTST05:                                                         0072 00065000
*                                                                  0072 00066000
*   /*****************************************************************/ 00067000
*   /*                                                               */ 00068000
*   /* ISSUE MESSAGE 112 TCEC MSGN(112)SUB(YES) INVOKED              */ 00069000
*   /*                                                               */ 00070000
*   /*****************************************************************/ 00071000
*                                                                  0072 00072000
*   $TCECM='1'B;                    /* SET TCEC SW IN RCA            */ 00073000
CECTST05 OI    $TCECM(WAPTR),B'00000001'                           0072 00074000
*   R1=ADDR($TCA09);                /* SET UP PARM LIST $TR          */ 00075000
         LA    R1,$TCA09                                           0073 00076000
*   CALL #EXIT;                     /* CALL CECOM                    */ 00077000
         L     @15,#EXITA(,WAPTR)                                  0074 00078000
         BALR  @14,@15                                             0074 00079000
*   DCL                                                            0075 00080000
*     1 $TCA09,                     /* TCEC PARM LIST                */ 00081000
*      2 $TCB09 FIXED(32) INIT(112),/* MSG NUMBER                    */ 00082000
*      2 $TCC09 FIXED(32) INIT(0),  /* INCT LEN                      */ 00083000
*      2 $TCD09 BIT(8) INIT('10000000'B),/* FLAG                     */ 00084000
*      2 $TCE09 CHAR(4) INIT('FFFFFFFF'X);/* MSSAGE MASK             */ 00085000
*   GO TO CECTST07;                 /* SET TST ERROR FLAG ON         */ 00086000
         B     CECTST07                                            0076 00087000
*CECTST06:                                                         0077 00088000
*                                                                  0077 00089000
*   /*****************************************************************/ 00090000
*   /*                                                               */ 00091000
*   /* ISSUE MESSAGE 155 TCEC MSGN(155)SUB(NO) INVOKED               */ 00092000
*   /*                                                               */ 00093000
*   /*****************************************************************/ 00094000
*                                                                  0077 00095000
*   $TCECM='1'B;                    /* SET TCEC SW IN RCA            */ 00096000
CECTST06 OI    $TCECM(WAPTR),B'00000001'                           0077 00097000
*   R1=ADDR($TCA10);                /* SET UP PARM LIST $TR          */ 00098000
         LA    R1,$TCA10                                           0078 00099000
*   CALL #EXIT;                     /* CALL CECOM                    */ 00100000
         L     @15,#EXITA(,WAPTR)                                  0079 00101000
         BALR  @14,@15                                             0079 00102000
*   DCL                                                            0080 00103000
*     1 $TCA10,                     /* TCEC PARM LIST                */ 00104000
*      2 $TCB10 FIXED(32) INIT(155),/* MSG NUMBER                    */ 00105000
*      2 $TCC10 FIXED(32) INIT(0),  /* INCT LEN                      */ 00106000
*      2 $TCD10 BIT(8) INIT('00000000'B),/* FLAG                     */ 00107000
*      2 $TCE10 CHAR(4) INIT('FFFFFFFF'X);/* MSSAGE MASK             */ 00108000
*   $TSTERR='1'B;                   /* SET ERROR FLAG ON             */ 00109000
         OI    $TSTERR(WAPTR),B'01000000'                          0081 00110000
*   GO TO CECTST99;                 /* RETURN TO COMM INT            */ 00111000
         B     CECTST99                                            0082 00112000
*CECTST07:                          /* SET ERROR FLAG ON             */ 00113000
*   $TSTERR='1'B;                                                  0083 00114000
CECTST07 OI    $TSTERR(WAPTR),B'01000000'                          0083 00115000
*   GO TO CECTST77;                 /* RETURN TO COMM INT            */ 00116000
         B     CECTST77                                            0084 00117000
*CECTST04:                                                         0085 00118000
*                                                                  0085 00119000
*   /*****************************************************************/ 00120000
*   /*                                                               */ 00121000
*   /* INITIALIZE TEST DECODE                                        */ 00122000
*   /*                                                               */ 00123000
*   /*****************************************************************/ 00124000
*                                                                  0085 00125000
*   $TSTCNT=$TSTCNT&&$TSTCNT;       /* INIT SECTION COUNT            */ 00126000
CECTST04 LH    @15,$TSTCNT(,WAPTR)                                 0085 00127000
         LR    @00,@15                                             0085 00128000
         XR    @00,@15                                             0085 00129000
         STH   @00,$TSTCNT(,WAPTR)                                 0085 00130000
*   $RTNSLCT='0'B;                  /* INIT RTN SELECT BIT           */ 00131000
         NI    $RTNSLCT(WAPTR),B'11011111'                         0086 00132000
*   $FAMILY(1)=' ';                 /* INIT FAMILY OF TESTS          */ 00133000
         MVI   $FAMILY(WAPTR),C' '                                 0087 00134000
*   $FAMILY(2:5)=$FAMILY(1:4);      /* BE RUN                        */ 00135000
         MVC   @TS00001(4),$FAMILY(WAPTR)                          0088 00136000
         MVC   $FAMILY+1(4,WAPTR),@TS00001                         0088 00137000
*   $VALDTST='0'B;                  /* INIT VALID TEST BIT           */ 00138000
         NI    $VALDTST(WAPTR),B'11111011'                         0089 00139000
*   SWITCHES=SWITCHES&&SWITCHES;    /* INIT INTERNAL SWCHS           */ 00140000
         XC    SWITCHES(1),SWITCHES                                0090 00141000
*   $RT0108=$RT0108&&$RT0108;       /* INITIALIZE                    */ 00142000
         XC    $RT0108(1,WAPTR),$RT0108(WAPTR)                     0091 00143000
*   $RT0916=$RT0916&&$RT0916;       /* ROUTINE                       */ 00144000
         XC    $RT0916(1,WAPTR),$RT0916(WAPTR)                     0092 00145000
*   $ROUTMSK=$ROUTMSK&&$ROUTMSK;    /* MASKS                         */ 00146000
         XC    $ROUTMSK(30,WAPTR),$ROUTMSK(WAPTR)                  0093 00147000
*   DO I=1 TO 26 BY 1;              /* CLEAR OUT SECTION LIST        */ 00148000
         LA    I,1                                                 0094 00149000
@DL00094 DS    0H                                                  0095 00150000
*     $SECLST(I)=SECINIT;                                          0095 00151000
         LR    @15,I                                               0095 00152000
         SLA   @15,2                                               0095 00153000
         ALR   @15,WAPTR                                           0095 00154000
         MVC   $SECLST-4(4,@15),SECINIT                            0095 00155000
*   END;                                                           0096 00156000
         AL    I,@CF00072                                          0096 00157000
         C     I,@CF00493                                          0096 00158000
         BNH   @DL00094                                            0096 00159000
*   SECCNTR=0;                                                     0097 00160000
         SLR   @15,@15                                             0097 00161000
         ST    @15,SECCNTR                                         0097 00162000
*   R8=ADDR($SECLST);               /* GET ADDR OF SECT LIST         */ 00163000
         LA    R8,$SECLST(,WAPTR)                                  0098 00164000
*   $FAMILY(1)='T';                 /* ENTER T AS DEFAULT            */ 00165000
         MVI   $FAMILY(WAPTR),C'T'                                 0099 00166000
*   IF INPUTBUF(1)='T'|             /* IF                            */ 00167000
*       INPUTBUF(1)='P'|            /* TEST PREFIX                   */ 00168000
*       INPUTBUF(1)='N'|            /* IS VALID                      */ 00169000
*       INPUTBUF(1)='R' THEN        /* MOVE IT                       */ 00170000
         CLI   INPUTBUF(R5),C'T'                                   0100 00171000
         BE    @RT00100                                            0100 00172000
         CLI   INPUTBUF(R5),C'P'                                   0100 00173000
         BE    @RT00100                                            0100 00174000
         CLI   INPUTBUF(R5),C'N'                                   0100 00175000
         BE    @RT00100                                            0100 00176000
         CLI   INPUTBUF(R5),C'R'                                   0100 00177000
         BNE   @RF00100                                            0100 00178000
@RT00100 DS    0H                                                  0101 00179000
*     DO;                           /* TO THE                        */ 00180000
*       $FAMILY(1)=INPUTBUF(1);     /* SECTION LIST                  */ 00181000
         MVC   $FAMILY(1,WAPTR),INPUTBUF(R5)                       0102 00182000
*       R5=R5+1;                    /* POINT TO NUMERICS             */ 00183000
         AL    R5,@CF00072                                         0103 00184000
*     END;                                                         0104 00185000
*CECTST11:                                                         0105 00186000
*                                                                  0105 00187000
*   /*****************************************************************/ 00188000
*   /*                                                               */ 00189000
*   /* IS TEST ID NUMERIC                                            */ 00190000
*   /*                                                               */ 00191000
*   /*****************************************************************/ 00192000
*                                                                  0105 00193000
*   DO J=1 TO 4;                    /* ARE ALL CHARACTERS IN         */ 00194000
@RF00100 DS    0H                                                  0105 00195000
CECTST11 LA    @15,1                                               0105 00196000
         STH   @15,J                                               0105 00197000
@DL00105 DS    0H                                                  0106 00198000
*     R6=ADDR(NUMBERS);             /* ID NUMERIC. NO, SET           */ 00199000
         LA    R6,NUMBERS                                          0106 00200000
*     DO I=10 TO 1 BY-1;            /* ERROR CODE TO -05-            */ 00201000
         LA    I,10                                                0107 00202000
@DL00107 DS    0H                                                  0108 00203000
*       IF INPUTBUF(J)=NUMBER THEN  /* AND PRINT ERROR               */ 00204000
         LH    @15,J                                               0108 00205000
         ALR   @15,R5                                              0108 00206000
         BCTR  @15,0                                               0108 00207000
         CLC   INPUTBUF(1,@15),NUMBER(R6)                          0108 00208000
         BE    @RT00108                                            0108 00209000
*         GO TO CECTST12;           /* MESSAGE IFD112I               */ 00210000
*       R6=R6+1;                    /* YES, CONTINUE TO              */ 00211000
         AL    R6,@CF00072                                         0110 00212000
*     END;                          /* DECODE                        */ 00213000
         BCTR  I,0                                                 0111 00214000
         LTR   I,I                                                 0111 00215000
         BP    @DL00107                                            0111 00216000
*     R5=R5+J-1;                    /* PT TO ERROR                   */ 00217000
         LR    @15,R5                                              0112 00218000
         AH    @15,J                                               0112 00219000
         BCTR  @15,0                                               0112 00220000
         LR    R5,@15                                              0112 00221000
*     GO TO CECTST03;                                              0113 00222000
         B     CECTST03                                            0113 00223000
*CECTST12:                                                         0114 00224000
*   END;                                                           0114 00225000
CECTST12 LA    @15,1                                               0114 00226000
         AH    @15,J                                               0114 00227000
         STH   @15,J                                               0114 00228000
         C     @15,@CF00068                                        0114 00229000
         BNH   @DL00105                                            0114 00230000
*   $FAMILY(2:5)=INPUTBUF(1:4);     /* MOVE NUMERIC ENTRY            */ 00231000
         MVC   $FAMILY+1(4,WAPTR),INPUTBUF(R5)                     0115 00232000
*CECTST13:                                                         0116 00233000
*                                                                  0116 00234000
*   /*****************************************************************/ 00235000
*   /*                                                               */ 00236000
*   /* DECODE SECTIONS ENTERED, IF THERE ARE ANY. IF NONE ARE        */ 00237000
*   /* ENTERED, USE DEFAULT RANGE A-Z.                               */ 00238000
*   /*                                                               */ 00239000
*   /*****************************************************************/ 00240000
*                                                                  0116 00241000
*   R5=R5+4;                        /* INCREMENT INBUFR POINTER BY 4 */ 00242000
CECTST13 AL    R5,@CF00068                                         0116 00243000
*   IF INPUTBUF(1)='/' THEN         /* IS CHAR IN INBUFR+0 A SLASH.  */ 00244000
         CLI   INPUTBUF(R5),C'/'                                   0117 00245000
         BNE   @RF00117                                            0117 00246000
*     DO;                           /* YES, SET BIT INDICATING       */ 00247000
*       SECTIONS='100'B;            /* TEST SECTION HAS A LENGTH     */ 00248000
*                                                                  0119 00249000
         NI    SECTIONS,B'10011111'                                0119 00250000
         OI    SECTIONS,B'10000000'                                0119 00251000
*       /*************************************************************/ 00252000
*       /*                                                           */ 00253000
*       /* OF ONE & SET DEFAULT RANGE                                */ 00254000
*       /*                                                           */ 00255000
*       /*************************************************************/ 00256000
*                                                                  0120 00257000
*       FSTSEC='  A';               /* OF SECTIONS A-Z & SET         */ 00258000
         MVC   FSTSEC(3),@CC00764                                  0120 00259000
*       LSTSEC='  Z';               /* POINTER 1 TO ADDRESS OF 1ST   */ 00260000
         MVC   LSTSEC(3),@CC00765                                  0121 00261000
*       LET1PTR=ADDR(ALPHABET);     /* LETTER IN ALPHABET & GO TO    */ 00262000
         LA    @15,ALPHABET                                        0122 00263000
         ST    @15,LET1PTR                                         0122 00264000
*       GO TO CECTST29;             /* ROUTINE THAT BUILDS SECLST    */ 00265000
         B     CECTST29                                            0123 00266000
*     END;                                                         0124 00267000
*CECTST14:                                                         0125 00268000
*                                                                  0125 00269000
*   /*****************************************************************/ 00270000
*   /*                                                               */ 00271000
*   /* DECODE THE ENTERED SECTIONS                                   */ 00272000
*   /*                                                               */ 00273000
*   /*****************************************************************/ 00274000
*                                                                  0125 00275000
*   FSTSEC='   ';                   /* INITIALIZE CONSTANTS          */ 00276000
@RF00117 DS    0H                                                  0125 00277000
CECTST14 MVC   FSTSEC(3),@CC00768                                  0125 00278000
*   LSTSEC=FSTSEC;                  /* TO DECODE SECTIONS            */ 00279000
         MVC   LSTSEC(3),FSTSEC                                    0126 00280000
*   R6=ADDR(ALPHABET);              /* IS THE CHAR. IN INBUFR        */ 00281000
         LA    R6,ALPHABET                                         0127 00282000
*   DO I=26 TO 1 BY-1;              /* ALPHABETIC. YES, SET          */ 00283000
         LA    I,26                                                0128 00284000
@DL00128 DS    0H                                                  0129 00285000
*     IF INPUTBUF(1)=LETTER THEN    /* POINTER TO IT AND             */ 00286000
         CLC   INPUTBUF(1,R5),LETTER(R6)                           0129 00287000
         BNE   @RF00129                                            0129 00288000
*       DO;                         /* CONTINUE DECODING. NO         */ 00289000
*         LET1PTR=R6;               /* SET ERROR CODE -06- AND       */ 00290000
         ST    R6,LET1PTR                                          0131 00291000
*         GO TO CECTST15;           /* PRINT ERROR MESSAGE           */ 00292000
         B     CECTST15                                            0132 00293000
*       END;                        /* IFD112I                       */ 00294000
*     R6=R6+1;                                                     0134 00295000
@RF00129 AL    R6,@CF00072                                         0134 00296000
*   END;                                                           0135 00297000
         BCTR  I,0                                                 0135 00298000
         LTR   I,I                                                 0135 00299000
         BP    @DL00128                                            0135 00300000
*   GOTO CECTST03;                                                 0136 00301000
         B     CECTST03                                            0136 00302000
*CECTST15:                          /* DOES SECTION NAME HAVE LENGTH    00303000
*                                      TWO                           */ 00304000
*   SECTIONS='000'B;                /* CLEAR BITS THAT INDICATE THE  */ 00305000
*                                                                  0137 00306000
CECTST15 NI    SECTIONS,B'00011111'                                0137 00307000
*   /*****************************************************************/ 00308000
*   /*                                                               */ 00309000
*   /* LENGTH OF THE TEST SECTION                                    */ 00310000
*   /*                                                               */ 00311000
*   /*****************************************************************/ 00312000
*                                                                  0138 00313000
*   R6=ADDR(ALPHABET);              /* IS THE CHAR IN INBUFR+1       */ 00314000
         LA    R6,ALPHABET                                         0138 00315000
*   DO I=26 TO 1 BY-1;              /* ALPHABETIC. YES, SET A        */ 00316000
         LA    I,26                                                0139 00317000
@DL00139 DS    0H                                                  0140 00318000
*     IF INPUTBUF(2)=LETTER THEN    /* POINTER TO IT AND CONTINUE    */ 00319000
         CLC   INPUTBUF+1(1,R5),LETTER(R6)                         0140 00320000
         BNE   @RF00140                                            0140 00321000
*       DO;                         /* TO DECODE.                    */ 00322000
*         LET2PTR=LET1PTR;                                         0142 00323000
         L     @15,LET1PTR                                         0142 00324000
         ST    @15,LET2PTR                                         0142 00325000
*         LET1PTR=R6;                                              0143 00326000
         ST    R6,LET1PTR                                          0143 00327000
*         GO TO CECTST21;                                          0144 00328000
         B     CECTST21                                            0144 00329000
*       END;                                                       0145 00330000
*     R6=R6+1;                                                     0146 00331000
@RF00140 AL    R6,@CF00072                                         0146 00332000
*   END;                                                           0147 00333000
         BCTR  I,0                                                 0147 00334000
         LTR   I,I                                                 0147 00335000
         BP    @DL00139                                            0147 00336000
*   SECT1='1'B;                     /* NO, SET BIT INDICATING TEST   */ 00337000
*                                                                  0148 00338000
         OI    SECT1,B'10000000'                                   0148 00339000
*   /*****************************************************************/ 00340000
*   /*                                                               */ 00341000
*   /* SECTION OF LENGTH ONE                                         */ 00342000
*   /*                                                               */ 00343000
*   /*****************************************************************/ 00344000
*                                                                  0149 00345000
*   FSTSEC2=INPUTBUF(1);            /* RETAIN SECTION NAME.          */ 00346000
         MVC   FSTSEC2(1),INPUTBUF(R5)                             0149 00347000
*   IF INPUTBUF(2)='-' THEN         /* IS THE CHAR. IN INBUFR+1      */ 00348000
         CLI   INPUTBUF+1(R5),C'-'                                 0150 00349000
         BNE   @RF00150                                            0150 00350000
*     DO;                                                          0151 00351000
*       DASH='1'B;                                                 0152 00352000
         OI    DASH,B'00000001'                                    0152 00353000
*       GO TO CECTST17;             /* A HYPHEN. YES,CONTINUE        */ 00354000
         B     CECTST17                                            0153 00355000
*     END;                                                         0154 00356000
*                                                                  0154 00357000
*   /*****************************************************************/ 00358000
*   /*                                                               */ 00359000
*   /* DECODING. NO, SET LAST                                        */ 00360000
*   /*                                                               */ 00361000
*   /*****************************************************************/ 00362000
*                                                                  0155 00363000
*CECTST16:                          /* ROUTINE FOR INCLUSIVE SECTIONS   00364000
*                                      OF LENGTH ONE                 */ 00365000
*   LSTSEC2=INPUTBUF(1);            /* SECTION EQUAL TO FIRST        */ 00366000
*                                                                  0155 00367000
@RF00150 DS    0H                                                  0155 00368000
CECTST16 MVC   LSTSEC2(1),INPUTBUF(R5)                             0155 00369000
*   /*****************************************************************/ 00370000
*   /*                                                               */ 00371000
*   /* SECTION                                                       */ 00372000
*   /*                                                               */ 00373000
*   /*****************************************************************/ 00374000
*                                                                  0156 00375000
*   R5=R5+1;                        /* INCREMENT INBUFR PTR          */ 00376000
         AL    R5,@CF00072                                         0156 00377000
*   GO TO CECTST29;                 /* GO TO ROUTINE THAT            */ 00378000
*                                                                  0157 00379000
         B     CECTST29                                            0157 00380000
*   /*****************************************************************/ 00381000
*   /*                                                               */ 00382000
*   /* BUILDS SECLST                                                 */ 00383000
*   /*                                                               */ 00384000
*   /*****************************************************************/ 00385000
*                                                                  0158 00386000
*CECTST17:                                                         0158 00387000
*                                                                  0158 00388000
*   /*****************************************************************/ 00389000
*   /*                                                               */ 00390000
*   /* IS A VALID INCLUSIVE RANGE ENTERED                            */ 00391000
*   /*                                                               */ 00392000
*   /*****************************************************************/ 00393000
*                                                                  0158 00394000
*   R6=ADDR(ALPHABET);              /* IS THE CHAR. IN INBUFR+2      */ 00395000
CECTST17 LA    R6,ALPHABET                                         0158 00396000
*   DO I=26 TO 1 BY-1;              /* ALPHABETIC. NO, SET ERROR     */ 00397000
         LA    I,26                                                0159 00398000
@DL00159 DS    0H                                                  0160 00399000
*     IF INPUTBUF(3)=LETTER THEN    /* CODE 07 AND PRINT ERROR       */ 00400000
         CLC   INPUTBUF+2(1,R5),LETTER(R6)                         0160 00401000
         BE    @RT00160                                            0160 00402000
*       GO TO CECTST19;             /* MESSAGE IFD112I. YES,         */ 00403000
*     R6=R6+1;                      /* CONTINUE TO DECODE            */ 00404000
         AL    R6,@CF00072                                         0162 00405000
*   END;                                                           0163 00406000
         BCTR  I,0                                                 0163 00407000
         LTR   I,I                                                 0163 00408000
         BP    @DL00159                                            0163 00409000
*   R5=R5+2;                        /* PT TO ERROR                   */ 00410000
         AL    R5,@CF00139                                         0164 00411000
*   GO TO CECTST03;                                                0165 00412000
         B     CECTST03                                            0165 00413000
*CECTST19:                          /* IS SECTION NAME OF INCLUSIVE     00414000
*                                      RANGE LENGTH TWO              */ 00415000
*   R5=R5+2;                        /* INCREMENT INBUFR PTR          */ 00416000
CECTST19 AL    R5,@CF00139                                         0166 00417000
*   R6=ADDR(ALPHABET);              /* IS THE CHAR. IN INBUFR+1      */ 00418000
         LA    R6,ALPHABET                                         0167 00419000
*   DO I=26 TO 1 BY-1;              /* ALPHABETIC. NO, GO TO         */ 00420000
         LA    I,26                                                0168 00421000
@DL00168 DS    0H                                                  0169 00422000
*     IF INPUTBUF(2)=LETTER THEN    /* ROUTINE FOR INCLUSIVE         */ 00423000
         CLC   INPUTBUF+1(1,R5),LETTER(R6)                         0169 00424000
         BE    @RT00169                                            0169 00425000
*       GO TO CECTST20;             /* SECTIONS OF LENGTH ONE        */ 00426000
*     R6=R6+1;                      /* YES, CONTINUE TO DECODE       */ 00427000
         AL    R6,@CF00072                                         0171 00428000
*   END;                                                           0172 00429000
         BCTR  I,0                                                 0172 00430000
         LTR   I,I                                                 0172 00431000
         BP    @DL00168                                            0172 00432000
*   GO TO CECTST16;                 /* CONTINUE DECODING.            */ 00433000
         B     CECTST16                                            0173 00434000
*CECTST20:                          /* IS SECTION NAME OF INCLUSIVE     00435000
*                                      RANGE LENGTH THREE            */ 00436000
*   R6=ADDR(ALPHABET);              /* IS THE CHAR. IN INBUFR+2      */ 00437000
CECTST20 LA    R6,ALPHABET                                         0174 00438000
*   DO I=26 TO 1 BY-1;              /* ALPHABETIC. NO,GO TO          */ 00439000
         LA    I,26                                                0175 00440000
@DL00175 DS    0H                                                  0176 00441000
*     IF INPUTBUF(3)=LETTER THEN    /* ROUTINE FOR INCLUSIVE         */ 00442000
         CLC   INPUTBUF+2(1,R5),LETTER(R6)                         0176 00443000
         BE    @RT00176                                            0176 00444000
*       GO TO CECTST26;             /* SECTIONS OF LENGTH TWO        */ 00445000
*     R6=R6+1;                      /* YES,GO TO ROUTINE FOR         */ 00446000
         AL    R6,@CF00072                                         0178 00447000
*   END;                            /* INCLUSIVE SECTIONS OF         */ 00448000
         BCTR  I,0                                                 0179 00449000
         LTR   I,I                                                 0179 00450000
         BP    @DL00175                                            0179 00451000
*   GO TO CECTST22;                 /* LENGTH THREE.                 */ 00452000
         B     CECTST22                                            0180 00453000
*CECTST21:                          /* DOES SECTION NAME HAVE LENGTH    00454000
*                                      THREE                         */ 00455000
*   R6=ADDR(ALPHABET);              /* IS THE CHAR. IN INBUFR+2      */ 00456000
CECTST21 LA    R6,ALPHABET                                         0181 00457000
*   DO I=26 TO 1 BY-1;              /* ALPHABETIC. YES, SET          */ 00458000
         LA    I,26                                                0182 00459000
@DL00182 DS    0H                                                  0183 00460000
*     IF INPUTBUF(3)=LETTER THEN    /* POINTER TO IT AND             */ 00461000
         CLC   INPUTBUF+2(1,R5),LETTER(R6)                         0183 00462000
         BNE   @RF00183                                            0183 00463000
*       DO;                         /* CONTINUE TO DECODE            */ 00464000
*         LET3PTR=LET2PTR;                                         0185 00465000
         L     @15,LET2PTR                                         0185 00466000
         ST    @15,LET3PTR                                         0185 00467000
*         LET2PTR=LET1PTR;                                         0186 00468000
         L     @15,LET1PTR                                         0186 00469000
         ST    @15,LET2PTR                                         0186 00470000
*         LET1PTR=R6;                                              0187 00471000
         ST    R6,LET1PTR                                          0187 00472000
*         GO TO CECTST25;                                          0188 00473000
         B     CECTST25                                            0188 00474000
*       END;                                                       0189 00475000
*     R6=R6+1;                                                     0190 00476000
@RF00183 AL    R6,@CF00072                                         0190 00477000
*   END;                                                           0191 00478000
         BCTR  I,0                                                 0191 00479000
         LTR   I,I                                                 0191 00480000
         BP    @DL00182                                            0191 00481000
*   SECTIONS='010'B;                /* NO, SET BIT INDICATING        */ 00482000
*                                                                  0192 00483000
         NI    SECTIONS,B'01011111'                                0192 00484000
         OI    SECTIONS,B'01000000'                                0192 00485000
*   /*****************************************************************/ 00486000
*   /*                                                               */ 00487000
*   /* TEST SECTION OF LENGTH TWO & SAVE THE SECTION                 */ 00488000
*   /*                                                               */ 00489000
*   /*****************************************************************/ 00490000
*                                                                  0193 00491000
*   FSTSEC1=INPUTBUF(1:2);          /* IN FSTSEC.                    */ 00492000
         MVC   FSTSEC1(2),INPUTBUF(R5)                             0193 00493000
*   IF INPUTBUF(3)='-' THEN         /* IS CHAR. IN INBUFR+2 A -.     */ 00494000
         CLI   INPUTBUF+2(R5),C'-'                                 0194 00495000
         BNE   @RF00194                                            0194 00496000
*     DO;                                                          0195 00497000
*       DASH='1'B;                                                 0196 00498000
         OI    DASH,B'00000001'                                    0196 00499000
*       GO TO CECTST23;             /* YES, CONTINUE TO DECODE       */ 00500000
         B     CECTST23                                            0197 00501000
*     END;                                                         0198 00502000
*CECTST22:                          /* ROUTINE FOR INCLUSIVE SECTIONS   00503000
*                                      OF LENGTH TWO                 */ 00504000
*   LSTSEC1=INPUTBUF(1:2);          /* PUT SECTION IN LSTSEC         */ 00505000
@RF00194 DS    0H                                                  0199 00506000
CECTST22 MVC   LSTSEC1(2),INPUTBUF(R5)                             0199 00507000
*   R5=R5+2;                        /* INCREMENT INBUFR POINTER      */ 00508000
         AL    R5,@CF00139                                         0200 00509000
*   GO TO CECTST29;                 /* GO TO THE ROUTINE FOR         */ 00510000
*                                                                  0201 00511000
         B     CECTST29                                            0201 00512000
*   /*****************************************************************/ 00513000
*   /*                                                               */ 00514000
*   /* BUILDING SECLST                                               */ 00515000
*   /*                                                               */ 00516000
*   /*****************************************************************/ 00517000
*                                                                  0202 00518000
*CECTST23:                          /* IS INCLUSIVE RANGE VALID      */ 00519000
*   R5=R5+3;                        /* INCREMENT INBUFR PTR          */ 00520000
CECTST23 AL    R5,@CF00081                                         0202 00521000
*   DO J=1 TO 2;                    /* ARE THE CHAR. IN INBUFR AND   */ 00522000
         LA    @15,1                                               0203 00523000
         STH   @15,J                                               0203 00524000
@DL00203 DS    0H                                                  0204 00525000
*     R6=ADDR(ALPHABET);            /* INBUFR+1 ALPHABETIC. YES,     */ 00526000
         LA    R6,ALPHABET                                         0204 00527000
*     DO I=26 TO 1 BY-1;            /* CONTINUE TO DECODE. NO, SET   */ 00528000
         LA    I,26                                                0205 00529000
@DL00205 DS    0H                                                  0206 00530000
*       IF INPUTBUF(J)=LETTER THEN  /* ERROR CODE TO -07-            */ 00531000
         LH    @15,J                                               0206 00532000
         ALR   @15,R5                                              0206 00533000
         BCTR  @15,0                                               0206 00534000
         CLC   INPUTBUF(1,@15),LETTER(R6)                          0206 00535000
         BE    @RT00206                                            0206 00536000
*         GO TO CECTST24;           /* AND PRINT ERROR               */ 00537000
*       R6=R6+1;                    /* MESSAGE IFD112I               */ 00538000
         AL    R6,@CF00072                                         0208 00539000
*     END;                                                         0209 00540000
         BCTR  I,0                                                 0209 00541000
         LTR   I,I                                                 0209 00542000
         BP    @DL00205                                            0209 00543000
*     R5=R5+J-1;                    /* PT TO ERROR                   */ 00544000
         LR    @15,R5                                              0210 00545000
         AH    @15,J                                               0210 00546000
         BCTR  @15,0                                               0210 00547000
         LR    R5,@15                                              0210 00548000
*     GOTO CECTST03;                                               0211 00549000
         B     CECTST03                                            0211 00550000
*CECTST24:                                                         0212 00551000
*   END;                                                           0212 00552000
CECTST24 LA    @15,1                                               0212 00553000
         AH    @15,J                                               0212 00554000
         STH   @15,J                                               0212 00555000
         C     @15,@CF00139                                        0212 00556000
         BNH   @DL00203                                            0212 00557000
*   R6=ADDR(ALPHABET);              /* IS THE CHAR. IN INBUFR+2      */ 00558000
         LA    R6,ALPHABET                                         0213 00559000
*   DO I=26 TO 1 BY-1;              /* ALPHABETIC. YES,GO TO THE     */ 00560000
         LA    I,26                                                0214 00561000
@DL00214 DS    0H                                                  0215 00562000
*     IF INPUTBUF(3)=LETTER THEN    /* ROUTINE FOR INCLUSIVE         */ 00563000
         CLC   INPUTBUF+2(1,R5),LETTER(R6)                         0215 00564000
         BE    @RT00215                                            0215 00565000
*       GO TO CECTST26;             /* SECTIONS OF LENGTH THREE      */ 00566000
*     R6=R6+1;                      /* NO, SEE IF INPUTBUF(1:2)      */ 00567000
         AL    R6,@CF00072                                         0217 00568000
*   END;                            /* IS > FSTSEC+1. YES,           */ 00569000
         BCTR  I,0                                                 0218 00570000
         LTR   I,I                                                 0218 00571000
         BP    @DL00214                                            0218 00572000
*   IF INPUTBUF(1:2)>FSTSEC1 THEN   /* CONTINUE TO DECODE. NO,       */ 00573000
         CLC   INPUTBUF(2,R5),FSTSEC1                              0219 00574000
         BH    @RT00219                                            0219 00575000
*     GO TO CECTST22;               /* SET ERROR CODE -07- AND       */ 00576000
*   R5=R5+1;                        /* PT TO ERROR                   */ 00577000
         AL    R5,@CF00072                                         0221 00578000
*   GOTO CECTST03;                                                 0222 00579000
         B     CECTST03                                            0222 00580000
*CECTST25:                          /* SECTION NAME OF LENGTH THREE  */ 00581000
*   SECTIONS='001'B;                /* SET BIT TO INDICATE SECTION   */ 00582000
*                                                                  0223 00583000
CECTST25 NI    SECTIONS,B'00111111'                                0223 00584000
         OI    SECTIONS,B'00100000'                                0223 00585000
*   /*****************************************************************/ 00586000
*   /*                                                               */ 00587000
*   /* NAME OF LENGTH THREE                                          */ 00588000
*   /*                                                               */ 00589000
*   /*****************************************************************/ 00590000
*                                                                  0224 00591000
*   FSTSEC=INPUTBUF(1:3);           /* SAVE SECTION NAME             */ 00592000
         MVC   FSTSEC(3),INPUTBUF(R5)                              0224 00593000
*   IF INPUTBUF(4)='-' THEN         /* IS THE CHAR. IN INBUFR+3 A    */ 00594000
         CLI   INPUTBUF+3(R5),C'-'                                 0225 00595000
         BNE   @RF00225                                            0225 00596000
*     DO;                                                          0226 00597000
*       DASH='1'B;                                                 0227 00598000
         OI    DASH,B'00000001'                                    0227 00599000
*       GO TO CECTST27;             /* HYPHEN. YES,CONTINUE TO DECODE*/ 00600000
         B     CECTST27                                            0228 00601000
*     END;                                                         0229 00602000
*                                                                  0229 00603000
*   /*****************************************************************/ 00604000
*   /*                                                               */ 00605000
*   /* NO, GO TO ROUTINE THAT BUILDS SECLST                          */ 00606000
*   /*                                                               */ 00607000
*   /*****************************************************************/ 00608000
*                                                                  0230 00609000
*CECTST26:                          /* ROUTINE FOR INCLUSIVE SECTIONS   00610000
*                                      OF LENGTH THREE               */ 00611000
*   LSTSEC=INPUTBUF(1:3);           /* SET LSTSEC EQUAL TO SECTION   */ 00612000
*                                                                  0230 00613000
@RF00225 DS    0H                                                  0230 00614000
CECTST26 MVC   LSTSEC(3),INPUTBUF(R5)                              0230 00615000
*   /*****************************************************************/ 00616000
*   /*                                                               */ 00617000
*   /* IN INBUFR                                                     */ 00618000
*   /*                                                               */ 00619000
*   /*****************************************************************/ 00620000
*                                                                  0231 00621000
*   R5=R5+3;                        /* INCREMENT INBUFR PTR          */ 00622000
         AL    R5,@CF00081                                         0231 00623000
*   GO TO CECTST29;                 /* GO TO ROUTINE THAT            */ 00624000
*                                                                  0232 00625000
         B     CECTST29                                            0232 00626000
*   /*****************************************************************/ 00627000
*   /*                                                               */ 00628000
*   /* BUILDS SECLST                                                 */ 00629000
*   /*                                                               */ 00630000
*   /*****************************************************************/ 00631000
*                                                                  0233 00632000
*CECTST27:                          /* IS SECTION NAME OF INCLUSIVE     00633000
*                                      RANGE LENGTH THREE            */ 00634000
*                                                                  0233 00635000
*   /*****************************************************************/ 00636000
*   /*                                                               */ 00637000
*   /* AND IS IT A VALID INCLUSIVE RANGE                             */ 00638000
*   /*                                                               */ 00639000
*   /*****************************************************************/ 00640000
*                                                                  0233 00641000
*   R5=R5+4;                        /* INCREMENT INBUFR PTR          */ 00642000
CECTST27 AL    R5,@CF00068                                         0233 00643000
*   DO J=1 TO 3;                    /* ARE THE CHAR. INBUFR,INBUFR+1 */ 00644000
         LA    @15,1                                               0234 00645000
         STH   @15,J                                               0234 00646000
@DL00234 DS    0H                                                  0235 00647000
*     R6=ADDR(ALPHABET);            /* AND INBUFR+2 ALPHABETIC. YES  */ 00648000
         LA    R6,ALPHABET                                         0235 00649000
*     DO I=26 TO 1 BY-1;            /* CONTINUE TO DECODE. NO,SET    */ 00650000
         LA    I,26                                                0236 00651000
@DL00236 DS    0H                                                  0237 00652000
*       IF INPUTBUF(J)=LETTER THEN  /* ERROR CODE -07- AND           */ 00653000
         LH    @15,J                                               0237 00654000
         ALR   @15,R5                                              0237 00655000
         BCTR  @15,0                                               0237 00656000
         CLC   INPUTBUF(1,@15),LETTER(R6)                          0237 00657000
         BE    @RT00237                                            0237 00658000
*         GO TO CECTST28;           /* PRINT ERROR MESSAGE           */ 00659000
*       R6=R6+1;                    /* IFD112I                       */ 00660000
         AL    R6,@CF00072                                         0239 00661000
*     END;                                                         0240 00662000
         BCTR  I,0                                                 0240 00663000
         LTR   I,I                                                 0240 00664000
         BP    @DL00236                                            0240 00665000
*     R5=R5+J-1;                    /* PT TO ERROR                   */ 00666000
         LR    @15,R5                                              0241 00667000
         AH    @15,J                                               0241 00668000
         BCTR  @15,0                                               0241 00669000
         LR    R5,@15                                              0241 00670000
*     GOTO CECTST03;                                               0242 00671000
         B     CECTST03                                            0242 00672000
*CECTST28:                                                         0243 00673000
*   END;                                                           0243 00674000
CECTST28 LA    @15,1                                               0243 00675000
         AH    @15,J                                               0243 00676000
         STH   @15,J                                               0243 00677000
         C     @15,@CF00081                                        0243 00678000
         BNH   @DL00234                                            0243 00679000
*   GO TO CECTST26;                 /* GO TO ROUTINE FOR INCLUSIVE   */ 00680000
*                                                                  0244 00681000
         B     CECTST26                                            0244 00682000
*   /*****************************************************************/ 00683000
*   /*                                                               */ 00684000
*   /* SECTIONS OF LENGTH THREE.                                     */ 00685000
*   /*                                                               */ 00686000
*   /*****************************************************************/ 00687000
*                                                                  0245 00688000
*CECTST29:                          /* CHECK FOR INCL RNG DONE       */ 00689000
*   IF FSTSEC=LSTSEC&               /* ARE SECTS NOW EQUAL           */ 00690000
*       DASH='1'B THEN              /* +IS THIS AN INCL RANGE        */ 00691000
CECTST29 CLC   FSTSEC(3),LSTSEC                                    0245 00692000
         BNE   @RF00245                                            0245 00693000
         TM    DASH,B'00000001'                                    0245 00694000
         BNO   @RF00245                                            0245 00695000
*     DO;                           /* YES                           */ 00696000
*CECTST2B:                          /* SET UP FOR NEXT ENTRY         */ 00697000
*       R5=R5-1;                    /* UPDATE INPUT PTR              */ 00698000
CECTST2B BCTR  R5,0                                                0247 00699000
*       GO TO CECTST03;             /* PROCESS NEXT ENTRY            */ 00700000
         B     CECTST03                                            0248 00701000
*     END;                                                         0249 00702000
*CECTST2A:                                                         0250 00703000
*                                                                  0250 00704000
*   /*****************************************************************/ 00705000
*   /*                                                               */ 00706000
*   /* ROUTINE FOR BUILDING SECLST                                   */ 00707000
*   /*                                                               */ 00708000
*   /*****************************************************************/ 00709000
*                                                                  0250 00710000
*   IF FSTSEC>LSTSEC THEN           /* IS INCLUSIVE RANGE VALID.     */ 00711000
@RF00245 DS    0H                                                  0250 00712000
CECTST2A CLC   FSTSEC(3),LSTSEC                                    0250 00713000
         BH    @RT00250                                            0250 00714000
*     GOTO CECTST2B;                                               0251 00715000
*                                                                  0251 00716000
*   /*****************************************************************/ 00717000
*   /*                                                               */ 00718000
*   /* IFD112I WITH ERROR CODE 07.                                   */ 00719000
*   /*                                                               */ 00720000
*   /*****************************************************************/ 00721000
*                                                                  0252 00722000
*   IF SECCNTR=26 THEN              /* IS SECTION COUNTER 26. YES,   */ 00723000
         CLC   SECCNTR(4),@CF00493                                 0252 00724000
         BE    @RT00252                                            0252 00725000
*     GO TO CECTST06;               /* FIND SLASH AND PRINT          */ 00726000
*                                                                  0253 00727000
*   /*****************************************************************/ 00728000
*   /*                                                               */ 00729000
*   /* MESSAGE INDICATING MORE THAN 26 SECTIONS SPECIFIED            */ 00730000
*   /*                                                               */ 00731000
*   /*****************************************************************/ 00732000
*                                                                  0254 00733000
*   TSTFLG=TSTFLG&&TSTFLG;          /* INIT FLAG                     */ 00734000
         XC    TSTFLG(1,R8),TSTFLG(R8)                             0254 00735000
*   IF SECT1='1'B THEN              /* PUT SECTION NAME IN SECLST.   */ 00736000
         TM    SECT1,B'10000000'                                   0255 00737000
         BNO   @RF00255                                            0255 00738000
*     TSTSCTN1=FSTSEC2;                                            0256 00739000
         MVC   TSTSCTN1(1,R8),FSTSEC2                              0256 00740000
*   IF SECT2='1'B THEN                                             0257 00741000
@RF00255 TM    SECT2,B'01000000'                                   0257 00742000
         BNO   @RF00257                                            0257 00743000
*     TSTSCTN2=FSTSEC1;                                            0258 00744000
         MVC   TSTSCTN2(2,R8),FSTSEC1                              0258 00745000
*   IF SECT3='1'B THEN                                             0259 00746000
@RF00257 TM    SECT3,B'00100000'                                   0259 00747000
         BNO   @RF00259                                            0259 00748000
*     TSTSCTN3=FSTSEC;                                             0260 00749000
         MVC   TSTSCTN3(3,R8),FSTSEC                               0260 00750000
*   SECCNTR=SECCNTR+1;              /* INCREMENT SECTION COUNTER     */ 00751000
@RF00259 LA    @15,1                                               0261 00752000
         AL    @15,SECCNTR                                         0261 00753000
         ST    @15,SECCNTR                                         0261 00754000
*   R8=R8+4;                        /* UPDATE SECLST POINTER.        */ 00755000
         AL    R8,@CF00068                                         0262 00756000
*   IF LSTSEC=FSTSEC THEN           /* HAS THIS BEEN FULLY DECODED   */ 00757000
         CLC   LSTSEC(3),FSTSEC                                    0263 00758000
         BE    @RT00263                                            0263 00759000
*     GO TO CECTST34;               /* YES, CONTINUE TO DECODE       */ 00760000
*   IF SECT1¬='1'B THEN             /* DOES THE SECTION NAME HAVE    */ 00761000
         TM    SECT1,B'10000000'                                   0265 00762000
         BNO   @RT00265                                            0265 00763000
*     GO TO CECTST31;               /* LENGTH ONE. NO, FIND HOW      */ 00764000
*                                                                  0266 00765000
*   /*****************************************************************/ 00766000
*   /*                                                               */ 00767000
*   /* LONG IT IS.                                                   */ 00768000
*   /*                                                               */ 00769000
*   /*****************************************************************/ 00770000
*                                                                  0267 00771000
*   IF FSTSEC2='Z' THEN             /* YES, SEE IF AN UPDATE MUST    */ 00772000
         CLI   FSTSEC2,C'Z'                                        0267 00773000
         BNE   @RF00267                                            0267 00774000
*     DO;                           /* OCCUR. YES, PERFORM UPDATE    */ 00775000
*       SECTIONS='010'B;            /* NO, CONTINUE.                 */ 00776000
         NI    SECTIONS,B'01011111'                                0269 00777000
         OI    SECTIONS,B'01000000'                                0269 00778000
*       FSTSEC=' AA';                                              0270 00779000
         MVC   FSTSEC(3),@CC00808                                  0270 00780000
*       LET1PTR=ADDR(ALPHABET);                                    0271 00781000
         LA    @15,ALPHABET                                        0271 00782000
         ST    @15,LET1PTR                                         0271 00783000
*       LET2PTR=LET1PTR;                                           0272 00784000
         ST    @15,LET2PTR                                         0272 00785000
*       GO TO CECTST2A;                                            0273 00786000
         B     CECTST2A                                            0273 00787000
*     END;                                                         0274 00788000
*CECTST30:                          /* UPDATE POINTER TO LAST LETTER    00789000
*                                      IN SECTION NAME               */ 00790000
*   R6=LET1PTR+1;                   /* UPDATE POINTER TO POINT TO    */ 00791000
@RF00267 DS    0H                                                  0275 00792000
CECTST30 LA    R6,1                                                0275 00793000
         AL    R6,LET1PTR                                          0275 00794000
*   FSTSEC2=LETTER;                 /* NEXT LETTER IN ALPHABET AND   */ 00795000
         MVC   FSTSEC2(1),LETTER(R6)                               0276 00796000
*   LET1PTR=R6;                     /* UPDATE FIRST SECTION TO       */ 00797000
         ST    R6,LET1PTR                                          0277 00798000
*   GO TO CECTST2A;                 /* REFLECT CHANGE AND CONTINUE   */ 00799000
         B     CECTST2A                                            0278 00800000
*CECTST31:                          /* UPDATE POINTERS TO SHOW     0279 00801000
*                                      SECTION HAS REACHED LENGTH  0279 00802000
*                                      THREE                         */ 00803000
*   IF SECT2¬='1'B THEN             /* DOES SECTION NAME HAVE        */ 00804000
CECTST31 TM    SECT2,B'01000000'                                   0279 00805000
         BNO   @RT00279                                            0279 00806000
*     GO TO CECTST33;               /* LENGTH ONE. NO, FIND          */ 00807000
*                                                                  0280 00808000
*   /*****************************************************************/ 00809000
*   /*                                                               */ 00810000
*   /* HOW LONG IT IS.                                               */ 00811000
*   /*                                                               */ 00812000
*   /*****************************************************************/ 00813000
*                                                                  0281 00814000
*   IF FSTSEC2¬='Z' THEN            /* YES, SEE IF LAST LETTER OF  0281 00815000
*                                      NAME                          */ 00816000
         CLI   FSTSEC2,C'Z'                                        0281 00817000
         BNE   @RT00281                                            0281 00818000
*     GO TO CECTST30;               /* IS A Z. NO,GO TO ROUTINE THAT */ 00819000
*                                                                  0282 00820000
*   /*****************************************************************/ 00821000
*   /*                                                               */ 00822000
*   /* PERFORMS UPDATE OF LAST LETTER                                */ 00823000
*   /*                                                               */ 00824000
*   /*****************************************************************/ 00825000
*                                                                  0283 00826000
*   IF FSTSEC(2)='Z' THEN           /* YES, SEE IF MIDDLE LETTER OF  */ 00827000
         CLI   FSTSEC+1,C'Z'                                       0283 00828000
         BNE   @RF00283                                            0283 00829000
*     DO;                           /* NAME IS A Z. YES,PERFORM    0284 00830000
*                                      UPDATE                        */ 00831000
*       SECTIONS='001'B;            /* TO SECTION OF LENGTH THREE. 0285 00832000
*                                      NO,                           */ 00833000
         NI    SECTIONS,B'00111111'                                0285 00834000
         OI    SECTIONS,B'00100000'                                0285 00835000
*       FSTSEC='AAA';               /* PERFORM REGULAR UPDATE FOR    */ 00836000
         MVC   FSTSEC(3),@CC00813                                  0286 00837000
*       LET1PTR=ADDR(ALPHABET);     /* MIDDLE LETTER OF SECTION NAME */ 00838000
         LA    @15,ALPHABET                                        0287 00839000
         ST    @15,LET1PTR                                         0287 00840000
*       LET2PTR=LET1PTR;                                           0288 00841000
         ST    @15,LET2PTR                                         0288 00842000
*       LET3PTR=LET1PTR;                                           0289 00843000
         ST    @15,LET3PTR                                         0289 00844000
*       GO TO CECTST2A;                                            0290 00845000
         B     CECTST2A                                            0290 00846000
*     END;                                                         0291 00847000
*CECTST32:                          /* UPDATE POINTER TO MIDDLE OR 0292 00848000
*                                      FIRST LETTER IN SECTION NAME  */ 00849000
*   R6=LET2PTR+1;                   /* PERFORM UPDATE FOR MIDDLE     */ 00850000
@RF00283 DS    0H                                                  0292 00851000
CECTST32 LA    R6,1                                                0292 00852000
         AL    R6,LET2PTR                                          0292 00853000
*   FSTSEC(2)=LETTER;               /* LETTER OF SECTION NAME        */ 00854000
         MVC   FSTSEC+1(1),LETTER(R6)                              0293 00855000
*   LET2PTR=R6;                                                    0294 00856000
         ST    R6,LET2PTR                                          0294 00857000
*   FSTSEC2='A';                                                   0295 00858000
         MVI   FSTSEC2,C'A'                                        0295 00859000
*   LET1PTR=ADDR(ALPHABET);                                        0296 00860000
         LA    @15,ALPHABET                                        0296 00861000
         ST    @15,LET1PTR                                         0296 00862000
*   GO TO CECTST2A;                 /* CONTINUE                      */ 00863000
         B     CECTST2A                                            0297 00864000
*CECTST33:                          /* UPDATE POINTERS FOR FIRST   0298 00865000
*                                      LETTER OF SECTION LENGTH THREE*/ 00866000
*   IF FSTSEC2¬='Z' THEN            /* TRIPLE LETTER SECTION. IS LAST*/ 00867000
CECTST33 CLI   FSTSEC2,C'Z'                                        0298 00868000
         BNE   @RT00298                                            0298 00869000
*     GO TO CECTST30;               /* LETTER IN NAME A Z. NO,     0299 00870000
*                                      PERFORM                       */ 00871000
*                                                                  0299 00872000
*   /*****************************************************************/ 00873000
*   /*                                                               */ 00874000
*   /* NORMAL UPDATE FOR LAST LETTER IN TEST SECTION NAME            */ 00875000
*   /*                                                               */ 00876000
*   /*****************************************************************/ 00877000
*                                                                  0300 00878000
*   IF FSTSEC(2)¬='Z' THEN          /* IS MIDDLE LETTER IN NAME A Z  */ 00879000
         CLI   FSTSEC+1,C'Z'                                       0300 00880000
         BNE   @RT00300                                            0300 00881000
*     GO TO CECTST32;               /* NO, PERFORM NORMAL UPDATE FOR */ 00882000
*                                                                  0301 00883000
*   /*****************************************************************/ 00884000
*   /*                                                               */ 00885000
*   /* MIDDLE LETTER IN SECTION NAME                                 */ 00886000
*   /*                                                               */ 00887000
*   /*****************************************************************/ 00888000
*                                                                  0302 00889000
*   IF FSTSEC(1)='Z' THEN           /* IF FIRST LETTER IN TRIPLE     */ 00890000
         CLI   FSTSEC,C'Z'                                         0302 00891000
         BE    @RT00302                                            0302 00892000
*     GOTO CECTST03;                                               0303 00893000
*                                                                  0303 00894000
*   /*****************************************************************/ 00895000
*   /*                                                               */ 00896000
*   /* SET ERROR CODE -07- AND PRINT ERROR MESSAGE IFD112I           */ 00897000
*   /*                                                               */ 00898000
*   /*****************************************************************/ 00899000
*                                                                  0304 00900000
*   R6=LET3PTR+1;                   /* NO, PERFORM NORMAL UPDATE     */ 00901000
         LA    R6,1                                                0304 00902000
         AL    R6,LET3PTR                                          0304 00903000
*   FSTSEC(1)=LETTER;               /* FOR FIRST LETTER OF TRIPLE    */ 00904000
         MVC   FSTSEC(1),LETTER(R6)                                0305 00905000
*   LET3PTR=R6;                     /* SECTION NAME                  */ 00906000
         ST    R6,LET3PTR                                          0306 00907000
*   FSTSEC1='AA';                                                  0307 00908000
         MVC   FSTSEC1(2),@CC00818                                 0307 00909000
*   LET1PTR=ADDR(ALPHABET);                                        0308 00910000
         LA    @15,ALPHABET                                        0308 00911000
         ST    @15,LET1PTR                                         0308 00912000
*   LET2PTR=LET1PTR;                                               0309 00913000
         ST    @15,LET2PTR                                         0309 00914000
*   GO TO CECTST2A;                 /* CONTINUE                      */ 00915000
         B     CECTST2A                                            0310 00916000
*CECTST34:                                                         0311 00917000
*                                                                  0311 00918000
*   /*****************************************************************/ 00919000
*   /*                                                               */ 00920000
*   /* DECODE THE DELIMITERS                                         */ 00921000
*   /*                                                               */ 00922000
*   /*****************************************************************/ 00923000
*                                                                  0311 00924000
*   IF INPUTBUF(1)='/' THEN         /* IS CHAR. IN INBUFR+0 A        */ 00925000
CECTST34 CLI   INPUTBUF(R5),C'/'                                   0311 00926000
         BE    @RT00311                                            0311 00927000
*     GO TO CECTST99;               /* SLASH. YES, CONTINUE TO       */ 00928000
*   IF INPUTBUF(1)¬=',' THEN        /* DECODE. NO, IS THE CHAR.      */ 00929000
         CLI   INPUTBUF(R5),C','                                   0313 00930000
         BNE   @RT00313                                            0313 00931000
*     GOTO CECTST03;                                               0314 00932000
*   DASH='0'B;                      /* INIT INT FLAG FOR RANGE       */ 00933000
         NI    DASH,B'11111110'                                    0315 00934000
*   R6=ADDR(NUMBERS);               /* PTR TO NUM BUFFER             */ 00935000
         LA    R6,NUMBERS                                          0316 00936000
*   DO I=10 TO 1 BY-1;              /* INBUFR+1 NUMERIC. YES,        */ 00937000
         LA    I,10                                                0317 00938000
@DL00317 DS    0H                                                  0318 00939000
*     IF INPUTBUF(2)=NUMBER THEN    /* STOP LOOKING FOR TEST         */ 00940000
         CLC   INPUTBUF+1(1,R5),NUMBER(R6)                         0318 00941000
         BNE   @RF00318                                            0318 00942000
*       DO;                                                        0319 00943000
*                                                                  0319 00944000
*         /***********************************************************/ 00945000
*         /*                                                         */ 00946000
*         /* SCAN TST FIELD FOR LEADING ZERO ENTRIES                 */ 00947000
*         /*                                                         */ 00948000
*         /***********************************************************/ 00949000
*                                                                  0320 00950000
*         N=1;                      /* INIT PTR                      */ 00951000
         MVC   N(2),@CH00072                                       0320 00952000
*CECTST36:                                                         0321 00953000
*         IF INPUTBUF(N)=','|       /* NEW                           */ 00954000
*             INPUTBUF(N)='-' THEN  /* ENTRY                         */ 00955000
CECTST36 LH    @15,N                                               0321 00956000
         ALR   @15,R5                                              0321 00957000
         BCTR  @15,0                                               0321 00958000
         CLI   INPUTBUF(@15),C','                                  0321 00959000
         BE    @RT00321                                            0321 00960000
         LH    @15,N                                               0321 00961000
         ALR   @15,R5                                              0321 00962000
         BCTR  @15,0                                               0321 00963000
         CLI   INPUTBUF(@15),C'-'                                  0321 00964000
         BNE   @RF00321                                            0321 00965000
@RT00321 DS    0H                                                  0322 00966000
*           DO;                     /* YES,SCAN FOR ZERO'S           */ 00967000
*             N=N+1;                /* INCR PTR TO NUM               */ 00968000
         LA    @15,1                                               0323 00969000
         AH    @15,N                                               0323 00970000
         STH   @15,N                                               0323 00971000
*             IF INPUTBUF(N)='0' THEN/* IS CHAR=0                    */ 00972000
         ALR   @15,R5                                              0324 00973000
         BCTR  @15,0                                               0324 00974000
         CLI   INPUTBUF(@15),C'0'                                  0324 00975000
         BNE   @RF00324                                            0324 00976000
*               DO;                 /* YES,ERROR                     */ 00977000
*                 R5=R5+N-1;        /* POINT TO ERROR                */ 00978000
         LH    @15,N                                               0326 00979000
         ALR   @15,R5                                              0326 00980000
         BCTR  @15,0                                               0326 00981000
         LR    R5,@15                                              0326 00982000
*                 GO TO CECTST03;   /* ISSUE ERROR MSG               */ 00983000
         B     CECTST03                                            0327 00984000
*               END;                                               0328 00985000
*           END;                                                   0329 00986000
@RF00324 DS    0H                                                  0330 00987000
*         IF INPUTBUF(N)='/' THEN   /* END OF TEST FIELD             */ 00988000
@RF00321 LH    @15,N                                               0330 00989000
         ALR   @15,R5                                              0330 00990000
         BCTR  @15,0                                               0330 00991000
         CLI   INPUTBUF(@15),C'/'                                  0330 00992000
         BE    @RT00330                                            0330 00993000
*           GO TO CECTST37;         /* YES,DECODE ROUTINES           */ 00994000
*         N=N+1;                    /* POINT TO NEXT CHAR            */ 00995000
         LH    @15,N                                               0332 00996000
         LA    @15,1(,@15)                                         0332 00997000
         STH   @15,N                                               0332 00998000
*         GO TO CECTST36;           /* CONTINUE SCANING              */ 00999000
         B     CECTST36                                            0333 01000000
*CECTST37:                                                         0334 01001000
*         R5=R5+1;                  /* POINT TO NEXT ENTRY           */ 01002000
CECTST37 AL    R5,@CF00072                                         0334 01003000
*         GO TO CECTST38;           /* SECTIONS. NO,CONTINUE TO      */ 01004000
         B     CECTST38                                            0335 01005000
*       END;                                                       0336 01006000
*     R6=R6+1;                      /* DECODE                        */ 01007000
@RF00318 AL    R6,@CF00072                                         0337 01008000
*   END;                                                           0338 01009000
         BCTR  I,0                                                 0338 01010000
         LTR   I,I                                                 0338 01011000
         BP    @DL00317                                            0338 01012000
*   R5=R5+1;                        /* POINT TO NEXT ENTRY           */ 01013000
         AL    R5,@CF00072                                         0339 01014000
*   GO TO CECTST14;                 /* DECODE NEXT SECTION           */ 01015000
         B     CECTST14                                            0340 01016000
*CECTST38:                                                         0341 01017000
*                                                                  0341 01018000
*   /*****************************************************************/ 01019000
*   /*                                                               */ 01020000
*   /* DECODE ROUTINES SELECTED                                      */ 01021000
*   /*                                                               */ 01022000
*   /*****************************************************************/ 01023000
*                                                                  0341 01024000
*   IF SECCNTR¬=1 THEN                                             0341 01025000
CECTST38 CLC   SECCNTR(4),@CF00072                                 0341 01026000
         BNE   @RT00341                                            0341 01027000
*     GOTO CECTST03;                                               0342 01028000
*   FRSTRTN=FRSTRTN&&FRSTRTN;       /* CLEAR AREA SET ASIDE FOR      */ 01029000
         XC    FRSTRTN(4),FRSTRTN                                  0343 01030000
*CECTST39:                          /* IS DOUBLE NUMBER ROUTINE    0344 01031000
*                                      SELECTED                      */ 01032000
*   DUBNUM='1'B;                    /* SET DOUBLE NUMBER INDICATOR   */ 01033000
CECTST39 OI    DUBNUM,B'00001000'                                  0344 01034000
*   R6=ADDR(NUMBERS);               /* IS THE CHAR. IN INBUFR+1      */ 01035000
         LA    R6,NUMBERS                                          0345 01036000
*   DO I=10 TO 1 BY-1;              /* NUMERIC. YES, CONTINUE TO     */ 01037000
         LA    I,10                                                0346 01038000
@DL00346 DS    0H                                                  0347 01039000
*     IF INPUTBUF(2)=NUMBER THEN    /* DECODE. NO, CLEAR DOUBLE      */ 01040000
         CLC   INPUTBUF+1(1,R5),NUMBER(R6)                         0347 01041000
         BE    @RT00347                                            0347 01042000
*       GO TO CECTST40;             /* NUMBER INDICATOR AND GO       */ 01043000
*     R6=R6+1;                      /* TO ROUTINE WHICH SETS THE     */ 01044000
         AL    R6,@CF00072                                         0349 01045000
*   END;                            /* SCT ROUTINE FLAGS             */ 01046000
         BCTR  I,0                                                 0350 01047000
         LTR   I,I                                                 0350 01048000
         BP    @DL00346                                            0350 01049000
*   DUBNUM='0'B;                                                   0351 01050000
         NI    DUBNUM,B'11110111'                                  0351 01051000
*   GO TO CECTST42;                                                0352 01052000
         B     CECTST42                                            0352 01053000
*CECTST40:                          /* IS TRIPLE NUMBER ROUTINE    0353 01054000
*                                      SELECTED                      */ 01055000
*   TRINUM='1'B;                    /* SET TRIPLE NUMBER INDICATOR   */ 01056000
CECTST40 OI    TRINUM,B'00000100'                                  0353 01057000
*   R6=ADDR(NUMBERS);               /* IS THE CHAR. IN INBUFR+2      */ 01058000
         LA    R6,NUMBERS                                          0354 01059000
*   DO I=10 TO 1 BY-1;              /* NUMERIC. YES, CONTINUE TO     */ 01060000
         LA    I,10                                                0355 01061000
@DL00355 DS    0H                                                  0356 01062000
*     IF INPUTBUF(3)=NUMBER THEN    /* DECODE. NO, CLEAR TRIPLE      */ 01063000
         CLC   INPUTBUF+2(1,R5),NUMBER(R6)                         0356 01064000
         BE    @RT00356                                            0356 01065000
*       GO TO CECTST41;             /* NUMBER INDICATOR.             */ 01066000
*     R6=R6+1;                                                     0358 01067000
         AL    R6,@CF00072                                         0358 01068000
*   END;                                                           0359 01069000
         BCTR  I,0                                                 0359 01070000
         LTR   I,I                                                 0359 01071000
         BP    @DL00355                                            0359 01072000
*   TRINUM='0'B;                                                   0360 01073000
         NI    TRINUM,B'11111011'                                  0360 01074000
*   GO TO CECTST42;                 /* BYPASS CLEARING DOUBLE        */ 01075000
*                                                                  0361 01076000
         B     CECTST42                                            0361 01077000
*   /*****************************************************************/ 01078000
*   /*                                                               */ 01079000
*   /* NUMBER ROUTINE INDICATOR.                                     */ 01080000
*   /*                                                               */ 01081000
*   /*****************************************************************/ 01082000
*                                                                  0362 01083000
*CECTST41:                          /* CLEAR DOUBLE NUMBER INDICATOR */ 01084000
*   DUBNUM='0'B;                    /* CLEAR DOUBLE NUMBER INDICATOR */ 01085000
CECTST41 NI    DUBNUM,B'11110111'                                  0362 01086000
*CECTST42:                          /* DETERMINE WHICH TYPE OF     0363 01087000
*                                      ROUTINE SELECTED              */ 01088000
*   $RTNSLCT='1'B;                                                 0363 01089000
CECTST42 OI    $RTNSLCT(WAPTR),B'00100000'                         0363 01090000
*   IF DUBNUM='1'B THEN             /* HAS A DOUBLE NUMBER ROUTINE   */ 01091000
         TM    DUBNUM,B'00001000'                                  0364 01092000
         BO    @RT00364                                            0364 01093000
*     GO TO CECTST43;               /* BEEN ENTERED. YES, GO TO      */ 01094000
*                                                                  0365 01095000
*   /*****************************************************************/ 01096000
*   /*                                                               */ 01097000
*   /* DOUBLE NUMBER ROUTINE                                         */ 01098000
*   /*                                                               */ 01099000
*   /*****************************************************************/ 01100000
*                                                                  0366 01101000
*   IF TRINUM='1'B THEN             /* HAS A TRIPLE NUMBER ROUTINE   */ 01102000
         TM    TRINUM,B'00000100'                                  0366 01103000
         BO    @RT00366                                            0366 01104000
*     GO TO CECTST59;               /* BEEN ENTERED. YES, GO TO      */ 01105000
*                                                                  0367 01106000
*   /*****************************************************************/ 01107000
*   /*                                                               */ 01108000
*   /* TRIPLE NUMBER ROUTINE                                         */ 01109000
*   /*                                                               */ 01110000
*   /*****************************************************************/ 01111000
*                                                                  0368 01112000
*   GO TO CECTST64;                 /* GO TO SINGLE NUMBER ROUTINE   */ 01113000
         B     CECTST64                                            0368 01114000
*CECTST43:                          /* ROUTINE TO HANDLE DOUBLE    0369 01115000
*                                      NUMBER ROUTINE SELECTED       */ 01116000
*   FRSTRTN2=INPUTBUF(1:2);         /* CONVERT DOUBLE NUMBER         */ 01117000
CECTST43 MVC   FRSTRTN2(2),INPUTBUF(R5)                            0369 01118000
*   GEN;                                                           0370 01119000
*                                  /* ROUTINE TO BINARY     */          01120000
         PACK  DOUBLEWD(8),FRSTRTN(4)                                   01121000
         CVB   FSTRTN,DOUBLEWD                                          01122000
*   R5=R5+2;                        /* INCREMENT INBUFR POINTER      */ 01123000
         AL    R5,@CF00139                                         0371 01124000
*   DUBNUM='0'B;                    /* RESET DOUBLE NUMBER INDICATOR */ 01125000
         NI    DUBNUM,B'11110111'                                  0372 01126000
*   IF FSTRTN>16 THEN               /* IS FIRST ROUTINE > 16. YES, GO*/ 01127000
         C     FSTRTN,@CF00061                                     0373 01128000
         BH    @RT00373                                            0373 01129000
*     GO TO CECTST50;               /* TO ROUTINE FOR ROUTINES > 16. */ 01130000
*   IF INPUTBUF(1)¬='-' THEN        /* IS CHAR. IN INBUFR+0 A HYPHEN.*/ 01131000
         CLI   INPUTBUF(R5),C'-'                                   0375 01132000
         BNE   @RT00375                                            0375 01133000
*     GO TO CECTST46;               /* NO, CONTINUE BY FINDING OUT   */ 01134000
*                                                                  0376 01135000
*   /*****************************************************************/ 01136000
*   /*                                                               */ 01137000
*   /* WHAT IT IS                                                    */ 01138000
*   /*                                                               */ 01139000
*   /*****************************************************************/ 01140000
*                                                                  0377 01141000
*   R5=R5+1;                        /* INCREMENT INBUFR POINTER      */ 01142000
         LA    @15,1                                               0377 01143000
         ALR   R5,@15                                              0377 01144000
*   DO J=1 TO 2;                    /* ARE THE CHAR. IN INBUFR+0 AND */ 01145000
         STH   @15,J                                               0378 01146000
@DL00378 DS    0H                                                  0379 01147000
*     R6=ADDR(NUMBERS);             /* INBUFR+1 NUMERIC. YES,      0379 01148000
*                                      CONTINUE                      */ 01149000
         LA    R6,NUMBERS                                          0379 01150000
*     DO I=10 TO 1 BY-1;            /* TO DECODE. NO, SET ERROR CODE */ 01151000
         LA    I,10                                                0380 01152000
@DL00380 DS    0H                                                  0381 01153000
*       IF INPUTBUF(J)=NUMBER THEN  /* -10- AND PRINT ERROR MESSAGE  */ 01154000
         LH    @15,J                                               0381 01155000
         ALR   @15,R5                                              0381 01156000
         BCTR  @15,0                                               0381 01157000
         CLC   INPUTBUF(1,@15),NUMBER(R6)                          0381 01158000
         BE    @RT00381                                            0381 01159000
*         GO TO CECTST45;           /* IFD112I                       */ 01160000
*       R6=R6+1;                                                   0383 01161000
         AL    R6,@CF00072                                         0383 01162000
*     END;                                                         0384 01163000
         BCTR  I,0                                                 0384 01164000
         LTR   I,I                                                 0384 01165000
         BP    @DL00380                                            0384 01166000
*CECTST44:                                                         0385 01167000
*                                                                  0385 01168000
*     /***************************************************************/ 01169000
*     /*                                                             */ 01170000
*     /* ERROR, INVALID INCLUSIVE RANGE OF ROUTINES                  */ 01171000
*     /*                                                             */ 01172000
*     /***************************************************************/ 01173000
*                                                                  0385 01174000
*     R5=R5+J-1;                    /* PT TO ERROR                   */ 01175000
CECTST44 LR    @15,R5                                              0385 01176000
         AH    @15,J                                               0385 01177000
         BCTR  @15,0                                               0385 01178000
         LR    R5,@15                                              0385 01179000
*     GO TO CECTST03;                                              0386 01180000
         B     CECTST03                                            0386 01181000
*CECTST45:                                                         0387 01182000
*   END;                                                           0387 01183000
CECTST45 LA    @15,1                                               0387 01184000
         AH    @15,J                                               0387 01185000
         STH   @15,J                                               0387 01186000
         C     @15,@CF00139                                        0387 01187000
         BNH   @DL00378                                            0387 01188000
*   R6=ADDR(NUMBERS);               /* IS THE CHAR. IN INBUFR+2      */ 01189000
         LA    R6,NUMBERS                                          0388 01190000
*   DO I=10 TO 1 BY-1;              /* NUMERIC. YES, GO TO ROUTINE   */ 01191000
         LA    I,10                                                0389 01192000
@DL00389 DS    0H                                                  0390 01193000
*     IF INPUTBUF(3)=NUMBER THEN    /* THAT CONVERTS TRIPLE          */ 01194000
         CLC   INPUTBUF+2(1,R5),NUMBER(R6)                         0390 01195000
         BE    @RT00390                                            0390 01196000
*       GO TO CECTST75;             /* NUMBER FOR LAST ROUTINE IN    */ 01197000
*     R6=R6+1;                      /* AN INCLUSIVE SERIES OF        */ 01198000
         AL    R6,@CF00072                                         0392 01199000
*   END;                            /* ROUTINES. NO, GO TO ROUTINE   */ 01200000
         BCTR  I,0                                                 0393 01201000
         LTR   I,I                                                 0393 01202000
         BP    @DL00389                                            0393 01203000
*   GO TO CECTST73;                 /* THAT CONVERTS DOUBLE NUMBER   */ 01204000
*                                                                  0394 01205000
         B     CECTST73                                            0394 01206000
*   /*****************************************************************/ 01207000
*   /*                                                               */ 01208000
*   /* FOR LAST ROUTINE IN AN INCLUSIVE SERIES OF ROUTINES           */ 01209000
*   /*                                                               */ 01210000
*   /*****************************************************************/ 01211000
*                                                                  0395 01212000
*CECTST46:                          /* FIRST ROUTINE EQUALS LAST   0395 01213000
*                                      ROUTINE.                      */ 01214000
*                                                                  0395 01215000
*   /*****************************************************************/ 01216000
*   /*                                                               */ 01217000
*   /* NORMAL ROUTINE SELECTION FIELD.                               */ 01218000
*   /*                                                               */ 01219000
*   /*****************************************************************/ 01220000
*                                                                  0395 01221000
*   LSTRTN=FSTRTN;                  /* SET LAST ROUTINE EQUAL TO   0395 01222000
*                                      FIRST                         */ 01223000
CECTST46 LR    LSTRTN,FSTRTN                                       0395 01224000
*   CALL CECTST80;                  /* ROUTINE AND GO TO SUB-ROUTINE */ 01225000
*                                                                  0396 01226000
         BAL   @14,CECTST80                                        0396 01227000
*   /*****************************************************************/ 01228000
*   /*                                                               */ 01229000
*   /* THAT SETS ROUTINE FLAGS IN THE NORMAL ROUTINE AREA            */ 01230000
*   /*                                                               */ 01231000
*   /*****************************************************************/ 01232000
*                                                                  0397 01233000
*   GO TO CECTST58;                 /* CONTINUE TO DECODE.           */ 01234000
         B     CECTST58                                            0397 01235000
*CECTST50:                          /* ROUTINE FOR HANDLING ROUTINES    01236000
*                                      IN                            */ 01237000
*                                                                  0398 01238000
*   /*****************************************************************/ 01239000
*   /*                                                               */ 01240000
*   /* EXPANDED ROUTINE SELECTION FIELD.                             */ 01241000
*   /*                                                               */ 01242000
*   /*****************************************************************/ 01243000
*                                                                  0398 01244000
*   IF INPUTBUF(1)¬='-' THEN        /* IS CHAR. IN INBUFR+0 A HYPHEN.*/ 01245000
CECTST50 CLI   INPUTBUF(R5),C'-'                                   0398 01246000
         BNE   @RT00398                                            0398 01247000
*     GO TO CECTST53;               /* NO, FIND OUT WHAT IT IS       */ 01248000
*   R5=R5+1;                        /* YES, INCREMENT INBUFR POINTER */ 01249000
         LA    @15,1                                               0400 01250000
         ALR   R5,@15                                              0400 01251000
*   DO J=1 TO 2;                    /* ARE THE CHAR. IN INBUFR AND   */ 01252000
         STH   @15,J                                               0401 01253000
@DL00401 DS    0H                                                  0402 01254000
*     R6=ADDR(NUMBERS);             /* INBUFR+1 NUMERIC. NO, SET     */ 01255000
         LA    R6,NUMBERS                                          0402 01256000
*     DO I=10 TO 1 BY-1;            /* ERROR CODE -10- AND PRINT     */ 01257000
         LA    I,10                                                0403 01258000
@DL00403 DS    0H                                                  0404 01259000
*       IF INPUTBUF(J)=NUMBER THEN  /* ERROR MESSAGE IFD112I         */ 01260000
         LH    @15,J                                               0404 01261000
         ALR   @15,R5                                              0404 01262000
         BCTR  @15,0                                               0404 01263000
         CLC   INPUTBUF(1,@15),NUMBER(R6)                          0404 01264000
         BE    @RT00404                                            0404 01265000
*         GO TO CECTST51;           /* YES, CONTINUE TO DECODE       */ 01266000
*       R6=R6+1;                                                   0406 01267000
         AL    R6,@CF00072                                         0406 01268000
*     END;                                                         0407 01269000
         BCTR  I,0                                                 0407 01270000
         LTR   I,I                                                 0407 01271000
         BP    @DL00403                                            0407 01272000
*     GO TO CECTST44;                                              0408 01273000
         B     CECTST44                                            0408 01274000
*CECTST51:                                                         0409 01275000
*   END;                                                           0409 01276000
CECTST51 LA    @15,1                                               0409 01277000
         AH    @15,J                                               0409 01278000
         STH   @15,J                                               0409 01279000
         C     @15,@CF00139                                        0409 01280000
         BNH   @DL00401                                            0409 01281000
*   R6=ADDR(NUMBERS);               /* IS THE CHAR IN INBUFR+2     0410 01282000
*                                      NUMERIC                       */ 01283000
         LA    R6,NUMBERS                                          0410 01284000
*   DO I=10 TO 1 BY-1;              /* YES, GO TO ROUTINE THAT       */ 01285000
         LA    I,10                                                0411 01286000
@DL00411 DS    0H                                                  0412 01287000
*     IF INPUTBUF(3)=NUMBER THEN    /* CONVERTS A TRIPLE NUMBER FOR  */ 01288000
         CLC   INPUTBUF+2(1,R5),NUMBER(R6)                         0412 01289000
         BE    @RT00412                                            0412 01290000
*       GO TO CECTST62;             /* A LAST ROUTINE IN AN INCLUSIVE*/ 01291000
*     R6=R6+1;                      /* RANGE. NO,                    */ 01292000
         AL    R6,@CF00072                                         0414 01293000
*   END;                            /* CONVERT A DOUBLE NUMBER FOR   */ 01294000
*                                                                  0415 01295000
         BCTR  I,0                                                 0415 01296000
         LTR   I,I                                                 0415 01297000
         BP    @DL00411                                            0415 01298000
*   /*****************************************************************/ 01299000
*   /*                                                               */ 01300000
*   /* A LAST ROUTINE IN AN INCLUSIVE RANGE                          */ 01301000
*   /*                                                               */ 01302000
*   /*****************************************************************/ 01303000
*                                                                  0416 01304000
*   LASTRTN2=INPUTBUF(1:2);                                        0416 01305000
         MVC   LASTRTN2(2),INPUTBUF(R5)                            0416 01306000
*   GEN;                                                           0417 01307000
         PACK  DOUBLEWD(8),LASTRTN(4)                                   01308000
         CVB   LSTRTN,DOUBLEWD                                          01309000
*   IF LSTRTN<=FSTRTN THEN          /* IS INCLUSIVE RANGE VALID.     */ 01310000
         CR    LSTRTN,FSTRTN                                       0418 01311000
         BH    @RF00418                                            0418 01312000
*     DO;                                                          0419 01313000
*       R5=R5+1;                                                   0420 01314000
         AL    R5,@CF00072                                         0420 01315000
*       GOTO CECTST03;                                             0421 01316000
         B     CECTST03                                            0421 01317000
*     END;                                                         0422 01318000
*                                                                  0422 01319000
*   /*****************************************************************/ 01320000
*   /*                                                               */ 01321000
*   /* PRINT MESSAGE IFD112I AND RETURN TO CALLER. YES, CONTINUE.    */ 01322000
*   /*                                                               */ 01323000
*   /*****************************************************************/ 01324000
*                                                                  0423 01325000
*   R5=R5+2;                        /* INCREMENT INBUFR POINTER      */ 01326000
@RF00418 AL    R5,@CF00139                                         0423 01327000
*   CALL CECTST78;                  /* GO TO ROUTINE TO SET ROUTINE  */ 01328000
         BAL   @14,CECTST78                                        0424 01329000
*   GO TO CECTST58;                 /* FLAGS IN EXPANDED AREA OF SCT */ 01330000
*                                                                  0425 01331000
         B     CECTST58                                            0425 01332000
*   /*****************************************************************/ 01333000
*   /*                                                               */ 01334000
*   /* AND UPON RETURN CONTINUE TO DECODE                            */ 01335000
*   /*                                                               */ 01336000
*   /*****************************************************************/ 01337000
*                                                                  0426 01338000
*CECTST53:                          /* FIRST ROUTINE EQUALS LAST   0426 01339000
*                                      ROUTINE,                      */ 01340000
*                                                                  0426 01341000
*   /*****************************************************************/ 01342000
*   /*                                                               */ 01343000
*   /* EXPANDED ROUTINE SELECTION FIELD.                             */ 01344000
*   /*                                                               */ 01345000
*   /*****************************************************************/ 01346000
*                                                                  0426 01347000
*   LSTRTN=FSTRTN;                  /* SET LAST ROUTINE EQUAL TO   0426 01348000
*                                      FIRST                         */ 01349000
CECTST53 LR    LSTRTN,FSTRTN                                       0426 01350000
*   CALL CECTST78;                  /* CALL ROUTINE TO SET ROUTINE   */ 01351000
*                                                                  0427 01352000
         BAL   @14,CECTST78                                        0427 01353000
*   /*****************************************************************/ 01354000
*   /*                                                               */ 01355000
*   /* FLAGS IN EXPANDED AREA OF SCT                                 */ 01356000
*   /*                                                               */ 01357000
*   /*****************************************************************/ 01358000
*                                                                  0428 01359000
*CECTST58:                                                         0428 01360000
*                                                                  0428 01361000
*   /*****************************************************************/ 01362000
*   /*                                                               */ 01363000
*   /* DECODE DELIMITERS                                             */ 01364000
*   /*                                                               */ 01365000
*   /*****************************************************************/ 01366000
*                                                                  0428 01367000
*   IF INPUTBUF(1)¬=',' THEN        /* IS CHAR. IN INBUFR+0 A COMMA. */ 01368000
CECTST58 CLI   INPUTBUF(R5),C','                                   0428 01369000
         BNE   @RT00428                                            0428 01370000
*     GO TO CECTST55;               /* NO, FIND OUT WHAT IT IS       */ 01371000
*CECTST54:                          /* DELIMITER IS LEGAL, CONTINUE     01372000
*                                      TO DECODE                     */ 01373000
*   R5=R5+1;                        /* YES, INCREMENT INBUFR POINTER */ 01374000
CECTST54 AL    R5,@CF00072                                         0430 01375000
*   GO TO CECTST38;                 /* AND CONTINUE TO DECODE        */ 01376000
         B     CECTST38                                            0431 01377000
*CECTST55:                          /* IS THE DELIMITER A SLASH      */ 01378000
*   IF INPUTBUF(1)='/' THEN         /* IS CHAR. IN INBUFR+0 A SLASH. */ 01379000
CECTST55 CLI   INPUTBUF(R5),C'/'                                   0432 01380000
         BE    @RT00432                                            0432 01381000
*     GO TO CECTST99;               /* YES, RETURN TO CALLER. NO,    */ 01382000
*CECTST56:                                                         0434 01383000
*                                                                  0434 01384000
*   /*****************************************************************/ 01385000
*   /*                                                               */ 01386000
*   /* ERROR, ILLEGAL DELIMITER                                      */ 01387000
*   /*                                                               */ 01388000
*   /*****************************************************************/ 01389000
*                                                                  0434 01390000
*   GO TO CECTST03;                 /* PRINT ERROR MESSAGE IFD112I   */ 01391000
         B     CECTST03                                            0434 01392000
*CECTST59:                          /* ROUTINE TO HANDLE TRIPLE    0435 01393000
*                                      NUMBER ROUTINE SELECTED       */ 01394000
*   FRSTRTN1=INPUTBUF(1:3);         /* PUT TRIPLE NUMBER IN FRSTRTN  */ 01395000
CECTST59 MVC   FRSTRTN1(3),INPUTBUF(R5)                            0435 01396000
*   GEN;                                                           0436 01397000
*                                  /* AND CONVERT IT TO BINARY     */   01398000
         PACK  DOUBLEWD(8),FRSTRTN(4)                                   01399000
         CVB   FSTRTN,DOUBLEWD                                          01400000
*   TRINUM='0'B;                    /* CLEAR TRIPLE NUMBER INDICATOR */ 01401000
         NI    TRINUM,B'11111011'                                  0437 01402000
*   IF FSTRTN>255 THEN              /* IS ROUTINE NUMBER > 255. YES, */ 01403000
         C     FSTRTN,@CF00864                                     0438 01404000
         BNH   @RF00438                                            0438 01405000
*     DO;                                                          0439 01406000
*       R5=R5+2;                    /* PT TO ERROR                   */ 01407000
         AL    R5,@CF00139                                         0440 01408000
*       GOTO CECTST03;                                             0441 01409000
         B     CECTST03                                            0441 01410000
*     END;                                                         0442 01411000
*   R5=R5+3;                        /* NO, INCREMENT INBUFR POINTER  */ 01412000
@RF00438 AL    R5,@CF00081                                         0443 01413000
*   IF INPUTBUF(1)¬='-' THEN        /* IS CHAR. IN INBUFR+0 A HYPHEN.*/ 01414000
         CLI   INPUTBUF(R5),C'-'                                   0444 01415000
         BNE   @RT00444                                            0444 01416000
*     GO TO CECTST53;               /* NO, FIND OUT WHAT IT IS       */ 01417000
*   R5=R5+1;                        /* YES, INCREMENT INBUFR POINTER */ 01418000
         LA    @15,1                                               0446 01419000
         ALR   R5,@15                                              0446 01420000
*   DO J=1 TO 3;                    /* ARE THE CHAR. IN INBUFR+0,    */ 01421000
         STH   @15,J                                               0447 01422000
@DL00447 DS    0H                                                  0448 01423000
*     R6=ADDR(NUMBERS);             /* INBUFR+1 AND INBUFR+2         */ 01424000
         LA    R6,NUMBERS                                          0448 01425000
*     DO I=10 TO 1 BY-1;            /* NUMERIC. YES, CONTINUE        */ 01426000
         LA    I,10                                                0449 01427000
@DL00449 DS    0H                                                  0450 01428000
*       IF INPUTBUF(J)=NUMBER THEN  /* NO, SET ERROR CODE -10-       */ 01429000
         LH    @15,J                                               0450 01430000
         ALR   @15,R5                                              0450 01431000
         BCTR  @15,0                                               0450 01432000
         CLC   INPUTBUF(1,@15),NUMBER(R6)                          0450 01433000
         BE    @RT00450                                            0450 01434000
*         GO TO CECTST61;           /* AND PRINT ERROR MESSAGE       */ 01435000
*       R6=R6+1;                    /* IFD112I                       */ 01436000
         AL    R6,@CF00072                                         0452 01437000
*     END;                                                         0453 01438000
         BCTR  I,0                                                 0453 01439000
         LTR   I,I                                                 0453 01440000
         BP    @DL00449                                            0453 01441000
*     GO TO CECTST44;                                              0454 01442000
         B     CECTST44                                            0454 01443000
*CECTST61:                                                         0455 01444000
*   END;                                                           0455 01445000
CECTST61 LA    @15,1                                               0455 01446000
         AH    @15,J                                               0455 01447000
         STH   @15,J                                               0455 01448000
         C     @15,@CF00081                                        0455 01449000
         BNH   @DL00447                                            0455 01450000
*CECTST62:                          /* ROUTINE FOR INCLUSIVE ROUTINES   01451000
*                                      IN                            */ 01452000
*                                                                  0456 01453000
*   /*****************************************************************/ 01454000
*   /*                                                               */ 01455000
*   /* EXPANDED ROUTINE SELECTION FIELD                              */ 01456000
*   /*                                                               */ 01457000
*   /*****************************************************************/ 01458000
*                                                                  0456 01459000
*   LASTRTN1=INPUTBUF(1:3);         /* PUT TRIPLE NUMBER IN LASTRTN  */ 01460000
CECTST62 MVC   LASTRTN1(3),INPUTBUF(R5)                            0456 01461000
*   GEN;                                                           0457 01462000
*                                  /* AND CONVERT IT TO BINARY    */    01463000
         PACK  DOUBLEWD(8),LASTRTN(4)                                   01464000
         CVB   LSTRTN,DOUBLEWD                                          01465000
*   IF LSTRTN<=FSTRTN|              /* CHECK FOR INVALID             */ 01466000
*       LSTRTN>255 THEN             /* RANGE OF ROUTINES             */ 01467000
         CR    LSTRTN,FSTRTN                                       0458 01468000
         BNH   @RT00458                                            0458 01469000
         C     LSTRTN,@CF00864                                     0458 01470000
         BNH   @RF00458                                            0458 01471000
@RT00458 DS    0H                                                  0459 01472000
*     DO;                                                          0459 01473000
*       R5=R5+2;                    /* PT TO ERROR                   */ 01474000
         AL    R5,@CF00139                                         0460 01475000
*       GOTO CECTST03;                                             0461 01476000
         B     CECTST03                                            0461 01477000
*     END;                                                         0462 01478000
*   R5=R5+3;                        /* INBUFR POINTER BY THREE       */ 01479000
@RF00458 AL    R5,@CF00081                                         0463 01480000
*   CALL CECTST78;                  /* SET ROUTINE FLAGS IN EXPANDED */ 01481000
*                                                                  0464 01482000
         BAL   @14,CECTST78                                        0464 01483000
*   /*****************************************************************/ 01484000
*   /*                                                               */ 01485000
*   /* AREA                                                          */ 01486000
*   /*                                                               */ 01487000
*   /*****************************************************************/ 01488000
*                                                                  0465 01489000
*   GO TO CECTST58;                 /* CONTINUE TO DECODE.           */ 01490000
         B     CECTST58                                            0465 01491000
*CECTST64:                          /* ROUTINE TO HANDLE SINGLE    0466 01492000
*                                      NUMBER ROUTINE SELECTED       */ 01493000
*   IF INPUTBUF(1)<'1' THEN                                        0466 01494000
CECTST64 CLI   INPUTBUF(R5),C'1'                                   0466 01495000
         BL    @RT00466                                            0466 01496000
*     GO TO CECTST03;                                              0467 01497000
*   FRSTRTN3=INPUTBUF(1);           /* PUT SINGLE NUMBER IN FRSTRTN  */ 01498000
         MVC   FRSTRTN3(1),INPUTBUF(R5)                            0468 01499000
*   GEN;                                                           0469 01500000
*                                  /* AND CONVERT IT TO BINARY.      */ 01501000
         PACK  DOUBLEWD(8),LASTRTN(4)                                   01502000
         CVB   FSTRTN,DOUBLEWD                                          01503000
*   R5=R5+1;                        /* INCREMENT INBUFR POINTER      */ 01504000
         AL    R5,@CF00072                                         0470 01505000
*   IF INPUTBUF(1)='-' THEN         /* IS CHAR. IN INBUFR+0 A HYPHEN */ 01506000
         CLI   INPUTBUF(R5),C'-'                                   0471 01507000
         BE    @RT00471                                            0471 01508000
*     GO TO CECTST68;               /* YES, DECODE NUMBER THAT     0472 01509000
*                                      FOLLOWS                       */ 01510000
*   LSTRTN=FSTRTN;                  /* PUT FIRST ROUTINE IN LSTRTN   */ 01511000
         LR    LSTRTN,FSTRTN                                       0473 01512000
*   CALL CECTST80;                  /* GO TO ROUTINE THAT SETS FLAGS */ 01513000
*                                                                  0474 01514000
         BAL   @14,CECTST80                                        0474 01515000
*   /*****************************************************************/ 01516000
*   /*                                                               */ 01517000
*   /* IN NORMAL ROUTINE AREA                                        */ 01518000
*   /*                                                               */ 01519000
*   /*****************************************************************/ 01520000
*                                                                  0475 01521000
*   GO TO CECTST58;                 /* CONTINUE TO DECODE.           */ 01522000
         B     CECTST58                                            0475 01523000
*CECTST68:                          /* ROUTINE TO HANDLE INCLUSIVE 0476 01524000
*                                      ROUTINES SELECTED THAT        */ 01525000
*                                                                  0476 01526000
*   /*****************************************************************/ 01527000
*   /*                                                               */ 01528000
*   /* CARRY OVER INTO BOTH THE NORMAL AND EXPANDED ROUTINE SELECTION*/ 01529000
*   /* FIELD.                                                        */ 01530000
*   /*                                                               */ 01531000
*   /*****************************************************************/ 01532000
*                                                                  0476 01533000
*   R5=R5+1;                        /* INCREMENT INBUFR POINTER      */ 01534000
CECTST68 AL    R5,@CF00072                                         0476 01535000
*   R6=ADDR(NUMBERS);               /* IS THE CHAR. IN INBUFR NUMERIC*/ 01536000
         LA    R6,NUMBERS                                          0477 01537000
*   DO I=10 TO 1 BY-1;              /* NO, SET ERROR CODE -10- AND   */ 01538000
         LA    I,10                                                0478 01539000
@DL00478 DS    0H                                                  0479 01540000
*     IF INPUTBUF(1)=NUMBER THEN    /* PRINT ERROR MESSAGE IFD112I.  */ 01541000
         CLC   INPUTBUF(1,R5),NUMBER(R6)                           0479 01542000
         BE    @RT00479                                            0479 01543000
*       GO TO CECTST69;             /* YES, CONTINUE TO DECODE       */ 01544000
*     R6=R6+1;                                                     0481 01545000
         AL    R6,@CF00072                                         0481 01546000
*   END;                                                           0482 01547000
         BCTR  I,0                                                 0482 01548000
         LTR   I,I                                                 0482 01549000
         BP    @DL00478                                            0482 01550000
*   GOTO CECTST03;                                                 0483 01551000
         B     CECTST03                                            0483 01552000
*CECTST69:                                                         0484 01553000
*   R6=ADDR(NUMBERS);               /* IS THE CHAR. IN INBUFR+1      */ 01554000
CECTST69 LA    R6,NUMBERS                                          0484 01555000
*   DO I=10 TO 1 BY-1;              /* NUMERIC. YES, CONTINUE TO     */ 01556000
         LA    I,10                                                0485 01557000
@DL00485 DS    0H                                                  0486 01558000
*     IF INPUTBUF(2)=NUMBER THEN    /* DECODE. NO, PUT INCLUSIVE     */ 01559000
         CLC   INPUTBUF+1(1,R5),NUMBER(R6)                         0486 01560000
         BE    @RT00486                                            0486 01561000
*       GO TO CECTST72;             /* ROUTINE NUMBER IN LASTRTN     */ 01562000
*     R6=R6+1;                      /* AND CONVERT IT TO BINARY      */ 01563000
         AL    R6,@CF00072                                         0488 01564000
*   END;                                                           0489 01565000
         BCTR  I,0                                                 0489 01566000
         LTR   I,I                                                 0489 01567000
         BP    @DL00485                                            0489 01568000
*   LASTRTN3=INPUTBUF(1);           /* PUT SINGLE NUMBER IN LASTRTN  */ 01569000
         MVC   LASTRTN3(1),INPUTBUF(R5)                            0490 01570000
*   GEN;                                                           0491 01571000
*                                  /* AND CONVERT IT TO BINARY.      */ 01572000
         PACK  DOUBLEWD(8),LASTRTN(4)                                   01573000
         CVB   LSTRTN,DOUBLEWD                                          01574000
*   IF LSTRTN<=FSTRTN THEN          /* IS INCLUSIVE RANGE VALID.     */ 01575000
         CR    LSTRTN,FSTRTN                                       0492 01576000
         BNH   @RT00492                                            0492 01577000
*     GOTO CECTST03;                                               0493 01578000
*                                                                  0493 01579000
*   /*****************************************************************/ 01580000
*   /*                                                               */ 01581000
*   /* PRINT MESSAGE IFD112I AND RETURN TO CALLER. YES, CONTINUE.    */ 01582000
*   /*                                                               */ 01583000
*   /*****************************************************************/ 01584000
*                                                                  0494 01585000
*   R5=R5+1;                        /* INCREMENT INBUFR POINTER AND     01586000
*                                      GO                            */ 01587000
         AL    R5,@CF00072                                         0494 01588000
*CECTST70:                                                         0495 01589000
*   CALL CECTST80;                  /* TO ROUTINE WHICH FLAGS      0495 01590000
*                                      ROUTINES                      */ 01591000
CECTST70 BAL   @14,CECTST80                                        0495 01592000
*   GO TO CECTST58;                 /* SELECTED IN NORMAL AREA, THEN */ 01593000
*                                                                  0496 01594000
         B     CECTST58                                            0496 01595000
*   /*****************************************************************/ 01596000
*   /*                                                               */ 01597000
*   /* CONTINUE TO DECODE.                                           */ 01598000
*   /*                                                               */ 01599000
*   /*****************************************************************/ 01600000
*                                                                  0497 01601000
*CECTST72:                                                         0497 01602000
*   R6=ADDR(NUMBERS);               /* IS THE CHAR. IN INBUFR+2      */ 01603000
CECTST72 LA    R6,NUMBERS                                          0497 01604000
*   DO I=10 TO 1 BY-1;              /* NUMERIC. YES, HANDLE TRIPLE   */ 01605000
         LA    I,10                                                0498 01606000
@DL00498 DS    0H                                                  0499 01607000
*     IF INPUTBUF(3)=NUMBER THEN    /* NUMBER ROUTINE. NO, CONVERT   */ 01608000
         CLC   INPUTBUF+2(1,R5),NUMBER(R6)                         0499 01609000
         BE    @RT00499                                            0499 01610000
*       GO TO CECTST75;             /* DOUBLE NUMBER TO BINARY AND   */ 01611000
*     R6=R6+1;                      /* SET ROUTINE FLAGS IN SCT      */ 01612000
         AL    R6,@CF00072                                         0501 01613000
*   END;                                                           0502 01614000
         BCTR  I,0                                                 0502 01615000
         LTR   I,I                                                 0502 01616000
         BP    @DL00498                                            0502 01617000
*CECTST73:                          /* ROUTINE THAT CONVERTS DOUBLE     01618000
*                                      NUMBER FOR LAST               */ 01619000
*                                                                  0503 01620000
*   /*****************************************************************/ 01621000
*   /*                                                               */ 01622000
*   /* ROUTINE IN AN INCLUSIVE SERIES OF ROUTINES                    */ 01623000
*   /*                                                               */ 01624000
*   /*****************************************************************/ 01625000
*                                                                  0503 01626000
*   LASTRTN2=INPUTBUF(1:2);         /* CONVERT DOUBLE NUMBER         */ 01627000
CECTST73 MVC   LASTRTN2(2),INPUTBUF(R5)                            0503 01628000
*   GEN;                                                           0504 01629000
*                                  /* TO BINARY             */          01630000
         PACK  DOUBLEWD(8),LASTRTN(4)                                   01631000
         CVB   LSTRTN,DOUBLEWD                                          01632000
*   R5=R5+1;                        /* INCREMENT INBUFR POINTER      */ 01633000
         LA    @15,1                                               0505 01634000
         ALR   R5,@15                                              0505 01635000
*   IF LSTRTN<=FSTRTN THEN                                         0506 01636000
         CR    LSTRTN,FSTRTN                                       0506 01637000
         BNH   @RT00506                                            0506 01638000
*     GO TO CECTST03;                                              0507 01639000
*   R5=R5+1;                                                       0508 01640000
         ALR   R5,@15                                              0508 01641000
*   IF LSTRTN¬>16 THEN              /* IS LSTRTN > 16. NO, GO TO     */ 01642000
         LA    @15,16                                              0509 01643000
         CR    LSTRTN,@15                                          0509 01644000
         BNH   @RT00509                                            0509 01645000
*     GO TO CECTST70;               /* ROUTINE THAT SETS ROUTINE     */ 01646000
*   LASTRTN=LSTRTN;                 /* FLAGS IN NORMAL AREA.         */ 01647000
         ST    LSTRTN,LASTRTN                                      0511 01648000
*   LSTRTN=16;                      /* YES, SET FLAGS IN BOTH        */ 01649000
         LR    LSTRTN,@15                                          0512 01650000
*   CALL CECTST80;                  /* AREAS RESERVED FOR ROUTINE    */ 01651000
         BAL   @14,CECTST80                                        0513 01652000
*   FSTRTN=17;                      /* FLAGS                         */ 01653000
         LA    FSTRTN,17                                           0514 01654000
*   LSTRTN=LASTRTN;                                                0515 01655000
         L     LSTRTN,LASTRTN                                      0515 01656000
*   CALL CECTST78;                                                 0516 01657000
         BAL   @14,CECTST78                                        0516 01658000
*   GO TO CECTST58;                 /* CONTINUE TO DECODE            */ 01659000
         B     CECTST58                                            0517 01660000
*CECTST75:                                                         0518 01661000
*   LASTRTN1=INPUTBUF(1:3);         /* CONVERT TRIPLE NUMBER TO    0518 01662000
*                                      BINARY                        */ 01663000
CECTST75 MVC   LASTRTN1(3),INPUTBUF(R5)                            0518 01664000
*   GEN;                                                           0519 01665000
         PACK  DOUBLEWD(8),LASTRTN(4)                                   01666000
         CVB   LSTRTN,DOUBLEWD                                          01667000
*   IF LSTRTN>255 THEN              /* IS LAST INCLUSIVE ROUTINE     */ 01668000
         C     LSTRTN,@CF00864                                     0520 01669000
         BNH   @RF00520                                            0520 01670000
*     DO;                                                          0521 01671000
*       R5=R5+2;                    /* PT TO ERROR                   */ 01672000
         AL    R5,@CF00139                                         0522 01673000
*       GOTO CECTST03;                                             0523 01674000
         B     CECTST03                                            0523 01675000
*     END;                                                         0524 01676000
*   R5=R5+3;                        /* SET ERROR CODE -10- AND       */ 01677000
@RF00520 AL    R5,@CF00081                                         0525 01678000
*   FSTRTN=17;                      /* PRINT ERROR MESSAGE IFD112I   */ 01679000
         LA    FSTRTN,17                                           0526 01680000
*   DO;                                                            0527 01681000
*     LASTRTN=LSTRTN;                                              0528 01682000
         ST    LSTRTN,LASTRTN                                      0528 01683000
*     LSTRTN=16;                                                   0529 01684000
         LA    LSTRTN,16                                           0529 01685000
*     CALL CECTST80;                                               0530 01686000
         BAL   @14,CECTST80                                        0530 01687000
*     LSTRTN=LASTRTN;                                              0531 01688000
         L     LSTRTN,LASTRTN                                      0531 01689000
*     FSTRTN=17;                                                   0532 01690000
         LA    FSTRTN,17                                           0532 01691000
*   END;                                                           0533 01692000
*   IF FSTRTN<19 THEN                                              0534 01693000
         C     FSTRTN,@CF00880                                     0534 01694000
         BNL   @RF00534                                            0534 01695000
*     CALL CECTST78;                /* NO, SET ROUTINE FLAGS ON      */ 01696000
         BAL   @14,CECTST78                                        0535 01697000
*   GO TO CECTST58;                 /* IN SCT                        */ 01698000
         B     CECTST58                                            0536 01699000
*CECTST99:                                                         0537 01700000
*   $TSTCNT=SECCNTR;                /* SECTION COUNT                 */ 01701000
CECTST99 L     @15,SECCNTR                                         0537 01702000
         STH   @15,$TSTCNT(,WAPTR)                                 0537 01703000
*   $VALDTST='1'B;                                                 0538 01704000
         OI    $VALDTST(WAPTR),B'00000100'                         0538 01705000
*CECTST77:                                                         0539 01706000
*   R13=SVEIC003(2);                                               0539 01707000
CECTST77 L     R13,SVEIC003+4(,WAPTR)                              0539 01708000
*   RETURN;                                                        0540 01709000
@EL00001 DS    0H                                                  0540 01710000
@EF00001 DS    0H                                                  0540 01711000
@ER00001 LM    @14,@12,12(@13)                                     0540 01712000
         BR    @14                                                 0540 01713000
*CECTST78:                                                         0541 01714000
*                                                                  0541 01715000
*   /*****************************************************************/ 01716000
*   /*                                                               */ 01717000
*   /* SUBROUTINE FOR SETTING ROUTINE FLAGS IN EXPANDED AND NORMAL   */ 01718000
*   /* ROUTINE SELECTION FIELDS.                                     */ 01719000
*   /*                                                               */ 01720000
*   /*****************************************************************/ 01721000
*                                                                  0541 01722000
*   PROC OPTIONS(NOSAVEAREA,DONTSAVE);                             0541 01723000
CECTST78 DS    0H                                                  0542 01724000
*   SAVR14=R14;                     /* SAVE RETURN REGISTER          */ 01725000
         ST    R14,SAVR14                                          0542 01726000
*   EXPFLG='1'B;                    /* SET INDICATOR SAYING FLAGS    */ 01727000
*                                                                  0543 01728000
         OI    EXPFLG,B'00010000'                                  0543 01729000
*   /*****************************************************************/ 01730000
*   /*                                                               */ 01731000
*   /* ARE IN EXPANDED AREA                                          */ 01732000
*   /*                                                               */ 01733000
*   /*****************************************************************/ 01734000
*                                                                  0544 01735000
*CECTST79:                                                         0544 01736000
*   R7=ADDR($ROUTMSK);                                             0544 01737000
CECTST79 LA    R7,$ROUTMSK(,WAPTR)                                 0544 01738000
*   R7=(FSTRTN+7)/8-3+R7;           /* EXPANDED ROUTINE BYTE         */ 01739000
         LA    @10,7                                               0545 01740000
         ALR   @10,FSTRTN                                          0545 01741000
         SRDA  @10,32                                              0545 01742000
         D     @10,@CF00054                                        0545 01743000
         SL    @11,@CF00081                                        0545 01744000
         ALR   R7,@11                                              0545 01745000
*   GO TO CECTST82;                 /* SKIP TO NEXT NEEDED         0546 01746000
*                                      INSTRUCTION                   */ 01747000
         B     CECTST82                                            0546 01748000
*CECTST80:                                                         0547 01749000
*                                                                  0547 01750000
*   /*****************************************************************/ 01751000
*   /*                                                               */ 01752000
*   /* SUBROUTINE FOR SETTING ROUTINE FLAGS IN NORMAL ROUTINE        */ 01753000
*   /* SELECTION FIELD                                               */ 01754000
*   /*                                                               */ 01755000
*   /*****************************************************************/ 01756000
*                                                                  0547 01757000
*   ENTRY;                                                         0547 01758000
CECTST80 DS    0H                                                  0548 01759000
*   SAVR14=R14;                     /* SAVE RETURN REGISTER.         */ 01760000
         ST    R14,SAVR14                                          0548 01761000
*CECTST81:                                                         0549 01762000
*   R7=ADDR(RTNFLDXX)-1;            /* CALCULATE POINTER TO NEEDED   */ 01763000
CECTST81 LR    R7,WAPTR                                            0549 01764000
         SL    R7,@CF00897                                         0549 01765000
*   R7=(FSTRTN+7)/8+R7;             /* NORMAL ROUTINE BYTE           */ 01766000
         LA    @10,7                                               0550 01767000
         ALR   @10,FSTRTN                                          0550 01768000
         SRDA  @10,32                                              0550 01769000
         D     @10,@CF00054                                        0550 01770000
         ALR   R7,@11                                              0550 01771000
*CECTST82:                                                         0551 01772000
*   R6=(FSTRTN//8)+ADDR(MSKTABLE);  /* CALC. PTR                     */ 01773000
CECTST82 LR    @10,FSTRTN                                          0551 01774000
         SRDA  @10,32                                              0551 01775000
         D     @10,@CF00054                                        0551 01776000
         LA    R6,MSKTABLE                                         0551 01777000
         ALR   @10,R6                                              0551 01778000
         LR    R6,@10                                              0551 01779000
*   RTNFIELD=RTNFIELD|MASK;         /* SET BIT IN ROUTINE FIELD      */ 01780000
         OC    RTNFIELD(1,R7),MASK(R6)                             0552 01781000
*   FSTRTN=FSTRTN+1;                /* INCREMENT FIRST ROUTINE       */ 01782000
         AL    FSTRTN,@CF00072                                     0553 01783000
*   IF FSTRTN>LSTRTN THEN           /* IS ROUTINE FINISHED. YES,   0554 01784000
*                                      CLEAN                         */ 01785000
         CR    FSTRTN,LSTRTN                                       0554 01786000
         BH    @RT00554                                            0554 01787000
*     GO TO CECTST83;               /* UP. NO, DETERMINE WHICH SUB-  */ 01788000
*   IF EXPFLG='1'B THEN             /* ROUTINE IS BEING USED AND DO  */ 01789000
         TM    EXPFLG,B'00010000'                                  0556 01790000
         BO    @RT00556                                            0556 01791000
*     GO TO CECTST79;               /* IT AGAIN                      */ 01792000
*   GO TO CECTST81;                                                0558 01793000
         B     CECTST81                                            0558 01794000
*CECTST83:                                                         0559 01795000
*   EXPFLG='0'B;                    /* CLEANUP AND RETURN            */ 01796000
CECTST83 NI    EXPFLG,B'11101111'                                  0559 01797000
*   $HIGHRTN=LSTRTN;                                               0560 01798000
         STC   LSTRTN,$HIGHRTN(,WAPTR)                             0560 01799000
*   R14=SAVR14;                     /* RESTORE RETURN REGISTER       */ 01800000
         L     R14,SAVR14                                          0561 01801000
*   RETURN;                                                        0562 01802000
@EL00002 DS    0H                                                  0562 01803000
@EF00002 DS    0H                                                  0562 01804000
@ER00002 BR    @14                                                 0562 01805000
*   END CECTST78;                                                  0563 01806000
*   DO;                             /* ATDSPLY                       */ 01807000
*   END;                            /* ATDSPLY                       */ 01808000
*   END ISTIC004;                                                  0566 01809000
@DATA    DS    0H                                                       01810000
         DS    0F                                                       01811000
         DS    0F                                                       01812000
@CF00072 DC    F'1'                                                     01813000
@CH00072 EQU   @CF00072+2                                               01814000
@CF00139 DC    F'2'                                                     01815000
@CF00081 DC    F'3'                                                     01816000
@CF00068 DC    F'4'                                                     01817000
@CF00054 DC    F'8'                                                     01818000
@CF00061 DC    F'16'                                                    01819000
@CF00880 DC    F'19'                                                    01820000
@CF00493 DC    F'26'                                                    01821000
@CF00864 DC    F'255'                                                   01822000
@CF00897 DC    F'-3'                                                    01823000
         DS    0D                                                       01824000
CECMAP   DS    A                                                        01825000
@TS00001 DS    CL4                                                      01826000
@CC00764 DC    C'  A'                                                   01827000
@CC00765 DC    C'  Z'                                                   01828000
@CC00768 DC    C'   '                                                   01829000
@CC00808 DC    C' AA'                                                   01830000
@CC00813 DC    C'AAA'                                                   01831000
@CC00818 EQU   @CC00813                                                 01832000
         DS    CL1                                                      01833000
SECINIT  DC    X'40404000'                                              01834000
         DS    CL4                                                      01835000
@NM00051 DS    CL40                                                     01836000
         ORG   @NM00051                                                 01837000
LET1PTR  DS    AL4                                                      01838000
LET2PTR  DS    AL4                                                      01839000
LET3PTR  DS    AL4                                                      01840000
J        DS    FL2                                                      01841000
N        DS    FL2                                                      01842000
DOUBLEWD DS    CL8                                                      01843000
         ORG   DOUBLEWD                                                 01844000
SAVR14   DS    AL4                                                      01845000
         ORG   @NM00051+24                                              01846000
FRSTRTN  DS    CL4                                                      01847000
         ORG   FRSTRTN                                                  01848000
LASTRTN  DS    CL4                                                      01849000
         ORG   LASTRTN                                                  01850000
@NM00052 DS    CL1                                                      01851000
FRSTRTN1 DS    CL3                                                      01852000
         ORG   FRSTRTN1                                                 01853000
LASTRTN1 DS    CL3                                                      01854000
         ORG   LASTRTN1                                                 01855000
@NM00053 DS    CL1                                                      01856000
FRSTRTN2 DS    CL2                                                      01857000
         ORG   FRSTRTN2                                                 01858000
LASTRTN2 DS    CL2                                                      01859000
         ORG   LASTRTN2                                                 01860000
@NM00054 DS    CL1                                                      01861000
FRSTRTN3 DS    CL1                                                      01862000
         ORG   FRSTRTN3                                                 01863000
LASTRTN3 DS    CL1                                                      01864000
         ORG   @NM00051+28                                              01865000
SECCNTR  DS    FL4                                                      01866000
SWITCHES DC    X'00'                                                    01867000
         ORG   SWITCHES                                                 01868000
SECTIONS DS    BL1                                                      01869000
         ORG   SECTIONS                                                 01870000
SECT1    DS    BL1                                                      01871000
SECT2    EQU   SECTIONS+0                                               01872000
SECT3    EQU   SECTIONS+0                                               01873000
         ORG   SWITCHES+0                                               01874000
EXPFLG   EQU   SWITCHES+0                                               01875000
DUBNUM   EQU   SWITCHES+0                                               01876000
TRINUM   EQU   SWITCHES+0                                               01877000
@NM00055 EQU   SWITCHES+0                                               01878000
DASH     EQU   SWITCHES+0                                               01879000
         ORG   @NM00051+33                                              01880000
FSTSEC   DS    CL3                                                      01881000
         ORG   FSTSEC                                                   01882000
@NM00056 DS    CL1                                                      01883000
FSTSEC1  DS    CL2                                                      01884000
         ORG   FSTSEC1                                                  01885000
FSTSECT1 DS    CL1                                                      01886000
FSTSEC2  DS    CL1                                                      01887000
         ORG   @NM00051+36                                              01888000
LSTSEC   DS    CL3                                                      01889000
         ORG   LSTSEC                                                   01890000
@NM00057 DS    CL1                                                      01891000
LSTSEC1  DS    CL2                                                      01892000
         ORG   LSTSEC1                                                  01893000
@NM00058 DS    CL1                                                      01894000
LSTSEC2  DS    CL1                                                      01895000
         ORG   @NM00051+40                                              01896000
MSKTABLE DC    X'0180402010080402'                                      01897000
ALPHABET DC    CL26'ABCDEFGHIJKLMNOPQRSTUVWXYZ'                         01898000
NUMBERS  DC    CL10'0123456789'                                         01899000
$TCA09   DS    CL13                                                     01900000
         ORG   $TCA09                                                   01901000
$TCB09   DC    A(112)                                                   01902000
$TCC09   DC    A(0)                                                     01903000
$TCD09   DC    B'10000000'                                              01904000
$TCE09   DC    X'FFFFFFFF'                                              01905000
         ORG   $TCA09+13                                                01906000
         DS    CL3                                                      01907000
$TCA10   DS    CL13                                                     01908000
         ORG   $TCA10                                                   01909000
$TCB10   DC    A(155)                                                   01910000
$TCC10   DC    A(0)                                                     01911000
$TCD10   DC    B'00000000'                                              01912000
$TCE10   DC    X'FFFFFFFF'                                              01913000
         ORG   $TCA10+13                                                01914000
         DS    CL3                                                      01915000
PATCH    DC    15F'0'                                                   01916000
@00      EQU   00                      EQUATES FOR REGISTERS 0-15       01917000
@01      EQU   01                                                       01918000
@02      EQU   02                                                       01919000
@03      EQU   03                                                       01920000
@04      EQU   04                                                       01921000
@05      EQU   05                                                       01922000
@06      EQU   06                                                       01923000
@07      EQU   07                                                       01924000
@08      EQU   08                                                       01925000
@09      EQU   09                                                       01926000
@10      EQU   10                                                       01927000
@11      EQU   11                                                       01928000
@12      EQU   12                                                       01929000
@13      EQU   13                                                       01930000
@14      EQU   14                                                       01931000
@15      EQU   15                                                       01932000
RCAPTR   EQU   @04                                                      01933000
WAPTR    EQU   @02                                                      01934000
R1       EQU   @01                                                      01935000
R2       EQU   @02                                                      01936000
I        EQU   @03                                                      01937000
R5       EQU   @05                                                      01938000
R6       EQU   @06                                                      01939000
R7       EQU   @07                                                      01940000
FSTRTN   EQU   @08                                                      01941000
R8       EQU   @08                                                      01942000
R9       EQU   @09                                                      01943000
LSTRTN   EQU   @09                                                      01944000
R13      EQU   @13                                                      01945000
R14      EQU   @14                                                      01946000
R10      EQU   @10                                                      01947000
R15      EQU   @15                                                      01948000
$RCAAREA EQU   0                                                        01949000
$POINTER EQU   $RCAAREA+100                                             01950000
$TRTBLA  EQU   $POINTER+124                                             01951000
$CONSTNT EQU   $RCAAREA+244                                             01952000
$RCAFLG  EQU   $RCAAREA+604                                             01953000
$CUTESTB EQU   $RCAFLG                                                  01954000
TOLTEPWA EQU   0                                                        01955000
$SCTTBLE EQU   TOLTEPWA                                                 01956000
$TESTOPT EQU   $SCTTBLE+2                                               01957000
$ERROPT  EQU   $SCTTBLE+3                                               01958000
$RT0108  EQU   $SCTTBLE+4                                               01959000
$RT0916  EQU   $SCTTBLE+5                                               01960000
$PDEVFLG EQU   $SCTTBLE+10                                              01961000
$CDSFLGS EQU   $SCTTBLE+11                                              01962000
$CDS8T19 EQU   $SCTTBLE+20                                              01963000
$EXECFLG EQU   $SCTTBLE+33                                              01964000
$RTNSLCT EQU   $EXECFLG                                                 01965000
$OLTFLGS EQU   $SCTTBLE+36                                              01966000
$OLTFLG2 EQU   $SCTTBLE+37                                              01967000
$TOTFLG1 EQU   $SCTTBLE+38                                              01968000
$ROUTMSK EQU   $SCTTBLE+40                                              01969000
$CDA     EQU   TOLTEPWA+100                                             01970000
$SLASHAD EQU   $CDA+32                                                  01971000
$RCA     EQU   $CDA+44                                                  01972000
$OLTPTR  EQU   $CDA+52                                                  01973000
$HIMOREC EQU   $CDA+60                                                  01974000
$CUCNT   EQU   $CDA+118                                                 01975000
$COMMFLG EQU   TOLTEPWA+224                                             01976000
$FLAG1   EQU   $COMMFLG                                                 01977000
$FLAG2   EQU   $COMMFLG+1                                               01978000
$VALDTST EQU   $FLAG2                                                   01979000
$FLAG3   EQU   $COMMFLG+2                                               01980000
$TSTERR  EQU   $FLAG3                                                   01981000
$FLAG4   EQU   $COMMFLG+3                                               01982000
$FLAG5   EQU   $COMMFLG+4                                               01983000
$EOJ     EQU   $FLAG5                                                   01984000
$CANCEL  EQU   $EOJ                                                     01985000
$FLAG6   EQU   $COMMFLG+5                                               01986000
$ABNDBIT EQU   $FLAG6                                                   01987000
$FLAG7   EQU   $COMMFLG+6                                               01988000
$FLAG8   EQU   $COMMFLG+7                                               01989000
$TCECM   EQU   $FLAG8                                                   01990000
$FLAG9   EQU   $COMMFLG+8                                               01991000
$FLAG10  EQU   $COMMFLG+9                                               01992000
$FLAG11  EQU   $COMMFLG+10                                              01993000
$FLAG12  EQU   $COMMFLG+11                                              01994000
$FLAG13  EQU   $COMMFLG+12                                              01995000
$DEVTBLE EQU   TOLTEPWA+240                                             01996000
$DEVCDS  EQU   $DEVTBLE                                                 01997000
$DEVUNAD EQU   $DEVCDS                                                  01998000
@NM00039 EQU   $DEVUNAD+2                                               01999000
$DEVFEAT EQU   $DEVCDS+4                                                02000000
$DEVCDSF EQU   $DEVCDS+9                                                02001000
$DEVSDCF EQU   $DEVCDS+10                                               02002000
$$SYMNME EQU   $DEVCDS+12                                               02003000
$DEVFLG1 EQU   $DEVTBLE+20                                              02004000
$EVNCPLT EQU   $DEVFLG1                                                 02005000
$ATTNEXP EQU   $DEVFLG1                                                 02006000
$INTOCC  EQU   $DEVFLG1                                                 02007000
$DEVFLG2 EQU   $DEVTBLE+21                                              02008000
$DEVTECB EQU   $DEVTBLE+22                                              02009000
$OPIS    EQU   $DEVTECB                                                 02010000
$OPND    EQU   $DEVTECB+2                                               02011000
$DEVFLG3 EQU   $DEVTBLE+27                                              02012000
$SIOFLG  EQU   $DEVFLG3                                                 02013000
$IFTOUT  EQU   $DEVTBLE+36                                              02014000
$DEVSESP EQU   $IFTOUT                                                  02015000
$SSCPDAF EQU   $IFTOUT+6                                                02016000
$LDNCBPT EQU   $DEVTBLE+48                                              02017000
$RNINFO  EQU   $DEVTBLE+56                                              02018000
$DEVFLG5 EQU   $RNINFO+8                                                02019000
$DEVFLG4 EQU   $DEVTBLE+65                                              02020000
$SLTBL   EQU   TOLTEPWA+1468                                            02021000
$FAMILY  EQU   $SLTBL                                                   02022000
$RUNTEST EQU   $SLTBL+13                                                02023000
$TESTFLG EQU   $SLTBL+21                                                02024000
$SECLST  EQU   $SLTBL+22                                                02025000
$TSTCNT  EQU   $SLTBL+126                                               02026000
$HIGHRTN EQU   $SLTBL+134                                               02027000
$INBUFR  EQU   TOLTEPWA+2104                                            02028000
#EXITA   EQU   TOLTEPWA+2632                                            02029000
$CCOMDAT EQU   TOLTEPWA+2644                                            02030000
$CFLGS   EQU   $CCOMDAT+16                                              02031000
$24FEMSG EQU   TOLTEPWA+2681                                            02032000
$24CATMG EQU   $24FEMSG+11                                              02033000
@NM00048 EQU   TOLTEPWA+2776                                            02034000
$OUNTPTR EQU   @NM00048+4                                               02035000
$NSPTR   EQU   $OUNTPTR                                                 02036000
$NSCNT   EQU   @NM00048+10                                              02037000
$ENXX    EQU   @NM00048+15                                              02038000
$IMITX   EQU   $ENXX                                                    02039000
SVESC033 EQU   TOLTEPWA+3160                                            02040000
SVECC013 EQU   TOLTEPWA+3232                                            02041000
SVEIC003 EQU   TOLTEPWA+3592                                            02042000
SVESC022 EQU   TOLTEPWA+3736                                            02043000
SVECC011 EQU   TOLTEPWA+4024                                            02044000
#EXIT    EQU   0                                                        02045000
CECOMMAP EQU   0                                                        02046000
SECLSTXX EQU   0                                                        02047000
TSTSECTN EQU   SECLSTXX                                                 02048000
TSTSCTN3 EQU   TSTSECTN                                                 02049000
TSTSCTN2 EQU   TSTSCTN3                                                 02050000
TSTSCTN1 EQU   TSTSCTN2                                                 02051000
TSTFLG   EQU   SECLSTXX+3                                               02052000
MASK     EQU   0                                                        02053000
LETTER   EQU   0                                                        02054000
NUMBER   EQU   0                                                        02055000
RTNFLDXX EQU   0                                                        02056000
RTNFIELD EQU   0                                                        02057000
INPUTBUF EQU   0                                                        02058000
BACKSAVE EQU   0                                                        02059000
$TRTBL   EQU   0                                                        02060000
SVECC012 EQU   SVESC022                                                 02061000
SVEIC00A EQU   SVEIC003                                                 02062000
SVEIC004 EQU   SVEIC003                                                 02063000
SVEIC005 EQU   SVEIC003                                                 02064000
SVESC02A EQU   SVESC022                                                 02065000
SVESC02B EQU   SVESC022                                                 02066000
SVESC02D EQU   SVESC022                                                 02067000
SVESC02E EQU   SVESC022                                                 02068000
SVESC02F EQU   SVECC013                                                 02069000
SVESC024 EQU   SVESC022                                                 02070000
SVESC027 EQU   SVESC022                                                 02071000
SVESC029 EQU   SVESC033                                                 02072000
SVESC031 EQU   SVECC013                                                 02073000
SVESC032 EQU   SVECC011                                                 02074000
SVETC037 EQU   SVEIC003                                                 02075000
         AGO   .@UNREFD                START UNREFERENCED COMPONENTS    02076000
$CECFLAG EQU   CECOMMAP+20                                              02077000
$CEINCT  EQU   CECOMMAP+16                                              02078000
$CEINADR EQU   CECOMMAP+12                                              02079000
$CEOUTCT EQU   CECOMMAP+8                                               02080000
$CEOUTAD EQU   CECOMMAP+4                                               02081000
$CECIDNT EQU   CECOMMAP+2                                               02082000
$CECLEVL EQU   CECOMMAP+1                                               02083000
$CECTRMG EQU   CECOMMAP                                                 02084000
SVECC010 EQU   TOLTEPWA+3952                                            02085000
SVETC035 EQU   TOLTEPWA+3880                                            02086000
SVESC030 EQU   TOLTEPWA+3808                                            02087000
SVESC020 EQU   TOLTEPWA+3664                                            02088000
SVEIC002 EQU   TOLTEPWA+3520                                            02089000
SVECC014 EQU   TOLTEPWA+3376                                            02090000
SVESC120 EQU   TOLTEPWA+3304                                            02091000
SVESC025 EQU   TOLTEPWA+3088                                            02092000
@NM00050 EQU   TOLTEPWA+2980                                            02093000
$RPLERR  EQU   TOLTEPWA+2977                                            02094000
@NM00049 EQU   TOLTEPWA+2976                                            02095000
$R13PR3  EQU   TOLTEPWA+2972                                            02096000
$CEINT2  EQU   TOLTEPWA+2968                                            02097000
$CEINT1  EQU   TOLTEPWA+2964                                            02098000
$MSGGET  EQU   TOLTEPWA+2960                                            02099000
$ACQLIST EQU   TOLTEPWA+2956                                            02100000
$R4SAVE1 EQU   TOLTEPWA+2952                                            02101000
$CLSISS  EQU   TOLTEPWA+2950                                            02102000
$CLSCNT  EQU   TOLTEPWA+2948                                            02103000
$CUTABLE EQU   TOLTEPWA+2868                                            02104000
$BUFSZ2  EQU   TOLTEPWA+2864                                            02105000
$RESID2  EQU   TOLTEPWA+2860                                            02106000
$OLTCCW2 EQU   TOLTEPWA+2856                                            02107000
$ENDBFR2 EQU   TOLTEPWA+2852                                            02108000
$1STBFR2 EQU   TOLTEPWA+2848                                            02109000
$TECB2   EQU   TOLTEPWA+2844                                            02110000
$BUFSZ1  EQU   TOLTEPWA+2840                                            02111000
$RESID1  EQU   TOLTEPWA+2836                                            02112000
$OLTCCW1 EQU   TOLTEPWA+2832                                            02113000
$ENDBFR1 EQU   TOLTEPWA+2828                                            02114000
$1STBFR1 EQU   TOLTEPWA+2824                                            02115000
$TECB1   EQU   TOLTEPWA+2820                                            02116000
$WAITIME EQU   TOLTEPWA+2816                                            02117000
$TRTN#   EQU   TOLTEPWA+2815                                            02118000
$WIODEV  EQU   TOLTEPWA+2814                                            02119000
$RQSTSZE EQU   TOLTEPWA+2812                                            02120000
$RQSTPTR EQU   TOLTEPWA+2808                                            02121000
$R4SAVE  EQU   TOLTEPWA+2804                                            02122000
$PARTADR EQU   TOLTEPWA+2800                                            02123000
$TBSDATA EQU   TOLTEPWA+2796                                            02124000
$CTWIDTH EQU   TOLTEPWA+2795                                            02125000
$CTLINE  EQU   TOLTEPWA+2794                                            02126000
$APWIDTH EQU   TOLTEPWA+2793                                            02127000
$APLINE  EQU   TOLTEPWA+2792                                            02128000
$INDEX   EQU   $IMITX                                                   02129000
$UMXX    EQU   @NM00048+14                                              02130000
$NSXX    EQU   @NM00048+12                                              02131000
$ATACNT  EQU   $NSCNT                                                   02132000
$CTR     EQU   @NM00048+8                                               02133000
$ATAPTR  EQU   $NSPTR                                                   02134000
$DDRPTR  EQU   @NM00048                                                 02135000
$DTORESP EQU   TOLTEPWA+2712                                            02136000
$APNAME  EQU   TOLTEPWA+2704                                            02137000
$24SYMNE EQU   $24CATMG+4                                               02138000
$24DEVAD EQU   $24CATMG                                                 02139000
$24RTN#  EQU   $24FEMSG+8                                               02140000
$ESECTID EQU   $24FEMSG                                                 02141000
$24FLGS  EQU   TOLTEPWA+2680                                            02142000
$24SAVE2 EQU   TOLTEPWA+2676                                            02143000
$24SAVE1 EQU   TOLTEPWA+2672                                            02144000
$24UNADR EQU   TOLTEPWA+2668                                            02145000
$24SAV13 EQU   TOLTEPWA+2664                                            02146000
$24RETCD EQU   TOLTEPWA+2663                                            02147000
$MACID   EQU   TOLTEPWA+2661                                            02148000
$CSPARE  EQU   $CFLGS                                                   02149000
$C2WAY   EQU   $CFLGS                                                   02150000
$CINCT   EQU   $CCOMDAT+12                                              02151000
$CINADR  EQU   $CCOMDAT+8                                               02152000
$COUTCT  EQU   $CCOMDAT+4                                               02153000
$COUTAD  EQU   $CCOMDAT                                                 02154000
ROOTLOC  EQU   TOLTEPWA+2640                                            02155000
$RETREG  EQU   TOLTEPWA+2636                                            02156000
$WORK    EQU   TOLTEPWA+2376                                            02157000
$EXTA    EQU   TOLTEPWA+2320                                            02158000
$PASSONA EQU   TOLTEPWA+2264                                            02159000
$TRMINPT EQU   TOLTEPWA+2184                                            02160000
$BUFFER  EQU   TOLTEPWA+1976                                            02161000
$TLTRPL3 EQU   TOLTEPWA+1856                                            02162000
$TLTRPL2 EQU   TOLTEPWA+1736                                            02163000
$TLTRPL1 EQU   TOLTEPWA+1616                                            02164000
@NM00047 EQU   $SLTBL+135                                               02165000
$PRIMADR EQU   $SLTBL+130                                               02166000
$CTSTPT  EQU   $SLTBL+128                                               02167000
$SECFLGS EQU   $SECLST+3                                                02168000
$SECTION EQU   $SECLST                                                  02169000
$SECACT  EQU   $TESTFLG                                                 02170000
$CANTRUN EQU   $TESTFLG                                                 02171000
$FINAL   EQU   $TESTFLG                                                 02172000
$TESTSUF EQU   $RUNTEST+5                                               02173000
$TESTNUM EQU   $RUNTEST+1                                               02174000
$LETPRF  EQU   $RUNTEST                                                 02175000
$SYMBOLC EQU   $SLTBL+5                                                 02176000
$CDEVPT  EQU   TOLTEPWA+1466                                            02177000
$DEVCNTS EQU   TOLTEPWA+1464                                            02178000
$FEEDBCK EQU   $DEVTBLE+66                                              02179000
$WTISUED EQU   $DEVFLG4                                                 02180000
$EXIOISD EQU   $DEVFLG4                                                 02181000
$REMWRIT EQU   $DEVFLG4                                                 02182000
$REMDONE EQU   $DEVFLG4                                                 02183000
$2NDUSED EQU   $DEVFLG4                                                 02184000
$1STUSED EQU   $DEVFLG4                                                 02185000
$IGLXIFB EQU   $DEVFLG4                                                 02186000
$EXIOLV3 EQU   $DEVFLG4                                                 02187000
@NM00046 EQU   $DEVFLG5                                                 02188000
$DVBASIC EQU   $DEVFLG5                                                 02189000
$ASCII   EQU   $DEVFLG5                                                 02190000
$DEVLU   EQU   $DEVFLG5                                                 02191000
$OPNDFAL EQU   $DEVFLG5                                                 02192000
$ACQNCB  EQU   $DEVFLG5                                                 02193000
$REMOTE  EQU   $DEVFLG5                                                 02194000
$ENDNODE EQU   $DEVFLG5                                                 02195000
$LINENME EQU   $RNINFO                                                  02196000
$CID     EQU   $DEVTBLE+52                                              02197000
$DVCOL   EQU   $LDNCBPT+2                                               02198000
$DVROW   EQU   $LDNCBPT                                                 02199000
$NCSPLP  EQU   $DEVTBLE+44                                              02200000
$DVLN    EQU   $SSCPDAF                                                 02201000
$DAF     EQU   $DEVSESP+4                                               02202000
$VARYPAB EQU   $DEVSESP                                                 02203000
$SYSMN   EQU   $DEVTBLE+28                                              02204000
@NM00045 EQU   $DEVFLG3                                                 02205000
$CLRSNT  EQU   $DEVFLG3                                                 02206000
$OLTERR  EQU   $DEVFLG3                                                 02207000
$SRTEST  EQU   $DEVFLG3                                                 02208000
$DVSNDOK EQU   $SIOFLG                                                  02209000
$POLLREQ EQU   $DEVFLG3                                                 02210000
$ACQRED  EQU   $DEVFLG3                                                 02211000
$NOTDEV  EQU   $DEVFLG3                                                 02212000
$DVINCT  EQU   $DEVTBLE+26                                              02213000
$DVBRKST EQU   $OPND+1                                                  02214000
$DVBRKSN EQU   $OPND                                                    02215000
$DVSEQNO EQU   $OPIS                                                    02216000
$CEINTRP EQU   $DEVFLG2                                                 02217000
$TESTMDE EQU   $DEVFLG2                                                 02218000
$DEVALOC EQU   $DEVFLG2                                                 02219000
$ALLDATA EQU   $DEVFLG2                                                 02220000
$ENDCNTL EQU   $DEVFLG2                                                 02221000
$CTLDEV  EQU   $DEVFLG2                                                 02222000
$NOCDS   EQU   $DEVFLG2                                                 02223000
$DATAIN  EQU   $DEVFLG2                                                 02224000
$PRIMARY EQU   $DEVFLG1                                                 02225000
$DVCTBYT EQU   $INTOCC                                                  02226000
$DEVACT  EQU   $DEVFLG1                                                 02227000
$DVLGMDE EQU   $ATTNEXP                                                 02228000
$DVSPRM  EQU   $EVNCPLT                                                 02229000
$GRABBED EQU   $DEVFLG1                                                 02230000
$CATASTR EQU   $DEVFLG1                                                 02231000
$LETGO   EQU   $DEVFLG1                                                 02232000
$CURELEM EQU   $$SYMNME+4                                               02233000
$MSGOTSD EQU   $$SYMNME                                                 02234000
$EXTDEV  EQU   $DEVCDS+11                                               02235000
@NM00044 EQU   $DEVSDCF                                                 02236000
$NOTPRIM EQU   $DEVSDCF                                                 02237000
@NM00043 EQU   $DEVCDSF                                                 02238000
@NM00042 EQU   $DEVCDSF                                                 02239000
@NM00041 EQU   $DEVCDSF                                                 02240000
$CDSNAME EQU   $DEVCDSF                                                 02241000
$EXTRN   EQU   $DEVCDSF                                                 02242000
$CEVOLUM EQU   $DEVCDSF                                                 02243000
$SHARD   EQU   $DEVCDSF                                                 02244000
$DEVFPM  EQU   $DEVCDSF                                                 02245000
$DEVCNT  EQU   $DEVCDS+8                                                02246000
$DEVTYPE EQU   $DEVFEAT+3                                               02247000
$DEVCLAS EQU   $DEVFEAT+2                                               02248000
$DEVFRRS EQU   $DEVFEAT+1                                               02249000
$DEVMOD  EQU   $DEVFEAT                                                 02250000
$DEVRDGT EQU   @NM00039+1                                               02251000
$DEVCTLU EQU   @NM00039+1                                               02252000
$DEVCHAN EQU   @NM00039                                                 02253000
@NM00040 EQU   @NM00039                                                 02254000
$CTINDX  EQU   $DEVUNAD                                                 02255000
$FLAG16  EQU   $COMMFLG+15                                              02256000
$FLAG15  EQU   $COMMFLG+14                                              02257000
$FLAG14  EQU   $COMMFLG+13                                              02258000
$TEP2ND  EQU   $FLAG13                                                  02259000
$TEP1ST  EQU   $FLAG13                                                  02260000
$CATMSG  EQU   $FLAG13                                                  02261000
$PRMPTSW EQU   $FLAG13                                                  02262000
$DEVENT  EQU   $FLAG13                                                  02263000
$OLTMACC EQU   $FLAG13                                                  02264000
$LGON    EQU   $FLAG13                                                  02265000
$CTLOGON EQU   $FLAG13                                                  02266000
@NM00038 EQU   $FLAG12                                                  02267000
$VARYINP EQU   $FLAG12                                                  02268000
$ENDTEST EQU   $FLAG12                                                  02269000
$VRYHRD  EQU   $FLAG12                                                  02270000
$VRYSFT  EQU   $FLAG12                                                  02271000
$POSTFLG EQU   $FLAG12                                                  02272000
$OPTMSG  EQU   $FLAG12                                                  02273000
$FEORCAT EQU   $FLAG11                                                  02274000
@NM00037 EQU   $FLAG11                                                  02275000
@NM00036 EQU   $FLAG10                                                  02276000
$INBND   EQU   $FLAG10                                                  02277000
$WAITFLG EQU   $FLAG10                                                  02278000
$DPRINT  EQU   $FLAG10                                                  02279000
$HOLD    EQU   $FLAG9                                                   02280000
$NOTRRCH EQU   $FLAG9                                                   02281000
@NM00035 EQU   $FLAG9                                                   02282000
$COPY    EQU   $FLAG9                                                   02283000
$LSTLNSW EQU   $FLAG9                                                   02284000
$MULLNSW EQU   $FLAG9                                                   02285000
$REMSW   EQU   $FLAG9                                                   02286000
$IGRES   EQU   $FLAG9                                                   02287000
$VS2     EQU   $FLAG8                                                   02288000
$VS1     EQU   $FLAG8                                                   02289000
$EDOS    EQU   $FLAG8                                                   02290000
@NM00034 EQU   $FLAG8                                                   02291000
$TWOWAY  EQU   $FLAG8                                                   02292000
@NM00033 EQU   $FLAG8                                                   02293000
$RCVMSG  EQU   $FLAG7                                                   02294000
$RCVRFLG EQU   $FLAG7                                                   02295000
$SNDRFLG EQU   $FLAG7                                                   02296000
$LDOIS   EQU   $FLAG7                                                   02297000
$DCONTCT EQU   $FLAG7                                                   02298000
$EXIOWAT EQU   $FLAG7                                                   02299000
$2NDDATA EQU   $FLAG7                                                   02300000
$1STDATA EQU   $FLAG7                                                   02301000
$CIREQ   EQU   $FLAG6                                                   02302000
$ABTERM  EQU   $ABNDBIT                                                 02303000
$FSTMCIS EQU   $FLAG6                                                   02304000
$DISCREQ EQU   $FLAG6                                                   02305000
$DISCISS EQU   $FLAG6                                                   02306000
$CHANGE  EQU   $FLAG6                                                   02307000
$CTERROR EQU   $FLAG6                                                   02308000
$RECAL11 EQU   $FLAG6                                                   02309000
@NM00032 EQU   $FLAG5                                                   02310000
$PROGCK  EQU   $CANCEL                                                  02311000
$PRINTAP EQU   $FLAG5                                                   02312000
@NM00031 EQU   $FLAG5                                                   02313000
$MSG922  EQU   $FLAG5                                                   02314000
$CT924   EQU   $FLAG5                                                   02315000
$FSTCAT  EQU   $FLAG5                                                   02316000
$FSTFE   EQU   $FLAG5                                                   02317000
$ACTOPND EQU   $FLAG4                                                   02318000
$ACQCUTT EQU   $FLAG4                                                   02319000
$CLSSACT EQU   $FLAG4                                                   02320000
$BACKINT EQU   $FLAG4                                                   02321000
$DMSGSW  EQU   $FLAG4                                                   02322000
$TSTDEVP EQU   $FLAG4                                                   02323000
$APRQPER EQU   $FLAG4                                                   02324000
$OPCOM   EQU   $FLAG4                                                   02325000
$NEWAP   EQU   $FLAG3                                                   02326000
$ALTPRTR EQU   $FLAG3                                                   02327000
$OPTERR  EQU   $FLAG3                                                   02328000
$PRTONLY EQU   $FLAG3                                                   02329000
$REQSTOR EQU   $FLAG3                                                   02330000
$LOGOFFE EQU   $FLAG3                                                   02331000
$DEVERR  EQU   $FLAG3                                                   02332000
$PARTIAL EQU   $FLAG2                                                   02333000
$NRMTERM EQU   $FLAG2                                                   02334000
$VALDDEV EQU   $FLAG2                                                   02335000
$DBLSLSH EQU   $FLAG2                                                   02336000
$NDR     EQU   $FLAG2                                                   02337000
@NM00030 EQU   $FLAG2                                                   02338000
$OLTACT  EQU   $FLAG1                                                   02339000
$NORELDV EQU   $FLAG1                                                   02340000
@NM00029 EQU   $FLAG1                                                   02341000
$OPTCHNG EQU   $FLAG1                                                   02342000
$DEVCHNG EQU   $FLAG1                                                   02343000
$TESTCNG EQU   $FLAG1                                                   02344000
$CNSLFG  EQU   $FLAG1                                                   02345000
$TEP3RD  EQU   $FLAG1                                                   02346000
@NM00028 EQU   $CDA+120                                                 02347000
@NM00027 EQU   $CDA+117                                                 02348000
$PRTFORM EQU   $CDA+116                                                 02349000
$OPISCNT EQU   $CDA+114                                                 02350000
$OPNDCNT EQU   $CDA+112                                                 02351000
$GETMSZE EQU   $CDA+110                                                 02352000
$GRCNTS  EQU   $CDA+108                                                 02353000
$CTLCNT  EQU   $CDA+106                                                 02354000
$ACTLVL  EQU   $CDA+105                                                 02355000
$PRNTLVL EQU   $CDA+104                                                 02356000
$ERRCNTA EQU   $CDA+102                                                 02357000
$TLCNT   EQU   $CDA+100                                                 02358000
$TIMEALW EQU   $CDA+96                                                  02359000
$PTRAREA EQU   $CDA+92                                                  02360000
$GETMPTR EQU   $CDA+88                                                  02361000
$R13PTRT EQU   $CDA+84                                                  02362000
$R13PTR  EQU   $CDA+80                                                  02363000
$TEPEND  EQU   $CDA+76                                                  02364000
$PLINKDL EQU   $CDA+72                                                  02365000
$TEPBEGN EQU   $CDA+68                                                  02366000
$FRELPTR EQU   $CDA+64                                                  02367000
$HIGHADR EQU   $HIMOREC                                                 02368000
$LOMOREC EQU   $CDA+56                                                  02369000
$LOWADDR EQU   $OLTPTR                                                  02370000
$ENDCOMM EQU   $CDA+48                                                  02371000
$COMMON  EQU   $RCA                                                     02372000
$PASSON  EQU   $CDA+28                                                  02373000
$TOLBRTB EQU   $CDA+24                                                  02374000
$SCTPTR8 EQU   $CDA+20                                                  02375000
$SCTPTR  EQU   $CDA+16                                                  02376000
$TBWDPTR EQU   $CDA+12                                                  02377000
$TFWDPTR EQU   $CDA+8                                                   02378000
@NM00026 EQU   $CDA                                                     02379000
@NM00025 EQU   $SCTTBLE+98                                              02380000
$SCTLWTC EQU   $SCTTBLE+96                                              02381000
$SCTLWTA EQU   $SCTTBLE+92                                              02382000
#EXT     EQU   $SCTTBLE+88                                              02383000
#PASS    EQU   $SCTTBLE+84                                              02384000
#TABLE   EQU   $SCTTBLE+80                                              02385000
#MSGIDAC EQU   $SCTTBLE+78                                              02386000
@NM00024 EQU   $SCTTBLE+71                                              02387000
$RETMASK EQU   $SCTTBLE+70                                              02388000
$R249255 EQU   $ROUTMSK+29                                              02389000
$R241248 EQU   $ROUTMSK+28                                              02390000
$R233240 EQU   $ROUTMSK+27                                              02391000
$R225232 EQU   $ROUTMSK+26                                              02392000
$R217224 EQU   $ROUTMSK+25                                              02393000
$R209216 EQU   $ROUTMSK+24                                              02394000
$R201208 EQU   $ROUTMSK+23                                              02395000
$R193200 EQU   $ROUTMSK+22                                              02396000
$R185192 EQU   $ROUTMSK+21                                              02397000
$R177184 EQU   $ROUTMSK+20                                              02398000
$R169176 EQU   $ROUTMSK+19                                              02399000
$R161168 EQU   $ROUTMSK+18                                              02400000
$R153160 EQU   $ROUTMSK+17                                              02401000
$R145152 EQU   $ROUTMSK+16                                              02402000
$R137144 EQU   $ROUTMSK+15                                              02403000
$R129136 EQU   $ROUTMSK+14                                              02404000
$R121128 EQU   $ROUTMSK+13                                              02405000
$R113120 EQU   $ROUTMSK+12                                              02406000
$R105112 EQU   $ROUTMSK+11                                              02407000
$R097104 EQU   $ROUTMSK+10                                              02408000
$R089096 EQU   $ROUTMSK+9                                               02409000
$R081088 EQU   $ROUTMSK+8                                               02410000
$R073080 EQU   $ROUTMSK+7                                               02411000
$R065072 EQU   $ROUTMSK+6                                               02412000
$R057064 EQU   $ROUTMSK+5                                               02413000
$R049056 EQU   $ROUTMSK+4                                               02414000
$R041048 EQU   $ROUTMSK+3                                               02415000
$R033040 EQU   $ROUTMSK+2                                               02416000
$R025032 EQU   $ROUTMSK+1                                               02417000
$R017024 EQU   $ROUTMSK                                                 02418000
$TOTFLG2 EQU   $SCTTBLE+39                                              02419000
@NM00023 EQU   $TOTFLG1                                                 02420000
@NM00022 EQU   $TOTFLG1                                                 02421000
@NM00021 EQU   $TOTFLG1                                                 02422000
$CURELOD EQU   $TOTFLG1                                                 02423000
$CTEQTT  EQU   $TOTFLG1                                                 02424000
@NM00020 EQU   $TOTFLG1                                                 02425000
@NM00019 EQU   $TOTFLG1                                                 02426000
$LINESHR EQU   $TOTFLG1                                                 02427000
@NM00018 EQU   $OLTFLG2                                                 02428000
@NM00017 EQU   $OLTFLG2                                                 02429000
@NM00016 EQU   $OLTFLG2                                                 02430000
@NM00015 EQU   $OLTFLG2                                                 02431000
@NM00014 EQU   $OLTFLG2                                                 02432000
@NM00013 EQU   $OLTFLG2                                                 02433000
@NM00012 EQU   $OLTFLG2                                                 02434000
$TALK    EQU   $OLTFLG2                                                 02435000
$DYCOM   EQU   $OLTFLGS                                                 02436000
@NM00011 EQU   $OLTFLGS                                                 02437000
$TRACE   EQU   $OLTFLGS                                                 02438000
$RETCODE EQU   $OLTFLGS                                                 02439000
$CONTCB  EQU   $OLTFLGS                                                 02440000
$RETAIN  EQU   $OLTFLGS                                                 02441000
$CLEANRT EQU   $OLTFLGS                                                 02442000
$MANINTV EQU   $OLTFLGS                                                 02443000
$OLTSIZE EQU   $SCTTBLE+34                                              02444000
$QSCTMOD EQU   $EXECFLG                                                 02445000
$CTRLMOD EQU   $EXECFLG                                                 02446000
$CLEANUP EQU   $EXECFLG                                                 02447000
$LSTPDEV EQU   $EXECFLG                                                 02448000
$ERRCNT  EQU   $EXECFLG                                                 02449000
$MULTDEV EQU   $EXECFLG                                                 02450000
@NM00010 EQU   $EXECFLG                                                 02451000
$RMSKCNT EQU   $SCTTBLE+32                                              02452000
$SYNAME  EQU   $CDS8T19+4                                               02453000
$EXTSIG  EQU   $CDS8T19+3                                               02454000
$CDFLGS  EQU   $CDS8T19+1                                               02455000
$CDSCNT  EQU   $CDS8T19                                                 02456000
$PDEVDSC EQU   $SCTTBLE+16                                              02457000
$PDEVADR EQU   $SCTTBLE+12                                              02458000
$COMMCN  EQU   $CDSFLGS                                                 02459000
$CUSTSYM EQU   $CDSFLGS                                                 02460000
$TWOCHSW EQU   $CDSFLGS                                                 02461000
$SYMNAME EQU   $CDSFLGS                                                 02462000
$EXTINTC EQU   $CDSFLGS                                                 02463000
$CEVOL   EQU   $CDSFLGS                                                 02464000
$SHARED  EQU   $CDSFLGS                                                 02465000
$FPM     EQU   $CDSFLGS                                                 02466000
$LASTSUB EQU   $PDEVFLG                                                 02467000
@NM00009 EQU   $PDEVFLG                                                 02468000
@NM00008 EQU   $PDEVFLG                                                 02469000
@NM00007 EQU   $PDEVFLG                                                 02470000
$LASTDEV EQU   $PDEVFLG                                                 02471000
@NM00006 EQU   $PDEVFLG                                                 02472000
$EXFILPT EQU   $PDEVFLG                                                 02473000
$FPMOLD  EQU   $PDEVFLG                                                 02474000
$TSSSYM  EQU   $SCTTBLE+8                                               02475000
$SCTLEVL EQU   $SCTTBLE+7                                               02476000
$DRIVER  EQU   $SCTTBLE+6                                               02477000
$LOOPTST EQU   $ERROPT                                                  02478000
$LOOPERR EQU   $ERROPT                                                  02479000
$NERRPRT EQU   $ERROPT                                                  02480000
$NOCNTRL EQU   $ERROPT                                                  02481000
$ALTPRNT EQU   $ERROPT                                                  02482000
$CATERR  EQU   $ERROPT                                                  02483000
$ASTERIK EQU   $ERROPT                                                  02484000
$TESTERR EQU   $ERROPT                                                  02485000
$FSTCOMM EQU   $TESTOPT                                                 02486000
$INDEFLP EQU   $TESTOPT                                                 02487000
$NOPRT   EQU   $TESTOPT                                                 02488000
$PARAPRT EQU   $TESTOPT                                                 02489000
@NM00005 EQU   $TESTOPT                                                 02490000
$ERRLPCT EQU   $SCTTBLE                                                 02491000
$TLTEND  EQU   $RCAAREA+945                                             02492000
$CNSLID  EQU   $RCAAREA+936                                             02493000
$EXITSAV EQU   $RCAAREA+864                                             02494000
$TRASCII EQU   $RCAAREA+608                                             02495000
@NM00004 EQU   $RCAAREA+605                                             02496000
$VTAMEND EQU   $RCAFLG                                                  02497000
$TPPOSTD EQU   $RCAFLG                                                  02498000
$NEWCT   EQU   $RCAFLG                                                  02499000
$ABNDALL EQU   $RCAFLG                                                  02500000
$CONSOLE EQU   $RCAFLG                                                  02501000
$TPLOGON EQU   $RCAFLG                                                  02502000
$UPDATE  EQU   $RCAFLG                                                  02503000
$DEVAREA EQU   $RCAAREA+600                                             02504000
$CTDVAR  EQU   $RCAAREA+596                                             02505000
$BUFFS   EQU   $RCAAREA+464                                             02506000
$TLTNIB  EQU   $CONSTNT+140                                             02507000
$TLTPRPL EQU   $CONSTNT+20                                              02508000
@NM00003 EQU   $CONSTNT+4                                               02509000
@NM00002 EQU   $CONSTNT+2                                               02510000
$USECNT  EQU   $CONSTNT                                                 02511000
$CURRTWA EQU   $POINTER+140                                             02512000
$CTNAME  EQU   $POINTER+132                                             02513000
$CTARGX  EQU   $POINTER+128                                             02514000
$COMINT  EQU   $POINTER+120                                             02515000
$QUEHNDL EQU   $POINTER+116                                             02516000
@NM00001 EQU   $POINTER+36                                              02517000
$RTNPTR  EQU   $POINTER+32                                              02518000
$TLTECB2 EQU   $POINTER+28                                              02519000
$TLTECB1 EQU   $POINTER+24                                              02520000
$CLEANP  EQU   $POINTER+20                                              02521000
$ABEND   EQU   $POINTER+16                                              02522000
$LSTAREA EQU   $POINTER+12                                              02523000
$FSTAREA EQU   $POINTER+8                                               02524000
$CVTSAVE EQU   $POINTER+4                                               02525000
$TOLTEP  EQU   $POINTER                                                 02526000
$TLTACB  EQU   $RCAAREA                                                 02527000
.@UNREFD ANOP                          END UNREFERENCED COMPONENTS      02528000
@RT00068 EQU   CECTST05                                                 02529000
@RT00108 EQU   CECTST12                                                 02530000
@RT00160 EQU   CECTST19                                                 02531000
@RT00169 EQU   CECTST20                                                 02532000
@RT00176 EQU   CECTST26                                                 02533000
@RT00206 EQU   CECTST24                                                 02534000
@RT00215 EQU   CECTST26                                                 02535000
@RT00219 EQU   CECTST22                                                 02536000
@RT00237 EQU   CECTST28                                                 02537000
@RT00250 EQU   CECTST2B                                                 02538000
@RT00252 EQU   CECTST06                                                 02539000
@RT00263 EQU   CECTST34                                                 02540000
@RT00265 EQU   CECTST31                                                 02541000
@RT00279 EQU   CECTST33                                                 02542000
@RT00281 EQU   CECTST30                                                 02543000
@RT00298 EQU   CECTST30                                                 02544000
@RT00300 EQU   CECTST32                                                 02545000
@RT00302 EQU   CECTST03                                                 02546000
@RT00311 EQU   CECTST99                                                 02547000
@RT00313 EQU   CECTST03                                                 02548000
@RT00330 EQU   CECTST37                                                 02549000
@RT00341 EQU   CECTST03                                                 02550000
@RT00347 EQU   CECTST40                                                 02551000
@RT00356 EQU   CECTST41                                                 02552000
@RT00364 EQU   CECTST43                                                 02553000
@RT00366 EQU   CECTST59                                                 02554000
@RT00373 EQU   CECTST50                                                 02555000
@RT00375 EQU   CECTST46                                                 02556000
@RT00381 EQU   CECTST45                                                 02557000
@RT00390 EQU   CECTST75                                                 02558000
@RT00398 EQU   CECTST53                                                 02559000
@RT00404 EQU   CECTST51                                                 02560000
@RT00412 EQU   CECTST62                                                 02561000
@RT00428 EQU   CECTST55                                                 02562000
@RT00432 EQU   CECTST99                                                 02563000
CECTST56 EQU   CECTST03                                                 02564000
@RT00444 EQU   CECTST53                                                 02565000
@RT00450 EQU   CECTST61                                                 02566000
@RT00466 EQU   CECTST03                                                 02567000
@RT00471 EQU   CECTST68                                                 02568000
@RT00479 EQU   CECTST69                                                 02569000
@RT00486 EQU   CECTST72                                                 02570000
@RT00492 EQU   CECTST03                                                 02571000
@RT00499 EQU   CECTST75                                                 02572000
@RT00506 EQU   CECTST03                                                 02573000
@RT00509 EQU   CECTST70                                                 02574000
@RF00534 EQU   CECTST58                                                 02575000
@RT00554 EQU   CECTST83                                                 02576000
@RT00556 EQU   CECTST79                                                 02577000
@ENDDATA EQU   *                                                        02578000
         END   ISTIC004,(C'PLS1237',0702,78336)                         02579000
./  ADD  SSI=83360137,NAME=ISTIC005
         TITLE 'ISTIC005-OPTION DECODE'                                 00001000
ISTIC005 CSECT ,                                                   0001 00002000
@MAINENT DS    0H                                                  0001 00003000
         USING *,@15                                               0001 00004000
         B     @PROLOG                                             0001 00005000
         DC    AL1(16)                                             0001 00006000
         DC    C'ISTIC005  78.336'                                 0001 00007000
         DROP  @15                                                      00008000
@PROLOG  STM   @14,@12,12(@13)                                     0001 00009000
         BALR  @12,0                                               0001 00010000
@PSTART  DS    0H                                                  0001 00011000
         USING @PSTART,@12                                         0001 00012000
*   R3=R13;                                                        0046 00013000
         LR    R3,R13                                              0046 00014000
*   R13=ADDR(SVEIC003);                                            0047 00015000
         LA    R13,SVEIC003(,WAPTR)                                0047 00016000
*   BACKSAVE(3)=R13;                                               0048 00017000
         ST    R13,BACKSAVE+8(,R3)                                 0048 00018000
*   SVEIC003(2)=R3;                                                0049 00019000
         ST    R3,SVEIC003+4(,WAPTR)                               0049 00020000
*   OPTS=A33OPTN;                   /* MOVE OPTIONS TO WORK          */ 00021000
         MVC   OPTS(44),A33OPTN                                    0050 00022000
*   IF $OPTMSG='1'B THEN            /* OPTION MSG REQUESTED ?        */ 00023000
         TM    $OPTMSG(WAPTR),B'10000000'                          0051 00024000
         BNO   @RF00051                                            0051 00025000
*     DO;                           /* SET UP OPTIONS ARE MSG        */ 00026000
*       EBTL='N';                                                  0053 00027000
         MVI   EBTL,C'N'                                           0053 00028000
*       IF $LOOPTST='1'B THEN       /* TEST LOOP (TL)                */ 00029000
         TM    $LOOPTST(WAPTR),B'00000001'                         0054 00030000
         BNO   @RF00054                                            0054 00031000
*         EBTL=' ';                                                0055 00032000
         MVI   EBTL,C' '                                           0055 00033000
*       EBEL='N';                                                  0056 00034000
@RF00054 MVI   EBEL,C'N'                                           0056 00035000
*       IF $LOOPERR='1'B THEN       /* ERROR LOOP (EL)               */ 00036000
         TM    $LOOPERR(WAPTR),B'00000010'                         0057 00037000
         BNO   @RF00057                                            0057 00038000
*         EBEL=' ';                                                0058 00039000
         MVI   EBEL,C' '                                           0058 00040000
*       EBPP='N';                                                  0059 00041000
@RF00057 MVI   EBPP,C'N'                                           0059 00042000
*       IF $ALTPRNT='1'B THEN       /* PARALLEL PRINT (PP)           */ 00043000
         TM    $ALTPRNT(WAPTR),B'00010000'                         0060 00044000
         BNO   @RF00060                                            0060 00045000
*         EBPP=' ';                                                0061 00046000
         MVI   EBPP,C' '                                           0061 00047000
*       EBFE='N';                                                  0062 00048000
@RF00060 MVI   EBFE,C'N'                                           0062 00049000
*       IF $FSTCOMM='1'B THEN       /* FIRST ERROR COMM. (FE)        */ 00050000
         TM    $FSTCOMM(WAPTR),B'00000001'                         0063 00051000
         BNO   @RF00063                                            0063 00052000
*         EBFE=' ';                                                0064 00053000
         MVI   EBFE,C' '                                           0064 00054000
*       EBMI='N';                                                  0065 00055000
@RF00063 MVI   EBMI,C'N'                                           0065 00056000
*       IF $MANINTV='1'B THEN       /* MANUAL INTERVENT (MI)         */ 00057000
         TM    $MANINTV(WAPTR),B'10000000'                         0066 00058000
         BNO   @RF00066                                            0066 00059000
*         EBMI=' ';                                                0067 00060000
         MVI   EBMI,C' '                                           0067 00061000
*       EBEP='N';                                                  0068 00062000
@RF00066 MVI   EBEP,C'N'                                           0068 00063000
*       IF $NERRPRT='0'B THEN       /* ERROR PRINT (EP)              */ 00064000
         TM    $NERRPRT(WAPTR),B'00000100'                         0069 00065000
         BNZ   @RF00069                                            0069 00066000
*         EBEP=' ';                                                0070 00067000
         MVI   EBEP,C' '                                           0070 00068000
*       EBCP='N';                                                  0071 00069000
@RF00069 MVI   EBCP,C'N'                                           0071 00070000
*       IF $NOCNTRL='1'B THEN       /* CONTROL PRINT (CP)            */ 00071000
         TM    $NOCNTRL(WAPTR),B'00001000'                         0072 00072000
         BNO   @RF00072                                            0072 00073000
*         EBCP=' ';                                                0073 00074000
         MVI   EBCP,C' '                                           0073 00075000
*       EBPR='N';                                                  0074 00076000
@RF00072 MVI   EBPR,C'N'                                           0074 00077000
*       IF $NOPRT='1'B THEN         /* PRINT (PR)                    */ 00078000
         TM    $NOPRT(WAPTR),B'00000100'                           0075 00079000
         BNO   @RF00075                                            0075 00080000
*         EBPR=' ';                                                0076 00081000
         MVI   EBPR,C' '                                           0076 00082000
*       EBTR='N';                                                  0077 00083000
@RF00075 MVI   EBTR,C'N'                                           0077 00084000
*       IF $TRACE='1'B THEN         /* TRACE (TR)                    */ 00085000
         TM    $TRACE(WAPTR),B'00000100'                           0078 00086000
         BNO   @RF00078                                            0078 00087000
*         EBTR=' ';                                                0079 00088000
         MVI   EBTR,C' '                                           0079 00089000
*       EBAP='N';                                                  0080 00090000
@RF00078 MVI   EBAP,C'N'                                           0080 00091000
*       IF $ALTPRTR='1'B THEN       /* ALTERNATE PRINT (AP)          */ 00092000
         TM    $ALTPRTR(WAPTR),B'00000010'                         0081 00093000
         BNO   @RF00081                                            0081 00094000
*         EBAP=' ';                                                0082 00095000
         MVI   EBAP,C' '                                           0082 00096000
*       $INBUFR(1:43)=OPTS;         /* MOVE OPTIONS FOR CECOM        */ 00097000
*                                                                  0083 00098000
@RF00081 MVC   $INBUFR(43,WAPTR),OPTS                              0083 00099000
*       /*************************************************************/ 00100000
*       /*                                                           */ 00101000
*       /* TCEC MSGN(107)SUB(YES) INVOKED                            */ 00102000
*       /*                                                           */ 00103000
*       /*************************************************************/ 00104000
*                                                                  0084 00105000
*       $TCECM='1'B;                /* SET TCEC SW IN RCA            */ 00106000
         OI    $TCECM(WAPTR),B'00000001'                           0084 00107000
*       R1=ADDR($TCA09);            /* SET UP PARM LIST $TR          */ 00108000
         LA    R1,$TCA09                                           0085 00109000
*       CALL #EXIT;                 /* CALL CECOM                    */ 00110000
         L     @15,#EXITA(,WAPTR)                                  0086 00111000
         BALR  @14,@15                                             0086 00112000
*       DCL                                                        0087 00113000
*         1 $TCA09,                 /* TCEC PARM LIST                */ 00114000
*          2 $TCB09 FIXED(32) INIT(107),/* MSG NUMBER                */ 00115000
*          2 $TCC09 FIXED(32) INIT(0),/* INCT LEN                    */ 00116000
*          2 $TCD09 BIT(8) INIT('10000000'B),/* FLAG                 */ 00117000
*          2 $TCE09 CHAR(4) INIT('FFFFFFFF'X);/* MSSAGE MASK ISSUE 0087 00118000
*                                      OPTIONS ARE ....              */ 00119000
*       R3=$EXTA(1);                /* GET EXTERNAL DATA SIZE        */ 00120000
         SLR   R3,R3                                               0088 00121000
         IC    R3,$EXTA(,WAPTR)                                    0088 00122000
*       IF R3¬=0 THEN               /* IF EXT= HAS BEEN ENTER        */ 00123000
         LTR   R3,R3                                               0089 00124000
         BZ    @RF00089                                            0089 00125000
*         DO;                       /* THEN SET UP TO WRITE NS       */ 00126000
*           R4=R3+1;                                               0091 00127000
         LA    R4,1                                                0091 00128000
         ALR   R4,R3                                               0091 00129000
*           $INBUFR(1:54)='';                                      0092 00130000
         MVI   $INBUFR(WAPTR),C' '                                 0092 00131000
         MVC   $INBUFR+1(53,WAPTR),$INBUFR(WAPTR)                  0092 00132000
*           $INBUFR(1:R3)=$EXTA(2:R4);                             0093 00133000
*                                                                  0093 00134000
         LR    @14,R3                                              0093 00135000
         BCTR  @14,0                                               0093 00136000
         EX    @14,@SM00860                                        0093 00137000
*           /*********************************************************/ 00138000
*           /*                                                       */ 00139000
*           /* TCEC MSGN(327)SUB(YES) INVOKED                        */ 00140000
*           /*                                                       */ 00141000
*           /*********************************************************/ 00142000
*                                                                  0094 00143000
*           $TCECM='1'B;            /* SET TCEC SW IN RCA            */ 00144000
         OI    $TCECM(WAPTR),B'00000001'                           0094 00145000
*           R1=ADDR($TCA10);        /* SET UP PARM LIST $TR          */ 00146000
         LA    R1,$TCA10                                           0095 00147000
*           CALL #EXIT;             /* CALL CECOM                    */ 00148000
         L     @15,#EXITA(,WAPTR)                                  0096 00149000
         BALR  @14,@15                                             0096 00150000
*           DCL                                                    0097 00151000
*             1 $TCA10,             /* TCEC PARM LIST                */ 00152000
*              2 $TCB10 FIXED(32) INIT(327),/* MSG NUMBER            */ 00153000
*              2 $TCC10 FIXED(32) INIT(0),/* INCT LEN                */ 00154000
*              2 $TCD10 BIT(8) INIT('10000000'B),/* FLAG             */ 00155000
*              2 $TCE10 CHAR(4) INIT('FFFFFFFF'X);/* MSSAGE MASK   0097 00156000
*                                      ISSUE EXT= MSG                */ 00157000
*         END;                                                     0098 00158000
*       $OPTMSG='0'B;               /* RESET OPT MESSAGE SWT         */ 00159000
@RF00089 NI    $OPTMSG(WAPTR),B'01111111'                          0099 00160000
*       GO TO OPT900;                                              0100 00161000
         B     OPT900                                              0100 00162000
*     END;                                                         0101 00163000
*   R3=$SLASHAD(2)+1;               /* PT TO 1ST CHAR OF OPTS        */ 00164000
@RF00051 LA    R3,1                                                0102 00165000
         AL    R3,$SLASHAD+4(,WAPTR)                               0102 00166000
*   IF R3=$SLASHAD(3) THEN          /* SLASH ENTERED ?               */ 00167000
         C     R3,$SLASHAD+8(,WAPTR)                               0103 00168000
         BE    @RT00103                                            0103 00169000
*     GO TO OPT900;                                                0104 00170000
*   A33SAVE=A33SAVE&&A33SAVE;       /* CLEAR SAVE AREA               */ 00171000
         XC    A33SAVE(11),A33SAVE                                 0105 00172000
*   A33SAVE(1)=$TESTOPT;            /* SAVE                          */ 00173000
         MVC   A33SAVE(1),$TESTOPT(WAPTR)                          0106 00174000
*   A33SAVE(2)=$ERROPT;             /* OLD                           */ 00175000
         MVC   A33SAVE+1(1),$ERROPT(WAPTR)                         0107 00176000
*   A33SAVE(3)=$EXECFLG;            /* OPTIONS                       */ 00177000
         MVC   A33SAVE+2(1),$EXECFLG(WAPTR)                        0108 00178000
*   A33SAVE(4)=$OLTFLGS;            /* AND                           */ 00179000
         MVC   A33SAVE+3(1),$OLTFLGS(WAPTR)                        0109 00180000
*   A33SAVE(5)=$PRNTLVL;            /* CONSTANTS                     */ 00181000
         MVC   A33SAVE+4(1),$PRNTLVL(WAPTR)                        0110 00182000
*   A33SAVE(6:7)=$ERRCNTA;          /*                               */ 00183000
         MVC   A33SAVE+5(2),$ERRCNTA(WAPTR)                        0111 00184000
*   A33SAVE(8:9)=$TLCNT;                                           0112 00185000
         MVC   A33SAVE+7(2),$TLCNT(WAPTR)                          0112 00186000
*   A33SAVE(10)=$FLAG9;                                            0113 00187000
         MVC   A33SAVE+9(1),$FLAG9(WAPTR)                          0113 00188000
*   INTFLAGS=INTFLAGS&&INTFLAGS;    /* INIT INTERNAL FLAGS           */ 00189000
         XC    INTFLAGS(1),INTFLAGS                                0114 00190000
*                                                                  0115 00191000
*   /*****************************************************************/ 00192000
*   /*                                                               */ 00193000
*   /* DECODE OPTION FIELD                                           */ 00194000
*   /*                                                               */ 00195000
*   /*****************************************************************/ 00196000
*                                                                  0115 00197000
*OPT050:                                                           0115 00198000
*   NO='0'B;                        /* SET NEGATIVE OPT FLAG         */ 00199000
OPT050   NI    NO,B'01111111'                                      0115 00200000
*   IF INPUTBUF(1)='N' THEN         /* CHK 1ST CHAR= N               */ 00201000
         CLI   INPUTBUF(R3),C'N'                                   0116 00202000
         BNE   @RF00116                                            0116 00203000
*     DO;                                                          0117 00204000
*       NO='1'B;                    /* YES SET FLAG ON               */ 00205000
         OI    NO,B'10000000'                                      0118 00206000
*       R3=R3+1;                    /* PT TO OPTION                  */ 00207000
         AL    R3,@CF00072                                         0119 00208000
*     END;                                                         0120 00209000
*   IF INPUTBUF(1:2)='TL' THEN      /* TEST LOOP SPECIFIED           */ 00210000
@RF00116 CLC   INPUTBUF(2,R3),@CC00763                             0121 00211000
         BNE   @RF00121                                            0121 00212000
*     DO;                           /* YES                           */ 00213000
*       IF NO='0'B THEN             /* NTL SPECIFIED                 */ 00214000
         TM    NO,B'10000000'                                      0123 00215000
         BZ    @RT00123                                            0123 00216000
*         GO TO OPT300;             /* NO,PROCESS TL                 */ 00217000
*       $LOOPTST='0'B;              /* TURN TL OFF                   */ 00218000
         NI    $LOOPTST(WAPTR),B'11111110'                         0125 00219000
*       $TLCNT=1;                   /* INITIALIZE COUNT              */ 00220000
         MVC   $TLCNT(2,WAPTR),@CH00072                            0126 00221000
*       GO TO OPT070;               /* SET UP TO DECODE NEXT         */ 00222000
         B     OPT070                                              0127 00223000
*     END;                                                         0128 00224000
*   IF INPUTBUF(1:2)='EL' THEN      /* ERROR LOOP SPECIFIED          */ 00225000
@RF00121 CLC   INPUTBUF(2,R3),@CC00766                             0129 00226000
         BNE   @RF00129                                            0129 00227000
*     DO;                           /* YES                           */ 00228000
*       IF NO='0'B THEN             /* NEL SPECIFIED                 */ 00229000
         TM    NO,B'10000000'                                      0131 00230000
         BZ    @RT00131                                            0131 00231000
*         GO TO OPT200;             /* NO,PROCESS EL                 */ 00232000
*       $LOOPERR='0'B;              /* TURN EL OFF                   */ 00233000
         NI    $LOOPERR(WAPTR),B'11111101'                         0133 00234000
*       GO TO OPT070;               /* SET UP TO DECODE NEXT         */ 00235000
         B     OPT070                                              0134 00236000
*     END;                                                         0135 00237000
*   IF INPUTBUF(1:2)='PP' THEN      /* PARALLEL PRINT SPECIFED       */ 00238000
@RF00129 CLC   INPUTBUF(2,R3),@CC00768                             0136 00239000
         BNE   @RF00136                                            0136 00240000
*     DO;                           /* YES                           */ 00241000
*       IF NO='0'B THEN             /* NPP SPECIFIED                 */ 00242000
         TM    NO,B'10000000'                                      0138 00243000
         BZ    @RT00138                                            0138 00244000
*         GO TO OPT100;             /* NO PROCESS PP                 */ 00245000
*       $ALTPRNT='0'B;              /* TURN OFF PP                   */ 00246000
         NI    $ALTPRNT(WAPTR),B'11101111'                         0140 00247000
*       GO TO OPT070;               /* SET UP TO DECODE NEXT         */ 00248000
         B     OPT070                                              0141 00249000
*     END;                                                         0142 00250000
*   IF INPUTBUF(1:2)='AP'&$OLTACT='0'B THEN/* ALTERNATE PRINTER      */ 00251000
@RF00136 CLC   INPUTBUF(2,R3),@CC00770                             0143 00252000
         BNE   @RF00143                                            0143 00253000
         TM    $OLTACT(WAPTR),B'00000001'                          0143 00254000
         BNZ   @RF00143                                            0143 00255000
*     DO;                           /* YES                           */ 00256000
*       GO TO OPT400;                                              0145 00257000
         B     OPT400                                              0145 00258000
*     END;                                                         0146 00259000
*   IF INPUTBUF(1:2)='FE' THEN      /* FIRST ERROR COMM              */ 00260000
@RF00143 CLC   INPUTBUF(2,R3),@CC00772                             0147 00261000
         BNE   @RF00147                                            0147 00262000
*     DO;                           /* YES                           */ 00263000
*       $FSTCOMM='0'B;              /* SET NFE                       */ 00264000
         NI    $FSTCOMM(WAPTR),B'11111110'                         0149 00265000
*       IF NO='0'B THEN             /* FE SPECIFIED                  */ 00266000
         TM    NO,B'10000000'                                      0150 00267000
         BNZ   @RF00150                                            0150 00268000
*         $FSTCOMM='1'B;            /* YES                           */ 00269000
         OI    $FSTCOMM(WAPTR),B'00000001'                         0151 00270000
*       GO TO OPT070;               /* DECODE NEXT                   */ 00271000
         B     OPT070                                              0152 00272000
*     END;                                                         0153 00273000
*   IF INPUTBUF(1:2)='MI' THEN      /* MANUAL INTERVENTION           */ 00274000
@RF00147 CLC   INPUTBUF(2,R3),@CC00773                             0154 00275000
         BNE   @RF00154                                            0154 00276000
*     DO;                           /* YES                           */ 00277000
*       $MANINTV='0'B;              /* SET NMI                       */ 00278000
         NI    $MANINTV(WAPTR),B'01111111'                         0156 00279000
*       IF NO='0'B THEN             /* MI SPECIFIED                  */ 00280000
         TM    NO,B'10000000'                                      0157 00281000
         BNZ   @RF00157                                            0157 00282000
*         $MANINTV='1'B;            /* YES                           */ 00283000
         OI    $MANINTV(WAPTR),B'10000000'                         0158 00284000
*       GO TO OPT070;               /* DECODE NEXT                   */ 00285000
         B     OPT070                                              0159 00286000
*     END;                                                         0160 00287000
*   IF INPUTBUF(1:2)='EP' THEN      /* ERROR PRINT                   */ 00288000
@RF00154 CLC   INPUTBUF(2,R3),@CC00774                             0161 00289000
         BNE   @RF00161                                            0161 00290000
*     DO;                           /* YES                           */ 00291000
*       $NERRPRT='1'B;              /* SET NEP                       */ 00292000
         OI    $NERRPRT(WAPTR),B'00000100'                         0163 00293000
*       IF NO='0'B THEN             /* EP SPECIFIED                  */ 00294000
         TM    NO,B'10000000'                                      0164 00295000
         BNZ   @RF00164                                            0164 00296000
*         $NERRPRT='0'B;            /* YES                           */ 00297000
         NI    $NERRPRT(WAPTR),B'11111011'                         0165 00298000
*       GO TO OPT070;               /* DECODE NEXT                   */ 00299000
         B     OPT070                                              0166 00300000
*     END;                                                         0167 00301000
*   IF INPUTBUF(1:2)='CP' THEN      /* CONTROL PRINT                 */ 00302000
@RF00161 CLC   INPUTBUF(2,R3),@CC00775                             0168 00303000
         BNE   @RF00168                                            0168 00304000
*     DO;                           /* YES                           */ 00305000
*       $NOCNTRL='0'B;              /* SET NCP                       */ 00306000
         NI    $NOCNTRL(WAPTR),B'11110111'                         0170 00307000
*       IF NO='0'B THEN             /* CP SPECIFIED                  */ 00308000
         TM    NO,B'10000000'                                      0171 00309000
         BNZ   @RF00171                                            0171 00310000
*         $NOCNTRL='1'B;            /* YES                           */ 00311000
         OI    $NOCNTRL(WAPTR),B'00001000'                         0172 00312000
*       GO TO OPT070;               /* DECODE NEXT                   */ 00313000
         B     OPT070                                              0173 00314000
*     END;                                                         0174 00315000
*   IF INPUTBUF(1:2)='PR' THEN      /* PRINT                         */ 00316000
@RF00168 CLC   INPUTBUF(2,R3),@CC00776                             0175 00317000
         BNE   @RF00175                                            0175 00318000
*     DO;                           /* YES                           */ 00319000
*       $NOPRT='0'B;                /* SET NPR                       */ 00320000
         NI    $NOPRT(WAPTR),B'11111011'                           0177 00321000
*       IF NO='0'B THEN             /* PR SPECIFIED                  */ 00322000
         TM    NO,B'10000000'                                      0178 00323000
         BNZ   @RF00178                                            0178 00324000
*         $NOPRT='1'B;              /* YES                           */ 00325000
         OI    $NOPRT(WAPTR),B'00000100'                           0179 00326000
*       GO TO OPT070;               /* DECODE NEXT                   */ 00327000
         B     OPT070                                              0180 00328000
*     END;                                                         0181 00329000
*   IF INPUTBUF(1:2)='TR' THEN      /* TRACE                         */ 00330000
@RF00175 CLC   INPUTBUF(2,R3),@CC00777                             0182 00331000
         BNE   @RF00182                                            0182 00332000
*     DO;                           /* YES                           */ 00333000
*       $TRACE='0'B;                /* SET NTR                       */ 00334000
         NI    $TRACE(WAPTR),B'11111011'                           0184 00335000
*       IF NO='0'B THEN             /* TR SPECIFIED                  */ 00336000
         TM    NO,B'10000000'                                      0185 00337000
         BNZ   @RF00185                                            0185 00338000
*         $TRACE='1'B;              /* YES                           */ 00339000
         OI    $TRACE(WAPTR),B'00000100'                           0186 00340000
*       GO TO OPT070;               /* DECODE NEXT                   */ 00341000
         B     OPT070                                              0187 00342000
*     END;                                                         0188 00343000
*   IF INPUTBUF(1:4)='EXT=' THEN    /* EXTERNAL DATA                 */ 00344000
@RF00182 CLC   INPUTBUF(4,R3),@CC00778                             0189 00345000
         BNE   @RF00189                                            0189 00346000
*     DO;                           /* YES                           */ 00347000
*       R3=R3+4;                    /* POINT TO DATA                 */ 00348000
         AL    R3,@CF00068                                         0191 00349000
*       IF INPUTBUF(1)='/' THEN     /* END OF OPTION FIELD           */ 00350000
         CLI   INPUTBUF(R3),C'/'                                   0192 00351000
         BNE   @RF00192                                            0192 00352000
*         DO;                       /* YES,CONTINUE                  */ 00353000
*           $EXTA=$EXTA&&$EXTA;     /* INIT EXTERNAL DATA AREA       */ 00354000
         XC    $EXTA(56,WAPTR),$EXTA(WAPTR)                        0194 00355000
*           GO TO OPT080;           /* CHECK FOR END OF FIELD        */ 00356000
         B     OPT080                                              0195 00357000
*         END;                                                     0196 00358000
*       R4=$SLASHAD(3)-R3;          /* CALCULATE LENGTH              */ 00359000
@RF00192 L     R4,$SLASHAD+8(,WAPTR)                               0197 00360000
         SLR   R4,R3                                               0197 00361000
*       IF R4<1|                    /* CHECK FOR                     */ 00362000
*           R4>54 THEN              /* VALID LENGTH                  */ 00363000
         LA    @14,1                                               0198 00364000
         CR    R4,@14                                              0198 00365000
         BL    @RT00198                                            0198 00366000
         C     R4,@CF00752                                         0198 00367000
         BH    @RT00198                                            0198 00368000
*         GO TO OPT800;             /* INVALID LENGTH                */ 00369000
*       $EXTA=$EXTA&&$EXTA;         /* CLEAR AREA                    */ 00370000
         XC    $EXTA(56,WAPTR),$EXTA(WAPTR)                        0200 00371000
*       EXTNUMFX=R4;                /* MOVE COUNT                    */ 00372000
         ST    R4,EXTNUMFX                                         0201 00373000
*       $EXTA(1)=EXTNUMCH;          /* INTO FIRST BYTE               */ 00374000
         MVC   $EXTA(1,WAPTR),EXTNUMCH                             0202 00375000
*       R4=R4+1;                    /* ADD 1 FOR SUBSCRIPT           */ 00376000
         ALR   R4,@14                                              0203 00377000
*       $EXTA(2:R4)=INPUTBUF;       /* MOVE IN DATA                  */ 00378000
         LR    @14,R4                                              0204 00379000
         BCTR  @14,0                                               0204 00380000
         BCTR  @14,0                                               0204 00381000
         EX    @14,@SM00870                                        0204 00382000
*       R3=R3+EXTNUMFX;                                            0205 00383000
         L     @14,EXTNUMFX                                        0205 00384000
         ALR   R3,@14                                              0205 00385000
*       GO TO OPT080;               /* CHK FOR MUTALLY EXCL          */ 00386000
         B     OPT080                                              0206 00387000
*     END;                                                         0207 00388000
*   R3=R3+1;                        /* PT TO INVALID OPTION          */ 00389000
@RF00189 AL    R3,@CF00072                                         0208 00390000
*   GO TO OPT800;                   /* ERROR,INVALID OPTION          */ 00391000
         B     OPT800                                              0209 00392000
*OPT070:                                                           0210 00393000
*   R3=R3+2;                        /* PT TO NEXT ENTRY              */ 00394000
OPT070   AL    R3,@CF00139                                         0210 00395000
*OPT075:                                                           0211 00396000
*   IF INPUTBUF(1)=',' THEN         /* IS IT A COMMA                 */ 00397000
OPT075   CLI   INPUTBUF(R3),C','                                   0211 00398000
         BNE   @RF00211                                            0211 00399000
*     DO;                                                          0212 00400000
*       R3=R3+1;                    /* PT TO NEXT OPTION             */ 00401000
         AL    R3,@CF00072                                         0213 00402000
*       GO TO OPT050;               /* DEODE NEXT ENTRY              */ 00403000
         B     OPT050                                              0214 00404000
*     END;                                                         0215 00405000
*OPT080:                                                           0216 00406000
*   IF INPUTBUF(1)='/' THEN         /* END OF OPT FIELD              */ 00407000
@RF00211 DS    0H                                                  0216 00408000
OPT080   CLI   INPUTBUF(R3),C'/'                                   0216 00409000
         BE    @RT00216                                            0216 00410000
*     GO TO OPT900;                 /* YES,RETURN                    */ 00411000
*   GO TO OPT800;                   /* NO,ERROR                      */ 00412000
         B     OPT800                                              0218 00413000
*                                                                  0219 00414000
*   /*****************************************************************/ 00415000
*   /*                                                               */ 00416000
*   /* PP OPTION ENTRY                                               */ 00417000
*   /*                                                               */ 00418000
*   /*****************************************************************/ 00419000
*                                                                  0219 00420000
*OPT100:                                                           0219 00421000
*   $ALTPRNT='1'B;                  /* SET PARALLEL PRINT            */ 00422000
OPT100   OI    $ALTPRNT(WAPTR),B'00010000'                         0219 00423000
*   $PRNTLVL='2';                   /* SET DEFAULT LEVEL             */ 00424000
         MVI   $PRNTLVL(WAPTR),C'2'                                0220 00425000
*   IF INPUTBUF(3)='(' THEN         /* WILL PRNT LVL BE SPEC ?       */ 00426000
         CLI   INPUTBUF+2(R3),C'('                                 0221 00427000
         BNE   @RF00221                                            0221 00428000
*     DO;                                                          0222 00429000
*       IF INPUTBUF(4)<'0'|         /* YES                           */ 00430000
*           INPUTBUF(4)>'3' THEN    /* CHK HIGH-LOW LEGAL RNGE       */ 00431000
         CLI   INPUTBUF+3(R3),C'0'                                 0223 00432000
         BL    @RT00223                                            0223 00433000
         CLI   INPUTBUF+3(R3),C'3'                                 0223 00434000
         BNH   @RF00223                                            0223 00435000
@RT00223 DS    0H                                                  0224 00436000
*         DO;                                                      0224 00437000
*           R3=R3+3;                /* ERROR                         */ 00438000
         AL    R3,@CF00081                                         0225 00439000
*           GO TO OPT800;                                          0226 00440000
         B     OPT800                                              0226 00441000
*         END;                                                     0227 00442000
*       $PRNTLVL=INPUTBUF(4);       /* MOVE PRNT LEVEL TO TWA        */ 00443000
@RF00223 MVC   $PRNTLVL(1,WAPTR),INPUTBUF+3(R3)                    0228 00444000
*OPT150:                                                           0229 00445000
*       IF INPUTBUF(5)¬=')' THEN    /* CHK SYNTAX                    */ 00446000
OPT150   CLI   INPUTBUF+4(R3),C')'                                 0229 00447000
         BE    @RF00229                                            0229 00448000
*         DO;                                                      0230 00449000
*           R3=R3+4;                /* ERROR                         */ 00450000
         AL    R3,@CF00068                                         0231 00451000
*           GO TO OPT800;                                          0232 00452000
         B     OPT800                                              0232 00453000
*         END;                                                     0233 00454000
*       R3=R3+5;                    /* PT TO , OR /                  */ 00455000
@RF00229 AL    R3,@CF00350                                         0234 00456000
*       GO TO OPT075;                                              0235 00457000
         B     OPT075                                              0235 00458000
*     END;                                                         0236 00459000
*   GO TO OPT070;                   /* GO CHK IT                     */ 00460000
         B     OPT070                                              0237 00461000
*                                                                  0238 00462000
*   /*****************************************************************/ 00463000
*   /*                                                               */ 00464000
*   /* EL OPTION ENTRY                                               */ 00465000
*   /*                                                               */ 00466000
*   /*****************************************************************/ 00467000
*                                                                  0238 00468000
*OPT200:                                                           0238 00469000
*   $LOOPERR='1'B;                  /* SET EL BIT ON                 */ 00470000
OPT200   OI    $LOOPERR(WAPTR),B'00000010'                         0238 00471000
*   $ERRCNT='0'B;                   /* TURN OFF COUNT GIVEN          */ 00472000
         NI    $ERRCNT(WAPTR),B'11101111'                          0239 00473000
*   IF INPUTBUF(3)='(' THEN         /* COUNT SPECIFIED ?             */ 00474000
         CLI   INPUTBUF+2(R3),C'('                                 0240 00475000
         BNE   @RF00240                                            0240 00476000
*     DO;                                                          0241 00477000
*       IF INPUTBUF(4)='I' THEN     /* INDEFINITE LOOP               */ 00478000
         CLI   INPUTBUF+3(R3),C'I'                                 0242 00479000
         BNE   @RF00242                                            0242 00480000
*         DO;                       /* YES                           */ 00481000
*           $INDEFLP='1'B;          /* TURN ON SWITCH                */ 00482000
         OI    $INDEFLP(WAPTR),B'00000010'                         0244 00483000
*           GO TO OPT150;           /* GO CHK LEFT PAREN             */ 00484000
         B     OPT150                                              0245 00485000
*         END;                                                     0246 00486000
*       R3=R3+3;                    /* PT TO NUMBER                  */ 00487000
@RF00242 AL    R3,@CF00081                                         0247 00488000
*       GEN(BAL  R11,OPT350);       /* CONVERT NUMBER                */ 00489000
         BAL  R11,OPT350                                                00490000
*       IF HEXNUM=0 THEN            /* LOOP CNT=0                    */ 00491000
         L     @14,HEXNUM                                          0249 00492000
         LTR   @14,@14                                             0249 00493000
         BNZ   @RF00249                                            0249 00494000
*         DO;                       /* YES,CONTINUE                  */ 00495000
*           $LOOPERR='0'B;          /* SET ERROR LOOP OFF            */ 00496000
         NI    $LOOPERR(WAPTR),B'11111101'                         0251 00497000
*           GO TO OPT075;           /* CONTINUE DECODING             */ 00498000
         B     OPT075                                              0252 00499000
*         END;                                                     0253 00500000
*       $ERRCNTA=HEXNUM;            /* STORE COUNT FOR OLT           */ 00501000
@RF00249 L     @14,HEXNUM                                          0254 00502000
         STH   @14,$ERRCNTA(,WAPTR)                                0254 00503000
*       $ERRLPCT=$ERRCNTA;          /* PUT IN SCT ALSO               */ 00504000
         STH   @14,$ERRLPCT(,WAPTR)                                0255 00505000
*       $ERRCNT='1'B;               /* SET COUNT GIVEN BIT           */ 00506000
         OI    $ERRCNT(WAPTR),B'00010000'                          0256 00507000
*       $INDEFLP='0'B;              /* RESET INDEFINITE LOOP         */ 00508000
         NI    $INDEFLP(WAPTR),B'11111101'                         0257 00509000
*       GO TO OPT075;               /* DECODE NEXT CHAR              */ 00510000
         B     OPT075                                              0258 00511000
*     END;                                                         0259 00512000
*   $ERRLPCT=$COUNT;                /* USE OLT DEFAULT               */ 00513000
@RF00240 L     @14,$LOWADDR(,WAPTR)                                0260 00514000
         LH    @10,RTNDISP(,@14)                                   0260 00515000
         ALR   @10,@14                                             0260 00516000
         LH    @14,$COUNT(,@10)                                    0260 00517000
         N     @14,@CF00874                                        0260 00518000
         STH   @14,$ERRLPCT(,WAPTR)                                0260 00519000
*   $INDEFLP='0'B;                  /* RESET INDEFINITE LOOP         */ 00520000
         NI    $INDEFLP(WAPTR),B'11111101'                         0261 00521000
*   GO TO OPT070;                   /* DECODE NEXT CHAR              */ 00522000
         B     OPT070                                              0262 00523000
*                                                                  0263 00524000
*   /*****************************************************************/ 00525000
*   /*                                                               */ 00526000
*   /* TL OPTION ENTRY                                               */ 00527000
*   /*                                                               */ 00528000
*   /*****************************************************************/ 00529000
*                                                                  0263 00530000
*OPT300:                                                           0263 00531000
*   $LOOPTST='1'B;                  /* SET TL BIT                    */ 00532000
OPT300   OI    $LOOPTST(WAPTR),B'00000001'                         0263 00533000
*   $TLCNT=500;                     /* SET DEFAULT COUNT             */ 00534000
         MVC   $TLCNT(2,WAPTR),@CH00798                            0264 00535000
*   IF INPUTBUF(3)='(' THEN         /* COUNT SPECIFIED ?             */ 00536000
         CLI   INPUTBUF+2(R3),C'('                                 0265 00537000
         BNE   @RF00265                                            0265 00538000
*     DO;                           /* YES                           */ 00539000
*       R3=R3+3;                    /* PT TO COUNT                   */ 00540000
         AL    R3,@CF00081                                         0267 00541000
*       GEN(BAL  R11,OPT350);       /* DECODE & CONVERT CNT          */ 00542000
         BAL  R11,OPT350                                                00543000
*       $TLCNT=HEXNUM;              /* MOVE IN COUNT FOR OLT         */ 00544000
         L     @14,HEXNUM                                          0269 00545000
         STH   @14,$TLCNT(,WAPTR)                                  0269 00546000
*       GO TO OPT075;               /* DECODE NEXT                   */ 00547000
         B     OPT075                                              0270 00548000
*     END;                                                         0271 00549000
*   GO TO OPT070;                   /* DECODE NEXT                   */ 00550000
         B     OPT070                                              0272 00551000
*OPT350:                            /* CONVERT ROUTINE               */ 00552000
*   WORK=EBCF0;                     /* INITIALIZE WORKAREA           */ 00553000
OPT350   MVC   WORK(8),EBCF0                                       0273 00554000
*   DO I=1 TO 6 BY 1;               /* SCAN FOR RT. PAREN            */ 00555000
         LA    @14,1                                               0274 00556000
         STH   @14,I                                               0274 00557000
@DL00274 DS    0H                                                  0275 00558000
*     IF INPUTBUF(I)=')' THEN       /* FOUND                         */ 00559000
         ALR   @14,R3                                              0275 00560000
         BCTR  @14,0                                               0275 00561000
         CLI   INPUTBUF(@14),C')'                                  0275 00562000
         BE    @RT00275                                            0275 00563000
*       GO TO OPT355;               /* YES,DECODE & CONVERT          */ 00564000
*     IF APFLAG='0'B THEN           /* IS THIS AN ALT PRTR           */ 00565000
         TM    APFLAG,B'01000000'                                  0277 00566000
         BNZ   @RF00277                                            0277 00567000
*       DO;                         /* NO,CONTINUE                   */ 00568000
*         IF INPUTBUF(I)>'9'|       /* IS CHAR                       */ 00569000
*             '0'>INPUTBUF(I) THEN  /* NUMERIC                       */ 00570000
         LH    @14,I                                               0279 00571000
         ALR   @14,R3                                              0279 00572000
         BCTR  @14,0                                               0279 00573000
         CLI   INPUTBUF(@14),C'9'                                  0279 00574000
         BH    @RT00279                                            0279 00575000
         LH    @14,I                                               0279 00576000
         ALR   @14,R3                                              0279 00577000
         BCTR  @14,0                                               0279 00578000
         CLI   INPUTBUF(@14),C'0'                                  0279 00579000
         BNL   @RF00279                                            0279 00580000
@RT00279 DS    0H                                                  0280 00581000
*           DO;                     /* NO,ERROR                      */ 00582000
*             R3=R3+I;              /* POINT TO ERROR                */ 00583000
         AH    R3,I                                                0281 00584000
*             GO TO OPT360;                                        0282 00585000
         B     OPT360                                              0282 00586000
*           END;                                                   0283 00587000
*       END;                                                       0284 00588000
@RF00279 DS    0H                                                  0285 00589000
*   END;                                                           0285 00590000
@RF00277 LA    @14,1                                               0285 00591000
         AH    @14,I                                               0285 00592000
         STH   @14,I                                               0285 00593000
         C     @14,@CF00448                                        0285 00594000
         BNH   @DL00274                                            0285 00595000
*   R3=R3+5;                        /* ERROR TOO MANY CHARS          */ 00596000
         AL    R3,@CF00350                                         0286 00597000
*   GO TO OPT800;                   /* ISSUE 115 ERROR MSG           */ 00598000
         B     OPT800                                              0287 00599000
*OPT355:                                                           0288 00600000
*   I=I-1;                          /* COMPUTE WORK AREA SUBSCR      */ 00601000
OPT355   LH    @14,I                                               0288 00602000
         BCTR  @14,0                                               0288 00603000
         STH   @14,I                                               0288 00604000
*   IF I=0 THEN                     /* NOTHING FOUND?                */ 00605000
         LTR   @14,@14                                             0289 00606000
         BZ    @RT00289                                            0289 00607000
*     GO TO OPT800;                 /* YES,ERROR                     */ 00608000
*   N=9-I;                          /* NUMBER OF CHARACTERS          */ 00609000
         LA    @10,9                                               0291 00610000
         SLR   @10,@14                                             0291 00611000
         STH   @10,N                                               0291 00612000
*   WORK(N:8)=INPUTBUF(1:I);        /* MOVE IN EBCDIC NUM            */ 00613000
         LA    @08,WORK-1(@10)                                     0292 00614000
         LCR   @10,@10                                             0292 00615000
         AL    @10,@CF00054                                        0292 00616000
         EX    @10,@SM00875                                        0292 00617000
*   R3=R3+I;                        /* INCR INPUT POINTER            */ 00618000
*                                                                  0293 00619000
         ALR   R3,@14                                              0293 00620000
*   /*****************************************************************/ 00621000
*   /*                                                               */ 00622000
*   /* ITACONV FROM(WORK)TO(WORKA)TYPE(EH)COUNT(8) INVOKED           */ 00623000
*   /*                                                               */ 00624000
*   /*****************************************************************/ 00625000
*                                                                  0294 00626000
*   DCL                                                            0294 00627000
*     1 ITATCPRM BDY(WORD),         /* CONVERT PARAMETER LIST        */ 00628000
*      2 * CHAR(4) INIT('0102F4F1'X),                              0294 00629000
*      2 ITATCFR PTR,               /* ADDRESS OF FROM FIELD         */ 00630000
*      2 ITATCTO PTR,               /* ADDRESS OF TO FIELD           */ 00631000
*      2 * BIT(8) INIT(0),          /* FLAGS FOR CONVERT MODULE      */ 00632000
*       3 ITATCTP BIT(1),           /* TYPE OF CONVERT REQUIRED      */ 00633000
*      2 ITATCNT FIXED(8);          /* NUMBER OF BYTES TO CONVERT    */ 00634000
*   ITATCFR=ADDR(WORK);             /* SET THE FROM ADDRESS          */ 00635000
         LA    @14,WORK                                            0295 00636000
         ST    @14,ITATCFR                                         0295 00637000
*   ITATCTO=ADDR(WORKA);            /* SET THE TO ADDRESS            */ 00638000
         LA    @14,WORKA                                           0296 00639000
         ST    @14,ITATCTO                                         0296 00640000
*   ITATCTP='0'B;                   /* SET THE TYPE OF CONVERT BIT   */ 00641000
         NI    ITATCTP,B'01111111'                                 0297 00642000
*   ITATCNT=8;                      /* GIVE THE CONVERT BYTE COUNT   */ 00643000
         MVI   ITATCNT,X'08'                                       0298 00644000
*   R1=ADDR(ITATCPRM);              /* POINT TO CONVERT PARM LIST    */ 00645000
         LA    R1,ITATCPRM                                         0299 00646000
*   CALL ISTSC021;                  /* CALL CONVERT DIRECTLY         */ 00647000
         L     @15,@CV00813                                        0300 00648000
         BALR  @14,@15                                             0300 00649000
*   IF R15¬=0 THEN                  /* ERROR CONVERTING              */ 00650000
         LTR   R15,R15                                             0301 00651000
         BNZ   @RT00301                                            0301 00652000
*     GO TO OPT800;                 /* YES,GO ISSUE 115 MSG          */ 00653000
*   IF APFLAG='1'B THEN             /* IS THIS AN AP ENTRY ENT       */ 00654000
         TM    APFLAG,B'01000000'                                  0303 00655000
         BO    @RT00303                                            0303 00656000
*     GO TO OPT370;                                                0304 00657000
*   HEXNUM=WORKA*16+12;             /* CONVERT TO                    */ 00658000
         L     @14,WORKA                                           0305 00659000
         SLL   @14,4                                               0305 00660000
         AL    @14,@CF00136                                        0305 00661000
         ST    @14,HEXNUM                                          0305 00662000
*   CVB(HEXNUM,HEXNUMA);            /* HEX                           */ 00663000
         XC    @TS00001(8),@TS00001                                0306 00664000
         MVC   @TS00001+4(4),HEXNUMA                               0306 00665000
         CVB   @14,@TS00001                                        0306 00666000
         ST    @14,HEXNUM                                          0306 00667000
*   IF HEXNUM>32767 THEN            /* NUM HAS TO FIT IN HALF        */ 00668000
         C     @14,@CF00816                                        0307 00669000
         BNH   @RF00307                                            0307 00670000
*     DO;                           /* IT DOESNT,ERROR               */ 00671000
*OPT360:                                                           0309 00672000
*       R3=R3-1;                    /* POINT TO ERROR                */ 00673000
OPT360   BCTR  R3,0                                                0309 00674000
*       GO TO OPT800;               /* ISSUE 115 MSG                 */ 00675000
         B     OPT800                                              0310 00676000
*     END;                                                         0311 00677000
*OPT370:                                                           0312 00678000
*   R3=R3+1;                        /* POINT TO ERROR CHAR           */ 00679000
@RF00307 DS    0H                                                  0312 00680000
OPT370   AL    R3,@CF00072                                         0312 00681000
*   GEN(BR   R11);                  /* RETURN TO CALLER              */ 00682000
         BR   R11                                                       00683000
*                                                                  0314 00684000
*   /*****************************************************************/ 00685000
*   /*                                                               */ 00686000
*   /* AP OPTION ENTRY                                               */ 00687000
*   /*                                                               */ 00688000
*   /*****************************************************************/ 00689000
*                                                                  0314 00690000
*OPT400:                                                           0314 00691000
*   IF $ALTPRTR='1'B|               /* IS THERE AN ACTIVE AP OR      */ 00692000
*       ($NOTDEV(2)='1'B&$ACQRED(2)='1'B)/* ONE WITH ERROR           */ 00693000
*     THEN                          /* IF EITHER DO                  */ 00694000
OPT400   TM    $ALTPRTR(WAPTR),B'00000010'                         0314 00695000
         BO    @RT00314                                            0314 00696000
         TM    $NOTDEV+68(WAPTR),B'11000000'                       0314 00697000
         BNO   @RF00314                                            0314 00698000
@RT00314 DS    0H                                                  0315 00699000
*     DO;                           /* YES CONTINUE                  */ 00700000
*       SYM=ADDR($SYSMN(2));        /* GET NAME FOR RELEASE          */ 00701000
         LA    @14,$SYSMN+68(,WAPTR)                               0316 00702000
         ST    @14,SYM                                             0316 00703000
*       R1=ADDR(RELPARM);           /* RELEASE PARM LIST             */ 00704000
         LA    R1,RELPARM                                          0317 00705000
*       CALL #EXIT;                 /* RELEASE PRESENT AP            */ 00706000
         L     @15,#EXITA(,WAPTR)                                  0318 00707000
         BALR  @14,@15                                             0318 00708000
*       IF R15¬=0 THEN              /* ERROR ?                       */ 00709000
         LTR   R15,R15                                             0319 00710000
         BNZ   @RT00319                                            0319 00711000
*         GO TO OPT890;             /* YES                           */ 00712000
*     END;                                                         0321 00713000
*   $NOTDEV(2)='0'B;                /* NOT A TEST DEVICE             */ 00714000
@RF00314 NI    $NOTDEV+68(WAPTR),B'01111111'                       0322 00715000
*   $ALTPRTR='0'B;                  /* RESET AP BIT                  */ 00716000
*   $NEWAP='0'B;                    /* RESET NEW ALT PRTR FLAG       */ 00717000
         NI    $ALTPRTR(WAPTR),B'11111100'                         0324 00718000
*   $APNAME='';                     /* INITIALIZE ALT PRT NAME       */ 00719000
         MVI   $APNAME(WAPTR),C' '                                 0325 00720000
         MVC   $APNAME+1(7,WAPTR),$APNAME(WAPTR)                   0325 00721000
*   IF NO='1'B THEN                 /* AP SPECIFIED                  */ 00722000
         TM    NO,B'10000000'                                      0326 00723000
         BO    @RT00326                                            0326 00724000
*     GO TO OPT070;                 /* NO DECODE NEXT                */ 00725000
*   IF INPUTBUF(3)¬='(' THEN        /* ALT PRINTER SPEC              */ 00726000
         CLI   INPUTBUF+2(R3),C'('                                 0328 00727000
         BE    @RF00328                                            0328 00728000
*     DO;                           /* NO                            */ 00729000
*       R3=R3+2;                    /* ERROR                         */ 00730000
         AL    R3,@CF00139                                         0330 00731000
*       GO TO OPT800;               /* ISSUE ERROR MSG               */ 00732000
         B     OPT800                                              0331 00733000
*     END;                                                         0332 00734000
*   R3=R3+3;                        /* PT TO 1ST CHAR OF NAME        */ 00735000
@RF00328 AL    R3,@CF00081                                         0333 00736000
*   $DEVCDSF(2)='00'X;              /* CDS DEVICE FLAGS              */ 00737000
*                                                                  0334 00738000
         MVI   $DEVCDSF+68(WAPTR),X'00'                            0334 00739000
*   /*****************************************************************/ 00740000
*   /*                                                               */ 00741000
*   /* INITIALIZE SYMBOLIC NAME FIELD                                */ 00742000
*   /*                                                               */ 00743000
*   /*****************************************************************/ 00744000
*                                                                  0335 00745000
*   $$SYMNME(2)=$$SYMNME(2)&&$$SYMNME(2);                          0335 00746000
         XC    $$SYMNME+68(8,WAPTR),$$SYMNME+68(WAPTR)             0335 00747000
*   I=1;                            /* SET SUBSCRIPT                 */ 00748000
         MVC   I(2),@CH00072                                       0336 00749000
*   IF INPUTBUF(1)>'Z' THEN         /* UNIT ADDRESS ?                */ 00750000
         CLI   INPUTBUF(R3),C'Z'                                   0337 00751000
         BNH   @RF00337                                            0337 00752000
*     DO;                           /* YES                           */ 00753000
*       APFLAG='1'B;                /* SET INT AP FLAG               */ 00754000
         OI    APFLAG,B'01000000'                                  0339 00755000
*       GEN(BAL  R11,OPT350);       /* CONVERT UNIT ADDR TO HEX      */ 00756000
         BAL  R11,OPT350                                                00757000
*       APFLAG='0'B;                /* RESET AP FLAG                 */ 00758000
         NI    APFLAG,B'10111111'                                  0341 00759000
*       IF NUM>4095 THEN            /* MORE THAN 3 HEX DIGITS ?      */ 00760000
         CLC   NUM(2),@CH00823                                     0342 00761000
         BNH   @RF00342                                            0342 00762000
*         DO;                       /* YES,ERROR                     */ 00763000
*           R3=R3-2;                /* BACK UP TO LAST DIGIT         */ 00764000
         BCTR  R3,0                                                0344 00765000
         BCTR  R3,0                                                0344 00766000
*           GO TO OPT800;           /* ERROR HANDLING                */ 00767000
         B     OPT800                                              0345 00768000
*         END;                                                     0346 00769000
*       $APNAME(1:I)=WORK(N:8);     /* MOVE AP UNIT ADR              */ 00770000
@RF00342 LH    @14,I                                               0347 00771000
         BCTR  @14,0                                               0347 00772000
         LH    @10,N                                               0347 00773000
         LA    @08,WORK-1(@10)                                     0347 00774000
         EX    @14,@SM00879                                        0347 00775000
*       $DEVUNAD(2)=WORKA;          /* UNIT ADDR TO DEV TBLE         */ 00776000
         MVC   $DEVUNAD+68(4,WAPTR),WORKA                          0348 00777000
*       GO TO OPT450;               /* GO INQUIRE                    */ 00778000
         B     OPT450                                              0349 00779000
*     END;                                                         0350 00780000
*OPT420:                                                           0351 00781000
*   IF INPUTBUF(I)='$'|             /* CHECK FOR                     */ 00782000
*       INPUTBUF(I)='@'|            /* LEGAL                         */ 00783000
*       INPUTBUF(I)='#'|            /* SYMBOLIC                      */ 00784000
*       INPUTBUF(I)>='A' THEN       /* NAME                          */ 00785000
@RF00337 DS    0H                                                  0351 00786000
OPT420   LH    @14,I                                               0351 00787000
         ALR   @14,R3                                              0351 00788000
         BCTR  @14,0                                               0351 00789000
         CLI   INPUTBUF(@14),C'$'                                  0351 00790000
         BE    @RT00351                                            0351 00791000
         LH    @14,I                                               0351 00792000
         ALR   @14,R3                                              0351 00793000
         BCTR  @14,0                                               0351 00794000
         CLI   INPUTBUF(@14),C'@'                                  0351 00795000
         BE    @RT00351                                            0351 00796000
         LH    @14,I                                               0351 00797000
         ALR   @14,R3                                              0351 00798000
         BCTR  @14,0                                               0351 00799000
         CLI   INPUTBUF(@14),C'#'                                  0351 00800000
         BE    @RT00351                                            0351 00801000
         LH    @14,I                                               0351 00802000
         ALR   @14,R3                                              0351 00803000
         BCTR  @14,0                                               0351 00804000
         CLI   INPUTBUF(@14),C'A'                                  0351 00805000
         BL    @RF00351                                            0351 00806000
@RT00351 DS    0H                                                  0352 00807000
*     DO;                                                          0352 00808000
*       I=I+1;                      /* PT TO NEXT CHAR               */ 00809000
         LA    @14,1                                               0353 00810000
         AH    @14,I                                               0353 00811000
         STH   @14,I                                               0353 00812000
*       IF I>9 THEN                 /* MORE THAN 8 CHARS             */ 00813000
         C     @14,@CF00087                                        0354 00814000
         BH    @RT00354                                            0354 00815000
*         GO TO OPT430;             /* YES,ERROR                     */ 00816000
*       GO TO OPT420;               /* CHK NEXT CHAR                 */ 00817000
         B     OPT420                                              0356 00818000
*     END;                                                         0357 00819000
*   IF INPUTBUF(I)¬=')'|            /* IF NOT END OF FIELD OR        */ 00820000
*       I=1 THEN                    /* NO NAME SPECIFIED             */ 00821000
@RF00351 LH    @14,I                                               0358 00822000
         ALR   @14,R3                                              0358 00823000
         BCTR  @14,0                                               0358 00824000
         CLI   INPUTBUF(@14),C')'                                  0358 00825000
         BNE   @RT00358                                            0358 00826000
         LH    @14,I                                               0358 00827000
         C     @14,@CF00072                                        0358 00828000
         BNE   @RF00358                                            0358 00829000
@RT00358 DS    0H                                                  0359 00830000
*     DO;                           /* ERROR                         */ 00831000
*OPT430:                                                           0360 00832000
*       R3=R3+I-1;                  /* POINT TO ERROR                */ 00833000
OPT430   LR    @14,R3                                              0360 00834000
         AH    @14,I                                               0360 00835000
         BCTR  @14,0                                               0360 00836000
         LR    R3,@14                                              0360 00837000
*       GO TO OPT800;               /* WRITE ERROR MSG               */ 00838000
         B     OPT800                                              0361 00839000
*     END;                                                         0362 00840000
*   $DEVCDSF(2)='0A'X;              /* CDS DEVICE FLAGS              */ 00841000
@RF00358 MVI   $DEVCDSF+68(WAPTR),X'0A'                            0363 00842000
*   $$SYMNME(2)='';                 /* INIT SYM NAME                 */ 00843000
         MVI   $$SYMNME+68(WAPTR),C' '                             0364 00844000
         MVC   $$SYMNME+69(7,WAPTR),$$SYMNME+68(WAPTR)             0364 00845000
*   I=I-1;                          /* RESET SUBSCRIPT               */ 00846000
         LH    @14,I                                               0365 00847000
         BCTR  @14,0                                               0365 00848000
         STH   @14,I                                               0365 00849000
*   $$SYMNME(2,1:I)=INPUTBUF(1:I);  /* MOVE NAME TO DEV TBL          */ 00850000
         LR    @10,@14                                             0366 00851000
         BCTR  @10,0                                               0366 00852000
         EX    @10,@SM00881                                        0366 00853000
*   $APNAME=$$SYMNME(2);            /* ALSO MOVE TO APNAME           */ 00854000
         MVC   $APNAME(8,WAPTR),$$SYMNME+68(WAPTR)                 0367 00855000
*   R3=R3+I+1;                      /* INCR INPUT PTR                */ 00856000
         ALR   @14,R3                                              0368 00857000
         AL    @14,@CF00072                                        0368 00858000
         LR    R3,@14                                              0368 00859000
*OPT450:                                                           0369 00860000
*   CDSADDR=ADDR($DEVTBLE(2));      /* CDS FOR ACQ/VER               */ 00861000
OPT450   LA    @14,$DEVTBLE+68(,WAPTR)                             0369 00862000
         ST    @14,CDSADDR                                         0369 00863000
*   R1=ADDR(ACQPARM);               /* ADDRESS OF ACQ PARM LST       */ 00864000
         LA    R1,ACQPARM                                          0370 00865000
*   CALL ISTSC030;                  /* CALL ACQUISITION              */ 00866000
         L     @15,@CV00835                                        0371 00867000
         BALR  @14,@15                                             0371 00868000
*   IF R15¬=0 THEN                  /* ERROR                         */ 00869000
         LTR   R15,R15                                             0372 00870000
         BNZ   @RT00372                                            0372 00871000
*     GO TO OPT890;                 /* YES                           */ 00872000
*   IF SYMNAME=$SYSMN(1) THEN       /* ALT PRT = CONTROL TERM        */ 00873000
         L     @14,SYMPTR+2376(,WAPTR)                             0374 00874000
         CLC   SYMNAME(8,@14),$SYSMN(WAPTR)                        0374 00875000
         BNE   @RF00374                                            0374 00876000
*     DO;                           /* YES                           */ 00877000
*OPT460:                                                           0376 00878000
*       R3=R3-2;                    /* PT TO ERROR                   */ 00879000
OPT460   BCTR  R3,0                                                0376 00880000
         BCTR  R3,0                                                0376 00881000
*       GO TO OPT800;               /* ERROR HANDLING                */ 00882000
         B     OPT800                                              0377 00883000
*     END;                                                         0378 00884000
*   $MSGOTSD(2)=0;                  /* CLCAB WORD FOR QUE            */ 00885000
@RF00374 SLR   @14,@14                                             0379 00886000
         ST    @14,$MSGOTSD+68(,WAPTR)                             0379 00887000
*   $DEVFEAT(2)=DEVCHAR;            /* MOVE DEV CHARS FOR 200        */ 00888000
         L     @14,DVCHRPTR+2376(,WAPTR)                           0380 00889000
         MVC   $DEVFEAT+68(4,WAPTR),DEVCHAR(@14)                   0380 00890000
*   R1=DVCHRPTR;                    /* POINT TO PARM LIST            */ 00891000
         LR    R1,@14                                              0381 00892000
*   CALL I00C0200;                  /* CAN DEV BE AN ALT PRTR        */ 00893000
         L     @15,@CV00838                                        0382 00894000
         BALR  @14,@15                                             0382 00895000
*   IF R15>4 THEN                   /* CHECK R/C                     */ 00896000
         C     R15,@CF00068                                        0383 00897000
         BH    @RT00383                                            0383 00898000
*     GO TO OPT800;                 /* CANT BE ALT PRTR              */ 00899000
*   $SYSMN(2)=SYMNAME;              /* MOVE SYM NAME TOO             */ 00900000
         LA    @14,2376                                            0385 00901000
         ALR   @14,WAPTR                                           0385 00902000
         L     @10,SYMPTR(,@14)                                    0385 00903000
         MVC   $SYSMN+68(8,WAPTR),SYMNAME(@10)                     0385 00904000
*   $LINENME(2)=NAMERN;             /* MOVE NAME TO DEF TABLE        */ 00905000
         MVC   $LINENME+68(8,WAPTR),NAMERN(@14)                    0386 00906000
*   $DEVFLG5(2)=FLG5;               /* MOVE DEVICE FLAGS             */ 00907000
         MVC   $DEVFLG5+68(1,WAPTR),FLG5(@14)                      0387 00908000
*   $NEWAP='1'B;                    /* SET NEW AP FLAG               */ 00909000
         OI    $NEWAP(WAPTR),B'00000001'                           0388 00910000
*   $APRQPER='1'B;                  /* AP REQ. PERMISSION            */ 00911000
         OI    $APRQPER(WAPTR),B'01000000'                         0389 00912000
*   APFLAG='0'B;                    /* TURN OFF INT FLAG             */ 00913000
         NI    APFLAG,B'10111111'                                  0390 00914000
*   GO TO OPT075;                   /* DECODE NEXT ENTRY             */ 00915000
         B     OPT075                                              0391 00916000
*OPT800:                                                           0392 00917000
*                                                                  0392 00918000
*   /*****************************************************************/ 00919000
*   /*                                                               */ 00920000
*   /* ERROR HANDLING                                                */ 00921000
*   /*                                                               */ 00922000
*   /*****************************************************************/ 00923000
*                                                                  0392 00924000
*   R4=$SLASHAD(2)+1;               /* ADDR OF 1ST INPUT CHAR        */ 00925000
OPT800   LA    R4,1                                                0392 00926000
         AL    R4,$SLASHAD+4(,WAPTR)                               0392 00927000
*   IF R3>$SLASHAD(3) THEN          /* BEYOND OPTION FIELD           */ 00928000
         L     @14,$SLASHAD+8(,WAPTR)                              0393 00929000
         CR    R3,@14                                              0393 00930000
         BNH   @RF00393                                            0393 00931000
*     R3=$SLASHAD(3);               /* YES,RESET POINTER             */ 00932000
         LR    R3,@14                                              0394 00933000
*   R6=R3;                          /* SET ERROR INPUT PTR           */ 00934000
@RF00393 LR    R6,R3                                               0395 00935000
*   $INBUFR(1:8)=' ';               /* BLK OUT WORK AREA             */ 00936000
         MVI   $INBUFR+1(WAPTR),C' '                               0396 00937000
         MVC   $INBUFR+2(6,WAPTR),$INBUFR+1(WAPTR)                 0396 00938000
         MVI   $INBUFR(WAPTR),C' '                                 0396 00939000
*   DO I=8 TO 1 BY-1;               /* SCAN INPUT                    */ 00940000
         LA    @14,8                                               0397 00941000
         STH   @14,I                                               0397 00942000
@DL00397 DS    0H                                                  0398 00943000
*     $INBUFR(I)=ERRINPUT(1);       /* MOVE ERROR TO SUB FIELD       */ 00944000
         ALR   @14,WAPTR                                           0398 00945000
         MVC   $INBUFR-1(1,@14),ERRINPUT(R6)                       0398 00946000
*     IF R6=R4 THEN                 /* END OF OPT FIELD              */ 00947000
         CR    R6,R4                                               0399 00948000
         BE    @RT00399                                            0399 00949000
*       GO TO OPT820;               /* YES WRITE ERROR MSG           */ 00950000
*     R6=R6-1;                      /* DECR INPUT PTR                */ 00951000
         BCTR  R6,0                                                0401 00952000
*   END;                                                           0402 00953000
         LH    @10,I                                               0402 00954000
         BCTR  @10,0                                               0402 00955000
         LR    @14,@10                                             0402 00956000
         STH   @14,I                                               0402 00957000
         LTR   @14,@14                                             0402 00958000
         BP    @DL00397                                            0402 00959000
*OPT820:                                                           0403 00960000
*                                                                  0403 00961000
*   /*****************************************************************/ 00962000
*   /*                                                               */ 00963000
*   /* TCEC MSGN(115)SUB(YES) INVOKED                                */ 00964000
*   /*                                                               */ 00965000
*   /*****************************************************************/ 00966000
*                                                                  0403 00967000
*   $TCECM='1'B;                    /* SET TCEC SW IN RCA            */ 00968000
OPT820   OI    $TCECM(WAPTR),B'00000001'                           0403 00969000
*   R1=ADDR($TCA12);                /* SET UP PARM LIST $TR          */ 00970000
         LA    R1,$TCA12                                           0404 00971000
*   CALL #EXIT;                     /* CALL CECOM                    */ 00972000
         L     @15,#EXITA(,WAPTR)                                  0405 00973000
         BALR  @14,@15                                             0405 00974000
*   DCL                                                            0406 00975000
*     1 $TCA12,                     /* TCEC PARM LIST                */ 00976000
*      2 $TCB12 FIXED(32) INIT(115),/* MSG NUMBER                    */ 00977000
*      2 $TCC12 FIXED(32) INIT(0),  /* INCT LEN                      */ 00978000
*      2 $TCD12 BIT(8) INIT('10000000'B),/* FLAG                     */ 00979000
*      2 $TCE12 CHAR(4) INIT('FFFFFFFF'X);/* MSSAGE MASK ISSUE ERROR    00980000
*                                      MSG                           */ 00981000
*OPT850:                                                           0407 00982000
*   $TESTOPT=A33SAVE(1);            /* RESTORE                       */ 00983000
OPT850   MVC   $TESTOPT(1,WAPTR),A33SAVE                           0407 00984000
*   $ERROPT=A33SAVE(2);             /* OLD                           */ 00985000
         MVC   $ERROPT(1,WAPTR),A33SAVE+1                          0408 00986000
*   $EXECFLG=A33SAVE(3);            /* OPTIONS                       */ 00987000
         MVC   $EXECFLG(1,WAPTR),A33SAVE+2                         0409 00988000
*   $OLTFLGS=A33SAVE(4);            /* AND                           */ 00989000
         MVC   $OLTFLGS(1,WAPTR),A33SAVE+3                         0410 00990000
*   $PRNTLVL=A33SAVE(5);            /* CONSTANTS                     */ 00991000
         MVC   $PRNTLVL(1,WAPTR),A33SAVE+4                         0411 00992000
*   $ERRCNTA=A33SAVE(6:9);          /*                               */ 00993000
         MVC   $ERRCNTA(2,WAPTR),A33SAVE+7                         0412 00994000
*   $TLCNT=A33SAVE(8:9);            /*                               */ 00995000
         MVC   $TLCNT(2,WAPTR),A33SAVE+7                           0413 00996000
*   $FLAG9=A33SAVE(10);             /*                               */ 00997000
         MVC   $FLAG9(1,WAPTR),A33SAVE+9                           0414 00998000
*   $NEWAP='0'B;                    /* RESET ALT PRT FLAG            */ 00999000
         NI    $NEWAP(WAPTR),B'11111110'                           0415 01000000
*OPT890:                                                           0416 01001000
*   $OPTERR='1'B;                   /* INDICATE ERROR                */ 01002000
OPT890   OI    $OPTERR(WAPTR),B'00000100'                          0416 01003000
*   IF $ALTPRTR='0'B&               /* ALT PRINTER                   */ 01004000
*       $NEWAP='0'B THEN            /* OR NEW ALT PRINTER            */ 01005000
         TM    $ALTPRTR(WAPTR),B'00000011'                         0417 01006000
         BNZ   @RF00417                                            0417 01007000
*     DO;                                                          0418 01008000
*       $DEVTBLE(2)=$DEVTBLE(2)&&$DEVTBLE(2);/* CLEAR ENTRY          */ 01009000
         XC    $DEVTBLE+68(68,WAPTR),$DEVTBLE+68(WAPTR)            0419 01010000
*       $NOTDEV(2)='1'B;            /* SET NOT DEVICE FOR AP         */ 01011000
         OI    $NOTDEV+68(WAPTR),B'10000000'                       0420 01012000
*     END;                                                         0421 01013000
*OPT895:                            /* SCAN FOR NEXT ENTRY           */ 01014000
*   IF INPUTBUF(1)=',' THEN         /* REACHED NEXT ENTRY?           */ 01015000
@RF00417 DS    0H                                                  0422 01016000
OPT895   CLI   INPUTBUF(R3),C','                                   0422 01017000
         BNE   @RF00422                                            0422 01018000
*     DO;                           /* YES CONTINUE                  */ 01019000
*       R3=R3+1;                    /* POINT TO NEXT ENTRY           */ 01020000
         AL    R3,@CF00072                                         0424 01021000
*       GO TO OPT050;               /* CONTINUE DECODING             */ 01022000
         B     OPT050                                              0425 01023000
*     END;                                                         0426 01024000
*   IF INPUTBUF(1)='/' THEN         /* END OF INPUT?                 */ 01025000
@RF00422 CLI   INPUTBUF(R3),C'/'                                   0427 01026000
         BE    @RT00427                                            0427 01027000
*     GO TO OPT900;                 /* YES,RETURN TO COMM INT        */ 01028000
*   R3=R3+1;                        /* UPDATE POINTER                */ 01029000
         AL    R3,@CF00072                                         0429 01030000
*   GO TO OPT895;                   /* LOOK FOR END OF ENTRY         */ 01031000
         B     OPT895                                              0430 01032000
*OPT900:                                                           0431 01033000
*   R13=SVEIC003(2);                /* MY SAVE PTR                   */ 01034000
OPT900   L     R13,SVEIC003+4(,WAPTR)                              0431 01035000
*   RETURN;                         /* GO TO COMM INT                */ 01036000
@EL00001 DS    0H                                                  0432 01037000
@EF00001 DS    0H                                                  0432 01038000
@ER00001 LM    @14,@12,12(@13)                                     0432 01039000
         BR    @14                                                 0432 01040000
*   DO;                             /* ATDSPLY                       */ 01041000
*   END;                            /* ATDSPLY                       */ 01042000
*   END ISTIC005;                                                  0435 01043000
@DATA    DS    0H                                                       01044000
@CH00798 DC    H'500'                                                   01045000
@CH00823 DC    H'4095'                                                  01046000
@SM00860 MVC   $INBUFR(0,WAPTR),$EXTA+1(WAPTR)                          01047000
@SM00870 MVC   $EXTA+1(0,WAPTR),INPUTBUF(R3)                            01048000
@SM00875 MVC   0(0,@08),INPUTBUF(R3)                                    01049000
@SM00879 MVC   $APNAME(0,WAPTR),0(@08)                                  01050000
@SM00881 MVC   $$SYMNME+68(0,WAPTR),INPUTBUF(R3)                        01051000
         DS    0F                                                       01052000
         DS    0F                                                       01053000
@CF00072 DC    F'1'                                                     01054000
@CH00072 EQU   @CF00072+2                                               01055000
@CF00139 DC    F'2'                                                     01056000
@CF00081 DC    F'3'                                                     01057000
@CF00068 DC    F'4'                                                     01058000
@CF00350 DC    F'5'                                                     01059000
@CF00448 DC    F'6'                                                     01060000
@CF00054 DC    F'8'                                                     01061000
@CF00087 DC    F'9'                                                     01062000
@CF00136 DC    F'12'                                                    01063000
@CF00752 DC    F'54'                                                    01064000
@CF00816 DC    F'32767'                                                 01065000
@CF00874 DC    XL4'0000FFFF'                                            01066000
@CV00813 DC    V(ISTSC021)                                              01067000
@CV00835 DC    V(ISTSC030)                                              01068000
@CV00838 DC    V(I00C0200)                                              01069000
         DS    0D                                                       01070000
RCAPTR   DS    A                                                        01071000
         DS    0D                                                       01072000
@TS00001 DS    CL8                                                      01073000
@CC00778 DC    C'EXT='                                                  01074000
@CC00763 DC    C'TL'                                                    01075000
@CC00766 DC    C'EL'                                                    01076000
@CC00768 DC    C'PP'                                                    01077000
@CC00770 DC    C'AP'                                                    01078000
@CC00772 DC    C'FE'                                                    01079000
@CC00773 DC    C'MI'                                                    01080000
@CC00774 DC    C'EP'                                                    01081000
@CC00775 DC    C'CP'                                                    01082000
@CC00776 DC    C'PR'                                                    01083000
@CC00777 DC    C'TR'                                                    01084000
A33OPTN  DC    CL44'NTL,NEL,NPP,NFE,NMI,NEP,NCP,NPR,NTR,NAP'            01085000
@NM00055 DS    CL90                                                     01086000
         ORG   @NM00055                                                 01087000
N        DS    FL2                                                      01088000
I        DS    FL2                                                      01089000
EXTNUMFX DS    FL4                                                      01090000
         ORG   EXTNUMFX                                                 01091000
@NM00056 DS    CL3                                                      01092000
EXTNUMCH DS    CL1                                                      01093000
         ORG   @NM00055+8                                               01094000
@NM00057 DS    CL12                                                     01095000
         ORG   @NM00057                                                 01096000
WORK     DS    CL8                                                      01097000
WORKA    DS    CL4                                                      01098000
         ORG   WORKA                                                    01099000
@NM00058 DS    CL2                                                      01100000
NUM      DS    CL2                                                      01101000
         ORG   @NM00055+20                                              01102000
HEXNUM   DS    FL4                                                      01103000
         ORG   HEXNUM                                                   01104000
HEXNUMA  DS    CL4                                                      01105000
         ORG   @NM00055+24                                              01106000
OPTS     DS    CL44                                                     01107000
         ORG   OPTS                                                     01108000
EBTL     DS    CL1                                                      01109000
@NM00059 DS    CL3                                                      01110000
EBEL     DS    CL1                                                      01111000
@NM00060 DS    CL3                                                      01112000
EBPP     DS    CL1                                                      01113000
@NM00061 DS    CL3                                                      01114000
EBFE     DS    CL1                                                      01115000
@NM00062 DS    CL3                                                      01116000
EBMI     DS    CL1                                                      01117000
@NM00063 DS    CL3                                                      01118000
EBEP     DS    CL1                                                      01119000
@NM00064 DS    CL3                                                      01120000
EBCP     DS    CL1                                                      01121000
@NM00065 DS    CL3                                                      01122000
EBPR     DS    CL1                                                      01123000
@NM00066 DS    CL3                                                      01124000
EBTR     DS    CL1                                                      01125000
@NM00067 DS    CL3                                                      01126000
EBAP     DS    CL1                                                      01127000
@NM00068 DS    CL3                                                      01128000
         ORG   @NM00055+68                                              01129000
A33SAVE  DS    CL11                                                     01130000
INTFLAGS DS    CL1                                                      01131000
         ORG   INTFLAGS                                                 01132000
NO       DS    BL1                                                      01133000
APFLAG   EQU   INTFLAGS+0                                               01134000
@NM00069 EQU   INTFLAGS+0                                               01135000
         ORG   @NM00055+90                                              01136000
         DS    CL2                                                      01137000
RELPARM  DS    CL9                                                      01138000
         ORG   RELPARM                                                  01139000
@NM00070 DC    X'0102F3F1'                                              01140000
SYM      DS    AL4                                                      01141000
@NM00071 DC    B'10000000'                                              01142000
         ORG   RELPARM+9                                                01143000
         DS    CL3                                                      01144000
ACQPARM  DS    CL5                                                      01145000
         ORG   ACQPARM                                                  01146000
CDSADDR  DS    AL4                                                      01147000
@NM00072 DC    B'00100000'                                              01148000
         ORG   ACQPARM+5                                                01149000
EBCF0    DC    CL8'00000000'                                            01150000
         DS    CL3                                                      01151000
$TCA09   DS    CL13                                                     01152000
         ORG   $TCA09                                                   01153000
$TCB09   DC    A(107)                                                   01154000
$TCC09   DC    A(0)                                                     01155000
$TCD09   DC    B'10000000'                                              01156000
$TCE09   DC    X'FFFFFFFF'                                              01157000
         ORG   $TCA09+13                                                01158000
         DS    CL3                                                      01159000
$TCA10   DS    CL13                                                     01160000
         ORG   $TCA10                                                   01161000
$TCB10   DC    A(327)                                                   01162000
$TCC10   DC    A(0)                                                     01163000
$TCD10   DC    B'10000000'                                              01164000
$TCE10   DC    X'FFFFFFFF'                                              01165000
         ORG   $TCA10+13                                                01166000
         DS    CL3                                                      01167000
ITATCPRM DS    CL14                                                     01168000
         ORG   ITATCPRM                                                 01169000
@NM00074 DC    X'0102F4F1'                                              01170000
ITATCFR  DS    AL4                                                      01171000
ITATCTO  DS    AL4                                                      01172000
@NM00075 DC    AL1(0)                                                   01173000
         ORG   @NM00075                                                 01174000
ITATCTP  DS    BL1                                                      01175000
         ORG   ITATCPRM+13                                              01176000
ITATCNT  DS    FL1                                                      01177000
         ORG   ITATCPRM+14                                              01178000
         DS    CL2                                                      01179000
$TCA12   DS    CL13                                                     01180000
         ORG   $TCA12                                                   01181000
$TCB12   DC    A(115)                                                   01182000
$TCC12   DC    A(0)                                                     01183000
$TCD12   DC    B'10000000'                                              01184000
$TCE12   DC    X'FFFFFFFF'                                              01185000
         ORG   $TCA12+13                                                01186000
         DS    CL3                                                      01187000
PATCH    DC    15F'0'                                                   01188000
@00      EQU   00                      EQUATES FOR REGISTERS 0-15       01189000
@01      EQU   01                                                       01190000
@02      EQU   02                                                       01191000
@03      EQU   03                                                       01192000
@04      EQU   04                                                       01193000
@05      EQU   05                                                       01194000
@06      EQU   06                                                       01195000
@07      EQU   07                                                       01196000
@08      EQU   08                                                       01197000
@09      EQU   09                                                       01198000
@10      EQU   10                                                       01199000
@11      EQU   11                                                       01200000
@12      EQU   12                                                       01201000
@13      EQU   13                                                       01202000
@14      EQU   14                                                       01203000
@15      EQU   15                                                       01204000
WAPTR    EQU   @02                                                      01205000
R1       EQU   @01                                                      01206000
R2       EQU   @02                                                      01207000
R3       EQU   @03                                                      01208000
R4       EQU   @04                                                      01209000
R6       EQU   @06                                                      01210000
R9       EQU   @09                                                      01211000
R11      EQU   @11                                                      01212000
R13      EQU   @13                                                      01213000
R15      EQU   @15                                                      01214000
$RCAAREA EQU   0                                                        01215000
$POINTER EQU   $RCAAREA+100                                             01216000
$TRTBLA  EQU   $POINTER+124                                             01217000
$CONSTNT EQU   $RCAAREA+244                                             01218000
$RCAFLG  EQU   $RCAAREA+604                                             01219000
TOLTEPWA EQU   0                                                        01220000
$SCTTBLE EQU   TOLTEPWA                                                 01221000
$ERRLPCT EQU   $SCTTBLE                                                 01222000
$TESTOPT EQU   $SCTTBLE+2                                               01223000
$NOPRT   EQU   $TESTOPT                                                 01224000
$INDEFLP EQU   $TESTOPT                                                 01225000
$FSTCOMM EQU   $TESTOPT                                                 01226000
$ERROPT  EQU   $SCTTBLE+3                                               01227000
$ALTPRNT EQU   $ERROPT                                                  01228000
$NOCNTRL EQU   $ERROPT                                                  01229000
$NERRPRT EQU   $ERROPT                                                  01230000
$LOOPERR EQU   $ERROPT                                                  01231000
$LOOPTST EQU   $ERROPT                                                  01232000
$PDEVFLG EQU   $SCTTBLE+10                                              01233000
$CDSFLGS EQU   $SCTTBLE+11                                              01234000
$CDS8T19 EQU   $SCTTBLE+20                                              01235000
$EXECFLG EQU   $SCTTBLE+33                                              01236000
$ERRCNT  EQU   $EXECFLG                                                 01237000
$OLTFLGS EQU   $SCTTBLE+36                                              01238000
$MANINTV EQU   $OLTFLGS                                                 01239000
$TRACE   EQU   $OLTFLGS                                                 01240000
$OLTFLG2 EQU   $SCTTBLE+37                                              01241000
$TOTFLG1 EQU   $SCTTBLE+38                                              01242000
$ROUTMSK EQU   $SCTTBLE+40                                              01243000
$CDA     EQU   TOLTEPWA+100                                             01244000
$SLASHAD EQU   $CDA+32                                                  01245000
$RCA     EQU   $CDA+44                                                  01246000
$OLTPTR  EQU   $CDA+52                                                  01247000
$LOWADDR EQU   $OLTPTR                                                  01248000
$HIMOREC EQU   $CDA+60                                                  01249000
$TLCNT   EQU   $CDA+100                                                 01250000
$ERRCNTA EQU   $CDA+102                                                 01251000
$PRNTLVL EQU   $CDA+104                                                 01252000
$COMMFLG EQU   TOLTEPWA+224                                             01253000
$FLAG1   EQU   $COMMFLG                                                 01254000
$OLTACT  EQU   $FLAG1                                                   01255000
$FLAG2   EQU   $COMMFLG+1                                               01256000
$FLAG3   EQU   $COMMFLG+2                                               01257000
$OPTERR  EQU   $FLAG3                                                   01258000
$ALTPRTR EQU   $FLAG3                                                   01259000
$NEWAP   EQU   $FLAG3                                                   01260000
$FLAG4   EQU   $COMMFLG+3                                               01261000
$APRQPER EQU   $FLAG4                                                   01262000
$FLAG5   EQU   $COMMFLG+4                                               01263000
$EOJ     EQU   $FLAG5                                                   01264000
$CANCEL  EQU   $EOJ                                                     01265000
$FLAG6   EQU   $COMMFLG+5                                               01266000
$ABNDBIT EQU   $FLAG6                                                   01267000
$FLAG7   EQU   $COMMFLG+6                                               01268000
$FLAG8   EQU   $COMMFLG+7                                               01269000
$TCECM   EQU   $FLAG8                                                   01270000
$FLAG9   EQU   $COMMFLG+8                                               01271000
$FLAG10  EQU   $COMMFLG+9                                               01272000
$FLAG11  EQU   $COMMFLG+10                                              01273000
$FLAG12  EQU   $COMMFLG+11                                              01274000
$OPTMSG  EQU   $FLAG12                                                  01275000
$FLAG13  EQU   $COMMFLG+12                                              01276000
$DEVTBLE EQU   TOLTEPWA+240                                             01277000
$DEVCDS  EQU   $DEVTBLE                                                 01278000
$DEVUNAD EQU   $DEVCDS                                                  01279000
@NM00039 EQU   $DEVUNAD+2                                               01280000
$DEVFEAT EQU   $DEVCDS+4                                                01281000
$DEVCDSF EQU   $DEVCDS+9                                                01282000
$DEVSDCF EQU   $DEVCDS+10                                               01283000
$$SYMNME EQU   $DEVCDS+12                                               01284000
$MSGOTSD EQU   $$SYMNME                                                 01285000
$DEVFLG1 EQU   $DEVTBLE+20                                              01286000
$EVNCPLT EQU   $DEVFLG1                                                 01287000
$ATTNEXP EQU   $DEVFLG1                                                 01288000
$INTOCC  EQU   $DEVFLG1                                                 01289000
$DEVFLG2 EQU   $DEVTBLE+21                                              01290000
$DEVTECB EQU   $DEVTBLE+22                                              01291000
$OPIS    EQU   $DEVTECB                                                 01292000
$OPND    EQU   $DEVTECB+2                                               01293000
$DEVFLG3 EQU   $DEVTBLE+27                                              01294000
$NOTDEV  EQU   $DEVFLG3                                                 01295000
$ACQRED  EQU   $DEVFLG3                                                 01296000
$SIOFLG  EQU   $DEVFLG3                                                 01297000
$SYSMN   EQU   $DEVTBLE+28                                              01298000
$IFTOUT  EQU   $DEVTBLE+36                                              01299000
$DEVSESP EQU   $IFTOUT                                                  01300000
$SSCPDAF EQU   $IFTOUT+6                                                01301000
$LDNCBPT EQU   $DEVTBLE+48                                              01302000
$RNINFO  EQU   $DEVTBLE+56                                              01303000
$LINENME EQU   $RNINFO                                                  01304000
$DEVFLG5 EQU   $RNINFO+8                                                01305000
$DEVFLG4 EQU   $DEVTBLE+65                                              01306000
$SLTBL   EQU   TOLTEPWA+1468                                            01307000
$RUNTEST EQU   $SLTBL+13                                                01308000
$TESTFLG EQU   $SLTBL+21                                                01309000
$SECLST  EQU   $SLTBL+22                                                01310000
$INBUFR  EQU   TOLTEPWA+2104                                            01311000
$EXTA    EQU   TOLTEPWA+2320                                            01312000
$WORK    EQU   TOLTEPWA+2376                                            01313000
#EXITA   EQU   TOLTEPWA+2632                                            01314000
$CCOMDAT EQU   TOLTEPWA+2644                                            01315000
$CFLGS   EQU   $CCOMDAT+16                                              01316000
$24FEMSG EQU   TOLTEPWA+2681                                            01317000
$24CATMG EQU   $24FEMSG+11                                              01318000
$APNAME  EQU   TOLTEPWA+2704                                            01319000
@NM00048 EQU   TOLTEPWA+2776                                            01320000
$OUNTPTR EQU   @NM00048+4                                               01321000
$NSPTR   EQU   $OUNTPTR                                                 01322000
$NSCNT   EQU   @NM00048+10                                              01323000
$ENXX    EQU   @NM00048+15                                              01324000
$IMITX   EQU   $ENXX                                                    01325000
SVESC033 EQU   TOLTEPWA+3160                                            01326000
SVECC013 EQU   TOLTEPWA+3232                                            01327000
SVEIC003 EQU   TOLTEPWA+3592                                            01328000
SVESC022 EQU   TOLTEPWA+3736                                            01329000
SVECC011 EQU   TOLTEPWA+4024                                            01330000
#EXIT    EQU   0                                                        01331000
@NM00051 EQU   0                                                        01332000
RTNDISP  EQU   @NM00051+10                                              01333000
INST     EQU   @NM00051+12                                              01334000
$NEWSPRF EQU   0                                                        01335000
#FLAGS   EQU   $NEWSPRF+16                                              01336000
$COUNT   EQU   $NEWSPRF+18                                              01337000
INPUTBUF EQU   0                                                        01338000
@NM00073 EQU   0                                                        01339000
SYMPTR   EQU   @NM00073                                                 01340000
DVCHRPTR EQU   @NM00073+4                                               01341000
NAMERN   EQU   @NM00073+8                                               01342000
FLG5     EQU   @NM00073+16                                              01343000
SYMNAME  EQU   0                                                        01344000
DEVCHAR  EQU   0                                                        01345000
ERRINPUT EQU   0                                                        01346000
BACKSAVE EQU   0                                                        01347000
$TRTBL   EQU   0                                                        01348000
OLTENTRY EQU   0                                                        01349000
SVECC012 EQU   SVESC022                                                 01350000
SVEIC00A EQU   SVEIC003                                                 01351000
SVEIC004 EQU   SVEIC003                                                 01352000
SVEIC005 EQU   SVEIC003                                                 01353000
SVESC02A EQU   SVESC022                                                 01354000
SVESC02B EQU   SVESC022                                                 01355000
SVESC02D EQU   SVESC022                                                 01356000
SVESC02E EQU   SVESC022                                                 01357000
SVESC02F EQU   SVECC013                                                 01358000
SVESC024 EQU   SVESC022                                                 01359000
SVESC027 EQU   SVESC022                                                 01360000
SVESC029 EQU   SVESC033                                                 01361000
SVESC031 EQU   SVECC013                                                 01362000
SVESC032 EQU   SVECC011                                                 01363000
SVETC037 EQU   SVEIC003                                                 01364000
         AGO   .@UNREFD                START UNREFERENCED COMPONENTS    01365000
$RME     EQU   $NEWSPRF+36                                              01366000
@NM00054 EQU   $NEWSPRF+35                                              01367000
$ECA     EQU   $NEWSPRF+32                                              01368000
$DCHB    EQU   $NEWSPRF+28                                              01369000
$MOSIZE  EQU   $NEWSPRF+24                                              01370000
$RTSIZE  EQU   $NEWSPRF+20                                              01371000
$REFNUM  EQU   $NEWSPRF+17                                              01372000
@NM00053 EQU   #FLAGS                                                   01373000
#MSGIDRQ EQU   #FLAGS                                                   01374000
#PLKMCOR EQU   #FLAGS                                                   01375000
@NM00052 EQU   #FLAGS                                                   01376000
$VIRTUAL EQU   #FLAGS                                                   01377000
$PLINK$  EQU   $NEWSPRF+12                                              01378000
$SCTREQ  EQU   $NEWSPRF+11                                              01379000
$RM      EQU   $NEWSPRF+9                                               01380000
$CTYPE   EQU   $NEWSPRF+8                                               01381000
$CCLASS  EQU   $NEWSPRF+7                                               01382000
$CFEAT   EQU   $NEWSPRF+6                                               01383000
$CMODEL  EQU   $NEWSPRF+5                                               01384000
$TYPE    EQU   $NEWSPRF+4                                               01385000
$CLASS   EQU   $NEWSPRF+3                                               01386000
$FEAT    EQU   $NEWSPRF+2                                               01387000
$MODEL   EQU   $NEWSPRF+1                                               01388000
$RTN#    EQU   $NEWSPRF                                                 01389000
#MSGID   EQU   @NM00051+16                                              01390000
LEVEL    EQU   @NM00051+8                                               01391000
SECTID   EQU   @NM00051                                                 01392000
SVECC010 EQU   TOLTEPWA+3952                                            01393000
SVETC035 EQU   TOLTEPWA+3880                                            01394000
SVESC030 EQU   TOLTEPWA+3808                                            01395000
SVESC020 EQU   TOLTEPWA+3664                                            01396000
SVEIC002 EQU   TOLTEPWA+3520                                            01397000
SVECC014 EQU   TOLTEPWA+3376                                            01398000
SVESC120 EQU   TOLTEPWA+3304                                            01399000
SVESC025 EQU   TOLTEPWA+3088                                            01400000
@NM00050 EQU   TOLTEPWA+2980                                            01401000
$RPLERR  EQU   TOLTEPWA+2977                                            01402000
@NM00049 EQU   TOLTEPWA+2976                                            01403000
$R13PR3  EQU   TOLTEPWA+2972                                            01404000
$CEINT2  EQU   TOLTEPWA+2968                                            01405000
$CEINT1  EQU   TOLTEPWA+2964                                            01406000
$MSGGET  EQU   TOLTEPWA+2960                                            01407000
$ACQLIST EQU   TOLTEPWA+2956                                            01408000
$R4SAVE1 EQU   TOLTEPWA+2952                                            01409000
$CLSISS  EQU   TOLTEPWA+2950                                            01410000
$CLSCNT  EQU   TOLTEPWA+2948                                            01411000
$CUTABLE EQU   TOLTEPWA+2868                                            01412000
$BUFSZ2  EQU   TOLTEPWA+2864                                            01413000
$RESID2  EQU   TOLTEPWA+2860                                            01414000
$OLTCCW2 EQU   TOLTEPWA+2856                                            01415000
$ENDBFR2 EQU   TOLTEPWA+2852                                            01416000
$1STBFR2 EQU   TOLTEPWA+2848                                            01417000
$TECB2   EQU   TOLTEPWA+2844                                            01418000
$BUFSZ1  EQU   TOLTEPWA+2840                                            01419000
$RESID1  EQU   TOLTEPWA+2836                                            01420000
$OLTCCW1 EQU   TOLTEPWA+2832                                            01421000
$ENDBFR1 EQU   TOLTEPWA+2828                                            01422000
$1STBFR1 EQU   TOLTEPWA+2824                                            01423000
$TECB1   EQU   TOLTEPWA+2820                                            01424000
$WAITIME EQU   TOLTEPWA+2816                                            01425000
$TRTN#   EQU   TOLTEPWA+2815                                            01426000
$WIODEV  EQU   TOLTEPWA+2814                                            01427000
$RQSTSZE EQU   TOLTEPWA+2812                                            01428000
$RQSTPTR EQU   TOLTEPWA+2808                                            01429000
$R4SAVE  EQU   TOLTEPWA+2804                                            01430000
$PARTADR EQU   TOLTEPWA+2800                                            01431000
$TBSDATA EQU   TOLTEPWA+2796                                            01432000
$CTWIDTH EQU   TOLTEPWA+2795                                            01433000
$CTLINE  EQU   TOLTEPWA+2794                                            01434000
$APWIDTH EQU   TOLTEPWA+2793                                            01435000
$APLINE  EQU   TOLTEPWA+2792                                            01436000
$INDEX   EQU   $IMITX                                                   01437000
$UMXX    EQU   @NM00048+14                                              01438000
$NSXX    EQU   @NM00048+12                                              01439000
$ATACNT  EQU   $NSCNT                                                   01440000
$CTR     EQU   @NM00048+8                                               01441000
$ATAPTR  EQU   $NSPTR                                                   01442000
$DDRPTR  EQU   @NM00048                                                 01443000
$DTORESP EQU   TOLTEPWA+2712                                            01444000
$24SYMNE EQU   $24CATMG+4                                               01445000
$24DEVAD EQU   $24CATMG                                                 01446000
$24RTN#  EQU   $24FEMSG+8                                               01447000
$ESECTID EQU   $24FEMSG                                                 01448000
$24FLGS  EQU   TOLTEPWA+2680                                            01449000
$24SAVE2 EQU   TOLTEPWA+2676                                            01450000
$24SAVE1 EQU   TOLTEPWA+2672                                            01451000
$24UNADR EQU   TOLTEPWA+2668                                            01452000
$24SAV13 EQU   TOLTEPWA+2664                                            01453000
$24RETCD EQU   TOLTEPWA+2663                                            01454000
$MACID   EQU   TOLTEPWA+2661                                            01455000
$CSPARE  EQU   $CFLGS                                                   01456000
$C2WAY   EQU   $CFLGS                                                   01457000
$CINCT   EQU   $CCOMDAT+12                                              01458000
$CINADR  EQU   $CCOMDAT+8                                               01459000
$COUTCT  EQU   $CCOMDAT+4                                               01460000
$COUTAD  EQU   $CCOMDAT                                                 01461000
ROOTLOC  EQU   TOLTEPWA+2640                                            01462000
$RETREG  EQU   TOLTEPWA+2636                                            01463000
$PASSONA EQU   TOLTEPWA+2264                                            01464000
$TRMINPT EQU   TOLTEPWA+2184                                            01465000
$BUFFER  EQU   TOLTEPWA+1976                                            01466000
$TLTRPL3 EQU   TOLTEPWA+1856                                            01467000
$TLTRPL2 EQU   TOLTEPWA+1736                                            01468000
$TLTRPL1 EQU   TOLTEPWA+1616                                            01469000
@NM00047 EQU   $SLTBL+135                                               01470000
$HIGHRTN EQU   $SLTBL+134                                               01471000
$PRIMADR EQU   $SLTBL+130                                               01472000
$CTSTPT  EQU   $SLTBL+128                                               01473000
$TSTCNT  EQU   $SLTBL+126                                               01474000
$SECFLGS EQU   $SECLST+3                                                01475000
$SECTION EQU   $SECLST                                                  01476000
$SECACT  EQU   $TESTFLG                                                 01477000
$CANTRUN EQU   $TESTFLG                                                 01478000
$FINAL   EQU   $TESTFLG                                                 01479000
$TESTSUF EQU   $RUNTEST+5                                               01480000
$TESTNUM EQU   $RUNTEST+1                                               01481000
$LETPRF  EQU   $RUNTEST                                                 01482000
$SYMBOLC EQU   $SLTBL+5                                                 01483000
$FAMILY  EQU   $SLTBL                                                   01484000
$CDEVPT  EQU   TOLTEPWA+1466                                            01485000
$DEVCNTS EQU   TOLTEPWA+1464                                            01486000
$FEEDBCK EQU   $DEVTBLE+66                                              01487000
$WTISUED EQU   $DEVFLG4                                                 01488000
$EXIOISD EQU   $DEVFLG4                                                 01489000
$REMWRIT EQU   $DEVFLG4                                                 01490000
$REMDONE EQU   $DEVFLG4                                                 01491000
$2NDUSED EQU   $DEVFLG4                                                 01492000
$1STUSED EQU   $DEVFLG4                                                 01493000
$IGLXIFB EQU   $DEVFLG4                                                 01494000
$EXIOLV3 EQU   $DEVFLG4                                                 01495000
@NM00046 EQU   $DEVFLG5                                                 01496000
$DVBASIC EQU   $DEVFLG5                                                 01497000
$ASCII   EQU   $DEVFLG5                                                 01498000
$DEVLU   EQU   $DEVFLG5                                                 01499000
$OPNDFAL EQU   $DEVFLG5                                                 01500000
$ACQNCB  EQU   $DEVFLG5                                                 01501000
$REMOTE  EQU   $DEVFLG5                                                 01502000
$ENDNODE EQU   $DEVFLG5                                                 01503000
$CID     EQU   $DEVTBLE+52                                              01504000
$DVCOL   EQU   $LDNCBPT+2                                               01505000
$DVROW   EQU   $LDNCBPT                                                 01506000
$NCSPLP  EQU   $DEVTBLE+44                                              01507000
$DVLN    EQU   $SSCPDAF                                                 01508000
$DAF     EQU   $DEVSESP+4                                               01509000
$VARYPAB EQU   $DEVSESP                                                 01510000
@NM00045 EQU   $DEVFLG3                                                 01511000
$CLRSNT  EQU   $DEVFLG3                                                 01512000
$OLTERR  EQU   $DEVFLG3                                                 01513000
$SRTEST  EQU   $DEVFLG3                                                 01514000
$DVSNDOK EQU   $SIOFLG                                                  01515000
$POLLREQ EQU   $DEVFLG3                                                 01516000
$DVINCT  EQU   $DEVTBLE+26                                              01517000
$DVBRKST EQU   $OPND+1                                                  01518000
$DVBRKSN EQU   $OPND                                                    01519000
$DVSEQNO EQU   $OPIS                                                    01520000
$CEINTRP EQU   $DEVFLG2                                                 01521000
$TESTMDE EQU   $DEVFLG2                                                 01522000
$DEVALOC EQU   $DEVFLG2                                                 01523000
$ALLDATA EQU   $DEVFLG2                                                 01524000
$ENDCNTL EQU   $DEVFLG2                                                 01525000
$CTLDEV  EQU   $DEVFLG2                                                 01526000
$NOCDS   EQU   $DEVFLG2                                                 01527000
$DATAIN  EQU   $DEVFLG2                                                 01528000
$PRIMARY EQU   $DEVFLG1                                                 01529000
$DVCTBYT EQU   $INTOCC                                                  01530000
$DEVACT  EQU   $DEVFLG1                                                 01531000
$DVLGMDE EQU   $ATTNEXP                                                 01532000
$DVSPRM  EQU   $EVNCPLT                                                 01533000
$GRABBED EQU   $DEVFLG1                                                 01534000
$CATASTR EQU   $DEVFLG1                                                 01535000
$LETGO   EQU   $DEVFLG1                                                 01536000
$CURELEM EQU   $$SYMNME+4                                               01537000
$EXTDEV  EQU   $DEVCDS+11                                               01538000
@NM00044 EQU   $DEVSDCF                                                 01539000
$NOTPRIM EQU   $DEVSDCF                                                 01540000
@NM00043 EQU   $DEVCDSF                                                 01541000
@NM00042 EQU   $DEVCDSF                                                 01542000
@NM00041 EQU   $DEVCDSF                                                 01543000
$CDSNAME EQU   $DEVCDSF                                                 01544000
$EXTRN   EQU   $DEVCDSF                                                 01545000
$CEVOLUM EQU   $DEVCDSF                                                 01546000
$SHARD   EQU   $DEVCDSF                                                 01547000
$DEVFPM  EQU   $DEVCDSF                                                 01548000
$DEVCNT  EQU   $DEVCDS+8                                                01549000
$DEVTYPE EQU   $DEVFEAT+3                                               01550000
$DEVCLAS EQU   $DEVFEAT+2                                               01551000
$DEVFRRS EQU   $DEVFEAT+1                                               01552000
$DEVMOD  EQU   $DEVFEAT                                                 01553000
$DEVRDGT EQU   @NM00039+1                                               01554000
$DEVCTLU EQU   @NM00039+1                                               01555000
$DEVCHAN EQU   @NM00039                                                 01556000
@NM00040 EQU   @NM00039                                                 01557000
$CTINDX  EQU   $DEVUNAD                                                 01558000
$FLAG16  EQU   $COMMFLG+15                                              01559000
$FLAG15  EQU   $COMMFLG+14                                              01560000
$FLAG14  EQU   $COMMFLG+13                                              01561000
$TEP2ND  EQU   $FLAG13                                                  01562000
$TEP1ST  EQU   $FLAG13                                                  01563000
$CATMSG  EQU   $FLAG13                                                  01564000
$PRMPTSW EQU   $FLAG13                                                  01565000
$DEVENT  EQU   $FLAG13                                                  01566000
$OLTMACC EQU   $FLAG13                                                  01567000
$LGON    EQU   $FLAG13                                                  01568000
$CTLOGON EQU   $FLAG13                                                  01569000
@NM00038 EQU   $FLAG12                                                  01570000
$VARYINP EQU   $FLAG12                                                  01571000
$ENDTEST EQU   $FLAG12                                                  01572000
$VRYHRD  EQU   $FLAG12                                                  01573000
$VRYSFT  EQU   $FLAG12                                                  01574000
$POSTFLG EQU   $FLAG12                                                  01575000
$FEORCAT EQU   $FLAG11                                                  01576000
@NM00037 EQU   $FLAG11                                                  01577000
@NM00036 EQU   $FLAG10                                                  01578000
$INBND   EQU   $FLAG10                                                  01579000
$WAITFLG EQU   $FLAG10                                                  01580000
$DPRINT  EQU   $FLAG10                                                  01581000
$HOLD    EQU   $FLAG9                                                   01582000
$NOTRRCH EQU   $FLAG9                                                   01583000
@NM00035 EQU   $FLAG9                                                   01584000
$COPY    EQU   $FLAG9                                                   01585000
$LSTLNSW EQU   $FLAG9                                                   01586000
$MULLNSW EQU   $FLAG9                                                   01587000
$REMSW   EQU   $FLAG9                                                   01588000
$IGRES   EQU   $FLAG9                                                   01589000
$VS2     EQU   $FLAG8                                                   01590000
$VS1     EQU   $FLAG8                                                   01591000
$EDOS    EQU   $FLAG8                                                   01592000
@NM00034 EQU   $FLAG8                                                   01593000
$TWOWAY  EQU   $FLAG8                                                   01594000
@NM00033 EQU   $FLAG8                                                   01595000
$RCVMSG  EQU   $FLAG7                                                   01596000
$RCVRFLG EQU   $FLAG7                                                   01597000
$SNDRFLG EQU   $FLAG7                                                   01598000
$LDOIS   EQU   $FLAG7                                                   01599000
$DCONTCT EQU   $FLAG7                                                   01600000
$EXIOWAT EQU   $FLAG7                                                   01601000
$2NDDATA EQU   $FLAG7                                                   01602000
$1STDATA EQU   $FLAG7                                                   01603000
$CIREQ   EQU   $FLAG6                                                   01604000
$ABTERM  EQU   $ABNDBIT                                                 01605000
$FSTMCIS EQU   $FLAG6                                                   01606000
$DISCREQ EQU   $FLAG6                                                   01607000
$DISCISS EQU   $FLAG6                                                   01608000
$CHANGE  EQU   $FLAG6                                                   01609000
$CTERROR EQU   $FLAG6                                                   01610000
$RECAL11 EQU   $FLAG6                                                   01611000
@NM00032 EQU   $FLAG5                                                   01612000
$PROGCK  EQU   $CANCEL                                                  01613000
$PRINTAP EQU   $FLAG5                                                   01614000
@NM00031 EQU   $FLAG5                                                   01615000
$MSG922  EQU   $FLAG5                                                   01616000
$CT924   EQU   $FLAG5                                                   01617000
$FSTCAT  EQU   $FLAG5                                                   01618000
$FSTFE   EQU   $FLAG5                                                   01619000
$ACTOPND EQU   $FLAG4                                                   01620000
$ACQCUTT EQU   $FLAG4                                                   01621000
$CLSSACT EQU   $FLAG4                                                   01622000
$BACKINT EQU   $FLAG4                                                   01623000
$DMSGSW  EQU   $FLAG4                                                   01624000
$TSTDEVP EQU   $FLAG4                                                   01625000
$OPCOM   EQU   $FLAG4                                                   01626000
$PRTONLY EQU   $FLAG3                                                   01627000
$REQSTOR EQU   $FLAG3                                                   01628000
$LOGOFFE EQU   $FLAG3                                                   01629000
$TSTERR  EQU   $FLAG3                                                   01630000
$DEVERR  EQU   $FLAG3                                                   01631000
$PARTIAL EQU   $FLAG2                                                   01632000
$NRMTERM EQU   $FLAG2                                                   01633000
$VALDTST EQU   $FLAG2                                                   01634000
$VALDDEV EQU   $FLAG2                                                   01635000
$DBLSLSH EQU   $FLAG2                                                   01636000
$NDR     EQU   $FLAG2                                                   01637000
@NM00030 EQU   $FLAG2                                                   01638000
$NORELDV EQU   $FLAG1                                                   01639000
@NM00029 EQU   $FLAG1                                                   01640000
$OPTCHNG EQU   $FLAG1                                                   01641000
$DEVCHNG EQU   $FLAG1                                                   01642000
$TESTCNG EQU   $FLAG1                                                   01643000
$CNSLFG  EQU   $FLAG1                                                   01644000
$TEP3RD  EQU   $FLAG1                                                   01645000
@NM00028 EQU   $CDA+120                                                 01646000
$CUCNT   EQU   $CDA+118                                                 01647000
@NM00027 EQU   $CDA+117                                                 01648000
$PRTFORM EQU   $CDA+116                                                 01649000
$OPISCNT EQU   $CDA+114                                                 01650000
$OPNDCNT EQU   $CDA+112                                                 01651000
$GETMSZE EQU   $CDA+110                                                 01652000
$GRCNTS  EQU   $CDA+108                                                 01653000
$CTLCNT  EQU   $CDA+106                                                 01654000
$ACTLVL  EQU   $CDA+105                                                 01655000
$TIMEALW EQU   $CDA+96                                                  01656000
$PTRAREA EQU   $CDA+92                                                  01657000
$GETMPTR EQU   $CDA+88                                                  01658000
$R13PTRT EQU   $CDA+84                                                  01659000
$R13PTR  EQU   $CDA+80                                                  01660000
$TEPEND  EQU   $CDA+76                                                  01661000
$PLINKDL EQU   $CDA+72                                                  01662000
$TEPBEGN EQU   $CDA+68                                                  01663000
$FRELPTR EQU   $CDA+64                                                  01664000
$HIGHADR EQU   $HIMOREC                                                 01665000
$LOMOREC EQU   $CDA+56                                                  01666000
$ENDCOMM EQU   $CDA+48                                                  01667000
$COMMON  EQU   $RCA                                                     01668000
$PASSON  EQU   $CDA+28                                                  01669000
$TOLBRTB EQU   $CDA+24                                                  01670000
$SCTPTR8 EQU   $CDA+20                                                  01671000
$SCTPTR  EQU   $CDA+16                                                  01672000
$TBWDPTR EQU   $CDA+12                                                  01673000
$TFWDPTR EQU   $CDA+8                                                   01674000
@NM00026 EQU   $CDA                                                     01675000
@NM00025 EQU   $SCTTBLE+98                                              01676000
$SCTLWTC EQU   $SCTTBLE+96                                              01677000
$SCTLWTA EQU   $SCTTBLE+92                                              01678000
#EXT     EQU   $SCTTBLE+88                                              01679000
#PASS    EQU   $SCTTBLE+84                                              01680000
#TABLE   EQU   $SCTTBLE+80                                              01681000
#MSGIDAC EQU   $SCTTBLE+78                                              01682000
@NM00024 EQU   $SCTTBLE+71                                              01683000
$RETMASK EQU   $SCTTBLE+70                                              01684000
$R249255 EQU   $ROUTMSK+29                                              01685000
$R241248 EQU   $ROUTMSK+28                                              01686000
$R233240 EQU   $ROUTMSK+27                                              01687000
$R225232 EQU   $ROUTMSK+26                                              01688000
$R217224 EQU   $ROUTMSK+25                                              01689000
$R209216 EQU   $ROUTMSK+24                                              01690000
$R201208 EQU   $ROUTMSK+23                                              01691000
$R193200 EQU   $ROUTMSK+22                                              01692000
$R185192 EQU   $ROUTMSK+21                                              01693000
$R177184 EQU   $ROUTMSK+20                                              01694000
$R169176 EQU   $ROUTMSK+19                                              01695000
$R161168 EQU   $ROUTMSK+18                                              01696000
$R153160 EQU   $ROUTMSK+17                                              01697000
$R145152 EQU   $ROUTMSK+16                                              01698000
$R137144 EQU   $ROUTMSK+15                                              01699000
$R129136 EQU   $ROUTMSK+14                                              01700000
$R121128 EQU   $ROUTMSK+13                                              01701000
$R113120 EQU   $ROUTMSK+12                                              01702000
$R105112 EQU   $ROUTMSK+11                                              01703000
$R097104 EQU   $ROUTMSK+10                                              01704000
$R089096 EQU   $ROUTMSK+9                                               01705000
$R081088 EQU   $ROUTMSK+8                                               01706000
$R073080 EQU   $ROUTMSK+7                                               01707000
$R065072 EQU   $ROUTMSK+6                                               01708000
$R057064 EQU   $ROUTMSK+5                                               01709000
$R049056 EQU   $ROUTMSK+4                                               01710000
$R041048 EQU   $ROUTMSK+3                                               01711000
$R033040 EQU   $ROUTMSK+2                                               01712000
$R025032 EQU   $ROUTMSK+1                                               01713000
$R017024 EQU   $ROUTMSK                                                 01714000
$TOTFLG2 EQU   $SCTTBLE+39                                              01715000
@NM00023 EQU   $TOTFLG1                                                 01716000
@NM00022 EQU   $TOTFLG1                                                 01717000
@NM00021 EQU   $TOTFLG1                                                 01718000
$CURELOD EQU   $TOTFLG1                                                 01719000
$CTEQTT  EQU   $TOTFLG1                                                 01720000
@NM00020 EQU   $TOTFLG1                                                 01721000
@NM00019 EQU   $TOTFLG1                                                 01722000
$LINESHR EQU   $TOTFLG1                                                 01723000
@NM00018 EQU   $OLTFLG2                                                 01724000
@NM00017 EQU   $OLTFLG2                                                 01725000
@NM00016 EQU   $OLTFLG2                                                 01726000
@NM00015 EQU   $OLTFLG2                                                 01727000
@NM00014 EQU   $OLTFLG2                                                 01728000
@NM00013 EQU   $OLTFLG2                                                 01729000
@NM00012 EQU   $OLTFLG2                                                 01730000
$TALK    EQU   $OLTFLG2                                                 01731000
$DYCOM   EQU   $OLTFLGS                                                 01732000
@NM00011 EQU   $OLTFLGS                                                 01733000
$RETCODE EQU   $OLTFLGS                                                 01734000
$CONTCB  EQU   $OLTFLGS                                                 01735000
$RETAIN  EQU   $OLTFLGS                                                 01736000
$CLEANRT EQU   $OLTFLGS                                                 01737000
$OLTSIZE EQU   $SCTTBLE+34                                              01738000
$QSCTMOD EQU   $EXECFLG                                                 01739000
$CTRLMOD EQU   $EXECFLG                                                 01740000
$CLEANUP EQU   $EXECFLG                                                 01741000
$LSTPDEV EQU   $EXECFLG                                                 01742000
$RTNSLCT EQU   $EXECFLG                                                 01743000
$MULTDEV EQU   $EXECFLG                                                 01744000
@NM00010 EQU   $EXECFLG                                                 01745000
$RMSKCNT EQU   $SCTTBLE+32                                              01746000
$SYNAME  EQU   $CDS8T19+4                                               01747000
$EXTSIG  EQU   $CDS8T19+3                                               01748000
$CDFLGS  EQU   $CDS8T19+1                                               01749000
$CDSCNT  EQU   $CDS8T19                                                 01750000
$PDEVDSC EQU   $SCTTBLE+16                                              01751000
$PDEVADR EQU   $SCTTBLE+12                                              01752000
$COMMCN  EQU   $CDSFLGS                                                 01753000
$CUSTSYM EQU   $CDSFLGS                                                 01754000
$TWOCHSW EQU   $CDSFLGS                                                 01755000
$SYMNAME EQU   $CDSFLGS                                                 01756000
$EXTINTC EQU   $CDSFLGS                                                 01757000
$CEVOL   EQU   $CDSFLGS                                                 01758000
$SHARED  EQU   $CDSFLGS                                                 01759000
$FPM     EQU   $CDSFLGS                                                 01760000
$LASTSUB EQU   $PDEVFLG                                                 01761000
@NM00009 EQU   $PDEVFLG                                                 01762000
@NM00008 EQU   $PDEVFLG                                                 01763000
@NM00007 EQU   $PDEVFLG                                                 01764000
$LASTDEV EQU   $PDEVFLG                                                 01765000
@NM00006 EQU   $PDEVFLG                                                 01766000
$EXFILPT EQU   $PDEVFLG                                                 01767000
$FPMOLD  EQU   $PDEVFLG                                                 01768000
$TSSSYM  EQU   $SCTTBLE+8                                               01769000
$SCTLEVL EQU   $SCTTBLE+7                                               01770000
$DRIVER  EQU   $SCTTBLE+6                                               01771000
$RT0916  EQU   $SCTTBLE+5                                               01772000
$RT0108  EQU   $SCTTBLE+4                                               01773000
$CATERR  EQU   $ERROPT                                                  01774000
$ASTERIK EQU   $ERROPT                                                  01775000
$TESTERR EQU   $ERROPT                                                  01776000
$PARAPRT EQU   $TESTOPT                                                 01777000
@NM00005 EQU   $TESTOPT                                                 01778000
$TLTEND  EQU   $RCAAREA+945                                             01779000
$CNSLID  EQU   $RCAAREA+936                                             01780000
$EXITSAV EQU   $RCAAREA+864                                             01781000
$TRASCII EQU   $RCAAREA+608                                             01782000
@NM00004 EQU   $RCAAREA+605                                             01783000
$VTAMEND EQU   $RCAFLG                                                  01784000
$TPPOSTD EQU   $RCAFLG                                                  01785000
$NEWCT   EQU   $RCAFLG                                                  01786000
$ABNDALL EQU   $RCAFLG                                                  01787000
$CUTESTB EQU   $RCAFLG                                                  01788000
$CONSOLE EQU   $RCAFLG                                                  01789000
$TPLOGON EQU   $RCAFLG                                                  01790000
$UPDATE  EQU   $RCAFLG                                                  01791000
$DEVAREA EQU   $RCAAREA+600                                             01792000
$CTDVAR  EQU   $RCAAREA+596                                             01793000
$BUFFS   EQU   $RCAAREA+464                                             01794000
$TLTNIB  EQU   $CONSTNT+140                                             01795000
$TLTPRPL EQU   $CONSTNT+20                                              01796000
@NM00003 EQU   $CONSTNT+4                                               01797000
@NM00002 EQU   $CONSTNT+2                                               01798000
$USECNT  EQU   $CONSTNT                                                 01799000
$CURRTWA EQU   $POINTER+140                                             01800000
$CTNAME  EQU   $POINTER+132                                             01801000
$CTARGX  EQU   $POINTER+128                                             01802000
$COMINT  EQU   $POINTER+120                                             01803000
$QUEHNDL EQU   $POINTER+116                                             01804000
@NM00001 EQU   $POINTER+36                                              01805000
$RTNPTR  EQU   $POINTER+32                                              01806000
$TLTECB2 EQU   $POINTER+28                                              01807000
$TLTECB1 EQU   $POINTER+24                                              01808000
$CLEANP  EQU   $POINTER+20                                              01809000
$ABEND   EQU   $POINTER+16                                              01810000
$LSTAREA EQU   $POINTER+12                                              01811000
$FSTAREA EQU   $POINTER+8                                               01812000
$CVTSAVE EQU   $POINTER+4                                               01813000
$TOLTEP  EQU   $POINTER                                                 01814000
$TLTACB  EQU   $RCAAREA                                                 01815000
.@UNREFD ANOP                          END UNREFERENCED COMPONENTS      01816000
@RT00103 EQU   OPT900                                                   01817000
@RT00123 EQU   OPT300                                                   01818000
@RT00131 EQU   OPT200                                                   01819000
@RT00138 EQU   OPT100                                                   01820000
@RF00150 EQU   OPT070                                                   01821000
@RF00157 EQU   OPT070                                                   01822000
@RF00164 EQU   OPT070                                                   01823000
@RF00171 EQU   OPT070                                                   01824000
@RF00178 EQU   OPT070                                                   01825000
@RF00185 EQU   OPT070                                                   01826000
@RT00198 EQU   OPT800                                                   01827000
@RT00216 EQU   OPT900                                                   01828000
@RF00221 EQU   OPT070                                                   01829000
@RF00265 EQU   OPT070                                                   01830000
@RT00275 EQU   OPT355                                                   01831000
@RT00289 EQU   OPT800                                                   01832000
@RT00301 EQU   OPT800                                                   01833000
@RT00303 EQU   OPT370                                                   01834000
@RT00319 EQU   OPT890                                                   01835000
@RT00326 EQU   OPT070                                                   01836000
@RT00354 EQU   OPT430                                                   01837000
@RT00372 EQU   OPT890                                                   01838000
@RT00383 EQU   OPT800                                                   01839000
@RT00399 EQU   OPT820                                                   01840000
@RT00427 EQU   OPT900                                                   01841000
@ENDDATA EQU   *                                                        01842000
         END   ISTIC005,(C'PLS1241',0702,78336)                         01843000
./  ADD  SSI=91290788,NAME=ISTIC006
         TITLE 'ISTIC006,UPDATE CTL && EXHIBIT'                         00001000
ISTIC006 CSECT ,                                                   0001 00002000
@MAINENT DS    0H                                                  0001 00003000
         USING *,@15                                               0001 00004000
         B     @PROLOG                                             0001 00005000
         DC    AL1(16)                                             0001 00006000
         DC    C'ISTIC006  79.129'                                 0001 00007000
         DROP  @15                                                      00008000
@PROLOG  ST    @14,12(,@13)                                        0001 00009000
         STM   @00,@12,20(@13)                                     0001 00010000
         BALR  @11,0                                               0001 00011000
@PSTART  DS    0H                                                  0001 00012000
         USING @PSTART,@11                                         0001 00013000
         ST    @13,@SA00001+4                                      0001 00014000
         LA    @12,@SA00001                                        0001 00015000
         ST    @12,8(,@13)                                         0001 00016000
         LR    @13,@12                                             0001 00017000
         EJECT                                                          00018000
         EJECT                                                          00019000
         EJECT                                                          00020000
*                                                                  0076 00021000
*/*  UPDATE CONTROL SECTION                                          */ 00022000
*                                                                  0076 00023000
*I006C01:                                                          0076 00024000
*   $INBUFR(1:80)='';               /* BLANK OUT INPUT BUFFER        */ 00025000
*                                                                  0076 00026000
I006C01  MVI   $INBUFR(WAPTR),C' '                                 0076 00027000
         MVC   $INBUFR+1(79,WAPTR),$INBUFR(WAPTR)                  0076 00028000
*   /*****************************************************************/ 00029000
*   /*                                                               */ 00030000
*   /* TCEC MSGN(560)INCT(8) INVOKED                                 */ 00031000
*   /*                                                               */ 00032000
*   /*****************************************************************/ 00033000
*                                                                  0077 00034000
*   $TCECM='1'B;                    /* SET TCEC SW IN RCA            */ 00035000
         OI    $TCECM(WAPTR),B'00000001'                           0077 00036000
*   R1=ADDR($TCA09);                /* SET UP PARM LIST $TR          */ 00037000
         LA    R1,$TCA09                                           0078 00038000
*   CALL #EXIT;                     /* CALL CECOM                    */ 00039000
         L     @15,#EXITA(,WAPTR)                                  0079 00040000
         BALR  @14,@15                                             0079 00041000
*   DCL                                                            0080 00042000
*     1 $TCA09,                     /* TCEC PARM LIST                */ 00043000
*      2 $TCB09 FIXED(32) INIT(560),/* MSG NUMBER                    */ 00044000
*      2 $TCC09 FIXED(32) INIT(8),  /* INCT LEN                      */ 00045000
*      2 $TCD09 BIT(8) INIT('01000000'B),/* FLAG                     */ 00046000
*      2 $TCE09 CHAR(4) INIT('FFFFFFFF'X);/* MSSAGE MASK ENTER     0080 00047000
*                                      FUNCTION ID                   */ 00048000
*   WKREG1=ADDR(FNCTBL);            /* GET PTR TO FUNCTION TBL       */ 00049000
         LA    WKREG1,FNCTBL                                       0081 00050000
*   RESPECIFY                                                      0082 00051000
*     CDSMAP BASED(CDSWKPTR);                                      0082 00052000
*   CDSWKPTR=$LOWADDR;              /* SET UP BASE                   */ 00053000
         L     @15,$LOWADDR(,WAPTR)                                0083 00054000
         ST    @15,CDSWKPTR                                        0083 00055000
*   CDSWKPTR=CDSWKPTR+80;           /* GET CDS WORK AREA OFFSET      */ 00056000
         AH    @15,@CH00181                                        0084 00057000
         ST    @15,CDSWKPTR                                        0084 00058000
*   R1=ADDR(CDSUA);                 /* INITIALIZE BASE FOR XC INST   */ 00059000
         LR    R1,@15                                              0085 00060000
*   GEN;                                                           0086 00061000
*                                                                  0086 00062000
         XC  0(255,R1),0(R1)            /*ZERO OUT CDS WORK AREA     */ 00063000
*/* LOCATE FUNCTION                                                  */ 00064000
*                                                                  0087 00065000
*   IF NONE=$INBUFR(2:LENGTH(NONE)+1) THEN                         0087 00066000
         CLC   NONE(4),$INBUFR+1(WAPTR)                            0087 00067000
         BE    @RT00087                                            0087 00068000
*     GOTO I006CRET;                                               0088 00069000
*   CALLREG=ADDR(CALLTBL);          /* GET PTR TO CALL TABLE         */ 00070000
         LA    CALLREG,CALLTBL                                     0089 00071000
*   DO X=1 TO DIM(FNCTBL);          /* CHECK FOR VALID ENTRY         */ 00072000
         LA    @15,1                                               0090 00073000
         ST    @15,X                                               0090 00074000
@DL00090 DS    0H                                                  0091 00075000
*     IF TBLENTLN=$INBUFR THEN      /* COMPARE LENGTH FIRST          */ 00076000
         CLC   TBLENTLN(1,WKREG1),$INBUFR(WAPTR)                   0091 00077000
         BNE   @RF00091                                            0091 00078000
*       DO;                                                        0092 00079000
*         WKREG1=ADDR(FNCTBL);      /* REINITIALIZE WKREG1           */ 00080000
         LA    WKREG1,FNCTBL                                       0093 00081000
*         I=$INBUFR(1:1);           /* GET INPUT LENGTH              */ 00082000
         MVC   I(1),$INBUFR(WAPTR)                                 0094 00083000
*         DO X=1 TO DIM(FNCTBL);    /* COMPARE ACTUAL ENTRY          */ 00084000
         LA    @15,1                                               0095 00085000
         ST    @15,X                                               0095 00086000
@DL00095 DS    0H                                                  0096 00087000
*           IF TBLENTRY(2:4)=$INBUFR(2:4) THEN                     0096 00088000
         CLC   TBLENTRY+1(3,WKREG1),$INBUFR+1(WAPTR)               0096 00089000
         BE    @RT00096                                            0096 00090000
*             GOTO I006C02;         /* IF FOUND-GET OUT              */ 00091000
*           CALLREG=CALLREG+4;      /* UPDATE CALL REG PTR           */ 00092000
         AH    CALLREG,@CH00045                                    0098 00093000
*           WKREG1=WKREG1+TBLENTLN; /* POINT TO NXT FNCTBL ENTRY     */ 00094000
         SLR   @12,@12                                             0099 00095000
         IC    @12,TBLENTLN(,WKREG1)                               0099 00096000
         ALR   WKREG1,@12                                          0099 00097000
*           WKREG1=WKREG1+1;        /* AND UPDATE THAT PTR BY 1      */ 00098000
         AH    WKREG1,@CH00036                                     0100 00099000
*         END;                                                     0101 00100000
         AH    @15,@CH00036                                        0101 00101000
         ST    @15,X                                               0101 00102000
         CH    @15,@CH00080                                        0101 00103000
         BNH   @DL00095                                            0101 00104000
*         GOTO I006C01A;            /* BR AROUND                     */ 00105000
         B     I006C01A                                            0102 00106000
*       END;                                                       0103 00107000
*     WKREG1=WKREG1+TBLENTLN;       /* POINT TO NXT FUNCT TBL ENT    */ 00108000
@RF00091 SLR   @15,@15                                             0104 00109000
         IC    @15,TBLENTLN(,WKREG1)                               0104 00110000
         ALR   WKREG1,@15                                          0104 00111000
*     WKREG1=WKREG1+1;              /* UPDATE THAT PTR BY ONE        */ 00112000
         AH    WKREG1,@CH00036                                     0105 00113000
*   END;                                                           0106 00114000
         LA    @15,1                                               0106 00115000
         AL    @15,X                                               0106 00116000
         ST    @15,X                                               0106 00117000
         CH    @15,@CH00080                                        0106 00118000
         BNH   @DL00090                                            0106 00119000
*I006C01A:                                                         0107 00120000
*                                                                  0107 00121000
*   /*****************************************************************/ 00122000
*   /*                                                               */ 00123000
*   /* TCEC MSGN(299) INVOKED                                        */ 00124000
*   /*                                                               */ 00125000
*   /*****************************************************************/ 00126000
*                                                                  0107 00127000
*   $TCECM='1'B;                    /* SET TCEC SW IN RCA            */ 00128000
I006C01A OI    $TCECM(WAPTR),B'00000001'                           0107 00129000
*   R1=ADDR($TCA10);                /* SET UP PARM LIST $TR          */ 00130000
         LA    R1,$TCA10                                           0108 00131000
*   CALL #EXIT;                     /* CALL CECOM                    */ 00132000
         L     @15,#EXITA(,WAPTR)                                  0109 00133000
         BALR  @14,@15                                             0109 00134000
*   DCL                                                            0110 00135000
*     1 $TCA10,                     /* TCEC PARM LIST                */ 00136000
*      2 $TCB10 FIXED(32) INIT(299),/* MSG NUMBER                    */ 00137000
*      2 $TCC10 FIXED(32) INIT(0),  /* INCT LEN                      */ 00138000
*      2 $TCD10 BIT(8) INIT('00000000'B),/* FLAG                     */ 00139000
*      2 $TCE10 CHAR(4) INIT('FFFFFFFF'X);/* MSSAGE MASK INVALID   0110 00140000
*                                      ENTRY,RE-ENTER                */ 00141000
*   GOTO I006C01;                   /* GO GET NEW RESPONSE           */ 00142000
         B     I006C01                                             0111 00143000
*/* THIS SECTION SETS UP THE UNIT ADDRESS OR SYMBOLIC NAME IN THE    */ 00144000
*/* CDS BUILD AREA AND INITIALIZES THE PROPER SWITCHES               */ 00145000
*                                                                  0112 00146000
*I006C02:                                                          0112 00147000
*   R1=ADDR(CDSUA);                 /* SET UP SECONDARY BASE         */ 00148000
I006C02  L     R1,CDSWKPTR                                         0112 00149000
*   GEN;                                                           0113 00150000
*                                                                  0113 00151000
         XC  0(255,R1),0(R1)            /*ZERO OUT CDS WORK AREA     */ 00152000
*   /*****************************************************************/ 00153000
*   /*                                                               */ 00154000
*   /* TCEC MSGN(578)INCT(8) INVOKED                                 */ 00155000
*   /*                                                               */ 00156000
*   /*****************************************************************/ 00157000
*                                                                  0114 00158000
*   $TCECM='1'B;                    /* SET TCEC SW IN RCA            */ 00159000
         OI    $TCECM(WAPTR),B'00000001'                           0114 00160000
*   R1=ADDR($TCA11);                /* SET UP PARM LIST $TR          */ 00161000
         LA    R1,$TCA11                                           0115 00162000
*   CALL #EXIT;                     /* CALL CECOM                    */ 00163000
         L     @15,#EXITA(,WAPTR)                                  0116 00164000
         BALR  @14,@15                                             0116 00165000
*   DCL                                                            0117 00166000
*     1 $TCA11,                     /* TCEC PARM LIST                */ 00167000
*      2 $TCB11 FIXED(32) INIT(578),/* MSG NUMBER                    */ 00168000
*      2 $TCC11 FIXED(32) INIT(8),  /* INCT LEN                      */ 00169000
*      2 $TCD11 BIT(8) INIT('01000000'B),/* FLAG                     */ 00170000
*      2 $TCE11 CHAR(4) INIT('FFFFFFFF'X);/* MSSAGE MASK GET SYMBOLIC   00171000
*                                      NAME OR CUA                   */ 00172000
*   IF $INBUFR(2:LENGTH(NUMBERIC)+1)<NUMBERIC THEN/* WHICH WOULD   0118 00173000
*                                      INDICATE A                    */ 00174000
         CLC   $INBUFR+1(1,WAPTR),NUMBERIC                         0118 00175000
         BNL   @RF00118                                            0118 00176000
*     DO;                                                          0119 00177000
*       $REMSW='1'B;                /* TURN ON REMOTE SW IN RCA      */ 00178000
         OI    $REMSW(WAPTR),B'01000000'                           0120 00179000
*       CDSREMSY='1'B;              /* TURN ON REMOTE SW IN CDS      */ 00180000
*       CDSSYMB='1'B;               /* TURN ON SYMBOLIC SW IN CDS    */ 00181000
         L     @15,CDSWKPTR                                        0122 00182000
         OI    CDSREMSY(@15),B'00001010'                           0122 00183000
*       CDSSYMBN='        ';        /* BLANK OUT NAME        @DM44548*/ 00184000
         MVC   CDSSYMBN(8,@15),@CC00835                            0123 00185000
*       CDSSYMBN=$INBUFR(2:(($INBUFR(1:1)+1)));/* MOVE NAME TO CDS   */ 00186000
         MVI   CDSSYMBN+1(@15),C' '                                0124 00187000
         MVC   CDSSYMBN+2(6,@15),CDSSYMBN+1(@15)                   0124 00188000
         SLR   @12,@12                                             0124 00189000
         IC    @12,$INBUFR(,WAPTR)                                 0124 00190000
         BCTR  @12,0                                               0124 00191000
         EX    @12,@SM00895                                        0124 00192000
*     END;                                                         0125 00193000
*   ELSE                                                           0126 00194000
*     DO;                           /* CUA ENTRY                     */ 00195000
         B     @RC00118                                            0126 00196000
@RF00118 DS    0H                                                  0127 00197000
*       $REMSW='0'B;                /* TURN OFF REMOTE FLAG          */ 00198000
         NI    $REMSW(WAPTR),B'10111111'                           0127 00199000
*       IF THREE=$INBUFR(1:1)       /* IF HE ENTERED ONLY A 3-BYTE   */ 00200000
*         THEN                      /* ADDRESS THEN MAKE IT LOOK     */ 00201000
         CLC   THREE(1),$INBUFR(WAPTR)                             0128 00202000
         BNE   @RF00128                                            0128 00203000
*         DO;                       /* LIKE A FOUR BYTE ENTRY        */ 00204000
*           WKAREA(1:2)=NUMBERIC;                                  0130 00205000
         MVI   WKAREA+1,C' '                                       0130 00206000
         MVC   WKAREA(1),NUMBERIC                                  0130 00207000
*           WKAREA(2:4)=$INBUFR(2:5);                              0131 00208000
         MVC   WKAREA+1(3),$INBUFR+1(WAPTR)                        0131 00209000
*         END;                                                     0132 00210000
*       ELSE                        /* IF IT WAS A 4-BYTE ENTRY      */ 00211000
*         DO;                       /* THEN JUST MOVE IT IN          */ 00212000
         B     @RC00128                                            0133 00213000
@RF00128 DS    0H                                                  0134 00214000
*           WKAREA(1:4)=$INBUFR(2:5);                              0134 00215000
         MVC   WKAREA(4),$INBUFR+1(WAPTR)                          0134 00216000
*         END;                                                     0135 00217000
*                                                                  0135 00218000
*       /*************************************************************/ 00219000
*       /*                                                           */ 00220000
*       /* ITACONV FROM(WKAREA)TO(WKAREA1)COUNT(4)TYPE(EH) INVOKED   */ 00221000
*       /*                                                           */ 00222000
*       /*************************************************************/ 00223000
*                                                                  0136 00224000
*       DCL                                                        0136 00225000
*         1 ITATCPRM BDY(WORD),     /* CONVERT PARAMETER LIST        */ 00226000
*          2 * CHAR(4) INIT('0102F4F1'X),                          0136 00227000
*          2 ITATCFR PTR,           /* ADDRESS OF FROM FIELD         */ 00228000
*          2 ITATCTO PTR,           /* ADDRESS OF TO FIELD           */ 00229000
*          2 * BIT(8) INIT(0),      /* FLAGS FOR CONVERT MODULE      */ 00230000
*           3 ITATCTP BIT(1),       /* TYPE OF CONVERT REQUIRED      */ 00231000
*          2 ITATCNT FIXED(8);      /* NUMBER OF BYTES TO CONVERT    */ 00232000
@RC00128 DS    0H                                                  0137 00233000
*       ITATCFR=ADDR(WKAREA);       /* SET THE FROM ADDRESS          */ 00234000
         LA    @15,WKAREA                                          0137 00235000
         ST    @15,ITATCFR                                         0137 00236000
*       ITATCTO=ADDR(WKAREA1);      /* SET THE TO ADDRESS            */ 00237000
         LA    @15,WKAREA1                                         0138 00238000
         ST    @15,ITATCTO                                         0138 00239000
*       ITATCTP='0'B;               /* SET THE TYPE OF CONVERT BIT   */ 00240000
         NI    ITATCTP,B'01111111'                                 0139 00241000
*       ITATCNT=4;                  /* GIVE THE CONVERT BYTE COUNT   */ 00242000
         MVI   ITATCNT,X'04'                                       0140 00243000
*       R1=ADDR(ITATCPRM);          /* POINT TO CONVERT PARM LIST    */ 00244000
         LA    R1,ITATCPRM                                         0141 00245000
*       CALL ISTSC021;              /* CALL CONVERT DIRECTLY         */ 00246000
         L     @15,@CV00845                                        0142 00247000
         BALR  @14,@15                                             0142 00248000
*       WKREG1=ADDR(CDSUA);         /* SET UP BASE FOR NXT INSTR     */ 00249000
         L     WKREG1,CDSWKPTR                                     0143 00250000
*       GEN;                                                       0144 00251000
*                                       /*                              00252000
               XC  0(4,WKREG1),0(WKREG1)  ZERO OUT CDSUA                00253000
               MVC 2(2,WKREG1),WKAREA1    MOVE IN CONVERTED ADDR        00254000
*     END;                                                         0145 00255000
*                                                                  0145 00256000
*/* CHECK TO SEE IF THE CDS REQUESTED IS KNOWN TO VTAM               */ 00257000
*                                                                  0146 00258000
*   R1=ADDR(VERYTBL);               /* SET UP PARM LIST PTR AND      */ 00259000
@RC00118 LA    R1,VERYTBL                                          0146 00260000
*   CDSPTR=ADDR(CDSUA);             /* CDS PTR FOR VERIFY            */ 00261000
         MVC   CDSPTR(4),CDSWKPTR                                  0147 00262000
*   CALL ISTSC030;                  /* CALL VERIFY MODULE            */ 00263000
         L     @15,@CV00846                                        0148 00264000
         BALR  @14,@15                                             0148 00265000
*   IF R15=0                        /* IF VERIFY WAS GOOD            */ 00266000
*     THEN                          /* THEN PUT CDS DATA IN $WORK    */ 00267000
         LTR   R15,R15                                             0149 00268000
         BNZ   @RF00149                                            0149 00269000
*     DO;                           /* AND CALL RESPECTIVE FUNCT     */ 00270000
*       GEN;                                                       0151 00271000
*                                       /*                              00272000
               BR  CALLREG                                           */ 00273000
*     END;                                                         0152 00274000
*I006C02A:                                                         0153 00275000
*   GOTO I006C01;                   /* PRT HEADER LINE               */ 00276000
         B     I006C01                                             0153 00277000
*I006CRET:                                                         0154 00278000
*   RETURN;                                                        0154 00279000
*   GEN(EJECT);                                                    0155 00280000
*                                                                  0155 00281000
         EJECT                                                          00282000
*/* BRANCH TABLE                                                     */ 00283000
*                                                                  0156 00284000
*   GEN;                                                           0156 00285000
CALLTBL  DS   0H                                                        00286000
          B    I006C03                    GO CALL DELETE                00287000
          B    I006C03A                   GO CALL ADD                   00288000
          B    I006C03B                   GO CALL CHANGE                00289000
          B    I006C03C                   GO CALL COPY                  00290000
          B    I006C03D                   GO EXEC EXHIBIT               00291000
*I006C03:                                                          0157 00292000
*   CALL ISTIC007;                  /* CALL DELETE                   */ 00293000
I006C03  L     @15,@CV00851                                        0157 00294000
         BALR  @14,@15                                             0157 00295000
*   GOTO I006C02A;                  /* GO CK FOR CONTINUATION        */ 00296000
         B     I006C02A                                            0158 00297000
*I006C03A:                                                         0159 00298000
*   CALL ISTIC008;                  /* CALL ADD                      */ 00299000
I006C03A L     @15,@CV00854                                        0159 00300000
         BALR  @14,@15                                             0159 00301000
*   GOTO I006C02A;                  /* GO CK FOR CONTINUATION        */ 00302000
         B     I006C02A                                            0160 00303000
*I006C03B:                                                         0161 00304000
*   $CHANGE='1'B;                   /* TURN ON CHANGE BIT            */ 00305000
I006C03B OI    $CHANGE(WAPTR),B'00100000'                          0161 00306000
*   CALL ISTIC009;                  /* CALL CHANGE                   */ 00307000
         L     @15,@CV00858                                        0162 00308000
         BALR  @14,@15                                             0162 00309000
*   GOTO I006C02A;                  /* GO CK FOR CONTINUATION        */ 00310000
         B     I006C02A                                            0163 00311000
*I006C03C:                                                         0164 00312000
*   $COPY='1'B;                     /* TURN ON COPY BIT              */ 00313000
I006C03C OI    $COPY(WAPTR),B'00001000'                            0164 00314000
*   CALL ISTIC009;                  /* CALL COPY                     */ 00315000
         L     @15,@CV00858                                        0165 00316000
         BALR  @14,@15                                             0165 00317000
*   GOTO I006C02A;                  /* GO CK FOR CONTINUATION        */ 00318000
         B     I006C02A                                            0166 00319000
*I006C03D:                                                         0167 00320000
*   DCL                                                            0167 00321000
*     1 ZZZGTPRM BDY(WORD),         /* GETCONFG PARAMETER LIST       */ 00322000
*      2 * CHAR(4) INIT('0102F1F6'X),                              0167 00323000
*      2 ZZZGTCD PTR,               /* POINTER TO BASIC CDS INFO     */ 00324000
*      2 ZZZGTAD PTR,               /* POINTER TO RECEIVING BUFFER   */ 00325000
*      2 ZZZGTCT FIXED(8);          /* NUMBER OF CDS BYTES NEEDED    */ 00326000
I006C03D DS    0H                                                  0168 00327000
*   ZZZGTAD=ADDR(CDSUA);            /* POINTER TO RECEIVING BUFFER   */ 00328000
         L     @15,CDSWKPTR                                        0168 00329000
         ST    @15,ZZZGTAD                                         0168 00330000
*   ZZZGTCD=ADDR(CDSUA);            /* POINTER TO BASIC CDS INFO     */ 00331000
         ST    @15,ZZZGTCD                                         0169 00332000
*   ZZZGTCT=255;                    /* NUMBER OF BYTES NEEDED        */ 00333000
         MVI   ZZZGTCT,X'FF'                                       0170 00334000
*   R1=ADDR(ZZZGTPRM);              /* POINT TO THE PARM LIST        */ 00335000
         LA    R1,ZZZGTPRM                                         0171 00336000
*   CALL ISTSC029;                  /* CALL THE GETCONFG FUNCTION    */ 00337000
         L     @15,@CV00870                                        0172 00338000
         BALR  @14,@15                                             0172 00339000
*/* START OF EXHIBIT FUNCTION                                        */ 00340000
*                                                                  0173 00341000
*   IF R15=0 THEN                   /* IF WE FOUND CDS THEN          */ 00342000
         LTR   R15,R15                                             0173 00343000
         BZ    @RT00173                                            0173 00344000
*     GOTO I006C04;                 /* CONTINUE                      */ 00345000
*                                                                  0174 00346000
*   /*****************************************************************/ 00347000
*   /*                                                               */ 00348000
*   /* TCEC MSGN(574) INVOKED                                        */ 00349000
*   /*                                                               */ 00350000
*   /*****************************************************************/ 00351000
*                                                                  0175 00352000
*   $TCECM='1'B;                    /* SET TCEC SW IN RCA            */ 00353000
         OI    $TCECM(WAPTR),B'00000001'                           0175 00354000
*   R1=ADDR($TCA14);                /* SET UP PARM LIST $TR          */ 00355000
         LA    R1,$TCA14                                           0176 00356000
*   CALL #EXIT;                     /* CALL CECOM                    */ 00357000
         L     @15,#EXITA(,WAPTR)                                  0177 00358000
         BALR  @14,@15                                             0177 00359000
*   DCL                                                            0178 00360000
*     1 $TCA14,                     /* TCEC PARM LIST                */ 00361000
*      2 $TCB14 FIXED(32) INIT(574),/* MSG NUMBER                    */ 00362000
*      2 $TCC14 FIXED(32) INIT(0),  /* INCT LEN                      */ 00363000
*      2 $TCD14 BIT(8) INIT('00000000'B),/* FLAG                     */ 00364000
*      2 $TCE14 CHAR(4) INIT('FFFFFFFF'X);/* MSSAGE MASK DEVICE NOT     00365000
*                                      CONFIGURED                    */ 00366000
*   GOTO I006C02A;                  /* SEE IF HE WANTS TO CONT       */ 00367000
         B     I006C02A                                            0179 00368000
*   GEN(EJECT);                                                    0180 00369000
         EJECT                                                          00370000
*I006C04:                                                          0181 00371000
*   PRNTBUF1=TERMHD;                /* SET UP TERMINAL CONFIG HD     */ 00372000
I006C04  MVC   PRNTBUF1(22,WAPTR),TERMHD                           0181 00373000
*   FILLER(1:22)=BLANKHD;           /* BLANK OUT REST OF AREA        */ 00374000
         MVC   FILLER(22,WAPTR),BLANKHD                            0182 00375000
*   GEN(BAL LINKR,I006CMSG);        /* GO PRINT HEADINGS             */ 00376000
         BAL LINKR,I006CMSG                                             00377000
*   PRNTBUF1=SUBHD01;               /* 'FIELD BYTES'                 */ 00378000
         MVC   PRNTBUF1(22,WAPTR),SUBHD01                          0184 00379000
*   FILLER(1:22)=CONTNTHD;          /* CONTENTS                      */ 00380000
         MVC   FILLER(22,WAPTR),CONTNTHD                           0185 00381000
*   GEN(BAL LINKR,I006CMSG);        /* GO PRINT SUB-HEADING          */ 00382000
         BAL LINKR,I006CMSG                                             00383000
*   PRNTBUF1=UNITADHD;              /* SET UP UNIT ADDR HEADING      */ 00384000
*                                                                  0187 00385000
         MVC   PRNTBUF1(22,WAPTR),UNITADHD                         0187 00386000
*   /*****************************************************************/ 00387000
*   /*                                                               */ 00388000
*   /* ITACONV FROM(CDSUA)TO(PRNTBUF2)COUNT(4)TYPE(HE) INVOKED       */ 00389000
*   /*                                                               */ 00390000
*   /*****************************************************************/ 00391000
*                                                                  0188 00392000
*   ITATCFR=ADDR(CDSUA);            /* SET THE FROM ADDRESS          */ 00393000
         MVC   ITATCFR(4),CDSWKPTR                                 0188 00394000
*   ITATCTO=ADDR(PRNTBUF2);         /* SET THE TO ADDRESS            */ 00395000
         LA    @15,PRNTBUF2(,WAPTR)                                0189 00396000
         ST    @15,ITATCTO                                         0189 00397000
*   ITATCTP='1'B;                   /* SET THE TYPE OF CONVERT BIT   */ 00398000
         OI    ITATCTP,B'10000000'                                 0190 00399000
*   ITATCNT=4;                      /* GIVE THE CONVERT BYTE COUNT   */ 00400000
         MVI   ITATCNT,X'04'                                       0191 00401000
*   R1=ADDR(ITATCPRM);              /* POINT TO CONVERT PARM LIST    */ 00402000
         LA    R1,ITATCPRM                                         0192 00403000
*   CALL ISTSC021;                  /* CALL CONVERT DIRECTLY         */ 00404000
         L     @15,@CV00845                                        0193 00405000
         BALR  @14,@15                                             0193 00406000
*   GEN(BAL LINKR,I006CMSG);        /* GO PRINT UNIT ADDR LINE       */ 00407000
         BAL LINKR,I006CMSG                                             00408000
*   PRNTBUF1=MODELHD;               /* SET UP MODEL HEADING          */ 00409000
*                                                                  0195 00410000
         MVC   PRNTBUF1(22,WAPTR),MODELHD                          0195 00411000
*   /*****************************************************************/ 00412000
*   /*                                                               */ 00413000
*   /* ITACONV FROM(CDSMODEL)TO(PRNTBUF2)COUNT(1)TYPE(HE) INVOKED    */ 00414000
*   /*                                                               */ 00415000
*   /*****************************************************************/ 00416000
*                                                                  0196 00417000
*   ITATCFR=ADDR(CDSMODEL);         /* SET THE FROM ADDRESS          */ 00418000
         L     @15,CDSWKPTR                                        0196 00419000
         LA    @15,CDSMODEL(,@15)                                  0196 00420000
         ST    @15,ITATCFR                                         0196 00421000
*   ITATCTO=ADDR(PRNTBUF2);         /* SET THE TO ADDRESS            */ 00422000
         LA    @15,PRNTBUF2(,WAPTR)                                0197 00423000
         ST    @15,ITATCTO                                         0197 00424000
*   ITATCTP='1'B;                   /* SET THE TYPE OF CONVERT BIT   */ 00425000
         OI    ITATCTP,B'10000000'                                 0198 00426000
*   ITATCNT=1;                      /* GIVE THE CONVERT BYTE COUNT   */ 00427000
         MVI   ITATCNT,X'01'                                       0199 00428000
*   R1=ADDR(ITATCPRM);              /* POINT TO CONVERT PARM LIST    */ 00429000
         LA    R1,ITATCPRM                                         0200 00430000
*   CALL ISTSC021;                  /* CALL CONVERT DIRECTLY         */ 00431000
         L     @15,@CV00845                                        0201 00432000
         BALR  @14,@15                                             0201 00433000
*   GEN(BAL LINKR,I006CMSG);        /* GO PRINT MODEL LINE           */ 00434000
         BAL LINKR,I006CMSG                                             00435000
*   PRNTBUF1=FEATHD;                /* SET UP FEATURE HEADING        */ 00436000
*                                                                  0203 00437000
         MVC   PRNTBUF1(22,WAPTR),FEATHD                           0203 00438000
*   /*****************************************************************/ 00439000
*   /*                                                               */ 00440000
*   /* ITACONV FROM(CDSFEAT)TO(PRNTBUF2)COUNT(1)TYPE(HE) INVOKED     */ 00441000
*   /*                                                               */ 00442000
*   /*****************************************************************/ 00443000
*                                                                  0204 00444000
*   ITATCFR=ADDR(CDSFEAT);          /* SET THE FROM ADDRESS          */ 00445000
         L     @15,CDSWKPTR                                        0204 00446000
         LA    @15,CDSFEAT(,@15)                                   0204 00447000
         ST    @15,ITATCFR                                         0204 00448000
*   ITATCTO=ADDR(PRNTBUF2);         /* SET THE TO ADDRESS            */ 00449000
         LA    @15,PRNTBUF2(,WAPTR)                                0205 00450000
         ST    @15,ITATCTO                                         0205 00451000
*   ITATCTP='1'B;                   /* SET THE TYPE OF CONVERT BIT   */ 00452000
         OI    ITATCTP,B'10000000'                                 0206 00453000
*   ITATCNT=1;                      /* GIVE THE CONVERT BYTE COUNT   */ 00454000
         MVI   ITATCNT,X'01'                                       0207 00455000
*   R1=ADDR(ITATCPRM);              /* POINT TO CONVERT PARM LIST    */ 00456000
         LA    R1,ITATCPRM                                         0208 00457000
*   CALL ISTSC021;                  /* CALL CONVERT DIRECTLY         */ 00458000
         L     @15,@CV00845                                        0209 00459000
         BALR  @14,@15                                             0209 00460000
*   GEN(BAL LINKR,I006CMSG);        /* GO PRINT FEATURE LINE         */ 00461000
         BAL LINKR,I006CMSG                                             00462000
*   PRNTBUF1=CLASSHD;               /* SET UP CLASS HEADING          */ 00463000
*                                                                  0211 00464000
         MVC   PRNTBUF1(22,WAPTR),CLASSHD                          0211 00465000
*   /*****************************************************************/ 00466000
*   /*                                                               */ 00467000
*   /* ITACONV FROM(CDSCLASS)TO(PRNTBUF2)COUNT(1)TYPE(HE) INVOKED    */ 00468000
*   /*                                                               */ 00469000
*   /*****************************************************************/ 00470000
*                                                                  0212 00471000
*   ITATCFR=ADDR(CDSCLASS);         /* SET THE FROM ADDRESS          */ 00472000
         L     @15,CDSWKPTR                                        0212 00473000
         LA    @15,CDSCLASS(,@15)                                  0212 00474000
         ST    @15,ITATCFR                                         0212 00475000
*   ITATCTO=ADDR(PRNTBUF2);         /* SET THE TO ADDRESS            */ 00476000
         LA    @15,PRNTBUF2(,WAPTR)                                0213 00477000
         ST    @15,ITATCTO                                         0213 00478000
*   ITATCTP='1'B;                   /* SET THE TYPE OF CONVERT BIT   */ 00479000
         OI    ITATCTP,B'10000000'                                 0214 00480000
*   ITATCNT=1;                      /* GIVE THE CONVERT BYTE COUNT   */ 00481000
         MVI   ITATCNT,X'01'                                       0215 00482000
*   R1=ADDR(ITATCPRM);              /* POINT TO CONVERT PARM LIST    */ 00483000
         LA    R1,ITATCPRM                                         0216 00484000
*   CALL ISTSC021;                  /* CALL CONVERT DIRECTLY         */ 00485000
         L     @15,@CV00845                                        0217 00486000
         BALR  @14,@15                                             0217 00487000
*   GEN(BAL LINKR,I006CMSG);        /* GO PRINT CLASS LINE           */ 00488000
         BAL LINKR,I006CMSG                                             00489000
*   PRNTBUF1=TYPEHD;                /* SET UP TYPE HEADING           */ 00490000
*                                                                  0219 00491000
         MVC   PRNTBUF1(22,WAPTR),TYPEHD                           0219 00492000
*   /*****************************************************************/ 00493000
*   /*                                                               */ 00494000
*   /* ITACONV FROM(CDSTYPE)TO(PRNTBUF2)COUNT(1)TYPE(HE) INVOKED     */ 00495000
*   /*                                                               */ 00496000
*   /*****************************************************************/ 00497000
*                                                                  0220 00498000
*   ITATCFR=ADDR(CDSTYPE);          /* SET THE FROM ADDRESS          */ 00499000
         L     @15,CDSWKPTR                                        0220 00500000
         LA    @15,CDSTYPE(,@15)                                   0220 00501000
         ST    @15,ITATCFR                                         0220 00502000
*   ITATCTO=ADDR(PRNTBUF2);         /* SET THE TO ADDRESS            */ 00503000
         LA    @15,PRNTBUF2(,WAPTR)                                0221 00504000
         ST    @15,ITATCTO                                         0221 00505000
*   ITATCTP='1'B;                   /* SET THE TYPE OF CONVERT BIT   */ 00506000
         OI    ITATCTP,B'10000000'                                 0222 00507000
*   ITATCNT=1;                      /* GIVE THE CONVERT BYTE COUNT   */ 00508000
         MVI   ITATCNT,X'01'                                       0223 00509000
*   R1=ADDR(ITATCPRM);              /* POINT TO CONVERT PARM LIST    */ 00510000
         LA    R1,ITATCPRM                                         0224 00511000
*   CALL ISTSC021;                  /* CALL CONVERT DIRECTLY         */ 00512000
         L     @15,@CV00845                                        0225 00513000
         BALR  @14,@15                                             0225 00514000
*   GEN(BAL LINKR,I006CMSG);        /* PRINT TYPE LINE               */ 00515000
         BAL LINKR,I006CMSG                                             00516000
*   PRNTBUF1=BYTECTHD;              /* SET UP BYTE COUNT HEADING     */ 00517000
*                                                                  0227 00518000
         MVC   PRNTBUF1(22,WAPTR),BYTECTHD                         0227 00519000
*   /*****************************************************************/ 00520000
*   /*                                                               */ 00521000
*   /* ITACONV FROM(CDSBYTCT)TO(PRNTBUF2)COUNT(1)TYPE(HE) INVOKED    */ 00522000
*   /*                                                               */ 00523000
*   /*****************************************************************/ 00524000
*                                                                  0228 00525000
*   ITATCFR=ADDR(CDSBYTCT);         /* SET THE FROM ADDRESS          */ 00526000
         L     @15,CDSWKPTR                                        0228 00527000
         LA    @15,CDSBYTCT(,@15)                                  0228 00528000
         ST    @15,ITATCFR                                         0228 00529000
*   ITATCTO=ADDR(PRNTBUF2);         /* SET THE TO ADDRESS            */ 00530000
         LA    @15,PRNTBUF2(,WAPTR)                                0229 00531000
         ST    @15,ITATCTO                                         0229 00532000
*   ITATCTP='1'B;                   /* SET THE TYPE OF CONVERT BIT   */ 00533000
         OI    ITATCTP,B'10000000'                                 0230 00534000
*   ITATCNT=1;                      /* GIVE THE CONVERT BYTE COUNT   */ 00535000
         MVI   ITATCNT,X'01'                                       0231 00536000
*   R1=ADDR(ITATCPRM);              /* POINT TO CONVERT PARM LIST    */ 00537000
         LA    R1,ITATCPRM                                         0232 00538000
*   CALL ISTSC021;                  /* CALL CONVERT DIRECTLY         */ 00539000
         L     @15,@CV00845                                        0233 00540000
         BALR  @14,@15                                             0233 00541000
*   GEN(BAL LINKR,I006CMSG);        /* GO PRINT BYTE COUNT LINE      */ 00542000
         BAL LINKR,I006CMSG                                             00543000
*   PRNTBUF1=FLAG01HD;              /* SET UP FLAG HEADING           */ 00544000
*                                                                  0235 00545000
         MVC   PRNTBUF1(22,WAPTR),FLAG01HD                         0235 00546000
*   /*****************************************************************/ 00547000
*   /*                                                               */ 00548000
*   /* ITACONV FROM(CDSFLAG)TO(PRNTBUF2)COUNT(3)TYPE(HE) INVOKED     */ 00549000
*   /*                                                               */ 00550000
*   /*****************************************************************/ 00551000
*                                                                  0236 00552000
*   ITATCFR=ADDR(CDSFLAG);          /* SET THE FROM ADDRESS          */ 00553000
         L     @15,CDSWKPTR                                        0236 00554000
         LA    @15,CDSFLAG(,@15)                                   0236 00555000
         ST    @15,ITATCFR                                         0236 00556000
*   ITATCTO=ADDR(PRNTBUF2);         /* SET THE TO ADDRESS            */ 00557000
         LA    @15,PRNTBUF2(,WAPTR)                                0237 00558000
         ST    @15,ITATCTO                                         0237 00559000
*   ITATCTP='1'B;                   /* SET THE TYPE OF CONVERT BIT   */ 00560000
         OI    ITATCTP,B'10000000'                                 0238 00561000
*   ITATCNT=3;                      /* GIVE THE CONVERT BYTE COUNT   */ 00562000
         MVI   ITATCNT,X'03'                                       0239 00563000
*   R1=ADDR(ITATCPRM);              /* POINT TO CONVERT PARM LIST    */ 00564000
         LA    R1,ITATCPRM                                         0240 00565000
*   CALL ISTSC021;                  /* CALL CONVERT DIRECTLY         */ 00566000
         L     @15,@CV00845                                        0241 00567000
         BALR  @14,@15                                             0241 00568000
*   GEN(BAL LINKR,I006CMSG);        /* GO PRINT FLAG LINE            */ 00569000
         BAL LINKR,I006CMSG                                             00570000
*   IF $REMSW¬='1'B THEN            /* IF ITS NOT REMOTE RUN         */ 00571000
         TM    $REMSW(WAPTR),B'01000000'                           0243 00572000
         BO    @RF00243                                            0243 00573000
*     DO;                                                          0244 00574000
*       IF CDSBYTCT<12              /* IF NO EXTRA DATA              */ 00575000
*         THEN                      /* THEN                          */ 00576000
         L     @15,CDSWKPTR                                        0245 00577000
         CLI   CDSBYTCT(@15),12                                    0245 00578000
         BL    @RT00245                                            0245 00579000
*         GOTO I006C02A;            /* GO BACK AROUND                */ 00580000
*       ELSE                        /* ELSE                          */ 00581000
*         Z=CDSBYTCT-12;            /* POINT TO REMAINING DATA     0247 00582000
*                                                            @YA04055*/ 00583000
         SLR   @12,@12                                             0247 00584000
         IC    @12,CDSBYTCT(,@15)                                  0247 00585000
         SH    @12,@CH00263                                        0247 00586000
         STC   @12,Z                                               0247 00587000
*       REMPTR=ADDR(CDSSYMBN);      /* PT YO BYTE 12                 */ 00588000
         LA    REMPTR,CDSSYMBN(,@15)                               0248 00589000
*       GOTO I006C04C;              /* THEN BR AROUND                */ 00590000
         B     I006C04C                                            0249 00591000
*     END;                                                         0250 00592000
*   PRNTBUF1=SYMNMEHD;              /* SET UP SYM NME HEADING        */ 00593000
@RF00243 MVC   PRNTBUF1(22,WAPTR),SYMNMEHD                         0251 00594000
*   PRNTBUF2=CDSSYMBN;              /* SET UP SYMBOLIC NAME          */ 00595000
         MVI   PRNTBUF2+8(WAPTR),C' '                              0252 00596000
         MVC   PRNTBUF2+9(9,WAPTR),PRNTBUF2+8(WAPTR)               0252 00597000
         L     @15,CDSWKPTR                                        0252 00598000
         MVC   PRNTBUF2(8,WAPTR),CDSSYMBN(@15)                     0252 00599000
*   GEN(BAL LINKR,I006CMSG);        /* GO PRINT SYMBOLIC NAME LN     */ 00600000
         BAL LINKR,I006CMSG                                             00601000
*   IF CDSBYTCT<20                  /* IF WE DO NOT HAVE CDS DATA    */ 00602000
*     THEN                                                         0254 00603000
         L     @15,CDSWKPTR                                        0254 00604000
         CLI   CDSBYTCT(@15),20                                    0254 00605000
         BL    @RT00254                                            0254 00606000
*     GOTO I006C02A;                /* THEN BR AROUND                */ 00607000
*   ELSE                                                           0256 00608000
*     DO;                           /* PRINT THAT DATA (MAX-235)     */ 00609000
*       REMPTR=ADDR(CDSEXARA);      /* PT TO BYTE 20                 */ 00610000
         LA    REMPTR,CDSEXARA(,@15)                               0257 00611000
*       Z=CDSBYTCT-20;              /* ADJUST FOR 0-20 BYTES @YA04055*/ 00612000
         SLR   @12,@12                                             0258 00613000
         IC    @12,CDSBYTCT(,@15)                                  0258 00614000
         SH    @12,@CH00068                                        0258 00615000
         STC   @12,Z                                               0258 00616000
*I006C04C:                                                         0259 00617000
*       PRNTBUF1=REMGHD;            /* SET UP 'REMAINING' HD         */ 00618000
I006C04C MVC   PRNTBUF1(22,WAPTR),REMGHD                           0259 00619000
*       I=Z/8;                      /* GET NUMBER OF DO LOOPS        */ 00620000
         SLR   @15,@15                                             0260 00621000
         IC    @15,Z                                               0260 00622000
         LR    @12,@15                                             0260 00623000
         SRL   @12,3                                               0260 00624000
         STC   @12,I                                               0260 00625000
*       R=Z//8;                     /* GET REMAINDER                 */ 00626000
         LR    @00,@15                                             0261 00627000
         SRDA  @00,32                                              0261 00628000
         D     @00,@CF00055                                        0261 00629000
         STC   @00,R                                               0261 00630000
*       X=0;                        /* RESET INDEX VALUE             */ 00631000
         SLR   @15,@15                                             0262 00632000
         ST    @15,X                                               0262 00633000
*       IF I<1 THEN                                                0263 00634000
         CLI   I,1                                                 0263 00635000
         BL    @RT00263                                            0263 00636000
*         GOTO I006C05;             /* SKIP LOOP IF DATA < 8         */ 00637000
*       DO Y=1 TO I BY 1;           /* CONVERT AND PRINT DATA        */ 00638000
*                                                                  0265 00639000
         LA    @15,1                                               0265 00640000
         ST    @15,Y                                               0265 00641000
         B     @DE00265                                            0265 00642000
@DL00265 DS    0H                                                  0266 00643000
*         /***********************************************************/ 00644000
*         /*                                                         */ 00645000
*         /* ITACONV FROM(REMAREA)TO(PRNTBUF2)COUNT(8)TYPE(HE)       */ 00646000
*         /* INVOKED                                                 */ 00647000
*         /*                                                         */ 00648000
*         /***********************************************************/ 00649000
*                                                                  0266 00650000
*         ITATCFR=ADDR(REMAREA);    /* SET THE FROM ADDRESS          */ 00651000
         ST    REMPTR,ITATCFR                                      0266 00652000
*         ITATCTO=ADDR(PRNTBUF2);   /* SET THE TO ADDRESS            */ 00653000
         LA    @15,PRNTBUF2(,WAPTR)                                0267 00654000
         ST    @15,ITATCTO                                         0267 00655000
*         ITATCTP='1'B;             /* SET THE TYPE OF CONVERT BIT   */ 00656000
         OI    ITATCTP,B'10000000'                                 0268 00657000
*         ITATCNT=8;                /* GIVE THE CONVERT BYTE COUNT   */ 00658000
         MVI   ITATCNT,X'08'                                       0269 00659000
*         R1=ADDR(ITATCPRM);        /* POINT TO CONVERT PARM LIST    */ 00660000
         LA    R1,ITATCPRM                                         0270 00661000
*         CALL ISTSC021;            /* CALL CONVERT DIRECTLY         */ 00662000
         L     @15,@CV00845                                        0271 00663000
         BALR  @14,@15                                             0271 00664000
*         GEN(BAL LINKR,I006CMSG);  /* GO PRINT DATA                 */ 00665000
         BAL LINKR,I006CMSG                                             00666000
*         X=X+8;                    /* UPDATE INDEX VALUE            */ 00667000
         LA    @15,8                                               0273 00668000
         L     @12,X                                               0273 00669000
         ALR   @12,@15                                             0273 00670000
         ST    @12,X                                               0273 00671000
*         REMPTR=REMPTR+8;                                         0274 00672000
         ALR   REMPTR,@15                                          0274 00673000
*       END;                                                       0275 00674000
         LA    @15,1                                               0275 00675000
         AL    @15,Y                                               0275 00676000
         ST    @15,Y                                               0275 00677000
@DE00265 SLR   @12,@12                                             0275 00678000
         IC    @12,I                                               0275 00679000
         CR    @15,@12                                             0275 00680000
         BNH   @DL00265                                            0275 00681000
*     END;                                                         0276 00682000
*I006C05:                                                          0277 00683000
*   IF R=0 THEN                     /* IF REMAINDER = 0, THEN BR     */ 00684000
I006C05  CLI   R,0                                                 0277 00685000
         BE    @RT00277                                            0277 00686000
*     GO TO I006C02A;               /* BR AROUND CONVERT             */ 00687000
*                                                                  0278 00688000
*   /*****************************************************************/ 00689000
*   /*                                                               */ 00690000
*   /* ITACONV FROM(REMAREA)TO(PRNTBUF2)COUNT(R)TYPE(HE) INVOKED     */ 00691000
*   /*                                                               */ 00692000
*   /*****************************************************************/ 00693000
*                                                                  0279 00694000
*   ITATCFR=ADDR(REMAREA);          /* SET THE FROM ADDRESS          */ 00695000
         ST    REMPTR,ITATCFR                                      0279 00696000
*   ITATCTO=ADDR(PRNTBUF2);         /* SET THE TO ADDRESS            */ 00697000
         LA    @15,PRNTBUF2(,WAPTR)                                0280 00698000
         ST    @15,ITATCTO                                         0280 00699000
*   ITATCTP='1'B;                   /* SET THE TYPE OF CONVERT BIT   */ 00700000
         OI    ITATCTP,B'10000000'                                 0281 00701000
*   ITATCNT=R;                      /* GIVE THE CONVERT BYTE COUNT   */ 00702000
         MVC   ITATCNT(1),R                                        0282 00703000
*   R1=ADDR(ITATCPRM);              /* POINT TO CONVERT PARM LIST    */ 00704000
         LA    R1,ITATCPRM                                         0283 00705000
*   CALL ISTSC021;                  /* CALL CONVERT DIRECTLY         */ 00706000
         L     @15,@CV00845                                        0284 00707000
         BALR  @14,@15                                             0284 00708000
*   GEN(BAL LINKR,I006CMSG);        /* GO PRINT LAST DATA BYTES      */ 00709000
         BAL LINKR,I006CMSG                                             00710000
*   GOTO I006C02A;                  /* GO CK FOR MORE TO EXHIBIT     */ 00711000
         B     I006C02A                                            0286 00712000
*   GEN(EJECT);                                                    0287 00713000
         EJECT                                                          00714000
*I006CMSG:                                                         0288 00715000
*   GEN(ST LINKR,RETSAV);           /* SAVE RETURN ADDR              */ 00716000
I006CMSG ST LINKR,RETSAV                                                00717000
*   $INBUFR(1:80)='';               /* BLANK OUT INBUFR              */ 00718000
         MVI   $INBUFR(WAPTR),C' '                                 0289 00719000
         MVC   $INBUFR+1(79,WAPTR),$INBUFR(WAPTR)                  0289 00720000
*   $INBUFR(1:44)=PRNTBUF;          /* SET UP SUBSTITUTION CHAR      */ 00721000
*                                                                  0290 00722000
         MVC   $INBUFR(44,WAPTR),PRNTBUF(WAPTR)                    0290 00723000
*   /*****************************************************************/ 00724000
*   /*                                                               */ 00725000
*   /* TCEC MSGN(579)SUB(YES) INVOKED                                */ 00726000
*   /*                                                               */ 00727000
*   /*****************************************************************/ 00728000
*                                                                  0291 00729000
*   $TCECM='1'B;                    /* SET TCEC SW IN RCA            */ 00730000
         OI    $TCECM(WAPTR),B'00000001'                           0291 00731000
*   R1=ADDR($TCA24);                /* SET UP PARM LIST $TR          */ 00732000
         LA    R1,$TCA24                                           0292 00733000
*   CALL #EXIT;                     /* CALL CECOM                    */ 00734000
         L     @15,#EXITA(,WAPTR)                                  0293 00735000
         BALR  @14,@15                                             0293 00736000
*   DCL                                                            0294 00737000
*     1 $TCA24,                     /* TCEC PARM LIST                */ 00738000
*      2 $TCB24 FIXED(32) INIT(579),/* MSG NUMBER                    */ 00739000
*      2 $TCC24 FIXED(32) INIT(0),  /* INCT LEN                      */ 00740000
*      2 $TCD24 BIT(8) INIT('10000000'B),/* FLAG                     */ 00741000
*      2 $TCE24 CHAR(4) INIT('FFFFFFFF'X);/* MSSAGE MASK PRINT MSG   */ 00742000
*   PRNTBUF1=BLANKHD;               /* BLANK OUT PRNTBUF             */ 00743000
         MVC   PRNTBUF1(22,WAPTR),BLANKHD                          0295 00744000
*   FILLER=BLANKHD;                 /* BLANK OUT PRNTBUF             */ 00745000
         MVC   FILLER(4,WAPTR),BLANKHD                             0296 00746000
*   PRNTBUF2(1:18)=BLANKHD(1:18);   /* BLANK OUT PRNT BUFFER 2       */ 00747000
         MVC   PRNTBUF2(18,WAPTR),BLANKHD                          0297 00748000
*   GEN(L  LINKR,RETSAV);           /* RESTORE RETURN REG            */ 00749000
         L  LINKR,RETSAV                                                00750000
*   GEN(BR LINKR);                  /* RETURN TO CALLER              */ 00751000
         BR LINKR                                                       00752000
*   DO;                             /* ATDSPLY                       */ 00753000
*   END;                            /* ATDSPLY                       */ 00754000
*   END ISTIC006;                                                  0302 00755000
@EL00001 L     @13,4(,@13)                                         0302 00756000
@EF00001 DS    0H                                                  0302 00757000
@ER00001 L     @14,12(,@13)                                        0302 00758000
         LM    @00,@12,20(@13)                                     0302 00759000
         BR    @14                                                 0302 00760000
@DATA    DS    0H                                                       00761000
@CH00036 DC    H'1'                                                     00762000
@CH00045 DC    H'4'                                                     00763000
@CH00080 DC    H'5'                                                     00764000
@CH00263 DC    H'12'                                                    00765000
@CH00068 DC    H'20'                                                    00766000
@CH00181 DC    H'80'                                                    00767000
@SM00895 MVC   CDSSYMBN(0,@15),$INBUFR+1(WAPTR)                         00768000
         DS    0F                                                       00769000
@SA00001 DS    18F                                                      00770000
         DS    0F                                                       00771000
@CF00055 DC    F'8'                                                     00772000
@CV00845 DC    V(ISTSC021)                                              00773000
@CV00846 DC    V(ISTSC030)                                              00774000
@CV00851 DC    V(ISTIC007)                                              00775000
@CV00854 DC    V(ISTIC008)                                              00776000
@CV00858 DC    V(ISTIC009)                                              00777000
@CV00870 DC    V(ISTSC029)                                              00778000
         DS    0D                                                       00779000
X        DC    F'0'                                                     00780000
Y        DC    F'0'                                                     00781000
RCAPTR   DS    A                                                        00782000
CDSWKPTR DS    A                                                        00783000
RETSAV   DS    F                                                        00784000
Z        DC    XL1'0'                                                   00785000
         DS    CL3                                                      00786000
I        DC    XL1'0'                                                   00787000
         DS    CL3                                                      00788000
R        DC    XL1'0'                                                   00789000
@CC00835 DC    C'        '                                              00790000
BLANK    DC    CL1' '                                                   00791000
YES      DC    CL3'YES'                                                 00792000
NO       DC    CL2'NO'                                                  00793000
NONE     DC    CL4'NONE'                                                00794000
NUMBERIC DC    CL1'0'                                                   00795000
DSPLYMSG DC    CL7'EXHIBIT'                                             00796000
THREE    DC    X'03'                                                    00797000
WKAREA   DS    CL8                                                      00798000
WKAREA1  DS    CL4                                                      00799000
VERYTBL  DS    CL5                                                      00800000
         ORG   VERYTBL                                                  00801000
CDSPTR   DS    AL4                                                      00802000
@NM00001 DC    X'00'                                                    00803000
         ORG   VERYTBL+5                                                00804000
CDSTITLE DS    CL286                                                    00805000
         ORG   CDSTITLE                                                 00806000
TERMHD   DS    CL22                                                     00807000
         ORG   TERMHD                                                   00808000
@NM00012 DC    CL22'CONFIGURATION DATA    '                             00809000
         ORG   CDSTITLE+22                                              00810000
SUBHD01  DS    CL22                                                     00811000
         ORG   SUBHD01                                                  00812000
@NM00013 DC    CL22'   FIELD         BYTES'                             00813000
         ORG   CDSTITLE+44                                              00814000
UNITADHD DS    CL22                                                     00815000
         ORG   UNITADHD                                                 00816000
@NM00014 DC    CL22'UNIT ADDRESS     00-03'                             00817000
         ORG   CDSTITLE+66                                              00818000
MODELHD  DS    CL22                                                     00819000
         ORG   MODELHD                                                  00820000
@NM00015 DC    CL22'MODEL               04'                             00821000
         ORG   CDSTITLE+88                                              00822000
FEATHD   DS    CL22                                                     00823000
         ORG   FEATHD                                                   00824000
@NM00016 DC    CL22'FEATURE             05'                             00825000
         ORG   CDSTITLE+110                                             00826000
CLASSHD  DS    CL22                                                     00827000
         ORG   CLASSHD                                                  00828000
@NM00017 DC    CL22'CLASS               06'                             00829000
         ORG   CDSTITLE+132                                             00830000
TYPEHD   DS    CL22                                                     00831000
         ORG   TYPEHD                                                   00832000
@NM00018 DC    CL22'TYPE                07'                             00833000
         ORG   CDSTITLE+154                                             00834000
BYTECTHD DS    CL22                                                     00835000
         ORG   BYTECTHD                                                 00836000
@NM00019 DC    CL22'BYTE COUNT          08'                             00837000
         ORG   CDSTITLE+176                                             00838000
FLAG01HD DS    CL22                                                     00839000
         ORG   FLAG01HD                                                 00840000
@NM00020 DC    CL22'FLAGS            09-11'                             00841000
         ORG   CDSTITLE+198                                             00842000
SYMNMEHD DS    CL22                                                     00843000
         ORG   SYMNMEHD                                                 00844000
@NM00021 DC    CL22'SYMBOLIC NAME    12-19'                             00845000
         ORG   CDSTITLE+220                                             00846000
REMGHD   DS    CL22                                                     00847000
         ORG   REMGHD                                                   00848000
@NM00022 DC    CL22'REMAINING             '                             00849000
         ORG   CDSTITLE+242                                             00850000
BLANKHD  DS    CL22                                                     00851000
         ORG   BLANKHD                                                  00852000
@NM00023 DC    CL22'                      '                             00853000
         ORG   CDSTITLE+264                                             00854000
CONTNTHD DS    CL22                                                     00855000
         ORG   CONTNTHD                                                 00856000
@NM00024 DC    CL22'    CONTENTS          '                             00857000
         ORG   CDSTITLE+286                                             00858000
         DS    CL1                                                      00859000
$TCA09   DS    CL13                                                     00860000
         ORG   $TCA09                                                   00861000
$TCB09   DC    A(560)                                                   00862000
$TCC09   DC    A(8)                                                     00863000
$TCD09   DC    B'01000000'                                              00864000
$TCE09   DC    X'FFFFFFFF'                                              00865000
         ORG   $TCA09+13                                                00866000
         DS    CL3                                                      00867000
$TCA10   DS    CL13                                                     00868000
         ORG   $TCA10                                                   00869000
$TCB10   DC    A(299)                                                   00870000
$TCC10   DC    A(0)                                                     00871000
$TCD10   DC    B'00000000'                                              00872000
$TCE10   DC    X'FFFFFFFF'                                              00873000
         ORG   $TCA10+13                                                00874000
         DS    CL3                                                      00875000
$TCA11   DS    CL13                                                     00876000
         ORG   $TCA11                                                   00877000
$TCB11   DC    A(578)                                                   00878000
$TCC11   DC    A(8)                                                     00879000
$TCD11   DC    B'01000000'                                              00880000
$TCE11   DC    X'FFFFFFFF'                                              00881000
         ORG   $TCA11+13                                                00882000
         DS    CL3                                                      00883000
ITATCPRM DS    CL14                                                     00884000
         ORG   ITATCPRM                                                 00885000
@NM00077 DC    X'0102F4F1'                                              00886000
ITATCFR  DS    AL4                                                      00887000
ITATCTO  DS    AL4                                                      00888000
@NM00078 DC    AL1(0)                                                   00889000
         ORG   @NM00078                                                 00890000
ITATCTP  DS    BL1                                                      00891000
         ORG   ITATCPRM+13                                              00892000
ITATCNT  DS    FL1                                                      00893000
         ORG   ITATCPRM+14                                              00894000
         DS    CL2                                                      00895000
ZZZGTPRM DS    CL13                                                     00896000
         ORG   ZZZGTPRM                                                 00897000
@NM00079 DC    X'0102F1F6'                                              00898000
ZZZGTCD  DS    AL4                                                      00899000
ZZZGTAD  DS    AL4                                                      00900000
ZZZGTCT  DS    FL1                                                      00901000
         ORG   ZZZGTPRM+13                                              00902000
         DS    CL3                                                      00903000
$TCA14   DS    CL13                                                     00904000
         ORG   $TCA14                                                   00905000
$TCB14   DC    A(574)                                                   00906000
$TCC14   DC    A(0)                                                     00907000
$TCD14   DC    B'00000000'                                              00908000
$TCE14   DC    X'FFFFFFFF'                                              00909000
         ORG   $TCA14+13                                                00910000
         DS    CL3                                                      00911000
$TCA24   DS    CL13                                                     00912000
         ORG   $TCA24                                                   00913000
$TCB24   DC    A(579)                                                   00914000
$TCC24   DC    A(0)                                                     00915000
$TCD24   DC    B'10000000'                                              00916000
$TCE24   DC    X'FFFFFFFF'                                              00917000
         ORG   $TCA24+13                                                00918000
CDSWORK  DS    CL20                                                     00919000
FNCTBL   DS    CL31                                                     00920000
         ORG   FNCTBL+0                                                 00921000
DELETE   DS    CL7                                                      00922000
         ORG   DELETE+0                                                 00923000
@NM00002 DC    AL1(6)                                                   00924000
@NM00003 DC    CL6'DELETE'                                              00925000
         ORG   FNCTBL+7                                                 00926000
ADD      DS    CL4                                                      00927000
         ORG   ADD+0                                                    00928000
@NM00004 DC    AL1(3)                                                   00929000
@NM00005 DC    CL3'ADD'                                                 00930000
         ORG   FNCTBL+11                                                00931000
CHANGE   DS    CL7                                                      00932000
         ORG   CHANGE+0                                                 00933000
@NM00006 DC    AL1(6)                                                   00934000
@NM00007 DC    CL6'CHANGE'                                              00935000
         ORG   FNCTBL+18                                                00936000
COPY     DS    CL5                                                      00937000
         ORG   COPY+0                                                   00938000
@NM00008 DC    AL1(4)                                                   00939000
@NM00009 DC    CL4'COPY'                                                00940000
         ORG   FNCTBL+23                                                00941000
EXHIBIT  DS    CL8                                                      00942000
         ORG   EXHIBIT+0                                                00943000
@NM00010 DC    AL1(7)                                                   00944000
@NM00011 DC    CL7'EXHIBIT'                                             00945000
         ORG   FNCTBL+155                                               00946000
PATCH    DC    40F'0'                                                   00947000
@00      EQU   00                      EQUATES FOR REGISTERS 0-15       00948000
@01      EQU   01                                                       00949000
@02      EQU   02                                                       00950000
@03      EQU   03                                                       00951000
@04      EQU   04                                                       00952000
@05      EQU   05                                                       00953000
@06      EQU   06                                                       00954000
@07      EQU   07                                                       00955000
@08      EQU   08                                                       00956000
@09      EQU   09                                                       00957000
@10      EQU   10                                                       00958000
@11      EQU   11                                                       00959000
@12      EQU   12                                                       00960000
@13      EQU   13                                                       00961000
@14      EQU   14                                                       00962000
@15      EQU   15                                                       00963000
REMPTR   EQU   @03                                                      00964000
WKREG1   EQU   @05                                                      00965000
WKREG2   EQU   @06                                                      00966000
CALLREG  EQU   @07                                                      00967000
LINKR    EQU   @14                                                      00968000
CECMAP   EQU   @04                                                      00969000
WAPTR    EQU   @02                                                      00970000
R1       EQU   @01                                                      00971000
R15      EQU   @15                                                      00972000
R0       EQU   @00                                                      00973000
R10      EQU   @10                                                      00974000
R11      EQU   @11                                                      00975000
R12      EQU   @12                                                      00976000
R13      EQU   @13                                                      00977000
R14      EQU   @14                                                      00978000
R2       EQU   @02                                                      00979000
R3       EQU   @03                                                      00980000
R4       EQU   @04                                                      00981000
R5       EQU   @05                                                      00982000
R6       EQU   @06                                                      00983000
R7       EQU   @07                                                      00984000
R8       EQU   @08                                                      00985000
R9       EQU   @09                                                      00986000
TBLENTLN EQU   0                                                        00987000
TBLENTRY EQU   0                                                        00988000
REMAREA  EQU   0                                                        00989000
$RCAAREA EQU   0                                                        00990000
$POINTER EQU   $RCAAREA+100                                             00991000
$TRTBLA  EQU   $POINTER+124                                             00992000
$CONSTNT EQU   $RCAAREA+244                                             00993000
$RCAFLG  EQU   $RCAAREA+604                                             00994000
TOLTEPWA EQU   0                                                        00995000
$SCTTBLE EQU   TOLTEPWA                                                 00996000
$TESTOPT EQU   $SCTTBLE+2                                               00997000
$ERROPT  EQU   $SCTTBLE+3                                               00998000
$PDEVFLG EQU   $SCTTBLE+10                                              00999000
$CDSFLGS EQU   $SCTTBLE+11                                              01000000
$CDS8T19 EQU   $SCTTBLE+20                                              01001000
$EXECFLG EQU   $SCTTBLE+33                                              01002000
$OLTFLGS EQU   $SCTTBLE+36                                              01003000
$OLTFLG2 EQU   $SCTTBLE+37                                              01004000
$TOTFLG1 EQU   $SCTTBLE+38                                              01005000
$ROUTMSK EQU   $SCTTBLE+40                                              01006000
$CDA     EQU   TOLTEPWA+100                                             01007000
$RCA     EQU   $CDA+44                                                  01008000
$OLTPTR  EQU   $CDA+52                                                  01009000
$LOWADDR EQU   $OLTPTR                                                  01010000
$HIMOREC EQU   $CDA+60                                                  01011000
$COMMFLG EQU   TOLTEPWA+224                                             01012000
$FLAG1   EQU   $COMMFLG                                                 01013000
$FLAG2   EQU   $COMMFLG+1                                               01014000
$FLAG3   EQU   $COMMFLG+2                                               01015000
$FLAG4   EQU   $COMMFLG+3                                               01016000
$FLAG5   EQU   $COMMFLG+4                                               01017000
$EOJ     EQU   $FLAG5                                                   01018000
$CANCEL  EQU   $EOJ                                                     01019000
$FLAG6   EQU   $COMMFLG+5                                               01020000
$CHANGE  EQU   $FLAG6                                                   01021000
$ABNDBIT EQU   $FLAG6                                                   01022000
$FLAG7   EQU   $COMMFLG+6                                               01023000
$FLAG8   EQU   $COMMFLG+7                                               01024000
$TCECM   EQU   $FLAG8                                                   01025000
$FLAG9   EQU   $COMMFLG+8                                               01026000
$REMSW   EQU   $FLAG9                                                   01027000
$COPY    EQU   $FLAG9                                                   01028000
$FLAG10  EQU   $COMMFLG+9                                               01029000
$FLAG11  EQU   $COMMFLG+10                                              01030000
$FLAG12  EQU   $COMMFLG+11                                              01031000
$FLAG13  EQU   $COMMFLG+12                                              01032000
$DEVTBLE EQU   TOLTEPWA+240                                             01033000
$DEVCDS  EQU   $DEVTBLE                                                 01034000
$DEVUNAD EQU   $DEVCDS                                                  01035000
@NM00063 EQU   $DEVUNAD+2                                               01036000
$DEVFEAT EQU   $DEVCDS+4                                                01037000
$DEVCDSF EQU   $DEVCDS+9                                                01038000
$DEVSDCF EQU   $DEVCDS+10                                               01039000
$$SYMNME EQU   $DEVCDS+12                                               01040000
$DEVFLG1 EQU   $DEVTBLE+20                                              01041000
$EVNCPLT EQU   $DEVFLG1                                                 01042000
$ATTNEXP EQU   $DEVFLG1                                                 01043000
$INTOCC  EQU   $DEVFLG1                                                 01044000
$DEVFLG2 EQU   $DEVTBLE+21                                              01045000
$DEVTECB EQU   $DEVTBLE+22                                              01046000
$OPIS    EQU   $DEVTECB                                                 01047000
$OPND    EQU   $DEVTECB+2                                               01048000
$DEVFLG3 EQU   $DEVTBLE+27                                              01049000
$SIOFLG  EQU   $DEVFLG3                                                 01050000
$IFTOUT  EQU   $DEVTBLE+36                                              01051000
$DEVSESP EQU   $IFTOUT                                                  01052000
$SSCPDAF EQU   $IFTOUT+6                                                01053000
$LDNCBPT EQU   $DEVTBLE+48                                              01054000
$RNINFO  EQU   $DEVTBLE+56                                              01055000
$DEVFLG5 EQU   $RNINFO+8                                                01056000
$DEVFLG4 EQU   $DEVTBLE+65                                              01057000
$SLTBL   EQU   TOLTEPWA+1468                                            01058000
$RUNTEST EQU   $SLTBL+13                                                01059000
$TESTFLG EQU   $SLTBL+21                                                01060000
$SECLST  EQU   $SLTBL+22                                                01061000
$BUFFER  EQU   TOLTEPWA+1976                                            01062000
$INBUFR  EQU   TOLTEPWA+2104                                            01063000
#EXITA   EQU   TOLTEPWA+2632                                            01064000
$CCOMDAT EQU   TOLTEPWA+2644                                            01065000
$CFLGS   EQU   $CCOMDAT+16                                              01066000
$24FEMSG EQU   TOLTEPWA+2681                                            01067000
$24CATMG EQU   $24FEMSG+11                                              01068000
@NM00072 EQU   TOLTEPWA+2776                                            01069000
$OUNTPTR EQU   @NM00072+4                                               01070000
$NSPTR   EQU   $OUNTPTR                                                 01071000
$NSCNT   EQU   @NM00072+10                                              01072000
$ENXX    EQU   @NM00072+15                                              01073000
$IMITX   EQU   $ENXX                                                    01074000
SVESC033 EQU   TOLTEPWA+3160                                            01075000
SVECC013 EQU   TOLTEPWA+3232                                            01076000
SVEIC003 EQU   TOLTEPWA+3592                                            01077000
SVESC022 EQU   TOLTEPWA+3736                                            01078000
SVECC011 EQU   TOLTEPWA+4024                                            01079000
#EXIT    EQU   0                                                        01080000
CECOMMAP EQU   0                                                        01081000
CDSMAP   EQU   0                                                        01082000
CDSUA    EQU   CDSMAP                                                   01083000
CDSMFCT  EQU   CDSMAP+4                                                 01084000
CDSMODEL EQU   CDSMFCT                                                  01085000
CDSFEAT  EQU   CDSMFCT+1                                                01086000
CDSCLASS EQU   CDSMFCT+2                                                01087000
CDSTYPE  EQU   CDSMFCT+3                                                01088000
CDSBYTCT EQU   CDSMAP+8                                                 01089000
CDSFLAG  EQU   CDSMAP+9                                                 01090000
CDSSYMB  EQU   CDSFLAG                                                  01091000
CDSREMSY EQU   CDSFLAG                                                  01092000
CDSSYMBN EQU   CDSMAP+12                                                01093000
CDSEXARA EQU   CDSMAP+20                                                01094000
$TRTBL   EQU   0                                                        01095000
PRNTBUF  EQU   $BUFFER                                                  01096000
PRNTBUF1 EQU   PRNTBUF                                                  01097000
FILLER   EQU   PRNTBUF+22                                               01098000
PRNTBUF2 EQU   PRNTBUF+26                                               01099000
SVECC012 EQU   SVESC022                                                 01100000
SVEIC00A EQU   SVEIC003                                                 01101000
SVEIC004 EQU   SVEIC003                                                 01102000
SVEIC005 EQU   SVEIC003                                                 01103000
SVESC02A EQU   SVESC022                                                 01104000
SVESC02B EQU   SVESC022                                                 01105000
SVESC02D EQU   SVESC022                                                 01106000
SVESC02E EQU   SVESC022                                                 01107000
SVESC02F EQU   SVECC013                                                 01108000
SVESC024 EQU   SVESC022                                                 01109000
SVESC027 EQU   SVESC022                                                 01110000
SVESC029 EQU   SVESC033                                                 01111000
SVESC031 EQU   SVECC013                                                 01112000
SVESC032 EQU   SVECC011                                                 01113000
SVETC037 EQU   SVEIC003                                                 01114000
         AGO   .@UNREFD                START UNREFERENCED COMPONENTS    01115000
CDSEXTM  EQU   CDSFLAG+2                                                01116000
CDSEXTB  EQU   CDSFLAG+2                                                01117000
CDSTMERB EQU   CDSFLAG+2                                                01118000
@NM00076 EQU   CDSFLAG+1                                                01119000
CDSDVPRO EQU   CDSFLAG+1                                                01120000
CDSNTPRI EQU   CDSFLAG+1                                                01121000
CDSLINCN EQU   CDSFLAG                                                  01122000
CDS2CHAN EQU   CDSFLAG                                                  01123000
CDSEXTPR EQU   CDSFLAG                                                  01124000
CDSFEVOL EQU   CDSFLAG                                                  01125000
CDSSHAR  EQU   CDSFLAG                                                  01126000
CDSFPMD  EQU   CDSFLAG                                                  01127000
@NM00075 EQU   CDSFEAT                                                  01128000
CDSDEVM  EQU   CDSFEAT                                                  01129000
CDSDEVT  EQU   CDSFEAT                                                  01130000
CDSASCII EQU   CDSFEAT                                                  01131000
$CECFLAG EQU   CECOMMAP+20                                              01132000
$CEINCT  EQU   CECOMMAP+16                                              01133000
$CEINADR EQU   CECOMMAP+12                                              01134000
$CEOUTCT EQU   CECOMMAP+8                                               01135000
$CEOUTAD EQU   CECOMMAP+4                                               01136000
$CECIDNT EQU   CECOMMAP+2                                               01137000
$CECLEVL EQU   CECOMMAP+1                                               01138000
$CECTRMG EQU   CECOMMAP                                                 01139000
SVECC010 EQU   TOLTEPWA+3952                                            01140000
SVETC035 EQU   TOLTEPWA+3880                                            01141000
SVESC030 EQU   TOLTEPWA+3808                                            01142000
SVESC020 EQU   TOLTEPWA+3664                                            01143000
SVEIC002 EQU   TOLTEPWA+3520                                            01144000
SVECC014 EQU   TOLTEPWA+3376                                            01145000
SVESC120 EQU   TOLTEPWA+3304                                            01146000
SVESC025 EQU   TOLTEPWA+3088                                            01147000
@NM00074 EQU   TOLTEPWA+2980                                            01148000
$RPLERR  EQU   TOLTEPWA+2977                                            01149000
@NM00073 EQU   TOLTEPWA+2976                                            01150000
$R13PR3  EQU   TOLTEPWA+2972                                            01151000
$CEINT2  EQU   TOLTEPWA+2968                                            01152000
$CEINT1  EQU   TOLTEPWA+2964                                            01153000
$MSGGET  EQU   TOLTEPWA+2960                                            01154000
$ACQLIST EQU   TOLTEPWA+2956                                            01155000
$R4SAVE1 EQU   TOLTEPWA+2952                                            01156000
$CLSISS  EQU   TOLTEPWA+2950                                            01157000
$CLSCNT  EQU   TOLTEPWA+2948                                            01158000
$CUTABLE EQU   TOLTEPWA+2868                                            01159000
$BUFSZ2  EQU   TOLTEPWA+2864                                            01160000
$RESID2  EQU   TOLTEPWA+2860                                            01161000
$OLTCCW2 EQU   TOLTEPWA+2856                                            01162000
$ENDBFR2 EQU   TOLTEPWA+2852                                            01163000
$1STBFR2 EQU   TOLTEPWA+2848                                            01164000
$TECB2   EQU   TOLTEPWA+2844                                            01165000
$BUFSZ1  EQU   TOLTEPWA+2840                                            01166000
$RESID1  EQU   TOLTEPWA+2836                                            01167000
$OLTCCW1 EQU   TOLTEPWA+2832                                            01168000
$ENDBFR1 EQU   TOLTEPWA+2828                                            01169000
$1STBFR1 EQU   TOLTEPWA+2824                                            01170000
$TECB1   EQU   TOLTEPWA+2820                                            01171000
$WAITIME EQU   TOLTEPWA+2816                                            01172000
$TRTN#   EQU   TOLTEPWA+2815                                            01173000
$WIODEV  EQU   TOLTEPWA+2814                                            01174000
$RQSTSZE EQU   TOLTEPWA+2812                                            01175000
$RQSTPTR EQU   TOLTEPWA+2808                                            01176000
$R4SAVE  EQU   TOLTEPWA+2804                                            01177000
$PARTADR EQU   TOLTEPWA+2800                                            01178000
$TBSDATA EQU   TOLTEPWA+2796                                            01179000
$CTWIDTH EQU   TOLTEPWA+2795                                            01180000
$CTLINE  EQU   TOLTEPWA+2794                                            01181000
$APWIDTH EQU   TOLTEPWA+2793                                            01182000
$APLINE  EQU   TOLTEPWA+2792                                            01183000
$INDEX   EQU   $IMITX                                                   01184000
$UMXX    EQU   @NM00072+14                                              01185000
$NSXX    EQU   @NM00072+12                                              01186000
$ATACNT  EQU   $NSCNT                                                   01187000
$CTR     EQU   @NM00072+8                                               01188000
$ATAPTR  EQU   $NSPTR                                                   01189000
$DDRPTR  EQU   @NM00072                                                 01190000
$DTORESP EQU   TOLTEPWA+2712                                            01191000
$APNAME  EQU   TOLTEPWA+2704                                            01192000
$24SYMNE EQU   $24CATMG+4                                               01193000
$24DEVAD EQU   $24CATMG                                                 01194000
$24RTN#  EQU   $24FEMSG+8                                               01195000
$ESECTID EQU   $24FEMSG                                                 01196000
$24FLGS  EQU   TOLTEPWA+2680                                            01197000
$24SAVE2 EQU   TOLTEPWA+2676                                            01198000
$24SAVE1 EQU   TOLTEPWA+2672                                            01199000
$24UNADR EQU   TOLTEPWA+2668                                            01200000
$24SAV13 EQU   TOLTEPWA+2664                                            01201000
$24RETCD EQU   TOLTEPWA+2663                                            01202000
$MACID   EQU   TOLTEPWA+2661                                            01203000
$CSPARE  EQU   $CFLGS                                                   01204000
$C2WAY   EQU   $CFLGS                                                   01205000
$CINCT   EQU   $CCOMDAT+12                                              01206000
$CINADR  EQU   $CCOMDAT+8                                               01207000
$COUTCT  EQU   $CCOMDAT+4                                               01208000
$COUTAD  EQU   $CCOMDAT                                                 01209000
ROOTLOC  EQU   TOLTEPWA+2640                                            01210000
$RETREG  EQU   TOLTEPWA+2636                                            01211000
$WORK    EQU   TOLTEPWA+2376                                            01212000
$EXTA    EQU   TOLTEPWA+2320                                            01213000
$PASSONA EQU   TOLTEPWA+2264                                            01214000
$TRMINPT EQU   TOLTEPWA+2184                                            01215000
$TLTRPL3 EQU   TOLTEPWA+1856                                            01216000
$TLTRPL2 EQU   TOLTEPWA+1736                                            01217000
$TLTRPL1 EQU   TOLTEPWA+1616                                            01218000
@NM00071 EQU   $SLTBL+135                                               01219000
$HIGHRTN EQU   $SLTBL+134                                               01220000
$PRIMADR EQU   $SLTBL+130                                               01221000
$CTSTPT  EQU   $SLTBL+128                                               01222000
$TSTCNT  EQU   $SLTBL+126                                               01223000
$SECFLGS EQU   $SECLST+3                                                01224000
$SECTION EQU   $SECLST                                                  01225000
$SECACT  EQU   $TESTFLG                                                 01226000
$CANTRUN EQU   $TESTFLG                                                 01227000
$FINAL   EQU   $TESTFLG                                                 01228000
$TESTSUF EQU   $RUNTEST+5                                               01229000
$TESTNUM EQU   $RUNTEST+1                                               01230000
$LETPRF  EQU   $RUNTEST                                                 01231000
$SYMBOLC EQU   $SLTBL+5                                                 01232000
$FAMILY  EQU   $SLTBL                                                   01233000
$CDEVPT  EQU   TOLTEPWA+1466                                            01234000
$DEVCNTS EQU   TOLTEPWA+1464                                            01235000
$FEEDBCK EQU   $DEVTBLE+66                                              01236000
$WTISUED EQU   $DEVFLG4                                                 01237000
$EXIOISD EQU   $DEVFLG4                                                 01238000
$REMWRIT EQU   $DEVFLG4                                                 01239000
$REMDONE EQU   $DEVFLG4                                                 01240000
$2NDUSED EQU   $DEVFLG4                                                 01241000
$1STUSED EQU   $DEVFLG4                                                 01242000
$IGLXIFB EQU   $DEVFLG4                                                 01243000
$EXIOLV3 EQU   $DEVFLG4                                                 01244000
@NM00070 EQU   $DEVFLG5                                                 01245000
$DVBASIC EQU   $DEVFLG5                                                 01246000
$ASCII   EQU   $DEVFLG5                                                 01247000
$DEVLU   EQU   $DEVFLG5                                                 01248000
$OPNDFAL EQU   $DEVFLG5                                                 01249000
$ACQNCB  EQU   $DEVFLG5                                                 01250000
$REMOTE  EQU   $DEVFLG5                                                 01251000
$ENDNODE EQU   $DEVFLG5                                                 01252000
$LINENME EQU   $RNINFO                                                  01253000
$CID     EQU   $DEVTBLE+52                                              01254000
$DVCOL   EQU   $LDNCBPT+2                                               01255000
$DVROW   EQU   $LDNCBPT                                                 01256000
$NCSPLP  EQU   $DEVTBLE+44                                              01257000
$DVLN    EQU   $SSCPDAF                                                 01258000
$DAF     EQU   $DEVSESP+4                                               01259000
$VARYPAB EQU   $DEVSESP                                                 01260000
$SYSMN   EQU   $DEVTBLE+28                                              01261000
@NM00069 EQU   $DEVFLG3                                                 01262000
$CLRSNT  EQU   $DEVFLG3                                                 01263000
$OLTERR  EQU   $DEVFLG3                                                 01264000
$SRTEST  EQU   $DEVFLG3                                                 01265000
$DVSNDOK EQU   $SIOFLG                                                  01266000
$POLLREQ EQU   $DEVFLG3                                                 01267000
$ACQRED  EQU   $DEVFLG3                                                 01268000
$NOTDEV  EQU   $DEVFLG3                                                 01269000
$DVINCT  EQU   $DEVTBLE+26                                              01270000
$DVBRKST EQU   $OPND+1                                                  01271000
$DVBRKSN EQU   $OPND                                                    01272000
$DVSEQNO EQU   $OPIS                                                    01273000
$CEINTRP EQU   $DEVFLG2                                                 01274000
$TESTMDE EQU   $DEVFLG2                                                 01275000
$DEVALOC EQU   $DEVFLG2                                                 01276000
$ALLDATA EQU   $DEVFLG2                                                 01277000
$ENDCNTL EQU   $DEVFLG2                                                 01278000
$CTLDEV  EQU   $DEVFLG2                                                 01279000
$NOCDS   EQU   $DEVFLG2                                                 01280000
$DATAIN  EQU   $DEVFLG2                                                 01281000
$PRIMARY EQU   $DEVFLG1                                                 01282000
$DVCTBYT EQU   $INTOCC                                                  01283000
$DEVACT  EQU   $DEVFLG1                                                 01284000
$DVLGMDE EQU   $ATTNEXP                                                 01285000
$DVSPRM  EQU   $EVNCPLT                                                 01286000
$GRABBED EQU   $DEVFLG1                                                 01287000
$CATASTR EQU   $DEVFLG1                                                 01288000
$LETGO   EQU   $DEVFLG1                                                 01289000
$CURELEM EQU   $$SYMNME+4                                               01290000
$MSGOTSD EQU   $$SYMNME                                                 01291000
$EXTDEV  EQU   $DEVCDS+11                                               01292000
@NM00068 EQU   $DEVSDCF                                                 01293000
$NOTPRIM EQU   $DEVSDCF                                                 01294000
@NM00067 EQU   $DEVCDSF                                                 01295000
@NM00066 EQU   $DEVCDSF                                                 01296000
@NM00065 EQU   $DEVCDSF                                                 01297000
$CDSNAME EQU   $DEVCDSF                                                 01298000
$EXTRN   EQU   $DEVCDSF                                                 01299000
$CEVOLUM EQU   $DEVCDSF                                                 01300000
$SHARD   EQU   $DEVCDSF                                                 01301000
$DEVFPM  EQU   $DEVCDSF                                                 01302000
$DEVCNT  EQU   $DEVCDS+8                                                01303000
$DEVTYPE EQU   $DEVFEAT+3                                               01304000
$DEVCLAS EQU   $DEVFEAT+2                                               01305000
$DEVFRRS EQU   $DEVFEAT+1                                               01306000
$DEVMOD  EQU   $DEVFEAT                                                 01307000
$DEVRDGT EQU   @NM00063+1                                               01308000
$DEVCTLU EQU   @NM00063+1                                               01309000
$DEVCHAN EQU   @NM00063                                                 01310000
@NM00064 EQU   @NM00063                                                 01311000
$CTINDX  EQU   $DEVUNAD                                                 01312000
$FLAG16  EQU   $COMMFLG+15                                              01313000
$FLAG15  EQU   $COMMFLG+14                                              01314000
$FLAG14  EQU   $COMMFLG+13                                              01315000
$TEP2ND  EQU   $FLAG13                                                  01316000
$TEP1ST  EQU   $FLAG13                                                  01317000
$CATMSG  EQU   $FLAG13                                                  01318000
$PRMPTSW EQU   $FLAG13                                                  01319000
$DEVENT  EQU   $FLAG13                                                  01320000
$OLTMACC EQU   $FLAG13                                                  01321000
$LGON    EQU   $FLAG13                                                  01322000
$CTLOGON EQU   $FLAG13                                                  01323000
@NM00062 EQU   $FLAG12                                                  01324000
$VARYINP EQU   $FLAG12                                                  01325000
$ENDTEST EQU   $FLAG12                                                  01326000
$VRYHRD  EQU   $FLAG12                                                  01327000
$VRYSFT  EQU   $FLAG12                                                  01328000
$POSTFLG EQU   $FLAG12                                                  01329000
$OPTMSG  EQU   $FLAG12                                                  01330000
$FEORCAT EQU   $FLAG11                                                  01331000
@NM00061 EQU   $FLAG11                                                  01332000
@NM00060 EQU   $FLAG10                                                  01333000
$INBND   EQU   $FLAG10                                                  01334000
$WAITFLG EQU   $FLAG10                                                  01335000
$DPRINT  EQU   $FLAG10                                                  01336000
$HOLD    EQU   $FLAG9                                                   01337000
$NOTRRCH EQU   $FLAG9                                                   01338000
@NM00059 EQU   $FLAG9                                                   01339000
$LSTLNSW EQU   $FLAG9                                                   01340000
$MULLNSW EQU   $FLAG9                                                   01341000
$IGRES   EQU   $FLAG9                                                   01342000
$VS2     EQU   $FLAG8                                                   01343000
$VS1     EQU   $FLAG8                                                   01344000
$EDOS    EQU   $FLAG8                                                   01345000
@NM00058 EQU   $FLAG8                                                   01346000
$TWOWAY  EQU   $FLAG8                                                   01347000
@NM00057 EQU   $FLAG8                                                   01348000
$RCVMSG  EQU   $FLAG7                                                   01349000
$RCVRFLG EQU   $FLAG7                                                   01350000
$SNDRFLG EQU   $FLAG7                                                   01351000
$LDOIS   EQU   $FLAG7                                                   01352000
$DCONTCT EQU   $FLAG7                                                   01353000
$EXIOWAT EQU   $FLAG7                                                   01354000
$2NDDATA EQU   $FLAG7                                                   01355000
$1STDATA EQU   $FLAG7                                                   01356000
$CIREQ   EQU   $FLAG6                                                   01357000
$ABTERM  EQU   $ABNDBIT                                                 01358000
$FSTMCIS EQU   $FLAG6                                                   01359000
$DISCREQ EQU   $FLAG6                                                   01360000
$DISCISS EQU   $FLAG6                                                   01361000
$CTERROR EQU   $FLAG6                                                   01362000
$RECAL11 EQU   $FLAG6                                                   01363000
@NM00056 EQU   $FLAG5                                                   01364000
$PROGCK  EQU   $CANCEL                                                  01365000
$PRINTAP EQU   $FLAG5                                                   01366000
@NM00055 EQU   $FLAG5                                                   01367000
$MSG922  EQU   $FLAG5                                                   01368000
$CT924   EQU   $FLAG5                                                   01369000
$FSTCAT  EQU   $FLAG5                                                   01370000
$FSTFE   EQU   $FLAG5                                                   01371000
$ACTOPND EQU   $FLAG4                                                   01372000
$ACQCUTT EQU   $FLAG4                                                   01373000
$CLSSACT EQU   $FLAG4                                                   01374000
$BACKINT EQU   $FLAG4                                                   01375000
$DMSGSW  EQU   $FLAG4                                                   01376000
$TSTDEVP EQU   $FLAG4                                                   01377000
$APRQPER EQU   $FLAG4                                                   01378000
$OPCOM   EQU   $FLAG4                                                   01379000
$NEWAP   EQU   $FLAG3                                                   01380000
$ALTPRTR EQU   $FLAG3                                                   01381000
$OPTERR  EQU   $FLAG3                                                   01382000
$PRTONLY EQU   $FLAG3                                                   01383000
$REQSTOR EQU   $FLAG3                                                   01384000
$LOGOFFE EQU   $FLAG3                                                   01385000
$TSTERR  EQU   $FLAG3                                                   01386000
$DEVERR  EQU   $FLAG3                                                   01387000
$PARTIAL EQU   $FLAG2                                                   01388000
$NRMTERM EQU   $FLAG2                                                   01389000
$VALDTST EQU   $FLAG2                                                   01390000
$VALDDEV EQU   $FLAG2                                                   01391000
$DBLSLSH EQU   $FLAG2                                                   01392000
$NDR     EQU   $FLAG2                                                   01393000
@NM00054 EQU   $FLAG2                                                   01394000
$FTTHR   EQU   $FLAG2                                                   01395000
$OLTACT  EQU   $FLAG1                                                   01396000
$NORELDV EQU   $FLAG1                                                   01397000
@NM00053 EQU   $FLAG1                                                   01398000
$OPTCHNG EQU   $FLAG1                                                   01399000
$DEVCHNG EQU   $FLAG1                                                   01400000
$TESTCNG EQU   $FLAG1                                                   01401000
$CNSLFG  EQU   $FLAG1                                                   01402000
$TEP3RD  EQU   $FLAG1                                                   01403000
@NM00052 EQU   $CDA+120                                                 01404000
$CUCNT   EQU   $CDA+118                                                 01405000
@NM00051 EQU   $CDA+117                                                 01406000
$PRTFORM EQU   $CDA+116                                                 01407000
$OPISCNT EQU   $CDA+114                                                 01408000
$OPNDCNT EQU   $CDA+112                                                 01409000
$GETMSZE EQU   $CDA+110                                                 01410000
$GRCNTS  EQU   $CDA+108                                                 01411000
$CTLCNT  EQU   $CDA+106                                                 01412000
$ACTLVL  EQU   $CDA+105                                                 01413000
$PRNTLVL EQU   $CDA+104                                                 01414000
$ERRCNTA EQU   $CDA+102                                                 01415000
$TLCNT   EQU   $CDA+100                                                 01416000
$TIMEALW EQU   $CDA+96                                                  01417000
$PTRAREA EQU   $CDA+92                                                  01418000
$GETMPTR EQU   $CDA+88                                                  01419000
$R13PTRT EQU   $CDA+84                                                  01420000
$R13PTR  EQU   $CDA+80                                                  01421000
$TEPEND  EQU   $CDA+76                                                  01422000
$PLINKDL EQU   $CDA+72                                                  01423000
$TEPBEGN EQU   $CDA+68                                                  01424000
$FRELPTR EQU   $CDA+64                                                  01425000
$HIGHADR EQU   $HIMOREC                                                 01426000
$LOMOREC EQU   $CDA+56                                                  01427000
$ENDCOMM EQU   $CDA+48                                                  01428000
$COMMON  EQU   $RCA                                                     01429000
$SLASHAD EQU   $CDA+32                                                  01430000
$PASSON  EQU   $CDA+28                                                  01431000
$TOLBRTB EQU   $CDA+24                                                  01432000
$SCTPTR8 EQU   $CDA+20                                                  01433000
$SCTPTR  EQU   $CDA+16                                                  01434000
$TBWDPTR EQU   $CDA+12                                                  01435000
$TFWDPTR EQU   $CDA+8                                                   01436000
@NM00050 EQU   $CDA                                                     01437000
@NM00049 EQU   $SCTTBLE+98                                              01438000
$SCTLWTC EQU   $SCTTBLE+96                                              01439000
$SCTLWTA EQU   $SCTTBLE+92                                              01440000
#EXT     EQU   $SCTTBLE+88                                              01441000
#PASS    EQU   $SCTTBLE+84                                              01442000
#TABLE   EQU   $SCTTBLE+80                                              01443000
#MSGIDAC EQU   $SCTTBLE+78                                              01444000
@NM00048 EQU   $SCTTBLE+71                                              01445000
$RETMASK EQU   $SCTTBLE+70                                              01446000
$R249255 EQU   $ROUTMSK+29                                              01447000
$R241248 EQU   $ROUTMSK+28                                              01448000
$R233240 EQU   $ROUTMSK+27                                              01449000
$R225232 EQU   $ROUTMSK+26                                              01450000
$R217224 EQU   $ROUTMSK+25                                              01451000
$R209216 EQU   $ROUTMSK+24                                              01452000
$R201208 EQU   $ROUTMSK+23                                              01453000
$R193200 EQU   $ROUTMSK+22                                              01454000
$R185192 EQU   $ROUTMSK+21                                              01455000
$R177184 EQU   $ROUTMSK+20                                              01456000
$R169176 EQU   $ROUTMSK+19                                              01457000
$R161168 EQU   $ROUTMSK+18                                              01458000
$R153160 EQU   $ROUTMSK+17                                              01459000
$R145152 EQU   $ROUTMSK+16                                              01460000
$R137144 EQU   $ROUTMSK+15                                              01461000
$R129136 EQU   $ROUTMSK+14                                              01462000
$R121128 EQU   $ROUTMSK+13                                              01463000
$R113120 EQU   $ROUTMSK+12                                              01464000
$R105112 EQU   $ROUTMSK+11                                              01465000
$R097104 EQU   $ROUTMSK+10                                              01466000
$R089096 EQU   $ROUTMSK+9                                               01467000
$R081088 EQU   $ROUTMSK+8                                               01468000
$R073080 EQU   $ROUTMSK+7                                               01469000
$R065072 EQU   $ROUTMSK+6                                               01470000
$R057064 EQU   $ROUTMSK+5                                               01471000
$R049056 EQU   $ROUTMSK+4                                               01472000
$R041048 EQU   $ROUTMSK+3                                               01473000
$R033040 EQU   $ROUTMSK+2                                               01474000
$R025032 EQU   $ROUTMSK+1                                               01475000
$R017024 EQU   $ROUTMSK                                                 01476000
$TOTFLG2 EQU   $SCTTBLE+39                                              01477000
@NM00047 EQU   $TOTFLG1                                                 01478000
@NM00046 EQU   $TOTFLG1                                                 01479000
@NM00045 EQU   $TOTFLG1                                                 01480000
$CURELOD EQU   $TOTFLG1                                                 01481000
$CTEQTT  EQU   $TOTFLG1                                                 01482000
@NM00044 EQU   $TOTFLG1                                                 01483000
@NM00043 EQU   $TOTFLG1                                                 01484000
$LINESHR EQU   $TOTFLG1                                                 01485000
@NM00042 EQU   $OLTFLG2                                                 01486000
@NM00041 EQU   $OLTFLG2                                                 01487000
@NM00040 EQU   $OLTFLG2                                                 01488000
@NM00039 EQU   $OLTFLG2                                                 01489000
@NM00038 EQU   $OLTFLG2                                                 01490000
@NM00037 EQU   $OLTFLG2                                                 01491000
@NM00036 EQU   $OLTFLG2                                                 01492000
$TALK    EQU   $OLTFLG2                                                 01493000
$DYCOM   EQU   $OLTFLGS                                                 01494000
@NM00035 EQU   $OLTFLGS                                                 01495000
$TRACE   EQU   $OLTFLGS                                                 01496000
$RETCODE EQU   $OLTFLGS                                                 01497000
$CONTCB  EQU   $OLTFLGS                                                 01498000
$RETAIN  EQU   $OLTFLGS                                                 01499000
$CLEANRT EQU   $OLTFLGS                                                 01500000
$MANINTV EQU   $OLTFLGS                                                 01501000
$OLTSIZE EQU   $SCTTBLE+34                                              01502000
$QSCTMOD EQU   $EXECFLG                                                 01503000
$CTRLMOD EQU   $EXECFLG                                                 01504000
$CLEANUP EQU   $EXECFLG                                                 01505000
$LSTPDEV EQU   $EXECFLG                                                 01506000
$ERRCNT  EQU   $EXECFLG                                                 01507000
$RTNSLCT EQU   $EXECFLG                                                 01508000
$MULTDEV EQU   $EXECFLG                                                 01509000
@NM00034 EQU   $EXECFLG                                                 01510000
$RMSKCNT EQU   $SCTTBLE+32                                              01511000
$SYNAME  EQU   $CDS8T19+4                                               01512000
$EXTSIG  EQU   $CDS8T19+3                                               01513000
$CDFLGS  EQU   $CDS8T19+1                                               01514000
$CDSCNT  EQU   $CDS8T19                                                 01515000
$PDEVDSC EQU   $SCTTBLE+16                                              01516000
$PDEVADR EQU   $SCTTBLE+12                                              01517000
$COMMCN  EQU   $CDSFLGS                                                 01518000
$CUSTSYM EQU   $CDSFLGS                                                 01519000
$TWOCHSW EQU   $CDSFLGS                                                 01520000
$SYMNAME EQU   $CDSFLGS                                                 01521000
$EXTINTC EQU   $CDSFLGS                                                 01522000
$CEVOL   EQU   $CDSFLGS                                                 01523000
$SHARED  EQU   $CDSFLGS                                                 01524000
$FPM     EQU   $CDSFLGS                                                 01525000
$LASTSUB EQU   $PDEVFLG                                                 01526000
@NM00033 EQU   $PDEVFLG                                                 01527000
@NM00032 EQU   $PDEVFLG                                                 01528000
@NM00031 EQU   $PDEVFLG                                                 01529000
$LASTDEV EQU   $PDEVFLG                                                 01530000
@NM00030 EQU   $PDEVFLG                                                 01531000
$EXFILPT EQU   $PDEVFLG                                                 01532000
$FPMOLD  EQU   $PDEVFLG                                                 01533000
$TSSSYM  EQU   $SCTTBLE+8                                               01534000
$SCTLEVL EQU   $SCTTBLE+7                                               01535000
$DRIVER  EQU   $SCTTBLE+6                                               01536000
$RT0916  EQU   $SCTTBLE+5                                               01537000
$RT0108  EQU   $SCTTBLE+4                                               01538000
$LOOPTST EQU   $ERROPT                                                  01539000
$LOOPERR EQU   $ERROPT                                                  01540000
$NERRPRT EQU   $ERROPT                                                  01541000
$NOCNTRL EQU   $ERROPT                                                  01542000
$ALTPRNT EQU   $ERROPT                                                  01543000
$CATERR  EQU   $ERROPT                                                  01544000
$ASTERIK EQU   $ERROPT                                                  01545000
$TESTERR EQU   $ERROPT                                                  01546000
$FSTCOMM EQU   $TESTOPT                                                 01547000
$INDEFLP EQU   $TESTOPT                                                 01548000
$NOPRT   EQU   $TESTOPT                                                 01549000
$PARAPRT EQU   $TESTOPT                                                 01550000
@NM00029 EQU   $TESTOPT                                                 01551000
$ERRLPCT EQU   $SCTTBLE                                                 01552000
$TLTEND  EQU   $RCAAREA+945                                             01553000
$CNSLID  EQU   $RCAAREA+936                                             01554000
$EXITSAV EQU   $RCAAREA+864                                             01555000
$TRASCII EQU   $RCAAREA+608                                             01556000
@NM00028 EQU   $RCAAREA+605                                             01557000
$VTAMEND EQU   $RCAFLG                                                  01558000
$TPPOSTD EQU   $RCAFLG                                                  01559000
$NEWCT   EQU   $RCAFLG                                                  01560000
$ABNDALL EQU   $RCAFLG                                                  01561000
$CUTESTB EQU   $RCAFLG                                                  01562000
$CONSOLE EQU   $RCAFLG                                                  01563000
$TPLOGON EQU   $RCAFLG                                                  01564000
$UPDATE  EQU   $RCAFLG                                                  01565000
$DEVAREA EQU   $RCAAREA+600                                             01566000
$CTDVAR  EQU   $RCAAREA+596                                             01567000
$BUFFS   EQU   $RCAAREA+464                                             01568000
$TLTNIB  EQU   $CONSTNT+140                                             01569000
$TLTPRPL EQU   $CONSTNT+20                                              01570000
@NM00027 EQU   $CONSTNT+4                                               01571000
@NM00026 EQU   $CONSTNT+2                                               01572000
$USECNT  EQU   $CONSTNT                                                 01573000
$CURRTWA EQU   $POINTER+140                                             01574000
$CTNAME  EQU   $POINTER+132                                             01575000
$CTARGX  EQU   $POINTER+128                                             01576000
$COMINT  EQU   $POINTER+120                                             01577000
$QUEHNDL EQU   $POINTER+116                                             01578000
@NM00025 EQU   $POINTER+36                                              01579000
$RTNPTR  EQU   $POINTER+32                                              01580000
$TLTECB2 EQU   $POINTER+28                                              01581000
$TLTECB1 EQU   $POINTER+24                                              01582000
$CLEANP  EQU   $POINTER+20                                              01583000
$ABEND   EQU   $POINTER+16                                              01584000
$LSTAREA EQU   $POINTER+12                                              01585000
$FSTAREA EQU   $POINTER+8                                               01586000
$CVTSAVE EQU   $POINTER+4                                               01587000
$TOLTEP  EQU   $POINTER                                                 01588000
$TLTACB  EQU   $RCAAREA                                                 01589000
.@UNREFD ANOP                          END UNREFERENCED COMPONENTS      01590000
@RT00096 EQU   I006C02                                                  01591000
@RF00149 EQU   I006C01                                                  01592000
I006C02A EQU   I006C01                                                  01593000
I006CRET EQU   @EL00001                                                 01594000
@RT00173 EQU   I006C04                                                  01595000
@RT00245 EQU   I006C02A                                                 01596000
@RT00254 EQU   I006C02A                                                 01597000
@RT00263 EQU   I006C05                                                  01598000
@RT00277 EQU   I006C02A                                                 01599000
@RT00087 EQU   I006CRET                                                 01600000
@ENDDATA EQU   *                                                        01601000
         END   ISTIC006,(C'PLS2011',0702,79129)                         01602000
./  ADD  SSI=83360394,NAME=ISTIC007
         TITLE 'ISTIC007,DELETE - DELETES CDS FROM LIBRARY'             00001000
ISTIC007 CSECT ,                                                   0001 00002000
@MAINENT DS    0H                                                  0001 00003000
         USING *,@15                                               0001 00004000
         B     @PROLOG                                             0001 00005000
         DC    AL1(16)                                             0001 00006000
         DC    C'ISTIC007  78.337'                                 0001 00007000
         DROP  @15                                                      00008000
@PROLOG  ST    @14,12(,@13)                                        0001 00009000
         STM   @00,@12,20(@13)                                     0001 00010000
         BALR  @11,0                                               0001 00011000
@PSTART  DS    0H                                                  0001 00012000
         USING @PSTART,@11                                         0001 00013000
         ST    @13,@SA00001+4                                      0001 00014000
         LA    @14,@SA00001                                        0001 00015000
         ST    @14,8(,@13)                                         0001 00016000
         LR    @13,@14                                             0001 00017000
         EJECT                                                          00018000
OPENFLAG EQU   48                                                       00019000
GOODOPEN EQU   16                                                       00020000
SEVEN    EQU    7                                                       00021000
         EJECT                                                          00022000
         EJECT                                                          00023000
I007C01  DS    0H                                                  0054 00024000
*   CDSWKPTR=$LOWADDR;              /* SET UP BASE                   */ 00025000
         L     @12,$LOWADDR(,WAPTR)                                0054 00026000
         ST    @12,CDSWKPTR                                        0054 00027000
*   CDSWKPTR=CDSWKPTR+80;           /* GET CDS WORK AREA OFFSET      */ 00028000
         AH    @12,@CH00068                                        0055 00029000
         ST    @12,CDSWKPTR                                        0055 00030000
*   R8=CDSWKPTR;                    /* SET UP SECONDARY BASE         */ 00031000
         LR    R8,@12                                              0056 00032000
*   CECMAP=R1;                      /* SET UP ADDRESSABILITY         */ 00033000
         LR    CECMAP,R1                                           0057 00034000
*   IF $REMSW¬='1'B THEN            /* IF ITS NOT A SYMBOLIC CDS     */ 00035000
         TM    $REMSW(WAPTR),B'01000000'                           0058 00036000
         BNO   @RT00058                                            0058 00037000
*     GOTO I007C01A;                /* THEN BR AROUND                */ 00038000
*   CDSREMSY='1'B;                  /* SET REMOTE SW                 */ 00039000
*   CDSSYMB='1'B;                   /* SET SYMBOLIC SW               */ 00040000
         OI    CDSREMSY(@12),B'00001010'                           0061 00041000
*I007C01A:                                                         0062 00042000
*   DCL                                                            0062 00043000
*     1 ZZZGTPRM BDY(WORD),         /* GETCONFG PARAMETER LIST       */ 00044000
*      2 * CHAR(4) INIT('0102F1F6'X),                              0062 00045000
*      2 ZZZGTCD PTR,               /* POINTER TO BASIC CDS INFO     */ 00046000
*      2 ZZZGTAD PTR,               /* POINTER TO RECEIVING BUFFER   */ 00047000
*      2 ZZZGTCT FIXED(8);          /* NUMBER OF CDS BYTES NEEDED    */ 00048000
I007C01A DS    0H                                                  0063 00049000
*   ZZZGTAD=ADDR(CDSUA);            /* POINTER TO RECEIVING BUFFER   */ 00050000
         L     @12,CDSWKPTR                                        0063 00051000
         ST    @12,ZZZGTAD                                         0063 00052000
*   ZZZGTCD=ADDR(CDSUA);            /* POINTER TO BASIC CDS INFO     */ 00053000
         ST    @12,ZZZGTCD                                         0064 00054000
*   ZZZGTCT=20;                     /* NUMBER OF BYTES NEEDED        */ 00055000
         MVI   ZZZGTCT,X'14'                                       0065 00056000
*   R1=ADDR(ZZZGTPRM);              /* POINT TO THE PARM LIST        */ 00057000
         LA    R1,ZZZGTPRM                                         0066 00058000
*   CALL ISTSC029;                  /* CALL THE GETCONFG FUNCTION    */ 00059000
         L     @15,@CV00707                                        0067 00060000
         BALR  @14,@15                                             0067 00061000
*   IF R15¬=12 THEN                                                0068 00062000
         CH    R15,@CH00153                                        0068 00063000
         BNE   @RT00068                                            0068 00064000
*     GOTO I007C01B;                                               0069 00065000
*                                                                  0069 00066000
*   /*****************************************************************/ 00067000
*   /*                                                               */ 00068000
*   /* TCEC MSGN(574) INVOKED                                        */ 00069000
*   /*                                                               */ 00070000
*   /*****************************************************************/ 00071000
*                                                                  0070 00072000
*   $TCECM='1'B;                    /* SET TCEC SW IN RCA            */ 00073000
         OI    $TCECM(WAPTR),B'00000001'                           0070 00074000
*   R1=ADDR($TCA10);                /* SET UP PARM LIST $TR          */ 00075000
         LA    R1,$TCA10                                           0071 00076000
*   CALL #EXIT;                     /* CALL CECOM                    */ 00077000
         L     @15,#EXITA(,WAPTR)                                  0072 00078000
         BALR  @14,@15                                             0072 00079000
*   DCL                                                            0073 00080000
*     1 $TCA10,                     /* TCEC PARM LIST                */ 00081000
*      2 $TCB10 FIXED(32) INIT(574),/* MSG NUMBER                    */ 00082000
*      2 $TCC10 FIXED(32) INIT(0),  /* INCT LEN                      */ 00083000
*      2 $TCD10 BIT(8) INIT('00000000'B),/* FLAG                     */ 00084000
*      2 $TCE10 CHAR(4) INIT('FFFFFFFF'X);/* MSSAGE MASK DEVICE NOT     00085000
*                                      CONFIGURED                    */ 00086000
*   GOTO I007CEX1;                  /* RETURN TO CONTROL MODULE      */ 00087000
         B     I007CEX1                                            0074 00088000
*I007C01B:                                                         0075 00089000
*   IF CDSFPMD¬='1'B THEN           /* IF FILE PROTECT BIT IS NOT    */ 00090000
I007C01B L     @12,CDSWKPTR                                        0075 00091000
         TM    CDSFPMD(@12),B'10000000'                            0075 00092000
         BNO   @RT00075                                            0075 00093000
*     GOTO I007C01C;                /* ON THEN BR                    */ 00094000
*                                                                  0076 00095000
*   /*****************************************************************/ 00096000
*   /*                                                               */ 00097000
*   /* TCEC MSGN(564) INVOKED                                        */ 00098000
*   /*                                                               */ 00099000
*   /*****************************************************************/ 00100000
*                                                                  0077 00101000
*   $TCECM='1'B;                    /* SET TCEC SW IN RCA            */ 00102000
         OI    $TCECM(WAPTR),B'00000001'                           0077 00103000
*   R1=ADDR($TCA11);                /* SET UP PARM LIST $TR          */ 00104000
         LA    R1,$TCA11                                           0078 00105000
*   CALL #EXIT;                     /* CALL CECOM                    */ 00106000
         L     @15,#EXITA(,WAPTR)                                  0079 00107000
         BALR  @14,@15                                             0079 00108000
*   DCL                                                            0080 00109000
*     1 $TCA11,                     /* TCEC PARM LIST                */ 00110000
*      2 $TCB11 FIXED(32) INIT(564),/* MSG NUMBER                    */ 00111000
*      2 $TCC11 FIXED(32) INIT(0),  /* INCT LEN                      */ 00112000
*      2 $TCD11 BIT(8) INIT('00000000'B),/* FLAG                     */ 00113000
*      2 $TCE11 CHAR(4) INIT('FFFFFFFF'X);                         0080 00114000
*                                                                  0080 00115000
*/*  MSSAGE MASK                                                     */ 00116000
*                                                                  0081 00117000
*   GOTO I007CEX;                   /* RETURN TO CONTROL MODULE      */ 00118000
         B     I007CEX                                             0081 00119000
*I007C01C:                                                         0082 00120000
*   IF $REMSW¬='1'B THEN            /* IS IT A REMOTE DELETE         */ 00121000
I007C01C TM    $REMSW(WAPTR),B'01000000'                           0082 00122000
         BNO   @RT00082                                            0082 00123000
*     GOTO I007C03;                 /* NO-BR TO LINE DELETE          */ 00124000
*   GEN(EJECT);                                                    0084 00125000
         EJECT                                                          00126000
*                                                                  0085 00127000
*/********************************************************************/ 00128000
*/*  THIS SECTION DELETES CDS FROM REMOTE LIBRARY (SYMSYM)           */ 00129000
*/********************************************************************/ 00130000
*                                                                  0085 00131000
*I007C02:                                                          0085 00132000
*   GEN;                                                           0085 00133000
I007C02  DS    0H                                                  0085 00134000
         OPEN  (REMCDS,(OUTPUT))        /*OPEN REMOTE DATA SET       */ 00135000
         SPACE                                                          00136000
         LA    WKREG1,REMCDS            /*SET UP PTR                 */ 00137000
         TM    OPENFLAG(WKREG1),GOODOPEN /*WAS OPEN GOOD             */ 00138000
         BZ    I007CER1                 /*NO-OPEN ERROR                 00139000
         MVC   CDSMEMBR(L'CDSMEMBR),CDSSYMBN(R8) SET UP NME IN BLDL  */ 00140000
         SPACE                                                          00141000
         STOW  REMCDS,CDSBLDL,D         /*DELETE CDS                 */ 00142000
         SPACE                                                          00143000
         LTR R15,R15                    /*IF RET CODE EQ ZERO THEN   */ 00144000
         BZ  I007CEX                    /*PRT MSG AND RET TO CALLER  */ 00145000
         B   I007CER2                   /*OTERWISE PRT ERR & RETURN  */ 00146000
*   GEN(EJECT);                                                    0086 00147000
         EJECT                                                          00148000
*                                                                  0087 00149000
*/********************************************************************/ 00150000
*/*  THIS SECTION DELETES CDS FROM LOCAL LIBRARY (OLTCDSDD)          */ 00151000
*/********************************************************************/ 00152000
*                                                                  0087 00153000
*I007C03:                                                          0087 00154000
*   GEN;                                                           0087 00155000
*                                                                  0087 00156000
I007C03  DS    0H                                                  0087 00157000
         OPEN  (LOCCDS,(OUTPUT))        /*OPEN LOCAL DATA SET        */ 00158000
         LA    WKREG1,LOCCDS            /*SET UP PTR                 */ 00159000
         TM    OPENFLAG(WKREG1),GOODOPEN /*WAS OPEN GOOD             */ 00160000
         BZ    I007CER1                 /*NO-BR & PRT ERROR MSG      */ 00161000
         SPACE                                                          00162000
*   /*****************************************************************/ 00163000
*   /*                                                               */ 00164000
*   /* ITACONV FROM(CDSUA)TO(CDSMEMBR)COUNT(4)TYPE(HE) INVOKED       */ 00165000
*   /*                                                               */ 00166000
*   /*****************************************************************/ 00167000
*                                                                  0088 00168000
*   DCL                                                            0088 00169000
*     1 ITATCPRM BDY(WORD),         /* CONVERT PARAMETER LIST        */ 00170000
*      2 * CHAR(4) INIT('0102F4F1'X),                              0088 00171000
*      2 ITATCFR PTR,               /* ADDRESS OF FROM FIELD         */ 00172000
*      2 ITATCTO PTR,               /* ADDRESS OF TO FIELD           */ 00173000
*      2 * BIT(8) INIT(0),          /* FLAGS FOR CONVERT MODULE      */ 00174000
*       3 ITATCTP BIT(1),           /* TYPE OF CONVERT REQUIRED      */ 00175000
*      2 ITATCNT FIXED(8);          /* NUMBER OF BYTES TO CONVERT    */ 00176000
*   ITATCFR=ADDR(CDSUA);            /* SET THE FROM ADDRESS          */ 00177000
         MVC   ITATCFR(4),CDSWKPTR                                 0089 00178000
*   ITATCTO=ADDR(CDSMEMBR);         /* SET THE TO ADDRESS            */ 00179000
         LA    @12,CDSMEMBR                                        0090 00180000
         ST    @12,ITATCTO                                         0090 00181000
*   ITATCTP='1'B;                   /* SET THE TYPE OF CONVERT BIT   */ 00182000
         OI    ITATCTP,B'10000000'                                 0091 00183000
*   ITATCNT=4;                      /* GIVE THE CONVERT BYTE COUNT   */ 00184000
         MVI   ITATCNT,X'04'                                       0092 00185000
*   R1=ADDR(ITATCPRM);              /* POINT TO CONVERT PARM LIST    */ 00186000
         LA    R1,ITATCPRM                                         0093 00187000
*   CALL ISTSC021;                  /* CALL CONVERT DIRECTLY         */ 00188000
         L     @15,@CV00740                                        0094 00189000
         BALR  @14,@15                                             0094 00190000
*   GEN;                                                           0095 00191000
         MVC  CDSMEMBR(1),CDSPREFX      /*SET UP PREFIX ON ADDRESS   */ 00192000
         SPACE                                                          00193000
         STOW  LOCCDS,CDSBLDL,D         /*DELETE CDS                 */ 00194000
         LTR   R15,R15                  /*IF RET CODE ¬= ZERO THEN   */ 00195000
         BNZ   I007CER2                 /*PRT ERROR MSG AND RETURN   */ 00196000
*I007CEX:                                                          0096 00197000
*                                                                  0096 00198000
*   /*****************************************************************/ 00199000
*   /*                                                               */ 00200000
*   /* TCEC MSGN(561) INVOKED                                        */ 00201000
*   /*                                                               */ 00202000
*   /*****************************************************************/ 00203000
*                                                                  0096 00204000
*   $TCECM='1'B;                    /* SET TCEC SW IN RCA            */ 00205000
I007CEX  OI    $TCECM(WAPTR),B'00000001'                           0096 00206000
*   R1=ADDR($TCA13);                /* SET UP PARM LIST $TR          */ 00207000
         LA    R1,$TCA13                                           0097 00208000
*   CALL #EXIT;                     /* CALL CECOM                    */ 00209000
         L     @15,#EXITA(,WAPTR)                                  0098 00210000
         BALR  @14,@15                                             0098 00211000
*   DCL                                                            0099 00212000
*     1 $TCA13,                     /* TCEC PARM LIST                */ 00213000
*      2 $TCB13 FIXED(32) INIT(561),/* MSG NUMBER                    */ 00214000
*      2 $TCC13 FIXED(32) INIT(0),  /* INCT LEN                      */ 00215000
*      2 $TCD13 BIT(8) INIT('00000000'B),/* FLAG                     */ 00216000
*      2 $TCE13 CHAR(4) INIT('FFFFFFFF'X);                         0099 00217000
*                                                                  0099 00218000
*/*  MSSAGE MASK                                                     */ 00219000
*                                                                  0100 00220000
*I007CEX1:                          /* TURN OFF SW.                  */ 00221000
*   $REMSW='0'B;                    /* TURN OFF SW                   */ 00222000
I007CEX1 NI    $REMSW(WAPTR),B'10111111'                           0100 00223000
*   GEN;                                                           0101 00224000
         CLOSE LOCCDS                   /*CLOSE LOCAL CDS DCB        */ 00225000
         CLOSE REMCDS                   /*CLOSE REMOTE CDS DCB       */ 00226000
*   RETURN;                         /* RETURN TO CALLER              */ 00227000
@EL00001 L     @13,4(,@13)                                         0102 00228000
@EF00001 DS    0H                                                  0102 00229000
@ER00001 L     @14,12(,@13)                                        0102 00230000
         LM    @00,@12,20(@13)                                     0102 00231000
         BR    @14                                                 0102 00232000
*   GEN;                                                           0103 00233000
         SPACE                                                          00234000
EXEC1   MVC   0(WKREG1,WKREG2),$INBUFR+1                                00235000
*   GEN(EJECT);                                                    0104 00236000
         EJECT                                                          00237000
*I007CER1:                                                         0105 00238000
*   $INBUFR=CDSSYMBN;               /* SET UP NAME IN MSG            */ 00239000
*                                                                  0105 00240000
I007CER1 MVI   $INBUFR+8(WAPTR),C' '                               0105 00241000
         MVC   $INBUFR+9(71,WAPTR),$INBUFR+8(WAPTR)                0105 00242000
         L     @12,CDSWKPTR                                        0105 00243000
         MVC   $INBUFR(8,WAPTR),CDSSYMBN(@12)                      0105 00244000
*   /*****************************************************************/ 00245000
*   /*                                                               */ 00246000
*   /* TCEC MSGN(901)SUB(YES) INVOKED                                */ 00247000
*   /*                                                               */ 00248000
*   /*****************************************************************/ 00249000
*                                                                  0106 00250000
*   $TCECM='1'B;                    /* SET TCEC SW IN RCA            */ 00251000
         OI    $TCECM(WAPTR),B'00000001'                           0106 00252000
*   R1=ADDR($TCA14);                /* SET UP PARM LIST $TR          */ 00253000
         LA    R1,$TCA14                                           0107 00254000
*   CALL #EXIT;                     /* CALL CECOM                    */ 00255000
         L     @15,#EXITA(,WAPTR)                                  0108 00256000
         BALR  @14,@15                                             0108 00257000
*   DCL                                                            0109 00258000
*     1 $TCA14,                     /* TCEC PARM LIST                */ 00259000
*      2 $TCB14 FIXED(32) INIT(901),/* MSG NUMBER                    */ 00260000
*      2 $TCC14 FIXED(32) INIT(0),  /* INCT LEN                      */ 00261000
*      2 $TCD14 BIT(8) INIT('10000000'B),/* FLAG                     */ 00262000
*      2 $TCE14 CHAR(4) INIT('FFFFFFFF'X);/* MSSAGE MASK REMOTE DD 0109 00263000
*                                      FAILED TO OPEN                */ 00264000
*   GOTO I007CEX1;                  /* RETURN TO CALLER              */ 00265000
         B     I007CEX1                                            0110 00266000
*I007CER2:                                                         0111 00267000
*                                                                  0111 00268000
*   /*****************************************************************/ 00269000
*   /*                                                               */ 00270000
*   /* TCEC MSGN(569) INVOKED                                        */ 00271000
*   /*                                                               */ 00272000
*   /*****************************************************************/ 00273000
*                                                                  0111 00274000
*   $TCECM='1'B;                    /* SET TCEC SW IN RCA            */ 00275000
I007CER2 OI    $TCECM(WAPTR),B'00000001'                           0111 00276000
*   R1=ADDR($TCA15);                /* SET UP PARM LIST $TR          */ 00277000
         LA    R1,$TCA15                                           0112 00278000
*   CALL #EXIT;                     /* CALL CECOM                    */ 00279000
         L     @15,#EXITA(,WAPTR)                                  0113 00280000
         BALR  @14,@15                                             0113 00281000
*   DCL                                                            0114 00282000
*     1 $TCA15,                     /* TCEC PARM LIST                */ 00283000
*      2 $TCB15 FIXED(32) INIT(569),/* MSG NUMBER                    */ 00284000
*      2 $TCC15 FIXED(32) INIT(0),  /* INCT LEN                      */ 00285000
*      2 $TCD15 BIT(8) INIT('00000000'B),/* FLAG                     */ 00286000
*      2 $TCE15 CHAR(4) INIT('FFFFFFFF'X);/* MSSAGE MASK UNABLE TO 0114 00287000
*                                      DELETE CDS                    */ 00288000
*   GOTO I007CEX1;                  /* RETURN TO CONTROL MODULE      */ 00289000
         B     I007CEX1                                            0115 00290000
*   GEN(EJECT);                                                    0116 00291000
         EJECT                                                          00292000
*                                                                  0117 00293000
*/********************************************************************/ 00294000
*/*  DATA CONTROL BLOCKS                                             */ 00295000
*/********************************************************************/ 00296000
*                                                                  0117 00297000
*   GEN;                                                           0117 00298000
REMCDS   DS    0F                                                       00299000
         DCB   DDNAME=SYMSYM,DSORG=PO,RECFM=UT,MACRF=(R,W),            X00300000
               LRECL=80,BLKSIZE=3600,SYNAD=I007CER1                     00301000
          SPACE 2                                                       00302000
LOCCDS   DS    0F                                                       00303000
         DCB   DDNAME=OLTCDSDD,DSORG=PO,RECFM=UT,MACRF=(R,W),          X00304000
               LRECL=80,BLKSIZE=3600,SYNAD=I007CER1                     00305000
*   DO;                             /* ATDSPLY                       */ 00306000
*   END;                            /* ATDSPLY                       */ 00307000
*   END ISTIC007;                                                  0120 00308000
         B     @EL00001                                            0120 00309000
@DATA    DS    0H                                                       00310000
@CH00153 DC    H'12'                                                    00311000
@CH00068 DC    H'80'                                                    00312000
         DS    0F                                                       00313000
@SA00001 DS    18F                                                      00314000
         DS    0F                                                       00315000
@CV00707 DC    V(ISTSC029)                                              00316000
@CV00740 DC    V(ISTSC021)                                              00317000
         DS    0D                                                       00318000
ZERO     DC    XL4'0'                                                   00319000
CDSWKPTR DS    A                                                        00320000
RCAPTR   DS    A                                                        00321000
CDSBLDL  DS    CL40                                                     00322000
         ORG   CDSBLDL                                                  00323000
CDSMEMBR DS    CL8                                                      00324000
@NM00001 DS    CL32                                                     00325000
         ORG   CDSBLDL+40                                               00326000
CDSPREFX DC    CL1'G'                                                   00327000
         DS    CL3                                                      00328000
ZZZGTPRM DS    CL13                                                     00329000
         ORG   ZZZGTPRM                                                 00330000
@NM00054 DC    X'0102F1F6'                                              00331000
ZZZGTCD  DS    AL4                                                      00332000
ZZZGTAD  DS    AL4                                                      00333000
ZZZGTCT  DS    FL1                                                      00334000
         ORG   ZZZGTPRM+13                                              00335000
         DS    CL3                                                      00336000
$TCA10   DS    CL13                                                     00337000
         ORG   $TCA10                                                   00338000
$TCB10   DC    A(574)                                                   00339000
$TCC10   DC    A(0)                                                     00340000
$TCD10   DC    B'00000000'                                              00341000
$TCE10   DC    X'FFFFFFFF'                                              00342000
         ORG   $TCA10+13                                                00343000
         DS    CL3                                                      00344000
$TCA11   DS    CL13                                                     00345000
         ORG   $TCA11                                                   00346000
$TCB11   DC    A(564)                                                   00347000
$TCC11   DC    A(0)                                                     00348000
$TCD11   DC    B'00000000'                                              00349000
$TCE11   DC    X'FFFFFFFF'                                              00350000
         ORG   $TCA11+13                                                00351000
         DS    CL3                                                      00352000
ITATCPRM DS    CL14                                                     00353000
         ORG   ITATCPRM                                                 00354000
@NM00055 DC    X'0102F4F1'                                              00355000
ITATCFR  DS    AL4                                                      00356000
ITATCTO  DS    AL4                                                      00357000
@NM00056 DC    AL1(0)                                                   00358000
         ORG   @NM00056                                                 00359000
ITATCTP  DS    BL1                                                      00360000
         ORG   ITATCPRM+13                                              00361000
ITATCNT  DS    FL1                                                      00362000
         ORG   ITATCPRM+14                                              00363000
         DS    CL2                                                      00364000
$TCA13   DS    CL13                                                     00365000
         ORG   $TCA13                                                   00366000
$TCB13   DC    A(561)                                                   00367000
$TCC13   DC    A(0)                                                     00368000
$TCD13   DC    B'00000000'                                              00369000
$TCE13   DC    X'FFFFFFFF'                                              00370000
         ORG   $TCA13+13                                                00371000
         DS    CL3                                                      00372000
$TCA14   DS    CL13                                                     00373000
         ORG   $TCA14                                                   00374000
$TCB14   DC    A(901)                                                   00375000
$TCC14   DC    A(0)                                                     00376000
$TCD14   DC    B'10000000'                                              00377000
$TCE14   DC    X'FFFFFFFF'                                              00378000
         ORG   $TCA14+13                                                00379000
         DS    CL3                                                      00380000
$TCA15   DS    CL13                                                     00381000
         ORG   $TCA15                                                   00382000
$TCB15   DC    A(569)                                                   00383000
$TCC15   DC    A(0)                                                     00384000
$TCD15   DC    B'00000000'                                              00385000
$TCE15   DC    X'FFFFFFFF'                                              00386000
         ORG   $TCA15+13                                                00387000
         DS    CL3                                                      00388000
PATCH    DC    20F'0'                                                   00389000
@00      EQU   00                      EQUATES FOR REGISTERS 0-15       00390000
@01      EQU   01                                                       00391000
@02      EQU   02                                                       00392000
@03      EQU   03                                                       00393000
@04      EQU   04                                                       00394000
@05      EQU   05                                                       00395000
@06      EQU   06                                                       00396000
@07      EQU   07                                                       00397000
@08      EQU   08                                                       00398000
@09      EQU   09                                                       00399000
@10      EQU   10                                                       00400000
@11      EQU   11                                                       00401000
@12      EQU   12                                                       00402000
@13      EQU   13                                                       00403000
@14      EQU   14                                                       00404000
@15      EQU   15                                                       00405000
CECMAP   EQU   @04                                                      00406000
WKREG1   EQU   @05                                                      00407000
WAPTR    EQU   @02                                                      00408000
R1       EQU   @01                                                      00409000
R8       EQU   @08                                                      00410000
R15      EQU   @15                                                      00411000
R0       EQU   @00                                                      00412000
R10      EQU   @10                                                      00413000
R11      EQU   @11                                                      00414000
R12      EQU   @12                                                      00415000
R13      EQU   @13                                                      00416000
R14      EQU   @14                                                      00417000
R2       EQU   @02                                                      00418000
R3       EQU   @03                                                      00419000
R4       EQU   @04                                                      00420000
R5       EQU   @05                                                      00421000
R6       EQU   @06                                                      00422000
R7       EQU   @07                                                      00423000
R9       EQU   @09                                                      00424000
WKREG2   EQU   @06                                                      00425000
WKREG3   EQU   @07                                                      00426000
$RCAAREA EQU   0                                                        00427000
$POINTER EQU   $RCAAREA+100                                             00428000
$TRTBLA  EQU   $POINTER+124                                             00429000
$CONSTNT EQU   $RCAAREA+244                                             00430000
$RCAFLG  EQU   $RCAAREA+604                                             00431000
TOLTEPWA EQU   0                                                        00432000
$SCTTBLE EQU   TOLTEPWA                                                 00433000
$TESTOPT EQU   $SCTTBLE+2                                               00434000
$ERROPT  EQU   $SCTTBLE+3                                               00435000
$PDEVFLG EQU   $SCTTBLE+10                                              00436000
$CDSFLGS EQU   $SCTTBLE+11                                              00437000
$CDS8T19 EQU   $SCTTBLE+20                                              00438000
$EXECFLG EQU   $SCTTBLE+33                                              00439000
$OLTFLGS EQU   $SCTTBLE+36                                              00440000
$OLTFLG2 EQU   $SCTTBLE+37                                              00441000
$TOTFLG1 EQU   $SCTTBLE+38                                              00442000
$ROUTMSK EQU   $SCTTBLE+40                                              00443000
$CDA     EQU   TOLTEPWA+100                                             00444000
$RCA     EQU   $CDA+44                                                  00445000
$OLTPTR  EQU   $CDA+52                                                  00446000
$LOWADDR EQU   $OLTPTR                                                  00447000
$HIMOREC EQU   $CDA+60                                                  00448000
$COMMFLG EQU   TOLTEPWA+224                                             00449000
$FLAG1   EQU   $COMMFLG                                                 00450000
$FLAG2   EQU   $COMMFLG+1                                               00451000
$FLAG3   EQU   $COMMFLG+2                                               00452000
$FLAG4   EQU   $COMMFLG+3                                               00453000
$FLAG5   EQU   $COMMFLG+4                                               00454000
$EOJ     EQU   $FLAG5                                                   00455000
$CANCEL  EQU   $EOJ                                                     00456000
$FLAG6   EQU   $COMMFLG+5                                               00457000
$ABNDBIT EQU   $FLAG6                                                   00458000
$FLAG7   EQU   $COMMFLG+6                                               00459000
$FLAG8   EQU   $COMMFLG+7                                               00460000
$TCECM   EQU   $FLAG8                                                   00461000
$FLAG9   EQU   $COMMFLG+8                                               00462000
$REMSW   EQU   $FLAG9                                                   00463000
$FLAG10  EQU   $COMMFLG+9                                               00464000
$FLAG11  EQU   $COMMFLG+10                                              00465000
$FLAG12  EQU   $COMMFLG+11                                              00466000
$FLAG13  EQU   $COMMFLG+12                                              00467000
$DEVTBLE EQU   TOLTEPWA+240                                             00468000
$DEVCDS  EQU   $DEVTBLE                                                 00469000
$DEVUNAD EQU   $DEVCDS                                                  00470000
@NM00040 EQU   $DEVUNAD+2                                               00471000
$DEVFEAT EQU   $DEVCDS+4                                                00472000
$DEVCDSF EQU   $DEVCDS+9                                                00473000
$DEVSDCF EQU   $DEVCDS+10                                               00474000
$$SYMNME EQU   $DEVCDS+12                                               00475000
$DEVFLG1 EQU   $DEVTBLE+20                                              00476000
$EVNCPLT EQU   $DEVFLG1                                                 00477000
$ATTNEXP EQU   $DEVFLG1                                                 00478000
$INTOCC  EQU   $DEVFLG1                                                 00479000
$DEVFLG2 EQU   $DEVTBLE+21                                              00480000
$DEVTECB EQU   $DEVTBLE+22                                              00481000
$OPIS    EQU   $DEVTECB                                                 00482000
$OPND    EQU   $DEVTECB+2                                               00483000
$DEVFLG3 EQU   $DEVTBLE+27                                              00484000
$SIOFLG  EQU   $DEVFLG3                                                 00485000
$IFTOUT  EQU   $DEVTBLE+36                                              00486000
$DEVSESP EQU   $IFTOUT                                                  00487000
$SSCPDAF EQU   $IFTOUT+6                                                00488000
$LDNCBPT EQU   $DEVTBLE+48                                              00489000
$RNINFO  EQU   $DEVTBLE+56                                              00490000
$DEVFLG5 EQU   $RNINFO+8                                                00491000
$DEVFLG4 EQU   $DEVTBLE+65                                              00492000
$SLTBL   EQU   TOLTEPWA+1468                                            00493000
$RUNTEST EQU   $SLTBL+13                                                00494000
$TESTFLG EQU   $SLTBL+21                                                00495000
$SECLST  EQU   $SLTBL+22                                                00496000
$INBUFR  EQU   TOLTEPWA+2104                                            00497000
#EXITA   EQU   TOLTEPWA+2632                                            00498000
$CCOMDAT EQU   TOLTEPWA+2644                                            00499000
$CFLGS   EQU   $CCOMDAT+16                                              00500000
$24FEMSG EQU   TOLTEPWA+2681                                            00501000
$24CATMG EQU   $24FEMSG+11                                              00502000
@NM00049 EQU   TOLTEPWA+2776                                            00503000
$OUNTPTR EQU   @NM00049+4                                               00504000
$NSPTR   EQU   $OUNTPTR                                                 00505000
$NSCNT   EQU   @NM00049+10                                              00506000
$ENXX    EQU   @NM00049+15                                              00507000
$IMITX   EQU   $ENXX                                                    00508000
SVESC033 EQU   TOLTEPWA+3160                                            00509000
SVECC013 EQU   TOLTEPWA+3232                                            00510000
SVEIC003 EQU   TOLTEPWA+3592                                            00511000
SVESC022 EQU   TOLTEPWA+3736                                            00512000
SVECC011 EQU   TOLTEPWA+4024                                            00513000
#EXIT    EQU   0                                                        00514000
CECOMMAP EQU   0                                                        00515000
CDSMAP   EQU   0                                                        00516000
CDSUA    EQU   CDSMAP                                                   00517000
CDSMFCT  EQU   CDSMAP+4                                                 00518000
CDSFEAT  EQU   CDSMFCT+1                                                00519000
CDSFLAG  EQU   CDSMAP+9                                                 00520000
CDSFPMD  EQU   CDSFLAG                                                  00521000
CDSSYMB  EQU   CDSFLAG                                                  00522000
CDSREMSY EQU   CDSFLAG                                                  00523000
CDSSYMBN EQU   CDSMAP+12                                                00524000
$TRTBL   EQU   0                                                        00525000
SVECC012 EQU   SVESC022                                                 00526000
SVEIC00A EQU   SVEIC003                                                 00527000
SVEIC004 EQU   SVEIC003                                                 00528000
SVEIC005 EQU   SVEIC003                                                 00529000
SVESC02A EQU   SVESC022                                                 00530000
SVESC02B EQU   SVESC022                                                 00531000
SVESC02D EQU   SVESC022                                                 00532000
SVESC02E EQU   SVESC022                                                 00533000
SVESC02F EQU   SVECC013                                                 00534000
SVESC024 EQU   SVESC022                                                 00535000
SVESC027 EQU   SVESC022                                                 00536000
SVESC029 EQU   SVESC033                                                 00537000
SVESC031 EQU   SVECC013                                                 00538000
SVESC032 EQU   SVECC011                                                 00539000
SVETC037 EQU   SVEIC003                                                 00540000
         AGO   .@UNREFD                START UNREFERENCED COMPONENTS    00541000
CDSEXARA EQU   CDSMAP+20                                                00542000
CDSEXTM  EQU   CDSFLAG+2                                                00543000
CDSEXTB  EQU   CDSFLAG+2                                                00544000
CDSTMERB EQU   CDSFLAG+2                                                00545000
@NM00053 EQU   CDSFLAG+1                                                00546000
CDSDVPRO EQU   CDSFLAG+1                                                00547000
CDSNTPRI EQU   CDSFLAG+1                                                00548000
CDSLINCN EQU   CDSFLAG                                                  00549000
CDS2CHAN EQU   CDSFLAG                                                  00550000
CDSEXTPR EQU   CDSFLAG                                                  00551000
CDSFEVOL EQU   CDSFLAG                                                  00552000
CDSSHAR  EQU   CDSFLAG                                                  00553000
CDSBYTCT EQU   CDSMAP+8                                                 00554000
CDSTYPE  EQU   CDSMFCT+3                                                00555000
CDSCLASS EQU   CDSMFCT+2                                                00556000
@NM00052 EQU   CDSFEAT                                                  00557000
CDSDEVM  EQU   CDSFEAT                                                  00558000
CDSDEVT  EQU   CDSFEAT                                                  00559000
CDSASCII EQU   CDSFEAT                                                  00560000
CDSMODEL EQU   CDSMFCT                                                  00561000
$CECFLAG EQU   CECOMMAP+20                                              00562000
$CEINCT  EQU   CECOMMAP+16                                              00563000
$CEINADR EQU   CECOMMAP+12                                              00564000
$CEOUTCT EQU   CECOMMAP+8                                               00565000
$CEOUTAD EQU   CECOMMAP+4                                               00566000
$CECIDNT EQU   CECOMMAP+2                                               00567000
$CECLEVL EQU   CECOMMAP+1                                               00568000
$CECTRMG EQU   CECOMMAP                                                 00569000
SVECC010 EQU   TOLTEPWA+3952                                            00570000
SVETC035 EQU   TOLTEPWA+3880                                            00571000
SVESC030 EQU   TOLTEPWA+3808                                            00572000
SVESC020 EQU   TOLTEPWA+3664                                            00573000
SVEIC002 EQU   TOLTEPWA+3520                                            00574000
SVECC014 EQU   TOLTEPWA+3376                                            00575000
SVESC120 EQU   TOLTEPWA+3304                                            00576000
SVESC025 EQU   TOLTEPWA+3088                                            00577000
@NM00051 EQU   TOLTEPWA+2980                                            00578000
$RPLERR  EQU   TOLTEPWA+2977                                            00579000
@NM00050 EQU   TOLTEPWA+2976                                            00580000
$R13PR3  EQU   TOLTEPWA+2972                                            00581000
$CEINT2  EQU   TOLTEPWA+2968                                            00582000
$CEINT1  EQU   TOLTEPWA+2964                                            00583000
$MSGGET  EQU   TOLTEPWA+2960                                            00584000
$ACQLIST EQU   TOLTEPWA+2956                                            00585000
$R4SAVE1 EQU   TOLTEPWA+2952                                            00586000
$CLSISS  EQU   TOLTEPWA+2950                                            00587000
$CLSCNT  EQU   TOLTEPWA+2948                                            00588000
$CUTABLE EQU   TOLTEPWA+2868                                            00589000
$BUFSZ2  EQU   TOLTEPWA+2864                                            00590000
$RESID2  EQU   TOLTEPWA+2860                                            00591000
$OLTCCW2 EQU   TOLTEPWA+2856                                            00592000
$ENDBFR2 EQU   TOLTEPWA+2852                                            00593000
$1STBFR2 EQU   TOLTEPWA+2848                                            00594000
$TECB2   EQU   TOLTEPWA+2844                                            00595000
$BUFSZ1  EQU   TOLTEPWA+2840                                            00596000
$RESID1  EQU   TOLTEPWA+2836                                            00597000
$OLTCCW1 EQU   TOLTEPWA+2832                                            00598000
$ENDBFR1 EQU   TOLTEPWA+2828                                            00599000
$1STBFR1 EQU   TOLTEPWA+2824                                            00600000
$TECB1   EQU   TOLTEPWA+2820                                            00601000
$WAITIME EQU   TOLTEPWA+2816                                            00602000
$TRTN#   EQU   TOLTEPWA+2815                                            00603000
$WIODEV  EQU   TOLTEPWA+2814                                            00604000
$RQSTSZE EQU   TOLTEPWA+2812                                            00605000
$RQSTPTR EQU   TOLTEPWA+2808                                            00606000
$R4SAVE  EQU   TOLTEPWA+2804                                            00607000
$PARTADR EQU   TOLTEPWA+2800                                            00608000
$TBSDATA EQU   TOLTEPWA+2796                                            00609000
$CTWIDTH EQU   TOLTEPWA+2795                                            00610000
$CTLINE  EQU   TOLTEPWA+2794                                            00611000
$APWIDTH EQU   TOLTEPWA+2793                                            00612000
$APLINE  EQU   TOLTEPWA+2792                                            00613000
$INDEX   EQU   $IMITX                                                   00614000
$UMXX    EQU   @NM00049+14                                              00615000
$NSXX    EQU   @NM00049+12                                              00616000
$ATACNT  EQU   $NSCNT                                                   00617000
$CTR     EQU   @NM00049+8                                               00618000
$ATAPTR  EQU   $NSPTR                                                   00619000
$DDRPTR  EQU   @NM00049                                                 00620000
$DTORESP EQU   TOLTEPWA+2712                                            00621000
$APNAME  EQU   TOLTEPWA+2704                                            00622000
$24SYMNE EQU   $24CATMG+4                                               00623000
$24DEVAD EQU   $24CATMG                                                 00624000
$24RTN#  EQU   $24FEMSG+8                                               00625000
$ESECTID EQU   $24FEMSG                                                 00626000
$24FLGS  EQU   TOLTEPWA+2680                                            00627000
$24SAVE2 EQU   TOLTEPWA+2676                                            00628000
$24SAVE1 EQU   TOLTEPWA+2672                                            00629000
$24UNADR EQU   TOLTEPWA+2668                                            00630000
$24SAV13 EQU   TOLTEPWA+2664                                            00631000
$24RETCD EQU   TOLTEPWA+2663                                            00632000
$MACID   EQU   TOLTEPWA+2661                                            00633000
$CSPARE  EQU   $CFLGS                                                   00634000
$C2WAY   EQU   $CFLGS                                                   00635000
$CINCT   EQU   $CCOMDAT+12                                              00636000
$CINADR  EQU   $CCOMDAT+8                                               00637000
$COUTCT  EQU   $CCOMDAT+4                                               00638000
$COUTAD  EQU   $CCOMDAT                                                 00639000
ROOTLOC  EQU   TOLTEPWA+2640                                            00640000
$RETREG  EQU   TOLTEPWA+2636                                            00641000
$WORK    EQU   TOLTEPWA+2376                                            00642000
$EXTA    EQU   TOLTEPWA+2320                                            00643000
$PASSONA EQU   TOLTEPWA+2264                                            00644000
$TRMINPT EQU   TOLTEPWA+2184                                            00645000
$BUFFER  EQU   TOLTEPWA+1976                                            00646000
$TLTRPL3 EQU   TOLTEPWA+1856                                            00647000
$TLTRPL2 EQU   TOLTEPWA+1736                                            00648000
$TLTRPL1 EQU   TOLTEPWA+1616                                            00649000
@NM00048 EQU   $SLTBL+135                                               00650000
$HIGHRTN EQU   $SLTBL+134                                               00651000
$PRIMADR EQU   $SLTBL+130                                               00652000
$CTSTPT  EQU   $SLTBL+128                                               00653000
$TSTCNT  EQU   $SLTBL+126                                               00654000
$SECFLGS EQU   $SECLST+3                                                00655000
$SECTION EQU   $SECLST                                                  00656000
$SECACT  EQU   $TESTFLG                                                 00657000
$CANTRUN EQU   $TESTFLG                                                 00658000
$FINAL   EQU   $TESTFLG                                                 00659000
$TESTSUF EQU   $RUNTEST+5                                               00660000
$TESTNUM EQU   $RUNTEST+1                                               00661000
$LETPRF  EQU   $RUNTEST                                                 00662000
$SYMBOLC EQU   $SLTBL+5                                                 00663000
$FAMILY  EQU   $SLTBL                                                   00664000
$CDEVPT  EQU   TOLTEPWA+1466                                            00665000
$DEVCNTS EQU   TOLTEPWA+1464                                            00666000
$FEEDBCK EQU   $DEVTBLE+66                                              00667000
$WTISUED EQU   $DEVFLG4                                                 00668000
$EXIOISD EQU   $DEVFLG4                                                 00669000
$REMWRIT EQU   $DEVFLG4                                                 00670000
$REMDONE EQU   $DEVFLG4                                                 00671000
$2NDUSED EQU   $DEVFLG4                                                 00672000
$1STUSED EQU   $DEVFLG4                                                 00673000
$IGLXIFB EQU   $DEVFLG4                                                 00674000
$EXIOLV3 EQU   $DEVFLG4                                                 00675000
@NM00047 EQU   $DEVFLG5                                                 00676000
$DVBASIC EQU   $DEVFLG5                                                 00677000
$ASCII   EQU   $DEVFLG5                                                 00678000
$DEVLU   EQU   $DEVFLG5                                                 00679000
$OPNDFAL EQU   $DEVFLG5                                                 00680000
$ACQNCB  EQU   $DEVFLG5                                                 00681000
$REMOTE  EQU   $DEVFLG5                                                 00682000
$ENDNODE EQU   $DEVFLG5                                                 00683000
$LINENME EQU   $RNINFO                                                  00684000
$CID     EQU   $DEVTBLE+52                                              00685000
$DVCOL   EQU   $LDNCBPT+2                                               00686000
$DVROW   EQU   $LDNCBPT                                                 00687000
$NCSPLP  EQU   $DEVTBLE+44                                              00688000
$DVLN    EQU   $SSCPDAF                                                 00689000
$DAF     EQU   $DEVSESP+4                                               00690000
$VARYPAB EQU   $DEVSESP                                                 00691000
$SYSMN   EQU   $DEVTBLE+28                                              00692000
@NM00046 EQU   $DEVFLG3                                                 00693000
$CLRSNT  EQU   $DEVFLG3                                                 00694000
$OLTERR  EQU   $DEVFLG3                                                 00695000
$SRTEST  EQU   $DEVFLG3                                                 00696000
$DVSNDOK EQU   $SIOFLG                                                  00697000
$POLLREQ EQU   $DEVFLG3                                                 00698000
$ACQRED  EQU   $DEVFLG3                                                 00699000
$NOTDEV  EQU   $DEVFLG3                                                 00700000
$DVINCT  EQU   $DEVTBLE+26                                              00701000
$DVBRKST EQU   $OPND+1                                                  00702000
$DVBRKSN EQU   $OPND                                                    00703000
$DVSEQNO EQU   $OPIS                                                    00704000
$CEINTRP EQU   $DEVFLG2                                                 00705000
$TESTMDE EQU   $DEVFLG2                                                 00706000
$DEVALOC EQU   $DEVFLG2                                                 00707000
$ALLDATA EQU   $DEVFLG2                                                 00708000
$ENDCNTL EQU   $DEVFLG2                                                 00709000
$CTLDEV  EQU   $DEVFLG2                                                 00710000
$NOCDS   EQU   $DEVFLG2                                                 00711000
$DATAIN  EQU   $DEVFLG2                                                 00712000
$PRIMARY EQU   $DEVFLG1                                                 00713000
$DVCTBYT EQU   $INTOCC                                                  00714000
$DEVACT  EQU   $DEVFLG1                                                 00715000
$DVLGMDE EQU   $ATTNEXP                                                 00716000
$DVSPRM  EQU   $EVNCPLT                                                 00717000
$GRABBED EQU   $DEVFLG1                                                 00718000
$CATASTR EQU   $DEVFLG1                                                 00719000
$LETGO   EQU   $DEVFLG1                                                 00720000
$CURELEM EQU   $$SYMNME+4                                               00721000
$MSGOTSD EQU   $$SYMNME                                                 00722000
$EXTDEV  EQU   $DEVCDS+11                                               00723000
@NM00045 EQU   $DEVSDCF                                                 00724000
$NOTPRIM EQU   $DEVSDCF                                                 00725000
@NM00044 EQU   $DEVCDSF                                                 00726000
@NM00043 EQU   $DEVCDSF                                                 00727000
@NM00042 EQU   $DEVCDSF                                                 00728000
$CDSNAME EQU   $DEVCDSF                                                 00729000
$EXTRN   EQU   $DEVCDSF                                                 00730000
$CEVOLUM EQU   $DEVCDSF                                                 00731000
$SHARD   EQU   $DEVCDSF                                                 00732000
$DEVFPM  EQU   $DEVCDSF                                                 00733000
$DEVCNT  EQU   $DEVCDS+8                                                00734000
$DEVTYPE EQU   $DEVFEAT+3                                               00735000
$DEVCLAS EQU   $DEVFEAT+2                                               00736000
$DEVFRRS EQU   $DEVFEAT+1                                               00737000
$DEVMOD  EQU   $DEVFEAT                                                 00738000
$DEVRDGT EQU   @NM00040+1                                               00739000
$DEVCTLU EQU   @NM00040+1                                               00740000
$DEVCHAN EQU   @NM00040                                                 00741000
@NM00041 EQU   @NM00040                                                 00742000
$CTINDX  EQU   $DEVUNAD                                                 00743000
$FLAG16  EQU   $COMMFLG+15                                              00744000
$FLAG15  EQU   $COMMFLG+14                                              00745000
$FLAG14  EQU   $COMMFLG+13                                              00746000
$TEP2ND  EQU   $FLAG13                                                  00747000
$TEP1ST  EQU   $FLAG13                                                  00748000
$CATMSG  EQU   $FLAG13                                                  00749000
$PRMPTSW EQU   $FLAG13                                                  00750000
$DEVENT  EQU   $FLAG13                                                  00751000
$OLTMACC EQU   $FLAG13                                                  00752000
$LGON    EQU   $FLAG13                                                  00753000
$CTLOGON EQU   $FLAG13                                                  00754000
@NM00039 EQU   $FLAG12                                                  00755000
$VARYINP EQU   $FLAG12                                                  00756000
$ENDTEST EQU   $FLAG12                                                  00757000
$VRYHRD  EQU   $FLAG12                                                  00758000
$VRYSFT  EQU   $FLAG12                                                  00759000
$POSTFLG EQU   $FLAG12                                                  00760000
$OPTMSG  EQU   $FLAG12                                                  00761000
$FEORCAT EQU   $FLAG11                                                  00762000
@NM00038 EQU   $FLAG11                                                  00763000
@NM00037 EQU   $FLAG10                                                  00764000
$INBND   EQU   $FLAG10                                                  00765000
$WAITFLG EQU   $FLAG10                                                  00766000
$DPRINT  EQU   $FLAG10                                                  00767000
$HOLD    EQU   $FLAG9                                                   00768000
$NOTRRCH EQU   $FLAG9                                                   00769000
@NM00036 EQU   $FLAG9                                                   00770000
$COPY    EQU   $FLAG9                                                   00771000
$LSTLNSW EQU   $FLAG9                                                   00772000
$MULLNSW EQU   $FLAG9                                                   00773000
$IGRES   EQU   $FLAG9                                                   00774000
$VS2     EQU   $FLAG8                                                   00775000
$VS1     EQU   $FLAG8                                                   00776000
$EDOS    EQU   $FLAG8                                                   00777000
@NM00035 EQU   $FLAG8                                                   00778000
$TWOWAY  EQU   $FLAG8                                                   00779000
@NM00034 EQU   $FLAG8                                                   00780000
$RCVMSG  EQU   $FLAG7                                                   00781000
$RCVRFLG EQU   $FLAG7                                                   00782000
$SNDRFLG EQU   $FLAG7                                                   00783000
$LDOIS   EQU   $FLAG7                                                   00784000
$DCONTCT EQU   $FLAG7                                                   00785000
$EXIOWAT EQU   $FLAG7                                                   00786000
$2NDDATA EQU   $FLAG7                                                   00787000
$1STDATA EQU   $FLAG7                                                   00788000
$CIREQ   EQU   $FLAG6                                                   00789000
$ABTERM  EQU   $ABNDBIT                                                 00790000
$FSTMCIS EQU   $FLAG6                                                   00791000
$DISCREQ EQU   $FLAG6                                                   00792000
$DISCISS EQU   $FLAG6                                                   00793000
$CHANGE  EQU   $FLAG6                                                   00794000
$CTERROR EQU   $FLAG6                                                   00795000
$RECAL11 EQU   $FLAG6                                                   00796000
@NM00033 EQU   $FLAG5                                                   00797000
$PROGCK  EQU   $CANCEL                                                  00798000
$PRINTAP EQU   $FLAG5                                                   00799000
@NM00032 EQU   $FLAG5                                                   00800000
$MSG922  EQU   $FLAG5                                                   00801000
$CT924   EQU   $FLAG5                                                   00802000
$FSTCAT  EQU   $FLAG5                                                   00803000
$FSTFE   EQU   $FLAG5                                                   00804000
$ACTOPND EQU   $FLAG4                                                   00805000
$ACQCUTT EQU   $FLAG4                                                   00806000
$CLSSACT EQU   $FLAG4                                                   00807000
$BACKINT EQU   $FLAG4                                                   00808000
$DMSGSW  EQU   $FLAG4                                                   00809000
$TSTDEVP EQU   $FLAG4                                                   00810000
$APRQPER EQU   $FLAG4                                                   00811000
$OPCOM   EQU   $FLAG4                                                   00812000
$NEWAP   EQU   $FLAG3                                                   00813000
$ALTPRTR EQU   $FLAG3                                                   00814000
$OPTERR  EQU   $FLAG3                                                   00815000
$PRTONLY EQU   $FLAG3                                                   00816000
$REQSTOR EQU   $FLAG3                                                   00817000
$LOGOFFE EQU   $FLAG3                                                   00818000
$TSTERR  EQU   $FLAG3                                                   00819000
$DEVERR  EQU   $FLAG3                                                   00820000
$PARTIAL EQU   $FLAG2                                                   00821000
$NRMTERM EQU   $FLAG2                                                   00822000
$VALDTST EQU   $FLAG2                                                   00823000
$VALDDEV EQU   $FLAG2                                                   00824000
$DBLSLSH EQU   $FLAG2                                                   00825000
$NDR     EQU   $FLAG2                                                   00826000
@NM00031 EQU   $FLAG2                                                   00827000
$OLTACT  EQU   $FLAG1                                                   00828000
$NORELDV EQU   $FLAG1                                                   00829000
@NM00030 EQU   $FLAG1                                                   00830000
$OPTCHNG EQU   $FLAG1                                                   00831000
$DEVCHNG EQU   $FLAG1                                                   00832000
$TESTCNG EQU   $FLAG1                                                   00833000
$CNSLFG  EQU   $FLAG1                                                   00834000
$TEP3RD  EQU   $FLAG1                                                   00835000
@NM00029 EQU   $CDA+120                                                 00836000
$CUCNT   EQU   $CDA+118                                                 00837000
@NM00028 EQU   $CDA+117                                                 00838000
$PRTFORM EQU   $CDA+116                                                 00839000
$OPISCNT EQU   $CDA+114                                                 00840000
$OPNDCNT EQU   $CDA+112                                                 00841000
$GETMSZE EQU   $CDA+110                                                 00842000
$GRCNTS  EQU   $CDA+108                                                 00843000
$CTLCNT  EQU   $CDA+106                                                 00844000
$ACTLVL  EQU   $CDA+105                                                 00845000
$PRNTLVL EQU   $CDA+104                                                 00846000
$ERRCNTA EQU   $CDA+102                                                 00847000
$TLCNT   EQU   $CDA+100                                                 00848000
$TIMEALW EQU   $CDA+96                                                  00849000
$PTRAREA EQU   $CDA+92                                                  00850000
$GETMPTR EQU   $CDA+88                                                  00851000
$R13PTRT EQU   $CDA+84                                                  00852000
$R13PTR  EQU   $CDA+80                                                  00853000
$TEPEND  EQU   $CDA+76                                                  00854000
$PLINKDL EQU   $CDA+72                                                  00855000
$TEPBEGN EQU   $CDA+68                                                  00856000
$FRELPTR EQU   $CDA+64                                                  00857000
$HIGHADR EQU   $HIMOREC                                                 00858000
$LOMOREC EQU   $CDA+56                                                  00859000
$ENDCOMM EQU   $CDA+48                                                  00860000
$COMMON  EQU   $RCA                                                     00861000
$SLASHAD EQU   $CDA+32                                                  00862000
$PASSON  EQU   $CDA+28                                                  00863000
$TOLBRTB EQU   $CDA+24                                                  00864000
$SCTPTR8 EQU   $CDA+20                                                  00865000
$SCTPTR  EQU   $CDA+16                                                  00866000
$TBWDPTR EQU   $CDA+12                                                  00867000
$TFWDPTR EQU   $CDA+8                                                   00868000
@NM00027 EQU   $CDA                                                     00869000
@NM00026 EQU   $SCTTBLE+98                                              00870000
$SCTLWTC EQU   $SCTTBLE+96                                              00871000
$SCTLWTA EQU   $SCTTBLE+92                                              00872000
#EXT     EQU   $SCTTBLE+88                                              00873000
#PASS    EQU   $SCTTBLE+84                                              00874000
#TABLE   EQU   $SCTTBLE+80                                              00875000
#MSGIDAC EQU   $SCTTBLE+78                                              00876000
@NM00025 EQU   $SCTTBLE+71                                              00877000
$RETMASK EQU   $SCTTBLE+70                                              00878000
$R249255 EQU   $ROUTMSK+29                                              00879000
$R241248 EQU   $ROUTMSK+28                                              00880000
$R233240 EQU   $ROUTMSK+27                                              00881000
$R225232 EQU   $ROUTMSK+26                                              00882000
$R217224 EQU   $ROUTMSK+25                                              00883000
$R209216 EQU   $ROUTMSK+24                                              00884000
$R201208 EQU   $ROUTMSK+23                                              00885000
$R193200 EQU   $ROUTMSK+22                                              00886000
$R185192 EQU   $ROUTMSK+21                                              00887000
$R177184 EQU   $ROUTMSK+20                                              00888000
$R169176 EQU   $ROUTMSK+19                                              00889000
$R161168 EQU   $ROUTMSK+18                                              00890000
$R153160 EQU   $ROUTMSK+17                                              00891000
$R145152 EQU   $ROUTMSK+16                                              00892000
$R137144 EQU   $ROUTMSK+15                                              00893000
$R129136 EQU   $ROUTMSK+14                                              00894000
$R121128 EQU   $ROUTMSK+13                                              00895000
$R113120 EQU   $ROUTMSK+12                                              00896000
$R105112 EQU   $ROUTMSK+11                                              00897000
$R097104 EQU   $ROUTMSK+10                                              00898000
$R089096 EQU   $ROUTMSK+9                                               00899000
$R081088 EQU   $ROUTMSK+8                                               00900000
$R073080 EQU   $ROUTMSK+7                                               00901000
$R065072 EQU   $ROUTMSK+6                                               00902000
$R057064 EQU   $ROUTMSK+5                                               00903000
$R049056 EQU   $ROUTMSK+4                                               00904000
$R041048 EQU   $ROUTMSK+3                                               00905000
$R033040 EQU   $ROUTMSK+2                                               00906000
$R025032 EQU   $ROUTMSK+1                                               00907000
$R017024 EQU   $ROUTMSK                                                 00908000
$TOTFLG2 EQU   $SCTTBLE+39                                              00909000
@NM00024 EQU   $TOTFLG1                                                 00910000
@NM00023 EQU   $TOTFLG1                                                 00911000
@NM00022 EQU   $TOTFLG1                                                 00912000
$CURELOD EQU   $TOTFLG1                                                 00913000
$CTEQTT  EQU   $TOTFLG1                                                 00914000
@NM00021 EQU   $TOTFLG1                                                 00915000
@NM00020 EQU   $TOTFLG1                                                 00916000
$LINESHR EQU   $TOTFLG1                                                 00917000
@NM00019 EQU   $OLTFLG2                                                 00918000
@NM00018 EQU   $OLTFLG2                                                 00919000
@NM00017 EQU   $OLTFLG2                                                 00920000
@NM00016 EQU   $OLTFLG2                                                 00921000
@NM00015 EQU   $OLTFLG2                                                 00922000
@NM00014 EQU   $OLTFLG2                                                 00923000
@NM00013 EQU   $OLTFLG2                                                 00924000
$TALK    EQU   $OLTFLG2                                                 00925000
$DYCOM   EQU   $OLTFLGS                                                 00926000
@NM00012 EQU   $OLTFLGS                                                 00927000
$TRACE   EQU   $OLTFLGS                                                 00928000
$RETCODE EQU   $OLTFLGS                                                 00929000
$CONTCB  EQU   $OLTFLGS                                                 00930000
$RETAIN  EQU   $OLTFLGS                                                 00931000
$CLEANRT EQU   $OLTFLGS                                                 00932000
$MANINTV EQU   $OLTFLGS                                                 00933000
$OLTSIZE EQU   $SCTTBLE+34                                              00934000
$QSCTMOD EQU   $EXECFLG                                                 00935000
$CTRLMOD EQU   $EXECFLG                                                 00936000
$CLEANUP EQU   $EXECFLG                                                 00937000
$LSTPDEV EQU   $EXECFLG                                                 00938000
$ERRCNT  EQU   $EXECFLG                                                 00939000
$RTNSLCT EQU   $EXECFLG                                                 00940000
$MULTDEV EQU   $EXECFLG                                                 00941000
@NM00011 EQU   $EXECFLG                                                 00942000
$RMSKCNT EQU   $SCTTBLE+32                                              00943000
$SYNAME  EQU   $CDS8T19+4                                               00944000
$EXTSIG  EQU   $CDS8T19+3                                               00945000
$CDFLGS  EQU   $CDS8T19+1                                               00946000
$CDSCNT  EQU   $CDS8T19                                                 00947000
$PDEVDSC EQU   $SCTTBLE+16                                              00948000
$PDEVADR EQU   $SCTTBLE+12                                              00949000
$COMMCN  EQU   $CDSFLGS                                                 00950000
$CUSTSYM EQU   $CDSFLGS                                                 00951000
$TWOCHSW EQU   $CDSFLGS                                                 00952000
$SYMNAME EQU   $CDSFLGS                                                 00953000
$EXTINTC EQU   $CDSFLGS                                                 00954000
$CEVOL   EQU   $CDSFLGS                                                 00955000
$SHARED  EQU   $CDSFLGS                                                 00956000
$FPM     EQU   $CDSFLGS                                                 00957000
$LASTSUB EQU   $PDEVFLG                                                 00958000
@NM00010 EQU   $PDEVFLG                                                 00959000
@NM00009 EQU   $PDEVFLG                                                 00960000
@NM00008 EQU   $PDEVFLG                                                 00961000
$LASTDEV EQU   $PDEVFLG                                                 00962000
@NM00007 EQU   $PDEVFLG                                                 00963000
$EXFILPT EQU   $PDEVFLG                                                 00964000
$FPMOLD  EQU   $PDEVFLG                                                 00965000
$TSSSYM  EQU   $SCTTBLE+8                                               00966000
$SCTLEVL EQU   $SCTTBLE+7                                               00967000
$DRIVER  EQU   $SCTTBLE+6                                               00968000
$RT0916  EQU   $SCTTBLE+5                                               00969000
$RT0108  EQU   $SCTTBLE+4                                               00970000
$LOOPTST EQU   $ERROPT                                                  00971000
$LOOPERR EQU   $ERROPT                                                  00972000
$NERRPRT EQU   $ERROPT                                                  00973000
$NOCNTRL EQU   $ERROPT                                                  00974000
$ALTPRNT EQU   $ERROPT                                                  00975000
$CATERR  EQU   $ERROPT                                                  00976000
$ASTERIK EQU   $ERROPT                                                  00977000
$TESTERR EQU   $ERROPT                                                  00978000
$FSTCOMM EQU   $TESTOPT                                                 00979000
$INDEFLP EQU   $TESTOPT                                                 00980000
$NOPRT   EQU   $TESTOPT                                                 00981000
$PARAPRT EQU   $TESTOPT                                                 00982000
@NM00006 EQU   $TESTOPT                                                 00983000
$ERRLPCT EQU   $SCTTBLE                                                 00984000
$TLTEND  EQU   $RCAAREA+945                                             00985000
$CNSLID  EQU   $RCAAREA+936                                             00986000
$EXITSAV EQU   $RCAAREA+864                                             00987000
$TRASCII EQU   $RCAAREA+608                                             00988000
@NM00005 EQU   $RCAAREA+605                                             00989000
$VTAMEND EQU   $RCAFLG                                                  00990000
$TPPOSTD EQU   $RCAFLG                                                  00991000
$NEWCT   EQU   $RCAFLG                                                  00992000
$ABNDALL EQU   $RCAFLG                                                  00993000
$CUTESTB EQU   $RCAFLG                                                  00994000
$CONSOLE EQU   $RCAFLG                                                  00995000
$TPLOGON EQU   $RCAFLG                                                  00996000
$UPDATE  EQU   $RCAFLG                                                  00997000
$DEVAREA EQU   $RCAAREA+600                                             00998000
$CTDVAR  EQU   $RCAAREA+596                                             00999000
$BUFFS   EQU   $RCAAREA+464                                             01000000
$TLTNIB  EQU   $CONSTNT+140                                             01001000
$TLTPRPL EQU   $CONSTNT+20                                              01002000
@NM00004 EQU   $CONSTNT+4                                               01003000
@NM00003 EQU   $CONSTNT+2                                               01004000
$USECNT  EQU   $CONSTNT                                                 01005000
$CURRTWA EQU   $POINTER+140                                             01006000
$CTNAME  EQU   $POINTER+132                                             01007000
$CTARGX  EQU   $POINTER+128                                             01008000
$COMINT  EQU   $POINTER+120                                             01009000
$QUEHNDL EQU   $POINTER+116                                             01010000
@NM00002 EQU   $POINTER+36                                              01011000
$RTNPTR  EQU   $POINTER+32                                              01012000
$TLTECB2 EQU   $POINTER+28                                              01013000
$TLTECB1 EQU   $POINTER+24                                              01014000
$CLEANP  EQU   $POINTER+20                                              01015000
$ABEND   EQU   $POINTER+16                                              01016000
$LSTAREA EQU   $POINTER+12                                              01017000
$FSTAREA EQU   $POINTER+8                                               01018000
$CVTSAVE EQU   $POINTER+4                                               01019000
$TOLTEP  EQU   $POINTER                                                 01020000
$TLTACB  EQU   $RCAAREA                                                 01021000
.@UNREFD ANOP                          END UNREFERENCED COMPONENTS      01022000
@RT00058 EQU   I007C01A                                                 01023000
@RT00068 EQU   I007C01B                                                 01024000
@RT00075 EQU   I007C01C                                                 01025000
@RT00082 EQU   I007C03                                                  01026000
@ENDDATA EQU   *                                                        01027000
         END   ISTIC007,(C'PLS0851',0702,78337)                         01028000
./  ADD  SSI=90331591,NAME=ISTIC008
         TITLE 'ISTIC008,ADD - ADDS A NEW CDS TO LIBRARY'               00001000
ISTIC008 CSECT ,                                                   0001 00002000
@MAINENT DS    0H                                                  0001 00003000
         USING *,@15                                               0001 00004000
         B     @PROLOG                                             0001 00005000
         DC    AL1(16)                                             0001 00006000
         DC    C'ISTIC008  79.034'                                 0001 00007000
         DROP  @15                                                      00008000
@PROLOG  ST    @14,12(,@13)                                        0001 00009000
         STM   @00,@12,20(@13)                                     0001 00010000
         BALR  @11,0                                               0001 00011000
@PSTART  DS    0H                                                  0001 00012000
         USING @PSTART,@11                                         0001 00013000
         ST    @13,@SA00001+4                                      0001 00014000
         LA    @12,@SA00001                                        0001 00015000
         ST    @12,8(,@13)                                         0001 00016000
         LR    @13,@12                                             0001 00017000
         EJECT                                                          00018000
OPENFLAG EQU  48                                                        00019000
GOODOPEN EQU  16                                                        00020000
         EJECT                                                          00021000
I008C01  DS    0H                                                  0069 00022000
*   I008CWK=$LOWADDR;               /* SET UP BASE FOR WK AREA       */ 00023000
         L     @15,$LOWADDR(,WAPTR)                                0069 00024000
         ST    @15,I008CWK                                         0069 00025000
*   CDSWKPTR=I008CWK+80;            /* SET UP BASE FOR CDS WK AREA   */ 00026000
         AH    @15,@CH00078                                        0070 00027000
         ST    @15,CDSWKPTR                                        0070 00028000
*   IF $REMSW='1'B                  /* IF THIS IS A REMOTE REQ       */ 00029000
*     THEN                                                         0071 00030000
         TM    $REMSW(WAPTR),B'01000000'                           0071 00031000
         BNO   @RF00071                                            0071 00032000
*     DO;                                                          0072 00033000
*       CDSSYMB='1'B;               /* TURN ON SYMBOLIC NAME BIT     */ 00034000
*       CDSREMSY='1'B;              /* TURN ON REMOTE FLAG           */ 00035000
         OI    CDSSYMB(@15),B'00001010'                            0074 00036000
*     END;                                                         0075 00037000
*   ELSE                                                           0076 00038000
*     DO;                                                          0076 00039000
         B     @RC00071                                            0076 00040000
@RF00071 DS    0H                                                  0077 00041000
*       CDSSYMBN(1:8)=''B;          /* ZERO OUT SYMBOLIC NME AREA  0077 00042000
*                                                            @ZA35829*/ 00043000
         L     @15,CDSWKPTR                                        0077 00044000
         XC    CDSSYMBN(8,@15),CDSSYMBN(@15)                       0077 00045000
*     END;                                                         0078 00046000
*I008C01A:                                                         0079 00047000
*   DCL                                                            0079 00048000
*     1 ZZZGTPRM BDY(WORD),         /* GETCONFG PARAMETER LIST       */ 00049000
*      2 * CHAR(4) INIT('0102F1F6'X),                              0079 00050000
*      2 ZZZGTCD PTR,               /* POINTER TO BASIC CDS INFO     */ 00051000
*      2 ZZZGTAD PTR,               /* POINTER TO RECEIVING BUFFER   */ 00052000
*      2 ZZZGTCT FIXED(8);          /* NUMBER OF CDS BYTES NEEDED    */ 00053000
@RC00071 DS    0H                                                  0079 00054000
I008C01A DS    0H                                                  0080 00055000
*   ZZZGTAD=ADDR(CDSUA);            /* POINTER TO RECEIVING BUFFER   */ 00056000
         L     @15,CDSWKPTR                                        0080 00057000
         ST    @15,ZZZGTAD                                         0080 00058000
*   ZZZGTCD=ADDR(CDSUA);            /* POINTER TO BASIC CDS INFO     */ 00059000
         ST    @15,ZZZGTCD                                         0081 00060000
*   ZZZGTCT=20;                     /* NUMBER OF BYTES NEEDED        */ 00061000
         MVI   ZZZGTCT,X'14'                                       0082 00062000
*   R1=ADDR(ZZZGTPRM);              /* POINT TO THE PARM LIST        */ 00063000
         LA    R1,ZZZGTPRM                                         0083 00064000
*   CALL ISTSC029;                  /* CALL THE GETCONFG FUNCTION    */ 00065000
         L     @15,@CV00791                                        0084 00066000
         BALR  @14,@15                                             0084 00067000
*   IF R15=12 THEN                  /* IF NAME DOES NOT EXIST        */ 00068000
         CH    R15,@CH00237                                        0085 00069000
         BE    @RT00085                                            0085 00070000
*     GOTO I008C01B;                /* THEN ADD T                    */ 00071000
*                                                                  0086 00072000
*   /*****************************************************************/ 00073000
*   /*                                                               */ 00074000
*   /* TCEC MSGN(576)MSGMSK('80000000'X) INVOKED                     */ 00075000
*   /*                                                               */ 00076000
*   /*****************************************************************/ 00077000
*                                                                  0087 00078000
*   $TCECM='1'B;                    /* SET TCEC SW IN RCA            */ 00079000
         OI    $TCECM(WAPTR),B'00000001'                           0087 00080000
*   R1=ADDR($TCA10);                /* SET UP PARM LIST $TR          */ 00081000
         LA    R1,$TCA10                                           0088 00082000
*   CALL S20CEC03;                  /* CALL TCEC-MULTIPLE LN         */ 00083000
         L     @15,@CV00794                                        0089 00084000
         BALR  @14,@15                                             0089 00085000
*   DCL                                                            0090 00086000
*     1 $TCA10,                     /* TCEC PARM LIST                */ 00087000
*      2 $TCB10 FIXED(32) INIT(576),/* MSG NUMBER                    */ 00088000
*      2 $TCC10 FIXED(32) INIT(0),  /* INCT LEN                      */ 00089000
*      2 $TCD10 BIT(8) INIT('00000000'B),/* FLAG                     */ 00090000
*      2 $TCE10 CHAR(4) INIT('80000000'X);/* MSSAGE MASK CDS ALREADY    00091000
*                                      EXISTS                        */ 00092000
*   GOTO I008CRET;                  /* RETURN TO CONTROL MODULE      */ 00093000
         B     I008CRET                                            0091 00094000
*I008C01B:                                                         0092 00095000
*   R1=ADDR(CDSEXARA);              /* PTR TO EXTRA CDS AREA         */ 00096000
I008C01B L     @15,CDSWKPTR                                        0092 00097000
         LA    R1,CDSEXARA(,@15)                                   0092 00098000
*   R5=ADDR(CDSMODEL);              /* PTR TO MODEL FLD              */ 00099000
         LA    R5,CDSMODEL(,@15)                                   0093 00100000
*   GEN;                                                           0094 00101000
*                                       /*                              00102000
         XC    0(8,R5),0(R5)              ZERO M,F,C,T,BC, + FLG FLD    00103000
         XC    0(235,R1),0(R1)            ZERO OUT CDS AREA          */ 00104000
*I008C02:                                                          0095 00105000
*   CALL ISTIC00A;                  /* GO CONFIGURE DATA SET         */ 00106000
I008C02  L     @15,@CV00805                                        0095 00107000
         BALR  @14,@15                                             0095 00108000
*   IF $REMSW='1'B                  /* IF THIS IS A REMOTE REQUEST   */ 00109000
*     THEN                                                         0096 00110000
         TM    $REMSW(WAPTR),B'01000000'                           0096 00111000
         BNO   @RF00096                                            0096 00112000
*     DO;                           /* IF THE SYMBOLIC BIT ANDTHE    */ 00113000
*                                                                  0097 00114000
*       /*************************************************************/ 00115000
*       /*                                                           */ 00116000
*       /* IF CDSSYMB='1'B & CDSREMSY='1'B &                         */ 00117000
*       /* CDSSYMBN(1:1)¬=BLANK@ZA35683 THEN GOTO I008C03; REMOTE BIT*/ 00118000
*       /* ARE ON ITS OK                                     @ZA35683*/ 00119000
*       /* AND THERE IS A SYMBOLIC NME                       @ZA35683*/ 00120000
*       /* GOTO I008C02A; OTHERWISE ITS AN ERROR             @ZA35683*/ 00121000
*       /*                                                           */ 00122000
*       /*************************************************************/ 00123000
*                                                                  0098 00124000
*       CDSSYMB='1'B;               /* SYMBOLIC NAME PROVIDED      0098 00125000
*                                                            @ZA35683*/ 00126000
*       CDSREMSY='1'B;              /* INDICATE ITS A REMOTE @ZA35683*/ 00127000
         L     @15,CDSWKPTR                                        0099 00128000
         OI    CDSSYMB(@15),B'00001010'                            0099 00129000
*     END;                                                         0100 00130000
*                                                                  0100 00131000
*   /*****************************************************************/ 00132000
*   /*                                                               */ 00133000
*   /* ELSE IF ITS NOT A REMOTE REQUEST@ZA35683 DO; AND THE SYMBOLIC */ 00134000
*   /* BIT IS ON                                             @ZA35683*/ 00135000
*   /* IF CDSSYMB='1'B AND THERE IS A SYMBOLIC NME@ZA35683 THEN      */ 00136000
*   /*                                                       @ZA35683*/ 00137000
*   /* DO;                                                   @ZA35683*/ 00138000
*   /* IF CDSSYMBN¬=BLANK THEN                               @ZA35683*/ 00139000
*   /* GOTO I008C03; IT OK-CONTINUE                          @ZA35683*/ 00140000
*   /* GOTO I008C02A; INVALID SYM NME OF FLAG                @ZA35683*/ 00141000
*   /* END;                                                  @ZA35683*/ 00142000
*   /* ELSE IF SYMBOLIC BIT IS OFF                           @ZA35683*/ 00143000
*   /*                                                               */ 00144000
*   /*****************************************************************/ 00145000
*                                                                  0101 00146000
*   GOTO I008C03;                   /* OK-CONTINUE ON                */ 00147000
*                                                                  0101 00148000
         B     I008C03                                             0101 00149000
*   /*****************************************************************/ 00150000
*   /*                                                               */ 00151000
*   /* END;                                                  @ZA35683*/ 00152000
*   /*                                                               */ 00153000
*   /*****************************************************************/ 00154000
*                                                                  0102 00155000
*I008C02A:                                                         0102 00156000
*                                                                  0102 00157000
*   /*****************************************************************/ 00158000
*   /*                                                               */ 00159000
*   /* TCEC MSGN(581)MSGMSK('00400000'X) INVOKED                     */ 00160000
*   /*                                                               */ 00161000
*   /*****************************************************************/ 00162000
*                                                                  0102 00163000
*   $TCECM='1'B;                    /* SET TCEC SW IN RCA            */ 00164000
I008C02A OI    $TCECM(WAPTR),B'00000001'                           0102 00165000
*   R1=ADDR($TCA11);                /* SET UP PARM LIST $TR          */ 00166000
         LA    R1,$TCA11                                           0103 00167000
*   CALL S20CEC03;                  /* CALL TCEC-MULTIPLE LN         */ 00168000
         L     @15,@CV00794                                        0104 00169000
         BALR  @14,@15                                             0104 00170000
*   DCL                                                            0105 00171000
*     1 $TCA11,                     /* TCEC PARM LIST                */ 00172000
*      2 $TCB11 FIXED(32) INIT(581),/* MSG NUMBER                    */ 00173000
*      2 $TCC11 FIXED(32) INIT(0),  /* INCT LEN                      */ 00174000
*      2 $TCD11 BIT(8) INIT('00000000'B),/* FLAG                     */ 00175000
*      2 $TCE11 CHAR(4) INIT('00400000'X);/* MSSAGE MASK INV SYM NME    00176000
*                                      OR FLAG                       */ 00177000
*   GOTO I008C02;                   /* GO RE-CONFIGURE               */ 00178000
         B     I008C02                                             0106 00179000
*I008C03:                                                          0107 00180000
*   IF $REMSW¬='1'B THEN            /* IF THIS IS NOT A REMOTE REQ   */ 00181000
I008C03  TM    $REMSW(WAPTR),B'01000000'                           0107 00182000
         BO    @RF00107                                            0107 00183000
*     UASW='1'B;                    /* THEN TURN ON UNIT ADDR SW     */ 00184000
         L     @15,I008CWK                                         0108 00185000
         OI    UASW(@15),B'00001000'                               0108 00186000
*   IF CLASSSW='1'B&TYPESW='1'B&FLAGSW='1'B&UASW='1'B THEN/* IF ALL     00187000
*                                      THE REQ SW ARE                */ 00188000
@RF00107 L     @15,I008CWK                                         0109 00189000
         TM    CLASSSW(@15),B'01111000'                            0109 00190000
         BNO   @RF00109                                            0109 00191000
*     DO;                           /* SET THEN DO THE FOLLOWING     */ 00192000
*       CLASSSW='0'B;               /* RESET CLASS REQUIRED SW       */ 00193000
*       TYPESW='0'B;                /* RESET TYPE REQUIRED SW        */ 00194000
*       FLAGSW='0'B;                /* RESET FLAG REQUIRED SW        */ 00195000
*       UASW='0'B;                  /* RESET UNIT ADR REQUIRED SW    */ 00196000
         NI    CLASSSW(@15),B'10000111'                            0114 00197000
*     END;                                                         0115 00198000
*   ELSE                            /* OTHERWISE PRINT               */ 00199000
*     DO;                           /* ERROR MSG                     */ 00200000
*                                                                  0116 00201000
         B     @RC00109                                            0116 00202000
@RF00109 DS    0H                                                  0117 00203000
*       /*************************************************************/ 00204000
*       /*                                                           */ 00205000
*       /* TCEC MSGN(581)MSGMSK('00200000'X) INVOKED                 */ 00206000
*       /*                                                           */ 00207000
*       /*************************************************************/ 00208000
*                                                                  0117 00209000
*       $TCECM='1'B;                /* SET TCEC SW IN RCA            */ 00210000
         OI    $TCECM(WAPTR),B'00000001'                           0117 00211000
*       R1=ADDR($TCA12);            /* SET UP PARM LIST $TR          */ 00212000
         LA    R1,$TCA12                                           0118 00213000
*       CALL S20CEC03;              /* CALL TCEC-MULTIPLE LN         */ 00214000
         L     @15,@CV00794                                        0119 00215000
         BALR  @14,@15                                             0119 00216000
*       DCL                                                        0120 00217000
*         1 $TCA12,                 /* TCEC PARM LIST                */ 00218000
*          2 $TCB12 FIXED(32) INIT(581),/* MSG NUMBER                */ 00219000
*          2 $TCC12 FIXED(32) INIT(0),/* INCT LEN                    */ 00220000
*          2 $TCD12 BIT(8) INIT('00000000'B),/* FLAG                 */ 00221000
*          2 $TCE12 CHAR(4) INIT('00200000'X);/* MSSAGE MASK INVALID    00222000
*                                      REQ FLD                       */ 00223000
*       GOTO I008C02;               /* RE-CONFIGURE REQ FLD ONLY     */ 00224000
         B     I008C02                                             0121 00225000
*     END;                                                         0122 00226000
*   IF $REMSW='1'B THEN             /* IF REMOTE REQUEST THEN GO     */ 00227000
@RC00109 TM    $REMSW(WAPTR),B'01000000'                           0123 00228000
         BO    @RT00123                                            0123 00229000
*     GOTO I008CADR;                /* ADD REMOTE DATA SET TO PDS    */ 00230000
*   GOTO I008CADL;                  /* OTHERWISE ADD LOCAL TO PDS    */ 00231000
         B     I008CADL                                            0125 00232000
*   GEN(EJECT);                                                    0126 00233000
*                                                                  0126 00234000
         EJECT                                                          00235000
*/********************************************************************/ 00236000
*/*                                                                  */ 00237000
*/* A D D  R E M O T E  C D S  T O  P D S                            */ 00238000
*/*                                                                  */ 00239000
*/********************************************************************/ 00240000
*                                                                  0127 00241000
*I008CADR:                                                         0127 00242000
*   GEN;                                                           0127 00243000
I008CADR DS    0H                                                  0127 00244000
*                                       /*                              00245000
         OPEN  (REMCDS,(OUTPUT))          OPEN REMOTE DATA SET          00246000
         LA    WKREG1,REMCDS              SET UP BASE                   00247000
         TM    OPENFLAG(WKREG1),GOODOPEN  WAS OPEN OK                   00248000
         BZ    I008CER1                   NO-BR + PRT OPEN ERROR     */ 00249000
*   ESDNME1=CDSSYMBN;               /* MOVE NAME TO CDS ESD REC      */ 00250000
         L     @15,CDSWKPTR                                        0128 00251000
         MVC   ESDNME1(8),CDSSYMBN(@15)                            0128 00252000
*   DCBPTR=ADDR(REMCDS);            /* SET UP DCB POINTER            */ 00253000
         LA    DCBPTR,REMCDS                                       0129 00254000
*   GEN(BAL LINKR,I008CWRT);        /* GO WRITE MEMBER               */ 00255000
         BAL LINKR,I008CWRT                                             00256000
*   STOWNAME=CDSSYMBN;              /* MOVE NAME TO DIRECTY ENTRY    */ 00257000
         L     @15,CDSWKPTR                                        0131 00258000
         MVC   STOWNAME(8),CDSSYMBN(@15)                           0131 00259000
*   STOWTTR=TTRZSAVE(1:3);          /* PUT TTR OF MEMBER IN DIRCTY   */ 00260000
         MVC   STOWTTR(3),TTRZSAVE                                 0132 00261000
*   GEN;                                                           0133 00262000
*                                       /*                              00263000
         STOW  REMCDS,STOWCON,R           WRITE DIRECTORY ENTRY      */ 00264000
*   GOTO I008CKRC;                  /* GO CHECK RETURN CODES         */ 00265000
         B     I008CKRC                                            0134 00266000
*   GEN(EJECT);                                                    0135 00267000
         EJECT                                                          00268000
*                                                                  0136 00269000
*/********************************************************************/ 00270000
*/*                                                                  */ 00271000
*/* A D D  L O C A L  C D S  T O  P D S                              */ 00272000
*/*                                                                  */ 00273000
*/********************************************************************/ 00274000
*                                                                  0136 00275000
*I008CADL:                                                         0136 00276000
*   GEN;                                                           0136 00277000
I008CADL DS    0H                                                  0136 00278000
*                                       /*                              00279000
         OPEN  (LOCCDS,(OUTPUT))          OPEN LOCAL DATA SET           00280000
         LA    WKREG1,LOCCDS              SET UP BASE                   00281000
         TM    OPENFLAG(WKREG1),GOODOPEN  WAS OPEN OK                   00282000
         BZ    I008CE1A                   NO-BR + PRT OPEN ERROR     */ 00283000
*   DCBPTR=ADDR(LOCCDS);            /* SET UP PTR TO DCB CONVERT UNIT   00284000
*                                      ADDR TO EBCDIC                */ 00285000
*                                                                  0137 00286000
         LA    DCBPTR,LOCCDS                                       0137 00287000
*   /*****************************************************************/ 00288000
*   /*                                                               */ 00289000
*   /* ITACONV FROM(CDSUA)TO(WKAREA)COUNT(4)TYPE(HE) INVOKED         */ 00290000
*   /*                                                               */ 00291000
*   /*****************************************************************/ 00292000
*                                                                  0138 00293000
*   DCL                                                            0138 00294000
*     1 ITATCPRM BDY(WORD),         /* CONVERT PARAMETER LIST        */ 00295000
*      2 * CHAR(4) INIT('0102F4F1'X),                              0138 00296000
*      2 ITATCFR PTR,               /* ADDRESS OF FROM FIELD         */ 00297000
*      2 ITATCTO PTR,               /* ADDRESS OF TO FIELD           */ 00298000
*      2 * BIT(8) INIT(0),          /* FLAGS FOR CONVERT MODULE      */ 00299000
*       3 ITATCTP BIT(1),           /* TYPE OF CONVERT REQUIRED      */ 00300000
*      2 ITATCNT FIXED(8);          /* NUMBER OF BYTES TO CONVERT    */ 00301000
*   ITATCFR=ADDR(CDSUA);            /* SET THE FROM ADDRESS          */ 00302000
         MVC   ITATCFR(4),CDSWKPTR                                 0139 00303000
*   ITATCTO=ADDR(WKAREA);           /* SET THE TO ADDRESS            */ 00304000
         LA    @15,WKAREA                                          0140 00305000
         ST    @15,ITATCTO                                         0140 00306000
*   ITATCTP='1'B;                   /* SET THE TYPE OF CONVERT BIT   */ 00307000
         OI    ITATCTP,B'10000000'                                 0141 00308000
*   ITATCNT=4;                      /* GIVE THE CONVERT BYTE COUNT   */ 00309000
         MVI   ITATCNT,X'04'                                       0142 00310000
*   R1=ADDR(ITATCPRM);              /* POINT TO CONVERT PARM LIST    */ 00311000
         LA    R1,ITATCPRM                                         0143 00312000
*   CALL ISTSC021;                  /* CALL CONVERT DIRECTLY         */ 00313000
         L     @15,@CV00838                                        0144 00314000
         BALR  @14,@15                                             0144 00315000
*   GEN(MVC   WKAREA(1),UANAME);    /* BUILD UNIT ADDR NAME          */ 00316000
         MVC   WKAREA(1),UANAME                                         00317000
*   ESDNME1=WKAREA;                 /* SET UP ESD NAME               */ 00318000
         MVC   ESDNME1(8),WKAREA                                   0146 00319000
*   GEN(BAL LINKR,I008CWRT);        /* GO WRT MEMBER                 */ 00320000
         BAL LINKR,I008CWRT                                             00321000
*   STOWNAME=WKAREA;                /* MOVE NAME TO DIRCTY ENTRY     */ 00322000
         MVC   STOWNAME(8),WKAREA                                  0148 00323000
*   STOWTTR=TTRZSAVE(1:3);          /* PUT TTR OF MEMBER IN DIRCTY   */ 00324000
         MVC   STOWTTR(3),TTRZSAVE                                 0149 00325000
*   GEN;                                                           0150 00326000
*                                       /*                              00327000
         STOW  LOCCDS,STOWCON,R           WRITE DIRECTORY ENTRY      */ 00328000
*   GOTO I008CKRC;                  /* GO CHECK RETURN CODES         */ 00329000
         B     I008CKRC                                            0151 00330000
*   GEN(EJECT);                                                    0152 00331000
         EJECT                                                          00332000
*I008CKRC:                                                         0153 00333000
*   IF R15=12 THEN                  /* IF RET CODE EQUAL 12 THEN     */ 00334000
I008CKRC LA    @12,12                                              0153 00335000
         CR    R15,@12                                             0153 00336000
         BE    @RT00153                                            0153 00337000
*     GOTO I008CER2;                /* GO PRINT ERROR -NO SPACE      */ 00338000
*   IF R15>12 THEN                  /* IF RET CODE IS GREATER 12     */ 00339000
         CR    R15,@12                                             0155 00340000
         BH    @RT00155                                            0155 00341000
*     GOTO I008CER3;                /* THEN GO PRT I/O ERROR         */ 00342000
*                                                                  0156 00343000
*   /*****************************************************************/ 00344000
*   /*                                                               */ 00345000
*   /* TCEC MSGN(562) INVOKED                                        */ 00346000
*   /*                                                               */ 00347000
*   /*****************************************************************/ 00348000
*                                                                  0157 00349000
*   $TCECM='1'B;                    /* SET TCEC SW IN RCA            */ 00350000
         OI    $TCECM(WAPTR),B'00000001'                           0157 00351000
*   R1=ADDR($TCA14);                /* SET UP PARM LIST $TR          */ 00352000
         LA    R1,$TCA14                                           0158 00353000
*   CALL #EXIT;                     /* CALL CECOM                    */ 00354000
         L     @15,#EXITA(,WAPTR)                                  0159 00355000
         BALR  @14,@15                                             0159 00356000
*   DCL                                                            0160 00357000
*     1 $TCA14,                     /* TCEC PARM LIST                */ 00358000
*      2 $TCB14 FIXED(32) INIT(562),/* MSG NUMBER                    */ 00359000
*      2 $TCC14 FIXED(32) INIT(0),  /* INCT LEN                      */ 00360000
*      2 $TCD14 BIT(8) INIT('00000000'B),/* FLAG                     */ 00361000
*      2 $TCE14 CHAR(4) INIT('FFFFFFFF'X);/* MSSAGE MASK CDS ADDED TO   00362000
*                                      LIBRARY                       */ 00363000
*   GOTO I008CRET;                  /* RETURN TO CONTROL MODULE      */ 00364000
         B     I008CRET                                            0161 00365000
*   GEN(EJECT);                                                    0162 00366000
         EJECT                                                          00367000
*I008CER1:                                                         0163 00368000
*   $INBUFR=CDSSYMBN;               /* SET UP SYMBOLIC NAME          */ 00369000
I008CER1 MVI   $INBUFR+8(WAPTR),C' '                               0163 00370000
         MVC   $INBUFR+9(71,WAPTR),$INBUFR+8(WAPTR)                0163 00371000
         L     @15,CDSWKPTR                                        0163 00372000
         MVC   $INBUFR(8,WAPTR),CDSSYMBN(@15)                      0163 00373000
*   GOTO I008CE1B;                                                 0164 00374000
         B     I008CE1B                                            0164 00375000
*I008CE1A:                                                         0165 00376000
*   $INBUFR=CDSLOCDD;               /* SET UP LOC DCB NAME           */ 00377000
I008CE1A MVI   $INBUFR+8(WAPTR),C' '                               0165 00378000
         MVC   $INBUFR+9(71,WAPTR),$INBUFR+8(WAPTR)                0165 00379000
         MVC   $INBUFR(8,WAPTR),CDSLOCDD                           0165 00380000
*I008CE1B:                                                         0166 00381000
*                                                                  0166 00382000
*   /*****************************************************************/ 00383000
*   /*                                                               */ 00384000
*   /* TCEC MSGN(901)SUB(YES) INVOKED                                */ 00385000
*   /*                                                               */ 00386000
*   /*****************************************************************/ 00387000
*                                                                  0166 00388000
*   $TCECM='1'B;                    /* SET TCEC SW IN RCA            */ 00389000
I008CE1B OI    $TCECM(WAPTR),B'00000001'                           0166 00390000
*   R1=ADDR($TCA15);                /* SET UP PARM LIST $TR          */ 00391000
         LA    R1,$TCA15                                           0167 00392000
*   CALL #EXIT;                     /* CALL CECOM                    */ 00393000
         L     @15,#EXITA(,WAPTR)                                  0168 00394000
         BALR  @14,@15                                             0168 00395000
*   DCL                                                            0169 00396000
*     1 $TCA15,                     /* TCEC PARM LIST                */ 00397000
*      2 $TCB15 FIXED(32) INIT(901),/* MSG NUMBER                    */ 00398000
*      2 $TCC15 FIXED(32) INIT(0),  /* INCT LEN                      */ 00399000
*      2 $TCD15 BIT(8) INIT('10000000'B),/* FLAG                     */ 00400000
*      2 $TCE15 CHAR(4) INIT('FFFFFFFF'X);/* MSSAGE MASK XXXXX DD  0169 00401000
*                                      FAILED TO OPEN                */ 00402000
*   GOTO I008CRET;                  /* RETURN TO CALLER              */ 00403000
         B     I008CRET                                            0170 00404000
*I008CER2:                                                         0171 00405000
*                                                                  0171 00406000
*   /*****************************************************************/ 00407000
*   /*                                                               */ 00408000
*   /* TCEC MSGN(571) INVOKED                                        */ 00409000
*   /*                                                               */ 00410000
*   /*****************************************************************/ 00411000
*                                                                  0171 00412000
*   $TCECM='1'B;                    /* SET TCEC SW IN RCA            */ 00413000
I008CER2 OI    $TCECM(WAPTR),B'00000001'                           0171 00414000
*   R1=ADDR($TCA16);                /* SET UP PARM LIST $TR          */ 00415000
         LA    R1,$TCA16                                           0172 00416000
*   CALL #EXIT;                     /* CALL CECOM                    */ 00417000
         L     @15,#EXITA(,WAPTR)                                  0173 00418000
         BALR  @14,@15                                             0173 00419000
*   DCL                                                            0174 00420000
*     1 $TCA16,                     /* TCEC PARM LIST                */ 00421000
*      2 $TCB16 FIXED(32) INIT(571),/* MSG NUMBER                    */ 00422000
*      2 $TCC16 FIXED(32) INIT(0),  /* INCT LEN                      */ 00423000
*      2 $TCD16 BIT(8) INIT('00000000'B),/* FLAG                     */ 00424000
*      2 $TCE16 CHAR(4) INIT('FFFFFFFF'X);/* MSSAGE MASK LIBRARY FULL*/ 00425000
*   GOTO I008CRET;                                                 0175 00426000
         B     I008CRET                                            0175 00427000
*I008CER3:                                                         0176 00428000
*                                                                  0176 00429000
*   /*****************************************************************/ 00430000
*   /*                                                               */ 00431000
*   /* TCEC MSGN(570) INVOKED                                        */ 00432000
*   /*                                                               */ 00433000
*   /*****************************************************************/ 00434000
*                                                                  0176 00435000
*   $TCECM='1'B;                    /* SET TCEC SW IN RCA            */ 00436000
I008CER3 OI    $TCECM(WAPTR),B'00000001'                           0176 00437000
*   R1=ADDR($TCA17);                /* SET UP PARM LIST $TR          */ 00438000
         LA    R1,$TCA17                                           0177 00439000
*   CALL #EXIT;                     /* CALL CECOM                    */ 00440000
         L     @15,#EXITA(,WAPTR)                                  0178 00441000
         BALR  @14,@15                                             0178 00442000
*   DCL                                                            0179 00443000
*     1 $TCA17,                     /* TCEC PARM LIST                */ 00444000
*      2 $TCB17 FIXED(32) INIT(570),/* MSG NUMBER                    */ 00445000
*      2 $TCC17 FIXED(32) INIT(0),  /* INCT LEN                      */ 00446000
*      2 $TCD17 BIT(8) INIT('00000000'B),/* FLAG                     */ 00447000
*      2 $TCE17 CHAR(4) INIT('FFFFFFFF'X);/* MSSAGE MASK I/O ERROR   */ 00448000
*   GOTO I008CRET;                  /* GO RETURN TO CALLER           */ 00449000
         B     I008CRET                                            0180 00450000
*   GEN(EJECT);                                                    0181 00451000
         EJECT                                                          00452000
*I008CRET:                                                         0182 00453000
*   GEN;                                                           0182 00454000
I008CRET DS    0H                                                  0182 00455000
*                                       /*                              00456000
         CLOSE REMCDS                     CLOSE REMOTE CDS              00457000
         CLOSE LOCCDS                     CLOSE LOCAL CDS            */ 00458000
*   I008CSW='0'X;                   /* ZERO OUT INTERNAL SW          */ 00459000
         L     @15,I008CWK                                         0183 00460000
         MVI   I008CSW(@15),X'00'                                  0183 00461000
*   $REMSW='0'B;                    /* RESET REMOTE SWITCH           */ 00462000
         NI    $REMSW(WAPTR),B'10111111'                           0184 00463000
*   RETURN;                         /* RETURN TO CONTROL MODULE      */ 00464000
@EL00001 L     @13,4(,@13)                                         0185 00465000
@EF00001 DS    0H                                                  0185 00466000
@ER00001 L     @14,12(,@13)                                        0185 00467000
         LM    @00,@12,20(@13)                                     0185 00468000
         BR    @14                                                 0185 00469000
*   GEN(EJECT);                                                    0186 00470000
*                                                                  0186 00471000
         EJECT                                                          00472000
*/********************************************************************/ 00473000
*/*                      W R I T E  R O U T I N E                    */ 00474000
*/*                                                                  */ 00475000
*/*  THIS ROUTINE WILL WRITE THE ESD RECORD, TXTHDR RECORD, CDS      */ 00476000
*/*   RECORD AND THE END RECORD                                      */ 00477000
*/*                                                                  */ 00478000
*/********************************************************************/ 00479000
*                                                                  0187 00480000
*I008CWRT:                                                         0187 00481000
*   RETSAV=LINKR;                   /* SAVE RETURN ADDR PTR          */ 00482000
I008CWRT ST    LINKR,RETSAV                                        0187 00483000
*   ESDSIZE=CDSBYTCT;               /* PUT CDS BYTE COUNT IN ESD     */ 00484000
         L     @15,CDSWKPTR                                        0188 00485000
         SLR   @12,@12                                             0188 00486000
         IC    @12,CDSBYTCT(,@15)                                  0188 00487000
         STC   @12,ESDSIZE                                         0188 00488000
*   TXTHCNT(3:3)=CDSBYTCT;          /* PUT CDS BYTE CNT IN TXTHDR    */ 00489000
         STC   @12,TXTHCNT+2                                       0189 00490000
*   CDSRECL=CDSBYTCT;               /* SET UP CDSREC LEN FOR WRITE   */ 00491000
         STH   @12,CDSRECL                                         0190 00492000
*   IF $REMSW='1'B                  /* IF THIS A REMOTE ADD          */ 00493000
*     THEN                          /* THEN SET UP REMOTE ID         */ 00494000
         TM    $REMSW(WAPTR),B'01000000'                           0191 00495000
         BNO   @RF00191                                            0191 00496000
*     DO;                           /* IN THE #CTL ID                */ 00497000
*       ESDNME3(5:5)=REMOTEID;                                     0193 00498000
         MVC   ESDNME3+4(1),REMOTEID                               0193 00499000
*     END;                                                         0194 00500000
*   ELSE                            /* OTHERWISE SET UP A LOCAL      */ 00501000
*     DO;                           /* ID IN #CTL ID                 */ 00502000
         B     @RC00191                                            0195 00503000
@RF00191 DS    0H                                                  0196 00504000
*       ESDNME3(5:5)=LOCALID;                                      0196 00505000
         MVC   ESDNME3+4(1),LOCALID                                0196 00506000
*     END;                                                         0197 00507000
*   GEN;                                                           0198 00508000
@RC00191 DS    0H                                                  0198 00509000
*                                       /*                              00510000
         WRITE CDSDECB,SF,(DCBPTR),ESDREC,80,MF=E  WRITE ESD RECORD     00511000
         CHECK CDSDECB                    WAIT FOR I/O COMPLETION       00512000
         NOTE  (DCBPTR)                   SAVE BEGINNING ADDRESS IN     00513000
         ST    PARMREG1,TTRZSAVE          CASE OF AN ERROR              00514000
         WRITE CDSDECB,SF,(DCBPTR),TXTHDR,80,MF=E  WRITE TXTHDR RECORD  00515000
         CHECK CDSDECB                    WAIT FOR I/O COMPLETION       00516000
*   CDSRPTR=ADDR(CDSUA);            /* GET ADDR IF CDS               */ 00517000
         L     CDSRPTR,CDSWKPTR                                    0199 00518000
*   GEN;                                                           0200 00519000
*                                       /*                              00520000
         LH CDSRLREG,CDSRECL              PUT CDS REC LN IN REG         00521000
         WRITE CDSDECB,SF,(DCBPTR),(CDSRPTR),(CDSRLREG),MF=E WRT CDSREC 00522000
         CHECK CDSDECB                    WAIT FOR I/O COMPLETION       00523000
         WRITE CDSDECB,SF,(DCBPTR),ENDREC,80,MF=E  WRITE END RECORD     00524000
         CHECK CDSDECB                    WAIT FOR I/O COMPLETION       00525000
         L     LINKR,RETSAV               RETURN TO                     00526000
         BR    LINKR                        CALLER                   */ 00527000
         EJECT                                                          00528000
*                                                                  0201 00529000
*/********************************************************************/ 00530000
*/*       D A T A  C O N T R O L  B L O C K S                        */ 00531000
*/********************************************************************/ 00532000
*                                                                  0201 00533000
*   GEN;                                                           0201 00534000
REMCDS   DS    0F                                                       00535000
         DCB   DDNAME=SYMSYM,DSORG=PO,RECFM=UT,MACRF=(R,W),            X00536000
               LRECL=80,BLKSIZE=3600,SYNAD=I008CER3                     00537000
          SPACE                                                         00538000
LOCCDS   DS    0F                                                       00539000
         DCB   DDNAME=OLTCDSDD,DSORG=PO,RECFM=UT,MACRF=(R,W),          X00540000
               LRECL=80,BLKSIZE=3600,SYNAD=I008CER3                     00541000
          SPACE                                                         00542000
         WRITE CDSDECB,SF,MF=L                                          00543000
*   DO;                             /* ATDSPLY                       */ 00544000
*   END;                            /* ATDSPLY                       */ 00545000
*   END ISTIC008;                                                  0204 00546000
         B     @EL00001                                            0204 00547000
@DATA    DS    0H                                                       00548000
@CH00237 DC    H'12'                                                    00549000
@CH00078 DC    H'80'                                                    00550000
         DS    0F                                                       00551000
@SA00001 DS    18F                                                      00552000
         DS    0F                                                       00553000
@CV00791 DC    V(ISTSC029)                                              00554000
@CV00794 DC    V(S20CEC03)                                              00555000
@CV00805 DC    V(ISTIC00A)                                              00556000
@CV00838 DC    V(ISTSC021)                                              00557000
         DS    0D                                                       00558000
CDSWKPTR DS    A                                                        00559000
I008CWK  DS    A                                                        00560000
RCAPTR   DS    A                                                        00561000
CECMAP   DS    A                                                        00562000
RETSAV   DS    CL4                                                      00563000
BLANK    DC    CL1' '                                                   00564000
REMOTEID DC    CL1'D'                                                   00565000
LOCALID  DC    CL1'C'                                                   00566000
CDSLOCDD DC    CL8'OLTCDSDD'                                            00567000
         DS    CL1                                                      00568000
TTRZSAVE DS    CL4                                                      00569000
CDSRECL  DS    CL2                                                      00570000
WKAREA   DS    CL8                                                      00571000
UANAME   DC    CL1'G'                                                   00572000
STOWCON  DS    CL32                                                     00573000
         ORG   STOWCON                                                  00574000
STOWNAME DS    CL8                                                      00575000
STOWTTR  DS    CL3                                                      00576000
STOWUSSZ DC    X'0A'                                                    00577000
STOWUSRI DC    20X'00'                                                  00578000
         ORG   STOWCON+32                                               00579000
ESDREC   DS    CL80                                                     00580000
         ORG   ESDREC                                                   00581000
@NM00002 DC    X'02'                                                    00582000
@NM00003 DC    CL3'ESD'                                                 00583000
@NM00004 DC    CL6' '                                                   00584000
@NM00005 DC    X'0030'                                                  00585000
@NM00006 DC    CL2'  '                                                  00586000
@NM00007 DC    X'0001'                                                  00587000
ESDNME1  DS    CL8                                                      00588000
@NM00008 DC    X'00'                                                    00589000
         DC    XL3'0'                                                   00590000
@NM00009 DC    CL1' '                                                   00591000
@NM00010 DC    X'00'                                                    00592000
         DC    XL1'0'                                                   00593000
ESDSIZE  DS    CL1                                                      00594000
ESDNME2  DC    CL8'#OLT00  '                                            00595000
@NM00011 DC    X'02'                                                    00596000
@NM00012 DC    X'00'                                                    00597000
         DC    XL2'0'                                                   00598000
@NM00013 DC    CL4'    '                                                00599000
ESDNME3  DC    CL8'#CTLXXXX'                                            00600000
@NM00014 DC    X'02'                                                    00601000
@NM00015 DC    X'00'                                                    00602000
         DC    XL2'0'                                                   00603000
@NM00016 DC    CL16' '                                                  00604000
@NM00017 DC    CL4'0001'                                                00605000
         ORG   ESDREC+80                                                00606000
TXTHDR   DS    CL80                                                     00607000
         ORG   TXTHDR                                                   00608000
@NM00018 DC    X'02'                                                    00609000
@NM00019 DC    CL6'TXTHDR'                                              00610000
@NM00020 DC    CL9'VS TOLTEP'                                           00611000
TXTHCCW  DS    CL8                                                      00612000
         ORG   TXTHCCW                                                  00613000
@NM00021 DC    X'02'                                                    00614000
TXTHRADR DC    X'000000'                                                00615000
@NM00022 DC    X'20'                                                    00616000
TXTHCNT  DC    X'000000'                                                00617000
         ORG   TXTHDR+24                                                00618000
@NM00023 DC    CL56' '                                                  00619000
         ORG   TXTHDR+80                                                00620000
ENDREC   DS    CL80                                                     00621000
         ORG   ENDREC                                                   00622000
@NM00024 DC    X'02'                                                    00623000
@NM00025 DC    CL3'END'                                                 00624000
@NM00026 DC    X'00'                                                    00625000
         DC    XL75'0'                                                  00626000
         ORG   ENDREC+80                                                00627000
         DS    CL1                                                      00628000
ZZZGTPRM DS    CL13                                                     00629000
         ORG   ZZZGTPRM                                                 00630000
@NM00079 DC    X'0102F1F6'                                              00631000
ZZZGTCD  DS    AL4                                                      00632000
ZZZGTAD  DS    AL4                                                      00633000
ZZZGTCT  DS    FL1                                                      00634000
         ORG   ZZZGTPRM+13                                              00635000
         DS    CL3                                                      00636000
$TCA10   DS    CL13                                                     00637000
         ORG   $TCA10                                                   00638000
$TCB10   DC    A(576)                                                   00639000
$TCC10   DC    A(0)                                                     00640000
$TCD10   DC    B'00000000'                                              00641000
$TCE10   DC    X'80000000'                                              00642000
         ORG   $TCA10+13                                                00643000
         DS    CL3                                                      00644000
$TCA11   DS    CL13                                                     00645000
         ORG   $TCA11                                                   00646000
$TCB11   DC    A(581)                                                   00647000
$TCC11   DC    A(0)                                                     00648000
$TCD11   DC    B'00000000'                                              00649000
$TCE11   DC    X'00400000'                                              00650000
         ORG   $TCA11+13                                                00651000
         DS    CL3                                                      00652000
$TCA12   DS    CL13                                                     00653000
         ORG   $TCA12                                                   00654000
$TCB12   DC    A(581)                                                   00655000
$TCC12   DC    A(0)                                                     00656000
$TCD12   DC    B'00000000'                                              00657000
$TCE12   DC    X'00200000'                                              00658000
         ORG   $TCA12+13                                                00659000
         DS    CL3                                                      00660000
ITATCPRM DS    CL14                                                     00661000
         ORG   ITATCPRM                                                 00662000
@NM00080 DC    X'0102F4F1'                                              00663000
ITATCFR  DS    AL4                                                      00664000
ITATCTO  DS    AL4                                                      00665000
@NM00081 DC    AL1(0)                                                   00666000
         ORG   @NM00081                                                 00667000
ITATCTP  DS    BL1                                                      00668000
         ORG   ITATCPRM+13                                              00669000
ITATCNT  DS    FL1                                                      00670000
         ORG   ITATCPRM+14                                              00671000
         DS    CL2                                                      00672000
$TCA14   DS    CL13                                                     00673000
         ORG   $TCA14                                                   00674000
$TCB14   DC    A(562)                                                   00675000
$TCC14   DC    A(0)                                                     00676000
$TCD14   DC    B'00000000'                                              00677000
$TCE14   DC    X'FFFFFFFF'                                              00678000
         ORG   $TCA14+13                                                00679000
         DS    CL3                                                      00680000
$TCA15   DS    CL13                                                     00681000
         ORG   $TCA15                                                   00682000
$TCB15   DC    A(901)                                                   00683000
$TCC15   DC    A(0)                                                     00684000
$TCD15   DC    B'10000000'                                              00685000
$TCE15   DC    X'FFFFFFFF'                                              00686000
         ORG   $TCA15+13                                                00687000
         DS    CL3                                                      00688000
$TCA16   DS    CL13                                                     00689000
         ORG   $TCA16                                                   00690000
$TCB16   DC    A(571)                                                   00691000
$TCC16   DC    A(0)                                                     00692000
$TCD16   DC    B'00000000'                                              00693000
$TCE16   DC    X'FFFFFFFF'                                              00694000
         ORG   $TCA16+13                                                00695000
         DS    CL3                                                      00696000
$TCA17   DS    CL13                                                     00697000
         ORG   $TCA17                                                   00698000
$TCB17   DC    A(570)                                                   00699000
$TCC17   DC    A(0)                                                     00700000
$TCD17   DC    B'00000000'                                              00701000
$TCE17   DC    X'FFFFFFFF'                                              00702000
         ORG   $TCA17+13                                                00703000
         DS    CL3                                                      00704000
PATCH    DC    40F'0'                                                   00705000
@00      EQU   00                      EQUATES FOR REGISTERS 0-15       00706000
@01      EQU   01                                                       00707000
@02      EQU   02                                                       00708000
@03      EQU   03                                                       00709000
@04      EQU   04                                                       00710000
@05      EQU   05                                                       00711000
@06      EQU   06                                                       00712000
@07      EQU   07                                                       00713000
@08      EQU   08                                                       00714000
@09      EQU   09                                                       00715000
@10      EQU   10                                                       00716000
@11      EQU   11                                                       00717000
@12      EQU   12                                                       00718000
@13      EQU   13                                                       00719000
@14      EQU   14                                                       00720000
@15      EQU   15                                                       00721000
WKREG1   EQU   @04                                                      00722000
CDSRPTR  EQU   @04                                                      00723000
DCBPTR   EQU   @05                                                      00724000
CDSRLREG EQU   @06                                                      00725000
LINKR    EQU   @14                                                      00726000
WAPTR    EQU   @02                                                      00727000
R1       EQU   @01                                                      00728000
R5       EQU   @05                                                      00729000
R15      EQU   @15                                                      00730000
PARMREG1 EQU   @01                                                      00731000
R0       EQU   @00                                                      00732000
R10      EQU   @10                                                      00733000
R11      EQU   @11                                                      00734000
R12      EQU   @12                                                      00735000
R13      EQU   @13                                                      00736000
R14      EQU   @14                                                      00737000
R2       EQU   @02                                                      00738000
R3       EQU   @03                                                      00739000
R4       EQU   @04                                                      00740000
R6       EQU   @06                                                      00741000
R7       EQU   @07                                                      00742000
R8       EQU   @08                                                      00743000
R9       EQU   @09                                                      00744000
@NM00001 EQU   0                                                        00745000
I008CSW  EQU   @NM00001                                                 00746000
CLASSSW  EQU   I008CSW                                                  00747000
TYPESW   EQU   I008CSW                                                  00748000
FLAGSW   EQU   I008CSW                                                  00749000
UASW     EQU   I008CSW                                                  00750000
$RCAAREA EQU   0                                                        00751000
$POINTER EQU   $RCAAREA+100                                             00752000
$TRTBLA  EQU   $POINTER+124                                             00753000
$CONSTNT EQU   $RCAAREA+244                                             00754000
$RCAFLG  EQU   $RCAAREA+604                                             00755000
TOLTEPWA EQU   0                                                        00756000
$SCTTBLE EQU   TOLTEPWA                                                 00757000
$TESTOPT EQU   $SCTTBLE+2                                               00758000
$ERROPT  EQU   $SCTTBLE+3                                               00759000
$PDEVFLG EQU   $SCTTBLE+10                                              00760000
$CDSFLGS EQU   $SCTTBLE+11                                              00761000
$CDS8T19 EQU   $SCTTBLE+20                                              00762000
$EXECFLG EQU   $SCTTBLE+33                                              00763000
$OLTFLGS EQU   $SCTTBLE+36                                              00764000
$OLTFLG2 EQU   $SCTTBLE+37                                              00765000
$TOTFLG1 EQU   $SCTTBLE+38                                              00766000
$ROUTMSK EQU   $SCTTBLE+40                                              00767000
$CDA     EQU   TOLTEPWA+100                                             00768000
$RCA     EQU   $CDA+44                                                  00769000
$OLTPTR  EQU   $CDA+52                                                  00770000
$LOWADDR EQU   $OLTPTR                                                  00771000
$HIMOREC EQU   $CDA+60                                                  00772000
$COMMFLG EQU   TOLTEPWA+224                                             00773000
$FLAG1   EQU   $COMMFLG                                                 00774000
$FLAG2   EQU   $COMMFLG+1                                               00775000
$FLAG3   EQU   $COMMFLG+2                                               00776000
$FLAG4   EQU   $COMMFLG+3                                               00777000
$FLAG5   EQU   $COMMFLG+4                                               00778000
$EOJ     EQU   $FLAG5                                                   00779000
$CANCEL  EQU   $EOJ                                                     00780000
$FLAG6   EQU   $COMMFLG+5                                               00781000
$ABNDBIT EQU   $FLAG6                                                   00782000
$FLAG7   EQU   $COMMFLG+6                                               00783000
$FLAG8   EQU   $COMMFLG+7                                               00784000
$TCECM   EQU   $FLAG8                                                   00785000
$FLAG9   EQU   $COMMFLG+8                                               00786000
$REMSW   EQU   $FLAG9                                                   00787000
$FLAG10  EQU   $COMMFLG+9                                               00788000
$FLAG11  EQU   $COMMFLG+10                                              00789000
$FLAG12  EQU   $COMMFLG+11                                              00790000
$FLAG13  EQU   $COMMFLG+12                                              00791000
$DEVTBLE EQU   TOLTEPWA+240                                             00792000
$DEVCDS  EQU   $DEVTBLE                                                 00793000
$DEVUNAD EQU   $DEVCDS                                                  00794000
@NM00065 EQU   $DEVUNAD+2                                               00795000
$DEVFEAT EQU   $DEVCDS+4                                                00796000
$DEVCDSF EQU   $DEVCDS+9                                                00797000
$DEVSDCF EQU   $DEVCDS+10                                               00798000
$$SYMNME EQU   $DEVCDS+12                                               00799000
$DEVFLG1 EQU   $DEVTBLE+20                                              00800000
$EVNCPLT EQU   $DEVFLG1                                                 00801000
$ATTNEXP EQU   $DEVFLG1                                                 00802000
$INTOCC  EQU   $DEVFLG1                                                 00803000
$DEVFLG2 EQU   $DEVTBLE+21                                              00804000
$DEVTECB EQU   $DEVTBLE+22                                              00805000
$OPIS    EQU   $DEVTECB                                                 00806000
$OPND    EQU   $DEVTECB+2                                               00807000
$DEVFLG3 EQU   $DEVTBLE+27                                              00808000
$SIOFLG  EQU   $DEVFLG3                                                 00809000
$IFTOUT  EQU   $DEVTBLE+36                                              00810000
$DEVSESP EQU   $IFTOUT                                                  00811000
$SSCPDAF EQU   $IFTOUT+6                                                00812000
$LDNCBPT EQU   $DEVTBLE+48                                              00813000
$RNINFO  EQU   $DEVTBLE+56                                              00814000
$DEVFLG5 EQU   $RNINFO+8                                                00815000
$DEVFLG4 EQU   $DEVTBLE+65                                              00816000
$SLTBL   EQU   TOLTEPWA+1468                                            00817000
$RUNTEST EQU   $SLTBL+13                                                00818000
$TESTFLG EQU   $SLTBL+21                                                00819000
$SECLST  EQU   $SLTBL+22                                                00820000
$INBUFR  EQU   TOLTEPWA+2104                                            00821000
#EXITA   EQU   TOLTEPWA+2632                                            00822000
$CCOMDAT EQU   TOLTEPWA+2644                                            00823000
$CFLGS   EQU   $CCOMDAT+16                                              00824000
$24FEMSG EQU   TOLTEPWA+2681                                            00825000
$24CATMG EQU   $24FEMSG+11                                              00826000
@NM00074 EQU   TOLTEPWA+2776                                            00827000
$OUNTPTR EQU   @NM00074+4                                               00828000
$NSPTR   EQU   $OUNTPTR                                                 00829000
$NSCNT   EQU   @NM00074+10                                              00830000
$ENXX    EQU   @NM00074+15                                              00831000
$IMITX   EQU   $ENXX                                                    00832000
SVESC033 EQU   TOLTEPWA+3160                                            00833000
SVECC013 EQU   TOLTEPWA+3232                                            00834000
SVEIC003 EQU   TOLTEPWA+3592                                            00835000
SVESC022 EQU   TOLTEPWA+3736                                            00836000
SVECC011 EQU   TOLTEPWA+4024                                            00837000
#EXIT    EQU   0                                                        00838000
CECOMMAP EQU   0                                                        00839000
CDSMAP   EQU   0                                                        00840000
CDSUA    EQU   CDSMAP                                                   00841000
CDSMFCT  EQU   CDSMAP+4                                                 00842000
CDSMODEL EQU   CDSMFCT                                                  00843000
CDSFEAT  EQU   CDSMFCT+1                                                00844000
CDSBYTCT EQU   CDSMAP+8                                                 00845000
CDSFLAG  EQU   CDSMAP+9                                                 00846000
CDSSYMB  EQU   CDSFLAG                                                  00847000
CDSREMSY EQU   CDSFLAG                                                  00848000
CDSSYMBN EQU   CDSMAP+12                                                00849000
CDSEXARA EQU   CDSMAP+20                                                00850000
$TRTBL   EQU   0                                                        00851000
SVECC012 EQU   SVESC022                                                 00852000
SVEIC00A EQU   SVEIC003                                                 00853000
SVEIC004 EQU   SVEIC003                                                 00854000
SVEIC005 EQU   SVEIC003                                                 00855000
SVESC02A EQU   SVESC022                                                 00856000
SVESC02B EQU   SVESC022                                                 00857000
SVESC02D EQU   SVESC022                                                 00858000
SVESC02E EQU   SVESC022                                                 00859000
SVESC02F EQU   SVECC013                                                 00860000
SVESC024 EQU   SVESC022                                                 00861000
SVESC027 EQU   SVESC022                                                 00862000
SVESC029 EQU   SVESC033                                                 00863000
SVESC031 EQU   SVECC013                                                 00864000
SVESC032 EQU   SVECC011                                                 00865000
SVETC037 EQU   SVEIC003                                                 00866000
         AGO   .@UNREFD                START UNREFERENCED COMPONENTS    00867000
CDSEXTM  EQU   CDSFLAG+2                                                00868000
CDSEXTB  EQU   CDSFLAG+2                                                00869000
CDSTMERB EQU   CDSFLAG+2                                                00870000
@NM00078 EQU   CDSFLAG+1                                                00871000
CDSDVPRO EQU   CDSFLAG+1                                                00872000
CDSNTPRI EQU   CDSFLAG+1                                                00873000
CDSLINCN EQU   CDSFLAG                                                  00874000
CDS2CHAN EQU   CDSFLAG                                                  00875000
CDSEXTPR EQU   CDSFLAG                                                  00876000
CDSFEVOL EQU   CDSFLAG                                                  00877000
CDSSHAR  EQU   CDSFLAG                                                  00878000
CDSFPMD  EQU   CDSFLAG                                                  00879000
CDSTYPE  EQU   CDSMFCT+3                                                00880000
CDSCLASS EQU   CDSMFCT+2                                                00881000
@NM00077 EQU   CDSFEAT                                                  00882000
CDSDEVM  EQU   CDSFEAT                                                  00883000
CDSDEVT  EQU   CDSFEAT                                                  00884000
CDSASCII EQU   CDSFEAT                                                  00885000
$CECFLAG EQU   CECOMMAP+20                                              00886000
$CEINCT  EQU   CECOMMAP+16                                              00887000
$CEINADR EQU   CECOMMAP+12                                              00888000
$CEOUTCT EQU   CECOMMAP+8                                               00889000
$CEOUTAD EQU   CECOMMAP+4                                               00890000
$CECIDNT EQU   CECOMMAP+2                                               00891000
$CECLEVL EQU   CECOMMAP+1                                               00892000
$CECTRMG EQU   CECOMMAP                                                 00893000
SVECC010 EQU   TOLTEPWA+3952                                            00894000
SVETC035 EQU   TOLTEPWA+3880                                            00895000
SVESC030 EQU   TOLTEPWA+3808                                            00896000
SVESC020 EQU   TOLTEPWA+3664                                            00897000
SVEIC002 EQU   TOLTEPWA+3520                                            00898000
SVECC014 EQU   TOLTEPWA+3376                                            00899000
SVESC120 EQU   TOLTEPWA+3304                                            00900000
SVESC025 EQU   TOLTEPWA+3088                                            00901000
@NM00076 EQU   TOLTEPWA+2980                                            00902000
$RPLERR  EQU   TOLTEPWA+2977                                            00903000
@NM00075 EQU   TOLTEPWA+2976                                            00904000
$R13PR3  EQU   TOLTEPWA+2972                                            00905000
$CEINT2  EQU   TOLTEPWA+2968                                            00906000
$CEINT1  EQU   TOLTEPWA+2964                                            00907000
$MSGGET  EQU   TOLTEPWA+2960                                            00908000
$ACQLIST EQU   TOLTEPWA+2956                                            00909000
$R4SAVE1 EQU   TOLTEPWA+2952                                            00910000
$CLSISS  EQU   TOLTEPWA+2950                                            00911000
$CLSCNT  EQU   TOLTEPWA+2948                                            00912000
$CUTABLE EQU   TOLTEPWA+2868                                            00913000
$BUFSZ2  EQU   TOLTEPWA+2864                                            00914000
$RESID2  EQU   TOLTEPWA+2860                                            00915000
$OLTCCW2 EQU   TOLTEPWA+2856                                            00916000
$ENDBFR2 EQU   TOLTEPWA+2852                                            00917000
$1STBFR2 EQU   TOLTEPWA+2848                                            00918000
$TECB2   EQU   TOLTEPWA+2844                                            00919000
$BUFSZ1  EQU   TOLTEPWA+2840                                            00920000
$RESID1  EQU   TOLTEPWA+2836                                            00921000
$OLTCCW1 EQU   TOLTEPWA+2832                                            00922000
$ENDBFR1 EQU   TOLTEPWA+2828                                            00923000
$1STBFR1 EQU   TOLTEPWA+2824                                            00924000
$TECB1   EQU   TOLTEPWA+2820                                            00925000
$WAITIME EQU   TOLTEPWA+2816                                            00926000
$TRTN#   EQU   TOLTEPWA+2815                                            00927000
$WIODEV  EQU   TOLTEPWA+2814                                            00928000
$RQSTSZE EQU   TOLTEPWA+2812                                            00929000
$RQSTPTR EQU   TOLTEPWA+2808                                            00930000
$R4SAVE  EQU   TOLTEPWA+2804                                            00931000
$PARTADR EQU   TOLTEPWA+2800                                            00932000
$TBSDATA EQU   TOLTEPWA+2796                                            00933000
$CTWIDTH EQU   TOLTEPWA+2795                                            00934000
$CTLINE  EQU   TOLTEPWA+2794                                            00935000
$APWIDTH EQU   TOLTEPWA+2793                                            00936000
$APLINE  EQU   TOLTEPWA+2792                                            00937000
$INDEX   EQU   $IMITX                                                   00938000
$UMXX    EQU   @NM00074+14                                              00939000
$NSXX    EQU   @NM00074+12                                              00940000
$ATACNT  EQU   $NSCNT                                                   00941000
$CTR     EQU   @NM00074+8                                               00942000
$ATAPTR  EQU   $NSPTR                                                   00943000
$DDRPTR  EQU   @NM00074                                                 00944000
$DTORESP EQU   TOLTEPWA+2712                                            00945000
$APNAME  EQU   TOLTEPWA+2704                                            00946000
$24SYMNE EQU   $24CATMG+4                                               00947000
$24DEVAD EQU   $24CATMG                                                 00948000
$24RTN#  EQU   $24FEMSG+8                                               00949000
$ESECTID EQU   $24FEMSG                                                 00950000
$24FLGS  EQU   TOLTEPWA+2680                                            00951000
$24SAVE2 EQU   TOLTEPWA+2676                                            00952000
$24SAVE1 EQU   TOLTEPWA+2672                                            00953000
$24UNADR EQU   TOLTEPWA+2668                                            00954000
$24SAV13 EQU   TOLTEPWA+2664                                            00955000
$24RETCD EQU   TOLTEPWA+2663                                            00956000
$MACID   EQU   TOLTEPWA+2661                                            00957000
$CSPARE  EQU   $CFLGS                                                   00958000
$C2WAY   EQU   $CFLGS                                                   00959000
$CINCT   EQU   $CCOMDAT+12                                              00960000
$CINADR  EQU   $CCOMDAT+8                                               00961000
$COUTCT  EQU   $CCOMDAT+4                                               00962000
$COUTAD  EQU   $CCOMDAT                                                 00963000
ROOTLOC  EQU   TOLTEPWA+2640                                            00964000
$RETREG  EQU   TOLTEPWA+2636                                            00965000
$WORK    EQU   TOLTEPWA+2376                                            00966000
$EXTA    EQU   TOLTEPWA+2320                                            00967000
$PASSONA EQU   TOLTEPWA+2264                                            00968000
$TRMINPT EQU   TOLTEPWA+2184                                            00969000
$BUFFER  EQU   TOLTEPWA+1976                                            00970000
$TLTRPL3 EQU   TOLTEPWA+1856                                            00971000
$TLTRPL2 EQU   TOLTEPWA+1736                                            00972000
$TLTRPL1 EQU   TOLTEPWA+1616                                            00973000
@NM00073 EQU   $SLTBL+135                                               00974000
$HIGHRTN EQU   $SLTBL+134                                               00975000
$PRIMADR EQU   $SLTBL+130                                               00976000
$CTSTPT  EQU   $SLTBL+128                                               00977000
$TSTCNT  EQU   $SLTBL+126                                               00978000
$SECFLGS EQU   $SECLST+3                                                00979000
$SECTION EQU   $SECLST                                                  00980000
$SECACT  EQU   $TESTFLG                                                 00981000
$CANTRUN EQU   $TESTFLG                                                 00982000
$FINAL   EQU   $TESTFLG                                                 00983000
$TESTSUF EQU   $RUNTEST+5                                               00984000
$TESTNUM EQU   $RUNTEST+1                                               00985000
$LETPRF  EQU   $RUNTEST                                                 00986000
$SYMBOLC EQU   $SLTBL+5                                                 00987000
$FAMILY  EQU   $SLTBL                                                   00988000
$CDEVPT  EQU   TOLTEPWA+1466                                            00989000
$DEVCNTS EQU   TOLTEPWA+1464                                            00990000
$FEEDBCK EQU   $DEVTBLE+66                                              00991000
$WTISUED EQU   $DEVFLG4                                                 00992000
$EXIOISD EQU   $DEVFLG4                                                 00993000
$REMWRIT EQU   $DEVFLG4                                                 00994000
$REMDONE EQU   $DEVFLG4                                                 00995000
$2NDUSED EQU   $DEVFLG4                                                 00996000
$1STUSED EQU   $DEVFLG4                                                 00997000
$IGLXIFB EQU   $DEVFLG4                                                 00998000
$EXIOLV3 EQU   $DEVFLG4                                                 00999000
@NM00072 EQU   $DEVFLG5                                                 01000000
$DVBASIC EQU   $DEVFLG5                                                 01001000
$ASCII   EQU   $DEVFLG5                                                 01002000
$DEVLU   EQU   $DEVFLG5                                                 01003000
$OPNDFAL EQU   $DEVFLG5                                                 01004000
$ACQNCB  EQU   $DEVFLG5                                                 01005000
$REMOTE  EQU   $DEVFLG5                                                 01006000
$ENDNODE EQU   $DEVFLG5                                                 01007000
$LINENME EQU   $RNINFO                                                  01008000
$CID     EQU   $DEVTBLE+52                                              01009000
$DVCOL   EQU   $LDNCBPT+2                                               01010000
$DVROW   EQU   $LDNCBPT                                                 01011000
$NCSPLP  EQU   $DEVTBLE+44                                              01012000
$DVLN    EQU   $SSCPDAF                                                 01013000
$DAF     EQU   $DEVSESP+4                                               01014000
$VARYPAB EQU   $DEVSESP                                                 01015000
$SYSMN   EQU   $DEVTBLE+28                                              01016000
@NM00071 EQU   $DEVFLG3                                                 01017000
$CLRSNT  EQU   $DEVFLG3                                                 01018000
$OLTERR  EQU   $DEVFLG3                                                 01019000
$SRTEST  EQU   $DEVFLG3                                                 01020000
$DVSNDOK EQU   $SIOFLG                                                  01021000
$POLLREQ EQU   $DEVFLG3                                                 01022000
$ACQRED  EQU   $DEVFLG3                                                 01023000
$NOTDEV  EQU   $DEVFLG3                                                 01024000
$DVINCT  EQU   $DEVTBLE+26                                              01025000
$DVBRKST EQU   $OPND+1                                                  01026000
$DVBRKSN EQU   $OPND                                                    01027000
$DVSEQNO EQU   $OPIS                                                    01028000
$CEINTRP EQU   $DEVFLG2                                                 01029000
$TESTMDE EQU   $DEVFLG2                                                 01030000
$DEVALOC EQU   $DEVFLG2                                                 01031000
$ALLDATA EQU   $DEVFLG2                                                 01032000
$ENDCNTL EQU   $DEVFLG2                                                 01033000
$CTLDEV  EQU   $DEVFLG2                                                 01034000
$NOCDS   EQU   $DEVFLG2                                                 01035000
$DATAIN  EQU   $DEVFLG2                                                 01036000
$PRIMARY EQU   $DEVFLG1                                                 01037000
$DVCTBYT EQU   $INTOCC                                                  01038000
$DEVACT  EQU   $DEVFLG1                                                 01039000
$DVLGMDE EQU   $ATTNEXP                                                 01040000
$DVSPRM  EQU   $EVNCPLT                                                 01041000
$GRABBED EQU   $DEVFLG1                                                 01042000
$CATASTR EQU   $DEVFLG1                                                 01043000
$LETGO   EQU   $DEVFLG1                                                 01044000
$CURELEM EQU   $$SYMNME+4                                               01045000
$MSGOTSD EQU   $$SYMNME                                                 01046000
$EXTDEV  EQU   $DEVCDS+11                                               01047000
@NM00070 EQU   $DEVSDCF                                                 01048000
$NOTPRIM EQU   $DEVSDCF                                                 01049000
@NM00069 EQU   $DEVCDSF                                                 01050000
@NM00068 EQU   $DEVCDSF                                                 01051000
@NM00067 EQU   $DEVCDSF                                                 01052000
$CDSNAME EQU   $DEVCDSF                                                 01053000
$EXTRN   EQU   $DEVCDSF                                                 01054000
$CEVOLUM EQU   $DEVCDSF                                                 01055000
$SHARD   EQU   $DEVCDSF                                                 01056000
$DEVFPM  EQU   $DEVCDSF                                                 01057000
$DEVCNT  EQU   $DEVCDS+8                                                01058000
$DEVTYPE EQU   $DEVFEAT+3                                               01059000
$DEVCLAS EQU   $DEVFEAT+2                                               01060000
$DEVFRRS EQU   $DEVFEAT+1                                               01061000
$DEVMOD  EQU   $DEVFEAT                                                 01062000
$DEVRDGT EQU   @NM00065+1                                               01063000
$DEVCTLU EQU   @NM00065+1                                               01064000
$DEVCHAN EQU   @NM00065                                                 01065000
@NM00066 EQU   @NM00065                                                 01066000
$CTINDX  EQU   $DEVUNAD                                                 01067000
$FLAG16  EQU   $COMMFLG+15                                              01068000
$FLAG15  EQU   $COMMFLG+14                                              01069000
$FLAG14  EQU   $COMMFLG+13                                              01070000
$TEP2ND  EQU   $FLAG13                                                  01071000
$TEP1ST  EQU   $FLAG13                                                  01072000
$CATMSG  EQU   $FLAG13                                                  01073000
$PRMPTSW EQU   $FLAG13                                                  01074000
$DEVENT  EQU   $FLAG13                                                  01075000
$OLTMACC EQU   $FLAG13                                                  01076000
$LGON    EQU   $FLAG13                                                  01077000
$CTLOGON EQU   $FLAG13                                                  01078000
@NM00064 EQU   $FLAG12                                                  01079000
$VARYINP EQU   $FLAG12                                                  01080000
$ENDTEST EQU   $FLAG12                                                  01081000
$VRYHRD  EQU   $FLAG12                                                  01082000
$VRYSFT  EQU   $FLAG12                                                  01083000
$POSTFLG EQU   $FLAG12                                                  01084000
$OPTMSG  EQU   $FLAG12                                                  01085000
$FEORCAT EQU   $FLAG11                                                  01086000
@NM00063 EQU   $FLAG11                                                  01087000
@NM00062 EQU   $FLAG10                                                  01088000
$INBND   EQU   $FLAG10                                                  01089000
$WAITFLG EQU   $FLAG10                                                  01090000
$DPRINT  EQU   $FLAG10                                                  01091000
$HOLD    EQU   $FLAG9                                                   01092000
$NOTRRCH EQU   $FLAG9                                                   01093000
@NM00061 EQU   $FLAG9                                                   01094000
$COPY    EQU   $FLAG9                                                   01095000
$LSTLNSW EQU   $FLAG9                                                   01096000
$MULLNSW EQU   $FLAG9                                                   01097000
$IGRES   EQU   $FLAG9                                                   01098000
$VS2     EQU   $FLAG8                                                   01099000
$VS1     EQU   $FLAG8                                                   01100000
$EDOS    EQU   $FLAG8                                                   01101000
@NM00060 EQU   $FLAG8                                                   01102000
$TWOWAY  EQU   $FLAG8                                                   01103000
@NM00059 EQU   $FLAG8                                                   01104000
$RCVMSG  EQU   $FLAG7                                                   01105000
$RCVRFLG EQU   $FLAG7                                                   01106000
$SNDRFLG EQU   $FLAG7                                                   01107000
$LDOIS   EQU   $FLAG7                                                   01108000
$DCONTCT EQU   $FLAG7                                                   01109000
$EXIOWAT EQU   $FLAG7                                                   01110000
$2NDDATA EQU   $FLAG7                                                   01111000
$1STDATA EQU   $FLAG7                                                   01112000
$CIREQ   EQU   $FLAG6                                                   01113000
$ABTERM  EQU   $ABNDBIT                                                 01114000
$FSTMCIS EQU   $FLAG6                                                   01115000
$DISCREQ EQU   $FLAG6                                                   01116000
$DISCISS EQU   $FLAG6                                                   01117000
$CHANGE  EQU   $FLAG6                                                   01118000
$CTERROR EQU   $FLAG6                                                   01119000
$RECAL11 EQU   $FLAG6                                                   01120000
@NM00058 EQU   $FLAG5                                                   01121000
$PROGCK  EQU   $CANCEL                                                  01122000
$PRINTAP EQU   $FLAG5                                                   01123000
@NM00057 EQU   $FLAG5                                                   01124000
$MSG922  EQU   $FLAG5                                                   01125000
$CT924   EQU   $FLAG5                                                   01126000
$FSTCAT  EQU   $FLAG5                                                   01127000
$FSTFE   EQU   $FLAG5                                                   01128000
$ACTOPND EQU   $FLAG4                                                   01129000
$ACQCUTT EQU   $FLAG4                                                   01130000
$CLSSACT EQU   $FLAG4                                                   01131000
$BACKINT EQU   $FLAG4                                                   01132000
$DMSGSW  EQU   $FLAG4                                                   01133000
$TSTDEVP EQU   $FLAG4                                                   01134000
$APRQPER EQU   $FLAG4                                                   01135000
$OPCOM   EQU   $FLAG4                                                   01136000
$NEWAP   EQU   $FLAG3                                                   01137000
$ALTPRTR EQU   $FLAG3                                                   01138000
$OPTERR  EQU   $FLAG3                                                   01139000
$PRTONLY EQU   $FLAG3                                                   01140000
$REQSTOR EQU   $FLAG3                                                   01141000
$LOGOFFE EQU   $FLAG3                                                   01142000
$TSTERR  EQU   $FLAG3                                                   01143000
$DEVERR  EQU   $FLAG3                                                   01144000
$PARTIAL EQU   $FLAG2                                                   01145000
$NRMTERM EQU   $FLAG2                                                   01146000
$VALDTST EQU   $FLAG2                                                   01147000
$VALDDEV EQU   $FLAG2                                                   01148000
$DBLSLSH EQU   $FLAG2                                                   01149000
$NDR     EQU   $FLAG2                                                   01150000
@NM00056 EQU   $FLAG2                                                   01151000
$FTTHR   EQU   $FLAG2                                                   01152000
$OLTACT  EQU   $FLAG1                                                   01153000
$NORELDV EQU   $FLAG1                                                   01154000
@NM00055 EQU   $FLAG1                                                   01155000
$OPTCHNG EQU   $FLAG1                                                   01156000
$DEVCHNG EQU   $FLAG1                                                   01157000
$TESTCNG EQU   $FLAG1                                                   01158000
$CNSLFG  EQU   $FLAG1                                                   01159000
$TEP3RD  EQU   $FLAG1                                                   01160000
@NM00054 EQU   $CDA+120                                                 01161000
$CUCNT   EQU   $CDA+118                                                 01162000
@NM00053 EQU   $CDA+117                                                 01163000
$PRTFORM EQU   $CDA+116                                                 01164000
$OPISCNT EQU   $CDA+114                                                 01165000
$OPNDCNT EQU   $CDA+112                                                 01166000
$GETMSZE EQU   $CDA+110                                                 01167000
$GRCNTS  EQU   $CDA+108                                                 01168000
$CTLCNT  EQU   $CDA+106                                                 01169000
$ACTLVL  EQU   $CDA+105                                                 01170000
$PRNTLVL EQU   $CDA+104                                                 01171000
$ERRCNTA EQU   $CDA+102                                                 01172000
$TLCNT   EQU   $CDA+100                                                 01173000
$TIMEALW EQU   $CDA+96                                                  01174000
$PTRAREA EQU   $CDA+92                                                  01175000
$GETMPTR EQU   $CDA+88                                                  01176000
$R13PTRT EQU   $CDA+84                                                  01177000
$R13PTR  EQU   $CDA+80                                                  01178000
$TEPEND  EQU   $CDA+76                                                  01179000
$PLINKDL EQU   $CDA+72                                                  01180000
$TEPBEGN EQU   $CDA+68                                                  01181000
$FRELPTR EQU   $CDA+64                                                  01182000
$HIGHADR EQU   $HIMOREC                                                 01183000
$LOMOREC EQU   $CDA+56                                                  01184000
$ENDCOMM EQU   $CDA+48                                                  01185000
$COMMON  EQU   $RCA                                                     01186000
$SLASHAD EQU   $CDA+32                                                  01187000
$PASSON  EQU   $CDA+28                                                  01188000
$TOLBRTB EQU   $CDA+24                                                  01189000
$SCTPTR8 EQU   $CDA+20                                                  01190000
$SCTPTR  EQU   $CDA+16                                                  01191000
$TBWDPTR EQU   $CDA+12                                                  01192000
$TFWDPTR EQU   $CDA+8                                                   01193000
@NM00052 EQU   $CDA                                                     01194000
@NM00051 EQU   $SCTTBLE+98                                              01195000
$SCTLWTC EQU   $SCTTBLE+96                                              01196000
$SCTLWTA EQU   $SCTTBLE+92                                              01197000
#EXT     EQU   $SCTTBLE+88                                              01198000
#PASS    EQU   $SCTTBLE+84                                              01199000
#TABLE   EQU   $SCTTBLE+80                                              01200000
#MSGIDAC EQU   $SCTTBLE+78                                              01201000
@NM00050 EQU   $SCTTBLE+71                                              01202000
$RETMASK EQU   $SCTTBLE+70                                              01203000
$R249255 EQU   $ROUTMSK+29                                              01204000
$R241248 EQU   $ROUTMSK+28                                              01205000
$R233240 EQU   $ROUTMSK+27                                              01206000
$R225232 EQU   $ROUTMSK+26                                              01207000
$R217224 EQU   $ROUTMSK+25                                              01208000
$R209216 EQU   $ROUTMSK+24                                              01209000
$R201208 EQU   $ROUTMSK+23                                              01210000
$R193200 EQU   $ROUTMSK+22                                              01211000
$R185192 EQU   $ROUTMSK+21                                              01212000
$R177184 EQU   $ROUTMSK+20                                              01213000
$R169176 EQU   $ROUTMSK+19                                              01214000
$R161168 EQU   $ROUTMSK+18                                              01215000
$R153160 EQU   $ROUTMSK+17                                              01216000
$R145152 EQU   $ROUTMSK+16                                              01217000
$R137144 EQU   $ROUTMSK+15                                              01218000
$R129136 EQU   $ROUTMSK+14                                              01219000
$R121128 EQU   $ROUTMSK+13                                              01220000
$R113120 EQU   $ROUTMSK+12                                              01221000
$R105112 EQU   $ROUTMSK+11                                              01222000
$R097104 EQU   $ROUTMSK+10                                              01223000
$R089096 EQU   $ROUTMSK+9                                               01224000
$R081088 EQU   $ROUTMSK+8                                               01225000
$R073080 EQU   $ROUTMSK+7                                               01226000
$R065072 EQU   $ROUTMSK+6                                               01227000
$R057064 EQU   $ROUTMSK+5                                               01228000
$R049056 EQU   $ROUTMSK+4                                               01229000
$R041048 EQU   $ROUTMSK+3                                               01230000
$R033040 EQU   $ROUTMSK+2                                               01231000
$R025032 EQU   $ROUTMSK+1                                               01232000
$R017024 EQU   $ROUTMSK                                                 01233000
$TOTFLG2 EQU   $SCTTBLE+39                                              01234000
@NM00049 EQU   $TOTFLG1                                                 01235000
@NM00048 EQU   $TOTFLG1                                                 01236000
@NM00047 EQU   $TOTFLG1                                                 01237000
$CURELOD EQU   $TOTFLG1                                                 01238000
$CTEQTT  EQU   $TOTFLG1                                                 01239000
@NM00046 EQU   $TOTFLG1                                                 01240000
@NM00045 EQU   $TOTFLG1                                                 01241000
$LINESHR EQU   $TOTFLG1                                                 01242000
@NM00044 EQU   $OLTFLG2                                                 01243000
@NM00043 EQU   $OLTFLG2                                                 01244000
@NM00042 EQU   $OLTFLG2                                                 01245000
@NM00041 EQU   $OLTFLG2                                                 01246000
@NM00040 EQU   $OLTFLG2                                                 01247000
@NM00039 EQU   $OLTFLG2                                                 01248000
@NM00038 EQU   $OLTFLG2                                                 01249000
$TALK    EQU   $OLTFLG2                                                 01250000
$DYCOM   EQU   $OLTFLGS                                                 01251000
@NM00037 EQU   $OLTFLGS                                                 01252000
$TRACE   EQU   $OLTFLGS                                                 01253000
$RETCODE EQU   $OLTFLGS                                                 01254000
$CONTCB  EQU   $OLTFLGS                                                 01255000
$RETAIN  EQU   $OLTFLGS                                                 01256000
$CLEANRT EQU   $OLTFLGS                                                 01257000
$MANINTV EQU   $OLTFLGS                                                 01258000
$OLTSIZE EQU   $SCTTBLE+34                                              01259000
$QSCTMOD EQU   $EXECFLG                                                 01260000
$CTRLMOD EQU   $EXECFLG                                                 01261000
$CLEANUP EQU   $EXECFLG                                                 01262000
$LSTPDEV EQU   $EXECFLG                                                 01263000
$ERRCNT  EQU   $EXECFLG                                                 01264000
$RTNSLCT EQU   $EXECFLG                                                 01265000
$MULTDEV EQU   $EXECFLG                                                 01266000
@NM00036 EQU   $EXECFLG                                                 01267000
$RMSKCNT EQU   $SCTTBLE+32                                              01268000
$SYNAME  EQU   $CDS8T19+4                                               01269000
$EXTSIG  EQU   $CDS8T19+3                                               01270000
$CDFLGS  EQU   $CDS8T19+1                                               01271000
$CDSCNT  EQU   $CDS8T19                                                 01272000
$PDEVDSC EQU   $SCTTBLE+16                                              01273000
$PDEVADR EQU   $SCTTBLE+12                                              01274000
$COMMCN  EQU   $CDSFLGS                                                 01275000
$CUSTSYM EQU   $CDSFLGS                                                 01276000
$TWOCHSW EQU   $CDSFLGS                                                 01277000
$SYMNAME EQU   $CDSFLGS                                                 01278000
$EXTINTC EQU   $CDSFLGS                                                 01279000
$CEVOL   EQU   $CDSFLGS                                                 01280000
$SHARED  EQU   $CDSFLGS                                                 01281000
$FPM     EQU   $CDSFLGS                                                 01282000
$LASTSUB EQU   $PDEVFLG                                                 01283000
@NM00035 EQU   $PDEVFLG                                                 01284000
@NM00034 EQU   $PDEVFLG                                                 01285000
@NM00033 EQU   $PDEVFLG                                                 01286000
$LASTDEV EQU   $PDEVFLG                                                 01287000
@NM00032 EQU   $PDEVFLG                                                 01288000
$EXFILPT EQU   $PDEVFLG                                                 01289000
$FPMOLD  EQU   $PDEVFLG                                                 01290000
$TSSSYM  EQU   $SCTTBLE+8                                               01291000
$SCTLEVL EQU   $SCTTBLE+7                                               01292000
$DRIVER  EQU   $SCTTBLE+6                                               01293000
$RT0916  EQU   $SCTTBLE+5                                               01294000
$RT0108  EQU   $SCTTBLE+4                                               01295000
$LOOPTST EQU   $ERROPT                                                  01296000
$LOOPERR EQU   $ERROPT                                                  01297000
$NERRPRT EQU   $ERROPT                                                  01298000
$NOCNTRL EQU   $ERROPT                                                  01299000
$ALTPRNT EQU   $ERROPT                                                  01300000
$CATERR  EQU   $ERROPT                                                  01301000
$ASTERIK EQU   $ERROPT                                                  01302000
$TESTERR EQU   $ERROPT                                                  01303000
$FSTCOMM EQU   $TESTOPT                                                 01304000
$INDEFLP EQU   $TESTOPT                                                 01305000
$NOPRT   EQU   $TESTOPT                                                 01306000
$PARAPRT EQU   $TESTOPT                                                 01307000
@NM00031 EQU   $TESTOPT                                                 01308000
$ERRLPCT EQU   $SCTTBLE                                                 01309000
$TLTEND  EQU   $RCAAREA+945                                             01310000
$CNSLID  EQU   $RCAAREA+936                                             01311000
$EXITSAV EQU   $RCAAREA+864                                             01312000
$TRASCII EQU   $RCAAREA+608                                             01313000
@NM00030 EQU   $RCAAREA+605                                             01314000
$VTAMEND EQU   $RCAFLG                                                  01315000
$TPPOSTD EQU   $RCAFLG                                                  01316000
$NEWCT   EQU   $RCAFLG                                                  01317000
$ABNDALL EQU   $RCAFLG                                                  01318000
$CUTESTB EQU   $RCAFLG                                                  01319000
$CONSOLE EQU   $RCAFLG                                                  01320000
$TPLOGON EQU   $RCAFLG                                                  01321000
$UPDATE  EQU   $RCAFLG                                                  01322000
$DEVAREA EQU   $RCAAREA+600                                             01323000
$CTDVAR  EQU   $RCAAREA+596                                             01324000
$BUFFS   EQU   $RCAAREA+464                                             01325000
$TLTNIB  EQU   $CONSTNT+140                                             01326000
$TLTPRPL EQU   $CONSTNT+20                                              01327000
@NM00029 EQU   $CONSTNT+4                                               01328000
@NM00028 EQU   $CONSTNT+2                                               01329000
$USECNT  EQU   $CONSTNT                                                 01330000
$CURRTWA EQU   $POINTER+140                                             01331000
$CTNAME  EQU   $POINTER+132                                             01332000
$CTARGX  EQU   $POINTER+128                                             01333000
$COMINT  EQU   $POINTER+120                                             01334000
$QUEHNDL EQU   $POINTER+116                                             01335000
@NM00027 EQU   $POINTER+36                                              01336000
$RTNPTR  EQU   $POINTER+32                                              01337000
$TLTECB2 EQU   $POINTER+28                                              01338000
$TLTECB1 EQU   $POINTER+24                                              01339000
$CLEANP  EQU   $POINTER+20                                              01340000
$ABEND   EQU   $POINTER+16                                              01341000
$LSTAREA EQU   $POINTER+12                                              01342000
$FSTAREA EQU   $POINTER+8                                               01343000
$CVTSAVE EQU   $POINTER+4                                               01344000
$TOLTEP  EQU   $POINTER                                                 01345000
$TLTACB  EQU   $RCAAREA                                                 01346000
DATASW   EQU   I008CSW                                                  01347000
DBSW     EQU   I008CSW                                                  01348000
EBCDICSW EQU   I008CSW                                                  01349000
CONTSCAN EQU   I008CSW                                                  01350000
.@UNREFD ANOP                          END UNREFERENCED COMPONENTS      01351000
@RT00085 EQU   I008C01B                                                 01352000
@RF00096 EQU   I008C03                                                  01353000
@RT00123 EQU   I008CADR                                                 01354000
@RT00153 EQU   I008CER2                                                 01355000
@RT00155 EQU   I008CER3                                                 01356000
@ENDDATA EQU   *                                                        01357000
         END   ISTIC008,(C'PLS0152',0702,79034)                         01358000
./  ADD  SSI=83360301,NAME=ISTIC009
         TITLE 'ISTIC009,CHANGE - ALLOWS CHANGE TO AN EXISTING CDS'     00001000
ISTIC009 CSECT ,                                                   0001 00002000
@MAINENT DS    0H                                                  0001 00003000
         USING *,@15                                               0001 00004000
         B     @PROLOG                                             0001 00005000
         DC    AL1(16)                                             0001 00006000
         DC    C'ISTIC009  78.336'                                 0001 00007000
         DROP  @15                                                      00008000
@PROLOG  ST    @14,12(,@13)                                        0001 00009000
         STM   @00,@12,20(@13)                                     0001 00010000
         BALR  @11,0                                               0001 00011000
@PSTART  DS    0H                                                  0001 00012000
         USING @PSTART,@11                                         0001 00013000
         ST    @13,@SA00001+4                                      0001 00014000
         LA    @12,@SA00001                                        0001 00015000
         ST    @12,8(,@13)                                         0001 00016000
         LR    @13,@12                                             0001 00017000
         EJECT                                                          00018000
OPENFLAG EQU  48                                                        00019000
GOODOPEN EQU  16                                                        00020000
         EJECT                                                          00021000
         EJECT                                                          00022000
I009C01  DS    0H                                                  0075 00023000
*   CDSWKPTR=$LOWADDR;              /* SET UP BASE                   */ 00024000
         L     @15,$LOWADDR(,WAPTR)                                0075 00025000
         ST    @15,CDSWKPTR                                        0075 00026000
*   CDSWKPTR=CDSWKPTR+80;           /* GET CDS WORK AREA OFFSET      */ 00027000
         AH    @15,@CH00075                                        0076 00028000
         ST    @15,CDSWKPTR                                        0076 00029000
*   IF $REMSW¬='1'B THEN            /* IF ITS NOT A REMOTE REQ       */ 00030000
         TM    $REMSW(WAPTR),B'01000000'                           0077 00031000
         BNO   @RT00077                                            0077 00032000
*     GOTO I009C01A;                /* THEN BR AROUND                */ 00033000
*   CDSSYMB='1'B;                   /* TURN ON SYMBOLIC BIT          */ 00034000
*   CDSREMSY='1'B;                  /* TURN ON REMOTE BIT            */ 00035000
         OI    CDSSYMB(@15),B'00001010'                            0080 00036000
*I009C01A:                                                         0081 00037000
*   DCL                                                            0081 00038000
*     1 ZZZGTPRM BDY(WORD),         /* GETCONFG PARAMETER LIST       */ 00039000
*      2 * CHAR(4) INIT('0102F1F6'X),                              0081 00040000
*      2 ZZZGTCD PTR,               /* POINTER TO BASIC CDS INFO     */ 00041000
*      2 ZZZGTAD PTR,               /* POINTER TO RECEIVING BUFFER   */ 00042000
*      2 ZZZGTCT FIXED(8);          /* NUMBER OF CDS BYTES NEEDED    */ 00043000
I009C01A DS    0H                                                  0082 00044000
*   ZZZGTAD=ADDR(CDSUA);            /* POINTER TO RECEIVING BUFFER   */ 00045000
         L     @15,CDSWKPTR                                        0082 00046000
         ST    @15,ZZZGTAD                                         0082 00047000
*   ZZZGTCD=ADDR(CDSUA);            /* POINTER TO BASIC CDS INFO     */ 00048000
         ST    @15,ZZZGTCD                                         0083 00049000
*   ZZZGTCT=20;                     /* NUMBER OF BYTES NEEDED        */ 00050000
         MVI   ZZZGTCT,X'14'                                       0084 00051000
*   R1=ADDR(ZZZGTPRM);              /* POINT TO THE PARM LIST        */ 00052000
         LA    R1,ZZZGTPRM                                         0085 00053000
*   CALL ISTSC029;                  /* CALL THE GETCONFG FUNCTION    */ 00054000
         L     @15,@CV00771                                        0086 00055000
         BALR  @14,@15                                             0086 00056000
*   IF R15¬=12 THEN                                                0087 00057000
         CH    R15,@CH00081                                        0087 00058000
         BNE   @RT00087                                            0087 00059000
*     GOTO I009C02;                 /* BR AROUND                     */ 00060000
*I009C01B:                                                         0089 00061000
*                                                                  0089 00062000
*   /*****************************************************************/ 00063000
*   /*                                                               */ 00064000
*   /* TCEC MSGN(572) INVOKED                                        */ 00065000
*   /*                                                               */ 00066000
*   /*****************************************************************/ 00067000
*                                                                  0089 00068000
*   $TCECM='1'B;                    /* SET TCEC SW IN RCA            */ 00069000
I009C01B OI    $TCECM(WAPTR),B'00000001'                           0089 00070000
*   R1=ADDR($TCA10);                /* SET UP PARM LIST $TR          */ 00071000
         LA    R1,$TCA10                                           0090 00072000
*   CALL #EXIT;                     /* CALL CECOM                    */ 00073000
         L     @15,#EXITA(,WAPTR)                                  0091 00074000
         BALR  @14,@15                                             0091 00075000
*   DCL                                                            0092 00076000
*     1 $TCA10,                     /* TCEC PARM LIST                */ 00077000
*      2 $TCB10 FIXED(32) INIT(572),/* MSG NUMBER                    */ 00078000
*      2 $TCC10 FIXED(32) INIT(0),  /* INCT LEN                      */ 00079000
*      2 $TCD10 BIT(8) INIT('00000000'B),/* FLAG                     */ 00080000
*      2 $TCE10 CHAR(4) INIT('FFFFFFFF'X);/* MSSAGE MASK CDS NOT   0092 00081000
*                                      FOUND                         */ 00082000
*   GOTO I009CRET;                  /* RETURN TO CONTROL MODULE      */ 00083000
         B     I009CRET                                            0093 00084000
*I009C02:                                                          0094 00085000
*   OLDCDSLN=CDSBYTCT;              /* SAVE THE ORGINAL BYTE CNT     */ 00086000
I009C02  L     @15,CDSWKPTR                                        0094 00087000
         MVC   OLDCDSLN(1),CDSBYTCT(@15)                           0094 00088000
*   IF $REMSW='1'B                  /* IF ITS A REMOTE REQUEST       */ 00089000
*     THEN                                                         0095 00090000
         TM    $REMSW(WAPTR),B'01000000'                           0095 00091000
         BNO   @RF00095                                            0095 00092000
*     DO;                                                          0096 00093000
*       DCBPTR=ADDR(RDREMCDS);      /* THEN SET UP DCB POINTER       */ 00094000
         LA    DCBPTR,RDREMCDS                                     0097 00095000
*       STOWNAME=CDSSYMBN;          /* SET UP STOW NAME              */ 00096000
         MVC   STOWNAME(8),CDSSYMBN(@15)                           0098 00097000
*     END;                                                         0099 00098000
*   ELSE                            /* OTHERWISE SET PTR             */ 00099000
*     DO;                                                          0100 00100000
         B     @RC00095                                            0100 00101000
@RF00095 DS    0H                                                  0101 00102000
*       DCBPTR=ADDR(RDLOCCDS);      /* TO POINT TO LOCAL CDS         */ 00103000
*                                                                  0101 00104000
         LA    DCBPTR,RDLOCCDS                                     0101 00105000
*       /*************************************************************/ 00106000
*       /*                                                           */ 00107000
*       /* ITACONV FROM(CDSUA)TO(STOWNAME)COUNT(4)TYPE(HE) INVOKED   */ 00108000
*       /*                                                           */ 00109000
*       /*************************************************************/ 00110000
*                                                                  0102 00111000
*       DCL                                                        0102 00112000
*         1 ITATCPRM BDY(WORD),     /* CONVERT PARAMETER LIST        */ 00113000
*          2 * CHAR(4) INIT('0102F4F1'X),                          0102 00114000
*          2 ITATCFR PTR,           /* ADDRESS OF FROM FIELD         */ 00115000
*          2 ITATCTO PTR,           /* ADDRESS OF TO FIELD           */ 00116000
*          2 * BIT(8) INIT(0),      /* FLAGS FOR CONVERT MODULE      */ 00117000
*           3 ITATCTP BIT(1),       /* TYPE OF CONVERT REQUIRED      */ 00118000
*          2 ITATCNT FIXED(8);      /* NUMBER OF BYTES TO CONVERT    */ 00119000
*       ITATCFR=ADDR(CDSUA);        /* SET THE FROM ADDRESS          */ 00120000
         MVC   ITATCFR(4),CDSWKPTR                                 0103 00121000
*       ITATCTO=ADDR(STOWNAME);     /* SET THE TO ADDRESS            */ 00122000
         LA    @15,STOWNAME                                        0104 00123000
         ST    @15,ITATCTO                                         0104 00124000
*       ITATCTP='1'B;               /* SET THE TYPE OF CONVERT BIT   */ 00125000
         OI    ITATCTP,B'10000000'                                 0105 00126000
*       ITATCNT=4;                  /* GIVE THE CONVERT BYTE COUNT   */ 00127000
         MVI   ITATCNT,X'04'                                       0106 00128000
*       R1=ADDR(ITATCPRM);          /* POINT TO CONVERT PARM LIST    */ 00129000
         LA    R1,ITATCPRM                                         0107 00130000
*       CALL ISTSC021;              /* CALL CONVERT DIRECTLY         */ 00131000
         L     @15,@CV00793                                        0108 00132000
         BALR  @14,@15                                             0108 00133000
*       GEN(MVC STOWNAME(1),UANAME);/* SET UP PREFIX ID              */ 00134000
         MVC STOWNAME(1),UANAME                                         00135000
*     END;                                                         0110 00136000
*   NAMEPTR=ADDR(STOWNAME);         /* GET PTR TO CDS NAME           */ 00137000
@RC00095 LA    NAMEPTR,STOWNAME                                    0111 00138000
*   GEN(BAL LINKR,I009CRD);         /* GO READ ESD,TXT,CDS REC       */ 00139000
         BAL LINKR,I009CRD                                              00140000
*I009C03:                                                          0113 00141000
*   CALL ISTIC00A;                  /* GO CONFIGURE CDS              */ 00142000
I009C03  L     @15,@CV00795                                        0113 00143000
         BALR  @14,@15                                             0113 00144000
*   IF $COPY='1'B                   /* IF THIS IS A COPY REQUEST     */ 00145000
*     THEN                          /*                               */ 00146000
         TM    $COPY(WAPTR),B'00001000'                            0114 00147000
         BNO   @RF00114                                            0114 00148000
*     DO;                           /* DO THE FOLLOWING              */ 00149000
*       ZZZGTAD=ADDR(WKAREA2);      /* POINTER TO RECEIVING BUFFER   */ 00150000
         LA    @15,WKAREA2                                         0116 00151000
         ST    @15,ZZZGTAD                                         0116 00152000
*       ZZZGTCD=ADDR(CDSUA);        /* POINTER TO BASIC CDS INFO     */ 00153000
         MVC   ZZZGTCD(4),CDSWKPTR                                 0117 00154000
*       ZZZGTCT=20;                 /* NUMBER OF BYTES NEEDED        */ 00155000
         MVI   ZZZGTCT,X'14'                                       0118 00156000
*       R1=ADDR(ZZZGTPRM);          /* POINT TO THE PARM LIST        */ 00157000
         LA    R1,ZZZGTPRM                                         0119 00158000
*       CALL ISTSC029;              /* CALL THE GETCONFG FUNCTION    */ 00159000
         L     @15,@CV00771                                        0120 00160000
         BALR  @14,@15                                             0120 00161000
*       IF R15¬=12                  /* IF A CDS ALREADY EXIST        */ 00162000
*         THEN                      /* THEN DO THE FOLLOWING         */ 00163000
         CH    R15,@CH00081                                        0121 00164000
         BE    @RF00121                                            0121 00165000
*         DO;                                                      0122 00166000
*                                                                  0122 00167000
*           /*********************************************************/ 00168000
*           /*                                                       */ 00169000
*           /* TCEC MSGN(576)MSGMSK('40000000'X) INVOKED             */ 00170000
*           /*                                                       */ 00171000
*           /*********************************************************/ 00172000
*                                                                  0123 00173000
*           $TCECM='1'B;            /* SET TCEC SW IN RCA            */ 00174000
         OI    $TCECM(WAPTR),B'00000001'                           0123 00175000
*           R1=ADDR($TCA13);        /* SET UP PARM LIST $TR          */ 00176000
         LA    R1,$TCA13                                           0124 00177000
*           CALL S20CEC03;          /* CALL TCEC-MULTIPLE LN         */ 00178000
         L     @15,@CV00798                                        0125 00179000
         BALR  @14,@15                                             0125 00180000
*           DCL                                                    0126 00181000
*             1 $TCA13,             /* TCEC PARM LIST                */ 00182000
*              2 $TCB13 FIXED(32) INIT(576),/* MSG NUMBER            */ 00183000
*              2 $TCC13 FIXED(32) INIT(0),/* INCT LEN                */ 00184000
*              2 $TCD13 BIT(8) INIT('00000000'B),/* FLAG             */ 00185000
*              2 $TCE13 CHAR(4) INIT('40000000'X);/* MSSAGE MASK     */ 00186000
*           GOTO I009CRET;          /* PRT ERROR-CDS EXISTS,DELETE   */ 00187000
         B     I009CRET                                            0127 00188000
*         END;                                                     0128 00189000
*       ELSE                        /* IF A CDS DOES NOT EXIST       */ 00190000
*         DO;                       /* THEN DO THE FOLLOWING         */ 00191000
@RF00121 DS    0H                                                  0130 00192000
*           IF $REMSW='1'B          /* IF THIS IS A REMOTE REQUEST   */ 00193000
*             THEN                  /* THEN DO THE FOLLOWING         */ 00194000
         TM    $REMSW(WAPTR),B'01000000'                           0130 00195000
         BNO   @RF00130                                            0130 00196000
*             DO;                                                  0131 00197000
*               STOWNAME=CDSSYMBN;  /* SET UP SYMBOLIC STOW NAME     */ 00198000
         L     @15,CDSWKPTR                                        0132 00199000
         MVC   STOWNAME(8),CDSSYMBN(@15)                           0132 00200000
*               ESDNME1=CDSSYMBN;   /* SET UP SYMB NAME IN ESD REC   */ 00201000
         MVC   ESDNME1(8),CDSSYMBN(@15)                            0133 00202000
*             END;                                                 0134 00203000
*           ELSE                    /* IF THIS IS NOT A REM REQ      */ 00204000
*             DO;                   /* THEN DO THE FOLLOWING         */ 00205000
*                                                                  0135 00206000
         B     @RC00130                                            0135 00207000
@RF00130 DS    0H                                                  0136 00208000
*               /*****************************************************/ 00209000
*               /*                                                   */ 00210000
*               /* ITACONV FROM(CDSUA)TO(STOWNAME)COUNT(4)TYPE(HE)   */ 00211000
*               /* INVOKED                                           */ 00212000
*               /*                                                   */ 00213000
*               /*****************************************************/ 00214000
*                                                                  0136 00215000
*               ITATCFR=ADDR(CDSUA);/* SET THE FROM ADDRESS          */ 00216000
         MVC   ITATCFR(4),CDSWKPTR                                 0136 00217000
*               ITATCTO=ADDR(STOWNAME);/* SET THE TO ADDRESS         */ 00218000
         LA    @15,STOWNAME                                        0137 00219000
         ST    @15,ITATCTO                                         0137 00220000
*               ITATCTP='1'B;       /* SET THE TYPE OF CONVERT BIT   */ 00221000
         OI    ITATCTP,B'10000000'                                 0138 00222000
*               ITATCNT=4;          /* GIVE THE CONVERT BYTE COUNT   */ 00223000
         MVI   ITATCNT,X'04'                                       0139 00224000
*               R1=ADDR(ITATCPRM);  /* POINT TO CONVERT PARM LIST    */ 00225000
         LA    R1,ITATCPRM                                         0140 00226000
*               CALL ISTSC021;      /* CALL CONVERT DIRECTLY         */ 00227000
         L     @15,@CV00793                                        0141 00228000
         BALR  @14,@15                                             0141 00229000
*               GEN(MVC STOWNAME(1),UANAME);/* SET UP PREFIX         */ 00230000
         MVC STOWNAME(1),UANAME                                         00231000
*               ESDNME1=STOWNAME;   /* SET UP NEW ESD NAME           */ 00232000
         MVC   ESDNME1(8),STOWNAME                                 0143 00233000
*             END;                                                 0144 00234000
*         END;                                                     0145 00235000
@RC00130 DS    0H                                                  0146 00236000
*     END;                                                         0146 00237000
*   IF $REMSW='1'B                  /* IF THIS IS A REMOTE REQUEST   */ 00238000
*     THEN                          /* AND THE SYMBOLIC BIT IS ON    */ 00239000
@RF00114 TM    $REMSW(WAPTR),B'01000000'                           0147 00240000
         BNO   @RF00147                                            0147 00241000
*     DO;                           /* AND THE REMOTE BIT IS ON      */ 00242000
*       IF CDSSYMB='1'B&CDSREMSY='1'B&CDSSYMBN(1:1)¬=BLANK THEN    0149 00243000
         L     @15,CDSWKPTR                                        0149 00244000
         TM    CDSSYMB(@15),B'00001010'                            0149 00245000
         BNO   @RF00149                                            0149 00246000
         CLC   CDSSYMBN(1,@15),BLANK                               0149 00247000
         BNE   @RT00149                                            0149 00248000
*         GOTO I009C04;             /* THEN IT OK-CONTINUE           */ 00249000
*       GOTO I009C03A;              /* OTHERWISE IT AN ERROR         */ 00250000
         B     I009C03A                                            0151 00251000
*     END;                                                         0152 00252000
*   ELSE                                                           0153 00253000
*     DO;                                                          0153 00254000
@RF00147 DS    0H                                                  0154 00255000
*       IF CDSSYMB='1'B             /* IF IT NOT A REMOTE REQ AND    */ 00256000
*         THEN                      /* THE SYMBOLIC BIT IS ON        */ 00257000
         L     @15,CDSWKPTR                                        0154 00258000
         TM    CDSSYMB(@15),B'00001000'                            0154 00259000
         BNO   @RF00154                                            0154 00260000
*         DO;                       /* THEN CK FOR SYMBOLIC NAME     */ 00261000
*           IF CDSSYMBN=BLANK       /* IF BLANK                      */ 00262000
*             THEN                  /* THEN                          */ 00263000
         CLC   CDSSYMBN(1,@15),BLANK                               0156 00264000
         BE    @RT00156                                            0156 00265000
*             GOTO I009C04;         /* IT OK-CONTINUE                */ 00266000
*           GOTO I009C03A;          /* OTHERWISE PRT ERROR           */ 00267000
         B     I009C03A                                            0158 00268000
*         END;                                                     0159 00269000
*       ELSE                        /* IF THE SYMBOLIC BIT IS OFF    */ 00270000
*         GOTO I009C04;             /* IT OK-CONTINUE                */ 00271000
*     END;                                                         0161 00272000
*I009C03A:                                                         0162 00273000
*                                                                  0162 00274000
*   /*****************************************************************/ 00275000
*   /*                                                               */ 00276000
*   /* TCEC MSGN(581)MSGMSK('00400000'X) INVOKED                     */ 00277000
*   /*                                                               */ 00278000
*   /*****************************************************************/ 00279000
*                                                                  0162 00280000
*   $TCECM='1'B;                    /* SET TCEC SW IN RCA            */ 00281000
I009C03A OI    $TCECM(WAPTR),B'00000001'                           0162 00282000
*   R1=ADDR($TCA15);                /* SET UP PARM LIST $TR          */ 00283000
         LA    R1,$TCA15                                           0163 00284000
*   CALL S20CEC03;                  /* CALL TCEC-MULTIPLE LN         */ 00285000
         L     @15,@CV00798                                        0164 00286000
         BALR  @14,@15                                             0164 00287000
*   DCL                                                            0165 00288000
*     1 $TCA15,                     /* TCEC PARM LIST                */ 00289000
*      2 $TCB15 FIXED(32) INIT(581),/* MSG NUMBER                    */ 00290000
*      2 $TCC15 FIXED(32) INIT(0),  /* INCT LEN                      */ 00291000
*      2 $TCD15 BIT(8) INIT('00000000'B),/* FLAG                     */ 00292000
*      2 $TCE15 CHAR(4) INIT('00400000'X);/* MSSAGE MASK INV SYM NME    00293000
*                                      OR FLAG                       */ 00294000
*   GO TO I009C03;                  /* GO RECONFIGURE                */ 00295000
         B     I009C03                                             0166 00296000
*I009C04:                                                          0167 00297000
*   IF $COPY='1'B THEN              /* IF THIS IS A COPY REQUEST     */ 00298000
I009C04  TM    $COPY(WAPTR),B'00001000'                            0167 00299000
         BO    @RT00167                                            0167 00300000
*     GOTO I009C05;                 /* THEN BR AROUND                */ 00301000
*   IF CDSBYTCT¬>OLDCDSLN           /* IF THE CDS RECORD DID NOT     */ 00302000
*     THEN                          /* INCREASE IN SIZE              */ 00303000
         L     @15,CDSWKPTR                                        0169 00304000
         CLC   CDSBYTCT(1,@15),OLDCDSLN                            0169 00305000
         BH    @RF00169                                            0169 00306000
*     DO;                           /* THEN SET UP TTR TO POINT      */ 00307000
*       GEN(B I009CWR2);            /* GO WRT CDS RECORD ONLY        */ 00308000
         B I009CWR2                                                     00309000
*     END;                                                         0172 00310000
*   ELSE                            /* IF CDS DID INCREASE IN SIZE   */ 00311000
*     DO;                           /* THEN DO FOLLOWING             */ 00312000
         B     @RC00169                                            0173 00313000
@RF00169 DS    0H                                                  0174 00314000
*I009C05:                                                          0174 00315000
*       GEN;                                                       0174 00316000
I009C05  DS    0H                                                  0174 00317000
*                            /*                                         00318000
               CLOSE ((DCBPTR))           CLOSE IT OUT               */ 00319000
*       IF $REMSW='1'B              /* IF THIS IS A REMOTE REQUEST   */ 00320000
*         THEN                      /* THEN DO THE FOLLOWING         */ 00321000
         TM    $REMSW(WAPTR),B'01000000'                           0175 00322000
         BNO   @RF00175                                            0175 00323000
*         DO;                                                      0176 00324000
*           DCBPTR=ADDR(WRREMCDS);  /* SET UP WRITE DCB PTR          */ 00325000
         LA    DCBPTR,WRREMCDS                                     0177 00326000
*         END;                                                     0178 00327000
*       ELSE                        /* OTHERWISE SET UP LOCAL        */ 00328000
*         DO;                                                      0179 00329000
         B     @RC00175                                            0179 00330000
@RF00175 DS    0H                                                  0180 00331000
*           DCBPTR=ADDR(WRLOCCDS);  /* CDS PTR                       */ 00332000
         LA    DCBPTR,WRLOCCDS                                     0180 00333000
*         END;                                                     0181 00334000
*       GEN;                                                       0182 00335000
@RC00175 DS    0H                                                  0182 00336000
               OPEN  ((DCBPTR),(OUTPUT)) /*OPEN IT UP AGAIN          */ 00337000
               TM    OPENFLAG(DCBPTR),GOODOPEN /*CK IF OPEN OK       */ 00338000
               BZ    I009CER1           /*ERROR-BR                   */ 00339000
*     END;                                                         0183 00340000
*   GEN(BAL LINKR,I009CWRT);        /* GO WRITE CDS RECORDS          */ 00341000
@RC00169 DS    0H                                                  0184 00342000
         BAL LINKR,I009CWRT                                             00343000
*   STOWTTR=TTRZSAV(1:3);           /* SET UP MEMBR PTR IN DIRCTY    */ 00344000
         MVC   STOWTTR(3),TTRZSAV                                  0185 00345000
*   GEN;                                                           0186 00346000
*                                       /*                              00347000
         STOW  (DCBPTR),STOWCON,R         REPLACE DIRCTY ENTRY       */ 00348000
*   IF R15=12 THEN                  /* IF RET CODE EQ 12 THEN        */ 00349000
         LA    @12,12                                              0187 00350000
         CR    R15,@12                                             0187 00351000
         BE    @RT00187                                            0187 00352000
*     GOTO I009CER2;                /* GO PRINT ERROR-NO SPACE       */ 00353000
*   IF R15>12 THEN                  /* IF RET CODE IS GREATER 12     */ 00354000
         CR    R15,@12                                             0189 00355000
         BH    @RT00189                                            0189 00356000
*     GOTO I009CER3;                /* THEN GO PRT I/O ERROR         */ 00357000
*                                                                  0190 00358000
*   /*****************************************************************/ 00359000
*   /*                                                               */ 00360000
*   /* TCEC MSGN(562) INVOKED                                        */ 00361000
*   /*                                                               */ 00362000
*   /*****************************************************************/ 00363000
*                                                                  0191 00364000
*   $TCECM='1'B;                    /* SET TCEC SW IN RCA            */ 00365000
         OI    $TCECM(WAPTR),B'00000001'                           0191 00366000
*   R1=ADDR($TCA16);                /* SET UP PARM LIST $TR          */ 00367000
         LA    R1,$TCA16                                           0192 00368000
*   CALL #EXIT;                     /* CALL CECOM                    */ 00369000
         L     @15,#EXITA(,WAPTR)                                  0193 00370000
         BALR  @14,@15                                             0193 00371000
*   DCL                                                            0194 00372000
*     1 $TCA16,                     /* TCEC PARM LIST                */ 00373000
*      2 $TCB16 FIXED(32) INIT(562),/* MSG NUMBER                    */ 00374000
*      2 $TCC16 FIXED(32) INIT(0),  /* INCT LEN                      */ 00375000
*      2 $TCD16 BIT(8) INIT('00000000'B),/* FLAG                     */ 00376000
*      2 $TCE16 CHAR(4) INIT('FFFFFFFF'X);/* MSSAGE MASK CDS ADDED TO   00377000
*                                      LIBRARY                       */ 00378000
*   GOTO I009CRET;                  /* RETURN TO CALLER              */ 00379000
         B     I009CRET                                            0195 00380000
*   GEN(EJECT);                                                    0196 00381000
         EJECT                                                          00382000
*I009CER1:                                                         0197 00383000
*   IF $REMSW='1'B                  /* IF ITS A REMOTE REQ THEN      */ 00384000
*     THEN                                                         0197 00385000
I009CER1 TM    $REMSW(WAPTR),B'01000000'                           0197 00386000
         BNO   @RF00197                                            0197 00387000
*     DO;                                                          0198 00388000
*       $INBUFR(1:8)=CDSREMDD;      /* SET UP REM DD CARD NAME       */ 00389000
         MVC   $INBUFR(8,WAPTR),CDSREMDD                           0199 00390000
*     END;                          /* IN THE ERROR MSG              */ 00391000
*   ELSE                            /* OTHERWISE                     */ 00392000
*     DO;                           /* SET UP THE                    */ 00393000
         B     @RC00197                                            0201 00394000
@RF00197 DS    0H                                                  0202 00395000
*       $INBUFR(1:8)=CDSLOCDD;      /* LOCAL DD CARD NAME            */ 00396000
         MVC   $INBUFR(8,WAPTR),CDSLOCDD                           0202 00397000
*     END;                                                         0203 00398000
*                                                                  0203 00399000
*   /*****************************************************************/ 00400000
*   /*                                                               */ 00401000
*   /* TCEC MSGN(901)SUB(YES) INVOKED                                */ 00402000
*   /*                                                               */ 00403000
*   /*****************************************************************/ 00404000
*                                                                  0204 00405000
*   $TCECM='1'B;                    /* SET TCEC SW IN RCA            */ 00406000
@RC00197 OI    $TCECM(WAPTR),B'00000001'                           0204 00407000
*   R1=ADDR($TCA17);                /* SET UP PARM LIST $TR          */ 00408000
         LA    R1,$TCA17                                           0205 00409000
*   CALL #EXIT;                     /* CALL CECOM                    */ 00410000
         L     @15,#EXITA(,WAPTR)                                  0206 00411000
         BALR  @14,@15                                             0206 00412000
*   DCL                                                            0207 00413000
*     1 $TCA17,                     /* TCEC PARM LIST                */ 00414000
*      2 $TCB17 FIXED(32) INIT(901),/* MSG NUMBER                    */ 00415000
*      2 $TCC17 FIXED(32) INIT(0),  /* INCT LEN                      */ 00416000
*      2 $TCD17 BIT(8) INIT('10000000'B),/* FLAG                     */ 00417000
*      2 $TCE17 CHAR(4) INIT('FFFFFFFF'X);/* MSSAGE MASK PRT XXXX DO    00418000
*                                      FAILED TO OPEN                */ 00419000
*   GOTO I009CRET;                  /* RETURN TO CALLER              */ 00420000
         B     I009CRET                                            0208 00421000
*I009CER2:                                                         0209 00422000
*                                                                  0209 00423000
*   /*****************************************************************/ 00424000
*   /*                                                               */ 00425000
*   /* TCEC MSGN(571) INVOKED                                        */ 00426000
*   /*                                                               */ 00427000
*   /*****************************************************************/ 00428000
*                                                                  0209 00429000
*   $TCECM='1'B;                    /* SET TCEC SW IN RCA            */ 00430000
I009CER2 OI    $TCECM(WAPTR),B'00000001'                           0209 00431000
*   R1=ADDR($TCA18);                /* SET UP PARM LIST $TR          */ 00432000
         LA    R1,$TCA18                                           0210 00433000
*   CALL #EXIT;                     /* CALL CECOM                    */ 00434000
         L     @15,#EXITA(,WAPTR)                                  0211 00435000
         BALR  @14,@15                                             0211 00436000
*   DCL                                                            0212 00437000
*     1 $TCA18,                     /* TCEC PARM LIST                */ 00438000
*      2 $TCB18 FIXED(32) INIT(571),/* MSG NUMBER                    */ 00439000
*      2 $TCC18 FIXED(32) INIT(0),  /* INCT LEN                      */ 00440000
*      2 $TCD18 BIT(8) INIT('00000000'B),/* FLAG                     */ 00441000
*      2 $TCE18 CHAR(4) INIT('FFFFFFFF'X);/* MSSAGE MASK LIBRARY FULL*/ 00442000
*   GOTO I009CRET;                  /* RETURN TO CALLER              */ 00443000
         B     I009CRET                                            0213 00444000
*I009CER3:                                                         0214 00445000
*   GEN;                                                           0214 00446000
*                                                                  0214 00447000
I009CER3 DS    0H                                                  0214 00448000
               POINT (DCBPTR),TTRZSAV   /*THEN POINT TO BEGINNING    */ 00449000
*   /*****************************************************************/ 00450000
*   /*                                                               */ 00451000
*   /* TCEC MSGN(570) INVOKED                                        */ 00452000
*   /*                                                               */ 00453000
*   /*****************************************************************/ 00454000
*                                                                  0215 00455000
*   $TCECM='1'B;                    /* SET TCEC SW IN RCA            */ 00456000
         OI    $TCECM(WAPTR),B'00000001'                           0215 00457000
*   R1=ADDR($TCA19);                /* SET UP PARM LIST $TR          */ 00458000
         LA    R1,$TCA19                                           0216 00459000
*   CALL #EXIT;                     /* CALL CECOM                    */ 00460000
         L     @15,#EXITA(,WAPTR)                                  0217 00461000
         BALR  @14,@15                                             0217 00462000
*   DCL                                                            0218 00463000
*     1 $TCA19,                     /* TCEC PARM LIST                */ 00464000
*      2 $TCB19 FIXED(32) INIT(570),/* MSG NUMBER                    */ 00465000
*      2 $TCC19 FIXED(32) INIT(0),  /* INCT LEN                      */ 00466000
*      2 $TCD19 BIT(8) INIT('00000000'B),/* FLAG                     */ 00467000
*      2 $TCE19 CHAR(4) INIT('FFFFFFFF'X);/* MSSAGE MASK I/O ERROR   */ 00468000
*   GOTO I009CRET;                  /* GO RETURN TO CALLER           */ 00469000
         B     I009CRET                                            0219 00470000
*I009CER4:                                                         0220 00471000
*                                                                  0220 00472000
*   /*****************************************************************/ 00473000
*   /*                                                               */ 00474000
*   /* TCEC MSGN(569) INVOKED                                        */ 00475000
*   /*                                                               */ 00476000
*   /*****************************************************************/ 00477000
*                                                                  0220 00478000
*   $TCECM='1'B;                    /* SET TCEC SW IN RCA            */ 00479000
I009CER4 OI    $TCECM(WAPTR),B'00000001'                           0220 00480000
*   R1=ADDR($TCA20);                /* SET UP PARM LIST $TR          */ 00481000
         LA    R1,$TCA20                                           0221 00482000
*   CALL #EXIT;                     /* CALL CECOM                    */ 00483000
         L     @15,#EXITA(,WAPTR)                                  0222 00484000
         BALR  @14,@15                                             0222 00485000
*   DCL                                                            0223 00486000
*     1 $TCA20,                     /* TCEC PARM LIST                */ 00487000
*      2 $TCB20 FIXED(32) INIT(569),/* MSG NUMBER                    */ 00488000
*      2 $TCC20 FIXED(32) INIT(0),  /* INCT LEN                      */ 00489000
*      2 $TCD20 BIT(8) INIT('00000000'B),/* FLAG                     */ 00490000
*      2 $TCE20 CHAR(4) INIT('FFFFFFFF'X);/* MSSAGE MASK UNABLE TO 0223 00491000
*                                      DELETE CDS                    */ 00492000
*   GOTO I009CRET;                  /* RETURN TO CONTROL MODULE      */ 00493000
         B     I009CRET                                            0224 00494000
*   GEN(EJECT);                                                    0225 00495000
         EJECT                                                          00496000
*I009CRET:                                                         0226 00497000
*   GEN;                                                           0226 00498000
I009CRET DS    0H                                                  0226 00499000
*                                       /*                              00500000
         CLOSE ((DCBPTR))                 CLOSE CDS                 */  00501000
*   $REMSW='0'B;                    /* RESET REMOTE SW               */ 00502000
         NI    $REMSW(WAPTR),B'10111111'                           0227 00503000
*   $CHANGE='0'B;                   /* RESET CHANGE SW               */ 00504000
         NI    $CHANGE(WAPTR),B'11011111'                          0228 00505000
*   $COPY='0'B;                     /* RESET COPY SW                 */ 00506000
         NI    $COPY(WAPTR),B'11110111'                            0229 00507000
*   RETURN;                         /* RETURN TO CALLER              */ 00508000
@EL00001 L     @13,4(,@13)                                         0230 00509000
@EF00001 DS    0H                                                  0230 00510000
@ER00001 L     @14,12(,@13)                                        0230 00511000
         LM    @00,@12,20(@13)                                     0230 00512000
         BR    @14                                                 0230 00513000
*   GEN(EJECT);                                                    0231 00514000
*                                                                  0231 00515000
         EJECT                                                          00516000
*/********************************************************************/ 00517000
*/*                     R E A D   R O U T I N E                      */ 00518000
*/*                                                                  */ 00519000
*/*  THIS ROUTINE WILL READ THE ESD & TXTHDR RECORD INTO CORR AND    */ 00520000
*/*  SAVE THEIR STARTING ADDRESS                                     */ 00521000
*/*                                                                  */ 00522000
*/********************************************************************/ 00523000
*                                                                  0232 00524000
*I009CRD:                                                          0232 00525000
*   RETSAV=LINKR;                   /* SAVE RETURN PTR               */ 00526000
I009CRD  ST    LINKR,RETSAV                                        0232 00527000
*   IF $REMSW='1'B THEN             /* IF THIS IS A REMOTE REQ       */ 00528000
         TM    $REMSW(WAPTR),B'01000000'                           0233 00529000
         BO    @RT00233                                            0233 00530000
*     GOTO I009CRD1;                /* THEN BR AROUND                */ 00531000
*   GEN;                                                           0235 00532000
*                                       /*                              00533000
          OPEN ((DCBPTR),(UPDAT))         OPEN LOCAL DCB                00534000
          TM   OPENFLAG(DCBPTR),GOODOPEN  DID IT OPEN                   00535000
          BZ   I009CER1                   NO-ERROR                      00536000
          B    I009CRD3                   BR-AROUND                     00537000
*I009CRD1:                                                         0236 00538000
*   GEN;                                                           0236 00539000
I009CRD1 DS    0H                                                  0236 00540000
*                                       /*                              00541000
          OPEN ((DCBPTR),(UPDAT))         OPEN REMOTE DCB               00542000
          TM   OPENFLAG(DCBPTR),GOODOPEN  DID IT OPEN                   00543000
         BZ    I009CER1                   NO-ERROR                      00544000
I009CRD3 DS   0H                                                        00545000
          FIND (DCBPTR),(NAMEPTR),D       LOOK FOR REQUESTED MEMBER     00546000
          LTR  R15,R15                    WAS FIND SUCCESSFUL           00547000
          BNZ  I009C01B                   NO-BR                         00548000
          READ CDSDECB,SF,(DCBPTR),ESDREC,80,MF=E READ ESD RECORD       00549000
          CHECK  CDSDECB                  WAIT FOR I/O COMPLETION       00550000
          NOTE (DCBPTR)                   GET PTR TO ESD REC            00551000
          ST   PARMREG1,TTRZSAV           SAVE START ADR OF ESD         00552000
          ST   PARMREG1,TTRZ              SAVE START ADR TO TXTHDR      00553000
          MVI  TTRZ+3,X'01'               SET UP TO READ NXT REACORD    00554000
          POINT (DCBPTR),TTRZ             SET UP TO RD NXT REC          00555000
          READ CDSDECB,SF,(DCBPTR),TXTHDR,80,MF=E READ TXTHDR RECORD    00556000
          CHECK  CDSDECB                  WAIT FOR I/O COMPLETION       00557000
          NOTE (DCBPTR)                   SET UP PTR TO NXT RECORD      00558000
          ST   PARMREG1,TTRZ              SAVE START ADR TO CDSREC      00559000
          MVI  TTRZ+3,X'01'               SET UP READ NXT RECORD        00560000
          POINT (DCBPTR),TTRZ             SET UP READ DCB               00561000
*   CDSRPTR=ADDR(CDSUA);            /* GET PTR TO READ BUFFER        */ 00562000
         L     CDSRPTR,CDSWKPTR                                    0237 00563000
*   GEN;                                                           0238 00564000
*                                       /*                              00565000
          SR   CDSRLREG,CDSRLREG          ZERO WK REG                   00566000
          IC   CDSRLREG,TXTHCNT+2         GET LEN OF CDSREC             00567000
          READ CDSDECB,SF,(DCBPTR),(CDSRPTR),(CDSRLREG),MF=E            00568000
          CHECK  CDSDECB                  WAIT FOR I/O COMPLETION       00569000
*I009CRD4:                                                         0239 00570000
*   GEN;                                                           0239 00571000
I009CRD4 DS    0H                                                  0239 00572000
*                                            /*                         00573000
          L    LINKR,RETSAV               GET RETURN ADDR               00574000
          BR   LINKR                      RETURN TO CALLER              00575000
          EJECT                                                         00576000
*                                                                  0240 00577000
*/********************************************************************/ 00578000
*/*                      W R I T E  R O U T I N E                    */ 00579000
*/*                                                                  */ 00580000
*/*  THIS ROUTINE WILL WRITE THE ESD RECORD, TXTHDR RECORD, CDS      */ 00581000
*/*  RECORD AND THE END RECORD                                       */ 00582000
*/*                                                                  */ 00583000
*/********************************************************************/ 00584000
*                                                                  0240 00585000
*I009CWRT:                                                         0240 00586000
*   RETSAV=LINKR;                   /* SAVE RETURN ADDR PTR          */ 00587000
I009CWRT ST    LINKR,RETSAV                                        0240 00588000
*   ESDSIZE=CDSBYTCT;               /* PUT CDS BYTE COUNT IN ESD     */ 00589000
         L     @15,CDSWKPTR                                        0241 00590000
         SLR   @12,@12                                             0241 00591000
         IC    @12,CDSBYTCT(,@15)                                  0241 00592000
         STC   @12,ESDSIZE                                         0241 00593000
*   TXTHCNT(3:3)=CDSBYTCT;          /* PUT CDS BYTE CNT IN TXTHDR    */ 00594000
         STC   @12,TXTHCNT+2                                       0242 00595000
*   TXTHNAME=TXTHDRNM;              /* INDICATE TOLTEP CHANGED CDS   */ 00596000
         MVC   TXTHNAME(9),TXTHDRNM                                0243 00597000
*I009CWR1:                                                         0244 00598000
*   GEN;                                                           0244 00599000
I009CWR1 DS    0H                                                  0244 00600000
*                                       /*                              00601000
         WRITE CDSDECB,SF,(DCBPTR),ESDREC,80,MF=E  WRITE ESD RECORD     00602000
         CHECK CDSDECB                    WAIT FOR I/O COMPLETION       00603000
         NOTE  (DCBPTR)                   SAVE BEGINNING ADDRESS IN     00604000
         ST    PARMREG1,TTRZSAV           CASE OF AN ERROR              00605000
         WRITE CDSDECB,SF,(DCBPTR),TXTHDR,80,MF=E  WRITE TXTHDR RECORD  00606000
         CHECK CDSDECB                    WAIT FOR I/O COMPLETION       00607000
*   CDSRPTR=ADDR(CDSUA);            /* GET PTR TO CDS RECORD         */ 00608000
         L     CDSRPTR,CDSWKPTR                                    0245 00609000
*I009CWR2:                                                         0246 00610000
*   GEN(XC CDSRECL,CDSRECL);        /* ZERO OUT REC LENGTH AREA      */ 00611000
I009CWR2 XC CDSRECL,CDSRECL                                             00612000
*   CDSRECL(2:2)=CDSBYTCT;          /* SET UP CDSREC LEN FOR WRITE   */ 00613000
         L     @15,CDSWKPTR                                        0247 00614000
         MVC   CDSRECL+1(1),CDSBYTCT(@15)                          0247 00615000
*   GEN;                                                           0248 00616000
*                                       /*                              00617000
         SR  CDSRLREG,CDSRLREG            ZERO OUT WORK REG             00618000
         LH  CDSRLREG,CDSRECL             PUT CDS REC LN IN REG         00619000
         WRITE CDSDECB,SF,(DCBPTR),(CDSRPTR),(CDSRLREG),MF=E WRT CDSREC 00620000
         CHECK CDSDECB                    WAIT FOR I/O COMPLETION       00621000
*   IF $CHANGE='1'B                 /* IF ITS A CHANGE REQUEST       */ 00622000
*     THEN                          /* THEN CHECK TO SEE IF ITS      */ 00623000
         TM    $CHANGE(WAPTR),B'00100000'                          0249 00624000
         BNO   @RF00249                                            0249 00625000
*     DO;                           /* A CHANGE IN PLACE             */ 00626000
*       IF CDSBYTCT¬>OLDCDSLN THEN  /* IF YES THEN BR AROUND         */ 00627000
         L     @15,CDSWKPTR                                        0251 00628000
         CLC   CDSBYTCT(1,@15),OLDCDSLN                            0251 00629000
         BNH   @RT00251                                            0251 00630000
*         GOTO I009CRET;            /* NEXT WRITE                    */ 00631000
*     END;                                                         0253 00632000
*   GEN;                                                           0254 00633000
@RF00249 DS    0H                                                  0254 00634000
         WRITE CDSDECB,SF,(DCBPTR),ENDREC,80,MF=E  WRITE END RECORD     00635000
         CHECK CDSDECB                    WAIT FOR I/O COMPLETION       00636000
         L     LINKR,RETSAV               RETURN TO                     00637000
         BR    LINKR                        CALLER                      00638000
         EJECT                                                          00639000
*                                                                  0255 00640000
*/********************************************************************/ 00641000
*/*        D A T A  C O N T R O L  B L O C K S                       */ 00642000
*/********************************************************************/ 00643000
*                                                                  0255 00644000
*   GEN;                                                           0255 00645000
RDREMCDS   DS    0F                                                     00646000
         DCB   DDNAME=SYMSYM,DSORG=PO,RECFM=UT,MACRF=(R,W),            X00647000
               LRECL=80,BLKSIZE=3600,SYNAD=I009CER3,EODAD=I009CRD4      00648000
          SPACE                                                         00649000
RDLOCCDS   DS    0F                                                     00650000
         DCB   DDNAME=OLTCDSDD,DSORG=PO,RECFM=UT,MACRF=(R,W),          X00651000
               LRECL=80,BLKSIZE=3600,SYNAD=I009CER3,EODAD=I009CRD4      00652000
          SPACE                                                         00653000
WRREMCDS   DS    0F                                                     00654000
         DCB   DDNAME=SYMSYM,DSORG=PO,RECFM=UT,MACRF=(R,W),            X00655000
               LRECL=80,BLKSIZE=3600,SYNAD=I009CER3                     00656000
          SPACE                                                         00657000
WRLOCCDS DS    0F                                                       00658000
         DCB   DDNAME=OLTCDSDD,DSORG=PO,RECFM=UT,MACRF=(R,W),          X00659000
               LRECL=80,BLKSIZE=3600,SYNAD=I009CER3                     00660000
          SPACE                                                         00661000
         WRITE CDSDECB,SF,MF=L                                          00662000
          SPACE                                                         00663000
*   DO;                             /* ATDSPLY                       */ 00664000
*   END;                            /* ATDSPLY                       */ 00665000
*   END ISTIC009;                                                  0258 00666000
         B     @EL00001                                            0258 00667000
@DATA    DS    0H                                                       00668000
@CH00081 DC    H'12'                                                    00669000
@CH00075 DC    H'80'                                                    00670000
         DS    0F                                                       00671000
@SA00001 DS    18F                                                      00672000
         DS    0F                                                       00673000
@CV00771 DC    V(ISTSC029)                                              00674000
@CV00793 DC    V(ISTSC021)                                              00675000
@CV00795 DC    V(ISTIC00A)                                              00676000
@CV00798 DC    V(S20CEC03)                                              00677000
         DS    0D                                                       00678000
CDSWKPTR DS    A                                                        00679000
RCAPTR   DS    A                                                        00680000
CECMAP   DS    A                                                        00681000
TTRZ     DS    F                                                        00682000
RETSAV   DS    CL4                                                      00683000
WKAREA2  DS    CL20                                                     00684000
CDSRECL  DS    CL2                                                      00685000
         DS    CL2                                                      00686000
TTRZSAV  DS    CL4                                                      00687000
OLDCDSLN DS    CL1                                                      00688000
BLANK    DC    CL1' '                                                   00689000
TXTHDRNM DC    CL9'VS TOLTEP'                                           00690000
CDSLOCDD DC    CL8'OLTCDSDD'                                            00691000
CDSREMDD DC    CL8'SYMSYM  '                                            00692000
UANAME   DC    CL1'G'                                                   00693000
STOWCON  DS    CL32                                                     00694000
         ORG   STOWCON                                                  00695000
STOWNAME DS    CL8                                                      00696000
STOWTTR  DS    CL3                                                      00697000
STOWUSSZ DC    X'0A'                                                    00698000
STOWUSRI DC    20X'00'                                                  00699000
         ORG   STOWCON+32                                               00700000
ESDREC   DS    CL80                                                     00701000
         ORG   ESDREC                                                   00702000
@NM00001 DC    X'02'                                                    00703000
@NM00002 DC    CL3'ESD'                                                 00704000
@NM00003 DC    X'00'                                                    00705000
         DC    XL11'0'                                                  00706000
ESDNME1  DS    CL8                                                      00707000
@NM00004 DC    X'00'                                                    00708000
         DC    XL6'0'                                                   00709000
ESDSIZE  DS    CL1                                                      00710000
ESDNME2  DC    CL8'#OLT00'                                              00711000
@NM00005 DC    X'00'                                                    00712000
         DC    XL7'0'                                                   00713000
ESDNME3  DC    CL8'#CTLCAAA'                                            00714000
@NM00006 DC    X'00'                                                    00715000
         DC    XL23'0'                                                  00716000
         ORG   ESDREC+80                                                00717000
TXTHDR   DS    CL80                                                     00718000
         ORG   TXTHDR                                                   00719000
@NM00007 DC    X'02'                                                    00720000
@NM00008 DC    CL6'TXTHDR'                                              00721000
TXTHNAME DC    CL9'VS TOLTEP'                                           00722000
TXTHCCW  DS    CL8                                                      00723000
         ORG   TXTHCCW                                                  00724000
@NM00009 DC    X'02'                                                    00725000
THRELADR DC    X'000000'                                                00726000
@NM00010 DC    X'20'                                                    00727000
TXTHCNT  DC    X'000000'                                                00728000
         ORG   TXTHDR+24                                                00729000
@NM00011 DC    X'00'                                                    00730000
         DC    XL55'0'                                                  00731000
         ORG   TXTHDR+80                                                00732000
ENDREC   DS    CL80                                                     00733000
         ORG   ENDREC                                                   00734000
@NM00012 DC    X'02'                                                    00735000
@NM00013 DC    CL3'END'                                                 00736000
@NM00014 DC    CL72' '                                                  00737000
@NM00015 DC    CL4'0003'                                                00738000
         ORG   ENDREC+80                                                00739000
ZZZGTPRM DS    CL13                                                     00740000
         ORG   ZZZGTPRM                                                 00741000
@NM00068 DC    X'0102F1F6'                                              00742000
ZZZGTCD  DS    AL4                                                      00743000
ZZZGTAD  DS    AL4                                                      00744000
ZZZGTCT  DS    FL1                                                      00745000
         ORG   ZZZGTPRM+13                                              00746000
         DS    CL3                                                      00747000
$TCA10   DS    CL13                                                     00748000
         ORG   $TCA10                                                   00749000
$TCB10   DC    A(572)                                                   00750000
$TCC10   DC    A(0)                                                     00751000
$TCD10   DC    B'00000000'                                              00752000
$TCE10   DC    X'FFFFFFFF'                                              00753000
         ORG   $TCA10+13                                                00754000
         DS    CL3                                                      00755000
ITATCPRM DS    CL14                                                     00756000
         ORG   ITATCPRM                                                 00757000
@NM00069 DC    X'0102F4F1'                                              00758000
ITATCFR  DS    AL4                                                      00759000
ITATCTO  DS    AL4                                                      00760000
@NM00070 DC    AL1(0)                                                   00761000
         ORG   @NM00070                                                 00762000
ITATCTP  DS    BL1                                                      00763000
         ORG   ITATCPRM+13                                              00764000
ITATCNT  DS    FL1                                                      00765000
         ORG   ITATCPRM+14                                              00766000
         DS    CL2                                                      00767000
$TCA13   DS    CL13                                                     00768000
         ORG   $TCA13                                                   00769000
$TCB13   DC    A(576)                                                   00770000
$TCC13   DC    A(0)                                                     00771000
$TCD13   DC    B'00000000'                                              00772000
$TCE13   DC    X'40000000'                                              00773000
         ORG   $TCA13+13                                                00774000
         DS    CL3                                                      00775000
$TCA15   DS    CL13                                                     00776000
         ORG   $TCA15                                                   00777000
$TCB15   DC    A(581)                                                   00778000
$TCC15   DC    A(0)                                                     00779000
$TCD15   DC    B'00000000'                                              00780000
$TCE15   DC    X'00400000'                                              00781000
         ORG   $TCA15+13                                                00782000
         DS    CL3                                                      00783000
$TCA16   DS    CL13                                                     00784000
         ORG   $TCA16                                                   00785000
$TCB16   DC    A(562)                                                   00786000
$TCC16   DC    A(0)                                                     00787000
$TCD16   DC    B'00000000'                                              00788000
$TCE16   DC    X'FFFFFFFF'                                              00789000
         ORG   $TCA16+13                                                00790000
         DS    CL3                                                      00791000
$TCA17   DS    CL13                                                     00792000
         ORG   $TCA17                                                   00793000
$TCB17   DC    A(901)                                                   00794000
$TCC17   DC    A(0)                                                     00795000
$TCD17   DC    B'10000000'                                              00796000
$TCE17   DC    X'FFFFFFFF'                                              00797000
         ORG   $TCA17+13                                                00798000
         DS    CL3                                                      00799000
$TCA18   DS    CL13                                                     00800000
         ORG   $TCA18                                                   00801000
$TCB18   DC    A(571)                                                   00802000
$TCC18   DC    A(0)                                                     00803000
$TCD18   DC    B'00000000'                                              00804000
$TCE18   DC    X'FFFFFFFF'                                              00805000
         ORG   $TCA18+13                                                00806000
         DS    CL3                                                      00807000
$TCA19   DS    CL13                                                     00808000
         ORG   $TCA19                                                   00809000
$TCB19   DC    A(570)                                                   00810000
$TCC19   DC    A(0)                                                     00811000
$TCD19   DC    B'00000000'                                              00812000
$TCE19   DC    X'FFFFFFFF'                                              00813000
         ORG   $TCA19+13                                                00814000
         DS    CL3                                                      00815000
$TCA20   DS    CL13                                                     00816000
         ORG   $TCA20                                                   00817000
$TCB20   DC    A(569)                                                   00818000
$TCC20   DC    A(0)                                                     00819000
$TCD20   DC    B'00000000'                                              00820000
$TCE20   DC    X'FFFFFFFF'                                              00821000
         ORG   $TCA20+13                                                00822000
NAME     DS    CL8                                                      00823000
WKAREA   DS    CL8                                                      00824000
         DS    CL3                                                      00825000
PATCH    DC    40F'0'                                                   00826000
@00      EQU   00                      EQUATES FOR REGISTERS 0-15       00827000
@01      EQU   01                                                       00828000
@02      EQU   02                                                       00829000
@03      EQU   03                                                       00830000
@04      EQU   04                                                       00831000
@05      EQU   05                                                       00832000
@06      EQU   06                                                       00833000
@07      EQU   07                                                       00834000
@08      EQU   08                                                       00835000
@09      EQU   09                                                       00836000
@10      EQU   10                                                       00837000
@11      EQU   11                                                       00838000
@12      EQU   12                                                       00839000
@13      EQU   13                                                       00840000
@14      EQU   14                                                       00841000
@15      EQU   15                                                       00842000
LINKR    EQU   @14                                                      00843000
DCBPTR   EQU   @05                                                      00844000
CDSRPTR  EQU   @04                                                      00845000
WKREG1   EQU   @04                                                      00846000
CDSRLREG EQU   @06                                                      00847000
NAMEPTR  EQU   @06                                                      00848000
WAPTR    EQU   @02                                                      00849000
R1       EQU   @01                                                      00850000
R15      EQU   @15                                                      00851000
PARMREG1 EQU   @01                                                      00852000
R0       EQU   @00                                                      00853000
R10      EQU   @10                                                      00854000
R11      EQU   @11                                                      00855000
R12      EQU   @12                                                      00856000
R13      EQU   @13                                                      00857000
R14      EQU   @14                                                      00858000
R2       EQU   @02                                                      00859000
R3       EQU   @03                                                      00860000
R4       EQU   @04                                                      00861000
R5       EQU   @05                                                      00862000
R6       EQU   @06                                                      00863000
R7       EQU   @07                                                      00864000
R8       EQU   @08                                                      00865000
R9       EQU   @09                                                      00866000
$RCAAREA EQU   0                                                        00867000
$POINTER EQU   $RCAAREA+100                                             00868000
$TRTBLA  EQU   $POINTER+124                                             00869000
$CONSTNT EQU   $RCAAREA+244                                             00870000
$RCAFLG  EQU   $RCAAREA+604                                             00871000
TOLTEPWA EQU   0                                                        00872000
$SCTTBLE EQU   TOLTEPWA                                                 00873000
$TESTOPT EQU   $SCTTBLE+2                                               00874000
$ERROPT  EQU   $SCTTBLE+3                                               00875000
$PDEVFLG EQU   $SCTTBLE+10                                              00876000
$CDSFLGS EQU   $SCTTBLE+11                                              00877000
$CDS8T19 EQU   $SCTTBLE+20                                              00878000
$EXECFLG EQU   $SCTTBLE+33                                              00879000
$OLTFLGS EQU   $SCTTBLE+36                                              00880000
$OLTFLG2 EQU   $SCTTBLE+37                                              00881000
$TOTFLG1 EQU   $SCTTBLE+38                                              00882000
$ROUTMSK EQU   $SCTTBLE+40                                              00883000
$CDA     EQU   TOLTEPWA+100                                             00884000
$RCA     EQU   $CDA+44                                                  00885000
$OLTPTR  EQU   $CDA+52                                                  00886000
$LOWADDR EQU   $OLTPTR                                                  00887000
$HIMOREC EQU   $CDA+60                                                  00888000
$COMMFLG EQU   TOLTEPWA+224                                             00889000
$FLAG1   EQU   $COMMFLG                                                 00890000
$FLAG2   EQU   $COMMFLG+1                                               00891000
$FLAG3   EQU   $COMMFLG+2                                               00892000
$FLAG4   EQU   $COMMFLG+3                                               00893000
$FLAG5   EQU   $COMMFLG+4                                               00894000
$EOJ     EQU   $FLAG5                                                   00895000
$CANCEL  EQU   $EOJ                                                     00896000
$FLAG6   EQU   $COMMFLG+5                                               00897000
$CHANGE  EQU   $FLAG6                                                   00898000
$ABNDBIT EQU   $FLAG6                                                   00899000
$FLAG7   EQU   $COMMFLG+6                                               00900000
$FLAG8   EQU   $COMMFLG+7                                               00901000
$TCECM   EQU   $FLAG8                                                   00902000
$FLAG9   EQU   $COMMFLG+8                                               00903000
$REMSW   EQU   $FLAG9                                                   00904000
$COPY    EQU   $FLAG9                                                   00905000
$FLAG10  EQU   $COMMFLG+9                                               00906000
$FLAG11  EQU   $COMMFLG+10                                              00907000
$FLAG12  EQU   $COMMFLG+11                                              00908000
$FLAG13  EQU   $COMMFLG+12                                              00909000
$DEVTBLE EQU   TOLTEPWA+240                                             00910000
$DEVCDS  EQU   $DEVTBLE                                                 00911000
$DEVUNAD EQU   $DEVCDS                                                  00912000
@NM00054 EQU   $DEVUNAD+2                                               00913000
$DEVFEAT EQU   $DEVCDS+4                                                00914000
$DEVCDSF EQU   $DEVCDS+9                                                00915000
$DEVSDCF EQU   $DEVCDS+10                                               00916000
$$SYMNME EQU   $DEVCDS+12                                               00917000
$DEVFLG1 EQU   $DEVTBLE+20                                              00918000
$EVNCPLT EQU   $DEVFLG1                                                 00919000
$ATTNEXP EQU   $DEVFLG1                                                 00920000
$INTOCC  EQU   $DEVFLG1                                                 00921000
$DEVFLG2 EQU   $DEVTBLE+21                                              00922000
$DEVTECB EQU   $DEVTBLE+22                                              00923000
$OPIS    EQU   $DEVTECB                                                 00924000
$OPND    EQU   $DEVTECB+2                                               00925000
$DEVFLG3 EQU   $DEVTBLE+27                                              00926000
$SIOFLG  EQU   $DEVFLG3                                                 00927000
$IFTOUT  EQU   $DEVTBLE+36                                              00928000
$DEVSESP EQU   $IFTOUT                                                  00929000
$SSCPDAF EQU   $IFTOUT+6                                                00930000
$LDNCBPT EQU   $DEVTBLE+48                                              00931000
$RNINFO  EQU   $DEVTBLE+56                                              00932000
$DEVFLG5 EQU   $RNINFO+8                                                00933000
$DEVFLG4 EQU   $DEVTBLE+65                                              00934000
$SLTBL   EQU   TOLTEPWA+1468                                            00935000
$RUNTEST EQU   $SLTBL+13                                                00936000
$TESTFLG EQU   $SLTBL+21                                                00937000
$SECLST  EQU   $SLTBL+22                                                00938000
$INBUFR  EQU   TOLTEPWA+2104                                            00939000
#EXITA   EQU   TOLTEPWA+2632                                            00940000
$CCOMDAT EQU   TOLTEPWA+2644                                            00941000
$CFLGS   EQU   $CCOMDAT+16                                              00942000
$24FEMSG EQU   TOLTEPWA+2681                                            00943000
$24CATMG EQU   $24FEMSG+11                                              00944000
@NM00063 EQU   TOLTEPWA+2776                                            00945000
$OUNTPTR EQU   @NM00063+4                                               00946000
$NSPTR   EQU   $OUNTPTR                                                 00947000
$NSCNT   EQU   @NM00063+10                                              00948000
$ENXX    EQU   @NM00063+15                                              00949000
$IMITX   EQU   $ENXX                                                    00950000
SVESC033 EQU   TOLTEPWA+3160                                            00951000
SVECC013 EQU   TOLTEPWA+3232                                            00952000
SVEIC003 EQU   TOLTEPWA+3592                                            00953000
SVESC022 EQU   TOLTEPWA+3736                                            00954000
SVECC011 EQU   TOLTEPWA+4024                                            00955000
#EXIT    EQU   0                                                        00956000
CECOMMAP EQU   0                                                        00957000
CDSMAP   EQU   0                                                        00958000
CDSUA    EQU   CDSMAP                                                   00959000
CDSMFCT  EQU   CDSMAP+4                                                 00960000
CDSFEAT  EQU   CDSMFCT+1                                                00961000
CDSBYTCT EQU   CDSMAP+8                                                 00962000
CDSFLAG  EQU   CDSMAP+9                                                 00963000
CDSSYMB  EQU   CDSFLAG                                                  00964000
CDSREMSY EQU   CDSFLAG                                                  00965000
CDSSYMBN EQU   CDSMAP+12                                                00966000
$TRTBL   EQU   0                                                        00967000
SVECC012 EQU   SVESC022                                                 00968000
SVEIC00A EQU   SVEIC003                                                 00969000
SVEIC004 EQU   SVEIC003                                                 00970000
SVEIC005 EQU   SVEIC003                                                 00971000
SVESC02A EQU   SVESC022                                                 00972000
SVESC02B EQU   SVESC022                                                 00973000
SVESC02D EQU   SVESC022                                                 00974000
SVESC02E EQU   SVESC022                                                 00975000
SVESC02F EQU   SVECC013                                                 00976000
SVESC024 EQU   SVESC022                                                 00977000
SVESC027 EQU   SVESC022                                                 00978000
SVESC029 EQU   SVESC033                                                 00979000
SVESC031 EQU   SVECC013                                                 00980000
SVESC032 EQU   SVECC011                                                 00981000
SVETC037 EQU   SVEIC003                                                 00982000
         AGO   .@UNREFD                START UNREFERENCED COMPONENTS    00983000
CDSEXARA EQU   CDSMAP+20                                                00984000
CDSEXTM  EQU   CDSFLAG+2                                                00985000
CDSEXTB  EQU   CDSFLAG+2                                                00986000
CDSTMERB EQU   CDSFLAG+2                                                00987000
@NM00067 EQU   CDSFLAG+1                                                00988000
CDSDVPRO EQU   CDSFLAG+1                                                00989000
CDSNTPRI EQU   CDSFLAG+1                                                00990000
CDSLINCN EQU   CDSFLAG                                                  00991000
CDS2CHAN EQU   CDSFLAG                                                  00992000
CDSEXTPR EQU   CDSFLAG                                                  00993000
CDSFEVOL EQU   CDSFLAG                                                  00994000
CDSSHAR  EQU   CDSFLAG                                                  00995000
CDSFPMD  EQU   CDSFLAG                                                  00996000
CDSTYPE  EQU   CDSMFCT+3                                                00997000
CDSCLASS EQU   CDSMFCT+2                                                00998000
@NM00066 EQU   CDSFEAT                                                  00999000
CDSDEVM  EQU   CDSFEAT                                                  01000000
CDSDEVT  EQU   CDSFEAT                                                  01001000
CDSASCII EQU   CDSFEAT                                                  01002000
CDSMODEL EQU   CDSMFCT                                                  01003000
$CECFLAG EQU   CECOMMAP+20                                              01004000
$CEINCT  EQU   CECOMMAP+16                                              01005000
$CEINADR EQU   CECOMMAP+12                                              01006000
$CEOUTCT EQU   CECOMMAP+8                                               01007000
$CEOUTAD EQU   CECOMMAP+4                                               01008000
$CECIDNT EQU   CECOMMAP+2                                               01009000
$CECLEVL EQU   CECOMMAP+1                                               01010000
$CECTRMG EQU   CECOMMAP                                                 01011000
SVECC010 EQU   TOLTEPWA+3952                                            01012000
SVETC035 EQU   TOLTEPWA+3880                                            01013000
SVESC030 EQU   TOLTEPWA+3808                                            01014000
SVESC020 EQU   TOLTEPWA+3664                                            01015000
SVEIC002 EQU   TOLTEPWA+3520                                            01016000
SVECC014 EQU   TOLTEPWA+3376                                            01017000
SVESC120 EQU   TOLTEPWA+3304                                            01018000
SVESC025 EQU   TOLTEPWA+3088                                            01019000
@NM00065 EQU   TOLTEPWA+2980                                            01020000
$RPLERR  EQU   TOLTEPWA+2977                                            01021000
@NM00064 EQU   TOLTEPWA+2976                                            01022000
$R13PR3  EQU   TOLTEPWA+2972                                            01023000
$CEINT2  EQU   TOLTEPWA+2968                                            01024000
$CEINT1  EQU   TOLTEPWA+2964                                            01025000
$MSGGET  EQU   TOLTEPWA+2960                                            01026000
$ACQLIST EQU   TOLTEPWA+2956                                            01027000
$R4SAVE1 EQU   TOLTEPWA+2952                                            01028000
$CLSISS  EQU   TOLTEPWA+2950                                            01029000
$CLSCNT  EQU   TOLTEPWA+2948                                            01030000
$CUTABLE EQU   TOLTEPWA+2868                                            01031000
$BUFSZ2  EQU   TOLTEPWA+2864                                            01032000
$RESID2  EQU   TOLTEPWA+2860                                            01033000
$OLTCCW2 EQU   TOLTEPWA+2856                                            01034000
$ENDBFR2 EQU   TOLTEPWA+2852                                            01035000
$1STBFR2 EQU   TOLTEPWA+2848                                            01036000
$TECB2   EQU   TOLTEPWA+2844                                            01037000
$BUFSZ1  EQU   TOLTEPWA+2840                                            01038000
$RESID1  EQU   TOLTEPWA+2836                                            01039000
$OLTCCW1 EQU   TOLTEPWA+2832                                            01040000
$ENDBFR1 EQU   TOLTEPWA+2828                                            01041000
$1STBFR1 EQU   TOLTEPWA+2824                                            01042000
$TECB1   EQU   TOLTEPWA+2820                                            01043000
$WAITIME EQU   TOLTEPWA+2816                                            01044000
$TRTN#   EQU   TOLTEPWA+2815                                            01045000
$WIODEV  EQU   TOLTEPWA+2814                                            01046000
$RQSTSZE EQU   TOLTEPWA+2812                                            01047000
$RQSTPTR EQU   TOLTEPWA+2808                                            01048000
$R4SAVE  EQU   TOLTEPWA+2804                                            01049000
$PARTADR EQU   TOLTEPWA+2800                                            01050000
$TBSDATA EQU   TOLTEPWA+2796                                            01051000
$CTWIDTH EQU   TOLTEPWA+2795                                            01052000
$CTLINE  EQU   TOLTEPWA+2794                                            01053000
$APWIDTH EQU   TOLTEPWA+2793                                            01054000
$APLINE  EQU   TOLTEPWA+2792                                            01055000
$INDEX   EQU   $IMITX                                                   01056000
$UMXX    EQU   @NM00063+14                                              01057000
$NSXX    EQU   @NM00063+12                                              01058000
$ATACNT  EQU   $NSCNT                                                   01059000
$CTR     EQU   @NM00063+8                                               01060000
$ATAPTR  EQU   $NSPTR                                                   01061000
$DDRPTR  EQU   @NM00063                                                 01062000
$DTORESP EQU   TOLTEPWA+2712                                            01063000
$APNAME  EQU   TOLTEPWA+2704                                            01064000
$24SYMNE EQU   $24CATMG+4                                               01065000
$24DEVAD EQU   $24CATMG                                                 01066000
$24RTN#  EQU   $24FEMSG+8                                               01067000
$ESECTID EQU   $24FEMSG                                                 01068000
$24FLGS  EQU   TOLTEPWA+2680                                            01069000
$24SAVE2 EQU   TOLTEPWA+2676                                            01070000
$24SAVE1 EQU   TOLTEPWA+2672                                            01071000
$24UNADR EQU   TOLTEPWA+2668                                            01072000
$24SAV13 EQU   TOLTEPWA+2664                                            01073000
$24RETCD EQU   TOLTEPWA+2663                                            01074000
$MACID   EQU   TOLTEPWA+2661                                            01075000
$CSPARE  EQU   $CFLGS                                                   01076000
$C2WAY   EQU   $CFLGS                                                   01077000
$CINCT   EQU   $CCOMDAT+12                                              01078000
$CINADR  EQU   $CCOMDAT+8                                               01079000
$COUTCT  EQU   $CCOMDAT+4                                               01080000
$COUTAD  EQU   $CCOMDAT                                                 01081000
ROOTLOC  EQU   TOLTEPWA+2640                                            01082000
$RETREG  EQU   TOLTEPWA+2636                                            01083000
$WORK    EQU   TOLTEPWA+2376                                            01084000
$EXTA    EQU   TOLTEPWA+2320                                            01085000
$PASSONA EQU   TOLTEPWA+2264                                            01086000
$TRMINPT EQU   TOLTEPWA+2184                                            01087000
$BUFFER  EQU   TOLTEPWA+1976                                            01088000
$TLTRPL3 EQU   TOLTEPWA+1856                                            01089000
$TLTRPL2 EQU   TOLTEPWA+1736                                            01090000
$TLTRPL1 EQU   TOLTEPWA+1616                                            01091000
@NM00062 EQU   $SLTBL+135                                               01092000
$HIGHRTN EQU   $SLTBL+134                                               01093000
$PRIMADR EQU   $SLTBL+130                                               01094000
$CTSTPT  EQU   $SLTBL+128                                               01095000
$TSTCNT  EQU   $SLTBL+126                                               01096000
$SECFLGS EQU   $SECLST+3                                                01097000
$SECTION EQU   $SECLST                                                  01098000
$SECACT  EQU   $TESTFLG                                                 01099000
$CANTRUN EQU   $TESTFLG                                                 01100000
$FINAL   EQU   $TESTFLG                                                 01101000
$TESTSUF EQU   $RUNTEST+5                                               01102000
$TESTNUM EQU   $RUNTEST+1                                               01103000
$LETPRF  EQU   $RUNTEST                                                 01104000
$SYMBOLC EQU   $SLTBL+5                                                 01105000
$FAMILY  EQU   $SLTBL                                                   01106000
$CDEVPT  EQU   TOLTEPWA+1466                                            01107000
$DEVCNTS EQU   TOLTEPWA+1464                                            01108000
$FEEDBCK EQU   $DEVTBLE+66                                              01109000
$WTISUED EQU   $DEVFLG4                                                 01110000
$EXIOISD EQU   $DEVFLG4                                                 01111000
$REMWRIT EQU   $DEVFLG4                                                 01112000
$REMDONE EQU   $DEVFLG4                                                 01113000
$2NDUSED EQU   $DEVFLG4                                                 01114000
$1STUSED EQU   $DEVFLG4                                                 01115000
$IGLXIFB EQU   $DEVFLG4                                                 01116000
$EXIOLV3 EQU   $DEVFLG4                                                 01117000
@NM00061 EQU   $DEVFLG5                                                 01118000
$DVBASIC EQU   $DEVFLG5                                                 01119000
$ASCII   EQU   $DEVFLG5                                                 01120000
$DEVLU   EQU   $DEVFLG5                                                 01121000
$OPNDFAL EQU   $DEVFLG5                                                 01122000
$ACQNCB  EQU   $DEVFLG5                                                 01123000
$REMOTE  EQU   $DEVFLG5                                                 01124000
$ENDNODE EQU   $DEVFLG5                                                 01125000
$LINENME EQU   $RNINFO                                                  01126000
$CID     EQU   $DEVTBLE+52                                              01127000
$DVCOL   EQU   $LDNCBPT+2                                               01128000
$DVROW   EQU   $LDNCBPT                                                 01129000
$NCSPLP  EQU   $DEVTBLE+44                                              01130000
$DVLN    EQU   $SSCPDAF                                                 01131000
$DAF     EQU   $DEVSESP+4                                               01132000
$VARYPAB EQU   $DEVSESP                                                 01133000
$SYSMN   EQU   $DEVTBLE+28                                              01134000
@NM00060 EQU   $DEVFLG3                                                 01135000
$CLRSNT  EQU   $DEVFLG3                                                 01136000
$OLTERR  EQU   $DEVFLG3                                                 01137000
$SRTEST  EQU   $DEVFLG3                                                 01138000
$DVSNDOK EQU   $SIOFLG                                                  01139000
$POLLREQ EQU   $DEVFLG3                                                 01140000
$ACQRED  EQU   $DEVFLG3                                                 01141000
$NOTDEV  EQU   $DEVFLG3                                                 01142000
$DVINCT  EQU   $DEVTBLE+26                                              01143000
$DVBRKST EQU   $OPND+1                                                  01144000
$DVBRKSN EQU   $OPND                                                    01145000
$DVSEQNO EQU   $OPIS                                                    01146000
$CEINTRP EQU   $DEVFLG2                                                 01147000
$TESTMDE EQU   $DEVFLG2                                                 01148000
$DEVALOC EQU   $DEVFLG2                                                 01149000
$ALLDATA EQU   $DEVFLG2                                                 01150000
$ENDCNTL EQU   $DEVFLG2                                                 01151000
$CTLDEV  EQU   $DEVFLG2                                                 01152000
$NOCDS   EQU   $DEVFLG2                                                 01153000
$DATAIN  EQU   $DEVFLG2                                                 01154000
$PRIMARY EQU   $DEVFLG1                                                 01155000
$DVCTBYT EQU   $INTOCC                                                  01156000
$DEVACT  EQU   $DEVFLG1                                                 01157000
$DVLGMDE EQU   $ATTNEXP                                                 01158000
$DVSPRM  EQU   $EVNCPLT                                                 01159000
$GRABBED EQU   $DEVFLG1                                                 01160000
$CATASTR EQU   $DEVFLG1                                                 01161000
$LETGO   EQU   $DEVFLG1                                                 01162000
$CURELEM EQU   $$SYMNME+4                                               01163000
$MSGOTSD EQU   $$SYMNME                                                 01164000
$EXTDEV  EQU   $DEVCDS+11                                               01165000
@NM00059 EQU   $DEVSDCF                                                 01166000
$NOTPRIM EQU   $DEVSDCF                                                 01167000
@NM00058 EQU   $DEVCDSF                                                 01168000
@NM00057 EQU   $DEVCDSF                                                 01169000
@NM00056 EQU   $DEVCDSF                                                 01170000
$CDSNAME EQU   $DEVCDSF                                                 01171000
$EXTRN   EQU   $DEVCDSF                                                 01172000
$CEVOLUM EQU   $DEVCDSF                                                 01173000
$SHARD   EQU   $DEVCDSF                                                 01174000
$DEVFPM  EQU   $DEVCDSF                                                 01175000
$DEVCNT  EQU   $DEVCDS+8                                                01176000
$DEVTYPE EQU   $DEVFEAT+3                                               01177000
$DEVCLAS EQU   $DEVFEAT+2                                               01178000
$DEVFRRS EQU   $DEVFEAT+1                                               01179000
$DEVMOD  EQU   $DEVFEAT                                                 01180000
$DEVRDGT EQU   @NM00054+1                                               01181000
$DEVCTLU EQU   @NM00054+1                                               01182000
$DEVCHAN EQU   @NM00054                                                 01183000
@NM00055 EQU   @NM00054                                                 01184000
$CTINDX  EQU   $DEVUNAD                                                 01185000
$FLAG16  EQU   $COMMFLG+15                                              01186000
$FLAG15  EQU   $COMMFLG+14                                              01187000
$FLAG14  EQU   $COMMFLG+13                                              01188000
$TEP2ND  EQU   $FLAG13                                                  01189000
$TEP1ST  EQU   $FLAG13                                                  01190000
$CATMSG  EQU   $FLAG13                                                  01191000
$PRMPTSW EQU   $FLAG13                                                  01192000
$DEVENT  EQU   $FLAG13                                                  01193000
$OLTMACC EQU   $FLAG13                                                  01194000
$LGON    EQU   $FLAG13                                                  01195000
$CTLOGON EQU   $FLAG13                                                  01196000
@NM00053 EQU   $FLAG12                                                  01197000
$VARYINP EQU   $FLAG12                                                  01198000
$ENDTEST EQU   $FLAG12                                                  01199000
$VRYHRD  EQU   $FLAG12                                                  01200000
$VRYSFT  EQU   $FLAG12                                                  01201000
$POSTFLG EQU   $FLAG12                                                  01202000
$OPTMSG  EQU   $FLAG12                                                  01203000
$FEORCAT EQU   $FLAG11                                                  01204000
@NM00052 EQU   $FLAG11                                                  01205000
@NM00051 EQU   $FLAG10                                                  01206000
$INBND   EQU   $FLAG10                                                  01207000
$WAITFLG EQU   $FLAG10                                                  01208000
$DPRINT  EQU   $FLAG10                                                  01209000
$HOLD    EQU   $FLAG9                                                   01210000
$NOTRRCH EQU   $FLAG9                                                   01211000
@NM00050 EQU   $FLAG9                                                   01212000
$LSTLNSW EQU   $FLAG9                                                   01213000
$MULLNSW EQU   $FLAG9                                                   01214000
$IGRES   EQU   $FLAG9                                                   01215000
$VS2     EQU   $FLAG8                                                   01216000
$VS1     EQU   $FLAG8                                                   01217000
$EDOS    EQU   $FLAG8                                                   01218000
@NM00049 EQU   $FLAG8                                                   01219000
$TWOWAY  EQU   $FLAG8                                                   01220000
@NM00048 EQU   $FLAG8                                                   01221000
$RCVMSG  EQU   $FLAG7                                                   01222000
$RCVRFLG EQU   $FLAG7                                                   01223000
$SNDRFLG EQU   $FLAG7                                                   01224000
$LDOIS   EQU   $FLAG7                                                   01225000
$DCONTCT EQU   $FLAG7                                                   01226000
$EXIOWAT EQU   $FLAG7                                                   01227000
$2NDDATA EQU   $FLAG7                                                   01228000
$1STDATA EQU   $FLAG7                                                   01229000
$CIREQ   EQU   $FLAG6                                                   01230000
$ABTERM  EQU   $ABNDBIT                                                 01231000
$FSTMCIS EQU   $FLAG6                                                   01232000
$DISCREQ EQU   $FLAG6                                                   01233000
$DISCISS EQU   $FLAG6                                                   01234000
$CTERROR EQU   $FLAG6                                                   01235000
$RECAL11 EQU   $FLAG6                                                   01236000
@NM00047 EQU   $FLAG5                                                   01237000
$PROGCK  EQU   $CANCEL                                                  01238000
$PRINTAP EQU   $FLAG5                                                   01239000
@NM00046 EQU   $FLAG5                                                   01240000
$MSG922  EQU   $FLAG5                                                   01241000
$CT924   EQU   $FLAG5                                                   01242000
$FSTCAT  EQU   $FLAG5                                                   01243000
$FSTFE   EQU   $FLAG5                                                   01244000
$ACTOPND EQU   $FLAG4                                                   01245000
$ACQCUTT EQU   $FLAG4                                                   01246000
$CLSSACT EQU   $FLAG4                                                   01247000
$BACKINT EQU   $FLAG4                                                   01248000
$DMSGSW  EQU   $FLAG4                                                   01249000
$TSTDEVP EQU   $FLAG4                                                   01250000
$APRQPER EQU   $FLAG4                                                   01251000
$OPCOM   EQU   $FLAG4                                                   01252000
$NEWAP   EQU   $FLAG3                                                   01253000
$ALTPRTR EQU   $FLAG3                                                   01254000
$OPTERR  EQU   $FLAG3                                                   01255000
$PRTONLY EQU   $FLAG3                                                   01256000
$REQSTOR EQU   $FLAG3                                                   01257000
$LOGOFFE EQU   $FLAG3                                                   01258000
$TSTERR  EQU   $FLAG3                                                   01259000
$DEVERR  EQU   $FLAG3                                                   01260000
$PARTIAL EQU   $FLAG2                                                   01261000
$NRMTERM EQU   $FLAG2                                                   01262000
$VALDTST EQU   $FLAG2                                                   01263000
$VALDDEV EQU   $FLAG2                                                   01264000
$DBLSLSH EQU   $FLAG2                                                   01265000
$NDR     EQU   $FLAG2                                                   01266000
@NM00045 EQU   $FLAG2                                                   01267000
$OLTACT  EQU   $FLAG1                                                   01268000
$NORELDV EQU   $FLAG1                                                   01269000
@NM00044 EQU   $FLAG1                                                   01270000
$OPTCHNG EQU   $FLAG1                                                   01271000
$DEVCHNG EQU   $FLAG1                                                   01272000
$TESTCNG EQU   $FLAG1                                                   01273000
$CNSLFG  EQU   $FLAG1                                                   01274000
$TEP3RD  EQU   $FLAG1                                                   01275000
@NM00043 EQU   $CDA+120                                                 01276000
$CUCNT   EQU   $CDA+118                                                 01277000
@NM00042 EQU   $CDA+117                                                 01278000
$PRTFORM EQU   $CDA+116                                                 01279000
$OPISCNT EQU   $CDA+114                                                 01280000
$OPNDCNT EQU   $CDA+112                                                 01281000
$GETMSZE EQU   $CDA+110                                                 01282000
$GRCNTS  EQU   $CDA+108                                                 01283000
$CTLCNT  EQU   $CDA+106                                                 01284000
$ACTLVL  EQU   $CDA+105                                                 01285000
$PRNTLVL EQU   $CDA+104                                                 01286000
$ERRCNTA EQU   $CDA+102                                                 01287000
$TLCNT   EQU   $CDA+100                                                 01288000
$TIMEALW EQU   $CDA+96                                                  01289000
$PTRAREA EQU   $CDA+92                                                  01290000
$GETMPTR EQU   $CDA+88                                                  01291000
$R13PTRT EQU   $CDA+84                                                  01292000
$R13PTR  EQU   $CDA+80                                                  01293000
$TEPEND  EQU   $CDA+76                                                  01294000
$PLINKDL EQU   $CDA+72                                                  01295000
$TEPBEGN EQU   $CDA+68                                                  01296000
$FRELPTR EQU   $CDA+64                                                  01297000
$HIGHADR EQU   $HIMOREC                                                 01298000
$LOMOREC EQU   $CDA+56                                                  01299000
$ENDCOMM EQU   $CDA+48                                                  01300000
$COMMON  EQU   $RCA                                                     01301000
$SLASHAD EQU   $CDA+32                                                  01302000
$PASSON  EQU   $CDA+28                                                  01303000
$TOLBRTB EQU   $CDA+24                                                  01304000
$SCTPTR8 EQU   $CDA+20                                                  01305000
$SCTPTR  EQU   $CDA+16                                                  01306000
$TBWDPTR EQU   $CDA+12                                                  01307000
$TFWDPTR EQU   $CDA+8                                                   01308000
@NM00041 EQU   $CDA                                                     01309000
@NM00040 EQU   $SCTTBLE+98                                              01310000
$SCTLWTC EQU   $SCTTBLE+96                                              01311000
$SCTLWTA EQU   $SCTTBLE+92                                              01312000
#EXT     EQU   $SCTTBLE+88                                              01313000
#PASS    EQU   $SCTTBLE+84                                              01314000
#TABLE   EQU   $SCTTBLE+80                                              01315000
#MSGIDAC EQU   $SCTTBLE+78                                              01316000
@NM00039 EQU   $SCTTBLE+71                                              01317000
$RETMASK EQU   $SCTTBLE+70                                              01318000
$R249255 EQU   $ROUTMSK+29                                              01319000
$R241248 EQU   $ROUTMSK+28                                              01320000
$R233240 EQU   $ROUTMSK+27                                              01321000
$R225232 EQU   $ROUTMSK+26                                              01322000
$R217224 EQU   $ROUTMSK+25                                              01323000
$R209216 EQU   $ROUTMSK+24                                              01324000
$R201208 EQU   $ROUTMSK+23                                              01325000
$R193200 EQU   $ROUTMSK+22                                              01326000
$R185192 EQU   $ROUTMSK+21                                              01327000
$R177184 EQU   $ROUTMSK+20                                              01328000
$R169176 EQU   $ROUTMSK+19                                              01329000
$R161168 EQU   $ROUTMSK+18                                              01330000
$R153160 EQU   $ROUTMSK+17                                              01331000
$R145152 EQU   $ROUTMSK+16                                              01332000
$R137144 EQU   $ROUTMSK+15                                              01333000
$R129136 EQU   $ROUTMSK+14                                              01334000
$R121128 EQU   $ROUTMSK+13                                              01335000
$R113120 EQU   $ROUTMSK+12                                              01336000
$R105112 EQU   $ROUTMSK+11                                              01337000
$R097104 EQU   $ROUTMSK+10                                              01338000
$R089096 EQU   $ROUTMSK+9                                               01339000
$R081088 EQU   $ROUTMSK+8                                               01340000
$R073080 EQU   $ROUTMSK+7                                               01341000
$R065072 EQU   $ROUTMSK+6                                               01342000
$R057064 EQU   $ROUTMSK+5                                               01343000
$R049056 EQU   $ROUTMSK+4                                               01344000
$R041048 EQU   $ROUTMSK+3                                               01345000
$R033040 EQU   $ROUTMSK+2                                               01346000
$R025032 EQU   $ROUTMSK+1                                               01347000
$R017024 EQU   $ROUTMSK                                                 01348000
$TOTFLG2 EQU   $SCTTBLE+39                                              01349000
@NM00038 EQU   $TOTFLG1                                                 01350000
@NM00037 EQU   $TOTFLG1                                                 01351000
@NM00036 EQU   $TOTFLG1                                                 01352000
$CURELOD EQU   $TOTFLG1                                                 01353000
$CTEQTT  EQU   $TOTFLG1                                                 01354000
@NM00035 EQU   $TOTFLG1                                                 01355000
@NM00034 EQU   $TOTFLG1                                                 01356000
$LINESHR EQU   $TOTFLG1                                                 01357000
@NM00033 EQU   $OLTFLG2                                                 01358000
@NM00032 EQU   $OLTFLG2                                                 01359000
@NM00031 EQU   $OLTFLG2                                                 01360000
@NM00030 EQU   $OLTFLG2                                                 01361000
@NM00029 EQU   $OLTFLG2                                                 01362000
@NM00028 EQU   $OLTFLG2                                                 01363000
@NM00027 EQU   $OLTFLG2                                                 01364000
$TALK    EQU   $OLTFLG2                                                 01365000
$DYCOM   EQU   $OLTFLGS                                                 01366000
@NM00026 EQU   $OLTFLGS                                                 01367000
$TRACE   EQU   $OLTFLGS                                                 01368000
$RETCODE EQU   $OLTFLGS                                                 01369000
$CONTCB  EQU   $OLTFLGS                                                 01370000
$RETAIN  EQU   $OLTFLGS                                                 01371000
$CLEANRT EQU   $OLTFLGS                                                 01372000
$MANINTV EQU   $OLTFLGS                                                 01373000
$OLTSIZE EQU   $SCTTBLE+34                                              01374000
$QSCTMOD EQU   $EXECFLG                                                 01375000
$CTRLMOD EQU   $EXECFLG                                                 01376000
$CLEANUP EQU   $EXECFLG                                                 01377000
$LSTPDEV EQU   $EXECFLG                                                 01378000
$ERRCNT  EQU   $EXECFLG                                                 01379000
$RTNSLCT EQU   $EXECFLG                                                 01380000
$MULTDEV EQU   $EXECFLG                                                 01381000
@NM00025 EQU   $EXECFLG                                                 01382000
$RMSKCNT EQU   $SCTTBLE+32                                              01383000
$SYNAME  EQU   $CDS8T19+4                                               01384000
$EXTSIG  EQU   $CDS8T19+3                                               01385000
$CDFLGS  EQU   $CDS8T19+1                                               01386000
$CDSCNT  EQU   $CDS8T19                                                 01387000
$PDEVDSC EQU   $SCTTBLE+16                                              01388000
$PDEVADR EQU   $SCTTBLE+12                                              01389000
$COMMCN  EQU   $CDSFLGS                                                 01390000
$CUSTSYM EQU   $CDSFLGS                                                 01391000
$TWOCHSW EQU   $CDSFLGS                                                 01392000
$SYMNAME EQU   $CDSFLGS                                                 01393000
$EXTINTC EQU   $CDSFLGS                                                 01394000
$CEVOL   EQU   $CDSFLGS                                                 01395000
$SHARED  EQU   $CDSFLGS                                                 01396000
$FPM     EQU   $CDSFLGS                                                 01397000
$LASTSUB EQU   $PDEVFLG                                                 01398000
@NM00024 EQU   $PDEVFLG                                                 01399000
@NM00023 EQU   $PDEVFLG                                                 01400000
@NM00022 EQU   $PDEVFLG                                                 01401000
$LASTDEV EQU   $PDEVFLG                                                 01402000
@NM00021 EQU   $PDEVFLG                                                 01403000
$EXFILPT EQU   $PDEVFLG                                                 01404000
$FPMOLD  EQU   $PDEVFLG                                                 01405000
$TSSSYM  EQU   $SCTTBLE+8                                               01406000
$SCTLEVL EQU   $SCTTBLE+7                                               01407000
$DRIVER  EQU   $SCTTBLE+6                                               01408000
$RT0916  EQU   $SCTTBLE+5                                               01409000
$RT0108  EQU   $SCTTBLE+4                                               01410000
$LOOPTST EQU   $ERROPT                                                  01411000
$LOOPERR EQU   $ERROPT                                                  01412000
$NERRPRT EQU   $ERROPT                                                  01413000
$NOCNTRL EQU   $ERROPT                                                  01414000
$ALTPRNT EQU   $ERROPT                                                  01415000
$CATERR  EQU   $ERROPT                                                  01416000
$ASTERIK EQU   $ERROPT                                                  01417000
$TESTERR EQU   $ERROPT                                                  01418000
$FSTCOMM EQU   $TESTOPT                                                 01419000
$INDEFLP EQU   $TESTOPT                                                 01420000
$NOPRT   EQU   $TESTOPT                                                 01421000
$PARAPRT EQU   $TESTOPT                                                 01422000
@NM00020 EQU   $TESTOPT                                                 01423000
$ERRLPCT EQU   $SCTTBLE                                                 01424000
$TLTEND  EQU   $RCAAREA+945                                             01425000
$CNSLID  EQU   $RCAAREA+936                                             01426000
$EXITSAV EQU   $RCAAREA+864                                             01427000
$TRASCII EQU   $RCAAREA+608                                             01428000
@NM00019 EQU   $RCAAREA+605                                             01429000
$VTAMEND EQU   $RCAFLG                                                  01430000
$TPPOSTD EQU   $RCAFLG                                                  01431000
$NEWCT   EQU   $RCAFLG                                                  01432000
$ABNDALL EQU   $RCAFLG                                                  01433000
$CUTESTB EQU   $RCAFLG                                                  01434000
$CONSOLE EQU   $RCAFLG                                                  01435000
$TPLOGON EQU   $RCAFLG                                                  01436000
$UPDATE  EQU   $RCAFLG                                                  01437000
$DEVAREA EQU   $RCAAREA+600                                             01438000
$CTDVAR  EQU   $RCAAREA+596                                             01439000
$BUFFS   EQU   $RCAAREA+464                                             01440000
$TLTNIB  EQU   $CONSTNT+140                                             01441000
$TLTPRPL EQU   $CONSTNT+20                                              01442000
@NM00018 EQU   $CONSTNT+4                                               01443000
@NM00017 EQU   $CONSTNT+2                                               01444000
$USECNT  EQU   $CONSTNT                                                 01445000
$CURRTWA EQU   $POINTER+140                                             01446000
$CTNAME  EQU   $POINTER+132                                             01447000
$CTARGX  EQU   $POINTER+128                                             01448000
$COMINT  EQU   $POINTER+120                                             01449000
$QUEHNDL EQU   $POINTER+116                                             01450000
@NM00016 EQU   $POINTER+36                                              01451000
$RTNPTR  EQU   $POINTER+32                                              01452000
$TLTECB2 EQU   $POINTER+28                                              01453000
$TLTECB1 EQU   $POINTER+24                                              01454000
$CLEANP  EQU   $POINTER+20                                              01455000
$ABEND   EQU   $POINTER+16                                              01456000
$LSTAREA EQU   $POINTER+12                                              01457000
$FSTAREA EQU   $POINTER+8                                               01458000
$CVTSAVE EQU   $POINTER+4                                               01459000
$TOLTEP  EQU   $POINTER                                                 01460000
$TLTACB  EQU   $RCAAREA                                                 01461000
.@UNREFD ANOP                          END UNREFERENCED COMPONENTS      01462000
@RT00077 EQU   I009C01A                                                 01463000
@RT00087 EQU   I009C02                                                  01464000
@RT00149 EQU   I009C04                                                  01465000
@RF00149 EQU   I009C03A                                                 01466000
@RT00156 EQU   I009C04                                                  01467000
@RF00154 EQU   I009C04                                                  01468000
@RT00167 EQU   I009C05                                                  01469000
@RT00187 EQU   I009CER2                                                 01470000
@RT00189 EQU   I009CER3                                                 01471000
@RT00233 EQU   I009CRD1                                                 01472000
@RT00251 EQU   I009CRET                                                 01473000
@ENDDATA EQU   *                                                        01474000
         END   ISTIC009,(C'PLS1257',0702,78336)                         01475000
./  ADD  SSI=83360405,NAME=ISTSC02A
         TITLE 'ISTSC02A,GRAB. ACTIVATES SECONDARY DEVICES FOR OLTS'    00001000
ISTSC02A CSECT ,                                                   0001 00002000
@MAINENT DS    0H                                                  0001 00003000
         USING *,@15                                               0001 00004000
         B     @PROLOG                                             0001 00005000
         DC    AL1(16)                                             0001 00006000
         DC    C'ISTSC02A  78.337'                                 0001 00007000
         DROP  @15                                                      00008000
@PROLOG  ST    @14,12(,@13)                                        0001 00009000
         STM   @00,@12,20(@13)                                     0001 00010000
         BALR  @04,0                                               0001 00011000
@PSTART  DS    0H                                                  0001 00012000
         USING @PSTART,@04                                         0001 00013000
*                                                                  0048 00014000
*/********************************************************************/ 00015000
*/*      INITIAL  PREPARATIONS                                       */ 00016000
*/********************************************************************/ 00017000
*                                                                  0049 00018000
*S2AC0010:                                                         0049 00019000
*   ;                                                              0049 00020000
S2AC0010 DS    0H                                                  0050 00021000
*   R15=R13;                        /* SET PTR TO BACKSAVE DSECT     */ 00022000
         LR    R15,R13                                             0050 00023000
*   R13=ADDR(SVESC02A);             /* SET PTR TO SAVE AREA          */ 00024000
         LA    R13,SVESC02A(,WAPTR)                                0051 00025000
*   BACKSAVE(3)=R13;                /* CHAIN SAVE AREA TOGETHER      */ 00026000
         ST    R13,BACKSAVE+8(,R15)                                0052 00027000
*   SVESC02A(2)=R15;                                               0053 00028000
         ST    R15,SVESC02A+4(,WAPTR)                              0053 00029000
*   GRAMAP=R1;                      /* GET PARAMETER LIST            */ 00030000
         LR    GRAMAP,R1                                           0054 00031000
*   AFLAGS='C0'X;                   /* TURN ON FLAGS                 */ 00032000
         MVI   AFLAGS,X'C0'                                        0055 00033000
*/****************************************************************** */ 00034000
*/*      DETERMINE IF ANY DEVICES ARE AVAILABLE                      */ 00035000
*/****************************************************************** */ 00036000
*                                                                  0056 00037000
*   IF $DEVCNTS<3                   /* ANY DEVICES AVAILABLE         */ 00038000
*     THEN                                                         0056 00039000
         LH    @14,$DEVCNTS(,WAPTR)                                0056 00040000
         C     @14,@CF00050                                        0056 00041000
         BNL   @RF00056                                            0056 00042000
*     DO;                           /* IF NO,                        */ 00043000
*       R15=4;                      /* RET. CODE OF4                 */ 00044000
         LA    R15,4                                               0058 00045000
*       GOTO S2AC0190;                                             0059 00046000
         B     S2AC0190                                            0059 00047000
*     END;                                                         0060 00048000
*   IF $DEVCNTS<4                   /* ANY SECONDARY DEVICES         */ 00049000
*     THEN                                                         0061 00050000
@RF00056 LH    @14,$DEVCNTS(,WAPTR)                                0061 00051000
         C     @14,@CF00032                                        0061 00052000
         BNL   @RF00061                                            0061 00053000
*     DO;                           /* IF NO,                        */ 00054000
*       R15=12;                     /* RET CODE OF 12                */ 00055000
         LA    R15,12                                              0063 00056000
*       GOTO S2AC0190;                                             0064 00057000
         B     S2AC0190                                            0064 00058000
*     END;                                                         0065 00059000
*   L3=$GRCNTS+1;                   /* GET ACTIVE GRABBED DEV        */ 00060000
@RF00061 LA    @14,1                                               0066 00061000
         LH    @12,$GRCNTS(,WAPTR)                                 0066 00062000
         LR    L3,@12                                              0066 00063000
         ALR   L3,@14                                              0066 00064000
*   IF $GRCNTS=0                    /* IF COUNT 0.                   */ 00065000
*     THEN                                                         0067 00066000
         LTR   @12,@12                                             0067 00067000
         BNZ   @RF00067                                            0067 00068000
*     L3=$CDEVPT+1;                 /* GET DEV AFTER PRIMARY         */ 00069000
         AH    @14,$CDEVPT(,WAPTR)                                 0068 00070000
         LR    L3,@14                                              0068 00071000
*   L4=$DEVCNTS;                    /* GET HIGHEST COUNT             */ 00072000
@RF00067 LH    L4,$DEVCNTS(,WAPTR)                                 0069 00073000
*/****************************************************************** */ 00074000
*/*      SEARCH DEVICE ENTRY TABLE FOR AN AVAILABLE DEVICE           */ 00075000
*/****************************************************************** */ 00076000
*                                                                  0070 00077000
*S2AC0030:                                                         0070 00078000
*   ;                                                              0070 00079000
S2AC0030 DS    0H                                                  0071 00080000
*   DO I=L3 TO L4;                                                 0071 00081000
         LR    I,L3                                                0071 00082000
         B     @DE00071                                            0071 00083000
@DL00071 DS    0H                                                  0072 00084000
*     IF $NOTDEV(I)='1'B|           /* CHECK FOR REAL DEV            */ 00085000
*         $ACQRED(I)='0'B           /* OR INSURE DEV WAS ACQ         */ 00086000
*       THEN                        /* BR IF NOT DEV OR ACQ          */ 00087000
         LA    @14,68                                              0072 00088000
         LR    @01,I                                               0072 00089000
         MR    @00,@14                                             0072 00090000
         ST    @01,@TF00001                                        0072 00091000
         ALR   @01,WAPTR                                           0072 00092000
         TM    $NOTDEV-68(@01),B'10000000'                         0072 00093000
         BNZ   @RT00072                                            0072 00094000
         TM    $ACQRED-68(@01),B'01000000'                         0072 00095000
         BNO   @RT00072                                            0072 00096000
*       GOTO S2AC0150;                                             0073 00097000
*     IF $LETGO(I)='1'B|$GRABBED(I)='1'B|$PRIMARY(I)='1'B THEN     0074 00098000
         LR    @12,WAPTR                                           0074 00099000
         AL    @12,@TF00001                                        0074 00100000
         TM    $LETGO-68(@12),B'10100001'                          0074 00101000
         BNZ   @RT00074                                            0074 00102000
*       GOTO S2AC0150;              /* CAN THIS DEVICE BE GRABBED NO,   00103000
*                                      IF ANY BIT ON                 */ 00104000
*/****************************************************************** */ 00105000
*/*   DETERMINE IF CALLER WANTED SPECIAL DEVICE CHARACTERISTICS      */ 00106000
*/****************************************************************** */ 00107000
*                                                                  0076 00108000
*     IF $GRABFLG=<3                /* ANY CTRL PARAMETERS           */ 00109000
*       THEN                                                       0076 00110000
         CLI   $GRABFLG(GRAMAP),3                                  0076 00111000
         BNH   @RT00076                                            0076 00112000
*       GOTO S2AC0090;              /* BR IF NO                      */ 00113000
*/****************************************************************** */ 00114000
*/*      REQUEST FOR DIFFERENT CONTROL UNIT ADDRESS                  */ 00115000
*/****************************************************************** */ 00116000
*                                                                  0078 00117000
*     IF $GRABDCH='0'B              /* REQ FOR DIFF CHANNEL          */ 00118000
*       THEN                                                       0078 00119000
         TM    $GRABDCH(GRAMAP),B'10000000'                        0078 00120000
         BZ    @RT00078                                            0078 00121000
*       GOTO S2AC0210;              /* BR IF NO                      */ 00122000
*     IF($DEVUNAD(I)&CHMASK)=($DEVUNAD($CDEVPT)&CHMASK)/* ARE      0080 00123000
*                                      CHANNELS DIFFERENT            */ 00124000
*       THEN                                                       0080 00125000
         L     @12,CHMASK                                          0080 00126000
         L     @06,@TF00001                                        0080 00127000
         L     @06,$DEVUNAD-68(@06,WAPTR)                          0080 00128000
         NR    @06,@12                                             0080 00129000
         MH    @14,$CDEVPT(,WAPTR)                                 0080 00130000
         N     @12,$DEVUNAD-68(@14,WAPTR)                          0080 00131000
         CLR   @06,@12                                             0080 00132000
         BE    @RT00080                                            0080 00133000
*       GOTO S2AC0150;              /* BR IF NO                      */ 00134000
*/****************************************************************** */ 00135000
*/*      REQUEST FOR DIFFERENT CHANNEL UNIT ADDRESS                  */ 00136000
*/****************************************************************** */ 00137000
*                                                                  0082 00138000
*S2AC0050:                                                         0082 00139000
*     ;                                                            0082 00140000
S2AC0050 DS    0H                                                  0083 00141000
*     IF $GRABDCU='0'B              /* REQ. FOR DIFF CONTROL UNIT    */ 00142000
*       THEN                                                       0083 00143000
         TM    $GRABDCU(GRAMAP),B'00100000'                        0083 00144000
         BZ    @RT00083                                            0083 00145000
*       GOTO S2AC0230;              /* BR IF NO                      */ 00146000
*     IF($DEVUNAD(I)&CUMASK)=($DEVUNAD($CDEVPT)&CUMASK)/* ARE CONTROL   00147000
*                                      UNITS DIFF                    */ 00148000
*       THEN                                                       0085 00149000
         L     @14,CUMASK                                          0085 00150000
         LA    @12,68                                              0085 00151000
         LR    @01,I                                               0085 00152000
         MR    @00,@12                                             0085 00153000
         L     @06,$DEVUNAD-68(@01,WAPTR)                          0085 00154000
         NR    @06,@14                                             0085 00155000
         MH    @12,$CDEVPT(,WAPTR)                                 0085 00156000
         N     @14,$DEVUNAD-68(@12,WAPTR)                          0085 00157000
         CLR   @06,@14                                             0085 00158000
         BE    @RT00085                                            0085 00159000
*       GOTO S2AC0150;              /* BR IF NO                      */ 00160000
*/****************************************************************** */ 00161000
*/*      REQUEST FOR DEFFERENT DEVICE ADDRESS                        */ 00162000
*/****************************************************************** */ 00163000
*                                                                  0087 00164000
*S2AC0070:                                                         0087 00165000
*     ;                                                            0087 00166000
S2AC0070 DS    0H                                                  0088 00167000
*     IF $GRABDDV='0'B              /* REQ FOR DIFF DEVICES          */ 00168000
*       THEN                                                       0088 00169000
         TM    $GRABDDV(GRAMAP),B'00001000'                        0088 00170000
         BZ    @RT00088                                            0088 00171000
*       GOTO S2AC0250;              /* BR IF NO                      */ 00172000
*     IF($DEVUNAD(I)&DVMASK)=($DEVUNAD($CDEVPT)&DVMASK)/* ARE DEVICES   00173000
*                                      DIFFERENT                     */ 00174000
*       THEN                                                       0090 00175000
         L     @14,DVMASK                                          0090 00176000
         LA    @12,68                                              0090 00177000
         LR    @01,I                                               0090 00178000
         MR    @00,@12                                             0090 00179000
         L     @06,$DEVUNAD-68(@01,WAPTR)                          0090 00180000
         NR    @06,@14                                             0090 00181000
         MH    @12,$CDEVPT(,WAPTR)                                 0090 00182000
         N     @14,$DEVUNAD-68(@12,WAPTR)                          0090 00183000
         CLR   @06,@14                                             0090 00184000
         BE    @RT00090                                            0090 00185000
*       GOTO S2AC0150;              /* BR IF YES                     */ 00186000
*/****************************************************************** */ 00187000
*/*      REQUEST FOR SPECIFIC DEVICE CLASS                           */ 00188000
*/****************************************************************** */ 00189000
*                                                                  0092 00190000
*S2AC0090:                                                         0092 00191000
*     ;                                                            0092 00192000
S2AC0090 DS    0H                                                  0093 00193000
*     IF $GRABCLA='1'B              /* REQ FOR DEV CLASS             */ 00194000
*       THEN                                                       0093 00195000
         TM    $GRABCLA(GRAMAP),B'00000010'                        0093 00196000
         BO    @RT00093                                            0093 00197000
*       GOTO S2AC0110;              /* BR IF NO                      */ 00198000
*     IF $DEVCLAS(I)¬=$GRABCLS      /* DO CLASS MATCH                */ 00199000
*       THEN                                                       0095 00200000
         LR    @14,I                                               0095 00201000
         MH    @14,@CH00086                                        0095 00202000
         ALR   @14,WAPTR                                           0095 00203000
         CLC   $DEVCLAS-68(1,@14),$GRABCLS(GRAMAP)                 0095 00204000
         BNE   @RT00095                                            0095 00205000
*       GOTO S2AC0150;              /* BR IF NO                      */ 00206000
*/****************************************************************** */ 00207000
*/*      REQUEST FOR SPECIFIC UNIT TYPE                              */ 00208000
*/****************************************************************** */ 00209000
*                                                                  0097 00210000
*S2AC0110:                                                         0097 00211000
*     ;                                                            0097 00212000
S2AC0110 DS    0H                                                  0098 00213000
*     IF $GRABUNT='1'B              /* REQ. FOR UNIT TYPE            */ 00214000
*       THEN                                                       0098 00215000
         TM    $GRABUNT(GRAMAP),B'00000001'                        0098 00216000
         BO    @RT00098                                            0098 00217000
*       GOTO S2AC0130;              /* BR IF NO                      */ 00218000
*     IF $DEVTYPE(I)¬=$GRABTYP      /* DO TYPE MATCH                 */ 00219000
*       THEN                                                       0100 00220000
         LR    @14,I                                               0100 00221000
         MH    @14,@CH00086                                        0100 00222000
         ALR   @14,WAPTR                                           0100 00223000
         CLC   $DEVTYPE-68(1,@14),$GRABTYP(GRAMAP)                 0100 00224000
         BNE   @RT00100                                            0100 00225000
*       GOTO S2AC0150;              /* BR IF NO                      */ 00226000
*/****************************************************************** */ 00227000
*/*      GET GRAB DEVICE ACQUIRED                                    */ 00228000
*/****************************************************************** */ 00229000
*                                                                  0102 00230000
*S2AC0130:                                                         0102 00231000
*     ;                                                            0102 00232000
S2AC0130 DS    0H                                                  0103 00233000
*     CDSPTR=ADDR($DEVTBLE(I));     /* GET CDS ADDR                  */ 00234000
         LR    @14,I                                               0103 00235000
         MH    @14,@CH00086                                        0103 00236000
         LA    @14,$DEVTBLE-68(@14,WAPTR)                          0103 00237000
         ST    @14,CDSPTR                                          0103 00238000
*     GOTO S2AC0170;                /* GO MOVE IN THE CDS INFO       */ 00239000
         B     S2AC0170                                            0104 00240000
*S2AC0150:                                                         0105 00241000
*   END;                                                           0105 00242000
S2AC0150 AL    I,@CF00071                                          0105 00243000
@DE00071 CR    I,L4                                                0105 00244000
         BNH   @DL00071                                            0105 00245000
*   IF L3=3                         /* HAS 2ND LOOP BEEN DONE        */ 00246000
*     THEN                                                         0106 00247000
         C     L3,@CF00050                                         0106 00248000
         BNE   @RF00106                                            0106 00249000
*     DO;                           /* IF YES                        */ 00250000
*       R15=8;                      /* DEVICE CANNOT BE FOUND        */ 00251000
         LA    R15,8                                               0108 00252000
*       GOTO S2AC0190;              /* SET RETURN CODE TO 8          */ 00253000
         B     S2AC0190                                            0109 00254000
*     END;                                                         0110 00255000
*   L4=L3-1;                        /* SET COUNTS FOR 2ND LOOP       */ 00256000
@RF00106 LR    L4,L3                                               0111 00257000
         BCTR  L4,0                                                0111 00258000
*   L3=3;                                                          0112 00259000
         LA    L3,3                                                0112 00260000
*   GOTO S2AC0030;                                                 0113 00261000
*                                                                  0113 00262000
         B     S2AC0030                                            0113 00263000
*/****************************************************************** */ 00264000
*/*      GRAB SUCCESSFUL, MOVE IN CDS INFO INTO CALLERS BUFFER       */ 00265000
*/****************************************************************** */ 00266000
*                                                                  0114 00267000
*S2AC0170:                                                         0114 00268000
*   ;                                                              0114 00269000
S2AC0170 DS    0H                                                  0115 00270000
*   R15=0;                          /* SET RET CODE TO 0             */ 00271000
         SLR   R15,R15                                             0115 00272000
*   $GRCNTS=I;                      /* MOVE IN NEW GRABBED DEV       */ 00273000
         STH   I,$GRCNTS(,WAPTR)                                   0116 00274000
*   $GRABBED(I)='1'B;               /* SET GRAB BIT                  */ 00275000
         LR    @14,I                                               0117 00276000
         MH    @14,@CH00086                                        0117 00277000
         ST    @14,@TF00001                                        0117 00278000
         ALR   @14,WAPTR                                           0117 00279000
         OI    $GRABBED-68(@14),B'00100000'                        0117 00280000
*   INPUTBUF(1:$GRABCNT)=($DEVTBLE(I,1:$GRABCNT));                 0118 00281000
         L     @14,$GRABCDS(,GRAMAP)                               0118 00282000
         SLR   @12,@12                                             0118 00283000
         IC    @12,$GRABCNT(,GRAMAP)                               0118 00284000
         BCTR  @12,0                                               0118 00285000
         LR    @06,WAPTR                                           0118 00286000
         AL    @06,@TF00001                                        0118 00287000
         EX    @12,@SM00411                                        0118 00288000
*   IF $GRABCNT<12                  /* IS COUNT LESS THAN 12         */ 00289000
*     THEN                                                         0119 00290000
         CLI   $GRABCNT(GRAMAP),12                                 0119 00291000
         BNL   @RF00119                                            0119 00292000
*     DO;                           /* IF YES,IS CDS OR EXT. ON      */ 00293000
*       IF $CDSNAME(I)='1'B|$EXTRN(I)='1'B THEN                    0121 00294000
         LR    @14,WAPTR                                           0121 00295000
         AL    @14,@TF00001                                        0121 00296000
         TM    $CDSNAME-68(@14),B'00011000'                        0121 00297000
         BZ    @RF00121                                            0121 00298000
*         R15=20;                   /* IF YES, SET RET CODE TO 14    */ 00299000
         LA    R15,20                                              0122 00300000
*     END;                                                         0123 00301000
@RF00121 DS    0H                                                  0124 00302000
*   IF $GRABCNT<20                  /* IS COUNT LESS THAN 20         */ 00303000
*     THEN                                                         0124 00304000
@RF00119 CLI   $GRABCNT(GRAMAP),20                                 0124 00305000
         BNL   @RF00124                                            0124 00306000
*     DO;                           /* IF YES                        */ 00307000
*       IF $CDSNAME(I)='1'B         /* IS SYMO NAME ON               */ 00308000
*         THEN                                                     0126 00309000
         LR    @14,I                                               0126 00310000
         MH    @14,@CH00086                                        0126 00311000
         ALR   @14,WAPTR                                           0126 00312000
         TM    $CDSNAME-68(@14),B'00001000'                        0126 00313000
         BNO   @RF00126                                            0126 00314000
*         R15=20;                   /* IF YES, RETURN CODE14         */ 00315000
         LA    R15,20                                              0127 00316000
*     END;                                                         0128 00317000
@RF00126 DS    0H                                                  0129 00318000
*S2AC0190:                                                         0129 00319000
*   ;                                                              0129 00320000
@RF00124 DS    0H                                                  0129 00321000
S2AC0190 DS    0H                                                  0130 00322000
*   R13=SVESC02A(2);                                               0130 00323000
         L     R13,SVESC02A+4(,WAPTR)                              0130 00324000
*   RETURN;                                                        0131 00325000
*                                                                  0131 00326000
@EL00001 DS    0H                                                  0131 00327000
@EF00001 DS    0H                                                  0131 00328000
@ER00001 L     @14,12(,@13)                                        0131 00329000
         LM    @00,@12,20(@13)                                     0131 00330000
         BR    @14                                                 0131 00331000
*/****************************************************************** */ 00332000
*/*       REQUEST FOR SAME CHANNEL ADDRESS                           */ 00333000
*/****************************************************************** */ 00334000
*                                                                  0132 00335000
*S2AC0210:                                                         0132 00336000
*   ;                                                              0132 00337000
S2AC0210 DS    0H                                                  0133 00338000
*   IF $GRABSCH='0'B                /* REQ. FOR SAME CHANNEL         */ 00339000
*     THEN                                                         0133 00340000
         TM    $GRABSCH(GRAMAP),B'01000000'                        0133 00341000
         BZ    @RT00133                                            0133 00342000
*     GOTO S2AC0050;                /* BR IF NO                      */ 00343000
*   IF($DEVUNAD(I)&CHMASK)=($DEVUNAD($CDEVPT)&CHMASK)/* DO CHANNELS     00344000
*                                      MATCH                         */ 00345000
*     THEN                                                         0135 00346000
         L     @14,CHMASK                                          0135 00347000
         LA    @12,68                                              0135 00348000
         LR    @01,I                                               0135 00349000
         MR    @00,@12                                             0135 00350000
         L     @06,$DEVUNAD-68(@01,WAPTR)                          0135 00351000
         NR    @06,@14                                             0135 00352000
         MH    @12,$CDEVPT(,WAPTR)                                 0135 00353000
         N     @14,$DEVUNAD-68(@12,WAPTR)                          0135 00354000
         CLR   @06,@14                                             0135 00355000
         BE    @RT00135                                            0135 00356000
*     GOTO S2AC0050;                /* BR IF YES                     */ 00357000
*   GOTO S2AC0150;                                                 0137 00358000
*                                                                  0137 00359000
         B     S2AC0150                                            0137 00360000
*/****************************************************************** */ 00361000
*/*      REQUEST FOR SAME CONTROL UNIT ADDRESS                       */ 00362000
*/****************************************************************** */ 00363000
*                                                                  0138 00364000
*S2AC0230:                                                         0138 00365000
*   ;                                                              0138 00366000
S2AC0230 DS    0H                                                  0139 00367000
*   IF $GRABSCU='0'B                /* REQ FOR SAME CONTROL UNIT     */ 00368000
*     THEN                                                         0139 00369000
         TM    $GRABSCU(GRAMAP),B'00010000'                        0139 00370000
         BZ    @RT00139                                            0139 00371000
*     GOTO S2AC0070;                /* BR IF NO                      */ 00372000
*   IF($DEVUNAD(I)&CUMASK)=($DEVUNAD($CDEVPT)&CUMASK)/* DO CONTROL 0141 00373000
*                                      UNITS MATCH                   */ 00374000
*     THEN                                                         0141 00375000
         L     @14,CUMASK                                          0141 00376000
         LA    @12,68                                              0141 00377000
         LR    @01,I                                               0141 00378000
         MR    @00,@12                                             0141 00379000
         L     @06,$DEVUNAD-68(@01,WAPTR)                          0141 00380000
         NR    @06,@14                                             0141 00381000
         MH    @12,$CDEVPT(,WAPTR)                                 0141 00382000
         N     @14,$DEVUNAD-68(@12,WAPTR)                          0141 00383000
         CLR   @06,@14                                             0141 00384000
         BE    @RT00141                                            0141 00385000
*     GOTO S2AC0070;                /* BR IF YES                     */ 00386000
*   GOTO S2AC0150;                                                 0143 00387000
*                                                                  0143 00388000
         B     S2AC0150                                            0143 00389000
*/****************************************************************** */ 00390000
*/*      REQUEST FOR SAME DEVICE ADDRESS                             */ 00391000
*/****************************************************************** */ 00392000
*                                                                  0144 00393000
*S2AC0250:                                                         0144 00394000
*   ;                                                              0144 00395000
S2AC0250 DS    0H                                                  0145 00396000
*   IF $GRABSDV='0'B                /* REQ FOR SAME DEVICE           */ 00397000
*     THEN                                                         0145 00398000
         TM    $GRABSDV(GRAMAP),B'00000100'                        0145 00399000
         BZ    @RT00145                                            0145 00400000
*     GOTO S2AC0090;                /* BR IF NO                      */ 00401000
*   IF($DEVUNAD(I)&DVMASK)=($DEVUNAD($CDEVPT)&DVMASK)/* DO DEVICES 0147 00402000
*                                      MATCH                         */ 00403000
*     THEN                                                         0147 00404000
         L     @14,DVMASK                                          0147 00405000
         LA    @12,68                                              0147 00406000
         LR    @01,I                                               0147 00407000
         MR    @00,@12                                             0147 00408000
         L     @06,$DEVUNAD-68(@01,WAPTR)                          0147 00409000
         NR    @06,@14                                             0147 00410000
         MH    @12,$CDEVPT(,WAPTR)                                 0147 00411000
         N     @14,$DEVUNAD-68(@12,WAPTR)                          0147 00412000
         CLR   @06,@14                                             0147 00413000
         BE    @RT00147                                            0147 00414000
*     GOTO S2AC0090;                /* BR IF YES                     */ 00415000
*   GOTO S2AC0150;                                                 0149 00416000
         B     S2AC0150                                            0149 00417000
*   DO;                             /* ATDSPLY                       */ 00418000
*   END;                            /* ATDSPLY                       */ 00419000
*   END;                                                           0152 00420000
@DATA    DS    0H                                                       00421000
@CH00086 DC    H'68'                                                    00422000
@SM00411 MVC   INPUTBUF(0,@14),$DEVTBLE-68(@06)                         00423000
         DS    0F                                                       00424000
@TF00001 DS    F                                                        00425000
         DS    0F                                                       00426000
@CF00071 DC    F'1'                                                     00427000
@CF00050 DC    F'3'                                                     00428000
@CF00032 DC    F'4'                                                     00429000
         DS    0D                                                       00430000
CHMASK   DC    XL4'0F00'                                                00431000
CUMASK   DC    XL4'00F0'                                                00432000
DVMASK   DC    XL4'000F'                                                00433000
ACQPRMLT DS    CL5                                                      00434000
         ORG   ACQPRMLT                                                 00435000
CDSPTR   DS    AL4                                                      00436000
AFLAGS   DC    AL1(192)                                                 00437000
         ORG   AFLAGS                                                   00438000
TSTMSK   DS    BL1                                                      00439000
ACQVER   EQU   AFLAGS+0                                                 00440000
@NM00015 EQU   AFLAGS+0                                                 00441000
         ORG   ACQPRMLT+5                                               00442000
         DS    CL3                                                      00443000
PATCH    DC    20F'0'                                                   00444000
@00      EQU   00                      EQUATES FOR REGISTERS 0-15       00445000
@01      EQU   01                                                       00446000
@02      EQU   02                                                       00447000
@03      EQU   03                                                       00448000
@04      EQU   04                                                       00449000
@05      EQU   05                                                       00450000
@06      EQU   06                                                       00451000
@07      EQU   07                                                       00452000
@08      EQU   08                                                       00453000
@09      EQU   09                                                       00454000
@10      EQU   10                                                       00455000
@11      EQU   11                                                       00456000
@12      EQU   12                                                       00457000
@13      EQU   13                                                       00458000
@14      EQU   14                                                       00459000
@15      EQU   15                                                       00460000
L4       EQU   @09                                                      00461000
L3       EQU   @08                                                      00462000
I        EQU   @03                                                      00463000
GRAMAP   EQU   @07                                                      00464000
WAPTR    EQU   @02                                                      00465000
R1       EQU   @01                                                      00466000
R13      EQU   @13                                                      00467000
R15      EQU   @15                                                      00468000
R0       EQU   @00                                                      00469000
R10      EQU   @10                                                      00470000
R11      EQU   @11                                                      00471000
R12      EQU   @12                                                      00472000
R14      EQU   @14                                                      00473000
R2       EQU   @02                                                      00474000
R3       EQU   @03                                                      00475000
R4       EQU   @04                                                      00476000
R5       EQU   @05                                                      00477000
R6       EQU   @06                                                      00478000
R7       EQU   @07                                                      00479000
R8       EQU   @08                                                      00480000
R9       EQU   @09                                                      00481000
TOLTEPWA EQU   0                                                        00482000
$CDA     EQU   TOLTEPWA+100                                             00483000
$RCA     EQU   $CDA+44                                                  00484000
$OLTPTR  EQU   $CDA+52                                                  00485000
$HIMOREC EQU   $CDA+60                                                  00486000
$GRCNTS  EQU   $CDA+108                                                 00487000
$DEVTBLE EQU   TOLTEPWA+240                                             00488000
$DEVCDS  EQU   $DEVTBLE                                                 00489000
$DEVUNAD EQU   $DEVCDS                                                  00490000
@NM00004 EQU   $DEVUNAD+2                                               00491000
$DEVFEAT EQU   $DEVCDS+4                                                00492000
$DEVCLAS EQU   $DEVFEAT+2                                               00493000
$DEVTYPE EQU   $DEVFEAT+3                                               00494000
$DEVCDSF EQU   $DEVCDS+9                                                00495000
$EXTRN   EQU   $DEVCDSF                                                 00496000
$CDSNAME EQU   $DEVCDSF                                                 00497000
$DEVSDCF EQU   $DEVCDS+10                                               00498000
$$SYMNME EQU   $DEVCDS+12                                               00499000
$DEVFLG1 EQU   $DEVTBLE+20                                              00500000
$LETGO   EQU   $DEVFLG1                                                 00501000
$GRABBED EQU   $DEVFLG1                                                 00502000
$EVNCPLT EQU   $DEVFLG1                                                 00503000
$ATTNEXP EQU   $DEVFLG1                                                 00504000
$INTOCC  EQU   $DEVFLG1                                                 00505000
$PRIMARY EQU   $DEVFLG1                                                 00506000
$DEVFLG2 EQU   $DEVTBLE+21                                              00507000
$DEVTECB EQU   $DEVTBLE+22                                              00508000
$OPIS    EQU   $DEVTECB                                                 00509000
$OPND    EQU   $DEVTECB+2                                               00510000
$DEVFLG3 EQU   $DEVTBLE+27                                              00511000
$NOTDEV  EQU   $DEVFLG3                                                 00512000
$ACQRED  EQU   $DEVFLG3                                                 00513000
$SIOFLG  EQU   $DEVFLG3                                                 00514000
$IFTOUT  EQU   $DEVTBLE+36                                              00515000
$DEVSESP EQU   $IFTOUT                                                  00516000
$SSCPDAF EQU   $IFTOUT+6                                                00517000
$LDNCBPT EQU   $DEVTBLE+48                                              00518000
$RNINFO  EQU   $DEVTBLE+56                                              00519000
$DEVFLG5 EQU   $RNINFO+8                                                00520000
$DEVFLG4 EQU   $DEVTBLE+65                                              00521000
$DEVCNTS EQU   TOLTEPWA+1464                                            00522000
$CDEVPT  EQU   TOLTEPWA+1466                                            00523000
#EXITA   EQU   TOLTEPWA+2632                                            00524000
$CCOMDAT EQU   TOLTEPWA+2644                                            00525000
$CFLGS   EQU   $CCOMDAT+16                                              00526000
$24FEMSG EQU   TOLTEPWA+2681                                            00527000
$24CATMG EQU   $24FEMSG+11                                              00528000
@NM00012 EQU   TOLTEPWA+2776                                            00529000
$OUNTPTR EQU   @NM00012+4                                               00530000
$NSPTR   EQU   $OUNTPTR                                                 00531000
$NSCNT   EQU   @NM00012+10                                              00532000
$ENXX    EQU   @NM00012+15                                              00533000
$IMITX   EQU   $ENXX                                                    00534000
SVESC033 EQU   TOLTEPWA+3160                                            00535000
SVECC013 EQU   TOLTEPWA+3232                                            00536000
SVEIC003 EQU   TOLTEPWA+3592                                            00537000
SVESC022 EQU   TOLTEPWA+3736                                            00538000
SVECC011 EQU   TOLTEPWA+4024                                            00539000
GRABMAP  EQU   0                                                        00540000
$GRABCDS EQU   GRABMAP+4                                                00541000
$GRABFLG EQU   GRABMAP+8                                                00542000
$GRABDCH EQU   $GRABFLG                                                 00543000
$GRABSCH EQU   $GRABFLG                                                 00544000
$GRABDCU EQU   $GRABFLG                                                 00545000
$GRABSCU EQU   $GRABFLG                                                 00546000
$GRABDDV EQU   $GRABFLG                                                 00547000
$GRABSDV EQU   $GRABFLG                                                 00548000
$GRABCLA EQU   $GRABFLG                                                 00549000
$GRABUNT EQU   $GRABFLG                                                 00550000
$GRABCLS EQU   GRABMAP+9                                                00551000
$GRABTYP EQU   GRABMAP+10                                               00552000
$GRABCNT EQU   GRABMAP+11                                               00553000
BACKSAVE EQU   0                                                        00554000
INPUTBUF EQU   0                                                        00555000
#EXIT    EQU   0                                                        00556000
SVESC02A EQU   SVESC022                                                 00557000
SVECC012 EQU   SVESC022                                                 00558000
SVEIC00A EQU   SVEIC003                                                 00559000
SVEIC004 EQU   SVEIC003                                                 00560000
SVEIC005 EQU   SVEIC003                                                 00561000
SVESC02B EQU   SVESC022                                                 00562000
SVESC02D EQU   SVESC022                                                 00563000
SVESC02E EQU   SVESC022                                                 00564000
SVESC02F EQU   SVECC013                                                 00565000
SVESC024 EQU   SVESC022                                                 00566000
SVESC027 EQU   SVESC022                                                 00567000
SVESC029 EQU   SVESC033                                                 00568000
SVESC031 EQU   SVECC013                                                 00569000
SVESC032 EQU   SVECC011                                                 00570000
SVETC037 EQU   SVEIC003                                                 00571000
         AGO   .@UNREFD                START UNREFERENCED COMPONENTS    00572000
$GRBIDNT EQU   GRABMAP+2                                                00573000
$GRBLEVL EQU   GRABMAP+1                                                00574000
$GRBTRMG EQU   GRABMAP                                                  00575000
SVECC010 EQU   TOLTEPWA+3952                                            00576000
SVETC035 EQU   TOLTEPWA+3880                                            00577000
SVESC030 EQU   TOLTEPWA+3808                                            00578000
SVESC020 EQU   TOLTEPWA+3664                                            00579000
SVEIC002 EQU   TOLTEPWA+3520                                            00580000
SVECC014 EQU   TOLTEPWA+3376                                            00581000
SVESC120 EQU   TOLTEPWA+3304                                            00582000
SVESC025 EQU   TOLTEPWA+3088                                            00583000
@NM00014 EQU   TOLTEPWA+2980                                            00584000
$RPLERR  EQU   TOLTEPWA+2977                                            00585000
@NM00013 EQU   TOLTEPWA+2976                                            00586000
$R13PR3  EQU   TOLTEPWA+2972                                            00587000
$CEINT2  EQU   TOLTEPWA+2968                                            00588000
$CEINT1  EQU   TOLTEPWA+2964                                            00589000
$MSGGET  EQU   TOLTEPWA+2960                                            00590000
$ACQLIST EQU   TOLTEPWA+2956                                            00591000
$R4SAVE1 EQU   TOLTEPWA+2952                                            00592000
$CLSISS  EQU   TOLTEPWA+2950                                            00593000
$CLSCNT  EQU   TOLTEPWA+2948                                            00594000
$CUTABLE EQU   TOLTEPWA+2868                                            00595000
$BUFSZ2  EQU   TOLTEPWA+2864                                            00596000
$RESID2  EQU   TOLTEPWA+2860                                            00597000
$OLTCCW2 EQU   TOLTEPWA+2856                                            00598000
$ENDBFR2 EQU   TOLTEPWA+2852                                            00599000
$1STBFR2 EQU   TOLTEPWA+2848                                            00600000
$TECB2   EQU   TOLTEPWA+2844                                            00601000
$BUFSZ1  EQU   TOLTEPWA+2840                                            00602000
$RESID1  EQU   TOLTEPWA+2836                                            00603000
$OLTCCW1 EQU   TOLTEPWA+2832                                            00604000
$ENDBFR1 EQU   TOLTEPWA+2828                                            00605000
$1STBFR1 EQU   TOLTEPWA+2824                                            00606000
$TECB1   EQU   TOLTEPWA+2820                                            00607000
$WAITIME EQU   TOLTEPWA+2816                                            00608000
$TRTN#   EQU   TOLTEPWA+2815                                            00609000
$WIODEV  EQU   TOLTEPWA+2814                                            00610000
$RQSTSZE EQU   TOLTEPWA+2812                                            00611000
$RQSTPTR EQU   TOLTEPWA+2808                                            00612000
$R4SAVE  EQU   TOLTEPWA+2804                                            00613000
$PARTADR EQU   TOLTEPWA+2800                                            00614000
$TBSDATA EQU   TOLTEPWA+2796                                            00615000
$CTWIDTH EQU   TOLTEPWA+2795                                            00616000
$CTLINE  EQU   TOLTEPWA+2794                                            00617000
$APWIDTH EQU   TOLTEPWA+2793                                            00618000
$APLINE  EQU   TOLTEPWA+2792                                            00619000
$INDEX   EQU   $IMITX                                                   00620000
$UMXX    EQU   @NM00012+14                                              00621000
$NSXX    EQU   @NM00012+12                                              00622000
$ATACNT  EQU   $NSCNT                                                   00623000
$CTR     EQU   @NM00012+8                                               00624000
$ATAPTR  EQU   $NSPTR                                                   00625000
$DDRPTR  EQU   @NM00012                                                 00626000
$DTORESP EQU   TOLTEPWA+2712                                            00627000
$APNAME  EQU   TOLTEPWA+2704                                            00628000
$24SYMNE EQU   $24CATMG+4                                               00629000
$24DEVAD EQU   $24CATMG                                                 00630000
$24RTN#  EQU   $24FEMSG+8                                               00631000
$ESECTID EQU   $24FEMSG                                                 00632000
$24FLGS  EQU   TOLTEPWA+2680                                            00633000
$24SAVE2 EQU   TOLTEPWA+2676                                            00634000
$24SAVE1 EQU   TOLTEPWA+2672                                            00635000
$24UNADR EQU   TOLTEPWA+2668                                            00636000
$24SAV13 EQU   TOLTEPWA+2664                                            00637000
$24RETCD EQU   TOLTEPWA+2663                                            00638000
$MACID   EQU   TOLTEPWA+2661                                            00639000
$CSPARE  EQU   $CFLGS                                                   00640000
$C2WAY   EQU   $CFLGS                                                   00641000
$CINCT   EQU   $CCOMDAT+12                                              00642000
$CINADR  EQU   $CCOMDAT+8                                               00643000
$COUTCT  EQU   $CCOMDAT+4                                               00644000
$COUTAD  EQU   $CCOMDAT                                                 00645000
ROOTLOC  EQU   TOLTEPWA+2640                                            00646000
$RETREG  EQU   TOLTEPWA+2636                                            00647000
$WORK    EQU   TOLTEPWA+2376                                            00648000
$EXTA    EQU   TOLTEPWA+2320                                            00649000
$PASSONA EQU   TOLTEPWA+2264                                            00650000
$TRMINPT EQU   TOLTEPWA+2184                                            00651000
$INBUFR  EQU   TOLTEPWA+2104                                            00652000
$BUFFER  EQU   TOLTEPWA+1976                                            00653000
$TLTRPL3 EQU   TOLTEPWA+1856                                            00654000
$TLTRPL2 EQU   TOLTEPWA+1736                                            00655000
$TLTRPL1 EQU   TOLTEPWA+1616                                            00656000
$SLTBL   EQU   TOLTEPWA+1468                                            00657000
$FEEDBCK EQU   $DEVTBLE+66                                              00658000
$WTISUED EQU   $DEVFLG4                                                 00659000
$EXIOISD EQU   $DEVFLG4                                                 00660000
$REMWRIT EQU   $DEVFLG4                                                 00661000
$REMDONE EQU   $DEVFLG4                                                 00662000
$2NDUSED EQU   $DEVFLG4                                                 00663000
$1STUSED EQU   $DEVFLG4                                                 00664000
$IGLXIFB EQU   $DEVFLG4                                                 00665000
$EXIOLV3 EQU   $DEVFLG4                                                 00666000
@NM00011 EQU   $DEVFLG5                                                 00667000
$DVBASIC EQU   $DEVFLG5                                                 00668000
$ASCII   EQU   $DEVFLG5                                                 00669000
$DEVLU   EQU   $DEVFLG5                                                 00670000
$OPNDFAL EQU   $DEVFLG5                                                 00671000
$ACQNCB  EQU   $DEVFLG5                                                 00672000
$REMOTE  EQU   $DEVFLG5                                                 00673000
$ENDNODE EQU   $DEVFLG5                                                 00674000
$LINENME EQU   $RNINFO                                                  00675000
$CID     EQU   $DEVTBLE+52                                              00676000
$DVCOL   EQU   $LDNCBPT+2                                               00677000
$DVROW   EQU   $LDNCBPT                                                 00678000
$NCSPLP  EQU   $DEVTBLE+44                                              00679000
$DVLN    EQU   $SSCPDAF                                                 00680000
$DAF     EQU   $DEVSESP+4                                               00681000
$VARYPAB EQU   $DEVSESP                                                 00682000
$SYSMN   EQU   $DEVTBLE+28                                              00683000
@NM00010 EQU   $DEVFLG3                                                 00684000
$CLRSNT  EQU   $DEVFLG3                                                 00685000
$OLTERR  EQU   $DEVFLG3                                                 00686000
$SRTEST  EQU   $DEVFLG3                                                 00687000
$DVSNDOK EQU   $SIOFLG                                                  00688000
$POLLREQ EQU   $DEVFLG3                                                 00689000
$DVINCT  EQU   $DEVTBLE+26                                              00690000
$DVBRKST EQU   $OPND+1                                                  00691000
$DVBRKSN EQU   $OPND                                                    00692000
$DVSEQNO EQU   $OPIS                                                    00693000
$CEINTRP EQU   $DEVFLG2                                                 00694000
$TESTMDE EQU   $DEVFLG2                                                 00695000
$DEVALOC EQU   $DEVFLG2                                                 00696000
$ALLDATA EQU   $DEVFLG2                                                 00697000
$ENDCNTL EQU   $DEVFLG2                                                 00698000
$CTLDEV  EQU   $DEVFLG2                                                 00699000
$NOCDS   EQU   $DEVFLG2                                                 00700000
$DATAIN  EQU   $DEVFLG2                                                 00701000
$DVCTBYT EQU   $INTOCC                                                  00702000
$DEVACT  EQU   $DEVFLG1                                                 00703000
$DVLGMDE EQU   $ATTNEXP                                                 00704000
$DVSPRM  EQU   $EVNCPLT                                                 00705000
$CATASTR EQU   $DEVFLG1                                                 00706000
$CURELEM EQU   $$SYMNME+4                                               00707000
$MSGOTSD EQU   $$SYMNME                                                 00708000
$EXTDEV  EQU   $DEVCDS+11                                               00709000
@NM00009 EQU   $DEVSDCF                                                 00710000
$NOTPRIM EQU   $DEVSDCF                                                 00711000
@NM00008 EQU   $DEVCDSF                                                 00712000
@NM00007 EQU   $DEVCDSF                                                 00713000
@NM00006 EQU   $DEVCDSF                                                 00714000
$CEVOLUM EQU   $DEVCDSF                                                 00715000
$SHARD   EQU   $DEVCDSF                                                 00716000
$DEVFPM  EQU   $DEVCDSF                                                 00717000
$DEVCNT  EQU   $DEVCDS+8                                                00718000
$DEVFRRS EQU   $DEVFEAT+1                                               00719000
$DEVMOD  EQU   $DEVFEAT                                                 00720000
$DEVRDGT EQU   @NM00004+1                                               00721000
$DEVCTLU EQU   @NM00004+1                                               00722000
$DEVCHAN EQU   @NM00004                                                 00723000
@NM00005 EQU   @NM00004                                                 00724000
$CTINDX  EQU   $DEVUNAD                                                 00725000
$COMMFLG EQU   TOLTEPWA+224                                             00726000
@NM00003 EQU   $CDA+120                                                 00727000
$CUCNT   EQU   $CDA+118                                                 00728000
@NM00002 EQU   $CDA+117                                                 00729000
$PRTFORM EQU   $CDA+116                                                 00730000
$OPISCNT EQU   $CDA+114                                                 00731000
$OPNDCNT EQU   $CDA+112                                                 00732000
$GETMSZE EQU   $CDA+110                                                 00733000
$CTLCNT  EQU   $CDA+106                                                 00734000
$ACTLVL  EQU   $CDA+105                                                 00735000
$PRNTLVL EQU   $CDA+104                                                 00736000
$ERRCNTA EQU   $CDA+102                                                 00737000
$TLCNT   EQU   $CDA+100                                                 00738000
$TIMEALW EQU   $CDA+96                                                  00739000
$PTRAREA EQU   $CDA+92                                                  00740000
$GETMPTR EQU   $CDA+88                                                  00741000
$R13PTRT EQU   $CDA+84                                                  00742000
$R13PTR  EQU   $CDA+80                                                  00743000
$TEPEND  EQU   $CDA+76                                                  00744000
$PLINKDL EQU   $CDA+72                                                  00745000
$TEPBEGN EQU   $CDA+68                                                  00746000
$FRELPTR EQU   $CDA+64                                                  00747000
$HIGHADR EQU   $HIMOREC                                                 00748000
$LOMOREC EQU   $CDA+56                                                  00749000
$LOWADDR EQU   $OLTPTR                                                  00750000
$ENDCOMM EQU   $CDA+48                                                  00751000
$COMMON  EQU   $RCA                                                     00752000
$SLASHAD EQU   $CDA+32                                                  00753000
$PASSON  EQU   $CDA+28                                                  00754000
$TOLBRTB EQU   $CDA+24                                                  00755000
$SCTPTR8 EQU   $CDA+20                                                  00756000
$SCTPTR  EQU   $CDA+16                                                  00757000
$TBWDPTR EQU   $CDA+12                                                  00758000
$TFWDPTR EQU   $CDA+8                                                   00759000
@NM00001 EQU   $CDA                                                     00760000
$SCTTBLE EQU   TOLTEPWA                                                 00761000
.@UNREFD ANOP                          END UNREFERENCED COMPONENTS      00762000
@RT00072 EQU   S2AC0150                                                 00763000
@RT00074 EQU   S2AC0150                                                 00764000
@RT00076 EQU   S2AC0090                                                 00765000
@RT00078 EQU   S2AC0210                                                 00766000
@RT00080 EQU   S2AC0150                                                 00767000
@RT00083 EQU   S2AC0230                                                 00768000
@RT00085 EQU   S2AC0150                                                 00769000
@RT00088 EQU   S2AC0250                                                 00770000
@RT00090 EQU   S2AC0150                                                 00771000
@RT00093 EQU   S2AC0110                                                 00772000
@RT00095 EQU   S2AC0150                                                 00773000
@RT00098 EQU   S2AC0130                                                 00774000
@RT00100 EQU   S2AC0150                                                 00775000
@RT00133 EQU   S2AC0050                                                 00776000
@RT00135 EQU   S2AC0050                                                 00777000
@RT00139 EQU   S2AC0070                                                 00778000
@RT00141 EQU   S2AC0070                                                 00779000
@RT00145 EQU   S2AC0090                                                 00780000
@RT00147 EQU   S2AC0090                                                 00781000
@ENDDATA EQU   *                                                        00782000
         END   ISTSC02A,(C'PLS0859',0702,78337)                         00783000
./  ADD  SSI=83360409,NAME=ISTSC02B
         TITLE 'ISTSC02B,LETGO. RELEASES GRABBED SECONDARY DEVICES'     00001000
ISTSC02B CSECT ,                                                   0001 00002000
@MAINENT DS    0H                                                  0001 00003000
         USING *,@15                                               0001 00004000
         B     @PROLOG                                             0001 00005000
         DC    AL1(16)                                             0001 00006000
         DC    C'ISTSC02B  78.337'                                 0001 00007000
         DROP  @15                                                      00008000
@PROLOG  ST    @14,12(,@13)                                        0001 00009000
         STM   @00,@12,20(@13)                                     0001 00010000
         BALR  @04,0                                               0001 00011000
@PSTART  DS    0H                                                  0001 00012000
         USING @PSTART,@04                                         0001 00013000
*                                                                  0028 00014000
*/********************************************************************/ 00015000
*/*     INITIALIZATION                                               */ 00016000
*/********************************************************************/ 00017000
*                                                                  0029 00018000
*   LETMAP=R1;                      /* GET PARMETER LIST             */ 00019000
         LR    LETMAP,R1                                           0029 00020000
*   LTGOCDS=$LTGOPTR;               /* GET PTR TO CDS                */ 00021000
         L     LTGOCDS,$LTGOPTR(,LETMAP)                           0030 00022000
*/********************************************************************/ 00023000
*/*     CODE TO DETERMINE IF  A SYMBOLICALLY NAMED DEVICE IS TO BE   */ 00024000
*/*                            LETGO                                 */ 00025000
*/********************************************************************/ 00026000
*                                                                  0031 00027000
*   IF CDSSYMB='1'B&CDSREMSY='1'B   /* LETGO A SYMBOLIC NAME         */ 00028000
*     THEN                                                         0031 00029000
         TM    CDSSYMB(LTGOCDS),B'00001010'                        0031 00030000
         BO    @RT00031                                            0031 00031000
*     GOTO S2BC0005;                /* BR                            */ 00032000
*/********************************************************************/ 00033000
*/*     LETGO A UNIT ADDRESS FROM THE DEVICE ENTRY TABLE             */ 00034000
*/********************************************************************/ 00035000
*                                                                  0033 00036000
*   DO I=3 TO $DEVCNTS;             /* SET UP LOOP                   */ 00037000
         LA    I,3                                                 0033 00038000
         B     @DE00033                                            0033 00039000
@DL00033 DS    0H                                                  0034 00040000
*     IF $DEVUNAD(I)¬=CDSUA         /* DO ADDR MATCH                 */ 00041000
*       THEN                                                       0034 00042000
         LR    @14,I                                               0034 00043000
         MH    @14,@CH00045                                        0034 00044000
         L     @12,$DEVUNAD-68(@14,WAPTR)                          0034 00045000
         CL    @12,CDSUA(,LTGOCDS)                                 0034 00046000
         BNE   @RT00034                                            0034 00047000
*       GOTO S2BC0003;              /* BR IF NO                      */ 00048000
*     IF $GRABBED(I)='0'B|$LETGO(I)='1'B THEN                      0036 00049000
         ST    @14,@TF00001                                        0036 00050000
         ALR   @14,WAPTR                                           0036 00051000
         TM    $LETGO-68(@14),B'10000000'                          0036 00052000
         BNZ   @RT00036                                            0036 00053000
         TM    $GRABBED-68(@14),B'00100000'                        0036 00054000
         BNO   @RT00036                                            0036 00055000
*       GOTO S2BC0003;              /* BR IF NO                      */ 00056000
*     NMPTR=ADDR($SYSMN(I));        /* SET UP PTR TO ENTRY           */ 00057000
         L     @14,@TF00001                                        0038 00058000
         LA    @14,$SYSMN-68(@14,WAPTR)                            0038 00059000
         ST    @14,NMPTR                                           0038 00060000
*     GOTO S2BC0050;                /* GOTO LETGO                    */ 00061000
         B     S2BC0050                                            0039 00062000
*S2BC0003:                                                         0040 00063000
*     ;                                                            0040 00064000
S2BC0003 DS    0H                                                  0041 00065000
*   END;                                                           0041 00066000
         AL    I,@CF00057                                          0041 00067000
@DE00033 CH    I,$DEVCNTS(,WAPTR)                                  0041 00068000
         BNH   @DL00033                                            0041 00069000
*   GOTO S2BC0030;                                                 0042 00070000
*                                                                  0042 00071000
         B     S2BC0030                                            0042 00072000
*/********************************************************************/ 00073000
*/*     LETGO A SYMBOLIC NAME FROM THE DEVICE ENTRY TABLE            */ 00074000
*/********************************************************************/ 00075000
*                                                                  0043 00076000
*S2BC0005:                                                         0043 00077000
*   ;                                                              0043 00078000
S2BC0005 DS    0H                                                  0044 00079000
*   DO I=3 TO $DEVCNTS;             /* SET UP LOOP                   */ 00080000
         LA    I,3                                                 0044 00081000
         B     @DE00044                                            0044 00082000
@DL00044 DS    0H                                                  0045 00083000
*     IF $$SYMNME(I)¬=CDSSYMBN      /* DO SYMBOLIC NAMES MATCH       */ 00084000
*       THEN                                                       0045 00085000
         LR    @14,I                                               0045 00086000
         MH    @14,@CH00045                                        0045 00087000
         ST    @14,@TF00001                                        0045 00088000
         ALR   @14,WAPTR                                           0045 00089000
         CLC   $$SYMNME-68(8,@14),CDSSYMBN(LTGOCDS)                0045 00090000
         BNE   @RT00045                                            0045 00091000
*       GOTO S2BC0010;              /* NO, GET NEXT TABLE ENTRY      */ 00092000
*     IF $GRABBED(I)='0'B|$LETGO(I)='1'B THEN                      0047 00093000
         LR    @14,WAPTR                                           0047 00094000
         AL    @14,@TF00001                                        0047 00095000
         TM    $LETGO-68(@14),B'10000000'                          0047 00096000
         BNZ   @RT00047                                            0047 00097000
         TM    $GRABBED-68(@14),B'00100000'                        0047 00098000
         BNO   @RT00047                                            0047 00099000
*       GOTO S2BC0010;                                             0048 00100000
*     NMPTR=ADDR(CDSSYMBN);         /* SET PTR TO S.N.               */ 00101000
         LA    @14,CDSSYMBN(,LTGOCDS)                              0049 00102000
         ST    @14,NMPTR                                           0049 00103000
*     GOTO S2BC0050;                /* GOTO RELEASE                  */ 00104000
         B     S2BC0050                                            0050 00105000
*S2BC0010:                                                         0051 00106000
*     ;                                                            0051 00107000
S2BC0010 DS    0H                                                  0052 00108000
*   END;                                                           0052 00109000
*                                                                  0052 00110000
         AL    I,@CF00057                                          0052 00111000
@DE00044 CH    I,$DEVCNTS(,WAPTR)                                  0052 00112000
         BNH   @DL00044                                            0052 00113000
*/********************************************************************/ 00114000
*/*     DEVICE NOT FOUND, SET ERROR RETURN CODE                      */ 00115000
*/********************************************************************/ 00116000
*                                                                  0053 00117000
*S2BC0030:                                                         0053 00118000
*   ;                                                              0053 00119000
S2BC0030 DS    0H                                                  0054 00120000
*   R15=12;                         /* SET ERROR RETURN CODE         */ 00121000
         LA    R15,12                                              0054 00122000
*/********************************************************************/ 00123000
*/*     CALL RELEASE FUNCTION AND SET THE APPROPRIATE RETURN CODE    */ 00124000
*/********************************************************************/ 00125000
*                                                                  0055 00126000
*   RETURN;                         /* RETURN TO CALLER              */ 00127000
@EL00001 DS    0H                                                  0055 00128000
@EF00001 DS    0H                                                  0055 00129000
@ER00001 L     @14,12(,@13)                                        0055 00130000
         LM    @00,@12,20(@13)                                     0055 00131000
         BR    @14                                                 0055 00132000
*S2BC0050:                                                         0056 00133000
*   ;                                                              0056 00134000
S2BC0050 DS    0H                                                  0057 00135000
*   $LETGO(I)='1'B;                                                0057 00136000
         LR    @14,I                                               0057 00137000
         MH    @14,@CH00045                                        0057 00138000
         ALR   @14,WAPTR                                           0057 00139000
         OI    $LETGO-68(@14),B'10000000'                          0057 00140000
*   R15=0;                          /* SET RETURN CODE TO 0          */ 00141000
         SLR   R15,R15                                             0058 00142000
*   RETURN;                         /* RETURN TO OLT                 */ 00143000
         B     @EL00001                                            0059 00144000
*   DO;                             /* ATDSPLY                       */ 00145000
*   END;                            /* ATDSPLY                       */ 00146000
*   END;                                                           0062 00147000
@DATA    DS    0H                                                       00148000
@CH00045 DC    H'68'                                                    00149000
         DS    0F                                                       00150000
@TF00001 DS    F                                                        00151000
         DS    0F                                                       00152000
@CF00057 DC    F'1'                                                     00153000
         DS    0D                                                       00154000
RELPMLST DS    CL5                                                      00155000
         ORG   RELPMLST                                                 00156000
NMPTR    DS    AL4                                                      00157000
@NM00011 DC    AL1(0)                                                   00158000
         ORG   RELPMLST+5                                               00159000
         DS    CL3                                                      00160000
PATCH    DC    10F'0'                                                   00161000
@00      EQU   00                      EQUATES FOR REGISTERS 0-15       00162000
@01      EQU   01                                                       00163000
@02      EQU   02                                                       00164000
@03      EQU   03                                                       00165000
@04      EQU   04                                                       00166000
@05      EQU   05                                                       00167000
@06      EQU   06                                                       00168000
@07      EQU   07                                                       00169000
@08      EQU   08                                                       00170000
@09      EQU   09                                                       00171000
@10      EQU   10                                                       00172000
@11      EQU   11                                                       00173000
@12      EQU   12                                                       00174000
@13      EQU   13                                                       00175000
@14      EQU   14                                                       00176000
@15      EQU   15                                                       00177000
I        EQU   @06                                                      00178000
LTGOCDS  EQU   @07                                                      00179000
LETMAP   EQU   @06                                                      00180000
WAPTR    EQU   @02                                                      00181000
R1       EQU   @01                                                      00182000
R15      EQU   @15                                                      00183000
R0       EQU   @00                                                      00184000
R10      EQU   @10                                                      00185000
R11      EQU   @11                                                      00186000
R12      EQU   @12                                                      00187000
R13      EQU   @13                                                      00188000
R14      EQU   @14                                                      00189000
R2       EQU   @02                                                      00190000
R3       EQU   @03                                                      00191000
R4       EQU   @04                                                      00192000
R5       EQU   @05                                                      00193000
R6       EQU   @06                                                      00194000
R7       EQU   @07                                                      00195000
R8       EQU   @08                                                      00196000
R9       EQU   @09                                                      00197000
TOLTEPWA EQU   0                                                        00198000
$DEVTBLE EQU   TOLTEPWA+240                                             00199000
$DEVCDS  EQU   $DEVTBLE                                                 00200000
$DEVUNAD EQU   $DEVCDS                                                  00201000
@NM00001 EQU   $DEVUNAD+2                                               00202000
$DEVFEAT EQU   $DEVCDS+4                                                00203000
$DEVCDSF EQU   $DEVCDS+9                                                00204000
$DEVSDCF EQU   $DEVCDS+10                                               00205000
$$SYMNME EQU   $DEVCDS+12                                               00206000
$DEVFLG1 EQU   $DEVTBLE+20                                              00207000
$LETGO   EQU   $DEVFLG1                                                 00208000
$GRABBED EQU   $DEVFLG1                                                 00209000
$EVNCPLT EQU   $DEVFLG1                                                 00210000
$ATTNEXP EQU   $DEVFLG1                                                 00211000
$INTOCC  EQU   $DEVFLG1                                                 00212000
$DEVFLG2 EQU   $DEVTBLE+21                                              00213000
$DEVTECB EQU   $DEVTBLE+22                                              00214000
$OPIS    EQU   $DEVTECB                                                 00215000
$OPND    EQU   $DEVTECB+2                                               00216000
$DEVFLG3 EQU   $DEVTBLE+27                                              00217000
$SIOFLG  EQU   $DEVFLG3                                                 00218000
$SYSMN   EQU   $DEVTBLE+28                                              00219000
$IFTOUT  EQU   $DEVTBLE+36                                              00220000
$DEVSESP EQU   $IFTOUT                                                  00221000
$SSCPDAF EQU   $IFTOUT+6                                                00222000
$LDNCBPT EQU   $DEVTBLE+48                                              00223000
$RNINFO  EQU   $DEVTBLE+56                                              00224000
$DEVFLG5 EQU   $RNINFO+8                                                00225000
$DEVFLG4 EQU   $DEVTBLE+65                                              00226000
$DEVCNTS EQU   TOLTEPWA+1464                                            00227000
LETGOMAP EQU   0                                                        00228000
$LTGOPTR EQU   LETGOMAP+4                                               00229000
CDSMAP   EQU   0                                                        00230000
CDSUA    EQU   CDSMAP                                                   00231000
CDSMFCT  EQU   CDSMAP+4                                                 00232000
CDSFEAT  EQU   CDSMFCT+1                                                00233000
CDSFLAG  EQU   CDSMAP+9                                                 00234000
CDSSYMB  EQU   CDSFLAG                                                  00235000
CDSREMSY EQU   CDSFLAG                                                  00236000
CDSSYMBN EQU   CDSMAP+12                                                00237000
         AGO   .@UNREFD                START UNREFERENCED COMPONENTS    00238000
CDSEXARA EQU   CDSMAP+20                                                00239000
CDSEXTM  EQU   CDSFLAG+2                                                00240000
CDSEXTB  EQU   CDSFLAG+2                                                00241000
CDSTMERB EQU   CDSFLAG+2                                                00242000
@NM00010 EQU   CDSFLAG+1                                                00243000
CDSDVPRO EQU   CDSFLAG+1                                                00244000
CDSNTPRI EQU   CDSFLAG+1                                                00245000
CDSLINCN EQU   CDSFLAG                                                  00246000
CDS2CHAN EQU   CDSFLAG                                                  00247000
CDSEXTPR EQU   CDSFLAG                                                  00248000
CDSFEVOL EQU   CDSFLAG                                                  00249000
CDSSHAR  EQU   CDSFLAG                                                  00250000
CDSFPMD  EQU   CDSFLAG                                                  00251000
CDSBYTCT EQU   CDSMAP+8                                                 00252000
CDSTYPE  EQU   CDSMFCT+3                                                00253000
CDSCLASS EQU   CDSMFCT+2                                                00254000
@NM00009 EQU   CDSFEAT                                                  00255000
CDSDEVM  EQU   CDSFEAT                                                  00256000
CDSDEVT  EQU   CDSFEAT                                                  00257000
CDSASCII EQU   CDSFEAT                                                  00258000
CDSMODEL EQU   CDSMFCT                                                  00259000
$LGOIDNT EQU   LETGOMAP+2                                               00260000
$LGOLEVL EQU   LETGOMAP+1                                               00261000
$LGOTRMG EQU   LETGOMAP                                                 00262000
$WORKARA EQU   TOLTEPWA+1616                                            00263000
$SLTBL   EQU   TOLTEPWA+1468                                            00264000
$CDEVPT  EQU   TOLTEPWA+1466                                            00265000
$FEEDBCK EQU   $DEVTBLE+66                                              00266000
$WTISUED EQU   $DEVFLG4                                                 00267000
$EXIOISD EQU   $DEVFLG4                                                 00268000
$REMWRIT EQU   $DEVFLG4                                                 00269000
$REMDONE EQU   $DEVFLG4                                                 00270000
$2NDUSED EQU   $DEVFLG4                                                 00271000
$1STUSED EQU   $DEVFLG4                                                 00272000
$IGLXIFB EQU   $DEVFLG4                                                 00273000
$EXIOLV3 EQU   $DEVFLG4                                                 00274000
@NM00008 EQU   $DEVFLG5                                                 00275000
$DVBASIC EQU   $DEVFLG5                                                 00276000
$ASCII   EQU   $DEVFLG5                                                 00277000
$DEVLU   EQU   $DEVFLG5                                                 00278000
$OPNDFAL EQU   $DEVFLG5                                                 00279000
$ACQNCB  EQU   $DEVFLG5                                                 00280000
$REMOTE  EQU   $DEVFLG5                                                 00281000
$ENDNODE EQU   $DEVFLG5                                                 00282000
$LINENME EQU   $RNINFO                                                  00283000
$CID     EQU   $DEVTBLE+52                                              00284000
$DVCOL   EQU   $LDNCBPT+2                                               00285000
$DVROW   EQU   $LDNCBPT                                                 00286000
$NCSPLP  EQU   $DEVTBLE+44                                              00287000
$DVLN    EQU   $SSCPDAF                                                 00288000
$DAF     EQU   $DEVSESP+4                                               00289000
$VARYPAB EQU   $DEVSESP                                                 00290000
@NM00007 EQU   $DEVFLG3                                                 00291000
$CLRSNT  EQU   $DEVFLG3                                                 00292000
$OLTERR  EQU   $DEVFLG3                                                 00293000
$SRTEST  EQU   $DEVFLG3                                                 00294000
$DVSNDOK EQU   $SIOFLG                                                  00295000
$POLLREQ EQU   $DEVFLG3                                                 00296000
$ACQRED  EQU   $DEVFLG3                                                 00297000
$NOTDEV  EQU   $DEVFLG3                                                 00298000
$DVINCT  EQU   $DEVTBLE+26                                              00299000
$DVBRKST EQU   $OPND+1                                                  00300000
$DVBRKSN EQU   $OPND                                                    00301000
$DVSEQNO EQU   $OPIS                                                    00302000
$CEINTRP EQU   $DEVFLG2                                                 00303000
$TESTMDE EQU   $DEVFLG2                                                 00304000
$DEVALOC EQU   $DEVFLG2                                                 00305000
$ALLDATA EQU   $DEVFLG2                                                 00306000
$ENDCNTL EQU   $DEVFLG2                                                 00307000
$CTLDEV  EQU   $DEVFLG2                                                 00308000
$NOCDS   EQU   $DEVFLG2                                                 00309000
$DATAIN  EQU   $DEVFLG2                                                 00310000
$PRIMARY EQU   $DEVFLG1                                                 00311000
$DVCTBYT EQU   $INTOCC                                                  00312000
$DEVACT  EQU   $DEVFLG1                                                 00313000
$DVLGMDE EQU   $ATTNEXP                                                 00314000
$DVSPRM  EQU   $EVNCPLT                                                 00315000
$CATASTR EQU   $DEVFLG1                                                 00316000
$CURELEM EQU   $$SYMNME+4                                               00317000
$MSGOTSD EQU   $$SYMNME                                                 00318000
$EXTDEV  EQU   $DEVCDS+11                                               00319000
@NM00006 EQU   $DEVSDCF                                                 00320000
$NOTPRIM EQU   $DEVSDCF                                                 00321000
@NM00005 EQU   $DEVCDSF                                                 00322000
@NM00004 EQU   $DEVCDSF                                                 00323000
@NM00003 EQU   $DEVCDSF                                                 00324000
$CDSNAME EQU   $DEVCDSF                                                 00325000
$EXTRN   EQU   $DEVCDSF                                                 00326000
$CEVOLUM EQU   $DEVCDSF                                                 00327000
$SHARD   EQU   $DEVCDSF                                                 00328000
$DEVFPM  EQU   $DEVCDSF                                                 00329000
$DEVCNT  EQU   $DEVCDS+8                                                00330000
$DEVTYPE EQU   $DEVFEAT+3                                               00331000
$DEVCLAS EQU   $DEVFEAT+2                                               00332000
$DEVFRRS EQU   $DEVFEAT+1                                               00333000
$DEVMOD  EQU   $DEVFEAT                                                 00334000
$DEVRDGT EQU   @NM00001+1                                               00335000
$DEVCTLU EQU   @NM00001+1                                               00336000
$DEVCHAN EQU   @NM00001                                                 00337000
@NM00002 EQU   @NM00001                                                 00338000
$CTINDX  EQU   $DEVUNAD                                                 00339000
$COMMFLG EQU   TOLTEPWA+224                                             00340000
$CDA     EQU   TOLTEPWA+100                                             00341000
$SCTTBLE EQU   TOLTEPWA                                                 00342000
.@UNREFD ANOP                          END UNREFERENCED COMPONENTS      00343000
@RT00031 EQU   S2BC0005                                                 00344000
@RT00034 EQU   S2BC0003                                                 00345000
@RT00036 EQU   S2BC0003                                                 00346000
@RT00045 EQU   S2BC0010                                                 00347000
@RT00047 EQU   S2BC0010                                                 00348000
@ENDDATA EQU   *                                                        00349000
         END   ISTSC02B,(C'PLS0901',0702,78337)                         00350000
./  ADD  SSI=83370143,NAME=ISTSC02C
         TITLE 'ISTSC02C-MORECORE'                                      00001000
ISTSC02C CSECT ,                                                   0001 00002000
@MAINENT DS    0H                                                  0001 00003000
         USING *,@15                                               0001 00004000
         B     @PROLOG                                             0001 00005000
         DC    AL1(16)                                             0001 00006000
         DC    C'ISTSC02C  78.337'                                 0001 00007000
         DROP  @15                                                      00008000
@PROLOG  ST    @14,12(,@13)                                        0001 00009000
         STM   @02,@12,28(@13)                                     0001 00010000
         BALR  @12,0                                               0001 00011000
@PSTART  DS    0H                                                  0001 00012000
         USING @PSTART,@12                                         0001 00013000
         ST    @13,@SA00001+4                                      0001 00014000
         LA    @14,@SA00001                                        0001 00015000
         ST    @14,8(,@13)                                         0001 00016000
         LR    @13,@14                                             0001 00017000
         EJECT                                                          00018000
*                                                                  0051 00019000
*/********************************************************************/ 00020000
*/*      FIRST TIME INITIALIZATION                                   */ 00021000
*/********************************************************************/ 00022000
*                                                                  0052 00023000
*   R15=0;                          /* SET RTN CODE REG TO 0         */ 00024000
         SLR   R15,R15                                             0052 00025000
*   MINPTR=0;                       /* SET CONSTANTS TO ZERO         */ 00026000
         SLR   @14,@14                                             0053 00027000
         ST    @14,MINPTR                                          0053 00028000
*   MAXPTR=0;                                                      0054 00029000
         ST    @14,MAXPTR                                          0054 00030000
*   IF $FSTMCIS='1'B                /* HAS A MORE CORE BEEN          */ 00031000
*     THEN                          /* ISSUIED                       */ 00032000
         TM    $FSTMCIS(WAPTR),B'00000100'                         0055 00033000
         BO    @RT00055                                            0055 00034000
*     GOTO S2CC0001;                /* BR-YES SWITCH IS ON ELSE NO   */ 00035000
*   R7=$OLTPTR;                     /* PICK UP PTR TO OLT            */ 00036000
         L     R7,$OLTPTR(,WAPTR)                                  0057 00037000
*   R6=((R7+$RTSIZE+15)&'FFFFFFF8'X);/* COMPUTE PTR FREE + 8         */ 00038000
         L     @09,$LOWADDR(,WAPTR)                                0058 00039000
         LH    @11,RTNDISP(,@09)                                   0058 00040000
         ALR   @11,@09                                             0058 00041000
         LR    R6,R7                                               0058 00042000
         AL    R6,$RTSIZE(,@11)                                    0058 00043000
         AL    R6,@CF00034                                         0058 00044000
         N     R6,@CF00707                                         0058 00045000
*   IF R6>$HIMOREC                  /* ANY CORE TO USE               */ 00046000
*     THEN                          /* BR-NO TO RTN CODE 8 ROUTIN    */ 00047000
         L     @09,$HIMOREC(,WAPTR)                                0059 00048000
         CR    R6,@09                                              0059 00049000
         BH    @RT00059                                            0059 00050000
*     GOTO S2CC0090;                /* ELSE YES                      */ 00051000
*   $FSTMCIS='1'B;                  /* SET FLAG TO IND 1ST TIM DN    */ 00052000
         OI    $FSTMCIS(WAPTR),B'00000100'                         0061 00053000
*   R6=R6-8;                        /* SET FREE PTR IN TWA           */ 00054000
         SL    R6,@CF00074                                         0062 00055000
*   $FRELPTR=R6;                                                   0063 00056000
         ST    R6,$FRELPTR(,WAPTR)                                 0063 00057000
*   COREFWD=0;                      /* SET FWD PTR TO ZERO           */ 00058000
         ST    @14,COREFWD(,R6)                                    0064 00059000
*   CORESZE=($HIMOREC-R6);          /* SET SIZE OF FREE AREA         */ 00060000
         SLR   @09,R6                                              0065 00061000
         ST    @09,CORESZE(,R6)                                    0065 00062000
*   FREE='1'B;                      /* SET INDICATOR AREA FREE       */ 00063000
         OI    FREE(R6),B'00000001'                                0066 00064000
*/********************************************************************/ 00065000
*                                                                  0067 00066000
*   GEN(EJECT);                                                    0067 00067000
         EJECT                                                          00068000
*                                                                  0068 00069000
*/********************************************************************/ 00070000
*/*      COMMON INITIALIZE                                           */ 00071000
*/********************************************************************/ 00072000
*                                                                  0068 00073000
*S2CC0001:                                                         0068 00074000
*   ;                                                              0068 00075000
S2CC0001 DS    0H                                                  0069 00076000
*   R5=$MORCMAX+8;                  /* ADD 8 TO MIN & MAX SIZES      */ 00077000
         LA    @14,8                                               0069 00078000
         L     R5,$MORCMAX(,MORMAP)                                0069 00079000
         ALR   R5,@14                                              0069 00080000
*   R4=$MORCMIN+8;                  /*                               */ 00081000
         AL    @14,$MORCMIN(,MORMAP)                               0070 00082000
         LR    R4,@14                                              0070 00083000
*   R7=0;                           /* SET WORK REGS TO ZERO         */ 00084000
         SLR   R7,R7                                               0071 00085000
*   R8=0;                           /*                               */ 00086000
         SLR   R8,R8                                               0072 00087000
*   R6=$FRELPTR;                    /* SET R6 FOR MANAG AREA         */ 00088000
         L     R6,$FRELPTR(,WAPTR)                                 0073 00089000
*/********************************************************************/ 00090000
*/*      SEARCH FOR POTENTIAL MAX & MIN/BTWN AREAS                   */ 00091000
*/********************************************************************/ 00092000
*                                                                  0074 00093000
*S2CC0002:                                                         0074 00094000
*   ;                                                              0074 00095000
S2CC0002 DS    0H                                                  0075 00096000
*   IF FREE='0'B                    /* TEST FOR FREE AREA            */ 00097000
*     THEN                          /* IF BIT ON AREA FREE           */ 00098000
         TM    FREE(R6),B'00000001'                                0075 00099000
         BZ    @RT00075                                            0075 00100000
*     GOTO S2CC0008;                /* BIT OFF AREA IN USE           */ 00101000
*   R3=(CORESZE&'FFFFFFFE'X);       /* SET R3 WITH SIZE OF FREE      */ 00102000
         L     R3,CORESZE(,R6)                                     0077 00103000
         N     R3,@CF00714                                         0077 00104000
*   IF R7=0                         /* TEST FOR ANY MAX FOUND        */ 00105000
*     THEN                          /* YET IF NOT CHECK 1ST MAX      */ 00106000
         LTR   R7,R7                                               0078 00107000
         BZ    @RT00078                                            0078 00108000
*     GOTO S2CC0003;                /* IS THIS AREA LESS THAN        */ 00109000
*   IF R3¬<R7                       /* ONE FOUND MAX                 */ 00110000
*     THEN                          /* BR- NO TO CHECK FOR MIN       */ 00111000
         CR    R3,R7                                               0080 00112000
         BNL   @RT00080                                            0080 00113000
*     GOTO S2CC0004;                /*                               */ 00114000
*S2CC0003:                                                         0082 00115000
*   ;                               /* CHECK MAX                     */ 00116000
S2CC0003 DS    0H                                                  0083 00117000
*   IF R5¬>R3                       /* IF REQUESTED MAX NOT          */ 00118000
*     THEN                          /* GTR THAN AREA AVAIBLE         */ 00119000
         CR    R5,R3                                               0083 00120000
         BNH   @RT00083                                            0083 00121000
*     GOTO S2CC0005;                /* SAVE PTR                      */ 00122000
*S2CC0004:                                                         0085 00123000
*   ;                               /* CHECK MIN                     */ 00124000
S2CC0004 DS    0H                                                  0086 00125000
*   IF R4>R3                        /* IF REQUESTED MIN GTR THAN     */ 00126000
*     THEN                          /* AREA AVAILABLE GOTO           */ 00127000
         CR    R4,R3                                               0086 00128000
         BH    @RT00086                                            0086 00129000
*     GOTO S2CC0008;                /* CHECK NXT AREA                */ 00130000
*   IF $MORLEVL='03'X               /* TEST FOR LEVEL 3 MACRO        */ 00131000
*     THEN                          /* IF YES TRY BTWEEN             */ 00132000
         CLI   $MORLEVL(MORMAP),X'03'                              0088 00133000
         BE    @RT00088                                            0088 00134000
*     GOTO S2CC0006;                /*                               */ 00135000
*   IF R8=0                         /* ANY PREVIOUS MIN'S FOUND      */ 00136000
*     THEN                          /* NO GO SAVE POTENTIAL MINS     */ 00137000
         LTR   R8,R8                                               0090 00138000
         BZ    @RT00090                                            0090 00139000
*     GOTO S2CC0007;                /*                               */ 00140000
*   IF R8>R3                        /* IS MINIMUM GTR THAN AREA      */ 00141000
*     THEN                          /* REQUESTED                     */ 00142000
         CR    R8,R3                                               0092 00143000
         BH    @RT00092                                            0092 00144000
*     GOTO S2CC0007;                /* SAVE PTR                      */ 00145000
*   GOTO S2CC0008;                  /* IF NO CHECK NXT AREA          */ 00146000
         B     S2CC0008                                            0094 00147000
*S2CC0005:                                                         0095 00148000
*   ;                               /* POTENTIAL MAX                 */ 00149000
S2CC0005 DS    0H                                                  0096 00150000
*   MAXPTR=R6;                      /* SAVE PTR FOR POTENT. MAX      */ 00151000
         ST    R6,MAXPTR                                           0096 00152000
*   R7=R3;                          /* SAVE SIZE OF POT. MAX         */ 00153000
         LR    R7,R3                                               0097 00154000
*   GOTO S2CC0008;                  /* GO CHECK NXT AREA             */ 00155000
         B     S2CC0008                                            0098 00156000
*S2CC0006:                                                         0099 00157000
*   ;                               /*                               */ 00158000
S2CC0006 DS    0H                                                  0100 00159000
*   IF R8¬<R3                       /* IS REQ SIZE GTR THAN          */ 00160000
*     THEN                          /* FOUND MINIMUM                 */ 00161000
         CR    R8,R3                                               0100 00162000
         BNL   @RT00100                                            0100 00163000
*     GOTO S2CC0008;                /* YES GO TRY NXT AREA           */ 00164000
*S2CC0007:                                                         0102 00165000
*   ;                               /*                               */ 00166000
S2CC0007 DS    0H                                                  0103 00167000
*   MINPTR=R6;                      /* SAVE POTENTIAL MIN PTR        */ 00168000
         ST    R6,MINPTR                                           0103 00169000
*   R8=R3;                          /* SAVE POT SIZE                 */ 00170000
         LR    R8,R3                                               0104 00171000
*S2CC0008:                          /*                               */ 00172000
*   IF COREFWD=0                    /* IF COREFWD=0 WE ARE AT END    */ 00173000
*     THEN                          /* OF LOOP MAX-MIN SET           */ 00174000
S2CC0008 L     @14,COREFWD(,R6)                                    0105 00175000
         LTR   @14,@14                                             0105 00176000
         BZ    @RT00105                                            0105 00177000
*     GOTO S2CC0010;                /* IF NOT PICK UP PTR AND        */ 00178000
*   R6=COREFWD;                     /* RE LOOP                       */ 00179000
         LR    R6,@14                                              0107 00180000
*   GOTO S2CC0002;                  /*                               */ 00181000
         B     S2CC0002                                            0108 00182000
*/********************************************************************/ 00183000
*                                                                  0109 00184000
*   GEN(EJECT);                                                    0109 00185000
         EJECT                                                          00186000
*                                                                  0110 00187000
*/********************************************************************/ 00188000
*/*      GIVE  MAX OR MIN OR BETWEEN  CORE                           */ 00189000
*/********************************************************************/ 00190000
*                                                                  0110 00191000
*S2CC0010:                                                         0110 00192000
*   ;                               /* ANY MAX FOUND                 */ 00193000
S2CC0010 DS    0H                                                  0111 00194000
*   IF R7=0                         /* BR-NO                         */ 00195000
*     THEN                          /*                               */ 00196000
         LTR   R7,R7                                               0111 00197000
         BZ    @RT00111                                            0111 00198000
*     GOTO S2CC0011;                /*                               */ 00199000
*   R0=$MORCMAX;                    /* YES SET SIZE FOR CALLER       */ 00200000
         L     R0,$MORCMAX(,MORMAP)                                0113 00201000
*   R1=MAXPTR+8;                    /* YES SET PTR FOR CALLER        */ 00202000
         L     @14,MAXPTR                                          0114 00203000
         LA    R1,8                                                0114 00204000
         ALR   R1,@14                                              0114 00205000
*   R7=MAXPTR;                                                     0115 00206000
         LR    R7,@14                                              0115 00207000
*   GOTO S2CC0013;                  /*                               */ 00208000
         B     S2CC0013                                            0116 00209000
*S2CC0011:                                                         0117 00210000
*   ;                               /*                               */ 00211000
S2CC0011 DS    0H                                                  0118 00212000
*   IF R8=0                         /* ANY MIN/BTWEEN FOUND          */ 00213000
*     THEN                          /* BR-NO TO RTN CODE 8           */ 00214000
         LTR   R8,R8                                               0118 00215000
         BZ    @RT00118                                            0118 00216000
*     GOTO S2CC0090;                /*                               */ 00217000
*   R7=MINPTR;                      /* SET UP FOR NEW MOREC PTR      */ 00218000
         L     R7,MINPTR                                           0120 00219000
*   MINPTR=R7+8;                    /* SET UP ADDR+8                 */ 00220000
         LA    @14,8                                               0121 00221000
         LR    @09,R7                                              0121 00222000
         ALR   @09,@14                                             0121 00223000
         ST    @09,MINPTR                                          0121 00224000
*   IF $MORLEVL¬='03'X              /* IS MACRO LEVEL 3              */ 00225000
*     THEN                          /* BR-NO-GIVE MIN                */ 00226000
         CLI   $MORLEVL(MORMAP),X'03'                              0122 00227000
         BNE   @RT00122                                            0122 00228000
*     GOTO S2CC0012;                /*                               */ 00229000
*   R0=R8-8;                        /* GET SIZE FOR CALLER           */ 00230000
         LR    R0,R8                                               0124 00231000
         SLR   R0,@14                                              0124 00232000
*   R1=MINPTR;                      /* SET UP ADDRESS + 8            */ 00233000
         LR    R1,@09                                              0125 00234000
*   R6=R1-8;                        /* SET POINTER FOR FREE BIT      */ 00235000
         LCR   @14,@14                                             0126 00236000
         ALR   @14,R1                                              0126 00237000
         LR    R6,@14                                              0126 00238000
*   GOTO S2CC0021;                  /*                               */ 00239000
         B     S2CC0021                                            0127 00240000
*S2CC0012:                                                         0128 00241000
*   ;                               /*                               */ 00242000
S2CC0012 DS    0H                                                  0129 00243000
*   R1=MINPTR;                      /* SET UP ADDRESS + 8            */ 00244000
         L     R1,MINPTR                                           0129 00245000
*   R5=R4;                          /* GET NEW MORE CORE REQ         */ 00246000
         LR    R5,R4                                               0130 00247000
*   R0=$MORCMIN;                    /* GET MIN LENGTH                */ 00248000
         L     R0,$MORCMIN(,MORMAP)                                0131 00249000
*S2CC0013:                                                         0132 00250000
*   ;                               /*                               */ 00251000
S2CC0013 DS    0H                                                  0133 00252000
*   R6=R7;                          /* GET OLD FREE PTR INTO R6      */ 00253000
         LR    R6,R7                                               0133 00254000
*   R7=CORESZE;                     /* PICK UP OLD FREE SIZE         */ 00255000
         L     R7,CORESZE(,R6)                                     0134 00256000
*   R5=(((R5+7)/8)*8);              /* ROUND SIZE UPTO DWORD         */ 00257000
         LA    @14,8                                               0135 00258000
         LA    @10,7                                               0135 00259000
         ALR   @10,R5                                              0135 00260000
         SRDA  @10,32                                              0135 00261000
         DR    @10,@14                                             0135 00262000
         SLA   @11,3                                               0135 00263000
         LR    R5,@11                                              0135 00264000
*   IF 8>(R7-R5)                    /* ANY SIZE LEFT FOR MORECORE    */ 00265000
*     THEN                          /* BR-NONE LEFT                  */ 00266000
         LR    @09,R7                                              0136 00267000
         SLR   @09,R5                                              0136 00268000
         CR    @09,@14                                             0136 00269000
         BL    @RT00136                                            0136 00270000
*     GOTO S2CC0021;                /*                               */ 00271000
*/********************************************************************/ 00272000
*/*           UPDATE MORE/FREE CORE CHAIN                            */ 00273000
*/********************************************************************/ 00274000
*                                                                  0138 00275000
*S2CC0020:                                                         0138 00276000
*   ;                                                              0138 00277000
S2CC0020 DS    0H                                                  0139 00278000
*   R8=R6+R5;                       /* SET PTR TO NEW FREE AREA      */ 00279000
         LR    R8,R6                                               0139 00280000
         ALR   R8,R5                                               0139 00281000
*   COREFWDN=COREFWD;               /* SET UP CHAIN IN NEW FREE      */ 00282000
         L     @14,COREFWD(,R6)                                    0140 00283000
         ST    @14,COREFWDN(,R8)                                   0140 00284000
*   CORESZEN=CORESZE-R5;            /* AND JUST GOTTEN AREA          */ 00285000
         L     @14,CORESZE(,R6)                                    0141 00286000
         SLR   @14,R5                                              0141 00287000
         ST    @14,CORESZEN(,R8)                                   0141 00288000
*   FREEN='1'B;                     /* SET FLAGS IN NEW FOR FREE     */ 00289000
         OI    FREEN(R8),B'00000001'                               0142 00290000
*   CORESZE=R5;                     /* SET SIZE                      */ 00291000
         ST    R5,CORESZE(,R6)                                     0143 00292000
*   COREFWD=R8;                     /* SET CHAIN PTR IN GOTTEN       */ 00293000
         ST    R8,COREFWD(,R6)                                     0144 00294000
*S2CC0021:                                                         0145 00295000
*   ;                               /* TO NEW FREE                   */ 00296000
S2CC0021 DS    0H                                                  0146 00297000
*   FREE='0'B;                      /* SET GOTTEN AREA NOT FREE      */ 00298000
         NI    FREE(R6),B'11111110'                                0146 00299000
*   GOTO S2CC0092;                  /* GOTO RTN CODE 0               */ 00300000
         B     S2CC0092                                            0147 00301000
*/********************************************************************/ 00302000
*                                                                  0148 00303000
*   GEN(EJECT);                                                    0148 00304000
         EJECT                                                          00305000
*                                                                  0149 00306000
*/********************************************************************/ 00307000
*/*      RETURN                                                      */ 00308000
*/********************************************************************/ 00309000
*                                                                  0149 00310000
*S2CC0090:                                                         0149 00311000
*   ;                                                              0149 00312000
S2CC0090 DS    0H                                                  0150 00313000
*   R15=R15+4;                      /* RTN CODE =8                   */ 00314000
         AL    R15,@CF00087                                        0150 00315000
*S2CC0091:                                                         0151 00316000
*   ;                                                              0151 00317000
S2CC0091 DS    0H                                                  0152 00318000
*   R15=R15+4;                      /* RTN CODE =4                   */ 00319000
         AL    R15,@CF00087                                        0152 00320000
*S2CC0092:                                                         0153 00321000
*   ;                                                              0153 00322000
S2CC0092 DS    0H                                                  0154 00323000
*   DO;                             /* ATDSPLY                       */ 00324000
*   END;                            /* ATDSPLY                       */ 00325000
*   END;                            /* RTN CODE =0                   */ 00326000
@EL00001 L     @13,4(,@13)                                         0156 00327000
@EF00001 DS    0H                                                  0156 00328000
@ER00001 L     @14,12(,@13)                                        0156 00329000
         LM    @02,@12,28(@13)                                     0156 00330000
         BR    @14                                                 0156 00331000
@DATA    DS    0H                                                       00332000
         DS    0F                                                       00333000
@SA00001 DS    18F                                                      00334000
         DS    0F                                                       00335000
@CF00087 DC    F'4'                                                     00336000
@CF00074 DC    F'8'                                                     00337000
@CF00034 DC    F'15'                                                    00338000
@CF00707 DC    XL4'FFFFFFF8'                                            00339000
@CF00714 DC    XL4'FFFFFFFE'                                            00340000
         DS    0D                                                       00341000
MAXPTR   DC    F'0'                                                     00342000
MINPTR   DC    F'0'                                                     00343000
PATCH    DC    15F'0'                                                   00344000
@00      EQU   00                      EQUATES FOR REGISTERS 0-15       00345000
@01      EQU   01                                                       00346000
@02      EQU   02                                                       00347000
@03      EQU   03                                                       00348000
@04      EQU   04                                                       00349000
@05      EQU   05                                                       00350000
@06      EQU   06                                                       00351000
@07      EQU   07                                                       00352000
@08      EQU   08                                                       00353000
@09      EQU   09                                                       00354000
@10      EQU   10                                                       00355000
@11      EQU   11                                                       00356000
@12      EQU   12                                                       00357000
@13      EQU   13                                                       00358000
@14      EQU   14                                                       00359000
@15      EQU   15                                                       00360000
R0       EQU   @00                                                      00361000
R1       EQU   @01                                                      00362000
R2       EQU   @02                                                      00363000
R3       EQU   @03                                                      00364000
R4       EQU   @04                                                      00365000
R5       EQU   @05                                                      00366000
R6       EQU   @06                                                      00367000
R7       EQU   @07                                                      00368000
R8       EQU   @08                                                      00369000
R15      EQU   @15                                                      00370000
RCAPTR   EQU   @03                                                      00371000
WAPTR    EQU   @02                                                      00372000
MORMAP   EQU   @01                                                      00373000
FREMAP   EQU   @01                                                      00374000
R10      EQU   @10                                                      00375000
R11      EQU   @11                                                      00376000
R12      EQU   @12                                                      00377000
R13      EQU   @13                                                      00378000
R14      EQU   @14                                                      00379000
R9       EQU   @09                                                      00380000
$RCAAREA EQU   0                                                        00381000
$POINTER EQU   $RCAAREA+100                                             00382000
$TRTBLA  EQU   $POINTER+124                                             00383000
$CONSTNT EQU   $RCAAREA+244                                             00384000
$RCAFLG  EQU   $RCAAREA+604                                             00385000
TOLTEPWA EQU   0                                                        00386000
$SCTTBLE EQU   TOLTEPWA                                                 00387000
$TESTOPT EQU   $SCTTBLE+2                                               00388000
$ERROPT  EQU   $SCTTBLE+3                                               00389000
$PDEVFLG EQU   $SCTTBLE+10                                              00390000
$CDSFLGS EQU   $SCTTBLE+11                                              00391000
$CDS8T19 EQU   $SCTTBLE+20                                              00392000
$EXECFLG EQU   $SCTTBLE+33                                              00393000
$OLTFLGS EQU   $SCTTBLE+36                                              00394000
$OLTFLG2 EQU   $SCTTBLE+37                                              00395000
$TOTFLG1 EQU   $SCTTBLE+38                                              00396000
$ROUTMSK EQU   $SCTTBLE+40                                              00397000
$CDA     EQU   TOLTEPWA+100                                             00398000
$RCA     EQU   $CDA+44                                                  00399000
$OLTPTR  EQU   $CDA+52                                                  00400000
$LOWADDR EQU   $OLTPTR                                                  00401000
$HIMOREC EQU   $CDA+60                                                  00402000
$FRELPTR EQU   $CDA+64                                                  00403000
$COMMFLG EQU   TOLTEPWA+224                                             00404000
$FLAG1   EQU   $COMMFLG                                                 00405000
$FLAG2   EQU   $COMMFLG+1                                               00406000
$FLAG3   EQU   $COMMFLG+2                                               00407000
$FLAG4   EQU   $COMMFLG+3                                               00408000
$FLAG5   EQU   $COMMFLG+4                                               00409000
$EOJ     EQU   $FLAG5                                                   00410000
$CANCEL  EQU   $EOJ                                                     00411000
$FLAG6   EQU   $COMMFLG+5                                               00412000
$FSTMCIS EQU   $FLAG6                                                   00413000
$ABNDBIT EQU   $FLAG6                                                   00414000
$FLAG7   EQU   $COMMFLG+6                                               00415000
$FLAG8   EQU   $COMMFLG+7                                               00416000
$FLAG9   EQU   $COMMFLG+8                                               00417000
$FLAG10  EQU   $COMMFLG+9                                               00418000
$FLAG11  EQU   $COMMFLG+10                                              00419000
$FLAG12  EQU   $COMMFLG+11                                              00420000
$FLAG13  EQU   $COMMFLG+12                                              00421000
$DEVTBLE EQU   TOLTEPWA+240                                             00422000
$DEVCDS  EQU   $DEVTBLE                                                 00423000
$DEVUNAD EQU   $DEVCDS                                                  00424000
@NM00039 EQU   $DEVUNAD+2                                               00425000
$DEVFEAT EQU   $DEVCDS+4                                                00426000
$DEVCDSF EQU   $DEVCDS+9                                                00427000
$DEVSDCF EQU   $DEVCDS+10                                               00428000
$$SYMNME EQU   $DEVCDS+12                                               00429000
$DEVFLG1 EQU   $DEVTBLE+20                                              00430000
$EVNCPLT EQU   $DEVFLG1                                                 00431000
$ATTNEXP EQU   $DEVFLG1                                                 00432000
$INTOCC  EQU   $DEVFLG1                                                 00433000
$DEVFLG2 EQU   $DEVTBLE+21                                              00434000
$DEVTECB EQU   $DEVTBLE+22                                              00435000
$OPIS    EQU   $DEVTECB                                                 00436000
$OPND    EQU   $DEVTECB+2                                               00437000
$DEVFLG3 EQU   $DEVTBLE+27                                              00438000
$SIOFLG  EQU   $DEVFLG3                                                 00439000
$IFTOUT  EQU   $DEVTBLE+36                                              00440000
$DEVSESP EQU   $IFTOUT                                                  00441000
$SSCPDAF EQU   $IFTOUT+6                                                00442000
$LDNCBPT EQU   $DEVTBLE+48                                              00443000
$RNINFO  EQU   $DEVTBLE+56                                              00444000
$DEVFLG5 EQU   $RNINFO+8                                                00445000
$DEVFLG4 EQU   $DEVTBLE+65                                              00446000
$SLTBL   EQU   TOLTEPWA+1468                                            00447000
$RUNTEST EQU   $SLTBL+13                                                00448000
$TESTFLG EQU   $SLTBL+21                                                00449000
$SECLST  EQU   $SLTBL+22                                                00450000
#EXITA   EQU   TOLTEPWA+2632                                            00451000
$CCOMDAT EQU   TOLTEPWA+2644                                            00452000
$CFLGS   EQU   $CCOMDAT+16                                              00453000
$24FEMSG EQU   TOLTEPWA+2681                                            00454000
$24CATMG EQU   $24FEMSG+11                                              00455000
@NM00048 EQU   TOLTEPWA+2776                                            00456000
$OUNTPTR EQU   @NM00048+4                                               00457000
$NSPTR   EQU   $OUNTPTR                                                 00458000
$NSCNT   EQU   @NM00048+10                                              00459000
$ENXX    EQU   @NM00048+15                                              00460000
$IMITX   EQU   $ENXX                                                    00461000
SVESC033 EQU   TOLTEPWA+3160                                            00462000
SVECC013 EQU   TOLTEPWA+3232                                            00463000
SVEIC003 EQU   TOLTEPWA+3592                                            00464000
SVESC022 EQU   TOLTEPWA+3736                                            00465000
SVECC011 EQU   TOLTEPWA+4024                                            00466000
MORECMAP EQU   0                                                        00467000
$MORLEVL EQU   MORECMAP+1                                               00468000
$MORCMAX EQU   MORECMAP+4                                               00469000
$MORCMIN EQU   MORECMAP+8                                               00470000
FREEMAP  EQU   0                                                        00471000
@NM00051 EQU   0                                                        00472000
RTNDISP  EQU   @NM00051+10                                              00473000
INST     EQU   @NM00051+12                                              00474000
$NEWSPRF EQU   0                                                        00475000
#FLAGS   EQU   $NEWSPRF+16                                              00476000
$RTSIZE  EQU   $NEWSPRF+20                                              00477000
COREMANG EQU   0                                                        00478000
CORESZE  EQU   COREMANG                                                 00479000
@NM00056 EQU   CORESZE+3                                                00480000
FREE     EQU   @NM00056                                                 00481000
COREFWD  EQU   COREMANG+4                                               00482000
@NM00058 EQU   0                                                        00483000
CORESZEN EQU   @NM00058                                                 00484000
@NM00060 EQU   CORESZEN+3                                               00485000
FREEN    EQU   @NM00060                                                 00486000
COREFWDN EQU   @NM00058+4                                               00487000
$TRTBL   EQU   0                                                        00488000
#EXIT    EQU   0                                                        00489000
OLTENTRY EQU   0                                                        00490000
SVECC012 EQU   SVESC022                                                 00491000
SVEIC00A EQU   SVEIC003                                                 00492000
SVEIC004 EQU   SVEIC003                                                 00493000
SVEIC005 EQU   SVEIC003                                                 00494000
SVESC02A EQU   SVESC022                                                 00495000
SVESC02B EQU   SVESC022                                                 00496000
SVESC02D EQU   SVESC022                                                 00497000
SVESC02E EQU   SVESC022                                                 00498000
SVESC02F EQU   SVECC013                                                 00499000
SVESC024 EQU   SVESC022                                                 00500000
SVESC027 EQU   SVESC022                                                 00501000
SVESC029 EQU   SVESC033                                                 00502000
SVESC031 EQU   SVECC013                                                 00503000
SVESC032 EQU   SVECC011                                                 00504000
SVETC037 EQU   SVEIC003                                                 00505000
         AGO   .@UNREFD                START UNREFERENCED COMPONENTS    00506000
@NM00061 EQU   @NM00060                                                 00507000
@NM00059 EQU   CORESZEN                                                 00508000
@NM00057 EQU   @NM00056                                                 00509000
@NM00055 EQU   CORESZE                                                  00510000
$RME     EQU   $NEWSPRF+36                                              00511000
@NM00054 EQU   $NEWSPRF+35                                              00512000
$ECA     EQU   $NEWSPRF+32                                              00513000
$DCHB    EQU   $NEWSPRF+28                                              00514000
$MOSIZE  EQU   $NEWSPRF+24                                              00515000
$COUNT   EQU   $NEWSPRF+18                                              00516000
$REFNUM  EQU   $NEWSPRF+17                                              00517000
@NM00053 EQU   #FLAGS                                                   00518000
#MSGIDRQ EQU   #FLAGS                                                   00519000
#PLKMCOR EQU   #FLAGS                                                   00520000
@NM00052 EQU   #FLAGS                                                   00521000
$VIRTUAL EQU   #FLAGS                                                   00522000
$PLINK$  EQU   $NEWSPRF+12                                              00523000
$SCTREQ  EQU   $NEWSPRF+11                                              00524000
$RM      EQU   $NEWSPRF+9                                               00525000
$CTYPE   EQU   $NEWSPRF+8                                               00526000
$CCLASS  EQU   $NEWSPRF+7                                               00527000
$CFEAT   EQU   $NEWSPRF+6                                               00528000
$CMODEL  EQU   $NEWSPRF+5                                               00529000
$TYPE    EQU   $NEWSPRF+4                                               00530000
$CLASS   EQU   $NEWSPRF+3                                               00531000
$FEAT    EQU   $NEWSPRF+2                                               00532000
$MODEL   EQU   $NEWSPRF+1                                               00533000
$RTN#    EQU   $NEWSPRF                                                 00534000
#MSGID   EQU   @NM00051+16                                              00535000
LEVEL    EQU   @NM00051+8                                               00536000
SECTID   EQU   @NM00051                                                 00537000
$FREEPTR EQU   FREEMAP+4                                                00538000
$FREIDNT EQU   FREEMAP+2                                                00539000
$FRELEVL EQU   FREEMAP+1                                                00540000
$FRETRMG EQU   FREEMAP                                                  00541000
$MORIDNT EQU   MORECMAP+2                                               00542000
$MORTRMG EQU   MORECMAP                                                 00543000
SVECC010 EQU   TOLTEPWA+3952                                            00544000
SVETC035 EQU   TOLTEPWA+3880                                            00545000
SVESC030 EQU   TOLTEPWA+3808                                            00546000
SVESC020 EQU   TOLTEPWA+3664                                            00547000
SVEIC002 EQU   TOLTEPWA+3520                                            00548000
SVECC014 EQU   TOLTEPWA+3376                                            00549000
SVESC120 EQU   TOLTEPWA+3304                                            00550000
SVESC025 EQU   TOLTEPWA+3088                                            00551000
@NM00050 EQU   TOLTEPWA+2980                                            00552000
$RPLERR  EQU   TOLTEPWA+2977                                            00553000
@NM00049 EQU   TOLTEPWA+2976                                            00554000
$R13PR3  EQU   TOLTEPWA+2972                                            00555000
$CEINT2  EQU   TOLTEPWA+2968                                            00556000
$CEINT1  EQU   TOLTEPWA+2964                                            00557000
$MSGGET  EQU   TOLTEPWA+2960                                            00558000
$ACQLIST EQU   TOLTEPWA+2956                                            00559000
$R4SAVE1 EQU   TOLTEPWA+2952                                            00560000
$CLSISS  EQU   TOLTEPWA+2950                                            00561000
$CLSCNT  EQU   TOLTEPWA+2948                                            00562000
$CUTABLE EQU   TOLTEPWA+2868                                            00563000
$BUFSZ2  EQU   TOLTEPWA+2864                                            00564000
$RESID2  EQU   TOLTEPWA+2860                                            00565000
$OLTCCW2 EQU   TOLTEPWA+2856                                            00566000
$ENDBFR2 EQU   TOLTEPWA+2852                                            00567000
$1STBFR2 EQU   TOLTEPWA+2848                                            00568000
$TECB2   EQU   TOLTEPWA+2844                                            00569000
$BUFSZ1  EQU   TOLTEPWA+2840                                            00570000
$RESID1  EQU   TOLTEPWA+2836                                            00571000
$OLTCCW1 EQU   TOLTEPWA+2832                                            00572000
$ENDBFR1 EQU   TOLTEPWA+2828                                            00573000
$1STBFR1 EQU   TOLTEPWA+2824                                            00574000
$TECB1   EQU   TOLTEPWA+2820                                            00575000
$WAITIME EQU   TOLTEPWA+2816                                            00576000
$TRTN#   EQU   TOLTEPWA+2815                                            00577000
$WIODEV  EQU   TOLTEPWA+2814                                            00578000
$RQSTSZE EQU   TOLTEPWA+2812                                            00579000
$RQSTPTR EQU   TOLTEPWA+2808                                            00580000
$R4SAVE  EQU   TOLTEPWA+2804                                            00581000
$PARTADR EQU   TOLTEPWA+2800                                            00582000
$TBSDATA EQU   TOLTEPWA+2796                                            00583000
$CTWIDTH EQU   TOLTEPWA+2795                                            00584000
$CTLINE  EQU   TOLTEPWA+2794                                            00585000
$APWIDTH EQU   TOLTEPWA+2793                                            00586000
$APLINE  EQU   TOLTEPWA+2792                                            00587000
$INDEX   EQU   $IMITX                                                   00588000
$UMXX    EQU   @NM00048+14                                              00589000
$NSXX    EQU   @NM00048+12                                              00590000
$ATACNT  EQU   $NSCNT                                                   00591000
$CTR     EQU   @NM00048+8                                               00592000
$ATAPTR  EQU   $NSPTR                                                   00593000
$DDRPTR  EQU   @NM00048                                                 00594000
$DTORESP EQU   TOLTEPWA+2712                                            00595000
$APNAME  EQU   TOLTEPWA+2704                                            00596000
$24SYMNE EQU   $24CATMG+4                                               00597000
$24DEVAD EQU   $24CATMG                                                 00598000
$24RTN#  EQU   $24FEMSG+8                                               00599000
$ESECTID EQU   $24FEMSG                                                 00600000
$24FLGS  EQU   TOLTEPWA+2680                                            00601000
$24SAVE2 EQU   TOLTEPWA+2676                                            00602000
$24SAVE1 EQU   TOLTEPWA+2672                                            00603000
$24UNADR EQU   TOLTEPWA+2668                                            00604000
$24SAV13 EQU   TOLTEPWA+2664                                            00605000
$24RETCD EQU   TOLTEPWA+2663                                            00606000
$MACID   EQU   TOLTEPWA+2661                                            00607000
$CSPARE  EQU   $CFLGS                                                   00608000
$C2WAY   EQU   $CFLGS                                                   00609000
$CINCT   EQU   $CCOMDAT+12                                              00610000
$CINADR  EQU   $CCOMDAT+8                                               00611000
$COUTCT  EQU   $CCOMDAT+4                                               00612000
$COUTAD  EQU   $CCOMDAT                                                 00613000
ROOTLOC  EQU   TOLTEPWA+2640                                            00614000
$RETREG  EQU   TOLTEPWA+2636                                            00615000
$WORK    EQU   TOLTEPWA+2376                                            00616000
$EXTA    EQU   TOLTEPWA+2320                                            00617000
$PASSONA EQU   TOLTEPWA+2264                                            00618000
$TRMINPT EQU   TOLTEPWA+2184                                            00619000
$INBUFR  EQU   TOLTEPWA+2104                                            00620000
$BUFFER  EQU   TOLTEPWA+1976                                            00621000
$TLTRPL3 EQU   TOLTEPWA+1856                                            00622000
$TLTRPL2 EQU   TOLTEPWA+1736                                            00623000
$TLTRPL1 EQU   TOLTEPWA+1616                                            00624000
@NM00047 EQU   $SLTBL+135                                               00625000
$HIGHRTN EQU   $SLTBL+134                                               00626000
$PRIMADR EQU   $SLTBL+130                                               00627000
$CTSTPT  EQU   $SLTBL+128                                               00628000
$TSTCNT  EQU   $SLTBL+126                                               00629000
$SECFLGS EQU   $SECLST+3                                                00630000
$SECTION EQU   $SECLST                                                  00631000
$SECACT  EQU   $TESTFLG                                                 00632000
$CANTRUN EQU   $TESTFLG                                                 00633000
$FINAL   EQU   $TESTFLG                                                 00634000
$TESTSUF EQU   $RUNTEST+5                                               00635000
$TESTNUM EQU   $RUNTEST+1                                               00636000
$LETPRF  EQU   $RUNTEST                                                 00637000
$SYMBOLC EQU   $SLTBL+5                                                 00638000
$FAMILY  EQU   $SLTBL                                                   00639000
$CDEVPT  EQU   TOLTEPWA+1466                                            00640000
$DEVCNTS EQU   TOLTEPWA+1464                                            00641000
$FEEDBCK EQU   $DEVTBLE+66                                              00642000
$WTISUED EQU   $DEVFLG4                                                 00643000
$EXIOISD EQU   $DEVFLG4                                                 00644000
$REMWRIT EQU   $DEVFLG4                                                 00645000
$REMDONE EQU   $DEVFLG4                                                 00646000
$2NDUSED EQU   $DEVFLG4                                                 00647000
$1STUSED EQU   $DEVFLG4                                                 00648000
$IGLXIFB EQU   $DEVFLG4                                                 00649000
$EXIOLV3 EQU   $DEVFLG4                                                 00650000
@NM00046 EQU   $DEVFLG5                                                 00651000
$DVBASIC EQU   $DEVFLG5                                                 00652000
$ASCII   EQU   $DEVFLG5                                                 00653000
$DEVLU   EQU   $DEVFLG5                                                 00654000
$OPNDFAL EQU   $DEVFLG5                                                 00655000
$ACQNCB  EQU   $DEVFLG5                                                 00656000
$REMOTE  EQU   $DEVFLG5                                                 00657000
$ENDNODE EQU   $DEVFLG5                                                 00658000
$LINENME EQU   $RNINFO                                                  00659000
$CID     EQU   $DEVTBLE+52                                              00660000
$DVCOL   EQU   $LDNCBPT+2                                               00661000
$DVROW   EQU   $LDNCBPT                                                 00662000
$NCSPLP  EQU   $DEVTBLE+44                                              00663000
$DVLN    EQU   $SSCPDAF                                                 00664000
$DAF     EQU   $DEVSESP+4                                               00665000
$VARYPAB EQU   $DEVSESP                                                 00666000
$SYSMN   EQU   $DEVTBLE+28                                              00667000
@NM00045 EQU   $DEVFLG3                                                 00668000
$CLRSNT  EQU   $DEVFLG3                                                 00669000
$OLTERR  EQU   $DEVFLG3                                                 00670000
$SRTEST  EQU   $DEVFLG3                                                 00671000
$DVSNDOK EQU   $SIOFLG                                                  00672000
$POLLREQ EQU   $DEVFLG3                                                 00673000
$ACQRED  EQU   $DEVFLG3                                                 00674000
$NOTDEV  EQU   $DEVFLG3                                                 00675000
$DVINCT  EQU   $DEVTBLE+26                                              00676000
$DVBRKST EQU   $OPND+1                                                  00677000
$DVBRKSN EQU   $OPND                                                    00678000
$DVSEQNO EQU   $OPIS                                                    00679000
$CEINTRP EQU   $DEVFLG2                                                 00680000
$TESTMDE EQU   $DEVFLG2                                                 00681000
$DEVALOC EQU   $DEVFLG2                                                 00682000
$ALLDATA EQU   $DEVFLG2                                                 00683000
$ENDCNTL EQU   $DEVFLG2                                                 00684000
$CTLDEV  EQU   $DEVFLG2                                                 00685000
$NOCDS   EQU   $DEVFLG2                                                 00686000
$DATAIN  EQU   $DEVFLG2                                                 00687000
$PRIMARY EQU   $DEVFLG1                                                 00688000
$DVCTBYT EQU   $INTOCC                                                  00689000
$DEVACT  EQU   $DEVFLG1                                                 00690000
$DVLGMDE EQU   $ATTNEXP                                                 00691000
$DVSPRM  EQU   $EVNCPLT                                                 00692000
$GRABBED EQU   $DEVFLG1                                                 00693000
$CATASTR EQU   $DEVFLG1                                                 00694000
$LETGO   EQU   $DEVFLG1                                                 00695000
$CURELEM EQU   $$SYMNME+4                                               00696000
$MSGOTSD EQU   $$SYMNME                                                 00697000
$EXTDEV  EQU   $DEVCDS+11                                               00698000
@NM00044 EQU   $DEVSDCF                                                 00699000
$NOTPRIM EQU   $DEVSDCF                                                 00700000
@NM00043 EQU   $DEVCDSF                                                 00701000
@NM00042 EQU   $DEVCDSF                                                 00702000
@NM00041 EQU   $DEVCDSF                                                 00703000
$CDSNAME EQU   $DEVCDSF                                                 00704000
$EXTRN   EQU   $DEVCDSF                                                 00705000
$CEVOLUM EQU   $DEVCDSF                                                 00706000
$SHARD   EQU   $DEVCDSF                                                 00707000
$DEVFPM  EQU   $DEVCDSF                                                 00708000
$DEVCNT  EQU   $DEVCDS+8                                                00709000
$DEVTYPE EQU   $DEVFEAT+3                                               00710000
$DEVCLAS EQU   $DEVFEAT+2                                               00711000
$DEVFRRS EQU   $DEVFEAT+1                                               00712000
$DEVMOD  EQU   $DEVFEAT                                                 00713000
$DEVRDGT EQU   @NM00039+1                                               00714000
$DEVCTLU EQU   @NM00039+1                                               00715000
$DEVCHAN EQU   @NM00039                                                 00716000
@NM00040 EQU   @NM00039                                                 00717000
$CTINDX  EQU   $DEVUNAD                                                 00718000
$FLAG16  EQU   $COMMFLG+15                                              00719000
$FLAG15  EQU   $COMMFLG+14                                              00720000
$FLAG14  EQU   $COMMFLG+13                                              00721000
$TEP2ND  EQU   $FLAG13                                                  00722000
$TEP1ST  EQU   $FLAG13                                                  00723000
$CATMSG  EQU   $FLAG13                                                  00724000
$PRMPTSW EQU   $FLAG13                                                  00725000
$DEVENT  EQU   $FLAG13                                                  00726000
$OLTMACC EQU   $FLAG13                                                  00727000
$LGON    EQU   $FLAG13                                                  00728000
$CTLOGON EQU   $FLAG13                                                  00729000
@NM00038 EQU   $FLAG12                                                  00730000
$VARYINP EQU   $FLAG12                                                  00731000
$ENDTEST EQU   $FLAG12                                                  00732000
$VRYHRD  EQU   $FLAG12                                                  00733000
$VRYSFT  EQU   $FLAG12                                                  00734000
$POSTFLG EQU   $FLAG12                                                  00735000
$OPTMSG  EQU   $FLAG12                                                  00736000
$FEORCAT EQU   $FLAG11                                                  00737000
@NM00037 EQU   $FLAG11                                                  00738000
@NM00036 EQU   $FLAG10                                                  00739000
$INBND   EQU   $FLAG10                                                  00740000
$WAITFLG EQU   $FLAG10                                                  00741000
$DPRINT  EQU   $FLAG10                                                  00742000
$HOLD    EQU   $FLAG9                                                   00743000
$NOTRRCH EQU   $FLAG9                                                   00744000
@NM00035 EQU   $FLAG9                                                   00745000
$COPY    EQU   $FLAG9                                                   00746000
$LSTLNSW EQU   $FLAG9                                                   00747000
$MULLNSW EQU   $FLAG9                                                   00748000
$REMSW   EQU   $FLAG9                                                   00749000
$IGRES   EQU   $FLAG9                                                   00750000
$TCECM   EQU   $FLAG8                                                   00751000
$VS2     EQU   $FLAG8                                                   00752000
$VS1     EQU   $FLAG8                                                   00753000
$EDOS    EQU   $FLAG8                                                   00754000
@NM00034 EQU   $FLAG8                                                   00755000
$TWOWAY  EQU   $FLAG8                                                   00756000
@NM00033 EQU   $FLAG8                                                   00757000
$RCVMSG  EQU   $FLAG7                                                   00758000
$RCVRFLG EQU   $FLAG7                                                   00759000
$SNDRFLG EQU   $FLAG7                                                   00760000
$LDOIS   EQU   $FLAG7                                                   00761000
$DCONTCT EQU   $FLAG7                                                   00762000
$EXIOWAT EQU   $FLAG7                                                   00763000
$2NDDATA EQU   $FLAG7                                                   00764000
$1STDATA EQU   $FLAG7                                                   00765000
$CIREQ   EQU   $FLAG6                                                   00766000
$ABTERM  EQU   $ABNDBIT                                                 00767000
$DISCREQ EQU   $FLAG6                                                   00768000
$DISCISS EQU   $FLAG6                                                   00769000
$CHANGE  EQU   $FLAG6                                                   00770000
$CTERROR EQU   $FLAG6                                                   00771000
$RECAL11 EQU   $FLAG6                                                   00772000
@NM00032 EQU   $FLAG5                                                   00773000
$PROGCK  EQU   $CANCEL                                                  00774000
$PRINTAP EQU   $FLAG5                                                   00775000
@NM00031 EQU   $FLAG5                                                   00776000
$MSG922  EQU   $FLAG5                                                   00777000
$CT924   EQU   $FLAG5                                                   00778000
$FSTCAT  EQU   $FLAG5                                                   00779000
$FSTFE   EQU   $FLAG5                                                   00780000
$ACTOPND EQU   $FLAG4                                                   00781000
$ACQCUTT EQU   $FLAG4                                                   00782000
$CLSSACT EQU   $FLAG4                                                   00783000
$BACKINT EQU   $FLAG4                                                   00784000
$DMSGSW  EQU   $FLAG4                                                   00785000
$TSTDEVP EQU   $FLAG4                                                   00786000
$APRQPER EQU   $FLAG4                                                   00787000
$OPCOM   EQU   $FLAG4                                                   00788000
$NEWAP   EQU   $FLAG3                                                   00789000
$ALTPRTR EQU   $FLAG3                                                   00790000
$OPTERR  EQU   $FLAG3                                                   00791000
$PRTONLY EQU   $FLAG3                                                   00792000
$REQSTOR EQU   $FLAG3                                                   00793000
$LOGOFFE EQU   $FLAG3                                                   00794000
$TSTERR  EQU   $FLAG3                                                   00795000
$DEVERR  EQU   $FLAG3                                                   00796000
$PARTIAL EQU   $FLAG2                                                   00797000
$NRMTERM EQU   $FLAG2                                                   00798000
$VALDTST EQU   $FLAG2                                                   00799000
$VALDDEV EQU   $FLAG2                                                   00800000
$DBLSLSH EQU   $FLAG2                                                   00801000
$NDR     EQU   $FLAG2                                                   00802000
@NM00030 EQU   $FLAG2                                                   00803000
$OLTACT  EQU   $FLAG1                                                   00804000
$NORELDV EQU   $FLAG1                                                   00805000
@NM00029 EQU   $FLAG1                                                   00806000
$OPTCHNG EQU   $FLAG1                                                   00807000
$DEVCHNG EQU   $FLAG1                                                   00808000
$TESTCNG EQU   $FLAG1                                                   00809000
$CNSLFG  EQU   $FLAG1                                                   00810000
$TEP3RD  EQU   $FLAG1                                                   00811000
@NM00028 EQU   $CDA+120                                                 00812000
$CUCNT   EQU   $CDA+118                                                 00813000
@NM00027 EQU   $CDA+117                                                 00814000
$PRTFORM EQU   $CDA+116                                                 00815000
$OPISCNT EQU   $CDA+114                                                 00816000
$OPNDCNT EQU   $CDA+112                                                 00817000
$GETMSZE EQU   $CDA+110                                                 00818000
$GRCNTS  EQU   $CDA+108                                                 00819000
$CTLCNT  EQU   $CDA+106                                                 00820000
$ACTLVL  EQU   $CDA+105                                                 00821000
$PRNTLVL EQU   $CDA+104                                                 00822000
$ERRCNTA EQU   $CDA+102                                                 00823000
$TLCNT   EQU   $CDA+100                                                 00824000
$TIMEALW EQU   $CDA+96                                                  00825000
$PTRAREA EQU   $CDA+92                                                  00826000
$GETMPTR EQU   $CDA+88                                                  00827000
$R13PTRT EQU   $CDA+84                                                  00828000
$R13PTR  EQU   $CDA+80                                                  00829000
$TEPEND  EQU   $CDA+76                                                  00830000
$PLINKDL EQU   $CDA+72                                                  00831000
$TEPBEGN EQU   $CDA+68                                                  00832000
$HIGHADR EQU   $HIMOREC                                                 00833000
$LOMOREC EQU   $CDA+56                                                  00834000
$ENDCOMM EQU   $CDA+48                                                  00835000
$COMMON  EQU   $RCA                                                     00836000
$SLASHAD EQU   $CDA+32                                                  00837000
$PASSON  EQU   $CDA+28                                                  00838000
$TOLBRTB EQU   $CDA+24                                                  00839000
$SCTPTR8 EQU   $CDA+20                                                  00840000
$SCTPTR  EQU   $CDA+16                                                  00841000
$TBWDPTR EQU   $CDA+12                                                  00842000
$TFWDPTR EQU   $CDA+8                                                   00843000
@NM00026 EQU   $CDA                                                     00844000
@NM00025 EQU   $SCTTBLE+98                                              00845000
$SCTLWTC EQU   $SCTTBLE+96                                              00846000
$SCTLWTA EQU   $SCTTBLE+92                                              00847000
#EXT     EQU   $SCTTBLE+88                                              00848000
#PASS    EQU   $SCTTBLE+84                                              00849000
#TABLE   EQU   $SCTTBLE+80                                              00850000
#MSGIDAC EQU   $SCTTBLE+78                                              00851000
@NM00024 EQU   $SCTTBLE+71                                              00852000
$RETMASK EQU   $SCTTBLE+70                                              00853000
$R249255 EQU   $ROUTMSK+29                                              00854000
$R241248 EQU   $ROUTMSK+28                                              00855000
$R233240 EQU   $ROUTMSK+27                                              00856000
$R225232 EQU   $ROUTMSK+26                                              00857000
$R217224 EQU   $ROUTMSK+25                                              00858000
$R209216 EQU   $ROUTMSK+24                                              00859000
$R201208 EQU   $ROUTMSK+23                                              00860000
$R193200 EQU   $ROUTMSK+22                                              00861000
$R185192 EQU   $ROUTMSK+21                                              00862000
$R177184 EQU   $ROUTMSK+20                                              00863000
$R169176 EQU   $ROUTMSK+19                                              00864000
$R161168 EQU   $ROUTMSK+18                                              00865000
$R153160 EQU   $ROUTMSK+17                                              00866000
$R145152 EQU   $ROUTMSK+16                                              00867000
$R137144 EQU   $ROUTMSK+15                                              00868000
$R129136 EQU   $ROUTMSK+14                                              00869000
$R121128 EQU   $ROUTMSK+13                                              00870000
$R113120 EQU   $ROUTMSK+12                                              00871000
$R105112 EQU   $ROUTMSK+11                                              00872000
$R097104 EQU   $ROUTMSK+10                                              00873000
$R089096 EQU   $ROUTMSK+9                                               00874000
$R081088 EQU   $ROUTMSK+8                                               00875000
$R073080 EQU   $ROUTMSK+7                                               00876000
$R065072 EQU   $ROUTMSK+6                                               00877000
$R057064 EQU   $ROUTMSK+5                                               00878000
$R049056 EQU   $ROUTMSK+4                                               00879000
$R041048 EQU   $ROUTMSK+3                                               00880000
$R033040 EQU   $ROUTMSK+2                                               00881000
$R025032 EQU   $ROUTMSK+1                                               00882000
$R017024 EQU   $ROUTMSK                                                 00883000
$TOTFLG2 EQU   $SCTTBLE+39                                              00884000
@NM00023 EQU   $TOTFLG1                                                 00885000
@NM00022 EQU   $TOTFLG1                                                 00886000
@NM00021 EQU   $TOTFLG1                                                 00887000
$CURELOD EQU   $TOTFLG1                                                 00888000
$CTEQTT  EQU   $TOTFLG1                                                 00889000
@NM00020 EQU   $TOTFLG1                                                 00890000
@NM00019 EQU   $TOTFLG1                                                 00891000
$LINESHR EQU   $TOTFLG1                                                 00892000
@NM00018 EQU   $OLTFLG2                                                 00893000
@NM00017 EQU   $OLTFLG2                                                 00894000
@NM00016 EQU   $OLTFLG2                                                 00895000
@NM00015 EQU   $OLTFLG2                                                 00896000
@NM00014 EQU   $OLTFLG2                                                 00897000
@NM00013 EQU   $OLTFLG2                                                 00898000
@NM00012 EQU   $OLTFLG2                                                 00899000
$TALK    EQU   $OLTFLG2                                                 00900000
$DYCOM   EQU   $OLTFLGS                                                 00901000
@NM00011 EQU   $OLTFLGS                                                 00902000
$TRACE   EQU   $OLTFLGS                                                 00903000
$RETCODE EQU   $OLTFLGS                                                 00904000
$CONTCB  EQU   $OLTFLGS                                                 00905000
$RETAIN  EQU   $OLTFLGS                                                 00906000
$CLEANRT EQU   $OLTFLGS                                                 00907000
$MANINTV EQU   $OLTFLGS                                                 00908000
$OLTSIZE EQU   $SCTTBLE+34                                              00909000
$QSCTMOD EQU   $EXECFLG                                                 00910000
$CTRLMOD EQU   $EXECFLG                                                 00911000
$CLEANUP EQU   $EXECFLG                                                 00912000
$LSTPDEV EQU   $EXECFLG                                                 00913000
$ERRCNT  EQU   $EXECFLG                                                 00914000
$RTNSLCT EQU   $EXECFLG                                                 00915000
$MULTDEV EQU   $EXECFLG                                                 00916000
@NM00010 EQU   $EXECFLG                                                 00917000
$RMSKCNT EQU   $SCTTBLE+32                                              00918000
$SYNAME  EQU   $CDS8T19+4                                               00919000
$EXTSIG  EQU   $CDS8T19+3                                               00920000
$CDFLGS  EQU   $CDS8T19+1                                               00921000
$CDSCNT  EQU   $CDS8T19                                                 00922000
$PDEVDSC EQU   $SCTTBLE+16                                              00923000
$PDEVADR EQU   $SCTTBLE+12                                              00924000
$COMMCN  EQU   $CDSFLGS                                                 00925000
$CUSTSYM EQU   $CDSFLGS                                                 00926000
$TWOCHSW EQU   $CDSFLGS                                                 00927000
$SYMNAME EQU   $CDSFLGS                                                 00928000
$EXTINTC EQU   $CDSFLGS                                                 00929000
$CEVOL   EQU   $CDSFLGS                                                 00930000
$SHARED  EQU   $CDSFLGS                                                 00931000
$FPM     EQU   $CDSFLGS                                                 00932000
$LASTSUB EQU   $PDEVFLG                                                 00933000
@NM00009 EQU   $PDEVFLG                                                 00934000
@NM00008 EQU   $PDEVFLG                                                 00935000
@NM00007 EQU   $PDEVFLG                                                 00936000
$LASTDEV EQU   $PDEVFLG                                                 00937000
@NM00006 EQU   $PDEVFLG                                                 00938000
$EXFILPT EQU   $PDEVFLG                                                 00939000
$FPMOLD  EQU   $PDEVFLG                                                 00940000
$TSSSYM  EQU   $SCTTBLE+8                                               00941000
$SCTLEVL EQU   $SCTTBLE+7                                               00942000
$DRIVER  EQU   $SCTTBLE+6                                               00943000
$RT0916  EQU   $SCTTBLE+5                                               00944000
$RT0108  EQU   $SCTTBLE+4                                               00945000
$LOOPTST EQU   $ERROPT                                                  00946000
$LOOPERR EQU   $ERROPT                                                  00947000
$NERRPRT EQU   $ERROPT                                                  00948000
$NOCNTRL EQU   $ERROPT                                                  00949000
$ALTPRNT EQU   $ERROPT                                                  00950000
$CATERR  EQU   $ERROPT                                                  00951000
$ASTERIK EQU   $ERROPT                                                  00952000
$TESTERR EQU   $ERROPT                                                  00953000
$FSTCOMM EQU   $TESTOPT                                                 00954000
$INDEFLP EQU   $TESTOPT                                                 00955000
$NOPRT   EQU   $TESTOPT                                                 00956000
$PARAPRT EQU   $TESTOPT                                                 00957000
@NM00005 EQU   $TESTOPT                                                 00958000
$ERRLPCT EQU   $SCTTBLE                                                 00959000
$TLTEND  EQU   $RCAAREA+945                                             00960000
$CNSLID  EQU   $RCAAREA+936                                             00961000
$EXITSAV EQU   $RCAAREA+864                                             00962000
$TRASCII EQU   $RCAAREA+608                                             00963000
@NM00004 EQU   $RCAAREA+605                                             00964000
$VTAMEND EQU   $RCAFLG                                                  00965000
$TPPOSTD EQU   $RCAFLG                                                  00966000
$NEWCT   EQU   $RCAFLG                                                  00967000
$ABNDALL EQU   $RCAFLG                                                  00968000
$CUTESTB EQU   $RCAFLG                                                  00969000
$CONSOLE EQU   $RCAFLG                                                  00970000
$TPLOGON EQU   $RCAFLG                                                  00971000
$UPDATE  EQU   $RCAFLG                                                  00972000
$DEVAREA EQU   $RCAAREA+600                                             00973000
$CTDVAR  EQU   $RCAAREA+596                                             00974000
$BUFFS   EQU   $RCAAREA+464                                             00975000
$TLTNIB  EQU   $CONSTNT+140                                             00976000
$TLTPRPL EQU   $CONSTNT+20                                              00977000
@NM00003 EQU   $CONSTNT+4                                               00978000
@NM00002 EQU   $CONSTNT+2                                               00979000
$USECNT  EQU   $CONSTNT                                                 00980000
$CURRTWA EQU   $POINTER+140                                             00981000
$CTNAME  EQU   $POINTER+132                                             00982000
$CTARGX  EQU   $POINTER+128                                             00983000
$COMINT  EQU   $POINTER+120                                             00984000
$QUEHNDL EQU   $POINTER+116                                             00985000
@NM00001 EQU   $POINTER+36                                              00986000
$RTNPTR  EQU   $POINTER+32                                              00987000
$TLTECB2 EQU   $POINTER+28                                              00988000
$TLTECB1 EQU   $POINTER+24                                              00989000
$CLEANP  EQU   $POINTER+20                                              00990000
$ABEND   EQU   $POINTER+16                                              00991000
$LSTAREA EQU   $POINTER+12                                              00992000
$FSTAREA EQU   $POINTER+8                                               00993000
$CVTSAVE EQU   $POINTER+4                                               00994000
$TOLTEP  EQU   $POINTER                                                 00995000
$TLTACB  EQU   $RCAAREA                                                 00996000
.@UNREFD ANOP                          END UNREFERENCED COMPONENTS      00997000
@RT00055 EQU   S2CC0001                                                 00998000
@RT00059 EQU   S2CC0090                                                 00999000
@RT00075 EQU   S2CC0008                                                 01000000
@RT00078 EQU   S2CC0003                                                 01001000
@RT00080 EQU   S2CC0004                                                 01002000
@RT00083 EQU   S2CC0005                                                 01003000
@RT00086 EQU   S2CC0008                                                 01004000
@RT00088 EQU   S2CC0006                                                 01005000
@RT00090 EQU   S2CC0007                                                 01006000
@RT00092 EQU   S2CC0007                                                 01007000
@RT00100 EQU   S2CC0008                                                 01008000
@RT00105 EQU   S2CC0010                                                 01009000
@RT00111 EQU   S2CC0011                                                 01010000
@RT00118 EQU   S2CC0090                                                 01011000
@RT00122 EQU   S2CC0012                                                 01012000
@RT00136 EQU   S2CC0021                                                 01013000
@ENDDATA EQU   *                                                        01014000
         END   ISTSC02C,(C'PLS1512',0702,78337)                         01015000
./  ADD  SSI=83370145,NAME=ISTSC02D
         TITLE 'ISTSC02D,PLINK FUNCTION FOR THE OLT SECTION'            00001000
ISTSC02D CSECT ,                                                   0001 00002000
@MAINENT DS    0H                                                  0001 00003000
         USING *,@15                                               0001 00004000
         B     @PROLOG                                             0001 00005000
         DC    AL1(16)                                             0001 00006000
         DC    C'ISTSC02D  78.337'                                 0001 00007000
         DROP  @15                                                      00008000
@PROLOG  ST    @14,12(,@13)                                        0001 00009000
         STM   @00,@12,20(@13)                                     0001 00010000
         BALR  @12,0                                               0001 00011000
@PSTART  DS    0H                                                  0001 00012000
         USING @PSTART,@12                                         0001 00013000
*                                                                  0041 00014000
*   /*****************************************************************/ 00015000
*   /*                                                               */ 00016000
*   /* BEGINNING OF EXECUTABLE CODE                                  */ 00017000
*   /*                                                               */ 00018000
*   /*****************************************************************/ 00019000
*                                                                  0042 00020000
*   SVESC02D(2)=R13;                /* SET UP BACK POINTER           */ 00021000
         ST    R13,SVESC02D+4(,WAPTR)                              0042 00022000
*   BACKSAVE(3)=ADDR(SVESC02D);     /* PUT FORWARD CHAIN IN LAST     */ 00023000
         LA    @14,SVESC02D(,WAPTR)                                0043 00024000
         ST    @14,BACKSAVE+8(,R13)                                0043 00025000
*   R13=ADDR(SVESC02D);             /* POINT TO SAVE AREA FOR MOD    */ 00026000
         LR    R13,@14                                             0044 00027000
*   PLIMAP=R1;                      /* SETUP BASE TO PARM LIST       */ 00028000
         LR    PLIMAP,R1                                           0045 00029000
*   RC=0;                           /* SET GOOD RETURN CODE          */ 00030000
         SLR   RC,RC                                               0046 00031000
*   IF $PLNKDL='1'B THEN            /* IF DELETE REQUEST, RETURN     */ 00032000
         TM    $PLNKDL(PLIMAP),B'00001000'                         0047 00033000
         BO    @RT00047                                            0047 00034000
*     GO TO S2DC0090;               /* GO TO COMMON MODULE RETURN    */ 00035000
*   RC=8;                           /* SET ERROR RETURN CODE         */ 00036000
         LA    RC,8                                                0049 00037000
*   IF $PLNKLD='0'B|$PLNKLOD=0 THEN /* IF THERE IS PARM LIST ERR     */ 00038000
         TM    $PLNKLD(PLIMAP),B'10000000'                         0050 00039000
         BZ    @RT00050                                            0050 00040000
         CLI   $PLNKLOD(PLIMAP),0                                  0050 00041000
         BE    @RT00050                                            0050 00042000
*     GO TO S2DC0090;               /* GO TO COMMON MODULE RETURN    */ 00043000
*   RC=0;                           /* SET GOOD RETURN CODE          */ 00044000
*                                                                  0052 00045000
         SLR   RC,RC                                               0052 00046000
*   /*****************************************************************/ 00047000
*   /*                                                               */ 00048000
*   /* THE FOLLOWING LOOP IS EXECUTED ONCE FOR EVERY MODULE THAT     */ 00049000
*   /* APPEARS IN THE PLINK PARAMETER LIST. IF APPROPRIATE, IT LOOKS */ 00050000
*   /* IN THE MORECORE CHAIN, AND IF IT FINDS IT THERE, IT PASSES    */ 00051000
*   /* BACK THAT ADDRESS FOR AN ENTRYPOINT. OTHERWISE, THE MODULE IS */ 00052000
*   /* LOADED INTO THE MORECORE AREA IF AVAILABLE OR INTO THE OLTAREA*/ 00053000
*   /* IF THERE IS NO MORECORE AREA.                                 */ 00054000
*   /*                                                               */ 00055000
*   /*****************************************************************/ 00056000
*                                                                  0053 00057000
*   DO INDEX=1 TO $PLNKLOD;         /* LOAD ALL PLINK MODULES        */ 00058000
         LA    INDEX,1                                             0053 00059000
         B     @DE00053                                            0053 00060000
@DL00053 DS    0H                                                  0054 00061000
*     LDRNAME=$PLNMOD(INDEX);       /* PUT IN THIS MOD NAME          */ 00062000
         LR    @14,INDEX                                           0054 00063000
         SLA   @14,3                                               0054 00064000
         ALR   @14,PLIMAP                                          0054 00065000
         MVC   LDRNAME(8),$PLNMOD-8(@14)                           0054 00066000
*     RESPECIFY                                                    0055 00067000
*       COREMANG BASED(MS);         /* SETUP PROPER POINTER TO CHAIN */ 00068000
*                                                                  0055 00069000
*     /***************************************************************/ 00070000
*     /*                                                             */ 00071000
*     /* IF THERE HAS BEEN A MORECORE ISSUED, AND THE BIT INDICATES  */ 00072000
*     /* THERE MIGHT BE A MORECORE PLINK MODULE, CHECK THE CHAIN FOR */ 00073000
*     /* THE MODULE IN QUESTION. STOP WHEN THE CHAIN POINTER IS A    */ 00074000
*     /* ZERO.                                                       */ 00075000
*     /*                                                             */ 00076000
*     /***************************************************************/ 00077000
*                                                                  0056 00078000
*     IF $FSTMCIS='1'B&#PLKMCOR='1'B&$PLNKPM='0'B THEN/* CHECK TO SEE   00079000
*                                      IF THE MORECORE CHAIN SHOULD     00080000
*                                      BE CHECKED                    */ 00081000
         TM    $FSTMCIS(WAPTR),B'00000100'                         0056 00082000
         BNO   @RF00056                                            0056 00083000
         L     @14,$LOWADDR(,WAPTR)                                0056 00084000
         LH    @09,RTNDISP(,@14)                                   0056 00085000
         ALR   @09,@14                                             0056 00086000
         TM    #PLKMCOR(@09),B'00100000'                           0056 00087000
         BNO   @RF00056                                            0056 00088000
         TM    $PLNKPM(PLIMAP),B'00100000'                         0056 00089000
         BNZ   @RF00056                                            0056 00090000
*       DO MS=$FRELPTR BY 0 WHILE(MS¬=0);/* SCAN THE CHAIN FOR THE 0057 00091000
*                                      MODULE                        */ 00092000
         L     MS,$FRELPTR(,WAPTR)                                 0057 00093000
         B     @DE00057                                            0057 00094000
@DL00057 DS    0H                                                  0058 00095000
*         IF PLMC='1'B&BUFFER(1:8)=LDRNAME THEN/* IF FILL MATCH,   0058 00096000
*                                      ALTER POINTERS                */ 00097000
         TM    PLMC(MS),B'00000010'                                0058 00098000
         BNO   @RF00058                                            0058 00099000
         CLC   BUFFER(8,MS),LDRNAME                                0058 00100000
         BNE   @RF00058                                            0058 00101000
*           DO;                     /* SET POINTER TO MORECORE AREA  */ 00102000
*             MS=ADDR(BUFFER);      /* FIRST BYTE OF AREA IS FIRST 0060 00103000
*                                      BYTE OF MODULE                */ 00104000
         LA    @14,BUFFER(,MS)                                     0060 00105000
         LR    MS,@14                                              0060 00106000
*             GO TO S2DC0030;       /* DONE FOR THIS PLINK MODULE    */ 00107000
         B     S2DC0030                                            0061 00108000
*           END;                    /* END OF MATCH CODE             */ 00109000
*         MS=COREFWDN;              /* SET POINTER TO NEXT AREA IN 0063 00110000
*                                      CHAIN                         */ 00111000
@RF00058 L     MS,COREFWDN(,MS)                                    0063 00112000
*       END;                        /* END OF MORECORE CHAIN SCAN    */ 00113000
*                                                                  0064 00114000
@DE00057 LTR   MS,MS                                               0064 00115000
         BNZ   @DL00057                                            0064 00116000
*     /***************************************************************/ 00117000
*     /*                                                             */ 00118000
*     /* IF IT IS NOT IN MORECORE CHAIN, GET ALL PERTINENT INFO ABOUT*/ 00119000
*     /* MODULE SO IT CAN BE DETERMINED IF IT WILL FIT AND IF THERE  */ 00120000
*     /* IS MORECORE SPACE FOR IT                                    */ 00121000
*     /*                                                             */ 00122000
*     /***************************************************************/ 00123000
*                                                                  0065 00124000
*     LDRADR=$LOWADDR;              /* PUT IN LOAD ADDRESS           */ 00125000
@RF00056 L     @14,$LOWADDR(,WAPTR)                                0065 00126000
         ST    @14,LDRADR                                          0065 00127000
*     LDRCOMP='1'B;                 /* COMPUTE SIZE OF MODULE        */ 00128000
         OI    LDRCOMP,B'01000000'                                 0066 00129000
*     R1=ADDR(LDRPARM);             /* POINT TO PARMLIST             */ 00130000
         LA    R1,LDRPARM                                          0067 00131000
*     CALL ISTCC013;                /* CALL LOADER FOR SIZE          */ 00132000
         L     @15,@CV00353                                        0068 00133000
         BALR  @14,@15                                             0068 00134000
*     IF R15=12 THEN                /* SET RET CODE IF NOT FOUND     */ 00135000
         C     R15,@CF00161                                        0069 00136000
         BE    @RT00069                                            0069 00137000
*       GO TO S2DC0050;             /* RETURN CODE OF 12             */ 00138000
*     IF R15¬=0 THEN                /* SET I/O ERROR RETURN CODE     */ 00139000
         LTR   R15,R15                                             0071 00140000
         BNZ   @RT00071                                            0071 00141000
*       GO TO S2DC0040;             /* RETURN CODE OF 8              */ 00142000
*                                                                  0072 00143000
*     /***************************************************************/ 00144000
*     /*                                                             */ 00145000
*     /* IF THE PLINK MODULE CAN BE PUT INTO MORECORE, AND IF THE    */ 00146000
*     /* ROOT WANTS IT TO BE PUT INTO MORECORE, THEN TRY TO GET SPACE*/ 00147000
*     /* FOR THE MODULE FROM THE MORECORE MODULE. IF THE SPACE CAN BE*/ 00148000
*     /* GOTTEN, CREATE A LOAD ADDRESS SUCH THAT THE PLINK MODULE    */ 00149000
*     /* WILL END UP AT THE FIRST BYTE OF THE MORECORE AREA          */ 00150000
*     /*                                                             */ 00151000
*     /***************************************************************/ 00152000
*                                                                  0073 00153000
*     IF $PLNKPM='0'B&#PLKMCOR='1'B THEN                           0073 00154000
         TM    $PLNKPM(PLIMAP),B'00100000'                         0073 00155000
         BNZ   @RF00073                                            0073 00156000
         L     @14,$LOWADDR(,WAPTR)                                0073 00157000
         LH    @09,RTNDISP(,@14)                                   0073 00158000
         ALR   @09,@14                                             0073 00159000
         TM    #PLKMCOR(@09),B'00100000'                           0073 00160000
         BNO   @RF00073                                            0073 00161000
*       DO;                         /* ANY PLINK IN MORECORE AREA?   */ 00162000
*         MCORMAX=R0;               /* SET MAX TO SIZE OF OLT        */ 00163000
         ST    R0,MCORMAX                                          0075 00164000
*         MCORMIN=R0;               /* SET MIN TO SIZE OF OLT        */ 00165000
         ST    R0,MCORMIN                                          0076 00166000
*         R0SAVE=R0;                /* SAVE R0 ACROSS MORECORE CALL  */ 00167000
         LR    R0SAVE,R0                                           0077 00168000
*         R1SAVE=R1;                /* SAVE R1 ACROSS MORECORE CALL  */ 00169000
         LR    R1SAVE,R1                                           0078 00170000
*         R1=ADDR(MCORELST);        /* POINT TO PARAMETER LIST       */ 00171000
         LA    R1,MCORELST                                         0079 00172000
*         CALL ISTSC02C;            /* TRY TO GET THE CORE REQUIRED  */ 00173000
         L     @15,@CV00356                                        0080 00174000
         BALR  @14,@15                                             0080 00175000
*         MCRPTR=R1;                /* SAVE TENATIVE CORE POINTER    */ 00176000
         LR    MCRPTR,R1                                           0081 00177000
*         R0=R0SAVE;                /* RESTORE R0 FROM BEFORE CALL   */ 00178000
         LR    R0,R0SAVE                                           0082 00179000
*         R1=R1SAVE;                /* RESTORE R1 FROM BEFORE CALL   */ 00180000
         LR    R1,R1SAVE                                           0083 00181000
*         IF R15=0 THEN                                            0084 00182000
         LTR   R15,R15                                             0084 00183000
         BNZ   @RF00084                                            0084 00184000
*           DO;                     /* IF WE GOT CORE, ALTER POINTERS*/ 00185000
*             RESPECIFY                                            0086 00186000
*               COREMANG BASED(MCRPTR-8);/* SET PROPER POINTER TO  0086 00187000
*                                      CORE                          */ 00188000
*             LDRADR=ADDR(BUFFER)-(R1-$LOWADDR);/* BACK UP BY      0087 00189000
*                                      RELATIVE DISPLACEMENT         */ 00190000
         LR    @14,MCRPTR                                          0087 00191000
         SL    @14,@CF00040                                        0087 00192000
         LA    @09,BUFFER(,@14)                                    0087 00193000
         LR    @04,R1                                              0087 00194000
         SL    @04,$LOWADDR(,WAPTR)                                0087 00195000
         LCR   @04,@04                                             0087 00196000
         ALR   @04,@09                                             0087 00197000
         ST    @04,LDRADR                                          0087 00198000
*             R1=ADDR(BUFFER);      /* SET MODULE TO START AT      0088 00199000
*                                      MORECORE AREA                 */ 00200000
         LR    R1,@09                                              0088 00201000
*             PLMC='1'B;            /* SHOW MORECORE AREA HAS PLINK     00202000
*                                      IN                            */ 00203000
         OI    PLMC(@14),B'00000010'                               0089 00204000
*           END;                    /* END OF CORE GOTTEN SECTION    */ 00205000
*       END;                        /* END OF TRYING TO PUT PLINK IN    00206000
*                                      MORECORE AREA                 */ 00207000
*                                                                  0091 00208000
@RF00084 DS    0H                                                  0092 00209000
*     /***************************************************************/ 00210000
*     /*                                                             */ 00211000
*     /* MAKE SURE THE MODULE WILL FIT IN THE AREA ALLOWED TO THE    */ 00212000
*     /* OLT. IF IT WILL, GO TO THE LOADER TO BRING IT IN. STORE THE */ 00213000
*     /* RETURN CODE IN A TEMPORARY AREA AND GIVE THE OLT THE LAST   */ 00214000
*     /* NON-ZERO RETURN CODE GENERATED. STORE THE ENTRY ADDRESS IN  */ 00215000
*     /* THE ENTRYPOINT TABLE PASSED IN THE PARAMETER LIST.          */ 00216000
*     /*                                                             */ 00217000
*     /***************************************************************/ 00218000
*                                                                  0092 00219000
*     IF R1+R0>$HIGHADR THEN        /* IF MODULE WONT FIT, ERROR     */ 00220000
@RF00073 LR    @14,R1                                              0092 00221000
         ALR   @14,R0                                              0092 00222000
         C     @14,$HIGHADR(,WAPTR)                                0092 00223000
         BH    @RT00092                                            0092 00224000
*       GO TO S2DC0045;             /* SET RETURN CODE OF 16         */ 00225000
*     MS=R1;                        /* GET BEGINNING OF PLINK MOD    */ 00226000
         LR    MS,R1                                               0094 00227000
*     LDRCOMP='0'B;                 /* ALL OK, LOAD                  */ 00228000
         NI    LDRCOMP,B'10111111'                                 0095 00229000
*     R1=ADDR(LDRPARM);             /* POINT TO PARMLIST             */ 00230000
         LA    R1,LDRPARM                                          0096 00231000
*     CALL ISTCC013;                /* LOAD PLINK MODULE             */ 00232000
         L     @15,@CV00353                                        0097 00233000
         BALR  @14,@15                                             0097 00234000
*     IF R15¬=0 THEN                /* SET I/O ERROR RETURN CODE     */ 00235000
         LTR   R15,R15                                             0098 00236000
         BNZ   @RT00098                                            0098 00237000
*       GO TO S2DC0040;             /* SET RETRUN CODE TO 8          */ 00238000
*S2DC0030:                                                         0100 00239000
*     $PLNKEPL(INDEX)=MS->INST;     /* PUT ENTRYPOINT IN LIST        */ 00240000
S2DC0030 LR    @14,INDEX                                           0100 00241000
         SLA   @14,2                                               0100 00242000
         L     @09,$PLNKENP(,PLIMAP)                               0100 00243000
         L     @04,INST(,MS)                                       0100 00244000
         AL    @09,@CF00379                                        0100 00245000
         ST    @04,$PLNKEPL(@14,@09)                               0100 00246000
*     GO TO S2DC0060;               /* DO NEXT PLINK MODULE          */ 00247000
         B     S2DC0060                                            0101 00248000
*S2DC0040:                                                         0102 00249000
*     RC=8;                         /* I/O ERROR LOADING,TRY NEXT    */ 00250000
S2DC0040 LA    RC,8                                                0102 00251000
*     GO TO S2DC0060;               /* DO NEXT PLINK MODULE          */ 00252000
         B     S2DC0060                                            0103 00253000
*S2DC0045:                                                         0104 00254000
*     RC=16;                        /* NO SPACE FOR MODULE           */ 00255000
S2DC0045 LA    RC,16                                               0104 00256000
*     GO TO S2DC0060;               /* DO NEXT PLINK MODULE          */ 00257000
*                                                                  0105 00258000
         B     S2DC0060                                            0105 00259000
*     /***************************************************************/ 00260000
*     /*                                                             */ 00261000
*     /* IF THE MODULE COULD NOT BE FOUND, GIVE A BAD RETURN CODE AND*/ 00262000
*     /* ISSUE THE MSG 253I TO INFORM THE OPERATOR WHAT MODULE WAS   */ 00263000
*     /* NOT FOUND.                                                  */ 00264000
*     /*                                                             */ 00265000
*     /***************************************************************/ 00266000
*                                                                  0106 00267000
*S2DC0050:                                                         0106 00268000
*     RC=12;                        /* MODULE NOT FOUND              */ 00269000
S2DC0050 LA    RC,12                                               0106 00270000
*     $INBUFR(1:8)=$PLNMOD(INDEX);  /* MODULE NAME FOR MESSAGE       */ 00271000
*                                                                  0107 00272000
         LR    @14,INDEX                                           0107 00273000
         SLA   @14,3                                               0107 00274000
         ALR   @14,PLIMAP                                          0107 00275000
         MVC   $INBUFR(8,WAPTR),$PLNMOD-8(@14)                     0107 00276000
*     /***************************************************************/ 00277000
*     /*                                                             */ 00278000
*     /* TCEC MSGN(253)SUB(YES) INVOKED                              */ 00279000
*     /*                                                             */ 00280000
*     /***************************************************************/ 00281000
*                                                                  0108 00282000
*     $TCECM='1'B;                  /* SET TCEC SW IN RCA            */ 00283000
         OI    $TCECM(WAPTR),B'00000001'                           0108 00284000
*     R1=ADDR($TCA05);              /* SET UP PARM LIST $TR          */ 00285000
         LA    R1,$TCA05                                           0109 00286000
*     CALL #EXIT;                   /* CALL CECOM                    */ 00287000
         L     @15,#EXITA(,WAPTR)                                  0110 00288000
         BALR  @14,@15                                             0110 00289000
*     DCL                                                          0111 00290000
*       1 $TCA05,                   /* TCEC PARM LIST                */ 00291000
*        2 $TCB05 FIXED(32) INIT(253),/* MSG NUMBER                  */ 00292000
*        2 $TCC05 FIXED(32) INIT(0),/* INCT LEN                      */ 00293000
*        2 $TCD05 BIT(8) INIT('10000000'B),/* FLAG                   */ 00294000
*        2 $TCE05 CHAR(4) INIT('FFFFFFFF'X);/* MSSAGE MASK           */ 00295000
*S2DC0060:                                                         0112 00296000
*   END;                            /* END OF PLINK LOOP             */ 00297000
S2DC0060 AL    INDEX,@CF00070                                      0112 00298000
@DE00053 SLR   @14,@14                                             0112 00299000
         IC    @14,$PLNKLOD(,PLIMAP)                               0112 00300000
         CR    INDEX,@14                                           0112 00301000
         BNH   @DL00053                                            0112 00302000
*S2DC0090:                                                         0113 00303000
*   R15=RC;                         /* SET ACTUAL RETURN CODE        */ 00304000
S2DC0090 LR    R15,RC                                              0113 00305000
*   R13=SVESC02D(2);                /* PICK UP PREVIOUS SAVEAREA     */ 00306000
         L     R13,SVESC02D+4(,WAPTR)                              0114 00307000
*   DO;                             /* ATDSPLY                       */ 00308000
*   END;                            /* ATDSPLY                       */ 00309000
*   END ISTSC02D;                   /* END OF PLINK FUNCTION         */ 00310000
@EL00001 DS    0H                                                  0117 00311000
@EF00001 DS    0H                                                  0117 00312000
@ER00001 L     @14,12(,@13)                                        0117 00313000
         LM    @00,@12,20(@13)                                     0117 00314000
         BR    @14                                                 0117 00315000
@DATA    DS    0H                                                       00316000
         DS    0F                                                       00317000
         DS    0F                                                       00318000
@CF00070 DC    F'1'                                                     00319000
@CF00040 DC    F'8'                                                     00320000
@CF00161 DC    F'12'                                                    00321000
@CF00379 DC    F'-4'                                                    00322000
@CV00353 DC    V(ISTCC013)                                              00323000
@CV00356 DC    V(ISTSC02C)                                              00324000
         DS    0D                                                       00325000
MCORELST DS    CL12                                                     00326000
         ORG   MCORELST                                                 00327000
@NM00031 DC    X'0102F4F2'                                              00328000
MCORMAX  DS    FL4                                                      00329000
MCORMIN  DS    FL4                                                      00330000
         ORG   MCORELST+12                                              00331000
LDRPARM  DS    CL8                                                      00332000
         ORG   LDRPARM                                                  00333000
@NM00035 DS    CL4                                                      00334000
@NM00036 DC    AL4(LDRPARME)                                            00335000
         ORG   LDRPARM+8                                                00336000
LDRPARME DS    CL16                                                     00337000
         ORG   LDRPARME                                                 00338000
LDRNAME  DS    CL8                                                      00339000
LDRADR   DS    AL4                                                      00340000
@NM00037 DC    X'80'                                                    00341000
         ORG   @NM00037                                                 00342000
LDRPLINK DS    BL1                                                      00343000
LDRCOMP  EQU   @NM00037+0                                               00344000
@NM00038 EQU   @NM00037+0                                               00345000
         ORG   LDRPARME+13                                              00346000
@NM00039 DS    CL1                                                      00347000
@NM00040 DC    H'0'                                                     00348000
         ORG   LDRPARME+16                                              00349000
$TCA05   DS    CL13                                                     00350000
         ORG   $TCA05                                                   00351000
$TCB05   DC    A(253)                                                   00352000
$TCC05   DC    A(0)                                                     00353000
$TCD05   DC    B'10000000'                                              00354000
$TCE05   DC    X'FFFFFFFF'                                              00355000
         ORG   $TCA05+13                                                00356000
         DS    CL3                                                      00357000
PATCH    DC    40F'0'                                                   00358000
@00      EQU   00                      EQUATES FOR REGISTERS 0-15       00359000
@01      EQU   01                                                       00360000
@02      EQU   02                                                       00361000
@03      EQU   03                                                       00362000
@04      EQU   04                                                       00363000
@05      EQU   05                                                       00364000
@06      EQU   06                                                       00365000
@07      EQU   07                                                       00366000
@08      EQU   08                                                       00367000
@09      EQU   09                                                       00368000
@10      EQU   10                                                       00369000
@11      EQU   11                                                       00370000
@12      EQU   12                                                       00371000
@13      EQU   13                                                       00372000
@14      EQU   14                                                       00373000
@15      EQU   15                                                       00374000
INDEX    EQU   @08                                                      00375000
R0SAVE   EQU   @10                                                      00376000
RC       EQU   @07                                                      00377000
MCRPTR   EQU   @05                                                      00378000
R1SAVE   EQU   @09                                                      00379000
MS       EQU   @05                                                      00380000
PLIMAP   EQU   @06                                                      00381000
WAPTR    EQU   @02                                                      00382000
R0       EQU   @00                                                      00383000
R1       EQU   @01                                                      00384000
R13      EQU   @13                                                      00385000
R15      EQU   @15                                                      00386000
TOLTEPWA EQU   0                                                        00387000
$CDA     EQU   TOLTEPWA+100                                             00388000
$RCA     EQU   $CDA+44                                                  00389000
$OLTPTR  EQU   $CDA+52                                                  00390000
$LOWADDR EQU   $OLTPTR                                                  00391000
$HIMOREC EQU   $CDA+60                                                  00392000
$HIGHADR EQU   $HIMOREC                                                 00393000
$FRELPTR EQU   $CDA+64                                                  00394000
$COMMFLG EQU   TOLTEPWA+224                                             00395000
$FLAG6   EQU   $COMMFLG+5                                               00396000
$FSTMCIS EQU   $FLAG6                                                   00397000
$ABNDBIT EQU   $FLAG6                                                   00398000
$FLAG8   EQU   $COMMFLG+7                                               00399000
$TCECM   EQU   $FLAG8                                                   00400000
$INBUFR  EQU   TOLTEPWA+2104                                            00401000
#EXITA   EQU   TOLTEPWA+2632                                            00402000
$CCOMDAT EQU   TOLTEPWA+2644                                            00403000
$CFLGS   EQU   $CCOMDAT+16                                              00404000
$24FEMSG EQU   TOLTEPWA+2681                                            00405000
$24CATMG EQU   $24FEMSG+11                                              00406000
@NM00021 EQU   TOLTEPWA+2776                                            00407000
$OUNTPTR EQU   @NM00021+4                                               00408000
$NSPTR   EQU   $OUNTPTR                                                 00409000
$NSCNT   EQU   @NM00021+10                                              00410000
$ENXX    EQU   @NM00021+15                                              00411000
$IMITX   EQU   $ENXX                                                    00412000
SVESC033 EQU   TOLTEPWA+3160                                            00413000
SVECC013 EQU   TOLTEPWA+3232                                            00414000
SVEIC003 EQU   TOLTEPWA+3592                                            00415000
SVESC022 EQU   TOLTEPWA+3736                                            00416000
SVECC011 EQU   TOLTEPWA+4024                                            00417000
#EXIT    EQU   0                                                        00418000
PLINKMAP EQU   0                                                        00419000
$PLNKENP EQU   PLINKMAP+4                                               00420000
@NM00024 EQU   PLINKMAP+8                                               00421000
$PLNKLD  EQU   @NM00024                                                 00422000
$PLNKPM  EQU   @NM00024                                                 00423000
$PLNKDL  EQU   @NM00024                                                 00424000
$PLNKLOD EQU   PLINKMAP+10                                              00425000
$PLNMOD  EQU   PLINKMAP+12                                              00426000
$PLNKEPL EQU   0                                                        00427000
@NM00027 EQU   0                                                        00428000
RTNDISP  EQU   @NM00027+10                                              00429000
INST     EQU   @NM00027+12                                              00430000
$NEWSPRF EQU   0                                                        00431000
#FLAGS   EQU   $NEWSPRF+16                                              00432000
#PLKMCOR EQU   #FLAGS                                                   00433000
BACKSAVE EQU   0                                                        00434000
COREMANG EQU   0                                                        00435000
CORESZEN EQU   COREMANG                                                 00436000
PLMC     EQU   CORESZEN+3                                               00437000
COREFWDN EQU   COREMANG+4                                               00438000
BUFFER   EQU   COREMANG+8                                               00439000
OLTENTRY EQU   0                                                        00440000
SVESC02D EQU   SVESC022                                                 00441000
SVECC012 EQU   SVESC022                                                 00442000
SVEIC00A EQU   SVEIC003                                                 00443000
SVEIC004 EQU   SVEIC003                                                 00444000
SVEIC005 EQU   SVEIC003                                                 00445000
SVESC02A EQU   SVESC022                                                 00446000
SVESC02B EQU   SVESC022                                                 00447000
SVESC02E EQU   SVESC022                                                 00448000
SVESC02F EQU   SVECC013                                                 00449000
SVESC024 EQU   SVESC022                                                 00450000
SVESC027 EQU   SVESC022                                                 00451000
SVESC029 EQU   SVESC033                                                 00452000
SVESC031 EQU   SVECC013                                                 00453000
SVESC032 EQU   SVECC011                                                 00454000
SVETC037 EQU   SVEIC003                                                 00455000
         AGO   .@UNREFD                START UNREFERENCED COMPONENTS    00456000
FREEN    EQU   CORESZEN+3                                               00457000
@NM00034 EQU   CORESZEN+3                                               00458000
@NM00033 EQU   CORESZEN+3                                               00459000
@NM00032 EQU   CORESZEN                                                 00460000
$RME     EQU   $NEWSPRF+36                                              00461000
@NM00030 EQU   $NEWSPRF+35                                              00462000
$ECA     EQU   $NEWSPRF+32                                              00463000
$DCHB    EQU   $NEWSPRF+28                                              00464000
$MOSIZE  EQU   $NEWSPRF+24                                              00465000
$RTSIZE  EQU   $NEWSPRF+20                                              00466000
$COUNT   EQU   $NEWSPRF+18                                              00467000
$REFNUM  EQU   $NEWSPRF+17                                              00468000
@NM00029 EQU   #FLAGS                                                   00469000
#MSGIDRQ EQU   #FLAGS                                                   00470000
@NM00028 EQU   #FLAGS                                                   00471000
$VIRTUAL EQU   #FLAGS                                                   00472000
$PLINK$  EQU   $NEWSPRF+12                                              00473000
$SCTREQ  EQU   $NEWSPRF+11                                              00474000
$RM      EQU   $NEWSPRF+9                                               00475000
$CTYPE   EQU   $NEWSPRF+8                                               00476000
$CCLASS  EQU   $NEWSPRF+7                                               00477000
$CFEAT   EQU   $NEWSPRF+6                                               00478000
$CMODEL  EQU   $NEWSPRF+5                                               00479000
$TYPE    EQU   $NEWSPRF+4                                               00480000
$CLASS   EQU   $NEWSPRF+3                                               00481000
$FEAT    EQU   $NEWSPRF+2                                               00482000
$MODEL   EQU   $NEWSPRF+1                                               00483000
$RTN#    EQU   $NEWSPRF                                                 00484000
#MSGID   EQU   @NM00027+16                                              00485000
LEVEL    EQU   @NM00027+8                                               00486000
SECTID   EQU   @NM00027                                                 00487000
$PLNKDEL EQU   PLINKMAP+11                                              00488000
$PLNKCOR EQU   PLINKMAP+9                                               00489000
$PLNKSC  EQU   @NM00024                                                 00490000
@NM00026 EQU   @NM00024                                                 00491000
$PLNKRT  EQU   @NM00024                                                 00492000
@NM00025 EQU   @NM00024                                                 00493000
$PLNKCL  EQU   @NM00024                                                 00494000
$PLNIDNT EQU   PLINKMAP+2                                               00495000
$PLNLEVL EQU   PLINKMAP+1                                               00496000
$PLNTRMG EQU   PLINKMAP                                                 00497000
SVECC010 EQU   TOLTEPWA+3952                                            00498000
SVETC035 EQU   TOLTEPWA+3880                                            00499000
SVESC030 EQU   TOLTEPWA+3808                                            00500000
SVESC020 EQU   TOLTEPWA+3664                                            00501000
SVEIC002 EQU   TOLTEPWA+3520                                            00502000
SVECC014 EQU   TOLTEPWA+3376                                            00503000
SVESC120 EQU   TOLTEPWA+3304                                            00504000
SVESC025 EQU   TOLTEPWA+3088                                            00505000
@NM00023 EQU   TOLTEPWA+2980                                            00506000
$RPLERR  EQU   TOLTEPWA+2977                                            00507000
@NM00022 EQU   TOLTEPWA+2976                                            00508000
$R13PR3  EQU   TOLTEPWA+2972                                            00509000
$CEINT2  EQU   TOLTEPWA+2968                                            00510000
$CEINT1  EQU   TOLTEPWA+2964                                            00511000
$MSGGET  EQU   TOLTEPWA+2960                                            00512000
$ACQLIST EQU   TOLTEPWA+2956                                            00513000
$R4SAVE1 EQU   TOLTEPWA+2952                                            00514000
$CLSISS  EQU   TOLTEPWA+2950                                            00515000
$CLSCNT  EQU   TOLTEPWA+2948                                            00516000
$CUTABLE EQU   TOLTEPWA+2868                                            00517000
$BUFSZ2  EQU   TOLTEPWA+2864                                            00518000
$RESID2  EQU   TOLTEPWA+2860                                            00519000
$OLTCCW2 EQU   TOLTEPWA+2856                                            00520000
$ENDBFR2 EQU   TOLTEPWA+2852                                            00521000
$1STBFR2 EQU   TOLTEPWA+2848                                            00522000
$TECB2   EQU   TOLTEPWA+2844                                            00523000
$BUFSZ1  EQU   TOLTEPWA+2840                                            00524000
$RESID1  EQU   TOLTEPWA+2836                                            00525000
$OLTCCW1 EQU   TOLTEPWA+2832                                            00526000
$ENDBFR1 EQU   TOLTEPWA+2828                                            00527000
$1STBFR1 EQU   TOLTEPWA+2824                                            00528000
$TECB1   EQU   TOLTEPWA+2820                                            00529000
$WAITIME EQU   TOLTEPWA+2816                                            00530000
$TRTN#   EQU   TOLTEPWA+2815                                            00531000
$WIODEV  EQU   TOLTEPWA+2814                                            00532000
$RQSTSZE EQU   TOLTEPWA+2812                                            00533000
$RQSTPTR EQU   TOLTEPWA+2808                                            00534000
$R4SAVE  EQU   TOLTEPWA+2804                                            00535000
$PARTADR EQU   TOLTEPWA+2800                                            00536000
$TBSDATA EQU   TOLTEPWA+2796                                            00537000
$CTWIDTH EQU   TOLTEPWA+2795                                            00538000
$CTLINE  EQU   TOLTEPWA+2794                                            00539000
$APWIDTH EQU   TOLTEPWA+2793                                            00540000
$APLINE  EQU   TOLTEPWA+2792                                            00541000
$INDEX   EQU   $IMITX                                                   00542000
$UMXX    EQU   @NM00021+14                                              00543000
$NSXX    EQU   @NM00021+12                                              00544000
$ATACNT  EQU   $NSCNT                                                   00545000
$CTR     EQU   @NM00021+8                                               00546000
$ATAPTR  EQU   $NSPTR                                                   00547000
$DDRPTR  EQU   @NM00021                                                 00548000
$DTORESP EQU   TOLTEPWA+2712                                            00549000
$APNAME  EQU   TOLTEPWA+2704                                            00550000
$24SYMNE EQU   $24CATMG+4                                               00551000
$24DEVAD EQU   $24CATMG                                                 00552000
$24RTN#  EQU   $24FEMSG+8                                               00553000
$ESECTID EQU   $24FEMSG                                                 00554000
$24FLGS  EQU   TOLTEPWA+2680                                            00555000
$24SAVE2 EQU   TOLTEPWA+2676                                            00556000
$24SAVE1 EQU   TOLTEPWA+2672                                            00557000
$24UNADR EQU   TOLTEPWA+2668                                            00558000
$24SAV13 EQU   TOLTEPWA+2664                                            00559000
$24RETCD EQU   TOLTEPWA+2663                                            00560000
$MACID   EQU   TOLTEPWA+2661                                            00561000
$CSPARE  EQU   $CFLGS                                                   00562000
$C2WAY   EQU   $CFLGS                                                   00563000
$CINCT   EQU   $CCOMDAT+12                                              00564000
$CINADR  EQU   $CCOMDAT+8                                               00565000
$COUTCT  EQU   $CCOMDAT+4                                               00566000
$COUTAD  EQU   $CCOMDAT                                                 00567000
ROOTLOC  EQU   TOLTEPWA+2640                                            00568000
$RETREG  EQU   TOLTEPWA+2636                                            00569000
$WORK    EQU   TOLTEPWA+2376                                            00570000
$EXTA    EQU   TOLTEPWA+2320                                            00571000
$PASSONA EQU   TOLTEPWA+2264                                            00572000
$TRMINPT EQU   TOLTEPWA+2184                                            00573000
$BUFFER  EQU   TOLTEPWA+1976                                            00574000
$TLTRPL3 EQU   TOLTEPWA+1856                                            00575000
$TLTRPL2 EQU   TOLTEPWA+1736                                            00576000
$TLTRPL1 EQU   TOLTEPWA+1616                                            00577000
$SLTBL   EQU   TOLTEPWA+1468                                            00578000
@NM00020 EQU   TOLTEPWA+1464                                            00579000
$DEVTBLE EQU   TOLTEPWA+240                                             00580000
@NM00019 EQU   $COMMFLG+15                                              00581000
@NM00018 EQU   $COMMFLG+14                                              00582000
@NM00017 EQU   $COMMFLG+13                                              00583000
@NM00016 EQU   $COMMFLG+12                                              00584000
@NM00015 EQU   $COMMFLG+11                                              00585000
@NM00014 EQU   $COMMFLG+10                                              00586000
@NM00013 EQU   $COMMFLG+9                                               00587000
@NM00012 EQU   $COMMFLG+8                                               00588000
$VS2     EQU   $FLAG8                                                   00589000
$VS1     EQU   $FLAG8                                                   00590000
$EDOS    EQU   $FLAG8                                                   00591000
@NM00011 EQU   $FLAG8                                                   00592000
$TWOWAY  EQU   $FLAG8                                                   00593000
@NM00010 EQU   $FLAG8                                                   00594000
@NM00009 EQU   $COMMFLG+6                                               00595000
$CIREQ   EQU   $FLAG6                                                   00596000
$ABTERM  EQU   $ABNDBIT                                                 00597000
$DISCREQ EQU   $FLAG6                                                   00598000
$DISCISS EQU   $FLAG6                                                   00599000
$CHANGE  EQU   $FLAG6                                                   00600000
$CTERROR EQU   $FLAG6                                                   00601000
$RECAL11 EQU   $FLAG6                                                   00602000
@NM00008 EQU   $COMMFLG+4                                               00603000
@NM00007 EQU   $COMMFLG+3                                               00604000
@NM00006 EQU   $COMMFLG+2                                               00605000
@NM00005 EQU   $COMMFLG+1                                               00606000
@NM00004 EQU   $COMMFLG                                                 00607000
@NM00003 EQU   $CDA+120                                                 00608000
$CUCNT   EQU   $CDA+118                                                 00609000
@NM00002 EQU   $CDA+117                                                 00610000
$PRTFORM EQU   $CDA+116                                                 00611000
$OPISCNT EQU   $CDA+114                                                 00612000
$OPNDCNT EQU   $CDA+112                                                 00613000
$GETMSZE EQU   $CDA+110                                                 00614000
$GRCNTS  EQU   $CDA+108                                                 00615000
$CTLCNT  EQU   $CDA+106                                                 00616000
$ACTLVL  EQU   $CDA+105                                                 00617000
$PRNTLVL EQU   $CDA+104                                                 00618000
$ERRCNTA EQU   $CDA+102                                                 00619000
$TLCNT   EQU   $CDA+100                                                 00620000
$TIMEALW EQU   $CDA+96                                                  00621000
$PTRAREA EQU   $CDA+92                                                  00622000
$GETMPTR EQU   $CDA+88                                                  00623000
$R13PTRT EQU   $CDA+84                                                  00624000
$R13PTR  EQU   $CDA+80                                                  00625000
$TEPEND  EQU   $CDA+76                                                  00626000
$PLINKDL EQU   $CDA+72                                                  00627000
$TEPBEGN EQU   $CDA+68                                                  00628000
$LOMOREC EQU   $CDA+56                                                  00629000
$ENDCOMM EQU   $CDA+48                                                  00630000
$COMMON  EQU   $RCA                                                     00631000
$SLASHAD EQU   $CDA+32                                                  00632000
$PASSON  EQU   $CDA+28                                                  00633000
$TOLBRTB EQU   $CDA+24                                                  00634000
$SCTPTR8 EQU   $CDA+20                                                  00635000
$SCTPTR  EQU   $CDA+16                                                  00636000
$TBWDPTR EQU   $CDA+12                                                  00637000
$TFWDPTR EQU   $CDA+8                                                   00638000
@NM00001 EQU   $CDA                                                     00639000
$SCTTBLE EQU   TOLTEPWA                                                 00640000
.@UNREFD ANOP                          END UNREFERENCED COMPONENTS      00641000
@RT00047 EQU   S2DC0090                                                 00642000
@RT00050 EQU   S2DC0090                                                 00643000
@RT00069 EQU   S2DC0050                                                 00644000
@RT00071 EQU   S2DC0040                                                 00645000
@RT00092 EQU   S2DC0045                                                 00646000
@RT00098 EQU   S2DC0040                                                 00647000
@ENDDATA EQU   *                                                        00648000
         END   ISTSC02D,(C'PLS1516',0702,78337)                         00649000
./  ADD  SSI=83370146,NAME=ISTSC02E
         TITLE 'ROUTINE SERVICE MODULE - ISTSC02E'                      00001000
* IBM DISK OPERATING SYSTEM                                             00002000
* TOLTEP - 5745-SC-TLT                                                  00003000
          ISEQ 73,80                                                    00004000
ISTSC02E CSECT ,                                                   0002 00005000
@MAINENT DS    0H                                                  0002 00006000
         USING *,@15                                               0002 00007000
         B     @PROLOG                                             0002 00008000
         DC    AL1(16)                                             0002 00009000
         DC    C'ISTSC02E  78.337'                                 0002 00010000
         DROP  @15                                                      00011000
@PROLOG  ST    @14,12(,@13)                                        0002 00012000
         STM   @00,@12,20(@13)                                     0002 00013000
         BALR  @12,0                                               0002 00014000
@PSTART  DS    0H                                                  0002 00015000
         USING @PSTART,@12                                         0002 00016000
*   R15=R13;                        /* SET BACKSAVE PTR              */ 00017000
         LR    R15,R13                                             0042 00018000
*   R13=ADDR(SVESC02E);             /* PICK UP PTR TO SAVE AREA      */ 00019000
         LA    R13,SVESC02E(,WAPTR)                                0043 00020000
*   BACKSAVE(3)=R13;                /* CHAIN BACKAREA & THIS AREA    */ 00021000
         ST    R13,BACKSAVE+8(,R15)                                0044 00022000
*   SVESC02E(2)=R15;                /* TOGETHER                      */ 00023000
         ST    R15,SVESC02E+4(,WAPTR)                              0045 00024000
*   RTNMAP=R1;                      /* SAVE PARM POINTER.            */ 00025000
         LR    RTNMAP,R1                                           0046 00026000
*   $RETMASK='00'X;                 /* RESET RETURN CODE MASK BYTE   */ 00027000
         MVI   $RETMASK(WAPTR),X'00'                               0047 00028000
*   $TRTN#=$RTNENUM;                /* ROUTINE NUMBER FOR TRACE      */ 00029000
         SLR   @09,@09                                             0048 00030000
         IC    @09,$RTNENUM(,RTNMAP)                               0048 00031000
         STC   @09,$TRTN#(,WAPTR)                                  0048 00032000
*   $TESTERR=OFF;                   /* RESET TEST ERROR BIT          */ 00033000
         NI    $TESTERR(WAPTR),B'01111111'                         0049 00034000
*   RTNSEL(1:8)=$RT0108;            /* FIRST BYTE OF ROUTINE FLAGS   */ 00035000
         MVC   RTNSEL(1,WAPTR),$RT0108(WAPTR)                      0050 00036000
*   RTNSEL(9:16)=$RT0916;           /* SECOND BYTE ROUTINE FLAGS     */ 00037000
         MVC   RTNSEL+1(1,WAPTR),$RT0916(WAPTR)                    0051 00038000
*   RTNSEL(17:256)=$ROUTMSK;        /* LAST 14 BYTES ROUTINE FLAGS   */ 00039000
         MVC   RTNSEL+2(30,WAPTR),$ROUTMSK(WAPTR)                  0052 00040000
*/********************************************************************/ 00041000
*/* CHECK THE SELECTED ROUTINE NUMBER IN THE ROUTINE PARAMETER LIST  */ 00042000
*/* AGAINST A SET OF FLAGS REPRESENTING THE ROUTINES SELECTED FOR    */ 00043000
*/* EXECUTION BY THE OPERATOR.                                       */ 00044000
*/********************************************************************/ 00045000
*                                                                  0053 00046000
*   X=$RTNENUM-1;                   /* DECREMENT ROUTINE SELECTION   */ 00047000
         BCTR  @09,0                                               0053 00048000
         LR    X,@09                                               0053 00049000
*   R7=X/8;                         /* FIND ROUTINE MASK BYTE        */ 00050000
         LR    R7,X                                                0054 00051000
         SRL   R7,3                                                0054 00052000
*   R6=X//8;                        /* SAVE THE REMAINDER            */ 00053000
         LR    @10,X                                               0055 00054000
         SRDA  @10,32                                              0055 00055000
         D     @10,@CF00039                                        0055 00056000
         LR    R6,@10                                              0055 00057000
*   R1=0;                           /* RESET R1 TO ZEROS             */ 00058000
         SLR   R1,R1                                               0056 00059000
*   GEN(IC R1,MASKLIST(R6));        /* SELECT PROPER BIT MASK        */ 00060000
         IC R1,MASKLIST(R6)                                             00061000
*   R7=R7+ADDR($INBUFR);            /* CALCULATE ADDRESS OF ROUTINE     00062000
*                                      FLAGS FOR THIS ROUTINE.       */ 00063000
         LA    @09,$INBUFR(,WAPTR)                                 0058 00064000
         ALR   R7,@09                                              0058 00065000
*   GEN(EX R1,TSTMSK);              /* TEST FOR SELECTED FLAG ON     */ 00066000
         EX R1,TSTMSK                                                   00067000
*   BC(8,S2EC0005);                 /* BRANCH IF NOT ON.             */ 00068000
         BC    8,S2EC0005                                          0060 00069000
*/********************************************************************/ 00070000
*/* CHECK FOR MANUAL INTERVENTION REQUIRED BY THIS ROUTINE.          */ 00071000
*/********************************************************************/ 00072000
*                                                                  0061 00073000
*   IF $RTNMI=ON                    /* CHECK FOR MI REQUIRED         */ 00074000
*       &$MANINTV=OFF               /* AND MANUAL INTERVENTION IS NOT   00075000
*                                      ALLOWED.                      */ 00076000
*     THEN                                                         0061 00077000
         TM    $RTNMI(RTNMAP),B'10000000'                          0061 00078000
         BNO   @RF00061                                            0061 00079000
         TM    $MANINTV(WAPTR),B'10000000'                         0061 00080000
         BNZ   @RF00061                                            0061 00081000
*     DO;                                                          0062 00082000
*                                                                  0062 00083000
*/* ******************************************************************/ 00084000
*/*  MANUAL INTERVETION IS REQUIRED BY THIS ROUTINE BUT IS NOT       */ 00085000
*/*  ALLOWED PER OPERATOR OPTIONS. RTN BYPASSED.                     */ 00086000
*/* ******************************************************************/ 00087000
*                                                                  0063 00088000
*       GEN(BAL R14,S2EC0050);      /* CALL MSG SUBROUTINE           */ 00089000
*                                                                  0063 00090000
         BAL R14,S2EC0050                                               00091000
*       /*************************************************************/ 00092000
*       /*                                                           */ 00093000
*       /* TCEC MSGN(210)SUB(YES) INVOKED                            */ 00094000
*       /*                                                           */ 00095000
*       /*************************************************************/ 00096000
*                                                                  0064 00097000
*       $TCECM='1'B;                /* SET TCEC SW IN RCA            */ 00098000
         OI    $TCECM(WAPTR),B'00000001'                           0064 00099000
*       R1=ADDR($TCA07);            /* SET UP PARM LIST $TR          */ 00100000
         LA    R1,$TCA07                                           0065 00101000
*       CALL #EXIT;                 /* CALL CECOM                    */ 00102000
         L     @15,#EXITA(,WAPTR)                                  0066 00103000
         BALR  @14,@15                                             0066 00104000
*       DCL                                                        0067 00105000
*         1 $TCA07,                 /* TCEC PARM LIST                */ 00106000
*          2 $TCB07 FIXED(32) INIT(210),/* MSG NUMBER                */ 00107000
*          2 $TCC07 FIXED(32) INIT(0),/* INCT LEN                    */ 00108000
*          2 $TCD07 BIT(8) INIT('10000000'B),/* FLAG                 */ 00109000
*          2 $TCE07 CHAR(4) INIT('FFFFFFFF'X);/* MSSAGE MASK         */ 00110000
*       GO TO S2EC0005;                                            0068 00111000
         B     S2EC0005                                            0068 00112000
*     END;                                                         0069 00113000
*   IF $CTEQTT=ON                   /* IF CT ON SME LINE AS TT       */ 00114000
*       &$DCL=ON THEN               /* AND ROUTINE MACRO EXPANSION 0070 00115000
*                                      INDICATES IT CANNOT BE RUN IN    00116000
*                                      THIS CASE BECAUSE OF POSSIBLE    00117000
*                                      HANG UPS WITH TWO WAY       0070 00118000
*                                      MESSAGES, THEN BYPASS THIS  0070 00119000
*                                      ROUTINE.                      */ 00120000
@RF00061 TM    $CTEQTT(WAPTR),B'00010000'                          0070 00121000
         BNO   @RF00070                                            0070 00122000
         TM    $DCL(RTNMAP),B'00100000'                            0070 00123000
         BNO   @RF00070                                            0070 00124000
*     DO;                                                          0071 00125000
*                                                                  0071 00126000
*/********************************************************************/ 00127000
*/* EITHER CT OR AP IS ON SAME LINE AS A TEST TERMINAL AND THIS      */ 00128000
*/* ROUTINE CANNOT BE EXECUTED UNDER THAT CONDITION.                 */ 00129000
*/****************************************************************** */ 00130000
*                                                                  0072 00131000
*       GEN(BAL R14,S2EC0050);      /* CALL MSG SUBROUTINE           */ 00132000
*                                                                  0072 00133000
         BAL R14,S2EC0050                                               00134000
*       /*************************************************************/ 00135000
*       /*                                                           */ 00136000
*       /* TCEC MSGN(210)SUB(YES)MSGMSK('40000000'X) INVOKED         */ 00137000
*       /*                                                           */ 00138000
*       /*************************************************************/ 00139000
*                                                                  0073 00140000
*       $TCECM='1'B;                /* SET TCEC SW IN RCA            */ 00141000
         OI    $TCECM(WAPTR),B'00000001'                           0073 00142000
*       R1=ADDR($TCA08);            /* SET UP PARM LIST $TR          */ 00143000
         LA    R1,$TCA08                                           0074 00144000
*       CALL S20CEC03;              /* CALL TCEC-MULTIPLE LN         */ 00145000
         L     @15,@CV00644                                        0075 00146000
         BALR  @14,@15                                             0075 00147000
*       DCL                                                        0076 00148000
*         1 $TCA08,                 /* TCEC PARM LIST                */ 00149000
*          2 $TCB08 FIXED(32) INIT(210),/* MSG NUMBER                */ 00150000
*          2 $TCC08 FIXED(32) INIT(0),/* INCT LEN                    */ 00151000
*          2 $TCD08 BIT(8) INIT('10000000'B),/* FLAG                 */ 00152000
*          2 $TCE08 CHAR(4) INIT('40000000'X);/* MSSAGE MASK         */ 00153000
*       GO TO S2EC0005;                                            0077 00154000
         B     S2EC0005                                            0077 00155000
*     END;                                                         0078 00156000
*   ELSE                                                           0079 00157000
*     GO TO S2EC0020;                                              0079 00158000
*S2EC0005:                                                         0080 00159000
*   RET14=$RTNEEXT;                 /* SET RETURN REGISTER IN OLTS 0080 00160000
*                                      SAVE AREA TO POINT TO NEXT  0080 00161000
*                                      ROUTINE.                      */ 00162000
S2EC0005 L     @09,$R13PTR(,WAPTR)                                 0080 00163000
         L     @04,$RTNEEXT(,RTNMAP)                               0080 00164000
         ST    @04,RET14(,@09)                                     0080 00165000
*   R15=4;                                                         0081 00166000
         LA    R15,4                                               0081 00167000
*   GOTO S2EC0015;                                                 0082 00168000
         B     S2EC0015                                            0082 00169000
*S2EC0010:                                                         0083 00170000
*   R15=0;                          /* ZERO RETURN CODE              */ 00171000
S2EC0010 SLR   R15,R15                                             0083 00172000
*S2EC0015:                                                         0084 00173000
*   RET15=R15;                      /* RESET RETURN CODE REGISTER IN    00174000
*                                      OLTS SAVE AREA.               */ 00175000
S2EC0015 L     @09,$R13PTR(,WAPTR)                                 0084 00176000
         ST    R15,RET15(,@09)                                     0084 00177000
*   R13=SVESC02E(2);                /* RESTORE R13 TO ORIG VALUE     */ 00178000
         L     R13,SVESC02E+4(,WAPTR)                              0085 00179000
*   RETURN;                         /* RETURN VIA SAVE AREA MGR.     */ 00180000
@EL00001 DS    0H                                                  0086 00181000
@EF00001 DS    0H                                                  0086 00182000
@ER00001 L     @14,12(,@13)                                        0086 00183000
         LM    @00,@12,20(@13)                                     0086 00184000
         BR    @14                                                 0086 00185000
*S2EC0020:                                                         0087 00186000
*   $RTN#=$RTNENUM;                 /* MOVE RTN# INTO SECTION PREF   */ 00187000
S2EC0020 L     @09,$LOWADDR(,WAPTR)                                0087 00188000
         LH    @04,RTNDISP(,@09)                                   0087 00189000
         ALR   @04,@09                                             0087 00190000
         IC    @09,$RTNENUM(,RTNMAP)                               0087 00191000
         STC   @09,$RTN#(,@04)                                     0087 00192000
*   $REFNUM=$RTNEREF;               /* SET UP REF NUMB               */ 00193000
         MVC   $REFNUM(1,@04),$RTNEREF(RTNMAP)                     0088 00194000
*   GO TO S2EC0010;                 /* RETURN.                       */ 00195000
         B     S2EC0010                                            0089 00196000
*/********************************************************************/ 00197000
*/* THE FOLLOWING INSTRUCTION IS THE TARGET OF AN EX (EXECUTE) INSTR.*/ 00198000
*/********************************************************************/ 00199000
*                                                                  0090 00200000
*TSTMSK:                                                           0090 00201000
*   GEN(TM 0(R7),0);                                               0090 00202000
*                                                                  0090 00203000
TSTMSK   TM 0(R7),0                                                     00204000
*/****************************************************************** */ 00205000
*/* THE FOLLOWING SUBROUTINE CONVERTS ROUTINE NUMBER TO EBCDIC       */ 00206000
*/****************************************************************** */ 00207000
*                                                                  0091 00208000
*S2EC0050:                                                         0091 00209000
*   R1=$RTNENUM;                    /* ROUTINE NUMBER IN HEX         */ 00210000
S2EC0050 SLR   R1,R1                                               0091 00211000
         IC    R1,$RTNENUM(,RTNMAP)                                0091 00212000
*   CVD(R1,$INBUFR(70:77));         /* ROUTINE NUMBER IN PACKED    0092 00213000
*                                      DECIMAL.                      */ 00214000
         CVD   R1,$INBUFR+69(,WAPTR)                               0092 00215000
*   UNPK($INBUFR(1:4),$INBUFR(75:77));/* UNPACK                      */ 00216000
         UNPK  $INBUFR(4,WAPTR),$INBUFR+74(3,WAPTR)                0093 00217000
*   MVZ($INBUFR(4:4),$INBUFR(3:3)); /* ZONE TO SIGN.                 */ 00218000
         MVZ   $INBUFR+3(1,WAPTR),$INBUFR+2(WAPTR)                 0094 00219000
*   GEN(BR R14);                    /* RETURN                        */ 00220000
         BR R14                                                         00221000
*   DO;                             /* ATDSPLY                       */ 00222000
*   END;                            /* ATDSPLY                       */ 00223000
*   END ISTSC02E;                                                  0098 00224000
         B     @EL00001                                            0098 00225000
@DATA    DS    0H                                                       00226000
         DS    0F                                                       00227000
         DS    0F                                                       00228000
@CF00039 DC    F'8'                                                     00229000
@CV00644 DC    V(S20CEC03)                                              00230000
         DS    0D                                                       00231000
MASKLIST DC    X'8040201008040201'                                      00232000
$TCA07   DS    CL13                                                     00233000
         ORG   $TCA07                                                   00234000
$TCB07   DC    A(210)                                                   00235000
$TCC07   DC    A(0)                                                     00236000
$TCD07   DC    B'10000000'                                              00237000
$TCE07   DC    X'FFFFFFFF'                                              00238000
         ORG   $TCA07+13                                                00239000
         DS    CL3                                                      00240000
$TCA08   DS    CL13                                                     00241000
         ORG   $TCA08                                                   00242000
$TCB08   DC    A(210)                                                   00243000
$TCC08   DC    A(0)                                                     00244000
$TCD08   DC    B'10000000'                                              00245000
$TCE08   DC    X'40000000'                                              00246000
         ORG   $TCA08+13                                                00247000
         DS    CL3                                                      00248000
PATCH    DC    8F'0'                                                    00249000
@00      EQU   00                      EQUATES FOR REGISTERS 0-15       00250000
@01      EQU   01                                                       00251000
@02      EQU   02                                                       00252000
@03      EQU   03                                                       00253000
@04      EQU   04                                                       00254000
@05      EQU   05                                                       00255000
@06      EQU   06                                                       00256000
@07      EQU   07                                                       00257000
@08      EQU   08                                                       00258000
@09      EQU   09                                                       00259000
@10      EQU   10                                                       00260000
@11      EQU   11                                                       00261000
@12      EQU   12                                                       00262000
@13      EQU   13                                                       00263000
@14      EQU   14                                                       00264000
@15      EQU   15                                                       00265000
WAPTR    EQU   @02                                                      00266000
RTNMAP   EQU   @05                                                      00267000
R15      EQU   @15                                                      00268000
R1       EQU   @01                                                      00269000
R2       EQU   @02                                                      00270000
R6       EQU   @06                                                      00271000
R7       EQU   @07                                                      00272000
X        EQU   @08                                                      00273000
R13      EQU   @13                                                      00274000
R14      EQU   @14                                                      00275000
R10      EQU   @10                                                      00276000
TOLTEPWA EQU   0                                                        00277000
$SCTTBLE EQU   TOLTEPWA                                                 00278000
$TESTOPT EQU   $SCTTBLE+2                                               00279000
$ERROPT  EQU   $SCTTBLE+3                                               00280000
$TESTERR EQU   $ERROPT                                                  00281000
$RT0108  EQU   $SCTTBLE+4                                               00282000
$RT0916  EQU   $SCTTBLE+5                                               00283000
$PDEVFLG EQU   $SCTTBLE+10                                              00284000
$CDSFLGS EQU   $SCTTBLE+11                                              00285000
$CDS8T19 EQU   $SCTTBLE+20                                              00286000
$EXECFLG EQU   $SCTTBLE+33                                              00287000
$OLTFLGS EQU   $SCTTBLE+36                                              00288000
$MANINTV EQU   $OLTFLGS                                                 00289000
$OLTFLG2 EQU   $SCTTBLE+37                                              00290000
$TOTFLG1 EQU   $SCTTBLE+38                                              00291000
$CTEQTT  EQU   $TOTFLG1                                                 00292000
$ROUTMSK EQU   $SCTTBLE+40                                              00293000
$RETMASK EQU   $SCTTBLE+70                                              00294000
$CDA     EQU   TOLTEPWA+100                                             00295000
$RCA     EQU   $CDA+44                                                  00296000
$OLTPTR  EQU   $CDA+52                                                  00297000
$LOWADDR EQU   $OLTPTR                                                  00298000
$HIMOREC EQU   $CDA+60                                                  00299000
$R13PTR  EQU   $CDA+80                                                  00300000
$COMMFLG EQU   TOLTEPWA+224                                             00301000
$FLAG1   EQU   $COMMFLG                                                 00302000
$FLAG2   EQU   $COMMFLG+1                                               00303000
$FLAG3   EQU   $COMMFLG+2                                               00304000
$FLAG4   EQU   $COMMFLG+3                                               00305000
$FLAG5   EQU   $COMMFLG+4                                               00306000
$EOJ     EQU   $FLAG5                                                   00307000
$CANCEL  EQU   $EOJ                                                     00308000
$FLAG6   EQU   $COMMFLG+5                                               00309000
$ABNDBIT EQU   $FLAG6                                                   00310000
$FLAG7   EQU   $COMMFLG+6                                               00311000
$FLAG8   EQU   $COMMFLG+7                                               00312000
$TCECM   EQU   $FLAG8                                                   00313000
$FLAG9   EQU   $COMMFLG+8                                               00314000
$FLAG10  EQU   $COMMFLG+9                                               00315000
$FLAG11  EQU   $COMMFLG+10                                              00316000
$FLAG12  EQU   $COMMFLG+11                                              00317000
$FLAG13  EQU   $COMMFLG+12                                              00318000
$DEVTBLE EQU   TOLTEPWA+240                                             00319000
$DEVCDS  EQU   $DEVTBLE                                                 00320000
$DEVUNAD EQU   $DEVCDS                                                  00321000
@NM00035 EQU   $DEVUNAD+2                                               00322000
$DEVFEAT EQU   $DEVCDS+4                                                00323000
$DEVCDSF EQU   $DEVCDS+9                                                00324000
$DEVSDCF EQU   $DEVCDS+10                                               00325000
$$SYMNME EQU   $DEVCDS+12                                               00326000
$DEVFLG1 EQU   $DEVTBLE+20                                              00327000
$EVNCPLT EQU   $DEVFLG1                                                 00328000
$ATTNEXP EQU   $DEVFLG1                                                 00329000
$INTOCC  EQU   $DEVFLG1                                                 00330000
$DEVFLG2 EQU   $DEVTBLE+21                                              00331000
$DEVTECB EQU   $DEVTBLE+22                                              00332000
$OPIS    EQU   $DEVTECB                                                 00333000
$OPND    EQU   $DEVTECB+2                                               00334000
$DEVFLG3 EQU   $DEVTBLE+27                                              00335000
$SIOFLG  EQU   $DEVFLG3                                                 00336000
$IFTOUT  EQU   $DEVTBLE+36                                              00337000
$DEVSESP EQU   $IFTOUT                                                  00338000
$SSCPDAF EQU   $IFTOUT+6                                                00339000
$LDNCBPT EQU   $DEVTBLE+48                                              00340000
$RNINFO  EQU   $DEVTBLE+56                                              00341000
$DEVFLG5 EQU   $RNINFO+8                                                00342000
$DEVFLG4 EQU   $DEVTBLE+65                                              00343000
$INBUFR  EQU   TOLTEPWA+2104                                            00344000
#EXITA   EQU   TOLTEPWA+2632                                            00345000
$CCOMDAT EQU   TOLTEPWA+2644                                            00346000
$CFLGS   EQU   $CCOMDAT+16                                              00347000
$24FEMSG EQU   TOLTEPWA+2681                                            00348000
$24CATMG EQU   $24FEMSG+11                                              00349000
@NM00043 EQU   TOLTEPWA+2776                                            00350000
$OUNTPTR EQU   @NM00043+4                                               00351000
$NSPTR   EQU   $OUNTPTR                                                 00352000
$NSCNT   EQU   @NM00043+10                                              00353000
$ENXX    EQU   @NM00043+15                                              00354000
$IMITX   EQU   $ENXX                                                    00355000
$TRTN#   EQU   TOLTEPWA+2815                                            00356000
SVESC033 EQU   TOLTEPWA+3160                                            00357000
SVECC013 EQU   TOLTEPWA+3232                                            00358000
SVEIC003 EQU   TOLTEPWA+3592                                            00359000
SVESC022 EQU   TOLTEPWA+3736                                            00360000
SVECC011 EQU   TOLTEPWA+4024                                            00361000
#EXIT    EQU   0                                                        00362000
RTNEMAP  EQU   0                                                        00363000
$RTNEEXT EQU   RTNEMAP+4                                                00364000
$RTNENUM EQU   RTNEMAP+8                                                00365000
$RTNEREF EQU   RTNEMAP+9                                                00366000
$RTNEFLG EQU   RTNEMAP+10                                               00367000
$RTNMI   EQU   $RTNEFLG                                                 00368000
$DCL     EQU   $RTNEFLG                                                 00369000
@NM00047 EQU   0                                                        00370000
RTNDISP  EQU   @NM00047+10                                              00371000
INST     EQU   @NM00047+12                                              00372000
$NEWSPRF EQU   0                                                        00373000
$RTN#    EQU   $NEWSPRF                                                 00374000
#FLAGS   EQU   $NEWSPRF+16                                              00375000
$REFNUM  EQU   $NEWSPRF+17                                              00376000
BACKSAVE EQU   0                                                        00377000
SAVEMAP  EQU   0                                                        00378000
RET14    EQU   SAVEMAP+12                                               00379000
RET15    EQU   SAVEMAP+16                                               00380000
OLTENTRY EQU   0                                                        00381000
SVESC02E EQU   SVESC022                                                 00382000
RTNSEL   EQU   $INBUFR                                                  00383000
SVECC012 EQU   SVESC022                                                 00384000
SVEIC00A EQU   SVEIC003                                                 00385000
SVEIC004 EQU   SVEIC003                                                 00386000
SVEIC005 EQU   SVEIC003                                                 00387000
SVESC02A EQU   SVESC022                                                 00388000
SVESC02B EQU   SVESC022                                                 00389000
SVESC02D EQU   SVESC022                                                 00390000
SVESC02F EQU   SVECC013                                                 00391000
SVESC024 EQU   SVESC022                                                 00392000
SVESC027 EQU   SVESC022                                                 00393000
SVESC029 EQU   SVESC033                                                 00394000
SVESC031 EQU   SVECC013                                                 00395000
SVESC032 EQU   SVECC011                                                 00396000
SVETC037 EQU   SVEIC003                                                 00397000
         AGO   .@UNREFD                START UNREFERENCED COMPONENTS    00398000
FILL     EQU   SAVEMAP                                                  00399000
$RME     EQU   $NEWSPRF+36                                              00400000
@NM00050 EQU   $NEWSPRF+35                                              00401000
$ECA     EQU   $NEWSPRF+32                                              00402000
$DCHB    EQU   $NEWSPRF+28                                              00403000
$MOSIZE  EQU   $NEWSPRF+24                                              00404000
$RTSIZE  EQU   $NEWSPRF+20                                              00405000
$COUNT   EQU   $NEWSPRF+18                                              00406000
@NM00049 EQU   #FLAGS                                                   00407000
#MSGIDRQ EQU   #FLAGS                                                   00408000
#PLKMCOR EQU   #FLAGS                                                   00409000
@NM00048 EQU   #FLAGS                                                   00410000
$VIRTUAL EQU   #FLAGS                                                   00411000
$PLINK$  EQU   $NEWSPRF+12                                              00412000
$SCTREQ  EQU   $NEWSPRF+11                                              00413000
$RM      EQU   $NEWSPRF+9                                               00414000
$CTYPE   EQU   $NEWSPRF+8                                               00415000
$CCLASS  EQU   $NEWSPRF+7                                               00416000
$CFEAT   EQU   $NEWSPRF+6                                               00417000
$CMODEL  EQU   $NEWSPRF+5                                               00418000
$TYPE    EQU   $NEWSPRF+4                                               00419000
$CLASS   EQU   $NEWSPRF+3                                               00420000
$FEAT    EQU   $NEWSPRF+2                                               00421000
$MODEL   EQU   $NEWSPRF+1                                               00422000
#MSGID   EQU   @NM00047+16                                              00423000
LEVEL    EQU   @NM00047+8                                               00424000
SECTID   EQU   @NM00047                                                 00425000
@NM00046 EQU   $RTNEFLG                                                 00426000
$TRMYES  EQU   $RTNEFLG                                                 00427000
$RTNIDNT EQU   RTNEMAP+2                                                00428000
$RTNLEVL EQU   RTNEMAP+1                                                00429000
$RTNTRMG EQU   RTNEMAP                                                  00430000
SVECC010 EQU   TOLTEPWA+3952                                            00431000
SVETC035 EQU   TOLTEPWA+3880                                            00432000
SVESC030 EQU   TOLTEPWA+3808                                            00433000
SVESC020 EQU   TOLTEPWA+3664                                            00434000
SVEIC002 EQU   TOLTEPWA+3520                                            00435000
SVECC014 EQU   TOLTEPWA+3376                                            00436000
SVESC120 EQU   TOLTEPWA+3304                                            00437000
SVESC025 EQU   TOLTEPWA+3088                                            00438000
@NM00045 EQU   TOLTEPWA+2980                                            00439000
$RPLERR  EQU   TOLTEPWA+2977                                            00440000
@NM00044 EQU   TOLTEPWA+2976                                            00441000
$R13PR3  EQU   TOLTEPWA+2972                                            00442000
$CEINT2  EQU   TOLTEPWA+2968                                            00443000
$CEINT1  EQU   TOLTEPWA+2964                                            00444000
$MSGGET  EQU   TOLTEPWA+2960                                            00445000
$ACQLIST EQU   TOLTEPWA+2956                                            00446000
$R4SAVE1 EQU   TOLTEPWA+2952                                            00447000
$CLSISS  EQU   TOLTEPWA+2950                                            00448000
$CLSCNT  EQU   TOLTEPWA+2948                                            00449000
$CUTABLE EQU   TOLTEPWA+2868                                            00450000
$BUFSZ2  EQU   TOLTEPWA+2864                                            00451000
$RESID2  EQU   TOLTEPWA+2860                                            00452000
$OLTCCW2 EQU   TOLTEPWA+2856                                            00453000
$ENDBFR2 EQU   TOLTEPWA+2852                                            00454000
$1STBFR2 EQU   TOLTEPWA+2848                                            00455000
$TECB2   EQU   TOLTEPWA+2844                                            00456000
$BUFSZ1  EQU   TOLTEPWA+2840                                            00457000
$RESID1  EQU   TOLTEPWA+2836                                            00458000
$OLTCCW1 EQU   TOLTEPWA+2832                                            00459000
$ENDBFR1 EQU   TOLTEPWA+2828                                            00460000
$1STBFR1 EQU   TOLTEPWA+2824                                            00461000
$TECB1   EQU   TOLTEPWA+2820                                            00462000
$WAITIME EQU   TOLTEPWA+2816                                            00463000
$WIODEV  EQU   TOLTEPWA+2814                                            00464000
$RQSTSZE EQU   TOLTEPWA+2812                                            00465000
$RQSTPTR EQU   TOLTEPWA+2808                                            00466000
$R4SAVE  EQU   TOLTEPWA+2804                                            00467000
$PARTADR EQU   TOLTEPWA+2800                                            00468000
$TBSDATA EQU   TOLTEPWA+2796                                            00469000
$CTWIDTH EQU   TOLTEPWA+2795                                            00470000
$CTLINE  EQU   TOLTEPWA+2794                                            00471000
$APWIDTH EQU   TOLTEPWA+2793                                            00472000
$APLINE  EQU   TOLTEPWA+2792                                            00473000
$INDEX   EQU   $IMITX                                                   00474000
$UMXX    EQU   @NM00043+14                                              00475000
$NSXX    EQU   @NM00043+12                                              00476000
$ATACNT  EQU   $NSCNT                                                   00477000
$CTR     EQU   @NM00043+8                                               00478000
$ATAPTR  EQU   $NSPTR                                                   00479000
$DDRPTR  EQU   @NM00043                                                 00480000
$DTORESP EQU   TOLTEPWA+2712                                            00481000
$APNAME  EQU   TOLTEPWA+2704                                            00482000
$24SYMNE EQU   $24CATMG+4                                               00483000
$24DEVAD EQU   $24CATMG                                                 00484000
$24RTN#  EQU   $24FEMSG+8                                               00485000
$ESECTID EQU   $24FEMSG                                                 00486000
$24FLGS  EQU   TOLTEPWA+2680                                            00487000
$24SAVE2 EQU   TOLTEPWA+2676                                            00488000
$24SAVE1 EQU   TOLTEPWA+2672                                            00489000
$24UNADR EQU   TOLTEPWA+2668                                            00490000
$24SAV13 EQU   TOLTEPWA+2664                                            00491000
$24RETCD EQU   TOLTEPWA+2663                                            00492000
$MACID   EQU   TOLTEPWA+2661                                            00493000
$CSPARE  EQU   $CFLGS                                                   00494000
$C2WAY   EQU   $CFLGS                                                   00495000
$CINCT   EQU   $CCOMDAT+12                                              00496000
$CINADR  EQU   $CCOMDAT+8                                               00497000
$COUTCT  EQU   $CCOMDAT+4                                               00498000
$COUTAD  EQU   $CCOMDAT                                                 00499000
ROOTLOC  EQU   TOLTEPWA+2640                                            00500000
$RETREG  EQU   TOLTEPWA+2636                                            00501000
$WORK    EQU   TOLTEPWA+2376                                            00502000
$EXTA    EQU   TOLTEPWA+2320                                            00503000
$PASSONA EQU   TOLTEPWA+2264                                            00504000
$TRMINPT EQU   TOLTEPWA+2184                                            00505000
$BUFFER  EQU   TOLTEPWA+1976                                            00506000
$TLTRPL3 EQU   TOLTEPWA+1856                                            00507000
$TLTRPL2 EQU   TOLTEPWA+1736                                            00508000
$TLTRPL1 EQU   TOLTEPWA+1616                                            00509000
$SLTBL   EQU   TOLTEPWA+1468                                            00510000
$CDEVPT  EQU   TOLTEPWA+1466                                            00511000
$DEVCNTS EQU   TOLTEPWA+1464                                            00512000
$FEEDBCK EQU   $DEVTBLE+66                                              00513000
$WTISUED EQU   $DEVFLG4                                                 00514000
$EXIOISD EQU   $DEVFLG4                                                 00515000
$REMWRIT EQU   $DEVFLG4                                                 00516000
$REMDONE EQU   $DEVFLG4                                                 00517000
$2NDUSED EQU   $DEVFLG4                                                 00518000
$1STUSED EQU   $DEVFLG4                                                 00519000
$IGLXIFB EQU   $DEVFLG4                                                 00520000
$EXIOLV3 EQU   $DEVFLG4                                                 00521000
@NM00042 EQU   $DEVFLG5                                                 00522000
$DVBASIC EQU   $DEVFLG5                                                 00523000
$ASCII   EQU   $DEVFLG5                                                 00524000
$DEVLU   EQU   $DEVFLG5                                                 00525000
$OPNDFAL EQU   $DEVFLG5                                                 00526000
$ACQNCB  EQU   $DEVFLG5                                                 00527000
$REMOTE  EQU   $DEVFLG5                                                 00528000
$ENDNODE EQU   $DEVFLG5                                                 00529000
$LINENME EQU   $RNINFO                                                  00530000
$CID     EQU   $DEVTBLE+52                                              00531000
$DVCOL   EQU   $LDNCBPT+2                                               00532000
$DVROW   EQU   $LDNCBPT                                                 00533000
$NCSPLP  EQU   $DEVTBLE+44                                              00534000
$DVLN    EQU   $SSCPDAF                                                 00535000
$DAF     EQU   $DEVSESP+4                                               00536000
$VARYPAB EQU   $DEVSESP                                                 00537000
$SYSMN   EQU   $DEVTBLE+28                                              00538000
@NM00041 EQU   $DEVFLG3                                                 00539000
$CLRSNT  EQU   $DEVFLG3                                                 00540000
$OLTERR  EQU   $DEVFLG3                                                 00541000
$SRTEST  EQU   $DEVFLG3                                                 00542000
$DVSNDOK EQU   $SIOFLG                                                  00543000
$POLLREQ EQU   $DEVFLG3                                                 00544000
$ACQRED  EQU   $DEVFLG3                                                 00545000
$NOTDEV  EQU   $DEVFLG3                                                 00546000
$DVINCT  EQU   $DEVTBLE+26                                              00547000
$DVBRKST EQU   $OPND+1                                                  00548000
$DVBRKSN EQU   $OPND                                                    00549000
$DVSEQNO EQU   $OPIS                                                    00550000
$CEINTRP EQU   $DEVFLG2                                                 00551000
$TESTMDE EQU   $DEVFLG2                                                 00552000
$DEVALOC EQU   $DEVFLG2                                                 00553000
$ALLDATA EQU   $DEVFLG2                                                 00554000
$ENDCNTL EQU   $DEVFLG2                                                 00555000
$CTLDEV  EQU   $DEVFLG2                                                 00556000
$NOCDS   EQU   $DEVFLG2                                                 00557000
$DATAIN  EQU   $DEVFLG2                                                 00558000
$PRIMARY EQU   $DEVFLG1                                                 00559000
$DVCTBYT EQU   $INTOCC                                                  00560000
$DEVACT  EQU   $DEVFLG1                                                 00561000
$DVLGMDE EQU   $ATTNEXP                                                 00562000
$DVSPRM  EQU   $EVNCPLT                                                 00563000
$GRABBED EQU   $DEVFLG1                                                 00564000
$CATASTR EQU   $DEVFLG1                                                 00565000
$LETGO   EQU   $DEVFLG1                                                 00566000
$CURELEM EQU   $$SYMNME+4                                               00567000
$MSGOTSD EQU   $$SYMNME                                                 00568000
$EXTDEV  EQU   $DEVCDS+11                                               00569000
@NM00040 EQU   $DEVSDCF                                                 00570000
$NOTPRIM EQU   $DEVSDCF                                                 00571000
@NM00039 EQU   $DEVCDSF                                                 00572000
@NM00038 EQU   $DEVCDSF                                                 00573000
@NM00037 EQU   $DEVCDSF                                                 00574000
$CDSNAME EQU   $DEVCDSF                                                 00575000
$EXTRN   EQU   $DEVCDSF                                                 00576000
$CEVOLUM EQU   $DEVCDSF                                                 00577000
$SHARD   EQU   $DEVCDSF                                                 00578000
$DEVFPM  EQU   $DEVCDSF                                                 00579000
$DEVCNT  EQU   $DEVCDS+8                                                00580000
$DEVTYPE EQU   $DEVFEAT+3                                               00581000
$DEVCLAS EQU   $DEVFEAT+2                                               00582000
$DEVFRRS EQU   $DEVFEAT+1                                               00583000
$DEVMOD  EQU   $DEVFEAT                                                 00584000
$DEVRDGT EQU   @NM00035+1                                               00585000
$DEVCTLU EQU   @NM00035+1                                               00586000
$DEVCHAN EQU   @NM00035                                                 00587000
@NM00036 EQU   @NM00035                                                 00588000
$CTINDX  EQU   $DEVUNAD                                                 00589000
$FLAG16  EQU   $COMMFLG+15                                              00590000
$FLAG15  EQU   $COMMFLG+14                                              00591000
$FLAG14  EQU   $COMMFLG+13                                              00592000
$TEP2ND  EQU   $FLAG13                                                  00593000
$TEP1ST  EQU   $FLAG13                                                  00594000
$CATMSG  EQU   $FLAG13                                                  00595000
$PRMPTSW EQU   $FLAG13                                                  00596000
$DEVENT  EQU   $FLAG13                                                  00597000
$OLTMACC EQU   $FLAG13                                                  00598000
$LGON    EQU   $FLAG13                                                  00599000
$CTLOGON EQU   $FLAG13                                                  00600000
@NM00034 EQU   $FLAG12                                                  00601000
$VARYINP EQU   $FLAG12                                                  00602000
$ENDTEST EQU   $FLAG12                                                  00603000
$VRYHRD  EQU   $FLAG12                                                  00604000
$VRYSFT  EQU   $FLAG12                                                  00605000
$POSTFLG EQU   $FLAG12                                                  00606000
$OPTMSG  EQU   $FLAG12                                                  00607000
$FEORCAT EQU   $FLAG11                                                  00608000
@NM00033 EQU   $FLAG11                                                  00609000
@NM00032 EQU   $FLAG10                                                  00610000
$INBND   EQU   $FLAG10                                                  00611000
$WAITFLG EQU   $FLAG10                                                  00612000
$DPRINT  EQU   $FLAG10                                                  00613000
$HOLD    EQU   $FLAG9                                                   00614000
$NOTRRCH EQU   $FLAG9                                                   00615000
@NM00031 EQU   $FLAG9                                                   00616000
$COPY    EQU   $FLAG9                                                   00617000
$LSTLNSW EQU   $FLAG9                                                   00618000
$MULLNSW EQU   $FLAG9                                                   00619000
$REMSW   EQU   $FLAG9                                                   00620000
$IGRES   EQU   $FLAG9                                                   00621000
$VS2     EQU   $FLAG8                                                   00622000
$VS1     EQU   $FLAG8                                                   00623000
$EDOS    EQU   $FLAG8                                                   00624000
@NM00030 EQU   $FLAG8                                                   00625000
$TWOWAY  EQU   $FLAG8                                                   00626000
@NM00029 EQU   $FLAG8                                                   00627000
$RCVMSG  EQU   $FLAG7                                                   00628000
$RCVRFLG EQU   $FLAG7                                                   00629000
$SNDRFLG EQU   $FLAG7                                                   00630000
$LDOIS   EQU   $FLAG7                                                   00631000
$DCONTCT EQU   $FLAG7                                                   00632000
$EXIOWAT EQU   $FLAG7                                                   00633000
$2NDDATA EQU   $FLAG7                                                   00634000
$1STDATA EQU   $FLAG7                                                   00635000
$CIREQ   EQU   $FLAG6                                                   00636000
$ABTERM  EQU   $ABNDBIT                                                 00637000
$FSTMCIS EQU   $FLAG6                                                   00638000
$DISCREQ EQU   $FLAG6                                                   00639000
$DISCISS EQU   $FLAG6                                                   00640000
$CHANGE  EQU   $FLAG6                                                   00641000
$CTERROR EQU   $FLAG6                                                   00642000
$RECAL11 EQU   $FLAG6                                                   00643000
@NM00028 EQU   $FLAG5                                                   00644000
$PROGCK  EQU   $CANCEL                                                  00645000
$PRINTAP EQU   $FLAG5                                                   00646000
@NM00027 EQU   $FLAG5                                                   00647000
$MSG922  EQU   $FLAG5                                                   00648000
$CT924   EQU   $FLAG5                                                   00649000
$FSTCAT  EQU   $FLAG5                                                   00650000
$FSTFE   EQU   $FLAG5                                                   00651000
$ACTOPND EQU   $FLAG4                                                   00652000
$ACQCUTT EQU   $FLAG4                                                   00653000
$CLSSACT EQU   $FLAG4                                                   00654000
$BACKINT EQU   $FLAG4                                                   00655000
$DMSGSW  EQU   $FLAG4                                                   00656000
$TSTDEVP EQU   $FLAG4                                                   00657000
$APRQPER EQU   $FLAG4                                                   00658000
$OPCOM   EQU   $FLAG4                                                   00659000
$NEWAP   EQU   $FLAG3                                                   00660000
$ALTPRTR EQU   $FLAG3                                                   00661000
$OPTERR  EQU   $FLAG3                                                   00662000
$PRTONLY EQU   $FLAG3                                                   00663000
$REQSTOR EQU   $FLAG3                                                   00664000
$LOGOFFE EQU   $FLAG3                                                   00665000
$TSTERR  EQU   $FLAG3                                                   00666000
$DEVERR  EQU   $FLAG3                                                   00667000
$PARTIAL EQU   $FLAG2                                                   00668000
$NRMTERM EQU   $FLAG2                                                   00669000
$VALDTST EQU   $FLAG2                                                   00670000
$VALDDEV EQU   $FLAG2                                                   00671000
$DBLSLSH EQU   $FLAG2                                                   00672000
$NDR     EQU   $FLAG2                                                   00673000
@NM00026 EQU   $FLAG2                                                   00674000
$OLTACT  EQU   $FLAG1                                                   00675000
$NORELDV EQU   $FLAG1                                                   00676000
@NM00025 EQU   $FLAG1                                                   00677000
$OPTCHNG EQU   $FLAG1                                                   00678000
$DEVCHNG EQU   $FLAG1                                                   00679000
$TESTCNG EQU   $FLAG1                                                   00680000
$CNSLFG  EQU   $FLAG1                                                   00681000
$TEP3RD  EQU   $FLAG1                                                   00682000
@NM00024 EQU   $CDA+120                                                 00683000
$CUCNT   EQU   $CDA+118                                                 00684000
@NM00023 EQU   $CDA+117                                                 00685000
$PRTFORM EQU   $CDA+116                                                 00686000
$OPISCNT EQU   $CDA+114                                                 00687000
$OPNDCNT EQU   $CDA+112                                                 00688000
$GETMSZE EQU   $CDA+110                                                 00689000
$GRCNTS  EQU   $CDA+108                                                 00690000
$CTLCNT  EQU   $CDA+106                                                 00691000
$ACTLVL  EQU   $CDA+105                                                 00692000
$PRNTLVL EQU   $CDA+104                                                 00693000
$ERRCNTA EQU   $CDA+102                                                 00694000
$TLCNT   EQU   $CDA+100                                                 00695000
$TIMEALW EQU   $CDA+96                                                  00696000
$PTRAREA EQU   $CDA+92                                                  00697000
$GETMPTR EQU   $CDA+88                                                  00698000
$R13PTRT EQU   $CDA+84                                                  00699000
$TEPEND  EQU   $CDA+76                                                  00700000
$PLINKDL EQU   $CDA+72                                                  00701000
$TEPBEGN EQU   $CDA+68                                                  00702000
$FRELPTR EQU   $CDA+64                                                  00703000
$HIGHADR EQU   $HIMOREC                                                 00704000
$LOMOREC EQU   $CDA+56                                                  00705000
$ENDCOMM EQU   $CDA+48                                                  00706000
$COMMON  EQU   $RCA                                                     00707000
$SLASHAD EQU   $CDA+32                                                  00708000
$PASSON  EQU   $CDA+28                                                  00709000
$TOLBRTB EQU   $CDA+24                                                  00710000
$SCTPTR8 EQU   $CDA+20                                                  00711000
$SCTPTR  EQU   $CDA+16                                                  00712000
$TBWDPTR EQU   $CDA+12                                                  00713000
$TFWDPTR EQU   $CDA+8                                                   00714000
@NM00022 EQU   $CDA                                                     00715000
@NM00021 EQU   $SCTTBLE+98                                              00716000
$SCTLWTC EQU   $SCTTBLE+96                                              00717000
$SCTLWTA EQU   $SCTTBLE+92                                              00718000
#EXT     EQU   $SCTTBLE+88                                              00719000
#PASS    EQU   $SCTTBLE+84                                              00720000
#TABLE   EQU   $SCTTBLE+80                                              00721000
#MSGIDAC EQU   $SCTTBLE+78                                              00722000
@NM00020 EQU   $SCTTBLE+71                                              00723000
$R249255 EQU   $ROUTMSK+29                                              00724000
$R241248 EQU   $ROUTMSK+28                                              00725000
$R233240 EQU   $ROUTMSK+27                                              00726000
$R225232 EQU   $ROUTMSK+26                                              00727000
$R217224 EQU   $ROUTMSK+25                                              00728000
$R209216 EQU   $ROUTMSK+24                                              00729000
$R201208 EQU   $ROUTMSK+23                                              00730000
$R193200 EQU   $ROUTMSK+22                                              00731000
$R185192 EQU   $ROUTMSK+21                                              00732000
$R177184 EQU   $ROUTMSK+20                                              00733000
$R169176 EQU   $ROUTMSK+19                                              00734000
$R161168 EQU   $ROUTMSK+18                                              00735000
$R153160 EQU   $ROUTMSK+17                                              00736000
$R145152 EQU   $ROUTMSK+16                                              00737000
$R137144 EQU   $ROUTMSK+15                                              00738000
$R129136 EQU   $ROUTMSK+14                                              00739000
$R121128 EQU   $ROUTMSK+13                                              00740000
$R113120 EQU   $ROUTMSK+12                                              00741000
$R105112 EQU   $ROUTMSK+11                                              00742000
$R097104 EQU   $ROUTMSK+10                                              00743000
$R089096 EQU   $ROUTMSK+9                                               00744000
$R081088 EQU   $ROUTMSK+8                                               00745000
$R073080 EQU   $ROUTMSK+7                                               00746000
$R065072 EQU   $ROUTMSK+6                                               00747000
$R057064 EQU   $ROUTMSK+5                                               00748000
$R049056 EQU   $ROUTMSK+4                                               00749000
$R041048 EQU   $ROUTMSK+3                                               00750000
$R033040 EQU   $ROUTMSK+2                                               00751000
$R025032 EQU   $ROUTMSK+1                                               00752000
$R017024 EQU   $ROUTMSK                                                 00753000
$TOTFLG2 EQU   $SCTTBLE+39                                              00754000
@NM00019 EQU   $TOTFLG1                                                 00755000
@NM00018 EQU   $TOTFLG1                                                 00756000
@NM00017 EQU   $TOTFLG1                                                 00757000
$CURELOD EQU   $TOTFLG1                                                 00758000
@NM00016 EQU   $TOTFLG1                                                 00759000
@NM00015 EQU   $TOTFLG1                                                 00760000
$LINESHR EQU   $TOTFLG1                                                 00761000
@NM00014 EQU   $OLTFLG2                                                 00762000
@NM00013 EQU   $OLTFLG2                                                 00763000
@NM00012 EQU   $OLTFLG2                                                 00764000
@NM00011 EQU   $OLTFLG2                                                 00765000
@NM00010 EQU   $OLTFLG2                                                 00766000
@NM00009 EQU   $OLTFLG2                                                 00767000
@NM00008 EQU   $OLTFLG2                                                 00768000
$TALK    EQU   $OLTFLG2                                                 00769000
$DYCOM   EQU   $OLTFLGS                                                 00770000
@NM00007 EQU   $OLTFLGS                                                 00771000
$TRACE   EQU   $OLTFLGS                                                 00772000
$RETCODE EQU   $OLTFLGS                                                 00773000
$CONTCB  EQU   $OLTFLGS                                                 00774000
$RETAIN  EQU   $OLTFLGS                                                 00775000
$CLEANRT EQU   $OLTFLGS                                                 00776000
$OLTSIZE EQU   $SCTTBLE+34                                              00777000
$QSCTMOD EQU   $EXECFLG                                                 00778000
$CTRLMOD EQU   $EXECFLG                                                 00779000
$CLEANUP EQU   $EXECFLG                                                 00780000
$LSTPDEV EQU   $EXECFLG                                                 00781000
$ERRCNT  EQU   $EXECFLG                                                 00782000
$RTNSLCT EQU   $EXECFLG                                                 00783000
$MULTDEV EQU   $EXECFLG                                                 00784000
@NM00006 EQU   $EXECFLG                                                 00785000
$RMSKCNT EQU   $SCTTBLE+32                                              00786000
$SYNAME  EQU   $CDS8T19+4                                               00787000
$EXTSIG  EQU   $CDS8T19+3                                               00788000
$CDFLGS  EQU   $CDS8T19+1                                               00789000
$CDSCNT  EQU   $CDS8T19                                                 00790000
$PDEVDSC EQU   $SCTTBLE+16                                              00791000
$PDEVADR EQU   $SCTTBLE+12                                              00792000
$COMMCN  EQU   $CDSFLGS                                                 00793000
$CUSTSYM EQU   $CDSFLGS                                                 00794000
$TWOCHSW EQU   $CDSFLGS                                                 00795000
$SYMNAME EQU   $CDSFLGS                                                 00796000
$EXTINTC EQU   $CDSFLGS                                                 00797000
$CEVOL   EQU   $CDSFLGS                                                 00798000
$SHARED  EQU   $CDSFLGS                                                 00799000
$FPM     EQU   $CDSFLGS                                                 00800000
$LASTSUB EQU   $PDEVFLG                                                 00801000
@NM00005 EQU   $PDEVFLG                                                 00802000
@NM00004 EQU   $PDEVFLG                                                 00803000
@NM00003 EQU   $PDEVFLG                                                 00804000
$LASTDEV EQU   $PDEVFLG                                                 00805000
@NM00002 EQU   $PDEVFLG                                                 00806000
$EXFILPT EQU   $PDEVFLG                                                 00807000
$FPMOLD  EQU   $PDEVFLG                                                 00808000
$TSSSYM  EQU   $SCTTBLE+8                                               00809000
$SCTLEVL EQU   $SCTTBLE+7                                               00810000
$DRIVER  EQU   $SCTTBLE+6                                               00811000
$LOOPTST EQU   $ERROPT                                                  00812000
$LOOPERR EQU   $ERROPT                                                  00813000
$NERRPRT EQU   $ERROPT                                                  00814000
$NOCNTRL EQU   $ERROPT                                                  00815000
$ALTPRNT EQU   $ERROPT                                                  00816000
$CATERR  EQU   $ERROPT                                                  00817000
$ASTERIK EQU   $ERROPT                                                  00818000
$FSTCOMM EQU   $TESTOPT                                                 00819000
$INDEFLP EQU   $TESTOPT                                                 00820000
$NOPRT   EQU   $TESTOPT                                                 00821000
$PARAPRT EQU   $TESTOPT                                                 00822000
@NM00001 EQU   $TESTOPT                                                 00823000
$ERRLPCT EQU   $SCTTBLE                                                 00824000
.@UNREFD ANOP                          END UNREFERENCED COMPONENTS      00825000
@RF00070 EQU   S2EC0020                                                 00826000
@ENDDATA EQU   *                                                        00827000
         END   ISTSC02E,(C'PLS1520',0702,78337)                         00828000
./  ADD  SSI=83370147,NAME=ISTSC020
         TITLE 'ISTSC020 - CECOM'                                       00001000
ISTSC020 CSECT ,                                                   0001 00002000
@MAINENT DS    0H                                                  0001 00003000
         USING *,@15                                               0001 00004000
         B     @PROLOG                                             0001 00005000
         DC    AL2(@EP00001-@MAINENT)                                   00006000
         DC    AL1(16)                                             0001 00007000
         DC    C'ISTSC020  78.337'                                 0001 00008000
S20CEC03 DS    0H                                                  0001 00009000
         USING *,@15                                               0001 00010000
         B     @PROLOG                                             0001 00011000
         DC    AL2(@EP00180-S20CEC03)                                   00012000
         ENTRY S20CEC03                                                 00013000
         DROP  @15                                                      00014000
@PROLOG  ST    @14,12(,@13)                                        0001 00015000
         STM   @00,@12,20(@13)                                     0001 00016000
         BALR  @11,0                                               0001 00017000
@PSTART  DS    0H                                                  0001 00018000
         USING @PSTART,@11                                         0001 00019000
         AH    @15,4(,@15)                                         0001 00020000
         BR    @15                                                 0001 00021000
@EP00001 DS    0H                                                  0002 00022000
         EJECT                                                          00023000
*        SVESC020(2) = R13;             /* SET UP BACK PTR           */ 00024000
         ST    R13,SVESC020+4(,WAPTR)                              0064 00025000
*        BACKSAVE(3) = ADDR(SVESC020);  /* PUT FORWARD CHAIN IN LAST */ 00026000
         LA    @12,SVESC020(,WAPTR)                                0065 00027000
         ST    @12,BACKSAVE+8(,R13)                                0065 00028000
*        R13 = ADDR(SVESC020);          /* POINT TO SAVE AREA FOR MOD*/ 00029000
         LR    R13,@12                                             0066 00030000
*        $C2WAY='0'B;                   /* SET 2 WAY SWITCH OFF      */ 00031000
         NI    $C2WAY(WAPTR),B'01111111'                           0067 00032000
*        $CINCT=ZERO;                   /* ZERO OUT IN COUNT PARAM   */ 00033000
         L     @12,ZERO                                            0068 00034000
         ST    @12,$CINCT(,WAPTR)                                  0068 00035000
*        $CINADR=ZERO;                  /* ZERO OUT IN ADDR PARAM    */ 00036000
         ST    @12,$CINADR(,WAPTR)                                 0069 00037000
*        IF $TCECM = '1'B               /* IF IT IS A TCEC CALL      */ 00038000
*          THEN GOTO S20CEC2;           /* THEN GO TO PROCESS IT     */ 00039000
         TM    $TCECM(WAPTR),B'00000001'                           0070 00040000
         BO    @RT00070                                            0070 00041000
*          ELSE GOTO S20CEC1;           /* ELSE PROCESS CECOM CALL   */ 00042000
         B     S20CEC1                                             0072 00043000
*/********************************************************************/ 00044000
*/*                           C E C O M                              */ 00045000
*/*                                                                  */ 00046000
*/*  THIS SECTION HANDLES ALL 'CECOM' CALLS. IT VERIFIES THE VALIDITY*/ 00047000
*/*  OF THE INPUT PARMMETER FOR BOTH 1-WAY AND 2-WAY COMMUNICATIONS. */ 00048000
*/*  IT ALSO TACKS ON THE PROPER ID TO THE MESSAGE                   */ 00049000
*/********************************************************************/ 00050000
*S20CEC1:                               /* START OF $CCOM CALL       */ 00051000
*        CECMAP=R1;                     /* SET UP PARM PTR           */ 00052000
S20CEC1  LR    CECMAP,R1                                           0073 00053000
*        IF $CEINADR ¬=0                /* TWO WAY COMMUNICATION?    */ 00054000
*              THEN                     /* YES - CONTINUE BELOW      */ 00055000
         SLR   @12,@12                                             0074 00056000
         L     @10,$CEINADR(,CECMAP)                               0074 00057000
         CR    @10,@12                                             0074 00058000
         BE    @RF00074                                            0074 00059000
*/***************************************/                         0075 00060000
*/* CK FOR VALID 'IN' COUNT.            */                         0075 00061000
*/*  IN CNT > 61 = ERROR (RET CODE=8)   */                         0075 00062000
*/*  SET 2WAY COMMUNICATION SW          */                         0075 00063000
*/*  ZERO OUT READ (IN) BUFFER          */                         0075 00064000
*/***************************************/                         0075 00065000
*                DO;                                               0075 00066000
*                  $C2WAY='1'B;         /* TURN ON TWO WAY SWITCH    */ 00067000
         OI    $C2WAY(WAPTR),B'10000000'                           0076 00068000
*                  IF $CEINCT < 0       /* IF 'IN' CNT IS LT ZERO    */ 00069000
*                    THEN GOTO S20CRC08; /* ERR RET WITH RET CODE=8  */ 00070000
         L     @09,$CEINCT(,CECMAP)                                0077 00071000
         CR    @09,@12                                             0077 00072000
         BL    @RT00077                                            0077 00073000
*                  IF $CEINCT > 61 THEN /* IF 'IN' CNT IS GT 61 THEN */ 00074000
         C     @09,@CF00729                                        0079 00075000
         BH    @RT00079                                            0079 00076000
*                    GOTO S20CRC08;     /*  RET TO CALLER W RC=8     */ 00077000
*                  $CINADR=$CEINADR;    /* PASS 'IN' ADDR TO MSG I/O */ 00078000
         ST    @10,$CINADR(,WAPTR)                                 0081 00079000
*                  R14=$CINADR;         /* PUT BUFFER ADDR INTO REG14*/ 00080000
         LR    R14,@10                                             0082 00081000
*                  $CINCT=$CEINCT;      /* PASS 'IN' CNT TO MSG I/O  */ 00082000
         ST    @09,$CINCT(,WAPTR)                                  0083 00083000
*                  R15=$CEINCT;         /* LNGTH OF BUF - 1 IN REG15 */ 00084000
         LR    R15,@09                                             0084 00085000
*            GEN REFS(R15,S20CEC1A) ( EX R15,S20CEC1A);  /* ZERO OUT */ 00086000
          EX R15,S20CEC1A                                               00087000
*                  $CINADR=$CINADR+1;   /* ALLOW 1 BYTE FOR LNGTH FLD*/ 00088000
         LA    @12,1                                               0086 00089000
         AL    @12,$CINADR(,WAPTR)                                 0086 00090000
         ST    @12,$CINADR(,WAPTR)                                 0086 00091000
*                END;                                              0087 00092000
*/***************************************/                         0088 00093000
*/* VERIFY 'OUT' MSG DATA.              */                         0088 00094000
*/*  OUT CNT < 1 = ERROR (RET CDE=8)    */                         0088 00095000
*/*  OUT CNT > 61 ITS RESET TO 61       */                         0088 00096000
*/***************************************/                         0088 00097000
*        IF $CEOUTCT<'01'X THEN         /* IF OUT CNT IS LT ONE      */ 00098000
@RF00074 L     @12,$CEOUTCT(,CECMAP)                               0088 00099000
         LTR   @12,@12                                             0088 00100000
         BNP   @RT00088                                            0088 00101000
*          GOTO S20CRC08;               /*  THEN GO SET RET CODE     */ 00102000
*        $COUTAD=ADDR($WORK);           /* SET UP 'OUT' MSG PARAMETER*/ 00103000
         LA    @10,$WORK(,WAPTR)                                   0090 00104000
         ST    @10,$COUTAD(,WAPTR)                                 0090 00105000
*        IF $CEOUTCT > 61               /* IF PARM CNT       @YA04062*/ 00106000
*             THEN                     /* GTR THAN 61        @YA04062*/ 00107000
         LA    @10,61                                              0091 00108000
         CR    @12,@10                                             0091 00109000
         BNH   @RF00091                                            0091 00110000
*               $COUTCT=61;            /* TRUNCATE TO        @YA04062*/ 00111000
         ST    @10,$COUTCT(,WAPTR)                                 0092 00112000
*                ELSE                  /* 61 ELSE USE CNT    @YA04062*/ 00113000
*        $COUTCT=$CEOUTCT;              /* FOR MSG I/O MODULE        */ 00114000
         B     @RC00091                                            0093 00115000
@RF00091 L     @12,$CEOUTCT(,CECMAP)                               0093 00116000
         ST    @12,$COUTCT(,WAPTR)                                 0093 00117000
*        CECOMSW='1'B;                  /* SET CECOM SW ON           */ 00118000
@RC00091 OI    CECOMSW,B'10000000'                                 0094 00119000
*        GEN  (BAL RETR,S20C01);        /* SET UP MSG PREFIX         */ 00120000
         BAL RETR,S20C01                                                00121000
*        $WORK(I:I+$COUTCT-1)=CEOUTMSG; /* MOVE MSG TO $WORK + PREFIX*/ 00122000
         LH    @12,I(,WAPTR)                                       0096 00123000
         N     @12,@CF00789                                        0096 00124000
         ALR   @12,WAPTR                                           0096 00125000
         L     @10,$COUTCT(,WAPTR)                                 0096 00126000
         LR    @09,@10                                             0096 00127000
         BCTR  @09,0                                               0096 00128000
         L     @08,$CEOUTAD(,CECMAP)                               0096 00129000
         EX    @09,@SM00790                                        0096 00130000
*        $COUTCT = $COUTCT+I-1;         /* ADD PREFIX LEN TO OUT CNT */ 00131000
         LH    @12,I(,WAPTR)                                       0097 00132000
         N     @12,@CF00789                                        0097 00133000
         ALR   @10,@12                                             0097 00134000
         BCTR  @10,0                                               0097 00135000
         ST    @10,$COUTCT(,WAPTR)                                 0097 00136000
*        GOTO S20CEC2D;                 /* GO TO COMMON EXIT TO MSGIO*/ 00137000
         B     S20CEC2D                                            0098 00138000
*S20CEC1A: GEN REFS(R14) ( XC 0(0,R14),0(R14));  /* ZERO OUT READ BUF*/ 00139000
S20CEC1A  XC 0(0,R14),0(R14)                                            00140000
*        GEN   (EJECT);                                            0100 00141000
         EJECT                                                          00142000
*/********************************************************************/ 00143000
*/*                           T C E C                                */ 00144000
*/*                                                                  */ 00145000
*/*  THIS SECTION HANDLES ALL 'TCEC' CALLS. IT TAKES A MSG NUMBER AND*/ 00146000
*/*  USES IT AS AN INDEX TO A MSG TABLE. IT WILL ALSO SUBSTITUTE ANY */ 00147000
*/*  DATA FROM $INBUFR INTO THE MSG AND DELETE EXTRA BLANKS FROM THE */ 00148000
*/*  SUBSTITUTED LINE UNLESS REQUESTED NOT TO.                       */ 00149000
*/*      R1=PARAMETER LIST POINTER                                   */ 00150000
*/********************************************************************/ 00151000
*S20CEC2:                                                          0101 00152000
*        $TCECM='0'B;                   /* RESET TCEC SW IN RCA      */ 00153000
S20CEC2  NI    $TCECM(WAPTR),B'11111110'                           0101 00154000
*        IF $MULLNSW='1'B THEN          /* IF MULTIPLE LINE CALL     */ 00155000
         TM    $MULLNSW(WAPTR),B'00100000'                         0102 00156000
         BO    @RT00102                                            0102 00157000
*            GOTO S20CEC2A;             /* BR TO CHK IF SUBSTITUTION */ 00158000
*        SUBINDX='1'X;                  /* INITIALIZE $INBUFR INDEX  */ 00159000
         LA    @12,1                                               0104 00160000
         STH   @12,SUBINDX(,WAPTR)                                 0104 00161000
*        MSG#=$TCMSG#;                  /* GET CALLER'S MSG NUMBER   */ 00162000
         L     @12,$TCMSG#(,R1)                                    0105 00163000
         STH   @12,MSG#(,WAPTR)                                    0105 00164000
*        IF $TCWTO='1'B THEN            /*IF THE WRT TO OPER SW IS ON*/ 00165000
         TM    $TCWTO(R1),B'00001000'                              0106 00166000
         BNO   @RF00106                                            0106 00167000
*          $CNSLFG='1'B;                /* TURN ON CONSOLE FLG-MSG IO*/ 00168000
         OI    $CNSLFG(WAPTR),B'01000000'                          0107 00169000
*        $COUTAD=ADDR($WORK);           /* SET UP PTR TO 'OUT' MSG   */ 00170000
@RF00106 LA    @12,$WORK(,WAPTR)                                   0108 00171000
         ST    @12,$COUTAD(,WAPTR)                                 0108 00172000
*        CECOMSW='0'B;                  /* SET CECOM SW OFF          */ 00173000
         NI    CECOMSW,B'01111111'                                 0109 00174000
*        GEN  (BAL RETR,S20C01);        /* GO SET UP PREFIX ID'S     */ 00175000
         BAL RETR,S20C01                                                00176000
*        IF $TCLOCM='1'B THEN           /* IF WE DO NOT HAVE TO LOC  */ 00177000
         TM    $TCLOCM(R1),B'00010000'                             0111 00178000
         BO    @RT00111                                            0111 00179000
*          GOTO S20CEC2A;               /* MSG IN TBL THEN BR AROUND */ 00180000
*        $COUTCT=ZERO;                  /* ZERO OUT 'OUT' COUNT AREA */ 00181000
         L     @12,ZERO                                            0113 00182000
         ST    @12,$COUTCT(,WAPTR)                                 0113 00183000
*        GEN  (BAL RETR,S20CMLOC);      /* LOCATE MSG IN MSG TBL     */ 00184000
         BAL RETR,S20CMLOC                                              00185000
*        IF Y=ZERO THEN                 /* IF NO MSG TEXT WAS FOUND  */ 00186000
         SLR   @12,@12                                             0115 00187000
         IC    @12,Y(,WAPTR)                                       0115 00188000
         CL    @12,ZERO                                            0115 00189000
         BNE   @RF00115                                            0115 00190000
*          DO;                                                     0116 00191000
*            $COUTCT=I-1;               /* SET OUT CNT = PREFIX LNGTH*/ 00192000
         LH    @12,I(,WAPTR)                                       0117 00193000
         N     @12,@CF00789                                        0117 00194000
         BCTR  @12,0                                               0117 00195000
         ST    @12,$COUTCT(,WAPTR)                                 0117 00196000
*            GOTO S20CEC2C;             /* BRANCH AROUND SUBSTITUTION*/ 00197000
         B     S20CEC2C                                            0118 00198000
*          END;                                                    0119 00199000
*        $WORK(I:I+Y)=MSGDAT  ;         /* MOVE MSG TO $WORK+PREFIX  */ 00200000
@RF00115 LH    @12,I(,WAPTR)                                       0120 00201000
         N     @12,@CF00789                                        0120 00202000
         ALR   @12,WAPTR                                           0120 00203000
         SLR   @10,@10                                             0120 00204000
         IC    @10,Y(,WAPTR)                                       0120 00205000
         EX    @10,@SM00794                                        0120 00206000
*        $COUTCT=$COUTCT+I-1;           /* ADD PREFIX LEN TO OUT CNT */ 00207000
         LH    @12,I(,WAPTR)                                       0121 00208000
         N     @12,@CF00789                                        0121 00209000
         AL    @12,$COUTCT(,WAPTR)                                 0121 00210000
         BCTR  @12,0                                               0121 00211000
         ST    @12,$COUTCT(,WAPTR)                                 0121 00212000
*/***************************************/                         0122 00213000
*/* SUBSTITUTION CHECK                  */                         0122 00214000
*/***************************************/                         0122 00215000
*S20CEC2A:                                                         0122 00216000
*        IF $TCSUBDA¬='1'B THEN         /* IF NO SUBSTITUTION        */ 00217000
S20CEC2A TM    $TCSUBDA(R1),B'10000000'                            0122 00218000
         BNO   @RT00122                                            0122 00219000
*          GO TO S20CEC2B;              /* THEN BR AROUND            */ 00220000
*        DO X=I TO $COUTCT BY 1;        /* LOOP UNTIL SUBSTITION DONE*/ 00221000
         LH    @12,I(,WAPTR)                                       0124 00222000
         N     @12,@CF00789                                        0124 00223000
         ST    @12,X                                               0124 00224000
         B     @DE00124                                            0124 00225000
@DL00124 DS    0H                                                  0125 00226000
*          IF $WORK(X)=DELMTR THEN      /* IF ITS A SUB CHAR THEN    */ 00227000
         ALR   @12,WAPTR                                           0125 00228000
         CLC   $WORK-1(1,@12),DELMTR                               0125 00229000
         BNE   @RF00125                                            0125 00230000
*            IF SUBINDX<81              /* CHK IF SUB DATA AVAILABLE */ 00231000
*              THEN DO;                                            0126 00232000
         LH    @12,SUBINDX(,WAPTR)                                 0126 00233000
         N     @12,@CF00789                                        0126 00234000
         C     @12,@CF00739                                        0126 00235000
         BNL   @RF00126                                            0126 00236000
*                $WORK(X)=$INBUFR(SUBINDX);   /* MOVE SUB DATA TO MSG*/ 00237000
         L     @10,X                                               0128 00238000
         ALR   @10,WAPTR                                           0128 00239000
         ALR   @12,WAPTR                                           0128 00240000
         MVC   $WORK-1(1,@10),$INBUFR-1(@12)                       0128 00241000
*                SUBINDX=SUBINDX+1;     /* UPDATE INDEX              */ 00242000
         LH    @12,SUBINDX(,WAPTR)                                 0129 00243000
         N     @12,@CF00789                                        0129 00244000
         AL    @12,@CF00103                                        0129 00245000
         STH   @12,SUBINDX(,WAPTR)                                 0129 00246000
*                   END;                                           0130 00247000
*              ELSE                     /* IF SUB DATA NOT AVAILABLE */ 00248000
*                $WORK(X)=BLANK;        /*  MOVE BLANK TO MSG        */ 00249000
         B     @RC00126                                            0131 00250000
@RF00126 LR    @12,WAPTR                                           0131 00251000
         AL    @12,X                                               0131 00252000
         MVC   $WORK-1(1,@12),BLANK                                0131 00253000
*        END;                                                      0132 00254000
@RC00126 DS    0H                                                  0132 00255000
@RF00125 LA    @12,1                                               0132 00256000
         AL    @12,X                                               0132 00257000
         ST    @12,X                                               0132 00258000
@DE00124 CL    @12,$COUTCT(,WAPTR)                                 0132 00259000
         BNH   @DL00124                                            0132 00260000
* S20CEC2B:                                                        0133 00261000
*        IF $MULLNSW='1'B THEN          /* IF MULTIPLE LINE CALL     */ 00262000
S20CEC2B TM    $MULLNSW(WAPTR),B'00100000'                         0133 00263000
         BNO   @RF00133                                            0133 00264000
*          DO;                                                     0134 00265000
*            $MULLNSW='0'B;             /* TURN OFF MULT LINE SW     */ 00266000
         NI    $MULLNSW(WAPTR),B'11011111'                         0135 00267000
*            IF $LSTLNSW='1'B           /* IF LAST LINE OF MULT CALL */ 00268000
*              THEN DO;                                            0136 00269000
         TM    $LSTLNSW(WAPTR),B'00010000'                         0136 00270000
         BNO   @RF00136                                            0136 00271000
*                $LSTLNSW='0'B;         /*  TURN OFF LAST LINE SW    */ 00272000
         NI    $LSTLNSW(WAPTR),B'11101111'                         0138 00273000
*                GOTO S20CEC2C;         /*  BR TO CHK IF 2-WAY       */ 00274000
         B     S20CEC2C                                            0139 00275000
*                   END;                                           0140 00276000
*              ELSE                     /* IF NOT LAST LINE          */ 00277000
*                GOTO S20CEC2D;         /*  BR AROUND 2-WAY CHK      */ 00278000
*          END;                                                    0142 00279000
*/***************************************/                         0143 00280000
*/* TWO-WAY MESSAGE CHECK               */                         0143 00281000
*/***************************************/                         0143 00282000
*S20CEC2C:                                                         0143 00283000
*        IF $TC2WAY='1'B THEN           /* IF IT IS A 2-WAY CALL THEN*/ 00284000
@RF00133 DS    0H                                                  0143 00285000
S20CEC2C TM    $TC2WAY(R1),B'01000000'                             0143 00286000
         BNO   @RF00143                                            0143 00287000
*          DO;                                                     0144 00288000
*            $CINCT=$TCINCT;            /* SET UP 'IN' COUNT         */ 00289000
         L     @12,$TCINCT(,R1)                                    0145 00290000
         ST    @12,$CINCT(,WAPTR)                                  0145 00291000
*            $CINADR=ADDR($INBUFR);     /* SET UP 'IN' ADDR          */ 00292000
         LA    @10,$INBUFR(,WAPTR)                                 0146 00293000
         ST    @10,$CINADR(,WAPTR)                                 0146 00294000
*            R14=$CINADR;               /* PUT BUFFER ADDR INTO REG14*/ 00295000
         LR    R14,@10                                             0147 00296000
*            R15=$CINCT;                /* PUT BUF LNGTH - 1 IN REG15*/ 00297000
         LR    R15,@12                                             0148 00298000
*      GEN REFS(R15,S20CEC1A) ( EX R15,S20CEC1A);  /* ZERO OUT IN BUF*/ 00299000
          EX R15,S20CEC1A                                               00300000
*            $CINADR=$CINADR+1;         /* ALLOW 1 BYTE FOR LNGTH FLD*/ 00301000
         LA    @12,1                                               0150 00302000
         AL    @12,$CINADR(,WAPTR)                                 0150 00303000
         ST    @12,$CINADR(,WAPTR)                                 0150 00304000
*            $C2WAY='1'B;               /* INDICATE TO MSGI/O 2-WAY  */ 00305000
         OI    $C2WAY(WAPTR),B'10000000'                           0151 00306000
*          END;                                                    0152 00307000
*/***************************************/                         0153 00308000
*/* CALLING MESSAGE I/O                 */                         0153 00309000
*/***************************************/                         0153 00310000
*S20CEC2D:                                                         0153 00311000
*        R4=R1;                         /* SAVE INPUT PARM PTR       */ 00312000
@RF00143 DS    0H                                                  0153 00313000
S20CEC2D LR    R4,R1                                               0153 00314000
*        IF $TCNOID='1'B                /* IS MSG PREFIX TO BE DRPD  */ 00315000
*              THEN                     /* IF YES DO THE FOLLOWING   */ 00316000
         TM    $TCNOID(R1),B'00100000'                             0154 00317000
         BNO   @RF00154                                            0154 00318000
*                  DO;                                             0155 00319000
*                      $COUTAD=$COUTAD+7;   /* ADD PTR PAST PREFIX   */ 00320000
         LA    @12,7                                               0156 00321000
         L     @10,$COUTAD(,WAPTR)                                 0156 00322000
         ALR   @10,@12                                             0156 00323000
         ST    @10,$COUTAD(,WAPTR)                                 0156 00324000
*                      $COUTCT=$COUTCT-7;   /* REDUCE MSG COUNT      */ 00325000
         LCR   @12,@12                                             0157 00326000
         AL    @12,$COUTCT(,WAPTR)                                 0157 00327000
         ST    @12,$COUTCT(,WAPTR)                                 0157 00328000
*                  END;                                            0158 00329000
*        R1=ADDR($CCOMDAT);             /* SET POINTER TO PARM       */ 00330000
@RF00154 LA    R1,$CCOMDAT(,WAPTR)                                 0159 00331000
*        CALL ISTCC011;                 /* CALL MESSAGE I/O          */ 00332000
         L     @15,@CV00132                                        0160 00333000
         BALR  @14,@15                                             0160 00334000
*        R1=R4;                         /* RESTORE INPUT PARM        */ 00335000
         LR    R1,R4                                               0161 00336000
*        IF $TCNOID='1'B                /* WAS ID DROPPED            */ 00337000
*              THEN                     /* IF YES DO THE FOLLOWING   */ 00338000
         TM    $TCNOID(R1),B'00100000'                             0162 00339000
         BNO   @RF00162                                            0162 00340000
*                  DO;                                             0163 00341000
*                      $COUTAD=$COUTAD-7;   /* RESET ADDRESS         */ 00342000
         LA    @12,7                                               0164 00343000
         L     @10,$COUTAD(,WAPTR)                                 0164 00344000
         SLR   @10,@12                                             0164 00345000
         ST    @10,$COUTAD(,WAPTR)                                 0164 00346000
*                      $COUTCT=$COUTCT+7;   /* RESET COUNT           */ 00347000
         AL    @12,$COUTCT(,WAPTR)                                 0165 00348000
         ST    @12,$COUTCT(,WAPTR)                                 0165 00349000
*                  END;                                            0166 00350000
*/***************************************/                         0167 00351000
*/* CHECK IF NECESARY TO WAIT ON I/O    */                         0167 00352000
*/***************************************/                         0167 00353000
*S20CEC2E:     ;                                                   0167 00354000
@RF00162 DS    0H                                                  0167 00355000
S20CEC2E DS    0H                                                  0168 00356000
*                                       /* WAS CALL DIRECT & MUST    */ 00357000
*           IF $POSTFLG='1'B &          /* WE WAIT TILL I/O COMPLETE */ 00358000
*           $TCKABND='1'B & $ABTERM='1'B                           0168 00359000
*              THEN                     /* DO THE FOLLOWING          */ 00360000
         TM    $POSTFLG(WAPTR),B'01000000'                         0168 00361000
         BNO   @RF00168                                            0168 00362000
         TM    $TCKABND(R1),B'00000100'                            0168 00363000
         BNO   @RF00168                                            0168 00364000
         TM    $ABTERM(WAPTR),B'00000010'                          0168 00365000
         BNO   @RF00168                                            0168 00366000
*                  DO;                                             0169 00367000
*                       RCAPTR=$RCA;    /* GET PTR TO R. C. AREA     */ 00368000
         L     RCAPTR,$RCA(,WAPTR)                                 0170 00369000
*                       R1=ADDR($TLTECB2);  /* SET UP REG 1          */ 00370000
         LA    R1,$TLTECB2(,RCAPTR)                                0171 00371000
*    CALL I00C1002;     /* WAIT   @D32JPPW*/                       0172 00372000
         L     @15,@CV00745                                        0172 00373000
         BALR  @14,@15                                             0172 00374000
*                       GOTO S20CEC2E;  /* LOOP BACK FOR CHECK       */ 00375000
         B     S20CEC2E                                            0173 00376000
*                  END;                                            0174 00377000
*        GOTO S20CEXIT;                 /* RETURN TO CALLER          */ 00378000
         B     S20CEXIT                                            0175 00379000
*/***************************************/                         0176 00380000
*/* EXIT - RETURN TO CALLER             */                         0176 00381000
*/***************************************/                         0176 00382000
*S20CRC08:                                                         0176 00383000
*        R15=RC08;                      /* SET ERR RETURN CODE       */ 00384000
S20CRC08 SLR   R15,R15                                             0176 00385000
         IC    R15,RC08                                            0176 00386000
*S20CEXIT:                                                         0177 00387000
*        R13 = SVESC020(2);             /* PICK UP PREVIOUS SAVE AREA*/ 00388000
S20CEXIT L     R13,SVESC020+4(,WAPTR)                              0177 00389000
*        RETURN;                        /* RETURN TO CALLER          */ 00390000
@EL00001 DS    0H                                                  0178 00391000
@EF00001 DS    0H                                                  0178 00392000
@ER00001 L     @14,12(,@13)                                        0178 00393000
         LM    @00,@12,20(@13)                                     0178 00394000
         BR    @14                                                 0178 00395000
*        GEN  (EJECT);                                             0179 00396000
         EJECT                                                          00397000
*/********************************************************************/ 00398000
*/*                         T C E C  2                               */ 00399000
*/*                                                                  */ 00400000
*/*  THIS SECTION HANDLES ALL 'TCEC' CALLS FOR MULTIPLE LINE OUTPUT  */ 00401000
*/*  REQUESTS. IT WILL PRINT ALL MESSAGES WITH THE SAME MESSAGE #    */ 00402000
*/*  IF ITS CORRESPONDING 'MASK' BIT IS O  IN THE '$TCMASK' PARAMETER*/ 00403000
*/*  OF THE 'TCEC' MACRO CALL.                                       */ 00404000
*/********************************************************************/ 00405000
*S20CEC03:  ENTRY;                      /* ENTRY POINT FOR MUL-LN    */ 00406000
@EP00180 DS    0H                                                  0181 00407000
*        SVESC120(2) = R13;             /* SET UP BACK PTR           */ 00408000
         ST    R13,SVESC120+4(,WAPTR)                              0181 00409000
*        BACKSAVE(3)  = ADDR(SVESC120); /* PUT FORWARD CHAIN IN LAST */ 00410000
         LA    @12,SVESC120(,WAPTR)                                0182 00411000
         ST    @12,BACKSAVE+8(,R13)                                0182 00412000
*        R13 = ADDR(SVESC120);          /* POINT TO SAVE AREA FOR MOD*/ 00413000
         LR    R13,@12                                             0183 00414000
*        PTRSAV=R1;                     /* SAVE PTR TO ORIG PARM LST */ 00415000
         ST    R1,PTRSAV(,WAPTR)                                   0184 00416000
*        SUBINDX='1'X;                  /* INITIALIZE $INBUFR INDEX  */ 00417000
         LA    @12,1                                               0185 00418000
         STH   @12,SUBINDX(,WAPTR)                                 0185 00419000
*        IF $TCWTO='1'B THEN            /* IF WRT TO OPER SW IS ON   */ 00420000
         TM    $TCWTO(R1),B'00001000'                              0186 00421000
         BNO   @RF00186                                            0186 00422000
*            $CNSLFG='1'B;              /* TURN ON CONSOL FLG-MSG I/O*/ 00423000
         OI    $CNSLFG(WAPTR),B'01000000'                          0187 00424000
*        MSG#=$TCMSG#;                  /* GET CALLER'S MSG NUMBER   */ 00425000
@RF00186 L     @12,$TCMSG#(,R1)                                    0188 00426000
         STH   @12,MSG#(,WAPTR)                                    0188 00427000
*        $COUTAD=ADDR($WORK);           /* SET UP OUT ADDR           */ 00428000
         LA    @12,$WORK(,WAPTR)                                   0189 00429000
         ST    @12,$COUTAD(,WAPTR)                                 0189 00430000
*        CECOMSW='0'B;                  /* SET CECOM SW OFF          */ 00431000
         NI    CECOMSW,B'01111111'                                 0190 00432000
*        GEN   (BAL RETR,S20C01);       /* GO SET UP MSG PREFIX      */ 00433000
         BAL RETR,S20C01                                                00434000
*        GEN   (BAL RETR,S20CMLOC);     /* GO LOCATE MSG IN TBL      */ 00435000
         BAL RETR,S20CMLOC                                              00436000
*        IF Y=ZERO THEN                 /* IF NO MSG TEXT WAS FOUND  */ 00437000
         L     @12,ZERO                                            0193 00438000
         SLR   @10,@10                                             0193 00439000
         IC    @10,Y(,WAPTR)                                       0193 00440000
         CLR   @12,@10                                             0193 00441000
         BNE   @RF00193                                            0193 00442000
*          DO;                                                     0194 00443000
*            $COUTCT=I-1;               /* SET OUT CNT = PREFIX LNGTH*/ 00444000
         LH    @10,I(,WAPTR)                                       0195 00445000
         N     @10,@CF00789                                        0195 00446000
         BCTR  @10,0                                               0195 00447000
         ST    @10,$COUTCT(,WAPTR)                                 0195 00448000
*            $CINADR=ZERO;              /* ZERO OUT IN ADR FIELD     */ 00449000
         ST    @12,$CINADR(,WAPTR)                                 0196 00450000
*            $CINCT=ZERO;               /* ZERO OUT IN COUNT FIELD   */ 00451000
         ST    @12,$CINCT(,WAPTR)                                  0197 00452000
*            $LSTLNSW='1'B;             /* TURN ON LAST LINE SW      */ 00453000
         OI    $LSTLNSW(WAPTR),B'00010000'                         0198 00454000
*            GOTO S20CEC3F;             /* BR TO PRT LINE            */ 00455000
         B     S20CEC3F                                            0199 00456000
*          END;                                                    0200 00457000
*        MMSG#=MSGDAT(1:3);             /* SAVE MSG NO. (EBCDIC)     */ 00458000
@RF00193 MVC   MMSG#(3,WAPTR),MSGDAT(MSGPTR)                       0201 00459000
*        MSKBIT=0;                      /* INITIALIZE CTR TO ZERO    */ 00460000
         MVI   MSKBIT(WAPTR),X'00'                                 0202 00461000
*/***************************************/                         0203 00462000
*/* SEARCH FOR FIRST LINE TO BE PRINTED */                         0203 00463000
*/***************************************/                         0203 00464000
*S20CEC3A:                                                         0203 00465000
*        CNTSAV=ZERO;                   /* ZERO OUT SAVE AREA        */ 00466000
S20CEC3A L     @12,ZERO                                            0203 00467000
         ST    @12,CNTSAV(,WAPTR)                                  0203 00468000
*        CNTSAV(4:4)=Y;                 /* SAVE MSG LENGTH           */ 00469000
         MVC   CNTSAV+3(1,WAPTR),Y(WAPTR)                          0204 00470000
*        MB1=(MSKBIT/8)+1;              /* SET UP TO COMP EACH BYTE  */ 00471000
         LA    @12,1                                               0205 00472000
         SLR   @10,@10                                             0205 00473000
         IC    @10,MSKBIT(,WAPTR)                                  0205 00474000
         LR    @00,@10                                             0205 00475000
         SRL   @00,3                                               0205 00476000
         ALR   @00,@12                                             0205 00477000
         ST    @00,MB1                                             0205 00478000
*        MB2=(MSKBIT//8)+1;             /* GET REMAINDER             */ 00479000
         LR    @06,@10                                             0206 00480000
         SRDA  @06,32                                              0206 00481000
         D     @06,@CF00040                                        0206 00482000
         ALR   @06,@12                                             0206 00483000
         ST    @06,MB2                                             0206 00484000
*        R1=PTRSAV;                     /* SET UP BASE REG           */ 00485000
         L     R1,PTRSAV(,WAPTR)                                   0207 00486000
*        IF (($TCMASK(MB1)) & (MSKTBL(MB2)))¬=0 THEN /*BIT ON-PRT MSG*/ 00487000
         LR    @07,@00                                             0208 00488000
         SLR   @00,@00                                             0208 00489000
         IC    @00,$TCMASK-1(@07,R1)                               0208 00490000
         SLR   @07,@07                                             0208 00491000
         IC    @07,MSKTBL-1(@06)                                   0208 00492000
         NR    @00,@07                                             0208 00493000
         LTR   @00,@00                                             0208 00494000
         BNZ   @RT00208                                            0208 00495000
*          GOTO S20CEC3C;               /* BR AROUND                 */ 00496000
*        MSKBIT=MSKBIT+1;               /* UPDATE TO NXT BIT         */ 00497000
         ALR   @10,@12                                             0210 00498000
         STC   @10,MSKBIT(,WAPTR)                                  0210 00499000
*        MSGPTR=MSGPTR+CNTSAV;          /* UPDATE MSG PTR TO NXT MSG */ 00500000
         AL    MSGPTR,CNTSAV(,WAPTR)                               0211 00501000
*        Y = MSGDAT;                    /* GET LEN OF THAT MSG       */ 00502000
         MVC   Y(1,WAPTR),MSGDAT(MSGPTR)                           0212 00503000
*        MSGPTR=MSGPTR+1;               /* UPDATE PTR TO MSG TXT     */ 00504000
         ALR   MSGPTR,@12                                          0213 00505000
*        IF MMSG#=MSGDAT(1:3)           /* IF PRESENT=LST MSG NUMBER */ 00506000
*          THEN GOTO S20CEC3A;          /* BR BACK AND TEST MASK BIT */ 00507000
         CLC   MMSG#(3,WAPTR),MSGDAT(MSGPTR)                       0214 00508000
         BE    @RT00214                                            0214 00509000
*          ELSE GOTO S20CEC3H;          /* ELSE RETURN TO CALLER     */ 00510000
         B     S20CEC3H                                            0216 00511000
*S20CEC3B:                                                         0217 00512000
*        R1=PTRSAV;                     /* SET UP BASE REG           */ 00513000
S20CEC3B L     R1,PTRSAV(,WAPTR)                                   0217 00514000
*/***************************************/                         0218 00515000
*/* FORMAT LINE                         */                         0218 00516000
*/***************************************/                         0218 00517000
*S20CEC3C:                                                         0218 00518000
*        GEN   (BAL RETR,S20C01);                                  0218 00519000
S20CEC3C BAL RETR,S20C01                                                00520000
*        GEN   (BAL RETR,S20C01);                                  0219 00521000
         BAL RETR,S20C01                                                00522000
*        $WORK(I)=BLANK;                /* BLANK OUT                 */ 00523000
         LH    @12,I(,WAPTR)                                       0220 00524000
         N     @12,@CF00789                                        0220 00525000
         ALR   @12,WAPTR                                           0220 00526000
         MVC   $WORK-1(1,@12),BLANK                                0220 00527000
*        $WORK(I+1:N)=$WORK(I:N-1);     /* $WORK BUFFER              */ 00528000
         LH    @12,I(,WAPTR)                                       0221 00529000
         N     @12,@CF00789                                        0221 00530000
         ALR   @12,WAPTR                                           0221 00531000
         LH    @10,I(,WAPTR)                                       0221 00532000
         N     @10,@CF00789                                        0221 00533000
         LH    @09,N                                               0221 00534000
         N     @09,@CF00789                                        0221 00535000
         SLR   @09,@10                                             0221 00536000
         BCTR  @09,0                                               0221 00537000
         ALR   @10,WAPTR                                           0221 00538000
         MVC   @TS00001(256),$WORK-1(@10)                          0221 00539000
         EX    @09,@SM00799                                        0221 00540000
*        $WORK(I:I+Y)=MSGDAT;           /* MOVE MSG TO $WORK+PREFIX  */ 00541000
         LH    @12,I(,WAPTR)                                       0222 00542000
         N     @12,@CF00789                                        0222 00543000
         ALR   @12,WAPTR                                           0222 00544000
         SLR   @10,@10                                             0222 00545000
         IC    @10,Y(,WAPTR)                                       0222 00546000
         EX    @10,@SM00794                                        0222 00547000
*        $COUTCT = CNTSAV+I-1;          /* ADD PREFIX LEN TO OUT CNT */ 00548000
         LH    @12,I(,WAPTR)                                       0223 00549000
         N     @12,@CF00789                                        0223 00550000
         AL    @12,CNTSAV(,WAPTR)                                  0223 00551000
         BCTR  @12,0                                               0223 00552000
         ST    @12,$COUTCT(,WAPTR)                                 0223 00553000
*        $CINADR=ZERO;                  /* ZERO OUT IN ADDR FLD      */ 00554000
         L     @12,ZERO                                            0224 00555000
         ST    @12,$CINADR(,WAPTR)                                 0224 00556000
*        $CINCT=ZERO;                   /* ZERO OUT IN COUNT FLD     */ 00557000
         ST    @12,$CINCT(,WAPTR)                                  0225 00558000
*/***************************************/                         0226 00559000
*/* SEARCH FOR NEXT LINE TO BE PRINTED  */                         0226 00560000
*/* IN ORDER TO KNOW WHETHER THE LINE   */                         0226 00561000
*/* FORMATTED ABOVE IS THE LAST LINE    */                         0226 00562000
*/***************************************/                         0226 00563000
*S20CEC3D:                                                         0226 00564000
*        MSKBIT=MSKBIT+1;               /* UPDATE TO NXT BIT         */ 00565000
S20CEC3D LA    @12,1                                               0226 00566000
         SLR   @10,@10                                             0226 00567000
         IC    @10,MSKBIT(,WAPTR)                                  0226 00568000
         ALR   @10,@12                                             0226 00569000
         STC   @10,MSKBIT(,WAPTR)                                  0226 00570000
*        MSGPTR=MSGPTR+CNTSAV;          /* UPDATE MSG PTR TO NXT MSG */ 00571000
         AL    MSGPTR,CNTSAV(,WAPTR)                               0227 00572000
*        Y = MSGDAT;                    /* GET LEN OF THAT MSG       */ 00573000
         MVC   Y(1,WAPTR),MSGDAT(MSGPTR)                           0228 00574000
*        CNTSAV=ZERO;                   /* ZERO OUT SAVE AREA        */ 00575000
         L     @10,ZERO                                            0229 00576000
         ST    @10,CNTSAV(,WAPTR)                                  0229 00577000
*        CNTSAV(4:4)=Y;                 /* SAVE MSG LENGTH           */ 00578000
         MVC   CNTSAV+3(1,WAPTR),Y(WAPTR)                          0230 00579000
*        MSGPTR=MSGPTR+1;               /* UPDATE PTR TO MSG TXT     */ 00580000
         ALR   MSGPTR,@12                                          0231 00581000
*        IF MMSG#¬=MSGDAT(1:3) THEN     /* CHK IF THE MSG NUM CHANGED*/ 00582000
         CLC   MMSG#(3,WAPTR),MSGDAT(MSGPTR)                       0232 00583000
         BE    @RF00232                                            0232 00584000
*          DO;                                                     0233 00585000
*            $LSTLNSW='1'B;             /*  TURN ON LAST LINE SW     */ 00586000
         OI    $LSTLNSW(WAPTR),B'00010000'                         0234 00587000
*            GOTO S20CEC3F;             /*  BR TO PRT LAST LINE      */ 00588000
         B     S20CEC3F                                            0235 00589000
*          END;                                                    0236 00590000
*        MB1=(MSKBIT/8)+1;              /* SET UP TO COMP EACH BYTE  */ 00591000
@RF00232 LA    @12,1                                               0237 00592000
         SLR   @10,@10                                             0237 00593000
         IC    @10,MSKBIT(,WAPTR)                                  0237 00594000
         LR    @00,@10                                             0237 00595000
         SRL   @00,3                                               0237 00596000
         ALR   @00,@12                                             0237 00597000
         ST    @00,MB1                                             0237 00598000
*        MB2=(MSKBIT//8)+1;             /* GET REMAINDER             */ 00599000
         LR    @06,@10                                             0238 00600000
         SRDA  @06,32                                              0238 00601000
         D     @06,@CF00040                                        0238 00602000
         ALR   @06,@12                                             0238 00603000
         ST    @06,MB2                                             0238 00604000
*        IF (($TCMASK(MB1)) & (MSKTBL(MB2)))=0 THEN /*BIT OFF-BR     */ 00605000
         LR    @12,@00                                             0239 00606000
         SLR   @10,@10                                             0239 00607000
         IC    @10,$TCMASK-1(@12,R1)                               0239 00608000
         SLR   @12,@12                                             0239 00609000
         IC    @12,MSKTBL-1(@06)                                   0239 00610000
         NR    @10,@12                                             0239 00611000
         LTR   @10,@10                                             0239 00612000
         BZ    @RT00239                                            0239 00613000
*          GOTO S20CEC3D;               /* CK NXT BIT                */ 00614000
*/***************************************/                         0241 00615000
*/* CALLING CECOM (TCEC)                */                         0241 00616000
*/***************************************/                         0241 00617000
*S20CEC3F:                                                         0241 00618000
*        $MULLNSW='1'B;                 /* TURN ON MULTIPLE LINE SW  */ 00619000
S20CEC3F OI    $MULLNSW(WAPTR),B'00100000'                         0241 00620000
*        $TCECM='1'B;                   /* TURN ON TCEC SW           */ 00621000
         OI    $TCECM(WAPTR),B'00000001'                           0242 00622000
*        GEN   (MVC MYPARM(9,WAPTR),0(R1));                        0243 00623000
         MVC MYPARM(9,WAPTR),0(R1)                                      00624000
*        R1=ADDR(MYPARM);               /* SET UP ADDRESSABILITY     */ 00625000
         LA    R1,MYPARM(,WAPTR)                                   0244 00626000
*        IF $TCKABND='1'B & $ABTERM='1'B      /* IF BOTH ABENDS ON   */ 00627000
*          THEN                                                    0245 00628000
         TM    $TCKABND(R1),B'00000100'                            0245 00629000
         BNO   @RF00245                                            0245 00630000
         TM    $ABTERM(WAPTR),B'00000010'                          0245 00631000
         BNO   @RF00245                                            0245 00632000
*            CALL ISTSC020;             /* CALL TCEC DIRECTLY        */ 00633000
         L     @15,@CA00028                                        0246 00634000
         BALR  @14,@15                                             0246 00635000
*          ELSE                         /* IF NOT ABENDING           */ 00636000
*            CALL #EXIT;                /* CALL TCEC VIA RESOURCE MGR*/ 00637000
         B     @RC00245                                            0247 00638000
@RF00245 L     @15,#EXITA(,WAPTR)                                  0247 00639000
         BALR  @14,@15                                             0247 00640000
*        IF Y=ZERO THEN                 /* IF LINE PRINTED WAS NULL  */ 00641000
@RC00245 SLR   @12,@12                                             0248 00642000
         IC    @12,Y(,WAPTR)                                       0248 00643000
         CL    @12,ZERO                                            0248 00644000
         BE    @RT00248                                            0248 00645000
*          GOTO S20CEC3H;               /* THEN RETURN               */ 00646000
*        IF MMSG#=MSGDAT(1:3) THEN      /* CHECK IF LAST LINE        */ 00647000
         CLC   MMSG#(3,WAPTR),MSGDAT(MSGPTR)                       0250 00648000
         BE    @RT00250                                            0250 00649000
*          GOTO S20CEC3B;               /*  NO, BR FOR NEXT MSG      */ 00650000
*/***************************************/                         0252 00651000
*/* EXIT - RETURN TO CALLER             */                         0252 00652000
*/***************************************/                         0252 00653000
*S20CEC3H:                                                         0252 00654000
*        R13=SVESC120(2);               /* PICK UP PREVIOUS SAVE AREA*/ 00655000
S20CEC3H L     R13,SVESC120+4(,WAPTR)                              0252 00656000
*        RETURN;                        /* RETURN TO CALLER          */ 00657000
         B     @EL00001                                            0253 00658000
*        GEN  (EJECT);                                             0254 00659000
         EJECT                                                          00660000
*/********************************************************************/ 00661000
*/* THIS SUBROUTINE TAKES CARE OF PUTTING THE PREFIX ID ON THE MSG.  */ 00662000
*/* IF THE PREFIX IS FOR A TOLTEP MSG THEN                           */ 00663000
*/*      'ITAXXXX' WHERE XXXX IS INCLUDED AS PART OF EACH MSG TEXT   */ 00664000
*/*   IN DOS 'FXXXX' WHERE XXXX IS AS ABOVE                          */ 00665000
*/* IF THE PREFIX IS FOR AN OLT MSG THEN                             */ 00666000
*/*      'IXXNNNZ' WHERE XX  = COMPONENT NAME SUPPLIED BY THE OLT    */ 00667000
*/*                      NNN = MSG NUMBER SUPPLIED BY THE OLT        */ 00668000
*/*                      Z   = 'I' OR 'D' INDICATING 1-WAY OR 2-WAY  */ 00669000
*/*      'ITA100I' OR 'ITA101D' IS USED WHEN THE OLT FAILS TO SUPPLY */ 00670000
*/*                             THE COMPONENT NAME                   */ 00671000
*/*   IN DOS THE COMPONENT NAME IS NOT USED                          */ 00672000
*/*      'F100I' OR 'F101D'                                          */ 00673000
*/********************************************************************/ 00674000
*S20C01:                                                           0255 00675000
*        RETSAV=R14;                    /* SAVE RETURN ADDRESS       */ 00676000
S20C01   ST    R14,RETSAV(,WAPTR)                                  0255 00677000
*        I='0'X;                        /* ZERO OUT INDEX VALUE      */ 00678000
         SLR   @12,@12                                             0256 00679000
         STH   @12,I(,WAPTR)                                       0256 00680000
*        IF $TCKIDON='1'B THEN          /* IF ID ON BIT SET THEN     */ 00681000
         TM    $TCKIDON(R1),B'00000010'                            0257 00682000
         BO    @RT00257                                            0257 00683000
*          GOTO S20C03;                 /* RETURN TO THE CALLER      */ 00684000
*        $WORK(1)=BLANK;                /* BLANK OUT                 */ 00685000
         MVC   $WORK(1,WAPTR),BLANK                                0259 00686000
*        $WORK(2:N)=$WORK(1:N-1);       /* $WORK BUFFER              */ 00687000
         LH    @12,N                                               0260 00688000
         N     @12,@CF00789                                        0260 00689000
         BCTR  @12,0                                               0260 00690000
         BCTR  @12,0                                               0260 00691000
         MVC   @TS00001(256),$WORK(WAPTR)                          0260 00692000
         EX    @12,@SM00803                                        0260 00693000
*        IF CECOMSW='1'B THEN           /* IF PREFIX IS FOR OLT MSG  */ 00694000
         TM    CECOMSW,B'10000000'                                 0261 00695000
         BO    @RT00261                                            0261 00696000
*          GOTO S20C02;                 /*   THEN BR                 */ 00697000
*        IF $DRIVER = DOS87             /* IF SYSTEM IS DOS          */ 00698000
*          THEN DO;                                                0263 00699000
         CLC   $DRIVER(1,WAPTR),DOS87                              0263 00700000
         BNE   @RF00263                                            0263 00701000
*            I=1;                       /* GET LENGTH OF INT PREFIX  */ 00702000
         MVC   I(2,WAPTR),@CH00103                                 0265 00703000
*            $WORK(1)=DOSPREFX;         /* MOVE PREFIX TO MSG        */ 00704000
         MVC   $WORK(1,WAPTR),DOSPREFX                             0266 00705000
*               END;                                               0267 00706000
*          ELSE DO;                     /*IF SYSTEM IS OTHER THAN DOS*/ 00707000
         B     @RC00263                                            0268 00708000
@RF00263 DS    0H                                                  0269 00709000
*            I=LENGTH(ITA);             /* GET LENGTH OF INT PREFIX  */ 00710000
         LA    @12,3                                               0269 00711000
         STH   @12,I(,WAPTR)                                       0269 00712000
*            $WORK(1:I)=ITA;            /* MOVE PREFIX TO MSG        */ 00713000
         BCTR  @12,0                                               0270 00714000
         EX    @12,@SM00805                                        0270 00715000
*               END;                                               0271 00716000
*        GOTO S20C03;                   /* BR AROUND                 */ 00717000
         B     S20C03                                              0272 00718000
*S20C02:                                                           0273 00719000
*        IF #MSGIDAC¬='0000'X & $DRIVER¬=DOS87 /*IF OLT GAVE A MSGID */ 00720000
*          THEN GOTO S20C02A;           /* AND SYSTEM NOT DOS, BR    */ 00721000
S20C02   CLC   #MSGIDAC(2,WAPTR),@CB00770                          0273 00722000
         BE    @RF00273                                            0273 00723000
         CLC   $DRIVER(1,WAPTR),DOS87                              0273 00724000
         BNE   @RT00273                                            0273 00725000
*        IF $DRIVER = DOS87             /* IF SYSTEM IS DOS          */ 00726000
*          THEN                                                    0275 00727000
@RF00273 CLC   $DRIVER(1,WAPTR),DOS87                              0275 00728000
         BNE   @RF00275                                            0275 00729000
*          IF $C2WAY='1'B               /*  IF ITS A 2-WAY REQUEST   */ 00730000
*            THEN DO;                                              0276 00731000
         TM    $C2WAY(WAPTR),B'10000000'                           0276 00732000
         BNO   @RF00276                                            0276 00733000
*              I=LENGTH(DOS2WAY);       /*  GET LENGTH OF PREFIX     */ 00734000
         LA    @12,6                                               0278 00735000
         STH   @12,I(,WAPTR)                                       0278 00736000
*              $WORK(1:I)=DOS2WAY;      /*  MOVE PREFIX TO MSG       */ 00737000
         BCTR  @12,0                                               0279 00738000
         EX    @12,@SM00807                                        0279 00739000
*                 END;                                             0280 00740000
*            ELSE DO;                   /*  IF ITS A 1-WAY REQUEST   */ 00741000
         B     @RC00276                                            0281 00742000
@RF00276 DS    0H                                                  0282 00743000
*              I=LENGTH(DOS1WAY);       /*  GET LENGTH OF PREFIX     */ 00744000
         LA    @12,6                                               0282 00745000
         STH   @12,I(,WAPTR)                                       0282 00746000
*              $WORK(1:I)=DOS1WAY;      /*  MOVE PREFIX TO MSG       */ 00747000
         BCTR  @12,0                                               0283 00748000
         EX    @12,@SM00809                                        0283 00749000
*                 END;                                             0284 00750000
*          ELSE                         /*IF SYSTEM IS OTHER THAN DOS*/ 00751000
*          IF $C2WAY='1'B               /* IF ITS A 2-WAY MSG        */ 00752000
*            THEN DO;                                              0285 00753000
         B     @RC00275                                            0285 00754000
@RF00275 TM    $C2WAY(WAPTR),B'10000000'                           0285 00755000
         BNO   @RF00285                                            0285 00756000
*              I=LENGTH(TWOWAY);        /* GET LENGTH OF PREFIX      */ 00757000
         LA    @12,8                                               0287 00758000
         STH   @12,I(,WAPTR)                                       0287 00759000
*              $WORK(1:I)=TWOWAY;       /* MOVE PREFIX TO MSG        */ 00760000
         BCTR  @12,0                                               0288 00761000
         EX    @12,@SM00811                                        0288 00762000
*                 END;                                             0289 00763000
*            ELSE DO;                   /* IF ITS A 1-WAY REQUEST    */ 00764000
         B     @RC00285                                            0290 00765000
@RF00285 DS    0H                                                  0291 00766000
*              I=LENGTH(ONEWAY);        /* GET LENGTH OF PREFIX      */ 00767000
         LA    @12,8                                               0291 00768000
         STH   @12,I(,WAPTR)                                       0291 00769000
*              $WORK(1:I)=ONEWAY;       /* MOVE PREFIX TO MSG        */ 00770000
         BCTR  @12,0                                               0292 00771000
         EX    @12,@SM00813                                        0292 00772000
*                 END;                                             0293 00773000
*        GOTO S20C03;                   /* BR AROUND                 */ 00774000
         B     S20C03                                              0294 00775000
*S20C02A:                                                          0295 00776000
*        $WORK(1)=LETTERI;              /* BUILDING MSGID -FIRST LET */ 00777000
S20C02A  MVC   $WORK(1,WAPTR),LETTERI                              0295 00778000
*        $WORK(2:3)=#MSGIDAC;           /*  -COMPONENT NAME          */ 00779000
         MVC   $WORK+1(2,WAPTR),#MSGIDAC(WAPTR)                    0296 00780000
*        $WORK(4:6)=CEOUTMSG(1:3);      /*  -MSG NUMBER              */ 00781000
         L     @12,$CEOUTAD(,CECMAP)                               0297 00782000
         MVC   $WORK+3(3,WAPTR),CEOUTMSG(@12)                      0297 00783000
*        $CEOUTAD=$CEOUTAD+3;           /* REMOVE MSG# FROM MSG TEXT */ 00784000
         LA    @10,3                                               0298 00785000
         ALR   @12,@10                                             0298 00786000
         ST    @12,$CEOUTAD(,CECMAP)                               0298 00787000
*        $COUTCT=$COUTCT-3;             /* CORRECT MSG LENGTH CTR    */ 00788000
         LCR   @10,@10                                             0299 00789000
         AL    @10,$COUTCT(,WAPTR)                                 0299 00790000
         ST    @10,$COUTCT(,WAPTR)                                 0299 00791000
*        IF $C2WAY='1'B                 /* CHK IF 2-WAY REQUESTED    */ 00792000
*          THEN $WORK(7)=LETTERD;       /*  YES, RESPONSE REQUESTED  */ 00793000
         TM    $C2WAY(WAPTR),B'10000000'                           0300 00794000
         BNO   @RF00300                                            0300 00795000
         MVC   $WORK+6(1,WAPTR),LETTERD                            0301 00796000
*          ELSE $WORK(7)=LETTERI;       /*  NO, INFORMATIONAL        */ 00797000
         B     @RC00300                                            0302 00798000
@RF00300 MVC   $WORK+6(1,WAPTR),LETTERI                            0302 00799000
*        I=8;                           /* SET INDEX 1ST BYTE PAST ID*/ 00800000
@RC00300 LA    @12,8                                               0303 00801000
         STH   @12,I(,WAPTR)                                       0303 00802000
*        $WORK(I)=BLANK;                /* PUT BLANK BETWEEN ID & MSG*/ 00803000
         ALR   @12,WAPTR                                           0304 00804000
         MVC   $WORK-1(1,@12),BLANK                                0304 00805000
*S20C03:                                                           0305 00806000
*        I=I+1;                         /* UPDATE INDEX VALUE        */ 00807000
S20C03   LA    @12,1                                               0305 00808000
         LH    @10,I(,WAPTR)                                       0305 00809000
         N     @10,@CF00789                                        0305 00810000
         ALR   @12,@10                                             0305 00811000
         STH   @12,I(,WAPTR)                                       0305 00812000
*        RETR=RETSAV;                   /* RELOAD RETURN ADDRESS     */ 00813000
         L     RETR,RETSAV(,WAPTR)                                 0306 00814000
*        GEN  (BR R14);                 /* RETURN TO CALLER          */ 00815000
         BR R14                                                         00816000
*        GEN  (EJECT);                                             0308 00817000
         EJECT                                                          00818000
* /*******************************************************************/ 00819000
*/* S20CMLOC: THIS SUBROUTINE  LOCATES THE MSG BY DETERMINING WHICH  */ 00820000
*/* GROUP ITS IN (100-199,200-299,ETC) IT THEN CALL THAT MODULE PASS-*/ 00821000
*/* ING IT THE 'MSG#' IN '$BUFFER' (WITHIN RCA).                     */ 00822000
*/********************************************************************/ 00823000
*        GEN   (SPACE);                                            0309 00824000
         SPACE                                                          00825000
*S20CMLOC:                                                         0310 00826000
*        RETSAV=RETR;                   /* SAVE RETURN ADDR          */ 00827000
S20CMLOC ST    RETR,RETSAV(,WAPTR)                                 0310 00828000
*        MSGNUM=ZERO;                   /* ZERO OUT WORK AREA        */ 00829000
         L     @12,ZERO                                            0311 00830000
         ST    @12,MSGNUM(,WAPTR)                                  0311 00831000
*        MSGNUM(3:4)=MSG#;              /* SET UP MSG NO. FOR CALL   */ 00832000
         LH    @12,MSG#(,WAPTR)                                    0312 00833000
         N     @12,@CF00789                                        0312 00834000
         STCM  @12,3,MSGNUM+2(WAPTR)                               0312 00835000
*        IF MSG# >99 & MSG# <400 THEN   /* IF MSG# BETWEEN 99-400    */ 00836000
         C     @12,@CF00777                                        0313 00837000
         BNH   @RF00313                                            0313 00838000
         C     @12,@CF00778                                        0313 00839000
         BL    @RT00313                                            0313 00840000
*          GOTO CALL123;                /* GO CALL ISTEC123          */ 00841000
*        IF MSG# >399 & MSG# <700 THEN  /* IF MSG# BETWEEN 399-700   */ 00842000
@RF00313 CLC   MSG#(2,WAPTR),@CH00780                              0315 00843000
         BNH   @RF00315                                            0315 00844000
         CLC   MSG#(2,WAPTR),@CH00781                              0315 00845000
         BL    @RT00315                                            0315 00846000
*          GOTO CALL456;                /* GO CALL ISTEC456          */ 00847000
*        GEN(SPACE);                                               0317 00848000
@RF00315 DS    0H                                                  0317 00849000
         SPACE                                                          00850000
*        CALL  ISTEC789;                /* GO FIND MSG (700-999)     */ 00851000
         L     @15,@CV00137                                        0318 00852000
         BALR  @14,@15                                             0318 00853000
*        GOTO CALLRET;                                             0319 00854000
         B     CALLRET                                             0319 00855000
*CALL456:                                                          0320 00856000
*        CALL  ISTEC456;                /* GO FIND MSG (400-699)     */ 00857000
CALL456  L     @15,@CV00136                                        0320 00858000
         BALR  @14,@15                                             0320 00859000
*        GOTO CALLRET;                  /* RETURN TO TCEC            */ 00860000
         B     CALLRET                                             0321 00861000
*CALL123:                                                          0322 00862000
*        CALL  ISTEC123;                /* GO FIND MSG (100-399)     */ 00863000
CALL123  L     @15,@CV00135                                        0322 00864000
         BALR  @14,@15                                             0322 00865000
*CALLRET:                                                          0323 00866000
*        Y=$COUTCT(4:4);                /* PUT MSG LENGTH IN Y       */ 00867000
CALLRET  MVC   Y(1,WAPTR),$COUTCT+3(WAPTR)                         0323 00868000
*        MSGPTR=MSGNUM;                 /* GET PTR TO MSG TXT        */ 00869000
         L     MSGPTR,MSGNUM(,WAPTR)                               0324 00870000
*        RETR=RETSAV;                   /* RESTORE RETURN ADDR       */ 00871000
         L     RETR,RETSAV(,WAPTR)                                 0325 00872000
*        GEN   (BR RETR);               /* RETURN TO CALLER          */ 00873000
         BR RETR                                                        00874000
*        GEN   (EJECT);                                            0327 00875000
         EJECT                                                          00876000
*                                                                  0328 00877000
*         DO; /* ATDSPLY   */                                      0328 00878000
*                                                                  0329 00879000
*         END;/* ATDSPLY */                                        0329 00880000
*  END;                                                            0330 00881000
         B     @EL00001                                            0330 00882000
@DATA    DS    0H                                                       00883000
@CH00780 DC    H'399'                                                   00884000
@CH00781 DC    H'700'                                                   00885000
@SM00790 MVC   $WORK-1(0,@12),CEOUTMSG(@08)                             00886000
@SM00794 MVC   $WORK-1(0,@12),MSGDAT(MSGPTR)                            00887000
@SM00799 MVC   $WORK(0,@12),@TS00001                                    00888000
@SM00803 MVC   $WORK+1(0,WAPTR),@TS00001                                00889000
@SM00805 MVC   $WORK(0,WAPTR),ITA                                       00890000
@SM00807 MVC   $WORK(0,WAPTR),DOS2WAY                                   00891000
@SM00809 MVC   $WORK(0,WAPTR),DOS1WAY                                   00892000
@SM00811 MVC   $WORK(0,WAPTR),TWOWAY                                    00893000
@SM00813 MVC   $WORK(0,WAPTR),ONEWAY                                    00894000
         DS    0F                                                       00895000
         DS    0F                                                       00896000
@CF00103 DC    F'1'                                                     00897000
@CH00103 EQU   @CF00103+2                                               00898000
@CF00040 DC    F'8'                                                     00899000
@CF00729 DC    F'61'                                                    00900000
@CF00739 DC    F'81'                                                    00901000
@CF00777 DC    F'99'                                                    00902000
@CF00778 DC    F'400'                                                   00903000
@CF00789 DC    XL4'0000FFFF'                                            00904000
@CA00028 DC    A(ISTSC020)                                              00905000
@CV00132 DC    V(ISTCC011)                                              00906000
@CV00135 DC    V(ISTEC123)                                              00907000
@CV00136 DC    V(ISTEC456)                                              00908000
@CV00137 DC    V(ISTEC789)                                              00909000
@CV00745 DC    V(I00C1002)                                              00910000
         DS    0D                                                       00911000
X        DC    F'0'                                                     00912000
MB1      DC    F'0'                                                     00913000
MB2      DC    F'0'                                                     00914000
ZERO     DC    XL4'0'                                                   00915000
N        DC    AL2(100)                                                 00916000
@TS00001 DS    CL256                                                    00917000
@CB00770 DC    X'0000'                                                  00918000
ONEWAY   DC    CL8'ITA100I '                                            00919000
TWOWAY   DC    CL8'ITA101D '                                            00920000
ITA      DC    CL3'ITA'                                                 00921000
DOS1WAY  DC    CL6'F100I '                                              00922000
DOS2WAY  DC    CL6'F101D '                                              00923000
DOSPREFX DC    CL1'F'                                                   00924000
DOS87    DC    X'87'                                                    00925000
BLANK    DC    CL1' '                                                   00926000
RC08     DC    X'08'                                                    00927000
DELMTR   DC    CL1'%'                                                   00928000
LETTERI  DC    CL1'I'                                                   00929000
LETTERD  DC    CL1'D'                                                   00930000
SW037    DS    BL1                                                      00931000
         ORG   SW037                                                    00932000
CECOMSW  DS    BL1                                                      00933000
SPARESW  EQU   SW037+0                                                  00934000
         ORG   SW037+1                                                  00935000
MSKTBL   DC    XL1'80'                                                  00936000
         DC    XL1'40'                                                  00937000
         DC    XL1'20'                                                  00938000
         DC    XL1'10'                                                  00939000
         DC    XL1'08'                                                  00940000
         DC    XL1'04'                                                  00941000
         DC    XL1'02'                                                  00942000
         DC    XL1'01'                                                  00943000
         DS    8XL1                                                     00944000
         DS    CL1                                                      00945000
PATCH    DC    40F'0'                                                   00946000
@00      EQU   00                      EQUATES FOR REGISTERS 0-15       00947000
@01      EQU   01                                                       00948000
@02      EQU   02                                                       00949000
@03      EQU   03                                                       00950000
@04      EQU   04                                                       00951000
@05      EQU   05                                                       00952000
@06      EQU   06                                                       00953000
@07      EQU   07                                                       00954000
@08      EQU   08                                                       00955000
@09      EQU   09                                                       00956000
@10      EQU   10                                                       00957000
@11      EQU   11                                                       00958000
@12      EQU   12                                                       00959000
@13      EQU   13                                                       00960000
@14      EQU   14                                                       00961000
@15      EQU   15                                                       00962000
CECMAP   EQU   @04                                                      00963000
MSGPTR   EQU   @05                                                      00964000
R14      EQU   @14                                                      00965000
R15      EQU   @15                                                      00966000
R1       EQU   @01                                                      00967000
R4       EQU   @04                                                      00968000
RCAPTR   EQU   @03                                                      00969000
R13      EQU   @13                                                      00970000
RETR     EQU   @14                                                      00971000
WAPTR    EQU   @02                                                      00972000
TCECMAP  EQU   0                                                        00973000
$TCMSG#  EQU   TCECMAP                                                  00974000
$TCINCT  EQU   TCECMAP+4                                                00975000
$TCFLG   EQU   TCECMAP+8                                                00976000
$TCSUBDA EQU   $TCFLG                                                   00977000
$TC2WAY  EQU   $TCFLG                                                   00978000
$TCNOID  EQU   $TCFLG                                                   00979000
$TCLOCM  EQU   $TCFLG                                                   00980000
$TCWTO   EQU   $TCFLG                                                   00981000
$TCKABND EQU   $TCFLG                                                   00982000
$TCKIDON EQU   $TCFLG                                                   00983000
$TCMASK  EQU   TCECMAP+9                                                00984000
CEOUTMSG EQU   0                                                        00985000
BACKSAVE EQU   0                                                        00986000
MSGDAT   EQU   0                                                        00987000
$RCAAREA EQU   0                                                        00988000
$POINTER EQU   $RCAAREA+100                                             00989000
$TLTECB2 EQU   $POINTER+28                                              00990000
$TRTBLA  EQU   $POINTER+124                                             00991000
$CONSTNT EQU   $RCAAREA+244                                             00992000
$RCAFLG  EQU   $RCAAREA+604                                             00993000
TOLTEPWA EQU   0                                                        00994000
$SCTTBLE EQU   TOLTEPWA                                                 00995000
$TESTOPT EQU   $SCTTBLE+2                                               00996000
$ERROPT  EQU   $SCTTBLE+3                                               00997000
$DRIVER  EQU   $SCTTBLE+6                                               00998000
$PDEVFLG EQU   $SCTTBLE+10                                              00999000
$CDSFLGS EQU   $SCTTBLE+11                                              01000000
$CDS8T19 EQU   $SCTTBLE+20                                              01001000
$EXECFLG EQU   $SCTTBLE+33                                              01002000
$OLTFLGS EQU   $SCTTBLE+36                                              01003000
$OLTFLG2 EQU   $SCTTBLE+37                                              01004000
$TOTFLG1 EQU   $SCTTBLE+38                                              01005000
$ROUTMSK EQU   $SCTTBLE+40                                              01006000
#MSGIDAC EQU   $SCTTBLE+78                                              01007000
$CDA     EQU   TOLTEPWA+100                                             01008000
$RCA     EQU   $CDA+44                                                  01009000
$OLTPTR  EQU   $CDA+52                                                  01010000
$HIMOREC EQU   $CDA+60                                                  01011000
$COMMFLG EQU   TOLTEPWA+224                                             01012000
$FLAG1   EQU   $COMMFLG                                                 01013000
$CNSLFG  EQU   $FLAG1                                                   01014000
$FLAG2   EQU   $COMMFLG+1                                               01015000
$FLAG3   EQU   $COMMFLG+2                                               01016000
$FLAG4   EQU   $COMMFLG+3                                               01017000
$FLAG5   EQU   $COMMFLG+4                                               01018000
$EOJ     EQU   $FLAG5                                                   01019000
$CANCEL  EQU   $EOJ                                                     01020000
$FLAG6   EQU   $COMMFLG+5                                               01021000
$ABNDBIT EQU   $FLAG6                                                   01022000
$ABTERM  EQU   $ABNDBIT                                                 01023000
$FLAG7   EQU   $COMMFLG+6                                               01024000
$FLAG8   EQU   $COMMFLG+7                                               01025000
$TCECM   EQU   $FLAG8                                                   01026000
$FLAG9   EQU   $COMMFLG+8                                               01027000
$MULLNSW EQU   $FLAG9                                                   01028000
$LSTLNSW EQU   $FLAG9                                                   01029000
$FLAG10  EQU   $COMMFLG+9                                               01030000
$FLAG11  EQU   $COMMFLG+10                                              01031000
$FLAG12  EQU   $COMMFLG+11                                              01032000
$POSTFLG EQU   $FLAG12                                                  01033000
$FLAG13  EQU   $COMMFLG+12                                              01034000
$DEVTBLE EQU   TOLTEPWA+240                                             01035000
$DEVCDS  EQU   $DEVTBLE                                                 01036000
$DEVUNAD EQU   $DEVCDS                                                  01037000
@NM00044 EQU   $DEVUNAD+2                                               01038000
$DEVFEAT EQU   $DEVCDS+4                                                01039000
$DEVCDSF EQU   $DEVCDS+9                                                01040000
$DEVSDCF EQU   $DEVCDS+10                                               01041000
$$SYMNME EQU   $DEVCDS+12                                               01042000
$DEVFLG1 EQU   $DEVTBLE+20                                              01043000
$EVNCPLT EQU   $DEVFLG1                                                 01044000
$ATTNEXP EQU   $DEVFLG1                                                 01045000
$INTOCC  EQU   $DEVFLG1                                                 01046000
$DEVFLG2 EQU   $DEVTBLE+21                                              01047000
$DEVTECB EQU   $DEVTBLE+22                                              01048000
$OPIS    EQU   $DEVTECB                                                 01049000
$OPND    EQU   $DEVTECB+2                                               01050000
$DEVFLG3 EQU   $DEVTBLE+27                                              01051000
$SIOFLG  EQU   $DEVFLG3                                                 01052000
$IFTOUT  EQU   $DEVTBLE+36                                              01053000
$DEVSESP EQU   $IFTOUT                                                  01054000
$SSCPDAF EQU   $IFTOUT+6                                                01055000
$LDNCBPT EQU   $DEVTBLE+48                                              01056000
$RNINFO  EQU   $DEVTBLE+56                                              01057000
$DEVFLG5 EQU   $RNINFO+8                                                01058000
$DEVFLG4 EQU   $DEVTBLE+65                                              01059000
$SLTBL   EQU   TOLTEPWA+1468                                            01060000
$RUNTEST EQU   $SLTBL+13                                                01061000
$TESTFLG EQU   $SLTBL+21                                                01062000
$SECLST  EQU   $SLTBL+22                                                01063000
$BUFFER  EQU   TOLTEPWA+1976                                            01064000
$INBUFR  EQU   TOLTEPWA+2104                                            01065000
$WORK    EQU   TOLTEPWA+2376                                            01066000
#EXITA   EQU   TOLTEPWA+2632                                            01067000
$CCOMDAT EQU   TOLTEPWA+2644                                            01068000
$COUTAD  EQU   $CCOMDAT                                                 01069000
$COUTCT  EQU   $CCOMDAT+4                                               01070000
$CINADR  EQU   $CCOMDAT+8                                               01071000
$CINCT   EQU   $CCOMDAT+12                                              01072000
$CFLGS   EQU   $CCOMDAT+16                                              01073000
$C2WAY   EQU   $CFLGS                                                   01074000
$24FEMSG EQU   TOLTEPWA+2681                                            01075000
$24CATMG EQU   $24FEMSG+11                                              01076000
@NM00053 EQU   TOLTEPWA+2776                                            01077000
$OUNTPTR EQU   @NM00053+4                                               01078000
$NSPTR   EQU   $OUNTPTR                                                 01079000
$NSCNT   EQU   @NM00053+10                                              01080000
$ENXX    EQU   @NM00053+15                                              01081000
$IMITX   EQU   $ENXX                                                    01082000
SVESC033 EQU   TOLTEPWA+3160                                            01083000
SVECC013 EQU   TOLTEPWA+3232                                            01084000
SVESC120 EQU   TOLTEPWA+3304                                            01085000
SVEIC003 EQU   TOLTEPWA+3592                                            01086000
SVESC020 EQU   TOLTEPWA+3664                                            01087000
SVESC022 EQU   TOLTEPWA+3736                                            01088000
SVECC011 EQU   TOLTEPWA+4024                                            01089000
#EXIT    EQU   0                                                        01090000
CECOMMAP EQU   0                                                        01091000
$CEOUTAD EQU   CECOMMAP+4                                               01092000
$CEOUTCT EQU   CECOMMAP+8                                               01093000
$CEINADR EQU   CECOMMAP+12                                              01094000
$CEINCT  EQU   CECOMMAP+16                                              01095000
$TRTBL   EQU   0                                                        01096000
@NM00001 EQU   $BUFFER                                                  01097000
MSGNUM   EQU   @NM00001                                                 01098000
RETSAV   EQU   @NM00001+4                                               01099000
PTRSAV   EQU   @NM00001+8                                               01100000
CNTSAV   EQU   @NM00001+12                                              01101000
MMSG#    EQU   @NM00001+16                                              01102000
MSG#     EQU   @NM00001+20                                              01103000
I        EQU   @NM00001+22                                              01104000
SUBINDX  EQU   @NM00001+24                                              01105000
MSKBIT   EQU   @NM00001+26                                              01106000
Y        EQU   @NM00001+27                                              01107000
MYPARM   EQU   @NM00001+28                                              01108000
SVECC012 EQU   SVESC022                                                 01109000
SVEIC00A EQU   SVEIC003                                                 01110000
SVEIC004 EQU   SVEIC003                                                 01111000
SVEIC005 EQU   SVEIC003                                                 01112000
SVESC02A EQU   SVESC022                                                 01113000
SVESC02B EQU   SVESC022                                                 01114000
SVESC02D EQU   SVESC022                                                 01115000
SVESC02E EQU   SVESC022                                                 01116000
SVESC02F EQU   SVECC013                                                 01117000
SVESC024 EQU   SVESC022                                                 01118000
SVESC027 EQU   SVESC022                                                 01119000
SVESC029 EQU   SVESC033                                                 01120000
SVESC031 EQU   SVECC013                                                 01121000
SVESC032 EQU   SVECC011                                                 01122000
SVETC037 EQU   SVEIC003                                                 01123000
         AGO   .@UNREFD                START UNREFERENCED COMPONENTS    01124000
@NM00004 EQU   MYPARM+8                                                 01125000
@NM00003 EQU   MYPARM+4                                                 01126000
@NM00002 EQU   MYPARM                                                   01127000
$CECFLAG EQU   CECOMMAP+20                                              01128000
$CECIDNT EQU   CECOMMAP+2                                               01129000
$CECLEVL EQU   CECOMMAP+1                                               01130000
$CECTRMG EQU   CECOMMAP                                                 01131000
SVECC010 EQU   TOLTEPWA+3952                                            01132000
SVETC035 EQU   TOLTEPWA+3880                                            01133000
SVESC030 EQU   TOLTEPWA+3808                                            01134000
SVEIC002 EQU   TOLTEPWA+3520                                            01135000
SVECC014 EQU   TOLTEPWA+3376                                            01136000
SVESC025 EQU   TOLTEPWA+3088                                            01137000
@NM00055 EQU   TOLTEPWA+2980                                            01138000
$RPLERR  EQU   TOLTEPWA+2977                                            01139000
@NM00054 EQU   TOLTEPWA+2976                                            01140000
$R13PR3  EQU   TOLTEPWA+2972                                            01141000
$CEINT2  EQU   TOLTEPWA+2968                                            01142000
$CEINT1  EQU   TOLTEPWA+2964                                            01143000
$MSGGET  EQU   TOLTEPWA+2960                                            01144000
$ACQLIST EQU   TOLTEPWA+2956                                            01145000
$R4SAVE1 EQU   TOLTEPWA+2952                                            01146000
$CLSISS  EQU   TOLTEPWA+2950                                            01147000
$CLSCNT  EQU   TOLTEPWA+2948                                            01148000
$CUTABLE EQU   TOLTEPWA+2868                                            01149000
$BUFSZ2  EQU   TOLTEPWA+2864                                            01150000
$RESID2  EQU   TOLTEPWA+2860                                            01151000
$OLTCCW2 EQU   TOLTEPWA+2856                                            01152000
$ENDBFR2 EQU   TOLTEPWA+2852                                            01153000
$1STBFR2 EQU   TOLTEPWA+2848                                            01154000
$TECB2   EQU   TOLTEPWA+2844                                            01155000
$BUFSZ1  EQU   TOLTEPWA+2840                                            01156000
$RESID1  EQU   TOLTEPWA+2836                                            01157000
$OLTCCW1 EQU   TOLTEPWA+2832                                            01158000
$ENDBFR1 EQU   TOLTEPWA+2828                                            01159000
$1STBFR1 EQU   TOLTEPWA+2824                                            01160000
$TECB1   EQU   TOLTEPWA+2820                                            01161000
$WAITIME EQU   TOLTEPWA+2816                                            01162000
$TRTN#   EQU   TOLTEPWA+2815                                            01163000
$WIODEV  EQU   TOLTEPWA+2814                                            01164000
$RQSTSZE EQU   TOLTEPWA+2812                                            01165000
$RQSTPTR EQU   TOLTEPWA+2808                                            01166000
$R4SAVE  EQU   TOLTEPWA+2804                                            01167000
$PARTADR EQU   TOLTEPWA+2800                                            01168000
$TBSDATA EQU   TOLTEPWA+2796                                            01169000
$CTWIDTH EQU   TOLTEPWA+2795                                            01170000
$CTLINE  EQU   TOLTEPWA+2794                                            01171000
$APWIDTH EQU   TOLTEPWA+2793                                            01172000
$APLINE  EQU   TOLTEPWA+2792                                            01173000
$INDEX   EQU   $IMITX                                                   01174000
$UMXX    EQU   @NM00053+14                                              01175000
$NSXX    EQU   @NM00053+12                                              01176000
$ATACNT  EQU   $NSCNT                                                   01177000
$CTR     EQU   @NM00053+8                                               01178000
$ATAPTR  EQU   $NSPTR                                                   01179000
$DDRPTR  EQU   @NM00053                                                 01180000
$DTORESP EQU   TOLTEPWA+2712                                            01181000
$APNAME  EQU   TOLTEPWA+2704                                            01182000
$24SYMNE EQU   $24CATMG+4                                               01183000
$24DEVAD EQU   $24CATMG                                                 01184000
$24RTN#  EQU   $24FEMSG+8                                               01185000
$ESECTID EQU   $24FEMSG                                                 01186000
$24FLGS  EQU   TOLTEPWA+2680                                            01187000
$24SAVE2 EQU   TOLTEPWA+2676                                            01188000
$24SAVE1 EQU   TOLTEPWA+2672                                            01189000
$24UNADR EQU   TOLTEPWA+2668                                            01190000
$24SAV13 EQU   TOLTEPWA+2664                                            01191000
$24RETCD EQU   TOLTEPWA+2663                                            01192000
$MACID   EQU   TOLTEPWA+2661                                            01193000
$CSPARE  EQU   $CFLGS                                                   01194000
ROOTLOC  EQU   TOLTEPWA+2640                                            01195000
$RETREG  EQU   TOLTEPWA+2636                                            01196000
$EXTA    EQU   TOLTEPWA+2320                                            01197000
$PASSONA EQU   TOLTEPWA+2264                                            01198000
$TRMINPT EQU   TOLTEPWA+2184                                            01199000
$TLTRPL3 EQU   TOLTEPWA+1856                                            01200000
$TLTRPL2 EQU   TOLTEPWA+1736                                            01201000
$TLTRPL1 EQU   TOLTEPWA+1616                                            01202000
@NM00052 EQU   $SLTBL+135                                               01203000
$HIGHRTN EQU   $SLTBL+134                                               01204000
$PRIMADR EQU   $SLTBL+130                                               01205000
$CTSTPT  EQU   $SLTBL+128                                               01206000
$TSTCNT  EQU   $SLTBL+126                                               01207000
$SECFLGS EQU   $SECLST+3                                                01208000
$SECTION EQU   $SECLST                                                  01209000
$SECACT  EQU   $TESTFLG                                                 01210000
$CANTRUN EQU   $TESTFLG                                                 01211000
$FINAL   EQU   $TESTFLG                                                 01212000
$TESTSUF EQU   $RUNTEST+5                                               01213000
$TESTNUM EQU   $RUNTEST+1                                               01214000
$LETPRF  EQU   $RUNTEST                                                 01215000
$SYMBOLC EQU   $SLTBL+5                                                 01216000
$FAMILY  EQU   $SLTBL                                                   01217000
$CDEVPT  EQU   TOLTEPWA+1466                                            01218000
$DEVCNTS EQU   TOLTEPWA+1464                                            01219000
$FEEDBCK EQU   $DEVTBLE+66                                              01220000
$WTISUED EQU   $DEVFLG4                                                 01221000
$EXIOISD EQU   $DEVFLG4                                                 01222000
$REMWRIT EQU   $DEVFLG4                                                 01223000
$REMDONE EQU   $DEVFLG4                                                 01224000
$2NDUSED EQU   $DEVFLG4                                                 01225000
$1STUSED EQU   $DEVFLG4                                                 01226000
$IGLXIFB EQU   $DEVFLG4                                                 01227000
$EXIOLV3 EQU   $DEVFLG4                                                 01228000
@NM00051 EQU   $DEVFLG5                                                 01229000
$DVBASIC EQU   $DEVFLG5                                                 01230000
$ASCII   EQU   $DEVFLG5                                                 01231000
$DEVLU   EQU   $DEVFLG5                                                 01232000
$OPNDFAL EQU   $DEVFLG5                                                 01233000
$ACQNCB  EQU   $DEVFLG5                                                 01234000
$REMOTE  EQU   $DEVFLG5                                                 01235000
$ENDNODE EQU   $DEVFLG5                                                 01236000
$LINENME EQU   $RNINFO                                                  01237000
$CID     EQU   $DEVTBLE+52                                              01238000
$DVCOL   EQU   $LDNCBPT+2                                               01239000
$DVROW   EQU   $LDNCBPT                                                 01240000
$NCSPLP  EQU   $DEVTBLE+44                                              01241000
$DVLN    EQU   $SSCPDAF                                                 01242000
$DAF     EQU   $DEVSESP+4                                               01243000
$VARYPAB EQU   $DEVSESP                                                 01244000
$SYSMN   EQU   $DEVTBLE+28                                              01245000
@NM00050 EQU   $DEVFLG3                                                 01246000
$CLRSNT  EQU   $DEVFLG3                                                 01247000
$OLTERR  EQU   $DEVFLG3                                                 01248000
$SRTEST  EQU   $DEVFLG3                                                 01249000
$DVSNDOK EQU   $SIOFLG                                                  01250000
$POLLREQ EQU   $DEVFLG3                                                 01251000
$ACQRED  EQU   $DEVFLG3                                                 01252000
$NOTDEV  EQU   $DEVFLG3                                                 01253000
$DVINCT  EQU   $DEVTBLE+26                                              01254000
$DVBRKST EQU   $OPND+1                                                  01255000
$DVBRKSN EQU   $OPND                                                    01256000
$DVSEQNO EQU   $OPIS                                                    01257000
$CEINTRP EQU   $DEVFLG2                                                 01258000
$TESTMDE EQU   $DEVFLG2                                                 01259000
$DEVALOC EQU   $DEVFLG2                                                 01260000
$ALLDATA EQU   $DEVFLG2                                                 01261000
$ENDCNTL EQU   $DEVFLG2                                                 01262000
$CTLDEV  EQU   $DEVFLG2                                                 01263000
$NOCDS   EQU   $DEVFLG2                                                 01264000
$DATAIN  EQU   $DEVFLG2                                                 01265000
$PRIMARY EQU   $DEVFLG1                                                 01266000
$DVCTBYT EQU   $INTOCC                                                  01267000
$DEVACT  EQU   $DEVFLG1                                                 01268000
$DVLGMDE EQU   $ATTNEXP                                                 01269000
$DVSPRM  EQU   $EVNCPLT                                                 01270000
$GRABBED EQU   $DEVFLG1                                                 01271000
$CATASTR EQU   $DEVFLG1                                                 01272000
$LETGO   EQU   $DEVFLG1                                                 01273000
$CURELEM EQU   $$SYMNME+4                                               01274000
$MSGOTSD EQU   $$SYMNME                                                 01275000
$EXTDEV  EQU   $DEVCDS+11                                               01276000
@NM00049 EQU   $DEVSDCF                                                 01277000
$NOTPRIM EQU   $DEVSDCF                                                 01278000
@NM00048 EQU   $DEVCDSF                                                 01279000
@NM00047 EQU   $DEVCDSF                                                 01280000
@NM00046 EQU   $DEVCDSF                                                 01281000
$CDSNAME EQU   $DEVCDSF                                                 01282000
$EXTRN   EQU   $DEVCDSF                                                 01283000
$CEVOLUM EQU   $DEVCDSF                                                 01284000
$SHARD   EQU   $DEVCDSF                                                 01285000
$DEVFPM  EQU   $DEVCDSF                                                 01286000
$DEVCNT  EQU   $DEVCDS+8                                                01287000
$DEVTYPE EQU   $DEVFEAT+3                                               01288000
$DEVCLAS EQU   $DEVFEAT+2                                               01289000
$DEVFRRS EQU   $DEVFEAT+1                                               01290000
$DEVMOD  EQU   $DEVFEAT                                                 01291000
$DEVRDGT EQU   @NM00044+1                                               01292000
$DEVCTLU EQU   @NM00044+1                                               01293000
$DEVCHAN EQU   @NM00044                                                 01294000
@NM00045 EQU   @NM00044                                                 01295000
$CTINDX  EQU   $DEVUNAD                                                 01296000
$FLAG16  EQU   $COMMFLG+15                                              01297000
$FLAG15  EQU   $COMMFLG+14                                              01298000
$FLAG14  EQU   $COMMFLG+13                                              01299000
$TEP2ND  EQU   $FLAG13                                                  01300000
$TEP1ST  EQU   $FLAG13                                                  01301000
$CATMSG  EQU   $FLAG13                                                  01302000
$PRMPTSW EQU   $FLAG13                                                  01303000
$DEVENT  EQU   $FLAG13                                                  01304000
$OLTMACC EQU   $FLAG13                                                  01305000
$LGON    EQU   $FLAG13                                                  01306000
$CTLOGON EQU   $FLAG13                                                  01307000
@NM00043 EQU   $FLAG12                                                  01308000
$VARYINP EQU   $FLAG12                                                  01309000
$ENDTEST EQU   $FLAG12                                                  01310000
$VRYHRD  EQU   $FLAG12                                                  01311000
$VRYSFT  EQU   $FLAG12                                                  01312000
$OPTMSG  EQU   $FLAG12                                                  01313000
$FEORCAT EQU   $FLAG11                                                  01314000
@NM00042 EQU   $FLAG11                                                  01315000
@NM00041 EQU   $FLAG10                                                  01316000
$INBND   EQU   $FLAG10                                                  01317000
$WAITFLG EQU   $FLAG10                                                  01318000
$DPRINT  EQU   $FLAG10                                                  01319000
$HOLD    EQU   $FLAG9                                                   01320000
$NOTRRCH EQU   $FLAG9                                                   01321000
@NM00040 EQU   $FLAG9                                                   01322000
$COPY    EQU   $FLAG9                                                   01323000
$REMSW   EQU   $FLAG9                                                   01324000
$IGRES   EQU   $FLAG9                                                   01325000
$VS2     EQU   $FLAG8                                                   01326000
$VS1     EQU   $FLAG8                                                   01327000
$EDOS    EQU   $FLAG8                                                   01328000
@NM00039 EQU   $FLAG8                                                   01329000
$TWOWAY  EQU   $FLAG8                                                   01330000
@NM00038 EQU   $FLAG8                                                   01331000
$RCVMSG  EQU   $FLAG7                                                   01332000
$RCVRFLG EQU   $FLAG7                                                   01333000
$SNDRFLG EQU   $FLAG7                                                   01334000
$LDOIS   EQU   $FLAG7                                                   01335000
$DCONTCT EQU   $FLAG7                                                   01336000
$EXIOWAT EQU   $FLAG7                                                   01337000
$2NDDATA EQU   $FLAG7                                                   01338000
$1STDATA EQU   $FLAG7                                                   01339000
$CIREQ   EQU   $FLAG6                                                   01340000
$FSTMCIS EQU   $FLAG6                                                   01341000
$DISCREQ EQU   $FLAG6                                                   01342000
$DISCISS EQU   $FLAG6                                                   01343000
$CHANGE  EQU   $FLAG6                                                   01344000
$CTERROR EQU   $FLAG6                                                   01345000
$RECAL11 EQU   $FLAG6                                                   01346000
@NM00037 EQU   $FLAG5                                                   01347000
$PROGCK  EQU   $CANCEL                                                  01348000
$PRINTAP EQU   $FLAG5                                                   01349000
@NM00036 EQU   $FLAG5                                                   01350000
$MSG922  EQU   $FLAG5                                                   01351000
$CT924   EQU   $FLAG5                                                   01352000
$FSTCAT  EQU   $FLAG5                                                   01353000
$FSTFE   EQU   $FLAG5                                                   01354000
$ACTOPND EQU   $FLAG4                                                   01355000
$ACQCUTT EQU   $FLAG4                                                   01356000
$CLSSACT EQU   $FLAG4                                                   01357000
$BACKINT EQU   $FLAG4                                                   01358000
$DMSGSW  EQU   $FLAG4                                                   01359000
$TSTDEVP EQU   $FLAG4                                                   01360000
$APRQPER EQU   $FLAG4                                                   01361000
$OPCOM   EQU   $FLAG4                                                   01362000
$NEWAP   EQU   $FLAG3                                                   01363000
$ALTPRTR EQU   $FLAG3                                                   01364000
$OPTERR  EQU   $FLAG3                                                   01365000
$PRTONLY EQU   $FLAG3                                                   01366000
$REQSTOR EQU   $FLAG3                                                   01367000
$LOGOFFE EQU   $FLAG3                                                   01368000
$TSTERR  EQU   $FLAG3                                                   01369000
$DEVERR  EQU   $FLAG3                                                   01370000
$PARTIAL EQU   $FLAG2                                                   01371000
$NRMTERM EQU   $FLAG2                                                   01372000
$VALDTST EQU   $FLAG2                                                   01373000
$VALDDEV EQU   $FLAG2                                                   01374000
$DBLSLSH EQU   $FLAG2                                                   01375000
$NDR     EQU   $FLAG2                                                   01376000
@NM00035 EQU   $FLAG2                                                   01377000
$OLTACT  EQU   $FLAG1                                                   01378000
$NORELDV EQU   $FLAG1                                                   01379000
@NM00034 EQU   $FLAG1                                                   01380000
$OPTCHNG EQU   $FLAG1                                                   01381000
$DEVCHNG EQU   $FLAG1                                                   01382000
$TESTCNG EQU   $FLAG1                                                   01383000
$TEP3RD  EQU   $FLAG1                                                   01384000
@NM00033 EQU   $CDA+120                                                 01385000
$CUCNT   EQU   $CDA+118                                                 01386000
@NM00032 EQU   $CDA+117                                                 01387000
$PRTFORM EQU   $CDA+116                                                 01388000
$OPISCNT EQU   $CDA+114                                                 01389000
$OPNDCNT EQU   $CDA+112                                                 01390000
$GETMSZE EQU   $CDA+110                                                 01391000
$GRCNTS  EQU   $CDA+108                                                 01392000
$CTLCNT  EQU   $CDA+106                                                 01393000
$ACTLVL  EQU   $CDA+105                                                 01394000
$PRNTLVL EQU   $CDA+104                                                 01395000
$ERRCNTA EQU   $CDA+102                                                 01396000
$TLCNT   EQU   $CDA+100                                                 01397000
$TIMEALW EQU   $CDA+96                                                  01398000
$PTRAREA EQU   $CDA+92                                                  01399000
$GETMPTR EQU   $CDA+88                                                  01400000
$R13PTRT EQU   $CDA+84                                                  01401000
$R13PTR  EQU   $CDA+80                                                  01402000
$TEPEND  EQU   $CDA+76                                                  01403000
$PLINKDL EQU   $CDA+72                                                  01404000
$TEPBEGN EQU   $CDA+68                                                  01405000
$FRELPTR EQU   $CDA+64                                                  01406000
$HIGHADR EQU   $HIMOREC                                                 01407000
$LOMOREC EQU   $CDA+56                                                  01408000
$LOWADDR EQU   $OLTPTR                                                  01409000
$ENDCOMM EQU   $CDA+48                                                  01410000
$COMMON  EQU   $RCA                                                     01411000
$SLASHAD EQU   $CDA+32                                                  01412000
$PASSON  EQU   $CDA+28                                                  01413000
$TOLBRTB EQU   $CDA+24                                                  01414000
$SCTPTR8 EQU   $CDA+20                                                  01415000
$SCTPTR  EQU   $CDA+16                                                  01416000
$TBWDPTR EQU   $CDA+12                                                  01417000
$TFWDPTR EQU   $CDA+8                                                   01418000
@NM00031 EQU   $CDA                                                     01419000
@NM00030 EQU   $SCTTBLE+98                                              01420000
$SCTLWTC EQU   $SCTTBLE+96                                              01421000
$SCTLWTA EQU   $SCTTBLE+92                                              01422000
#EXT     EQU   $SCTTBLE+88                                              01423000
#PASS    EQU   $SCTTBLE+84                                              01424000
#TABLE   EQU   $SCTTBLE+80                                              01425000
@NM00029 EQU   $SCTTBLE+71                                              01426000
$RETMASK EQU   $SCTTBLE+70                                              01427000
$R249255 EQU   $ROUTMSK+29                                              01428000
$R241248 EQU   $ROUTMSK+28                                              01429000
$R233240 EQU   $ROUTMSK+27                                              01430000
$R225232 EQU   $ROUTMSK+26                                              01431000
$R217224 EQU   $ROUTMSK+25                                              01432000
$R209216 EQU   $ROUTMSK+24                                              01433000
$R201208 EQU   $ROUTMSK+23                                              01434000
$R193200 EQU   $ROUTMSK+22                                              01435000
$R185192 EQU   $ROUTMSK+21                                              01436000
$R177184 EQU   $ROUTMSK+20                                              01437000
$R169176 EQU   $ROUTMSK+19                                              01438000
$R161168 EQU   $ROUTMSK+18                                              01439000
$R153160 EQU   $ROUTMSK+17                                              01440000
$R145152 EQU   $ROUTMSK+16                                              01441000
$R137144 EQU   $ROUTMSK+15                                              01442000
$R129136 EQU   $ROUTMSK+14                                              01443000
$R121128 EQU   $ROUTMSK+13                                              01444000
$R113120 EQU   $ROUTMSK+12                                              01445000
$R105112 EQU   $ROUTMSK+11                                              01446000
$R097104 EQU   $ROUTMSK+10                                              01447000
$R089096 EQU   $ROUTMSK+9                                               01448000
$R081088 EQU   $ROUTMSK+8                                               01449000
$R073080 EQU   $ROUTMSK+7                                               01450000
$R065072 EQU   $ROUTMSK+6                                               01451000
$R057064 EQU   $ROUTMSK+5                                               01452000
$R049056 EQU   $ROUTMSK+4                                               01453000
$R041048 EQU   $ROUTMSK+3                                               01454000
$R033040 EQU   $ROUTMSK+2                                               01455000
$R025032 EQU   $ROUTMSK+1                                               01456000
$R017024 EQU   $ROUTMSK                                                 01457000
$TOTFLG2 EQU   $SCTTBLE+39                                              01458000
@NM00028 EQU   $TOTFLG1                                                 01459000
@NM00027 EQU   $TOTFLG1                                                 01460000
@NM00026 EQU   $TOTFLG1                                                 01461000
$CURELOD EQU   $TOTFLG1                                                 01462000
$CTEQTT  EQU   $TOTFLG1                                                 01463000
@NM00025 EQU   $TOTFLG1                                                 01464000
@NM00024 EQU   $TOTFLG1                                                 01465000
$LINESHR EQU   $TOTFLG1                                                 01466000
@NM00023 EQU   $OLTFLG2                                                 01467000
@NM00022 EQU   $OLTFLG2                                                 01468000
@NM00021 EQU   $OLTFLG2                                                 01469000
@NM00020 EQU   $OLTFLG2                                                 01470000
@NM00019 EQU   $OLTFLG2                                                 01471000
@NM00018 EQU   $OLTFLG2                                                 01472000
@NM00017 EQU   $OLTFLG2                                                 01473000
$TALK    EQU   $OLTFLG2                                                 01474000
$DYCOM   EQU   $OLTFLGS                                                 01475000
@NM00016 EQU   $OLTFLGS                                                 01476000
$TRACE   EQU   $OLTFLGS                                                 01477000
$RETCODE EQU   $OLTFLGS                                                 01478000
$CONTCB  EQU   $OLTFLGS                                                 01479000
$RETAIN  EQU   $OLTFLGS                                                 01480000
$CLEANRT EQU   $OLTFLGS                                                 01481000
$MANINTV EQU   $OLTFLGS                                                 01482000
$OLTSIZE EQU   $SCTTBLE+34                                              01483000
$QSCTMOD EQU   $EXECFLG                                                 01484000
$CTRLMOD EQU   $EXECFLG                                                 01485000
$CLEANUP EQU   $EXECFLG                                                 01486000
$LSTPDEV EQU   $EXECFLG                                                 01487000
$ERRCNT  EQU   $EXECFLG                                                 01488000
$RTNSLCT EQU   $EXECFLG                                                 01489000
$MULTDEV EQU   $EXECFLG                                                 01490000
@NM00015 EQU   $EXECFLG                                                 01491000
$RMSKCNT EQU   $SCTTBLE+32                                              01492000
$SYNAME  EQU   $CDS8T19+4                                               01493000
$EXTSIG  EQU   $CDS8T19+3                                               01494000
$CDFLGS  EQU   $CDS8T19+1                                               01495000
$CDSCNT  EQU   $CDS8T19                                                 01496000
$PDEVDSC EQU   $SCTTBLE+16                                              01497000
$PDEVADR EQU   $SCTTBLE+12                                              01498000
$COMMCN  EQU   $CDSFLGS                                                 01499000
$CUSTSYM EQU   $CDSFLGS                                                 01500000
$TWOCHSW EQU   $CDSFLGS                                                 01501000
$SYMNAME EQU   $CDSFLGS                                                 01502000
$EXTINTC EQU   $CDSFLGS                                                 01503000
$CEVOL   EQU   $CDSFLGS                                                 01504000
$SHARED  EQU   $CDSFLGS                                                 01505000
$FPM     EQU   $CDSFLGS                                                 01506000
$LASTSUB EQU   $PDEVFLG                                                 01507000
@NM00014 EQU   $PDEVFLG                                                 01508000
@NM00013 EQU   $PDEVFLG                                                 01509000
@NM00012 EQU   $PDEVFLG                                                 01510000
$LASTDEV EQU   $PDEVFLG                                                 01511000
@NM00011 EQU   $PDEVFLG                                                 01512000
$EXFILPT EQU   $PDEVFLG                                                 01513000
$FPMOLD  EQU   $PDEVFLG                                                 01514000
$TSSSYM  EQU   $SCTTBLE+8                                               01515000
$SCTLEVL EQU   $SCTTBLE+7                                               01516000
$RT0916  EQU   $SCTTBLE+5                                               01517000
$RT0108  EQU   $SCTTBLE+4                                               01518000
$LOOPTST EQU   $ERROPT                                                  01519000
$LOOPERR EQU   $ERROPT                                                  01520000
$NERRPRT EQU   $ERROPT                                                  01521000
$NOCNTRL EQU   $ERROPT                                                  01522000
$ALTPRNT EQU   $ERROPT                                                  01523000
$CATERR  EQU   $ERROPT                                                  01524000
$ASTERIK EQU   $ERROPT                                                  01525000
$TESTERR EQU   $ERROPT                                                  01526000
$FSTCOMM EQU   $TESTOPT                                                 01527000
$INDEFLP EQU   $TESTOPT                                                 01528000
$NOPRT   EQU   $TESTOPT                                                 01529000
$PARAPRT EQU   $TESTOPT                                                 01530000
@NM00010 EQU   $TESTOPT                                                 01531000
$ERRLPCT EQU   $SCTTBLE                                                 01532000
$TLTEND  EQU   $RCAAREA+945                                             01533000
$CNSLID  EQU   $RCAAREA+936                                             01534000
$EXITSAV EQU   $RCAAREA+864                                             01535000
$TRASCII EQU   $RCAAREA+608                                             01536000
@NM00009 EQU   $RCAAREA+605                                             01537000
$VTAMEND EQU   $RCAFLG                                                  01538000
$TPPOSTD EQU   $RCAFLG                                                  01539000
$NEWCT   EQU   $RCAFLG                                                  01540000
$ABNDALL EQU   $RCAFLG                                                  01541000
$CUTESTB EQU   $RCAFLG                                                  01542000
$CONSOLE EQU   $RCAFLG                                                  01543000
$TPLOGON EQU   $RCAFLG                                                  01544000
$UPDATE  EQU   $RCAFLG                                                  01545000
$DEVAREA EQU   $RCAAREA+600                                             01546000
$CTDVAR  EQU   $RCAAREA+596                                             01547000
$BUFFS   EQU   $RCAAREA+464                                             01548000
$TLTNIB  EQU   $CONSTNT+140                                             01549000
$TLTPRPL EQU   $CONSTNT+20                                              01550000
@NM00008 EQU   $CONSTNT+4                                               01551000
@NM00007 EQU   $CONSTNT+2                                               01552000
$USECNT  EQU   $CONSTNT                                                 01553000
$CURRTWA EQU   $POINTER+140                                             01554000
$CTNAME  EQU   $POINTER+132                                             01555000
$CTARGX  EQU   $POINTER+128                                             01556000
$COMINT  EQU   $POINTER+120                                             01557000
$QUEHNDL EQU   $POINTER+116                                             01558000
@NM00006 EQU   $POINTER+36                                              01559000
$RTNPTR  EQU   $POINTER+32                                              01560000
$TLTECB1 EQU   $POINTER+24                                              01561000
$CLEANP  EQU   $POINTER+20                                              01562000
$ABEND   EQU   $POINTER+16                                              01563000
$LSTAREA EQU   $POINTER+12                                              01564000
$FSTAREA EQU   $POINTER+8                                               01565000
$CVTSAVE EQU   $POINTER+4                                               01566000
$TOLTEP  EQU   $POINTER                                                 01567000
$TLTACB  EQU   $RCAAREA                                                 01568000
@NM00005 EQU   $TCFLG                                                   01569000
.@UNREFD ANOP                          END UNREFERENCED COMPONENTS      01570000
@RT00070 EQU   S20CEC2                                                  01571000
@RF00070 EQU   S20CEC1                                                  01572000
@RT00077 EQU   S20CRC08                                                 01573000
@RT00079 EQU   S20CRC08                                                 01574000
@RT00088 EQU   S20CRC08                                                 01575000
@RT00102 EQU   S20CEC2A                                                 01576000
@RT00111 EQU   S20CEC2A                                                 01577000
@RT00122 EQU   S20CEC2B                                                 01578000
@RF00136 EQU   S20CEC2D                                                 01579000
@RF00168 EQU   S20CEXIT                                                 01580000
@RT00208 EQU   S20CEC3C                                                 01581000
@RT00214 EQU   S20CEC3A                                                 01582000
@RF00214 EQU   S20CEC3H                                                 01583000
@RT00239 EQU   S20CEC3D                                                 01584000
@RT00248 EQU   S20CEC3H                                                 01585000
@RT00250 EQU   S20CEC3B                                                 01586000
@RT00257 EQU   S20C03                                                   01587000
@RT00261 EQU   S20C02                                                   01588000
@RC00263 EQU   S20C03                                                   01589000
@RT00273 EQU   S20C02A                                                  01590000
@RC00285 EQU   S20C03                                                   01591000
@RC00275 EQU   S20C03                                                   01592000
@RT00313 EQU   CALL123                                                  01593000
@RT00315 EQU   CALL456                                                  01594000
@RC00276 EQU   @RC00275                                                 01595000
@ENDDATA EQU   *                                                        01596000
         END   ISTSC020,(C'PLS1520',0702,78337)                         01597000
./  ADD  SSI=83370149,NAME=ISTSC021
         TITLE 'ISTSC021,CONVERT. CONVERTS DATA TO HEX OR EBCDIC'       00001000
ISTSC021 CSECT ,                                                   0001 00002000
@MAINENT DS    0H                                                  0001 00003000
         USING *,@15                                               0001 00004000
         B     @PROLOG                                             0001 00005000
         DC    AL1(16)                                             0001 00006000
         DC    C'ISTSC021  78.337'                                 0001 00007000
         DROP  @15                                                      00008000
@PROLOG  ST    @14,12(,@13)                                        0001 00009000
         ST    @00,20(,@13)                                        0001 00010000
         STM   @02,@12,28(@13)                                     0001 00011000
         BALR  @04,0                                               0001 00012000
@PSTART  DS    0H                                                  0001 00013000
         USING @PSTART,@04                                         0001 00014000
*                                                                  0029 00015000
*/********************************************************************/ 00016000
*/*      SETUP TO PERFORM CONVERSION                                 */ 00017000
*/********************************************************************/ 00018000
*                                                                  0030 00019000
*S21C0000:                                                         0030 00020000
*   ;                                                              0030 00021000
S21C0000 DS    0H                                                  0031 00022000
*   R5=$CNVFROM;                    /* GET FROM ADDR INTO REG.5      */ 00023000
         L     R5,$CNVFROM(,CONMAP)                                0031 00024000
*   R6=$CNVTO;                      /* GET TO ADDR INTO REG.6        */ 00025000
         L     R6,$CNVTO(,CONMAP)                                  0032 00026000
*   R7=CNVCT;                       /* GET COUNT INTO REG.7          */ 00027000
         LA    @14,12                                              0033 00028000
         ALR   @14,CONMAP                                          0033 00029000
         SLR   R7,R7                                               0033 00030000
         IC    R7,CNVCT(,@14)                                      0033 00031000
*   IF R7=0                         /* IF COUNT=0, RETURN TO         */ 00032000
*     THEN                                                         0034 00033000
         LTR   R7,R7                                               0034 00034000
         BZ    @RT00034                                            0034 00035000
*     GOTO S21C0006;                /* CALLER. OTHERWISE CONVERT     */ 00036000
*   AXFLGA='00'X;                   /* CLEAR FLAG                    */ 00037000
         MVI   AXFLGA,X'00'                                        0036 00038000
*   R10=R5+R7;                      /* PUT END ADDR IN REG.10        */ 00039000
         LR    R10,R5                                              0037 00040000
         ALR   R10,R7                                              0037 00041000
*   R3=ADDR(AXATBL);                /* SET PTR TO CHAR TABLE         */ 00042000
         LA    R3,AXATBL                                           0038 00043000
*   IF HEXBIT='1'B                  /* IS CONVERT HEX TO EBCDIC      */ 00044000
*     THEN                                                         0039 00045000
         TM    HEXBIT(@14),B'10000000'                             0039 00046000
         BO    @RT00039                                            0039 00047000
*     GOTO S21C0005;                /* YES, GOTO H-E ROUTINE         */ 00048000
*/********************************************************************/ 00049000
*/*      EBCDIC  TO  HEX  CONVERSION                                 */ 00050000
*/********************************************************************/ 00051000
*                                                                  0041 00052000
*S21C0001:                                                         0041 00053000
*   ;                                                              0041 00054000
S21C0001 DS    0H                                                  0042 00055000
*   DO R9=16 TO 1 BY-1;             /* LOOP THRU CHAR TABLE          */ 00056000
         LA    R9,16                                               0042 00057000
@DL00042 DS    0H                                                  0043 00058000
*     IF INBUF=AXATBL(R9)           /* COMPARE HEX NUMBER TO EQU1    */ 00059000
*       THEN                                                       0043 00060000
         LA    @14,AXATBL-1(R9)                                    0043 00061000
         CLC   INBUF(1,R5),0(@14)                                  0043 00062000
         BE    @RT00043                                            0043 00063000
*       GOTO IST0002;               /* IF FOUND, TAKE BRANCH         */ 00064000
*   END;                            /* IF NOT FOUND IN TABLE, SET    */ 00065000
         BCTR  R9,0                                                0045 00066000
         LTR   R9,R9                                               0045 00067000
         BP    @DL00042                                            0045 00068000
*   R15=8;                          /* REGISTER 15 TO 8              */ 00069000
         LA    R15,8                                               0046 00070000
*   CONMAP=R5;                      /* PUT ADDRESS OF FAILING CHAR 0047 00071000
*                                      INTO REG1                     */ 00072000
         LR    CONMAP,R5                                           0047 00073000
*   GOTO S21C0007;                  /*                               */ 00074000
         B     S21C0007                                            0048 00075000
*IST0002:                                                          0049 00076000
*   ;                               /*                               */ 00077000
IST0002  DS    0H                                                  0050 00078000
*   R11=R9-1;                       /* SAVE EQUIVALENT HEX CHAR      */ 00079000
         LR    R11,R9                                              0050 00080000
         BCTR  R11,0                                               0050 00081000
*   IF AXFLGA¬='00'X                /* IF 2ND BYTE, GO OUTPUT IT     */ 00082000
*     THEN                                                         0051 00083000
         CLI   AXFLGA,X'00'                                        0051 00084000
         BNE   @RT00051                                            0051 00085000
*     GOTO S21C0003;                /*                               */ 00086000
*   R12=R11*16;                     /* PUT 1ST CHAR IN REG 12        */ 00087000
         LR    R12,R11                                             0053 00088000
         SLA   R12,4                                               0053 00089000
*   AXFLGA='F0'X;                   /* SET FLAG TO NON-ZERO VALUE    */ 00090000
         MVI   AXFLGA,X'F0'                                        0054 00091000
*   GOTO S21C0004;                  /*                               */ 00092000
         B     S21C0004                                            0055 00093000
*/********************************************************************/ 00094000
*/*     OUTPUT  ROUTINE  FOR  EBCDIC  TO  HEX  CONVERSION            */ 00095000
*/********************************************************************/ 00096000
*                                                                  0056 00097000
*S21C0003:                                                         0056 00098000
*   ;                                                              0056 00099000
S21C0003 DS    0H                                                  0057 00100000
*   R12=R12|R11;                    /* COMBINE 2 HEX CHAR            */ 00101000
         OR    R12,R11                                             0057 00102000
*   GEN( STC  R12,0(R6));           /* PUT CHAR INTO OUTPUT BUFF     */ 00103000
          STC  R12,0(R6)                                                00104000
*   R6=R6+1;                        /* UP OUTPUT ADDRESS BY 1        */ 00105000
         AL    R6,@CF00033                                         0059 00106000
*   AXFLGA='00'X;                   /* SET FLAG TO 0                 */ 00107000
         MVI   AXFLGA,X'00'                                        0060 00108000
*/********************************************************************/ 00109000
*/*      TEST  TO  DETERMINE  IF  CONVERSION  IS  COMPLETE           */ 00110000
*/********************************************************************/ 00111000
*                                                                  0061 00112000
*S21C0004:                                                         0061 00113000
*   ;                                                              0061 00114000
S21C0004 DS    0H                                                  0062 00115000
*   R5=R5+1;                        /* MOVE FROM ADDR UP BY 1        */ 00116000
         AL    R5,@CF00033                                         0062 00117000
*   IF R5<R10                       /* HAS LAST CHAR BEEN CONVERT    */ 00118000
*     THEN                                                         0063 00119000
         CR    R5,R10                                              0063 00120000
         BL    @RT00063                                            0063 00121000
*     GOTO S21C0001;                /* BRANCH IF NO                  */ 00122000
*   IF LSTCNT='1'B                  /* WAS EH CONVERSION FOR ODD     */ 00123000
*     THEN                                                         0065 00124000
         TM    LSTCNT+12(CONMAP),B'00000001'                       0065 00125000
         BNO   @RF00065                                            0065 00126000
*     GEN( STC  R12,0(R6));         /* COUNT                         */ 00127000
          STC  R12,0(R6)                                                00128000
*   GOTO S21C0006;                  /* TO SET RC=0                   */ 00129000
         B     S21C0006                                            0067 00130000
*/********************************************************************/ 00131000
*/*      HEX  TO  EBCDIC  CONVERSION                                 */ 00132000
*/********************************************************************/ 00133000
*                                                                  0068 00134000
*S21C0005:                                                         0068 00135000
*   ;                                                              0068 00136000
S21C0005 DS    0H                                                  0069 00137000
*   R9=INBUF;                       /* PUT INPUT CHAR INTO REG.9     */ 00138000
         SLR   R9,R9                                               0069 00139000
         IC    R9,INBUF(,R5)                                       0069 00140000
*   R11=R9/16;                      /* PUT BITS 0-3 INTO REG.11      */ 00141000
         LR    R11,R9                                              0070 00142000
         SRL   R11,4                                               0070 00143000
*   R9=R9&15;                       /* PUT BITS 4-7 INTO REG.9       */ 00144000
         N     R9,@CF00034                                         0071 00145000
*   R7=R3+R11;                      /* SET PTR TO CHAR TABLE         */ 00146000
         LR    R7,R3                                               0072 00147000
         ALR   R7,R11                                              0072 00148000
*   OUTBUF=AXATBLEL;                /* STORE 1ST EBCDIC CHAR         */ 00149000
         MVC   OUTBUF(1,R6),AXATBLEL(R7)                           0073 00150000
*   R7=R3+R9;                       /* SET PTR TO CHAR TABLE         */ 00151000
         LR    R7,R3                                               0074 00152000
         ALR   R7,R9                                               0074 00153000
*   OUTBUF1=AXATBLEL;               /* STORE 2ND EBCDIC CHAR         */ 00154000
         MVC   OUTBUF1(1,R6),AXATBLEL(R7)                          0075 00155000
*   R6=R6+2;                        /* STEP TO ADDR BY 2             */ 00156000
         AL    R6,@CF00057                                         0076 00157000
*   R5=R5+1;                        /* SETP FROM ADDR BY 1           */ 00158000
         AL    R5,@CF00033                                         0077 00159000
*   IF R5<R10                       /* HAS LAST CHAR BEEN CONVERT    */ 00160000
*     THEN                                                         0078 00161000
         CR    R5,R10                                              0078 00162000
         BL    @RT00078                                            0078 00163000
*     GOTO S21C0005;                /* NO,GO DO IT AGAIN             */ 00164000
*/********************************************************************/ 00165000
*/*      SET  RETURN CODE  AND  RETURN                               */ 00166000
*/********************************************************************/ 00167000
*                                                                  0080 00168000
*S21C0006:                                                         0080 00169000
*   ;                                                              0080 00170000
S21C0006 DS    0H                                                  0081 00171000
*   R15=0;                          /* SET SUCCESSFUL RETURN CODE    */ 00172000
         SLR   R15,R15                                             0081 00173000
*S21C0007:                                                         0082 00174000
*   ;                                                              0082 00175000
*   RETURN;                         /* RETURN TO CALLER              */ 00176000
@EL00001 DS    0H                                                  0083 00177000
@EF00001 DS    0H                                                  0083 00178000
@ER00001 L     @14,12(,@13)                                        0083 00179000
         L     @00,20(,@13)                                        0083 00180000
         LM    @02,@12,28(@13)                                     0083 00181000
         BR    @14                                                 0083 00182000
*   DO;                             /* ATDSPLY                       */ 00183000
*   END;                            /* ATDSPLY                       */ 00184000
*   END;                                                           0086 00185000
         B     @EL00001                                            0086 00186000
@DATA    DS    0H                                                       00187000
         DS    0F                                                       00188000
         DS    0F                                                       00189000
@CF00033 DC    F'1'                                                     00190000
@CF00057 DC    F'2'                                                     00191000
@CF00034 DC    F'15'                                                    00192000
         DS    0D                                                       00193000
AXATBL   DC    CL16'0123456789ABCDEF'                                   00194000
AXFLGA   DS    CL1                                                      00195000
         DS    CL3                                                      00196000
PATCH    DC    10F'0'                                                   00197000
@00      EQU   00                      EQUATES FOR REGISTERS 0-15       00198000
@01      EQU   01                                                       00199000
@02      EQU   02                                                       00200000
@03      EQU   03                                                       00201000
@04      EQU   04                                                       00202000
@05      EQU   05                                                       00203000
@06      EQU   06                                                       00204000
@07      EQU   07                                                       00205000
@08      EQU   08                                                       00206000
@09      EQU   09                                                       00207000
@10      EQU   10                                                       00208000
@11      EQU   11                                                       00209000
@12      EQU   12                                                       00210000
@13      EQU   13                                                       00211000
@14      EQU   14                                                       00212000
@15      EQU   15                                                       00213000
WAPTR    EQU   @02                                                      00214000
CONMAP   EQU   @01                                                      00215000
R3       EQU   @03                                                      00216000
R5       EQU   @05                                                      00217000
R6       EQU   @06                                                      00218000
R7       EQU   @07                                                      00219000
R9       EQU   @09                                                      00220000
R10      EQU   @10                                                      00221000
R11      EQU   @11                                                      00222000
R12      EQU   @12                                                      00223000
R15      EQU   @15                                                      00224000
R0       EQU   @00                                                      00225000
R1       EQU   @01                                                      00226000
R13      EQU   @13                                                      00227000
R14      EQU   @14                                                      00228000
R2       EQU   @02                                                      00229000
R4       EQU   @04                                                      00230000
R8       EQU   @08                                                      00231000
TOLTEPWA EQU   0                                                        00232000
CONVMAP  EQU   0                                                        00233000
$CNVFROM EQU   CONVMAP+4                                                00234000
$CNVTO   EQU   CONVMAP+8                                                00235000
$CNVCT   EQU   CONVMAP+12                                               00236000
@NM00002 EQU   0                                                        00237000
HEXBIT   EQU   @NM00002                                                 00238000
CNVCT    EQU   @NM00002+1                                               00239000
LSTCNT   EQU   CNVCT                                                    00240000
INBUF    EQU   0                                                        00241000
OUTAREA  EQU   0                                                        00242000
OUTBUF   EQU   OUTAREA                                                  00243000
OUTBUF1  EQU   OUTAREA+1                                                00244000
AXATBLEL EQU   0                                                        00245000
         AGO   .@UNREFD                START UNREFERENCED COMPONENTS    00246000
@NM00004 EQU   CNVCT                                                    00247000
@NM00003 EQU   @NM00002                                                 00248000
$CNVIDNT EQU   CONVMAP+2                                                00249000
$CNVLEVL EQU   CONVMAP+1                                                00250000
$CNVTRMG EQU   CONVMAP                                                  00251000
$WORKARA EQU   TOLTEPWA+1616                                            00252000
$SLTBL   EQU   TOLTEPWA+1468                                            00253000
@NM00001 EQU   TOLTEPWA+1464                                            00254000
$DEVTBLE EQU   TOLTEPWA+240                                             00255000
$COMMFLG EQU   TOLTEPWA+224                                             00256000
$CDA     EQU   TOLTEPWA+100                                             00257000
$SCTTBLE EQU   TOLTEPWA                                                 00258000
.@UNREFD ANOP                          END UNREFERENCED COMPONENTS      00259000
@RT00034 EQU   S21C0006                                                 00260000
@RT00039 EQU   S21C0005                                                 00261000
@RT00043 EQU   IST0002                                                  00262000
@RT00051 EQU   S21C0003                                                 00263000
@RT00063 EQU   S21C0001                                                 00264000
@RF00065 EQU   S21C0006                                                 00265000
@RT00078 EQU   S21C0005                                                 00266000
S21C0007 EQU   @EL00001                                                 00267000
@ENDDATA EQU   *                                                        00268000
         END   ISTSC021,(C'PLS1524',0702,78337)                         00269000
./  ADD  SSI=83370150,NAME=ISTSC022
         TITLE 'ISTSC022-CUTEST,CONTROL UNIT TEST FUNCTION'             00001000
* IBM DISK OPERATING SYSTEM                                             00002000
* TOLTEP - 5745-SC-TLT                                                  00003000
   ISEQ  73,80                                                          00004000
ISTSC022 CSECT ,                                                   0002 00005000
@MAINENT DS    0H                                                  0002 00006000
         USING *,@15                                               0002 00007000
         B     @PROLOG                                             0002 00008000
         DC    AL1(16)                                             0002 00009000
         DC    C'ISTSC022  78.337'                                 0002 00010000
         DROP  @15                                                      00011000
@PROLOG  ST    @14,12(,@13)                                        0002 00012000
         STM   @00,@12,20(@13)                                     0002 00013000
         BALR  @12,0                                               0002 00014000
@PSTART  DS    0H                                                  0002 00015000
         USING @PSTART,@12                                         0002 00016000
*   CVTPTR=R1;                      /* SAVE PARM LIST PTR            */ 00017000
         LR    CVTPTR,R1                                           0057 00018000
*   R3=R13;                         /* REGISTER                      */ 00019000
         LR    R3,R13                                              0058 00020000
*   R13=ADDR(SVESC022);             /* LINKAGE                       */ 00021000
         LA    R13,SVESC022(,WAPTR)                                0059 00022000
*   SVESC022(2)=R3;                                                0060 00023000
         ST    R3,SVESC022+4(,WAPTR)                               0060 00024000
*   BACKSAVE(3)=R13;                /* GET BACK SAVE PTR             */ 00025000
         ST    R13,BACKSAVE+8(,R3)                                 0061 00026000
*   RCAPTR=$RCA;                    /* GET PTR TO RCA                */ 00027000
         L     RCAPTR,$RCA(,WAPTR)                                 0062 00028000
*   IF $CUTESTB='1'B                /* WAS A CUTEST ENTERED          */ 00029000
*     THEN                          /* YES SET IND TO 1              */ 00030000
         TM    $CUTESTB(RCAPTR),B'00010000'                        0063 00031000
         BNO   @RF00063                                            0063 00032000
*     CUTESTIN=1;                                                  0064 00033000
         MVI   CUTESTIN,X'01'                                      0064 00034000
*   ELSE                            /* NO SET IND TO 0               */ 00035000
*     CUTESTIN=0;                                                  0065 00036000
         B     @RC00063                                            0065 00037000
@RF00063 MVI   CUTESTIN,X'00'                                      0065 00038000
*   $CUTESTB='1'B;                  /* CUTEST IN PROGRESS            */ 00039000
@RC00063 OI    $CUTESTB(RCAPTR),B'00010000'                        0066 00040000
*   R10=$CUTEXT;                                                   0067 00041000
         L     R10,$CUTEXT(,CVTPTR)                                0067 00042000
*   R11=1;                                                         0068 00043000
         LA    R11,1                                               0068 00044000
*   IF $CUTLEVL='02'X THEN          /* ONLY 1 EXTENT ALLOWED         */ 00045000
         CLI   $CUTLEVL(CVTPTR),X'02'                              0069 00046000
         BE    @RT00069                                            0069 00047000
*     GO TO S22C010;                /* YES                           */ 00048000
*   R11=$NUMEXTS;                   /* NUMBER OF CUTEST REQ          */ 00049000
         SLR   R11,R11                                             0071 00050000
         IC    R11,$NUMEXTS(,CVTPTR)                               0071 00051000
*   IF R11<=0|                      /* CHECK VALIDITY                */ 00052000
*       R11>16 THEN                                                0072 00053000
         LTR   R11,R11                                             0072 00054000
         BNP   @RT00072                                            0072 00055000
         C     R11,@CF00061                                        0072 00056000
         BNH   @RF00072                                            0072 00057000
@RT00072 DS    0H                                                  0073 00058000
*     DO;                                                          0073 00059000
*       R15=12;                     /* SET BAD RET CODE              */ 00060000
         LA    R15,12                                              0074 00061000
*       GO TO S22C300;              /* RETURN TO CALLER              */ 00062000
         B     S22C300                                             0075 00063000
*     END;                                                         0076 00064000
*   IF $CUCODE¬='01'X THEN          /* ONLY CODE 01 SUPPORTED        */ 00065000
@RF00072 CLI   $CUCODE(CVTPTR),X'01'                               0077 00066000
         BE    @RF00077                                            0077 00067000
*     DO;                                                          0078 00068000
*       R15=4;                      /* SET BAD RC                    */ 00069000
         LA    R15,4                                               0079 00070000
*       GO TO S22C300;              /* RETURN                        */ 00071000
         B     S22C300                                             0080 00072000
*     END;                                                         0081 00073000
*S22C010:                                                          0082 00074000
*   IF R10=0|BASEADR=0 THEN         /* BASE ADDRESS = 0              */ 00075000
@RF00077 DS    0H                                                  0082 00076000
S22C010  SLR   @14,@14                                             0082 00077000
         CR    R10,@14                                             0082 00078000
         BE    @RT00082                                            0082 00079000
         C     @14,BASEADR(,R10)                                   0082 00080000
         BNE   @RF00082                                            0082 00081000
@RT00082 DS    0H                                                  0083 00082000
*     DO;                           /* YES ERROR                     */ 00083000
*       R15=12;                     /* SET BAD RC                    */ 00084000
         LA    R15,12                                              0084 00085000
*       GO TO S22C300;              /* RETURN                        */ 00086000
         B     S22C300                                             0085 00087000
*     END;                                                         0086 00088000
*   IF $USECNT¬=1 THEN              /* MORE THAN 1 LOGON?            */ 00089000
@RF00082 CLC   $USECNT(2,RCAPTR),@CH00072                          0087 00090000
         BE    @RF00087                                            0087 00091000
*     DO;                           /* YES FUNCTION NOT AVAILABLE    */ 00092000
*       R15=8;                      /* SET BAD R/C                   */ 00093000
         LA    R15,8                                               0089 00094000
*       GO TO S22C300;              /* RETURN                        */ 00095000
         B     S22C300                                             0090 00096000
*     END;                                                         0091 00097000
*   R6=EXTENT;                      /* PICK UP EXTENT                */ 00098000
@RF00087 SLR   R6,R6                                               0092 00099000
         IC    R6,EXTENT(,R10)                                     0092 00100000
*   IF R6=0 THEN                    /* EXTENT = ZERO                 */ 00101000
         LTR   R6,R6                                               0093 00102000
         BNZ   @RF00093                                            0093 00103000
*     DO;                           /* YES,ERROR                     */ 00104000
*       R15=12;                                                    0095 00105000
         LA    R15,12                                              0095 00106000
*       GO TO S22C300;              /* RETURN                        */ 00107000
         B     S22C300                                             0096 00108000
*     END;                                                         0097 00109000
*   IF $CUCNT=16 THEN               /* MORE THAN 16 CUTEST CALLS?    */ 00110000
@RF00093 CLC   $CUCNT(2,WAPTR),@CH00061                            0098 00111000
         BNE   @RF00098                                            0098 00112000
*     DO;                           /* YES,ERROR                     */ 00113000
*       R15=8;                      /* SET BAD R/C                   */ 00114000
         LA    R15,8                                               0100 00115000
*       GO TO S22C300;              /* RETURN                        */ 00116000
         B     S22C300                                             0101 00117000
*     END;                                                         0102 00118000
*   IF $CUCNT>0 THEN                /* MULTI CUTEST CALLS            */ 00119000
@RF00098 LH    @14,$CUCNT(,WAPTR)                                  0103 00120000
         LTR   @14,@14                                             0103 00121000
         BNP   @RF00103                                            0103 00122000
*     DO;                           /* YES                           */ 00123000
*       DO I=1 TO $CUCNT;           /* DUPLICATE REQUEST?            */ 00124000
         LA    I,1                                                 0105 00125000
         B     @DE00105                                            0105 00126000
@DL00105 DS    0H                                                  0106 00127000
*         IF $CUTABLE(I)=CUDATA THEN                               0106 00128000
         LR    @14,I                                               0106 00129000
         MH    @14,@CH00350                                        0106 00130000
         ALR   @14,WAPTR                                           0106 00131000
         CLC   $CUTABLE-5(5,@14),CUDATA(R10)                       0106 00132000
         BE    @RT00106                                            0106 00133000
*           GO TO S22C250;          /* YES RETURN                    */ 00134000
*       END;                                                       0108 00135000
         AL    I,@CF00072                                          0108 00136000
@DE00105 CH    I,$CUCNT(,WAPTR)                                    0108 00137000
         BNH   @DL00105                                            0108 00138000
*     END;                                                         0109 00139000
*   VERACQ='0'B;                    /* SET TO VERIFY                 */ 00140000
@RF00103 NI    VERACQ,B'10111111'                                  0110 00141000
*   VERPARM=ADDR(CDSINFO);          /* PT TO DUMMY CDS FOR ACQ       */ 00142000
         LA    @14,CDSINFO                                         0111 00143000
         ST    @14,VERPARM                                         0111 00144000
*   R1=ADDR(VERPARM);               /* INIT CDS SYM NAME             */ 00145000
         LA    R1,VERPARM                                          0112 00146000
*   DO I=1 TO R6;                   /* VERIFY ALL DEVS ON CU         */ 00147000
         LA    I,1                                                 0113 00148000
         B     @DE00113                                            0113 00149000
@DL00113 DS    0H                                                  0114 00150000
*     UNIT=BASEADR+I-1;                                            0114 00151000
         LR    @14,I                                               0114 00152000
         AL    @14,BASEADR(,R10)                                   0114 00153000
         BCTR  @14,0                                               0114 00154000
         STH   @14,UNIT                                            0114 00155000
*     CALL ISTSC030;                /* CALL ACQ MODULE TO VERIFY     */ 00156000
         L     @15,@CV00711                                        0115 00157000
         BALR  @14,@15                                             0115 00158000
*     IF R15¬=0 THEN                /* ERROR?                        */ 00159000
         LTR   R15,R15                                             0116 00160000
         BZ    @RF00116                                            0116 00161000
*       DO;                         /* YES                           */ 00162000
*         R15=8;                    /* SET RET CODE                  */ 00163000
         LA    R15,8                                               0118 00164000
*         GO TO S22C300;            /* RETURN                        */ 00165000
         B     S22C300                                             0119 00166000
*       END;                                                       0120 00167000
*     DO J=1 TO 2 BY 1;             /* MAKE SURE                     */ 00168000
@RF00116 LA    @14,1                                               0121 00169000
         STH   @14,J                                               0121 00170000
@DL00121 DS    0H                                                  0122 00171000
*       IF SYMNAME=$SYSMN(J) THEN   /* DEV AN ALT PRT OR CT          */ 00172000
         L     @09,SYMPTR+2376(,WAPTR)                             0122 00173000
         MH    @14,@CH00375                                        0122 00174000
         ALR   @14,WAPTR                                           0122 00175000
         CLC   SYMNAME(8,@09),$SYSMN-68(@14)                       0122 00176000
         BNE   @RF00122                                            0122 00177000
*         DO;                       /* YES,ERROR                     */ 00178000
*           R15=8;                  /* SET BAD R/C                   */ 00179000
         LA    R15,8                                               0124 00180000
*           GO TO S22C300;          /* RETURN                        */ 00181000
         B     S22C300                                             0125 00182000
*         END;                                                     0126 00183000
*     END;                                                         0127 00184000
@RF00122 LA    @14,1                                               0127 00185000
         AH    @14,J                                               0127 00186000
         STH   @14,J                                               0127 00187000
         C     @14,@CF00139                                        0127 00188000
         BNH   @DL00121                                            0127 00189000
*   END;                                                           0128 00190000
         AL    I,@CF00072                                          0128 00191000
@DE00113 CR    I,R6                                                0128 00192000
         BNH   @DL00113                                            0128 00193000
*S22C100:                                                          0129 00194000
*   IF $OPCOM='1'B THEN             /* SYSTEM CONSOLE REQ.?          */ 00195000
S22C100  TM    $OPCOM(WAPTR),B'10000000'                           0129 00196000
         BO    @RT00129                                            0129 00197000
*     GO TO S22C115;                /* YES TAKE BRANCH               */ 00198000
*   $INBUFR=$INBUFR&&$INBUFR;       /* CLEAR MSG BUFFER              */ 00199000
         XC    $INBUFR(80,WAPTR),$INBUFR(WAPTR)                    0131 00200000
*   $INBUFR(1:8)=$SYSMN(1);         /* MOVE CT NME TO MSG            */ 00201000
*                                                                  0132 00202000
         MVC   $INBUFR(8,WAPTR),$SYSMN(WAPTR)                      0132 00203000
*   /*****************************************************************/ 00204000
*   /*                                                               */ 00205000
*   /* TCEC MSGN(247)MSGMSK('80000000'X)SUB(YES)DIR(NET) INVOKED     */ 00206000
*   /*                                                               */ 00207000
*   /*****************************************************************/ 00208000
*                                                                  0133 00209000
*   $TCECM='1'B;                    /* SET TCEC SW IN RCA            */ 00210000
         OI    $TCECM(WAPTR),B'00000001'                           0133 00211000
*   R1=ADDR($TCA09);                /* SET UP PARM LIST $TR          */ 00212000
         LA    R1,$TCA09                                           0134 00213000
*   CALL S20CEC03;                  /* CALL TCEC-MULTIPLE LN         */ 00214000
         L     @15,@CV00716                                        0135 00215000
         BALR  @14,@15                                             0135 00216000
*   DCL                                                            0136 00217000
*     1 $TCA09,                     /* TCEC PARM LIST                */ 00218000
*      2 $TCB09 FIXED(32) INIT(247),/* MSG NUMBER                    */ 00219000
*      2 $TCC09 FIXED(32) INIT(0),  /* INCT LEN                      */ 00220000
*      2 $TCD09 BIT(8) INIT('10001000'B),/* FLAG                     */ 00221000
*      2 $TCE09 CHAR(4) INIT('80000000'X);/* MSSAGE MASK             */ 00222000
*                                                                  0136 00223000
*   /*****************************************************************/ 00224000
*   /*                                                               */ 00225000
*   /* ITACONV FROM(BASEADR,4)TO(CUFLD,4) INVOKED                    */ 00226000
*   /*                                                               */ 00227000
*   /*****************************************************************/ 00228000
*                                                                  0137 00229000
*   DCL                                                            0137 00230000
*    (ITATCF,                                                      0137 00231000
*     ITATCT) CHAR(*) BASED;        /* GENERATE WORK VARABLES        */ 00232000
*   DCL                                                            0138 00233000
*     ITATCTS FIXED;                /* TEMP SPOT FOR ALTERED BYTE    */ 00234000
*   RFY                                                            0139 00235000
*     ITATCF BASED(ADDR(BASEADR));  /* MAP VARIABLE OVER FROM        */ 00236000
*   RFY                                                            0140 00237000
*     ITATCT BASED(ADDR(CUFLD));    /* MAP VARIBABLE OVER TO         */ 00238000
*   ITATCTS=ITATCT(4+1:4+1);        /* SAVE BYTE PAST TO FIELD       */ 00239000
         LA    @14,CUFLD                                           0141 00240000
         SLR   ITATCTS,ITATCTS                                     0141 00241000
         IC    ITATCTS,ITATCT+4(,@14)                              0141 00242000
*   UNPK(ITATCT(1:4+1),ITATCF(1:4+1));/* EXPAND HEX TO EBCDIC        */ 00243000
         UNPK  ITATCT(5,@14),ITATCF(5,R10)                         0142 00244000
*   TR(ITATCT(1:4),$TRTBL);         /* CONVERT FA-FF TO C1-C6        */ 00245000
         L     @09,$TRTBLA(,RCAPTR)                                0143 00246000
         TR    ITATCT(4,@14),$TRTBL(@09)                           0143 00247000
*   ITATCT(4+1:4+1)=ITATCTS;        /* RESTORE BYTE PAST TO FIELD    */ 00248000
         STC   ITATCTS,ITATCT+4(,@14)                              0144 00249000
*   $INBUFR=MSG247;                 /* MOVE MSG TO MSG BUFFER        */ 00250000
*                                                                  0145 00251000
         MVI   $INBUFR+48(WAPTR),C' '                              0145 00252000
         MVC   $INBUFR+49(31,WAPTR),$INBUFR+48(WAPTR)              0145 00253000
         MVC   $INBUFR(48,WAPTR),MSG247                            0145 00254000
*   /*****************************************************************/ 00255000
*   /*                                                               */ 00256000
*   /* TCEC MSGN(247)MSGMSK('40000000'X)SUB(YES)DIR(NET) INVOKED     */ 00257000
*   /*                                                               */ 00258000
*   /*****************************************************************/ 00259000
*                                                                  0146 00260000
*   $TCECM='1'B;                    /* SET TCEC SW IN RCA            */ 00261000
         OI    $TCECM(WAPTR),B'00000001'                           0146 00262000
*   R1=ADDR($TCA11);                /* SET UP PARM LIST $TR          */ 00263000
         LA    R1,$TCA11                                           0147 00264000
*   CALL S20CEC03;                  /* CALL TCEC-MULTIPLE LN         */ 00265000
         L     @15,@CV00716                                        0148 00266000
         BALR  @14,@15                                             0148 00267000
*   DCL                                                            0149 00268000
*     1 $TCA11,                     /* TCEC PARM LIST                */ 00269000
*      2 $TCB11 FIXED(32) INIT(247),/* MSG NUMBER                    */ 00270000
*      2 $TCC11 FIXED(32) INIT(0),  /* INCT LEN                      */ 00271000
*      2 $TCD11 BIT(8) INIT('10001000'B),/* FLAG                     */ 00272000
*      2 $TCE11 CHAR(4) INIT('40000000'X);/* MSSAGE MASK             */ 00273000
*                                                                  0149 00274000
*   /*****************************************************************/ 00275000
*   /*                                                               */ 00276000
*   /* TCEC MSGN(247)MSGMSK('20000000'X)INCT(1)DIR(NET) INVOKED      */ 00277000
*   /*                                                               */ 00278000
*   /*****************************************************************/ 00279000
*                                                                  0150 00280000
*   $TCECM='1'B;                    /* SET TCEC SW IN RCA            */ 00281000
         OI    $TCECM(WAPTR),B'00000001'                           0150 00282000
*   R1=ADDR($TCA12);                /* SET UP PARM LIST $TR          */ 00283000
         LA    R1,$TCA12                                           0151 00284000
*   CALL S20CEC03;                  /* CALL TCEC-MULTIPLE LN         */ 00285000
         L     @15,@CV00716                                        0152 00286000
         BALR  @14,@15                                             0152 00287000
*   DCL                                                            0153 00288000
*     1 $TCA12,                     /* TCEC PARM LIST                */ 00289000
*      2 $TCB12 FIXED(32) INIT(247),/* MSG NUMBER                    */ 00290000
*      2 $TCC12 FIXED(32) INIT(1),  /* INCT LEN                      */ 00291000
*      2 $TCD12 BIT(8) INIT('01001000'B),/* FLAG                     */ 00292000
*      2 $TCE12 CHAR(4) INIT('20000000'X);/* MSSAGE MASK             */ 00293000
*S22C110:                                                          0154 00294000
*                                                                  0154 00295000
*   /*****************************************************************/ 00296000
*   /*                                                               */ 00297000
*   /* CHECK RESPONSE FROM PERMISSION MESSAGE                        */ 00298000
*   /*                                                               */ 00299000
*   /*****************************************************************/ 00300000
*                                                                  0154 00301000
*   IF¬($INBUFR(2)='Y'|$INBUFR(2)='N')|($INBUFR(1)>1&$INBUFR(3)¬=',')   00302000
*     THEN                                                         0154 00303000
S22C110  CLI   $INBUFR+1(WAPTR),C'Y'                               0154 00304000
         BE    @GL00003                                            0154 00305000
         CLI   $INBUFR+1(WAPTR),C'N'                               0154 00306000
         BNE   @RT00154                                            0154 00307000
@GL00003 CLI   $INBUFR(WAPTR),1                                    0154 00308000
         BNH   @RF00154                                            0154 00309000
         CLI   $INBUFR+2(WAPTR),C','                               0154 00310000
         BE    @RF00154                                            0154 00311000
@RT00154 DS    0H                                                  0155 00312000
*     DO;                                                          0155 00313000
*                                                                  0155 00314000
*       /*************************************************************/ 00315000
*       /*                                                           */ 00316000
*       /* TCEC MSGN(299)INCT(61) INVOKED                            */ 00317000
*       /*                                                           */ 00318000
*       /*************************************************************/ 00319000
*                                                                  0156 00320000
*       $TCECM='1'B;                /* SET TCEC SW IN RCA            */ 00321000
         OI    $TCECM(WAPTR),B'00000001'                           0156 00322000
*       R1=ADDR($TCA13);            /* SET UP PARM LIST $TR          */ 00323000
         LA    R1,$TCA13                                           0157 00324000
*       CALL #EXIT;                 /* CALL CECOM                    */ 00325000
         L     @15,#EXITA(,WAPTR)                                  0158 00326000
         BALR  @14,@15                                             0158 00327000
*       DCL                                                        0159 00328000
*         1 $TCA13,                 /* TCEC PARM LIST                */ 00329000
*          2 $TCB13 FIXED(32) INIT(299),/* MSG NUMBER                */ 00330000
*          2 $TCC13 FIXED(32) INIT(61),/* INCT LEN                   */ 00331000
*          2 $TCD13 BIT(8) INIT('01000000'B),/* FLAG                 */ 00332000
*          2 $TCE13 CHAR(4) INIT('FFFFFFFF'X);/* MSSAGE MASK INVALID    00333000
*                                      RESPONSE                      */ 00334000
*       GO TO S22C110;              /* REISSUE MESSAGE               */ 00335000
         B     S22C110                                             0160 00336000
*     END;                                                         0161 00337000
*   ELSE                                                           0162 00338000
*     DO;                                                          0162 00339000
@RF00154 DS    0H                                                  0163 00340000
*       T463C=T463B;                /* SHIFT MESSAGE                 */ 00341000
         MVC   @TS00001(61),T463B(WAPTR)                           0163 00342000
         MVC   T463C(61,WAPTR),@TS00001                            0163 00343000
*       T463A='247';                /* SET COMM MSG NUM              */ 00344000
         MVC   T463A(3,WAPTR),@CC00760                             0164 00345000
*       IF $INBUFR(5)=',' THEN      /* CHECK FOR COMM REPLY          */ 00346000
         CLI   $INBUFR+4(WAPTR),C','                               0165 00347000
         BNE   @RF00165                                            0165 00348000
*         DO;                                                      0166 00349000
*                                                                  0166 00350000
*           /*********************************************************/ 00351000
*           /*                                                       */ 00352000
*           /* TCEC MSGN(463)SUB(YES) INVOKED                        */ 00353000
*           /*                                                       */ 00354000
*           /*********************************************************/ 00355000
*                                                                  0167 00356000
*           $TCECM='1'B;            /* SET TCEC SW IN RCA            */ 00357000
         OI    $TCECM(WAPTR),B'00000001'                           0167 00358000
*           R1=ADDR($TCA14);        /* SET UP PARM LIST $TR          */ 00359000
         LA    R1,$TCA14                                           0168 00360000
*           CALL #EXIT;             /* CALL CECOM                    */ 00361000
         L     @15,#EXITA(,WAPTR)                                  0169 00362000
         BALR  @14,@15                                             0169 00363000
*           DCL                                                    0170 00364000
*             1 $TCA14,             /* TCEC PARM LIST                */ 00365000
*              2 $TCB14 FIXED(32) INIT(463),/* MSG NUMBER            */ 00366000
*              2 $TCC14 FIXED(32) INIT(0),/* INCT LEN                */ 00367000
*              2 $TCD14 BIT(8) INIT('10000000'B),/* FLAG             */ 00368000
*              2 $TCE14 CHAR(4) INIT('FFFFFFFF'X);/* MSSAGE MASK   0170 00369000
*                                      ISSUE COMM MESSAGE            */ 00370000
*         END;                                                     0171 00371000
*       IF $INBUFR(4)='N' THEN      /* REQUEST DENIED                */ 00372000
@RF00165 CLI   $INBUFR+3(WAPTR),C'N'                               0172 00373000
         BNE   @RF00172                                            0172 00374000
*         DO;                       /* YES                           */ 00375000
*                                                                  0173 00376000
*           /*********************************************************/ 00377000
*           /*                                                       */ 00378000
*           /* TCEC MSGN(254) INVOKED                                */ 00379000
*           /*                                                       */ 00380000
*           /*********************************************************/ 00381000
*                                                                  0174 00382000
*           $TCECM='1'B;            /* SET TCEC SW IN RCA            */ 00383000
         OI    $TCECM(WAPTR),B'00000001'                           0174 00384000
*           R1=ADDR($TCA15);        /* SET UP PARM LIST $TR          */ 00385000
         LA    R1,$TCA15                                           0175 00386000
*           CALL #EXIT;             /* CALL CECOM                    */ 00387000
         L     @15,#EXITA(,WAPTR)                                  0176 00388000
         BALR  @14,@15                                             0176 00389000
*           DCL                                                    0177 00390000
*             1 $TCA15,             /* TCEC PARM LIST                */ 00391000
*              2 $TCB15 FIXED(32) INIT(254),/* MSG NUMBER            */ 00392000
*              2 $TCC15 FIXED(32) INIT(0),/* INCT LEN                */ 00393000
*              2 $TCD15 BIT(8) INIT('00000000'B),/* FLAG             */ 00394000
*              2 $TCE15 CHAR(4) INIT('FFFFFFFF'X);/* MSSAGE MASK   0177 00395000
*                                      ISSUE DENIED PER MSG          */ 00396000
*           R15=8;                  /* SET BAD R/C                   */ 00397000
         LA    R15,8                                               0178 00398000
*           GO TO S22C300;          /* RETURN                        */ 00399000
         B     S22C300                                             0179 00400000
*         END;                                                     0180 00401000
*     END;                                                         0181 00402000
@RF00172 DS    0H                                                  0182 00403000
*S22C115:                                                          0182 00404000
*   VERACQ='1'B;                    /* SET TO ACQUIRE                */ 00405000
S22C115  OI    VERACQ,B'01000000'                                  0182 00406000
*   $CUCNT=$CUCNT+1;                /* UPDATE CNT OF CU'S            */ 00407000
         LA    @14,1                                               0183 00408000
         AH    @14,$CUCNT(,WAPTR)                                  0183 00409000
         STH   @14,$CUCNT(,WAPTR)                                  0183 00410000
*   $CUTABLE($CUCNT)=CUDATA;        /* ENTER NAME OF CU IN TBL       */ 00411000
         MH    @14,@CH00350                                        0184 00412000
         ALR   @14,WAPTR                                           0184 00413000
         MVC   $CUTABLE-5(5,@14),CUDATA(R10)                       0184 00414000
*S22C120:                                                          0185 00415000
*   VERPARM=ADDR($CUTABLE($CUCNT)); /* PT TO NEW DEVS                */ 00416000
S22C120  LH    @14,$CUCNT(,WAPTR)                                  0185 00417000
         MH    @14,@CH00350                                        0185 00418000
         LA    @14,$CUTABLE-5(@14,WAPTR)                           0185 00419000
         ST    @14,VERPARM                                         0185 00420000
*   R1=ADDR(ACQPARM);               /* PT TO PARM LIST               */ 00421000
         LA    R1,ACQPARM                                          0186 00422000
*   CALL #EXIT;                     /* ACQUIRE DEVICE                */ 00423000
         L     @15,#EXITA(,WAPTR)                                  0187 00424000
         BALR  @14,@15                                             0187 00425000
*   IF R15=0 THEN                   /* CHK RETURN CODE               */ 00426000
         LTR   R15,R15                                             0188 00427000
         BZ    @RT00188                                            0188 00428000
*     GO TO S22C250;                /* GOT IT                        */ 00429000
*   IF R15¬=16 THEN                 /* NEED MORE SPACE ?             */ 00430000
         C     R15,@CF00061                                        0190 00431000
         BE    @RF00190                                            0190 00432000
*     DO;                           /* NO,ANOTHER ERROR              */ 00433000
*       $CUCNT=$CUCNT-1;            /* SUB 1 FROM CU COUNT           */ 00434000
         LH    @14,$CUCNT(,WAPTR)                                  0192 00435000
         BCTR  @14,0                                               0192 00436000
         STH   @14,$CUCNT(,WAPTR)                                  0192 00437000
*       R15=8;                      /* DEVICE DOES NOT MEET REQS     */ 00438000
         LA    R15,8                                               0193 00439000
*       GO TO S22C300;              /* RETURN                        */ 00440000
         B     S22C300                                             0194 00441000
*     END;                                                         0195 00442000
*   R7=$GETMPTR;                                                   0196 00443000
@RF00190 L     R7,$GETMPTR(,WAPTR)                                 0196 00444000
*   R8=$GETMSZE;                    /* SIZE OF AREA                  */ 00445000
         LH    R8,$GETMSZE(,WAPTR)                                 0197 00446000
*   $GETMSZE=R0;                    /* GET SIZE NEEDED FRM VER       */ 00447000
         STH   R0,$GETMSZE(,WAPTR)                                 0198 00448000
*   IF R8=0 THEN                    /* PREVIOUS GETMAIN DONE?        */ 00449000
         LTR   R8,R8                                               0199 00450000
         BZ    @RT00199                                            0199 00451000
*     GO TO S22C150;                /* NO DONT DO FREEMAIN           */ 00452000
*                                                                  0200 00453000
*   /*****************************************************************/ 00454000
*   /*                                                               */ 00455000
*   /* FREE EXSISTING AREA                                           */ 00456000
*   /*                                                               */ 00457000
*   /*****************************************************************/ 00458000
*                                                                  0201 00459000
*   RESPECIFY                                                      0201 00460000
*     R4 RESTRICTED;                                               0201 00461000
*   R0=R8;                                                         0202 00462000
*                                                                  0202 00463000
         LR    R0,R8                                               0202 00464000
*/*VFRMAIN  SIZE((0))STORAGE((R7))SUBPOOL(0)                         */ 00465000
*                                                                  0203 00466000
*   DO;                                                            0203 00467000
*     DO;                           /* CMZMREG (0,15) RESTRICT       */ 00468000
*       RFY                                                        0205 00469000
*        (GPR00P,                                                  0205 00470000
*         GPR15P) RSTD;                                            0205 00471000
*     END;                          /* CMZMREG PUT SUBPOOL PARM IN 0206 00472000
*                                      HIGH- ORDER BYTE OF REG 15    */ 00473000
*     GPR15F=0;                                                    0207 00474000
         SLR   GPR15F,GPR15F                                       0207 00475000
*     SLL(GPR15P,24);               /* COMBINE SUBPOOL AND SIZE IN 0208 00476000
*                                      REGISTER 0                    */ 00477000
         SLL   GPR15P,24                                           0208 00478000
*     GPR00P=GPR00P|GPR15P;                                        0209 00479000
         OR    GPR00P,GPR15P                                       0209 00480000
*     DO;                           /* CMZMREG (0,15) RELEASE        */ 00481000
*       RFY                                                        0211 00482000
*        (GPR00P,                                                  0211 00483000
*         GPR15P) UNRSTD;                                          0211 00484000
*     END;                          /* CMZMREG DECLARE AND RESTRICT     00485000
*                                      REG 1                         */ 00486000
*     DO;                           /* CMZMREG (1) RESTRICT          */ 00487000
*       RFY                                                        0214 00488000
*        (GPR01P) RSTD;                                            0214 00489000
*     END;                          /* CMZMREG INVOKE XREGSET MACRO     00490000
*                                      TO CHECK STORAGE PARM AND PUT    00491000
*                                      ADDR IN REGISTER 1            */ 00492000
*/*XREGSET  PID('STORAGE')PPARM((R7))RREG(1,GPR01P)                  */ 00493000
*                                                                  0216 00494000
*     DO;                                                          0216 00495000
*       GPR01P=R7;                  /* SET RREG SYMBOL TO VALUE OF 0217 00496000
*                                      PPARM OPERAND                 */ 00497000
         LR    GPR01P,R7                                           0217 00498000
*     END;                          /* XREGSET INVOKE FREEMAIN MACRO */ 00499000
*     GEN;                                                         0219 00500000
         FREEMAIN R,LV=(0),A=(1)                                        00501000
*                                   /* UNRESTRICT REG 1              */ 00502000
*     DO;                           /* CMZMREG (1) RELEASE           */ 00503000
*       RFY                                                        0221 00504000
*        (GPR01P) UNRSTD;                                          0221 00505000
*     END;                          /* CMZMREG                       */ 00506000
*   END;                            /* VFRMAIN                       */ 00507000
*S22C150:                                                          0224 00508000
*   R8=$GETMSZE;                    /* GET SIZE IN REG               */ 00509000
*                                                                  0224 00510000
S22C150  LH    R8,$GETMSZE(,WAPTR)                                 0224 00511000
*   /*****************************************************************/ 00512000
*   /*                                                               */ 00513000
*   /* GET AREA NEEDED BY ACQUISITION FOR ACQUIRE                    */ 00514000
*   /*                                                               */ 00515000
*   /*****************************************************************/ 00516000
*                                                                  0225 00517000
*   R7=ADDR($GETMPTR);              /* SET PTR FOR RTN ADDR OF AREA     00518000
*                                      GOTTEN                        */ 00519000
         LA    R7,$GETMPTR(,WAPTR)                                 0225 00520000
*   GEN(STM R2,R4,VGETSAVE);                                       0226 00521000
*                                                                  0226 00522000
         STM R2,R4,VGETSAVE                                             00523000
*/*VGTMAIN SIZE($GETMSZE)STORAGE((R7))SUBPOOL(0)PAGE(NO)             */ 00524000
*                                                                  0227 00525000
*   DO;                             /* DECLARE AND RESTRICT REGISTERS   00526000
*                                      2,3, AND 4                    */ 00527000
*     DO;                           /* CMZMREG (2,3,4) RESTRICT      */ 00528000
*       RFY                                                        0229 00529000
*        (GPR02P,                                                  0229 00530000
*         GPR03P,                                                  0229 00531000
*         GPR04P) RSTD;                                            0229 00532000
*     END;                          /* CMZMREG                       */ 00533000
*     DO;                           /* ISTREG (15)                   */ 00534000
*     END;                          /* ISTREG INVOKE XREGSET MACRO TO   00535000
*                                      CHECK SIZE PARM AND PUT VALUE    00536000
*                                      IN REGISTER 2                 */ 00537000
*/*XREGSET  PID('SIZE')PPARM($GETMSZE)RREG(,GPR02F)OUTPUT(PARM)      */ 00538000
*                                                                  0233 00539000
*     DO;                                                          0233 00540000
*       GPR02F=$GETMSZE;            /* SET RREG SYMBOL TO VALUE OF 0234 00541000
*                                      PPARM OPERAND                 */ 00542000
         LH    GPR02F,$GETMSZE(,WAPTR)                             0234 00543000
*     END;                          /* XREGSET INVOKE XREGSET MACRO     00544000
*                                      TO CHECK STORAGE PARM AND PUT    00545000
*                                      VALUE IN REGISTER 3           */ 00546000
*/*XREGSET  PID('STORAGE')PPARM((R7))RREG(,GPR03F)                   */ 00547000
*                                                                  0236 00548000
*     DO;                                                          0236 00549000
*       GPR03F=R7;                  /* SET RREG SYMBOL TO VALUE OF 0237 00550000
*                                      PPARM OPERAND                 */ 00551000
         LR    GPR03F,R7                                           0237 00552000
*     END;                          /* XREGSET INVOKE XREGSET MACRO     00553000
*                                      TO CHECK SUBPOOL PARM AND PUT    00554000
*                                      VALUE IN REGISTER 4           */ 00555000
*/*XREGSET  PID('SUBPOOL')PPARM(0)RREG(,GPR04F)OUTPUT(PARM)          */ 00556000
*                                                                  0239 00557000
*     DO;                                                          0239 00558000
*       GPR04F=0;                   /* SET RREG SYMBOL TO VALUE OF 0240 00559000
*                                      PPARM OPERAND                 */ 00560000
         SLR   GPR04F,GPR04F                                       0240 00561000
*     END;                          /* XREGSET INVOKE GETMAIN MACRO  */ 00562000
*     GEN REFS(GPR02F,GPR03P,GPR04F) SETS(GPR03P,GPR15F);          0242 00563000
         GETMAIN EC,LV=(2),A=(3),SP=(4)                                 00564000
*                                   /* UNRESTRICT REGS 2,3, AND 4    */ 00565000
*     DO;                           /* CMZMREG (2,3,4) RELEASE       */ 00566000
*       RFY                                                        0244 00567000
*        (GPR02P,                                                  0244 00568000
*         GPR03P,                                                  0244 00569000
*         GPR04P) UNRSTD;                                          0244 00570000
*     END;                          /* CMZMREG                       */ 00571000
*   END;                            /* VGTMAIN                       */ 00572000
*   GEN(LM R2,R4,VGETSAVE);                                        0247 00573000
         LM R2,R4,VGETSAVE                                              00574000
*   IF R15¬=0 THEN                  /* GETMAIN OK?                   */ 00575000
         LTR   R15,R15                                             0248 00576000
         BZ    @RF00248                                            0248 00577000
*     DO;                           /* NO                            */ 00578000
*       R15=8;                      /* SET RETURN CODE               */ 00579000
         LA    R15,8                                               0250 00580000
*       GO TO S22C300;              /* RETURN                        */ 00581000
         B     S22C300                                             0251 00582000
*     END;                                                         0252 00583000
*   GO TO S22C120;                  /* GETMAIN DONE GO ACQUIRE       */ 00584000
         B     S22C120                                             0253 00585000
*S22C250:                                                          0254 00586000
*   R11=R11-1;                      /* REDUCE REQUEST COUNTER        */ 00587000
S22C250  BCTR  R11,0                                               0254 00588000
*   IF R11¬=0 THEN                  /* ARE WE DONE ?                 */ 00589000
         LTR   R11,R11                                             0255 00590000
         BZ    @RF00255                                            0255 00591000
*     DO;                           /* NO                            */ 00592000
*       R10=R10+4;                  /* POINT TO NEXT EXTENT          */ 00593000
         AL    R10,@CF00068                                        0257 00594000
*       GO TO S22C010;              /* PROCESS NEXT                  */ 00595000
         B     S22C010                                             0258 00596000
*     END;                                                         0259 00597000
*   R15=0;                          /* INDICATE GOOD RETURN          */ 00598000
@RF00255 SLR   R15,R15                                             0260 00599000
*   GOTO S22C301;                   /* GO TO GOOD RTN                */ 00600000
         B     S22C301                                             0261 00601000
*S22C300:                                                          0262 00602000
*   IF CUTESTIN=0                   /* BAD RTN- IF IND=0 THE         */ 00603000
*     THEN                          /* BIT TURNED OFF                */ 00604000
S22C300  CLI   CUTESTIN,0                                          0262 00605000
         BNE   @RF00262                                            0262 00606000
*     $CUTESTB='0'B;                /* ELSE LEAVE ON                 */ 00607000
         NI    $CUTESTB(RCAPTR),B'11101111'                        0263 00608000
*S22C301:                                                          0264 00609000
*   ;                                                              0264 00610000
@RF00262 DS    0H                                                  0264 00611000
S22C301  DS    0H                                                  0265 00612000
*   R13=SVESC022(2);                /* RESTORE                       */ 00613000
         L     R13,SVESC022+4(,WAPTR)                              0265 00614000
*   RETURN;                                                        0266 00615000
@EL00001 DS    0H                                                  0266 00616000
@EF00001 DS    0H                                                  0266 00617000
@ER00001 L     @14,12(,@13)                                        0266 00618000
         LM    @00,@12,20(@13)                                     0266 00619000
         BR    @14                                                 0266 00620000
*   DO;                             /* TPEPILOG                      */ 00621000
*     GEN(PRINT OFF);                                              0268 00622000
         PRINT OFF                                                      00623000
*     DO;                                                          0269 00624000
*       DCL                                                        0270 00625000
*         GPR00F FIXED(31) REG(00),                                0270 00626000
*         GPR00P PTR(31) REG(00),                                  0270 00627000
*         GPR01F FIXED(31) REG(01),                                0270 00628000
*         GPR01P PTR(31) REG(01),                                  0270 00629000
*         GPR02F FIXED(31) REG(02),                                0270 00630000
*         GPR02P PTR(31) REG(02),                                  0270 00631000
*         GPR03F FIXED(31) REG(03),                                0270 00632000
*         GPR03P PTR(31) REG(03),                                  0270 00633000
*         GPR04F FIXED(31) REG(04),                                0270 00634000
*         GPR04P PTR(31) REG(04),                                  0270 00635000
*         GPR05F FIXED(31) REG(05),                                0270 00636000
*         GPR05P PTR(31) REG(05),                                  0270 00637000
*         GPR06F FIXED(31) REG(06),                                0270 00638000
*         GPR06P PTR(31) REG(06),                                  0270 00639000
*         GPR07F FIXED(31) REG(07),                                0270 00640000
*         GPR07P PTR(31) REG(07),                                  0270 00641000
*         GPR08F FIXED(31) REG(08),                                0270 00642000
*         GPR08P PTR(31) REG(08),                                  0270 00643000
*         GPR09F FIXED(31) REG(09),                                0270 00644000
*         GPR09P PTR(31) REG(09),                                  0270 00645000
*         GPR10F FIXED(31) REG(10),                                0270 00646000
*         GPR10P PTR(31) REG(10),                                  0270 00647000
*         GPR11F FIXED(31) REG(11),                                0270 00648000
*         GPR11P PTR(31) REG(11),                                  0270 00649000
*         GPR12F FIXED(31) REG(12),                                0270 00650000
*         GPR12P PTR(31) REG(12),                                  0270 00651000
*         GPR13F FIXED(31) REG(13),                                0270 00652000
*         GPR13P PTR(31) REG(13),                                  0270 00653000
*         GPR14F FIXED(31) REG(14),                                0270 00654000
*         GPR14P PTR(31) REG(14),                                  0270 00655000
*         GPR15F FIXED(31) REG(15),                                0270 00656000
*         GPR15P PTR(31) REG(15);                                  0270 00657000
*     END;                                                         0271 00658000
*     GEN(PRINT ON);                                               0272 00659000
         PRINT ON                                                       00660000
*   END;                            /* TPEPILOG                      */ 00661000
*   DO;                             /* ATDSPLY                       */ 00662000
*   END;                            /* ATDSPLY                       */ 00663000
*   END ISTSC022;                                                  0276 00664000
         B     @EL00001                                            0276 00665000
@DATA    DS    0H                                                       00666000
@CH00350 DC    H'5'                                                     00667000
@CH00375 DC    H'68'                                                    00668000
         DS    0F                                                       00669000
         DS    0F                                                       00670000
@CF00072 DC    F'1'                                                     00671000
@CH00072 EQU   @CF00072+2                                               00672000
@CF00139 DC    F'2'                                                     00673000
@CF00068 DC    F'4'                                                     00674000
@CF00061 DC    F'16'                                                    00675000
@CH00061 EQU   @CF00061+2                                               00676000
@CV00711 DC    V(ISTSC030)                                              00677000
@CV00716 DC    V(S20CEC03)                                              00678000
         DS    0D                                                       00679000
EXTFXD   DS    FL4                                                      00680000
         ORG   EXTFXD                                                   00681000
EXTCHR   DS    CL4                                                      00682000
         ORG   EXTFXD+4                                                 00683000
CUPTR    DS    A                                                        00684000
J        DS    H                                                        00685000
CUTESTIN DC    AL1(0)                                                   00686000
@TS00001 DS    CL61                                                     00687000
@CC00760 DC    C'247'                                                   00688000
         DS    CL1                                                      00689000
ACQPARM  DS    CL9                                                      00690000
         ORG   ACQPARM                                                  00691000
@NM00054 DC    X'0102F3F0'                                              00692000
VERPARM  DS    AL4                                                      00693000
ACQFLGS  DC    X'10'                                                    00694000
         ORG   ACQFLGS                                                  00695000
PRT380   DS    BL1                                                      00696000
VERACQ   EQU   ACQFLGS+0                                                00697000
DEVCHR   EQU   ACQFLGS+0                                                00698000
@NM00055 EQU   ACQFLGS+0                                                00699000
         ORG   ACQPARM+9                                                00700000
         DS    CL3                                                      00701000
CDSINFO  DC    X'0000000000000000000000000000000000000000'              00702000
         ORG   CDSINFO                                                  00703000
@NM00056 DS    FL2                                                      00704000
UNIT     DS    FL2                                                      00705000
@NM00057 DS    CL16                                                     00706000
         ORG   CDSINFO+20                                               00707000
MSG247   DC    CL48'CONTROL UNIT XXXX AND ALL ASSOCIATED DEVICES'       00708000
         ORG   MSG247                                                   00709000
@NM00058 DS    CL13                                                     00710000
CUFLD    DS    CL4                                                      00711000
@NM00059 DS    CL27                                                     00712000
         ORG   MSG247+48                                                00713000
$TCA09   DS    CL13                                                     00714000
         ORG   $TCA09                                                   00715000
$TCB09   DC    A(247)                                                   00716000
$TCC09   DC    A(0)                                                     00717000
$TCD09   DC    B'10001000'                                              00718000
$TCE09   DC    X'80000000'                                              00719000
         ORG   $TCA09+13                                                00720000
         DS    CL3                                                      00721000
$TCA11   DS    CL13                                                     00722000
         ORG   $TCA11                                                   00723000
$TCB11   DC    A(247)                                                   00724000
$TCC11   DC    A(0)                                                     00725000
$TCD11   DC    B'10001000'                                              00726000
$TCE11   DC    X'40000000'                                              00727000
         ORG   $TCA11+13                                                00728000
         DS    CL3                                                      00729000
$TCA12   DS    CL13                                                     00730000
         ORG   $TCA12                                                   00731000
$TCB12   DC    A(247)                                                   00732000
$TCC12   DC    A(1)                                                     00733000
$TCD12   DC    B'01001000'                                              00734000
$TCE12   DC    X'20000000'                                              00735000
         ORG   $TCA12+13                                                00736000
         DS    CL3                                                      00737000
$TCA13   DS    CL13                                                     00738000
         ORG   $TCA13                                                   00739000
$TCB13   DC    A(299)                                                   00740000
$TCC13   DC    A(61)                                                    00741000
$TCD13   DC    B'01000000'                                              00742000
$TCE13   DC    X'FFFFFFFF'                                              00743000
         ORG   $TCA13+13                                                00744000
         DS    CL3                                                      00745000
$TCA14   DS    CL13                                                     00746000
         ORG   $TCA14                                                   00747000
$TCB14   DC    A(463)                                                   00748000
$TCC14   DC    A(0)                                                     00749000
$TCD14   DC    B'10000000'                                              00750000
$TCE14   DC    X'FFFFFFFF'                                              00751000
         ORG   $TCA14+13                                                00752000
         DS    CL3                                                      00753000
$TCA15   DS    CL13                                                     00754000
         ORG   $TCA15                                                   00755000
$TCB15   DC    A(254)                                                   00756000
$TCC15   DC    A(0)                                                     00757000
$TCD15   DC    B'00000000'                                              00758000
$TCE15   DC    X'FFFFFFFF'                                              00759000
         ORG   $TCA15+13                                                00760000
         DS    CL3                                                      00761000
PATCH    DC    15F'0'                                                   00762000
VGETSAVE DS    3F                                                       00763000
@00      EQU   00                      EQUATES FOR REGISTERS 0-15       00764000
@01      EQU   01                                                       00765000
@02      EQU   02                                                       00766000
@03      EQU   03                                                       00767000
@04      EQU   04                                                       00768000
@05      EQU   05                                                       00769000
@06      EQU   06                                                       00770000
@07      EQU   07                                                       00771000
@08      EQU   08                                                       00772000
@09      EQU   09                                                       00773000
@10      EQU   10                                                       00774000
@11      EQU   11                                                       00775000
@12      EQU   12                                                       00776000
@13      EQU   13                                                       00777000
@14      EQU   14                                                       00778000
@15      EQU   15                                                       00779000
ITATCTS  EQU   @04                                                      00780000
I        EQU   @04                                                      00781000
CVTPTR   EQU   @04                                                      00782000
RCAPTR   EQU   @05                                                      00783000
WAPTR    EQU   @02                                                      00784000
R0       EQU   @00                                                      00785000
R1       EQU   @01                                                      00786000
R2       EQU   @02                                                      00787000
R3       EQU   @03                                                      00788000
R4       EQU   @04                                                      00789000
R7       EQU   @07                                                      00790000
R6       EQU   @06                                                      00791000
R8       EQU   @08                                                      00792000
R10      EQU   @10                                                      00793000
R11      EQU   @11                                                      00794000
R13      EQU   @13                                                      00795000
R15      EQU   @15                                                      00796000
GPR00P   EQU   @00                                                      00797000
GPR15P   EQU   @15                                                      00798000
GPR15F   EQU   @15                                                      00799000
GPR01P   EQU   @01                                                      00800000
GPR02P   EQU   @02                                                      00801000
GPR03P   EQU   @03                                                      00802000
GPR04P   EQU   @04                                                      00803000
GPR02F   EQU   @02                                                      00804000
GPR03F   EQU   @03                                                      00805000
GPR04F   EQU   @04                                                      00806000
GPR00F   EQU   @00                                                      00807000
GPR01F   EQU   @01                                                      00808000
GPR05F   EQU   @05                                                      00809000
GPR05P   EQU   @05                                                      00810000
GPR06F   EQU   @06                                                      00811000
GPR06P   EQU   @06                                                      00812000
GPR07F   EQU   @07                                                      00813000
GPR07P   EQU   @07                                                      00814000
GPR08F   EQU   @08                                                      00815000
GPR08P   EQU   @08                                                      00816000
GPR09F   EQU   @09                                                      00817000
GPR09P   EQU   @09                                                      00818000
GPR10F   EQU   @10                                                      00819000
GPR10P   EQU   @10                                                      00820000
GPR11F   EQU   @11                                                      00821000
GPR11P   EQU   @11                                                      00822000
GPR12F   EQU   @12                                                      00823000
GPR12P   EQU   @12                                                      00824000
GPR13F   EQU   @13                                                      00825000
GPR13P   EQU   @13                                                      00826000
GPR14F   EQU   @14                                                      00827000
GPR14P   EQU   @14                                                      00828000
R12      EQU   @12                                                      00829000
R14      EQU   @14                                                      00830000
R9       EQU   @09                                                      00831000
$RCAAREA EQU   0                                                        00832000
$POINTER EQU   $RCAAREA+100                                             00833000
$TRTBLA  EQU   $POINTER+124                                             00834000
$CONSTNT EQU   $RCAAREA+244                                             00835000
$USECNT  EQU   $CONSTNT                                                 00836000
$RCAFLG  EQU   $RCAAREA+604                                             00837000
$CUTESTB EQU   $RCAFLG                                                  00838000
$TRTBL   EQU   0                                                        00839000
TOLTEPWA EQU   0                                                        00840000
$SCTTBLE EQU   TOLTEPWA                                                 00841000
$TESTOPT EQU   $SCTTBLE+2                                               00842000
$ERROPT  EQU   $SCTTBLE+3                                               00843000
$PDEVFLG EQU   $SCTTBLE+10                                              00844000
$CDSFLGS EQU   $SCTTBLE+11                                              00845000
$CDS8T19 EQU   $SCTTBLE+20                                              00846000
$EXECFLG EQU   $SCTTBLE+33                                              00847000
$OLTFLGS EQU   $SCTTBLE+36                                              00848000
$OLTFLG2 EQU   $SCTTBLE+37                                              00849000
$TOTFLG1 EQU   $SCTTBLE+38                                              00850000
$ROUTMSK EQU   $SCTTBLE+40                                              00851000
$CDA     EQU   TOLTEPWA+100                                             00852000
$RCA     EQU   $CDA+44                                                  00853000
$OLTPTR  EQU   $CDA+52                                                  00854000
$HIMOREC EQU   $CDA+60                                                  00855000
$GETMPTR EQU   $CDA+88                                                  00856000
$GETMSZE EQU   $CDA+110                                                 00857000
$CUCNT   EQU   $CDA+118                                                 00858000
$COMMFLG EQU   TOLTEPWA+224                                             00859000
$FLAG1   EQU   $COMMFLG                                                 00860000
$FLAG2   EQU   $COMMFLG+1                                               00861000
$FLAG3   EQU   $COMMFLG+2                                               00862000
$FLAG4   EQU   $COMMFLG+3                                               00863000
$OPCOM   EQU   $FLAG4                                                   00864000
$FLAG5   EQU   $COMMFLG+4                                               00865000
$EOJ     EQU   $FLAG5                                                   00866000
$CANCEL  EQU   $EOJ                                                     00867000
$FLAG6   EQU   $COMMFLG+5                                               00868000
$ABNDBIT EQU   $FLAG6                                                   00869000
$FLAG7   EQU   $COMMFLG+6                                               00870000
$FLAG8   EQU   $COMMFLG+7                                               00871000
$TCECM   EQU   $FLAG8                                                   00872000
$FLAG9   EQU   $COMMFLG+8                                               00873000
$FLAG10  EQU   $COMMFLG+9                                               00874000
$FLAG11  EQU   $COMMFLG+10                                              00875000
$FLAG12  EQU   $COMMFLG+11                                              00876000
$FLAG13  EQU   $COMMFLG+12                                              00877000
$DEVTBLE EQU   TOLTEPWA+240                                             00878000
$DEVCDS  EQU   $DEVTBLE                                                 00879000
$DEVUNAD EQU   $DEVCDS                                                  00880000
@NM00039 EQU   $DEVUNAD+2                                               00881000
$DEVFEAT EQU   $DEVCDS+4                                                00882000
$DEVCDSF EQU   $DEVCDS+9                                                00883000
$DEVSDCF EQU   $DEVCDS+10                                               00884000
$$SYMNME EQU   $DEVCDS+12                                               00885000
$DEVFLG1 EQU   $DEVTBLE+20                                              00886000
$EVNCPLT EQU   $DEVFLG1                                                 00887000
$ATTNEXP EQU   $DEVFLG1                                                 00888000
$INTOCC  EQU   $DEVFLG1                                                 00889000
$DEVFLG2 EQU   $DEVTBLE+21                                              00890000
$DEVTECB EQU   $DEVTBLE+22                                              00891000
$OPIS    EQU   $DEVTECB                                                 00892000
$OPND    EQU   $DEVTECB+2                                               00893000
$DEVFLG3 EQU   $DEVTBLE+27                                              00894000
$SIOFLG  EQU   $DEVFLG3                                                 00895000
$SYSMN   EQU   $DEVTBLE+28                                              00896000
$IFTOUT  EQU   $DEVTBLE+36                                              00897000
$DEVSESP EQU   $IFTOUT                                                  00898000
$SSCPDAF EQU   $IFTOUT+6                                                00899000
$LDNCBPT EQU   $DEVTBLE+48                                              00900000
$RNINFO  EQU   $DEVTBLE+56                                              00901000
$DEVFLG5 EQU   $RNINFO+8                                                00902000
$DEVFLG4 EQU   $DEVTBLE+65                                              00903000
$SLTBL   EQU   TOLTEPWA+1468                                            00904000
$RUNTEST EQU   $SLTBL+13                                                00905000
$TESTFLG EQU   $SLTBL+21                                                00906000
$SECLST  EQU   $SLTBL+22                                                00907000
$INBUFR  EQU   TOLTEPWA+2104                                            00908000
$WORK    EQU   TOLTEPWA+2376                                            00909000
#EXITA   EQU   TOLTEPWA+2632                                            00910000
$CCOMDAT EQU   TOLTEPWA+2644                                            00911000
$CFLGS   EQU   $CCOMDAT+16                                              00912000
$24FEMSG EQU   TOLTEPWA+2681                                            00913000
$24CATMG EQU   $24FEMSG+11                                              00914000
@NM00048 EQU   TOLTEPWA+2776                                            00915000
$OUNTPTR EQU   @NM00048+4                                               00916000
$NSPTR   EQU   $OUNTPTR                                                 00917000
$NSCNT   EQU   @NM00048+10                                              00918000
$ENXX    EQU   @NM00048+15                                              00919000
$IMITX   EQU   $ENXX                                                    00920000
$CUTABLE EQU   TOLTEPWA+2868                                            00921000
SVESC033 EQU   TOLTEPWA+3160                                            00922000
SVECC013 EQU   TOLTEPWA+3232                                            00923000
SVEIC003 EQU   TOLTEPWA+3592                                            00924000
SVESC022 EQU   TOLTEPWA+3736                                            00925000
SVECC011 EQU   TOLTEPWA+4024                                            00926000
#EXIT    EQU   0                                                        00927000
CUTSTMAP EQU   0                                                        00928000
$CUTLEVL EQU   CUTSTMAP+1                                               00929000
$CUTEXT  EQU   CUTSTMAP+4                                               00930000
$CUCODE  EQU   CUTSTMAP+8                                               00931000
$NUMEXTS EQU   CUTSTMAP+9                                               00932000
@NM00052 EQU   0                                                        00933000
BASEADR  EQU   @NM00052                                                 00934000
CUDATA   EQU   BASEADR                                                  00935000
EXTENT   EQU   CUDATA+4                                                 00936000
@NM00060 EQU   0                                                        00937000
SYMPTR   EQU   @NM00060                                                 00938000
SYMNAME  EQU   0                                                        00939000
BACKSAVE EQU   0                                                        00940000
ITATCF   EQU   0                                                        00941000
ITATCT   EQU   0                                                        00942000
T463X    EQU   $INBUFR                                                  00943000
T463A    EQU   T463X                                                    00944000
T463C    EQU   T463X+3                                                  00945000
T463Y    EQU   $INBUFR                                                  00946000
T463B    EQU   T463Y+1                                                  00947000
SVECC012 EQU   SVESC022                                                 00948000
SVEIC00A EQU   SVEIC003                                                 00949000
SVEIC004 EQU   SVEIC003                                                 00950000
SVEIC005 EQU   SVEIC003                                                 00951000
SVESC02A EQU   SVESC022                                                 00952000
SVESC02B EQU   SVESC022                                                 00953000
SVESC02D EQU   SVESC022                                                 00954000
SVESC02E EQU   SVESC022                                                 00955000
SVESC02F EQU   SVECC013                                                 00956000
SVESC024 EQU   SVESC022                                                 00957000
SVESC027 EQU   SVESC022                                                 00958000
SVESC029 EQU   SVESC033                                                 00959000
SVESC031 EQU   SVECC013                                                 00960000
SVESC032 EQU   SVECC011                                                 00961000
SVETC037 EQU   SVEIC003                                                 00962000
         AGO   .@UNREFD                START UNREFERENCED COMPONENTS    00963000
@NM00061 EQU   T463Y                                                    00964000
DEVCHRPT EQU   @NM00060+4                                               00965000
@NM00053 EQU   CUDATA                                                   00966000
$CUDSML  EQU   CUTSTMAP+12                                              00967000
@NM00051 EQU   CUTSTMAP+10                                              00968000
$CUTIDNT EQU   CUTSTMAP+2                                               00969000
$CUTTRMG EQU   CUTSTMAP                                                 00970000
SVECC010 EQU   TOLTEPWA+3952                                            00971000
SVETC035 EQU   TOLTEPWA+3880                                            00972000
SVESC030 EQU   TOLTEPWA+3808                                            00973000
SVESC020 EQU   TOLTEPWA+3664                                            00974000
SVEIC002 EQU   TOLTEPWA+3520                                            00975000
SVECC014 EQU   TOLTEPWA+3376                                            00976000
SVESC120 EQU   TOLTEPWA+3304                                            00977000
SVESC025 EQU   TOLTEPWA+3088                                            00978000
@NM00050 EQU   TOLTEPWA+2980                                            00979000
$RPLERR  EQU   TOLTEPWA+2977                                            00980000
@NM00049 EQU   TOLTEPWA+2976                                            00981000
$R13PR3  EQU   TOLTEPWA+2972                                            00982000
$CEINT2  EQU   TOLTEPWA+2968                                            00983000
$CEINT1  EQU   TOLTEPWA+2964                                            00984000
$MSGGET  EQU   TOLTEPWA+2960                                            00985000
$ACQLIST EQU   TOLTEPWA+2956                                            00986000
$R4SAVE1 EQU   TOLTEPWA+2952                                            00987000
$CLSISS  EQU   TOLTEPWA+2950                                            00988000
$CLSCNT  EQU   TOLTEPWA+2948                                            00989000
$BUFSZ2  EQU   TOLTEPWA+2864                                            00990000
$RESID2  EQU   TOLTEPWA+2860                                            00991000
$OLTCCW2 EQU   TOLTEPWA+2856                                            00992000
$ENDBFR2 EQU   TOLTEPWA+2852                                            00993000
$1STBFR2 EQU   TOLTEPWA+2848                                            00994000
$TECB2   EQU   TOLTEPWA+2844                                            00995000
$BUFSZ1  EQU   TOLTEPWA+2840                                            00996000
$RESID1  EQU   TOLTEPWA+2836                                            00997000
$OLTCCW1 EQU   TOLTEPWA+2832                                            00998000
$ENDBFR1 EQU   TOLTEPWA+2828                                            00999000
$1STBFR1 EQU   TOLTEPWA+2824                                            01000000
$TECB1   EQU   TOLTEPWA+2820                                            01001000
$WAITIME EQU   TOLTEPWA+2816                                            01002000
$TRTN#   EQU   TOLTEPWA+2815                                            01003000
$WIODEV  EQU   TOLTEPWA+2814                                            01004000
$RQSTSZE EQU   TOLTEPWA+2812                                            01005000
$RQSTPTR EQU   TOLTEPWA+2808                                            01006000
$R4SAVE  EQU   TOLTEPWA+2804                                            01007000
$PARTADR EQU   TOLTEPWA+2800                                            01008000
$TBSDATA EQU   TOLTEPWA+2796                                            01009000
$CTWIDTH EQU   TOLTEPWA+2795                                            01010000
$CTLINE  EQU   TOLTEPWA+2794                                            01011000
$APWIDTH EQU   TOLTEPWA+2793                                            01012000
$APLINE  EQU   TOLTEPWA+2792                                            01013000
$INDEX   EQU   $IMITX                                                   01014000
$UMXX    EQU   @NM00048+14                                              01015000
$NSXX    EQU   @NM00048+12                                              01016000
$ATACNT  EQU   $NSCNT                                                   01017000
$CTR     EQU   @NM00048+8                                               01018000
$ATAPTR  EQU   $NSPTR                                                   01019000
$DDRPTR  EQU   @NM00048                                                 01020000
$DTORESP EQU   TOLTEPWA+2712                                            01021000
$APNAME  EQU   TOLTEPWA+2704                                            01022000
$24SYMNE EQU   $24CATMG+4                                               01023000
$24DEVAD EQU   $24CATMG                                                 01024000
$24RTN#  EQU   $24FEMSG+8                                               01025000
$ESECTID EQU   $24FEMSG                                                 01026000
$24FLGS  EQU   TOLTEPWA+2680                                            01027000
$24SAVE2 EQU   TOLTEPWA+2676                                            01028000
$24SAVE1 EQU   TOLTEPWA+2672                                            01029000
$24UNADR EQU   TOLTEPWA+2668                                            01030000
$24SAV13 EQU   TOLTEPWA+2664                                            01031000
$24RETCD EQU   TOLTEPWA+2663                                            01032000
$MACID   EQU   TOLTEPWA+2661                                            01033000
$CSPARE  EQU   $CFLGS                                                   01034000
$C2WAY   EQU   $CFLGS                                                   01035000
$CINCT   EQU   $CCOMDAT+12                                              01036000
$CINADR  EQU   $CCOMDAT+8                                               01037000
$COUTCT  EQU   $CCOMDAT+4                                               01038000
$COUTAD  EQU   $CCOMDAT                                                 01039000
ROOTLOC  EQU   TOLTEPWA+2640                                            01040000
$RETREG  EQU   TOLTEPWA+2636                                            01041000
$EXTA    EQU   TOLTEPWA+2320                                            01042000
$PASSONA EQU   TOLTEPWA+2264                                            01043000
$TRMINPT EQU   TOLTEPWA+2184                                            01044000
$BUFFER  EQU   TOLTEPWA+1976                                            01045000
$TLTRPL3 EQU   TOLTEPWA+1856                                            01046000
$TLTRPL2 EQU   TOLTEPWA+1736                                            01047000
$TLTRPL1 EQU   TOLTEPWA+1616                                            01048000
@NM00047 EQU   $SLTBL+135                                               01049000
$HIGHRTN EQU   $SLTBL+134                                               01050000
$PRIMADR EQU   $SLTBL+130                                               01051000
$CTSTPT  EQU   $SLTBL+128                                               01052000
$TSTCNT  EQU   $SLTBL+126                                               01053000
$SECFLGS EQU   $SECLST+3                                                01054000
$SECTION EQU   $SECLST                                                  01055000
$SECACT  EQU   $TESTFLG                                                 01056000
$CANTRUN EQU   $TESTFLG                                                 01057000
$FINAL   EQU   $TESTFLG                                                 01058000
$TESTSUF EQU   $RUNTEST+5                                               01059000
$TESTNUM EQU   $RUNTEST+1                                               01060000
$LETPRF  EQU   $RUNTEST                                                 01061000
$SYMBOLC EQU   $SLTBL+5                                                 01062000
$FAMILY  EQU   $SLTBL                                                   01063000
$CDEVPT  EQU   TOLTEPWA+1466                                            01064000
$DEVCNTS EQU   TOLTEPWA+1464                                            01065000
$FEEDBCK EQU   $DEVTBLE+66                                              01066000
$WTISUED EQU   $DEVFLG4                                                 01067000
$EXIOISD EQU   $DEVFLG4                                                 01068000
$REMWRIT EQU   $DEVFLG4                                                 01069000
$REMDONE EQU   $DEVFLG4                                                 01070000
$2NDUSED EQU   $DEVFLG4                                                 01071000
$1STUSED EQU   $DEVFLG4                                                 01072000
$IGLXIFB EQU   $DEVFLG4                                                 01073000
$EXIOLV3 EQU   $DEVFLG4                                                 01074000
@NM00046 EQU   $DEVFLG5                                                 01075000
$DVBASIC EQU   $DEVFLG5                                                 01076000
$ASCII   EQU   $DEVFLG5                                                 01077000
$DEVLU   EQU   $DEVFLG5                                                 01078000
$OPNDFAL EQU   $DEVFLG5                                                 01079000
$ACQNCB  EQU   $DEVFLG5                                                 01080000
$REMOTE  EQU   $DEVFLG5                                                 01081000
$ENDNODE EQU   $DEVFLG5                                                 01082000
$LINENME EQU   $RNINFO                                                  01083000
$CID     EQU   $DEVTBLE+52                                              01084000
$DVCOL   EQU   $LDNCBPT+2                                               01085000
$DVROW   EQU   $LDNCBPT                                                 01086000
$NCSPLP  EQU   $DEVTBLE+44                                              01087000
$DVLN    EQU   $SSCPDAF                                                 01088000
$DAF     EQU   $DEVSESP+4                                               01089000
$VARYPAB EQU   $DEVSESP                                                 01090000
@NM00045 EQU   $DEVFLG3                                                 01091000
$CLRSNT  EQU   $DEVFLG3                                                 01092000
$OLTERR  EQU   $DEVFLG3                                                 01093000
$SRTEST  EQU   $DEVFLG3                                                 01094000
$DVSNDOK EQU   $SIOFLG                                                  01095000
$POLLREQ EQU   $DEVFLG3                                                 01096000
$ACQRED  EQU   $DEVFLG3                                                 01097000
$NOTDEV  EQU   $DEVFLG3                                                 01098000
$DVINCT  EQU   $DEVTBLE+26                                              01099000
$DVBRKST EQU   $OPND+1                                                  01100000
$DVBRKSN EQU   $OPND                                                    01101000
$DVSEQNO EQU   $OPIS                                                    01102000
$CEINTRP EQU   $DEVFLG2                                                 01103000
$TESTMDE EQU   $DEVFLG2                                                 01104000
$DEVALOC EQU   $DEVFLG2                                                 01105000
$ALLDATA EQU   $DEVFLG2                                                 01106000
$ENDCNTL EQU   $DEVFLG2                                                 01107000
$CTLDEV  EQU   $DEVFLG2                                                 01108000
$NOCDS   EQU   $DEVFLG2                                                 01109000
$DATAIN  EQU   $DEVFLG2                                                 01110000
$PRIMARY EQU   $DEVFLG1                                                 01111000
$DVCTBYT EQU   $INTOCC                                                  01112000
$DEVACT  EQU   $DEVFLG1                                                 01113000
$DVLGMDE EQU   $ATTNEXP                                                 01114000
$DVSPRM  EQU   $EVNCPLT                                                 01115000
$GRABBED EQU   $DEVFLG1                                                 01116000
$CATASTR EQU   $DEVFLG1                                                 01117000
$LETGO   EQU   $DEVFLG1                                                 01118000
$CURELEM EQU   $$SYMNME+4                                               01119000
$MSGOTSD EQU   $$SYMNME                                                 01120000
$EXTDEV  EQU   $DEVCDS+11                                               01121000
@NM00044 EQU   $DEVSDCF                                                 01122000
$NOTPRIM EQU   $DEVSDCF                                                 01123000
@NM00043 EQU   $DEVCDSF                                                 01124000
@NM00042 EQU   $DEVCDSF                                                 01125000
@NM00041 EQU   $DEVCDSF                                                 01126000
$CDSNAME EQU   $DEVCDSF                                                 01127000
$EXTRN   EQU   $DEVCDSF                                                 01128000
$CEVOLUM EQU   $DEVCDSF                                                 01129000
$SHARD   EQU   $DEVCDSF                                                 01130000
$DEVFPM  EQU   $DEVCDSF                                                 01131000
$DEVCNT  EQU   $DEVCDS+8                                                01132000
$DEVTYPE EQU   $DEVFEAT+3                                               01133000
$DEVCLAS EQU   $DEVFEAT+2                                               01134000
$DEVFRRS EQU   $DEVFEAT+1                                               01135000
$DEVMOD  EQU   $DEVFEAT                                                 01136000
$DEVRDGT EQU   @NM00039+1                                               01137000
$DEVCTLU EQU   @NM00039+1                                               01138000
$DEVCHAN EQU   @NM00039                                                 01139000
@NM00040 EQU   @NM00039                                                 01140000
$CTINDX  EQU   $DEVUNAD                                                 01141000
$FLAG16  EQU   $COMMFLG+15                                              01142000
$FLAG15  EQU   $COMMFLG+14                                              01143000
$FLAG14  EQU   $COMMFLG+13                                              01144000
$TEP2ND  EQU   $FLAG13                                                  01145000
$TEP1ST  EQU   $FLAG13                                                  01146000
$CATMSG  EQU   $FLAG13                                                  01147000
$PRMPTSW EQU   $FLAG13                                                  01148000
$DEVENT  EQU   $FLAG13                                                  01149000
$OLTMACC EQU   $FLAG13                                                  01150000
$LGON    EQU   $FLAG13                                                  01151000
$CTLOGON EQU   $FLAG13                                                  01152000
@NM00038 EQU   $FLAG12                                                  01153000
$VARYINP EQU   $FLAG12                                                  01154000
$ENDTEST EQU   $FLAG12                                                  01155000
$VRYHRD  EQU   $FLAG12                                                  01156000
$VRYSFT  EQU   $FLAG12                                                  01157000
$POSTFLG EQU   $FLAG12                                                  01158000
$OPTMSG  EQU   $FLAG12                                                  01159000
$FEORCAT EQU   $FLAG11                                                  01160000
@NM00037 EQU   $FLAG11                                                  01161000
@NM00036 EQU   $FLAG10                                                  01162000
$INBND   EQU   $FLAG10                                                  01163000
$WAITFLG EQU   $FLAG10                                                  01164000
$DPRINT  EQU   $FLAG10                                                  01165000
$HOLD    EQU   $FLAG9                                                   01166000
$NOTRRCH EQU   $FLAG9                                                   01167000
@NM00035 EQU   $FLAG9                                                   01168000
$COPY    EQU   $FLAG9                                                   01169000
$LSTLNSW EQU   $FLAG9                                                   01170000
$MULLNSW EQU   $FLAG9                                                   01171000
$REMSW   EQU   $FLAG9                                                   01172000
$IGRES   EQU   $FLAG9                                                   01173000
$VS2     EQU   $FLAG8                                                   01174000
$VS1     EQU   $FLAG8                                                   01175000
$EDOS    EQU   $FLAG8                                                   01176000
@NM00034 EQU   $FLAG8                                                   01177000
$TWOWAY  EQU   $FLAG8                                                   01178000
@NM00033 EQU   $FLAG8                                                   01179000
$RCVMSG  EQU   $FLAG7                                                   01180000
$RCVRFLG EQU   $FLAG7                                                   01181000
$SNDRFLG EQU   $FLAG7                                                   01182000
$LDOIS   EQU   $FLAG7                                                   01183000
$DCONTCT EQU   $FLAG7                                                   01184000
$EXIOWAT EQU   $FLAG7                                                   01185000
$2NDDATA EQU   $FLAG7                                                   01186000
$1STDATA EQU   $FLAG7                                                   01187000
$CIREQ   EQU   $FLAG6                                                   01188000
$ABTERM  EQU   $ABNDBIT                                                 01189000
$FSTMCIS EQU   $FLAG6                                                   01190000
$DISCREQ EQU   $FLAG6                                                   01191000
$DISCISS EQU   $FLAG6                                                   01192000
$CHANGE  EQU   $FLAG6                                                   01193000
$CTERROR EQU   $FLAG6                                                   01194000
$RECAL11 EQU   $FLAG6                                                   01195000
@NM00032 EQU   $FLAG5                                                   01196000
$PROGCK  EQU   $CANCEL                                                  01197000
$PRINTAP EQU   $FLAG5                                                   01198000
@NM00031 EQU   $FLAG5                                                   01199000
$MSG922  EQU   $FLAG5                                                   01200000
$CT924   EQU   $FLAG5                                                   01201000
$FSTCAT  EQU   $FLAG5                                                   01202000
$FSTFE   EQU   $FLAG5                                                   01203000
$ACTOPND EQU   $FLAG4                                                   01204000
$ACQCUTT EQU   $FLAG4                                                   01205000
$CLSSACT EQU   $FLAG4                                                   01206000
$BACKINT EQU   $FLAG4                                                   01207000
$DMSGSW  EQU   $FLAG4                                                   01208000
$TSTDEVP EQU   $FLAG4                                                   01209000
$APRQPER EQU   $FLAG4                                                   01210000
$NEWAP   EQU   $FLAG3                                                   01211000
$ALTPRTR EQU   $FLAG3                                                   01212000
$OPTERR  EQU   $FLAG3                                                   01213000
$PRTONLY EQU   $FLAG3                                                   01214000
$REQSTOR EQU   $FLAG3                                                   01215000
$LOGOFFE EQU   $FLAG3                                                   01216000
$TSTERR  EQU   $FLAG3                                                   01217000
$DEVERR  EQU   $FLAG3                                                   01218000
$PARTIAL EQU   $FLAG2                                                   01219000
$NRMTERM EQU   $FLAG2                                                   01220000
$VALDTST EQU   $FLAG2                                                   01221000
$VALDDEV EQU   $FLAG2                                                   01222000
$DBLSLSH EQU   $FLAG2                                                   01223000
$NDR     EQU   $FLAG2                                                   01224000
@NM00030 EQU   $FLAG2                                                   01225000
$OLTACT  EQU   $FLAG1                                                   01226000
$NORELDV EQU   $FLAG1                                                   01227000
@NM00029 EQU   $FLAG1                                                   01228000
$OPTCHNG EQU   $FLAG1                                                   01229000
$DEVCHNG EQU   $FLAG1                                                   01230000
$TESTCNG EQU   $FLAG1                                                   01231000
$CNSLFG  EQU   $FLAG1                                                   01232000
$TEP3RD  EQU   $FLAG1                                                   01233000
@NM00028 EQU   $CDA+120                                                 01234000
@NM00027 EQU   $CDA+117                                                 01235000
$PRTFORM EQU   $CDA+116                                                 01236000
$OPISCNT EQU   $CDA+114                                                 01237000
$OPNDCNT EQU   $CDA+112                                                 01238000
$GRCNTS  EQU   $CDA+108                                                 01239000
$CTLCNT  EQU   $CDA+106                                                 01240000
$ACTLVL  EQU   $CDA+105                                                 01241000
$PRNTLVL EQU   $CDA+104                                                 01242000
$ERRCNTA EQU   $CDA+102                                                 01243000
$TLCNT   EQU   $CDA+100                                                 01244000
$TIMEALW EQU   $CDA+96                                                  01245000
$PTRAREA EQU   $CDA+92                                                  01246000
$R13PTRT EQU   $CDA+84                                                  01247000
$R13PTR  EQU   $CDA+80                                                  01248000
$TEPEND  EQU   $CDA+76                                                  01249000
$PLINKDL EQU   $CDA+72                                                  01250000
$TEPBEGN EQU   $CDA+68                                                  01251000
$FRELPTR EQU   $CDA+64                                                  01252000
$HIGHADR EQU   $HIMOREC                                                 01253000
$LOMOREC EQU   $CDA+56                                                  01254000
$LOWADDR EQU   $OLTPTR                                                  01255000
$ENDCOMM EQU   $CDA+48                                                  01256000
$COMMON  EQU   $RCA                                                     01257000
$SLASHAD EQU   $CDA+32                                                  01258000
$PASSON  EQU   $CDA+28                                                  01259000
$TOLBRTB EQU   $CDA+24                                                  01260000
$SCTPTR8 EQU   $CDA+20                                                  01261000
$SCTPTR  EQU   $CDA+16                                                  01262000
$TBWDPTR EQU   $CDA+12                                                  01263000
$TFWDPTR EQU   $CDA+8                                                   01264000
@NM00026 EQU   $CDA                                                     01265000
@NM00025 EQU   $SCTTBLE+98                                              01266000
$SCTLWTC EQU   $SCTTBLE+96                                              01267000
$SCTLWTA EQU   $SCTTBLE+92                                              01268000
#EXT     EQU   $SCTTBLE+88                                              01269000
#PASS    EQU   $SCTTBLE+84                                              01270000
#TABLE   EQU   $SCTTBLE+80                                              01271000
#MSGIDAC EQU   $SCTTBLE+78                                              01272000
@NM00024 EQU   $SCTTBLE+71                                              01273000
$RETMASK EQU   $SCTTBLE+70                                              01274000
$R249255 EQU   $ROUTMSK+29                                              01275000
$R241248 EQU   $ROUTMSK+28                                              01276000
$R233240 EQU   $ROUTMSK+27                                              01277000
$R225232 EQU   $ROUTMSK+26                                              01278000
$R217224 EQU   $ROUTMSK+25                                              01279000
$R209216 EQU   $ROUTMSK+24                                              01280000
$R201208 EQU   $ROUTMSK+23                                              01281000
$R193200 EQU   $ROUTMSK+22                                              01282000
$R185192 EQU   $ROUTMSK+21                                              01283000
$R177184 EQU   $ROUTMSK+20                                              01284000
$R169176 EQU   $ROUTMSK+19                                              01285000
$R161168 EQU   $ROUTMSK+18                                              01286000
$R153160 EQU   $ROUTMSK+17                                              01287000
$R145152 EQU   $ROUTMSK+16                                              01288000
$R137144 EQU   $ROUTMSK+15                                              01289000
$R129136 EQU   $ROUTMSK+14                                              01290000
$R121128 EQU   $ROUTMSK+13                                              01291000
$R113120 EQU   $ROUTMSK+12                                              01292000
$R105112 EQU   $ROUTMSK+11                                              01293000
$R097104 EQU   $ROUTMSK+10                                              01294000
$R089096 EQU   $ROUTMSK+9                                               01295000
$R081088 EQU   $ROUTMSK+8                                               01296000
$R073080 EQU   $ROUTMSK+7                                               01297000
$R065072 EQU   $ROUTMSK+6                                               01298000
$R057064 EQU   $ROUTMSK+5                                               01299000
$R049056 EQU   $ROUTMSK+4                                               01300000
$R041048 EQU   $ROUTMSK+3                                               01301000
$R033040 EQU   $ROUTMSK+2                                               01302000
$R025032 EQU   $ROUTMSK+1                                               01303000
$R017024 EQU   $ROUTMSK                                                 01304000
$TOTFLG2 EQU   $SCTTBLE+39                                              01305000
@NM00023 EQU   $TOTFLG1                                                 01306000
@NM00022 EQU   $TOTFLG1                                                 01307000
@NM00021 EQU   $TOTFLG1                                                 01308000
$CURELOD EQU   $TOTFLG1                                                 01309000
$CTEQTT  EQU   $TOTFLG1                                                 01310000
@NM00020 EQU   $TOTFLG1                                                 01311000
@NM00019 EQU   $TOTFLG1                                                 01312000
$LINESHR EQU   $TOTFLG1                                                 01313000
@NM00018 EQU   $OLTFLG2                                                 01314000
@NM00017 EQU   $OLTFLG2                                                 01315000
@NM00016 EQU   $OLTFLG2                                                 01316000
@NM00015 EQU   $OLTFLG2                                                 01317000
@NM00014 EQU   $OLTFLG2                                                 01318000
@NM00013 EQU   $OLTFLG2                                                 01319000
@NM00012 EQU   $OLTFLG2                                                 01320000
$TALK    EQU   $OLTFLG2                                                 01321000
$DYCOM   EQU   $OLTFLGS                                                 01322000
@NM00011 EQU   $OLTFLGS                                                 01323000
$TRACE   EQU   $OLTFLGS                                                 01324000
$RETCODE EQU   $OLTFLGS                                                 01325000
$CONTCB  EQU   $OLTFLGS                                                 01326000
$RETAIN  EQU   $OLTFLGS                                                 01327000
$CLEANRT EQU   $OLTFLGS                                                 01328000
$MANINTV EQU   $OLTFLGS                                                 01329000
$OLTSIZE EQU   $SCTTBLE+34                                              01330000
$QSCTMOD EQU   $EXECFLG                                                 01331000
$CTRLMOD EQU   $EXECFLG                                                 01332000
$CLEANUP EQU   $EXECFLG                                                 01333000
$LSTPDEV EQU   $EXECFLG                                                 01334000
$ERRCNT  EQU   $EXECFLG                                                 01335000
$RTNSLCT EQU   $EXECFLG                                                 01336000
$MULTDEV EQU   $EXECFLG                                                 01337000
@NM00010 EQU   $EXECFLG                                                 01338000
$RMSKCNT EQU   $SCTTBLE+32                                              01339000
$SYNAME  EQU   $CDS8T19+4                                               01340000
$EXTSIG  EQU   $CDS8T19+3                                               01341000
$CDFLGS  EQU   $CDS8T19+1                                               01342000
$CDSCNT  EQU   $CDS8T19                                                 01343000
$PDEVDSC EQU   $SCTTBLE+16                                              01344000
$PDEVADR EQU   $SCTTBLE+12                                              01345000
$COMMCN  EQU   $CDSFLGS                                                 01346000
$CUSTSYM EQU   $CDSFLGS                                                 01347000
$TWOCHSW EQU   $CDSFLGS                                                 01348000
$SYMNAME EQU   $CDSFLGS                                                 01349000
$EXTINTC EQU   $CDSFLGS                                                 01350000
$CEVOL   EQU   $CDSFLGS                                                 01351000
$SHARED  EQU   $CDSFLGS                                                 01352000
$FPM     EQU   $CDSFLGS                                                 01353000
$LASTSUB EQU   $PDEVFLG                                                 01354000
@NM00009 EQU   $PDEVFLG                                                 01355000
@NM00008 EQU   $PDEVFLG                                                 01356000
@NM00007 EQU   $PDEVFLG                                                 01357000
$LASTDEV EQU   $PDEVFLG                                                 01358000
@NM00006 EQU   $PDEVFLG                                                 01359000
$EXFILPT EQU   $PDEVFLG                                                 01360000
$FPMOLD  EQU   $PDEVFLG                                                 01361000
$TSSSYM  EQU   $SCTTBLE+8                                               01362000
$SCTLEVL EQU   $SCTTBLE+7                                               01363000
$DRIVER  EQU   $SCTTBLE+6                                               01364000
$RT0916  EQU   $SCTTBLE+5                                               01365000
$RT0108  EQU   $SCTTBLE+4                                               01366000
$LOOPTST EQU   $ERROPT                                                  01367000
$LOOPERR EQU   $ERROPT                                                  01368000
$NERRPRT EQU   $ERROPT                                                  01369000
$NOCNTRL EQU   $ERROPT                                                  01370000
$ALTPRNT EQU   $ERROPT                                                  01371000
$CATERR  EQU   $ERROPT                                                  01372000
$ASTERIK EQU   $ERROPT                                                  01373000
$TESTERR EQU   $ERROPT                                                  01374000
$FSTCOMM EQU   $TESTOPT                                                 01375000
$INDEFLP EQU   $TESTOPT                                                 01376000
$NOPRT   EQU   $TESTOPT                                                 01377000
$PARAPRT EQU   $TESTOPT                                                 01378000
@NM00005 EQU   $TESTOPT                                                 01379000
$ERRLPCT EQU   $SCTTBLE                                                 01380000
$TLTEND  EQU   $RCAAREA+945                                             01381000
$CNSLID  EQU   $RCAAREA+936                                             01382000
$EXITSAV EQU   $RCAAREA+864                                             01383000
$TRASCII EQU   $RCAAREA+608                                             01384000
@NM00004 EQU   $RCAAREA+605                                             01385000
$VTAMEND EQU   $RCAFLG                                                  01386000
$TPPOSTD EQU   $RCAFLG                                                  01387000
$NEWCT   EQU   $RCAFLG                                                  01388000
$ABNDALL EQU   $RCAFLG                                                  01389000
$CONSOLE EQU   $RCAFLG                                                  01390000
$TPLOGON EQU   $RCAFLG                                                  01391000
$UPDATE  EQU   $RCAFLG                                                  01392000
$DEVAREA EQU   $RCAAREA+600                                             01393000
$CTDVAR  EQU   $RCAAREA+596                                             01394000
$BUFFS   EQU   $RCAAREA+464                                             01395000
$TLTNIB  EQU   $CONSTNT+140                                             01396000
$TLTPRPL EQU   $CONSTNT+20                                              01397000
@NM00003 EQU   $CONSTNT+4                                               01398000
@NM00002 EQU   $CONSTNT+2                                               01399000
$CURRTWA EQU   $POINTER+140                                             01400000
$CTNAME  EQU   $POINTER+132                                             01401000
$CTARGX  EQU   $POINTER+128                                             01402000
$COMINT  EQU   $POINTER+120                                             01403000
$QUEHNDL EQU   $POINTER+116                                             01404000
@NM00001 EQU   $POINTER+36                                              01405000
$RTNPTR  EQU   $POINTER+32                                              01406000
$TLTECB2 EQU   $POINTER+28                                              01407000
$TLTECB1 EQU   $POINTER+24                                              01408000
$CLEANP  EQU   $POINTER+20                                              01409000
$ABEND   EQU   $POINTER+16                                              01410000
$LSTAREA EQU   $POINTER+12                                              01411000
$FSTAREA EQU   $POINTER+8                                               01412000
$CVTSAVE EQU   $POINTER+4                                               01413000
$TOLTEP  EQU   $POINTER                                                 01414000
$TLTACB  EQU   $RCAAREA                                                 01415000
.@UNREFD ANOP                          END UNREFERENCED COMPONENTS      01416000
@RT00069 EQU   S22C010                                                  01417000
@RT00106 EQU   S22C250                                                  01418000
@RT00129 EQU   S22C115                                                  01419000
@RT00188 EQU   S22C250                                                  01420000
@RT00199 EQU   S22C150                                                  01421000
@RF00248 EQU   S22C120                                                  01422000
@ENDDATA EQU   *                                                        01423000
         END   ISTSC022,(C'PLS1525',0702,78337)                         01424000
./  ADD  SSI=83370152,NAME=ISTSC023
         TITLE 'ISTSC023,DDATE. OBTAINS CURRENT DAY'                    00001000
* IBM DISK OPERATING SYSTEM                                             00002000
* TOLTEP - 5745-SC-TLT                                                  00003000
         ISEQ  73,80                                                    00004000
ISTSC023 CSECT ,                                                   0002 00005000
@MAINENT DS    0H                                                  0002 00006000
         USING *,@15                                               0002 00007000
         B     @PROLOG                                             0002 00008000
         DC    AL1(16)                                             0002 00009000
         DC    C'ISTSC023  78.337'                                 0002 00010000
         DROP  @15                                                      00011000
@PROLOG  ST    @14,12(,@13)                                        0002 00012000
         STM   @02,@12,28(@13)                                     0002 00013000
         BALR  @12,0                                               0002 00014000
@PSTART  DS    0H                                                  0002 00015000
         USING @PSTART,@12                                         0002 00016000
           TIME                                                         00017000
           ST    R1,SAVE                SAVE DATE FROM MACRO            00018000
           MVO   WORK+SIX(TWO),SAVE+ONE(ONE)                            00019000
           OI    WORK+SEVEN,HEX0F                                       00020000
           UNPK  DATE+SIX(TWO),WORK+SIX(TWO)                            00021000
           CVB   R5,WORK                                                00022000
           SR    R4,R4                                                  00023000
           LA    R6,FOUR                DIV BY 4 TO CHK FOR LEAP YEAR   00024000
           DR    R4,R6                  DIVIDE THE YEAR                 00025000
           LA    R5,NOT                 ASSUME NOT A LEAP YEAR          00026000
           LTR   R4,R4                  LEAP YEAR?                      00027000
           BNZ   DATE0600               NO                              00028000
            LA    R5,LEAP               YES IT IS A LEAP YEAR           00029000
DATE0600    EQU   *                                                     00030000
            MVC   WORK+SIX(TWO),SAVE+TWO GET DAY                        00031000
            CVB   R4,WORK                CONVERT TO BINARY              00032000
            LA    R6,TBLENGTH            GET LENGTH OF TABLE            00033000
DATE0700    EQU   *                                                     00034000
            LH    R7,0(R6,R5)             ET ENTRY FROM TABLE           00035000
            CR    R4,R7                  IS THIS CORRECT ENTRY          00036000
            BNH   DATE0900               NO                             00037000
            SR    R4,R7                  YES                            00038000
            CVD   R4,WORK                GET DAY INTO PACK DEC          00039000
            UNPK  DATE+THREE(TWO),WORK+SIX(TWO) UNPACK DAY              00040000
            OI    DATE+FOUR,HEXF0        MAKE DATE PRINTABLE            00041000
            SRL   R6,ONE                 GET MONTH                      00042000
            CVD   R6,WORK                CONVERT MONTH TO PACK DEC      00043000
            UNPK  DATE(TWO),WORK+SIX(TWO) UNPACK MONTH                  00044000
            OI    DATE+ONE,HEXF0         MAKE IT PRINTABLE              00045000
            L     R0,DATE                PUT MM/D INTO R0               00046000
            L     R1,DATE+4              PUT D/YY INTO R1               00047000
            B     SVEC2309                                              00048000
DATE0900    EQU   *                                                     00049000
            LA    R8,TWO                                                00050000
            SR    R6,R8                  POINT TO NEXT ENTRY            00051000
            B     DATE0700               GO CK IT OUT                   00052000
ONE         EQU   1                                                     00053000
TWO         EQU   2                                                     00054000
THREE       EQU   3                                                     00055000
FOUR        EQU   4                                                     00056000
SIX         EQU   6                                                     00057000
SEVEN       EQU   7                                                     00058000
EIGHT       EQU   8                                                     00059000
HEXF0       EQU   X'F0'                                                 00060000
HEX0F       EQU   X'0F'                                                 00061000
WORK        DC    D'0'                                                  00062000
SAVE        DC    F'0'                                                  00063000
DATE        DC    C'00/00/00'                                           00064000
LEAP        EQU   *-2                                                   00065000
LEAPTABL    DC    AL2(0,31,60,91,121,152,182,213,244,274,305,355)       00066000
NOT         EQU   *-2                                                   00067000
LENGTH      EQU    *                                                    00068000
NONLPTBL    DC    AL2(0,31,59,90,120,151,181,212,243,273,304,354)       00069000
TBLENGTH    EQU   *-LENGTH                                              00070000
*SVEC2309:                                                         0024 00071000
*   ;                                                              0024 00072000
SVEC2309 DS    0H                                                  0025 00073000
*   R15=0;                          /* SET RETURN CODE TO 0          */ 00074000
         SLR   R15,R15                                             0025 00075000
*   RETURN;                                                        0026 00076000
@EL00001 DS    0H                                                  0026 00077000
@EF00001 DS    0H                                                  0026 00078000
@ER00001 L     @14,12(,@13)                                        0026 00079000
         LM    @02,@12,28(@13)                                     0026 00080000
         BR    @14                                                 0026 00081000
*   DO;                             /* ATDSPLY                       */ 00082000
*   END;                            /* ATDSPLY                       */ 00083000
*   END;                                                           0029 00084000
@DATA    DS    0H                                                       00085000
         DS    0F                                                       00086000
         DS    0F                                                       00087000
         DS    0D                                                       00088000
FIX      DC    XL4'00010000'                                            00089000
PATCH    DC    5F'0'                                                    00090000
@00      EQU   00                      EQUATES FOR REGISTERS 0-15       00091000
@01      EQU   01                                                       00092000
@02      EQU   02                                                       00093000
@03      EQU   03                                                       00094000
@04      EQU   04                                                       00095000
@05      EQU   05                                                       00096000
@06      EQU   06                                                       00097000
@07      EQU   07                                                       00098000
@08      EQU   08                                                       00099000
@09      EQU   09                                                       00100000
@10      EQU   10                                                       00101000
@11      EQU   11                                                       00102000
@12      EQU   12                                                       00103000
@13      EQU   13                                                       00104000
@14      EQU   14                                                       00105000
@15      EQU   15                                                       00106000
WAPTR    EQU   @02                                                      00107000
R15      EQU   @15                                                      00108000
R0       EQU   @00                                                      00109000
R1       EQU   @01                                                      00110000
R10      EQU   @10                                                      00111000
R11      EQU   @11                                                      00112000
R12      EQU   @12                                                      00113000
R13      EQU   @13                                                      00114000
R14      EQU   @14                                                      00115000
R2       EQU   @02                                                      00116000
R3       EQU   @03                                                      00117000
R4       EQU   @04                                                      00118000
R5       EQU   @05                                                      00119000
R6       EQU   @06                                                      00120000
R7       EQU   @07                                                      00121000
R8       EQU   @08                                                      00122000
R9       EQU   @09                                                      00123000
TOLTEPWA EQU   0                                                        00124000
         AGO   .@UNREFD                START UNREFERENCED COMPONENTS    00125000
$WORKARA EQU   TOLTEPWA+1616                                            00126000
$SLTBL   EQU   TOLTEPWA+1468                                            00127000
@NM00001 EQU   TOLTEPWA+1464                                            00128000
$DEVTBLE EQU   TOLTEPWA+240                                             00129000
$COMMFLG EQU   TOLTEPWA+224                                             00130000
$CDA     EQU   TOLTEPWA+100                                             00131000
$SCTTBLE EQU   TOLTEPWA                                                 00132000
.@UNREFD ANOP                          END UNREFERENCED COMPONENTS      00133000
@ENDDATA EQU   *                                                        00134000
         END   ISTSC023,(C'PLS1528',0702,78337)                         00135000
./  ADD  SSI=91001133,NAME=ISTSC024
         TITLE 'ISTSC024-DPRINT'                                        00001000
ISTSC024 CSECT ,                                                   0001 00002000
@MAINENT DS    0H                                                  0001 00003000
         USING *,@15                                               0001 00004000
         B     @PROLOG                                             0001 00005000
         DC    AL1(16)                                             0001 00006000
         DC    C'ISTSC024  79.101'                                 0001 00007000
         DROP  @15                                                      00008000
@PROLOG  ST    @14,12(,@13)                                        0001 00009000
         STM   @00,@12,20(@13)                                     0001 00010000
         BALR  @12,0                                               0001 00011000
@PSTART  DS    0H                                                  0001 00012000
         USING @PSTART,@12                                         0001 00013000
*   R14=R13;                        /* HOLD CALLER'S SVAREA PTR      */ 00014000
         LR    R14,R13                                             0077 00015000
*   R13=ADDR(SVESC024);             /* POINT TO MY SAVE AREA         */ 00016000
         LA    R13,SVESC024(,WAPTR)                                0078 00017000
*   BACKSAVE(3)=R13;                /* PUT MY SVAREA PTR IN CALLR    */ 00018000
         STCM  R13,15,BACKSAVE+8(R14)                              0079 00019000
*   SVESC024(2)=R14;                /* PUT CALLER'S SVAREA PTR IN MY    00020000
*                                      SAVE AREA                     */ 00021000
         ST    R14,SVESC024+4(,WAPTR)                              0080 00022000
*   $24SAV13=$R13PTR;               /* SAVE PTR TO DPR CALLER        */ 00023000
         L     @14,$R13PTR(,WAPTR)                                 0081 00024000
         ST    @14,$24SAV13(,WAPTR)                                0081 00025000
*   $R13PTR=R13;                    /* MAKE RCM RET TO ME            */ 00026000
         ST    R13,$R13PTR(,WAPTR)                                 0082 00027000
*   $NOTRRCH=ON;                    /* NO RC HDLG & TRACE YET        */ 00028000
         OI    $NOTRRCH(WAPTR),B'00000010'                         0083 00029000
*   $24FLGS=0;                      /* RESET DPR FLAGS               */ 00030000
         MVI   $24FLGS(WAPTR),X'00'                                0084 00031000
*   $24RETCD=0;                     /* RESET DPR RET CODE            */ 00032000
         MVI   $24RETCD(WAPTR),X'00'                               0085 00033000
*   $PRTONLY=ON;                    /* PRINT ON AP ONLY              */ 00034000
         OI    $PRTONLY(WAPTR),B'00001000'                         0086 00035000
*   DPRPTR=R1;                      /* GET DPR LIST PTR VIA R1       */ 00036000
         LR    DPRPTR,R1                                           0087 00037000
*   PRTPTR=$PRTCTLW;                /* SET UP PTR TO CTL WORD        */ 00038000
         L     PRTPTR,$PRTCTLW(,DPRPTR)                            0088 00039000
*   TECBPTR=$PRTTECB;               /* SET UP TECB BASE REG          */ 00040000
         L     TECBPTR,$PRTTECB(,DPRPTR)                           0089 00041000
*   IF $ERRORDP=ON                  /* IF AN ERROR DPRINT,           */ 00042000
*     THEN                          /* TURN ON ERROR BITS            */ 00043000
         TM    $ERRORDP(PRTPTR),B'00000010'                        0090 00044000
         BNO   @RF00090                                            0090 00045000
*     DO;                           /* IN SCT                        */ 00046000
*       $TESTERR=ON;                                               0092 00047000
*       $ASTERIK=ON;                                               0093 00048000
         OI    $TESTERR(WAPTR),B'11000000'                         0093 00049000
*     END;                                                         0094 00050000
*   IF($LOOPTST=ON|$LOOPERR=ON)     /* IF TL OR EL OPTIONS AND       */ 00051000
*       &$NOPRT=OFF                 /* NPR OPTIONSS IN EFFECT        */ 00052000
*     THEN                          /* THEN                          */ 00053000
@RF00090 TM    $LOOPTST(WAPTR),B'00000011'                         0095 00054000
         BZ    @RF00095                                            0095 00055000
         TM    $NOPRT(WAPTR),B'00000100'                           0095 00056000
         BNZ   @RF00095                                            0095 00057000
*     DO;                           /* TURN OFF $CATERR IN SCT       */ 00058000
*       $CATERR=OFF;                /* AND                           */ 00059000
         NI    $CATERR(WAPTR),B'11011111'                          0097 00060000
*       GOTO S24C9990;              /* RETURN TO OLT                 */ 00061000
         B     S24C9990                                            0098 00062000
*     END;                                                         0099 00063000
*                                                                  0099 00064000
*/********************************************************************/ 00065000
*/* AN ERROR DPRINT CAN BE EXECUTED WHEN NO-ERROR-PRINT OPTION IS IN */ 00066000
*/* EFFECT ONLY WHEN THERE IS A CATASTROPHIC OR A FIRST ERROR        */ 00067000
*/* MESSAGE TO BE PRINTED                                            */ 00068000
*/********************************************************************/ 00069000
*                                                                  0100 00070000
*   IF $ERRORDP=ON&$NERRPRT=ON      /* IF ERROR                      */ 00071000
*     THEN                          /* DPRINT &                      */ 00072000
@RF00095 TM    $ERRORDP(PRTPTR),B'00000010'                        0100 00073000
         BNO   @RF00100                                            0100 00074000
         TM    $NERRPRT(WAPTR),B'00000100'                         0100 00075000
         BNO   @RF00100                                            0100 00076000
*     DO;                           /* NEP, AND                      */ 00077000
*       IF($CATERR=ON               /* IF CAT ERR                    */ 00078000
*           &$FSTCAT=OFF)|          /* & MSG NOT                     */ 00079000
*           ($FSTCOMM=ON            /* PRNTD OR FE                   */ 00080000
*           &$FSTFE=OFF)            /* & MSG NOT                     */ 00081000
*         THEN                                                     0102 00082000
         TM    $CATERR(WAPTR),B'00100000'                          0102 00083000
         BNO   @GL00003                                            0102 00084000
         TM    $FSTCAT(WAPTR),B'01000000'                          0102 00085000
         BZ    @RT00102                                            0102 00086000
@GL00003 TM    $FSTCOMM(WAPTR),B'00000001'                         0102 00087000
         BNO   @RF00102                                            0102 00088000
         TM    $FSTFE(WAPTR),B'10000000'                           0102 00089000
         BZ    @RT00102                                            0102 00090000
*         GOTO S24C0100;            /* PRTD GO ON                    */ 00091000
*       ELSE                                                       0104 00092000
*         GOTO S24C9990;            /* ELSE RC=0                     */ 00093000
         B     S24C9990                                            0104 00094000
*     END;                                                         0105 00095000
*S24C0100:                                                         0106 00096000
*   CVD($RTN#,DPRWORK2);            /* CONV BIN RTN# TO DECIMAL      */ 00097000
@RF00100 DS    0H                                                  0106 00098000
S24C0100 L     @14,$LOWADDR(,WAPTR)                                0106 00099000
         LH    @11,RTNDISP(,@14)                                   0106 00100000
         ALR   @11,@14                                             0106 00101000
         SLR   @14,@14                                             0106 00102000
         IC    @14,$RTN#(,@11)                                     0106 00103000
         CVD   @14,@TS00001                                        0106 00104000
         MVC   DPRWORK2(2,WAPTR),@TS00001+6                        0106 00105000
*   DPRWORK2=DPRWORK2/16;           /* GET RID OF SIGN BITS CONVERT     00106000
*                                      RTN# TO EBCDIC                */ 00107000
*                                                                  0107 00108000
         LH    @14,DPRWORK2(,WAPTR)                                0107 00109000
         N     @14,@CF01082                                        0107 00110000
         SRL   @14,4                                               0107 00111000
         STH   @14,DPRWORK2(,WAPTR)                                0107 00112000
*   /*****************************************************************/ 00113000
*   /*                                                               */ 00114000
*   /* ITACONV FROM(DPRWORK2)TO($ESECTID(8))COUNT(2)TYPE(HE) INVOKED */ 00115000
*   /*                                                               */ 00116000
*   /*****************************************************************/ 00117000
*                                                                  0108 00118000
*   DCL                                                            0108 00119000
*     1 ITATCPRM BDY(WORD),         /* CONVERT PARAMETER LIST        */ 00120000
*      2 * CHAR(4) INIT('0102F4F1'X),                              0108 00121000
*      2 ITATCFR PTR,               /* ADDRESS OF FROM FIELD         */ 00122000
*      2 ITATCTO PTR,               /* ADDRESS OF TO FIELD           */ 00123000
*      2 * BIT(8) INIT(0),          /* FLAGS FOR CONVERT MODULE      */ 00124000
*       3 ITATCTP BIT(1),           /* TYPE OF CONVERT REQUIRED      */ 00125000
*      2 ITATCNT FIXED(8);          /* NUMBER OF BYTES TO CONVERT    */ 00126000
*   ITATCFR=ADDR(DPRWORK2);         /* SET THE FROM ADDRESS          */ 00127000
         LA    @14,DPRWORK2(,WAPTR)                                0109 00128000
         ST    @14,ITATCFR                                         0109 00129000
*   ITATCTO=ADDR($ESECTID(8));      /* SET THE TO ADDRESS            */ 00130000
         LA    @14,$ESECTID+7(,WAPTR)                              0110 00131000
         ST    @14,ITATCTO                                         0110 00132000
*   ITATCTP='1'B;                   /* SET THE TYPE OF CONVERT BIT   */ 00133000
         OI    ITATCTP,B'10000000'                                 0111 00134000
*   ITATCNT=2;                      /* GIVE THE CONVERT BYTE COUNT   */ 00135000
         MVI   ITATCNT,X'02'                                       0112 00136000
*   R1=ADDR(ITATCPRM);              /* POINT TO CONVERT PARM LIST    */ 00137000
         LA    R1,ITATCPRM                                         0113 00138000
*   CALL ISTSC021;                  /* CALL CONVERT DIRECTLY         */ 00139000
         L     @15,@CV00877                                        0114 00140000
         BALR  @14,@15                                             0114 00141000
*   $ESECTID=SECTID;                /* SAVE FOR FE & CATERR MSGS     */ 00142000
         L     @14,$LOWADDR(,WAPTR)                                0115 00143000
         MVC   $ESECTID(8,WAPTR),SECTID(@14)                       0115 00144000
*/********************************************************************/ 00145000
*/* SEARCH FOR DEVICE ADDRESS                                        */ 00146000
*/********************************************************************/ 00147000
*                                                                  0116 00148000
*   $24CATMG=' ';                   /* BLANK OUT DEVADR & SYMNME     */ 00149000
         MVI   $24CATMG+1(WAPTR),C' '                              0116 00150000
         MVC   $24CATMG+2(10,WAPTR),$24CATMG+1(WAPTR)              0116 00151000
         MVI   $24CATMG(WAPTR),C' '                                0116 00152000
*   IF $PTDEVAD¬=0                  /* IF DEV ADDR WAS SPECIFIED IN     00153000
*                                      DPRINT PARM LIST              */ 00154000
*     THEN                                                         0117 00155000
         ICM   @14,3,$PTDEVAD(PRTPTR)                              0117 00156000
         BZ    @RF00117                                            0117 00157000
*     DO;                                                          0118 00158000
*       $24UNADR(3:4)=$PTDEVAD;     /* USE IT                        */ 00159000
         MVC   $24UNADR+2(2,WAPTR),$PTDEVAD(PRTPTR)                0119 00160000
*       GOTO S24C0120;              /* AND CONVERT IT                */ 00161000
         B     S24C0120                                            0120 00162000
*     END;                                                         0121 00163000
*   IF $PRTTECB=0|TECBEVOC=0        /* IF TECB PTR NOT SPECIFIED     */ 00164000
*     THEN                          /* OR NO POSTED EVENT IN TECB    */ 00165000
@RF00117 L     @14,$PRTTECB(,DPRPTR)                               0122 00166000
         LTR   @14,@14                                             0122 00167000
         BZ    @RT00122                                            0122 00168000
         CLI   TECBEVOC(TECBPTR),0                                 0122 00169000
         BNE   @RF00122                                            0122 00170000
@RT00122 DS    0H                                                  0123 00171000
*     DO;                                                          0123 00172000
*       IF $NDR=ON                  /* IF THERE IS NO PRIM DEV       */ 00173000
*         THEN                                                     0124 00174000
         TM    $NDR(WAPTR),B'00100000'                             0124 00175000
         BNO   @RF00124                                            0124 00176000
*         DO;                                                      0125 00177000
*           $24DEVAD='NONE';        /* DEV ADDR IS 'NONE'            */ 00178000
         MVC   $24DEVAD(4,WAPTR),@CC00880                          0126 00179000
*           GOTO S24C0150;          /* BYPASS CONVERT OF UNIT ADR    */ 00180000
         B     S24C0150                                            0127 00181000
*         END;                                                     0128 00182000
*       ELSE                                                       0129 00183000
*         DO;                                                      0129 00184000
@RF00124 DS    0H                                                  0130 00185000
*           $24UNADR=$PDEVADR;      /* ELSE USE PRIMARY DEVICE       */ 00186000
         L     @14,$PDEVADR(,WAPTR)                                0130 00187000
         ST    @14,$24UNADR(,WAPTR)                                0130 00188000
*           IF $SYMNAME=ON          /* IF THERE IS A SYMB            */ 00189000
*             THEN                                                 0131 00190000
         TM    $SYMNAME(WAPTR),B'00001000'                         0131 00191000
         BNO   @RF00131                                            0131 00192000
*             $24SYMNE=$SYNAME;     /* NAME, USE IT                  */ 00193000
         MVC   $24SYMNE(8,WAPTR),$SYNAME(WAPTR)                    0132 00194000
*         END;                                                     0133 00195000
@RF00131 DS    0H                                                  0134 00196000
*     END;                                                         0134 00197000
*   ELSE                                                           0135 00198000
*     DO;                           /* OTHERWISE                     */ 00199000
         B     @RC00122                                            0135 00200000
@RF00122 DS    0H                                                  0136 00201000
*       $24UNADR(2:4)=              /* USE ADDR FROM FIRST           */ 00202000
*           TECBEVT1(2:4);          /* EVENT FIELD OF TECB           */ 00203000
         MVC   $24UNADR+1(3,WAPTR),TECBEVT1+1(TECBPTR)             0136 00204000
*     END;                                                         0137 00205000
*S24C0120:                          /* CONV UNITADDR TO SAVE AREA    */ 00206000
*                                                                  0138 00207000
*   /*****************************************************************/ 00208000
*   /*                                                               */ 00209000
*   /* ITACONV FROM($24UNADR(3))TO($24DEVAD)COUNT(2)TYPE(HE) INVOKED */ 00210000
*   /*                                                               */ 00211000
*   /*****************************************************************/ 00212000
*                                                                  0138 00213000
*   ITATCFR=ADDR($24UNADR(3));      /* SET THE FROM ADDRESS          */ 00214000
@RC00122 DS    0H                                                  0138 00215000
S24C0120 LA    @14,$24UNADR+2(,WAPTR)                              0138 00216000
         ST    @14,ITATCFR                                         0138 00217000
*   ITATCTO=ADDR($24DEVAD);         /* SET THE TO ADDRESS            */ 00218000
         LA    @14,$24DEVAD(,WAPTR)                                0139 00219000
         ST    @14,ITATCTO                                         0139 00220000
*   ITATCTP='1'B;                   /* SET THE TYPE OF CONVERT BIT   */ 00221000
         OI    ITATCTP,B'10000000'                                 0140 00222000
*   ITATCNT=2;                      /* GIVE THE CONVERT BYTE COUNT   */ 00223000
         MVI   ITATCNT,X'02'                                       0141 00224000
*   R1=ADDR(ITATCPRM);              /* POINT TO CONVERT PARM LIST    */ 00225000
         LA    R1,ITATCPRM                                         0142 00226000
*   CALL ISTSC021;                  /* CALL CONVERT DIRECTLY         */ 00227000
         L     @15,@CV00877                                        0143 00228000
         BALR  @14,@15                                             0143 00229000
*/********************************************************************/ 00230000
*/*      HEADER                                                      */ 00231000
*/********************************************************************/ 00232000
*                                                                  0144 00233000
*S24C0150:                                                         0144 00234000
*   CALL S24C2600;                  /* CLEAR PRINT BUFFER            */ 00235000
S24C0150 BAL   @14,S24C2600                                        0144 00236000
*   IF $DPHEADR=OFF                 /* IF HEADER FLAG OFF,           */ 00237000
*     THEN                                                         0145 00238000
         TM    $DPHEADR(PRTPTR),B'00010000'                        0145 00239000
         BZ    @RT00145                                            0145 00240000
*     GOTO S24C0200;                /* BYPASS, HEADER SET UP         */ 00241000
*   IF $ALTPRNT=ON                  /* IF PP IS IN EFFECT,           */ 00242000
*     THEN                                                         0147 00243000
         TM    $ALTPRNT(WAPTR),B'00010000'                         0147 00244000
         BNO   @RF00147                                            0147 00245000
*     $PRTONLY=OFF;                 /* TURN OFF PRINTR ONLY FLAG     */ 00246000
         NI    $PRTONLY(WAPTR),B'11110111'                         0148 00247000
*   HDRPTR=ADDR($BUFFER);           /* POINT HDR STRUC TO BUFR       */ 00248000
@RF00147 LA    HDRPTR,$BUFFER(,WAPTR)                              0149 00249000
*   IF $ERRORDP=ON                  /* IF THIS IS AN ERROR DPRINT    */ 00250000
*     THEN                                                         0150 00251000
         TM    $ERRORDP(PRTPTR),B'00000010'                        0150 00252000
         BNO   @RF00150                                            0150 00253000
*     HDRERROR='*';                 /* PREFIX LINE WITH AN *         */ 00254000
         MVI   HDRERROR(HDRPTR),C'*'                               0151 00255000
*   HDRTSTID=SECTID;                /* GET SECTION ID IN PRT BFR     */ 00256000
@RF00150 L     @14,$LOWADDR(,WAPTR)                                0152 00257000
         MVC   HDRTSTID(8,HDRPTR),SECTID(@14)                      0152 00258000
*   HDRHYPHN='-';                   /* HYPHEN                        */ 00259000
         MVI   HDRHYPHN(HDRPTR),C'-'                               0153 00260000
*   HDRLEVEL=LEVEL;                 /* SECTION LEVEL IN PRT BFR      */ 00261000
         MVC   HDRLEVEL(2,HDRPTR),LEVEL(@14)                       0154 00262000
*   HDRRTN='RTN';                   /* PUT CHARACTERS 'RTN' IN       */ 00263000
         MVC   HDRRTN(3,HDRPTR),@CC00888                           0155 00264000
*   HDROUTN#=$24RTN#;               /* GET ROUTINE #                 */ 00265000
         MVC   HDROUTN#(3,HDRPTR),$24RTN#(WAPTR)                   0156 00266000
*   HDRDEVLN='DEV/LN';              /* SET UP DEV ADDR               */ 00267000
         MVI   HDRDEVLN+6(HDRPTR),C' '                             0157 00268000
         MVC   HDRDEVLN(6,HDRPTR),@CC00889                         0157 00269000
*   HDRUNADR=$24DEVAD;              /* PUT UNIT ADR IN HDR           */ 00270000
         MVC   HDRUNADR(4,HDRPTR),$24DEVAD(WAPTR)                  0158 00271000
*   IF $24SYMNE¬='        '         /* IF THERE IS A SYM NME,        */ 00272000
*     THEN                                                         0159 00273000
         CLC   $24SYMNE(8,WAPTR),@CC00890                          0159 00274000
         BE    @RF00159                                            0159 00275000
*     HDRSYMNM=$24SYMNE;            /* THEN USE IT                   */ 00276000
         MVC   HDRSYMNM(8,HDRPTR),$24SYMNE(WAPTR)                  0160 00277000
*   ELSE                                                           0161 00278000
*     HDRPTR=HDRPTR-LENGTH(HDRSYMNM);/* IF NOT UP PTR IN BUFR        */ 00279000
         B     @RC00159                                            0161 00280000
@RF00159 SL    HDRPTR,@CF00039                                     0161 00281000
*   HDRECA='ECA';                   /* PUT 'ECA' IN BUFFER           */ 00282000
@RC00159 MVC   HDRECA(3,HDRPTR),@CC00892                           0162 00283000
*   HDRECA#=$ECA;                   /* GET ECA# FROM SECT PREF       */ 00284000
         L     @14,$LOWADDR(,WAPTR)                                0163 00285000
         LH    @09,RTNDISP(,@14)                                   0163 00286000
         ALR   @09,@14                                             0163 00287000
         MVC   HDRECA#(3,HDRPTR),$ECA(@09)                         0163 00288000
*   IF $DPREFNM=ON                  /* IF REFNUM TO BE               */ 00289000
*     THEN                          /* PRINTED,                      */ 00290000
         TM    $DPREFNM(PRTPTR),B'00000001'                        0164 00291000
         BNO   @RF00164                                            0164 00292000
*     DO;                           /*                               */ 00293000
*       HDREFNUM='REFNUM';          /* 'REFNUM' IN BUFR              */ 00294000
         MVC   HDREFNUM(6,HDRPTR),@CC00893                         0166 00295000
*       DPRWORK2=$PTRENUM;          /* PT 2 FROM PARM LIST           */ 00296000
         MVC   DPRWORK2(2,WAPTR),$PTRENUM(PRTPTR)                  0167 00297000
*       MVO(DPRWORK(4:5),$REFNUM);  /* CONV REFNUM TO OUT BUFR       */ 00298000
*                                                                  0168 00299000
         MVO   DPRWORK+3(2,WAPTR),$REFNUM(1,@09)                   0168 00300000
*       /*************************************************************/ 00301000
*       /*                                                           */ 00302000
*       /* ITACONV FROM(DPRWORK1)TO(HDREF#)COUNT(3)TYPE(HE) INVOKED  */ 00303000
*       /*                                                           */ 00304000
*       /*************************************************************/ 00305000
*                                                                  0169 00306000
*       ITATCFR=ADDR(DPRWORK1);     /* SET THE FROM ADDRESS          */ 00307000
         LA    @14,DPRWORK1(,WAPTR)                                0169 00308000
         ST    @14,ITATCFR                                         0169 00309000
*       ITATCTO=ADDR(HDREF#);       /* SET THE TO ADDRESS            */ 00310000
         LA    @14,HDREF#(,HDRPTR)                                 0170 00311000
         ST    @14,ITATCTO                                         0170 00312000
*       ITATCTP='1'B;               /* SET THE TYPE OF CONVERT BIT   */ 00313000
         OI    ITATCTP,B'10000000'                                 0171 00314000
*       ITATCNT=3;                  /* GIVE THE CONVERT BYTE COUNT   */ 00315000
         MVI   ITATCNT,X'03'                                       0172 00316000
*       R1=ADDR(ITATCPRM);          /* POINT TO CONVERT PARM LIST    */ 00317000
         LA    R1,ITATCPRM                                         0173 00318000
*       CALL ISTSC021;              /* CALL CONVERT DIRECTLY         */ 00319000
         L     @15,@CV00877                                        0174 00320000
         BALR  @14,@15                                             0174 00321000
*       HDREF#(1:1)=' ';            /* BLANK 1ST CHAR                */ 00322000
         MVI   HDREF#(HDRPTR),C' '                                 0175 00323000
*     END;                                                         0176 00324000
*   CALL S24C2500;                  /* PUT OUT THE HEADER            */ 00325000
@RF00164 BAL   @14,S24C2500                                        0177 00326000
*/********************************************************************/ 00327000
*/*      TEST DESCRIPTION                                            */ 00328000
*/********************************************************************/ 00329000
*                                                                  0178 00330000
*S24C0200:                                                         0178 00331000
*   IF $DESCRIP=OFF                 /* IF NOT TO PRINT DESCP LINE    */ 00332000
*     THEN                                                         0178 00333000
S24C0200 TM    $DESCRIP(PRTPTR),B'10000000'                        0178 00334000
         BZ    @RT00178                                            0178 00335000
*     GOTO S24C0250;                /* BYPASS THIS SECTION           */ 00336000
*   $DDRPTR=ADDR($PTDESCA);         /* PTR TO DESC LINE ADDR LIST    */ 00337000
         LA    @14,$PTDESCA(,DPRPTR)                               0180 00338000
         ST    @14,$DDRPTR(,WAPTR)                                 0180 00339000
*   $OUNTPTR=ADDR($PTDESCC);        /* PTR TO DESC BYTE CNT LIST     */ 00340000
         LA    @14,$PTDESCC(,PRTPTR)                               0181 00341000
         ST    @14,$OUNTPTR(,WAPTR)                                0181 00342000
*   $UMXX=$PTDESCL;                 /* INDEX = # OF DESC LINES       */ 00343000
         IC    @14,$PTDESCL(,PRTPTR)                               0182 00344000
         STC   @14,$UMXX(,WAPTR)                                   0182 00345000
*   CALL S24C1000;                  /* CHK PP LEV 1&3 & PRT LINE     */ 00346000
         BAL   @14,S24C1000                                        0183 00347000
*/********************************************************************/ 00348000
*/*      CAW CCW LINE                                                */ 00349000
*/********************************************************************/ 00350000
*                                                                  0184 00351000
*S24C0250:                                                         0184 00352000
*   IF $DPCCW=OFF                   /* IF CCW'S NOT TO BE PRINTD     */ 00353000
*     THEN                                                         0184 00354000
S24C0250 TM    $DPCCW(PRTPTR),B'01000000'                          0184 00355000
         BZ    @RT00184                                            0184 00356000
*     GOTO S24C0300;                /* GO ON TO CC'S                 */ 00357000
*   IF $PTCCWA=0                    /* IF CCW POINTER = 0            */ 00358000
*     THEN                          /* THEN SET                      */ 00359000
         L     @14,$PTCCWA(,DPRPTR)                                0186 00360000
         LTR   @14,@14                                             0186 00361000
         BNZ   @RF00186                                            0186 00362000
*S24C0252:                                                         0187 00363000
*     DO;                           /* RC = 0C                       */ 00364000
S24C0252 DS    0H                                                  0188 00365000
*       $24RETCD='0C'X;             /* GO TO CHK FOR CC'S            */ 00366000
         MVI   $24RETCD(WAPTR),X'0C'                               0188 00367000
*       GOTO S24C0300;                                             0189 00368000
         B     S24C0300                                            0189 00369000
*     END;                                                         0190 00370000
*   IF $PTNCCWS=0                   /* IF CCW COUNT =0               */ 00371000
*     THEN                                                         0191 00372000
@RF00186 CLI   $PTNCCWS(PRTPTR),0                                  0191 00373000
         BE    @RT00191                                            0191 00374000
*     GOTO S24C0252;                /* SET RC=0C AND CHK FOR CC      */ 00375000
*   DPRCAW='CAW';                   /* MOVE 'CAW' INTO OUT BUFR CONV    00376000
*                                      CAW TO OUT BUFR               */ 00377000
*                                                                  0193 00378000
         LA    @14,1976                                            0193 00379000
         ALR   @14,WAPTR                                           0193 00380000
         MVC   DPRCAW(3,@14),@CC00904                              0193 00381000
*   /*****************************************************************/ 00382000
*   /*                                                               */ 00383000
*   /* ITACONV FROM($PTCCWA)TO(DPRCAWAD)COUNT(4)TYPE(HE) INVOKED     */ 00384000
*   /*                                                               */ 00385000
*   /*****************************************************************/ 00386000
*                                                                  0194 00387000
*   ITATCFR=ADDR($PTCCWA);          /* SET THE FROM ADDRESS          */ 00388000
         LA    @00,$PTCCWA(,DPRPTR)                                0194 00389000
         ST    @00,ITATCFR                                         0194 00390000
*   ITATCTO=ADDR(DPRCAWAD);         /* SET THE TO ADDRESS            */ 00391000
         LA    @14,DPRCAWAD(,@14)                                  0195 00392000
         ST    @14,ITATCTO                                         0195 00393000
*   ITATCTP='1'B;                   /* SET THE TYPE OF CONVERT BIT   */ 00394000
         OI    ITATCTP,B'10000000'                                 0196 00395000
*   ITATCNT=4;                      /* GIVE THE CONVERT BYTE COUNT   */ 00396000
         MVI   ITATCNT,X'04'                                       0197 00397000
*   R1=ADDR(ITATCPRM);              /* POINT TO CONVERT PARM LIST    */ 00398000
         LA    R1,ITATCPRM                                         0198 00399000
*   CALL ISTSC021;                  /* CALL CONVERT DIRECTLY         */ 00400000
         L     @15,@CV00877                                        0199 00401000
         BALR  @14,@15                                             0199 00402000
*   DO $CTR=1 TO $PTNCCWS;          /* LOOP THRU CCW LIST            */ 00403000
         LA    @14,1                                               0200 00404000
         B     @DE00200                                            0200 00405000
@DL00200 DS    0H                                                  0201 00406000
*     DPRCCW='CCW';                 /* PUT 'CCW' IN BUFFER           */ 00407000
         LA    @14,1976                                            0201 00408000
         ALR   @14,WAPTR                                           0201 00409000
         MVC   DPRCCW(3,@14),@CC00905                              0201 00410000
*     CVD($CTR,DPRWORK2);           /* CONVERT CCW # TO DECIMAL      */ 00411000
         LH    @00,$CTR(,WAPTR)                                    0202 00412000
         CVD   @00,@TS00001                                        0202 00413000
         MVC   DPRWORK2(2,WAPTR),@TS00001+6                        0202 00414000
*     DPRWORK2=DPRWORK2/16;         /* GET RID OF SIGN BITS CONV CCW    00415000
*                                      # TO OUT BUFR                 */ 00416000
*                                                                  0203 00417000
         LH    @00,DPRWORK2(,WAPTR)                                0203 00418000
         N     @00,@CF01082                                        0203 00419000
         SRL   @00,4                                               0203 00420000
         STH   @00,DPRWORK2(,WAPTR)                                0203 00421000
*     /***************************************************************/ 00422000
*     /*                                                             */ 00423000
*     /* ITACONV FROM(DPRWORK2(2))TO(DPRCCW#)COUNT(1)TYPE(HE) INVOKED*/ 00424000
*     /*                                                             */ 00425000
*     /***************************************************************/ 00426000
*                                                                  0204 00427000
*     ITATCFR=ADDR(DPRWORK2(2));    /* SET THE FROM ADDRESS          */ 00428000
         LA    @00,DPRWORK2+1(,WAPTR)                              0204 00429000
         ST    @00,ITATCFR                                         0204 00430000
*     ITATCTO=ADDR(DPRCCW#);        /* SET THE TO ADDRESS            */ 00431000
         LA    @14,DPRCCW#(,@14)                                   0205 00432000
         ST    @14,ITATCTO                                         0205 00433000
*     ITATCTP='1'B;                 /* SET THE TYPE OF CONVERT BIT   */ 00434000
         OI    ITATCTP,B'10000000'                                 0206 00435000
*     ITATCNT=1;                    /* GIVE THE CONVERT BYTE COUNT   */ 00436000
         MVI   ITATCNT,X'01'                                       0207 00437000
*     R1=ADDR(ITATCPRM);            /* POINT TO CONVERT PARM LIST    */ 00438000
         LA    R1,ITATCPRM                                         0208 00439000
*     CALL ISTSC021;                /* CALL CONVERT DIRECTLY CONVERT    00440000
*                                      CCW TO WORK AREA              */ 00441000
*                                                                  0209 00442000
         L     @15,@CV00877                                        0209 00443000
         BALR  @14,@15                                             0209 00444000
*     /***************************************************************/ 00445000
*     /*                                                             */ 00446000
*     /* ITACONV FROM(S24CCWA($CTR))TO(DPRWORK)COUNT(8)TYPE(HE)      */ 00447000
*     /* INVOKED                                                     */ 00448000
*     /*                                                             */ 00449000
*     /***************************************************************/ 00450000
*                                                                  0210 00451000
*     ITATCFR=ADDR(S24CCWA($CTR));  /* SET THE FROM ADDRESS          */ 00452000
         LH    @14,$CTR(,WAPTR)                                    0210 00453000
         SLA   @14,3                                               0210 00454000
         L     @11,$PTCCWA(,DPRPTR)                                0210 00455000
         AL    @11,@CF01084                                        0210 00456000
         LA    @14,S24CCWA(@14,@11)                                0210 00457000
         ST    @14,ITATCFR                                         0210 00458000
*     ITATCTO=ADDR(DPRWORK);        /* SET THE TO ADDRESS            */ 00459000
         LA    @14,DPRWORK(,WAPTR)                                 0211 00460000
         ST    @14,ITATCTO                                         0211 00461000
*     ITATCTP='1'B;                 /* SET THE TYPE OF CONVERT BIT   */ 00462000
         OI    ITATCTP,B'10000000'                                 0212 00463000
*     ITATCNT=8;                    /* GIVE THE CONVERT BYTE COUNT   */ 00464000
         MVI   ITATCNT,X'08'                                       0213 00465000
*     R1=ADDR(ITATCPRM);            /* POINT TO CONVERT PARM LIST    */ 00466000
         LA    R1,ITATCPRM                                         0214 00467000
*     CALL ISTSC021;                /* CALL CONVERT DIRECTLY         */ 00468000
         L     @15,@CV00877                                        0215 00469000
         BALR  @14,@15                                             0215 00470000
*     DPRCMDCD=S24CCWCD;            /* MOVE CMND CODE TO BUFR        */ 00471000
         LA    @14,1976                                            0216 00472000
         ALR   @14,WAPTR                                           0216 00473000
         LA    @11,2376                                            0216 00474000
         ALR   @11,WAPTR                                           0216 00475000
         MVC   DPRCMDCD(2,@14),S24CCWCD(@11)                       0216 00476000
*     DPRDATA=S24CCWDA;             /* MOVE ADDR TO BUFR             */ 00477000
         MVC   DPRDATA(6,@14),S24CCWDA(@11)                        0217 00478000
*     DPRSPARE=S24CCWEX;            /* MOVE IN UNUSED BYTES          */ 00479000
         MVC   DPRSPARE(2,@14),S24CCWEX(@11)                       0218 00480000
*     DPRFLAGS=S24CCWFL;            /* MOVE FLAGS TO BUFR            */ 00481000
         MVC   DPRFLAGS(2,@14),S24CCWFL(@11)                       0219 00482000
*     DPRCOUNT=S24CCWCT;            /* MOVE COUNT TO BUFR            */ 00483000
         MVC   DPRCOUNT(4,@14),S24CCWCT(@11)                       0220 00484000
*     IF $CTR=$PTFCCWS&             /* IF THIS IS THE FAILING CCW    */ 00485000
*         $CCWERR=ON                /* AND IT REALLY WAS AN ERROR    */ 00486000
*       THEN                                                       0221 00487000
         LH    @00,$CTR(,WAPTR)                                    0221 00488000
         SLR   @11,@11                                             0221 00489000
         IC    @11,$PTFCCWS(,PRTPTR)                               0221 00490000
         CR    @00,@11                                             0221 00491000
         BNE   @RF00221                                            0221 00492000
         TM    $CCWERR(PRTPTR),B'01000000'                         0221 00493000
         BNO   @RF00221                                            0221 00494000
*       DPRCCWER='*';               /* PUT AN '*' IN THE PRT BFR     */ 00495000
         MVI   DPRCCWER(@14),C'*'                                  0222 00496000
*     CALL S24C2000;                /* CHECK FOR PP LEVELS 2 & 3 AND    00497000
*                                      PUT OUT LINE                  */ 00498000
@RF00221 BAL   @14,S24C2000                                        0223 00499000
*   END;                                                           0224 00500000
*                                                                  0224 00501000
         LA    @14,1                                               0224 00502000
         AH    @14,$CTR(,WAPTR)                                    0224 00503000
@DE00200 STH   @14,$CTR(,WAPTR)                                    0224 00504000
         SLR   @00,@00                                             0224 00505000
         IC    @00,$PTNCCWS(,PRTPTR)                               0224 00506000
         CR    @14,@00                                             0224 00507000
         BNH   @DL00200                                            0224 00508000
*/********************************************************************/ 00509000
*/*      EXPECTED/RECEIVED CONDITION CODE LINE                       */ 00510000
*/********************************************************************/ 00511000
*                                                                  0225 00512000
*S24C0300:                                                         0225 00513000
*   IF $CONCODE=OFF                 /* IF NOT TO PRINT CC LINE       */ 00514000
*     THEN                                                         0225 00515000
S24C0300 TM    $CONCODE(PRTPTR),B'00000100'                        0225 00516000
         BZ    @RT00225                                            0225 00517000
*     GOTO S24C0350;                /* GO CHECK FOR CSW LINE         */ 00518000
*   IF $PTECC=0                     /* IF NO EXPECTED CC IS GIVEN    */ 00519000
*     THEN                          /*                               */ 00520000
         CLI   $PTECC(PRTPTR),0                                    0227 00521000
         BNE   @RF00227                                            0227 00522000
*S24C0310:                                                         0228 00523000
*     DO;                           /* THEN                          */ 00524000
S24C0310 DS    0H                                                  0229 00525000
*       CALL S24C2600;              /* BLANK OUT BUFFER              */ 00526000
         BAL   @14,S24C2600                                        0229 00527000
*       $24RETCD='0C'X;             /* SET RC = 0C &                 */ 00528000
         MVI   $24RETCD(WAPTR),X'0C'                               0230 00529000
*       GOTO S24C0350;              /* GO CHK FOR XPTD CSW           */ 00530000
         B     S24C0350                                            0231 00531000
*     END;                                                         0232 00532000
*   CCXPTDCD=$PTECC;                /* PUT XPTD CC IN PRT BFR        */ 00533000
@RF00227 LA    @14,1976                                            0233 00534000
         ALR   @14,WAPTR                                           0233 00535000
         MVC   CCXPTDCD(1,@14),$PTECC(PRTPTR)                      0233 00536000
*   IF $PRTACCC¬=0                  /* IF ACTUAL CC ADDR GIVEN       */ 00537000
*     THEN                                                         0234 00538000
         L     @11,$PRTACCC(,DPRPTR)                               0234 00539000
         LTR   @11,@11                                             0234 00540000
         BZ    @RF00234                                            0234 00541000
*     CCCONDCD=S24CC;               /* PUT CC IN PRT BUFR            */ 00542000
         IC    @00,S24CC(,@11)                                     0235 00543000
         STC   @00,CCCONDCD(,@14)                                  0235 00544000
*   ELSE                                                           0236 00545000
*     DO;                           /* IF CC ADDRESS NOT GIVEN       */ 00546000
         B     @RC00234                                            0236 00547000
@RF00234 DS    0H                                                  0237 00548000
*       S24CCREQ=ON;                /* SEARCH TECB                   */ 00549000
         OI    S24CCREQ+2680(WAPTR),B'10000000'                    0237 00550000
*       CALL S24C3000;                                             0238 00551000
         BAL   @14,S24C3000                                        0238 00552000
*       S24CCREQ=OFF;               /* TURN OFF CC SRCH FLG          */ 00553000
         LA    @14,2680                                            0239 00554000
         ALR   @14,WAPTR                                           0239 00555000
         NI    S24CCREQ(@14),B'01111111'                           0239 00556000
*       IF S24TCBER=ON              /* IF NO TECB ADDR GIVEN         */ 00557000
*         THEN                                                     0240 00558000
         TM    S24TCBER(@14),B'00010000'                           0240 00559000
         BO    @RT00240                                            0240 00560000
*         GOTO S24C0310;            /* (RC=0C) CHK XPTD CSW          */ 00561000
*       IF S24SCHFL=ON THEN         /* IF SEARCH FAILED              */ 00562000
         TM    S24SCHFL(@14),B'00001000'                           0242 00563000
         BNO   @RF00242                                            0242 00564000
*         DO;                       /* AND                           */ 00565000
*           IF TCBQUEUE=ON          /* IF I/O QUEUED                 */ 00566000
*             THEN                  /* PUT 'QUEUED' IN BFR           */ 00567000
         TM    TCBQUEUE(TECBPTR),B'10000000'                       0244 00568000
         BNO   @RF00244                                            0244 00569000
*             DO;                                                  0245 00570000
*               CCQUEUED='QUEUED';  /* IF NOT QUEUED, PUT 0          */ 00571000
         MVC   CCQUEUED+1976(6,WAPTR),@CC00912                     0246 00572000
*               GOTO S24C0320;                                     0247 00573000
         B     S24C0320                                            0247 00574000
*             END;                                                 0248 00575000
*           ELSE                    /* IN BFR- SIO ISSUED            */ 00576000
*             CCCONDCD='0';         /* NO INTERRUPTS                 */ 00577000
@RF00244 MVI   CCCONDCD+1976(WAPTR),C'0'                           0249 00578000
*         END;                      /* IF SEARCH SUCCESS PUT         */ 00579000
*     END;                                                         0251 00580000
@RF00242 DS    0H                                                  0252 00581000
*   IF CCCONDCD='FF'X               /* IF CONDITION CODE IS FF       */ 00582000
*     THEN                                                         0252 00583000
@RC00234 LA    @14,1976                                            0252 00584000
         ALR   @14,WAPTR                                           0252 00585000
         CLI   CCCONDCD(@14),X'FF'                                 0252 00586000
         BNE   @RF00252                                            0252 00587000
*     CCCONDCD='0';                 /* (FROM OLD EXIO) CHANG TO 0    */ 00588000
         MVI   CCCONDCD(@14),C'0'                                  0253 00589000
*   IF CCCONDCD(1:4)¬='1111'B THEN  /* IF IT IS NOT A PRINTABLE #    */ 00590000
@RF00252 TM    CCCONDCD+1976(WAPTR),B'11110000'                    0254 00591000
         BNO   @RT00254                                            0254 00592000
*     GOTO S24C0310;                /* RC=0C, GO CHK FOR XPTD CSW    */ 00593000
*S24C0320:                                                         0256 00594000
*   CCXPTDCC='XPTD CC';             /* PUT 'XPTD CC' IN PRT BUFR     */ 00595000
S24C0320 LA    @14,1976                                            0256 00596000
         ALR   @14,WAPTR                                           0256 00597000
         MVC   CCXPTDCC(7,@14),@CC00917                            0256 00598000
*   CCRCVDCC='RCVD CC';             /* PUT 'RCVD CC' IN PRT BUFR     */ 00599000
         MVC   CCRCVDCC(7,@14),@CC00919                            0257 00600000
*   IF $CCERROR=ON                  /* IF CC WAS IN ERROR            */ 00601000
*     THEN                                                         0258 00602000
         TM    $CCERROR(PRTPTR),B'00000010'                        0258 00603000
         BNO   @RF00258                                            0258 00604000
*     CCERROR='*';                  /* PUT '*' IN PRINT LINE         */ 00605000
         MVI   CCERROR(@14),C'*'                                   0259 00606000
*   CALL S24C2000;                  /* CHK FOR PP LEVELS 2 & 3 OUTPUT   00607000
*                                      LINE                          */ 00608000
@RF00258 BAL   @14,S24C2000                                        0260 00609000
*/********************************************************************/ 00610000
*/*      EXPECTED CSW/PSW LINE                                       */ 00611000
*/********************************************************************/ 00612000
*                                                                  0261 00613000
*S24C0350:                                                         0261 00614000
*   CSWXPTRC='XPTD CSW1';           /* PUT 'XPTD CSW1' IN PRT BFR    */ 00615000
S24C0350 LA    @14,1976                                            0261 00616000
         ALR   @14,WAPTR                                           0261 00617000
         MVC   CSWXPTRC(9,@14),@CC00920                            0261 00618000
*   IF $PSWCSW=ON                   /* IF THIS IS A PSW LINE         */ 00619000
*     THEN                                                         0262 00620000
         TM    $PSWCSW(PRTPTR),B'00000001'                         0262 00621000
         BNO   @RF00262                                            0262 00622000
*     CSWPSW1='P';                  /* CHANGE CSW TO PSW IN BFR      */ 00623000
         MVI   CSWPSW1(@14),C'P'                                   0263 00624000
*   BFRPTR=ADDR(CSW1KEY);           /* LOC IN BUFR FOR CSW/PSW       */ 00625000
@RF00262 LA    BFRPTR,CSW1KEY+1976(,WAPTR)                         0264 00626000
*   MASK=$PTXCSWM;                  /* SET UP CSW1 MASK              */ 00627000
         MVC   MASK(1),$PTXCSWM(PRTPTR)                            0265 00628000
*   IF $XPDCSW1=OFF THEN            /* IF NOT TO PRT XPTD CSW1       */ 00629000
         TM    $XPDCSW1(PRTPTR),B'00100000'                        0266 00630000
         BNZ   @RF00266                                            0266 00631000
*S24C0353:                                                         0267 00632000
*     DO;                                                          0267 00633000
S24C0353 DS    0H                                                  0268 00634000
*       IF $XPDCSW2=OFF             /* AND NO CSW2 EITHER            */ 00635000
*         THEN                                                     0268 00636000
         TM    $XPDCSW2(PRTPTR),B'00001000'                        0268 00637000
         BZ    @RT00268                                            0268 00638000
*         GOTO S24C0400;            /* CHK FOR RECEIVED CSW          */ 00639000
*       CSW#='2';                   /* ELSE CHNG CSW/PSW1 TO 2       */ 00640000
         MVI   CSW#+1976(WAPTR),C'2'                               0270 00641000
*       GOTO S24C0355;              /* GO CHK ON CSW/PSW2            */ 00642000
         B     S24C0355                                            0271 00643000
*     END;                                                         0272 00644000
*   IF $PTXCSW1=0                   /* IF CSW1 ADDR = 0              */ 00645000
*     THEN                          /*                               */ 00646000
@RF00266 L     @14,$PTXCSW1(,DPRPTR)                               0273 00647000
         LTR   @14,@14                                             0273 00648000
         BNZ   @RF00273                                            0273 00649000
*     DO;                           /*                               */ 00650000
*       $24RETCD='0C'X;             /* SET RC = 0C                   */ 00651000
         MVI   $24RETCD(WAPTR),X'0C'                               0275 00652000
*       GOTO S24C0353;              /* CHK FOR CSW2 PRINT            */ 00653000
         B     S24C0353                                            0276 00654000
*     END;                                                         0277 00655000
*   CSWPSWPT=$PTXCSW1;              /* PT TO PSW1/CSW1 TO XLATE      */ 00656000
@RF00273 L     @14,$PTXCSW1(,DPRPTR)                               0278 00657000
         ST    @14,CSWPSWPT                                        0278 00658000
*   CALL S24C5000;                  /* XLATE & PUT CSW/PSW IN BUF    */ 00659000
         BAL   @14,S24C5000                                        0279 00660000
*   IF $XPDCSW2=OFF                 /* IF NOT TO PRINT CSW2          */ 00661000
*     THEN                                                         0280 00662000
         TM    $XPDCSW2(PRTPTR),B'00001000'                        0280 00663000
         BZ    @RT00280                                            0280 00664000
*     GOTO S24C0360;                /* THEN OUTPUT LINE              */ 00665000
*   CSW2CSW2='CSW2';                /* ELSE PUT 'CSW2' IN BFR        */ 00666000
         LA    @14,1976                                            0282 00667000
         ALR   @14,WAPTR                                           0282 00668000
         MVC   CSW2CSW2(4,@14),@CC00931                            0282 00669000
*   IF $PSWCSW=ON                   /* IF PSW PRINT,                 */ 00670000
*     THEN                                                         0283 00671000
         TM    $PSWCSW(PRTPTR),B'00000001'                         0283 00672000
         BNO   @RF00283                                            0283 00673000
*     CSWPSW2='P';                  /* CHANGE CSW2 TO PSW2           */ 00674000
         MVI   CSWPSW2(@14),C'P'                                   0284 00675000
*   BFRPTR=ADDR(CSW2KEY);           /* LOC IN BFR FOR CSW2/PSW2      */ 00676000
@RF00283 LA    BFRPTR,CSW2KEY+1976(,WAPTR)                         0285 00677000
*S24C0355:                                                         0286 00678000
*   MASK=MASK*16;                   /* SHIFT CSW2 MSK TO POSITION    */ 00679000
S24C0355 SLR   @14,@14                                             0286 00680000
         IC    @14,MASK                                            0286 00681000
         SLA   @14,4                                               0286 00682000
         STC   @14,MASK                                            0286 00683000
*   IF $PTXCSW2=0                   /* IF CSW2 ADDR = 0              */ 00684000
*     THEN                          /*                               */ 00685000
         L     @14,$PTXCSW2(,DPRPTR)                               0287 00686000
         LTR   @14,@14                                             0287 00687000
         BNZ   @RF00287                                            0287 00688000
*     DO;                           /*                               */ 00689000
*       $24RETCD='0C'X;             /* SET RC = 0C                   */ 00690000
         MVI   $24RETCD(WAPTR),X'0C'                               0289 00691000
*       GOTO S24C0400;              /* CHK FOR RCVD CSW              */ 00692000
         B     S24C0400                                            0290 00693000
*     END;                                                         0291 00694000
*   CSWPSWPT=$PTXCSW2;              /* PT TO PSW2/CSW2 TO XLATE      */ 00695000
@RF00287 L     @14,$PTXCSW2(,DPRPTR)                               0292 00696000
         ST    @14,CSWPSWPT                                        0292 00697000
*   CALL S24C5000;                  /* XLATE & PUT CSW/PSW IN BFR    */ 00698000
         BAL   @14,S24C5000                                        0293 00699000
*S24C0360:                                                         0294 00700000
*   CALL S24C2000;                  /* CHK PP LEVL 2&3, PRT LINE     */ 00701000
S24C0360 BAL   @14,S24C2000                                        0294 00702000
*/********************************************************************/ 00703000
*/*      RECEIVED CSW/PSW LINE                                       */ 00704000
*/********************************************************************/ 00705000
*                                                                  0295 00706000
*S24C0400:                                                         0295 00707000
*   CSWXPTRC='RCVD CSW1';           /* PUT'RCVD CSW1' IN BUFR        */ 00708000
S24C0400 LA    @14,1976                                            0295 00709000
         ALR   @14,WAPTR                                           0295 00710000
         MVC   CSWXPTRC(9,@14),@CC00934                            0295 00711000
*   CSW1NONE='NONE';                /* ASSUME CSW1 NONE              */ 00712000
         MVC   CSW1NONE(4,@14),@CC00880                            0296 00713000
*   IF $PSWCSW=ON                   /* IF TO PRINT PSW               */ 00714000
*     THEN                                                         0297 00715000
         TM    $PSWCSW(PRTPTR),B'00000001'                         0297 00716000
         BNO   @RF00297                                            0297 00717000
*     CSWPSW1='P';                  /* CHANGE CSW1 TO PSW1           */ 00718000
         MVI   CSWPSW1(@14),C'P'                                   0298 00719000
*   IF $CSW1ERR=ON                  /* IF ERROR PSW/CSW 1/2          */ 00720000
*     THEN                                                         0299 00721000
@RF00297 TM    $CSW1ERR(PRTPTR),B'00100000'                        0299 00722000
         BNO   @RF00299                                            0299 00723000
*     CSWPSWER='*';                 /* PREFIX LINE WITH *            */ 00724000
         MVI   CSWPSWER+1976(WAPTR),C'*'                           0300 00725000
*   BFRPTR=ADDR(CSW1KEY);           /* POINT TO FLD IN BFR           */ 00726000
@RF00299 LA    BFRPTR,CSW1KEY+1976(,WAPTR)                         0301 00727000
*   MASK='1111'B;                   /* SET MASK TO PRT ALL FLDS      */ 00728000
         MVI   MASK,B'11110000'                                    0302 00729000
*   IF $RCVCSW1=OFF                 /* IF NOT TO PRT RCVD CSW/       */ 00730000
*     THEN                          /*                               */ 00731000
         TM    $RCVCSW1(PRTPTR),B'00010000'                        0303 00732000
         BNZ   @RF00303                                            0303 00733000
*     DO;                           /* AND                           */ 00734000
*       IF $RCVCSW2=OFF             /* NOT PRT CSW2 EITHER           */ 00735000
*         THEN                      /*                               */ 00736000
         TM    $RCVCSW2(PRTPTR),B'00000100'                        0305 00737000
         BNZ   @RF00305                                            0305 00738000
*S24C0402:                                                         0306 00739000
*         DO;                       /*                               */ 00740000
S24C0402 DS    0H                                                  0307 00741000
*           CALL S24C2600;          /* BLANK OUT BUFFER              */ 00742000
         BAL   @14,S24C2600                                        0307 00743000
*           GOTO S24C0450;          /* CHK ON XPTD SENSE             */ 00744000
         B     S24C0450                                            0308 00745000
*         END;                                                     0309 00746000
*       ELSE                                                       0310 00747000
*         DO;                       /* ELSE                          */ 00748000
@RF00305 DS    0H                                                  0311 00749000
*S24C0405:                                                         0311 00750000
*           CSW#='2';               /* CHNG CSW1 TO 2                */ 00751000
S24C0405 MVI   CSW#+1976(WAPTR),C'2'                               0311 00752000
*           GOTO S24C0440;          /* GO PICK UP RCVD CSW2          */ 00753000
         B     S24C0440                                            0312 00754000
*         END;                                                     0313 00755000
*     END;                                                         0314 00756000
*   IF $PTRCSW1=0                   /* IF CSW1 ADDR = 0              */ 00757000
*     THEN                          /* THEN                          */ 00758000
@RF00303 L     @14,$PTRCSW1(,DPRPTR)                               0315 00759000
         LTR   @14,@14                                             0315 00760000
         BNZ   @RF00315                                            0315 00761000
*     DO;                           /* SEARCH TECB                   */ 00762000
*       CALL S24C3000;                                             0317 00763000
         BAL   @14,S24C3000                                        0317 00764000
*       IF S24TCBER=ON              /* IF TECB ADDR = 0              */ 00765000
*         THEN                      /* (RC = 0C SET IN SRCH RTN)     */ 00766000
         LA    @14,2680                                            0318 00767000
         ALR   @14,WAPTR                                           0318 00768000
         TM    S24TCBER(@14),B'00010000'                           0318 00769000
         BO    @RT00318                                            0318 00770000
*         GOTO S24C0405;            /* CHK ON CSW2                   */ 00771000
*       IF S24SCHFL=ON              /* IF TECB SEARCH FAILED,        */ 00772000
*         THEN                                                     0320 00773000
         TM    S24SCHFL(@14),B'00001000'                           0320 00774000
         BO    @RT00320                                            0320 00775000
*         GOTO S24C0430;            /* GO CHK FOR CSW/PSW2           */ 00776000
*     END;                                                         0322 00777000
*   ELSE                                                           0323 00778000
*     CSWPSWPT=$PTRCSW1;            /* USE CSWTPR GIVEN              */ 00779000
         B     @RC00315                                            0323 00780000
@RF00315 L     @14,$PTRCSW1(,DPRPTR)                               0323 00781000
         ST    @14,CSWPSWPT                                        0323 00782000
*   CALL S24C5000;                  /* XLATE & PUT CSW/PSW IN BFR    */ 00783000
@RC00315 BAL   @14,S24C5000                                        0324 00784000
*S24C0430:                                                         0325 00785000
*   IF $RCVCSW2=OFF                 /* IF NO CSW2 TO PRINT           */ 00786000
*     THEN                                                         0325 00787000
S24C0430 TM    $RCVCSW2(PRTPTR),B'00000100'                        0325 00788000
         BZ    @RT00325                                            0325 00789000
*     GOTO S24C0445;                /* OUTPUT LINE                   */ 00790000
*   CSW2CSW2='CSW2';                /* PUT 'CSW2' IN BUFR            */ 00791000
         LA    @14,1976                                            0327 00792000
         ALR   @14,WAPTR                                           0327 00793000
         MVC   CSW2CSW2(4,@14),@CC00931                            0327 00794000
*   CSW2NONE='NONE';                /* ASSUME NONE FOR CSW2          */ 00795000
         MVC   CSW2NONE(4,@14),@CC00880                            0328 00796000
*   IF $PSWCSW=ON                   /* IF A PSW TO PRINT             */ 00797000
*     THEN                                                         0329 00798000
         TM    $PSWCSW(PRTPTR),B'00000001'                         0329 00799000
         BNO   @RF00329                                            0329 00800000
*     CSWPSW2='P';                  /* CHANGE CSW2 TO PSW2           */ 00801000
         MVI   CSWPSW2(@14),C'P'                                   0330 00802000
*   BFRPTR=ADDR(CSW2KEY);           /* LOC IN PRT BFR FOR RCVDCSW    */ 00803000
@RF00329 LA    BFRPTR,CSW2KEY+1976(,WAPTR)                         0331 00804000
*S24C0440:                                                         0332 00805000
*   IF $PTRCSW2=0                   /* IF NO RCVD CSW2 ADDR GIVEN    */ 00806000
*     THEN                          /* SEARCH TECB	                  */ 00807000
S24C0440 L     @14,$PTRCSW2(,DPRPTR)                               0332 00808000
         LTR   @14,@14                                             0332 00809000
         BNZ   @RF00332                                            0332 00810000
*     DO;                                                          0333 00811000
*       S24CSW2R=ON;                /* LOOK FOR 2ND CSW              */ 00812000
         OI    S24CSW2R+2680(WAPTR),B'01000000'                    0334 00813000
*       CALL S24C3000;              /*                               */ 00814000
         BAL   @14,S24C3000                                        0335 00815000
*       S24CSW2R=OFF;               /* RESET 2ND CSW SRCH FLG        */ 00816000
         LA    @14,2680                                            0336 00817000
         ALR   @14,WAPTR                                           0336 00818000
         NI    S24CSW2R(@14),B'10111111'                           0336 00819000
*       IF S24TCBER=ON              /* IF TECB ADDR = 0              */ 00820000
*         THEN                      /* (RC=0C SET IN SRCH RTN)       */ 00821000
         TM    S24TCBER(@14),B'00010000'                           0337 00822000
         BO    @RT00337                                            0337 00823000
*         GOTO S24C0450;            /* GO CHK ON XPTD SENSE          */ 00824000
*       IF S24SCHFL=ON THEN         /* IF SEARCH FAILED, PRNT        */ 00825000
         TM    S24SCHFL(@14),B'00001000'                           0339 00826000
         BO    @RT00339                                            0339 00827000
*         GOTO S24C0445;            /* BYPASS LINE SETUP             */ 00828000
*     END;                                                         0341 00829000
*   ELSE                                                           0342 00830000
*     CSWPSWPT=$PTRCSW2;            /* USE CSW2 PTR GIVNE            */ 00831000
         B     @RC00332                                            0342 00832000
@RF00332 L     @14,$PTRCSW2(,DPRPTR)                               0342 00833000
         ST    @14,CSWPSWPT                                        0342 00834000
*   CALL S24C5000;                  /* XLATE & PUT CSW/PSW IN BFR    */ 00835000
@RC00332 BAL   @14,S24C5000                                        0343 00836000
*S24C0445:                                                         0344 00837000
*   CALL S24C2000;                  /* CHK PP LEV 2/3,OUTPUT LINE    */ 00838000
S24C0445 BAL   @14,S24C2000                                        0344 00839000
*/********************************************************************/ 00840000
*/*      EXPECTED SENSE LINES                                        */ 00841000
*/********************************************************************/ 00842000
*                                                                  0345 00843000
*S24C0450:                                                         0345 00844000
*   IF $XPTDSNS=OFF                 /* IF NOT TO PRT XPTD SENSE      */ 00845000
*     THEN                                                         0345 00846000
S24C0450 TM    $XPTDSNS(PRTPTR),B'00000010'                        0345 00847000
         BZ    @RT00345                                            0345 00848000
*     GOTO S24C0500;                /* GO CHK FOR RCVD SNS           */ 00849000
*   IF $PTXSNSA=0|$PTXSNSC=0        /* IF XPTD SNS ADDR OR COUNT     */ 00850000
*     THEN                          /* = 0                           */ 00851000
         L     @14,$PTXSNSA(,DPRPTR)                               0347 00852000
         LTR   @14,@14                                             0347 00853000
         BZ    @RT00347                                            0347 00854000
         CLI   $PTXSNSC(PRTPTR),0                                  0347 00855000
         BNE   @RF00347                                            0347 00856000
@RT00347 DS    0H                                                  0348 00857000
*     DO;                           /* THEN                          */ 00858000
*       $24RETCD='0C'X;             /* RC = 0C                       */ 00859000
         MVI   $24RETCD(WAPTR),X'0C'                               0349 00860000
*       GOTO S24C0500;              /* GO CHK FOR RCVD SNS           */ 00861000
         B     S24C0500                                            0350 00862000
*     END;                                                         0351 00863000
*   $NSXX=$PTXSNSC;                 /* COUNT OF SENSE DATA           */ 00864000
@RF00347 SLR   @14,@14                                             0352 00865000
         IC    @14,$PTXSNSC(,PRTPTR)                               0352 00866000
         STH   @14,$NSXX(,WAPTR)                                   0352 00867000
*   $NSPTR=$PTXSNSA;                /* PTR TO SENSE DATA             */ 00868000
         L     @14,$PTXSNSA(,DPRPTR)                               0353 00869000
         ST    @14,$NSPTR(,WAPTR)                                  0353 00870000
*   SNSXPRCV='XPTD SNS';            /* PUT'XPTD SNS' IN BUFR         */ 00871000
         MVC   SNSXPRCV+1976(8,WAPTR),@CC00950                     0354 00872000
*   CALL S24C6000;                  /* STRUCTURE & PRINT SNS LNES    */ 00873000
         BAL   @14,S24C6000                                        0355 00874000
*/********************************************************************/ 00875000
*/*      RECEIVED SENSE LINES                                        */ 00876000
*/********************************************************************/ 00877000
*                                                                  0356 00878000
*S24C0500:                                                         0356 00879000
*   IF $RCVDSNS=OFF                 /* IF NOT TO PRT RCVD SNS        */ 00880000
*     THEN                                                         0356 00881000
S24C0500 TM    $RCVDSNS(PRTPTR),B'00000001'                        0356 00882000
         BZ    @RT00356                                            0356 00883000
*     GOTO S24C0550;                /* GO CHK OUT XPTD DATA          */ 00884000
*   IF $PTRSNSC=0                   /* IF SENSE COUNT IS 0           */ 00885000
*     THEN                          /*                               */ 00886000
         CLI   $PTRSNSC(PRTPTR),0                                  0358 00887000
         BNE   @RF00358                                            0358 00888000
*     DO;                           /*                               */ 00889000
*S24C0510:                                                         0360 00890000
*       CALL S24C2600;              /* BLANK BUFFER                  */ 00891000
S24C0510 BAL   @14,S24C2600                                        0360 00892000
*       $24RETCD='0C'X;             /* SET RC=0C                     */ 00893000
         MVI   $24RETCD(WAPTR),X'0C'                               0361 00894000
*       GOTO S24C0550;              /* AND GO CHK XPTD DATA          */ 00895000
         B     S24C0550                                            0362 00896000
*     END;                                                         0363 00897000
*   SNSXPRCV='RCVD SNS';            /* PUT 'RCVD SNS' IN BUFR        */ 00898000
@RF00358 LA    @14,1976                                            0364 00899000
         ALR   @14,WAPTR                                           0364 00900000
         MVC   SNSXPRCV(8,@14),@CC00956                            0364 00901000
*   IF $SENSERR=ON                  /* IF SNS AN ERROR               */ 00902000
*     THEN                                                         0365 00903000
         TM    $SENSERR(PRTPTR),B'00000010'                        0365 00904000
         BNO   @RF00365                                            0365 00905000
*     SNSASTRK='*';                 /* PRECEDE LINE WITH *           */ 00906000
         MVI   SNSASTRK(@14),C'*'                                  0366 00907000
*   IF $PTRSNSA¬=0                  /* IF ADDR OF RCVD SNS GIVEN     */ 00908000
*     THEN                                                         0367 00909000
@RF00365 L     @14,$PTRSNSA(,DPRPTR)                               0367 00910000
         LTR   @14,@14                                             0367 00911000
         BZ    @RF00367                                            0367 00912000
*     $NSPTR=$PTRSNSA;              /* USE IT TO PRINT OUT LINES     */ 00913000
         ST    @14,$NSPTR(,WAPTR)                                  0368 00914000
*   ELSE                            /*                               */ 00915000
*     DO;                           /* IF ADDR NOT GIVEN             */ 00916000
         B     @RC00367                                            0369 00917000
@RF00367 DS    0H                                                  0370 00918000
*       S24SNSRQ=ON;                /* SEARCH TECB FOR SNS FLD       */ 00919000
         OI    S24SNSRQ+2680(WAPTR),B'00100000'                    0370 00920000
*       CALL S24C3000;                                             0371 00921000
         BAL   @14,S24C3000                                        0371 00922000
*       S24SNSRQ=OFF;                                              0372 00923000
         LA    @14,2680                                            0372 00924000
         ALR   @14,WAPTR                                           0372 00925000
         NI    S24SNSRQ(@14),B'11011111'                           0372 00926000
*       IF S24TCBER=ON              /* IF TECB ADDR = 0              */ 00927000
*         THEN                                                     0373 00928000
         TM    S24TCBER(@14),B'00010000'                           0373 00929000
         BO    @RT00373                                            0373 00930000
*         GOTO S24C0510;            /* RC=0C GO CHK ON XPTD DATA     */ 00931000
*       IF S24SCHFL=ON              /* IF SEARCH FAILED              */ 00932000
*         THEN                      /* PUT 'NONE' IN PRT BUFR        */ 00933000
         TM    S24SCHFL(@14),B'00001000'                           0375 00934000
         BNO   @RF00375                                            0375 00935000
*         DO;                                                      0376 00936000
*           SNSNONE='NONE';                                        0377 00937000
         MVC   SNSNONE+1976(4,WAPTR),@CC00880                      0377 00938000
*           CALL S24C2000;          /* CHK PP 2&3 AND PRT LINE       */ 00939000
         BAL   @14,S24C2000                                        0378 00940000
*           GOTO S24C0550;          /* THAT'S IT, CHK XPTD DATA      */ 00941000
         B     S24C0550                                            0379 00942000
*         END;                                                     0380 00943000
*     END;                                                         0381 00944000
@RF00375 DS    0H                                                  0382 00945000
*   $NSXX=$PTRSNSC;                 /* # OF SNS BYTES TO PRINT       */ 00946000
@RC00367 SLR   @14,@14                                             0382 00947000
         IC    @14,$PTRSNSC(,PRTPTR)                               0382 00948000
         STH   @14,$NSXX(,WAPTR)                                   0382 00949000
*   CALL S24C6000;                  /* GO SET UP & OUTPUT LINE(S)    */ 00950000
         BAL   @14,S24C6000                                        0383 00951000
*/********************************************************************/ 00952000
*/*      EXPECTED DATA LINE(S)                                       */ 00953000
*/********************************************************************/ 00954000
*                                                                  0384 00955000
*S24C0550:                                                         0384 00956000
*   IF $XPTDATA=OFF                 /* IF NOT TO PRINT XPTD DATA     */ 00957000
*     THEN                                                         0384 00958000
S24C0550 TM    $XPTDATA(PRTPTR),B'10000000'                        0384 00959000
         BZ    @RT00384                                            0384 00960000
*     GOTO S24C0600;                /* GO CHK RCVD DATA              */ 00961000
*   $ATAPTR=$PTXDATA;               /* PT TO XPTD DATA               */ 00962000
         L     @14,$PTXDATA(,DPRPTR)                               0386 00963000
         ST    @14,$ATAPTR(,WAPTR)                                 0386 00964000
*   $ATACNT=$PTXDATC;               /* XPTD DATA COUNT               */ 00965000
         MVC   $ATACNT(2,WAPTR),$PTXDATC(PRTPTR)                   0387 00966000
*   DATAXPRC='XPTD DATA';           /* PUT 'XPTD DATA IN BFR         */ 00967000
         MVC   DATAXPRC+1976(9,WAPTR),@CC00959                     0388 00968000
*   CALL S24C7000;                  /* SET UP & OUTPUT LINES         */ 00969000
         BAL   @14,S24C7000                                        0389 00970000
*/********************************************************************/ 00971000
*/*      RECEIVED DATA LINE(S)                                       */ 00972000
*/********************************************************************/ 00973000
*                                                                  0390 00974000
*S24C0600:                                                         0390 00975000
*   IF $RCVDATA=OFF                 /* IF NOT TO PRT RCVD DATA       */ 00976000
*     THEN                                                         0390 00977000
S24C0600 TM    $RCVDATA(PRTPTR),B'01000000'                        0390 00978000
         BZ    @RT00390                                            0390 00979000
*     GOTO S24C0650;                /* GO CHK ON WRITTEN DATA        */ 00980000
*   $ATAPTR=$PTRDATA;               /* PT TO RCVD DATA               */ 00981000
         L     @14,$PTRDATA(,DPRPTR)                               0392 00982000
         ST    @14,$ATAPTR(,WAPTR)                                 0392 00983000
*   $ATACNT=$PTRDATC;               /* COUNT OF RCVD DATA            */ 00984000
         MVC   $ATACNT(2,WAPTR),$PTRDATC(PRTPTR)                   0393 00985000
*   DATAXPRC='RCVD DATA';           /* PUT 'RCVD DATA' IN PRT BFR    */ 00986000
         LA    @14,1976                                            0394 00987000
         ALR   @14,WAPTR                                           0394 00988000
         MVC   DATAXPRC(9,@14),@CC00964                            0394 00989000
*   IF $DATAERR=ON                  /* IF ERROR IN DATA              */ 00990000
*     THEN                                                         0395 00991000
         TM    $DATAERR(PRTPTR),B'00001000'                        0395 00992000
         BNO   @RF00395                                            0395 00993000
*     DATAERR='*';                  /* MARK WITH AN *                */ 00994000
         MVI   DATAERR(@14),C'*'                                   0396 00995000
*   CALL S24C7000;                  /* SET UP & OUTPUT LINE          */ 00996000
@RF00395 BAL   @14,S24C7000                                        0397 00997000
*/********************************************************************/ 00998000
*/*      WRITTEN DATA LINE(S)                                        */ 00999000
*/********************************************************************/ 01000000
*                                                                  0398 01001000
*S24C0650:                                                         0398 01002000
*   IF $WRTDATA=OFF                 /* IF NO WRT DATA TO PRINT       */ 01003000
*     THEN                                                         0398 01004000
S24C0650 TM    $WRTDATA(PRTPTR),B'00100000'                        0398 01005000
         BZ    @RT00398                                            0398 01006000
*     GOTO S24C0700;                /* CHK ON MSG LINES              */ 01007000
*   $ATAPTR=$PTWDATA;               /* PT TO WRITTEN DATA            */ 01008000
         L     @14,$PTWDATA(,DPRPTR)                               0400 01009000
         ST    @14,$ATAPTR(,WAPTR)                                 0400 01010000
*   $ATACNT=$PTWDATC;               /* COUNT OF WRT DATA             */ 01011000
         MVC   $ATACNT(2,WAPTR),$PTWDATC(PRTPTR)                   0401 01012000
*   DATAWRT='WRTN DATA';            /* PUT 'WRTN DATA' IN BUFR       */ 01013000
         MVC   DATAWRT+1976(9,WAPTR),@CC00968                      0402 01014000
*   CALL S24C7000;                  /* SET UP & OUTPUT LINES         */ 01015000
         BAL   @14,S24C7000                                        0403 01016000
*/********************************************************************/ 01017000
*/*      MESSAGE (COMMENT) LINES                                     */ 01018000
*/********************************************************************/ 01019000
*                                                                  0404 01020000
*S24C0700:                                                         0404 01021000
*   IF $MESSAGE=OFF                 /* IF NO MESSAGE LINES           */ 01022000
*     THEN                                                         0404 01023000
S24C0700 TM    $MESSAGE(PRTPTR),B'00000001'                        0404 01024000
         BZ    @RT00404                                            0404 01025000
*     GOTO S24C0750;                /* DO SOMETHING WITH FORMSCTL    */ 01026000
*   $DDRPTR=$PRTMSGL;               /* PT TO ARRAY OF MSG PTRS       */ 01027000
         L     @14,$PRTMSGL(,DPRPTR)                               0406 01028000
         ST    @14,$DDRPTR(,WAPTR)                                 0406 01029000
*   $OUNTPTR=$PTMSGOF+$PRTCTLW;     /* PT TO ARRAY OF MSG COUNTS     */ 01030000
         SLR   @14,@14                                             0407 01031000
         IC    @14,$PTMSGOF(,PRTPTR)                               0407 01032000
         AL    @14,$PRTCTLW(,DPRPTR)                               0407 01033000
         ST    @14,$OUNTPTR(,WAPTR)                                0407 01034000
*   $UMXX=$PTMSGLC;                 /* NUMBER OF MSG LINES           */ 01035000
         IC    @14,$PTMSGLC(,PRTPTR)                               0408 01036000
         STC   @14,$UMXX(,WAPTR)                                   0408 01037000
*   CALL S24C1000;                  /* SET UP & PRT MSG LINES        */ 01038000
         BAL   @14,S24C1000                                        0409 01039000
*/********************************************************************/ 01040000
*/*     FORMS CONTROL                                                */ 01041000
*/********************************************************************/ 01042000
*                                                                  0410 01043000
*S24C0750:                                                         0410 01044000
*   $PRTFORM=$PTCNTWD(1:1);         /* SET UP PRINT FORMS            */ 01045000
S24C0750 MVC   $PRTFORM(1,WAPTR),$PTCNTWD(PRTPTR)                  0410 01046000
*   $PRTFORM=$PRTFORM/32;           /* MOVE TO LOWER 3 BITS          */ 01047000
         SLR   @14,@14                                             0411 01048000
         IC    @14,$PRTFORM(,WAPTR)                                0411 01049000
         SRL   @14,5                                               0411 01050000
         STC   @14,$PRTFORM(,WAPTR)                                0411 01051000
*   IF $PRTFORM¬=2&                 /* IF NOT TO SPACE 2 LINES       */ 01052000
*       $PRTFORM¬=3                 /* AND NOT 3 LINES               */ 01053000
*     THEN                                                         0412 01054000
         CLI   $PRTFORM(WAPTR),2                                   0412 01055000
         BE    @RF00412                                            0412 01056000
         CLI   $PRTFORM(WAPTR),3                                   0412 01057000
         BNE   @RT00412                                            0412 01058000
*     GOTO S24C0755;                /* DON'T GO TO MSG I/0           */ 01059000
*   ELSE                                                           0414 01060000
*     DO $CTR=1 TO $PRTFORM-1;      /* DO BLANK LINES                */ 01061000
@RF00412 LA    @14,1                                               0414 01062000
         B     @DE00414                                            0414 01063000
@DL00414 DS    0H                                                  0415 01064000
*       CALL S24C2500;              /* GO TO MSG I/O                 */ 01065000
         BAL   @14,S24C2500                                        0415 01066000
*     END;                                                         0416 01067000
         LA    @14,1                                               0416 01068000
         AH    @14,$CTR(,WAPTR)                                    0416 01069000
@DE00414 STH   @14,$CTR(,WAPTR)                                    0416 01070000
         SLR   @00,@00                                             0416 01071000
         IC    @00,$PRTFORM(,WAPTR)                                0416 01072000
         BCTR  @00,0                                               0416 01073000
         CR    @14,@00                                             0416 01074000
         BNH   @DL00414                                            0416 01075000
*S24C0755:                                                         0417 01076000
*   IF $PRTFORM=4                   /* IF FOR PRT &RESTORE           */ 01077000
*       |$PRTFORM=5                 /* OR FOR RESTORE                */ 01078000
*     THEN                                                         0417 01079000
S24C0755 CLI   $PRTFORM(WAPTR),4                                   0417 01080000
         BE    @RT00417                                            0417 01081000
         CLI   $PRTFORM(WAPTR),5                                   0417 01082000
         BNE   @RF00417                                            0417 01083000
@RT00417 DS    0H                                                  0418 01084000
*     CALL S24C2500;                /* THEN GOTO MSG I/O             */ 01085000
         BAL   @14,S24C2500                                        0418 01086000
*   $PRTONLY=OFF;                   /* RESET PRINTER ONLY            */ 01087000
@RF00417 NI    $PRTONLY(WAPTR),B'11110111'                         0419 01088000
*   R15=$24RETCD;                   /* PICK UP DPRINT RETURN CODE    */ 01089000
         SLR   R15,R15                                             0420 01090000
         IC    R15,$24RETCD(,WAPTR)                                0420 01091000
*   $NOTRRCH=OFF;                   /* DO RC HDLG & TRACE NOW        */ 01092000
         NI    $NOTRRCH(WAPTR),B'11111101'                         0421 01093000
*   $R13PTR=$24SAV13;               /* PT RCM TO MY CALLER'S SAVE  0422 01094000
*                                      AREA                          */ 01095000
         L     @14,$24SAV13(,WAPTR)                                0422 01096000
         ST    @14,$R13PTR(,WAPTR)                                 0422 01097000
*   IF $ERRORDP=ON&(($FSTCOMM=ON&   /* IF THERE IS A FE MSG          */ 01098000
*       $FSTFE=OFF)|($CATERR=ON     /* OR CATERR MSG TO SEND         */ 01099000
*       &$FSTCAT=OFF))              /*                               */ 01100000
*     THEN                          /*                               */ 01101000
         TM    $ERRORDP(PRTPTR),B'00000010'                        0423 01102000
         BNO   @RF00423                                            0423 01103000
         TM    $FSTCOMM(WAPTR),B'00000001'                         0423 01104000
         BNO   @GL00012                                            0423 01105000
         TM    $FSTFE(WAPTR),B'10000000'                           0423 01106000
         BZ    @RT00423                                            0423 01107000
@GL00012 TM    $CATERR(WAPTR),B'00100000'                          0423 01108000
         BNO   @RF00423                                            0423 01109000
         TM    $FSTCAT(WAPTR),B'01000000'                          0423 01110000
         BNZ   @RF00423                                            0423 01111000
@RT00423 DS    0H                                                  0424 01112000
*     DO;                                                          0424 01113000
*       IF $DPCHAIN=OFF             /* AND IF DPRINT NOT CHAINED     */ 01114000
*         THEN                                                     0425 01115000
         TM    $DPCHAIN(PRTPTR),B'00001000'                        0425 01116000
         BZ    @RT00425                                            0425 01117000
*         GOTO S24C0850;            /* GO CHK ON 1ST ERR             */ 01118000
*     END;                                                         0427 01119000
*   ELSE                            /* ELSE                          */ 01120000
*     GOTO S24C9999;                /* RETURN TO RCM                 */ 01121000
*/********************************************************************/ 01122000
*/*      FIRST ERROR MESSAGE                                         */ 01123000
*/********************************************************************/ 01124000
*                                                                  0429 01125000
*S24C0850:                                                         0429 01126000
*   IF $ERRORDP=ON&$FSTCOMM=ON&     /* IF THIS IS AN ERROR DP,FE     */ 01127000
*       $FSTFE=OFF                  /* OPTN ON AND FE MSG HASN'T BEEN   01128000
*                                      ISSUED	                       */ 01129000
*     THEN                                                         0429 01130000
S24C0850 TM    $ERRORDP(PRTPTR),B'00000010'                        0429 01131000
         BNO   @RF00429                                            0429 01132000
         TM    $FSTCOMM(WAPTR),B'00000001'                         0429 01133000
         BNO   @RF00429                                            0429 01134000
         TM    $FSTFE(WAPTR),B'10000000'                           0429 01135000
         BNZ   @RF00429                                            0429 01136000
*     DO;                                                          0430 01137000
*       $FSTFE=ON;                  /* FE MSG HAS BEEN ISSUED        */ 01138000
         OI    $FSTFE(WAPTR),B'10000000'                           0431 01139000
*       $INBUFR(1:23)=              /* GATHER UP FE VARIABLES        */ 01140000
*           $24FEMSG;               /* GO TO CECOM WITH THEN         */ 01141000
*                                                                  0432 01142000
         MVC   $INBUFR(23,WAPTR),$24FEMSG(WAPTR)                   0432 01143000
*       /*************************************************************/ 01144000
*       /*                                                           */ 01145000
*       /* TCEC MSGN(129)SUB(YES) INVOKED                            */ 01146000
*       /*                                                           */ 01147000
*       /*************************************************************/ 01148000
*                                                                  0433 01149000
*       $TCECM='1'B;                /* SET TCEC SW IN RCA            */ 01150000
         OI    $TCECM(WAPTR),B'00000001'                           0433 01151000
*       R1=ADDR($TCA15);            /* SET UP PARM LIST $TR          */ 01152000
         LA    R1,$TCA15                                           0434 01153000
*       CALL #EXIT;                 /* CALL CECOM                    */ 01154000
         L     @15,#EXITA(,WAPTR)                                  0435 01155000
         BALR  @14,@15                                             0435 01156000
*       DCL                                                        0436 01157000
*         1 $TCA15,                 /* TCEC PARM LIST                */ 01158000
*          2 $TCB15 FIXED(32) INIT(129),/* MSG NUMBER                */ 01159000
*          2 $TCC15 FIXED(32) INIT(0),/* INCT LEN                    */ 01160000
*          2 $TCD15 BIT(8) INIT('10000000'B),/* FLAG                 */ 01161000
*          2 $TCE15 CHAR(4) INIT('FFFFFFFF'X);/* MSSAGE MASK         */ 01162000
*     END;                                                         0437 01163000
*                                                                  0437 01164000
*/********************************************************************/ 01165000
*/*      CATASTROPHIC ERROR MESSAGE                                  */ 01166000
*/********************************************************************/ 01167000
*                                                                  0438 01168000
*   IF $CATERR=ON&$FSTCAT=OFF THEN                                 0438 01169000
@RF00429 TM    $CATERR(WAPTR),B'00100000'                          0438 01170000
         BNO   @RF00438                                            0438 01171000
         TM    $FSTCAT(WAPTR),B'01000000'                          0438 01172000
         BNZ   @RF00438                                            0438 01173000
*     DO;                                                          0439 01174000
*       $FSTCAT=ON;                 /* CATERR MSG HAS BEEN ISSUED    */ 01175000
         OI    $FSTCAT(WAPTR),B'01000000'                          0440 01176000
*       $CATMSG=ON;                 /* CATERR MSG CAUSED COMM INT    */ 01177000
         OI    $CATMSG(WAPTR),B'00000100'                          0441 01178000
*       $INBUFR(1:12)=              /* SET UP CAT ERR MSGS           */ 01179000
*           $24CATMG;               /* LINK TO CECOM                 */ 01180000
*                                                                  0442 01181000
         MVC   $INBUFR(12,WAPTR),$24CATMG(WAPTR)                   0442 01182000
*       /*************************************************************/ 01183000
*       /*                                                           */ 01184000
*       /* TCEC MSGN(157)SUB(YES) INVOKED                            */ 01185000
*       /*                                                           */ 01186000
*       /*************************************************************/ 01187000
*                                                                  0443 01188000
*       $TCECM='1'B;                /* SET TCEC SW IN RCA            */ 01189000
         OI    $TCECM(WAPTR),B'00000001'                           0443 01190000
*       R1=ADDR($TCA16);            /* SET UP PARM LIST $TR          */ 01191000
         LA    R1,$TCA16                                           0444 01192000
*       CALL #EXIT;                 /* CALL CECOM                    */ 01193000
         L     @15,#EXITA(,WAPTR)                                  0445 01194000
         BALR  @14,@15                                             0445 01195000
*       DCL                                                        0446 01196000
*         1 $TCA16,                 /* TCEC PARM LIST                */ 01197000
*          2 $TCB16 FIXED(32) INIT(157),/* MSG NUMBER                */ 01198000
*          2 $TCC16 FIXED(32) INIT(0),/* INCT LEN                    */ 01199000
*          2 $TCD16 BIT(8) INIT('10000000'B),/* FLAG                 */ 01200000
*          2 $TCE16 CHAR(4) INIT('FFFFFFFF'X);/* MSSAGE MASK         */ 01201000
*     END;                                                         0447 01202000
*   IF $TESTMDE(1)=ON               /* IF CT IN TESTMODE             */ 01203000
*     THEN                                                         0448 01204000
@RF00438 TM    $TESTMDE(WAPTR),B'00000010'                         0448 01205000
         BO    @RT00448                                            0448 01206000
*     GO TO S24C0875;               /* ISSUE MESSAGE 240             */ 01207000
*                                                                  0449 01208000
*   /*****************************************************************/ 01209000
*   /*                                                               */ 01210000
*   /* CHECK IF CT LINE ISIN TEST MODE                               */ 01211000
*   /*                                                               */ 01212000
*   /*****************************************************************/ 01213000
*                                                                  0450 01214000
*   IF $SYSMN(1)¬='SYS CON ' THEN   /* CHECK FOR DEVICE IN TEST AND     01215000
*                                      CT ON SAME LINE ONLY IF NOT 0450 01216000
*                                      SYSTEM CONSOLE        @DM44278*/ 01217000
         CLC   $SYSMN(8,WAPTR),@CC00994                            0450 01218000
         BE    @RF00450                                            0450 01219000
*     DO J=3 TO $DEVCNTS;           /* CHECK ALL TEST DEVICES        */ 01220000
         LA    J,3                                                 0451 01221000
         B     @DE00451                                            0451 01222000
@DL00451 DS    0H                                                  0452 01223000
*       IF $TESTMDE(J)=ON&          /* IF DEVICE IN TEST             */ 01224000
*           $LINENME(1)=$LINENME(J) /* AND IF ON THE CT LINE         */ 01225000
*         THEN                                                     0452 01226000
         LR    @14,J                                               0452 01227000
         MH    @14,@CH00326                                        0452 01228000
         ST    @14,@TF00001                                        0452 01229000
         ALR   @14,WAPTR                                           0452 01230000
         TM    $TESTMDE-68(@14),B'00000010'                        0452 01231000
         BNO   @RF00452                                            0452 01232000
         LR    @14,WAPTR                                           0452 01233000
         AL    @14,@TF00001                                        0452 01234000
         CLC   $LINENME(8,WAPTR),$LINENME-68(@14)                  0452 01235000
         BE    @RT00452                                            0452 01236000
*         GO TO S24C0875;           /* SKIP COMMUNICATION INTERVAL   */ 01237000
*     END;                          /* END OF BUSY CT LINE CHECK     */ 01238000
@RF00452 AL    J,@CF00043                                          0454 01239000
@DE00451 CH    J,$DEVCNTS(,WAPTR)                                  0454 01240000
         BNH   @DL00451                                            0454 01241000
*   CALL ISTIC002;                  /* CALL COMM INTERVAL            */ 01242000
@RF00450 L     @15,@CV00995                                        0455 01243000
         BALR  @14,@15                                             0455 01244000
*S24C0900:                                                         0456 01245000
*   R15=$24RETCD;                   /* RESET COND CODE               */ 01246000
S24C0900 SLR   R15,R15                                             0456 01247000
         IC    R15,$24RETCD(,WAPTR)                                0456 01248000
*   GOTO S24C9999;                  /* RETURN                        */ 01249000
         B     S24C9999                                            0457 01250000
*S24C0875:                                                         0458 01251000
*                                                                  0458 01252000
*   /*****************************************************************/ 01253000
*   /*                                                               */ 01254000
*   /* TCEC MSGN(240) INVOKED                                        */ 01255000
*   /*                                                               */ 01256000
*   /*****************************************************************/ 01257000
*                                                                  0458 01258000
*   $TCECM='1'B;                    /* SET TCEC SW IN RCA            */ 01259000
S24C0875 OI    $TCECM(WAPTR),B'00000001'                           0458 01260000
*   R1=ADDR($TCA17);                /* SET UP PARM LIST $TR          */ 01261000
         LA    R1,$TCA17                                           0459 01262000
*   CALL #EXIT;                     /* CALL CECOM                    */ 01263000
         L     @15,#EXITA(,WAPTR)                                  0460 01264000
         BALR  @14,@15                                             0460 01265000
*   DCL                                                            0461 01266000
*     1 $TCA17,                     /* TCEC PARM LIST                */ 01267000
*      2 $TCB17 FIXED(32) INIT(240),/* MSG NUMBER                    */ 01268000
*      2 $TCC17 FIXED(32) INIT(0),  /* INCT LEN                      */ 01269000
*      2 $TCD17 BIT(8) INIT('00000000'B),/* FLAG                     */ 01270000
*      2 $TCE17 CHAR(4) INIT('FFFFFFFF'X);/* MSSAGE MASK             */ 01271000
*   $CATERR=OFF;                    /* RESET CATASTROPHIC ERROR BIT  */ 01272000
         NI    $CATERR(WAPTR),B'11011111'                          0462 01273000
*   GO TO S24C0900;                 /* LEAVE                         */ 01274000
         B     S24C0900                                            0463 01275000
*/********************************************************************/ 01276000
*/*  ROUTINE TO PICK UP AND OUTPUT DESCRIPTION AND MESSAGE LINES     */ 01277000
*/*      INPUT:                                                      */ 01278000
*/*            $DDRPTR -  POINTER TO ARRAY OF ADDRESSES OF LINES TO  */ 01279000
*/*                       BE OUTPUT                                  */ 01280000
*/*            $OUNTPTR-  POINTER TO ARRAY OF LENGTHS OF LINES       */ 01281000
*/*            $UMXX -    TOTAL NUMBER OF LINES TO BE OUTPUT         */ 01282000
*/********************************************************************/ 01283000
*                                                                  0464 01284000
*S24C1000:                                                         0464 01285000
*   PROC OPTIONS(NOSAVE,NOSAVEAREA);                               0464 01286000
S24C1000 DS    0H                                                  0465 01287000
*   $24SAVE1=R14;                   /* SAVE RETURN ADDRESS           */ 01288000
         ST    R14,$24SAVE1(,WAPTR)                                0465 01289000
*   IF $ALTPRNT=ON&                 /* IF PP IS IN EFFECT            */ 01290000
*       ($PRNTLVL='1'|              /* AND PRINT LEVEL IS 1          */ 01291000
*       $PRNTLVL='3')               /* OR 3                          */ 01292000
*     THEN                                                         0466 01293000
         TM    $ALTPRNT(WAPTR),B'00010000'                         0466 01294000
         BNO   @RF00466                                            0466 01295000
         CLI   $PRNTLVL(WAPTR),C'1'                                0466 01296000
         BE    @RT00466                                            0466 01297000
         CLI   $PRNTLVL(WAPTR),C'3'                                0466 01298000
         BNE   @RF00466                                            0466 01299000
@RT00466 DS    0H                                                  0467 01300000
*     $PRTONLY=OFF;                 /* PRINT ON CT ALSO              */ 01301000
         NI    $PRTONLY(WAPTR),B'11110111'                         0467 01302000
*   IF $UMXX=0 THEN                 /* IF NO. OF LINES IS ZERO       */ 01303000
@RF00466 CLI   $UMXX(WAPTR),0                                      0468 01304000
         BNE   @RF00468                                            0468 01305000
*     DO;                                                          0469 01306000
*       $24RETCD='0C'X;             /* RETURN TO CALLER, RC=0C       */ 01307000
         MVI   $24RETCD(WAPTR),X'0C'                               0470 01308000
*       GOTO S24C1020;                                             0471 01309000
         B     S24C1020                                            0471 01310000
*     END;                                                         0472 01311000
*   DO $CTR=1 TO $UMXX;             /* LOOP THRU ARRAY OF LINES      */ 01312000
@RF00468 LA    @14,1                                               0473 01313000
         B     @DE00473                                            0473 01314000
@DL00473 DS    0H                                                  0474 01315000
*     IF S24BYTEA($CTR)=0           /* IF A BYTE COUNT OF A LINE     */ 01316000
*       THEN                        /* IS 0                          */ 01317000
         LH    @14,$CTR(,WAPTR)                                    0474 01318000
         L     @11,$OUNTPTR(,WAPTR)                                0474 01319000
         BCTR  @11,0                                               0474 01320000
         SLR   @00,@00                                             0474 01321000
         IC    @00,S24BYTEA(@14,@11)                               0474 01322000
         C     @00,@CF00864                                        0474 01323000
         BNE   @RF00474                                            0474 01324000
*       DO;                         /*                               */ 01325000
*         $24RETCD='0C'X;           /* SET RETURN CODE = 0C          */ 01326000
         MVI   $24RETCD(WAPTR),X'0C'                               0476 01327000
*         GOTO S24C1010;            /* TRY NEXT ENTRY                */ 01328000
         B     S24C1010                                            0477 01329000
*       END;                        /*                               */ 01330000
*     IF S24BYTEA($CTR)>120         /* IF LENGTH OF LINE > MAX       */ 01331000
*       THEN                                                       0479 01332000
@RF00474 LH    @14,$CTR(,WAPTR)                                    0479 01333000
         L     @11,$OUNTPTR(,WAPTR)                                0479 01334000
         BCTR  @11,0                                               0479 01335000
         SLR   @00,@00                                             0479 01336000
         IC    @00,S24BYTEA(@14,@11)                               0479 01337000
         C     @00,@CF00435                                        0479 01338000
         BNH   @RF00479                                            0479 01339000
*       $ENXX=120;                  /* SET IT TO MAX                 */ 01340000
         MVI   $ENXX(WAPTR),X'78'                                  0480 01341000
*     ELSE                                                         0481 01342000
*       $ENXX=S24BYTEA($CTR);       /* OTHERWISE USE LGTH AS IS      */ 01343000
         B     @RC00479                                            0481 01344000
@RF00479 LH    @14,$CTR(,WAPTR)                                    0481 01345000
         L     @11,$OUNTPTR(,WAPTR)                                0481 01346000
         BCTR  @11,0                                               0481 01347000
         SLR   @00,@00                                             0481 01348000
         IC    @00,S24BYTEA(@14,@11)                               0481 01349000
         STC   @00,$ENXX(,WAPTR)                                   0481 01350000
*     $BUFFER(1:$ENXX)=             /* PUT LINE IN BUFR              */ 01351000
*         S24LINE(1:$ENXX);                                        0482 01352000
@RC00479 SLR   @14,@14                                             0482 01353000
         IC    @14,$ENXX(,WAPTR)                                   0482 01354000
         BCTR  @14,0                                               0482 01355000
         LH    @11,$CTR(,WAPTR)                                    0482 01356000
         SLA   @11,2                                               0482 01357000
         L     @10,$DDRPTR(,WAPTR)                                 0482 01358000
         AL    @10,@CF01092                                        0482 01359000
         L     @11,S24ADDRA(@11,@10)                               0482 01360000
         EX    @14,@SM01093                                        0482 01361000
*     CALL S24C2500;                /* PRINT THE LINE                */ 01362000
         BAL   @14,S24C2500                                        0483 01363000
*S24C1010:                                                         0484 01364000
*     $UMXX=$UMXX;                  /* KEEP PLS HONEST               */ 01365000
S24C1010 SLR   @14,@14                                             0484 01366000
         IC    @14,$UMXX(,WAPTR)                                   0484 01367000
         STC   @14,$UMXX(,WAPTR)                                   0484 01368000
*   END;                                                           0485 01369000
         LA    @14,1                                               0485 01370000
         AH    @14,$CTR(,WAPTR)                                    0485 01371000
@DE00473 STH   @14,$CTR(,WAPTR)                                    0485 01372000
         SLR   @00,@00                                             0485 01373000
         IC    @00,$UMXX(,WAPTR)                                   0485 01374000
         CR    @14,@00                                             0485 01375000
         BNH   @DL00473                                            0485 01376000
*S24C1020:                                                         0486 01377000
*   R14=$24SAVE1;                   /* RESTORE RETURN ADDR           */ 01378000
S24C1020 L     R14,$24SAVE1(,WAPTR)                                0486 01379000
*   END S24C1000;                                                  0487 01380000
*                                                                  0487 01381000
@EL00002 DS    0H                                                  0487 01382000
@EF00002 DS    0H                                                  0487 01383000
@ER00002 BR    @14                                                 0487 01384000
*/********************************************************************/ 01385000
*/*      ROUTINE TO OUTPUT A DPRINT LINE                             */ 01386000
*/*      ENTRY POINTS:                                               */ 01387000
*/*            S24C2000:  CHK FOR PP LEVELS 2 & 3 AND OUTPUT LINE    */ 01388000
*/*            S24C2500:  OUTPUT LINE WITH NO PP LEVEL CHK           */ 01389000
*/*            S24C2550:  BLANK OUT BUFFER                           */ 01390000
*/********************************************************************/ 01391000
*                                                                  0488 01392000
*                                   /* ENTRY FOR PP LEVELS 2&3       */ 01393000
*S24C2000:                                                         0488 01394000
*   PROC OPTIONS(NOSAVE,NOSAVEAREA);                               0488 01395000
S24C2000 DS    0H                                                  0489 01396000
*   IF $ALTPRNT=ON&($PRNTLVL='2'|$PRNTLVL='3')/* IF PRINT LVL IS 2 OR   01397000
*                                      3                             */ 01398000
*     THEN                                                         0489 01399000
         TM    $ALTPRNT(WAPTR),B'00010000'                         0489 01400000
         BNO   @RF00489                                            0489 01401000
         CLI   $PRNTLVL(WAPTR),C'2'                                0489 01402000
         BE    @RT00489                                            0489 01403000
         CLI   $PRNTLVL(WAPTR),C'3'                                0489 01404000
         BNE   @RF00489                                            0489 01405000
@RT00489 DS    0H                                                  0490 01406000
*     $PRTONLY=OFF;                 /* THEN PRINT ON CT ALSO         */ 01407000
         NI    $PRTONLY(WAPTR),B'11110111'                         0490 01408000
*S24C2500:                                                         0491 01409000
*   ENTRY;                                                         0491 01410000
         B     @EC00491                                            0491 01411000
S24C2500 DS    0H                                                  0491 01412000
@EC00491 DS    0H                                                  0492 01413000
*   $24SAVE2=R14;                   /* SAVE RETURN ADDRESS           */ 01414000
         ST    R14,$24SAVE2(,WAPTR)                                0492 01415000
*   $COUTAD=ADDR($BUFFER);          /* POINT TO OUT BUFR             */ 01416000
         LA    @14,$BUFFER(,WAPTR)                                 0493 01417000
         ST    @14,$COUTAD(,WAPTR)                                 0493 01418000
*   $COUTCT=120;                    /* LENGTH OF OUT BUFR            */ 01419000
         MVC   $COUTCT(4,WAPTR),@CF00435                           0494 01420000
*   $CINADR=0;                      /* ZERO IN ADR FOR 1-WAY MSG     */ 01421000
         SLR   @14,@14                                             0495 01422000
         ST    @14,$CINADR(,WAPTR)                                 0495 01423000
*   CALL ISTCC011;                  /* GO TO MSG I/O                 */ 01424000
         L     @15,@CV01021                                        0496 01425000
         BALR  @14,@15                                             0496 01426000
*   SVESC024(4)=ADDR(S24C2550);     /* SET UP R14 FOR RCM            */ 01427000
         LA    @14,S24C2550                                        0497 01428000
         ST    @14,SVESC024+12(,WAPTR)                             0497 01429000
*   BC(15,S24C9999);                /* RETURN TO RCM WHEN RCM      0498 01430000
*                                      BRANCHES ON R14.. CONTROL   0498 01431000
*                                      RETURNS HERE.....             */ 01432000
         BC    15,S24C9999                                         0498 01433000
*S24C2550:                                                         0499 01434000
*   R14=$24SAVE2;                   /* RESTORE RETURN ADDRESS        */ 01435000
S24C2550 L     R14,$24SAVE2(,WAPTR)                                0499 01436000
*S24C2600:                                                         0500 01437000
*   ENTRY;                                                         0500 01438000
         B     @EC00500                                            0500 01439000
S24C2600 DS    0H                                                  0500 01440000
@EC00500 DS    0H                                                  0501 01441000
*   $BUFFER=' ';                    /* BLANK OUT BUFFER              */ 01442000
         MVI   $BUFFER+1(WAPTR),C' '                               0501 01443000
         MVC   $BUFFER+2(126,WAPTR),$BUFFER+1(WAPTR)               0501 01444000
         MVI   $BUFFER(WAPTR),C' '                                 0501 01445000
*   $PRTONLY=ON;                    /* TURN ON PRINTER ONLY FLAG     */ 01446000
         OI    $PRTONLY(WAPTR),B'00001000'                         0502 01447000
*S24C2650:                                                         0503 01448000
*   ;                                                              0503 01449000
*   END S24C2000;                                                  0504 01450000
*                                                                  0504 01451000
@EL00003 DS    0H                                                  0504 01452000
@EF00003 DS    0H                                                  0504 01453000
@ER00003 BR    @14                                                 0504 01454000
*/********************************************************************/ 01455000
*/*      ROUTINE TO SEARCH TECB                                      */ 01456000
*/*      INPUT:                                                      */ 01457000
*/*            FLAGS                                                 */ 01458000
*/*                 S24CCREQ - SEARCH FOR CONDITION CODE             */ 01459000
*/*                 S24CSW2R - SEARCH FOR SECOND CSW2/PSW2           */ 01460000
*/*                 S24SNSRQ - SEARCH FOR SENSE FIELD                */ 01461000
*/*                                                                  */ 01462000
*/*      OUTPUT:                                                     */ 01463000
*/*            FLAGS                                                 */ 01464000
*/*                 S24TCBER - TECB ADDR = 0 (RC SET TO 0C)          */ 01465000
*/*                 S24SCHFL - SEARCH FAILED                         */ 01466000
*/********************************************************************/ 01467000
*                                                                  0505 01468000
*S24C3000:                                                         0505 01469000
*   PROC OPTIONS(NOSAVE,NOSAVEAREA);                               0505 01470000
S24C3000 DS    0H                                                  0506 01471000
*   $24SAVE1=R14;                   /* SAVE RETURN ADDRESS TURN OFF     01472000
*                                      ERROR FLAGS:                  */ 01473000
         ST    R14,$24SAVE1(,WAPTR)                                0506 01474000
*   S24TCBER=OFF;                   /* TECB NOT FOUND                */ 01475000
*   S24SCHFL=OFF;                   /* SEARCH ERROR                  */ 01476000
         LA    @14,2680                                            0508 01477000
         ALR   @14,WAPTR                                           0508 01478000
         NI    S24TCBER(@14),B'11100111'                           0508 01479000
*   IF $PRTTECB=0                   /* IF NO PTR TO TECB GIVEN       */ 01480000
*     THEN                          /*                               */ 01481000
         L     @08,$PRTTECB(,DPRPTR)                               0509 01482000
         LTR   @08,@08                                             0509 01483000
         BNZ   @RF00509                                            0509 01484000
*     DO;                           /*                               */ 01485000
*       S24TCBER=ON;                /* SET NO TECB ERROR FLAG        */ 01486000
         OI    S24TCBER(@14),B'00010000'                           0511 01487000
*       GOTO S24C3020;              /* SET RC = 0C & RETURN          */ 01488000
         B     S24C3020                                            0512 01489000
*     END;                                                         0513 01490000
*   IF S24SNSRQ=ON                  /* IF REQ FOR A SNS FLD SCH      */ 01491000
*     THEN                                                         0514 01492000
@RF00509 TM    S24SNSRQ+2680(WAPTR),B'00100000'                    0514 01493000
         BO    @RT00514                                            0514 01494000
*     GOTO S24C3012;                /* GO SEARCH SENSE ENTRIES       */ 01495000
*   IF TECBEVOC=0                   /* IF NO EVENTS HAVE BEEN        */ 01496000
*     THEN                          /* POSTED,                       */ 01497000
         CLI   TECBEVOC(TECBPTR),0                                 0516 01498000
         BNE   @RF00516                                            0516 01499000
*     DO;                           /*                               */ 01500000
*S24C3003:                                                         0518 01501000
*       S24SCHFL=ON;                /* SET NO EVENTS ERROR FLAG      */ 01502000
S24C3003 OI    S24SCHFL+2680(WAPTR),B'00001000'                    0518 01503000
*       GOTO S24C3025;              /* AND RETURN                    */ 01504000
         B     S24C3025                                            0519 01505000
*     END;                                                         0520 01506000
*   IF TECBFDCT>TECBEVOC            /* IF TOTAL # OF EVENT FIELDS    */ 01507000
*     THEN                                                         0521 01508000
@RF00516 CLC   TECBFDCT(1,TECBPTR),TECBEVOC(TECBPTR)               0521 01509000
         BNH   @RF00521                                            0521 01510000
*     SEARCHCT=TECBEVOC;            /* GREATER THAN THOSE FILLED     */ 01511000
         SLR   SEARCHCT,SEARCHCT                                   0522 01512000
         IC    SEARCHCT,TECBEVOC(,TECBPTR)                         0522 01513000
*   ELSE                                                           0523 01514000
*     SEARCHCT=TECBFDCT;            /* IN, SEARCH ONLY THOSE USED    */ 01515000
         B     @RC00521                                            0523 01516000
@RF00521 SLR   SEARCHCT,SEARCHCT                                   0523 01517000
         IC    SEARCHCT,TECBFDCT(,TECBPTR)                         0523 01518000
*   RFY                                                            0524 01519000
*     TECBFD01 BASED(ADDR(TECBEVT1)+$CTR*TECBFDLN);/*        @DY04695*/ 01520000
@RC00521 DS    0H                                                  0525 01521000
*   RFY                                                            0525 01522000
*     TECBSNS1 BASED(ADDR(TECBEVT1)+TECBFDLN*TECBFDCT+$CTR*TECBSNLN);   01523000
*                                   /*                       @DM15067*/ 01524000
*   DO $CTR=0 TO SEARCHCT-1;        /* SEARCH THRU THE TECB          */ 01525000
         SLR   @14,@14                                             0526 01526000
         B     @DE00526                                            0526 01527000
@DL00526 DS    0H                                                  0527 01528000
*     IF TCBEVDEV¬=$24UNADR(2:4)    /* IF THE DEVADDR IN TECB        */ 01529000
*       THEN                                                       0527 01530000
         LA    @14,TECBEVT1(,TECBPTR)                              0527 01531000
         SLR   @11,@11                                             0527 01532000
         IC    @11,TECBFDLN(,TECBPTR)                              0527 01533000
         MH    @11,$CTR(,WAPTR)                                    0527 01534000
         ALR   @14,@11                                             0527 01535000
         CLC   TCBEVDEV(3,@14),$24UNADR+1(WAPTR)                   0527 01536000
         BNE   @RT00527                                            0527 01537000
*       GOTO S24C3010;              /* NOT SAME AS DPR PARMLST DEV,     01538000
*                                      GO GET NEXT ENTRY             */ 01539000
*     IF S24CCREQ=ON THEN           /* IF LOOKING FOR CC &           */ 01540000
         TM    S24CCREQ+2680(WAPTR),B'10000000'                    0529 01541000
         BNO   @RF00529                                            0529 01542000
*       DO;                         /* THIS IS AN EBCDIC #           */ 01543000
*         IF TCBEVTYP(1:4)='1111'B  /* (CONDITION CODE)              */ 01544000
*           THEN                                                   0531 01545000
         TM    TCBEVTYP(@14),B'11110000'                           0531 01546000
         BNO   @RF00531                                            0531 01547000
*           DO;                                                    0532 01548000
*             CCCONDCD=TCBEVTYP;    /* PUT CC IN PRT LINE            */ 01549000
         MVC   CCCONDCD+1976(1,WAPTR),TCBEVTYP(@14)                0533 01550000
*             GOTO S24C3025;        /* RETURN                        */ 01551000
         B     S24C3025                                            0534 01552000
*           END;                                                   0535 01553000
*         ELSE                                                     0536 01554000
*           GOTO S24C3010;          /* ELSE GET NEXT ENTRY           */ 01555000
*       END;                                                       0537 01556000
*     IF $PSWCSW=ON                 /* IF LOOKING FOR PSW            */ 01557000
*       THEN                        /* AND                           */ 01558000
@RF00529 TM    $PSWCSW(PRTPTR),B'00000001'                         0538 01559000
         BNO   @RF00538                                            0538 01560000
*       DO;                         /* IF THIS IS A PSW NTRY         */ 01561000
*         IF TCBEVTYP(1:4)¬='1111'B THEN                           0540 01562000
         LA    @14,TECBEVT1(,TECBPTR)                              0540 01563000
         SLR   @11,@11                                             0540 01564000
         IC    @11,TECBFDLN(,TECBPTR)                              0540 01565000
         MH    @11,$CTR(,WAPTR)                                    0540 01566000
         ALR   @14,@11                                             0540 01567000
         TM    TCBEVTYP(@14),B'11110000'                           0540 01568000
         BNO   @RT00540                                            0540 01569000
*           GOTO S24C3005;          /* THEN CHK FOR PSW1/2           */ 01570000
*         ELSE                                                     0542 01571000
*           GOTO S24C3010;          /* ELSE CHK NEXT ENTRY           */ 01572000
         B     S24C3010                                            0542 01573000
*       END;                                                       0543 01574000
*     IF TCBEVTYP='0'               /* IF CC = 0 FOR THIS ENTRY      */ 01575000
*       THEN                                                       0544 01576000
@RF00538 LA    @14,TECBEVT1(,TECBPTR)                              0544 01577000
         SLR   @11,@11                                             0544 01578000
         IC    @11,TECBFDLN(,TECBPTR)                              0544 01579000
         MH    @11,$CTR(,WAPTR)                                    0544 01580000
         ALR   @14,@11                                             0544 01581000
         CLI   TCBEVTYP(@14),C'0'                                  0544 01582000
         BE    @RT00544                                            0544 01583000
*       GOTO S24C3010;              /* THEN THERE IS NO CSW          */ 01584000
*     IF TCBEVTYP(1:4)¬='1111'B     /* IF EVENT TYPE NOT EBCDIC #    */ 01585000
*       THEN                                                       0546 01586000
         TM    TCBEVTYP(@14),B'11110000'                           0546 01587000
         BNO   @RT00546                                            0546 01588000
*       GOTO S24C3010;              /* THEN THIS NOT A CSW ENTRY     */ 01589000
*S24C3005:                                                         0548 01590000
*     IF S24CSW2R=OFF               /* IF NOT REQ FOR 2ND CSW/PSW    */ 01591000
*       THEN                                                       0548 01592000
S24C3005 TM    S24CSW2R+2680(WAPTR),B'01000000'                    0548 01593000
         BNZ   @RF00548                                            0548 01594000
*       DO;                                                        0549 01595000
*         CSWPSWPT=ADDR(TCBEVCSW);  /* PT TO CSW                     */ 01596000
         LA    @14,TECBEVT1(,TECBPTR)                              0550 01597000
         SLR   @08,@08                                             0550 01598000
         IC    @08,TECBFDLN(,TECBPTR)                              0550 01599000
         MH    @08,$CTR(,WAPTR)                                    0550 01600000
         ALR   @14,@08                                             0550 01601000
         LA    @14,TCBEVCSW(,@14)                                  0550 01602000
         ST    @14,CSWPSWPT                                        0550 01603000
*         GOTO S24C3025;            /* AND RETURN                    */ 01604000
         B     S24C3025                                            0551 01605000
*       END;                                                       0552 01606000
*     ELSE                          /* ELSE WE WANT NEXT CSW/PSW     */ 01607000
*       DO;                         /* KEEP LOOKING THRU TECB        */ 01608000
@RF00548 DS    0H                                                  0554 01609000
*         S24CSW2R=OFF;                                            0554 01610000
         NI    S24CSW2R+2680(WAPTR),B'10111111'                    0554 01611000
*         GOTO S24C3010;                                           0555 01612000
         B     S24C3010                                            0555 01613000
*       END;                                                       0556 01614000
*S24C3010:                                                         0557 01615000
*   END;                            /* END OF DO LOOP                */ 01616000
S24C3010 LA    @14,1                                               0557 01617000
         AH    @14,$CTR(,WAPTR)                                    0557 01618000
@DE00526 STH   @14,$CTR(,WAPTR)                                    0557 01619000
         LR    @00,SEARCHCT                                        0557 01620000
         BCTR  @00,0                                               0557 01621000
         CR    @14,@00                                             0557 01622000
         BNH   @DL00526                                            0557 01623000
*   GOTO S24C3003;                  /* SET SEARCH ERROR FLG & RET    */ 01624000
         B     S24C3003                                            0558 01625000
*S24C3012:                                                         0559 01626000
*   IF TECBSNOC=0                   /* IF NO SENSE FIELDS USED       */ 01627000
*     THEN                                                         0559 01628000
S24C3012 CLI   TECBSNOC(TECBPTR),0                                 0559 01629000
         BE    @RT00559                                            0559 01630000
*     GOTO S24C3003;                /* SET SRCH FAIL FLG & RETURN    */ 01631000
*   IF TECBSNCT>TECBSNOC            /* IF TOTAL # OF SNS FIELDS      */ 01632000
*     THEN                                                         0561 01633000
         CLC   TECBSNCT(1,TECBPTR),TECBSNOC(TECBPTR)               0561 01634000
         BNH   @RF00561                                            0561 01635000
*     SEARCHCT=TECBSNOC;            /* GREATER THAN THOSE FILLED     */ 01636000
         SLR   SEARCHCT,SEARCHCT                                   0562 01637000
         IC    SEARCHCT,TECBSNOC(,TECBPTR)                         0562 01638000
*   ELSE                                                           0563 01639000
*     SEARCHCT=TECBSNCT;            /* IN, SEARCH ONLY THOSE USED    */ 01640000
         B     @RC00561                                            0563 01641000
@RF00561 SLR   SEARCHCT,SEARCHCT                                   0563 01642000
         IC    SEARCHCT,TECBSNCT(,TECBPTR)                         0563 01643000
*   DO $CTR=0 TO SEARCHCT-1;                                       0564 01644000
@RC00561 SLR   @14,@14                                             0564 01645000
         B     @DE00564                                            0564 01646000
@DL00564 DS    0H                                                  0565 01647000
*     IF TCBSNDEV=$24UNADR(2:4)     /* IF DEV ADDR IN SNS ENTRY      */ 01648000
*       THEN                        /* SAME AS IN DPR PARM LIST      */ 01649000
         LA    @14,TECBEVT1(,TECBPTR)                              0565 01650000
         SLR   @07,@07                                             0565 01651000
         IC    @07,TECBFDCT(,TECBPTR)                              0565 01652000
         SLR   @11,@11                                             0565 01653000
         IC    @11,TECBFDLN(,TECBPTR)                              0565 01654000
         MR    @06,@11                                             0565 01655000
         ALR   @14,@07                                             0565 01656000
         LH    @11,$CTR(,WAPTR)                                    0565 01657000
         MH    @11,TECBSNLN(,TECBPTR)                              0565 01658000
         ALR   @14,@11                                             0565 01659000
         CLC   TCBSNDEV(3,@14),$24UNADR+1(WAPTR)                   0565 01660000
         BNE   @RF00565                                            0565 01661000
*       DO;                                                        0566 01662000
*         $NSPTR=ADDR(TCBSENSE);    /* SET UP PTR TO SENSE           */ 01663000
         LA    @14,TCBSENSE(,@14)                                  0567 01664000
         ST    @14,$NSPTR(,WAPTR)                                  0567 01665000
*         GOTO S24C3025;            /* RETURN                        */ 01666000
         B     S24C3025                                            0568 01667000
*       END;                        /* RETURN                        */ 01668000
*   END;                                                           0570 01669000
@RF00565 LA    @14,1                                               0570 01670000
         AH    @14,$CTR(,WAPTR)                                    0570 01671000
@DE00564 STH   @14,$CTR(,WAPTR)                                    0570 01672000
         LR    @00,SEARCHCT                                        0570 01673000
         BCTR  @00,0                                               0570 01674000
         CR    @14,@00                                             0570 01675000
         BNH   @DL00564                                            0570 01676000
*S24C3020:                                                         0571 01677000
*   $24RETCD='0C'X;                 /* SET RC = 0C                   */ 01678000
S24C3020 MVI   $24RETCD(WAPTR),X'0C'                               0571 01679000
*S24C3025:                                                         0572 01680000
*   R14=$24SAVE1;                   /* RESTORE RETURN ADDRESS        */ 01681000
S24C3025 L     R14,$24SAVE1(,WAPTR)                                0572 01682000
*   END S24C3000;                                                  0573 01683000
*                                                                  0573 01684000
@EL00004 DS    0H                                                  0573 01685000
@EF00004 DS    0H                                                  0573 01686000
@ER00004 BR    @14                                                 0573 01687000
*/********************************************************************/ 01688000
*/*      ROUTINE TO CONVERT AND MOVE CSW/PSW INTO PRINT BUFFER       */ 01689000
*/********************************************************************/ 01690000
*                                                                  0574 01691000
*S24C5000:                                                         0574 01692000
*   PROC OPTIONS(NOSAVE,NOSAVEAREA);                               0574 01693000
S24C5000 DS    0H                                                  0575 01694000
*   $24SAVE1=R14;                   /* SAVE RETURN ADDRESS CONVERT 0575 01695000
*                                      CSW/PSW TO EBCDIC             */ 01696000
*                                                                  0575 01697000
         ST    R14,$24SAVE1(,WAPTR)                                0575 01698000
*   /*****************************************************************/ 01699000
*   /*                                                               */ 01700000
*   /* ITACONV FROM(FROMFLD)TO(DPRWORK)COUNT(8)TYPE(HE) INVOKED      */ 01701000
*   /*                                                               */ 01702000
*   /*****************************************************************/ 01703000
*                                                                  0576 01704000
*   ITATCFR=ADDR(FROMFLD);          /* SET THE FROM ADDRESS          */ 01705000
         L     @14,CSWPSWPT                                        0576 01706000
         ST    @14,ITATCFR                                         0576 01707000
*   ITATCTO=ADDR(DPRWORK);          /* SET THE TO ADDRESS            */ 01708000
         LA    @14,DPRWORK(,WAPTR)                                 0577 01709000
         ST    @14,ITATCTO                                         0577 01710000
*   ITATCTP='1'B;                   /* SET THE TYPE OF CONVERT BIT   */ 01711000
         OI    ITATCTP,B'10000000'                                 0578 01712000
*   ITATCNT=8;                      /* GIVE THE CONVERT BYTE COUNT   */ 01713000
         MVI   ITATCNT,X'08'                                       0579 01714000
*   R1=ADDR(ITATCPRM);              /* POINT TO CONVERT PARM LIST    */ 01715000
         LA    R1,ITATCPRM                                         0580 01716000
*   CALL ISTSC021;                  /* CALL CONVERT DIRECTLY         */ 01717000
         L     @15,@CV00877                                        0581 01718000
         BALR  @14,@15                                             0581 01719000
*   IF $PSWCSW=ON                   /* IF THIS IS A PSW,             */ 01720000
*     THEN                          /*                               */ 01721000
         TM    $PSWCSW(PRTPTR),B'00000001'                         0582 01722000
         BNO   @RF00582                                            0582 01723000
*     DO;                           /*                               */ 01724000
*       PSWFLD=DPRWORK(1:16);       /* MOVE WHOLE FIELD INTO BFR     */ 01725000
         MVC   PSWFLD(16,BFRPTR),DPRWORK(WAPTR)                    0584 01726000
*       GOTO S24C5010;              /* RETURN                        */ 01727000
         B     S24C5010                                            0585 01728000
*     END;                                                         0586 01729000
*   WORKPTR=ADDR(DPRWORK);          /* SET UP FROM PTR               */ 01730000
@RF00582 LA    WORKPTR,DPRWORK(,WAPTR)                             0587 01731000
*   IF MASK(1:1)=ON                 /* IF CSW KEY THERE              */ 01732000
*     THEN                          /* PUT IT IN PRINT BUFR          */ 01733000
         TM    MASK,B'10000000'                                    0588 01734000
         BNO   @RF00588                                            0588 01735000
*     DO;                                                          0589 01736000
*       CSWKEY=WORKCSW(1:LENGTH(CSWKEY));                          0590 01737000
         MVC   CSWKEY(2,BFRPTR),WORKCSW(WORKPTR)                   0590 01738000
*       WORKPTR=WORKPTR+LENGTH(CSWKEY);                            0591 01739000
         AL    WORKPTR,@CF00086                                    0591 01740000
*     END;                                                         0592 01741000
*   ELSE                                                           0593 01742000
*     CSWKEY=                       /* IF NOT, SET TO X'S            */ 01743000
*         CSWXXXXX(1:LENGTH(CSWKEY));                              0593 01744000
         B     @RC00588                                            0593 01745000
@RF00588 MVC   CSWKEY(2,BFRPTR),CSWXXXXX                           0593 01746000
*   CSWBLANK=' ';                   /* BLANK OUT N OF 'NONE'         */ 01747000
@RC00588 MVI   CSWBLANK(BFRPTR),C' '                               0594 01748000
*   IF MASK(2:2)=ON                 /* IF CSW ADDR TO BE USED,       */ 01749000
*     THEN                          /* PUT IT IN PRINT BUFR          */ 01750000
         TM    MASK,B'01000000'                                    0595 01751000
         BNO   @RF00595                                            0595 01752000
*     DO;                                                          0596 01753000
*       CSWADDR=WORKCSW(1:LENGTH(CSWADDR));                        0597 01754000
         MVC   CSWADDR(6,BFRPTR),WORKCSW(WORKPTR)                  0597 01755000
*       WORKPTR=WORKPTR+LENGTH(CSWADDR);                           0598 01756000
         AL    WORKPTR,@CF00399                                    0598 01757000
*     END;                                                         0599 01758000
*   ELSE                                                           0600 01759000
*     CSWADDR=                      /* IF NOT, SET IT TO X'S         */ 01760000
*         CSWXXXXX(1:LENGTH(CSWADDR));                             0600 01761000
         B     @RC00595                                            0600 01762000
@RF00595 MVC   CSWADDR(6,BFRPTR),CSWXXXXX                          0600 01763000
*   IF MASK(3:3)=ON                 /* IF STATUS TO BE PRINTED,      */ 01764000
*     THEN                          /* PUT IT IN PRT BUFR            */ 01765000
@RC00595 TM    MASK,B'00100000'                                    0601 01766000
         BNO   @RF00601                                            0601 01767000
*     DO;                                                          0602 01768000
*       CSWSTAT=WORKCSW(1:LENGTH(CSWSTAT));                        0603 01769000
         MVC   CSWSTAT(4,BFRPTR),WORKCSW(WORKPTR)                  0603 01770000
*       WORKPTR=WORKPTR+LENGTH(CSWSTAT);                           0604 01771000
         AL    WORKPTR,@CF00041                                    0604 01772000
*     END;                                                         0605 01773000
*   ELSE                                                           0606 01774000
*     CSWSTAT=                      /* IF NOT USE X'S                */ 01775000
*         CSWXXXXX(1:LENGTH(CSWSTAT));                             0606 01776000
         B     @RC00601                                            0606 01777000
@RF00601 MVC   CSWSTAT(4,BFRPTR),CSWXXXXX                          0606 01778000
*   IF MASK(4:4)=ON                 /* IF RESIDUAL CNT TO BE PRTD    */ 01779000
*     THEN                          /* PUT IT IN BUFR                */ 01780000
@RC00601 TM    MASK,B'00010000'                                    0607 01781000
         BNO   @RF00607                                            0607 01782000
*     DO;                                                          0608 01783000
*       CSWCOUNT=WORKCSW(1:LENGTH(CSWCOUNT));                      0609 01784000
         MVC   CSWCOUNT(4,BFRPTR),WORKCSW(WORKPTR)                 0609 01785000
*       WORKPTR=WORKPTR+LENGTH(CSWCOUNT);                          0610 01786000
         AL    WORKPTR,@CF00041                                    0610 01787000
*     END;                                                         0611 01788000
*   ELSE                                                           0612 01789000
*     CSWCOUNT=                     /* IF NOT, PUT IN X'S            */ 01790000
*         CSWXXXXX(1:LENGTH(CSWCOUNT));                            0612 01791000
         B     @RC00607                                            0612 01792000
@RF00607 MVC   CSWCOUNT(4,BFRPTR),CSWXXXXX                         0612 01793000
*S24C5010:                                                         0613 01794000
*   R14=$24SAVE1;                   /* RESTORE RETURN ADDRESS        */ 01795000
@RC00607 DS    0H                                                  0613 01796000
S24C5010 L     R14,$24SAVE1(,WAPTR)                                0613 01797000
*   END S24C5000;                                                  0614 01798000
*                                                                  0614 01799000
@EL00005 DS    0H                                                  0614 01800000
@EF00005 DS    0H                                                  0614 01801000
@ER00005 BR    @14                                                 0614 01802000
*/********************************************************************/ 01803000
*/*      ROUTINE TO STURCTURE & PRINT SENSE LINES                    */ 01804000
*/*      INPUT:                                                      */ 01805000
*/*            $NSPTR - POINTER TO HEX SENSE DATA                    */ 01806000
*/*            COUNT - TOTAL COUNT OF SENSE DATA PROVIDED            */ 01807000
*/********************************************************************/ 01808000
*                                                                  0615 01809000
*S24C6000:                                                         0615 01810000
*   PROC OPTIONS(NOSAVE,NOSAVEAREA);                               0615 01811000
S24C6000 DS    0H                                                  0616 01812000
*   $24SAVE1=R14;                   /* SAVE RETURN ADDRESS           */ 01813000
         ST    R14,$24SAVE1(,WAPTR)                                0616 01814000
*   $INDEX=1;                       /* FROM ARRAY INDEX              */ 01815000
         MVI   $INDEX(WAPTR),X'01'                                 0617 01816000
*S24C6010:                                                         0618 01817000
*   IF $NSXX<=MAXSNS                /* IF LESS THAN OR = 17 BYTES    */ 01818000
*     THEN                                                         0618 01819000
S24C6010 LH    @14,$NSXX(,WAPTR)                                   0618 01820000
         C     @14,@CF00452                                        0618 01821000
         BH    @RF00618                                            0618 01822000
*     $NSCNT=$NSXX;                 /* ALL WILL FIT ON 1 LINE        */ 01823000
         STH   @14,$NSCNT(,WAPTR)                                  0619 01824000
*   ELSE                                                           0620 01825000
*     $NSCNT=MAXSNS;                /* ELSE PRINT 1 LINE OF MAX CONV    01826000
*                                      SENSE TO WORK AREA            */ 01827000
*                                                                  0620 01828000
         B     @RC00618                                            0620 01829000
@RF00618 MVC   $NSCNT(2,WAPTR),@CH00452                            0620 01830000
*   /*****************************************************************/ 01831000
*   /*                                                               */ 01832000
*   /* ITACONV FROM(FROMSNS($INDEX))TO(TOSENSE)COUNT($NSCNT)TYPE(HE) */ 01833000
*   /* INVOKED                                                       */ 01834000
*   /*                                                               */ 01835000
*   /*****************************************************************/ 01836000
*                                                                  0621 01837000
*   ITATCFR=ADDR(FROMSNS($INDEX));  /* SET THE FROM ADDRESS          */ 01838000
@RC00618 SLR   @14,@14                                             0621 01839000
         IC    @14,$INDEX(,WAPTR)                                  0621 01840000
         MH    @14,@CH00452                                        0621 01841000
         L     @11,$NSPTR(,WAPTR)                                  0621 01842000
         AL    @11,@CF01096                                        0621 01843000
         LA    @14,FROMSNS(@14,@11)                                0621 01844000
         ST    @14,ITATCFR                                         0621 01845000
*   ITATCTO=ADDR(TOSENSE);          /* SET THE TO ADDRESS            */ 01846000
         LA    @14,2376                                            0622 01847000
         ALR   @14,WAPTR                                           0622 01848000
         ST    @14,ITATCTO                                         0622 01849000
*   ITATCTP='1'B;                   /* SET THE TYPE OF CONVERT BIT   */ 01850000
         OI    ITATCTP,B'10000000'                                 0623 01851000
*   ITATCNT=$NSCNT;                 /* GIVE THE CONVERT BYTE COUNT   */ 01852000
         LH    @14,$NSCNT(,WAPTR)                                  0624 01853000
         STC   @14,ITATCNT                                         0624 01854000
*   R1=ADDR(ITATCPRM);              /* POINT TO CONVERT PARM LIST    */ 01855000
         LA    R1,ITATCPRM                                         0625 01856000
*   CALL ISTSC021;                  /* CALL CONVERT DIRECTLY         */ 01857000
         L     @15,@CV00877                                        0626 01858000
         BALR  @14,@15                                             0626 01859000
*   DO $CTR=1 TO $NSCNT;            /* MOVE CONVERTED SENSE          */ 01860000
         LA    @14,1                                               0627 01861000
         B     @DE00627                                            0627 01862000
@DL00627 DS    0H                                                  0628 01863000
*     SNSDATA($CTR)=TOSENSE($CTR);  /* BYTES INTO BUFFER             */ 01864000
         LH    @14,$CTR(,WAPTR)                                    0628 01865000
         LR    @11,@14                                             0628 01866000
         MH    @11,@CH00180                                        0628 01867000
         ALR   @11,WAPTR                                           0628 01868000
         ALR   @14,@14                                             0628 01869000
         ALR   @14,WAPTR                                           0628 01870000
         MVC   SNSDATA+1983(2,@11),TOSENSE+2374(@14)               0628 01871000
*   END;                                                           0629 01872000
         LA    @14,1                                               0629 01873000
         AH    @14,$CTR(,WAPTR)                                    0629 01874000
@DE00627 STH   @14,$CTR(,WAPTR)                                    0629 01875000
         CH    @14,$NSCNT(,WAPTR)                                  0629 01876000
         BNH   @DL00627                                            0629 01877000
*   CALL S24C2000;                  /* CHK PP LVLS 2&3 OUTPUT LIN    */ 01878000
         BAL   @14,S24C2000                                        0630 01879000
*   $NSXX=$NSXX-MAXSNS;             /* SUBTRACT BYTES JUST PRNTD     */ 01880000
         LH    @14,$NSXX(,WAPTR)                                   0631 01881000
         SL    @14,@CF00452                                        0631 01882000
         STH   @14,$NSXX(,WAPTR)                                   0631 01883000
*   $INDEX=$INDEX+1;                /* INCREMENT INDEX               */ 01884000
         LA    @11,1                                               0632 01885000
         SLR   @00,@00                                             0632 01886000
         IC    @00,$INDEX(,WAPTR)                                  0632 01887000
         ALR   @00,@11                                             0632 01888000
         STC   @00,$INDEX(,WAPTR)                                  0632 01889000
*   IF $NSXX<1                      /* IF THAT WAS IT, RETURN        */ 01890000
*     THEN                                                         0633 01891000
         CR    @14,@11                                             0633 01892000
         BL    @RT00633                                            0633 01893000
*     GOTO S24C6020;                                               0634 01894000
*   ELSE                                                           0635 01895000
*     GOTO S24C6010;                /* OR GO TO TOP AND GET NEXT   0635 01896000
*                                      SERIES OF SNS BYTES           */ 01897000
         B     S24C6010                                            0635 01898000
*S24C6020:                                                         0636 01899000
*   R14=$24SAVE1;                   /* RESTORE RET ADDR              */ 01900000
S24C6020 L     R14,$24SAVE1(,WAPTR)                                0636 01901000
*   END S24C6000;                                                  0637 01902000
*                                                                  0637 01903000
@EL00006 DS    0H                                                  0637 01904000
@EF00006 DS    0H                                                  0637 01905000
@ER00006 BR    @14                                                 0637 01906000
*/********************************************************************/ 01907000
*/* ROUTINE TO SET UP AND PRINT EXPECTED, RECEIVED, & WRITTEN DATA   */ 01908000
*/*                                                                  */ 01909000
*/*      INPUT:                                                      */ 01910000
*/*            $ATAPTR - POINTER TO DATA                             */ 01911000
*/*            $ATACNT - COUNT OF TOTAL DATA BYTES                   */ 01912000
*/********************************************************************/ 01913000
*                                                                  0638 01914000
*S24C7000:                                                         0638 01915000
*   PROC OPTIONS(NOSAVE,NOSAVEAREA);                               0638 01916000
S24C7000 DS    0H                                                  0639 01917000
*   $24SAVE1=R14;                   /* SAVE RETURN ADDRESS           */ 01918000
         ST    R14,$24SAVE1(,WAPTR)                                0639 01919000
*   $DDRPTR=$ATAPTR;                /* PT TO DATA                    */ 01920000
         L     @14,$ATAPTR(,WAPTR)                                 0640 01921000
         ST    @14,$DDRPTR(,WAPTR)                                 0640 01922000
*   IF $ATAPTR=0|$ATACNT<=0         /* IF NO ADDR GIVEN FOR DATA     */ 01923000
*     THEN                          /* OR COUNT NOT POSITIVE         */ 01924000
         SLR   @11,@11                                             0641 01925000
         CR    @14,@11                                             0641 01926000
         BE    @RT00641                                            0641 01927000
         CH    @11,$ATACNT(,WAPTR)                                 0641 01928000
         BL    @RF00641                                            0641 01929000
@RT00641 DS    0H                                                  0642 01930000
*     DO;                           /*                               */ 01931000
*       $24RETCD='0C'X;             /* SET RC=0C                     */ 01932000
         MVI   $24RETCD(WAPTR),X'0C'                               0643 01933000
*       GOTO S24C7020;              /* RETURN                        */ 01934000
         B     S24C7020                                            0644 01935000
*     END;                                                         0645 01936000
*S24C7010:                                                         0646 01937000
*   IF $DONTCVT=OFF                 /* IF DON'T CONVERT DATA FLAG    */ 01938000
*     THEN                          /* IS OFF                        */ 01939000
@RF00641 DS    0H                                                  0646 01940000
S24C7010 TM    $DONTCVT(PRTPTR),B'00001000'                        0646 01941000
         BNZ   @RF00646                                            0646 01942000
*     DO;                           /* THEN DATA WILL BE CONVERTD    */ 01943000
*       IF $ATACNT<=25              /* IF COUNT < = MAX FOR LINE     */ 01944000
*         THEN                                                     0648 01945000
         LH    @14,$ATACNT(,WAPTR)                                 0648 01946000
         C     @14,@CF00851                                        0648 01947000
         BH    @RF00648                                            0648 01948000
*         $IMITX=                   /* DO WHOLE THING                */ 01949000
*             $ATACNT;              /*                               */ 01950000
         STC   @14,$IMITX(,WAPTR)                                  0649 01951000
*       ELSE                                                       0650 01952000
*         $IMITX=25;                /* ELSE CONVERT JUST 1 LINE    0650 01953000
*                                      CONVERT DATA TO WORK AREA     */ 01954000
*                                                                  0650 01955000
         B     @RC00648                                            0650 01956000
@RF00648 MVI   $IMITX(WAPTR),X'19'                                 0650 01957000
*       /*************************************************************/ 01958000
*       /*                                                           */ 01959000
*       /* ITACONV FROM(CNVDATA)TO(DPRWORK)COUNT($IMITX)TYPE(HE)     */ 01960000
*       /* INVOKED                                                   */ 01961000
*       /*                                                           */ 01962000
*       /*************************************************************/ 01963000
*                                                                  0651 01964000
*       ITATCFR=ADDR(CNVDATA);      /* SET THE FROM ADDRESS          */ 01965000
@RC00648 L     @14,$DDRPTR(,WAPTR)                                 0651 01966000
         ST    @14,ITATCFR                                         0651 01967000
*       ITATCTO=ADDR(DPRWORK);      /* SET THE TO ADDRESS            */ 01968000
         LA    @14,DPRWORK(,WAPTR)                                 0652 01969000
         ST    @14,ITATCTO                                         0652 01970000
*       ITATCTP='1'B;               /* SET THE TYPE OF CONVERT BIT   */ 01971000
         OI    ITATCTP,B'10000000'                                 0653 01972000
*       ITATCNT=$IMITX;             /* GIVE THE CONVERT BYTE COUNT   */ 01973000
         IC    @14,$IMITX(,WAPTR)                                  0654 01974000
         STC   @14,ITATCNT                                         0654 01975000
*       R1=ADDR(ITATCPRM);          /* POINT TO CONVERT PARM LIST    */ 01976000
         LA    R1,ITATCPRM                                         0655 01977000
*       CALL ISTSC021;              /* CALL CONVERT DIRECTLY         */ 01978000
         L     @15,@CV00877                                        0656 01979000
         BALR  @14,@15                                             0656 01980000
*       $ATACNT=$ATACNT-            /* SUBTRACT LINE PRINTED         */ 01981000
*           $IMITX;                                                0657 01982000
         SLR   @14,@14                                             0657 01983000
         IC    @14,$IMITX(,WAPTR)                                  0657 01984000
         LH    @00,$ATACNT(,WAPTR)                                 0657 01985000
         SLR   @00,@14                                             0657 01986000
         STH   @00,$ATACNT(,WAPTR)                                 0657 01987000
*       $IMITX=2*$IMITX;            /* CONVERTED DATA COUNT          */ 01988000
         ALR   @14,@14                                             0658 01989000
         STC   @14,$IMITX(,WAPTR)                                  0658 01990000
*       $ATAPTR=ADDR(DPRWORK);      /* DATA TO PRINT                 */ 01991000
         LA    @14,DPRWORK(,WAPTR)                                 0659 01992000
         ST    @14,$ATAPTR(,WAPTR)                                 0659 01993000
*     END;                                                         0660 01994000
*   ELSE                                                           0661 01995000
*     DO;                                                          0661 01996000
         B     @RC00646                                            0661 01997000
@RF00646 DS    0H                                                  0662 01998000
*       IF $ATACNT<=50              /* IF DATA COUNT IS              */ 01999000
*         THEN                                                     0662 02000000
         LH    @14,$ATACNT(,WAPTR)                                 0662 02001000
         C     @14,@CF00719                                        0662 02002000
         BH    @RF00662                                            0662 02003000
*         $IMITX=                   /* < = LINE LIMIT                */ 02004000
*             $ATACNT;              /* PRINT ALL OF IT               */ 02005000
         STC   @14,$IMITX(,WAPTR)                                  0663 02006000
*       ELSE                                                       0664 02007000
*         $IMITX=50;                /* ELSE PRINT 1 LINE OF IT       */ 02008000
         B     @RC00662                                            0664 02009000
@RF00662 MVI   $IMITX(WAPTR),X'32'                                 0664 02010000
*       $ATACNT=$ATACNT-            /* SUBTRACT LINE PRINTED         */ 02011000
*           $IMITX;                                                0665 02012000
@RC00662 LH    @14,$ATACNT(,WAPTR)                                 0665 02013000
         SLR   @00,@00                                             0665 02014000
         IC    @00,$IMITX(,WAPTR)                                  0665 02015000
         SLR   @14,@00                                             0665 02016000
         STH   @14,$ATACNT(,WAPTR)                                 0665 02017000
*     END;                                                         0666 02018000
*   DATAFLD(1:$IMITX)=              /* MOVE DATA INTO PRINT LINE     */ 02019000
*       DATARRAY(1:$IMITX);                                        0667 02020000
@RC00646 SLR   @14,@14                                             0667 02021000
         IC    @14,$IMITX(,WAPTR)                                  0667 02022000
         BCTR  @14,0                                               0667 02023000
         L     @11,$ATAPTR(,WAPTR)                                 0667 02024000
         EX    @14,@SM01097                                        0667 02025000
*   CALL S24C2000;                  /* CHK PP 2&3 OUTPUT LINE        */ 02026000
         BAL   @14,S24C2000                                        0668 02027000
*   IF $DONTCVT=OFF                 /* IF DATA TO BE CONVERTED       */ 02028000
*     THEN                          /* THEN                          */ 02029000
         TM    $DONTCVT(PRTPTR),B'00001000'                        0669 02030000
         BNZ   @RF00669                                            0669 02031000
*     $DDRPTR=$DDRPTR+($IMITX/2);   /* POINT TO NEXT DATA TO CONVERT */ 02032000
         SLR   @14,@14                                             0670 02033000
         IC    @14,$IMITX(,WAPTR)                                  0670 02034000
         SRL   @14,1                                               0670 02035000
         AL    @14,$DDRPTR(,WAPTR)                                 0670 02036000
         ST    @14,$DDRPTR(,WAPTR)                                 0670 02037000
*   ELSE                            /* ESLE                          */ 02038000
*     $ATAPTR=$ATAPTR+$IMITX;       /* POINT TO NEXT PART            */ 02039000
         B     @RC00669                                            0671 02040000
@RF00669 SLR   @14,@14                                             0671 02041000
         IC    @14,$IMITX(,WAPTR)                                  0671 02042000
         AL    @14,$ATAPTR(,WAPTR)                                 0671 02043000
         ST    @14,$ATAPTR(,WAPTR)                                 0671 02044000
*   IF $ATACNT>0                    /* IF MORE TO PRINT              */ 02045000
*     THEN                                                         0672 02046000
@RC00669 LH    @14,$ATACNT(,WAPTR)                                 0672 02047000
         LTR   @14,@14                                             0672 02048000
         BP    @RT00672                                            0672 02049000
*     GOTO S24C7010;                /* KEEP PROCESSING               */ 02050000
*S24C7020:                                                         0674 02051000
*   R14=$24SAVE1;                   /* RESTORE RET ADDR              */ 02052000
S24C7020 L     R14,$24SAVE1(,WAPTR)                                0674 02053000
*   END S24C7000;                                                  0675 02054000
@EL00007 DS    0H                                                  0675 02055000
@EF00007 DS    0H                                                  0675 02056000
@ER00007 BR    @14                                                 0675 02057000
*S24C9990:                                                         0676 02058000
*   R15=0;                          /* SET RC = 0                    */ 02059000
S24C9990 SLR   R15,R15                                             0676 02060000
*   $R13PTR=$24SAV13;               /* PT RCM TO MY CALLER           */ 02061000
         L     @14,$24SAV13(,WAPTR)                                0677 02062000
         ST    @14,$R13PTR(,WAPTR)                                 0677 02063000
*   $NOTRRCH=OFF;                   /* DO RC HDLG & TRACE NOW        */ 02064000
         NI    $NOTRRCH(WAPTR),B'11111101'                         0678 02065000
*S24C9999:                                                         0679 02066000
*   R13=SVESC024(2);                /* PTR TO CALLER'S SVAREA        */ 02067000
S24C9999 L     R13,SVESC024+4(,WAPTR)                              0679 02068000
*   DO;                             /* ATDSPLY                       */ 02069000
*   END;                            /* ATDSPLY                       */ 02070000
*   END ISTSC024;                                                  0682 02071000
@EL00001 DS    0H                                                  0682 02072000
@EF00001 DS    0H                                                  0682 02073000
@ER00001 L     @14,12(,@13)                                        0682 02074000
         LM    @00,@12,20(@13)                                     0682 02075000
         BR    @14                                                 0682 02076000
@DATA    DS    0H                                                       02077000
@CH00180 DC    H'3'                                                     02078000
@CH00326 DC    H'68'                                                    02079000
@SM01093 MVC   $BUFFER(0,WAPTR),S24LINE(@11)                            02080000
@SM01097 MVC   DATAFLD+1976(0,WAPTR),DATARRAY(@11)                      02081000
         DS    0F                                                       02082000
@TF00001 DS    F                                                        02083000
         DS    0F                                                       02084000
@CF00864 DC    F'0'                                                     02085000
@CF00043 DC    F'1'                                                     02086000
@CF00086 DC    F'2'                                                     02087000
@CF00041 DC    F'4'                                                     02088000
@CF00399 DC    F'6'                                                     02089000
@CF00039 DC    F'8'                                                     02090000
@CF00452 DC    F'17'                                                    02091000
@CH00452 EQU   @CF00452+2                                               02092000
@CF00851 DC    F'25'                                                    02093000
@CF00719 DC    F'50'                                                    02094000
@CF00435 DC    F'120'                                                   02095000
@CF01096 DC    F'-17'                                                   02096000
@CF01084 DC    F'-8'                                                    02097000
@CF01092 DC    F'-4'                                                    02098000
@CF01082 DC    XL4'0000FFFF'                                            02099000
@CV00877 DC    V(ISTSC021)                                              02100000
@CV00995 DC    V(ISTIC002)                                              02101000
@CV01021 DC    V(ISTCC011)                                              02102000
         DS    0D                                                       02103000
CSWPSWPT DS    A                                                        02104000
         DS    0D                                                       02105000
@TS00001 DS    CL8                                                      02106000
@CC00920 DC    C'XPTD CSW1'                                             02107000
@CC00934 DC    C'RCVD CSW1'                                             02108000
@CC00959 DC    C'XPTD DATA'                                             02109000
@CC00964 DC    C'RCVD DATA'                                             02110000
@CC00968 DC    C'WRTN DATA'                                             02111000
@CC00890 DC    C'        '                                              02112000
@CC00950 DC    C'XPTD SNS'                                              02113000
@CC00956 DC    C'RCVD SNS'                                              02114000
@CC00994 DC    C'SYS CON '                                              02115000
@CC00917 DC    C'XPTD CC'                                               02116000
@CC00919 DC    C'RCVD CC'                                               02117000
@CC00889 DC    C'DEV/LN'                                                02118000
@CC00893 DC    C'REFNUM'                                                02119000
@CC00912 DC    C'QUEUED'                                                02120000
@CC00880 DC    C'NONE'                                                  02121000
@CC00931 DC    C'CSW2'                                                  02122000
@CC00888 DC    C'RTN'                                                   02123000
@CC00892 DC    C'ECA'                                                   02124000
@CC00904 DC    C'CAW'                                                   02125000
@CC00905 DC    C'CCW'                                                   02126000
MASK     DS    BL1                                                      02127000
CSWXXXXX DC    CL6'XXXXXX'                                              02128000
ITATCPRM DS    CL14                                                     02129000
         ORG   ITATCPRM                                                 02130000
@NM00100 DC    X'0102F4F1'                                              02131000
ITATCFR  DS    AL4                                                      02132000
ITATCTO  DS    AL4                                                      02133000
@NM00101 DC    AL1(0)                                                   02134000
         ORG   @NM00101                                                 02135000
ITATCTP  DS    BL1                                                      02136000
         ORG   ITATCPRM+13                                              02137000
ITATCNT  DS    FL1                                                      02138000
         ORG   ITATCPRM+14                                              02139000
         DS    CL2                                                      02140000
$TCA15   DS    CL13                                                     02141000
         ORG   $TCA15                                                   02142000
$TCB15   DC    A(129)                                                   02143000
$TCC15   DC    A(0)                                                     02144000
$TCD15   DC    B'10000000'                                              02145000
$TCE15   DC    X'FFFFFFFF'                                              02146000
         ORG   $TCA15+13                                                02147000
         DS    CL3                                                      02148000
$TCA16   DS    CL13                                                     02149000
         ORG   $TCA16                                                   02150000
$TCB16   DC    A(157)                                                   02151000
$TCC16   DC    A(0)                                                     02152000
$TCD16   DC    B'10000000'                                              02153000
$TCE16   DC    X'FFFFFFFF'                                              02154000
         ORG   $TCA16+13                                                02155000
         DS    CL3                                                      02156000
$TCA17   DS    CL13                                                     02157000
         ORG   $TCA17                                                   02158000
$TCB17   DC    A(240)                                                   02159000
$TCC17   DC    A(0)                                                     02160000
$TCD17   DC    B'00000000'                                              02161000
$TCE17   DC    X'FFFFFFFF'                                              02162000
         ORG   $TCA17+13                                                02163000
         DS    CL3                                                      02164000
S24REP   DS    10F                                                      02165000
@00      EQU   00                      EQUATES FOR REGISTERS 0-15       02166000
@01      EQU   01                                                       02167000
@02      EQU   02                                                       02168000
@03      EQU   03                                                       02169000
@04      EQU   04                                                       02170000
@05      EQU   05                                                       02171000
@06      EQU   06                                                       02172000
@07      EQU   07                                                       02173000
@08      EQU   08                                                       02174000
@09      EQU   09                                                       02175000
@10      EQU   10                                                       02176000
@11      EQU   11                                                       02177000
@12      EQU   12                                                       02178000
@13      EQU   13                                                       02179000
@14      EQU   14                                                       02180000
@15      EQU   15                                                       02181000
SEARCHCT EQU   @08                                                      02182000
J        EQU   @08                                                      02183000
BFRPTR   EQU   @09                                                      02184000
WORKPTR  EQU   @08                                                      02185000
HDRPTR   EQU   @08                                                      02186000
WAPTR    EQU   @02                                                      02187000
DPRPTR   EQU   @03                                                      02188000
PRTPTR   EQU   @04                                                      02189000
R1       EQU   @01                                                      02190000
R13      EQU   @13                                                      02191000
R15      EQU   @15                                                      02192000
R14      EQU   @14                                                      02193000
TECBPTR  EQU   @05                                                      02194000
TOLTEPWA EQU   0                                                        02195000
$SCTTBLE EQU   TOLTEPWA                                                 02196000
$TESTOPT EQU   $SCTTBLE+2                                               02197000
$NOPRT   EQU   $TESTOPT                                                 02198000
$FSTCOMM EQU   $TESTOPT                                                 02199000
$ERROPT  EQU   $SCTTBLE+3                                               02200000
$TESTERR EQU   $ERROPT                                                  02201000
$ASTERIK EQU   $ERROPT                                                  02202000
$CATERR  EQU   $ERROPT                                                  02203000
$ALTPRNT EQU   $ERROPT                                                  02204000
$NERRPRT EQU   $ERROPT                                                  02205000
$LOOPERR EQU   $ERROPT                                                  02206000
$LOOPTST EQU   $ERROPT                                                  02207000
$PDEVFLG EQU   $SCTTBLE+10                                              02208000
$CDSFLGS EQU   $SCTTBLE+11                                              02209000
$SYMNAME EQU   $CDSFLGS                                                 02210000
$PDEVADR EQU   $SCTTBLE+12                                              02211000
$CDS8T19 EQU   $SCTTBLE+20                                              02212000
$SYNAME  EQU   $CDS8T19+4                                               02213000
$EXECFLG EQU   $SCTTBLE+33                                              02214000
$OLTFLGS EQU   $SCTTBLE+36                                              02215000
$OLTFLG2 EQU   $SCTTBLE+37                                              02216000
$TOTFLG1 EQU   $SCTTBLE+38                                              02217000
$ROUTMSK EQU   $SCTTBLE+40                                              02218000
$CDA     EQU   TOLTEPWA+100                                             02219000
$RCA     EQU   $CDA+44                                                  02220000
$OLTPTR  EQU   $CDA+52                                                  02221000
$LOWADDR EQU   $OLTPTR                                                  02222000
$HIMOREC EQU   $CDA+60                                                  02223000
$R13PTR  EQU   $CDA+80                                                  02224000
$PRNTLVL EQU   $CDA+104                                                 02225000
$PRTFORM EQU   $CDA+116                                                 02226000
$COMMFLG EQU   TOLTEPWA+224                                             02227000
$FLAG1   EQU   $COMMFLG                                                 02228000
$FLAG2   EQU   $COMMFLG+1                                               02229000
$NDR     EQU   $FLAG2                                                   02230000
$FLAG3   EQU   $COMMFLG+2                                               02231000
$PRTONLY EQU   $FLAG3                                                   02232000
$FLAG4   EQU   $COMMFLG+3                                               02233000
$FLAG5   EQU   $COMMFLG+4                                               02234000
$FSTFE   EQU   $FLAG5                                                   02235000
$FSTCAT  EQU   $FLAG5                                                   02236000
$EOJ     EQU   $FLAG5                                                   02237000
$CANCEL  EQU   $EOJ                                                     02238000
$FLAG6   EQU   $COMMFLG+5                                               02239000
$ABNDBIT EQU   $FLAG6                                                   02240000
$FLAG7   EQU   $COMMFLG+6                                               02241000
$FLAG8   EQU   $COMMFLG+7                                               02242000
$TCECM   EQU   $FLAG8                                                   02243000
$FLAG9   EQU   $COMMFLG+8                                               02244000
$NOTRRCH EQU   $FLAG9                                                   02245000
$FLAG10  EQU   $COMMFLG+9                                               02246000
$FLAG11  EQU   $COMMFLG+10                                              02247000
$FLAG12  EQU   $COMMFLG+11                                              02248000
$FLAG13  EQU   $COMMFLG+12                                              02249000
$CATMSG  EQU   $FLAG13                                                  02250000
$DEVTBLE EQU   TOLTEPWA+240                                             02251000
$DEVCDS  EQU   $DEVTBLE                                                 02252000
$DEVUNAD EQU   $DEVCDS                                                  02253000
@NM00035 EQU   $DEVUNAD+2                                               02254000
$DEVFEAT EQU   $DEVCDS+4                                                02255000
$DEVCDSF EQU   $DEVCDS+9                                                02256000
$DEVSDCF EQU   $DEVCDS+10                                               02257000
$$SYMNME EQU   $DEVCDS+12                                               02258000
$DEVFLG1 EQU   $DEVTBLE+20                                              02259000
$EVNCPLT EQU   $DEVFLG1                                                 02260000
$ATTNEXP EQU   $DEVFLG1                                                 02261000
$INTOCC  EQU   $DEVFLG1                                                 02262000
$DEVFLG2 EQU   $DEVTBLE+21                                              02263000
$TESTMDE EQU   $DEVFLG2                                                 02264000
$DEVTECB EQU   $DEVTBLE+22                                              02265000
$OPIS    EQU   $DEVTECB                                                 02266000
$OPND    EQU   $DEVTECB+2                                               02267000
$DEVFLG3 EQU   $DEVTBLE+27                                              02268000
$SIOFLG  EQU   $DEVFLG3                                                 02269000
$SYSMN   EQU   $DEVTBLE+28                                              02270000
$IFTOUT  EQU   $DEVTBLE+36                                              02271000
$DEVSESP EQU   $IFTOUT                                                  02272000
$SSCPDAF EQU   $IFTOUT+6                                                02273000
$LDNCBPT EQU   $DEVTBLE+48                                              02274000
$RNINFO  EQU   $DEVTBLE+56                                              02275000
$LINENME EQU   $RNINFO                                                  02276000
$DEVFLG5 EQU   $RNINFO+8                                                02277000
$DEVFLG4 EQU   $DEVTBLE+65                                              02278000
$DEVCNTS EQU   TOLTEPWA+1464                                            02279000
$BUFFER  EQU   TOLTEPWA+1976                                            02280000
$INBUFR  EQU   TOLTEPWA+2104                                            02281000
$WORK    EQU   TOLTEPWA+2376                                            02282000
#EXITA   EQU   TOLTEPWA+2632                                            02283000
$CCOMDAT EQU   TOLTEPWA+2644                                            02284000
$COUTAD  EQU   $CCOMDAT                                                 02285000
$COUTCT  EQU   $CCOMDAT+4                                               02286000
$CINADR  EQU   $CCOMDAT+8                                               02287000
$CFLGS   EQU   $CCOMDAT+16                                              02288000
$24RETCD EQU   TOLTEPWA+2663                                            02289000
$24SAV13 EQU   TOLTEPWA+2664                                            02290000
$24UNADR EQU   TOLTEPWA+2668                                            02291000
$24SAVE1 EQU   TOLTEPWA+2672                                            02292000
$24SAVE2 EQU   TOLTEPWA+2676                                            02293000
$24FLGS  EQU   TOLTEPWA+2680                                            02294000
$24FEMSG EQU   TOLTEPWA+2681                                            02295000
$ESECTID EQU   $24FEMSG                                                 02296000
$24RTN#  EQU   $24FEMSG+8                                               02297000
$24CATMG EQU   $24FEMSG+11                                              02298000
$24DEVAD EQU   $24CATMG                                                 02299000
$24SYMNE EQU   $24CATMG+4                                               02300000
@NM00043 EQU   TOLTEPWA+2776                                            02301000
$DDRPTR  EQU   @NM00043                                                 02302000
$OUNTPTR EQU   @NM00043+4                                               02303000
$NSPTR   EQU   $OUNTPTR                                                 02304000
$ATAPTR  EQU   $NSPTR                                                   02305000
$CTR     EQU   @NM00043+8                                               02306000
$NSCNT   EQU   @NM00043+10                                              02307000
$ATACNT  EQU   $NSCNT                                                   02308000
$NSXX    EQU   @NM00043+12                                              02309000
$UMXX    EQU   @NM00043+14                                              02310000
$ENXX    EQU   @NM00043+15                                              02311000
$IMITX   EQU   $ENXX                                                    02312000
$INDEX   EQU   $IMITX                                                   02313000
SVESC033 EQU   TOLTEPWA+3160                                            02314000
SVECC013 EQU   TOLTEPWA+3232                                            02315000
SVEIC003 EQU   TOLTEPWA+3592                                            02316000
SVESC022 EQU   TOLTEPWA+3736                                            02317000
SVECC011 EQU   TOLTEPWA+4024                                            02318000
#EXIT    EQU   0                                                        02319000
@NM00046 EQU   0                                                        02320000
SECTID   EQU   @NM00046                                                 02321000
LEVEL    EQU   @NM00046+8                                               02322000
RTNDISP  EQU   @NM00046+10                                              02323000
INST     EQU   @NM00046+12                                              02324000
$NEWSPRF EQU   0                                                        02325000
$RTN#    EQU   $NEWSPRF                                                 02326000
#FLAGS   EQU   $NEWSPRF+16                                              02327000
$REFNUM  EQU   $NEWSPRF+17                                              02328000
$ECA     EQU   $NEWSPRF+32                                              02329000
DPRNTMAP EQU   0                                                        02330000
$PRTCTLW EQU   DPRNTMAP+4                                               02331000
$PRTMSGL EQU   DPRNTMAP+8                                               02332000
$PRTTECB EQU   DPRNTMAP+12                                              02333000
$PRTACCC EQU   DPRNTMAP+16                                              02334000
$PTCCWA  EQU   DPRNTMAP+20                                              02335000
$PTXCSW1 EQU   DPRNTMAP+24                                              02336000
$PTRCSW1 EQU   DPRNTMAP+28                                              02337000
$PTXCSW2 EQU   DPRNTMAP+32                                              02338000
$PTRCSW2 EQU   DPRNTMAP+36                                              02339000
$PTXSNSA EQU   DPRNTMAP+40                                              02340000
$PTRSNSA EQU   DPRNTMAP+44                                              02341000
$PTXDATA EQU   DPRNTMAP+48                                              02342000
$PTRDATA EQU   DPRNTMAP+52                                              02343000
$PTWDATA EQU   DPRNTMAP+56                                              02344000
$PTDESCA EQU   DPRNTMAP+60                                              02345000
PRNTMAPA EQU   0                                                        02346000
$PTCNTWD EQU   PRNTMAPA                                                 02347000
$DPHEADR EQU   $PTCNTWD                                                 02348000
$DPCHAIN EQU   $PTCNTWD                                                 02349000
$ERRORDP EQU   $PTCNTWD                                                 02350000
$DPREFNM EQU   $PTCNTWD                                                 02351000
$CCWERR  EQU   $PTCNTWD+1                                               02352000
$CSW1ERR EQU   $PTCNTWD+1                                               02353000
$DONTCVT EQU   $PTCNTWD+1                                               02354000
$SENSERR EQU   $PTCNTWD+1                                               02355000
$MESSAGE EQU   $PTCNTWD+1                                               02356000
$DESCRIP EQU   $PTCNTWD+2                                               02357000
$DPCCW   EQU   $PTCNTWD+2                                               02358000
$XPDCSW1 EQU   $PTCNTWD+2                                               02359000
$RCVCSW1 EQU   $PTCNTWD+2                                               02360000
$XPDCSW2 EQU   $PTCNTWD+2                                               02361000
$RCVCSW2 EQU   $PTCNTWD+2                                               02362000
$XPTDSNS EQU   $PTCNTWD+2                                               02363000
$RCVDSNS EQU   $PTCNTWD+2                                               02364000
$XPTDATA EQU   $PTCNTWD+3                                               02365000
$RCVDATA EQU   $PTCNTWD+3                                               02366000
$WRTDATA EQU   $PTCNTWD+3                                               02367000
$DATAERR EQU   $PTCNTWD+3                                               02368000
$CONCODE EQU   $PTCNTWD+3                                               02369000
$CCERROR EQU   $PTCNTWD+3                                               02370000
$PSWCSW  EQU   $PTCNTWD+3                                               02371000
$PTMSGLC EQU   PRNTMAPA+4                                               02372000
$PTMSGOF EQU   PRNTMAPA+5                                               02373000
$PTECC   EQU   PRNTMAPA+6                                               02374000
$PTRENUM EQU   PRNTMAPA+7                                               02375000
$PTDEVAD EQU   PRNTMAPA+9                                               02376000
$PTNCCWS EQU   PRNTMAPA+11                                              02377000
$PTFCCWS EQU   PRNTMAPA+12                                              02378000
$PTXCSWM EQU   PRNTMAPA+13                                              02379000
$PTXSNSC EQU   PRNTMAPA+14                                              02380000
$PTRSNSC EQU   PRNTMAPA+15                                              02381000
$PTDESCL EQU   PRNTMAPA+16                                              02382000
$PTXDATC EQU   PRNTMAPA+17                                              02383000
$PTRDATC EQU   PRNTMAPA+19                                              02384000
$PTWDATC EQU   PRNTMAPA+21                                              02385000
$PTDESCC EQU   PRNTMAPA+23                                              02386000
TECBMAPS EQU   0                                                        02387000
TECBFDCT EQU   TECBMAPS                                                 02388000
TECBFDLN EQU   TECBMAPS+1                                               02389000
TECBSNLN EQU   TECBMAPS+2                                               02390000
TECBFLGS EQU   TECBMAPS+4                                               02391000
TCBQUEUE EQU   TECBFLGS                                                 02392000
TECBSNCT EQU   TECBMAPS+5                                               02393000
TECBSNOC EQU   TECBMAPS+6                                               02394000
TECBEVOC EQU   TECBMAPS+7                                               02395000
TECBEVT1 EQU   TECBMAPS+8                                               02396000
TECBFD01 EQU   0                                                        02397000
TCBEVTYP EQU   TECBFD01                                                 02398000
TCBEVDEV EQU   TECBFD01+1                                               02399000
@NM00055 EQU   TECBFD01+4                                               02400000
TCBEVCSW EQU   @NM00055                                                 02401000
TECBSNS1 EQU   0                                                        02402000
TCBSNDEV EQU   TECBSNS1                                                 02403000
TCBSENSE EQU   TECBSNS1+3                                               02404000
TECBSEND EQU   0                                                        02405000
TCBRESP  EQU   TECBSEND+4                                               02406000
TCBRTYPE EQU   TECBSEND+7                                               02407000
TCBRKCHG EQU   TECBSEND+8                                               02408000
S24ADDRA EQU   0                                                        02409000
S24LINE  EQU   0                                                        02410000
S24BYTEA EQU   0                                                        02411000
S24FLAG1 EQU   0                                                        02412000
S24CCREQ EQU   S24FLAG1                                                 02413000
S24CSW2R EQU   S24FLAG1                                                 02414000
S24SNSRQ EQU   S24FLAG1                                                 02415000
S24TCBER EQU   S24FLAG1                                                 02416000
S24SCHFL EQU   S24FLAG1                                                 02417000
@NM00062 EQU   0                                                        02418000
HDRERROR EQU   @NM00062                                                 02419000
HDRTSTID EQU   @NM00062+1                                               02420000
HDRHYPHN EQU   @NM00062+9                                               02421000
HDRLEVEL EQU   @NM00062+10                                              02422000
HDRRTN   EQU   @NM00062+14                                              02423000
HDRRTN#  EQU   @NM00062+17                                              02424000
HDROUTN# EQU   HDRRTN#+1                                                02425000
HDRDEVLN EQU   @NM00062+24                                              02426000
HDRUNADR EQU   @NM00062+31                                              02427000
HDRSYMNM EQU   @NM00062+36                                              02428000
HDRECA   EQU   @NM00062+46                                              02429000
HDRECA#  EQU   @NM00062+50                                              02430000
HDREFNUM EQU   @NM00062+55                                              02431000
HDREF#   EQU   @NM00062+61                                              02432000
@NM00069 EQU   0                                                        02433000
DPRCCWER EQU   @NM00069                                                 02434000
DPRCCW   EQU   @NM00069+1                                               02435000
DPRCCW#  EQU   @NM00069+4                                               02436000
DPRCMDCD EQU   @NM00069+7                                               02437000
DPRDATA  EQU   @NM00069+10                                              02438000
DPRSPARE EQU   @NM00069+17                                              02439000
DPRFLAGS EQU   @NM00069+20                                              02440000
DPRCOUNT EQU   @NM00069+23                                              02441000
DPRCAW   EQU   @NM00069+32                                              02442000
DPRCAWAD EQU   @NM00069+36                                              02443000
S24CCWA  EQU   0                                                        02444000
@NM00077 EQU   0                                                        02445000
S24CCWCD EQU   @NM00077                                                 02446000
S24CCWDA EQU   @NM00077+2                                               02447000
S24CCWEX EQU   @NM00077+8                                               02448000
S24CCWFL EQU   @NM00077+10                                              02449000
S24CCWCT EQU   @NM00077+12                                              02450000
@NM00078 EQU   0                                                        02451000
CCERROR  EQU   @NM00078                                                 02452000
CCXPTDCC EQU   @NM00078+1                                               02453000
CCXPTDCD EQU   @NM00078+9                                               02454000
CCRCVDCC EQU   @NM00078+14                                              02455000
CCQUEUED EQU   @NM00078+22                                              02456000
CCCONDCD EQU   CCQUEUED                                                 02457000
S24CC    EQU   0                                                        02458000
@NM00083 EQU   0                                                        02459000
CSWPSWER EQU   @NM00083                                                 02460000
CSWXPTRC EQU   @NM00083+1                                               02461000
CSWPSW1  EQU   CSWXPTRC+5                                               02462000
CSW#     EQU   CSWXPTRC+8                                               02463000
CSW1KEY  EQU   @NM00083+11                                              02464000
CSW1NONE EQU   CSW1KEY                                                  02465000
CSW2CSW2 EQU   @NM00083+32                                              02466000
CSWPSW2  EQU   CSW2CSW2                                                 02467000
CSW2KEY  EQU   @NM00083+37                                              02468000
CSW2NONE EQU   CSW2KEY                                                  02469000
WORKCSW  EQU   0                                                        02470000
PSWFLD   EQU   0                                                        02471000
@NM00092 EQU   0                                                        02472000
CSWKEY   EQU   @NM00092                                                 02473000
CSWBLANK EQU   @NM00092+2                                               02474000
CSWADDR  EQU   @NM00092+3                                               02475000
CSWSTAT  EQU   @NM00092+10                                              02476000
CSWCOUNT EQU   @NM00092+15                                              02477000
FROMFLD  EQU   0                                                        02478000
@NM00095 EQU   0                                                        02479000
SNSASTRK EQU   @NM00095                                                 02480000
SNSXPRCV EQU   @NM00095+1                                               02481000
SNSNONE  EQU   @NM00095+10                                              02482000
SNSFLDS  EQU   0                                                        02483000
SNSDATA  EQU   SNSFLDS                                                  02484000
FROMSNS  EQU   0                                                        02485000
TOSENSE  EQU   0                                                        02486000
@NM00098 EQU   0                                                        02487000
DATAERR  EQU   @NM00098                                                 02488000
DATAXPRC EQU   @NM00098+1                                               02489000
DATAWRT  EQU   DATAXPRC                                                 02490000
DATAFLD  EQU   @NM00098+11                                              02491000
DATARRAY EQU   0                                                        02492000
CNVDATA  EQU   0                                                        02493000
BACKSAVE EQU   0                                                        02494000
$PTMSGCA EQU   0                                                        02495000
$PTMSGCC EQU   0                                                        02496000
OLTENTRY EQU   0                                                        02497000
SVESC024 EQU   SVESC022                                                 02498000
DPRWORK  EQU   $WORK                                                    02499000
DPRWORK1 EQU   DPRWORK+3                                                02500000
DPRWORK2 EQU   DPRWORK+4                                                02501000
I        EQU   $CTR                                                     02502000
SVECC012 EQU   SVESC022                                                 02503000
SVEIC00A EQU   SVEIC003                                                 02504000
SVEIC004 EQU   SVEIC003                                                 02505000
SVEIC005 EQU   SVEIC003                                                 02506000
SVESC02A EQU   SVESC022                                                 02507000
SVESC02B EQU   SVESC022                                                 02508000
SVESC02D EQU   SVESC022                                                 02509000
SVESC02E EQU   SVESC022                                                 02510000
SVESC02F EQU   SVECC013                                                 02511000
SVESC027 EQU   SVESC022                                                 02512000
SVESC029 EQU   SVESC033                                                 02513000
SVESC031 EQU   SVECC013                                                 02514000
SVESC032 EQU   SVECC011                                                 02515000
SVETC037 EQU   SVEIC003                                                 02516000
         AGO   .@UNREFD                START UNREFERENCED COMPONENTS    02517000
@NM00060 EQU   DPRWORK                                                  02518000
@NM00099 EQU   @NM00098+10                                              02519000
@NM00097 EQU   SNSFLDS+2                                                02520000
@NM00096 EQU   @NM00095+9                                               02521000
@NM00094 EQU   @NM00092+14                                              02522000
@NM00093 EQU   @NM00092+9                                               02523000
@NM00091 EQU   CSW2KEY+4                                                02524000
@NM00090 EQU   @NM00083+36                                              02525000
@NM00089 EQU   CSW2CSW2+1                                               02526000
@NM00088 EQU   @NM00083+27                                              02527000
@NM00087 EQU   CSW1KEY+4                                                02528000
@NM00086 EQU   @NM00083+10                                              02529000
@NM00085 EQU   CSWXPTRC+6                                               02530000
@NM00084 EQU   CSWXPTRC                                                 02531000
@NM00082 EQU   CCQUEUED+1                                               02532000
@NM00081 EQU   @NM00078+21                                              02533000
@NM00080 EQU   @NM00078+10                                              02534000
@NM00079 EQU   @NM00078+8                                               02535000
@NM00076 EQU   @NM00069+35                                              02536000
@NM00075 EQU   @NM00069+27                                              02537000
@NM00074 EQU   @NM00069+22                                              02538000
@NM00073 EQU   @NM00069+19                                              02539000
@NM00072 EQU   @NM00069+16                                              02540000
@NM00071 EQU   @NM00069+9                                               02541000
@NM00070 EQU   @NM00069+6                                               02542000
@NM00068 EQU   @NM00062+53                                              02543000
@NM00067 EQU   @NM00062+49                                              02544000
@NM00066 EQU   @NM00062+44                                              02545000
@NM00065 EQU   @NM00062+35                                              02546000
@NM00064 EQU   @NM00062+21                                              02547000
HDRBLANK EQU   HDRRTN#                                                  02548000
@NM00063 EQU   @NM00062+12                                              02549000
@NM00061 EQU   S24FLAG1                                                 02550000
TCBOBSQL EQU   TECBSEND+23                                              02551000
TCBOBSQ  EQU   TECBSEND+22                                              02552000
TCBIBSQL EQU   TECBSEND+20                                              02553000
TCBIBSQ  EQU   TECBSEND+19                                              02554000
TCBSIGDA EQU   TECBSEND+15                                              02555000
TCBSEQNO EQU   TECBSEND+13                                              02556000
TCBCNTRL EQU   TECBSEND+10                                              02557000
TCBCHAIN EQU   TECBSEND+9                                               02558000
@NM00059 EQU   TCBRKCHG                                                 02559000
TCBALT   EQU   TCBRKCHG                                                 02560000
TCBREQ   EQU   TCBRKCHG                                                 02561000
TCBCMD   EQU   TCBRKCHG                                                 02562000
TCBEB    EQU   TCBRKCHG                                                 02563000
TCBBB    EQU   TCBRKCHG                                                 02564000
@NM00058 EQU   TCBRTYPE                                                 02565000
TCBDFAS  EQU   TCBRTYPE                                                 02566000
TCBNDFS  EQU   TCBRTYPE                                                 02567000
TCBRSP   EQU   TCBRTYPE                                                 02568000
@NM00057 EQU   TCBRTYPE                                                 02569000
TCBRECLN EQU   TECBSEND+5                                               02570000
TCBRRN   EQU   TCBRESP                                                  02571000
TCBNFME  EQU   TCBRESP                                                  02572000
TCBEX    EQU   TCBRESP                                                  02573000
@NM00056 EQU   TCBRESP                                                  02574000
TCBUSEN  EQU   TECBSEND+2                                               02575000
TCBSSENM EQU   TECBSEND+1                                               02576000
TCBSSEN  EQU   TECBSEND                                                 02577000
@NM00054 EQU   TECBFLGS                                                 02578000
@NM00053 EQU   $PTCNTWD+3                                               02579000
@NM00052 EQU   $PTCNTWD+1                                               02580000
$CSW2ERR EQU   $PTCNTWD+1                                               02581000
@NM00051 EQU   $PTCNTWD+1                                               02582000
@NM00050 EQU   $PTCNTWD                                                 02583000
$DPFORMS EQU   $PTCNTWD                                                 02584000
$DPRIDNT EQU   DPRNTMAP+2                                               02585000
$DPRLEVL EQU   DPRNTMAP+1                                               02586000
$DPRTRMG EQU   DPRNTMAP                                                 02587000
$RME     EQU   $NEWSPRF+36                                              02588000
@NM00049 EQU   $NEWSPRF+35                                              02589000
$DCHB    EQU   $NEWSPRF+28                                              02590000
$MOSIZE  EQU   $NEWSPRF+24                                              02591000
$RTSIZE  EQU   $NEWSPRF+20                                              02592000
$COUNT   EQU   $NEWSPRF+18                                              02593000
@NM00048 EQU   #FLAGS                                                   02594000
#MSGIDRQ EQU   #FLAGS                                                   02595000
#PLKMCOR EQU   #FLAGS                                                   02596000
@NM00047 EQU   #FLAGS                                                   02597000
$VIRTUAL EQU   #FLAGS                                                   02598000
$PLINK$  EQU   $NEWSPRF+12                                              02599000
$SCTREQ  EQU   $NEWSPRF+11                                              02600000
$RM      EQU   $NEWSPRF+9                                               02601000
$CTYPE   EQU   $NEWSPRF+8                                               02602000
$CCLASS  EQU   $NEWSPRF+7                                               02603000
$CFEAT   EQU   $NEWSPRF+6                                               02604000
$CMODEL  EQU   $NEWSPRF+5                                               02605000
$TYPE    EQU   $NEWSPRF+4                                               02606000
$CLASS   EQU   $NEWSPRF+3                                               02607000
$FEAT    EQU   $NEWSPRF+2                                               02608000
$MODEL   EQU   $NEWSPRF+1                                               02609000
#MSGID   EQU   @NM00046+16                                              02610000
SVECC010 EQU   TOLTEPWA+3952                                            02611000
SVETC035 EQU   TOLTEPWA+3880                                            02612000
SVESC030 EQU   TOLTEPWA+3808                                            02613000
SVESC020 EQU   TOLTEPWA+3664                                            02614000
SVEIC002 EQU   TOLTEPWA+3520                                            02615000
SVECC014 EQU   TOLTEPWA+3376                                            02616000
SVESC120 EQU   TOLTEPWA+3304                                            02617000
SVESC025 EQU   TOLTEPWA+3088                                            02618000
@NM00045 EQU   TOLTEPWA+2980                                            02619000
$RPLERR  EQU   TOLTEPWA+2977                                            02620000
@NM00044 EQU   TOLTEPWA+2976                                            02621000
$R13PR3  EQU   TOLTEPWA+2972                                            02622000
$CEINT2  EQU   TOLTEPWA+2968                                            02623000
$CEINT1  EQU   TOLTEPWA+2964                                            02624000
$MSGGET  EQU   TOLTEPWA+2960                                            02625000
$ACQLIST EQU   TOLTEPWA+2956                                            02626000
$R4SAVE1 EQU   TOLTEPWA+2952                                            02627000
$CLSISS  EQU   TOLTEPWA+2950                                            02628000
$CLSCNT  EQU   TOLTEPWA+2948                                            02629000
$CUTABLE EQU   TOLTEPWA+2868                                            02630000
$BUFSZ2  EQU   TOLTEPWA+2864                                            02631000
$RESID2  EQU   TOLTEPWA+2860                                            02632000
$OLTCCW2 EQU   TOLTEPWA+2856                                            02633000
$ENDBFR2 EQU   TOLTEPWA+2852                                            02634000
$1STBFR2 EQU   TOLTEPWA+2848                                            02635000
$TECB2   EQU   TOLTEPWA+2844                                            02636000
$BUFSZ1  EQU   TOLTEPWA+2840                                            02637000
$RESID1  EQU   TOLTEPWA+2836                                            02638000
$OLTCCW1 EQU   TOLTEPWA+2832                                            02639000
$ENDBFR1 EQU   TOLTEPWA+2828                                            02640000
$1STBFR1 EQU   TOLTEPWA+2824                                            02641000
$TECB1   EQU   TOLTEPWA+2820                                            02642000
$WAITIME EQU   TOLTEPWA+2816                                            02643000
$TRTN#   EQU   TOLTEPWA+2815                                            02644000
$WIODEV  EQU   TOLTEPWA+2814                                            02645000
$RQSTSZE EQU   TOLTEPWA+2812                                            02646000
$RQSTPTR EQU   TOLTEPWA+2808                                            02647000
$R4SAVE  EQU   TOLTEPWA+2804                                            02648000
$PARTADR EQU   TOLTEPWA+2800                                            02649000
$TBSDATA EQU   TOLTEPWA+2796                                            02650000
$CTWIDTH EQU   TOLTEPWA+2795                                            02651000
$CTLINE  EQU   TOLTEPWA+2794                                            02652000
$APWIDTH EQU   TOLTEPWA+2793                                            02653000
$APLINE  EQU   TOLTEPWA+2792                                            02654000
$DTORESP EQU   TOLTEPWA+2712                                            02655000
$APNAME  EQU   TOLTEPWA+2704                                            02656000
$MACID   EQU   TOLTEPWA+2661                                            02657000
$CSPARE  EQU   $CFLGS                                                   02658000
$C2WAY   EQU   $CFLGS                                                   02659000
$CINCT   EQU   $CCOMDAT+12                                              02660000
ROOTLOC  EQU   TOLTEPWA+2640                                            02661000
$RETREG  EQU   TOLTEPWA+2636                                            02662000
$EXTA    EQU   TOLTEPWA+2320                                            02663000
$PASSONA EQU   TOLTEPWA+2264                                            02664000
$TRMINPT EQU   TOLTEPWA+2184                                            02665000
$TLTRPL3 EQU   TOLTEPWA+1856                                            02666000
$TLTRPL2 EQU   TOLTEPWA+1736                                            02667000
$TLTRPL1 EQU   TOLTEPWA+1616                                            02668000
$SLTBL   EQU   TOLTEPWA+1468                                            02669000
$CDEVPT  EQU   TOLTEPWA+1466                                            02670000
$FEEDBCK EQU   $DEVTBLE+66                                              02671000
$WTISUED EQU   $DEVFLG4                                                 02672000
$EXIOISD EQU   $DEVFLG4                                                 02673000
$REMWRIT EQU   $DEVFLG4                                                 02674000
$REMDONE EQU   $DEVFLG4                                                 02675000
$2NDUSED EQU   $DEVFLG4                                                 02676000
$1STUSED EQU   $DEVFLG4                                                 02677000
$IGLXIFB EQU   $DEVFLG4                                                 02678000
$EXIOLV3 EQU   $DEVFLG4                                                 02679000
@NM00042 EQU   $DEVFLG5                                                 02680000
$DVBASIC EQU   $DEVFLG5                                                 02681000
$ASCII   EQU   $DEVFLG5                                                 02682000
$DEVLU   EQU   $DEVFLG5                                                 02683000
$OPNDFAL EQU   $DEVFLG5                                                 02684000
$ACQNCB  EQU   $DEVFLG5                                                 02685000
$REMOTE  EQU   $DEVFLG5                                                 02686000
$ENDNODE EQU   $DEVFLG5                                                 02687000
$CID     EQU   $DEVTBLE+52                                              02688000
$DVCOL   EQU   $LDNCBPT+2                                               02689000
$DVROW   EQU   $LDNCBPT                                                 02690000
$NCSPLP  EQU   $DEVTBLE+44                                              02691000
$DVLN    EQU   $SSCPDAF                                                 02692000
$DAF     EQU   $DEVSESP+4                                               02693000
$VARYPAB EQU   $DEVSESP                                                 02694000
@NM00041 EQU   $DEVFLG3                                                 02695000
$CLRSNT  EQU   $DEVFLG3                                                 02696000
$OLTERR  EQU   $DEVFLG3                                                 02697000
$SRTEST  EQU   $DEVFLG3                                                 02698000
$DVSNDOK EQU   $SIOFLG                                                  02699000
$POLLREQ EQU   $DEVFLG3                                                 02700000
$ACQRED  EQU   $DEVFLG3                                                 02701000
$NOTDEV  EQU   $DEVFLG3                                                 02702000
$DVINCT  EQU   $DEVTBLE+26                                              02703000
$DVBRKST EQU   $OPND+1                                                  02704000
$DVBRKSN EQU   $OPND                                                    02705000
$DVSEQNO EQU   $OPIS                                                    02706000
$CEINTRP EQU   $DEVFLG2                                                 02707000
$DEVALOC EQU   $DEVFLG2                                                 02708000
$ALLDATA EQU   $DEVFLG2                                                 02709000
$ENDCNTL EQU   $DEVFLG2                                                 02710000
$CTLDEV  EQU   $DEVFLG2                                                 02711000
$NOCDS   EQU   $DEVFLG2                                                 02712000
$DATAIN  EQU   $DEVFLG2                                                 02713000
$PRIMARY EQU   $DEVFLG1                                                 02714000
$DVCTBYT EQU   $INTOCC                                                  02715000
$DEVACT  EQU   $DEVFLG1                                                 02716000
$DVLGMDE EQU   $ATTNEXP                                                 02717000
$DVSPRM  EQU   $EVNCPLT                                                 02718000
$GRABBED EQU   $DEVFLG1                                                 02719000
$CATASTR EQU   $DEVFLG1                                                 02720000
$LETGO   EQU   $DEVFLG1                                                 02721000
$CURELEM EQU   $$SYMNME+4                                               02722000
$MSGOTSD EQU   $$SYMNME                                                 02723000
$EXTDEV  EQU   $DEVCDS+11                                               02724000
@NM00040 EQU   $DEVSDCF                                                 02725000
$NOTPRIM EQU   $DEVSDCF                                                 02726000
@NM00039 EQU   $DEVCDSF                                                 02727000
@NM00038 EQU   $DEVCDSF                                                 02728000
@NM00037 EQU   $DEVCDSF                                                 02729000
$CDSNAME EQU   $DEVCDSF                                                 02730000
$EXTRN   EQU   $DEVCDSF                                                 02731000
$CEVOLUM EQU   $DEVCDSF                                                 02732000
$SHARD   EQU   $DEVCDSF                                                 02733000
$DEVFPM  EQU   $DEVCDSF                                                 02734000
$DEVCNT  EQU   $DEVCDS+8                                                02735000
$DEVTYPE EQU   $DEVFEAT+3                                               02736000
$DEVCLAS EQU   $DEVFEAT+2                                               02737000
$DEVFRRS EQU   $DEVFEAT+1                                               02738000
$DEVMOD  EQU   $DEVFEAT                                                 02739000
$DEVRDGT EQU   @NM00035+1                                               02740000
$DEVCTLU EQU   @NM00035+1                                               02741000
$DEVCHAN EQU   @NM00035                                                 02742000
@NM00036 EQU   @NM00035                                                 02743000
$CTINDX  EQU   $DEVUNAD                                                 02744000
$FLAG16  EQU   $COMMFLG+15                                              02745000
$FLAG15  EQU   $COMMFLG+14                                              02746000
$FLAG14  EQU   $COMMFLG+13                                              02747000
$TEP2ND  EQU   $FLAG13                                                  02748000
$TEP1ST  EQU   $FLAG13                                                  02749000
$PRMPTSW EQU   $FLAG13                                                  02750000
$DEVENT  EQU   $FLAG13                                                  02751000
$OLTMACC EQU   $FLAG13                                                  02752000
$LGON    EQU   $FLAG13                                                  02753000
$CTLOGON EQU   $FLAG13                                                  02754000
@NM00034 EQU   $FLAG12                                                  02755000
$VARYINP EQU   $FLAG12                                                  02756000
$ENDTEST EQU   $FLAG12                                                  02757000
$VRYHRD  EQU   $FLAG12                                                  02758000
$VRYSFT  EQU   $FLAG12                                                  02759000
$POSTFLG EQU   $FLAG12                                                  02760000
$OPTMSG  EQU   $FLAG12                                                  02761000
$FEORCAT EQU   $FLAG11                                                  02762000
@NM00033 EQU   $FLAG11                                                  02763000
@NM00032 EQU   $FLAG10                                                  02764000
$INBND   EQU   $FLAG10                                                  02765000
$WAITFLG EQU   $FLAG10                                                  02766000
$DPRINT  EQU   $FLAG10                                                  02767000
$HOLD    EQU   $FLAG9                                                   02768000
@NM00031 EQU   $FLAG9                                                   02769000
$COPY    EQU   $FLAG9                                                   02770000
$LSTLNSW EQU   $FLAG9                                                   02771000
$MULLNSW EQU   $FLAG9                                                   02772000
$REMSW   EQU   $FLAG9                                                   02773000
$IGRES   EQU   $FLAG9                                                   02774000
$VS2     EQU   $FLAG8                                                   02775000
$VS1     EQU   $FLAG8                                                   02776000
$EDOS    EQU   $FLAG8                                                   02777000
@NM00030 EQU   $FLAG8                                                   02778000
$TWOWAY  EQU   $FLAG8                                                   02779000
@NM00029 EQU   $FLAG8                                                   02780000
$RCVMSG  EQU   $FLAG7                                                   02781000
$RCVRFLG EQU   $FLAG7                                                   02782000
$SNDRFLG EQU   $FLAG7                                                   02783000
$LDOIS   EQU   $FLAG7                                                   02784000
$DCONTCT EQU   $FLAG7                                                   02785000
$EXIOWAT EQU   $FLAG7                                                   02786000
$2NDDATA EQU   $FLAG7                                                   02787000
$1STDATA EQU   $FLAG7                                                   02788000
$CIREQ   EQU   $FLAG6                                                   02789000
$ABTERM  EQU   $ABNDBIT                                                 02790000
$FSTMCIS EQU   $FLAG6                                                   02791000
$DISCREQ EQU   $FLAG6                                                   02792000
$DISCISS EQU   $FLAG6                                                   02793000
$CHANGE  EQU   $FLAG6                                                   02794000
$CTERROR EQU   $FLAG6                                                   02795000
$RECAL11 EQU   $FLAG6                                                   02796000
@NM00028 EQU   $FLAG5                                                   02797000
$PROGCK  EQU   $CANCEL                                                  02798000
$PRINTAP EQU   $FLAG5                                                   02799000
@NM00027 EQU   $FLAG5                                                   02800000
$MSG922  EQU   $FLAG5                                                   02801000
$CT924   EQU   $FLAG5                                                   02802000
$ACTOPND EQU   $FLAG4                                                   02803000
$ACQCUTT EQU   $FLAG4                                                   02804000
$CLSSACT EQU   $FLAG4                                                   02805000
$BACKINT EQU   $FLAG4                                                   02806000
$DMSGSW  EQU   $FLAG4                                                   02807000
$TSTDEVP EQU   $FLAG4                                                   02808000
$APRQPER EQU   $FLAG4                                                   02809000
$OPCOM   EQU   $FLAG4                                                   02810000
$NEWAP   EQU   $FLAG3                                                   02811000
$ALTPRTR EQU   $FLAG3                                                   02812000
$OPTERR  EQU   $FLAG3                                                   02813000
$REQSTOR EQU   $FLAG3                                                   02814000
$LOGOFFE EQU   $FLAG3                                                   02815000
$TSTERR  EQU   $FLAG3                                                   02816000
$DEVERR  EQU   $FLAG3                                                   02817000
$PARTIAL EQU   $FLAG2                                                   02818000
$NRMTERM EQU   $FLAG2                                                   02819000
$VALDTST EQU   $FLAG2                                                   02820000
$VALDDEV EQU   $FLAG2                                                   02821000
$DBLSLSH EQU   $FLAG2                                                   02822000
@NM00026 EQU   $FLAG2                                                   02823000
$FTTHR   EQU   $FLAG2                                                   02824000
$OLTACT  EQU   $FLAG1                                                   02825000
$NORELDV EQU   $FLAG1                                                   02826000
@NM00025 EQU   $FLAG1                                                   02827000
$OPTCHNG EQU   $FLAG1                                                   02828000
$DEVCHNG EQU   $FLAG1                                                   02829000
$TESTCNG EQU   $FLAG1                                                   02830000
$CNSLFG  EQU   $FLAG1                                                   02831000
$TEP3RD  EQU   $FLAG1                                                   02832000
@NM00024 EQU   $CDA+120                                                 02833000
$CUCNT   EQU   $CDA+118                                                 02834000
@NM00023 EQU   $CDA+117                                                 02835000
$OPISCNT EQU   $CDA+114                                                 02836000
$OPNDCNT EQU   $CDA+112                                                 02837000
$GETMSZE EQU   $CDA+110                                                 02838000
$GRCNTS  EQU   $CDA+108                                                 02839000
$CTLCNT  EQU   $CDA+106                                                 02840000
$ACTLVL  EQU   $CDA+105                                                 02841000
$ERRCNTA EQU   $CDA+102                                                 02842000
$TLCNT   EQU   $CDA+100                                                 02843000
$TIMEALW EQU   $CDA+96                                                  02844000
$PTRAREA EQU   $CDA+92                                                  02845000
$GETMPTR EQU   $CDA+88                                                  02846000
$R13PTRT EQU   $CDA+84                                                  02847000
$TEPEND  EQU   $CDA+76                                                  02848000
$PLINKDL EQU   $CDA+72                                                  02849000
$TEPBEGN EQU   $CDA+68                                                  02850000
$FRELPTR EQU   $CDA+64                                                  02851000
$HIGHADR EQU   $HIMOREC                                                 02852000
$LOMOREC EQU   $CDA+56                                                  02853000
$ENDCOMM EQU   $CDA+48                                                  02854000
$COMMON  EQU   $RCA                                                     02855000
$SLASHAD EQU   $CDA+32                                                  02856000
$PASSON  EQU   $CDA+28                                                  02857000
$TOLBRTB EQU   $CDA+24                                                  02858000
$SCTPTR8 EQU   $CDA+20                                                  02859000
$SCTPTR  EQU   $CDA+16                                                  02860000
$TBWDPTR EQU   $CDA+12                                                  02861000
$TFWDPTR EQU   $CDA+8                                                   02862000
@NM00022 EQU   $CDA                                                     02863000
@NM00021 EQU   $SCTTBLE+98                                              02864000
$SCTLWTC EQU   $SCTTBLE+96                                              02865000
$SCTLWTA EQU   $SCTTBLE+92                                              02866000
#EXT     EQU   $SCTTBLE+88                                              02867000
#PASS    EQU   $SCTTBLE+84                                              02868000
#TABLE   EQU   $SCTTBLE+80                                              02869000
#MSGIDAC EQU   $SCTTBLE+78                                              02870000
@NM00020 EQU   $SCTTBLE+71                                              02871000
$RETMASK EQU   $SCTTBLE+70                                              02872000
$R249255 EQU   $ROUTMSK+29                                              02873000
$R241248 EQU   $ROUTMSK+28                                              02874000
$R233240 EQU   $ROUTMSK+27                                              02875000
$R225232 EQU   $ROUTMSK+26                                              02876000
$R217224 EQU   $ROUTMSK+25                                              02877000
$R209216 EQU   $ROUTMSK+24                                              02878000
$R201208 EQU   $ROUTMSK+23                                              02879000
$R193200 EQU   $ROUTMSK+22                                              02880000
$R185192 EQU   $ROUTMSK+21                                              02881000
$R177184 EQU   $ROUTMSK+20                                              02882000
$R169176 EQU   $ROUTMSK+19                                              02883000
$R161168 EQU   $ROUTMSK+18                                              02884000
$R153160 EQU   $ROUTMSK+17                                              02885000
$R145152 EQU   $ROUTMSK+16                                              02886000
$R137144 EQU   $ROUTMSK+15                                              02887000
$R129136 EQU   $ROUTMSK+14                                              02888000
$R121128 EQU   $ROUTMSK+13                                              02889000
$R113120 EQU   $ROUTMSK+12                                              02890000
$R105112 EQU   $ROUTMSK+11                                              02891000
$R097104 EQU   $ROUTMSK+10                                              02892000
$R089096 EQU   $ROUTMSK+9                                               02893000
$R081088 EQU   $ROUTMSK+8                                               02894000
$R073080 EQU   $ROUTMSK+7                                               02895000
$R065072 EQU   $ROUTMSK+6                                               02896000
$R057064 EQU   $ROUTMSK+5                                               02897000
$R049056 EQU   $ROUTMSK+4                                               02898000
$R041048 EQU   $ROUTMSK+3                                               02899000
$R033040 EQU   $ROUTMSK+2                                               02900000
$R025032 EQU   $ROUTMSK+1                                               02901000
$R017024 EQU   $ROUTMSK                                                 02902000
$TOTFLG2 EQU   $SCTTBLE+39                                              02903000
@NM00019 EQU   $TOTFLG1                                                 02904000
@NM00018 EQU   $TOTFLG1                                                 02905000
@NM00017 EQU   $TOTFLG1                                                 02906000
$CURELOD EQU   $TOTFLG1                                                 02907000
$CTEQTT  EQU   $TOTFLG1                                                 02908000
@NM00016 EQU   $TOTFLG1                                                 02909000
@NM00015 EQU   $TOTFLG1                                                 02910000
$LINESHR EQU   $TOTFLG1                                                 02911000
@NM00014 EQU   $OLTFLG2                                                 02912000
@NM00013 EQU   $OLTFLG2                                                 02913000
@NM00012 EQU   $OLTFLG2                                                 02914000
@NM00011 EQU   $OLTFLG2                                                 02915000
@NM00010 EQU   $OLTFLG2                                                 02916000
@NM00009 EQU   $OLTFLG2                                                 02917000
@NM00008 EQU   $OLTFLG2                                                 02918000
$TALK    EQU   $OLTFLG2                                                 02919000
$DYCOM   EQU   $OLTFLGS                                                 02920000
@NM00007 EQU   $OLTFLGS                                                 02921000
$TRACE   EQU   $OLTFLGS                                                 02922000
$RETCODE EQU   $OLTFLGS                                                 02923000
$CONTCB  EQU   $OLTFLGS                                                 02924000
$RETAIN  EQU   $OLTFLGS                                                 02925000
$CLEANRT EQU   $OLTFLGS                                                 02926000
$MANINTV EQU   $OLTFLGS                                                 02927000
$OLTSIZE EQU   $SCTTBLE+34                                              02928000
$QSCTMOD EQU   $EXECFLG                                                 02929000
$CTRLMOD EQU   $EXECFLG                                                 02930000
$CLEANUP EQU   $EXECFLG                                                 02931000
$LSTPDEV EQU   $EXECFLG                                                 02932000
$ERRCNT  EQU   $EXECFLG                                                 02933000
$RTNSLCT EQU   $EXECFLG                                                 02934000
$MULTDEV EQU   $EXECFLG                                                 02935000
@NM00006 EQU   $EXECFLG                                                 02936000
$RMSKCNT EQU   $SCTTBLE+32                                              02937000
$EXTSIG  EQU   $CDS8T19+3                                               02938000
$CDFLGS  EQU   $CDS8T19+1                                               02939000
$CDSCNT  EQU   $CDS8T19                                                 02940000
$PDEVDSC EQU   $SCTTBLE+16                                              02941000
$COMMCN  EQU   $CDSFLGS                                                 02942000
$CUSTSYM EQU   $CDSFLGS                                                 02943000
$TWOCHSW EQU   $CDSFLGS                                                 02944000
$EXTINTC EQU   $CDSFLGS                                                 02945000
$CEVOL   EQU   $CDSFLGS                                                 02946000
$SHARED  EQU   $CDSFLGS                                                 02947000
$FPM     EQU   $CDSFLGS                                                 02948000
$LASTSUB EQU   $PDEVFLG                                                 02949000
@NM00005 EQU   $PDEVFLG                                                 02950000
@NM00004 EQU   $PDEVFLG                                                 02951000
@NM00003 EQU   $PDEVFLG                                                 02952000
$LASTDEV EQU   $PDEVFLG                                                 02953000
@NM00002 EQU   $PDEVFLG                                                 02954000
$EXFILPT EQU   $PDEVFLG                                                 02955000
$FPMOLD  EQU   $PDEVFLG                                                 02956000
$TSSSYM  EQU   $SCTTBLE+8                                               02957000
$SCTLEVL EQU   $SCTTBLE+7                                               02958000
$DRIVER  EQU   $SCTTBLE+6                                               02959000
$RT0916  EQU   $SCTTBLE+5                                               02960000
$RT0108  EQU   $SCTTBLE+4                                               02961000
$NOCNTRL EQU   $ERROPT                                                  02962000
$INDEFLP EQU   $TESTOPT                                                 02963000
$PARAPRT EQU   $TESTOPT                                                 02964000
@NM00001 EQU   $TESTOPT                                                 02965000
$ERRLPCT EQU   $SCTTBLE                                                 02966000
.@UNREFD ANOP                          END UNREFERENCED COMPONENTS      02967000
@RT00102 EQU   S24C0100                                                 02968000
@RF00102 EQU   S24C9990                                                 02969000
@RT00145 EQU   S24C0200                                                 02970000
@RT00178 EQU   S24C0250                                                 02971000
@RT00184 EQU   S24C0300                                                 02972000
@RT00191 EQU   S24C0252                                                 02973000
@RT00225 EQU   S24C0350                                                 02974000
@RT00240 EQU   S24C0310                                                 02975000
@RT00254 EQU   S24C0310                                                 02976000
@RT00268 EQU   S24C0400                                                 02977000
@RT00280 EQU   S24C0360                                                 02978000
@RT00318 EQU   S24C0405                                                 02979000
@RT00320 EQU   S24C0430                                                 02980000
@RT00325 EQU   S24C0445                                                 02981000
@RT00337 EQU   S24C0450                                                 02982000
@RT00339 EQU   S24C0445                                                 02983000
@RT00345 EQU   S24C0500                                                 02984000
@RT00356 EQU   S24C0550                                                 02985000
@RT00373 EQU   S24C0510                                                 02986000
@RT00384 EQU   S24C0600                                                 02987000
@RT00390 EQU   S24C0650                                                 02988000
@RT00398 EQU   S24C0700                                                 02989000
@RT00404 EQU   S24C0750                                                 02990000
@RT00412 EQU   S24C0755                                                 02991000
@RT00425 EQU   S24C0850                                                 02992000
@RF00423 EQU   S24C9999                                                 02993000
@RT00448 EQU   S24C0875                                                 02994000
@RT00452 EQU   S24C0875                                                 02995000
@RF00489 EQU   @EC00491                                                 02996000
S24C2650 EQU   @EL00003                                                 02997000
@RT00514 EQU   S24C3012                                                 02998000
@RT00527 EQU   S24C3010                                                 02999000
@RF00531 EQU   S24C3010                                                 03000000
@RT00540 EQU   S24C3005                                                 03001000
@RF00540 EQU   S24C3010                                                 03002000
@RT00544 EQU   S24C3010                                                 03003000
@RT00546 EQU   S24C3010                                                 03004000
@RT00559 EQU   S24C3003                                                 03005000
@RT00633 EQU   S24C6020                                                 03006000
@RF00633 EQU   S24C6010                                                 03007000
@RT00672 EQU   S24C7010                                                 03008000
@ENDDATA EQU   *                                                        03009000
         END   ISTSC024,(C'PLS0003',0702,79101)                         03010000
./  ADD  SSI=83341935,NAME=ISTSC025
         TITLE 'ISTSC025 - INITIAL SEND/RECEIVE INTERFACE'              00001000
*  IBM DISK OPERATING SYSTEM                                            00002000
*  TOLTEP                                                               00003000
          ISEQ 73,80                                                    00004000
ISTSC025 CSECT ,                                                   0002 00005000
@MAINENT DS    0H                                                  0002 00006000
         USING *,@15                                               0002 00007000
         B     @PROLOG                                             0002 00008000
         DC    AL2(@EP00002-@MAINENT)                                   00009000
         DC    AL1(16)                                             0002 00010000
         DC    C'ISTSC025  78.336'                                 0002 00011000
S25C2000 DS    0H                                                  0002 00012000
         USING *,@15                                               0002 00013000
         B     @PROLOG                                             0002 00014000
         DC    AL2(@EP00285-S25C2000)                                   00015000
         ENTRY S25C2000                                                 00016000
         DROP  @15                                                      00017000
@PROLOG  ST    @14,12(,@13)                                        0002 00018000
         STM   @00,@12,20(@13)                                     0002 00019000
         BALR  @12,0                                               0002 00020000
@PSTART  DS    0H                                                  0002 00021000
         USING @PSTART,@12                                         0002 00022000
         AH    @15,4(,@15)                                         0002 00023000
         BR    @15                                                 0002 00024000
@EP00002 DS    0H                                                  0003 00025000
         PRINT OFF                                                      00026000
         PRINT ON                                                       00027000
*                                                                  0110 00028000
*   /*****************************************************************/ 00029000
*   /*                                                               */ 00030000
*   /* ENTRY FROM RCM                                                */ 00031000
*   /*                                                               */ 00032000
*   /*****************************************************************/ 00033000
*                                                                  0111 00034000
*   R14=R13;                        /* CALLER SAVEAREA PTR           */ 00035000
         LR    R14,R13                                             0111 00036000
*   R13=ADDR(SVESC025);             /* PT TO MY SAVEAREA             */ 00037000
         LA    R13,SVESC025(,WAPTR)                                0112 00038000
*   BACKSAVE(3)=R13;                /* PUT MY SAVE PTR IN CALLERS    */ 00039000
         STCM  R13,15,BACKSAVE+8(R14)                              0113 00040000
*   SVESC025(2)=R14;                /* SAVE CALLER SAVE PTR          */ 00041000
         ST    R14,SVESC025+4(,WAPTR)                              0114 00042000
*   SENDPTR=R1;                     /* BASE FOR SEND PARM LIST       */ 00043000
         LR    SENDPTR,R1                                          0115 00044000
*   RFY                                                            0116 00045000
*    (R1,                                                          0116 00046000
*     R14) UNRSTD;                                                 0116 00047000
*   RFY                                                            0117 00048000
*     SENDMAP BASED(SENDPTR);       /* SET BASE                      */ 00049000
*   RFY                                                            0118 00050000
*     IFGRPL BASED(ADDR($TLTRPL3)); /* SEND-RECEIVE RPL              */ 00051000
*   RFY                                                            0119 00052000
*     CDSMAP BASED(CDSPTR);         /* BASE CDS MAP                  */ 00053000
*   IF $SENDCDS=0 THEN              /* IF CDS PTR NOT GIVEN          */ 00054000
         L     @14,$SENDCDS(,SENDPTR)                              0120 00055000
         LTR   @14,@14                                             0120 00056000
         BNZ   @RF00120                                            0120 00057000
*     CDSPTR=ADDR($PDEVADR);        /* USE PRIMARY DEVICE            */ 00058000
         LA    CDSPTR,$PDEVADR(,WAPTR)                             0121 00059000
*   ELSE                                                           0122 00060000
*     CDSPTR=$SENDCDS;              /* ELSE USE DEVICE GIVEN         */ 00061000
*                                                                  0122 00062000
         B     @RC00120                                            0122 00063000
@RF00120 L     CDSPTR,$SENDCDS(,SENDPTR)                           0122 00064000
*   /*****************************************************************/ 00065000
*   /*                                                               */ 00066000
*   /* SEARCH DEVICE TABLE TO INSURE DEVICE IS PRIMARY OR GRABBED,   */ 00067000
*   /* AND NOT LETGO, AND IS ACQUIRED                                */ 00068000
*   /*                                                               */ 00069000
*   /*****************************************************************/ 00070000
*                                                                  0123 00071000
*   DO I=3 TO $DEVCNTS;             /* SEARCH DEVICE TABLE           */ 00072000
@RC00120 LA    I,3                                                 0123 00073000
         B     @DE00123                                            0123 00074000
@DL00123 DS    0H                                                  0124 00075000
*     IF CDSSYMB=ON THEN            /* IF DEV HAS SYM NAME IN CDS    */ 00076000
         TM    CDSSYMB(CDSPTR),B'00001000'                         0124 00077000
         BNO   @RF00124                                            0124 00078000
*       DO;                                                        0125 00079000
*         IF CDSSYMBN=$$SYMNME(I)   /* MATCH                         */ 00080000
*           THEN                                                   0126 00081000
         LR    @14,I                                               0126 00082000
         MH    @14,@CH00375                                        0126 00083000
         ALR   @14,WAPTR                                           0126 00084000
         CLC   CDSSYMBN(8,CDSPTR),$$SYMNME-68(@14)                 0126 00085000
         BE    @RT00126                                            0126 00086000
*           GOTO S25C0100;          /* CHK FOR VALID DEV             */ 00087000
*         ELSE                                                     0128 00088000
*           GOTO S25C0200;          /* CHK NEXT DEV                  */ 00089000
         B     S25C0200                                            0128 00090000
*       END;                                                       0129 00091000
*     ELSE                                                         0130 00092000
*       DO;                                                        0130 00093000
@RF00124 DS    0H                                                  0131 00094000
*         IF CDSUA¬=$DEVUNAD(I)     /* DO UNIT ADDRS MATCH           */ 00095000
*           THEN                                                   0131 00096000
         LR    @14,I                                               0131 00097000
         MH    @14,@CH00375                                        0131 00098000
         L     @11,CDSUA(,CDSPTR)                                  0131 00099000
         CL    @11,$DEVUNAD-68(@14,WAPTR)                          0131 00100000
         BNE   @RT00131                                            0131 00101000
*           GOTO S25C0200;          /* NO,CHK NEXT DEVICE            */ 00102000
*       END;                                                       0133 00103000
*S25C0100:                                                         0134 00104000
*     IF $DEVLU(I)=OFF THEN         /* IF DEVICE IS NOT AN LU        */ 00105000
S25C0100 LR    @14,I                                               0134 00106000
         MH    @14,@CH00375                                        0134 00107000
         ALR   @14,WAPTR                                           0134 00108000
         TM    $DEVLU-68(@14),B'00001000'                          0134 00109000
         BNZ   @RF00134                                            0134 00110000
*       DO;                                                        0135 00111000
*         R15=4;                    /* SET ERROR RET CODE            */ 00112000
         LA    R15,4                                               0136 00113000
*         GOTO S25C9999;            /* RETURN                        */ 00114000
         B     S25C9999                                            0137 00115000
*       END;                                                       0138 00116000
*     IF($PRIMARY(I)=ON|            /* DEV MUST BE PRIMARY OR        */ 00117000
*         ($GRABBED(I)=ON&          /* GRABBED AND                   */ 00118000
*         $LETGO(I)=OFF))&          /* NOT LETGO                     */ 00119000
*         $ACQRED(I)=ON THEN        /* AND ACQUIRED                  */ 00120000
@RF00134 LR    @14,I                                               0139 00121000
         MH    @14,@CH00375                                        0139 00122000
         ST    @14,@TF00001                                        0139 00123000
         ALR   @14,WAPTR                                           0139 00124000
         TM    $PRIMARY-68(@14),B'00000001'                        0139 00125000
         BO    @GL00001                                            0139 00126000
         LR    @14,WAPTR                                           0139 00127000
         AL    @14,@TF00001                                        0139 00128000
         TM    $GRABBED-68(@14),B'00100000'                        0139 00129000
         BNO   @RF00139                                            0139 00130000
         TM    $LETGO-68(@14),B'10000000'                          0139 00131000
         BNZ   @RF00139                                            0139 00132000
@GL00001 LR    @14,I                                               0139 00133000
         MH    @14,@CH00375                                        0139 00134000
         ALR   @14,WAPTR                                           0139 00135000
         TM    $ACQRED-68(@14),B'01000000'                         0139 00136000
         BO    @RT00139                                            0139 00137000
*       GOTO S25C0300;              /* O.K. TO CONTINUE              */ 00138000
*     ELSE                                                         0141 00139000
*       GOTO S25C0250;              /* DEV DOES NOT MEET REQS        */ 00140000
         B     S25C0250                                            0141 00141000
*S25C0200:                                                         0142 00142000
*   END;                                                           0142 00143000
S25C0200 AL    I,@CF00072                                          0142 00144000
@DE00123 CH    I,$DEVCNTS(,WAPTR)                                  0142 00145000
         BNH   @DL00123                                            0142 00146000
*S25C0250:                                                         0143 00147000
*   R15=8;                          /* RETURN CODE=8                 */ 00148000
S25C0250 LA    R15,8                                               0143 00149000
*   GOTO S25C9999;                                                 0144 00150000
*                                                                  0144 00151000
         B     S25C9999                                            0144 00152000
*   /*****************************************************************/ 00153000
*   /*                                                               */ 00154000
*   /* CHECK FOR CONTROL TERMINAL = TEST TERMINAL                    */ 00155000
*   /*                                                               */ 00156000
*   /*****************************************************************/ 00157000
*                                                                  0145 00158000
*S25C0300:                                                         0145 00159000
*   $SNDRFLG=ON;                    /* TURN RCM RECALL FLAG ON       */ 00160000
S25C0300 OI    $SNDRFLG(WAPTR),B'00000100'                         0145 00161000
*   IF $CID(I)=$CID(1) THEN         /* IF CT=TT THEN                 */ 00162000
         LR    @14,I                                               0146 00163000
         MH    @14,@CH00375                                        0146 00164000
         ST    @14,@TF00001                                        0146 00165000
         ALR   @14,WAPTR                                           0146 00166000
         CLC   $CID-68(4,@14),$CID(WAPTR)                          0146 00167000
         BNE   @RF00146                                            0146 00168000
*     DO;                                                          0147 00169000
*       IF $MSGOTSD(1)¬=0|          /* API MSGS OUTSTANDING          */ 00170000
*           $CLRSNT(I)=ON THEN      /* OR CLEAR HAS BEEN SENT        */ 00171000
         L     @14,$MSGOTSD(,WAPTR)                                0148 00172000
         LTR   @14,@14                                             0148 00173000
         BNZ   @RT00148                                            0148 00174000
         LR    @14,WAPTR                                           0148 00175000
         AL    @14,@TF00001                                        0148 00176000
         TM    $CLRSNT-68(@14),B'00000010'                         0148 00177000
         BO    @RT00148                                            0148 00178000
*         GOTO S25C9999;            /* RETURN TO RCM                 */ 00179000
*       $CTLINE=0;                  /* TELL ISTCC016 SCREEN        0150 00180000
*                                      UNPREDICTABLE                 */ 00181000
         MVI   $CTLINE(WAPTR),X'00'                                0150 00182000
*     END;                                                         0151 00183000
*   IF $SRTEST(I)=OFF THEN          /* HAS A CLEAR SDT BEEN SENT     */ 00184000
@RF00146 LR    @14,I                                               0152 00185000
         MH    @14,@CH00375                                        0152 00186000
         ALR   @14,WAPTR                                           0152 00187000
         TM    $SRTEST-68(@14),B'00001000'                         0152 00188000
         BNZ   @RF00152                                            0152 00189000
*     DO;                                                          0153 00190000
*       RFY                                                        0154 00191000
*         R1 RSTD;                                                 0154 00192000
*       R1=ADDR($TLTRPL3);          /* NO,GET ADDRESS OF S-R RPL     */ 00193000
         LA    R1,$TLTRPL3(,WAPTR)                                 0155 00194000
*       CALL S25C1000;              /* ISSUE CLEAR SDT               */ 00195000
         BAL   @14,S25C1000                                        0156 00196000
*       RFY                                                        0157 00197000
*         R1 UNRSTD;                                               0157 00198000
*       GOTO S25C9999;              /* RETURN TO RCM                 */ 00199000
         B     S25C9999                                            0158 00200000
*     END;                                                         0159 00201000
*                                                                  0159 00202000
*   /*****************************************************************/ 00203000
*   /*                                                               */ 00204000
*   /* CHECK FOR PERMANENT ERROR ON CLEAR COMMAND                    */ 00205000
*   /*                                                               */ 00206000
*   /*****************************************************************/ 00207000
*                                                                  0160 00208000
*   IF $CATASTR(I)=ON THEN          /* PERMANENT ERROR ?             */ 00209000
@RF00152 LR    @14,I                                               0160 00210000
         MH    @14,@CH00375                                        0160 00211000
         ST    @14,@TF00001                                        0160 00212000
         ALR   @14,WAPTR                                           0160 00213000
         TM    $CATASTR-68(@14),B'01000000'                        0160 00214000
         BNO   @RF00160                                            0160 00215000
*     DO;                           /* YES                           */ 00216000
*       $CATASTR(I)=OFF;            /* RESET ERROR FLAG              */ 00217000
         LR    @14,WAPTR                                           0162 00218000
         AL    @14,@TF00001                                        0162 00219000
         NI    $CATASTR-68(@14),B'10111111'                        0162 00220000
*       $SNDRFLG=OFF;               /* DONT RECALL           @ZD10888*/ 00221000
         NI    $SNDRFLG(WAPTR),B'11111011'                         0163 00222000
*       R15=8;                      /* PERMANENT ERROR RET CODE      */ 00223000
         LA    R15,8                                               0164 00224000
*       GOTO S25C9999;              /* RETURN                        */ 00225000
         B     S25C9999                                            0165 00226000
*     END;                                                         0166 00227000
*   $SNDRFLG=OFF;                   /* SET RCM RECALL FLAG OFF       */ 00228000
*                                                                  0167 00229000
@RF00160 NI    $SNDRFLG(WAPTR),B'11111011'                         0167 00230000
*   /*****************************************************************/ 00231000
*   /*                                                               */ 00232000
*   /* HAS API SEND A MSG DURING TEST MODE                           */ 00233000
*   /*                                                               */ 00234000
*   /*****************************************************************/ 00235000
*                                                                  0168 00236000
*   IF $OLTERR(I)=ON THEN           /* HAS API SENT A MSG            */ 00237000
         LR    @14,I                                               0168 00238000
         MH    @14,@CH00375                                        0168 00239000
         ST    @14,@TF00001                                        0168 00240000
         ALR   @14,WAPTR                                           0168 00241000
         TM    $OLTERR-68(@14),B'00000100'                         0168 00242000
         BNO   @RF00168                                            0168 00243000
*     DO;                           /* YES,BRACKETING MAY BE UPSET   */ 00244000
*       $OLTERR(I)=OFF;             /* RESET FLAG                    */ 00245000
         LR    @14,WAPTR                                           0170 00246000
         AL    @14,@TF00001                                        0170 00247000
         NI    $OLTERR-68(@14),B'11111011'                         0170 00248000
*       R15=20;                     /* RET CODE FOR OLT TO REISSUE   */ 00249000
         LA    R15,20                                              0171 00250000
*       GOTO S25C9999;                                             0172 00251000
         B     S25C9999                                            0172 00252000
*     END;                                                         0173 00253000
*                                                                  0173 00254000
*   /*****************************************************************/ 00255000
*   /*                                                               */ 00256000
*   /* DETERMINE IF THIS IS SEND OR RECEIVE REQUEST                  */ 00257000
*   /*                                                               */ 00258000
*   /*****************************************************************/ 00259000
*                                                                  0174 00260000
*   IF $SENDMID='33' THEN           /* RECEIVE REQUEST               */ 00261000
@RF00168 CLC   $SENDMID(2,SENDPTR),@CC01361                        0174 00262000
         BNE   @RF00174                                            0174 00263000
*     DO;                           /* YES                           */ 00264000
*       RFY                                                        0176 00265000
*        (R1,                                                      0176 00266000
*         R3) RSTD;                                                0176 00267000
*       R3=I;                       /* DEVICE TABLE INDEX            */ 00268000
         LR    R3,I                                                0177 00269000
*       R1=SENDPTR;                 /* PARM LIST PTR                 */ 00270000
         LR    R1,SENDPTR                                          0178 00271000
*       CALL ISTSC033;              /* CALL RECEIVE                  */ 00272000
         L     @15,@CV01362                                        0179 00273000
         BALR  @14,@15                                             0179 00274000
*       RFY                                                        0180 00275000
*        (R1,                                                      0180 00276000
*         R3) UNRSTD;                                              0180 00277000
*       GOTO S25C9999;              /* RETURN TO RCM                 */ 00278000
         B     S25C9999                                            0181 00279000
*     END;                                                         0182 00280000
*                                                                  0182 00281000
*   /*****************************************************************/ 00282000
*   /*                                                               */ 00283000
*   /* PROCESS SEND REQUEST                                          */ 00284000
*   /*                                                               */ 00285000
*   /*****************************************************************/ 00286000
*                                                                  0183 00287000
*   TCBSNCNT=9;                     /* NUMBER OF SENSE FIELD         */ 00288000
@RF00174 LA    TCBSNCNT,9                                          0183 00289000
*   $INBUFR(1:TECBDLEN)=TECBDFLT(1:TECBDLEN);/* MOVE DEFLT TECB      */ 00290000
         L     @14,TECBDLEN                                        0184 00291000
         BCTR  @14,0                                               0184 00292000
         EX    @14,@SM01396                                        0184 00293000
*   IF $SENDTCB¬=0 THEN             /* OLT SPECIFY TECB              */ 00294000
         L     @14,$SENDTCB(,SENDPTR)                              0185 00295000
         LTR   @14,@14                                             0185 00296000
         BZ    @RF00185                                            0185 00297000
*     DO;                                                          0186 00298000
*       RFY                                                        0187 00299000
*         TECBMAPS BASED($SENDTCB); /* POINT TO OLT'S TECB           */ 00300000
*       IF TECBSNCT¬=0&             /* IF SENSE FIELD COUNT          */ 00301000
*           TECBSNOC¬=0 THEN        /* AND SENSES OCCURRED¬=0        */ 00302000
         CLI   TECBSNCT(@14),0                                     0188 00303000
         BE    @RF00188                                            0188 00304000
         CLI   TECBSNOC(@14),0                                     0188 00305000
         BE    @RF00188                                            0188 00306000
*         DO;                                                      0189 00307000
*           $INBUFR(1:15)=TCBSENSE(1:25);/* THEN MOVE IN OLT SNS     */ 00308000
         LA    @11,TECBEVT1(,@14)                                  0190 00309000
         SLR   @01,@01                                             0190 00310000
         IC    @01,TECBFDCT(,@14)                                  0190 00311000
         SLR   @08,@08                                             0190 00312000
         IC    @08,TECBFDLN(,@14)                                  0190 00313000
         MR    @00,@08                                             0190 00314000
         ALR   @11,@01                                             0190 00315000
         SLR   @08,@08                                             0190 00316000
         IC    @08,TECBSNOC(,@14)                                  0190 00317000
         MH    @08,TECBSNLN(,@14)                                  0190 00318000
         ALR   @11,@08                                             0190 00319000
         MVC   $INBUFR(15,WAPTR),TCBSENSE(@11)                     0190 00320000
*           TCBSNCNT=TECBSNCT-3;    /* AND SENSE FIELD COUNT         */ 00321000
         SLR   TCBSNCNT,TCBSNCNT                                   0191 00322000
         IC    TCBSNCNT,TECBSNCT(,@14)                             0191 00323000
         SL    TCBSNCNT,@CF00081                                   0191 00324000
*         END;                                                     0192 00325000
*     END;                                                         0193 00326000
*                                                                  0193 00327000
@RF00188 DS    0H                                                  0194 00328000
*   /*****************************************************************/ 00329000
*   /*                                                               */ 00330000
*   /* BUILD RPL FROM TECB AND PARMLIST                              */ 00331000
*   /*                                                               */ 00332000
*   /*****************************************************************/ 00333000
*                                                                  0194 00334000
*   RFY                                                            0194 00335000
*     TECBSEND BASED(ADDR($INBUFR));/* MAP INBUFR                    */ 00336000
@RF00185 DS    0H                                                  0195 00337000
*   TECBSEND(1:25)=TECBSEND(1:25)&  /* MASK OUT UNUSED BITS          */ 00338000
*       TECBMASK(1:25);             /* IN TECB                       */ 00339000
         NC    TECBSEND+2104(25,WAPTR),TECBMASK                    0195 00340000
*   RPLVTFL2=RPLVTFL2&MSKRESP;      /* MASK OUT RESPOND FLD          */ 00341000
         LA    @14,1872                                            0196 00342000
         ALR   @14,WAPTR                                           0196 00343000
         NI    RPLVTFL2(@14),X'F8'                                 0196 00344000
*   RPLRLEN=0;                      /* MASK OUT RECLEN               */ 00345000
         SLR   @11,@11                                             0197 00346000
         ST    @11,RPLRLEN+1856(,WAPTR)                            0197 00347000
*   RPLSRTYP=RPLSRTYP&MSKRTYP;      /* MASK OUT RTYPE                */ 00348000
         NI    RPLSRTYP(@14),X'71'                                 0198 00349000
*   RPLRH3=RPLRH3&MSKBRCHG;         /* MSK BRACKT,CHDIR,CDSEL        */ 00350000
         NI    RPLRH3(@14),X'07'                                   0199 00351000
*   IF $SENDBB=ON THEN              /* BEGIN BRACKET                 */ 00352000
         TM    $SENDBB(SENDPTR),B'10000000'                        0200 00353000
         BNO   @RF00200                                            0200 00354000
*     RPLBB=ON;                     /* YES SET ON IN RPL             */ 00355000
         OI    RPLBB(@14),B'10000000'                              0201 00356000
*   IF $SENDEB=ON THEN              /* END BRACKET                   */ 00357000
@RF00200 TM    $SENDEB(SENDPTR),B'01000000'                        0202 00358000
         BNO   @RF00202                                            0202 00359000
*     RPLEB=ON;                     /* YES SET ON IN RPL             */ 00360000
         OI    RPLEB+1872(WAPTR),B'01000000'                       0203 00361000
*   IF $SENDFME=OFF THEN            /* FINAL DESTINATION RESPONSE    */ 00362000
@RF00202 TM    $SENDFME(SENDPTR),B'00100000'                       0204 00363000
         BNZ   @RF00204                                            0204 00364000
*     RPLNFME=ON;                   /* NO, SET IN RPL                */ 00365000
         OI    RPLNFME+1872(WAPTR),B'00000010'                     0205 00366000
*   IF $SENDEX=ON THEN              /* EXCEPTION RESPONSE            */ 00367000
@RF00204 TM    $SENDEX(SENDPTR),B'00010000'                        0206 00368000
         BNO   @RF00206                                            0206 00369000
*     RPLEX=ON;                     /* YES, SET IN RPL               */ 00370000
         OI    RPLEX+1872(WAPTR),B'00000100'                       0207 00371000
*   IF $SENDRRN=ON THEN             /* RECOVERY EXCEPTED             */ 00372000
@RF00206 TM    $SENDRRN(SENDPTR),B'00001000'                       0208 00373000
         BNO   @RF00208                                            0208 00374000
*     RPLRRN=ON;                    /* YES, SET IN RPL               */ 00375000
         OI    RPLRRN+1872(WAPTR),B'00000001'                      0209 00376000
*   IF $SENDCSL=ON THEN             /* CODE SELECT=ALT               */ 00377000
@RF00208 TM    $SENDCSL(SENDPTR),B'00000100'                       0210 00378000
         BNO   @RF00210                                            0210 00379000
*     RPLCSI=ON;                    /* YES, SET IN RPL               */ 00380000
         OI    RPLCSI+1872(WAPTR),B'00001000'                      0211 00381000
*   IF $SENDSTP=ON THEN             /* STYPE = RESP                  */ 00382000
@RF00210 TM    $SENDSTP(SENDPTR),B'00000010'                       0212 00383000
         BNO   @RF00212                                            0212 00384000
*     RPLSRESP=ON;                  /* YES, SET IN RPL               */ 00385000
         OI    RPLSRESP+1872(WAPTR),B'10000000'                    0213 00386000
*   IF $SENDFMH=OFF THEN            /* OPTCD=FMHDR           @AX11982*/ 00387000
@RF00212 TM    $SENDFMH(SENDPTR),B'00000001'                       0214 00388000
         BNZ   @RF00214                                            0214 00389000
*     RPLFMHDR=ON;                  /* YES, SET IN RPL               */ 00390000
         OI    RPLFMHDR+1856(WAPTR),B'00000001'                    0215 00391000
*   IF $SENDCMD=OFF THEN            /* CHNG DIRECTION COMMAND      0216 00392000
*                                                            @DA04694*/ 00393000
@RF00214 TM    $SENDCMD(SENDPTR),B'10000000'                       0216 00394000
         BNZ   @RF00216                                            0216 00395000
*     RPLCMD=ON;                    /* YES, SET IN RPL               */ 00396000
         OI    RPLCMD+1872(WAPTR),B'00100000'                      0217 00397000
*   IF $SENDREQ=OFF THEN            /* REQUEST CHANGE DIRECTION    0218 00398000
*                                                            @DA04694*/ 00399000
@RF00216 TM    $SENDREQ(SENDPTR),B'01000000'                       0218 00400000
         BNZ   @RF00218                                            0218 00401000
*     RPLCHREQ=ON;                  /* YES, SET IN RPL               */ 00402000
*                                                                  0219 00403000
         OI    RPLCHREQ+1872(WAPTR),B'00010000'                    0219 00404000
*   /*****************************************************************/ 00405000
*   /*                                                               */ 00406000
*   /* DETERMINE BY TECB FIELD COUNT WHAT TO UPDATE IN RPL           */ 00407000
*   /*                                                               */ 00408000
*   /*****************************************************************/ 00409000
*                                                                  0220 00410000
*   IF TCBSNCNT>=1 THEN             /* 1 OR MORE FIELDS?             */ 00411000
@RF00218 C     TCBSNCNT,@CF00072                                   0220 00412000
         BL    @RF00220                                            0220 00413000
*     RPLSSEO=TCBSSEN;              /* YES, SYSTEM SENSE TO RPL      */ 00414000
         MVC   RPLSSEO+1856(1,WAPTR),TCBSSEN+2104(WAPTR)           0221 00415000
*   IF TCBSNCNT>=2 THEN             /* 2 OR MORE FIELDS?             */ 00416000
@RF00220 C     TCBSNCNT,@CF00139                                   0222 00417000
         BL    @RF00222                                            0222 00418000
*     RPLSSMO=TCBSSENM;             /* YES, SYS SENSE MOD TO RPL     */ 00419000
         IC    @14,TCBSSENM+2104(,WAPTR)                           0223 00420000
         STC   @14,RPLSSMO+1856(,WAPTR)                            0223 00421000
*   IF TCBSNCNT>=3 THEN             /* 3 OR MORE FIELDS?             */ 00422000
@RF00222 C     TCBSNCNT,@CF00081                                   0224 00423000
         BL    @RF00224                                            0224 00424000
*     RPLUSNSO=TCBUSEN;             /* YES, USER SENSE TO RPL        */ 00425000
         MVC   RPLUSNSO+1856(2,WAPTR),TCBUSEN+2104(WAPTR)          0225 00426000
*   IF TCBSNCNT>=8 THEN             /* 8 OR MORE FIELDS?             */ 00427000
@RF00224 C     TCBSNCNT,@CF00055                                   0226 00428000
         BL    @RF00226                                            0226 00429000
*     DO;                           /* YES                           */ 00430000
*       RPLCHN=RPLCHN&MSKCHAIN;     /* N USED FLAGS IN RPL           */ 00431000
         LA    @14,1872                                            0228 00432000
         ALR   @14,WAPTR                                           0228 00433000
         NI    RPLCHN(@14),X'0F'                                   0228 00434000
*       RPLCHN=RPLCHN|TCBCHAIN;     /* OR CHAIN FLG IN RPL           */ 00435000
         OC    RPLCHN(1,@14),TCBCHAIN+2104(WAPTR)                  0229 00436000
*     END;                                                         0230 00437000
*   IF TCBSNCNT>=9 THEN             /* 9 OR MORE FIELDS?             */ 00438000
@RF00226 C     TCBSNCNT,@CF00087                                   0231 00439000
         BL    @RF00231                                            0231 00440000
*     DO;                           /* YES                           */ 00441000
*       RPLCNTRL=RPLCNTRL&MSKCNTRL; /* N USED FLAGS IN RPL           */ 00442000
         LA    @14,1872                                            0233 00443000
         ALR   @14,WAPTR                                           0233 00444000
         NC    RPLCNTRL(3,@14),@CB01342                            0233 00445000
*       RPLCNTRL=RPLCNTRL|TCBCNTRL; /* OR CNTRL FLGS IN RPL          */ 00446000
         OC    RPLCNTRL(3,@14),TCBCNTRL+2104(WAPTR)                0234 00447000
*     END;                                                         0235 00448000
*   IF TCBSNCNT>=10 THEN            /* 10 OR MORE FIELDS             */ 00449000
@RF00231 C     TCBSNCNT,@CF01301                                   0236 00450000
         BL    @RF00236                                            0236 00451000
*     RPLSEQNO=TCBSEQNO;            /* YES, MOVE SEQ NO. TO RPL      */ 00452000
         MVC   RPLSEQNO+1916(2,WAPTR),TCBSEQNO+2104(WAPTR)         0237 00453000
*   IF TCBSNCNT>=11 THEN            /* 11 OR MORE FIELDS             */ 00454000
@RF00236 C     TCBSNCNT,@CF00783                                   0238 00455000
         BL    @RF00238                                            0238 00456000
*     RPLSIGDA=TCBSIGDA;            /* YES,MOVE SIGNAL DAT TO RPL    */ 00457000
         MVC   RPLSIGDA+1856(4,WAPTR),TCBSIGDA+2104(WAPTR)         0239 00458000
*   IF TCBSNCNT>=12 THEN            /* 12 OR MORE FIELDS             */ 00459000
@RF00238 C     TCBSNCNT,@CF00136                                   0240 00460000
         BL    @RF00240                                            0240 00461000
*     DO;                           /* YES                           */ 00462000
*       RPLIBSQ=RPLIBSQ&MSKIBSQ;    /* N IBSQ FIELD IN RPL           */ 00463000
         LA    @14,1916                                            0242 00464000
         ALR   @14,WAPTR                                           0242 00465000
         NI    RPLIBSQ(@14),X'01'                                  0242 00466000
*       RPLIBSQ=RPLIBSQ|TCBIBSQ;    /* OR ON IBSQ FLAGS IN RPL       */ 00467000
         OC    RPLIBSQ(1,@14),TCBIBSQ+2104(WAPTR)                  0243 00468000
*     END;                                                         0244 00469000
*   IF TCBSNCNT>=13 THEN            /* 13 OR MORE FIELDS             */ 00470000
@RF00240 C     TCBSNCNT,@CF00800                                   0245 00471000
         BL    @RF00245                                            0245 00472000
*     RPLIBSQV=TCBIBSQL;            /* YES,MOVE IBSQ LENGTH IN RPL   */ 00473000
         MVC   RPLIBSQV+1916(2,WAPTR),TCBIBSQL+2104(WAPTR)         0246 00474000
*   IF TCBSNCNT>=14 THEN            /* 14 OR MORE FIELDS             */ 00475000
@RF00245 C     TCBSNCNT,@CF01306                                   0247 00476000
         BL    @RF00247                                            0247 00477000
*     DO;                           /* YES                           */ 00478000
*       RPLOBSQ=RPLOBSQ&MSKOBSQ;    /* N OBSQ FIELD IN RPL           */ 00479000
         LA    @14,1916                                            0249 00480000
         ALR   @14,WAPTR                                           0249 00481000
         NI    RPLOBSQ(@14),X'01'                                  0249 00482000
*       RPLOBSQ=RPLOBSQ|TCBOBSQ;    /* OR ON OBSQ FLAGS IN RPL       */ 00483000
         OC    RPLOBSQ(1,@14),TCBOBSQ+2104(WAPTR)                  0250 00484000
*     END;                                                         0251 00485000
*   IF TCBSNCNT>=15 THEN            /* 15 FIELDS                     */ 00486000
@RF00247 C     TCBSNCNT,@CF00032                                   0252 00487000
         BL    @RF00252                                            0252 00488000
*     RPLOBSQV=TCBOBSQL;            /* MOVE OBSQ LENGTH IN RPL       */ 00489000
*                                                                  0253 00490000
         MVC   RPLOBSQV+1916(2,WAPTR),TCBOBSQL+2104(WAPTR)         0253 00491000
*   /*****************************************************************/ 00492000
*   /*                                                               */ 00493000
*   /* SETUP AND ISSUE SEND                                          */ 00494000
*   /*                                                               */ 00495000
*   /*****************************************************************/ 00496000
*                                                                  0254 00497000
*   RFY                                                            0254 00498000
*    (R1,                                                          0254 00499000
*     R4,                                                          0254 00500000
*     R5,                                                          0254 00501000
*     R6) RSTD;                                                    0254 00502000
@RF00252 DS    0H                                                  0255 00503000
*   R1=ADDR($TLTRPL3);              /* ADDR OF SND-REL RPL           */ 00504000
         LA    R1,$TLTRPL3(,WAPTR)                                 0255 00505000
*   R4=$CID(I);                     /* GET CID OF DEV FOR SEND       */ 00506000
         LR    @14,I                                               0256 00507000
         MH    @14,@CH00375                                        0256 00508000
         ALR   @14,WAPTR                                           0256 00509000
         ICM   R4,15,$CID-68(@14)                                  0256 00510000
*   R5=$SENDARA;                    /* GET DATA                      */ 00511000
         L     R5,$SENDARA(,SENDPTR)                               0257 00512000
*   R6=$SENDRLN;                    /* GET LENGTH OF DATA            */ 00513000
         LH    R6,$SENDRLN(,SENDPTR)                               0258 00514000
*   GEN;                                                           0259 00515000
         SEND  RPL=(1),ARG=(R4),AREA=(R5),RECLEN=(R6),OPTCD=SYN,       X00516000
               POST=SCHED                                               00517000
*   IF R15¬=0 THEN                  /* BAD RC FROM SEND              */ 00518000
         LTR   R15,R15                                             0260 00519000
         BZ    @RF00260                                            0260 00520000
*     DO;                           /* YES                           */ 00521000
*       R15=12;                                                    0262 00522000
         LA    R15,12                                              0262 00523000
*       GOTO S25C9999;                                             0263 00524000
         B     S25C9999                                            0263 00525000
*     END;                                                         0264 00526000
*   RFY                                                            0265 00527000
*    (R1,                                                          0265 00528000
*     R4,                                                          0265 00529000
*     R5,                                                          0265 00530000
*     R6) UNRSTD;                                                  0265 00531000
*   GOTO S25C9999;                                                 0266 00532000
*                                                                  0266 00533000
         B     S25C9999                                            0266 00534000
*   /*****************************************************************/ 00535000
*   /*                                                               */ 00536000
*   /* CLEAR START DATA TRAFFIC ROUTINE -R1 = RPL ADDRESS            */ 00537000
*   /*                                                               */ 00538000
*   /*****************************************************************/ 00539000
*                                                                  0267 00540000
*S25C1000:                                                         0267 00541000
*   PROC OPTIONS(NOSAVE,NOSAVEAREA);                               0267 00542000
S25C1000 DS    0H                                                  0268 00543000
*   RFY                                                            0268 00544000
*     R14 RSTD;                                                    0268 00545000
*   R14SAVE=R14;                    /* SAVE RETURN REG               */ 00546000
         LR    R14SAVE,R14                                         0269 00547000
*   RFY                                                            0270 00548000
*     R14 UNRSTD;                                                  0270 00549000
*   $CLRSNT(I)=ON;                  /* SET CLEAR SENT FLAG ON        */ 00550000
         LR    @14,I                                               0271 00551000
         MH    @14,@CH00375                                        0271 00552000
         ST    @14,@TF00001                                        0271 00553000
         ALR   @14,WAPTR                                           0271 00554000
         OI    $CLRSNT-68(@14),B'00000010'                         0271 00555000
*   $POSTFLG=ON;                    /* TELL RCM THERE IS AN IO     0272 00556000
*                                      OPERATION IN PROGRESS         */ 00557000
         OI    $POSTFLG(WAPTR),B'01000000'                         0272 00558000
*   R15=0;                          /* INIT REG 15                   */ 00559000
         SLR   R15,R15                                             0273 00560000
*   R0=$CID(I);                     /* GET TERM CID                  */ 00561000
         LR    @14,WAPTR                                           0274 00562000
         AL    @14,@TF00001                                        0274 00563000
         ICM   R0,15,$CID-68(@14)                                  0274 00564000
*   R1->RPLUSFLD=WAPTR;             /* SAVE WAPTR            @DM30407*/ 00565000
         ST    WAPTR,RPLUSFLD(,R1)                                 0275 00566000
*   GEN REFS(S25C3000);                                            0276 00567000
*                                       /* ISSUE CLEAR COMMAND       */ 00568000
         SESSIONC RPL=(1),EXIT=S25C3000,OPTCD=ASY,ARG=(R0),            X00569000
               CONTROL=CLEAR                                            00570000
*   IF R15=4 THEN                   /* ERROR ISSUING CLEAR           */ 00571000
         C     R15,@CF00068                                        0277 00572000
         BNE   @RF00277                                            0277 00573000
*     DO;                           /* YES                           */ 00574000
*       $SRTEST(I)=ON;              /* SET S-R TEST FLAG ON          */ 00575000
*       $CLRSNT(I)=OFF;             /* SET CLEAR SENT FLAG OFF       */ 00576000
         LR    @14,I                                               0280 00577000
         MH    @14,@CH00375                                        0280 00578000
         ALR   @14,WAPTR                                           0280 00579000
         OI    $SRTEST-68(@14),B'00001000'                         0280 00580000
         NI    $CLRSNT-68(@14),B'11111101'                         0280 00581000
*     END;                                                         0281 00582000
*   RFY                                                            0282 00583000
*     R14 RSTD;                                                    0282 00584000
@RF00277 DS    0H                                                  0283 00585000
*   R14=R14SAVE;                    /* RESTORE RETURN REG            */ 00586000
         LR    R14,R14SAVE                                         0283 00587000
*   END S25C1000;                                                  0284 00588000
*                                                                  0284 00589000
@EL00002 DS    0H                                                  0284 00590000
@EF00002 DS    0H                                                  0284 00591000
@ER00002 BR    @14                                                 0284 00592000
*   /*****************************************************************/ 00593000
*   /*                                                               */ 00594000
*   /* ENTRY FROM EXTERNAL MODULES FOR CLEAR SDT ROUTINE             */ 00595000
*   /*                                                               */ 00596000
*   /*****************************************************************/ 00597000
*                                                                  0285 00598000
*S25C2000:                                                         0285 00599000
*   ENTRY;                                                         0285 00600000
@EP00285 DS    0H                                                  0286 00601000
*   RFY                                                            0286 00602000
*    (R14,                                                         0286 00603000
*     R15) RSTD;                                                   0286 00604000
*   R14=R13;                        /* HOLD CALLER SAVEAREA PTR      */ 00605000
         LR    R14,R13                                             0287 00606000
*   R13=ADDR(SVESC025);             /* PT TO MY SAVEAREA             */ 00607000
         LA    R13,SVESC025(,WAPTR)                                0288 00608000
*   BACKSAVE(3)=R13;                /* PUT MY SAVEPTR IN CALLERS     */ 00609000
         STCM  R13,15,BACKSAVE+8(R14)                              0289 00610000
*   SVESC025(2)=R14;                /* PUT CALLER SAVE PTR IN MINE   */ 00611000
         ST    R14,SVESC025+4(,WAPTR)                              0290 00612000
*   I=$CTINDX(1);                   /* SET UP I                      */ 00613000
         LH    I,$CTINDX(,WAPTR)                                   0291 00614000
*   CALL S25C1000;                  /* CALL CLEAR SDT ROUTINE        */ 00615000
         BAL   @14,S25C1000                                        0292 00616000
*   RFY                                                            0293 00617000
*    (R14,                                                         0293 00618000
*     R15) UNRSTD;                                                 0293 00619000
*   GOTO S25C9999;                  /* RETURN                        */ 00620000
*                                                                  0294 00621000
         B     S25C9999                                            0294 00622000
*   /*****************************************************************/ 00623000
*   /*                                                               */ 00624000
*   /* RPL EXIT ROUTINE FOR CLEAR SDT,ENTRY FROM VTAM                */ 00625000
*   /*                                                               */ 00626000
*   /*****************************************************************/ 00627000
*                                                                  0295 00628000
*S25C3000:                                                         0295 00629000
*   RFY                                                            0295 00630000
*     IFGRPL BASED(R1);                                            0295 00631000
S25C3000 DS    0H                                                  0296 00632000
*   DCL                                                            0296 00633000
*     N FIXED(15);                                                 0296 00634000
*   R2=RPLUSFLD;                    /* SET UP REG 2 TO PT TO TWA     */ 00635000
         L     R2,RPLUSFLD(,R1)                                    0297 00636000
*   RESPECIFY                                                      0298 00637000
*     $RCAAREA BASED($RCA);         /* GET ADDRESSABILITY TO RCA     */ 00638000
*   RFY                                                            0299 00639000
*    (R0,                                                          0299 00640000
*     R1,                                                          0299 00641000
*     R4,                                                          0299 00642000
*     R5,                                                          0299 00643000
*     R13,                                                         0299 00644000
*     R14,                                                         0299 00645000
*     R15) RSTD;                                                   0299 00646000
*   R4=R15;                         /* SAVE ENTRY POINT              */ 00647000
         LR    R4,R15                                              0300 00648000
*   GEN(USING S25C3000,R4);         /* SET UP BASE                   */ 00649000
         USING S25C3000,R4                                              00650000
*   R5=R14;                         /* SAVE RETURN REG               */ 00651000
         LR    R5,R14                                              0302 00652000
*   RFY                                                            0303 00653000
*     R14 UNRSTD;                                                  0303 00654000
*   R13=ADDR($EXITSAV);             /* PT TO MY SAVE                 */ 00655000
         L     R13,$RCA(,WAPTR)                                    0304 00656000
         LA    R13,$EXITSAV(,R13)                                  0304 00657000
*   R15=0;                          /* INIT REG 15                   */ 00658000
         SLR   R15,R15                                             0305 00659000
*   GEN;                                                           0306 00660000
*                                       /* CHK OPERATION & DEACT RPL */ 00661000
         CHECK RPL=(R1)                                                 00662000
*   IF R0=8 THEN                    /* TEMPORARY ERROR?              */ 00663000
         C     R0,@CF00055                                         0307 00664000
         BNE   @RF00307                                            0307 00665000
*     DO;                           /* YES, RE-EXECUTE REQUEST       */ 00666000
*       GEN;                                                       0309 00667000
         EXECRPL RPL=(R1)                                               00668000
*       GOTO S25C3999;              /* RETURN TO VTAM                */ 00669000
         B     S25C3999                                            0310 00670000
*     END;                                                         0311 00671000
*                                                                  0311 00672000
*/* COMPUTE DEVTABLE INDEX                                           */ 00673000
*                                                                  0312 00674000
*   DO N=3 TO $DEVCNTS;             /* LOOP FOR INDEX                */ 00675000
@RF00307 LA    N,3                                                 0312 00676000
         B     @DE00312                                            0312 00677000
@DL00312 DS    0H                                                  0313 00678000
*     IF RPLARG=$CID(N) THEN        /* CIDS MATCH?                   */ 00679000
         LR    @14,N                                               0313 00680000
         MH    @14,@CH00375                                        0313 00681000
         L     @11,RPLARG(,R1)                                     0313 00682000
         ALR   @14,WAPTR                                           0313 00683000
         ICM   @10,15,$CID-68(@14)                                 0313 00684000
         CLR   @11,@10                                             0313 00685000
         BE    @RT00313                                            0313 00686000
*       GOTO S25C3050;              /* YES,GET OUT                   */ 00687000
*   END;                                                           0315 00688000
         AL    N,@CF00072                                          0315 00689000
@DE00312 CH    N,$DEVCNTS(,WAPTR)                                  0315 00690000
         BNH   @DL00312                                            0315 00691000
*S25C3050:                                                         0316 00692000
*   IF $SRTEST(N)=OFF THEN          /* WAS SDT LAST OPERATION?       */ 00693000
S25C3050 LR    @14,N                                               0316 00694000
         MH    @14,@CH00375                                        0316 00695000
         ST    @14,@TF00001                                        0316 00696000
         ALR   @14,WAPTR                                           0316 00697000
         TM    $SRTEST-68(@14),B'00001000'                         0316 00698000
         BNZ   @RF00316                                            0316 00699000
*     DO;                           /* NO                            */ 00700000
*       $SRTEST(N)=ON;              /* SET FLAG ON                   */ 00701000
         LR    @14,WAPTR                                           0318 00702000
         AL    @14,@TF00001                                        0318 00703000
         OI    $SRTEST-68(@14),B'00001000'                         0318 00704000
*       IF BINTS='02'X THEN                                        0319 00705000
         L     @14,@TF00001                                        0319 00706000
         LA    @14,$DEVSESP-68(@14,WAPTR)                          0319 00707000
         CLI   BINTS-1(@14),2                                      0319 00708000
         BE    @RT00319                                            0319 00709000
*         GOTO S25C3100;                                           0320 00710000
*       IF R15¬=0 THEN              /* BAD RET CODE FROM CLEAR       */ 00711000
         LTR   R15,R15                                             0321 00712000
         BZ    @RF00321                                            0321 00713000
*         DO;                       /* YES                           */ 00714000
*           $CATASTR(N)=ON;         /* SET PERMANENT ERROR ON        */ 00715000
         LR    @14,WAPTR                                           0323 00716000
         AL    @14,@TF00001                                        0323 00717000
         OI    $CATASTR-68(@14),B'01000000'                        0323 00718000
*           GOTO S25C3100;                                         0324 00719000
         B     S25C3100                                            0324 00720000
*         END;                                                     0325 00721000
*       R1->RPLUSFLD=WAPTR;         /* SAVE WAPTR            @DM30407*/ 00722000
@RF00321 ST    WAPTR,RPLUSFLD(,R1)                                 0326 00723000
*       GEN REFS(S25C3000);                                        0327 00724000
*                                      /* ISSUE START DATA TRAFFIC  */  00725000
         SESSIONC RPL=(1),EXIT=S25C3000,OPTCD=ASY,                     X00726000
               CONTROL=SDT                                              00727000
*       IF R15=0 THEN               /* ERROR ON SDT                  */ 00728000
         LTR   R15,R15                                             0328 00729000
         BZ    @RT00328                                            0328 00730000
*         GOTO S25C3999;            /* NO                            */ 00731000
*     END;                                                         0330 00732000
*S25C3100:                                                         0331 00733000
*   $CLRSNT(N)=OFF;                 /* TURN CLEAR SENT FLAG OFF      */ 00734000
@RF00316 DS    0H                                                  0331 00735000
S25C3100 LR    @14,N                                               0331 00736000
         MH    @14,@CH00375                                        0331 00737000
         ALR   @14,WAPTR                                           0331 00738000
         NI    $CLRSNT-68(@14),B'11111101'                         0331 00739000
*   $POSTFLG=OFF;                   /* TELL RCM RECEIVE IS DONE      */ 00740000
         NI    $POSTFLG(WAPTR),B'10111111'                         0332 00741000
*   R1=ADDR($TLTECB2);              /* ECB TO BE POSTED              */ 00742000
         L     R1,$RCA(,WAPTR)                                     0333 00743000
         LA    R1,$TLTECB2(,R1)                                    0333 00744000
*   CALL I00C1001;                  /* POST THE ECB                  */ 00745000
         L     @15,@CV01383                                        0334 00746000
         BALR  @14,@15                                             0334 00747000
*S25C3999:                                                         0335 00748000
*   RFY                                                            0335 00749000
*    (R13,                                                         0335 00750000
*     R14) RSTD;                                                   0335 00751000
S25C3999 DS    0H                                                  0336 00752000
*   R14=R5;                         /* RESTORE RETURN REG            */ 00753000
         LR    R14,R5                                              0336 00754000
*   GEN(BR   R14);                  /* RETURN TO VTAM                */ 00755000
         BR   R14                                                       00756000
*   GEN REFS(R4)(DROP  R4);                                        0338 00757000
         DROP  R4                                                       00758000
*S25C9999:                                                         0339 00759000
*   R13=SVESC025(2);                /* PTR TO CALLER'S SAVEAREA      */ 00760000
S25C9999 L     R13,SVESC025+4(,WAPTR)                              0339 00761000
*   END ISTSC025                                                   0340 00762000
*                                                                  0340 00763000
*/* THE FOLLOWING INCLUDE STATEMENTS WERE FOUND IN THIS PROGRAM.     */ 00764000
*/*%INCLUDE SYSLIB  (IFGRPL  )                                       */ 00765000
*/*%INCLUDE SYSLIB  (IFGRPLVT)                                       */ 00766000
*/*%INCLUDE SYSLIB  (ISTRPLFB)                                       */ 00767000
*                                                                  0340 00768000
*       ;                                                          0340 00769000
@EL00001 DS    0H                                                  0340 00770000
@EF00001 DS    0H                                                  0340 00771000
@ER00001 L     @14,12(,@13)                                        0340 00772000
         LM    @00,@12,20(@13)                                     0340 00773000
         BR    @14                                                 0340 00774000
@DATA    DS    0H                                                       00775000
@CH00375 DC    H'68'                                                    00776000
@SM01396 MVC   $INBUFR(0,WAPTR),TECBDFLT                                00777000
         DS    0F                                                       00778000
@TF00001 DS    F                                                        00779000
         DS    0F                                                       00780000
@CF00072 DC    F'1'                                                     00781000
@CF00139 DC    F'2'                                                     00782000
@CF00081 DC    F'3'                                                     00783000
@CF00068 DC    F'4'                                                     00784000
@CF00055 DC    F'8'                                                     00785000
@CF00087 DC    F'9'                                                     00786000
@CF01301 DC    F'10'                                                    00787000
@CF00783 DC    F'11'                                                    00788000
@CF00136 DC    F'12'                                                    00789000
@CF00800 DC    F'13'                                                    00790000
@CF01306 DC    F'14'                                                    00791000
@CF00032 DC    F'15'                                                    00792000
@CV01362 DC    V(ISTSC033)                                              00793000
@CV01383 DC    V(I00C1001)                                              00794000
         DS    0D                                                       00795000
RCAPTR   DS    A                                                        00796000
TECBDLEN DC    AL4(13)                                                  00797000
@CC01361 DC    C'33'                                                    00798000
@CB01342 DC    X'030F01'                                                00799000
TECBDFLT DC    X'00000000000000000010800000'                            00800000
TECBMASK DC    X'FFFFFFFF0700000EF8F0FCF0FEFFFFFFFFFFFFFEFFFFFEFFFF'    00801000
         DS    CL1                                                      00802000
S25REP   DC    40F'0'                                                   00803000
@00      EQU   00                      EQUATES FOR REGISTERS 0-15       00804000
@01      EQU   01                                                       00805000
@02      EQU   02                                                       00806000
@03      EQU   03                                                       00807000
@04      EQU   04                                                       00808000
@05      EQU   05                                                       00809000
@06      EQU   06                                                       00810000
@07      EQU   07                                                       00811000
@08      EQU   08                                                       00812000
@09      EQU   09                                                       00813000
@10      EQU   10                                                       00814000
@11      EQU   11                                                       00815000
@12      EQU   12                                                       00816000
@13      EQU   13                                                       00817000
@14      EQU   14                                                       00818000
@15      EQU   15                                                       00819000
TCBSNCNT EQU   @03                                                      00820000
I        EQU   @10                                                      00821000
CDSPTR   EQU   @03                                                      00822000
R14SAVE  EQU   @04                                                      00823000
SENDPTR  EQU   @09                                                      00824000
N        EQU   @03                                                      00825000
WAPTR    EQU   @02                                                      00826000
R0       EQU   @00                                                      00827000
R1       EQU   @01                                                      00828000
R2       EQU   @02                                                      00829000
R3       EQU   @03                                                      00830000
R4       EQU   @04                                                      00831000
R5       EQU   @05                                                      00832000
R6       EQU   @06                                                      00833000
R13      EQU   @13                                                      00834000
R14      EQU   @14                                                      00835000
R15      EQU   @15                                                      00836000
R10      EQU   @10                                                      00837000
R11      EQU   @11                                                      00838000
R12      EQU   @12                                                      00839000
R7       EQU   @07                                                      00840000
R8       EQU   @08                                                      00841000
R9       EQU   @09                                                      00842000
$RCAAREA EQU   0                                                        00843000
$POINTER EQU   $RCAAREA+100                                             00844000
$TLTECB2 EQU   $POINTER+28                                              00845000
$TRTBLA  EQU   $POINTER+124                                             00846000
$CONSTNT EQU   $RCAAREA+244                                             00847000
$RCAFLG  EQU   $RCAAREA+604                                             00848000
$EXITSAV EQU   $RCAAREA+864                                             00849000
TOLTEPWA EQU   0                                                        00850000
$SCTTBLE EQU   TOLTEPWA                                                 00851000
$TESTOPT EQU   $SCTTBLE+2                                               00852000
$ERROPT  EQU   $SCTTBLE+3                                               00853000
$PDEVFLG EQU   $SCTTBLE+10                                              00854000
$CDSFLGS EQU   $SCTTBLE+11                                              00855000
$PDEVADR EQU   $SCTTBLE+12                                              00856000
$CDS8T19 EQU   $SCTTBLE+20                                              00857000
$EXECFLG EQU   $SCTTBLE+33                                              00858000
$OLTFLGS EQU   $SCTTBLE+36                                              00859000
$OLTFLG2 EQU   $SCTTBLE+37                                              00860000
$TOTFLG1 EQU   $SCTTBLE+38                                              00861000
$ROUTMSK EQU   $SCTTBLE+40                                              00862000
$CDA     EQU   TOLTEPWA+100                                             00863000
$RCA     EQU   $CDA+44                                                  00864000
$OLTPTR  EQU   $CDA+52                                                  00865000
$HIMOREC EQU   $CDA+60                                                  00866000
$COMMFLG EQU   TOLTEPWA+224                                             00867000
$FLAG1   EQU   $COMMFLG                                                 00868000
$FLAG2   EQU   $COMMFLG+1                                               00869000
$FLAG3   EQU   $COMMFLG+2                                               00870000
$FLAG4   EQU   $COMMFLG+3                                               00871000
$FLAG5   EQU   $COMMFLG+4                                               00872000
$EOJ     EQU   $FLAG5                                                   00873000
$CANCEL  EQU   $EOJ                                                     00874000
$FLAG6   EQU   $COMMFLG+5                                               00875000
$ABNDBIT EQU   $FLAG6                                                   00876000
$FLAG7   EQU   $COMMFLG+6                                               00877000
$SNDRFLG EQU   $FLAG7                                                   00878000
$FLAG8   EQU   $COMMFLG+7                                               00879000
$FLAG9   EQU   $COMMFLG+8                                               00880000
$FLAG10  EQU   $COMMFLG+9                                               00881000
$FLAG11  EQU   $COMMFLG+10                                              00882000
$FLAG12  EQU   $COMMFLG+11                                              00883000
$POSTFLG EQU   $FLAG12                                                  00884000
$FLAG13  EQU   $COMMFLG+12                                              00885000
$DEVTBLE EQU   TOLTEPWA+240                                             00886000
$DEVCDS  EQU   $DEVTBLE                                                 00887000
$DEVUNAD EQU   $DEVCDS                                                  00888000
$CTINDX  EQU   $DEVUNAD                                                 00889000
@NM00039 EQU   $DEVUNAD+2                                               00890000
$DEVFEAT EQU   $DEVCDS+4                                                00891000
$DEVCDSF EQU   $DEVCDS+9                                                00892000
$DEVSDCF EQU   $DEVCDS+10                                               00893000
$$SYMNME EQU   $DEVCDS+12                                               00894000
$MSGOTSD EQU   $$SYMNME                                                 00895000
$DEVFLG1 EQU   $DEVTBLE+20                                              00896000
$LETGO   EQU   $DEVFLG1                                                 00897000
$CATASTR EQU   $DEVFLG1                                                 00898000
$GRABBED EQU   $DEVFLG1                                                 00899000
$EVNCPLT EQU   $DEVFLG1                                                 00900000
$ATTNEXP EQU   $DEVFLG1                                                 00901000
$INTOCC  EQU   $DEVFLG1                                                 00902000
$PRIMARY EQU   $DEVFLG1                                                 00903000
$DEVFLG2 EQU   $DEVTBLE+21                                              00904000
$DEVTECB EQU   $DEVTBLE+22                                              00905000
$OPIS    EQU   $DEVTECB                                                 00906000
$OPND    EQU   $DEVTECB+2                                               00907000
$DEVFLG3 EQU   $DEVTBLE+27                                              00908000
$ACQRED  EQU   $DEVFLG3                                                 00909000
$SIOFLG  EQU   $DEVFLG3                                                 00910000
$SRTEST  EQU   $DEVFLG3                                                 00911000
$OLTERR  EQU   $DEVFLG3                                                 00912000
$CLRSNT  EQU   $DEVFLG3                                                 00913000
$IFTOUT  EQU   $DEVTBLE+36                                              00914000
$DEVSESP EQU   $IFTOUT                                                  00915000
$SSCPDAF EQU   $IFTOUT+6                                                00916000
$LDNCBPT EQU   $DEVTBLE+48                                              00917000
$CID     EQU   $DEVTBLE+52                                              00918000
$RNINFO  EQU   $DEVTBLE+56                                              00919000
$DEVFLG5 EQU   $RNINFO+8                                                00920000
$DEVLU   EQU   $DEVFLG5                                                 00921000
$DEVFLG4 EQU   $DEVTBLE+65                                              00922000
$DEVCNTS EQU   TOLTEPWA+1464                                            00923000
$TLTRPL3 EQU   TOLTEPWA+1856                                            00924000
$INBUFR  EQU   TOLTEPWA+2104                                            00925000
#EXITA   EQU   TOLTEPWA+2632                                            00926000
$CCOMDAT EQU   TOLTEPWA+2644                                            00927000
$CFLGS   EQU   $CCOMDAT+16                                              00928000
$24FEMSG EQU   TOLTEPWA+2681                                            00929000
$24CATMG EQU   $24FEMSG+11                                              00930000
@NM00047 EQU   TOLTEPWA+2776                                            00931000
$OUNTPTR EQU   @NM00047+4                                               00932000
$NSPTR   EQU   $OUNTPTR                                                 00933000
$NSCNT   EQU   @NM00047+10                                              00934000
$ENXX    EQU   @NM00047+15                                              00935000
$IMITX   EQU   $ENXX                                                    00936000
$CTLINE  EQU   TOLTEPWA+2794                                            00937000
SVESC025 EQU   TOLTEPWA+3088                                            00938000
SVESC033 EQU   TOLTEPWA+3160                                            00939000
SVECC013 EQU   TOLTEPWA+3232                                            00940000
SVEIC003 EQU   TOLTEPWA+3592                                            00941000
SVESC022 EQU   TOLTEPWA+3736                                            00942000
SVECC011 EQU   TOLTEPWA+4024                                            00943000
TECBMAPS EQU   0                                                        00944000
TECBFDCT EQU   TECBMAPS                                                 00945000
TECBFDLN EQU   TECBMAPS+1                                               00946000
TECBSNLN EQU   TECBMAPS+2                                               00947000
TECBFLGS EQU   TECBMAPS+4                                               00948000
TECBSNCT EQU   TECBMAPS+5                                               00949000
TECBSNOC EQU   TECBMAPS+6                                               00950000
TECBEVOC EQU   TECBMAPS+7                                               00951000
TECBEVT1 EQU   TECBMAPS+8                                               00952000
TECBFD01 EQU   0                                                        00953000
@NM00051 EQU   TECBFD01+4                                               00954000
TECBSNS1 EQU   0                                                        00955000
TCBSENSE EQU   TECBSNS1+3                                               00956000
TECBSEND EQU   0                                                        00957000
TCBSSEN  EQU   TECBSEND                                                 00958000
TCBSSENM EQU   TECBSEND+1                                               00959000
TCBUSEN  EQU   TECBSEND+2                                               00960000
TCBRESP  EQU   TECBSEND+4                                               00961000
TCBRTYPE EQU   TECBSEND+7                                               00962000
TCBRKCHG EQU   TECBSEND+8                                               00963000
TCBCHAIN EQU   TECBSEND+9                                               00964000
TCBCNTRL EQU   TECBSEND+10                                              00965000
TCBSEQNO EQU   TECBSEND+13                                              00966000
TCBSIGDA EQU   TECBSEND+15                                              00967000
TCBIBSQ  EQU   TECBSEND+19                                              00968000
TCBIBSQL EQU   TECBSEND+20                                              00969000
TCBOBSQ  EQU   TECBSEND+22                                              00970000
TCBOBSQL EQU   TECBSEND+23                                              00971000
CDSMAP   EQU   0                                                        00972000
CDSUA    EQU   CDSMAP                                                   00973000
CDSMFCT  EQU   CDSMAP+4                                                 00974000
CDSFEAT  EQU   CDSMFCT+1                                                00975000
CDSFLAG  EQU   CDSMAP+9                                                 00976000
CDSSYMB  EQU   CDSFLAG                                                  00977000
CDSSYMBN EQU   CDSMAP+12                                                00978000
SENDMAP  EQU   0                                                        00979000
$SENDMID EQU   SENDMAP+2                                                00980000
$SENDTCB EQU   SENDMAP+4                                                00981000
$SENDCDS EQU   SENDMAP+8                                                00982000
$SENDARA EQU   SENDMAP+12                                               00983000
$SENDRLN EQU   SENDMAP+16                                               00984000
$SENDFLG EQU   SENDMAP+18                                               00985000
$SENDBB  EQU   $SENDFLG                                                 00986000
$SENDEB  EQU   $SENDFLG                                                 00987000
$SENDFME EQU   $SENDFLG                                                 00988000
$SENDEX  EQU   $SENDFLG                                                 00989000
$SENDRRN EQU   $SENDFLG                                                 00990000
$SENDCSL EQU   $SENDFLG                                                 00991000
$SENDSTP EQU   $SENDFLG                                                 00992000
$SENDFMH EQU   $SENDFLG                                                 00993000
$SENDCMD EQU   $SENDFLG+1                                               00994000
$SENDREQ EQU   $SENDFLG+1                                               00995000
ISTBIND  EQU   0                                                        00996000
BINFMTY  EQU   ISTBIND                                                  00997000
BINTS    EQU   ISTBIND+2                                                00998000
BINPRIP  EQU   ISTBIND+3                                                00999000
BINSECP  EQU   ISTBIND+4                                                01000000
BINCMNP  EQU   ISTBIND+5                                                01001000
BINCMNP2 EQU   ISTBIND+6                                                01002000
BINTSU   EQU   ISTBIND+7                                                01003000
BINAPACE EQU   BINTSU                                                   01004000
BINRPACE EQU   BINTSU+1                                                 01005000
BINRUSZ  EQU   BINTSU+2                                                 01006000
BINSRUSZ EQU   BINRUSZ                                                  01007000
BINPRUSZ EQU   BINRUSZ+1                                                01008000
BINSPACE EQU   BINTSU+4                                                 01009000
BINBPACE EQU   BINTSU+5                                                 01010000
BINPRSVC EQU   ISTBIND+13                                               01011000
BINLUP   EQU   BINPRSVC                                                 01012000
BINPSCHR EQU   BINPRSVC+1                                               01013000
BINCRYPT EQU   ISTBIND+25                                               01014000
BINCRYRL EQU   0                                                        01015000
BINCRCTL EQU   BINCRYRL                                                 01016000
BINCRPFL EQU   BINCRYRL+1                                               01017000
BINPNAU  EQU   0                                                        01018000
BINAUNML EQU   BINPNAU                                                  01019000
BINAUNM  EQU   BINPNAU+1                                                01020000
BINUSEDT EQU   0                                                        01021000
BINUSDTL EQU   BINUSEDT                                                 01022000
BINUSDTA EQU   BINUSEDT+1                                               01023000
BINURC   EQU   0                                                        01024000
BINURCL  EQU   BINURC                                                   01025000
BINURCD  EQU   BINURC+1                                                 01026000
BINSLUNM EQU   0                                                        01027000
IFGRPL   EQU   0                                                        01028000
RPLCOMN  EQU   IFGRPL                                                   01029000
RPLIDWD  EQU   RPLCOMN                                                  01030000
RPLLEN   EQU   RPLIDWD+3                                                01031000
RPLECB   EQU   RPLCOMN+8                                                01032000
RPLEXITP EQU   RPLECB                                                   01033000
RPLFDBWD EQU   RPLCOMN+12                                               01034000
RPLFDBK  EQU   RPLFDBWD+1                                               01035000
RPLRTNCD EQU   RPLFDBK                                                  01036000
RPLCNDCD EQU   RPLFDBK+1                                                01037000
RPLCMPON EQU   RPLCNDCD                                                 01038000
RPLFDB2  EQU   RPLCMPON                                                 01039000
RPLERRCD EQU   RPLCNDCD+1                                               01040000
RPLFDB3  EQU   RPLERRCD                                                 01041000
RPLKEYLE EQU   RPLCOMN+16                                               01042000
RPLARG   EQU   RPLCOMN+36                                               01043000
RPLOPTCD EQU   RPLCOMN+40                                               01044000
RPLOPT1  EQU   RPLOPTCD                                                 01045000
RPLECBSW EQU   RPLOPT1                                                  01046000
RPLOPT2  EQU   RPLOPTCD+1                                               01047000
RPLADR   EQU   RPLOPT2                                                  01048000
RPLOPT3  EQU   RPLOPTCD+2                                               01049000
RPLOPT4  EQU   RPLOPTCD+3                                               01050000
RPLNXTRP EQU   RPLCOMN+44                                               01051000
RPLRLEN  EQU   RPLCOMN+48                                               01052000
RPLOPTC2 EQU   RPLCOMN+56                                               01053000
RPLOPT5  EQU   RPLOPTC2                                                 01054000
RPLWRTYP EQU   RPLOPT5                                                  01055000
RPLOPT6  EQU   RPLOPTC2+1                                               01056000
RPLUNTYP EQU   RPLOPT6                                                  01057000
RPLOPT7  EQU   RPLOPTC2+2                                               01058000
RPLCNOPT EQU   RPLOPT7                                                  01059000
RPLOPT8  EQU   RPLOPTC2+3                                               01060000
RPLRBAR  EQU   RPLCOMN+60                                               01061000
RPLAIXID EQU   RPLRBAR+2                                                01062000
RPLEXTDS EQU   RPLCOMN+68                                               01063000
RPLEXTD1 EQU   RPLEXTDS                                                 01064000
RPLVTEXT EQU   IFGRPL+76                                                01065000
RPLFDBK2 EQU   RPLVTEXT+12                                              01066000
RPLSSNSI EQU   RPLFDBK2                                                 01067000
RPLDSB   EQU   RPLSSNSI                                                 01068000
RPLDSB1  EQU   RPLDSB                                                   01069000
RPLSSEI  EQU   RPLDSB1                                                  01070000
RPLDSB2  EQU   RPLDSB+1                                                 01071000
RPLUSNSI EQU   RPLFDBK2+2                                               01072000
RPLUSFLD EQU   RPLVTEXT+16                                              01073000
RPLOPTC3 EQU   RPLVTEXT+20                                              01074000
RPLOPT9  EQU   RPLOPTC3                                                 01075000
RPLOPT10 EQU   RPLOPTC3+1                                               01076000
RPLOPT11 EQU   RPLOPTC3+2                                               01077000
RPLOPT12 EQU   RPLOPTC3+3                                               01078000
RPLFMHDR EQU   RPLOPT12                                                 01079000
RPLOSENS EQU   RPLVTEXT+24                                              01080000
RPLSSNSO EQU   RPLOSENS                                                 01081000
RPLSSEO  EQU   RPLSSNSO                                                 01082000
RPLSSMO  EQU   RPLSSNSO+1                                               01083000
RPLUSNSO EQU   RPLOSENS+2                                               01084000
RPLSIGDA EQU   RPLVTEXT+32                                              01085000
RPLOF16  EQU   0                                                        01086000
RPLRH3   EQU   RPLOF16                                                  01087000
RPLBB    EQU   RPLRH3                                                   01088000
RPLEB    EQU   RPLRH3                                                   01089000
RPLCMD   EQU   RPLRH3                                                   01090000
RPLCHREQ EQU   RPLRH3                                                   01091000
RPLCSI   EQU   RPLRH3                                                   01092000
RPLSRTYP EQU   RPLOF16+1                                                01093000
RPLSTYPE EQU   RPLSRTYP                                                 01094000
RPLSRESP EQU   RPLSTYPE                                                 01095000
RPLRTYPE EQU   RPLSRTYP                                                 01096000
RPLCHN   EQU   RPLOF16+2                                                01097000
RPLVTFL1 EQU   RPLOF16+3                                                01098000
RPLVTFL2 EQU   RPLOF16+4                                                01099000
RPLPOSTV EQU   RPLVTFL2                                                 01100000
RPLRESP  EQU   RPLVTFL2                                                 01101000
RPLEX    EQU   RPLRESP                                                  01102000
RPLNFME  EQU   RPLRESP                                                  01103000
RPLRRN   EQU   RPLRESP                                                  01104000
RPLCNTRL EQU   RPLOF16+5                                                01105000
RPLCNTDF EQU   RPLCNTRL                                                 01106000
RPLCNTDC EQU   RPLCNTRL+1                                               01107000
RPLCNTSC EQU   RPLCNTRL+2                                               01108000
RPLOF60  EQU   0                                                        01109000
RPLOBSQV EQU   RPLOF60                                                  01110000
RPLIBSQV EQU   RPLOF60+2                                                01111000
RPLOBSQ  EQU   RPLOF60+4                                                01112000
RPLIBSQ  EQU   RPLOF60+5                                                01113000
RPLSEQNO EQU   RPLOF60+6                                                01114000
BACKSAVE EQU   0                                                        01115000
$TRTBL   EQU   0                                                        01116000
#EXIT    EQU   0                                                        01117000
ISTRPL   EQU   0                                                        01118000
BINLUP1  EQU   BINPSCHR                                                 01119000
BINLUS   EQU   BINPSCHR                                                 01120000
BINFMF1  EQU   BINLUS                                                   01121000
@NM00068 EQU   BINFMF1                                                  01122000
BINDSPF1 EQU   BINLUS+2                                                 01123000
BINMEDIA EQU   BINLUS+4                                                 01124000
BINLUP2  EQU   BINPSCHR                                                 01125000
BINSCRSZ EQU   BINLUP2+5                                                01126000
BINLUP3  EQU   BINPSCHR                                                 01127000
BINBFRSZ EQU   BINLUP3+5                                                01128000
BINBDESC EQU   BINLUP3+9                                                01129000
BINLUP4  EQU   BINPSCHR                                                 01130000
BINPSNDO EQU   BINLUP4                                                  01131000
BINPDSPP EQU   BINPSNDO                                                 01132000
BINADSPP EQU   BINPSNDO+1                                               01133000
BINFMHUP EQU   BINPSNDO+3                                               01134000
BINSSNDO EQU   BINLUP4+4                                                01135000
BINCSO   EQU   BINLUP4+8                                                01136000
BINCSOR  EQU   BINCSO                                                   01137000
BINGENCO EQU   BINLUP4+9                                                01138000
SVECC012 EQU   SVESC022                                                 01139000
SVEIC00A EQU   SVEIC003                                                 01140000
SVEIC004 EQU   SVEIC003                                                 01141000
SVEIC005 EQU   SVEIC003                                                 01142000
SVESC02A EQU   SVESC022                                                 01143000
SVESC02B EQU   SVESC022                                                 01144000
SVESC02D EQU   SVESC022                                                 01145000
SVESC02E EQU   SVESC022                                                 01146000
SVESC02F EQU   SVECC013                                                 01147000
SVESC024 EQU   SVESC022                                                 01148000
SVESC027 EQU   SVESC022                                                 01149000
SVESC029 EQU   SVESC033                                                 01150000
SVESC031 EQU   SVECC013                                                 01151000
SVESC032 EQU   SVECC011                                                 01152000
SVETC037 EQU   SVEIC003                                                 01153000
         AGO   .@UNREFD                START UNREFERENCED COMPONENTS    01154000
BINRSV35 EQU   BINLUP4+10                                               01155000
BINRVS34 EQU   BINGENCO                                                 01156000
BINAAO   EQU   BINGENCO                                                 01157000
BINIAO   EQU   BINGENCO                                                 01158000
BINRSV33 EQU   BINGENCO                                                 01159000
BINWSDF  EQU   BINGENCO                                                 01160000
BINRSV32 EQU   BINGENCO                                                 01161000
BINCSOC2 EQU   BINCSO                                                   01162000
BINCSOC1 EQU   BINCSO                                                   01163000
BINRSV31 EQU   BINCSOR                                                  01164000
BINRSV30 EQU   BINCSOR                                                  01165000
BINCSOAI EQU   BINCSOR                                                  01166000
BINCSOE  EQU   BINCSOR                                                  01167000
BINFMHUS EQU   BINSSNDO+3                                               01168000
BINCSLS  EQU   BINSSNDO+2                                               01169000
BINADSPS EQU   BINSSNDO+1                                               01170000
BINPDSPS EQU   BINSSNDO                                                 01171000
BINKIXS  EQU   BINFMHUP                                                 01172000
BINQFDO  EQU   BINFMHUP                                                 01173000
BINWPFMO EQU   BINFMHUP                                                 01174000
BINPDIRO EQU   BINFMHUP                                                 01175000
BINCOMPO EQU   BINFMHUP                                                 01176000
BINDSSTO EQU   BINFMHUP                                                 01177000
BINSSDAT EQU   BINFMHUP                                                 01178000
BINCSLP  EQU   BINPSNDO+2                                               01179000
BINRSV29 EQU   BINADSPP                                                 01180000
BINADSRF EQU   BINADSPP                                                 01181000
BINADSSF EQU   BINADSPP                                                 01182000
BINADSBE EQU   BINADSPP                                                 01183000
BINADSEC EQU   BINADSPP                                                 01184000
BINADSCD EQU   BINADSPP                                                 01185000
BINADSEP EQU   BINADSPP                                                 01186000
BINPEP   EQU   BINPDSPP                                                 01187000
BINDPP   EQU   BINPDSPP                                                 01188000
BINRSV28 EQU   BINPDSPP                                                 01189000
@NM00079 EQU   BINLUP3+10                                               01190000
BINBFSIZ EQU   BINBDESC                                                 01191000
@NM00078 EQU   BINBDESC                                                 01192000
BINBDRAC EQU   BINBFRSZ+3                                               01193000
BINBFRAR EQU   BINBFRSZ+2                                               01194000
BINBFRDC EQU   BINBFRSZ+1                                               01195000
BINBFRDR EQU   BINBFRSZ                                                 01196000
@NM00077 EQU   BINLUP3                                                  01197000
@NM00076 EQU   BINLUP2+10                                               01198000
BINPRESZ EQU   BINLUP2+9                                                01199000
BINSALTC EQU   BINSCRSZ+3                                               01200000
BINSALTR EQU   BINSCRSZ+2                                               01201000
BINSPRIC EQU   BINSCRSZ+1                                               01202000
BINSPRIR EQU   BINSCRSZ                                                 01203000
@NM00075 EQU   BINLUP2+1                                                01204000
@NM00074 EQU   BINLUP2                                                  01205000
BINSEDS  EQU   BINLUP2                                                  01206000
@NM00073 EQU   BINMEDIA                                                 01207000
BINCDEDS EQU   BINMEDIA                                                 01208000
BINXDOCF EQU   BINMEDIA                                                 01209000
BINXCDF  EQU   BINMEDIA                                                 01210000
BINDISK  EQU   BINMEDIA                                                 01211000
BINXCHNG EQU   BINMEDIA                                                 01212000
BINCARD  EQU   BINMEDIA                                                 01213000
BINDOCMT EQU   BINMEDIA                                                 01214000
@NM00072 EQU   BINDSPF1+1                                               01215000
BINUAALT EQU   BINDSPF1+1                                               01216000
BINUAINT EQU   BINDSPF1+1                                               01217000
BINTRNDS EQU   BINDSPF1                                                 01218000
@NM00071 EQU   BINDSPF1                                                 01219000
BINSLD   EQU   BINDSPF1                                                 01220000
BINVSDS  EQU   BINDSPF1                                                 01221000
BINVTDS  EQU   BINDSPF1                                                 01222000
BINHFDS  EQU   BINDSPF1                                                 01223000
BININTR  EQU   BINDSPF1                                                 01224000
@NM00070 EQU   @NM00068+1                                               01225000
BINXFPD  EQU   @NM00068+1                                               01226000
BINCSDS  EQU   @NM00068+1                                               01227000
BINQDSI  EQU   @NM00068+1                                               01228000
@NM00069 EQU   @NM00068+1                                               01229000
BINARRR  EQU   @NM00068                                                 01230000
BINSIDS  EQU   @NM00068                                                 01231000
BINSAI   EQU   @NM00068                                                 01232000
BINSDSI  EQU   @NM00068                                                 01233000
BINKDDSI EQU   @NM00068                                                 01234000
BINPDIR  EQU   BINFMF1                                                  01235000
BINCMPCT EQU   BINFMF1                                                  01236000
BINDESTS EQU   BINFMF1                                                  01237000
BINSLUS1 EQU   BINLUP1+6                                                01238000
BINPLUS1 EQU   BINLUP1+1                                                01239000
BINDSP1  EQU   BINLUP1                                                  01240000
BINFMHS1 EQU   BINLUP1                                                  01241000
@NM00102 EQU   RPLIBSQ                                                  01242000
RPLIINV  EQU   RPLIBSQ                                                  01243000
RPLINEG  EQU   RPLIBSQ                                                  01244000
RPLIPOS  EQU   RPLIBSQ                                                  01245000
RPLIIGN  EQU   RPLIBSQ                                                  01246000
RPLIRSET EQU   RPLIBSQ                                                  01247000
RPLITST  EQU   RPLIBSQ                                                  01248000
RPLISET  EQU   RPLIBSQ                                                  01249000
@NM00101 EQU   RPLOBSQ                                                  01250000
RPLOINV  EQU   RPLOBSQ                                                  01251000
RPLONEG  EQU   RPLOBSQ                                                  01252000
RPLOPOS  EQU   RPLOBSQ                                                  01253000
RPLOIGN  EQU   RPLOBSQ                                                  01254000
RPLORSET EQU   RPLOBSQ                                                  01255000
RPLOTST  EQU   RPLOBSQ                                                  01256000
RPLOSET  EQU   RPLOBSQ                                                  01257000
@NM00100 EQU   RPLCNTSC                                                 01258000
RPLRSHUT EQU   RPLCNTSC                                                 01259000
RPLRQR   EQU   RPLCNTSC                                                 01260000
RPLSHUTC EQU   RPLCNTSC                                                 01261000
RPLSHUTD EQU   RPLCNTSC                                                 01262000
RPLSTSN  EQU   RPLCNTSC                                                 01263000
RPLCLEAR EQU   RPLCNTSC                                                 01264000
RPLSDT   EQU   RPLCNTSC                                                 01265000
RPLBIS   EQU   RPLCNTDC                                                 01266000
RPLSBI   EQU   RPLCNTDC                                                 01267000
RPLTUNBD EQU   RPLCNTDC                                                 01268000
RPLTBIND EQU   RPLCNTDC                                                 01269000
RPLSIGNL EQU   RPLCNTDC                                                 01270000
RPLLUS   EQU   RPLCNTDC                                                 01271000
RPLRTR   EQU   RPLCNTDC                                                 01272000
RPLBID   EQU   RPLCNTDC                                                 01273000
@NM00099 EQU   RPLCNTDF                                                 01274000
RPLQI    EQU   RPLCNTDF                                                 01275000
RPLRELQ  EQU   RPLCNTDF                                                 01276000
RPLCHASE EQU   RPLCNTDF                                                 01277000
RPLQEC   EQU   RPLCNTDF                                                 01278000
RPLQC    EQU   RPLCNTDF                                                 01279000
RPLCNCEL EQU   RPLCNTDF                                                 01280000
RPLDATA  EQU   RPLCNTDF                                                 01281000
RPLQRI   EQU   RPLRESP                                                  01282000
@NM00098 EQU   RPLPOSTV                                                 01283000
RPLSCHED EQU   RPLPOSTV                                                 01284000
@NM00097 EQU   RPLVTFL1                                                 01285000
RPLTLGAC EQU   RPLVTFL1                                                 01286000
RPLTNDSP EQU   RPLVTFL1                                                 01287000
RPLAUTUS EQU   RPLVTFL1                                                 01288000
RPLVTUSE EQU   RPLVTFL1                                                 01289000
@NM00096 EQU   RPLVTFL1                                                 01290000
@NM00095 EQU   RPLCHN                                                   01291000
RPLONLY  EQU   RPLCHN                                                   01292000
RPLLAST  EQU   RPLCHN                                                   01293000
RPLMIDLE EQU   RPLCHN                                                   01294000
RPLFIRST EQU   RPLCHN                                                   01295000
@NM00094 EQU   RPLRTYPE                                                 01296000
RPLDFASY EQU   RPLRTYPE                                                 01297000
RPLNFSYN EQU   RPLRTYPE                                                 01298000
RPLRRESP EQU   RPLRTYPE                                                 01299000
@NM00093 EQU   RPLSTYPE                                                 01300000
@NM00092 EQU   RPLRH3                                                   01301000
RPLSAV13 EQU   RPLVTEXT+28                                              01302000
@NM00091 EQU   RPLSSEO                                                  01303000
RPLRRO   EQU   RPLSSEO                                                  01304000
RPLFIO   EQU   RPLSSEO                                                  01305000
RPLSTATO EQU   RPLSSEO                                                  01306000
RPLCPMO  EQU   RPLSSEO                                                  01307000
@NM00090 EQU   RPLSSEO                                                  01308000
@NM00089 EQU   RPLOPT12                                                 01309000
@NM00088 EQU   RPLOPT12                                                 01310000
@NM00087 EQU   RPLOPT12                                                 01311000
RPLNIBTK EQU   RPLOPT12                                                 01312000
RPLTRUNC EQU   RPLOPT12                                                 01313000
RPLKEEP  EQU   RPLOPT12                                                 01314000
@NM00086 EQU   RPLOPT12                                                 01315000
RPLRSVE8 EQU   RPLOPT11                                                 01316000
RPLRSVE7 EQU   RPLOPT11                                                 01317000
RPLRSVE6 EQU   RPLOPT11                                                 01318000
RPLRSVE5 EQU   RPLOPT11                                                 01319000
RPLRSVE4 EQU   RPLOPT11                                                 01320000
RPLSTOP  EQU   RPLOPT11                                                 01321000
RPLSTART EQU   RPLOPT11                                                 01322000
RPLQUIES EQU   RPLOPT11                                                 01323000
RPLRSVI6 EQU   RPLOPT10                                                 01324000
RPLRSVI5 EQU   RPLOPT10                                                 01325000
RPLRSVI4 EQU   RPLOPT10                                                 01326000
RPLRSVI3 EQU   RPLOPT10                                                 01327000
RPLTSKY  EQU   RPLOPT10                                                 01328000
RPLSPARM EQU   RPLOPT10                                                 01329000
RPLDSPLY EQU   RPLOPT10                                                 01330000
RPLBSCID EQU   RPLOPT10                                                 01331000
RPLTOPL  EQU   RPLOPT9                                                  01332000
RPLCIDE  EQU   RPLOPT9                                                  01333000
RPLRNNM  EQU   RPLOPT9                                                  01334000
RPLAPPST EQU   RPLOPT9                                                  01335000
RPLCOUNT EQU   RPLOPT9                                                  01336000
RPLTERMS EQU   RPLOPT9                                                  01337000
RPLDEVCH EQU   RPLOPT9                                                  01338000
RPLLOGON EQU   RPLOPT9                                                  01339000
RPLESR2  EQU   RPLUSNSI+1                                               01340000
RPLESR1  EQU   RPLUSNSI                                                 01341000
RPLSSMI  EQU   RPLDSB2                                                  01342000
@NM00085 EQU   RPLSSEI                                                  01343000
RPLRRI   EQU   RPLSSEI                                                  01344000
RPLFII   EQU   RPLSSEI                                                  01345000
RPLSTATI EQU   RPLSSEI                                                  01346000
RPLCPMI  EQU   RPLSSEI                                                  01347000
RPLPATHI EQU   RPLSSEI                                                  01348000
RPLARCLN EQU   RPLVTEXT+8                                               01349000
RPLAARLN EQU   RPLVTEXT+4                                               01350000
RPLAAREA EQU   RPLVTEXT                                                 01351000
RPLERMSA EQU   RPLCOMN+72                                               01352000
RPLEMLEN EQU   RPLCOMN+70                                               01353000
RPLACTIV EQU   RPLCOMN+69                                               01354000
RPLBRANC EQU   RPLEXTD1                                                 01355000
RPLNIB   EQU   RPLEXTD1                                                 01356000
RPLTCRYP EQU   RPLEXTD1                                                 01357000
@NM00084 EQU   RPLEXTD1                                                 01358000
RPLEXIT  EQU   RPLEXTD1                                                 01359000
RPLNEXIT EQU   RPLEXTD1                                                 01360000
RPLEXSCH EQU   RPLEXTD1                                                 01361000
RPLDDDD  EQU   RPLRBAR+4                                                01362000
@NM00083 EQU   RPLRBAR+3                                                01363000
@NM00082 EQU   RPLAIXID                                                 01364000
RPLAXPKP EQU   RPLAIXID                                                 01365000
RPLAIXPC EQU   RPLRBAR                                                  01366000
RPLRSV88 EQU   RPLOPT8                                                  01367000
RPLUNCON EQU   RPLOPT8                                                  01368000
RPLACTV  EQU   RPLOPT8                                                  01369000
RPLSESS  EQU   RPLOPT8                                                  01370000
RPLPEND  EQU   RPLOPT8                                                  01371000
RPLODPRM EQU   RPLOPT8                                                  01372000
RPLODACP EQU   RPLOPT8                                                  01373000
RPLODACQ EQU   RPLOPT8                                                  01374000
RPLRSV78 EQU   RPLOPT7                                                  01375000
RPLTCRNO EQU   RPLOPT7                                                  01376000
RPLRLSOP EQU   RPLOPT7                                                  01377000
RPLTPOST EQU   RPLOPT7                                                  01378000
RPLQOPT  EQU   RPLOPT7                                                  01379000
RPLCNIMM EQU   RPLCNOPT                                                 01380000
RPLCNANY EQU   RPLCNOPT                                                 01381000
RPLCNALL EQU   RPLCNOPT                                                 01382000
RPLRSV68 EQU   RPLOPT6                                                  01383000
RPLRSV67 EQU   RPLOPT6                                                  01384000
RPLLOCK  EQU   RPLOPT6                                                  01385000
RPLNCOND EQU   RPLOPT6                                                  01386000
RPLCOND  EQU   RPLOPT6                                                  01387000
RPLEOT   EQU   RPLUNTYP                                                 01388000
RPLEOM   EQU   RPLUNTYP                                                 01389000
RPLEOB   EQU   RPLUNTYP                                                 01390000
RPLWROPT EQU   RPLOPT5                                                  01391000
RPLNODE  EQU   RPLOPT5                                                  01392000
RPLERACE EQU   RPLWRTYP                                                 01393000
RPLEAU   EQU   RPLWRTYP                                                 01394000
RPLNERAS EQU   RPLWRTYP                                                 01395000
RPLPSOPT EQU   RPLOPT5                                                  01396000
@NM00081 EQU   RPLOPT5                                                  01397000
RPLDLGIN EQU   RPLOPT5                                                  01398000
RPLBUFL  EQU   RPLCOMN+52                                               01399000
RPLCHAIN EQU   RPLNXTRP                                                 01400000
@NM00080 EQU   RPLOPT4                                                  01401000
RPLMKFRM EQU   RPLOPT4                                                  01402000
RPLENDTR EQU   RPLOPT4                                                  01403000
RPLALIGN EQU   RPLOPT3                                                  01404000
RPLFMT   EQU   RPLOPT3                                                  01405000
RPLFLD   EQU   RPLOPT3                                                  01406000
RPLVFY   EQU   RPLOPT3                                                  01407000
RPLBLK   EQU   RPLOPT3                                                  01408000
RPLSFORM EQU   RPLOPT3                                                  01409000
RPLEODS  EQU   RPLOPT3                                                  01410000
RPLNSP   EQU   RPLOPT2                                                  01411000
RPLUPD   EQU   RPLOPT2                                                  01412000
RPLWAITX EQU   RPLOPT2                                                  01413000
RPLLRD   EQU   RPLOPT2                                                  01414000
RPLBWD   EQU   RPLOPT2                                                  01415000
RPLCNV   EQU   RPLOPT2                                                  01416000
RPLADD   EQU   RPLADR                                                   01417000
RPLKEY   EQU   RPLOPT2                                                  01418000
RPLECBIN EQU   RPLECBSW                                                 01419000
RPLGEN   EQU   RPLOPT1                                                  01420000
RPLKGE   EQU   RPLOPT1                                                  01421000
RPLASY   EQU   RPLOPT1                                                  01422000
RPLSKP   EQU   RPLOPT1                                                  01423000
RPLSEQ   EQU   RPLOPT1                                                  01424000
RPLDIR   EQU   RPLOPT1                                                  01425000
RPLLOC   EQU   RPLOPT1                                                  01426000
RPLDAF   EQU   RPLARG+2                                                 01427000
RPLSAF   EQU   RPLARG                                                   01428000
RPLAREA  EQU   RPLCOMN+32                                               01429000
RPLTCBPT EQU   RPLCOMN+28                                               01430000
RPLDACB  EQU   RPLCOMN+24                                               01431000
RPLCCHAR EQU   RPLCOMN+20                                               01432000
RPLSTRID EQU   RPLCOMN+18                                               01433000
RPLKEYL  EQU   RPLKEYLE                                                 01434000
RPLRDSOH EQU   RPLFDB3                                                  01435000
RPLRLG   EQU   RPLFDB3                                                  01436000
RPLLGFRC EQU   RPLFDB3                                                  01437000
RPLREOT  EQU   RPLFDB3                                                  01438000
RPLREOM  EQU   RPLFDB3                                                  01439000
RPLREOB  EQU   RPLFDB3                                                  01440000
RPLSV32  EQU   RPLFDB3                                                  01441000
RPLUINPT EQU   RPLFDB3                                                  01442000
RPLSTSAV EQU   RPLFDB2                                                  01443000
RPLCUERR EQU   RPLFDB2                                                  01444000
RPLDLGFL EQU   RPLFDB2                                                  01445000
RPLIOERR EQU   RPLFDB2                                                  01446000
RPLDVUNS EQU   RPLFDB2                                                  01447000
RPLATND  EQU   RPLFDB2                                                  01448000
RPLRVID  EQU   RPLFDB2                                                  01449000
RPLERLK  EQU   RPLFDB2                                                  01450000
RPLERREG EQU   RPLRTNCD                                                 01451000
RPLSTAT  EQU   RPLFDBWD                                                 01452000
RPLPOST  EQU   RPLEXITP                                                 01453000
RPLWAIT  EQU   RPLEXITP                                                 01454000
RPLPLHPT EQU   RPLCOMN+4                                                01455000
RPLLEN2  EQU   RPLLEN                                                   01456000
RPLREQ   EQU   RPLIDWD+2                                                01457000
RPLSTYP  EQU   RPLIDWD+1                                                01458000
RPLID    EQU   RPLIDWD                                                  01459000
BINSNMD  EQU   BINSLUNM+1                                               01460000
BINSNML  EQU   BINSLUNM                                                 01461000
BINCRKEY EQU   BINCRYRL+2                                               01462000
BINCCIPH EQU   BINCRPFL                                                 01463000
BINCRSV1 EQU   BINCRPFL                                                 01464000
BINCKEYT EQU   BINCRPFL                                                 01465000
BINCLEN  EQU   BINCRCTL                                                 01466000
BINCSESS EQU   BINCRCTL                                                 01467000
BINCEUMB EQU   BINCRCTL                                                 01468000
BINUSE   EQU   ISTBIND+36                                               01469000
BINUSEL  EQU   ISTBIND+35                                               01470000
BINPRIM  EQU   ISTBIND+27                                               01471000
BINPRIML EQU   ISTBIND+26                                               01472000
BINLUTYP EQU   BINLUP                                                   01473000
@NM00067 EQU   BINLUP                                                   01474000
BINBPACM EQU   BINBPACE                                                 01475000
@NM00066 EQU   BINBPACE                                                 01476000
BINSPACM EQU   BINSPACE                                                 01477000
@NM00065 EQU   BINSPACE                                                 01478000
BINPS1ST EQU   BINSPACE                                                 01479000
BINPRUSE EQU   BINPRUSZ                                                 01480000
BINPRUSM EQU   BINPRUSZ                                                 01481000
BINSRUSE EQU   BINSRUSZ                                                 01482000
BINSRUSM EQU   BINSRUSZ                                                 01483000
BINRPACM EQU   BINRPACE                                                 01484000
@NM00064 EQU   BINRPACE                                                 01485000
BINAPACM EQU   BINAPACE                                                 01486000
@NM00063 EQU   BINAPACE                                                 01487000
BINSP2ST EQU   BINAPACE                                                 01488000
BINCONR  EQU   BINCMNP2                                                 01489000
BINRCHN  EQU   BINCMNP2                                                 01490000
BINMDIBK EQU   BINCMNP2                                                 01491000
BINBKFS  EQU   BINCMNP2                                                 01492000
BINRCVR  EQU   BINCMNP2                                                 01493000
BINFMTRM EQU   BINCMNP2                                                 01494000
@NM00062 EQU   BINCMNP                                                  01495000
BINALT   EQU   BINCMNP                                                  01496000
BINBKTR  EQU   BINCMNP                                                  01497000
BINBRAK  EQU   BINCMNP                                                  01498000
BINFMHD  EQU   BINCMNP                                                  01499000
@NM00061 EQU   BINCMNP                                                  01500000
BINSSEB  EQU   BINSECP                                                  01501000
BINSCMP  EQU   BINSECP                                                  01502000
@NM00060 EQU   BINSECP                                                  01503000
BINSCHNR EQU   BINSECP                                                  01504000
BINSMCH  EQU   BINSECP                                                  01505000
BINSCHN  EQU   BINSECP                                                  01506000
BINPSEB  EQU   BINPRIP                                                  01507000
BINPCMP  EQU   BINPRIP                                                  01508000
@NM00059 EQU   BINPRIP                                                  01509000
BINPCHNR EQU   BINPRIP                                                  01510000
BINPMCH  EQU   BINPRIP                                                  01511000
BINPCHN  EQU   BINPRIP                                                  01512000
BINFM    EQU   ISTBIND+1                                                01513000
BINTYPE  EQU   BINFMTY                                                  01514000
BINFMT   EQU   BINFMTY                                                  01515000
@NM00058 EQU   $SENDFLG+1                                               01516000
$SENDLVL EQU   SENDMAP+1                                                01517000
$SENDCPF EQU   SENDMAP                                                  01518000
CDSEXARA EQU   CDSMAP+20                                                01519000
CDSEXTM  EQU   CDSFLAG+2                                                01520000
CDSEXTB  EQU   CDSFLAG+2                                                01521000
CDSTMERB EQU   CDSFLAG+2                                                01522000
@NM00057 EQU   CDSFLAG+1                                                01523000
CDSDVPRO EQU   CDSFLAG+1                                                01524000
CDSNTPRI EQU   CDSFLAG+1                                                01525000
CDSLINCN EQU   CDSFLAG                                                  01526000
CDSREMSY EQU   CDSFLAG                                                  01527000
CDS2CHAN EQU   CDSFLAG                                                  01528000
CDSEXTPR EQU   CDSFLAG                                                  01529000
CDSFEVOL EQU   CDSFLAG                                                  01530000
CDSSHAR  EQU   CDSFLAG                                                  01531000
CDSFPMD  EQU   CDSFLAG                                                  01532000
CDSBYTCT EQU   CDSMAP+8                                                 01533000
CDSTYPE  EQU   CDSMFCT+3                                                01534000
CDSCLASS EQU   CDSMFCT+2                                                01535000
@NM00056 EQU   CDSFEAT                                                  01536000
CDSDEVM  EQU   CDSFEAT                                                  01537000
CDSDEVT  EQU   CDSFEAT                                                  01538000
CDSASCII EQU   CDSFEAT                                                  01539000
CDSMODEL EQU   CDSMFCT                                                  01540000
@NM00055 EQU   TCBRKCHG                                                 01541000
TCBALT   EQU   TCBRKCHG                                                 01542000
TCBREQ   EQU   TCBRKCHG                                                 01543000
TCBCMD   EQU   TCBRKCHG                                                 01544000
TCBEB    EQU   TCBRKCHG                                                 01545000
TCBBB    EQU   TCBRKCHG                                                 01546000
@NM00054 EQU   TCBRTYPE                                                 01547000
TCBDFAS  EQU   TCBRTYPE                                                 01548000
TCBNDFS  EQU   TCBRTYPE                                                 01549000
TCBRSP   EQU   TCBRTYPE                                                 01550000
@NM00053 EQU   TCBRTYPE                                                 01551000
TCBRECLN EQU   TECBSEND+5                                               01552000
TCBRRN   EQU   TCBRESP                                                  01553000
TCBNFME  EQU   TCBRESP                                                  01554000
TCBEX    EQU   TCBRESP                                                  01555000
@NM00052 EQU   TCBRESP                                                  01556000
TCBSNDEV EQU   TECBSNS1                                                 01557000
TCBEVCSW EQU   @NM00051                                                 01558000
TCBEVDEV EQU   TECBFD01+1                                               01559000
TCBEVTYP EQU   TECBFD01                                                 01560000
@NM00050 EQU   TECBFLGS                                                 01561000
TCBQUEUE EQU   TECBFLGS                                                 01562000
SVECC010 EQU   TOLTEPWA+3952                                            01563000
SVETC035 EQU   TOLTEPWA+3880                                            01564000
SVESC030 EQU   TOLTEPWA+3808                                            01565000
SVESC020 EQU   TOLTEPWA+3664                                            01566000
SVEIC002 EQU   TOLTEPWA+3520                                            01567000
SVECC014 EQU   TOLTEPWA+3376                                            01568000
SVESC120 EQU   TOLTEPWA+3304                                            01569000
@NM00049 EQU   TOLTEPWA+2980                                            01570000
$RPLERR  EQU   TOLTEPWA+2977                                            01571000
@NM00048 EQU   TOLTEPWA+2976                                            01572000
$R13PR3  EQU   TOLTEPWA+2972                                            01573000
$CEINT2  EQU   TOLTEPWA+2968                                            01574000
$CEINT1  EQU   TOLTEPWA+2964                                            01575000
$MSGGET  EQU   TOLTEPWA+2960                                            01576000
$ACQLIST EQU   TOLTEPWA+2956                                            01577000
$R4SAVE1 EQU   TOLTEPWA+2952                                            01578000
$CLSISS  EQU   TOLTEPWA+2950                                            01579000
$CLSCNT  EQU   TOLTEPWA+2948                                            01580000
$CUTABLE EQU   TOLTEPWA+2868                                            01581000
$BUFSZ2  EQU   TOLTEPWA+2864                                            01582000
$RESID2  EQU   TOLTEPWA+2860                                            01583000
$OLTCCW2 EQU   TOLTEPWA+2856                                            01584000
$ENDBFR2 EQU   TOLTEPWA+2852                                            01585000
$1STBFR2 EQU   TOLTEPWA+2848                                            01586000
$TECB2   EQU   TOLTEPWA+2844                                            01587000
$BUFSZ1  EQU   TOLTEPWA+2840                                            01588000
$RESID1  EQU   TOLTEPWA+2836                                            01589000
$OLTCCW1 EQU   TOLTEPWA+2832                                            01590000
$ENDBFR1 EQU   TOLTEPWA+2828                                            01591000
$1STBFR1 EQU   TOLTEPWA+2824                                            01592000
$TECB1   EQU   TOLTEPWA+2820                                            01593000
$WAITIME EQU   TOLTEPWA+2816                                            01594000
$TRTN#   EQU   TOLTEPWA+2815                                            01595000
$WIODEV  EQU   TOLTEPWA+2814                                            01596000
$RQSTSZE EQU   TOLTEPWA+2812                                            01597000
$RQSTPTR EQU   TOLTEPWA+2808                                            01598000
$R4SAVE  EQU   TOLTEPWA+2804                                            01599000
$PARTADR EQU   TOLTEPWA+2800                                            01600000
$TBSDATA EQU   TOLTEPWA+2796                                            01601000
$CTWIDTH EQU   TOLTEPWA+2795                                            01602000
$APWIDTH EQU   TOLTEPWA+2793                                            01603000
$APLINE  EQU   TOLTEPWA+2792                                            01604000
$INDEX   EQU   $IMITX                                                   01605000
$UMXX    EQU   @NM00047+14                                              01606000
$NSXX    EQU   @NM00047+12                                              01607000
$ATACNT  EQU   $NSCNT                                                   01608000
$CTR     EQU   @NM00047+8                                               01609000
$ATAPTR  EQU   $NSPTR                                                   01610000
$DDRPTR  EQU   @NM00047                                                 01611000
$DTORESP EQU   TOLTEPWA+2712                                            01612000
$APNAME  EQU   TOLTEPWA+2704                                            01613000
$24SYMNE EQU   $24CATMG+4                                               01614000
$24DEVAD EQU   $24CATMG                                                 01615000
$24RTN#  EQU   $24FEMSG+8                                               01616000
$ESECTID EQU   $24FEMSG                                                 01617000
$24FLGS  EQU   TOLTEPWA+2680                                            01618000
$24SAVE2 EQU   TOLTEPWA+2676                                            01619000
$24SAVE1 EQU   TOLTEPWA+2672                                            01620000
$24UNADR EQU   TOLTEPWA+2668                                            01621000
$24SAV13 EQU   TOLTEPWA+2664                                            01622000
$24RETCD EQU   TOLTEPWA+2663                                            01623000
$MACID   EQU   TOLTEPWA+2661                                            01624000
$CSPARE  EQU   $CFLGS                                                   01625000
$C2WAY   EQU   $CFLGS                                                   01626000
$CINCT   EQU   $CCOMDAT+12                                              01627000
$CINADR  EQU   $CCOMDAT+8                                               01628000
$COUTCT  EQU   $CCOMDAT+4                                               01629000
$COUTAD  EQU   $CCOMDAT                                                 01630000
ROOTLOC  EQU   TOLTEPWA+2640                                            01631000
$RETREG  EQU   TOLTEPWA+2636                                            01632000
$WORK    EQU   TOLTEPWA+2376                                            01633000
$EXTA    EQU   TOLTEPWA+2320                                            01634000
$PASSONA EQU   TOLTEPWA+2264                                            01635000
$TRMINPT EQU   TOLTEPWA+2184                                            01636000
$BUFFER  EQU   TOLTEPWA+1976                                            01637000
$TLTRPL2 EQU   TOLTEPWA+1736                                            01638000
$TLTRPL1 EQU   TOLTEPWA+1616                                            01639000
$SLTBL   EQU   TOLTEPWA+1468                                            01640000
$CDEVPT  EQU   TOLTEPWA+1466                                            01641000
$FEEDBCK EQU   $DEVTBLE+66                                              01642000
$WTISUED EQU   $DEVFLG4                                                 01643000
$EXIOISD EQU   $DEVFLG4                                                 01644000
$REMWRIT EQU   $DEVFLG4                                                 01645000
$REMDONE EQU   $DEVFLG4                                                 01646000
$2NDUSED EQU   $DEVFLG4                                                 01647000
$1STUSED EQU   $DEVFLG4                                                 01648000
$IGLXIFB EQU   $DEVFLG4                                                 01649000
$EXIOLV3 EQU   $DEVFLG4                                                 01650000
@NM00046 EQU   $DEVFLG5                                                 01651000
$DVBASIC EQU   $DEVFLG5                                                 01652000
$ASCII   EQU   $DEVFLG5                                                 01653000
$OPNDFAL EQU   $DEVFLG5                                                 01654000
$ACQNCB  EQU   $DEVFLG5                                                 01655000
$REMOTE  EQU   $DEVFLG5                                                 01656000
$ENDNODE EQU   $DEVFLG5                                                 01657000
$LINENME EQU   $RNINFO                                                  01658000
$DVCOL   EQU   $LDNCBPT+2                                               01659000
$DVROW   EQU   $LDNCBPT                                                 01660000
$NCSPLP  EQU   $DEVTBLE+44                                              01661000
$DVLN    EQU   $SSCPDAF                                                 01662000
$DAF     EQU   $DEVSESP+4                                               01663000
$VARYPAB EQU   $DEVSESP                                                 01664000
$SYSMN   EQU   $DEVTBLE+28                                              01665000
@NM00045 EQU   $DEVFLG3                                                 01666000
$DVSNDOK EQU   $SIOFLG                                                  01667000
$POLLREQ EQU   $DEVFLG3                                                 01668000
$NOTDEV  EQU   $DEVFLG3                                                 01669000
$DVINCT  EQU   $DEVTBLE+26                                              01670000
$DVBRKST EQU   $OPND+1                                                  01671000
$DVBRKSN EQU   $OPND                                                    01672000
$DVSEQNO EQU   $OPIS                                                    01673000
$CEINTRP EQU   $DEVFLG2                                                 01674000
$TESTMDE EQU   $DEVFLG2                                                 01675000
$DEVALOC EQU   $DEVFLG2                                                 01676000
$ALLDATA EQU   $DEVFLG2                                                 01677000
$ENDCNTL EQU   $DEVFLG2                                                 01678000
$CTLDEV  EQU   $DEVFLG2                                                 01679000
$NOCDS   EQU   $DEVFLG2                                                 01680000
$DATAIN  EQU   $DEVFLG2                                                 01681000
$DVCTBYT EQU   $INTOCC                                                  01682000
$DEVACT  EQU   $DEVFLG1                                                 01683000
$DVLGMDE EQU   $ATTNEXP                                                 01684000
$DVSPRM  EQU   $EVNCPLT                                                 01685000
$CURELEM EQU   $$SYMNME+4                                               01686000
$EXTDEV  EQU   $DEVCDS+11                                               01687000
@NM00044 EQU   $DEVSDCF                                                 01688000
$NOTPRIM EQU   $DEVSDCF                                                 01689000
@NM00043 EQU   $DEVCDSF                                                 01690000
@NM00042 EQU   $DEVCDSF                                                 01691000
@NM00041 EQU   $DEVCDSF                                                 01692000
$CDSNAME EQU   $DEVCDSF                                                 01693000
$EXTRN   EQU   $DEVCDSF                                                 01694000
$CEVOLUM EQU   $DEVCDSF                                                 01695000
$SHARD   EQU   $DEVCDSF                                                 01696000
$DEVFPM  EQU   $DEVCDSF                                                 01697000
$DEVCNT  EQU   $DEVCDS+8                                                01698000
$DEVTYPE EQU   $DEVFEAT+3                                               01699000
$DEVCLAS EQU   $DEVFEAT+2                                               01700000
$DEVFRRS EQU   $DEVFEAT+1                                               01701000
$DEVMOD  EQU   $DEVFEAT                                                 01702000
$DEVRDGT EQU   @NM00039+1                                               01703000
$DEVCTLU EQU   @NM00039+1                                               01704000
$DEVCHAN EQU   @NM00039                                                 01705000
@NM00040 EQU   @NM00039                                                 01706000
$FLAG16  EQU   $COMMFLG+15                                              01707000
$FLAG15  EQU   $COMMFLG+14                                              01708000
$FLAG14  EQU   $COMMFLG+13                                              01709000
$TEP2ND  EQU   $FLAG13                                                  01710000
$TEP1ST  EQU   $FLAG13                                                  01711000
$CATMSG  EQU   $FLAG13                                                  01712000
$PRMPTSW EQU   $FLAG13                                                  01713000
$DEVENT  EQU   $FLAG13                                                  01714000
$OLTMACC EQU   $FLAG13                                                  01715000
$LGON    EQU   $FLAG13                                                  01716000
$CTLOGON EQU   $FLAG13                                                  01717000
@NM00038 EQU   $FLAG12                                                  01718000
$VARYINP EQU   $FLAG12                                                  01719000
$ENDTEST EQU   $FLAG12                                                  01720000
$VRYHRD  EQU   $FLAG12                                                  01721000
$VRYSFT  EQU   $FLAG12                                                  01722000
$OPTMSG  EQU   $FLAG12                                                  01723000
$FEORCAT EQU   $FLAG11                                                  01724000
@NM00037 EQU   $FLAG11                                                  01725000
@NM00036 EQU   $FLAG10                                                  01726000
$INBND   EQU   $FLAG10                                                  01727000
$WAITFLG EQU   $FLAG10                                                  01728000
$DPRINT  EQU   $FLAG10                                                  01729000
$HOLD    EQU   $FLAG9                                                   01730000
$NOTRRCH EQU   $FLAG9                                                   01731000
@NM00035 EQU   $FLAG9                                                   01732000
$COPY    EQU   $FLAG9                                                   01733000
$LSTLNSW EQU   $FLAG9                                                   01734000
$MULLNSW EQU   $FLAG9                                                   01735000
$REMSW   EQU   $FLAG9                                                   01736000
$IGRES   EQU   $FLAG9                                                   01737000
$TCECM   EQU   $FLAG8                                                   01738000
$VS2     EQU   $FLAG8                                                   01739000
$VS1     EQU   $FLAG8                                                   01740000
$EDOS    EQU   $FLAG8                                                   01741000
@NM00034 EQU   $FLAG8                                                   01742000
$TWOWAY  EQU   $FLAG8                                                   01743000
@NM00033 EQU   $FLAG8                                                   01744000
$RCVMSG  EQU   $FLAG7                                                   01745000
$RCVRFLG EQU   $FLAG7                                                   01746000
$LDOIS   EQU   $FLAG7                                                   01747000
$DCONTCT EQU   $FLAG7                                                   01748000
$EXIOWAT EQU   $FLAG7                                                   01749000
$2NDDATA EQU   $FLAG7                                                   01750000
$1STDATA EQU   $FLAG7                                                   01751000
$CIREQ   EQU   $FLAG6                                                   01752000
$ABTERM  EQU   $ABNDBIT                                                 01753000
$FSTMCIS EQU   $FLAG6                                                   01754000
$DISCREQ EQU   $FLAG6                                                   01755000
$DISCISS EQU   $FLAG6                                                   01756000
$CHANGE  EQU   $FLAG6                                                   01757000
$CTERROR EQU   $FLAG6                                                   01758000
$RECAL11 EQU   $FLAG6                                                   01759000
@NM00032 EQU   $FLAG5                                                   01760000
$PROGCK  EQU   $CANCEL                                                  01761000
$PRINTAP EQU   $FLAG5                                                   01762000
@NM00031 EQU   $FLAG5                                                   01763000
$MSG922  EQU   $FLAG5                                                   01764000
$CT924   EQU   $FLAG5                                                   01765000
$FSTCAT  EQU   $FLAG5                                                   01766000
$FSTFE   EQU   $FLAG5                                                   01767000
$ACTOPND EQU   $FLAG4                                                   01768000
$ACQCUTT EQU   $FLAG4                                                   01769000
$CLSSACT EQU   $FLAG4                                                   01770000
$BACKINT EQU   $FLAG4                                                   01771000
$DMSGSW  EQU   $FLAG4                                                   01772000
$TSTDEVP EQU   $FLAG4                                                   01773000
$APRQPER EQU   $FLAG4                                                   01774000
$OPCOM   EQU   $FLAG4                                                   01775000
$NEWAP   EQU   $FLAG3                                                   01776000
$ALTPRTR EQU   $FLAG3                                                   01777000
$OPTERR  EQU   $FLAG3                                                   01778000
$PRTONLY EQU   $FLAG3                                                   01779000
$REQSTOR EQU   $FLAG3                                                   01780000
$LOGOFFE EQU   $FLAG3                                                   01781000
$TSTERR  EQU   $FLAG3                                                   01782000
$DEVERR  EQU   $FLAG3                                                   01783000
$PARTIAL EQU   $FLAG2                                                   01784000
$NRMTERM EQU   $FLAG2                                                   01785000
$VALDTST EQU   $FLAG2                                                   01786000
$VALDDEV EQU   $FLAG2                                                   01787000
$DBLSLSH EQU   $FLAG2                                                   01788000
$NDR     EQU   $FLAG2                                                   01789000
@NM00030 EQU   $FLAG2                                                   01790000
$OLTACT  EQU   $FLAG1                                                   01791000
$NORELDV EQU   $FLAG1                                                   01792000
@NM00029 EQU   $FLAG1                                                   01793000
$OPTCHNG EQU   $FLAG1                                                   01794000
$DEVCHNG EQU   $FLAG1                                                   01795000
$TESTCNG EQU   $FLAG1                                                   01796000
$CNSLFG  EQU   $FLAG1                                                   01797000
$TEP3RD  EQU   $FLAG1                                                   01798000
@NM00028 EQU   $CDA+120                                                 01799000
$CUCNT   EQU   $CDA+118                                                 01800000
@NM00027 EQU   $CDA+117                                                 01801000
$PRTFORM EQU   $CDA+116                                                 01802000
$OPISCNT EQU   $CDA+114                                                 01803000
$OPNDCNT EQU   $CDA+112                                                 01804000
$GETMSZE EQU   $CDA+110                                                 01805000
$GRCNTS  EQU   $CDA+108                                                 01806000
$CTLCNT  EQU   $CDA+106                                                 01807000
$ACTLVL  EQU   $CDA+105                                                 01808000
$PRNTLVL EQU   $CDA+104                                                 01809000
$ERRCNTA EQU   $CDA+102                                                 01810000
$TLCNT   EQU   $CDA+100                                                 01811000
$TIMEALW EQU   $CDA+96                                                  01812000
$PTRAREA EQU   $CDA+92                                                  01813000
$GETMPTR EQU   $CDA+88                                                  01814000
$R13PTRT EQU   $CDA+84                                                  01815000
$R13PTR  EQU   $CDA+80                                                  01816000
$TEPEND  EQU   $CDA+76                                                  01817000
$PLINKDL EQU   $CDA+72                                                  01818000
$TEPBEGN EQU   $CDA+68                                                  01819000
$FRELPTR EQU   $CDA+64                                                  01820000
$HIGHADR EQU   $HIMOREC                                                 01821000
$LOMOREC EQU   $CDA+56                                                  01822000
$LOWADDR EQU   $OLTPTR                                                  01823000
$ENDCOMM EQU   $CDA+48                                                  01824000
$COMMON  EQU   $RCA                                                     01825000
$SLASHAD EQU   $CDA+32                                                  01826000
$PASSON  EQU   $CDA+28                                                  01827000
$TOLBRTB EQU   $CDA+24                                                  01828000
$SCTPTR8 EQU   $CDA+20                                                  01829000
$SCTPTR  EQU   $CDA+16                                                  01830000
$TBWDPTR EQU   $CDA+12                                                  01831000
$TFWDPTR EQU   $CDA+8                                                   01832000
@NM00026 EQU   $CDA                                                     01833000
@NM00025 EQU   $SCTTBLE+98                                              01834000
$SCTLWTC EQU   $SCTTBLE+96                                              01835000
$SCTLWTA EQU   $SCTTBLE+92                                              01836000
#EXT     EQU   $SCTTBLE+88                                              01837000
#PASS    EQU   $SCTTBLE+84                                              01838000
#TABLE   EQU   $SCTTBLE+80                                              01839000
#MSGIDAC EQU   $SCTTBLE+78                                              01840000
@NM00024 EQU   $SCTTBLE+71                                              01841000
$RETMASK EQU   $SCTTBLE+70                                              01842000
$R249255 EQU   $ROUTMSK+29                                              01843000
$R241248 EQU   $ROUTMSK+28                                              01844000
$R233240 EQU   $ROUTMSK+27                                              01845000
$R225232 EQU   $ROUTMSK+26                                              01846000
$R217224 EQU   $ROUTMSK+25                                              01847000
$R209216 EQU   $ROUTMSK+24                                              01848000
$R201208 EQU   $ROUTMSK+23                                              01849000
$R193200 EQU   $ROUTMSK+22                                              01850000
$R185192 EQU   $ROUTMSK+21                                              01851000
$R177184 EQU   $ROUTMSK+20                                              01852000
$R169176 EQU   $ROUTMSK+19                                              01853000
$R161168 EQU   $ROUTMSK+18                                              01854000
$R153160 EQU   $ROUTMSK+17                                              01855000
$R145152 EQU   $ROUTMSK+16                                              01856000
$R137144 EQU   $ROUTMSK+15                                              01857000
$R129136 EQU   $ROUTMSK+14                                              01858000
$R121128 EQU   $ROUTMSK+13                                              01859000
$R113120 EQU   $ROUTMSK+12                                              01860000
$R105112 EQU   $ROUTMSK+11                                              01861000
$R097104 EQU   $ROUTMSK+10                                              01862000
$R089096 EQU   $ROUTMSK+9                                               01863000
$R081088 EQU   $ROUTMSK+8                                               01864000
$R073080 EQU   $ROUTMSK+7                                               01865000
$R065072 EQU   $ROUTMSK+6                                               01866000
$R057064 EQU   $ROUTMSK+5                                               01867000
$R049056 EQU   $ROUTMSK+4                                               01868000
$R041048 EQU   $ROUTMSK+3                                               01869000
$R033040 EQU   $ROUTMSK+2                                               01870000
$R025032 EQU   $ROUTMSK+1                                               01871000
$R017024 EQU   $ROUTMSK                                                 01872000
$TOTFLG2 EQU   $SCTTBLE+39                                              01873000
@NM00023 EQU   $TOTFLG1                                                 01874000
@NM00022 EQU   $TOTFLG1                                                 01875000
@NM00021 EQU   $TOTFLG1                                                 01876000
$CURELOD EQU   $TOTFLG1                                                 01877000
$CTEQTT  EQU   $TOTFLG1                                                 01878000
@NM00020 EQU   $TOTFLG1                                                 01879000
@NM00019 EQU   $TOTFLG1                                                 01880000
$LINESHR EQU   $TOTFLG1                                                 01881000
@NM00018 EQU   $OLTFLG2                                                 01882000
@NM00017 EQU   $OLTFLG2                                                 01883000
@NM00016 EQU   $OLTFLG2                                                 01884000
@NM00015 EQU   $OLTFLG2                                                 01885000
@NM00014 EQU   $OLTFLG2                                                 01886000
@NM00013 EQU   $OLTFLG2                                                 01887000
@NM00012 EQU   $OLTFLG2                                                 01888000
$TALK    EQU   $OLTFLG2                                                 01889000
$DYCOM   EQU   $OLTFLGS                                                 01890000
@NM00011 EQU   $OLTFLGS                                                 01891000
$TRACE   EQU   $OLTFLGS                                                 01892000
$RETCODE EQU   $OLTFLGS                                                 01893000
$CONTCB  EQU   $OLTFLGS                                                 01894000
$RETAIN  EQU   $OLTFLGS                                                 01895000
$CLEANRT EQU   $OLTFLGS                                                 01896000
$MANINTV EQU   $OLTFLGS                                                 01897000
$OLTSIZE EQU   $SCTTBLE+34                                              01898000
$QSCTMOD EQU   $EXECFLG                                                 01899000
$CTRLMOD EQU   $EXECFLG                                                 01900000
$CLEANUP EQU   $EXECFLG                                                 01901000
$LSTPDEV EQU   $EXECFLG                                                 01902000
$ERRCNT  EQU   $EXECFLG                                                 01903000
$RTNSLCT EQU   $EXECFLG                                                 01904000
$MULTDEV EQU   $EXECFLG                                                 01905000
@NM00010 EQU   $EXECFLG                                                 01906000
$RMSKCNT EQU   $SCTTBLE+32                                              01907000
$SYNAME  EQU   $CDS8T19+4                                               01908000
$EXTSIG  EQU   $CDS8T19+3                                               01909000
$CDFLGS  EQU   $CDS8T19+1                                               01910000
$CDSCNT  EQU   $CDS8T19                                                 01911000
$PDEVDSC EQU   $SCTTBLE+16                                              01912000
$COMMCN  EQU   $CDSFLGS                                                 01913000
$CUSTSYM EQU   $CDSFLGS                                                 01914000
$TWOCHSW EQU   $CDSFLGS                                                 01915000
$SYMNAME EQU   $CDSFLGS                                                 01916000
$EXTINTC EQU   $CDSFLGS                                                 01917000
$CEVOL   EQU   $CDSFLGS                                                 01918000
$SHARED  EQU   $CDSFLGS                                                 01919000
$FPM     EQU   $CDSFLGS                                                 01920000
$LASTSUB EQU   $PDEVFLG                                                 01921000
@NM00009 EQU   $PDEVFLG                                                 01922000
@NM00008 EQU   $PDEVFLG                                                 01923000
@NM00007 EQU   $PDEVFLG                                                 01924000
$LASTDEV EQU   $PDEVFLG                                                 01925000
@NM00006 EQU   $PDEVFLG                                                 01926000
$EXFILPT EQU   $PDEVFLG                                                 01927000
$FPMOLD  EQU   $PDEVFLG                                                 01928000
$TSSSYM  EQU   $SCTTBLE+8                                               01929000
$SCTLEVL EQU   $SCTTBLE+7                                               01930000
$DRIVER  EQU   $SCTTBLE+6                                               01931000
$RT0916  EQU   $SCTTBLE+5                                               01932000
$RT0108  EQU   $SCTTBLE+4                                               01933000
$LOOPTST EQU   $ERROPT                                                  01934000
$LOOPERR EQU   $ERROPT                                                  01935000
$NERRPRT EQU   $ERROPT                                                  01936000
$NOCNTRL EQU   $ERROPT                                                  01937000
$ALTPRNT EQU   $ERROPT                                                  01938000
$CATERR  EQU   $ERROPT                                                  01939000
$ASTERIK EQU   $ERROPT                                                  01940000
$TESTERR EQU   $ERROPT                                                  01941000
$FSTCOMM EQU   $TESTOPT                                                 01942000
$INDEFLP EQU   $TESTOPT                                                 01943000
$NOPRT   EQU   $TESTOPT                                                 01944000
$PARAPRT EQU   $TESTOPT                                                 01945000
@NM00005 EQU   $TESTOPT                                                 01946000
$ERRLPCT EQU   $SCTTBLE                                                 01947000
$TLTEND  EQU   $RCAAREA+945                                             01948000
$CNSLID  EQU   $RCAAREA+936                                             01949000
$TRASCII EQU   $RCAAREA+608                                             01950000
@NM00004 EQU   $RCAAREA+605                                             01951000
$VTAMEND EQU   $RCAFLG                                                  01952000
$TPPOSTD EQU   $RCAFLG                                                  01953000
$NEWCT   EQU   $RCAFLG                                                  01954000
$ABNDALL EQU   $RCAFLG                                                  01955000
$CUTESTB EQU   $RCAFLG                                                  01956000
$CONSOLE EQU   $RCAFLG                                                  01957000
$TPLOGON EQU   $RCAFLG                                                  01958000
$UPDATE  EQU   $RCAFLG                                                  01959000
$DEVAREA EQU   $RCAAREA+600                                             01960000
$CTDVAR  EQU   $RCAAREA+596                                             01961000
$BUFFS   EQU   $RCAAREA+464                                             01962000
$TLTNIB  EQU   $CONSTNT+140                                             01963000
$TLTPRPL EQU   $CONSTNT+20                                              01964000
@NM00003 EQU   $CONSTNT+4                                               01965000
@NM00002 EQU   $CONSTNT+2                                               01966000
$USECNT  EQU   $CONSTNT                                                 01967000
$CURRTWA EQU   $POINTER+140                                             01968000
$CTNAME  EQU   $POINTER+132                                             01969000
$CTARGX  EQU   $POINTER+128                                             01970000
$COMINT  EQU   $POINTER+120                                             01971000
$QUEHNDL EQU   $POINTER+116                                             01972000
@NM00001 EQU   $POINTER+36                                              01973000
$RTNPTR  EQU   $POINTER+32                                              01974000
$TLTECB1 EQU   $POINTER+24                                              01975000
$CLEANP  EQU   $POINTER+20                                              01976000
$ABEND   EQU   $POINTER+16                                              01977000
$LSTAREA EQU   $POINTER+12                                              01978000
$FSTAREA EQU   $POINTER+8                                               01979000
$CVTSAVE EQU   $POINTER+4                                               01980000
$TOLTEP  EQU   $POINTER                                                 01981000
$TLTACB  EQU   $RCAAREA                                                 01982000
.@UNREFD ANOP                          END UNREFERENCED COMPONENTS      01983000
@RT00126 EQU   S25C0100                                                 01984000
@RF00126 EQU   S25C0200                                                 01985000
@RT00131 EQU   S25C0200                                                 01986000
@RT00139 EQU   S25C0300                                                 01987000
@RF00139 EQU   S25C0250                                                 01988000
@RT00148 EQU   S25C9999                                                 01989000
@RF00260 EQU   S25C9999                                                 01990000
@RT00313 EQU   S25C3050                                                 01991000
@RT00319 EQU   S25C3100                                                 01992000
@RT00328 EQU   S25C3999                                                 01993000
@ENDDATA EQU   *                                                        01994000
         END   ISTSC025,(C'PLS1050',0702,78336)                         01995000
./  ADD  SSI=83370154,NAME=ISTSC026
         TITLE 'ISTSC026,DTIME. OBTAINS CURRENT TIME OF DAY'            00001000
* IBM DISK OPERATING SYSTEM                                             00002000
* TOLTEP - 5745-SC-TLT                                                  00003000
          ISEQ  73,80                                                   00004000
ISTSC026 CSECT ,                                                   0002 00005000
@MAINENT DS    0H                                                  0002 00006000
         USING *,@15                                               0002 00007000
         B     @PROLOG                                             0002 00008000
         DC    AL1(16)                                             0002 00009000
         DC    C'ISTSC026  78.337'                                 0002 00010000
         DROP  @15                                                      00011000
@PROLOG  ST    @14,12(,@13)                                        0002 00012000
         ST    @00,20(,@13)                                        0002 00013000
         STM   @02,@12,28(@13)                                     0002 00014000
         BALR  @04,0                                               0002 00015000
@PSTART  DS    0H                                                  0002 00016000
         USING @PSTART,@04                                         0002 00017000
          TIME  DEC                     GET PACKED DEC TIME             00018000
          LR    R1,R0                   PUT TIME IN R1                  00019000
          SRL   R1,8                                                    00020000
          SLL   R1,8                                                    00021000
*   R15=0;                          /* SET GOOD RETURN CODE          */ 00022000
         SLR   R15,R15                                             0023 00023000
*   RETURN;                                                        0024 00024000
@EL00001 DS    0H                                                  0024 00025000
@EF00001 DS    0H                                                  0024 00026000
@ER00001 L     @14,12(,@13)                                        0024 00027000
         L     @00,20(,@13)                                        0024 00028000
         LM    @02,@12,28(@13)                                     0024 00029000
         BR    @14                                                 0024 00030000
*   DO;                             /* ATDSPLY                       */ 00031000
*   END;                            /* ATDSPLY                       */ 00032000
*   END;                                                           0027 00033000
@DATA    DS    0H                                                       00034000
         DS    0F                                                       00035000
         DS    0F                                                       00036000
         DS    0D                                                       00037000
PATCH    DC    5F'0'                                                    00038000
@00      EQU   00                      EQUATES FOR REGISTERS 0-15       00039000
@01      EQU   01                                                       00040000
@02      EQU   02                                                       00041000
@03      EQU   03                                                       00042000
@04      EQU   04                                                       00043000
@05      EQU   05                                                       00044000
@06      EQU   06                                                       00045000
@07      EQU   07                                                       00046000
@08      EQU   08                                                       00047000
@09      EQU   09                                                       00048000
@10      EQU   10                                                       00049000
@11      EQU   11                                                       00050000
@12      EQU   12                                                       00051000
@13      EQU   13                                                       00052000
@14      EQU   14                                                       00053000
@15      EQU   15                                                       00054000
WAPTR    EQU   @02                                                      00055000
R15      EQU   @15                                                      00056000
R0       EQU   @00                                                      00057000
R1       EQU   @01                                                      00058000
R10      EQU   @10                                                      00059000
R11      EQU   @11                                                      00060000
R12      EQU   @12                                                      00061000
R13      EQU   @13                                                      00062000
R14      EQU   @14                                                      00063000
R2       EQU   @02                                                      00064000
R3       EQU   @03                                                      00065000
R4       EQU   @04                                                      00066000
R5       EQU   @05                                                      00067000
R6       EQU   @06                                                      00068000
R7       EQU   @07                                                      00069000
R8       EQU   @08                                                      00070000
R9       EQU   @09                                                      00071000
TOLTEPWA EQU   0                                                        00072000
         AGO   .@UNREFD                START UNREFERENCED COMPONENTS    00073000
$WORKARA EQU   TOLTEPWA+1616                                            00074000
$SLTBL   EQU   TOLTEPWA+1468                                            00075000
@NM00001 EQU   TOLTEPWA+1464                                            00076000
$DEVTBLE EQU   TOLTEPWA+240                                             00077000
$COMMFLG EQU   TOLTEPWA+224                                             00078000
$CDA     EQU   TOLTEPWA+100                                             00079000
$SCTTBLE EQU   TOLTEPWA                                                 00080000
.@UNREFD ANOP                          END UNREFERENCED COMPONENTS      00081000
@ENDDATA EQU   *                                                        00082000
         END   ISTSC026,(C'PLS1530',0702,78337)                         00083000
./  ADD  SSI=83370156,NAME=ISTSC028
         TITLE 'ISTSC028-FREECORE'                                      00001000
ISTSC028 CSECT ,                                                   0001 00002000
@MAINENT DS    0H                                                  0001 00003000
         USING *,@15                                               0001 00004000
         B     @PROLOG                                             0001 00005000
         DC    AL1(16)                                             0001 00006000
         DC    C'ISTSC028  78.337'                                 0001 00007000
         DROP  @15                                                      00008000
@PROLOG  ST    @14,12(,@13)                                        0001 00009000
         STM   @02,@12,28(@13)                                     0001 00010000
         BALR  @12,0                                               0001 00011000
@PSTART  DS    0H                                                  0001 00012000
         USING @PSTART,@12                                         0001 00013000
         ST    @13,@SA00001+4                                      0001 00014000
         LA    @14,@SA00001                                        0001 00015000
         ST    @14,8(,@13)                                         0001 00016000
         LR    @13,@14                                             0001 00017000
         EJECT                                                          00018000
*                                                                  0047 00019000
*/********************************************************************/ 00020000
*/*      CONSTANTS                                                   */ 00021000
*/********************************************************************/ 00022000
*/********************************************************************/ 00023000
*/*      TEST  MACRO LEVEL & MORE CORE ISSUED                        */ 00024000
*/********************************************************************/ 00025000
*                                                                  0048 00026000
*   R15=0;                          /* SET RTN REG TO ZERO           */ 00027000
         SLR   R15,R15                                             0048 00028000
*   IF $FSTMCIS='0'B                /* HAS ANY MORE CORE'S BEEN      */ 00029000
*     THEN                          /* ISSUED                        */ 00030000
         TM    $FSTMCIS(WAPTR),B'00000100'                         0049 00031000
         BZ    @RT00049                                            0049 00032000
*     GOTO S28C0090;                /* BR-NOT ON RTN CDE 8           */ 00033000
*   R6=$FRELPTR;                    /* PICK UP CHAIN PTR             */ 00034000
         L     R6,$FRELPTR(,WAPTR)                                 0051 00035000
*/********************************************************************/ 00036000
*/*      SEARCH  CHAIN MORE/FREE                                     */ 00037000
*/********************************************************************/ 00038000
*                                                                  0052 00039000
*   R7=$FREEPTR;                    /* PICK UP PTR TO BE FREED       */ 00040000
         L     R7,$FREEPTR(,FREMAP)                                0052 00041000
*   R7=AREAADDR;                    /* PTR TO PTR ON MAP             */ 00042000
         L     R7,AREAADDR(,R7)                                    0053 00043000
*S28C0000:                                                         0054 00044000
*   ;                                                              0054 00045000
S28C0000 DS    0H                                                  0055 00046000
*   R5=R6+8;                        /* SET COMPARE PTR+8 FOR MANG    */ 00047000
         LA    R5,8                                                0055 00048000
         ALR   R5,R6                                               0055 00049000
*   IF R5¬=R7                       /* COMPARE PTRS                  */ 00050000
*     THEN                          /* IF NOT EQUAL GOTO NXT PTR     */ 00051000
         CR    R5,R7                                               0056 00052000
         BNE   @RT00056                                            0056 00053000
*     GOTO S28C0001;                /*                               */ 00054000
*   IF FREE='1'B                    /* IF EQUAL IS AREA FREE         */ 00055000
*     THEN                          /* IF BIT ON AREA FREE           */ 00056000
         TM    FREE(R6),B'00000001'                                0058 00057000
         BO    @RT00058                                            0058 00058000
*     GOTO S28C0090;                /* THEN GIVE RTN CODE 8          */ 00059000
*   GOTO S28C0002;                  /* IF OFF COMBINE AREAS          */ 00060000
         B     S28C0002                                            0060 00061000
*S28C0001:                                                         0061 00062000
*   ;                               /*                               */ 00063000
S28C0001 DS    0H                                                  0062 00064000
*   R8=R6;                          /* SAVE PTR TO PREV AREA         */ 00065000
         LR    R8,R6                                               0062 00066000
*   IF COREFWD=0                    /* IS THIS END OF CHAIN          */ 00067000
*     THEN                          /* IF YES GIVE RTN CODE 8        */ 00068000
         L     @14,COREFWD(,R6)                                    0063 00069000
         LTR   @14,@14                                             0063 00070000
         BZ    @RT00063                                            0063 00071000
*     GOTO S28C0090;                /*                               */ 00072000
*   R6=COREFWD;                     /* IF NO PICK UP PTR TO NXT      */ 00073000
         LR    R6,@14                                              0065 00074000
*   GOTO S28C0000;                  /* AND LOOP                      */ 00075000
         B     S28C0000                                            0066 00076000
*S28C0002:                                                         0067 00077000
*   ;                               /*                               */ 00078000
S28C0002 DS    0H                                                  0068 00079000
*   IF R6=$FRELPTR                  /* TEST AREA FOR 1ST FREE        */ 00080000
*     THEN                          /* IF YES JUST SET FREE BIT      */ 00081000
         C     R6,$FRELPTR(,WAPTR)                                 0068 00082000
         BE    @RT00068                                            0068 00083000
*     GOTO S28C0003;                /* NO COMBINING NEEDED           */ 00084000
*   IF FREEN='0'B                   /* IS PREV AREA FREE             */ 00085000
*     THEN                          /* BR-NO NO COMBINING NEEDED     */ 00086000
         TM    FREEN(R8),B'00000001'                               0070 00087000
         BZ    @RT00070                                            0070 00088000
*     GOTO S28C0003;                /*                               */ 00089000
*/********************************************************************/ 00090000
*/*      COMBINE NEW FREE AREAS                                      */ 00091000
*/********************************************************************/ 00092000
*                                                                  0072 00093000
*   CORESZEN=CORESZEN+CORESZE;      /* SET UP COMBINED SIZE IN       */ 00094000
         L     @14,CORESZEN(,R8)                                   0072 00095000
         AL    @14,CORESZE(,R6)                                    0072 00096000
         ST    @14,CORESZEN(,R8)                                   0072 00097000
*   COREFWDN=COREFWD;               /* PREV & MOVE THIS FWD PTR      */ 00098000
         L     @14,COREFWD(,R6)                                    0073 00099000
         ST    @14,COREFWDN(,R8)                                   0073 00100000
*   R6=R8;                          /* TO PREV. SET R6 WITH PREV     */ 00101000
         LR    R6,R8                                               0074 00102000
*S28C0003:                                                         0075 00103000
*   ;                               /*                               */ 00104000
S28C0003 DS    0H                                                  0076 00105000
*   FREE='1'B;                      /* SET FREE BIT ON               */ 00106000
         OI    FREE(R6),B'00000001'                                0076 00107000
*   R8=COREFWD;                     /* TEST NXT AREA FOR FREE        */ 00108000
         L     R8,COREFWD(,R6)                                     0077 00109000
*   IF R8=0                         /* IS FWD PTR ZERO?              */ 00110000
*     THEN                          /* YES NO MORE COMBINING         */ 00111000
         LTR   R8,R8                                               0078 00112000
         BZ    @RT00078                                            0078 00113000
*     GOTO S28C0092;                /* NEED EP                       */ 00114000
*   IF FREEN='0'B                   /* IS IT FREE                    */ 00115000
*     THEN                          /* BR-NO                         */ 00116000
         TM    FREEN(R8),B'00000001'                               0080 00117000
         BZ    @RT00080                                            0080 00118000
*     GOTO S28C0092;                /* NO MORE COMBINING             */ 00119000
*   CORESZE=CORESZE+CORESZEN-1;     /* COMBINE LENGTHS               */ 00120000
         L     @14,CORESZE(,R6)                                    0082 00121000
         AL    @14,CORESZEN(,R8)                                   0082 00122000
         BCTR  @14,0                                               0082 00123000
         ST    @14,CORESZE(,R6)                                    0082 00124000
*   COREFWD=COREFWDN;               /* SET FWD PTR OF NXT            */ 00125000
         L     @14,COREFWDN(,R8)                                   0083 00126000
         ST    @14,COREFWD(,R6)                                    0083 00127000
*   GOTO S28C0092;                  /* GIVE RTN CODE OF 0            */ 00128000
         B     S28C0092                                            0084 00129000
*/********************************************************************/ 00130000
*                                                                  0085 00131000
*   GEN(EJECT);                                                    0085 00132000
         EJECT                                                          00133000
*                                                                  0086 00134000
*/********************************************************************/ 00135000
*/*      RTN CODE                                                    */ 00136000
*/********************************************************************/ 00137000
*                                                                  0086 00138000
*S28C0090:                                                         0086 00139000
*   ;                                                              0086 00140000
S28C0090 DS    0H                                                  0087 00141000
*   R15=R15+4;                      /* RTN CODE=8                    */ 00142000
         AL    R15,@CF00088                                        0087 00143000
*S28C0091:                                                         0088 00144000
*   ;                                                              0088 00145000
S28C0091 DS    0H                                                  0089 00146000
*   R15=R15+4;                      /* RTN CODE=4                    */ 00147000
         AL    R15,@CF00088                                        0089 00148000
*S28C0092:                                                         0090 00149000
*   ;                                                              0090 00150000
S28C0092 DS    0H                                                  0091 00151000
*   DO;                             /* ATDSPLY                       */ 00152000
*   END;                            /* ATDSPLY                       */ 00153000
*   END;                            /* RTN CODE=0                    */ 00154000
@EL00001 L     @13,4(,@13)                                         0093 00155000
@EF00001 DS    0H                                                  0093 00156000
@ER00001 L     @14,12(,@13)                                        0093 00157000
         LM    @02,@12,28(@13)                                     0093 00158000
         BR    @14                                                 0093 00159000
@DATA    DS    0H                                                       00160000
         DS    0F                                                       00161000
@SA00001 DS    18F                                                      00162000
         DS    0F                                                       00163000
@CF00088 DC    F'4'                                                     00164000
         DS    0D                                                       00165000
PATCH    DC    10F'0'                                                   00166000
@00      EQU   00                      EQUATES FOR REGISTERS 0-15       00167000
@01      EQU   01                                                       00168000
@02      EQU   02                                                       00169000
@03      EQU   03                                                       00170000
@04      EQU   04                                                       00171000
@05      EQU   05                                                       00172000
@06      EQU   06                                                       00173000
@07      EQU   07                                                       00174000
@08      EQU   08                                                       00175000
@09      EQU   09                                                       00176000
@10      EQU   10                                                       00177000
@11      EQU   11                                                       00178000
@12      EQU   12                                                       00179000
@13      EQU   13                                                       00180000
@14      EQU   14                                                       00181000
@15      EQU   15                                                       00182000
R0       EQU   @00                                                      00183000
R1       EQU   @01                                                      00184000
R2       EQU   @02                                                      00185000
R3       EQU   @03                                                      00186000
R4       EQU   @04                                                      00187000
R5       EQU   @05                                                      00188000
R6       EQU   @06                                                      00189000
R7       EQU   @07                                                      00190000
R8       EQU   @08                                                      00191000
R15      EQU   @15                                                      00192000
RCAPTR   EQU   @03                                                      00193000
WAPTR    EQU   @02                                                      00194000
MORMAP   EQU   @01                                                      00195000
FREMAP   EQU   @01                                                      00196000
R10      EQU   @10                                                      00197000
R11      EQU   @11                                                      00198000
R12      EQU   @12                                                      00199000
R13      EQU   @13                                                      00200000
R14      EQU   @14                                                      00201000
R9       EQU   @09                                                      00202000
$RCAAREA EQU   0                                                        00203000
$POINTER EQU   $RCAAREA+100                                             00204000
$TRTBLA  EQU   $POINTER+124                                             00205000
$CONSTNT EQU   $RCAAREA+244                                             00206000
$RCAFLG  EQU   $RCAAREA+604                                             00207000
TOLTEPWA EQU   0                                                        00208000
$SCTTBLE EQU   TOLTEPWA                                                 00209000
$TESTOPT EQU   $SCTTBLE+2                                               00210000
$ERROPT  EQU   $SCTTBLE+3                                               00211000
$PDEVFLG EQU   $SCTTBLE+10                                              00212000
$CDSFLGS EQU   $SCTTBLE+11                                              00213000
$CDS8T19 EQU   $SCTTBLE+20                                              00214000
$EXECFLG EQU   $SCTTBLE+33                                              00215000
$OLTFLGS EQU   $SCTTBLE+36                                              00216000
$OLTFLG2 EQU   $SCTTBLE+37                                              00217000
$TOTFLG1 EQU   $SCTTBLE+38                                              00218000
$ROUTMSK EQU   $SCTTBLE+40                                              00219000
$CDA     EQU   TOLTEPWA+100                                             00220000
$RCA     EQU   $CDA+44                                                  00221000
$OLTPTR  EQU   $CDA+52                                                  00222000
$HIMOREC EQU   $CDA+60                                                  00223000
$FRELPTR EQU   $CDA+64                                                  00224000
$COMMFLG EQU   TOLTEPWA+224                                             00225000
$FLAG1   EQU   $COMMFLG                                                 00226000
$FLAG2   EQU   $COMMFLG+1                                               00227000
$FLAG3   EQU   $COMMFLG+2                                               00228000
$FLAG4   EQU   $COMMFLG+3                                               00229000
$FLAG5   EQU   $COMMFLG+4                                               00230000
$EOJ     EQU   $FLAG5                                                   00231000
$CANCEL  EQU   $EOJ                                                     00232000
$FLAG6   EQU   $COMMFLG+5                                               00233000
$FSTMCIS EQU   $FLAG6                                                   00234000
$ABNDBIT EQU   $FLAG6                                                   00235000
$FLAG7   EQU   $COMMFLG+6                                               00236000
$FLAG8   EQU   $COMMFLG+7                                               00237000
$FLAG9   EQU   $COMMFLG+8                                               00238000
$FLAG10  EQU   $COMMFLG+9                                               00239000
$FLAG11  EQU   $COMMFLG+10                                              00240000
$FLAG12  EQU   $COMMFLG+11                                              00241000
$FLAG13  EQU   $COMMFLG+12                                              00242000
$DEVTBLE EQU   TOLTEPWA+240                                             00243000
$DEVCDS  EQU   $DEVTBLE                                                 00244000
$DEVUNAD EQU   $DEVCDS                                                  00245000
@NM00039 EQU   $DEVUNAD+2                                               00246000
$DEVFEAT EQU   $DEVCDS+4                                                00247000
$DEVCDSF EQU   $DEVCDS+9                                                00248000
$DEVSDCF EQU   $DEVCDS+10                                               00249000
$$SYMNME EQU   $DEVCDS+12                                               00250000
$DEVFLG1 EQU   $DEVTBLE+20                                              00251000
$EVNCPLT EQU   $DEVFLG1                                                 00252000
$ATTNEXP EQU   $DEVFLG1                                                 00253000
$INTOCC  EQU   $DEVFLG1                                                 00254000
$DEVFLG2 EQU   $DEVTBLE+21                                              00255000
$DEVTECB EQU   $DEVTBLE+22                                              00256000
$OPIS    EQU   $DEVTECB                                                 00257000
$OPND    EQU   $DEVTECB+2                                               00258000
$DEVFLG3 EQU   $DEVTBLE+27                                              00259000
$SIOFLG  EQU   $DEVFLG3                                                 00260000
$IFTOUT  EQU   $DEVTBLE+36                                              00261000
$DEVSESP EQU   $IFTOUT                                                  00262000
$SSCPDAF EQU   $IFTOUT+6                                                00263000
$LDNCBPT EQU   $DEVTBLE+48                                              00264000
$RNINFO  EQU   $DEVTBLE+56                                              00265000
$DEVFLG5 EQU   $RNINFO+8                                                00266000
$DEVFLG4 EQU   $DEVTBLE+65                                              00267000
$SLTBL   EQU   TOLTEPWA+1468                                            00268000
$RUNTEST EQU   $SLTBL+13                                                00269000
$TESTFLG EQU   $SLTBL+21                                                00270000
$SECLST  EQU   $SLTBL+22                                                00271000
#EXITA   EQU   TOLTEPWA+2632                                            00272000
$CCOMDAT EQU   TOLTEPWA+2644                                            00273000
$CFLGS   EQU   $CCOMDAT+16                                              00274000
$24FEMSG EQU   TOLTEPWA+2681                                            00275000
$24CATMG EQU   $24FEMSG+11                                              00276000
@NM00048 EQU   TOLTEPWA+2776                                            00277000
$OUNTPTR EQU   @NM00048+4                                               00278000
$NSPTR   EQU   $OUNTPTR                                                 00279000
$NSCNT   EQU   @NM00048+10                                              00280000
$ENXX    EQU   @NM00048+15                                              00281000
$IMITX   EQU   $ENXX                                                    00282000
SVESC033 EQU   TOLTEPWA+3160                                            00283000
SVECC013 EQU   TOLTEPWA+3232                                            00284000
SVEIC003 EQU   TOLTEPWA+3592                                            00285000
SVESC022 EQU   TOLTEPWA+3736                                            00286000
SVECC011 EQU   TOLTEPWA+4024                                            00287000
MORECMAP EQU   0                                                        00288000
FREEMAP  EQU   0                                                        00289000
$FREEPTR EQU   FREEMAP+4                                                00290000
AREAADDR EQU   0                                                        00291000
COREMANG EQU   0                                                        00292000
CORESZE  EQU   COREMANG                                                 00293000
@NM00052 EQU   CORESZE+3                                                00294000
FREE     EQU   @NM00052                                                 00295000
COREFWD  EQU   COREMANG+4                                               00296000
@NM00054 EQU   0                                                        00297000
CORESZEN EQU   @NM00054                                                 00298000
@NM00056 EQU   CORESZEN+3                                               00299000
FREEN    EQU   @NM00056                                                 00300000
COREFWDN EQU   @NM00054+4                                               00301000
$TRTBL   EQU   0                                                        00302000
#EXIT    EQU   0                                                        00303000
SVECC012 EQU   SVESC022                                                 00304000
SVEIC00A EQU   SVEIC003                                                 00305000
SVEIC004 EQU   SVEIC003                                                 00306000
SVEIC005 EQU   SVEIC003                                                 00307000
SVESC02A EQU   SVESC022                                                 00308000
SVESC02B EQU   SVESC022                                                 00309000
SVESC02D EQU   SVESC022                                                 00310000
SVESC02E EQU   SVESC022                                                 00311000
SVESC02F EQU   SVECC013                                                 00312000
SVESC024 EQU   SVESC022                                                 00313000
SVESC027 EQU   SVESC022                                                 00314000
SVESC029 EQU   SVESC033                                                 00315000
SVESC031 EQU   SVECC013                                                 00316000
SVESC032 EQU   SVECC011                                                 00317000
SVETC037 EQU   SVEIC003                                                 00318000
         AGO   .@UNREFD                START UNREFERENCED COMPONENTS    00319000
@NM00057 EQU   @NM00056                                                 00320000
@NM00055 EQU   CORESZEN                                                 00321000
@NM00053 EQU   @NM00052                                                 00322000
@NM00051 EQU   CORESZE                                                  00323000
$FREIDNT EQU   FREEMAP+2                                                00324000
$FRELEVL EQU   FREEMAP+1                                                00325000
$FRETRMG EQU   FREEMAP                                                  00326000
$MORCMIN EQU   MORECMAP+8                                               00327000
$MORCMAX EQU   MORECMAP+4                                               00328000
$MORIDNT EQU   MORECMAP+2                                               00329000
$MORLEVL EQU   MORECMAP+1                                               00330000
$MORTRMG EQU   MORECMAP                                                 00331000
SVECC010 EQU   TOLTEPWA+3952                                            00332000
SVETC035 EQU   TOLTEPWA+3880                                            00333000
SVESC030 EQU   TOLTEPWA+3808                                            00334000
SVESC020 EQU   TOLTEPWA+3664                                            00335000
SVEIC002 EQU   TOLTEPWA+3520                                            00336000
SVECC014 EQU   TOLTEPWA+3376                                            00337000
SVESC120 EQU   TOLTEPWA+3304                                            00338000
SVESC025 EQU   TOLTEPWA+3088                                            00339000
@NM00050 EQU   TOLTEPWA+2980                                            00340000
$RPLERR  EQU   TOLTEPWA+2977                                            00341000
@NM00049 EQU   TOLTEPWA+2976                                            00342000
$R13PR3  EQU   TOLTEPWA+2972                                            00343000
$CEINT2  EQU   TOLTEPWA+2968                                            00344000
$CEINT1  EQU   TOLTEPWA+2964                                            00345000
$MSGGET  EQU   TOLTEPWA+2960                                            00346000
$ACQLIST EQU   TOLTEPWA+2956                                            00347000
$R4SAVE1 EQU   TOLTEPWA+2952                                            00348000
$CLSISS  EQU   TOLTEPWA+2950                                            00349000
$CLSCNT  EQU   TOLTEPWA+2948                                            00350000
$CUTABLE EQU   TOLTEPWA+2868                                            00351000
$BUFSZ2  EQU   TOLTEPWA+2864                                            00352000
$RESID2  EQU   TOLTEPWA+2860                                            00353000
$OLTCCW2 EQU   TOLTEPWA+2856                                            00354000
$ENDBFR2 EQU   TOLTEPWA+2852                                            00355000
$1STBFR2 EQU   TOLTEPWA+2848                                            00356000
$TECB2   EQU   TOLTEPWA+2844                                            00357000
$BUFSZ1  EQU   TOLTEPWA+2840                                            00358000
$RESID1  EQU   TOLTEPWA+2836                                            00359000
$OLTCCW1 EQU   TOLTEPWA+2832                                            00360000
$ENDBFR1 EQU   TOLTEPWA+2828                                            00361000
$1STBFR1 EQU   TOLTEPWA+2824                                            00362000
$TECB1   EQU   TOLTEPWA+2820                                            00363000
$WAITIME EQU   TOLTEPWA+2816                                            00364000
$TRTN#   EQU   TOLTEPWA+2815                                            00365000
$WIODEV  EQU   TOLTEPWA+2814                                            00366000
$RQSTSZE EQU   TOLTEPWA+2812                                            00367000
$RQSTPTR EQU   TOLTEPWA+2808                                            00368000
$R4SAVE  EQU   TOLTEPWA+2804                                            00369000
$PARTADR EQU   TOLTEPWA+2800                                            00370000
$TBSDATA EQU   TOLTEPWA+2796                                            00371000
$CTWIDTH EQU   TOLTEPWA+2795                                            00372000
$CTLINE  EQU   TOLTEPWA+2794                                            00373000
$APWIDTH EQU   TOLTEPWA+2793                                            00374000
$APLINE  EQU   TOLTEPWA+2792                                            00375000
$INDEX   EQU   $IMITX                                                   00376000
$UMXX    EQU   @NM00048+14                                              00377000
$NSXX    EQU   @NM00048+12                                              00378000
$ATACNT  EQU   $NSCNT                                                   00379000
$CTR     EQU   @NM00048+8                                               00380000
$ATAPTR  EQU   $NSPTR                                                   00381000
$DDRPTR  EQU   @NM00048                                                 00382000
$DTORESP EQU   TOLTEPWA+2712                                            00383000
$APNAME  EQU   TOLTEPWA+2704                                            00384000
$24SYMNE EQU   $24CATMG+4                                               00385000
$24DEVAD EQU   $24CATMG                                                 00386000
$24RTN#  EQU   $24FEMSG+8                                               00387000
$ESECTID EQU   $24FEMSG                                                 00388000
$24FLGS  EQU   TOLTEPWA+2680                                            00389000
$24SAVE2 EQU   TOLTEPWA+2676                                            00390000
$24SAVE1 EQU   TOLTEPWA+2672                                            00391000
$24UNADR EQU   TOLTEPWA+2668                                            00392000
$24SAV13 EQU   TOLTEPWA+2664                                            00393000
$24RETCD EQU   TOLTEPWA+2663                                            00394000
$MACID   EQU   TOLTEPWA+2661                                            00395000
$CSPARE  EQU   $CFLGS                                                   00396000
$C2WAY   EQU   $CFLGS                                                   00397000
$CINCT   EQU   $CCOMDAT+12                                              00398000
$CINADR  EQU   $CCOMDAT+8                                               00399000
$COUTCT  EQU   $CCOMDAT+4                                               00400000
$COUTAD  EQU   $CCOMDAT                                                 00401000
ROOTLOC  EQU   TOLTEPWA+2640                                            00402000
$RETREG  EQU   TOLTEPWA+2636                                            00403000
$WORK    EQU   TOLTEPWA+2376                                            00404000
$EXTA    EQU   TOLTEPWA+2320                                            00405000
$PASSONA EQU   TOLTEPWA+2264                                            00406000
$TRMINPT EQU   TOLTEPWA+2184                                            00407000
$INBUFR  EQU   TOLTEPWA+2104                                            00408000
$BUFFER  EQU   TOLTEPWA+1976                                            00409000
$TLTRPL3 EQU   TOLTEPWA+1856                                            00410000
$TLTRPL2 EQU   TOLTEPWA+1736                                            00411000
$TLTRPL1 EQU   TOLTEPWA+1616                                            00412000
@NM00047 EQU   $SLTBL+135                                               00413000
$HIGHRTN EQU   $SLTBL+134                                               00414000
$PRIMADR EQU   $SLTBL+130                                               00415000
$CTSTPT  EQU   $SLTBL+128                                               00416000
$TSTCNT  EQU   $SLTBL+126                                               00417000
$SECFLGS EQU   $SECLST+3                                                00418000
$SECTION EQU   $SECLST                                                  00419000
$SECACT  EQU   $TESTFLG                                                 00420000
$CANTRUN EQU   $TESTFLG                                                 00421000
$FINAL   EQU   $TESTFLG                                                 00422000
$TESTSUF EQU   $RUNTEST+5                                               00423000
$TESTNUM EQU   $RUNTEST+1                                               00424000
$LETPRF  EQU   $RUNTEST                                                 00425000
$SYMBOLC EQU   $SLTBL+5                                                 00426000
$FAMILY  EQU   $SLTBL                                                   00427000
$CDEVPT  EQU   TOLTEPWA+1466                                            00428000
$DEVCNTS EQU   TOLTEPWA+1464                                            00429000
$FEEDBCK EQU   $DEVTBLE+66                                              00430000
$WTISUED EQU   $DEVFLG4                                                 00431000
$EXIOISD EQU   $DEVFLG4                                                 00432000
$REMWRIT EQU   $DEVFLG4                                                 00433000
$REMDONE EQU   $DEVFLG4                                                 00434000
$2NDUSED EQU   $DEVFLG4                                                 00435000
$1STUSED EQU   $DEVFLG4                                                 00436000
$IGLXIFB EQU   $DEVFLG4                                                 00437000
$EXIOLV3 EQU   $DEVFLG4                                                 00438000
@NM00046 EQU   $DEVFLG5                                                 00439000
$DVBASIC EQU   $DEVFLG5                                                 00440000
$ASCII   EQU   $DEVFLG5                                                 00441000
$DEVLU   EQU   $DEVFLG5                                                 00442000
$OPNDFAL EQU   $DEVFLG5                                                 00443000
$ACQNCB  EQU   $DEVFLG5                                                 00444000
$REMOTE  EQU   $DEVFLG5                                                 00445000
$ENDNODE EQU   $DEVFLG5                                                 00446000
$LINENME EQU   $RNINFO                                                  00447000
$CID     EQU   $DEVTBLE+52                                              00448000
$DVCOL   EQU   $LDNCBPT+2                                               00449000
$DVROW   EQU   $LDNCBPT                                                 00450000
$NCSPLP  EQU   $DEVTBLE+44                                              00451000
$DVLN    EQU   $SSCPDAF                                                 00452000
$DAF     EQU   $DEVSESP+4                                               00453000
$VARYPAB EQU   $DEVSESP                                                 00454000
$SYSMN   EQU   $DEVTBLE+28                                              00455000
@NM00045 EQU   $DEVFLG3                                                 00456000
$CLRSNT  EQU   $DEVFLG3                                                 00457000
$OLTERR  EQU   $DEVFLG3                                                 00458000
$SRTEST  EQU   $DEVFLG3                                                 00459000
$DVSNDOK EQU   $SIOFLG                                                  00460000
$POLLREQ EQU   $DEVFLG3                                                 00461000
$ACQRED  EQU   $DEVFLG3                                                 00462000
$NOTDEV  EQU   $DEVFLG3                                                 00463000
$DVINCT  EQU   $DEVTBLE+26                                              00464000
$DVBRKST EQU   $OPND+1                                                  00465000
$DVBRKSN EQU   $OPND                                                    00466000
$DVSEQNO EQU   $OPIS                                                    00467000
$CEINTRP EQU   $DEVFLG2                                                 00468000
$TESTMDE EQU   $DEVFLG2                                                 00469000
$DEVALOC EQU   $DEVFLG2                                                 00470000
$ALLDATA EQU   $DEVFLG2                                                 00471000
$ENDCNTL EQU   $DEVFLG2                                                 00472000
$CTLDEV  EQU   $DEVFLG2                                                 00473000
$NOCDS   EQU   $DEVFLG2                                                 00474000
$DATAIN  EQU   $DEVFLG2                                                 00475000
$PRIMARY EQU   $DEVFLG1                                                 00476000
$DVCTBYT EQU   $INTOCC                                                  00477000
$DEVACT  EQU   $DEVFLG1                                                 00478000
$DVLGMDE EQU   $ATTNEXP                                                 00479000
$DVSPRM  EQU   $EVNCPLT                                                 00480000
$GRABBED EQU   $DEVFLG1                                                 00481000
$CATASTR EQU   $DEVFLG1                                                 00482000
$LETGO   EQU   $DEVFLG1                                                 00483000
$CURELEM EQU   $$SYMNME+4                                               00484000
$MSGOTSD EQU   $$SYMNME                                                 00485000
$EXTDEV  EQU   $DEVCDS+11                                               00486000
@NM00044 EQU   $DEVSDCF                                                 00487000
$NOTPRIM EQU   $DEVSDCF                                                 00488000
@NM00043 EQU   $DEVCDSF                                                 00489000
@NM00042 EQU   $DEVCDSF                                                 00490000
@NM00041 EQU   $DEVCDSF                                                 00491000
$CDSNAME EQU   $DEVCDSF                                                 00492000
$EXTRN   EQU   $DEVCDSF                                                 00493000
$CEVOLUM EQU   $DEVCDSF                                                 00494000
$SHARD   EQU   $DEVCDSF                                                 00495000
$DEVFPM  EQU   $DEVCDSF                                                 00496000
$DEVCNT  EQU   $DEVCDS+8                                                00497000
$DEVTYPE EQU   $DEVFEAT+3                                               00498000
$DEVCLAS EQU   $DEVFEAT+2                                               00499000
$DEVFRRS EQU   $DEVFEAT+1                                               00500000
$DEVMOD  EQU   $DEVFEAT                                                 00501000
$DEVRDGT EQU   @NM00039+1                                               00502000
$DEVCTLU EQU   @NM00039+1                                               00503000
$DEVCHAN EQU   @NM00039                                                 00504000
@NM00040 EQU   @NM00039                                                 00505000
$CTINDX  EQU   $DEVUNAD                                                 00506000
$FLAG16  EQU   $COMMFLG+15                                              00507000
$FLAG15  EQU   $COMMFLG+14                                              00508000
$FLAG14  EQU   $COMMFLG+13                                              00509000
$TEP2ND  EQU   $FLAG13                                                  00510000
$TEP1ST  EQU   $FLAG13                                                  00511000
$CATMSG  EQU   $FLAG13                                                  00512000
$PRMPTSW EQU   $FLAG13                                                  00513000
$DEVENT  EQU   $FLAG13                                                  00514000
$OLTMACC EQU   $FLAG13                                                  00515000
$LGON    EQU   $FLAG13                                                  00516000
$CTLOGON EQU   $FLAG13                                                  00517000
@NM00038 EQU   $FLAG12                                                  00518000
$VARYINP EQU   $FLAG12                                                  00519000
$ENDTEST EQU   $FLAG12                                                  00520000
$VRYHRD  EQU   $FLAG12                                                  00521000
$VRYSFT  EQU   $FLAG12                                                  00522000
$POSTFLG EQU   $FLAG12                                                  00523000
$OPTMSG  EQU   $FLAG12                                                  00524000
$FEORCAT EQU   $FLAG11                                                  00525000
@NM00037 EQU   $FLAG11                                                  00526000
@NM00036 EQU   $FLAG10                                                  00527000
$INBND   EQU   $FLAG10                                                  00528000
$WAITFLG EQU   $FLAG10                                                  00529000
$DPRINT  EQU   $FLAG10                                                  00530000
$HOLD    EQU   $FLAG9                                                   00531000
$NOTRRCH EQU   $FLAG9                                                   00532000
@NM00035 EQU   $FLAG9                                                   00533000
$COPY    EQU   $FLAG9                                                   00534000
$LSTLNSW EQU   $FLAG9                                                   00535000
$MULLNSW EQU   $FLAG9                                                   00536000
$REMSW   EQU   $FLAG9                                                   00537000
$IGRES   EQU   $FLAG9                                                   00538000
$TCECM   EQU   $FLAG8                                                   00539000
$VS2     EQU   $FLAG8                                                   00540000
$VS1     EQU   $FLAG8                                                   00541000
$EDOS    EQU   $FLAG8                                                   00542000
@NM00034 EQU   $FLAG8                                                   00543000
$TWOWAY  EQU   $FLAG8                                                   00544000
@NM00033 EQU   $FLAG8                                                   00545000
$RCVMSG  EQU   $FLAG7                                                   00546000
$RCVRFLG EQU   $FLAG7                                                   00547000
$SNDRFLG EQU   $FLAG7                                                   00548000
$LDOIS   EQU   $FLAG7                                                   00549000
$DCONTCT EQU   $FLAG7                                                   00550000
$EXIOWAT EQU   $FLAG7                                                   00551000
$2NDDATA EQU   $FLAG7                                                   00552000
$1STDATA EQU   $FLAG7                                                   00553000
$CIREQ   EQU   $FLAG6                                                   00554000
$ABTERM  EQU   $ABNDBIT                                                 00555000
$DISCREQ EQU   $FLAG6                                                   00556000
$DISCISS EQU   $FLAG6                                                   00557000
$CHANGE  EQU   $FLAG6                                                   00558000
$CTERROR EQU   $FLAG6                                                   00559000
$RECAL11 EQU   $FLAG6                                                   00560000
@NM00032 EQU   $FLAG5                                                   00561000
$PROGCK  EQU   $CANCEL                                                  00562000
$PRINTAP EQU   $FLAG5                                                   00563000
@NM00031 EQU   $FLAG5                                                   00564000
$MSG922  EQU   $FLAG5                                                   00565000
$CT924   EQU   $FLAG5                                                   00566000
$FSTCAT  EQU   $FLAG5                                                   00567000
$FSTFE   EQU   $FLAG5                                                   00568000
$ACTOPND EQU   $FLAG4                                                   00569000
$ACQCUTT EQU   $FLAG4                                                   00570000
$CLSSACT EQU   $FLAG4                                                   00571000
$BACKINT EQU   $FLAG4                                                   00572000
$DMSGSW  EQU   $FLAG4                                                   00573000
$TSTDEVP EQU   $FLAG4                                                   00574000
$APRQPER EQU   $FLAG4                                                   00575000
$OPCOM   EQU   $FLAG4                                                   00576000
$NEWAP   EQU   $FLAG3                                                   00577000
$ALTPRTR EQU   $FLAG3                                                   00578000
$OPTERR  EQU   $FLAG3                                                   00579000
$PRTONLY EQU   $FLAG3                                                   00580000
$REQSTOR EQU   $FLAG3                                                   00581000
$LOGOFFE EQU   $FLAG3                                                   00582000
$TSTERR  EQU   $FLAG3                                                   00583000
$DEVERR  EQU   $FLAG3                                                   00584000
$PARTIAL EQU   $FLAG2                                                   00585000
$NRMTERM EQU   $FLAG2                                                   00586000
$VALDTST EQU   $FLAG2                                                   00587000
$VALDDEV EQU   $FLAG2                                                   00588000
$DBLSLSH EQU   $FLAG2                                                   00589000
$NDR     EQU   $FLAG2                                                   00590000
@NM00030 EQU   $FLAG2                                                   00591000
$OLTACT  EQU   $FLAG1                                                   00592000
$NORELDV EQU   $FLAG1                                                   00593000
@NM00029 EQU   $FLAG1                                                   00594000
$OPTCHNG EQU   $FLAG1                                                   00595000
$DEVCHNG EQU   $FLAG1                                                   00596000
$TESTCNG EQU   $FLAG1                                                   00597000
$CNSLFG  EQU   $FLAG1                                                   00598000
$TEP3RD  EQU   $FLAG1                                                   00599000
@NM00028 EQU   $CDA+120                                                 00600000
$CUCNT   EQU   $CDA+118                                                 00601000
@NM00027 EQU   $CDA+117                                                 00602000
$PRTFORM EQU   $CDA+116                                                 00603000
$OPISCNT EQU   $CDA+114                                                 00604000
$OPNDCNT EQU   $CDA+112                                                 00605000
$GETMSZE EQU   $CDA+110                                                 00606000
$GRCNTS  EQU   $CDA+108                                                 00607000
$CTLCNT  EQU   $CDA+106                                                 00608000
$ACTLVL  EQU   $CDA+105                                                 00609000
$PRNTLVL EQU   $CDA+104                                                 00610000
$ERRCNTA EQU   $CDA+102                                                 00611000
$TLCNT   EQU   $CDA+100                                                 00612000
$TIMEALW EQU   $CDA+96                                                  00613000
$PTRAREA EQU   $CDA+92                                                  00614000
$GETMPTR EQU   $CDA+88                                                  00615000
$R13PTRT EQU   $CDA+84                                                  00616000
$R13PTR  EQU   $CDA+80                                                  00617000
$TEPEND  EQU   $CDA+76                                                  00618000
$PLINKDL EQU   $CDA+72                                                  00619000
$TEPBEGN EQU   $CDA+68                                                  00620000
$HIGHADR EQU   $HIMOREC                                                 00621000
$LOMOREC EQU   $CDA+56                                                  00622000
$LOWADDR EQU   $OLTPTR                                                  00623000
$ENDCOMM EQU   $CDA+48                                                  00624000
$COMMON  EQU   $RCA                                                     00625000
$SLASHAD EQU   $CDA+32                                                  00626000
$PASSON  EQU   $CDA+28                                                  00627000
$TOLBRTB EQU   $CDA+24                                                  00628000
$SCTPTR8 EQU   $CDA+20                                                  00629000
$SCTPTR  EQU   $CDA+16                                                  00630000
$TBWDPTR EQU   $CDA+12                                                  00631000
$TFWDPTR EQU   $CDA+8                                                   00632000
@NM00026 EQU   $CDA                                                     00633000
@NM00025 EQU   $SCTTBLE+98                                              00634000
$SCTLWTC EQU   $SCTTBLE+96                                              00635000
$SCTLWTA EQU   $SCTTBLE+92                                              00636000
#EXT     EQU   $SCTTBLE+88                                              00637000
#PASS    EQU   $SCTTBLE+84                                              00638000
#TABLE   EQU   $SCTTBLE+80                                              00639000
#MSGIDAC EQU   $SCTTBLE+78                                              00640000
@NM00024 EQU   $SCTTBLE+71                                              00641000
$RETMASK EQU   $SCTTBLE+70                                              00642000
$R249255 EQU   $ROUTMSK+29                                              00643000
$R241248 EQU   $ROUTMSK+28                                              00644000
$R233240 EQU   $ROUTMSK+27                                              00645000
$R225232 EQU   $ROUTMSK+26                                              00646000
$R217224 EQU   $ROUTMSK+25                                              00647000
$R209216 EQU   $ROUTMSK+24                                              00648000
$R201208 EQU   $ROUTMSK+23                                              00649000
$R193200 EQU   $ROUTMSK+22                                              00650000
$R185192 EQU   $ROUTMSK+21                                              00651000
$R177184 EQU   $ROUTMSK+20                                              00652000
$R169176 EQU   $ROUTMSK+19                                              00653000
$R161168 EQU   $ROUTMSK+18                                              00654000
$R153160 EQU   $ROUTMSK+17                                              00655000
$R145152 EQU   $ROUTMSK+16                                              00656000
$R137144 EQU   $ROUTMSK+15                                              00657000
$R129136 EQU   $ROUTMSK+14                                              00658000
$R121128 EQU   $ROUTMSK+13                                              00659000
$R113120 EQU   $ROUTMSK+12                                              00660000
$R105112 EQU   $ROUTMSK+11                                              00661000
$R097104 EQU   $ROUTMSK+10                                              00662000
$R089096 EQU   $ROUTMSK+9                                               00663000
$R081088 EQU   $ROUTMSK+8                                               00664000
$R073080 EQU   $ROUTMSK+7                                               00665000
$R065072 EQU   $ROUTMSK+6                                               00666000
$R057064 EQU   $ROUTMSK+5                                               00667000
$R049056 EQU   $ROUTMSK+4                                               00668000
$R041048 EQU   $ROUTMSK+3                                               00669000
$R033040 EQU   $ROUTMSK+2                                               00670000
$R025032 EQU   $ROUTMSK+1                                               00671000
$R017024 EQU   $ROUTMSK                                                 00672000
$TOTFLG2 EQU   $SCTTBLE+39                                              00673000
@NM00023 EQU   $TOTFLG1                                                 00674000
@NM00022 EQU   $TOTFLG1                                                 00675000
@NM00021 EQU   $TOTFLG1                                                 00676000
$CURELOD EQU   $TOTFLG1                                                 00677000
$CTEQTT  EQU   $TOTFLG1                                                 00678000
@NM00020 EQU   $TOTFLG1                                                 00679000
@NM00019 EQU   $TOTFLG1                                                 00680000
$LINESHR EQU   $TOTFLG1                                                 00681000
@NM00018 EQU   $OLTFLG2                                                 00682000
@NM00017 EQU   $OLTFLG2                                                 00683000
@NM00016 EQU   $OLTFLG2                                                 00684000
@NM00015 EQU   $OLTFLG2                                                 00685000
@NM00014 EQU   $OLTFLG2                                                 00686000
@NM00013 EQU   $OLTFLG2                                                 00687000
@NM00012 EQU   $OLTFLG2                                                 00688000
$TALK    EQU   $OLTFLG2                                                 00689000
$DYCOM   EQU   $OLTFLGS                                                 00690000
@NM00011 EQU   $OLTFLGS                                                 00691000
$TRACE   EQU   $OLTFLGS                                                 00692000
$RETCODE EQU   $OLTFLGS                                                 00693000
$CONTCB  EQU   $OLTFLGS                                                 00694000
$RETAIN  EQU   $OLTFLGS                                                 00695000
$CLEANRT EQU   $OLTFLGS                                                 00696000
$MANINTV EQU   $OLTFLGS                                                 00697000
$OLTSIZE EQU   $SCTTBLE+34                                              00698000
$QSCTMOD EQU   $EXECFLG                                                 00699000
$CTRLMOD EQU   $EXECFLG                                                 00700000
$CLEANUP EQU   $EXECFLG                                                 00701000
$LSTPDEV EQU   $EXECFLG                                                 00702000
$ERRCNT  EQU   $EXECFLG                                                 00703000
$RTNSLCT EQU   $EXECFLG                                                 00704000
$MULTDEV EQU   $EXECFLG                                                 00705000
@NM00010 EQU   $EXECFLG                                                 00706000
$RMSKCNT EQU   $SCTTBLE+32                                              00707000
$SYNAME  EQU   $CDS8T19+4                                               00708000
$EXTSIG  EQU   $CDS8T19+3                                               00709000
$CDFLGS  EQU   $CDS8T19+1                                               00710000
$CDSCNT  EQU   $CDS8T19                                                 00711000
$PDEVDSC EQU   $SCTTBLE+16                                              00712000
$PDEVADR EQU   $SCTTBLE+12                                              00713000
$COMMCN  EQU   $CDSFLGS                                                 00714000
$CUSTSYM EQU   $CDSFLGS                                                 00715000
$TWOCHSW EQU   $CDSFLGS                                                 00716000
$SYMNAME EQU   $CDSFLGS                                                 00717000
$EXTINTC EQU   $CDSFLGS                                                 00718000
$CEVOL   EQU   $CDSFLGS                                                 00719000
$SHARED  EQU   $CDSFLGS                                                 00720000
$FPM     EQU   $CDSFLGS                                                 00721000
$LASTSUB EQU   $PDEVFLG                                                 00722000
@NM00009 EQU   $PDEVFLG                                                 00723000
@NM00008 EQU   $PDEVFLG                                                 00724000
@NM00007 EQU   $PDEVFLG                                                 00725000
$LASTDEV EQU   $PDEVFLG                                                 00726000
@NM00006 EQU   $PDEVFLG                                                 00727000
$EXFILPT EQU   $PDEVFLG                                                 00728000
$FPMOLD  EQU   $PDEVFLG                                                 00729000
$TSSSYM  EQU   $SCTTBLE+8                                               00730000
$SCTLEVL EQU   $SCTTBLE+7                                               00731000
$DRIVER  EQU   $SCTTBLE+6                                               00732000
$RT0916  EQU   $SCTTBLE+5                                               00733000
$RT0108  EQU   $SCTTBLE+4                                               00734000
$LOOPTST EQU   $ERROPT                                                  00735000
$LOOPERR EQU   $ERROPT                                                  00736000
$NERRPRT EQU   $ERROPT                                                  00737000
$NOCNTRL EQU   $ERROPT                                                  00738000
$ALTPRNT EQU   $ERROPT                                                  00739000
$CATERR  EQU   $ERROPT                                                  00740000
$ASTERIK EQU   $ERROPT                                                  00741000
$TESTERR EQU   $ERROPT                                                  00742000
$FSTCOMM EQU   $TESTOPT                                                 00743000
$INDEFLP EQU   $TESTOPT                                                 00744000
$NOPRT   EQU   $TESTOPT                                                 00745000
$PARAPRT EQU   $TESTOPT                                                 00746000
@NM00005 EQU   $TESTOPT                                                 00747000
$ERRLPCT EQU   $SCTTBLE                                                 00748000
$TLTEND  EQU   $RCAAREA+945                                             00749000
$CNSLID  EQU   $RCAAREA+936                                             00750000
$EXITSAV EQU   $RCAAREA+864                                             00751000
$TRASCII EQU   $RCAAREA+608                                             00752000
@NM00004 EQU   $RCAAREA+605                                             00753000
$VTAMEND EQU   $RCAFLG                                                  00754000
$TPPOSTD EQU   $RCAFLG                                                  00755000
$NEWCT   EQU   $RCAFLG                                                  00756000
$ABNDALL EQU   $RCAFLG                                                  00757000
$CUTESTB EQU   $RCAFLG                                                  00758000
$CONSOLE EQU   $RCAFLG                                                  00759000
$TPLOGON EQU   $RCAFLG                                                  00760000
$UPDATE  EQU   $RCAFLG                                                  00761000
$DEVAREA EQU   $RCAAREA+600                                             00762000
$CTDVAR  EQU   $RCAAREA+596                                             00763000
$BUFFS   EQU   $RCAAREA+464                                             00764000
$TLTNIB  EQU   $CONSTNT+140                                             00765000
$TLTPRPL EQU   $CONSTNT+20                                              00766000
@NM00003 EQU   $CONSTNT+4                                               00767000
@NM00002 EQU   $CONSTNT+2                                               00768000
$USECNT  EQU   $CONSTNT                                                 00769000
$CURRTWA EQU   $POINTER+140                                             00770000
$CTNAME  EQU   $POINTER+132                                             00771000
$CTARGX  EQU   $POINTER+128                                             00772000
$COMINT  EQU   $POINTER+120                                             00773000
$QUEHNDL EQU   $POINTER+116                                             00774000
@NM00001 EQU   $POINTER+36                                              00775000
$RTNPTR  EQU   $POINTER+32                                              00776000
$TLTECB2 EQU   $POINTER+28                                              00777000
$TLTECB1 EQU   $POINTER+24                                              00778000
$CLEANP  EQU   $POINTER+20                                              00779000
$ABEND   EQU   $POINTER+16                                              00780000
$LSTAREA EQU   $POINTER+12                                              00781000
$FSTAREA EQU   $POINTER+8                                               00782000
$CVTSAVE EQU   $POINTER+4                                               00783000
$TOLTEP  EQU   $POINTER                                                 00784000
$TLTACB  EQU   $RCAAREA                                                 00785000
.@UNREFD ANOP                          END UNREFERENCED COMPONENTS      00786000
@RT00049 EQU   S28C0090                                                 00787000
@RT00056 EQU   S28C0001                                                 00788000
@RT00058 EQU   S28C0090                                                 00789000
@RT00063 EQU   S28C0090                                                 00790000
@RT00068 EQU   S28C0003                                                 00791000
@RT00070 EQU   S28C0003                                                 00792000
@RT00078 EQU   S28C0092                                                 00793000
@RT00080 EQU   S28C0092                                                 00794000
@ENDDATA EQU   *                                                        00795000
         END   ISTSC028,(C'PLS1531',0702,78337)                         00796000
./  ADD  SSI=83341939,NAME=ISTSC033
         TITLE 'ISTSC033 - RECEIVE FUNCTION'                            00001000
*  IBM DISK OPERATING SYSTEM                                            00002000
*  TOLTEP                                                               00003000
           ISEQ 73,80                                                   00004000
ISTSC033 CSECT ,                                                   0002 00005000
@MAINENT DS    0H                                                  0002 00006000
         USING *,@15                                               0002 00007000
         B     @PROLOG                                             0002 00008000
         DC    AL2(@EP00002-@MAINENT)                                   00009000
         DC    AL1(16)                                             0002 00010000
         DC    C'ISTSC033  78.336'                                 0002 00011000
S33C3000 DS    0H                                                  0002 00012000
         USING *,@15                                               0002 00013000
         B     @PROLOG                                             0002 00014000
         DC    AL2(@EP00234-S33C3000)                                   00015000
         ENTRY S33C3000                                                 00016000
         DROP  @15                                                      00017000
@PROLOG  ST    @14,12(,@13)                                        0002 00018000
         STM   @00,@12,20(@13)                                     0002 00019000
         BALR  @12,0                                               0002 00020000
@PSTART  DS    0H                                                  0002 00021000
         USING @PSTART,@12                                         0002 00022000
         AH    @15,4(,@15)                                         0002 00023000
         BR    @15                                                 0002 00024000
@EP00002 DS    0H                                                  0003 00025000
*   R14=R13;                        /* CALLER SAVEAREA PTR           */ 00026000
         LR    R14,R13                                             0076 00027000
*   R13=ADDR(SVESC033);             /* PT TO MY SAVEAREA             */ 00028000
         LA    R13,SVESC033(,WAPTR)                                0077 00029000
*   BACKSAVE(3)=R13;                /* PUT MY SAVE PTR IN CALLERS    */ 00030000
         STCM  R13,15,BACKSAVE+8(R14)                              0078 00031000
*   SVESC033(2)=R14;                /* SAVE CALLER SAVE PTR          */ 00032000
         ST    R14,SVESC033+4(,WAPTR)                              0079 00033000
*   RFY                                                            0080 00034000
*    (R13,                                                         0080 00035000
*     R14) UNRSTD;                                                 0080 00036000
*   IF $RCVRFLG=ON THEN             /* RECALL FROM RCM               */ 00037000
         TM    $RCVRFLG(WAPTR),B'00000010'                         0081 00038000
         BO    @RT00081                                            0081 00039000
*     GOTO S33C0500;                /* YES, SEE IF RECEIVE IS DONE   */ 00040000
*   I=R3;                           /* SAVE INDEX TO DEV TABLE       */ 00041000
         LR    I,R3                                                0083 00042000
*   RCVPTR=R1;                      /* BASE FOR RECV PARM LIST       */ 00043000
         ST    R1,RCVPTR                                           0084 00044000
*   RFY                                                            0085 00045000
*    (R1,                                                          0085 00046000
*     R3) UNRSTD;                                                  0085 00047000
*   RFY                                                            0086 00048000
*     RCVMAP BASED(RCVPTR);         /* SET BASE                      */ 00049000
*                                                                  0086 00050000
*   /*****************************************************************/ 00051000
*   /*                                                               */ 00052000
*   /* PROCESS RECEIVE REQUEST                                       */ 00053000
*   /*                                                               */ 00054000
*   /*****************************************************************/ 00055000
*                                                                  0087 00056000
*S33C0300:                                                         0087 00057000
*   RPLKEEP=ON;                     /* TURN KEEP FLAG ON IN RPL      */ 00058000
S33C0300 DS    0H                                                  0088 00059000
*   RPLTRUNC=OFF;                   /* TURN TRUNC FLAG OFF           */ 00060000
*   RPLNIBTK=OFF;                   /* TURN NIBTK FLAG OFF   @AZ17856*/ 00061000
         LA    @14,1856                                            0089 00062000
         ALR   @14,WAPTR                                           0089 00063000
         OI    RPLKEEP(@14),B'01000000'                            0089 00064000
         NI    RPLTRUNC(@14),B'11001111'                           0089 00065000
*   IF $RCVTRC=ON THEN              /* TRUNCATE EXCESS DATA          */ 00066000
         L     @08,RCVPTR                                          0090 00067000
         TM    $RCVTRC(@08),B'10000000'                            0090 00068000
         BNO   @RF00090                                            0090 00069000
*     DO;                           /* YES                           */ 00070000
*       RPLKEEP=OFF;                /* TURN KEEP OFF                 */ 00071000
*       RPLTRUNC=ON;                /* TRUNC EXCESS DATA ON          */ 00072000
         OI    RPLTRUNC(@14),B'00100000'                           0093 00073000
         NI    RPLKEEP(@14),B'10111111'                            0093 00074000
*     END;                                                         0094 00075000
*   RFY                                                            0095 00076000
*    (R1,                                                          0095 00077000
*     R3,                                                          0095 00078000
*     R4,                                                          0095 00079000
*     R5) RSTD;                                                    0095 00080000
@RF00090 DS    0H                                                  0096 00081000
*   R1=ADDR($TLTRPL3);              /* GET RPL ADDRESS               */ 00082000
         LA    R1,$TLTRPL3(,WAPTR)                                 0096 00083000
*   R3=$RCVARA;                     /* OLT DATA AREA                 */ 00084000
         L     @14,RCVPTR                                          0097 00085000
         L     R3,$RCVARA(,@14)                                    0097 00086000
*   R4=$RCVARL;                     /* DATA AREA LENGTH              */ 00087000
         LH    R4,$RCVARL(,@14)                                    0098 00088000
*   R5=$CID(I);                     /* CID OF DEVICE FOR RECEIVE     */ 00089000
         LR    @08,I                                               0099 00090000
         MH    @08,@CH00706                                        0099 00091000
         ST    @08,@TF00001                                        0099 00092000
         ALR   @08,WAPTR                                           0099 00093000
         ICM   R5,15,$CID-68(@08)                                  0099 00094000
*   IF $RCVSESS=ON THEN             /* SESSION PARMS REQUESTED       */ 00095000
         TM    $RCVSESS(@14),B'01000000'                           0100 00096000
         BNO   @RF00100                                            0100 00097000
*     DO;                           /* YES                           */ 00098000
*       N=MIN(R4,7);                /* GET BIND LENGTH        @DM0903*/ 00099000
         LA    N,7                                                 0102 00100000
         CR    N,R4                                                0102 00101000
         BNH   *+6                                                      00102000
         LR    N,R4                                                0102 00103000
*       N=N-1;                      /* REDUCE FOR NUMBER OF BYTES TO    00104000
*                                      MOVE                   @DM0903*/ 00105000
         BCTR  N,0                                                 0103 00106000
*       R15=12;                     /* UNRECOV ERROR                 */ 00107000
         LA    R15,12                                              0104 00108000
*       IF N<=0 THEN                /* IF TO SHORT TO MOVE DATA    0105 00109000
*                                                             @DM0903*/ 00110000
         LTR   N,N                                                 0105 00111000
         BNP   @RT00105                                            0105 00112000
*         GO TO S33C9999;           /* EXIT ON ERROR          @DM0903*/ 00113000
*       R15=0;                      /* SET GOOD RETURN CODE   @DM0903*/ 00114000
         SLR   R15,R15                                             0107 00115000
*       RFY                                                        0108 00116000
*         SESPMAP BASED(R3);                                       0108 00117000
*       SESPMAP(2:N+1)=$DEVSESP(I,1:N);/* MOVE BIND PARMS     @DM0903*/ 00118000
         LR    @14,N                                               0109 00119000
         BCTR  @14,0                                               0109 00120000
         LR    @11,WAPTR                                           0109 00121000
         AL    @11,@TF00001                                        0109 00122000
         EX    @14,@SM01112                                        0109 00123000
*       GOTO S33C9999;              /* RETURN                        */ 00124000
         B     S33C9999                                            0110 00125000
*     END;                          /* END OF RETURNING THE SESSPARM    00126000
*                                      DATA                          */ 00127000
*                                                                  0111 00128000
*   /*****************************************************************/ 00129000
*   /*                                                               */ 00130000
*   /* COMPUTE TIME LIMIT FOR RECEIVE                                */ 00131000
*   /*                                                               */ 00132000
*   /*****************************************************************/ 00133000
*                                                                  0112 00134000
*   TIME=$RCVTIME;                  /* TIME FROM PARM LIST           */ 00135000
@RF00100 L     @14,RCVPTR                                          0112 00136000
         LH    @14,$RCVTIME(,@14)                                  0112 00137000
         STH   @14,TIME                                            0112 00138000
*   IF TIME>1800 THEN               /* INVALID TIME          @ZD10889*/ 00139000
         C     @14,@CF01070                                        0113 00140000
         BNH   @RF00113                                            0113 00141000
*     DO;                           /* GIVE BACK BAD RETURN CODE   0114 00142000
*                                                            @ZD10889*/ 00143000
*       R15=12;                     /* SET RETURN CODE       @ZD10889*/ 00144000
         LA    R15,12                                              0115 00145000
*       GOTO S33C9999;              /* EXIT                  @ZD10889*/ 00146000
         B     S33C9999                                            0116 00147000
*     END;                          /* END BAD RETURN CODE PROCESSING   00148000
*                                                            @ZD10889*/ 00149000
*   IF TIME<=0 THEN                 /* TIME SPECIFIED?               */ 00150000
@RF00113 LH    @14,TIME                                            0118 00151000
         LTR   @14,@14                                             0118 00152000
         BP    @RF00118                                            0118 00153000
*     TIME=30;                      /* NO,GIVE HIM 30 SECS           */ 00154000
         MVC   TIME(2),@CH00515                                    0119 00155000
*   RFY                                                            0120 00156000
*     R1 UNRSTD;                                                   0120 00157000
@RF00118 DS    0H                                                  0121 00158000
*   CALL S2FC2000(TIME,$WAITIME);   /* TIME WHEN RECEIVE EXPIRES     */ 00159000
*                                                                  0121 00160000
         LA    @14,TIME                                            0121 00161000
         ST    @14,@AL00001                                        0121 00162000
         LA    @14,$WAITIME(,WAPTR)                                0121 00163000
         ST    @14,@AL00001+4                                      0121 00164000
         L     @15,@CV01071                                        0121 00165000
         LA    @01,@AL00001                                        0121 00166000
         BALR  @14,@15                                             0121 00167000
*   /*****************************************************************/ 00168000
*   /*                                                               */ 00169000
*   /* SET UP AND ISSUE RECEIVE                                      */ 00170000
*   /*                                                               */ 00171000
*   /*****************************************************************/ 00172000
*                                                                  0122 00173000
*   $RCVMSG=ON;                     /* SET RECEIVE ISSUED FLAG       */ 00174000
         OI    $RCVMSG(WAPTR),B'00000001'                          0122 00175000
*   RFY                                                            0123 00176000
*     R1 RSTD;                                                     0123 00177000
*   R1=ADDR($TLTRPL3);                                             0124 00178000
         LA    R1,$TLTRPL3(,WAPTR)                                 0124 00179000
*   R1->RPLUSFLD=WAPTR;             /* SAVE WAPTR            @DM30415*/ 00180000
         ST    WAPTR,RPLUSFLD(,R1)                                 0125 00181000
*   GEN;                                                           0126 00182000
         RECEIVE RPL=(1),ARG=(R5),AREA=(R3),AREALEN=(R4),              X00183000
               RTYPE=(DFSYN,DFASY,RESP),OPTCD=(SPEC,Q,ASY),            X00184000
               EXIT=S33C1000                                            00185000
*   IF R15¬=0 THEN                  /* BAD CID                       */ 00186000
         LTR   R15,R15                                             0127 00187000
         BZ    @RF00127                                            0127 00188000
*     DO;                           /* YES                           */ 00189000
*       R15=12;                                                    0129 00190000
         LA    R15,12                                              0129 00191000
*       GOTO S33C9999;                                             0130 00192000
         B     S33C9999                                            0130 00193000
*     END;                                                         0131 00194000
*   RFY                                                            0132 00195000
*    (R3,                                                          0132 00196000
*     R4) UNRSTD;                                                  0132 00197000
@RF00127 DS    0H                                                  0133 00198000
*   IF $RCVMSG=ON THEN              /* RECEIVE DONE?                 */ 00199000
         TM    $RCVMSG(WAPTR),B'00000001'                          0133 00200000
         BNO   @RF00133                                            0133 00201000
*     DO;                           /* NO                            */ 00202000
*       $RCVRFLG=ON;                /* TELL RCM TO RECALL            */ 00203000
         OI    $RCVRFLG(WAPTR),B'00000010'                         0135 00204000
*       GOTO S33C9999;              /* RETURN                        */ 00205000
         B     S33C9999                                            0136 00206000
*     END;                                                         0137 00207000
*   GOTO S33C0600;                  /* RECEIVE DONE CONTINUE         */ 00208000
         B     S33C0600                                            0138 00209000
*S33C0500:                                                         0139 00210000
*   IF $RCVMSG=ON THEN              /* RECEIVE DONE?                 */ 00211000
S33C0500 TM    $RCVMSG(WAPTR),B'00000001'                          0139 00212000
         BNO   @RF00139                                            0139 00213000
*     DO;                           /* NO, CHECK TIME                */ 00214000
*       CALL ISTSC026;              /* GET CURRENT TIME              */ 00215000
         L     @15,@CV01074                                        0141 00216000
         BALR  @14,@15                                             0141 00217000
*       R5=RPLARG;                  /* PICK UP CID                   */ 00218000
         L     R5,RPLARG+1856(,WAPTR)                              0142 00219000
*       IF R1<$WAITIME THEN         /* TIME EXPIRED?                 */ 00220000
         CL    R1,$WAITIME(,WAPTR)                                 0143 00221000
         BL    @RT00143                                            0143 00222000
*         GOTO S33C9999;            /* NO RETURN TO RCM              */ 00223000
*       CALL S33C2000;              /* ISSUE A RESETSR               */ 00224000
         BAL   @14,S33C2000                                        0145 00225000
*       IF R15=12 THEN              /* BAD RC FROM RESETSR           */ 00226000
         C     R15,@CF00369                                        0146 00227000
         BNE   @RF00146                                            0146 00228000
*         DO;                       /* ERROR RETURN CODE FROM RESETSR*/ 00229000
*           $RCVMSG=OFF;            /* RESET RECEIVE OUT FLAG        */ 00230000
*           $RCVRFLG=OFF;           /* RESET RECALL FLAG             */ 00231000
         NI    $RCVMSG(WAPTR),B'11111100'                          0149 00232000
*           GOTO S33C9999;                                         0150 00233000
         B     S33C9999                                            0150 00234000
*         END;                      /* END OF BAD RET CODE FROM    0151 00235000
*                                      RESETSR                       */ 00236000
*       IF $RCVMSG=ON THEN          /* RECEIVE COMPLETE BEFOR RST    */ 00237000
@RF00146 TM    $RCVMSG(WAPTR),B'00000001'                          0152 00238000
         BNO   @RF00152                                            0152 00239000
*         DO;                       /* NO, RESETSR DID IT            */ 00240000
*           $RCVMSG=OFF;            /* RESET RECEIVE ISSUED FLAG     */ 00241000
*           $RCVRFLG=OFF;           /* SET RCM RECALL FLAG OFF       */ 00242000
         NI    $RCVMSG(WAPTR),B'11111100'                          0155 00243000
*           R15=16;                 /* SET TIMEOUT RC FOR OLT        */ 00244000
         LA    R15,16                                              0156 00245000
*           GOTO S33C9999;          /* RETURN TO OLT                 */ 00246000
         B     S33C9999                                            0157 00247000
*         END;                                                     0158 00248000
*     END;                                                         0159 00249000
*                                                                  0159 00250000
@RF00152 DS    0H                                                  0160 00251000
*   /*****************************************************************/ 00252000
*   /*                                                               */ 00253000
*   /* RECEIVE COMPLETED SUCCESSFULLY, BUILD TECB ENTRY              */ 00254000
*   /*                                                               */ 00255000
*   /*****************************************************************/ 00256000
*                                                                  0160 00257000
*S33C0600:                                                         0160 00258000
*   $RCVRFLG=OFF;                   /* SET RCM RECALL FLAG OFF       */ 00259000
@RF00139 DS    0H                                                  0160 00260000
S33C0600 NI    $RCVRFLG(WAPTR),B'11111101'                         0160 00261000
*   IF RPLRTNCD>'04'X THEN          /* BAD RC FROM RECEIVE           */ 00262000
         CLI   RPLRTNCD+1856(WAPTR),4                              0161 00263000
         BNH   @RF00161                                            0161 00264000
*     DO;                           /* YES                           */ 00265000
*       R15=12;                                                    0163 00266000
         LA    R15,12                                              0163 00267000
*       GOTO S33C9999;                                             0164 00268000
         B     S33C9999                                            0164 00269000
*     END;                                                         0165 00270000
*   RFY                                                            0166 00271000
*     TECBMAPS BASED($RCVTECB);                                    0166 00272000
@RF00161 DS    0H                                                  0167 00273000
*   IF TECBSNOC<255 THEN            /* REACHED MAX COUNT?            */ 00274000
         L     @14,RCVPTR                                          0167 00275000
         L     @14,$RCVTECB(,@14)                                  0167 00276000
         CLI   TECBSNOC(@14),255                                   0167 00277000
         BNL   @RF00167                                            0167 00278000
*     TECBSNCT=TECBSNCT+1;          /* INCREASE COUNT                */ 00279000
         LA    @04,1                                               0168 00280000
         SLR   @03,@03                                             0168 00281000
         IC    @03,TECBSNCT(,@14)                                  0168 00282000
         ALR   @04,@03                                             0168 00283000
         STC   @04,TECBSNCT(,@14)                                  0168 00284000
*   IF TECBSNOC<=TECBSNCT THEN      /* ROOM LEFT IN TECB             */ 00285000
@RF00167 L     @14,RCVPTR                                          0169 00286000
         L     @14,$RCVTECB(,@14)                                  0169 00287000
         CLC   TECBSNOC(1,@14),TECBSNCT(@14)                       0169 00288000
         BH    @RF00169                                            0169 00289000
*     DO;                           /* YES                           */ 00290000
*       N=MIN(TECBSNLN-3,25);       /* FIND MIN LENGTH FOR MOVE      */ 00291000
         LA    @04,3                                               0171 00292000
         LH    N,TECBSNLN(,@14)                                    0171 00293000
         SLR   N,@04                                               0171 00294000
         LA    @14,25                                              0171 00295000
         CR    N,@14                                               0171 00296000
         BNH   *+6                                                      00297000
         LR    N,@14                                               0171 00298000
*       IF N>3 THEN                 /* LENGTH = 0?                   */ 00299000
         CR    N,@04                                               0172 00300000
         BNH   @RF00172                                            0172 00301000
*         DO;                       /* NO                            */ 00302000
*                                                                  0173 00303000
*           /*********************************************************/ 00304000
*           /*                                                       */ 00305000
*           /* MOVE RPL DATA TO TECB                                 */ 00306000
*           /*                                                       */ 00307000
*           /*********************************************************/ 00308000
*                                                                  0174 00309000
*           RFY                                                    0174 00310000
*             TECBSEND BASED(ADDR($INBUFR));                       0174 00311000
*           TCBSSEN=RPLSSEI;        /* YES,SYSTEM SENSE TO BUFFER    */ 00312000
         LA    @14,2104                                            0175 00313000
         ALR   @14,WAPTR                                           0175 00314000
         LA    @09,1856                                            0175 00315000
         ALR   @09,WAPTR                                           0175 00316000
         MVC   TCBSSEN(1,@14),RPLSSEI(@09)                         0175 00317000
*           TCBSSENM=RPLSSMI;       /* YES, MODIFIER TO BUFFER       */ 00318000
         IC    @04,RPLSSMI(,@09)                                   0176 00319000
         STC   @04,TCBSSENM(,@14)                                  0176 00320000
*           TCBUSEN=RPLUSNSI;       /* YES, USER SENSE TO BUF        */ 00321000
         MVC   TCBUSEN(2,@14),RPLUSNSI(@09)                        0177 00322000
*           TCBRESP=RPLVTFL2;       /* YES, RESPOND TO BUF           */ 00323000
         LA    @04,1872                                            0178 00324000
         ALR   @04,WAPTR                                           0178 00325000
         MVC   TCBRESP(1,@14),RPLVTFL2(@04)                        0178 00326000
*           TCBRECLN=RPLRLEN;       /* YES, RECLEN TO BUF            */ 00327000
         MVC   TCBRECLN(2,@14),RPLRLEN+2(@09)                      0179 00328000
*           TCBRTYPE=RPLSRTYP;      /* YES, RTYPE TO BUF             */ 00329000
         MVC   TCBRTYPE(1,@14),RPLSRTYP(@04)                       0180 00330000
*           TCBRKCHG=RPLRH3;        /* BRACKET FIELD TO BUF          */ 00331000
         MVC   TCBRKCHG(1,@14),RPLRH3(@04)                         0181 00332000
*           TCBCHAIN=RPLCHN;        /* CHAIN FIELD TO BUF            */ 00333000
         MVC   TCBCHAIN(1,@14),RPLCHN(@04)                         0182 00334000
*           TCBCNTRL=RPLCNTDF;      /* CONTROL TO BUF                */ 00335000
         XC    TCBCNTRL+1(2,@14),TCBCNTRL+1(@14)                   0183 00336000
         MVC   TCBCNTRL(1,@14),RPLCNTDF(@04)                       0183 00337000
*           TCBSEQNO=RPLSEQNO;      /* SEQ NUM TO BUF                */ 00338000
         LA    @04,1916                                            0184 00339000
         ALR   @04,WAPTR                                           0184 00340000
         MVC   TCBSEQNO(2,@14),RPLSEQNO(@04)                       0184 00341000
*           TCBSIGDA=RPLSIGDA;      /* SIGNAL DATA TO BUF            */ 00342000
         MVC   TCBSIGDA(4,@14),RPLSIGDA(@09)                       0185 00343000
*           TCBIBSQ=RPLIBSQ;        /* IBSQAC TO BUF                 */ 00344000
         MVC   TCBIBSQ(1,@14),RPLIBSQ(@04)                         0186 00345000
*           TCBIBSQL=RPLIBSQV;      /* IBSQVAL TO BUF                */ 00346000
         MVC   TCBIBSQL(2,@14),RPLIBSQV(@04)                       0187 00347000
*           TCBOBSQ=RPLOBSQ;        /* OBSQAC TO BUF                 */ 00348000
         MVC   TCBOBSQ(1,@14),RPLOBSQ(@04)                         0188 00349000
*           TCBOBSQL=RPLOBSQV;      /* OBSQVAL TO BUF                */ 00350000
         MVC   TCBOBSQL(2,@14),RPLOBSQV(@04)                       0189 00351000
*           $INBUFR(1:25)=$INBUFR(1:25)&BUFMASK(1:25);/* N OUT UNUSED   00352000
*                                      FLAGS                         */ 00353000
         NC    $INBUFR(25,WAPTR),BUFMASK                           0190 00354000
*           IF RPLFMHDR=ON THEN     /* FMHDR RECEIVED         @DM0911*/ 00355000
         TM    RPLFMHDR(@09),B'00000001'                           0191 00356000
         BNO   @RF00191                                            0191 00357000
*             TCBRTYPE=TCBRTYPE|'80'X;/* YES, SET TECB BIT    @DM0911*/ 00358000
         OI    TCBRTYPE(@14),X'80'                                 0192 00359000
*           TCBSENSE(1:N)=$INBUFR(1:N);/* MOVE SENSE INFO TO TECB    */ 00360000
@RF00191 L     @14,RCVPTR                                          0193 00361000
         L     @14,$RCVTECB(,@14)                                  0193 00362000
         LA    @09,TECBEVT1(,@14)                                  0193 00363000
         SLR   @07,@07                                             0193 00364000
         IC    @07,TECBFDCT(,@14)                                  0193 00365000
         SLR   @04,@04                                             0193 00366000
         IC    @04,TECBFDLN(,@14)                                  0193 00367000
         MR    @06,@04                                             0193 00368000
         ALR   @09,@07                                             0193 00369000
         SLR   @04,@04                                             0193 00370000
         IC    @04,TECBSNOC(,@14)                                  0193 00371000
         MH    @04,TECBSNLN(,@14)                                  0193 00372000
         ALR   @09,@04                                             0193 00373000
         LR    @14,N                                               0193 00374000
         BCTR  @14,0                                               0193 00375000
         EX    @14,@SM01117                                        0193 00376000
*         END;                                                     0194 00377000
*     END;                                                         0195 00378000
@RF00172 DS    0H                                                  0196 00379000
*   RFY                                                            0196 00380000
*     R15 RSTD;                                                    0196 00381000
@RF00169 DS    0H                                                  0197 00382000
*   R15=0;                          /* SET GOOD RETURN CODE          */ 00383000
         SLR   R15,R15                                             0197 00384000
*   GOTO S33C9999;                                                 0198 00385000
*                                                                  0198 00386000
         B     S33C9999                                            0198 00387000
*   /*****************************************************************/ 00388000
*   /*                                                               */ 00389000
*   /* RPL EXIT ROUTINE FOR RECEIVE REQUEST                          */ 00390000
*   /*                                                               */ 00391000
*   /*****************************************************************/ 00392000
*                                                                  0199 00393000
*S33C1000:                                                         0199 00394000
*   RFY                                                            0199 00395000
*     IFGRPL BASED(R1);                                            0199 00396000
S33C1000 DS    0H                                                  0200 00397000
*   RFY                                                            0200 00398000
*    (R2,                                                          0200 00399000
*     R4,                                                          0200 00400000
*     R5,                                                          0200 00401000
*     R13,                                                         0200 00402000
*     R14,                                                         0200 00403000
*     R0) RSTD;                                                    0200 00404000
*   R2=RPLUSFLD;                    /* POINT TO THE TWO              */ 00405000
         L     R2,RPLUSFLD(,R1)                                    0201 00406000
*   RESPECIFY                                                      0202 00407000
*     $RCAAREA BASED($RCA);         /* SET UP ADDRESSABILITY TO RCA  */ 00408000
*   R4=R15;                         /* SAVE ENTRY POINT              */ 00409000
         LR    R4,R15                                              0203 00410000
*   GEN(USING S33C1000,R4);         /* SET UP BASE REG               */ 00411000
         USING S33C1000,R4                                              00412000
*   R5=R14;                         /* SAVE RETURN REG               */ 00413000
         LR    R5,R14                                              0205 00414000
*   R13=ADDR($EXITSAV);             /* PT TO MY SAVE                 */ 00415000
         L     R13,$RCA(,WAPTR)                                    0206 00416000
         LA    R13,$EXITSAV(,R13)                                  0206 00417000
*   GEN;                                                           0207 00418000
         CHECK RPL=(R1)                                                 00419000
*   IF R0=8 THEN                    /* TEMP ERROR                    */ 00420000
         C     R0,@CF00038                                         0208 00421000
         BNE   @RF00208                                            0208 00422000
*     DO;                           /* YES, RE-EXEC REQUEST          */ 00423000
*       GEN;                                                       0210 00424000
         EXECRPL RPL=(1),EXIT=S33C1000                                  00425000
*       GOTO S33C3999;              /* RETURN TO VTAM                */ 00426000
         B     S33C3999                                            0211 00427000
*     END;                                                         0212 00428000
*   IF RPLRTNCD¬='0C'X|             /* ENTRY BECAUSE RESETSR  @DM0906*/ 00429000
*       RPLFDB2¬='0A'X THEN         /* WAS ISSUED                    */ 00430000
@RF00208 CLI   RPLRTNCD(R1),12                                     0213 00431000
         BNE   @RT00213                                            0213 00432000
         CLI   RPLFDB2(R1),10                                      0213 00433000
         BE    @RF00213                                            0213 00434000
@RT00213 DS    0H                                                  0214 00435000
*     $RCVMSG=OFF;                  /* NO, INDICATE RECEIVE DONE     */ 00436000
         NI    $RCVMSG(WAPTR),B'11111110'                          0214 00437000
*   R1=ADDR($TLTECB2);              /* ECB TO BE POSTED              */ 00438000
@RF00213 L     R1,$RCA(,WAPTR)                                     0215 00439000
         LA    R1,$TLTECB2(,R1)                                    0215 00440000
*   CALL I00C1001;                  /* POST ECB                      */ 00441000
         L     @15,@CV01090                                        0216 00442000
         BALR  @14,@15                                             0216 00443000
*S33C3999:                                                         0217 00444000
*   R14=R5;                         /* RESTORE RETURN REG            */ 00445000
S33C3999 LR    R14,R5                                              0217 00446000
*   RFY                                                            0218 00447000
*    (R4,                                                          0218 00448000
*     R5,                                                          0218 00449000
*     R3) UNRSTD;                                                  0218 00450000
*   GEN(BR   R14);                  /* RETURN TO VTAM                */ 00451000
         BR   R14                                                       00452000
*   GEN(DROP  R4);                                                 0220 00453000
*                                                                  0220 00454000
         DROP  R4                                                       00455000
*   /*****************************************************************/ 00456000
*   /*                                                               */ 00457000
*   /* RESETSR FOR TIMED OUT RECEIVES                                */ 00458000
*   /*                                                               */ 00459000
*   /*****************************************************************/ 00460000
*                                                                  0221 00461000
*S33C2000:                                                         0221 00462000
*   PROC OPTIONS(NOSAVE,NOSAVEAREA);                               0221 00463000
         B     @PB00002                                            0221 00464000
S33C2000 DS    0H                                                  0222 00465000
*   DCL                                                            0222 00466000
*     RESETRPL GENERATED CHAR(*);                                  0222 00467000
*   DCL                                                            0223 00468000
*     R14SAVE PTR;                                                 0223 00469000
*   RFY                                                            0224 00470000
*    (R1,                                                          0224 00471000
*     R5,                                                          0224 00472000
*     R14) RSTD;                                                   0224 00473000
*   R14SAVE=R14;                                                   0225 00474000
         LR    R14SAVE,R14                                         0225 00475000
*   R4=$RCA;                        /* GET ACB ADDRESS               */ 00476000
         L     R4,$RCA(,WAPTR)                                     0226 00477000
*   GEN DATA DEFS(RESETRPL);                                       0227 00478000
*   GEN;                                                           0228 00479000
  RESETSR RPL=RESETRPL,ARG=(R5),RTYPE=(DFSYN,DFASY,RESP),              X00480000
               ACB=(R4)                                                 00481000
*   IF R0¬=0 THEN                                                  0229 00482000
         LTR   R0,R0                                               0229 00483000
         BZ    @RF00229                                            0229 00484000
*     R15=12;                       /* CHECK RC FROM RESETSR         */ 00485000
         LA    R15,12                                              0230 00486000
*   R14=R14SAVE;                                                   0231 00487000
@RF00229 LR    R14,R14SAVE                                         0231 00488000
*   RFY                                                            0232 00489000
*    (R1,                                                          0232 00490000
*     R4,                                                          0232 00491000
*     R5,                                                          0232 00492000
*     R14) UNRSTD;                                                 0232 00493000
*   END S33C2000;                                                  0233 00494000
*                                                                  0233 00495000
@EL00002 DS    0H                                                  0233 00496000
@EF00002 DS    0H                                                  0233 00497000
@ER00002 BR    @14                                                 0233 00498000
*   /*****************************************************************/ 00499000
*   /*                                                               */ 00500000
*   /* ENTRY FROM EXTERNAL MODULES FOR ISSUING RESETSR               */ 00501000
*   /*                                                               */ 00502000
*   /*****************************************************************/ 00503000
*                                                                  0234 00504000
*S33C3000:                                                         0234 00505000
*   ENTRY;                                                         0234 00506000
@EP00234 DS    0H                                                  0234 00507000
@EC00234 DS    0H                                                  0235 00508000
*   RFY                                                            0235 00509000
*    (R14,                                                         0235 00510000
*     R13) RSTD;                                                   0235 00511000
*   R14=R13;                                                       0236 00512000
         LR    R14,R13                                             0236 00513000
*   R13=ADDR(SVESC033);                                            0237 00514000
         LA    R13,SVESC033(,WAPTR)                                0237 00515000
*   BACKSAVE(3)=R13;                                               0238 00516000
         STCM  R13,15,BACKSAVE+8(R14)                              0238 00517000
*   SVESC033(2)=R14;                                               0239 00518000
         ST    R14,SVESC033+4(,WAPTR)                              0239 00519000
*   R5=R0;                          /* PUT CID IN REG 5              */ 00520000
         LR    R5,R0                                               0240 00521000
*   CALL S33C2000;                                                 0241 00522000
         BAL   @14,S33C2000                                        0241 00523000
*S33C9999:                                                         0242 00524000
*   R13=SVESC033(2);                /* PTR TO CALLER SAVE AREA       */ 00525000
S33C9999 L     R13,SVESC033+4(,WAPTR)                              0242 00526000
*   END ISTSC033                                                   0243 00527000
*                                                                  0243 00528000
*/* THE FOLLOWING INCLUDE STATEMENTS WERE FOUND IN THIS PROGRAM.     */ 00529000
*/*%INCLUDE SYSLIB  (IFGRPL  )                                       */ 00530000
*/*%INCLUDE SYSLIB  (IFGRPLVT)                                       */ 00531000
*/*%INCLUDE SYSLIB  (ISTRPLFB)                                       */ 00532000
*                                                                  0243 00533000
*       ;                                                          0243 00534000
@EL00001 DS    0H                                                  0243 00535000
@EF00001 DS    0H                                                  0243 00536000
@ER00001 L     @14,12(,@13)                                        0243 00537000
         LM    @00,@12,20(@13)                                     0243 00538000
         BR    @14                                                 0243 00539000
@DATA    DS    0H                                                       00540000
@CH00515 DC    H'30'                                                    00541000
@CH00706 DC    H'68'                                                    00542000
@SM01112 MVC   SESPMAP+1(0,R3),$DEVSESP-68(@11)                         00543000
@SM01117 MVC   TCBSENSE(0,@09),$INBUFR(WAPTR)                           00544000
         DS    0F                                                       00545000
@AL00001 DS    2A                                                       00546000
@TF00001 DS    F                                                        00547000
         DS    0F                                                       00548000
@CF00038 DC    F'8'                                                     00549000
@CF00369 DC    F'12'                                                    00550000
@CF01070 DC    F'1800'                                                  00551000
@CV01071 DC    V(S2FC2000)                                              00552000
@CV01074 DC    V(ISTSC026)                                              00553000
@CV01090 DC    V(I00C1001)                                              00554000
         DS    0D                                                       00555000
RCAPTR   DS    A                                                        00556000
RCVPTR   DS    A                                                        00557000
TIME     DS    H                                                        00558000
BUFMASK  DC    X'FFFFFFFF07FFFF0EF8F0FCF0FEFFFFFFFFFFFFFEFFFFFEFFFF'    00559000
         DS    CL1                                                      00560000
S33REP   DC    40F'0'                                                   00561000
ISTSC033 CSECT                                                          00562000
RESETRPL RPL AM=VTAM,AREA=*,AREALEN=8,OPTCD=SYN                         00563000
ISTSC033 CSECT                                                          00564000
@00      EQU   00                      EQUATES FOR REGISTERS 0-15       00565000
@01      EQU   01                                                       00566000
@02      EQU   02                                                       00567000
@03      EQU   03                                                       00568000
@04      EQU   04                                                       00569000
@05      EQU   05                                                       00570000
@06      EQU   06                                                       00571000
@07      EQU   07                                                       00572000
@08      EQU   08                                                       00573000
@09      EQU   09                                                       00574000
@10      EQU   10                                                       00575000
@11      EQU   11                                                       00576000
@12      EQU   12                                                       00577000
@13      EQU   13                                                       00578000
@14      EQU   14                                                       00579000
@15      EQU   15                                                       00580000
R14SAVE  EQU   @09                                                      00581000
N        EQU   @08                                                      00582000
I        EQU   @09                                                      00583000
WAPTR    EQU   @02                                                      00584000
R0       EQU   @00                                                      00585000
R1       EQU   @01                                                      00586000
R2       EQU   @02                                                      00587000
R3       EQU   @03                                                      00588000
R4       EQU   @04                                                      00589000
R5       EQU   @05                                                      00590000
R13      EQU   @13                                                      00591000
R14      EQU   @14                                                      00592000
R15      EQU   @15                                                      00593000
R10      EQU   @10                                                      00594000
R11      EQU   @11                                                      00595000
R12      EQU   @12                                                      00596000
R6       EQU   @06                                                      00597000
R7       EQU   @07                                                      00598000
R8       EQU   @08                                                      00599000
R9       EQU   @09                                                      00600000
IFGRPL   EQU   0                                                        00601000
RPLCOMN  EQU   IFGRPL                                                   00602000
RPLIDWD  EQU   RPLCOMN                                                  00603000
RPLLEN   EQU   RPLIDWD+3                                                00604000
RPLECB   EQU   RPLCOMN+8                                                00605000
RPLEXITP EQU   RPLECB                                                   00606000
RPLFDBWD EQU   RPLCOMN+12                                               00607000
RPLFDBK  EQU   RPLFDBWD+1                                               00608000
RPLRTNCD EQU   RPLFDBK                                                  00609000
RPLCNDCD EQU   RPLFDBK+1                                                00610000
RPLCMPON EQU   RPLCNDCD                                                 00611000
RPLFDB2  EQU   RPLCMPON                                                 00612000
RPLERRCD EQU   RPLCNDCD+1                                               00613000
RPLFDB3  EQU   RPLERRCD                                                 00614000
RPLKEYLE EQU   RPLCOMN+16                                               00615000
RPLARG   EQU   RPLCOMN+36                                               00616000
RPLOPTCD EQU   RPLCOMN+40                                               00617000
RPLOPT1  EQU   RPLOPTCD                                                 00618000
RPLECBSW EQU   RPLOPT1                                                  00619000
RPLOPT2  EQU   RPLOPTCD+1                                               00620000
RPLADR   EQU   RPLOPT2                                                  00621000
RPLOPT3  EQU   RPLOPTCD+2                                               00622000
RPLOPT4  EQU   RPLOPTCD+3                                               00623000
RPLNXTRP EQU   RPLCOMN+44                                               00624000
RPLRLEN  EQU   RPLCOMN+48                                               00625000
RPLOPTC2 EQU   RPLCOMN+56                                               00626000
RPLOPT5  EQU   RPLOPTC2                                                 00627000
RPLWRTYP EQU   RPLOPT5                                                  00628000
RPLOPT6  EQU   RPLOPTC2+1                                               00629000
RPLUNTYP EQU   RPLOPT6                                                  00630000
RPLOPT7  EQU   RPLOPTC2+2                                               00631000
RPLCNOPT EQU   RPLOPT7                                                  00632000
RPLOPT8  EQU   RPLOPTC2+3                                               00633000
RPLRBAR  EQU   RPLCOMN+60                                               00634000
RPLAIXID EQU   RPLRBAR+2                                                00635000
RPLEXTDS EQU   RPLCOMN+68                                               00636000
RPLEXTD1 EQU   RPLEXTDS                                                 00637000
RPLVTEXT EQU   IFGRPL+76                                                00638000
RPLFDBK2 EQU   RPLVTEXT+12                                              00639000
RPLSSNSI EQU   RPLFDBK2                                                 00640000
RPLDSB   EQU   RPLSSNSI                                                 00641000
RPLDSB1  EQU   RPLDSB                                                   00642000
RPLSSEI  EQU   RPLDSB1                                                  00643000
RPLDSB2  EQU   RPLDSB+1                                                 00644000
RPLSSMI  EQU   RPLDSB2                                                  00645000
RPLUSNSI EQU   RPLFDBK2+2                                               00646000
RPLUSFLD EQU   RPLVTEXT+16                                              00647000
RPLOPTC3 EQU   RPLVTEXT+20                                              00648000
RPLOPT9  EQU   RPLOPTC3                                                 00649000
RPLOPT10 EQU   RPLOPTC3+1                                               00650000
RPLOPT11 EQU   RPLOPTC3+2                                               00651000
RPLOPT12 EQU   RPLOPTC3+3                                               00652000
RPLKEEP  EQU   RPLOPT12                                                 00653000
RPLTRUNC EQU   RPLOPT12                                                 00654000
RPLNIBTK EQU   RPLOPT12                                                 00655000
RPLFMHDR EQU   RPLOPT12                                                 00656000
RPLOSENS EQU   RPLVTEXT+24                                              00657000
RPLSSNSO EQU   RPLOSENS                                                 00658000
RPLSSEO  EQU   RPLSSNSO                                                 00659000
RPLSIGDA EQU   RPLVTEXT+32                                              00660000
RPLOF16  EQU   0                                                        00661000
RPLRH3   EQU   RPLOF16                                                  00662000
RPLSRTYP EQU   RPLOF16+1                                                00663000
RPLSTYPE EQU   RPLSRTYP                                                 00664000
RPLRTYPE EQU   RPLSRTYP                                                 00665000
RPLCHN   EQU   RPLOF16+2                                                00666000
RPLVTFL1 EQU   RPLOF16+3                                                00667000
RPLVTFL2 EQU   RPLOF16+4                                                00668000
RPLPOSTV EQU   RPLVTFL2                                                 00669000
RPLRESP  EQU   RPLVTFL2                                                 00670000
RPLCNTRL EQU   RPLOF16+5                                                00671000
RPLCNTDF EQU   RPLCNTRL                                                 00672000
RPLCNTDC EQU   RPLCNTRL+1                                               00673000
RPLCNTSC EQU   RPLCNTRL+2                                               00674000
RPLOF60  EQU   0                                                        00675000
RPLOBSQV EQU   RPLOF60                                                  00676000
RPLIBSQV EQU   RPLOF60+2                                                00677000
RPLOBSQ  EQU   RPLOF60+4                                                00678000
RPLIBSQ  EQU   RPLOF60+5                                                00679000
RPLSEQNO EQU   RPLOF60+6                                                00680000
$RCAAREA EQU   0                                                        00681000
$POINTER EQU   $RCAAREA+100                                             00682000
$TLTECB2 EQU   $POINTER+28                                              00683000
$TRTBLA  EQU   $POINTER+124                                             00684000
$CONSTNT EQU   $RCAAREA+244                                             00685000
$RCAFLG  EQU   $RCAAREA+604                                             00686000
$EXITSAV EQU   $RCAAREA+864                                             00687000
TOLTEPWA EQU   0                                                        00688000
$SCTTBLE EQU   TOLTEPWA                                                 00689000
$TESTOPT EQU   $SCTTBLE+2                                               00690000
$ERROPT  EQU   $SCTTBLE+3                                               00691000
$PDEVFLG EQU   $SCTTBLE+10                                              00692000
$CDSFLGS EQU   $SCTTBLE+11                                              00693000
$CDS8T19 EQU   $SCTTBLE+20                                              00694000
$EXECFLG EQU   $SCTTBLE+33                                              00695000
$OLTFLGS EQU   $SCTTBLE+36                                              00696000
$OLTFLG2 EQU   $SCTTBLE+37                                              00697000
$TOTFLG1 EQU   $SCTTBLE+38                                              00698000
$ROUTMSK EQU   $SCTTBLE+40                                              00699000
$CDA     EQU   TOLTEPWA+100                                             00700000
$RCA     EQU   $CDA+44                                                  00701000
$OLTPTR  EQU   $CDA+52                                                  00702000
$HIMOREC EQU   $CDA+60                                                  00703000
$COMMFLG EQU   TOLTEPWA+224                                             00704000
$FLAG1   EQU   $COMMFLG                                                 00705000
$FLAG2   EQU   $COMMFLG+1                                               00706000
$FLAG3   EQU   $COMMFLG+2                                               00707000
$FLAG4   EQU   $COMMFLG+3                                               00708000
$FLAG5   EQU   $COMMFLG+4                                               00709000
$EOJ     EQU   $FLAG5                                                   00710000
$CANCEL  EQU   $EOJ                                                     00711000
$FLAG6   EQU   $COMMFLG+5                                               00712000
$ABNDBIT EQU   $FLAG6                                                   00713000
$FLAG7   EQU   $COMMFLG+6                                               00714000
$RCVRFLG EQU   $FLAG7                                                   00715000
$RCVMSG  EQU   $FLAG7                                                   00716000
$FLAG8   EQU   $COMMFLG+7                                               00717000
$FLAG9   EQU   $COMMFLG+8                                               00718000
$FLAG10  EQU   $COMMFLG+9                                               00719000
$FLAG11  EQU   $COMMFLG+10                                              00720000
$FLAG12  EQU   $COMMFLG+11                                              00721000
$FLAG13  EQU   $COMMFLG+12                                              00722000
$DEVTBLE EQU   TOLTEPWA+240                                             00723000
$DEVCDS  EQU   $DEVTBLE                                                 00724000
$DEVUNAD EQU   $DEVCDS                                                  00725000
@NM00062 EQU   $DEVUNAD+2                                               00726000
$DEVFEAT EQU   $DEVCDS+4                                                00727000
$DEVCDSF EQU   $DEVCDS+9                                                00728000
$DEVSDCF EQU   $DEVCDS+10                                               00729000
$$SYMNME EQU   $DEVCDS+12                                               00730000
$DEVFLG1 EQU   $DEVTBLE+20                                              00731000
$EVNCPLT EQU   $DEVFLG1                                                 00732000
$ATTNEXP EQU   $DEVFLG1                                                 00733000
$INTOCC  EQU   $DEVFLG1                                                 00734000
$DEVFLG2 EQU   $DEVTBLE+21                                              00735000
$DEVTECB EQU   $DEVTBLE+22                                              00736000
$OPIS    EQU   $DEVTECB                                                 00737000
$OPND    EQU   $DEVTECB+2                                               00738000
$DEVFLG3 EQU   $DEVTBLE+27                                              00739000
$SIOFLG  EQU   $DEVFLG3                                                 00740000
$IFTOUT  EQU   $DEVTBLE+36                                              00741000
$DEVSESP EQU   $IFTOUT                                                  00742000
$SSCPDAF EQU   $IFTOUT+6                                                00743000
$LDNCBPT EQU   $DEVTBLE+48                                              00744000
$CID     EQU   $DEVTBLE+52                                              00745000
$RNINFO  EQU   $DEVTBLE+56                                              00746000
$DEVFLG5 EQU   $RNINFO+8                                                00747000
$DEVFLG4 EQU   $DEVTBLE+65                                              00748000
$TLTRPL3 EQU   TOLTEPWA+1856                                            00749000
$INBUFR  EQU   TOLTEPWA+2104                                            00750000
#EXITA   EQU   TOLTEPWA+2632                                            00751000
$CCOMDAT EQU   TOLTEPWA+2644                                            00752000
$CFLGS   EQU   $CCOMDAT+16                                              00753000
$24FEMSG EQU   TOLTEPWA+2681                                            00754000
$24CATMG EQU   $24FEMSG+11                                              00755000
@NM00070 EQU   TOLTEPWA+2776                                            00756000
$OUNTPTR EQU   @NM00070+4                                               00757000
$NSPTR   EQU   $OUNTPTR                                                 00758000
$NSCNT   EQU   @NM00070+10                                              00759000
$ENXX    EQU   @NM00070+15                                              00760000
$IMITX   EQU   $ENXX                                                    00761000
$WAITIME EQU   TOLTEPWA+2816                                            00762000
SVESC033 EQU   TOLTEPWA+3160                                            00763000
SVECC013 EQU   TOLTEPWA+3232                                            00764000
SVEIC003 EQU   TOLTEPWA+3592                                            00765000
SVESC022 EQU   TOLTEPWA+3736                                            00766000
SVECC011 EQU   TOLTEPWA+4024                                            00767000
TECBMAPS EQU   0                                                        00768000
TECBFDCT EQU   TECBMAPS                                                 00769000
TECBFDLN EQU   TECBMAPS+1                                               00770000
TECBSNLN EQU   TECBMAPS+2                                               00771000
TECBFLGS EQU   TECBMAPS+4                                               00772000
TECBSNCT EQU   TECBMAPS+5                                               00773000
TECBSNOC EQU   TECBMAPS+6                                               00774000
TECBEVOC EQU   TECBMAPS+7                                               00775000
TECBEVT1 EQU   TECBMAPS+8                                               00776000
TECBFD01 EQU   0                                                        00777000
@NM00074 EQU   TECBFD01+4                                               00778000
TECBSNS1 EQU   0                                                        00779000
TCBSENSE EQU   TECBSNS1+3                                               00780000
TECBSEND EQU   0                                                        00781000
TCBSSEN  EQU   TECBSEND                                                 00782000
TCBSSENM EQU   TECBSEND+1                                               00783000
TCBUSEN  EQU   TECBSEND+2                                               00784000
TCBRESP  EQU   TECBSEND+4                                               00785000
TCBRECLN EQU   TECBSEND+5                                               00786000
TCBRTYPE EQU   TECBSEND+7                                               00787000
TCBRKCHG EQU   TECBSEND+8                                               00788000
TCBCHAIN EQU   TECBSEND+9                                               00789000
TCBCNTRL EQU   TECBSEND+10                                              00790000
TCBSEQNO EQU   TECBSEND+13                                              00791000
TCBSIGDA EQU   TECBSEND+15                                              00792000
TCBIBSQ  EQU   TECBSEND+19                                              00793000
TCBIBSQL EQU   TECBSEND+20                                              00794000
TCBOBSQ  EQU   TECBSEND+22                                              00795000
TCBOBSQL EQU   TECBSEND+23                                              00796000
CDSMAP   EQU   0                                                        00797000
CDSMFCT  EQU   CDSMAP+4                                                 00798000
CDSFEAT  EQU   CDSMFCT+1                                                00799000
CDSFLAG  EQU   CDSMAP+9                                                 00800000
RCVMAP   EQU   0                                                        00801000
$RCVTECB EQU   RCVMAP+4                                                 00802000
$RCVARA  EQU   RCVMAP+12                                                00803000
$RCVARL  EQU   RCVMAP+16                                                00804000
$RCVTIME EQU   RCVMAP+18                                                00805000
$RCVFLG  EQU   RCVMAP+20                                                00806000
$RCVTRC  EQU   $RCVFLG                                                  00807000
$RCVSESS EQU   $RCVFLG                                                  00808000
BACKSAVE EQU   0                                                        00809000
SESPMAP  EQU   0                                                        00810000
$TRTBL   EQU   0                                                        00811000
#EXIT    EQU   0                                                        00812000
ISTRPL   EQU   0                                                        00813000
SVECC012 EQU   SVESC022                                                 00814000
SVEIC00A EQU   SVEIC003                                                 00815000
SVEIC004 EQU   SVEIC003                                                 00816000
SVEIC005 EQU   SVEIC003                                                 00817000
SVESC02A EQU   SVESC022                                                 00818000
SVESC02B EQU   SVESC022                                                 00819000
SVESC02D EQU   SVESC022                                                 00820000
SVESC02E EQU   SVESC022                                                 00821000
SVESC02F EQU   SVECC013                                                 00822000
SVESC024 EQU   SVESC022                                                 00823000
SVESC027 EQU   SVESC022                                                 00824000
SVESC029 EQU   SVESC033                                                 00825000
SVESC031 EQU   SVECC013                                                 00826000
SVESC032 EQU   SVECC011                                                 00827000
SVETC037 EQU   SVEIC003                                                 00828000
         AGO   .@UNREFD                START UNREFERENCED COMPONENTS    00829000
@NM00081 EQU   $RCVFLG                                                  00830000
$RCVCDS  EQU   RCVMAP+8                                                 00831000
$RCVMID  EQU   RCVMAP+2                                                 00832000
$RCVLVL  EQU   RCVMAP+1                                                 00833000
$RCVCPF  EQU   RCVMAP                                                   00834000
CDSEXARA EQU   CDSMAP+20                                                00835000
CDSSYMBN EQU   CDSMAP+12                                                00836000
CDSEXTM  EQU   CDSFLAG+2                                                00837000
CDSEXTB  EQU   CDSFLAG+2                                                00838000
CDSTMERB EQU   CDSFLAG+2                                                00839000
@NM00080 EQU   CDSFLAG+1                                                00840000
CDSDVPRO EQU   CDSFLAG+1                                                00841000
CDSNTPRI EQU   CDSFLAG+1                                                00842000
CDSLINCN EQU   CDSFLAG                                                  00843000
CDSREMSY EQU   CDSFLAG                                                  00844000
CDS2CHAN EQU   CDSFLAG                                                  00845000
CDSSYMB  EQU   CDSFLAG                                                  00846000
CDSEXTPR EQU   CDSFLAG                                                  00847000
CDSFEVOL EQU   CDSFLAG                                                  00848000
CDSSHAR  EQU   CDSFLAG                                                  00849000
CDSFPMD  EQU   CDSFLAG                                                  00850000
CDSBYTCT EQU   CDSMAP+8                                                 00851000
CDSTYPE  EQU   CDSMFCT+3                                                00852000
CDSCLASS EQU   CDSMFCT+2                                                00853000
@NM00079 EQU   CDSFEAT                                                  00854000
CDSDEVM  EQU   CDSFEAT                                                  00855000
CDSDEVT  EQU   CDSFEAT                                                  00856000
CDSASCII EQU   CDSFEAT                                                  00857000
CDSMODEL EQU   CDSMFCT                                                  00858000
CDSUA    EQU   CDSMAP                                                   00859000
@NM00078 EQU   TCBRKCHG                                                 00860000
TCBALT   EQU   TCBRKCHG                                                 00861000
TCBREQ   EQU   TCBRKCHG                                                 00862000
TCBCMD   EQU   TCBRKCHG                                                 00863000
TCBEB    EQU   TCBRKCHG                                                 00864000
TCBBB    EQU   TCBRKCHG                                                 00865000
@NM00077 EQU   TCBRTYPE                                                 00866000
TCBDFAS  EQU   TCBRTYPE                                                 00867000
TCBNDFS  EQU   TCBRTYPE                                                 00868000
TCBRSP   EQU   TCBRTYPE                                                 00869000
@NM00076 EQU   TCBRTYPE                                                 00870000
TCBRRN   EQU   TCBRESP                                                  00871000
TCBNFME  EQU   TCBRESP                                                  00872000
TCBEX    EQU   TCBRESP                                                  00873000
@NM00075 EQU   TCBRESP                                                  00874000
TCBSNDEV EQU   TECBSNS1                                                 00875000
TCBEVCSW EQU   @NM00074                                                 00876000
TCBEVDEV EQU   TECBFD01+1                                               00877000
TCBEVTYP EQU   TECBFD01                                                 00878000
@NM00073 EQU   TECBFLGS                                                 00879000
TCBQUEUE EQU   TECBFLGS                                                 00880000
SVECC010 EQU   TOLTEPWA+3952                                            00881000
SVETC035 EQU   TOLTEPWA+3880                                            00882000
SVESC030 EQU   TOLTEPWA+3808                                            00883000
SVESC020 EQU   TOLTEPWA+3664                                            00884000
SVEIC002 EQU   TOLTEPWA+3520                                            00885000
SVECC014 EQU   TOLTEPWA+3376                                            00886000
SVESC120 EQU   TOLTEPWA+3304                                            00887000
SVESC025 EQU   TOLTEPWA+3088                                            00888000
@NM00072 EQU   TOLTEPWA+2980                                            00889000
$RPLERR  EQU   TOLTEPWA+2977                                            00890000
@NM00071 EQU   TOLTEPWA+2976                                            00891000
$R13PR3  EQU   TOLTEPWA+2972                                            00892000
$CEINT2  EQU   TOLTEPWA+2968                                            00893000
$CEINT1  EQU   TOLTEPWA+2964                                            00894000
$MSGGET  EQU   TOLTEPWA+2960                                            00895000
$ACQLIST EQU   TOLTEPWA+2956                                            00896000
$R4SAVE1 EQU   TOLTEPWA+2952                                            00897000
$CLSISS  EQU   TOLTEPWA+2950                                            00898000
$CLSCNT  EQU   TOLTEPWA+2948                                            00899000
$CUTABLE EQU   TOLTEPWA+2868                                            00900000
$BUFSZ2  EQU   TOLTEPWA+2864                                            00901000
$RESID2  EQU   TOLTEPWA+2860                                            00902000
$OLTCCW2 EQU   TOLTEPWA+2856                                            00903000
$ENDBFR2 EQU   TOLTEPWA+2852                                            00904000
$1STBFR2 EQU   TOLTEPWA+2848                                            00905000
$TECB2   EQU   TOLTEPWA+2844                                            00906000
$BUFSZ1  EQU   TOLTEPWA+2840                                            00907000
$RESID1  EQU   TOLTEPWA+2836                                            00908000
$OLTCCW1 EQU   TOLTEPWA+2832                                            00909000
$ENDBFR1 EQU   TOLTEPWA+2828                                            00910000
$1STBFR1 EQU   TOLTEPWA+2824                                            00911000
$TECB1   EQU   TOLTEPWA+2820                                            00912000
$TRTN#   EQU   TOLTEPWA+2815                                            00913000
$WIODEV  EQU   TOLTEPWA+2814                                            00914000
$RQSTSZE EQU   TOLTEPWA+2812                                            00915000
$RQSTPTR EQU   TOLTEPWA+2808                                            00916000
$R4SAVE  EQU   TOLTEPWA+2804                                            00917000
$PARTADR EQU   TOLTEPWA+2800                                            00918000
$TBSDATA EQU   TOLTEPWA+2796                                            00919000
$CTWIDTH EQU   TOLTEPWA+2795                                            00920000
$CTLINE  EQU   TOLTEPWA+2794                                            00921000
$APWIDTH EQU   TOLTEPWA+2793                                            00922000
$APLINE  EQU   TOLTEPWA+2792                                            00923000
$INDEX   EQU   $IMITX                                                   00924000
$UMXX    EQU   @NM00070+14                                              00925000
$NSXX    EQU   @NM00070+12                                              00926000
$ATACNT  EQU   $NSCNT                                                   00927000
$CTR     EQU   @NM00070+8                                               00928000
$ATAPTR  EQU   $NSPTR                                                   00929000
$DDRPTR  EQU   @NM00070                                                 00930000
$DTORESP EQU   TOLTEPWA+2712                                            00931000
$APNAME  EQU   TOLTEPWA+2704                                            00932000
$24SYMNE EQU   $24CATMG+4                                               00933000
$24DEVAD EQU   $24CATMG                                                 00934000
$24RTN#  EQU   $24FEMSG+8                                               00935000
$ESECTID EQU   $24FEMSG                                                 00936000
$24FLGS  EQU   TOLTEPWA+2680                                            00937000
$24SAVE2 EQU   TOLTEPWA+2676                                            00938000
$24SAVE1 EQU   TOLTEPWA+2672                                            00939000
$24UNADR EQU   TOLTEPWA+2668                                            00940000
$24SAV13 EQU   TOLTEPWA+2664                                            00941000
$24RETCD EQU   TOLTEPWA+2663                                            00942000
$MACID   EQU   TOLTEPWA+2661                                            00943000
$CSPARE  EQU   $CFLGS                                                   00944000
$C2WAY   EQU   $CFLGS                                                   00945000
$CINCT   EQU   $CCOMDAT+12                                              00946000
$CINADR  EQU   $CCOMDAT+8                                               00947000
$COUTCT  EQU   $CCOMDAT+4                                               00948000
$COUTAD  EQU   $CCOMDAT                                                 00949000
ROOTLOC  EQU   TOLTEPWA+2640                                            00950000
$RETREG  EQU   TOLTEPWA+2636                                            00951000
$WORK    EQU   TOLTEPWA+2376                                            00952000
$EXTA    EQU   TOLTEPWA+2320                                            00953000
$PASSONA EQU   TOLTEPWA+2264                                            00954000
$TRMINPT EQU   TOLTEPWA+2184                                            00955000
$BUFFER  EQU   TOLTEPWA+1976                                            00956000
$TLTRPL2 EQU   TOLTEPWA+1736                                            00957000
$TLTRPL1 EQU   TOLTEPWA+1616                                            00958000
$SLTBL   EQU   TOLTEPWA+1468                                            00959000
$CDEVPT  EQU   TOLTEPWA+1466                                            00960000
$DEVCNTS EQU   TOLTEPWA+1464                                            00961000
$FEEDBCK EQU   $DEVTBLE+66                                              00962000
$WTISUED EQU   $DEVFLG4                                                 00963000
$EXIOISD EQU   $DEVFLG4                                                 00964000
$REMWRIT EQU   $DEVFLG4                                                 00965000
$REMDONE EQU   $DEVFLG4                                                 00966000
$2NDUSED EQU   $DEVFLG4                                                 00967000
$1STUSED EQU   $DEVFLG4                                                 00968000
$IGLXIFB EQU   $DEVFLG4                                                 00969000
$EXIOLV3 EQU   $DEVFLG4                                                 00970000
@NM00069 EQU   $DEVFLG5                                                 00971000
$DVBASIC EQU   $DEVFLG5                                                 00972000
$ASCII   EQU   $DEVFLG5                                                 00973000
$DEVLU   EQU   $DEVFLG5                                                 00974000
$OPNDFAL EQU   $DEVFLG5                                                 00975000
$ACQNCB  EQU   $DEVFLG5                                                 00976000
$REMOTE  EQU   $DEVFLG5                                                 00977000
$ENDNODE EQU   $DEVFLG5                                                 00978000
$LINENME EQU   $RNINFO                                                  00979000
$DVCOL   EQU   $LDNCBPT+2                                               00980000
$DVROW   EQU   $LDNCBPT                                                 00981000
$NCSPLP  EQU   $DEVTBLE+44                                              00982000
$DVLN    EQU   $SSCPDAF                                                 00983000
$DAF     EQU   $DEVSESP+4                                               00984000
$VARYPAB EQU   $DEVSESP                                                 00985000
$SYSMN   EQU   $DEVTBLE+28                                              00986000
@NM00068 EQU   $DEVFLG3                                                 00987000
$CLRSNT  EQU   $DEVFLG3                                                 00988000
$OLTERR  EQU   $DEVFLG3                                                 00989000
$SRTEST  EQU   $DEVFLG3                                                 00990000
$DVSNDOK EQU   $SIOFLG                                                  00991000
$POLLREQ EQU   $DEVFLG3                                                 00992000
$ACQRED  EQU   $DEVFLG3                                                 00993000
$NOTDEV  EQU   $DEVFLG3                                                 00994000
$DVINCT  EQU   $DEVTBLE+26                                              00995000
$DVBRKST EQU   $OPND+1                                                  00996000
$DVBRKSN EQU   $OPND                                                    00997000
$DVSEQNO EQU   $OPIS                                                    00998000
$CEINTRP EQU   $DEVFLG2                                                 00999000
$TESTMDE EQU   $DEVFLG2                                                 01000000
$DEVALOC EQU   $DEVFLG2                                                 01001000
$ALLDATA EQU   $DEVFLG2                                                 01002000
$ENDCNTL EQU   $DEVFLG2                                                 01003000
$CTLDEV  EQU   $DEVFLG2                                                 01004000
$NOCDS   EQU   $DEVFLG2                                                 01005000
$DATAIN  EQU   $DEVFLG2                                                 01006000
$PRIMARY EQU   $DEVFLG1                                                 01007000
$DVCTBYT EQU   $INTOCC                                                  01008000
$DEVACT  EQU   $DEVFLG1                                                 01009000
$DVLGMDE EQU   $ATTNEXP                                                 01010000
$DVSPRM  EQU   $EVNCPLT                                                 01011000
$GRABBED EQU   $DEVFLG1                                                 01012000
$CATASTR EQU   $DEVFLG1                                                 01013000
$LETGO   EQU   $DEVFLG1                                                 01014000
$CURELEM EQU   $$SYMNME+4                                               01015000
$MSGOTSD EQU   $$SYMNME                                                 01016000
$EXTDEV  EQU   $DEVCDS+11                                               01017000
@NM00067 EQU   $DEVSDCF                                                 01018000
$NOTPRIM EQU   $DEVSDCF                                                 01019000
@NM00066 EQU   $DEVCDSF                                                 01020000
@NM00065 EQU   $DEVCDSF                                                 01021000
@NM00064 EQU   $DEVCDSF                                                 01022000
$CDSNAME EQU   $DEVCDSF                                                 01023000
$EXTRN   EQU   $DEVCDSF                                                 01024000
$CEVOLUM EQU   $DEVCDSF                                                 01025000
$SHARD   EQU   $DEVCDSF                                                 01026000
$DEVFPM  EQU   $DEVCDSF                                                 01027000
$DEVCNT  EQU   $DEVCDS+8                                                01028000
$DEVTYPE EQU   $DEVFEAT+3                                               01029000
$DEVCLAS EQU   $DEVFEAT+2                                               01030000
$DEVFRRS EQU   $DEVFEAT+1                                               01031000
$DEVMOD  EQU   $DEVFEAT                                                 01032000
$DEVRDGT EQU   @NM00062+1                                               01033000
$DEVCTLU EQU   @NM00062+1                                               01034000
$DEVCHAN EQU   @NM00062                                                 01035000
@NM00063 EQU   @NM00062                                                 01036000
$CTINDX  EQU   $DEVUNAD                                                 01037000
$FLAG16  EQU   $COMMFLG+15                                              01038000
$FLAG15  EQU   $COMMFLG+14                                              01039000
$FLAG14  EQU   $COMMFLG+13                                              01040000
$TEP2ND  EQU   $FLAG13                                                  01041000
$TEP1ST  EQU   $FLAG13                                                  01042000
$CATMSG  EQU   $FLAG13                                                  01043000
$PRMPTSW EQU   $FLAG13                                                  01044000
$DEVENT  EQU   $FLAG13                                                  01045000
$OLTMACC EQU   $FLAG13                                                  01046000
$LGON    EQU   $FLAG13                                                  01047000
$CTLOGON EQU   $FLAG13                                                  01048000
@NM00061 EQU   $FLAG12                                                  01049000
$VARYINP EQU   $FLAG12                                                  01050000
$ENDTEST EQU   $FLAG12                                                  01051000
$VRYHRD  EQU   $FLAG12                                                  01052000
$VRYSFT  EQU   $FLAG12                                                  01053000
$POSTFLG EQU   $FLAG12                                                  01054000
$OPTMSG  EQU   $FLAG12                                                  01055000
$FEORCAT EQU   $FLAG11                                                  01056000
@NM00060 EQU   $FLAG11                                                  01057000
@NM00059 EQU   $FLAG10                                                  01058000
$INBND   EQU   $FLAG10                                                  01059000
$WAITFLG EQU   $FLAG10                                                  01060000
$DPRINT  EQU   $FLAG10                                                  01061000
$HOLD    EQU   $FLAG9                                                   01062000
$NOTRRCH EQU   $FLAG9                                                   01063000
@NM00058 EQU   $FLAG9                                                   01064000
$COPY    EQU   $FLAG9                                                   01065000
$LSTLNSW EQU   $FLAG9                                                   01066000
$MULLNSW EQU   $FLAG9                                                   01067000
$REMSW   EQU   $FLAG9                                                   01068000
$IGRES   EQU   $FLAG9                                                   01069000
$TCECM   EQU   $FLAG8                                                   01070000
$VS2     EQU   $FLAG8                                                   01071000
$VS1     EQU   $FLAG8                                                   01072000
$EDOS    EQU   $FLAG8                                                   01073000
@NM00057 EQU   $FLAG8                                                   01074000
$TWOWAY  EQU   $FLAG8                                                   01075000
@NM00056 EQU   $FLAG8                                                   01076000
$SNDRFLG EQU   $FLAG7                                                   01077000
$LDOIS   EQU   $FLAG7                                                   01078000
$DCONTCT EQU   $FLAG7                                                   01079000
$EXIOWAT EQU   $FLAG7                                                   01080000
$2NDDATA EQU   $FLAG7                                                   01081000
$1STDATA EQU   $FLAG7                                                   01082000
$CIREQ   EQU   $FLAG6                                                   01083000
$ABTERM  EQU   $ABNDBIT                                                 01084000
$FSTMCIS EQU   $FLAG6                                                   01085000
$DISCREQ EQU   $FLAG6                                                   01086000
$DISCISS EQU   $FLAG6                                                   01087000
$CHANGE  EQU   $FLAG6                                                   01088000
$CTERROR EQU   $FLAG6                                                   01089000
$RECAL11 EQU   $FLAG6                                                   01090000
@NM00055 EQU   $FLAG5                                                   01091000
$PROGCK  EQU   $CANCEL                                                  01092000
$PRINTAP EQU   $FLAG5                                                   01093000
@NM00054 EQU   $FLAG5                                                   01094000
$MSG922  EQU   $FLAG5                                                   01095000
$CT924   EQU   $FLAG5                                                   01096000
$FSTCAT  EQU   $FLAG5                                                   01097000
$FSTFE   EQU   $FLAG5                                                   01098000
$ACTOPND EQU   $FLAG4                                                   01099000
$ACQCUTT EQU   $FLAG4                                                   01100000
$CLSSACT EQU   $FLAG4                                                   01101000
$BACKINT EQU   $FLAG4                                                   01102000
$DMSGSW  EQU   $FLAG4                                                   01103000
$TSTDEVP EQU   $FLAG4                                                   01104000
$APRQPER EQU   $FLAG4                                                   01105000
$OPCOM   EQU   $FLAG4                                                   01106000
$NEWAP   EQU   $FLAG3                                                   01107000
$ALTPRTR EQU   $FLAG3                                                   01108000
$OPTERR  EQU   $FLAG3                                                   01109000
$PRTONLY EQU   $FLAG3                                                   01110000
$REQSTOR EQU   $FLAG3                                                   01111000
$LOGOFFE EQU   $FLAG3                                                   01112000
$TSTERR  EQU   $FLAG3                                                   01113000
$DEVERR  EQU   $FLAG3                                                   01114000
$PARTIAL EQU   $FLAG2                                                   01115000
$NRMTERM EQU   $FLAG2                                                   01116000
$VALDTST EQU   $FLAG2                                                   01117000
$VALDDEV EQU   $FLAG2                                                   01118000
$DBLSLSH EQU   $FLAG2                                                   01119000
$NDR     EQU   $FLAG2                                                   01120000
@NM00053 EQU   $FLAG2                                                   01121000
$OLTACT  EQU   $FLAG1                                                   01122000
$NORELDV EQU   $FLAG1                                                   01123000
@NM00052 EQU   $FLAG1                                                   01124000
$OPTCHNG EQU   $FLAG1                                                   01125000
$DEVCHNG EQU   $FLAG1                                                   01126000
$TESTCNG EQU   $FLAG1                                                   01127000
$CNSLFG  EQU   $FLAG1                                                   01128000
$TEP3RD  EQU   $FLAG1                                                   01129000
@NM00051 EQU   $CDA+120                                                 01130000
$CUCNT   EQU   $CDA+118                                                 01131000
@NM00050 EQU   $CDA+117                                                 01132000
$PRTFORM EQU   $CDA+116                                                 01133000
$OPISCNT EQU   $CDA+114                                                 01134000
$OPNDCNT EQU   $CDA+112                                                 01135000
$GETMSZE EQU   $CDA+110                                                 01136000
$GRCNTS  EQU   $CDA+108                                                 01137000
$CTLCNT  EQU   $CDA+106                                                 01138000
$ACTLVL  EQU   $CDA+105                                                 01139000
$PRNTLVL EQU   $CDA+104                                                 01140000
$ERRCNTA EQU   $CDA+102                                                 01141000
$TLCNT   EQU   $CDA+100                                                 01142000
$TIMEALW EQU   $CDA+96                                                  01143000
$PTRAREA EQU   $CDA+92                                                  01144000
$GETMPTR EQU   $CDA+88                                                  01145000
$R13PTRT EQU   $CDA+84                                                  01146000
$R13PTR  EQU   $CDA+80                                                  01147000
$TEPEND  EQU   $CDA+76                                                  01148000
$PLINKDL EQU   $CDA+72                                                  01149000
$TEPBEGN EQU   $CDA+68                                                  01150000
$FRELPTR EQU   $CDA+64                                                  01151000
$HIGHADR EQU   $HIMOREC                                                 01152000
$LOMOREC EQU   $CDA+56                                                  01153000
$LOWADDR EQU   $OLTPTR                                                  01154000
$ENDCOMM EQU   $CDA+48                                                  01155000
$COMMON  EQU   $RCA                                                     01156000
$SLASHAD EQU   $CDA+32                                                  01157000
$PASSON  EQU   $CDA+28                                                  01158000
$TOLBRTB EQU   $CDA+24                                                  01159000
$SCTPTR8 EQU   $CDA+20                                                  01160000
$SCTPTR  EQU   $CDA+16                                                  01161000
$TBWDPTR EQU   $CDA+12                                                  01162000
$TFWDPTR EQU   $CDA+8                                                   01163000
@NM00049 EQU   $CDA                                                     01164000
@NM00048 EQU   $SCTTBLE+98                                              01165000
$SCTLWTC EQU   $SCTTBLE+96                                              01166000
$SCTLWTA EQU   $SCTTBLE+92                                              01167000
#EXT     EQU   $SCTTBLE+88                                              01168000
#PASS    EQU   $SCTTBLE+84                                              01169000
#TABLE   EQU   $SCTTBLE+80                                              01170000
#MSGIDAC EQU   $SCTTBLE+78                                              01171000
@NM00047 EQU   $SCTTBLE+71                                              01172000
$RETMASK EQU   $SCTTBLE+70                                              01173000
$R249255 EQU   $ROUTMSK+29                                              01174000
$R241248 EQU   $ROUTMSK+28                                              01175000
$R233240 EQU   $ROUTMSK+27                                              01176000
$R225232 EQU   $ROUTMSK+26                                              01177000
$R217224 EQU   $ROUTMSK+25                                              01178000
$R209216 EQU   $ROUTMSK+24                                              01179000
$R201208 EQU   $ROUTMSK+23                                              01180000
$R193200 EQU   $ROUTMSK+22                                              01181000
$R185192 EQU   $ROUTMSK+21                                              01182000
$R177184 EQU   $ROUTMSK+20                                              01183000
$R169176 EQU   $ROUTMSK+19                                              01184000
$R161168 EQU   $ROUTMSK+18                                              01185000
$R153160 EQU   $ROUTMSK+17                                              01186000
$R145152 EQU   $ROUTMSK+16                                              01187000
$R137144 EQU   $ROUTMSK+15                                              01188000
$R129136 EQU   $ROUTMSK+14                                              01189000
$R121128 EQU   $ROUTMSK+13                                              01190000
$R113120 EQU   $ROUTMSK+12                                              01191000
$R105112 EQU   $ROUTMSK+11                                              01192000
$R097104 EQU   $ROUTMSK+10                                              01193000
$R089096 EQU   $ROUTMSK+9                                               01194000
$R081088 EQU   $ROUTMSK+8                                               01195000
$R073080 EQU   $ROUTMSK+7                                               01196000
$R065072 EQU   $ROUTMSK+6                                               01197000
$R057064 EQU   $ROUTMSK+5                                               01198000
$R049056 EQU   $ROUTMSK+4                                               01199000
$R041048 EQU   $ROUTMSK+3                                               01200000
$R033040 EQU   $ROUTMSK+2                                               01201000
$R025032 EQU   $ROUTMSK+1                                               01202000
$R017024 EQU   $ROUTMSK                                                 01203000
$TOTFLG2 EQU   $SCTTBLE+39                                              01204000
@NM00046 EQU   $TOTFLG1                                                 01205000
@NM00045 EQU   $TOTFLG1                                                 01206000
@NM00044 EQU   $TOTFLG1                                                 01207000
$CURELOD EQU   $TOTFLG1                                                 01208000
$CTEQTT  EQU   $TOTFLG1                                                 01209000
@NM00043 EQU   $TOTFLG1                                                 01210000
@NM00042 EQU   $TOTFLG1                                                 01211000
$LINESHR EQU   $TOTFLG1                                                 01212000
@NM00041 EQU   $OLTFLG2                                                 01213000
@NM00040 EQU   $OLTFLG2                                                 01214000
@NM00039 EQU   $OLTFLG2                                                 01215000
@NM00038 EQU   $OLTFLG2                                                 01216000
@NM00037 EQU   $OLTFLG2                                                 01217000
@NM00036 EQU   $OLTFLG2                                                 01218000
@NM00035 EQU   $OLTFLG2                                                 01219000
$TALK    EQU   $OLTFLG2                                                 01220000
$DYCOM   EQU   $OLTFLGS                                                 01221000
@NM00034 EQU   $OLTFLGS                                                 01222000
$TRACE   EQU   $OLTFLGS                                                 01223000
$RETCODE EQU   $OLTFLGS                                                 01224000
$CONTCB  EQU   $OLTFLGS                                                 01225000
$RETAIN  EQU   $OLTFLGS                                                 01226000
$CLEANRT EQU   $OLTFLGS                                                 01227000
$MANINTV EQU   $OLTFLGS                                                 01228000
$OLTSIZE EQU   $SCTTBLE+34                                              01229000
$QSCTMOD EQU   $EXECFLG                                                 01230000
$CTRLMOD EQU   $EXECFLG                                                 01231000
$CLEANUP EQU   $EXECFLG                                                 01232000
$LSTPDEV EQU   $EXECFLG                                                 01233000
$ERRCNT  EQU   $EXECFLG                                                 01234000
$RTNSLCT EQU   $EXECFLG                                                 01235000
$MULTDEV EQU   $EXECFLG                                                 01236000
@NM00033 EQU   $EXECFLG                                                 01237000
$RMSKCNT EQU   $SCTTBLE+32                                              01238000
$SYNAME  EQU   $CDS8T19+4                                               01239000
$EXTSIG  EQU   $CDS8T19+3                                               01240000
$CDFLGS  EQU   $CDS8T19+1                                               01241000
$CDSCNT  EQU   $CDS8T19                                                 01242000
$PDEVDSC EQU   $SCTTBLE+16                                              01243000
$PDEVADR EQU   $SCTTBLE+12                                              01244000
$COMMCN  EQU   $CDSFLGS                                                 01245000
$CUSTSYM EQU   $CDSFLGS                                                 01246000
$TWOCHSW EQU   $CDSFLGS                                                 01247000
$SYMNAME EQU   $CDSFLGS                                                 01248000
$EXTINTC EQU   $CDSFLGS                                                 01249000
$CEVOL   EQU   $CDSFLGS                                                 01250000
$SHARED  EQU   $CDSFLGS                                                 01251000
$FPM     EQU   $CDSFLGS                                                 01252000
$LASTSUB EQU   $PDEVFLG                                                 01253000
@NM00032 EQU   $PDEVFLG                                                 01254000
@NM00031 EQU   $PDEVFLG                                                 01255000
@NM00030 EQU   $PDEVFLG                                                 01256000
$LASTDEV EQU   $PDEVFLG                                                 01257000
@NM00029 EQU   $PDEVFLG                                                 01258000
$EXFILPT EQU   $PDEVFLG                                                 01259000
$FPMOLD  EQU   $PDEVFLG                                                 01260000
$TSSSYM  EQU   $SCTTBLE+8                                               01261000
$SCTLEVL EQU   $SCTTBLE+7                                               01262000
$DRIVER  EQU   $SCTTBLE+6                                               01263000
$RT0916  EQU   $SCTTBLE+5                                               01264000
$RT0108  EQU   $SCTTBLE+4                                               01265000
$LOOPTST EQU   $ERROPT                                                  01266000
$LOOPERR EQU   $ERROPT                                                  01267000
$NERRPRT EQU   $ERROPT                                                  01268000
$NOCNTRL EQU   $ERROPT                                                  01269000
$ALTPRNT EQU   $ERROPT                                                  01270000
$CATERR  EQU   $ERROPT                                                  01271000
$ASTERIK EQU   $ERROPT                                                  01272000
$TESTERR EQU   $ERROPT                                                  01273000
$FSTCOMM EQU   $TESTOPT                                                 01274000
$INDEFLP EQU   $TESTOPT                                                 01275000
$NOPRT   EQU   $TESTOPT                                                 01276000
$PARAPRT EQU   $TESTOPT                                                 01277000
@NM00028 EQU   $TESTOPT                                                 01278000
$ERRLPCT EQU   $SCTTBLE                                                 01279000
$TLTEND  EQU   $RCAAREA+945                                             01280000
$CNSLID  EQU   $RCAAREA+936                                             01281000
$TRASCII EQU   $RCAAREA+608                                             01282000
@NM00027 EQU   $RCAAREA+605                                             01283000
$VTAMEND EQU   $RCAFLG                                                  01284000
$TPPOSTD EQU   $RCAFLG                                                  01285000
$NEWCT   EQU   $RCAFLG                                                  01286000
$ABNDALL EQU   $RCAFLG                                                  01287000
$CUTESTB EQU   $RCAFLG                                                  01288000
$CONSOLE EQU   $RCAFLG                                                  01289000
$TPLOGON EQU   $RCAFLG                                                  01290000
$UPDATE  EQU   $RCAFLG                                                  01291000
$DEVAREA EQU   $RCAAREA+600                                             01292000
$CTDVAR  EQU   $RCAAREA+596                                             01293000
$BUFFS   EQU   $RCAAREA+464                                             01294000
$TLTNIB  EQU   $CONSTNT+140                                             01295000
$TLTPRPL EQU   $CONSTNT+20                                              01296000
@NM00026 EQU   $CONSTNT+4                                               01297000
@NM00025 EQU   $CONSTNT+2                                               01298000
$USECNT  EQU   $CONSTNT                                                 01299000
$CURRTWA EQU   $POINTER+140                                             01300000
$CTNAME  EQU   $POINTER+132                                             01301000
$CTARGX  EQU   $POINTER+128                                             01302000
$COMINT  EQU   $POINTER+120                                             01303000
$QUEHNDL EQU   $POINTER+116                                             01304000
@NM00024 EQU   $POINTER+36                                              01305000
$RTNPTR  EQU   $POINTER+32                                              01306000
$TLTECB1 EQU   $POINTER+24                                              01307000
$CLEANP  EQU   $POINTER+20                                              01308000
$ABEND   EQU   $POINTER+16                                              01309000
$LSTAREA EQU   $POINTER+12                                              01310000
$FSTAREA EQU   $POINTER+8                                               01311000
$CVTSAVE EQU   $POINTER+4                                               01312000
$TOLTEP  EQU   $POINTER                                                 01313000
$TLTACB  EQU   $RCAAREA                                                 01314000
@NM00023 EQU   RPLIBSQ                                                  01315000
RPLIINV  EQU   RPLIBSQ                                                  01316000
RPLINEG  EQU   RPLIBSQ                                                  01317000
RPLIPOS  EQU   RPLIBSQ                                                  01318000
RPLIIGN  EQU   RPLIBSQ                                                  01319000
RPLIRSET EQU   RPLIBSQ                                                  01320000
RPLITST  EQU   RPLIBSQ                                                  01321000
RPLISET  EQU   RPLIBSQ                                                  01322000
@NM00022 EQU   RPLOBSQ                                                  01323000
RPLOINV  EQU   RPLOBSQ                                                  01324000
RPLONEG  EQU   RPLOBSQ                                                  01325000
RPLOPOS  EQU   RPLOBSQ                                                  01326000
RPLOIGN  EQU   RPLOBSQ                                                  01327000
RPLORSET EQU   RPLOBSQ                                                  01328000
RPLOTST  EQU   RPLOBSQ                                                  01329000
RPLOSET  EQU   RPLOBSQ                                                  01330000
@NM00021 EQU   RPLCNTSC                                                 01331000
RPLRSHUT EQU   RPLCNTSC                                                 01332000
RPLRQR   EQU   RPLCNTSC                                                 01333000
RPLSHUTC EQU   RPLCNTSC                                                 01334000
RPLSHUTD EQU   RPLCNTSC                                                 01335000
RPLSTSN  EQU   RPLCNTSC                                                 01336000
RPLCLEAR EQU   RPLCNTSC                                                 01337000
RPLSDT   EQU   RPLCNTSC                                                 01338000
RPLBIS   EQU   RPLCNTDC                                                 01339000
RPLSBI   EQU   RPLCNTDC                                                 01340000
RPLTUNBD EQU   RPLCNTDC                                                 01341000
RPLTBIND EQU   RPLCNTDC                                                 01342000
RPLSIGNL EQU   RPLCNTDC                                                 01343000
RPLLUS   EQU   RPLCNTDC                                                 01344000
RPLRTR   EQU   RPLCNTDC                                                 01345000
RPLBID   EQU   RPLCNTDC                                                 01346000
@NM00020 EQU   RPLCNTDF                                                 01347000
RPLQI    EQU   RPLCNTDF                                                 01348000
RPLRELQ  EQU   RPLCNTDF                                                 01349000
RPLCHASE EQU   RPLCNTDF                                                 01350000
RPLQEC   EQU   RPLCNTDF                                                 01351000
RPLQC    EQU   RPLCNTDF                                                 01352000
RPLCNCEL EQU   RPLCNTDF                                                 01353000
RPLDATA  EQU   RPLCNTDF                                                 01354000
RPLRRN   EQU   RPLRESP                                                  01355000
RPLNFME  EQU   RPLRESP                                                  01356000
RPLEX    EQU   RPLRESP                                                  01357000
RPLQRI   EQU   RPLRESP                                                  01358000
@NM00019 EQU   RPLPOSTV                                                 01359000
RPLSCHED EQU   RPLPOSTV                                                 01360000
@NM00018 EQU   RPLVTFL1                                                 01361000
RPLTLGAC EQU   RPLVTFL1                                                 01362000
RPLTNDSP EQU   RPLVTFL1                                                 01363000
RPLAUTUS EQU   RPLVTFL1                                                 01364000
RPLVTUSE EQU   RPLVTFL1                                                 01365000
@NM00017 EQU   RPLVTFL1                                                 01366000
@NM00016 EQU   RPLCHN                                                   01367000
RPLONLY  EQU   RPLCHN                                                   01368000
RPLLAST  EQU   RPLCHN                                                   01369000
RPLMIDLE EQU   RPLCHN                                                   01370000
RPLFIRST EQU   RPLCHN                                                   01371000
@NM00015 EQU   RPLRTYPE                                                 01372000
RPLDFASY EQU   RPLRTYPE                                                 01373000
RPLNFSYN EQU   RPLRTYPE                                                 01374000
RPLRRESP EQU   RPLRTYPE                                                 01375000
@NM00014 EQU   RPLSTYPE                                                 01376000
RPLSRESP EQU   RPLSTYPE                                                 01377000
@NM00013 EQU   RPLRH3                                                   01378000
RPLCSI   EQU   RPLRH3                                                   01379000
RPLCHREQ EQU   RPLRH3                                                   01380000
RPLCMD   EQU   RPLRH3                                                   01381000
RPLEB    EQU   RPLRH3                                                   01382000
RPLBB    EQU   RPLRH3                                                   01383000
RPLSAV13 EQU   RPLVTEXT+28                                              01384000
RPLUSNSO EQU   RPLOSENS+2                                               01385000
RPLSSMO  EQU   RPLSSNSO+1                                               01386000
@NM00012 EQU   RPLSSEO                                                  01387000
RPLRRO   EQU   RPLSSEO                                                  01388000
RPLFIO   EQU   RPLSSEO                                                  01389000
RPLSTATO EQU   RPLSSEO                                                  01390000
RPLCPMO  EQU   RPLSSEO                                                  01391000
@NM00011 EQU   RPLSSEO                                                  01392000
@NM00010 EQU   RPLOPT12                                                 01393000
@NM00009 EQU   RPLOPT12                                                 01394000
@NM00008 EQU   RPLOPT12                                                 01395000
@NM00007 EQU   RPLOPT12                                                 01396000
RPLRSVE8 EQU   RPLOPT11                                                 01397000
RPLRSVE7 EQU   RPLOPT11                                                 01398000
RPLRSVE6 EQU   RPLOPT11                                                 01399000
RPLRSVE5 EQU   RPLOPT11                                                 01400000
RPLRSVE4 EQU   RPLOPT11                                                 01401000
RPLSTOP  EQU   RPLOPT11                                                 01402000
RPLSTART EQU   RPLOPT11                                                 01403000
RPLQUIES EQU   RPLOPT11                                                 01404000
RPLRSVI6 EQU   RPLOPT10                                                 01405000
RPLRSVI5 EQU   RPLOPT10                                                 01406000
RPLRSVI4 EQU   RPLOPT10                                                 01407000
RPLRSVI3 EQU   RPLOPT10                                                 01408000
RPLTSKY  EQU   RPLOPT10                                                 01409000
RPLSPARM EQU   RPLOPT10                                                 01410000
RPLDSPLY EQU   RPLOPT10                                                 01411000
RPLBSCID EQU   RPLOPT10                                                 01412000
RPLTOPL  EQU   RPLOPT9                                                  01413000
RPLCIDE  EQU   RPLOPT9                                                  01414000
RPLRNNM  EQU   RPLOPT9                                                  01415000
RPLAPPST EQU   RPLOPT9                                                  01416000
RPLCOUNT EQU   RPLOPT9                                                  01417000
RPLTERMS EQU   RPLOPT9                                                  01418000
RPLDEVCH EQU   RPLOPT9                                                  01419000
RPLLOGON EQU   RPLOPT9                                                  01420000
RPLESR2  EQU   RPLUSNSI+1                                               01421000
RPLESR1  EQU   RPLUSNSI                                                 01422000
@NM00006 EQU   RPLSSEI                                                  01423000
RPLRRI   EQU   RPLSSEI                                                  01424000
RPLFII   EQU   RPLSSEI                                                  01425000
RPLSTATI EQU   RPLSSEI                                                  01426000
RPLCPMI  EQU   RPLSSEI                                                  01427000
RPLPATHI EQU   RPLSSEI                                                  01428000
RPLARCLN EQU   RPLVTEXT+8                                               01429000
RPLAARLN EQU   RPLVTEXT+4                                               01430000
RPLAAREA EQU   RPLVTEXT                                                 01431000
RPLERMSA EQU   RPLCOMN+72                                               01432000
RPLEMLEN EQU   RPLCOMN+70                                               01433000
RPLACTIV EQU   RPLCOMN+69                                               01434000
RPLBRANC EQU   RPLEXTD1                                                 01435000
RPLNIB   EQU   RPLEXTD1                                                 01436000
RPLTCRYP EQU   RPLEXTD1                                                 01437000
@NM00005 EQU   RPLEXTD1                                                 01438000
RPLEXIT  EQU   RPLEXTD1                                                 01439000
RPLNEXIT EQU   RPLEXTD1                                                 01440000
RPLEXSCH EQU   RPLEXTD1                                                 01441000
RPLDDDD  EQU   RPLRBAR+4                                                01442000
@NM00004 EQU   RPLRBAR+3                                                01443000
@NM00003 EQU   RPLAIXID                                                 01444000
RPLAXPKP EQU   RPLAIXID                                                 01445000
RPLAIXPC EQU   RPLRBAR                                                  01446000
RPLRSV88 EQU   RPLOPT8                                                  01447000
RPLUNCON EQU   RPLOPT8                                                  01448000
RPLACTV  EQU   RPLOPT8                                                  01449000
RPLSESS  EQU   RPLOPT8                                                  01450000
RPLPEND  EQU   RPLOPT8                                                  01451000
RPLODPRM EQU   RPLOPT8                                                  01452000
RPLODACP EQU   RPLOPT8                                                  01453000
RPLODACQ EQU   RPLOPT8                                                  01454000
RPLRSV78 EQU   RPLOPT7                                                  01455000
RPLTCRNO EQU   RPLOPT7                                                  01456000
RPLRLSOP EQU   RPLOPT7                                                  01457000
RPLTPOST EQU   RPLOPT7                                                  01458000
RPLQOPT  EQU   RPLOPT7                                                  01459000
RPLCNIMM EQU   RPLCNOPT                                                 01460000
RPLCNANY EQU   RPLCNOPT                                                 01461000
RPLCNALL EQU   RPLCNOPT                                                 01462000
RPLRSV68 EQU   RPLOPT6                                                  01463000
RPLRSV67 EQU   RPLOPT6                                                  01464000
RPLLOCK  EQU   RPLOPT6                                                  01465000
RPLNCOND EQU   RPLOPT6                                                  01466000
RPLCOND  EQU   RPLOPT6                                                  01467000
RPLEOT   EQU   RPLUNTYP                                                 01468000
RPLEOM   EQU   RPLUNTYP                                                 01469000
RPLEOB   EQU   RPLUNTYP                                                 01470000
RPLWROPT EQU   RPLOPT5                                                  01471000
RPLNODE  EQU   RPLOPT5                                                  01472000
RPLERACE EQU   RPLWRTYP                                                 01473000
RPLEAU   EQU   RPLWRTYP                                                 01474000
RPLNERAS EQU   RPLWRTYP                                                 01475000
RPLPSOPT EQU   RPLOPT5                                                  01476000
@NM00002 EQU   RPLOPT5                                                  01477000
RPLDLGIN EQU   RPLOPT5                                                  01478000
RPLBUFL  EQU   RPLCOMN+52                                               01479000
RPLCHAIN EQU   RPLNXTRP                                                 01480000
@NM00001 EQU   RPLOPT4                                                  01481000
RPLMKFRM EQU   RPLOPT4                                                  01482000
RPLENDTR EQU   RPLOPT4                                                  01483000
RPLALIGN EQU   RPLOPT3                                                  01484000
RPLFMT   EQU   RPLOPT3                                                  01485000
RPLFLD   EQU   RPLOPT3                                                  01486000
RPLVFY   EQU   RPLOPT3                                                  01487000
RPLBLK   EQU   RPLOPT3                                                  01488000
RPLSFORM EQU   RPLOPT3                                                  01489000
RPLEODS  EQU   RPLOPT3                                                  01490000
RPLNSP   EQU   RPLOPT2                                                  01491000
RPLUPD   EQU   RPLOPT2                                                  01492000
RPLWAITX EQU   RPLOPT2                                                  01493000
RPLLRD   EQU   RPLOPT2                                                  01494000
RPLBWD   EQU   RPLOPT2                                                  01495000
RPLCNV   EQU   RPLOPT2                                                  01496000
RPLADD   EQU   RPLADR                                                   01497000
RPLKEY   EQU   RPLOPT2                                                  01498000
RPLECBIN EQU   RPLECBSW                                                 01499000
RPLGEN   EQU   RPLOPT1                                                  01500000
RPLKGE   EQU   RPLOPT1                                                  01501000
RPLASY   EQU   RPLOPT1                                                  01502000
RPLSKP   EQU   RPLOPT1                                                  01503000
RPLSEQ   EQU   RPLOPT1                                                  01504000
RPLDIR   EQU   RPLOPT1                                                  01505000
RPLLOC   EQU   RPLOPT1                                                  01506000
RPLDAF   EQU   RPLARG+2                                                 01507000
RPLSAF   EQU   RPLARG                                                   01508000
RPLAREA  EQU   RPLCOMN+32                                               01509000
RPLTCBPT EQU   RPLCOMN+28                                               01510000
RPLDACB  EQU   RPLCOMN+24                                               01511000
RPLCCHAR EQU   RPLCOMN+20                                               01512000
RPLSTRID EQU   RPLCOMN+18                                               01513000
RPLKEYL  EQU   RPLKEYLE                                                 01514000
RPLRDSOH EQU   RPLFDB3                                                  01515000
RPLRLG   EQU   RPLFDB3                                                  01516000
RPLLGFRC EQU   RPLFDB3                                                  01517000
RPLREOT  EQU   RPLFDB3                                                  01518000
RPLREOM  EQU   RPLFDB3                                                  01519000
RPLREOB  EQU   RPLFDB3                                                  01520000
RPLSV32  EQU   RPLFDB3                                                  01521000
RPLUINPT EQU   RPLFDB3                                                  01522000
RPLSTSAV EQU   RPLFDB2                                                  01523000
RPLCUERR EQU   RPLFDB2                                                  01524000
RPLDLGFL EQU   RPLFDB2                                                  01525000
RPLIOERR EQU   RPLFDB2                                                  01526000
RPLDVUNS EQU   RPLFDB2                                                  01527000
RPLATND  EQU   RPLFDB2                                                  01528000
RPLRVID  EQU   RPLFDB2                                                  01529000
RPLERLK  EQU   RPLFDB2                                                  01530000
RPLERREG EQU   RPLRTNCD                                                 01531000
RPLSTAT  EQU   RPLFDBWD                                                 01532000
RPLPOST  EQU   RPLEXITP                                                 01533000
RPLWAIT  EQU   RPLEXITP                                                 01534000
RPLPLHPT EQU   RPLCOMN+4                                                01535000
RPLLEN2  EQU   RPLLEN                                                   01536000
RPLREQ   EQU   RPLIDWD+2                                                01537000
RPLSTYP  EQU   RPLIDWD+1                                                01538000
RPLID    EQU   RPLIDWD                                                  01539000
.@UNREFD ANOP                          END UNREFERENCED COMPONENTS      01540000
@RT00081 EQU   S33C0500                                                 01541000
@RT00105 EQU   S33C9999                                                 01542000
@RF00133 EQU   S33C0600                                                 01543000
@RT00143 EQU   S33C9999                                                 01544000
@PB00002 EQU   @EC00234                                                 01545000
@ENDDATA EQU   *                                                        01546000
         END   ISTSC033,(C'PLS1052',0702,78336)                         01547000
./  ADD  SSI=83370166,NAME=ISTTC035
         TITLE 'ISTTC035,TERMINATION CODE FOR OLT SECTION'              00001000
ISTTC035 CSECT ,                                                   0001 00002000
@MAINENT DS    0H                                                  0001 00003000
         USING *,@15                                               0001 00004000
         B     @PROLOG                                             0001 00005000
         DC    AL1(16)                                             0001 00006000
         DC    C'ISTTC035  78.337'                                 0001 00007000
         DROP  @15                                                      00008000
@PROLOG  STM   @14,@12,12(@13)                                     0001 00009000
         BALR  @12,0                                               0001 00010000
@PSTART  DS    0H                                                  0001 00011000
         USING @PSTART,@12                                         0001 00012000
*                                                                  0028 00013000
*   /*****************************************************************/ 00014000
*   /*                                                               */ 00015000
*   /* BEGINNING OF EXECUTABLE CODE FOR MODULE                       */ 00016000
*   /*                                                               */ 00017000
*   /*****************************************************************/ 00018000
*                                                                  0029 00019000
*   SVETC035(2)=R13;                /* STORE BACK LINK IN MY AREA    */ 00020000
         ST    R13,SVETC035+4(,WAPTR)                              0029 00021000
*   BACKSAVE(3)=ADDR(SVETC035);     /* POINT TO MY SAVEAREA IN CHAN  */ 00022000
         LA    @03,SVETC035(,WAPTR)                                0030 00023000
         ST    @03,BACKSAVE+8(,R13)                                0030 00024000
*   R13=ADDR(SVETC035);             /* POINT TO MY SAVEAREA          */ 00025000
*                                                                  0031 00026000
         LR    R13,@03                                             0031 00027000
*   /*****************************************************************/ 00028000
*   /*                                                               */ 00029000
*   /* IF A TEST DEVICE IS BEING VARIED, TELL USER THAT THE SECTION  */ 00030000
*   /* IS BEING TERMINATED AND HIS DEVICES ARE BEING RELEASED.       */ 00031000
*   /*                                                               */ 00032000
*   /*****************************************************************/ 00033000
*                                                                  0032 00034000
*   IF $VARYINP='1'B THEN           /* CHECK FOR DEVICE BEING VARIED    00035000
*                                      OFF                           */ 00036000
         TM    $VARYINP(WAPTR),B'00000100'                         0032 00037000
         BNO   @RF00032                                            0032 00038000
*     DO;                           /* ISSUE MESSAGE                 */ 00039000
*                                                                  0033 00040000
*       /*************************************************************/ 00041000
*       /*                                                           */ 00042000
*       /* TCEC MSGN(466) INVOKED                                    */ 00043000
*       /*                                                           */ 00044000
*       /*************************************************************/ 00045000
*                                                                  0034 00046000
*       $TCECM='1'B;                /* SET TCEC SW IN RCA            */ 00047000
         OI    $TCECM(WAPTR),B'00000001'                           0034 00048000
*       R1=ADDR($TCA08);            /* SET UP PARM LIST $TR          */ 00049000
         LA    R1,$TCA08                                           0035 00050000
*       CALL #EXIT;                 /* CALL CECOM                    */ 00051000
         L     @15,#EXITA(,WAPTR)                                  0036 00052000
         BALR  @14,@15                                             0036 00053000
*       DCL                                                        0037 00054000
*         1 $TCA08,                 /* TCEC PARM LIST                */ 00055000
*          2 $TCB08 FIXED(32) INIT(466),/* MSG NUMBER                */ 00056000
*          2 $TCC08 FIXED(32) INIT(0),/* INCT LEN                    */ 00057000
*          2 $TCD08 BIT(8) INIT('00000000'B),/* FLAG                 */ 00058000
*          2 $TCE08 CHAR(4) INIT('FFFFFFFF'X);/* MSSAGE MASK         */ 00059000
*     END;                          /* END OF MESSAGE                */ 00060000
*                                                                  0038 00061000
*   /*****************************************************************/ 00062000
*   /*                                                               */ 00063000
*   /* IF NO OLT IS ACTIVE, JUST RELEASE CURRENT DEVICES AND RETURN  */ 00064000
*   /* TO THE CALLER TO CONTINUE. NO MESSAGES ARE ISSUED.            */ 00065000
*   /*                                                               */ 00066000
*   /*****************************************************************/ 00067000
*                                                                  0039 00068000
*   IF $OLTACT='0'B THEN            /* IF NO OLT, SKIP CLEANUP       */ 00069000
@RF00032 TM    $OLTACT(WAPTR),B'00000001'                          0039 00070000
         BZ    @RT00039                                            0039 00071000
*     GO TO T35C0080;               /* GO TO RELEASE DEVICES         */ 00072000
*                                                                  0040 00073000
*   /*****************************************************************/ 00074000
*   /*                                                               */ 00075000
*   /* IF AN OLT IS ACTIVE, CHECK IF IT TERMINATED NORMALLY OR IF IT */ 00076000
*   /* WAS FORCED TO END. ON A FORCED TERMINATION, THE OLT IS GIVEN  */ 00077000
*   /* THE OPPORTUNITY TO DO I/O TO BRING THE DEVICES HE WAS USING   */ 00078000
*   /* BACK INTO A USEABLE STATE.                                    */ 00079000
*   /*                                                               */ 00080000
*   /*****************************************************************/ 00081000
*                                                                  0041 00082000
*   IF $NRMTERM='0'B THEN           /* DID OLT TERMINATE NORMALLY?   */ 00083000
         TM    $NRMTERM(WAPTR),B'00000010'                         0041 00084000
         BNZ   @RF00041                                            0041 00085000
*     DO;                           /* ABNORMAL TERM. OF THE OLT     */ 00086000
*                                                                  0042 00087000
*       /*************************************************************/ 00088000
*       /*                                                           */ 00089000
*       /* TURN OFF BITS THAT MIGHT HAVE BEEN LEFT ON BY OLT         */ 00090000
*       /*                                                           */ 00091000
*       /*************************************************************/ 00092000
*                                                                  0043 00093000
*       $TEP1ST='0'B;                                              0043 00094000
*       $TEP2ND='0'B;                                              0044 00095000
*       $OLTMACC='0'B;                                             0045 00096000
*                                                                  0045 00097000
         NI    $TEP1ST(WAPTR),B'11011100'                          0045 00098000
*       /*************************************************************/ 00099000
*       /*                                                           */ 00100000
*       /* IF THERE IS A CLEANUP ROUTINE AND IT HAS NOT BEEN ENTERED */ 00101000
*       /* YET FOR CLEANUP, THE CLEANUP BIT IS SET AS AN INDICATOR   */ 00102000
*       /* AND THE OLT IS RE-ENTERED. HE IS GIVEN ONLY ONE CHANCE TO */ 00103000
*       /* CLEANUP, IF HE IS TERMINATED AGAIN, OR THERE WAS NO       */ 00104000
*       /* CLEANUP ROUTINE IN THE FIRST PLACE, THE DEVICES WITH      */ 00105000
*       /* ACTIVE I/O ARE GIVEN A DIO REQUEST FOR A HIO.             */ 00106000
*       /*                                                           */ 00107000
*       /*************************************************************/ 00108000
*                                                                  0046 00109000
*       IF $CLEANUP='0'B&$CLEANRT='1'B THEN                        0046 00110000
         TM    $CLEANUP(WAPTR),B'00000100'                         0046 00111000
         BNZ   @RF00046                                            0046 00112000
         TM    $CLEANRT(WAPTR),B'01000000'                         0046 00113000
         BNO   @RF00046                                            0046 00114000
*         DO;                       /* CALL OLT TO CLEANUP           */ 00115000
*           $CLEANUP='1'B;          /* SHOW OLT ENTERED TO CLEANUP   */ 00116000
         OI    $CLEANUP(WAPTR),B'00000100'                         0048 00117000
*           #MSGIDAC=#MSGIDAC&&#MSGIDAC;/* ZERO OUT THE ACTIVE     0049 00118000
*                                      MESSAGE ID                    */ 00119000
         XC    #MSGIDAC(2,WAPTR),#MSGIDAC(WAPTR)                   0049 00120000
*           IF #MSGIDRQ='1'B THEN   /* DET. IF MESSAGE ID FIELD IS 0050 00121000
*                                      PRESENT                       */ 00122000
         L     @03,$LOWADDR(,WAPTR)                                0050 00123000
         LH    @15,RTNDISP(,@03)                                   0050 00124000
         ALR   @15,@03                                             0050 00125000
         TM    #MSGIDRQ(@15),B'00010000'                           0050 00126000
         BNO   @RF00050                                            0050 00127000
*             #MSGIDAC=#MSGID;      /* STORE FOR CECOM FUNCTIONS     */ 00128000
         MVC   #MSGIDAC(2,WAPTR),#MSGID(@03)                       0051 00129000
*           IF $VRYSFT='1'B THEN    /* CHECK FOR AN NCP BEING      0052 00130000
*                                      RELOADED                      */ 00131000
@RF00050 TM    $VRYSFT(WAPTR),B'00100000'                          0052 00132000
         BNO   @RF00052                                            0052 00133000
*             $CURELOD='1'B;        /* IF IT WAS RELOADED, INDICATE     00134000
*                                      TO OLT                        */ 00135000
*                                                                  0053 00136000
         OI    $CURELOD(WAPTR),B'00001000'                         0053 00137000
*           /*********************************************************/ 00138000
*           /*                                                       */ 00139000
*           /* POINT TO PARAMETER LIST AND CALL THE OLT SO HE MAY    */ 00140000
*           /* RESTORE HIS DEVICES TO THEIR ORIGINAL STATUS.         */ 00141000
*           /*                                                       */ 00142000
*           /*********************************************************/ 00143000
*                                                                  0054 00144000
*           R1=ADDR($SCTPTR);       /* GET PARAMETER LIST            */ 00145000
@RF00052 LA    R1,$SCTPTR(,WAPTR)                                  0054 00146000
*           CALL OLTENTRY;          /* ENTER THE OLT TO CLEAN UP     */ 00147000
         L     @03,$LOWADDR(,WAPTR)                                0055 00148000
         L     @15,INST(,@03)                                      0055 00149000
         BALR  @14,@15                                             0055 00150000
*         END;                      /* END CLEANUP ROUTINE FOR OLT   */ 00151000
*       $ASTERIK='1'B;              /* SET TERMINATED IN ERROR       */ 00152000
@RF00046 OI    $ASTERIK(WAPTR),B'01000000'                         0057 00153000
*     END;                          /* END OF OLT CLEANUP            */ 00154000
*   $OLTACT='0'B;                   /* SHOW OLT NOLONGER ACTIVE      */ 00155000
@RF00041 NI    $OLTACT(WAPTR),B'11111110'                          0059 00156000
*   $NRMTERM='0'B;                  /* RESET TERMINATION BIT         */ 00157000
*                                                                  0060 00158000
         NI    $NRMTERM(WAPTR),B'11111101'                         0060 00159000
*   /*****************************************************************/ 00160000
*   /*                                                               */ 00161000
*   /* HALT ANY I/O THAT STILL MAY BE ACTIVE FOR THE OLT. THIS CODE  */ 00162000
*   /* IS USUALLY NOT EXECUTED, AND IS FOR SAFEGUARD PURPOSES ONLY.  */ 00163000
*   /*                                                               */ 00164000
*   /*****************************************************************/ 00165000
*                                                                  0061 00166000
*   DO I=3 TO $DEVCNTS;             /* CHECK ALL DEVICES             */ 00167000
         LA    I,3                                                 0061 00168000
         B     @DE00061                                            0061 00169000
@DL00061 DS    0H                                                  0062 00170000
*     IF $DEVACT(I)='1'B THEN       /* CHECK FOR ACTIVE DEV          */ 00171000
         LR    @05,I                                               0062 00172000
         MH    @05,@CH00267                                        0062 00173000
         ST    @05,@TF00001                                        0062 00174000
         ALR   @05,WAPTR                                           0062 00175000
         TM    $DEVACT-68(@05),B'00000100'                         0062 00176000
         BNO   @RF00062                                            0062 00177000
*       DO;                         /* IF ACTIVE, PURGE              */ 00178000
*         $IGLXIFB(I)='1'B;         /* SET THE IGNORE BIT FOR STATUS    00179000
*                                      POST                          */ 00180000
         LR    @05,WAPTR                                           0064 00181000
         AL    @05,@TF00001                                        0064 00182000
         OI    $IGLXIFB-68(@05),B'01000000'                        0064 00183000
*         PURCDS=ADDR($DEVTBLE(I)); /* CDS IN DEV TABLE              */ 00184000
*                                                                  0065 00185000
         L     @05,@TF00001                                        0065 00186000
         LA    @05,$DEVTBLE-68(@05,WAPTR)                          0065 00187000
         ST    @05,PURCDS                                          0065 00188000
*         /***********************************************************/ 00189000
*         /*                                                         */ 00190000
*         /* USE THE LAST TECB USED BY THE OLT. SINCE THE STATUS IS  */ 00191000
*         /* NOT CHECKED, ANY VALID ADDRESS IS GOOD ENOUGH TO USE.   */ 00192000
*         /*                                                         */ 00193000
*         /***********************************************************/ 00194000
*                                                                  0066 00195000
*         PURTECB=$DEVTECB(I);      /* TECB POINTER IN TBLE          */ 00196000
         LR    @05,WAPTR                                           0066 00197000
         AL    @05,@TF00001                                        0066 00198000
         ICM   @03,15,$DEVTECB-68(@05)                             0066 00199000
         ST    @03,PURTECB                                         0066 00200000
*         R1=ADDR(PURPARM);         /* POINT TO PARAMETER LST        */ 00201000
         LA    R1,PURPARM                                          0067 00202000
*         CALL ISTSC032;            /* PURGE THE I/O                 */ 00203000
         L     @15,@CV00579                                        0068 00204000
         BALR  @14,@15                                             0068 00205000
*       END;                        /* END OF I/O PURGE              */ 00206000
*   END;                            /* END OF DEVICE LOOP            */ 00207000
*                                                                  0070 00208000
@RF00062 AL    I,@CF00043                                          0070 00209000
@DE00061 CH    I,$DEVCNTS(,WAPTR)                                  0070 00210000
         BNH   @DL00061                                            0070 00211000
*   /*****************************************************************/ 00212000
*   /*                                                               */ 00213000
*   /* IF ALL THE ROUTINES WERE NOT RUN, ISSUE A MESSAGE TO THE      */ 00214000
*   /* OPERATOR TO TELL HIM THAT THINGS HE WANTED TO GET DONE HAVE   */ 00215000
*   /* NOT BEEN ENTERED. THIS CAN BE CAUSED BY SPECIFYING A ROUTINE  */ 00216000
*   /* NUMBER HIGHER THAN IS IN THE OLT SECTION.                     */ 00217000
*   /*                                                               */ 00218000
*   /*****************************************************************/ 00219000
*                                                                  0071 00220000
*   IF $RTNSLCT='1'B&$RTN#<$HIGHRTN THEN/* NOT ALL ROUTINES RUN      */ 00221000
         TM    $RTNSLCT(WAPTR),B'00100000'                         0071 00222000
         BNO   @RF00071                                            0071 00223000
         L     @03,$LOWADDR(,WAPTR)                                0071 00224000
         LH    @15,RTNDISP(,@03)                                   0071 00225000
         ALR   @15,@03                                             0071 00226000
         CLC   $RTN#(1,@15),$HIGHRTN(WAPTR)                        0071 00227000
         BNL   @RF00071                                            0071 00228000
*     DO;                           /* ISSUE MESSAGE 198             */ 00229000
*                                                                  0072 00230000
*       /*************************************************************/ 00231000
*       /*                                                           */ 00232000
*       /* USE CECOM TO ISSUE MESSAGE 198 TO INFORM THE OPERATOR NOT */ 00233000
*       /* ALL SECTIONS WERE RUN TCEC MSGN(198) INVOKED              */ 00234000
*       /*                                                           */ 00235000
*       /*************************************************************/ 00236000
*                                                                  0073 00237000
*       $TCECM='1'B;                /* SET TCEC SW IN RCA            */ 00238000
         OI    $TCECM(WAPTR),B'00000001'                           0073 00239000
*       R1=ADDR($TCA09);            /* SET UP PARM LIST $TR          */ 00240000
         LA    R1,$TCA09                                           0074 00241000
*       CALL #EXIT;                 /* CALL CECOM                    */ 00242000
         L     @15,#EXITA(,WAPTR)                                  0075 00243000
         BALR  @14,@15                                             0075 00244000
*       DCL                                                        0076 00245000
*         1 $TCA09,                 /* TCEC PARM LIST                */ 00246000
*          2 $TCB09 FIXED(32) INIT(198),/* MSG NUMBER                */ 00247000
*          2 $TCC09 FIXED(32) INIT(0),/* INCT LEN                    */ 00248000
*          2 $TCD09 BIT(8) INIT('00000000'B),/* FLAG                 */ 00249000
*          2 $TCE09 CHAR(4) INIT('FFFFFFFF'X);/* MSSAGE MASK         */ 00250000
*     END;                          /* END OF MESSAGE 198            */ 00251000
*                                                                  0077 00252000
*   /*****************************************************************/ 00253000
*   /*                                                               */ 00254000
*   /* IF THE SECTION INDICATED THAT NO MORE DEVICES SHOULD BE       */ 00255000
*   /* SCHEDULED AGAINST THIS SECTION IN THIS TEST LOOP, SET THE     */ 00256000
*   /* $FINAL BIT IN THE TEST WORK AREA WHICH WILL BE MOVED INTO THE */ 00257000
*   /* SECTION LIST TABLE AT THE END OF EXECUTION.                   */ 00258000
*   /*                                                               */ 00259000
*   /*****************************************************************/ 00260000
*                                                                  0078 00261000
*   IF $LSTPDEV='1'B THEN           /* SET FINAL BIT FOR SECTION     */ 00262000
@RF00071 TM    $LSTPDEV(WAPTR),B'00001000'                         0078 00263000
         BNO   @RF00078                                            0078 00264000
*     $FINAL='1'B;                  /* SHOW SECTION NOT TO BE USED   */ 00265000
*                                                                  0079 00266000
         OI    $FINAL(WAPTR),B'10000000'                           0079 00267000
*   /*****************************************************************/ 00268000
*   /*                                                               */ 00269000
*   /* IF THE CONTROL PRINT OPTION IS SPECIFIED, TYPE THE TERMINATE  */ 00270000
*   /* OPTION AND TELL THE OPERATOR THE SECTION IS THROUGH EXECUTING.*/ 00271000
*   /*                                                               */ 00272000
*   /*****************************************************************/ 00273000
*                                                                  0080 00274000
*   IF $NOCNTRL='1'B THEN           /* SKIP IF NO CONTROL PRINT      */ 00275000
@RF00078 TM    $NOCNTRL(WAPTR),B'00001000'                         0080 00276000
         BNO   @RF00080                                            0080 00277000
*     DO;                           /* IF CP ON, PRINT MSG 158       */ 00278000
*       $INBUFR(1:2)=' T';          /* FORMAT FOR TERMINATE MSG      */ 00279000
         MVC   $INBUFR(2,WAPTR),@CC00586                           0082 00280000
*       $INBUFR(3:10)=$RUNTEST;     /* PUT ON SECTION NAME           */ 00281000
         MVC   $INBUFR+2(8,WAPTR),$RUNTEST(WAPTR)                  0083 00282000
*       $INBUFR(11:14)=$PRIMADR;    /* PUT IN UNIT ADDR              */ 00283000
         MVC   $INBUFR+10(4,WAPTR),$PRIMADR(WAPTR)                 0084 00284000
*       $INBUFR(15:22)=$SYMBOLC;    /* ADD SYMBOLIC ADDRESS          */ 00285000
         MVC   $INBUFR+14(8,WAPTR),$SYMBOLC(WAPTR)                 0085 00286000
*       IF $ASTERIK='1'B THEN       /* PUT ON ERROR FLAG             */ 00287000
         TM    $ASTERIK(WAPTR),B'01000000'                         0086 00288000
         BNO   @RF00086                                            0086 00289000
*         $INBUFR(1)='*';           /* PUT ON INSTEAD OF BLANK       */ 00290000
*                                                                  0087 00291000
         MVI   $INBUFR(WAPTR),C'*'                                 0087 00292000
*       /*************************************************************/ 00293000
*       /*                                                           */ 00294000
*       /* TCEC MSGN(158)SUB(YES) INVOKED                            */ 00295000
*       /*                                                           */ 00296000
*       /*************************************************************/ 00297000
*                                                                  0088 00298000
*       $TCECM='1'B;                /* SET TCEC SW IN RCA            */ 00299000
@RF00086 OI    $TCECM(WAPTR),B'00000001'                           0088 00300000
*       R1=ADDR($TCA10);            /* SET UP PARM LIST $TR          */ 00301000
         LA    R1,$TCA10                                           0089 00302000
*       CALL #EXIT;                 /* CALL CECOM                    */ 00303000
         L     @15,#EXITA(,WAPTR)                                  0090 00304000
         BALR  @14,@15                                             0090 00305000
*       DCL                                                        0091 00306000
*         1 $TCA10,                 /* TCEC PARM LIST                */ 00307000
*          2 $TCB10 FIXED(32) INIT(158),/* MSG NUMBER                */ 00308000
*          2 $TCC10 FIXED(32) INIT(0),/* INCT LEN                    */ 00309000
*          2 $TCD10 BIT(8) INIT('10000000'B),/* FLAG                 */ 00310000
*          2 $TCE10 CHAR(4) INIT('FFFFFFFF'X);/* MSSAGE MASK ISSUE 0091 00311000
*                                      MESSAGE 158                   */ 00312000
*     END;                          /* END OF TERMINATE MESSAGE      */ 00313000
*                                                                  0092 00314000
*   /*****************************************************************/ 00315000
*   /*                                                               */ 00316000
*   /* IF THE BIT IS ON TO RELEASE DEVICES OR GENERALLY CLEANUP THIS */ 00317000
*   /* PARTICULAR LOGON, CALL THE CLEANUP ROUTINE.                   */ 00318000
*   /*                                                               */ 00319000
*   /*****************************************************************/ 00320000
*                                                                  0093 00321000
*T35C0080:                                                         0093 00322000
*   IF $VARYINP='1'B&$LOGOFFE='0'B THEN/* CHECK FOR DEVICE BEING   0093 00323000
*                                      VARIED OFF AND CT STILL VALID    00324000
*                                                            @AX12741*/ 00325000
@RF00080 DS    0H                                                  0093 00326000
T35C0080 TM    $VARYINP(WAPTR),B'00000100'                         0093 00327000
         BNO   @RF00093                                            0093 00328000
         L     @03,$LOGOFFE                                        0093 00329000
         LTR   @03,@03                                             0093 00330000
         BNZ   @RF00093                                            0093 00331000
*     DO;                           /* MAKE SPECIAL CALL AND THEN  0094 00332000
*                                      EXIT                          */ 00333000
*       CALL I01C0060;              /* CLEAN UP DEVICES              */ 00334000
         L     @15,@CV00601                                        0095 00335000
         BALR  @14,@15                                             0095 00336000
*       $VARYINP='0'B;              /* RESET VARY IN PROGRESS        */ 00337000
*       $VRYSFT='0'B;               /* RESET SOFT VARY INDICATOR     */ 00338000
*       $VRYHRD='0'B;               /* RESET HARD VARY PURGE       0098 00339000
*                                      INDICATOR                     */ 00340000
         NI    $VARYINP(WAPTR),B'11001011'                         0098 00341000
*       $CURELOD='0'B;              /* RESET SCT INDICATOR ABOUT   0099 00342000
*                                      CONTROL UNIT RELOD            */ 00343000
         NI    $CURELOD(WAPTR),B'11110111'                         0099 00344000
*       $NORELDV='0'B;              /* RESET JUST IN CASE IT WAS ON  */ 00345000
         NI    $NORELDV(WAPTR),B'11111101'                         0100 00346000
*       CALL ISTIC002;              /* EXIT TO COMMUNICATION INTERVAL*/ 00347000
         L     @15,@CV00602                                        0101 00348000
         BALR  @14,@15                                             0101 00349000
*     END;                          /* END OF SPECIAL VARY CODE      */ 00350000
*   IF $NORELDV='0'B THEN           /* CLEANUP TOLTEP                */ 00351000
@RF00093 TM    $NORELDV(WAPTR),B'00000010'                         0103 00352000
         BNZ   @RF00103                                            0103 00353000
*     CALL I01C0060;                /* RELEASE DEVICES AND CORE      */ 00354000
         L     @15,@CV00601                                        0104 00355000
         BALR  @14,@15                                             0104 00356000
*   $NORELDV='0'B;                  /* RESET BIT                     */ 00357000
@RF00103 NI    $NORELDV(WAPTR),B'11111101'                         0105 00358000
*   R13=SVETC035(2);                /* RESTORE CALLERS SAVEAREA PTR  */ 00359000
         L     R13,SVETC035+4(,WAPTR)                              0106 00360000
*   DO;                             /* ATDSPLY                       */ 00361000
*   END;                            /* ATDSPLY                       */ 00362000
*   END ISTTC035;                   /* END OF DTERM                  */ 00363000
@EL00001 DS    0H                                                  0109 00364000
@EF00001 DS    0H                                                  0109 00365000
@ER00001 LM    @14,@12,12(@13)                                     0109 00366000
         BR    @14                                                 0109 00367000
@DATA    DS    0H                                                       00368000
@CH00267 DC    H'68'                                                    00369000
         DS    0F                                                       00370000
@TF00001 DS    F                                                        00371000
         DS    0F                                                       00372000
@CF00043 DC    F'1'                                                     00373000
@CV00579 DC    V(ISTSC032)                                              00374000
@CV00601 DC    V(I01C0060)                                              00375000
@CV00602 DC    V(ISTIC002)                                              00376000
         DS    0D                                                       00377000
$LOGOFFE DS    F                                                        00378000
@CC00586 DC    C' T'                                                    00379000
         DS    CL2                                                      00380000
PURPARM  DS    CL13                                                     00381000
         ORG   PURPARM                                                  00382000
@NM00057 DS    FL4                                                      00383000
PURCDS   DS    AL4                                                      00384000
PURTECB  DS    AL4                                                      00385000
@NM00058 DC    XL1'01'                                                  00386000
         ORG   PURPARM+13                                               00387000
         DS    CL3                                                      00388000
$TCA08   DS    CL13                                                     00389000
         ORG   $TCA08                                                   00390000
$TCB08   DC    A(466)                                                   00391000
$TCC08   DC    A(0)                                                     00392000
$TCD08   DC    B'00000000'                                              00393000
$TCE08   DC    X'FFFFFFFF'                                              00394000
         ORG   $TCA08+13                                                00395000
         DS    CL3                                                      00396000
$TCA09   DS    CL13                                                     00397000
         ORG   $TCA09                                                   00398000
$TCB09   DC    A(198)                                                   00399000
$TCC09   DC    A(0)                                                     00400000
$TCD09   DC    B'00000000'                                              00401000
$TCE09   DC    X'FFFFFFFF'                                              00402000
         ORG   $TCA09+13                                                00403000
         DS    CL3                                                      00404000
$TCA10   DS    CL13                                                     00405000
         ORG   $TCA10                                                   00406000
$TCB10   DC    A(158)                                                   00407000
$TCC10   DC    A(0)                                                     00408000
$TCD10   DC    B'10000000'                                              00409000
$TCE10   DC    X'FFFFFFFF'                                              00410000
         ORG   $TCA10+13                                                00411000
         DS    CL3                                                      00412000
PATCH    DC    40F'0'                                                   00413000
@00      EQU   00                      EQUATES FOR REGISTERS 0-15       00414000
@01      EQU   01                                                       00415000
@02      EQU   02                                                       00416000
@03      EQU   03                                                       00417000
@04      EQU   04                                                       00418000
@05      EQU   05                                                       00419000
@06      EQU   06                                                       00420000
@07      EQU   07                                                       00421000
@08      EQU   08                                                       00422000
@09      EQU   09                                                       00423000
@10      EQU   10                                                       00424000
@11      EQU   11                                                       00425000
@12      EQU   12                                                       00426000
@13      EQU   13                                                       00427000
@14      EQU   14                                                       00428000
@15      EQU   15                                                       00429000
I        EQU   @04                                                      00430000
WAPTR    EQU   @02                                                      00431000
R1       EQU   @01                                                      00432000
R13      EQU   @13                                                      00433000
TOLTEPWA EQU   0                                                        00434000
$SCTTBLE EQU   TOLTEPWA                                                 00435000
$TESTOPT EQU   $SCTTBLE+2                                               00436000
$ERROPT  EQU   $SCTTBLE+3                                               00437000
$ASTERIK EQU   $ERROPT                                                  00438000
$NOCNTRL EQU   $ERROPT                                                  00439000
$PDEVFLG EQU   $SCTTBLE+10                                              00440000
$CDSFLGS EQU   $SCTTBLE+11                                              00441000
$CDS8T19 EQU   $SCTTBLE+20                                              00442000
$EXECFLG EQU   $SCTTBLE+33                                              00443000
$RTNSLCT EQU   $EXECFLG                                                 00444000
$LSTPDEV EQU   $EXECFLG                                                 00445000
$CLEANUP EQU   $EXECFLG                                                 00446000
$OLTFLGS EQU   $SCTTBLE+36                                              00447000
$CLEANRT EQU   $OLTFLGS                                                 00448000
$OLTFLG2 EQU   $SCTTBLE+37                                              00449000
$TOTFLG1 EQU   $SCTTBLE+38                                              00450000
$CURELOD EQU   $TOTFLG1                                                 00451000
$ROUTMSK EQU   $SCTTBLE+40                                              00452000
#MSGIDAC EQU   $SCTTBLE+78                                              00453000
$CDA     EQU   TOLTEPWA+100                                             00454000
$SCTPTR  EQU   $CDA+16                                                  00455000
$RCA     EQU   $CDA+44                                                  00456000
$OLTPTR  EQU   $CDA+52                                                  00457000
$LOWADDR EQU   $OLTPTR                                                  00458000
$HIMOREC EQU   $CDA+60                                                  00459000
$COMMFLG EQU   TOLTEPWA+224                                             00460000
$FLAG1   EQU   $COMMFLG                                                 00461000
$NORELDV EQU   $FLAG1                                                   00462000
$OLTACT  EQU   $FLAG1                                                   00463000
$FLAG2   EQU   $COMMFLG+1                                               00464000
$NRMTERM EQU   $FLAG2                                                   00465000
$FLAG8   EQU   $COMMFLG+7                                               00466000
$TCECM   EQU   $FLAG8                                                   00467000
$FLAG12  EQU   $COMMFLG+11                                              00468000
$VRYSFT  EQU   $FLAG12                                                  00469000
$VRYHRD  EQU   $FLAG12                                                  00470000
$VARYINP EQU   $FLAG12                                                  00471000
$FLAG13  EQU   $COMMFLG+12                                              00472000
$OLTMACC EQU   $FLAG13                                                  00473000
$TEP1ST  EQU   $FLAG13                                                  00474000
$TEP2ND  EQU   $FLAG13                                                  00475000
$DEVTBLE EQU   TOLTEPWA+240                                             00476000
$DEVCDS  EQU   $DEVTBLE                                                 00477000
$DEVUNAD EQU   $DEVCDS                                                  00478000
@NM00041 EQU   $DEVUNAD+2                                               00479000
$DEVFEAT EQU   $DEVCDS+4                                                00480000
$DEVCDSF EQU   $DEVCDS+9                                                00481000
$DEVSDCF EQU   $DEVCDS+10                                               00482000
$$SYMNME EQU   $DEVCDS+12                                               00483000
$DEVFLG1 EQU   $DEVTBLE+20                                              00484000
$EVNCPLT EQU   $DEVFLG1                                                 00485000
$ATTNEXP EQU   $DEVFLG1                                                 00486000
$DEVACT  EQU   $DEVFLG1                                                 00487000
$INTOCC  EQU   $DEVFLG1                                                 00488000
$DEVFLG2 EQU   $DEVTBLE+21                                              00489000
$DEVTECB EQU   $DEVTBLE+22                                              00490000
$OPIS    EQU   $DEVTECB                                                 00491000
$OPND    EQU   $DEVTECB+2                                               00492000
$DEVFLG3 EQU   $DEVTBLE+27                                              00493000
$SIOFLG  EQU   $DEVFLG3                                                 00494000
$IFTOUT  EQU   $DEVTBLE+36                                              00495000
$DEVSESP EQU   $IFTOUT                                                  00496000
$SSCPDAF EQU   $IFTOUT+6                                                00497000
$LDNCBPT EQU   $DEVTBLE+48                                              00498000
$RNINFO  EQU   $DEVTBLE+56                                              00499000
$DEVFLG5 EQU   $RNINFO+8                                                00500000
$DEVFLG4 EQU   $DEVTBLE+65                                              00501000
$IGLXIFB EQU   $DEVFLG4                                                 00502000
$DEVCNTS EQU   TOLTEPWA+1464                                            00503000
$SLTBL   EQU   TOLTEPWA+1468                                            00504000
$SYMBOLC EQU   $SLTBL+5                                                 00505000
$RUNTEST EQU   $SLTBL+13                                                00506000
$TESTFLG EQU   $SLTBL+21                                                00507000
$FINAL   EQU   $TESTFLG                                                 00508000
$SECLST  EQU   $SLTBL+22                                                00509000
$PRIMADR EQU   $SLTBL+130                                               00510000
$HIGHRTN EQU   $SLTBL+134                                               00511000
$INBUFR  EQU   TOLTEPWA+2104                                            00512000
#EXITA   EQU   TOLTEPWA+2632                                            00513000
$CCOMDAT EQU   TOLTEPWA+2644                                            00514000
$CFLGS   EQU   $CCOMDAT+16                                              00515000
$24FEMSG EQU   TOLTEPWA+2681                                            00516000
$24CATMG EQU   $24FEMSG+11                                              00517000
@NM00050 EQU   TOLTEPWA+2776                                            00518000
$OUNTPTR EQU   @NM00050+4                                               00519000
$NSPTR   EQU   $OUNTPTR                                                 00520000
$NSCNT   EQU   @NM00050+10                                              00521000
$ENXX    EQU   @NM00050+15                                              00522000
$IMITX   EQU   $ENXX                                                    00523000
SVESC033 EQU   TOLTEPWA+3160                                            00524000
SVECC013 EQU   TOLTEPWA+3232                                            00525000
SVEIC003 EQU   TOLTEPWA+3592                                            00526000
SVESC022 EQU   TOLTEPWA+3736                                            00527000
SVETC035 EQU   TOLTEPWA+3880                                            00528000
SVECC011 EQU   TOLTEPWA+4024                                            00529000
#EXIT    EQU   0                                                        00530000
@NM00053 EQU   0                                                        00531000
RTNDISP  EQU   @NM00053+10                                              00532000
INST     EQU   @NM00053+12                                              00533000
#MSGID   EQU   @NM00053+16                                              00534000
$NEWSPRF EQU   0                                                        00535000
$RTN#    EQU   $NEWSPRF                                                 00536000
#FLAGS   EQU   $NEWSPRF+16                                              00537000
#MSGIDRQ EQU   #FLAGS                                                   00538000
OLTENTRY EQU   0                                                        00539000
BACKSAVE EQU   0                                                        00540000
SVECC012 EQU   SVESC022                                                 00541000
SVEIC00A EQU   SVEIC003                                                 00542000
SVEIC004 EQU   SVEIC003                                                 00543000
SVEIC005 EQU   SVEIC003                                                 00544000
SVESC02A EQU   SVESC022                                                 00545000
SVESC02B EQU   SVESC022                                                 00546000
SVESC02D EQU   SVESC022                                                 00547000
SVESC02E EQU   SVESC022                                                 00548000
SVESC02F EQU   SVECC013                                                 00549000
SVESC024 EQU   SVESC022                                                 00550000
SVESC027 EQU   SVESC022                                                 00551000
SVESC029 EQU   SVESC033                                                 00552000
SVESC031 EQU   SVECC013                                                 00553000
SVESC032 EQU   SVECC011                                                 00554000
SVETC037 EQU   SVEIC003                                                 00555000
         AGO   .@UNREFD                START UNREFERENCED COMPONENTS    00556000
$RME     EQU   $NEWSPRF+36                                              00557000
@NM00056 EQU   $NEWSPRF+35                                              00558000
$ECA     EQU   $NEWSPRF+32                                              00559000
$DCHB    EQU   $NEWSPRF+28                                              00560000
$MOSIZE  EQU   $NEWSPRF+24                                              00561000
$RTSIZE  EQU   $NEWSPRF+20                                              00562000
$COUNT   EQU   $NEWSPRF+18                                              00563000
$REFNUM  EQU   $NEWSPRF+17                                              00564000
@NM00055 EQU   #FLAGS                                                   00565000
#PLKMCOR EQU   #FLAGS                                                   00566000
@NM00054 EQU   #FLAGS                                                   00567000
$VIRTUAL EQU   #FLAGS                                                   00568000
$PLINK$  EQU   $NEWSPRF+12                                              00569000
$SCTREQ  EQU   $NEWSPRF+11                                              00570000
$RM      EQU   $NEWSPRF+9                                               00571000
$CTYPE   EQU   $NEWSPRF+8                                               00572000
$CCLASS  EQU   $NEWSPRF+7                                               00573000
$CFEAT   EQU   $NEWSPRF+6                                               00574000
$CMODEL  EQU   $NEWSPRF+5                                               00575000
$TYPE    EQU   $NEWSPRF+4                                               00576000
$CLASS   EQU   $NEWSPRF+3                                               00577000
$FEAT    EQU   $NEWSPRF+2                                               00578000
$MODEL   EQU   $NEWSPRF+1                                               00579000
LEVEL    EQU   @NM00053+8                                               00580000
SECTID   EQU   @NM00053                                                 00581000
SVECC010 EQU   TOLTEPWA+3952                                            00582000
SVESC030 EQU   TOLTEPWA+3808                                            00583000
SVESC020 EQU   TOLTEPWA+3664                                            00584000
SVEIC002 EQU   TOLTEPWA+3520                                            00585000
SVECC014 EQU   TOLTEPWA+3376                                            00586000
SVESC120 EQU   TOLTEPWA+3304                                            00587000
SVESC025 EQU   TOLTEPWA+3088                                            00588000
@NM00052 EQU   TOLTEPWA+2980                                            00589000
$RPLERR  EQU   TOLTEPWA+2977                                            00590000
@NM00051 EQU   TOLTEPWA+2976                                            00591000
$R13PR3  EQU   TOLTEPWA+2972                                            00592000
$CEINT2  EQU   TOLTEPWA+2968                                            00593000
$CEINT1  EQU   TOLTEPWA+2964                                            00594000
$MSGGET  EQU   TOLTEPWA+2960                                            00595000
$ACQLIST EQU   TOLTEPWA+2956                                            00596000
$R4SAVE1 EQU   TOLTEPWA+2952                                            00597000
$CLSISS  EQU   TOLTEPWA+2950                                            00598000
$CLSCNT  EQU   TOLTEPWA+2948                                            00599000
$CUTABLE EQU   TOLTEPWA+2868                                            00600000
$BUFSZ2  EQU   TOLTEPWA+2864                                            00601000
$RESID2  EQU   TOLTEPWA+2860                                            00602000
$OLTCCW2 EQU   TOLTEPWA+2856                                            00603000
$ENDBFR2 EQU   TOLTEPWA+2852                                            00604000
$1STBFR2 EQU   TOLTEPWA+2848                                            00605000
$TECB2   EQU   TOLTEPWA+2844                                            00606000
$BUFSZ1  EQU   TOLTEPWA+2840                                            00607000
$RESID1  EQU   TOLTEPWA+2836                                            00608000
$OLTCCW1 EQU   TOLTEPWA+2832                                            00609000
$ENDBFR1 EQU   TOLTEPWA+2828                                            00610000
$1STBFR1 EQU   TOLTEPWA+2824                                            00611000
$TECB1   EQU   TOLTEPWA+2820                                            00612000
$WAITIME EQU   TOLTEPWA+2816                                            00613000
$TRTN#   EQU   TOLTEPWA+2815                                            00614000
$WIODEV  EQU   TOLTEPWA+2814                                            00615000
$RQSTSZE EQU   TOLTEPWA+2812                                            00616000
$RQSTPTR EQU   TOLTEPWA+2808                                            00617000
$R4SAVE  EQU   TOLTEPWA+2804                                            00618000
$PARTADR EQU   TOLTEPWA+2800                                            00619000
$TBSDATA EQU   TOLTEPWA+2796                                            00620000
$CTWIDTH EQU   TOLTEPWA+2795                                            00621000
$CTLINE  EQU   TOLTEPWA+2794                                            00622000
$APWIDTH EQU   TOLTEPWA+2793                                            00623000
$APLINE  EQU   TOLTEPWA+2792                                            00624000
$INDEX   EQU   $IMITX                                                   00625000
$UMXX    EQU   @NM00050+14                                              00626000
$NSXX    EQU   @NM00050+12                                              00627000
$ATACNT  EQU   $NSCNT                                                   00628000
$CTR     EQU   @NM00050+8                                               00629000
$ATAPTR  EQU   $NSPTR                                                   00630000
$DDRPTR  EQU   @NM00050                                                 00631000
$DTORESP EQU   TOLTEPWA+2712                                            00632000
$APNAME  EQU   TOLTEPWA+2704                                            00633000
$24SYMNE EQU   $24CATMG+4                                               00634000
$24DEVAD EQU   $24CATMG                                                 00635000
$24RTN#  EQU   $24FEMSG+8                                               00636000
$ESECTID EQU   $24FEMSG                                                 00637000
$24FLGS  EQU   TOLTEPWA+2680                                            00638000
$24SAVE2 EQU   TOLTEPWA+2676                                            00639000
$24SAVE1 EQU   TOLTEPWA+2672                                            00640000
$24UNADR EQU   TOLTEPWA+2668                                            00641000
$24SAV13 EQU   TOLTEPWA+2664                                            00642000
$24RETCD EQU   TOLTEPWA+2663                                            00643000
$MACID   EQU   TOLTEPWA+2661                                            00644000
$CSPARE  EQU   $CFLGS                                                   00645000
$C2WAY   EQU   $CFLGS                                                   00646000
$CINCT   EQU   $CCOMDAT+12                                              00647000
$CINADR  EQU   $CCOMDAT+8                                               00648000
$COUTCT  EQU   $CCOMDAT+4                                               00649000
$COUTAD  EQU   $CCOMDAT                                                 00650000
ROOTLOC  EQU   TOLTEPWA+2640                                            00651000
$RETREG  EQU   TOLTEPWA+2636                                            00652000
$WORK    EQU   TOLTEPWA+2376                                            00653000
$EXTA    EQU   TOLTEPWA+2320                                            00654000
$PASSONA EQU   TOLTEPWA+2264                                            00655000
$TRMINPT EQU   TOLTEPWA+2184                                            00656000
$BUFFER  EQU   TOLTEPWA+1976                                            00657000
$TLTRPL3 EQU   TOLTEPWA+1856                                            00658000
$TLTRPL2 EQU   TOLTEPWA+1736                                            00659000
$TLTRPL1 EQU   TOLTEPWA+1616                                            00660000
@NM00049 EQU   $SLTBL+135                                               00661000
$CTSTPT  EQU   $SLTBL+128                                               00662000
$TSTCNT  EQU   $SLTBL+126                                               00663000
$SECFLGS EQU   $SECLST+3                                                00664000
$SECTION EQU   $SECLST                                                  00665000
$SECACT  EQU   $TESTFLG                                                 00666000
$CANTRUN EQU   $TESTFLG                                                 00667000
$TESTSUF EQU   $RUNTEST+5                                               00668000
$TESTNUM EQU   $RUNTEST+1                                               00669000
$LETPRF  EQU   $RUNTEST                                                 00670000
$FAMILY  EQU   $SLTBL                                                   00671000
$CDEVPT  EQU   TOLTEPWA+1466                                            00672000
$FEEDBCK EQU   $DEVTBLE+66                                              00673000
$WTISUED EQU   $DEVFLG4                                                 00674000
$EXIOISD EQU   $DEVFLG4                                                 00675000
$REMWRIT EQU   $DEVFLG4                                                 00676000
$REMDONE EQU   $DEVFLG4                                                 00677000
$2NDUSED EQU   $DEVFLG4                                                 00678000
$1STUSED EQU   $DEVFLG4                                                 00679000
$EXIOLV3 EQU   $DEVFLG4                                                 00680000
@NM00048 EQU   $DEVFLG5                                                 00681000
$DVBASIC EQU   $DEVFLG5                                                 00682000
$ASCII   EQU   $DEVFLG5                                                 00683000
$DEVLU   EQU   $DEVFLG5                                                 00684000
$OPNDFAL EQU   $DEVFLG5                                                 00685000
$ACQNCB  EQU   $DEVFLG5                                                 00686000
$REMOTE  EQU   $DEVFLG5                                                 00687000
$ENDNODE EQU   $DEVFLG5                                                 00688000
$LINENME EQU   $RNINFO                                                  00689000
$CID     EQU   $DEVTBLE+52                                              00690000
$DVCOL   EQU   $LDNCBPT+2                                               00691000
$DVROW   EQU   $LDNCBPT                                                 00692000
$NCSPLP  EQU   $DEVTBLE+44                                              00693000
$DVLN    EQU   $SSCPDAF                                                 00694000
$DAF     EQU   $DEVSESP+4                                               00695000
$VARYPAB EQU   $DEVSESP                                                 00696000
$SYSMN   EQU   $DEVTBLE+28                                              00697000
@NM00047 EQU   $DEVFLG3                                                 00698000
$CLRSNT  EQU   $DEVFLG3                                                 00699000
$OLTERR  EQU   $DEVFLG3                                                 00700000
$SRTEST  EQU   $DEVFLG3                                                 00701000
$DVSNDOK EQU   $SIOFLG                                                  00702000
$POLLREQ EQU   $DEVFLG3                                                 00703000
$ACQRED  EQU   $DEVFLG3                                                 00704000
$NOTDEV  EQU   $DEVFLG3                                                 00705000
$DVINCT  EQU   $DEVTBLE+26                                              00706000
$DVBRKST EQU   $OPND+1                                                  00707000
$DVBRKSN EQU   $OPND                                                    00708000
$DVSEQNO EQU   $OPIS                                                    00709000
$CEINTRP EQU   $DEVFLG2                                                 00710000
$TESTMDE EQU   $DEVFLG2                                                 00711000
$DEVALOC EQU   $DEVFLG2                                                 00712000
$ALLDATA EQU   $DEVFLG2                                                 00713000
$ENDCNTL EQU   $DEVFLG2                                                 00714000
$CTLDEV  EQU   $DEVFLG2                                                 00715000
$NOCDS   EQU   $DEVFLG2                                                 00716000
$DATAIN  EQU   $DEVFLG2                                                 00717000
$PRIMARY EQU   $DEVFLG1                                                 00718000
$DVCTBYT EQU   $INTOCC                                                  00719000
$DVLGMDE EQU   $ATTNEXP                                                 00720000
$DVSPRM  EQU   $EVNCPLT                                                 00721000
$GRABBED EQU   $DEVFLG1                                                 00722000
$CATASTR EQU   $DEVFLG1                                                 00723000
$LETGO   EQU   $DEVFLG1                                                 00724000
$CURELEM EQU   $$SYMNME+4                                               00725000
$MSGOTSD EQU   $$SYMNME                                                 00726000
$EXTDEV  EQU   $DEVCDS+11                                               00727000
@NM00046 EQU   $DEVSDCF                                                 00728000
$NOTPRIM EQU   $DEVSDCF                                                 00729000
@NM00045 EQU   $DEVCDSF                                                 00730000
@NM00044 EQU   $DEVCDSF                                                 00731000
@NM00043 EQU   $DEVCDSF                                                 00732000
$CDSNAME EQU   $DEVCDSF                                                 00733000
$EXTRN   EQU   $DEVCDSF                                                 00734000
$CEVOLUM EQU   $DEVCDSF                                                 00735000
$SHARD   EQU   $DEVCDSF                                                 00736000
$DEVFPM  EQU   $DEVCDSF                                                 00737000
$DEVCNT  EQU   $DEVCDS+8                                                00738000
$DEVTYPE EQU   $DEVFEAT+3                                               00739000
$DEVCLAS EQU   $DEVFEAT+2                                               00740000
$DEVFRRS EQU   $DEVFEAT+1                                               00741000
$DEVMOD  EQU   $DEVFEAT                                                 00742000
$DEVRDGT EQU   @NM00041+1                                               00743000
$DEVCTLU EQU   @NM00041+1                                               00744000
$DEVCHAN EQU   @NM00041                                                 00745000
@NM00042 EQU   @NM00041                                                 00746000
$CTINDX  EQU   $DEVUNAD                                                 00747000
@NM00040 EQU   $COMMFLG+15                                              00748000
@NM00039 EQU   $COMMFLG+14                                              00749000
@NM00038 EQU   $COMMFLG+13                                              00750000
$CATMSG  EQU   $FLAG13                                                  00751000
$PRMPTSW EQU   $FLAG13                                                  00752000
$DEVENT  EQU   $FLAG13                                                  00753000
$LGON    EQU   $FLAG13                                                  00754000
$CTLOGON EQU   $FLAG13                                                  00755000
@NM00037 EQU   $FLAG12                                                  00756000
$ENDTEST EQU   $FLAG12                                                  00757000
$POSTFLG EQU   $FLAG12                                                  00758000
$OPTMSG  EQU   $FLAG12                                                  00759000
@NM00036 EQU   $COMMFLG+10                                              00760000
@NM00035 EQU   $COMMFLG+9                                               00761000
@NM00034 EQU   $COMMFLG+8                                               00762000
$VS2     EQU   $FLAG8                                                   00763000
$VS1     EQU   $FLAG8                                                   00764000
$EDOS    EQU   $FLAG8                                                   00765000
@NM00033 EQU   $FLAG8                                                   00766000
$TWOWAY  EQU   $FLAG8                                                   00767000
@NM00032 EQU   $FLAG8                                                   00768000
@NM00031 EQU   $COMMFLG+6                                               00769000
@NM00030 EQU   $COMMFLG+5                                               00770000
@NM00029 EQU   $COMMFLG+4                                               00771000
@NM00028 EQU   $COMMFLG+3                                               00772000
@NM00027 EQU   $COMMFLG+2                                               00773000
$PARTIAL EQU   $FLAG2                                                   00774000
$VALDTST EQU   $FLAG2                                                   00775000
$VALDDEV EQU   $FLAG2                                                   00776000
$DBLSLSH EQU   $FLAG2                                                   00777000
$NDR     EQU   $FLAG2                                                   00778000
@NM00026 EQU   $FLAG2                                                   00779000
@NM00025 EQU   $FLAG1                                                   00780000
$OPTCHNG EQU   $FLAG1                                                   00781000
$DEVCHNG EQU   $FLAG1                                                   00782000
$TESTCNG EQU   $FLAG1                                                   00783000
$CNSLFG  EQU   $FLAG1                                                   00784000
$TEP3RD  EQU   $FLAG1                                                   00785000
@NM00024 EQU   $CDA+120                                                 00786000
$CUCNT   EQU   $CDA+118                                                 00787000
@NM00023 EQU   $CDA+117                                                 00788000
$PRTFORM EQU   $CDA+116                                                 00789000
$OPISCNT EQU   $CDA+114                                                 00790000
$OPNDCNT EQU   $CDA+112                                                 00791000
$GETMSZE EQU   $CDA+110                                                 00792000
$GRCNTS  EQU   $CDA+108                                                 00793000
$CTLCNT  EQU   $CDA+106                                                 00794000
$ACTLVL  EQU   $CDA+105                                                 00795000
$PRNTLVL EQU   $CDA+104                                                 00796000
$ERRCNTA EQU   $CDA+102                                                 00797000
$TLCNT   EQU   $CDA+100                                                 00798000
$TIMEALW EQU   $CDA+96                                                  00799000
$PTRAREA EQU   $CDA+92                                                  00800000
$GETMPTR EQU   $CDA+88                                                  00801000
$R13PTRT EQU   $CDA+84                                                  00802000
$R13PTR  EQU   $CDA+80                                                  00803000
$TEPEND  EQU   $CDA+76                                                  00804000
$PLINKDL EQU   $CDA+72                                                  00805000
$TEPBEGN EQU   $CDA+68                                                  00806000
$FRELPTR EQU   $CDA+64                                                  00807000
$HIGHADR EQU   $HIMOREC                                                 00808000
$LOMOREC EQU   $CDA+56                                                  00809000
$ENDCOMM EQU   $CDA+48                                                  00810000
$COMMON  EQU   $RCA                                                     00811000
$SLASHAD EQU   $CDA+32                                                  00812000
$PASSON  EQU   $CDA+28                                                  00813000
$TOLBRTB EQU   $CDA+24                                                  00814000
$SCTPTR8 EQU   $CDA+20                                                  00815000
$TBWDPTR EQU   $CDA+12                                                  00816000
$TFWDPTR EQU   $CDA+8                                                   00817000
@NM00022 EQU   $CDA                                                     00818000
@NM00021 EQU   $SCTTBLE+98                                              00819000
$SCTLWTC EQU   $SCTTBLE+96                                              00820000
$SCTLWTA EQU   $SCTTBLE+92                                              00821000
#EXT     EQU   $SCTTBLE+88                                              00822000
#PASS    EQU   $SCTTBLE+84                                              00823000
#TABLE   EQU   $SCTTBLE+80                                              00824000
@NM00020 EQU   $SCTTBLE+71                                              00825000
$RETMASK EQU   $SCTTBLE+70                                              00826000
$R249255 EQU   $ROUTMSK+29                                              00827000
$R241248 EQU   $ROUTMSK+28                                              00828000
$R233240 EQU   $ROUTMSK+27                                              00829000
$R225232 EQU   $ROUTMSK+26                                              00830000
$R217224 EQU   $ROUTMSK+25                                              00831000
$R209216 EQU   $ROUTMSK+24                                              00832000
$R201208 EQU   $ROUTMSK+23                                              00833000
$R193200 EQU   $ROUTMSK+22                                              00834000
$R185192 EQU   $ROUTMSK+21                                              00835000
$R177184 EQU   $ROUTMSK+20                                              00836000
$R169176 EQU   $ROUTMSK+19                                              00837000
$R161168 EQU   $ROUTMSK+18                                              00838000
$R153160 EQU   $ROUTMSK+17                                              00839000
$R145152 EQU   $ROUTMSK+16                                              00840000
$R137144 EQU   $ROUTMSK+15                                              00841000
$R129136 EQU   $ROUTMSK+14                                              00842000
$R121128 EQU   $ROUTMSK+13                                              00843000
$R113120 EQU   $ROUTMSK+12                                              00844000
$R105112 EQU   $ROUTMSK+11                                              00845000
$R097104 EQU   $ROUTMSK+10                                              00846000
$R089096 EQU   $ROUTMSK+9                                               00847000
$R081088 EQU   $ROUTMSK+8                                               00848000
$R073080 EQU   $ROUTMSK+7                                               00849000
$R065072 EQU   $ROUTMSK+6                                               00850000
$R057064 EQU   $ROUTMSK+5                                               00851000
$R049056 EQU   $ROUTMSK+4                                               00852000
$R041048 EQU   $ROUTMSK+3                                               00853000
$R033040 EQU   $ROUTMSK+2                                               00854000
$R025032 EQU   $ROUTMSK+1                                               00855000
$R017024 EQU   $ROUTMSK                                                 00856000
$TOTFLG2 EQU   $SCTTBLE+39                                              00857000
@NM00019 EQU   $TOTFLG1                                                 00858000
@NM00018 EQU   $TOTFLG1                                                 00859000
@NM00017 EQU   $TOTFLG1                                                 00860000
$CTEQTT  EQU   $TOTFLG1                                                 00861000
@NM00016 EQU   $TOTFLG1                                                 00862000
@NM00015 EQU   $TOTFLG1                                                 00863000
$LINESHR EQU   $TOTFLG1                                                 00864000
@NM00014 EQU   $OLTFLG2                                                 00865000
@NM00013 EQU   $OLTFLG2                                                 00866000
@NM00012 EQU   $OLTFLG2                                                 00867000
@NM00011 EQU   $OLTFLG2                                                 00868000
@NM00010 EQU   $OLTFLG2                                                 00869000
@NM00009 EQU   $OLTFLG2                                                 00870000
@NM00008 EQU   $OLTFLG2                                                 00871000
$TALK    EQU   $OLTFLG2                                                 00872000
$DYCOM   EQU   $OLTFLGS                                                 00873000
@NM00007 EQU   $OLTFLGS                                                 00874000
$TRACE   EQU   $OLTFLGS                                                 00875000
$RETCODE EQU   $OLTFLGS                                                 00876000
$CONTCB  EQU   $OLTFLGS                                                 00877000
$RETAIN  EQU   $OLTFLGS                                                 00878000
$MANINTV EQU   $OLTFLGS                                                 00879000
$OLTSIZE EQU   $SCTTBLE+34                                              00880000
$QSCTMOD EQU   $EXECFLG                                                 00881000
$CTRLMOD EQU   $EXECFLG                                                 00882000
$ERRCNT  EQU   $EXECFLG                                                 00883000
$MULTDEV EQU   $EXECFLG                                                 00884000
@NM00006 EQU   $EXECFLG                                                 00885000
$RMSKCNT EQU   $SCTTBLE+32                                              00886000
$SYNAME  EQU   $CDS8T19+4                                               00887000
$EXTSIG  EQU   $CDS8T19+3                                               00888000
$CDFLGS  EQU   $CDS8T19+1                                               00889000
$CDSCNT  EQU   $CDS8T19                                                 00890000
$PDEVDSC EQU   $SCTTBLE+16                                              00891000
$PDEVADR EQU   $SCTTBLE+12                                              00892000
$COMMCN  EQU   $CDSFLGS                                                 00893000
$CUSTSYM EQU   $CDSFLGS                                                 00894000
$TWOCHSW EQU   $CDSFLGS                                                 00895000
$SYMNAME EQU   $CDSFLGS                                                 00896000
$EXTINTC EQU   $CDSFLGS                                                 00897000
$CEVOL   EQU   $CDSFLGS                                                 00898000
$SHARED  EQU   $CDSFLGS                                                 00899000
$FPM     EQU   $CDSFLGS                                                 00900000
$LASTSUB EQU   $PDEVFLG                                                 00901000
@NM00005 EQU   $PDEVFLG                                                 00902000
@NM00004 EQU   $PDEVFLG                                                 00903000
@NM00003 EQU   $PDEVFLG                                                 00904000
$LASTDEV EQU   $PDEVFLG                                                 00905000
@NM00002 EQU   $PDEVFLG                                                 00906000
$EXFILPT EQU   $PDEVFLG                                                 00907000
$FPMOLD  EQU   $PDEVFLG                                                 00908000
$TSSSYM  EQU   $SCTTBLE+8                                               00909000
$SCTLEVL EQU   $SCTTBLE+7                                               00910000
$DRIVER  EQU   $SCTTBLE+6                                               00911000
$RT0916  EQU   $SCTTBLE+5                                               00912000
$RT0108  EQU   $SCTTBLE+4                                               00913000
$LOOPTST EQU   $ERROPT                                                  00914000
$LOOPERR EQU   $ERROPT                                                  00915000
$NERRPRT EQU   $ERROPT                                                  00916000
$ALTPRNT EQU   $ERROPT                                                  00917000
$CATERR  EQU   $ERROPT                                                  00918000
$TESTERR EQU   $ERROPT                                                  00919000
$FSTCOMM EQU   $TESTOPT                                                 00920000
$INDEFLP EQU   $TESTOPT                                                 00921000
$NOPRT   EQU   $TESTOPT                                                 00922000
$PARAPRT EQU   $TESTOPT                                                 00923000
@NM00001 EQU   $TESTOPT                                                 00924000
$ERRLPCT EQU   $SCTTBLE                                                 00925000
.@UNREFD ANOP                          END UNREFERENCED COMPONENTS      00926000
@RT00039 EQU   T35C0080                                                 00927000
@ENDDATA EQU   *                                                        00928000
         END   ISTTC035,(C'PLS1539',0702,78337)                         00929000
./  ADD  SSI=83370167,NAME=ISTTC037
         TITLE 'DUMP FUNCTION - ISTTC037'                               00001000
ISTTC037 CSECT ,                                                   0001 00002000
@MAINENT DS    0H                                                  0001 00003000
         USING *,@15                                               0001 00004000
         B     @PROLOG                                             0001 00005000
         DC    AL1(16)                                             0001 00006000
         DC    C'ISTTC037  78.337'                                 0001 00007000
         DROP  @15                                                      00008000
@PROLOG  STM   @14,@12,12(@13)                                     0001 00009000
         BALR  @12,0                                               0001 00010000
@PSTART  DS    0H                                                  0001 00011000
         USING @PSTART,@12                                         0001 00012000
*   R15=R13;                        /* SET BACKSAVE POINTER          */ 00013000
         LR    R15,R13                                             0056 00014000
*   R13=ADDR(SVESC02D);             /* SET POINTER TO SAVE AREA      */ 00015000
         LA    R13,SVESC02D(,WAPTR)                                0057 00016000
*   BACKSAVE(3)=R13;                /* CHAIN AREAS TOGETHER          */ 00017000
         ST    R13,BACKSAVE+8(,R15)                                0058 00018000
*   SVESC02D(2)=R15;                                               0059 00019000
*                                                                  0059 00020000
         ST    R15,SVESC02D+4(,WAPTR)                              0059 00021000
*/********************************************************************/ 00022000
*/*            CHECK FOR ABEND PROCESSING IN PROGRESS                */ 00023000
*/********************************************************************/ 00024000
*                                                                  0060 00025000
*   IF $ABNDBIT=ON THEN             /* CHECK FOR ABEND IN PROGRESS   */ 00026000
         TM    $ABNDBIT(WAPTR),B'00000010'                         0060 00027000
         BNO   @RF00060                                            0060 00028000
*     DO;                                                          0061 00029000
*T37C0020:                                                         0062 00030000
*       ABNDPTR=R5;                 /* POINTER TO ABEND SAVE AREA    */ 00031000
T37C0020 LR    ABNDPTR,R5                                          0062 00032000
*/********************************************************************/ 00033000
*/*                 OUTPUT   ABEND   MESSAGE                         */ 00034000
*/********************************************************************/ 00035000
*                                                                  0063 00036000
*       /*************************************************************/ 00037000
*       /*                                                           */ 00038000
*       /* TCEC MSGN(540)CKABEND(YES)DIR(NET) INVOKED                */ 00039000
*       /*                                                           */ 00040000
*       /*************************************************************/ 00041000
*                                                                  0063 00042000
*       $TCECM='1'B;                /* SET TCEC SW IN RCA            */ 00043000
         OI    $TCECM(WAPTR),B'00000001'                           0063 00044000
*       R1=ADDR($TCA05);            /* SET UP PARM LIST $TR          */ 00045000
         LA    R1,$TCA05                                           0064 00046000
*       IF $ABTERM='1'B             /* IS ABEND OCCURING             */ 00047000
*         THEN                                                     0065 00048000
         TM    $ABTERM(WAPTR),B'00000010'                          0065 00049000
         BNO   @RF00065                                            0065 00050000
*         CALL ISTSC020;            /* YES- CALL CECOM (TCEC) DIRECT */ 00051000
         L     @15,@CV00422                                        0066 00052000
         BALR  @14,@15                                             0066 00053000
*       ELSE                                                       0067 00054000
*         CALL #EXIT;               /* NO- CALL CECOM VIA RES MGR    */ 00055000
         B     @RC00065                                            0067 00056000
@RF00065 L     @15,#EXITA(,WAPTR)                                  0067 00057000
         BALR  @14,@15                                             0067 00058000
*       DCL                                                        0068 00059000
*         1 $TCA05,                 /* TCEC PARM LIST                */ 00060000
*          2 $TCB05 FIXED(32) INIT(540),/* MSG NUMBER                */ 00061000
*          2 $TCC05 FIXED(32) INIT(0),/* INCT LEN                    */ 00062000
*          2 $TCD05 BIT(8) INIT('00001100'B),/* FLAG                 */ 00063000
*          2 $TCE05 CHAR(4) INIT('FFFFFFFF'X);/* MSSAGE MASK         */ 00064000
@RC00065 DS    0H                                                  0069 00065000
*/********************************************************************/ 00066000
*/*                 FORMAT ABEND PSW MESSAGE                         */ 00067000
*/********************************************************************/ 00068000
*                                                                  0069 00069000
*       /*************************************************************/ 00070000
*       /*                                                           */ 00071000
*       /* ITACONV FROM(LPSW)TO(PSWL)V INVOKED                       */ 00072000
*       /*                                                           */ 00073000
*       /*************************************************************/ 00074000
*                                                                  0069 00075000
*       DCL                                                        0069 00076000
*        (ITATCF,                                                  0069 00077000
*         ITATCT) CHAR(*) BASED;    /* GENERATE WORK VARABLES        */ 00078000
*       DCL                                                        0070 00079000
*         ITATCTS FIXED;            /* TEMP SPOT FOR ALTERED BYTE    */ 00080000
*       RFY                                                        0071 00081000
*         ITATCF BASED(ADDR(LPSW)); /* MAP VARIABLE OVER FROM        */ 00082000
*       RFY                                                        0072 00083000
*         ITATCT BASED(ADDR(PSWL)); /* MAP VARIBABLE OVER TO         */ 00084000
*       UNPK(ITATCT(1:LENGTH(PSWL)+1),ITATCF(1:LENGTH(LPSW)+1));/* 0073 00085000
*                                      EXPAND HEX TO EBCDIC          */ 00086000
         LA    @14,2104                                            0073 00087000
         ALR   @14,WAPTR                                           0073 00088000
         UNPK  ITATCT(9,@14),ITATCF(5,ABNDPTR)                     0073 00089000
*       TR(ITATCT(1:LENGTH(PSWL)),$TRTBL);/* CONVERT FA-FF TO C1-C6  */ 00090000
         L     @03,RCAPTR(,WAPTR)                                  0074 00091000
         L     @03,$TRTBLA(,@03)                                   0074 00092000
         TR    ITATCT(8,@14),$TRTBL(@03)                           0074 00093000
*       PSWD=' ';                   /* INSERT BLANK SEPERATOR.       */ 00094000
*                                                                  0075 00095000
         MVI   PSWD(WAPTR),C' '                                    0075 00096000
*       /*************************************************************/ 00097000
*       /*                                                           */ 00098000
*       /* ITACONV FROM(RPSW)TO(PSWR)V INVOKED                       */ 00099000
*       /*                                                           */ 00100000
*       /*************************************************************/ 00101000
*                                                                  0076 00102000
*       RFY                                                        0076 00103000
*         ITATCF BASED(ADDR(RPSW)); /* MAP VARIABLE OVER FROM        */ 00104000
*       RFY                                                        0077 00105000
*         ITATCT BASED(ADDR(PSWR)); /* MAP VARIBABLE OVER TO         */ 00106000
*       UNPK(ITATCT(1:LENGTH(PSWR)+1),ITATCF(1:LENGTH(RPSW)+1));/* 0078 00107000
*                                      EXPAND HEX TO EBCDIC          */ 00108000
         LA    @14,2113                                            0078 00109000
         ALR   @14,WAPTR                                           0078 00110000
         UNPK  ITATCT(9,@14),ITATCF+4(5,ABNDPTR)                   0078 00111000
*       TR(ITATCT(1:LENGTH(PSWR)),$TRTBL);/* CONVERT FA-FF TO C1-C6  */ 00112000
*                                                                  0079 00113000
         TR    ITATCT(8,@14),$TRTBL(@03)                           0079 00114000
*       /*************************************************************/ 00115000
*       /*                                                           */ 00116000
*       /* TCEC                                                      */ 00117000
*       /* MSGN(540)CKABEND(YES)DIR(NET)MSGMSK('02000000'X)SUB(YES)  */ 00118000
*       /* INVOKED                                                   */ 00119000
*       /*                                                           */ 00120000
*       /*************************************************************/ 00121000
*                                                                  0080 00122000
*       $TCECM='1'B;                /* SET TCEC SW IN RCA            */ 00123000
         OI    $TCECM(WAPTR),B'00000001'                           0080 00124000
*       R1=ADDR($TCA08);            /* SET UP PARM LIST $TR          */ 00125000
         LA    R1,$TCA08                                           0081 00126000
*       CALL S20CEC03;              /* CALL TCEC-MULTIPLE LN         */ 00127000
         L     @15,@CV00446                                        0082 00128000
         BALR  @14,@15                                             0082 00129000
*       DCL                                                        0083 00130000
*         1 $TCA08,                 /* TCEC PARM LIST                */ 00131000
*          2 $TCB08 FIXED(32) INIT(540),/* MSG NUMBER                */ 00132000
*          2 $TCC08 FIXED(32) INIT(0),/* INCT LEN                    */ 00133000
*          2 $TCD08 BIT(8) INIT('10001100'B),/* FLAG                 */ 00134000
*          2 $TCE08 CHAR(4) INIT('02000000'X);/* MSSAGE MASK         */ 00135000
*/********************************************************************/ 00136000
*/*                 FORMAT GR 0-3 MESSAGE                            */ 00137000
*/********************************************************************/ 00138000
*                                                                  0084 00139000
*       DO I=1 TO 4;                                               0084 00140000
         LA    I,1                                                 0084 00141000
@DL00084 DS    0H                                                  0085 00142000
*         GRMSG=GMSG(I);            /* INSERT MESSAGE IDENTIFIER     */ 00143000
*                                                                  0085 00144000
         LR    @14,I                                               0085 00145000
         ALR   @14,@14                                             0085 00146000
         LA    @11,GMSG-2(@14)                                     0085 00147000
         MVC   GRMSG(2,WAPTR),0(@11)                               0085 00148000
*         /***********************************************************/ 00149000
*         /*                                                         */ 00150000
*         /* ITACONV FROM(GPR)TO(TBUFF)TYPE(HE)COUNT(16) INVOKED     */ 00151000
*         /*                                                         */ 00152000
*         /***********************************************************/ 00153000
*                                                                  0086 00154000
*         DCL                                                      0086 00155000
*           1 ITATCPRM BDY(WORD),   /* CONVERT PARAMETER LIST        */ 00156000
*            2 * CHAR(4) INIT('0102F4F1'X),                        0086 00157000
*            2 ITATCFR PTR,         /* ADDRESS OF FROM FIELD         */ 00158000
*            2 ITATCTO PTR,         /* ADDRESS OF TO FIELD           */ 00159000
*            2 * BIT(8) INIT(0),    /* FLAGS FOR CONVERT MODULE      */ 00160000
*             3 ITATCTP BIT(1),     /* TYPE OF CONVERT REQUIRED      */ 00161000
*            2 ITATCNT FIXED(8);    /* NUMBER OF BYTES TO CONVERT    */ 00162000
*         ITATCFR=ADDR(GPR);        /* SET THE FROM ADDRESS          */ 00163000
         LA    @14,GPR(,ABNDPTR)                                   0087 00164000
         ST    @14,ITATCFR                                         0087 00165000
*         ITATCTO=ADDR(TBUFF);      /* SET THE TO ADDRESS            */ 00166000
         LA    @14,TBUFF(,WAPTR)                                   0088 00167000
         ST    @14,ITATCTO                                         0088 00168000
*         ITATCTP='1'B;             /* SET THE TYPE OF CONVERT BIT   */ 00169000
         OI    ITATCTP,B'10000000'                                 0089 00170000
*         ITATCNT=16;               /* GIVE THE CONVERT BYTE COUNT   */ 00171000
         MVI   ITATCNT,X'10'                                       0090 00172000
*         R1=ADDR(ITATCPRM);        /* POINT TO CONVERT PARM LIST    */ 00173000
         LA    R1,ITATCPRM                                         0091 00174000
*         CALL ISTSC021;            /* CALL CONVERT DIRECTLY         */ 00175000
*                                                                  0092 00176000
         L     @15,@CV00461                                        0092 00177000
         BALR  @14,@15                                             0092 00178000
*         /***********************************************************/ 00179000
*         /*                                                         */ 00180000
*         /* TCEC                                                    */ 00181000
*         /* MSGN(540)CKABEND(YES)DIR(NET)MSGMSK('01000000'X)SUB(YES)*/ 00182000
*         /* INVOKED                                                 */ 00183000
*         /*                                                         */ 00184000
*         /***********************************************************/ 00185000
*                                                                  0093 00186000
*         $TCECM='1'B;              /* SET TCEC SW IN RCA            */ 00187000
         OI    $TCECM(WAPTR),B'00000001'                           0093 00188000
*         R1=ADDR($TCA10);          /* SET UP PARM LIST $TR          */ 00189000
         LA    R1,$TCA10                                           0094 00190000
*         CALL S20CEC03;            /* CALL TCEC-MULTIPLE LN         */ 00191000
         L     @15,@CV00446                                        0095 00192000
         BALR  @14,@15                                             0095 00193000
*         DCL                                                      0096 00194000
*           1 $TCA10,               /* TCEC PARM LIST                */ 00195000
*            2 $TCB10 FIXED(32) INIT(540),/* MSG NUMBER              */ 00196000
*            2 $TCC10 FIXED(32) INIT(0),/* INCT LEN                  */ 00197000
*            2 $TCD10 BIT(8) INIT('10001100'B),/* FLAG               */ 00198000
*            2 $TCE10 CHAR(4) INIT('01000000'X);/* MSSAGE MASK       */ 00199000
*         ABNDPTR=ABNDPTR+16;       /* UPDATE STORAGE POINTER.       */ 00200000
         AL    ABNDPTR,@CF00061                                    0097 00201000
*       END;                                                       0098 00202000
         AL    I,@CF00072                                          0098 00203000
         C     I,@CF00068                                          0098 00204000
         BNH   @DL00084                                            0098 00205000
*     END;                          /* END OF ABEND ONLY SECTION     */ 00206000
*/********************************************************************/ 00207000
*/*   OUTPUT START AND ENDING ADDRESS MESSAGE HEADER.                */ 00208000
*/********************************************************************/ 00209000
*                                                                  0100 00210000
*T37C0040:                                                         0100 00211000
*   IF $ABNDBIT=OFF                 /* IF ABNDING MSG TO NET OPR     */ 00212000
*     THEN                                                         0100 00213000
@RF00060 DS    0H                                                  0100 00214000
T37C0040 TM    $ABNDBIT(WAPTR),B'00000010'                         0100 00215000
         BNZ   @RF00100                                            0100 00216000
*     DO;                                                          0101 00217000
*                                                                  0101 00218000
*       /*************************************************************/ 00219000
*       /*                                                           */ 00220000
*       /* TCEC MSGN(540)MSGMSK('40000000'X) INVOKED                 */ 00221000
*       /*                                                           */ 00222000
*       /*************************************************************/ 00223000
*                                                                  0102 00224000
*       $TCECM='1'B;                /* SET TCEC SW IN RCA            */ 00225000
         OI    $TCECM(WAPTR),B'00000001'                           0102 00226000
*       R1=ADDR($TCA11);            /* SET UP PARM LIST $TR          */ 00227000
         LA    R1,$TCA11                                           0103 00228000
*       CALL S20CEC03;              /* CALL TCEC-MULTIPLE LN         */ 00229000
         L     @15,@CV00446                                        0104 00230000
         BALR  @14,@15                                             0104 00231000
*       DCL                                                        0105 00232000
*         1 $TCA11,                 /* TCEC PARM LIST                */ 00233000
*          2 $TCB11 FIXED(32) INIT(540),/* MSG NUMBER                */ 00234000
*          2 $TCC11 FIXED(32) INIT(0),/* INCT LEN                    */ 00235000
*          2 $TCD11 BIT(8) INIT('00000000'B),/* FLAG                 */ 00236000
*          2 $TCE11 CHAR(4) INIT('40000000'X);/* MSSAGE MASK         */ 00237000
*     END;                                                         0106 00238000
*   ELSE                                                           0107 00239000
*     DO;                                                          0107 00240000
*                                                                  0107 00241000
         B     @RC00100                                            0107 00242000
@RF00100 DS    0H                                                  0108 00243000
*       /*************************************************************/ 00244000
*       /*                                                           */ 00245000
*       /* TCEC MSGN(540)CKABEND(YES)DIR(NET)MSGMSK('40000000'X)     */ 00246000
*       /* INVOKED                                                   */ 00247000
*       /*                                                           */ 00248000
*       /*************************************************************/ 00249000
*                                                                  0108 00250000
*       $TCECM='1'B;                /* SET TCEC SW IN RCA            */ 00251000
         OI    $TCECM(WAPTR),B'00000001'                           0108 00252000
*       R1=ADDR($TCA12);            /* SET UP PARM LIST $TR          */ 00253000
         LA    R1,$TCA12                                           0109 00254000
*       CALL S20CEC03;              /* CALL TCEC-MULTIPLE LN         */ 00255000
         L     @15,@CV00446                                        0110 00256000
         BALR  @14,@15                                             0110 00257000
*       DCL                                                        0111 00258000
*         1 $TCA12,                 /* TCEC PARM LIST                */ 00259000
*          2 $TCB12 FIXED(32) INIT(540),/* MSG NUMBER                */ 00260000
*          2 $TCC12 FIXED(32) INIT(0),/* INCT LEN                    */ 00261000
*          2 $TCD12 BIT(8) INIT('00001100'B),/* FLAG                 */ 00262000
*          2 $TCE12 CHAR(4) INIT('40000000'X);/* MSSAGE MASK         */ 00263000
*     END;                                                         0112 00264000
*                                                                  0112 00265000
*/********************************************************************/ 00266000
*/* ASSEMBLE & CONVERT TO EBCDIC ALL START & END ADDRESSES.          */ 00267000
*/********************************************************************/ 00268000
*                                                                  0113 00269000
*   ADAREA(1)=$RCA;                 /* ADDRESS OF RES COMN START     */ 00270000
@RC00100 L     @14,$RCA(,WAPTR)                                    0113 00271000
         ST    @14,ADAREA(,WAPTR)                                  0113 00272000
*   ADAREA(2)=$ENDCOMM;             /* ADDRESS OF WORK AREA END.     */ 00273000
*                                                                  0114 00274000
         L     @14,$ENDCOMM(,WAPTR)                                0114 00275000
         ST    @14,ADAREA+4(,WAPTR)                                0114 00276000
*   /*****************************************************************/ 00277000
*   /*                                                               */ 00278000
*   /* ITACONV FROM(STMSG)TO($INBUFR)TYPE(HE)COUNT(8) INVOKED        */ 00279000
*   /*                                                               */ 00280000
*   /*****************************************************************/ 00281000
*                                                                  0115 00282000
*   ITATCFR=ADDR(STMSG);            /* SET THE FROM ADDRESS          */ 00283000
         LA    @14,STMSG(,WAPTR)                                   0115 00284000
         ST    @14,ITATCFR                                         0115 00285000
*   ITATCTO=ADDR($INBUFR);          /* SET THE TO ADDRESS            */ 00286000
         LA    @14,$INBUFR(,WAPTR)                                 0116 00287000
         ST    @14,ITATCTO                                         0116 00288000
*   ITATCTP='1'B;                   /* SET THE TYPE OF CONVERT BIT   */ 00289000
         OI    ITATCTP,B'10000000'                                 0117 00290000
*   ITATCNT=8;                      /* GIVE THE CONVERT BYTE COUNT   */ 00291000
         MVI   ITATCNT,X'08'                                       0118 00292000
*   R1=ADDR(ITATCPRM);              /* POINT TO CONVERT PARM LIST    */ 00293000
         LA    R1,ITATCPRM                                         0119 00294000
*   CALL ISTSC021;                  /* CALL CONVERT DIRECTLY         */ 00295000
         L     @15,@CV00461                                        0120 00296000
         BALR  @14,@15                                             0120 00297000
*   IF $ABNDBIT=OFF                 /* IF ABNDING MSG TO NET OPR     */ 00298000
*     THEN                                                         0121 00299000
         TM    $ABNDBIT(WAPTR),B'00000010'                         0121 00300000
         BNZ   @RF00121                                            0121 00301000
*     DO;                                                          0122 00302000
*                                                                  0122 00303000
*       /*************************************************************/ 00304000
*       /*                                                           */ 00305000
*       /* TCEC MSGN(540)MSGMSK('20000000'X)SUB(YES) INVOKED         */ 00306000
*       /*                                                           */ 00307000
*       /*************************************************************/ 00308000
*                                                                  0123 00309000
*       $TCECM='1'B;                /* SET TCEC SW IN RCA            */ 00310000
         OI    $TCECM(WAPTR),B'00000001'                           0123 00311000
*       R1=ADDR($TCA14);            /* SET UP PARM LIST $TR          */ 00312000
         LA    R1,$TCA14                                           0124 00313000
*       CALL S20CEC03;              /* CALL TCEC-MULTIPLE LN         */ 00314000
         L     @15,@CV00446                                        0125 00315000
         BALR  @14,@15                                             0125 00316000
*       DCL                                                        0126 00317000
*         1 $TCA14,                 /* TCEC PARM LIST                */ 00318000
*          2 $TCB14 FIXED(32) INIT(540),/* MSG NUMBER                */ 00319000
*          2 $TCC14 FIXED(32) INIT(0),/* INCT LEN                    */ 00320000
*          2 $TCD14 BIT(8) INIT('10000000'B),/* FLAG                 */ 00321000
*          2 $TCE14 CHAR(4) INIT('20000000'X);/* MSSAGE MASK         */ 00322000
*     END;                                                         0127 00323000
*   ELSE                                                           0128 00324000
*     DO;                                                          0128 00325000
*                                                                  0128 00326000
         B     @RC00121                                            0128 00327000
@RF00121 DS    0H                                                  0129 00328000
*       /*************************************************************/ 00329000
*       /*                                                           */ 00330000
*       /* TCEC                                                      */ 00331000
*       /* MSGN(540)CKABEND(YES)DIR(NET)MSGMSK('20000000'X)SUB(YES)  */ 00332000
*       /* INVOKED                                                   */ 00333000
*       /*                                                           */ 00334000
*       /*************************************************************/ 00335000
*                                                                  0129 00336000
*       $TCECM='1'B;                /* SET TCEC SW IN RCA            */ 00337000
         OI    $TCECM(WAPTR),B'00000001'                           0129 00338000
*       R1=ADDR($TCA15);            /* SET UP PARM LIST $TR          */ 00339000
         LA    R1,$TCA15                                           0130 00340000
*       CALL S20CEC03;              /* CALL TCEC-MULTIPLE LN         */ 00341000
         L     @15,@CV00446                                        0131 00342000
         BALR  @14,@15                                             0131 00343000
*       DCL                                                        0132 00344000
*         1 $TCA15,                 /* TCEC PARM LIST                */ 00345000
*          2 $TCB15 FIXED(32) INIT(540),/* MSG NUMBER                */ 00346000
*          2 $TCC15 FIXED(32) INIT(0),/* INCT LEN                    */ 00347000
*          2 $TCD15 BIT(8) INIT('10001100'B),/* FLAG                 */ 00348000
*          2 $TCE15 CHAR(4) INIT('20000000'X);/* MSSAGE MASK         */ 00349000
*     END;                                                         0133 00350000
*   ADAREA(1)=$TEPBEGN;             /* ADDRESS OF TOLTEP START.      */ 00351000
@RC00121 L     @14,$TEPBEGN(,WAPTR)                                0134 00352000
         ST    @14,ADAREA(,WAPTR)                                  0134 00353000
*   ADAREA(2)=$TEPEND;              /* ADDRESS OF TOLTEP END.        */ 00354000
*                                                                  0135 00355000
         L     @14,$TEPEND(,WAPTR)                                 0135 00356000
         ST    @14,ADAREA+4(,WAPTR)                                0135 00357000
*   /*****************************************************************/ 00358000
*   /*                                                               */ 00359000
*   /* ITACONV FROM(STMSG)TO($INBUFR)TYPE(HE)COUNT(8) INVOKED        */ 00360000
*   /*                                                               */ 00361000
*   /*****************************************************************/ 00362000
*                                                                  0136 00363000
*   ITATCFR=ADDR(STMSG);            /* SET THE FROM ADDRESS          */ 00364000
         LA    @14,STMSG(,WAPTR)                                   0136 00365000
         ST    @14,ITATCFR                                         0136 00366000
*   ITATCTO=ADDR($INBUFR);          /* SET THE TO ADDRESS            */ 00367000
         LA    @14,$INBUFR(,WAPTR)                                 0137 00368000
         ST    @14,ITATCTO                                         0137 00369000
*   ITATCTP='1'B;                   /* SET THE TYPE OF CONVERT BIT   */ 00370000
         OI    ITATCTP,B'10000000'                                 0138 00371000
*   ITATCNT=8;                      /* GIVE THE CONVERT BYTE COUNT   */ 00372000
         MVI   ITATCNT,X'08'                                       0139 00373000
*   R1=ADDR(ITATCPRM);              /* POINT TO CONVERT PARM LIST    */ 00374000
         LA    R1,ITATCPRM                                         0140 00375000
*   CALL ISTSC021;                  /* CALL CONVERT DIRECTLY         */ 00376000
         L     @15,@CV00461                                        0141 00377000
         BALR  @14,@15                                             0141 00378000
*   IF $ABNDBIT=OFF                 /* IF ABNDING MSG TO NET OPR     */ 00379000
*     THEN                                                         0142 00380000
         TM    $ABNDBIT(WAPTR),B'00000010'                         0142 00381000
         BNZ   @RF00142                                            0142 00382000
*     DO;                                                          0143 00383000
*                                                                  0143 00384000
*       /*************************************************************/ 00385000
*       /*                                                           */ 00386000
*       /* TCEC MSGN(540)MSGMSK('10000000'X)SUB(YES) INVOKED         */ 00387000
*       /*                                                           */ 00388000
*       /*************************************************************/ 00389000
*                                                                  0144 00390000
*       $TCECM='1'B;                /* SET TCEC SW IN RCA            */ 00391000
         OI    $TCECM(WAPTR),B'00000001'                           0144 00392000
*       R1=ADDR($TCA17);            /* SET UP PARM LIST $TR          */ 00393000
         LA    R1,$TCA17                                           0145 00394000
*       CALL S20CEC03;              /* CALL TCEC-MULTIPLE LN         */ 00395000
         L     @15,@CV00446                                        0146 00396000
         BALR  @14,@15                                             0146 00397000
*       DCL                                                        0147 00398000
*         1 $TCA17,                 /* TCEC PARM LIST                */ 00399000
*          2 $TCB17 FIXED(32) INIT(540),/* MSG NUMBER                */ 00400000
*          2 $TCC17 FIXED(32) INIT(0),/* INCT LEN                    */ 00401000
*          2 $TCD17 BIT(8) INIT('10000000'B),/* FLAG                 */ 00402000
*          2 $TCE17 CHAR(4) INIT('10000000'X);/* MSSAGE MASK         */ 00403000
*     END;                                                         0148 00404000
*   ELSE                                                           0149 00405000
*     DO;                                                          0149 00406000
*                                                                  0149 00407000
         B     @RC00142                                            0149 00408000
@RF00142 DS    0H                                                  0150 00409000
*       /*************************************************************/ 00410000
*       /*                                                           */ 00411000
*       /* TCEC                                                      */ 00412000
*       /* MSGN(540)CKABEND(YES)DIR(NET)MSGMSK('10000000'X)SUB(YES)  */ 00413000
*       /* INVOKED                                                   */ 00414000
*       /*                                                           */ 00415000
*       /*************************************************************/ 00416000
*                                                                  0150 00417000
*       $TCECM='1'B;                /* SET TCEC SW IN RCA            */ 00418000
         OI    $TCECM(WAPTR),B'00000001'                           0150 00419000
*       R1=ADDR($TCA18);            /* SET UP PARM LIST $TR          */ 00420000
         LA    R1,$TCA18                                           0151 00421000
*       CALL S20CEC03;              /* CALL TCEC-MULTIPLE LN         */ 00422000
         L     @15,@CV00446                                        0152 00423000
         BALR  @14,@15                                             0152 00424000
*       DCL                                                        0153 00425000
*         1 $TCA18,                 /* TCEC PARM LIST                */ 00426000
*          2 $TCB18 FIXED(32) INIT(540),/* MSG NUMBER                */ 00427000
*          2 $TCC18 FIXED(32) INIT(0),/* INCT LEN                    */ 00428000
*          2 $TCD18 BIT(8) INIT('10001100'B),/* FLAG                 */ 00429000
*          2 $TCE18 CHAR(4) INIT('10000000'X);/* MSSAGE MASK         */ 00430000
*     END;                                                         0154 00431000
*   ADAREA(1)=$LOWADDR;             /* ADDRESS OF OLT AREA START.    */ 00432000
@RC00142 L     @14,$LOWADDR(,WAPTR)                                0155 00433000
         ST    @14,ADAREA(,WAPTR)                                  0155 00434000
*   ADAREA(2)=$HIGHADR;             /* ADDRESS OF OLT AREA END.      */ 00435000
*                                                                  0156 00436000
         L     @14,$HIGHADR(,WAPTR)                                0156 00437000
         ST    @14,ADAREA+4(,WAPTR)                                0156 00438000
*   /*****************************************************************/ 00439000
*   /*                                                               */ 00440000
*   /* ITACONV FROM(STMSG)TO($INBUFR)TYPE(HE)COUNT(8) INVOKED        */ 00441000
*   /*                                                               */ 00442000
*   /*****************************************************************/ 00443000
*                                                                  0157 00444000
*   ITATCFR=ADDR(STMSG);            /* SET THE FROM ADDRESS          */ 00445000
         LA    @14,STMSG(,WAPTR)                                   0157 00446000
         ST    @14,ITATCFR                                         0157 00447000
*   ITATCTO=ADDR($INBUFR);          /* SET THE TO ADDRESS            */ 00448000
         LA    @14,$INBUFR(,WAPTR)                                 0158 00449000
         ST    @14,ITATCTO                                         0158 00450000
*   ITATCTP='1'B;                   /* SET THE TYPE OF CONVERT BIT   */ 00451000
         OI    ITATCTP,B'10000000'                                 0159 00452000
*   ITATCNT=8;                      /* GIVE THE CONVERT BYTE COUNT   */ 00453000
         MVI   ITATCNT,X'08'                                       0160 00454000
*   R1=ADDR(ITATCPRM);              /* POINT TO CONVERT PARM LIST    */ 00455000
         LA    R1,ITATCPRM                                         0161 00456000
*   CALL ISTSC021;                  /* CALL CONVERT DIRECTLY         */ 00457000
         L     @15,@CV00461                                        0162 00458000
         BALR  @14,@15                                             0162 00459000
*   IF $ABNDBIT=OFF                 /* IF ABNDING MSG TO NET OPR     */ 00460000
*     THEN                                                         0163 00461000
         TM    $ABNDBIT(WAPTR),B'00000010'                         0163 00462000
         BNZ   @RF00163                                            0163 00463000
*     DO;                                                          0164 00464000
*                                                                  0164 00465000
*       /*************************************************************/ 00466000
*       /*                                                           */ 00467000
*       /* TCEC MSGN(540)MSGMSK('08000000'X)SUB(YES) INVOKED         */ 00468000
*       /*                                                           */ 00469000
*       /*************************************************************/ 00470000
*                                                                  0165 00471000
*       $TCECM='1'B;                /* SET TCEC SW IN RCA            */ 00472000
         OI    $TCECM(WAPTR),B'00000001'                           0165 00473000
*       R1=ADDR($TCA20);            /* SET UP PARM LIST $TR          */ 00474000
         LA    R1,$TCA20                                           0166 00475000
*       CALL S20CEC03;              /* CALL TCEC-MULTIPLE LN         */ 00476000
         L     @15,@CV00446                                        0167 00477000
         BALR  @14,@15                                             0167 00478000
*       DCL                                                        0168 00479000
*         1 $TCA20,                 /* TCEC PARM LIST                */ 00480000
*          2 $TCB20 FIXED(32) INIT(540),/* MSG NUMBER                */ 00481000
*          2 $TCC20 FIXED(32) INIT(0),/* INCT LEN                    */ 00482000
*          2 $TCD20 BIT(8) INIT('10000000'B),/* FLAG                 */ 00483000
*          2 $TCE20 CHAR(4) INIT('08000000'X);/* MSSAGE MASK         */ 00484000
*     END;                                                         0169 00485000
*   ELSE                                                           0170 00486000
*     DO;                                                          0170 00487000
*                                                                  0170 00488000
         B     @RC00163                                            0170 00489000
@RF00163 DS    0H                                                  0171 00490000
*       /*************************************************************/ 00491000
*       /*                                                           */ 00492000
*       /* TCEC                                                      */ 00493000
*       /* MSGN(540)CKABEND(YES)DIR(NET)MSGMSK('08000000'X)SUB(YES)  */ 00494000
*       /* INVOKED                                                   */ 00495000
*       /*                                                           */ 00496000
*       /*************************************************************/ 00497000
*                                                                  0171 00498000
*       $TCECM='1'B;                /* SET TCEC SW IN RCA            */ 00499000
         OI    $TCECM(WAPTR),B'00000001'                           0171 00500000
*       R1=ADDR($TCA21);            /* SET UP PARM LIST $TR          */ 00501000
         LA    R1,$TCA21                                           0172 00502000
*       CALL S20CEC03;              /* CALL TCEC-MULTIPLE LN         */ 00503000
         L     @15,@CV00446                                        0173 00504000
         BALR  @14,@15                                             0173 00505000
*       DCL                                                        0174 00506000
*         1 $TCA21,                 /* TCEC PARM LIST                */ 00507000
*          2 $TCB21 FIXED(32) INIT(540),/* MSG NUMBER                */ 00508000
*          2 $TCC21 FIXED(32) INIT(0),/* INCT LEN                    */ 00509000
*          2 $TCD21 BIT(8) INIT('10001100'B),/* FLAG                 */ 00510000
*          2 $TCE21 CHAR(4) INIT('08000000'X);/* MSSAGE MASK         */ 00511000
*     END;                                                         0175 00512000
*   ADAREA(1)=WAPTR;                /* ADDRESS OF WORK AREA START    */ 00513000
@RC00163 ST    WAPTR,ADAREA(,WAPTR)                                0176 00514000
*   ADAREA(2)=EVAL(WAPTR+4096);     /* END OF TWA                    */ 00515000
*                                                                  0177 00516000
         LR    @14,WAPTR                                           0177 00517000
         AL    @14,@CF00092                                        0177 00518000
         ST    @14,ADAREA+4(,WAPTR)                                0177 00519000
*   /*****************************************************************/ 00520000
*   /*                                                               */ 00521000
*   /* ITACONV FROM(STMSG)TO($INBUFR)TYPE(HE)COUNT(8) INVOKED        */ 00522000
*   /*                                                               */ 00523000
*   /*****************************************************************/ 00524000
*                                                                  0178 00525000
*   ITATCFR=ADDR(STMSG);            /* SET THE FROM ADDRESS          */ 00526000
         LA    @14,STMSG(,WAPTR)                                   0178 00527000
         ST    @14,ITATCFR                                         0178 00528000
*   ITATCTO=ADDR($INBUFR);          /* SET THE TO ADDRESS            */ 00529000
         LA    @14,$INBUFR(,WAPTR)                                 0179 00530000
         ST    @14,ITATCTO                                         0179 00531000
*   ITATCTP='1'B;                   /* SET THE TYPE OF CONVERT BIT   */ 00532000
         OI    ITATCTP,B'10000000'                                 0180 00533000
*   ITATCNT=8;                      /* GIVE THE CONVERT BYTE COUNT   */ 00534000
         MVI   ITATCNT,X'08'                                       0181 00535000
*   R1=ADDR(ITATCPRM);              /* POINT TO CONVERT PARM LIST    */ 00536000
         LA    R1,ITATCPRM                                         0182 00537000
*   CALL ISTSC021;                  /* CALL CONVERT DIRECTLY         */ 00538000
         L     @15,@CV00461                                        0183 00539000
         BALR  @14,@15                                             0183 00540000
*/********************************************************************/ 00541000
*/* OUTPUT AREA NAME, START & ENDING ADDRESSES.                      */ 00542000
*/********************************************************************/ 00543000
*                                                                  0184 00544000
*   IF $ABNDBIT=OFF                 /* IF ABNDING MSG TO NET OPR     */ 00545000
*     THEN                                                         0184 00546000
         TM    $ABNDBIT(WAPTR),B'00000010'                         0184 00547000
         BNZ   @RF00184                                            0184 00548000
*     DO;                                                          0185 00549000
*                                                                  0185 00550000
*       /*************************************************************/ 00551000
*       /*                                                           */ 00552000
*       /* TCEC MSGMSK('04000000'X)MSGN(540)SUB(YES) INVOKED         */ 00553000
*       /*                                                           */ 00554000
*       /*************************************************************/ 00555000
*                                                                  0186 00556000
*       $TCECM='1'B;                /* SET TCEC SW IN RCA            */ 00557000
         OI    $TCECM(WAPTR),B'00000001'                           0186 00558000
*       R1=ADDR($TCA23);            /* SET UP PARM LIST $TR          */ 00559000
         LA    R1,$TCA23                                           0187 00560000
*       CALL S20CEC03;              /* CALL TCEC-MULTIPLE LN         */ 00561000
         L     @15,@CV00446                                        0188 00562000
         BALR  @14,@15                                             0188 00563000
*       DCL                                                        0189 00564000
*         1 $TCA23,                 /* TCEC PARM LIST                */ 00565000
*          2 $TCB23 FIXED(32) INIT(540),/* MSG NUMBER                */ 00566000
*          2 $TCC23 FIXED(32) INIT(0),/* INCT LEN                    */ 00567000
*          2 $TCD23 BIT(8) INIT('10000000'B),/* FLAG                 */ 00568000
*          2 $TCE23 CHAR(4) INIT('04000000'X);/* MSSAGE MASK         */ 00569000
*     END;                                                         0190 00570000
*   ELSE                                                           0191 00571000
*     DO;                                                          0191 00572000
*                                                                  0191 00573000
         B     @RC00184                                            0191 00574000
@RF00184 DS    0H                                                  0192 00575000
*       /*************************************************************/ 00576000
*       /*                                                           */ 00577000
*       /* TCEC                                                      */ 00578000
*       /* MSGN(540)CKABEND(YES)DIR(NET)MSGMSK('04000000'X)SUB(YES)  */ 00579000
*       /* INVOKED                                                   */ 00580000
*       /*                                                           */ 00581000
*       /*************************************************************/ 00582000
*                                                                  0192 00583000
*       $TCECM='1'B;                /* SET TCEC SW IN RCA            */ 00584000
         OI    $TCECM(WAPTR),B'00000001'                           0192 00585000
*       R1=ADDR($TCA24);            /* SET UP PARM LIST $TR          */ 00586000
         LA    R1,$TCA24                                           0193 00587000
*       CALL S20CEC03;              /* CALL TCEC-MULTIPLE LN         */ 00588000
         L     @15,@CV00446                                        0194 00589000
         BALR  @14,@15                                             0194 00590000
*       DCL                                                        0195 00591000
*         1 $TCA24,                 /* TCEC PARM LIST                */ 00592000
*          2 $TCB24 FIXED(32) INIT(540),/* MSG NUMBER                */ 00593000
*          2 $TCC24 FIXED(32) INIT(0),/* INCT LEN                    */ 00594000
*          2 $TCD24 BIT(8) INIT('10001100'B),/* FLAG                 */ 00595000
*          2 $TCE24 CHAR(4) INIT('04000000'X);/* MSSAGE MASK         */ 00596000
*     END;                                                         0196 00597000
*                                                                  0196 00598000
*/********************************************************************/ 00599000
*/*              OUTPUT DUMP REQUEST MESSAGE.                        */ 00600000
*/********************************************************************/ 00601000
*                                                                  0197 00602000
*T37C0050:                                                         0197 00603000
*   IF $ABNDBIT=ON                  /* IF ABENDING ALL DONE          */ 00604000
*     THEN                          /* EXIT TO CALLER                */ 00605000
@RC00184 DS    0H                                                  0197 00606000
T37C0050 TM    $ABNDBIT(WAPTR),B'00000010'                         0197 00607000
         BO    @RT00197                                            0197 00608000
*     GOTO T37C0370;                                               0198 00609000
*   IF $OPCOM=ON                    /* IF NETWORK CONTROLLER IS AT 0199 00610000
*                                      SYSTEM CONSOLE                */ 00611000
*       &$ALTPRTR=OFF               /* AND NO ALTERNATE PTR          */ 00612000
*     THEN                                                         0199 00613000
         TM    $OPCOM(WAPTR),B'10000000'                           0199 00614000
         BNO   @RF00199                                            0199 00615000
         TM    $ALTPRTR(WAPTR),B'00000010'                         0199 00616000
         BNZ   @RF00199                                            0199 00617000
*     DO;                                                          0200 00618000
*                                                                  0200 00619000
*       /*************************************************************/ 00620000
*       /*                                                           */ 00621000
*       /* TCEC MSGN(546) INVOKED                                    */ 00622000
*       /*                                                           */ 00623000
*       /*************************************************************/ 00624000
*                                                                  0201 00625000
*       $TCECM='1'B;                /* SET TCEC SW IN RCA            */ 00626000
         OI    $TCECM(WAPTR),B'00000001'                           0201 00627000
*       R1=ADDR($TCA25);            /* SET UP PARM LIST $TR          */ 00628000
         LA    R1,$TCA25                                           0202 00629000
*       CALL #EXIT;                 /* CALL CECOM                    */ 00630000
         L     @15,#EXITA(,WAPTR)                                  0203 00631000
         BALR  @14,@15                                             0203 00632000
*       DCL                                                        0204 00633000
*         1 $TCA25,                 /* TCEC PARM LIST                */ 00634000
*          2 $TCB25 FIXED(32) INIT(546),/* MSG NUMBER                */ 00635000
*          2 $TCC25 FIXED(32) INIT(0),/* INCT LEN                    */ 00636000
*          2 $TCD25 BIT(8) INIT('00000000'B),/* FLAG                 */ 00637000
*          2 $TCE25 CHAR(4) INIT('FFFFFFFF'X);/* MSSAGE MASK         */ 00638000
*       GO TO T37C0370;             /* RETURN TO CALLER              */ 00639000
         B     T37C0370                                            0205 00640000
*     END;                                                         0206 00641000
*                                                                  0206 00642000
*   /*****************************************************************/ 00643000
*   /*                                                               */ 00644000
*   /* TCEC MSGN(541)INCT(19) INVOKED                                */ 00645000
*   /*                                                               */ 00646000
*   /*****************************************************************/ 00647000
*                                                                  0207 00648000
*   $TCECM='1'B;                    /* SET TCEC SW IN RCA            */ 00649000
@RF00199 OI    $TCECM(WAPTR),B'00000001'                           0207 00650000
*   R1=ADDR($TCA26);                /* SET UP PARM LIST $TR          */ 00651000
         LA    R1,$TCA26                                           0208 00652000
*   CALL #EXIT;                     /* CALL CECOM                    */ 00653000
         L     @15,#EXITA(,WAPTR)                                  0209 00654000
         BALR  @14,@15                                             0209 00655000
*   DCL                                                            0210 00656000
*     1 $TCA26,                     /* TCEC PARM LIST                */ 00657000
*      2 $TCB26 FIXED(32) INIT(541),/* MSG NUMBER                    */ 00658000
*      2 $TCC26 FIXED(32) INIT(19), /* INCT LEN                      */ 00659000
*      2 $TCD26 BIT(8) INIT('01000000'B),/* FLAG                     */ 00660000
*      2 $TCE26 CHAR(4) INIT('FFFFFFFF'X);/* MSSAGE MASK             */ 00661000
*T37C0051:                                                         0211 00662000
*                                                                  0211 00663000
*/********************************************************************/ 00664000
*/*    INTERPRET RESPONSE FROM DUMP REQUEST MESSAGE.                 */ 00665000
*/********************************************************************/ 00666000
*                                                                  0211 00667000
*   IF INCT=1 THEN                  /* CHECK RESPONSES WITH COUNT    */ 00668000
T37C0051 CLI   INCT(WAPTR),1                                       0211 00669000
         BNE   @RF00211                                            0211 00670000
*/****************************************************************** */ 00671000
*/* CHECK RESPONSES WITH COUNT EQUAL TO ONE.                         */ 00672000
*/********************************************************************/ 00673000
*                                                                  0212 00674000
*     DO;                           /* OF 1.                         */ 00675000
*       IF INCHAR='P' THEN          /* CHECK FOR PROMPT REQUEST      */ 00676000
         CLI   INCHAR(WAPTR),C'P'                                  0213 00677000
         BNE   @RF00213                                            0213 00678000
*         DO;                                                      0214 00679000
*                                                                  0214 00680000
*/********************************************************************/ 00681000
*/*                 ISSUE DUMP PROMPT MESSAGES                       */ 00682000
*/********************************************************************/ 00683000
*                                                                  0215 00684000
*           /*********************************************************/ 00685000
*           /*                                                       */ 00686000
*           /* TCEC MSGN(542)MSGMSK('FFFFFFFF'X) INVOKED             */ 00687000
*           /*                                                       */ 00688000
*           /*********************************************************/ 00689000
*                                                                  0215 00690000
*           $TCECM='1'B;            /* SET TCEC SW IN RCA            */ 00691000
         OI    $TCECM(WAPTR),B'00000001'                           0215 00692000
*           R1=ADDR($TCA27);        /* SET UP PARM LIST $TR          */ 00693000
         LA    R1,$TCA27                                           0216 00694000
*           CALL S20CEC03;          /* CALL TCEC-MULTIPLE LN         */ 00695000
         L     @15,@CV00446                                        0217 00696000
         BALR  @14,@15                                             0217 00697000
*           DCL                                                    0218 00698000
*             1 $TCA27,             /* TCEC PARM LIST                */ 00699000
*              2 $TCB27 FIXED(32) INIT(542),/* MSG NUMBER            */ 00700000
*              2 $TCC27 FIXED(32) INIT(0),/* INCT LEN                */ 00701000
*              2 $TCD27 BIT(8) INIT('00000000'B),/* FLAG             */ 00702000
*              2 $TCE27 CHAR(4) INIT('FFFFFFFF'X);/* MSSAGE MASK     */ 00703000
*           GO TO T37C0050;         /* GO ASK FOR NEXT REQUEST       */ 00704000
         B     T37C0050                                            0219 00705000
*         END;                                                     0220 00706000
*       IF INCHAR='W' THEN          /* CHECK FOR REQUEST TO DUMP   0221 00707000
*                                      COMMON AREA.                  */ 00708000
@RF00213 CLI   INCHAR(WAPTR),C'W'                                  0221 00709000
         BNE   @RF00221                                            0221 00710000
*         DO;                                                      0222 00711000
*                                                                  0222 00712000
*/********************************************************************/ 00713000
*/*            FORMAT AND DUMP ALL OF COMMON WORK AREA               */ 00714000
*/********************************************************************/ 00715000
*                                                                  0223 00716000
*           /*********************************************************/ 00717000
*           /*                                                       */ 00718000
*           /* TCEC MSGN(545)MSGMSK('20000000'X) INVOKED             */ 00719000
*           /*                                                       */ 00720000
*           /*********************************************************/ 00721000
*                                                                  0223 00722000
*           $TCECM='1'B;            /* SET TCEC SW IN RCA            */ 00723000
         OI    $TCECM(WAPTR),B'00000001'                           0223 00724000
*           R1=ADDR($TCA28);        /* SET UP PARM LIST $TR          */ 00725000
         LA    R1,$TCA28                                           0224 00726000
*           CALL S20CEC03;          /* CALL TCEC-MULTIPLE LN         */ 00727000
         L     @15,@CV00446                                        0225 00728000
         BALR  @14,@15                                             0225 00729000
*           DCL                                                    0226 00730000
*             1 $TCA28,             /* TCEC PARM LIST                */ 00731000
*              2 $TCB28 FIXED(32) INIT(545),/* MSG NUMBER            */ 00732000
*              2 $TCC28 FIXED(32) INIT(0),/* INCT LEN                */ 00733000
*              2 $TCD28 BIT(8) INIT('00000000'B),/* FLAG             */ 00734000
*              2 $TCE28 CHAR(4) INIT('20000000'X);/* MSSAGE MASK     */ 00735000
*/********************************************************************/ 00736000
*/*  PASS START & END ADDRESSES OF COMMON TO STORAGE FORMAT ROUTINE. */ 00737000
*/********************************************************************/ 00738000
*                                                                  0227 00739000
*           S=WAPTR;                /* START OF COMMON AREA          */ 00740000
         LR    S,WAPTR                                             0227 00741000
*           E=EVAL(WAPTR+4096);     /* END OF COMMON AREA            */ 00742000
         LR    E,WAPTR                                             0228 00743000
         AL    E,@CF00092                                          0228 00744000
*           GO TO T37C0300;         /* CALL STORAGE FORMAT ROUTINE   */ 00745000
         B     T37C0300                                            0229 00746000
*         END;                                                     0230 00747000
*       ELSE                                                       0231 00748000
*         ;                                                        0231 00749000
@RF00221 DS    0H                                                  0232 00750000
*       IF INCHAR='R' THEN          /* CHECK FOR REQUEST TO DUMP     */ 00751000
         CLI   INCHAR(WAPTR),C'R'                                  0232 00752000
         BNE   @RF00232                                            0232 00753000
*         DO;                       /* RESIDENT COMMON AREA          */ 00754000
*/********************************************************************/ 00755000
*/*FORMAT AND DUMP ALL OF RESIDENT COMMON AREA                       */ 00756000
*/********************************************************************/ 00757000
*                                                                  0234 00758000
*           /*********************************************************/ 00759000
*           /*                                                       */ 00760000
*           /* TCEC MSGN(545)MSGMSK('80000000'X) INVOKED             */ 00761000
*           /*                                                       */ 00762000
*           /*********************************************************/ 00763000
*                                                                  0234 00764000
*           $TCECM='1'B;            /* SET TCEC SW IN RCA            */ 00765000
         OI    $TCECM(WAPTR),B'00000001'                           0234 00766000
*           R1=ADDR($TCA29);        /* SET UP PARM LIST $TR          */ 00767000
         LA    R1,$TCA29                                           0235 00768000
*           CALL S20CEC03;          /* CALL TCEC-MULTIPLE LN         */ 00769000
         L     @15,@CV00446                                        0236 00770000
         BALR  @14,@15                                             0236 00771000
*           DCL                                                    0237 00772000
*             1 $TCA29,             /* TCEC PARM LIST                */ 00773000
*              2 $TCB29 FIXED(32) INIT(545),/* MSG NUMBER            */ 00774000
*              2 $TCC29 FIXED(32) INIT(0),/* INCT LEN                */ 00775000
*              2 $TCD29 BIT(8) INIT('00000000'B),/* FLAG             */ 00776000
*              2 $TCE29 CHAR(4) INIT('80000000'X);/* MSSAGE MASK     */ 00777000
*/********************************************************************/ 00778000
*/* PASS START AND END ADDRESSES OF RCA TO STORAGE FORMAT ROUTINE    */ 00779000
*/********************************************************************/ 00780000
*                                                                  0238 00781000
*           S=$RCA;                 /* START ADDRESS OF RCA          */ 00782000
         L     S,$RCA(,WAPTR)                                      0238 00783000
*           E=$ENDCOMM;             /* RCA END ADDRESS               */ 00784000
         L     E,$ENDCOMM(,WAPTR)                                  0239 00785000
*           GO TO T37C0300;         /* CALL STORAGE FORMAT ROUTINE   */ 00786000
         B     T37C0300                                            0240 00787000
*         END;                                                     0241 00788000
*       ELSE                                                       0242 00789000
*         ;                                                        0242 00790000
@RF00232 DS    0H                                                  0243 00791000
*       IF INCHAR='T' THEN          /* CHECK FOR REQUEST TO DUMP     */ 00792000
         CLI   INCHAR(WAPTR),C'T'                                  0243 00793000
         BNE   @RF00243                                            0243 00794000
*         DO;                       /* TOLTEP AREA.                  */ 00795000
*/********************************************************************/ 00796000
*/*             FORMAT AND DUMP ALL OF TOLTEP AREA                   */ 00797000
*/********************************************************************/ 00798000
*                                                                  0245 00799000
*           /*********************************************************/ 00800000
*           /*                                                       */ 00801000
*           /* TCEC MSGN(545)MSGMSK('40000000'X) INVOKED             */ 00802000
*           /*                                                       */ 00803000
*           /*********************************************************/ 00804000
*                                                                  0245 00805000
*           $TCECM='1'B;            /* SET TCEC SW IN RCA            */ 00806000
         OI    $TCECM(WAPTR),B'00000001'                           0245 00807000
*           R1=ADDR($TCA30);        /* SET UP PARM LIST $TR          */ 00808000
         LA    R1,$TCA30                                           0246 00809000
*           CALL S20CEC03;          /* CALL TCEC-MULTIPLE LN         */ 00810000
         L     @15,@CV00446                                        0247 00811000
         BALR  @14,@15                                             0247 00812000
*           DCL                                                    0248 00813000
*             1 $TCA30,             /* TCEC PARM LIST                */ 00814000
*              2 $TCB30 FIXED(32) INIT(545),/* MSG NUMBER            */ 00815000
*              2 $TCC30 FIXED(32) INIT(0),/* INCT LEN                */ 00816000
*              2 $TCD30 BIT(8) INIT('00000000'B),/* FLAG             */ 00817000
*              2 $TCE30 CHAR(4) INIT('40000000'X);/* MSSAGE MASK     */ 00818000
*/********************************************************************/ 00819000
*/*  PASS START & END ADDRESSES OF TOLTEP TO STORAGE FORMAT ROUTINE. */ 00820000
*/********************************************************************/ 00821000
*                                                                  0249 00822000
*           S=$TEPBEGN;             /* TOLTEP STARTING ADDRESS       */ 00823000
         L     S,$TEPBEGN(,WAPTR)                                  0249 00824000
*           E=$TEPEND;              /* TOLTEP ENDING ADDRESS         */ 00825000
         L     E,$TEPEND(,WAPTR)                                   0250 00826000
*           GO TO T37C0300;         /* CALL STORAGE FORMAT ROUTINE   */ 00827000
         B     T37C0300                                            0251 00828000
*         END;                                                     0252 00829000
*       ELSE                                                       0253 00830000
*         ;                                                        0253 00831000
@RF00243 DS    0H                                                  0254 00832000
*       IF INCHAR='O' THEN          /* CHECK FOR REQUEST TO DUMP     */ 00833000
         CLI   INCHAR(WAPTR),C'O'                                  0254 00834000
         BNE   @RF00254                                            0254 00835000
*         DO;                       /* ALL OF OLT AREA.              */ 00836000
*/********************************************************************/ 00837000
*/*                 FORMAT AND DUMP ALL OF OLT AREA                  */ 00838000
*/********************************************************************/ 00839000
*                                                                  0256 00840000
*           /*********************************************************/ 00841000
*           /*                                                       */ 00842000
*           /* TCEC MSGN(545)MSGMSK('10000000'X) INVOKED             */ 00843000
*           /*                                                       */ 00844000
*           /*********************************************************/ 00845000
*                                                                  0256 00846000
*           $TCECM='1'B;            /* SET TCEC SW IN RCA            */ 00847000
         OI    $TCECM(WAPTR),B'00000001'                           0256 00848000
*           R1=ADDR($TCA31);        /* SET UP PARM LIST $TR          */ 00849000
         LA    R1,$TCA31                                           0257 00850000
*           CALL S20CEC03;          /* CALL TCEC-MULTIPLE LN         */ 00851000
         L     @15,@CV00446                                        0258 00852000
         BALR  @14,@15                                             0258 00853000
*           DCL                                                    0259 00854000
*             1 $TCA31,             /* TCEC PARM LIST                */ 00855000
*              2 $TCB31 FIXED(32) INIT(545),/* MSG NUMBER            */ 00856000
*              2 $TCC31 FIXED(32) INIT(0),/* INCT LEN                */ 00857000
*              2 $TCD31 BIT(8) INIT('00000000'B),/* FLAG             */ 00858000
*              2 $TCE31 CHAR(4) INIT('10000000'X);/* MSSAGE MASK     */ 00859000
*/********************************************************************/ 00860000
*/*    PASS START & END ADDRESSES OF OLT TO STORAGE FORMAT ROUTINE   */ 00861000
*/********************************************************************/ 00862000
*                                                                  0260 00863000
*           S=$LOWADDR;             /* OLT STARTING ADDRESS          */ 00864000
         L     S,$LOWADDR(,WAPTR)                                  0260 00865000
*           E=$HIGHADR;             /* HIGHEST OLT AREA ADDRESS      */ 00866000
         L     E,$HIGHADR(,WAPTR)                                  0261 00867000
*           GO TO T37C0300;         /* CALL STORAGE FORMAT ROUTINE   */ 00868000
         B     T37C0300                                            0262 00869000
*         END;                                                     0263 00870000
*       ELSE                                                       0264 00871000
*         ;                                                        0264 00872000
@RF00254 DS    0H                                                  0265 00873000
*     END;                          /* END OF INCT=1 TESTS           */ 00874000
*   ELSE                                                           0266 00875000
*     ;                                                            0266 00876000
*                                                                  0266 00877000
@RF00211 DS    0H                                                  0267 00878000
*/********************************************************************/ 00879000
*/*            CHECK FOR REQUEST TO END DUMP                         */ 00880000
*/********************************************************************/ 00881000
*                                                                  0267 00882000
*   IF DFINB='CANCEL'&INCT=6 THEN                                  0267 00883000
         CLC   DFINB(6,WAPTR),@CC00581                             0267 00884000
         BNE   @RF00267                                            0267 00885000
         CLI   INCT(WAPTR),6                                       0267 00886000
         BNE   @RF00267                                            0267 00887000
*     DO;                                                          0268 00888000
*T37C0070:                                                         0269 00889000
*                                                                  0269 00890000
*       /*************************************************************/ 00891000
*       /*                                                           */ 00892000
*       /* TCEC MSGN(544) INVOKED                                    */ 00893000
*       /*                                                           */ 00894000
*       /*************************************************************/ 00895000
*                                                                  0269 00896000
*       $TCECM='1'B;                /* SET TCEC SW IN RCA            */ 00897000
T37C0070 OI    $TCECM(WAPTR),B'00000001'                           0269 00898000
*       R1=ADDR($TCA32);            /* SET UP PARM LIST $TR          */ 00899000
         LA    R1,$TCA32                                           0270 00900000
*       CALL #EXIT;                 /* CALL CECOM                    */ 00901000
         L     @15,#EXITA(,WAPTR)                                  0271 00902000
         BALR  @14,@15                                             0271 00903000
*       DCL                                                        0272 00904000
*         1 $TCA32,                 /* TCEC PARM LIST                */ 00905000
*          2 $TCB32 FIXED(32) INIT(544),/* MSG NUMBER                */ 00906000
*          2 $TCC32 FIXED(32) INIT(0),/* INCT LEN                    */ 00907000
*          2 $TCD32 BIT(8) INIT('00000000'B),/* FLAG                 */ 00908000
*          2 $TCE32 CHAR(4) INIT('FFFFFFFF'X);/* MSSAGE MASK         */ 00909000
*       GO TO T37C0370;             /* RETURN TO CALLER              */ 00910000
         B     T37C0370                                            0273 00911000
*     END;                                                         0274 00912000
*   ELSE                                                           0275 00913000
*     ;                                                            0275 00914000
*                                                                  0275 00915000
@RF00267 DS    0H                                                  0276 00916000
*/********************************************************************/ 00917000
*/********************************************************************/ 00918000
*/* CHECK FOR REQUEST TO DISPLAY AREA OF STORAGE SELECTED BY ADDRESS */ 00919000
*/********************************************************************/ 00920000
*                                                                  0276 00921000
*   IF DFORMA¬='D ' THEN                                           0276 00922000
         CLC   DFORMA(2,WAPTR),@CC00590                            0276 00923000
         BNE   @RT00276                                            0276 00924000
*     GO TO T37C0080;               /* GO ISSUE INCORRECT REPLY MSG  */ 00925000
*   ELSE                                                           0278 00926000
*     DO I=4 TO 13 WHILE $INBUFR(I)¬='-';                          0278 00927000
         LA    I,4                                                 0278 00928000
@DL00278 LR    @14,WAPTR                                           0278 00929000
         ALR   @14,I                                               0278 00930000
         CLI   $INBUFR-1(@14),C'-'                                 0278 00931000
         BE    @DC00278                                            0278 00932000
*     END;                                                         0279 00933000
         AL    I,@CF00072                                          0279 00934000
         C     I,@CF00592                                          0279 00935000
         BNH   @DL00278                                            0279 00936000
@DC00278 DS    0H                                                  0280 00937000
*   IF I>12 THEN                                                   0280 00938000
         C     I,@CF00231                                          0280 00939000
         BH    @RT00280                                            0280 00940000
*     GO TO T37C0080;               /* ISSUE INCORRECT REPLY MSG.    */ 00941000
*   ELSE                                                           0282 00942000
*     ;                                                            0282 00943000
*   DFORMC='0000000000000000';                                     0283 00944000
         MVC   DFORMC(16,WAPTR),@CC00594                           0283 00945000
*   DFORMB((13-I):8)=$INBUFR(4:(I-1));                             0284 00946000
         LA    @14,13                                              0284 00947000
         SLR   @14,I                                               0284 00948000
         ST    @14,@TF00001                                        0284 00949000
         ALR   @14,WAPTR                                           0284 00950000
         LA    @11,8                                               0284 00951000
         LR    @03,@11                                             0284 00952000
         SL    @03,@TF00001                                        0284 00953000
         MVC   @TS00001(8),$INBUFR+3(WAPTR)                        0284 00954000
         EX    @03,@SM00644                                        0284 00955000
*   Z=$INBUFR(1:1);                                                0285 00956000
         SLR   Z,Z                                                 0285 00957000
         IC    Z,$INBUFR(,WAPTR)                                   0285 00958000
*   DFORMD((8-(Z-I)):8)=$INBUFR((I+1):(Z+1));                      0286 00959000
*                                                                  0286 00960000
         LR    @14,I                                               0286 00961000
         SLR   @14,Z                                               0286 00962000
         ALR   @14,@11                                             0286 00963000
         ST    @14,@TF00001                                        0286 00964000
         ALR   @14,WAPTR                                           0286 00965000
         SL    @11,@TF00001                                        0286 00966000
         LR    @03,WAPTR                                           0286 00967000
         ALR   @03,I                                               0286 00968000
         MVC   @TS00001(8),$INBUFR(@03)                            0286 00969000
         EX    @11,@SM00646                                        0286 00970000
*/********************************************************************/ 00971000
*/*      SET UP ADDRESSES FOR DISPLAY OF SELECTED STORAGE AREA       */ 00972000
*/********************************************************************/ 00973000
*                                                                  0287 00974000
*   /*****************************************************************/ 00975000
*   /*                                                               */ 00976000
*   /* ITACONV FROM(DFORMB)TO(DF)TYPE(EH)COUNT(8) INVOKED            */ 00977000
*   /*                                                               */ 00978000
*   /*****************************************************************/ 00979000
*                                                                  0287 00980000
*   ITATCFR=ADDR(DFORMB);           /* SET THE FROM ADDRESS          */ 00981000
         LA    @14,DFORMB(,WAPTR)                                  0287 00982000
         ST    @14,ITATCFR                                         0287 00983000
*   ITATCTO=ADDR(DF);               /* SET THE TO ADDRESS            */ 00984000
         LA    @14,DF                                              0288 00985000
         ST    @14,ITATCTO                                         0288 00986000
*   ITATCTP='0'B;                   /* SET THE TYPE OF CONVERT BIT   */ 00987000
         NI    ITATCTP,B'01111111'                                 0289 00988000
*   ITATCNT=8;                      /* GIVE THE CONVERT BYTE COUNT   */ 00989000
         MVI   ITATCNT,X'08'                                       0290 00990000
*   R1=ADDR(ITATCPRM);              /* POINT TO CONVERT PARM LIST    */ 00991000
         LA    R1,ITATCPRM                                         0291 00992000
*   CALL ISTSC021;                  /* CALL CONVERT DIRECTLY         */ 00993000
         L     @15,@CV00461                                        0292 00994000
         BALR  @14,@15                                             0292 00995000
*/********************************************************************/ 00996000
*/*                      CHECK FOR BAD RETURN CODE                   */ 00997000
*/********************************************************************/ 00998000
*                                                                  0293 00999000
*   IF R15¬=0 THEN                  /* CHECK FOR NON-ZERO            */ 01000000
         LTR   R15,R15                                             0293 01001000
         BZ    @RF00293                                            0293 01002000
*     DO;                                                          0294 01003000
*                                                                  0294 01004000
*/********************************************************************/ 01005000
*/*OUTPUT INCORRECT REPLY MESSAGE, THEN GO RE-ISSUE DUMP REQUEST MSG */ 01006000
*/********************************************************************/ 01007000
*                                                                  0295 01008000
*T37C0080:                                                         0295 01009000
*                                                                  0295 01010000
*       /*************************************************************/ 01011000
*       /*                                                           */ 01012000
*       /* TCEC MSGN(299)INCT(19) INVOKED                            */ 01013000
*       /*                                                           */ 01014000
*       /*************************************************************/ 01015000
*                                                                  0295 01016000
*       $TCECM='1'B;                /* SET TCEC SW IN RCA            */ 01017000
T37C0080 OI    $TCECM(WAPTR),B'00000001'                           0295 01018000
*       R1=ADDR($TCA34);            /* SET UP PARM LIST $TR          */ 01019000
         LA    R1,$TCA34                                           0296 01020000
*       CALL #EXIT;                 /* CALL CECOM                    */ 01021000
         L     @15,#EXITA(,WAPTR)                                  0297 01022000
         BALR  @14,@15                                             0297 01023000
*       DCL                                                        0298 01024000
*         1 $TCA34,                 /* TCEC PARM LIST                */ 01025000
*          2 $TCB34 FIXED(32) INIT(299),/* MSG NUMBER                */ 01026000
*          2 $TCC34 FIXED(32) INIT(19),/* INCT LEN                   */ 01027000
*          2 $TCD34 BIT(8) INIT('01000000'B),/* FLAG                 */ 01028000
*          2 $TCE34 CHAR(4) INIT('FFFFFFFF'X);/* MSSAGE MASK         */ 01029000
*       GO TO T37C0051;             /* GO RE-ISSUE,TWO-WAY MESSAGE   */ 01030000
         B     T37C0051                                            0299 01031000
*     END;                                                         0300 01032000
*   ELSE                                                           0301 01033000
*     ;                                                            0301 01034000
@RF00293 DS    0H                                                  0302 01035000
*   DO;                                                            0302 01036000
*                                                                  0302 01037000
*/********************************************************************/ 01038000
*/*      SET UP END ADDRESS FOR CONVERSION FROM EBCDIC TO HEX.       */ 01039000
*/********************************************************************/ 01040000
*                                                                  0303 01041000
*     /***************************************************************/ 01042000
*     /*                                                             */ 01043000
*     /* ITACONV FROM(DFORMD)TO(DT)TYPE(EH)COUNT(8) INVOKED          */ 01044000
*     /*                                                             */ 01045000
*     /***************************************************************/ 01046000
*                                                                  0303 01047000
*     ITATCFR=ADDR(DFORMD);         /* SET THE FROM ADDRESS          */ 01048000
         LA    @14,DFORMD(,WAPTR)                                  0303 01049000
         ST    @14,ITATCFR                                         0303 01050000
*     ITATCTO=ADDR(DT);             /* SET THE TO ADDRESS            */ 01051000
         LA    @14,DT                                              0304 01052000
         ST    @14,ITATCTO                                         0304 01053000
*     ITATCTP='0'B;                 /* SET THE TYPE OF CONVERT BIT   */ 01054000
         NI    ITATCTP,B'01111111'                                 0305 01055000
*     ITATCNT=8;                    /* GIVE THE CONVERT BYTE COUNT   */ 01056000
         MVI   ITATCNT,X'08'                                       0306 01057000
*     R1=ADDR(ITATCPRM);            /* POINT TO CONVERT PARM LIST    */ 01058000
         LA    R1,ITATCPRM                                         0307 01059000
*     CALL ISTSC021;                /* CALL CONVERT DIRECTLY         */ 01060000
         L     @15,@CV00461                                        0308 01061000
         BALR  @14,@15                                             0308 01062000
*/********************************************************************/ 01063000
*/*                    CHECK FOR BAD RETURN CODE                     */ 01064000
*/********************************************************************/ 01065000
*                                                                  0309 01066000
*     IF R15¬=0 THEN                                               0309 01067000
         LTR   R15,R15                                             0309 01068000
         BNZ   @RT00309                                            0309 01069000
*       GO TO T37C0080;             /* ISSUE INCORRECT REPLY MSG     */ 01070000
*     ELSE                                                         0311 01071000
*       ;                                                          0311 01072000
*                                                                  0311 01073000
*/********************************************************************/ 01074000
*/* SET UP ADDRESSES FOR CALL TO STORAGE FORMAT ROUTINE.             */ 01075000
*/********************************************************************/ 01076000
*                                                                  0312 01077000
*     S=DF;                         /* STARTING ADDRESS IS DF.       */ 01078000
         L     S,DF                                                0312 01079000
*     E=DT;                         /* ENDING ADDRESS IS DT.         */ 01080000
         L     E,DT                                                0313 01081000
*     GO TO T37C0300;               /* STORAGE FORMAT ROUTINE        */ 01082000
         B     T37C0300                                            0314 01083000
*   END;                                                           0315 01084000
*                                                                  0316 01085000
*/********************************************************************/ 01086000
*/*          S T O R A G E   F O R M A T   R O U T I N E             */ 01087000
*/********************************************************************/ 01088000
*                                                                  0316 01089000
*T37C0300:                                                         0316 01090000
*                                                                  0316 01091000
*/********************************************************************/ 01092000
*/* DETERMINE IF START ADDRESS IS LESS THAN END ADDRESS              */ 01093000
*/********************************************************************/ 01094000
*                                                                  0316 01095000
*   IF S>=E THEN                                                   0316 01096000
T37C0300 CR    S,E                                                 0316 01097000
         BNL   @RT00316                                            0316 01098000
*     GO TO T37C0330;               /* OUTPUT-INCORRECT ADR    SELECT*/ 01099000
*   ELSE                                                           0318 01100000
*     ;                                                            0318 01101000
*                                                                  0318 01102000
*/********************************************************************/ 01103000
*/* DETERMINE IF START ADDRESS IS VALID (WITHIN ONE OF THE ALLOWED   */ 01104000
*/* AREAS)                                                           */ 01105000
*/********************************************************************/ 01106000
*                                                                  0319 01107000
*   IF S>=$RCA&S<$ENDCOMM THEN      /* CHECK RANGE IN RCA            */ 01108000
         L     @14,$RCA(,WAPTR)                                    0319 01109000
         CR    S,@14                                               0319 01110000
         BL    @RF00319                                            0319 01111000
         L     @03,$ENDCOMM(,WAPTR)                                0319 01112000
         CR    S,@03                                               0319 01113000
         BNL   @RF00319                                            0319 01114000
*     DO;                                                          0320 01115000
*                                                                  0320 01116000
*/********************************************************************/ 01117000
*/*      DETERMINE LENGTH OF DISPLAY WITHIN RCA AREA                 */ 01118000
*/********************************************************************/ 01119000
*                                                                  0321 01120000
*       IF E>$RCA&E<=$ENDCOMM THEN  /* IF END IS WITHIN RCA          */ 01121000
         CR    E,@14                                               0321 01122000
         BNH   @RF00321                                            0321 01123000
         CR    E,@03                                               0321 01124000
         BNH   @RT00321                                            0321 01125000
*         GO TO T37C0340;           /* GO FORMAT STORAGE DUMP        */ 01126000
*     END;                                                         0323 01127000
*   ELSE                                                           0324 01128000
*     ;                                                            0324 01129000
@RF00319 DS    0H                                                  0325 01130000
*   IF S>=$TEPBEGN&S<$TEPEND THEN   /* CHECK RANGE IN TOLTEP AREA    */ 01131000
@RC00319 L     @14,$TEPBEGN(,WAPTR)                                0325 01132000
         CR    S,@14                                               0325 01133000
         BL    @RF00325                                            0325 01134000
         L     @03,$TEPEND(,WAPTR)                                 0325 01135000
         CR    S,@03                                               0325 01136000
         BNL   @RF00325                                            0325 01137000
*     DO;                                                          0326 01138000
*                                                                  0326 01139000
*/********************************************************************/ 01140000
*/* DETERMINE LENGTH OF DISPLAY WITHIN TOLTEP AREA                   */ 01141000
*/********************************************************************/ 01142000
*                                                                  0327 01143000
*       IF E>$TEPBEGN&E<=$TEPEND THEN                              0327 01144000
         CR    E,@14                                               0327 01145000
         BNH   @RF00327                                            0327 01146000
         CR    E,@03                                               0327 01147000
         BNH   @RT00327                                            0327 01148000
*         GO TO T37C0340;           /* ADDRESS OK AS IS              */ 01149000
*     END;                                                         0329 01150000
*   ELSE                                                           0330 01151000
*     ;                                                            0330 01152000
@RF00325 DS    0H                                                  0331 01153000
*   IF S>=$LOWADDR&                 /* CHECK FOR START ADDRESS       */ 01154000
*       S<$HIGHADR THEN             /* WITHIN TOLTEP AREA.           */ 01155000
@RC00325 L     @14,$LOWADDR(,WAPTR)                                0331 01156000
         CR    S,@14                                               0331 01157000
         BL    @RF00331                                            0331 01158000
         L     @03,$HIGHADR(,WAPTR)                                0331 01159000
         CR    S,@03                                               0331 01160000
         BNL   @RF00331                                            0331 01161000
*     DO;                                                          0332 01162000
*                                                                  0332 01163000
*/********************************************************************/ 01164000
*/*      DETERMINE LENGTH OF DISPLAY WITHIN OLT AREA                 */ 01165000
*/********************************************************************/ 01166000
*                                                                  0333 01167000
*       IF E>$LOWADDR&E<=$HIGHADR THEN                             0333 01168000
         CR    E,@14                                               0333 01169000
         BNH   @RF00333                                            0333 01170000
         CR    E,@03                                               0333 01171000
         BNH   @RT00333                                            0333 01172000
*         GO TO T37C0340;           /* ADDRESS OK AS IS              */ 01173000
*     END;                                                         0335 01174000
*   ELSE                                                           0336 01175000
*     ;                                                            0336 01176000
@RF00331 DS    0H                                                  0337 01177000
*   IF S>=WAPTR&S<EVAL(WAPTR+4096) THEN/* CHECK RANGE IN TWA         */ 01178000
@RC00331 CR    S,WAPTR                                             0337 01179000
         BL    @RF00337                                            0337 01180000
         LR    @14,WAPTR                                           0337 01181000
         AL    @14,@CF00092                                        0337 01182000
         CR    S,@14                                               0337 01183000
         BNL   @RF00337                                            0337 01184000
*     DO;                                                          0338 01185000
*                                                                  0338 01186000
*/********************************************************************/ 01187000
*/*         DETERMINE LENGTH OF DISPLAY WITHIN TEST WORK AREA        */ 01188000
*/********************************************************************/ 01189000
*                                                                  0339 01190000
*       IF E>WAPTR&E<=EVAL(WAPTR+4096) THEN                        0339 01191000
         CR    E,WAPTR                                             0339 01192000
         BNH   @RF00339                                            0339 01193000
         CR    E,@14                                               0339 01194000
         BNH   @RT00339                                            0339 01195000
*         GO TO T37C0340;           /* ADDRESS OK AS IS              */ 01196000
*     END;                                                         0341 01197000
*   ELSE                                                           0342 01198000
*     DO;                                                          0342 01199000
*                                                                  0342 01200000
         B     @RC00337                                            0342 01201000
@RF00337 DS    0H                                                  0343 01202000
*/********************************************************************/ 01203000
*/*            AN INCORRECT ADDRESS RANGE HAS BEEN SELECTED          */ 01204000
*/********************************************************************/ 01205000
*                                                                  0343 01206000
*T37C0330:                                                         0343 01207000
*                                                                  0343 01208000
*       /*************************************************************/ 01209000
*       /*                                                           */ 01210000
*       /* TCEC MSGN(543) INVOKED                                    */ 01211000
*       /*                                                           */ 01212000
*       /*************************************************************/ 01213000
*                                                                  0343 01214000
*       $TCECM='1'B;                /* SET TCEC SW IN RCA            */ 01215000
T37C0330 OI    $TCECM(WAPTR),B'00000001'                           0343 01216000
*       R1=ADDR($TCA36);            /* SET UP PARM LIST $TR          */ 01217000
         LA    R1,$TCA36                                           0344 01218000
*       CALL #EXIT;                 /* CALL CECOM                    */ 01219000
         L     @15,#EXITA(,WAPTR)                                  0345 01220000
         BALR  @14,@15                                             0345 01221000
*       DCL                                                        0346 01222000
*         1 $TCA36,                 /* TCEC PARM LIST                */ 01223000
*          2 $TCB36 FIXED(32) INIT(543),/* MSG NUMBER                */ 01224000
*          2 $TCC36 FIXED(32) INIT(0),/* INCT LEN                    */ 01225000
*          2 $TCD36 BIT(8) INIT('00000000'B),/* FLAG                 */ 01226000
*          2 $TCE36 CHAR(4) INIT('FFFFFFFF'X);/* MSSAGE MASK         */ 01227000
*       GO TO T37C0050;             /* GET NEXT DUMP REQUEST         */ 01228000
         B     T37C0050                                            0347 01229000
*     END;                                                         0348 01230000
*T37C0340:                                                         0349 01231000
*   $BACKINT=OFF;                   /* RESET CONTROL SWITCH          */ 01232000
@RC00337 DS    0H                                                  0349 01233000
T37C0340 NI    $BACKINT(WAPTR),B'11110111'                         0349 01234000
*/********************************************************************/ 01235000
*/*        ROUND DOWN START ADDRESS TO A DOUBLE WORD BOUNDARY        */ 01236000
*/********************************************************************/ 01237000
*                                                                  0350 01238000
*   S=(S/8)*8;                                                     0350 01239000
         LR    @14,S                                               0350 01240000
         SRL   @14,3                                               0350 01241000
         SLA   @14,3                                               0350 01242000
         LR    S,@14                                               0350 01243000
*   $DMSGSW=OFF;                    /* RESET MESSAGE SWITCH          */ 01244000
         NI    $DMSGSW(WAPTR),B'11101111'                          0351 01245000
*/********************************************************************/ 01246000
*/*        ROUND UP END ADDRESS TO NEXT DOUBLE WORD BOUNDARY         */ 01247000
*/********************************************************************/ 01248000
*                                                                  0352 01249000
*   E=((E+7)/8)*8;                                                 0352 01250000
         LA    @10,7                                               0352 01251000
         ALR   @10,E                                               0352 01252000
         SRDA  @10,32                                              0352 01253000
         D     @10,@CF00054                                        0352 01254000
         SLA   @11,3                                               0352 01255000
         LR    E,@11                                               0352 01256000
*T37C0345:                                                         0353 01257000
*   IF $OPCOM=ON&$ALTPRTR=OFF THEN                                 0353 01258000
T37C0345 TM    $OPCOM(WAPTR),B'10000000'                           0353 01259000
         BNO   @RF00353                                            0353 01260000
         TM    $ALTPRTR(WAPTR),B'00000010'                         0353 01261000
         BZ    @RT00353                                            0353 01262000
*     GO TO T37C0370;                                              0354 01263000
*   IF $CIREQ=ON THEN               /* CHECK FOR COMMUNICATIONS      */ 01264000
@RF00353 TM    $CIREQ(WAPTR),B'00000001'                           0355 01265000
         BO    @RT00355                                            0355 01266000
*     GO TO T37C0050;               /* GO RE-ISSUE 541D MESSAGE.     */ 01267000
*   ELSE                                                           0357 01268000
*     ;                                                            0357 01269000
*                                                                  0357 01270000
*/********************************************************************/ 01271000
*/* CHECK FOR START ADDRESS LESS THAN END ADDRESS                    */ 01272000
*/********************************************************************/ 01273000
*                                                                  0358 01274000
*   IF S>=E THEN                                                   0358 01275000
         CR    S,E                                                 0358 01276000
         BNL   @RT00358                                            0358 01277000
*     GO TO T37C0050;               /* GET NEXT DUMP REQUEST         */ 01278000
*   Y=S;                                                           0360 01279000
*                                                                  0360 01280000
         ST    S,Y                                                 0360 01281000
*   /*****************************************************************/ 01282000
*   /*                                                               */ 01283000
*   /* ITACONV FROM(Y)TO(ADR) INVOKED                                */ 01284000
*   /*                                                               */ 01285000
*   /*****************************************************************/ 01286000
*                                                                  0361 01287000
*   RFY                                                            0361 01288000
*     ITATCF BASED(ADDR(Y));        /* MAP VARIABLE OVER FROM        */ 01289000
*   RFY                                                            0362 01290000
*     ITATCT BASED(ADDR(ADR));      /* MAP VARIBABLE OVER TO         */ 01291000
*   ITATCTS=ITATCT(LENGTH(ADR)+1:LENGTH(ADR)+1);/* SAVE BYTE PAST TO    01292000
*                                      FIELD                         */ 01293000
         LA    @14,2104                                            0363 01294000
         ALR   @14,WAPTR                                           0363 01295000
         SLR   ITATCTS,ITATCTS                                     0363 01296000
         IC    ITATCTS,ITATCT+8(,@14)                              0363 01297000
*   UNPK(ITATCT(1:LENGTH(ADR)+1),ITATCF(1:LENGTH(Y)+1));/* EXPAND HEX   01298000
*                                      TO EBCDIC                     */ 01299000
         LA    @11,Y                                               0364 01300000
         UNPK  ITATCT(9,@14),ITATCF(5,@11)                         0364 01301000
*   TR(ITATCT(1:LENGTH(ADR)),$TRTBL);/* CONVERT FA-FF TO C1-C6       */ 01302000
         L     @11,RCAPTR(,WAPTR)                                  0365 01303000
         L     @11,$TRTBLA(,@11)                                   0365 01304000
         TR    ITATCT(8,@14),$TRTBL(@11)                           0365 01305000
*   ITATCT(LENGTH(ADR)+1:LENGTH(ADR)+1)=ITATCTS;/* RESTORE BYTE PAST    01306000
*                                      TO FIELD CONVERT ADDRESS TO 0366 01307000
*                                      EBCDIC                        */ 01308000
         STC   ITATCTS,ITATCT+8(,@14)                              0366 01309000
*   DADR='=';                       /* EQUAL ONE CHAR SPACER         */ 01310000
         MVI   DADR(WAPTR),C'='                                    0367 01311000
*/********************************************************************/ 01312000
*/*            GET FIRST DOUBLE WORD (LEFT HALF OF DISPLAY)          */ 01313000
*/********************************************************************/ 01314000
*                                                                  0368 01315000
*   LDATA=STG(1);                   /* GET 8 BYTES DATA FOR LEFT     */ 01316000
         MVC   LDATA(8,WAPTR),STG(S)                               0368 01317000
*   S=S+8;                          /* HALF OF DISPLAY LINE          */ 01318000
         AL    S,@CF00054                                          0369 01319000
*   IF S>=E THEN                    /* CHECK FOR LIMIT REACHED       */ 01320000
         CR    S,E                                                 0370 01321000
         BL    @RF00370                                            0370 01322000
*     DO;                                                          0371 01323000
*       RDATA='        ';           /* BLANK RIGHT HALF OUTPUT       */ 01324000
         MVC   RDATA(8,WAPTR),@CC00621                             0372 01325000
*       EDATAR='                ';                                 0373 01326000
*                                                                  0373 01327000
         MVC   EDATAR(16,WAPTR),@CC00622                           0373 01328000
*/********************************************************************/ 01329000
*/* ADDRESS OF AREA TO BE DISPLAYED HAS REACHED END ADDRESS AND ONLY */ 01330000
*/* THE LEFT DOUBLE WORD IS TO BE CONVERTED TO EBCDIC AND OUTPUT     */ 01331000
*/********************************************************************/ 01332000
*                                                                  0374 01333000
*       /*************************************************************/ 01334000
*       /*                                                           */ 01335000
*       /* ITACONV FROM(LDATA)TO(EDATAL)TYPE(HE)COUNT(8) INVOKED     */ 01336000
*       /*                                                           */ 01337000
*       /*************************************************************/ 01338000
*                                                                  0374 01339000
*       ITATCFR=ADDR(LDATA);        /* SET THE FROM ADDRESS          */ 01340000
         LA    @14,LDATA(,WAPTR)                                   0374 01341000
         ST    @14,ITATCFR                                         0374 01342000
*       ITATCTO=ADDR(EDATAL);       /* SET THE TO ADDRESS            */ 01343000
         LA    @14,EDATAL(,WAPTR)                                  0375 01344000
         ST    @14,ITATCTO                                         0375 01345000
*       ITATCTP='1'B;               /* SET THE TYPE OF CONVERT BIT   */ 01346000
         OI    ITATCTP,B'10000000'                                 0376 01347000
*       ITATCNT=8;                  /* GIVE THE CONVERT BYTE COUNT   */ 01348000
         MVI   ITATCNT,X'08'                                       0377 01349000
*       R1=ADDR(ITATCPRM);          /* POINT TO CONVERT PARM LIST    */ 01350000
         LA    R1,ITATCPRM                                         0378 01351000
*       CALL ISTSC021;              /* CALL CONVERT DIRECTLY         */ 01352000
         L     @15,@CV00461                                        0379 01353000
         BALR  @14,@15                                             0379 01354000
*       GO TO T37C0360;             /* GO OUTPUT THIS LAST LINE      */ 01355000
         B     T37C0360                                            0380 01356000
*     END;                                                         0381 01357000
*   ELSE                                                           0382 01358000
*     DO;                                                          0382 01359000
*                                                                  0382 01360000
@RF00370 DS    0H                                                  0383 01361000
*/********************************************************************/ 01362000
*/* CONVERT 8 BYTES OF DATA FOR RIGHT HALF OF LINE TO BE DISPLAYED   */ 01363000
*/********************************************************************/ 01364000
*                                                                  0383 01365000
*       RDATA=STG(1);               /* 8 BYTES RIGHT STORAGE DWORD   */ 01366000
         MVC   RDATA(8,WAPTR),STG(S)                               0383 01367000
*       S=S+8;                                                     0384 01368000
         AL    S,@CF00054                                          0384 01369000
*       IF $BACKINT=ON              /* CHECK FOR INITIALIZATION OF   */ 01370000
*         THEN                      /* BACKUP BUFFER                 */ 01371000
         TM    $BACKINT(WAPTR),B'00001000'                         0385 01372000
         BNO   @RF00385                                            0385 01373000
*         DO;                                                      0386 01374000
*                                                                  0386 01375000
*/********************************************************************/ 01376000
*/* CHECK FOR CASE WHERE THE CURRENT LINE IS EQUAL TO LAST LINE OUT. */ 01377000
*/********************************************************************/ 01378000
*                                                                  0387 01379000
*           IF CURSTG=BUBACK THEN                                  0387 01380000
         L     @14,Y                                               0387 01381000
         CLC   CURSTG(16,@14),BUBACK(BDATAPTR)                     0387 01382000
         BNE   @RF00387                                            0387 01383000
*             DO;                                                  0388 01384000
*                                                                  0388 01385000
*/********************************************************************/ 01386000
*/* CHECK FOR NEED TO OUTPUT -SAME AS ABOVE- MESSAGE                 */ 01387000
*/********************************************************************/ 01388000
*                                                                  0389 01389000
*               IF $DMSGSW=ON THEN                                 0389 01390000
         TM    $DMSGSW(WAPTR),B'00010000'                          0389 01391000
         BO    @RT00389                                            0389 01392000
*                 GO TO T37C0345;                                  0390 01393000
*               ELSE                                               0391 01394000
*                 DO;                                              0391 01395000
*                   $INBUFR='SAME AS ABOVE';                       0392 01396000
         MVI   $INBUFR+13(WAPTR),C' '                              0392 01397000
         MVC   $INBUFR+14(66,WAPTR),$INBUFR+13(WAPTR)              0392 01398000
         MVC   $INBUFR(13,WAPTR),@CC00625                          0392 01399000
*                   $DMSGSW=ON;     /* INDICATE MSG OUT              */ 01400000
         OI    $DMSGSW(WAPTR),B'00010000'                          0393 01401000
*                   $PRTONLY=ON;                                   0394 01402000
*                                                                  0394 01403000
         OI    $PRTONLY(WAPTR),B'00001000'                         0394 01404000
*                   /*************************************************/ 01405000
*                   /*                                               */ 01406000
*                   /* TCEC                                          */ 01407000
*                   /* MSGN(247)MSGMSK('40000000'X)SUB(YES)NOID(YES) */ 01408000
*                   /* INVOKED                                       */ 01409000
*                   /*                                               */ 01410000
*                   /*************************************************/ 01411000
*                                                                  0395 01412000
*                   $TCECM='1'B;    /* SET TCEC SW IN RCA            */ 01413000
         OI    $TCECM(WAPTR),B'00000001'                           0395 01414000
*                   R1=ADDR($TCA39);/* SET UP PARM LIST $TR          */ 01415000
         LA    R1,$TCA39                                           0396 01416000
*                   CALL S20CEC03;  /* CALL TCEC-MULTIPLE LN         */ 01417000
         L     @15,@CV00446                                        0397 01418000
         BALR  @14,@15                                             0397 01419000
*                   DCL                                            0398 01420000
*                     1 $TCA39,     /* TCEC PARM LIST                */ 01421000
*                      2 $TCB39 FIXED(32) INIT(247),/* MSG NUMBER    */ 01422000
*                      2 $TCC39 FIXED(32) INIT(0),/* INCT LEN        */ 01423000
*                      2 $TCD39 BIT(8) INIT('10100000'B),/* FLAG     */ 01424000
*                      2 $TCE39 CHAR(4) INIT('40000000'X);/* MSSAGE     01425000
*                                      MASK                          */ 01426000
*                   GO TO T37C0345; /* GET NEXT LINE                 */ 01427000
         B     T37C0345                                            0399 01428000
*                 END;                                             0400 01429000
*             END;                                                 0401 01430000
*           ELSE                                                   0402 01431000
*             ;                                                    0402 01432000
@RF00387 DS    0H                                                  0403 01433000
*         END;                                                     0403 01434000
*       $BACKINT=ON;                                               0404 01435000
@RF00385 OI    $BACKINT(WAPTR),B'00001000'                         0404 01436000
*       BDATAPTR=Y;                                                0405 01437000
*                                                                  0405 01438000
         L     BDATAPTR,Y                                          0405 01439000
*/********************************************************************/ 01440000
*/*  CONVERT TO EBCDIC BOTH LEFT & RIGHT DOUBLE WORDS & OUTPUT BOTH  */ 01441000
*/********************************************************************/ 01442000
*                                                                  0406 01443000
*       /*************************************************************/ 01444000
*       /*                                                           */ 01445000
*       /* ITACONV FROM(UDATA)TO(EDATA)TYPE(HE)COUNT(16) INVOKED     */ 01446000
*       /*                                                           */ 01447000
*       /*************************************************************/ 01448000
*                                                                  0406 01449000
*       ITATCFR=ADDR(UDATA);        /* SET THE FROM ADDRESS          */ 01450000
         LA    @14,UDATA(,WAPTR)                                   0406 01451000
         ST    @14,ITATCFR                                         0406 01452000
*       ITATCTO=ADDR(EDATA);        /* SET THE TO ADDRESS            */ 01453000
         LA    @14,EDATA(,WAPTR)                                   0407 01454000
         ST    @14,ITATCTO                                         0407 01455000
*       ITATCTP='1'B;               /* SET THE TYPE OF CONVERT BIT   */ 01456000
         OI    ITATCTP,B'10000000'                                 0408 01457000
*       ITATCNT=16;                 /* GIVE THE CONVERT BYTE COUNT   */ 01458000
         MVI   ITATCNT,X'10'                                       0409 01459000
*       R1=ADDR(ITATCPRM);          /* POINT TO CONVERT PARM LIST    */ 01460000
         LA    R1,ITATCPRM                                         0410 01461000
*       CALL ISTSC021;              /* CALL CONVERT DIRECTLY         */ 01462000
         L     @15,@CV00461                                        0411 01463000
         BALR  @14,@15                                             0411 01464000
*       $DMSGSW=OFF;                /* RESET MSG OUTPUT SWITCH       */ 01465000
         NI    $DMSGSW(WAPTR),B'11101111'                          0412 01466000
*T37C0360:                                                         0413 01467000
*       DO I=1 TO 4;                                               0413 01468000
T37C0360 LA    I,1                                                 0413 01469000
@DL00413 DS    0H                                                  0414 01470000
*         BUF(I)=EDAT(I);           /* MOVE TO PRINT BUFFER          */ 01471000
         LR    @14,I                                               0414 01472000
         MH    @14,@CH00087                                        0414 01473000
         ST    @14,@TF00001                                        0414 01474000
         ALR   @14,WAPTR                                           0414 01475000
         LR    @11,I                                               0414 01476000
         SLA   @11,3                                               0414 01477000
         ALR   @11,WAPTR                                           0414 01478000
         MVC   BUF-9(8,@14),EDAT-8(@11)                            0414 01479000
*         DBUF(I)=' ';              /* SINGLE BLANK BETWEEN WORDS    */ 01480000
         LR    @14,WAPTR                                           0415 01481000
         AL    @14,@TF00001                                        0415 01482000
         MVI   DBUF-9(@14),C' '                                    0415 01483000
*       END;                                                       0416 01484000
*                                                                  0416 01485000
         AL    I,@CF00072                                          0416 01486000
         C     I,@CF00068                                          0416 01487000
         BNH   @DL00413                                            0416 01488000
*/********************************************************************/ 01489000
*/*TRANSLATE ANY UNPRINTABLE CHARACTERS TO PRINTABLE BLANKS          */ 01490000
*/********************************************************************/ 01491000
*                                                                  0417 01492000
*       TR(UDATA,TRTAB(1));                                        0417 01493000
         TR    UDATA(16,WAPTR),TRTAB                               0417 01494000
*       FILCHAR=' ';                /* BLANK ONE CHAR SPACER         */ 01495000
         MVI   FILCHAR(WAPTR),C' '                                 0418 01496000
*       $PRTONLY=ON;                /* DESTINATION ALTERNATE PTR     */ 01497000
*                                                                  0419 01498000
         OI    $PRTONLY(WAPTR),B'00001000'                         0419 01499000
*       /*************************************************************/ 01500000
*       /*                                                           */ 01501000
*       /* TCEC MSGN(247)MSGMSK('40000000'X)SUB(YES)NOID(YES) INVOKED*/ 01502000
*       /*                                                           */ 01503000
*       /*************************************************************/ 01504000
*                                                                  0420 01505000
*       $TCECM='1'B;                /* SET TCEC SW IN RCA            */ 01506000
         OI    $TCECM(WAPTR),B'00000001'                           0420 01507000
*       R1=ADDR($TCA41);            /* SET UP PARM LIST $TR          */ 01508000
         LA    R1,$TCA41                                           0421 01509000
*       CALL S20CEC03;              /* CALL TCEC-MULTIPLE LN         */ 01510000
         L     @15,@CV00446                                        0422 01511000
         BALR  @14,@15                                             0422 01512000
*       DCL                                                        0423 01513000
*         1 $TCA41,                 /* TCEC PARM LIST                */ 01514000
*          2 $TCB41 FIXED(32) INIT(247),/* MSG NUMBER                */ 01515000
*          2 $TCC41 FIXED(32) INIT(0),/* INCT LEN                    */ 01516000
*          2 $TCD41 BIT(8) INIT('10100000'B),/* FLAG                 */ 01517000
*          2 $TCE41 CHAR(4) INIT('40000000'X);/* MSSAGE MASK         */ 01518000
*       GO TO T37C0345;             /* GO GET NEXT LINE OF OUTPUT    */ 01519000
         B     T37C0345                                            0424 01520000
*     END;                                                         0425 01521000
*T37C0370:                                                         0426 01522000
*   R13=SVESC02D(2);                                               0426 01523000
T37C0370 L     R13,SVESC02D+4(,WAPTR)                              0426 01524000
*   DO;                             /* ATDSPLY                       */ 01525000
*   END;                            /* ATDSPLY                       */ 01526000
*   END ISTTC037;                                                  0429 01527000
@EL00001 DS    0H                                                  0429 01528000
@EF00001 DS    0H                                                  0429 01529000
@ER00001 LM    @14,@12,12(@13)                                     0429 01530000
         BR    @14                                                 0429 01531000
@DATA    DS    0H                                                       01532000
@CH00087 DC    H'9'                                                     01533000
@SM00644 MVC   DFORMB-1(0,@14),@TS00001                                 01534000
@SM00646 MVC   DFORMD-1(0,@14),@TS00001                                 01535000
         DS    0F                                                       01536000
@TF00001 DS    F                                                        01537000
         DS    0F                                                       01538000
@CF00072 DC    F'1'                                                     01539000
@CF00068 DC    F'4'                                                     01540000
@CF00054 DC    F'8'                                                     01541000
@CF00231 DC    F'12'                                                    01542000
@CF00592 DC    F'13'                                                    01543000
@CF00061 DC    F'16'                                                    01544000
@CF00092 DC    F'4096'                                                  01545000
@CV00422 DC    V(ISTSC020)                                              01546000
@CV00446 DC    V(S20CEC03)                                              01547000
@CV00461 DC    V(ISTSC021)                                              01548000
         DS    0D                                                       01549000
Y        DS    F                                                        01550000
DF       DC    F'0'                                                     01551000
         ORG   DF                                                       01552000
DFA      DS    CL1                                                      01553000
DFROM    DS    CL3                                                      01554000
         ORG   DF+4                                                     01555000
DT       DC    F'0'                                                     01556000
         ORG   DT                                                       01557000
DTA      DS    CL1                                                      01558000
DTO      DS    CL3                                                      01559000
         ORG   DT+4                                                     01560000
@TS00001 DS    CL8                                                      01561000
@CC00594 DC    C'0000000000000000'                                      01562000
@CC00622 DC    C'                '                                      01563000
@CC00625 DC    C'SAME AS ABOVE'                                         01564000
@CC00621 EQU   @CC00622                                                 01565000
@CC00581 DC    C'CANCEL'                                                01566000
@CC00590 DC    C'D '                                                    01567000
         DS    CL3                                                      01568000
$TCA05   DS    CL13                                                     01569000
         ORG   $TCA05                                                   01570000
$TCB05   DC    A(540)                                                   01571000
$TCC05   DC    A(0)                                                     01572000
$TCD05   DC    B'00001100'                                              01573000
$TCE05   DC    X'FFFFFFFF'                                              01574000
         ORG   $TCA05+13                                                01575000
         DS    CL3                                                      01576000
$TCA08   DS    CL13                                                     01577000
         ORG   $TCA08                                                   01578000
$TCB08   DC    A(540)                                                   01579000
$TCC08   DC    A(0)                                                     01580000
$TCD08   DC    B'10001100'                                              01581000
$TCE08   DC    X'02000000'                                              01582000
         ORG   $TCA08+13                                                01583000
         DS    CL3                                                      01584000
ITATCPRM DS    CL14                                                     01585000
         ORG   ITATCPRM                                                 01586000
@NM00026 DC    X'0102F4F1'                                              01587000
ITATCFR  DS    AL4                                                      01588000
ITATCTO  DS    AL4                                                      01589000
@NM00027 DC    AL1(0)                                                   01590000
         ORG   @NM00027                                                 01591000
ITATCTP  DS    BL1                                                      01592000
         ORG   ITATCPRM+13                                              01593000
ITATCNT  DS    FL1                                                      01594000
         ORG   ITATCPRM+14                                              01595000
         DS    CL2                                                      01596000
$TCA10   DS    CL13                                                     01597000
         ORG   $TCA10                                                   01598000
$TCB10   DC    A(540)                                                   01599000
$TCC10   DC    A(0)                                                     01600000
$TCD10   DC    B'10001100'                                              01601000
$TCE10   DC    X'01000000'                                              01602000
         ORG   $TCA10+13                                                01603000
         DS    CL3                                                      01604000
$TCA11   DS    CL13                                                     01605000
         ORG   $TCA11                                                   01606000
$TCB11   DC    A(540)                                                   01607000
$TCC11   DC    A(0)                                                     01608000
$TCD11   DC    B'00000000'                                              01609000
$TCE11   DC    X'40000000'                                              01610000
         ORG   $TCA11+13                                                01611000
         DS    CL3                                                      01612000
$TCA12   DS    CL13                                                     01613000
         ORG   $TCA12                                                   01614000
$TCB12   DC    A(540)                                                   01615000
$TCC12   DC    A(0)                                                     01616000
$TCD12   DC    B'00001100'                                              01617000
$TCE12   DC    X'40000000'                                              01618000
         ORG   $TCA12+13                                                01619000
         DS    CL3                                                      01620000
$TCA14   DS    CL13                                                     01621000
         ORG   $TCA14                                                   01622000
$TCB14   DC    A(540)                                                   01623000
$TCC14   DC    A(0)                                                     01624000
$TCD14   DC    B'10000000'                                              01625000
$TCE14   DC    X'20000000'                                              01626000
         ORG   $TCA14+13                                                01627000
         DS    CL3                                                      01628000
$TCA15   DS    CL13                                                     01629000
         ORG   $TCA15                                                   01630000
$TCB15   DC    A(540)                                                   01631000
$TCC15   DC    A(0)                                                     01632000
$TCD15   DC    B'10001100'                                              01633000
$TCE15   DC    X'20000000'                                              01634000
         ORG   $TCA15+13                                                01635000
         DS    CL3                                                      01636000
$TCA17   DS    CL13                                                     01637000
         ORG   $TCA17                                                   01638000
$TCB17   DC    A(540)                                                   01639000
$TCC17   DC    A(0)                                                     01640000
$TCD17   DC    B'10000000'                                              01641000
$TCE17   DC    X'10000000'                                              01642000
         ORG   $TCA17+13                                                01643000
         DS    CL3                                                      01644000
$TCA18   DS    CL13                                                     01645000
         ORG   $TCA18                                                   01646000
$TCB18   DC    A(540)                                                   01647000
$TCC18   DC    A(0)                                                     01648000
$TCD18   DC    B'10001100'                                              01649000
$TCE18   DC    X'10000000'                                              01650000
         ORG   $TCA18+13                                                01651000
         DS    CL3                                                      01652000
$TCA20   DS    CL13                                                     01653000
         ORG   $TCA20                                                   01654000
$TCB20   DC    A(540)                                                   01655000
$TCC20   DC    A(0)                                                     01656000
$TCD20   DC    B'10000000'                                              01657000
$TCE20   DC    X'08000000'                                              01658000
         ORG   $TCA20+13                                                01659000
         DS    CL3                                                      01660000
$TCA21   DS    CL13                                                     01661000
         ORG   $TCA21                                                   01662000
$TCB21   DC    A(540)                                                   01663000
$TCC21   DC    A(0)                                                     01664000
$TCD21   DC    B'10001100'                                              01665000
$TCE21   DC    X'08000000'                                              01666000
         ORG   $TCA21+13                                                01667000
         DS    CL3                                                      01668000
$TCA23   DS    CL13                                                     01669000
         ORG   $TCA23                                                   01670000
$TCB23   DC    A(540)                                                   01671000
$TCC23   DC    A(0)                                                     01672000
$TCD23   DC    B'10000000'                                              01673000
$TCE23   DC    X'04000000'                                              01674000
         ORG   $TCA23+13                                                01675000
         DS    CL3                                                      01676000
$TCA24   DS    CL13                                                     01677000
         ORG   $TCA24                                                   01678000
$TCB24   DC    A(540)                                                   01679000
$TCC24   DC    A(0)                                                     01680000
$TCD24   DC    B'10001100'                                              01681000
$TCE24   DC    X'04000000'                                              01682000
         ORG   $TCA24+13                                                01683000
         DS    CL3                                                      01684000
$TCA25   DS    CL13                                                     01685000
         ORG   $TCA25                                                   01686000
$TCB25   DC    A(546)                                                   01687000
$TCC25   DC    A(0)                                                     01688000
$TCD25   DC    B'00000000'                                              01689000
$TCE25   DC    X'FFFFFFFF'                                              01690000
         ORG   $TCA25+13                                                01691000
         DS    CL3                                                      01692000
$TCA26   DS    CL13                                                     01693000
         ORG   $TCA26                                                   01694000
$TCB26   DC    A(541)                                                   01695000
$TCC26   DC    A(19)                                                    01696000
$TCD26   DC    B'01000000'                                              01697000
$TCE26   DC    X'FFFFFFFF'                                              01698000
         ORG   $TCA26+13                                                01699000
         DS    CL3                                                      01700000
$TCA27   DS    CL13                                                     01701000
         ORG   $TCA27                                                   01702000
$TCB27   DC    A(542)                                                   01703000
$TCC27   DC    A(0)                                                     01704000
$TCD27   DC    B'00000000'                                              01705000
$TCE27   DC    X'FFFFFFFF'                                              01706000
         ORG   $TCA27+13                                                01707000
         DS    CL3                                                      01708000
$TCA28   DS    CL13                                                     01709000
         ORG   $TCA28                                                   01710000
$TCB28   DC    A(545)                                                   01711000
$TCC28   DC    A(0)                                                     01712000
$TCD28   DC    B'00000000'                                              01713000
$TCE28   DC    X'20000000'                                              01714000
         ORG   $TCA28+13                                                01715000
         DS    CL3                                                      01716000
$TCA29   DS    CL13                                                     01717000
         ORG   $TCA29                                                   01718000
$TCB29   DC    A(545)                                                   01719000
$TCC29   DC    A(0)                                                     01720000
$TCD29   DC    B'00000000'                                              01721000
$TCE29   DC    X'80000000'                                              01722000
         ORG   $TCA29+13                                                01723000
         DS    CL3                                                      01724000
$TCA30   DS    CL13                                                     01725000
         ORG   $TCA30                                                   01726000
$TCB30   DC    A(545)                                                   01727000
$TCC30   DC    A(0)                                                     01728000
$TCD30   DC    B'00000000'                                              01729000
$TCE30   DC    X'40000000'                                              01730000
         ORG   $TCA30+13                                                01731000
         DS    CL3                                                      01732000
$TCA31   DS    CL13                                                     01733000
         ORG   $TCA31                                                   01734000
$TCB31   DC    A(545)                                                   01735000
$TCC31   DC    A(0)                                                     01736000
$TCD31   DC    B'00000000'                                              01737000
$TCE31   DC    X'10000000'                                              01738000
         ORG   $TCA31+13                                                01739000
         DS    CL3                                                      01740000
$TCA32   DS    CL13                                                     01741000
         ORG   $TCA32                                                   01742000
$TCB32   DC    A(544)                                                   01743000
$TCC32   DC    A(0)                                                     01744000
$TCD32   DC    B'00000000'                                              01745000
$TCE32   DC    X'FFFFFFFF'                                              01746000
         ORG   $TCA32+13                                                01747000
         DS    CL3                                                      01748000
$TCA34   DS    CL13                                                     01749000
         ORG   $TCA34                                                   01750000
$TCB34   DC    A(299)                                                   01751000
$TCC34   DC    A(19)                                                    01752000
$TCD34   DC    B'01000000'                                              01753000
$TCE34   DC    X'FFFFFFFF'                                              01754000
         ORG   $TCA34+13                                                01755000
         DS    CL3                                                      01756000
$TCA36   DS    CL13                                                     01757000
         ORG   $TCA36                                                   01758000
$TCB36   DC    A(543)                                                   01759000
$TCC36   DC    A(0)                                                     01760000
$TCD36   DC    B'00000000'                                              01761000
$TCE36   DC    X'FFFFFFFF'                                              01762000
         ORG   $TCA36+13                                                01763000
         DS    CL3                                                      01764000
$TCA39   DS    CL13                                                     01765000
         ORG   $TCA39                                                   01766000
$TCB39   DC    A(247)                                                   01767000
$TCC39   DC    A(0)                                                     01768000
$TCD39   DC    B'10100000'                                              01769000
$TCE39   DC    X'40000000'                                              01770000
         ORG   $TCA39+13                                                01771000
         DS    CL3                                                      01772000
$TCA41   DS    CL13                                                     01773000
         ORG   $TCA41                                                   01774000
$TCB41   DC    A(247)                                                   01775000
$TCC41   DC    A(0)                                                     01776000
$TCD41   DC    B'10100000'                                              01777000
$TCE41   DC    X'40000000'                                              01778000
         ORG   $TCA41+13                                                01779000
TRTAB    DC    4CL16'................'                                  01780000
         DC    CL16'.............(+.'                                   01781000
         DC    CL16'&&..........$*)..'                                  01782000
         DC    CL16'-/.........,....'                                   01783000
         DC    CL16'...........#@''=.'                                  01784000
         DC    4CL16'................'                                  01785000
         DC    CL16'.ABCDEFGHI......'                                   01786000
         DC    CL16'.JKLMNOPQR......'                                   01787000
         DC    CL16'..STUVWXYZ......'                                   01788000
         DC    CL16'0123456789......'                                   01789000
         DS    CL3                                                      01790000
PATCH    DC    32F'0'                                                   01791000
GMSG     DC    CL2'03'                                                  01792000
         DC    CL2'47'                                                  01793000
         DC    CL2'8B'                                                  01794000
         DC    CL2'CF'                                                  01795000
@00      EQU   00                      EQUATES FOR REGISTERS 0-15       01796000
@01      EQU   01                                                       01797000
@02      EQU   02                                                       01798000
@03      EQU   03                                                       01799000
@04      EQU   04                                                       01800000
@05      EQU   05                                                       01801000
@06      EQU   06                                                       01802000
@07      EQU   07                                                       01803000
@08      EQU   08                                                       01804000
@09      EQU   09                                                       01805000
@10      EQU   10                                                       01806000
@11      EQU   11                                                       01807000
@12      EQU   12                                                       01808000
@13      EQU   13                                                       01809000
@14      EQU   14                                                       01810000
@15      EQU   15                                                       01811000
ITATCTS  EQU   @10                                                      01812000
I        EQU   @10                                                      01813000
WAPTR    EQU   @02                                                      01814000
R1       EQU   @01                                                      01815000
ABNDPTR  EQU   @04                                                      01816000
R5       EQU   @05                                                      01817000
BDATAPTR EQU   @06                                                      01818000
Z        EQU   @07                                                      01819000
S        EQU   @08                                                      01820000
E        EQU   @09                                                      01821000
R13      EQU   @13                                                      01822000
R15      EQU   @15                                                      01823000
$RCAAREA EQU   0                                                        01824000
$POINTER EQU   $RCAAREA+100                                             01825000
$TRTBLA  EQU   $POINTER+124                                             01826000
$CONSTNT EQU   $RCAAREA+244                                             01827000
$RCAFLG  EQU   $RCAAREA+604                                             01828000
$TRTBL   EQU   0                                                        01829000
TOLTEPWA EQU   0                                                        01830000
$CDA     EQU   TOLTEPWA+100                                             01831000
$RCA     EQU   $CDA+44                                                  01832000
$ENDCOMM EQU   $CDA+48                                                  01833000
$OLTPTR  EQU   $CDA+52                                                  01834000
$LOWADDR EQU   $OLTPTR                                                  01835000
$HIMOREC EQU   $CDA+60                                                  01836000
$HIGHADR EQU   $HIMOREC                                                 01837000
$TEPBEGN EQU   $CDA+68                                                  01838000
$TEPEND  EQU   $CDA+76                                                  01839000
$COMMFLG EQU   TOLTEPWA+224                                             01840000
$FLAG3   EQU   $COMMFLG+2                                               01841000
$PRTONLY EQU   $FLAG3                                                   01842000
$ALTPRTR EQU   $FLAG3                                                   01843000
$FLAG4   EQU   $COMMFLG+3                                               01844000
$OPCOM   EQU   $FLAG4                                                   01845000
$DMSGSW  EQU   $FLAG4                                                   01846000
$BACKINT EQU   $FLAG4                                                   01847000
$FLAG6   EQU   $COMMFLG+5                                               01848000
$ABNDBIT EQU   $FLAG6                                                   01849000
$ABTERM  EQU   $ABNDBIT                                                 01850000
$CIREQ   EQU   $FLAG6                                                   01851000
$FLAG8   EQU   $COMMFLG+7                                               01852000
$TCECM   EQU   $FLAG8                                                   01853000
$FLAG12  EQU   $COMMFLG+11                                              01854000
$BUFFER  EQU   TOLTEPWA+1976                                            01855000
$INBUFR  EQU   TOLTEPWA+2104                                            01856000
#EXITA   EQU   TOLTEPWA+2632                                            01857000
$CCOMDAT EQU   TOLTEPWA+2644                                            01858000
$CFLGS   EQU   $CCOMDAT+16                                              01859000
$24FEMSG EQU   TOLTEPWA+2681                                            01860000
$24CATMG EQU   $24FEMSG+11                                              01861000
@NM00023 EQU   TOLTEPWA+2776                                            01862000
$OUNTPTR EQU   @NM00023+4                                               01863000
$NSPTR   EQU   $OUNTPTR                                                 01864000
$NSCNT   EQU   @NM00023+10                                              01865000
$ENXX    EQU   @NM00023+15                                              01866000
$IMITX   EQU   $ENXX                                                    01867000
SVESC033 EQU   TOLTEPWA+3160                                            01868000
SVECC013 EQU   TOLTEPWA+3232                                            01869000
SVEIC003 EQU   TOLTEPWA+3592                                            01870000
SVESC022 EQU   TOLTEPWA+3736                                            01871000
SVECC011 EQU   TOLTEPWA+4024                                            01872000
#EXIT    EQU   0                                                        01873000
STG      EQU   0                                                        01874000
BACKSAVE EQU   0                                                        01875000
PSW      EQU   0                                                        01876000
LPSW     EQU   PSW                                                      01877000
RPSW     EQU   PSW+4                                                    01878000
GPR      EQU   PSW+8                                                    01879000
BUBACK   EQU   0                                                        01880000
CURSTG   EQU   0                                                        01881000
ITATCF   EQU   0                                                        01882000
ITATCT   EQU   0                                                        01883000
RCAPTR   EQU   $RCA                                                     01884000
SVESC02D EQU   SVESC022                                                 01885000
BUFFER   EQU   $INBUFR                                                  01886000
ADR2     EQU   BUFFER                                                   01887000
ADR      EQU   ADR2                                                     01888000
DADR     EQU   ADR2+8                                                   01889000
ABUF     EQU   BUFFER+9                                                 01890000
BUF      EQU   ABUF                                                     01891000
DBUF     EQU   ABUF+8                                                   01892000
FILCHAR  EQU   BUFFER+45                                                01893000
UDATA    EQU   BUFFER+46                                                01894000
LDATA    EQU   UDATA                                                    01895000
RDATA    EQU   UDATA+8                                                  01896000
EDATA    EQU   $BUFFER                                                  01897000
EDAT     EQU   EDATA                                                    01898000
ELRD     EQU   $BUFFER                                                  01899000
EDATAL   EQU   ELRD                                                     01900000
EDATAR   EQU   ELRD+16                                                  01901000
PSWLOC   EQU   $INBUFR                                                  01902000
PSWL     EQU   PSWLOC                                                   01903000
PSWD     EQU   PSWLOC+8                                                 01904000
PSWR     EQU   PSWLOC+9                                                 01905000
DFORM    EQU   $INBUFR                                                  01906000
DFORMA   EQU   DFORM+1                                                  01907000
INCHAR   EQU   DFORMA                                                   01908000
DFORMC   EQU   DFORM+30                                                 01909000
DFORMB   EQU   DFORMC                                                   01910000
DFORMD   EQU   DFORMC+8                                                 01911000
DFIN     EQU   $INBUFR                                                  01912000
DFINB    EQU   DFIN+1                                                   01913000
GRCON    EQU   $INBUFR                                                  01914000
GRMSG    EQU   GRCON                                                    01915000
TBUFF    EQU   GRCON+2                                                  01916000
STMSG    EQU   $BUFFER                                                  01917000
ADAREA   EQU   $BUFFER                                                  01918000
INCT     EQU   $INBUFR                                                  01919000
SVECC012 EQU   SVESC022                                                 01920000
SVEIC00A EQU   SVEIC003                                                 01921000
SVEIC004 EQU   SVEIC003                                                 01922000
SVEIC005 EQU   SVEIC003                                                 01923000
SVESC02A EQU   SVESC022                                                 01924000
SVESC02B EQU   SVESC022                                                 01925000
SVESC02E EQU   SVESC022                                                 01926000
SVESC02F EQU   SVECC013                                                 01927000
SVESC024 EQU   SVESC022                                                 01928000
SVESC027 EQU   SVESC022                                                 01929000
SVESC029 EQU   SVESC033                                                 01930000
SVESC031 EQU   SVECC013                                                 01931000
SVESC032 EQU   SVECC011                                                 01932000
SVETC037 EQU   SVEIC003                                                 01933000
         AGO   .@UNREFD                START UNREFERENCED COMPONENTS    01934000
DFINA    EQU   DFIN                                                     01935000
DDUMA    EQU   DFORM+3                                                  01936000
DDUM     EQU   DFORM                                                    01937000
SVECC010 EQU   TOLTEPWA+3952                                            01938000
SVETC035 EQU   TOLTEPWA+3880                                            01939000
SVESC030 EQU   TOLTEPWA+3808                                            01940000
SVESC020 EQU   TOLTEPWA+3664                                            01941000
SVEIC002 EQU   TOLTEPWA+3520                                            01942000
SVECC014 EQU   TOLTEPWA+3376                                            01943000
SVESC120 EQU   TOLTEPWA+3304                                            01944000
SVESC025 EQU   TOLTEPWA+3088                                            01945000
@NM00025 EQU   TOLTEPWA+2980                                            01946000
$RPLERR  EQU   TOLTEPWA+2977                                            01947000
@NM00024 EQU   TOLTEPWA+2976                                            01948000
$R13PR3  EQU   TOLTEPWA+2972                                            01949000
$CEINT2  EQU   TOLTEPWA+2968                                            01950000
$CEINT1  EQU   TOLTEPWA+2964                                            01951000
$MSGGET  EQU   TOLTEPWA+2960                                            01952000
$ACQLIST EQU   TOLTEPWA+2956                                            01953000
$R4SAVE1 EQU   TOLTEPWA+2952                                            01954000
$CLSISS  EQU   TOLTEPWA+2950                                            01955000
$CLSCNT  EQU   TOLTEPWA+2948                                            01956000
$CUTABLE EQU   TOLTEPWA+2868                                            01957000
$BUFSZ2  EQU   TOLTEPWA+2864                                            01958000
$RESID2  EQU   TOLTEPWA+2860                                            01959000
$OLTCCW2 EQU   TOLTEPWA+2856                                            01960000
$ENDBFR2 EQU   TOLTEPWA+2852                                            01961000
$1STBFR2 EQU   TOLTEPWA+2848                                            01962000
$TECB2   EQU   TOLTEPWA+2844                                            01963000
$BUFSZ1  EQU   TOLTEPWA+2840                                            01964000
$RESID1  EQU   TOLTEPWA+2836                                            01965000
$OLTCCW1 EQU   TOLTEPWA+2832                                            01966000
$ENDBFR1 EQU   TOLTEPWA+2828                                            01967000
$1STBFR1 EQU   TOLTEPWA+2824                                            01968000
$TECB1   EQU   TOLTEPWA+2820                                            01969000
$WAITIME EQU   TOLTEPWA+2816                                            01970000
$TRTN#   EQU   TOLTEPWA+2815                                            01971000
$WIODEV  EQU   TOLTEPWA+2814                                            01972000
$RQSTSZE EQU   TOLTEPWA+2812                                            01973000
$RQSTPTR EQU   TOLTEPWA+2808                                            01974000
$R4SAVE  EQU   TOLTEPWA+2804                                            01975000
$PARTADR EQU   TOLTEPWA+2800                                            01976000
$TBSDATA EQU   TOLTEPWA+2796                                            01977000
$CTWIDTH EQU   TOLTEPWA+2795                                            01978000
$CTLINE  EQU   TOLTEPWA+2794                                            01979000
$APWIDTH EQU   TOLTEPWA+2793                                            01980000
$APLINE  EQU   TOLTEPWA+2792                                            01981000
$INDEX   EQU   $IMITX                                                   01982000
$UMXX    EQU   @NM00023+14                                              01983000
$NSXX    EQU   @NM00023+12                                              01984000
$ATACNT  EQU   $NSCNT                                                   01985000
$CTR     EQU   @NM00023+8                                               01986000
$ATAPTR  EQU   $NSPTR                                                   01987000
$DDRPTR  EQU   @NM00023                                                 01988000
$DTORESP EQU   TOLTEPWA+2712                                            01989000
$APNAME  EQU   TOLTEPWA+2704                                            01990000
$24SYMNE EQU   $24CATMG+4                                               01991000
$24DEVAD EQU   $24CATMG                                                 01992000
$24RTN#  EQU   $24FEMSG+8                                               01993000
$ESECTID EQU   $24FEMSG                                                 01994000
$24FLGS  EQU   TOLTEPWA+2680                                            01995000
$24SAVE2 EQU   TOLTEPWA+2676                                            01996000
$24SAVE1 EQU   TOLTEPWA+2672                                            01997000
$24UNADR EQU   TOLTEPWA+2668                                            01998000
$24SAV13 EQU   TOLTEPWA+2664                                            01999000
$24RETCD EQU   TOLTEPWA+2663                                            02000000
$MACID   EQU   TOLTEPWA+2661                                            02001000
$CSPARE  EQU   $CFLGS                                                   02002000
$C2WAY   EQU   $CFLGS                                                   02003000
$CINCT   EQU   $CCOMDAT+12                                              02004000
$CINADR  EQU   $CCOMDAT+8                                               02005000
$COUTCT  EQU   $CCOMDAT+4                                               02006000
$COUTAD  EQU   $CCOMDAT                                                 02007000
ROOTLOC  EQU   TOLTEPWA+2640                                            02008000
$RETREG  EQU   TOLTEPWA+2636                                            02009000
$WORK    EQU   TOLTEPWA+2376                                            02010000
$EXTA    EQU   TOLTEPWA+2320                                            02011000
$PASSONA EQU   TOLTEPWA+2264                                            02012000
$TRMINPT EQU   TOLTEPWA+2184                                            02013000
$TLTRPL3 EQU   TOLTEPWA+1856                                            02014000
$TLTRPL2 EQU   TOLTEPWA+1736                                            02015000
$TLTRPL1 EQU   TOLTEPWA+1616                                            02016000
$SLTBL   EQU   TOLTEPWA+1468                                            02017000
@NM00022 EQU   TOLTEPWA+1464                                            02018000
$DEVTBLE EQU   TOLTEPWA+240                                             02019000
@NM00021 EQU   $COMMFLG+15                                              02020000
@NM00020 EQU   $COMMFLG+14                                              02021000
@NM00019 EQU   $COMMFLG+13                                              02022000
@NM00018 EQU   $COMMFLG+12                                              02023000
@NM00017 EQU   $FLAG12                                                  02024000
$VARYINP EQU   $FLAG12                                                  02025000
$ENDTEST EQU   $FLAG12                                                  02026000
$VRYHRD  EQU   $FLAG12                                                  02027000
$VRYSFT  EQU   $FLAG12                                                  02028000
$POSTFLG EQU   $FLAG12                                                  02029000
$OPTMSG  EQU   $FLAG12                                                  02030000
@NM00016 EQU   $COMMFLG+10                                              02031000
@NM00015 EQU   $COMMFLG+9                                               02032000
@NM00014 EQU   $COMMFLG+8                                               02033000
$VS2     EQU   $FLAG8                                                   02034000
$VS1     EQU   $FLAG8                                                   02035000
$EDOS    EQU   $FLAG8                                                   02036000
@NM00013 EQU   $FLAG8                                                   02037000
$TWOWAY  EQU   $FLAG8                                                   02038000
@NM00012 EQU   $FLAG8                                                   02039000
@NM00011 EQU   $COMMFLG+6                                               02040000
$FSTMCIS EQU   $FLAG6                                                   02041000
$DISCREQ EQU   $FLAG6                                                   02042000
$DISCISS EQU   $FLAG6                                                   02043000
$CHANGE  EQU   $FLAG6                                                   02044000
$CTERROR EQU   $FLAG6                                                   02045000
$RECAL11 EQU   $FLAG6                                                   02046000
@NM00010 EQU   $COMMFLG+4                                               02047000
$ACTOPND EQU   $FLAG4                                                   02048000
$ACQCUTT EQU   $FLAG4                                                   02049000
$CLSSACT EQU   $FLAG4                                                   02050000
$TSTDEVP EQU   $FLAG4                                                   02051000
$APRQPER EQU   $FLAG4                                                   02052000
$NEWAP   EQU   $FLAG3                                                   02053000
$OPTERR  EQU   $FLAG3                                                   02054000
$REQSTOR EQU   $FLAG3                                                   02055000
$LOGOFFE EQU   $FLAG3                                                   02056000
$TSTERR  EQU   $FLAG3                                                   02057000
$DEVERR  EQU   $FLAG3                                                   02058000
@NM00009 EQU   $COMMFLG+1                                               02059000
@NM00008 EQU   $COMMFLG                                                 02060000
@NM00007 EQU   $CDA+120                                                 02061000
$CUCNT   EQU   $CDA+118                                                 02062000
@NM00006 EQU   $CDA+117                                                 02063000
$PRTFORM EQU   $CDA+116                                                 02064000
$OPISCNT EQU   $CDA+114                                                 02065000
$OPNDCNT EQU   $CDA+112                                                 02066000
$GETMSZE EQU   $CDA+110                                                 02067000
$GRCNTS  EQU   $CDA+108                                                 02068000
$CTLCNT  EQU   $CDA+106                                                 02069000
$ACTLVL  EQU   $CDA+105                                                 02070000
$PRNTLVL EQU   $CDA+104                                                 02071000
$ERRCNTA EQU   $CDA+102                                                 02072000
$TLCNT   EQU   $CDA+100                                                 02073000
$TIMEALW EQU   $CDA+96                                                  02074000
$PTRAREA EQU   $CDA+92                                                  02075000
$GETMPTR EQU   $CDA+88                                                  02076000
$R13PTRT EQU   $CDA+84                                                  02077000
$R13PTR  EQU   $CDA+80                                                  02078000
$PLINKDL EQU   $CDA+72                                                  02079000
$FRELPTR EQU   $CDA+64                                                  02080000
$LOMOREC EQU   $CDA+56                                                  02081000
$COMMON  EQU   $RCA                                                     02082000
$SLASHAD EQU   $CDA+32                                                  02083000
$PASSON  EQU   $CDA+28                                                  02084000
$TOLBRTB EQU   $CDA+24                                                  02085000
$SCTPTR8 EQU   $CDA+20                                                  02086000
$SCTPTR  EQU   $CDA+16                                                  02087000
$TBWDPTR EQU   $CDA+12                                                  02088000
$TFWDPTR EQU   $CDA+8                                                   02089000
@NM00005 EQU   $CDA                                                     02090000
$SCTTBLE EQU   TOLTEPWA                                                 02091000
$TLTEND  EQU   $RCAAREA+945                                             02092000
$CNSLID  EQU   $RCAAREA+936                                             02093000
$EXITSAV EQU   $RCAAREA+864                                             02094000
$TRASCII EQU   $RCAAREA+608                                             02095000
@NM00004 EQU   $RCAAREA+605                                             02096000
$VTAMEND EQU   $RCAFLG                                                  02097000
$TPPOSTD EQU   $RCAFLG                                                  02098000
$NEWCT   EQU   $RCAFLG                                                  02099000
$ABNDALL EQU   $RCAFLG                                                  02100000
$CUTESTB EQU   $RCAFLG                                                  02101000
$CONSOLE EQU   $RCAFLG                                                  02102000
$TPLOGON EQU   $RCAFLG                                                  02103000
$UPDATE  EQU   $RCAFLG                                                  02104000
$DEVAREA EQU   $RCAAREA+600                                             02105000
$CTDVAR  EQU   $RCAAREA+596                                             02106000
$BUFFS   EQU   $RCAAREA+464                                             02107000
$TLTNIB  EQU   $CONSTNT+140                                             02108000
$TLTPRPL EQU   $CONSTNT+20                                              02109000
@NM00003 EQU   $CONSTNT+4                                               02110000
@NM00002 EQU   $CONSTNT+2                                               02111000
$USECNT  EQU   $CONSTNT                                                 02112000
$CURRTWA EQU   $POINTER+140                                             02113000
$CTNAME  EQU   $POINTER+132                                             02114000
$CTARGX  EQU   $POINTER+128                                             02115000
$COMINT  EQU   $POINTER+120                                             02116000
$QUEHNDL EQU   $POINTER+116                                             02117000
@NM00001 EQU   $POINTER+36                                              02118000
$RTNPTR  EQU   $POINTER+32                                              02119000
$TLTECB2 EQU   $POINTER+28                                              02120000
$TLTECB1 EQU   $POINTER+24                                              02121000
$CLEANP  EQU   $POINTER+20                                              02122000
$ABEND   EQU   $POINTER+16                                              02123000
$LSTAREA EQU   $POINTER+12                                              02124000
$FSTAREA EQU   $POINTER+8                                               02125000
$CVTSAVE EQU   $POINTER+4                                               02126000
$TOLTEP  EQU   $POINTER                                                 02127000
$TLTACB  EQU   $RCAAREA                                                 02128000
.@UNREFD ANOP                          END UNREFERENCED COMPONENTS      02129000
@RT00197 EQU   T37C0370                                                 02130000
@RT00276 EQU   T37C0080                                                 02131000
@RT00280 EQU   T37C0080                                                 02132000
@RT00309 EQU   T37C0080                                                 02133000
@RT00316 EQU   T37C0330                                                 02134000
@RT00321 EQU   T37C0340                                                 02135000
@RF00321 EQU   @RC00319                                                 02136000
@RT00327 EQU   T37C0340                                                 02137000
@RF00327 EQU   @RC00325                                                 02138000
@RT00333 EQU   T37C0340                                                 02139000
@RF00333 EQU   @RC00331                                                 02140000
@RT00339 EQU   T37C0340                                                 02141000
@RF00339 EQU   @RC00337                                                 02142000
@RT00353 EQU   T37C0370                                                 02143000
@RT00355 EQU   T37C0050                                                 02144000
@RT00358 EQU   T37C0050                                                 02145000
@RT00389 EQU   T37C0345                                                 02146000
@ENDDATA EQU   *                                                        02147000
         END   ISTTC037,(C'PLS1541',0702,78337)                         02148000
