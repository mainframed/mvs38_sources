./  ADD  SSI=31230548,NAME=IEBCANAL
*********************************************************************** 00020000
*                                                                     * 00040000
* NAME             *****   *   *   *****   *       *   *              * 00060000
*                  *   *   **  *   *   *   *        * *               * 00080000
*                  *****   * * *   *****   *         *                * 00100000
*                  *   *   *  **   *   *   *         *                * 00120000
*                  *   *   *   *   *   *   *****     *                * 00140000
*                                                                     * 00160000
*********************************************************************** 00180000
*                                                                     * 00200000
* FUNCTION/OPERATION                                                  * 00220000
*                                                                     * 00240000
*      THIS IS THE CONTROL CARD ANALYZER MODULE FOR THE DATA SET      * 00260000
*   UTILITY IEBCOMPR.  ITS MAIN FUNCTIONS ARE THE FOLLOWING:          * 00280000
*                                                                     * 00300000
*       1. PRINT THE CONTROL CARDS FOR IEBCOMPR                       * 00320000
*       2. PRINT DIAGNOSTIC MESSAGES ABOUT THE CONTROL CARDS, AFTER   * 00340000
*            THE CARDS HAVE BEEN THROUGHLY ANALYZED BY THE MODULE     * 00360000
*       3. SET THE ABORT SWITCH WHEN APPLICABLE                       * 00380000
*       4. SET UP THE EXITS PARAMETER LIST FOR THE MAIN PROCESSOR     * 00400000
*       5. PRINT THE DIAGNOTIC MESSAGE TO INDICATE THAT SYSIN COULD   * 00420000
*            NOT BE OPENED IF THE CARD SCANNER FINDS THIS TO BE THE   * 00440000
*            CASE                                                     * 00460000
*                                                                     * 00480000
*********************************************************************** 00500000
*                                                                     * 00520000
* ENTRY POINTS                                                        * 00540000
*                                                                     * 00560000
*   1. 'ANALY'      THIS IS THE ENTRY POINT TO THE FIRST OVERLAY      * 00580000
*                 SEGMENT. CONTROL IS PASSED TO THIS POINT FROM THE   * 00600000
*                 ROOT SEGMENT.                                       * 00620000
*                                                                     * 00640000
*   2. 'DDRTN'      THE CARD SCANNER ENTERS HERE IF IT FINDS THAT     * 00660000
*                 SYSIN CANNOT BE OPPENED.                            * 00680000
*                                                                     * 00700000
*   3. 'BLKRTN'     THE CARD SCANNER ENTERS HERE IF IT FINDS THAT* BS0H 00706017
*                 SYSIN HAS AN INVALID BLOCKSIZE.                * BS0H 00712017
*********************************************************************** 00720000
         EJECT                                                          00740000
*********************************************************************** 00760000
*                                                                     * 00780000
* INPUT                                                               * 00800000
*                                                                     * 00820000
*       INPUT TO THE ANALYZER COMES FROM THE GENERALIZED CARD SCANNER.* 00840000
*   PARAMETERS ARE PASSED ONE AT A TIME FROM THE SCANNER TO THE       * 00860000
*   ANALYZER, AT WHICH TIME THE PARAMETERS ARE INTERROGATED.          * 00880000
*   WHEN CONTROL IS RECEIVED FROM THE CCS02 SCAN ROUTINE,         *SA0I 00885018
*   REGISTER 0 CONTAINS THE LENGTH OF THE WORD BEING ANALYZED AND *SA0I 00890018
*   REGISTER 1 IS A POINTER TO THAT WORD.                         *SA0I 00895018
*                                                                     * 00900000
*********************************************************************** 00920000
*                                                                     * 00940000
* OUTPUT                                                              * 00960000
*                                                                     * 00980000
*     THE OUTPUT OF THE ANALYZER IS SIMPLY THE SETTING OF SWITCHES,   * 01000000
*   THE BUILDING OF PARAMETER LISTS FOR THE MAIN PROCESSOR, OR THE    * 01020000
*   SETTING OF PARAMETERS FOR THE GENERALIZED MESSAGE WRITER.         * 01040000
*                                                                     * 01060000
*********************************************************************** 01080000
*                                                                     * 01100000
* EXTERNAL ROUTINES                                                   * 01120000
*                                                                     * 01140000
*     THE CONTROL CARD SCANNER IS CALLED EACH TIME A NEW PARAMETER IS * 01160000
*   WANTED.  THE ONLY OTHER EXTERNAL ROUTINES ARE THE PRINT ROUTINES  * 01180000
*   WHICH ARE LOCATED IN THE ROOT SEGMENT.  THESE ROUTINES ARE 'ZZPR' * 01200000
*   AND 'JPRINTRT', AND ARE REACHED BY BRANCH AND LINK INSTRUCTIONS.  * 01220000
*                                                                     * 01240000
*********************************************************************** 01260000
         EJECT                                                          01280000
*********************************************************************** 01300000
*                                                                     * 01320000
* EXITS                                                               * 01340000
*                                                                     * 01360000
*     THE ONLY EXIT FROM THE ANALYZER IS A BRANCH ON REGISTER 14,     * 01380000
*   TAKING ONE BACK TO THE ROOT SEGMENT FOR IEBCOMR.                  * 01400000
*                                                                     * 01420000
*********************************************************************** 01440000
*                                                                     * 01460000
* TABLES /WORK AREAS                                                  * 01480000
*                                                                     * 01500000
*     THERE ARE NO TABLES AS SUCH, JUST PARAMETER LISTS AND SWITCHES  * 01520000
*   WHICH ARE CONSTRUCTED BY THE ANALYZER OR INTERROGATED BY IT.      * 01540000
*                                                                     * 01560000
*********************************************************************** 01580000
*                                                                     * 01600000
* ATTRIBUTES                                                          * 01620000
*                                                                     * 01640000
*     NON-REENTRANT AND NON-REUSEABLE                                 * 01660000
*                                                                     * 01680000
*********************************************************************** 01700000
         EJECT                                                          01720000
COMMX    DSECT                                                          01740000
         USING COMMX,10                                                 01760000
SAVE1315 DS    3F                  SAVE AREA FOR REGS 13,14, AND 15     01780000
SAVEREGS DS    18F                 MY REGISTER SAVE AREA                01800000
PARALIST DS    8F            THE EXITS PARAMETER LIST-USER RTNS    SA0I 01820018
*                                    1. INHDR PARAMETER NAME            01840000
*                                    2. INTLR PARAMETER NAME            01860000
*                                    3. ERROR PARAMETER NAME            01880000
*                                    4. PRECOMP PARAMETER NAME          01900000
DDSYSIN  DS    2F                  SYSIN PARAMETER                      01920000
DDSUBNAM DS    4F                  DDNAME PARAMETER LIST                01940000
*                                    1. SYSUT1 DDNAME                   01960000
*                                    2. SYSUT2 DDNAME                   01980000
HICONCOD DS    2X                  RETURN CODE STORAGE AREA             02000000
CCADSORG DS    1X                  SET TO '01' IF PARTITIONED DATA SET  02020000
ABORTSW  DS    1X                  ABORT SWITCH - SET TO '01' IF ON     02040000
LABEL    DS    1X             SET TO X'00' IF DATA=YES             UL0H 02044017
*                                    X'01' IF DATA=NO              UL0H 02048017
*                                    X'10' IF DATA=ONLY            UL0H 02052017
*                                    X'20' IF DATA=ALL             UL0H 02056017
*********************************************************************** 02060000
ANALY    CSECT                                                          02080000
* 044970-045600,045620                                           A27718 02082019
*8047046600                                                        BS0H 02084017
*2652018200,020980,023460-023600,024000,026200,026900-028400,      SA0I 02084518
* 029600-030600,030700,031000,031130,031200,031600-031900,         SA0I 02085018
* 032600,032700,033400,034000,034200,035000,035800,035960-         SA0I 02085518
* 036600,036800,037200,037400,038000,038200,038800,040400,041600,  SA0I 02086018
* 042800,044000,044032,044056,044088,044096,044186-045200,045800,  SA0I 02086518
* 045900,050800-051400,053400                                      SA0I 02087018
* 030160,030800,030852-030856                                     M2002 02087518
* REGISTER ASSIGNMENTS                                             BS0H 02088017
PARMREG  EQU   1                                                   BS0H 02092017
R15      EQU   15                                                  BS0H 02096017
R14      EQU   14                                                       02097017
R0       EQU   0                  CONTAINS LENGTH OF WORD SCANNED  SA0I 02097518
R1       EQU   1                                                   SA0I 02098018
R2       EQU   2                  CONTAINS MESSAGE CODE            SA0I 02098518
R3       EQU   3                                                   SA0I 02099018
R4       EQU   4                                                   SA0I 02099518
         ENTRY DDRTN                                                    02100000
         ENTRY BLKRTN                                              BS0H 02110017
         SAVE  (14,12)                                                  02120000
         BALR  11,0                                                     02140000
         USING *,11                                                     02160000
         STM   13,14,SAV13A14                                           02180000
         LA    13,SAVANALR                                              02200000
         XC    CTLAREA(144),CTLAREA  FILL WORK AREA WITH ZEROS          02220000
         MVI   PARALIST,X'40'      FILL PARAMETER LIST                  02240000
         MVC   PARALIST+1(31),PARALIST  WITH BLANKS                     02260000
         MVC   DDJOSIN(8),DDSYSIN                                       02280000
CALLSCAN CALL  ACTCCS,(CTLAREA,DDJOSIN),ID=1                            02300000
         TM    CTLAREA,X'20'       END OF FILE TEST                     02320000
         BO    ENDOFANA              BRANCH BACK TO ROOT SEG (IS EOF)   02340000
         CLI   CTLAREA+144,X'01'  IS NEW CARD SW ON                SA0I 02360018
         BH    ERRFRSCA              INPUT ERROR - ABORT JOB            02380000
         BL    ERRTST             NO-BRANCH TO ERROR TESTS         SA0I 02400018
*********************************************************************** 02420000
***      GO PRINT CONTROL CARD AND CONTINUE PROCESSING                  02440000
*********************************************************************** 02460000
         STM   0,1,SAVEREG0                                             02480000
         LA    0,79                                                     02500000
         LA    1,CTLAREA+1                                              02520000
         L     15,MYPRTCON                                              02540000
         BALR  14,15                                                    02560000
         LM    0,1,SAVEREG0                                             02580000
*********************************************************************** 02600000
*******************************************************************SA0I 02600318
*                TEST FOR ERRORS FLAGGED BY CCS02 SCAN ROUTINE    *SA0I 02600618
*******************************************************************SA0I 02600918
ERRTST   TM    CTLAREA,X'80'      IS ERROR BIT ON                  SA0I 02601218
         BZ    BPASTST            NO-TEST BYPASS BIT               SA0I 02601518
         TM    CTLAREA,X'40'      YES-IS BYPASS BIT ON             SA0I 02601818
         BO    COMTST             YES THEN DETERMINE TYPE OF ERROR SA0I 02602118
         LA    R1,26              NO-WARNING INVALID NAME          SA0I 02602418
         L     R15,PRINCONS       LOAD PRINT ROUTINE ADDRESS       SA0I 02602718
         BALR  R14,R15            BRANCH TO PRINT ERROR MESSAGE    SA0I 02603018
         B     CALLSCAN           RETURN TO SCAN ROUTINE           SA0I 02603318
COMTST   TM    CTLAREA,X'08'      IS COMMAND BIT ON                SA0I 02603618
         BZ    KEYTST             NO-THEN TEST KEYWORD BIT         SA0I 02603918
         OI    FIRSTCOC,X'01'     YES-SET SWITCH IF NOT ON         SA0I 02604218
         TM    CTLAREA,X'06'      IS KEYWORD OR PARAMETER BIT ON   SA0I 02604518
         BZ    WRNGCOM            NO-BRANCH FOR INVALID COMMAND    SA0I 02604818
         LA    R2,60              YES MISSING COMMAND              SA0I 02605118
         B     COLCALC            CALCULATE ERROR COLUMN NUMBER    SA0I 02605418
WRNGCOM  LA    R2,65              INVALID COMMAND                  SA0I 02605718
         B     COLCALC            CALCULATE ERROR COLUMN NUMBER    SA0I 02606018
KEYTST   TM    CTLAREA,X'04'      IS KEYWORD BIT ON                SA0I 02606318
         BZ    PARATST            NO-THEN TEST PARAMETER BIT       SA0I 02606618
WRNGKEY  NI    PARMSW,X'00'       YES-TURN OFF PARMSW              SA0I 02606918
         LA    R2,59              INVALID KEYWORD                  SA0I 02607218
         B     COLCALC            CALCULATE ERROR COLUMN NUMBER    SA0I 02607518
PARATST  TM    CTLAREA,X'02'      IS PARAMETER BIT ON              SA0I 02607818
         BZ    KEYREQ             NO-TEST KEYWORD REQUIRED BIT     SA0I 02608118
         LA    R2,61              YES-INVALID PARAMETER            SA0I 02608418
         B     COLCALC            CALCULATE ERROR COLUMN NUMBER    SA0I 02608718
KEYREQ   TM    CTLAREA+81,X'02'   IS KEYWORD REQUIRED BIT ON       SA0I 02609018
         BZ    PARAREQ            NO-TEST PARAMETER REQUIRED BIT   SA0I 02609318
         LA    R2,62              MISSING KEYWORD                  SA0I 02609618
         B     COLCALC            CALCULATE ERROR COLUMN NUMBER    SA0I 02609918
PARAREQ  TM    CTLAREA+81,X'01'   IS PARAMETER REQUIRED BIT ON     SA0I 02610218
         BZ    WRNGCOL            NO-THEN CONTINUATION IN ERROR    SA0I 02610518
         LA    R2,63              MISSING PARAMETER                SA0I 02610818
         B     COLCALC            CALCULATE ERROR COLUMN NUMBER    SA0I 02611118
WRNGCOL  LA    R1,66              CONTINUATION CARD IN WRONG COL   SA0I 02611418
         L     R15,PRINCONS       LOAD PRINT ROUTINE ADDRESS       SA0I 02611718
         BALR  R14,R15            BRANCH TO PRINT ERROR MESSAGE    SA0I 02612018
         OI    HICONCOD+1,X'0C'   RETURN CODE                      SA0I 02612318
         OI    ABORTSW,X'01'      TURN ON ABORT SWITCH             SA0I 02612618
         B     CALLSCAN           BRANCH TO SCAN ROUTINE           SA0I 02612918
BPASTST  TM    CTLAREA,X'40'      IS BYPASS BIT ON                 SA0I 02613218
         BZ    COMPCD             NO-THEN NO SYNTAX ERRORS FOUND   SA0I*02613518
                                  BY CCS02, CONTINUE ANALYSIS      SA0I 02613818
         TM    CTLAREA,X'01'      IS END OF PARAMETER BIT ON       SA0I 02614118
         BZ    CALLSCAN           NO-THEN RETURN TO SCAN,          SA0I*02614418
                                  YES-THEN CONTINUE ANALYSIS       SA0I 02614718
*******************************************************************SA0I 02615018
*        TEST FOR COMPARE COMMAND ON FIRST CONTROL CARD           *SA0I 02615318
*******************************************************************SA0I 02615618
COMPCD   TM    FIRSTCOC,1         HAS COMPARE CARD BEEN READ       SA0I 02625618
         BO    TESFORER              YES-BRANCH AROUND                  02640000
         MVI   FIRSTCOC,1          SET SWITCH IND. COMPARE CD. READ     02660000
         CLC   COMWORD1(7),0(1)    DOES COMMAND WORD = COMPARE          02680000
         BE    LENG7              YES-THEN TEST WORD LENGTH        SA0I 02680918
         LA    R1,64           NO-FIRST CONTROL CARD NOT 'COMPARE' SA0I 02681818
         L     R15,PRINCONS       LOAD PRINT ROUTINE ADDRESS       SA0I 02682718
         BALR  R14,R15            BRANCH TO PRINT ERROR MESSAGE    SA0I 02683618
         B     BYPASCD            SET BY PASS SW ON                SA0I 02684518
LENG7    LA    R3,7               IS WORD LENGTH=7                 SA0I 02685418
         CLR   R0,R3                                               SA0I 02686318
         BE    COMPST             YES THEN COMMAND IS VALID        SA0I 02687218
         LA    R2,65              INVALID COMMAND                  SA0I 02688118
         B     COLCALC            CALCULATE ERROR COLUMN NUMBER    SA0I 02689018
COMPST   OI    CDSW,X'01'         SET SW TO COMPARE STMNT ANALYSIS SA0I 02694018
         B     CALLSCAN           BRANCH TO SCAN ROUTINE           SA0I 02704018
TESFORER TM    CTLAREA,X'02'      PARAMETER TEST                   SA0I 02774018
         BO    PARSET                POSITIVE RESPONSE                  02860000
         TM    CTLAREA,X'04'       KEYWORD TEST                         02880000
         BO    KEYWORDT              POSITIVE RESPONSE                  02900000
         TM    CTLAREA,X'08'       COMMAND WORD TEST                    02920000
         BO    COMWORDT              POSITIVE RESPONSE                  02940000
         LA    R1,1               INVALID CONTROL STATEMENT        SA0I 02944018
         L     R15,PRINCONS       LOAD PRINT ROUTINE ADDRESS       SA0I 02948018
         BALR  R14,R15            BRANCH TO PRINT ERROR MESSAGE    SA0I 02952018
         B     BYPASCD            GO TO SET BYPASS SW              SA0I 02956018
*******************************************************************SA0I 02966018
*                  TEST FOR VALID COMMAND WORD                    *SA0I 02976018
*******************************************************************SA0I 02986018
COMWORDT LA    R3,5               IS COMMAND LENGTH=5              SA0I 02996018
         CLR   R0,R3                                               SA0I 03006018
         BNE   COMWDT2            CHECK OTHER COMMANDS            M2002 03016018
         CLC   COMWORD2(5),0(R1)  DOES COMMAND WORD=EXITS          SA0I 03036018
         BNE   ERMSG                   NOT EXITS                   SA0I 03046018
         MVI   CDSW,X'02'     YES-SET SW IND. IN EXITS STMNT ANAL. SA0I 03068018
         OI    CTLAREA+81,X'02'   TURN ON KEYWORD REQUIRED BIT     SA0I 03071018
         B     CALLSCAN            BRANCH                          UL0H 03075017
COMWDT2  CLC   COMWORD3(6),0(R1)  DOES COMMAND WORD = LABELS      M2002 03080018
         BNE   ERMSG          NO                                   UL0H 03085017
         LA    R3,6               CONSTANT SIX IN REG             M2002 03086018
         CLR   R0,R3              IS LENGTH = SIX                 M2002 03087018
         BNE   ERMSG              NO, WRITE ERR MSG               M2002 03088018
         TM    CCADSORG,X'01'      ARE DATA SETS PARTITIONED       UL0H 03090017
         BO    ULABPO              YES, BRANCH                     UL0H 03095017
         MVI   CDSW,X'04'      NO-SET SW IND IN LABEL STMNT ANAL.  SA0I 03098018
         OI    CTLAREA+81,X'02'   TURN ON KEYWORD REQUIRED BIT     SA0I 03101018
         B     CALLSCAN      BRANCH                                UL0H 03106017
ERMSG    CLC   COMWORD1(5),0(R1)  IS COMMAND=COMPARE               SA0I 03107018
         BE    COMPRD             YES-CHECK FOR DUPLICATE          SA0I 03108018
         LA    R2,65              NO-INVALID COMMAND               SA0I 03109018
         B     COLCALC            CALCULATE ERROR COLUMN NUMBER    SA0I 03110018
COMPRD   TM    CDSW,X'01'         HAS COMPARE CARD BEEN READ       SA0I 03111018
         BZ    ILLSEQ             NO-THEN INVALID SEQUENCE         SA0I 03112018
         LA    R1,13              YES-REPETITIOUS CARD INVALID     SA0I 03113018
         B     WRTMSG             PRINT ERROR MESSAGE              SA0I 03114018
ILLSEQ   LA    R1,16              ILLEGAL CONTROL CARD SEQUENCE    SA0I 03115018
WRTMSG   L     R15,PRINCONS       LOAD PRINT ROUTINE ADDRESS       SA0I 03125018
         BALR  14,15               BRANCH TO PRINT ERROR MESSAGE        03140000
         B     BYPASCD            SET BYPASS SW ON                 SA0I 03160018
*******************************************************************SA0I 03166018
*                    TEST FOR A VALID KEYWORD                     *SA0I 03172018
*******************************************************************SA0I 03178018
KEYWORDT NI    PARMSW,X'00'       TURN OFF PARMSW                  SA0I 03184018
         TM    CDSW,X'01'         IS COMPARE STMNT ANALYSIS        SA0I 03190018
         BZ    KCOMP2         NO                                   UL0H 03200017
         LA    R3,6               YES IS KEYWORD LENGTH=6          SA0I 03202018
         CLR   R0,R3                                               SA0I 03204018
         BNE   BADKEYW            NO-INVALID KEYWORD               SA0I 03206018
         CLC   KEYWORD1(6),0(R1) DOES KEYWORD=TYPORG               UL0H 03210017
         BNE   BADKEYW        NO,ILLEGAL KEY WORD                  UL0H 03220017
         MVI   KWORDSW,X'01'         YES, SET KWORDSW = 1               03240000
TURNOF   NI    CTLAREA+81,X'FD'   TURN OFF KEYWORD REQUIRED BIT    SA0I 03246018
         OI    CTLAREA+81,X'01'   TURN ON PARAMETER REQUIRED BIT   SA0I 03252018
         B     CALLSCAN           BRANCH TO SCAN ROUTINE           SA0I 03261018
KCOMP2   TM    CDSW,X'02'         IS EXITS STMNT ANALYSIS          SA0I 03270018
         BZ    KCOMP6         NO                                   UL0H 03280017
         LA    R3,5               YES-IS LENGTH=5                  SA0I 03282018
         CLR   R0,R3                                               SA0I 03284018
         BNE   KCOMP5             NO-THEN TEST FOR LENGTH=7        SA0I 03286018
         CLC   KEYWORD2(5),0(R1) DOES KEYWORD=INHDR                UL0H 03290017
         BNE   KCOMP3                NO                                 03300000
         TM    CCADSORG,X'01'      ARE DATA SETS PARTITIONED       UL0H 03306017
         BO    ULABPO              YES, BRANCH                     UL0H 03312017
         MVI   KWORDSW,X'02'      NO, SET KWORDSW=2                SA0I 03322018
         B     TURNOF             PARAMETER IS REQUIRED            SA0I 03332018
KCOMP3   CLC   KEYWORD3(5),0(1)    DOES KEYWORD = INTLR                 03360000
         BNE   KCOMP4                NO                                 03380000
         TM    CCADSORG,X'01'      ARE DATA SETS PARTITIONED       UL0H 03386017
         BO    ULABPO              YES, BRANCH                     UL0H 03392017
         MVI   KWORDSW,X'04'      NO,SET KWORDSW=4                 SA0I 03402018
         B     TURNOF             PARAMETER IS REQUIRED            SA0I 03412018
KCOMP4   CLC   KEYWORD4(5),0(1)    DOES KEYWORD = ERROR                 03440000
         BNE   KCOMP5                NO                                 03460000
         MVI   KWORDSW,X'08'         YES, SET KWORDSW = 8               03480000
         B     TURNOF             PARAMETER IS REQUIRED            SA0I 03500018
KCOMP5   CLC   KEYWORD5(7),0(1)    DOES KEYWORD = PRECOMP               03520000
         BNE   BADKEYW               NO                                 03540000
         LA    R3,7               IS LENGTH=7                      SA0I 03545018
         CLR   R0,R3                                               SA0I 03550018
         BNE   BADKEYW            NO-INVALID KEYWORD               SA0I 03555018
         MVI   KWORDSW,X'10'         YES, SET KWORDSW = 10              03560000
         B     TURNOF             PARAMETER IS REQUIRED            SA0I 03570018
KCOMP6   CLC   KEYWORD6(4),0(R1) DOES KEYWORD=DATA                 UL0H 03584017
         BNE   BADKEYW            NO-INVALID KEYWORD               SA0I 03585018
         LA    R3,4               IS WORD LENGTH=4                 SA0I 03586018
         CLR   R0,R3                                               SA0I 03587018
         BNE   BADKEYW        NO,ILLEGAL KEY WORD                  UL0H 03588017
         MVI   KWORDSW,X'20'  YES SET KWORDSW=X'20'                UL0H 03592017
         B     TURNOF             PARAMETER IS REQUIRED            SA0I 03596018
BADKEYW  LA    R2,59              INVALID KEYWORD                  SA0I 03606018
         B     COLCALC            CALCULATE ERROR COLUMN NUMBER    SA0I 03616018
*******************************************************************SA0I 03626018
*                    TEST FOR A VALID PARAMETER                   *SA0I 03636018
*******************************************************************SA0I 03646018
PARSET   LTR   0,0                 DOES PARAMETER LENGTH EQUAL ZERO     03700000
         BNZ   KEYTYP             NO-TEST FOR VALID PARAMETER      SA0I 03710018
         LA    R2,63              MISSING PARAMETER                SA0I 03720018
         B     COLCALC            CALCULATE ERROR COLUMN NUMBER    SA0I 03730018
KEYTYP   TM    PARMSW,X'01'       HAS A PARAMETER BEEN READ        SA0I 03736018
         BO    PARERR             YES, INVALID PARAMETER           SA0I 03742018
         OI    PARMSW,X'01'       NO, TURN ON PARMSW               SA0I 03748018
         TM    KWORDSW,X'01'      TEST FOR TYPORG KEYWORD          SA0I 03754018
         BZ    PTEST2                BRANCH - NOT TYPORG                03760000
         LA    R3,2               IS PARAMETER LENGTH=2            SA0I 03762018
         CLR   R0,R3                                               SA0I 03764018
         BE    TYPRD              YES-CHECK FOR DUPLICATE          SA0I 03766018
PARERR   LA    R2,61              INVALID PARAMETER                SA0I 03768018
         B     COLCALC            CALCULATE ERROR COLUMN NUMBER    SA0I 03770018
TYPRD    TM    TYPARA,X'01'       HAS TYPORG BEEN READ             SA0I 03772018
         BO    REPRTN             YES-INVALID REPETITIOUS CARD     SA0I 03774018
         OI    TYPARA,X'01'       NO-SET TYPORG SW ON              SA0I 03776018
         CLC   PARWORD2(2),0(1)       IS TYPORG PS                      03780000
         BNE   TYPPO              NO-THEN IS PO                    SA0I 03786018
         NI    CTLAREA+81,X'FC'   TURN OFF PARAMETER REQUIRED BIT  SA0I 03792018
         B     CALLSCAN           RETURN TO SCAN ROUTINE           SA0I 03802018
TYPPO    CLC   PARWORD1(2),0(R1)  IS TYPORG=PO                     SA0I 03812018
         BNE   PARERR                NO-BRANCH-PARAMETER ERROR          03840000
         MVI   CCADSORG,X'01'        YES-SET SW TO PO PARAMETER         03860000
PARMOFF  NI    CTLAREA+81,X'FC'   TURN OFF PARAMETER REQ BIT       SA0I 03870018
         B     CALLSCAN           RETURN TO SCAN ROUTINE           SA0I 03880018
PTEST2   CH    0,EIGHT             IS LENGTH GREATER THAN EIGHT         03900000
         BH    PARERR                YES-PARAMETER ERROR                03920000
         TM    KWORDSW,X'02'       IS KEYWORD=INHDR                     03940000
         BZ    PTEST3                NO                                 03960000
         SH    0,ONE                                                    03980000
         STC   0,MOVE1+1           MOVE INHDR ROUTINE NAME              04000000
MOVE1    MVC   PARALIST(1),0(1)      INTO PARAMETER LIST                04020000
         TM    CTLAREA,X'01'      IS END OF PARAMETER BIT ON       SA0I 04028018
         BC    1,PARMOFF          YES, TURN OFF PARAMETER REQ BIT  SA0I 04036018
         XI    CTLAREA+81,X'03'   NO, TURN ON KEYWORD REQ BIT      SA0I 04044018
         B     CALLSCAN           BRANCH TO SCAN ROUTINE           SA0I 04052018
PTEST3   TM    KWORDSW,X'04'       IS KEYWORD=INTLR                     04060000
         BZ    PTEST4                NO                                 04080000
         SH    0,ONE                                                    04100000
         STC   0,MOVE2+1           MOVE INTLR ROUTINE NAME              04120000
MOVE2    MVC   PARALIST+8(1),0(1)    INTO PARAMETER LIST                04140000
         TM    CTLAREA,X'01'      IS END OF PARAMETER BIT ON       SA0I 04148018
         BC    1,PARMOFF          YES, TURN OFF PARAMETER REQ BIT  SA0I 04156018
         XI    CTLAREA+81,X'03'   NO, TURN ON KEYWORD REQ BIT      SA0I 04164018
         B     CALLSCAN           BRANCH TO SCAN ROUTINE           SA0I 04172018
PTEST4   TM    KWORDSW,X'08'       IS KEYWORD=ERROR                     04180000
         BZ    PTEST5                NO                                 04200000
         SH    0,ONE                                                    04220000
         STC   0,MOVE3+1           MOVE ERROR ROUTINE NAME              04240000
MOVE3    MVC   PARALIST+16(1),0(1)   INTO PARAMETER LIST                04260000
         TM    CTLAREA,X'01'      IS END OF PARAMETER BIT ON       SA0I 04268018
         BC    1,PARMOFF          YES, TURN OFF PARAMETER REQ BIT  SA0I 04276018
         XI    CTLAREA+81,X'03'   NO, TURN ON KEYWORD REQ BIT      SA0I 04284018
         B     CALLSCAN           BRANCH TO SCAN ROUTINE           SA0I 04292018
PTEST5   TM    KWORDSW,X'10'       IS KEYWORD=PRECOMP                   04300000
         BZ    PTEST6         NO                                   UL0H 04320017
         SH    0,ONE                                                    04340000
         STC   0,MOVE4+1           MOVE PRECOMP ROUTINE NAME            04360000
MOVE4    MVC   PARALIST+24(1),0(1)   INTO PARAMETER LIST                04380000
         TM    CTLAREA,X'01'      IS END OF PARAMETER BIT ON       SA0I 04384018
         BC    1,PARMOFF          YES, TURN OFF PARAMETER REQ BIT  SA0I 04388018
         XI    CTLAREA+81,X'03'   NO, TURN ON KEYWORD REQ BIT      SA0I 04392018
         B     CALLSCAN           BRANCH TO SCAN ROUTINE           SA0I 04396018
PTEST6   TM    KWORDSW,X'20'       DOES KEYWORD=DATA               UL0H 04400817
         BZ    PARERR              NO,INVALID PARAMETER            UL0H 04401617
         TM    CTLAREA+81,X'01'   HAS PARAMETER BEEN READ          SA0I 04401718
         BZ    PARERR             YES-INVALID PARAMETER            SA0I 04401818
         LA    R3,2               NO-IS PARAMETER LENGTH=2         SA0I 04401918
         CLR   R0,R3                                               SA0I 04402018
         BNE   PTEST7             NO-THEN IS LENGTH=3              SA0I 04402118
         CLC   DATA1(2),0(R1)      YES,DATA=NO                     UL0H 04402417
         BNE   PARERR             NO-INVALID PARAMETER             SA0I 04403218
         MVI   LABEL,X'01' X       YES,SET SW IND. DATA=NO         UL0H 04404017
         NI    CTLAREA+81,X'FC'   TURN OFF PARAMETER REQUIRED BIT  SA0I 04404418
         B     CALLSCAN       BRANCH                               UL0H 04404817
PTEST7   LA    R3,3               IS PARAMETER LENGTH=3            SA0I 04405318
         CLR   R0,R3                                               SA0I 04405818
         BNE   PTEST8              NO                              UL0H 04406417
         CLC   DATA2(3),0(R1)     IS DATA=YES                      SA0I 04406618
         BNE   PTEST9             NO-TEST FOR DATA=ALL             SA0I 04406818
         MVI   LABEL,X'00'         YES,SET SW IND. DATA=YES        UL0H 04407217
         NI    CTLAREA+81,X'FC'   TURN OFF PARAMETER REQUIRED BIT  SA0I 04407618
         B     CALLSCAN       BRANCH                               UL0H 04408017
PTEST8   LA    R3,4               IS PARAMETER LENGTH=4            SA0I 04408218
         CLR   R0,R3                                               SA0I 04408418
         BNE   PARERR             NO-INVALID PARAMETER             SA0I 04408618
         CLC   DATA3(4),0(R1)     IS DATA=ONLY                     SA0I 04408818
         BNE   PARERR             NO-INVALID PARAMETER             SA0I 04409018
         MVI   LABEL,X'10'         YES,SET SW IND. DATA=ONLY       UL0H 04410417
         NI    CTLAREA+81,X'FC'   TURN OFF PARAMETER REQUIRED BIT  SA0I 04410818
         B     CALLSCAN       BRANCH                               UL0H 04411217
PTEST9   CLC   DATA4(3),0(R1)      DATA=ALL                        UL0H 04412017
         BNE   PARERR              NO, INVALID PARAM               UL0H 04412817
         MVI   LABEL,X'20'         YES, SET SW IND. DATA=ALL       UL0H 04413617
         NI    CTLAREA+81,X'FC'   TURN OFF PARAMETER REQUIRED BIT  SA0I 04414018
         B     CALLSCAN       BRANCH                               UL0H 04414417
ULABPO   LA    R1,50          USER LABEL NOT SUPPORT BY PO DATA SETUL0H 04415217
         L     R15,PRINCONS                                        UL0H 04416017
         BALR  R14,R15             PRINT                           UL0H 04416817
         MVI   HICONCOD+1,X'0C'                                    UL0H 04417617
         NI    CTLAREA+81,X'FC'   TURN OFFKEYWORD REQUIRED BIT     SA0I 04418118
         B     BYPASCD            SET BYPASS SW ON                 SA0I 04419018
*******************************************************************SA0I 04421018
*                  CALCULATE CONTROL CARD COLUMN WHERE            *SA0I 04423018
*                       ERROR IS FOUND                            *SA0I 04425018
*******************************************************************SA0I 04427018
COLCALC  LR    R4,R1              ADDRESS OF ERROR IN CTLAREA      SA0I 04429018
         LA    R3,CTLAREA                                          SA0I 04431018
         SR    R4,R3              R4 CONTAINS CARD COL NO WHERE    SA0I*04433018
                                  ERROR IS FOUND                   SA0I 04435018
         CVD   R4,DECAREA                                          SA0I 04437018
         OI    DECAREA+7,X'0F'                                     SA0I 04439018
         UNPK  PKARA(2),DECAREA(8)                                 SA0I 04441018
*******************************************************************SA0I 04443018
*                   MOVE COLUMN NUMBER INTO MESSAGE               *SA0I 04445018
*                  AND BRANCH TO PRINT ROUTINE                    *SA0I 04447018
*******************************************************************SA0I 04449018
         LR    R1,R2              MESSAGE NUMBER IN R1             SA0I 04451018
         LR    R3,R2              MESSAGE NUMBER IN R3             SA0I 04453018
         S     R3,THRE1   GET RELATIVE DISPLACEMENT FROM MSG31     SA0I 04455018
         M     R2,SEV2            MULTIPLY BY MESSAGE LENGTH       SA0I 04457018
         A     R3,MSGMOD          ADD LOAD ADDRESS OF MSG31        SA0I 04459018
         MVC   47(2,R3),PKARA     INSERT COLUMN NUMBER             SA0I 04461018
         L     R15,PRINCONS       LOAD PRINT ROUTINE ADDRESS       SA0I 04463018
         BALR  R14,R15            PRINT ERROR MESSAGE              SA0I 04465018
         B     BYPASCD            BRANCH TO SET ERROR SWITCHES     SA0I 04467018
ERRFRSCA MVC   MYPRTARE(120),BLANKS  CLEAR OUTPUT BUFFER         A27718 04475019
         MVC   MYPRTARE(18),IOERR  MOVE MSG. NO. INTO OUTPUT BUF A27718 04483019
         MVC   MYPRTARE+19(79),49(R1) MOVE I/O ERROR STATUS INTO A27718 04491019
*                                BY IEBCCS02 INTO OUTPUT BUFFER  A27718 04499019
         LA    R0,79               FREE 79 BYTES GOT BY          A27718 04507019
         FREEMAIN  R,LV=(0),A=(1)  SYSIN'S SYNADAF               A27718 04515019
         LA    R0,119                NO. OF BYTES TO BE PRINTED  A27718 04523019
         LA    R1,MYPRTARE           ADDRESS OF OUTPUT BUFFER    A27718 04531019
         L     R15,MYPRTCON          GET ADDR. OF PRINT ROUTINE  A27718 04539019
         BALR  R14,R15               GO TO PRINT MSG             A27718 04547019
         MVI   HICONCOD+1,X'0C'   RETURN CODE                      SA0I 04561018
         OI    ABORTSW,X'01'       TURN ON ABORT SW              A27718 04561619
         B     ENDOFANA            BRANCH TO WRAP UP ROUTINE     A27718 04562219
REPRTN   LA    R1,13              REPETITIOUS CARD INVALID         SA0I 04563018
         L     R15,PRINCONS       LOAD PRINT ROUTINE ADDRESS       SA0I 04564018
         BALR  R14,R15            BRANCH TO PRINT ERROR MESSAGE    SA0I 04565018
*******************************************************************SA0I 04566018
*        AN ERROR HAS BEEN FOUND-SET BYPASS SWITCH TO INFORM      *SA0I 04567018
*        CCS02 THAT THE REST OF THE CONTROL CARD NOW BEING        *SA0I 04568018
*        ANALYZED SHOULD BE IGNORED.                              *SA0I 04569018
*******************************************************************SA0I 04570018
BYPASCD  NI    CTLAREA+81,X'FC'   TURN OFF KEYWORD AND PARAMETER   SA0I*04571018
                                  REQUIRED BITS                    SA0I 04572018
         MVI   HICONCOD+1,X'0C'   SET RETURN CODE                  SA0I 04573018
         OI    CTLAREA,X'40'      TURN ON BYPASS CARD BIT          SA0I 04574018
         OI    ABORTSW,X'01'      TURN ON ABORT SWITCH             SA0I 04575018
         B     CALLSCAN           RETURN TO SCAN ROUTINE           SA0I 04576018
ENDOFANA LM    13,14,SAV13A14                                           04600000
         RETURN (2,12)                                                  04620000
BLKRTN   LA    PARMREG,30     INVALID BLKSIZE PARAMETER -PRINT MSG BS0H 04626017
         B     RTNOUT                   PRINT MESSAGE              BS0H 04633017
DDRTN    LA    1,29               COULD NOT OPEN SYSIN-PRINT MESSAGE    04640000
RTNOUT   L     R15,PRINCONS                                        BS0H 04660017
         BALR  14,15                                                    04680000
         LA    15,12              LOAD RETURN CODE OF '0C' IN REG15     04700000
         LM    13,14,SAVE1315                                           04720000
         RETURN (2,12)            COULD NOT OPEN SYSPRINT               04740000
*********************************************************************** 04760000
*                   CONSTANT AND WORK AREA                              04780000
PRINCONS DC    V(JPRINTRT)         ADDR OF ROUTINE TO SET UP PARAMETERS 04800000
*                                    FOR PRINT ROUTINE                  04820000
MYPRTCON DC    V(ZZPR)             ADDR OF PRINT ROUTINE                04840000
SAVANALR DS    18F                 REGISTER SAVE AREA                   04860000
SAV13A14 DS    2F                  SAVE AREA FOR REGS 13-14             04880000
DDJOSIN  DC    D'0'                SYSIN DDNAME FIELD FOR CD SCAN       04900000
SAVEREG0 DS    2F                  SAVE AREA FOR REGS O-1               04920000
EIGHT    DC    H'8'                                                     04940000
ONE      DC    H'1'                                                     04960000
CTLAREA  DS    145X                CARD IMAGE AREA-WORK AREA-LAST BYTE  04980000
*                                    IS SWITCH WHICH WHEN 01 INDICATES  05000000
*                                    INPUT ERROR FROM CD SCAN           05020000
FIRSTCOC DC    X'00'               SWITCH  00=COMPARE CTL CARD NOT READ 05040000
*                                          01=COMPARE CD READ           05060000
CDSW     DC    X'00'          SET TO X'01' IN COMPARE STMT ANALY   UL0H 05065017
*                                    X'02' IN EXITS STMT ANALY     UL0H 05070017
*                                    X'04' IN LABEL STMT ANALY     UL0H 05075017
KWORDSW  DC    X'00'              SWITCH  2 BIT KEYWORD=DATA       SA0I 05078018
*                                         3 BIT KEYWORD=PRECOMP    SA0I 05081018
*                                         4 BIT KEYWORD=ERROR      SA0I 05084018
*                                         5 BIT KEYWORD=INTLR      SA0I 05087018
*                                         6 BIT KEYWORD=INHDR      SA0I 05090018
*                                         7 BIT KEYWORD=TYPORG     SA0I 05093018
COMWORD1 DC    CL7'COMPARE'                                             05160000
COMWORD2 DC    CL5'EXITS'                                               05180000
COMWORD3 DC    CL6'LABELS'                                         SA0I 05190018
KEYWORD1 DC    CL6'TYPORG'                                              05200000
KEYWORD2 DC    CL5'INHDR'                                               05220000
KEYWORD3 DC    CL5'INTLR'                                               05240000
KEYWORD4 DC    CL5'ERROR'                                               05260000
KEYWORD5 DC    CL7'PRECOMP'                                             05280000
KEYWORD6 DC    CL4'DATA'                                           UL0H 05290017
PARWORD1 DC    CL2'PO'                                                  05300000
PARWORD2 DC    CL2'PS'                                                  05320000
DATA1    DC    CL2'NO'                                             UL0H 05324017
DATA2    DC    CL3'YES'                                            UL0H 05328017
DATA3    DC    CL4'ONLY'                                           UL0H 05332017
DATA4    DC    CL3'ALL'                                            UL0H 05336017
IOERR    DC    CL18'IEB267I I/O ERROR,'                          A27718 07336019
BLANKS   DC    X'40'                                             A27718 09336019
MYPRTARE DS    30F                                               A27718 11336019
DECAREA  DC    D'0'                                                SA0I 13336018
PKARA    DC    C'00'                                               SA0I 21336018
LABCD    DC    X'00'              LABEL CARD SWITCH                SA0I 29336018
TYPARA   DC    X'00'              TYPORG CARD SWITCH               SA0I 37336018
MSGMOD   DC    V(MSG31)           ADDR OF MESSAGE MODULE           SA0I 45336018
THRE1    DC    F'31'              CONSTANT 31                      SA0I 53336018
SEV2     DC    F'72'              CONSTANT 72                      SA0I 61336018
PARMSW   DC    X'00'              PARAMETER SW- SET TO '01' WHEN   SA0I 69336018
*                                 A PARAMETER HAS BEEN READ        SA0I 77336018
          END                                                           85336018
./  ADD  SSI=72290038,NAME=IEBCMAIN
*********************************************************************** 00020000
*                                                                     * 00040000
* NAME               *   *   *****   ***   *   *                      * 00060000
*                    ** **   *   *    *    **  *                      * 00080000
*                    * * *   *****    *    * * *                      * 00100000
*                    *   *   *   *    *    *  **                      * 00120000
*                    *   *   *   *   ***   *   *                      * 00140000
*                                                                     * 00160000
*********************************************************************** 00180000
*                                                                     * 00200000
* FUNCTION/OPERATION                                                  * 00220000
*                                                                     * 00240000
*      THIS IS THE MAIN PROCESSOR MODULE FOR THE DATA SET UTILITY     * 00260000
*   IEBCOMPR.  ITS MAIN FUNCTIONS ARE AS FOLLOWS:                     * 00280000
*                                                                     * 00300000
*      1.  SETS ITS ADDRESSABILITY WITH TWO BASE REGISTERS            * 00320000
*      2.  FINALIZES THE SYSUT1 AND SYSUT2 DCB'S FROM INFORMATION     * 00340000
*            PROVIDED BY THE PREVIOUS ROUTINES                        * 00360000
*      3.  OPENS THE TWO DATA SETS TO BE COMPARED- SYSUT1 AND SYSUT2  * 00380000
*      4.  IF SEQUENTIAL DATA SETS ARE BEING COMPARED, THIS MODULE    * 00400000
*            READS THE RECORDS AND MAKES THE COMPARISONS AT THE       * 00420000
*            LOGICAL RECORD LEVEL. IF DATA SETS ARE OF VS RECFM AND   * 00425017
*            WITH KEYS OR OF VS RECFM AND WITH RECORDS GREATER THAN   * 00430017
*            32756 BYTES LONG, THEN IT WILL MAKE COMPARISONS AT       * 00435017
*       PHYSICAL BLOCK LEVEL.                                         * 00440017
*            USER INPUT HEADER/TRAILER LABELS WILL BE COMPARED AS     * 00445017
*            DATA IF REQUESTED BY USER                                * 00450017
*      5.  IF PARTITIONED DATA SETS ARE BEING COMPARED, THE MODULE    * 00460000
*            READS THE PDS DIRECTORY AND SETS UP APPROPRIATE SWITCHES * 00480000
*            AND TABLES TO ALLOW IT TO OBTAIN THE DATA IN EACH MEMBER * 00500000
*            AFTER THE DIRECTORY COMPARISON HAS TAKEN PLACE.  AFTER   * 00520000
*            THE DIRECTORIES ARE COMPARED, THE MEMBERS OF THE DATA    * 00540000
*            SETS ARE COMPARED AT THE LOGICAL RECORD LEVEL.           * 00560000
*      6.  UPON FINDING ANY MISCOMPARES THIS MODULE SETS UP THE       * 00580000
*            APPROPRIATE MESSAGES AND CONVERTS THE NON-COMPARING      * 00600000
*            INFORMATION INTO PRINTABLE HEX                           * 00620000
*      7.  IS RESPONSIBLE FOR BRANCHING TO THE APPROPRIATE PRINT      * 00640000
*            ROUTINE                                                  * 00660000
*      8.  TERMINATING EXECUTION AFTER TEN CONSECUTIVE ERRORS IN A    * 00680000
*            SEQUENTIAL DATA SET, OR IF COMPARING A PDS, IT MUST      * 00700000
*            TERMINATE COMPARING OF A MEMBER AFTER TEN CONSECUTIVE    * 00720000
*            ERRORS IN THAT MEMBER                                    * 00740000
*      9.  LINKING TO THE USER PROVIDED EXIT ROUTINES                 * 00760000
*     10.  DETERMINING IF AND WHEN TO ABORT THE JOB                   * 00780000
*     11.  CLOSING THE SYSPRINT, SYSUT1, AND SYSUT2 DATA SETS UPON    * 00800000
*            EXIT                                                     * 00820000
*     12.  SETTING THE FINAL CONDITION CODE                           * 00840000
*     13.  RETURNING TO THE CALLING PROGRAM                           * 00860000
*                                                                     * 00880000
*********************************************************************** 00900000
         EJECT                                                          00920000
*********************************************************************** 00940000
*                                                                     * 00960000
* ENTRY POINTS                                                        * 00980000
*                                                                     * 01000000
*   1. 'MAIN'    THIS IS THE ENTRY POINT TO THE MAIN PROCESSOR FROM   * 01002017
*                ROOT SEGMENT.                                        * 01004017
*   2. 'COMPAR'  THIS IS THE ENTRY POINT TO THE SUBROUTINE WHICH      * 01006017
*                COMPARES RECORDS FROM INPUT DATA SETS                * 01008017
*   3. 'BEFNREND' THIS IS THE ENTRY POINT TO THE SUBROUTINE WHICH     * 01010017
*                INITIALIZE THE PROPER SWITCHES FOR USER INPUT TRAILER* 01012017
*                LABEL COMPARISON.                                    * 01014017
*   4. 'NORMEND' THIS IS THE ENTRY POINT TO THE SUBROUTINE WHICH      * 01016017
*                CLOSES THE DCBS, FREE GOTTEN STORAGE AND DELETE      * 01018017
*                USER EXIT ROUTINES WERE BROUGHT IN BY IEBCOMPR.      * 01020017
*   5. 'BLPRT'   THIS IS THE ENTRY POINT TO THE SUBROUTINE WHICH      * 01022017
*                CONVERTS THE NON-COMPARING INFORMATION TO PRINTABLE  * 01024017
*                HEX                                                  * 01026017
*                                                                     * 01040000
*********************************************************************** 01060000
*                                                                     * 01080000
* INPUT                                                               * 01100000
*                                                                     * 01120000
*      INPUT TO THIS MODULE IS TWOFOLD.  FIRST, IT MAKES USE OF THE   * 01140000
*    SWITCHES AND PARAMETER LISTS WHICH WERE SET UP BY THE ROOT       * 01160000
*    SEGMENT, COMPARE, AND BY ANALY, THE FIRT OVERLAY SEGMENT.  THIS  * 01180000
*    INFORMATION IS PASSED TO MAIN THROUGH THE COMMUNICATION REGION   * 01200000
*    IN THE ROOT SEGMENT.  THE OTHER SOURCE OF INPUT IS DATA ITSELF.  * 01220000
*    THIS DATA MAY RESIDE ON ANY STORAGE DEVICE AND MAY BE SEQUENTIAL,* 01240000
*    OR PARTITIONED.  OF COUSE ANY PARTITIONED DATA SET MAY ONLY      * 01260000
*    RESIDE ON A DIRECT ACCESS DEVICE.                                * 01280000
*                                                                     * 01300000
*********************************************************************** 01320000
*                                                                     * 01340000
* OUTPUT                                                              * 01360000
*                                                                     * 01380000
*      THE OUTPUT FROM THIS MODULE IS DIAGNOSTIC AND INFORMATIONAL    * 01400000
*    MESSAGES, AS WELL AS RECORDS WHICH MISCOMPARED DURING EXECUTION  * 01420000
*    OF THE PROGRAM.  IF THERE WERE EXTRA RECORDS ON EITHER DATA SET, * 01440000
*    OR,IF IN A PARTITIONED DATA SET, THE USER DATA WAS UNEQUAL THE   * 01460000
*    UNEQUAL RECORDS WILL ALSO BE PRINTED.                            * 01480000
*                                                                     * 01500000
*********************************************************************** 01520000
*                                                                     * 01540000
* EXTERNAL ROUTINES                                                   * 01560000
*                                                                     * 01580000
*     MAIN USES THE ROOT SEGMENT'S PRINT ROUTINES, ZZPR AND JPRINTRT, * 01600000
*   AS CLOSED SUBROUTINES.  LINKAGE TO THESE ROUTINES IS MADE BY      * 01620000
*   BRANCH AND LINK INSTRUCTIONS. MAIN ALSO USES IEBQSAM AS A CLOSED  * 01630017
*   SUBROUTINE TO RETRIEVE RECORDS OF VS TYPE. MAIN ALSO USES IEBCULET* 01640017
*   VIA DCBEXLST TO SAVE USER INPUT HEADER/TRAILER LABELS AND TO GIVE * 01650017
*   CONTROL TO USER INHDR/INTLR EXITS. IF USER HAS SPECIFIED AN 'EXIT * 01660017
*   ROUTINE, THE LINKAGE TO THIS ROUTINE IS MADE BY AN O/S 360 LINK   * 01670017
*   INSTRUCTION.                                                      * 01680017
*                                                                     * 01720000
*********************************************************************** 01740000
*                                                                     * 01760000
* EXITS                                                               * 01780000
*                                                                     * 01800000
*     THE ONLY EXIT MADE FROM MAIN IS A RETURN BACK TO THE CALLING    * 01820000
*   PROGRAM WHEN PROCESSING IS FINISHED.                              * 01840000
*                                                                     * 01860000
*********************************************************************** 01880000
         EJECT                                                          01900000
*********************************************************************** 01920000
*                                                                     * 01940000
* TABLES/WORK AREAS                                                   * 01960000
*                                                                     * 01980000
*     THERE IS ONE TABLE IN MAIN.  THIS IS A TRANSLATE TABLE USED     * 02000000
*   WHEN HEX DIGITS ARE BEING TRANSLATED TO PRINTABLE CHARACTERS.     * 02020000
*   THE SYMBOLIC NAME FOR THE START OF THE TABLE IS FCLIST.           * 02040000
*                                                                     * 02060000
*********************************************************************** 02080000
*                                                                     * 02100000
* ATTRIBUTES                                                          * 02120000
*                                                                     * 02140000
*     NON-REENTRANT AND NON-REUSEABLE                                 * 02160000
*                                                                     * 02180000
*********************************************************************** 02200000
         EJECT                                                          02220000
COMMX    DSECT                                                          02240000
         USING COMMX,10                                                 02260000
SAVE1315 DS    3F                  SAVE AREA FOR REGS 13,14, AND 15     02280000
SAVEREGS DS    18F                 MY REGISTER SAVE AREA                02300000
PARALIST DS    8F                  THE EXITS PARAMETER LIST-USER ROUTS  02320000
*                                    1. INHDR PARAMETER NAME            02340000
*                                    2. INTLR PARAMETER NAME            02360000
*                                    3. ERROR PARAMETER NAME            02380000
*                                    4. PRECOMP PARAMETER NAME          02400000
DDSYSIN  DS    2F                  SYSIN PARAMETER                      02420000
DDSUBNAM DS    4F                  DDNAME PARAMETER LIST                02440000
*                                    1. SYSUT1 DDNAME                   02460000
*                                    2. SYSUT2 DDNAME                   02480000
HICONCOD DS    2X                  RETURN CODE STORAGE AREA             02500000
CCADSORG DS    1X                  SET TO '01' IF PARTITIONED DATA SET  02520000
ABORTSW  DS    1X                  ABORT SWITCH - SET TO '01' IF ON     02540000
LABEL    DS    1X             SET TO X'00' IF DATA=YES             UL0H 02540517
*                                    X'01' IF DATA=NO              UL0H 02541017
*                                    X'10' IF DATA=ONLY            UL0H 02541517
*                                    X'20' IF DATA=ALL             UL0H 02542017
UEXIT    DS    1X             SET TO 01 IF OPEN TOOK USER LAB EXIT UL0H 02542517
UHRADR   DS    1F             CONTAIN ADDR. OF INHDR               UL0H 02543017
UTRADR   DS    1F             CONTAIN ADDR. OF INTLR               UL0H 02543517
INHD1    DS    1F             HAS ADDR. OF SYSUT1 HD LAB SAVE AREA UL0H 02544017
INHD2    DS    1F             HAS ADDR. OF SYSUT2 HD LAB SAVE AREA UL0H 02544517
INHDCT1  DS    1F             CONT. NO. OF HEADER LABELS FOR SYSUT1UL0H 02545017
INHDCT2  DS    1F             CONT. NO. OF HEADER LABELS FOR SYSUT2UL0H 02545517
INTL1    DS    1F             HAS ADDR. OF SYSUT1 TL LAB SAVE AREA UL0H 02546017
INTL2    DS    1F             HAS ADDR. OF SYSUT2 TL LAB SAVE AREA UL0H 02546517
INTLCT1  DS    1F             CONT. NO. OF TRAILER LABEL FOR SYSUT1UL0H 02547017
INTLCT2  DS    1F             CONT. NO. OF TRAILER LABEL FOR SYSUT2UL0H 02547517
BUFF1    DS    1F             CONTAIN ADDR. OF READ AREA-DS1       VS0H 02548017
BUFF2    DS    1F             CONTAIN ADDR. OF READ AREA-DS2       VS0H 02548517
LBUFF1   DS    1F             LENGTH OF BUFFER FOR SYSUT1 RCD PROC VS0H 02549017
LBUFF2   DS    1F             LENGTH OF BUFFER FOR SYSUT2 RCD PROC VS0H 02549517
LORECO   DS    1F             TOTAL LOGICAL RECORD COUNTER         VS0H 02550017
RECLTH   DS    1H             LOGICAL RECORD LENGTH-DS1            VS0H 02550517
RECLH2   DS    1H             LOGICAL RECORD LENGTH-DS2            VS0H 02551017
DSET1    DS    1F            ADDRS. OF SYSUT1 DCB IN IEBCQSAM      VS0H 02551517
DSET2    DS    1F            ADDRS. OF SYSUT2 DCB IN IEBCQSAM      VS0H 02552017
INPUTLOC DS    1F            ADDR. OF INPUT BUFFER FOR BLPRT RT    VS0H 02552517
NOEXTSW  DS    1X             NO EXIT TO USER LAB RTN IF SET TO 01 UL0H 02553017
TERMSW   DS    1X             TERM. AFTER LAB. PROC. IF SET TO 01  UL0H 02553517
EXIT1SW  DS    1X             SET TO 01 IF THERE IS AN USER INHDR  UL0H 02554017
EXIT3SW  DS    1X             SET TO 01 IF THERE IS AN USER INTLR  UL0H 02554517
VSSWT    DS    1X             SET TO 01 IF BSAM USED TO PROC VS RCDVS0H 02555017
*                             SET TO 02 IF QSAM USED TO PROC VS RCDVS0H 02555517
NOLB     DS    1X             SET TO 01 IF NO USER LABEL ON SYSUT1 UL0H 02556017
*                             SET TO 02 IF NO USER LABEL ON SYSUT2 UL0H 02556517
LABSW    DS    1X             SET TO 01; SYSUT1 HEADER LABEL PROC  UL0H 02557017
*                             SET TO 02; SYSUT2 HEADER LABEL PROC  UL0H 02557517
*                             SET TO 04; SYSUT2 TRAILER LABEL PROC UL0H 02558017
*                             SET TO 08; SYSUT2 TRAILER LABEL PROC UL0H 02558517
PRINTOUT DS    0F                  SYSPRINT DCB                         02560000
         SPACE 3                                                        02580000
*********************************************************************** 02600000
*                   THIS IS THE MAIN PROCESSING MODULE                * 02620000
*********************************************************************** 02640000
MAIN     CSECT                                                          02660000
* 038600-039200,053600-054200,103200,111400-111600,114800,       A26556 02662019
* 122200-131400,144000-144400,145000-147200,151400,154400-154800,A26556 02664019
* 156600-156800,157400,230200,231800                             A26556 02666019
* 164000,165800,172600,176600,181000-181200,190600-190800,200800 A27718 02668019
* 114800,114900,146600,146700                                    A37861 02668121
*                                                                A38747 02668221
*A037300,037320,043500,043520,047500,047200,085900,085920,       A41765 02668721
*A087500,087520,172360-172360-172399,172532-17266721,176360-     A41765 02668821
*A176399,176532-176667,2835402,047450,283900                     A41765 02668921
*D172200,172400,176200,176400                                    A41765 02670021
*A089105-089107                                                  A44317 02672621
*C089180,089560,158600,261400                                    A44317 02673021
*D158400                                                         A44317 02673121
*C060300-061100                                                  A48817 02673521
*A082300-082380                                                  A48817 02675221
*A203204                                                         A50947 02677221
*C089660,089668,089676,089696-089704                            OY01190 02677316
*C200680,200740                                                 OY01191 02677416
*3015                                                              9314 02677522
*2926091600,094400,250600,256000                                   SA0I 02679222
*C200680,200740                                                @YA02529 02680002
*A 169500,173700                                               @YM04833 02680402
*C 297563-297581                                               @YM04833 02680802
*D240600-240800,247800-248000,261800-262800                    @YA01671 02681002
*A232560-232568                                                @ZA10944 02681100
         ENTRY STARTP                                              VS0H 02681202
         ENTRY COMPAR                                              VS0H 02682622
         ENTRY BEFNREND                                            VS0H 02684322
         ENTRY NORMEND                                             VS0H 02686022
         ENTRY BLPRT                                               VS0H 02687722
R0       EQU   0                                                   UV0H 02689422
R1       EQU   1                                                   UV0H 02691122
R2       EQU   2                                                   UV0H 02692822
R3       EQU   3                                                   UV0H 02694522
R4       EQU   4                                                   UV0H 02696222
R5       EQU   5                                                   UV0H 02697922
R6       EQU   6                                                   UV0H 02699622
R7       EQU   7                                                   UV0H 02701322
R8       EQU   8                                                   UV0H 02703022
R9       EQU   9                                                   UV0H 02704722
R10      EQU   10                                                  UV0H 02706422
R11      EQU   11                                                  UV0H 02708122
R12      EQU   12                                                  UV0H 02709822
R13      EQU   13                                                  UV0H 02711522
R14      EQU   14                                                  UV0H 02713222
R15      EQU   15                                                  UV0H 02714922
         EXTRN DDERROR1            ALLOWS STORING OF DDNAME IN MESSAGE  02716622
         BALR  11,0                SET ADDRESSABILITY                   02718322
         USING STARTP,11,12                                             02720000
STARTP   L     12,ADCON1           SET ADDRESSABILITY FOR 8192 BYTES    02740000
         TM    ABORTSW,X'01'       IS ABORT SWITCH ON                   02760000
         BO    ABNOTER1              YES BRANCH                   48817 02780022
         LA    7,DASET1           LOAD DCB ADRESS                       02800000
         LA    8,DASET2           LOAD DCB ADRESS                       02820000
         CLI   DDSUBNAM,X'00'      IS THERE A DIFFERENT DDNAME FOR      02840000
*                                    SYSUT1                             02860000
         BE    TESTSUB2              NO BRANCH                          02880000
         MVC   DDNAMDCB(8,7),DDSUBNAM   MOVE DDNAME INTO DCB FOR SYSUT1 02900000
TESTSUB2 CLI   DDSUBNAM+8,X'00'    IS THERE A DIFFERENT DDNAME FOR      02920000
*                                    SYSUT2                             02940000
         BE    BEGIN1                NO BRANCH                          02960000
         MVC   DDNAMDCB(8,8),DDSUBNAM+8 MOVE DDNAME INTO DCB FOR SYSUT2 02980000
BEGIN1   MVC   NAMEDD1(8),DDNAMDCB(7)       MOVE DDNAME INTO AREA       03000000
         MVC   NAMEDD2(8),DDNAMDCB(8)       MOVE DDNAME INTO AREA       03020000
         MVC   PARATABL(32),PARALIST    MOVE EXITS PARAMETER LIST       03040000
*                                    (THESE ARE THE USER ROUTINES)      03060000
         EJECT                                                          03080000
*********************************************************************** 03100000
*        THIS SECTION SETS THE APPROPRIATE SWITCHES TO INDICATE       * 03120000
*        WHICH USER ROUTINES ARE PRESENT.                             * 03140000
*********************************************************************** 03160000
         CLI   PARALIST,X'40'      IS THERE AN INHDR ROUTINE            03180000
         BE    EX3TEST               NO BRANCH                          03200000
         MVI   EXIT1SW,1           SET INHDR SWITCH ON                  03220000
EX3TEST  CLI   PARALIST+8,X'40'    IS THERE AN OUTHDR ROUTINE           03240000
         BE    ERRTESTE              NO BRANCH                          03260000
         MVI   EXIT3SW,1           SET OUTHDR SWITCH ON                 03280000
ERRTESTE CLI   PARALIST+16,X'40'   IS THERE AN ERROR USER ROUTINE       03300000
         BE    PRETESTE              NO BRANCH                          03320000
         MVI   ERRORSW,1           SET ERROR USER SWITCH ON             03340000
PRETESTE CLI   PARALIST+24,X'40'   IS THERE A PRECOMP USER ROUTINE      03360000
         BE    JOESTA                NO BRANCH                          03380000
         MVI   PRECOMSW,1          SET PRECOMP USER SWITCH ON           03400000
JOESTA   TM    CCADSORG,1          ARE THE DATA SETS PARTITIONED        03420000
         BZ    STARTBSA              NO BRANCH                          03440000
         SPACE 3                                                        03460000
*********************************************************************** 03480000
*        THIS SECTION OF CODE OBTAINS AN AREA OF CORE STORAGE FOR     * 03500000
*        THE DIRECTORY OF THE SYSUT1 DATA SET. IT THEN DETERMINES     * 03520000
*        HOW MANY TRUE NAMES ARE IN THIS PDS AND OBTAINS STORAGE FOR  * 03540000
*        THESE NAMES. THE NAMES ARE USED LATER TO "FIND" THE MEMBERS  * 03560000
*        OF THE PDS.                                                  * 03580000
*********************************************************************** 03600000
         GETMAIN R,LV=256          FOR THE PDS DIRECTORY BLOCK          03620000
         ST    1,BUFF1             STORE ADDRESS OF 256 BYTE BUFFER     03640000
         OPEN  DASET1              OPEN FIRST DCB                       03660000
         LA    1,DASET1           LOAD DCB ADDRESS                      03680000
         TM    48(1),X'10'        WAS OPEN ACCOMPLISHED                 03700000
         BZ    NOTOPEN              NO-ABORT JOB                        03720000
         TM    ERRDCB,X'80'    BLKS,OR LRECL PARAMETER ZERO ?    A41765 03730021
         BO    ERRFMT          YES, PRINT MESS. IEB212I          A41765 03732021
DIRCORD  L     8,BUFF1             LOAD BUFFER ADDRESS                  03740000
         READ  DECBFT,SF,DASET1,(8),'S'                                 03760000
         CHECK DECBFT                                                   03780000
         LH    4,TWO               REG4 IS RELATIVE POINTER--HERE WE    03800000
*                                    INITIALIZE IT PAST FIRST TWO BYTES 03820000
*                                    OF BLOCKSIZE DATA IN PDS DIRECTORY 03840000
         CLC   0(2,8),TWOFS+2     IS DIRECTORY BLOCK GREATER     A26556 03850019
*                                  THAN 256                      A26556 03860019
         BH    ERR2                YES, BRANCH                   A26556 03870019
         CLC   0(2,8),F14         IS DIRECTORY BLOCK LESS THAN   A26556 03880019
*                                  14                            A26556 03890019
         BL    ERR2                YES, BRANCH                   A26556 03900019
         MVC   BLKLTH1(2),0(8)     STORE BLOCKSIZE IN SAVE AREA         03940000
FINUPBLK L     8,BUFF1             LOAD READING BUFFER ADDRESS          03960000
         AR    8,4                 REG8 NOW POINTS TO MEMBER NAME       03980000
         CLC   0(8,8),ALLFS        IS THIS NAME THE LAST IN DIRECTORY   04000000
         BE    ENDDIRCO              YES BRANCH                         04020000
         TM    11(8),128           IS THIS NAME A TRUE NAME             04040000
         BO    DONTADD               NO BRANCH                          04060000
         L     5,NOOFTN            WAS TRUE NAME, THUS ADD 1 TO TRUE    04080000
         LA    5,1(5)                NAME COUNTER                       04100000
         ST    5,NOOFTN                                                 04120000
DONTADD  LH    5,10(8)             INCREMENT REG. 4 BY NUMBER           04140000
         N     5,MASK1               OF BYTES                           04160000
         AR    5,5                     OF USER                          04180000
         AR    4,5                       DATA.                          04200000
         AH    4,TWELVE            ADD LENGTH OF NAME + TTRC (12)       04220000
         CH    4,BLKLTH1           HAS BLOCK BEEN COMPLETED             04240000
         BL    FINUPBLK              NO BRANCH                          04260000
         B     DIRCORD               YES-GO GET ANOTHER PDS BLOCK       04280000
ENDDIRCO CLOSE (DASET1,REREAD)     CLOSE FOR DIRECTORY BLOCK READS      04300000
         L     0,NOOFTN            LOAD NUMBER OF TRUE NAMES IN PDS     04320000
*                                    DIRECTORY BLOCKS FOR SYSUT1        04340000
         LTR   R0,R0           IS LENGTH EQ ZERO ?               A41765 04350021
         BC    8,BOSETTNM      YES,PRINT ERR. MESS. IEB210I      A41765 04352021
         SLL   0,3                 MULTIPLY BY 8                        04360000
         GETMAIN R,LV=(0)          FOR MEMBER NAMES                     04380000
         ST    1,TNSET             STORE ADDRESS FOR TABLE              04400000
         L     0,NOOFTN            LOAD NUMBER OF TRUE NAMES IN PDS     04420000
         MH    0,TWELVE            MULTIPLY BY 12                       04440000
         GETMAIN R,LV=(0)          FOR TTRN'S OF EACH MEMBER (PDS#1)    04460000
         ST    1,TTRSET1           STORE ADDRESS OF TABLE               04480000
         L     0,NOOFTN            LOAD NUMBER OF TRUE NAMES IN PDS     04500000
         MH    0,TWELVE            MULTIPLY BY 12                       04520000
         GETMAIN R,LV=(0)          FOR TTRN'S OF EACH MEMBER (PDS#2)    04540000
         ST    1,TTRSET2           STORE ADDRESS OF TABLE               04560000
         SPACE 3                                                        04580000
*********************************************************************** 04600000
*        THIS SECTION OF CODE OPENS BOTH DATA SETS, AND READS THE PDS * 04620000
*        DIRECTORIES. IT THEN COMPARES THE DIRECTORIES AND THEIR USER * 04640000
*        DATA AND PRINTS THE APPROPRIATE MESSAGES.                    * 04660000
*********************************************************************** 04680000
         OPEN  DASET2              OPEN SYSUT2 DCB                      04700000
         LA    1,DASET2           LOAD DCB ADDRESS                      04720000
         TM    48(1),X'10'        WAS OPEN ACCOMPLISHED                 04740000
         BZ    NOTOPEN             NO, END JOB                   A41765 04745021
         TM    ERRDCB,X'80'    BLKS,OR LRECL PARAMETER ZERO ?    A41765 04750021
         BO    ERRFMT          YES, PRINT MESS. IEB212I          A41765 04752021
         OPEN  DASET1              OPEN SYSUT1 DCB                      04780000
         LA    1,DASET1           LOAD DCB ADDRESS                      04800000
         TM    48(1),X'10'        WAS OPEN ACCOMPLISHED                 04820000
         BZ    NOTOPEN              NO-ABORT JOB                        04840000
         SR    2,2                 ZERO REG2 FOR INITIALIZATION         04860000
         SR    3,3                 ZERO REG3 FOR INITIALIZATION         04880000
         GETMAIN R,LV=256          FOR SYSUT2 BUFFER                    04900000
         ST    1,BUFF2             STORE ADDRESS OF SYSUT2 BUFFER       04920000
DIRBUFF1 TM    BUFSW1,1            SHOULD ANOTHER BLOCK  BE READ FROM   04940000
         BZ    DIRBUFF2              DATA SET 1. NO-GO TO DIRBUFF2      04960000
         L     8,BUFF1             LOAD SYSUT1 BUFFER ADDRESS           04980000
         READ  DECB1,SF,DASET1,(8),'S'                                  05000000
         CHECK DECB1                                                    05020000
         MVI   BUFSW1,0            SET SWITCH - BUFFER 1 NOT EMPTY      05040000
         LH    4,TWO               INITIALIZE REG4 AS A RELATIVE PTR.   05060000
*                                    THIS PTR IS INITIALIZED PAST THE   05080000
*                                    BLOCKSIZE FIELD OF THE PDS         05100000
*                                    DIRECTORY                          05120000
         MVC   BLKLTH1(2),0(8)     STORE BLOCKSIZE IN SAVE AREA         05140000
DIRBUFF2 TM    BUFSW2,1            SHOULD ANOTHER BLOCK  BE READ FROM   05160000
         BZ    PRENAMCO              DATA SET 2.  NO-GO TO PRENAMCO     05180000
         L     8,BUFF2             LOAD SYSUT2 BUFFER ADDRESS           05200000
         READ  DECB2,SF,DASET2,(8),'S'                                  05220000
         CHECK DECB2                                                    05240000
         MVI   BUFSW2,0            SET SWITCH - BUFFER 2 NOT EMPTY      05260000
         LH    6,TWO               INITIALIZE REG6 AS A RELATIVE PTR.   05280000
*                                    THIS PTR IS INITIALIZED PAST THE   05300000
*                                    BLOCKSIZE FIELD OF THE PDS         05320000
*                                    DIRECTORY                          05340000
         CLC   0(2,8),TWOFS+2     IS DIRECTORY BLOCK GREATER     A26556 05350019
*                                  THAN 256                      A26556 05360019
         BH    ERR2                YES, BRANCH                   A26556 05370019
         CLC   0(2,8),F14         IS DIRECTORY BLOCK LESS THAN   A26556 05380019
*                                  14                            A26556 05390019
         BL    ERR2                YES, BRANCH                   A26556 05400019
         MVC   BLKLTH2(2),0(8)     STORE BLOCKSIZE IN SAVE AREA         05440000
PRENAMCO L     7,BUFF1             PLACE NUMBER OF                      05460000
         AR    7,4                   BYTES OF USER                      05480000
         IC    15,11(7)            INSERT THE 'C' CHAR OF TTRC          05500000
         N     15,MASK2            MASK OUT ALL BUT BITS 1&2 OF C FIELD 05520000
         SRL   15,3                GET LENGTH OF TTRZ'S IN REG 15       05540000
         STH   15,TTRLTH           STORE IN SAVE AREA                   05560000
         LH    5,10(7)                 DATA IN REGISTER 5               05580000
         N     5,MASK1                   AND IN                         05600000
         AR    5,5                         USERDAL.                     05620000
         STH   5,USERDAL                                                05640000
         L     7,BUFF2                                                  05660000
         AR    7,6                                                      05680000
         IC    15,11(7)            INSERT THE 'C' CHAR OF TTRC          05700000
         N     15,MASK2            MASK OUT ALL BUT BITS 1&2 OF C FIELD 05720000
         SRL   15,3                GET LENGTH OF TTRZ'S IN REG 15       05740000
         STH   15,TTRLTH2          STORE IN SAVE AREA                   05760000
         LH    5,10(7)                                                  05780000
         N     5,MASK1                                                  05800000
         AR    5,5                                                      05820000
         STH   5,USERDAL2                                               05840000
NAMECOMP L     8,BUFF1                                                  05860000
         AR    8,4                                                      05880000
         L     9,BUFF2                                                  05900000
         AR    9,6                                                      05920000
         CLC   0(8,8),0(9)         COMPARE MEMBER NAMES                 05940000
         BL    LOGNAME1            NAME MISSING FROM DATA SET 2.        05960000
         BH    LOGNAME2            NAME MISSING FROM DATA SET 1.        05980000
         CLC   0(8,8),ALLFS                                             06000000
         BE    AFTDIRCO                                                 06020000
         TM    11(8),X'80'              TEST ALIAS OR TRUE NAME  A48817 06030021
         BO    ALIACOMP                 TEST IF SECOND IS ALIAS  A48817 06030421
         TM    11(9),X'80'              TEST ALIAS OR TRUE NAME  A48817 06030821
         BZ    STORNAME                 BOTH TRUE NAMES          A48817 06031221
         B     ALIAMEMB                 NO,COMPARE AS USER DATA  A48817 06032021
ALIACOMP TM    11(9),X'80'              IS ENTRY ON SYSUT1 ALIAS A48817 06040021
         BO    RESET7                   BOTH ALIAS NAMES         A48817 06100021
         B     ALIAMEMB                 NO,COMPARE AS USER DATA  A48817 06110021
STORNAME L     8,TNSET                                                  06120000
         AR    8,2                 STORE NAME IN                        06140000
         L     9,BUFF1               LIST OF                            06160000
         AR    9,4                     TRUE                             06180000
         MVC   0(8,8),0(9)               NAMES.                         06200000
         AH    2,EIGHT                                                  06220000
         LH    7,TTRLTH                                                 06240000
         LTR   7,7                 DETERMINE WHICH TTR'S IN USER DATA   06260000
         BZ    RESET7                POINT TO NOTE LISTS. STORE THOSE   06280000
         L     9,BUFF1               1 (TTRSET1). STORE THE CORRESPOND- 06300000
         AR    9,4                   ING TTR'S FROM DATA SET 2 IN       06320000
         TM    15(9),255             TTRSET2.                           06340000
         BZ    SECTTR                                                   06360000
         L     8,TTRSET1                                                06380000
         AR    8,3                                                      06400000
         MVC   0(3,8),12(9)                                             06420000
         MVI   3(8),0                                                   06440000
         L     8,TTRSET2                                                06460000
         AR    8,3                                                      06480000
         L     9,BUFF2                                                  06500000
         AR    9,6                                                      06520000
         MVC   0(3,8),12(9)                                             06540000
         MVI   3(8),0                                                   06560000
         AH    3,FOUR                                                   06580000
SECTTR   SH    7,FOUR                                                   06600000
         LTR   7,7                                                      06620000
         BZ    RESET7                                                   06640000
         L     9,BUFF1                                                  06660000
         AR    9,4                                                      06680000
         TM    19(9),255                                                06700000
         BZ    THIRDTTR                                                 06720000
         L     8,TTRSET1                                                06740000
         AR    8,3                                                      06760000
         MVC   0(3,8),16(9)                                             06780000
         MVI   3(8),0                                                   06800000
         L     8,TTRSET2                                                06820000
         AR    8,3                                                      06840000
         L     9,BUFF2                                                  06860000
         AR    9,6                                                      06880000
         MVC   0(3,8),16(9)                                             06900000
         MVI   3(8),0                                                   06920000
         AH    3,FOUR                                                   06940000
THIRDTTR SH    7,FOUR                                                   06960000
         LTR   7,7                                                      06980000
         BZ    RESET7                                                   07000000
         L     9,BUFF1                                                  07020000
         AR    9,4                                                      07040000
         TM    23(9),255                                                07060000
         BZ    RESET7                                                   07080000
         L     8,TTRSET1                                                07100000
         AR    8,3                                                      07120000
         MVC   0(3,8),20(9)                                             07140000
         MVI   3(8),0                                                   07160000
         L     8,TTRSET2                                                07180000
         AR    8,3                                                      07200000
         L     9,BUFF2                                                  07220000
         AR    9,6                                                      07240000
         MVC   0(3,8),20(9)                                             07260000
         MVI   3(8),0                                                   07280000
         AH    3,FOUR              END OF STORING OF TTR'S.             07300000
RESET7   CLC   USERDAL+1(1),USERDAL2+1  ARE USER DATA LENGTHS EQUAL     07320000
         BNE   ERRCOMUD                   NO BRANCH                     07340000
         CLI   USERDAL+1,X'00'          IS USER DATA LENGTH ZERO        07360000
         BZ    RETERRCU              NO BYTES TO BE COMPARED            07380000
         L     8,BUFF1                                                  07400000
         AR    8,4                                                      07420000
*                                                                       07440000
         L     9,BUFF2                                                  07460000
         AR    9,6                                                      07480000
         SH    5,ONE                                                    07500000
         STC   5,COMPDAT+1                                              07520000
COMPDAT  CLC   12(1,8),12(9)       COMPARE USER DATA.                   07540000
         BNE   ERRCOMUD                                                 07560000
RETERRCU AH    4,TWELVE                                                 07580000
         AH    4,USERDAL                                                07600000
         CH    4,BLKLTH1           DOES BUFFER 1 NEED MORE RECORDS.     07620000
         BL    DIRBUF2S              NO                                 07640000
         MVI   BUFSW1,1              YES - SET BUFSW1                   07660000
DIRBUF2S AH    6,TWELVE                                                 07680000
         AH    6,USERDAL2                                               07700000
         CH    6,BLKLTH2           DOES BUFFER 2 NEED MORE RECORDS.     07720000
         BL    DIRBUFF1              NO                                 07740000
         MVI   BUFSW2,1              YES - SET BUFSW2                   07760000
         B     DIRBUFF1                                                 07780000
ADCON1   DC    A(STARTP+4096)                                           07800000
LOGNAME1 L     8,BUFF1                                                  07820000
         AR    8,4                                                      07840000
         TM    11(8),128           IS MISSING NAME AN ALIAS.            07860000
         BO    PRNAL1                YES                                07880000
         LH    8,ONE                 NO - SET SWITCH - TRUE NAME        07900000
         STC   8,TNMIS2SW                 MISSING FROM SET 2.           07920000
         B     PRNTN1                                                   07940000
RETFRPR1 AH    4,TWELVE                                                 07960000
         AH    4,USERDAL                                                07980000
         CH    4,BLKLTH1           DOES BUFFER 1 NEED MORE RECORDS.     08000000
         BL    DIRBUFF1              NO                                 08020000
         LH    8,ONE                 YES - SET BUFSW1                   08040000
         STC   8,BUFSW1                                                 08060000
         B     DIRBUFF1                                                 08080000
LOGNAME2 L     8,BUFF2                                                  08100000
         AR    8,6                                                      08120000
         TM    11(8),128           IS MISSING NAME AN ALIAS.            08140000
         BO    PRNAL2                YES                                08160000
         LH    8,ONE                 NO - SET SWITCH - TRUE NAME        08180000
         STC   8,TNMIS1SW                 MISSING FROM SET 1.           08200000
         B     PRNTN2                                                   08220000
ALIAMEMB LA    R1,3                     LOAD MESSAGE NUMBER      A48817 08230021
         L     R15,PRINCONS             LOAD PRINT ROUTINE       A48817 08232021
         BALR  R14,R15                  GO TO PRINT ROUTINE      A48817 08234021
         MVI   HICONCOD+1,X'08'         SET RETURN CODE TO EIGHT A48817 08236021
         MVC   MYPRTARE(120),BLANKS     CLEAR PRINT BUFFER       A48817 08236421
         MVC   MYPRTARE+10(14),MEMRNAME SET MEMBER NAME =        A48817 08236821
         MVC   MYPRTARE+24(8),0(8)      MOVE IN MEMBER/ALIAS NAMEA48817 08237221
         LA    R0,119                   PRINT LINE               A48817 08237621
         LA    R1,MYPRTARE              PRINT LINE               A48817 08237721
         L     R15,MYPRTCON             PRINT LINE               A48817 08237821
         BALR  R14,R15                  PRINT LINE               A48817 08237921
         B     RESET7                   CHECK IF USER DATA EQUAL A48817 08238021
AFTDIRCO TM    TNMIS1SW,1                                               08240000
         BO    TESSW2TN                                                 08260000
         TM    TNMIS2SW,1                                               08280000
         BZ    TABLE1                                                   08300000
         MVI   TABLE2SW,1                                               08320000
         B     NEXTSTEP                                                 08340000
TESSW2TN TM    TNMIS2SW,1                                               08360000
         BO    BOSETTNM                                                 08380000
TABLE1   MVI   TABLE1SW,1                                               08400000
NEXTSTEP ST    2,TNTABLEL                                               08420000
         ST    3,TTRTABLL                                               08440000
         CLOSE (DASET1,REREAD,DASET2,REREAD)                            08460000
         FREEMAIN R,LV=256,A=BUFF1                                      08480000
         XC    BUFF1(4),BUFF1      CLEAR OUT BUFF1               A26556 08490019
         FREEMAIN R,LV=256,A=BUFF2                                      08500000
         XC    BUFF2(4),BUFF2      CLEAR OUT BUFF2               A26556 08501019
         B     OPEN1                                               UL0H 08503017
ERR2     LA    R1,2                                              A26556 08503619
         B     ABNOTERM                                          A26556 08505419
STARTBSA MVI   DCALBLX1,X'05'      ACTIVATE USER INPUT HEADER AND  UL0H 08506017
         MVI   DCALBLX2,X'05'      TRAILER LABEL EXITS             UL0H 08509017
         TM    EXIT1SW,X'01'       IS THERE AN INHDR               UL0H 08512017
         BZ    UTEXIT              NO                              UL0H 08515017
         LOAD  EPLOC=PARALIST      YES, LOAD USER INHDR            UL0H 08518017
         ST    R0,UHRADR           ST MAIN STORAGE ADDR OF INHDR   UL0H 08521017
UTEXIT   TM    EXIT3SW,X'01'       IS THERE AN INTLR               UL0H 08524017
         BZ    OPEN1               NO                              UL0H 08527017
         LOAD  EPLOC=PARALIST+8    YES, LOAD USER INTLR            UL0H 08530017
         ST    R0,UTRADR                                           UL0H 08533017
OPEN1    OPEN  DASET1         OPEN SYSUT1 DCB                      UL0H 08536017
         LA    1,DASET1           LOAD DCB ADDRESS                      08540000
         TM    48(1),X'10'        WAS OPEN ACCOMPLISHED                 08560000
         BZ    NOTOPEN              NO-ABORT JOB                        08580000
         TM    ERRDCB,X'80'    BLKS,OR LRECL PARAMETER ZERO ?    A41765 08590021
         BO    ERRFMT          YES, PRINT MESS. IEB212I          A41765 08592021
         MVC   RECLTH(2),LRECLDCB(1)   MOVE LOGICAL RECORD LENGTH       08600000
         TM    DEVTDCB(1),X'20'   IS THIS A D. A. DEVICE                08620000
         BZ    OP1                  NO BRANCH                           08640000
         MVC   KEYLTH(1),KEYLEDCB(1)   MOVE KEY LENGTH INTO SAVE AREA   08660000
OP1      OPEN  DASET2             OPEN SYSUT2                           08680000
         LA    1,DASET2           LOAD DCB ADDRESS                      08700000
         TM    48(1),X'10'        WAS OPEN ACCOMPLISHED                 08720000
         BZ    NOTOPEN              NO-ABORT JOB                        08740000
         TM    ERRDCB,X'80'    BLKS,OR LRECL PARAMETER ZERO ?    A41765 08750021
         BO    ERRFMT          YES, PRINT MESS. IEB212I          A41765 08752021
         MVC   RECLH2(2),LRECLDCB(1)   MOVE LOGICAL RECORD LENGTH       08760000
         TM    DEVTDCB(1),X'20'   IS THIS A D. A. DEVICE                08780000
         BZ    OP2                  NO BRANCH                           08800000
         MVC   DCBKL2(1),KEYLEDCB(1)   MOVE KEY LENGTH INTO SAVE AREA   08820000
OP2      MVI   BUFSW1,1           SET BUFSW1 AND BUFSW2 = 1 SO THEY     08840000
         MVI   BUFSW2,1              ARE CONSIDERED EMPTY               08860000
* COORDINATION OF INPUT DATA SETS AND SWITCH SETTING                    08880000
         TM    CCADSORG,1     PO DATA SET                          UL0H 08880117
         BO    SDSOBEG        YES, BRANCH                          UL0H 08880217
         TM    UEXIT,X'03'     IS LABEL EXIT TAKEN FOR BOTH DS     UL0H 08880317
         BO    HLABPROC        YES, BRANCH                         UL0H 08880417
         BZ    SDSOBEG         NO, BRANCH                          UL0H 08880517
         TM    LABEL,X'01'     DIS USER REP COMPARE LABELS         UL0H 08880617
         BO    SDSOBEG         NO, BRANCH                          UL0H 08880717
         LA    R1,58           YES, BUT ONE DS DID NOT TAKE EXIT   UL0H 08880817
         B     ABNOTERM        GO TO TERM. THE PROCESS             UL0H 08881117
*********************************************************************** 08882017
*        INITIALIZATION FOR USER INPUT HEADER LABEL COMPARISON.       * 08882417
*********************************************************************** 08882817
HLABPROC MVI   LBSW,X'00'     SET SW TO IND. WILL GO FOR INPUT HD  UL0H 08883217
*                             LABEL COMPARISON.                    UL0H 08883617
         MVC   CTR1(4),INHDCT1 SET CTR1 EQ NO. OF INPUT HEADER LAB UL0H 08884017
*                              PROCESSED FOR SYSUT1                UL0H 08884417
         MVC   CTR2(4),INHDCT2 SET CTR2 EQ NO. OF INPUT HEADER LAB UL0H 08884817
*                              PROCESSED FOR SYSUT2                UL0H 08885217
         MVC   SAREA1(4),INHD1 SAREA1 HAS ADDR OF SYSUT1 INPUT HD  UL0H 08885617
*                              SAVE AREA                           UL0H 08886017
         MVC   SAREA2(4),INHD2 SAREA2 HAS ADDR OF SYSUT2 INPUT HD  UL0H 08886417
         MVC   LABMSG1+6(7),HD  INITIALIZE MESSAGE                 UL0H 08886817
         BAL   R9,LABPROC      GO TO COMPARE THE LABEL             UL0H 08887217
         B     CKVRE          BRANCH                               UL0H 08887617
*********************************************************************** 08888017
*        THIS SECTION OF CODE WILL COMPARE USER INPUT HEADER OR       * 08888417
*        TRAILER LABELS.                                              * 08888817
*              CTR1=NO. OF INPUT HEADER OR TRAILER LAB PROC FOR SYSUT1* 08889217
*              CTR2=NO. OF INPUT HEADER OR TRAILER LAB PROC FOR SYSUT2* 08889617
*              SAREA1= ADDR OF INPUT HD OR TL LAB SAVEAREA FOR SYSUT1 * 08890017
*              SAREA2= ADDR OF INPUT HD OR TL LAB SAVEAREA FOR SYSUT2 * 08890417
*              LBSW PRESET TO X'00' FOR HEADER LABEL COMPARISON       * 08890817
*                             X'01' FOR TRAILER LABEL COMPARISON      * 08891217
*********************************************************************** 08891617
LABPROC  ST    R9,SAVE9                                            UL0H 08892017
         TM    LABEL,X'01'    IS DATA=NO                           UL0H 08892417
         BO    FTEST          YES, BRANCH                          UL0H 08892817
         B     ANYLAB         BRANCH                               UL0H 08893217
FTEST    CLI   LBSW,X'00'     IS IN HEADER LABEL PROCESSING        UL0H 08893617
         BNE   FTEST1         NO, BRANCH                           UL0H 08894017
         TM    EXIT1SW,X'01'  IS THERE AN USER INHDR               UL0H 08894417
         BZ    GOBACK1        NO,BRANCH                            UL0H 08894817
         B     ANYLAB         BRANCH                               UL0H 08895217
FTEST1   TM    EXIT3SW,X'01'  IS THERE AN USER INTLR               UL0H 08895617
         BZ    GOBACK1        NO,BRANCH                            UL0H 08896017
ANYLAB   TM    NOLB,X'01'     IS THERE ANY USER LABEL ON SYSUT1    UL0H 08896417
*                              SAVE AREA                           UL0H 08896817
         BO    NOLAB1         BRANCH IF NO USER LABEL ON SYSUT1    UL0H 08897217
         TM    NOLB,X'02'     IS THERE ANY USER LABEL ON SYSUT2    UL0H 08897617
         BO    NOLAB2         BRANCH IF NO USER LABEL ON SYSUT2    UL0H 08898017
         TM    LABEL,X'01'    IS DATA=NO                           UL0H 08898417
         BO    CKTERM         YES, BRANCH                          UL0H 08898817
         TM    LABEL,X'30'    IS DATA=ALL OR DATA=ONLY             UL0H 08899217
         BM    LCOMP          YES, BRANCH                          UL0H 08899617
TTERM    TM    TERMSW,X'01'   DID USER LAB RTN REQ TERMINATION     UL0H 08900017
         BO    USREQTE1       YES,BRANCH                           UL0H 08900417
LCOMP    SR    R5,R5          CLEAR REG5                           UL0H 08900817
         L     R2,SAREA1      REG2 HAS SYSUT1 USER LABEL SAVEAREA  UL0H 08901217
         L     R3,SAREA2      REG3 HAS SYSUT2 USER LABEL SAVEAREA  UL0H 08901617
ATCOMP   CLC   0(80,R2),0(R3) COMPR CORRESP. LABEL FROM BOTH DS    UL0H 08902017
         BE    BUMPTR         IF EQ. GO BUMP THE POINTERS          UL0H 08902417
         BAL   R4,UNEQLAB     IF UNEQ, GO PRINT MSG AND LABELS     UL0H 08902817
BUMPTR   LA    R5,1(R5)       BUMP CTR OF THE LABELS COMPARED      UL0H 08903217
         C     R5,CTR1        ANY LABEL LEFT FROM SYSUT1           UL0H 08903617
         BE    END1           NO LABEL LEFT FROM SYSUT1            UL0H 08904017
         C     R5,CTR2        ANY LABEL LEFT FROM SYSUT2           UL0H 08904417
         BE    PPRT1          NO LABEL LEFT FROM SYSUT2            UL0H 08904817
         A     R2,EIGHTY           REG2 PT TO NEXT LABEL TO BE COMPUL0H 08905217
         A     R3,EIGHTY           REG3 PT TP NEXT LABEL TO BE COMPUL0H 08905617
         B     ATCOMP         GO COMPARE THEM                      UL0H 08906017
*                                                                  UL0H 08906417
*        SYSUT1 HAS NO LABEL LEFT TO BE COMPARED                   UL0H 08906817
END1     C     R5,CTR2        ANY LABEL LEFT FROM SYSUT2           UL0H 08907217
         BE    END            NO LABEL LEFT FROM SYSUT2            UL0H 08907617
PPRT2    TM    LBSW,X'01'     IN TRAILER LABEL COMPARING           UL0H 08908017
         BO    ET2            YES,BRANCH                           UL0H 08908417
         LA    R1,32          NO,EXTRA INPUT HEADER LABEL ON SYSUT2UL0H 08908817
         B     PRINT2         BRANCH                               UL0H 08909217
ET2      LA    R1,34          EXTRA INPUT TRAILER LABEL ON SYSUT2  UL0H 08909617
PRINT2   L     R15,PRINCONS                                        UL0H 08910017
         BALR  R14,R15        PRINT MSG                            UL0H 08910417
         CLI   HICONCOD+1,X'08'         ALREADY RETURN CODE OF 8 A44317 08910521
         BH    PRT2                     RETURN CODE MORE THAN 8  A44317 08910621
         MVI   HICONCOD+1,X'08'         SET RETURN CODE TO 8     A44317 08910721
PRT2     A     R3,EIGHTY      REG3 PT TO THE EXTRA LABEL ON SYSUT2 UL0H 08910817
         LR    R1,R3                                               UL0H 08911217
         LA    R0,79                                               UL0H 08911617
         L     R15,MYPRTCON   GO TO ZZPR TO PRINT THE EXTRA LABEL  UL0H 08912017
         BALR  R14,R15             PRINT                           UL0H 08912417
         LA    R5,1(R5)       BUMP CTR OF LABELS PROCESSED         UL0H 08912817
         C     R5,CTR2        ANY LABEL LEFT FROM SYSUT2           UL0H 08913217
         BL    PRT2           YES, GO PRINT THEM                   UL0H 08913617
         B     CKTERM         BRANCH                               UL0H 08914017
*                                                                  UL0H 08914417
*        SYSUT2 HAS NO LABELS LEFT TO BE COMPARED                  UL0H 08914817
PPRT1    TM    LBSW,X'01'     IN TRAILER LABEL COMPARISON          UL0H 08915217
         BO    ET1            YES,BRANCH                           UL0H 08915617
         LA    R1,31          EXTRA INPUT HEADER LAB ON SYSUT1 MSG UL0H 08916017
         B     PRINT1         BRANCH                               UL0H 08916417
ET1      LA    R1,33          EXTRA INPUS TRAILER LAB ON SYSUT1 MSGUL0H 08916817
PRINT1   L     R15,PRINCONS                                        UL0H 08917217
         BALR  R14,R15        BRANCH                               UL0H 08917617
         CLI   HICONCOD+1,X'08'    IS HIGHEST RET. CODE EQ 8     A44317 08918021
         BH    PRT1           BRANCH IF HIGHER THAN 8              UL0H 08918417
         MVI   HICONCOD+1,X'08'                                    UL0H 08918817
PRT1     A     R2,EIGHTY      REG2 PT TO THE EXTRA LABEL ON SYSUT1 UL0H 08919217
         LR    R1,R2                                               UL0H 08919617
         LA    R0,79                                               UL0H 08920017
         L     R15,MYPRTCON   GO TO ZZPR TO PRINT THE EXTRA LABEL  UL0H 08920417
         BALR  R14,R15        BRANCH                               UL0H 08920817
         LA    R5,1(R5)       BUMP CTR OF LABELS PROCESSED         UL0H 08921217
         C     R5,CTR1        ANY LABEL LEFT FROM SYSUT1           UL0H 08921617
         BL    PRT1           YES, GO PRINT THEM                   UL0H 08922017
         B     CKTERM         BRANCH                               UL0H 08922417
*                                                                       08922817
UNEQLAB  TM    LBSW,X'01'     IN TRAILER LABEL COMPARISON          UL0H 08923217
         BO    TUNEQ          YES, BRANCH                          UL0H 08923617
         LA    R1,41          CORRESP. INHD LABEL UNEQUAL MSG      UL0H 08924017
         B     PT             BRANCH                               UL0H 08924417
TUNEQ    LA    R1,42          CORRESP. INTL LABEL UNEQUAL MSG      UL0H 08924817
PT       L     R15,PRINCONS                                        UL0H 08925217
         BALR  R14,R15             PRINT                           UL0H 08925617
         CLI   HICONCOD+1,X'08'    IS HIGHEST RET. CODE EQ 8       UL0H 08926017
         BH    PRTLAB              BRANH IF HIGHER                 UL0H 08926417
         MVI   HICONCOD+1,X'08'                                    UL0H 08926817
PRTLAB   LR    R1,R2               PRINT UNEQUAL LABEL FROM SYSUT1 UL0H 08927217
         LA    R0,79                                               UL0H 08927617
         L     R15,MYPRTCON                                        UL0H 08928017
         BALR  R14,R15             PRINT                           UL0H 08928417
         LR    R1,R3          PRINT UNEQ LABEL FROM SYSUT2         UL0H 08928817
         LA    R0,79                                               UL0H 08929217
         L     R15,MYPRTCON                                        UL0H 08929617
         BALR  R14,R15             PRINT                           UL0H 08930017
         BR    R4             GO BACK TO COMPARE MORE LABELS       UL0H 08930417
*                                                                       08930817
END      LA    R6,LABMSG                                           UL0H 08931117
MYPRT    MVC   MYPRTARE(120),BLANKS                                UL0H 08931417
         CVD   R5,CONVTDEC                                         UL0H 08931717
         UNPK  PTAREA(8),CONVTDEC(8)                               UL0H 08932017
         OI    PTAREA+7,X'F0'                                      UL0H 08932317
         MVC   LABMSG+8(1),PTAREA+7                                UL0H 08932617
         MVC   MYPRTARE(72),LABMSG                                 UL0H 08932917
         LA    R0,119                                              UL0H 08933217
         LA    R1,MYPRTARE             OUTPUT # OF LABELS          UL0H 08933517
         L     R15,MYPRTCON                 COMPARED MSG           UL0H 08933817
         BALR  R14,R15             PRINT                           UL0H 08934117
         B     CKTERM         BRANCH                               UL0H 08934817
*                                                                       08935617
*        SYSUT1 CONTAINS NO INPUT LABELS                                08936017
NOLAB1   TM    NOLB,X'02'     IS THERE ANY USER LABEL ON SYSUT2    UL0H 08936417
         BO    NOLAB          BRANCH                               UL0H 08936817
         TM    LBSW,X'01'     IN TRAILER LABEL COMPARISON          UL0H 08937217
         BO    NOT1           BRANCH                               UL0H 08937617
         LA    R1,35          SYSUT1 HAS NO INPUT HD LABEL MSG     UL0H 08938017
         B     PT1            BRANCH                               UL0H 08938417
NOT1     LA    R1,38          SYSUT1 HAS NO INPUT TL LABEL MSG     UL0H 08938817
PT1      L     R15,PRINCONS                                        UL0H 08939217
         BALR  R14,R15             PRINT                           UL0H 08939617
         SR    R5,R5          CLEAR REG5                           UL0H 08940017
         L     R3,SAREA2      REG3 CONT. ADDR OF SYSUT2 LAB SAVAREAUL0H 08940417
         S     R3,EIGHTY                                           UL0H 08940817
         B     PPRT2          GO PRINT THE LABELS ON SYSUT2        UL0H 08941217
*                                                                  UL0H 08941617
*        SYSUT2 CONTAINS NO INPUT LABELS                           UL0H 08942017
NOLAB2   TM    LBSW,X'01'     IN TRAILER LABEL COMPARISON          UL0H 08942417
         BO    NOT2           YES, BRANCH                          UL0H 08942817
         LA    R1,36          SYSUT2 HAS NO INPUT HD LABEL MSG     UL0H 08943217
         B     PT2            BRANCH                               UL0H 08943617
NOT2     LA    R1,39          SYSUT2 HAS NO INPUT TL LABEL MSG     UL0H 08944017
PT2      L     R15,PRINCONS                                        UL0H 08944417
         BALR  R14,R15             PRINT                           UL0H 08944817
         SR    R5,R5          CLEAR REG5                           UL0H 08945217
         L     R2,SAREA1      REG2 HAS ADDR. OF SYSUT1 LABEL SAVAREUL0H 08945617
         S     R2,EIGHTY                                           UL0H 08946017
         B     PPRT1          BRANCH                               UL0H 08946417
*                                                                  UL0H 08946817
NOLAB    TM    LBSW,X'01'     IN TRAILER LABEL COMPARISON          UL0H 08947217
         BO    NOTL           YES, BRANCH                          UL0H 08947617
         LA    R1,37          NO USER INHD LABEL ON BOTH DATA SETS UL0H 08948017
         B     PTL            BRANCH                               UL0H 08948417
NOTL     LA    R1,40          NO USER INTL LABEL ON BOTH DATA SETS UL0H 08948817
PTL      L     R15,PRINCONS                                        UL0H 08949217
         BALR  R14,R15             PRINT                           UL0H 08949617
         CLI   HICONCOD+1,X'08'    IS HIGHEST RET. CODE EQ 8       UL0H 08950017
         BH    CKTERM         BRANCH IF HIGHER                     UL0H 08950417
         MVI   HICONCOD+1,X'08'                                    UL0H 08950817
CKTERM   TM    TERMSW,X'01'   USER LABEL PROC. RTN REQUESTED TERM. UL0H 08951217
         BO    USREQTE1       YES, BRANCH                          UL0H 08951617
         TM    LBSW,X'01'     IN TRAILER LABEL COMPARISON          UL0H 08952017
         BO    GOBACK1        YES                                  UL0H 08952417
         TM    LABEL,X'10'    IS DATA=ONLY                         UL0H 08952817
         BZ    GOBACK1        NO, BRANCH                           UL0H 08953217
         LA    R1,49          NO RECORDS COMPARED,DATA=ONLY MSG    UL0H 08953617
         L     R15,PRINCONS                                        UL0H 08954017
         BALR  R14,R15             PRINT                           UL0H 08954417
         B     NORMEND        BRANCH                               UL0H 08954817
GOBACK1  L     R9,SAVE9       RETURN                               UL0H 08955217
         BR    R9                  BRANCH                          UL0H 08955617
USREQTE1 MVI   HICONCOD+1,X'16'   RET CODE=16 ON USER REQUEST    A44317 08956021
         B     USREQTER       BRANCH                               UL0H 08956417
USREQTE2 LA    R15,16                                              UL0H 08956817
         STC   R15,HICONCOD                                        UL0H 08957217
         LA    R1,57          TERM AFTER USER VOL-SWITCH LAB PROC  UL0H 08957617
         L     R15,PRINCONS                                        UL0H 08958017
         BALR  R14,R15             BRANCH                          UL0H 08958417
         B     NORMEND        BRANCH                               UL0H 08958817
*********************************************************************** 08959217
*        THIS SECTION OF CODE WILL CHECK FOR THE PRESENCE OF VS RECORD* 08959617
*        IN BOTH INPUT DATA SETS. THEN DECIDE WHETHER BSAM OR QSAM MOV* 08960017
*        MODE SHOULD BE USED FOR VS RECORD PROCESSING. IF NO VS RECORD* 08960417
*        IN EITHER INPUT DATA SETS, BSAM WILL BE USED TO PROCESS BOTH * 08960817
*        INPUT DATA SETS.                                             * 08961217
*********************************************************************** 08961617
CKVRE    MVI   NOEXTSW,X'00'  TURN OFF NO MORE EXIT TO USER LAB SW VS0H 08962017
         MVI   NOLB,X'00'                                          UL0H 08962417
SDSOBEG  CLC   KEYLTH(1),DCBKL2    COMPARE KEY LENGTHS             VS0H 08962817
         BNE   ERRKEY                                              VS0H 08963217
         TM    KEYLTH,255                                          VS0H 08963617
         BZ    CKVRE1         NO, BRANCH                           VS0H 08964017
         MVI   KSWT,1              SET KEY PRESENT SW ON           VS0H 08964417
CKVRE1   TM    CCADSORG,1     ARE DATA SETS PARTITIONED            VS0H 08964817
         BO    FMTEST         YES, BRANCH                          VS0H 08965217
VSFM1    TM    RECFM1,X'48'        IS RECFM OF SYSUT1 VS           VS0H 08965617
         BO    VSFM2               YES,BRANCH                      VS0H 08966017
         TM    RECFM1,X'80'        IS RECFM OF SYSUT1 V         OY01190 08966416
         BNO   V1                  YES,BRANCH                   OY01190 08966816
         TM    RECFM2,X'48'        IS RECFM OF SYSUT2 VS           VS0H 08967217
         BO    ERRFMT2             YES, RECFM DIFFERENT MSG     OY01190 08967616
         B     FORMTEST            NO,BRANCH                       VS0H 08968017
*        SYSUT1 RECFM IS VS                                             08968417
VSFM2    TM    RECFM2,X'48'        IS RECFM OF SYSUT2 VS           VS0H 08968817
         BO    BOTHVS              YES,BRANCH                      VS0H 08969217
         TM    RECFM2,X'80'        IS RECFM OF SYSUT2 V         OY01190 08969616
         BNO   VSV2                YES,BRANCH                   OY01190 08970016
         B     ERRFMT2             NO, RECFM DIFFERENT MSG      OY01190 08970416
*        SYSUT1 RECFM IS V                                              08970817
V1       TM    RECFM2,X'48'        IS RECFM OF SYSUT2 VS           VS0H 08971217
         BO    VSV1                YES,BRANCH                      VS0H 08971617
         B     FORMTEST       NO                                   VS0H 08972017
*        RECFM OF BOTH DATA SETS ARE VS                               * 08972417
BOTHVS   TM    KSWT,X'01'     ARE KEY PRESENT                      VS0H 08972817
         BO    INITBSAM       YES, BRANCH                          VS0H 08973217
         TM    RECLTH,X'80'   IS SYSUT1 LRECL GREATER THAN 32K     VS0H 08973617
         BO    NITBSAM                  YES, CHECK IF SYSUT2 ALSO  VS0H 08974017
         TM    RECLH2,X'80'   IS SYSUT2 LRECL GREATER THAN 32K     VS0H 08974417
         BO    ERRMLTH             YES, INCOMPATABLE DATA SETS     VS0H 08974817
         B     INITQSAM       BRANCH                               VS0H 08975217
*        RECFM OF ONE INPUT DATA SET IS VS AND RECFM OF THE OTHER DATA* 08975617
*        SET IS V                                                     * 08976017
VSV1     TM    RECLH2,X'80'   IS SYSUT2 LRECL GREATER THAN 32K     VS0H 08976417
         BZ    VSV            NO                                   VS0H 08976817
         BO    ERRMLTH        YES, BRANCH                          VS0H 08977217
VSV2     TM    RECLTH,X'80'   IS SYSUT1 LRECL GREATER THAN 32K     VS0H 08977617
         BO    ERRMLTH        YES, BRANCH                          VS0H 08978017
VSV      TM    KSWT,X'01'     KEY PRESENT SW ON                    VS0H 08978417
         BO    KEYVSV         YES, BRANCH                          VS0H 08978717
         B     INITQSAM       BRANCH                               VS0H 08979017
NITBSAM  TM    RECLH2,X'80'         SYSUT2 ALSO GREATER THAN 32K   VS0H 08979417
         BO    INITBSAM                 IF SO THAN PROCEED         VS0H 08979617
ERRMLTH  LA    R1,51         ONE DATA SET CONTAINS LOGICAL RECORDS VS0H 08979917
         B     ABNOTERM       BRANCH                               VS0H 08980817
KEYVSV   LA    R1,52          KEYED DATA SETS, ONE CONTAINS VS     VS0H 08981217
         B     ABNOTERM       BRANCH                               VS0H 08982417
POVS     LA    R1,56               PARTITION ORG. DATA SETS        VS0H 08982817
         B     ABNOTERM       BRANCH                               VS0H 08984017
INITQSAM CLOSE (DASET1,REREAD,DASET2,REREAD)                       UL0H 08984417
         L     R15,ADQSAM                                          UL0H 08984817
         BR    R15                 GO TO IEBCQSAM                  UL0H 08985217
INITBSAM MVI   VSSWT,X'01'    SET BSAM PROC VS RECORD SW ON        VS0H 08985617
         LA    R1,53          RECORD COMPARED AT PHYS BLK LEVEL    VS0H 08986017
         L     R15,PRINCONS                                        VS0H 08986417
         BALR  R14,R15             PRINT                           VS0H 08986817
         B     GETCORE        BRANCH                               VS0H 08987217
FMTEST   TM    RECFM1,X'48'        IS RECFM OF SYSUT1 VS           VS0H 08989217
         BO    POVS                YES, BRANCH                     VS0H 08991217
         TM    RECFM2,X'48'        IS RECFM OF SYSUT2 VS           VS0H 08993217
         BO    POVS                YES, BRANCH                     VS0H 08995217
FORMTEST TM    RECFM1,X'C0'                                             09000000
         BO    FMTUNKWN                                                 09020000
         TM    RECFM1,128                                               09040000
         BO    FMTFIXED                                                 09060000
         TM    RECFM1,64                                                09080000
         BO    FMTVAR                                                   09100000
         B     ERRFMT                                                   09120000
FMTFIXED TM    RECFM2,128                                               09140000
         BZ    ERRFMT2                                             SA0I 09160018
         MVI   FSWT,1                                                   09180000
         CLC   RECLTH(2),LORECO    IS RECORD LENGTH = ZERO              09200000
         BNE   RECLTHCR                                                 09220000
         MVC   RECLTH(2),MAXBLLH1+2  SET RECORD LENGTH = BLOCKSIZE      09240000
         MVC   RECLH2(2),RECLTH                                         09260000
RECLTHCR CLC   RECLTH(2),RECLH2    ARE RECORD LENGTHS EQUAL             09280000
         BNE   ERRMELEN                                                 09300000
         B     GETCORE                                                  09320000
FMTVAR   TM    RECFM2,64                                                09340000
         BZ    ERRFMT2                                                  09360000
         MVI   VSWT,1                                                   09380000
         B     GETCORE                                                  09400000
FMTUNKWN TM    RECFM2,X'C0'                                             09420000
         BC    14,ERRFMT2                                          SA0I 09440018
* COORDINATION COMPLETED AND SWITCHES SET.                              09460000
GETCORE  L     0,MAXBLLH1          OBTAIN BUFFER FOR DATA SET 1 RECORDS 09480000
         L     1,KEYLTH                                                 09500000
         SRL   1,24                                                     09520000
         ST    1,KEYLTH                                                 09540000
         A     0,KEYLTH                                                 09560000
         ST    R0,LBUFF1      SAVE LENGTH OF GET STORAGE           VS0H 09570017
         MVC   DCBKL2+3(1),DCBKL2  MOVE KEY LENGTH FOR SYSUT2 TO LOW    09580000
*                                    ORDER BYTE                         09600000
         NI    DCBKL2,X'00'        SET HIGH ORDER BYTE OF KEY FIELD =0  09620000
         GETMAIN R,LV=(0)                                               09640000
         ST    1,BUFF1             STORE ADDRESS OF BUFFER AREA         09660000
         L     0,MAXBLLH2          OBTAIN BUFFER FOR DATA SET 2 RECORDS 09680000
         A     0,KEYLTH                                                 09700000
         ST    R0,LBUFF2      SAVE LENGTH OF GET STORAGE           VS0H 09710017
         GETMAIN R,LV=(0)                                               09720000
         ST    1,BUFF2                                                  09740000
TESTBUF1 TM    BUFSW1,1            IS BUFFER 1 EMPTY.                   09760000
         BZ    TESTBUF2              NO                                 09780000
         TM    CCADSORG,1                                               09800000
         BZ    READSET1                                                 09820000
         TM    ONETIME,1           SWITCH IS SET                        09840000
         BO    READSET1              AFTER THE                          09860000
         MVI   ONETIME,1               FIRST TIME THROUGH               09880000
GETMEMB  TM    ENDMEMBS,1          ARE THERE ANY MEMBER NAMES LEFT.     09900000
         BO    NORMEND               NO                                 09920000
         XC    PHRECO1(4),PHRECO1  SET PHYSICAL RECORD COUNTERS         09940000
         XC    PHRECO2(4),PHRECO2    EQUAL TO ZERO                      09960000
         XC    ERRCO(2),ERRCO     ZERO ERROR COUNTER                    09980000
         MVI   EOD1SW,0            SET EOD SWITCHES                     10000000
         MVI   EOD2SW,0              EQUAL TO ZERO                      10020000
         MVI   BUFSW1,1            SET SWITCHES TO READ                 10040000
         MVI   BUFSW2,1              BOTH DATA SETS                     10060000
         L     3,NOTNREAD                                               10080000
         L     9,TNSET                                                  10100000
         AR    9,3                 PLACE NEXT MEMBER NAME               10120000
         MVC   FINDAREA(8),0(9)      IN FINDAREA.                       10140000
         AH    3,EIGHT                                                  10160000
         ST    3,NOTNREAD                                               10180000
         C     3,TNTABLEL          HAS LAST MEMBER BEEN PICKED UP.      10200000
         BNE   FINDBPAM              NO.                                10220000
         MVI   ENDMEMBS,1                                               10240000
FINDBPAM LA    13,SAVEREGS                                              10260000
         FIND  DASET1,FINDAREA,D                                        10280000
         LTR   15,15               TEST RETURN FROM FIND MACRO          10300000
         BNE   ERRMRET2            BRANCH                        A26556 10320019
         FIND  DASET2,FINDAREA,D                                        10340000
         LTR   15,15               TEST RETURN FROM FIND MACRO          10360000
         BNE   ERRMRET2                                                 10380000
READSET1 L     8,BUFF1                                                  10400000
         MVC   LOREPP1(2),ONE      SET LOGICAL RECORD/BLOCK COUNTER=1   10420000
         READ  DECB1A,SF,DASET1,(8),'S'                                 10440000
         CHECK DECB1A                                                   10460000
         TM    TERMSW,X'01'   DID USER INHDR/INTLR REQUEST TERM.   UL0H 10466017
         BO    USREQTE2       BRANCH                               VS0H 10473017
         TM    CCADSORG,1          IS DATA SET 1 PARTITIONED.           10480000
         BZ    NOSCAN                NO                                 10500000
         SR    8,8                                                      10520000
         C     8,TTRTABLL          ARE NOTE LISTS PRESENT               10540000
         BE    NOSCAN                NO                                 10560000
         TM    TABLE1SW,1          IS DATA SET 1 THE SUBSET             10580000
         BZ    NOSCAN                NO                                 10600000
         NOTE  DASET1                                                   10620000
SCANNL1  L     7,TTRSET1                                                10640000
         AR    7,8                                                      10660000
         C     1,0(7)              IS TTR OF RECORD READ IN NOTE LIST   10680000
         BE    SKIPPAM2              TABLE. YES                         10700000
         AH    8,FOUR                                                   10720000
         C     8,TTRTABLL          HAS ENTIRE TABLE BEEN SCANNED.       10740000
         BE    NOSCAN                YES                                10760000
         B     SCANNL1               NO                                 10780000
SKIPPAM2 L     8,BUFF2                                                  10800000
         READ  DECB2A,SF,DASET2,(8),'S',MF=E                            10820000
         CHECK DECB2A                                                   10840000
         B     READSET1                                                 10860000
NOSCAN   MVI   BUFSW1,0                                                 10880000
         OI    BUFSW1,X'10'       SET JUST READ SYSUT1 SWITCH ON        10900000
         L     7,PHRECO1           INCREMENT PHYSICAL RECORD            10920000
         AH    7,ONE                 COUNTER FOR DATA                   10940000
         ST    7,PHRECO1               SET 1                            10960000
         TM    KSWT,1              ARE KEYS PRESENT.                    10980000
         BO    TESTBUF2              YES                                11000000
         TM    VSSWT,X'01'    IS RECFM VS TYPE                     VS0H 11006017
         BO    TESTBUF2       YES, BRANCH                          VS0H 11012017
         TM    VSWT,1              ARE RECORDS V-TYPE.                  11020000
         BZ    FORUTYPE              NO                                 11040000
         LH    4,FOUR              INITIALIZE REG. 4 FOR V-TYPE RECORDS 11060000
         L     7,BUFF1                                                  11080000
         MVC   BLKLTH1(2),0(7)     PLACE BLOCK LENGTH 1N BLKLTH1.       11100000
         AR    7,4                                                      11120000
         MVC   RECLTH(2),0(R7)     GET LITTLE LL                 A26556 11140019
         LH    R5,RECLTH           STORE LITTLE LL IN REG5       A26556 11160019
         B     TESTBUF2                                                 11180000
FORUTYPE SR    4,4                 INITIALIZE REG. 4 FOR F OR U-TYPE    11200000
         L     8,MAXBLLH1          OBTAIN NUMBER                        11220000
         L     9,DECB1A+16           OF BYTES READ                      11240000
         LH    9,14(9)                 AND                              11260000
         SR    8,9                       STORE                          11280000
         STH   8,BLKLTH1                   IN BLKLTH1                   11300000
         TM    FSWT,1              ARE RECORDS F-TYPE.                  11320000
         BO    FTYPE                 YES                                11340000
         STH   8,RECLTH              NO -STORE LENGTH OF U-TYPE RECORD. 11360000
FTYPE    LH    5,RECLTH                                                 11380000
TESTBUF2 TM    BUFSW2,1            DOES BUFFER 2 NEED MORE RECORDS.     11400000
         BO    READ2                 YES                                11420000
ACTUCOMP TM    VSWT,X'01'         ARE THESE V-TYPE RECORDS              11440000
         BZ    ACT2COMP              NO BRANCH                          11460000
         BAL   R3,SPORTL           GO CHECK FOR VALID RECORD LEN A26556 11470019
ACT2COMP BAL   3,COMPAR           BRANCH TO COMPARE SUBROUTINE          11500000
RETFRCOM L     3,LORECO            INCREMENT TOTAL LOGICAL              11520000
         AH    3,ONE                 RECORD                             11540000
         ST    3,LORECO                COUNTER                          11560000
         LH    3,LOREPP1           INCREMENT                            11580000
         AH    3,ONE                 LOGICAL                            11600000
         STH   3,LOREPP1               RECORD                           11620000
         LH    3,LOREPP2                 PER                            11640000
         AH    3,ONE                       BLOCK                        11660000
         STH   3,LOREPP2                     COUNTERS                   11680000
         AH    4,RECLTH            INCREMENT REGISTER 4.                11700000
         CH    4,BLKLTH1           ARE MORE RECORDS NEEDED FOR SET 1.   11720000
         BL    BUF2SET               NO                                 11740000
         MVI   BUFSW1,1              YES - RESET BUFSW1                 11760000
BUF2SET  AH    6,RECLH2           UP RELATIVE POINTER IN BUFF2          11780000
*    INSTRUCTIONS TO OBTAIN NEW RECORD LENGTH, IF NECESSARY.            11800000
         TM    VSWT,1                                                   11820000
         BZ    NEWRLSET                                                 11840000
         TM    BUFSW1,1                                                 11860000
         BO    NEWRLSET                                                 11880000
         L     7,BUFF1                                                  11900000
         AR    7,4                                                      11920000
         MVC   RECLTH(2),0(7)                                           11940000
* NEW RECORD LENGTH OBTAINED                                            11960000
NEWRLSET LH    5,RECLTH                                                 11980000
         CH    6,BLKLTH2                                                12000000
         BL    ARO                                                      12020000
         MVI   BUFSW2,1                                                 12040000
         B     TESTBUF1                                                 12060000
ARO      TM    VSWT,1             IS THIS V-TYPE RECORD                 12080000
         BO    VAG                  YES BRANCH                          12100000
         B     TESTBUF1           GO GET ANOTHER RECORD                 12120000
VAG      L     7,BUFF2            BUFF2 IS NOT EMPTY, THUS UP RELATIVE  12140000
         AR    7,6                 POINTER TO NEXT V-TYPE RECORD        12160000
         MVC   RECLH2(2),0(7)                                           12180000
         B     TESTBUF1           GO GET ANOTHER RECORD                 12200000
SPORTB   CLC   BLKLTH1(2),EIGHT    IS BLKLTH1 NO HIGHER THAN 8   A26556 12250019
         BNH   INPERR              YES, BRANCH                   A26556 12300019
         CLC   BLKLTH1(2),MAXLL    IS BLKLTH1 GREATER THAN 32760 A26556 12350019
         BH    INPERR              YES, BRANCH                   A26556 12400019
         CLC   BLKLTH2(2),EIGHT    IS BLKLTH2 NO HIGHER THAN 8   A26556 12450019
         BNH   INPERR              YES, BRANCH                   A26556 12500019
         CLC   BLKLTH2(2),MAXLL    IS BLKLTH2 GREATER THAN 32760 A26556 12550019
         BH    INPERR              YES, BRANCH                   A26556 12600019
SPORTL   CLC   RECLTH(2),FOUR     IS LITTLE LL NO HIGHER THAN 4  A26556 12650019
         BNH   ERRMRET1            YES, BRANCH                   A26556 12700019
         CLC   RECLTH(2),MAXLLL   IS RECLTH GREATER THAN 32756   A26556 12750019
         BH    ERRMRET1            YES, BRANCH                   A26556 12800019
         CLC   RECLH2(2),FOUR     IS LITTLE LL NO HIGHER THAN 4  A26556 12850019
         BNH   ERRMRET1            YES, BRANCH                   A26556 12900019
         CLC   RECLH2(2),MAXLLL    IS RECLH2 GREATER THAN 32756  A26556 12950019
         BH    ERRMRET1            YES, BRANCH                   A26556 13000019
         BR    R3                  BRANCH BACK                   A26556 13050019
READ2    L     8,BUFF2                                                  13160000
         MVC   LOREPP2(2),ONE      SET LOGICAL RECORD/BLOCK COUNTER=1   13180000
         LA    13,SAVEREGS                                              13200000
         READ  DECB2A,SF,DASET2,(8),'S'                                 13220000
         CHECK DECB2A                                                   13240000
         TM    TERMSW,X'01'   DID USER INHDR/INTLR REQUEST TERM.   UL0H 13246017
         BO    USREQTE2       BRANCH                               VS0H 13253017
         TM    CCADSORG,1                                               13260000
         BZ    NOSCAN2                                                  13280000
         SR    8,8                                                      13300000
         C     8,TTRTABLL                                               13320000
         BE    NOSCAN2                                                  13340000
         TM    TABLE2SW,1                                               13360000
         BZ    NOSCAN2                                                  13380000
         NOTE  DASET2                                                   13400000
SCANNL2  L     7,TTRSET2                                                13420000
         AR    7,8                                                      13440000
         C     1,0(7)                                                   13460000
         BE    SKIPPAM1                                                 13480000
         AH    8,FOUR                                                   13500000
         C     8,TTRTABLL                                               13520000
         BE    NOSCAN2                                                  13540000
         B     SCANNL2                                                  13560000
SKIPPAM1 L     8,BUFF1                                                  13580000
         READ  DECB1A,SF,DASET1,(8),'S',MF=E                            13600000
         CHECK DECB1A                                                   13620000
         B     READ2                                                    13640000
NOSCAN2  MVI   BUFSW2,0                                                 13660000
         L     7,PHRECO2           INCREMENT PHYSICAL RECORD            13680000
         AH    7,ONE                 COUNTER FOR DATA                   13700000
         ST    7,PHRECO2               SET 2                            13720000
         TM    KSWT,1              ARE KEYS PRESENT.                    13740000
         BO    KEYROU                YES -GO TO KEYROU                  13760000
         TM    VSSWT,X'01'    IS RECFM VS TYPE                     VS0H 13766017
         BO    VSCOMP         YES, GO TO COMPR VS TYPE RECORDS     VS0H 13772017
         TM    VSWT,1                                                   13780000
         BZ    FORUTYP2                                                 13800000
         LH    6,FOUR              INITIALIZE REG. 6 FOR V-TYPE RECORDS 13820000
         L     7,BUFF2                                                  13840000
         MVC   BLKLTH2(2),0(7)                                          13860000
         AR    7,6                UP POINTER TO LOGICAL RECORD          13880000
         MVC   RECLH2(2),0(7)     MOVE LOGICAL RECORD LENGTH            13900000
         B     ACTUCOMP                                                 13920000
FORUTYP2 SR    6,6                 INITIALIZE REG. 6 FOR F OR U-TYPE    13940000
         L     8,MAXBLLH2                                               13960000
         L     9,DECB2A+16                                              13980000
         LH    9,14(9)                                                  14000000
         SR    8,9                                                      14020000
         STH   8,BLKLTH2                                                14040000
         TM    FSWT,1              IS FORMAT FIXED                      14060000
         BO    STOREC2                                                  14080000
         STH   8,RECLH2           STORE LOGICAL RECORD LTH OF U-TYPE    14100000
         B     ACTUCOMP           GO COMPARE RECORDS                    14120000
*    ROUTINE WHEN KEYS ARE PRESENT                                      14140000
KEYROU   L     5,KEYLTH                                                 14160000
         SR    4,4                 INITIALIZE REGISTERS                 14180000
         SR    6,6                   4 AND 6                            14200000
         MVI   KEYCOMSW,1                                               14220000
         BAL   3,COMPAR            COMPARE KEYS                         14240000
         MVI   KEYCOMSW,0                                               14260000
         A     4,KEYLTH                                                 14280000
         A     6,KEYLTH                                                 14300000
         TM    VSSWT,X'01'    IS RECFM VS TYPE                     VS0H 14306017
         BO    VSCOMPK        YES, GO TO COMPR VS TYPE RECORDS     VS0H 14312017
         TM    VSWT,1              ARE RECORDS V-TYPE.                  14320000
         BZ    OTHTYPE               NO                                 14340000
         L     7,BUFF1                                                  14360000
         AR    7,4                                                      14380000
         MVC   BLKLTH1(2),0(R7)    GET BIG LL IN BLKLTH1         A26556 14420019
         L     15,BUFF2           LOAD BUFF2 ADDR                       14460000
         AR    15,6               UP POINTER TO PHYSICAL RECORD         14480000
         MVC   BLKLTH2(2),0(R15)   GET BIG LL IN BLKLTH2         A26556 14490019
         MVC   RECLTH(2),4(R7)                                   A26556 14500019
         MVC   RECLH2(2),4(R15)                                  A26556 14510019
         BAL   R3,SPORTB           GO CHECK FOR VALID BLOCK AND  A26556 14520019
*                                  RECORD SIZE                   A26556 14530019
         LH    R14,BLKLTH1         GET BLOCK SIZE 1              A26556 14540019
         AR    R14,R4              ADD KEY LENGTH TO IT          A26556 14550019
         STH   R14,BLKLTH1         STORE ACTUAL SIZE OF BUFFER   A26556 14560019
*                                  IN BLKLTH1                    A26556 14570019
         AH    R4,FOUR             REG4 HAS PROPER DISPLACEMENT  A26556 14580019
*                                  TO NEXT RECORD IN BUFFER 1    A26556 14590019
         LH    R14,BLKLTH2         GET BLOCK SIZE 2              A26556 14600019
         AR    R14,R6              ADD KEY LENGTH TO IT          A26556 14610019
         STH   R14,BLKLTH2         STORE ACTUAL SIZE OF BUFFER   A26556 14620019
*                                  IN BLKLTH2                    A26556 14630019
         AH    R6,FOUR             REG6 HAS PROPER DISPLACEMENT  A26556 14640019
*                                  TO NEXT RECORD IN BUFFER 2    A26556 14650019
KEYROU2  BAL   3,COMPAR            GO COMPARE RECORDS                   14740000
         L     3,LORECO            INCREMENT TOTAL LOGICAL              14760000
         AH    3,ONE                 RECORD                             14780000
         ST    3,LORECO                COUNTER                          14800000
         LH    3,LOREPP1           INCREMENT                            14820000
         AH    3,ONE                 LOGICAL                            14840000
         STH   3,LOREPP1               RECORD                           14860000
         LH    3,LOREPP2                 PER                            14880000
         AH    3,ONE                       BLOCK                        14900000
         STH   3,LOREPP2                     COUNTERS                   14920000
         AH    4,RECLTH                                                 14940000
         AH    6,RECLTH                                                 14960000
         CH    4,BLKLTH1           IS ANOTHER PHYSICAL RECORD NEEDED.   14980000
         BNL   SETBUFSW              YES                                15000000
         TM    VSWT,1              ARE RECORDS V-TYPE.                  15020000
         BZ    MUSTBEF               NO -RECORDS MUST BE F-TYPE         15040000
         L     7,BUFF1                                                  15060000
         AR    7,4                                                      15080000
         MVC   RECLTH(2),0(7)                                           15100000
         L     R8,BUFF2            GET BUFF2 ADDRESS             A26556 15103019
         AR    R8,R6               ADD PROPER DISPLACEMENT TO IT A26556 15106019
         MVC   RECLH2(2),0(8)      GET LRECL 2                   A26556 15109019
         BAL   R3,SPORTL           GO CHECK FOR VALID RECORD LEN A26556 15112019
         B     KEYROU2                 BRANCH TO COMPAR         A37861  15115021
MUSTBEF  LH    5,RECLTH                                                 15120000
         B     KEYROU2             BRANCH                        A26556 15140019
SETBUFSW MVI   BUFSW1,1                                                 15160000
         MVI   BUFSW2,1                                                 15180000
         B     TESTBUF1                                                 15200000
OTHTYPE  L     8,MAXBLLH1          OBTAIN NUMBER                        15220000
         L     9,DECB1A+16           OF                                 15240000
         LH    9,14(9)                 BYTES                            15260000
         SR    8,9                       READ                           15280000
         LR    9,8                                                      15300000
         AR    8,4                 ADD KEY LENGTH                       15320000
         STH   8,BLKLTH1               STORE IN BLOCK LENGTH            15340000
         ST    REG3,SAVEREG3      SAVE REG3                        9314 15342013
         L     OUTLEN,MAXBLLH2    DECB LENGTH INFO.                9314 15344013
         L     REG3,DECB2A+16     LENGTH OF READ                   9314 15346013
         LH    REG3,14(REG3)      POINT TO FIRST REC.              9314 15348013
         SR    OUTLEN,REG3        OBTAIN # OF                      9314 15350013
         LR    REG3,OUTLEN                    RECORDS READ         9314 15352013
         AR    OUTLEN,REG4        ADD KEYLENGTH                    9314 15354013
         STH   OUTLEN,BLKLTH2     STORE RECORD LENGTH              9314 15356013
         TM    FSWT,1                  ARE RECORDS F-TYPE               15360000
         BO    KEYFTYPE                  YES                            15380000
         STH   9,RECLTH                  NO -NO. OF BYTES READ = RECLTH 15400000
         STH   REG3,RECLH2        STORE RECORD LENGTH              9314 15404013
         L     REG3,SAVEREG3      RESTORE REG3                     9314 15408013
         CLC   BLKLTH1(2),BLKLTH2 COMPARE LENGTH R1 TO R2          9314 15412013
         BNE   ERRCOMP            NOT EQUAL IS AN ERROR CONDITION  9314 15416013
KEYFTYPE LH    5,RECLTH                                                 15420000
         B     KEYROU2             BRANCH                        A26556 15450019
VSCOMP   SR    R4,R4          CLEAR REG4                           VS0H 15480717
         SR    R6,R6          CLEAR REG6                           VS0H 15481417
VSCOMPK  SR    R3,R3          CLEAR REG3                           VS0H 15482117
         STH   R3,LOREPP1     SET LOG./PHYS.RCD CT FOR SYSUT1 TO 0 VS0H 15482817
         STH   R3,LOREPP2     SET LOG./PHYS.RCD CT FOR SYSUT2 TO 0 VS0H 15483517
         L     R7,BUFF1       GET ADDR. OF BUFFER 1                VS0H 15484217
         AR    R7,R4          GET REG7 POINTS TO BIG LL            VS0H 15484917
         LH    R5,0(R7)       REG5 CONTAIN BIG LL                  VS0H 15485617
         CH    R5,EIGHT       IS LL GREATER THAN 8                 VS0H 15486317
         BNH   INPERR         NO, PERMANENT INPUT ERROR            VS0H 15487017
         CH    R5,MAXLL       IS BIG LL GREATER THAN 32760         VS0H 15487717
         BH    INPERR         YES, PERMANENT INPUT ERROR           VS0H 15488417
         STH   R5,RECLTH      SET RCD LENGTH OF SYSUT1 EQ BIG LL   VS0H 15489117
         L     R8,BUFF2       GET ADDR. OF BUFFER 2                VS0H 15489817
         AR    R8,R6          GET REG8 POINTS TO BIG LL            VS0H 15490517
         LH    R3,0(R8)       REG3 CONTAIN BIG LL                  VS0H 15491217
         CH    R3,EIGHT       IS LL GREATER THAN 8                 VS0H 15491917
         BNH   INPERR         NO, PERMANENT ERROR                  VS0H 15492617
         CH    R3,MAXLL       IS LL GREATER THAN 32760             VS0H 15493317
         BH    INPERR         YES, PERMANENT ERROR                 VS0H 15494017
         STH   R3,RECLH2      SET RCD LENGTH OF SYSUT2 EQ BIG LL   VS0H 15494717
         BAL   R3,COMPAR      GO TO COMPARE 2 BLOCKS OF RECORD     VS0H 15495417
AGAIN    MVI   BUFSW1,X'01'   SET BUFFER 1 EMPTY SW ON             VS0H 15496117
         MVI   BUFSW2,X'01'   SET BUFFER 2 EMPTY SW ON             VS0H 15496817
         B     TESTBUF1       BRANCH                               VS0H 15497817
* COMPARE ROUTINE                                                       15500000
COMPAR   STM   R2,R8,CSAVE    SAVE REG2-REG8                       VS0H 15510017
         L     R8,BUFF1       GET DS1 BUFFER ADDRESS               VS0H 15520017
         AR    8,4                       BE COMPARED IN REGS. 8 AND 9.  15540000
         L     R7,BUFF2                                            VS0H 15560017
         AR    R7,R6                                               VS0H 15580017
         NI    BUFSW1,1           SET SYSUT1 JUST READ SWITCH OFF       15600000
         TM    KEYCOMSW,1         ARE WE COMPARING KEYS                 15620000
         BO    DOOVER               YES BRANCH                          15640000
COMB     TM    VSSWT,X'03'    VS-TYPE RECORD                       VS0H 15690017
         BZ    NOTVS          NO, BRANCH                           VS0H 15700017
         LH    R5,0(R8)       YES, GET LL FIELD OF DS1 RECORD      VS0H 15710017
         LH    R3,0(R7)            GET LL FIELD OF DS2 RECORD      VS0H 15720017
         B     PREC           BRANCH                               VS0H 15730017
NOTVS    CLC   RECLTH(2),RECLH2        ARE RECORD LENGTHS EQUAL A37861  15736021
         BNE   ERRL                    NO BRANCH                A37861  15738021
         LH    R5,RECLTH               GET RECORD LENGTH IN R5  A37861  15740021
         LR    R3,R5                   AND RO                   A37861  15742021
PREC     TM    PRECOMSW,1     IS THERE AN USER PRECOMP ROUTINE     VS0H 15750017
         BZ    COML           NO, BRANCH                           VS0H 15760017
         LINK  EPLOC=PARATBLZ,PARAM=((8),(5),(7),(3))              VS0H 15780017
         CH    15,EIGHT                                                 15800000
         BNH   NOTECOCD                                                 15820000
USREQTER LA    R1,25          USER REQ. TERMINATION              A44317 15860021
         L     R15,PRINCONS                                        UV0H 15880017
         BALR  R14,R15             PRINT                           UV0H 15900017
         B     NORMEND                                                  15920000
NOTECOCD CH    15,HICONCOD                                              15940000
         BL    CKVS           BRANCH IF LOW                        VS0H 15960017
         STH   15,HICONCOD                                              15980000
CKVS     TM    VSSWT,X'03'    VS-TYPE RECORDS                      VS0H 15982017
         BM    CKL            YES, BRANCH                          VS0H 15984017
         B     DOOVER         NO                                   VS0H 15986017
CKL      LH    R5,0(R8)       GET LL FIELD OF DS1 RECORD           VS0H 15988017
         LH    R3,0(R7)       GET LL FIELD OF DS2 RECORD           VS0H 15990017
COML     CR    R5,R3          ARE LL JIELD EQ                      VS0H 15992017
         BNE   ERRL           NO, BRANCH                           VS0H 15994017
DOOVER   C     5,TWOFS             IS RECLTH GREATER THAN 256 BYTES.    16000000
         BH    COMP1                 YES                                16020000
         SH    5,ONE                 NO -PLACE NO. OF BYTES TO BE       16040000
         STC   5,COMP2+1             COMPARED IN COMPARE INSTRUCTION.   16060000
COMP2    CLC   0(1,R8),0(R7)       ARE RECORDS EQUAL               VS0H 16080017
         BNE   ERRCOMP               NO                                 16100000
         TM    KEYCOMSW,1                                               16120000
         BO    REST                SET KEY ERROR COUNT BACK TO ZERO     16140000
         SR    8,8                                                      16160000
         STH   8,ERRCO                                                  16180000
ENDCOMP  LM    R2,R8,CSAVE                                         VS0H 16190017
         B     0(R3)               BRANCH                          VS0H 16200017
COMP1    CLC   0(256,R8),0(R7)     COMPARE 256 BYTES               VS0H 16220017
         BNE   ERRCOMP               NOT EQUAL                          16240000
         S     5,TWOFS             SUBTRACT 256 FROM RECORD LENGTH      16260000
         A     8,TWOFS             ADD 256 TO ADDRESSES                 16280000
         A     R7,TWOFS            IN REG 8 AND 7                  VS0H 16300017
         B     DOOVER                                                   16320000
REST     MVI   KEYERCT+1,X'00'     SET KEY ERROR COUNT BACK TO ZERO     16340000
         B     ENDCOMP        BRANCH                               VS0H 16360017
         USING IHADCB,SYMREG1                                           16410000
         DCBD  DSORG=PS                                                 16460000
DDNAMDCB EQU   DCBDDNAM-IHADCB                                          16510000
DEVTDCB  EQU   DCBDEVT-IHADCB                                           16560000
KEYLEDCB EQU   DCBKEYLE-IHADCB                                          16610000
LRECLDCB EQU   DCBLRECL-IHADCB                                          16660000
MAIN     CSECT                                                          16710000
**                                                                   ** 16861019
**   EXIT TAKEN WHEN PERMANENT INPUT ERROR OCCURRED ON SYSUT1 OR     ** 16862019
**   SYSUT2 DATA SETS                                                ** 16863019
SYNADEX  SYNADAF    ACSMETH=BSAM   GET I/O ERROR STATUS          A27718 16864019
         MVC   MYPRTARE(120),BLANKS  CLEAR OUTPUT BUFFER         A27718 16865019
         MVC   MYPRTARE(18),IOERR  MOVE MSG. NO. INTO OUTPUT BUF A27718 16866019
         MVC   MYPRTARE+19(79),49(R1) MOVE I/O ERROR STATUS INTO A27718 16867019
*                                    OUTPUT BUFFER               A27718 16868019
         LA    R0,119                NO. OF BYTES TO BE PRINTED  A27718 16869019
         LA    R1,MYPRTARE           ADDRESS OF OUTPUT BUFFER    A27718 16870019
         L     R15,MYPRTCON          GET ADDR. OF PRINT ROUTINE  A27718 16871019
         BALR  R14,R15               GO TO PRINT MSG             A27718 16872019
         SYNADRLS                  RELEASE AREAS GOT BY SYNADAF  A27718 16873019
         B     ABNOTER1              GO TO ERROR TERMINATION     A48817 16874022
*  EXIT TAKEN DURING OPEN.  CRITICAL PARAMETERS STORED.                 16880000
DCBEXIT1 LA    SYMREG1,DASET1                                           16900000
         TM    CCADSORG,1                                               16920000
         BZ    ITISBSA1                                                 16940000
         OI    DCBMACF1,X'04'                                  @YM04833 16950002
         TM    SWFORBP1,1                                               16960000
         BO    NOTFIRS1                                                 16980000
         MVI   SWFORBP1,1                                               17000000
LLD1    NOP  LLD2                                                       17020000
       MVC  KEYLTH(1),DCBKEYLE                                          17040000
LLD2   MVI  LLD1+1,X'F0'                                                17060000
         MVI   DCBKEYLE,X'00'                                           17080000
         L     8,TWOFS                                                  17100000
         STH   8,DCBBLKSI                                               17120000
         MVI   DCBRECFM,X'88'                                           17140000
         RETURN                                                         17160000
NOTFIRS1 MVI   DCBDSORG,X'02'                                           17180000
        MVC  DCBKEYLE(1),KEYLTH                                         17200000
ITISBSA1 CLC   DCBBLKSI(2),=X'0000'    BLKSIZE SPECIFIED ?       A41765 17236021
         BNE   TESTLRE1           YES, TEST LRECL                A41765 17238021
         MVC   DCBBLKSI(2),=X'0001'    NO, SET DEFAULT BLKSIZE=1 A41765 17238421
         MVC   DCBLRECL(2),=X'0001'    NO, SET DEFAULT LRECL=1   A41765 17238521
         OI    ERRDCB,X'80'       SET ERROR BIT                  A41765 17238821
TESTLRE1 TM    DCBRECFM,X'C0'     IS RECFM. UNDEF. OR NOT DEF. ? A41765 17239221
         BC    9,DCBUND1          YES, SET LRECL EQ BLKSIZE      A41765 17239621
         CLC   DCBLRECL(2),=X'0000'    LRECL SPECIFIED ?         A41765 17239721
         BNE   SAVBLKS1           YES, END OF ERROR CHECKING     A41765 17239821
         MVC   DCBLRECL(2),=X'0001'    NO, SET DEFAULT LRECL=1   A41765 17239921
         OI    ERRDCB,X'80'       SET ERROR BIT                  A41765 17253221
         B     SAVBLKS1       END OF ERROR CHECKING              A41765 17263221
DCBUND1  MVC   DCBLRECL(2),DCBBLKSI  MOVE BLKSI IN LRECL FIELD   A41765 17265221
         OI    DCBRECFM,X'C0'        SET RECFM TO U.             A41765 17265321
SAVBLKS1 MVC   MAXBLLH1+2(2),DCBBLKSI SAVE BLKSIZE PARAMETER     A41765 17265621
         MVC   RECFM1(1),DCBRECFM                                A41765 17266721
         RETURN                                                         17280000
*  EXIT TAKEN DURING OPEN.  CRITICAL PARAMETERS STORED.                 17300000
DCBEXIT2 LA    SYMREG1,DASET2                                           17320000
         TM    CCADSORG,1                                               17340000
         BZ    ITISBSA2                                                 17360000
         OI    DCBMACF1,X'04'                                  @YM04833 17370002
         TM    SWFORBP2,1                                               17380000
         BO    NOTFIRS2                                                 17400000
         MVI   SWFORBP2,1                                               17420000
         MVI   SWFORBP1,0                                               17440000
         MVC   DCBKL2(1),DCBKEYLE                                       17460000
         MVI   DCBKEYLE,X'00'                                           17480000
         L     8,TWOFS                                                  17500000
         STH   8,DCBBLKSI                                               17520000
         MVI   DCBRECFM,X'88'                                           17540000
         RETURN                                                         17560000
NOTFIRS2 MVI   DCBDSORG,X'02'                                           17580000
         MVC   DCBKEYLE(1),DCBKL2                                       17600000
ITISBSA2 CLC   DCBBLKSI(2),=X'0000'    BLKSIZE SPECIFIED ?       A41765 17636021
         BNE   TESTLRE2           YES, TEST LRECL                A41765 17638021
         MVC   DCBBLKSI(2),=X'0001'    NO, SET DEFAULT BLKSIZE=1 A41765 17638421
         MVC   DCBLRECL(2),=X'0001'    NO, SET DEFAULT LRECL=1   A41765 17638521
         OI    ERRDCB,X'80'       SET ERROR BIT                  A41765 17638821
TESTLRE2 TM    DCBRECFM,X'C0'     IS RECFM. UNDEF. OR NOT DEF. ? A41765 17639221
         BC    9,DCBUND2          YES, SET LRECL EQ BLKSIZE      A41765 17639621
         CLC   DCBLRECL(2),=X'0000'    LRECL SPECIFIED ?         A41765 17639721
         BNE   SAVBLKS2           YES, END OF ERROR CHECKING     A41765 17639821
         MVC   DCBLRECL(2),=X'0001'    NO, SET DEFAULT LRECL=1   A41765 17639921
         OI    ERRDCB,X'80'       SET ERROR BIT                  A41765 17653221
         B     SAVBLKS2       END OF ERROR CHECKING              A41765 17663221
DCBUND2  MVC   DCBLRECL(2),DCBBLKSI  MOVE BLKSI IN LRECL FIELD   A41765 17665221
         OI    DCBRECFM,X'C0'        SET RECFM TO U.             A41765 17665321
SAVBLKS2 MVC   MAXBLLH2+2(2),DCBBLKSI SAVE BLKSIZE PARAMETER     A41765 17665621
         MVC   RECFM2(1),DCBRECFM                                A41765 17666721
         RETURN                                                         17680000
INHDEXT1 L     R2,ADULAB                                           UL0H 17710017
         MVI   LABSW,X'01'    SET LABSW TO IND. IN SYSUT1 HD PROC  UL0H 17740017
         B     0(R2)               GO TO IEBCULET                  UL0H 17770017
INHDEXT2 L     R2,ADULAB                                           UL0H 17800017
         MVI   LABSW,X'02'    SET LABSW TO IND. IN SYSUT2 HD PROC  UL0H 17830017
         B     0(R2)               GO TO IEBCULET                  UL0H 17860017
INTLEXT1 L     R2,ADULAB                                           UL0H 17890017
         MVI   LABSW,X'04'    SET LABSW TO IND. IN SYSUT1 TL PROC  UL0H 17920017
         B     0(R2)               GO TO IEBCULET                  UL0H 17950017
INTLEXT2 L     R2,ADULAB                                           UL0H 17980017
         MVI   LABSW,X'08'    SET LABSW TO IND. IN SYSUT2 TL PROC  UL0H 18010017
         B     0(R2)               GO TO IEBCULET                  UL0H 18040017
INEOD1   NI    DASET1+44,X'00'                                          18080000
         MVI   EOD1SW,1                                                 18140000
         MVI   NOEXTSW,X'00'  RE-INIT NO EXIT TO LAB PROC. RTN SW  UL0H 18150017
         TM    EOD2SW,1                                                 18160000
         BO    PICKNEX1                                                 18180000
         TM    BUFSW2,1            DOES BUFF2 HAVE RECORDS LEFT         18200000
         BZ    PRTLOG2               YES BRANCH                         18220000
READEXT2 SR    6,6                 ZERO REG6                            18240000
         L     8,BUFF2             LOAD BUFF2 ADDRESS                   18260000
         READ DECB2A,SF,DASET2,(8),'S',MF=E                             18280000
         CHECK DECB2A                                                   18300000
         TM    TERMSW,X'01'   DID USER INHDR/INTLR REQUEST TERM.   UL0H 18306017
         BO    USREQTE2       YES, BRANCH                          UL0H 18313017
         L     8,MAXBLLH2          LOAD MAXIMUM BLOCK SIZE              18320000
         LA    9,DASET2            GET DCB ADDRESS                      18340000
         TM    DEVTDCB(9),X'20'    IS THIS A DIRECT ACCESS DEVICE       18360000
         BO    INKEYEX2              YES BRANCH                         18380000
OFAG     L     9,DECB2A+16         GET IOB ADDRESS                      18400000
         LH    9,14(9)             OBTAIN CSW RESIDUAL COUNT            18420000
         SR    8,9                 GET NO. OF BYTES READ IN REG8        18440000
         STH   8,BLKLTH2           STORE ACTUAL BLOCK LENGTH            18460000
PRTLOG2  MVI   HICONCOD+1,8        PLACE RETURN CODE                    18480000
         LA    1,23                PRINT EXTRA RECORD MESSAGE           18500000
         L     15,PRINCONS         PRINT EXTRA RECORD MESSAGE           18520000
         BALR  14,15               PRINT EXTRA RECORD MESSAGE           18540000
         MVC   MYPRTARE(120),BLANKS    RIPPLE BLANKS IN PRINT AREA      18560000
         MVC   MYPRTARE+4(9),NAMEDDCN   MOVE "DDNAME = " CONSTANT       18580000
         MVC   MYPRTARE+13(8),NAMEDD2   MOVE ACTUAL DDNAME              18600000
         TM    CCADSORG,1               IS THIS A PDS                   18620000
         BZ    GO1                        NO BRANCH                     18640000
         MVC   MYPRTARE+23(14),MEMRNAME MOVE "MEMNAME = " CONSTANT      18660000
         MVC   MYPRTARE+37(8),FINDAREA  MOVE ACTUAL MEMBER NAME         18680000
GO1      LA    0,119                    PRINT LINE                      18700000
         LA    1,MYPRTARE               PRINT LINE                      18720000
         L     15,MYPRTCON              PRINT LINE                      18740000
         BALR  14,15                    PRINT LINE                      18760000
         LH    7,BLKLTH2                GET BLOCK SIZE                  18780000
         SR    7,6                      SUBTRACT LOGICAL RECS USED      18800000
         MVC   INPUTLOC(4),BUFF2        PUT ADDR FOR BLPRT SUBROUTINE   18820000
         LR    5,6                      SET RELATIVE POINTER FOR SUBROU 18840000
         BAL   4,BLPRT                  SUBROU-CONVERT AND PRINT HEX    18860000
         B     READEXT2                 ANYMORE EXTRA RECORDS           18880000
INKEYEX2 SR    15,15               CLEAR REG15                          18900000
         IC    15,DCBKL2+3         GET KEY LENGTH FOR DATA SET 2        18920000
         AR    8,15                ADD KEY LENGTH TO BLOCK SIZE         18940000
         B     OFAG                                                     18960000
PICKNEX1 TM    CCADSORG,1                                               18980000
         BZ    BEFNREND       NO, BRANCH                           UL0H 19000017
         B     GETMEMB                                                  19020000
INEOD2   NI    DASET2+44,X'00'                                          19040000
         MVI   EOD2SW,1                                                 19100000
         MVI   NOEXTSW,X'00'  RE-INIT NO EXIT TO LAB PROC. RTN SW  UL0H 19110017
         TM    EOD1SW,1                                                 19120000
         BO    PICKNEX2                                                 19140000
         TM    BUFSW1,X'10'       TEST SYSUT1 JUST READ SWITCH          19160000
         BO    PRTLOG1            YES PRINT EXTRA RECORDS        A38747 19180021
         TM    BUFSW1,1            DOES BUFF1 HAVE RECORDS LEFT         19200000
         BZ    PRTLOG1               YES BRANCH                         19220000
READEXT1 SR    4,4                 ZERO REG4                            19240000
         L     8,BUFF1             GET BUFF1 ADDRESS                    19260000
         READ  DECB1A,SF,DASET1,(8),'S',MF=E                            19280000
         CHECK DECB1A                                                   19300000
         TM    TERMSW,X'01'   DID USER INHDR/INTLR REQUEST TERM.   UL0H 19306017
         BO    USREQTE2       YES, BRANCH                          UL0H 19313017
         L     8,MAXBLLH1         LOAD MAXIMUM BLOCK SIZE               19320000
         LA    9,DASET1            LOAD DCB ADDRESS                     19340000
         TM    DEVTDCB(9),X'20'    IS THIS A DIRECT ACCESS DEVICE       19360000
         BO    INKEYEX1              YES BRANCH                         19380000
OFAGG    L     9,DECB1A+16         GET IOB ADDRESS                      19400000
         LH    9,14(9)             OBTAIN CSW RESIDUAL COUNT            19420000
         SR    8,9                 GET NO. OF BYTES READ IN REG8        19440000
         STH   8,BLKLTH1           STORE ACTUAL BLOCK LENGTH            19460000
PRTLOG1  MVI   HICONCOD+1,8        PLACE RETURN CODE                    19480000
         LA    1,24                PRINT EXTRA RECORD MESSAGE           19500000
         L     15,PRINCONS         PRINT EXTRA RECORD MESSAGE           19520000
         BALR  14,15               PRINT EXTRA RECORD MESSAGE           19540000
         MVC   MYPRTARE(120),BLANKS    RIPPLE BLANKS IN PRINT AREA      19560000
         MVC   MYPRTARE+4(9),NAMEDDCN   MOVE "DDNAME = " CONSTANT       19580000
         MVC   MYPRTARE+13(8),NAMEDD1   MOVE ACTUAL DDNAME              19600000
         TM    CCADSORG,1               IS THIS A PDS                   19620000
         BZ    GO2                   NO BRANCH                          19640000
         MVC   MYPRTARE+23(14),MEMRNAME  MOVE "MEMNAME = " CONSTANT     19660000
         MVC   MYPRTARE+37(8),FINDAREA   MOVE ACTUAL MEMBER NAME        19680000
GO2      LA    0,119                    PRINT LINE                      19700000
         LA    1,MYPRTARE               PRINT LINE                      19720000
         L     15,MYPRTCON              PRINT LINE                      19740000
         BALR  14,15                    PRINT LINE                      19760000
         LH    7,BLKLTH1                GET BLOCK SIZE                  19780000
         SR    7,4                      SUBTRACT LOGICAL RECS USED      19800000
         MVC   INPUTLOC(4),BUFF1        PUT ADDR FOR BLPRT SUBROUTINE   19820000
         LR    5,4                      SET RELATIVE PTR FOR SUBROUTINE 19840000
         BAL   4,BLPRT             SUBROU-CONVERT AND PRINT HEX         19860000
         B     READEXT1            ANYMORE EXTRA RECORDS                19880000
INKEYEX1 L     15,KEYLTH           GET KEY LENGTH                       19900000
         AR    8,15                ADD KEY LENGTH TO BLOCK SIZE         19920000
         B     OFAGG                                                    19940000
PICKNEX2 TM    CCADSORG,1                                               19960000
         BZ    BEFNREND       NO, BRANCH                           UL0H 19980017
         B     GETMEMB                                                  20000000
*********************************************************************** 20001017
*        INITIALIZATION FOR USER INPUT TRAILER LABEL COMPARISON.      * 20002017
*********************************************************************** 20003017
BEFNREND TM    UEXIT,X'01'    HAS OPEN TAKEN USER LAB EXITS        UL0H 20004017
         BZ    NORMEND        NO, BRANCH                           UL0H 20005017
         MVI   LBSW,X'01'     SET SW TO IND. WILL GO FOR INPUT TL  UL0H 20006017
*                             LABEL COMPARISON.                         20007017
         MVC   CTR1(4),INTLCT1 SET CTR1 EQ NO. OF INPUT TRAILER LABUL0H 20008017
*                              PROCESSED FOR SYSUT1                     20009017
         MVC   CTR2(4),INTLCT2 SET CTR2 EQ NO. OF INPUT TRAILER LABUL0H 20010017
*                              PROCESSED FOR SYSUT2                     20011017
         MVC   SAREA1(4),INTL1 SAREA1 HAS ADDR. OF SYSUT1 INPUT TL UL0H 20012017
*                              LABEL SAVEAREA                           20013017
         MVC   SAREA2(4),INTL2 SAREA2 HAS ADDR. OF SYSUT2 INPUT TL UL0H 20014017
*                              LABEL SAVEAREA                           20015017
         MVC   LABMSG1+6(7),TL  INITIALIZE MESSAGE                 UL0H 20016017
         BAL   R9,LABPROC     BRANCH                               UL0H 20017017
         B     NORMEND        BRANCH                               UL0H 20018017
ABNOTERM L     R15,PRINCONS            LOAD PRINT MODULE         A48817 20018400
         BALR  R14,R15                PRINT MESSAGE              A48817 20018800
ABNOTER1 MVI   HICONCOD+1,12          SET COND. CODE             A48817 20020022
NORMEND  TM    VSSWT,X'02'    VS RECORD PROCESSED BY IEBCQSAM      VS0H 20026017
         BZ    NORMEND1       NO, BRANCH                           VS0H 20032017
         L     R2,DSET1       LOAD SYSUT1 DCB ADDRESS              VS0H 20038017
         L     R3,DSET2       LOAD SYSUT2 DCB ADDRESS              VS0H 20044017
         B     CFILE          BRANCH                               VS0H 20050017
NORMEND1 LA    R2,DASET1      LOAD SYSUT1 DCB ADDRESS              VS0H 20056017
         LA    R3,DASET2      LOAD SYSUT2 DCB ADDRESS              VS0H 20062017
CFILE    CLOSE ((R2))                  CLOSE NORMAL            @YA02529 20068002
         CLOSE ((R3))                  CLOSE NORMAL            @YA02529 20073002
         TM    VSSWT,X'02'    QSAM HAS BEEN USED FOR PROCESS     A27718 20078019
         BZ    FMSG                  IF NOT, BRANCH              A27718 20082019
         FREEPOOL  (2)                YES, FREEPOOL  SYSUT1      A27718 20086000
         FREEPOOL  (3)                YES, FREEPOOL  SYSUT2      A27718 20088000
FMSG     MVC   MYPRTARE(120),BLANKS  RIPPLE BLANKS IN PRINT AREA A27718 20094019
         MVC   MYPRTARE+4(46),EOJMESS                                   20100000
         TM    VSSWT,X'01'    VS RECORD PROC.AT PHYS. RCD LEVEL    VS0H 20108017
         BO    PHSCOV         YES, BRANCH                          VS0H 20116017
         L     R1,LORECO      LOAD TOTAL NO. OF LOGICAL RCD PROC.  VS0H 20124017
         B     CVTD                                                VS0H 20132017
PHSCOV   L     R1,PHRECO1     LOAD TOTAL NO. OF PHYS. RCD PROC.    VS0H 20141017
CVTD     CVD   R1,CONVTDEC                                         VS0H 20150017
         UNPK  PTAREA(8),CONVTDEC(8)                                    20160000
         OI    PTAREA+7,X'F0'                                           20180000
         MVC   MYPRTARE+50(8),PTAREA                                    20200000
         LA    0,119                                                    20220000
         LA    1,MYPRTARE                                               20240000
         L     15,MYPRTCON                                              20260000
         BALR  14,15                                                    20280000
         LA    7,PRINTOUT                                               20300000
         CLOSE ((7))                                                    20320000
         FREEPOOL (7)               FREEPOOL SYSPRINT DCB        A50947 20320421
         TM    EXIT1SW,X'01'  IS THERE AN USER INHDR               UL0H 20321017
         BZ    DELET1         NO,BRANCH                            UL0H 20322017
         DELETE  EPLOC=PARALIST    YES, DELETE USER INHDR          UL0H 20323017
DELET1   TM    EXIT3SW,X'01'  IS THERE AN USER INTLR               UL0H 20324017
         BZ    DELET2         NO, BRANCH                           UL0H 20325017
         DELETE  EPLOC=PARALIST+8    YES,DELETE USER INTLR         UL0H 20326017
DELET2   TM    ERRORSW,X'01'  IS THERE AN USER ERROR ROUTINE       UL0H 20327017
         BZ    DELET3         NO, BRANCH                           UL0H 20328017
         DELETE  EPLOC=PARALIST+16   YES, DELETE USER ERROR RTN    UL0H 20329017
DELET3   TM    PRECOMSW,X'01' IS THERE AN USER PRECOMP ROUTINE     UL0H 20330017
         BZ    FREE1          NO, BRANCH                           UL0H 20331017
         DELETE  EPLOC=PARALIST+24   YES, DELETE USER PRECOMP      UL0H 20332017
FREE1    L     R1,INHD1       GET ADDR OF SYSUT1 INHD LAB SAVEAREA UL0H 20333017
         LTR   R1,R1          IS IT ZERO                           UL0H 20334017
         BC    8,FREE2        YES, BRANCH                          UL0H 20335017
         FREEMAIN R,LV=640,A=(R1)                                  UL0H 20336017
FREE2    L     R1,INHD2       GET ADDR OF SYSUT2 INHD LAB SAVEAREA UL0H 20337017
         LTR   R1,R1          IS IT ZERO                           UL0H 20338017
         BC    8,FREE3        YES, BRANCH                          UL0H 20339017
         FREEMAIN  R,LV=640,A=(R1)                                 UL0H 20340017
FREE3    L     R1,INTL1       GET ADDR OF SYSUT1 INTL LAB SAVEAREA UL0H 20341017
         LTR   R1,R1          IS IT ZERO                           UL0H 20342017
         BC    8,FREE4        YES, BRANCH                          UL0H 20343017
         FREEMAIN  R,LV=640,A=(R1)                                 UL0H 20344017
FREE4    L     R1,INTL2       GET ADDR OF SYSUT2 INTL LAB SAVEAREA UL0H 20345017
         LTR   R1,R1          IS IT ZERO                           UL0H 20346017
         BC    8,FREE5        YES, BRANCH                          VS0H 20347017
         FREEMAIN R,LV=640,A=(R1)                                  UL0H 20348017
FREE5    L     R1,BUFF1                                            VS0H 20349017
         LTR   R1,R1          WAS BUFFER GOTTEN FOR SYSUT1         VS0H 20350017
         BC    8,FREE6        NO, BRANCHH                          VS0H 20351017
         L     R0,LBUFF1      YES, GET THE LENGTH OF BUFFER        VS0H 20352017
         FREEMAIN  R,LV=(R0),A=(R1)                                UL0H 20353017
FREE6    L     R1,BUFF2                                            VS0H 20354017
         LTR   R1,R1          WAS BUFFER GOTTEN FOR SYSUT2         VS0H 20355017
         BC    8,GOBACK       NO, BRANCH                           VS0H 20356017
         L     R0,LBUFF2      TES, GET THE LENGTH OF BUFFER        VS0H 20357017
         FREEMAIN  R,LV=(R0),A=(R1)                                UL0H 20358017
GOBACK   LM    13,14,SAVE1315                                           20360000
         LH    R15,HICONCOD                                        UV0H 20370017
         RETURN (2,12)                                                  20380000
EOJMESS  DC    CL32'END OF JOB-TOTAL NUMBER OF RECOR'                   20400000
         DC    CL14'DS COMPARED = '                                     20420000
ERRCOMUD LA    1,5                 USER DATA COMPARISON FAILURE         20440000
         L     15,PRINCONS                                              20460000
         BALR  14,15                                                    20480000
         MVI   HICONCOD+1,8        ERROR MESSAGE HAS BEEN WRITTEN       20500000
         MVC   MYPRTARE(120),BLANKS    RIPPLE BLANKS IN PRINT AREA      20520000
         MVC   MYPRTARE+4(9),NAMEDDCN                                   20540000
         MVC   MYPRTARE+13(8),NAMEDD1                                   20560000
         MVC   MYPRTARE+23(14),MEMRNAME                                 20580000
         L     8,BUFF1                                                  20600000
         AR    8,4                                                      20620000
         MVC   MYPRTARE+37(8),0(8)                                      20640000
         LA    0,119                                                    20660000
         LA    1,MYPRTARE                                               20680000
         L     15,MYPRTCON                                              20700000
         BALR  14,15                                                    20720000
         LH    7,USERDAL                                                20740000
         LR    5,4                                                      20760000
         AH    5,TWELVE                                                 20780000
         MVC   INPUTLOC(4),BUFF1                                        20800000
         STM   2,4,SAVEREG2                                             20820000
         BAL   4,BLPRT1            BRANCH TO CONVERT USER DATA          20840000
         LM    2,4,SAVEREG2                                             20860000
         MVC   MYPRTARE(120),BLANKS    RIPPLE BLANKS IN PRINT AREA      20880000
         MVC   MYPRTARE+4(9),NAMEDDCN                                   20900000
         MVC   MYPRTARE+13(8),NAMEDD2                                   20920000
         MVC   MYPRTARE+23(14),MEMRNAME                                 20940000
         L     8,BUFF2             LOAD BUFFER2 ADDRESS                 20960000
         AR    8,6                 MOVE POINTER TO POINT AT MEMBER NAME 20980000
         MVC   MYPRTARE+37(8),0(8)                                      21000000
         LA    0,119                                                    21020000
         LA    1,MYPRTARE                                               21040000
         L     15,MYPRTCON                                              21060000
         BALR  14,15                                                    21080000
         LH    7,USERDAL2                                               21100000
         LR    5,6                                                      21120000
         AH    5,TWELVE                                                 21140000
         MVC   INPUTLOC(4),BUFF2                                        21160000
         STM   2,4,SAVEREG2                                             21180000
         BAL   4,BLPRT1            BRANCH TO CONVERT USER DATA          21200000
         LM    2,4,SAVEREG2                                             21220000
         B     RETERRCU                                                 21240000
PRNAL1   LA    1,6                 ALIAS MISSING FROM SET 2             21260000
         L     15,PRINCONS                                              21280000
         BALR  14,15                                                    21300000
         MVI   HICONCOD+1,8        ERROR MESSAGE HAS BEEN WRITTEN       21320000
         MVC   MYPRTARE(120),BLANKS    RIPPLE BLANKS IN PRINT AREA      21340000
         MVC   MYPRTARE+4(9),NAMEDDCN                                   21360000
         MVC   MYPRTARE+13(8),NAMEDD2                                   21380000
         MVC   MYPRTARE+23(14),ALIANAME                                 21400000
         MVC   MYPRTARE+37(8),0(8)                                      21420000
         LA    0,119                                                    21440000
         LA    1,MYPRTARE                                               21460000
         L     15,MYPRTCON                                              21480000
         BALR  14,15                                                    21500000
         B     RETFRPR1                                                 21520000
PRNTN1   LA    1,7                 TRUE NAME MISSING FROM SET 2         21540000
         L     15,PRINCONS                                              21560000
         BALR  14,15                                                    21580000
         MVI   HICONCOD+1,8        ERROR MESSAGE HAS BEEN WRITTEN       21600000
         MVC   MYPRTARE(120),BLANKS    RIPPLE BLANKS IN PRINT AREA      21620000
         MVC   MYPRTARE+4(9),NAMEDDCN                                   21640000
         MVC   MYPRTARE+13(8),NAMEDD2                                   21660000
         MVC   MYPRTARE+23(14),MEMRNAME                                 21680000
         L     8,BUFF1                                                  21700000
         AR    8,4                                                      21720000
         MVC   MYPRTARE+37(8),0(8)                                      21740000
         LA    0,119                                                    21760000
         LA    1,MYPRTARE                                               21780000
         L     15,MYPRTCON                                              21800000
         BALR  14,15                                                    21820000
         B     RETFRPR1                                                 21840000
PRNAL2   LA    1,8                 ALIAS MISSING FROM SET 1             21860000
         L     15,PRINCONS                                              21880000
         BALR  14,15                                                    21900000
         MVI   HICONCOD+1,8        ERROR MESSAGE HAS BEEN WRITTEN       21920000
         MVC   MYPRTARE(120),BLANKS    RIPPLE BLANKS IN PRINT AREA      21940000
         MVC   MYPRTARE+4(9),NAMEDDCN                                   21960000
         MVC   MYPRTARE+13(8),NAMEDD1                                   21980000
         MVC   MYPRTARE+23(14),ALIANAME                                 22000000
         MVC   MYPRTARE+37(8),0(8)                                      22020000
         LA    0,119                                                    22040000
         LA    1,MYPRTARE                                               22060000
         L     15,MYPRTCON                                              22080000
         BALR  14,15                                                    22100000
         B     DIRBUF2S                                                 22120000
PRNTN2   LA    1,9                 TRUE NAME MISSING FROM SET 1         22140000
         L     15,PRINCONS                                              22160000
         BALR  14,15                                                    22180000
         MVI   HICONCOD+1,8        ERROR MESSAGE HAS BEEN WRITTEN       22200000
         MVC   MYPRTARE(120),BLANKS    RIPPLE BLANKS IN PRINT AREA      22220000
         MVC   MYPRTARE+4(9),NAMEDDCN                                   22240000
         MVC   MYPRTARE+13(8),NAMEDD1                                   22260000
         MVC   MYPRTARE+23(14),MEMRNAME                                 22280000
         L     9,BUFF2                                                  22300000
         AR    9,6                                                      22320000
         MVC   MYPRTARE+37(8),0(9)                                      22340000
         LA    0,119                                                    22360000
         LA    1,MYPRTARE                                               22380000
         L     15,MYPRTCON                                              22400000
         BALR  14,15                                                    22420000
         B     DIRBUF2S                                                 22440000
BOSETTNM LA    1,10                TRUE NAMES MISSING- BOTH SETS        22460000
         B     ABNOTERM                                                 22520000
ERRKEY   LA    1,11                KEY LENGTHS ARE NOT EQUAL            22540000
         B     ABNOTERM                                                 22600000
ERRFMT   LA    1,12                ILLEGAL RECORD FORMAT                22620000
         B     ABNOTERM                                                 22680000
ERRMELEN LA    1,14                FIXED RECORD LENGTHS UNEQUAL         22780000
         B     ABNOTERM                                                 22840000
ERRFMT2  LA    1,15                SETS HAVE DIFFERENT FORMATS          22860000
         B     ABNOTERM                                                 22920000
ERRMRET1 LA    R1,17          INVALID LRECL ON V-TYPE RECORD     A26556 22980019
         B     ABNOTERM                                                 23080000
ERRMRET2 LA    1,18                ERROR RETURN FROM FIND MACRO         23100000
         B     ABNOTERM                                                 23160000
INPERR   LA    R1,19          INVALID BLKSI ON V-TYPE RECORD     A26556 23180019
         B     ABNOTERM                                                 23240000
ERRL     TM    VSSWT,X'01'    VS-TYPE RCD PROC BY BSAM             VS0H 23242017
         BO    ERRPL          YES, BRANCH                          VS0H 23244017
         LA    R1,55          CORRESP LITTLE LL NOT EQ             VS0H 23246017
         B     WRTMSG         BRANCH                               VS0H 23248017
ERRPL    LA    R1,54          CORRESP. LL NOT EQ                   VS0H 23250017
WRTMSG   L     R15,PRINCONS                                        VS0H 23252017
         BALR  R14,R15             PRINT                           VS0H 23254017
         CLI   HICONCOD+1,X'08'    RC ALREADY GT 8 ?           @ZA10944 23256000
         BH    *+8                 YES, IGNORE NEW RC          @ZA10944 23256400
         MVI   HICONCOD+1,X'08'    SET RC=08                   @ZA10944 23256800
         B     ERRECLTH       BRANCH                               VS0H 23257017
ERRLEREC LA    1,20                RECORD LENGTHS ARE UNEQUAL           23260000
         B     ABNOTERM                                                 23320000
ERRCOMP  TM    KEYCOMSW,1                                               23340000
         MVI   HICONCOD+1,8        ERROR MESSAGE HAS BEEN WRITTEN       23360000
         BO    SETBK                                                    23380000
         LA    1,21                RECORDS ARE NOT EQUAL                23400000
         L     15,PRINCONS                                              23420000
         BALR  14,15                                                    23440000
ERRECLTH MVC   MYPRTARE(120),BLANKS                                VS0H 23460017
         MVC   MYPRTARE+4(9),NAMEDDCN                                   23480000
         MVC   MYPRTARE+13(8),NAMEDD1                                   23500000
         TM    CCADSORG,1                                               23520000
         BZ    PRNBSRE1                                                 23540000
         MVC   MYPRTARE+23(14),MEMRNAME                                 23560000
         MVC   MYPRTARE+37(8),FINDAREA                                  23580000
PRNBSRE1 LA    0,119                                                    23600000
         LA    1,MYPRTARE                                               23620000
         L     15,MYPRTCON                                              23640000
         BALR  14,15                                                    23660000
         MVC   MYPRTARE(120),BLANKS    RIPPLE BLANKS IN PRINT AREA      23680000
         TM    VSSWT,X'02'    WAS DATA SET PROCESSED BY QSAM       VS0H 23686017
         BO    PRNLSER1       YES, BRANCH                          VS0H 23692017
         MVC   MYPRTARE+4(25),PHYSRENU                                  23700000
         L     1,PHRECO1                                                23720000
         CVD   1,CONVTDEC                                               23740000
         UNPK  PTAREA(8),CONVTDEC(8)                                    23760000
         OI    PTAREA+7,X'F0'                                           23780000
         MVC   MYPRTARE+29(8),PTAREA                                    23800000
         MVC   MYPRTARE+39(47),LOGWIPHY                                 23820000
         LH    1,LOREPP1                                                23840000
         CVD   1,CONVTDEC                                               23860000
         UNPK  PTAREA(8),CONVTDEC(8)                                    23880000
         OI    PTAREA+7,X'F0'                                           23900000
         MVC   MYPRTARE+86(8),PTAREA                                    23920000
         B     PRTN1          BRANCH                               VS0H 23924017
PRNLSER1 MVC   MYPRTARE+4(22),LOGWIPHY                             VS0H 23927017
         MVC   MYPRTARE+26(2),EQSIGN                               VS0H 23930017
         L     R1,LORECO                                           VS0H 23933017
         AH    R1,ONE                                              VS0H 23936017
         CVD   R1,CONVTDEC                                         VS0H 23939017
         UNPK  PTAREA(8),CONVTDEC(8)                               VS0H 23942017
         OI    PTAREA+7,X'F0'                                      VS0H 23945017
         MVC   MYPRTARE+29(8),PTAREA                               VS0H 23948017
PRTN1    LA    R0,119                                              VS0H 23951017
         LA    1,MYPRTARE                                               23960000
         L     15,MYPRTCON                                              23980000
         BALR  14,15                                                    24000000
         LH    7,RECLTH                                                 24020000
         MVC   INPUTLOC(4),BUFF1                                        24040000
         LR    5,4                                                      24100000
PRBUF1   STM   2,4,SAVEREG2                                             24120000
         BAL   4,BLPRT                                                  24140000
         LM    2,4,SAVEREG2                                             24160000
         MVC   MYPRTARE(120),BLANKS    RIPPLE BLANKS IN PRINT AREA      24180000
         MVC   MYPRTARE+4(9),NAMEDDCN                                   24200000
         MVC   MYPRTARE+13(8),NAMEDD2                                   24220000
         TM    CCADSORG,1                                               24240000
         BZ    PRNBSRE2                                                 24260000
         MVC   MYPRTARE+23(14),MEMRNAME                                 24280000
         MVC   MYPRTARE+37(8),FINDAREA                                  24300000
PRNBSRE2 LA    0,119                                                    24320000
         LA    1,MYPRTARE                                               24340000
         L     15,MYPRTCON                                              24360000
         BALR  14,15                                                    24380000
         MVC   MYPRTARE(120),BLANKS    RIPPLE BLANKS IN PRINT AREA      24400000
         TM    VSSWT,X'02'    WAS DATA SET PROCESSED BY QSAM       VS0H 24406017
         BO    PRNLSER2       YES, BRANCH                          VS0H 24412017
         MVC   MYPRTARE+4(25),PHYSRENU                                  24420000
         L     1,PHRECO2                                                24440000
         CVD   1,CONVTDEC                                               24460000
         UNPK  PTAREA(8),CONVTDEC(8)                                    24480000
         OI    PTAREA+7,X'F0'                                           24500000
         MVC   MYPRTARE+29(8),PTAREA                                    24520000
         MVC   MYPRTARE+39(47),LOGWIPHY                                 24540000
         LH    1,LOREPP2                                                24560000
         CVD   1,CONVTDEC                                               24580000
         UNPK  PTAREA(8),CONVTDEC(8)                                    24600000
         OI    PTAREA+7,X'F0'                                           24620000
         MVC   MYPRTARE+86(8),PTAREA                                    24640000
         B     PRTN2          BRANCH                               VS0H 24644017
PRNLSER2 MVC   MYPRTARE+4(22),LOGWIPHY                             VS0H 24647017
         MVC   MYPRTARE+26(2),EQSIGN                               VS0H 24650017
         L     R1,LORECO                                           VS0H 24653017
         AH    R1,ONE                                              VS0H 24656017
         CVD   R1,CONVTDEC                                         VS0H 24659017
         UNPK  PTAREA(8),CONVTDEC(8)                               VS0H 24662017
         OI    PTAREA+7,X'F0'                                      VS0H 24665017
         MVC   MYPRTARE+29(8),PTAREA                               VS0H 24668017
PRTN2    LA    R0,119                                              VS0H 24671017
         LA    1,MYPRTARE                                               24680000
         L     15,MYPRTCON                                              24700000
         BALR  14,15                                                    24720000
         LH    7,RECLH2            LOAD LOGICAL RECORD LENGTH           24740000
         MVC   INPUTLOC(4),BUFF2                                        24760000
         LR    5,6                                                      24820000
PRBUF2   STM   2,4,SAVEREG2                                             24840000
         BAL   4,BLPRT                                                  24860000
         LM    2,4,SAVEREG2                                             24880000
         TM    ERRORSW,1           IS THERE A USER ERROR ROUTINE        24900000
         BZ    ADD1ERRC              NO                                 24920000
         LINK  EPLOC=PARATBLY,PARAM=(DASET1,DASET2)                     24940000
         CH    15,EIGHT                                                 24960000
         BNH   PRNEXCOM                                                 24980000
         L     3,LORECO                                                 25000000
         AH    3,ONE                                                    25020000
         ST    3,LORECO                                                 25040000
         LA    1,25               USER REQUESTED TERMINATION       SA0I 25060018
         STH   15,HICONCOD     STORE USERS RETURN CODE                  25080000
         L     15,PRINCONS                                              25100000
         BALR  14,15                                                    25120000
         B     NORMEND                                                  25140000
PRNEXCOM CH    15,HICONCOD                                              25160000
         BL    ENDCOMP                                             VS0H 25180017
         STH   15,HICONCOD                                              25200000
         B     ENDCOMP        BRANCH                               VS0H 25220017
ADD1ERRC LH    7,ERRCO                                                  25240000
         AH    7,ONE                                                    25260000
         STH   7,ERRCO                                                  25280000
COM10    CH    7,TEN               TEN CONSECUTIVE ERRORS               25300000
         BNE   ENDCOMP                                             VS0H 25320017
         TM    CCADSORG,1                                               25340000
         BZ    TERM10                                                   25360000
         LA    1,27                TEN CONSECUTIVE ERRORS- CONTINUE     25380000
         L     15,PRINCONS                                              25400000
         BALR  14,15                                                    25420000
         MVI   ERRCO+1,0                                                25440000
         L     3,LORECO                                                 25460000
         AH    3,ONE                                                    25480000
         ST    3,LORECO                                                 25500000
         B     GETMEMB                                                  25520000
TERM10   L     3,LORECO            GET LOGICAL RECORD COUNT             25540000
         LA    3,1(3)              ADD 1 TO RECORD COUNT                25560000
         ST    3,LORECO            STORE LOGICAL RECORD COUNT           25580000
         LA    1,27               LOAD RELATIVE ADDR OF MESSAGE    SA0I 25600018
         B     ABNOTERM                                                 25660000
SETBK    LA    1,22                KEYS ARE NOT EQUAL                   25680000
         L     15,PRINCONS                                              25700000
         BALR  14,15                                                    25720000
         MVC   MYPRTARE(120),BLANKS    RIPPLE BLANKS IN PRINT AREA      25740000
         MVC   MYPRTARE+4(25),PHYSRENU   MOVE MESSAGE                   25760000
         L     1,PHRECO1                 LOAD NUMBER OF PHY. RECORDS    25780000
         CVD   1,CONVTDEC                                               25800000
         UNPK  PTAREA(8),CONVTDEC(8)                                    25820000
         OI    PTAREA+7,X'F0'                                           25840000
         MVC   MYPRTARE+29(8),PTAREA     NOW ACTUAL NUMBER IN PRINT AR. 25860000
         LA    0,119                     GO PRINT MESSAGE               25880000
         LA    1,MYPRTARE                                               25900000
         L     15,MYPRTCON                                              25920000
         BALR  14,15                                                    25940000
         LH    7,KEYERCT           ADD 1 TO COUNT OF CONSECUTIVE NON    25960000
         LA    7,1(7)                COMPARES OF KEYS                   25980000
         STH   7,KEYERCT                                                26000000
         B     COM10                                                    26020000
NOTOPEN  L     15,NODDNAM         LOAD ADDR OF MESSAGE                  26040000
         MVC   7(8,15),DDNAMDCB(1)     MOVE DDNAME INTO MESSAGE         26060000
         LA    1,29               GO PRINT MESSAGE                      26080000
         L     15,PRINCONS                                              26100000
         BALR  14,15                                                    26120000
         MVI   HICONCOD+1,X'12'     LOAD RETURN CODE OF TWELVE   A44317 26140021
         B     GOBACK             RESTORE REGS AND RETURN               26160000
STOREC2  MVC   RECLH2(2),RECLTH   MAKE SURE SME LENGTH RECORDS          26300000
         B     ACTUCOMP           GO COMPARE RECORDS                    26320000
*********************************************************************** 26340000
*   THIS ROUTINE PRINTS OUT A CHARACTER REPRESENTATION OF INTERNAL      26360000
* HEXADECIMAL DATA (I.E. 60 INTERNAL BYTES APPEAR AS 120 EBCDIC         26380000
* CHARACTERS)                                                           26400000
BLPRT1   LTR   7,7                 IS THERE ANY USER DATA               26420000
         BC    8,JUSPR               NO-BRANCH                          26440000
BLPRT    MVC   MYPRTARE(120),BLANKS    RIPPLE BLANKS IN PRINT AREA      26460000
         L     RLOC,INPUTLOC       INITIALIZE                           26480000
         AR    RLOC,5                CONVERSION                         26500000
         LA    ROUT,MYPRTARE           ROUTINE                          26520000
         C     7,SIXTY                                                  26540000
         BH    GRTHSXTY                                                 26560000
         LR    INLEN,7                                                  26580000
         B     BALTOCON                                                 26600000
GRTHSXTY L     INLEN,SIXTY                                              26620000
         MVI   CONVSW,1                                                 26640000
BALTOCON ST    6,SAVEREG6                                               26660000
         ST    R9,SAVEREG9                                         VS0H 26670017
         BAL   14,FLDCONV1                                              26680000
         L     6,SAVEREG6                                               26700000
         L     R9,SAVEREG9                                         VS0H 26710017
GOPRI    LA    0,119                                                    26720000
         LA    1,MYPRTARE                                               26740000
         L     15,MYPRTCON                                              26760000
         BALR  14,15                                                    26780000
         TM    CONVSW,1                                                 26800000
         BZ    0(4)                                                     26820000
         MVI   CONVSW,0                                                 26840000
         S     7,SIXTY                                                  26860000
         A     5,SIXTY                                                  26880000
         B     BLPRT                                                    26900000
JUSPR    MVC   MYPRTARE+4(4),MYPRTARE+3   MOVE FOUR BLANKS INTO PR AREA 26920000
         MVC   MYPRTARE+8(40),NOUSER      MOVE MESSAGE INTO AREA        26940000
         B     GOPRI                      PRINT AND GO BACK             26960000
NOUSER   DC    CL32'NO USER DATA IN PREVIOUS DIRECTO'                   26980000
         DC    CL8'RY ENTRY'                                            27000000
*********************************************************************** 27020000
*********************************************************************** 27040000
*    CONVERSION ROUTINE                                                 27060000
*        INLEN = NUMBER OF BYTES TO BE CONVERTED                        27080000
*        RLOC = INPUT LOCATION                                          27100000
*        ROUT = OUTPUT LOCATION                                         27120000
FLDCONV1 STH   INLEN,LENSAV                                             27140000
         ST    ROUT,OUTSAV                                              27160000
FC1      SR    TEMP1,TEMP1                                              27180000
         IC    TEMP1,0(RLOC)                                            27200000
         LR    TEMP2,TEMP1                                              27220000
         SRL   TEMP1,4                                                  27240000
         STC   TEMP1,0(ROUT)       SEPARATE THE 4-BIT CHARACTERS        27260000
         STC   TEMP2,1(ROUT)         IN EACH BYTE                       27280000
         BCT   INLEN,FC2                                                27300000
         B     FC3                                                      27320000
FC2      AH    ROUT,TWO                                                 27340000
         AH    RLOC,ONE                                                 27360000
         B     FC1                                                      27380000
FC3      LH    INLEN,LENSAV                                             27400000
         L     ROUT,OUTSAV                                              27420000
FC5      SLL   INLEN,1                                                  27440000
         BCTR  INLEN,0                                                  27460000
         NI    0(ROUT),X'0F'                                            27480000
         EX    INLEN,FCMZ                                               27500000
         EX    INLEN,FCTR                                               27520000
         B     0(14)                                                    27540000
FCLIST   DC    C'0123456789'                                            27560000
         DC    C'ABCDEF'                                                27580000
FCMZ     MVZ   1(1,ROUT),0(ROUT)                                        27600000
FCTR     TR    0(1,ROUT),FCLIST                                         27620000
*********************************************************************** 27640000
*     CONSTANT AREA                                                     27660000
NAMEDDCN DC    CL9'DDNAME = '                                           27680000
MEMRNAME DC    CL14'MEMBER NAME = '                                     27700000
ALIANAME DC    CL14' ALIAS NAME = '                                     27720000
PHYSRENU DC    CL25'PHYSICAL RECORD NUMBER = '                          27740000
LOGWIPHY DC    CL32'LOGICAL RECORD NUMBER WITHIN PHY'                   27760000
         DC    CL15'SICAL RECORD = '                                    27780000
PRINCONS DC    V(JPRINTRT)                                              27800000
MYPRTCON DC    V(ZZPR)                                                  27820000
NODDNAM  DC    A(DDERROR1)        WHERE UNOPENED DDNAME GOES            27840000
BUFSW1   DC    X'01'               SWITCH - IF BUFFER 1 EMPTY SET = 1   27860000
BUFSW2   DC    X'01'               SWITCH - IF BUFFER 2 EMPTY SET = 1   27880000
ONE      DC    H'1'                                                     27900000
TWO      DC    H'2'                                                     27920000
FOUR     DC    H'4'                                                     27940000
EIGHT    DC    H'8'                                                     27960000
TEN      DC    H'10'                                                    27980000
TWELVE   DC    H'12'                                                    28000000
SIXTY    DC    F'60'                                                    28020000
TWOFS    DC    F'256'                                                   28040000
MASK1    DC    F'31'                                                    28060000
MASK2    DC    F'96'               MASK FOR 'C' CHAR OF TTRC'S          28080000
OOOOFFFF DC    X'0000FFFF'      BLOCK COMPARISON CONSTANT               28100000
OOO1OOFE DC    X'000100FE'         BLOCK COMPARISON CONSTANT            28120000
ALLFS    DC    8X'FF'                                                   28140000
SYMREG1  EQU   3                                                        28160000
REG3     EQU   3                                                   9314 28165013
REG4     EQU   4                                                   9314 28170013
OUTLEN   EQU   8                                                   9314 28175013
RLOC     EQU   2                                                        28180000
ROUT     EQU   3                                                        28200000
INLEN    EQU   8                                                        28220000
TEMP1    EQU   9                                                        28240000
TEMP2    EQU   6                                                        28260000
SAVEREG2 DC    F'0'                                                     28280000
SAVEREG3 DC    F'0'                                                     28300000
SAVEREG4 DC    F'0'                                                     28320000
SAVEREG6 DC    F'0'                                                     28340000
SAVEREG9 DC    F'0'                                                VS0H 28346017
CSAVE    DS    7F                                                  VS0H 28352017
ERRDCB   DC    X'00'           BLKSI,LRECL ERROR BIT             A41765 28354021
DIROPOK  DC    X'00'              DIRECTORY BLOCK 'READ SWITCHES'       28360000
EOD1SW   DC    X'00'              SET = TO 1 WHEN EOD READ ON PDS1      28380000
         CNOP  2,4                 ALIGN TO HLFWRD FOR BL. BYTE  A41765 28390021
EOD2SW   DC    X'00'              SET = TO 1 WHEN EOD READ ON PDS2      28400000
BLANKS   DC    X'40'              USED TO RIPPLE BLANKS IN PRINT AREA   28420000
MYPRTARE DS    30F                 PRINT AREA                           28440000
PARATABL DS    0D                                                       28460000
        DC   D'0'                                                       28480000
PARATBLX DC    D'0'                                                     28500000
PARATBLY DC    D'0'                                                     28520000
PARATBLZ DC    D'0'                                                     28540000
NAMEDD1  DC    D'0'                CONTAINS DDNAME FOR SET 1            28560000
NAMEDD2  DC    D'0'                CONTAINS DDNAME FOR SET 2            28580000
PTAREA   DC    D'0'                WORK AREA- HOLDS UNPACKED NUMBER     28600000
CONVTDEC DC    D'0'                WORK AREA- USED FOR CONVERTING       28620000
FINDAREA DC    2F'0'               CONTAINS NAME FOR FIND MACRO         28640000
MAXBLLH1 DC    F'0'                MAXIMUM BLOCK SIZE - DATA SET 1      28660000
MAXBLLH2 DC    F'0'                MAXIMUM BLOCK SIZE - DATA SET 2      28680000
KEYLTH   DC    F'0'                KEY LENGTH FOR DATA SET 1            28700000
DCBKL2   DC    F'0'                KEY LENGTH FOR DATA SET 2            28720000
TNTABLEL DC    F'0'                LENGTH OF TRUE NAME TABLE            28780000
TTRTABLL DC    F'0'                LENGTH OF TTR TABLES                 28800000
NOOFTN   DC    F'0'                NUMBER OF TRUE NAMES                 28820000
NOTNREAD DC    F'0'                NO. OF TRUE NAMES READ X 8.          28840000
TNSET    DC    F'0'                CONTAINS ADDRESS OF TRUE NAME TABLE  28860000
TTRSET1  DC    F'0'                CONTAINS ADDRESS OF TTR TABLE-DS1    28880000
TTRSET2  DC    F'0'                CONTAINS ADDRESS OF TTR TABLE-DS2    28900000
PHRECO1  DC    F'0'                PHYSICAL RECORD COUNTER-DATA SET 1   28940000
PHRECO2  DC    F'0'                PHYSICAL RECORD COUNTER-DATA SET 2   28960000
OUTSAV   DC    F'0'                                                     28980000
BLKLTH1  DC    H'0'                PHYSICAL BLOCK LENGTH - DS1          29020000
BLKLTH2  DC    H'0'                PHYSICAL BLOCK LENGTH - DS2          29040000
TTRLTH   DC    H'0'                WORK AREA                            29100000
TTRLTH2  DC    H'0'                TTR LTH FOR MEMBERS OF SYSUT2        29120000
USERDAL  DC    H'0'                WORK AREA                            29140000
USERDAL2 DC    H'0'                                                     29160000
ERRCO    DC    H'0'                ERROR COUNTER                        29180000
KEYERCT  DC    H'0'                'KEY' ERROR COUNTER                  29200000
LOREPP1  DC    H'0'                LOGICAL RECORD PER PHYSICAL RECORD   29220000
LOREPP2  DC    H'0'                  COUNTERS FOR DATA SETS 1 AND 2     29240000
LENSAV   DC    H'0'                                                     29260000
SWFORBP1 DC    X'00'               SWITCH-BPAM DS1-SET DURING DCB EXIT  29280000
SWFORBP2 DC    X'00'               SWITCH-BPAM DS2-SET DURING DCB EXIT  29300000
TNMIS1SW DC    X'00'               SWITCH - IF TN MISSING FROM SET 1.=1 29320000
TNMIS2SW DC    X'00'               SWITCH - IF TN MISSING FROM SET 2.=1 29340000
TABLE1SW DC    X'00'               SWITCH -USE TTR TABLE 1 IF = 1.      29360000
TABLE2SW DC    X'00'               SWITCH -USE TTR TABLE 2 IF = 1       29380000
KSWT     DC    X'00'               SWITCH-IF KEYS PRESENT SET = 1.      29400000
VSWT     DC    X'00'               SWITCH - IF V-TYPE FORMAT SET = 1.   29420000
FSWT     DC    X'00'               SWITCH - IF F-TYPE FORMAT SET = 1.   29440000
RECFM1   DC    X'00'               CONTAINS RECORD FORMAT - DS1         29460000
RECFM2   DC    X'00'               CONTAINS RECORD FORMAT - DS2         29480000
ONETIME  DC    X'00'               SWITCH-SET = 1 AFTER FIRST FIND.     29500000
ENDMEMBS DC    X'00'               SWITCH-NO MEMBERS LEFT IF = 1.       29520000
KEYCOMSW DC    X'00'               SWITCH-SET=1 WHEN KEYS ARE COMPARED  29540000
ERRORSW  DC    X'00'                                                    29600000
PRECOMSW DC    X'00'                                                    29620000
CONVSW   DC    X'00'               SWITCH- USED FOR CONVERSION ROUTINE  29640000
EQSIGN   DC    CL2'= '                                             VS0H 29644517
EIGHTY   DC    F'80'                                               UL0H 29645417
ADQSAM   DC    V(QSAM)                                             UL0H 29646317
ADULAB   DC    V(USERLAB)                                          UL0H 29647217
SAVE9    DC    F'0'                                                UL0H 29648117
CTR1     DC    F'0'           CONTAIN NO. OF LAB ON SYSUT1 TO BE   UL0H 29649017
*                             COMPARED                             UL0H 29649917
CTR2     DC    F'0'           CONTAIN NO. OF LAB ON SYSUT2 TO BE   UL0H 29650817
*                             COMPARED                             UL0H 29651717
SAREA1   DC    F'0'           CONTAIN ADDR. OF SYSUT1 LAB SAVEAREA UL0H 29652617
SAREA2   DC    F'0'           CONTAIN ADDR. OF SYSUT2 LAB SAVEAREA UL0H 29653517
MAXLL    DC    X'7FF8'        MAX. BIG LL                          VS0H 29654417
MAXLLL   DC    X'7FF4'        MAX. LITTLE LL                     A26556 29654719
F14      DC    H'14'                                                    29655019
HD       DC    CL7'HEADER '                                        UL0H 29655317
TL       DC    CL7'TRAILER'                                        UL0H 29656217
LBSW     DC    X'00'          SET TO 00 TO IND. IN HEADER LAB COMPRUL0H 29657217
*                             SET TO 01 TO IND. IN TL LAB COMPR    UL0H 29658217
IOERR    DC    CL18'IEB267I I/O ERROR,'                          A27718 29658319
*********************************************************************** 29658517
*        THE FOLLOWING MESSAGE IS BUILT AT EXECUTION TIME             * 29658817
LABMSG   DC    CL10'IEB247I   '                                    UL0H 29659117
LABMSG1  DC    CL32'INPUT         LABELS FROM BOTH D'              UL0H 29659417
         DC    CL30'ATA SETS ARE COMPARED         '                UL0H 29659717
         DS    0F                                                  UL0H 29709900
DCALBLX1 DC    X'85'                                               UL0H 29719900
         DC    AL3(DCBEXIT1)                                            29729900
         DC    X'01'                                                    29739900
         DC    AL3(INHDEXT1)                                       UL0H 29749900
         DC    X'83'                                               UL0H 29751900
         DC    AL3(INTLEXT1)                                       UL0H 29753900
         DS    0F                                                  UL0H 29754000
DCALBLX2 DC    X'85'                                               UL0H 29754100
         DC    AL3(DCBEXIT2)                                            29754200
         DC    X'01'                                                    29754300
         DC    AL3(INHDEXT2)                                       UL0H 29754800
         DC    X'83'                                               UL0H 29755200
         DC    AL3(INTLEXT2)                                       UL0H 29755600
DASET1   DCB   DDNAME=SYSUT1,DSORG=PS,MACRF=R,NCP=1,BFALN=F,DEVD=DA,   129756302
               EODAD=INEOD1,SYNAD=SYNADEX,EXLST=DCALBLX1       @YM04833 29756902
DASET2   DCB   DDNAME=SYSUT2,DSORG=PS,MACRF=R,NCP=1,BFALN=F,DEVD=DA,   129757502
               EODAD=INEOD2,SYNAD=SYNADEX,EXLST=DCALBLX2       @YM04833 29758102
         END                                                            29859800
./  ADD  SSI=31230557,NAME=IEBCOMPM
*********************************************************************** 00020000
*                                                                     * 00040000
* NAME   *   *   *****   *****   *****   *       ***   *****   *****  * 00060000
*        ** **   *       *       *       *        *    *         *    * 00080000
*        * * *   ****     ***     ***    *        *     ***      *    * 00100000
*        *   *   *           *       *   *        *        *     *    * 00120000
*        *   *   *****   *****   *****   *****   ***   *****     *    * 00140000
*                                                                     * 00160000
*********************************************************************** 00180000
*                                                                     * 00200000
* FUNCTION/OPERATION                                                  * 00220000
*                                                                     * 00240000
*     THIS IS THE STANDARD MESSAGE MODULE FOR THE DATA SET UTILITY    * 00260000
*   IEBCOMPR.  IT CONTAINS ALL THE MESSAGES GIVEN BY IEBCOMPR WHICH   * 00280000
*   ARE NOT SIMPLY INFORMATIONAL MESSAGES.  EACH MESSAGE HAS A SEVEN  * 00300000
*  CHARATER IDENTIFING LABEL AND UP TO SEVENTY-TWO CHARACTERS OF      * 00320017
*   MESSAGE TEXT.                                                     * 00340000
*                                                                     * 00360000
*********************************************************************** 00380000
*                                                                     * 00400000
* ENTRY POINTS                                                        * 00420000
*                                                                     * 00440000
*   1. 'MESSLIST'   THIS IS THE CSECT NAME FOR THE MODULE, AND IS THE * 00460000
*                RELATIVE POINT FROM WHICH THE ADDRESS OF THE MESSAGES* 00480017
*                OF 40 BYTES LONG IS CALCULATED.                      * 00500017
*                                                                     * 00520000
*   2. 'DDERROR1'   THIS IS THE ADDRESS OF THE TEXT FOR THE MESSAGE   * 00540000
*                 THAT INDICATES SOME DDNAME CANNOT BE OPENED. THE    * 00560000
*                 DDNAME IS PLACED IN THE MESSAGE BY USING THIS ENTRY * 00580000
*                 POINT.                                              * 00600000
*                                                                     * 00620000
*   3. 'MSG31'      THIS IS THE RELATIVE POINT FROM WHICH THE ADDRESS * 00626017
*                OF THE MESSAGES OF 72 BYTES LONG IS CALCULATED.      * 00632017
*********************************************************************** 00640000
         EJECT                                                          00660000
*********************************************************************** 00680000
*                                                                     * 00700000
* INPUT                                                               * 00720000
*      INPUT TO THE JPRINTRT MESSAGE WRITER-                      *SA0I 00730018
*     REGISTER 1 CONTAINS THE DESIRED MESSAGE NUMBER ON ENTRY TO  *SA0I 00740018
*      THE JPRINTRT MESSAGE WRITER ROUTINE.                       *SA0I 00760018
*                                                                     * 00780000
*********************************************************************** 00800000
*                                                                     * 00820000
* OUTPUT                                                              * 00840000
*                                                                     * 00860000
*     NO OUTPUT                                                       * 00880000
*                                                                     * 00900000
*********************************************************************** 00920000
*                                                                     * 00940000
* EXTERNAL ROUTINES                                                   * 00960000
*                                                                     * 00980000
*     NOT APPLICABLE                                                  * 01000000
*                                                                     * 01020000
*********************************************************************** 01040000
*                                                                     * 01060000
* EXITS                                                               * 01080000
*                                                                     * 01100000
*     NOT APPLICABLE                                                  * 01120000
*                                                                     * 01140000
*********************************************************************** 01160000
*                                                                     * 01180000
* TABLES/WORK AREA                                                    * 01200000
*                                                                     * 01220000
*     THE ENTIRE MODULE IS A TABLE.  EACH ENTRY IS FORTY BYTES LONG,  * 01240000
*   AND CONSISTS OF A SEVEN BYTE IDENTIFIER FOLLOWED BY UP TO THIRTY  * 01260000
*   TWO BYTES OF TEXT INFORMATION.                                    * 01280000
*                                                                     * 01300000
*********************************************************************** 01320000
*                                                                     * 01340000
* ATTRIBUTES                                                          * 01360000
*                                                                     * 01380000
*     NOT APPLICABLE SINCE THE CSECT HAS NO EXECUTABLE INSTRUCTIONS.  * 01400000
*                                                                     * 01420000
*********************************************************************** 01440000
*                                                                 *SA0I 01441018
*NOTE- DUPLICATE MESSAGES PREVIOUSLY OCCURING IN THIS MODULE      *SA0I 01442018
*        HAVE BEEN DELETED FOR RELEASE 18. THOSE MESSAGE SLOTS    *SA0I 01443018
*        WHICH ARE CURRENTLY AVAILABLE ARE MARKED AS UNUSED.      *SA0I 01444018
*        IF A MESSAGE IDENTIFIER CODE APPEARS AS OUTPUT WITHOUT   *SA0I 01445018
*        A FOLLOWING MESSAGE THEN THE MESSAGE NUMBER PASSED TO    *SA0I 01446018
*        THE JPRINTRT PRINT ROUTINE MUST BE CORRECTED TO THE NO.  *SA0I 01447018
*        INDICATED IN THE COMMENT OF THAT MESSAGE IDENTIFIER      *SA0I 01448018
*                                                                 *SA0I 01449018
*******************************************************************SA0I 01450018
MESSLIST CSECT                                                          01460000
* 015800,021800,022600                                           A26556 01465019
*8047                                                              000H 01470017
*3265015800,016200,016600,020000,020200,021200,021400,022000-      SA0I 01473018
* 022600,025200,025400,026000,026200,426797                        SA0I 01476018
*C019800                                                         A41765 01478021
*C026740,026741                                                  A44318 01478421
*C016200                                                         A48817 01478822
         ENTRY DDERROR1                                                 01480000
         ENTRY MSG31                                               UV0H 01490017
         DS    40X                                                      01500000
         DC    CL8'IEB201I '                                            01520000
         DC    CL32'INVALID CONTROL STATEMENT       '                   01540000
         DC    CL8'IEB202I '                                            01560000
         DC    CL32'INVALID DIRECTORY BLOCK SIZE    '            A26556 01580019
         DC    CL8'IEB203I '                                            01600000
         DC    CL32'ALIAS/TRUE NAME FAILURE         '            A48817 01620022
         DC    CL8'IEB204I '                                            01640000
         DC    CL32' '  UNUSED-REPLACED WITH MESSAGE 61            SA0I 01660018
         DC    CL8'IEB205I '                                            01680000
         DC    CL32'USER DATA FIELDS UNEQUAL        '                   01700000
         DC    CL8'        '                                            01720000
         DC    CL32'ALIAS MISSING FROM SYSUT2       '                   01740000
         DC    CL8'        '                                            01760000
         DC    CL32'TRUE NAME MISSING FROM SYSUT2   '                   01780000
         DC    CL8'        '                                            01800000
         DC    CL32'ALIAS MISSING FROM SYSUT1       '                   01820000
         DC    CL8'        '                                            01840000
         DC    CL32'TRUE NAME MISSING FROM SYSUT1   '                   01860000
         DC    CL8'IEB210I '                                            01880000
         DC    CL32'   TRUE NAMES MISSING- BOTH SETS'                   01900000
         DC    CL8'IEB211I '                                            01920000
         DC    CL32'   KEY LENGTHS ARE NOT EQUAL    '                   01940000
         DC    CL8'IEB212I '                                            01960000
         DC    CL32'INVALID DCB PARAMETER           '            A41765 01980021
         DC    CL8'IEB213I '                                       SA0I 02000018
         DC    CL32'REPETITIOUS CARD INVALID        '              SA0I 02020018
         DC    CL8'IEB214I '                                            02040000
         DC    CL32'   FIXED RECORD LENGTHS UNEQUAL '                   02060000
         DC    CL8'IEB215I '                                            02080000
         DC    CL32'RECORD FORMATS DIFFERENT        '                   02100000
         DC    CL8'IEB216I '                                       SA0I 02120018
         DC    CL32'ILLEGAL CONTROL CARD SEQUENCE   '              SA0I 02140018
         DC    CL8'IEB217I '                                            02160000
         DC    CL32'INVALID LRECL FOR V/VS RECORD   '           A26556  02180019
         DC    CL8'IEB218I '                                       SA0I 02200018
         DC    CL32'PERMANENT INPUT ERROR-FIND MACRO'              SA0I 02220018
         DC    CL8'IEB219I '                                       SA0I 02240018
         DC    CL32'INVALID BLKSIZE FOR V/VS RECORD '           A26556  02260019
         DC    CL8'        '                                            02280000
         DC    CL32'   RECORD LENGTHS ARE UNEQUAL   '                   02300000
         DC    CL8'IEB221I '                                            02320000
         DC    CL32'   RECORDS ARE NOT EQUAL        '                   02340000
         DC    CL8'IEB222I '                                            02360000
         DC    CL32'   KEYS ARE NOT EQUAL           '                   02380000
         DC    CL8'IEB223I '                                            02400000
         DC    CL32'EXTRA RECORD ON SYSUT2          '                   02420000
         DC    CL8'IEB224I '                                            02440000
         DC    CL32'EXTRA RECORD ON SYSUT1          '                   02460000
         DC    CL8'IEB225I '                                            02480000
         DC    CL32'JOB TERMINATED AFTER EXIT       '                   02500000
         DC    CL8'IEB226I '                                       SA0I 02520018
         DC    CL32'WARNING-INVALID NAME            '              SA0I 02540018
         DC    CL8'IEB227I '                                            02560000
         DC    CL32'   TEN CONSECUTIVE ERRORS       '                   02580000
         DC    CL8'IEB228I '                                       SA0I 02600018
         DC    CL32' '  UNUSED-REPLACED WITH MESSAGE 27            SA0I 02620018
         DC    CL8'IEB229I '                                            02640000
DDERROR1 DC   CL32'DDNAME          CANNOT BE OPENED'                    02660000
         DC    CL8'IEB230I '                                       000H 02666017
         DC    CL32'SYSIN BLOCKSIZE ERROR           '              000H 02672017
MSG31    DC    CL8'IEB231I '                                       UL0H 02672117
         DC    CL32'EXTRA USER INPUT HEADER LABELS O'              UL0H 02672217
         DC    CL32'N SYSUT1                        '              UL0H 02672317
         DC    CL8'IEB232I '                                       UL0H 02672417
         DC    CL32'EXTRA USER INPUT HEADER LABELS O'              UL0H 02672517
         DC    CL32'N SYSUT2                        '              UL0H 02672617
         DC    CL8'IEB233I '                                       UL0H 02672717
         DC    CL32'EXTRA USER INPUT TRAILER LABELS '              UL0H 02672817
         DC    CL32'ON SYSUT1                       '              UL0H 02672917
         DC    CL8'IEB234I '                                       UL0H 02673017
         DC    CL32'EXTRA USER INPUT TRAILER LABELS '              UL0H 02673117
         DC    CL32'ON SYSUT2                       '              UL0H 02673217
         DC    CL8'IEB235I '                                       UL0H 02673317
         DC    CL32'SYSUT1 CONTAINS NO USER INPUT HE'              UL0H 02673417
         DC    CL32'ADER LABELS                     '              UL0H 02673517
         DC    CL8'IEB236I '                                       UL0H 02673617
         DC    CL32'SYSUT2 CONTAINS NO USER INPUT HE'              UL0H 02673717
         DC    CL32'ADER LABELS                     '              UL0H 02673817
         DC    CL8'IEB237I '                                       UL0H 02673917
         DC    CL32'BOTH INPUT DATA SETS CONTAIN NO '            A44318 02674021
         DC    CL32'USER HEADER LABELS              '            A44318 02674121
         DC    CL8'IEB238I '                                       UL0H 02674217
         DC    CL32'SYSUT1 CONTAINS NO USER INPUT TR'              UL0H 02674317
         DC    CL32'AILER LABELS                    '              UL0H 02674417
         DC    CL8'IEB239I '                                       UL0H 02674517
         DC    CL32'SYSUT2 CONTAINS NO USER INPUT TR'              UL0H 02674617
         DC    CL32'AILER LABELS                    '              UL0H 02674717
         DC    CL8'IEB240I '                                       UL0H 02674817
         DC    CL32'BOTH INPUT DATA SETS CONTAIN NO '              UL0H 02674917
         DC    CL32'USER TRAILER LABELS             '              UL0H 02675017
         DC    CL8'IEB241I '                                       UL0H 02675117
         DC    CL32'INPUT HEADER LABELS ARE NOT EQUA'              UL0H 02675217
         DC    CL32'L                               '              UL0H 02675317
         DC    CL8'IEB242I '                                       UL0H 02675417
         DC    CL32'INPUT TRAILER LABELS ARE NOT EQU'              UL0H 02675517
         DC    CL32'AL                              '              UL0H 02675617
         DC    CL8'IEB243I '                                       UL0H 02675717
         DC    CL32'I/O ERROR WHILE READING USER INP'              UL0H 02675817
         DC    CL32'UT HEADER LABEL ON SYSUT1       '              UL0H 02675917
         DC    CL8'IEB244I '                                       UL0H 02676017
         DC    CL32'I/O ERROR WHILE READING USER INP'              UL0H 02676117
         DC    CL32'UT HEADER LABEL ON SYSUT2       '              UL0H 02676217
         DC    CL8'IEB245I '                                       UL0H 02676317
         DC    CL32'I/O ERROR WHILE READING USER INP'              UL0H 02676417
         DC    CL32'UT TRAILER LABEL ON SYSUT1      '              UL0H 02676517
         DC    CL8'IEB246I '                                       UL0H 02676617
         DC    CL32'I/O ERROR WHILE READING USER INP'              UL0H 02676717
         DC    CL32'UT TRAILER LABEL ON SYSUT2      '              UL0H 02676817
         DS    72X                                                 ULVS 02676917
         DS    72X                                                 ULVS 02677017
         DC    CL8'IEB249I '                                       UL0H 02677117
         DC    CL32'NO RECORDS ARE COMPARED, DATA=ON'              UL0H 02677217
         DC    CL32'LY                              '              UL0H 02677317
         DC    CL8'IEB250I '                                       UL0H 02677417
         DC    CL32'USER LABEL IS NOT SUPPORTED BY P'              UL0H 02677517
         DC    CL32'ARTITIONED DATA SET             '              UL0H 02677617
         DC    CL8'IEB251I '                                       VS0H 02677717
         DC    CL32'INCOMPATIBLE MAXIMUM LOGICAL REC'              VS0H 02677817
         DC    CL32'ORD LENGTH.                     '              VS0H 02677917
         DC    CL8'IEB252I '                                       VS0H 02678017
         DC    CL32'KEYED DATA SETS. ONE CONTAINS VS'              VS0H 02678117
         DC    CL32' RECORDS, THE OTHER ONE DOES NOT'              VS0H 02678217
         DC    CL8'IEB253I '                                       VS0H 02678317
         DC    CL32'RECORDS ARE COMPARED AT PHYSICAL'              VS0H 02678417
         DC    CL32' BLOCK LEVEL                    '              VS0H 02678517
         DC    CL8'IEB254I '                                       VS0H 02678617
         DC    CL32'CORRESPONDING BLOCK LENGTH ARE N'              VS0H 02678717
         DC    CL32'OT EQUAL                        '              VS0H 02678817
         DC    CL8'IEB255I '                                       VS0H 02678917
         DC    CL32'CORRESPONDING RECORD LENGTH ARE '              VS0H 02679017
         DC    CL32'NOT EQUAL                       '              VS0H 02679117
         DC    CL8'IEB256I '                                       VS0H 02679217
         DC    CL32'IEBCOMPR DOES NOT COMPARE PARTIT'              VS0H 02679317
         DC    CL32'IONED DATA SETS WITH VS RECFM   '              VS0H 02679417
         DC    CL8'IEB257I '                                       UL0H 02679517
         DC    CL32'JOB TERMINATED AFTER EXIT FOR US'              UL0H 02679617
         DC    CL32'ER VOLUME SWITCH LABEL PROCESS  '              UL0H 02679717
         DC    CL8'IEB258I '                                       UL0H 12679717
         DC    CL32'USER LABELS NOT COMPARED, UNABLE'              UL0H 22679717
         DC    CL32' TO TAKE EXIT FOR ONE DATA SET  '              UL0H 32679717
         DC    CL8'IEB259I '                                       SA0I 34679718
         DC    CL32'   INVALID KEYWORD IN OR BEFORE '              SA0I 36679718
         DC    CL32'COLUMN                          '              SA0I 38679718
         DC    CL8'IEB260I '                                       SA0I 40679718
         DC    CL32'   MISSING COMMAND IN OR BEFORE '              SA0I 42679718
         DC    CL32'COLUMN                          '              SA0I 44679718
         DC    CL8'IEB261I '                                       SA0I 46679718
         DC    CL32' INVALID PARAMETER IN OR BEFORE '              SA0I 48679718
         DC    CL32'COLUMN                          '              SA0I 50679718
         DC    CL8'IEB262I '                                       SA0I 52679718
         DC    CL32'   MISSING KEYWORD IN OR BEFORE '              SA0I 54679718
         DC    CL32'COLUMN                          '              SA0I 56679718
         DC    CL8'IEB263I '                                       SA0I 58679718
         DC    CL32' MISSING PARAMETER IN OR BEFORE '              SA0I 60679718
         DC    CL32'COLUMN                          '              SA0I 62679718
         DC    CL8'IEB264I '                                       SA0I 64679718
         DC    CL32'FIRST CONTROL CARD IS NOT "COMPA'              SA0I 66679718
         DC    CL32'RE"                             '              SA0I 68679718
         DC    CL8'IEB265I '                                       SA0I 70679718
         DC    CL32'   INVALID COMMAND IN OR BEFORE '              SA0I 72679718
         DC    CL32'COLUMN                          '              SA0I 74679718
         DC    CL8'IEB266I '                                       SA0I 76679718
         DC    CL32'CONTINUATION CARD BEGINS IN WRON'              SA0I 78679718
         DC    CL32'G COLUMN                        '              SA0I 80679718
IOERR    DC    CL8'IEB267I '                                     A27718 81179719
         DC    CL32' THIS IS I/O ERROR MSG, MSG CONT'            A27718 81679719
         DC    CL32' EXTS PROVIDED BY SYNADAF       '            A27718 82179719
          END                                                           82679718
./  ADD  SSI=31230565,NAME=IEBCQSAM
 SPACE 2                                                                00200017
*********************************************************************** 00400017
*                                                                     * 00600017
* NAME   IEBCQSAM                                                     * 00800017
*                                                                     * 01000017
*********************************************************************** 01200017
*                                                                     * 01400017
* FUNCTION/OPERATION                                                  * 01600017
*                                                                     * 01800017
*     THIS MODULE IS ENTERRED WHEN PROCESS DATA SETS CONTAINING VS    * 02000017
*   RECORDS BY QSAM IS DESIRED. ITS FUNCTIONS ARE AS FOLLOWS          * 02200017
*                                                                     * 02400017
*   1. TO SET ITS OWN ADDRESSABILITY                                  * 02600017
*   2. TO SET COMMUNICATION REGION'S ADDRESSABILITY                   * 02800017
*   3. TO OPEN THE TWO INPUT DATA SETS FOR QSAM MOVE MODE PROCESSING  * 03000017
*   4. TO VERIFY THE LITTLE LL FIELD OF CORRESPONDING RECORDS         * 03200017
*   5. BRACH TO COMPAR TO COMPARE THE CORRESPONDING LOGICAL RECORDS   * 03400017
*   6. BRACH TO BLPRT TO COVERT AND PRINT THE EXTRA RECORDS ON EITHER * 03600017
*      INPUT DATA SETS                                                * 03800017
*   7. BRANCH TO BEFNREND OF IEBCMAIN FOR TERMINATION AFTER BOTH INPUT* 04000017
*      DATA SETS REACHED EOD CONDITION                                * 04200017
*                                                                     * 04400017
*********************************************************************** 04600017
*                                                                     * 04800017
* ENTRY POINTS                                                        * 05000017
*                                                                     * 05200017
*   'QSAM'  IS THE ONLY ENTRY POINT TO THIS MODULE                    * 05400017
*                                                                     * 05600017
*********************************************************************** 05800017
*                                                                     * 06000017
* INPUT                                                               * 06200017
*                                                                     * 06400017
*   INPUT TO THIS MODULE ARE THE USER DDNAMES FOR SYSUT1 AND SYSUT2   * 06600017
* FROM THE COMMUNICATION REGION OF ROOT SEGMENT                       * 06800017
*                                                                     * 07000017
*********************************************************************** 07200017
*                                                                     * 07400017
* OUTPUT                                                              * 07600017
*                                                                     * 07800017
*   OUTPUT FROM THIS MODULE ARE DIAGNOSTIC MESSAGES                   * 08000017
*                                                                     * 08200017
*********************************************************************** 08400017
*                                                                     * 08600017
* EXTERNAL ROUTINES                                                   * 08800017
*                                                                     * 09000017
*   THIS MODULE USES ROOT SEGMENT'S PRINT ROUTINE,JPRINTRT, TO PRINT  * 09200017
* DIAGNOSTIC MESSAGES. IT USES IEBCMAIN'S COMPAR ROUTINE TO COMPARE   * 09400017
* RECORDS. IT USES IEBCMAIN'S BLPRT ROUTINE TO CONVERT AND PRINT EXTRA* 09600017
* RECORDS ON EITHER INPUT DATA SETS. IT ALSO BRANCH TO IEBCULET VIA   * 09800017
* LABEL EXITS ENTRY IN DCBEXLST FOR USER INPUT HEADER/TRAILER LABEL   * 10000017
* PROCESSING.                                                         * 10200017
*                                                                     * 10400017
*********************************************************************** 10600017
*                                                                     * 10800017
* EXITS                                                               * 11000017
*                                                                     * 11200017
*   THE ONLY EXITS FROM THIS MODULE IS A BRACH TO BEFNREND OF IEBCMAIN* 11400017
* FOR TERMINATION AFTER BOTH INPUT DATA SETS REACHED EOD CONDITION    * 11600017
*                                                                     * 11800017
*********************************************************************** 12000017
*                                                                     * 12200017
* TABLES/WORK AREA                                                    * 12400017
*                                                                     * 12600017
*   THERE IS NO TABLE/WORK AREA IN THIS MODULE                        * 12800017
*                                                                     * 13000017
*********************************************************************** 13200017
*                                                                     * 13400017
* ATTRIBUTES                                                          * 13600017
*                                                                     * 13800017
*     NON-REUSABLE                                                    * 14000017
*                                                                     * 14200017
*********************************************************************** 14400017
  EJECT                                                                 14600017
*********************************************************************** 14800017
*                                                                     * 15000017
COMMX    DSECT                                                          15200017
         USING COMMX,10                                                 15400017
SAVE1315 DS    3F             SAVE AREA FOR REGS 13,14,15               15600017
SAVEREGS DS    18F            MY REGISTER SAVE AREA                     15800017
PARALIST DS    8F             THE EXITS PARAMETER LIST-USER ROUTS       16000017
*                               1. INHDR PARAMETER NAME                 16200017
*                               2. INTLR PARAMETER NAME                 16400017
*                               3. ERROR PARAMETER NAME                 16600017
*                               4. PRECOMP PARAMETER NAME               16800017
DDSYSIN  DS    2F             SYSIN PARAMETER                           17000017
DDSUBNAM DS    4F             DDNAME PARAMETER LIST                     17200017
*                               1. SYSUT1 DDNAME                        17400017
*                               2. SYSUT2 DDNAME                        17600017
HICONCOD DS    2X             RETURN CODE STORAGE AREA                  17800017
CCADSORG DS    1X             SET TO '01' IF PARTITIONED DATA SET       18000017
ABORTSW  DS    1X             ABORT SWTICH-SET TO '01' IF ON            18200017
LABEL    DS    1X             SET TO X'00' IF DATA=YES             UL0H 18400017
*                                    X'01' IF DATA=NO              UL0H 18600017
*                                    X'10' IF DATA=ONLY            UL0H 18800017
*                                    X'20' IF DATA=ALL             UL0H 19000017
UEXIT    DS    1X             SET TO 01 IF OPEN TOOK USER LAB EXIT UL0H 19200017
UHRADR   DS    1F             CONTAIN ADDR. OF INHDR               UL0H 19400017
UTRADR   DS    1F             CONTAIN ADDR. OF INTLR               UL0H 19600017
INHD1    DS    1F             HAS ADDR. OF SYSUT1 HD LAB SAVE AREA UL0H 19800017
INHD2    DS    1F             HAS ADDR. OF SYSUT2 HD LAB SAVE AREA UL0H 20000017
INHDCT1  DS    1F             CONT. NO. OF HEADER LABELS FOR SYSUT1UL0H 20200017
INHDCT2  DS    1F             CONT. NO. OF HEADER LABELS FOR SYSUT2UL0H 20400017
INTL1    DS    1F             HAS ADDR. OF SYSUT1 TL LAB SAVE AREA UL0H 20600017
INTL2    DS    1F             HAS ADDR. OF SYSUT2 TL LAB SAVE AREA UL0H 20800017
INTLCT1  DS    1F             CONT. NO. OF TRAILER LABEL FOR SYSUT1UL0H 21000017
INTLCT2  DS    1F             CONT. NO. OF TRAILER LABEL FOR SYSUT2UL0H 21200017
BUFF1    DS    1F             CONTAIN ADDR. OF READ AREA-DS1       VS0H 21400017
BUFF2    DS    1F             CONTAIN ADDR. OF READ AREA-DS2       VS0H 21600017
LBUFF1   DS    1F             LENGTH OF BUFFER FOR SYSUT1 RCD PROC VS0H 21800017
LBUFF2   DS    1F             LENGTH OF BUFFER FOR SYSUT2 RCD PROC VS0H 22000017
LORECO   DS    1F             TOTAL LOGICAL RECORD COUNTER         VS0H 22200017
RECLTH   DS    1H             LOGICAL RECORD LENGTH-DS1            VS0H 22400017
RECLH2   DS    1H             LOGICAL RECORD LENGTH-DS2            VS0H 22600017
DSET1    DS    1F            ADDRS. OF SYSUT1 DCB IN IEBCQSAM      VS0H 22800017
DSET2    DS    1F            ADDRS. OF SYSUT2 DCB IN IEBCQSAM      VS0H 23000017
INPUTLOC DS    1F            ADDR. OF INPUT BUFFER FOR BLPRT RT    VS0H 23200017
NOEXTSW  DS    1X             NO EXIT TO USER LAB RTN IF SET TO 01 UL0H 23400017
TERMSW   DS    1X             TERM. AFTER LAB. PROC. IF SET TO 01  UL0H 23600017
EXIT1SW  DS    1X             SET TO 01 IF THERE IS AN USER INHDR  UL0H 23800017
EXIT3SW  DS    1X             SET TO 01 IF THERE IS AN USER INTLR  UL0H 24000017
VSSWT    DS    1X             SET TO 01 IF BSAM USED TO PROC VS RCDVS0H 24200017
*                             SET TO 02 IF QSAM USED TO PROC VS RCDVS0H 24400017
NOLB     DS    1X             SET TO 01 IF NO USER LABEL ON SYSUT1 UL0H 24600017
*                             SET TO 02 IF NO USER LABEL ON SYSUT2 UL0H 24800017
LABSW    DS    1X             SET TO 01; SYSUT1 HEADER LABEL PROC  UL0H 25000017
*                             SET TO 02; SYSUT2 HEADER LABEL PROC  UL0H 25200017
*                             SET TO 04; SYSUT2 TRAILER LABEL PROC UL0H 25400017
*                             SET TO 08; SYSUT2 TRAILER LABEL PROC UL0H 25600017
PRINTOUT DS    0F             SYSPRINT DCB                              25800017
*                                                                     * 26000017
*********************************************************************** 26200017
QSAM     CSECT                                                          26400017
* 570000                                                         A27718 26410019
*A657500-657600       CORRECTION BLANKS BYTE BOUNDARY                   26412021
*2551428000                                                        SA0I 26420018
*                                                                     * 26450017
*        THIS MODULE IS TOTALLY NEW FOR RELEASE 17                    * 26500017
*                                                                     * 26550017
         EXTRN DDERROR1                                                 26600017
R0       EQU   0                                                        26610017
R1       EQU   1                                                        26620017
R2       EQU   2                                                        26630017
R3       EQU   3                                                        26640017
R4       EQU   4                                                        26650017
R5       EQU   5                                                        26660017
R6       EQU   6                                                        26670017
R7       EQU   7                                                        26680017
R8       EQU   8                                                        26690017
R9       EQU   9                                                        26700017
R10      EQU   10                                                       26710017
R11      EQU   11                                                       26720017
R12      EQU   12                                                       26730017
R13      EQU   13                                                       26740017
R14      EQU   14                                                       26750017
R15      EQU   15                                                       26760017
         BALR  R9,R0          ESTABLISH REG9 AS BASE REG.               26860017
         USING *,R9                                                     26960017
         L     R11,VSTARTP                                              27060017
         LR    R12,R11                                                  27160017
         A     R12,K4         ADD DISPLACEMENT 4096                     27260017
         MVI   VSSWT,X'02'    SET VSSWT TO 02 TO IND. VS RECORD PROC.   27800017
*                             BY QSAM MOVE MODE                         28000017
         LA    R1,DS1         LOAD ADDR OF SYSUT1 DCB                   28200017
         ST    R1,DSET1       STORE ADDR. OF SYSUT1 DCB AT COMM. REGION 28400017
         CLI   DDSUBNAM,X'00' IS THERE A DIFFERENT DDNAME FOR SYSUT1    28600017
         BE    OP1            NO, BRANCH                                28800017
         MVC   DDNAM1(8),DDSUBNAM  YES, SAVE ACTUAL DDNAME FOR SYSUT1   29000017
OP1      OPEN  DS1            OPEN SYSUT1 DCB                           29200017
         LA    R1,DS1                                                   29400017
         TM    48(R1),X'10'   WAS OPEN ACCOMPLISHED                     29600017
         BZ    NOTOPEN        NO, GO ABORT JOB                          29800017
         MVI   EXLST1,X'01'   ACTIVATE USER INPUT LABEL EXITS           30000017
*                                                                       30200017
         LA    R1,DS2         LOAD ADDR. OF SYSUT2 DCB                  30400017
         ST    R1,DSET2       STORE ADDR. OF SYSUT1 DCB AT COMM. REGION 30600017
         CLI   DDSUBNAM+8,X'00'    IS THERE A DIFFERENT DDNAME FOR      30800017
*                                  SYSUT2                               31000017
         BE    OP2                 NO, BRANCH                           31200017
         MVC   DDNAM2(8),DDSUBNAM+8  YES, SAVE USER DDNAME FOR SYSUT2   31400017
OP2      OPEN  DS2            OPEN SYSUT2 DCB                           31600017
         LA    R1,DS2                                                   31800017
         TM    48(R1),X'10'   WAS OPEN ACCOMPLISHED                     32000017
         BZ    NOTOPEN        NO, GO ABORT JOB                          32200017
         MVI   EXLST2,X'01'   ACTIVATE USER INPUT LABEL EXITS           32400017
*        GET BUFFER FOR SYSUT1 AND SYSUT2                               32600017
         LH    R0,RECLTH      LOAD MAX. LRECL OF SYSUT1 INTO REG0       32800017
         ST    R0,LBUFF1      SAVE LENGTH OF GET STORAGE                33000017
         GETMAIN R,LV=(R0)                                              33200017
         ST    R1,BUFF1       STORE ADDR. OF BUFFER AT BUFF1            33400017
         LH    R0,RECLH2      LOAD MAX. LRECL OF SYSUT2 INTO REG0       33600017
         ST    R0,LBUFF2      SAVE LENGTH OF GET STORAGE                33800017
         GETMAIN R,LV=(R0)                                              34000017
         ST    R1,BUFF2       STORE ADDR. OF BUFFER AT BUFF2            34200017
*        PROCESSING DATA RECORDS                                        34400017
AGAIN    L     R7,BUFF1                                                 34600017
         GET   DS1,(R7)                                                 34800017
         TM    TERMSW,X'01'   DID USER INHDR/INTLR REQUEST TERMINATION  35000017
         BO    USTERM         YES, BRANCH                               35200017
         L     R8,BUFF2                                                 35400017
         GET   DS2,(R8)                                                 35600017
         TM    TERMSW,X'01'   DID USER INHDR/INTLR REQUEST TERMINATION  35800017
         BO    USTERM         YES, BRANCH                               36000017
         LH    R5,0(R7)       REG5 CONTAIN LITTLE LL OF RECORD1         36200017
         CH    R5,MAXLLL      IS LITTLE LL GREATER THAN 32756           36400017
         BH    PERR           BRANCH IF HIGH                            36600017
         CH    R5,FOUR        IS LITTLE LL EQ OR LESS THAN 4            36800017
         BNH   PERR           BRANCH IF NOT HIGHER THAN 4               37000017
         STH   R5,RECLTH      SET RCD LENGTH OF SYSUT1 TO LITTLE LL     37200017
         LH    R3,0(R8)       REG3 CONTAIN LITTLE LL OF RECORD2         37400017
         CH    R3,MAXLLL      IS LITTLE LL GREATER THAN 32756           37600017
         BH    PERR           YES, BRANCH                               37800017
         CH    R3,FOUR        IS LITTLE LL GREATER THAN 4               38000017
         BNH   PERR           NO, BRANCH                                38200017
         STH   R3,RECLH2      SET RCD LENGTH OF SYSUT2 TO LITTLE LL     38400017
         SR    R4,R4          CLEAR REG4                                38600017
         SR    R6,R6          CLEAR REG6                                38800017
         L     R7,ADCOMP                                                39000017
         BALR  R3,R7          GO TO COMPARE RECORDS                     39200017
         L     R2,LORECO                                                39400017
         LA    R2,1(R2)       BUMP TOTAL LOGICAL RECORD COUNT           39600017
         ST    R2,LORECO                                                39800017
         B     AGAIN          BRANCH                                    40000017
NOTOPEN  L     R15,ADMSG      LOAD ADDR. OF MESSAGE                     40200017
         MVC   7(8,R15),40(R1) MOVE DDNAME INTO MESSAGE                 40400017
         LA    R1,29          GO PRINT MESSAGE                          40600017
         L     R15,PRINCONS                                             40800017
         BALR  R14,R15        GO TO PRINT RTN                           41000017
         LA    R15,12         LOAD RETURN CODE OF 12 INTO REG15         41200017
         B     ABORT          BRANCH                                    41400017
USTERM   LA    R1,57          TERM AFTER USER VOL-SWITCH LAB PROC       41600017
         L     R15,PRINCONS                                             41800017
         BALR  R14,R15                  GO TO PRINT RTN                 42000017
         LA    R15,16                                                   42200017
         STC   R15,HICONCOD                                             42400017
         B     ABORT          BRANCH                                    42600017
PERR     LA    R1,17              PERMANENT INPUT ERROR            SA0I 42800018
         L     R15,PRINCONS                                             43000017
         BALR  R14,R15                                                  43200017
         LA    R15,12         LOAD RET. CODE OF 12 INTO REG15           43400017
         STC   R15,HICONCOD                                             43600017
         B     ABORT          BRANCH                                    43800017
INHDEXT1 MVI   LABSW,X'01'                                              44000017
         L     R2,ADULAB                                                44200017
         BR    R2             GO TO IEBCULET                            44400017
INTLEXT1 MVI   LABSW,X'02'                                              44600017
         L     R2,ADULAB                                                44800017
         BR    R2             GO TO IEBCULET                            45000017
INHDEXT2 MVI   LABSW,X'01'                                              45200017
         L     R2,ADULAB                                                45400017
         BR    R2             GO TO IEBCULET                            45600017
INTLEXT2 MVI   LABSW,X'02'                                              45800017
         L     R2,ADULAB                                                46000017
         BR    R2             GO TO IEBCULET                            46200017
QINEOD1  MVI   EODSW1,X'01'   SET SW ON TO IND. SYSUT1 REACH EOD        46400017
         TM    EODSW2,X'01'   HAS SYSUT2 REACH EOD YET                  46600017
         BO    END            YES, BRANCH                               46800017
GET2     L     R8,BUFF2                                                 47000017
         GET   DS2,(R8)                                                 47200017
         TM    TERMSW,X'01'   DID USER INHDR/INTLR REQUEST TERMINATION  47400017
         BO    USTERM         YES, BRANCH                               47600017
         CLI   HICONCOD+1,8   IS HIGHEST RET.CODE EQUAL 8               47800017
         BNH   PRTMSG         BRANCH IF NOT HIGHER                      48000017
         MVI   HICONCOD+1,X'08'                                         48200017
PRTMSG   LA    R1,23                    EXTRA RECORD MESSAGE            48400017
         L     R15,PRINCONS                                             48600017
         BALR  R14,R15        GO TO PRINT RTN                           48800017
         LA    R1,DDNAM2                                                49000017
         BAL   R3,PRTREC      GO PRINT EXTRA RECORD                     49200017
         B     GET2           BRANCH                                    49400017
*        EOD ROUTINE FOR SYSUT2                                         49600017
QINEOD2  MVI   EODSW2,X'01'   SET SW ON TO IND. SYSUT2 REACH EOD        49800017
         TM    EODSW1,X'01'                                             50000017
         BO    END            YES,BRANCH                                50100017
         L     R8,BUFF1                                                 50200017
         B     PRTMSG1       PRINT EXTRA RCD ON SYSUT1 MSG              50320017
GET1     L     R8,BUFF1                                                 50420017
         GET   DS1,(R8)                                                 50520017
         TM    TERMSW,X'01'   DID USER INHDR/INTLR REQ TERM.            50800017
         BO    USTERM         YES, BRANCH                               51000017
         CLI   HICONCOD+1,8   IS HIGHEST RET. CODE EQUAL 8              51200017
         BNH   PRTMSG1        BRANCH IF NOT HIGHER                      51400017
         MVI   HICONCOD+1,X'08'                                         51600017
PRTMSG1  LA    R1,24               EXTRA RECORD MESSAGE                 51800017
         L     R15,PRINCONS                                             52000017
         BALR  R14,R15        GO TO PRINT RTN                           52200017
         LA    R1,DDNAM1                                                52400017
         BAL   R3,PRTREC                GO PRINT EXTRA RECORD           52600017
         B     GET1           BRANCH                                    52800017
PRTREC   ST    R3,SAVE3       SAVE RETURN ADDRESS                       53000017
         MVC   MYPRTARE(120),BLANKS                                     53200017
         MVC   MYPRTARE+4(9),DDN        MOVE DDNAME=                    53400017
         MVC   MYPRTARE+13(8),0(R1)     MOVE ACTUAL DDNAME              53600017
         LA    R0,119                   PRINT LINE                      53800017
         LA    R1,MYPRTARE                                              54000017
         L     R15,MYPRTCON                                             54200017
         BALR  R14,R15        GO TO PRINT RTN                           54400017
         ST    R8,INPUTLOC              SET ADDR. OF RECORD FOR BLPRT   54600017
*                                       SUBROUTINE                      54800017
         LH    R7,0(R8)                 SET LENGTH OF RCD FOR BLPRT     55000017
         SR    R5,R5                                                    55200017
         L     R15,ADBLPRT                                              55400017
         BALR  R4,R15         GO TO CONVERT AND PRINT RTN               55600017
         L     R3,SAVE3                                                 55800017
         BR    R3             BRANCH                                    56000017
END      L     R15,ADBEND     BRANC BACK TO MAIN PROCESSING  FOR        56200017
         BR    R15            CLOSE DATA SET AND TERMINATION            56400017
ABORT    L     R3,ADNORD      BRANCH TO MAIN PROC. FOR CLOSING          56600017
          BR   R3             AND TERM.                                 56800017
INERR    SYNADAF    ACSMETH=QSAM   GET I/O ERROR STATUS          A27718 56830019
         MVC   MYPRTARE(120),BLANKS  CLEAR OUTPUT BUFFER         A27718 56860019
         MVC   MYPRTARE(18),IOERR  MOVE MSG. NO. INTO OUTPUT BUF A27718 56890019
         MVC   MYPRTARE+19(79),49(R1) MOVE I/O ERROR STATUS INTO A27718 56920019
*                                    OUTPUT BUFFER               A27718 56950019
         LA    R0,119                NO. OF BYTES TO BE PRINTED  A27718 56980019
         LA    R1,MYPRTARE           ADDRESS OF OUTPUT BUFFER    A27718 57010019
         L     R15,MYPRTCON          GET ADDRESS OF PRINT ROUTINEA27718 57040019
         BALR  R14,R15               GO TO PRINT MSG             A27718 57070019
         SYNADRLS                    RELEASE AREAS GOT BY SYNADAIA27718 57100019
         B     END                   BRANCH FOR ERROR TERMINATIONA27718 57130019
*                                                                       57200017
*****    SYSUT1 DCB                                                     57400017
DS1      DCB   DDNAME=SYSUT1,                                          *57600017
               DSORG=PS,                                               *57800017
               MACRF=GM,                                               *58000017
               BFALN=F,                                                *58200017
               EODAD=QINEOD1,                                          *58400017
               DEVD=DA,                                                *58600017
               SYNAD=INERR,                                            *58800017
               EXLST=EXLST1                                             59000017
*****    SYSUT2 DCB                                                     59200017
DS2      DCB   DDNAME=SYSUT2,                                          *59400017
               DSORG=PS,                                               *59600017
               MACRF=GM,                                               *59800017
               BFALN=F,                                                *60000017
               EODAD=QINEOD2,                                          *60200017
               DEVD=DA,                                                *60400017
               SYNAD=INERR,                                            *60600017
               EXLST=EXLST2                                             60800017
         DS    0F                                                       61000017
EXLST1   DC    X'81'                                                    61200017
         DC    AL3(INHDEXT1)                                            61400017
         DC    X'83'                                                    61600017
         DC    AL3(INTLEXT2)                                            61800017
EXLST2   DC    X'81'                                                    62000017
         DC    AL3(INHDEXT2)                                            62200017
         DC    X'83'                                                    62400017
         DC    AL3(INTLEXT2)                                            62600017
********                     CONSTANT AREA                     ******** 62800017
VSTARTP  DC    V(STARTP)      ADDR. OF                                  63000017
ADNORD   DC    V(NORMEND)                                               63200017
ADBLPRT  DC    V(BLPRT)       ADDR. OF CONVERT AND PRINT ROUTINE        63400017
MYPRTCON DC    V(ZZPR)                                                  63600017
PRINCONS DC    V(JPRINTRT)                                              63800017
ADCOMP   DC    V(COMPAR)                                                64000017
ADBEND   DC    V(BEFNREND)                                              64200017
ADULAB   DC    V(USERLAB)                                               64400017
K4       DC    F'4096'                                                  64600017
FOUR     DC    H'4'                                                     64800017
MAXLLL   DC    X'7FF4'                                                  65000017
EODSW1   DC    X'00'          SET TO 01 IF SYSUT1 REACH EOD             65200017
EODSW2   DC    X'00'          SET TO 01 IF SYSUT2 REACH EOD             65400017
DDN      DC    CL9'DDNAME = '                                           65600017
IOERR    DC    CL18'IEB267I I/O ERROR,'                          A27718 65700019
         CNOP 2,4             ALIGN BLANKS BYTE                         65750021
         DC    X'40'          ON CORRECT BOUNDARY                       65760021
BLANKS   DC    X'40'                                                    65800017
MYPRTARE DS    30F                                                      66000017
SAVE3    DS    1F                                                       66200017
ADMSG    DC    A(DDERROR1)                                              66400017
DDNAM1   DC    CL8'SYSUT1  '                                            66600017
DDNAM2   DC    CL8'SYSUT2  '                                            66800017
         END                                                            67000017
./  ADD  SSI=31230568,NAME=IEBCROOT
*********************************************************************** 00020000
*                                                                     * 00040000
* NAME   *****   *****   *   *   ****    *****   ****    *****        * 00060000
*        *       *   *   ** **   *   *   *   *   *   *   *            * 00080000
*        *       *   *   * * *   ****    *****   ****    ****         * 00100000
*        *       *   *   *   *   *       *   *   *  *    *            * 00120000
*        *****   *****   *   *   *       *   *   *   *   *****        * 00140000
*                                                                     * 00160000
*********************************************************************** 00180000
*                                                                     * 00200000
* FUNCTION/OPERATION                                                  * 00220000
*                                                                     * 00240000
*     THIS IS THE ROOT SEGMENT FOR IEBCOMPR, THE DATA SET UTILITY THAT* 00260000
*   COMPARES TWO SEQUENTIAL OR TWO PARTITIONED DATA SETS.  ITS MAIN   * 00280000
*   FUNCTIONS ARE THE FOLLOWING:                                      * 00300000
*                                                                     * 00320000
*       1. TO SET ITS OWN ADDRESSABILITY                              * 00340000
*       2. TO SET THE COMMUNICATION REGION'S ADDRESSABILITY           * 00360000
*       3. TO INTERRAGATE THE DDNAME LIST AND SET THE APPROPRIATE     * 00380000
*            SWITHCES                                                 * 00400000
*       4. TO OPEN THE SYSPRINT DATA SET                              * 00420000
*       5. TO CONTROL BRANCHING TO THE CONTROL CARD ANALYZER, AND THE * 00440000
*            MAIN PROCESSING ROUTINE                                  * 00460000
*       6. TO PRINT ANY REQUEST ASKED BY EITHER OF THE TWO OVERLAY    * 00480000
*            SEGMENTS                                                 * 00500000
*                                                                     * 00520000
*********************************************************************** 00540000
*                                                                     * 00560000
* ENTRY POINTS                                                        * 00580000
*                                                                     * 00600000
*   1. 'COMPARE'    THIS IS THE ENTRY TO THE ROOT SEGMENT FROM ANY    * 00620000
*                 CALLING PROGRAM.                                    * 00640000
*                                                                     * 00660000
*   2. 'JPRINTRT'   ENTRY IS MADE HERE WHENEVER THE ANALYZER OR MAIN  * 00680000
*                 PROCESSOR WANTS A STANDARD DIAGNOSTIC MESSAGE       * 00700000
*                 PRINTED.                                            * 00720000
*                                                                     * 00740000
*   3. 'ZZPR'       ENTRY IS MADE HERE WHENEVER THE ANALYZER OR MAIN  * 00760000
*                 PROCESSOR WANTS ANY DATA OR ANY INFORMATIONAL       * 00780000
*                 MESSAGE PRINTED.                                    * 00800000
*                                                                     * 00820000
*********************************************************************** 00840000
*                                                                     * 00860000
* INPUT                                                               * 00880000
*                                                                     * 00900000
*     INPUT TO THIS MODULE IS ONE OF THE FOLLOWING:                   * 00920000
*                                                                     * 00940000
*       1. UPON ENTRY FROM THE CALLING PROGRAM THE DDNAME LIST IS     * 00960000
*            INPUT INFORMATION.                                       * 00980000
*       2. WHEN PRINTING REQUESTS FROM EITHER THE ANALYZER OR MAIN    * 01000000
*            PROCESSOR, THE ADDRESS OF THE MESSAGE AND ITS LENGTH     * 01020000
*            ARE INPUT.                                                 01040000
*                                                                     * 01060000
*********************************************************************** 01080000
         EJECT                                                          01100000
*********************************************************************** 01120000
*                                                                     * 01140000
* OUTPUT                                                              * 01160000
*                                                                     * 01180000
*     THE OUTPUT OF THIS MODULE CONSISTS OF DIAGNOSTIC MESSAGES,      * 01200000
*   INFORMATIONAL MESSAGES, AND LOGICAL RECORDS WHICH WERE EITHER     * 01220000
*   MISCOMPARES OR EXTRA RECORDS ON A PARTICULAR DATA SET.  IF A PDS  * 01240000
*   IS BEING COMPARED, THERE IS A POSSIBILITY THAT USER DATA FROM     * 01260000
*   EITHER PDS DIRECTORY WILL ALSO BE PRINTED.                        * 01280000
*                                                                     * 01300000
*********************************************************************** 01320000
*                                                                     * 01340000
* EXTERNAL ROUTINES                                                   * 01360000
*                                                                     * 01380000
*     FOR THIS PARTICULAR CSECT THERE ARE ONLY TWO EXTERNAL ROUTINES, * 01400000
*   THE CONTROL CARD ANALYZER, ANALY, AND THE MAIN PROCESSOR, MAIN.   * 01420000
*   EACH OF THESE IS AN OVERLAY SEGMENT.                              * 01440000
*                                                                     * 01460000
*********************************************************************** 01480000
*********************************************************************** 01500000
*                                                                     * 01520000
* EXITS                                                               * 01540000
*                                                                     * 01560000
*     THERE IS ONLY ONE ACTUAL EXIT TAKEN FROM THE ROOT SEGMENT, THAT * 01580000
*   BEING A BRANCH TO THE MAIN PROCESSOR.  THE MAIN PROCESSOR WILL    * 01600000
*   BRANCH TO THE ROOT SEGMENT'S PRINT ROUTINE, HOWEVER RETURN IS     * 01620000
*   ALWAYS GIVEN BACK TO THE MAIN PROCESSOR AND IT IS THE MAIN        * 01640000
*   PROCESSOR THAT REUTURNS CONTROL TO THE CALLING PROGRAM.           * 01660000
*                                                                     * 01680000
*********************************************************************** 01700000
*                                                                     * 01720000
* TABLES/WORK AREAS                                                   * 01740000
*                                                                     * 01760000
*     THE ONLY TABLE SET UP BY THE ROOT SEGMENT IS THE COMMUNICATION  * 01780000
*   REGION, WHILE THE ONLY WORK AREA IS THE PRINTOUT AREA.            * 01800000
*                                                                     * 01820000
*********************************************************************** 01840000
*                                                                     * 01860000
* ATTRIBUTES                                                          * 01880000
*                                                                     * 01900000
*     NON-REENTRANT AND NON-REUSEABLE                                 * 01920000
*                                                                     * 01940000
*********************************************************************** 01960000
         EJECT                                                          01980000
COMPARE  CSECT                                                          02000000
* 030980,032800-033000                                           A27718 02001019
*1000031000,052400-052600,058400-058600                            BS0H 02002017
* REGISTER ASSIGNMENTS                                                  02004017
R0       EQU   0                                                        02004617
R1       EQU   1                                                        02005217
R2       EQU   2                                                 A27718 02005619
R4       EQU   4                                                   BS0H 02006017
R5       EQU   5                                                   BS0H 02008017
R6       EQU   6                                                   BS0H 02010017
R7       EQU   7                                                   BS0H 02012017
RETREG   EQU   14                                                  BS0H 02014017
         SAVE  (14,12)                                                  02020000
         BALR  11,0                                                     02040000
         USING BEGIN,11                                                 02060000
BEGIN    STM   13,14,SAVE1315                                           02080000
         LA    10,COMMON           LOAD ADDRESS OF COMMUNICATION TABLE  02100000
         LA    13,SAVEREGS                                              02120000
         MVI   ZZCTRL,X'00'        MOVE CONTROL CHARACTER TO AREA       02140000
         SPACE 3                                                        02160000
*********************************************************************** 02180000
*        ROUTINE TO PROCESS DDNAME LIST                                 02200000
*********************************************************************** 02220000
         TM    0(1),X'80'          IS THERE A DDNAME LIST               02240000
         BO    LLEORI                BRANCH - NO DDLIST                 02260000
         L     5,4(1)              LOAD ADDRESS OF LIST INTO REG 5      02280000
         LH    6,0(5)              PLACE LENGTH OF LIST INTO REG 6      02300000
         C     6,FORTY             IS LENGTH OF LIST LESS THAN 40       02320000
         BL    LLHEAD                YES-THEN NOT OVERRIDING ANYTHING   02340000
         CLI   34(5),X'00'         IS THERE A DDNAME IN SLOT (SYSIN)    02360000
         BE    LLSEC                 BRANCH - NO DDNAME IN SLOT         02380000
         MVC   DDSYSIN(8),34(5)    MOVE DDNAME INTO COMMUNICATION TABLE 02400000
LLSEC    C     6,FOREIGHT                                               02420000
         BL    LLHEAD                                                   02440000
         CLI   42(5),X'00'         IS THERE A DDNAME IN SLOT (SYSPRINT) 02460000
         BE    LLTHR                 NO - BRANCH                        02480000
         LA    7,PRINTOUT          MOVE DDNAME INTO OUTPUT DCB          02500000
         MVC   DDNAME(8,7),42(5)                                        02520000
LLTHR    C     6,SIXFOUR                                                02540000
         BL    LLHEAD                                                   02560000
         CLI   58(5),X'00'         IS THERE A DDNAME IN SLOT (SYSUT1)   02580000
         BE    LLFOUR                NO-BRANCH                          02600000
         MVC   DDSUBNAM(8),58(5)   MOVE DDNAME INTO COMMUNICATION TABLE 02620000
LLFOUR   C     6,SEVTWO                                                 02640000
         BL    LLHEAD                                                   02660000
         CLI   66(5),X'00'         IS THERE A DDNAME IN SLOT (SYSUT2)   02680000
         BE    LLHEAD                NO-BRANCH                          02700000
         MVC   DDSUBNAM+8(8),66(5) MOVE DDNAME INTO COMMUN TABLE        02720000
**********************************************************************  02740000
*   ROUTINE TO PROCESS INITIAL USER PAGE NUMBER                         02760000
*********************************************************************** 02780000
LLHEAD   TM    4(1),X'80'          IS THERE A USER PAGE NUMBER          02800000
         BO    LLEORI                NO-BRANCH                          02820000
         L     5,8(1)              LOAD ADDRESS OF PAGE NO. INTO REG 5  02840000
         LH    7,0(5)              PLACE LENGTH OF PAGE NO. IN REG 7    02860000
         LA    6,PRHEAD+PAGEPOS    MOVE INITIAL PAGE                    02880000
         SR    6,7                   NUMBER INTO PROPER                 02900000
         SH    7,ONE                   POSITION                         02920000
         STC   7,LLMOVPAG+1              IN                             02940000
LLMOVPAG MVC   0(1,6),2(5)                 HEADER                       02960000
**********************************************************************  02980000
LLEORI   ST    1,SAVEREG1                                               03000000
         OPEN  (PRINTOUT,OUTPUT)   OPEN FOR PRINTER                     03020000
         LA    1,PRINTOUT         GET DCB ADRESS                        03040000
         TM    48(1),X'10'        WAS OPEN ACCOMPLISHED                 03060000
         BZ    FORGETIT           GO ABORT JOB                          03080000
         TM    DFLG,X'10'               CHECK FOR BLKSIZE ERROR    BS0H 03086017
         BC    8,CONTON                 IF NONE --                 BS0H 03092017
CLOSEDCB CLOSE (PRINTOUT)                                        A27718 03098019
         B     FORGETIT                 SET RETURN CODE            BS0H 03104017
CONTON   LA    0,HEADER      PRINT HEADER 0=LENGTH OF MESSAGE      BS0H 03110017
         LA    1,PRHEAD                          1=ADDR OF MESSAGE      03120000
         BAL   14,ZZPR                                                  03140000
         L     1,SAVEREG1                                               03160000
GOTOANAL L     15,ADDANALY         GO TO CARD SCAN ROUTINE              03180000
         BALR  14,15                                                    03200000
GOTOMAIN L     15,ADDMAIN          GO TO MAIN PROCESSOR                 03220000
         BR    15                                                       03240000
FORGETIT LA    15,12              PUT RETURN CODE OF '0C' IN REG15      03260000
         LM    13,14,SAVE1315                                           03262019
         RETURN (2,12)            RETURN TO CALLING PROGRAM             03264019
***                                                                **** 03266019
**  EXIT TAKEN WHEN PERMANENT I/O ERROR OCCURRED ON SYSPRINT        *** 03268019
SYNADEX  SYNADAF   ACSMETH=QSAM         GET I/O ERROR STATUS     A27718 03270019
         MVC   WTOLF1+23(26),49(R1)     MOVE I/O ERROR STATUS    A27718 03271019
         MVC   WTOLF2+12(53),75(R1)     INTO LIST FORM WTO       A27718 03272019
         SYNADRLS            RELEASE BUFFER GOT BY SYNADAF       A27718 03273019
         LA    R1,WTOLF1                                         A27718 03274019
         WTO   MF=(E,(1))                                        A27718 03276019
         LA    R1,WTOLF2                                         A27718 03278019
         WTO   MF=(E,(1))                                        A27718 03280019
         B     CLOSEDCB                                          A27718 03284019
WTOLF1   WTO   'IEB267I I/O ERROR                            ',  A27718*03288019
               MF=L,ROUTCDE=11,DESC=7                            A27718 03290019
WTOLF2   WTO   'IEB267I                                                *03292019
                      ',MF=L,ROUTCDE=11,DESC=7                   A27718 03294019
*******************************************************************BS0H 03301017
*   THIS IS THE DCB EXIT ROUTINE                                   BS0H 03302017
*******************************************************************BS0H 03303017
PRINTEXT LA    R7,PRINTOUT                                         BS0H 03304017
         USING IHADCB,R7                                           BS0H 03305017
         LH    R5,DCBBLKSI              LOAD BLKSIZE               BS0H 03306017
         LTR   R5,R5                                               BS0H 03307017
         BC    8,PRTBLK                 IF NONE SPECIFIED --       BS0H 03308017
         SR    R4,R4                                               BS0H 03309017
         LA    R6,121                                              BS0H 03310017
         DR    R4,R6                    CHECK FOR MODULAR BLKSIZE  BS0H 03311017
         LTR   R4,R4                                               BS0H 03312017
         BCR   8,RETREG                 RETURN TO CALLER - OPEN    BS0H 03313017
         MVI   DFLG,X'10'               SET BLKSIZE ERROR FLAG     BS0H 03314017
         MVC   DCBBLKSI(2),DCBLRECL     MOVE LRECL TO BLKSIZE      BS0H 03315017
         RETURN                                                         03316017
PRTBLK   MVI   DCBBLKSI+1,X'79'         INSERT BLKSIZE             BS0H 03317017
         DROP  R7                                                  BS0H 03318017
         RETURN                                                         03319017
**********************************************************************  03320000
***      CONSTANT AREA                                                  03340000
         DS    0D                                                  BS0H 03344017
OPT      DC    X'85'                                               BS0H 03348017
         DC    AL3(PRINTEXT)                                       BS0H 03352017
DFLG     DC    X'00'                                               BS0H 03356017
SAVEREG1 DC    F'0'                                                     03360000
ONE      DC    H'1'                                                     03380000
TWO      DC    H'2'                                                     03400000
EIGHT    DC    H'8'                                                     03420000
TWELVE   DC    H'12'                                                    03440000
SIXTEEN  DC    H'16'                                                    03460000
FORTY    DC    F'40'                                                    03480000
FOREIGHT DC    F'48'                                                    03500000
SIXFOUR  DC    F'64'                                                    03520000
SEVTWO   DC    F'72'                                                    03540000
PRHEAD   DC    CL32'                                '                   03560000
         DC    CL32'               COMPARE UTILITY  '                   03580000
         DC    CL32'                                '                   03600000
         DC    CL24' PAGE 0001'                                         03620000
         DC    X'32'                                                    03640000
PAGEPOS  EQU   106                                                      03660000
ADDANALY DC    V(ANALY)            ADDRESS OF CARD SCAN ROUTINE         03680000
ADDMAIN  DC    V(MAIN)             ADDRESS OF MAIN PROCESSOR ROUTINE    03700000
**********************************************************************  03720000
         ENTRY JPRINTRT                                                 03740000
         USING *,15                                                     03760000
JPRINTRT L     0,ADDRMESS                                               03780000
         CH    R1,THIRTY           IS MESSAGE NO. EQUAL 30         UV0H 03786017
         BH    MSEVEN              BRANCH IF HIGH                  UV0H 03792017
         MH    1,HFORTY                                                 03800000
         AR    1,0                                                      03820000
         LA    0,39                                                     03840000
         B     ZZPR                                                     03860000
MSEVEN   SH    R1,THIRTY                                           UV0H 03861017
         MH    R1,HSEVEN                                           UV0H 03862017
         SH     R1,HSEVEN                                          UV0H 03863017
         L     R0,ADMSG31                                          UV0H 03864017
         AR    R1,R0                                               UV0H 03865017
         LA    R0,71                                               UV0H 03866017
         B     ZZPR           BRANCH                               UV0H 03867017
THIRTY   DC    H'30'                                               UV0H 03868017
HSEVEN   DC    H'72'                                               UV0H 03871017
         EXTRN MSG31                                               UV0H 03874017
ADMSG31  DC    A(MSG31)                                            UV0H 03877017
HFORTY   DC    H'40'                                                    03880000
         EXTRN MESSLIST                                                 03900000
ADDRMESS DC    A(MESSLIST)                                              03920000
         DROP  15                                                       03940000
*********************************************************************   03960000
**       THIS IS THE GENERALIZED MESSAGE WRITER WHICH INCLUDES THE      03980000
**    FACILITYS TO PRINT A HEADER ON EACH PAGE WITH ASSENDING PAGE      04000000
**  NUMBERS.  THE LINKAGE IS AS FOLLOWS --- REG0=LENGTH OF MESSAGE      04020000
**                                              REG 1= ADDR OF MESSAGE  04040000
**                                                   BAL   14,ZZPR      04060000
*********************************************************************   04080000
         ENTRY ZZPR                                                     04100000
ZZPR     BALR  15,0                SET ADDRESSABILITY FOR NEXT INST     04120000
         USING *,15                                                     04140000
         STM   14,3,ZZSAVE         SAVE REGISTERS                       04160000
         DROP  15                                                       04180000
         BALR  2,0                                                      04200000
         USING *,2                                                      04220000
          TM   ZZSW,X'02'               SHOULD WE SET UP HEADER         04240000
          BO   ZZHEAD                   YES                             04260000
          TM   ZZSW,X'01'               SHOULD WE SKIP TO NEXT PAGE     04280000
          BO   ZZSKIP                   YES                             04300000
          CLC  ZZLINES(1),ZZLINCNT      IS THIS END OF PAGE             04320000
          BL   FULLPAGE                 YES                             04340000
          B    ZZCLEAR                  CLEAR PRINT BUFFER AND PRINT    04360000
PRNTRTRN  LM   14,3,ZZSAVE              RESTORE REGISTERS               04380000
          BR   14                       RETURN                          04400000
ZZHEAD    MVC  ZZHDSAVE(121),0(1)       MOVE HEADER AND LINE COUNT TO   04420000
*                                        SAVE AREA                      04440000
          BAL  3,ZZPG                   GO TO ADD ONE TO PAGE NUMBER    04460000
*                                        AND PRINT HEADER               04480000
          B    PRNTRTRN                                                 04500000
*                                                                       04520000
ZZSKIP    CLI  ZZCTRL,C'-'              IS NEXT PRINT A TRIPLE SPACE    04540000
          BE   PRNTRTRN                 YES   RETURN WITHOUT PRINT      04560000
          BAL  3,ZZPG                   GO TO PRINT HEADER              04580000
          B    PRNTRTRN                                                 04600000
FULLPAGE  BAL  3,ZZPG                   GO PRINT HEADER                 04620000
          B    ZZCLEAR                  GO PRINT LINE                   04640000
*                           THIS ROUTINE ADDS ONE TO PAGE NO. AND       04660000
*                           PRINTS HEAD  SET CONTROL CHAR FOR NEXT PRNT 04680000
ZZPG     TM    ZZCTRL,X'FF'                                             04700000
         BZ    ZZNOADD                                                  04720000
          PACK ZZCONVRT(8),ZZPGNO(3)    ADD ONE                         04740000
          CVB  15,ZZCONVRT                TO                            04760000
          LA   15,1(15)                     PAGE                        04780000
          CVD  15,ZZCONVRT                    NUMBER                    04800000
          UNPK ZZPGNO(3),ZZCONVRT(8)            IN                      04820000
          OI   ZZPGNO+2,X'F0'                     HEADER                04840000
ZZNOADD  MVI   ZZCTRL,C'1'         SET SKIP TO 1 CONTROL                04860000
          MVI  ZZLINCNT,X'04'           INITIALIZE LINE COUNT TO 4      04880000
          MVC  ZZPRINT(120),ZZHDSAVE   MOVE HEADER INTO PRINT BUFFER    04900000
          ST   3,SAVE3                  SAVE REGISTER 3                 04920000
          BAL  3,ZZWRITE                GO TO WRITE HEADER              04940000
          MVI  ZZCTRL,C'-'              SET CONTROL TO TRIPLE SPACE     04960000
          L    3,SAVE3                                                  04980000
          BR   3                                                        05000000
ZZCLEAR   IC   14,ZZLINCNT              THIS ROUTINE WILL               05020000
          LA   14,1(14)                    ADD ONE                      05040000
          STC  14,ZZLINCNT              STORE NEW LINE COUNT            05060000
          MVI  ZZPRINT,C' '                                             05080000
         MVC   ZZPRINT+1(119),ZZPRINT      CLEAR PRINT BUFFER           05100000
          LM   14,15,ZZSAVE+8                TO BLANKS                  05120000
          EX   14,ZZMOVE                   MOVE LINE TO BE PRINTED      05140000
          BAL  3,ZZWRITE                     INTO BUFFER                05160000
          MVI  ZZCTRL,C' '                 SET CONTROL CHAR FOR NEXT    05180000
          B    PRNTRTRN                 PRINT LINE AND  RETURN          05200000
ZZMOVE    MVC  ZZPRINT(1),0(15)         MOVE MESSAGE TO PRINT BUFFER    05220000
ZZWRITE  PUT   ZZDCB,ZZCTRL             WRITE MESSAGE              BS0H 05250017
          BR   3                                                        05280000
          DS   0D                                                       05300000
ZZSAVE    DS   10X                                                      05320000
ZZSW      DS   10X                                                      05340000
          DS    4X                                                      05360000
SAVE3     DS    4X                                                      05380000
ZZCTRL   DS    1X                                                       05400000
ZZPRINT  DS    121X                                                     05420000
ZZHDSAVE DS    120X                                                     05440000
ZZCONVRT EQU   ZZSAVE+32                                                05460000
ZZLINES  DS    1X                                                       05480000
ZZLINCNT DS    1X                                                       05500000
ZZDECB   DS    24X                                                      05520000
SKIP     EQU   256                                                      05540000
HEADER   EQU   512                                                      05560000
ZZPGNO   EQU   ZZHDSAVE+103                                             05580000
*********************************************************************   05600000
***      COMMON COMMUNICATION AREA                                      05620000
SAVE1315 DS    3F                  SAVE AREA FOR REGS 13-15             05640000
SAVEREGS DS    18F                 REGISTER SAVE AREA                   05660000
PARALIST DS    8F                  AREA FOR EXITS PARAMETER LIST        05680000
DDSYSIN  DC    2F'0'                        DDNAME=SYSIN AREA           05700000
DDSUBNAM DC    2F'0'                        DDNAME AREA 1-SYSUT1        05720000
         DC    2F'0'                        DDNAME AREA 2-SYSUT2        05740000
HICONCOD DC    H'0'                                                     05760000
CCADSORG DC    X'00'               PO OR PS SWITCH (01=PO)              05780000
ABORTSW  DC    X'00'               ABORT SWITCH                         05800000
LABEL    DC    X'00'          SET TO X'00' IF DATA=YES             UL0H 05800517
*                                    X'01' IF DATA=NO              UL0H 05801017
*                                    X'10' IF DATA=ONLY            UL0H 05801517
*                                    X'20' IF DATA=ALL             UL0H 05802017
UEXIT    DC    X'00'          SET TO 01 IF OPEN TOOK USER LAB EXIT UL0H 05802517
UHRADR   DC    F'0'           CONTAIN ADDR. OF INHDR               UL0H 05803017
UTRADR   DC    F'0'           CONTAIN ADDR. OF INTLR               UL0H 05803517
INHD1    DC    F'0'           HAS ADDR. OF SYSUT1 HD LAB SAVE AREA UL0H 05804017
INHD2    DC    F'0'           HAS ADDR. OF SYSUT2 HD LAB SAVE AREA UL0H 05804517
INHDCT1  DC    F'0'           CONT. NO. OF HEADER LABELS FOR SYSUT1UL0H 05805017
INHDCT2  DC    F'0'           CONT. NO. OF HEADER LABELS FOR SYSUT2UL0H 05805517
INTL1    DC    F'0'           HAS ADDR. OF SYSUT1 TL LAB SAVE AREA UL0H 05806017
INTL2    DC    F'0'           HAS ADDR. OF SYSUT2 TL LAB SAVE AREA UL0H 05806517
INTLCT1  DC    F'0'           CONT. NO. OF TRAILER LABEL FOR SYSUT1UL0H 05807017
INTLCT2  DC    F'0'           CONT. NO. OF TRAILER LABEL FOR SYSUT2UL0H 05807517
BUFF1    DC    F'0'           CONTAIN ADDR. OF READ AREA-DS1       VS0H 05808017
BUFF2    DC    F'0'           CONTAIN ADDR. OF READ AREA-DS2       VS0H 05808517
LBUFF1   DC    F'0'           LENGTH OF BUFFER FOR SYSUT1 RCD PROC VS0H 05809017
LBUFF2   DC    F'0'           LENGTH OF BUFFER FOR SYSUT2 RCD PROC VS0H 05809517
LORECO   DC    F'0'           TOTAL LOGICAL RECORD COUNTER         VS0H 05810017
RECLTH   DC    H'0'           LOGICAL RECORD LENGTH-DS1            VS0H 05810517
RECLH2   DC    H'0'           LOGICAL RECORD LENGTH-DS2            VS0H 05811017
DSET1    DC    F'0'          ADDRS. OF SYSUT1 DCB IN IEBCQSAM      VS0H 05811517
DSET2    DC    F'0'          ADDRS. OF SYSUT2 DCB IN IEBCQSAM      VS0H 05812017
INPUTLOC DC    F'0'          ADDR. OF INPUT BUFFER FOR BLPRT RT    VS0H 05812517
NOEXTSW  DC    X'00'          NO EXIT TO USER LAB RTN IF SET TO 01 UL0H 05813017
TERMSW   DC    X'00'          TERM. AFTER LAB. PROC. IF SET TO 01  UL0H 05813517
EXIT1SW  DC    X'00'          SET TO 01 IF THERE IS AN USER INHDR  UL0H 05814017
EXIT3SW  DC    X'00'          SET TO 01 IF THERE IS AN USER INTLR  UL0H 05814517
VSSWT    DC    X'00'          SET TO 01 IF BSAM USED TO PROC VS RCDVS0H 05815017
*                             SET TO 02 IF QSAM USED TO PROC VS RCDVS0H 05815517
NOLB     DC    X'00'          SET TO 01 IF NO USER LABEL ON SYSUT1 UL0H 05816017
*                             SET TO 02 IF NO USER LABEL ON SYSUT2 UL0H 05816517
LABSW    DC    X'00'          SET TO 01; SYSUT1 HEADER LABEL PROC  UL0H 05817017
*                             SET TO 02; SYSUT2 HEADER LABEL PROC  UL0H 05817517
*                             SET TO 04; SYSUT2 TRAILER LABEL PROC UL0H 05818017
*                             SET TO 08; SYSUT2 TRAILER LABEL PROC UL0H 05818517
*********************************************************************** 05820000
PRINTOUT DCB   DSORG=PS,MACRF=(PM),DDNAME=SYSPRINT,                BS0H*05840017
               LRECL=121,                                        A35461*05845020
               SYNAD=SYNADEX,                                    A27718*05850019
               RECFM=FBA,EXLST=OPT,DEVD=DA                         BS0H 05860017
*********************************************************************   05880000
COMMON   EQU   SAVE1315                                                 05900000
ZZDCB    EQU   PRINTOUT                                                 05920000
         DCBD  DSORG=PS                                                 05940000
DDNAME   EQU   DCBDDNAM-IHADCB                                          05960000
         END   COMPARE                                                  05980000
./  ADD  SSI=31230569,NAME=IEBCULET
 SPACE 2                                                                00200017
*********************************************************************** 00400017
*                                                                     * 00600017
* NAME   IEBCULET                                                     * 00800017
*                                                                     * 01000017
*********************************************************************** 01200017
*                                                                     * 01400017
* FUNCTION/OPERATION                                                  * 01600017
*                                                                     * 01800017
*     THIS ROUNTINE WILL ALWAYS BE ENTERRED VIA DCBEXLST ENTRY FOR    * 02000017
*  USER INPUT HEADER/TRAILER LABEL EXITS. ITS MAIN FUNCTIONS ARE AS   * 02200017
*  FOLLOWS                                                            * 02400017
*                                                                     * 02600017
*   1. TO SET ITS OWN ADDRESSABILITY                                  * 02800017
*   2. TO SET COMMUNICATION REGION'S ADDRESSABILITY                   * 03000017
*   3. THEN BRANCH TO PROPER ADDRESS FOR LABEL SAVING OR EXIT TO USER * 03200017
*      INHDR/INTLR                                                    * 03400017
*        'HDRLBEX1' ENTRY FOR SYSUT1 USER INPUT HEADER                * 03600017
*        'HDRLBEX2' ENTRY FOR SYSUT2 USER INPUT HEADER                * 03800017
*        'TLRLBEX1' ENTRY FOR SYSUT1 USER INPUT TRAILER               * 04000017
*        'TLRLBEX2' ENTRY FOR SYSUT2 USER INPUT TRAILER               * 04200017
*   4. TO SAVE THE LABELS FOR LATER COMPARISON IF REQUESTED BY USER   * 04400017
*   5. GIVE CONTROL TO USER INHDR/INTLR IF THERE IS ONE               * 04600017
*   6. INTERPRET USER RETURN CODE                                     * 04800017
*   7. PRINT USER WISH TO STOP RECEIVING ANY MORE LABEL MESSAGE       * 05000017
*   8. EXIT TO OPEN/CLOSE/EOV AFTER EACH LABEL BEING HANDLED PROPERLY * 05200017
*                                                                     * 05400017
*********************************************************************** 05600017
*                                                                     * 05800017
* ENTRY POINTS                                                        * 06000017
*                                                                     * 06200017
*   'USERLAB' IS THE ONLY ENTRY POINT TO THIS MODULE VIA USER LABEL   * 06400017
*      ENTRY IN DCBEXLST                                              * 06600017
*                                                                     * 06800017
*********************************************************************** 07000017
*                                                                     * 07200017
* INPUT                                                               * 07400017
*                                                                     * 07600017
*   INPUT TO THIS MODULE ARE AS FOLLOWS                               * 07800017
*                                                                     * 08000017
*   1. SWITCHES AND PARAMETERS WHICH ARE SET UP BY IEBCANAL AND       * 08200017
*      IEBCMAIN IN THE COMMUNICATION REGION OF ROOT SEGMENT           * 08400017
*   2. 16 BYTES PARAMETER LIST WHICH IS SET UP BY OPEN/CLOSE/EOV FOR  * 08600017
*      EACH LABEL TO BE VERIFIED                                      * 08800017
*                                                                     * 09000017
*********************************************************************** 09200017
*                                                                     * 09400017
* OUTPUT                                                              * 09600017
*                                                                     * 09800017
*     THE OUTPUT FROM THIS MODULE IS DIAGNOSTIC AND INFORMATIONAL     * 10000017
*   MESSAGES.                                                         * 10200017
*                                                                     * 10400017
*********************************************************************** 10600017
*                                                                     * 10800017
* EXTERNAL ROUTINES                                                   * 11000017
*                                                                     * 11200017
*     THIS MODULE USES ROOT SEGMENT'S PRINT ROUTINE, ZZPR AND JPRINTRT* 11400017
*   SUBROUTINE TO PRINT MESSAGES. OTHER POSSIBLE EXTERNAL ROUTINES ARE* 11600017
*   THE USER INHDR/INTLR ROUTINES. LINKAGE TO THESE ROUTINES IS MADE  * 11800017
*   BY BRANCH AND LINK INSTRUCTION.                                   * 12000017
*                                                                     * 12200017
*********************************************************************** 12400017
*                                                                     * 12600017
* EXITS                                                               * 12800017
*                                                                     * 13000017
*     THE ONLY EXIT MADE FROM THIS MODULE IS A RETURN BACK TO         * 13200017
*   OPEN/CLOSE/EOV AFTER EACH LABEL BEING HANDLED ACCORDINGLY         * 13400017
*                                                                     * 13600017
*********************************************************************** 13800017
*                                                                     * 14000017
* TABLES/WORK AREA                                                    * 14200017
*     THERE IS NO TABLES/WORK AREA IN THIS MODULE                     * 14400017
*                                                                     * 14600017
*********************************************************************** 14800017
*                                                                     * 15000017
* ATTRIBUTES                                                          * 15200017
*                                                                     * 15400017
*     NON-REUSABLE                                                    * 15600017
*                                                                     * 15800017
*********************************************************************** 16000017
  EJECT                                                                 16200017
COMMX    DSECT                                                          16400017
         USING COMMX,10                                                 16600017
SAVE1315 DS    3F             SAVE AREA FOR REGS 13,14,15               16800017
SAVEREGS DS    18F            MY REGISTER SAVE AREA                     17200017
PARALIST DS    8F             THE EXITS PARAMETER LIST-USER ROUTS       17400017
*                               1. INHDR PARAMETER NAME                 17600017
*                               2. INTLR PARAMETER NAME                 17800017
*                               3. ERROR PARAMETER NAME                 18000017
*                               4. PRECOMP PARAMETER NAME               18200017
DDSYSIN  DS    2F             SYSIN PARAMETER                           18400017
DDSUBNAM DS    4F             DDNAME PARAMETER LIST                     18600017
*                               1. SYSUT1 DDNAME                        18800017
*                               2. SYSUT2 DDNAME                        19000017
HICONCOD DS    2X             RETURN CODE STORAGE AREA                  19200017
CCADSORG DS    1X             SET TO '01' IF PARTITIONED DATA SET       19400017
ABORTSW  DS    1X             ABORT SWTICH-SET TO '01' IF ON            19600017
LABEL    DS    1X             SET TO X'00' IF DATA=YES             UL0H 19800017
*                                    X'01' IF DATA=NO              UL0H 20000017
*                                    X'10' IF DATA=ONLY            UL0H 20200017
*                                    X'20' IF DATA=ALL             UL0H 20400017
UEXIT    DS    1X             SET TO 01 IF OPEN TOOK USER LAB EXIT UL0H 20600017
UHRADR   DS    1F             CONTAIN ADDR. OF INHDR               UL0H 20800017
UTRADR   DS    1F             CONTAIN ADDR. OF INTLR               UL0H 21000017
INHD1    DS    1F             HAS ADDR. OF SYSUT1 HD LAB SAVE AREA UL0H 21200017
INHD2    DS    1F             HAS ADDR. OF SYSUT2 HD LAB SAVE AREA UL0H 21400017
INHDCT1  DS    1F             CONT. NO. OF HEADER LABELS FOR SYSUT1UL0H 21600017
INHDCT2  DS    1F             CONT. NO. OF HEADER LABELS FOR SYSUT2UL0H 21800017
INTL1    DS    1F             HAS ADDR. OF SYSUT1 TL LAB SAVE AREA UL0H 22000017
INTL2    DS    1F             HAS ADDR. OF SYSUT2 TL LAB SAVE AREA UL0H 22200017
INTLCT1  DS    1F             CONT. NO. OF TRAILER LABEL FOR SYSUT1UL0H 22400017
INTLCT2  DS    1F             CONT. NO. OF TRAILER LABEL FOR SYSUT2UL0H 22600017
BUFF1    DS    1F             CONTAIN ADDR. OF READ AREA-DS1       VS0H 22800017
BUFF2    DS    1F             CONTAIN ADDR. OF READ AREA-DS2       VS0H 23000017
LBUFF1   DS    1F             LENGTH OF BUFFER FOR SYSUT1 RCD PROC VS0H 23200017
LBUFF2   DS    1F             LENGTH OF BUFFER FOR SYSUT2 RCD PROC VS0H 23400017
LORECO   DS    1F             TOTAL LOGICAL RECORD COUNTER         VS0H 23600017
RECLTH   DS    1H             LOGICAL RECORD LENGTH-DS1            VS0H 23800017
RECLH2   DS    1H             LOGICAL RECORD LENGTH-DS2            VS0H 24000017
DSET1    DS    1F            ADDRS. OF SYSUT1 DCB IN IEBCQSAM      VS0H 24200017
DSET2    DS    1F            ADDRS. OF SYSUT2 DCB IN IEBCQSAM      VS0H 24400017
INPUTLOC DS    1F            ADDR. OF INPUT BUFFER FOR BLPRT RT    VS0H 24600017
NOEXTSW  DS    1X             NO EXIT TO USER LAB RTN IF SET TO 01 UL0H 24800017
TERMSW   DS    1X             TERM. AFTER LAB. PROC. IF SET TO 01  UL0H 25000017
EXIT1SW  DS    1X             SET TO 01 IF THERE IS AN USER INHDR  UL0H 25200017
EXIT3SW  DS    1X             SET TO 01 IF THERE IS AN USER INTLR  UL0H 25400017
VSSWT    DS    1X             SET TO 01 IF BSAM USED TO PROC VS RCDVS0H 25600017
*                             SET TO 02 IF QSAM USED TO PROC VS RCDVS0H 25800017
NOLB     DS    1X             SET TO 01 IF NO USER LABEL ON SYSUT1 UL0H 26000017
*                             SET TO 02 IF NO USER LABEL ON SYSUT2 UL0H 26200017
LABSW    DS    1X             SET TO 01; SYSUT1 HEADER LABEL PROC  UL0H 26400017
*                             SET TO 02; SYSUT2 HEADER LABEL PROC  UL0H 26600017
*                             SET TO 04; SYSUT1 TRAILER LABEL PROC UL0H 26800017
*                             SET TO 08; SYSUT2 TRAILER LABEL PROC UL0H 27000017
PRINTOUT DS    0F             SYSPRINT DCB                              27200017
*********************************************************************** 27400017
*        USER INPUT HEADER LABEL EXITS ARE TAKEN VIA THIS SECTION OF  * 27600017
*        CODE  USER INPUT HEADER LABELS ARE SAVED FOR LATER COMPARISON* 27800017
*        IF REQUESTED BY USER                                         * 28000017
*********************************************************************** 28200017
USERLAB  CSECT                                                          28400017
*                                                                     * 28450017
*        THIS MODULE IS TOTALLY NEW FOR RELEASE 17                    * 28500017
*                                                                     * 28550017
R0       EQU   0                                                        28552017
R1       EQU   1                                                        28554017
R2       EQU   2                                                        28556017
R3       EQU   3                                                        28558017
R4       EQU   4                                                        28560017
R5       EQU   5                                                        28562017
R6       EQU   6                                                        28564017
R7       EQU   7                                                        28566017
R8       EQU   8                                                        28568017
R9       EQU   9                                                        28570017
R10      EQU   10                                                       28572017
R11      EQU   11                                                       28574017
R12      EQU   12                                                       28576017
R13      EQU   13                                                       28578017
R14      EQU   14                                                       28580017
R15      EQU   15                                                       28582017
         BALR  R2,R0         ESTABLISH ADDRESSABILITY                   28682017
         USING *,R2                                                     28782017
         STM   R1,R14,USAVE                                             28882017
         DROP  R2                                                       28982017
         BALR  R12,R0        RE-ESTABLISH ADDRESSABILITY                29082017
         USING *,R12                                                    29182017
         LA    R13,MYSAVE                                               29282017
         CLI   LABSW,X'01'    IS IN SYSUT1 HEADER LABEL PROC.           30200017
         BE    HDRLBEX1       YES, BRANCH                               30400017
         CLI   LABSW,X'02'    IS IN SYSUT2 HEADER LABEL PROC.           30600017
         BE    HDRLBEX2       YES, BRANCH                               30800017
         CLI   LABSW,X'04'    IS IN SYSUT1 TRAILER LABEL PROC.          31000017
         BE    TLRLBEX1       YES, BRANCH                               31200017
         CLI   LABSW,X'08'    IS IN SYSUT2 TRAILER LABEL PROC.          31400017
         BE    TLRLBEX2       YES, BRANCH                               31600017
         B     RET1           BRANCH                                    31800017
HDRLBEX1 MVC   LABMSG2+9(8),PARALIST *  INITIALIZE MSG: XX EXITS TO  *  31900017
         MVI   LAB2+3,X'F1'          *  (INHDR) IS MADE FOR SYSUT(1) *  32000017
*                                    *  RETURN CODE FROM USER ROUTINE*  32100017
*                                    *  IS XX                        *  32200017
         OI    UEXIT,X'01'     IN SYSUT1 LABEL EXIT                     32300017
         TM    8(R1),X'80'    DID UNCORRECTABLE I/O ERROR OCCUR         32400017
         BO    IOERR1         WHILE READ USER INPUT HD ON SYSUT1        32600017
NTEST1   L     R3,0(R1)       GET ADDR. OF LABEL BUFFER AREA            32800017
         C     R3,ZERO        IS ADDR. OF BUFFER AREA ZERO              33000017
         BE    FSTNOHD1       YES, BRANCH                               33200017
         CLI   3(R3),X'F1'    IS THIS THE 1ST LABEL OF THE GROUP        33400017
         BE    FSTHD1         YES, BRANCH                               33600017
         TM    FSW1,X'02'     IS THIS THE VOL-SWITCH HD ON SYSUT1       33800017
         BO    INHEXT1        YES, BRANCH                               34000017
         TM    LABEL,X'01'    IS DATA=NO                                34200017
         BO    INHEXT1        YES, BRANCH                               34400017
         B     INIT1          NO, GO SAVE THE LABEL                     34600017
FSTHD1   TM    FSW1,X'01'     IS THIS THE 1ST GROUP OF HD ON SYSUT1     34800017
         BZ    INTLAB1        NO, THIS IS VOL-SWITCH TIME HDS           35000017
         MVI   FSW1,X'00'     YES, TURN SW OFF TO IND. 1ST HD OF        35200017
*                             1ST HD GROUP ON SYSUT1 HAS READ           35400017
FSTIME1  TM    LABEL,X'01'    IS DATA=NO                                35600017
         BO    INHEXT1        YES, LABEL SAVING IS NOT NECESSARY        35800017
         LR    R2,R1          NO, GET 640 BYTES TO SAVE LABEL           36000017
         GETMAIN   R,LV=640                                             36200017
         ST    R1,INHD1                                                 36400017
         LR    R1,R2                                                    36600017
         B     INIT1          BRANCH                                    36800017
FSTNOHD1 TM    FSW1,X'01'     IS THIS THE FIRST GROUP OF HD ON DS1      37000017
         BZ    INTLAB1        NO, BRANCH                                37200017
         XI    NOLB,X'01'     YES,TURN NOLB SW TO IND. NO LABEL         37400017
*                            ON SYST1                                   37600017
          MVI  FSW1,X'00'                                               37800017
         B     INHEXT1        BRANCH                                    38000017
INIT1    L     R2,INHD1      GET ADDR. OF SYSUT1 HD LAB SAVE AREA       38200017
         L     R5,INHDCT1                                               38400017
         M     R4,EIGHTY                                                38600017
         AR    R2,R5          REG.2 CONT. ADDR.OF NEXT AVAIL.LABEL      38800017
*                             SAVE AREA FOR SYSUT1                      39000017
         L     R5,INHDCT1                                               39200017
         LA    R5,1(R5)       ADD 1 TO INPUT HEADER LAB CT FOR          39400017
         ST    R5,INHDCT1     SYSUT1                                    39600017
         B     LABSAVE        BRANCH                                    39800017
HDRLBEX2 MVC   LABMSG2+9(8),PARALIST *  INITIALIZE MSG : XX EXITS TO *  39900017
         MVI   LAB2+3,X'F2'          *  (INHDR) IS MADE FOR SYSUT(2) *  40000017
*                                    *  RETURN CODE FROM USER ROUTINE*  40100017
*                                    *  IS XX                        *  40200017
         OI    UEXIT,X'02'     IN SYSUT2 LABEL EXIT                     40300017
         TM    8(R1),X'80'    DID I/O ERROR OCCUR WHILE READ USER       40400017
         BO    IOERR2         INPUT HEADER ON SYSUT2                    40600017
NTEST2   L     R3,0(R1)       GET ADDR. OF LABEL BUFFER AREA            40800017
         C     R3,ZERO        IS ADDR. OF LABEL BUFFER ZERO             41000017
         BE    FSTNOHD2       YES, BRANCH                               41200017
         CLI   3(R3),X'F1'    IS THIS THE 1ST LABEL OF THE GROUP        41400017
         BE    FSTHD2         YES, BRANCH                               41600017
         TM    FSW2,X'02'     IS THIS THE VOL-SWITCH HD ON SYSUT2       41800017
         BO    INHEXT2        YES, BRANCH                               42000017
         TM    LABEL,X'01'    IS DATA=NO                                42200017
         BO    INHEXT2        YES, BRACH                                42400017
         B     INIT2          BRANCH                                    42600017
*                                                                       42800017
*        THIS IS INH1 ON SYSUT2                                         43000017
FSTHD2   TM    FSW2,X'01'     IS THIS THE 1ST GROUP OF HD ON SYSUT1     43200017
         BZ    INTLAB2        NO, THIS IS VOL-SWITCH TIME HDS           43400017
         MVI   FSW2,X'00'     YES,TURN SW OFF TO IND. 1ST HD OF         43600017
*                             1ST HD GROUP ON SYSUT2 HAS READ           43800017
FSTIME2  TM    LABEL,X'01'    IS DATA=NO                                44000017
         BO    INHEXT2        YES, LABEL SAVING IS NOT NECESSARY        44200017
         LR    R2,R1                                                    44400017
         GETMAIN   R,LV=640                                             44600017
         ST    R1,INHD2                                                 44800017
         LR    R1,R2                                                    45000017
         B     INIT2          BRANCH                                    45200017
*                                                                       45400017
*        NO HEADER LABEL ON SYSUT2                                      45600017
FSTNOHD2 TM    FSW2,X'01'     IS THIS THE 1ST GROUP OF HD ON SYSUT2     45800017
         BZ    INTLAB2        NO,BRANCH                                 46000017
         XI    NOLB,X'02'     YES,TURN NOLB SW ON TO IND. NO HEADER     46200017
*                             LABEL ON SYSUT2                           46400017
          MVI  FSW2,X'00'                                               46600017
         B     INHEXT2        BRANCH                                    46800017
INIT2    L     R2,INHD2       GET ADDR. OF SYSUT2 HD LAB SAVE AREA      47000017
         L     R5,INHDCT2                                               47200017
         M     R4,EIGHTY                                                47400017
         AR    R2,R5          REG.2 CONT. ADDR OF NEXT AVAIL. LABEL     47600017
*                             SAVE AREA FOR SYSUT2                      47800017
         L     R5,INHDCT2                                               48000017
         LA    R5,1(R5)       ADD 1 TO INPUT HEADER LAB CT FOR          48200017
         ST    R5,INHDCT2     SYSUT2                                    48400017
*        THIS SECTION OF CODE WILL SAVE INPUT HEADER LABEL FOR LATER  * 48600017
*        COMPARISON.                                                  * 48800017
LABSAVE  L     R3,0(R1)       GET ADDR. OF LABEL BUFFER                 49000017
         MVC   0(80,R2),0(R3) MOVE LABEL INTO LABEL SAVE AREA           49200017
         TM    EXIT1SW,X'01'  IS THERE AN USER INHDR                    49400017
         BZ    RET            NO                                        49600017
         TM    NOEXTSW,X'01'  YES,IS NO EXIT TO INHDR SW ON             49800017
         BO    RET            YES,NO EXIT TO INHDR SW IS ON             50000017
GOUHR    L     R15,UHRADR    NO,GO TO USER INHDR                        50200017
         BALR  R14,R15        BRANCH                                    50400017
         B     CKRCODE        BRANCH                                    50600017
*        INITIALIZATION FOR SYSUT1 VOL-SWITCH HEAER PROCESSING          50800017
INTLAB1  TM    TERMSW,X'01'   WAS TERM SW SET BY VOL-SWITCH TRAILER     51000017
*                             LABEL PROCESSING                          51200017
         BO    RET1           YES, BRANCH                               51400017
         MVI   FSW1,X'02'     SET FSW1 TO IND. IN VOL-SWITCH HEAD       51600017
         MVC   INHDCT1(4),ZERO  SET HEADER LAB, COUNT TO ZERO           51800017
INHEXT1  L     R5,INHDCT1                                               52000017
         LA    R5,1(R5)                                                 52200017
         ST    R5,INHDCT1                                               52400017
         B     INHEXT         BRANCH                                    52600017
*        INITIALIZATION FOR SYSUT2 VOL SWITCH HEADER PROCESSING         52800017
INTLAB2  TM    TERMSW,X'01'   WAS TEMM SW SET BY VOL-SWITCH TRAILER     53000017
*                             LABEL PROCESSING                          53200017
         BO    RET1           YES, BRANCH                               53400017
         MVI   FSW2,X'02'     SET FSW2 TO IND. IN VOL-SWITCH HEAD       53600017
         MVC   INHDCT2(4),ZERO     SET HEADER LAB. COUNT TO ZERO        53800017
INHEXT2  L     R5,INHDCT2                                               54000017
         LA    R5,1(R5)                                                 54200017
         ST    R5,INHDCT2                                               54400017
INHEXT   TM    EXIT1SW,X'01'  IS THERE AN USER INHDR                    54600017
         BZ    RET1           NO, IGNORE THE REST OF LABELS             54800017
         B     GOUHR          BRANCH                                    55000017
*********************************************************************** 55200017
*        USER INPUT TRAILER LABEL EXITS ARE TAKEN VIA THIS SECTION OF * 55400017
*        CODE. USER INPUT TRAILER LABELS ARE SAVED FOR LATER COMPARISO* 55600017
*        IF REQUESTED BY USER                                         * 55800017
*********************************************************************** 56000017
TLRLBEX1 MVC   LABMSG2+9(8),PARALIST+8 * INIT. MSG: X EXITS TO (INTLR)* 56100017
         MVI   LAB2+3,X'F1'            * IS MADE FOR SYSUT(2) RETURN  * 56200017
*                                      * CODE FROM USER ROUTINE IS XX * 56300017
         L     R3,0(R1)       GET ADDR. OF LABEL BUFFER AREA            56600017
         C     R3,ZERO        IS ADDR. OF LABEL BUFFER AREA ZERO        56800017
         BNE   TTESTIO1       NO, BRANCH                                57000017
         XI    NOLB,X'01'     YES,TURN NOLB  SW ON TO IND. NO LAB       57200017
*                             ON SYSUT1                                 57400017
         MVC   INTLCT1(4),ZERO     SET SYSUT1 TRAILER LAB COUNT 0       57600017
         B     TEXT1          BRANCH                                    57800017
TTESTIO1 TM    8(R1),X'80'    DID I/O ERROR OCCUR WHILE READ USER       58000017
         BO    TIOERR1        INPUT TRAILER ON SYSUT1                   58200017
TNTEST1  TM    LABEL,X'01'    DATA=NO                                   58400017
         BO    INTEXT1        YES,DATA=NO                               58600017
         CLI   3(R3),X'F1'    IS THIS THE 1ST LABEL OF THE GROUP        58800017
         BNE   INITT1         NO, BRANCH                                59000017
         MVC   INTLCT1(4),ZERO     SET SYSUT1 TRAILER LAB COUNT 0       59200017
         NI    NOLB,X'20'     TURN NOLB SW OFF                          59400017
         CLC   INTL1(4),ZERO  HAS VOL-SWITCH TIME TRAILER LABELS        59600017
*                             BEEN SAVED                                59800017
         BNE   INITT1         YES, USE THE SAME SAVE AREA TO OVER       60000017
*                             LAY THOSE LABELS                          60200017
         LR    R2,R1                                                    60400017
         GETMAIN   R,LV=640                                             60600017
         ST    R1,INTL1       SAVE GOTTEN CORE ADDR. AT INTL1           60800017
         LR    R1,R2                                                    61000017
INITT1   L     R2,INTL1                                                 61200017
         L     R5,INTLCT1                                               61400017
         M     R4,EIGHTY                                                61600017
         AR    R2,R5          REG2.HAS ADDR. OF NEXT AVAIL LABEL        61800017
*                             SAVE AREA FOR SYSUT1                      62000017
         L     R5,INTLCT1                                               62200017
         LA    R5,1(R5)       ADD 1 TO INPUT TRAILER LABEL CT FOR       62400017
         ST    R5,INTLCT1     SYSUT1                                    62600017
         B     TLABSAVE       BRANCH                                    62800017
*                                                                       63000017
TLRLBEX2 MVC   LABMSG2+9(8),PARALIST+8 * INIT. MSG: X EXITS TO (INTLR)* 63100017
         MVI   LAB2+3,X'F2'            * IS MADE FOR SYSUT(2) RETURN  * 63200017
*                                      * CODE FROM USER ROUTINE IS XX * 63300017
         L     R3,0(R1)       GET ADDR. OF LABEL BUFFER AREA            63600017
         C     R3,ZERO        IS ADDR. OF LABEL BUFFER AREA ZERO        63800017
         BNE   TTESTIO2       NO, BRANCH                                64000017
         XI    NOLB,X'02'     YES, TURN NOLB SW ON TO IND. NO LAB       64200017
         MVC   INTLCT2(4),ZERO     SET SYSUT2 TRAILER LABEL COUNT 0     64400017
         B     TEXT2          BRANCH                                    64600017
TTESTIO2 TM    8(R1),X'80'    DID I/O ERROR OCCUR WHILE READ USER       64800017
         BO    TIOERR2        INPUT TRAILER ON SYSUT2                   65000017
TNTEST2  TM    LABEL,X'01'    DATA=NO                                   65200017
         BO    INTEXT2        YES, DATA=NO                              65400017
         CLI   3(R3),X'F1'    IS THIS THE 1ST LABEL OF THE GROUP        65600017
         BNE   INITT2         NO, BRANCH                                65800017
         MVC   INTLCT2(4),ZERO     SET SYSUT2 TRAILER LABEL COUNT 0     66000017
          NI   NOLB,X'01'    TURN NOLB SW OFF                           66200017
         CLC   INTL2(4),ZERO  HAS VOL-SWITCH TIME TRAILER LABEL         66400017
*                             BEEN SAVED                                66600017
         BNE   INITT2         YES,USE THE SAME SAVE ARER TO OVER        66800017
*                             LAY THOSE LABELS                          67000017
         LR    R2,R1                                                    67200017
         GETMAIN   R,LV=640                                             67400017
         ST    R1,INTL2       SAVE GOTTEN CORE ADDR. AT INTL2           67600017
         LR    R1,R2                                                    67800017
INITT2   L     R2,INTL2                                                 68000017
         L     R5,INTLCT2                                               68200017
         M     R4,EIGHTY                                                68400017
         AR    R2,R5          REG.2 HAS ADDR. OF NEXT AVAIL. LABEL      68600017
*                             SAVE AREA FOR SYSUT2                      68800017
         L     R5,INTLCT2                                               69000017
         LA    R5,1(R5)       ADD 1 TO INPUT TRAILER LABEL CT FOR       69200017
         ST    R5,INTLCT2     SYSUT2                                    69400017
*                                                                       69600017
TLABSAVE L     R3,0(R1)       GET ADDR. OF LABEL BUFFER                 69800017
         MVC   0(80,R2),0(R3) MOVE LABEL INTO LABEL SAVE AREA           70000017
         TM    EXIT3SW,X'01'  IS THERE AN USER INTLR                    70200017
         BZ    RET            NO,THERE IS NO USER INTLR                 70400017
         TM    NOEXTSW,X'01'  YES,IS NO MORE EXIT TO INTLR SW ON        70600017
         BO    RET            YES,NO MORE EXIT TO INTLR                 70800017
GOTLR    L     R15,UTRADR    NO,GO TO USER INTLR                        71000017
         BALR  R14,R15        GO TO USER INTLR                          71200017
CKRCODE  STC   R15,RETCODE                                              71400017
         CLI   RETCODE,X'04'  RET. CODE FROM USER = 4                   71600017
         BNE   CKMORE                                                   71800017
         B     RET                                                      72000017
CKMORE   CLI   RETCODE,X'00'   RET CODE FROM USER = 0                   72200017
         BE    NOEXT          YES, BRANCH                               72400017
         MVI   TERMSW,X'01'   NO,SET TERM. AFTER LABEL PROC. SW ON      72600017
NOEXT    MVI   NOEXTSW,X'01' TURN NO EXIT TO USER LAB. PROC. SW ON      72800017
* INIT. MSG: IEB248I (NO.) EXITS TO (USER EXIT RTN) IS MADE FOR       * 72860017
*                    SYSUT(1/2) RETURN CODE FROM USER ROUTINE IS (NO.)* 72920017
         CVD   R15,CONVTDEC             CONVERT THE USER RET CODE       73000017
         UNPK  PTAREA(3),CONVTDEC+6(2)  TO PRINTABLE CHARACTER          73200017
         OI    PTAREA+2,X'F0'                                           73400017
         MVC   LAB3+8(2),PTAREA+1                                       73600017
         CVD   R5,CONVTDEC              CONVERT THE NO. OF EXITS        74200017
         UNPK  PTAREA(3),CONVTDEC+6(2)                                  74400017
         OI    PTAREA+2,X'F0'           PRINTABLE CHARACTER             74600017
         MVC   LABMSG+8(1),PTAREA+2                                     74700017
         MVC   MYPRTARE(120),BLANKS                                     74800017
         MVC   MYPRTARE(84),LABMSG                                      74900017
         LA    R0,119                                                   75200017
         LA    R1,MYPRTARE                                              75400017
         L     R15,MYPRTCON                                             75600017
         BALR  R14,R15        GO TO PRINT THE MSG                       75800017
         TM    LABEL,X'30'    IS DATA=ALL OR DATA=ONLY                  76000017
         BM    RET            YES, GO GET MORE LABEL                    76200017
RET1     LA    R15,0                                                    76400017
         LM    R1,R14,USAVE                                             76600017
           BR  R14            RET. TO OPEN/CLOSE/EOV                    76800017
RET      LA    R15,4          GO GET MORE LABELS                        77000017
         LM    R1,R14,USAVE                                             77200017
         BR    R14            RET. TO OPEN/CLOSE/EOV                    77400017
INTEXT1  CLI   3(R3),X'F1'    IS THIS THE 1ST LABEL OF THE GROUP        77600017
         BNE   TEXT1          NO, BRANCH                                77800017
         MVC   INTLCT1(4),ZERO     SET SYSUT1 TRAILER LAB COUNT 0       78000017
TEXT1    L     R5,INTLCT1                                               78200017
         LA    R5,1(R5)                                                 78400017
         ST    R5,INTLCT1                                               78600017
         B     INTEXT         BRANCH                                    78800017
INTEXT2  CLI   3(R3),X'F1'    IS THIS THE 1ST LABEL OF THE GROUP        79000017
         BNE   TEXT2          BRANCH                                    79200017
         MVC   INTLCT2(4),ZERO  SET SYSUT2 TRAILER LABEL COUNT 0        79400017
TEXT2    L     R5,INTLCT2                                               79600017
         LA    R5,1(R5)                                                 79800017
         ST    R5,INTLCT2                                               80000017
INTEXT   TM    EXIT3SW,X'01'  IS THERE AN USER INTLR                    80200017
         BZ    RET1           NO, IGNORE THE REST OF THE LABELS         80400017
         B     GOTLR          BRANCH                                    80600017
*                                                                       80800017
IOERR1   ST    R1,SAVE1                                                 81000017
         LA    R1,43          I/O ERROR WHILE READ INPUT HEADER ON DS1  81200017
         L     R15,PRINCONS                                             81400017
         BALR  R14,R15        PRINT MSG                                 81600017
         L     R1,SAVE1                                                 81800017
         B     NTEST1         BRANCH                                    82000017
*                                                                       82200017
IOERR2   ST    R1,SAVE1                                                 82400017
         LA    R1,44          I/O ERROR WHILE READ INPUT HEADER ON DS2  82600017
         L     R15,PRINCONS                                             82800017
         BALR  R14,R15        PRINT MSG                                 83000017
         L     R1,SAVE1                                                 83200017
         B     NTEST2         BRANCH                                    83400017
TIOERR1  ST    R1,SAVE1                                                 83600017
         LA    R1,45          I/O ERROR WHILE READ INPUT TRAILER ON DS1 83800017
         L     R15,PRINCONS                                             84000017
         BALR  R14,R15        PRINT MSG                                 84200017
         L     R1,SAVE1                                                 84400017
         B     TNTEST1        BRANCH                                    84600017
*                                                                       84800017
TIOERR2  ST    R1,SAVE1                                                 85000017
         LA    R1,46          I/O ERROR WHILE READ INPUT TRAILER ON DS2 85200017
         L     R15,PRINCONS                                             85400017
         BALR  R14,R15        PRINT MSG                                 85600017
         L     R1,SAVE1                                                 85800017
         B     TNTEST2        BRANCH                                    86000017
*                                                                       86200017
PRINCONS DC    V(JPRINTRT)                                              86400017
MYPRTCON DC    V(ZZPR)                                                  86600017
SAVE1    DS    1F                                                       86800017
SAVE14   DC    F'0'           REG.14 SAVE AREA                          87000017
EIGHTY   DC    F'80'                                                    87200017
ZERO     DC    F'0'                                                     87400017
BLANKS   DC    CL4'    '                                                87600017
MYPRTARE DS    30F                                                      87800017
USAVE    DS    14F                                                      88000017
MYSAVE   DS    18F                                                      88200017
PTAREA   DS    1F                                                       88400017
CONVTDEC DS    1D                                                       88600017
C16      DC    X'F1F6'                                                  88800017
FSW1     DC    X'01'          FIRST TIME SW FOR SYSUT1 INHDR EXIT       89600017
FSW2     DC    X'01'          FIRST TIME SW FOR SYSUT2 INHDR EXIT       89800017
RETCODE  DC    X'00'          RET. CODE FROM USER LABEL RTN             90000017
TFSW1    DC    X'01'          FIRST TIME SW FOR SYSUT1 INTLR EXIT       90200017
TFSW2    DC    X'01'          FIRST TIME SW FOR SYSUT2 INTLR EXIT       90400017
*********************************************************************** 90420017
*        THE FOLLOWING MESSAGE IS BUILT AT EXECUTION TIME             * 90440017
LABMSG   DC    CL10'IEB248I   '                                         90460017
LABMSG2  DC    CL32'EXITS TO          IS MADE FOR SY'                   90480017
LAB2     DC    CL32'SUT    RETURN CODE FROM USER ROU'                   90500017
LAB3     DC    CL10'TINE IS   '                                         90520017
         END                                                            90600017
