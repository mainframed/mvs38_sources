./  ADD  SSI=71880040,NAME=IEBISAM
 TITLE 'IEBISAM - IEBISAM UTILITY PROGRAM - ROOT SEGMENT'               00200016
*STATUS-CHANGE LEVEL 000                                                00400016
*FUNCTION-OPERATION- THE ROOT SEGMENT OF THE IEBISAM UTILITY PROGRAM    00600016
*   GETS CORE FOR THE COMMON WORK AREA, CHAINS THE SAVE AREAS TO THE    00800016
*   SUPERVISOR. THIS MODULE PICKS UP ANY INVOKING PARAMETERS- OPTIONS,  01000016
*   DDNAMES, AND/OR PAGE NUMBER. FROM THE OPTIONS GIVEN, THE OPERATION  01200016
*   TO BE PERFORMED IS DETERMINED.  DEPENDING UPON THE CONTROL          01400016
*   PARAMETER, A MASK IS SET IN THE CONTROL BYTE FIELD OF THE COMMON    01600016
*   WORK AREA.  A CHECK IS MADE TO DETERMINE IF REPLACEMENT DDNAMES     01800016
*   FOR SYSPRINT,SYSUT1,AND SYSUT2 ARE PRESENT. IF SO THESE DD NAMES    02000016
*   ARE PLACED IN THE COMMON WORK AREA, OTHERWISE THE ASSUMED DDNAMES   02200016
*   SYSPRINT,SYSUT1,AND SYSUT2 ARE USED. IF A PAGE NUMBER IS PROVIDED,  02400016
*   IT IS USED OTHERWISE AN ASSUMED NUMBER (1) IS USED. CONTROL IS      02600016
*   THEN PASSED TO THE MODULE REQUIRED TO PERFORM THE REQUESTED         02800016
*   OPERATION.                                                          03000016
*                                                                       03200016
*ENTRY POINTS- IEBISR- TO PROVIDE COMMON WORK AREA, HANDLE INVOKING     03400016
*   PARAMETERS, AND DETERMINE OPERATION.                                03600016
*                                                                       03800016
*INPUT - ADDRESS OF INVOKING PARAMETERS IN REGISTER 1, SAVE AREA        04000016
*   ADDRESS IN REGISTER 13, RETURN ADDRESS OF CALLING PROGRAM IN        04200016
*   REGISTER 14, ADDRESS OF THIS MODULE IN REGISTER 15.                 04400016
*                                                                       04600016
*OUTPUT - COMMON WORK AREA ESTABLISHED- DEFINED BY THE DSECT IEBWORK-   04800016
*   POINTED TO BY REGISTER 11.                                          05000016
*                                                                       05200016
*                                                                       05400016
*                                                                       05600016
* WORK AREA FIELDS SET UP FOR NORMAL EXIT                               05800016
*        ISINVOK -  ADDRESS OF PARM LIST FROM INVOCATION                06000016
*        ISPRINT -  NAME FOR PRINT DD                                   06200016
*        ISUT1 -    NAME FOR INPUT DD                                   06400016
*        ISUT2 -    NAME FOR OUTPUT DD                                  06600016
*        ISPAGE -   PAGE NUMBER TO BE USED                              06800016
*        ISCNTRL -  SET TO INDICATE OPTIONS REQUESTED                   07000016
*        XCTLAREA - SET FOR XCTL TO NEXT MODULE- IEBISL,IEBISU,IEBISC,  07200016
*                   IEBISPL,IEBISPP                                     07400016
*        EXITADDR - USER'S MODULE NAME                                  07600016
*                                                                       07800016
*WORKAREA FIELDS SET UP FOR ERROR EXIT                                  08000016
*        ISINVOK  - ADDRESS OF PARM LIST FROM INVOCATION                08200016
*        ISCOMP   - COMPLETION CODE TO BE RETURNED                      08400016
*        ISMESS   - MESSAGE NUMBER TO BE USED TO SELECT MESSAGE         08600016
*        ISPAGE  -  PAGE NUMBER TO BE USED                              08800016
*        XCTLAREA & WHICH -  SET FOR XCTL TO IEBISF                     09000016
*                                                                       09200016
*                                                                       09400016
*                                                                       09600016
*EXTERNAL ROUTINES - NA                                                 09800016
*                                                                       10000016
*EXITS-NORMAL                                                           10200016
*   IEBISL- CONTROL PARAMETER SPECIFIED LOAD OPERATION                  10400016
*   IEBISU- CONTROL PARAMETER SPECIFIED UNLOAD OPERATION                10600016
*   IEBISC- CONTROL PARAMETER SPECIFIED COPY OPERATION                  10800016
*   IEBISPL- CONTROL PARAMETER SPECIFIED PRINT LOGICAL OPERATION        11000016
*   IEBISPP- CONTROL PARAMETER SPECIFIED PRINT PHYSICAL OPERATION       11200016
*                                                                       11400016
*ATTRIBUTES- REENTRANT                                                  11600016
*                                                                       11800016
*REGISTER ASSIGNMENTS                                                   12000016
PAREG0   EQU   0                                                        12200016
PAREG1   EQU   1                                                        12400016
CONS     EQU   2                                                        12600016
WK3      EQU   3                                                        12800016
WK4      EQU   4                                                        13000016
WK5      EQU   5                                                        13200016
WK6      EQU   6                                                        13400016
OPREG    EQU   7                                                        13600016
IRETREG  EQU   8                                                        13800016
GOREG    EQU   9                                                        14000016
BASEREG  EQU   10                                                       14200016
WORKAREA EQU   11                                                       14400016
PTREG    EQU   12                                                       14600016
SAVREG   EQU   13                                                       14800016
RETREG   EQU   14                                                       15000016
ADDR     EQU   15                                                       15200016
         EJECT                                                          15400016
IEBISAM  CSECT                                                          15600016
* STANDARD LINKAGE CONVENTION                                           15800016
         SAVE  (14,12),T,ISR-67-V1      SAVE CALLING PROGRAM'S REGS     16000016
         USING IEBISAM,BASEREG          ESTABLISH ADDRESSABILITY        16200016
         LR    BASEREG,ADDR                                             16400016
         LR    OPREG,PAREG1             SAVE PARAMETER LIST POINTER     16600016
*                                          WHILE OBTAINING WORK AREA    16800016
         SPACE 1                                                        17000016
         GETMAIN R,LV=1536              GET WORK AREA                   17200016
* CLEAR THE ENTIRE WORK AREA TO ZEROS                                   17400016
         LR    WORKAREA,PAREG1          SET UP ADDRESSABILITY TO WORK   17600016
*                                          AREA                         17800016
         USING IEBWORK,WORKAREA         SET UP ADDRESSABILITY TO WORK   18000016
*                                          AREA                         18200016
         MVI   SAVE1BK,X'00'                                            18400016
         MVC   SAVE1BK+1+0*255(255),SAVE1BK+0*255                       18600016
         MVC   SAVE1BK+1+1*255(255),SAVE1BK+1*255                       18800016
         MVC   SAVE1BK+1+2*255(255),SAVE1BK+2*255                       19000016
         MVC   SAVE1BK+1+3*255(255),SAVE1BK+3*255                       19200016
         MVC   SAVE1BK+1+4*255(255),SAVE1BK+4*255                       19400016
         MVC   SAVE1BK+1+5*255(255),SAVE1BK+5*255                       19600016
         MVI   EXITADDR,X'40'           SET EXIT ADDRESS TO BLANKS      19800016
         MVC   EXITADDR+1(7),EXITADDR                                   20000016
         ST    OPREG,ISINVOK            SAVE POINTER TO INVOCATION LIST 20200016
         SPACE 1                                                        20400016
         ST    SAVREG,SAVE1BK           SET BACK CHAIN POINTER          20600016
         LR    SAVREG,WORKAREA         UPDATE TO NEW SAVE AREA          20800016
         LA    WK3,SAVE2                SET UP FORWARD CHAIN POINTER    21000016
         ST    WK3,SAVE1FD                 TO NEXT SAVE AREA            21200016
*THIS SECTION CHECKS FOR THE EXISTENCE OF AN OPTION,OBTAINS THE LENGTH  21400016
*OF THIS OPTION AND ITS ADDRESS IS SAVED.                               21600016
OPTION   L     GOREG,0(0,OPREG)         GET ADDRESS OF OPTIONS          21800016
         OC    0(2,GOREG),0(GOREG)      ANY OPTIONS SPECIFIED           22000016
         BZ    LABELUN                  NO, ASSUME UNLOAD               22200016
         MVC   ALIGN(2),0(GOREG)        YES, GET LENGTH OF OPTIONS -    22400016
         LH    WK6,ALIGN                   MOVE TO HALF-WORD BOUNDARY   22600016
         LA    WK5,2(0,GOREG)           GET OPTION ADDRESS              22800016
*                                                                       23000016
         EJECT                                                          23200016
* THIS SECTION CHECKS THE OPTION CODE FOR A LEGAL OPERATION.            23400016
         CLI   ALIGN+1,X'06'            CHECK FOR LENGTH LESS THAN SIX  23600016
         BNL   CKOTHER                  NO, CHECK FOR UNLOAD,PRINT      23800016
         CLI   ALIGN+1,X'04'            CHECK FOR LENGTH OF FOUR        24000016
         BNE   ASSUMECY                 NO, GO TO SET ERROR CONDITION   24200016
         CLC   0(4,WK5),OPCOPY          CHECK FOR A COPY REQUEST        24400016
         BE    SETCOPY                  YES, SET CONTROL BYTE FOR COPY  24600016
         CLC   0(4,WK5),OPLOAD          CHECK FOR A LOAD REQUEST        24800016
         BNE   ASSUMECY                 NO, GO TO SET ERROR CONDITION   25000016
         MVI   ISCNTRL,ISSWL            SET CONTROL BYTE FOR LOAD       25200016
         MVC   WHICH(8),LODCON          MOVE SYMBOLIC ENTRY POINT FOR   25400016
*                                          XCTL                         25600016
         B     ONWARD                                                   25800016
SETCOPY  MVI   ISCNTRL,ISSWC            SET CONTROL BYTE FOR COPY       26000016
         MVC   WHICH(8),CPYCON          MOVE SYMBOLIC ENTRY POINT FOR   26200016
*                                          XCTL                         26400016
         B     ONWARD                                                   26600016
CKOTHER  CLC   0(5,WK5),OPPRNT          CHECK FOR A PRINT REQUEST       26800016
         BE    CKPRNT                   YES, DETERMINE WHETHER LOGICAL  27000016
*                                          OR PHYSICAL                  27200016
         CLI   ALIGN+1,X'06'            CHECK FOR LENGTH EQUAL TO SIX   27400016
         BNE   ASSUMECY                 NO,SET ERROR CONDITION          27600016
         CLC   0(6,WK5),OPUNLD          CHECK FOR AN UNLOAD REQUEST     27800016
         BNE   ASSUMECY                 NO, GO TO SET ERROR CONDITION   28000016
LABELUN  MVI   ISCNTRL,ISSWU            SET CONTROL BYTE FOR UNLOAD     28200016
         MVC   WHICH(8),UNLCON          MOVE SYMBOLIC ENTRY POINT NAME  28400016
*                                          FOR XCTL                     28600016
         B     ONWARD                                                   28800016
*THIS SECTION CHECKS FOR LEGAL PARAMETERS ON A PRINT REQUEST            29000016
CKPRNT   CLI   5(WK5),C'L'        CHECK FOR A LOGICAL PRINT             29200016
*                                          REQUEST                      29400016
         BE    SETLOG                   YES, SET CONTROL BYTE           29600016
         CLI   5(WK5),C'P'        CHECK FOR A PHYSICAL PRINT            29800016
*                                          REQUEST                      30000016
         BNE   ASSUMECY                 NO, SET ERROR CONDITION         30200016
         MVC   WHICH(8),PRTPCON         MOVE IN SYMBOLIC ENTRY NAME     30400016
*                                          FOR XCTL                     30600016
         B     PRINTSET                                                 30800016
SETLOG   MVC   WHICH(8),PRTLCON         MOVE IN SYMBOLIC ENTRY NAME     31000016
*                                          FOR XCTL                     31200016
PRINTSET MVI   ISCNTRL,ISSWP            SET CONTROL BYTE FOR PRINT      31400016
         LR    WK3,WK5                  PICK UP POINTER TO LIST         31600016
         AR    WK3,WK6                  ADD LENGTH OF LIST TO OBTAIN    31800016
*                                          END POINTER                  32000016
         SH    WK6,=H'6'                SUBTRACT 6 FROM LENGTH OF LIST  32200016
         LA    WK5,6(0,WK5)             POINT TO NEXT CHARACTER TO BE   32400016
*                                          SCANNED                      32600016
         CR    WK5,WK3                  CHECK FOR END OF LIST           32800016
         BNL   CKONWARD                 YES, CHECK FOR NEED OF DEFAULT  33000016
*                                          VALUES                       33200016
         CLI   0(WK5),C','              CHECK FOR LEGAL DELIMITER       33400016
         BNE   ASSUMECY                 NO, GO TO SET ERROR CONDITION   33600016
         LA    WK5,1(0,WK5)             UPDATE POINTER BEYOND DELIMITER 33800016
         LR    WK4,WK5                  SET MOVING POINTER TO INITIAL   34000016
*                                          VALUE                        34200016
         SR    CONS,CONS                CLEAR BYTE COUNTER              34400016
         CR    WK4,WK3                  CHECK FOR END OF LIST           34600016
         BNL   ASSUMECY                 YES, GO TO GET ERROR CONDITION  34800016
SCANBEG  CLI   0(WK4),C','              CHECK FOR DELIMITER             35000016
         BE    ASSUMECY                 YES, GO TO SET ERROR CONDITION  35200016
SCANBEGA CLI   0(WK4),C'N'              CHECK FOR NO CONVERT OPTION     35400016
         BE    SETN                     YES, NO CONVERT SPECIFIED       35600016
         CLI   0(WK4),C'I'              CHECK FOR INDEX TO BE PRINTED   35800016
         BE    SETI                     YES, INDEX SPECIFIED            36000016
         CLI   0(WK4),C'P'              CHECK FOR PRIME TO BE PRINTED   36200016
         BE    SETP                     YES,PRIME SPECIFIED             36400016
         CLI   0(WK4),C'O'              CHECK FOR OVERFLOW PRINTED      36600016
         BE    SETO                     YES, OVERFLOW SPECIFIED         36800016
         C     WK6,=F'6'                CHECK FOR LENGTH OF AT LEAST 6  37000016
         BL    ASSUMECY                 NO, GO TO SET ERROR CONDITION   37200016
         CLC   0(5,WK4),EXITCON         CHECK FOR EXIT=                 37400016
         BNE   ASSUMECY                 NO, GO TO SET  ERROR CONDITION  37600016
         SH    WK6,=H'5'                SUBTRACT 5 FROM LIST LENGTH     37800016
         LA    WK4,5(0,WK4)             UPDATE MOVING POINTER TO USER'S 38000016
*                                          MODULE NAME                  38200016
         LR    WK5,WK4                  SET BEGINNING POINTER           38400016
SCANSTRT CLI   0(WK4),X'5B'             CHECK FOR DOLLAR SIGN           38600016
         BE    GOAHEAD                  YES, CHECK FOR SECOND CHARACTER 38800016
         CLI   0(WK4),X'7C'             CHECK FOR A COMMERCIAL  AT      39000016
*                                          SIGN                         39200016
         BE    GOAHEAD                  YES, CHECK FOR SECOND CHARACTER 39400016
         CLI   0(WK4),X'7B'             CHECK FOR A POUND SIGN          39600016
         BE    GOAHEAD                  YES, CHECK FOR SECOND CHARACTER 39800016
         CLI   0(WK4),X'C1'             CHECK FOR CHARACTER FROM A TO I 40000016
         BL    ASSUMECY                 NO,GO TO SET ERROR CONDITION    40200016
         CLI   0(WK4),X'C9'             CHECK FOR CHARACTER FROM A TO I 40400016
         BNH   GOAHEAD                  YES, CHECK FOR SECOND CHARACTER 40600016
         CLI   0(WK4),X'D1'             CHECK FOR CHARACTER FROM J TO R 40800016
         BL    ASSUMECY                 NO, GO  TO SET ERROR CONDITION  41000016
         CLI   0(WK4),X'D9'             CHECK FOR CHARACTER FROM J TO R 41200016
         BNH   GOAHEAD                  YES, CHECK SECOND CHARACTER     41400016
         CLI   0(WK4),X'E2'             CHECK FOR CHARACTER FROM S TO Z 41600016
         BL    ASSUMECY                 NO, GO TO SET ERROR CONDITION   41800016
         CLI   0(WK4),X'E9'             CHECK FOR CHARACTER FROM S TO Z 42000016
         BNH   GOAHEAD                  YES, CHECK FOR SECOND CHARACTER 42200016
         B     ASSUMECY                 NO, GO TO SET ERROR CONDITION   42400016
GOAHEAD  LA    CONS,1(0,CONS)           UPDATE BYTE COUNTER             42600016
         LA    WK4,1(0,WK4)             UPDATE MOVING POINTER TO NEXT   42800016
*                                          CHARACTER                    43000016
         CR    WK4,WK3                  CHECK FOR END OF LIST           43200016
         BNL   SCANDONE                 YES, SET UP MODULE NAME         43400016
         CLI   0(WK4),C','              CHECK FOR DELIMITER             43600016
         BE    SCANDONE                 YES, GO BACK                    43800016
         CLI   0(WK4),X'F9'             CHECK FOR CHARACTER FROM 0 TO 9 44000016
         BH    ASSUMECY                 NO,SET ERROR CONDITION          44200016
         CLI   0(WK4),X'F0'             CHECK FOR CHARACTER FROM 0 TO 9 44400016
         BNL   GOAHEAD                  YES, CHECK NEXT CHARACTER       44600016
         B     SCANSTRT                                                 44800016
SCANDONE C     CONS,=F'8'               CHECK FOR MODULE NAME LENGTH    45000016
*                                          BEING LESS THAN OR EQUAL TO  45200016
*                                          EIGHT                        45400016
         BH    ASSUMECY                 NO,GO TO SET UP ERROR CONDITION 45600016
         BCTR  CONS,0                   REDUCE CHARACTER NUMBER BY ONE  45800016
         EX    CONS,MOVENAME            MOVE MODULE NAME INTO HOLD AREA 46000016
         CR    WK4,WK3                  CHECK FOR END OF LIST           46200016
         BNL   CKONWARD                 YES, CHECK FOR NEED OF DEFAULT  46400016
*                                          VALUES                       46600016
         CLI   0(WK4),C','              CHECK FOR A DELIMITER           46800016
         BNE   ASSUMECY                 NO, GO TO SET ERROR CONDITION   47000016
*                                          MOVE IN MODULE NAME          47200016
         LA    WK4,1(0,WK4)             UPDATE MOVING POINTER           47400016
         LR    WK5,WK4                  UPDATE BEGINNING POINTER        47600016
         B     SCANBEG                                                  47800016
CKONWARD TM    ISCNTRL,ALLMASK          CHECK FOR ANY OPTIONS SPECIFIED 48000016
*                                          FOR INDEX,PRIME,OVERFLOW     48200016
         BC    5,ONWARD                 YES, SOME SPECIFIED             48400016
         OI    ISCNTRL,ALLMASK          SET TO DEFAULT TO PRINT ALL     48600016
*                                          THREE AREAS                  48800016
         B     ONWARD                                                   49000016
SETN     OI    ISCNTRL,ISSWN            SET FOR NO CONVERT              49200016
UPDATE   LA    WK4,1(0,WK4)             UPDATE MOVING POINTER           49400016
         CR    WK4,WK3                  CHECK FOR END OF LIST           49600016
         BNL   CKONWARD                 YES, CHECK FOR DEFAULT OPTIONS  49800016
*                                          NEEDED                       50000016
         CLI   0(WK4),C','              CHECK FOR COMMA DELIMETER       50200016
         BNE   SCANBEGA                 NO, SCAN FOR OPTIONS            50400016
         B     UPDATE                                                   50600016
SETI     OI    ISCNTRL,ISSWPI           SET FOR INDEX PRINT             50800016
         B     UPDATE                                                   51000016
SETP     OI    ISCNTRL,ISSWPP           SET FOR PRIME PRINT             51200016
         B     UPDATE                                                   51400016
SETO     OI    ISCNTRL,ISSWPO           SET FOR OVERFLOW PRINT          51600016
         B     UPDATE                                                   51800016
         EJECT                                                          52000016
*THIS SECTION GETS THE ADDRESS OF THE DDNAMES IF ANY ARE PROVIDED,      52200016
*OTHERWISE THE STANDARD DDNAMES ARE USED.                               52400016
*                                                                       52600016
ONWARD   TM    0(OPREG),X'80'          IS A DELIMITER PRESENT           52800016
         BC    1,CONAME                YES, PICK UP ASSUMED DDNAMES     53000016
SUBST    L     GOREG,4(0,OPREG)         GET  DDNAME ADDRESS             53200016
         OC    0(2,GOREG),0(GOREG)     CHECK FOR DDNAMES SUPPLIED       53400016
         BE    CONAME                   NO USE ASSUMED DDNAMES          53600016
         MVC   ALIGN(2),0(GOREG)        PICK UP DDNAME LENGTH           53800016
         CLI   ALIGN,X'00'              CHECK FOR LENGTH OF DDNAME LIST 54000016
*                                          GREATER THAN 256 HEX         54200016
         BNE   TESTALL                  YES CHECK FOR ALL 3 DDNAMES     54400016
         CLI   ALIGN+1,X'48'            CHECK FOR LENGTH OF DDNAME LIST 54600016
*                                          SUFFICIENT FOR SYSUT2        54800016
         BL    TESTREST                 NO CHECK FOR SYSUT1 LENGTH      55000016
TESTALL  OC    66(8,GOREG),66(GOREG)   CHECK FOR SYSUT2 DDNAME          55200016
         BC    7,INVUT2                 YES PICK UP PROVIDED NAME       55400016
         MVC   ISUT2(8),NAMEUT2         MOVE ASSUMED NAME               55600016
         B     TESTTWO                                                  55800016
INVUT2   MVC   ISUT2(8),66(GOREG)      MOVE IN PROVIDED NAME FOR        56000016
*                                          SYSUT2                       56200016
TESTTWO  OC    58(8,GOREG),58(GOREG)   CHECK FOR SYSUT1 DDNAME          56400016
         BC    7,INVUT1                 YES PICK UP PROVIDED NAME       56600016
         MVC   ISUT1(8),NAMEUT1        MOVE ASSUMED NAME                56800016
         B     TESTONE                                                  57000016
INVUT1   MVC   ISUT1(8),58(GOREG)       MOVE IN PROVIDED NAME FOR       57200016
*                                          SYSUT1                       57400016
TESTONE  OC    42(8,GOREG),42(GOREG)    CHECK FOR SYSPRINT              57600016
         BC    7,INVPRT                 YES PICK UP PROVIDED NAME       57800016
USEPRINT MVC   ISPRINT(8),PRINT         MOVE ASSUMED NAME               58000016
         B     SUPPLY1                                                  58200016
INVPRT   MVC   ISPRINT(8),42(GOREG)     MOVE IN PROVIDED NAME FOR       58400016
*                                          SYSPRINT                     58600016
         B     SUPPLY1                                                  58800016
TESTREST CLI   ALIGN+1,X'40'            CHECK FOR LENGTH OF DDNAME LIST 59000016
*                                          SUFFICIENT FOR SYSUT1        59200016
         BNL   TESTTWO                  YES CHECK FOR SYSUT1            59400016
         CLI   ALIGN+1,X'30'            CHECK FOR LENGTH OF DDNAME LIST 59600016
*                                          SUFFICIENT FOR SYSPRINT      59800016
         BNL   TESTONE                  YES CHECK FOR SYSPRINT          60000016
*USE ALL THREE ASSUMED NAMES                                            60200016
CONAME   MVC   ISUT2(8),NAMEUT2        PICK UP ASSUMED NAMES FOR        60400016
         MVC   ISUT1(8),NAMEUT1           SYSUT1,SYSUT2 AND SYSPRINT    60600016
         B     USEPRINT                                                 60800016
         EJECT                                                          61000016
*THIS SECTION CHECKS FOR THE EXISTENCE OF A PROVIDED PAGE NUMBER. IF    61200016
*ONE IS NOT PROVIDED ONE IS ASSUMED.                                    61400016
SUPPLY1  TM    0(OPREG),X'80'          CHECK FOR A DELIMITER ON FIRST   61600016
*                                          PARAMETER                    61800016
         BC    1,OTHER                  YES, ASSUME 1 AS PAGE NUMBER    62000016
         TM    4(OPREG),X'80'           CHECK FOR A DELIMITER ON THE    62200016
*                                          SECOND PARAMETER             62400016
         BC    1,OTHER                  YES, ASSUME 1 AS PAGE NUMBER    62600016
PAGE     L     GOREG,8(0,OPREG)         GET PAGE NUMBER ADDRESS         62800016
         OC    0(2,GOREG),0(GOREG)     CHECK FOR A PROVIDED PAGE NO     63000016
         BE    OTHER                    NO PROVIDE ONE                  63200016
*THIS SECTION MOVES THE PAGE NUMBER TO THE ISPAGE FIELD, UPDATES THE    63400016
*PAGE NUMBER AND RESTORES THE UPDATED PAGE NUMBER FOR THE CALLER.       63600016
         SR    WK6,WK6                                                  63800016
         XC    DOUBLE(8),DOUBLE                                         64000016
         MVC   ALIGN(4),2(GOREG)       GET PAGE NUMBER                  64200016
         PACK  DOUBLE+5(3),ALIGN       PUT IN PACKED FORMAT             64400016
         CVB   WK6,DOUBLE               CONVERT NUMBER TO BINARY        64600016
OKAY     STH   WK6,ISPAGE               MOVE PAGE NUMBER TO ISPAGE      64800016
         LA    WK6,1(0,WK6)             UPDATE PAGE NUMBER              65000016
         CVD   WK6,DOUBLE               CONVERT NUMBER TO DECIMAL       65200016
         UNPK  ALIGN(4),DOUBLE+5(3)     UNPACK THE PAGE NUMBER          65400016
         MVC   2(4,GOREG),ALIGN         RESTORE UPDATED PAGE NUMBER     65600016
         B     DA000                                                    65800016
*WHEN A PAGE NUMBER IS NOT PROVIDED BY THE CALLER ONE IS ASSUMED        66000016
OTHER    LA    WK6,1                    MOVE ASSUMED PAGE NUMBER        66200016
         STH   WK6,ISPAGE                                               66400016
         EJECT                                                          66600016
DA000    TIME                                                           66603016
         LR    PAREG0,PAREG1            PICK UP DATE                    66606016
         SRDL  PAREG0,16                SEPARATE YEARS AND DAYS         66609016
         SRL   PAREG1,16                DAYS PUT LOW ORDER              66612016
         LR    WK4,PAREG0               SAVE YEAR                       66615016
         SR    PAREG0,PAREG0            CLEAR REGISTER                  66618016
         LA    WK3,19                   TEST TO SEE IF YEAR(IN DECIMAL) 66621016
         NR    WK3,WK4                    IS DIVISABLE BY FOUR          66624016
         BZ    DA010                    NO--NOT DIVISABLE BY FOUR       66627016
         LA    CONS,18                                                  66630016
         XR    WK3,CONS                 IS THIS A LEAP YEAR ENDING IN   66633016
*                                          ZERO                         66636016
         BZ    DA010                                                    66639016
         LA    WK3,1                                                    66642016
*                                                                       66645016
DA010    STM   PAREG0,PAREG1,DOUBLE                                     66648016
         CVB   CONS,DOUBLE              CONVERT DAYS TO BINARY          66651016
         SR    PAREG1,PAREG1                                            66654016
         LR    WK5,PAREG1                                               66657016
*                                                                       66660016
DA020    LA    PAREG1,1(PAREG1)         INCREMENT MONTH                 66663016
         IC    WK5,XTMN-1(PAREG1)       DAYS IN MONTH                   66666016
         SR    CONS,WK5                 SUBTRACT FROM DAYS LEFT         66669016
         LA    WK6,3                    CONSTANT FOR 3RD MONTH          66672016
         CLR   WK6,PAREG1               IS THIS MARCH                   66675016
         BC    7,DA030                  NO                              66678016
         LTR   WK3,WK3                  YES, IS IT LEAP YEAR            66681016
         BC    2,DA030                  NO                              66684016
         BCTR  CONS,0                   YES, REDUCE DAYS BY ONE         66687016
*                                                                       66690016
DA030    LTR   CONS,CONS                ARE DAYS COUNTED DOWN TO ZERO   66693016
         BC    2,DA020                  NO, REPEAT LOOP                 66696016
         AR    CONS,WK5                 YES, RESTORE SUBTRACTED VALUE   66699016
         LTR   CONS,CONS                TEST FOR ZERO (FEBRUARY 29)     66702016
         BNZ   DA040                    NO                              66705016
         LA    CONS,29                  YES, SET DAY FOR 29TH           66708016
         BCTR  PAREG1,0                 DECREMENT TO FEBRUARY           66711016
*                                                                       66714016
DA040    LA    WK3,2                    LOOP COUNT                      66717016
DA050    CVD   PAREG1,DOUBLE            CHANGE MONTH TO DECIMAL         66720016
         L     WK5,DOUBLE+4             MONTH TO LOWER HALF             66723016
         SLL   WK5,20                                                   66726016
         SLDL  WK4,8                    SHIFT UP TO YEAR OR MONTH       66729016
         LR    PAREG1,CONS              DAY                             66732016
         BCT   WK3,DA050                REPEAT UNTIL DONE               66735016
         SLL   WK4,8                    POSITION DATE FOR STORING       66738016
         ST    WK4,DOUBLE         CONVERT FOR PRINTING                  66741016
         UNPK  QISAM(7),DOUBLE(4)                                       66744016
         MVC   TARGET(2),QISAM+2        MOVE IN MONTH OF YEAR           66747016
         MVI   TARGET+2,C'/'                                            66750016
         MVC   TARGET+3(2),QISAM+4      MOVE IN DAY OF MONTH            66753016
         MVI   TARGET+5,C'/'                                            66756016
         MVC   TARGET+6(2),QISAM        MOVE IN YEAR                    66759016
         EJECT                                                          66762016
*THIS SECTION PERFORMS THE NECESSARY STEPS FOR EXIT FROM THIS INITIA-   66800016
*LIZATION ROUTINE TO THE MODULE REQUIRED TO PERFORM THE OPERATION       67000016
*REQUESTED.                                                             67200016
ONWARD1  LR    PAREG1,WORKAREA          SAVE WORKAREA POINTER           67400016
         SR    WK6,WK6                  CLEAR XCTLAREA                  67600016
         ST    WK6,XCTLAREA+4                                           67800016
         LA    WK6,WHICH                                                68000016
         ST    WK6,XCTLAREA             SET UP FOR XCTL                 68200016
         L     SAVREG,4(0,SAVREG)       POP UP SAVE AREA                68400016
         L     RETREG,12(0,SAVREG)      RESTORE REGISTER FOURTEEN       68600016
         XCTL  (2,12),MF=(E,(1)),SF=(E,XCTLAREA)                        68800016
         SPACE 1                                                        69000016
ASSUMECY MVI   ISMESS+1,X'08'           SET MESSAGE NUMBER TO 8 TO      69200016
*                                          INDICATE INVALID PARAMETERS  69400016
          MVI   ISCOMP+1,X'10'           SET COMPLETION CODE TO 16      69600016
*                                          INDICATE INVALID PARAMETERS  69800016
         MVC   WHICH(8),MESSCON         MOVE IN SYMBOLIC ENTRY POINT    70000016
*                                          FOR XCTL                     70200016
         B     ONWARD                                                   70400016
         EJECT                                                          70600016
*                             CONSTANTS                                 70800016
         SPACE 3                                                        71000016
MOVENAME MVC   EXITADDR(0),0(WK5)       INSTRUCTION TO BE EXECUTED TO   71200016
*                                       MOVE IN NAME OF USER EXIT       71400016
*                                          MODULE                       71600016
*SYMBOLIC ENTRY POINT NAMES OF OPERATION MODULES                        71800016
MESSCON  DC    CL8'IEBISF   '           MESSAGE MODULE                  72000016
PRTPCON  DC    CL8'IEBISPP '            PRINT PHYSICAL MODULE           72200016
PRTLCON  DC    CL8'IEBISPL '            PRINT LOGICAL MODULE            72400016
LODCON   DC    CL8'IEBISL  '            LOAD MODULE                     72600016
UNLCON   DC    CL8'IEBISU  '            UNLOAD MODULE                   72800016
CPYCON   DC    CL8'IEBISC  '            COPY MODULE                     73000016
*                                                                       73200016
*CONSTANTS FOR COMPARE OF CONTROL PARAMETER FOR OPTION LIST             73400016
*                                                                       73600016
OPCOPY   DC    CL4'COPY'                COPY                            73800016
OPUNLD   DC    CL6'UNLOAD'              UNLOAD                          74000016
OPLOAD   DC    CL4'LOAD'                LOAD                            74200016
OPPRNT   DC    CL5'PRINT'               PRINT                           74400016
EXITCON  DC    CL5'EXIT='               EXIT KEYWORD                    74600016
*                                                                       74800016
*ASSUMED DDNAME CONSTANTS                                               75000016
*                                                                       75200016
PRINT    DC    CL8'SYSPRINT'                                            75400016
NAMEUT1  DC    CL8'SYSUT1  '                                            75600016
NAMEUT2  DC    CL8'SYSUT2  '                                            75800016
XTMN     DC    X'1F1C1F1E1F1E1F1F1E1F1E1F'   DAYS IN MONTH              75900016
         LTORG                                                          76000016
         EJECT                                                          76200016
IEBWORK  DSECT                                                          76400016
SAVE1    DS    1F                                                       76600016
SAVE1BK  DS    1F                                                       76800016
SAVE1FD  DS    1F                                                       77000016
         DS    15F                                                      77200016
SAVE2    DS    1F                                                       77400016
SAVE2BK  DS    1F                                                       77600016
SAVE2FD  DS    1F                                                       77800016
         DS    15F                                                      78000016
SAVE3    DS    1F                                                       78200016
SAVE3BK  DS    1F                                                       78400016
SAVE3FD  DS    1F                                                       78600016
         DS    15F                                                      78800016
ISINVOK  DS    F                        ADDRESS OF PARAMETER LIST AT    79000016
*                                          INVOCATION                   79200016
ISPRINT  DS    2F                       DDNAME FOR SYSPRINT             79400016
ISUT1    DS    2F                       DDNAME FOR SYSUT1               79600016
ISUT2    DS    2F                       DDNAME FOR SYSUT2               79800016
ISCOMP   DS    H                        COMPLETION CODE                 80000016
ISMESS   DS    H                        MESSAGE NUMBER                  80200016
ISPAGE   DS    H                        PAGE NUMBER FOR SYSPRINT        80400016
ISCNTRL  DS    CL1                      CONTROL BYTE                    80600016
* MASKS FOR TESTING CONTROL BYTE - ISCONTRL                             80800016
ISSWC    EQU   X'80'                    COPY                            81000016
ISSWU    EQU   X'40'                    UNLOAD                          81200016
ISSWL    EQU   X'20'                    LOAD                            81400016
ISSWP    EQU   X'10'                    PRINT                           81600016
ISSWN    EQU   X'08'                    NO CONVERT REQUESTED            81800016
ISSWPI   EQU   X'04'                    PRINT INDEX                     82000016
ISSWPP   EQU   X'02'                    PRINT PRIME                     82200016
ISSWPO   EQU   X'01'                    PRINT OVERFLOW                  82400016
ALLMASK  EQU   X'07'                                                    82600016
ISSWITCH DS    CL1                      EXTRANEOUS SWITCHES             82800016
FIRSTTM  EQU   X'80'                    FIRST TIME SWITCH               83000016
*                                                                       83200016
XCTLAREA DS    2F                                                       83400016
WHICH    DS    2F                                                       83600016
ALIGN    DS    1F                                                       83800016
DOUBLE   DS    1D                                                       84000016
EXITADDR DS    2F                                                       84200016
REENTAR  DS    9F                                                       84400016
DCBAR1   DS    64F                                                      84600016
DCBAR2   DS    64F                                                      84800016
MESSAGER DS    CL1                                                      85000016
MESSAGE  DS    CL120                                                    85200016
RECADDR  DS    1F                                                  000F 85300016
         DS    0D                                                       85350016
QISAM    DS    CL250                    UNLOADED DCB WORK AREA          85400016
HEADERC  DS    CL1                                                      85420016
HEADERT  DS    CL144                    HEADER AREA                     85440016
TARGET   DS    2F                       DATE HOLD AREA                  85460016
PAGENO   DS    1F                       HOLD PAGE NUMBER FOR HEADING    85480016
PAGEPTR  DS    1F                       HOLD POINTER TO WHERE PAGE      85500016
*                                          NUMBER IS TO BE PLACED       85520016
         EJECT                                                          85600016
*   MACRO DEFINITIONS                                                   85800016
         DCBD  DSORG=(PS,IS)                                            86000016
         END                                                            86200016
./  ADD  SSI=71880041,NAME=IEBISC
 TITLE ' IEBISC - IEBISAM UTILITY PROGRAM - COPY ROUTINE'               00300016
*STATUS AND CHANGE LEVEL 000                                            00600016
*FUNCTION/OPERATION-THIS MODULE BUILDS AN INDEXED SEQUENTIAL DATA SET   00900016
*   FROM AN INDEXED SEQUENTIAL DATA SET USING THE QUEUED INDEXED        01200016
*   SEQUENTIAL ACCESS METHOD.                                           01500016
*   THE FOLLOWING DCB FIELDS ARE CHECKED-                               01800016
*        DCBRECFM-INPUT AND OUTPUT MUST BE THE SAME                     02100016
*        DCBLRECL-INPUT AND OUTPUT MUST BE THE SAME                     02400016
*        DCBBLKSI-OUTPUT BLKSI MUST BE A MULTIPLE OF LRECL              02700016
*        DCBRKP-OUTPUT LRECL MINUS KEYLENGTH MUST BE GREATER THAN RKP   03000016
*                                                                       03300016
*                                                                       03600016
*ENTRY POINTS- IEBISC-PERFORMS THE COPY OPERATION-DATA IS PASSED BY     03900016
*   LOCATION                                                            04200016
*INPUT-COMMON WORK AREA SET UP                                          04500016
*                                                                       04800016
*        ISINVOK - ADDRESS OF PARM LIST FOR INVOCATION                  05100016
*        ISPRINT - DDNAME FOR PRINT DATA SET                            05400016
*        ISUT1 -   DDNAME FOR INPUT                                     05700016
*        ISUT2 -   DDNAME FOR OUTPUT                                    06000016
*        ISPAGE -  PAGE NUMBER TO BE USED                               06300016
*        ISCNTRL - ISSWC                                                06600016
*                                                                       06900016
*   REGISTER 13 MUST CONTAIN THE ADDRESS OF THE CALLING PROGRAM'S       07200016
*   SAVE AREA, REGISTER 15 MUST CONTAIN THE ADDRESS OF THIS MODULE      07500016
*   FOR EVERY ENTRY TO THIS MODULE, REGISTER 14 CONTAINS THE RETURN     07800016
*   ADDRESS.                                                            08100016
*                                                                       08400016
*OUTPUT- INDEXED SEQUENTIAL DATA SET, COMPLETION CODE/MESSAGE NUMBER.   08700016
* WORK AREA SET UP FOR EXIT TO IEBISF                                   09000016
*        ISINVOK - ADDRESS OF PARM LIST FOR INVOCATION                  09300016
*        ISPRINT - DDNAME FOR PRINT DATA SET                            09600016
*        ISUT1   - DDNAME FOR INPUT                                     09900016
*        ISUT2   - DDNAME FOR OUTPUT                                    10200016
*        ISCOMP  - COMPLETION CODE TO BE RETURNED                       10500016
*        ISMESS  - MESSAGE NUMBER OF MESSAGE TO BE PRINTED              10800016
*        ISPAGE  - PAGE NUMBER TO BE USED                               11100016
*        XCTLAREA & WHICH - SET UP FOR XCTL TO IEBISF                   11400016
*                                                                       11700016
*                                                                       12000016
*                                                                       12300016
*EXTERNAL ROUTINES- NONE                                                12600016
*                                                                       12900016
*EXITS-NORMAL-IEBISF-AFTER THE DATA SET HAS BEEN CONSTRUCTED            13200016
*   SUCCESSFULLY                                                        13500016
*     -ERROR-IEBISF-WHENEVER ANY ERROR CONDITIONS ARE ENCOUNTERED WITH  13800016
*   A MESSAGE NUMBER AND/OR A COMPLETION CODE.                          14100016
*                                                                       14400016
*ATTRIBUTES- REENTRANT                                                  14700016
*                                                                       15000016
*TABLES/WORKAREAS-                                                      15300016
*                                                                       15600016
*                                                                       15900016
*REGISTER ASSIGNMENTS                                                   16200016
*                                                                       16500016
PAREG0   EQU   0                        PARAMETER REGISTER              16800016
PAREG1   EQU   1                        PARAMETER REGISTER              17100016
CONS     EQU   2                                                        17400016
WK3      EQU   3                        WORK REGISTER                   17700016
WK4      EQU   4                        WORK REGISTER                   18000016
WK5      EQU   5                        WORK REGISTER                   18300016
WK6      EQU   6                        WORK REGISTER                   18600016
OPREG    EQU   7                        POINTER REGISTER                18900016
IRETREG  EQU   8                        INTERNAL RETURN REGISTER        19200016
GOREG    EQU   9                        POINTER REGISTER                19500016
BASEREG  EQU   10                       BASE REGISTER                   19800016
WORKAREA EQU   11                       WORK AREA REGISTER              20100016
PTREG    EQU   12                                                       20400016
SAVREG   EQU   13                       SAVE AREA REGISTER              20700016
RETREG   EQU   14                       RETURN AREA REGISTER            21000016
ADDR     EQU   15                       BASE ADDRESSABILITY/RETURN CODE 21300016
         EJECT                                                          21600016
IEBISC   CSECT                                                          21900016
*0801342000-345000,351000-363000,372000-381000                          22000018
*                                                                A27091 22100019
*A402100,405000                                                  A41745 22150021
*A320600,320700,357500-359500,387500,486500-488800,526200-530600,A48756 22160021
*A558500-560500,569900-569999,570000-572107,582500-584600,       A48756 22170021
*A603500,771500,511500-512000                                    A48756 22180021
*C318000,318600,319200,489000                                    A48756 22190021
*D330000-339000,512000,513000,525000-528000,570000,579000-582000,A48756 22192021
*D603000                                                         A48756 22194021
*C609000,723000                                                  A52028 22197021
*A400000,402050,712000,713000,718000,721000,722000              OY01166 22198016
* STANDARD LINKAGE CONVENTION                                           22200016
         SAVE  (14,12),T,ISC-67-V1      SAVE CALLING PROGRAMS REGISTERS 22500016
         USING IEBISC,BASEREG           ESTABLISH ADDRESSABILITY        22800016
         LR    BASEREG,ADDR                                             23100016
         LR    WORKAREA,PAREG1          PICK UP WORK AREA POINTER       23400016
         USING IEBWORK,WORKAREA                                         23700016
         ST    SAVREG,SAVE1BK           SET BACK CHAIN POINTER          24000016
         LR    SAVREG,WORKAREA          UPDATE TO NEW SAVE AREA         24300016
         LA    WK3,SAVE2                SET UP FORWARD CHAIN POINTER    24600016
         ST    WK3,SAVE1FD                 TO NEXT SAVE AREA            24900016
         EJECT                                                          24950002
         USING IHADCB,GOREG             SET UP ADDRESSABILITY FOR       25200016
*                                          DCB'S                        25500016
         LA    GOREG,DCBAR1             POINT TO INPUT DCB              25800016
         LA    PTREG,DCBAR2             POINT TO OUTPUT DCB             26100016
*THIS SECTION MOVES THE DCBS TO THE WORK AREA TO MAINTAIN REENTRABILITY 26400016
         MVC   DCBAR1(DCBINEND-DCBIN),DCBIN                             26700016
         MVC   DCBAR2(DCBOUEND-DCBOUT),DCBOUT                           27000016
         MVC   DCBDDNAM(8),ISUT1        MOVE INTO DCB THE INPUT DDNAME  27300016
         DROP  GOREG                                                    27600016
         SPACE 1                                                        27650002
         USING IHADCB,PTREG                                             27900016
         MVC   DCBDDNAM(8),ISUT2        MOVE INTO DCB THE OUTPUT DDNAME 28200016
         MVC   REENTAR(CLOSEL-OPENL),OPENL  MOVE OPEN TO WORK AREA TO   28500016
*                                          MAINTAIN REENTRABILITY       28800016
         DROP  PTREG                                            YM06576 28850002
         SPACE 1                                                        28860002
         USING IHADCB,GOREG                                     YM06576 28900002
         OPEN  ((9),(INPUT)),MF=(E,REENTAR)   OPEN INPUT DCB    YM06576 29100002
         TM    DCBOFLGS,X'10'           WAS OPEN SUCCESSFUL FOR INPTU   29400016
         BZ    SETSW                    NO, SET FOR ERROR EXIT          29700016
         DROP  GOREG                                            YM06576 30000002
         SPACE 1                                                        30050002
         USING IHADCB,PTREG                                     YM06576 30300002
         OPEN  ((12),(OUTPUT)),MF=(E,REENTAR)                   YM06576 30350002
         TM    DCBOFLGS,X'10'           WAS OPEN SUCCESSFUL FOR INPUT   30600016
         BZ    SETSW                    NO, SET FOR ERROR EXIT          30900016
         TM    ISCOMP+1,X'FF'      CHECK FOR AN ERROR IN THE            31200016
*                                     DCBEXIT                           31500016
         BC    4,EODADIN1         YES,GO TO CLOSEOUT             A48756 31800000
         DROP  PTREG                                            YM06576 31810002
         EJECT                                                          31812002
         USING IHADCB,GOREG                                     YM06576 31820002
         TM    DCBRECFM,X'10'           BLOCKED RECORDS?         A27091 31830019
         BC    1,GETPTR1                YES, BLOCKED RECORDS     A48756 31860021
         OC    DCBRKP(2),DCBRKP         CHECK FOR RKP=0                 31890021
         BZ    GETPTR1                  YES, RKP=0               A48756 31920021
         SETL  DCBAR1,BD                SET FOR RETRIEVING DATA PORTION 31950016
*                                          ONLY FOR RKP NOT ZERO AND    31980016
*                                          RECORDS UNBLOCKED            32010016
GETPTR1  TM    DCBRECFM,VARIABLE  RECFM = V/VB ?                 A48756 32060021
         BO    GETLOCAT           YES, DO GET LOCATE, PUT MOVE   A48756 32070021
GETPTR   PUT   DCBAR2                   GET BUFFER ADDRESS              32100016
         LR    PAREG0,PAREG1            MOVE BUFFER ADDRESS FOR THE GET 32400016
*                                          AREA                         32700016
GETREC   GET   DCBAR1,(0)                                               34800016
         B     GETPTR                  GET NEXT RECORD POINTER     IV0I 35700018
GETLOCAT GET   DCBAR1             GET AN INPUT RECORD            A48756 35750000
         LR    PAREG0,PAREG1      MOVE RECORD ADDR. FOR THE PUT  A48756 35760000
         PUT   DCBAR2,(0)         MOVE THE RECORD                A48756 35900000
         B     GETLOCAT           GET ANOTHER INPUT RECORD       A48756 35950000
         DROP  GOREG                                                    36600016
         USING IHADCB,PTREG                                             36900016
* LOOP IS TERMINATED BY EODAD CONDITION ON INPUT                        38400016
EODADIN  OI    DCBEXCD2,X'80'      SET SEQUENCE CHECK ON FOR            38700016
EODADIN1 EQU   *                                                        38750000
*                                          OUTPUT DCB SO THAT LAST      39000016
*                                          BUFFER IS NOT WRITTEN OUT    39300016
         MVC   REENTAR(INPUT-CLOSEL),CLOSEL  MOVE CLOSE TO WORK AREA TO 39600016
*                                          MAINTAIN REENTRABILITY       39900016
         OI    ISMESS,X'10'       SET FLAG FOR SYNAD  ROUTINE   OY01166 40000016
         CLOSE ((9),,(12)),MF=(E,REENTAR)                               40200016
         NI    ISMESS,X'00'       SET OFF FLAG FOR SYSNAD ROUT. OY01166 40205016
         CLI   ISMESS+1,X'07'           OPEN NO GOOD             A41745 40210021
         BE    BYPASS                   NO OPEN DONE SO BYPASS   A41745 40220021
         FREEPOOL (9)                   FREEPOOL INPUT BUFFER    A41745 40250021
         FREEPOOL (12)                  FREEPOOL OUTPUT BUFFER   A41745 40300021
BYPASS   SR    WK6,WK6                  SET UP XCTL AREA         A41745 40500021
         ST    WK6,XCTLAREA+4                                           40800016
         MVI   WHICH+5,C'F'             MOVE INTO XCTLAREA NAME OF NEXT 41100016
*                                          MODULE -IEBISF               41400016
         LR    PAREG1,WORKAREA          SAVE WORKAREA POINTER           41700016
         L     SAVREG,4(0,SAVREG)       POP UP SAVE AREA                42000016
         L     RETREG,12(0,SAVREG)      RESTORE REGISTER FOURTEEN       42300016
         XCTL  (2,12),MF=(E,(1)),SF=(E,XCTLAREA)                        42600016
         EJECT                                                          42900016
* THIS SECTION INSURES THAT THERE ARE NO INCONSISTENT DCB VALUES-RECFM, 43200016
* LRECL,BLKSIZE                                                         43500016
DCBEXIT  OC    DCBNTM(1),DCBNTM         NTM SPECIFIED                   43550016
         BNZ   CYLOF                    YES, NTM SPECIFIED              43600016
         MVC   DCBNTM(1),54(GOREG)      GET OLD NTM                     43650016
CYLOF    OC    DCBCYLOF(1),DCBCYLOF     CYLOF SPECIFIED                 43700016
         BNZ   OPTCD                    YES, CYLOF SPECIFIED            43750016
         MVC   DCBCYLOF(1),55(GOREG)    GET OLD CYLOF                   43800016
OPTCD    OC    DCBOPTCD(1),DCBOPTCD     OPTCD SPECIFIED                 43850016
         BNZ   TLRECL                   YES, OPTCD SPECIFIED            43900016
         MVC   DCBOPTCD(1),52(GOREG)    GET OLD OPTCD                   43950016
TLRECL   OC    DCBLRECL(2),DCBLRECL     CHECK FOR LRECL NOT SPECIFIED   44000016
         BC    7,CKEQUAL1               NO, LRECL SPE IFIED             44100016
         MVC   DCBLRECL(2),82(GOREG)    MOVE I OLD LRECL                44400016
CKEQUAL1 OC    DCBRECFM(1),DCBRECFM     CHECK FOR RECFM NOT SPECIFIED   44700016
         BC    7,CKEQUAL2               NO, RECFM SPECIFIED             45000016
         MVC   DCBRECFM(1),36(GOREG)    MOVE IN OLD RECFM               45300016
CKEQUAL2 OC    DCBBLKSI(2),DCBBLKSI     CHECK OR BLOCKSIZE NOT SPEC.    45600016
         BC    7,CKEQUAL3               NO, BLKSI SPECIFIED             45900016
         MVC   DCBBLKSI(2),62(GOREG)    MOVE IN OLD BLKSI               46200016
CKEQUAL3 OC    DCBKEYLE(1),DCBKEYLE     CHECK FOR KEY LENGTH NOT SPEC.  46500016
         BC    7,CKEQUAL4               NO, KEYLE SPECIFIED             46800016
         MVC   DCBKEYLE(1),16(GOREG)    MOVE IN OLD KEYLE               47100016
CKEQUAL4 OC    DCBRKP(2),DCBRKP         CHECK FOR RELATIVE KEY POSITION 47400016
         BC    7,CHECK                  NO, RKP SPECIFIED               47700016
         MVC   DCBRKP(2),60(GOREG)      MOVE IN OLD RKP                 48000016
CHECK    LH    WK6,DCBLRECL             PICK UP NEW LOGICAL RECORD      48300016
*                                          LENGTH                       48600016
         TM    DCBRECFM,X'C0'     RECFM SYSUT2 U ?               A48756 48650000
         BO    ERRDCB             YES, PRINT ERRMSG IEB601I      A48756 48700000
         BM    TSTRF2             BRANCH WHEN FIXED OR VAR       A48756 48750000
         OI    DCBRECFM,X'40'     SET DEFAULT RECFM = V          A48756 48800000
TSTRF2   TM    36(GOREG),X'C0'    RECFM SYSUT1 U ?               A48756 48850000
         BO    ERRDCB             YES, PRINT ERRMSG IEB601I      A48756 48860000
         BM    CONTIN             BRANCH WHEN FIXED OR VAR       A48756 48870000
         OI    36(GOREG),X'40'    SET DEFAULT RECFM = V          A48756 48880000
CONTIN   SR    WK4,WK4                                           A48756 48900000
         LR    WK3,WK4                                                  49000016
         TM    DCBRECFM,VARIABLE        CHECK FOR VARIABLE LENGTH       50700016
*                                          RECORDS                      51000016
         BZ    CHECKOR                  NO, CHECK ORIGINAL RECFM        51100016
         TM    36(GOREG),VARIABLE    CHECK FOR VARIABLE RECFM    A48756 51150021
         BZ    ERRDCB                NO, SET UP FOR ERROR EXIT   A48756 51200021
         CLC   DCBBLKSI(2),DCBLRECL     COMPARE BLKSI TO LRECL          51400016
*                                          BLKSIZE MUST BE EQUAL TO OR  51500016
*                                          GREATER THAN LRECL           51600016
         BL    ERRDCB                   NO, SET UP FOR ERROR EXIT       51700016
         OC    DCBRKP(2),DCBRKP         RKP SPECIFIED                   51800016
         BNZ   CHECKR                   RKP IS SPECIFIED                51900016
         MVC   DCBRKP(2),60(GOREG)      MOVE IN OLD RKP                 52000016
CHECKR   CLI   DCBRKP+1,X'04'           CHEKC FOR RKP EWUAL OR GREATER  52100016
*                                          THAN 4                       52200016
         BL    ERRDCB                   NO, GO TO SET FOR ERROR EXIT    52300016
         B     CKRKP                                               000G 52470016
CHECKOR  TM    36(GOREG),X'80'     CHECK FOR INPUT FIXED         A48756 52620021
         BZ    ERRDCB              NO, SET UP FOR ERROR EXIT     A48756 52670021
         TM    DCBRECFM,X'10'      CHECK FOR FIX. BLOCK. RECORD  A48756 52850021
         BO    TSTBLK1             YES, CHECK INPUT RECFM        A48756 52900000
         MVC   DCBLRECL(2),DCBBLKSI SET LRECL EQ BLKSIZE         A48756 52910000
TSTBLK1  TM    36(GOREG),X'10'     CHECK FOR FIX. BLOCK. RECORD  A48756 52960000
         BO    CKFIXED             YES, CHCK BLKSI MULT. OF LRCL A48756 53010000
         MVC   82(2,GOREG),62(GOREG) SET LRECL EQ BLKSIZE        A48756 53060021
CKFIXED  LH    WK5,DCBBLKSI                                             53400016
         DR    WK4,WK6                  DIVIDE BLKSIZE BY LRECL         53700016
         LTR   WK4,WK4                  CHECK FOR A ZERO REMAINDER      54000016
         BC    7,ERRDCB                 NO, SET UP FOR ERROR EXIT       54300016
CKRKP    IC    WK3,DCBKEYLE             PICK UP KEYLENGTH               54600016
         SR    WK6,WK3                  CHECK FOR LOGICAL RECORD LENGTH 54900016
*                                          MINUS KEYLENGTH NOT BEING    55200016
*                                          GREATER THAN RELATIVE KEY    55500016
*                                          POSITION                     55800016
         CLI   DCBRECFM,X'80'     SYSUT2 HAS RECFM=F ?           A48756 55850021
         BNE   RKPTEST            NO, CHECK FOR VALID RKP        A48756 55900021
         CLC   DCBRKP(2),ZERO     SYSUT2 HAS RKP=0 ?             A48756 55950021
         BE    RECFMTST           YES, DON'T CHECK FOR VALID RKP A48756 56000021
RKPTEST  EQU   *                                                 A48756 56050021
         CH    WK6,DCBRKP                                               56100016
         BL    ERRDCB                   NO,SET UP FOR ERROR EXIT        56400016
*                                                                       56700016
RECFMTST TM    36(GOREG),X'40'    RECFM SYSUT1 V ?               A48756 56990021
         BZ    FIXRECFM           NO, RECFM IS F/FB              A48756 56992000
         CLC   DCBLRECL(2),82(GOREG) UT1 LRECL EQ. UT2 LRECL ?   A48756 56992400
         BL    ERRDCB1            NO, PRINT ERRMSG IEB601I       A48756 56992821
         MVI   42(GOREG),X'48'    CHNGE UT1 MACRFM TO GET LOCATE A48756 56994000
         MVI   43(12),X'50'       CHNGE UT2 MACRFM TO PUT MOVE   A48756 56996000
         RETURN  ,                RETURN TO OPEN SYSUT2          A48756 56998800
TSTL1L2  CLC   DCBLRECL(2),82(GOREG) UT1 LRECL EQ. UT2 LRECL ?   A48756 56998900
         BNE   ERRDCB1            NO, PRINT ERRMSG IEB601I       A48756 56999021
         RETURN  ,                RETURN TO OPEN SYSUT2          A48756 56999100
FIXRECFM SR    WK4,WK4            ZERO REGISTER 4                A48756 57006421
         IC    WK4,16(GOREG)      LOAD KELENGTH IN REGISTER 4    A48756 57013921
         LH    WK6,82(GOREG)      LOAD UT2 LRECL IN REGISTER 6   A48756 57021121
         CLC   60(2,GOREG),ZERO   UT1 RKP=0 ?                    A48756 57028321
         BNE   TSTRKP2            NO, TEST DCB VALUES            A48756 57035521
         CLC   DCBRKP(2),ZERO     UT2 RKP=0 ?                    A48756 57042721
         BNE   TSTRECF1           NO, TEST UT1 DCB VALUES        A48756 57049900
         CLC   DCBRECFM(1),36(GOREG) RECFM UT1 EQ. RECFM UT2     A48756 57090300
         BE    TSTL1L2            YES, TEST FOR EQUAL LRECL      A48756 57090700
         TM    36(GOREG),X'90'    UT1 RECFM = F ?                A48756 57091900
         BM    COMPL1L2           YES, COMPARE UT1 & UT2 LRECL'S A48756 57093900
NOEQL1L2 SR    WK6,WK4            SET WK6 : LRECL1 MINUS KEYLEN1 A48756 57095900
         CH    WK6,DCBLRECL       LRECL2 EQ.TO LRECL1 MINUS KEY? A48756 57099100
         BCR   8,RETREG           YES, OKE RETURN TO OPEN UT2    A48756 57099500
         STH   WK6,DCBLRECL       SET LRECL2 = LRECL1 MINUS KEY1 A48756 57099600
         STH   WK6,DCBBLKSI       SET BLKS2 = LRECL1 MINUS KEY1  A48756 57099700
         RETURN   ,               RETURN TO OPEN SYSUT2          A48756 57099800
COMPL1L2 AR    WK6,WK4            SET WK6: LRECL1 PLUS KEYLEN1   A48756 57149800
         CH    WK6,DCBLRECL     UT2(RCFM=FB) EQ. LRC1 PLUS KEY ? A48756 57159800
         BCR   8,RETREG           YES, RETURN TO OPEN SYSUT2     A48756 57169800
         STH   WK6,DCBLRECL       LRECL2=LRECL1 PLUS KEYLEN1     A48756 57179800
         MR    WK4,WK6            MULTIPLY R5 AND R6             A48756 57189800
         STH   WK5,DCBBLKSI       BLKSI2= R5 * (LRECL1 PLUS KEY) A48756 57191800
         RETURN   ,               RETURN TO OPEN SYSUT2          A48756 57193800
TSTRKP2  CLC   DCBRKP(2),ZERO     UT2 RKP=0 ?                    A48756 57195800
         BNE   TSTL1L2            NO, TEST FOR EQUAL LRECL'S     A48756 57197800
         TM    DCBRECFM,X'90'     UT2 RECFM=FB ?                 A48756 57198600
         BO    TSTL1L2            YES, TEST FOR EQUAL LRECL'S    A48756 57198700
         B     NOEQL1L2           NO, CHECK FOR SYSUT2 LRECL     A48756 57199100
TSTRECF1 TM    36(GOREG),X'90'    UT1 RECFM = FB ?               A48756 57199500
         BO    TSTL1L2            YES, TST FOR EQ. LRECL'S       A48756 57199600
         B     COMPL1L2           NO, CHECK FOR SYSUT2 LRECL     A48756 57210700
*THIS SECTION SETS THE MESSAGE NUMBER FOR IEBISF TO INDICATE INCORRECT  57300016
*DCB FIELDS                                                             57600016
ERRDCB   MVI   DCBKEYLE,X'10'        SET DEFAULT                 A48756 58250021
         MVI   DCBRECFM,X'80'        VALUES                      A48756 58260021
         MVC   DCBRKP(2),ZERO        TO ASSURE CORRECT           A48756 58300021
         NI    DCBBLKSI,X'00'        OPENING                     A48756 58350021
         MVI   DCBBLKSI+1,X'50'      OF SYSUT2                   A48756 58360021
         MVC   DCBLRECL(2),DCBBLKSI  DATA SET.                   A48756 58400021
ERRDCB1  MVI   ISMESS+1,X'01'        SET MESSAGE NUMBER TO 1     A48756 58450021
         MVI   ISCOMP+1,X'08'        SET COMPLETION CODE TO 8    A48756 58460021
         RETURN                                                         58500016
*THIS SECTION SETS THE MESSAGE NUMBER AND RETURN CODE FOR IEBISF TO     58800016
*INDICATE THAT A REQUIRED DD STATEMENT IS MISSING                       59100016
SETSWOT  MVC   MESSAGE+64(8),SYSUT2     MOVE IN WHICH DD IS MISSING     59400016
         B     SETSW                                                    59700016
SETSWIN  MVC   MESSAGE+64(8),SYSUT1     MOVE IN WHICH DD IS MISSING     60000016
SETSW    MVI   ISMESS+1,X'07'          SET MESSAGE NUMBER TO 7   A48756 60350021
         MVI   ISCOMP+1,X'10'           SET COMPLETION CODE TO 16       60600016
         B     EODADIN1            DO NOT SET SEQ CHECK BIT ON   A52028 60900021
         SPACE 3                                                        61200016
*THIS SECTION HANDLES ALL SYNCHRONOUS EXITS AND GIVES THE APPROPRIATE   61500016
*MESSAGE NUMBER AND RETURN CODE TO IEBISF                               61800016
* THIS SYNAD ROUTINE WILL BE REPLACED AFTER THE NEW SVC 68 AND ITS      62100016
*ASSOCIATED MACROS ARE AVAILABLE                                        62400016
         SPACE 3                                                        69600016
* THIS SYNAD ROUTINE USES THE SVC 68 AND ITS ASSOCIATED MACROS FOR      69900016
*DETERMINING THE ERROR CONDITION                                        70200016
SYNADIN  SYNADAF ACSMETH=QISAM,PARM1=DCBAR1,PARM2=(0)                   70500016
MOVEMESS MVC   MESSAGE+8(79),49(PAREG1)  MOVE IN PRINTABLE DATA FROM    70800016
*                                         BUFFER FOR MESSAGE            71100016
         TM    ISMESS+1,X'FF'      ALREADY MESS NBR SET ?       OY01166 71200016
         BC    4,SYNADRL          YES, RETURN TO CLOSE          OY01166 71300016
         MVI   ISMESS+1,X'02'          SET MESSAGE NUMBER TO 2          71400016
         MVI   ISCOMP+1,X'08'           SET COMPLETION CODE TO 8        71700016
SYNADRL  EQU   *                  RELEASE WORK REISTERS         OY01166 71800016
         SYNADRLS                                                       72000016
         TM    ISMESS,X'10'       ARE WE IN SYSUT2 CLOSE ?      OY01166 72100016
         BCR   1,RETREG           YES, RETURN TO CLOSE          OY01166 72200016
         B     EODADIN1            DO NOT SET SEQ CHECK BIT ON   A52028 72300021
SYNADOUT SYNADAF ACSMETH=QISAM,PARM1=DCBAR2,PARM2=(0)                   72600016
         B     MOVEMESS                                                 72900016
         SPACE 3                                                        73200016
         EJECT                                                          73500016
OPENL    OPEN  (,(INPUT)),MF=L                                  YM06576 73800002
CLOSEL   CLOSE (,,,),MF=L                                               74100016
INPUT    DC    CL8'INPUT   '                                            74400016
OUTPUT   DC    CL8'OUTPUT  '                                            74700016
DCBIN    DCB   DSORG=IS,MACRF=GM,DDNAME=SYSUT1,SYNAD=SYNADIN,          *75000016
               EODAD=EODADIN                                            75300016
DCBINEND DS    0F                                                       75400016
DCBOUT   DCB   DSORG=IS,MACRF=PL,DDNAME=SYSUT2,EXLST=DCBEXITA,         C75600016
               SYNAD=SYNADOUT                                           75900016
DCBOUEND DS    0F                                                       76000016
DCBEXITA DC    X'85'                                                    76200016
         DC    AL3(DCBEXIT)                                             76500016
SYSUT1   DC    CL8'SYSUT1  '                                            76800016
SYSUT2   DC    CL8'SYSUT2  '                                            77100016
ZERO     DC    H'0'               ZERO HALFWORD FOR TESTING      A48756 77150000
VARIABLE EQU   X'40'                    VARIABLE RECORD FORMAT          77400016
         LTORG                                                          77700016
         EJECT                                                          78000016
IEBWORK  DSECT                                                          78300016
SAVE1    DS    1F                                                       78600016
SAVE1BK  DS    1F                                                       78900016
SAVE1FD  DS    1F                                                       79200016
         DS    15F                                                      79500016
SAVE2    DS    1F                                                       79800016
SAVE2BK  DS    1F                                                       80100016
SAVE2FD  DS    1F                                                       80400016
         DS    15F                                                      80700016
SAVE3    DS    1F                                                       81000016
SAVE3BK  DS    1F                                                       81300016
SAVE3FD  DS    1F                                                       81600016
         DS    15F                                                      81900016
ISINVOK  DS    F                        ADDRESS OF PARAMETER LIST AT    82200016
*                                          INVOCATION                   82500016
ISPRINT  DS    2F                       DDNAME FOR SYSPRINT             82800016
ISUT1    DS    2F                       DDNAME FOR SYSUT1               83100016
ISUT2    DS    2F                       DDNAME FOR SYSUT2               83400016
ISCOMP   DS    H                        COMPLETION CODE                 83700016
ISMESS   DS    H                        MESSAGE NUMBER                  84000016
ISPAGE   DS    H                        PAGE NUMBER FOR SYSPRINT        84300016
ISCNTRL  DS    CL1                      CONTROL BYTE                    84600016
* MASKS FOR TESTING CONTROL BYTE - ISCONTRL                             84900016
ISSWC    EQU   X'80'                    COPY                            85200016
ISSWU    EQU   X'40'                    UNLOAD                          85500016
ISSWL    EQU   X'20'                    LOAD                            85800016
ISSWP    EQU   X'10'                    PRINT                           86100016
ISSWN    EQU   X'08'                    NO CONVERT REQUESTED            86400016
ISSWPI   EQU   X'04'                    PRINT INDEX                     86700016
ISSWPP   EQU   X'02'                    PRINT PRIME                     87000016
ISSWPO   EQU   X'01'                    PRINT OVERFLOW                  87300016
ALLMASK  EQU   X'07'                                                    87600016
ISSWITCH DS    CL1                      EXTRANEOUS SWITCHES             87900016
FIRSTTM  EQU   X'80'                    FIRST TIME SWITCH               88200016
*                                                                       88500016
XCTLAREA DS    2F                                                       88800016
WHICH    DS    2F                                                       89100016
ALIGN    DS    1F                                                       89400016
DOUBLE   DS    1D                                                       89700016
EXITADDR DS    2F                                                       90000016
REENTAR  DS    9F                                                       90300016
DCBAR1   DS    64F                                                      90600016
DCBAR2   DS    64F                                                      90900016
MESSAGER DS    CL1                                                      91200016
MESSAGE  DS    CL120                                                    91500016
RECADDR  DS    1F                                                  000F 91600016
         DS    0D                                                       91700016
QISAM    DS    CL250                    UNLOADED DCB WORK AREA          91800016
HEADERC  DS    CL1                                                      91840016
HEADERT  DS    CL144                    HEADER AREA                     91880016
TARGET   DS    2F                       DATE HOLD AREA                  91920016
PAGENO   DS    1F                       HOLD PAGE NUMBER FOR HEADING    91960016
PAGEPTR  DS    1F                       HOLD POINTER TO WHERE PAGE      92000016
*                                          NUMBER IS TO BE PLACED       92040016
         EJECT                                                          92100016
*   MACRO DEFINITIONS                                                   92400016
         DCBD  DSORG=(PS,IS)                                            92700016
         END                                                            93000016
./  ADD  SSI=71880042,NAME=IEBISF
 TITLE 'IEBISF-IEBISAM UTILITY PROGRAM - MESSAGE WRITER'                00500016
*STATUS & CHANGE LEVEL 0                                                01000016
*                                                                       01500016
*FUNCTION - THIS MODULE OPENS THE SYSPRINT DATA SET AND THE APPROPRIATE 02000016
*           MESSAGE WRITTEN,AND THE DATA SET CLOSED. THE APPROPRIATE    02500016
*           CONDITION CODE IS RETURNED.                                 03000016
*                                                                       03500016
*ENTRY POINTS- THE ONLY ENTRY POINT TO THIS MODULE IS IEBISF. ENTRY IS  04000016
*              MADE FROM ANY MODULE OF THE IEBISAM UTILITY PROGRAM      04500016
*                                                                       05000016
*INPUT - AT ENTRY TO THIS MODULE REGISTER 13 POINTS TO A REGISTER SAVE  05500016
*        AREA, REGISTER 14 CONTAINS THE FINAL RETURN ADDRESS, REGISTER  06000016
*        1 POINTS TO THE COMMON WORK AREA.                              06500016
*        THE WORK AREA CONTAINS-                                        07000016
*        ISINVOK - ADDRESS OF PARAMETER LIST FOR INVOCATION             07500016
*        ISPRINT - DDNAME FOR SYSPRINT DATA SET                         08000016
*        ISCOMP - COMPLETION CODE TO BE RETURNED                        08500016
*        ISMESS  - MESSAGE NUMBER OF MESSAGE TO BE WRITTEN              09000016
*        ISPAGE  - PAGE NUMBER TO BE USED FOR MESSAGE DATA SET          09500016
*        MESSAGE - IF ERROR WAS ENCOUNTERED DURING I/O THE INFORMATION  10000016
*                  RETURNED FROM SYNADAF WILL BE PRESENT.               10500016
*                                                                       11000016
*OUTPUT - A MESSAGE IS WRITTEN ON THE 'SYSPRINT' DATA SET.              11500016
*                                                                       12000016
*EXTERNAL ROUTINES - NONE                                               12500016
*                                                                       13000016
*EXITS - CONTROL IS RETURNED TO THE CALLER                              13500016
*                                                                       14000016
*CONDITION CODES -                                                      14500016
*                                                                       15000016
*        0     SUCCESSFUL COMPLETION                                    15500016
*                                                                       16000016
*        8     ERROR OTHER THAN ABSENCE OF SYSUT1 OR SYSUT2 DD CARD     16500016
*                                                                       17000016
*        16    ABSENCE OF SYSUT1 &/OR SYSUT2 DD CARD                    17500016
*                                                                       18000016
*A490100-490500,500000                                           A41745 18050021
*C577000                                                         A41801 18100021
*REGISTER USAGE                                                         18500016
PAREG0   EQU   0                        PARAMETER REGISTER              19000016
PAREG1   EQU   1                        PARAMETER REGISTER              19500016
CONS     EQU   2                        WORK REGISTER                   20000016
WK3      EQU   3                        WORK REGISTER                   20500016
WK4      EQU   4                        WORK REGISTER                   21000016
WK5      EQU   5                        WORK REGISTER                   21500016
BASEREG  EQU   10                       BASE REGISTER                   22000016
WORKAREA EQU   11                       WORK AREA REGISTER              22500016
SAVREG   EQU   13                       SAVE AREA REGISTER              23000016
RETREG   EQU   14                       RETURN AREA REGISTER            23500016
ADDR     EQU   15                       BASE ADDRESSABILITY/RETURN CODE 24000016
         EJECT                                                          24500016
IEBISF   CSECT                                                          25000016
         SAVE  (14,12),T                                                25500016
         LR    BASEREG,ADDR             ESTABLISH ADDRESSABILITY        26000016
         USING IEBISF,BASEREG                                           26500016
         LR    WORKAREA,PAREG1          ESTABLISH WORK AREA ADDRESSA-   27000016
*                                           BILITY                      27500016
         USING IEBWORK,WORKAREA                                         28000016
         LA    WK3,DCBAR1               SET UP ADDRESSABILITY TO DCB    28500016
         USING IHADCB,WK3                                               29000016
         EXTRN MESSTBL                                                  29500016
         ST    SAVREG,SAVE1BK           SET BACK CHAIN POINTER          30000016
         LR    SAVREG,WORKAREA          UPDATE TO NEW SAVE AREA         30500016
         LA    WK4,SAVE2                SET UP FORWARD CHAIN POINTER    31000016
         ST    WK4,SAVE1FD                 TO NEXT SAVE AREA            31500016
         MVC   DCBAR1(HEADER-DCBPRINT),DCBPRINT MOVE DCB TO WORK AREA   32000016
*                                       TO MAINTAIN REENTRABILITY       32500016
         MVC   DCBDDNAM(8),ISPRINT      MOVE IN DDNAME FOR SYSPRINT     33000016
         MVC   REENTAR(CLOSEL-OPENL),OPENL  MOVE OPEN L-FORM TO WORK    33500016
*                                          AREA TO MAINTAIN REENTRA-    34000016
*                                          BILITY                       34500016
         OPEN  (DCBAR1,(OUTPUT)),MF=(E,REENTAR)                         35000016
         TM    DCBOFLGS,X'10'           CHECK FOR SUCCESSFUL OPEN       35500016
         BZ    SETSWOT                  NO, SET CONDITION CODE          36000016
         CLI   EXITADDR,X'01'           CHECK FOR INVALID DCB PARAMETER 36100016
*                                       IN SYSPRINT DCB                 36200016
         BE    CLOSEOUT                 YES, TO TO CLOSE                36300016
* THIS SECTION SETS UP THE HEADER AND WRITES IT                         36500016
         MVI   HEADERC,X'F1'            SET TO SKIP TO NEXT PAGE        37000016
         MVC   HEADERT(120),HEADER      MOVE IN  HEADER                 37500016
         LH    WK5,ISPAGE               PICK UP PAGE NUMBER IN BINARY   38000016
         CVD   WK5,DOUBLE                  AND CONVERT TO DECIMAL       38500016
         UNPK  HEADERT+110(3),DOUBLE+6(2)                               38900016
         OI    HEADERT+112,X'F0'                                        39300016
         MVC   HEADERT+90(8),TARGET     MOVE IN DATE                    39700016
         PUT   DCBAR1,HEADERC                                           40100016
*THIS SECTION SETS UP MESSAGE                                           40500016
         LH    WK3,ISMESS               PICK UP MESSAGE NUMBER          41000016
*THIS SECTION MOVES THE MESSAGE NUMBER FOR I/O ERRORS INTO THE MESSAGE  41500016
*AREA. THE MESSAGE TEXT IS PROVIDED BY THE SYNADAF MACRO                42000016
         CH    WK3,=H'2'                CHECK FOR I/O ERROR MESSAGE     42500016
         BE    SPECIAL                  YES, PICK UP SPECIAL MESSAGE    43000016
*                                          NUMBER                       43500016
         SLL   WK3,2                    MULTIPLY BY 4                   44000016
         L     WK4,MESSTBLA             PICK UP BEGINNING ADDRESS OF    44500016
*                                          MESSAGE TABLE                45000016
         AR    WK3,WK4                  INDEX INTO TABLE                45500016
         L     WK3,0(0,WK3)             PICK UP MESSAGE ADDRESS         46000016
         MVC   MESSAGE(120),0(WK3)      MOVE IN MESSAGE                 46500016
PUTOUT   MVI   MESSAGER,X'40'           SET TO SKIP A LINE AND PRINT    47000016
         PUT   DCBAR1,MESSAGER                                          47500016
CLOSEOUT MVC   REENTAR(MESSTBLA-CLOSEL),CLOSEL  MOVE CLOSE TO WORK AREA 48000016
*                                          TO MAINTAIN REENTRABILITY    48500016
         CLOSE (DCBAR1,LEAVE),MF=(E,REENTAR)                            49000016
         CLI   ISCOMP+1,X'10'           WAS OPEN  CORRECT        A41745 49010021
         BE    BYPASS                   OPEN INCORRECT SO NO FRE A41745 49020021
         FREEPOOL  DCBAR1  FREE BUFFERS                          A41745 49050021
*SET UP TO RETURN CONTROL TO THE CALLER                                 49500016
BYPASS   L     SAVREG,4(SAVREG)         RESTORE SAVE AREA POINTERA41745 50000021
         L     WK3,ISINVOK              REESTABLISH POINTER TO PARA-    50500016
*                                          METERS FOR INVOCATION        51000016
         SR    WK4,WK4                  INSERT COMPLETION CODE          51500016
         IC    WK4,ISCOMP+1                                             52000016
         FREEMAIN R,LV=1536,A=(11)                                      52500016
         LR    PAREG1,WK3                                               53000016
         LR    ADDR,WK4                 PICK UP COMPLETION CODE         53100016
         L     RETREG,12(0,SAVREG)      RESTORE RETURN ADDRESS          53300016
         RETURN (2,12),T                                                53500016
SPECIAL  MVC   MESSAGE(8),IONUMBER      MOVE IN SPECIAL MESSAGE NUMBER  54000016
         MVC   MESSAGE+96(24),COMPCODE  MOVE COMPLETION CODE TO MESSAGE 54200016
         B     PUTOUT                                                   54500016
         EJECT                                                          55000016
*THIS SECTION IS THE SYNAD ROUTINE FOR THE SYSPRINT DATA SET            55500016
ERROR    MVI   ISCOMP+1,X'08'           SET COMPLETION CODE TO 8        56000016
         B     CLOSEOUT                                                 56500016
SETSWOT  MVI   ISCOMP+1,X'10'           SET COMPLETION CODE             57000016
         B     CLOSEOUT                                                 57500016
DCBEXIT  LA    WK3,DCBAR1               SET UP ADDRESSABILITYTO DCB     57520016
         MVI   EXITADDR,X'00'           SET SWITCH FOR SUCCESS          57530016
         OC    DCBBLKSI(2),DCBBLKSI     BLOCK SIZE SPECIFIED            57540016
         BZ    MOVELREC                 NO, NO BLOCKSIZE SPECIFIED      57560016
         SR    WK4,WK4                                                  57580016
         LH    WK5,DCBBLKSI             PICK UP PROVIDED BLOCKSIZE      57600016
         LH    CONS,DCBLRECL            PICK UP LRECL                   57620016
         DR    WK4,CONS                                                 57640016
         LTR   WK4,WK4                  CHECK FOR BLOCKSIZE NOT A       57660016
*                                          MULTIPLE OF LRECL            57680016
         BNE   MOVELREC      ERROR, SET DEFAULT                  A41801 57700021
         RETURN                                                         57720016
MOVELREC MVC   DCBBLKSI(2),DCBLRECL     USE DCB LRECL FOR BLOCK SIZE    57740016
         RETURN                                                         57760016
SETCODE  MVI   ISMESS+1,X'01'           SET UP MESSAGE CODE             57780016
         MVI   ISCOMP+1,X'08'           SET UP COMPLETION CODE          57800016
         MVI   EXITADDR,X'01'           SET FOR CHECK AFTER OPEN        57810016
         RETURN                                                         57820016
OPENL    OPEN  (,OUTPUT),MF=L                                           58000016
CLOSEL   CLOSE (,LEAVE),MF=L                                            58500016
MESSTBLA DC    A(MESSTBL)                                               59000016
DCBPRINT DCB   DSORG=PS,MACRF=(PM),DDNAME=SYSPRINT,RECFM=FBA,LRECL=121,*59300016
               SYNAD=ERROR,EXLST=DDDEX   EXLST  NAME CHANGED (AOS)      59600021
DDDEX    DS    0F        LAB. NAME CHANGED , BEC. OF AOS DCBD MACRO     59900021
         DC    X'85'                                                    60200016
         DC    AL3(DCBEXIT)                                             60500016
HEADER   DC    CL32'     DATA SET UTILITY - IEBISAM '                   61000016
         DC    CL32'                                '                   61500016
         DC    CL32'                                '                   62000016
         DC    CL24'                        '                           62500016
IONUMBER DC    CL8'IEB602I'                                             63000016
COMPCODE DC    CL24'COMPLETION CODE=08      '                           63200016
         LTORG                                                          63500016
         EJECT                                                          64000016
IEBWORK  DSECT                                                          64500016
SAVE1    DS    1F                                                       65000016
SAVE1BK  DS    1F                                                       65500016
SAVE1FD  DS    1F                                                       66000016
         DS    15F                                                      66500016
SAVE2    DS    1F                                                       67000016
SAVE2BK  DS    1F                                                       67500016
SAVE2FD  DS    1F                                                       68000016
         DS    15F                                                      68500016
SAVE3    DS    1F                                                       69000016
SAVE3BK  DS    1F                                                       69500016
SAVE3FD  DS    1F                                                       70000016
         DS    15F                                                      70500016
ISINVOK  DS    F                        ADDRESS OF PARAMETER LIST AT    71000016
*                                          INVOCATION                   71500016
ISPRINT  DS    2F                       DDNAME FOR SYSPRINT             72000016
ISUT1    DS    2F                       DDNAME FOR SYSUT1               72500016
ISUT2    DS    2F                       DDNAME FOR SYSUT2               73000016
ISCOMP   DS    H                        COMPLETION CODE                 73500016
ISMESS   DS    H                        MESSAGE NUMBER                  74000016
ISPAGE   DS    H                        PAGE NUMBER FOR SYSPRINT        74500016
ISCNTRL  DS    CL1                      CONTROL BYTE                    75000016
* MASKS FOR TESTING CONTROL BYTE - ISCONTRL                             75500016
ISSWC    EQU   X'80'                    COPY                            76000016
ISSWU    EQU   X'40'                    UNLOAD                          76500016
ISSWL    EQU   X'20'                    LOAD                            77000016
ISSWP    EQU   X'10'                    PRINT                           77500016
ISSWN    EQU   X'08'                    NO CONVERT REQUESTED            78000016
ISSWPI   EQU   X'04'                    PRINT INDEX                     78500016
ISSWPP   EQU   X'02'                    PRINT PRIME                     79000016
ISSWPO   EQU   X'01'                    PRINT OVERFLOW                  79500016
ALLMASK  EQU   X'07'                                                    80000016
ISSWITCH DS    CL1                      EXTRANEOUS SWITCHES             80500016
FIRSTTM  EQU   X'80'                    FIRST TIME SWITCH               81000016
*                                                                       81500016
XCTLAREA DS    2F                                                       82000016
WHICH    DS    2F                                                       82500016
ALIGN    DS    1F                                                       83000016
DOUBLE   DS    1D                                                       83500016
EXITADDR DS    2F                                                       84000016
REENTAR  DS    9F                                                       84500016
DCBAR1   DS    64F                                                      85000016
DCBAR2   DS    64F                                                      85500016
MESSAGER DS    CL1                                                      86000016
MESSAGE  DS    CL120                                                    86500016
RECADDR  DS    1F                                                  000F 86700016
         DS    0D                                                       86800016
QISAM    DS    CL250                    UNLOADED DCB WORK AREA          87000016
HEADERC  DS    CL1                                                      87070016
HEADERT  DS    CL144                    HEADER AREA                     87140016
TARGET   DS    2F                       AREA  TO HOLD DATE              87210016
PAGENO   DS    1F                       HOLD PAGE NUMBER FOR HEADING    87280016
PAGEPTR  DS    1F                       HOLD POINTER TO WHERE PAGE      87350016
*                                          NUMBER IS TO BE PLACED       87420016
* MACRO DEFINITIONS                                                     87500016
         DCBD  DSORG=(PS)                                               88000016
         END                                                            88500016
./  ADD  SSI=71880043,NAME=IEBISL
 TITLE 'IEBISL-IEBISAM UTILITY PROGRAM - LOAD ROUTINE '                 00200016
*STATUS: CHANGE LEVEL 000                                             * 00400016
*FUNCTION/OPERATION: THIS ROUTINE RECONSTRUCTS AN INDEXED SEQUENTIAL  * 00600016
*   DATASET FROM THE INFORMATION CONTAINED IN AN UNLOADED VERSION OF  * 00800016
*   THE DATASET. FOR EACH OF THE FOLLOWING FIELDS,THE CORRESPONDING   * 01000016
*   VALUE OBTAINED FRON THE DATASET WHEN IT WAS UNLOADED WILL BE EM-  * 01200016
*   PLOYED IN RECONSTRUCTING THE NEW DATASET: OPTCD,RECFM,LRECL,BLK-  * 01400016
*   SIZE,RKP,NTM,KEYLEN,AND CYLOFL.                                   * 01600016
*                                                                     * 01800016
*INPUT: LENGTH AND ADDRESS OF THE RECORD TO BE CONSTRUCTED. DATA      * 02000016
*   PASSED BY LOCATION AND A RETURN CODE.                             * 02200016
*                                                                     * 02400016
*   REGISTER 13 MUST CONTAIN THE ADDRESS OF THHE CALLING PROGRAM'S    * 02600016
*   SAVE AREA,REGISTER 15 MUST CONTAIN THE ADDRESS OF THIS MODULE     * 02800016
*   FOR EVERY ENTRY TI THIS MODULE(EXCEPT FROM IEBISSI).                03000016
*                                                                     * 03200016
*OUTPUT: INDEXED SEQUENTIAL DATASET,COMPLETION CODE OR MESSAGE NUMBER * 03400016
*                                                                     * 03600016
*EXTERNAL ROUTINES:                                                   * 03800016
*   IEBISSI-TO GET THE LENGTH AND ADDRESS OF THE RECORD.              * 04000016
*                                                                     * 04200016
*EXITS-NORMAL:                                                        * 04400016
*   IEBISF- AFTER THE DATASET HAS BEEN RECONSTRUCTED SUCCESSFULLY.    * 04600016
*                                                                     * 04800016
*      -ERROR:                                                        * 05000016
*   IEBISF- WHEN EVER ANY ERROR CONDITIONS ARE ENCOUNTERED FOR INPUT. * 05200016
*   AND/OR OUTPUT WITH A MESSAGE NUMBER AND/OR A COMPLETION CODE      * 05400016
*                                                                     * 05600016
*ATTRIBUTES: REENTRANT                                             000G 05800016
*                                                                     * 06000016
*TABLES/WORKAREAS:                                                    * 06200016
*   QISAM- WORK AREA FOR DCB INFORMATION MAINTAINED WHEN THE DATASET  * 06400016
*   WAS UNLOADED.                                                     * 06600016
*                                                                     * 06800016
*********************************************************************** 06850040
*                                                                       07000016
*  REGISTER ASSIGNMENTS                                                 07200016
*                                                                       07400016
*********************************************************************** 07450040
BASE     EQU   10                  BASE REGISTER                        07600016
MADDR    EQU   15                  ADDRESSIBILITY REGISTER              07800016
SAVERG   EQU   13                  SAVE AREA REGISTER                   08000016
PARAM1   EQU   1                   PARAMETER REGISTER                   08200016
PARAM0   EQU   0                   PARAMETER REGISTER-LIMIT             08400016
RETREG   EQU   14                  RETURN REGISTER                      08600016
LINKRG   EQU   15                  LINK REGISTER                        08800016
WORKAREA EQU   11                       WORKAREA REGISTER          000G 09000016
WK3      EQU   3                   MESSAGE NUMBER REGISTER              09200016
WK4      EQU   4                   COMMON AREA ADDRESS REGISTER         09400016
WK2      EQU   2                   DCB ADDRESSING REGISTER              09600016
WK6      EQU   6                   UNLOADED DCB ADDRESSING REGISTER     09800016
WK8      EQU   8                   EVEN REGISTER FOR DIVISION           10000016
WK5      EQU   5                   WORK REGISTER                        10200016
WK9      EQU   9                  ODD REGISTER FRO DIVISION             10400016
RCODE    EQU   15                  RETURN CODE REGISTER                 10600016
*                                                                       10800016
*********************************************************************** 10850040
         EJECT                                                          10900040
IEBISL   CSECT                                                          11000016
*********************************************************************** 11050040
*                  FIXES THIS MODULE                                  * 11100040
*                     LATEST FIRST                                    * 11150040
*********************************************************************** 11200040
*                                                                       11250040
*A 404500-405000                             @XA16077=@YA15383=@ZA18349 11260000
*C 135000                                    @XA16077=@YA15383=@ZA18349 11270000
*D 371200-375200                             @YA13318=@XA14197=@ZA10932 11300040
*C 136000,369600                             @YA13318=@XA14197=@ZA10932 11350040
*A 134500-135000,370900-374400               @YA13318=@XA14197=@ZA10932 11400040
*                                                                       11450040
*A334400-335000                                                 OY01167 12993016
*D334400-335300                                                 OY01167 12994016
*                                                                       12994440
*A221000,222200,520000-520400,521200,535000,536000,538300,      OY01166 12995016
*A538600,541000                                                 OY01166 12996016
*D521200-526000,520000                                          OY01166 12997016
*                                                                       12997440
*0516                                                              000H 12999040
* 342000                                                         A32042 12999940
*A222100-224000                                                  A41745 13049940
*A159000,344000,520000-521000                                    A45167 13059940
*D344000,520000                                                  A45167 13069940
*A212500-212560,326500,327000,340500-341500,500500,500600,502900 A48756 13079940
*A510000-514708                                                  A48756 13089940
*C318000,368000,378000,424000,476000,500800                      A48756 13091940
*D328000,334000,380000-384000,428000,462000,480000-484000        A48756 13093940
*A212600,327500-334400,335300-335440,266000                      A52028 13095940
*D212500-218000,222100-222200,266000,334400,335600,653500        A52028 13097940
*********************************************************************** 13098340
         EJECT                                                          13098740
         SAVE  (14,12),T,ISL-V1-66           SAVE REGISTERS             13099916
         USING IEBISL,BASE                   ESTABLEIH BASE REGISTER    13200016
         LR    BASE,MADDR                     REGISTER                  13400016
         B     APARNO                   BRANCH AROUND APAR NO  @ZA10932 13450040
         DC    C'IEBISL OZ18349'        LAST APAR THIS MODULE  @ZA18349 13500000
APARNO   LR    WORKAREA,PARAM1          PICK UP WORK AREA PTR  @ZA10932 13600040
         USING IEBWORK,WORKAREA                                         13800016
         ST    SAVERG,SAVE1BK           SET BACK CHAIN POINTER     000G 14000016
         LR    SAVERG,WORKAREA          UPDATE TO NEW SAVE AREA    000G 14200016
         LA    WK2,SAVE2                SET UP FORWRD CHAIN POINTER000G 14400016
         ST    WK2,SAVE1FD                 TO NEXT SAVE AREA       000G 14600016
*********************************************************************** 14650040
*                                                                       14800016
*  THIS SECTION PASSES THE ADDRESS OF THE IEHISR COMMON WORK AREA TO  * 15000016
*THE INPUT ROUTINE IEHISSI.                                           * 15200016
*                                                                     * 15400016
*********************************************************************** 15450040
         SR    PARAM0,PARAM0                 INDICATE INITIAL ENTRY     15600016
         LR    PARAM1,WORKAREA          LOAD COMMON AREA ADDRESS   000G 15800016
         MVI   ISSWITCH,X'00'      ZERO SWITCH BEFORE TESTING    A45167 15900021
TOWARD   L     LINKRG,VSSI                   LOAD IEHISSI ADDRESS       16000016
         BALR  RETREG,LINKRG                 BRANCH TO IEHISSI          16200016
*********************************************************************** 16250040
*                                                                     * 16400016
*  THIS SECTION DETERMINES THE RETURN CODE PASSED BY IEHISSI, FOR ANY * 16600016
*RETURN CODE DIFFERENT FROM ZERO, A MESSAGE NUMBER IS SET IN THE IS-  * 16800016
*MESS FIELD OF THE IEBISR COMMON WORK AREA OR A COMPLETION CODE IS    * 17000016
*PLACED IN THE ISCOMP FIELD,THE OUTPUT DATASET IS CLOSED,SAVE AREA IS * 17200016
*POPPED UP AND AN EXIT IS MADE TO ISF.                                * 17400016
*                                                                     * 17600016
*********************************************************************** 17650040
         STC   RCODE,DOUBLE+7           STORE RETURN CODE          000G 17800016
         CLI   DOUBLE+7,X'00'           IS RETURN CODE 0           000G 18000016
         BE    COMPET                        YES,BRANCH                 18200016
         CLI   DOUBLE+7,X'04'           IS RETURN CODE 4           000G 18400016
         BE    SETA                          YES BRANCH                 18600016
         CLI   DOUBLE+7,X'08'           IS RETURN CODE 8           000G 18800016
         BE    SETAS                         YES,BRANCH                 19000016
         CLI   DOUBLE+7,X'12'           IS RETURN CODE 12          000G 19200016
         BE    SETAL                         YES,BRANCH                 19400016
         CLI   DOUBLE+7,X'16'           IS RETURN CODE 16          000G 19600016
         BE    SETAL1                        YES,BRANCH                 19800016
         CLI   DOUBLE+7,X'20'           IS RETURN CODE 20          000G 20000016
         BE    SETSW                         YES,BRANCH                 20200016
         CLI   DOUBLE+7,X'24'           RETURN CODE 24             000G 20400016
         BE    SETAL2                   INVALID DCB PARAMETERS     000G 20600016
         LA    WK3,0                   MESSAGE NO = 0  NO ERRORS   000G 20800016
FINI     STH   WK3,REENTAR+32           STORE MESSAGE NUMBER       000G 21000016
         MVC   ISMESS(2),REENTAR+32     MOVE NUMBER TO ISMESS      000G 21200016
         B     SHORTBR                  TEST FOR ERRORS          A52028 21260021
MITE     MVC   REENTAR(OPENL-CLOSEL),CLOSEL   MOVE L FORM OF CLOSE 000G 22000016
         OI    ISMESS,X'10'       SET FLAG FOR SYSNAD ROUTINE   OY01166 22100016
         CLOSE (DCBAR2),MF=(E,REENTAR) CLOSE OUTPUT DATA SET       000G 22200016
         NI    ISMESS,X'00'       SET OFF FLAG FOR SYSNAD ROUT. OY01166 22220016
         FREEPOOL DCBAR2                FREEPOOL OUTPUT BUFFER   A41745 22250021
BYPASS   SR    WK3,WK3                  SET UP XCTL AREA         A41745 22400021
         ST    WK3,XCTLAREA+4                                      000G 22600016
         MVI   WHICH+6,C' '             MOVE INTO XCTLAREA NAME OF 000G 22800016
         MVI   WHICH+5,C'F'                NEXT MODULE - IEBISF    000G 23000016
         L     SAVERG,4(0,SAVERG)            POP UP SAVE AREA           23200016
         L     RETREG,12(0,SAVERG)           RESTORE REGISTER FOURTEEN  23400016
         LR    PARAM1,WORKAREA          LOAD ADDRESS OF WORKAREA   000G 23600016
         XCTL  (2,12),MF=(E,(1)),SF=(E,XCTLAREA)  BRANCH TO IEHISF 000G 23800016
SETA     LA    WK3,2                   MESSAGE NUMBER = 2, SYN-    000G 24000016
         B     FINI                           CHRONOUS ERROR-INPUT      24200016
SETAS    LA    WK3,0                         MESSAGE NUMBER=20, OPERA-  24400016
         B     FINI                           TION COMPLETED            24600016
SETAL    LA    WK3,4                   MESAGE NUMBER = 4, LIMIT    000G 24800016
         B     FINI                           EXCEEDED                  25000016
SETAL1   LA    WK3,9                    MESSAGE NUMBER=9,INPUT     000H 25200017
         B     FINI                           OUT OF SEQUENCE           25400016
SETAL2   LA    WK3,1                    INVALID DCB PARAMETERS     000G 25600016
         B     FINI                  C                             000G 25800016
SETSW    MVC   ISCOMP(2),H16            COMPLETION CODE = 16       000G 26000016
         LA    WK3,7                    SET MESSAGE FOR MISSING DD 000G 26200016
         STH   WK3,ISMESS                                          000G 26400016
         B     BYPASS                   SYSUT1 NOT OPEN,SO BYP.  A52028 26600021
*********************************************************************** 26650040
*                                                                     * 26800016
*  THIS SECTION, UPON FIRST RETURN FROM IEHISSI,PASS THE LENGTH OF THE* 27000016
*ISAM DCB AS THE LIMIT AND THE ADDRESS OF 'QISAM',FOR THE RETRIEVAL OF* 27200016
*THE ISAM DCB WRITTEN OUT WHEN DATA SET WAS UNLOADED.                 * 27400016
*                                                                     * 27600016
*********************************************************************** 27650040
COMPET   LTR   PARAM0,PARAM0                 FIRST RETURN               27800016
         BNE   TSTALL                        NO,BRANCH                  28000016
         LA    PARAM0,154                                               28200016
         LA    PARAM1,QISAM                  LOAD QISAM ADDRESS         28400016
         MVI   DOUBLE+6,X'FF'           INDICATE OUTPUT NOT OPEN   000G 28600016
         B     TOWARD                        GO GET WRITTEN DCB         28800016
TSTALL   CLI   DOUBLE+6,X'FF'           OUTPUT OPEN                000G 29000016
         BNE   RESUME1                                                  29200016
*********************************************************************** 29250040
*                                                                     * 29400016
*  THIS SECTION NOVES THE DDNAME FROM IEHISR ISUT2 FIELD INTO THE OUT-* 29600016
*PUT DCB,AND OPENS THE DATASET. A CHECK FDR A SUCCESSFUL OPEN IS MADE.* 29800016
*                                                                     * 30000016
*********************************************************************** 30050040
         MVC   DCBAR2(LABEL-DCBISL),DCBISL                         000G 30200016
         USING IHADCB,WK2                                               30400016
         LA    WK2,DCBAR2                                          000G 30600016
         MVC   DCBDDNAM(8),ISUT2        MOVE DDNAME FROM ISUT2     000G 30800016
         MVC   REENTAR(EIGHT-OPENL),OPENL   MOVE L FORM OF OPEN TO 000G 31000016
*                                               WORKAREA           000G 31200016
         OPEN  (DCBAR2,(OUTPUT)),MF=(E,REENTAR) OPEN OUTPUT DATASET000G 31400016
         TM    DCBOFLGS,X'10'                WAS OPEN SUCCESSFUL        31600016
         BZ    SETDOUBL           NO,BRANCH                      A48756 31800000
*********************************************************************** 31850040
*  THIS SECTION CHECKS TO SEE IF THE INCONSISTENCY INDICATOR FOR THE  * 32000016
*SPECIFIED FIELDS IN THE OUTPUT DCB IS ON. IF SO A MESSAGE NUMBER IS  * 32200016
*SET AND A BRANCH TO CLOSE AND EXIT IS TAKEN.                         * 32400016
*                                                                     * 32600016
*********************************************************************** 32610040
         B     RESUME             CONT, SYSUT2 DCB ERROR WILL    A48756 32650021
*                                 BE CHECKED IN IEBISSI          A48756 32700021
SHORTBR  LTR   WK3,WK3            MESSAGE NUMBER 0 ?             A52028 32750021
         BNZ   CHSYSUT2           NO, BRANCH                     A52028 32800021
         TM    DCBOFLGS,X'10'     SYSUT2 DCB OPEN ?             OY01167 33440016
         BO    MITE               YES, CLOSE SYSUT2 DATA SET    OY01167 33470016
         MVI   ISMESS+1,X'09'     SET MSG NBR --OUT OF SEQ--    OY01167 33500016
CHSYSUT2 MVC   ISCOMP(2),EIGHT          COMPLETION CODE = 8      A52028 33532021
         TM    DCBOFLGS,X'10'      SYSUT2 OPENED ?               A52028 33540021
         BZ    BYPASS              NO, DO NOT CLOSE SYSUT2       A52028 33542021
         B     MITE                YES, CLOSE SYSUT2             A52028 33544021
*********************************************************************** 33594040
*  THIS SECTION GETS THE ADDRESS OF THE NEXT AVAILABEL OUTPUT AREA AND* 33600016
*LOADS THE LIMIT FOR IEBISSI.                                         * 33800016
*                                                                     * 34000016
*********************************************************************** 34010040
SETDOUBL MVI   DOUBLE+7,X'20'     SET ERROR BIT, NO OPEN UT2     A48756 34050021
         LA    PARAM0,100         SET REG 0 UNEQ. ZERO           A48756 34100000
         B     TOWARD             BRANCH TO IEBISSI              A48756 34150000
RESUME   MVI   ISSWITCH,X'FF'      MARK SYSUT2 OPEN              A45167 34400021
         LH    PARAM0,DOUBLE+4          LOAD LIMIT ADDRESS IN 1    000G 34600016
         AH    PARAM0,REENTAR+34        ADD KEYLENGTH TO RECORD    000G 34800016
         B     TOWARD                                                   35000016
*********************************************************************** 35050040
*  THIS IS THE OUTPUT DCB EXIT. THE NTM,CYLOFL AND OPTCD DCB FIELDS OF* 35200016
*THE UNLOADED DATASET ARE COPIED IN THE RESPECTIVE FIELDS OF THE NEW  * 35400016
*DATASET. IF THE RECORD FORMAT IN THE UNLOADRD(OLD) AND NEW DATASETS  * 35600016
*IS NOT THE SAME AND THE LOGICAL RECORD LENGTH FIELD OF THE NEW DATA  * 35800016
*SET IS GREATER THAN THAT OF THE OLD, A BRANCH IS MADE TO INDICATE IN-* 36000016
*CONSISTENCY. IF NO BLKSIZE IS SPECIFIED FOR THE NEW DATASET THE      * 36200016
*LOGICAL RECORD LENGTH IS USED AS THE LIMIT.  IF RECFM SPECIFIES      * 36300016
*VARIABLE THEN THE RKP MUST BE EQUAL TO OR GREATER THAN 4             * 36400016
*********************************************************************** 36450040
ISLEXT   LA    WK6,QISAM                     ADDRESS OF UNLOADED DCB    36600016
         XC    DOUBLE+6(2),DOUBLE+6     SET CONSIST FLAGS TO 0   A48756 36800021
         OC    DCBNTM(1),DCBNTM         NTM SPECIFIED              000G 36880040
         BNZ   OPTCD                    YES, NTM SPECIFIED     @ZA10932 36960040
         MVC   DCBNTM(1),54(WK6)        GET OLD NTM FIELD          000G 37040016
OPTCD    OC    DCBOPTCD(1),DCBOPTCD     OPTCD SPECIFIED        @ZA10932 37090040
         BNZ   CYLOF                    YES, OPTCD SPECIFIED   @ZA10932 37140040
         MVC   DCBOPTCD(1),52(WK6)      GET OLD OPTCD          @ZA10932 37190040
CYLOF    TM    DCBOPTCD,X'08'           OTPCD=Y SPECIFIED      @ZA10932 37240040
         BZ    TLRECL                   NO,THEN NO CYLOF       @ZA10932 37290040
         OC    DCBCYLOF(1),DCBCYLOF     CYLOF SPECIFIED        @ZA10932 37340040
         BNZ   TLRECL                   YES, CYLOF SPECIFIED   @ZA10932 37390040
         MVC   DCBCYLOF(1),55(WK6)      GET OLD CYLOF          @ZA10932 37440040
TLRECL   CLC   DCBLRECL(2),ZERO        LRECL FIELD = ZERO?         000G 37600016
         BE    MVERECL                  YES,USE UNLOADED VALUE   A48756 37800000
*********************************************************************** 37850040
*                                                                     * 38600016
*  THIS SECTION DETERMINES THE RECORD FORMAT. IF FIXED, AND THE BLOCK * 38800016
*SIZE IS NOT A MULTIPLE OF THE LOGICAL RECORD LWNGTH,A BRANCH IS MADE * 39000016
*TO INDICATE INCONSISTEMCY. OTHERWISE,THE LOGICAL RECORD LENGTH IS    * 39200016
*USED AS THE LINIT.                                                   * 39400016
*********************************************************************** 39450040
TBLKSI   LH    WK9,DCBBLKSI                  LOAD BLOCKSIZE             39600016
         LTR   WK9,WK9                                                  39800016
         BZ    MVEBLK                        YES,USE UNLOADED VALUE     40000016
TRECFM   CLI   DCBRECFM,X'00'                RECFM FIELD=0?             40200016
         BE    MVEFM                         YES,BRANCH                 40400016
         TM    DCBRECFM,X'08'           NEW RECFM VBS OR FBS   @ZA18349 40450000
         BO    NONCON                   YES, INVALID FOR ISAM  @ZA18349 40500000
CHECKF   TM    DCBRECFM,X'80'           NEW RECFM FIXED            000G 40600016
         BZ    TVARY                         NO,BRANCH                  40800016
         TM    36(WK6),X'80'                 OLD RECFM FIXED?           41000016
         BO    TMULTPLE                      YES,BRANCH                 41200016
         MVI   DOUBLE+6,X'01'           SET INVALID INDICATOR      000G 41400016
TMULTPLE LH    WK5,DCBLRECL                  LOAD LOGICAL RECORD LENT   41600016
         SR    WK8,WK8                                                  41800016
         DR    WK8,WK5                       IS BLOCK SIZE A MULTIPLE   42000016
         LTR   WK8,WK8                        OF LOGICAL RECORD LENGTH  42200016
         BE    TKEYLFLD                                                 42400021
         MVI   DOUBLE+6,X'01'           SET INVALID INDICATOR      000G 42600016
         B     TKEYLFLD                                                 43000016
MVEFM    MVC   DCBRECFM(1),36(WK6)           GET OLD REFM FIELD         43200016
         B     CHECKF                                              000G 43400016
MVERECL  MVC   DCBLRECL(2),82(WK6)           GET OLD LRECL VALUE        43600016
         B     TBLKSI                                                   43800016
MVEBLK   MVC   DCBBLKSI(2),62(WK6)           GET OLD BLKSIZE            44000016
         LH    WK9,DCBBLKSI                  LOAD BLOCKSIZE             44200016
         B     TRECFM                                                   44400016
*********************************************************************** 44450040
*                                                                     * 44600016
*  THIS SECTION USES THE BLKSIZE AS THE LIMIT FOR RECORDS OF VARIABLE * 44800016
*FORMAT,IF THE BLOCK SIZE IS GREATER THAN OR EQUAL TO THE LOGICAL RE- * 45000016
*CORD LENGTH.                                                         * 45200016
*********************************************************************** 45250040
TVARY    TM    36(WK6),X'40'                 OLD RECFM VARIABLE?        45400016
         BZ    NONCON                        NO,BRANCH                  45600016
VARBLE   CH    WK9,DCBLRECL                  BLKSI GREATER THAB OR      45800016
         BL    NONCON                         EQUAL TO LRECL? NO,BRANCH 46000016
*********************************************************************** 46050040
*                                                                     * 46400016
*   THIS SECTION DETERMINES IF THE RKP IS GREATER THAN THE LGICAL RE- * 46600016
*CORD LENGTH MINUS THE KEYLEN. IF SO, THE INCONSISTENCY INDICATOR IS  * 46800016
*SET.AND A RETURN TO THE OPEN ROUTINE IS MADE.                        * 47000016
*                                                                     * 47200016
*********************************************************************** 47250040
TKEYLFLD CLI   DCBKEYLE,X'00'                KEYLEN FIELD ZERO?         47400016
         BNE   TMINUS                   NO, DON'T USE OLD KEYLE  A48756 47600000
         MVC   DCBKEYLE(1),16(WK6)           USE OLD KEYLEN             47800016
TMINUS   LH    WK8,DCBLRECL                  LOAD LOGICAL RECRD LENGTH  48600016
         SR    WK5,WK5                                                  48800016
         IC    WK5,DCBKEYLE                  GET KEY LENGTH             49000016
         STC   WK5,REENTAR+35                                           49200016
         SR    WK8,WK5                       SUBTRACT KEYLE FROM LRECK  49400016
         LH    WK5,DCBRKP                    LOAD ELATIVE KEY POSITION  49600016
         LTR   WK5,WK5                       RKP=0?                     49800016
         BZ    TSTOLD                                                   50000016
TRKP     CLI   DCBRECFM,X'80'     SYSUT2 HAS RECFM F ?           A48756 50050021
         BNE   RKPTEST            NO, CHECK FOR VALID RKP        A48756 50060021
         LTR   WK5,WK5                  IS RKP=0                 A28558 50080021
         BZ    RTOPEN                   YES, DO NOT SET          A28558 50160019
*                                       NONCONSISTENCY INDICATOR A28558 50240019
RKPTEST  EQU   *                                                 A48756 50290021
         CH    WK8,DCBRKP               RKP FIELD GT             A28558 50320019
*                                             LRECL MINUS THE KEYLEN    50400016
         BNL   RTOPEN                        NO, BRANCH                 50600016
NONCON   MVI   DOUBLE+6,X'01'           SET NONCONSISTENCY INDICATR000G 50800016
RTOPEN   CLI   DOUBLE+6,X'00'     DCB ERROR ENCOUNTERED ?        A48756 51000021
         BNE   ERRDCB             YES, RETURN TO OPEN            A48756 51050021
         TM    DCBRECFM,X'C0'     RECFM SYSUT2 U ?               A48756 51160021
         BO    ERRDCB1            YES, PRINT ERRMSG IEB601I      A48756 51170000
         TM    36(WK6),X'40'      RECFM SYSUT1 V ?               A48756 51196021
         BZ    FIXRECFM           NO, RECFM IS F/FB              A48756 51198021
         CLC   DCBLRECL(2),82(WK6) LRECL UT2 < LRECL UT1 ?       A48756 51198421
         BL    ERRDCB1            YES, ERROR                     A48756 51198800
         LH    WK5,DCBLRECL       LOAD UT2 LRECL                 A48756 51199221
         LA    WK5,4(WK5)         ADD 4 TO UT2 LRECL             A48756 51199321
         CH    WK5,DCBBLKSI       LRECL+ 4 > BLKSI ?             A48756 51199421
         BC    12,RETURN2         NO, OKE                        A48756 51199521
         STH   WK5,DCBBLKSI       SET DEFAULT BLKSI              A48756 51199621
         B     ERRDCB1            SET ERRBIT                     A48756 51199700
TSTL1L2  CLC   DCBLRECL(2),82(WK6) UT1 LRECL EQ. UT2 LRECL ?     A48756 51199821
         BNE   ERRDCB1            NO, PRINT ERRMSG IEB601I       A48756 51199900
         B     RETURN2            RETURN TO OPEN SYSUT2          A48756 51200021
FIXRECFM SR    WK5,WK5            ZERO REGISTER 5                A48756 51212322
         IC    WK5,16(WK6)        LOAD KELENGTH IN REGISTER 4    A48756 51222322
         LH    WK8,82(WK6)        LOAD UT2 LRECL IN REGISTER 6   A48756 51224322
         CLC   60(2,WK6),ZERO     UT1 RKP=0 ?                    A48756 51249921
         BNE   TSTRKP2            NO, TEST DCB VALUES            A48756 51259921
         CLC   DCBRKP(2),ZERO     UT2 RKP=0 ?                    A48756 51269921
         BNE   TSTRECF1           NO, TEST UT1 DCB VALUES        A48756 51279921
         CLC   DCBRECFM(1),36(WK6) RECFM UT1 EQ. RECFM UT2       A48756 51280322
         BE    TSTL1L2            YES, TEST FOR EQUAL LRECL      A48756 51280722
         TM    36(WK6),X'90'      UT1 RECFM = F ?                A48756 51293921
         BM    COMPL1L2           YES, COMPARE UT1 & UT2 LRECL'S A48756 51295921
NOEQL1L2 SR    WK8,WK5            SET WK6 : LRECL1 MINUS KEYLEN1 A48756 51297922
         CH    WK8,DCBLRECL       LRECL2 EQ.TO LRECL1 MINUS KEY? A48756 51299121
         BC    8,RETURN2          YES, OKE RETURN TO OPEN UT2    A48756 51299521
         STH   WK8,DCBLRECL       SET LRECL2 = LRECL1 MINUS KEY1 A48756 51299621
         STH   WK8,DCBBLKSI       SET BLKS2 = LRECL1 MINUS KEY1  A48756 51299721
         B     RETURN2            RETURN TO OPEN SYSUT2          A48756 51310821
COMPL1L2 AR    WK8,WK5            SET WK6: LRECL1 PLUS KEYLEN1   A48756 51333200
         CH    WK8,DCBLRECL     UT2(RCFM=FB) EQ. LRC1 PLUS KEY ? A48756 51343221
         BC    8,RETURN2          YES, RETURN TO OPEN SYSUT2     A48756 51353221
         STH   WK8,DCBLRECL       LRECL2=LRECL1 PLUS KEYLEN1     A48756 51363221
         MR    WK8,WK8            MULTIPLY R9 AND R8             A48756 51365221
         STH   WK9,DCBBLKSI       BLKSI2= R9 * (LRECL1 PLUS KEY) A48756 51365621
         B     RETURN2            RETURN TO OPEN SYSUT2          A48756 51365721
TSTRKP2  CLC   DCBRKP(2),ZERO     UT2 RKP=0 ?                    A48756 51366421
         BNE   TSTL1L2            NO, TEST FOR EQUAL LRECL'S     A48756 51366521
         TM    DCBRECFM,X'90'     UT2 RECFM=FB ?                 A48756 51377621
         BO    TSTL1L2            YES, TEST FOR EQUAL LRECL'S    A48756 51387621
         B     NOEQL1L2           NO, CHECK FOR UNEQUAL LRECL'S  A48756 51388021
TSTRECF1 TM    36(WK6),X'90'      UT1 RECFM = FB ?               A48756 51388421
         BO    TSTL1L2            YES, TST FOR EQ. LRECL'S       A48756 51388821
         B     COMPL1L2           NO, CHECK FOR UNEQUAL LRECL'S  A48756 51390822
ERRDCB   MVI   DCBKEYLE,X'10'        SET DEFAULT                 A48756 51404600
         MVI   DCBRECFM,X'80'        VALUES                      A48756 51414600
         MVC   DCBRKP(2),ZERO        TO ASSURE CORRECT           A48756 51424600
         NI    DCBBLKSI,X'00'        OPENING                     A48756 51426600
         MVI   DCBBLKSI+1,X'50'      OF SYSUT2                   A48756 51434600
         MVC   DCBLRECL(2),DCBBLKSI  DATA SET.                   A48756 51436600
ERRDCB1  MVI   DOUBLE+6,X'01'        PRINT ERRMSG IEB601I        A48756 51444600
RETURN2  MVC   DOUBLE+4(2),DCBLRECL  USE LRECL AS LIMIT          A48756 51470821
         RETURN                                                         51497421
         DS    0F                                                       51531621
TESTS    DC    X'85'                                                    51565821
         DC    AL3(ISLEXT)                                              51600016
*********************************************************************** 51650040
*  THIS IS THE OUTPUT DATASET SYNAD ROUTINE                           * 51800016
*********************************************************************** 51850040
MESS     TM    ISMESS+1,X'FF'      ALREADY MESS NBR SET ?       OY01166 52000016
         BCR   4,RETREG           YES, RETURN TO CLOSE          OY01166 52010016
         TM    ISMESS,X'10'       ARE WE IN CLOSE ?             OY01166 52020016
         BC    1,DONTRES          YES, DONT RESTORE REGISTERS   OY01166 52030016
         L     SAVERG,4(SAVERG)   ADDRESS SAVE AREA ISL REGIST. OY01166 52040016
         LM    14,12,12(SAVERG)    GET ISL REGISTERS             A45167 52060021
DONTRES  EQU   *                  DONT RESTORE ISL REGISTERS    OY01166 52120016
ENUFROOM SYNADAF ACSMETH=QISAM,PARM1=DCBAR2,PARM2=(0)              000G 53000016
         MVC   MESSAGE+8(79),49(PARAM1)   MOVE IN MESSAGE          000G 53400016
         MVI   ISMESS+1,X'02'     SET SYNAD MSG INDICATOR       OY01166 53500016
         MVI   ISCOMP+1,X'08'     SET CONDITION CODE            OY01166 53600016
         SYNADRLS                                                  000G 53800016
         TM    ISMESS,X'10'       ARE WE IN SYSUT2 CLOSE ?      OY01166 53830016
         BCR   1,RETREG           YES, RETURN TO CLOSE          OY01166 53860016
         MVC   REENTAR(OPENL-CLOSEL),CLOSEL MOVE L FORM FOR CLSE A24745 53900018
         CLOSE (DCBAR1),MF=(E,REENTAR) CLOSE INPUT DATA SET      A24745 54000018
         LA    WK3,2              LOAD SYNAD MSG NBR IN REG 3   OY01166 54100016
         B     SETA                                                000G 54200016
TSTOLD   CLC   60(2,WK6),ZERO         OLD RKP FIELD = 0 ?          000G 55200016
         BE    CHECKD                   YES, BRANCH                000G 55400016
         MVC   DCBRKP(2),60(WK6)             GET OLD RKP                55600016
CHECKD   TM    DCBRECFM,X'80'           NEW RECFM FIXED            000G 55620016
         BC    1,TRKP                   YES,NEW RECFM FIXED             55640016
         CLI   DCBRKP+1,X'04'           RKP LESS THAN 4            000G 55660016
         BL    NONCON                   YES RKP LESS THAN 4        000G 55680016
         B     TRKP                                                000G 55780016
*********************************************************************** 55830040
*                                                                       56000016
*CONSTANTS                                                              56200016
*                                                                       56400016
*********************************************************************** 56450040
CLOSEL   CLOSE (,DISP),MF=L                                             56600016
OPENL    OPEN  (,OUTPUT),MF=L                                           56800016
EIGHT    DC    H'8'               COMPLETION CODE CONSTANT              57000016
ZERO     DC    H'0'                                                000G 57200016
VSSI     DC    V(IEBISSI)         IEBISSI ADDRESS-INPUT ROUTINE         57400016
H16      DC    H'16'                                                    57600016
*                                                                       57800016
DCBISL   DCB   DSORG=IS,MACRF=PL,DDNAME=SYSUT2,                        *58000016
               SYNAD=MESS,EXLST=TESTS                                   58200016
LABEL    DS    0F                      DUMMY LABEL                 000G 58400016
         DCBD  DSORG=(IS)                                               58600016
IEBWORK  DSECT                                                          58800016
SAVE1    DS    1F                                                       59000016
SAVE1BK  DS    1F                                                       59200016
SAVE1FD  DS    1F                                                       59400016
         DS    15F                                                      59600016
SAVE2    DS    1F                                                       59800016
SAVE2BK  DS    1F                                                       60000016
SAVE2FD  DS    1F                                                       60200016
         DS    15F                                                      60400016
SAVE3    DS    1F                                                       60600016
SAVE3BK  DS    1F                                                       60800016
SAVE3FD  DS    1F                                                       61000016
         DS    15F                                                      61200016
*********************************************************************** 61250040
*IEHISR WORKAREA                                                        61400016
*********************************************************************** 61450040
ISINVOK  DS    F                        ADDRESS OF PARAMETER LIST AT    61600016
*                                          INVOCATION                   61800016
ISPRINT  DS    2F                       DDNAME FOR SYSPRINT             62000016
ISUT1    DS    2F                       DDNAME FOR SYSUT1               62200016
ISUT2    DS    2F                       DDNAME FOR SYSUT2               62400016
ISCOMP   DS    H                        COMPLETION CODE                 62600016
ISMESS   DS    H                        MESSAGE NUMBER                  62800016
ISPAGE   DS    H                        PAGE NUMBER FOR SYSPRINT        63000016
ISCNTRL  DS    CL1                      CONTROL BYTE                    63200016
*********************************************************************** 63250040
* MASKS FOR TESTING CONTROL BYTE - ISCONTRL                             63400016
*********************************************************************** 63450040
ISSWC    EQU   X'80'                    COPY                            63600016
ISSWU    EQU   X'40'                    UNLOAD                          63800016
ISSWL    EQU   X'20'                    LOAD                            64000016
ISSWP    EQU   X'10'                    PRINT                           64200016
ISSWN    EQU   X'08'                    NO CONVERT REQUESTED            64400016
ISSWPI   EQU   X'04'                    PRINT INDEX                     64600016
ISSWPP   EQU   X'02'                    PRINT PRIME                     64800016
ISSWPO   EQU   X'01'                    PRINT OVERFLOW                  65000016
ALLMASK  EQU   X'07'                                                    65200016
RESUME1  EQU   RESUME                                            A32042 65300020
ISSWITCH DS    CL1                      EXTRANEOUS SWITCHES             65400016
FIRSTTM  EQU   X'80'                    FIRST TIME SWITCH               65600016
*                                                                       65800016
XCTLAREA DS    2F                                                       66000016
WHICH    DS    2F                                                       66200016
ALIGN    DS    1F                                                       66400016
DOUBLE   DS    1D                                                       66600016
EXITADDR DS    2F                                                       66800016
REENTAR  DS    9F                                                       67000016
DCBAR1   DS    64F                                                      67200016
DCBAR2   DS    64F                                                      67400016
MESSAGER DS    CL1                                                      67600016
MESSAGE  DS    CL120                                                    67800016
RECADDR  DS    1F                                                  000G 68000016
         DS    0D                                                       68200016
QISAM    DS    CL250                    UNLOADED DCB WORK AREA          68400016
HEADERC  DS    CL1                                                      68600016
HEADERT  DS    CL144                    HEADER AREA                     68800016
TARGET   DS    2F                       DATE HOLD AREA                  69000016
PAGENO   DS    1F                       HOLD PAGE NUMBER FOR A HEADING  69200016
PAGEPTR  DS    1F                       HOLD POINTER TO WHERE PAGE      69400016
*                                       NUMBER IS TO BE PLACED          69600016
         END                                                            69800016
./  ADD  SSI=71880044,NAME=IEBISMES
 TITLE 'IEBISMES  - IEBISAM UTILITY PROGRAM - MESSAGE MODULE'           01000016
*STATUS AND CHANGE LEVEL 0                                              02000016
*                                                                       03000016
*FUNCTION - THIS MODULE CONTAINS ALL THOSE MESSAGES THAT WILL BE        04000016
*           WRITTEN ONTO THE DATA SET DESCRIBED  BY THE SYSPRINT        05000016
*           DD CARD. THIS MESSAGE ALSO CONTAINS THE HEADING TO BE       06000016
*           WRITTEN WITH THE MESSAGE.                                   07000016
*                                                                       08000016
*ENTRY POINTS - N/A                                                     09000016
*                                                                       10000016
*INPUT - N/A                                                            11000016
*                                                                       12000016
*OUTPUT-  N/A                                                           13000016
*                                                                       14000016
*EXTERNAL ROUTINES - N/A                                                15000016
*                                                                       16000016
*EXITS - N/A                                                            17000016
*                                                                       18000016
*ATTRIBUTES - REENTRANT                                                 19000016
*                                                                       20000016
IEBISMES CSECT                                                          21000016
*0118                                                              000H 21500017
         ENTRY MESSTBL                                                  22000016
MESSTBL  DS    0F                                                       23000016
MESS     DC    X'00'                                                    24000016
         DC    AL3(MESS0)                                               25000016
         DC    X'00'                                                    26000016
         DC    AL3(MESS1)                                               27000016
         DC    X'00'                                                    28000016
         DC    AL3(MESS2)                                               29000016
         DC    X'00'                                                    30000016
         DC    AL3(MESS3)                                               31000016
         DC    X'00'                                                    32000016
         DC    AL3(MESS4)                                               33000016
         DC    X'00'                                                    34000016
         DC    AL3(MESS5)                                               35000016
         DC    X'00'                                                    36000016
         DC    AL3(MESS6)                                               37000016
         DC    X'00'                                                    38000016
         DC    AL3(MESS7)                                               39000016
         DC    X'00'                                                    40000016
         DC    AL3(MESS8)                                               41000016
         DC    X'00'                                               000H 41300017
         DC    AL3(MESS9)                                          000H 41600017
MESS0    DC    CL32'IEB600I   UTILITY PROGRAM IEBISA'                   42000016
         DC    CL32'M HAS SUCCESSFULLY COMPLETED THE'                   43000016
         DC    CL32' REQUESTED OPERATION            '                   44000016
         DC    CL24'COMPLETION CODE=00      '                           45000016
MESS1    DC    CL32'IEB601I   DCB FIELD VALUES INCON'                   46000016
         DC    CL32'SISTENT                         '                   47000016
         DC    CL32'                                '                   48000016
         DC    CL24'COMPLETION CODE=08      '                           49000016
MESS2    DC    CL32'IEB602I   TEXT OF MESSAGE GIVEN  '                  50000016
         DC    CL32'BY THE SYNADAF MACRO             '                  51000016
         DC    CL32'                                 '                  52000016
         DC    CL24'                        '                           53000016
MESS3    DC    CL32'IEB603I   DUPLICATE RECORD      '                   54000016
         DC    CL32'                                '                   55000016
         DC    CL32'                                '                   56000016
         DC    CL24'COMPLETION CODE=08      '                           57000016
MESS4    DC    CL32'IEB604I   NUMBER OF CHARACTERS T'                   58000016
         DC    CL32'O BE TRANSMITTED EXCEEDS LIMIT  '                   59000016
         DC    CL32'                                '                   60000016
         DC    CL24'COMPLETION CODE=08      '                           61000016
MESS5    DC    CL32'IEB605I   CLOSE REQUESTED BY USE'                   62000016
         DC    CL32'R AFTER A USER EXIT             '                   63000016
         DC    CL32'                                '                   64000016
         DC    CL24'COMPLETION CODE=04      '                           65000016
MESS6    DC    CL32'IEB606I   ILLEGAL RETURN CODE RE'                   66000016
         DC    CL32'CEIVED FROM A USER EXIT         '                   67000016
         DC    CL32'                                '                   68000016
         DC    CL24'COMPLETION CODE=12      '                           69000016
MESS7    DC    CL32'IEB607I   SYSUT1 OR SYSUT2 DD CA'                   70000016
         DC    CL32'RD MISSING                      '                   71000016
         DC    CL32'                                '                   72000016
         DC    CL24'COMPLETION CODE=16      '                           73000016
MESS8    DC    CL32'IEB608I   INVALID OPTION IN THE'                    74000016
         DC    CL32' PARM FIELD OF THE EXECUTE CARD  '                  75000016
         DC    CL32'                                 '                  76000016
         DC    CL24'COMPLETION CODE=16      '                           77000016
MESS9    DC    CL32'IEB609I   INPUT SEQUENCE ERROR  '              000H 77200017
         DC    CL32'                                '              000H 77400017
         DC    CL32'                                '              000H 77600017
         DC    CL24'COMPLETION CODE=08      '                      000H 77800017
         END                                                            78000016
./  ADD  SSI=71880045,NAME=IEBISPL
 TITLE 'IEBISPL - IEBISAM UTILITY PROGRAM - PRINT LOGICAL ROUTINE'      00200016
*STATUS AND CHANGE LEVEL 000                                            00400016
*FUNCTION/OPERATION-THIS MODULE PRINTS THE DATA RECORDS OF AN           00600016
*   INDEXED SEQUENTIAL DATA SET USING THE QUEUED INDEX SEQUENTIAL       00800016
*   ACCESS METHOD TO READ THE RECORDS AND THE QUEUED SEQUENTIAL ACCESS  01000016
*   METHOD TO WRITE THE RECORDS. THE RECORDS ARE RETRIEVED IN LOGICAL   01200016
*   SEQUENCE FROM THE PRIME AND OVERFLOW AREAS                          01400016
*                                                                       01600016
*                                                                       01800016
*                                                                       02000016
*                                                                       02200016
*                                                                       02400016
*                                                                       02600016
*                                                                       02800016
*ENTRY POINTS - IEBISPL - TO OPEN THE INPUT AND THE PRINT DATA SETS,    03000016
*   TO GET THE ISAM RECORDS, BUFFER THEM, PASS CONTROL TO A USER'S EXIT 03200016
*   PRINT THE RECORDS, CLOSE THE DATA SETS AND GIVE CONTROL TO IEBISF.  03400016
*                                                                       03600016
*INPUT - COMMON WORK AREA SET UP                                        03800016
*                                                                       04000016
*        ISINVOK  - ADDRESS OF PARM LIST FOR INVOCATION                 04200016
*        ISPRINT  - DDNAME FOR PRINT DATA SET                           04400016
*        ISUT1    - DDNAME FOR INPUT                                    04600016
*        ISUT2    - DDNAME FOR OUTPUT                                   04800016
*        ISPAGE   - PAGE NUMBER TO BE USED                              05000016
*        ISCNTRL  - ISSWD                                               05200016
*                   OPTIONALLY - ISSWN                                  05400016
*WORK AREA SET UP                                                       05600016
*   REGISTER 13 CONTAINS THE ADDRESS OF THE CALLING PROGRAM'S SAVE AREA 05800016
*   REGISTER 14 CONTAINS THE RETURN ADDRESS, AND REGISTER 15 CONTAINS   06000016
*   THE ADDRESS OF THIS MODULE FOR EVERY ENTRY TO THIS MODULE.          06200016
*                                                                       06400016
*OUTPUT- LOGICAL PRINT OUT OF AN INDEXED SEQUENTIAL DATA SET,MESSAGE    06600016
*   NUMBER/COMPLETION CODE                                              06800016
*                                                                       07000016
*        ISINVOK  - ADDRESS OF PARM LIST FOR INVOCATION                 07200016
*        ISPRINT  - DDNAME FOR SYSPRINT                                 07400016
*        ISUT1    - DDNAME FOR INPUT                                    07600016
*        ISUT2    - DDNAME FOR OUTPUT                                   07800016
*        ISCOMP   - COMPLETION CODE TO BE RETURNED                      08000016
*        ISMESS   - MESSAGE NUMBER OF MESSAGE TO BE PRINTED             08200016
*        ISPAGE   - PAGE NUMBER TO BE USED                              08400016
*        XCTLAREA & WHICH - SET UP FOR XCTL TO IEBISF                   08600016
*                                                                       08800016
*                                                                       09000016
*EXTERNAL ROUTINES - NONE                                               09200016
*                                                                       09400016
*EXITS- NORMAL - IEBISF - AFTER THE DATA SET HAS BEEN PRINTED           09600016
*     - ERROR  - IEBISF - WHENEVER ANY ERROR CONDITION IS ENCOUNTERED   09800016
*   WITH A MESSAGE NUMBER AND/OR A COMPLETION CODE.                     10000016
*                                                                       10200016
*ATTRIBUTES - REENTRANT                                                 10400016
*                                                                       10600016
*TABLES/WORKAREAS                                                       10800016
*                                                                       11000016
*REGISTER ASSIGNMENTS                                                   11200016
*                                                                       11400016
PAREG0   EQU   0                        PARMETER REGISTER               11600016
PAREG1   EQU   1                        PARAMETER REGISTER              11800016
CONS     EQU   2                                                        12000016
WK3      EQU   3                        WORK REGISTER                   12200016
WK4      EQU   4                        WORK REGISTER                   12400016
WK5      EQU   5                        WORK REGISTER                   12600016
WK6      EQU   6                        WORK REGISTER                   12800016
OPREG    EQU   7                        POINTER REGISTER                13000016
IRETREG  EQU   8                        INTERNAL RETURN REGISTER        13200016
GOREG    EQU   9                        POINTER REGISTER                13400016
BASEREG  EQU   10                       BASE REGISTER                   13600016
WORKAREA EQU   11                       WORK AREA REGISTER              13800016
PTREG    EQU   12                                                       14000016
SAVREG   EQU   13                       SAVE AREA REGISTER              14200016
RETREG   EQU   14                       RETURN AREA REGISTER            14400016
ADDR     EQU   15                       BASS ADDRESSABILITY/RETURN CODE 14600016
         EJECT                                                          14800016
IEBISPL  CSECT                                                          15000016
*                                                                       15050000
*A236500                                                       @ZA06559 15060000
*1770272100-272800                                                 IV0I 15100018
*A417700,417800                                                  A41745 15150021
*A215620-215660,406100,406500,411500,470000-470500,472000,       A41801 15170021
*A474000-475500,478100-478400,490500,634804-634848,634850-634870 A41801 15180021
*A634520-634560                                                  A41801 15182021
*D468000,470000,472000,474000,634850                             A41801 15190021
*STANDARD LINKAGE CONVENTION                                            15200016
         SAVE  (14,12),T,ISPL-67-V1     SAVE CALLING PROGRAMS REGISTERS 15400016
         USING IEBISPL,BASEREG          ESTABLISH ADDRESSABILITY        15600016
         LR    BASEREG,ADDR                                             15800016
         LR    WORKAREA,PAREG1          PICK UP WORK AREA POINTER       16000016
         USING IEBWORK,WORKAREA                                         16200016
         ST    SAVREG,SAVE1BK           SET BACK CHAIN POINTER          16400016
         LR    SAVREG,WORKAREA          UPDATE TO NEW SAVE AREA         16600016
         LA    WK4,SAVE2                SET UP FORWARD CHAIN POINTER    16800016
         ST    WK4,SAVE1FD                 TO NEXT SAVE AREA            17000016
         LA    GOREG,DCBAR1             POINT TO INPUT DCB              17200016
         LA    PTREG,DCBAR2             POINT TO OUTPUT DCB             17400016
         USING IHADCB,GOREG                                             17600016
*THIS SECTION MOVES THE DCB'S AND THE OPENL FORMS TO THE WORK AREA TO   17800016
*MAINTAIN REENTRABILITY                                                 18000016
         MVC   DCBAR1(DCBOUT-DCBIN),DCBIN                               18200016
         MVC   DCBAR2(OPENINL-DCBOUT),DCBOUT                            18400016
         MVC   DCBDDNAM(8),ISUT1        MOVE INTO DCB THE OUTPUT DDNAME 18600016
         DROP  GOREG                                                    18800016
         USING IHADCB,PTREG                                             19000016
         MVC   DCBDDNAM(8),ISUT2        MOVE INTO DCB THE OUTPUT DDNAME 19200016
         MVC   REENTAR(CLOSEL-OPENINL),OPENINL  MOVE L FORM OF OPEN TO  19400016
*                                          WORK AREA                    19600016
         OPEN  (DCBAR1,(INPUT),DCBAR2,(OUTPUT)),MF=(E,REENTAR)          19800016
         TM    DCBOFLGS,X'10'           WAS OPEN SUCCESSFUL FOR OUTPUT  20000016
         BZ    SETSW                    NO, SET FOR ERROR EXIT          20200016
         LH    WK6,DCBLRECL             PICK UP OUTPUT RECORD LENGTH    20400016
         DROP  PTREG                                                    20600016
         USING IHADCB,GOREG                                             20800016
         TM    DCBOFLGS,X'10'           WAS OPEN SUCCESSFUL FOR INPUT   21000016
         BZ    SETSW                    NO, SET FOR ERROR EXIT          21200016
         TM    ISCOMP+1,X'FF'           CHECK FOR INVALID DCB           21260016
         BC    4,CLOSEOUT               INVALID DCB, CLOSE AND QUIT     21320016
         TM    DCBRECFM,X'01'           CHECK FOR BLOCKED RECORDS       21330016
         BC    1,LOADL                  YES, BLOCKED RECORDS            21340016
         OC    DCBRKP(2),DCBRKP         CHECK FOR RKP=0                 21350016
         BZ    LOADL                    YES, RKP=0                      21360016
         SETL  DCBAR1,BD                SET FOR RETRIEVING DATA PORTION 21370016
LOADL    LH    WK4,DCBLRECL             PICK UP LOGICAL RECORD LENGTH   21380016
         CLC   DCBRKP(2),=H'00'         CHECK FOR RELATIVE KEY          21408016
*                                           POSITION OF ZERO            21416016
          BNE   SETSKIP                  NO,NOT ZERO                    21424016
          SR    WK5,WK5                                                 21432016
         TM    DCBRECFM,X'10'           CHECK FOR BLOCKED RECORDS       21434016
         BC    1,SETSKIP                YES,BLOCKED REOCRDS             21436016
          IC    WK5,DCBKEYLE             PICK UP KEYLENGTH              21440016
          AR    WK4,WK5                  ADD TO PROVIDED LRECL          21448016
SETSKIP   MVI   HEADERC,X'F1'            SET FOR SKIP TO NEW PAGE       21456016
         MVI   HEADERT,C' '             SET HEADER TO BLANKS            21464016
         MVC   HEADERT+1(143),HEADERT                                   21472016
         SR    CONS,CONS                                                21480016
         CH    WK6,=H'11'               CHECK FOR OUTPUT TO BE LESS     21488016
*                                          THAN 11 BYTES                21496016
         BL    SETNONE                  YES, LESS THAN 11 - NO HEADING  21504016
         CH    WK6,=H'80'               CHECK FOR OUTPUT TO BE LESS     21512016
*                                          THAN 80 BYTES                21520016
         BNL   PUTINALL                 NO, NOT LESS THAN EIGHTY        21528016
PAGEINST LR    WK5,WK6                  PICK UP SPECIFIED OUTPUT LENGTH 21536016
         SH    WK5,=H'10'               BACK UP 10 BYTES FROM END OF    21544016
*                                          OUTPUT TO PUT OUT PAGE       21552016
*                                          NUMBER                       21560016
         CH    WK5,=H'135'         LRECL LESS THAN 145 ?         A41801 21562000
         BNH   NORMPROC             YES, CONT NORM. PROCC.       A41801 21564000
         LA    WK5,135              NO, SET PAGE NBR 135 FURTH   A41801 21566000
NORMPROC LA    WK3,HEADERT              PICK UP HEADER ADDRESS   A41801 21568000
         AR    WK3,WK5                  CALCULATE ADDRESS WHERE PAGE    21576016
*                                          NUMBER IS TO BEGIN           21584016
         MVC   0(4,WK3),PAGE            MOVE IN 'PAGE'                  21592016
         LA    WK3,5(0,WK3)             UPDATE POINTER                  21600016
         ST    WK3,PAGEPTR              SAVE POINTER TO PAGE NUMBER     21608016
         ST    CONS,PAGENO              INITIALIZE PAGE NUMBER          21616016
         B     CHEKEXIT                                                 21624016
SETNONE  ST    CONS,PAGEPTR             SET PAGE POINTER TO ZERO TO     21632016
*                                          INDICATE NO HEADING IS TO BE 21640016
*                                          PRINTED                      21648016
         B     CHEKEXIT                                                 21656016
PUTINALL MVC   HEADERT+2(7),PROGNAME    MOVE IN PROGRAM NAME            21664016
         MVC   HEADERT+58(8),TARGET     MOVE IN MONTH OF YEAR           21672016
         MVC   REENTAR(MOVEDATA-READJL),READJL   FOR REENTRABILITY      21680016
         LA    WK3,RECADDR              PICK UP DCB EXIT ADDRESS        21688016
         ST    WK3,QISAM                                                21696016
         MVC   DCBEXLST+1(3),QISAM+1                                    21704016
         LA    WK3,QISAM                POINT TO AREA TO BE USED        21712016
         ST    WK3,RECADDR              SET UP EXIT LIST                21720016
         MVI   RECADDR,X'87'            SET FOR LAST EXIT               21728016
         RDJFCB (DCBAR1),MF=(E,REENTAR)                                 21736016
         XC    DCBEXLST+1(3),DCBEXLST+1                                 21744016
         MVC   HEADERT+12(44),QISAM     MOVE IN DSNAME                  21752016
         B     PAGEINST                                                 21760016
CHEKEXIT CLI   EXITADDR,C' '            CHECK FOR A USER EXIT           21768016
         BE    DOGET                    NO, GO AROUND LOAD              21800016
         LOAD  EPLOC=EXITADDR                                           22000016
         ST    PAREG0,ALIGN             SAVE USER'S ROUTINE ADDRESS     22200016
DOGET    BCTR  WK6,0                    REDUCE LENGTH OF OUTPUT RECORD  22600016
*                                          BY ONE TO ACCOUNT FOR THE    22800016
*                                          ASA BYTE                     23000016
         SPACE 3                                                        23600016
         LA    WK4,1(0,WK4)             ADD 1 BYTE TO WK4      @ZA06559 23650000
         GETMAIN R,LV=(4)               GET BUFFER AREA FOR LOGICAL     23800016
*                                          RECORD OF INPUT DATA SET     24000016
         ST    WK4,XCTLAREA+4           SAVE GOTTEN CORE LENGTH         24100016
         LR    CONS,PAREG1              PICK UP ADDRESS OF BUFFER       24200016
         LR    IRETREG,CONS                                             24400016
         PUT   DCBAR2                   GET BUFFER ADDRESS              24600016
         LR    PTREG,PAREG1        MOVE BUFFER ADDRESS FOR THE GET      24800016
         XC    REENTAR(4),REENTAR       CLEAR RECORD # HOLD AREA        25000016
         BAL   RETREG,PRTHDR            GO TO PRINT HEADER              25100016
GETNEXT  GET   DCBAR1,(2)               GET ISAM RECORD AND MOVE TO     25200016
*                                          WORK AREA                    25400016
GOTO     L     WK5,REENTAR                                              25720016
         A     WK5,=F'1'                UPDATE RECORD NUMBER            25800016
         ST    WK5,REENTAR              SAVE NEW RECORD NUMBER          26000016
         CVD   WK5,DOUBLE                                               26200016
         MVI   0(PTREG),C' '            BLANK PRINT FIELD               26400016
         BCTR  WK6,0                                                    26600016
         EX    WK6,MOVEBLNK                                             26800016
         LA    WK6,1(0,WK6)                                             27000016
         DROP  GOREG                                                    27030016
         LA    WK3,DCBAR1               PICK UP INPUT DCB ADDR          27070016
         USING IHADCB,WK3                                               27140016
         TM    DCBRECFM,X'40'          TEST FOR V-TYPE RECORD      IV0I 27160018
         BZ    FIXRECFM                NO-FIXED RECFM-BRANCH       IV0I 27180018
         LH    WK4,0(CONS)             RECFM=V-GET LENGTH OF THIS  IV0I 27200018
*                                      RECORD FROM DESCRIPTOR WORD IV0I 27220018
         B     FIXAVAR                 CONTINUE                    IV0I 27240018
FIXRECFM LH    WK4,DCBLRECL            RECFM=F - GET LENGTH OF     IV0I 27260018
*                                      OF THIS RECORD FROM THE DCB IV0I 27280018
FIXAVAR  CLC   DCBRKP(2),=H'00'        CHECK FOR RELATIVE KEY      IV0I 27300018
*                                        POSITION OF ZERO               27350016
         BNE   TESTEXIT                 NO, NOT ZERO                    27420016
         TM    DCBRECFM,X'10'           CHECK FOR BLOCKED RECORDS       27440016
         BC    1,TESTEXIT               YES,BLOCKED REOCRDS             27460016
         SR    WK5,WK5                                                  27490016
          IC    WK5,DCBKEYLE             PICK UP KEYLENGTH              27560016
          AR    WK4,WK5                  ADD TO PROVIDED LRECL          27630016
         DROP  WK3                                                      27700016
TESTEXIT CLI   EXITADDR,C' '            CHECK FOR USER EXIT             27800016
         BNE   SETUPEX                  YES SET UP FOR EXIT             28000016
RETEXIT  CLI   LENSW,X'FF'             LRECL LESS THAN 18        A36104 28200021
         BE    MOVEHEAD                YES,BYPASS PRINT REC #    A36104 28250021
         UNPK  13(5,PTREG),DOUBLE+4(4)  CONVERT 5 DIGITS FOR PRINT36104 28300021
         OI    17(PTREG),X'F0'                                          28600016
         MVI   0(PTREG),X'40'           SET FOR A SKIP OF ONE LINE      28800016
         MVC   6(6,PTREG),RECORD        MOVE IN HEADING TEXT            29500016
         PUT   DCBAR2                                                   30200016
         LR    PTREG,PAREG1             SAVE BUFFER POINTER             30400016
         BCTR  GOREG,0                  REDUCE LINE COUNT               30460016
         LTR   GOREG,GOREG              CHECK FOR NEW PAGE              30520016
         BC    7,MOVEHEAD               NO, NO NEW PAGE                 30580016
         BAL   RETREG,PRTHDR            GO TO PRINT HEADER              30640016
MOVEHEAD TM    ISCNTRL,ISSWN            CHECK FOR NO CONVERT            30700016
         BC    1,MOREDATA              NO,PICK UP REGULAR LENGTHS       30800016
         SLL   WK4,1                   DOUBLE NUMBER OF INPUT           31000016
*                                         CHARACTERS                    31200016
MOREDATA CR    WK4,WK6                  WHICH LOGICAL RECORD LENGTH     31400016
*                                          GREATER                      31600016
         BH    USEPRT                   PRINT LENGTH LESS               31800016
         MVI   0(PTREG),C' '       BLANK PRINT FIELD                    32000016
          BCTR WK6,0                                                    32200016
         EX    WK6,MOVEBLNK                                             32400016
          LA    WK6,1(0,WK6)                                            32600016
         LR    OPREG,WK4                USE LENGTH FROM INPUT SIDE      32800016
         SR    WK4,WK6                  SET LENGTH TO ZERO OR NEGATIVE  33000016
         B     TESTCVRT                                                 33200016
USEPRT   LR    OPREG,WK6                USE LENGTH FROM OUTPUT SIDE     33400016
         SR    WK4,WK6                  REDUCE LENGTH OF INPUT LEFT     33600016
TESTCVRT TM    ISCNTRL,ISSWN            CHECK FOR NO CONVERT            33800016
         BC    8,CONVERT                YES GO TO CONVERT               34000016
          BCTR OPREG,0                                                  34100016
          EX    OPREG,MOVEDATA           MOVE IN DATA                   34200016
          LA    OPREG,1(0,OPREG)                                        34300016
         AR    IRETREG,OPREG            UPDATE POINTER TO BUFFER        34400016
PRINTLIN MVI   0(PTREG),X'40'           SET TO PRINT ONE LINE           35800016
NEXTLINE PUT   DCBAR2                   PUT OUT RECORD AND GET NEXT     36000016
*                                          BUFFER ADDRESS               36200016
         LR    PTREG,PAREG1        MOVE BUFFER ADDRESS FOR THE GET      36400016
         BCTR  GOREG,0                  REDUCE LINE COUNT               36500016
         LTR   GOREG,GOREG              CHECK FOR NEW PAGE              36600016
         BC    7,CHEKNEXT               NO, NO NEW PAGE                 36700016
         BAL   RETREG,PRTHDR            PRINT NEW PAGE HEADING          36800016
CHEKNEXT LTR   WK4,WK4                  CHECK FOR ALL DATA MOVED        37000016
         BC    2,MOREDATA               NO, MOVE MORE DATA              37100016
         CLI   ISMESS+1,X'05'           CHECK FOR CLOSE REQUESTED       37260016
         BE    EODADIN                  YES, GO TO CLOSE                37320016
         LR    IRETREG,CONS             RESET BUFFER POINTER            37400016
         B     GETNEXT                                                  37600016
SETUPEX  L     ADDR,ALIGN               PICK UP USER ROUTINE ADDRESS    37800016
         LR    PAREG1,CONS              PASS POINTER TO INPUT BUFFER    38000016
         LR    PAREG0,PTREG             PASS POINTER TO HEADER          38200016
         BALR  RETREG,ADDR              PASS CONTROL TO USER'S ROUTINE  38400016
         LR    CONS,PAREG1              RESTORE BUFFER POINTERS         38600016
         C     ADDR,=F'0'                CHECK FOR ZERO RETURN CODE     38700016
         BE    RETEXIT                   PRINT THIS ONE                 38800016
         C     ADDR,=F'4'                CHECK FOR RETURN CODE 4        38900016
         BE    SETOFF                    PRINT THIS ONE AND CLOSE       39000016
         C     ADDR,=F'8'               CHECK FOR RETURN CODE 8         39100016
         BE    GETNEXT                  DON'T PRINT THIS ONE            39200016
         C     ADDR,=F'12'              CHECK FOR RETURN CODE 12        39300016
         BE    SETOFFA                  DON'T PRINT THIS ONE AND CLOSE  39400016
ILLEGAL   MVI   ISMESS+1,X'06'           SET MESSAGE NUMBER TO 6        40200016
         MVI   ISCOMP+1,X'0C'           SET CONDITION CODE              40400016
EODADIN  MVI   0(PTREG),C' '       MOVE BLANK IN FOR PROPOGATION        40600016
         BCTR   WK6,0              SUBTR. ONE FOR EX STATM.      A41801 40610021
         CLI   LENSW,X'00'         LRECL GREATER THAN 18 ?       A41801 40650021
         BE    NORMALMS                YES,GIVE NORMAL MESSAGE   A36104 40850021
         EX    WK6,MOVEBLNK            BLANK OUT BUFFER          A36104 40860021
         MVC   1(3,PTREG),ENDOUT+3      ONLY 'END' AS MSG        A36104 40870021
         B    BRANCHSW                 GO TO CLOSE RTN           A36104 40880021
NORMALMS EX    WK6,MOVEBLNK            BLANK OUT BUFFER          A36104 40890021
         MVC   1(16,PTREG),ENDOUT       MOVE IN MESSAGE                 40900016
BRANCHSW MVC   REENTAR(READJL-CLOSEL),CLOSEL                            41100016
         LA    WK6,1(WK6)          RESET CORRECT LRECL-1         A41801 41150021
*                                          MAINTAIN REENTRABILITY       41400016
CLOSEOUT CLOSE (DCBAR1,,DCBAR2,LEAVE),MF=(E,REENTAR)                    41600016
         CLI   ISMESS+1,X'07'           CHECK FOR MISSING DD            41660016
         BE    COMEBCK                  YES, BYPASS FREEMAIN            41720016
         CLI   ISMESS+1,X'01'           CHECK FOR DCB ERROR             41740016
         BE    COMEBCK                  YES,A DCB ERROR                 41760016
         FREEPOOL DCBAR1                FREEPOOL INPUT BUFFER    A41745 41770021
         FREEPOOL DCBAR2                FREEPOOL OUTPUT BUFFER   A41745 41780021
*                                                                       41800016
         L     PAREG0,XCTLAREA+4        PICK UP LENGTH FOR FREEMAIN     42000016
         LR    PAREG1,CONS              SET UP POINTER TO AREA          42200016
         FREEMAIN R,LV=(0),A=(1)                                        42400016
*                                                                       42600016
         CLI   EXITADDR,C' '            CHECK FOR USER EXIT             42650016
         BE    COMEBCK                  NO, NO USER EXIT                42700016
         DELETE EPLOC=EXITADDR                                          42750016
COMEBCK  SR    WK6,WK6                  SET UP XCTL AREA                42800016
         ST    WK6,XCTLAREA+4                                           43000016
         MVI   WHICH+6,C' '                                             43200016
         MVI   WHICH+5,C'F'             MOVE INTO XCTLAREA NAME OF NEXT 43400016
*                                          MODULE-IEBISF                43600016
         LR    PAREG1,WORKAREA          SAVE WORKAREA POINTER           43800016
         L     SAVREG,4(0,SAVREG)       POP UP SAVE AREA                44000016
         L     RETREG,12(0,SAVREG)      RESTORE REGISTER FOURTEEN       44200016
         XCTL  (2,12),MF=(E,(1)),SF=(E,XCTLAREA)                        44400016
*THIS SECTION CHECKS FOR THE LRECL BEING 121,133,145 AND THE BLKSIZE    44600016
*BEING A MULTIPLE OF THE LRECL                                          44800016
DCBEXIT  SR    WK4,WK4                                                  45000016
         USING IHADCB,PTREG                                             45200016
         LA    PTREG,DCBAR2                                             45400016
CHECKLR  OC    DCBLRECL(2),DCBLRECL     CHECK FOR  RECORD SIZE   A41801 46400021
         BZ    CHECKBLK                 NO  RECORD SIZE PROVIDED A41801 46600021
         OC    DCBBLKSI(2),DCBBLKSI     CHECK FOR  BLOCK SIZE    A41801 47000021
         BNZ   CHECK121                 BLOCK SIZE PROVIDED      A41801 47010021
         MVC   DCBBLKSI(2),DCBLRECL     SET UP BLOCKSIZE         A41801 47020021
         B     CHECK121             CHECK FOR VALID LRECL/BLKSI  A41801 47030021
CHECKBLK OC    DCBBLKSI(2),DCBBLKSI     CHECK FOR  BLOCK SIZE    A41801 47050021
         BZ    SETDFLT                  NO  BLOCK SIZE PROVIDED  A41801 47200021
         MVC   DCBLRECL(2),DCBBLKSI     SET UP LRECL             A41801 47400021
         B     CHECK121             CHECK FOR VALID LRECL/BLKSI  A41801 47450021
SETDFLT  MVI   DCBBLKSI+1,X'79'     TAKE DEF. VALUE OF 121       A41801 47500021
         MVI   DCBLRECL+1,X'79'     TAKE DEF. VALUE OF 121       A41801 47550021
CHECK121 LH    WK5,DCBBLKSI             PICK UP BLOCK SIZE              47600016
         LH    WK6,DCBLRECL             PICK UP LOGICAL RECORD LENGTH   47800016
         C     WK6,=F'255'         SPECIF LRECL GR. THAN 255 ?   A41801 47810021
         BH    DCBERR              YES, PRINT ERROR              A41801 47820021
         C     WK6,=F'04'          SPECIF LRECL SM. THAN 4   ?   A41801 47830021
         BL    DCBERR              YES, PRINT ERROR              A41801 47840021
         C     WK6,=F'18'              LRECL LESS THEN 18        A36104 47850021
         BNL   CHECK                   NO BRANCH                 A36104 47900021
         MVI   LENSW,X'FF'             SET SWITCH FOR SHORT MSG  A36104 47950021
CHECK    DR    WK4,WK6                  DIVIDE BLKSIZE BY LRECL         48000016
         LTR   WK4,WK4                  CHECK FOR NO REMAINDER          48200016
         BNE   DCBERR                   NO, GO SET FOR DCB ERROR        48400016
         RETURN                                                         48600016
DCBERR   MVI   ISMESS+1,X'01'          SET MESSAGE NUMBER TO 1          48800016
         MVI   ISCOMP+1,X'08'           SET COMPLETION CODE TO 8        49000016
         MVC   DCBBLKSI(2),DCBLRECL   TO PREVENT OPEN FROM ABEND A41801 49050021
         RETURN                                                         49200016
*THIS SECTION SETS THE MESSAGE NUMBER AND RETURN CODE TO INDICATE THAT  49400016
*A REQUIRED DD STATEMENT IS MISSING                                     49600016
SETSW    MVI   ISMESS+1,X'07'          SET MESSAGE NUMBER TO 7          49800016
         MVI   ISCOMP+1,X'10'           SET CONDITION CONDE             50000016
         B     BRANCHSW                                                 50900016
*THIS SYNAD ROUTINE USES THE SVC 68 AND ITS ASSOCIATED MACROS FOR       51800016
*DETERMINING THE ERROR CONDITION                                        52000016
SYNADIN  SYNADAF ACSMETH=QISAM,PARM1=DCBAR1,PARM2=(0)                   52200016
MOVEMESS MVC   MESSAGE+8(79),49(PAREG1) MOVE IN PRINTABLE DATA FROM     52400016
*                                          BUFFER FOR MESSAGE           52600016
         MVI   ISMESS+1,X'02'          SET FOR SYNAD ERROR MESSAGE      52800016
*                                         NUMBER =2                     53000016
         MVI   ISCOMP+1,X'08'          SET COMPLETION CODE TO 8         53200016
         SYNADRLS                                                       53400016
         B     EODADIN                                                  53600016
SYNADOUT SYNADAF ACSMETH=QSAM,PARM1=DCBAR2,PARM2=(0)                    53800016
         B     MOVEMESS                                                 54000016
*MARK THIS RECORD TO BE PRINTED AND THE DATA SET TO BE CLOSED           54200016
SETOFF   MVI   ISCOMP+1,X'04'           SET COMPLETION CODE TO 4        54400016
         MVI   ISMESS+1,X'05'          SET MESSAGE NUMBER TO 5          54600016
         B     RETEXIT                                                  54800016
SETOFFA  MVI   ISCOMP+1,X'04'           SET COMPLETION CODE TO 4        55000016
         MVI   ISMESS+1,X'05'     SET MESSAGE NUMBER TO FIVE            55200016
         B     EODADIN                                                  55400016
         EJECT                                                          55460016
*   CONVERSION ROUTINE                                                  55520016
CONVERT  LR    WK3,PTREG     SET UP BUFFER WORKING POINTER              55600016
         LA    WK3,1(0,WK3)                                             55800016
         LR    PAREG1,WK3               SET UP POINTER TO BUFFER END    56000016
*                               MINUS 12                                56200016
         AR    PAREG1,WK6    CALCULATE POINTER TO BUFFER END            56400016
         ST    GOREG,REENTAR+4                                          56800016
CHKN     C     OPREG,=F'1'              CHECK FOR ONE OR NONE LEFT      57100016
         BNH   BLANKOUT                                                 57400016
         UNPK  REENTAR+20(3),0(2,IRETREG)                               57700016
         TR    REENTAR+20(2),TABLE-240  CONVERT TWO BYTES               58000016
         MVC   0(2,WK3),REENTAR+20      MOVE TO OUT BUFFER              58300016
         S     OPREG,=F'2'              TWO LESS TO CONVERT             58600016
         LA    WK3,2(0,WK3)             UPDATE OUTPUT BUFFER POINTER    58900016
         LA    IRETREG,1(0,IRETREG)     UPDATE INPUT POINTER            59200016
         B     CHKN                     GO TO PICK UP MORE              59500016
BLANKOUT AR    WK4,OPREG                INCREMENT TO HANDLE THE ODD     59800016
*                                          BYTE                         60100016
CHECKEND CR    WK3,PAREG1               CHECK FOR END OF OUTPUT         60400016
         BNL   FIN1RECA                 YES, END OF OUTPUT              60700016
         MVI   0(WK3),C' '              BLANK REMAINING OUTPUT          61000016
         LA    WK3,1(0,WK3)             UPDATE OUTPUT POINTER           61300016
         B     CHECKEND                                                 61600016
FIN1RECA L     GOREG,REENTAR+4          RESET LINE COUNT                61900016
         B     PRINTLIN                                                 62600016
         EJECT                                                          63400016
PRTHDR   L     GOREG,PAGENO                                             63410016
         A     GOREG,=F'1'              UPDATE PAGE NUMBER              63420016
         ST    GOREG,PAGENO             SAVE UPDATED PAGE NUMBER        63425016
         CVD   GOREG,QISAM              CONVERT PAGE NUMBER FOR         63430016
         UNPK  QISAM+8(3),QISAM+6(2)       PRINTING                     63440016
         OI    QISAM+10,X'F0'                                           63450016
         LR    GOREG,WK6           SAVE LRECL-1 LENGTH           A41801 63452021
         CH    WK6,=H'10'          LRECL SMALLER THAN 11 ?       A41801 63454021
         BL    NORMOV              YES, PRINT NO PAGE AND P.NBR  A41801 63456021
         L     GOREG,PAGEPTR            PICK UP ADDRESS OF POSITION IN  63460016
*                                          HEADING FOR PGGE NUMBER      63470016
         MVC   0(3,GOREG),QISAM+8       MOVE IN PAGE NUMBER             63480016
         LR    GOREG,WK6           SAVE LRECL-1 LENGTH           A41801 63480421
         CH    WK6,=H'144'         LRECL LARGER THAN 145 ?       A41801 63482021
         BNH   NORMOV              NO, NORMAL MOVE               A41801 63484021
         BCTR  WK6,0               SUBTR. ONE FOR EX STATEM.     A41801 63484121
         EX    WK6,MOVEBLNK        YES, BLNK OUTP. BUFFER        A41801 63484421
         LA    WK6,144             SET MAXIM. HEADER LENGTH      A41801 63484821
NORMOV   EX    WK6,MOVEIN          MOVE IN HEADER                A41801 63485021
         LR    WK6,GOREG           RESTORE LRECL-1 VALUE         A41801 63487021
         LR    GOREG,RETREG             SAVE RETURN POINTER             63492016
         PUT   DCBAR2                   PUT OUT HEADER                  63500016
         LR    PTREG,PAREG1             SAVE BUFFER POINTER             63510016
         MVI   0(PTREG),X'40'           SET TO PRINT A LINE             63520016
         LR    RETREG,GOREG            RESTORE RETURN POINTER           63525016
         LA    GOREG,59                 SET NEW LINE COUNT              63530016
         BR    RETREG                                                   63535016
         EJECT                                                          63540016
SYSUT1   DC    CL8'SYSUT1  '                                            63600016
SYSUT2   DC    CL8'SYSUT2  '                                            63800016
INPUT    DC    CL8'INPUT   '                                            64000016
OUTPUT   DC    CL8'OUTPUT  '                                            64200016
RECORD   DC    CL6'RECORD'                                              64400016
PAGE     DC    CL4'PAGE'                                                64460016
PROGNAME DC    CL7'IEBISAM'                                             64520016
ENDOUT   DC    CL16'***END OF OUTPUT'                                   64560016
         DS    0F                                                       64600016
DCBEXITA DC    X'85'                    DCBEXIT LIST                    64800016
         DC    AL3(DCBEXIT)                                             65000016
DCBIN    DCB   DSORG=IS,MACRF=GM,DDNAME=SYSUT1,SYNAD=SYNADIN,          *65200016
               EODAD=EODADIN                                            65400016
DCBOUT   DCB   DSORG=PS,MACRF=PL,DDNAME=SYSUT2,SYNAD=SYNADOUT,         *65600016
               EXLST=DCBEXITA,RECFM=FBA                                 65800016
OPENINL  OPEN  (,(INPUT),,(OUTPUT)),MF=L                                66000016
CLOSEL   CLOSE (,,,LEAVE),MF=L                                          66200016
READJL   RDJFCB (,),MF=L                                                66300016
MOVEDATA MVC   1(0,PTREG),0(IRETREG)                                    66400016
MOVEBLNK MVC   1(0,PTREG),0(PTREG)                                      66600016
MVBLANKS MVC    1(1,WK3),0(WK3)                                         66800016
LENSW    DC    X'00'                                             A36104 66850021
TRANSLAT TR    1(1,PTREG),TABLE-240                                     67000016
MOVEIN   MVC   0(0,PTREG),HEADERC                                       67100016
TABLE    DC    C'0123456789ABCDEF'      TRANSLATE TABLE                 67200016
         LTORG                                                          67400016
         EJECT                                                          67600016
IEBWORK  DSECT                                                          67800016
SAVE1    DS    1F                                                       68000016
SAVE1BK  DS    1F                                                       68200016
SAVE1FD  DS    1F                                                       68400016
         DS    15F                                                      68600016
SAVE2    DS    1F                                                       68800016
SAVE2BK  DS    1F                                                       69000016
SAVE2FD  DS    1F                                                       69200016
         DS    15F                                                      69400016
SAVE3    DS    1F                                                       69600016
SAVE3BK  DS    1F                                                       69800016
SAVE3FD  DS    1F                                                       70000016
         DS    15F                                                      70200016
ISINVOK  DS    F                        ADDRESS OF PARAMETER LIST AT    70400016
*                                          INVOCATION                   70600016
ISPRINT  DS    2F                       DDNAME FOR SYSPRINT             70800016
ISUT1    DS    2F                       DDNAME FOR SYSUT1               71000016
ISUT2    DS    2F                       DDNAME FOR SYSUT2               71200016
ISCOMP   DS    H                        COMPLETION CODE                 71400016
ISMESS   DS    H                        MESSAGE NUMBER                  71600016
ISPAGE   DS    H                        PAGE NUMBER FOR SYSPRINT        71800016
ISCNTRL  DS    CL1                      CONTROL BYTE                    72000016
* MASKS FOR TESTING CONTROL BYTE - ISCONTRL                             72200016
ISSWC    EQU   X'80'                    COPY                            72400016
ISSWU    EQU   X'40'                    UNLOAD                          72600016
ISSWL    EQU   X'20'                    LOAD                            72800016
ISSWP    EQU   X'10'                    PRINT                           73000016
ISSWN    EQU   X'08'                    NO CONVERT REQUESTED            73200016
ISSWPI   EQU   X'04'                    PRINT INDEX                     73400016
ISSWPP   EQU   X'02'                    PRINT PRIME                     73600016
ISSWPO   EQU   X'01'                    PRINT OVERFLOW                  73800016
ALLMASK  EQU   X'07'                                               000F 73900016
ISSWITCH DS    CL1                      EXTRANEOUS SWITCHES             74000016
FIRSTTM  EQU   X'80'                    FIRST TIME SWITCH               74200016
*                                                                       74400016
XCTLAREA DS    2F                                                       74600016
WHICH    DS    2F                                                       74800016
ALIGN    DS    1F                                                       75000016
DOUBLE   DS    1D                                                       75200016
EXITADDR DS    2F                                                       75400016
REENTAR  DS    9F                                                       75600016
DCBAR1   DS    64F                                                      75800016
DCBAR2   DS    64F                                                      76000016
MESSAGER DS    CL1                                                      76200016
MESSAGE  DS    CL120                                                    76400016
RECADDR  DS    1F                                                  000F 76500016
         DS    0D                                                       76550016
QISAM    DS    CL250                    UNLOADED DCB WORK AREA          76600016
HEADERC  DS    CL1                                                      76620016
HEADERT  DS    CL144                    HEADER AREA                     76640016
TARGET   DS    2F                       DATE HOLD AREA                  76660016
PAGENO   DS    1F                       HOLD PAGE NUMBER FOR HEADING    76680016
PAGEPTR  DS    1F                       HOLD POINTER TO WHERE PAGE      76700016
*                                          NUMBER IS TO BE PLACED       76720016
         DCBD  DSORG=(PS,IS)                                            76800016
         END                                                            77000016
./  ADD  SSI=71880046,NAME=IEBISSI
 TITLE 'IEBISSI-IEBISAM UTILITY PROGRAM-LOAD SUBROUTINE'                00300016
*STATUS: CHANGE LEVEL                                                 * 00600016
*FUNCTION/OPERATION: GIVEN A LIMIT(MAXIMUM NUMBER OF CHARACTERS OF    * 00900016
*   CHARACTERS THAT SHOULD BE TRANSMITTED,AND THE ADDRESS OF THE AREA * 01200016
*   TO WHICH THESE CHARACTERS ARE TO BE TRANSMITTED, THIS SUBROUTINE  * 01500016
*   PROCESSES 80 BYTE CARD IMAGES OF FORMAT DESCRIBED BELOW. A POINTER* 01800016
*   TO THE CURRENT INPUT AREA ADDRESS AND THE NUMBER OF BYTES REMAIN- * 02100016
*   ING TO BE PROCESSED ON THE CARD IMAGE ARE MAINTAINED. A CHECK FOR * 02400016
*   SEQUENTIAL INPUT IS MADE EACH TIME A CARD IMAGE IS OBTAINED.      * 02700016
*ENTRY POINTS: IEBISSI - TO GET A RECORD LENGRH AND ADDRESS OF THE    * 03000016
*   RECORD.   BAL  14,IEHISSI. DATA IS PASSED BY LOCATION.            * 03300016
*INPUT:ALL ZEROS IN REG 0 ON FIRST ENTRY.OTHERWISE,A LIMIT AND ADDRESS* 03600016
*       CARDS OR TAPE,80 BYTE CARD IMAGES WITH FOLLOWING FORMAT       * 03900016
*   SEQUENCE NUMBER: A TWO BYTE NUMBER WHICH IS ZERO FOR THE FIRST    * 04200016
*   CARD IMAGE AND ONE GREATER FOR EACH SUCCEEDING CARD IMAGE.        * 04500016
*   LENGTH: A TWO  BYTE  FIELD SPECIFYING THE NUMBER OF BYTES OF IN-  * 04800016
*   FORMATION BETWEEN THIS LENGTH FIELD AND THE NEXT. THIS FIELD IN-  * 05100016
*   DICATES HOW THE FOLLOWING INFORMATION IS SEGMENTED ON SEQUENTIAL  * 05400016
*   CARD IMAGES(IF IT IS SEGMENTED).                                  * 05700016
*   INFORMATION: THIS FIELD CONTAINS THE INFORMATION FROM A GIVEN RE  * 06000016
*   CORD,IT MAY BE SEGMENTED ON SEQUENTIAL CARD IMAGES.               * 06300016
*   END OF INPUT : A 0,1 , OR  2 BYTE FIELD OF ZERO CONTAINED ONLY ON * 06600016
*   THE LAST CARD IMAGE TO DESIGNATE  END OF  INPUT                   * 06900016
*                                                                     * 07200016
*   REGISTER 13 MUST CONTAIN  THE ADDRESS OF THE CALLING PROGRAM'S    * 07500016
*   SAVE AREA,REGISTER 14 MUST CONTAIN THE RETURN ADDRESS IN THE      * 07800016
*   CALLING PROGRAM,AND REGISTER 15 MUST CONTAIN THE ADDRESS OF THIS  * 08100016
*   MODULE                                                            * 08400016
*OUTPUT: A VARIABLE LENGTH RECORD, THE LENGTH OF WHICH DOES NOT EXCEED* 08700016
*   THE VALUE GIVEN THIS ROUTINE IN REGISTER ZERO UPON ENTRY.         * 09000016
*EXTERNAL ROUTINES: IEBISL - LOAD RTN. GET LIMIT AND ADDRESS TO WHICH * 09300016
*   INFORMATION IS TO BE TRANSMITTED.                                 * 09600016
*EXITS-NORMAL: TO CALLING PROGRAM WITH A RETURN CODE OF 0 IN REGISTER * 09900016
*   15,THE ACTUAL LENGTH OF THE INFORMATION TRANSMITTED, AND THE      * 10200016
*   ADDRESS OF THIS INFORMATION. CONTENTS OF OTHER REGISTERS UNCHANGED* 10500016
*     -ERROR: TO CALLING PROGRAM WITH ONE OF THE FOLLOWING RETURN CODE* 10800016
*   S AND THE CONTENTS OF THE OTHER REGISTERS UNCHANGED,DATASET CLOSED* 11100016
*   RETURN CODES:                                                     * 11400016
*   FOUR(4) = AN EXIT TO THE INPUT DCB SYNAD ROUTINE WAS TAKEN.       * 11700016
*   EIGHT(8)= END OF INPUT DATA.                                      * 12000016
*   TWELVE(12)= NUMBER OF CHARACTERS TO BE TRANSMITTED EXCEEDS LIMIT. * 12300016
*   SIXTEEN(16)= INPUT OUT OF SEQUENCE.                               * 12600016
*   TWENTY(20)=  OPEN UNSUCCESSFUL FOR INPUT DATASET                  * 12900016
*TABLES/WORKAREAS:                                                    * 13200016
*   SPACE = NUMBER OF BYTES TO BE PROCESSED AREA                      * 13500016
*   CSQ = NUMBER USED TO CHECK SEQUENTIAL INPUT WORK AND SAVE AREA    * 13800016
*   HOLD = WORK AREA FOR ACTUAL LENGTH OF INFORMATION TRANSMITTED     * 14100016
*   SAVARA =  SAVE AREA FOR REGISTERS                                 * 14400016
*ATTRIBUTES\ REENTRANT                                             000G 14700016
*NOTES:  BASE REGISTER        BASREG                                  * 15000016
*        SAVE REGISTER        SAVREG = 13                             * 15300016
*        PARAMETER REGISTERS  PARM0 =0                                * 15600016
*                             PARM1 =1                                * 15900016
*        RETURN CODE REGISTER      RCRG=15                            * 16200016
*        RETURN REGISTER           NSIRG                              * 16500016
*        WORK REGISTERS            WK2            WK6                 * 16800016
*                                  WK3            WK7                 * 17100016
*        ADDRESSING REGISTERS      INPT           TRANS               * 17400016
*  REGISTER ASSIGNMENTS                                                 17700016
PARM00   EQU   0        PARAMETER*LIMIT REGISTER                        18000016
PARM1    EQU   1         REGISTERS*ADDRESS OF TRANSMITTED INFORMATION   18300016
WK2      EQU   2                   WORK REGISTER                        18600016
WK3      EQU   3                   BYTES TO BE PROCESSED WORK REGISTER  18900016
PARM0    EQU   4                                                        19200016
NSIRG    EQU   5                   RETURN REGISTER FOR PROC SECTION     19500016
WK6    EQU   6                                                          19800016
WK7      EQU   7                   WORK REGISTER FOR RECORD LENGTH      20100016
INPT     EQU   8                   INPUT ADDRESS REGISTER               20400016
TRANS    EQU   9                   OUTPUT ADDRESS REGISTER              20700016
BASREG   EQU   10                  BASE REGISTER                        21000016
WORKAREA EQU   11                       WORKAREA REGISTER          000G 21300016
SAVREG   EQU   13                 SAVE RGISTER                          21600016
RCRG     EQU   15                  RETURN CODE REGISTER                 21900016
IEBISSI  CSECT                                                          22200016
*0181480000                                                        7060 23000017
*                                                                A31442 23400020
*A762100-765000                                                  A41745 23450021
*A399300-401700,585100-587100,787000                             A45167 23550021
*D387000,579000                                                  A45167 23650021
*C258000                                                         A45167 23750021
*A390500-392000                                                  A48756 23800021
*C399300                                                         A48756 23850021
*A742500                                                                23870021
*A STATEMENTS FOR FIX 01165 ARE REPLACED BY STMNTS FOR FIX 01167OY01165 23877016
*A586600-586660                                                 OY01167 23884016
*D586600                                                        OY01167 23891016
* WITH RELEASE 16 THE ENTIRE MODULE WAS REPLACED                   000G 23900016
*  WITH RELEASE 16 THIS MODULE WAS MADE REENTRANT BY USING A       000G 24100016
*A DSECT CALLED IEBWORK WHICH WAS DESIGNED AS A COMMON WORKAREA.   000G 24300016
*  THIS SECTION PERFORMS THE INITIALIZATION NECESSARY FOR EACH ENTRY  * 24600016
         SAVE  (14,12),T,SSI-66-V1           SAVE REGISTERS             24900016
         USING IEBISSI,BASREG                ESTABLISH BASE REGISTER    25200016
         LR    BASREG,RCRG                   ESTABLISH BASE REGISTER    25500016
         LTR   PARM0,PARM00        SECOND ENTRY ?                A45167 25800021
         BNE   SKIP                    NO, BRANCH                  000G 26100016
         LR    WORKAREA,PARM1           PICK UP WORKAREA POINTER   000G 26400016
         USING IEBWORK,WORKAREA                                         26700016
SKIP     ST    SAVREG,SAVE2BK           SET BACK CHAIN POINTER     000G 27000016
         LA    SAVREG,SAVE2             UPDATE TO NEW SAVE AREA    000G 27300016
         LA    WK2,SAVE3                SET UP FORWARD CHAIN POINTR000G 27600016
         ST    WK2,SAVE2FD                 TO NEXT SAVE AREA       000G 27900016
         LTR   PARM00,PARM00                IS THIS INITIAL ENTRY       28200016
         BNE   COMP                         NO,BRANCH                   28500016
         SPACE                                                          28800016
*                                                                     * 29100016
*  THIS SECTION LOADS THE ADDRESS OF THE IEBISR COMMON AREA, MOVES THE* 29400016
*  DDNAME FROM ISUT1 FIELD OF COMMON AREA TO THE INPUT  DCB,OPENS THE * 29700016
*  INPUT  DATASET, SAVES THE APPROPIATE POINTERS ANS SETS RETURN CODE * 30000016
*                                                                     * 30300016
         MVC   DCBAR1(LABEL-INDCB),INDCB                           000G 30600016
         USING IHADCB,WK2                                               30900016
         LA    WK2,DCBAR1                                          000G 31200016
         MVI   REENTAR+33,X'00'                                         31500016
         MVC   DCBDDNAM(8),ISUT1        MOVE DDNAME FROM ISUT1     000G 31800016
         MVC   REENTAR(CLOSEL-OPENL),OPENL   MOVE L FORM OF OPEN   000G 32100016
*                                               TO WORKAREA        000G 32400016
         OPEN  (DCBAR1,(INPUT)),MF=(E,REENTAR)  OPEN INPUT DATA SET000G 32700016
         TM    DCBOFLGS,X'10'                WAS OPEN SUCCESSFUL        33000016
         BZ    NOTOK                         NO,BRANCH                  33300016
         CLI   REENTAR+33,X'00'         VALID DCB FIELDS           000G 33600016
         BNE   INVALD                        NO, BRANCH                 33900016
         XC    EXITADDR+2(2),EXITADDR+2 INITIALIZE COMPARE NUMBER  000G 34200016
         BAL   NSIRG,PROC                    GET A RECORD               34500016
         LA    WK3,78                        NUMBER OF BYTES TO BE PRO- 34800016
         STH   WK3,EXITADDR                  CESSED IS 78          000G 35100016
         ST    INPT,ALIGN               SAVE INPUT POINTER         000G 35400016
         LA    RCRG,0                        SET RETURN CODE OF ZERO    35700016
         L     SAVREG,4(SAVREG)              POP UP SAVE AREA           36000016
         L     14,12(SAVREG)                 RESTOR REGISTER FOURTEEN   36300016
         SR    PARM00,PARM00                 SET REGISTER ZERO TO ZERO  36600016
         RETURN (1,12),T,RC=(15)             RETURN TO CALLING PROGRAM  36900016
         EJECT                                                          37200016
*  THIS SECTION PERFORMS ADDITIONAL INITIALIZATION NECESSARY FOR EACH * 37500016
*  SECONDARY ENTRY;IT DETERMINES IF THE ENTIRE CARD IMAGE HAS BEEN    * 37800016
*  PROCESSED.                                                         * 38100016
COMP     LR    TRANS,PARM1                   SAVE OUTPUT AREA ADDRESS   38400016
         L     INPT,ALIGN               RESTORE INPUT POINTER      000G 39000016
         CLI   DOUBLE+7,X'20'     COULD SYSUT2 BE OPENED ?       A48756 39050021
         BE    NOTOK              NO, CLOSE UT1 AND UT2          A48756 39100021
         CLI   DOUBLE+6,X'01'     SYSUT2 DCB PARAM ERROR ?       A48756 39150021
         BE    INVALD             YES, CLOSE UT1 AND UT2         A48756 39200021
         CLC   EXITADDR(2),ZERO         ALL CARD IMAGES PROCESSED  000G 39300016
         BNE   COMP1                         NO,BRANCH TO COMPLETE      39600016
         BAL   NSIRG,PROC                    ELSE, GET ANOTHER RECORD   39900016
         TM    ISSWITCH,X'FF'      SYSUT2 OPEN ?                 A48756 39930021
         BNO   NOTOPEN             NO, SKIP PUT                  A45167 39960021
         MVI   ISSWITCH,X'0F'      YES,PREVENT PUT NEXT TIMES    A45167 39990021
         TM    DCBAR2+DCBRECFM-IHADCB,X'40'  RECFM VAR OR UND ?  A45167 40020021
         BNO   *+10                NO, SKIP LRECL UPDATE         A45167 40050021
         MVC   DCBAR2+DCBLRECL-IHADCB(2),0(INPT) GET LRECL       A45167 40080021
         PUT   DCBAR2              PUT FOR OBTAINING POINTER     A45167 40110021
         LR    TRANS,PARM1         SAVE UPDATED POINTER          A45167 40140021
NOTOPEN  EQU   *                                                 A45167 40170021
         MVC   EXITADDR+4(2),0(INPT)                               000G 40200016
         LH    WK7,EXITADDR+4           LOAD ACTUAL LENGTH         000G 40500016
         LA    WK3,76                        BYTES TO BE PROCESSED = 76 40800016
         LA    INPT,2(INPT)                  STEP INPUT POINTER BY TWO  41100016
         B     MAX                           BRANCH TO CHECK LIMIT      41400016
         SPACE                                                          41700016
*  THIS SECTION DETERMINES IF THE NUMBER OF BYTES TO BE PROCESSED IS  * 42000016
*  EQUAL TO 1,OR IS GREATER THAN OR EQUAL TO 2.IF THE LATTER IS TRUE  * 42300016
*  THE 2 BYTE FIELD IS PROCESSED IF IT DOESN'T CONTAIN ZEROS.         * 42600016
COMP1    CLC   EXITADDR(2),TWO          ARE 2 OR MORE BYTES LEFT   000G 42900016
         BL    LAST                          NO,BRANCH                  43200016
         CLC   0(2,INPT),ZERO                IS THIS END OF INPUT       43500016
         BE    FINI                          YES,BRANCH                 43800016
         MVC   EXITADDR+4(2),0(INPT)                               000G 44100016
         LH    WK7,EXITADDR+4           SAVE LENGTH                000G 44400016
         LH    WK3,EXITADDR             SUBTRACT TWO FROM NUMBER   000G 44700016
         LA    INPT,2(INPT)                  STEP INPUT POINTER BY TWO  45000016
         SH    WK3,TWO                        OF BYTES TO BE PROCESSED  45300016
         LTR   WK3,WK3                       MORE BYTES TO BE PROCESSED 45600016
         BNE   MAX                          YES,BRANCH                  45900016
         BAL   NSIRG,PROC                    GET ANOTHER RECORD         46200016
         LA    WK3,78                        BYTES TO BE PROCESSED = 78 46500016
         B     MAX                           BRANCH TO CHECK LIMIT      46800016
         SPACE                                                          47100016
*  THIS SECTION PROCESSES THE LAST BYTE OF THE CARD IMAGE AS DETER-   * 47400016
*  MINED ABOVE IF IT IS NON-ZERO                                      * 47700016
LAST     SR    WK7,WK7            CLEAR REG BEFORE INSERTING CHAR  7060 47900017
         IC    WK7,0(INPT)        LOAD FIRST BYTE OF LENGTH        7060 48100017
         SLL   WK7,8                                                    48300016
         BAL   NSIRG,PROC                    GET NEXT RECORD            48600016
         IC    WK7,0(0,INPT)                 LOAD SECOND BYTE OF LENGTH 48900016
         STH   WK7,EXITADDR+4           SAVE ACTUAL LENGTH         000G 49200016
         LA    WK3,77                        BYTES TO BE PROCESSED = 77 49500016
         LA    INPT,1(INPT)                  STEP INPUT PTR BY 1        49800016
*  THIS SECTION DETERMINES WHETHER THE LENGTH OF THE RECORD TO BE     * 50100016
*  TRANSMITTED EXCEEDS MAXIMUM NUMBER OF CHARACTERS TO BE TRANSMITTED * 50400016
MAX      STH   WK3,EXITADDR                                        000G 50700016
         CR    PARM0,WK7                     LENGTH EXCEED LIMIT        51000016
         BL    EXCEED                        YES,BRANCH                 51300016
*  THIS SECTION DETERMINES IF THE ENTIRE RECORD IS CONTAINED ON THIS  * 51600016
*  CARD IMAGE. IF NOT,THE CHARACTERS CONTAINED ARE TRANSMITTED.       * 51900016
CHECK    CR    WK3,WK7                       ENTIRE RECORD PRESENT      52200016
         BNL   ENUF                          YES,BRANCH                 52500016
         BCTR  WK3,0                         MOVE EXACT NUMBER OF BYTES 52800016
         EX    WK3,MOVE                       LEFT FOR OUTPUT           53100016
         AH    TRANS,EXITADDR           INCREMENT OUTPUT POINTER   000G 53400016
         SH    WK7,EXITADDR             DECREMENT RECORD LENGTH    000G 53700016
         BAL   NSIRG,PROC                    GET ANOTHER RECORD         54000016
         LA    WK3,78                        BYTES TO BE PROCESSED = 78 54300016
         STH   WK3,EXITADDR                                        000G 54600016
         B     CHECK                                                    54900016
         SPACE                                                          55200016
*  THIS SECTION TRANSMITS AN ENTIRE RECORD FOR OUTPUT AND MODIFIES THE* 55500016
*  APPROPRIATE POINTERS AND LENGTH SPECIFIER                          * 55800016
ENUF     BCTR  WK7,0                                                    56100016
         EX    WK7,MOVE                      MOVE CHARACTERS FOR OUTPUT 56400016
         LA    WK7,1(WK7)                                               56700016
         SR    WK3,WK7                      DECREMENT BYTES LEFT BY     57000016
         STH   WK3,EXITADDR                  NUMBER MOVED          000G 57300016
         AR    INPT,WK7                     STEP INPUT POINTER          57600016
         ST    INPT,ALIGN               SAVE INPUT POINTER              58200016
         LA    RCRG,0                        SET RETURN CODE OF ZERO    58500016
         CLI   ISSWITCH,X'0F'      SYSUT2 DCB OPEN ?             A45167 58510021
         BNE   NOPUT               NO, DO NOT PUT                A45167 58520021
         CLC   EXITADDR(2),ONE     ONE BYTE LEFT ON LAST CARD ?  A45167 58530021
         BH    NOINPUT             NO, MORE, STORE PTR AND PUT   A45167 58540021
         BE    PARTINPT            YES, ONE BYTE LEFT            A45167 58550021
         BAL   NSIRG,PROC          NO BYTE LEFT, GET ANOTH RCRD         58560021
         LA    WK3,78              LOAD NBR OF BYTES TO PROCESS  A45167 58570021
         B     ENDINPUT            PUT A RECORD                  A45167 58580021
PARTINPT IC    WK3,0(INPT)         SAVE LAST BYTE                A45167 58590021
         BAL   NSIRG,PROC          GET ANOTHER RECORD            A45167 58600021
         BCTR  INPT,0              RESET PTR ONE BACK            A45167 58610021
         STC   WK3,0(INPT)         STORE SAVED BYTE              A45167 58620021
         LA    WK3,79              LOAD NBR OF BYTES TO PROCESS  A45167 58630021
ENDINPUT STH   WK3,EXITADDR        SAVE NBR OF BYTES TO PROCESS  A45167 58640021
         ST    INPT,ALIGN          SAVE PTR TO INPUT DATA        A45167 58650021
NOINPUT  CLC   0(2,INPT),ZERO     END OF INPUT ?                OY01167 58660016
         BE    FINI               YES, STOP PROCESSING          OY01167 58663016
         TM    DCBAR2+DCBRECFM-IHADCB,X'40'  RECFM VARIABLE ?   OY01167 58666016
         BNO   *+10                NO, SKIP LRECL UPDATE         A45167 58670021
         MVC   DCBAR2+DCBLRECL-IHADCB(2),0(INPT) GET LRECL       A45167 58680021
         PUT   DCBAR2              PUT FOR OBTAINING POINTER     A45167 58690021
         B     COMP                PROCESS NEXT LOGICAL RECORD   A45167 58700021
NOPUT    EQU   *                                                 A45167 58710021
         L     SAVREG,4(SAVREG)              POP UP SAVE AREA           58800016
         L     14,12(0,SAVREG)              RESTORE REGISTER FOURTEEN   59100016
         RETURN (1,12),T,RC=(15)            RETURN TO CALLING PROGRAM   59400016
*  THIS SECTION SETS THE APPROPRIATE RETURN CODES IN REGISTER 15, AND * 59700016
*  BRANCHES TO CLOSE THE DATASET AND RETURN                           * 60000016
NOTOK    LA    RCRG,X'20'                    SET RETURN CODE OF 20;     60300016
         B     OUT                            OPEN UNSUCCESSFUL         60600016
EXCEED   LA    RCRG,X'12'                    SET RETURN CODE OF 12;RE-  60900016
         B     OUT                            CORD LENGTH EXCEEDS LIMIT 61200016
FINI     LA    RCRG,8                        SET RETURN CODE OF 8;      61500016
         B     OUT                            END OF INPUT              61800016
INVALD   LA    RCRG,X'24'                    SET RETURN CODE OF    24   62100016
         B     OUT                            INVALID DCB FIELDS        62400016
         DS    0F                                                       62700016
LIST     DC    X'85'                                                    63000016
         DC    AL3(ISIEXT)                                              63300016
         SPACE                                                          63600016
*  THIS INSTRUCTION TRANSMITS INFORMATION FROM THE INPUT AREA TO THE  * 63900016
*  OUTPUT AREA. THE LENGTH IS SPECIFIED IN THE EXECUTE STATEMENT      * 64200016
MOVE     MVC   0(0,TRANS),0(INPT)            MOVE CHARACTERS TO OUTPUT  64500016
         EJECT                                                          64800016
*                                                                     * 65100016
*  THIS IS THE INPUT DCB EXIT ROUTINE, IN WHICH THE BLOCKSIZE         * 65400016
*  IS VERIFIED TO BE A MULTIPLE OF EIGHTY(80).  AN INDICATOR IS SET TO* 65700016
*  DESIGNATE THE INVALIDITY OF THE TWO FIELDS.                        * 66000016
*                                                                     * 66300016
ISIEXT   XC    REENTAR+33(1),REENTAR+33                            000G 66600016
TBLKSI   CLC   DCBBLKSI(2),ZERO              BLOCKSIZE ZERO?            66900016
         BE    MAKE80                        YES,BRANCH                 67200016
         SR    WK6,WK6                                                  67500016
          LH    WK7,DCBBLKSI                 LOAD BLOCKSIZE             67800016
         D     WK6,EIGHTY                    IS BLOCKSIZE A MULTIPLE    68100016
         LTR   WK6,WK6                        OF EIGHTY                 68400016
         BE    CONTIN                        YES,BRANCH                 68700016
         MVI   REENTAR+33,X'FF'         SET INVALID INDICATOR      000G 69000016
         B     CONTIN                                                   69300016
MAKE80   MVC   DCBBLKSI(2),EIGHTY+2          SET BLOCKSIZE TO EIGHTY    69600016
CONTIN   RETURN                                                         69900016
         SPACE 2                                                        70200016
*  THIS SECTION MAKES A RECORD AVAILABLE FOR PROCESSING AND CHECKS FOR* 70500016
*  SEQUENTIAL INPUT. IF THE INPUT IS OUT OF SEQUENCE,THE INPUT DATASET* 70800016
*  IS 'CLOSED',AND A RETURN IS MADE TO THE CALLING PROGRAM WITH A RE- * 71100016
*  TURN CODE OF 16. OTHERWISE,THE ADDRESS OF THE INPUT AREA+2,IS RE-  * 71400016
*  TURNED IN 'INPT' TO THE ADDRESS SPECIFIED IN 'NSIRG'.              * 71700016
PROC     GET   DCBAR1                  GET A RECORD                000G 72000016
         CLC   0(2,PARM1),EXITADDR+2    IS INPUT IN SEQUENCE       000G 72300016
         BNE   NOTSEQ                        NO,BRANCH                  72600016
         LH    WK2,EXITADDR+2                                      000G 72900016
         LA    WK2,1(WK2)                    INCREMENT SEQUENCE NUMBER  73200016
         STH   WK2,EXITADDR+2                FOR COMPARE BY ONE    000G 73500016
         LA    INPT,2(PARM1)                 SAVE ADDRESS OF INPUT+2    73800016
         BR    NSIRG                         RETURN WITH INPUT ADDRESS  74100016
EREXIT   SYNADAF ACSMETH=QSAM                                    A31442 74200020
         MVC   MESSAGE+8(79),49(PARM1)  MOVE SYNAD MSG TO BUFFER A52028 74250021
         SYNADRLS                                                A31442 74300020
         LA    RCRG,4                  LOAD RETURN CODE=4        A31442 74400020
         B     OUT                            SYNAD ERROR               74700016
NOTSEQ   LA    RCRG,X'16'                    INPUT OUT OF SEQUENCE      75000016
OUT      STC   RCRG,REENTAR+32          SAVE RETURN CODE           000G 75300016
         MVC   REENTAR(ZERO-CLOSEL),CLOSEL   MOVE L FORM OF CLOSE  000G 75600016
*                                               TO WORKAREA        000G 75900016
         CLOSE (DCBAR1),MF=(E,REENTAR) CLOSE INPUT DATA SET             76200016
         CLI   REENTAR+32,X'20'         NO GOOD OPEN             A41745 76210021
         BE    BYPASS                   NO OPEN SO BYPASS FREEP  A41745 76220021
         FREEPOOL DCBAR1                FREEPOOL INPUT BUFFER    A41745 76250021
BYPASS   IC    RCRG,REENTAR+32                                   A41745 76500021
         L     SAVREG,4(SAVREG)              POP UP SAVE AREA           76800016
         RETURN (14,12),T,RC=(15)           RETURN TO CALLING PROGRAM   77100016
*  CONSTANTS                                                            77400016
OPENL    OPEN  (,INPUT),MF=L                                       000G 77700016
CLOSEL   CLOSE (,DISP),MF=L                                        000G 78000016
ZERO     DC    1H'0'               ** CONSTANTS USED TO CHECK THE       78300016
TWO      DC    1H'2'               ** NUMBER OF BYTES TO BE PROCESSED   78600016
ONE      DC    H'1'                TEST BYTE                     A45167 78700021
EIGHTY   DC    F'80'                                                    78900016
         SPACE                                                          79200016
INDCB    DCB   DSORG=PS,MACRF=GL,DDNAME=SYSUT1,                        *79500016
               RECFM=FB,LRECL=80,EXLST=LIST,                           *79800016
               EODAD=FINI,SYNAD=EREXIT                                  80100016
LABEL    DS    0F                      DUMMY LABEL                 000G 80400016
         DCBD  DSORG=(PS)                                               80700016
IEBWORK  DSECT                                                          81000016
SAVE1    DS    1F                                                       81300016
SAVE1BK  DS    1F                                                       81600016
SAVE1FD  DS    1F                                                       81900016
         DS    15F                                                      82200016
SAVE2    DS    1F                                                       82500016
SAVE2BK  DS    1F                                                       82800016
SAVE2FD  DS    1F                                                       83100016
         DS    15F                                                      83400016
SAVE3    DS    1F                                                       83700016
SAVE3BK  DS    1F                                                       84000016
SAVE3FD  DS    1F                                                       84300016
         DS    15F                                                      84600016
*IEHISR WORKAREA                                                        84900016
ISINVOK  DS    F                        ADDRESS OF PARAMETER LIST AT    85200016
*                                          INVOCATION                   85500016
ISPRINT  DS    2F                       DDNAME FOR SYSPRINT             85800016
ISUT1    DS    2F                       DDNAME FOR SYSUT1               86100016
ISUT2    DS    2F                       DDNAME FOR SYSUT2               86400016
ISCOMP   DS    H                        COMPLETION CODE                 86700016
ISMESS   DS    H                        MESSAGE NUMBER                  87000016
ISPAGE   DS    H                        PAGE NUMBER FOR SYSPRINT        87300016
ISCNTRL  DS    CL1                      CONTROL BYTE                    87600016
* MASKS FOR TESTING CONTROL BYTE - ISCONTRL                             87900016
ISSWC    EQU   X'80'                    COPY                            88200016
ISSWU    EQU   X'40'                    UNLOAD                          88500016
ISSWL    EQU   X'20'                    LOAD                            88800016
ISSWP    EQU   X'10'                    PRINT                           89100016
ISSWN    EQU   X'08'                    NO CONVERT REQUESTED            89400016
ISSWPI   EQU   X'04'                    PRINT INDEX                     89700016
ISSWPP   EQU   X'02'                    PRINT PRIME                     90000016
ISSWPO   EQU   X'01'                    PRINT OVERFLOW                  90300016
ALLMASK  EQU   X'07'                                                    90600016
ISSWITCH DS    CL1                      EXTRANEOUS SWITCHES             90900016
FIRSTTM  EQU   X'80'                    FIRST TIME SWITCH               91200016
*                                                                       91500016
XCTLAREA DS    2F                                                       91800016
WHICH    DS    2F                                                       92100016
ALIGN    DS    1F                                                       92400016
DOUBLE   DS    1D                                                       92700016
EXITADDR DS    2F                                                       93000016
REENTAR  DS    9F                                                       93300016
DCBAR1   DS    64F                                                      93600016
DCBAR2   DS    64F                                                      93900016
MESSAGER DS    CL1                                                      94200016
MESSAGE  DS    CL120                                                    94500016
RECADDR  DS    1F                                                  000G 94800016
         DS    0D                                                       95100016
QISAM    DS    CL250                    UNLOADED DCB WORK AREA          95400016
HEADERC  DS    CL1                                                      95700016
HEADERT  DS    CL144                    HEADER AREA                     96000016
TARGET   DS    2F                       DATE HOLD AREA                  96300016
PAGENO   DS    1F                       HOLD PAGE NUMBER FOR A HEADING  96600016
PAGEPTR  DS    1F                       HOLD POINTER TO WHERE PAGE      96900016
*                                       NUMBER IS TO BE PLACED          97200016
         END                                                            97500016
./  ADD  SSI=71880047,NAME=IEBISSO
 TITLE 'IEBISSO-IEBISAM UTILITY PROGRAM-UNLOAD SUBROUTINE'              00200016
*STATUS: CHANGE LEVEL                                                   00400016
*FUNCTION/OPERATION: SUPPLIED WITH A RECORD ADDRESS AND THE LENGTH OF * 00600016
*   INFORMATION CONTAINED AT THIS ADDRESS(IN BYTES),PRODUCES 80 BYTE  * 00800016
*   CARD IMAGES WITH THE FIELDS DEFINED IN OUTPUT. A POINTER TO THE   * 01000016
*   CURRENT OUTPUT ADDRESS AND THE NUMBER OF BYTES REMAINING TO BE    * 01200016
*   FILLED IN THIS 80 BYTE AREA ARE MAINTAINED.                       * 01400016
*ENTRY POINTS: IEHISSI-TO PROCESS A RECORD FOR OUTPUT  BAL 14,IEHISSO * 01600016
*   DATA IS PASSED BY LOCATION                                        * 01800016
*INPUT: ALL ZEROS IN REGISTER 0 UPON INITIAL ENTRY                    * 02000016
*   AND THE ADDRESS OF THE PARAMETER LIST IN REGISTER 1.              * 02200016
*   A TWO BYTE RECORD LENGTH IN REGISTER 0 AND A RECORD ADDRESS IN    * 02400016
*   REGISTER 1, AND A RECORD OF LENGTH SPECIFIED BY REGISTER ZERO AT  * 02600016
*   THE ADDRESS SPECIFIED BY REGISTER 1.                              * 02800016
*   PARAMETER LIST                                                    * 03000016
*    GUARD    F     CONTAINS ADDRESS OF COMMON WORK AREA              * 03200016
*    KEYADR   F     CONTAINS KEY ADDRESS OR  X'FF' IN HIGH ORDER BYTE * 03400016
*    LONG     CL1   CONTAINS KEY LENGTH                               * 03600016
*    CPYDCB   CL1   DCB UNLOADED INDICATOR                            * 03800016
*                                                                     * 04000016
*   REGISTER 13 MUST CONTAIN  THE ADDRESS OF THE CALLING PROGRAM'S    * 04200016
*   SAVE AREA,REGISTER 14 MUST CONTAIN THE RETURN ADDRESS IN THE      * 04400016
*   CALLING PROGRAM,AND REGISTER 15 MUST CONTAIN THE ADDRESS OF THIS  * 04600016
*   MODULE                                                            * 04800016
*OUTPUT: 80 BYTE CARD IMAGES WITH THE FOLLOWING FIELDS                * 05000016
*   SEQUENCE NUMBER: A TWO BYTE NUMBER STARTING AT ZERO FOR THE FIRST * 05200016
*   CARD IMAGE AND INCREMENTED BY ONE FOR EACH SUCCEEDING CARD IMAGE. * 05400016
*   LENGTH: A TWO BYTE FIELD SPECIFYING THE NUMBER OF BYTES OF INFOR- * 05600016
*   MATION BETWEEN THIS LENGTH FIELD AND THE NEXT.                    * 05800016
*   INFORMATION: THIS FIELD CONTAINS THE INFORMATION FROM A GIVEN     * 06000016
*   RECORD. IT IS SEGMENTED(IF NECESSARY) ON SEQUENTIAL CARD IMAGES.  * 06200016
*   THE LENGTH FIELD DETERMINES ITS SEGMENTATION.                     * 06400016
*   END OF OUTPUT: THIS FIELD OF 0,1,OR 2 BYTES OF ZEROS IS CONTAINED * 06600016
*   ONLY ON THE LAST CARD IMAGE.                                      * 06800016
*EXTERNAL ROUTINES; IEBISU - UNLOAD RTN.GETRECORD ADDRESS AND         * 07000016
*   LENGTH.                                                           * 07200016
*EXITS-NORMAL:  WHEN AN ENTIRE RECORD HAS BEEN PROCESSED (LENGTH      * 07400016
*   IN REGISTER 0), A RETURN IS MADE TO THE CALLING PROGRAM BY A      * 07600016
*   RETURN MACRO WITH A RETURN CODE OF 0 IN REGISTER 15.              * 07800016
*     -ERROR: IF AN EXIT TO THE OUTPUT DCB SYNAD ROUTINE WAS TAKEN    * 08000016
*   A RETURN CODE OF FOUR(4) IS LOADED IN REGISTER 15,BEFORE A RETURN * 08200016
*   IS MADE TO THE CALLING PROGRAM.                                   * 08400016
*   IF THE OPEN FOR THE OUTPUT DATA SET WAS NOT SUCCESSFULLY COMPLETED* 08600016
*   A RETURN CODE OF EIGHT(8) IS LOADED IN REGISTER 15.               * 08800016
*   IF THE BLKSIZE FIELD OF THE OUTPUT DCB WAS INCORRECT A RETURN     * 09000016
*   CODE OF 12 IS LOADED INTO REGISTER 15.                            * 09200016
*TABLES/WORK AREAS: SAVE AREA 72 BYTES TO STORE REGISTERS             * 09400016
*   SEQ = SEQUENCE NUMBER WORK AREA                                   * 09600016
*   KEEP = SAVE AREA FOR CURRENT OUTPUT AREA ADDRESS                  * 09800016
*   SAVE = BYTES REMAINING IN CARD IMAGE WORK AREA                    * 10000016
*ATTRIBUTES-REENTRANT                                              000G 10200016
*NOTES:  BASE REGISTER    = BASERG                                    * 10400016
*        SAVE REGISTER =  13                                          * 10600016
*        PARAMETER REGISTERS:                                         * 10800016
*         PARM0=0 ,PARM1=1                                            * 11000016
*        RETURN CODE REGISTER = 15                                    * 11200016
*        RETURN REGISTER = 14                                         * 11400016
*        WORK REGISTERS                                               * 11600016
*         WK2            WK6                                          * 11800016
*         WK3            WK7                                          * 12000016
*REGISTER ASSIGNMENTS                                                   12200016
PARM00   EQU   0                                                        12400016
PARM1    EQU   1        *REGISTERS* REGISTER OF EVEN-ODD PAIR           12600016
WK2      EQU   2                   WORK REGISTER                        12800016
WK3      EQU   3                   BYTES LEFT IN OUTPUT-WORK REGISTER   13000016
PARM0    EQU   4                                                        13200016
RETRG    EQU   5                   RETURN REGISTER FOR OPERTN SECTION   13400016
WK6      EQU   6                   WORK REGISTER FOR OPERTN SECTION     13600016
WK7      EQU   7                   WORK REGISTER                        13800016
TRANS    EQU   8                   CURRENT RECORD ADDRESS REGISTER      14000016
OUTPT    EQU   9                   CURRENT OUTPUT AREA ADDRESS REGISTER 14200016
BASREG   EQU   10                  BASE REGISTER                        14400016
WORKAREA EQU   11                      WORKAREA REGISTER           000G 14600016
WK12     EQU   12                            RECORD KEY ADDRESS         14800016
SAVREG   EQU   13                                                       15000016
RCRG     EQU   15                                                       15200016
*                                                                     * 15400016
IEBISSO  CSECT                                                          15600016
*2821     014600,016600,018400-018600,019000-019600,020000-020200, 000G 15800016
*         020800,021200,021600,022000,024400-024600,025000-025400, 000G 16000016
*         025800,026800,027800,028200,028600-029200,029600,030000, 000G 16200016
*         030400,031600,032600-033000,033600,034400-035000,035600, 000G 16400016
*         038000-038200,039200,040800,041200,044000-044200,        000G 16600016
*         045600-045800,046200,046600,047200-047400,048000,048400, 000G 16800016
*         050800,051800,052200,052600-053000,054800,056400,        000G 17000016
*         059600-059800,060200,062200,063200-065000,               000G 17200016
* WITH RELEASE 16 THE ENTIRE MODULE WAS REPLACED                   000G 17400016
*  WITH RELEASE 16 THIS MODULE WAS MADE REENTRANT BY USING A       000G 17600016
*DSECT NAMED IEBWORK WHICH WAS DESIGNED AS A COMMON WORKAREA.      000G 17800016
*  THIS SECTION PERFORMS THE INITIALIZATION NECESSARY FOR EACH ENTRY  * 18000016
*A576100-578000                                                  A41745 18050021
         SAVE  (14,12),T,SSO-66-V1           SAVE REGISTERS             18200016
         USING IEBISSO,BASREG                ESTABLISH BASE REGISTER    18400016
         LR    BASREG,RCRG                   ESTABLISH BASE REGISTER    18600016
         LTR   PARM00,PARM00           IS THIS INITIAL ENTRY       000G 18800016
         BNE   SKIP                    NO, BRANCH                  000G 19000016
         LR    WORKAREA,PARM1          PICK UP WORK AREA POINTER   000G 19200016
         USING IEBWORK,WORKAREA                                    000G 19400016
SKIP     ST    SAVREG,SAVE2BK          SET BACK CHAIN POINTER      000G 19600016
         LA    SAVREG,SAVE2            UPDATE TO NEW SAVE AREA     000G 19800016
         LA    WK2,SAVE3               SET UP FORWARD CHAIN POINTER000G 20000016
         ST    WK2,SAVE2FD                TO NEXT SAVE AREA        000G 20200016
         BNE   COMPRE                       NO,BRANCH                   20400016
*                                                                     * 20600016
*  THIS SECTION SAVES THE PARAMETER LIST ADDRESS STORES KEYLEN FOR UN-* 20800016
*BLOCKED RECORDS, SETS THE UNBLOCKED RECFM INDICATOR, MOVES THE       * 21000016
*  DDNAME FROM ISUT2 FIELD OF COMMON AREA TO THE OUTPUT DCB,OPENS THE * 21200016
*  OUTPUT DATASET, SAVES THE APPROPIATE POINTERS ANS SETS RETURN CODE * 21400016
*                                                                     * 21600016
         CLI   DOUBLE,X'FF'            UNBLOCKED RECORDS           000G 21800016
         BNE   COMAREA             NO,BRANCH                            22000016
         MVC   EXITADDR+5(1),DOUBLE+4   STORE KEY LENGTH           000G 22200016
         MVI   EXITADDR+6,X'02'        SET UNBLOCKED INDICATOR     000G 22400016
COMAREA  MVC   DCBAR2(OPENL-OUTDCB),OUTDCB                         000G 22600016
         USING IHADCB,WK2                                          000G 22800016
         LA    WK2,DCBAR2                                          000G 23000016
         MVI   REENTAR+33,X'00'                                    000G 23200016
         MVC   DCBDDNAM(8),ISUT2       MOVE DDNAME FROM ISUT2      000G 23400016
         MVC   REENTAR(CLOSEL-OPENL),OPENL   MOVE OPENL TO WORKAREA000G 23600016
         OPEN  (DCBAR2,(OUTPUT)),MF=(E,REENTAR)   YES, OPEN OUTPUT 000G 23800016
         TM    DCBOFLGS,X'10'                WAS OPEN SUCCESSFUL        24000016
         BZ    NOTOK                         IF NOT,BRANCH              24200016
         CLI   REENTAR+33,X'00'        VALID DCB FIELDS            000G 24400016
         BNE   HERE                          NO, BRANCH                 24600016
ALRITE   XC    EXITADDR(2),EXITADDR    SET SEQUENCE NUMBER TO 0    000G 24800016
         LA    WK3,78                        NUMBER OF BYTES LEFT IN    25000016
         STH   WK3,EXITADDR+2              OUTPUT AREA EQUAL 78    000G 25200016
         BAL   RETRG,OPERTN                                             25400016
         ST    OUTPT,ALIGN             SAVE OUTPUT POINTER         000G 25600016
         LR    PARM1,WK2                     LOAD ADDRESS OF OUTPUT DCB 25800016
         LA    RCRG,0                        SET RETURN CODE OF ZERO    26000016
         LR    PARM00,RCRG                   RETURN ZERO IN REGISTER 0  26200016
         L     SAVREG,4(SAVREG)             POP UP SAVE AREA            26400016
         L     14,12(0,SAVREG)               RESTORE REGISTER FOURTEEN  26600016
         RETURN (2,12),T,RC=(15)            RETURN TO CALLING PROGRAM   26800016
*  THIS SECTION DETERMINES IF THERE IS ANY SPACE LEFT IN THE OUTPUT   * 27000016
*  AREA. IF NOT,THE NEXT AVAILABLE OUTPUT AREA ADDRESS IS ACQUIRED.   * 27200016
*  ALL POINTERS AND LENGTH SPECIFIERS,SAVED UPON EXIT,ARE RESTORED.   * 27400016
COMPRE   LR    TRANS,PARM1                   SAVE RECORD ADDRESS        27600016
         LR    PARM0,PARM00                                             27800016
         CLI   DOUBLE+5,X'FF'          END OF INPUT DATA           000G 28000016
         BE    ERROR1                   YES,BRANCH CLOSE OUTPUT    000G 28200016
         BE    ERROR+4                       YES,BRANCH ,CLOSE OUTPUT   28400016
         L     WK12,DOUBLE             LOAD KEY ADDRESS            000G 28600016
         MVC   EXITADDR+5(1),DOUBLE+4   GET KEY LENGTH             000G 28800016
         L     OUTPT,ALIGN             RESTORE OUTPUT POINTER      000G 29000016
         LA    WK7,2(PARM0)                  SAVE LENGTH PLUS 2 BYTES   29200016
         CLC   EXITADDR+2(2),ZERO      IF SPACE LEFT IN OUTPUT     000G 29400016
         BNE   HOWMCH                         AREA,BRANCH               29600016
*                                            ELSE,GET NEXT AVAILABLE    29800016
         BAL   RETRG,OPERTN                   OUTPUT AREA ADDRESS       30000016
         LA    WK3,78                        RESET BYTES LEFT IN OUTPUT 30200016
         STH   WK3,EXITADDR+2              AREA TO 78              000G 30400016
         SPACE                                                          30600016
*  THIS SECTION DETERMINES THE AMOUNT OF ROOM LEFT,PUTS THE RECORD    * 30800016
*  LENGTH IN THE OUTPUT AREA AND STEPS THE OUTPUT POINTER.            * 31000016
         EJECT                                                          31200016
HOWMCH   CH    WK7,EXITADDR+2          IF ENOUGH ROOM FOR INFOR-   000G 31400016
         BNH   ENUF                           MATION AND LENGTH,BRANCH  31600016
         CLC   EXITADDR+2(2),TWO       IF ONLY ONE BYTE LEFT IN    000G 31800016
         BL    ONE                            OUTPUT AREA,BRANCH        32000016
         STH   PARM0,ALIGN                                         000G 32200016
         MVC   0(2,OUTPT),ALIGN        MOVE LENGTH TO OUTPUT AREA  000G 32400016
         LH    PARM0,ALIGN                                         000G 32600016
         LH    WK3,EXITADDR+2                                      000G 32800016
         SH    WK3,TWO                       DECREMENT NUMBER OF BYTES  33000016
         STH   WK3,EXITADDR+2              LEFT BY TWO             000G 33200016
         LA    OUTPT,2(OUTPT)                ADD TWO TO OUTPUT POINTER  33400016
         CLI   DOUBLE+5,X'11'          DCB FIELDS UNLOADED         000G 33600016
         BE    INFORM                        NO  BRANCH                 33800016
         CLI   EXITADDR+6,X'02'        UNBLOCKED RECORDS           000G 34000016
         BNE   INFORM                        NO,BRANCH                  34200016
         LTR   WK3,WK3                       ANY MORE BYTES LEFT?       34400016
         BZ    KACTION                       NO,BRANCH                  34600016
*  THIS SECTION MOVES THE RECORD KEY TO THE OUTPUT AREA FOR UNBLOCKED * 34800016
*RECORDS:WHERE RKP=0, TECHNIQUE SAME AS FOR DATA PORTIONS.            * 35000016
KEYCOMP  LH    WK6,EXITADDR+4          LOAD KEY LENGTH             000G 35200016
         CR    WK3,WK6                       ENOUGH ROOM FOR KEY?       35400016
         BL    GETMOR                        NO,BRANCH                  35600016
         BCTR  WK6,0                                                    35800016
         EX    WK6,MVEKEY                    MOVE KEY TO OUTPUT         36000016
         SH    PARM0,EXITADDR+4        DECREMENT TOTAL LENGTH      000G 36200016
         AH    OUTPT,EXITADDR+4        STEP OUTPUT POINTER         000G 36400016
         SH    WK3,EXITADDR+4          DECREMENT BYTES LEFT        000G 36600016
         LTR   WK3,WK3                       ANY BYTES LEFT             36800016
         BZ    MORE                          NO,BRANCH                  37000016
         STH   WK3,EXITADDR+2                                      000G 37200016
         B     FIND                          YES,BRANCH                 37400016
GETMOR   BCTR  WK3,0                                                    37600016
         EX    WK3,MVEKEY                    MOVE 'SAVE' BYTES OF KEY   37800016
         SH    WK6,EXITADDR+2          DECREMENT KEY LENGTH        000G 38000016
         STH   WK6,EXITADDR+4                                      000G 38200016
         SH    PARM0,EXITADDR+2        DECREMENT TOTAL LENGTH      000G 38400016
         AH    WK12,EXITADDR+2         STEP KEY ADDRESS            000G 38600016
KACTION  BAL   RETRG,OPERTN                  GET NEXT OUTPUT ADDRESS    38800016
         LA    WK3,78                                                   39000016
         STH   WK3,EXITADDR+2          SET SAVE = 78               000G 39200016
*  THIS INSTRUCTION MOVES THE RECORD KEY TO OUTPUT; THE LENGTH OF     * 39400016
*WHICH IS SPECIFIED IN THE REGISTER OF AN EXECUTE INSTRUCTION         * 39600016
         B     KEYCOMP                                                  39800016
MVEKEY   MVC   0(0,OUTPT),0(WK12)            MOVE KEY TO OUTPUT         40000016
INFORM   LTR   WK3,WK3                       ANY SPACE                  40200016
         BZ    MORE                           LEFT,BRANCH               40400016
         SPACE                                                          40600016
*  THIS SECTION MOVES ENOUGH BYTES FROM THE RECORD TO FILL THE OUTPUT * 40800016
*  AREA AND MODIFIES THE OUTPUT POINTER AND RECORD LENGTH.            * 41000016
CONTIN   BCTR  WK3,0                         MOVE 'SAVE' BYTES TO       41200016
         EX    WK3,MOVE                      FILL OUTPUT AREA           41400016
         AH    TRANS,EXITADDR+2        STEP RECORD POINTER         000G 41600016
         SH    PARM0,EXITADDR+2        DECREMENT LENGTH BY 'SAVE'  000G 41800016
*  THIS SECTION GETS NEXT AVAILABLE OUTPUT ADDRESS AND RESETS 'SAVE'    42000016
*                                            GET ADDRESS OF NEXT AVAIL- 42200016
MORE     BAL   RETRG,OPERTN                   ABLE OUTPUT AREA          42400016
         LA    WK3,78                        RESET BYTES LEFT IN        42600016
         STH   WK3,EXITADDR+2               OUTPUT AREA TO 78      000G 42800016
*  THIS SECTION MOVES IN THE ENTIRE RECORD OF INFORMATION,IF THERE IS * 43000016
*  ENOUGH ROOM IN THE OUTPUT AREA                                       43200016
FIND     CR    WK3,PARM0                     ENOUGH ROOM                43400016
         BL    CONTIN                        NO,GO MOVE IN 'SAVE' BYTES 43600016
         LR    WK3,PARM0                     YES,                       43800016
         BCTR  WK3,0                                                    44000016
         EX    WK3,MOVE                      MOVE IN INFORMATION        44200016
         LH    WK3,EXITADDR+2                                      000G 44400016
         SR    WK3,PARM0                     DECREMENT NUMBER OF BYTES  44600016
         STH   WK3,EXITADDR+2            LEFT BY NUMBER MOVED (LL) 000G 44800016
         AR    OUTPT,PARM0                   STEP OUTPUT POINTER        45000016
         B     CHECK                                                    45200016
*  THIS SECTION INSERTS THE HIGH ORDER BYTE OF THE RECORD LENGTH IN   * 45400016
*  LAST BYTE OF OUTPUT AREA;LOW ORDER BYTE IN THE NEXT AVAILABLE OUT- * 45600016
*  PUT AREA AND MODIFIES THE APPROPIATE POINTERS AND LENGTH SPECIFIER * 45800016
ONE      SRDL  PARM0,8                       INSERT HIGH ORDER BYTE OF  46000016
         STC   PARM0,0(0,OUTPT)               RECORD LENGTH FOR OUTPUT  46200016
         SRDL  PARM0,8                                             1620 46400016
         LR    PARM0,RETRG                                              46600016
         SRL   PARM0,16                                            1620 46800016
         BAL   RETRG,OPERTN                                             47000016
         STC   PARM0,0(0,OUTPT)              INSERT LOW ORDER BYTE      47200016
         LA    OUTPT,1(OUTPT)               STEP OUTPUT POINTER BY ONE  47400016
         LA    WK3,77                        RESET NUMBER OF BYTES LEFT 47600016
         STH   WK3,EXITADDR+2            IN OUTPUT AREA TO 77      000G 47800016
         CLI   EXITADDR+6,X'02'        UNBLOCKED RECORDS           000G 48000016
         BE    KEYCOMP                       YES,BRANCH                 48200016
         B     FIND                          NO,BRANCH                  48400016
         SPACE 2                                                        48600016
*  THIS SECTION MOVES AN ENTIRE RECORD TO THE OUTPUT AREA AND MODIFIES* 48800016
*  THE OUTPUT AREA LENGTH SPECIFIER AND THE OUTPUT AREA POINTER. IT   * 49000016
*  ALSO MOVES RECORD LENGTH TO OUTPUT AREA.                           * 49200016
ENUF     STH   PARM0,ALIGN             MOVE LENGTH TO OUTPUT AREA  000G 49400016
         MVC   0(2,OUTPT),ALIGN                                    000G 49600016
         LA    OUTPT,2(OUTPT)                ADD TWO TO OUTPUT POINTER  49800016
         CLI   EXITADDR+6,X'02'        UNBLOCKED RECORDS           000G 50000016
         BNE   EASYMVE                       NO,BRANCH                  50200016
         LH    WK6,EXITADDR+4          GET KEYLEN                  000G 50400016
         BCTR  WK6,0                                                    50600016
         EX    WK6,MVEKEY                    MOVE KEY TO OUTPUT         50800016
         SH    PARM0,EXITADDR+4        DECREMENT TOTAL LENGTH      000G 51000016
         AH    OUTPT,EXITADDR+4        STEP OUTPUT POINTER         000G 51200016
EASYMVE  BCTR  PARM0,0                       MOVE ENTIRE RECORD TO      51400016
         EX    PARM0,MOVE                     OUTPUT AREA               51600016
         LH    WK3,EXITADDR+2          DECREMENT BYTES LEFT BY     000G 51800016
         SR    WK3,WK7                        THE BYTES OF INFORMATION  52000016
         STH   WK3,EXITADDR+2                MOVED PLUS TWO.       000G 52200016
         AR    OUTPT,PARM0                  STEP OUTPUT POINTER         52400016
         LA    OUTPT,1(OUTPT)                BY LENGTH OF RECORD        52600016
         SPACE                                                          52800016
*  THIS  SECTION PUTS 1 OR 2 BYTES OF ZEROS IN THE OUTPUT AREA AT THE * 53000016
*  END OF EACH FIELD OF INFORMATION,AND SETS A RETURN CODE OF ZERO.   * 53200016
CHECK    CH    WK3,UNO                       ONE BYTE LEFT IN OUTPUT    53400016
         BE    END                           NO,BRANCH                  53600016
         BL    END+6                         POSSIBLE END,BRANCH        53800016
         MVC   0(2,OUTPT),ZERO               DESIGNATE POSSIBLE END OF  54000016
         B     END+6                         OUTPUT BY HALFWORD OF ZERO 54200016
END      MVC   0(1,OUTPT),ZERO                OR BY ONE BYTE OF ZERO    54400016
         ST    OUTPT,ALIGN             SAVE OUTPUT POINTER         000G 54600016
         LA    RCRG,0                   RETURN CODE=0;OPERATION OKAY    54800016
         B     GOBACK                   BRANCH,TO RETURN                55000016
         SPACE                                                          55200016
*  THIS SECTION SETS RETURN CODES DIFFERENT FROM 0.                   * 55400016
NOTOK    MVI   REENTAR+32,X'08'        RETURN CODE=8 OPEN NOT GOOD 000G 55600016
         B     ERROR1                                              000G 55800016
HERE     MVI   REENTAR+32,X'12'        WRONG DSORG OR BLKSIZE      000G 56000016
         B     ERROR1                                              000G 56200016
ERROR    MVI   REENTAR+32,X'04'        RETURN CODE=4 SYNAD RTN     000G 56400016
         SYNADAF ACSMETH=QSAM,PARM1=DCBAR2,PARM2=(0)               000G 56600016
         MVC   MESSAGE+8(79),49(PARM1)  MOVE IN MESSAGE            000G 56800016
         SYNADRLS                                                  000G 57000016
ERROR1   MVC   REENTAR(ZERO-CLOSEL),CLOSEL   MOVE L FORM OF CLOSE  000G 57200016
*                                               TO WORKAREA        000G 57400016
         CLOSE (DCBAR2),MF=(E,REENTAR)   CLOSE OUTPUT              000G 57600016
         CLI   REENTAR+32,X'08'         OPEN NO GOOD             A41745 57610021
         BE    BYPASS                   NO OPEN SO BYPASS FREEP  A41745 57620021
         FREEPOOL DCBAR2                FREEPOOL OUTPUT BUFFER   A41745 57650021
BYPASS   IC    RCRG,REENTAR+32         LOAD RETURN CODE          A41745 57800021
GOBACK   L     SAVREG,4(SAVREG)             POP UP SAVE AREA            58000016
         RETURN (14,12),T,RC=(15)           RETURN TO CALLING PROGRAM   58200016
         SPACE                                                          58400016
*                                                                     * 58600016
*  THIS IS THE OUTPUT DCB EXIT ROUTINE.   THE BLOCKSIZE               * 58800016
*  IS VERIFIED TO BE A MULTIPLE OF EIGHTY(80).  AN INDICATOR IS SET TO* 59000016
*  DESIGNATE THE INVALIDITY OF THE TWO FIELDS.                        * 59200016
*                                                                     * 59400016
DCBRTN   XC    REENTAR+33(1),REENTAR+33  CLEAR INDICATOR           000G 59600016
TBLKSI   CLC   DCBBLKSI(2),ZERO             BLOCKSIZE FIELD ZERO        59800016
         BE    SET80                         YES,BRANCH                 60000016
         SR    WK6,WK6                                                  60200016
         LH    WK7,DCBBLKSI                  LOAD BLOCKSIZW             60400016
         D     WK6,EIGHTY                    IS BLOCKSIZE A MULTIPLE    60600016
         LTR   WK6,WK6                        OF EIGHTY?                60800016
         BE    CONTINUE                                                 61000016
         MVI   REENTAR+33,X'FF'        SET INVALID INDICATOR       000G 61200016
         B     CONTINUE                                                 61400016
SET80    MVC   DCBBLKSI(2),EIGHTY+2          SET BLOCKSIZE TO EIGHTY    61600016
CONTINUE RETURN                                                         61800016
*  THIS INSTRUCTION MOVES INFORMATION FROM THE RECORD TO THE OUTPUT   * 62000016
*  AREA;THE NUMBER OF CHARACTERS TO BE MOVED IS SPECIFIED IN THE      * 62200016
*  REGISTER OF THE EXECUTE STATEMENT WHICH USES THIS INSTRUCTION.     * 62400016
MOVE     MVC   0(0,OUTPT),0(TRANS)      MOVE INFORMATION TO OUTPUT      62600016
         EJECT                                                          62800016
*  THE FOLLOWING SECTION OF CODE OUTPUTS ONE CARD IMAGE AND SUPPLIES  * 63000016
*  AN ADDRESS OF THE NEXT AVAILABLE OUTPUT AREA. IT ALSO MOVES THE    * 63200016
*  TWO BYTE SEQUENCE NUMBER TO THE OUTPUT AREA,INCREMENTS THE SEQUENCE* 63400016
*  NUMBER BY ONE FOR THE FOLLOWING CARD IMAGE,AND STEPS THE POINTER TO* 63600016
*  THE OUTPUT AREA BY TWO. THE RESULTING ADDRESS IS RETURNED IN 'OUT- * 63800016
*  PT' TO THE ADDRESS SPECIFIED IN THE REGISTER NAMED 'RETRG'.        * 64000016
OPERTN   PUT   DCBAR2                  OUTPUT CARD IMAGE           000G 64200016
         MVC   0(2,PARM1),EXITADDR     MOVE SEQUENCE NUMBER        000G 64400016
         LH    WK6,EXITADDR                                        000G 64600016
         LA    WK6,1(WK6)                                               64800016
         STH   WK6,EXITADDR            INCREMENT NUMBER BY ONE     000G 65000016
REAP     LA    OUTPT,2(PARM1)               STEP OUTPUT POINTER BY TWO  65200016
         BR    RETRG                                                    65400016
         DS    0F                                                       65600016
VALID    DC    X'85'                                                    65800016
         DC    AL3(DCBRTN)                                              66000016
         SPACE                                                          66200016
OUTDCB   DCB   DSORG=PS,MACRF=PL,DDNAME=SYSUT2,                        *66400016
               RECFM=FB,LRECL=80,SYNAD=ERROR,EXLST=VALID                66600016
         SPACE                                                          66800016
*CONSTANTS                                                              67000016
OPENL    OPEN  (,OUTPUT),MF=L                                      000G 67200016
CLOSEL   CLOSE (,DISP),MF=L                                        000G 67400016
ZERO     DC    1H'0'               **                                   67600016
UNO      DC    1H'1'                *COMPARE CONSTANTS                  67800016
TWO      DC    1H'2'               **                                   68000016
EIGHTY   DC    F'80'                                                    68200016
         DCBD  DSORG=(PS)                                               68400016
IEBWORK  DSECT                                                          68600016
SAVE1    DS    1F                                                       68800016
SAVE1BK  DS    1F                                                       69000016
SAVE1FD  DS    1F                                                       69200016
         DS    15F                                                      69400016
SAVE2    DS    1F                                                       69600016
SAVE2BK  DS    1F                                                       69800016
SAVE2FD  DS    1F                                                       70000016
         DS    15F                                                      70200016
SAVE3    DS    1F                                                       70400016
SAVE3BK  DS    1F                                                       70600016
SAVE3FD  DS    1F                                                       70800016
         DS    15F                                                      71000016
*IEHISR WORKAREA                                                        71200016
ISINVOK  DS    F                        ADDRESS OF PARAMETER LIST AT    71400016
*                                          INVOCATION                   71600016
ISPRINT  DS    2F                       DDNAME FOR SYSPRINT             71800016
ISUT1    DS    2F                       DDNAME FOR SYSUT1               72000016
ISUT2    DS    2F                       DDNAME FOR SYSUT2               72200016
ISCOMP   DS    H                        COMPLETION CODE                 72400016
ISMESS   DS    H                        MESSAGE NUMBER                  72600016
ISPAGE   DS    H                        PAGE NUMBER FOR SYSPRINT        72800016
ISCNTRL  DS    CL1                      CONTROL BYTE                    73000016
* MASKS FOR TESTING CONTROL BYTE - ISCONTRL                             73200016
ISSWC    EQU   X'80'                    COPY                            73400016
ISSWU    EQU   X'40'                    UNLOAD                          73600016
ISSWL    EQU   X'20'                    LOAD                            73800016
ISSWP    EQU   X'10'                    PRINT                           74000016
ISSWN    EQU   X'08'                    NO CONVERT REQUESTED            74200016
ISSWPI   EQU   X'04'                    PRINT INDEX                     74400016
ISSWPP   EQU   X'02'                    PRINT PRIME                     74600016
ISSWPO   EQU   X'01'                    PRINT OVERFLOW                  74800016
ALLMASK  EQU   X'07'                                               000G 75000016
ISSWITCH DS    CL1                      EXTRANEOUS SWITCHES             75200016
FIRSTTM  EQU   X'80'                    FIRST TIME SWITCH               75400016
*                                                                       75600016
XCTLAREA DS    2F                                                       75800016
WHICH    DS    2F                                                       76000016
ALIGN    DS    1F                                                       76200016
DOUBLE   DS    1D                                                       76400016
EXITADDR DS    2F                                                       76600016
REENTAR  DS    9F                                                       76800016
DCBAR1   DS    64F                                                      77000016
DCBAR2   DS    64F                                                      77200016
MESSAGER DS    CL1                                                      77400016
MESSAGE  DS    CL120                                                    77600016
RECADDR  DS    1F                                                  000G 77800016
         DS    0D                                                       78000016
QISAM    DS    CL250                    UNLOADED DCB WORK AREA          78200016
HEADERC  DS    CL1                                                      78400016
HEADERT  DS    CL144                    HEADER AREA                     78600016
TARGET   DS    2F                       DATE HOLD AREA                  78800016
PAGENO   DS    1F                       HOLD PAGE NUMBER FOR A HEADING  79000016
PAGEPTR  DS    1F                       HOLD POINTER TO WHERE PAGE      79200016
*                                       NUMBER IS TO BE PLACED          79400016
         END                                                            79600016
./  ADD  SSI=71880048,NAME=IEBISU
 TITLE 'IEBISU-IEBISAM UTILITY PROGRAM-UNLOAD ROUTINE'                  00300016
*STATUS: CHANGE LEVEL 000                                             * 00600016
*FUNCTION/OPERATION: THIS MODULE RETRIEVES LOGICAL RECORDS OF AN IN-  * 00900016
*   DEXED SEQUENTIAL DATASET AND PASSES THE LENGTH OF DATA RECORD AND * 01200016
*   THE ADDRESS OF THE RECORD TO IEHISSO.                             * 01500016
*ENTRY POINTS                                                         * 01800016
*   IEBISU-TO RETRIEVE A LOGICAL RICORD FROM AN ISAM DATASET          * 02100016
*   DATA IS PASSED BY LOCATION                                        * 02400016
*INPUT: ADDRESS OF IEHISR COMMON WORKAREA.                            * 02700016
*   FIELDS NEED:                                                      * 03000016
*       ISUT1  DDNAME FOR SYSUT1                                      * 03300016
*       ISUT2  DDNAME FOR SYSUT2                                      * 03600016
*       ISCOMP COMPLETION CODE                                        * 03900016
*       ISMESS MESSAGE NUMBER                                         * 04200016
*                                                                     * 04500016
*   REGISTER 13 MUST CONTAIN THE ADDRESS OF THHE CALLING PROGRAM'S    * 04800016
*   SAVE AREA,REGISTER 15 MUST CONTAIN THE ADDRESS OF THIS MODULE     * 05100016
*   FOR EVERY ENTRY TI THIS MODULE(EXCEPT FROM IEBISSO).                05400016
*OUTPUT: MODIFICATION OF IEBISR WORK AREA                             * 05700016
*EXTERNAL ROUTINES:                                                   * 06000016
*   IEBISSO: OUTPUT SUBROUTINE - TO OUTPUT AN UNLOAD ED RECORD        * 06300016
*EXITS-NORMAL:                                                        * 06600016
*   TO IEBISSO WHEN A LOGICAL RECORD HAS BEEN RETRIEVED AN PROCESSED  * 06900016
*    THE ADDRESS OF THE RECORD IN REGISTER1,ITS LENGTH IN REGISTER 0. * 07200016
*   TO IEBISF WITH A COMPLETION CODE OF ZERO IF MODULE WAS ABLE TO COM* 07500016
*    PLETE ITS OPERATION WITHOUT ENCOUNTERING ANY ERROR CONDITIONS.   * 07800016
*     -ERROR                                                          * 08100016
*   TO IEBISF WITH THE FOLLOWING COMPLETION CODES                     * 08400016
*     COMPLETION CODE = 8  PROGRAM UNABLE TO COMPLETE ITS OPERATION F * 08700016
*     OR EITHER OF THE FOLLOWING REASONS:                             * 09000016
*     INPUT OR OUTPUT SYNCHRONOUS ERROR                               * 09300016
*                                                                     * 09600016
*     COMPLETION CODE = 16 SYSUT1 OR SYSUT2 DD STATEMENT OMITTED      * 09900016
*                                                                     * 10200016
*ATTRIBUTES-REENTRANT                                              000G 10500016
*                                                                     * 10800016
*  REGISTER ASSIGNMENTS                                               * 11100016
*                                                                     * 11400016
BASE     EQU   10                  BASE REGISTER                        11700016
SAVERG   EQU   13                  SAVE AREA ADDRESS REGISTER           12000016
ADDREG   EQU   15                  ADDRESSIBILITY REGISTER              12300016
PARA1    EQU   1                   PARAMETER REGISTER                   12600016
WORKAREA EQU   11                       WORKAREA REGISTER          000G 12900016
WK2      EQU   2                   DCB ADDRESSING REGISTER              13200016
PARA0    EQU   0                   PARAMETER REGISTER                   13500016
LINKRG   EQU   15                  LINKAGE REGISTER TO  IEHISSO         13800016
RETREG   EQU   14                  RETURN REGISTER FOR IEHISSO          14100016
RCODE    EQU   15                  RETURN CODE REGISTER FOR IEHISSO     14400016
WK3      EQU   3                   MESSAGE NUMBER REGISTER              14700016
GETREG   EQU   1                   RECORD ADDRESS REGISTER              15000016
WK5      EQU   5                   WORK REGISTER                        15300016
*                                                                     * 15600016
IEBISU   CSECT                                                          15900016
*1770528000-540000                                                 IV0I 16900018
*A384100-387000                                                  A41745 16950021
         SAVE  (14,12),T,ISU-66-V1           SAVE REGISTERS             18600016
         USING IEBISU,BASE                   ESTABLISH BASE REGISTER    18900016
         LR    BASE,ADDREG                    BASE REGISTER             19200016
         LR    WORKAREA,PARA1           PICK UP WORK AREA POINTER  000G 19500016
         USING IEBWORK,WORKAREA                                    000G 19800016
         ST    SAVERG,SAVE1BK           SET BACK CHAIN POINTER     000G 20100016
         LR    SAVERG,WORKAREA          UPDATE TO NEW SAVE AREA    000G 20400016
         LA    WK2,SAVE2                SET UP FORWARD CHAIN POINTR000G 20700016
         ST    WK2,SAVE1FD                 TO NEXT SAVE AREA       000G 21000016
*                                                                       21300016
*  THIS SECTION LOADS THE ADDRESS OF THE IEHISR COMMON WORK AREA,MOVES* 21600016
*THE DDNAME FROM THE ISUT1 FIELD OF IEBISR WORK AREA TO THE INPUT DCB-* 21900016
*DDNAME FIELD. DURING OPEN A DCB EXIT IS TAKEN. IF OPEN WAS SUCCESSFU-* 22200016
*LY COMPLETED AND THE DATASET IS OF INDEXED SEQUENTIAL ORGANIZATION,  * 22500016
*THE RECORD FORMAT IS CHECKED FOR FIXED OR VARIABLE FORMAT. A SWITCH  * 22800016
*IS SET TO INDICATE THE FORMAT ,ZERO IS PLACED IN REGISTER ZERO AND A * 23100016
*BRANCH IS MADE OT THE SUBROUTINE IEBISSO.                            * 23400016
         MVC   DCBAR1(LABEL-DCBISU),DCBISU                         000G 23700016
         USING IHADCB,WK2                                               24000016
         LA    WK2,DCBAR1                                          000G 24300016
         MVC   DCBDDNAM(8),ISUT1        MOVE DDNAME FROM ISUT1     000G 24600016
         MVC   REENTAR(CLOSEL-OPENL),OPENL   MOVE L FORM OF OPEN TO000G 24900016
*                                               WORKAREA           000G 25200016
         XC    DOUBLE(8),DOUBLE                                         25500016
         XC    EXITADDR(8),EXITADDR                                     25800016
         OPEN  (DCBAR1,(INPUT)),MF=(E,REENTAR)                     000G 26100016
         TM    DCBOFLGS,X'10'                WAS OPEN SUCCESSFUL        26400016
         BZ    SETAL                         IF NOT,BRANCH              26700016
         TM    DCBRECFM,X'80'                YES,RECORD FORMAT FIXED    27000016
         BZ    VARY                          NO,BRANCH                  27300016
         TM    DCBRECFM,X'10'                BLOCKED RECORDS?           27600016
         BO    VARY+4                        YES,BRANCH                 27900016
         MVI   DOUBLE+6,X'01'          SET FORMAT SWITCH = 01           28200016
         LH    WK3,DCBRKP                    LOAD RELATIVE KEY POSITIO  28500016
         LTR   WK3,WK3                       RKP=0                      28800016
         BNE   VARY+4                        NO, BRANCH                 29100016
         OI    DOUBLE+6,X'10'           FORMAT SWITCH = X'11'      000G 29400016
         MVI   DOUBLE,X'FF'             INDICATE UNBLOCKED         000G 29700016
         MVC   DOUBLE+4(1),DCBKEYLE     SAVE KEY LENGTH            000G 30000016
         B     VARY+4                                                   30300016
VARY     MVI   DOUBLE+6,X'02'           SET FORMAT SWITCH = '02'   000G 30600016
         SR    PARA0,PARA0                                              30900016
         LR    PARA1,WORKAREA           LOAD ADDRESS OF WORKAREA   000G 31200016
OUSE     L     LINKRG,VSSO                   LOAD ADDRESS OF IEHISSO    31500016
         BALR  RETREG,LINKRG                 BRANCH TO IEHISSO          31800016
*                                                                     * 32100016
*  THIS SECTION DETERMINES THE RETURN CODE PASSED BY IEHISSO AND THEN * 32400016
*SETS THE APPROPRIATE COMPLETION CODE OR MESSAGE NUMBER, FOR ANY RE-  * 32700016
*TURN CODE DIFFERENT FROM ZERO AND CLOSES THE INPUT DATA SET BEFORE   * 33000016
*PASSING CONTROL TO IEBISF,                                           * 33300016
*                                                                     * 33600016
         STC   RCODE,DOUBLE+7           STORE RETURN CODE          000G 33900016
         CLI   DOUBLE+7,X'00'           IS RETURN CODE 0           000G 34200016
         BE    OBTAIN                        YES,BRANCH                 34500016
         CLI   DOUBLE+7,X'04'           IS RETURN CODE 4           000G 34800016
         BE    SETAS                         YES,BRANCH                 35100016
         CLI   DOUBLE+7,X'08'           IS RETURN CODE 8           000G 35400016
         BE    SETAL                                                    35700016
         LA    WK3,1                   DCB FIELDS INCONSISTENT     000G 36000016
EXIT     STH   WK3,REENTAR+32           INVALID RETURN CODE        000G 36300016
         MVC   ISMESS(2),REENTAR+32     MOVE IN MESSAGE NUMBER     000G 36600016
         LTR   WK3,WK3                       MESSAGE NUMBER = 0         36900016
         BZ    COMPLY                        YES,BRANCH                 37200016
         MVC   ISCOMP(2),EIGHT          SET COMPLETION CODE = 8    000G 37500016
COMPLY   MVC   REENTAR(EIGHT-CLOSEL),CLOSEL    MOVE L FORM OF CLOSE000G 37800016
*                                                 TO WORKAREA      000G 38100016
         CLOSE (DCBAR1),MF=(E,REENTAR)  CLOSE INPUT DATA SET       000G 38400016
         CLI   ISMESS+1,X'07'           OPEN NO GOOD             A41745 38410021
         BE    BYPASS                   NO OPEN SO BYPASS FREEP  A41745 38420021
         FREEPOOL DCBAR1                FREEPOOL INPUT BUFFER    A41745 38450021
BYPASS   SR    WK3,WK3                  SET UP XCTL AREA         A41745 38700021
         ST    WK3,XCTLAREA+4                                      000G 39000016
         MVI   WHICH+6,C' '             MOVE INTO XCTLAREA NAME OF 000G 39300016
         MVI   WHICH+5,C'F'                NEXT MODULE - IEBISF    000G 39600016
         L     SAVERG,4(SAVERG)              POPUP SAVE AREA            39900016
         L     14,12(0,SAVERG)               RESTORE REGISTER FOURTEEN  40200016
         LR    PARA1,WORKAREA           LOAD ADDRESS OF WORK AREA  000G 40500016
         XCTL  (2,12),MF=(E,(1)),SF=(E,XCTLAREA)   BRANCH TO IEHISF000G 40800016
SETAS    LA    WK3,2                   SYNAD ROUTINE ENTERED       000G 41100016
         B     EXIT                                                     41400016
SETAL    MVC   ISCOMP(2),H16            SET COMPLETION CODE OF 16  000G 41700016
         LA    WK3,7                   SET MESSAGE NUMBER = 7 FOR  000G 42000016
         STH   WK3,ISMESS                  MISSING SYSUT DD CARD   000G 42300016
         B     COMPLY                        BRANCH TO CLOSE            42600016
*                                                                     * 42900016
*  THIS SECTION PASSES THE LENGTH AND ADDRESS FO THE QISAM DCB TO THE * 43200016
*OUTPUT ROUTINE (IEHISSO) TO BE WRITTEN OUT                           * 43500016
*                                                                     * 43800016
OBTAIN   LTR   PARA0,PARA0                   INITIAL ENTRY FROM IEHISSO 44100016
         BNE   OBTAIN1                       NO, BRANCH                 44400016
         LA    WK3,154                       LOAD DCB LENTH             44700016
         STH   WK3,REENTAR+34           SAVE LENGTH                000G 45000016
         LA    WK3,DCBAR1              LOAD DCB ADDRESS            000G 45300016
         ST    WK3,RECADDR              SAVE ADDRESS OF RECORD     000G 45600016
         MVI   DOUBLE+5,X'11'          UNLOAD DCB INDICATOR        000G 45900016
         B     FXREC                                                    46200016
*                                                                     * 46500016
*  THIS SECTION GETS A LOGICAL RECORD,SAVES THE ADDRESS, AND THE LEN- * 46800016
*GTH OF THE RECORD.                                                   * 47100016
*                                                                     * 47400016
OBTAIN1  GET   DCBAR1                  GET RECORD ADDRESS          000G 47700016
         ST    GETREG,RECADDR           SAVE ADDRESS OF RECORD     000G 48000016
         XC    DOUBLE+5(1),DOUBLE+5     CLEAR DCB UNLOAD INDICATOR 000G 48300016
         ST    PARA0,DOUBLE                                        000G 48600016
         MVC   REENTAR+34(2),DCBLRECL   SAVE RECORD LENGTH         000G 48900016
*                                                                     * 49200016
*  THIS SECTION PROCESSES A RECORD ACCORDING TO THE RECORD FORMAT. THE* 49500016
*ADDRESS OF THE RECORD IS PLACED IN REGISTER ONE; THE LENGTH OF THE   * 49800016
*RECORD IN REGISTER ZERO FOR THE IEBISSO SUBROUTINE.                  * 50100016
*                                                                     * 50400016
         CLI   DOUBLE+6,X'01'           IS RECORD FORMAT FIXED     000G 50700016
         BE    FXREC                         YES,BRANCH                 51000016
         CLI   DOUBLE+6,X'11'           UNBLOCKED RECORDS          000G 51300016
         BE    ADDKEY                                                   51600016
         CLI   DOUBLE+6,X'00'           CHECK FOR FIXED BLOCKED         51900016
         BE    FXREC                    YES,FIXED BLOCKED               52200016
         L     WK3,RECADDR              GET RECORD ADDRESS         000G 52500016
         MVC   REENTAR+34(2),0(WK3)    SAVE CURRENT RECORD LENGTH  IV0I 53400018
         ST    WK3,RECADDR              SAVE ADDRESS OF RECORD     000G 54300016
FXREC    LH    PARA0,REENTAR+34         LOAD RECORD LENGTH         000G 54600016
         L     PARA1,RECADDR            LOAD RECORD ADDRESS        000G 54900016
         B     OUSE                                                     55200016
ADDKEY   SR    WK3,WK3                                                  55500016
         IC    WK3,DOUBLE+4             GET KEY LENGTH             000G 55800016
         AH    WK3,REENTAR+34           ADD KEY LENGTH TO          000G 56100016
         STH   WK3,REENTAR+34            RECORD LENGTH             000G 56400016
         B     FXREC                                                    56700016
OUT      LA    WK3,0                         SET MESSAGE NUMBER FOR OK  57000016
         LH    PARA0,EIGHT                                              57300016
         MVI   DOUBLE+5,X'FF'           INDICATE END OF INPUT      000G 57600016
         L     LINKRG,VSSO                   LOAD IEBISSO ADDRESS       57900016
         BALR  RETREG,LINKRG                 BRANCH TO IEBISSO          58200016
         LA    WK3,0                                                    58500016
         B     EXIT                          END OF INPUT DATA;GO CLOSE 58800016
RUIN     LA    WK3,2                   SYNAD ROUTINE ENTERED       000G 59100016
         TM    DCBEXCD2,X'20'                CLOSE BIT ON?              59400016
         BCR   7,RETREG                 RETURN TO CLOSE                 59500016
         SYNADAF ACSMETH=QISAM,PARM1=DCBAR1,PARM2=(0)              000G 59600016
         MVC   MESSAGE+8(79),49(PARA1)    MOVE IN MESSAGE          000G 59700016
         SYNADRLS                                                  000G 59800016
         MVC   REENTAR(EIGHT-CLOSEL),CLOSEL  MOVE L FORM OF CLOSE  000G 59900016
         CLOSE (DCBAR2),MF=(E,REENTAR)   CLOSE OUTPUT CATA SET     000G 60000016
         B     SETAS                    RETURN TO CLOSE OUT             60200016
*  CONSTANTS                                                          * 60600016
*                                                                     * 60900016
OPENL    OPEN  (,INPUT),MF=L                                       000G 61200016
CLOSEL   CLOSE (,DISP),MF=L                                        000G 61500016
EIGHT    DC    H'8'                          COMPLETION CODE CONSTANT   61800016
VSSO     DC    V(IEBISSO)         IEBISSO SYMBOLIC ENTRY                62100016
H16      DC    H'16'                                                    62400016
DCBISU   DCB   DSORG=IS,MACRF=GL,DDNAME=SYSUT1,                        *62700016
               SYNAD=RUIN,EODAD=OUT                                     63000016
LABEL    DS    0F                                                  000G 63300016
         DCBD  DSORG=(IS)                                               63600016
IEBWORK  DSECT                                                          63900016
SAVE1    DS    1F                                                       64200016
SAVE1BK  DS    1F                                                       64500016
SAVE1FD  DS    1F                                                       64800016
         DS    15F                                                      65100016
SAVE2    DS    1F                                                       65400016
SAVE2BK  DS    1F                                                       65700016
SAVE2FD  DS    1F                                                       66000016
         DS    15F                                                      66300016
SAVE3    DS    1F                                                       66600016
SAVE3BK  DS    1F                                                       66900016
SAVE3FD  DS    1F                                                       67200016
         DS    15F                                                      67500016
*IEHISR WORKAREA                                                        67800016
ISINVOK  DS    F                        ADDRESS OF PARAMETER LIST AT    68100016
*                                          INVOCATION                   68400016
ISPRINT  DS    2F                       DDNAME FOR SYSPRINT             68700016
ISUT1    DS    2F                       DDNAME FOR SYSUT1               69000016
ISUT2    DS    2F                       DDNAME FOR SYSUT2               69300016
ISCOMP   DS    H                        COMPLETION CODE                 69600016
ISMESS   DS    H                        MESSAGE NUMBER                  69900016
ISPAGE   DS    H                        PAGE NUMBER FOR SYSPRINT        70200016
ISCNTRL  DS    CL1                      CONTROL BYTE                    70500016
* MASKS FOR TESTING CONTROL BYTE - ISCONTRL                             70800016
ISSWC    EQU   X'80'                    COPY                            71100016
ISSWU    EQU   X'40'                    UNLOAD                          71400016
ISSWL    EQU   X'20'                    LOAD                            71700016
ISSWP    EQU   X'10'                    PRINT                           72000016
ISSWN    EQU   X'08'                    NO CONVERT REQUESTED            72300016
ISSWPI   EQU   X'04'                    PRINT INDEX                     72600016
ISSWPP   EQU   X'02'                    PRINT PRIME                     72900016
ISSWPO   EQU   X'01'                    PRINT OVERFLOW                  73200016
ALLMASK  EQU   X'07'                                               000G 73500016
ISSWITCH DS    CL1                      EXTRANEOUS SWITCHES             73800016
FIRSTTM  EQU   X'80'                    FIRST TIME SWITCH               74100016
*                                                                       74400016
XCTLAREA DS    2F                                                       74700016
WHICH    DS    2F                                                       75000016
ALIGN    DS    1F                                                       75300016
DOUBLE   DS    1D                                                       75600016
EXITADDR DS    2F                                                       75900016
REENTAR  DS    9F                                                       76200016
DCBAR1   DS    64F                                                      76500016
DCBAR2   DS    64F                                                      76800016
MESSAGER DS    CL1                                                 000G 77100016
MESSAGE  DS    CL120                                                    77400016
RECADDR  DS    1F                                                  000G 77700016
         DS    0D                                                       78000016
QISAM    DS    CL250                    UNLOADED DCB WORK AREA          78300016
HEADERC  DS    CL1                                                      78600016
HEADERT  DS    CL144                    HEADER AREA                     78900016
TARGET   DS    2F                       DATE HOLD AREA                  79200016
PAGENO   DS    1F                       HOLD PAGE NUMBER FOR A HEADING  79500016
PAGEPTR  DS    1F                       HOLD POINTER TO WHERE PAGE      79800016
*                                       NUMBER IS TO BE PLACED          80100016
         END                                                            80400016
