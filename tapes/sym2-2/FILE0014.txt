./  ADD  SSI=31230559,NAME=IEBCONH2
*              TITLE 'GENERATE UTILITY- H SET TRANSLATION SUBROUTINE'   00020000
*                                                                       00040000
* THIS SUBROUTINE CONVERTS DATA FROM H-SET BCD TO EBCDIC CHARACTERS.    00060000
* IT CONVERTS ANY LENGTH FIELD. IT USES TR INSTRUCTION AND TRANSLATES   00080000
* 256 BYTES AT A TIME                                                   00100000
*                                                                       00120000
*        *                                                              00140000
*        *     CALL  HSETR,(ADDRESS,LENGTH)                             00160000
*        *          ADDRESS IS A CORE LOC. CONTAINING THE FIELD ADDRESS 00180000
*        *          LENGTH IS A CORE LOCATION CONTAINING THE LENGTH     00200000
*        *          OF THE FIELD (ONE WORD,ALIGNED)                     00220000
*        *                                                              00240000
*        *     RETURN CODE IN R15 IS NO. OF BYTES CONVERTED             00260000
*        *                                                              00280000
IEBCONH2 CSECT                                                          00300000
HSETR    SAVE  (14,12)                 SAVE REGS 14-12                  00320000
         LR    2,15                    INITIALIZE BASE REG2             00340000
         USING HSETR,2                                                  00360000
         L     3,4(1)                  LOAD LENGTH                      00380000
         L     15,0(3)                 IN REG 15                        00400000
         LTR   15,15                   LENGTH GR THAN 0?                00420000
         BP    HSETR1                  YES                              00440000
         SR    15,15                   NO- CLEAR REG 15                 00460000
HSETRX   RETURN (2,12)                 RESTORE REGS 2-12 AND RETURN     00480000
HSETR1   L     3,0(1)                  LOAD FIELD ADDRESS               00500000
         L     4,0(3)                  IN REG 4                         00520000
         LR    5,15                    LOAD LENGTH INTO REG 5           00540000
HSETR2   CH    5,HH256                 LENGTH GR THAN 256 BYTES?        00560000
         BH    HSETR4                  YES                              00580000
         BCTR  5,0                     NO- REDUCE LENGTH BY 1           00600000
         STC   5,HSETR3+1              STORE EXACT LENGTH IN TR INSTR.  00620000
HSETR3   TR    0(1,4),HSETRT           TRANSLATE EXACT NUMBER OF BYTES  00640000
         B     HSETRX                                                   00660000
HSETR4   TR    0(256,4),HSETRT         TRANSLATE 256 BYTES              00680000
         SH    5,HH256                 REDUCE LENGTH BY 256 BYTES       00700000
         AH    4,HH256                 ADVANCE FIELD ADDR BY 256 BYTES  00720000
         B     HSETR2                                                   00740000
*                                                                       00760000
* TRANSLATION TABLE *                                                   00780000
*                                                                       00800000
HSETRT   DC    X'000102030405060708090A0B0C0D0E0F'                      00820000
         DC    X'101112131415161718191A1B1C1D1E1F'                      00840000
         DC    X'202122232425262728292A2B2C2D2E2F'                      00860000
         DC    X'303132333435363738393A3B3C3D3E3F'                      00880000
         DC    X'404142434445464748494A4B5D4D4C4F'                      00900000
         DC    X'4E5152535455565758595A5B5C5D5E5F'                      00920000
         DC    X'606162636465666768696A6B4D6D6E6F'                      00940000
         DC    X'707172737475767778797A7E7D7A6E7F'                      00960000
         DC    X'808182838485868788898A8B8C8D8E8F'                      00980000
         DC    X'909192939495969798999A9B9C9D9E9F'                      01000000
         DC    X'A0A1A2A3A4A5A6A7A8A9AAABACADAEAF'                      01020000
         DC    X'B0B1B2B3B4B5B6B7B8B9BABBBCBDBEBF'                      01040000
         DC    X'6FC1C2C3C4C5C6C7C8C9CACBCCCDCECF'                      01060000
         DC    X'5AD1D2D3D4D5D6D7D8D9DADBDCDDDEDF'                      01080000
         DC    X'E0E1E2E3E4E5E6E7E8E9EAEBECEDEEEF'                      01100000
         DC    X'F0F1F2F3F4F5F6F7F8F9FAFBFCFDFEFF'                      01120000
*                                                                       01140000
*CONSTANT                                                               01160000
*                                                                       01180000
HH256    DC    H'256'                                                   01200000
         ENTRY HSETR                                                    01220000
         END                                                            01240000
./  ADD  SSI=31230560,NAME=IEBCONP2
*                   TITLE 'GENERATE UTILITY- PZ CONVERSION SUBROUTINE'  00020000
*                                                                       00040000
* THIS SUBROUTINE CONVERTS THE DATA FROM PACKED TO ZONED DECIMAL FORMAT 00060000
* THE CONVERSION PROCEEDS FROM RIGHT TO LEFT.                           00080000
*        *                                                              00100000
*        *     CALL  HPZ,(ADDRESS,LENGTH)                               00120000
*        *          ADDRESS IS A WORD IN CORE CONTAINING THE            00140000
*        *          LOCATION OF THE NUMBER                              00160000
*        *          LENGTH IS A WORD IN CORE CONTAINING THE             00180000
*        *          LENGTH IN BYTES OF THE NUMBER                       00200000
*        *                                                              00220000
*        *     RETURN IN R15 IS NO. OF BYTES OF OUTPUT,OR ZERO          00240000
*        *     IF NO CONVERSION IS MADE                                 00260000
*        *                                                              00280000
IEBCONP2 CSECT                                                          00300000
HPZ      SAVE  (14,7)                   SAVE REGS  14-7                 00320000
         LR    2,15                     INITIALIZE BASE REG 2           00340000
         USING HPZ,2                                                    00360000
         LM    3,4,0(1)                 LOAD ADRS OF LOCS CONT. NO & LN 00380000
         L     4,0(4)                   LOAD LENGTH IN REG4             00400000
         SR    15,15                    CLEAR REG 15                    00420000
         SR    15,15                                                    00440000
         LTR   4,4                      TEST FOR LENGTH GT ZERO.IF NOT, 00460000
         BP    HPZ2                     EXIT WITH RETURN CODE ZERO      00480000
HPZX     RETURN (2,7)                                                   00500000
HPZ2     L     3,0(3)                   ADDRESS IN REG3                 00520000
         LR    5,4                      LENGTH IN REG5                  00540000
         SLL   5,1                      COMPUTE OUTLENGTH=2*INLEN-1     00560000
         BCTR  5,0                                                      00580000
         LR    15,5                     OUTLENGTH IN REG5 AND REG15     00600000
         BCTR  5,0                      LOW-ORDER OUTPUT BYTE ADDRESS   00620000
         AR    5,3                      INTO REG5                       00640000
         BCTR  4,0                      LOW-ORDER INPUT BYTE ADDRESS    00660000
         AR    4,3                      INTO REG4                       00680000
         SR    6,6                                                      00700000
         SR    7,7                      CLEAR GP REG 7                  00720000
         IC    6,0(4)                   SIGN BYTE INTO REG6 AND REG7    00740000
         LR    7,6                                                      00760000
         SLL   6,4                      SIGN TO TOP OF BYTE             00780000
         SRL   7,4                      DIGIT TO BOTTOM OF BYTE         00800000
         AR    6,7                      INVERT SIGN AND DIGIT OF BYTE   00820000
         STC   6,0(5)                   STORE NEW BYTE IN LOW OUTPT POS 00840000
HPZ3     CR    4,5                      CURRENT BYTE= HIGH ORDER BYTE?  00860000
         BE    HPZX                     YES, EXIT                       00880000
         BCTR  4,0                      DECREMENT XRS 4 AND             00900000
         BCTR  5,0                      5  BY 1                         00920000
         MVN   0(1,5),0(4)              MOVE SECOND INPUT DIGIT TO OUTP 00940000
         OI    0(5),X'F0'               INSERT ZONE                     00960000
         BCTR  5,0                      DECREMENT REG 5 BY 1            00980000
         IC    6,0(4)                                                   01000000
         SRL   6,4                      SHIFT DIGIT                     01020000
         STC   6,0(5)                   MOVE FIRST INPUT DIGIT TO OUTPT 01040000
         OI    0(5),X'F0'               INSERT SIGN                     01060000
         B     HPZ3                                                     01080000
         ENTRY HPZ                                                      01100000
         END                                                            01120000
./  ADD  SSI=31230564,NAME=IEBCONZ2
*                   TITLE 'GENERATE UTILITY- ZP CONVERSION SUBROUTINE'  00020000
*                                                                       00040000
* THIS SUBROUTINE CONVERTS DATA FROM ZONED TO PACKED DECIMAL FORMAT.    00060000
* THE CONVERSION PROCEEDS FROM LEFT TO RIGHT.                           00080000
*        *                                                              00100000
*        *     CALL  HZP,(ADDRESS,LENGTH)                               00120000
*        *          ADDRESS IS A WORD IN CORE CONTAINING THE            00140000
*        *          LOCATION OF THE NUMBER                              00160000
*        *          LENGTH IS A WORD IN CORE CONTAINING THE             00180000
*        *          LENGTH IN BYTES OF THE NUMBER                       00200000
*        *                                                              00220000
*        *     RETURN IN R15 IS NO. OF BYTES OF OUTPUT,OR ZERO IF       00240000
*        *     NO CONVERSION IS MADE                                    00260000
*        *                                                              00280000
IEBCONZ2 CSECT                                                          00300000
HZP      SAVE  (14,9)                   SAVE REGS 14-9                  00320000
         LR    2,15                     INITIALIZE BASE REG 2           00340000
         USING HZP,2                                                    00360000
         LM    3,4,0(1)                 LOAD ADRS OF LOCS CONT. NO & LN 00380000
         L     5,0(4)                   LENGTH IN REG5                  00400000
         SR    15,15                                                    00420000
         LTR   5,5                      TEST FOR LENGTH GT ZERO.IF NOT, 00440000
         BP    HZP2                     EXIT WITH RETURN CODE ZERO      00460000
HZPX     RETURN (2,9)                                                   00480000
HZP2     L     6,0(3)                   ADDRESS IN REG6                 00500000
         LR    7,6                      AND REG7                        00520000
         LA    5,2(5)                   COMPUTE OUTLENGTH=(INLEN+2)/2   00540000
         SRL   5,1                                                      00560000
         LR    15,5                     OUTLENGTH IN REG5 AND REG15     00580000
         TM    3(4),X'01'               TEST FOR ODD LENGTH             00600000
         BO    HZP3                     IF EVEN,INITIALIZE REG6 TO      00620000
         BCTR  6,0                      INSERT LEADING ZERO             00640000
         SR    8,8                                                      00660000
         B     HZP4                                                     00680000
HZP3     IC    8,0(6)                   GET INPUT BYTE                  00700000
         SLL   8,4                      MOVE DIGIT TO TOP OF BYTE       00720000
HZP4     BCT   5,HZP4A                  SPECIAL PROCEDURE FOR LAST BYTE 00740000
         B     HZP5                                                     00760000
HZP4A    NI    1(6),X'0F'               ZERO ZONE OF NEXT BYTE          00780000
         IC    9,1(6)                   INSERT DIGIT OF NEXT BYTE IN R9 00800000
         ALR   8,9                      REG8= PACKED BYTE               00820000
         STC   8,0(7)                   STORE PACKED BYTE IN OUTPUT     00840000
         LA    6,2(6)                   INCREMENT XRS FOR               00860000
         LA    7,1(7)                   NEXT BYTE                       00880000
         B     HZP3                                                     00900000
HZP5     SR    9,9                      FOR LAST BYTE,                  00920000
         IC    9,0(6)                   INVERT SIGN AND DIGIT           00940000
         SRL   9,4                                                      00960000
         AR    8,9                                                      00980000
         STC   8,0(7)                   STORE SIGN BYTE IN OUTPUT       01000000
         B     HZPX                     RETURN                          01020000
         ENTRY HZP                                                      01040000
         END                                                            01060000
./  ADD  SSI=31230579,NAME=IEBEDIT2
*                   TITLE 'GENERATE UTILITY - EDIT SUBROUTINE'          00020000
*                                                                       00040000
* THIS SUBROUTINE MOVES THE LOGICAL RECORDS FROM THE INPUT BUFFER TO    00060000
* THE OUTPUT BUFFER AND INITIATES REQUESTED CONVERSION OF EACH FIELD.   00080000
* PARAMETERS FOR MOVING AND CONVERSION COME FROM THE END DATA CONTROL   00100000
* BLOCKS- EDCB'S FOR THE CURRENT RECORD GROUP.                          00120000
*        *                                                              00140000
*        *     CALL  HEDIT,(CUREDCB,OUTAREA,INAREA,LENGTH,LITTAB)       00160000
*        *          CUREDCB IS A POINTER TO THE CURRENT EDCB            00180000
*        *          OUTAREA IS A POINTER TO THE OUTPUT AREA             00200000
*        *          INAREA IS A POINTER TO THE INPUT AREA               00220000
*        *          LENGTH CONTAINS THE INPUT RECORD LENGTH             00240000
*        *          LITTAB (OPTIONAL) IS A POINTER TO THE LITERAL TABLE 00260000
*        *                                                              00280000
*6017                                                             10651 00290014
IEBEDIT2 CSECT                                                          00300000
HEDIT    SAVE  (14,12)                 SAVE REGS 14 THRU 12             00320000
         LR    2,15                    INITIALIZE BASE REG 2            00340000
         USING HEDIT,2                                                  00360000
         STM   13,14,HSAVE13           SAVE REGS13,14                   00380000
         LA    3,HEDRS                                                  00400000
         ST    3,8(13)                                                  00420000
         LA    13,HEDRS                                                 00440000
         LR    12,1                    LOAD PARAM LIST ADDR IN R12      00460000
         L     3,0(12)                  LOAD ADDRESS OF CURRENT         00480000
         L     4,0(3)                   EDCB INTO R4                    00500000
HEDIT1   LH    5,HECBL(4)              LOAD EDCB INPUT LENGTH AND       00520000
         ST    5,HLEN                  STORE IN HLEN                    00540000
         L     3,4(12)                 LOAD ADDRESS OF OUTPUT AREA      00560000
         L     5,0(3)                  IN R5                            00580000
         AH    5,HOUST(4)              COMPUTE OUTPUT ADDRESS AND       00600000
         ST    5,HTO                   STORE IN HTO                     00620000
         TM    HLB(4),HLTMSK           CHECK IF LITERAL IS PRESENT?     00640000
         BZ    HEDIT2                  NO                               00660000
         L     3,16(12)                LOAD POINTER TO LITERAL TAB ADDR 00680000
         B     HEDIT3                                                   00700000
HEDIT2   L     3,8(12)                 LOAD POINTER TO INPUT AREA ADDR  00720000
HEDIT3   L     5,0(3)                  LOAD LITR TAB/INPUT AREA ADDR    00740000
         LH    6,HINST(4)                                               00760000
         AR    5,6                     COMPUTE INPUT LOCATION AND       00780000
         ST    5,HFR                   STORE IN HFR                     00800000
         TM    HCVB(4),HCXMSK          CHECK IF ZP CONVERSION IS REQD?  00820000
         BZ    HEDIT3B                 NO                               00840000
         TM    HLB(4),HLTMSK       IS THIS A LITERAL              10651 00841014
         BZ    HEDIT3C             NO                             10651 00842014
         ST    6,LITSAVE+40        SAVE REGISTER SIX              10651 00843014
         L     6,HLEN              LEHGTH OF LITERAL              10651 00844014
         BCTR  6,0                                                10651 00845014
         EX    6,ABC               MOVE LITERAL                   10651 00846014
         LA    6,LITSAVE           ADDRESS OF LITERAL             10651 00847014
         ST    6,HFR               NEW INPUT LOCATION             10651 00848014
         L     6,LITSAVE+40        RESTORE REGISTER SIX           10651 00849014
HEDIT3C  EQU   *                                                  10651 00850014
         CALL  HZP,(HFR,HLEN)          CONVERT ZONED TO PACKED DECIMAL  00860000
         ST    15,HLEN                 STORE NEW LENGTH IN HLEN         00880000
HEDIT3B  CALL  HMOVE,(HTO,HFR,HLEN)    MOVE FIELD TO OUTPUT AREA        00900000
         LTR   15,15                                                    00920000
         BZ    HEDIT7                                                   00940000
         TM    HCVB(4),HCVMSK          PZ CONVERSION REQD?              00960000
         BO    HEDIT4                  YES                              00980000
         TM    HCVB(4),HCWMSK          HE CONVERSION REQD?              01000000
         BO    HEDIT5                  YES                              01020000
         B     HEDIT7                  NO                               01040000
HEDIT4   CALL  HPZ,(HTO,HLEN)          CONVERT PACKED TO ZONED DECIMAL  01060000
         B     HEDIT7                                                   01080000
HEDIT5   CALL  HSETR,(HTO,HLEN)        CONVERT H-SET BCD TO EBCDIC      01100000
HEDIT7   TM    HLFB(4),HLFMSK          CHECK IF IT IS LAST FIELD OF REC 01120000
         BO    HEDIT8                  YES                              01140000
         LA    4,8(0,4)                UPDATE REG4 FOR NEXT EDCB        01160000
         B     HEDIT1                                                   01180000
HEDIT8   LM    13,14,HSAVE13           RESTORE REGS 13,14               01200000
         RETURN (2,12)                RESTORE REGS 2-12 AND RETURN      01220000
ABC      MVC   LITSAVE(1),0(5)                                    10651 01230014
*                                                                       01240000
* CONSTANTS                                                             01260000
*                                                                       01280000
HTO      DS    1F                      LOC TO STORE OUTPUT ADDR         01300000
HFR      DS    1F                      LOC TO STORE INPUT ADDR          01320000
HLEN     DS    1F                      LOC TO STORE INPUT LENGTH        01340000
HEDRS    DS    18F                                                      01360000
HSAVE13  DS    2F                      REGS 13,14 SAVE AREA             01380000
LITSAVE  DS    11F                 LITERAL AREA                   10651 01390014
HCVB     EQU   0                       EDCB DISPLACEMENT FOR CONVERSION 01400000
HLFB     EQU   0                       EDCB DISPLACEMENT FOR LAST FIELD 01420000
HLB      EQU   0                       EDCB DISPLACEMENT FOR LITERAL    01440000
HINST    EQU   2                                                        01460000
HECBL    EQU   4                                                        01480000
HOUST    EQU   6                                                        01500000
HCWMSK   EQU   X'20'                   HE CONVERSION MASK               01520000
HCVMSK   EQU   X'10'                   PZ CONVERSION MASK               01540000
HCXMSK   EQU   X'08'                   ZP CONVERSION MASK               01560000
HLTMSK   EQU   X'40'                   LITERAL       MASK               01580000
HLFMSK   EQU   X'80'                   LAST FIELD    MASK               01600000
         ENTRY HEDIT                                                    01620000
         END                                                            01640000
./  ADD  SSI=71290008,NAME=IEBGENRT
*********************************************************************** 00020000
*                                                                     * 00040000
*                   * * *  I E B G E N E R  * * *                     * 00060000
*                                                                     * 00080000
*                         * * * * * * * * *                           * 00100000
*                                                                     * 00120000
*      THIS ROUTINE IS THE ROOT SEQMENT OF THE GENERATE UTILITY.      * 00140000
*      IT INITIALIZES SWITCHES, PROCESSES OR STORES INTERNAL PAR-     * 00160000
*      AMETERS, STORES OVERLAY PARAMETERS, WRITES HEADER, CONTROL     * 00180000
*      CARDS AND ERROR MESSAGES FOR ANALYSIS AND PROCESSING SEG-      * 00200000
*      MENTS AND GOVERNS FLOW OF CONTROL BETWEEN SEGMENTS.IT CON-     * 00220000
*      SISTS OF THE FOLLOWING FOUR SUBROUTINES:                       * 00240000
*                                                                     * 00260000
*              1.INITIALIZATION SUBROUTINE                            * 00280000
*              2.INTERNAL PARAMETER ANALYZER SUBROUTINE               * 00300000
*              3.MESSAGE WRITER SUBROUTINE                            * 00320000
*              4.CONTROL CARD WRITER SUBROUTINE                       * 00340000
*                                                                     * 00360000
*      A DETAILED DESCRIPTION OF EACH  SUBROUTINE PRECEDES  CODE      * 00380000
*      FOR THAT SUBROUTINE AS IT OCCURS IN THE CSECT.                 * 00400000
*                                                                     * 00420000
*                         * * * * * * * * *                           * 00440000
*                                                                     * 00460000
*                             E N T R Y                               * 00480000
*                                                                     * 00500000
*      THIS ROUTINE HAS EXTERNALLY REFERENCABLE VALUES  OR  NAMES     * 00520000
*      WHOSE SYMBOLS AND FUNCTIONS ARE:                               * 00540000
*                                                                     * 00560000
*                          I E B G E N E R                            * 00580000
*                                                                     * 00600000
*              THE ENTRY POINT TO THE UTILITY AND NAME                * 00620000
*              BY WHICH IT MAY BE CALLED FROM  LIBRARY.               * 00640000
*                                                                     * 00660000
*                          G E N E R A T E                            * 00680000
*                                                                     * 00700000
*              A SYNONYM FOR I E B G E N E R  AFTER THE               * 00720000
*              UTILITY IS LOADED IN MAIN STORAGE.                     * 00740000
*                                                                     * 00760000
*                            H W R M S G                              * 00780000
*                                                                     * 00800000
*              ENTRY TO THE MESSAGE WRITER SUBROUTINE.                * 00820000
*                                                                     * 00840000
*                             H C D W R                               * 00860000
*                                                                     * 00880000
*              ENTRY TO CONTROL CARD WRITER SUBROUTINE.               * 00900000
*                                                                     * 00920000
*********************************************************************** 00940000
         EJECT                                                          00960000
*********************************************************************** 00980000
*                                                                     * 01000000
*                             I N P U T                               * 01020000
*                                                                     * 01040000
*              TO BE CALLED FROM LIBRARY AND  EXECUTED,               * 01060000
*              THE  FOLLOWING  PARAMETERS  AND POINTERS               * 01080000
*              MUST BE SET UP BY THE INVOKING PROGRAM:                * 01100000
*                                                                     * 01120000
*              1.REGISTER 1 POINTS TO A THREE WORD LIST               * 01140000
*                                                                     * 01160000
*              2.THREE WORD LIST SET UP WITH HIGH ORDER               * 01180000
*                BYTE OF EACH WORD X'00'   EXCEPT  LAST               * 01200000
*                VALID POINTER WHICH IS X'80' AND WHERE               * 01220000
*                                                                     * 01240000
*                WORD 1 POINTS TO PARAMETER LIST---(NOT               * 01260000
*                USED)                                                * 01280000
*                WORD 2 POINTS TO DDNAME LIST OF DOUBLE               * 01300000
*                WORD ENTRIES POSITIONALLY DEPENDENT:                 * 01320000
*                                                                     * 01340000
*                          1.NOT USED                                 * 01360000
*                          2.NOT USED                                 * 01380000
*                          3.NOT USED                                 * 01400000
*                          4.NOT USED                                 * 01420000
*                          5.SYSIN                                    * 01440000
*                          6.SYSPRINT                                 * 01460000
*                          7.NOT USED                                 * 01480000
*                          8.SYSUT1                                   * 01500000
*                          9.SYSUT2                                   * 01520000
*                                                                     * 01540000
*                WORD 3 PERTAINS TO HEADER INFORMATION.               * 01560000
*********************************************************************** 01580000
         EJECT                                                          01600000
*********************************************************************** 01620000
*                                                                     * 01640000
*                             E X T R N                               * 01660000
*                                                                     * 01680000
*      THE ROOT SEGMENT REFERENCES THESE EXTERNALLY DEFINED NAMES     * 01700000
*      OR VALUES:                                                     * 01720000
*                               C C A                                 * 01740000
*                                                                     * 01760000
*              ENTRY TO THE CONTROL CARD ANALYZER SEG-                * 01780000
*              MENT (SEGMENT1).                                       * 01800000
*                                                                     * 01820000
*                            I E B G E N R 3                       VS0H 01840017
*                                                                     * 01860000
*              ENTRY TO THE PROCESSING SEGMENT (SEGMENT               * 01880000
*              2).                                                    * 01900000
*                           H M S G M D L                             * 01920000
*                                                                     * 01940000
*              THE ADDRESS OF THE STANDARD HEADER LINE.               * 01960000
*                                                                     * 01980000
*                         * * * * * * * * *                           * 02000000
*                                                                     * 02020000
*                   E R R O R   C O N D I T I O N                     * 02040000
*                                                                     * 02060000
*      ERRORS IN THE FORMAT OF THE INPUT PARAMETER  LISTS  RESULT     * 02080000
*      IN THE PRINTING OF A DIAGNOSTIC MESSAGE AND TERMINATION OF     * 02100000
*      PROCESSING AND RETURN VIA REGISTER 14.                         * 02120000
*                                                                     * 02140000
*                         * * * * * * * * *                           * 02160000
*                                                                     * 02180000
*                             N O T E S                               * 02200000
*                                                                     * 02220000
*      THIS ROUTINE, AND THE GENERATE UTILITY IN GENERAL,IS 'ONLY     * 02240000
*      LOADABLE'.IT IS NOT RE-ENTRANT.IT IS NOT RE-USABLE.            * 02260000
*                                                                     * 02280000
*********************************************************************** 02300000
         EJECT                                                          02320000
*                   INITIALIZATION ROUTINE                              02340000
*                                                                       02360000
* THIS ROUTINE IS EXECUTED EVERY TIME THE GENERATE PROGRAM IS EXECUTED. 02380000
* IT SETS SWITCHES, ASSIGNS DATA AREAS, ANALYZES LINKAGE PARAMETERS,    02400000
* OPENS SYSPRINT AND WRITES THE HEADER LINE WITH A USER SUPPLIED        02420000
* INITIAL NUMBER (IF ANY) ON SYSPRINT.                                  02440000
*                                                                       02460000
IEBGENER CSECT                                                          02480000
*A49604-49608,77320                                             YM00576 02480402
*C49620                                                         YM00576 02480802
*0000034200,073400-073600,077600-077800                            BS0H 02482017
*0000037000,039200,045400-046000,046400-046600,0469-047100,        UL0H 02482517
*0000047500,047700                                                 UL0H 02483017
*0000039600                                                        VS0H 02483517
*                                                                A23819 02483718
*                                                                A27717 02484119
*                                                                A28753 02484519
*                                                                A29000 02484919
*                                                                A30296 02485319
*A034101,034102,034103                                          YA01223 02485500
*056440,059350                                                   A38715 02485721
*A040102-040168,043100,077300                                    A45131 02485821
*C037000,039200,050400                                           A45131 02485921
*A034106-034142                                                  A48746 02486021
*C035400                                                         A48746 02486121
*A028700-028720                                                @ZA13753 02487700
R0       EQU   0                                                   BS0H 02491221
R1       EQU   1                                                        02492817
R2       EQU   2                                                        02494417
R3       EQU   3                                                        02496017
R4       EQU   4                                                   BS0H 02497617
R5       EQU   5                                                   BS0H 02499217
R6       EQU   6                                                   BS0H 02500817
R7       EQU   7                                                   BS0H 02502417
R8       EQU   8                                                   BS0H 02504017
R9       EQU   9                                                        02505617
R10      EQU   10                                                       02507217
R11      EQU   11                                                       02508817
R12      EQU   12                                                       02510417
R13      EQU   13                                                       02512017
RETREG   EQU   14                                                  BS0H 02513617
R14      EQU   14                                                       02515217
R15      EQU   15                                                       02516817
GENERATE SAVE  (14,12)                                                  02518400
         BALR  R2,0                                                     02520017
         USING IHADCB,8                                                 02540000
         USING *,R2                                                     02560017
HROOT    STM   R13,R14,HRSAVE13         SAVE 13 AND 14                  02580017
         LA    R13,HGENRS               LOAD SAVE AREA ADDR             02600017
         MVI   ZZCTRL,X'00'                                             02620000
         XC    HDDNAMES(40),HDDNAMES    ZERO OUT USER DD NAME TABLE     02640000
         L     R3,0(R1)      LOAD ADDR OF PARM LIST              PTM36A 02660017
         CLI   0(R1),X'80'              TEST FOR DD PARAMETER           02680017
         BE    HROOT4                   NO                              02700000
         L     R4,4(R1)      YES,LOAD DDNMLIST ADDR              PTM36A 02710017
         LTR   R4,R4                   TEST FOR OMITTED DDNAME   A23819 02713018
         BZ   HROOT2                   PARAMETER,IF ABSENT-BRANCHA23819 02716018
         LH    R8,0(R4)                 YES,STORE DD NAMES IN TABLE     02720017
         LTR   R8,R8                    CHECK IF LENGTH GR THAN ZERO?   02730017
         BC    12,HROOT2                IF 0 OR NEG LENGTH,SKIP         02760000
         LA    R9,72                    SET REG9=72                     02780017
         CR    R8,R9                    REG 8= 72?                      02800017
         BL    HROOT1                   IF R8 LESS THAN 72, BRANCH      02820000
         LR    R8,R9                    OTHERWISE SET R8= LENGTH OF 72  02840017
HROOT1   LA    R9,32                    SET REG9=32                     02860017
         CR    R8,R9         IS LIST SHORTER OR EQUAL TO 32?   @ZA13753 02870000
         BNH   HROOT2        YES,OMITT DDNAME LIST             @ZA13753 02872000
         SR    R8,R9                    REG8= LENGTH-32                 02880017
         BCTR  R8,R0                   DECREMENT REG8 BY 1              02900017
         STC   R8,HROOT1A+1             STORE EXACT LENGTH IN MOVE INST 02920017
HROOT1A  MVC   HDDNAMES(40),34(R4)      MOVE USER DD NAME IN TABLE      02940017
         SR    R8,R8                                                    02960017
         C     R8,HSODD                 TEST FOR NONSTAND DD NAME       02980017
         BE    HROOT2                   FOR SYSOUT                      03000000
         LA    R8,HSYSOUT               STORE NON-STANDARD              03020017
         MVC   DCBDDNAM(8),HSODD       SYSOUT DD NAME                   03040000
HROOT2   CLI   4(R1),X'80'              TEST FOR HDR PARAMETER          03060017
         BE    HROOT4                   NO                              03080000
         L     R5,8(R1)      YES,LOAD HEADER ADDR                PTM36A 03090017
         LH    R8,0(R5)                 YES,STORE HEADER ADDR           03100017
         LA    R9,4                     TEST FOR LENGTH LT 4            03110017
         CR    R8,R9                                                    03120017
         BL    HROOT4                   YES,USE STANDARD PAGE NO        03160000
         MVC   HHDR+103(4),2(R5)        NO,MOVE USER PAGE NO            03180017
         B     HROOT5                                                   03200000
HROOT4   MVC   HHDR+103(4),HC0001       MOVE STANDARD PAGE NO           03220000
HROOT5   LA    R8,HMSGHDR               SET REG8=0                      03240017
         SLL   R8,2                                                     03260017
         A     R8,HMSGMDLA              GET STANDARD HEADER             03280017
         L     R8,0(R8)                 ADDRESS IN REG 8                03300017
         MVC   HHDR(40),0(R8)           MOVE STANDARD HEADER            03320017
         OPEN  (HSYSOUT,OUTPUT)         OPEN SYSPRINT                   03340000
         LA    R14,HSYSOUT      ADDRR OF SYSPRINT DCB                   03360017
         TM    OFLGS(R14),X'10'     IS DCB OPEN                         03380017
         LA    R12,12                                            A29000 03390019
         BZ    HROOTX-2       NO IT IS NOT                              03400000
         TM    DFLG,X'10'               CHECK FOR INVALID BLKSIZE  BS0H 03405017
         BC    8,CONTWORK               IF NOT --                  BS0H 03410017
         LA    R0,HEADER          LOAD HEADER ADDRESS           YA01223 03410200
         LA    R1,HHDR            LOAD PRINT ROUTINE ADDRESS    YA01223 03410400
         BAL   R14,ZZPR           PRINT HEADER                  YA01223 03410500
         LA    R1,19              GET ERR MSG TEXT OF IEB319I    A48746 03410621
         SLL   R1,8               SHIFT LEFT                     A48746 03411221
         LA    R9,19              GET MSG IEB319I ID.            A48746 03411821
         AR    R1,R9              SET MAG CODE + ID              A48746 03412421
         LA    R15,HWRMSG         LOAD ERR MSG ID                A48746 03413021
         BALR  R14,R15            BRANCH TO ERROR PRINT          A48746 03413621
         LA    R12,12             LOAD CONDITION CODE IN R12     A48746 03414221
         CLOSE (HSYSOUT)                CLOSE SYSPRINT DCB         BS0H 03415017
         FREEPOOL  HSYSOUT                                         BS0H 03420017
         B     HROOTX-2                 RESTORE REGS AND RETURN    BS0H 03426017
CONTWORK LA    R0,HEADER                                           BS0H 03432017
         LA    R1,HHDR                                                  03442017
         BAL   R14,ZZPR                                                 03452017
         SR    R4,R4                                                    03462017
         LH    R8,0(R3)                 LOAD PARAM LIST LENGTH IN R8    03472017
         CR    R4,R8                    AND CHECK IF IT IS LESS THAN 0? 03482017
         B     HROOT6                   BRANCH                   A48746 03540021
         LA    R1,HMSGIIP               YES,GET ERROR MSG CODE NO.      03560017
         SLL   R1,8                                                     03580017
         LA    R9,2                    GET MSG ID.                 0037 03600017
         AR    R1,R9                    SET MSG CODE+ MSG ID            03620017
         LA    R15,HWRMSG               LOAD ERROR MSG ADDR IN REG 15   03640017
         BALR  R14,R15                  BRANCH TO ERROR MESSAGE         03660017
         B     HRTERMP                  GO TO TERMINATE PROCESSING      03680000
HROOT6   GETMAIN R,LV=104         GET 104 BYTE TABLE AREA        A45131 03700021
         ST    R1,HRTABA                SAVE TABLE ADDR                 03720017
         LA    R4,2                     SET REG 4=2                     03740017
         CR    R8,R4                    PARAM LIST LENGTH LESS THAN 2?  03760017
         BL    HROOT7                   YES, BRANCH                     03780000
         CLC   2(2,R3),HCIN             TEST FOR INTERNAL PARAMETERS    03800017
         BE    HROOT9                   IF INTERNAL PRAM PRESENT,BRANCH 03820000
HROOT7   CALL  CCA,(HSIDD)              ANALYZE INT.PRAM ON CTRL CARD   03840000
         B     HROOT7A                  NORMAL RETURN                   03860000
         B     HRTERMP                  ERROR RETURN                    03880000
HROOT7A  L     R3,HRTABA                                                03900017
         MVC   0(104,R3),0(R1)    MOVE TABLE BUILD BY IEBGSCAN   A45131 03920021
HROOT8   LA    R1,HRTABA                                                03940017
         CALL  IEBGENR3                                            VS0H 03960017
         LR    R12,R15                                                  03980017
         CLOSE (HSYSOUT)                CLOSE SYSPRINT                  04000000
         FREEPOOL  HSYSOUT                                         BS0H 04010017
         L     R3,HRTABA          LOAD TABLE ADDRESS             A45131 04010221
         LTR   R3,R3              DOES TABLE EXIST ?             A45131 04010421
         BZ    HROOTX-2           NO, RETURN TO SYSTEM           A45131 04010621
         TM    INPARM,X'FF'       INTERNAL PARAM PROC. ?         A45131 04010821
         BO    FRHRTABL           YES, DON'T TEST FOR TBL FREEM. A45131 04011021
         LH    R5,96(R3)          LOAD MAXNAME RESERVED CORE     A45131 04011221
         LTR   R5,R5              IS IT ZERO ?                   A45131 04011421
         BZ    TSTCMAXF           YES, TEST FOR MAXFLDS CORE     A45131 04011621
         L     R1,64(R3)          NO, GET ADDR. OF MAXNAME CORE  A45131 04011821
         LR    R0,R5              LOAD CORE LENGTH               A45131 04012021
         FREEMAIN R,LV=(0),A=(1)  MAXNAME CORE                   A45131 04012221
TSTCMAXF LH    R5,98(R3)          LOAD MAXFLDS RESERVED CORE     A45131 04012421
         LTR   R5,R5              IS IT ZERO ?                   A45131 04012621
         BZ    TSTCMAXG           YES, TEST MAXGPS CORE          A45131 04012821
         L     R1,68(R3)          NO, GET ADDRESSS PLUS FOUR     A45131 04013021
         LA    R4,8               CALCULATE                      A45131 04013221
         SR    R1,R4              RIGHT ADDRESS                  A45131 04013421
         LA    R0,8(R5)           LOAD GETMAIN LENGTH            A45131 04013621
         FREEMAIN R,LV=(0),A=(1)  MAXFLDS CORE                   A45131 04013821
TSTCMAXG LH    R5,100(R3)         LOAD MAXGPS RESERVED CORE      A45131 04014021
         LTR   R5,R5              IS IT ZERO ?                   A45131 04014221
         BZ    TSTCMAXL           YES, TEST MAXLITS RESER. CORE  A45131 04014421
         L     R1,72(R3)          NO, GET ADDRESS                A45131 04014621
         LR    R0,R5              LOAD CORE LENGTH               A45131 04014821
         FREEMAIN R,LV=(0),A=(1)  MAXGPS CORE                    A45131 04015021
TSTCMAXL LH    R5,102(R3)         LOAD MAXLITS RESERVED CORE     A45131 04015221
         LTR   R5,R5              IS IT ZERO ?                   A45131 04015421
         BZ    FRHRTABL           YES, FREE TABLE                A45131 04015621
         L     R1,76(R3)          NO, LOAD MAXLITS ADDRESS       A45131 04015821
         LR    R0,R5              LOAD LENGTH                    A45131 04016021
         FREEMAIN R,LV=(0),A=(1)  MAXLITS CORE                   A45131 04016221
FRHRTABL LR    R1,R3              LOAD TABLE ADDRESS             A45131 04016421
         LA    R0,104             LOAD TABLE LENGTH              A45131 04016621
         FREEMAIN R,LV=(0),A=(1)  TABLE CORE                     A45131 04016821
         LR    R15,R12                                                  04020017
HROOTX   LM    R13,R14,HRSAVE13         RESTORE REGS 13-14              04030017
         RETURN (2,12)                  RESTORE REGS 2-12 AND RETURN    04060000
*                                                                  BS0H 04061017
*                  DCB EXIT ROUTINE                                BS0H 04062017
*                                                                  BS0H 04063017
DCBOEXIT LA    R8,HSYSOUT         LOAD ADDRESS OF SYSPRINT DCB     BS0H 04064017
         LH    R5,DCBBLKSI              LOAD BLKSIZE               BS0H 04065017
         LTR   R5,R5                                               BS0H 04066017
         BC    8,FIXBLK                 IF NONE SPECIFIED --       BS0H 04067017
         SR    R4,R4                                               BS0H 04068017
         LH    R6,DCBLRECL                                       A28753 04069019
         DR    R4,R6                    TEST FOR MODULAR BLKSIZE   BS0H 04070017
         LTR   R4,R4                                               BS0H 04071017
         BCR   8,RETREG                 IF MODULAR --              BS0H 04072017
         MVI   DFLG,X'10'               SET BLKSIZE ERROR FLAG     BS0H 04073017
         MVC   DCBBLKSI(2),DCBLRECL     MOVE LRECL TO BLKSIZE      BS0H 04074017
         RETURN                                                         04075017
FIXBLK   MVI   DCBBLKSI+1,X'79'         INSERT BLKSIZE -- 121      BS0H 04076017
         RETURN                                                         04078017
*                                                                       04080000
*                                                                       04100000
*                   INTERNAL PARAMETER ANALYZER ROUTINE                 04120000
*                                                                       04140000
* THIS ROUTINE IS EXECUTED WHEN THE INVOKING ROUTINE SPECIFIES INTERNAL 04160000
* PARAMETERS. IT STORES AND INSPECTS THE PARAMETER TABLES SUPPLIED BY   04180000
* THE INVOKING ROUTINE. BASED ON THE PARAMETERS, IT SETS SWITCHES FOR   04200000
* PROCESSING.                                                           04220000
*                                                                       04240000
*                                                                       04260000
HROOT9   CALL  CCA,(HSIDD),VL           DUMMY CALL                      04280000
         L     R4,HRTABA                                                04300017
         OI    INPARM,X'FF'       SET INTERNAL PARAM. SWITCH     A45131 04310021
         LA    R9,8                     INTERNAL TABLE PROCESSING       04320017
         CR    R9,R8                    IF NO TABLES,TAKE               04340017
         BE    HROOT14                  STANDARD OPTIONS                04360000
         LA    R3,10(,R3)               INCREMENT XR                    04380017
         SR    R8,R8                                                    04400017
         C     R8,0(R3)                                                 04420017
         BNE   HROOT9A                  IF THERE IS NO EXIT TABLE,      04440000
         MVI   0(R4),X'40'              BLANK OUT EXIT AREA             04460017
         MVC   1(63,R4),0(R9)                                           04480017
         B     HROOT10                                                  04500000
HROOT9A  L     R9,0(R3)                 IF THERE IS AN EXIT TABLE,      04520017
         MVC   0(64,R4),0(R9)          MOVE IT TO EXIT AREA        UL0H 04540017
HROOT10  MVC   64(16,R4),4(R3)                                     UL0H 04560017
         XC    93(2,R4),93(R4)                                     UL0H 04580017
HROOT11  C     R8,64(R4)                                           UL0H 04600017
         BE    HROOT12                  IF THERE IS AN MDT ADDR,        04620000
         MVI   94(R4),X'02'            SET PO SWITCH               UL0H 04640017
HROOT12  C     R8,72(R4)                                           UL0H 04660017
         BNE   HROOT13                  IF THERE IS NO EDCB ADDR,       04680000
         OI    93(R4),X'F0'            SET COPY SWITCH             UL0H 04690017
HROOT13  C     R8,68(R4)                                           UL0H 04700017
         OI    93(R4),X'0F'            SET EOD SWITCH              UL0H 04710017
         BNE   HROOT8                   IF THERE IS NO RDT ADDR,        04740000
         MVC   1(63,R4),0(R4)          ZERO OUT ADDRESSES          UL0H 04750017
         XC    64(16,R4),64(R4)        AND                         UL0H 04760017
         XC    93(2,R4),93(R4)         SWITCHES                    UL0H 04770017
         B     HROOT8                                                   04780000
HROOT14  MVI   0(R4),X'40'              BLANK OUT EXITS                 04790017
         SR    R8,R8                                                    04830017
         B     HROOT11                                                  04880000
*                                                                       04900000
HRTERMP  CLOSE (HSYSOUT)                CLOSE SYSPRINT                  04920000
         FREEPOOL  HSYSOUT                                         BS0H 04930017
         LA    R15,12                   LOAD CONCODE                    04940017
         B     HROOTX                                                   04960000
SYSIOERR L     R2,ADDHROOT              ESTAB ADDRESSABILITY    YM00576 04960402
         USING HROOT,R2                                         YM00576 04960802
         SYNADAF ACSMETH=QSAM                                   YM00576 04962002
         MVC   IOERR1+23(26),49(R1)     MSG TO BUFFER            A27717 04964019
         MVC   IOERR2+12(53),75(R1)     PART 2 MSG TO BUFFER     A27717 04966019
         SYNADRLS                                                A27717 04968019
         LA    R1,IOERR1                                         A27717 04970019
         WTO   MF=(E,(1))                                        A27717 04972019
         LA    R1,IOERR2                                         A27717 04974019
         WTO   MF=(E,(1))                                        A27717 04976019
         B     HROOTX                   RETURN TO CALLER         A27717 04978019
*                                                                       04980000
         DS    0F                                                       04982019
OPTL     DC    X'85'                                               BS0H 04985017
         DC    AL3(DCBOEXIT)                                       BS0H 04990017
DFLG     DC    X'00'                                               BS0H 04995017
HRSAVE13 DS    2F                                                       05000000
HGENRS   DS    18F                                                      05020000
HRTABA   DC    F'0'               TABLE ADDRESS                  A45131 05040021
HDDNAMES DS    10F                                                      05060000
HHDR     DS    2C                                                       05080000
         DC    3CL32' '                                                 05100000
         DC    CL22'PAGE 0001'                                          05120000
         DC    AL1(55)                                                  05140000
HCIN     DC    C'IN'                                                    05160000
HC0001   DC    C'0001'                                                  05180000
IOERR1   WTO   'IEB351I I/O ERROR                            ',MF=L,   C05184019
               ROUTCDE=11,DESC=7                                 A27717 05188019
IOERR2   WTO   'IEB351I                                                C05192019
                     ',MF=L,ROUTCDE=11,DESC=7                    A27717 05196019
HSIDD    EQU   HDDNAMES                                                 05200000
HSODD    EQU   HDDNAMES+8                                               05220000
HMSGHDR  EQU   0                                                        05240000
HMSGIIP  EQU   1                                                        05260000
*                                                                       05280000
*                                                                       05300000
*                                                                       05320000
*                   MESSAGE WRITER SUBROUTINE                           05340000
*                                                                       05360000
* THIS SUBROUTINE IS EXECUTED EVERY TIME AN ERROR MESSAGE IS TO BE      05380000
* WRITTEN ON SYSPRINT. IT LOCATES THE PROPER MESSAGE IN THE MESSAGE     05400000
* MODULE AND WRITES IT.                                                 05420000
*                                                                       05440000
*                                                                       05460000
         USING HWRMSG,15                                                05480000
HWRMSG   LR    R0,R1                                                    05500017
         SLL   R0,24                                                    05520017
         SRL   R0,24                                                    05540017
         SRL   R1,6                                                     05560017
         A     R1,HMSGMDLA              MESS ADDR IN R1                 05580017
         L     R1,0(R1)                                                 05600017
         MVC   HMSGAREA+8(62),0(R1)    MOVE MESSAGE                UL0H 05620017
         CH    R0,HW51                 TEST FOR SYNAD MSG        A27717 05626019
         BNE   NORMMSG                 NO - NORMAL MSG           A27717 05632019
         MVI   SYNADIND,X'80'          SET SYNAD SWITCH          A27717 05638019
         MVC   HMSGAREA+70(27),62(R1)  MOVE REST OF SYNAD INF.   A38715 05644021
NORMMSG  C     R6,AST                  EOD MSG                   A27717 05650019
         BE    INAST                                                    05660000
         LA    R1,HMSGAREA              INSERT ID INTO PREFIX           05680017
         CVD   R0,HMDW                  CONVERT ID TO DECIMAL           05700017
         UNPK  HMSGAREA+4(2),HMDW+6(2)  UNPACK DECIMAL ID               05720000
         OI    HMSGAREA+5,X'F0'         REMOVE ZONE                     05740000
         CLI   SYNADIND,X'80'          SYNAD SWITCH SET          A27717 05746019
         BE    SYNMSG                  YES - BRANCH              A27717 05752019
         LA    R0,69                   LOAD LENGTH MINUS ONE       UL0H 05760017
         B     ZZPR                     BRANCH TO SUBROUTINE ZZPR       05780000
SYNMSG   MVI   SYNADIND,X'00'          RESET SYNAD SWITCH        A27717 05785019
         LA    R0,97                   LOAD PROPER MSG LENGTH    A27717 05790019
         B     ZZPR                    WRITE MSG                 A27717 05795019
INAST     LA    R1,HMSGAREA+8                                           05800017
         LA    R0,61                   LOAD LENGTH MINUS ONE       UL0H 05820017
         B     ZZPR                     BRANCH TO SUBROUTINE ZZPR       05840000
HMDW     DS    1D                                                       05860000
HW51     DC    H'51'                   NUMBER OF SYNAD MSG       A27717 05870019
HMSGMDLA DC    V(HMSGMDL)                                               05880000
HMSGAREA DC    C'IEB300I '                                              05900000
         DS    62C                     MESSAGE AREA                UL0H 05920017
         DS    27C      EXTENSION FOR SYNAD MESSAGE              A38715 05922021
SYNADIND DC    X'00'                   SYNAD SWITCH              A27717 05925019
         DS    0H                                                       05935019
         DROP  15                                                       05940000
*                                                                       05960000
*                   CONTROL CARD WRITER SUBROUTINE-                     05980000
*                                                                       06000000
* THIS SUBROUTINE IS EXECUTED EVERY TIME A CONTROL CARD IS READ BY THE  06020000
* CONTROL CARD SCANNER SUBROUTINE - IEBGSCAN. IT WRITES THE CONTROL     06040000
* CARDS ON SYSPRINT.                                                    06060000
*                                                                       06080000
*                                                                       06100000
         USING *,R15                   ESTABLISH BASE                   06120017
HCDWR    LA    R0,79                                                    06140017
         B     ZZPR                                                     06160000
         DROP  15                                                       06180000
*                                                                       06200000
ZZPR     BALR  R15,0                                                    06220017
         USING *,R15                   ESTABLISH BASE                   06240017
          STM  R14,R3,ZZSAVE            SAVE REGISTERS                  06260017
         BALR  R2,R0                   LOAD BASE                        06280017
         USING *,R2                                                     06300017
         DROP  15                                                       06320000
          TM   ZZSW,X'02'               SHOULD WE SET UP HEADER         06340000
          BO   ZZHEAD                   YES                             06360000
          TM   ZZSW,X'01'               SHOULD WE SKIP TO NEXT PAGE     06380000
          BO   ZZSKIP                   YES                             06400000
          CLC  ZZLINES(1),ZZLINCNT      IS THIS END OF PAGE             06420000
          BL   FULLPAGE                 YES                             06440000
          B    ZZCLEAR                  CLEAR PRINT BUFFER AND PRINT    06460000
PRNTRTRN  LM   R14,R3,ZZSAVE            RESTORE REGISTERS               06480017
          BR   R14                      RETURN                          06500017
ZZHEAD    MVC  ZZHDSAVE(121),0(R1)      MOVE HEADER AND LINE COUNT TO   06520017
*                                        SAVE AREA                      06540000
          BAL  R3,ZZPG                  GO TO ADD ONE TO PAGE NUMBER    06560017
*                                        AND PRINT HEADER               06580000
          B    PRNTRTRN                                                 06600000
*                                                                       06620000
ZZSKIP    CLI  ZZCTRL,C'-'              IS NEXT PRINT A TRIPLE SPACE    06640000
          BE   PRNTRTRN                 YES   RETURN WITHOUT PRINT      06660000
          BAL  R3,ZZPG                  GO TO PRINT HEADER              06680017
          B    PRNTRTRN                                                 06700000
FULLPAGE  BAL  R3,ZZPG                  GO PRINT HEADER                 06720017
          B    ZZCLEAR                  GO PRINT LINE                   06740000
*                           THIS ROUTINE ADDS ONE TO PAGE NO. AND       06760000
*                           PRINTS HEAD  SET CONTROL CHAR FOR NEXT PRNT 06780000
ZZPG     TM    ZZCTRL,X'FF'                                             06800000
         BZ    ZZNOADD                                                  06820000
         PACK  ZZCONVRT(8),ZZPGNO(4)   ADD ONE                          06840000
          CVB  R15,ZZCONVRT               TO                            06860017
          LA   R15,1(R15)                   PAGE                        06880017
          CVD  R15,ZZCONVRT                   NUMBER                    06900017
         UNPK  ZZPGNO(4),ZZCONVRT(8)         IN                         06920000
         OI    ZZPGNO+3,X'F0'                  HEADER                   06940000
ZZNOADD  MVI   ZZCTRL,C'1'                                              06960000
          MVI  ZZLINCNT,X'04'           INITIALIZE LINE COUNT TO 4      06980000
          MVC  ZZPRINT(120),ZZHDSAVE   MOVE HEADER INTO PRINT BUFFER    07000000
          ST   R3,SAVE3                 SAVE REGISTER 3                 07020017
          BAL  R3,ZZWRITE               GO TO WRITE HEADER              07040017
          MVI  ZZCTRL,C'-'              SET CONTROL TO TRIPLE SPACE     07060000
          L    R3,SAVE3                                                 07080017
          BR   R3                                                       07100017
ZZCLEAR   IC   R14,ZZLINCNT             THIS ROUTINE WILL               07120017
          LA   R14,1(R14)                  ADD ONE                      07140017
          STC  R14,ZZLINCNT             STORE NEW LINE COUNT            07160017
          MVI  ZZPRINT,C' '                                             07180000
         MVC   ZZPRINT+1(119),ZZPRINT      CLEAR PRINT BUFFER           07200000
          LM   R14,R15,ZZSAVE+8              TO BLANKS                  07220017
          EX   R14,ZZMOVE                  MOVE LINE TO BE PRINTED      07240017
          BAL  R3,ZZWRITE                    INTO BUFFER                07260017
          MVI  ZZCTRL,C' '                 SET CONTROL CHAR FOR NEXT    07280000
          B    PRNTRTRN                 PRINT LINE AND  RETURN          07300000
ZZMOVE    MVC  ZZPRINT(1),0(R15)        MOVE MESSAGE TO PRINT BUFFER    07320017
ZZWRITE  PUT   ZZDCB,ZZCTRL                                        BS0H 07350017
          BR   R3                                                       07370017
          DS   0D                                                       07400000
ZZSAVE    DS   10X                                                      07420000
ZZSW      DS   10X                                                      07440000
          DS    4X                                                      07460000
SAVE3     DS    4X                                                      07480000
ZZCTRL   DS    1X                       LOC FOR PRINTER CTRL CHAR       07500000
ZZPRINT  DS    121X                     PRINT BUFFER                    07520000
ZZHDSAVE DS    120X                     HEADER SAVE AREA                07540000
ZZCONVRT EQU   ZZSAVE+32                8 BYTE AREA ADDR TO CONVERT NO  07560000
ZZLINES  DS    1X                       LOC COUNTER FOR LINES PRINTED   07580000
ZZLINCNT DS    1X                       LOC FOR LINE COUNT              07600000
ZZDECB   DS    24X                      AREA FOR DECB                   07620000
SKIP     EQU   256                      CODE FOR SKIP A PAGE            07640000
HEADER   EQU   512                      CODE FOR HEADER                 07660000
ZZPGNO   EQU   ZZHDSAVE+103             LOC OF PAGE NO                  07680000
         DS    0F                                                       07700000
AST      DC    C'****'                                                  07720000
INPARM   DC    X'00'              INTERNAL PARAM. SWITCH         A45131 07730021
ADDHROOT DC    A(HROOT)                                         YM00576 07732002
*                                                                       07740000
HSYSOUT  DCB   DSORG=PS,MACRF=(PM),DDNAME=SYSPRINT,                BS0H*07760017
               RECFM=FBA,EXLST=OPTL,SYNAD=SYSIOERR,LRECL=121     A30296 07780019
*                                                                       07800000
ZZDCB    EQU   HSYSOUT                                                  07820000
         ENTRY GENERATE                                                 07840000
         ENTRY HWRMSG                                                   07860000
         ENTRY HCDWR                                                    07880000
         DCBD  DSORG=PS                                                 07900000
OFLGS    EQU   DCBOFLGS-IHADCB                                          07920000
         END   GENERATE                                                 07940000
./  ADD  SSI=81160027,NAME=IEBGENR3
*******************************************************************     00000117
**************************** I E B G E N R 3 **********************     00000217
*********                                                               00000317
* ENTRY  IEBGENR3 =CSECT NAME,CONTROL IS TRANSFERRED FROM GENRT TO      00000417
*                  THIS NAME                                            00000517
*        GENS3COP =NAME OF SWITCH THAT INDICATES WHETHER GENS3 HAS      00000617
*                  TO DO A STRAIGHT COPY OR NOT                         00000717
*        HDCBIN   =NAME OF INPUT DCB AND IS REFERRED TO IN GEN03        00000817
*                  AND GENS3                                            00000917
*        HDCBOUT  =NAME OF OUTPUT DCB AND IS REFERRED TO IN GEN03       00001017
*                  AND GENS3                                            00001117
*********                                                               00001217
* INPUT  REGISTER 1 IS POINTIG TO A TABLE CONTAINING THE ADDRESSES      00001317
*        OF TABLES CONSTRUCTED BY IEBGSCAN                              00001417
*********                                                               00001517
* OUTPUT TRANSFERRING CONTROL TO GEN03 OR GENS3 THE CONTENTS OF         00001617
*        REGISTER 1 IS THE SAME AS AT ENTRY TIME                        00001717
*********                                                               00001817
* EXTRN  IEBGEN03 =NAME OF PROCESSOR FOR CONVENTIONAL DATASETS          00001917
*        IEBGENS3 =NAME OF PROCESSOR FOR SPANNED DATASETS               00002017
*        DDERROR1 =NAME OF MESSAGE USED AS A DIAGNOSTIC WHEN            00002117
*                  DD SASTEMENT NAMES ARE IMPROPERLY SPECIFIED          00002217
*        HMSGEXIT =MESSAGE TO PROVIDE THE USER WITH THE NUMBER OF       00002317
*                  EXITS TAKEN TO A CERTAIN USER LABEL EXIT ROUTINE     00002417
*        HMSGRETC =MESSAGE TO PROVIDE THE USER WITH THE LAST RETURN     00002517
*                  CODE FROM A CERTAIN USER LABEL EXIT ROUTINE          00002617
*        HMSGIOER =MESSAGE GIVEN WHEN THERE IS AN I/O ERROR WHILE       00002717
*                  READING OR WRITING USER LABELS                       00002817
*        HWRMSG   =THE NAME OF THE MESSAGE WRITER                       00002917
*********                                                               00003017
* ERROR CONDITIONS      IEBGENR3 WILL TERMINATE ON THE FOLLOWING        00003117
*                  CONDITIONS                                           00003217
*        1.AFTER PROCESSING HEADER LABELS IF LABELS DATA=ONLY IS        00003317
*          SPECIFIED                                                    00003417
*        2.IF A USER EXIT ROUTINE REQUESTS TERMINATION                  00003517
*        3.IF THE DATA SETS NOT SUCCESFULLY CAN BE OPENED               00003617
*********                                                               00003717
* FUNTION/OPERATION                                                     00003817
*        IF USER EXITS OR LABEL PROCSESING IS SPECIFIED THE DCB         00003917
*        EXIT LISTS ARE ACTIVATED. THEN THE DCB'S ARE OPENED FOR        00004017
*        B S A M  ,TAKING LABEL EXITS IF USER EXITS AND/OR LABEL        00004117
*        PROCESSING IF REQUIRED                                         00004217
*        AFTER BOTH DCB'S ARE OPEN THE RECFM'S OF BOTH DCB'S ARE        00004317
*        COMPARED,AND SO ARE THE LRECL'S AND BLKSIZE'S.                 00004417
*        IF ONE OR BOTH OF THE RECFM'S IS VS/VBS AND THE LRECL'S        00004517
*        AND/OR THE BLKSIZE'S ARE NOT EQUAL OR ANY KIND OF EDITING      00004617
*        OR CONVERSION IS TO BE PERFORMED,THE DCB'S ARE CLOSED AND      00004717
*        RE-OPENED FOR Q S A M .AND AFTER THIS CONTROL IS               00004817
*        TRANSFERRED TO EITHER GEN03 (IN CASE OF CONVENTIONAL           00004917
*        DATA SETS) OR GENS3(IN CASE OF SPANNED DATA SETS )             00005017
*******************************************************************     00005117
         TITLE   'IEBGENR3-PROCESSOR ROOT SEGMENT (RELEASE 17)'         00005317
IEBGENR3 CSECT                                                          00005517
*                                                                A29998 00005619
*                                                                A31435 00035620
*647259,688259                                                  ATM5314 00037620
*                                                                A34101 00045621
*A113059-113259,124259,134759,1348592,143759,143859,171259,      A36140 00047621
*A176259,188359-188959,206759-207159,217261-217323,227259,227261,A36140 00049621
*A258259,258759,265259,266259,268259,268559-268759,268859-       A36140 00051621
*A269159,269259,647759,648359,649759-651259,688759,688859,       A36140 00053621
*A690759-691759,867359,867459                                    A36140 00054021
*A115959-117359,143339-143659,149259,190259-190859,196759        A36140 00054421
*A205459-205859,212759,649769-649809                             A36140 00054821
*C191259,193259,209259,402259                                    A36140 00055221
*D116259,117259,124259,147259,148259,171259,176259-182259,       A36140 00055621
*D227259,258259-264259,265259,266259,268259,268559-273259,275259,A36140 00057621
*D653259-674259,688759,692259-711259                             A36140 00059621
*D118259-122259,149259-153259,190259                             A36140 00061621
*A131759                                                         A44327 00063621
*C359259,422259,457259,49659                                     A44327 00064021
*A216259-216709                                                  A45131 00064521
*D216259                                                         A45131 00065021
*A217279,217280,217285-217645,217855,217963,218387-219115,395759,A48786 00065421
*A395859,402759-402959,812759-814759,858959,897959               A48786 00065500
*D394259,395259,403259,404259,817259                             A48786 00075500
*C860459                                                       @YM02300 00077502
*A274359-27624,276247                                          @YM04133 00085502
*C268559                                                       @YM04133 00088802
*D265259-268259                                                @YM04133 00090802
*A206759,977959                                                @YM03265 00091202
*C274759,275259                                                @AZ07398 00091300
*A017659-017759,141759-142223,142359-142959,188879,            @ZA11962 00091799
*A189199-189543,275359-275459,275879-275919,276251             @ZA11962 00092199
*A613759-614259,869279-869579                                  @ZA11962 00094899
*C018059,142259,188859,274259,275759-275859,275959             @ZA11962 00095699
*D274359-274459                                                @ZA11962 00100599
*A189359-189379,276199-276204                                  @ZA16460 00102599
*A141863-141875,189059-189159,869379-869399,869567             @ZA18366 00104599
*A141879,189251,869459,869579                                  @ZA18366 00106599
*A142060-142090,142224-142226                                  @ZA24127 00107599
*A141876-141881,869469-869470                                  @ZA24162 00108099
*C141871,141879,189059-189159,869459                           @ZA24162 00108599
*A332559-332859,388559-388859,435559-435859,474559-474859      @ZA26660 00108799
*A218457-218459                         @YA19584-@XA20183-(ORG)@ZA26153 00109099
*C218460                                @YA19584-@XA20183-(ORG)@ZA26153 00109299
*D689259                                @YA19584-@XA20183-(ORG)@ZA26153 00109499
*C141863-141867                                                @ZA28426 00109699
*A189399,276209                                                @ZA28777 00109899
*C189359-189379,276199-276204                                  @ZA28777 00110099
*A141759-142329,142409-143039,189079-189111,216389,216539,     @ZA30822 00110299
*A216689,275159-275789,276249-276255,614759-615259,            @ZA30822 00110499
*A692259-692759,869579-869643                                  @ZA30822 00110699
*C188859,533259,534259,613759                                  @ZA30822 00110899
*D141863-142259,142359-142959,189059-189543,274259,            @ZA30822 00111099
*D275359-275959,276251,613759-621259                           @ZA30822 00111299
*C218459                                @YA20777-@XA21726-(ORG)@ZA32107 00111499
* THIS MODULE WAS CREATED IN RELEASE 17 IN SUPPORT OF VRE AND           00112099
* USER LABELS                                                           00117320
*          REGISTER ASSIGNMENTS                                         00125620
R0       EQU   0                                                        00185917
R1       EQU   1                                                        00275917
R2       EQU   2                                                        00365917
R3       EQU   3                                                        00455917
R4       EQU   4                                                        00545917
R5       EQU   5                                                        00635917
R6       EQU   6                                                        00725917
R7       EQU   7                                                        00815917
R8       EQU   8                                                        00905917
R9       EQU   9                                                        00995917
R10      EQU   10                                                       01085917
R11      EQU   11                                                       01175917
R12      EQU   12                                                       01265917
R13      EQU   13                                                       01355917
R14      EQU   14                                                       01445917
R15      EQU   15                                                       01535917
R3START  SAVE  (14,12),T,IEBGENR3-OZ32107                      @ZA32107 01625999
         LR    R2,R15                                                   01715917
         LA    R7,4095(R2)            SET R7 AS SECOND BASEREG @ZA11962 01765900
         LA    R7,1(R7)                INCREASE R7 WITH ONE    @ZA11962 01775999
         USING R3START,R2,R7                                   @ZA11962 01805900
         LA    R3,R3SAVER              STORE REG 13                     01895917
         ST    R3,8(R13)               POINT TO NEW SAVE AREA           01985917
         ST    R13,4(R3)               STOR  REG 13                     02075917
         LR    R13,R3                                                   02165917
         ST    R1,SAVEREG1             SAVE REG1 FOR 03 AND S3          02255917
         L     R3,0(R1)                LOAD EXIT TABLE ADDRESS          02345917
         LR    R4,R1                    SAVE REGISTER 1                 02435917
         MVC   LABPROSW(1),92(R3)      MOVE LABEL PROCC SWITCH          02525917
         TM    LABPROSW,X'FF'          TEST THE SWITCH                  02615917
         BM    CKIHLR                  IF NO  BITS                      02705917
         BO    CKIHLR                  ARE SET ,THEN                    02795917
         OI    LABPROSW,X'80'          SET DEFAULT=YES                  02885917
CKIHLR   DS    0H                                                       02975917
         TM    LABPROSW,X'B0'          LABEL PROC. IS NO/INPUT          03065917
         BZ    TESTX1                  YES-BRANCH                       03155917
         MVI   HINXL,X'01'             ACTIVATE INPUT HEADER EXIT       03245917
TESTX1   CLI   8(R3),X'40'             USER INPUT HEADER EXIT           03335917
         BC    8,CKOHLR                 NO, GO TO NEXT CHECK            03425917
         LR    R10,R3                  PICK UP USER                     03515917
         LA    R10,8(R10)                 INPUT  HEADER                 03605917
         MVI   HINXL,X'01'              YES, ACTIVATE IHLE              03695917
         LOAD  EPLOC=(R10)             LOAD USER INPUT HEADER   RTN     03785917
         ST    R0,ADINUHLR                ROUTINE AND SAVE ADDRESS      03875917
*                                                                       03965917
CKOHLR   DS    0H                                                       04055917
         TM    LABPROSW,X'40'          LABEL PROC. IS NO                04145917
         BO    TESTX2                  YES-BRANCH                       04235917
         MVI   HOUXL+4,X'02'           ACTIVATE OUTPUT HEADER EXIT      04325917
TESTX2   CLI   16(R3),X'40'            USER OUTPUT HEADER EXIT          04415917
         BC    8,CKITLR                 NO, GO TO NEXT CHECK            04505917
         LR    R10,R3                  PICK UP USER                     04595917
         LA    R10,16(R10)               OUTPUT HAEDER                  04685917
         MVI   HOUXL+4,X'02'              YES, ACTIVATE OHLE            04775917
         LOAD  EPLOC=(R10)             LOAD USER OUTPUT HEADER  RTN     04865917
         ST    R0,ADOTUHLR                ROUTINE AND SAVE ADDRESS      04955917
*                                                                       05045917
CKITLR   DS    0H                                                       05135917
         TM    LABPROSW,X'90'          LABEL PROC. IS YES/ALL           05225917
         BZ    TESTX3                  NO-BRANCH                        05315917
         MVI   HINXL+4,X'03'           ACTIVATE INPUT TRAILER EXIT      05405917
TESTX3   CLI   24(R3),X'40'            USER INPUT TRAILER EXIT          05495917
         BC    8,CKOTLR                 NO, GO TO NEXT CHECK            05585917
         LR    R10,R3                  PICK UP USER                     05675917
         LA    R10,24(R10)               INPUT  TRAILER                 05765917
         MVI   HINXL+4,X'03'            YES, ACTIVATE ITLE              05855917
         LOAD  EPLOC=(R10)             LOAD USER INPUT TRAILER  RTN     05945917
         ST    R0,ADINUTLR                ROUTINE AND SAVE ADDRESS      06035917
*                                                                       06125917
CKOTLR   DS    0H                                                       06215917
         TM    LABPROSW,X'98'          LABEL PROC. IS YES/ALL/INPUT     06305917
         BZ    TESTX4                  NO-BRANCH                        06395917
         MVI   HOUXL+8,X'04'           ACTIVATE OUTPUT TRAILER EXIT     06485917
TESTX4   CLI   32(R3),X'40'            USER OUTPUT TRAILER EXIT         06575917
         BC    8,SWSTORE                NO, GO TO NEXT CHECK            06665917
         LR    R10,R3                  PICK UP USER                     06755917
         LA    R10,32(R10)               OUTPUT TRAILER                 06845917
         MVI   HOUXL+8,X'04'            YES, ACTIVATE OTLE              06935917
         LOAD  EPLOC=(R10)             LOAD USER OUTPUT TRAILER RTN     07025917
         ST    R0,ADOTUTLR                ROUTINE AND SAVE ADDRESS      07115917
*                                                                       07205917
SWSTORE  DS    0H                                                       07295917
         LR    R1,R4                    RESTORE REGISTER 1              07385917
         MVC   HCOPYSW(1),93(R3)       MOVE COPY SWITCH                 07475917
         MVC   HPOID(1),94(R3)                                          07565917
         MVC   LABPOLAT(8),80(R3)      MOVE LABEL POOL ADDRESSES        07655917
         MVC   HDCBIN+MACRF(2),BSREAD  MAKE SYSUT1 DCB FOR BSAM         07745917
         MVC   HDCBOUT+MACRF(2),BSWRITE MAKE SYSUT2 DCB FOR BSAM        07835917
         SR    R4,R4                                                    07925917
         C     R4,88(R3)                                                08015917
         BZ    HGENP1                                                   08105917
         MVC   HOUXL(4),88(R3)         STORE TOT.AREA ADDR IN           08195917
         MVI   HOUXL,X'0A'             EXITLIST AND ACTIVATE            08285917
HGENP1   TM    LABPROSW,X'40'          TEST LABEL PROC. FOR 'NO'        08375917
         BO    HGENP1A                 NO LABEL PROC - BEANCH           08465917
         LR    R4,R1                   SAVE REGISTER 1                  08555917
         LA    R1,640                  GET STORAGE                      08565917
         GETMAIN R,LV=(R1)             FOR BACK UP COPY                 08575917
         ST    R1,BACKUP               OF OUTPUT HEADER LABELS          08585917
         TM    LABPROSW,X'08'          TEST LABELPROC. FOR 'INPUT'      08595917
         BO    HGENP1B                 'INPUT' - BRANCH                 08605917
         LA    R1,640                  GET LENGTH OF CORE               08645917
         GETMAIN R,LV=(R1)             GET STORAGE                      08735917
         ST    R1,LABPOLAT             FOR HEADER LABELS                08825917
         TM    LABPROSW,X'20'          LABEL PROCESSING IS ONLY         08915917
         BO    HGENP1B                 YES-BRANCH                       09005917
         LA    R1,640                  GET LENGT OF CORE                09095917
         GETMAIN R,LV=(R1)             GET STORAGE FOR                  09185917
         ST    R1,LABPOLAT+4           TRAILER LABELS                   09275917
HGENP1B  LR    R1,R4                   RESTORE REFSITER 1               09365917
         SR    R4,R4                                                    09455917
HGENP1A  LA    R1,4(R1)                LOAD MEMBER NAME TABLE ADDR      09545917
         LA    R5,HDCBIN                LOAD SYSUT1 DCB ADDR            09635917
         C     R4,HINDD(R1)             INPUT DD NAME GIVEN?            09725917
         BE    HGENP2                   NO                              09815917
         MVC   DDNAM(8,R5),HINDD(R1) USER DDNAME IN UT1                 09905917
HGENP2   MVC   INPUTDD(8),DDNAM(R5)    STORE INPUT DD NAME       A29998 09965919
         C     R4,HOUDD(R1)            CHECK FOR OUTPUT DD       A29998 10025919
         LA    R5,HDCBOUT               LOAD SYSUT2 DCB ADDR            10085917
         BE    HGENP3                   BRANCH IF NO OUTPUT DD NAME     10175917
         MVC   DDNAM(8,R5),HOUDD(R1)  USER DDNAME IN UT2                10265917
HGENP3   MVC   OUTPUTDD(8),DDNAM(R5)   STORE OUTPUT DDNAME       A29998 10325919
         OC    DSORG(1,R5),HPOID       SET SYSUT2                A29998 10385919
         TM       DSORG(R5),X'42'       DEB FOR                         10445917
         BM    HGENP4                   PS OR                           10535917
         NI       DSORG(R5),X'BF'       PO                              10625917
HGENP4   MVI   OPENSW,X'F0'            SET OPENIN SWITCH                10715917
         L     R4,LABPOLAT             LOAD LABEL POOL ADDRESS          10805917
         LA    R4,0(R4)                STORE BEGIN ADDRESS              10895917
         ST    R4,HLABINDX             OF HEADER LABELS                 10985917
         OI    USEXSW,X'80'            INITIALIZE USER EXIT SWITCH      11075917
         MVI   EXCOUNT,X'00'                                            11165917
         OPEN  (HDCBIN,INPUT)          OPEN SYSUT1 FOR INPUT            11255917
         CLI   HCONCODE+1,X'0C'   COND CODE EQ 12 ?              A36140 11305921
         BE    HTERMU             YES, END PROCESSING            A36140 11315921
         NI    GENS3SW,X'0F'      SET SW FOR ERR PURP. OFF       A36140 11325921
         LA    R14,HDCBIN       ADDR OF SYSUT1 DCB                      11345917
         LA    R15,INPUTDD             POINT REG TO INPUT DD     A29998 11375919
*                                      NAME                      A29998 11405919
         TM    OFLGS(R14),X'10'    IS IT OPEN                           11435917
         BZ    DDERROR      NO                                          11525917
         LA    R14,HDCBOUT         LOAD ADDR. OF OUTP. DCB       A36140 11595900
         TM    OFLGS(R14),X'10'    WAS DCB OPENED ?              A36140 11665921
         BO    AFTWRT2             YES,TEST FOR USER TERM REQ.   A36140 11735921
AFTWRT1  CLI   HTERMSW,X'FF'           TEST FOR USER TERM.REQUEST       12325917
         BNE   TESTFU                  CONTINUE TESTING          A36140 12425921
         LA    R15,SYSUT1H             ADDR OF INPUT DCB ID             12525921
HGENP4A  MVI   HTERMSW,X'00'           CLEAR TERM SW BEFORE OPEN        12625917
*                                      SYSUT2                           12725917
         L     R14,VADDR1              ADDR OF ERROR MESSAGE            12825917
         MVC   5(8,R14),0(R15)         MOVE DCB ID TO MSG               12925917
         LA    R1,5                    LOAD MSG CODE                    13025917
         SLL   R1,8                                                     13125917
         LA    R4,5                    LOAD MESS. NUMBER         A44327 13175921
ERRORPNT AR    R1,R4                   SET REG1=MSGCODE+MSG2:           13225917
         L     R15,HWRMSGA              LOAD MSG WRITER SUBR ADDR       13325917
         BALR  R14,R15                  WRITE MESSAGE AND               13425917
         TM    GENS3SW,X'40'      MESS PR. DURING OPEN ?         A36140 13475921
         BO    RETOUT             YES, RETURN TO UT2 OPEN        A36140 13485921
         B     HTERMU                   TERMINATE                       13525917
HGENP4B  MVI   OPENOUTS,X'01'          SET OPENOUT SWITCH               13625917
         L     R4,LABPOLAT             INITIALIZE                       13725917
         LA    R4,0(R4)                THE ADDRESS                      13825917
         ST    R4,HLABINDX             OF FIRST LABEL                   13925917
         L     R4,BACKUP               INITIALIZE                       13945917
         LA    R4,0(R4)                INDEX                            13965917
         ST    R4,BACKUPX              IN BACK UP AREA                  13985917
         OI    USEXSW,X'80'            INITIALIZE EXIT SWITCH           14025917
         MVI   EXCOUNT,X'00'           INITIALIZE EXIT COUNTER          14125917
FINDUCB  EQU   *                                                        14175999
         L     R4,16                   LOAD PTR TO CVT         @ZA30822 14178999
         L     R4,0(R4)                LOAD PTR TO TCB PTR     @ZA30822 14181999
         L     R4,4(R4)                LOAD CURRENT TCB        @ZA30822 14184999
         L     R4,12(R4)               LOAD TIOT PTR           @ZA30822 14187999
         LA    R4,24(R4)               ADJ TIOT PTR TO POINT   @ZA30822 14190999
*                                      TO DD NAME              @ZA30822 14193999
UCB      EQU   *                                               @ZA30822 14196999
         LA    R6,HDCBOUT              GET ADDRESS TO UT2 DCB  @ZA30822 14199999
         CLC   40(8,R6),4(R4)          LOOK FOR SYSUT2 UCB     @ZA30822 14202999
         BE    UCBFOUND                UCB FOR SYSUT2 FOUND    @ZA30822 14205999
         SR    R6,R6                   CLEAR R6                @ZA30822 14208999
         IC    R6,0(R4)                GET TIOT LENGTH         @ZA30822 14211999
         AR    R4,R6                   POINT TO NEXT DD ENTRY  @ZA30822 14214999
         IC    R6,0(R4)                GET TIOT LENGTH         @ZA30822 14217999
         LTR   R6,R6                   IS TIOT LENGTH ZERO     @ZA30822 14220999
         BZ    OPEN                    YES, NO DD CARD FOR     @ZA30822 14223999
*                                      SYSUT2. GO AND OPEN     @ZA30822 14226999
*                                      SYSUT2 EVEN IF NO DD    @ZA30822 14229999
*                                      CARD AND MSG IEB316I    @ZA30822 14232999
*                                      WILL BE ISSUED.         @ZA30822 14235999
         B     UCB                     NO, CHECK NEXT UCB      @ZA30822 14238999
UCBFOUND EQU   *                                               @ZA30822 14241999
         SR    R6,R6                   CLEAR R6                @ZA30822 14244999
         ICM   R6,3,18(R4)             LOAD UCB ADDRESS        @ZA30822 14247999
         TM    18(R6),X'80'            IS SYSUT2 TAPE          @ZA30822 14250999
         BNO   OPEN                    NO, BRANCH              @ZA30822 14253999
RDJFCB   DS    0H                                              @ZA11962 14256999
         XC    JFCBAREA,JFCBAREA       CLEAR JFCBAREA          @ZA11962 14259999
         RDJFCB (HDCBOUT)              READ JBCB.              @ZA11962 14262999
         TM    JFCBIND2,X'40'          DISP NEW OR OLD         @ZA30822 14265999
         BNO   OPEN                    NO, DISP=MOD            @ZA30822 14268999
         OI    TAPESW,X'11'            SET TAPE SW1 AND SW2    @ZA30822 14271999
         LA    R1,HDCBOUT              LOAD UT2 DCB ADDRESS    @ZA30822 14274999
         MVC   BLKSI(2,R1),JFCBLKSI    MOVE BLKSIZE TO DCB     @ZA30822 14277999
         MVC   LRECL(2,R1),JFCLRECL    MOVE LRECL TO DCB       @ZA30822 14280999
         MVC   RECFM(1,R1),JFCRECFM    MOVE RECFM TO DCB       @ZA30822 14283999
         B     OPENOUXL                                        @ZA30822 14286999
AFTJFCB  EQU   *                                               @ZA30822 14289999
         NI    TAPESW,X'EF'            RESET TAPE SW1          @ZA30822 14292999
         TM    GENS3SW,X'04'           QSAM                    @ZA30822 14295999
         BNO   OPEN                    NO DONT CHANGE ACCESS   @ZA30822 14298999
*                                      METHOD                  @ZA30822 14301999
         MVC   HDCBOUT+MACRF(2),QSPUTMOV QSAM OUTPUT           @ZA30822 14304999
OPEN     EQU   *                                               @ZA30822 14307999
         OI    OUXL,X'80'              SET OUXL AS LAST ENTRY  @ZA30822 14310999
         MVI   JFCB,X'00'              RESET JFCB ENTRY        @ZA30822 14313999
         OPEN  (HDCBOUT,OUTPUT)        OPEN SYSUT2 FOR OUTPUT  @ZA30822 14316999
         OI    USEXSW,X'80'            RESET EXIT SWITCH                14325917
         L     R4,ADOTUHLR             WAS OUTPUT HEADER EXIT    A36140 14333921
         LTR   R4,R4                   ROUTINE SPECIFIED ?       A36140 14341921
         BZ    RETINP                  NO, RTRN TO INP DCB EXIT  A36140 14349921
         LA    R4,OTPUTHDR             LOAD OUTPUT HEADER IND.   A36140 14357921
         BAL   R14,WRTEXMSG            WRITE MSG'S               A36140 14365921
         B     RETINP                  RETURN TO OPEN INPUT      A36140 14375921
TESTFU   EQU   *                                                 A36140 14385921
         LA    R14,HDCBOUT             ADDR OF SYSUT2 DCB               14425917
         LA    R15,OUTPUTDD            POINT REG TO OUTPUT DD    A29998 14455919
*                                      NAME                      A29998 14485919
         TM    OFLGS(R14),X'10'        IS IT OPEN                       14525917
         BZ    DDERROR                 NO                               14625917
         B     HGENP5              YES, CONT CHECKING            A36140 14925921
AFTWRT2  CLI   HTERMSW,X'FF'           TEST FOR USER TERM.REQUEST       15425917
         BNE   HGENP5                  NO-BRANCH                        15525917
         LA    R15,SYSUT2H             SET DCB ID                       15625917
         B     HGENP4A                 BRANCH                           15725917
HGENP5   CLI   HCONCODE+1,X'0C'         TEST FOR USER KEY ERROR         15825917
         BNE   HGENP5A                  NO ERROR                        15925917
         LA    R1,HMSGIIP               LOAD MSG CODE                   16025917
         SLL   R1,8                                                     16125917
         LA    R4,2               MESSAGE ID FOR PARM ERROR             16225917
         B     HSTOW3                   TERMINATE                       16325917
HGENP5A  TM    DELTERSW,X'80'          DTD INPUT LABEL ROUTINE          16425917
         BZ    HGENP5B                 REQUIRE TERMINATION              16525917
         LA    R15,16                  LOAD CONDITION CODE=16           16555917
         BAL   R14,CHCONC              TEST FOR HIGHEST                 16585917
         LA    R1,HMSDELTR             YES-SET                          16625917
         SLL   R1,8                                                     16725917
         LA    R4,22                   MESSAGE AND                      16825917
         B     ERRORPNT                BRANCH                           16925917
HGENP5B  TM    LABPROSW,X'20'          LABEL PROCESS SWITCH='ONLY'      17025917
          BZ    CHKERBLS          TEST FOR OPEN ERRORS           A36140 17125921
         LA    R15,8                   LOAD CONDITON CODE=8             17155917
         BAL   R14,CHCONC              TEST FOR HIGHEST                 17185917
         LA    R1,MLABONLY             YES-SET MESSAGE OFFSET           17225917
         SLL   R1,8                    WARNING                          17325917
         LA    R4,23                   ID AND                           17425917
         B     ERRORPNT                BRANCH                           17525917
CHKERBLS  TM    ERRBLKSW,ERRBLKS1 INP RECFM,BLKSI,LRECL ERROR ?  A36140 17625921
         BO    ERRBLK1                 YES,BRANCH                       18325917
         TM    ERRBLKSW,ERRBLKS2       BLOCKSIZE ERROR ON SYSUT2        18425917
         BO    ERRBLK2                 YES,BRANCH                       18525917
         NI    OPENSW,X'00'            RESET OPENIN AND OPENOUT         18625917
*                                      SWITCHES                         18725917
         L     R1,SAVEREG1             RESTORE REG1 FOR GEN03           18825921
         LA    R5,HDCBIN               LOAD INPUT DCB ADDRESS    A36140 18835921
         LA    R6,HDCBOUT              LOAD OUTPUT DCB ADDRESS   A36140 18845921
         TM    GENS3SW,X'08'           GENS3 MODULE TO CALL  ?   A36140 18855999
         BO    CALLS3A                 YES                     @ZA30822 18885999
*                                      NO, CALL IEBGEN03       @ZA11962 18887999
         NI    OPENSW,X'00'            RESET OPENIN(OUT) SWITCH  A36140 18889999
         OI    ITLX,X'80'          SET TRAILER LABEL EXIT AS   @ZA30822 18891999
*                                      LAST ENTRY IN CASE OF   @ZA30822 18893999
*                                         CONCATINATED INPUT.  @ZA30822 18895999
         CALL  IEBGEN03                                                 18963017
         BAL   R14,CHCONC              TEST COND.CODE FROM IEBGEN03     18975917
         CH    R15,TWELVE              RETURN CODE =12             UL0I 18985918
         BE    HTERMU                  YES - ABNORMAL TERM         UL0I 18995918
         CH    R15,SIXTEEN             RETURN CODE =16             UL0I 19005918
         BE    HTERMU                  YES - ABNORMAL TERM         UL0I 19015918
CLOSER3  LA    R1,HDCBIN           LOAD ADDR. OF  INP. DCB       A36140 19025921
         TM    OFLGS(R1),X'10'     WAS DCB OPENED ?              A36140 19045921
         BZ    AFTCLOS1            NO, DO NOT CLOSE              A36140 19065921
         CLOSE HDCBIN              CLOSE INP. DATA SET           A36140 19085921
AFTCLOS1 L     R4,ADINUTLR         WAS INPUT TRAILER EXIT        A36140 19125921
         LTR   R4,R4                   ROUTINE SPECIFIED                19225917
LABPREV1 BZ    AFTWRT3             NO, BRANCH                    A36140 19325921
         LA    R4,INPUTTLR             LOAD INPUT TRAILER IND.          19425917
         BAL   R14,WRTEXMSG            LINK TO WRITE ROUTINE            19525917
AFTWRT3  CLI   HTERMSW,X'FF'           TEST FOR USER TERM.REQUEST       19625917
         MVI   LABPREV1+1,X'F0'    PREVENT SEC. MSG PRINTING     A36140 19675921
         BNE   CLOSE2                                                   19725917
         LA    R15,SYSUT1T             ADDR OF DCB ID                   19825917
         B     HGENP4A                 OUTPUT MSG                       19925917
CLOSE2   MVI   CLOSEOUT,X'02'          SET CLOSE SWITCH                 20025917
         OI    USEXSW,X'80'            RESET EXIT SWITCH                20125917
         MVI   EXCOUNT,X'00'           RESET EXIT COUNTER               20225917
         L     R4,LABPOLAT+4           INITIALIZE ADDRESS OF LABEL      20325917
         LA    R4,0(R4)                POOL                             20425917
         ST    R4,TLABINDX             SAVE ADDRESS                     20525917
         LA    R1,HDCBOUT          LOAD ADDR. OF OUTP. DCB       A36140 20545921
         TM    OFLGS(R1),X'10'     WAS DCB OPENED ?              A36140 20565921
         BZ    SKIPFPOO            NO, DO NOT CLOSE              A36140 20585921
         CLOSE HDCBOUT                 CLOSE SYSUT2                     20625917
         LA    R1,HDCBIN               POINT TO INPUT DCB      @YM03265 20635902
         TM    IND2(R1),X'09'          QSAM OPEN WITH BUF POOL @YM03265 20675902
         BNO   SKIPFPOO                NO,  SKIP FREEPOOL        A36140 20685921
         FREEPOOL HDCBIN               FREE DCB MAIN STORAGE     A36140 20695921
         FREEPOOL HDCBOUT              FREE DCB MAIN STORAGE     A36140 20705921
SKIPFPOO EQU   *                                                 A36140 20715921
         L R4,ADOTUTLR              WAS OUTPUT TRAILER EXIT             20725917
         LTR   R4,R4                   ROUTINE SPECIFIED                20825917
LABPREV2 BZ    AFTWRT4             NO, BRANCH                    A36140 20925921
         LA    R4,OTPUTTLR             LOAD OUTPUT TRAILER IND.         21025917
         BAL   R14,WRTEXMSG            LINK TO WRITE ROUTINE            21125917
AFTWRT4  CLI   HTERMSW,X'FF'           TEST FOR USER TERM.REQUEST       21225917
         MVI   LABPREV2+1,X'F0'    PREVENT SEC. MSG PRINTING     A36140 21275921
         BNE   CLOSE3                  NO-BRANCH                        21325917
         LA    R15,SYSUT2T             ADDR OF OUTPUT DCB               21425917
         B     HGENP4A                                                  21525917
CLOSE3   L     R1,BACKUP          LOAD BACKUP COPY ADDR.         A45131 21625921
         LTR   R1,R1              ADDRESS PRESENT ?              A45131 21628921
         BZ    TSTHDRFR           NO,TEST INPUT LABEL ADDRESS    A45131 21631921
         LA    R0,640             YES,LOAD BACKUP LENGTH         A45131 21634921
         FREEMAIN R,A=(1),LV=(0)  FREEMAIN BACKUP CORE           A45131 21637921
         XC    BACKUP,BACKUP      SET FREEMAIN DONE            @ZA30822 21638999
TSTHDRFR L     R1,LABPOLAT        LOAD INPUT LABELS ADDR.        A45131 21640921
         LTR   R1,R1              ADDRESS PRESENT ?              A45131 21643921
         BZ    TSTTLRFR           NO, TEST OUTPUT LABELS ADDR.   A45131 21646921
         LA    R0,640             YES, LOAD INP. LABELS LENGTH   A45131 21649921
         FREEMAIN R,A=(1),LV=(0)  FREEMAIN INP. LABELS CORE      A45131 21652921
         XC    LABPOLAT,LABPOLAT  SET FREEMAIN DONE            @ZA30822 21653999
TSTTLRFR L     R1,LABPOLAT+4      LOAD OUTPUT LABELS ADDRESS     A45131 21655921
         LTR   R1,R1              ADDRESS PRESENT ?              A45131 21658921
         BZ    RETGENER           NO, RETURN TO GENRT            A45131 21661921
         LA    R0,640             YES, LOAD OUTP. LABELS LENGTH  A45131 21664921
         FREEMAIN R,A=(1),LV=(0)  FREEMAIN OUTP. LABELS CORE     A45131 21667921
         XC    LABPOLAT+4,LABPOLAT+4 SET FREEMAIN DONE         @ZA30822 21668999
RETGENER L     R13,4(R13)         LOAD REGSAV ADDRESS            A45131 21670921
         LH    R15,HCONCODE            LOAD CONDITON CODE               21675917
         RETURN  (14,12),RC=(15)                                        21725917
CHKRECFM OI    GENS3SW,X'40'      SET BIT FOR ERR. MESS. PURPOS. A36140 21726121
         LA    R5,HDCBIN          LOAD INP. DCB ADDRESS          A36140 21726321
         LA    R6,HDCBOUT         LOAD OUTP. DCB ADDRESS         A36140 21726521
         CLC   BLKSI(2,R5),=X'0000'    BLKSIZE SPECIFIED ?       A36140 21727521
         BNE   TESTLRE1           YES, TEST LRECL                A36140 21727721
         OI    BLKSI+1(R5),X'0A'  NO, SET DEFAULT BLKSI=10       A48786 21727900
         MVC   LRECL(2,R5),=X'0005'    NO, SET DEFAULT LRECL=5   A48786 21728400
         OI    ERRBLKSW,ERRBLKS1  SET INP. ERROR BIT             A36140 21728500
TESTLRE1 CLC   LRECL(2,R5),=X'0000'    LRECL SPECIFIED ?         A36140 21728600
         BNE   TSTDCBVA           YES, CHECK ERRORS IN UT2 PAR.  A48786 21728700
         TM    RECFM(R5),X'48'    RECFM INPUT VS/VBS ?           A48786 21728800
         BO    SETERR1            YES, SET ERRBIT                A48786 21728921
         TM    RECFM(R5),X'40'    RECFM INPUT V/VB ?             A48786 21729121
         BO    STVARDF1           YES, SET DEFAULT LRECL         A48786 21729221
         TM    RECFM(R5),X'10'    RECFM INPUT FB ?               A48786 21729321
         BO    SETERRFB           YES, SET DEFAULT  AND ERRBIT   A48786 21729421
         MVC   LRECL(2,R5),BLKSI(R5) RECFM=F, SO LRECL=BLKSI     A48786 21729521
         B     TSTDCBVA           SCAN OUTPUT DCB VALUES         A48786 21729621
STVARDF1 LA    R3,4               LOAD REG. 3 WITH 4             A48786 21729721
         LH    R4,BLKSI(R5)       LOAD INPUT BLKSIZE IN R4       A48786 21729921
         SR    R4,R3              SET R4 = R4 - 4                A48786 21730021
         STH   R4,LRECL(R5)       SET INPUT LRECL = BLKSI - 4    A48786 21730121
         B     TSTDCBVA           SCAN OUTPUT DCB VALUES         A48786 21730221
SETERRFB MVC   LRECL(2,R5),BLKSI(R5) MOVE UT1 BLKSI TO UT2       A48786 21730321
SETERR1  OI    ERRBLKSW,ERRBLKS1  SET INP. ERROR BIT             A48786 21730421
TSTDCBVA CLC   BLKSI(2,R6),=X'0000' UT2 BLKSIZE ZERO ?           A48786 21730721
         BNE   TESTRFM2           NO, SCAN UT2 DCB PARAM. AGAIN  A48786 21735821
         CLC   LRECL(2,R6),=X'0000' UT2 LRECL ZERO ?             A48786 21737821
         BNE   TESTRFM2           NO, SCAN UT2 DCB PARAM. AGAIN  A48786 21739821
         TM    RECFM(R6),X'C0'    UT2 RECFM U ?                  A48786 21741821
         BNO   TESTRFM2           NO, SCAN UT2 DCB PARAM. AGAIN  A48786 21752621
         MVC   BLKSI(2,R6),BLKSI(R5) MOVE UT1 BLKSI TO UT2       A48786 21761921
         MVC   LRECL(2,R6),LRECL(R5) MOVE UT1 LRECL TO UT2       A48786 21762321
         MVC   RECFM(1,R6),RECFM(R5) MOVE UT1 RECFM TO UT2       A48786 21762721
ENDTST   LA    R1,HMSEQDCB        LOAD MSG NBR IEB352I           A48786 21763121
         SLL   R1,8               SHIFT LEFT 8 BITS              A48786 21763521
         LA    R1,52(R1)          ADD MSG ADDR. DISPLMNT         A48786 21763621
         L     R15,HWRMSGA        LOAD MSG ROUTINE ADDR.         A48786 21763721
         BALR  R14,R15            PRINT MESSAGE IEB352I          A48786 21763821
         B     ENDERROR           SKIP REST OF ERR.TSTS          A48786 21764521
TESTRFM2 CLC   BLKSI(2,R6),=X'0000'    BLKSIZE SPECIFIED ?       A36140 21765921
         BNE   TESTLRE2           YES, TEST LRECL                A36140 21774721
         OI    BLKSI+1(R6),X'0A'  NO, SET DEFAULT BLKSI=10       A48786 21785500
         MVC   LRECL(2,R6),=X'0005'    NO, SET DEFAULT LRECL=5   A48786 21796321
         OI    ERRBLKSW,ERRBLKS2  SET OUT. ERROR BIT             A36140 21807121
TESTLRE2 CLC   LRECL(2,R6),=X'0000'    LRECL SPECIFIED ?         A36140 21817921
         BNE   ENDERROR           YES, END OF ERROR CHECKING     A36140 21828721
         TM    RECFM(R6),X'48'    RECFM OUTPUT VS/VBS ?          A48786 21838721
         BO    SETDEFLR           YES, SET DEFAULT AND ERRBIT    A48786 21839121
         TM    RECFM(R6),X'40'    RECFM OUTPUT V/VB ?            A48786 21839221
         BO    STVARDF2           YES, SET DEFAULT LRECL         A48786 21839321
         TM    RECFM(R6),X'10'    RECFM OUTPUT FB ?              A48786 21839421
         BO    SETDEFLR           YES, SET DEFAULT  AND ERRBIT   A48786 21843021
         B     SETL2EB2           SCAN OUTPUT DCB VALUES         A48786 21845421
STVARDF2 TM    HCOPYSW,X'FF'      ANY EDITING ?                  A48786 21845521
         BZ    CALCLR2            YES, CALC. DEFAULT VALUE       A48786 21845621
MOVEL1L2 EQU   *                                               @ZA26153 21845799
         TM    RECFM(6),X'C0'     SYSUT2 RECFM U ?             @ZA26153 21845899
         BO    ENDERROR           YES BRANCH                   @ZA32107 21845999
         MVC   LRECL(2,R6),LRECL(R5) SET LRECL2 = LRECL1       @ZA26153 21846299
         B     ENDTST             SCAN OUTPUT DCB VALUES         A48786 21846321
CALCLR2  LA    R3,4               LOAD REG. 3 WITH 4             A48786 21848421
         LH    R4,BLKSI(R6)       LOAD OUTPUT BLKSIZE IN R4      A48786 21849021
         SR    R4,R3              SET R4 = R4 - 4                A48786 21849621
         STH   R4,LRECL(R6)       SET OUTPUT LRECL = BLKSI - 4   A48786 21850221
         B     ENDERROR           SCAN OUTPUT DCB VALUES         A48786 21852221
SETDEFLR TM    HCOPYSW,X'FF'      ANY EDITING ?                  A48786 21852321
         BZ    SETERR2            YES, SET ERRBIT                A48786 21852421
         B     MOVEL1L2           SET DEFAULT LRECL2 = LRECL1    A48786 21854621
SETERR2  OI    ERRBLKSW,ERRBLKS2  SET OUT. ERROR BIT             A48786 21857821
SETL2EB2 MVC   LRECL(2,R6),BLKSI(R6) SET  LRECL=BLKSI            A48786 21858221
ENDERROR LA    R3,ERRBLK1         LOAD LABEL ERRBLK1 ADDRESS     A48786 21859800
AGAINOUT TM    RECFM(R5),X'40'    RECFM VAR.UND ?                A48786 21861121
         BO    TSTVBSRF           YES, SKIP BLKSI MULT.OF LRECL  A48786 21863100
         TM    RECFM(R5),X'10'    RECFM F ?                      A48786 21863500
         BO    BLKLREC            NO, RECFM = FB                 A48786 21863900
         CLC   LRECL(2,R5),BLKSI(R5) LRECL = BLKSI (RECFM = F )  A48786 21864300
         BE    TSTVAR2            YES, SCAN OUTPUT DCB VAL.      A48786 21864700
         B     SETMSG             NO, SET ERRBIT + MSG IEB311I   A48786 21864800
BLKLREC  SR    R8,R8              ZERO REGISTER 8                A48786 21865100
         LH    R9,BLKSI(R5)       LOAD INP BLKSIZE               A48786 21867121
         LH    R4,LRECL(R5)       LOAD INP LRECL                 A48786 21869121
         DR    R8,R4              DIVIDE BLKSI BY LRECL          A48786 21869521
         LTR   R8,R8              REMAINDER ?                    A48786 21869921
         BZ    TSTVAR2            NO, OKE                        A48786 21870321
SETMSG   MVC   LRECL(2,R5),BLKSI(R5) MOVE UT1 BLKSI TO LRECL     A48786 21870400
SETMSG2  MVI   11(R3),X'0C'       CHANGE MSG IEB317I             A48786 21870500
         MVI   19(R3),X'0B'       IN MSG IEB311I                 A48786 21870600
INOUTSW  OI    ERRBLKSW,ERRBLKS1  SET INPUT ERR. SWITCH          A48786 21870721
         B     TSTVAR2            TEST FOR OUTPUT                A48786 21880700
TSTVBSRF TM    RECFM(R5),X'88'    INP. RECFM VS,F,U ?            A48786 21895521
         BNZ   TSTVAR2            YES, SKIP BLKSI=LRECL + 4 TST  A48786 21895921
         LH    R9,LRECL(R5)       LOAD INP LRECL                 A48786 21896321
         LA    R9,4(R9)           ADD 4 TO LRECL                 A48786 21896721
         CH    R9,BLKSI(R5)       BLKSI >= LRECL + 4 ?           A48786 21896821
         BNH   TSTVAR2            YES, TEST OUTPUT               A48786 21896921
         STH   R9,BLKSI(R5)       SET BLKSI TO PREV. ABEND       A48786 21899521
         B     SETMSG2            SET ERRBIT + MSG IEB311I       A48786 21901500
TSTVAR2  CR    R5,R6              OUTP. DCB VAL ALREADY TESTED ? A48786 21901900
         BE    TSTVS1A2           YES, SCAN FURTHER              A48786 21903900
         LR    R5,R6              NO, LOAD OUT. DCB ADDR. IN R5  A48786 21904300
         LA    R3,ERRBLK2         LOAD LABEL ERRBLK2 ADDRESS     A48786 21904700
         MVI   INOUTSW+1,ERRBLKS2 SET CORRECT ERRSW.             A48786 21905121
         B     AGAINOUT           SCAN OUTPUT DCB VALUES         A48786 21905200
TSTVS1A2 LA    R5,HDCBIN          LOAD INPUT DCB ADDRESS         A48786 21905900
         TM    RECFM(R5),X'48'    INP. RECFMAT VAR. SPANNED      A48786 21911500
         BO    CHSTRCOP           YES, CHECK FOR STRAIGHT COPY   A36140 21913922
         TM    RECFM(R6),X'48'    OUTP. FORMAT VAR. SPANNED ?    A36140 21916322
         BO    CHLRECL            YES, CHECK FOR LRECL'S         A36140 21918722
         B     RETOUT             RETURN TO OPEN                 A36140 21921122
CHSTRCOP CLC   RECFM(1,R6),RECFM(R5)   COMPARE RECORD FORMATS           21923522
         BNE   CHLRECL                 NOT EQUAL-BRANCH                 21925917
         CLC   LRECL(2,R6),LRECL(R5)   COMPARE LRECL'S                  22025917
         BNE   CHLRECL                 NOT EQUAL-BRANCH                 22125917
         CLC   BLKSI(2,R6),BLKSI(R5)   COMPARE BLOCK SIZES              22225917
         BNE   CHLRECL                 NOT EQUAL-BRANCH                 22325917
         TM    HCOPYSW,X'FF'           ANY EDITING                      22425917
         BZ    CHLRECL                                                  22525917
         MVI   GENS3COP,X'80'          SET COPY SWITCH                  22625917
         LA    R1,34                   LOAD MSG OFFSET                  22635917
         SLL   R1,8                    AND                              22645917
         LA    R1,34(R1)               MSG ID                           22655917
         L     R15,HWRMSGA             LOAD ADDRESS OF MSG WRITER       22665917
         BALR  R14,R15                 AND LINK                         22675917
         OI    GENS3SW,X'08'      SET GENS3 SW. FOR MODULE SEL.  A36140 22725921
         B     RETOUT             RETURN TO OPEN UT2             A36140 22726121
CHLRECL  TM    LRECL(R5),X'80'         INPUT LRECL EXCEEDS 32K          22825917
         BZ    CHKLREC2                NO                               22925917
RECMSG   LA    R1,28                                                    23025917
         SLL   R1,8                                                     23125917
         LA    R4,28                                                    23225917
         LA    R15,12                  LOAD CONDITION CODE=12           23255917
         BAL   R14,CHCONC              TEST FOR HIGHEST                 23285917
         B     ERRORPNT                                                 23325917
CHKLREC2 TM    LRECL(R6),X'80'         OUTPUT LRECL EXCEEDS 32K'        23425917
         BO    RECMSG                  YES-BRANCH                       23525917
         TM    HDCBOUT+17,X'20'        OUTPUT DEVICE IS DA'             23625917
         BZ    CHKKEYIN                                                 23725917
         CLI   HDCBOUT+16,X'00'        KEYLENGTH IS ZERO?               23825917
         BE    CHKKEYIN                YES-BRANCH                       23925917
         LA    R1,20                                                    24025917
         SLL   R1,8                                                     24125917
         LA    R4,20                   AND                              24225917
           LA  R15,12                  LOAD CONDITION CODE =12          24255917
         BAL   R14,CHCONC              TEST FOR HIGHEST                 24285917
         B     ERRORPNT                PRINT                            24325917
CHKKEYIN TM    HDCBIN+17,X'20'         INPUT DEVICE IS DA               24425917
         BZ    INTMCLOS                NO-BRANCH                        24525917
         CLI   HDCBIN+16,X'00'         KEYLENGTH IS ZERO                24625917
         BE    INTMCLOS                YES-BRANCH                       24725917
         LA    R1,21                                                    24825917
         SLL   R1,8                                                     24925917
         LA    R4,21                                                    25025917
         LA    R15,12                  LOAD CONDITION CODE = 12         25225917
         BAL   R14,CHCONC              TEST FOR HIGHEST                 25425917
         B     ERRORPNT                WRITE MSG AND TERMINATE          25625917
INTMCLOS CLI   HPOID,X'02'        OUTPUT PO ?                    A36140 25825921
         BE    VBSERROR           YES, NOT ALLOWED IN PDS        A36140 25875921
OPENQSAM OI    GENS3SW,X'0C'      SET SW FOR GENS3 MOD + QSAM  @YM04133 26855902
         B     RETOUT             RETURN TO OPEN                 A36140 26865921
VBSERROR LA    R1,29              LOAD MESS ID                   A36140 26875921
         SLL   R1,8                                              A36140 26885921
         LA    R4,29              LOAD MESS IEB329I              A36140 26895921
         LA    R15,12             LOAD COND CODE EQ 12           A36140 26905921
         BAL   R14,CHCONC         TEST FOR HIGHEST COND CODE     A36140 26915921
         B     ERRORPNT           WRITE MESS AND TERM AFT. OPEN  A36140 26925921
CALLS3A  EQU   *                                               @ZA30822 27425999
         NI    OPENSW,X'00'           RESET OPENIN(OUT) SWITCH @ZA30822 27432999
         TM    GENS3SW,X'04'          EDITING TO BE DONE       @ZA30822 27439999
         BNO   TOGENS3                NO, DON'T OPEN FOR QSAM  @ZA30822 27446999
         CLOSE (HDCBIN,REREAD)         CLOSE INPUT DATA SET    @AZ07398 27453999
         TM    TAPESW,X'01'           SYSUT2 TAPE              @ZA30822 27460999
         BO    TAPE                   YES, DON'T REOPEN UT2    @ZA30822 27467999
         CLOSE (HDCBOUT,REREAD)        CLOSE OUTPUT DATA SET   @AZ07398 27474999
         MVC   HDCBIN+MACRF(2),QSGETMOV YES, OPEN INPUT/OUTPUT @ZA11962 27481999
         MVC   HDCBOUT+MACRF(2),QSPUTMOV   FOR QSAM.           @ZA11962 27488999
         B     SECOPEN                 OPEN SYSUT1/SYSUT2      @ZA30822 27495999
TAPE     EQU   *                                               @ZA30822 27502999
         NI    TAPESW,X'FE'            RESET TAPE SW2          @ZA30822 27509999
         MVI   INXL,X'00'              RESET OPENINXL FOR      @ZA30822 27516999
*                                      SECOND OPEN OF SYSUT1   @ZA30822 27523999
         OI    ITLX,X'80'              SET HITLX AS LAST ENTRY @ZA30822 27530999
         MVC   HDCBIN+MACRF(2),QSGETMOV QSAM INPUT             @ZA30822 27537999
SECOPEN  EQU   *                                               @ZA30822 27544999
         OPEN  (HDCBIN,INPUT)          REOPEN FOR QSAM/BSAM    @ZA30822 27551999
         LA    14,HDCBIN               POINT TO INPUT DCB      @YM04133 27605902
         TM    OFLGS(R14),X'10'        SUCCESSFUL OPEN?        @YM04133 27615902
         BZ    DDERROR                 NO -WRITE MSG AND TERM  @YM04133 27617902
         LA    14,HDCBOUT              POINT TO OUTPUT DCB     @YM04133 27621902
         TM    OFLGS(R14),X'10'        SUCCESSFUL OPEN?        @YM04133 27623999
         BZ    DDERROR                 NO -WRITE MSG AND TERM  @YM04133 27624399
         L     R1,SAVEREG1             RESTORE REG1 FOR GENS3  @YM04133 27624799
TOGENS3  EQU   *                                               @ZA30822 27624999
         OI    ITLX,X'80'          SET TRAILER LABEL EXIT AS   @ZA30822 27625199
*                                      LAST ENTRY IN CASE OF   @ZA30822 27625399
*                                         CONCATINATED INPUT.  @ZA30822 27625599
         CALL  IEBGENS3                                                 27625917
         BAL   R14,CHCONC              TEST COND.CODE FROM IEBGENS3     27675917
         CH    R15,TWELVE              RETURN CODE =12             UL0I 27685918
         BE    HTERMU                  YES - ABNORMAL TERM         UL0I 27695918
         CH    R15,SIXTEEN             RETURN CODE =16             UL0I 27705918
         BE    HTERMU                  YES - ABNORMAL TERM         UL0I 27715918
         B     CLOSER3                                                  27725917
HSTOW3   AR    R1,R4                                                    27825917
         L     R15,HWRMSGA                                              27925917
         BALR  R14,R15                                                  28025917
HTERMU   LH    R15,HCONCODE                                             28125917
         NI    HOUXL+4,X'00'           DEACTIVATE                       28225917
         OI    HOUXL+4,X'80'           OUTPUT                           28325917
         NI    HINXL,X'00'             AND INPUT                        28425917
         OI    HINXL,X'80'             EXIT LISTS                       28525917
         B     CLOSER3                                                  28625917
HEOD     DS    0F                      DUMMY                            28725917
         B     CLOSER3                 DUMMY                            28825917
HOUER    EQU   HEOD                    DUMMY                            28925917
HINER    EQU   HEOD                    DUMMY                            29025917
WRTEXMSG ST    R14,SAVE14              SAVE REGISTER 14                 29125917
         L     R1,VADDR2               LOAD ADDRESS OF MESSAGE          29225917
         SR    R14,R14                 LOAD EXIT COUNT                  29325917
         IC    R14,EXCOUNT                                              29425917
         LA    R14,240(R14)            MAKE EBCDIC CODE                 29525917
         STC   R14,0(R1)               STORE NUMBER INTO MESSAGE        29625917
         MVC   11(14,R1),0(R4)         SET ROUTINE IND.                 29725917
         LA    R1,24                   MESSAGE OFSET                    29825917
         SLL   R1,8                                                     29925917
         LA    R4,24                   MSG ID                           30025917
         AR    R1,R4                                                    30125917
         L     R15,HWRMSGA             LOAD MSG WRITER ADDR             30225917
         BALR  R14,R15                 LINK                             30325917
         SR    R5,R5                   CLEAR REGISTERS                  30425917
         SR    R4,R4                   4 &5                             30525917
         IC    R5,LASTRETC             LOAD LAST RETURNCODE             30625917
         LA    R3,10                   DIVIDE BY                        30725917
         DR    R4,R3                   TEN                              30825917
         L     R1,VADDR3               LOAD MSG ADDRESS                 30925917
         LA    R4,240(R4)              MAKE EBCDIC OF FIRST DIGIT       31025917
         LA    R5,240(R5)              MAKE EBCDIC OF SEC  DIGIT        31125917
         STC   R5,21(R1)               STORE FIRST DIGIT                31225917
         STC   R4,22(R1)               STORE SECOND DIGIT               31325917
         LA    R1,25                   LOAD MSG CODE                    31425917
         SLL   R1,8                                                     31525917
         LA    R4,25                   LOAD MSG ID                      31625917
         AR    R1,R4                                                    31725917
         L     R15,HWRMSGA                                              31825917
         BALR  R14,R15                 LINK                             31925917
         MVI   EXCOUNT,X'00'           RESET EXIT COUNT                 32025917
         MVI   LASTRETC,X'00'          RESET LAST RETURN CODE           32125917
         L     R14,SAVE14              RESTORE REGISTER 14              32225917
         BR    R14                     RETURN                           32325917
*                                                                       32425917
CHCONC   CH    R15,HCONCODE            TEST NEW COND.CODE AGAINST OLD   32445917
         BCR   4,R14                   NEW IS LOW-RETURN                32465917
         STH   R15,HCONCODE            OLD IS LOW -STORE NEW ONE        32485917
         BR    R14                     RETURN                           32505917
HDCBIN   DCB   DDNAME=SYSUT1,DSORG=PS,MACRF=(GM),                      *32525917
               EXLST=HINXL,SYNAD=HINER,EODAD=HEOD                       32625917
HDCBOUT  DCB   DDNAME=SYSUT2,DSORG=PS,MACRF=(PM),                      *32725917
               EXLST=HOUXL,SYNAD=HOUER                                  32825917
*                                                                       32925917
HIHLX    LA    R3,OFFSET1              COMPUTE AND LOAD                 33025917
         SR    R15,R3                  THE BASE ADDRESS OF GENR3        33125917
         LR    R2,R15                  IN REGISTER 2                    33225917
         LA    R7,4095(R2)            SET R7 AS SECOND BASEREG @ZA26660 33255999
         LA    R7,1(R7)                INCREASE R7 WITH ONE    @ZA26660 33285999
         ST    R14,SAVE14              SAVE REGISTER 14                 33325917
         MVI   RETURNC,X'04'           SET ASSUMED RETURNCODE           33425917
         TM     8(R1),X'80'            I/O ERROR?                       33525917
         BO    LABIOER1                YES-BRANCH                       33625917
         B     HIHLX1                                                   33725917
HIHRETRN TM    OPENOUTS,X'01'          ARE WE IN OPEN OUTPUT            33735917
         BZ    RETRNA                  NO - BRANCH                      33745917
         LTR   R15,R15                 IS THERE A OUTPUT LABEL          33755917
         BZ    RETRNA                  NO - BRANCH                      33765917
         L     R3,0(R1)                                                 33775917
         LTR   R3,R3                   IS THERE A LABEL BUFFER          33785917
         BZ    RETRNA                  NO - BRANCH                      33795917
         SR    R4,R4                   LOAD NUMBER OF LABELS            33805917
         IC    R4,BACKUP               IN BACK UP AREA                  33815917
         LA    R4,1(R4)                INCREASE BY ONE                  33825917
         STC   R4,BACKUP               STORE NEW NUMBER                 33835917
         L     R4,BACKUPX              LOAD INDEZ IN BACK UP AREA       33845917
         MVC   0(80,R4),0(R3)          MOVE OUTPIT LABEL IN BACK UP     33855917
         LA    R4,80(R4)               AREA AND INCREASE INDEX          33865917
         ST    R4,BACKUPX              STORE NEW INDEX                  33875917
RETRNA   L     R14,SAVE14              RESTORE REG 14                   33885917
         RETURN ,                                                       33925917
HIHLX1   L     R3,0(R1)                FIRST LABEL                      34025917
         LTR   R3,R3                   LABEL BUFFER ADDRESS IS ZERO     34055917
         BZ    CHUSHIEX                YES-BRANCH-TEST USER EXIT        34085917
         CLI   3(R3),X'F1'             OF THE GROUP?                    34125917
         BNE   HIHLX2                  NO-BRANCH                        34225917
         OI    USEXSW,X'80'            RESET USER EXIT SWITCH           34325917
HIHLX2   TM    OPENSW,X'F0'            OPENIN SWITCH ON                 34425917
         BZ    CHUSHIEX                NO-BRANCH                        34525917
         TM    LABPROSW,X'B0'          LABEL PROCESSING IS NO/INPUT     34625917
         BZ    CHUSHIEX                YES-BRANCH                       34725917
         IC    R4,LABPOLAT             LOAD NUMBER OF STORED LABELS     34825917
         LA    R4,1(R4)                INCREASE NUMBER BY ONE           34925917
         STC   R4,LABPOLAT             STORE NUMBER OF LABELS           35025917
         L     R4,HLABINDX             LOAD ADDRESS FOR NEXT LABEL      35125917
         MVC   0(80,R4),0(R3)          MOVE LABEL INTO SAVE AREA        35225917
         LA    R4,80(R4)               UPDATE                           35325917
         ST    R4,HLABINDX             LABEL POOL INDEX                 35425917
CHUSHIEX TM    USEXSW,X'80'            USER EXIT REQUIRED?              35525917
         BZ    SETUSEXS                NO-RETURN                        35625917
         L     R15,ADINUHLR            LOAD ADDRESS OF USER ROUTINE     35725917
         LTR   R15,R15                 TEST FOR USER ADDRESS            35825917
         BZ    SETUSEXS                NO ADDRESS-BRANCH         A44327 35925921
         IC    R14,EXCOUNT             INCREASE                         36025917
         LA    R14,1(R14)              EXIT                             36125917
         STC   R14,EXCOUNT             COUNTER                          36225917
         BALR  R14,R15                                                  36325917
         STC   R15,LASTRETC            STORE LAST RETURN CODE           36425917
AFTLINK1 TM    OPENSW,X'F0'            ARE WE IN OPEN                   36525917
         BZ    RETRFUS                 NO-BRANCH                        36625917
TESTLABP TM    LABPROSW,X'38'          LABEL PROCESS ALL/ONLY/INPUT     36725917
         BZ    RETRFUS                 NO-BRANCH                        36825917
         LTR   R15,R15                 RETURNCODE=0?                    36925917
         BZ    SETUSEXS                YES-BRANCH                       37025917
         CH    R15,SIXTEEN             RETURN CODE=16?                  37125917
         BC    7,HIHRETRN              NO-BRANCH                        37225917
         OI    DELTERSW,X'80'          SET DELAYED TERMINATION SW       37325917
SETUSEXS NI    USEXSW,X'7F'            SET USER EXIT SWITCH OFF         37425917
         SR    R15,R15                 LOAD                             37525917
         IC    R15,RETURNC             RETURNCODE                       37625917
         B     HIHRETRN                RETURN                           37725917
RETRFUS  CH    R15,SIXTEEN             RETURN CODE IS 16                37825917
         BNE   HIHRETRN                NO-BRANCH                        37925917
         OI    HTERMSW,X'FF'           SET USER TERMINATION SWITCH      38025917
         B     HIHRETRN                                                 38125917
LABIOER1 LA    R4,INPUTHDR             LOAD INPUT HEADER IND.           38225917
         BAL   R14,WRTLABER            LINK TO WRITE ROUTINE            38325917
         B     CHUSHIEX                BRANCH TO USER                   38425917
*                                                                       38525917
HITLX    LA    R3,OFFSET2              COMPUTE AND LOAD                 38625917
         SR    R15,R3                  THE BASE ADDRESS OF GENR3        38725917
         LR    R2,R15                  IN REGISTER 2                    38825917
         LA    R7,4095(R2)            SET R7 AS SECOND BASEREG @ZA26660 38855999
         LA    R7,1(R7)                INCREASE R7 WITH ONE    @ZA26660 38885999
         ST    R14,SAVE14              SAVE REGISTER 14                 38925917
         MVI   RETURNC,X'04'            SET ASSUMED RETURCODE           39025917
         TM     8(R1),X'80'            I/O ERROR?                       39125917
         BO    LABIOER2                YES-BRANCH                       39225917
         L     R3,0(R1)                LOAD LABEL BUFFER ADDRESS        39325917
         LTR   R3,R3                   LABEL BUFFER ADDRESS IS ZERO     39355917
         BZ    CHUSTIEX                YES-BRANCH-TEST USER EXIT        39385917
         TM    FIRSTSW,X'F0'      FIRST LABEL ?                  A48786 39575921
         BO    HITLX1             NO, SKIP COUNT/SWITCHES INIT.  A48786 39585921
         OI    USEXSW,X'80'            RESET USER EXIT SWITCH           39625917
         MVI   EXCOUNT,X'00'           RESET EXIT COUNTER               39725917
         MVI   LASTRETC,X'00'                                           39825917
HITLX1   TM    LABPROSW,X'B0'          LABEL PROCESSING IS NO/INPUT     39925917
         BZ    CHUSTIEX                YES-BRANCH                       40025917
         TM    4(R1),X'80'             TEST FOR END OF DATA             40125917
         BNO   CHUSTIEX            NO, INTERMED. TRAILER         A36140 40225921
         TM    FIRSTSW,X'F0'      FIRST LABEL ?                  A48786 40275921
         BO    HITLX2             NO, SKIP COUNT/SWITCHES INIT.  A48786 40285921
         MVI   FIRSTSW,X'F0'      SET FIRSTSW OFF                A48786 40295921
         L     R4,LABPOLAT+4           LOAD ADDRESS OF TRAILER          40525917
         LA    R4,0(R4)                LABEL POOL                       40625917
         ST    R4,TLABINDX             INITIALE LABELPOOL INDEX         40725917
         SR    R4,R4                   SET NUMBER OF                    40825917
         STC   R4,LABPOLAT+4           LABEL IS 0                       40925917
HITLX2   IC    R4,LABPOLAT+4           LOAD NUMBER OF STORED LABELS     41025917
         LA    R4,1(R4)                INCREASE BY ONE                  41125917
         STC   R4,LABPOLAT+4           STORE                            41225917
         L     R4,TLABINDX             LOAD ADDRESS FOR NEXT LABEL      41325917
         L     R3,0(R1)                LOAD ADDRESS OF CURR LABEL       41425917
         MVC   0(80,R4),0(R3)          MOVE LABEL                       41525917
         LA    R4,80(R4)               UPDATE                           41625917
         ST    R4,TLABINDX             LABELPOOL INDEX                  41725917
CHUSTIEX TM    USEXSW,X'80'            USER EXIT REQUIRED               41825917
         BZ    SETUSEXS                NO-RETURN                        41925917
         L     R15,ADINUTLR            LOAD ADDRESS OF USER ROUTINE     42025917
         LTR   R15,R15                 CHECK USER EXIT                  42125917
         BZ    SETUSEXS                NO EXIT-BRANCH            A44327 42225921
         IC    R14,EXCOUNT             UPDATE                           42325917
         LA    R14,1(R14)              EXIT                             42425917
         STC   R14,EXCOUNT             COUNTER                          42525917
         BALR  R14,R15                 LINK                             42625917
         STC   R15,LASTRETC            STORE LAST RETURN CODE           42725917
         B     TESTLABP                BRANCH TO HEADER ROUTINE         42825917
LABIOER2 LA    R4,INPUTTLR             LOAD INPUT TRAILER IND.          42925917
         BAL   R14,WRTLABER            LINK TO WRITE ROUTINE            43025917
         B     CHUSTIEX                BRANCH CHECK FOR USER EXIT       43125917
*                                                                       43225917
HOHLX    LA    R3,OFFSET3              COMPUTE AND LOAD                 43325917
         SR    R15,R3                  THE BASE ADDRESS OF GENR3        43425917
         LR    R2,R15                  IN REGISTER 2                    43525917
         LA    R7,4095(R2)            SET R7 AS SECOND BASEREG @ZA26660 43555999
         LA    R7,1(R7)                INCREASE R7 WITH ONE    @ZA26660 43585999
         ST    R14,SAVE14              SAVE REGISTER 14                 43625917
         MVI   RETURNC,X'08'           SET ASSUMED RETURNCODE           43725917
         TM     8(R1),X'80'            I/O ERROR                        43825917
         BO    LABIOER3                                                 43925917
         TM    OPENOUTS,X'01'          ARE WE IN OPEN                   44025917
         BZ    CHUSHOEX                NO-BRANCH                        44125917
         SR    R4,R4                   ZERO OUT REG 4                   44225917
         IC    R4,LABPOLAT             LOAD NUMBER OF LABELS TO         44325917
         LTR   R4,R4                   STORE AND TEST FOR ZERO          44425917
         BZ    RETRNC0A                ZERO-DO NOT STORE                44525917
         L     R3,0(R1)                LOAD ADDRESS OF LABELBUFFER      44625917
         LTR   R3,R3                   LABEL BUFFER ADDRESS IS ZERO     44655917
         BZ    CHUSHOEX                YES-BRANCH-TEST USER EXIT        44685917
         BCTR  R4,0                    DECREASE NUMBER                  44725917
         STC   R4,LABPOLAT             STORE NEW NUMBER                 44825917
         L     R4,HLABINDX             LOAD ADDRESS FOR NEXT LABEL      44925917
         MVC   0(80,R3),0(R4)          MOVE LABEL INTO BUFFER           45025917
         LA    R4,80(R4)               INCREASE INDEX                   45125917
         ST    R4,HLABINDX             AND RESTORE                      45225917
         TM    USEXSW,X'80'            USER EXIT REQUIRED               45325917
         BZ    SETUSEXS                NO-RETURN                        45425917
CHUSHOEX L     R15,ADOTUHLR            YES-LOAD ADDRESS OF USER         45525917
         LTR   R15,R15                 CHECK USER EXIT                  45625917
         BZ    SETUSEXS                NO EXIT-BRANCH            A44327 45725921
         IC    R14,EXCOUNT             UPDATE                           45825917
         LA    R14,1(R14)              EXIT                             45925917
         STC   R14,EXCOUNT             COUNTER                          46025917
         BALR  R14,R15                 ROUTINE AND LINK                 46125917
         STC   R15,LASTRETC            STORE RETURN CODE                46225917
AFTLINK2 TM    OPENOUTS,X'01'          ARE WE IN OPEN                   46325917
         BZ    RETRFUS                 NO-BRANCH                        46425917
         B     TESTLABP                                                 46525917
RETRNC0A MVI   RETURNC,X'00'           SET RETURNCODE=0                 46625917
         B     CHUSHOEX                                                 46725917
LABIOER3 LA    R4,OTPUTHDR             LOAD OUTPUT HEADER IND.          46825917
         BAL   R14,WRTLABER            LINK                             46925917
         B     CHUSHOEX                BRANCH TO CHECK FOR USER         47025917
*                                                                       47125917
HOTLX    LA    R3,OFFSET4              COMPUTE AND LOAD                 47225917
         SR    R15,R3                  THE BASE ADDRESS OF GENR3        47325917
         LR    R2,R15                  IN REGISTER 2                    47425917
         LA    R7,4095(R2)            SET R7 AS SECOND BASEREG @ZA26660 47455999
         LA    R7,1(R7)                INCREASE R7 WITH ONE    @ZA26660 47485999
         ST    R14,SAVE14              SAVE REGISTER 14                 47525917
         MVI   RETURNC,X'08'           SET ASSUMED RETURNCODE           47625917
         TM    8(R1),X'80'             I/O ERROR                        47725917
         BO    LABIOER4                                                 47825917
         TM    CLOSEOUT,X'02'          ARE WE IN CLOSE ?                47925917
         BZ    CHUSTOEX                NO-BRANCH                        48025917
         SR    R4,R4                   ZERO OUT REG 4                   48125917
         IC    R4,LABPOLAT+4           LOAD NUMBER OF LABELS TO         48225917
         LTR   R4,R4                   STORE AND TEST FOR ZERO          48325917
         BZ    RETRNC0B                ZERO-BRANCH                      48425917
         BCTR  R4,0                    DECREASE NUMBER                  48525917
         STC   R4,LABPOLAT+4           STORE NEW NUMBER                 48625917
         L     R4,TLABINDX             LOAD ADDRESS OF NEXT LABEL       48725917
         L     R3,0(R1)                LOAD ADDRESS OF LABEL BUFFER     48825917
         LTR   R3,R3                   LABEL BUFFER ADDRESS IS ZERO     48855917
         BZ    CHUSTOEX                YES-BRANCH-TEST USER EXIT        48885917
         MVC   0(80,R3),0(R4)          MOVE LABEL INTO BUFFER           48925917
         LA    R4,80(R4)               INCREASE INDEX                   49025917
         ST    R4,TLABINDX             AND RESTORE                      49125917
         TM    USEXSW,X'80'            USER EXIT REQUIRED               49225917
         BZ    SETUSEXS                NO-RETURN                        49325917
CHUSTOEX L     R15,ADOTUTLR            YES-LOAD ADDRESS OF USER         49425917
         LTR   R15,R15                 CHECK USER EXIT                  49525917
         BZ    SETUSEXS                NO EXIT-BRANCH            A44327 49625921
         IC    R14,EXCOUNT             UPDATE                           49725917
         LA    R14,1(R14)              EXIT                             49825917
         STC   R14,EXCOUNT             COUNT                            49925917
         BALR  R14,R15                 ROUTINE AND LINK                 50025917
         STC   R15,LASTRETC            STORE LAST RETURN CODE           50125917
AFTLINK3 TM    CLOSEOUT,X'02'          ARE WE IN CLOSE                  50225917
         BZ    RETRFUS                 NO-BRANCH                        50325917
         B     TESTLABP                                                 50425917
RETRNC0B MVI   RETURNC,X'00'           SET RETURN CODE =0               50525917
         B     CHUSTOEX                                                 50625917
LABIOER4 LA    R4,OTPUTTLR             LOAD OUTPUT TRAILER IND.         50725917
         BAL   R14,WRTLABER                                             50825917
         B     CHUSTOEX                                                 50925917
WRTLABER STM   R13,R1,SAVE14D          SAVE 13 TILL2                    51025917
         LA    R13,PUTSAVAR            POINT13 TO NEW SAVE AREA         51125917
         L     R1,VADDR4               LOAD MESSAGE ADDR.               51225917
         MVC   0(14,R1),0(R4)          MOVE LABEL IND                   51325917
         LA    R1,26                                                    51425917
         SLL   R1,8                                                     51525917
         LA    R4,26                                                    51625917
         AR    R1,R4                                                    51725917
         L     R15,HWRMSGA                                              51825917
         BALR  R14,R15                                                  51925917
         MVI   RETURNC,X'00'           SET RETURN CODE =0               51945917
           LA  R15,12                  LOAD CONDITION CODE =12          51965917
         BAL   R14,CHCONC              TEST FOR HIGHEST                 51985917
         MVI   LABIORSW,X'FF'          SET LABEL I/O ERROR SWIRCH       52005917
         LM    R13,R1,SAVE14D          RESTORE REGISTERS                52025917
         BR    R14                                                      52125917
QSOHLX   TM    8(R1),X'80'             OUTPUT ERROR ON LABEL            52129917
         BO    LABIOER5                YES - BRANCH                     52133917
         SR    R4,R4                   LOAD NUMBER OF LABELS            52137917
         IC    R4,BACKUP               IN BACK UP AREA                  52141917
         LTR   R4,R4                   TEST FOR ZERO                    52145917
         BZ    QSRET0                  ZERO - BRANCH                    52149917
         L     R3,0(R1)                                                 52153917
         LTR   R3,R3                   IS THERE A LAVEL BUFFER          52157917
         BZ    QSRET0                  NO - BRANCH                      52161917
         BCTR  R4,0                    DECREASE NUMBER OF LABELS IN     52165917
         STC   R4,BACKUP               BACK UP AREA AND STORE           52169917
         L     R4,BACKUPX              LOAD INDEX IN BACK UP AREA       52173917
         MVC   0(80,R3),0(R4)          MOVE LABEL TO BUFFER             52177917
         LA    R4,80(R4)               INCREASE BACK UP AREA INDEX      52181917
         ST    R4,BACKUPX              AND STORE                        52185917
         LA    R15,8                   LOAD RETURN CODE                 52189917
         RETURN                                                         52193917
LABIOER5 ST    R14,SAVE14              SAVE REG 14                      52197917
         LA    R4,OTPUTHDR             LOAD OUTPUT HEADER IND.          52201917
         BAL   R14,WRTLABER            LINK TO WRITE ROUTINE            52205917
         L     R14,SAVE14              RESTORE REG 14                   52209917
QSRET0   SR    R15,R15                                                  52213917
         RETURN                                                         52217917
*                                                                       52225917
HINXL    DS    0F                      INPUT EXIT LIST                  52325917
         DC    X'00'                                                    52425900
         DC    AL3(HIHLX)                                               52525917
ITLX     DC    X'00'                                           @ZA30822 53325999
         DC    AL3(HITLX)                                               53375999
INXL     DC    X'85'                    INPUT DCB EXIT         @ZA30822 53425999
         DC    AL3(OPENINXL)                                            55725917
*                                                                       56525917
HOUXL    DS    0F                       OUTPUT EXIT LIST                57325917
         DC    F'0'                    TOTALING AREA ADDRESS            58125917
         DC    X'00'                                                    58925900
         DC    AL3(HOHLX)                                               59725917
         DC    X'00'                                                    60525900
         DC    AL3(HOTLX)                                               61325917
OUXL     DC    X'05'                    OUTPUT DCB EXIT        @ZA30822 61375999
         DC    AL3(OPENOUXL)                                            61425999
JFCB     DC    X'87'                    INDICATE JFCB ENTRY    @ZA30822 61475999
         DC    AL3(JFCBAREA)            ADDRESS TO JFCB AREA   @ZA30822 61525999
*                                                                       63725917
OPENINXL LH    R4,BLKSI(R1)            GET BLKSIZE FROM DCB             64525917
         TM    RECFM(R1),X'C0'   RECFM. UNDEFINED               PTM5314 64725920
         BM    SKIPIN        NO, RECFM F(B) OR V(B)(S)           A36140 64775921
         MVC   LRECL(2,R1),BLKSI(R1)  YES, SET LRECL EQUAL BLKS PTM5314 64825920
         OI    RECFM(R1),X'C0'     SET DEFAULT RECFM TO U.       A36140 64835921
SKIPIN   MVI   BUFNO(R1),ZERO  SET BUFFER TO ZERO                A31435 64875920
         MVC   BUFL(2,R1),ZEROES  SET BUFFER LENGTH TO ZERO      A31435 64925920
         STM  R13,R14,SAVEINP     SAVE REGISTERS                 A36140 64975921
         L     R4,ADINUHLR             WAS INPUT HEADER EXIT     A36140 64976921
         LTR   R4,R4                   ROUTINE SPECIFIED ?       A36140 64977921
         BZ    HGENP4B                 NO, OPEN SYSUT2           A36140 64978921
         LA    R4,INPUTHDR             LOAD INPUT HEADER IND.    A36140 64979921
         BAL   R14,WRTEXMSG            LINK TO WRITE ROUTINE     A36140 64980921
         CLI   HTERMSW,X'FF'      TERMIN USER REQUEST ?          A36140 64985921
         BE    RETINP             YES, END OPEN AND RETURN       A36140 64995921
         B     HGENP4B            OPEN SYSUT2 NOW                A36140 65025921
RETINP   LM    R13,R14,SAVEINP    RESTORE REGISTERS              A36140 65075921
         BR    R14                RETURN TO OPEN SYSUT1          A36140 65125921
*                                                                       68025917
OPENOUXL LH    R4,BLKSI(R1)            GET BLKSIZE FROM DCB             68625917
         TM    RECFM(R1),X'C0'   RECFM. UNDEFINED               PTM5314 68825920
         BM    SKIPOUT       NO, RECFM=F(B)(S) OR V(B)(S)        A36140 68875921
         OI    RECFM(R1),X'C0'     SET DEFAULT RECFM TO U.       A36140 68885921
SKIPOUT  MVI   BUFNO(R1),ZERO  SET BUFFER TO ZERO                A31435 68975920
         MVC   BUFL(2,R1),ZEROES  SET BUFFER LENGTH TO ZERO      A31435 69025920
         STM   R13,R14,SAVEOUT    SAVE REGISTERS                 A36140 69075921
         B     CHKRECFM           GO TO RECFM CHECK ROUTINE      A36140 69125921
RETOUT   LM    R13,R14,SAVEOUT    RESTORE REGISTERS              A36140 69175921
         TM    TAPESW,X'10'       IS TAPE SW1 ON               @ZA30822 69225999
         BO    AFTJFCB            YES, GO BACK AND OPEN UT2    @ZA30822 69275999
         BR    R14                 RETURN TO OPEN                       71725917
*                                                                       72325917
DDERROR  CLI   LABIORSW,X'FF'          TEST LABEL I/O ERROR SWITVH      72525917
         BNE   DDERR1                  NO I/O ERROR - BRANCH            72725917
         MVI   LABIORSW,X'00'          RESET SWITCH                     72925917
         B     HTERMU                  TERMINATE                        73125917
DDERR1   L     R14,VADDR               ADDR OF ERROR MESSAGE     A29998 73625919
         MVC   7(8,R14),0(R15)   MOVE DDNAME TO MSG                     74125917
         LA    R1,15      MSG OFFSET                                    74725917
         SLL   R1,8                                                     75225917
         LA    R4,16      MSG NUMBER                                    75725917
         AR    R1,R4                   COMPUTE COMPLETE MSG CODE        75825917
         L     R15,HWRMSGA             LOAD MSG WRITER ADDRESS          75925917
         BALR  R14,R15                 LINK TO MSG WRITER               76025917
         LA    R15,12      SET CONDITION CODE                           76225917
         STH   R15,HCONCODE                                             76725917
         B     HTERMU                  TERMINATE                        77225917
VADDR    DC    A(DDERROR1)                                              77725917
         EXTRN DDERROR1                                                 78225917
*                                                                       78725917
ERRBLK1  LA    R15,12                  SET RETURN CODE OF 12            79225917
         STH   R15,HCONCODE                                             79725917
         LA    R1,HMSGBLK1             PUT MSG CODE IN BYTE 2           80225917
         SLL   R1,8                       OF REG1                       80725917
         LA    R4,17                   MESSAGE ID                       81225917
         TM    ERRBLKSW,ERRBLKS2  ALSO OUTPUT ERROR ?            A48786 81275921
         BNO   HSTOW3             NO, PRINT MSG IEB317I/IEB312I  A48786 81325921
         AR    R1,R4              ADD MSG ADDR. DISPL.           A48786 81375921
         L     R15,HWRMSGA        LOAD MSG WRITER ADDRESS        A48786 81425921
         BALR  R14,R15            BRANCH TO MSG WR. ROUTINE      A48786 81475921
ERRBLK2  LA    R15,12                  SET RETURN CODE OF 12            82225917
         STH   R15,HCONCODE                                             82725917
         LA    R1,HMSGBLK2             PUT MSG CODE IN BYTE 2           83225917
         SLL   R1,8                       OF REG1                       83725917
         LA    R4,18                   MESSAGE ID                       84225917
         B     HSTOW3                                                   84725917
         DS    0D                                                       84765917
         DC    CL8'DEB.AREA'           SUPERZAP DEBUGGING WORKAREA      84805917
         DC    38F'0'                  SHOULD BE DELETED AT COMPLET     84845917
GENS3SW  DC    X'00'                                                    84885917
EXCOUNT  DC    X'00'                                                    84925917
RETURNC  DC    X'00'                                                    84965917
LABPOLAT DC    2F'0'                   LABEL POOL ADDRESSES TABLE       85005917
BACKUP   DC    F'0'                    BACK UP AREA ADDRESS             85015917
BACKUPX  DC    F'0'                    BACK UP AREA INDEX               85025917
VADDR2   DC    V(HMSGEXIT)                                              85045917
VADDR3   DC    V(HMSGRETC)                                              85085917
LASTRETC DC    X'00'                                                    85125917
INPUTHDR DC    CL14' INPUT  HEADER'                                     85165917
OTPUTHDR DC    CL14'OUTPUT  HEADER'                                     85205917
INPUTTLR DC    CL14' INPUT TRAILER'                                     85245917
OTPUTTLR DC    CL14'OUTPUT TRAILER'                                     85285917
SAVE14D  DS    5F                      SAVE AREA FOR REGS 13-1          85325917
VADDR4   DC    V(HMSGIOER)                                              85365917
R3SAVER  DS    18F                     REGISTER SAVE AREA               85405917
PUTSAVAR DS    18F                     SAVE AREA FOR PUT                85445917
SHOUXL   DS    4C                                                       85485917
HCOPYSW  DS    1C                                                       85525917
HPOID    DS    1C                                                       85565917
LABPROSW DS    1C                                                       85605917
POSWITCH DS    1C                                                       85645917
SAVE14   DS    1F                                                       85685917
SAVEREG1 DS    1F                                                       85725917
SHINXL   DS    1C                                                       85765917
USEXSW   DS    1C                                                       85805917
INPUTDD  DC    8C' '                   AREA FOR INPUT DD NAME    A29998 85815919
OUTPUTDD DC    8C' '                   AREA FOR OUTPUT DD NAME   A29998 85825919
ZEROES   DC    H'0'                                              A31435 85835920
HWRMSGA  DC    V(HWRMSG)                                                85845917
HTERMSW  DC    X'00'                                                    85885917
FIRSTSW  DC    X'00'              FIRST ENTRY SWITCH             A48786 85895921
HCONCODE DC    H'0'                                                     85925917
         DS    0H                                                       85965917
BSREAD   DC    BL2'0010000000000000'                                    86005917
BSWRITE  DC    BL2'0000000000100000'   MACRF FOR BSAM WRITE    @YM02300 86045902
QSGETMOV DC    BL2'0101000000000000'   MACRF FOR GET MOVE               86085917
QSPUTMOV DC    BL2'0000000001010000'   MACRF FOR PUT MOVE               86125917
QSOHLXAD DC    AL3(QSOHLX)                                              86145917
SIXTEEN  DC    H'16'                                                    86165917
TWELVE   DC    H'12'                                               UL0I 86175918
LABIORSW DC    X'00'                                                    86185917
DELTERSW DC    X'00'                                                    86205917
GENS3COP DC    X'00'                                                    86245917
OPENSW   DC    X'00'                                                    86285917
OPENOUTS EQU   OPENSW                                                   86325917
CLOSEOUT EQU   OPENSW                                                   86365917
OFFSET1  EQU   HIHLX-R3START                                            86405917
OFFSET2  EQU   HITLX-R3START                                            86445917
OFFSET3  EQU   HOHLX-R3START                                            86485917
OFFSET4  EQU   HOTLX-R3START                                            86525917
ADINUHLR DC    F'0'                                                     86565917
ADINUTLR DC    F'0'                                                     86605917
ADOTUHLR DC    F'0'                                                     86645917
ADOTUTLR DC    F'0'                                                     86685917
HLABINDX DS    1F                                                       86725917
SAVEINP  DS    2F                 REGISTERS DUR. OPEN UT1        A36140 86735921
SAVEOUT  DS     2F                REGISTERS DUR. OPEN UT2        A36140 86745921
TLABINDX DS    1F                                                       86765917
SYSUT1H  DC    CL8'1 HEADER'                                            86805917
HMSGTLR  DC    CL32'SYSUT         EXIT -REQ.JOB TERM'                   86845917
VADDR1   DC    A(HMSGTLR)                                               86885917
SYSUT2H  DC    CL8'2 HEADER'                                            86925917
TAPESW   DC    X'00'                   TAPE SW1 AND SW2        @ZA30822 86927999
SAVEXPDT DS    CL3                     SAVE AREA FOR EXPDT     @ZA11962 86929999
SAVEIND1 DS    CL1                     SAVE AREA FOR JFCBIND1  @ZA11962 86930399
         DS    0F                                              @ZA11962 86931999
JFCBAREA DS    0CL176                  JFCB AREA               @ZA11962 86935900
JFCBDSNM DS    CL44                    DATA SET NAME           @ZA18366 86937999
JFCBELNM DS    CL8                     MEMBER NAME             @ZA18366 86939999
         DS    CL14                                            @ZA24162 86945999
JFCBLTYP DS    CL1                     LABEL TYP               @ZA24162 86947999
         DS    CL16                                            @ZA24162 86949999
JFCBXPDT DS    CL3                     EXPDT DATE              @ZA11962 86955900
JFCBIND1 DS    CL1                     JFCBIND1                @ZA11962 86956399
JFCBIND2 DS    CL1                     JFCBIND2                @ZA18366 86956799
         DS    CL5                                             @ZA30822 86957999
JFCBDEV  DS    CL1                                             @ZA30822 86958799
         DS    CL4                                             @ZA30822 86959599
JFCDSORG DS    CL2                                             @ZA30822 86960399
JFCRECFM DS    CL1                                             @ZA30822 86961199
JFCOPTCD DS    CL1                                             @ZA30822 86961999
JFCBLKSI DS    CL2                                             @ZA30822 86962799
JFCLRECL DS    CL2                                             @ZA30822 86963599
         DS    CL70                                            @ZA30822 86964399
         ENTRY GENS3COP                                                 86965917
         ENTRY HMSGTLR                                                  87005917
         ENTRY HDCBIN                                                   87045917
         ENTRY HDCBOUT                                                  87085917
SYSUT2T  DC    CL8'2 TRAILR'                                            87125917
SYSUT1T  DC    CL8'1 TRAILR'                                            87165917
HOUP2J   EQU   CLOSER3                 DUMMY                            87205917
HINDD    EQU   24                                                       87245917
HOUDD    EQU   32                                                       87745917
HMSDELTR EQU   22                                                       88245917
ZERO     EQU   0                                                 A31435 88445920
HMSGIIP  EQU   1                                                        88745917
HMSGBLK1 EQU   17                                                       89245917
HMSGBLK2 EQU   18                                                       89745917
HMSEQDCB EQU   51                 WARNING MESSAGE IEB352I        A48786 89795900
LIXL     EQU   1                                                        90245917
LOXL     EQU   4                                                        90745917
MLABONLY EQU   23                                                       91245917
ERRBLKSW DC    FL1'0'                  NO BLKSIZE SPECIFIED --          91745917
ERRBLKS1 EQU   1                            FOR INPUT DCB               92245917
ERRBLKS2 EQU   2                            FOR OUTPUT DCB              92745917
         DCBD  DSORG=PS                                                 93245917
DDNAM    EQU   DCBDDNAM-IHADCB                                          93745917
OFLGS    EQU   DCBOFLGS-IHADCB                                          94245917
DSORG    EQU   DCBDSORG-IHADCB                                          94745917
BLKSI    EQU   DCBBLKSI-IHADCB                                          95245917
KEYLE    EQU   DCBKEYLE-IHADCB                                          95745917
BUFNO    EQU   DCBBUFNO-IHADCB                                   A31435 95945920
BUFL     EQU   DCBBUFL-IHADCB                                           96245917
RECFM    EQU   DCBRECFM-IHADCB                                          96745917
EXLST    EQU   DCBEXLSA-IHADCB                                 @ZA16460 96795900
LRECL    EQU   DCBLRECL-IHADCB                                          97245917
MACRF    EQU   DCBMACR-IHADCB                                           97745917
IND2     EQU   DCBCIND2-IHADCB                                 @YM03265 97795902
         END                                                            98245917
./  ADD  SSI=71290010,NAME=IEBGENS3
         TITLE 'IEBGENS3-VARIABLE SPANNED RECORD PROCESSOR (RLS 17)'    00080017
*********************************************************************** 00160017
*                                                                     * 00240017
*                        * * * I E B G E N S 3 * * *                  * 00320017
*                              ***************                        * 00400017
*                                                                     * 00480017
*      THIS IS THE MODULE OF THE IEBGENER DATASET UTILITY, THAT       * 00560017
*      PROCESSES VARIABLE SPANNED RECORD DATASETS                     * 00640017
*      IT GETS CONTROL AFTER IEBGENR3 HAS OPENED THE DATASETS FOR     * 00720017
*      INPUT AND OUTPUT, AND FOUND THAT AT LEAST ONE OF THE DATASET   * 00800017
*      HAS A RECFM=VS OR RECFM=VBS                                    * 00880017
*      THIS MODULE USES THE BSAM ACCESS METHOD IF THERE IS NO CHANGE  * 00960017
*      IS REQUIRED OF ANY KIND IN BLOCKSIZE,LRECL OR RECFM            * 01040017
*      IN ALL OTHER CASES THE QSAM ACCESS METHOD IS USED              * 01120017
*      IT CONTROLS LINKAGE TO EDIT AND CONVERSION ROUTINES FOR        * 01200017
*      SPECIAL PROCESSING DICTATED BY THE IEBGENER CONTROL CARDS      * 01280017
*      AFTER PROCESSING IS COMPLETED IT WILL RETURN CONTROL TO        * 01360017
*      IEBGENR3                                                       * 01440017
*                                                                     * 01530017
*                         * * * * * * * * *                           * 01620017
*                                                                     * 01710017
*                             E N T R Y                               * 01800017
*                                                                     * 01890017
*      THE SUBROUTINE HAS ONE EXTERNALLY REFERENCABLE ENTRY POINT     * 01980017
*      WHOSE SYMBOLIC NAME IS:                                        * 02070017
*                            H G E N P S 3                              02160017
*                                                                     * 02250017
*                         * * * * * * * * *                           * 02340017
*                                                                     * 02430017
*                             I N P U T                               * 02520017
*                                                                     * 02610017
*      THE SUBROUTINE IS ENTERED WITH OP REGISTER 1  POINTING TO      * 02700017
*      A LIST IN WHICH ARE THE ADDRESSES OF TABLES CONSTRUCTED BY     * 02790017
*      THE I E B G S C A N SUBROUTINE ACCORDING TO THE PARAMETERS     * 02880017
*      SPECIFIED IN THE UTILITY CONTROL CARDS. MAIN  STORAGE  FOR     * 02970017
*      THESE TABLES IS GOTTEN AND RELEASED OUTSIDE THIS ROUTINE.      * 03060017
*                                                                     * 03150017
*********************************************************************** 03240017
         EJECT                                                          03330017
*********************************************************************** 03420017
*                                                                     * 03510017
*                             E X T R N                               * 03600017
*                                                                     * 03690017
*      THE SUBROUTINE REFERENCES THESE EXTERNALLY DEFINED  VALUES     * 03780017
*      OR SUBROUTINE NAMES:                                           * 03870017
*                             H M O V E                               * 03960017
*              A CLOSED SUBROUTINE USED BY THIS ROUTINE               * 04050017
*              TO MOVE RECORDS OF ANY SIZE IN CORE                    * 04140017
*                                                                     * 04230017
*                             H E D I T                               * 04320017
*              A CLOSED SUBROUTINE USED BY THIS ROUTINE               * 04410017
*              TO EXECUTE THE EDITING SPECIFIED BY THE                * 04500017
*              UTILITY CONTROL CARDS.                                 * 04590017
*                                                                     * 04680017
*                              H P R L                                * 04770017
*              A CLOSED SUBROUTINE USED BY THIS ROUTINE               * 04860017
*              TO ESTABLISH THE LENGTH OF AN OUTPUT RE-               * 04950017
*              CORD ACCORDING TO THE EDIT PARAMETERS.                 * 05040017
*                                                                     * 05130017
*                            H W R M S G                              * 05220017
*                                                                     * 05310017
*              A CLOSED SUBROUTINE USED BY THIS ROUTINE               * 05400017
*              TO WRITE MESSAGES ISSUED BY THIS ROUTINE               * 05490017
*              ON THE DEVICE SPECIFIED BY SYSPRINT  DD-               * 05580017
*              NAME.                                                  * 05670017
*                                                                     * 05760017
*                          D D E R R O R 1                            * 05850017
*                                                                     * 05940017
*              A MESSAGE USED AS A DIAGNOSTIC WHEN DATA               * 06030017
*              DEFINITION STATEMENT NAMES ARE IMPROPER-               * 06120017
*              LY SPECIFIED TO THE PROGRAM.                           * 06210017
*                                                                     * 06300017
*********************************************************************** 06390017
         EJECT                                                          06480017
*********************************************************************** 06570017
*                                                                     * 06660017
*                   E R R O R   C O N D I T I O N                     * 06750017
*                                                                     * 06840017
*      THE SUBROUTINE WILL TERMINATE PROCESSING, CAUSE AN APPROP-     * 06930017
*      RIATE DIAGNOSTIC MESSAGE TO BE PRINTED AND RETURN VIA REG-     * 07020017
*      ISTER 14 UPON RECOGNITION OF THE FOLLOWING TYPES OF ERROR:     * 07110017
*                                                                     * 07200017
*              1.PERMANENT I/O ERROR ON EITHER INPUT OR               * 07290017
*                OUTPUT DATA SET.                                     * 07380017
*              2.ANY CONTROL STATEMENT ERROR UNABLE  TO               * 07470017
*                BE DETERMINED AT CONTROL CARD  PROCES-               * 07560017
*                SING TIME,I.E.-PARAMETERS WHICH ARE AT               * 07650017
*                VARIANCE WITH INCOMING DATA.                         * 07740017
*             3.DATA FORMAT ERRORS NOT APPRENT TO THE                 * 07840017
*               QSAM ACCESS METHOD                                    * 07940017
*                                                                     * 08040017
*                         * * * * * * * * *                           * 08140017
*                                                                     * 08240017
*                             N O T E S                               * 08340017
*                                                                     * 08440017
*      THIS SUBROUTINE IS 'ONLY LOADABLE'.IT IS NOT RE-ENTRANT;IT     * 08540017
*      IS NOT RE-USABLE.                                              * 08640017
*                                                                     * 08740017
*********************************************************************** 08840017
         EJECT                                                          08940017
IEBGENS3 CSECT                                                          09040017
* THIS MODULE WAS CREATED IN RELEASE 17 FOR SUPPORT OF VRE            * 09110017
*561500,580700,820500                                            A22671 09130018
* 108800,110300                                                   M2461 09140018
* 382100                                                         A25958 09146019
* 552700-564700,588300-598300                                    A27717 09152019
*                                                                A33312 09156020
* 135600-138600                                                  A35449 09158020
*166100-167100,171100-172100,173100,623300-635300               PTM5314 09158420
*A626300-627100,629800-630700                                    A45131 09158521
*D403100,626300,626800,629800-631300                             A45131 09158621
*A173100-174700,176600-177080,623900                             A45145 09158821
*D173100,174100                                                  A45145 09159221
*C177100,840200                                                  A45145 09159621
*A283100,283600,533900                                           A48738 09160021
*D283100                                                         A48738 09170021
*A441600-442100,443100-443500,456700,458300,624500,              A48746 09180021
*A631100-633800,840250                                           A48746 09182021
*D443100,456700,458300,631000-633300                             A48746 09190021
*A578000,578800-579000                                           A48809 09192021
*C573500,575100                                                  A48809 09194021
*D591300                                                         A48809 09196021
*D443400-443460                                                @ZA03375 09198003
*   REGISTER ASSIGNMENT                                                 09200021
R0       EQU   0                                                        09210017
R1       EQU   1                                                        09260017
R2       EQU   2                                                        09310017
R3       EQU   3                                                        09360017
R4       EQU   4                                                        09410017
R5       EQU   5                                                        09460017
R6       EQU   6                                                        09510017
R7       EQU   7                                                        09560017
R8       EQU   8                                                        09610017
R9       EQU   9                                                        09660017
R10      EQU   10                                                       09710017
R11      EQU   11                                                       09760017
R12      EQU   12                                                       09810017
R13      EQU   13                                                       09860017
R14      EQU   14                                                       09910017
R15      EQU   15                                                       09960017
HGENPS3  SAVE  (14,12)                                                  10010017
         LR    R2,R15                                                   10060017
         USING HGENPS3,R2                                               10110017
         LA    R3,HGENPRS               LOAD WORK AREA ADDRESS          10160017
         ST    R3,8(R13)                AND STORE IT                    10210017
         STM   R13,R14,HSAVE13                                          10260017
         LA    R13,HGENPRS                                              10310017
         L     R3,0(R1)                 LOAD EXIT TABLE ADDRESS         10360017
         ST    R3,HEXITTA               STORE EXIT TABLE ADDRESS        10410017
         MVC   HMDTCUR(16),64(R3)       STOER SWITCHES                  10460017
         MVC   HMDTCUR+16(1),93(R3)     STORE PO SWITCH                 10510017
         MVC   HPOID(1),94(R3)                                          10560017
         MVC   LABPOLAT(8),80(R3)      MOVE LABEL POOL ADDRESSES        10610017
         MVC   TOTLAREA+12(4),88(R3)   MOVE TOTALING AREA ADDRESS  UL0I 10660018
         MVC   LABPROSW(1),92(R3)      MOVE LABEL PROCESSING SWITC      10710017
         L     R12,HDCBINA             LOAD SYSUT1DCB ADDRESS           10760017
         MVC   EODADOFS(3,R12),HEODAD+1 MOVE EODAD ROUT.ADD AND         10810017
         MVC   SYNADOFS+1(3,R12),HINERAD+1  PUT SYNAD ADDR IN DCB M2461 10880018
         L     R4,HDCBOUTA             STORE SYNAD ROUT,ADDRESS         10960017
         MVC   SYNADOFS+1(3,R4),HOUERAD+1  PUT SYNAD ADDR IN DCB  M2461 11030018
         ST    R4,TOTLAREA+4           STORE DCB ADDRESS IN LIST        11110017
         CLI   0(R3),X'40'             TOTALING SPECFIED                11160017
         BE    HGENP5A                 NO-BRANCH                        11210017
         OI    TOTLEXSW,X'80'          SET TOTALING EXIT SWITCH         11260017
         LR    R10,R3                                                   11310017
         LOAD  EPLOC=(10)              LOAD USER ROUTINE                11360017
         LOAD  EPLOC=(R10)             LOAD USER ROUTINE                11410017
         ST    R0,ADTOTEXR             STORE ADDRESS                    11460017
HGENP5A  TM    HPOID,X'02'             PDS?                             11510017
         BZ    HGENP5B                 NO-BRANCH                        11560017
         L     R10,HDCBOUTA            LOAD SYSUT2 DCB ADDRESS          11610017
         TM    RECFM(R10),X'48'        IS SYSUT2 VS                     11660017
         BNO   HGENP5B                 NO-BRANCH                        11710017
         LA    R1,29                   YES-SET ERROR OFFSET             11760017
         SLL   R1,8                    AND                              11810017
         LA    R4,29                   MSESAGE ID.                      11860017
         B     ERRORPNT                AND BRANCH                       11910017
HGENP5B  L     R1,GENCOPAD                                              11960017
         TM    0(R1),X'80'             STRAIGHT COPY?                   12010017
         BZ    S3COLDAT                NO-BRANCH                        12060017
         MVC   EODADOFS(3,R5),STHEODAD+1 MOVE EODAD TO DCB              12110017
         LH    R6,BLKSI(R5)            LOAD BLOCKSIZE                   12160017
         SR    R10,R10                 ADJUST BLOCK LENGTH              12210017
         IC    R10,16(R5)              FOR                              12260017
         AR    R6,R10                  POSSIBLE KEYS                    12310017
         LR    R10,R6                  MULTIPLY                         12360017
         SLL   R10,1                   BLOCKSIZE WITH THREE             12410017
         AR    R10,R6                  TO GET TOTAL BUFFER AREA         12460017
         ST    R10,LNGTHBFS            SAVE TOTAL LENGTH OF BUFFER UL0I 12480019
         GETMAIN  R,LV=(R10)              GET STORAGE                   12510017
         ST    R1,FIRSTBUF             STORE ADDRESS OF 1ST BUFFER      12560017
         AR    R1,R6                                                    12610017
         ST    R1,SECNDBUF             STORE ADDRESS OF 2ND BUFFER      12660017
         AR    R1,R6                                                    12710017
         ST    R1,THIRDBUF             STORE ADDRESS OF 3RD BUFFER      12760017
         L     R6,HDCBOUTA             LOAD OUTPUT DCB ADDRESS          12810017
         OI    BCNTRLSW,X'FF'          RESET BRANCH CONTROL SWITCHS     12860017
         L     R5,FIRSTBUF             LOAD INPUT BUFF ADDRESS          12910017
         BAL   R12,HREAD               LINK TO READ                     12960017
STRCOP1  SR    R4,R4                                                    13010017
         CHECK HDECBIN                 CHECK READ                       13060017
         TM    BCNTRLSW,X'01'          BRANCH REQUIRED                  13110017
         BO    STRCOP3                 YES BRANCH                       13160017
         TM    BCNTRLSW,X'02'          BRANCH REQUIRED                  13210017
         BO    STRCOP2                                                  13260017
         CHECK HDECBOUT                                                 13310017
STRCOP2  NI    BCNTRLSW,X'FD'          RESET 2ND BRANCH BIT             13360017
         CALL  HMOVE,(THIRDBUF,SECNDBUF,LNGTHBF2)                       13410017
         MVC   LNGTHBF3(4),LNGTHBF2    MOVE LENGTH OF DATA              13460017
STRCOP3  NI    BCNTRLSW,X'FE'          RESET 1ST BRANCH BIT             13510017
         L     R9,HDECBIN+8       GET SYSUT1 DCB ADDRESS         A35449 13560020
         L     R10,HDECBIN+16     GET SYSUT1 IOB ADDRESS         A35449 13610020
         LH    R10,14(R10)        GET RESIDUAL COUNT             A35449 13660020
         LH    R9,62(R9)           GET BLKSIZE FROM DCB          A35449 13710020
         SR    R9,R10             CALCULATE LENGTH LAST BLOCK    A35449 13760020
         ST    R9,LNGTHBF1        SAVE THIS LENGTH               A35449 13810020
         CALL  HMOVE,(SECNDBUF,FIRSTBUF,LNGTHBF1)                       13910017
         MVC   LNGTHBF2(4),LNGTHBF1    MOVE LENGTH                      13960017
         TM    BCNTRLSW,X'04'          BRANCH REQUIRED                  14010017
         BO    STRCOP4                 YES-BRANCH                       14060017
         L     R6,THIRDBUF                                              14110017
         BAL   R12,CHTOTEXT            TOTALING?                        14160017
         BAL   R12,HWRITE              WRITE                            14210017
STRCOP4  NI    BCNTRLSW,X'FB'          RESET THIRD BRANCH BIT           14260017
         L     R5,FIRSTBUF             LOAD INPUT BUFF ADDRESS          14310017
         BAL   R12,HREAD                                                14360017
         L     R5,SECNDBUF                                              14410017
         BAL   R12,TSTDATAX            TEST DATA EXIT                   14460017
         B     STRCOP1                                                  14510017
         LA    R1,HMSGTDR                                               14560017
         SLL   R1,8                                                     14610017
         LA    R4,7                                                     14660017
         B     HOUP2J                                                   14710017
********                                                                14760017
STRCPEOD L     R15,LNGTHBF1            LOAD LENGTH OF READ DATA         14770017
         LTR   R15,R15                 TEST FOR ZERO                    14780017
         BZ    OKMESG                  NO DATA READ - RETURN            14790017
         L     R15,LNGTHBF3            LOAD LENGTH OF WRITTEN DATA      14800017
         LTR   R15,R15                 TEST FOR ZERO                    14810017
         BZ    EODMVBF2                NO WRITES DONE - BRANCH          14820017
         CHECK  HDECBOUT               CHECK LATEST WRITE               14830017
EODMVBF2 CALL  HMOVE,(THIRDBUF,SECNDBUF,LNGTHBF2)                       14840017
         MVC   LNGTHBF3(4),LNGTHBF2                                     14910017
         L     R6,THIRDBUF                                              14960017
         BAL   R12,CHTOTEXT            CHECK TOTALING EXIT              15010017
         BAL   R12,HWRITE              WRITE LAST BLOCK                 15060017
         CHECK HDECBOUT                CHECK THE WRITE                  15110017
         L     R0,LNGTHBFS             LOAD TOTAL LENGTH OF BUFFER UL0I 15120019
         FREEMAIN  R,LV=(0),A=FIRSTBUF FREE BUFFER SPACE           UL0I 15130019
         B     OKMESG                  WRITE EOD MSG AND RETURN         15160017
*                                                                       15210017
HWRITE   L     R10,LNGTHBF3                                             15260017
         WRITE HDECBOUT,SF,HDCBOUT,(6),(10)                             15310017
         BR    R12                                                      15360017
GENCOPAD DC    V(GENS3COP)                                              15410017
FIRSTBUF DC    F'0'                                                     15460017
SECNDBUF DC    F'0'                                                     15510017
THIRDBUF DC    F'0'                                                     15560017
LNGTHBF1 DC    F'0'                                                     15610017
LNGTHBF2 DC    F'0'                                                     15660017
LNGTHBF3 DC    F'0'                                                     15710017
LNGTHBFS DC    F'0'                    TOTAL BUFFER LENGTH         UL0I 15730019
BCNTRLSW DC    X'FF'                                                    15760017
********                                                                15810017
S3COLDAT BAL   R14,INOUTSET                                             15860017
HINP1    L     R5,HIN1AD           PREPARE REGS FOR PROCESSING          15910017
         L     R6,HOU2AD           RECORDS BY LOADING BUFFER ADDRS      15960017
HINP1A   ST    R6,HOU2AD                INITIALIZE OUTPUT XR            16010017
         MVC   CPYSWSAV(1),HCOPYSW                                      16060017
         TM    HCOPYSW,X'FF'            EDITING WITH IDENT              16110017
         BO    HINP1A1                                                  16160017
         BM    HINP1A1                                                  16210017
         L     R9,HRDTCUR               YES                             16260017
         TM    0(R9),X'20'              EDITING THIS RECORD             16310017
         BO    HINP1A1                  YES                             16360017
         OI    HCOPYSW,HCOPYMSK         NO, SET COPY SWITCH             16410017
HINP1A1  L     R1,HDCBINA                                               16460017
         L     R5,HIN1AD                LOAD INPUT ADDRESS              16510017
         GET   (1),(5)                                                  16560017
         L     R11,HDCBINA   LOAD SYSUT1 DCB ADDRESS            PTM5314 16610020
         TM    RECFM(R11),X'80'    RECFM FIXED OR UNDEFINED ?   PTM5314 16660020
         BZ    GETVARLE           NO, GET LRECL OUT OF BLK.     PTM5314 16710020
         LH    R10,LRECL(R11)          FROM DCB                         16760017
         B     HINP3N                                                   16810017
GETVARLE LH    R10,0(R5)               FOR U AND V GET LRECL FROM       16860017
         LA    R5,4(,R5)     UPDATE POINTER TO REC.             PTM5314 16870020
HINP3N   ST    R10,HBLIN               WORK AREA AND STOR               16910017
         STH   R10,HRLIN                STORE RECORD LENGTH             16960017
         LH    R7,HRLIN                 RESET INPUT ARS                 17010017
         STH   R7,HWK2                                                  17060017
HINP7A   L     R12,HDCBINA             LOAD INPUT DCB ADDRESS           17260017
         CLC    HWK2(2),LRECLINP   IS REC CNT GR. THAN INL REC ? A45145 17310021
         BH    HINER2              YES--PERM INPUT ERROR         A45145 17410021
         TM    RECFM(12),X'80'     RECFM EQ. F OR U ?            A45145 17460021
         BO    TESTFU              YES, SKIP V TEST              A45145 17470021
         CLC   HWK2(2),HH4              IS REC CT LESS THAN 4           17510017
         BNH   HINER2                   YES--PERM INPUT ERROR           17610017
         B     HINP7A3             SKIP U TEST                   A45145 17660021
TESTFU   CLC   HWK2(2),HH0         LRECL EQ ZERO ?               A45145 17670021
         BE    TESTU               YES, TEST RECFM               A45145 17680021
         B     HINP7A3             CONT NORM PROCCESS.           A45145 17690021
TESTU    TM    HINORG,X'20'        INPUT RECFM=U ?               A45145 17700021
         BNO   HINER2              NO, PERM. INP. ERROR          A45145 17702021
         TM    17(12),X'50'        INPUT DEV. IS PAPER TAPE ?    A45145 17704021
         BNO   HINER2              NO, PERM. INP. ERROR          A45145 17706021
         B     HINP1A1             YES, GET NEXT RECORD          A45145 17708021
HINP7A3  TM    HCOPYSW,HCOPYMSK    PREDICT 1ST OUTPUT REC LENGTH A45145 17710021
         BZ    HINP8                    IF COPY,                        17810017
         BAL   R12,ANYBODY              SET HRLPRE                      17910017
HINP7B   NOP   HOUP1                                                    18010017
         OI    HINP7B+1,X'F0'           FIRST TIME THROUGH,             18110017
HINP7C   LA    R8,0                                                     18210017
         TM    HOUORG,X'80'             IF F-TYPE , DO NOT ADJUST       18310017
         BO    HOUP1                    XR AND ARS                      18410017
         LA    R8,4(,R8)                ADJUST XR AND ARS               18510017
         MVC   2(2,R6),HH0         ZERO THE RECORD BB FIELD             18610017
         B     HINP7B                   BEFORE OUTPUT                   18710017
HINP8    NOP   HOUP1                    IF EDIT,GO TO HPRL              18810017
         BAL   R12,HPREDLEN             PREDICT LENGTH OF FIRST REC GRP 18910017
         OI    HINP8+1,X'F0'                                            19010017
         B     HINP7B                                                   19110017
HOUP1    BAL   R12,ANYBODY              SET HRLPRE                      19210017
HOUP1A   B     HOUP4                   BYPASS PUT RTN 1ST TIME   A33312 19310020
         AH    R8,HRLPRE               ADD DATA COUNT            A33312 19410020
         B     HOUP2C                                                   19510017
HOUP2J   AR    R1,R4                                                    19610017
         L     R15,HWRMSGA                                              19710017
         BALR  R14,R15                                                  19810017
         B     HTERMU                   TERMINATE                       19910017
HOUP2C   TM    HOUORG,X'80'             IF F-TYPE LOAD RECORD           20010017
         BO    HOUP2E                   LENGTH IN DCB                   20110017
         B     HOUP3                                                    20210017
HOUP2E   TM    HOUORG,X'80'                                             20310017
         BZ    HOUP3                                                    20410017
         L     R10,HDCBOUTA            MODIFY DCB LENGTH                20510017
         LTR   R8,R8                                                    20610017
         BC    8,NOWRITE                                                20710017
         STH   R8,LRECL(R10)                                            20810017
         B     HOUP3                                                    20910017
HOUP3    ST    R8,HBLOUAC                                               21010017
         L     R6,HOU2AD                SET XR TO OUTPUT AREA           21110017
         BAL   R12,CHTOTEXT                                             21210017
         B     HOUP3B3                                                  21310017
CHTOTEXT TM    TOTLEXSW,X'80'          TEST TOTALING EXIT               21410017
         BZ    HOUP3B2                 NO EXT - BRANCH                  21510017
         ST    R6,TOTLAREA             POINTTOTAL ROUT. TO BUFFER  UL0I 21610018
         LA    R1,TOTLAREA             LOAD ADDRESS OF PARAMETERS       21710017
         L     R15,ADTOTEXR            LOAD ADDRESS OF USER ROUT.       21810017
         BALR  R14,R15                                                  21910017
         CH    R15,HCONCODE            UPDATE HIGHEST COND.CODE         22010017
         BL    HOUP3B1                 IF                               22110017
         STH   R15,HCONCODE            NESSECARY                        22210017
HOUP3B1  CH    R15,SIXTEEN             RETRN CODE = SIXTEEN?            22310017
         BE    TOTMSG1                 YES-TERMINATE                    22410017
         CH    R15,EIGHT               RETURN CODE=EIGHT?               22510017
         BE    TOTMSG2                 YES-GO TO END OF DATA            22610017
         CH    R15,FOUR                RETRNCODE=FOUR                   22710017
         BE    HOUP3B2                 YES-BRANCH                       22810017
         B     TOTMSG3                                                  22910017
HOUP3B2  BR    R12                                                      23010017
HOUP3B3  DS    0H                                                       23110017
         L     R1,HDCBOUTA                                              23210017
         PUT   (1),(6)                                                  23310017
         L     R10,HMDTCUR              LOAD MEMBER TRUE NAME           23510017
         MVC   HSTOWAR(8),2(R10)        LOAD MEMBER TRUE NAME           23710017
         XC    HSTOWAR+8(4),HSTOWAR+8   ZERO OUT C BYTE                 23910017
NOWRITE  EQU   *                                                        24110017
         TM    HSTOWSW,X'FF'           DISC OR TAPE ?                   24310017
         BZ    HOUP3F                  NO STOW, GO TO HOUP3F            24510017
HOUP3C   BAL   R12,HSTOW                STOW TRUE NAME                  24710017
         LH    R11,0(R10)               LOAD ALIAS COUNT                24910017
         LA    R10,10(,R10)             UPDATE MDT XR                   25110017
         LTR   R11,R11                                                  25310017
         BZ    HOUP3E                                                   25510017
HOUP3D   MVI   HSTOWAR+11,X'80'         SET ALIAS BIT IN C BYTE         25710017
         MVC   HSTOWAR(8),0(R10)        LOAD ALIAS                      25910017
         BAL   R12,HSTOW                STOW ALIAS                      26110017
         LA    R10,8(,R10)              UPDATE MDT XR                   26310017
         BCT   R11,HOUP3D                                               26510017
HOUP3E   ST    R10,HMDTCUR              STORE UPDATED MDT ADDRESS       26710017
         NI    HSTOWSW,X'00'            TURN OFF STOW SWITCH            26910017
HOUP3F   NOP   HOUP4F                   SWITCH FOR EOD                  27110017
         L     R6,HOU2AD                RESET OUTPUT XR                 27310017
         LA    R8,0                    RESET OUTPUT ARS                 27510017
         TM    HOUORG,X'80'            IF V OR U                        27710017
         BO    HOUP4B                  ADJUST                           27910017
         LA    R8,4(,R8)                AND ARS                         28110017
HOUP4    NOP   HOUP4F             BRANCH WHEN EOD IS REACHED     A48738 28310021
         NI    HOUP1A+1,X'0F'     RESET FIRST TIME SWITCH        A48738 28360021
         TM    HOUORG,X'80'             IF F-TYPE DO NOT                28410017
         BO    HOUP4B                   ADJUST XR AND ARS               28510017
HOUP4A   LH    R9,HRLPRE                LET RECORD COUNT                28610017
         LA    R9,4(,R9)                FIELD REFLECT                   28710017
         STH   R9,HALFWORK              PLACE LENGTH IN STORAGE         28810017
         MVC   0(2,R6),HALFWORK         MOVE LENGTH INTO CT FIELD       28910017
         MVC   2(2,R6),HH0         ZERO BLOCK BB FIELD                  29010017
         LA    R6,4(,R6)                DISPLACE PAST RECORD COUNT      29110017
HOUP4B   ST    R6,HIXOUT                STORE CURR REC ADDR FOR SYSUT1  29210017
         ST    R5,HIXIN                 AND SYSUT2                      29310017
         BAL   R12,TSTDATAX                                             29410017
         B     HOUP4C1                                                  29510017
TSTDATAX L     R9,HEXITTA              LOAD USER EXIT TABLE ADDRESS     29610017
         ST    R12,SAVER12                                              29710017
         LTR   R9,R9                    IF NO EXITS,                    29810017
         BZ    HOUP4C                   SKIP TEST                       29910017
         CLI   40(R9),X'40'                                             30010017
         BE    HOUP4C                   IF USER DATA EXIT,LINK          30110017
         LA    R9,40(R9)               SET UP ADDERSS                   30210017
         L     R12,HDCBINA                                              30310017
         LR    R11,R5                   USER EXIT TABLE                 30410017
         LINK  EPLOC=(9),PARAM=((11),(12))                              30510017
         SR    R1,R1                                                    30610017
         BAL   R12,HTSTTRM              TEST FOR TERMINATION REQ        30710017
         B     HOUP4C                   NO                              30810017
         LA    R1,HMSGTDR               YES                             30910017
         SLL   R1,8                                                     31010017
         LA    R4,7                     MESSAGE ID 7                    31110017
         B     HOUP2J                   WRITE MESSAGE AND TERMINATE     31210017
HOUP4C   L     R12,SAVER12                                              31310017
         BR    R12                                                      31410017
HOUP4C1  TM    HCOPYSW,HCOPYMSK        TEST COPY SWITCH                 31510017
         BZ    HOUP4D                                                   31610017
HOUP4M   BAL   R12,HRIDTST                                              31710017
         MVC   HWK4+2(2),HRLPRE                                         31810017
         CALL  HMOVE,(HIXOUT,HIXIN,HWK4) SYSUT1 BUFF2 TO SYSUT2 BUFF2   31910017
         B     HOUP4E                                                   32010017
HOUP4D   BAL   R12,HRIDTST              MOVE REC WITH EDITING           32110017
         MVC   HWK2(2),HRLPRE           HWK2=DATA COUNT                 32210017
HOUP4X   CALL  HEDIT,(HEDCUR,HIXOUT,HIXIN,HWK2,HLITTA)                  32310017
         B     HOUP4E                   NORMAL RETURN FROM EDITOR       32410017
         B     HPREDLN2                 ERROR RETURN FROM EDITOR        32510017
HOUP4E   AH    R6,HRLPRE                UPDATE XR                       32610017
HOUP4F   TM    HEODSW,HEODMSK           IF PROCESSING TO END AT EOD,    32710017
         BO    HOUP5A                   OMIT LAST RECORD CHECK          32810017
         CLI   HRIDSW,X'FF'             TEST FOR LAST REC OF GROUP      32910017
         BE    HOUP5B                                                   33010017
HOUP5A   NOP   HOUP9              GO CLOSE AT EOD                       33110017
         B     HINP1A1                                                  33210017
HOUP5B   L     R9,HRDTCUR                                               33310017
         ST    R9,HRDTSAV                                               33410017
         TM    HPOID,X'02'              PDS?                            33510017
         BZ    HOUP5D                   NO                              33610017
         TM    HMEMBYT(R9),X'0F'        END OF MEMBER?                  33710017
         BZ    HOUP5F                   NO                              33810017
         OI    HSTOWSW,X'FF'            SET STOW SWITCH                 33910017
HOUP5D   TM    0(R9),X'9F'              IF PDS,IS LAST CNTRL            34010017
         BZ    HOUP5D1                  CARD A MEMBER CARD              34110017
         BM    HOUP5D1                                                  34210017
         OI    HEODSW,HEODMSK           YES, PROCESS TO EOD             34310017
         B     HINP1A1                                                  34410017
HOUP5D1  TM    0(R9),X'8F'              SET UP                          34510017
         BZ    HOUP5F                   FOR                             34610017
         BM    HOUP5F                   END OF                          34710017
         OI    HEODSW,HEODMSK           DATA ROUTINES                   34810017
HOUP5E   NOP   HOUP9                                                    34910017
         OI    HOUP5E+1,X'F0'                                           35010017
         LA    R1,HMSGPELR              WRITE MESSAGE PROCESSING ENDED  35110017
         SLL   R1,8                     AT LAST REC ID                  35210017
         ST    R6,SIXSV                 SAVE REG6                       35310017
         L     R6,AST                   LOAD **** IN REG6               35410017
         L     R15,HWRMSGA              WRITE                           35510017
         BALR  R14,R15                  MESSAGE                         35610017
         L     R6,SIXSV                 RESTORE REG6                    35710017
       SR   R4,R4                                                       35810017
         B     HEOD                                                     35910017
HOUP5F   LA    R9,12(,R9)               UPDATE RDT XR                   36010017
         ST    R9,HRDTCUR               AND STORE                       36110017
         CLI   CPYSWSAV,X'00'           EDITING WITH IDENT              36210017
         BNE   HOUP5F1                  NO                              36310017
         B     HOUP5F2                  YES, CHECK LAST RECORD          36410017
HOUP5F1  TM    HCOPYSW,HCOPYMSK         EDITING                         36510017
         BO    HINP1A1                                                  36610017
         B     HOUP5G                                                   36710017
HOUP5F2  L     R9,HRDTSAV               CHECK LAST RECORD               36810017
         TM    0(R9),X'4F'              LAST IDENT                      36910017
         BZ    HOUP5F3                                                  37010017
         BM    HOUP5F3                                                  37110017
         L     R9,HEDCUR                YES                             37210017
HCHKFLD  TM    0(R9),X'80'              LAST FIELD THIS RECORD          37310017
         BO    HLSTFLD                  YES                             37410017
         LA    R9,8(,R9)                NO, INCREMENT IX                37510017
         B     HCHKFLD                  CHECK AGAIN                     37610017
HLSTFLD  TM    0(R9),X'81'              LAST RECORD FIELD               37710017
         BM    HCPYREV                  NO                              37810017
RAUNCH   OI    HEODSW,HEODMSK           YES,SET TO PROCESS EOD          37910017
         B     HOUP5E                   DO LAST WRITE                   38010017
HCPYREV  MVI   CPYSWSAV,X'FF'           RESET SWITCHES                  38110017
         OI    HEODSW,HEODMSK           PROCESS TO EOD                  38310017
         B     HOUP5G                                                   38410017
HOUP5F3  L     R9,HRDTCUR               GET NEXT RECORD                 38510017
         TM    0(R9),X'20'              EDITING                         38610017
         BO    HRESET1                  YES                             38710017
         OI    HCOPYSW,HCOPYMSK         NO,SET COPY SWITCH              38810017
         B     HRESET2                                                  38910017
HRESET1  MVI   HCOPYSW,X'00'            SET FOR EDITING                 39010017
HRESET2  L     R9,HRDTSAV               GET LAST RECORD                 39110017
         TM    0(R9),X'20'              WAS THERE EDITING               39210017
         BO    HOUP5G                   YES                             39310017
         L     R9,HRDTCUR               RELOAD RDT IX                   39410017
         B     HINP1A1                                                  39510017
HOUP5G   MVC   HEDCUR(4),HEDSV          GET NEXT EDT                    39610017
         L     R9,HRDTCUR               RELOAD RDT IX                   39710017
         BAL   R12,HPREDLEN                                             39810017
         B     HINP1A1                                                  39910017
HOUP9    L     R0,REGSAV               GET BUFFER CORE LENGTH AND       40010017
         LTR   R0,R0               WAS BUFFER CORE GOTTEN               40110017
         BZ    DONTFREE            IF NOT, BRANCH AROUN FREEMAIN        40210017
         L     R1,HIN1AD             BUFFER CORE ADDRESS FOR FREEMA     40410017
       FREEMAIN R,LV=(0),A=(1)                                          40510017
DONTFREE CLI   HTERMSW,X'FE'       USER TERMINATION REQUEST             40610017
         BNE   HOUP10                   NO,RETURN                       40710017
         B     HGENP4A                  YES,TERMINATE                   40810017
HOUP10   CLI   TYPMSG,X'10'                                             40910017
         BE    OKMESG                                                   41010017
CLOSAFTR LM    R13,R14,HSAVE13                                          41110017
         LH    R15,HCONCODE             LOAD CONDITION CODE IN REG15    41210017
         RETURN (2,12)                                                  41310017
*                                                                       41410017
*                                                                       41510017
HSTOW    L     R1,HDCBOUTA                                              41610017
         STOW  (1),HSTOWAR,A                                            41710017
         SLL   R15,20                                                   41810017
         SRL   R15,20                                                   41910017
         LTR   R15,R15                  TEST FOR ERROR                  42010017
         BCR   8,R12                    NO,RETURN                       42110017
         LA    R15,12                   YES,CONCODE 12                  42210017
         STH   R15,HCONCODE             SAVE ERROR CONCODE              42310017
         LA    R1,HMSGERS               WRITE MESSAGE                   42410017
         SLL   R1,8                     AND TERMINATE                   42510017
         LA    R4,10              MESSAGE ID FOR STOW ERROR             42610017
HSTOW3   AR    R1,R4                                                    42710017
         L     R15,HWRMSGA                                              42810017
         BALR  R14,R15                                                  42910017
         B     HOUP9                                                    43010017
*                                                                       43110017
HREAD    READ  HDECBIN,SF,HDCBIN,(5),'S'                                43210017
         BR    R12                                                      43310017
*                                                                       43410017
HPREDLEN CALL  HPRL,(TOTEDIT,HEDCUR,HEDSV)                              43510017
ANYBODY  TM    HCOPYSW,HCOPYMSK         IS EDIT REQUESTED               43610017
         BO    NOEDIT                   NO                              43710017
         CLC   TOTEDIT(2),HRLOU         YES-DOES EDIT EXCEED OUTLRECL   43810017
         BH    HPREDLN2                 YES--INVALID,TERMINATE          43910017
         TM    HOUORG,X'80'             NO-IS OUTPUT FIXED FORMAT       43990017
         BO    HABLE                    YES                             44070017
         LH    R9,TOTEDIT          NO, EDIT COUNT BECOMES LRECL         44150017
         TM    HOUORG,X'40'       OUTPUT VARIABLE ?              A48746 44160021
         BNO   COMMON             NO, UNDEFINED                  A48746 44170021
         LA    R9,4(R9)           YES, LOAD TOTAL EDIT PLUS FOUR A48746 44180021
         CH    R9,HRLOU           ED. PL. FOUR EXC. OUTP. LRCL.? A48746 44190021
         BH    HPREDLN2           YES, PERM OUTPUT ERROR         A48746 44200021
         LH    R9,TOTEDIT         NO, CONTINUE                   A48746 44210021
         B     COMMON              GO STORE LRECL AND RETURN            44230017
NOEDIT   CLC   HWK2(2),LRECLOUT   INP. REC. EXC. OUTP. LRECL ?   A48746 44310021
         BH    HPREDLN2           YES, PRINT MSG IEB309I         A48746 44330021
         TM    HINORG,X'40'       INPUT RECFM = V / VS ?         A48746 44332021
         BO    NOEDIT2            YES, CHECK OUTPUT              A48746 44334021
NOEDIT2  TM    HOUORG,X'40'       OUTPUT RECFM VARIABLE ?        A48746 44350021
         BO    AROUND              TES, GO PREPARE COUNT                44390017
         TM    HOUORG,X'80'        IS OUTPUT FIXED FORMAT               44470017
         BO    HABLE               YES, GO GET LRECL                    44550017
         LH    R9,HRLIN            NOT V OR F, FORMAT IS U              44630017
COMMON   STH   R9,HRLPRE           DATA COUNT TO HRLPRE                 44710017
         BR    R12                 RETURN TO CALLER                     44790017
AROUND   LH    R9,HWK2             RECORD COUNT                         44870017
         TM    HINORG,X'40'        IS INPUT RECFM V OR VB               44950017
         BC    14,COMMON           IF NOT, BRANCH                       45030017
         SH    R9,HH4              IF INPUT IS V, ADJUST LRECL          45110017
         B     COMMON              GO STORE RECORD COUNT AND RETURN     45190017
HABLE    LH    R9,HRLOU            OUTPUT LRECL BECOMES COUNT           45270017
         B     COMMON              GO STORE COUNT AND RETURN            45350017
         BR    R12                      RETURN                          45430017
HPREDLN2 LA    R15,12                   LOAD CONCODE 12 IN REG15        45510017
         STH   R15,HCONCODE             AND STORE                       45590017
         LA    R1,HMSGUOE         LOAD MSG IEB309I TEXT DISPL.   A48746 45670021
         SLL   R1,8                                                     45750017
         LA    R4,9               LOAD MSG IEB309I NUMBER        A48746 45830021
         B     HSTOW3                                                   45910017
*                                                                       45990017
HRIDTST  TM    HEODSW,HEODMSK           TEST FOR LAST REC OF GROUP      46070017
         BCR   1,R12                    CHECK                           46150017
         NI    HRIDSW,X'00'                                             46230017
         L     R9,HRDTCUR               FOR                             46310017
         LH    R10,HRIDL(R9)            IDENT FIELD                     46390017
         BCTR  R10,0                    IN RECORDS                      46470017
         STC   R10,HRIDTST2+1                                           46550017
         LH    R11,HRIDST(R9)                                           46630017
         AR    R11,R5                                                   46710017
HRIDTST2 CLC   HRID(1,R9),0(R11)                                        46790017
         BCR   7,R12                                                    46870017
         OI    HRIDSW,X'FF'                                             46950017
         BR    R12                                                      47030017
*                                                                       47110017
HTERMU   LH    R15,HCONCODE                                             47190017
         B     HOUP9                                                    47270017
*                                                                       47350017
*    THIS SUBROUTINE CHECKS CONDITION CODES TO DETERMINE WHICH CODE     47430017
*    WILL BE PASSED BACK TO THE CALLING PROGRAM.                        47510017
*                                                                       47590017
HTSTTRM  SLL   R15,20                   TEST FOR 16 IN R15              47670017
         SRL   R15,20                                                   47750017
         LTR   R1,R1                                                    47830017
         BZ    HTSTTRM4                                                 47910017
         LA    R0,16                                                    47990017
         CR    R0,R15                                                   48070017
         BNE   HTSTTRM2                                                 48150017
HTSTTRM1 LA    R12,4(,R12)                                              48230017
         LTR   R1,R1                                                    48310017
         BZ    HTSTTRM2                                                 48390017
         BR    R12                                                      48470017
HTSTTRM2 SRL   R15,2                    ROUND DOWN                      48550017
         SLL   R15,2                                                    48630017
         LH    R0,HCONCODE                                              48788421
         CR    R0,R15                   IF OLD CONCODE IS HIGH          48790017
         BCR   10,R12                   OR EQUAL,RETURN                 48870017
         LA    R0,16                                                    48950017
         CR    R15,R0                                                   49030017
         BNH   HTSTTRM3                                                 49110017
         LR    R15,R0                                                   49190017
HTSTTRM3 STH   R15,HCONCODE             OTHERWISE STORE NEW CONCODE     49270017
         BR    R12                      BEFORE RETURNING                49350017
HTSTTRM4 LA    R0,12                                                    49430017
         CR    R0,R15                                                   49510017
       BH     HTSTTRM2                                                  49590017
         B     HTSTTRM1                                                 49670017
*                                                                       49750017
TOTMSG1  LA    R1,30                   LOAD MSG INDICATION              49830017
         BAL   R14,TOTMSG4             LINK TO WRITE ROUTINE            49910017
         B     HTERMU                  BRANCH TO TERMINATE              49990017
TOTMSG2  LA    R1,31                   LOAD MSG INDICATION              50070017
         BAL   R14,TOTMSG4             LINK TO WRITE ROUTINE            50150017
         B     HOUP9                   BRANCH TO END OF PROCESSING UL0I 50230018
TOTMSG3  LA    R1,32                   LOAD MSG INDICATION              50310017
         BAL   R14,TOTMSG4             LINK TO WRITE ROUTINE            50390017
         NI    TOTLEXSW,X'7F'                                           50470017
         B     HOUP3B2                 CONTINUE                         50550017
TOTMSG4  STM   R14,R15,R14SAVE         SAVE REG 14 & 15                 50630017
         LR    R4,R1                   LOAD MSG INDICATION IN REG4      50710017
         SLL   R1,8                                                     50790017
         AR    R1,R4                                                    50870017
         L     R15,HWRMSGA             LOAD WRITER ROUTINE ADDRESS      50950017
         BALR  R14,R15                 LINK                             51030017
         L     R5,R14SAVE+4            LOAD RETURNCODE                  51110017
         SR    R4,R4                                                    51190017
         LA    R1,10                   DETERMINE FIRST                  51270017
         DR    R4,R1                   AND SECOND DIGIT                 51350017
         L     R1,VADDR3               LOAD ADDRESS OF MESSAGE          51430017
         LA    R4,240(R4)              MAKE                             51510017
         LA    R5,240(R5)              EBDIC-CODE                       51590017
         STC   R5,21(R1)               STORE FIRST DIGIT                51670017
         STC   R4,22(R1)               STORE SECOND DIGIT          UL0I 51750018
         LA    R1,25                   LOAD MSG CODE                    51830017
         SLL   R1,8                    AND                              51910017
         LA    R4,25                   OFFSET                           51990017
         AR    R1,R4                                                    52070017
         L     R15,HWRMSGA             LOAD ADDRESS OF MSG WRITER  UL0I 52110018
         BALR  R14,R15                 LINK                             52150017
         LM    R14,R15,R14SAVE         RESTORE REG 14 & 15              52230017
         BR    R14                     RETURN                           52310017
HGENP4A  LA    R1,HMSGTLR                                               52390017
         SLL   R1,8                                                     52470017
         LA    R4,5                                                     52550017
ERRORPNT AR    R1,R4                                                    52630017
         L     R15,HWRMSGA                                              52710017
         BALR  R14,R15                                                  52790017
         B     HTERMU                                                   52870017
*                                                                       52950017
HEOD     DS    0H                                                       53030017
         TM    HSTOWSW,X'FF'                                            53110017
         BC    5,HOUP3C                                                 53190017
         BP    HOUP3C                   PROCESSING SWITCHES             53270017
     OI    HOUP3F+1,X'F0'                                               53350017
         OI    HOUP4+1,X'F0'      SET EOD SWITCH                 A48738 53390021
         OI    HOUP5A+1,X'F0'                                           53430017
         TM    HOUP5E+1,X'F0'           DO NOT WRITE EOD MESS IF LAST   53510017
         BO    HEODA                    REC ID MESS ALREADY WRITTEN     53590017
     NI  HRIDSW,X'00'                                                   53670017
         ST    R6,SIXSV                                                 53750017
         MVI   TYPMSG,X'10'                                             53830017
         B     HEODA                                                    53910017
OKMESG   LA    R1,HMSGPEOD                                              53990017
         SLL   R1,8                                                     54070017
         L     R6,AST                                                   54150017
         L     R15,HWRMSGA                                              54230017
         BALR  R14,R15                                                  54310017
         B     CLOSAFTR                                                 54390017
HEODA    S     R8,HKEYLOU               END OF DATA                     54470017
         TM    HPOID,X'02'              ROUTINE FOR                     54550017
         BZ    HEOD1                    PDS                             54630017
         OI    HSTOWSW,X'FF'                                            54710017
HEOD1    TM    HOUORG,X'40'             END OF DATA                     54790017
         BZ    HEOD2                    FOR VARIABLE                    54870017
         AH    R8,HH4                                                   54950017
HEOD2    B     HOUP1A                                            A33312 55030020
*                                                                       55110017
HINER    EQU   *                        INPUT SYNAD ROUTINE             55190017
         ST    R10,SYNADSAV            SAVE REG 10               A22671 55200018
         STM   R3,R4,SYNADSAV+4        SAVE REGS 3AND4           A22671 55210018
         ST    R12,SYNADSAV+12         SAVE REG 12               A22671 55220018
         ST    R14,HSAVE14             SAVE REG14                A22671 55230018
         BAL   R14,SYNADAFR            LINK TO SYNADAF ROUTINE   A27717 55630019
         B     HOUER1                  TEST USER ERROR EXIT      A27717 56030019
HINER2   LA    R15,12                   LOAD CONCODE 12 IN REG 15       56550017
         STH   R15,HCONCODE             AND STORE                       56630017
         LA    R1,HMSGUIE               WRITE ERROR MSG AND TERMINATE   56710017
         SLL   R1,8                                                     56790017
         LA    R4,8                     MESSAGE ID 8                    56870017
         B     HSTOW3                                                   56950017
HINER3   LA    R15,12                  LOAD CON CODE 12 IN REG 15A27717 56970019
         STH   R15,HCONCODE            AND STORE                 A27717 56990019
         B     HOUP9                                             A27717 57010019
*                                                                       57030017
HOUER    EQU   *                        OUTPUT SYNAD ROUTINE            57110017
         ST    R10,SYNADSAV            SAVE REG 10               A22671 57112018
         STM   R3,R4,SYNADSAV+4        SAVE REGS 3AND4           A22671 57114018
         ST    R12,SYNADSAV+12         SAVE REG 12               A22671 57116018
         ST    R14,HSAVE14             SAVE REG14                A22671 57118018
         BAL   R14,SYNADAFR            LINK TO SYNADAF ROUTINE   A27717 57119019
         TM    TOTLEXSW,X'80'          TOTALING EXIT ACTIVE        UL0I 57120018
         BZ    HOUER1                  NO - BRANCH                 UL0I 57130018
         ST    R0,TOTLAREA+8           STORE STATUS INFO ADDRESS   UL0I 57140018
         MVI   TOTLAREA+8,X'80'         SET FLAG BYTE              UL0I 57150018
         STM   R0,R1,SAVER01           SAVE REGS 0 AND 1           UL0I 57160018
         LA    R1,TOTLAREA             PARM LIST FOR TOTALING      UL0I 57170018
         L     R15,ADTOTEXR            LOAD ROUTINE ADDRESS AND    UL0I 57180018
         BALR  R14,R15                 LINK                        UL0I 57190018
         LM    R0,R1,SAVER01           RESTORE REGISTERS           UL0I 57200018
HOUER1   L     R10,HEXITTA             EXIT LIST                   UL0I 57210018
         LTR   R10,R10                                                  57270017
         BZ    HINER3A                 SKIP TO SYNADRLS          A48809 57350021
         CLI   56(R10),X'40'           TEST FOR USER EXIT               57430017
         BE    HINER3A                 SKIP TO SYNADRLS          A48809 57510021
         LA    R10,56(R10)             YES-LINK TO USER                 57590017
         LR    R4,R0                                                    57670017
         LR    R3,R1                                                    57750017
         OI    IOERREXI,X'F0'     SET IOERREXI  BYTE             A48809 57800021
         LINK  EPLOC=(10),PARAM=((4),(3))                               57830017
HINER3A  SYNADRLS                 FRMAIN WORKAR AND REST REG 13  A48809 57880021
         TM    IOERREXI,X'F0'     USER EXIT ?                    A48809 57890021
         BNO   HINER3             NO, END PROCESSING             A48809 57900021
         SR    R1,R1                                                    57910017
         BAL   R12,HTSTTRM              TEST TERMINATION REQUEST        57990017
         B     RETFSYN                 RETURN TO SYSTEM          A22671 58070018
         LA    R1,HMSGTER               WRITE ERROR MSG AND TERMINATE   58150017
         SLL   R1,8                                                     58230017
          LA   R4,12                                                    58430017
         B     HOUP2J                                                   58630017
SYNADAFR STM   R14,R1,SAVER141          SAVE SYNAD PARAMETERS    A27717 58680019
         L     R10,GENCOPAD                                      A27717 58730019
         TM    0(R10),X'80'            TEST STRAIGHT COPY SWITCH A27717 58780019
         BZ      QSYNADAF              SWITCH NOT ON -QSAM-BRANCHA27717 58830019
         SYNADAF  ACSMETH=BSAM                                   A27717 58880019
         B     SYNAFR1                 BRANCH AROUND QSAM        A27717 58930019
QSYNADAF SYNADAF  ACSMETH=QSAM                                   A27717 58980019
SYNAFR1  L     R10,SYNADMSA            LOAD ADDRESS OF MSG       A27717 59030019
         MVC   10(79,R10),49(R1)        MOVE SYNAD INFO TO MSG   A27717 59080019
         LA    R1,50                   LOAD MSG OFFSET           A27717 59180019
         SLL   R1,8                                              A27717 59230019
         LA    R1,51(R1)               ADD MSG ID                A27717 59280019
         L     R15,HWRMSGA             LOAD WRITER ADDRESS       A27717 59330019
         BALR  R14,R15                 LINK TO WRITER            A27717 59380019
         LM    R14,R1,SAVER141         RESTORE SYNAD PARAMETRS   A27717 59430019
         BR    R14                     RETURN                    A27717 59480019
*                                                                A27717 59530019
SAVER141 DS    4F                                                A27717 59580019
SYNADMSA DC    V(SYNADMSG)                                       A27717 59630019
*                                                                A27717 59680019
* THIS ROUTINE RETURNS CONTROL TO THE SYSTEM IF THE USERS EXIT   A22671 59850018
* ACCEPTS THE BAD RECORD , AND RETURNS A RETURN CODE OF LESS     A22671 59870018
* THAN TWELVE                                                    A22671 59890018
RETFSYN  L     R10,SYNADSAV            RESTORE REG10             A22671 59910018
         LM    R3,R4,SYNADSAV+4        RESTORE REGS 3 AND 4      A22671 59930018
         L     R12,SYNADSAV+12         RESTORE REG12             A22671 59950018
         L     R14,HSAVE14             RESTORE REG 14            A22671 59970018
         RETURN  ,                                               A22671 59990018
*                                                                       60030017
INOUTSET L     R3,HEXITTA               EXIT LIST                       60230017
         CLI   48(R3),X'40'            TEST FOR KEY EXIT                60430017
         BZ    TSTDEV2                  NO KEY EXIT                     60630017
         LA    R1,27                   LOAD MSG OFFSET                  60730017
         SLL   R1,8                    AND                              60830017
         LA    R1,27(R1)               MSG ID.                          60930017
         L     R15,HWRMSGA                                              61030017
         BALR  R14,R15                 AND WRITE MSG.                   61130017
         LA    R15,4                   LOAD RETURN CODE = 4             61160017
         STH   R15,HCONCODE            STORE RETURN CODE                61190017
TSTDEV2  SR    R4,R4               SET UP TO DETERMINE                  61230017
         SR    R5,R5                   BUFFER LENGTH                    61330017
         L     R12,HDCBOUTA                                             61430017
         TM    17(R12),X'20'           IS UT2 DEVICE=DA                 61530017
         BZ    TSTDEV1             IF NOT, BRANCH                       61630017
         OI    KEYOUTSW,X'02'       SET UT2 EQUALS DA SWITCH            61730017
TSTDEV1  AH    R5,62(R12)              ADD OUTPUT BLKSI TO KEYLEN       61830017
         L     R12,HDCBINA                                              61930017
         TM    17(R12),X'20'           IS UT1 DEVICE=DA                 62030017
         BZ    NOINKEY             IF NOT, BRANCH                       62130017
         OI    KEYOUTSW,X'04'      SET UT1 EQUALS DA SWITCH             62230017
NOINKEY  L     R1,HDCBOUTA   LOAD SYSUT2 DCB ADDRESS            PTM5314 62330020
         LH    R4,LRECL(R12) LOAD LRECL SYSUT1                  PTM5314 62380020
         STH   R4,LRECLINP   STORE INPUT LRECL(BLKSI WHEN U)     A45145 62390021
         LH    R5,LRECL(R1)  LOAD LRECL SYSUT2                  PTM5314 62430020
         STH   R5,LRECLOUT        STORE OUTPUT LRECL             A48746 62450021
         TM    HCOPYSW,HCOPYMSK   IS IT STRAIGHT COPY   ?       PTM5314 62480020
         BZ    GETMAIN1      NO, DO NOT CHECK FOR INCONS.LRECL. PTM5314 62530020
         CR    R5,R4         LRECL UT2 GREATER UT1 LRECL  ?  L. PTM5314 62580020
         BE    GETMAIN1           NO, EQUAL                      A45131 62630021
         TM    RECFM(R1),X'80'    INPUT RECFM=U/F ?              A45131 62650021
         BO    SKWARNIN           YES, SKIP WARNING MESSAGE      A45131 62670021
         TM    RECFM(R12),X'80'   OUTPUT RECFM=U/F ?             A45131 62690021
         BO    SKWARNIN           YES, SKIP WARNING MESSAGE      A45131 62710021
         STM   R14,R0,SAVEPRI          WARNING                  PTM5314 62730020
         LA    R1,WARNING              MESSAGE                  PTM5314 62780020
          L    R15,HCDWRA              FOR INCONSISTENT         PTM5314 62830020
         BALR  R14,R15                 LRECL'S                  PTM5314 62880020
         LM    R14,R0,SAVEPRI                * GETMAIN          PTM5314 62930020
SKWARNIN CR    R5,R4              OUTP. LRECL GREATER            A45131 62980021
         BH    *+6                THEN INPUT LRECL ?             A45131 63010021
         LR    R5,R4              NO, SET GETM FOR UT1=UT2 LRECL A45131 63040021
         LR    R4,R5              YES, SET GETM FOR UT2=UT1 LRCL A45131 63070021
GETMAIN1 AR    R5,R4              ADD INPUT AND OUTPUT LRECL     A48746 63110021
         LA    R5,32(R5)          ADD 32 TO TOTAL                A48746 63120021
         ST    R5,REGSAV          STORE TOTAL BUFF. LENGTH       A48746 63122021
         GETMAIN R,LV=(5)         GETMAIN INPUT + OUTPUT BUFF.   A48746 63180021
         ST    R1,HIN1AD          STORE INPUT BUFFER ADDRESS     A48746 63230021
         AR    R1,R4              ACCOUNT   OUTPUT               A48746 63280021
         LA    R1,16(R1)          BUFFER ADDRESS                 A48746 63290021
         ST    R1,HOU2AD          STORE OUTPUT BUFFER ADDRESS    A48746 63330021
         NI    HOU2AD+3,X'F8'     ROUND DOWN TO ASS DBLW. BOUN.  A48746 63380021
OMPREREC L      R4,HDCBINA              ADDR OF SYSUT1 DCB              63630017
         L     R5,HDCBOUTA             ADDR OF SYSUT2 DCB               63730017
         MVC   HINORG(1),RECFM(R4)      MOVE SYSUT1 RECFM               63830017
         MVC   HOUORG(1),RECFM(R5)      MOVE SYSUT2 RECFM               63930017
         NI    HINORG,X'D8'            LEAVE ATTRIBUTES                 64030017
         NI    HOUORG,X'D8'            LEAVE ATTRIBUTES                 64130017
         CLC   HINORG(1),HOUORG         COMPARE RECFM'S                 64230017
         BNE   CMPREBLK                 RECFM'S NOT EQUAL               64330017
         OI    KEYOUTSW,X'08'           TURN ON EQUAL RECFM BIT         64430017
CMPREBLK CLC   BLKSI(2,R4),BLKSI(R5)    COMPARE B1KSIZES                64530017
         BNE   BUFFMV                  BLKSIZES NOT EQUAL               64630017
         OI    KEYOUTSW,X'10'           TURN ON EQUAL BLKSIZE BIT       64730017
BUFFMV   MVC   HBLIN+2(2),LRECL(R4)   MOVE INPUT AREA LENGTH            64830017
         MVC   HBLOU(2),LRECL(R5)      MOVE IUTPUT AREA LENGTH          65130017
         TM    KEYOUTSW,X'08'      ARE THE RECFM'S EQUAL                65430017
         BZ    UNEQREC             BRANCH IF UNEQUAL                    65730017
         TM    HINORG,X'40'        IS SYSUT1 RECFM V,VB, OR U           66030017
         BO    OUTVARBL            YES, GO COMPARE BLKSIZE'S            66330017
INFOUTF  TM    HCOPYSW,HCOPYMSK    IS EDITING REQUESTED                 66630017
         BZ    CKLRECL             YES, GO STORE LRECLS                 66930017
         CLC   LRECL(2,R4),LRECL(R5)                                    67230017
         BNE   ERROR                    LRECL'S NOT EQUAL               67630017
         B     CKLRECL                                                  68030017
OUTVARBL TM    HCOPYSW,HCOPYMSK         TEST IF FIELD SPECIFIED         68430017
         BZ    CKLRECL             YES, GO SET UP LRECL FIELD           68520017
         TM    HOUORG,X'48'            SYSUT2 SPANNED                   68610017
         BO    CKLRECL                 YES-BRANCH                       68700017
         CLC   BLKSI(2,R5),LRECL(R4)   COMP. SUT2 BLOCK TO SUT1         68790017
         BL    ERROR                   LRECL-LOW-BRANCH                 68880017
         B     CKLRECL                                                  68960017
         BH    ERROR                    SYSUT2 BLKSIZE TOO SMALL        69040017
         BZ    CKLRECL             YES, GO SET UP LRECL FIELD           69120017
UNEQREC  TM    HINORG,X'10'             TEST IF SYSUT1 BLOCKED          69210017
         BZ    INNOTBLK                 SYSUT1 NOT BLOCKED              69300017
         TM    HINORG,X'40'             TEST UT1 FOR VAR BLOCK          69390017
         BZ    TSTUT2                   SYSUT1 IS FIX BLOCK             69480017
         OI    RECFMSW,X'30'            TURN ON UT1 EQUAL TO VB         69570017
INNOTBLK TM    HINORG,X'C0'             TEST UT1 FOR U TYPE             69660017
         BM    FIXORVAR                 UT1 IS FIXED OR VAR             69750017
         OI    RECFMSW,X'10'            TURN ON UT1 EQUAL TO U TYPE     69840017
FIXORVAR TM    HINORG,X'80'             TEST UT1 FOR FIXED              69930017
         BO    TSTUT2                   UT1 IS FIXED                    70020017
         OI    RECFMSW,X'20'            TURN ON UT1 EQUAL TO VAR        70110017
TSTUT2   TM    HOUORG,X'10'             TEST SYSUT2 FOR BLOCKED         70200017
         BZ    OTNOTBLK                 SYSUT2 NOT BLOCKED              70290017
         TM    HOUORG,X'40'             TEST UT2 FOR VAR BLK            70380017
         BZ    SWSET                                                    70470017
         OI    RECFMSW,X'03'           UT2 IS A VARIBLE                 70560017
         B     SWSET                                                    70650017
OTNOTBLK TM    HOUORG,X'C0'             TEST UT2 FOR U TYPE             70740017
         BM    OFXORVAR                 SYSUT2 IS FIXED OR VAR     6597 70830017
         OI    RECFMSW,X'01'            TURN ON UT2 EQUAL TO U TYPE     70920017
         B     SWSET                                                    71010017
OFXORVAR TM    HOUORG,X'80'             TEST UT2 FOR FIXED              71100017
         BO    SWSET                                                    71190017
         OI    RECFMSW,X'02'            TURN ON UT2 EQUAL TO VAR        71280017
SWSET    SR    R6,R6                                                    71370017
         IC    R6,RECFMSW                                               71460017
*                  RECFM SW   1 BYTE                                    71550017
*        INPUT                            OUTPUT                        71640017
*        (HALF BYTE)                     (HALF BYTE)                    71730017
*        0       FIXED OR FIXED BLK     0                               71820017
*         1       UNDEFINED TYPE        1                               71910017
*        2        VARIBLE TYPE          2                               72000017
*        3       VARIBLE BLK TYPE       3                               72090017
         SRDL  R6,4                     MOVE SYSUT2 BITS TO REG 7       72180017
         SRL   R7,28                    RIGHT ALIGN UT2 BITS            72270017
         LTR   R6,R6                    TST UT1 FOR F OR FB             72360017
         BNE   VARIN                    UT1 IS A VARIBLE                72450017
         LTR   R7,R7                    TEST UT2 FOR F OR FB            72540017
         BZ    INFOUTF                  UT1 AND UT2 ARE F OR FB         72630017
         B     FINVOUT                  UT1 IS F OR FB - UT2 IS VAR     72720017
VARIN    TM    HCOPYSW,HCOPYMSK         TEST IF FIELD SPECIFIED         72810017
         BZ    CKLRECL             YES, GO SET UP LRECL FIELD           72900017
         LTR   R7,R7                    TEST UT2 FOR F OR FB            72990017
         BZ    ERROR                    VAR IN, F OR FB OUT             73080017
         LH    R4,LRECL(R4)            LOAD  SYSUT1 LRECL               73170017
         LH    R5,BLKSI(R5)            SUSUT2 BLKSOZE                   73260017
FIXGOOD  AR    R6,R7                    ADD UT2 RECFM TO UT1 RECFM      73350017
         SH    R6,THREE                                                 73440017
         SRL   R7,1                                                     73530017
         CR    R6,R7                                                    73620017
         BE    TST7ZRO                  UT1 IS R,V (0),OR U,VB (1)      73710017
*  REG6     REG7   REG7(SHIFT)   REG6+REG7                              73800017
*   0  F,FB 0        0         (6 NOT EQUAL 7)                          73890017
*   1   U   1        0              1   F,FB TO U  OR U TO F,FB         73980017
*   2   V   2        1              2   F,FB TO V  OR V TO F,FB         74070017
*   3  VB   3        1              3   F,FB TO VB OR VB TOF,FB         74160017
*                                   4   U TO VB OR VB TO U              74250017
*                                   5   V TO VB OR VB TO V              74340017
*                                                                       74430017
         BH    TST7ONE                                                  74520017
         B     ADD8                UT1 IS U, AND UT2 IS V               74610017
TST7ZRO  LTR   R7,R7               TEST REG 7 FOR ZERO                  74700017
         BZ    MINUS8              UT1 IS V AND UT2 IS U                74790017
ADD8     LA    R4,4(R4)                BUMP SYSUT1 LRECL                74880017
         B     COMPARE                                                  74970017
MINUS8  LA    R5,4(R5)                BUMP SYSUT2 BLOVKSIZE             75060017
         B     COMPARE                                                  75150017
TST7ONE  LTR   R7,R7                    TEST 7 FOR ZERO                 75240017
         BZ    MINUS8                   SYSUT1 IS VB - SYSUT2 IS U      75330017
         B     COMPARE             GO COMPARE BLKSIZES                  75420017
FINVOUT  TM    HCOPYSW,HCOPYMSK        TEST IF FIELD SPECIFIED          75510017
         BZ    CKLRECL                                                  75590017
         LH    R5,BLKSI(R5)            SYSUT2 BLKSIZE                   75670017
         LH    R4,LRECL(R4)            SYSUT1 LRECL                     75750017
         BCT   R7,ADD8             BRANCH IF UT2  IS V OR VB            75830017
COMPARE  TM    HOUORG,X'48'            IS OUTPUT SPANNED                75910017
         BO    CKLRECL                 YES-BR ANCH                      75990017
         CR    R5,R4                   COMPARE UT2 BLKSI-UT1 LRECL      76070017
         BL    ERROR                   LOW-BRANCH                       76150017
CKLRECL  L     R12,HDCBINA                                              76230017
         LH    R4,82(R12)              INPUT LRECL                      76310017
         L     R12,HDCBOUTA                                             76390017
         LH    R5,82(R12)              OUTPUT LRECL                     76470017
         LTR   R4,R4               IS INPUT LRECL ZERO                  76550017
         BNE   CKLRECL2            IF NOT, STORE LRECL                  76630017
         L     R12,HDCBINA                                              76710017
         LH    R4,62(R12)              INPUT BLOCKSIZE                  76790017
         TM    36(R12),X'40'           INPUT RECFM  V                   76870017
         BC    14,CKLRECL2         IF NOT, STRE BLKSIZE                 76950017
         SH    R4,HH4              DECREMENT BLKSIZE BY 4 FOR LRECL     77030017
CKLRECL2 STH   R4,HRLIN            STORE INPUT LRECL                    77110017
         LTR   R5,R5               IS OUTPUT LRECL ZERO                 77190017
         BNE   CKLRECL4            IF NOT, GO STORE LRECL               77270017
         L     R12,HDCBOUTA                                             77350017
         LH    R5,62(R12)              OUTPUT BLOCKSIZE                 77430017
         TM    36(R12),X'40'           OUTPUT RECFM V                   77510017
         BC    14,CKLRECL4         IF NOT, STORE BLKSIZE                77590017
         SH    R5,HH4              DECREMENT BLKSI BY 4 FOR V           77670017
CKLRECL4 STH   R5,HRLOU            STORE LRECL                          77750017
         TM    HINORG,X'C0'             TEST IF U TYPE                  77850017
         BC    12,NEXT                  BRANCH NOT U TYPE               77950017
         NI    HINORG,X'1F'        TURN OFF U AND TRKOVRFL BITS         78050017
         OI    HINORG,X'20'             TURN ON 2 BIT FOR U TYPE        78150017
NEXT     TM    HOUORG,X'C0'             TEST IF U TYPE                  78250017
         BC    12,GOBACK                BRANCH NOT U TYPE               78350017
         NI    HOUORG,X'1F'        TURN OFF U AND TRK OVRFL BITS        78450017
         OI    HOUORG,X'20'             TURN ON 2 BIT FOR U TYPE   6598 78530017
GOBACK   BR    R14                                                 6598 78610017
ERROR    LA    R1,HMSGDCB              MESSAGE CODE                6598 78690017
         SLL   R1,8                                                     78770017
         LA    R4,11                   MESSAGE ID                  6598 78850017
         LA    R15,12                                              6598 78930017
         STH   R15,HCONCODE            RETURN CODE OF 12           6598 79010017
         B     ERRORPNT                PRINT MESSAGE               6598 79090017
* FOR A CHANGE IN RECFM'S AND NO FIELD SPECIFIED, THE FOLLOWING HOLDS * 79170017
*  THE SYSUT2 BLKSIZE AND LRECL IS DEPENDENT ON SYSUT1 AND THE RECFM'S* 79250017
*  INPUT        OUTPUT    OUTPUT BLOCK                                * 79330017
* 1 F/FB        VS                                                      79410017
* 2  F/FB       VBS                                                     79490017
* 3  VS         VS                                                      79570017
* 4  VBS        VBS                                                     79650017
* 5  U          VS                                                      79730017
* 6  U          VBS                                                     79810017
* 8  VS         VBS                                                     79890017
* 9  VBS        U       EQAUL OR GREATER THAN SYSUT1LRECL               79970017
* A  VBS        VS                                                      80050017
* B  VS         V       EQUAL OR GREATER THEN SYSUT1 LRECL              80130017
* C  VBS        V       EQAUL OR GREATER THAN SYSUT1 LRECL              80210017
* D  VS         VB      EQAUL OR GREATER THAN SYSUT1 LRECL              80290017
* E  VBS        VB      EQAUL OR GREATER THAN SYSUT1 LRECL              80370017
* F  V          VS                                                      80450017
*10  V          VBS                                                     80530017
*11  VB         VS                                                      80610017
*12  VB         VBS                                                     80690017
HINTB    DC    3F'0'                   INPUT BUFFER- WORK AREA     6598 80770017
HKEYL    EQU   HINTB                                                    80850017
HBLIN    EQU   HINTB+4                                                  80930017
HRLIN    EQU   HINTB+8                                                  81010017
HINORG   EQU   HINTB+10                                                 81090017
HOUTB    DC    3F'0'                    OUTPUT BUFFER- WORK AREA        81170017
HKEYLOU  EQU   HOUTB                                                    81250017
HBLOU    EQU   HOUTB+4                                                  81330017
HRLOU    EQU   HOUTB+8                                                  81410017
HOUORG   EQU   HOUTB+10                                                 81490017
HPOID    EQU   HOUTB+11                                                 81570017
*                                                                       81650017
         DS    0D                                                       81730017
         DC    CL8'SUP.AREA'            SUPERZAP DEBUGGING              81810017
         DC    18F'0'                   AREA                            81890017
HGENPRS  DS    18F                      WORK AREA                       81970017
HSAVE13  DS    2F                      R13,R14 SAVE AREA         A22671 82050018
HSAVE14  DS    1F                       REG 14 SAVE AREA                82130017
HSTOWAR  DS    3F                                                       82210017
SAVEPRI  DS    4F            SAVE REG BEFORE PR. A MESS.        PTM5314 82260021
HIN1AD   DS    1F                       SYSUT1 BUFF1 ADDR SAVE AREA     82290017
HIN2AD   DS    1F                       SYSUT1 BUFF2 ADDR SAVE AREA     82370017
HOU1AD   DS    1F                       SYSUT2 BUFF1 ADDR SAVE AREA     82450017
HOU2AD   DS    1F                       SYSUT2 BUFF2 ADDR SAVE AREA     82530017
HEDSV    DS    1F                                                       82610017
HIXIN    DS    1F                                                       82690017
HIXOUT   DS    1F                                                       82770017
HBLOUAC  DS    1F                                                       82850017
HWK4     DC    F'0'                                                     82930017
HRDTSAV  DC    F'0'                                                     83010017
HRLPRE   DS    1H                                                       83090017
HWK2     DS    1H                                                       83170017
HKEYA    DS    1F                                                       83250017
LABPOLAT DS    2F                      LABEL POOL ADDRESSES             83330017
TOTLAREA DC    4F'0'                   TOTALING PARM LIST          UL0I 83380018
SAVER01  DC    2F'0'                                               UL0I 83430018
SYNADSAV DS    4F                      AREA TO SAVE REGS IN SYNADA22671 83460018
HEXITTA  DS    1F                       USER EXIT TABLE ADDR LOC        83490017
HMDTCUR  DS    1F                                                       83570017
HEDCUR   DS    1F                                                       83650017
HRDTCUR  DS    1F                                                       83730017
HLITTA   DS    1F                                                       83810017
HCOPYSW  DS    0C                       COPY SWITCH                     83890017
HEODSW   DS    1C                       END OF DATA SWITCH              83970017
LRECLINP DS    1H         INPUT LRECL(BLKSI WHEN RECFM=U)        A45145 84020021
LRECLOUT DC    H'0'               OUTPUT LRECL                   A48746 84025021
WARNING DC CL120'WARNING:INPUT AND OUTPUT LRECL ARE INCONSISTENT' M5314 84030021
         EXTRN HDCBOUT                                                  84050017
         EXTRN HDCBIN                                                   84130017
HDCBOUTA DC    V(HDCBOUT)                                               84210017
VADDR3   DC    V(HMSGRETC)                                              84290017
HDCBINA  DC    V(HDCBIN)                                                84370017
STHEODAD DC    A(STRCPEOD)                                              84450017
HEODAD   DC    A(HEOD)                                                  84530017
HINERAD  DC    A(HINER)                                           M2461 84550018
HOUERAD  DC    A(HOUER)                                           M2461 84570018
ADTOTEXR DC    F'0'                                                     84610017
SIXTEEN  DC    H'16'                                                    84690017
FOUR     DC    H'4'                                                     84770017
EIGHT    DC    H'8'                                                     84850017
R14SAVE  DS    2F                                                       84930017
SAVER12  DC    F'0'                                                     85010017
TOTLEXSW DC    X'00'                                                    85090017
LABPROSW DS    1C                      LABEL PROCESSING SWITCH          85170017
KEYOUTSW DC    X'00'                    ATTRIBUTE SWITCH           6598 85250017
THREE    DC    H'3'                     CONSTANT                   6598 85330017
RECFMSW  DC    X'00'                                               6598 85410017
HSTOWSW  DC    X'00'                    STOW SWITCH                     85490017
HRIDSW   DC    X'00'                                                    85570017
HTERMSW  DC    X'00'                    TERMINATION SWITCH              85650017
HWRMSGA  DC    V(HWRMSG)                MSG WRITER SUBR ADDR LOC        85730017
HCDWRA   DC    V(HCDWR)      ADDRESS  MESSAGE  ROUTINE          PTM5314 85780020
HCONCODE DC    H'0'                     CONDITION CODE SAVE AREA        85810017
HH0      DC    H'0'                                                     85890017
HH2      DC    H'2'                                                     85970017
HH4      DC    H'4'                                                     86050017
TOTEDIT  DC    H'0'                                                     86130017
HALFWORK DS    1H                                                       86210017
SIXSV    DS    1F                       REG6 SAVE AREA                  86290017
REGSAV   DC    F'0'                SAVES LENGTH FOR BUFFER FREEMAIN3599 86370017
AST       DC   C'****'                                                  86450017
HCOPYMSK EQU   X'F0'                    COPY MASK                       86530017
HEODMSK  EQU   X'0F'                    END OF DATA MASK                86610017
HPTRMSK  EQU   X'00'                                                    86690017
BLANKS   DC    X'4040'                                                  86770017
CPYSWSAV DC    X'00'                                                    86850017
TYPMSG   DC    X'00'                                                    86930017
IOERREXI DC    X'00'              IOERROR EXIT BYTE              A48809 86980021
HRIDL    EQU   0                                                        87010017
HRIDST   EQU   2                                                        87090017
HRID    EQU   4                                                         87170017
HMEMBYT  EQU   0                                                        87250017
HMSGIIP  EQU   1                        MESSAGE CODES                   87330017
HMSGECC  EQU   2                                                        87410017
HMSGBNA  EQU   4                                                        87490017
HMSGTLR  EQU   5                                                        87570017
HMSGTKR  EQU   6                                                        87650017
HMSGTDR  EQU   7                                                        87730017
HMSGTER  EQU   8                                                        87810017
HMSGERS  EQU   9                                                        87890017
HMSGUOE  EQU   10                                                       87970017
HMSGUIE  EQU   11                                                       88050017
HMSGDCB  EQU   12                                                  6598 88130017
HMSGPELR EQU   13                                                       88630017
HMSGPEOD EQU   14                                                       89130017
HMSGBLK1 EQU   17                      NO INPUT BLKSIZE SPECIFIED       89630017
HMSGBLK2 EQU   18                      NO OUTPUT BLKSIZE SPECIFIED      90130017
HINDD    EQU   24                                                       90630017
HOUDD    EQU   32                                                       91130017
         ENTRY HGENPS3                                                  91630017
         DCBD  DSORG=PS                                                 92130017
DDNAM    EQU   DCBDDNAM-IHADCB                                          92630017
OFLGS    EQU   DCBOFLGS-IHADCB                                          93130017
DSORG    EQU   DCBDSORG-IHADCB                                          93630017
BLKSI    EQU   DCBBLKSI-IHADCB                                          94130017
KEYLE    EQU   DCBKEYLE-IHADCB                                          94630017
BUFL     EQU   DCBBUFL-IHADCB                                           95130017
RECFM    EQU   DCBRECFM-IHADCB                                          95630017
LRECL    EQU   DCBLRECL-IHADCB                                          96130017
EODADOFS EQU   DCBEODAD+1-IHADCB                                        96630017
SYNADOFS EQU   DCBSYNAD-IHADCB                                          97130017
         END                                                            97630017
./  ADD  SSI=81160028,NAME=IEBGEN03
 TITLE  'IEBGEN03-IEBGENER MAIN PROCESSOR'                        10696 00010014
*********************************************************************** 00020000
*                                                                     * 00040000
*                    * * * I E B G E N 0 3 * * *                      * 00060000
*                         * * * * * * * * *                           * 00080000
*                                                                     * 00100000
*      THIS IS THE PROCESSING MODULE FOR NON-SPANNED DATASETS      UL0H 00120017
*      IT GETS CONTROL AFTER IEBGENR3 HAS OPENED THE INPUT AND     UL0H 00140017
*      OUTPUT DATASETS                                             UL0H 00160017
*      IT CONTROLS LINKAGE TO EDIT AND CONVERSION ROUTINES FOR     UL0H 00180017
*      SPECIAL PROCESSING DICTATED BY IEBGENER CONTROL STATEMEBT   UL0H 00200017
*      IT USES THE BSAM ACCESS METHOD AND DOUBLR BUFFERING         UL0H 00220017
*      AFTER PROCESSING IS COMPLETED IT RETURNS TO IEBGENR3        UL0H 00240017
*                                                                     * 00320000
*                         * * * * * * * * *                           * 00340000
*                                                                     * 00360000
*                             E N T R Y                               * 00380000
*                                                                     * 00400000
*      THE SUBROUTINE HAS ONE EXTERNALLY REFERENCABLE ENTRY POINT     * 00420000
*      WHOSE SYMBOLIC NAME IS:                                        * 00440000
*                             H G E N P                               * 00460000
*                                                                     * 00480000
*                         * * * * * * * * *                           * 00500000
*                                                                     * 00520000
*                             I N P U T                               * 00540000
*                                                                     * 00560000
*      THE SUBROUTINE IS ENTERED WITH OP REGISTER 1  POINTING TO      * 00580000
*      A LIST IN WHICH ARE THE ADDRESSES OF TABLES CONSTRUCTED BY     * 00600000
*      THE I E B G S C A N SUBROUTINE ACCORDING TO THE PARAMETERS     * 00620000
*      SPECIFIED IN THE UTILITY CONTROL CARDS. MAIN  STORAGE  FOR     * 00640000
*      THESE TABLES IS GOTTEN AND RELEASED OUTSIDE THIS ROUTINE.      * 00660000
*                                                                     * 00680000
*********************************************************************** 00700000
         EJECT                                                          00720000
*********************************************************************** 00740000
*                                                                     * 00760000
*                             E X T R N                               * 00780000
*                                                                     * 00800000
*      THE SUBROUTINE REFERENCES THESE EXTERNALLY DEFINED  VALUES     * 00820000
*      OR SUBROUTINE NAMES:                                           * 00840000
*                             H M O V E                               * 00860000
*              A CLOSED SUBROUTINE USED BY THIS ROUTINE               * 00880000
*              TO MOVE RECORDS OF ANY SIZE IN CORE                    * 00900000
*                                                                     * 00920000
*                             H E D I T                               * 00940000
*              A CLOSED SUBROUTINE USED BY THIS ROUTINE               * 00960000
*              TO EXECUTE THE EDITING SPECIFIED BY THE                * 00980000
*              UTILITY CONTROL CARDS.                                 * 01000000
*                                                                     * 01020000
*                              H P R L                                * 01040000
*              A CLOSED SUBROUTINE USED BY THIS ROUTINE               * 01060000
*              TO ESTABLISH THE LENGTH OF AN OUTPUT RE-               * 01080000
*              CORD ACCORDING TO THE EDIT PARAMETERS.                 * 01100000
*                                                                     * 01120000
*                            H W R M S G                              * 01140000
*                                                                     * 01160000
*              A CLOSED SUBROUTINE USED BY THIS ROUTINE               * 01180000
*              TO WRITE MESSAGES ISSUED BY THIS ROUTINE               * 01200000
*              ON THE DEVICE SPECIFIED BY SYSPRINT  DD-               * 01220000
*              NAME.                                                  * 01240000
*                                                                     * 01260000
*                          D D E R R O R 1                            * 01280000
*                                                                     * 01300000
*              A MESSAGE USED AS A DIAGNOSTIC WHEN DATA               * 01320000
*              DEFINITION STATEMENT NAMES ARE IMPROPER-               * 01340000
*              LY SPECIFIED TO THE PROGRAM.                           * 01360000
*                                                                     * 01380000
*********************************************************************** 01400000
         EJECT                                                          01420000
*********************************************************************** 01440000
*                                                                     * 01460000
*                   E R R O R   C O N D I T I O N                     * 01480000
*                                                                     * 01500000
*      THE SUBROUTINE WILL TERMINATE PROCESSING, CAUSE AN APPROP-     * 01520000
*      RIATE DIAGNOSTIC MESSAGE TO BE PRINTED AND RETURN VIA REG-     * 01540000
*      ISTER 14 UPON RECOGNITION OF THE FOLLOWING TYPES OF ERROR:     * 01560000
*                                                                     * 01580000
*              1.PERMANENT I/O ERROR ON EITHER INPUT OR               * 01600000
*                OUTPUT DATA SET.                                     * 01620000
*              2.ANY CONTROL STATEMENT ERROR UNABLE  TO               * 01640000
*                BE DETERMINED AT CONTROL CARD  PROCES-               * 01660000
*                SING TIME,I.E.-PARAMETERS WHICH ARE AT               * 01680000
*                VARIANCE WITH INCOMING DATA.                         * 01700000
*              3.DATA FORMAT ERRORS NOT APPARENT TO THE               * 01720000
*                BSAM ACCESS METHOD.                                  * 01740000
*              4.NO BLKSIZE SPECIFIED FOR EITHER INPUT            10696 01746014
*                OR OUTPUT DATA SET.                              10696 01752014
*                                                                     * 01760000
*                         * * * * * * * * *                           * 01780000
*                                                                     * 01800000
*                             N O T E S                               * 01820000
*                                                                     * 01840000
*      THIS SUBROUTINE IS 'ONLY LOADABLE'.IT IS NOT RE-ENTRANT;IT     * 01860000
*      IS NOT RE-USABLE.                                              * 01880000
*                                                                     * 01900000
*********************************************************************** 01920000
         EJECT                                                          01940000
IEBGEN03 CSECT                                                          01980000
*                                                                A36114 01980121
*047000                                                          A23810 01980218
*102100                                                          F25211 01980418
*135000,139800,167000                                            A22671 01980618
*151910,155200-155270                                            F21533 01980818
* 0219700,021900                                                  M2461 01980918
* 088800                                                         A25958 01981119
* 132800-135800,140800-141800                                    A27717 01981319
* 038000-039200,039800,040000                                    A35449 01981420
* 118600-119000,119600-122000                                    A35448 01981520
*A092750,092907-092942                                           A45131 01982121
*D092750                                                         A45131 01982721
*A046720-047040,047500-047592,147690,169900                      A45145 01983521
*D046730,046760,046800,046880,046960,047040,047120               A45145 01985521
*C047600,147590                                                  A45145 01985921
*A139100,139300-139340,175300                                    A48809 01988621
*C138000,138400                                                  A48809 01990621
*D141100                                                         A48809 01991021
*A037500,062100,063100,063460,063520,641000,65100,082200,        A50939 01991121
*A092400-092670,098250,127460,127520,175330,175360               A50939 01991221
*D064400-064800,082200,092400,092500                             A50939 01991321
*A092911                                                       @ZA03366 01991403
*C092914                                                       @ZA03366 01991503
*D092928                                                       @ZA03366 01991603
*A062966-062990                                                @ZA01743 01991703
*A100220-100280                                                @ZA04424 01992100
*A100292-100296                                                @ZA07363 01992500
*A100100-100200                                                @ZA10940 01992600
*C100300                                                       @ZA10940 01995800
*A100284-100288                                                @ZA13747 01997800
*C047400                                                       @ZA16476 01998299
*A147271,173100                                                @ZA24341 01998700
R0       EQU   0                                                        01999200
R1       EQU   1                                                        02002421
R2       EQU   2                                                        02005621
R3       EQU   3                                                        02008821
R4       EQU   4                                                        02012021
R5       EQU   5                                                        02015221
R6       EQU   6                                                        02018421
R7       EQU   7                                                        02021621
R8       EQU   8                                                        02024821
R9       EQU   9                                                        02028021
R10      EQU   10                                                       02031221
R11      EQU   11                                                       02034421
R12      EQU   12                                                       02037621
R13      EQU   13                                                       02040821
R14      EQU   14                                                       02044021
R15      EQU   15                                                       02047221
HGENP    SAVE  (14,12),T,GEN03                                 @ZA24341 02050400
         LR    2,15                                                     02053621
         USING HGENP,2                                                  02056800
         LA    3,HGENPRS                LOAD WORK AREA ADDRESS          02060000
         ST    3,8(13)                  AND STORE IT                    02080000
         STM   13,14,HSAVE13                                            02100000
         LA    13,HGENPRS                                               02120000
         L     3,0(1)                   LOAD EXIT TABLE ADDRESS         02140000
         ST    3,HEXITTA                STORE EXIT TABLE ADDRESS        02160000
         MVC   HMDTCUR(16),64(3)        STOER SWITCHES             UL0H 02163017
         MVC   HMDTCUR+16(1),93(3)      STORE PO SWITCH            UL0H 02166017
         MVC   HPOID(1),94(3)                                      UL0H 02169017
         MVC   LABPOLAT(8),80(3)       MOVE LABEL POOL ADDRESSES   UL0H 02172017
         MVC   TOTLAREA+12(4),88(R3)   MOVE TOTALING AREA ADDRESS  UL0I 02175018
         MVC   LABPROSW(1),92(3)       MOVE LABEL PROCESSING SWITC UL0H 02178017
         L     12,HDCBINA              LOAD SYSUT1DCB ADDRESS           02185017
         MVC   EODADOFS(3,12),HEODAD+1 MOVE EODAD ROUT.ADD AND          02186017
         MVC   SYNADOFS+1(3,R12),HINERAD+1 PUT SYNAD ADDR IN DCB  M2461 02187018
         L     4,HDCBOUTA              STORE SYNAD ROUT,ADDRESS         02189017
         MVC   SYNADOFS+1(3,R4),HOUERAD+1  PUT SYNAD ADDR IN DCB  M2461 02190018
         ST    4,TOTLAREA+4            STORE DCB ADDRESS IN LIST        02192017
         CLI   0(3),X'40'              TOTALING SPECFIED                02196017
         BE    HGENP5A                 NO-BRANCH                        02200017
         OI    TOTLEXSW,X'80'          SET TOTALING EXIT SWITCH         02204017
         LR    10,3                                                     02208017
         LOAD  EPLOC=(10)              LOAD USER ROUTINE                02212017
         ST    0,ADTOTEXR              STORE ADDRESS                    02216017
HGENP5A  BAL   14,INOUTSET             DATA SET ATTRIBUTES         6598 02970013
*                                                                  7653 02973017
*  GO TO THE MESSAGE WRITER TO SPACE SYSPRINT ONE LINE IN CASE     7653 02976017
*  SYSUT2 AND SYSPRINT ARE THE SAME DATA SET.                      7653 02979017
*                                                                  7653 02982017
         LA    0,1                 INDICATE MSG LENGTH OF 1        7653 02985017
         LA    1,BLANKS            POINT TO BLANKS AS THE MSG      7653 02988017
         L     15,HCDWRA           ADDR OF ENTRY PT TO WTR ROUTINE 7653 02991017
         BAL   14,4(15)            ENTER 4 PAST ENTRY PT TO SKP LA 7653 02994017
         SR    0,0                                                 7653 02997017
         C     0,HKEYLOU                IF KEYS,GET SAVE AREA           03000000
         BE    HINP1                                                    03020000
         L     0,HKEYLOU                LOAD KEY LENGTH                 03040000
         GETMAIN R,LV=(0)               GET CORE TO SAVE KEY            03060000
         ST    1,HKEYA                  STORE CORE ADDR                 03080000
         L     0,HKEYLOU                LOAD KEY LENGTH                 03100000
         BCTR  0,0                      REDUCE KEY LENGTH BY 1          03120000
         STC   0,HGENP6+1               STORE EXACT KEY LNGTH IN XC INS 03140000
HGENP6   XC    0(1,1),0(1)              ZERO OUT KEY AREA               03160000
HINP1    L     5,HIN1AD            PREPARE REGS FOR PROCESSING     3599 03260015
         L     6,HOU2AD            RECORDS BY LOADING BUFFER ADDRS 3599 03360015
HINP1A   ST    6,HOU2AD                 INITIALIZE OUTPUT XR            03480000
         MVC   CPYSWSAV(1),HCOPYSW                                      03500000
         TM    HCOPYSW,X'FF'            EDITING WITH IDENT              03520000
         BO    HINP1A1                                                  03540000
         BM    HINP1A1                                                  03560000
         L     9,HRDTCUR                YES                             03580000
         TM    0(9),X'20'               EDITING THIS RECORD             03600000
         BO    HINP1A1                  YES                             03620000
         OI    HCOPYSW,HCOPYMSK         NO, SET COPY SWITCH             03640000
HINP1A1  BAL   12,HREAD                                                 03660000
         B     HINP3                                                    03680000
HINP2    C     7,HBLIN                  TEST FOR END OF BUFFER          03700000
         BL    HINP6                    IF NOT,GO TO UPDATE XR AND ARS  03720000
HINP3     SR    4,4                                                     03740000
         NI    CHECKINP,X'00'      MARK INP CHECK ISSUED         A50939 03750021
         CHECK HDECBIN                  CHECK SYSUT1                    03760000
         XC    REDANY(1),REDANY        RCD(S) IN SYSUT1 DATASET    6291 03770017
HINP3X   NOP   HEOD                                                     03780017
         L     9,HDECBIN+8        GET SYSUT1 DCB ADDRESS         A35449 03800020
         L     10,HDECBIN+16      GET SYSUT1 IOB ADDRESS         A35449 03820020
         LH    10,14(0,10)        GET RESIDUAL COUNT             A35449 03840020
         LH    9,62(0,9)          GET BLOCKSIZE FROM DCB         A35449 03860020
         SR    9,10               CALCULATE LENGTH LAST BLOCK    A35449 03880020
         TM    HINORG,X'10'  INPUT BLOCKED ?                     A35449 03900021
         BO    SKIPKEYL      YES, IGNORE KEYLENGTH               A35449 03902021
         A     9,HKEYL       ADD  KEYLENGTH                      A35449 03904021
SKIPKEYL ST    9,HBLIN    STORE RECORD LENGTH                    A35449 03906021
         L     10,HDECBIN+8  GET SYSUT1 DCB ADDRESS              A36114 03910021
         TM   36(10),X'80'   IS RECFM VARIABLE                   A36114 03920021
         BNZ   CONTIN        NO                                  A36114 03930021
         L     10,ACINAREA   LOAD ACT INP. BUFFER ADDRESS        A36114 03932021
         LH    10,0(0,10)    LOAD BDW NUMBER OF VAR RECORD       A36114 03934021
         CR    10,9          BDW NUMBER SMALLER TH PH. REC.      A36114 03936021
         BNL   CONTIN        NO                                  A36114 03938021
         ST    10,HBLIN      YES,SAVE TRUE BLKLENGTH             A36114 03938421
CONTIN   EQU   *                                                 A36114 03938821
         TM    HINORG,X'20'             U-TYPE REC?                     03940000
         BZ    HINP3N                   NO                              03960000
         S     9,HKEYL            CALCULATE RECORD LENGTH        A35449 03980020
         STH   9,HRLIN            SAVE THIS LENGTH               A35449 04000020
HINP3N   CALL  HMOVE,(HIN2AD,HIN1AD,HBLIN) MOVE SYSUT1 BUFF1 TO BUFF2   04020000
         L     5,HIN1AD                 SET XR FOR READ                 04040000
         CLI   HKEYLOU+3,X'00'          IS THERE A KEY?                 04060000
         BE    HINP4                    NO                              04080000
         L     10,HKEYLOU               YES                             04100000
         BCTR  10,0                     LOAD                            04120000
         STC   10,HINP3A+1              KEY                             04140000
         L     10,HKEYA                 IN REG10                        04160000
HINP3A   MVC   0(1,10),0(5)             MOVE KEY TO SAVE AREA           04180000
HINP4    BAL   12,HREAD                 READ SYSUT1 INTO BUFF1          04200000
         L     5,HIN2AD                 RESET INPUT XR                  04220000
         LH    7,HRLIN                  RESET INPUT ARS                 04240000
         STH   7,HWK2                                                   04260000
         A     5,HKEYL                  ADD KEY LENGTH TO XR            04280000
         TM    HINORG,X'40'             TEST FOR V                      04300000
         BZ    HINP5                    IF V,                           04320000
         LA    5,4(0,5)                 ADJUST XR FOR COUNT FIELD,      04340000
         MVC   HWK2(2),0(5)             SET ARS TO LENGTH OF FIRST      04360000
         LA    5,4(0,5)                 DISPLACE PAST RECORD COUNT      04380000
HINP4A   LH    7,HWK2                   RECORD AND ADJUST FOR           04400000
         LA    7,4(0,7)                 COUNT FIELD                     04420000
HINP5    A     7,HKEYL                                                  04440000
         B     HINP7A                                                   04460000
HINP6    LR    5,7                                                      04480000
         A     5,HIN2AD                                                 04500000
         TM    HINORG,X'40'             TEST FOR F OR U                 04520000
         BO    HINP7                                                    04540000
         MVC   HWK2(2),HRLIN                                            04560000
         AH    7,HRLIN                  UPDATE ARS FOR U OR F TYPE      04580000
         B     HINP7A                                                   04600000
HINP7    MVC   HWK2(2),0(5)             UPDATE ARS FOR V TYPE           04620000
         LA    5,4(0,5)                 DISPLACE PAST RECORD COUNT      04640000
         AH    7,HWK2                                                   04660000
HINP7A   L     12,HDCBINA              LOAD INPUT DCB ADDRESS           04670017
         CLC   HWK2(2),LRECLINP    LRECL/BLKSI GREATER TH.SPEC.  A45145 04672021
         BH    HINER2              YES,PERM. INP. ERROR          A45145 04704021
         TM    RECFM(12),X'80'     RECFM F OR U ?                A45145 04706021
         BO    TESTFU              YES, SKIP V TEST              A45145 04708021
         CLC   HWK2(2),HH4              IS REC CT LESS THAN 4           04720000
         BL    HINER2              YES--PERM INPUT ERROR       @ZA16476 04740099
TESTFU   CLC   HWK2(2),HH0         LRECL/BLKSIZE ZERO   ?        A45145 04750021
         BE    TESTU               YES, TEST RECFM FOR U         A45145 04752021
         B     HINP7A3             SKIP U TEST                   A45145 04754021
TESTU    TM    HINORG,X'20'        RECFM=U ?                     A45145 04756021
         BNO   HINER2              NO, PERM. INP. ERROR          A45145 04758021
         TM    17(12),X'50'        INPUT DEV. PAPER TAPE ?       A45145 04758421
         BNO   HINER2              NO, PERM. INP. ERROR          A45145 04758821
         B     HINP3               YES, READ NEXT RECORD         A45145 04759221
HINP7A3  TM    HCOPYSW,HCOPYMSK    PREDICT 1ST OUTPUT REC LENGTH A45145 04760021
         BZ    HINP8                    IF COPY,                        04780000
         BAL   12,ANYBODY               SET HRLPRE                      04800000
HINP7B   NOP   HOUP1                                                    04820000
         OI    HINP7B+1,X'F0'           FIRST TIME THROUGH,             04840000
HINP7C   L     8,HKEYLOU                INITIALIZE OUTPUT ARS           04860000
         BAL   12,HMVKEY                MOVE KEY TO OUTPUT              04880000
         A     6,HKEYLOU                ADJUST OUTPUT XR FOR KEY LENGTH 04900000
         TM    HOUORG,X'40'                                             04920000
         BZ    HOUP1                    IF V TYPE,                      04940000
         LA    8,4(0,8)                 ADJUST XR AND ARS               04960000
         MVC   2(2,6),HH0          ZERO THE RECORD BB FIELD        4028 04980015
         LA    6,4(0,6)                                                 05000000
         B     HINP7B                   BEFORE OUTPUT                   05020000
HINP8    NOP   HOUP1                    IF EDIT,GO TO HPRL              05040000
         BAL   12,HPREDLEN              PREDICT LENGTH OF FIRST REC GRP 05060000
         OI    HINP8+1,X'F0'                                            05080000
         B     HINP7B                                                   05100000
HOUP1    BAL   12,ANYBODY               SET HRLPRE                      05120000
         AH    8,HRLPRE                 ADD DATA COUNT TO OUTCOUNT      05140000
         TM    HOUORG,X'40'                                             05160000
         BZ    HOUP1A                   IF V EDIT,                      05180000
         LA    8,4(0,8)                 ADJUST ARS FOR RECORD COUNT FLD 05200000
HOUP1A   TM    HOUORG,X'10'             IF UNBLOCKED OUTPUT,            05220000
HOUP1B   B     HOUP4                                                    05240000
         BZ    HOUP2A                   SKIP OVERFLOW TEST              05260000
         CH    8,HBLOU                  WILL NEXT RECORD OVERFLOW?      05280000
         BH    HOUP2A                   IF SO,WRITE BLOCK               05300000
         TM    HPOID,X'02'              TEST FOR PDS                    05320000
         BZ    HOUP4                                                    05340000
         TM    HSTOWSW,X'FF'            TEST FOR END OF MEMBER          05360000
         BZ    HOUP4                    IF END,WRITE ANYWAY             05380000
HOUP2A   SH    8,HRLPRE                 ADJUST ARS                      05400000
         S     8,HKEYLOU                                                05420000
HOUP2B   L     9,HOU2AD                 MOVE KEY,IF ANY                 05440000
         CLI   HKEYLOU+3,X'00'          IF OUTPUT KEYS,                 05460000
         BE    HOUP2C                   LINK TO USER EXIT               05480000
         L     10,HEXITTA                                               05500000
         LTR   10,10                    IF NO EXIT LIST,                05520000
         BZ    HOUP2K                   SKIP TEST                       05540000
         CLI   48(10),X'40'                                             05560017
         BE    HOUP2K                                                   05580000
         LA    10,48(10)               LOAD ROUTINE NAME LOC.           05600017
         L     11,HOU2AD                LOAD SYSUT2 BUFF2 ADDR          05620000
         L     12,HDCBOUTA             LOAD SYSUT2 DCB ADDRESS          05640017
         LINK  EPLOC=(10),PARAM=((11),(12))                             05660000
         SR    1,1                                                      05680000
         BAL   12,HTSTTRM               TEST FOR TERMINATION REQUEST    05700000
         B     HOUP2K                   NO                              05720000
         LA    1,HMSGTKR                YES,WRITE MESSAGE               05740000
         SLL   1,8                                                      05760000
         LA    4,6                      MESSAGE ID 6                    05780000
HOUP2J   AR    1,4                                                      05800000
         L     15,HWRMSGA                                               05820000
         BALR  14,15                                                    05840000
         B     HTERMU                   TERMINATE                       05860000
HOUP2K   A     9,HKEYLOU                                                05880000
HOUP2C   TM    HOUORG,X'40'             IF V,                           05900000
         BZ    HOUP2E                   ENTER BLOCK LENGTH              05920000
         SH    8,HH4                                                    05940000
         STH   8,HALFWORK          STORE BLKSIZE IN WORKAREA       000G 05950016
         MVC   0(2,9),HALFWORK     MOVE BLKSIZE TO BLOCK LL FIELD  000G 05960016
         B     HOUP3                                                    05980000
HOUP2E   TM    HOUORG,X'80'                                             06000000
         BZ    HOUP2F                                                   06020000
         L     10,HDCBOUTA             MODIFY DCB LENGTH                06040017
         LTR   8,8                                                      06060000
         BC    8,NOWRITE                                                06080000
         STH   8,BLKSI(10)                                              06100000
         B     HOUP3                                                    06120000
HOUP2F   LR    10,8                     STORE U-TYPE LENGTH             06140000
HOUP3    A     8,HKEYLOU                                                06160000
         ST    8,HBLOUAC                STORE ACTUAL BLOCK LENGTH       06180000
HOUP3A   B     HOUP3B                   DO NOT CHECK 1ST TIME THROUGH   06200000
         NI    CHECKOUT,X'00'      MARK OUTP CHECK ISSUED        A50939 06210021
         CHECK HDECBOU                  CHECK SYSUT2                    06220000
HOUP3B   NI    HOUP3A+1,X'0F'           MOVE SYSUT2 BUFF2               06240000
         CALL  HMOVE,(HOU1AD,HOU2AD,HBLOUAC)  TO BUFF1                  06260000
         L     6,HOU1AD                SET XR TO WRITE             UL0H 06262017
         TM    TOTLEXSW,X'80'          TEST TOTALING EXIT          UL0H 06264017
         BZ    HOUP3B2                 NO EXT - BRANCH             UL0H 06266017
         ST    R6,TOTLAREA             POINTTOTAL ROUT. TO BUFFER  UL0I 06268018
         LA    1,TOTLAREA              LOAD ADDRESS OF PARAMETERS  UL0H 06270017
         L     15,ADTOTEXR             LOAD ADDRESS OF USER ROUT.  UL0H 06272017
         BALR  14,15                                               UL0H 06274017
         CH    15,HCONCODE             UPDATE HIGHEST COND.CODE    UL0H 06276017
         BL    HOUP3B1                 IF                          UL0H 06278017
         STH   15,HCONCODE             NESSECARY                   UL0H 06280017
HOUP3B1  CH    15,SIXTEEN              RETRN CODE = SIXTEEN?       UL0H 06282017
         BE    TOTMSG1                 YES-TERMINATE               UL0H 06284017
         CH    15,EIGHT                RETURN CODE=EIGHT?          UL0H 06286017
         BE    TOTMSG2                 YES-GO TO END OF DATA       UL0H 06288017
         CH    15,FOUR                 RETRNCODE=FOUR              UL0H 06290017
         BE    HOUP3B2                 YES-BRANCH                  UL0H 06292017
         B     TOTMSG3                                             UL0H 06294017
HOUP3B2  DS    0H                                                       06296017
         L     1,HDCBOUTA           GET DCB ADDRESS            @ZA01743 06296603
         TM    36(1),X'80'          IS OUTPUT F OR U           @ZA01743 06297203
         BO    *+14                 BRANCH IF YES              @ZA01743 06297803
         CLC   4(2,6),82(1)         IS RDW GREATER THAN LRECL  @ZA01743 06298403
         BH    ERROR                YES ERROR                  @ZA01743 06299003
         WRITE HDECBOU,SF,HDCBOUT,(6),(10) WRITE SYSUT2 FROM BUFF1      06300000
         OI    CHECKOUT,X'F0'      MARK OUTP WRITE ISSUED        A50939 06310021
         L     10,HDCBOUTA             RESTORE DCB BLOCKSIZE            06320017
         MVC   BLKSI(2,10),HBLOU                                        06340000
NOWRITE  TM    HSTOWSW,X'FF'       MUST STOW BE ISSUED ?         A50939 06346021
         BZ    HOUP3F              NO, SKIP CHECK ETC.           A50939 06352021
         L     10,HMDTCUR               LOAD MEMBER TRUE NAME           06360000
         MVC   HSTOWAR(8),2(10)         LOAD MEMBER TRUE NAME           06380000
         XC    HSTOWAR+8(4),HSTOWAR+8   ZERO OUT C BYTE                 06400000
         NI    CHECKOUT,X'00'      MARK OUTP CHECK ISSUED        A50939 06410021
         CHECK HDECBOU                  CHECKS BEFORE STOW              06420000
         LA    4,1                                                      06500017
         NI    CHECKINP,X'00'      MARK INP CHECK ISSUED         A50939 06510021
         CHECK HDECBIN                                                  06520000
HOUP3C   BAL   12,HSTOW                 STOW TRUE NAME                  06540000
         LH    11,0(10)                 LOAD ALIAS COUNT                06560000
         LA    10,10(0,10)              UPDATE MDT XR                   06580000
         LTR   11,11                                                    06600000
         BZ    HOUP3E                                                   06620000
HOUP3D   MVI   HSTOWAR+11,X'80'         SET ALIAS BIT IN C BYTE         06640000
         MVC   HSTOWAR(8),0(10)         LOAD ALIAS                      06660000
         BAL   12,HSTOW                 STOW ALIAS                      06680000
         LA    10,8(0,10)               UPDATE MDT XR                   06700000
         BCT   11,HOUP3D                                                06720000
HOUP3E   ST    10,HMDTCUR               STORE UPDATED MDT ADDRESS       06740000
         NI    HSTOWSW,X'00'            TURN OFF STOW SWITCH            06760000
HOUP3F   NOP   HOUP4F                   SWITCH FOR EOD                  06780000
         L     6,HOU2AD                 RESET OUTPUT XR                 06800000
         BAL   12,HMVKEY                MOVE KEY TO OUTPUT              06820000
         A     6,HKEYLOU                ADJUST FOR KEY                  06840000
         LH    8,HRLPRE                 RESET OUTPUT ARS                06860000
         A     8,HKEYLOU                ADJUST FOR KEY                  06880000
         TM    HOUORG,X'40'                                             06900000
         BZ    HOUP4B                   IF V,                           06920000
         LA    6,4(0,6)                 ADJUST XR                       06940000
         LA    8,4(0,8)                 AND ARS                         06960000
         LA    8,4(0,8)                 ADJUST ARS                      06980000
HOUP4    NI    HOUP1B+1,X'0F'                                           07000000
         TM    HOUORG,X'40'                                             07020000
         BZ    HOUP4B                                                   07040000
HOUP4A   LH    9,HRLPRE                 LET RECORD COUNT                07060000
         LA    9,4(0,9)                 FIELD REFLECT                   07080000
         STH   9,HALFWORK               PLACE LENGTH IN STORAGE         07100000
         MVC   0(2,6),HALFWORK          MOVE LENGTH INTO CT FIELD       07120000
         MVC   2(2,6),HH0          ZERO BLOCK BB FIELD             4028 07140015
         LA    6,4(0,6)                 DISPLACE PAST RECORD COUNT      07160000
HOUP4B   ST    6,HIXOUT                 STORE CURR REC ADDR FOR SYSUT1  07180000
         ST    5,HIXIN                  AND SYSUT2                      07200000
         L     9,HEXITTA                LOAD USER EXIT TABLE ADDR       07220000
         LTR   9,9                      IF NO EXITS,                    07240000
         BZ    HOUP4C                   SKIP TEST                       07260000
         CLI   40(9),X'40'                                              07280017
         BE    HOUP4C                   IF USER DATA EXIT,LINK          07300000
         LA    9,40(9)                 SET UP ADDERSS                   07320017
         L     12,HDCBINA                                               07340017
         LR    11,5                     USER EXIT TABLE                 07360000
         LINK  EPLOC=(9),PARAM=((11),(12))                              07380000
         SR    1,1                                                      07400000
         BAL   12,HTSTTRM               TEST FOR TERMINATION REQ        07420000
         B     HOUP4C                   NO                              07440000
         LA    1,HMSGTDR                YES                             07460000
         SLL   1,8                                                      07480000
         LA    4,7                      MESSAGE ID 7                    07500000
         B     HOUP2J                   WRITE MESSAGE AND TERMINATE     07520000
HOUP4C   TM    HCOPYSW,HCOPYMSK         TEST COPY SWITCH                07540000
         BZ    HOUP4D                                                   07560000
HOUP4M   BAL   12,HRIDTST                                               07580000
         MVC   HWK4+2(2),HRLPRE                                         07600000
         CALL  HMOVE,(HIXOUT,HIXIN,HWK4) SYSUT1 BUFF2 TO SYSUT2 BUFF2   07620000
         B     HOUP4E                                                   07640000
HOUP4D   BAL   12,HRIDTST               MOVE REC WITH EDITING           07660000
         MVC   HWK2(2),HRLPRE           HWK2=DATA COUNT                 07680000
HOUP4X   CALL  HEDIT,(HEDCUR,HIXOUT,HIXIN,HWK2,HLITTA)                  07700000
         B     HOUP4E                   NORMAL RETURN FROM EDITOR       07720000
         B     HPREDLN2                 ERROR RETURN FROM EDITOR        07740000
HOUP4E   AH    6,HRLPRE                 UPDATE XR                       07760000
HOUP4F   TM    HEODSW,HEODMSK           IF PROCESSING TO END AT EOD,    07780000
         BO    HOUP5A                   OMIT LAST RECORD CHECK          07800000
         CLI   HRIDSW,X'FF'             TEST FOR LAST REC OF GROUP      07820000
         BE    HOUP5B                                                   07840000
HOUP5A   NOP   HOUP9              GO CLOSE AT EOD                  7342 07860000
         B     HINP2                                                    07880000
HOUP5B   L     9,HRDTCUR                                                07900000
         ST    9,HRDTSAV                                                07920000
         TM    HPOID,X'02'              PDS?                            07940000
         BZ    HOUP5D                   NO                              07960000
         TM    HMEMBYT(9),X'0F'         END OF MEMBER?                  07980000
         BZ    HOUP5F                   NO                              08000000
         OI    HSTOWSW,X'FF'            SET STOW SWITCH                 08020000
HOUP5D   TM    0(9),X'9F'               IF PDS,IS LAST CNTRL            08040000
         BNO   HOUP5D1                 CARD A MEMBER CARD          7653 08070017
         OI    HEODSW,HEODMSK           YES, PROCESS TO EOD             08100000
         B     HINP2                                                    08120000
HOUP5D1  TM    0(9),X'8F'               SET UP                          08140000
         BZ    HOUP5F                   FOR                             08160000
         BM    HOUP5F                   END OF                          08180000
         OI    HEODSW,HEODMSK           DATA ROUTINES                   08200000
HOUP5E   NOP   HOUP9               SWITCH FOR LAST RECORD        A50939 08220021
         OI    HOUP5E+1,X'F0'                                           08240000
         OI    TYPMSG,X'30'        SET LAST RECORD ID MSG SW       7653 08320017
         SR    4,4                                                      08370017
         B     HEOD                                                     08420000
HOUP5F   LA    9,12(0,9)                UPDATE RDT XR                   08440000
         ST    9,HRDTCUR                AND STORE                       08460000
         CLI   CPYSWSAV,X'00'           EDITING WITH IDENT              08480000
         BNE   HOUP5F1                  NO                              08500000
         B     HOUP5F2                  YES, CHECK LAST RECORD          08520000
HOUP5F1  TM    HCOPYSW,HCOPYMSK         EDITING                         08540000
         BO    HINP2                    NO                              08560000
         B     HOUP5G                                                   08580000
HOUP5F2  L     9,HRDTSAV                CHECK LAST RECORD               08600000
         TM    0(9),X'4F'               LAST IDENT                      08620000
         BZ    HOUP5F3                                                  08640000
         BM    HOUP5F3                                                  08660000
         L     9,HEDCUR                 YES                             08680000
HCHKFLD  TM    0(9),X'80'               LAST FIELD THIS RECORD          08700000
         BO    HLSTFLD                  YES                             08720000
         LA    9,8(0,9)                 NO, INCREMENT IX                08740000
         B     HCHKFLD                  CHECK AGAIN                     08760000
HLSTFLD  TM    0(9),X'81'               LAST RECORD FIELD               08780000
         BM    HCPYREV                  NO                              08800000
RAUNCH   OI    HEODSW,HEODMSK           YES,SET TO PROCESS EOD          08820000
         B     HOUP5E                   DO LAST WRITE                   08840000
HCPYREV  MVI   CPYSWSAV,X'FF'           RESET SWITCHES                  08860000
         OI    HEODSW,HEODMSK           PROCESS TO EOD                  08900000
         B     HOUP5G                                                   08920000
HOUP5F3  L     9,HRDTCUR                GET NEXT RECORD                 08940000
         TM    0(9),X'20'               EDITING                         08960000
         BO    HRESET1                  YES                             08980000
         OI    HCOPYSW,HCOPYMSK         NO,SET COPY SWITCH              09000000
         B     HRESET2                                                  09020000
HRESET1  MVI   HCOPYSW,X'00'            SET FOR EDITING                 09040000
HRESET2  L     9,HRDTSAV                GET LAST RECORD                 09060000
         TM    0(9),X'20'               WAS THERE EDITING               09080000
         BO    HOUP5G                   YES                             09100000
         L     9,HRDTCUR                RELOAD RDT IX                   09120000
         B     HINP2                    NO, CONTINUE                    09140000
HOUP5G   MVC   HEDCUR(4),HEDSV          GET NEXT EDT                    09160000
         L     9,HRDTCUR                RELOAD RDT IX                   09180000
         BAL   12,HPREDLEN                                              09200000
         B     HINP2                                                    09220000
HOUP9    TM    CHECKINP,X'F0'      MUST CHECK BE ISS. FOR INP ?  A50939 09240021
         BNO   CHKOUT              NO, SKIP INP CHECK            A50939 09243021
         NI    CHECKINP,X'00'      MARK INP CHECK ISSUED         A50939 09246021
         LH    4,THREE             SET R4=3, TO MARK RETURN PNT  A50939 09249021
         CHECK HDECBIN             CHECK LAST READ               A50939 09252021
CHKOUT   TM    CHECKOUT,X'F0'      MUST CHECK BE ISS. FOR OUTP ? A50939 09255021
         BNO   FRMAIN              NO, SKIP OUTP CHECK           A50939 09258021
         NI    CHECKOUT,X'00'      MARK OUTP CHECK ISSUED        A50939 09261021
         CHECK HDECBOU             CHECK LAST WRITE              A50939 09264021
FRMAIN   L     0,REGSAV            LOAD LGTH OF INP + OUTP BUFF. A50939 09267021
         LTR   0,0                 WAS BUFFER CORE GOTTEN          3599 09270015
         BZ    TSTKEYFR           IF NOT, TEST FOR KEY FREEMAIN  A45131 09275021
         XC    REGSAV(4),REGSAV    CLEAR REGSAV                    3599 09280015
         L     1,HIN1AD              BUFFER CORE ADDRESS FOR FREEMA3599 09285015
       FREEMAIN R,LV=(0),A=(1)                                     3599 09290015
TSTKEYFR L     R10,HKEYLOU        LOAD KEY LENGTH                A45131 09290721
         L     1,HKEYA            LOAD KEYSAVE ADDRESS         @ZA03366 09291103
         LTR   R1,R1              KEY PRESENT ?                @ZA03366 09291403
         BZ    DONTFREE           NO, RETURN TO GENR3            A45131 09292121
         LR    R0,R10             LOAD KEY LENGTH IN REG 0       A45131 09293521
         FREEMAIN R,LV=(0),A=(1)  FREEMAIN KEY SAVE AREA         A45131 09294221
DONTFREE CLI   HTERMSW,X'FE'       USER TERMINATION REQUEST        3599 09295015
         BNE   HOUP10                   NO,RETURN                       09300000
         B     HGENP4A                  YES,TERMINATE                   09320000
HOUP10   TM    TYPMSG,X'30'        TEST FOR EOD MSG NEEDED         7653 09327017
         BNM   HLSTID              GO TEST FOR LAST ID IF          7653 09334017
         LA    1,HMSGPEOD              PROCESSING END AT EOD MSG   7653 09341017
HLSTMSG  SLL   1,8                                                 7653 09348017
         L     6,AST                                               7653 09355017
         L     15,HWRMSGA                                          7653 09362017
         BALR  14,15                                               7653 09369017
CLOSAFTR LM    13,14,HSAVE13                                            09380000
         LH    15,HCONCODE              LOAD CONDITION CODE IN REG15    09400000
         RETURN (2,12)                                                  09420000
HLSTID   BNO   CLOSAFTR            GO BACK IF NO MSG NEEDED        7653 09425017
         LA    1,HMSGPELR          PROCESSING END AT LAST ID MSG   7653 09430017
         B     HLSTMSG                                             7653 09435017
*                                                                       09440000
HMVKEY   CALL  HMOVE,(HOU2AD,HKEYA,HKEYLOU)                             09460000
         BR    12                                                       09480000
*                                                                       09500000
HSTOW    L     1,HDCBOUTA                                               09510017
         STOW  (1),HSTOWAR,A                                            09520017
         SLL   15,20                                                    09540000
         SRL   15,20                                                    09560000
         LTR   15,15                    TEST FOR ERROR                  09580000
         BCR   8,12                     NO,RETURN                       09600000
         LA    15,12                    YES,CONCODE 12                  09620000
         STH   15,HCONCODE              SAVE ERROR CONCODE              09640000
         LA    1,HMSGERS                WRITE MESSAGE                   09660000
         SLL   1,8                      AND TERMINATE                   09680000
         LA    4,10               MESSAGE ID FOR STOW ERROR        6598 09700013
HSTOW3   AR    1,4                                                      09720000
         L     15,HWRMSGA                                               09740000
         BALR  14,15                                                    09760000
         B     HOUP9                                                    09780000
*                                                                       09800000
HREAD    READ  HDECBIN,SF,HDCBIN,(5),'S'                                09820000
         OI    CHECKINP,X'F0'      MARK INP READ ISSUED          A50939 09825021
         ST    5,ACINAREA    SAVE ACTUAL INP BUFFER ADDRESS      A36114 09830021
         BR    12                                                       09840000
*                                                                       09860000
HPREDLEN CALL  HPRL,(TOTEDIT,HEDCUR,HEDSV)                              09880000
ANYBODY  TM    HCOPYSW,HCOPYMSK         IS EDIT REQUESTED               09900000
         BO    NOEDIT                   NO                              09920000
         CLC   TOTEDIT(2),HRLOU         YES-DOES EDIT EXCEED OUTLRECL   09940000
         BH    HPREDLN2                 YES--INVALID,TERMINATE          09960000
         TM    HOUORG,X'80'             NO-IS OUTPUT FIXED FORMAT       09980000
         BO    HABLE                    YES                             10000000
         TM    HOUORG,X'20'        NO RECFM=U                  @ZA10940 10010000
         BO    RECFMU              YES                         @ZA10940 10020000
         LH    R9,TOTEDIT          NO--GET EDIT COUNT          @ZA04424 10022000
         AH    R9,HH4              ADJUST FOR RDW              @ZA04424 10024000
         CH    R9,HRLOU            DOES EDIT EXCEED RECORD CNT @ZA04424 10026000
         BH    HPREDLN2            YES--INVALID,TERMINATE      @ZA04424 10028000
         TM    HINORG,X'40'        IS INPUT V OR VB ?          @ZA13747 10028400
         BNO   RECFMU              NO, BRANCH                  @ZA13747 10028800
         TM    HOUORG,X'40'        YES, IS OUTPUT V OR VB ?    @ZA07363 10029200
         BO    AROUND              YES GO TO PREPARE COUNT     @ZA07363 10029600
RECFMU   LH    9,TOTEDIT           NO,EDIT COUNT BECOMES LRECL @ZA10940 10030000
         B     COMMON              GO STORE LRECL AND RETURN       3599 10060015
NOEDIT   TM    HOUORG,X'40'        IS OUTPUT RECFM VARIABLE FORMAT 3599 10090015
         BO    AROUND              TES, GO PREPARE COUNT           3599 10120015
         TM    HOUORG,X'80'        IS OUTPUT FIXED FORMAT          3599 10150015
         BO    HABLE               YES, GO GET LRECL               3599 10180015
         B     AROUND                  FORMAT IS U               F25211 10210018
COMMON   STH   9,HRLPRE            DATA COUNT TO HRLPRE            3599 10240015
         BR    12                  RETURN TO CALLER                3599 10270015
AROUND   LH    9,HWK2              RECORD COUNT                    3599 10300015
         TM    HINORG,X'40'        IS INPUT RECFM V OR VB          3599 10330015
         BC    14,COMMON           IF NOT, BRANCH                  3599 10360015
         SH    9,HH4               IF INPUT IS V, ADJUST LRECL     3599 10390015
         B     COMMON              GO STORE RECORD COUNT AND RETURN3599 10420015
HABLE    LH    9,HRLOU             OUTPUT LRECL BECOMES COUNT      3599 10450015
         B     COMMON              GO STORE COUNT AND RETURN       3599 10480015
         BR    12                       RETURN                          10540000
HPREDLN2 LA    15,12                    LOAD CONCODE 12 IN REG15        10560000
         STH   15,HCONCODE              AND STORE                       10580000
         LA    1,HMSGECC                WRITE MESSAGE AND TERMINATE     10600000
         SLL   1,8                                                      10620000
         LA    4,3                                                      10640017
         B     HSTOW3                                                   10660000
*                                                                       10680000
HRIDTST  TM    HEODSW,HEODMSK           TEST FOR LAST REC OF GROUP      10700000
         BCR   1,12                     CHECK                           10720000
         NI    HRIDSW,X'00'                                             10740000
         L     9,HRDTCUR                FOR                             10760000
         LH    10,HRIDL(9)              IDENT FIELD                     10780000
         BCTR  10,0                     IN RECORDS                      10800000
         STC   10,HRIDTST2+1                                            10820000
         LH    11,HRIDST(9)                                             10840000
         AR    11,5                                                     10860000
HRIDTST2 CLC   HRID(1,9),0(11)                                          10880000
         BCR   7,12                                                     10900000
         OI    HRIDSW,X'FF'                                             10920000
         BR    12                                                       10940000
*                                                                       10960000
HTERMU   LH    15,HCONCODE                                              10980000
         B     HOUP9                                                    11000000
*                                                                       11020000
*    THIS SUBROUTINE CHECKS CONDITION CODES TO DETERMINE WHICH CODE     11040000
*    WILL BE PASSED BACK TO THE CALLING PROGRAM.                        11060000
*                                                                       11080000
HTSTTRM  SLL   15,20                    TEST FOR 16 IN R15              11100000
         SRL   15,20                                                    11120000
         LTR   1,1                                                      11140000
         BZ    HTSTTRM4                                                 11160000
         LA    0,16                                                     11180000
         CR    0,15                                                     11200000
         BNE   HTSTTRM2                                                 11220000
HTSTTRM1 LA    12,4(0,12)                                               11240000
         LTR   1,1                                                      11260000
         BZ    HTSTTRM2                                                 11280000
         BR    12                                                       11300000
HTSTTRM2 SRL   15,2                     ROUND DOWN                      11320000
         SLL   15,2                                                     11340000
         LH    R0,HCONCODE                                              11379221
         CR    0,15                     IF OLD CONCODE IS HIGH          11380000
         BCR   10,12                    OR EQUAL,RETURN                 11400000
         LA    0,16                                                     11420000
         CR    15,0                                                     11440000
         BNH   HTSTTRM3                                                 11460000
         LR    15,0                                                     11480000
HTSTTRM3 STH   15,HCONCODE              OTHERWISE STORE NEW CONCODE     11500000
         BR    12                       BEFORE RETURNING                11520000
HTSTTRM4 LA    0,12                                                     11540000
         CR    0,15                                                     11560000
         BH    HTSTTRM2                                                 11580017
         B     HTSTTRM1                                                 11600000
*                                                                       11620000
TOTMSG1  LA    1,30                    LOAD MESSAGE ID .           UL0H 11640017
         BAL   14,TOTMSG4              LINK TO WRITE ROUTINE       UL0H 11660017
         B     HTERMU                  BRANCH TO TERMINATE         UL0H 11680017
TOTMSG2  LA    1,31                    LOAD MESSAGE ID.            UL0H 11700017
         BAL   14,TOTMSG4              LINK TO WRITE ROUTINE       UL0H 11720017
         B     HOUP9                   BRANCH TO END OF PROCESSING UL0I 11740018
TOTMSG3  LA    1,32                    LOAD MESSAGE ID.            UL0H 11760017
         BAL   14,TOTMSG4              LINK TO WRITE ROUTINE       UL0H 11780017
         NI    TOTLEXSW,X'7F'                                      UL0H 11800017
         B     HOUP3B2                 CONTINUE                    UL0H 11820017
TOTMSG4  STM   14,15,R14SAVE           SAVE REG 14 & 15            UL0H 11840017
         LR    R15,R1             ***                            A35448 11860020
         SLL   R1,8               * CALCULATE MESSAGE ID         A35448 11880020
         AR    R1,R15             ***                            A35448 11900020
         L     15,HWRMSGA              LOAD WRITER ROUTINE ADDRESS UL0H 11920017
         BALR  14,15                   LINK                        UL0H 11940017
         L     R15,R14SAVE+4      GET RETURN CODE OF TOT ROUT.   A35448 11960020
         SR    R14,R14            ***                            A35448 11980020
         LA    R1,10              * CALCULATE ALPHA NUMERIC      A35448 12000020
         DR    R14,R1             *     EQUVALENT AND            A35448 12020020
         LA    R14,240(0,R14)     *    UPDATE MESSAGE TEXT       A35448 12040020
         LA    R15,240(0,R15)     *                              A35448 12060020
         L     R1,VADDR3          *                              A35448 12080020
         STC   R14,22(R1)         *                              A35448 12100020
         STC   R15,21(R1)         ***                            A35448 12120020
         LA    R1,25              ***                            A35448 12140020
         SLL   R1,8               * CALCULATE MEESAGE ID         A35448 12160020
         LA    R1,25(0,R1)        ***                            A35448 12180020
         L     R15,HWRMSGA             LOAD ADDRESS OF MSG WRITER  UL0I 12210018
         BALR  14,15                   LINK                        UL0H 12220017
         LM    14,15,R14SAVE           RESTORE REG 14 & 15         UL0H 12240017
         BR    14                      RETURN                      UL0H 12260017
HGENP4A  LA    1,HMSGTLR                                                12280017
         SLL   1,8                                                      12300017
         LA    4,5                                                      12320017
ERRORPNT AR    1,4                                                      12340017
         L     15,HWRMSGA                                               12360017
         BALR  14,15                                                    12380017
         B     HTERMU                                                   12400017
*                                                                       12720000
HEOD     OI    HINP3X+1,X'F0'           SET UP                          12740000
         CH    4,THREE             FINAL CHECK ?                 A50939 12746021
         BE    CHKOUT              YES, RETURN                   A50939 12752021
         LTR   4,4                      END OF DATA                     12760000
         BP    HOUP3C                   PROCESSING SWITCHES             12780000
         OI    HOUP3F+1,X'F0'                                           12800017
         OI    HOUP5A+1,X'F0'                                           12820000
         TM    HOUP5E+1,X'F0'           DO NOT WRITE EOD MESS IF LAST   12840000
         BO    HEODA                    REC ID MESS ALREADY WRITTEN     12860000
         NI    HRIDSW,X'00'                                             12880017
         ST    6,SIXSV                                                  12900000
         OI    TYPMSG,X'10'        SET SW FOR EOD MSG              7653 12910017
         CLI   REDANY,X'FF'            ANY RCDS IN SYSUT1 DATASET  6291 12920017
         BE    HOUP9                   NO, GO CLOSE DATASETS       6291 12930017
HEODA    S     8,HKEYLOU                END OF DATA                     13080000
         TM    HPOID,X'02'              ROUTINE FOR                     13100000
         BZ    HEOD1                    PDS                             13120000
         OI    HSTOWSW,X'FF'                                            13140000
HEOD1    TM    HOUORG,X'40'             END OF DATA                     13160000
         BZ    HEOD2                    FOR VARIABLE                    13180000
         AH    8,HH4                                                    13200000
HEOD2    B     HOUP2B                                                   13220000
*                                                                       13240000
HINER    EQU   *                        INPUT SYNAD ROUTINE             13260000
         ST    R10,SYNADSAV            SAVE REG 10               A22671 13264018
         STM   R3,R4,SYNADSAV+4        SAVE REGS 3AND4           A22671 13268018
         ST    R12,SYNADSAV+12         SAVE REG 12               A22671 13272018
         ST    R14,HSAVE14             SAVE REG14                A22671 13276018
         BAL   R14,SYNADAFR            LINK TO SYNADAF ROUTINE   A27717 13376019
         B     HOUER1                  TEST USER ERROR EXIT      A27717 13476019
HINER2   LA    15,12                    LOAD CONCODE 12 IN REG 15       13600000
         STH   15,HCONCODE              AND STORE                       13620000
         LA    1,HMSGUIE                WRITE ERROR MSG AND TERMINATE   13640000
         SLL   1,8                                                      13660000
         LA    4,8                      MESSAGE ID 8                    13680000
         B     HSTOW3                                                   13700000
HINER3   LA    R15,12                  LOAD CON CODE 12 IN REG 15A27717 13705019
         STH   R15,HCONCODE            AND STORE                 A27717 13710019
         B     HOUP9                                             A27717 13715019
*                                                                       13720000
HOUER    EQU   *                        OUTPUT SYNAD ROUTINE            13740000
         ST    R10,SYNADSAV            SAVE REG 10               A22671 13740618
         STM   R3,R4,SYNADSAV+4        SAVE REGS 3AND4           A22671 13741218
         ST    R12,SYNADSAV+12         SAVE REG 12               A22671 13741818
         ST    R14,HSAVE14             SAVE REG14                A22671 13742418
         BAL   R14,SYNADAFR            LINK TO SYNADAF ROUTINE   A27717 13742719
         TM    TOTLEXSW,X'80'          TOTALING EXIT ACTIVE        UL0I 13743018
         BZ    HOUER1                  NO - BRANCH                 UL0I 13746018
         ST    R0,TOTLAREA+8           STORE STATUS INFO ADDRESS   UL0I 13749018
         MVI   TOTLAREA+8,X'80'         SET FLAG BYTE              UL0I 13752018
         STM   R0,R1,SAVER01           SAVE REGS 0 AND 1           UL0I 13755018
         LA    R1,TOTLAREA             PARM LIST FOR TOTALING      UL0I 13758018
         L     R15,ADTOTEXR            LOAD ROUTINE ADDRESS AND    UL0I 13761018
         BALR  R14,R15                 LINK                        UL0I 13764018
         LM    R0,R1,SAVER01           RESTORE REGISTERS           UL0I 13767018
HOUER1   L     R10,HEXITTA             EXIT LIST                   UL0I 13770018
         LTR   10,10                                                    13780000
         BZ    HINER3A            NO EXIT LIST                   A48809 13800021
         CLI   56(10),X'40'            TEST FOR USER EXIT               13820017
         BE    HINER3A            NO EXIT, END PROCESSING        A48809 13840021
         LA    10,56(10)               YES-LINK TO USER                 13860021
         LR    4,0                                                      13880000
         LR    3,1                                                      13900000
         OI    IOERREXI,X'F0'     SET IOERREXI  BYTE             A48809 13910021
         LINK  EPLOC=(10),PARAM=((4),(3))                               13920000
HINER3A  SYNADRLS                 FRMAIN WORKAR AND REST REG 13  A48809 13930021
         TM    IOERREXI,X'F0'     USER EXIT ?                    A48809 13932021
         BNO   HINER3             NO, END PROCESSING             A48809 13934021
         SR    1,1                                                      13940000
         BAL   12,HTSTTRM               TEST TERMINATION REQUEST        13960000
         B     RETFSYN                 RETURN TO SYSTEM          A22671 13980018
         LA    1,HMSGTER                WRITE ERROR MSG AND TERMINATE   14000000
         SLL   1,8                                                      14020000
         LA    4,12                                                     14040017
         B     HOUP2J                                                   14060000
SYNADAFR STM   R14,R1,SAVER141          SAVE SYNAD PARAMETERS    A27717 14070019
         SYNADAF  ACSMETH=BSAM                                   A27717 14080019
SYNAFR1  L     R10,SYNADMSA            LOAD ADDRESS OF MSG       A27717 14090019
         MVC   10(79,R10),49(R1)       MOVE SYNAD INFO TO MSG    A27717 14100019
         LA    R1,50                   LOAD MSG OFFSET           A27717 14120019
         SLL   R1,8                                              A27717 14130019
         LA    R1,51(R1)               ADD MSG ID                A27717 14140019
         L     R15,HWRMSGA             LOAD WRITER ADDRESS       A27717 14150019
         BALR  R14,R15                 LINK TO WRITER            A27717 14160019
         LM    R14,R1,SAVER141         RESTORE SYNAD PARAMETRS   A27717 14170019
         BR    R14                     RETURN                    A27717 14180019
*                                                                A27717 14190019
SAVER141 DS    4F                                                A27717 14200019
SYNADMSA DC    V(SYNADMSG)                                       A27717 14210019
*                                                                A27717 14220019
* THIS ROUTINE RETURNS CONTROL TO THE SYSTEM IF THE USERS EXIT   A22671 14230018
* ACCEPTS THE BAD RECORD , AND RETURNS A RETURN CODE OF LESS     A22671 14280018
* THAN TWELVE                                                    A22671 14330018
RETFSYN  L     R10,SYNADSAV            RESTORE REG10             A22671 14380018
         LM    R3,R4,SYNADSAV+4        RESTORE REGS 3 AND 4      A22671 14430018
         L     R12,SYNADSAV+12         RESTORE REG12             A22671 14480018
         L     R14,HSAVE14             RESTORE REG 14            A22671 14530018
         RETURN  ,                                               A22671 14580018
*                                                                       14680000
INOUTSET L     3,HEXITTA                EXIT LIST                  6598 14687013
         CLI   48(3),X'40'             TEST FOR KEY EXIT                14694017
         BZ    TSTDEV2                  NO KEY EXIT                6598 14701013
         OI    KEYOUTSW,X'01'           TURN ON KEY EXIT           6598 14708013
TSTDEV2  SR    4,4                 SET UP TO DETERMINE             4028 14709015
         SR    5,5                     BUFFER LENGTH               4028 14710015
         L     12,HDCBOUTA                                         UL0H 14710617
         TM    17(12),X'20'            IS UT2 DEVICE=DA            UL0H 14711217
         BZ    TSTDEV1             IF NOT, BRANCH                  4028 14712015
         IC    5,16(12)                GET KEYLENGTH FOR OUTPUT         14713017
         STC   5,HKEYLOU+3         SAVE THE OUTPUT KEYLENGTH       4028 14714015
         OI    KEYOUTSW,X'02'       SET UT2 EQUALS DA SWITCH       4028 14715015
TSTDEV1  AH    5,62(12)                ADD OUTPUT BLKSI TO KEYLEN  UL0H 14715717
         L     12,HDCBINA                                          UL0H 14716417
         TM    17(12),X'20'            IS UT1 DEVICE=DA            UL0H 14717117
         BZ    NOINKEY             IF NOT, BRANCH                  4028 14718015
         IC    4,16(12)                GET KEYLENGTH FOR INPUT     UL0H 14719017
         STC   4,HKEYL+3           SAVE THE INPUT KEYLENGTH        4028 14720015
         OI    KEYOUTSW,X'04'      SET UT1 EQUALS DA SWITCH        4028 14721015
NOINKEY  AH    4,62(12)                ADD INP BLKSI TO KEYLEN     UL0H 14721817
         STH   4,24(12)                STORE INPUT BUFF LEN IN DCB UL0H 14722617
         L     12,HDCBOUTA                                         UL0H 14723417
         STH   5,24(12)                STORE OTPUT BUFF LEN IN DCB      14724217
         LR    0,4                COMPUTE TOTAL BUFFER SPACE NEEDED4028 14725017
         AR    0,5                 BY ADDING INPUT AND OUTPUT BUFFE4028 14726015
         SLL   0,1                 LENGTHS AND SHIFTING ONE TO MULT4028 14727015
         AH    0,HH2000            ADD 2000 BYTES              @ZA24341 14727599
         ST    0,REGSAV            BY 2 FOR DOUBLE BUFFS.          4028 14728015
*                                                                  4028 14729015
*        SAVE LENGTH OF GET MAIN IN REGSAV FOR THE FREEMAIN LATER  4028 14730015
*                                                                  4028 14731015
       GETMAIN R,LV=(0)                                            4028 14732015
         ST    1,HIN1AD            INPUT BUFF 1 ADDR               4028 14733015
         AR    1,4                 ADD IN BUFL FOR INPUT BUFF 2 ADD4028 14734015
         ST    1,HIN2AD            SAVE INPUT BUFF 2 ADDR          4028 14735015
         AR    1,4                 ADD IN BUFL FOR OUTPUT BUFF 1 AD4028 14736015
         ST    1,HOU1AD            SAVE OUTPUT BUFF1 ADDR          4028 14737015
         AR    1,5                 ADD OUTPUT BUFL FOR OUTPUT FUFF 4028 14738015
         ST    1,HOU2AD              2  ADDR AND SAVE IT.          4028 14739015
OMPREREC L      4,HDCBINA               ADDR OF SYSUT1 DCB              14749017
         L     5,HDCBOUTA              ADDR OF SYSUT2 DCB        A45145 14759021
         MVC   LRECLINP(2),LRECL(R4)   SAVE INPUT LRECL(BLKSI)   A45145 14769021
         MVC   HINORG(1),RECFM(4)       MOVE SYSUT1 RECFM          6598 14771013
         MVC   HOUORG(1),RECFM(5)       MOVE SYSUT2 RECFM          6598 14778013
         NI    HINORG,X'D0'            LEAVE ATTRIBUTES            6598 14785013
         NI    HOUORG,X'D0'            LEAVE ON ATTRIBUTES         6598 14792013
         CLC   HINORG(1),HOUORG         COMPARE RECFM'S            6598 14799013
         BNE   CMPREBLK                 RECFM'S NOT EQUAL          6598 14806013
         OI    KEYOUTSW,X'08'           TURN ON EQUAL RECFM BIT    6598 14813013
CMPREBLK CLC   BLKSI(2,4),BLKSI(5)      COMPARE B1KSIZES           6598 14820013
         BNE   TSTKEYL                  BLKSIZE NOT EQUAL          6598 14827013
         OI    KEYOUTSW,X'10'           TURN ON EQUAL BLKSIZE BIT  6598 14834013
TSTKEYL  TM    KEYOUTSW,X'06'           TST IF UT1 AND UT2 DA      6598 14841013
         BC    12,KEYUT2          UT1 AND UT2 NIT BOTH DA          6598 14848013
         CLC   KEYLE(1,4),KEYLE(5)      COMPARE KEYLENGTHS         6598 14855013
         BNE   KEYUT2                   UT1 AND UT2 KEYS NOT EQUAL 6598 14862013
         OI    KEYOUTSW,X'20'          TURN ON EQUAL KEY           6598 14869013
KEYUT2   TM    KEYOUTSW,X'02'           TEST UT2 FOR DA            6598 14876013
         BZ    NOKEYOUT                 SYSUT2 IS NOT DA           6598 14883013
         TM    KEYLE(5),X'FF'           TEST UT2 KEYLENGTH FOR ZERO6598 14890013
         BZ    NOKEYOUT                 SYSUT1 KEY IS ZERO         6598 14897013
         OI    KEYOUTSW,X'40'          TURN ON NOT ZERO            6598 14904013
NOKEYOUT TM    KEYOUTSW,X'04'           TEST SYSUT1 FOR DA         6598 14911013
         BZ    OTKEYVAL                 SYSUT1 NOT DA              6598 14918013
         TM    KEYLE(4),X'FF'           TEST UT1 KEYLENGTH FOR ZERO6598 14925013
         BZ    OTKEYVAL                 SYSUT1 KEY IS ZERO         6598 14932013
         OI    KEYOUTSW,X'80'          TURN ON KEY NOT ZERO        6598 14939013
OTKEYVAL TM    KEYOUTSW,X'43'          TEST FOR VALID KEYS         6598 14946013
         BO    BUFFMV              OUTPUT KEYS ARE VALID           4028 14956015
         TM    KEYOUTSW,X'FE'      TEST FOR VALID KEYS, NO EXIT    4028 14966015
         BO    BUFFMV              OUTPUT KEYS ARE VALID           4028 14976015
         TM    KEYOUTSW,X'42'      IS UT2 DA AND KEYLEN NOT ZERO   4028 14986015
         BO    ERROR               UT2 KEYS ARE NOT VALID               14996015
BUFFMV   MVC   HBLIN+2(2),BUFL(4)      MOVE SYSUT1 BUFFER LENGTH   6598 15044013
         MVC   HBLOU(2),BUFL(5)        MOVE SYSUT2 BUFFER LENGTH   6598 15051013
         TM    KEYOUTSW,X'08'      ARE THE RECFM'S EQUAL           3599 15059015
         BZ    UNEQREC             BRANCH IF UNEQUAL               3599 15067015
         TM    HINORG,X'40'        IS SYSUT1 RECFM V,VB, OR U      3599 15075015
         BO    OUTVARBL            YES, GO COMPARE BLKSIZE'S       3599 15083015
INFOUTF  TM    HCOPYSW,HCOPYMSK    IS EDITING REQUESTED            3599 15091015
         BZ    CKLRECL             YES, GO STORE LRECLS            3599 15099015
         CLC   LRECL(2,4),LRECL(5) ARE LRECLS EQUAL                3599 15107015
         BNE   ERROR                    LRECL'S NOT EQUAL          6598 15121013
         LH    8,LRECL(5)               SYSUT2 LRECL               6598 15128013
         LH    7,BLKSI(5)               SYSUT2 BLKSIZE             6598 15135013
         SR    6,6                                                 6598 15142013
         DR    6,8                                                 6598 15149013
         LTR   6,6                      CHECK REMAINDER            6598 15156013
         BZ    CKLRECL             NO REMAINDER, BRANCH            3599 15163015
         B     ERROR                   NOT A MULTIPLE              6598 15170013
OUTVARBL TM    HCOPYSW,HCOPYMSK         TEST IF FIELD SPECIFIED    6598 15177013
         BZ    CKLRECL             YES, GO SET UP LRECL FIELD      3599 15184015
         TM    HINORG,X'C0'            INPUT IS U-TYPE           F21533 15185018
         BO    INPUTU                  YES- BRANCH               F21533 15186018
         LH    8,LRECL(4)              LOAD INPUT LRECL          F21533 15187018
         AH    8,HH4                   ADD 4 FOR VB              F21533 15188018
OUTVAR1  CH    8,BLKSI(5)              COMPARE IN LRECL AND      F21533 15189018
*                                      OUTPUT BLKSIZE            F21533 15190018
         BH    ERROR                   SYSUT2 BLOCK TOOSMALL     F21533 15191018
         BZ    CKLRECL                 GO SET UP LRECL FIELD     F21533 15192018
         B     UNEQREC                                           F21533 15193018
INPUTU   CLC   BLKSI(2,4),BLKSI(5)     COMPARE SYSUT1 AND SYSUT2 F21533 15194018
         BH    ERROR                    SYSUT2 BLKSIZE TOO SMALL   6598 15198013
         BZ    CKLRECL             YES, GO SET UP LRECL FIELD      3599 15205015
UNEQREC  TM    HINORG,X'10'             TEST IF SYSUT1 BLOCKED     6598 15212013
         BZ    INNOTBLK                 SYSUT1 NOT BLOCKED         6598 15219013
         TM    HINORG,X'40'             TEST UT1 FOR VAR BLOCK     6598 15226013
         BZ    TSTUT2                   SYSUT1 IS FIX BLOCK        6598 15233013
         OI    RECFMSW,X'30'            TURN ON UT1 EQUAL TO VB    6598 15240013
INNOTBLK TM    HINORG,X'C0'             TEST UT1 FOR U TYPE        6598 15247013
         BM    FIXORVAR                 UT1 IS FIXED OR VAR        6598 15254013
         OI    RECFMSW,X'10'            TURN ON UT1 EQUAL TO U TYPE6598 15261013
FIXORVAR TM    HINORG,X'80'             TEST UT1 FOR FIXED         6598 15268013
         BO    TSTUT2                   UT1 IS FIXED               6598 15275013
         OI    RECFMSW,X'20'            TURN ON UT1 EQUAL TO VAR   6598 15282013
TSTUT2   TM    HOUORG,X'10'             TEST SYSUT2 FOR BLOCKED    6598 15289013
         BZ    OTNOTBLK                 SYSUT2 NOT BLOCKED         6598 15296013
         TM    HOUORG,X'40'             TEST UT2 FOR VAR BLK       6598 15303013
         BZ    SWSET                                               6598 15310013
         OI    RECFMSW,X'03'           UT2 IS A VARIBLE            6598 15317013
         B     SWSET                                               6598 15324013
OTNOTBLK TM    HOUORG,X'C0'             TEST UT2 FOR U TYPE        6598 15331013
         BM    OFXORVAR                 SYSUT2 IS FIXED OR VAR     6597 15338013
         OI    RECFMSW,X'01'            TURN ON UT2 EQUAL TO U TYPE6598 15345013
         B     SWSET                                               6598 15352013
OFXORVAR TM    HOUORG,X'80'             TEST UT2 FOR FIXED         6598 15359013
         BO    SWSET                                               6598 15366013
         OI    RECFMSW,X'02'            TURN ON UT2 EQUAL TO VAR   6598 15373013
SWSET    SR    6,6                                                 6598 15380013
         IC    6,RECFMSW                                           6598 15387013
*                  RECFM SW   1 BYTE                               6598 15394013
*        INPUT                            OUTPUT                   6598 15401013
*        (HALF BYTE)                     (HALF BYTE)               6598 15408013
*        0       FIXED OR FIXED BLK     0                          6598 15415013
*         1       UNDEFINED TYPE        1                          6598 15422013
*        2        VARIBLE TYPE          2                          6598 15429013
*        3       VARIBLE BLK TYPE       3                          6598 15436013
         SRDL  6,4                      MOVE SYSUT2 BITS TO REG 7  6598 15443013
         SRL   7,28                     RIGHT ALIGN UT2 BITS       6598 15450013
         LTR   6,6                      TST UT1 FOR F OR FB        6598 15457013
         BNE   VARIN                    UT1 IS A VARIBLE           6598 15464013
         LTR   7,7                      TEST UT2 FOR F OR FB       6598 15471013
         BZ    INFOUTF                  UT1 AND UT2 ARE F OR FB    6598 15478013
         B     FINVOUT                  UT1 IS F OR FB - UT2 IS VAR6598 15485013
VARIN    TM    HCOPYSW,HCOPYMSK         TEST IF FIELD SPECIFIED    6598 15492013
         BZ    CKLRECL             YES, GO SET UP LRECL FIELD      3599 15499015
         LTR   7,7                      TEST UT2 FOR F OR FB       6598 15506013
         BZ    ERROR                    VAR IN, F OR FB OUT        6598 15513013
         CH    6,HH2                   INPUT IS V OR VB          F21533 15515018
         BNL   VIN1                    YES - BRANCH              F21533 15517018
         LH    4,BLKSI(4)              LOAD BLKSIZE FOR U -TYPE  F21533 15519018
         B     VOUT1                                             F21533 15521018
VIN1 LH 4,LRECL(4)                     LOAD LRECL FOR V OR VB    F21533 15523018
         AH    4,HH4                   ADD 4 TO LRECL            F21533 15525018
VOUT1    LH    5,BLKSI(5)              LOAD OUTPUT BLOCKSIZE     F21533 15527018
FIXGOOD  AR    6,7                      ADD UT2 RECFM TO UT1 RECFM 6598 15534013
         SH    6,THREE                                             6598 15541013
         SRL   7,1                                                 6598 15548013
         CR    6,7                                                 6598 15555013
         BE    TST7ZRO                  UT1 IS R,V (0),OR U,VB (1) 6598 15562013
*  REG6     REG7   REG7(SHIFT)   REG6+REG7                         6598 15569013
*   0  F,FB 0        0         (6 NOT EQUAL 7)                     6598 15576013
*   1   U   1        0              1   F,FB TO U  OR U TO F,FB    6598 15583013
*   2   V   2        1              2   F,FB TO V  OR V TO F,FB    6598 15590013
*   3  VB   3        1              3   F,FB TO VB OR VB TOF,FB    6598 15597013
*                                   4   U TO VB OR VB TO U         6598 15604013
*                                   5   V TO VB OR VB TO V         6598 15611013
*                                                                  6598 15618013
         BH    TST7ONE                                             6598 15625013
         B     ADD8                UT1 IS U, AND UT2 IS V          3599 15629015
TST7ZRO  LTR   7,7                 TEST REG 7 FOR ZERO             3599 15633015
         BZ    MINUS8              UT1 IS V AND UT2 IS U           3599 15637015
ADD8     LA    4,8(4)              BUMP SYSUT1 LRECL OR BLKSIZE    3599 15641015
         B     COMPARE                                             3599 15645015
MINUS8   LA    5,8(5)              BUMP SYSUT2 BLKSIZE             3599 15649015
         B     COMPARE                                             3599 15653015
TST7ONE  LTR   7,7                      TEST 7 FOR ZERO            6598 15660013
         BZ    MINUS8                   SYSUT1 IS VB - SYSUT2 IS U 6598 15667013
         B     COMPARE             GO COMPARE BLKSIZES             3599 15677015
FINVOUT  TM    HCOPYSW,HCOPYMSK        TEST IF FIELD SPECIFIED     6598 15695013
         BZ    CKLRECL                                             3599 15705015
         LH    5,BLKSI(5)              SYSUT2 BLKSIZE              6598 15716013
         LH    4,LRECL(4)              SYSUT1 LRECL                6598 15723013
         BCT   7,ADD8              BRANCH IF UT2  IS V OR VB       3599 15733015
COMPARE  CR    5,4                                                 6598 15758013
         BL    ERROR                                               6598 15765013
CKLRECL  L     12,HDCBINA                                          UL0H 15768017
         LH    4,82(12)                INPUT LRECL                 UL0H 15771017
         L     12,HDCBOUTA                                         UL0H 15774017
         LH    5,82(12)                OUTPUT LRECL                UL0H 15777017
         LTR   4,4                 IS INPUT LRECL ZERO             3599 15780015
         BNE   CKLRECL2            IF NOT, STORE LRECL             3599 15785015
         L     12,HDCBINA                                          UL0H 15788017
         LH    4,62(12)                INPUT BLOCKSIZE             UL0H 15791017
         TM    36(12),X'40'            INPUT RECFM  V              UL0H 15794017
         BC    14,CKLRECL2         IF NOT, STRE BLKSIZE            3599 15800015
         SH    4,HH4               DECREMENT BLKSIZE BY 4 FOR LRECL3599 15805015
CKLRECL2 STH   4,HRLIN             STORE INPUT LRECL               3599 15810015
         LTR   5,5                 IS OUTPUT LRECL ZERO            3599 15815015
         BNE   CKLRECL4            IF NOT, GO STORE LRECL          3599 15820015
         L     12,HDCBOUTA                                         UL0H 15823017
         LH    5,62(12)                OUTPUT BLOCKSIZE            UL0H 15826017
         TM    36(12),X'40'            OUTPUT RECFM V              UL0H 15829017
         BC    14,CKLRECL4         IF NOT, STORE BLKSIZE           3599 15835015
         SH    5,HH4               DECREMENT BLKSI BY 4 FOR V      3599 15840015
CKLRECL4 STH   5,HRLOU             STORE LRECL                     3599 15845015
         TM    HINORG,X'C0'             TEST IF U TYPE             6598 15863013
         BC    12,NEXT                  BRANCH NOT U TYPE          6598 15870013
         NI    HINORG,X'1F'        TURN OFF U AND TRKOVRFL BITS    3599 15877015
         OI    HINORG,X'20'             TURN ON 2 BIT FOR U TYPE   6598 15884013
NEXT     TM    HOUORG,X'C0'             TEST IF U TYPE             6598 15891013
         BC    12,GOBACK                BRANCH NOT U TYPE          6598 15898013
         NI    HOUORG,X'1F'        TURN OFF U AND TRK OVRFL BITS   3599 15905015
         OI    HOUORG,X'20'             TURN ON 2 BIT FOR U TYPE   6598 15912013
GOBACK   BR    14                                                  6598 15919013
ERROR    LA    1,HMSGDCB               MESSAGE CODE                6598 15926013
         SLL   1,8                                                 6598 15933013
         LA    4,11                    MESSAGE ID                  6598 15940013
         LA    15,12                                               6598 15947013
         STH   15,HCONCODE             RETURN CODE OF 12           6598 15954013
         B     ERRORPNT                PRINT MESSAGE               6598 15961013
* FOR A CHANGE IN RECFM'S AND NO FIELD SPECIFIED, THE FOLLOWING HOLDS * 15968013
*  THE SYSUT2 BLKSIZE AND LRECL IS DEPENDENT ON SYSUT1 AND THE RECFM'S* 15975013
*  INPUT        OUTPUT    OUTPUT BLOCK                                * 15982013
*1 F OR FB      F OR FB     MULTIPLE OF LRECL AND LRECL'S EQUAL       * 15989013
*2 F OR FB        U        EQUAL OR GREATER THAN LRECL                * 15996013
*3 F OR FB        V        EQUAL OR GREATER THAN LRECL PLUS 4         * 16003013
*4 F OR FB        VB       EQUAL OR GREATER THAN LRECL PLUS 8         * 16010013
*5 U,V,UB       F OR FB    ILLEGAL                                    * 16017013
*6  U             U        EQUAL OR GREATER THAN INPUT BLKSIZE        * 16024013
*7  V             V              SAME AS ABOVE                        * 16031013
*   VB            VB             SAME AS ABOVE                        * 16038013
*7  U             V        EQUAL OR GREATER THAN INPUT BLK PLUS 4     * 16045013
*8  U             VB       EQUAL OR GREATER THAN INPUT BLK PLUS 8     * 16052013
*9  V             U        EQUAL OR GREATER THAN INPUT BLK MINUS 4    * 16059013
*A  V             VB       EQUAL OR GREATER THAN INPUT BLK PLUS 4     * 16066013
*B  VB            U        EQUAL OR GREATER THAN INPUT BLK MINUS 8    * 16073013
*C  VB            V        EQUAL OR GREATER THAN INPUT BLK MINUS 4    * 16080013
HINTB    DC    3F'0'                   INPUT BUFFER- WORK AREA     6598 16440013
HKEYL    EQU   HINTB                                                    16460000
HBLIN    EQU   HINTB+4                                                  16480000
HRLIN    EQU   HINTB+8                                                  16500000
HINORG   EQU   HINTB+10                                                 16520000
HOUTB    DC    3F'0'                    OUTPUT BUFFER- WORK AREA        16540000
HKEYLOU  EQU   HOUTB                                                    16560000
HBLOU    EQU   HOUTB+4                                                  16580000
HRLOU    EQU   HOUTB+8                                                  16600000
HOUORG   EQU   HOUTB+10                                                 16620000
HPOID    EQU   HOUTB+11                                                 16640000
*                                                                       16660000
HGENPRS  DS    18F                      WORK AREA                       16680000
HSAVE13  DS    2F                      REG 13 ,14 SAVE AREA      A22671 16700018
HSAVE14  DS    1F                       REG 14 SAVE AREA                16720000
HSTOWAR  DS    3F                                                       16740000
ACINAREA DS    1F            ACTUAL INP. BUFF ADDRESS            A36114 16750021
HIN1AD   DS    1F                       SYSUT1 BUFF1 ADDR SAVE AREA     16760000
HIN2AD   DS    1F                       SYSUT1 BUFF2 ADDR SAVE AREA     16780000
HOU1AD   DS    1F                       SYSUT2 BUFF1 ADDR SAVE AREA     16800000
HOU2AD   DS    1F                       SYSUT2 BUFF2 ADDR SAVE AREA     16820000
HEDSV    DS    1F                                                       16840000
HIXIN    DS    1F                                                       16860000
HIXOUT   DS    1F                                                       16880000
HBLOUAC  DS    1F                                                       16900000
HWK4     DC    F'0'                                                     16920000
HRDTSAV  DC    F'0'                                                     16940000
HRLPRE   DS    1H                                                       16960000
HWK2     DS    1H                                                       16980000
LRECLINP DS    1H                      INITIAL INP. LRECL        A45145 16990021
HKEYA    DS    1F                                                       17000000
LABPOLAT DS    2F                      LABEL POOL ADDRESSES             17006017
TOTLAREA DC    4F'0'                   TOTALING PARM LIST          UL0I 17012018
SAVER01  DC    2F'0'                                               UL0I 17018018
SYNADSAV DS    4F                      AREA TO SAVE REGS IN SYNADA22671 17022018
HEXITTA  DS    1F                       USER EXIT TABLE ADDR LOC   UL0H 17026017
HMDTCUR  DS    1F                                                       17040000
HEDCUR   DS    1F                                                       17060000
HRDTCUR  DS    1F                                                       17080000
HLITTA   DS    1F                                                       17100000
HCOPYSW  DS    0C                       COPY SWITCH                     17120000
HEODSW   DS    1C                       END OF DATA SWITCH              17140000
         EXTRN HDCBOUT                                                  17140317
         EXTRN HDCBIN                                                   17140617
HDCBOUTA DC    V(HDCBOUT)                                               17140917
VADDR3   DC    V(HMSGRETC)                                              17141217
HDCBINA  DC    V(HDCBIN)                                                17141517
ADTOTEXR DC    F'0'                                                     17141817
SIXTEEN  DC    H'16'                                                    17142117
FOUR     DC    H'4'                                                     17142417
EIGHT    DC    H'8'                                                     17142717
R14SAVE  DS    2F                                                       17143017
TOTLEXSW DC    X'00'                                                    17143317
LABPROSW DS    1C                      LABEL PROCESSING SWITCH          17143617
KEYOUTSW DC    X'00'                    ATTRIBUTE SWITCH           6598 17144013
THREE    DC    H'3'                     CONSTANT                   6598 17148013
RECFMSW  DC    X'00'                                               6598 17152013
HSTOWSW  DC    X'00'                    STOW SWITCH                     17160000
HRIDSW   DC    X'00'                                                    17180000
HTERMSW  DC    X'00'                    TERMINATION SWITCH              17200000
HEODAD   DC    A(HEOD)                                                  17210017
HINERAD  DC    A(HINER)                                           M2461 17213018
HOUERAD  DC    A(HOUER)                                           M2461 17216018
HWRMSGA  DC    V(HWRMSG)                MSG WRITER SUBR ADDR LOC        17220000
HCDWRA   DC    V(HCDWR)                 ALT ENTRY PT TO MSG WTR    7653 17230017
HCONCODE DC    H'0'                     CONDITION CODE SAVE AREA        17240000
HH0      DC    H'0'                                                     17260000
HH2      DC    H'2'                                                     17280000
HH4      DC    H'4'                                                     17300000
HH2000   DC    H'2000'                                         @ZA24341 17310000
TOTEDIT  DC    H'0'                                                     17320000
HALFWORK DS    1H                                                       17340000
SIXSV    DS    1F                       REG6 SAVE AREA                  17360000
REGSAV   DC    F'0'                SAVES LENGTH FOR BUFFER FREEMAIN3599 17380015
AST       DC   C'****'                                                  17400000
HCOPYMSK EQU   X'F0'                    COPY MASK                       17420000
HEODMSK  EQU   X'0F'                    END OF DATA MASK                17440000
HPTRMSK  EQU   X'00'                                                    17460000
BLANKS   DC    X'4040'                                                  17480000
CPYSWSAV DC    X'00'                                                    17500000
TYPMSG   DC    X'00'                                                    17520000
IOERREXI DC    X'00'              IOERROR EXIT BYTE              A48809 17530021
CHECKINP DC    X'00'               INPUT CHECK TESTBYTE          A50939 17533021
CHECKOUT DC    X'00'               OUTPUT CHECK TESTBYTE         A50939 17536021
HRIDL    EQU   0                                                        17540000
HRIDST   EQU   2                                                        17560000
HRID     EQU   4                                                        17570017
REDANY   DC    X'FF'    IF ANY RCDS IN SYSUT1 DATASET-TURN SW OFF  6291 17580017
HMEMBYT  EQU   0                                                        17600000
HMSGIIP  EQU   1                        MESSAGE CODES                   17620000
HMSGECC  EQU   2                                                        17640000
HMSGBNA  EQU   4                                                        17660000
HMSGTLR  EQU   5                                                        17680000
HMSGTKR  EQU   6                                                        17700000
HMSGTDR  EQU   7                                                        17720000
HMSGTER  EQU   8                                                        17740000
HMSGERS  EQU   9                                                        17760000
HMSGUOE  EQU   10                                                       17780000
HMSGUIE  EQU   11                                                       17800000
HMSGDCB  EQU   12                                                  6598 17810013
HMSGPELR EQU   13                                                       17820000
HMSGPEOD EQU   14                                                       17840000
HMSGBLK1 EQU   17                      NO INPUT BLKSIZE SPECIFIED 10696 17846014
HMSGBLK2 EQU   18                      NO OUTPUT BLKSIZE SPECIFIED10696 17852014
HINDD    EQU   24                                                       17860000
HOUDD    EQU   32                                                       17880000
         ENTRY HGENP                                                    17900000
         DCBD  DSORG=PS                                                 17920000
DDNAM    EQU   DCBDDNAM-IHADCB                                          17940000
OFLGS    EQU   DCBOFLGS-IHADCB                                          17960000
DSORG    EQU   DCBDSORG-IHADCB                                          17980000
BLKSI    EQU   DCBBLKSI-IHADCB                                          18000000
KEYLE    EQU   DCBKEYLE-IHADCB                                          18020000
BUFL     EQU   DCBBUFL-IHADCB                                           18040000
RECFM    EQU   DCBRECFM-IHADCB                                          18060000
LRECL    EQU   DCBLRECL-IHADCB                                          18080000
EODADOFS EQU   DCBEODAD+1-IHADCB                                        18086017
SYNADOFS EQU   DCBSYNAD-IHADCB                                          18092017
         END                                                            18100000
./  ADD  SSI=71290012,NAME=IEBGMESG
 TITLE  'IEBGMESG-IEBGENER MESSAGE MODULE'                        10696 00020014
*                                                                       00040000
* THIS MODULE CONTAINS ALL OF THE ERROR MESSAGES FOR THE GENERATE       00060000
* UTILITY AS WELL AS THE HEADER FOR SYSPRINT.                           00080000
*                                                                       00100000
IEBGMESG CSECT                                                          00120000
*2221                                                              000H 00130017
*                                                                A27717 00135019
*A008760                                                         A36140 00135421
*C007800,007900,008720                                           A36140 00137021
*C008000                                                         A45131 00138021
*A005598,009390,009394                                           A48786 00138421
*C009300                                                       @ZA06544 00138800
*                                                                       00140000
*        POINTERS                                                       00160000
         ENTRY DDERROR1                                                 00180000
*                                                                       00200000
HMSGMDL  DC    A(HMSGHDR)               00   HEADER                     00220000
         DC    A(HMSGIIP)               01                              00240000
         DC    A(HMSGECC)               02                              00260000
         DC    A(HMSGUSE)               03                              00280000
         DC    A(HMSGBNA)               04                              00300000
         DC    A(HMSGTLR)               05                              00320000
         DC    A(HMSGTKR)               06                              00340000
         DC    A(HMSGTDR)               07                              00360000
         DC    A(HMSGTER)               08                              00380000
         DC    A(HMSGERS)               09                              00400000
         DC    A(HMSGUOE)               10                              00420000
         DC    A(HMSGUIE)               11                              00440000
         DC    A(HMSGDCB)              12                          6598 00460013
         DC    A(HMSGPELR)              13                              00480000
         DC    A(HMSGPEOD)              14                              00500000
         DC    A(DDERROR1)              15                              00520000
         DC    A(0)                     16   NOT USED             10696 00525014
         DC    A(HMSGBLK1)              17   NO INPUT BLKSIZE     10696 00530014
         DC    A(HMSGBLK2)              18   NO OUTPUT BLKSIZE    10696 00535014
         DC    A(HMSGBLK3)              19  INVALID SYSIN BLKSIZE  BS0H 00536017
         DC    A(HMSKEYOT)             20                          VS0H 00536617
         DC    A(HMSKEYIN)             21                          VS0H 00537217
         DC    A(HMSDELTR)             22                          UL0H 00537517
         DC    A(HMSONLY)              23                          UL0H 00537817
         DC    A(HMSGEXIT)             24                          UL0H 00538117
         DC    A(HMSGRETC)             25                          UL0H 00538417
         DC    A(HMSGIOER)             26                          UL0H 00538717
         DC    A(HMSGKEYX)             27                          VS0H 00538917
         DC    A(HMSLRL)               28                          VS0H 00539117
         DC    A(SYSUT2VS)             29                          VS0H 00539317
         DC    A(HMTOTTER)             30                          UL0H 00543317
         DC    A(HMENDDAT)             31                          UL0H 00547317
         DC    A(HMSTOPEX)             32                          UL0H 00551317
         DC    A(HMSRLER)              33                          UL0H 00555317
         DC    A(HMSEDIGN)             34                          VS0H 00557317
         DC    A(HMSGCOM1)               35                        SA0I 00557418
         DC    A(HMSGKEY1)               36                        SA0I 00557518
         DC    A(HMSGPAR1)               37                        SA0I 00557618
         DC    A(HMSGCOM2)               38                        SA0I 00557718
         DC    A(HMSGKEY2)               39                        SA0I 00557818
         DC    A(HMSGPAR2)               40                        SA0I 00557918
         DC    A(HMSGCTRA)               41                        SA0I 00558018
         DC    A(HMSGEXC)                42                        SA0I 00558118
         DC    A(HMSGNAM)                43                        SA0I 00558218
         DC    A(HMSGCONT)               44                        8035 00558318
         DC    A(HMSGPARN)               45                        SA0I 00558418
         DC    A(HMSGDUP)                46                        SA0I 00558518
         DC    A(HMSGMEM)                47                        SA0I 00558618
         DC    A(HMSGINC)                48                        SA0I 00558718
         DC    A(HMSGLIT)                49                        SA0I 00558818
         DC    A(SYNADMSG)             50                        A27717 00559419
         DC    A(HMSEQDCB)             51 MSG IEB352I            A48786 00559821
*        MESSAGES                                                       00560000
*                                                                       00580000
HMSGHDR   DC   CL32'DATA SET UTILITY - GENERATE'                        00600000
         DC    CL8' '                                                   00620000
HMSGIIP  DC    CL62'INVALID PARAMETER LIST'                        6598 00630017
HMSGECC   DC   CL62'INVALID CONTROL STATEMENT'                          00640017
HMSGUSE   DC   CL62'CONTROL STATEMENT INPUT ERROR'                      00650017
HMSGBNA   DC   CL62'SPACE NOT AVAILABLE'                                00660017
HMSGTLR   DC   CL62'JOB TERMINATED AFTER LABEL EXIT'                    00670017
HMSGTKR   DC   CL62'JOB TERMINATED AFTER KEY EXIT'                      00680017
HMSGTDR   DC   CL62'JOB TERMINATED AFTER DATA EXIT'                     00690017
HMSGTER   DC   CL62'JOB TERMINATED AFTER ERROR EXIT'                    00700017
HMSGERS  DC    CL62'STOW ERROR IN OUTPUT DATA SET'                 6598 00710017
HMSGUOE   DC   CL62'PERMANENT OUTPUT ERROR'                             00720017
HMSGUIE   DC   CL62'PERMANENT INPUT ERROR'                              00730017
HMSGDCB  DC    CL62'CONFLICTING DCB PARAMETERS'                    6598 00740017
HMSGPELR DC    CL62'PROCESSING ENDED AT LAST REC ID'                    00750017
HMSGPEOD DC    CL62'PROCESSING ENDED AT EOD'                            00760017
DDERROR1 DC    CL62'DDNAME          CANNOT BE OPENED'                   00770017
HMSGBLK1 DC    CL62'JOB TERMINATED,NO INPUT BLKSIZE/LRECL'       A36140 00780021
HMSGBLK2 DC    CL62'JOB TERMINATED,NO OUTPUT BLKSIZE/LRECL'      A36140 00790021
HMSGBLK3 DC    CL62'INVALID SYSPRINT/SYSIN BLOCKSIZE' MSG IEB319 A45131 00800021
HMSKEYOT DC   CL62'OUTPUT DATA SET WITH KEYS IN VS/VBS PROCESSING' VS0H 00806017
HMSKEYIN DC    CL62'INPUT DATA SET WITH KEYS IN VS/VBS PROCESSING' VS0H 00812017
HMSDELTR DC    CL45'JOB TERMINATED AFTER OPENING OUTPUT DATA SET ' UL0H 00818017
         DC    CL17'UPON USER REQUEST'                             UL0H 00824017
HMSONLY  DC    CL62'JOB TERMINATED AFTER HEADER LABEL PROCESSING'  UL0H 00830017
HMSGEXIT DC    CL62'  TIMES TO                EXIT ROUTINE'        UL0H 00836017
HMSGRETC DC    CL62'LAST RETURN CODE WAS          '                UL0H 00842017
HMSGIOER DC    CL62'               LABEL GAVE I/O ERROR'           UL0H 00848017
HMSGKEYX DC    CL62'SPECIFIED KEY EXITS ARE NOT TAKEN'             VS0H 00854017
HMSLRL   DC    CL45'LRECL EXCEEDS 32K , STRAIGHT COPY NOT SPECIFI' VS0H 00860017
         DC    CL17'ED'                                            VS0H 00866017
SYSUT2VS DC    CL27'PDS NOT ALLOWED WHEN INPUT/' MSG IEB329I     A36140 00872021
         DC    CL35'OUTPUT DATA SET HAS RECFM=VS/VBS'            A36140 00876021
HMTOTTER DC    CL62'TOTALING EXIT REQUESTS TERMINATION '           UL0H 00878017
HMENDDAT DC    CL62'PROCESSING ENDS UPON REQUEST OF TOTALING EXIT' UL0H 00884017
HMSTOPEX DC   CL62'TOTALING EXIT DEACTIVATED UPON ITS OWN REQUEST' UL0H 00890017
HMSRLER  DC    CL62'RECORD LABELS=N STATEMENTS ARE REQUIRED'       UL0H 00896017
HMSEDIGN DC    CL62'NO EDITING OR CONVERSION WILL BE DONE'         VS0H 00902017
         ENTRY HMSGEXIT                                            UL0H 00919117
         ENTRY HMSGRETC                                            UL0H 00919317
         ENTRY HMSGIOER                                            UL0H 00919517
         ENTRY HMSGMDL                                                  00920000
         ENTRY SYNADMSG                                          A27717 00920519
HMSGCOM1 DC    CL62'      INVALID COMMAND IN COL.   '              SA0I 00921018
HMSGKEY1 DC    CL62'      INVALID KEYWORD IN COL.   '              SA0I 00922018
HMSGPAR1 DC    CL62'    INVALID PARAMETER IN COL.   '              SA0I 00923018
HMSGCOM2 DC    CL62'COMMAND MISSING PRECEDING COL.  '              SA0I 00924018
HMSGKEY2 DC    CL62'KEYWORD MISSING PRECEDING COL.  '              SA0I 00925018
HMSGPAR2 DC    CL62'PARAMETER MISSING BEFORE COL.   '              SA0I 00926018
HMSGCTRA DC    CL62'INVALID SPACE ALLOCATION'                      SA0I 00927018
HMSGEXC  DC    CL62'ALLOWED NO. OF CARDS EXCEEDED   '              SA0I 00928018
HMSGNAM  DC    CL62'WARNING-  INVALID STATEMENT LABEL'             SA0I 00929018
HMSGCONT DC    CL62'CONTINUATION NOT STARTED IN 4-16'          @ZA06544 00930000
HMSGPARN DC    CL62'MISSING PARENTHESIS'                           SA0I 00931018
HMSGDUP  DC    CL62'DUPLICATE KEYWORD'                             SA0I 00932018
HMSGMEM  DC    CL62'PRECEDING MEMBER REQUIRES "IDENT"'             SA0I 00933018
HMSGINC  DC    CL62'INCONSISTENT PARAMETERS IN FIELD OR IDENT'     SA0I 00934018
HMSGLIT  DC    CL62'LITERAL LENGTH EXCEEDS 40'                     SA0I 00935018
SYNADMSG DC    CL89'I/O ERROR (SYNADAF INFORMATION)'             A27717 00937019
HMSEQDCB DC    CL37'WARNING : OUTPUT RECFM/LRECL/BLKSIZE '       A48786 00939021
         DC    CL25'COPIED FROM INPUT'   MSG IEB352I             A48786 00939421
         END                                                            00940000
./  ADD  SSI=80130011,NAME=IEBGSCAN
*********************************************************************** 00020000
*                                                                     * 00040000
*                    * * * I E B G S C A N * * *                      * 00060000
*                                                                     * 00080000
*                         * * * * * * * * *                           * 00100000
*                                                                     * 00120000
*      THIS SUBROUTINE IS EXECUTED IN CONJUNCTION  WITH THE  CARD     * 00140000
*      SCAN ROUTINE I E B C C S 0 2. IT ANALYZES PARAMETERS WHICH     * 00160000
*      ARE PASSED BY THE SCAN ROUTINE, DIAGNOSES INVALID PARAMET-     * 00180000
*      ERS, SETS SWITCHES AND CREATES TABLES TO BE  USED  BY  THE     * 00200000
*      PROCESSING ROUTINE I E B G E N 0 3.                            * 00220000
*                                                                     * 00240000
*                         * * * * * * * * *                           * 00260000
*                                                                     * 00280000
*                             E N T R Y                               * 00300000
*                                                                     * 00320000
*      THIS ROUTINE HAS EXTERNALLY REFERENCABLE VALUES  OR  NAMES     * 00340000
*      WHOSE SYMBOLS AND FUNCTIONS ARE:                               * 00360000
*                                                                     * 00380000
*                               C C A                                 * 00400000
*                                                                     * 00420000
*              THE COMMON ENTRY POINT TO THE PROGRAM TO               * 00440000
*              BE USED IN A C A L L.                                  * 00460000
*                                                                     * 00480000
*                             D D R T N                               * 00500000
*                                                                     * 00520000
*              THE ENTRY POINT TO A CLOSED SUBROUTINE WHOSE FUNC-     * 00540000
*              TION IS THE PRINTING OF A DIAGNOSTIC MESSAGE:          * 00560000
*                      'DDNAME      CANNOT BE OPENED'                 * 00580000
*                                                                     * 00600000
*                          B L K R T N                           * BS0H 00603017
*                                                                * BS0H 00606017
*              THE ENTRY POINT TO A SUBROUTINE WHOSE FUNCTION IS * BS0H 00609017
*              THE PRINTING OF A DIAGNOSTIC MESSAGE              * BS0H 00612017
*                      'INVALID SYSIN BLOCKSIZE'                 * BS0H 00615017
*                         * * * * * * * * *                           * 00620000
*                                                                     * 00640000
*                             I N P U T                               * 00660000
*                                                                     * 00680000
*      INPUT TO THIS ROUTINE IS PROVIDED BY THE CARD SCAN ROUTINE     * 00700000
*      ONE CARD FIELD AT A TIME. THE ADDRESS OF A WORK AREA WHICH     * 00720000
*      CONTAINS SWITCHES SET BY THE CARD  SCAN  ROUTINE  AND  THE     * 00740000
*      PARAMETER TO BE ANALYZED IS PASSED IN A LIST POINTED TO BY     * 00760000
*      GP REGISTER 1.                                                 * 00780000
*                                                                     * 00800000
*********************************************************************** 00820000
         EJECT                                                          00840000
*********************************************************************** 00860000
*                                                                     * 00880000
*                            O U T P U T                              * 00900000
*                                                                     * 00920000
*      THE OUTPUT FROM THIS ROUTINE IS  A  GROUP  OF  TABLES  AND     * 00940000
*      SWITCHES, THE ADDRESSES OF WHICH ARE CONTAINED IN  A  LIST     * 00960000
*      POINTED TO BY GP REGISTER 1 AT EXIT TIME. THESE TABLES AND     * 00980000
*      SWITCHES PROVIDE THE PROCESSING ROUTINE OF  THE   GENERATE     * 01000000
*      UTILITY WITH THE PARAMETERS SPECIFIED IN THE UTILITY  CON-     * 01020000
*      TROL CARDS IN A USABLE FORMAT.                                 * 01040000
*                                                                     * 01060000
*                         * * * * * * * * *                           * 01080000
*                                                                     * 01100000
*                             E X T R N                               * 01120000
*                                                                     * 01140000
*      THE SUBROUTINE REFERENCES THESE EXTERNALLY DEFINED  VALUES     * 01160000
*      OR SUBROUTINE NAMES:                                           * 01180000
*                            A C T C C S                              * 01200000
*                                                                     * 01220000
*              THE ENTRY POINT OF THE CARD SCAN ROUTINE               * 01240000
*                                                                     * 01260000
*                            H W R M S G                              * 01280000
*                                                                     * 01300000
*              ENTRY TO SUBROUTINE USED BY THIS ROUTINE               * 01320000
*              TO WRITE MESSAGES ON THE DEVICE  DEFINED               * 01340000
*              BY DDNAME S Y S P R I N T.                             * 01360000
*                                                                     * 01380000
*                             H C D W R                               * 01400000
*                                                                     * 01420000
*              ENTRY TO SUBROUTINE USED BY THIS ROUTINE               * 01440000
*              TO WRITE CONTROL CARD IMAGES  ON  DEVICE               * 01460000
*              DEFINED BY DDNAME S Y S P R I N T.                     * 01480000
*                                                                     * 01500000
*                          GENLABEL                              * UL0H 01502017
*                                                                * UL0H 01504017
*             THIS IS A SWITCH IN IEBCCS02,WHICH IS SET          * UL0H 01506017
*             BY IEBGSCAN,AS SOON AS IT IS DETERMINED THAT       * UL0H 01508017
*             THE NEXT CARD FROM SYSIN IS A LABEL DATA CARD,     * UL0H 01510017
*             AND DOES NOT NEED TO BE SCANNED.                   * UL0H 01512017
*             THIS SWITCH IS RESET WHEN RESUMING OF SCANNING     * UL0H 01514017
*             IS REQUIRED.                                       * UL0H 01516017
*                                                                * UL0H 01518017
*********************************************************************** 01520000
         EJECT                                                          01540000
*********************************************************************** 01560000
*                                                                     * 01580000
*                   E R R O R   C O N D I T I O N                     * 01600000
*                                                                     * 01620000
*      THE SUBROUTINE WILL TERMINATE PROCESSING, CAUSE AN APPROP-     * 01640000
*      RIATE DIAGNOSTIC MESSAGE TO BE PRINTED AND RETURN VIA REG-     * 01660000
*      ISTER 12 UPON ALL SUBSEQUENT ENTRIES UPON  RECOGNITION  OF     * 01680000
*      THE FOLLOWING TYPES OF ERROR:                                  * 01700000
*                                                                     * 01720000
*              1.PERMANENT I/O ERROR   READING  CONTROL               * 01740000
*                STATEMENTS.                                          * 01760000
*      UPON RECOGNITION OF AN ERROR IN A CONTROL STATEMENT, AN    *SA0I 01770018
*      EXPLANATORY ERROR MESSAGE IS PRINTED IMMEDIATELY FOLLOWING *SA0I 01780018
*      THE CARD CONTAINING THE ERROR.  PROCESSING IS TERMINATED   *SA0I 01790018
*      WHEN ALL CARDS HAVE BEEN SCANNED FOR ERRORS.               *SA0I 01800018
*                                                                     * 01840000
*                         * * * * * * * * *                           * 01860000
*                                                                     * 01880000
*                     FUNCTION/OPERATION                         * UL0H 01881017
*                                                                * UL0H 01882017
*             IEBGSCAN REQUIRES A RECORD STATEMENT INDICATING    * UL0H 01883017
*             THAT LABEL INFORMATION IS FOLLOWING IN SYSIN,      * UL0H 01884017
*             IT CHECK WHETHER THIS STATEMENT APPEARS LEGALLY    * UL0H 01885017
*             AND THEN IT GETS A SAVE AREA FOR AS MANY LABELS AS * UL0H 01886017
*             INDICATED IN THE RECORD STATEMENT,AND IT SETS THE  * UL0H 01887017
*             GENLABEL SWITCH IN CCS02.                          * UL0H 01888017
*             AFTER ALL LABELS ARE READ GENLABEL IS RESET        * UL0H 01889017
*                                                                * UL0H 01890017
*                     * * * * * * * * *                          * UL0H 01891017
*                             N O T E S                               * 01900000
*                                                                     * 01920000
*      THIS SUBROUTINE IS 'ONLY LOADABLE'.IT IS NOT RE-ENTRANT.IT     * 01940000
*      NOT RE-USABLE.                                                 * 01960000
*                                                                     * 01980000
*********************************************************************** 02000000
         EJECT                                                          02020000
IEBGSCAN CSECT                                                          02040000
*1825018810-018910,024800,038800,054200,056440-056480,074300,089400UL0H 02042017
*1725124000                                                        BSOH 02045017
*1725086800                                                        9430 02048017
*0871022800-023200,028200-028800,029000,030600,032600-033000,034400SA0I 02048118
*035200,036400-037000,037800,038400,039200,039700-039820,039910,   SA0I 02048218
*042600-042800,043800-044000,045000-045200,045800-046200,047400-   SA0I 02048318
*047600,048600-048800,049800-050000,051000-051200,052200-052400,   SA0I 02048418
*053400-053600,054360,054600-054840,055400-055800,056640-056680,   SA0I 02048518
*057200-057600,058800,059200,060600,061000-062600,063400,064000,   SA0I 02048618
*065200,065640-065700,067000,069000,071400,072800,074400,074600-   SA0I 02048718
*074800,076400,077350,078480,081400,082000,083400,083800-084000,   SA0I 02048818
*084800,087200,090200-091000,091800,092200,093200-094000,094600,   SA0I 02048918
*095000,095600,096200-096600,101600-101800,102800,104200-104800,   SA0I 02049018
*105600-107800,109000,109800-110200,111000-111900,112350,112390,   SA0I 02049118
*112450,112510,112570,112610-112630,112670,112700-112710,112780,   SA0I 02049218
*112820-112860,112900-112920,113070-113080,118280,119000-121000,   SA0I 02049318
*124900                                                            SA0I 02049418
*0871059400-059600                                                 0492 02050218
*                                                                A36072 02050321
*                                                                A36129 02050421
* 098100,110950                                                   M0171 02050618
*                                                                A27695 02050719
*                                                                A27717 02050819
*                                                                A28288 02050919
*A066900,068900,071300,072700                                    A41800 02052221
*D067120,069120,071520,072920                                    A41800 02052321
*A125160,125180,139440-139560                                    A45131 02052821
*C125230                                                         A45131 02053221
*D128800-129400                                                  A45131 02053321
*A103920,103940                                                 YA01701 02053402
*C103830                                                        YA01701 02053502
*C058700                                                        YA01699 02053602
*A039602,071700,117902-117916                                   YA01703 02054002
*C117920                                                        YA01703 02054402
*C140600                                              VS08565 = OZ00131 02054502
*A125700-125760                                                @ZA01696 02054603
*C125800                                                       @ZA01696 02054703
*D104450-104550                                                @ZA07330 02056600
*A119260                                                       @ZA28787 02057699
*C063400                                                       @ZA28787 02058699
* REGISTER ASSIGNMENTS                                             BS0H 02060102
R0       EQU   0                                                        02062021
R1       EQU   1                                                        02063921
R2       EQU   2                                                        02065821
R3       EQU   3                                                        02067721
R4       EQU   4                                                        02069621
R5       EQU   5                                                        02071521
R6       EQU   6                                                        02073421
R7       EQU   7                                                        02075321
R8       EQU   8                                                        02077221
R9       EQU   9                                                        02079121
R10      EQU   10                                                       02081021
R11      EQU   11                                                       02082921
R12      EQU   12                                                       02084821
R13      EQU   13                                                       02086721
R14      EQU   14                                                       02088621
R15      EQU   15                                                       02090521
RETREG   EQU   14                                                  BS0H 02092421
GOREG    EQU   15                                                  BS0H 02094321
CCA      SAVE  (14,12),T,IEBGSCAN-OZ28787                      @ZA28787 02096299
         ENTRY CCA                                                      02098100
         TM    0(R1),X'80'              DD PARAMETER PRESENT?           02100000
         BCR   1,R14                    NO, EXIT                        02120000
         LR    R2,R15                   YES,INITIALIZE BASE REG 2       02140000
         USING CCA,R2                                                   02160000
         STM   R13,R14,CSAVE13          SAVE REGS 13-14                 02180000
         L     R1,0(R1)                 GET SYSIN DD NAME ADDR          02200000
         MVC   CSIDDA(8),0(R1)          SAVE SYSIN DD NAME              02220000
         LA    R13,CREGSAVE             LOAD REG SAVE ARE ADDR          02240000
         LA    R12,CSCAN                LOAD SCAN SUBROUTINE ADDR       02260000
         LA    R10,CCNVRT               LOAD CONVERSION SUBROUTINE ADDR 02300000
         NI    CERRSW,X'0F'             RESET CODING SWITCHES      SA0I 02320018
         OI    CCOMM1+1,X'F0'                                           02340000
         OI    CCOMM3+1,X'F0'                                           02360000
         OI    CCOMM5+1,X'F0'                                           02380000
     OI   CKEYWD0+1,X'F0'                                               02400000
         OI    CPARAC1+1,X'F0'                                          02420000
         XC    CCOMMSW(5),CCOMMSW       RESET ITEM SWITCHES             02440000
         MVC   CPX(2),CH1               RESET P(X)                      02460000
         MVC   HEXITT(64),HEXITT-1     BLANK OUT EXIT TABLE        UL0H 02480017
       XC   HMDTAD(19),HMDTAD    ZERO OUT SWITCHES                      02500000
         SR    R4,R4                    ZERO OUT TABLE XRS              02520000
         SR    R5,R5                                                    02540000
         LA    R6,HEDCBAD                                               02560000
         SR    R7,R7                                                    02580000
         MVI   CWORK,X'00'                                              02600000
CSCAN    CALL  ACTCCS,(CWORK,CSIDDA)    CALL CONTROL CARD SCANNER SUBRT 02620000
         CLI   CWRSW,X'02'              IO ERROR?                       02640000
         BE    CIPERR                   YES                             02660000
         CLI   CWRSW,X'01'              NO,NEW CARD?                    02680000
         BNE   CTEST                    NO                              02700000
         STM   R0,R1,CSAVE1             SAVE  REGS 0-1                  02720000
         LA    R1,CWORK+1               YES,WRITE CARD ON SYSPRINT      02740000
         L     R15,CCDWRA               LOAD CTRL CARD WRITER SUBR ADDR 02760000
         BALR  R14,R15                                                  02780000
         LM    R0,R1,CSAVE1             RESTORE  REGS 0-1               02800000
*                                                                 *SA0I 02820018
*                  ANALYSIS OF ERROR BITS SET BY CCS02            *SA0I 02840018
*                                                                 *SA0I 02860018
CTEST    TM    CWORK,X'80'              ERROR                      SA0I 02880018
         BO    CA                       YES,DETERMINE ERROR        SA0I 02884018
         TM    CWORK,X'40'              BYPASS SWITCH ON           SA0I 02888018
         BO    MOREPARM                 YES,TEST FOR MORE          SA0I 02892018
*                                       PARAMETERS                 SA0I 02896018
         TM    CWORK,X'20'              EOF SWITCH ON              SA0I 02900018
         BO    CEOF                     YES,EOF                    SA0I 02904018
CLAB     TM    LABINPUT,X'80'           LABEL GENERATION           SA0I 02908018
         BO    LABGENER                 YES,BRANCH                 SA0I 02912018
         TM    CWORK,X'08'              NO,COMMAND?                     02920000
         BO    CCOMM                    YES                             02940000
         TM    CWORK,X'04'              NO,KEYWORD?                     02960000
         BO    CKEYW                    YES                             02980000
         TM    CWORK,X'02'              NO,PARAMETER?                   03000000
         BO    CPARA                    YES                             03020000
         BR    R12                      NO,SCAN FURTHER                 03040000
MOREPARM TM    CWORK,X'01'              END OF PARAMETERS          SA0I 03041018
         BO    CLAB                     YES,ANALYZE                SA0I 03042018
         BR    R12                      NO,SCAN FURTHER            SA0I 03043018
CA       TM    CWORK+130,X'02'          ARE PARENTHESES CLOSED     SA0I 03044018
         BO    CODE46                   NO,WRITE ERROR MSG 46      SA0I 03045018
         TM    CWORK,X'08'              IS COMMAND SWITCH ON       SA0I 03046018
         BZ    CB                       NO,BRANCH                  SA0I 03047018
         TM    CWORK,X'06'              IS KEYWORD OR PARAMETER    SA0I 03048018
*                                       SWITCH ON                  SA0I 03049018
         BC    5,CODE39                 YES,WRITE ERROR MSG 39     SA0I 03050018
         B     CODE36                   WRITE ERROR MSG 36         SA0I 03051018
CB       TM    CWORK,X'04'              IS KEYWORD SWITCH ON       SA0I 03052018
         BC    5,CODE37                 WRITE ERROR MSG 37 IF YES  SA0I 03053018
         TM    CWORK,X'02'              IS PARAMETER SWITCH ON     SA0I 03054018
         BC    5,CODE38                 WRITE ERROR MSG 38 IF YES  SA0I 03055018
         TM    CWORK+81,X'02'           IS KEYWORD REQUIRED        SA0I 03056018
*                                       SWITCH ON                  SA0I 03057018
         BC    5,CODE40                 WRITE ERROR MSG 40 IF YES  SA0I 03058018
         TM    CWORK+81,X'01'           IS PARAMETER REQ SWITCH ON SA0I 03059018
         BC    5,CODE41                 WRITE ERROR MSG 41 IF YES  SA0I 03060018
         TM    CWORK,X'40'              BYPASS SWITCH ON           SA0I 03061018
         BZ    CODE44                   NO,WRITE ERROR MSG 44      SA0I 03062018
         B     CODE45                   WRITE ERROR MSG 45         SA0I 03063018
*                                                                  SA0I 03064018
*                                                                 *SA0I 03065018
*                         ANALYSIS OF COMMANDS                    *SA0I 03066018
*                                                                 *SA0I 03067018
CCOMM    TM    CCOMMSW,X'10'            RECORD SWITCH SET?              03080000
         BZ    CCOMM2                                                   03100000
CCOMM1   B     CCOMM2                   FIRST-TIME SWITCH               03120000
         OI    0(R6),X'80'              SET LST-FLD BIT IN PREC EDCB    03140000
CCOMM2   NI    CCOMM1+1,X'0F'           TURN OFF SWITCH                 03160000
         NI    CCOMMSW,X'00'            TURN OFF COMMAND SWITCHES       03180000
         CLC   0(8,R1),CCGENERA         COMMAND=GENERATE?               03200000
         BNE   CCOMM5                   NO                              03220000
         CH    R0,CH8                                                   03240000
         BC    8,CCOMM3                 YES,BRANCH                 SA0I 03250018
         B     CODE36                   WRITE ERROR MSG 36         SA0I 03260018
CCOMM3   B     CCOMM4                   FIRST-TIME SWITCH          SA0I 03270018
         B     CODE36                   WRITE ERROR MSG 36         SA0I 03280018
CCOMM4   NI    CCOMM3+1,X'0F'           TURN OFF SWITCH                 03320000
         NI    CCOMM5+1,X'0F'           TURN OFF SWITCH                 03340000
         OI    CCOMMSW,X'80'            SET GENERATE SWITCH             03360000
         BR    R12                      SCAN FURTHER                    03380000
CCOMM5   B     CCOMM6                   FIRST TIME SWITCH               03400000
         B     CCOMM7                                                   03420000
CCOMM6   B     CODE36                   WRITE ERROR MSG 36         SA0I 03440018
CCOMM7   CLC   0(5,R1),CCEXITS          COMMAND=EXITS?                  03460000
         BNE   CCOMM8                   NO                              03480000
         CH    R0,CH5                                                   03500000
         BC    7,CODE36                 BRANCH IF NOT 5            SA0I 03520018
         OI    CCOMMSW,X'40'            YES,SET EXITS SWITCH            03540000
         BR    R12                      SCAN FURTHER                    03560000
CCOMM8   CLC   0(6,R1),CCMEMBER         COMMAND=MEMBER?                 03580000
         BNE   CCOMM9                   NO                              03600000
         CH    R0,CH6                                                   03620000
         BC    7,CODE36                 NO,WRITE ERROR MSG 36      SA0I 03650018
         OI    CCOMMSW,X'20'            SET MEMBER SWITCH          SA0I 03680018
         MVI   HPOID,X'02'              SET PDS SWITCH                  03720000
         MVC   CPX(2),CH1               RESET P(X)                      03740000
    CLI   CIDSW,X'00'                                                   03760000
         BC    7,CODE48                 WRITE ERROR MSG 48         SA0I 03780018
      MVI   CIDSW,X'01'                                                 03800000
         MVI   CIDSW2,X'00'                                             03820000
         TM    CERRSW,X'F0'             HAS ERROR OCCURRED         SA0I 03825018
         BC    1,SETKEY                 YES,BRANCH AROUND          SA0I 03830018
*                                       ERROR MESSAGE              SA0I 03835018
         LTR   R4,R4                    TABLE SPACE ALLOTTED       SA0I 03840018
         BC    8,CODE42                 NO,WRITE ERROR MSG 42      SA0I 03845018
SETKEY   OI    CWORK+81,X'02'           TURN KEYWORD REQ SW ON     SA0I 03850018
         BR    R12                      SCAN FURTHER               SA0I 03855018
CCOMM9   CLC   0(6,R1),CCRECORD         COMMAND=RECORD?                 03860000
         BNE   CCOMM10                 NO                          UL0H 03880017
         CH    R0,CH6                                                   03900000
         BC    7,CODE36                 NO,WRITE ERROR MSG 36      SA0I 03920018
         MVI   CRCDSW,X'00'             SET RECORD SWITCH               03940000
         OI    CCOMMSW,X'10'            YES,SET RECORD SWITCH           03960000
         OI    CWORK+141,X'0E'    SET RECORD SW                @YA01703 03962002
         BR    R12                      SCAN FURTHER                    03964000
CCOMM10  CLC   0(6,R1),CCLABELS        COMMAND=LABELS?             UL0H 03967017
         BC    7,CODE36                 NO,WRITE ERROR MSG 36      SA0I 03970018
         CH    R0,CH6                   IS LENGTH EQ 6             SA0I 03973018
         BC    7,CODE36                 NO,WRITE ERROR MSG 36      SA0I 03976018
         TM    FIRSTLAB,X'01'           LABELS CARD PROCESSED YET  SA0I 03979018
         BC    1,CODE36                 YES,WRITE ERROR MSG 36     SA0I 03982018
         OI    FIRSTLAB,X'01'          SET FIRST TIME SWITCH       UL0H 03985017
         OI    CCOMMSW,X'08'            YES-SET LABELS SWITCH      UL0H 03988017
         OI    CWORK+81,X'02'           TURN KEYWORD REQ SW ON     SA0I 03990018
         BR    R12                                                 SA0I 03992018
*                     ANALYSIS OF KEYWORDS                        *SA0I 03994018
*                                                                 *SA0I 03996018
*                                                                       04000000
CKEYW    XC    CMAXEXSW(2),CMAXEXSW     TURN OFF KEYWORD SWITCHES       04020000
         NI    CWORK+81,X'FD'           TURN KEYWORD REQ SW OFF    SA0I 04030018
         TM    CCOMMSW,X'80'            GENERATE SWITCH SET?            04040000
         BO    CKEYWA                   YES                             04060000
         TM    CCOMMSW,X'40'            NO,EXITS SWITCH SET?            04080000
         BO    CKEYWB                   YES                             04100000
         TM    CCOMMSW,X'20'            NO,MEMBER SWITCH SET?           04120000
         BO    CKEYWC                   YES                             04140000
         B     CKEYWD                   NO                              04160000
*                                                                       04180000
CKEYWA   CLC   0(8,R1),CCMAXNAM         KEYWORD=MAXNAME?         A28288 04200019
         BNE   CKEYWA2                  NO                              04220000
         OI    CMAXEXSW,X'80'           SET MAXNAME SWITCH         SA0I 04270018
         OI    CWORK+81,X'01'           TURN PARAMETER REQ SW ON   SA0I 04280018
         BR    R12                      SCAN FURTHER                    04300000
CKEYWA2  CLC   0(8,R1),CCMAXFLD        KEYWORD=MAXFLDS?          A28288 04320019
         BNE   CKEYWA3                  NO                              04340000
         OI    CMAXEXSW,X'40'           SET MAXFLDS SWITCH         SA0I 04390018
         OI    CWORK+81,X'01'           TURN PARAMETER REQ SW ON   SA0I 04400018
         BR    R12                      SCAN FURTHER                    04420000
CKEYWA3  CLC   0(7,R1),CCMAXGPS        KEYWORD=MAXGPS?           A28288 04440019
         BNE   CKEYWA4                  NO                              04460000
         OI    CMAXEXSW,X'20'           SET MAXGPS SWITCH          SA0I 04510018
         OI    CWORK+81,X'01'           TURN PARAMETER REQ SW ON   SA0I 04520018
         BR    R12                      SCAN FURTHER                    04540000
CKEYWA4  CLC   0(8,R1),CCMAXLIT        KEYWORD=MAXLITS?          A28288 04550019
         BC    7,CODE37                 NO,WRITE ERROR MSG 37      SA0I 04570018
         OI    CWORK+81,X'01'           TURN PARAMETER REQ SW ON   SA0I 04600018
         BR    R12                      YES,SCAN FURTHER                04640000
*                                                                       04660000
CKEYWB   CLC   0(6,R1),CCEXIT1          KEYWORD=INHDR?           A28288 04680019
         BNE   CKEYWB2                  NO                              04700000
         TM    CEXITSSW,X'20'           IS INHDR SWITCH ON         SA0I 04744018
         BNZ   CODE47                   YES,WRITE ERROR MSG 47     SA0I 04752018
         OI    CEXITSSW,X'20'           SET INHDR SWITCH           SA0I 04760018
         MVI   EXITNAME,X'20'          INDICATE INHDR KEYWORD      SA0I 04764018
         OI    CWORK+81,X'01'           TURN PARAMETER REQ SW ON   SA0I 04768018
         BR    R12                      SCAN FURTHER                    04780000
CKEYWB2  CLC   0(7,R1),CCEXIT2          KEYWORD=OUTHDR?          A28288 04800019
         BNE   CKEYWB3                  NO                              04820000
         TM    CEXITSSW,X'10'           IS OUTHDR SWITCH ON        SA0I 04864018
         BNZ   CODE47                   YES,WRITE ERROR MSG 47     SA0I 04872018
         OI    CEXITSSW,X'10'           SET OUTHDR SWITCH          SA0I 04880018
         MVI   EXITNAME,X'10'          INDICATE OUTHDR KEYWORD     SA0I 04884018
         OI    CWORK+81,X'01'           TURN PARAMETER REQ SW ON   SA0I 04888018
         BR    R12                      SCAN FURTHER                    04900000
CKEYWB3  CLC   0(6,R1),CCEXIT3          KEYWORD=INTLR?           A28288 04920019
         BNE   CKEYWB4                  NO                              04940000
         TM    CEXITSSW,X'08'           IS INTLR SWITCH ON         SA0I 04984018
         BNZ   CODE47                   YES,WRITE ERROR MSG 47     SA0I 04992018
         OI    CEXITSSW,X'08'           SET INTLR SWITCH           SA0I 05000018
         MVI   EXITNAME,X'08'          INDICATE INTTLR KEYWORD     SA0I 05004018
         OI    CWORK+81,X'01'           TURN PARAMETER REQ SW ON   SA0I 05008018
         BR    R12                      SCAN FURTHER                    05020000
CKEYWB4  CLC   0(7,R1),CCEXIT4          KEYWORD=OUTTLR?          A28288 05040019
         BNE   CKEYWB5                  NO                              05060000
         TM    CEXITSSW,X'04'           IS OUTTLR SWITCH ON        SA0I 05104018
         BNZ   CODE47                   YES,WRITE ERROR MSG 47     SA0I 05112018
         OI    CEXITSSW,X'04'           SET OUTTLR SWITCH          SA0I 05120018
         MVI   EXITNAME,X'04'          INDICATE OUTTLR KEYWORD     SA0I 05124018
         OI    CWORK+81,X'01'           TURN PARAMETER REQ SW ON   SA0I 05128018
         BR    R12                      SCAN FURTHER                    05140000
CKEYWB5  CLC   0(5,R1),CCDATA           KEYWORD=DATA?            A28288 05160019
         BNE   CKEYWB6                  NO                              05180000
         TM    CEXITSSW,X'02'           IS DATA SWITCH ON          SA0I 05224018
         BNZ   CODE47                   YES,WRITE ERROR MSG 47     SA0I 05232018
         OI    CEXITSSW,X'02'           SET DATA SWITCH            SA0I 05240018
         MVI   EXITNAME,X'02'          INDICATE DATA KEYWORD       SA0I 05244018
         OI    CWORK+81,X'01'           TURN PARAMETER REQ SW ON   SA0I 05248018
         BR    R12                      SCAN FURTHER                    05260000
CKEYWB6  CLC   0(4,R1),CCKEY            KEYWORD=KEY?             A28288 05280019
         BNE   CKEYWB7                  NO                              05300000
         TM    CEXITSSW,X'01'           IS KEY SWITCH ON           SA0I 05344018
         BNZ   CODE47                   YES,WRITE ERROR MSG 47     SA0I 05352018
         OI    CEXITSSW,X'01'           SET KEY SWITCH             SA0I 05360018
         MVI   EXITNAME,X'01'         INDICATE KEY KEYWORD         SA0I 05364018
         OI    CWORK+81,X'01'           TURN PARAMETER REQ SW ON   SA0I 05368018
         BR    R12                      SCAN FURTHER                    05380000
CKEYWB7  CLC   0(8,R1),CCIOERRO         KEYWORD=IOERROR?         A28288 05400019
         BNE   CKEYWB8                 NO                          UL0H 05420017
         TM    CEXITSSW,X'80'           IS IOERROR SWITCH ON       SA0I 05434018
         BNZ   CODE47                   YES,WRITE ERROR MSG 47     SA0I 05436018
         OI    CEXITSSW,X'80'           SET IOERROR SWITCH         SA0I 05438018
         MVI   EXITNAME,X'00'          INDICATE IOERROR KEYWORD    SA0I 05439018
         OI    CWORK+81,X'01'           TURN PARAMETER REQ SW ON   SA0I 05440018
         BR    R12                      YES,SCAN FURTHER                05444000
CKEYWB8  CLC   0(6,R1),CCTOTAL          KEYWORD=TOTAL?           A28288 05450019
         BC    7,CODE37                 NO,WRITE ERROR MSG 37      SA0I 05456018
         TM    CEXITSSW,X'40'           IS TOTAL SWITCH ON         SA0I 05472018
         BNZ   CODE47                   YES,WRITE ERROR MSG 47     SA0I 05476018
         OI    CEXITSSW,X'40'           SET TOTAL SWITCH           SA0I 05480018
         MVI   EXITNAME,X'40'          INDICATE TOTAL KEYWORD      SA0I 05482018
         OI    CWORK+81,X'01'           TURN PARAMETER REQ SW ON   SA0I 05484018
         BR    R12                                                 UL0H 05492017
*                                                                       05500000
CKEYWC   CLC   0(5,R1),CCNAME           KEYWORD=NAME?            A28288 05510019
         BC    7,CODE37                 NO,WRITE ERROR MSG 37      SA0I 05530018
         OI    CWORK+81,X'01'           TURN PARAMETER REQ SW ON   SA0I 05560018
         OI    COTHSW,X'80'             YES,SET NAME SWITCH             05600000
         BR    R12                      SCAN FURTHER                    05620000
*                                                                       05640000
CKEYWD   TM    CCOMMSW,X'08'           COMMAND IS LABELS?          UL0H 05644017
         BO    CKEYWD3                                             UL0H 05648017
         CLC   0(7,R1),CCLABELS         KEYWORD=LABELS?          A28288 05652019
         BNE   CKEYWDA                                             UL0H 05656017
         OI    LABINPUT,X'08'           SET LABEL SWITCH           SA0I 05666018
         OI    CWORK+81,X'01'           TURN PARAMETER REQ SW ON   SA0I 05668018
         BR    R12                                                 UL0H 05672017
CKEYWDA  CLC   0(6,R1),CCIDENT          KEYWORD=IDENT?           A28288 05676019
         BNE   CKEYWD2                  NO                              05680000
*                                       LENGTH INVALID             SA0I 05720018
         TM    CERRSW,X'F0'             HAS ERROR OCCURRED         SA0I 05730018
         BC    1,SKIP1                 YES, SKIP PAST PROCESSING   SA0I 05740018
*                                      OF THIS PARAMETER           SA0I 05750018
         LTR   R5,R5                    TABLE SPACE ALLOTTED       SA0I 05760018
         BC    8,CODE42                 WRITE ERROR MSG 42 IF NOT  SA0I 05770018
CKEYWD0   B   CKEYWD1                                                   05780000
         LA    R5,12(,R5)                                               05800000
CKEYWD1  NI    CKEYWD0+1,X'0F'                                          05820000
         S     R5,HRDTAD                                                05840000
         CH    R5,CMAXG                                                 05860000
         BNL   CODE42                   WRITE ERROR MSG 42 IF   YA01699 05870002
*                                       GT MAX                     SA0I 05880018
         A     R5,HRDTAD                                                05900000
SET1     OI    CRDTSW,X'FF'             SET RDT SWITCH             SA0I 05910018
         TM    CRCDSW,X'F0'            WAS THERE A PREVIOUS FIELD  0492 05920018
         BZ    NOFIELD                 NO, DO NOT SET FIELD BIT    0492 05928018
         MVI   0(R5),X'20'             SET BIT IN IDENT AREA       0492 05936018
         B     SKIP1                   CONTINUE PROCESSING         0492 05944018
NOFIELD  MVI   0(R5),X'00'             SET FIELD BIT TO ZERO       0492 05952018
SKIP1    OI    CRDTSW2,X'FF'            SET IDENT SWITCH           0492 05960018
         OI    CRCDSW,X'0F'             SET IDENT SWITCH           0492 05970018
         OI    COTHSW,X'40'             SET IDENT SWITCH                05980000
         MVI   CIDSW,X'00'                                              06000000
         MVI   CIDSW2,X'01'                                             06020000
         MVC   CPX(2),CH1               RESET P(X)                      06040000
         OI    CWORK+81,X'01'           TURN PARAMETER REQ SW ON   SA0I 06050018
         BR    R12                      SCAN FURTHER               SA0I 06060018
CKEYWD2   CLC   0(6,R1),CCFIELD         KEYWORD=FIELD?           A28288 06070019
         BC    7,CODE37                 NO,WRITE ERROR MSG 37      SA0I 06090018
         CLI   6(R1),X'4D'   IS AN LEFT PARENT. PRESENT?         A36072 06100021
         BNE   CODE46        NO, WRITE ERROR MESSAGE             A36072 06110021
         TM    CERRSW,X'F0'             HAS ERROR OCCURRED         SA0I 06120018
         BC    1,SKIP                   YES,BRANCH AROUND          5052 06130018
*                                       PROCESSING                 5052 06140018
         LTR   R6,R6                    TABLE SPACE ALLOTTED       SA0I 06150018
         BC    8,CODE42                 NO,WRITE ERROR MSG 42      SA0I 06160018
         TM    CRCDSW,X'0F'            WAS THERE A PREVIOUS IDENT  0492 06163018
         BZ    SKIP                    NO, DO NOT SET BIT          0492 06166018
SETSW    MVI   0(R5),X'20'              SET FIELD SWITCH IN TABLE  0492 06170018
SKIP     OI    CRCDSW,X'F0'             SET FIELD SWITCH           0492 06180018
         TM    CERRSW,X'F0'             HAS ERROR OCCURRED         SA0I 06190018
         BC    1,SET2                   YES,BRANCH AROUND          SA0I 06200018
*                                       PROCESSING                 SA0I 06210018
         LA    R6,8(,R6)                UPDATE EDCB XR                  06280000
         S     R6,HEDCBAD               TABLE OVERFLOW?                 06300000
         CH    R6,CMAXF                                                 06320000
         BC    11,CODE42A               YES,WRITE ERROR MSG 42 @ZA28787 06340099
         A     R6,HEDCBAD               NO,RESTORE XR                   06360000
         MVC   0(8,R6),CSTEDCB          MOVE IN STANDARD EDCB           06380000
SET2     OI    COTHSW,X'20'             YES,SET FIELD SWITCH       SA0I 06400018
     OI   CEDITSW,X'FF'                                                 06420000
         MVC   CPX(2),CH1               RESET P(X)                      06440000
         CLI   CIDSW2,X'01'                                             06460000
         BNE   CHANGE                                                   06480000
BBKK     MVI   CIDSW2,X'00'                                             06500000
         OI    CWORK+81,X'01'           TURN PARAMETER REQ SW ON   SA0I 06510018
         BR    R12                      SCAN FURTHER               SA0I 06520018
CHANGE   NI    CRDTSW,X'00'    CLEAR RDT SWITCH                         06540000
         B    BBKK                                                      06560000
CKEYWD3  CLC   0(5,R1),CCDATA           KEYWORD=DATA?            A28288 06561019
         BC    7,CODE37                 NO,WRITE ERROR MSG 37      SA0I 06565018
         OI    LABINPUT,X'04'           SET SWITCH FOR LABELS      SA0I 06566018
         OI    CWORK+81,X'01'           TURN PARAMETER REQ SW ON   SA0I 06567018
         BR    R12                     PARAMETER PROCESSING AND    UL0H 06572017
*                                      CONTINUE SCANNING           UL0H 06574017
CIDSW2   DC    X'00'                                                    06580000
*                                                                 *SA0I 06590018
*                      ANALYSIS OF PARAMETERS                     *SA0I 06600018
*                                                                 *SA0I 06610018
CPARA    TM    CCOMMSW,X'80'            GENERATE SWITCH SET?            06620000
         BZ    CPARAB                   NO                              06640000
         TM    CMAXEXSW,X'80'           YES,MAXNAME SWITCH SET?         06660000
         BZ    CPARAA2                  NO                              06680000
         NI    CWORK+81,X'FE'           TURN PARAMETER REQ SW OFF  SA0I 06688018
         BALR  R9,R10                   CONVERT PARAM TO BINARY  A41800 06690021
         LTR   R0,R0                    IS LENGTH EQ 0             SA0I 06696018
         BC    8,CODE38                 YES,WRITE ERROR MSG 38     SA0I 06704018
       ST    R0,MXNAMK                                                  06720000
         MH    R0,CH10                  MULTIPLY NUMBER BY 10 BYTES     06740000
         STH   R0,CMAXN                 STORE TABLE SIZE                06760000
         GETMAIN R,LV=(R0)                                              06780000
         ST    R1,HMDTAD                STORE ADDRESS OF MDT            06800000
         LR    R4,R1                                                    06820000
         BR    R12                      SCAN FURTHER                    06840000
CPARAA2  TM    CMAXEXSW,X'40'           MAXFLDS SWITCH SET?             06860000
         BZ    CPARAA3                  NO                              06880000
         NI    CWORK+81,X'FE'           TURN PARAMETER REQ SW OFF  SA0I 06888018
         BALR  R9,R10                   CONVERT PARAM TO BINARY  A41800 06890021
         LTR   R0,R0                    IS LENGTH EQ 0             SA0I 06896018
         BC    8,CODE38                 YES,WRITE ERROR MSG 38     SA0I 06904018
         MH    R0,CH8                   MULTIPLY NUMBER BY 8  BYTES     06920000
         STH   R0,CMAXF                 STORE TABLE SIZE                06940000
         AH    R0,CH8                                                   06960000
         GETMAIN R,LV=(R0)                                              06980000
         AH    R1,CH8                                                   07000000
         ST    R1,HEDCBAD               STORE ADDRESS OF EDCBS          07020000
         LR    R6,R1                    LOAD REG6 WITH ADDR OF EDCBS    07040000
         SH    R6,CH8                   AND SUBTRACT 8 FROM THE ADDR    07060000
         BR    R12                      SCAN FURTHER                    07080000
CPARAA3  TM    CMAXEXSW,X'20'           MAXGPS SWITCH SET?              07100000
         BZ    CPARAA4                  NO                              07120000
         NI    CWORK+81,X'FE'           TURN PARAMETER REQ SW OFF  SA0I 07128018
         BALR  R9,R10                   CONVERT PARAM TO BINARY  A41800 07130021
         LTR   R0,R0                    IS LENGTH EQ 0             SA0I 07136018
         BC    8,CODE38                 YES,WRITE ERROR MSG 38     SA0I 07144018
         MH    R0,CH12                  MULTIPLY NUMBER BY 12 BYTES     07160000
         AH    R0,CH12            FOR RECORD STMT WITHOUT PARAM YA01703 07170002
         STH   R0,CMAXG                 STORE TABLE SIZE                07180000
         GETMAIN R,LV=(R0)                                              07200000
         ST    R1,HRDTAD                STORE ADDRESS OF RDT            07220000
         LR    R5,R1                    LOAD ADDR OF RDT IN REG 5       07240000
         BR    R12                      SCAN FURTHER                    07260000
CPARAA4  NI    CWORK+81,X'FE'           TURN PARAMETER REQ SW OFF  SA0I 07268018
         BALR  R9,R10                   CONVERT PARAM TO BINARY  A41800 07270021
         LTR   R0,R0                    IS LENGTH EQ 0             SA0I 07276018
         BC    8,CODE38                 YES,WRITE ERROR MSG 38     SA0I 07284018
         STH   R0,CMAXL                 STORE TABLE SIZE                07300000
         GETMAIN R,LV=(R0)                                              07320000
         ST    R1,HLITTAD               STORE ADDRESS OF LITT           07340000
         LR    R7,R1                    LOAD ADDR OF LITT IN REG 7      07360000
         BR    R12                      SCAN FURTHER                    07380000
*                                                                       07400000
CPARAB   TM    CCOMMSW,X'40'            EXITS SWITCH SET?               07420000
         BZ    CPARAF                                              UL0H 07430017
         NI    CWORK+81,X'FE'           TURN PARAMETER REQ SW OFF  SA0I 07432018
         LTR   R0,R0                    IS LENGTH EQ 0             SA0I 07434018
         BC    8,CODE38                 YES,WRITE ERROR MSG 38     SA0I 07436018
         TM    CERRSW,X'F0'             HAS ERROR OCCURRED         SA0I 07438018
         BC    1,COMP2                  YES,BRANCH AROUND          SA0I 07440018
*                                       PROCESSING                 SA0I 07442018
         TM    CMAXEXSW,X'80'          AREA LENGTH PARAMETER       SA0I 07446018
         BO    CPARAB6                 YES -GET TOTALING AREA      UL0H 07450017
COMP2    LA    R9,8                     LENGTH GT 8                SA0I 07456018
         CR    R0,R9                                               SA0I 07462018
         BC    2,CODE38                 WRITE ERROR MSG 38 IF GT 8 SA0I 07468018
         TM    CERRSW,X'F0'             HAS ERROR OCCURRED         SA0I 07474018
         BCR   1,R12                    YES,SCAN FURTHER           SA0I 07480018
         LA    R3,HEXITT                                                07490000
         SR    R9,R9                    YES,STORE LABEL IN              07500000
         LA    R8,8                                                UL0H 07540017
         MVI   CPARAB2+1,X'40'                                     UL0H 07580017
         B     CPARAB2                                                  07600000
CPARAB1  LA    R3,8(,R3)                                                07620000
CPARAB2  TM    EXITNAME,X'40'          WHICH EXIT KEYWORD SET      SA0I 07640018
         BZ    CPARAB5                                                  07660000
CPARAB3  BCTR  R0,0                                                     07670000
         STC   R0,CPARAB4+1                                             07680000
CPARAB4  MVC   0(1,R3),0(R1)                                            07690000
          CLI  CPARAB2+1,X'40'          TOTALING?                  UL0H 07725017
         BCR   7,R12                   NO                          UL0H 07730017
         OI    CMAXEXSW,X'80'          SET AREA LENGTH BIT         SA0I 07737018
         OI    CWORK+81,X'01'          TURN PARAMETER REQ. SW. ON  UL0I 07741018
         BR    R12                                                      07745000
CPARAB5  IC    R9,CPARAB2+1                                             07755000
         SRL   R9,1                                                     07765000
         STC   R9,CPARAB2+1                                             07775000
         BCT   R8,CPARAB1                                               07785000
         B     CPARAB3                                                  07840000
CPARAB6  BALR  R9,R10                  CONVERT TO BINARY           UL0H 07842017
         ST    R0,TOTLAREA             SAVE LENGTH                 UL0H 07844017
         CH    R0,TW15M1               COMPARE TO MAXIMUM          UL0H 07846017
         BC    2,CODE42                 WRITE ERROR MSG 42 IF      SA0I 07847018
*                                       GT MAX                     SA0I 07848018
         GETMAIN R,LV=(R0)             GET TOTALING AREA           UL0H 07850017
         L     R0,TOTLAREA             LOAD LENGTH                 UL0H 07852017
         ST    R1,TOTLAREA             STORE TOALING AREA ADDRESS  UL0H 07854017
         STH   R0,0(R1)                STORE LENGTH IN TOT. AREA   UL0I 07856018
         BR    R12                                                 UL0H 07858017
*                                                                       07860000
**********************************************************************  07880000
*               REG1 HAS THE POINTER TO THE PARAMETER OF THE MEMBER  *  07900000
*                NAME STATEMENT, FROM CCS02.                         *  07920000
*                                                                    *  07940000
*               REG0 HAS THE LENGTH OF THE MEMBER NAME, FROM CCS02   *  07960000
*                                                                    *  07980000
*               MDT IS THE TABLE FOR THE MEMBER NAMES                *  08000000
*                                                                    *  08020000
**********************************************************************  08040000
*                                                                       08060000
CPARAC   TM    COTHSW,X'80'             NAME SWITCH SET?                08080000
         BZ    CPARAD                   NO                              08100000
         LTR   R0,R0                                                    08120000
         BC    8,CODE41                 WRITE ERROR MSG 41 IF 0    SA0I 08140018
         LA    R9,8                     LEGAL LENGTH?                   08160000
         CR    R0,R9                                                    08180000
         BC    2,CODE38                 WRITE ERROR MSG 38 IF GT 8 SA0I 08200018
         CLC   CPX(2),CH1               YES,PARAMETER 1?                08220000
         BNE   CPARAC2                  NO                              08240000
         NI    CWORK+81,X'FE'           TURN PARAMETER REQ SW OFF  SA0I 08244018
         TM    CERRSW,X'F0'             HAS ERROR OCCURRED         SA0I 08248018
         BC    1,SET3                   YES,BRANCH AROUND          SA0I 08252018
*                                       PROCESSING                 SA0I 08256018
         ST    R4,CSAVEMDT                                              08260000
         LA    R4,2(,R4)                                                08280000
CPARAC1  B     CPARAC2                  FIRST-TIME SWITCH               08300000
         LTR   R5,R5                                                    08320000
         BC    8,CODE42                 WRITE ERROR MSG 42 IF 0    SA0I 08340018
         OI    0(R5),X'0F'              ENTER EOM INDICATOR             08360000
SET3     OI    CPDSSW,X'FF'             INDICATE NAME CARD         SA0I 08370018
CPARAC2  TM    CERRSW,X'F0'             HAS ERROR OCCURRED         SA0I 08380018
         BC    1,SET4                   YES,BRANCH AROUND          SA0I 08390018
*                                       PROCESSING                 SA0I 08400018
         NI    CPARAC1+1,X'0F'          TURN OFF SWITCH            SA0I 08410018
         ST    R4,FOURSVK                                               08420000
         L     R4,MXNAMK                                                08440000
         LTR   R4,R4                                                    08460000
         BC    8,CODE42                 WRITE ERROR MSG 42 IF 0    SA0I 08480018
      BCTR   R4,0    DECREASE COUNT                                     08500000
     ST    R4,MXNAMK                                                    08520000
        L    R4,FOURSVK                                                 08540000
         BCTR  R0,0                                                     08560000
         STC   R0,CPARAC3+1                                             08580000
         MVI   0(R4),X'40'              BLANK OUT NAME AREA             08600000
         MVC   1(7,R4),0(R4)                                            08620000
CPARAC3  MVC   0(8,R4),0(R1)            STORE NAME IN MDT               08640000
         LA    R4,8(,R4)                INCREMENT XR                    08660000
         TM    CWORK,X'21'              LAST PARAMETER             9430 08680017
         BM    CPARAC4                 YES                              08700000
SET4     LA    R8,1                     NO,INCREMENT P(X)          SA0I 08720018
         AH    R8,CPX                                                   08740000
         STH   R8,CPX                                                   08760000
         BR    R12                      SCAN FURTHER                    08780000
CPARAC4  LH    R8,CPX                                                   08800000
         BCTR  R8,0                                                     08820000
         L     R9,CSAVEMDT                                              08840000
         STH   R8,0(R9)                 INSERT ALIAS COUNT              08860000
         BR    R12                      SCAN FURTHER                    08880000
*                                                                       08900000
CPARAD   TM    COTHSW,X'40'             IDENT SWITCH SET?               08920000
         BZ    CPARAG                                              UL0H 08940017
         CLC   CPX(2),CH1               YES,PARAMETER 1?                08960000
         BNE   CPARAD2                  NO                              08980000
         MVI   CPDSSW,X'00'             INDICATE NAME & IDENT COMB.     09000000
         TM    CERRSW,X'F0'            WAS THERE A PREVIOUS ERROR  SA0I 09010018
         BO    SET5                    YES, SKIP PROCESSING        SA0I 09020018
COMP3    LTR   R0,R0                                               SA0I 09042018
         BC    8,CODE41                 WRITE ERROR MSG 41 IF 0    SA0I 09049018
         TM    CWORK,X'01'              MORE PARAMETERS            SA0I 09056018
         BC    1,CODE41                 WRITE ERROR MSG 41 IF NO   SA0I 09063018
*                                       MORE                       SA0I 09070018
         TM    CERRSW,X'F0'             HAS ERROR OCCURRED         SA0I 09077018
         BC    1,SET5                   YES,BRANCH AROUND          SA0I 09084018
*                                       PROCESSING                 SA0I 09091018
         CLI   0(R1),X'F0'              IS PARAMETER EQ 0          SA0I 09098018
         BC    8,CODE38                 YES,WRITE ERROR MSG 38     SA0I 09105018
         BALR  R9,R10                   YES,CONVERT TO BINARY           09120000
         LA    R9,8                     LEGAL LENGTH?                   09140000
         CR    R0,R9                                                    09160000
         BC    2,CODE38                 WRITE ERROR MSG 38 IF GT 8 SA0I 09180018
         STC   R0,1(R5)                 STORE IN RDT                    09200000
SET5     MVC   CPX(2),CH2               UPDATE P(X)                SA0I 09220018
         BR    R12                      SCAN FURTHER                    09240000
CPARAD2  CLC   CPX(2),CH2               PARAMETER 2?                    09260000
         BNE   CPARAD3                  NO                              09280000
         LTR   R0,R0                                                    09300000
         BC    8,CODE41                 WRITE ERROR MSG 41 IF 0    SA0I 09310018
         CLI   0(R1),X'7D'              FIRST BYTE A QUOTE         SA0I 09320018
         BC    7,CODE38                 WRITE ERROR MSG 38 IF NOT  SA0I 09330018
         TM    CWORK,X'01'              MORE PARAMETERS            SA0I 09340018
         BC    1,CODE41                 WRITE ERROR MSG 41 IF NOT  SA0I 09350018
         TM    CERRSW,X'F0'             HAS ERROR OCCURRED         SA0I 09360018
         BC    1,SET6                   YES,BRANCH AROUND          SA0I 09370018
*                                       PROCESSING                 SA0I 09380018
         SH    R0,CH2                   YES,CONSISTENT PARAM LENGTH?    09420000
         STC   R0,IDLENG               COMPARE ACTUAL LENGTH TO    SA0I 09430018
         CLC   IDLENG(1),1(R5)         STATED LENGTH               SA0I 09440018
         BC    7,CODE49                 WRITE ERROR MSG 49 IF NOT  SA0I 09450018
*                                       CONSISTENT                 SA0I 09460018
         MVC   4(8,R5),1(R1)            YES,MOVE TO RDT                 09480000
SET6     MVC   CPX(2),CH3               UPDATE P(X)                SA0I 09500018
         BR    R12                      SCAN FURTHER                    09520000
CPARAD3  CLC   CPX(2),CH3               PARAMETER 3?                    09540000
         BC    7,CODE38                 NO,WRITE ERROR MSG 38      SA0I 09560018
         NI    CWORK+81,X'FE'          TURN OFF PARAMETER REQ BIT  SA0I 09570018
         MVC   CPX(2),CH4               YES,UPDATE P(X)                 09580000
         LTR   R0,R0                                                    09600000
         BC    8,CODE41                 WRITE ERROR MSG 41 IF 0    SA0I 09620018
         TM    CERRSW,X'F0'             HAS ERROR OCCURRED         SA0I 09640018
         BCR   1,R12                    YES,SCAN FURTHER           SA0I 09660018
         BALR  R9,R10                   CONVERT TO BINARY               09680000
         BCTR  R0,0                     SUBTRACT 1                      09700000
         STH   R0,2(R5)                 STORE IN RDT                    09720000
         BR    R12                      SCAN FURTHER                    09740000
*                                                                       09760000
CPARAE   CLC   CPX(2),CH1               PARAMETER 1?                    09780000
         BNE   CPARAE2                  NO                              09800000
         NI    CWORK+81,X'FE'          TURN OFF PARAMETER REQ BIT M0171 09810018
         LTR   R0,R0                                                    09820000
         BZ    CPARAE1                                                  09840000
         TM    CERRSW,X'F0'             HAS ERROR OCCURRED         SA0I 09845018
         BC    1,CPARAE1                YES,BRANCH AROUND          SA0I 09850018
*                                       PROCESSING                 SA0I 09855018
         STM   R0,R1,CSAVE1             SAVE PARAMETER REGS      A27695 09855519
CKNUM    CLI   0(R1),X'F0'              IS PARAMETER = 0         A27695 09856019
         BL    CODE38                   LESS THAN F0             A27695 09856519
         CLI   0(R1),X'F9'              IS PARAMETER = 9         A27695 09857019
         BH    CODE38                   GREATER THAN F9          A27695 09857519
         LA    R1,1(R1)                 INCREMENT POINTER        A27695 09858019
         BCT   R0,CKNUM                 WAS ENTIRE LENGTH CHECK  A27695 09858519
          LM   R0,R1,CSAVE1             RESTORE REGS                    09859019
         BALR  R9,R10                   CONVERT TO BINARY               09860000
         STH   R0,4(R6)                 STORE IN EDCB                   09880000
CPARAE1  MVC   CPX(2),CH2               UPDATE P(X)                     09900000
         BR    R12                      SCAN FURTHER                    09920000
CPARAE2  CLC   CPX(2),CH2               PARAMETER 2?                    09940000
         BNE   CPARAE6                  NO                              09960000
         LTR   R0,R0                                                    09980000
         BZ    CPARAE3                                                  10000000
         TM    CERRSW,X'F0'             HAS ERROR OCCURRED         SA0I 10005018
         BC    1,CPARAE3                YES,BRANCH AROUND          SA0I 10010018
*                                       PROCESSING                 SA0I 10015018
         CLI   0(R1),X'7D'              LITERAL?                        10020000
         BE    CPARAE4                  YES                             10040000
         CLI   0(R1),X'F0'             CHECK TO SEE IF THE CHAR    1284 10044018
         BL    CODE38                  IS A NUMERAL- IF NOT WRITE  1284 10048018
         CLI   0(R1),X'F9'             AN ERROR MSG INDICATING     1284 10052018
         BH    CODE38                  AN INVALID PARAMETER        1284 10056018
         BALR  R9,R10                   NO,CONVERT TO BINARY            10060000
         BCTR  R0,0                     SUBTRACT 1                      10080000
         STH   R0,2(R6)                 STORE IN EDCB                   10100000
CPARAE3  MVC   CPX(2),CH3               UPDATE P(X)                     10120000
         BR    R12                      SCAN FURTHER                    10140000
CPARAE4  LTR   R7,R7                   TABLE SPACE ALLOTTED        SA0I 10160018
         BC    8,CODE42                 WRITE ERROR MSG 42 IF NOT  SA0I 10180018
         S     R7,HLITTAD                                               10200000
         AR    R7,R0                                                    10220000
         SH    R7,CH2                                                   10240000
         CH    R7,CMAXL                                                 10260000
         BC    2,CODE42                 WRITE ERROR MSG 42 IF IS   SA0I 10280018
         A     R7,HLITTAD               NO,RESTORE XR                   10300000
         SR    R7,R0                                                    10320000
         AH    R7,CH2                                                   10340000
         OI    0(R6),X'40'              SET LITERAL BIT                 10360000
         SH    R0,CH2                   SHORT LENGTH?                   10380000
         CH    R0,4(R6)                IS STATED LENGTH OF LITERAL SA0I 10381018
*                                      EQ TO ACTUAL LENGTH         SA0I 10382018
         BNE   CODE49                  NO,WRITE ERR MSG 49      YA01701 10383002
         SR    R11,R11                  ZERO OUT REGISTER          8206 10385018
         LA    R9,40                    PUT CONSTANT 40 IN REG     SA0I 10390018
         CH    R9,4(R6)           IS LIT. GREATER THAN 40?      YA01701 10391002
         BL    CODE50             YES,WRITE ERROR MSG           YA01701 10392002
         LA    R1,1(R1)                 ADD 1 TO LITERAL POINTER   8206 10395018
CPARAE5  MVC   0(1,R7),0(R1)            MOVE ONE BYTE OF LITERAL   8206 10400018
*                                       TO TABLE                   8206 10405018
         LA    R11,1(R11)               INCREASE LITERAL LENGTH    8206 10410018
         CR    R11,R9                  IS LITERAL LENGTH GREATER   SA0I 10415018
         BH    CODE50                   THAN 40 - YES WRITE ERR    SA0I 10420018
*                                       MESSAGE                    SA0I 10425018
         CLI   0(R1),X'7D'              COMPARE FOR QUOTE          8206 10430018
         BNE   NOTQUOTE                 NOT A QUOTE,BRANCH AROUND  8206 10435018
         LA    R1,1(R1)                 ADD 1 TO LITERAL POINTER   8206 10440018
NEXTQUOT CLI   0(R1),X'7D'              IS NEXT BYTE QUOTE         8206 10460018
         BNE   CODE38                   NO,WRITE ERROR MSG 38      8206 10465018
NOTQUOTE LA    R1,1(R1)                 ADD 1 TO LITERAL POINTER   8206 10470018
         LA    R7,1(R7)                 ADD 1 TO TABLE POSITION    8206 10475018
*                                       POINTER                    8206 10480018
         BCT   R0,CPARAE5               SUBTRACT 1 FROM LENGTH     8206 10485018
*                                       BRANCH IF NOT 0            8206 10490018
         LR    R8,R7                                                    10500000
         SR    R8,R11                   POINT TO BEGIN OF LITERAL  SA0I 10510018
         S     R8,HLITTAD                                               10520000
         STH   R8,2(R6)                 STORE POSITION IN EDCB          10540000
         B     CPARAE3                                                  10600000
CPARAE6  CLC   CPX(2),CH3               PARAMETER 3?                    10620000
         BNE   CPARAE10                 NO                              10640000
         MVC   CPX(2),CH4               YES,UPDATE P(X)                 10660000
         LTR   R0,R0                                                    10680000
         BZ    CPARAE7                                                  10700000
         CLC   0(2,R1),CCHE                                             10720000
         BNE   CPARAE8                  NO                              10740000
         CH    R0,CH2                                                   10760000
         BC    7,CODE38                 WRITE ERROR MSG 38 IF NOT 2SA0I 10770018
         TM    CERRSW,X'F0'             HAS ERROR OCCURRED         SA0I 10780018
         BCR   1,R12                    YES,SCAN FURTHER           SA0I 10790018
         OI    0(R6),X'20'              YES,SET HE BIT                  10800000
CPARAE7  BR    R12                      SCAN FURTHER                    10820000
CPARAE8  CLC   0(2,R1),CCPZ             PZ CONVERSION?                  10840000
         BNE   CPARAE9                  NO                              10860000
         CH    R0,CH2                                                   10880000
         BC    7,CODE38                 WRITE ERROR MSG 38 IF NOT 2SA0I 10890018
         TM    CERRSW,X'F0'             HAS ERROR OCCURRED         SA0I 10900018
         BCR   1,R12                    YES,SCAN FURTHER           SA0I 10910018
         OI    0(R6),X'10'              YES,SET PZ BIT                  10920000
         BR    R12                      SCAN FURTHER                    10940000
CPARAE9  CLC   0(2,R1),CCZP             ZP CONVERSION?                  10960000
         BC    7,CODE38                 WRITE ERROR MSG 38 IF NOT  SA0I 10970018
         CH    R0,CH2                   IS LENGTH EQ 2             SA0I 10980018
         BC    7,CODE38                 WRITE ERROR MSG 38 IF NOT 2SA0I 10990018
         TM    CERRSW,X'F0'             HAS ERROR OCCURRED         SA0I 11000018
         BCR   1,R12                    YES,SCAN FURTHER           SA0I 11010018
         OI    0(R6),X'08'             YES-SET ZP BIT                   11040000
         BR    R12                     SCAN FURTHER                     11060000
CPARAE10 CLC   CPX(2),CH4               PARAMETER 4?                    11080000
         BC    7,CODE38                 WRITE ERROR MSG 38         SA0I 11090018
         MVC   CPX(2),CH5               UPDATE P(X)                SA0I 11100018
         LTR   R0,R0                    IS LENGTH EQ 0             SA0I 11110018
         BCR   8,R12                    SCAN FURTHER               SA0I 11120018
         TM    CERRSW,X'F0'             HAS ERROR OCCURRED         SA0I 11130018
         BCR   1,R12                    YES,SCAN FURTHER           SA0I 11140018
         BALR  R9,R10                   CONVERT TO BINARY               11200000
         BCTR  R0,0                                                     11210000
         STH   R0,6(R6)                 STORE IN EDCB                   11220000
         BR    R12                      SCAN FURTHER                    11230000
CPARAF   TM    CCOMMSW,X'08'           COMMAND IS LABELS           UL0H 11231017
         BZ    CPARAC                                              UL0H 11232017
         NI    CWORK+81,X'FE'           TURN PARAMETER REQ SW OFF  SA0I 11232118
         LTR   R0,R0                    IS LENGTH EQ 0             SA0I 11232218
         BC    8,CODE38                 YES,WRITE ERROR MSG 38     SA0I 11232318
         TM    CERRSW,X'F0'             HAS ERROR OCCURRED         SA0I 11232418
         BC    1,SET7                   YES,BRANCH AROUND          SA0I 11232518
*                                       PROCESSING                 SA0I 11232618
         TM    LABINPUT,X'04'          TEST LABELS PAR SWITCH      UL0H 11233017
         BZ    CPARAF5                                             UL0H 11234017
SET7     NI    LABINPUT,X'00'           SET SWITCH OFF             SA0I 11235018
         CLC   0(3,R1),CCYES           PARAMETER=YES?              UL0H 11236017
         BNE   CPARAF1                 NO                          UL0H 11237017
         CH    R0,CH3                                              UL0H 11238017
         BC    7,CODE38                 WRITE ERROR MSG 38 IF NOT 3SA0I 11239018
         OI    LABPROSW,X'80'          SET LABELPROC SWITCH=YES    UL0H 11240017
         BR    R12                     SCAN FURTHER                UL0H 11241017
CPARAF1  CLC   0(2,R1),CCNO            PARAMETER=NO?               UL0H 11242017
         BNE   CPARAF2                 NO                          UL0H 11243017
 CH      R0,CH2                                                    UL0H 11244017
         BC    7,CODE38                 WRITE ERROR MSG 38 IF NOT 2SA0I 11245018
         OI    LABPROSW,X'40'          SET LABEL PROC SWITCH=NO    UL0H 11246017
         BR    R12                     SCAN FURTHER                UL0H 11247017
CPARAF2  CLC   0(4,R1),CCONLY          PARAMETER=ONLY?             UL0H 11248017
         BNE   CPARAF3                 NO                          UL0H 11249017
         CH    R0,CH4                                              UL0H 11250017
         BC    7,CODE38                 WRITE ERROR MSG 38 IF NOT 4SA0I 11251018
         OI    LABPROSW,X'20'          SET LABEL PROS SWITCH=ONLY  UL0H 11252017
         BR    R12                     SCAN FURTHER                UL0H 11253017
CPARAF3   CLC  0(3,R1),CCALL            PARAMETER=ALL?             UL0H 11254017
         BNE   CPARAF4                 NO                          UL0H 11255017
         CH    R0,CH3                                              UL0H 11256017
         BC    7,CODE38                 WRITE ERROR MSG 38 IF NOT 3SA0I 11257018
         OI    LABPROSW,X'10'          SET LABEL PROC SWITCH=ALL   UL0H 11258017
         BR    R12                     SCAN FURTHER                UL0H 11259017
CPARAF4   CLC  0(5,R1),CCINPUT          PARAMETER=INPUT?           UL0H 11260017
         BC    7,CODE38                 WRITE ERROR MSG 38 IF      SA0I 11260818
*                                       NOT INPUT                  SA0I 11261618
         CH    R0,CH5                   IS LENGTH EQ 5             SA0I 11262418
         BC    7,CODE38                 WRITE ERROR MSG 38 IF NOT 5SA0I 11263218
         OI    LABPROSW,X'08'          SET LABEL PROC SWITCH=INPUT UL0H 11264017
         BR    R12                     SCAN FURTHER                UL0H 11265017
CPARAF5  NI    LABINPUT,X'00'                                      UL0H 11266017
         B     CODE40                   WRITE ERROR MSG 40         SA0I 11267018
CPARAG   TM    LABINPUT,X'08'          RECORD LABELS=N STAT.       UL0H 11268017
         BZ    CPARAE                  NO                          UL0H 11269017
         NI    CWORK+81,X'FE'           TURN PARAMETER REQ SW OFF  SA0I 11269318
         TM    CERRSW,X'F0'             HAS ERROR OCCURRED         SA0I 11269618
         BC    14,LAB                   NO,BRANCH                  SA0I 11269918
         TM    LABPROSW,X'08'           LABELS DATA=INPUT SPECIFIEDSA0I 11270218
         BC    8,CODE42                 WRITE ERROR MSG 42 IF NOT  SA0I 11270518
         XI    LABINPUT,X'88'           SET INPUTLABELSW TO X'80'  SA0I 11270818
         BR    R12                      SCAN FURTHER               SA0I 11271118
LAB      TM    LABPROSW,X'08'           LABELS DATA=INPUT SPECIFIEDSA0I 11271418
         BC    8,CODE42                 WRITE ERROR MSG 42 IF NOT  SA0I 11271718
         TM    LABCTSW,X'08'            FIRST LABEL CARD           UL0H 11272017
         BZ    CPARAG3                  YES INITIALIZE AND PROCESS UL0H 11273017
         L     R9,LPADTAD              ADDRESS NE LABELNNNL ADDRESSUL0H 11274017
         LA    R9,4(R9)                TABLE                       UL0H 11275017
         ST    R9,LPADTAD              STORE ADDRESS OF NEXT ENTRY UL0H 11276017
         TM    LABCTSW,X'80'            SECOND LABEL CARD          UL0H 11277017
         BO    CODE43                   WRITE ERROR MSG 43 IF      SA0I 11277618
*                                       3RD CARD                   SA0I 11278218
         OI    LABCTSW,X'80'            TURN ON SECOND CARD READ SWUL0H 11279017
CPARAG3  OI    LABCTSW,X'08'            TURN ON FIRST CARD READ SW UL0H 11280017
         CH    R0,=H'1'                ONLY ONE DIGIT              UL0H 11281017
         BC    7,CODE38                 WRITE ERROR MSG 38 IF NOT  SA0I 11282018
         CLI   0(R1),X'F0'              LESS THAN DIGIT 0          SA0I 11283018
         BC    4,CODE38                 WRITE ERROR MSG 38 IF IS   SA0I 11284018
         CLI   0(R1),X'F9'              MORE THAN DIGIT 9          SA0I 11285018
         BC    2,CODE38                 WRITE ERROR MSG 38 IF IS   SA0I 11286018
         BALR  R9,R10                  CONVERT TO BINARY           UL0H 11287017
         LA    R9,8                                                UL0H 11288017
         CR    R0,R9                   CONSTANT GREATER THEN 8?    UL0H 11289017
         BC    2,CODE38                 WRITE ERROR MSG 38 IF GT 8 SA0I 11289818
         LTR   R0,R0                                               SA0I 11290618
         BC    4,CODE38                 WRITE ERROR MSG 38 IF      SA0I 11291418
*                                       NEGATIVE                   SA0I 11292218
         BZ    CPARAG4                                            M1180 11293118
         L     R9,LPADTAD              GET ADDRESS OF LABELADDRESS UL0H 11294017
         STC   R0,0(R9)                TABLE,STORE NUMBER OF LABELSUL0H 11295017
         LA    R1,640                                              UL0H 11296017
         GETMAIN R,LV=(R1)             GET STORAGE FOR LABELS      UL0H 11297017
         AL    R1,0(R9)                                            UL0H 11298017
         ST    R1,0(R9)                                            UL0H 11299017
         XI    LABINPUT,X'88'          SET INPUTLABELSW TO X'80'   UL0H 11300017
         LA    R0,X'F0'                SET THE GENLABEL SWITCH     UL0H 11301017
         L     R1,GLABADR              IN CCS02 TO X'F0'           UL0H 11302017
         ST    R0,0(R1)                                            UL0H 11303017
         MVC   SAVLABIF(4),0(R9)       SAVE LABEL INFORMATION      UL0H 11304017
         BR    R12                     SCAN FURTHER                UL0H 11305017
CPARAG4  NI    LABINPUT,X'00'           RESET LABELS SWITCH       M1180 11305318
         BR    R12                      GO TO SCAN ROUTINE        M1180 11305618
*                                                                  UL0H 11306017
*                                                                 *SA0I 11306518
*                  END OF FILE ANALYSIS                           *SA0I 11307018
*                                                                 *SA0I 11307518
CEOF     TM    CWORK+81,X'4A'    CONTINUATION BIT ON  ?          A36129 11308021
         BO    CODE45A       YES, PRINT ERROR MESSAGE            A36129 11308421
         TM    CWORK+127,X'04'   CONTINUATION BIT ON ?           A36129 11316321
         BO    CODE45A       YES, PRINT ERROR MESSAGE            A36129 11318321
         TM    CERRSW,X'F0'  WAS AN ERROR MSG ALR. GIVEN         A36129 11320321
         BO    CEOF7                   YES - BRANCH                SA0I 11324218
         CLI   CEDITSW,X'FF'           EDITING                     ULOH 11332117
         BE    CEOF2                    YES                             11340000
         OI    HCOPYSW,X'F0'            NO, SET COPY SWITCH             11360000
         B     CEOF3                                                    11380000
CEOF2    CLI   CRDTSW2,X'FF'            CHECK FOR IDENT                 11400000
         BNE   CEOF4                    NO                              11420000
         CLI   CPDSSW,X'FF'             LAST CARD = MEMBER              11440000
         BNE   CEOF2A                   NO                              11460000
         OI    0(R5),X'5F'              YES, SET LAST ID IN RDT         11480000
         B     CEOF2B                   AND INDIC. TO PROC. TO EOD      11500000
CEOF2A   OI    0(R5),X'4F'              SET LAST IDENT IN RDT           11520000
CEOF2B   OI    0(R6),X'81'              SET LAST FIELD IN EDCB          11540000
         B     CEOF5                                                    11560000
CEOF3    CLI   CRDTSW2,X'FF'            CHECK FOR IDENT                 11580000
         BNE   CEOF4                    NO                              11600000
         CLI   CPDSSW,X'FF'             LAST CARD = MEMBER              11620000
         BNE   CEOF3A                   NO                              11640000
         OI    0(R5),X'9F'              YES, SET LAST ID IN RDT         11660000
         B     CEOF5                    AND INDICATE PROC. TO EOD       11680000
CEOF3A   OI    0(R5),X'8F'              SET LAST IDENT IN RDT           11700000
         B     CEOF5                                                    11720000
CEOF4    OI    HCOPYSW,X'0F'            SET COPY SWITCH                 11740000
         CLI   CEDITSW,X'FF'            CHECK FOR EDITING               11760000
         BNE   CEOF5                    NO                              11780000
         OI    0(R6),X'80'              YES, SET LAST FIELD IN EDCB     11790000
CEOF5    TM    CWORK+141,X'0F'    A RECORD STMT WITHOUT PARAM?  YA01703 11790202
         BNO   AROUND             NO,SKIP THIS FUNCTION         YA01703 11790402
         NI    CWORK+141,X'F0'    YES,CLEAR SWITCH              YA01703 11790602
         TM    0(R5),X'10'        DOES RDT INDICATE PROC TO EOD YA01703 11790802
         BO    AROUND             YES,SKIP THIS FUNCTION        YA01703 11791002
         NI    0(R5),X'20'        CLEAR END OF TABLE SWITCH     YA01703 11791202
         LA    R5,12(R5)          UPDATE POINTER TO NEXT ENTRY  YA01703 11791402
         OI    0(R5),X'9F'        SET PROCESS TO END OF DATA    YA01703 11791602
AROUND   TM    LABPROSW,X'08'     LABELS DATA=INPUT             YA01703 11792002
         BZ    CEOF6               NO-CONTINUE                     UL0H 11794017
         L     R0,LABPOLAT             HEADER LABELS SPECIFIED     UL0H 11796017
         LTR   R0,R0                                               UL0H 11798017
         BC    7,CEOF6                 YES CONTINUE                UL0H 11800017
         L     R0,LABPOLAT+4           TRAILER LABELS SPECIFIED    UL0H 11802017
         LTR   R0,R0                                               UL0H 11804017
         BC    7,CEOF6                 YES-CONTONUE                UL0H 11806017
         LA    R1,NRLSTER              NO LABELS SPECIFIED         UL0H 11808017
         SLL   R1,8                    WRITE MSG                   UL0H 11810017
         LA    R1,33(R1)                                           UL0H 11812017
         L     R15,CWRMSGA             LOAD ADDRESS OF MSG WRITER  UL0H 11814017
         BALR  R14,R15                                             UL0H 11816017
         TM    CERRSW,X'F0'             IS ERROR MSG GIVEN         SA0I 11823018
         BO    CEOF6                   YES-BRANCH                       11830017
         L     R15,CSAVE13+4           INCREASE RETURN ADDRESS     UL0H 11835017
         LA    R15,4(R15)              FOR ERROR                   UL0H 11840017
         ST    R15,CSAVE13+4                                       UL0H 11845017
CEOF6    LA    R1,HEXITT               LOAD EXIT TABLE ADDRESS     UL0H 11850017
         LM    R13,R14,CSAVE13          RESTORE REGS 13-14              11855000
         RETURN (2,12)                  RESTORE REGS 2-12 AND REURN     11860000
CEOF7    L     R15,CSAVE13+4                                       SA0I 11862018
         L     R15,CSAVE13+4                                       SA0I 11864018
         LA    R15,4(R15)               INCREASE RETURN ADDRESS FORSA0I 11866018
*                                       ERRORS                     SA0I 11868018
         ST    R15,CSAVE13+4                                       SA0I 11870018
         B     CEOF6                                               SA0I 11872018
*                                                                       11880000
*                                                                 *SA0I 11883018
*           THE FOLLOWING CODE ASSIGNS CODES FOR ERROR MESSAGES   *SA0I 11886018
*                                                                 *SA0I 11889018
CODE36   LA    R11,36                   SET ID EQ 36               SA0I 11892018
         B     CERR                     WRITE ERROR MSG            SA0I 11895018
CODE37   LA    R11,37                   SET ID EQ 37               SA0I 11898018
         B     CERR                     WRITE ERROR MSG            SA0I 11901018
CODE38   LA    R11,38                   SET ID EQ 38               SA0I 11904018
         B     CERR                     WRITE ERROR MSG            SA0I 11907018
CODE39   LA    R11,39                   SET ID EQ 39               SA0I 11910018
         B     CERR                     WRITE ERROR MSG            SA0I 11913018
CODE40   LA    R11,40                   SET ID EQ 40               SA0I 11916018
         B     CERR                     WRITE ERROR MSG            SA0I 11919018
CODE41   LA    R11,41                   SET ID EQ 41               SA0I 11922018
         B     CERR                     WRITE ERROR MSG            SA0I 11925018
CODE42A  LA    R12,CEOF7    RET.TO GENRT AFT WRITING A MESSAGE @ZA28787 11926099
CODE42   LA    R11,42                   SET ID EQ 42               SA0I 11928018
         B     CERR                     WRITE ERROR MSG            SA0I 11931018
CODE43   LA    R11,43                   SET ID EQ 43               SA0I 11934018
         B     CERR                     WRITE ERROR MSG            SA0I 11937018
CODE44   LA    R11,44                   SET ID EQ 44               SA0I 11940018
         B     CERR+8                   WRITE ERROR MSG            SA0I 11943018
*                                       NO NOT SET ERROR SW        SA0I 11946018
CODE45A  LA    R12,CEOF7     RET.TO GENRT AFT WRITING A MESSAGE  A36129 11948021
CODE45   LA    R11,45                   SET ID EQ 45               SA0I 11949018
         B     CERR                     WRITE ERROR MSG            SA0I 11952018
CODE46   LA    R11,46                   SET ID EQ 46               SA0I 11955018
         B     CERR                     WRITE ERROR MSG            SA0I 11958018
CODE47   LA    R11,47                   SET ID EQ 47               SA0I 11961018
         B     CERR                     WRITE ERROR MSG            SA0I 11964018
CODE48   LA    R11,48                   SET ID EQ 48               SA0I 11967018
         B     CERR                     WRITE ERROR MSG            SA0I 11970018
CODE49   LA    R11,49                   SET ID EQ 49               SA0I 11973018
         B     CERR                     WRITE ERROR MSG            SA0I 11976018
CODE50   LA    R11,50                   SET ID EQ 50               SA0I 11979018
         B     CERR                     WRITE ERROR MSG            SA0I 11982018
*                                                                  SA0I 11985018
*                                                                  SA0I 11988018
*                                                                 *SA0I 11991018
*  THE FOLLOWING CODE TAKES THE ERROR MESSAGE CODE AND  CONVERTS  *SA0I 11994018
*  IT TO A CODE TO BE PASSED TO THE MESSAGE WRITER. IT ALSO MOVES *SA0I 11997018
*  COLUMN NUMBERS INTO THE ERROR MESSAGES.                        *SA0I 12000018
*                                                                 *SA0I 12003018
CERR     OI    CERRSW,X'F0'             SET ERROR SWITCH           SA0I 12006018
         OI    CWORK,X'40'              TURN ON BYPASS SWITCH      SA0I 12009018
         NI    CWORK+81,X'FC'           TURN SWITCHES OFF          SA0I 12012018
         LR    R0,R11                   LOAD ID INTO REG.          SA0I 12015018
         BCTR  R0,0                     SUBTRACT 1 TO GET CODE     SA0I 12018018
         SLL   R0,8                     POSITION ID IN REG.        SA0I 12021018
         AR    R0,R11                   ADD ID TO CODE             SA0I 12024018
         LA    R15,42                                              SA0I 12027018
         CR    R11,R15                  IS ID GT OR EQ 42          SA0I 12030018
         BNL   NOCOL                    BRANCH ON GT OR EQ 42      SA0I 12033018
         LA    R15,CWORK                GET FIRST COL. OF CARD-1   SA0I 12036018
         SR    R1,R15                   SUBTRACT THIS FROM LOC.PTR SA0I 12039018
         L     R15,AHSMGMDL             LOAD ADDR OF ADDR OF       SA0I 12042018
*                                       FIRST MSG                  SA0I 12045018
         BCTR  R11,0                    SUBTRACT 1 FROM ID         SA0I 12048018
         SLL   R11,2                    MULTIPLY BY 4              SA0I 12051018
         AR    R15,R11                  GET MSG ADDR               SA0I 12054018
         L     R15,0(R15)                                          SA0I 12057018
         CVD   R1,COLDEC                CONVERT COL. NO. TO        SA0I 12060018
*                                       DECIMAL                    SA0I 12063018
         OI    COLDEC+7,X'0F'           CHANGE SIGN TO F           SA0I 12066018
         UNPK  COL(2),COLDEC(8)         UNPACK COL. NO.            SA0I 12069018
         MVC   30(2,R15),COL            PUT COL. NO. INTO LAST 2   SA0I 12072018
*                                       BYTES OF MSG               SA0I 12075018
NOCOL    LR    R1,R0                                               SA0I 12078018
         L     R15,CWRMSGA              WRITE MESSAGE              SA0I 12081018
         BALR  R14,R15                                             SA0I 12084018
         BR    R12                      SCAN MORE                  SA0I 12087018
*                                                                       12120000
CIPERR   L     R9,SYNADMSA             LOAD ADDRESS OF SYNAD INFOA27717 12130019
         MVC   10(79,R9),0(R1)         MOVE INFO TO MSG          A27717 12140019
         FREEMAIN   R,LV=79,A=(1)      FREE GOTTEN CORE          A27717 12150019
         LA    R1,50                   LOAD MSG OFFSET           A27717 12160019
         SLL   R1,8                    AND ADD                   A27717 12170019
         LA    R1,51(R1)               MSG ID                    A27717 12180019
         L     R15,CWRMSGA              LOAD MSG WRITER SUBROUTINE  ADR 12220000
         BALR  R14,R15                  WRITE MESSAGE                   12240000
FROMDDER LA    R15,12                   LOAD CONCODE                    12260000
         LM    R13,R14,CSAVE13          RESTORE REGS 13-14              12280000
         LA    R14,4(,R14)              SET VARIABLE EXIT FOR ERROR     12300000
         RETURN (2,12)                  RESTORE REGS 2-12 AND RETURN    12320000
BLKRTN   LA    R1,BLKERROR              INVALID BLKSIZE  CODE 18   BS0H 12324017
         SLL   R1,8                                                BS0H 12328017
         LA    R4,19                                               BS0H 12332017
         B     ERRTN                    SET UP MESSAGE             BS0H 12336017
DDRTN    LA    R1,DDERROR1              UNABLE TO OPEN SYSIN            12346000
         SLL   R1,8                      MSG CODE 15                    12356000
         LA    R4,16    MSG NUMBER                                      12366000
ERRTN    AR    R1,R4                    R1=MSG CODE AND MSG ID     BS0H 12400017
         L     R15,CWRMSGA   MSG WRITER ADDRESS                         12420000
         BALR  R14,R15   WRITE MSG                                      12440000
         B     FROMDDER                                                 12460000
*                                                                  UL0H 12463017
LABGENER DS    0H                                                  UL0H 12466017
         SR    R8,R8                    ZERO OUT REG 8             UL0H 12469017
         IC    R8,SAVLABIF             LOAD NUMBER OF LABELS       UL0H 12472017
         L     R9,SAVLABIF             FOLLOWING+ADDRESS           UL0H 12475017
         LA    R9,0(R9)                                            UL0H 12478017
         TM    CERRSW,X'F0'             HAS ERROR OCCURRED         SA0I 12479018
         BC    1,LABNUM                 YES,DECREASE LABEL NUMBER  SA0I 12480018
         MVC   0(80,R9),CWORK+1        MOVE LABEL TO LABELPOOL     UL0H 12481017
         LA    R9,80(R9)               INCREASE INDEX IN           UL0H 12484017
         ST    R9,SAVLABIF             LABELPOOL(SAVED ONE)        UL0H 12487017
LABNUM   BCTR  R8,0                     DECREASE NUMBER OF LABELS  SA0I 12490018
         STC   R8,SAVLABIF                                         UL0H 12493017
         LTR   R8,R8                   NUMBER OF LABELS =0?        UL0H 12496017
         BCR   7,R12                   NO : NEXT ONE               UL0H 12499017
         NI    LABINPUT,X'00'          YES  RESET SWITCHES         UL0H 12502017
         SR    R0,R0                   LABINPUT & GENLABEL         UL0H 12505017
         L     R1,GLABADR                                          UL0H 12508017
         ST    R0,0(R1)                                            UL0H 12511017
         MVI   CWORK+72,X'40'           CLEAR CONTINUATION COLUMN M1177 12512018
         BR    R12                     SCAN FURTHER                UL0H 12514017
CCNVRT   LTR   R0,R0            LENGTH OF PARAM ZERO ?           A45131 12516021
         BE    CODE38           YES, PRINT MSG IEB338I           A45131 12518021
         BCTR  R0,0                                                     12523021
         STC   R0,CCNVRT1+1                                             12530000
         OI    CCNVRT1+1,X'70'                                          12540000
CCNVRT1  PACK  CCNVRTWK(8),0(1,R1)                                      12560000
         TM    CCNVRTWK+7,X'0F'         VALID SIGN             @ZA01696 12570003
         BO    VALSIGN                  YES-BRANCH             @ZA01696 12572003
         MVI   CWORK+129,X'00'          RESET PARENTHESIS COUNT@ZA01696 12574003
         B     CODE38                                          @ZA01696 12576003
VALSIGN  CVB   R0,CCNVRTWK                                     @ZA01696 12580003
         BR    R9                                                       12600000
*                                                                       12620000
*CONSTANTS                                                              12640000
*                                                                       12660000
CCNVRTWK DS    1D                       WORK AREA TO UNPACK  A NUMBER   12680000
CSAVE13  DS    2F                       REG 13-14 SAVE AREA             12700000
CSAVE1   DS    2F                       REG 0-1 SAVE AREA               12720000
SYNADMSA DC    V(SYNADMSG)             ADDRESS OF SYNADAF MSG    A27717 12730019
CWRMSGA  DC    V(HWRMSG)                LOC. CONT MSG WRITER SUBR ADDR  12740000
CCDWRA   DC    V(HCDWR)                 LOC. CONT CTL CARD WRTR SUB ADR 12760000
GLABADR  DC    V(GENLABEL)                                         UL0H 12765017
LPADTAD  DC    A(LABPOLAT)                                         UL0H 12770017
COL      DS    CL2                                                 SA0I 12771018
COLDEC   DS    D                                                   SA0I 12772018
AHSMGMDL DC    V(HMSGMDL)                                          SA0I 12773018
SAVLABIF DS    1F                                                  UL0H 12775017
CSIDDA   DS    2F                       SYSIN DD NAME SAVE AREA         12780000
CREGSAVE DS    18F                      REG SAVE AREA                   12800000
CSAVEMDT DS    1F                       MDT SAVE AREA                   12820000
CSOBUF   DS    1F                                                       12840000
CSYSOUTA DS    1F                                                       12860000
CPX      DC    H'1'                                                     12960000
CCOMMSW  DC    X'00'                    SWITCHES                        12980000
CERRSW   DC    X'00'                                               SA0I 12986018
CEXITSSW DC    X'00'                                               SA0I 12992018
IDLENG   DC    X'00'                                               SA0I 12996018
EXITNAME DC    X'00'                                                    12998018
CMAXEXSW DC    X'00'                                                    13000000
COTHSW   DC    X'00'                                                    13020000
CEDITSW  DC    X'00'                                                    13040000
CRDTSW   DC    X'00'                                                    13060000
LABCTSW  DC    X'00'                    LABEL CARD COUNT SWITCH    UL0H 13062017
FIRSTLAB DC    X'00'                                               UL0H 13064017
LABINPUT DC    X'00'                                               UL0H 13066017
TW15M1   DC    H'32767'                                            UL0H 13072017
CCGENERA DC    C'GENERATE'              CONSTANTS                       13080000
CCEXITS  DC    C'EXITS'                                                 13100000
CCMEMBER DC    C'MEMBER'                                                13120000
CCRECORD DC    C'RECORD'                                                13140000
CCMAXNAM DC    C'MAXNAME='                                       A28288 13150019
CCMAXFLD DC    C'MAXFLDS='                                       A28288 13160019
CCMAXGPS DC    C'MAXGPS='                                        A28288 13170019
CCMAXLIT DC    C'MAXLITS='                                       A28288 13180019
CCEXIT1  DC    C'INHDR='                                         A28288 13190019
CCEXIT2  DC    C'OUTHDR='                                        A28288 13200019
CCEXIT3  DC    C'INTLR='                                         A28288 13210019
CCEXIT4  DC    C'OUTTLR='                                        A28288 13220019
CCDATA   DC    C'DATA='                                          A28288 13230019
CCKEY    DC    C'KEY='                                           A28288 13240019
CCIOERRO DC    C'IOERROR='                                       A28288 13250019
CCNAME   DC    C'NAME='                                          A28288 13260019
CCIDENT  DC    C'IDENT='                                         A28288 13270019
CCFIELD  DC    C'FIELD='                                         A28288 13280019
CCLABELS DC    C'LABELS='                                        A28288 13290019
CCTOTAL  DC    C'TOTAL='                                         A28288 13300019
CCYES    DC    C'YES'                                              UL0H 13426017
CCNO     DC    C'NO'                                               UL0H 13428017
CCONLY   DC    C'ONLY'                                             UL0H 13430017
CCALL    DC    C'ALL'                                              UL0H 13432017
CCINPUT  DC    C'INPUT'                                            UL0H 13434017
CCHE     DC    C'HE'                                                    13440000
CCPZ     DC    C'PZ'                                                    13460000
CCZP     DC    C'ZP'                                                    13480000
CSTEDCB  DC    X'0000'                                                  13500000
         DC    X'0000'                                                  13520000
         DC    X'0050'                                                  13540000
         DC    X'0000'                                                  13560000
CH1      DC    H'1'                                                     13580000
CH2      DC    H'2'                                                     13600000
CH3      DC    H'3'                                                     13620000
CH4      DC    H'4'                                                     13640000
CH5      DC    H'5'                                                     13660000
CH6      DC    H'6'                                                     13680000
CH7      DC    H'7'                                                     13700000
CH8      DC    H'8'                                                     13720000
CH10     DC    H'10'                                                    13740000
CH12     DC    H'12'                                                    13760000
         DC    F'64'                                                    13780000
HEXITT   DS    16F                                                 UL0H 13800017
HMDTAD   DS    1F                       SWITCHES                        13820000
HEDCBAD  DC    F'0'                                                     13840000
HRDTAD   DS    1F                                                       13860000
HLITTAD  DS    1F                                                       13880000
LABPOLAT DC    2F'0'                   LABELPOOL ADDRESSES         UL0H 13885017
TOTLAREA DC    F'0'                    TOTALING AREA ADDRESS       UL0H 13890017
LABPROSW DC    X'00'                   LABEL PROCESS SWITCH        UL0H 13895017
HCOPYSW  DC    X'00'                                                    13900000
HPOID    DC    X'00'                                                    13920000
CIDSW    DC  X'00'                                                      13940000
CMAXN    DC    H'0'               MAXNAME CORE LENGTH            A45131 13944021
CMAXF    DC    H'0'               MAXFLDS CORE LENGTH            A45131 13948021
CMAXG    DC    H'0'               MAXGPS CORE LENGTH             A45131 13952021
CMAXL    DC    H'0'               MAXLITS CORE LENGTH            A45131 13956021
CRDTSW2  DC    X'00'                                                    13960000
CRCDSW   DC    X'00'                                                    13980000
CPDSSW   DC    X'00'                                                    14000000
FOURSVK   DC   F'0'                                                     14020000
MXNAMK    DC   F'0'                                                     14040000
CWORK    DC    36F'0'                   WORK AREA               OZ00131 14060002
CWRSW    DS    1C                                                       14080000
CMSGECC  EQU   2                                                        14100000
CMSGUSE  EQU   3                                                        14120000
NRLSTER  EQU   33                                                  UL0H 14130017
DDERROR1 EQU   15                                                       14140000
BLKERROR EQU   19                                                  BS0H 14146017
         ENTRY BLKRTN                                              BS0H 14152017
         ENTRY DDRTN                                                    14160000
         END                                                            14180000
./  ADD  SSI=31230644,NAME=IEBLENP2
*                TITLE 'GENERATE UTILITY- LENGTH PREDICTOR SUBROUTINE'  00020000
*                                                                       00040000
* THIS SUBROUTINE IS EXECUTED EVERY TIME A NEW GROUP OF RECORDS IS      00060000
* ENCOUNTERED IN THE INPUT DATA SET FOR WHICH NEW EDITING PARAMETERS    00080000
* ARE SUPPLIED BY THE USER. ON THE BASES OF THE LENGTHS OF THE FIELDS   00100000
* TO BE MOVED TO OUTPUT, AND THE CONVERSION TO BE DONE ON EACH, IT      00120000
* COMPUTES THE TOTAL LENGTH OF THE OUTPUT RECORDS.                      00140000
*                                                                       00160000
*        *                                                              00180000
*        *     CALL  HPRL,(LENGTH,CUREDCB,SAVEDCB)                      00200000
*        *          LENGTH IS A 4-BYTE FIELD WHERE THE PREDICTED        00220000
*        *          LENGTH IS TO BE STORED                              00240000
*        *          CUREDCB IS A POINTER TO THE CURRENT EDCB            00260000
*        *          SAVEDCB IS A 4-BYTE FIELD WHERE THE ADDRESS OF      00280000
*        *          THE NEXT EDCB IS TO BE STORED                       00300000
*        *                                                              00320000
IEBLENP2 CSECT                                                          00340000
HPRL     SAVE  (14,12)                 SAVE REGS 14 THRU 12             00360000
         LR    2,15                    INITIALIZE BASE REG 2            00380000
         USING HPRL,2                                                   00400000
         L     3,4(1)                   PUT CURRENT EDCB ADDRESS        00420000
         L     7,0(3)                   INTO R7                         00440000
         SR    4,4                      ZERO ACCUMULATOR                00460000
HPRL1    LH    5,HEFL(7)                LOAD INPUT FIELD LENGTH         00480000
         TM    HCVB(7),HCVMSK           TEST FOR CONVERSION             00500000
         BZ    HPRL2                    IF PZ CONVERSION,               00520000
         SLL   5,1                      OUTLENGTH=2*INLENGTH-1          00540000
         BCTR  5,0                                                      00560000
         B     HPRL3                                                    00580000
HPRL2    TM    HCVB(7),HCXMSK          ZP CONVERSION REQD?              00600000
         BZ    HPRL3                   NO                               00620000
         LA    5,2(0,5)                YES- SET REG5= INLENGTH+2        00640000
         SRL   5,1                      OUTLENGTH=(INLENGTH+2)/2        00660000
HPRL3    LH    8,HOUST(7)              LOAD OUTPUT LOCATION IN REG8     00680000
         AR    8,5                      FIND LAST BYTE OF FIELD         00700000
         CR    4,8                      IF HIGHER THAN PREVIOUS         00720000
         BNL   HPRL4                    HIGH BYTE,STORE                 00740000
         LR    4,8                     LOAD R4 WITH NEW HIGH BYTE       00760000
HPRL4    TM    HLFB(7),HLFMSK          TEST FOR LAST FIELD OF RECORD    00780000
         LA    7,8(0,7)                 UPDATE EDCB POINTER             00800000
         BO    HPRL5                                                    00820000
         B     HPRL1                    LOOP FOR NEXT FIELD             00840000
HPRL5    L     3,8(1)                  LOAD LOC. TO STORE NEXT EDCB ADR 00860000
         ST    7,0(3)                  STORE NEXT EDCB ADDR             00880000
         L     3,0(1)                  LOAD LOC. TO STORE LENGTH PREDIC 00900000
         STH   4,0(3)                   STORE LENGTH PREDICTION         00920000
         RETURN (2,12)                 RESTORE REGS 2-12 AND RETURN     00940000
*                                                                       00960000
* CONSTANTS                                                             00980000
*                                                                       01000000
HEFL     EQU   4                       EDCB DISPL FOR INPUT FIELD LENTH 01020000
HCVB     EQU   0                       EDCB DISPLACEMENT FOR CONVERSION 01040000
HLFB     EQU   0                       EDCB DISPLACEMENT FOR LAST FIELD 01060000
HOUST    EQU   6                       EDCB DISPLACEMENT FOR OUTPUT ADR 01080000
HCVMSK   EQU   X'10'                   PZ CONVERSION MASK               01100000
HCXMSK   EQU   X'08'                   ZP CONVERSION MASK               01120000
HLFMSK   EQU   X'80'                   LAST FIELD    MASK               01140000
         ENTRY HPRL                                                     01160000
         END                                                            01180000
./  ADD  SSI=31230650,NAME=IEBMOVE2
*                   TITLE 'GENERATE UTILITY- MOVE SUBROUTINE'           00020000
*                                                                       00040000
* THIS SUBROUTINE MOVES ANY NUMBER OF BYTES OF DATA FROM ONE AREA OF    00060000
* MAIN STORAGE TO ANOTHER. IT IS EXECUTED EVERY TIME DATA IS MOVED FROM 00080000
* ONE INPUT BUFFER TO THE OTHER, ONE OUTPUT BUFFER TO THE OTHER, OR     00100000
* FROM INPUT TO OUTPUT. THE MOVE IS MADE 256 BYTES AT A TIME UNTIL THE  00120000
* FIELD IS EXHAUSTED.                                                   00140000
*                                                                       00160000
*                                                                       00180000
*                   CALL  HMOVE,(OUTAREA,INAREA,LENGTH)                 00200000
*                        OUTAREA IS A POINTER TO OUTPUT AREA            00220000
*                        INAREA  IS A POINTER TO INPUT AREA             00240000
*                        LENGTH CONTAINS THE INPUT RECORD LENGTH        00260000
*                                                                       00280000
*                                                                       00300000
IEBMOVE2 CSECT                                                          00320000
HMOVE    SAVE  (14,12)                 SAVE REGS 14-12                  00340000
         LR    2,15                    INITIALIZE BASE REG 2            00360000
         USING HMOVE,2                                                  00380000
         SR    15,15                                                    00400000
         L     4,8(1)                  LOAD LENGTH FIELD                00420000
         L     5,0(4)                  IN R5                            00440000
         LTR   5,5                     LENGTH GR THAN 0?                00460000
         BP    HMOVE2                  YES                              00480000
         B     HMOVE5                  NO                               00500000
HMOVE2   LR    15,5                    LOAD LENGTH IN REG 5             00520000
         LM    6,7,0(1)                GET OUTPUT AND INPUT AREA POINTR 00540000
         L     9,0(6)                  LOAD OUTPUT AREA ADDR IN R9      00560000
         L     8,0(7)                  LOAD INPUT AREA ADDR IN R8       00580000
HMOVE3   CH    5,HH256                 LENGTH GR THAN 256 BYTES?        00600000
         BH    HMOVE6                  YES                              00620000
         BCTR  5,0                     NO- REDUCE LENGTH BY 1           00640000
         STC   5,HMOVE4+1              INSER EXACT LNGTH IN MOVE INSTR  00660000
HMOVE4   MVC   0(1,9),0(8)             MOVE EXACT NO OF BYTES           00680000
HMOVE5   RETURN (2,12)                 RESTORE REGS 2-12 AND RETURN     00700000
HMOVE6   MVC   0(256,9),0(8)           MOVE 256 BYTES                   00720000
         SH    5,HH256                 REDUCE LENGTH BY 256 BYTES       00740000
         AH    8,HH256                 ADVANCE INPUT ADDR BY 256 BYTES  00760000
         AH    9,HH256                 ADVANCE OUTPUT ADDR BY 256 BYTES 00780000
         B     HMOVE3                  CONTINUE MOVE                    00800000
*                                                                       00820000
* CONSTANTS                                                             00840000
*                                                                       00860000
HH256    DC    H'256'                                                   00880000
         ENTRY HMOVE                                                    00900000
         END                                                            00920000
