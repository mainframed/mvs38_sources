./  ADD  SSI=73190054,NAME=IEBASCAN
SCAN     TITLE 'IEBUPDTE CONTROL CARD SCAN AND ANALYSER'                00020000
*TITLE- IEBUPDTE CONTROL CARD SCAN AND ANALYSIS CSECT- IEBASCAN       * 00040000
*                                                                     * 00060000
*STATUS- CHANGE LEVEL 001                                             * 00080000
*                                                                     * 00100000
*FUNCTION/OPERATION- THIS MODULE IS ABLE TO CREATE AND UPDATE         * 00120000
*   SYMBOLIC LIBRARIES WHICH ARE EITHER PHYSICAL SEQUENTIAL OR        * 00140000
*   PARTITIONED DATA SETS CONTAINED ON DIRECT ACCESS OR TAPE VOLUMES. * 00160000
*                                                                     * 00180000
*   THIS MODULE HANDLES FIXED OR FIXED-BLOCKED RECORDS. IT HAS THE    * 00200000
*   ABITLITY TO HANDLE RECORD OF LOGICAL RECORD LENGTHS UP TO EIGHTY  * 00220000
*   BYTES. IF BLOCKSIZE AND/OR LOGICAL RECORD LENGTH ARE NOT GIVEN    * 00240000
*   BY OPEN TIME, UNBLOCKED RECORDS OF 80 BYTES IS ASSUMED AND A      * 00260000
*   WARNING MESSAGE IS GIVEN ON THE LOG OUT DEVICE.                   * 00280000
*                                                                     * 00300000
*   THIS MODULE CAN-                                                  * 00320000
*                                                                     * 00340000
*   1. CREATE A NEW PARTITIONED OR PHYSICAL SEQUENTIAL DATA SET       * 00360000
*                                                                     * 00380000
*   2. SEQUENCE THE NEW DATA SET OR RESEQUENCE AN OLD ONE             * 00400000
*                                                                     * 00420000
*   3. REPRODUCE OR REPLACE A MEMBER OR A DATA SET                    * 00440000
*                                                                     * 00460000
*   4. PRODUCE A PARTITIONED DATA SET FROM A PHYSICAL SEQUENTIAL      * 00480000
*   MASTER OR THE CONVERSE.                                           * 00500000
*                                                                     * 00520000
*   4. ADD A MEMBER TO A PARTITIONED DATA SET.                        * 00540000
*                                                                     * 00560000
*   5. ASSIGN AN ALIAS NAME TO ANY MEMBER UPDATED                     * 00580000
*                                                                     * 00600000
*   6. CHANGE RECORDS IN A DATA SET                                   * 00620000
*                                                                     * 00640000
*   7. HANDLE RECORDS WITH NON-STANDARD SEQUENCE NUMBER FIELDS AND    * 00660000
*   LENGTHS OF SEQUENCE NUMBERS FROM 1 TO 8 CHARACTERS.               * 00680000
*                                                                     * 00700000
*   8. UPDATE ONLY SPECIFIED PORTION OF DATA SET RECORDS.             * 00720000
*                                                                     * 00740000
*   9. UPDATE INPLACE DATA SETS OR MEMBERS ON DIRECT ACCESS VOLUMES.  * 00760000
*                                                                     * 00780000
*ENTRY POINTS- ENTERED FROM THE OPERATING SYSTEM AT 'IEBUPDTE'.       * 00800000
*                                                                     * 00820000
*INPUT- SYSIN WHICH CONSISTS OF CONTROL CARDS AND LOGICAL DATA        * 00840000
*   RECORDS FOR INSERTION OR REPLACEMENT, THE INPUT DATA SET.         * 00860000
*                                                                     * 00880000
*       SYSUT1 WHICH DEFINES THE 'OLD MASTER' DATA SET WHICH MAY BE   * 00900000
*   PARTITIONED OR PHYSICAL SEQUENTIAL IN ORGANIZATION.               * 00920000
*                                                                     * 00940000
*OUTPUT-SYSPRINT WHICH CONTAINS DIAGNOSTIC MESSAGES, THE CONTENTS OF  * 00960000
*   SYSIN AND-IF THE 'LIST=ALL' CONDITION IS PRIMED- THE ENTIRE       * 00980000
*   'NEW MASTER' IS LISTED ON THE DEVICE DESIGNATED.                  * 01000000
*                                                                     * 01020000
*       SYSUT2 WHICH DEFINES THE 'NEW MASTER' DATA SET. IT WILL BE A  * 01040000
*   COMPOSITE OF THE SYSIN AND SYSUT1 DATA SETS. IT CAN BE EITHER     * 01060000
*   PARTITIONED OR PHYSICAL SEQUENTIAL IN ORGANIZATION.               * 01080000
*                                                                     * 01100000
*EXITS- NORMAL- A RETURN IS GIVEN TO THE SCHEDULAR MODULE OF THE      * 01120000
*   OPERATING SYSTEM. CONDITION CODE RETURNED ON A SUCCESSFUL RUN     * 01140000
*   WILL BE ZERO.                                                     * 01160000
*                                                                     * 01180000
*EXITS- ERROR- IF AN ERROR OCCURS, A CODE IS STORED, A MESSAGE        * 01200000
*   GIVEN TO THE USER EXPLAINING THE ERROR CONDITION AND A            * 01220000
*   RETURN TO THE OPERATING SYSTEM SCHEDULAR MODULE IS GIVEN.         * 01240000
*   RETURN CODE GIVEN ARE-                                            * 01260000
*   00 NORMAL TERMINATION OF A SUCCESSFUL RUN                         * 01280000
*   04 ERROR WITHIN A MEMBER- WILL TRY TO PROCESS NEXT MEMBER IF PODS * 01300000
*   12 UNRECOVERABLE ERROR- TERMINATION OF JOB.                       * 01320000
*   16 ERROR IN LABEL HANDLING IN USERS ROUTINE- TERMINATION OF JOB   * 01340000
*                                                                     * 01360000
*EXTERNAL ROUTINES- I/O HANDLED AT READ/WRITE LEVEL, GETMAIN, LINK,   * 01380000
*   BLDL, FIND, STOW USED.                                            * 01400000
*                                                                     * 01420000
*TABLES/WORK AREAS-                                                   * 01440000
*   -KEYTAB- LIST OF VALID KEY WORDS USED ON CONTROL CARDS            * 01460000
*   -COMDTABL- LIST OF VALID COMMAND WORDS USED ON CONTROL CARDS      * 01480000
*   -SWITCHRD- BUFFER CONTAINING CONTROL CARD AND SWITCHES USED       * 01500000
*   BY CARD SCAN ROUTINE.                                             * 01520000
*   -LOGOUTAR- BUFFER WHICH IS USED BY LOG OUT ROUTINE FOR MESSAGES.  * 01540000
*   -STARTAB- TABLE OF SWITCHES WHICH ARE RESET TO ZERO UPON ENTRY    * 01560000
*   TO MODULE. ALL SWITCHES NEEDING REINITIALIZATION SHOULD BE PUT    * 01580000
*   INTO THIS TABLE.                                                  * 01600000
*                                                                     * 01620000
*ATTRIBUTES- SERIAL REUSABLE, BLOCK LOADS                               01640000
*                                                                     * 01660000
*   THIS CSECT- 1. SCANS CONTROL STATEMENTS AND RETURNS POINTERS TO   * 01680000
*        THE 'TOSCAN' ROUTINE WHICH ANALYZES COMMANDS, KEYWORDS, AND  * 01700000
*        PARAMETERS.                                                  * 01720000
*               2. SWITCHRD BUFFER CONTAINS THE CONTROL STATEMENT AS  * 01740000
*        WELL AS THE SWITCHES AND BUFFERS NEEDED.                     * 01760000
*               3. 'LENGTH' REGISTER IS PASSED BACK FROM 'READCC'     * 01780000
*        CONTAINING THE NUMBER OF BYTES IN THE COMMAND, KEYWORD, OR   * 01800000
*        PARAMETER ENCOUNTERED DURING THE SCAN.                       * 01820000
*               4. 'SCANADR' REGISTER POINTS TO THE START OF THE      * 01840000
*        COMMAND/KEYWORD/PARAMETER.                                   * 01860000
*               5. 'KEYTAB' IS A TABLE CONTAINING THE VALID KEYWORDS. * 01880000
*               6. 'COMDTABL' IS A TABLE OF VALID COMMAND WORDS.      * 01900000
*               7. EACH COMMAND WORD AND KEYWORD HAS A ROUTINE TO     * 01920000
*        ANALYZE THE PARAMETERS ASSOCIATED WITH IT.                   * 01940000
*                                                                     * 01960000
         EJECT                                                          01980000
*     CHECKING OF VALID PARAMETER COMBINATIONS IS DONE IN 'SEQCKOUT'. * 02000000
*  'PARMSW' IS SET AS FOLLOWS-                                        * 02020000
*        KEYWORD             SETTING OF PARMSW                        * 02040000
*         SEQ1                    '01'                                * 02060000
*         SEQ2                    '02'                                * 02080000
*         INCR                    '04'                                * 02100000
*         NEW1                    '08'                                * 02120000
*         NAME                    '10'                                * 02140000
*         NEW                     '20'                                * 02160000
*         MEMBER                  '40'                                * 02180000
*                                                                     * 02200000
*     SYMBOLIC REGISTER NOTATION   GR0 - GR15                           02220000
GR0      EQU   0                                                        02240000
GR1      EQU   1                                                        02260000
GR2      EQU   2                                                        02280000
GR3      EQU   3                                                        02300000
GR4      EQU   4                       REGISTER RESERVED FOR CSECT1     02320000
GR5      EQU   5                                                        02340000
GR6      EQU   6                                                        02360000
GR7      EQU   7                                                        02380000
GR8      EQU   8                                                        02400000
GR9      EQU   9                                                        02420000
GR10     EQU   10                                                       02440000
GR11     EQU   11                                                       02460000
GR12     EQU   12                                                       02480000
GR13     EQU   13                                                       02500000
GR14     EQU   14                                                       02520000
GR15     EQU   15                                                       02540000
SWF0     EQU   X'F0'                   DOUBLE PARM FLAGS        YM07522 02542002
SWF8     EQU   X'F8'                                            YM07522 02544002
SWFC     EQU   X'FC'                                            YM07522 02546002
SWFE     EQU   X'FE'                                            YM07522 02548002
D0       EQU   0                       DISPLACEMENT OF 0        YM07522 02549002
D1       EQU   1                       DISPLACEMENT OF 1        YM07522 02550002
D2       EQU   2                       DISPLACEMENT OF 2        YM07522 02551002
D7       EQU   7                       DISPLACEMENT OF 7        YM07522 02552002
L1       EQU   1                       LENGTH OF 1              YM07522 02553002
L2       EQU   2                       LENGTH OF 2              YM07522 02554002
L3       EQU   3                       LENGTH OF 3              YM07522 02555002
L7       EQU   7                       LENGTH OF 7              YM07522 02556002
L8       EQU   8                       LENGTH OF 8              YM07522 02557002
LODIG    EQU   C'0'                    LOWEST VALID DIGIT       YM07522 02558002
HIDIG    EQU   C'9'                    HIGHEST VALID DIGIT      YM07522 02559002
IEBASCAN CSECT                                                          02580000
*1101027400,047400-047800,145200,147600-148200,148800-151400,      UL0H 02581017
*1101152400-159800,166200-213400,219000                            UL0H 02582017
*1132                                                              MA0H 02584017
*1132                                                              4929 02586017
*1132                                                              6701 02588017
*1132                                                              6728 02592017
*1132                                                              7198 02596017
*1101132200                                                       20497 02597017
*1132                                                             20194 02598017
*1132                                                             19013 02599017
*1132                                                            PTM901 02599517
* 077800-078150                                                  A30501 02601519
* 125200-125400,125600                                           A25432 02603519
*                                                                A24189 02603921
*                                                                A25924 02605519
* 037680-036810,037600-037800,042400-042600,069400-069600        A30480 02605920
* 118600-118800,145400-145600                                    A30480 02606320
* 070920,130600,141000                                           A33286 02606720
* 050600-050800,055400-058000                                    A33314 02607120
* 084600-084800                                                  A33318 02607320
* 160150                                                         A31449 02607420
*                                                                A36128 02607521
*A144300,144320                                                  A38748 02609521
*A078100                                                         A41839 02609921
*A158150                                                         A45121 02615921
*A135900,135920,136700-136740                                   OX00189 02618901
*D135800                                                        OX00189 02621901
*D061400-061600,108200-109800                                    A54081 02625901
*A037150,037250,037350,042100                                   YA01670 02626902
*D037200,042200                                                 YA01670 02634002
*A029100,029120,029500,029520,132700,132720,132900,133300       YA01677 02635002
*A133320,156820,156840                                          YA01677 02636002
*D133000                                                        YA01677 02637002
*A25420-25590,89060,89420-89480,95820-95840,96010-96110         YM07522 02638002
*A96610-96780,140410-140470,140820,143210,143610-143740,216410  YM07522 02639002
*D136750                                                        YM07522 02639202
*C89200,89600,134800,135200,135400,135600,135800,136000,136400  YM07522 02639402
*C140800,141000,143600                                          YM07522 02639602
*A161100-161160,161500-161540                                  @YA02570 02642002
*D161200                                                       @YA02570 02644002
*A160884-160924                                                @YA02571 02649202
*C160932                                                       @YA02571 02651202
*A076100-076540,076410-076500                                  @ZA01682 02651302
*D076200,076500                                                @ZA01682 02651402
*C076600                                                       @ZA01690 02651502
*A074220-074320                                                @ZA01691 02651902
*C073800,074200                                                @ZA01691 02656402
*C 070940                                                      @ZA01692 02656602
*D 074284,074288                                               @ZA01692 02656802
*A 078500-078560                                               @ZA01693 02656902
*C 078400                                                      @ZA01693 02657002
*A 027100,040700-040784                                        @ZA04442 02659000
*A 078544-078548                                               @ZA07321 02659499
*A 040900,041100-041468,042020,042040   @XA16051=(ORG)@YA14019=@ZA16462 02659899
*A 156880,214100,219550-219590          @XA16051=(ORG)@YA14019=@ZA16462 02660299
*C 041000,042000                        @XA16051=(ORG)@YA14019=@ZA16462 02660699
*A130500,130700-131000                  @AY19768=(ORG)@AX16973=@AZ27974 02660700
*C131050,158000                         @AY19768=(ORG)@AX16973=@AZ27974 02660800
         SAVE  (14,12)                                                  02661002
         BALR  GR2,0                   BASE ADDRESS ALL CSECTS EXCEPT 1 02665502
         USING NEXT,2                  CSECT1 USES GR4                  02670002
         USING IEBUPCON,12                                              02675002
NEXT     ST    GR13,SAVE13X            SAVE REGISTER 13                 02680000
         LA    GR13,REGSAVE            REGISTER SAVE AREA               02700000
         USING REGSAVE,GR13                                    @ZA04442 02710000
TOSCAN   CLI   CCSCANSW,BIT01          IS THIS RETURN FROM CONTINUATION 02720000
         BE    SCANLINK                                            UL0H 02740017
         TM    SWITCHRD,BIT40          ARE ALL PARAMETERS COMPLETE      02760000
         BC    14,SCANLINK             NO- KEEP SCANNING                02780000
SEQCKOUT CLI   COMDCD,X'0E'            JUST ANALYSED A COMMAND CARD     02800000
         BE    CHEKPARM                YES- CHECK TH PARAMETERS         02820000
         BAL   GR14,CARDPRNT           PRINT CARD                       02840000
         MVI   PRINTED,X'0F'           FLAG AS CARD PRINTED             02860000
         CLC   DELTSEQ1(8),DELTSEQ2    COMPARE IF SEQ1 MORE THAN SEQ2   02880000
         BH    SCANERR                 YES- ERROR                       02900000
         CLI   NUMBR2SW,X'0F'     SECOND NUMBER STMT ANALYSED   YA01677 02906002
         BE    NUMBR2             YES,BRANCH TO TEST IF INSERT  YA01677 02912002
         CLI   NUMBRSW,X'0E'           JUST ANALYSED NUMBER STATEMENT   02920000
         BNE   SKIPCOMP                NO- CONTINUE                     02940000
NUMBR2   CLI   OMEND,X'0F'        IS OLD MASTER FINISHED?       YA01677 02946002
         BE    SEQERR             YES,GO TO GIVE ERROR MSG      YA01677 02952002
         MVI   NUMBRSW,X'0F'           FLAG AS NUMBER                   02960000
         TM    INSERTSW,X'0F'          TEST FOR BLOCK INSERT            02980000
         BC    1,TESTPARS              FIRST INSERT                     03000000
         BC    4,PLAINUMB              INSERT AFTER INSERT IN EFFECT    03020000
         CLI   PARMSW,X'0C'            NEW1 AND INCR PARAMETERS GIVEN   03040000
         BE    CHK4CHNG                YES- NO SEQ FIELDS CHECK CHANGE  03060000
         TM    ADDSW,X'0E'             ADD OPERATION                    03080000
         BC    1,SKIPCOMP              YES- IGNORE SEQ1 OR 2 FIELDS     03100000
         TM    REPLSW,X'0E'            REPLACE OPERATION                03120000
         BC    1,SKIPCOMP              YES- IGNORE SEQ1 OR 2 FIELDS     03140000
         CLI   PARMSW,X'0F'            ALL FIELDS ON NUMBER STATEMENT   03160000
         BE    COMPNMBR                YES- CHECK IF SEQ2 GREATER SEQ1  03180000
         CLI   PARMSW,X'0D'            SEQ1 MISSING IF NOT '0D' OR '0F' 03200000
         BNE   SCANERR                 SEQ1 MISSING- INVALID            03220000
         CLI   INPLCSW,X'0F'           UPDATE IN PLACE                  03240000
         BE    SKIPCOMP                SEQ2 MISSING                     03260000
         CLI   RENUMALL,X'0F'          RENUMBERING ALL DATA SET         03280000
         BNE   SCANERR                 NO- SEQ2 FIELD MISSING           03300000
         B     SKIPCOMP                CONTINUE                         03320000
CHK4CHNG TM    CHNGESW,X'0E'           CHANGE OPERATION                 03340000
         BC    12,SKIPCOMP             NO- CONTINUE NO SEQ1 OR 2        03360000
         MVI   RENUMALL,X'0F'          FORCE RENUMBERING OF ENTIRE DATA 03380000
         B     SKIPCOMP                FORCE RENUMBERING OF DATA SET    03400000
PLAINUMB CLI   INSRTRD,X'01'           PLAIN NUMBER WHILE INSERT EFFECT 03420000
         BNE   SCANERR                 YES- ILLEGAL MIXED NUMBER/INSERT 03440000
         MVI   INSERTSW,X'1F'          SET AS NEXT BLOCK INSERT + FORCE 03460000
         MVI   INSRTRD,RESET0          RESET SWITCH                     03480000
         TM    PARMSW,X'01'            SEQ1 GIVEN FOR INSERT            03500000
         BC    8,SCANERR               NO- ERROR                        03520000
         B     SKIPCOMP                OK- CONTINUE                     03540000
COMPNMBR CLC   NUMRSEQ1(8),NUMRSEQ2    COMPARE SEQ1 AND SEQ2            03560000
         BH    SCANERR                 IF SEQUENCE 1 MORE THAN 2 -ERROR 03580000
SKIPCOMP CLI   FIRSENTR,BIT10          FIRST ENTRY                      03600000
         BE    RESET                   YES- CHECK DCB SETTING           03620000
RESETPAR MVI   PARMSW,RESET0           RESET PARAMETER SWITCH           03640000
         MVI   PRINTED,RESET0          RESET CARD PRINTED SWITCH        03660000
         MVI   FIRSTCON,X'00'          RESET CONT. CARD PRINT SWITCUL0H 03661017
         CLI   ENDONLY,X'0F'           ACCEPT ENDUP ONLY           4929 03663017
         BNE   READNOW                 NO NOT FLUSHING             4929 03666017
         CLI   INPLCSW,X'0F'           UPDATE INPLACE              4929 03669017
         LA    GR11,UPDATMSG           UPDATE ERROR CODE           4929 03672017
         BE    STOWIT3                 SHOULD NOT HAVE ANOTHER     4929 03675017
         TM    CTONLYSW,X'11'     ALL INPUT FROM SYSIN           A30480 03678020
         BZ    OLDTO              NO.. OLD TO                    A30480 03681020
         CLI   PSSWNM,X'0F'            NM SEQUENTIAL               4929 03684017
         BE    REDNW                   NO- PARTITIONED             4929 03687017
         B     STOWIT2                 SEQUENTIAL                  4929 03690017
OLDTO    CLI   PSSWOM,X'0F'            OLD MASTER SEQUENTIAL       4929 03693017
         BE    REDNW                   NO- PARTITIONED             4929 03696017
         B     STOWIT2                 SEQUENTIAL                  4929 03699017
REDNW    MVI   ENDONLY,X'00'           CLEAR SWITCH                4929 03702017
         B     READNOW                 RETURN TO PROCESS           4929 03705017
RESET    CLI   FIRSTCON,X'0F'     CONTINUATION SWITCH SET?      YA01670 03712002
         BE    TESTORG            YES BRANCH TO TEST DSORG      YA01670 03720002
         MVI   FIRSENTR,RESET0    RESET FIRST ENTRY SWITCH      YA01670 03730002
         L     GR11,DCBNM              NEW MASTER DCB ADDRESS           03740000
         TM    CTONLYSW,X'11'     ALL INPUT FROM SYSIN           A30480 03760020
         BM    CHKIFDIF           YES.. SET UP DCBNM             A30480 03780020
         CLI   PARMSW,X'00'            BOTH PS- NO NAME,NEW OR MEMBER   03800000
         BNE   RESETPAR                NEW, NAME OR MEMBER ESTABLISHED  03820000
         L     GR10,DCBOM              OLD MASTER DCB                   03840000
         MVI   BDSORG(GR10),PSDSET     SET OLD MASTER AS PS        3628 03860015
SETNM2PS MVI   BDSORG(GR11),PSDSET     SET NEW MASTER AS PS        3628 03880015
         B     RESETPAR                CONTINUE                         03900000
CHKIFDIF TM    PARMSW,X'10'            'NAME' KEYWORD PRESENT           03920000
         BC    14,SETNM2PS             NO- SET NEW MASTER AS PS         03940000
         B     RESETPAR                CONTINUE- NM SET TO PO- FLAGDCBP 03960000
CHEKPARM MVI   COMDCD,X'0F'            FLAG AS COMMAND PROCESSED        03980000
         CLI   FIRSTCON,X'0F'          LAST PART OF COMMAND CONTINUED   04000000
         BE    JUSTPRNT                YES- JUST PRINT THIS PART        04020000
         CLI   FIRSENTR,BIT10          FIRST ENTRY                      04040000
         BNE   NOTFIRST                NO- PRINT HEADER                 04060000
         CLI   PSSWNM,X'0F'            NEW MASTER PARTITIONED  @ZA04442 04070040
         BNE   JUSTPRNT                NO,BRANCH               @ZA04442 04072040
         CLI   PSSWOM,X'00'            OLD MASTER SEQUENTIAL   @ZA04442 04074040
         BNE   JUSTPRNT                NO,BRANCH               @ZA04442 04076040
         CLI   PARMSW,X'60'   NEW AND MEMBER PARM IN CNTL STMT @ZA04442 04078040
         BNE   SCANERR               NO,BRANCH TO GIVE ERR MSG @ZA04442 04078440
JUSTPRNT LA    GR14,RESET              RETURN FROM PRINT                04080000
CARDPRNT ST    GR14,COMEBACK           STORE RETURN REGISTER   @ZA16462 04090099
PRNTMORE MVI   ASISMSW,X'0F'           FORCE PRINTING OF CARD  @ZA16462 04100099
PRINTHD  TM    COL72LG,BIT80           COL72 NOT BLANK?        @ZA16462 04110099
         BNO   PRINTY                  BLANK, GO PRINT         @ZA16462 04112099
         BAL   GR14,PRINTY             NOT BLANK, GO PRINT     @ZA16462 04114099
         CLI   EODCTSW,X'0F'           EOF ON SYSIN?           @ZA16462 04116099
         BE    COMMERR                 YES, SCANERR MSG        @ZA16462 04118099
         L     GR1,DCBCT               SYSIN DCB               @ZA16462 04118499
         GET   (1)                                             @ZA16462 04118899
         MVC   SWITCHRD+1(80),0(GR1)   MOVE CARD TO BUFFER     @ZA16462 04119299
         CLC   SWITCHRD+1(15),COMMCARD VALID COMMENT CARD?     @ZA16462 04119699
         BNE   COMMERR                 NO, GIVE SCANNERR MSG   @ZA16462 04119799
         CLI   SWITCHRD+72,X'40'       COL72 BLANK?            @ZA16462 04129299
         BNE   GOPRINT                NO, BRANCH TO PRINT MORE @ZA16462 04133699
         NI    COL72LG,X'7F'           RESET COL72 SWITCH      @ZA16462 04138099
         L     GR14,COMEBACK           RESTOR RETURN REG       @ZA16462 04142499
GOPRINT  B     PRNTMORE                GO PRINT CARD           @ZA16462 04146899
PRINTY   MVC   LOGOUTAR+7(80),SWITCHRD+1         MOVE CARD TO BUFFER    04151244
         L     GR15,PRIMEWRT           ADDRESS OF MESSAGE ROUTINE       04155600
         BR    GR15                    RETURN PRESET IN GR14            04160000
NOTFIRST MVI   PRIMESW,X'0E'           FORCE PRINTING OF HEADER         04180000
         LA    GR14,TESTORG            PRINT HEADER AND CARD   @ZA16462 04200099
         ST    GR14,COMEBACK                                   @ZA16462 04202099
         B     PRINTHD                                         @ZA16462 04204099
TESTORG  MVI   PRINTED,X'0F'      FLAG AS CARD ALREADY PRINTED  YA01670 04210002
         TM    CTONLYSW,X'11'     ALL INPUT FROM SYSIN           A30480 04240020
         BM    SAMETYPE           YES.. SPECIAL CASE             A30480 04260020
         CLC   PSSWOM(1),PSSWNM        ORGANIZATION SAME OM/NM          04280000
         BE    SAMETYPE                YES- CHECK SOME MORE             04300000
         CLI   NEWNAME,X'0F'           PS TO PO ORGANIZATION            04320000
         BE    PS2PO                   YES                              04340000
         CLI   PARMSW,X'30'            PO TO PS- 'NAME, NEW' ONLY       04360000
         B     VALIDITY                TEST IF VALID                    04380000
TESTPARS CLI   RENUMALL,X'0F'          RENUMBER ALL OF NEW MASTER       04400000
         BE    SCANERR                 YES- INVALID SEQ1=ALL            04420000
         CLI   PARMSW,X'0D'            SEQ1,INCR,NEW1, ON STATEMENT     04440000
         BL    SCANERR                 NO- SOMETHING MISSING            04460000
         CLC   NUMRSEQ1(8),NEW1NUMB    SEQ1 LOWER THAN NEW1 FOR INSERT  04480000
         BNL   SCANERR                 NO- CONTROL STATEMENT ERROR      04500000
         B     SKIPCOMP                CONTINUE                         04520000
SAMETYPE CLI   PSSWNM,X'00'            NEW MASTER PS OR BOTH PS         04540000
         BE    CHKPRMSW                YES CHECK PARAMETERS             04560000
         TM    PARMSW,X'10'            BOTH PO OR ONLY HAVE NM 'NAME'   04580000
         BC    8,SCANERR               NO 'NAME' CONTROL STATEMENT ERR. 04600000
         B     SKIPCOMP                PARAMETER ARE OK CONTINUE        04620000
CHKPRMSW CLI   PARMSW,X'00'            SHOULD HAVE NO 'NAME,NEW,MEMBER' 04640000
         B     VALIDITY                TEST IF VALID                    04660000
PS2PO    CLI   PARMSW,X'60'            ALLOW ONLY 'NEW' AND 'MEMBER'    04680000
VALIDITY BNE   SCANERR                 NO- CONTROL STATEMENT ERROR      04700000
         B     SKIPCOMP                PARAMETERS OK CONTINUE           04720000
SCANLINK L     GR15,RDCARD                                         UL0H 04730017
         BALR  GR14,GR15               SCAN FOR NEXT PARAMETER     UL0H 04740017
         LM    LENGTH,SCANADR,STOREG   RESTORE SCAN REGISTERS (0,1)UL0H 04750017
         CLI   LABEL2SW,X'F0'          HAS TRALER PROC BEEN REQUESTUL0H 04760017
         BE    CHEKCOMD                                            UL0H 04770017
SCANNED  TM    SWITCHRD,BIT80          IS ERROR BIT ON             UL0H 04780017
         BC    1,SCANERR               YES- CONTROL STATEMENT ERROR     04800000
         TM    SWITCHRD,BIT40          LAST PARAMETER IN CARD ENCOUNTER 04820000
         BC    1,COMMTEST              TEST FOR COMMAND OR KEY WORD     04840000
         LTR   LENGTH,LENGTH           IS SCAN LENGTH ZERO              04860000
         BZ    SCANERR                 YES- CONTROL STATEMENT ERROR     04880000
         LTR   SCANADR,SCANADR         SCAN ADDRESS POINTER ZERO        04900000
         BZ    SCANERR                 YES- CONTROL STATEMENT ERROR     04920000
COMMTEST TM    SWITCHRD,BIT08          IS THIS A COMMAND WORD           04940000
         BC    1,OPRLUP                YES- CHECK COMMAND               04960000
         TM    SWITCHRD,BIT04          IS THIS A KEYWORD                04980000
         BC    14,SEQCKOUT             CARD SCAN MUST BE COMPLETED      05000000
         SPACE 1                                                        05020000
*   KEYWORD LOOKUP ROUTINE                                              05040000
         L     GR7,KEYCHECK            GET DISPL. IN STARTTAB    A33314 05050020
         L     GR5,KEYSTART(GR7)       GET START ADDR. OF KEYTAB A33314 05060020
         L     GR7,KEYSTART+4(GR7)     GET END ADDR. OF KEYTAB   A33314 05070020
         B     SCANTBL                 SEARCH FOR KEY WORD              05100000
*   COMMAND WORD LOOKUP ROUTINE                                         05120000
OPRLUP   LA    GR5,COMDTABL            START OF COMMAND TABLE           05140000
         LA    GR7,1                   PREPARE TO INCREMENT LENGTH20194 05146017
         AR    LENGTH,GR7              INSURE BLANK FOLLOWS COMAND20194 05152017
         LA    GR7,COMDEND             END OF COMMAND TABLE             05160000
         MVI   KEYCHECK+3,X'00'   SET DISPL. FOR KEY START TAB   A33314 05170020
SCANTBL  STC   LENGTH,SAVLGTH          SAVE LENGTH REGISTER (0)         05180000
         CLI   SAVLGTH,8               TEST IF LENGTH LESS THAN 8       05200000
         BH    SCANERR                 NO- LENGTH EXCEEDS 8 ERROR       05220000
         LA    GR6,12                  INCREMENT VALUE                  05240000
         MVC   SARG(8),BLANKS8         CLEAR SEARCH ARGUMENT TO BLANKS  05260000
         LR    GR9,LENGTH              BE SURE REGISTER IS EXECUTABLE   05280000
         BCTR  GR9,0                   DECREMENT LENGTH FOR EXECUTE     05300000
         EX    GR9,OPRLUP3             MOVE PARAMETER TO STORAGE AREA   05320000
OPRCMP   CLC   SARG(8),0(GR5)          TEST IF SEARCH ARGUMENT IN TABLE 05340000
         BNE   OPRLUP2                 NO- CONTINUE SCAN OF TABLE       05360000
         LA    GR5,8(GR5)              ENTRY ADDRESS OF ROUTINE         05380000
         LM    LENGTH,SCANADR,STOREG   LOAD SCAN REGISTERS ( 0 AND 1)   05400000
         BR    GR5                     ENTER PROPER ROUTINE             05420000
OPRLUP2  BXLE  GR5,GR6,OPRCMP          LOOP TO CONTINUE SEARCH          05440000
         B     SCANERR                 COMMAND INVALID- NOT IN TABLE    05460000
* START AND END ADDRESSES OF VALID KEYWORDS IN KEYTAB            A33314 05462020
KEYCHECK DC    F'0'               DISPLACEMENT IN THIS TABLE     A33314 05464020
KEYSTART DC    A(OTHKEYS)         FIRST KEY FOR FUNCTION STMT    A33314 05466020
         DC    A(KEYEND)          LAST KEY FOR FUNCTION STMT     A33314 05468020
         DC    A(NMRKEYS)         FIRST KEY FOR NUMBER STMT      A33314 05470020
         DC    A(KEYEND1)         LAST KEY FOR NUMBER STMT       A33314 05472020
         DC    A(DELKEYS)         FIRST KEY FOR DELETE STMT      A33314 05474020
         DC    A(KEYEND2)         LAST KEY FOR DELETE STMT       A33314 05476020
         EJECT                                                          05480000
*    KEYWORD LOOKUP TABLE                                               05500000
         DS    0F                                                       05520000
* TABLE OF VALID KEYWORDS AND ADDRESSES OF THE ANALYSIS ROUTINES A33314 05530020
DELKEYS  EQU   *                  FIRST VALID KEY FOR DELETE     A33314 05540020
NMRKEYS  EQU   *                  FIRST VALID KEY FOR NUMBER     A33314 05550020
         DC    C'SEQ1    '                                       A33314 05560020
         B     CHKSEQ1                                           A33314 05570020
KEYEND2  EQU   *                  LAST VALID KEY FOR DELETE      A33314 05580020
         DC    C'SEQ2    '                                       A33314 05590020
         B     CHKSEQ2                                           A33314 05600020
         DC    C'INCR    '                                       A33314 05610020
         B     CHKINCR                                           A33314 05620020
         DC    C'NEW1    '                                       A33314 05630020
         B     CHKNEW1                                           A33314 05640020
KEYEND1  EQU   *                  LAST VALID KEY FOR NUMBER      A33314 05650020
         DC    C'INSERT  '                                       A33314 05660020
         B     CHKINSRT                                          A33314 05670020
OTHKEYS  EQU   *                  FIRST VALID KEY FOR FUNCTION   A33314 05680020
         DC    C'LIST    '                                       A33314 05690020
         B     CHKLIST                                           A33314 05700020
         DC    C'NAME    '                                       A33314 05710020
         B     CHKNAME                                           A33314 05720020
         DC    C'DATA    '              DATA FOR NO LABEL        A45205 05770022
         B     CHKDATA                  CHECK IF VALID           A45205 05780022
         DC    C'COLUMN  '                                              05820000
         B     CHKCOLMN                                                 05840000
         DC    C'SEQFLD  '                                              05860000
         B     CHKIDENT                                                 05880000
         DC    C'MEMBER  '                                              05900000
         B     CHKMEMBR                                                 05920000
         DC    C'NEW     '                                              05940000
         B     CHKNEW                                                   05960000
         DC    C'UPDATE  '                                              05980000
         B     UPDATANL                                                 06000000
         DC    C'LEVEL   '                                              06020000
         B     CHKLEVEL                                                 06040000
         DC    C'SSI     '                                              06060000
         B     CHKSSI                                                   06080000
         DC    C'SOURCE  '                                              06100000
         B     CHKSORCE                                                 06120000
         DC    C'INHDR   '                                              06180000
         B     CHKINHDR                                                 06200000
         DC    C'INTLR   '                                              06220000
         B     CHKINTRL                                                 06240000
         DC    C'OUTHDR  '                                              06260000
         B     CHKOUTHD                                                 06280000
         DC    C'TOTAL   '                                              06286018
         B     CHKTOTAL                                            UL0H 06293017
KEYEND   DC    C'OUTTLR  '             END OF TABLE OF KEY WORDS        06300000
         B     CKOUTTLR                                                 06320000
*    COMMAND LOOKUP TABLE                                               06340000
         DS    0F                                                       06360000
COMDTABL DC    C'ADD     '             START OF COMMAND WORD TABLE      06380000
         B     ADDANAL                 ADDRESS OF COMMAND ANALYSIS      06400000
LABEL    DC    C'LABEL   '                                         UL0H 06406017
         B     LABELANL                                            UL0H 06413017
         DC    C'CHANGE  '                                              06420000
         B     CHNGEANL                                                 06440000
         DC    C'NUMBER  '                                              06460000
         B     NUMBRANL                                                 06480000
         DC    C'DELETE  '                                              06500000
         B     DELETANL                                                 06520000
         DC    C'REPL    '                                              06540000
         B     REPLANAL                                                 06560000
         DC    C'REPRO   '                                              06580000
         B     REPROANL                                                 06600000
         DC    C'ALIAS   '                                              06620000
         B     ALIASANL                                                 06640000
COMDEND  DC    C'ENDUP   '             END OF COMMAND WORD TABLE        06660000
         B     ENDUPANL                                                 06680000
         EJECT                                                          06700000
*********************************************************************** 06720000
***        CONTROL STATEMENT KEYWORD/PARAMETER PROCESSING           *** 06740000
*********************************************************************** 06760000
         SPACE 1                                                        06780000
ADDANAL  BAL   GR5,ADDONLY             CHECK ADD/REPL SEQUENCE          06800000
         CLI   COMDCD,X'0F'            PREVIOUS COMMAND IN EFFECT       06820000
         BE    KEEPPEND                YES- KEEP COMMAND PENDING        06840000
         MVI   ADDSW,X'0F'             SET ADD SWITCH ON FIRST ADD      06860000
         B     SETNDRET                SET COMMAND SWITCH AND CONTINUE  06880000
         SPACE 1                                                        06900000
REPLANAL LA    GR5,RETREPL             RETURN FROM SEQUENCE CHECK       06920000
REPLADD  TM    CTONLYSW,X'11'     IS THERE AN OLD MASTER         A30480 06940020
         BM    INVALOP            NO.. CAN DO ADD ONLY           A30480 06960020
ADDONLY  CLI   REPLSW,X'0F'            TWO CONSECUTIVE REPL STATEMENTS  06980000
         BE    ABSEQERR                YES- STATEMENT SEQUENCE ERROR    07000000
         CLI   ADDSW,X'0F'             CONSECUTIVE REPL-ADD CARDS       07020000
         BE    ABSEQERR                YES- STATEMENT SEQUENCE ERROR    07040000
         CLI   CHNGESW,X'0F'           CONSECUTIVE COMD CARDS           07060000
         BE    ABSEQERR                YES- CONTROL SEQUENCE ERROR      07080000
         CLI   FINICCS,X'0F'      SYSIN THRU                     A24189 07081018
         BE    TSTSEQ             ENDUP BEING PROCESSED          A24189 07082018
         CLI   INPLCSW,X'0F'            UPDATE INPLACE JUST DONE PTM901 07086017
         BE    KEEPPEND           YES-FINISH THAT FUNCTION     @ZA01692 07094002
TSTSEQ   MVI   IGNORESW,X'00'     CLEAR IGNORE /* AT EACH COMD   A24189 07102018
         BAL   GR9,TESTSEQC            TEST IF MULTIPLE COMDS ALLOWED   07120000
         BR    GR5                     SEQUENCE IS OK                   07140000
RETREPL  CLI   COMDCD,X'0F'            PREVIOUS COMMAND IN EFFECT       07160000
         BNE   SETREPLS                NO- SET REPLACE SWITCH           07180000
KEEPPEND MVI   COMDCD2,X'0F'           SET COMMAND PENDING SWITCH       07200000
         MVI   DONOTRDC,X'0F'          DO NOT READ MORE CONTROL CARDS   07220000
         B     STOWIT                  RETURN TO PROCESSING CSECT       07240000
SETREPLS MVI   REPLSW,X'0F'            FLAG AS REPLACE FUNCTION         07260000
SETNDRET MVI   COMDCD,X'0E'            TEMPORARY SETTING OF COMMAND SW  07280000
         CLI   FLUSHSW,X'0F'           IS FLUSH ROUTINE PROCESSING      07300000
         BNE   TOSCAN                  NO- CONTINUE                     07320000
         MVI   RIDIT2SW,X'0E'          SET AS COMMAND DURING FLUSH      07340000
         B     TOSCAN                  RETURN TO SCAN                   07360000
CHNGEANL DS    0H                                              @ZA01691 07380002
         MVC   LASTCTRC(8),ZEROHEX      REINITIALIZE LAST SEQ. NO.19013 07390017
         CLI   COMDCD,X'0F'            PREVIOUS COMMAND IN EFFECT       07400000
         BNE   ANYOLD             NO,GO TO SEE IF ANY OLD D/S  @ZA01691 07420002
         CLI   ADDSW,X'0F'        CONSECUTIVE COMD CARDS?      @ZA01691 07422002
         BE    ABSEQERR           YES,STATEMENT SEQ ERROR      @ZA01691 07424002
         CLI   REPLSW,X'0F'       CONSECUTIVE COMD CARDS?      @ZA01691 07426002
         BE    ABSEQERR           YES,STATEMENT SEQ ERROR      @ZA01691 07428002
         CLI   CHNGESW,X'0F'      CONSECUTIVE COMD CARDS?      @ZA01691 07429202
         BE    ABSEQERR           YES,STATEMENT SEQ ERROR      @ZA01691 07429602
         B     KEEPPEND           KEEP COMMAND PENDING         @ZA01691 07430002
ANYOLD   BAL   GR5,REPLADD        CHECK FOR CONSECUTIVE COMD   @ZA01691 07432002
         MVI   CHNGESW,X'0F'           SET CHANGE SWITCH                07440000
         B     SETNDRET                SET COMMAND SWITCH AND CONTINUE  07460000
ALIASANL CLI   ALIASW,X'0F'            PREVIOUS ALIAS                   07480000
         MVI   DONOTRDC,X'00'          ALLOW NEXT STATEMENT TO BE READ  07500000
         BE    ALIAS2                  SET ALIAS PENDING SWITCH    MA0H 07520017
         CLI   PSSWNM,X'00'            IS NEW MASTER SEQUENTIAL         07540000
         BE    IGNOREPS                YES- ALIAS HAS NO MEANING        07560000
         CLI   INPLCSW,X'00'           IS IT UPDATE=INPLACE        UL0H 07562017
         BNE   IGNORALS                THEN PRINT IGNORE ALIAS MSG UL0H 07564017
         CLI   ENDONLY,X'0F'           ACCEPT ENDUP ONLY           4929 07566017
         BE    STOWIT1                 YES GO READ MORE SYSIN      4929 07572017
         MVI   ALIASW,X'0F'            SET ALIAS SWITCH                 07580000
         B     TOSCAN                  RETURN TO SCAN                   07600000
ALIASTNM CLI   ALIASW2,X'0F'      NAME ON FIRST ALIAS CARD?    @ZA01682 07610002
         BE    MOREALIA           NO,BRANCH TO ADJUST POINTER  @ZA01682 07620002
         LA    GR7,ALIASNM        ADDR OF ALIAS NAME SAVE      @ZA01682 07630002
         ST    GR7,ALIASNM1       STORE INITIAL POINTER TO     @ZA01682 07632002
         ST    GR7,ALIASNM2       USE WHEN SEVERAL ALIAS       @ZA01682 07634002
         B     ISNAMEOK                CHECK NAME VALIDITY- STORE IT    07640000
MOREALIA L     GR7,ALIASNM1       PICK UP LAST ADDRESS         @ZA01682 07641002
         LA    GR7,8(GR7)         AND ADD TO MOVE NEXT NAME    @ZA01682 07642002
         ST    GR7,ALIASNM1       SAVE THIS POINTER            @ZA01682 07643002
         LA    GR5,ALIASNM1       ADDRESS OF ALIAS SAVE END    @ZA01682 07644002
         CR    GR7,GR5            MORE THAN 16 ALIAS?          @ZA01682 07645002
         BE    INVALOP            YES,GO TO GIVE MSG           @ZA01682 07646002
         B     ISNAMEOK           NO,GO TO CHECK NAME          @ZA01682 07647002
ALIAS2   CLI   ALIASW2,X'0F'      ALREADY TWO ALIASES?         @ZA01682 07648002
         BE    TOSCAN             YES,SCAN THE STATEMENT       @ZA01682 07649002
         OI    ALIASW2,X'0F'      SET SW MORE THAN ONE ALIAS   @ZA01682 07650002
         MVI   COMDCD2,X'1F'           TURN ON TO FORCE STOW   @ZA01690 07660002
         MVI   DONOTRDC,X'0F'          DO NOT READ SYSIN           MA0H 07670017
         B     STOWIT                  PROCESS ALIAS               MA0H 07680017
CARDGET  L     GR15,PRIMEWRT           ADDRESS OF MESSAGE ROUTINE       07700000
         BALR  GR14,GR15               GIVE MESSAGE                     07720000
READNOW  MVI   PRINTWRT,X'0F'          NEXT RECORD TO BE READ           07740000
         B     STOWIT                  RETURN TO PROCESSING CSECT       07760000
IGNOREPS LA    GR11,PSALIAS       ALIAS IGNORED MESSAGE CODE     A30501 07766019
         B     ALIASERR                                          A30501 07772019
IGNORALS LA    GR11,UPALIAS        ALIAS IGNORED MESSAGE CODE    A30501 07778019
ALIASERR MVI   PRINTED,X'00'       CLEAR PRINT SWITCH            A30501 07784019
         BAL   GR14,CARDPRNT       PRINT   INVALID STATEMENT     A30501 07790019
         L     GR15,PRIMEWRT       ADDRESS OF MESSAGE WRITER     A30501 07796019
         MVI   PRINTED,RESET0      CLEAR PRINT  SWITCH           A30501 07802019
         BALR  GR14,GR15           GIVE MESSAGE                  A30501 07808019
         MVI   PRINTWRT,X'0F'           SET SWITCH CARD PRINT    A41839 07810021
         B     STOWIT                                            A30501 07814019
         SPACE 1                                                        07820000
CHKNEW   CLI   CTONLYSW,X'01'          PARM=NEW SPECIFIED      @ZA01693 07840002
         BE    SCANERR            YES INVALID USE OF NEW=PO    @ZA01693 07850002
*                                 OR NEW=PS                    @ZA01693 07854002
         TM    FIRSENTR,X'0F'   TEST IF 2:ND COMMAND WITH NEW= @ZA07321 07854499
         BO    INVALOP          YES,INVALID OPERATION          @ZA07321 07854899
         BAL   GR9,PARATEST       GET NEXT CORRECT PARAMETER   @ZA01693 07856002
         BAL   GR9,TESTCMD             TEST IF PARAMETER ON A COMD CARD 07860000
         LA    GR6,2                   MAXIMUM SIZE OF THIS PARAMETER   07880000
         L     GR11,DCBNM              ADDRESS OF NEW MASTER DCB        07900000
         CR    GR6,LENGTH              IS PARAMETER SIZE 2 BYTES        07920000
         BNE   SCANERR                 NO- ERROR                        07940000
         OI    PARMSW,X'20'            FLAG AS 'NEW' PARAMETER          07960000
         L     GR10,DCBOM              OLD MASTER DCB ADDRESS           07980000
         CLC   0(2,SCANADR),NEWPO      IS NEW MASTER TO BE PARTITIONED  08000000
         BE    PS2PONOW                NEW MASTER PO, OLD IS PS         08020000
         CLC   0(2,SCANADR),NEWPS      IS NEW MASTER TO BE SEQUENTIAL   08040000
         BNE   SCANERR                 NO- INVALID PARAMETER            08060000
         MVI   BDSORG(GR11),PSDSET     SET DCB ORGANIZATION AS PS  3628 08080015
         MVI   BDSORG(GR10),PODSET     SET OLD MASTER DCB AS PO    3628 08100015
         MVI   PSSWOM,X'0F'            FLAG OLD MASTER AS PO            08120000
         MVI   PSSWNM,X'00'            SET NEW MASTER SWITCH TO PS      08140000
         B     TOSCAN                  RETURN TO SCAN                   08160000
PS2PONOW MVI   BDSORG(GR11),PODSET     SET NEW MASTER AS PO        3628 08180015
         MVI   BDSORG(GR10),PSDSET     SET OLD MASTER AS PS        3628 08200015
         MVI   PSSWNM,X'0F'            FLAG NEW MASTER AS PO            08220000
         MVI   PSSWOM,X'00'            FLAG OLD MASTER AS PS       3628 08230015
         B     TOSCAN                  RETURN TO SCAN                   08240000
CHKLIST  BAL   GR9,PARATEST            GET NEXT PARAMETER               08260000
         BAL   GR9,TESTCMD             TEST IF PARAMETER ON A COMD CARD 08280000
         LA    GR6,3                                                    08300000
         CR    GR6,LENGTH              IS PARAMETER 3 BYTES (ALL)       08320000
         BNE   SCANERR                 NO- ERROR                        08340000
         CLC   0(3,SCANADR),LISTSET    IS LIST SETTING FOR ALL          08360000
         BNE   SCANERR                 NO- ERROR                        08380000
         MVI   FLLISTSW,X'01'          LIST EVERYTHING                  08400000
         B     TOSCAN                  RETURN TO SCAN                   08420000
         SPACE 1                                                        08440000
CHKINSRT CLI   INPLCSW,X'0F'      UPDATE=INPLACE REQUESTED       A33318 08460020
         BE    SCANERR            YES.. INVALID PARAMETER        A33318 08480020
         BAL   GR9,PARATEST            GET PARAMETER                    08500000
         LA    GR6,3                                                    08520000
         CR    GR6,LENGTH              IS PARAMETER 3 BYTES             08540000
         BNE   SCANERR                 NO- CONTROL STATEMENT ERROR      08560000
         CLC   0(3,SCANADR),YESYES     IS SETTING 'YES'                 08580000
         BNE   SCANERR                 NO- CONTROL STATEMENT ERROR      08600000
         CLI   INSERTSW,X'0E'          PREVIOUS INSERT                  08620000
         BNE   SETINSRT                NO- FLAG AS FIRST INSERT         08640000
         MVI   INSRTRD,X'01'           SET TO INDICATE ANOTHER INSERT   08660000
         B     TOSCAN                  RETURN TO SCAN                   08680000
SETINSRT MVI   INSERTSW,X'0F'          SET FIRST INSERT SWITCH SETTING  08700000
         B     TOSCAN                  RETURN TO SCAN                   08720000
         SPACE 1                                                        08740000
*              TEST PARAMETERS FOR SCAN ERRORS                          08760000
PARATEST L     GR15,RDCARD                                         UL0H 08770017
         BALR  GR14,GR15               SCAN FOR NEXT PARAMETER     UL0H 08780017
         TM    SWITCHRD,BIT80          SCAN ERROR SWITCH ON             08800000
         BC    1,SCANERR               YES- CONTROL STATEMENT ERROR     08820000
         TM    SWITCHRD,BIT02          IS THIS A PARAMETER              08840000
         BC    14,SCANERR              NO- CONTROL STATEMENT ERROR      08860000
         LM    LENGTH,SCANADR,STOREG   LOAD POINTERS TO LENGTH AND PARM 08880000
         BR    GR9                     RETURN                           08900000
CHKIDENT MVI   SQFSW,SWF0              BEGIN SEQFLD ANALYSIS    YM07522 08906002
         BAL   GR9,PARATEST            GET NEXT PARAMETER       YM07522 08920002
         BAL   GR9,TESTCMD             TEST IF PARAMETER ON A COMD CARD 08940000
         CLI   SQFSW,SWFC              SEQFLD=(  FORM           YM07522 08942002
         BNE   ANSQF1                  NO - ANALIZE FIRST DDL   YM07522 08944002
         LTR   LENGTH,LENGTH           LENGTH OF 0              YM07522 08946002
         BZ    ANSQF2                  YES - USE DEFAULT        YM07522 08948002
ANSQF1   LA    GR9,TESTSEQ             RETURN FROM COLUMN CHECK YM07522 08960002
         LA    GR6,3                   VALID PARAMETER LENGTH           08980000
         CR    GR6,LENGTH              IS PARAMETER THREE BYTES         09000000
         BNE   SCANERR                 NO- CONTROL STATEMENT ERROR      09020000
COLMCHKX CLC   0(2,SCANADR),COLUMN80   IS COLUMN GREATER THAN 80        09040000
         BH    SCANERR                 YES- CONTROL STATEMENT ERROR     09060000
         CLC   0(2,SCANADR),COLUMN01   IS COLUMN LESS THAN 1            09080000
         BL    SCANERR                 YES- CONTROL STATEMENT ERROR     09100000
         BR    GR9                     RETURN                           09120000
TESTSEQ  CLI   2(SCANADR),C'8'         IS SEQUENCE SIZE MORE THAN 8     09140000
         BH    SCANERR                 YES- CONTROL STATEMENT ERROR     09160000
         CLI   2(SCANADR),C'1'         IS SEQUENCE SIZE LESS THAN 1     09180000
         BL    SCANERR                 YES- CONTROL STATEMENT ERROR     09200000
         MVN   IDENTY+1(1),2(SCANADR)  MOVE SEQUENCE SIZE TO BUFFER     09220000
         LA    GR9,STORID              RETURN FROM ROUTINE              09240000
         LA    GR7,IDENTXX             START COLUMN SEQUENCE NUMBER     09260000
GETCOLMS MVC   TEMPWA(8),ZERO          CLEAR BUFFER                     09280000
         PACK  TEMPWA+6(2),0(2,SCANADR)   UNPACK COLUMN                 09300000
         CVB   GR5,TEMPWA              CONVERT TO BINARY                09320000
         BCTR  GR5,0                   DECREMENT FOR INDEXING           09340000
         STH   GR5,0(GR7)              STORE IN IDENTXX OR UPDATCOL     09360000
         LH    GR3,LRECL               PICK UP LOGICAL RECORD LENGTH    09380000
         LA    GR5,1(GR5)              RETURN TO ORIGINAL COLUMN        09400000
         CR    GR5,GR3                 COLUMN LESS THAN LRECL (IDENTXX) 09420000
         BH    SCANERR                 NO- FIELD WILL BE OUT OF LRECL   09440000
         BR    GR9                     RETURN TO STORID OR TOSCAN       09460000
STORID   SR    GR8,GR8                 PROCESS IDENT FIELD              09480000
         IC    GR8,IDENTY+1            SIZE OF SEQUENCE FIELD           09500000
         BCTR  GR8,0                   DECREMENT                        09520000
         SR    GR3,GR8                 MAXIMUM START OF SEQUENCE FIELD  09540000
         CR    GR5,GR3                 WILL SEQUENCE RUN OUT OF LRECL   09560000
         BH    SCANERR                 YES- ERROR                       09580000
ANSQF2   CLI   SQFSW,SWFC              NUMERIC DDL SPECIFIED    YM07522 09582002
         BE    CKDDL2                  YES - ANALIZE IT         YM07522 09584002
         B     TOSCAN                  RETURN TO SCAN                   09600000
CKDDL2   MVI   DELIMIN,BIT80           SET 2ND PARM FLAG        YM07522 09601002
         BAL   GR9,PARATEST            GET NUMERIC DDL          YM07522 09602002
         LA    GR6,L3                  SET EXPECTED LENGTH      YM07522 09603002
         CR    GR6,LENGTH              IS LENGTH CORRECT        YM07522 09604002
         BNE   SCANERR                 NO - ERROR               YM07522 09605002
         CLI   SQFSW,SWFE              PROPER SYNTAX            YM07522 09606002
         BNE   SCANERR                 NO - ERROR               YM07522 09607002
         MVN   IDENTN+D1,D2(SCANADR)   MOVE SIZE TO BUFFER      YM07522 09608002
         LA    GR9,STORNM              RETURN FROM ROUTINE      YM07522 09609002
         LA    GR7,IDENTNN             START NUMERIC FIELD      YM07522 09610002
         B     GETCOLMS                ESTABLISH NUMERIC OFFSET YM07522 09611002
TESTCMD  TM    COMDCD,X'0E'            IS PARAMETER ON A COMMAND CARD   09620000
         BC    12,SCANERR              NO- CONTROL STATEMENT ERROR      09640000
         BR    GR9                     RETURN                           09660000
STORNM   CLC   IDENTNN(L2),IDENTXX     NUMERIC AFTER SEQ DDL    YM07522 09661002
         BL    SCANERR                 NO - ERROR               YM07522 09662002
         SR    GR8,GR8                 INITIALIZE WORK REGS     YM07522 09663002
         SR    GR5,GR5                                          YM07522 09664002
         IC    GR8,IDENTN+D1           GET NUMERIC LENGTH       YM07522 09665002
         AH    GR8,IDENTNN             GET END OF NUMERIC       YM07522 09666002
         IC    GR5,IDENTY+D1           GET SEQ NO LENGTH        YM07522 09667002
         AH    GR5,IDENTXX             GET END OF SEQ NO        YM07522 09668002
         CR    GR8,GR5                 NUMERIC WITHIN SEQ NO    YM07522 09669002
         BH    SCANERR                 NO - ERROR               YM07522 09671002
         LH    GR8,IDENTNN             COMPUTE OFFSET OF        YM07522 09672002
         SR    GR5,GR8                 * NUMERIC FROM END       YM07522 09674002
         BCTR  GR5,GR0                 * OF SEQ FIELD           YM07522 09676002
         STH   GR5,NUMOFFST            SAVE OFFSET              YM07522 09677002
         B     TOSCAN                  RETURN TO SCAN           YM07522 09678002
REPROANL BAL   GR5,REPLADD             CHECK FOR CONSECUTIVE COMMANDS   09680000
         CLI   COMDCD,X'0F'            A COMMAND IN EFFECT              09700000
         BE    KEEPPEND                YES- KEEP REPRO PENDING          09720000
         MVI   REPROSW,X'0F'           SIGNAL REPRO COMMAND             09740000
         B     SETNDRET                SET COMMAND SWITCH AND RETURN    09760000
CHKCOLMN BAL   GR9,PARATEST            GET THE PARAMETER                09780000
         BAL   GR9,TESTCMD             TEST IF PARAMETER ON A COMD CARD 09800000
         LA    GR6,2                   MAXIMUM SIZE OF PARAMETER        09820000
         CR    GR6,LENGTH              MAXIMUM OF 2 BYTES               09840000
         BE    CHECKOUT                YES- CHECK IF VALID COLUMNS      09860000
         BL    SCANERR                 GREATER THAN 2- STATEMENT ERROR  09880000
         MVC   COLM1BUF+1(1),0(SCANADR) MOVE TO BUFFER THE 1 CHARACTER  09900000
         LA    SCANADR,COLM1BUF        PUT ADDRESS OF 2 CHARACTER AREA  09920000
CHECKOUT BAL   GR9,COLMCHKX            CHECK IF COLUMN VALID            09940000
         MVI   COLUMNSW,X'0F'          SIGNAL SELECTIVE UPDATE          09960000
         LA    GR9,TOSCAN              LOAD RETURN ADDRESS              09980000
         LA    GR7,UPDATCOL            BUFFER FOR COLUMN UPDATE START   10000000
         B     GETCOLMS                CONVERT COLUMN AND CHECK         10020000
CHKNAME  BAL   GR9,PARATEST            GET PARAMETER                    10040000
         CLI   ALIASW,X'0F'            IS NAME FIELD IN ALIAS STATEMENT 10060000
         BE    ALIASTNM                YES- ENTER ALIAS ANALYSIS        10080000
         LA    GR7,MEMNAME             OLD MASTER MEMBER NAME BUFFER    10100000
         OI    PARMSW,X'10'            FLAG AS 'NAME' PARAMETER         10120000
         TM    PARMSW,X'20'            HAS 'NEW' PARAMETER COME IN      10140000
         BC    1,ESTNAME               YES- DCB AND SWITCHES SET BY NOW 10160000
         L     GR10,DCBOM              ADDRESS OF OLD MASTER DCB   3628 10180015
         L     GR11,DCBNM              ADDRESS OF NEW MASTER DCB   3628 10200015
         MVI   BDSORG(GR10),PODSET     FLAG DCB OM AS PARTITIONED  3628 10220015
         MVI   PSSWNM,X'0F'            FLAG NEW MASTER AS PODS          10240000
         MVI   PSSWOM,X'0F'            MUST ALSO FLAG OM FOR TESTS      10260000
         MVI   BDSORG(GR11),PODSET     FLAG DCB NM AS PARTITIONED  3628 10280015
ESTNAME  BAL   GR9,TESTCMD             TEST IF PARAMETER ON A COMD CARD 10300000
ISNAMEOK LA    GR5,BLANKS8             DOUBLE WORD OF BLANKS            10320000
         LA    GR9,TESTCHR             RETURN FROM SUBROUTINE           10340000
CLRSTOR  C     LENGTH,EIGHT            TEST IF NAME/SEQ MORE THAN 8     10360000
         BH    SCANERR                 CONTROL STATEMENT ERROR          10380000
         MVC   0(8,GR7),0(GR5)         CLEAR BUFFER TO BLANKS OR ZERO   10400000
         BR    GR9                     RETURN                           10420000
TESTCHR  LR    GR6,LENGTH              IF LENGTH REG IS 0 CANNOT EXEC   10440000
         BCTR  GR6,0                   DECREMENT FOR EXECUTE            10460000
         EX    GR6,MOVNAME             MOVE NAME LEFT ADJUST            10480000
         CLI   0(GR7),C'A'             FIRST CHARACTER ALPHABETIC       10500000
         BL    NATLETTR      CHAR NOT ALPHA,MAY BE NAT'L LETTER    3083 10520015
         CLI   0(GR7),C'Z'             FIRST CHARACTER ALPHABETIC       10540000
         BH    SCANERR                 CONTROL STATEMENT ERROR          10560000
VALCHAR  B     TOSCAN        VALID CHARACTER, KEEP SCANNING        3083 10564015
NATLETTR CLI   0(GR7),C'$'   IS CHARACTER A DOLLAR SIGN            3083 10568015
         BE    VALCHAR       YES, CHARACTER IS VALID               3083 10572015
         CLI   0(GR7),C'@'   IS CHARACTER AN "AT" SIGN             3083 10576015
         BE    VALCHAR       YES, CHARACTER IS VALID               3083 10580015
         CLI   0(GR7),C'#'   IS CHARACTER A POUND SIGN             3083 10584015
         BE    VALCHAR       YES, CHARACTER IS VALID               3083 10588015
         B     SCANERR       CHARACTER WAS NONE OF THESE, ERROR    3083 10592015
CHKSORCE BAL   GR9,TESTCMD             IS THIS KEY WORD ON COMD CARD    10600000
         BAL   GR9,PARATEST            GET THE PARAMETER                10620000
         LA    GR6,1                   SIZE OF SOURCE DATA              10640000
         CR    LENGTH,GR6              MORE THAN 1 BYTE CODE GIVEN      10660000
         BNE   SCANERR                 YES- CONTROL STATEMENT ERROR     10680000
         CLI   0(SCANADR),C'1'         TEST IF IBM MODIFICATION         10700000
         BE    STORCODE                YES- CODE IS OK                  10720000
         CLI   0(SCANADR),C'0'         TEST IF USER MODIFICATION        10740000
         BNE   SCANERR                 NO- INVALID SOURCE CODE          10760000
STORCODE MVC   SOURCECD(1),0(SCANADR)  STORE SOURCE CODE                10780000
         B     TOSCAN                  RETURN TO SCAN                   10800000
         SPACE 1                                                        11000000
CHKLEVEL BAL   GR9,TESTCMD             IS KEY WORD ON COMD CARD         11020000
         BAL   GR9,PARATEST            GET THE PARAMETER                11040000
         LA    GR6,2                   MAXIMUM LENGTH THIS PARAMETER    11060000
         CR    GR6,LENGTH              IS PARAMETER 2 BYTES (00 - 99)   11080000
         BNE   SCANERR                 NO- CONTROL STATEMENT ERROR      11100000
         BAL   GR9,TESTSCAN            TEST AND CONVERT TO HEX          11120000
         PACK  LEVELXX(2),RRSAVE(3)    STORE CHANGE LEVEL               11140000
         B     TOSCAN                  RETURN TO SCAN                   11160000
         SPACE 1                                                        11180000
CHKSSI   BAL   GR9,TESTCMD             IS KEY WORD ON COMD CARD         11200000
         BAL   GR9,PARATEST            GET PARAMETER                    11220000
         C     LENGTH,EIGHT            IS PARAMETER LENGTH 8            11240000
         BNE   SCANERR                 NO- CONTROL STATEMENT ERROR      11260000
         LA    GR9,PACKSSI             RETURN FROM TEST/CONVERT         11280000
TESTSCAN LA    GR3,RRSAVE              ADDRESS OF WORK AREA             11300000
         LR    GR8,LENGTH              LOAD COUNT OF REGISTER WITH SIZE 11320000
         EX    GR8,MOVESSIL            MOVE SSI OR LEVEL (ONE EXTRA OK) 11340000
SCANLOOP TM    0(GR3),C'0'             IS DIGIT NUMERIC                 11360000
         BO    UPPOINTR                YES- PASS TO NEXT CHARACTER      11380000
         CLI   0(GR3),C'A'             IS THIS A HEX CHARACTER (A-F)    11400000
         BL    SCANERR                 NO- ERROR                        11420000
         CLI   0(GR3),C'F'             IS THIS A HEX CHARACTER (A-F)    11440000
         BH    SCANERR                 NO- ERROR                        11460000
         OI    0(GR3),X'20'            CHANGE C ZONE TO E ZONE          11480000
UPPOINTR LA    GR3,1(GR3)              POINT TO NEXT CHARACTER          11500000
         BCT   GR8,SCANLOOP            CHECK ALL EIGHT CHARACTERS       11520000
         TR    RRSAVE(8),ALTTT-225     CONVERT TO HEX                   11540000
         BR    GR9                     RETURN                           11560000
PACKSSI  PACK  SSIBUF(5),RRSAVE(9)     PACK SSI INFORMATION             11580000
         MVI   SSISW,X'0F'             SET SWITCH SSI TO OVERIDE LEVEL- 11600000
         B     TOSCAN                  RETURN TO SCAN                   11620000
         SPACE 1                                                        11640000
UPDATANL TM    CHNGESW,X'0F'           IS PARAMETER ON A CHANGE CARD    11660000
         BC    14,SCANERR              NO- ERROR                        11680000
         CLI   FIRSENTR,BIT10          FIRST ENTRY                      11700000
         BNE   STOPNOW                 NO- CANNOT MIX INPLACE/REGULAR   11720000
         BAL   GR9,PARATEST            GET PARAMETER                    11740000
         LA    GR6,7                                                    11760000
         CR    GR6,LENGTH              TEST IF 7 CHARACTERS             11780000
         BNE   SCANERR                 ERROR IF NOT 7                   11800000
         CLC   0(7,SCANADR),INPLACE    COMPARE IF PARAMETER = 'INPLACE' 11820000
         BNE   SCANERR                 NO- CONTROL STATEMENT ERROR      11840000
         TM    CTONLYSW,X'11'     IS THERE AN OLD MASTER         A30480 11860020
         BM    INVALOP            NO.. CANNOT UPDATE INPL. NM    A30480 11880020
         MVI   INPLCSW,X'0F'           FLAG AS UPDATE IN PLACE- NO NM   11900000
         B     TOSCAN                  RETURN TO SCAN                   11920000
         SPACE 1                                                        11940000
DELETANL CLI   FLUSHSW,X'0F'           FLUSHING IN PROCESS              11960000
         BE    MSGNREAD                YES- GIVE SCAN MESSAGE           11980000
         MVI   KEYCHECK+3,X'10'   SET DISPL. FOR KEY START TAB   A33314 11990020
         CLI   INPLCSW,X'0F'           UPDATE TYPE RUN                  12000000
         BE    INVALOP                 INVALID OPERATION DELETE/UPDATE  12020000
         TM    CHNGESW,X'0E'           FOLLOWS A CHANGE COMMAND         12040000
         BC    12,ABSEQERR             NO- CONTROL SEQUENCE ERROR       12060000
         CLI   DELETSW,X'0F'           FOLLOWS A DELET CARD IMMEDIATELY 12080000
         BE    DELETPND                YES- KEEP THIS DELET PENDING     12100000
         MVI   DELETSW,X'0F'           FLAG AS DELETE STATEMENT         12120000
         MVI   CHNGESW,X'0E'           FLAG AS CHANGE PLUS ANOTHER COMD 12140000
         B     TOSCAN                  RETURN TO SCAN                   12160000
DELETPND MVI   DELET2SW,X'0F'          SET 2 CONSECUTIVE DELETS SWITCH  12180000
CHKIFOPN MVI   DONOTRDC,X'0F'          DO NOT READ MORE CONTROL CARDS   12200000
         CLI   OPENSW,X'0F'            HAS DATA SET BEEN OPENED         12220000
         BE    STOWIT                  NO- RETURN TO CSECT2- OPEN IT    12240000
         B     READNOW                 RETURN TO PROCESS                12260000
         SPACE 1                                                        12280000
NUMBRANL CLI   FLUSHSW,X'0F'           FLUSHING IN PROCESS              12300000
         BE    MSGNREAD                YES- GIVE SCAN MESSAGE           12320000
         MVI   KEYCHECK+3,X'08'   SET DISPL. FOR KEY START TAB   A33314 12330020
         TM    CHNGESW,X'0E'           IN SEQUENCE OF CHANGE COMMANDS   12340000
         BO    CHNGEOEX                YES- COMMAND WITH CHANGE         12360000
         TM    REPLSW,X'0E'            IN SEQUENCE OF REPL COMD         12380000
         BO    REPLOEX                 YES- FOLLOWS A REPLACE CARD      12400000
         TM    ADDSW,X'0E'             IN SEQUENCE OF ADD COMD          12420000
         BC    12,ABSEQERR             DOES NOT FOLLOW ADD-REPL-CHNGE   12440000
         CLI   NUMBRSW,X'0F'           PREVIOUS NUMBER STATEMENT   6701 12446017
         BE    INVALOP                 ONLY ONE NUMBER FOR ADD     6701 12452017
         MVI   ADDSW,X'0E'             RESET TO SHOW NUMBER AFTER ADD   12460000
         B     NUMBER01                NEW NUMBER STATEMENT        6701 12470017
NUMBRSWS CLI   NUMBRSW,X'0F'           PREVIOUS NUMBER STATEMENT        12480000
         BNE   NUMBER01                NO- THIS IS NEW ONE              12500000
         TM    INSERTSW,X'0F'                                    A25432 12507019
         BM    NUMBER01                                          A25432 12514019
         BZ    ONEINSRT                                          A25432 12521019
         CLI   FSTINSRT,X'0F'          CONSECUTIVE INSERT=YES ?  A25432 12528019
         MVI   FSTINSRT,X'00'          RESET FIRST DATA CARD SW  A25432 12535019
         BNE   ABSEQERR                YES, ERROR - DATA MUST    A25432 12542019
*                                      FOLLOW INSERT=YES         A25432 12549019
ONEINSRT CLI   RENUMALL,X'0F'                                    A25432 12559019
         BE    INVALOP                 YES- INVALID OPERATION           12580000
         MVI   NUMBR2SW,X'0F'          SET 2 CONSECUTIVE NUMBER SWITCH  12600000
         B     CHKIFOPN                SET UP TO CONTINUE PROCESSING    12620000
NUMBER01 MVI   NUMBRSW,X'0E'           FLAG AS NUMBER STATEMENT SCANNED 12640000
         B     TOSCAN                  RETURN TO SCAN                   12660000
CHNGEOEX MVI   CHNGESW,X'0E'           RESET TO SHOW NUMBER AFTER CHNGE 12680000
         B     NUMBRSWS                SET NUMBER SWITCH                12700000
REPLOEX  TM    NUMBRSW,X'0F'           PREVIOUS NUMBER STMT      A25924 12710019
         BC    5,INVALOP               ONLY ONE NUMBER FOR REPL  A25924 12720019
         MVI   REPLSW,X'0E'     RESET TO SHOW NUMBER AFTER REPL  A25924 12730019
         B     NUMBRSWS                SET NUMBER SWITCH                12740000
MSGNREAD MVI   RIDIT2SW,X'0F'          SET TO SCAN BEYOND DETAIL CARD   12760000
         B     STOWIT                  BACK TO PROCESSING CSECT         12800000
         SPACE 1                                                        12820000
TESTSEQC CLI   FINICCS,X'0F'           HERE FROM ENDUP ANALYSIS         12840000
         BCR   8,GR9                   YES- RETURN TO ENDUP ANALYSIS    12860000
         CLI   PSSWOM,X'00'            TEST IF OM PHYSICAL SEQUENTIAL   12880000
         BNE   ONENOTPS                OLD MASTER NOT PHYSICAL SEQUENT. 12900000
         CLI   PSSWNM,X'00'            TEST IF NM PHYSICAL SEQUENTIAL   12920000
         BCR   7,GR9                   NO- RETURN                       12940000
CHKFIRST CLI   COMDCD,X'0F'            PREVIOUS COMD CARD ENCOUNTERED   12960000
         BCR   7,GR9                   NO- OK THIS IS FIRST COMD CARD   12980000
QUITNOW  LA    GR11,ERRMSGC            CODE FOR TERMINATE MESSAGE       13000000
         B     ALLENDS                 GIVE MESSAGE                     13020000
STOPNOW  LA    GR11,UPDATMSG           CODE FOR INVALID INPLACE MESSAGE 13040000
         MVI   ENDONLY,X'0F'           FLUSH TO END            @AZ27974 13050000
ALLENDS  BAL   GR14,CARDPRNT           PRINT INVALID CARD        A33286 13055000
         L     GR15,PRIMEWRT           MESSAGE CSECT ADDR        A33286 13060000
         MVI   TEMPCON,12              SET TEMPORARY CONDITION CODE     13065000
         CLI   ENDONLY,X'0F'           INVALID UPDATE=INPLACE? @AZ27974 13070000
         BNE   MSGQUIT                 NO,GIVE MSG AND QUIT    @AZ27974 13075000
         CLC   TEMPCON(1),HICONCDE+1   RETURN CODE LESS?       @AZ27974 13080000
         BNH   NOTHIGH                 NOT HIGH, USE HICONCDE  @AZ27974 13085000
         MVC   HICONCDE+1(1),TEMPCON   SWAP FOR HIGHER CODE    @AZ27974 13090000
NOTHIGH  LA    GR14,SETFLUSH           RETURN ADDR AFTER MSG   @AZ27974 13095000
         BR    GR15                    PRINT MSG IN IEBUPLOG   @AZ27974 13100000
MSGQUIT  LA    GR14,QUITS              RETURN FROM MSG ROUT    @AZ27974 13105000
         BR    GR15                    GIVE MESSAGE- TERMINATE          13120000
ONENOTPS CLI   PSSWNM,X'00'            TEST IF NM PHYSICAL SEQUENTIAL   13140000
         BCR   7,GR9                   NO- RETURN                       13160000
         B     CHKFIRST                SEE IF FIRST ENTRY- 1 SEQUENTIAL 13180000
         SPACE 1                                                        13200000
CHKSEQ1  TM    ADDSW,X'0E'             PROCESSING ADD FUNC        20497 13206017
         BC    1,INVALOP               IF SO INVALID OPERATION    20497 13212017
         TM    REPLSW,X'0E'            PROCESSING REPL FUNCTION   20497 13218017
         BC    1,INVALOP               IF SO INVALID OPERATION    20497 13224017
         CLI   NUMBRSW,X'0E'           SEQUENCE ON NUMBER CARD     5666 13230017
         LA    GR8,TOSCAN              RETURN                           13240000
         LA    GR7,DELTSEQ1            ADDRESS OF DELETE BUFFER SEQ1    13260000
         BE    NUMBR              YES,BRANCH TO SET NUMBER SEQ1 YA01677 13266002
         CLI   NUMBR2SW,X'0F'     SEQ1 ON SECOND NUMBER CARD    YA01677 13272002
         BNE   TESTPARM           NO, ON DELETE- BRANCH            5666 13280016
NUMBR    LA    GR7,NUMRSEQ1       ADDRESS OF NUMBER SEQ1 BUFFER YA01677 13290002
         OI    PARMSW,X'01'            FLAG AS 'SEQ1' PARAMETER         13320000
         CLI   NUMBR2SW,X'0F'     FIELD ON SECOND NUMBER CARD?  YA01677 13326002
         BE    TESTPARM           YES,GO TO TEST PARAMETER      YA01677 13332002
TESTUNIT TM    NUMBRSW,X'0E'           FIELD ON NUMBER CARD             13340000
         BC    14,SCANERR              NO- INVALID ON ANY OTHER         13360000
TESTPARM BAL   GR9,PARATEST            GET PARAMETER                    13380000
         CLC   0(3,SCANADR),LISTSET    SEE IF SETTING IS 'ALL'          13400000
         BE    ALLNUMBR                YES- RENUMBER ENTIRE DATA SET    13420000
         LA    GR5,ZEROHEX             DOUBLE WORD OF HEX ZEROS         13440000
         BAL   GR9,CLRSTOR             CLEAR BUFFER AND RIGHT ADJUST    13460000
         LR    GR5,LENGTH              LENGTH OF PARAMETER      YM07522 13480002
         LA    GR7,8(GR7)              ALIGN TO END OF BUFFER           13500000
         SR    GR7,GR5                 BACK UP FROM RIGHT       YM07522 13520002
         BCTR  GR5,0                   DECREMENT FOR EXECUTE    YM07522 13540002
         EX    GR5,MOVNAME             RIGHT ADJUST SEQ NO      YM07522 13560002
         BR    GR8                     RETURN                   YM07522 13580002
CHKNMRIC EQU   *                       LOOP FOR NUMER. TESTING  OX00189 13590001
         CLI   0(GR5),LODIG            TEST IF NUMERIC CHAR     YM07522 13600002
         BL    SCANERR                 NO- CONTROL STATEMENT ERROR      13620000
         CLI   0(GR5),HIDIG            TEST IF VALID NUMBER     YM07522 13640002
         BH    SCANERR                 NO- CONTROL STATEMENT ERROR      13660000
         LA    GR5,D1(GR5)             SKIP TO NEXT CHARACTER   YM07522 13665002
         BCT   GR6,CHKNMRIC            SCAN NEXT CHAR. IF NECC. OX00189 13670001
         BR    GR8                     RETURN TOSCAN OR TESTNUMB        13680000
ALLNUMBR TM    NUMBRSW,X'0E'           SEQ1=ALL ON NUMBER STATEMENT     13700000
         BC    14,SCANERR              NO- INVALID CONTROL STATEMENT    13720000
         MVI   RENUMALL,X'0F'          SET RENUMBER ALL SWITCH          13740000
         B     TOSCAN                  RETURN TO SCAN                   13760000
         SPACE 1                                                        13780000
CHKSEQ2  LA    GR7,DELTSEQ2            ADDRESS OF DELETE SEQ2 BUFFER    13800000
         TM    ADDSW,X'0E'             PROCESSING ADD FUNC        20497 13804017
         BC    1,INVALOP               IF SO INVALID OPERATION    20497 13808017
         TM    REPLSW,X'0E'            PROCESSING REPL FUNCTION   20497 13812017
         BC    1,INVALOP               IF SO INVALID OPERATION    20497 13816017
         CLI   NUMBRSW,X'0E'      SEQUENCE ON NUMBER CARD          5666 13820016
         LA    GR8,TOSCAN              RETURN                           13840000
         BNE   TESTPARM           NO, DELETE CAED - BRANCH         5666 13860016
         LA    GR7,NUMRSEQ2            ADDRESS OF NUMBER SEQ2 BUFFER    13880000
         OI    PARMSW,X'02'            FLAG AS 'SEQ2' PARAMETER         13900000
         B     TESTUNIT                GET PARAMETER AND TEST IT        13920000
         SPACE 1                                                        13940000
CHKINCR  LA    GR7,INCRNUMB            ADDRESS OF INCREMENT BUFFER      13960000
         CLI   INSERTSW,X'0E'          PREVIOUS INSERT IN EFFECT        13980000
         BE    SAVEPARM                YES- SAVE THE PARAMETER          14000000
         LA    GR11,INCREMWA           INCREMENT FACTOR IN BINARY       14020000
FLAGINCR OI    PARMSW,X'04'            FLAG AS 'INCR' PARAMETER         14040000
         BAL   GR6,TESTNUMB            TEST IF PARM OK          YM07522 14041002
*        THE INCR VALUE MUST BE NUMERIC.                        YM07522 14042002
INCRNTST LR    GR5,GR10                POINT TO PARM VALUE      YM07522 14043002
         LA    GR6,L8                  SET LENGTH               YM07522 14044002
         BAL   GR8,CHKNMRIC            ENSURE NUMERICS          YM07522 14045002
         LA    GR6,L7                  SET LENGTH - 1           YM07522 14046002
         B     PACKNUM                 PACK PARM VALUE          YM07522 14047002
TESTNUMB LR    GR10,GR7                ADDRESS OF BUFFER                14060000
         BAL   GR8,TESTUNIT            ADJUST NUMBER            YM07522 14080002
         BR    GR6                     RETURN                   YM07522 14082002
PACKNUM  EX    GR6,PACKIT              PACK INCR OR NEW1 NO     YM07522 14100002
         CVB   GR6,TEMPWA              CONVERT TO BINARY                14120000
         ST    GR6,0(GR11)             SEQUENCE OR INCREMENT IN BINARY  14140000
         B     TOSCAN                  RETURN TO SCAN                   14160000
SAVEPARM LA    GR11,TEMPINCR           TEMPORARY INCREMENT AREA         14180000
         B     FLAGINCR                CONTINUE- STORE NEW INCREMENT    14200000
         SPACE 1                                                        14220000
CHKNEW1  LA    GR7,NEW1NUMB            ADDRESS OF NEW1 SEQUENCE NUMBER  14240000
         LA    GR11,SEQWA              STARTING SEQUENCE NUMBER BINARY  14260000
         CLI   INSERTSW,X'0E'          PREVIOUS INSERT IN EFFECT        14280000
         BNE   FLAGNEW1                NO- CONTINUE                     14300000
         LA    GR11,TEMPSEQA           TEMPORARY SEQUENCE AREA          14320000
         LA    GR7,NEW1TEMP            TEMPORARY SEQ NO         YM07522 14321002
FLAGNEW1 OI    PARMSW,X'08'            FLAG AS 'NEW1' PARAMETER         14340000
         BAL   GR6,TESTNUMB            TEST PARM VALUE          YM07522 14360002
* IF NUMERIC SEQFLD COLUMNS SPECIFIED, VALIDATE NUMERIC FIELD   YM07522 14361002
         CLI   IDENTN+D1,RESET0        NUMERIC SEQFLD SPECIFIED YM07522 14363002
         BE    INCRNTST                TREAT LIKE INCR          YM07522 14364002
         LA    GR5,D7(GR10)            SET END OF BUFFER ADDR   YM07522 14365002
         SH    GR5,NUMOFFST            SET NUMERIC START        YM07522 14367002
         LR    GR10,GR5                SAVE ADDRESS             YM07522 14368002
         SR    GR6,GR6                                          YM07522 14369002
         IC    GR6,IDENTN+D1           GET NUMERIC SIZE         YM07522 14370002
         BAL   GR8,CHKNMRIC            ENSURE NUMERICS          YM07522 14371002
         IC    GR6,IDENTN+D1           RESET SIZE               YM07522 14372002
         BCTR  GR6,GR0                 SUBTRACT 1               YM07522 14373002
         B     PACKNUM                 PACK NUMBER              YM07522 14374002
         SPACE 1                                                        14380000
CHKMEMBR LA    GR7,MEMBNEW             NEW MEMBER NAME, NEW PODS MADE   14400000
         BAL   GR9,PARATEST            GET PARAMETER                    14420000
         CLI   CTONLYSW,X'01'          PARM=NEW SPECIFIED        A38748 14430000
         BE    SCANERR                 YES,INVALID USE OF CONTROLA38748 14432000
         MVI   NEWNAME,X'0F'           FLAG NM IS PO                    14440000
         L     GR11,DCBNM              ADDRESS OF NEW MASTER DCB        14460000
         OI    PARMSW,X'40'            FLAG AS 'MEMBER' PARAMETER       14480000
         B     ESTNAME                 CHECK VALIDITY OF NAME- STORE IT 14500000
CHKTOTAL CLI   TOTALSW,X'00'            FIRST TOTAL PARM           UL0H 14500317
         BNE   INVALOP                  IF NOT,ERROR               UL0H 14500617
         MVI   TOTALSW,X'F0'            BEGIN TOTAL ANALYSIS       UL0H 14500917
         BAL   GR9,PARATEST             TEST FOR PARAMETER         UL0H 14501217
         BAL   GR9,TESTCMD              TEST FOR COMMAND           UL0H 14501517
         CLI   TOTALSW,X'FC'            HAS NAME BEEN ANALYSED     UL0H 14501817
         BNE   SCANERR                  IF NOT,ERROR               UL0H 14502117
         C     LENGTH,ZERO              LENCH GREATER THEN ZERO    UL0H 14502417
         BNH   INVALCHR                 IF NOT,ERROR               UL0H 14502717
         LA    GR5,BLANKS8                                         UL0H 14503017
         LA    GR7,TOTALRTN             USER ROUTINE NAME          UL0H 14503317
         BAL   GR9,CLRSTOR              CLEAR OUT BUFFER           UL0H 14503617
         LR    GR6,LENGTH               PICK UP LENGTH             UL0H 14503917
         BCTR  GR6,0                    DECREMENT                  UL0H 14504217
         EX    GR6,MOVNAME              AND MOVE IT TO SAVE AREA   UL0H 14504517
         BAL   GR14,TESTCHAR           DOES RTN NAME START WITH ALPUL0H 14504817
LOADTOTL LOAD  EPLOC=TOTALRTN                                      UL0H 14505117
         ST    0,TOTALADR                                          UL0H 14505417
         MVI   DELIMIN,X'80'           SET SECOND PARM SWITCH      UL0H 14505717
         BAL   GR9,PARATEST             GET CORE SIZE              UL0H 14506017
         CLI   TOTALSW,X'FE'            PROPER SYNTAX              UL0H 14506317
         BNE   SCANERR                  IF NOT,ERROR               UL0H 14506617
         LR    GR6,LENGTH               GET  LENGTH                UL0H 14506917
         C     GR6,ZERO                 IS IT GREATER THAN ZERO    UL0H 14507217
         BNH   NOCORE                   IF NOT,ERROR               UL0H 14507517
         C     GR6,FIVE                 IS IT LONGER THEN FIVE     UL0H 14507817
         BH    NOCORE                   IF SO,ERROR                UL0H 14508117
 SPACE  1                                                               14508417
*     THIS ROUTINE WILL DETERMINE IF LENGTH IS A VALID DECIMAL NO. UL0H 14508717
         LA    GR6,0(SCANADR,GR6)                                  UL0H 14509017
         BCTR  GR6,0                   POINT TO LAST DIGIT         UL0H 14509317
         LR    GR9,LENGTH                                          UL0H 14509617
COMPNO   CLI   0(GR6),C'0'             US NO. LESS THEN 'F0'       UL0H 14509917
         BL    NOCORE             YES.. PRINT ERROR MESSAGE      A36128 14510221
         CLI   0(GR6),C'9'             IS CHARACTER GREATER THEN F9UL0H 14510517
         BH    NOCORE             YES.. PRINT ERROR MESSAGE      A36128 14510821
         BCTR  GR6,0                   DECREMENT POINTER BY ONE    UL0H 14511117
         BCT   LENGTH,COMPNO           DECREMENT COUNTER BY ONE    UL0H 14511417
         BCTR  GR9,0                    DECREMENT                  UL0H 14511717
         LA    GR9,112(0,GR9)     GET LENGTH FIRST OPERAND       A36128 14512021
         EX    GR9,PACKSIZE       PREPARE REQUESTED SIZE         A36128 14512121
         CVB   GR5,TEMPTOT                                       A36128 14512221
         C     GR5,MAXCORE        REQUESTED MORE THAN 32K        A36128 14512321
         BNL   NOCORE             YES.. ERROR PRINT MESSAGE      A36128 14512421
         ST    GR5,TOTALSIZ       SAVE REQUESTED SIZE            A36128 14512521
         MVC   TOTLPARM+4(4),DCBNM      MOVE IN DCB ADDRESS        UL0H 14513817
         LR    GR0,GR5                  PREPARE FOR GETMAIN        UL0H 14514117
         GETMAIN R,LV=(0)                                          UL0H 14514417
         ST    GR1,TOTLPARM+12          SAVE ADDRESS IN PARMLIST   000I 14514718
         STH   GR5,0(GR1)              SAVE AREA ADDRESS IN AREA   UL0H 14515017
         MVI   TOTALSW,X'FF'                                       UL0H 14515317
      L        GR5,DCBNM               LOAD ADDRESS OF NEW MAST DCBUL0H 14515617
         ST    GR5,TOTLPARM+4           SAVE DCB ADDR IN PARM LIST 000I 14515718
      L        GR5,EXLIST(GR5)         LOAD ADDRESS OF NM XIT LIST UL0H 14515917
         ST    GR1,8(GR5)              STORE CORE ADDRESS IN XIT LSUL0H 14516217
         MVI   8(GR5),X'0A'            FLAG EXIT AS ACTIVE         UL0H 14516517
         SR    GR5,GR5                  ZERO OUT I/O               000I 14517518
         ST    GR5,TOTLPARM+8           ERROR PARAMETER            000I 14518518
         B     TOSCAN                  ANALIZE NEXT PARAMETER      UL0H 14519517
NOCORE   LA    GR11,BDCORESZ           CORE SIZE ERROR MSG CON     UL0H 14522517
         B     TONEXT                  PRINT  CARD AND MESSAGE          14523518
ERMSGSTP L     GR15,PRIMEWRT           ADDRESS OF MESSAGE ROUTINE  UL0H 14525517
         MVI   QUITALL,X'0F'           SET END OF PROCESS SWITCH   UL0H 14528517
         BR    GR15                    PRINT ERROR MSG AND QUIT    UL0H 14531517
TEST4OM  TM    CTONLYSW,X'11'     ALL INPUT FROM SYSIN           A30480 14541520
         BM    SCANERR            YES.. AN ERROR                 A30480 14551520
TEST4NM  BAL   GR9,TESTCMD             TEST IF PARAMETER ON COMD CARD   14580000
         BAL   GR9,PARATEST            GET PARAMETER                    14600000
         LR    GR5,SCANADR             START OF NAME                    14620000
         TM    0(GR5),ALPHA            TEST IF FIRST CHARACTER A LETTER 14640000
         BO    TSLTGTNO                YES- CHECK SOME MORE             14660000
INVALCHR LA    GR11,PLUS8MSG           CODE FOR ERROR MESSAGE           14680000
         B     TONEXT                  PRINT CARD AND MESSAGE      UL0H 14730017
TSLTGTNO BAL   GR14,TESTCHAR           TEST FIRST CHAR FOR ALPHA   UL0H 14790017
         LR    GR10,SCANADR            POINTER TO NAME                  14840000
         LR    GR9,LENGTH              PUT LENGTH INTO CORRECT REGISTER 14860000
         BR    GR8                     ENTER HANDLER  HEADER/TRAILER    14880000
CHKINHDR BAL   GR8,TEST4OM             IS THERE AN OLD MASTER      UL0H 14890017
         LA    GR3,OMHDR               ADDRESS OF RTN NAME/ADDRESS UL0H 14900017
         MVI   OMHDRSW,X'0F'           FLAG USER RTN FOR OLD MASTERUL0H 14910017
         B     MOVEARND                PREPARE TO LOAD ROUTINE     UL0H 14920017
CHKINTRL BAL   GR8,TEST4OM             IS THERE AN OLD MASTER      UL0H 14930017
         LA    GR3,OMTRLR              ADDRESS OF RTN NAME/ADDRESS UL0H 14940017
         MVI   OMTRLRSW,X'0F'          FLAG USER RTN FOR OLD MASTERUL0H 14950017
         B     MOVEARND                PREPARE TO LOAD ROUTINE     UL0H 14960017
CHKOUTHD BAL   GR8,TEST4NM             IS THERE AN NEW MASTER      UL0H 14970017
         LA    GR3,NMHDR               ADDRESS OF RTN NAME/ADDRESS UL0H 14980017
         MVI   NMHDRSW,X'0F'           FLAG USER RTN FOR NEW MASTERUL0H 14990017
         B     MOVEARND                PREPARE TO LOAD ROUTINE     UL0H 15000017
CKOUTTLR BAL   GR8,TEST4NM             IS THERE AN NEW MASTER      UL0H 15010017
         LA    GR3,NMTRLR              ADDRESS OF RTN NAME/ADDRESS UL0H 15020017
         MVI   NMTRLRSW,X'0F'          FLAG USER RTN FOR NEW MASTERUL0H 15030017
         B     MOVEARND                PREPARE TO LOAD ROUTINE     UL0H 15040017
MOVEARND C     GR9,EIGHT               TEST IF LABEL EXCEEDS 8 BYTES    15160000
         BH    INVALCHR                YES- ERROR                       15180000
         MVC   0(8,GR3),BLANKS8        CLEAR BUFFER                     15200000
         BCTR  GR9,0                   DECREMENT FOR EXECUTE            15220000
         EX    GR9,MVINHDEX            MOVE ROUTINE TO PROPER BUFFRUL0H 15230017
         LOAD  EPLOC=(GR3)             LOAD ROUTINE INTO CORE      UL0H 15240017
         ST    GR0,8(GR3)              STORE ADDRESS BEHIND NAME   UL0H 15250017
         B    TOSCAN                   BEGIN ANALIZING NEXT PARM   UL0H 15260017
  SPACE  2                                                              15270017
*  THIS ROUTINE WILL INTERROGATE FIRST CHARACTER OF NAME FOR VALIDIUL0H 15280017
  SPACE 1                                                               15290017
TESTCHAR CLI   0(SCANADR),C'#'         IS IT A NATIONAL CHARACTER  UL0H 15300017
         BCR   8,GR14                   IF SO,IT IS VALID,RETURN   000I 15310018
         CLI   0(SCANADR),C'@'         IS IT A NATIONAL CHARACTER  UL0H 15320017
         BCR   8,GR14                   IF SO,IT IS VALID,RETURN   000I 15330018
         CLI   0(SCANADR),C'$'         IS IT A NATIONAL CHARACTER  UL0H 15340017
         BCR   8,GR14                   IF SO,IT IS VALID,RETUR-   000I 15350018
         CLI   0(SCANADR),C'A'          ITS CHARACTER LESS THEN 'A'000I 15360018
         BL    INVALCHR                 IF SO,INVALID              000I 15370018
         CLI   0(SCANADR),C'I'          ITS CHARACTER LESS THEN I  000I 15380018
         BCR   12,GR14                  IF SI,ITIS VALID           000I 15390018
         CLI   0(SCANADR),C'J'          IS CHARACTER LESS THEN 'J' 000I 15400018
         BL    INVALCHR                 IF SO INVALID              000I 15410018
         CLI   0(SCANADR),C'R'          IS CHARACTER LESS THAN 'R' 000I 15420018
         BCR   12,GR14                  IF SO IT IS VALID          000I 15430018
         CLI   0(SCANADR),C'S'          IS CHARACTER LESS THEN 'S' 000I 15440018
         BL    INVALCHR                 IF SO,INVALID              000I 15450018
         CLI   0(SCANADR),C'Z'          IS CHARACTER GREATER THEN Z000I 15460018
         BH    INVALCHR                 IF SO INVALID                   15470018
         BR    GR14                    RETURN TO CALLER            UL0H 15480017
         SPACE 1                                                        15680000
SEQERR   LA    GR11,NUMMSG        INVALID NUMBER RANGE          YA01677 15683002
         B     TONEXT             GIVE MESSAGE,FLUSH            YA01677 15686002
COMMERR  NI    COL72LG,X'7F'           RESET COL72 SWITCH      @ZA16462 15688099
SCANERR  LA    GR11,SCANMSG            CONTROL STATEMENT ERROR     UL0H 15690017
         B     TONEXT                  GIVE MESSAGE, FLUSH         UL0H 15700017
ABSEQERR LA    GR11,SEQMSG             SEQUENCE ERROR MESSAGE CODE UL0H 15710017
         B     TONEXT                  GIVE MESSAGE, FLUSH         UL0H 15720017
INVALOP  LA    GR11,ERROP              INVALID OPERATION MESSAGE COUL0H 15730017
TONEXT   CLI   PRINTED,X'0F'           HAS CARD ALREADY BEEN PRINTEUL0H 15740017
         BE    SKIPPRNT                YES- DO NOT PRINT IT AGAIN  UL0H 15750017
         BAL   GR14,CARDPRNT           PRINT INVALID STATEMENT     UL0H 15760017
SKIPPRNT L     GR15,PRIMEWRT           ADDRESS OF MESSAGE WRITER   UL0H 15770017
         MVI   PRINTED,RESET0          CLEAR PRINT SWITCH          UL0H 15780017
         BALR  GR14,GR15               GIVE MESSAGE                UL0H 15790017
SETFLUSH MVI   FLUSHSW,X'0F'           SET FLUSH SWITCH        @AZ27974 15800000
         MVI   RIDIT2SW,RESET0         NEXT COMMAND IN ERROR TOO   UL0H 15810017
         MVI   TEMPCON,X'04'           SET RETURN CODE           A45121 15812021
STOWIT   L     GR15,PROCESS            ADDRESS OF CSECT WITH FLUSH UL0H 15820017
         BR    GR15                    ENTER CSECT                 UL0H 15830017
STOWIT1  MVI   COMDCD,X'00'            RESET COMMAND SWITCH        4929 15983017
         B     STOWIT                                              4929 15986017
STOWIT2  LA    GR11,ERRMSGC            CANNOT PROCESS MORE THAN ONE4929 15989017
STOWIT3  MVI   COMDCD,X'00'            RESET COMMAND SWITCH        4929 15992017
         B     SKIPPRNT                GO PRINT ERROR MESSAGE      4329 15995017
LABELANL TM    PARAMSW,X'20'           DOES PARAMETER FOLLOW     A45205 15995122
         BNO   NORMLAB                 NO,NORMAL PROCESSING      A45205 15996222
         MVI   LABEL2SW,X'FF'          SET SWITCH ,NO LABEL PROC A45205 15998222
         B     TOSCAN                  CONTINUE SCANNING KEYW    A45205 15998622
NORMLAB  BAL   GR14,CARDPRNT            PRINT RECORD             A45205 15998722
         CLI   LABELSW,X'00'            IS IT HEADER PROCESSING    UL0H 15999822
         BE    HEADERIN                 IF SO,GET CORE             UL0H 16000922
         CLI   LABELSW,X'10'            IS IT TRAILER PROCESSING   UL0H 16002022
         BNE   INVALOP                  IF NOT,ERROR               UL0H 16003122
         MVI   LABELCNT,X'00'           INIT NO. OF LABELS         UL0H 16004222
         MVI   LABELSW,X'20'            TRAILER LABELS             UL0H 16005322
READLABL CLI   LABELSW,X'20'           PROCESSING TRAILER LABELS   UL0H 16006422
         BE    READTRLR                IF SO,GET PROPER SAVE AREA  UL0H 16007522
         LA    GR6,OMLABELS            ADDRESS OF O M LABEL SAVE ARUL0H 16008622
         B     READLBLS                PREPARE TO READ LABELS      UL0H 16009722
READTRLR L     GR6,LABELBUF            ADDRESS OF GETMAIN AREA     UL0H 16010822
READLBLS SR    GR7,GR7                 INIT LABEL COUNT FIELD      UL0H 16011922
         MVI   LABEL2SW,X'0F'           LABELS TO BE PROCESSED     UL0H 16013022
         B     STOWIT                   PREPARE TO ENTER IEBUPDT2  UL0H 16014122
HEADERIN CLI   FRSTCOMD,X'FF'          HAS A COMMAND BEEN SEEVICED UL0H 16015222
         BNE   HEADLABL                 IF NOT,MUST BE HEADERS     UL0H 16016322
         MVI   FRSTCOMD,X'00'           RESET DCB'S OPENED         UL0H 16017422
         MVI   LABELSW,X'10'            HEADERS TO CREATE          UL0H 16018522
HEADLABL IC    GR15,LABELSW             PICK UP NO OF LABELS       UL0H 16019622
         LA    GR15,16(GR15)            ADD TEN TO                 UL0H 16020722
         STC   GR15,LABELSW             LABEL SWITCH               UL0H 16021822
         GETMAIN    R,LV=720            GET 8 LABEL BUFFER         UL0H 16022922
         ST    GR1,LABELBUF             SAVE ITS ADDRESS           UL0H 16024022
         B     READLABL                 PREPARE TO READ LABELS     UL0H 16025122
CHEKCOMD CLC   0(6,SCANADR),COMDEND     IS COMMAND 'ENDUP'         UL0H 16026222
         MVI   LABEL2SW,X'00'          RESET LABEL PROCESS SWITCH  UL0H 16027322
         BE    SCANNED                  IF SO,CONTINUE             UL0H 16028422
         B     ABSEQERR                 ELSE,ERROR                 UL0H 16029522
CHKDATA  BAL   GR9,PARATEST            TEST PARAMETER            A45205 16029922
         CLI   LABEL2SW,X'FF'          COMMAND WAS LABEL         A45205 16030422
         BNE   SCANERR                 NO,ERROR                  A45205 16030522
         LA    GR6,2                   LENGTH OF PARAMETER MUST  A45205 16039522
         CR    GR6,LENGTH              BE TWO                    A45205 16041522
         BNE   SCANERR                 IF NOT,ERROR              A45205 16043522
         CLC   0(2,SCANADR),NO         IS PARAMETER NO           A45205 16043922
         BNE   SCANERR                 IF NOT,ERROR              A45205 16044322
         L     GR6,DCBOM               LOAD DCB OLD MASTER       A45205 16044422
         L     GR6,36(GR6)             LOAD DCBEXIT ADDRESS      A45205 16044522
         MVI   0(GR6),X'00'            INACTIVATE INHDR EXIT     A45205 16044722
         MVI   4(GR6),X'00'            INACTIVATE INTRL EXIT     A45205 16044822
         L     GR6,DCBNM               LOAD DCB NEW MASTER       A45205 16048322
         L     GR6,36(GR6)             LOAD DCBEXIT ADDRESS      A45205 16050322
         MVI   0(GR6),X'00'            INACTIVATE OUTHDR EXIT    A45205 16055522
         MVI   4(GR6),X'00'            INACTIVATE OUTTRL EXIT    A45205 16059022
         BAL   GR14,CARDPRNT           PRINT CARD                A45205 16062522
         B     STOWIT                  RETURN                    A45205 16066022
ENDUPANL CLI   FLUSHSW,X'0F'           EOF DURING FLUSH            4929 16069522
         MVI   EODCTSW,X'0F'      SET EOF SWITCH OF SYSIN        A31449 16073022
         BE    STOWIT             YES.. FINISH PROCESSING        A31449 16076522
         BAL   GR14,CARDPRNT           PRINT ENDUP DETAIL STATEMEMT4929 16080022
         MVI   PRINTED,X'0F'           FLAG AS CARD ALREADY PRINTED4929 16086400
         CLI   CHNGESW,X'0F'      CHANGE COMMAND?              @YA02571 16088402
         BNE   BYPASS             NO,BRANCH TO TEST OTHER COMD @YA02571 16090402
         B     INVALOP            BRANCH TO GIVE ERROR MSG     @YA02571 16092402
BYPASS   BAL   GR9,TESTCMD        MUST HAVE A COMD CARD        @YA02571 16093202
         MVI   FINICCS,X'0F'           FLAG AS SYSIN THRU               16100000
         CLI   REPLSW,X'0F'       REPL COMMAND?                @YA02570 16104002
         BE    NORECIN            YES,BRANCH TO GIVE ERROR MSG @YA02570 16108002
         CLI   ADDSW,X'0F'        ADD COMMAND?                 @YA02570 16112002
         BE    NORECIN            YES,BRANCH TO GIVE ERROR MSG @YA02570 16116002
         B     STOWIT                  ENTER PROCESSING ROUTINE         16140000
NORECIN  LA    GR7,SYSINNM        ADDR OF SYSIN DD NAME        @YA02570 16145002
         LA    GR11,ERRMSGN       SYSIN HAS NO RECORDS MSG     @YA02570 16150002
         B     TONEXT             ENTER PROCESSING ROUTINE     @YA02570 16155002
QUITS    MVI   PRINTED,X'0F'           FLAG AS ENDUP PRINTED            16160000
LASTLEG  LA    GR11,EOJMESSG           ADDRESS OF EOJ MESSAGE           16180000
         CLC   TEMPCON(1),HICONCDE+1   RETURN CODE LESS                 16200000
         BNH   RSAME                   EQUAL OR LESS USE HICONCDE       16220000
         MVC   HICONCDE+1(1),TEMPCON   SWAP FOR HIGHER CODE             16240000
RSAME    MVI   QUITALL,X'0E'           FORCE EOJ AND EOJ MESSAGE        16260000
         B     TONEXT                  END JOB                          16280000
         EJECT                                                          16300000
         SPACE 1                                                        16380000
LENGTH   EQU   0                       LENGTH OF PARAM REGISTER 0       16400000
SCANADR  EQU   1                       ADDRESS OF PARAMETER REGISTER 1  16420000
BIT80    EQU   X'80'                   ERROR SWITCH                     16440000
BIT40    EQU   X'40'                   BYPASS SWITCH                    16460000
BIT20    EQU   X'20'                   EOF, PARAMETER FOLLOWS SWITCH    16480000
BIT10    EQU   X'10'                   FIRST ENTRY, PARTIAL PARAMETER   16500000
BIT08    EQU   X'08'                   COMMAND, COLUMN 72 NON-BLANK SW  16520000
BIT04    EQU   X'04'                   KEYWORD, COLUMN 72 NON-BLANK SW  16540000
BIT02    EQU   X'02'                   PARAMETER SWITCH                 16560000
BIT01    EQU   X'01'                   LENGTH EQUALS ZERO SWITCH        16580000
RESET0   EQU   X'00'                   RESET BITS                       16600000
MOVESSIL MVC   0(1,GR3),0(SCANADR)     MOVE SSI DATA OR LEVEL TO RRSAVE 21360000
SAVE13X  DS    F                       SAVE REGISTER 13                 21380000
SAVLGTH  DS    F                       SAVES LENGTH REGISTER            21400000
COMMCARD DC    CL8'./      '                                   @ZA16462 21410099
BLANKS8  DC    CL8' '                  8 HEX BLANKS                     21420000
ZEROHEX  DC    C'00000000'             DOUBLE WORD HEX ZEROS            21440000
PRIMEWRT DC    V(IEBUPLOG)             ADDRESS OF LOG ROUTINE           21460000
PROCESS  DC    V(IEBUPDT2)             ADDRESS OF PROCESSING CSECT      21480000
RDCARD   DC    V(IEBBSCAN)             ADDRESS OF CARD SCAN RTN    UL0H 21490017
SARG     DS    D                       SEARCH ARGUMENT                  21500000
REGSAVE  DS    18F                     SAVE REGISTERS                   21520000
RRSAVE   DS    16F                     SAVE AREA USED BY RDCARD         21540000
ZERO     DC    D'0'                    BUFFER OF ZEROS                  21560000
EIGHT    DC    F'8'                                                     21580000
MVINHDEX MVC   0(1,GR3),0(GR10)        MOVE LABEL NAME TO BUFFER        21600000
OPRLUP3  MVC   SARG(1),0(SCANADR)      MOVE KEYWORD TO SEARCH ARGUMENT  21620000
MOVNAME  MVC   0(1,GR7),0(SCANADR)     LEFT ADJUST MEMBER NAME          21640000
PACKIT   PACK  TEMPWA(L8),D0(L1,GR10)  PACK INCR OR NEW1        YM07522 21641002
ALTTT    DC    X'0A0B0C0D0E0FDDDDDD'   TABLE TO CONVERT TO HEX          21660000
         DC    X'DDDDDDDDDDDD'                                          21680000
         DC    X'00010203040506070809'                                  21700000
YESYES   DC    C'YES'                  DESIGNATES INSERT BLOCK          21720000
LISTSET  DC    C'ALL'                  ONLY ALLOWABLE 'LIST' PARAMETER  21740000
EOFDC    DC    C'EOF'                  ONLY INPUT FOR 'IGNORE' OPTION   21760000
NEWPO    DC    C'PO'                   NEW MASTER DS TYPE IDENTIFIER    21780000
NEWPS    DC    C'PS'                   NEW MASTER DS TYPE IDENTIFIER    21800000
INPLACE  DC    C'INPLACE'              PARAMETER FOR UPDATE INPLACE     21820000
COLUMN80 DC    C'80'                   COLUMN 80                        21840000
COLUMN01 DC    C'01'                   COLUMN 01                        21860000
DOTSLASH DC    C'./'                   CONTROL CARD INDICATION          21880000
NO       DC    C'NO'                   INDICATING NO USER LABEL  A45205 21882022
MAXCORE  DC    F'32769'           MAX TOTALSIZE + 1              A36128 21890021
PACKSIZE PACK  TEMPTOT(8),0(1,SCANADR)                             UL0H 21900017
COLM1BUF DC    C'00'                   HOLDS COLUMN SPEC IF ONLY 1 CHAR 21920000
FIVE     DC    F'5'                                                UL0H 21946017
TEMPTOT  DS    D                                                   UL0H 21953017
COMEBACK DC    F'0'                    SAVE AREA FOR REG14     @ZA16462 21955099
PATCH    NOP   PATCH                   PATCH AREA              @ZA16462 21957099
         DC    10F'0'                                          @ZA16462 21959099
NUMERIC  EQU   X'F0'                                                    21960000
ALPHA    EQU   X'C0'                                                    21980000
PODSET   EQU   2                       DSORG FIELD SETTING FOR PODS     22000000
PSDSET   EQU   X'40'                   DCB SETTING FOR SEQUENTIAL       22020000
PODPS    EQU   PODSET+PSDSET           SETTING FOR PODS OR PS DSORG     22040000
EXLIST   EQU   X'24'                   OFFSET OF EXIT LIST POINTER DCB  22060000
         EJECT                                                          22080000
         DCBD  DSORG=PS                                                 22100000
BDSORG   EQU   DCBDSORG-IHADCB         DATA SET ORGANIZATION FIELD DCB  22120000
         EJECT                                                          22140000
         IEBUPCON                                                       22160000
         END   IEBASCAN                                                 22180000
./  ADD  SSI=70610094,NAME=IEBBSCAN
*********************************************************************** 00007017
*                                                                     * 00014017
*                   *****       I E B B S C A N        *****          * 00021017
*                                                                     * 00028017
* STATUS. CHANGE LEVEL 000.                                           * 00035017
*                                                                     * 00042017
* FUNCTION/OPERATION.                                                 * 00049017
*        THIS CSECT SCANS CONTROL CARD STATEMENTS,SETS FLAGS IN       * 00056017
*        THE COMMUNICATION REGION AT SWITCHRD AND RETURNS POINTERS    * 00063017
*        TO IEBASCAN FOR ANALYSIS.                                    * 00070017
*                                                                     * 00077017
* ENTRY POINTS.                                                       * 00084017
*        ENTERED FROM IEBASCAN AT IEBBSCAN.                           * 00091017
*                                                                     * 00098017
* INPUT.                                                              * 00105017
*        CONTROL CARD PARAMETERS TO BE ANALYZED AT SWITCHRD.          * 00112017
*                                                                     * 00119017
* OUTPUT.                                                             * 00126017
*        DIAGNOSTIC MESSAGES FROM IEBUPLOG.                           * 00133017
*                                                                     * 00140017
* EXITS-NORMAL.                                                       * 00147017
*        RETURN TO IEBBSCAN AFTER A PARAMETER HAS BEEN ANALYZED.      * 00154017
*        IF A CONTINUATION CARD MUST BE READ,CONTROL IS PASSED TO     * 00161017
*        IEBUPDT2 WHICH WILL READ A CARD FROM SYSIN AND PASS          * 00168017
*        CONTROL TO IEBBSCAN VIA IEBASCAN.                            * 00175017
*                                                                     * 00182017
* EXITS-ERROR.                                                        * 00189017
*        FLAGS ARE SET AND CONTROL IS RETURNED TO IEBASCAN.           * 00196017
*                                                                     * 00203017
* EXTERNAL ROUTINES.                                                  * 00210017
*        IEBASCAN,IEBUPLOG AND IEBUPDT2.                              * 00217017
*                                                                     * 00224017
* TABLES/WORK AREAS.                                                  * 00231017
*        SWITCHRD WHICH IS A BUFFER IN IEBUPCON CONTAINING THE        * 00238017
*        CONTROL CARD UNDERGOING ANALYSIS AND SWITCHES.               * 00245017
*                                                                     * 00252017
* ATTRIBUTES.                                                         * 00259017
*        SERIALLY REUSABLE, BOLCK LOADS.                              * 00266017
*                                                                     * 00273017
*********************************************************************** 00280017
         EJECT                                                          00300017
*********************************************************************** 00600017
*                      CONTROL STATEMENT ANALYSIS ROUTINES            * 00900017
*********************************************************************** 01200017
         SPACE 1                                                        01500017
GR0      EQU   0                                                        01800017
GR1      EQU   1                                                        02100017
GR2      EQU   2                                                        02400017
GR3      EQU   3                                                        02700017
GR4      EQU   4                                                        03000017
GR5      EQU   5                                                        03300017
GR6      EQU   6                                                        03600017
GR7      EQU   7                                                        03900017
GR8      EQU   8                                                        04200017
GR9      EQU   9                                                        04500017
GR10     EQU   10                                                       04800017
GR11     EQU   11                                                       05100017
GR12     EQU   12                                                       05400017
GR13     EQU   13                                                       05700017
GR14     EQU   14                                                       06000017
GR15     EQU   15                                                       06300017
D0       EQU   0                        DISPLACEMENT OF 0       YM07522 06300402
D1       EQU   1                        DISPLACEMENT OF 1       YM07522 06302002
LENGTH   EQU   0                       LENGTH OF PARAM REGISTER 0       06600017
SCANADR  EQU   1                       ADDRESS OF PARAMETER REGISTER 1  06900017
BIT80    EQU   X'80'                   ERROR SWITCH                     07200017
BIT40    EQU   X'40'                   BYPASS SWITCH                    07500017
BIT20    EQU   X'20'                   EOF, PARAMETER FOLLOWS SWITCH    07800017
BIT10    EQU   X'10'                   FIRST ENTRY, PARTIAL PARAMETER   08100017
BIT08    EQU   X'08'                   COMMAND, COLUMN 72 NON-BLANK SW  08400017
BIT04    EQU   X'04'                   KEYWORD, COLUMN 72 NON-BLANK SW  08700017
BIT02    EQU   X'02'                   PARAMETER SWITCH                 09000017
BIT01    EQU   X'01'                   LENGTH EQUALS ZERO SWITCH        09300017
RESET0   EQU   X'00'                   RESET BITS                       09600017
EQUAL    EQU   C'='                    HEX 'EQUAL'                      09900017
COMMA    EQU   C','                    HEX 'COMMA'                      10200017
BLANKCOL EQU   C' '                    HEX 'BLANK'                      10500017
SWF0     EQU   X'F0'                    DOUBLE PARM FLAGS       YM07522 10502002
SWF8     EQU   X'F8'                                            YM07522 10504002
SWFC     EQU   X'FC'                                            YM07522 10506002
SWFE     EQU   X'FE'                                            YM07522 10508002
         SPACE 1                                                        10800017
IEBBSCAN CSECT                                                          11100017
*                                                                A27507 11200019
*A684500-686700,699000,699500                                    A48723 11250022
*C750000                                                         A48723 11300022
*A63004-63020,105020-105080,329420-329440,345420-345440         YM07522 11302002
*A346020-346080,347020-347080.671020-671080                     YM07522 11304002
*C346000,346200,346400,347000,347200,671000,672000              YM07522 11308002
*A240100,240500,270100,270200,492500,493000,495500,660500,      YA01700 11318002
*A661000,699100,699200,705500,706000,711500,771500,772000       YA01700 11328002
*C264000,663000,780000                                          YA01700 11338002
*D243000,702000                                                 YA01700 11348002
*A 534500-535500                        @XA16051=(ORG)@YA14019=@ZA16462 11398099
RDCARD   SAVE  (14,12)                                                  11400017
         BALR  GR2,0                    ESTABLISH ADDRESSABILITY        11700017
         USING *,GR2                    USE REGISTER 2                  12000017
         USING IEBUPCON,GR12            COMMUNICATION REGION            12300017
         ST    GR13,RRSAVE+4            SAVE OLD SAVE AREA ADDRESS      12600017
         LA    GR13,RRSAVE              ESTABLISH NEW SAVE ADDRESS      12900017
         L     GR3,STOREG+8            LOAD ADDRESS OF LAST PASS        13200017
         CLI   CCSCANSW,BIT01          IS IT RETURN FROM CONTINUATION   13500017
         BE    RESETCON                YES-SCAN CONTINUATUION           13800017
         NI    SWITCHRD,X'7F'          RESET ERROR BIT                  14100017
         TM    SWITCHRD,BIT40          TEST BYPASS SWITCH               14400017
         BC    1,KBYPO                 IF ON GO TO BYPASS ROUTINE       14700017
         TM    PARAMSW,BIT08           TEST READ CARD SWITCH            15000017
         BC    1,KGTCD                 IF ON, READ A CARD               15300017
         TM    PARAMSW,BIT20           DOES A PARAMETER FOLLOW          15600017
         BC    1,SCANR                 YES- SCAN THE CARD               15900017
         TM    PARAMSW,BIT40           CONTINUATION SWITCH SET          16200017
         BC    1,KCONT                 YES- PROCESS CONTINUED PART      16500017
         LA    GR3,SWITCHRD+1          LOAD ADDRESS OF FIRST COLUMN     16800017
         CLC   0(2,GR3),DOTSLASH       IS CARD A CONTROL CARD  (./)     17100017
         BNE   KTER                    NO- ERROR CONDITION              17400017
         LA    GR3,2(GR3)              SKIP TO NAME COLUMN              17700017
KNAME    CLI   0(GR3),BLANKCOL         IS COLUMN BLANK                  18000017
         LA    GR5,LASTCOLM            LOAD 5 WITH COLUMN 71 OF CARD    18300017
         BE    KOMMD                   YES- GO TO COMMAND WORD ROUTINE  18600017
         CR    GR3,GR5                 TEST IF SCANNED TO COLUMN 71     18900017
         BE    KNOP                    YES- END OF CARD REACHED         19200017
         LA    GR3,1(GR3)              GO TO NEXT COLUMN                19500017
         B     KNAME                   CHECK FOR BLANK                  19800017
KOMMD    LA    GR3,1(GR3)              SPACE TO NEXT COLUMN AFTER COMD  20100017
         OI    PARAMSW,BIT04           SET COMMAND SWITCH PARAM FOLLOW  20400017
         OI    SWITCHRD,BIT08          SET COMMAND BIT '08'             20700017
         NI    DELIMIN,RESET0          RESET DELIMITER INDICATORS       21000017
KABC     CLI   0(GR3),BLANKCOL         IS COLUMN BLANK                  21300017
         BNE   SCAN                    NO- CHECK PARAMETER              21600017
         CR    GR3,GR5                 IS THIS THE END COLUMN           21900017
         BE    KNOP                    YES- END OF CARD REACHED         22200017
         LA    GR3,1(GR3)              ADJUST POINTER TO NEXT COLUMN    22500017
         B     KABC                    CONTINUE SCAN                    22800017
KCONT    LA    GR3,SWITCHRD+1          FIRST COLUMN OF CONTINUED CARD   23100017
         CLC   0(2,GR3),DOTSLASH       IS CARD A CONTROL CARD           23400017
         BNE   KTER                    NO- ERROR CONDITION              23700017
         LA    GR3,SWITCHRD+16         SET POINTER TO COLUMN 16         24000017
         TM    PARAMSW,BIT10      PARTIAL PARAMETER SW SET?    @YA01700 24100002
         BO    CONTINUE           CONTINUE SCANNING             YA01700 24200002
SCANR    NI    SWITCHRD,X'F7'          RESET COMMAND BIT                24600017
SCAN     NI    SWITCHRD,X'98'          RESET ALL BUT ERROR, 1ST ENTRY   24900017
         NI    PARAMSW,X'14'           RESET  BUT COMD/PARA FOLL A48723 25200000
         MVC   DELIMIN2(1),DELIMIN     SAVE DELIMITER SWITCH SETTINGS   25500017
         NI    COL72LG,X'0C'           RESET EXIT CONTROL SWITCH        25800017
         NI    DELIMIN,RESET0          CLEAR DELIMITER SWITCH           26100017
CONTINUE SR    GR7,GR7                 CLEAR LENGTH REGISTER    YA01700 26400002
         LR    GR1,GR3                 SAVE POINTER TO PRESENT COLUMN   26700017
         LA    GR5,LASTCOLM            LOAD ADDRESS OF END COLUMN       27000017
         CR    GR3,GR5            ALREADY IN COL. 72?           YA01700 27010002
         BE    KPART              YES,GO TO PART PARAMETER SAVE YA01700 27020002
KOMPAR   CLI   0(GR3),EQUAL            IS CHARACTER A DELIMITER  A48723 27050022
         BNH   DELIMIT                 YES-'EQUAL' CHARAC OR LOW A48723 27100022
KOMPAR2  LA    GR7,1(GR7)              CHECK ONE FURTHER         A48723 27150022
KOMPAR3  CR    GR3,GR5                ALREADY AT COL 72          A48723 27900022
         BE    KPART                   YES-GO TO PARTIAL PARAMETER SAVE 28500017
         LA    GR3,1(GR3)              UP POINTER TO NEXT COLUMN A48723 28800022
         B     KOMPAR                  CONTINUE SCANNING FOR DELIMITER  29100017
KNOP     OI    SWITCHRD,BIT80          FLAG AS NO COMD OR PARAM ON CARD 29400017
         SR    GR1,GR1                 CLEAR SCAN REGISTER              29700017
         SR    GR7,GR7                 CLEAR LENGTH REGISTER            30000017
KNOPAR   OI    SWITCHRD,BIT40          NO KEYWORD OR PARAMETERS FOLLOW  30300017
KPASS    LA    GR3,1(GR3)              UP POINTER TO NEXT COLUMN        30600017
         NI    PARAMSW,X'EB'           CLEAR ALL BUT BYPASS-PART PARAM. 30900017
         ST    GR7,STOREG              STORE LENGTH REGISTER            31200017
         ST    GR1,STOREG+4            STORE SCANADR REGISTER           31500017
         ST    GR3,STOREG+8            STORE ADDRESS REGISTER           31800017
         L     GR13,RRSAVE+4                                            32100017
         LM    GR14,GR12,12(GR13)                                       32400017
         BR    GR14                    RETURN TO MAINSTREAM             32700017
DELIMIT  CLI   0(GR3),C'$'              CHARACTER A DOLLAR SIGN         32740017
         BE    KOMPAR2                  IF SO, OK                       32780017
         CLI   0(GR3),X'7C'             CHARACTER AN AT SIGN            32820017
         BE    KOMPAR2                  IF SO, OK                       32860017
         CLI   0(GR3),C'#'              CHARACTER A POUND SIGN          32900017
         BE    KOMPAR2                  IF SO, OK                       32940017
         CLI   D0(GR3),C'*'             CHARACTER AN ASTERISK   YM07522 32942002
         BE    KOMPAR2                  IF SO, OK               YM07522 32944002
         CLI   0(GR3),C'('              CHARACTER A LEFT PARENTHESIS    32980017
         BE    LFTPAREN                 IF SO,CHECK FURTHER             33020017
         CLI   0(GR3),C''''             CHARACTER A QUOTE               33060017
         BE    QUOTE                    IF SO,CHECK FURTHER             33100017
         CLI   0(GR3),C')'              CHARCTER A RIGHT PARENTHESIS    33140017
         BE    RTPAREN                  IF SO,CHECK FURTHER             33180017
DELIMB   CR    GR3,GR5                  END COLUMN                      33220017
         BE    SETCC2                  YES- SET INDICATOR               33300017
         OI    COL72LG,BIT40           SET DELIMITER BEFORE LAST SWITCH 33600017
         TM    PARAMSW,BIT10           IS PARTIAL PARAMETER SWITCH ON   33900017
         BC    1,KPPAR                 YES-COMPLETE PARAMETER           34200017
         B     TESTPAR                 CHECK PARAMETER                  34500017
QUOTE    CLI   TOTALSW,X'F0'            TOTALING REQUESTED              34520017
         BE    LFTPAREN                 IF SO,CHECK FURTHER             34540017
         CLI   SQFSW,SWF0               SEQFLD BEING PROCESSED  YM07522 34542002
         BE    LFTPAREN                 YES - TREAT AS PAREN    YM07522 34544002
         B     RTPAREN                  IF NOT,TREAT AS RGTH PAREN      34560017
LFTPAREN CLI   TOTALSW,X'F0'            IS LEFT PAREN EXPECTED          34580017
         BE    TOTLP                    YES - FOR TOTAL         YM07522 34600002
         CLI   SQFSW,SWF0               FOR SEQFLD              YM07522 34602002
         BNE   DELIMB                   NO - ERROR              YM07522 34604002
         MVI   SQFSW,SWF8               SET FOR COMMA NEXT      YM07522 34606002
         B     LPCONT                   CONTINUE                YM07522 34608002
TOTLP    MVI   TOTALSW,SWF8             SET FOR COMMA NEXT      YM07522 34620002
LPCONT   LA    GR1,D1(GR1)              UP POINTER TO NEXT CHAR YM07522 34640002
         B     KOMPAR3                  ANALYZE NEXT             A48723 34660000
RTPAREN  CLI   TOTALSW,X'FC'            IS RIGHT PAREN EXPECTED         34680017
         BE    TOTRP                    YES - FOR TOTAL         YM07522 34700002
         CLI   SQFSW,SWFC               FOR SEQFLD              YM07522 34702002
         BNE   KPASS                    NO -ERROR               YM07522 34704002
         MVI   SQFSW,SWFE               RIGHT PAREN FOUND       YM07522 34706002
         B     KOMPAR3                  CONTINUE                YM07522 34708002
TOTRP    MVI   TOTALSW,SWFE             RIGHT PAREN FOUND       YM07522 34720002
         B     KOMPAR3                  PREPARE TO RETURN        A48723 34740000
LENGTH0  OI    COL72LG,BIT01           SET LENGTH EQUAL TO ZERO         34800017
         B     DELIM                   CHECK DELIMITERS                 35100017
SETCC2   OI    COL72LG,BIT20           SET DELIMITER IN LAST SWITCH     35400017
         TM    PARAMSW,BIT10           IS PARTIAL PARAMETER SWITCH ON   35700017
         BC    1,KTERBY                YES- LENGTH IS TOO LONG          36000017
TESTPAR  LTR   GR7,GR7                 CLEAR LENGTH REGISTER            36300017
         BC    8,LENGTH0               LENGTH EQUALS ZERO, SET SWITCH   36600017
         OI    COL72LG,BIT02           SET LENGTH GREATER THAN ZERO     36900017
DELIM    CLI   0(GR3),EQUAL            TEST IF DELIMITER IS AN EQUAL    37200017
         BE    KEY                     YES- GO TO KEY WORD ROUTINE      37500017
         CLI   0(GR3),COMMA            TEST FOR COMMA                   37800017
         BE    PARAMC                  YES- GO TO PARAMETER ROUTINE     38100017
         CLI   0(GR3),BLANKCOL         TEST FOR BLANK                   38400017
         BE    PARBLANK                YES- GO TO HANDLE BLANK PARAM    38700017
         TM    COL72LG,BIT20           IS DELIMITER IN END COLUMN       39300017
         BC    1,KSETP                 YES- SET PARAMETER FOLLOWS SW.   39600017
KINVAL   OI    SWITCHRD,BIT80          SET INVALID DELIMITER ERROR SW   39900017
         LA    GR7,1(GR7)              ADJUST LENGTH REGISTER           40200017
         LA    GR3,1(GR3)              ADJUST SCAN POINTER              40500017
         CLI   0(GR3),EQUAL            IS CHARACTER A DELIMITER         40800017
         BL    KINV                    YES- TWO DELIMITERS IN A ROW     41100017
         CR    GR3,GR5                 END COLUMN                       41400017
         BL    KINVAL                  NO- SCAN SOME MORE               41700017
         TM    COL72LG,BIT08           IS COLUMN 72 BLANK               42000017
         BC    1,KTERBY                YES                              42300017
         LA    GR7,1(GR7)              ADJUST LENGTH REGISTER           42600017
         B     KPTERR                  ESTABLISH PARAMETER              42900017
KINV     TM    PARAMSW,BIT04           IS COMMAND CONTROL SWITCH ON     43200017
         BC    1,KPCMD                 YES- ADJUST POINTER TO NEXT ONE  43500017
PRFOL    OI    PARAMSW,BIT20           SET PARAMETER FOLLOWS SWITCH     43800017
         B     KPASS                   GO TO RETURN                     44100017
KBYPO    CLI   SWITCHRD+72,BLANKCOL    IS CONTINUATION COLUMN 72 BLANK  44400017
         BNE   KGTCD                   NO- GET ANOTHER CARD             44700017
         NI    SWITCHRD,BIT10          RESET PARTIAL PARAMETER SWITCH   45000017
         NI    PARAMSW,RESET0          RESET ENTRY CONTROL SWITCH       45300017
KGTCD    CLI   FIRSENTR,BIT10          VERY FIRST CARD                  45600017
         BE    GOAHEAD                 YES- PAGE ALREADY SKIPPED        45900017
         CLI   COMDCD,X'0E'            IS THIS A COMMAND CARD           46200017
         BNE   GOAHEAD                 NO- JUST PRINT CARD              46500017
         CLI   FIRSTCON,X'0F'          FIRST PART OF CONTINUATION CARD  46800017
         BE    GOAHEAD                 NO- DO NOT SKIP PAGE             47100017
         MVI   FIRSTCON,X'0F'          SET AS FIRST CONTINUATION CARD   47400017
         LA    GR14,ONTOCC             RETURN ADDRESS FROM 'PRINTY'     47700017
         MVI   PRIMESW,X'0E'           FORCE PRINTING OF HEADER         48000017
         B     PRINTY                  PRINT FIRST CONTINUATION CARD    48300017
GOAHEAD  BAL   GR14,CARDPRNT           PRINT REST OF CONTINUATION CARD  48600017
ONTOCC   MVI   CCSCANSW,BIT01          SET SCAN ROUTINE READ SWITCH     48900017
         L     GR15,PROCESS            ADDRESS OF CSECT WITH READCC     49200017
         TM    PARAMSW,BIT10      IS PARTIAL PARAMETER SW ON?   YA01700 49300002
         BC    1,RETURN           YES,SET UP FOR RETURN         YA01700 49400002
         BR    GR15                    ENTER THE CSECT                  49500017
RETURN   BALR  GR7,GR15           ENTER UPDT2 TO GET CONT. CARD YA01700 49600002
RESETCON MVI   CCSCANSW,RESET0         CLEAR CONTINUATION SWITCH        49800017
         B     KCONT                   ANALYSE CONTINUATION CARD        50100017
PARBLANK TM    PARAMSW,BIT04           IS COMMAND SWITCH ON             50400017
         BC    1,KPCMD                 YES-GO TO ADJUST POINTER         50700017
         OI    SWITCHRD,BIT02          SET PARAMETER PRESENT BIT        51000017
         OI    DELIMIN,BIT08           SET BLANK DELIMITER SWITCH       51300017
         TM    DELIMIN2,X'80'           WAS LAST A COMMAND WORD         51340017
         BC    1,DECID                  IF SO,CHECK SOME MORE           51380017
         CLI   SWITCHRD+72,BLANKCOL     IS COL 72 BLANK                 51420017
         BE    SCANERR                  IF SO,ERROR                     51460017
         TM    DELIMIN2,BIT40          WAS LAST DELIMITER BLANK    UL0H 51500017
         BC    14,SCANERR               IF NOT,ERROR                    51540017
DECID    TM    COL72LG,BIT20           IS DELIMITER IN END COLUMN       51600017
         BC    1,KWENT                 YES- SET TO READ A CARD          51900017
         TM    COL72LG,BIT01           IS LENGTH EQUAL TO ZERO          52200017
         BC    1,KFORZRO               YES-SET UP FOR ZERO LENGTH       52500017
         OI    PARAMSW,BIT20           SET PARAMETER FOLLOWS SWITCH     52800017
         TM    DELIMIN,BIT08           IS DELIMITER A BLANK             53100017
         BC    8,KPASS                 NO- RETURN WITH POINTERS SET     53400017
         CLI   SWITCHRD+72,BLANKCOL    COL72 BLANK?            @ZA16462 53450099
         BE    KETBYP                  YES, BRANCH             @ZA16462 53500099
         OI    COL72LG,BIT80           SET COL72 NOTBLNK SW    @ZA16462 53550099
KETBYP   OI    SWITCHRD,BIT40          SET BYPASS SWITCH                53700017
         B     KPASS                   GET SET TO RETURN                54000017
KFORZRO  SR    GR1,GR1                 CLEAR SCAN REGISTER              54300017
         SR    GR7,GR7                 CLEAR LENGTH REGISTER            54600017
         TM    DELIMIN,BIT08           IS DELIMITER A BLANK             54900017
         BC    1,KETRDCD               GO TO SET READ CARD AND CONTINUE 55200017
         OI    PARAMSW,BIT20           SET PARAMETER FOLLOWS SWITCH     55500017
         TM    DELIMIN,BIT80           IS DELIMITER AN EQUAL SIGN       55800017
         BC    1,KPPAR                 YES- SET UP ERROR CONDITION      56100022
         B     KPASS                   RETURN                           56400017
KETRDCD  OI    PARAMSW,X'48'           SET TO READ CARD AND CONTINUE    56700017
         TM    DELIMIN2,BIT40          IS LAST DELIMITER A COMMA        57000017
         BC    1,KGTCD                 YES- READ A CARD                 57300017
         TM    COL72LG,BIT08           IS COLUMN 72 BLANK               57600017
         BC    8,KETBYP                NO- SET BYPASS SWITCH AND RETURN 57900017
         LA    GR7,SWITCHRD+16         CARD COLUMN 16                   58200017
         CR    GR3,GR7                 IS SCAN ON COLUMN 16             58500017
         BE    KETBYP                  YES- SET BYPASS SWITCH           58800017
         TM    DELIMIN2,EQUAL          WAS LAST DELIMITER AN EQUAL      59100017
         BC    1,KETBYP                YES- SET BYPASS SWITCH           59400017
KTERBY   OI    SWITCHRD,BIT40          SET BYPASS SWITCH                59700017
KTER     OI    SWITCHRD,BIT80          SET ERROR SWITCH                 60000017
         B     KPASS                   RETURN                           60300017
KWENT    OI    PARAMSW,X'48'           SET TO READ CARD AND CONTINUE    60600017
         TM    COL72LG,BIT08           IS COLUMN 72 BLANK               60900017
         BC    1,KETCTBL               YES- SET BYPASS SWITCH AND CHECK 61200017
         TM    COL72LG,BIT01           IS LENGTH EQUAL TO ZERO          61500017
         BC    1,KZERO                 NO- RETURN                       61800017
         TM    DELIMIN,BIT08           IS DELIMITER A BLANK             62100017
         BC    1,KETBYP                YES- SET BYPASS SWITCH, RETURN   62400017
         B     KPASS                   RETURN                           62700017
KZERO    SR    GR7,GR7                 CLEAR LENGTH REGISTER            63000017
         TM    DELIMIN,BIT80           IS DELIMITER AN EQUAL            63300017
         BC    1,KTER                  YES- SET ERROR SWITCH            63600017
         TM    DELIMIN,BIT40           IS DELIMITER A COMMA             63900017
         BC    8,KGTCD                 NO- READ A CARD                  64200017
         CLC   DELIMIN(1),DELIMIN2     IS DELIMITER SAME AS LAST        64500017
         BE    KPASS                   YES- RETURN                      64800017
KETCTBL  OI    SWITCHRD,BIT40          SET BYPASS SWITCH                65100017
         TM    DELIMIN,BIT40           IS DELIMITER A COMMA             65400017
         BC    1,KTER                  YES- SET ERROR SWITCH            65700017
         B     KPASS                   RETURN                           66000017
KEY      TM    DELIMIN2,BIT80     LAST DELIMITER ALSO AN EQUAL? YA01700 66100002
         BC    1,SCANERR          YES,BRANCH TO GIVE ERROR MSG  YA01700 66200002
         OI    SWITCHRD,BIT04     SET KEY WORD SWITCH           YA01700 66300002
         OI    DELIMIN,BIT80           SET DELIMITER SWITCH             66600017
         CLI   1(GR3),BLANKCOL    IS  A BLANK AFTER THE EQUAL    A27507 66700022
         BE    SCANERR    ERROR, NO KEYWORDS BEGIN WITH A BLANK  A27507 66800019
         B     DECID                   GO TO CHECK DELIMITER            66900017
PARAMC   CLI   TOTALSW,X'F8'            WAS A COMMA FOUND               67000017
         BE    PTOTC                    YES - FOR TOTAL         YM07522 67100002
         CLI   SQFSW,SWF8               WAS A COMMA FOUND       YM07522 67102002
         BNE   PARAMD                   NO - CONTINUE           YM07522 67104002
         MVI   SQFSW,SWFC               FLAG FOR SEQFLD         YM07522 67106002
         B     PARAMD                   CONTINUE                YM07522 67108002
PTOTC    MVI   TOTALSW,SWFC             IF SO,FLAG AS SUCH      YM07522 67200002
PARAMD   OI    SWITCHRD,BIT02           FLAG PARAMETER FOUND            67300017
         NI    PARAMSW,X'DF'           SET PARAM SW FOLLOW OFF   A48723 67350022
         OI    DELIMIN,BIT40           SET DELIMITER COMMA SWITCH       67500017
         TM    DELIMIN2,X'80'           LAST A COMMAND                  67600017
         BC    14,SCANERR              IF NOT, CHECK SOME MORE     UL0H 67700017
         B     DECID                   GO TO CHECK DELIMITER            67800017
KPART    TM    PARAMSW,BIT10           IS PARTIAL PARAMETER SWITCH ON   68100017
         BC    1,KTERBY                YES-SET BYPASS AND ERROR SWITCH  68400017
         CLI   0(GR5),BLANKCOL         NO CONTINUATION CHAR      A48723 68450022
         BE    KPTERR                  NO CONTINUATION EXPECTED  A48723 68500022
CONTINU  TM    PARAMSW,BIT04           COMMAND SCANNING          A48723 68550022
         BC    1,SET                   YES SET BIT               A48723 68600022
         TM    SWITCHRD,BIT04          KEYWORD SCANNED ALREADY   A48723 68610000
         BC    1,KPTERR                YES,DO NOT SET KEYW SW    A48723 68620022
         OI    COL72LG,X'04'           SET BIT KEYWORD SCANNING  A48723 68650022
         B     KPTERR                  CONTINUE SCANNING         A48723 68660022
SET      OI    COL72LG,X'08'           SET BIT COMMAND SCANNING  A48723 68670022
KPTERR   OI    PARAMSW,BIT10           SET PARTIAL PARAMETER SWITCH     68700017
         TM    COL72LG,BIT08           IS COLUMN 72 BLANK               69000017
         BC    1,KLAST                 YES- GO TO SET PARAMETER BIT     69300017
         MVI   SAVEPAPR,BIT40          FLAG PARTIAL PARAMETER STORED    69600017
         MVC   SAVEPAPR+1(19),SAVEPAPR STORE PARTIAL PARAMETER   A48723 69900022
         LTR   GR7,GR7            IS LENGTH ZERO?               YA01700 69910002
         BZ    SKIPMOVE           YES,SKIP MOVING PART PARAM    YA01700 69920002
         BCTR  GR7,0                   SUBTRACT CONT. CHAR       A48723 69950022
         LR    GR10,GR7                                                 70500017
         LTR   GR10,GR10          IS LENGTH ZERO?               YA01700 70600002
         BZ    SKIPMOVE           YES,SKIP MOVING PART PARAM    YA01700 70700002
         BCTR  GR10,0                  DECREMENT FOR EXECUTE            70800017
         EX    GR10,MOVEP              MOVE PARTIAL PARAMETER TO BUFFER 71100017
SKIPMOVE STC   GR7,SWITCHRD+82    SAVE LENGTH OF PART PARAM     YA01700 71200002
         OI    PARAMSW,BIT40           SET CONTINUE BIT                 71400017
         TM    COL72LG,BIT04           IS COLUMN 72 BLANK               71700017
         BC    1,KGTCD                 NO- GET A CARD                   72000017
         OI    SWITCHRD,BIT80          YES- FLAG AS ERROR               72300017
         B     KETBYP                  SET BYPASS SWITCH                72600017
KLAST    OI    SWITCHRD,BIT02          SET PARAMETER BIT                72900017
         B     KETBYP                  SET BYPASS BIT                   73200017
KPPAR    SR    GR8,GR8                 CLEAR WORK REGISTER              73500017
         IC    GR8,SWITCHRD+82         LENGTH OF FIRST PART PARAMETER   73800017
         LTR   GR7,GR7                 IS LENGTH OF SECOND PART ZERO    74100017
         BC    8,KOMPL                 YES- THE PARAMETER IS COMPLETE   74400017
         LA    GR6,SAVEPAPR            NO- ADDRESS OF FIRST PART        74700017
         AR    GR6,GR8                 GET SAVED LENGTH          A48723 75000022
         LR    GR10,GR7                                                 75300017
         BCTR  GR10,0                  DECREMENT FOR EXECUTE            75600017
         EX    GR10,MOVEPP             MOVE SECOND PART TO BUFFER       75900017
KOMPL    AR    GR7,GR8                 TOTAL LENGTH OF PARAMETER        76200017
         LA    GR1,SAVEPAPR            LOAD PARAMETER BUFFER ADDRESS    76500017
         NI    COL72LG,X'0C'           CLEAR LENGTH BITS, LEAVE'72' BIT 76800017
         OI    COL72LG,X'42'           SET LENGTH GREATER THAN ZERO     77100017
         TM    PARAMSW,BIT10      IS PARTIAL PARAMETER SW ON?   YA01700 77200002
         BC    1,AROUND           YES,SKIP DELIMITER SAVE       YA01700 77300002
         MVC   DELIMIN2(1),DELIMIN     SAVE DELIMITER SWITCH SETTINGS   77400017
         NI    DELIMIN,RESET0          CLEAR DELIMITER BITS             77700017
AROUND   NI    PARAMSW,X'EF'      RESET PART PARAMETER SWITCH   YA01700 78000002
         B     DELIM                   CHECK DELIMITERS                 78300017
KPCMD    LA    GR3,1(GR3)              ADJUST POINTER TO NEXT COLUMN    78600017
         CLI   0(GR3),BLANKCOL         IS COLUMN BLANK                  78900017
         BNE   KPCMA                   NO- CHECK FOR COMMA              79200017
         CR    GR5,GR3                 IS THIS THE LAST COLUMN          79500017
         BE    KNOPAR                  YES- NO PARAMETER FOLLOWS        79800017
         B     KPCMD                   CONTINUE SCAN                    80100017
KPCMA    CLI   0(GR3),COMMA            IS COMMA THE FIRST CHARACTER     80400017
         BE    KNOPAR                  YES- NO PARAMETER FOLLOWS        80700017
         BCTR  GR3,0                   BACK UP REGISTER 3 TO PARAMETER  81000017
         B     PRFOL                   GO TO SET UP FOR PARAMETER       81300017
KSETP    OI    PARAMSW,BIT10           SET PARAMETER FOLLOWS SWITCH     81600017
         B     CONTINU                 GO TO SET PARTIAL PARAM   A48817 82200022
CARDPRNT MVI   ASISMSW,X'0F'           FORCE PRINTING OF CARD           82500017
PRINTY   MVC   LOGOUTAR+7(80),SWITCHRD+1  MOVE CARD TO BUFFER           82800017
         L     GR15,PRIMEWRT           ADDRESS OF MESSAGE ROUTINE       83100017
         BR    GR15                     PRINT IT                        83140017
SCANERR  LA    GR11,SCANMSG             SCAN ERROR MSG                  83180017
         CLI   PRINTED,X'0F'              WAS   RECORD PRINTED          83220017
         BE    SKIPPRNT                 IF SO DO NOT PRINT IT           83260017
         BAL   GR14,CARDPRNT            PRINT RECORD                    83300017
SKIPPRNT L     GR15,PRIMEWRT            ADDRESS OF LOG ROUTINE          83340017
         MVI   PRINTED,X'00'            FLAG AS NOT PRINTED             83380017
         BALR  GR14,GR15                PRINT RECORD                    83420017
         MVI   FLUSHSW,X'0F'            SET FLUSH SWITCH                83460017
         MVI   RIDIT2SW,X'00'           RESET SECOND PARM SWITCH        83500017
         L     GR15,PROCESS             ADDRESS OF IEBUPDT2             83540017
         BR    GR15                     PREPARE TO FLUSH                83580017
         EJECT                                                          83700017
         SPACE 1                                                        84000017
MOVEP    MVC   SAVEPAPR(1),0(GR1)      STORE PARTIAL PARAMETER          84300017
MOVEPP   MVC   0(1,GR6),0(GR1)         RECREATES PARAMETER              84600017
PROCESS  DC    V(IEBUPDT2)                                              84900017
PRIMEWRT DC    V(IEBUPLOG)                                              85000017
RRSAVE   DS    18F                                                      85200017
DOTSLASH DC    C'./'                   CONTROL CARD INDICATION          85500017
PODSET   EQU   2                                                        86100017
PSDSET   EQU   X'40'                                                    86400017
         IEBUPCON                                                       86700017
         END   IEBBSCAN                                                 87000017
./  ADD  SSI=60090055,NAME=IEBUPDTE
UPD1     TITLE 'IEBUPDTE INITIALIZATION CSECT- IEBUPDTE'                00020000
*TITLE-IEBUPDTE-IEBUPDTE. INITIALIZATION CSECT                     2039 00040014
*                                                                     * 00060000
*STATUS- CHANGE LEVEL 001                                             * 00080000
*                                                                     * 00100000
*FUNCTION/OPERATION- THIS MODULE IS ABLE TO CREATE AND UPDATE         * 00120000
*   SYMBOLIC LIBRARIES WHICH ARE EITHER PHYSICAL SEQUENTIAL OR        * 00140000
*   PARTITIONED DATA SETS CONTAINED ON DIRECT ACCESS OR TAPE VOLUMES. * 00160000
*                                                                     * 00180000
*   THIS MODULE HANDLES FIXED OR FIXED-BLOCKED RECORDS. IT HAS THE    * 00200000
*   ABITLITY TO HANDLE RECORD OF LOGICAL RECORD LENGTHS UP TO EIGHTY  * 00220000
*   BYTES. IF BLOCKSIZE AND/OR LOGICAL RECORD LENGTH ARE NOT GIVEN    * 00240000
*   BY OPEN TIME, UNBLOCKED RECORDS OF 80 BYTES IS ASSUMED AND A      * 00260000
*   WARNING MESSAGE IS GIVEN ON THE LOG OUT DEVICE.                   * 00280000
*                                                                     * 00300000
*   THIS MODULE CAN-                                                  * 00320000
*                                                                     * 00340000
*   1. CREATE A NEW PARTITIONED OR PHYSICAL SEQUENTIAL DATA SET       * 00360000
*                                                                     * 00380000
*   2. SEQUENCE THE NEW DATA SET OR RESEQUENCE AN OLD ONE             * 00400000
*                                                                     * 00420000
*   3. REPRODUCE OR REPLACE A MEMBER OR A DATA SET                    * 00440000
*                                                                     * 00460000
*   4. PRODUCE A PARTITIONED DATA SET FROM A PHYSICAL SEQUENTIAL      * 00480000
*   MASTER OR THE CONVERSE.                                           * 00500000
*                                                                     * 00520000
*   4. ADD A MEMBER TO A PARTITIONED DATA SET.                        * 00540000
*                                                                     * 00560000
*   5. ASSIGN AN ALIAS NAME TO ANY MEMBER UPDATED                     * 00580000
*                                                                     * 00600000
*   6. CHANGE RECORDS IN A DATA SET                                   * 00620000
*                                                                     * 00640000
*   7. HANDLE RECORDS WITH NON-STANDARD SEQUENCE NUMBER FIELDS AND    * 00660000
*   LENGTHS OF SEQUENCE NUMBERS FROM 1 TO 8 CHARACTERS.               * 00680000
*                                                                     * 00700000
*   8. UPDATE ONLY SPECIFIED PORTION OF DATA SET RECORDS.             * 00720000
*                                                                     * 00740000
*   9. UPDATE INPLACE DATA SETS OR MEMBERS ON DIRECT ACCESS VOLUMES.  * 00760000
*                                                                     * 00780000
*ENTRY POINTS- ENTERED FROM THE OPERATING SYSTEM AT 'IEBUPDTE'.       * 00800000
*                                                                     * 00820000
*INPUT- SYSIN WHICH CONSISTS OF CONTROL CARDS AND LOGICAL DATA        * 00840000
*   RECORDS FOR INSERTION OR REPLACEMENT, THE INPUT DATA SET.         * 00860000
*                                                                     * 00880000
*       SYSUT1 WHICH DEFINES THE 'OLD MASTER' DATA SET WHICH MAY BE   * 00900000
*   PARTITIONED OR PHYSICAL SEQUENTIAL IN ORGANIZATION.               * 00920000
*                                                                     * 00940000
*OUTPUT-SYSPRINT WHICH CONTAINS DIAGNOSTIC MESSAGES, THE CONTENTS OF  * 00960000
*   SYSIN AND-IF THE 'LIST=ALL' CONDITION IS PRIMED- THE ENTIRE       * 00980000
*   'NEW MASTER' IS LISTED ON THE DEVICE DESIGNATED.                  * 01000000
*                                                                     * 01020000
*       SYSUT2 WHICH DEFINES THE 'NEW MASTER' DATA SET. IT WILL BE A  * 01040000
*   COMPOSITE OF THE SYSIN AND SYSUT1 DATA SETS. IT CAN BE EITHER     * 01060000
*   PARTITIONED OR PHYSICAL SEQUENTIAL IN ORGANIZATION.               * 01080000
*                                                                     * 01100000
*EXITS- NORMAL- A RETURN IS GIVEN TO THE SCHEDULAR MODULE OF THE      * 01120000
*   OPERATING SYSTEM. CONDITION CODE RETURNED ON A SUCCESSFUL RUN     * 01140000
*   WILL BE ZERO.                                                     * 01160000
*                                                                     * 01180000
*EXITS- ERROR- IF AN ERROR OCCURS, A CODE IS STORED, A MESSAGE        * 01200000
*   GIVEN TO THE USER EXPLAINING THE ERROR CONDITION AND A            * 01220000
*   RETURN TO THE OPERATING SYSTEM SCHEDULAR MODULE IS GIVEN.         * 01240000
*   RETURN CODE GIVEN ARE-                                            * 01260000
*   00 NORMAL TERMINATION OF A SUCCESSFUL RUN                         * 01280000
*   04 ERROR WITHIN A MEMBER- WILL TRY TO PROCESS NEXT MEMBER IF PODS * 01300000
*   12 UNRECOVERABLE ERROR- TERMINATION OF JOB.                       * 01320000
*   16 ERROR IN LABEL HANDLING IN USERS ROUTINE- TERMINATION OF JOB   * 01340000
*                                                                     * 01360000
*EXTERNAL ROUTINES- I/O HANDLED AT READ/WRITE LEVEL, GETMAIN, LINK,   * 01380000
*   BLDL, FIND, STOW USED.                                            * 01400000
*                                                                     * 01420000
*TABLES/WORK AREAS-                                                   * 01440000
*   -KEYTAB- LIST OF VALID KEY WORDS USED ON CONTROL CARDS            * 01460000
*   -COMDTABL- LIST OF VALID COMMAND WORDS USED ON CONTROL CARDS      * 01480000
*   -SWITCHRD- BUFFER CONTAINING CONTROL CARD AND SWITCHES USED       * 01500000
*   BY CARD SCAN ROUTINE.                                             * 01520000
*   -LOGOUTAR- BUFFER WHICH IS USED BY LOG OUT ROUTINE FOR MESSAGES.  * 01540000
*   -STARTAB- TABLE OF SWITCHES WHICH ARE RESET TO ZERO UPON ENTRY    * 01560000
*   TO MODULE. ALL SWITCHES NEEDING REINITIALIZATION SHOULD BE PUT    * 01580000
*   INTO THIS TABLE.                                                  * 01600000
*                                                                     * 01620000
*ATTRIBUTES- SERIAL REUSABLE, BLOCK LOADS                               01640000
*                                                                     * 01660000
*********************************************************************** 01670017
*FUNCTION/OPERATION OF THIS CSECT--IEBUPDTE--                      UL0H 01680017
*        1.    GETS CORE FOR THE COMMUNICATION REGION IEBUPCON     UL0H 01690017
*        2.    GIVES CONTROL TO THE CSECT IEBUPNIT TO INITIALIZE   UL0H 01700017
*              DCB'S AND THE COMMUNICATION REGION.                 UL0H 01710017
*        3.    THE DCB'S ARE MOVED INTO THIS CSECT                 UL0H 01720017
*        4.    CONTROL IS THEN PASSED TO IEBUPDTE2                 UL0H 01730017
*********************************************************************** 01740017
         EJECT                                                          01780000
*     SYMBOLIC REGISTER NOTATION   GR0 - GR15                           01800000
GR0      EQU   0                                                        01820000
GR1      EQU   1                                                        01840000
GR2      EQU   2                                                        01860000
GR3      EQU   3                                                        01880000
GR4      EQU   4                       REGISTER RESERVED FOR CSECT1     01900000
GR5      EQU   5                                                        01920000
GR6      EQU   6                                                        01940000
GR7      EQU   7                                                        01960000
GR8      EQU   8                                                        01980000
GR9      EQU   9                                                        02000000
GR10     EQU   10                                                       02020000
GR11     EQU   11                                                       02040000
GR12     EQU   12                                                       02060000
GR13     EQU   13                                                       02080000
GR14     EQU   14                                                       02100000
GR15     EQU   15                                                       02120000
         SPACE 1                                                        02140000
IEBUPDTE CSECT                                                          02160000
*1132059200,077400,078400,080800,081400,082000,094400,095000,      BS0H 02162017
*105400-105600,112200,115400                                       BS0H 02164017
*1132016800-017600,023430-023480,025200-082000,082600-104600       UL0H 02166017
*1132109000-111800,112200,112600-113000,113400-125000              UL0H 02168017
*                                                                A38775 02170021
         SPACE 2                                                        02172617
*********************************************************************** 02173217
****************************     W A R N I N G     ******************** 02173817
*        REGISTER 12 IS USED TO CONTAIN THE ADDRESS OF THE COM-    UL0H 02174417
*     MUNICATION REGION---DO NOT USE ALTER REGISTER IN ANY CSECT.  UL0H 02175017
*                                                                  UL0H 02175617
*        REGISTER 4 IS THE BASE REGISTER FOR THE EXIT ROUTINE      UL0H 02176217
*     CSECT,IEBUPXIT.DO NOT ALTER THIS REGISTER IN ANY CSECT.      UL0H 02176817
*                                                                  UL0H 02177417
*********************************************************************** 02178017
         SPACE 2                                                      * 02178617
         SPACE 1                                                        02300000
         EXTRN CTERROUT                                            UL0H 02303017
         EXTRN CTHDREXT                                            UL0H 02306017
         EXTRN CTTRLEXT                                            UL0H 02309017
         EXTRN CTDCBEX                                             UL0H 02312017
         EXTRN OMEOD                                               UL0H 02315017
         EXTRN  OMERROUT                                           UL0H 02318017
         EXTRN OMHDREXT                                            UL0H 02321017
         EXTRN OMTRLEXT                                            UL0H 02324017
         EXTRN OMDCBEX                                             UL0H 02327017
         EXTRN EODCT                                               UL0H 02330017
         EXTRN NMERROUT                                            UL0H 02333017
         EXTRN NMHDREXT                                            UL0H 02336017
         EXTRN NMTRLEXT                                            UL0H 02339017
         EXTRN NMDCBEX                                             UL0H 02342017
         SAVE  (14,12)                                             UL0H 02345017
         BALR  GR2,0                                               UL0H 02348017
         USING AHEAD,GR2                                           UL0H 02351017
         USING IEBUPCON,GR12           POINTER TO DSECT AREA            02360000
AHEAD    LR    GR10,GR1                LOAD PARAMETER INTO STABLE REG10 02380000
         LA    GR0,DSECTSIZ            GET SIZE OF DSECT                02400000
         GETMAIN  R,LV=(GR0)                                            02420000
         LR    GR12,GR1                POINTER TO DSECT AREA            02440000
         XC    IEBUPCON(256),IEBUPCON  CLEAR IEBUPCON BEFORE USE A38775 02450021
         XC    IEBUPCON+1*256(256),IEBUPCON+1*256                A38775 02452021
         XC    IEBUPCON+2*256(256),IEBUPCON+2*256                A38775 02454021
         XC    IEBUPCON+3*256(256),IEBUPCON+3*256                A38775 02456021
         XC    IEBUPCON+4*256(256),IEBUPCON+4*256                A38775 02458021
         XC    IEBUPCON+5*256(256),IEBUPCON+5*256                A38775 02458421
         XC    IEBUPCON+6*256(256),IEBUPCON+6*256                A38775 02458821
         XC    IEBUPCON+7*256(256),IEBUPCON+7*256                A38775 02459221
         XC    IEBUPCON+8*256(232),IEBUPCON+8*256                A38775 02459621
         ST    GR1,DSECTLOC            SAVE ADDRESS OF COMMON AREA      02460000
         ST    GR13,SAVE13             SAVE SETTING FOR SUPERVISOR      02480000
         LA    GR13,SAVEREG            ADDRESS OF THIS CSECT SAVE AREA  02500000
         LR    GR1,GR10                 RELOAD PARM LIST ADDRESS   UL0H 02600017
         L     GR15,INIT                ADDRESS OF INITIALIZE MODULUL0H 02700017
         BALR  GR14,GR15                GIVE CONTROL TO IEBUPNIT   UL0H 02800017
         L     GR10,DCBCT               ADDRESS OF SYSIN DCB       UL0H 02900017
         LA    GR11,DCBCTR             ADDRESS OF SYSIN DCB        UL0H 03000017
         ST    GR11,DCBCT              POINTER TO SYSIN DCB        UL0H 03100017
         BAL   GR14,COMPINIT            MOVE SYSIN DCB             UL0H 03200017
         L     GR10,DCBOM               ADDRESS OF OM DCB          UL0H 03300017
         LA    GR11,DCBOMR             ADDRESS OF SYSUT1 DCB       UL0H 03400017
         L     GR9,36(GR10)            ADDR OF DCB EXIT LIST       UL0H 03500017
         MVC   OMEXITS(52),0(GR9)       MOVE ALL  EXIT LISTS       UL0H 03600017
         ST    GR11,DCBOM              POINTER TO SYSUT1 DCB       UL0H 03700017
         BAL   GR14,COMPINIT            MOVE  O.M. DCB             UL0H 03800017
         L     GR10,DCBNM               ADDRESS OF N.M. DCB        UL0H 03900017
         LA    GR11,DCBNMR             ADDRESS OF SYSUT2 DCB       UL0H 04000017
         ST    GR11,DCBNM              POINTER TO SYSUT2 DCB       UL0H 04100017
         BAL   GR14,COMPINIT            MOVE N.M. DCB              UL0H 04300017
OPENINPT MVI   BLOKSW,X'0'        INITIALIZE BLOCKSIZE FLAG        UL0H 04500017
         OPEN DCBCTR              OPEN SYSIN DCB                   UL0H 04800017
         L     GR1,DCBCT          ADDRESS OF SYSIN DCB             UL0H 05100017
         LA    GR5,SYSINNM        ADDRESS OF DD NAME               UL0H 05400017
         TM    BOFLGS(GR1),BIT10  WAS THERE AN OPEN ERROR          UL0H 05700017
         BZ    BADOPEN            IF YES,PRINT ERROR AND QUIT      UL0H 06000017
         CLI   BLOKSW,X'0'        IS BLOCKSIZE A MULTIPLE OF 80    UL0H 06300017
         BNE   BADOPEN1           IF NOT PUT OUT MESSAGE AND QUIT  UL0H 06600017
         CLI   LBLRETCD,BIT10     USER ASKED TO TERMINATE          UL0H 06900017
         BE    USERTERM           IF SO, DO SO                     UL0H 07200017
         LA    GR1,INPUT          ADDRESS OF INPUT BUFFER          UL0H 07500017
         ST    GR1,READINAP       SAVE BUFFER ADDRESS              UL0H 07800017
ENTRNEXT L     GR15,PROCESS            ADDRESS OF MAIN PROCESSING CSECT 08220000
         BR    GR15                    ENTER NEXT STAGE- NO RETURN      08240000
COMPINIT MVC   SAVEREG+20(3),37(11)                                UL0H 08250017
         MVC   0(98,GR11),0(GR10)                                  UL0H 08260017
         MVC   37(3,GR11),SAVEREG+20                               UL0H 08270017
         BR    GR14                                                UL0H 08280017
         SPACE 2                                                        08320817
BADOPEN1 CLOSE  (DCBCTR,LEAVE)                                     UL0H 08321617
         FREEPOOL  DCBCTR                                          UL0H 08322417
BADOPEN  LA    GR7,SYSINNM        DD NAME FOR MESSAGE              UL0H 08324817
         LA    GR11,NTOPMSG       NOT OPEN MSG CONSTANT            UL0H 08325617
ALMOSTZ  LA    GR15,12            CONDITION CODE                   UL0H 08326417
         LA    GR14,CLOSENOW      PREPARE TO QUIT AFTER MESSAGE    UL0H 08327317
         CH    GR15,HICONCDE      HAS HIGHER CON CODE BEEN STORED  UL0H 08328217
         BNH   FINERRT            IF SO, USE THAT CODE             UL0H 08329117
         STH   GR15,HICONCDE      IF NOT, RETURN CON CODE OF 12    UL0H 08330017
FINERRT  L     GR15,PRIMEWRT      ADDRESS OF IEBUPLOG         2    UL0H 08330917
         BR    GR15               PRINT MESSAGE AND RETURN HERE    UL0H 08331817
CLOSENOW MVI   QUITALL,X'0E'      FLAG AS LAST MESSAGE AND TERMINATUL0H 08332717
         L     GR15,PRIMEWRT      ADDRESS OF IEBUPLOG              UL0H 08333617
         BR    GR15               IEBUPLOG WILL RETURN TO SYSTEM   UL0H 08334517
USERTERM MVI   CTEXITS+8,X'85'    FLAG DCB DCB EXIT AS LAST        UL0H 08335417
         LA    GR11,USRTRMSG      PRINT USER REQ TERMINATION MSG   UL0H 08336317
         MVI   HICONCDE,X'10'     CON CODE=USER TERMINATION        UL0H 08337217
         LA    GR14,CLOSENOW      RETURN TO TERMINATE PROCESSING   UL0H 08338117
         B     FINERRT                                             UL0H 08339017
*                                                                       08340000
*        DCB EXIT LISTS FOR SYSIN, SYSUT1 AND SYSUT2 DATA SETS.    UL0H 08360017
*                                                                       08380000
         DS    0F                                                       08400000
OMEXITS  DC    X'01'                                               UL0H 08480017
         DC    AL3(OMHDREXT)                                       UL0H 08560017
         DC    X'03'                                               UL0H 08640017
         DC    AL3(OMTRLEXT)                                       UL0H 08720017
         DC    A(0)                                                UL0H 08800017
         DC    X'85'                                               UL0H 08880017
         DC    AL3(OMDCBEX)                                        UL0H 08960017
         DC    X'07'                                               UL0H 09040017
         DC    AL3(0)                                              UL0H 09120017
NMEXITS  DC    X'02'                                               UL0H 09200017
         DC    AL3(NMHDREXT)                                       UL0H 09280017
         DC    X'04'                                               UL0H 09360017
         DC    AL3(NMTRLEXT)                                       UL0H 09440017
         DC    X'00'                                               UL0H 09520017
         DC    AL3(0)                                              UL0H 09600017
         DC    X'85'                                               UL0H 09680017
         DC    AL3(NMDCBEX)                                        UL0H 09760017
         DC    X'07'                                               UL0H 09840017
         DC    AL3(0)                                              UL0H 09920017
CTEXITS  DC    X'00'                                               UL0H 10000017
         DC    AL3(CTHDREXT)                                       UL0H 10080017
         DC    X'00'                                               UL0H 10160017
         DC    AL3(CTTRLEXT)                                       UL0H 10240017
         DC    X'85'                                               UL0H 10320017
         DC    AL3(CTDCBEX)                                        UL0H 10400017
         EJECT                                                          10480000
*   SYSIN DCB   CONTROL CARD INPUT     REFERRED TO AS CT                10500000
         SPACE 1                                                        10520000
DCBCTR   DCB   DSORG=PS,MACRF=(GL),DDNAME=SYSIN,RECFM=FB,LRECL=80, BS0H*10540017
               EODAD=EODCT,EXLST=CTEXITS,SYNAD=CTERROUT,BUFNO=1    BS0H 10560017
         EJECT                                                          10580000
*   SYSUT1 DCB  OLD MASTER             REFERRED TO AS OM                10600000
         SPACE 1                                                        10620000
DCBOMR   DCB   DSORG=PO,MACRF=R,DDNAME=SYSUT1,NCP=1,               2039C10640014
               EXLST=OMEXITS,EODAD=OMEOD,SYNAD=OMERROUT                 10660000
         EJECT                                                          10680000
*   SYSUT2 DCB  NEW MASTER             REFERRED TO AS NM                10700000
         SPACE 1                                                        10720000
DCBNMR   DCB   DSORG=PO,MACRF=W,DDNAME=SYSUT2,NCP=1,               2039C10740014
               EXLST=NMEXITS,SYNAD=NMERROUT                             10760000
         SPACE 1                                                        10780000
         EJECT                                                          10800000
         SPACE 1                                                        10820000
         SPACE 1                                                        10840000
         SPACE 1                                                        10860000
*   CONSTANTS FOR INITIALIZATION ROUTINE                                10880000
SAVEREG  DS    18F                     SAVE AREA USED BY READ/WRITE     11200000
DSECTLOC DC    F'0'                    COMMON AREA ADDRESS JUST IN CASE 11240000
CTERROR  DC    V(CTERROUT)                                         UL0H 11250017
PRIMEWRT DC    V(IEBUPLOG)                                         UL0H 11260017
         SPACE 1                                                        11280000
PROCESS  DC    V(IEBUPDT2)             ENTRY POINT PROCESSING CSECT     11300000
         SPACE 1                                                        11340000
INIT     DC    V(IEBUPNIT)                                         UL0H 11380017
BIT10    EQU   X'10'                                               UL0H 11420017
         SPACE 1                                                        11480000
         EJECT                                                          11760000
         IEBUPCON                                                       11780000
         DCBD                                                           11880017
BOFLGS  EQU   DCBOFLGS-IHADCB                                           11980017
         SPACE 2                                                        12080017
         END   IEBUPDTE                                                 12520000
./  ADD  SSI=81980004,NAME=IEBUPDT2
* /* START OF SPECIFICATIONS ***                                      * 00010003
*01* PROCESSOR = ASSEM;                                               * 00012003
**** END OF SPECIFICATIONS ***/                                       * 00014003
UPD2     TITLE 'IEBUPDTE PROCESSING CSECT- IEBUPDT2'                    00020000
*TITLE: IEBUPDT2-IEBUPDTE MAIN PROCESSING CSECT                    1550 00040014
*                                                                     * 00060000
*STATUS- CHANGE LEVEL 001                                             * 00080000
*                                                                     * 00100000
*FUNCTION/OPERATION- THIS MODULE IS ABLE TO CREATE AND UPDATE         * 00120000
*   SYMBOLIC LIBRARIES WHICH ARE EITHER PHYSICAL SEQUENTIAL OR        * 00140000
*   PARTITIONED DATA SETS CONTAINED ON DIRECT ACCESS OR TAPE VOLUMES. * 00160000
*                                                                     * 00180000
*   THIS MODULE HANDLES FIXED OR FIXED-BLOCKED RECORDS. IT HAS THE    * 00200000
*   ABITLITY TO HANDLE RECORD OF LOGICAL RECORD LENGTHS UP TO EIGHTY  * 00220000
*   BYTES. IF BLOCKSIZE AND/OR LOGICAL RECORD LENGTH ARE NOT GIVEN    * 00240000
*   BY OPEN TIME, UNBLOCKED RECORDS OF 80 BYTES IS ASSUMED AND A      * 00260000
*   WARNING MESSAGE IS GIVEN ON THE LOG OUT DEVICE.                   * 00280000
*                                                                     * 00300000
*   THIS MODULE CAN-                                                  * 00320000
*                                                                     * 00340000
*   1. CREATE A NEW PARTITIONED OR PHYSICAL SEQUENTIAL DATA SET       * 00360000
*                                                                     * 00380000
*   2. SEQUENCE THE NEW DATA SET OR RESEQUENCE AN OLD ONE             * 00400000
*                                                                     * 00420000
*   3. REPRODUCE OR REPLACE A MEMBER OR A DATA SET                    * 00440000
*                                                                     * 00460000
*   4. PRODUCE A PARTITIONED DATA SET FROM A PHYSICAL SEQUENTIAL      * 00480000
*   MASTER OR THE CONVERSE.                                           * 00500000
*                                                                     * 00520000
*   4. ADD A MEMBER TO A PARTITIONED DATA SET.                        * 00540000
*                                                                     * 00560000
*   5. ASSIGN AN ALIAS NAME TO ANY MEMBER UPDATED                     * 00580000
*                                                                     * 00600000
*   6. CHANGE RECORDS IN A DATA SET                                   * 00620000
*                                                                     * 00640000
*   7. HANDLE RECORDS WITH NON-STANDARD SEQUENCE NUMBER FIELDS AND    * 00660000
*   LENGTHS OF SEQUENCE NUMBERS FROM 1 TO 8 CHARACTERS.               * 00680000
*                                                                     * 00700000
*   8. UPDATE ONLY SPECIFIED PORTION OF DATA SET RECORDS.             * 00720000
*                                                                     * 00740000
*   9. UPDATE INPLACE DATA SETS OR MEMBERS ON DIRECT ACCESS VOLUMES.  * 00760000
*                                                                     * 00780000
*ENTRY POINTS- ENTERED FROM THE OPERATING SYSTEM AT 'IEBUPDTE'.       * 00800000
*                                                                     * 00820000
*INPUT- SYSIN WHICH CONSISTS OF CONTROL CARDS AND LOGICAL DATA        * 00840000
*   RECORDS FOR INSERTION OR REPLACEMENT, THE INPUT DATA SET.         * 00860000
*                                                                     * 00880000
*       SYSUT1 WHICH DEFINES THE 'OLD MASTER' DATA SET WHICH MAY BE   * 00900000
*   PARTITIONED OR PHYSICAL SEQUENTIAL IN ORGANIZATION.               * 00920000
*                                                                     * 00940000
*OUTPUT-SYSPRINT WHICH CONTAINS DIAGNOSTIC MESSAGES, THE CONTENTS OF  * 00960000
*   SYSIN AND-IF THE 'LIST=ALL' CONDITION IS PRIMED- THE ENTIRE       * 00980000
*   'NEW MASTER' IS LISTED ON THE DEVICE DESIGNATED.                  * 01000000
*                                                                     * 01020000
*       SYSUT2 WHICH DEFINES THE 'NEW MASTER' DATA SET. IT WILL BE A  * 01040000
*   COMPOSITE OF THE SYSIN AND SYSUT1 DATA SETS. IT CAN BE EITHER     * 01060000
*   PARTITIONED OR PHYSICAL SEQUENTIAL IN ORGANIZATION.               * 01080000
*                                                                     * 01100000
*EXITS- NORMAL- A RETURN IS GIVEN TO THE SCHEDULAR MODULE OF THE      * 01120000
*   OPERATING SYSTEM. CONDITION CODE RETURNED ON A SUCCESSFUL RUN     * 01140000
*   WILL BE ZERO.                                                     * 01160000
*                                                                     * 01180000
*EXITS- ERROR- IF AN ERROR OCCURS, A CODE IS STORED, A MESSAGE        * 01200000
*   GIVEN TO THE USER EXPLAINING THE ERROR CONDITION AND A            * 01220000
*   RETURN TO THE OPERATING SYSTEM SCHEDULAR MODULE IS GIVEN.         * 01240000
*   RETURN CODE GIVEN ARE-                                            * 01260000
*   00 NORMAL TERMINATION OF A SUCCESSFUL RUN                         * 01280000
*   04 ERROR WITHIN A MEMBER- WILL TRY TO PROCESS NEXT MEMBER IF PODS * 01300000
*   12 UNRECOVERABLE ERROR- TERMINATION OF JOB.                       * 01320000
*   16 ERROR IN LABEL HANDLING IN USERS ROUTINE- TERMINATION OF JOB   * 01340000
*                                                                     * 01360000
*EXTERNAL ROUTINES- I/O HANDLED AT READ/WRITE LEVEL, GETMAIN, LINK,   * 01380000
*   BLDL, FIND, STOW USED.                                            * 01400000
*                                                                     * 01420000
*TABLES/WORK AREAS-                                                   * 01440000
*   -KEYTAB- LIST OF VALID KEY WORDS USED ON CONTROL CARDS            * 01460000
*   -COMDTABL- LIST OF VALID COMMAND WORDS USED ON CONTROL CARDS      * 01480000
*   -SWITCHRD- BUFFER CONTAINING CONTROL CARD AND SWITCHES USED       * 01500000
*   BY CARD SCAN ROUTINE.                                             * 01520000
*   -LOGOUTAR- BUFFER WHICH IS USED BY LOG OUT ROUTINE FOR MESSAGES.  * 01540000
*   -STARTAB- TABLE OF SWITCHES WHICH ARE RESET TO ZERO UPON ENTRY    * 01560000
*   TO MODULE. ALL SWITCHES NEEDING REINITIALIZATION SHOULD BE PUT    * 01580000
*   INTO THIS TABLE.                                                  * 01600000
*                                                                     * 01620000
*ATTRIBUTES- SERIAL REUSABLE, BLOCK LOADS                               01640000
*                                                                     * 01660000
*  THIS CSECT-   1.  OPENS SYSUT1 AND SYSUT2 (OLD AND NEW MASTER) DCB * 01680000
*                2.  READS CONTROL CARDS FROM SYSIN AND BRANCHES TO   * 01700000
*     CONTROL CARD SCAN AND ANALYSIS CSECT (IEBASCAN) TO PROCESS THEM * 01720000
*                3.  READS OLD MASTER RECORDS AND WRITES THE NEW      * 01740000
*     MASTER AFTER ANALYSING THE SITUATION.                           * 01760000
*                4.  THE 'LASTLEG' ROUTINE IS ENTERED WHEN LAST       * 01780000
*     MEMBER OR DATA SET HAS BEEN PROCESSED.                          * 01800000
*                5.  THE 'FLUSH' ROUTINE IS ENTERED TO SCAN TO NEXT   * 01820000
*     MEMBER IF A SYNTAX ERROR IS ENCOUNTERED ON A CONTROL STATEMENT. * 01840000
*                                                                     * 01860000
         EJECT                                                          01880000
*     SYMBOLIC REGISTER NOTATION   GR0 - GR15                           01900000
GR0      EQU   0                                                        01920000
GR1      EQU   1                                                        01940000
GR2      EQU   2                                                        01960000
GR3      EQU   3                                                        01980000
GR4      EQU   4                       REGISTER RESERVED FOR CSECT1     02000000
GR5      EQU   5                                                        02020000
GR6      EQU   6                                                        02040000
GR7      EQU   7                                                        02060000
GR8      EQU   8                                                        02080000
GR9      EQU   9                                                        02100000
GR10     EQU   10                                                       02120000
GR11     EQU   11                                                       02140000
GR12     EQU   12                                                       02160000
GR13     EQU   13                                                       02180000
GR14     EQU   14                                                       02200000
GR15     EQU   15                                                       02220000
D0       EQU   0                       DISPLACEMENT OF 0        YM07522 02221002
D1       EQU   1                       DISPLACEMENT OF 1        YM07522 02222002
L1       EQU   1                       LENGTH OF 1              YM07522 02223002
L4       EQU   4                       LENGTH OF 4              YM07522 02224002
L7       EQU   7                       LENGTH OF 7              YM07522 02225002
L8       EQU   8                       LENGTH OF 8              YM07522 02226002
B4       EQU   4                       SHIFT 4 BITS             YM07522 02227002
DIGIT    EQU   C'0'                    DIGIT ZONE               YM07522 02228002
         SPACE 1                                                        02240000
IEBUPDT2 CSECT                                                          02260000
         ENTRY DEACTV    ENTRY PT FROM SYNAD ROUTINE             A27716 02261019
*                        IN IEBUPXIT TO CLOSE SYSUT1,            A27716 02262019
*                                      SYSUT2, AND SYSIN         A27716 02263019
* 115800-116000,118200                                           A22518 02264018
* 117400                                                         A22653 02268018
*                                                                A22163 02272018
* 101600,101800,117600                                           A24812 02274018
* 045760                                                         A24428 02277018
*                                                                A25310 02278018
* 050600,169400,208810,208966                                    A25427 02279218
*                                                                A23927 02279618
* 101434,101850                                                   M3410 02279818
* 068600-069200,72800,218400                                     A27716 02281819
* 078800,083800,209696                                           A27600 02283819
* 094800                                                         A25432 02285819
* 125200                                                         A28728 02287819
* 109650-110050,172400,222720-222750,223260                      A29047 02289819
* 117402,117700                                                  A30939 02291819
* 206496                                                         A31455 02293819
* 042600-042800,061200,061400,168800-170100,177450,177460        A30480 02294020
* 050500,078640-079000,083700-084000,125400,125600,189000        A34087 02294220
* 191800,204400-204600,209196-210400,220315                      A34087 02294420
* 135000-135400                                                  A32024 02294620
* 175300                                                         A32631 02294820
* 188600                                                         A32632 02295020
* 179000                                                         A33281 02295220
* 044164-044244,044814                                           A34086 02295520
* 071400-071800,167800-168000,173830,174000                      A30625 02295620
* 221250                                                         A33305 02295720
*186400,187000                                                   A36095 02295821
*                                                                A36128 02297821
*D127900. C128000                                                A38750 02298200
*D161400                                                         A41743 02298600
*C162400                                                         A41743 02299000
*A169400,169520.C168800                                          A41756 02299121
*C155950 .A155970-155994                                         A44323 02299221
*A172520,175100,219674                                           A45212 02299621
*A101720,101730                                                  A48737 02301200
*A165400,165600,178900,179300,179320                             A45153 02301600
*A03790,037920,101424-101496,101824-101925,101983-1019870,103800YA01187 02301702
*A125700-125780,129500-129720,129940,141100-141180,223481-223785YA01187 02301802
*A 087300-087340                                                YA01188 02301902
*C 087400                                                       YA01188 02305502
*A 127900-127940                                                        02305902
*C 128000                                                               02306102
*A034300,034320,177540,177560,177900-177940                     YA01700 02306702
*C177600,177800                                                 YA01700 02306902
*D034800,035000                                                 YA01700 02307102
*A 127900-127940                                                        02307502
*C 128000                                                               02307902
*A 184300,186900                                                YA01186 02308302
*D 184800                                                       YA01186 02308702
*A 148700                                                       YA01677 02308902
*A129540,129541                                                 YA01723 02309002
*C129760                                                        YA01723 02309102
*A22210-22280,30620,91620-91780,91820-91880                     YM07522 02310102
*A162020,173804,219774                                          YM07522 02310302
*D92000                                                         YM07522 02310502
*C91800                                                         YM07522 02310702
*A101569,101573,101821,101822,101877-101889,101991,102092      @YA02533 02310802
*A102096,120500-120540,129583,129603                           @YA02533 02310902
*C093600,093800,101428,101900,101906,102104,120600,129716      @YA02533 02311002
*A137520-137584                                                @YA02554 02314102
*C184200                                                       @YA02568 02316102
*C065200                                                       @YA02584 02338302
*D064800,065000                                                @YA02584 02340302
*A 221240                                                      @ZA00637 02340502
*A025240-025520,171640-171720,189840-189969,197035-197080      @ZA01682 02340802
*C190000,197090,203000                                         @ZA01682 02341302
*D025400,025600,197060,197150                                  @ZA01682 02341802
*A102084,102088,129508                                         @ZA01683 02341902
*C102090                                                       @ZA01683 02342002
*D 129523,129527                                               @ZA01683 02342102
*C 145060                                                       YA01707 02342302
*A144900                                                       @ZA01657 02342702
*A222710                                                       @ZA01684 02343002
*D222720,222750                                                @ZA01684 02343402
*A031300-031360                                                @ZA01689 02343502
*C027400                                                       @ZA01689 02343702
*A026900,026920,029420,029440,189900,189904                    @ZA01690 02343902
*C024000,024200,025000,025280,115000,115200,174010             @ZA01690 02344102
*C174800,187600,187800,197090                                  @ZA01690 02344302
*A 176400-176780                                               @ZA01692 02344402
*C 174800                                                      @ZA01692 02344502
*A 118140-118180                                               @ZA03382 02344603
*C 118120                                                      @ZA03382 02344703
*A 094860-094880                                               @ZA04438 02344803
*A 171500                                                      @ZA04434 02344903
*A 209196-209556                                               @ZA06529 02346999
*C 165600                                                      @ZA06529 02347099
*A 045500-045540                                               @ZA06546 02352399
*C 045600                                                      @ZA06546 02354399
*D 090520                                                      @ZA07320 02356399
*A 124500-124540                                               @ZA07361 02356799
*C 123800                                                      @ZA07361 02357199
*A 094800,094820,094860-094892                                 @ZA07377 02357599
*C 159000                                                      @ZA07377 02363199
*D 094860-094880                                               @ZA07377 02368699
*A179330,179340                         @XA19829-@YA19268-(ORG)@ZA24936 02369100
*A090430,094900-094920,094940-094950,   (ORG)@XA19639-@YA19583-@ZA27274 02369800
*A129529,136810-136910,153210-153350,   (ORG)@XA19639-@YA19583-@ZA27274 02370599
*A155400-155450,223521                  (ORG)@XA19639-@YA19583-@ZA27274 02371200
*C094930,153200,155500                  (ORG)@XA19639-@YA19583-@ZA27274 02371900
*A179368-179392                         (ORG)@XA20208-@YA19886-@ZA28408 02372699
*A058270-058620,220806-220818           @XA20587-@YA19906-(ORG)@ZA28493 02373299
*C058200,220800                         @XA20587-@YA19906-(ORG)@ZA28493 02373499
*D058400,058600                         @XA20587-@YA19906-(ORG)@ZA28493 02373699
*A129670                                @XA20392-@YA20223-(ORG)@ZA29830 02374099
*A129403-129480                         @XA20867-@YA19583-(ORG)@ZA29907 02374199
*C094900,153200,155400                  @XA20867-@YA19583-(ORG)@ZA29907 02374299
*D090430,094910-094950,129529,129730    @XA20867-@YA19583-(ORG)@ZA29907 02374399
*D136810-136910,153220-153230           @XA20867-@YA19583-(ORG)@ZA29907 02374499
*D155450-155500,223521                  @XA20867-@YA19583-(ORG)@ZA29907 02374599
*A155430-155490                         @XA20479-@YA20225-(ORG)@ZA29832 02374699
*A153200-153320                         @XA20479-@YA20225-(ORG)@ZA29832 02374799
*C153400                                @XA20479-@YA20225-(ORG)@ZA29832 02374899
*A129413-129415                         @XA22013-@YA20972-(ORG)@ZA31995 02375199
*A094854,155410-155420                  @XA22015-@YA20973-(ORG)@ZA32389 02375799
*D094840                                @XA22015-@YA20973-(ORG)@ZA32389 02376399
*A220793-220796                                  @XA22247-(ORG)@ZA33607 02377599
         SAVE  (14,12),T,IEBUPDT2-OZ33607                      @ZA27274 02377799
         BALR  GR2,0                                                    02378399
         USING  MEMBER,GR2,GR5                                     UL0H 02380802
         USING IEBUPCON,12                                         UL0H 02386402
MEMBER   L     GR5,SCNDBASE                                        UL0H 02392002
         AR    GR5,GR2                                             UL0H 02397602
         ST    GR13,SAVEPT13                                       UL0H 02403202
         LA    GR13,REGSAVS            POINTER TO SAVE AREA             02408800
         TM   COMDCD2,X'0F'           COMMAND PENDING          @ZA01690 02414402
         BZ    NEXT1                   NO- TEST SOME MORE      @ZA01690 02420002
         TM    REPROSW,X'0E'           REPRO FUNCTION                   02440000
         BC    1,ANYEOFOM              YES- PROCESS TILL OM IS DONE     02460000
         TM    CHNGESW,X'0E'           CHANGE FUNCTION                  02480000
         BZ    IFALIAS2           ADD OR REPL.TEST IF ALIASES  @ZA01690 02500002
         CLI   OMEND,X'0F'             IS OLD MASTER FINISHED           02520000
         BNE   PROCEED            NO,CONTINUE PROCESSING       @ZA01682 02524002
IFALIAS2 CLI   ALIASW2,X'0F'      IS THERE SEVERAL ALIAS STMT? @ZA01690 02528002
         BNE   STOWNAME           NO,FINISH THIS MEMBER        @ZA01682 02532002
         MVI   DONOTRDC,RESET0    ALLOW READING OF SYSIN       @ZA01682 02536002
         CLI   EODCTSW,X'0F'      IS SYSIN FINISHED?           @ZA01682 02540002
         BNE   NEXT1              NO,TEST SOME MORE            @ZA01682 02544002
         MVI   FINICCS,X'0F'      SET SYSIN FINISHED           @ZA01682 02548002
         B     STOW               BRANCH TO FINISH THIS MEMBER @ZA01682 02552002
*********************************************************************** 02565017
SCNDBASE DC    F'4096'            CONSTANT FOR SECOND BASE REGISTER000H 02570017
*********************************************************************** 02575017
ANYEOFOM CLI   OPENSW,X'0F'            DATA SETS OPEN YET               02580000
         BE    STARTUP                 NO- OPEN DCB AND START PROCESS   02600000
         CLI   REPROSW,X'0F'           FIRST ENTRY TO REPRO             02620000
         BE    RESTREPO                YES- LOCATE AND PROCESS MEMBER   02640000
         CLI   OMEND,X'0F'             PREVIOUS MEMBER FINISHED         02660000
         BNE   READOM                  NO- FINISH UP BEFORE START REPRO 02680000
         CLI   ALIASW2,X'0F'      MULTIPLE ALIAS STMT?         @ZA01690 02690002
         BE    IFALIAS2           YES,GO TO SEE IF SYSIN THRU  @ZA01690 02692002
         B     OMEODX                  YES- ANOTHER COMMAND PENDING     02700000
NEXT1    CLI   CCSCANSW,BIT01          CARD SCAN REQUESTING READ        02720000
         BE    TESTEOD            YES,GO TO SEE IF SYSIN THRU  @ZA01689 02740002
         CLI   FLUSHSW,X'0F'           ERROR ON CONTROL STATEMENT       02760000
         BE    CHKIFEND                CHECK IF SYSIN THRU              02780000
         CLI   FIRSENTR,X'0F'          START OF NEW MEMBER              02800000
         BE    PROSSOM                 YES- POSITION TO IT              02820000
         CLI   PRINTWRT,X'0F'          RECORD TO BE LISTED AND WRITTEN  02840000
         BE    READCC                  GET NEXT CARD                    02860000
         CLI   EODCTSW,X'0F'           /* READ FIRST TIME               02880000
         BE    EODCTX                  YES- SET FINICCS SWITCH          02900000
         CLI   OMEND,X'0F'             END OF OLD MASTER                02920000
         BE    OMEODX                  YES                              02940000
         CLI   ALIASW2,X'0F'      MULTIPLE ALIAS STMT?         @ZA01690 02942002
         BE    NOTEMPTY           YES,GO TO SEE IF SYSIN THRU  @ZA01690 02944002
         CLI   LABEL2SW,X'0F'     ARE LABELS TO BE READ IN SYSIN   UL0H 02946017
         BE    READCC                  IF SO, READ THEM NOW        UL0H 02952017
         CLI   LABEL2SW,X'FF'          LABEL WITH DATA=NO        A45205 02954022
         BNE   OPEND                   NO,TEST MORE              A45205 02956022
         MVI   LABEL2SW,X'00'          RESET SWITCH              A45205 02958022
         B     READCT1                 READ SYSIN  IF FIRST CARD A45205 02958422
OPEND    CLI   OPENSW,X'0F'       OPEN DCB YET                   A45205 02960000
         BE    OPENTHEM      OPEN DCBS DELETE, NUMBER PENDING    13943  02980015
         CLI   FINICCS,X'0F'      ENDUP STATEMENT READ           13943  03000015
         BE    ENDUPCC            YES, FINISH OLD MASTER         13943  03020015
         MVI   OPENSW,X'0F'            OM AND NM NOT OPENED SWITCH      03040000
STARTUP  MVC   IDENTXX(4),INITSEQ      REINITIALIZE SEQUENCE CONSTANTS  03060000
         XC    IDENTNN(L4),IDENTNN                              YM07522 03062002
         TM    REPROSW,X'0E'           REPRO FIRST COMMAND              03080000
         BC    1,OPENTHEM              YES- OPEN DATA SETS              03100000
         B     READCT1                 READ SYSIN FIRST TIME            03120000
TESTEOD  CLI   EODCTSW,X'0F'       SYSIN THRU?                 @ZA01689 03130002
         BNE   READCC              NO,GO TO READ CONT CARDS    @ZA01689 03132002
         LA    GR11,SCANMSG        YES,CNTRL STMT ERROR MSG    @ZA01689 03134002
         B     GIVENGO             EOD INSTEAD OF CONT CARDS   @ZA01689 03136002
RESETRD  MVI   FIRSENTR,RESET0         RESET NEW NUMBER SWITCH SETTING  03140000
READCC   CLI   DONOTRDC,X'0F'          SHOULD ANOTHER CARD BE READ      03160000
         MVI   PRINTWRT,RESET0         CLEAR SWITCH THAT GOT US HERE    03180000
         BE    READOM                  NO- READ OLD MASTER              03200000
*                                                                     * 03220000
*                        SYSIN  SEQUENTIAL  DATA  SET              BS0H 03240017
*                                                                     * 03260000
READCT1  L     GR3,READINAP            LOAD START OF BUFFER             03280000
         L     GR11,DCBCT              ADDRESS OF DCB                   03300000
         GET   (GR11)                   GET CONTROL CARDS          BS0H 03320017
         MVC   0(80,GR3),0(GR1)         MOVE TO INPUT AREA         BS0H 03340017
         MVI   IGNORE1,RESET0          IF DID NOT INTERRUPT, NO /* EOF  03360000
BLOCKCC  L     GR3,READINAP            POINTER TO SYSIN RECORD          03380000
         CLI   INSRTRD,X'0F'           READING INSERT RECORDS           03400000
         BCR   8,GR9                   YES- RETURN TO PROCESS INSERT    03420000
         CLI   CCSCANSW,BIT01     DID CARD SCAN ISSUE READ?     YA01700 03426002
         BE    MOVECCD            YES,MOVE CARD TO ANALYSIS BUF YA01700 03432002
         CLI   FLUSHSW,X'0F'           FLUSHING CARDS TO NEXT COMMAND   03440000
         BE    CLEARGO                 YES- CLEAR SWITCHES CHECK CARD   03460000
CLEARGO  XC    SWITCHRD(108),SWITCHRD  CLEAR SWITCHES                   03520000
MOVECCD  MVC   SWITCHRD+1(80),0(GR3)   MOVE CARD TO ANALYSIS BUFFER     03540000
         CLI   LABEL2SW,X'0F'           PROCESSING USER LABLES     UL0H 03546017
         BE    LBLPROCS                 IF SO,ANALYZE THIS RECORD  UL0H 03552017
         CLC   0(2,GR3),DOTSLASH       CONTROL STATEMENT IN BUFFER      03560000
         BE    CHKPS                   YES - ANALYSE THEN PRINT    4929 03580017
         CLI   FLUSHSW,X'0F'           FLUSH ROUTINE ISSUED READ        03620000
         BE    READCC                  YES- CONTINUE TO FLUSH      4929 03640017
         CLI   CCSCANSW,BIT01          READ ISSUED BY 'KGTCD' OF SCAN   03660000
         BE    RET2SCAN                YES- RETURN TO SCAN              03680000
         CLI   FIRSENTR,BIT10          VERY FIRST CARD                  03700000
         BE    BADCARD                 YES- ERROR DATA BEFORE CONTROL   03720000
         LA    GR14,NEXTONE            RETURN FROM PRINT- LAST SYSIN    03740000
         CLI   FLLISTSW,X'01'          IS LIST OF ./ AND NEW MASTER     03760000
         BCR   8,GR14                  YES- CONTINUE                    03780000
         TM    CHNGESW,X'0E'           CHANGE OPERATION         YA01187 03790002
         BO    NEXTONE                 WAIT WITH PRINTING       YA01187 03792002
PRINTCRD MVI   ASISMSW,X'0F'           SET WRITE RECORD SWITCH          03800000
         MVC   LOGOUTAR+7(80),0(GR3)   MOVE RECORD TO PRINT BUFFER      03820000
         L     GR15,PRIMEWRT           ADDRESS OF MESSAGE ROUTINE       03840000
         BR    GR15                    PRINT CARD 14 LOADED WITH RETURN 03860000
NEXTONE  CLI   CHNGESW,X'0F'           HAVE A CHANGE COMMAND            03880000
         BE    RESETCHG                YES- RESET THIS ON FIRST LRECORD 03900000
         TM    REPROSW,X'0E'           HAVE A REPRO COMMAND             03920000
         BC    1,INVALOP               INVALID DATA RECORD WITH REPRO   03940000
         CLI   REPLSW,X'0F'            HAVE A REPL COMMAND              03960000
         BE    RESETRPL                YES- RESET THIS ON FIRST LRECORD 03980000
         TM    ADDSW,X'0E'             HAVE AN ADD COMMAND              04000000
         BC    8,PROCEED               NO- RESET THIS ON FIRST LRECORD  04020000
         MVI   ADDSW,X'0E'             LOGICAL RECORD BEFORE NEXT COMD  04040000
PROCEED  CLI   FLUSHSW,X'0E'           COMMAND AFTER FLUSH              04060000
         BE    PROSSOM                 YES- ON TO NEXT MEMBER           04080000
         CLI   OPENSW,X'00'            HAVE OM AND NM BEEN OPENED       04100000
         BNE   OPENTHEM                NO- OPEN THEM- HAVE A COMD CARD  04120000
         B     READOM                  CONTINUE PROCESSING              04140000
RESETCHG MVI   CHNGESW,X'0E'           LOGICAL RECORD BEFORE NEXT COMD  04160000
         B     PROCEED                 CONTINUE PROCESSING              04180000
RESETRPL MVI   REPLSW,X'0E'            LOGICAL RECORD BEFORE NEXT COMD  04200000
         B     PROCEED                 CONTINUE PROCESSING              04220000
OPENTHEM MVI   OPENSW,X'00'            CLEAR OPEN SWITCH                04240000
         TM    CTONLYSW,X'11'     ALL INPUT FROM SYSIN ?         A30480 04250020
         BZ    OPENOM             NO.. OPEN OLD MASTER           A30480 04260020
         CLI   LABEL2SW,X'0F'           PROCESSING USER LABELS     UL0H 04286017
         BE    OPENNEW1                 IF SO,ANALYZE THIS RECORD  UL0H 04292017
         CLI   ADDSW,X'00'             IS ADD SWITCH ON                 04300000
         BE    INVALOP                 CAN ONLY ADD NO OM- GIVE MESSAGE 04320000
         B     OPENNEW1                OPEN ONLY NEW MASTER             04340000
*                                                                       04360000
*                   OPEN OLD MASTER DATA SET (SYSUT1) DCBOM             04380000
*                                                                       04400000
LBLPROCS STC   GR7,LABELCNT             STORE NO. OF LABELS        UL0H 04401017
         CLC   0(2,GR3),DOTSLASH        IS RECORD A CONTROL CARD   UL0H 04402017
         BE    CHEKCOMD                 IF SO,PREPARE TO ANALYZE ITUL0H 04403017
         MVC   0(80,GR6),0(GR3)         MOVE LABEL INTO BUFFER     UL0H 04403917
         BAL   GR14,PRINTCRD            PRINT LABEL                UL0H 04404817
         LA    GR6,80(GR6)              UP POINTER BY 80           UL0H 04405717
         LA    GR7,1(GR7)               UP COUNT BY ONE            UL0H 04406617
         CH    GR7,EIGHT                HAVE 8 LABELS BEEN READ IN UL0H 04407917
         BNH   READCT1                  IF NOT,READ ANOTHER RECORD UL0H 04408817
         MVI   LABEL2SW,X'00'           RESET LABEL PROCESS FLAG   UL0H 04409517
         B     INVALLBL                 ELSE ITS AN ERROR          UL0H 04410217
CHEKCOMD CLI   LABELCNT,X'00'          ANY LABELS SAVED YET        UL0H 04410617
         BE    INVALLBL                IF NOT, ITS AN ERROR        UL0H 04411017
         CLI   LABELSW,X'10'           PROCESSING HEADER LABELS    UL0H 04411417
         BE    HEADSCAN                INITIALIZE BEFORE SCANNING  UL0H 04411817
         CLI   LABELSW,X'20'           REQUEST FOR USER TRAILER LBLUL0H 04412517
         MVI   LABEL2SW,X'F0'          IF SO,ASCAN MUST CHECK NEXT UL0H 04412817
         MVI   NMSYSNLB,X'0F'          FLAG AS TRAILERS IN INPUT   UL0H 04413117
*                      FUNCTION FOR 'ENDUP', ALL ELSE INVALID      UL0H 04413417
         BE    RET2SCAN                IF SO, SCAN COMMAND CARD    UL0H 04413817
         B     BADSEQN                 IF NOT, ITS A SEQUENCE ERRORUL0H 04414217
HEADSCAN MVI   LABEL2SW,X'00'          DO NOT BYPASS NORMAL PROC   UL0H 04414617
         MVC   TESTLABL(1),LABELSW     SAVE VALUE OF LABELSW       UL0H 04415017
         MVC   TMPLBLCT(1),LABELCNT    SAVE CURRENT NO. OF LABELS  UL0H 04415417
         MVI   OMSYSNLB,X'0F'          FLAG AS  HEADERS IN INPUT   UL0H 04415617
         B     RET2SCAN                SCAN CONTROL CARD THEN PROC UL0H 04415817
OMLBLTST CLI   OMHDRSW,X'0F'            HEADER RTN ON NON-PODS?    UL0H 04425417
         BE    LABLMESG                 IF SO,ERROR                UL0H 04426417
         CLI   OMTRLRSW,X'0F'           TRAILER RTN  ON NON-PODS?  UL0H 04427417
         BE    LABLMESG                 IF SO,ERROR                UL0H 04428417
         CLI   INPLCSW,X'0F'            IS IT UPDATE=INPLACE       UL0H 04437417
         BNE   OPENITUP                 IF NOT,OPEN DATA SET       UL0H 04441417
         CLI   LABELSW,X'00'           ANY LABELS IN INPUT STREAM  UL0H 04442417
         BNE   LABLMESG                IF SO, ITS AND ERROR        UL0H 04443417
         CLI   TOTALSW,X'FF'            TOTALING ON NON-PODS?      UL0H 04446417
         BNE   OPENUPDT                 IF NOT,OPEN FOR UPDAT      UL0H 04449417
         B     NOTOTPDS                 IF SO, ERROR               UL0H 04452417
NOTRLBLI LA    GR11,INPLBLMS            TRAILERS NOT SUPPORTED     UL0H 04454417
         B     SENDMSGQ                 PRINT MESSAGE              UL0H 04456417
LABLMESG LA    GR7,8                    MESG BRANCH CONSTANT       UL0H 04458417
SENDQUIT LA    GR11,SEQDSMSG            MESSAGE NUMBER             UL0H 04460417
SENDMSGQ L     GR15,PRIMEWRT            ADDRESS OF LOG ROUTINE     UL0H 04462417
         BALR  GR14,GR15                PRINT MESSAGE              UL0H 04464417
         B     DEACTVCT                 DEACTIVATE EXITS AND QUIT  UL0H 04466417
NOTOTPDS LA    GR7,4                                               UL0H 04469417
         B     SENDQUIT                 SEND MESSAGE AND STOP PROC UL0H 04475417
NOTOTAL  LA    GR11,TOTNTSPT           NO TOTAL ON UPDTA INPLACE   000I 04477418
         B     SENDMSGQ                SEND ERROR MESSAGE          000I 04479418
OPENOM   L     GR3,DCBOM          ADDRESS OLD MASTER DCB         A34086 04480420
         CLI   PSSWOM,X'00'       IS OLD MASTER SEQUENTIAL       A34086 04481420
         BNE   OMLBLTST           NO.. TEST FOR INVALID LBL REQ. A34086 04482420
         MVI   OMOPENSW,X'0F'     ALLOW LABEL PROCESSING         A34086 04483420
         CLI   INPLCSW,X'0F'      UPDATE=INPLACE IN PROCESS      A34086 04484420
         BE    OPENUPDT           YES.. OPEN OLD MSTR FOR UPDATE A34086 04485420
OPENITUP CLI   INPLCSW,X'0F'           UPDATE INPLACE- NO NEW MASTEUL0H 04487417
         MVC   TESTLABL+1(1),LABELSW   SAVE CURRENT VALUE OF SWITCHUL0H 04493417
         MVC   TMPLBLCT+1(1),LABELCNT  SAVE CURRENT LABEL COUNT    UL0H 04499417
         MVC   LABELSW(1),TESTLABL     GET PREVIOUS VALUE OF SWITCHUL0H 04505417
         MVC   LABELCNT(1),TMPLBLCT    SET FOR O.M. COUNT          UL0H 04511417
         L     GR3,DCBOM               ADDRESS OF OLD MASTER DCB        04520000
         BE    OPENUPDT                YES- OPEN FOR UPDATE             04540000
         TM    BDSORG(GR3),PSDSET      SEQUENTIAL DATA SET?    @ZA06546 04550099
         BNO   OPENOM1                 NO,BRANCH TO OPEN       @ZA06546 04552099
         NI    50(GR3),X'20'           DELETE POINT MACR       @ZA06546 04554099
OPENOM1  OPEN  ((GR3))                OPEN OLD MASTER DATA SET @ZA06546 04560099
         MVC   LABELSW(1),TESTLABL+1   RETRIEVE CURRENT VALUE      UL0H 04568017
OPENCHKT L     GR1,DCBOM               ADDRESS OF OLD MASTER DCB   UL0H 04584017
         MVI   OMOPENSW,X'00'                                      UL0H 04592017
         LA    GR3,PSSWOM              PHYSICAL SEQUENTIAL SWITCH OM    04600000
         LA    GR7,SYSUT1NM            DD NAME SYSUT1 OLD MASTER        04620000
         LA    GR10,STORBUFO           RETURN FROM 'OPENCHEK' ROUTINE   04640000
OPENCHEK TM    BOFLGS(GR1),X'10'       WAS THERE AN OPEN ERROR          04660000
         BZ    BADOPEN                 YES                              04680000
         CLI   IOBADSW,X'0F'            I/O ERROR DURING LABEL PROCUL0H 04690017
         BE    DEACTVCT                 IF SO,PREPARE TO CLOSE     UL0H 04700017
         CLI   LBLRETCD,X'10'          HAS USER REQ TERMINATION    UL0H 04710017
         BE    HEADRMSG                 IF SO,PREPARE TO TERMINATE UL0H 04720017
         TM    BDSORG(GR1),PODSET      PARTITIONED DATA SET             04740000
         BC    8,GTMAINON              NO- LEAVE PSSWOM/NM 0 FOR PS     04760000
         MVI   0(GR3),X'0F'            SET OM OR NM AS PARTITIONED      04780000
GTMAINON LH    GR0,BBLKSI(GR1)         LOAD BLOCKSIZE SYSUT1 OR SYSUT2  04800000
         GETMAIN R,LV=(GR0)                                             04820000
         BR    GR10                    RETURN- BUFFER ADDRESS IN GR1    04840000
*                                                                     * 04860000
*                  OPEN OLD MASTER DATA SET FOR UPDATE INPLACE        * 04880000
*                                                                     * 04900000
OPENUPDT L     GR9,DSORGRTN   GET ADDRESS OF DSORG CHECK ROUTINE   3341 04910016
         BALR  GR8,GR9        GO CHECK DSORG BEFORE OPEN           3341 04920016
         CLI   OMTRLRSW,X'0F'           USER TRAILER ROUTINE       UL0H 04922017
         BE    NOTRLBLI                 IF SO,ERROR                UL0H 04924017
         CLI   NMTRLRSW,X'0F'     TRAILER ROUTINE FOR SYSUT2     A36128 04924421
         BE    NOTRLBLI           YES.. PRINT ERROR MESSAGE      A36128 04924521
         CLI   TOTALSW,X'00'           IS TOTALING REQUESTED       000I 04924618
         BNE   NOTOTAL                 IF SO, IT'S AN ERROR     PTRUT61 04925318
         MVI   FRSTCOMD,X'FF'           FLAG AS DCB OPEN           UL0H 04926017
         OPEN  ((GR3),UPDAT)                                       3341 04930016
         MVC   LABELSW(1),TESTLABL+1   RETRIEVE CURRENT VALUE      UL0H 04933017
         MVC   LABELCNT(1),TMPLBLCT+1  SET FOR N.M. COUNT          UL0H 04936017
         B     OPENCHKT                CHECK OPEN                       04940000
BADCARD  BAL   GR14,PRINTCRD           DATA CARD BEFORE FIRST COMMAND   04960000
BADSEQN  LA    GR11,SEQMSG             SEQUENCE ERROR MESSAGE           04980000
         B     GIVENGO                 GIVE MESSAGE AND GO ON           05000000
DUMMYNM  LA    GR7,SYSUT2NM            PUT DDNAME ADDR IN REG    A25310 05010018
BADOPEN  LA    GR11,NTOPMSG            CODE FOR MESSAGE                 05020000
FINERRA  BAL   GR9,GIVEMESS            GIVE MESSAGE                     05040000
         MVI   HICONCDE+1,12      SET COND. CODE AND GET OUT     A34087 05050020
FINERRA2 BAL   GR14,DEACTV                                       A25427 05060018
         MVI   COMDCD,X'00'            RESET COMMAND SWITCH        4929 05070017
         MVI   FLUSHSW,X'0F'           TURN FLUSH SWITCH ON        4929 05080017
          B     READCC                                             4929 05090017
STORBUFO ST    GR1,OMREADP             ADDRESS OF BUFFER ASSIGNED OLD   05100000
         ST    GR1,OMREADT             INITIALIZE STARTING ADDRESS      05120000
         CLI   OMBLKERR,X'00'          IS OLD MASTER BLOCKSIZE VALID    05140000
         BE    OPENNEW1                YES- OPEN NEW MASTER             05160000
         LA    GR3,OMBLOCKP            OLD MASTER BLOCKING FACTOR       05180000
         LA    GR9,OPENNEW1            RETURN FROM MESSAGE BUILDING     05200000
         LA    GR7,OMDC                ADDRESS OF 'OM' REFERENCE        05220000
*                                                                     * 05240000
*       WARNS USER BLOCKSIZE, LRECL ASSUMED 80/80 UNBLOCKED, FIXED    * 05260000
*                                                                     * 05280000
BILDMESS LA    GR11,BLOKSMSG           CODE FOR WARNING MESSAGE         05300000
         LA    GR6,1                                                    05320000
         STH   GR6,0(GR3)              ESTABLISH BLOCKING FACTOR OF 1   05340000
         STH   GR6,2(GR3)              ESTABLISH TEMPORARY BLOCK AS 1   05360000
GIVEMESS L     GR15,PRIMEWRT           ADDRESS OF MESSAGE CSECT         05380000
         BALR  GR14,GR15               GIVE MANY DIFFERENT MESSAGES     05400000
         BR    GR9                     RETURN USUALLY PROSSOM/OPENNEW1  05420000
*                                                                       05440000
*                   OPEN NEW MASTER DATA SET (SYSUT2) DCBNM             05460000
*                                                                       05480000
OPENNEW1 MVC   SYS1RECL(2),LRECL       SAVE SYSUT1 LOGICAL RECORD SIZE  05500000
         CLI   INPLCSW,X'0F'           IS THERE A NEW MASTER            05520000
         L     GR11,DCBOM              OLD MASTER DCB ADDRESS           05540000
         BE    PROSUPD                 SAVE OM FDAD IF UPDATE INPLACE   05560000
OPENNOW  L     GR3,DCBNM               ADDRESS OF NEW MASTER DCB        05660000
         L     GR9,DSORGRTN   GET ADDRESS OF DSORG CHECK ROUTINE   3341 05666016
         BALR  GR8,GR9        GO CHECK DSORG BEFORE OPEN           3341 05672016
         CLI   PSSWNM,X'00'             IS N.M. PHYSICAL SEQUENTIALUL0H 05673017
         BE    PREOPEN2                 IF SO,PREPARE TO OPEN      UL0H 05674017
NMLBLTST CLI   NMHDRSW,X'0F'            HEADER RTN ON NON-PODS?    UL0H 05675017
         BE    LABLMESG                 IF SO,ERROR                UL0H 05676017
         CLI   NMTRLRSW,X'0F'           TRAILER RTN ON NON-PODS?   UL0H 05677017
         BE    LABLMESG                 IF SO,ERROR                UL0H 05678017
         CLI   LABELSW,X'00'            IS LABEL PROCESSING REQ    UL0H 05679017
         BNE   LABLMESG                 IF SO,ERROR                UL0H 05680017
         CLI   TOTALSW,X'FF'            TOTALING ON NON-PODS?      UL0H 05681017
         BE    NOTOTPDS                 IF SO,ERROR                UL0H 05682017
         B     OPENSUT2                 IF NOT,PROCESS OPEN        UL0H 05683017
PREOPEN2 MVI   NMOPNSWT,X'1F'                                      UL0H 05684017
         MVI   FRSTCOMD,X'FF'                                      UL0H 05685017
         CLI   LABELSW,X'10'            LABELS IN INPUT STREAM     UL0H 05686017
         BNE   OPENSUT2                 IF NOT,OPEN DIRECTLY       UL0H 05687017
         MVI   OMSYSNLB,X'0F'                                      UL0H 05688017
OPENSUT2 OPEN  ((GR3),OUTPUT)                                           05692018
         MVI   NMOPNSWT,X'00'           RESET OPEN SWITCH          UL0H 05696017
         MVC   LABELCNT(1),TMPLBLCT+1  SET FOR TRAILER CT        A24428 05698018
         L     GR1,DCBNM               ADDRESS OF NEW MASTER DCB        05700000
         LA    GR3,PSSWNM              PHYSICAL SEQUENTIAL SWITCH NM    05720000
         LA    GR7,SYSUT2NM            DD NAME SYSUT2 NEW MASTER        05740000
         BAL   GR10,OPENCHEK           TEST FOR OPEN ERROR              05760000
         ST    GR1,NMWRITEP            STORE ADDRESS OF BUFFER SYSUT2   05780000
         ST    GR1,NMWRITET            INITIALIZE STARTING ADDRESS      05800000
         BAL   GR8,EXTNTCHK            CHECK EXTENTS               5324 05810017
         TM    NMBLKERR,X'01'          BLOCKING FACTOR ERROR?  @ZA28493 05820099
         BZ    PROSSOM                 NO- START PROCESSING    @ZA28493 05827099
         TM    NMBLKERR,X'80'          ERROR ON AN OLD D/S?    @ZA28493 05834099
         BZ    NOTNMOLD                NO,GIVE WARNING MSG     @ZA28493 05841099
         LA    GR7,SYSUT2NM            YES,GIVE ERROR MSG      @ZA28493 05848099
         B     BADOPEN                 AND QUIT                @ZA28493 05855099
NOTNMOLD LA    GR3,NMBLOCKP            NM BLOCKING FACTOR      @ZA28493 05862099
         LA    GR7,NMDC                ADDRESS OF 'NM' REFERENCE        05880000
         BAL   GR9,BILDMESS            GIVE MESSAGE                     05900000
*                                                                     * 05920000
*                 START OF PROCESSING AFTER DATA SETS ALL OPENED AND  * 05940000
*  SOME SYSIN RECORDS READ AND ANALYSED.                              * 05960000
*                                                                     * 05980000
PROSSOM  CLI   OPENSW,X'0F'            DCBHS OPEN YET              6339 05990017
         BE    OPENTHEM                NO-- GO OPEN THEM           6339 06000017
         L     GR11,DCBNM              NEW MASTER DCB              6339 06010017
         CLI   LABEL2SW,X'F0'           PROCESSING USER LABELS     UL0H 06012017
         BNE   PROSUPD                  IF NOT,PROCESS RECORD      UL0H 06014017
         MVI   LABEL2SW,X'00'           RESET LABEL PROCESSING SWT UL0H 06016017
         B     RET2SCAN                                            UL0H 06018017
PROSUPD  MVI   FLUSHSW,RESET0          CLEAR FLUSH SWITCH               06020000
         MVI   STARTMEM,X'0F'          HAVE STARTED MEMBER UPDATE       06040000
         MVC   FDADSET(8),BFDAD(GR11)  SAVE FDAD IN CASE MEMBER BLOWS   06060000
         MVC   TRKBAL(2),TRBAL(GR11)  SAVE TRACK BALANCE           5666 06070016
         XC    LASTCTRC(8),LASTCTRC    CLEAR CT SEQUENCE NUMBER BUFFER  06080000
         XC    LISTAREA(80),LISTAREA   CLEAR LIST AREA                  06100000
         TM    CTONLYSW,X'11'     IS THERE AN OLD MASTER         A30480 06120020
         BM    TESTCONS           NO.. TEST IF TO NEXT MEMBER    A30480 06140020
         CLI   INPLCSW,X'0F'           UPDATE INPLACE                   06160000
         BE    PROSSOMX         YES,CHECK FOR SEQUENTIAL OR REPRO  4696 06180015
         CLC   SYS1RECL(2),BLRECL(GR11) IS OM AND NM RECORD SIZE SAME   06200000
         BE    PROSSOMX                YES- CONTINUE                    06220000
         LA    GR11,SIZEBAD            LRECL SYSUT1 AND SYSUT2 UNEQUAL  06240000
         B     FINERRA                 GIVE MESSAGE AND QUIT            06260000
TESTCONS CLI   FIRSENTR,X'0F'          START OF NEXT COMMAND            06280000
         BE    RESETRD                 YES- GET MORE SYSIN              06300000
         B     CHKADREP                NO OLD MASTER- FINISH PROCESSING 06320000
BADDELET LA    GR11,DELMSG             INVALID DELETE RANGE MESSAGE     06340000
         B     GIVENGO                 GIVE MESSAGE- FLUSH MEMBER       06360000
AMESS    BAL   GR9,GIVEMESS            GIVE MESSAGE                     06380000
INVALOP  LA    GR11,ERROP              INVALID OPERATION                06400000
GIVENGO  BAL   GR9,GIVEMESS            GIVE MESSAGE                     06420000
         MVI   TEMPCON,X'04'           SET TEMPORARY CONDITION CODE     06440000
         B     CHKIFEND                CONTINUE IF POSSIBLE             06460000
OUTOFSEQ LA    GR3,SWITCHRD+1     ADDRESS OF STATEMENT         @YA02584 06520002
         B     BADCARD                 LIST BAD STATEMENT THEN MESSAGE  06540000
PROSSOMX CLI   PSSWOM,X'00'            IS OLD MASTER SEQUENTIAL         06560000
         BE    READSW1                 YES- SKIP LIST BUILD             06580000
         TM    REPROSW,X'0F'           FIRST ENTRY TO REPRO             06600000
         BC    8,NOREPRO               NO REPRO AT ALL                  06620000
         BC    4,READOM                NOT FIRST REPRO                  06640000
RESTREPO MVI   REPROSW,X'0E'           RESET REPRO SWITCH               06660000
NOREPRO  MVC   LISTAREA+4(8),MEMNAME   MOVE MEMBER NAME TO LIST AREA    06680000
         MVC   LISTAREA(4),SIZELIST    MOVE SIZELIST CONSTANT  72 BYTES 06700000
         CLI   BLDFNDSW,X'0E'        HAVE DONE BLDL FOR THIS MEMB? 2163 06706018
         BE    READOM                YES,CONTINUE READING FROM OM  2163 06712018
         L     GR1,DCBOM               ADDRESS OF DCB                   06720000
         BLDL  (GR1),LISTAREA                                           06740000
         STC   GR15,TEMP               STORE RETURN CODE FROM BLDL      06760000
         MVI   BLDFNDSW,X'0E'          MARK BLDL AS DONE           2163 06770018
         CLI   TEMP,X'00'              IS MEMBER NAME IN OM DIRECTORY   06780000
         BE    CHECKADD                YES- SEE IF TRYING TO ADD NAME   06800000
         CLI   TEMP,X'04'              IS MEMBER NAME MISSING           06820000
         BE    CHECKNA                 YES- SEE IF TRYING TO ADD NAME   06840000
BLDLERR  LA    GR11,BLDLMSG     GET ADDRESS OF BLDL I/O ERR MSG  A27716 06860019
         B     FINERRA   GO PRINT   MESSAGE                      A27716 06880019
FINDERR  LA    GR11,FINDMSG    GET ADDRESS OF FIND I/O ERR MSG   A27716 06900019
         B     FINERRA   GO PRINT   MESSAGE                      A27716 06920019
CHECKADD CLI   ADDSW,X'00'             IS ADD SWITCH ON                 06940000
         BE    FINDIT                  NO- NAME IS THERE SO IS OK       06960000
         LA    GR11,STOWMSGN           MESSAGE NUMBER NAME FOUND MESSG  06980000
         B     MESGNOW                 CANNOT ADD IF IT IS FOUND        07000000
CHECKNA  TM    ADDSW,X'0E'             IS ADD SWITCH ON                 07020000
         BC    1,TESTCONS              TEST IF NEXT MEMBER              07040000
         LA    GR11,STOWMSGT           MEMBER NAME NOT FOUND            07060000
MESGNOW  LA    GR7,MEMNAME             ADDRESS OF MEMBER NAME           07080000
         MVI   ASISMSW,X'0E'           FORCE SPECIAL MESSAGE BUILDING   07100000
         B     AMESS                   NAME IS MISSING REPRO/REPL/CHNGE 07120000
FINDIT   LA    GR0,LISTAREA+12    GET ADDRESS OF TTRK OF MEMBER  A30625 07160020
         L     GR1,DCBOM               ADDRESS OF OLD MASTER DCB        07200000
         FIND  (GR1),(GR0),C                                            07220000
         STC   GR15,TEMP               STORE FIND RETURN CODE           07240000
         CLI   TEMP,X'00'              I/O ERROR IF NOT SUCCESSFUL      07260000
         BNE   FINDERR                                           A27716 07280019
         TM    LISTAREA+17,X'80'       TEST IF ALIAS BIT SET            07300000
         BC    8,TESTCMDX              NO- CONTINUE                     07320000
         CLI   PSSWNM,X'00'             IS DATA SET PHY. SEQ.      UL0H 07326017
         BE    TESTCMDX                 IF SO,NO ALIAS MSG         UL0H 07332017
         LA    GR11,ALTTRUE            ADDRESS OF MESSAGE CODE          07340000
         NI    LISTAREA+17,X'7F'       RESET ALIAS BIT                  07360000
         BAL   GR9,GIVEMESS            GIVE ALIAS TO TRUE MESSAGE       07380000
TESTCMDX CLI   FIRSENTR,X'0F'          START OF NEXT COMMAND            07400000
         BE    RESETRD                 YES- RESET SWITCH AND READCC     07420000
         TM    CHNGESW,X'0E'           TEST IF COMMAND IS CHANGE        07440000
         BC    1,READSW1               YES- READ OLD MASTER FIRST TIME  07460000
         TM    REPROSW,X'0E'           TEST IF COMMAND IS REPRO         07480000
         BC    1,READSW1               YES- READ OLD MASTER FIRST TIME  07500000
         B     CHKADREP                ADD OR REPLACE- CT TO NEW MASTER 07520000
READOM   CLI   READNOOM,X'0F'          SHOULD ANOTHER OM RECORD BE READ 07540000
         BE    CHKOP                   NO- HAVE NOT PROCESSED LAST ONE  07560000
         TM    CHNGESW,X'0E'           CHANGE FUNCTION                  07580000
         BC    7,OKONTOOM              YES- CONTINUE READ OLD MASTER    07600000
         TM    REPROSW,X'0E'           REPRO FUNCTION                   07620000
         BC    8,CHKADREP              NO- SHOULD NOT BE HERE ADD/REPL  07640000
OKONTOOM TM    MULTI,X'0F'             IS THIS SECOND PASS         1796 07650018
         MVI   MULTI,X'00'        TURN OFF SWITCH                  1796 07668014
         BO    READSW1                 YES-READ OLD MASTER         1796 07676014
         LH    GR15,OMBLOCKT      LOAD TEMPORARY BLOCKING FACTOR   1796 07684014
         BCT   GR15,RRLBOM             DONT READ TILL ALL PROCESSED1796 07692014
*                                                                     * 07700000
*                  READ OLD MASTER RECORDS                            * 07720000
*                                                                     * 07740000
READSW1  L     GR8,OMREADP             LOAD START OF BUFFER             07760000
         L     GR3,DCBOM               ADDRESS OF OM DCB                07780000
         MVC   OMBLOCKT(2),OMBLOCKP    INITIALIZE BLOCKING FACTOR       07800000
         ST    GR8,OMREADT             STORE POINTER TO START           07820000
         CLI   REPLUPDT,X'0F'          NEW RECORD IN BLOCK TO WRITE     07840000
         BE    WRTEREPR                YES- WRITE THIS BLOCK            07860000
         MVI   DECBOM+5,X'80'          RESTORE READ CODE IN DCB         07920000
         TM    BLDFNDSW,X'0F'          MAKE SURE A BLDL WAS DONE   2163 07922018
*                                      FOR THIS MEMBER             2163 07924018
         BO    NOREPRO                                             2163 07926018
         MVI   MULTI,X'00'          SET SW TO FINISH PROC THIS BLK 2653 07930018
         READ  DECBOM,SF,(GR3),(GR8),'S'                                07940000
         CHECK DECBOM                                                   07960000
         MVI   OMEODX+1,X'F0'          MARK OLD MASTER NOT EMPTY A36095 07960421
         CLI   NMSYSNLB,X'0F'           WERE EOV LABELS SAVED?     UL0H 07962017
         BNE   RDRET16                  IF SO,FLAG AS NON-TRANSMIT-UL0H 07964017
         MVI   NMSYSNLB,X'00'           TABLE TO SYSUT2            UL0H 07966017
RDRET16  CLI   LBLRETCD,X'10'           DID USER EXT RTN REQ TERM? UL0H 07968017
         BE    HEADRMSG                 IF SO,PRINT MSG AND QUIT   UL0H 07971017
         CLI   IOBADSW,X'F0'            DID AN I/O ERROR OCCUR     UL0H 07974017
         BE    DEACTVCT                 IF SO PREPARE TO QUIT      UL0H 07977017
         L     GR14,DECBOM+16          ADDRESS OF OLD MASTER IOB        07980000
         LH    GR14,14(GR14)           RESIDUAL COUNT                   08000000
         LTR   GR14,GR14               TEST IF ANY RESIDUAL COUNT       08020000
         BZ    NOTSHORT                NO- CONTINUE                     08040000
         L     GR10,DCBOM              ADDRESS OF OLD MASTER DCB        08060000
         LH    GR15,BBLKSI(GR10)       LOAD BLOCKSIZE                   08080000
         SR    GR15,GR14               LENGTH OF RECORDS READ           08100000
         SR    GR14,GR14                                                08120000
         STH   GR15,SHRTBLK      SAVE NEW BLKSIZE FOR WRITE INPLACE3628 08140015
         LH    GR3,BLRECL(GR10)        LOGICAL RECORD LENGTH            08160000
         DR    GR14,GR3                COMPUTE VALID RECORD COUNT       08180000
         MVC   OMBLOCKT(2),OMBLOCKP    MAXIMUM BLOCK FORCES RRLBOM CODE 08200000
         MVI   SHORTBLK,X'0F'          FLAG AS SHORT BLOCK              08220000
         B     OKRECORD                PROCESS LAST (SHORT) BLOCK       08240000
RRLBOM   STH   GR15,OMBLOCKT           STORE TEMPORARY BLOCK FACTOR     08260000
         CLI   SHORTBLK,X'00'          SHORT BLOCK                      08280000
         BE    NOTSHORT                NO- CONTINUE                     08300000
         LH    GR15,VALIDREC           ACTUAL VALID RECORD COUNT        08320000
         BCT   GR15,OKRECORD           BRANCH IF RECORDS TO PROCESS     08340000
         MVI   SHORTBLK,RESET0         CLEAR SHORT BLOCK SWITCH         08360000
         B     READSW1            READ NEXT OLD MASTER RECORD    A34087 08390020
OKRECORD STH   GR15,VALIDREC           STORE NEW VALID RECORD COUNT     08420000
NOTSHORT L     GR14,OMREADT            ADDRESS OF LOGICAL RECORD        08440000
         LR    GR7,GR14                SAVE POINTER TO PRESENT RECORD   08460000
         ST    GR14,LASTRECB           POINTER TO LAST RECORD PROCESSED 08480000
         LH    GR1,LRECL               LOAD LOGICAL RECORD LENGTH       08500000
         AR    GR14,GR1                POINT TO NEXT RECORD             08520000
         LA    GR6,OMINAREA            OLD MASTER WORK AREA             08540000
         ST    GR14,OMREADT            ADDRESS OF NEXT RECORD TO USE    08560000
         BCTR  GR1,0                   DECREMENT FOR EXECUTE MVC        08580000
         EX    GR1,MOVEPART            MOVE RECORD TO WORK AREA         08600000
         LH    GR8,IDENTXX             COLUMN WITH SEQUENCE NUMBER      08620000
         LH    GR9,IDENTY              SIZE OF SEQUENCE NUMBER          08640000
         AR    GR8,GR6                 POINT TO SEQUENCE NUMBER FIELD   08660000
         BCTR  GR9,0                   DECREMENT FOR EXECUTE            08680000
         EX    GR9,CHKSEQNB            TEST FOR BLANK SEQUENCE NUMBER   08700000
         BNE   CHKOP                   NO- CONTINUE                     08720000
         TM    CHNGESW,X'0E'           CHANGE OPERATION         YA01188 08730002
         BZ    BYPASS                  IF NOT, TEST RENUMBERING YA01188 08732002
         MVI   DONOTRDC,X'0F'          SET SWITCH NOT READ SYSINYA01188 08734002
BYPASS   CLI   RENUMALL,X'0F'          RENUMBER ALL CARDS       YA01188 08740002
         BE    NUMBRCD                 YES- GIVE BLANK SEQ A NUMBER     08760000
         B     TESTLIST                WRITE LAST RECORD                08780000
CHKOP    TM    CHNGESW,X'0E'           IS COMMAND TYPE CHNGE            08800000
         BC    1,CHNGCOMD              YES- CANNOT WRITE DIRECTLY       08820000
         TM    REPROSW,X'0E'           REPRODUCE DATA SET OR MEMBER     08840000
         BC    1,TESTLIST              YES- COPY EXACTLY AS IT IS       08860000
CHKADREP LA    GR6,SWITCHRD+1          ADDRESS INPUT CARD REPL/ADD      08880000
         MVI   READNOOM,X'0F'          READ NO MORE FROM OLD MASTER     08900000
         CLI   NUMBRSW,X'0F'           NUMBERING TO BE DONE             08920000
         BE    NUMBRCD                 YES- NUMBER CARD                 08940000
         B     TESTLIST                NO- LIST AND WRITE AS IS         08960000
*                                                                     * 08980000
*                   NUMBERS RECORD- GR6 POINTER TO RECORD             * 09000000
*                                                                     * 09020000
SETNUM1  OI    SEQ1SW,X'F0'            SET SEQ1 SATISFIED- NUMBER       09040000
         MVI   READNOOM,RESET0    CLEAR DONOT-READ OM SW         A23927 09046018
NUMBRIT  LR    GR6,GR10                ENTRY FROM ENTNUMB ROUTINE       09060000
NUMBRCD  L     GR7,SEQWA               NEW OR INCREMENTED SEQUENCE      09080000
         LH    GR3,IDENTXX             SEQUENCE START COLUMN            09100000
         CVD   GR7,TEMP                SEQUENCE NUMBER IN DECIMAL       09120000
         LH    GR1,IDENTY              SEQUENCE SIZE                    09140000
         LA    GR7,LASTSEQN            LAST SEQUENCE NUMBER WRITTEN     09160000
         CLI   IDENTN+D1,RESET0        NUMERIC SEQFLD SPECIFIED YM07522 09162002
         BNE   UPKNSET                 YES                      YM07522 09164002
         LA    GR8,L8                  MAXIMUM SEQ NO SIZE      YM07522 09165002
         SR    GR8,GR1                 SEQ NO OFFSET            YM07522 09165202
         AR    GR7,GR8                 PT TO PERTINENT FIELD    YM07522 09165402
         B     UPKSQN                  CONTINUE                 YM07522 09165602
UPKNSET  MVC   D0(L8,GR7),NEW1NUMB     SET ALPHANUMERIC SEQ NO  YM07522 09166002
         LA    GR7,L7(GR7)             GET NUMERIC PORTION      YM07522 09168002
         SH    GR7,NUMOFFST                                     YM07522 09170002
         IC    GR1,IDENTN+D1           GET SIZE                 YM07522 09172002
UPKSQN   BCTR  GR1,GR0                 SUBTRACT 1               YM07522 09174002
         SLL   GR1,B4                  SHIFT FOR EXECUTE        YM07522 09176002
         EX    GR1,UPKSN               SET UP NUMERIC PORTION   YM07522 09178002
         SRL   GR1,B4                  RESTORE LENGTH           YM07522 09180002
         AR    GR7,GR1                 ENSURE LAST DIGIT IS     YM07522 09182002
         OI    D0(GR7),DIGIT           * VALID                  YM07522 09184002
         LA    GR7,LASTSEQN            RESTORE LAST SEQ NO PTR  YM07522 09186002
         LH    GR1,IDENTY              RESTORE SIZE             YM07522 09188002
         LA    GR8,8                   MAXIMUM SEQUENCE NUMBER SIZE (8) 09220000
         LR    GR10,GR6                SAVE POINTER TO START OF CARD    09240000
         SR    GR8,GR1                 OFFSET SEQUENCE NUMBER REFERNCE  09260000
         AR    GR7,GR8                 PICK UP PERTINENT PART OF NUMBER 09280000
         AR    GR6,GR3                 ID COLUMN IN RECORD              09300000
         L     GR11,SEQWA              LAST SEQUNCE NUMBER              09320000
         BCTR  GR1,0                   DECREMENT FOR EXECUTE            09340000
         TM    INSERTSW,X'30'     INSERT WITH FORCED RENUMB?   @YA02533 09360002
         BC    5,TESTIT           BRANCH TO TEST IF CONT RENUM @YA02533 09380002
         CLI   INSERTSW,X'0E'          FORCING INSERT IF '0E'           09400000
         BNE   NUMBNORM                NOT '0E'- NUMBER CARD AS USUAL   09420000
TESTIT   EX    GR1,COMPARES            COMPARE SEQ (7) TO RECORD (6)    09440000
         BNH   RESETNS                 INPUT HIGH STOP FORCING RENUMBER 09460000
NUMBNORM CLI   FSTINSRT,X'00'          FIRST DATA RECORD AFTER   A25432 09466019
*                           A ./ NUMBER WITH INSERT=YES ?        A25432 09472019
         BNE   GOON                    NO,DON'T SET SWITCH AGAIN A25432 09478019
         CLI   INSERTSW,X'1F'      INSERT=YES 2:ND TIME        @ZA07377 09480099
         BE    GOON                YES,BRANCH                  @ZA07377 09482099
         TM    INSERTSW,X'0F'      INSERT=YES?                 @ZA07377 09484099
         BNO   GOON                NO,BRANCH                   @ZA07377 09484799
         MVI   FSTINSRT,X'0F'      1ST DATA REC IS PROCESSED   @ZA32389 09485499
         TM    INSERTSW,X'30'      INSERT WITH FORCED RENUMB?  @ZA07377 09486899
         BC    5,GOON              YES,BRANCH                  @ZA07377 09488099
         LR    GR8,GR6             POINTER TO SEQUENCE FIELD   @ZA07377 09488499
         EX    GR1,CHKSEQNB        TEST FOR BLANK SEQ NUMBER   @ZA07377 09488899
         BNE   STOPINST            NOT BLANK SEQ, BRANCH       @ZA07377 09489299
GOON     EX    GR1,MOVEPART        MOVE NEW SEQ NUMBER TO CARD @ZA29907 09490099
         LR    GR6,GR10                RELOAD POINTER TO START OF CARD  09500000
         A     GR11,INCREMWA           ADD INCREMENT FACTOR             09520000
         ST    GR11,SEQWA              NEXT SEQUENCE NUMBER             09540000
         CLI   INSERTSW,X'0F'          INSERT OPTION                    09560000
         BNE   TESTLIST                WRITE LAST RECORD                09580000
         TM    SEQ1SW,X'F0'            SEQUENCE 1 SATISFIED             09600000
         BC    8,TESTLIST              NO- CONTINUE TO WRITE OLD MASTER 09620000
         LA    GR9,OMINAREA            OLD MASTER BUFFER                09640000
         CR    GR6,GR9                 READY TO WRITE OLD MASTER        09660000
         BE    TESTLIST                YES- JUST STARTING BLOCK INSERT  09680000
         MVI   DONOTRDC,RESET0         ALLOW READING OF SYSIN           09700000
         MVI   INSRTRD,X'0F'           FLAG AS INSERT READ PROTECT GR9  09720000
         BAL   GR9,READCC              GET NEXT CARD TO INSERT          09740000
WRTINSRT LA    GR6,SWITCHRD+1          BUFFER ADDRESS SYSIN RECORD LAST 09820000
         ST    GR3,NEXTINSR            POINTER TO NEXT SYSIN RECORD     09840000
         B     TESTLIST                WRITE LAST RECORD                09860000
RETRINST CLI   FINICCS,X'0F'           MORE SYSIN                       09880000
         BE    INSTDONE                FINISH UP SYSIN                  09900000
         L     GR3,NEXTINSR            GET ADDRESS OF NEXT RECORD       09920000
         LA    GR6,SWITCHRD+1          START OF RECORD BUFFER           09940000
         MVC   0(80,GR6),0(GR3)        MOVE RECORD TO BUFFER            09960000
         CLC   0(2,GR3),DOTSLASH       IS INPUT A CONTROL STATEMENT     09980000
         BNE   INSRTANY                ANALYSE SEQUENCE FIELD IF BLANK  10000000
         LA    GR10,RESCANIT           RETURN FROM INSRTOVR ./ NEXT     10020000
         B     INSRTOVR                END BLOCK INSERT WHEN ./ READ    10040000
*                                                                     * 10060000
*                 LIST THEN WRITE RECORD- RENUMBER IF NECESSARY       * 10080000
*                                                                     * 10100000
TESTRCD  CLI   DELETSW,X'0F'           IS DELETE IN EFFECT         5944 10106017
         BE    DELETCK                 YES, GO CHECK SEQ TO DELETE 5944 10112017
LISTREC  CLI   NUMBRSW,X'0F'           NUMBERING TO BE DONE             10120000
         BE    NUMBRCK                 YES                              10140000
TESTLIST TM    CHNGESW,X'0F'           IS THIS A CHANGE OPERATION M3410 10141018
         BZ    NOTEST1                 NO , SKIP THE TEST         M3410 10142018
         CLI   REPSW,X'0F'             REPLACE,ALREADY PRINTED  YA01187 10142402
         BE    RENUMFOR           YES,AVOID PRINTING TWICE     @YA02533 10142802
         CLI   REPSW,X'FF'             PARTIALLY UPDATED        YA01187 10146802
         BNE   CONTINU                 NO,CONTINUE NORMAL PROC  YA01187 10149602
         MVC   LOGOUTAR+15(80),0(GR6)  MOVE UPDATED CARD TO PRINTA01187 10150402
         MVC   LOGOUTAR+95(25),UPDTMS  MOVE UPDATING MESS       YA01187 10152702
         MVI   ASISMSW,X'0F'           INDICATE RECORD TO PRINT YA01187 10153602
         B     PRINTMOD                GO TO PRINT ROUTINE      YA01187 10154602
RENUMFOR CLI   INSERTSW,X'0E'     RENUMBERING FORCED?          @YA02533 10156502
         BNE   DONOTPRT           NO,BRANCH TO WRITE           @YA02633 10157102
CONTINU  LR    GR9,GR6                 SAVE REGISTER CONTENTS     M3410 10157702
         AH    GR6,IDENTXX             POINT TO SEQUENCE FIELD   A24812 10158402
         LA    GR7,OLDOMSEQ            LAST NM SEQUENCE FIELD    A24812 10159402
         LH    GR1,IDENTY              LENGTH OF SEQUENCE FIELD  A24812 10161002
         BCTR  GR1,0                   DECREMENT FOR EXECUTE     A24812 10164002
         EX    GR1,COMPARES            COMPARE SEQUENCE NUMBERS  A24812 10165002
*                                      OF LAST RECORD WRITTEN TO A24812 10167002
*                                      RECORD TO BE WRITTEN      A24812 10168002
         BL    GOODSEQ                 BRANCH IF LOW             A24812 10170002
         LR    GR3,GR9                 PUT RECORD ADDR IN REG    A24812 10172002
         BAL   GR14,PRINTCRD           PRINT CARD                A48737 10173002
         B     INVALOP                 GO TO MSG RTN             A48737 10174002
GOODSEQ  MVC   OLDOMSEQ(8),0(GR6)      SEQUENCE OF RECORD TO BE  A24812 10176002
*                                      WRITTEN                   A24812 10179018
         LR    GR6,GR9                 RESTORE REGISTER          A24812 10182018
         TM    INSERTSW,X'20'     RECORD TO BE MERGED?         @YA02533 10182102
         BO    MERGRENU           YES,BRANCH TO GIVE MSG       @YA02533 10182202
         TM    INSERTSW,X'10'          RENUMBERING FORCED       YA01187 10182402
         BO    RENUMFC                 RENUMBER                 YA01187 10183902
         CLI   INSERTSW,X'0E'           RENUMBERING FORCED      YA01187 10184402
         BNE   CHKINSRT                NO,GIVE NO MESSAGE       YA01187 10186402
RENUMFC  CLI   REPSW,X'0F'        REPLACE GIVEN?               @YA02533 10187602
         BNE   MOVEOLD            NO,BRANCH TO GIVE OLD RECORD @YA02533 10187702
MERGRENU MVC   LOGOUTAR+15(80),SWITCHRD+1 MOVE NEW RECORD      @YA02533 10187802
         NI    INSERTSW,X'DF'     RESET INSERT RENUM SW        @YA02533 10188002
         B     MOVEMSG            GIVE MSG RENUMB FORCED       @YA02533 10188802
MOVEOLD  MVC   LOGOUTAR+15(80),OMINAREA MOVE OLD RECORD        @YA02533 10189602
MOVEMSG  MVC   LOGOUTAR+95(25),RENUMMS  SET MESSAGE RENUMBER   @YA02533 10190602
         MVI   ASISMSW,X'0F'           SET SWITCH FOR PRINT     YA01187 10191202
         B     PRINTMOD                 PRINT CARD              YA01187 10192602
CHKINSRT CLI   READNOOM,X'0F'           SYSIN RECORD            YA01187 10193602
         BNE   NOTEST1                 NO,BYPASS INSERT PRINTINGYA01187 10194602
         MVC   LOGOUTAR+95(25),INSERTMS  MOVE INSERT MESSAGE    YA01187 10196302
         LA    GR6,SWITCHRD+1     ADDRESS OF SYSIN RECORD      @YA02533 10198702
SHRTPRT  LH    GR1,LRECL               LOAD RECORD LENGTH       YA01187 10199302
         BCTR  GR1,0                   SUBTRACT ONE BEFORE EXEC YA01187 10200002
         LA    GR7,LOGOUTAR+15         LOAD PRINT BUFFER        YA01187 10201002
         EX    GR1,LOGMOVE             MOVE CARD TO BUFFER      YA01187 10202002
         MVI   ASISMSW,X'0F'           SET SWITCH TO PRINT CARD YA01187 10203002
PRINTMOD L     GR15,PRIMEWRT           LOAD PRINT MODULE        YA01187 10204002
         BALR  GR14,GR15               BRANCH TO PRINT ROUTINE  YA01187 10205002
         TM    INSERTSW,X'20'     INSERT RENUM SW SET?         @YA02533 10206002
         BNO   DONOTPRT           NO,GO TO WRITE RECORD        @YA02533 10207002
         B     NUMBRCD            BRANCH TO RENUMBER           @YA02533 10208002
NOTEST1  CLI   REPSW,X'0E'        REPLACED RECORD LISTED?      @ZA01683 10208402
         BE    SHRTPRT            YES PRINT REPLACEMENT        @ZA01683 10208802
         CLI   FLLISTSW,X'01'     IS FULL LIST TO BE GIVEN     @ZA01683 10209002
         BNE   DONOTPRT                                          A24812 10210002
         TM    CHNGESW,X'0F'           CHANGE OPERATION         YA01187 10211002
         BC    7,SHRTPRT               YES,PRINT NORMAL LIST=ALLYA01187 10212002
         LH    GR1,LRECL               LOGICAL RECORD LENGTH            10213002
         BCTR  GR1,0                   DECREMENT FOR EXECUTE MVC        10220000
         LA    GR7,LOGOUTAR+40         ADDRESS OF PRINT BUFFER          10240000
*                     GR6 POINTS TO RECORD TO BE MOVED                * 10260000
         EX    GR1,LOGMOVE             MOVE RECORD TO PRINT BUFFER      10280000
         MVI   ASISMSW,X'0F'           SET SWITCH TO PRINT RECORD       10300000
         L     GR15,PRIMEWRT           ADDRESS OF MESSAGE WRITER        10320000
         BALR  GR14,GR15               PRINT RECORD                     10340000
DONOTPRT MVI   REPSW,X'00'         RESET SWITCH REPLACE /UPDATE YA01187 10380002
         CLI   INPLCSW,X'0F'      IS THIS UPDATE INPLACE           1796 10390001
         BE    PUTINPLA                YES- PUT RECORD IN PLACE         10420000
         LH    GR15,NMBLOCKT           LOAD TEMPORARY BLOCKING FACTOR   10440000
         L     GR14,NMWRITET           WRITE BLOCK OR RECORD NOW        10460000
         LH    GR1,LRECL               SIZE OF LOGICAL RECORD           10480000
         BCTR  GR1,0                   DECREMENT FOR EXECUTE OF MVC     10500000
         LR    GR7,GR14                PUT ADDRESS IN PROPER REGISTER   10520000
         EX    GR1,LOGMOVE             MOVE RECORD TO BUFFER            10540000
         MVI   NMBUFFR,X'0F'           SET SWITCH RECORDS IN NM BUFFER  10560000
         BCT   GR15,BLOCKIT            BRANCH IF NOT FULL BLOCK         10580000
         MVC   NMBLOCKT(2),NMBLOCKP    RESTORE BLOCKING FACTOR          10600000
NMLSTWRT L     GR9,NMWRITEP            START OF NEW MASTER RECORD       10620000
         L     GR6,DCBNM               ADDRESS OF DCB                   10640000
         ST    GR9,NMWRITET            STORE POINTER TO START           10660000
NMTOTCHK CLI   TOTALSW,X'FE'            IS TOTALING REQUESTED      UL0H 10670017
         BNL   NMTOTRTN                 IF SO,GIVE USER RTN CONTROLUL0H 10680017
WRITENM  WRITE DECBNM,SF,(GR6),(GR9),'S'                           UL0H 10690017
         CLI   LBLRETCD,X'10'          USER LABEL RETURN CODE = 16 UL0H 10693017
         BE    HEADRMSG                IF SO, PRINT MSG AND TERMM  UL0H 10696017
         CLI   NMBUFFR,X'01'           LAST WRITE NEW MASTER            10700000
         BE    CHECK                   YES- RETURN SET IN GR7           10720000
         LA    GR9,CHECK               LOAD RETURN ADDRESS FROM ROUTINE 10740000
CHECKRET CLI   INSRTRD,X'0F'           WRITING INSERT RECORDS           10760000
         BE    SETUP7                  YES- PROCESS MORE INSERT RECORDS 10780000
         TM    REPROSW,X'0E'           REPRODUCING FROM OLD MASTER      10800000
         BC    1,SETRET7               YES- READ OLD MASTER             10820000
         LA    GR7,READCC              RETURN FOR MORE SYSIN CARDS      10840000
         BR    GR9                     RETURN FROM ROUTINE              10860000
SETRET7  LA    GR7,READOM              READ OLD MASTER RETURN SET       10880000
         BR    GR9                     RETURN FROM ROUTINE              10900000
SETUP7   LA    GR7,RETRINST            RETURN TO PROCESS INSERT         10920000
         BR    GR9                     MAY GO TO BLOCKIT NOT CHECK      10940000
NMTOTRTN CLI   PSSWNM,X'00'             IS DATA SET PHY. SEQ       UL0H 10940717
         BNE   NOTOTPDS                 IF NOT,ERROR               UL0H 10941417
         CLI   TOTALSW,X'FF'            FIRST ENTRY TO USER        UL0H 10942117
         BNE   USRTOTAL                 IF NOT,BYPASS MESG         UL0H 10942817
         MVI   TOTALSW,X'FE'            FLAG AS NOT FIRST ENTRY    UL0H 10943517
         LA    GR11,TOTENTMS            MESSAGE CONSTANT           UL0H 10944217
         L     GR15,PRIMEWRT            ADDRESS OF LOG ROUTINE     UL0H 10944917
         BALR  GR14,GR15                GIVE MESSAGE               UL0H 10945617
USRTOTAL LA    GR1,TOTLPARM             ADDRESS OF TOTAL PARAMETRS UL0H 10946317
         ST    GR9,TOTLPARM             PLACE BUFFER ADDR IN PRMLST000I 10946618
         L     GR15,TOTALADR            USER ROUTINE ADDRESS       UL0H 10947017
         BALR  GR14,GR15                GIVE USER CONTROL          UL0H 10947717
         STH   GR15,TOTRTNCD            STORE USER RETURN CODE     UL0H 10948417
         CLC   TOTRTNCD(2),SIXTEEN      RC=16                      UL0H 10949117
         BNL    TOT16TRM               IF SO, PREPARE TO TERMINATE 000H 10949818
         CLC   TOTRTNCD(2),EIGHT        RC=8                       UL0H 10950517
         BE    TOT08TRM                IF SO, CLOSE IT UP          000H 10951218
         CLC   TOTRTNCD(2),FOUR+2       RC=4                       UL0H 10951917
         BE    WRITENM                  THEN WRITE RECORD          UL0H 10952617
         MVI   TOTALSW,X'00'            DISCONTINUE TOTALING       UL0H 10953317
         CLC   TOTRTNCD(2),ZERO         RC=0                       UL0H 10954017
         BE    ZERORTCD                 IF SO,PRINT  RC  MSG       UL0H 10954717
         LA    GR11,TOTBDRCD            INVALID  RETURN CODE  MSG  UL0H 10955417
         B     TERMMESG                 PRINT  MSG                 UL0H 10956117
ZERORTCD LA    GR11,TOTTERM             TOTAL TERM MSG             UL0H 10956817
TERMMESG L     GR15,PRIMEWRT            LOG ROUTINE ADDRESS        UL0H 10957517
         BALR  GR14,GR15                GIVE MESSAGE               UL0H 10958217
         B     WRITENM                  WRITE RECORD               UL0H 10958917
TOT16TRM LA    GR11,TOTTERM            PREPARE TO PRINT TERM MESSAG000H 10959018
         L     GR15,PRIMEWRT           ADDRESS OF LOG ROUTUNE      000H 10959118
         BALR  GR14,GR15               PRINT MESSAGE               000H 10959218
         B     DEACTVCT                PREPARE TO DEACTIVATE EXITS 000H 10959318
TOT08TRM LA    GR11,TOTTERM            PREPARE TO PRINT TERM MESSAG000H 10959418
         L     GR15,PRIMEWRT           ADDRESS OF LOG ROUTUNE      000  10959518
         BALR  GR14,GR15               PRINT MESSAGE               000H 10959618
         B     LASTLEG                 PREPARE TO EXIT             000H 10959718
CHECK    CHECK DECBNM                  WAIT FOR END OF WRITE            10960000
RTRN     BR    GR7                     RETURN TO PROPER ROUTINE    5324 11010017
BLOCKIT  STH   GR15,NMBLOCKT           STORE REMAINING RECORD/BLOCK CNT 11020000
         L     GR6,DCBNM               ADDRESS OF NEW MASTER DCB        11040000
         LH    GR6,BLRECL(GR6)         OBTAIN LOGICAL RECORD LENGTH     11060000
         AR    GR14,GR6                POINTER TO NEXT RECORD SLOT      11080000
         ST    GR14,NMWRITET           ADDRESS FOR NEXT RECORD          11100000
         BAL   GR9,CHECKRET            ESTABLISH RETURN IN GR7          11120000
         BR    GR7                     RETURN TO PROPER ROUTINE         11140000
WRTLASTB L     GR14,NMWRITET           ADDRESS OF LAST ENTRY            11160000
         L     GR15,NMWRITEP           START OF BUFFER                  11180000
         L     GR11,DCBNM              ADDRESS OF NEW MASTER DCB        11200000
         SR    GR14,GR15               SIZE OF LAST BLOCK               11220000
         LTR   GR14,GR14               ARE THERE ANY RECORDS       4929 11225017
         MVI   NMBUFFR,X'01'           FLAG AS LAST WRITE          4929 11230017
         BZ    STOW2                   FINISH UP                   4929 11235017
         MVC   SARG(2),BBLKSI(GR11)    SAVE BLOCKSIZE                   11240000
         STH   GR14,BBLKSI(GR11)       PUT LENGTH OF LAST BLOCK         11280000
         BAL   GR7,NMLSTWRT            WRITE LAST BLOCK                 11300000
         MVC   BBLKSI(2,GR11),SARG     RESTORE BLOCKSIZE                11320000
         B     STOW2                   FINISH UP                        11340000
*                                                                     * 11360000
*                 DETERMINE OPERATION FOR CHANGE FUNCTION             * 11380000
*                                                                     * 11400000
CHNGCOMD CLI   DELETSW,X'0F'           IS DELETE IN EFFECT              11420000
         BE    DELETCK                 YES- CHECK RANGE                 11440000
         CLI   FINICCS,X'0F'           END OF SYSIN                     11460000
         BE    WRITOLD1                FINISH OLD MASTER                11480000
         TM    COMDCD2,X'0F'           COMMAND PENDING         @ZA01690 11500002
         BO    WRITOLD1              YES- FINISH UP OLD MASTER @ZA01690 11520002
         MVI   DONOTRDC,X'00'          CLEAR DO-NOT-READ CC SWITCH      11540000
         CLI   OMEND,X'0F'             ANY MORE OLD MASTER RECORDS      11560000
         BNE   BKINSERT               YES-COMPARE SEQUENCE NO      2518 11570018
         CLI   CHNGESW,X'0E'          IS THIS A CHANGE FUNCTION    2518 11580018
         BNE   CHKADREP               NO-TREAT AS AN ADD           2518 11590018
BKINSERT TM    INSERTSW,X'0F'         BLOCK INSERTING              2518 11600018
         BC    1,BLOCKINS              YES                              11620000
         LA    GR7,SWITCHRD+1          ADDRESS OF DATA RECORD           11640000
         CLC   0(2,GR7),DOTSLASH       IS A CONTROL CARD IN SWITCHRD    11660000
         BE    NEXTDELT                YES- SCAN THE CARD               11680000
         LA    GR6,LASTCTRC            PRESENT SYSIN SEQUENCE NUMBER    11700000
         BAL   GR9,TESTSEQR            COMPARE NEW SYSIN (7) TO OLD (6) 11720000
         BNH   OUTOFSEQ                NEW ONE LOWER- OUT OF SEQUENCE   11740000
         LA    GR6,TEMPSEQ       TEMPORARY SEQUENCE BUFFER       A30939 11760019
         A     GR6,LENGTH                                          UL0H 11780017
         EX    GR1,MOVEPART            MOVE NEW SYSIN (7) TO TEMPSEQ 6  11800000
         CLI   OMEND,X'0F'             ANY MORE OM RECORDS         2518 11802018
         BNE   COMPSEQ                 NO-MOVE IN LATEST SYSIN SEQ 2518 11804018
         MVC   LASTCTRC(8),TEMPSEQ     MOVE IN LATEST SYSIN SEQ    2518 11806018
         LA    GR6,SWITCHRD+1          ADDRESS OF SYSIN RECORD     2518 11808018
         MVI   READNOOM,X'0F'          OLD MASTER HIGH-SAVE IT     2518 11810018
         CLI   INSERTSW,X'0E'          RENUMBERING FORCED?     @ZA03382 11812003
         BNE   LISTREC                 NO,INSET SYSIN RECORD?  @ZA03382 11814003
         OI    INSERTSW,X'20'          YES,SET INSERT RENUM SW @ZA03382 11816003
         B     CHKINSRT                GO TO GIVE INSERT MSG   @ZA03382 11818003
COMPSEQ  LA    GR7,OMINAREA            ADDRESS OF OLD MASTER RECORD2518 11822018
         AR    GR7,GR3                 POSITION OF SEQUENCE NUMBER OM   11840000
         LA    GR6,SWITCHRD+1          ADDRESS OF SYSIN RECORD          11860000
         AR    GR6,GR3                 POSITION OF SEQUENCE NUMBER      11880000
         CLI   INPLCSW,X'0F'           IS THIS UPDATE IN PLACE          11900000
         BE    INPLACEU                YES- CHECK IF EQUAL ONLY         11920000
         EX    GR1,COMPARES            COMPARE OM (7) TO SYSIN (6)      11940000
         BL    WRITOLD1                OLD MASTER IS LOW- WRITE IT      11960000
         LA    GR6,SWITCHRD+1          ADDRESS OF SYSIN RECORD          11980000
         MVC   LASTCTRC(8),TEMPSEQ     MOVE IN LATEST SYSIN SEQUENCE    12000000
         BE    WRITEREP                REPLACE OLD MASTER WITH SYSIN    12020000
         MVI   READNOOM,X'0F'          OLD MASTER HIGH- SAVE IT         12040000
         CLI   INSERTSW,X'0E'     RENUMBERING FORCED?          @YA02533 12045002
         BNE   LISTREC            NO,INSERT SYSIN RECORD       @YA02533 12050002
         OI    INSERTSW,X'20'     SET INSERT RENUM SW          @YA02533 12055002
         B     CHKINSRT           GO TO GIVE INSERT MSG        @YA02533 12060002
INSTDONE CLI   OMEND,X'0F'             IS OLD MASTER DONE               12080000
         BE    STOWNAME                YES- FINISH THIS MEMBER          12100000
         BAL   GR10,INSRTOVR           CHECK TO SEE IF MUST RENUMBER    12120000
WRITOLD1 CLI   INPLCSW,X'0F'           UPDATE INPLACE                   12140000
         BE    NUMBRSX                 YES CHECK IF RENUMBER SYSIN DONE 12160000
         LA    GR9,LISTREC             RETURN ADDRESS                   12180000
WRITENOW MVI   DONOTRDC,X'0F'          SET TO INHIBIT READING NEXT CT   12200000
         MVI   READNOOM,RESET0         CLEAR DO-NOT-READ OLD MASTER SW  12220000
         LA    GR6,OMINAREA            ADDRESS OF OLD MASTER RECORD     12240000
         BR    GR9                     RETURN TO LISTREC OR TESTLIST    12260000
*                                                                     * 12280000
*                UPDATE INPLACE LOGIC- REPLACEMENT RECORDS ONLY       * 12300000
*                                                                     * 12320000
INPLACEU EX    GR1,COMPARES            EXECUTE COMPARE OM TO SYSIN      12340000
         BL    NUMBRSX                 CHECK IF MUST NUMBER             12360000
         BH    INVALID            NEVER WILL GET EQUAL COMPARE @ZA07361 12380099
         LA    GR6,SWITCHRD+1          LOCATION OF SYSIN RECORD         12400000
         MVI   EQUALREC,X'0F'          FLAG AS RECORD REPLACED          12420000
         B     WRITEREP                CHECK IF COLUMN UPDATE           12440000
INVALID  LA    GR3,SWITCHRD+1     LOAD ADDRESS OF RECORD       @ZA07361 12450099
         BAL   GR14,PRINTCRD      GO AND PRINT FAILING RECORD  @ZA07361 12452099
         B     INVALOP            GIVE MSG 'INVALID OPERATION' @ZA07361 12454099
NUMBRSX  LA    GR6,OMINAREA            OLD MASTER RECORD ADDRESS        12460000
         MVI   DONOTRDC,X'0F'          DO NOT READ MORE SYSIN           12480000
         CLI   NUMBRSW,X'0F'           RECORD TO BE RENUMBERED          12500000
         BE    NUMBRCK                 YES - NUMBER IT, BUT      A28728 12510019
*                                      FIRST CHECK THE RANGE     A28728 12520019
         CLI   FLLISTSW,X'01'          LIST=ALL SPECIFIED       YA01187 12570002
         BNE   READOM                  IF NOT,READ NEXT RECORD  YA01187 12572002
         MVC   LOGOUTAR+15(80),0(GR6)  MOVE CARD TO BUFFER      YA01187 12574002
         MVI   ASISMSW,X'0F'           FORCE PRINTING           YA01187 12574402
         L     GR15,PRIMEWRT           LOAD PRINT MODULE        YA01187 12576002
         BALR  GR14,GR15               BRANCH TO PRINT ROUTINE  YA01187 12578002
         B     READOM                  NO- ON TO NEXT RECORD            12580000
PUTINPLA LH    GR1,LRECL               LOGICAL RECORD LENGTH            12600000
         L     GR7,LASTRECB            LOCATION OF BAD RECORD           12620000
         BCTR  GR1,0                   DECREMENT FOR EXECUTE            12640000
         MVI   REPLUPDT,X'0F'          FLAG AS RECORD UPDATED           12660000
         EX    GR1,LOGMOVE             MOVE SYSIN (6) TO REPLACE OM (7) 12680000
         MVI   DONOTRDC,X'0F'          DO NOT READ MORE SYSIN           12700000
         CLI   EQUALREC,X'0F'          JUST REPLACED A RECORD           12720000
         BNE   READOM                  NO- NUMBERED AN OLD ONE          12740000
         MVI   EQUALREC,RESET0         RESET RECORD REPLACED SWITCH     12760000
         B     READCT1                 READ NEXT SYSIN RECORD           12780000
WRTEREPR NOPR  GR0                     INSERT NOOP FOR ZAP REL 19       12790002
         NOPR  GR0                     INSERT CODE FOR SZAP REL 19      12792002
         NOPR  GR0                     INSERT CODE FOR SZAP REL 19      12794002
         WRITE DECBOM,SF,(GR3),(GR8),MF=E WRITE BLOCK WITH REPL  A38750 12800002
         MVI   REPLUPDT,X'00'          RESET BAD RECORD SWITCH          12820000
         CHECK DECBOM                  WAIT FOR WRITE                   12840000
         MVC   62(2,GR3),FLBLK    RE-INITIALUZE BLOCKSIZE          3628 12846015
         MVC   SHRTBLK(2),FLBLK   MAY READ FULL BLOCK NEXT         3628 12852015
         B     READSW1                 GET MORE OLD MASTER RECORDS      12860000
*                                                                     * 12880000
*               REPLACEMENT OF OLD MASTER RECORDS- PARTIAL UPDATE TEST* 12900000
*                                                                     * 12920000
WRITEREP MVI   READNOOM,RESET0         BE SURE TO READ MORE OLD MASTER  12940000
         CLI   INSERTSW,X'00'          ANY INSERT FUNCTION?    @ZA29907 12940399
         BNE   NOTYET                  NO,MARK REC REPLACEMENT @ZA29907 12941199
         CLI   RENUMALL,X'0F'          RENUMBERING?            @ZA31995 12941399
         BE    NOTYET                  YES,FLAG REC REPLACED   @ZA31995 12941599
         LR    GR7,GR6                 ADDR OF SYSIN RECORD    @ZA29907 12941999
         LR    GR15,GR6                SAVE THAT ADDRESS       @ZA29907 12942799
         LA    GR6,NUMRSEQ2            UPPER LIMIT NUMBERING   @ZA29907 12943599
         BAL   GR9,TESTSEQR            TEST IF BEYOND RANGE    @ZA29907 12944399
         LR    GR6,GR15                RESTORE REGISTER        @ZA29907 12945199
         BNH   NOTYET                  NOT UPPER LIMIT YET     @ZA29907 12945999
         NI    SEQ1SW,X'0F'            RESET SEQ1 SATISFIED SW @ZA29907 12946799
         MVI   NUMBRSW,RESET0          RESET NUMBER SW         @ZA29907 12947599
NOTYET   EQU   *                                               @ZA29907 12948399
         MVC   LOGOUTAR+95(25),REPLMSG  MOVE IN REPLACE MESSAGE YA01187 12950002
         MVC   LOGOUTAR+15(80),OMINAREA  MOVE CARD              YA01187 12950402
         OI    REPSW,X'0E'        SET REPLACED RECORD LISTED   @ZA01683 12950802
         MVI   ASISMSW,X'0F'           SET PRINT SWITCH         YA01187 12951702
         L     GR15,PRIMEWRT           LOAD PRINT MODULE        YA01187 12951802
         BALR  GR14,GR15               BRANCH TO PRINT MODULE   YA01187 12951902
         MVC   LOGOUTAR+95(25),REPMES   GIVE REPLACEMENT MESS   YA01187 12953902
         CLI   INSERTSW,X'0E'     RENUMBERING FORCED?          @YA02533 12954302
         BE    MOVENEW            YES,BRANCH TO MOVE NEW CARD  @YA02533 12957302
         CLI   NUMBRSW,X'0F'      IS NUMBERING TO BE DONE?     @YA01723 12960302
         BE    NEWSEQ             YES,GO TO INSERT NEW NUMBER  @YA01723 12964002
         MVC   OLDOMSEQ(8),0(GR7)  SEQ OF REC TO BE WRITTEN    @ZA29830 12967099
MOVENEW  MVC   LOGOUTAR+15(80),SWITCHRD+1 MOVE SYSIN CARD      @YA02533 12970002
         MVI   ASISMSW,X'0F'            SET PRINT SWITCH        YA01187 12976002
         L     GR15,PRIMEWRT           LOAD PRINT MODULE        YA01187 12980002
         BALR  GR14,GR15               BRANCH TO PRINT MODULE   YA01187 12983002
         MVI   REPSW,X'0F'             SET SWITCH REPLACED REC  YA01187 12986002
NEWSEQ   CLI   COLUMNSW,X'0F'          SELECTIVE COLUMN UPDATE @YA01723 12992002
         BNE   LISTREC                 NO- REPLACE ENTIRE CARD          12994002
         CLC   UPDATCOL(2),ZERO        CHECK FOR TOTAL CHANGE      3511 13000002
         BE    LISTREC                 REPLACE ENTIRE CARD         3511 13005002
         MVI   REPSW,X'FF'             SET SWITCH UPDATED RECORDYA01187 13010002
         LH    GR1,UPDATCOL            AMOUNT OF CARD NOT CHANGED       13015002
         BCTR  GR1,0                   DECREMENT FOR EXECUTE            13020000
         LA    GR7,OMINAREA            IMAGE OF OLD MASTER RECORD       13040000
         EX    GR1,MOVEPART            MOVE UNCHANGED PART TO SWITCHRD  13060000
         B     LISTREC                 WRITE OUT PARTIALLY UPDATED REC  13080000
*                                                                     * 13100000
*        GENERAL SEQUENCE CHECKING ROUTINES FOR DELETE AND NUMBER     * 13120000
*  COMPARE EXECUTED FOR RECORD ADDRESSED BY GR7 AND SEQUENCE NUMBER   * 13140000
*  BUFFER ADDRESSED BY GR6. RETURN THEN GIVEN RELATIVE TO GR9 FOR TEST* 13160000
*  OF CONDITION CODE SET BY COMPARE.                                  * 13180000
*                                                                     * 13200000
DELETCK  LA    GR6,DELTSEQ1            STARTING SEQUENCE NUMBER DELET   13220000
         LA    GR7,OMINAREA            ADDRESS OF OLD MASTER RECORD     13240000
         LA    GR9,SEQ1SET             RETURN FROM ROUTINE              13260000
         CLI   OMEND,X'0F'             IS OLD MASTER THROUGH            13280000
         BE    BADDELET                YES- ERROR- DELETE NOT DONE      13300000
TESTSEQR ST    GR10,TEMP10                                         UL0H 13310017
         LA    GR10,8                                              UL0H 13320017
         LH    GR3,IDENTXX             SEQUENCE START COLUMN            13340000
         LH    GR1,IDENTY              SEQUENCE SIZE                    13360000
         SR    GR10,GR1                                            UL0H 13380017
         AR    GR6,GR10                                            UL0H 13400017
         AR    GR7,GR3                 START OF SEQUENCE NUMBER OM      13420000
         BCTR  GR1,0                   DECREMENT FOR EXECUTE            13440000
         EX    GR1,COMPARES            COMPARE SEQUENCE NUMBERS         13460000
         ST    GR10,LENGTH                                         UL0H 13466017
         L     GR10,TEMP10                                         UL0H 13472017
         BR    GR9                     RETURN FROM COMPARE ROUTINE      13480000
SEQ1SET  BE    NUMERON            DELETE THIS RECORD             A32024 13490020
         BH    SEQ2SET            TEST FOR DELETE RANGE          A32024 13500020
         LA    GR6,LASTCTRC       ADDRESS LAST CT/OM NUMBER      A32024 13510020
         A     GR6,LENGTH         JUSTIFY FOR LENGTH             A32024 13520020
         EX    GR1,MOVEPART       GET LAST OLD MSTR NUMBER IN IT A32024 13530020
         B     WRITOLD1           RETURN WITHOUT DELETE          A32024 13540020
SEQ2SET  TM    SEQ1SW,X'0F'       WAS SEQ1 SATISFIED             A32024 13550020
         BC    12,BADDELET             NO- RANGE INVALID                13560000
         LA    GR7,OMINAREA            OLD MASTER RECORD                13580000
         LA    GR6,DELTSEQ2            ENDING SEQUENCE NUMBER DELET     13600000
         BAL   GR9,TESTSEQR            COMPARE SEQUENCE NUMBERS         13620000
         BL    GETNEXT1                DELETE STATEMENT- WITHIN RANGE   13640000
         BH    BADDELET                END OF DELETE- RANGE INVALID     13660000
ANYSECND NI    SEQ1SW,X'F0'            RESET SEQ1 SATISFIED- DELETE     13680000
         CLI   DELET2SW,X'0F'          CONSECUTIVE DELETE STATEMENTS    13700000
         MVI   DELETSW,RESET0          RESET DELETE SWITCH              13720000
         BNE   GETNEXT1                DELETE LAST RECORD               13740000
         MVI   READNOOM,X'00'  MAKE SURE 1ST DELETE IS EFFECTIVE 12737  13750015
         MVC   LOGOUTAR+95(25),DELETMSG SET DELETE MSG         @YA02554 13752002
         MVC   LOGOUTAR+15(80),OMINAREA MOVE CARD              @YA02554 13754002
         MVI   ASISMSW,X'0F'      SET PRINT SW                 @YA02554 13756002
         L     GR15,PRIMEWRT      LOAD PRINT MODULE            @YA02554 13758002
         BALR  GR14,GR15          GO TO PRINT MODULE           @YA02554 13758402
         MVI   DELET2SW,RESET0         RESET DELETE PENDING SWITCH      13760000
NEXTDELT MVI   SWITCHRD,RESET0         CLEAR CARD SCAN SWITCHES         13780000
         CLI   NUMBR2SW,X'0F'          NUMBER CARD PENDING              13800000
         BE    PARTNUMB                YES- CHECK SEQUENCE NUMBER       13820000
         MVI   DONOTRDC,X'00'          READ NEXT CONTROL CARD           13840000
         MVI   PARAMSW,RESET0          RESET PARAMETER FOLLOWS SWITCH   13860000
         L     GR15,SCANENTR           ENTRY POINT OF SCAN ROUTINE      13880000
         BR    GR15                    ENTER SCAN ROUTINE               13900000
NUMERON  OI    SEQ1SW,X'0F'            SET SEQ1 SATISFIED- DELETE       13920000
         CLI   NUMBRSW,X'0F'           NUMBERING TO BE DONE             13940000
         BNE   CHK1AND2                CHECK IF SEQ1 EQUALS SEQ2        13960000
         LA    GR7,OMINAREA            ADDRESS OF OLD MASTER RECORD     13980000
         LA    GR6,NUMRSEQ1            NUMBER SEQUENCE 1                14000000
         BAL   GR9,TESTSEQR            DELETE CARD START NUMBER RANGE   14020000
         BE    INVALOP                 CANNOT DELETE START OF NUMBER    14040000
CHK1AND2 CLC   DELTSEQ1(8),DELTSEQ2    DOES SEQ1 EQUAL SEQ2             14060000
         BE    ANYSECND                YES DELETE DONE                  14080000
GETNEXT1 MVI   READNOOM,RESET0         ALLOW READ OF OLD MASTER         14100000
         MVC   LOGOUTAR+95(25),DELETMSG SET DELETE MESSAGE      YA01187 14110002
         MVC   LOGOUTAR+15(80),OMINAREA  MOVE CARD              YA01187 14112002
         MVI   ASISMSW,X'0F'              PRINT SWITCH          YA01187 14114002
         L     GR15,PRIMEWRT             LOAD PRINT MODULE      YA01187 14116002
         BALR  GR14,GR15               GO TO PRINT MODULE       YA01187 14118002
         B     READOM                  FINISH DELETE- THEN INSERT       14120000
PARTNUMB MVI   DONOTRDC,X'0F'          READ NO MORE SYSIN               14140000
         LA    GR6,OMINAREA            OLD MASTER RECORD                14160000
*                                                                     * 14180000
*    CHECKS FOR TOTAL RENUMBERING, BLOCK INSERTING, OR SPECIFIC       * 14200000
*  RENUMBERING.  UPON ENTRY, GR6 POINTS TO START OF RECORD.           * 14220000
*                                                                     * 14240000
NUMBRCK  CLI   RENUMALL,X'0F'          TOTAL RENUMBERING                14260000
         BE    NUMBRCD                 YES                              14280000
         CLI   OMEND,X'0F'             OLD MASTER FINISHED              14300000
         BE    CHECKNM                 YES- CHECK NUMBER RANGE          14320000
         TM    INSERTSW,X'0F'          INSERT                           14340000
         BC    1,BLOCKINS              YES- FIRST LEVEL '0F'            14360000
         BC    4,NUMBRCD               RENUMBER FORCED BY EARLY INSERT  14380000
         B     ENTNUMB                 CHECK NUMBER RANGE               14400000
BLOCKINS LA    GR7,OMINAREA            BLOCK INSERT OR ONLY OM LEFT     14420000
         LA    GR6,NUMRSEQ1            STARTING NUMBER                  14440000
         CLI   OMEND,X'0F'             END OF FILE ON OM YET?    A24812 14446018
         BE    CHKSEQ1            YES,DON'T TEST SAME SEQ AGAIN  A24812 14452018
         BAL   GR9,TESTSEQR            TEST RANGE                       14460000
         BL    CHKWRTOM                WRITE OLD MASTER                 14480000
         BE    STARTIN                  BRANCH                 @ZA01657 14490002
CHKSEQ1  TM    SEQ1SW,X'F0'            SEQ1 SATISFIED?           A24812 14520018
         BC    14,BADNUMBR             NO- NUMBER RANGE UNSATISFIED     14540000
         TM    INSERTSW,X'0F'          INSERTING RECORDS                14560000
         BC    1,SETINSRT              RESET INSERT SWITCH              14580000
         LA    GR6,NUMRSEQ2            TOP OF NUMBER RANGE              14600000
         LA    GR7,OMINAREA            ADDRESS OF OLD MASTER RECORD     14620000
         BAL   GR9,TESTSEQR            TEST IF OM OUT OF NUMBER RANGE   14640000
         BH    RESETGET                YES- THROUGH WITH NUMBERING      14660000
RENUMSOM LA    GR6,OMINAREA            ADDRESS OF OLD MASTER RECORD     14680000
         MVI   READNOOM,RESET0         ALLOW READING OF OLD MASTER      14700000
         MVI   DONOTRDC,X'0F'          READ NO MORE SYSIN               14720000
         B     NUMBRCD                 RENUMBER CARD                    14740000
RESETGET LA    GR10,WRITEOM            RETURN FROM RESETTING SWITCHES   14760000
         B     RESETNMB                RESET SWITCHES                   14780000
CHECKNM  CLI   INPLCSW,X'0F'           IS THIS UPDATE IN PLACE          14800000
         BE    CHKALIAS                YES- FINISH UPDATE INPLACE       14820000
         LA    GR7,SWITCHRD+1          DATA CARD BUFFER ADDRESS         14840000
         CLC   0(2,GR7),DOTSLASH       A CONTROL CARD IN BUFFER         14860000
         BE    RET2SCAN           YES,SCAN THE CARD             YA01677 14870002
         LA    GR6,NUMRSEQ1            STARTING NUMBER LOWER LIMIT      14900000
         BAL   GR9,TESTSEQR            TEST NUMBER RANGE                14920000
         LA    GR6,SWITCHRD+1          ADDRESS OF RECORD                14940000
         BNL   NUMBRCD                 NUMBER CARD                      14960000
BADNUMBR LA    GR11,NUMMSG             INVALID NUMBER RANGE             14980000
         B     GIVENGO                 GIVE MESSAGE AND CONTINUE        15000000
*                                                                     * 15020000
*   CHECK NUMBER RANGE AGAINST RECORD READY TO BE WRITTEN             * 15040000
*              SPECIFIC RENUMBERING ROUTINE                           * 15060000
*                                                                     * 15080000
ENTNUMB  LR    GR7,GR6                 REGISTER 6 POINTS TO RECORD      15100000
         LR    GR10,GR6                SAVE POINTER IN STABLE REGISTER  15120000
         LA    GR6,NUMRSEQ1            STARTING SEQUENCE NUMBER         15140000
         BAL   GR9,TESTSEQR            CHECK LOWER NUMBER RANGE         15160000
         BL    WRITEOM                 LOW- WRITE OLD MASTER            15180000
         BE    SETNUM1                 SET SEQ1 SATISFIED SWITCH        15200000
         TM    SEQ1SW,X'F0'            SEQ1 SATISFIED- NUMBER           15220000
         BC    14,BADNUMBR             NO- INVALID NUMBER RANGE         15240000
         LA    GR6,NUMRSEQ2            LOAD UPPER NUMBER LIMIT          15260000
         LR    GR7,GR10                LOAD POINTER TO RECORD           15280000
         BAL   GR9,TESTSEQR            TEST IF BEYOND NUMBER RANGE      15300000
         BH    OVERSEQ2                YES,GO AND RESET SEQ1   @ZA29832 15320099
         CLI   NUMBR2SW,X'0F'          CONSECUTIVE NUMBER CARD @ZA29832 15326099
         BE    SETNUM1                 YES,RESET READNOOM SW   @ZA29832 15332099
         B     NUMBRIT                 RENUMBER RECORD         @ZA29907 15338099
OVERSEQ2 NI    SEQ1SW,X'0F'            RESET SEQ1 SATISFIED    @ZA29832 15344099
         CLI   NUMBR2SW,X'0F'          CONSECUTIVE NUMBER CARDS         15360000
         MVI   NUMBRSW,RESET0          RESET NUMBER SWITCH              15380000
         BNE   WRITEOM                 WRITE RECORD- NO MORE NUMBERING  15400000
         MVI   NUMBR2SW,RESET0         CLEAR NUMBER PENDING SWITCH      15420000
         MVI   READNOOM,X'0F'          SAVE OLD MASTER RECORD           15440000
         B     NEXTDELT                SCAN THE NUMBER CARD             15460000
STARTIN  OI    SEQ1SW,X'F0'            SEQ1 SATISFIED- NUMBER           15480000
CHKWRTOM TM    INSERTSW,X'10'          DOING BLOCK INSERT OR RENUMBER   15500000
         BC    1,RENUMSOM              YES- RENUMBER RECORD             15520000
WRITEOM  LA    GR9,TESTLIST            RETURN FROM WRITENOW    @ZA29907 15540099
         CLI   INSERTSW,X'0F'          INSERT OPERATION?       @ZA32389 15541099
         BE    WRITENOW                YES,GO AND WRITE RECORD @ZA32389 15542099
         CLI   READNOOM,X'0F'          SHOULD WE READ FROM OM? @ZA29832 15543099
         LA    GR6,SWITCHRD+1          ADDR OF SYSIN RECORD    @ZA29832 15546099
         BE    TESTLIST                NO,DON'T READ FROM OM   @ZA29832 15549099
         B     WRITENOW                WRITE OLD MASTER RECORD AS IS    15560000
NONBLNKI LA    GR10,CHNGCOMD           NOT ./ NEXT RECORD NON-BLANK SEQ 15580000
         LA    GR7,OMINAREA(GR3)  GET OLD MASTER RECORD NUMBER   A35458 15585020
         EX    GR1,COMPARES       NEXT OM REC LOW OR EQ AS SYSIN A35458 15590020
         BNH   INSRTOVR                DATA SEQ AFTER INSERT OK  A44323 15595021
         LA    GR3,SWITCHRD+1          LOAD SYSIN IN BUFFER      A44323 15597021
         BAL   GR14,PRINTCRD           PRINT CARD WITH INVAL.SEQ A44323 15599021
         B     INVALOP                 PRINT INVALOP MESSAGE     A44323 15599421
INSRTOVR MVI   INSRTRD,RESET0          RESET INSERT READ SWITCH         15600000
         NI    SEQ1SW,X'0F'       RESET INSERT SWITCH            A35458 15605020
         MVI   FSTINSRT,X'00'     RESET FOR NEXT BLOCK INSERT    A25432 15610019
         LA    GR7,OMINAREA            NEXT SEQUENCE NUMBER OLD MASTER  15620000
         LA    GR6,LASTSEQN            SEQ NUMBER OF LAST INSERT RECORD 15640000
         BAL   GR9,TESTSEQR            TEST IF OM GREATER THAN INSERT   15660000
         BH    NOMORENB                NO PROBLEM- OM IS HIGH           15680000
         MVI   INSERTSW,X'0E'          MUST RENUMBER DATA SET           15700000
         BR    GR10                    RETURN- RESCANIT IF ./, CHNGCOMD 15720000
INSRTANY LH    GR3,IDENTXX             SEQUENCE COLUMN                  15740000
         AR    GR6,GR3                 POSITION OF SEQUENCE NUMBER CT   15760000
         AR    GR7,GR3                 POSITION OF SEQUENCE NUMBER OM   15780000
         LR    GR8,GR6                 POINTER TO CT SEQUENCE FIELD     15800000
         LH    GR1,IDENTY              SEQUENCE SIZE                    15820000
         BCTR  GR1,0                   DECREMENT FOR EXECUTE            15840000
         EX    GR1,CHKSEQNB            TEST FOR BLANK SEQUENCE NUMBER   15860000
         BE    OKIFINST                YES- OK IF INSERT OPTION         15880000
STOPINST TM    INSERTSW,X'0F'         INSERT NON-BLANK SEQ NUM @ZA07377 15900099
         BC    1,NONBLNKI              YES- BLOCK INSERT DONE           15920000
         CLI   READNOOM,X'0F'          WAS OM RECORD READ               15940000
         BNE   COMPARS                 YES- CONTINUE                    15960000
         MVI   READNOOM,RESET0         RESET SWITCH TO ALLOW OM READ    15980000
         B     READOM                  READ OLD MASTER                  16000000
RESETNS  LR    GR6,GR10                RESTORE POINTER TO CARD          16020000
         TM    INSERTSW,X'10'          UP TO NEXT BLOCK INSERT CARD     16040000
         LA    GR10,TESTLIST           RETURN FROM THIS ROUTINE         16060000
         BC    1,RESET1F               UP TO NEXT BLOCK INSERT CARD     16080000
NOMORENB MVI   INSERTSW,RESET0         RESET INSERT SWITCH              16100000
RESETNMB MVI   NUMBRSW,RESET0          RESET NUMBER SWITCH              16120000
         BR    GR10                    RETURN- RESCANIT IF ./, CHNGCOMD 16160000
RESET1F  MVI   INSERTSW,X'0F'          RESET TO NO LONGER FORCE RENUMBR 16180000
         MVC   SEQWA(4),TEMPSEQA       SET UP NEW1 FOR NEXT BLOCK INSRT 16200000
         MVC   NEW1NUMB(L8),NEW1TEMP                            YM07522 16202002
         MVC   INCREMWA(8),TEMPINCR    SET UP INCR FOR NEXT BLOCK INSRT 16220000
         BR    GR10                    RETURN                    A41743 16240000
COMPARS  EX    GR1,COMPARES            COMPARE SEQUENCE NUMBER          16260000
         BNH   RENINSNW                OLD MASTER IS EQUAL OR LOW       16280000
STOPRD   MVI   READNOOM,X'0F'          OLD MASTER HIGH- SAVE IT         16300000
RENINSNW LA    GR6,SWITCHRD+1          ADDRESS OF NEW RECORD            16320000
         MVI   DONOTRDC,RESET0         RESET TO READ NEXT SYSIN RECORD  16340000
         B     NUMBRCD                 RENUMBER AND INSERT IT           16360000
OKIFINST TM    INSERTSW,X'0F'          TEST IF INSERT OPTION            16380000
         BC    14,INVALOP              NO- WILL NOT ACCEPT BLANK SEQ    16400000
         B     STOPRD                  NUMBER AND INSERT CARD           16420000
SETINSRT MVI   INSERTSW,X'0F'          BE SURE SET FROM '1F' TO '0F'    16440000
         B     STOPRD                                            12737  16460015
*                                                                     * 16480000
*    DETERMINE IF TERMINATE (PS) OR FLUSH TO NEXT MEMBER-  QUIT IF PS   16500000
*                                                                     * 16520000
CHKIFEND TM    EODCTSW,X'0E'           END OF SYSIN              A45153 16540000
         BO    RESTORE            YES-STOP NOW-DO NOT STOW     @ZA06529 16560099
FLUSHALL CLI   INPLCSW,X'0F'           UPDATE INPLACE WAS ATTEMPTED     16580000
         MVI   TEMPCON,X'04'           SET CONDITION CODE               16600000
         BE    STOPNOW                 UPDATE INPLACE- QUIT             16620000
         CLI   STARTMEM,X'0F'          MEMBER UPDATE STARTED            16640000
         L     GR11,DCBNM              ADDRESS OF NEW MASTER DCB        16660000
         BNE   NONEUSED                NO SPACE USED BY BAD MEMBER      16680000
         MVC   BFDAD(8,GR11),FDADSET   RESTORE TO START OF AREA         16700000
         MVC   TRBAL(2,GR11),TRKBAL   RESTORE PREVIOUS TRACK BAL   5666 16710016
NONEUSED TM    RIDIT2SW,X'0F'          TEST IF DELETE/NUMBER OR COMMAND 16720000
         BC    1,DETAILGO              DELET/NUMBER SCAN BEYOND         16740000
         BC    4,ENDFLUSH              NEXT COMMAND STATEMENT           16760000
         CLI   ENDONLY,X'0F'           FLUSHING FOR ENDUP ONLY     4929 16806017
         BE    READCC                  YES-PRINT NO MSG-CONTINUE   4929 16812017
         CLI   FIRSENTR,BIT10          FIRST ENTRY CARD OUT OF SEQUENCE 16820000
         BE    SCANOUT                 YES- NOTHING ANALYSED YET        16840000
         LA    GR3,SCANOUT             SEE IF PROCESS ANOTHER MEMBER    16860000
GOONTEST CLI   PSSWNM,X'0F'         IS NEW MASTER PARTITIONED    A30480 16880021
         BNE   FINERRA2           NO.. QUIT                      A30480 16900020
         CLI   PSSWOM,X'0F'       IS OLD MASTER PARTITIONED ?    A30480 16920020
         BCR   8,GR3              YES.. RETURN                   A30480 16940020
         CLI   CTONLYSW,X'01'           PARM=NEW SPECIFIED       A41756 16946021
         BCR   8,GR3                    YES,RETURN               A41756 16952021
         OI    CTONLYSW,X'10'     BYPASS OLD MASTER              A30480 16960020
         BR    GR3                RETURN                         A30480 16980020
ENDFLUSH MVI   RIDIT2SW,RESET0         CLEAR COMMAND STATEMENT SWITCH   17040000
         MVI   FIRSENTR,RESET0    CLEAR FIRST ENTER SWITCH         4718 17050017
         MVI   FLUSHSW,X'0E'           SET FOR COMMAND AFTER FLUSH      17060000
         B     READCC                  CONTINUE- REWRITE OVER BAD ONE   17080000
SCANOUT  LA    GR11,FLUSHING           FLUSH MESSAGE CODE               17100000
         L     GR15,PRIMEWRT           ADDRESS OF LOG ROUTINE           17120000
         BALR  GR14,GR15               GIVE MESSAGE                     17140000
         L     GR11,DCBNM           ADDRESS OF NEW MASTER DCB  @ZA04434 17150003
         MVI   FLUSHSW,X'0F'           SCANNING FOR NEXT COMD SWITCH    17160000
         CLI   ALIASW2,X'0F'      SEVERAL ALIAS STMT?          @ZA01682 17164002
         BNE   TESTLOC            NO,UP TO NEXT MEMBER         @ZA01682 17168002
         MVI   COMDCD2,RESET0     RESET COMMAND PENDING SW     @ZA01682 17172002
*                                                                     * 17180000
*        REINITIALIZE TO RECYCLE FOR UPDATE OF NEXT MEMBER.           * 17200000
*                                                                     * 17220000
TESTLOC  CLI   EXTNTSW,X'0F'                                     A29047 17223019
         BNE   NOCROSS                                           A29047 17226019
         L     GR3,DCBOM                                         A29047 17229019
         L     GR6,DCBNM                                         A29047 17232019
         CLC   5(1,GR3),5(GR6)                                   A29047 17235019
         BE    NOCROSS                                           A29047 17238019
         CLOSE ((GR3))                                           A29047 17241019
         OPEN  ((GR3))                                           A29047 17244019
         TM    BOFLGS(GR3),X'10'                                 A29047 17247019
         BZ    BADOPEN                                           A29047 17250019
NOCROSS  ST    GR6,SAVEGR6             SAVE REGISTER 6           A45212 17252021
         LA    GR6,CONTCLER                                      A45212 17253021
         XC    DELTSEQ1(32),DELTSEQ1   CLEAR DELETE AND NUMBER SEQ      17260000
         MVC   OMREADT(4),OMREADP      REINITIALIZE OM FOR NEXT PASS    17280000
         MVC   NMWRITET(4),NMWRITEP    REINITIALIZE NM FOR NEXT PASS    17300000
         MVC   FDADSET(8),BFDAD(GR11)  SAVE FDAD FOR NEW MEMBER    5666 17306016
         MVC   TRKBAL(2),TRBAL(GR11)  SAVE TRACK BALANCE           5666 17312016
         MVC   OMBLOCKT(2),OMBLOCKP    RESTORE BLOCKING FACTOR OM       17320000
         MVC   NMBLOCKT(2),NMBLOCKP    RESTORE BLOCKING FACTOR NM       17340000
         XC    LISTAREA(80),LISTAREA   CLEAR LIST BUFFER                17360000
         MVC   IDENTXX(4),INITSEQ      REINITIALIZE SEQUENCE CONSTANTS  17380000
         XC    IDENTNN(L4),IDENTNN                              YM07522 17380402
         XC    OLDOMSEQ(8),OLDOMSEQ                              A24812 17381018
         MVI   MULTI,X'0F'        TURN ON SWITCH FOR NEXT PASS   A30625 17391020
         TM    COMDCD2,X'0F'      ALREADY TO NEXT COMMAND      @ZA01690 17401002
         MVI   SOURCECD,X'FF'          REINITIALIZE SOURCE CODE BUFFER  17420000
         MVI   LEVELXX,C'0'            REINITIALIZE LEVEL BUFFER        17440000
         MVC   MEMNAME(8),BLANKS8      CLEAR MEMBER NAME BUFFER         17460000
         MVI   BLDFNDSW,X'0F'          DO A BLDL FOR THE NEXT MEM  2163 17470018
         MVI   OMEODX+1,X'00'           MARK OM EMPTY FOR NEXT   A36095 17472021
         BO    UPDAINPL             YES-SEE IF UPDATE INPLACE  @ZA01692 17480002
         EX    GR6,COMDCLER            CLEAR CONTROL CARD SWITCHES      17500000
         L     GR6,SAVEGR6              RESTORE REGISTER 6       A45212 17510021
         B     READCC                  GET NEXT STATEMENT               17520000
STOPNOW  BAL   GR14,DEACTV             DEACTIVATE EXITS          A32631 17530020
         MVI   COMDCD,X'00'             RESET COMMAND SW         PTM004 17540017
         MVI   FLUSHSW,X'0F'            TURN ON FLUSH SW         PTM004 17550017
         B     READCC                   GET NEXT STATEMENT       PTM004 17560017
DETAILGO MVI   RIDIT2SW,X'00'          RESET FLUSH DELETE/NUMBER SWITCH 17580000
         B     READCC                  KEEP FLUS&ING               4929 17630017
UPDAINPL CLI   INPLCSW,X'0F'      UPDATE INPLACE JUST DONE     @ZA01692 17640002
         BNE   MINFLUSH           NO-GO TO SCAN NEXT           @ZA01692 17650002
         LA    GR11,UPDATMSG      INVALID UPDATE INPLACE MSG   @ZA01692 17660002
         LA    GR14,FINERRA       RETURN ADDR AFTER STMT PRINT @ZA01692 17670002
         MVC   LOGOUTAR+7(80),SWITCHRD+1  MOVE INVALID STMT    @ZA01692 17672002
         MVI   ASISMSW,X'0F'      FORCE PRINTING               @ZA01692 17674002
         L     GR15,PRIMEWRT      ADDR OF PRINT ROUTINE        @ZA01692 17676002
         BR    GR15               GO TO PRINT ROUTINE          @ZA01692 17678002
MINFLUSH EX    GR6,COMDCLER            CLEAR CONTROL CARD SWITCHES      17680000
         MVI   FIRSENTR,X'0F'          NEW MEMBER IS COMING             17700000
RESCANIT MVI   SWITCHRD,RESET0         CLEAR SCAN SWITCHES              17720000
         XC    PARAMSW(27),PARAMSW     CLEAR SWITCHES                   17740000
CHKPS    CLI   FLUSHSW,X'0F'           FLUSHING TO NEXT COMMAND    4929 17741017
         BNE   RET2SCAN                NO-BRANCH                   4929 17742017
         CLI   FIRSENTR,BIT10                                    A32050 17742320
         BE    RET2SCAN                                          A32050 17742620
         CLI   INPLCSW,X'0F'           UPDATE INPLACE              4929 17743017
         BE    FLSHPSUP                YES-BRANCH                  4929 17744017
         TM    CTONLYSW,X'11'     ALL INPUT FROM SYSIN           A30480 17745020
         BZ    CHKOMPS            NO.. CHECK DSORG OLD MASTER    A30480 17746020
         CLI   PSSWNM,X'0F'            NM SEQUENTIAL               4929 17747017
         BE    RET2SCAN                NO-PARTITIONED              4929 17748017
         B     FLSHPSUP                SEQUENTIAL                  4929 17749017
CHKOMPS  CLI   PSSWOM,X'0F'            OM SEQUENTIAL               4929 17750017
         BE    RET2SCAN                NO-PARTITIONED              4929 17751017
FLSHPSUP MVI   ENDONLY,X'0F'           ONLY ENDUP ACCEPTED         4929 17752017
RET2SCAN TM    PARAMSW,BIT10      IS PARIAL PARAMETER SW ON?    YA01700 17754002
         BC    1,RETBSCAN         YES,RETURN TO BSCAN           YA01700 17756002
         L     GR15,SCANENTR      LOAD ADDRESS OF ASCAN CSECT   YA01700 17760002
         BR    GR15               BRANCH TO ASCAN               YA01700 17780002
RETBSCAN L     GR13,SAVEPT13      LOAD ADDRESS OF SAVE AREA     YA01700 17782002
         LM    GR14,GR12,12(GR13) PICK UP SAVED REGISTERS       YA01700 17784002
         BR    GR7                BRANCH TO BSCAN               YA01700 17786002
*                                                                     * 17800000
*                              END OF FILE ON SYSIN                   * 17820000
*  REAL EOF, /* READ, OR ENDUP STATEMENT RECOGNIZED BY SCAN ROUTINE   * 17840000
*                                                                     * 17860000
EODCTX   CLI   FIRSENTR,BIT10          ANY RECORDS IN SYSIN             17880000
         MVI   EODCTSW,X'0E'           SET SWITCH FOR FURTHER PR A45153 17890000
         BE    NODATAS                 NO- SYSIN HAS NO RECORDS- ERROR  17920000
         TM    CHNGESW,X'0F'           ONLY CHANGE CARD IN SYSIN A45153 17930000
         BO    INVALOP                 NO DATA OR FUNCTION STM   A45153 17932000
         TM    ADDSW,X'0F'             STMT'S AFTER ADD STMT?  @ZA24936 17934099
         BO    NODATAS                 YES,GIVE MSG IEB823I    @ZA24936 17936099
         CLI   INSERTSW,X'0F'     SHOULD INSERT REC'S?         @ZA28408 17936899
         BNE   ENDUPCC            NO,TEST IF DURING FLUSH      @ZA28408 17937699
         CLI   FSTINSRT,X'00'     NO REC'S IN AN INSERT OP.?   @ZA28408 17938499
         BE    INVALOP            YES,GIVE MSG IEB807I         @ZA28408 17939299
ENDUPCC  CLI   FLUSHSW,X'0F'           EOF DURING FLUSH                 17940000
         BE    LASTLEG            YES-STOP NOW-DO NOT STOW       PTM223 17960017
         CLI   CCSCANSW,BIT01          EOF READING CONTINUATION CARD    17980000
         BE    INVALOP                 YES- INVALID REST OF CARD GONE   18000000
REALEOF  CLI   INSRTRD,X'0F'           INSERT ISSUED READ               18060000
         MVI   FINICCS,X'0F'           FLAG AS SYSIN THROUGH            18080000
         BE    WRTINSRT                YES- RETURN TO PROCESS LAST ONE  18100000
         TM    CHNGESW,X'0E'      CHANGE FUNCTION                  1550 18120014
         BC    7,CONTINY          YES-CONTINUE                     1550 18140014
         CLI   INPLCSW,X'0F'      UPDATE INPLACE                   1550 18160014
         BE    RENUMTST                IF SO, CHECK FOR RENUMBERINGUL0H 18180017
         TM    REPROSW,X'0E'           REPRO FUNCTION                   18200000
         BC    8,STOWNAME              NO- ADD OR REPLACE SO FINISH UP  18220000
CONTINY  MVI   DONOTRDC,X'0F'          READ NO MORE SYSIN IS DONE       18240000
         CLI   OMEND,X'0F'             IS OLD MASTER DONE               18260000
         BE    STOWNAME                YES- FINISH UP                   18280000
         CLI   READNOOM,X'0F'          HAVE AN OM RECORD HANDY          18300000
         BNE   PROCEED                 NO- OPEN DATA SET IF NECESSARY   18320000
         MVI   READNOOM,RESET0         CLEAR OM PENDING SWITCH          18340000
         LA    GR6,OMINAREA            LOCATION OF OLD MASTER RECORD    18360000
         B     TESTRCD                 TEST OM RCD FOR DELETION    5944 18380017
RENUMTST CLI   NUMBRSW,X'0F'           IS RENUMBERING REQUESTED    UL0H 18383017
         BE    READOM      '           IF SO, THEN PROCEED         UL0H 18386017
         CLI   OPENSW,X'00'            I HAVE DATA SETS BEEN OPENEDUL0H 18389017
         BE    READOM                  IF SO  THEN PROCEED UPDATINGUL0H 18392017
         B     NODATAS                 IF NOT, NO SYSIN INPUT      UL0H 18395017
NODATAS  LA    GR7,SYSINNM             ADDRESS OF SYSIN DD NAME         18400000
         LA    GR3,CLOSEUP        ADDRESS OF CLOSE SYSIN       @YA02568 18420002
         MVI   HICONCDE+1,X'0C'        SET CONDITION CODE       YA01186 18430002
NODATA   LA    GR11,ERRMSGN            CODE FOR BLANK DATA MESSAGE      18440000
         L     GR15,PRIMEWRT           ADDRESS OF MESSAGE CSECT         18460000
         BALR  GR14,GR15               GIVE MESSAGE                     18500000
         BR    GR3                     ENTER FLUSH OR ALMOSTZ ROUTINE   18520000
*                                                                     * 18540000
*          END OF FILE ENCOUNTERED ON OLD MASTER DATA SET             * 18560000
*  STOP IF 'REPRO' OR UPDATE INPLACE- OTHERWISE CONTINUE TILL SYSIN   * 18580000
*   DONE OR NEXT FUNCTION ENCOUNTERED.                                * 18600000
*                                                                     * 18620000
OMEODX   BC    0,NOTEMPTY              TAKE BRANCH IF NOT EMPTY  A36095 18640021
         LA    GR7,SYSUT1NM            ADDRESS OF SYSUT1 DD NAME        18660000
         LA    GR3,FLUSHALL            ERROR ROUTINE IF SYSUT1 NULL     18680000
         MVI   HICONCDE+1,X'04'        SET CONDITION CODE       YA01186 18690002
         B     NODATA                  PRINT OM EMPTY MESS       A36095 18700021
NOTEMPTY EQU   *                                                 A36095 18710021
         TM    FINICCS,X'0F'           SEE IF ANY CONTROL CARDS LEFT    18720000
         BC    1,STOWNAME              NO- FINISH                       18740000
         TM    COMDCD2,X'0F'           UP TO NEXT COMMAND CARD @ZA01690 18760002
         BO    STOWNAME                YES- END THIS DS MEMBER @ZA01690 18780002
         TM    REPROSW,X'0E'           REPRODUCING DATA SET             18800000
         BC    1,STOWNAME              YES- FINISH UP                   18820000
         CLI   INPLCSW,X'0F'           UPDATE INPLACE JUST DONE         18840000
         BE    OUTOFSEQ                YES,GIVE MSG AND QUIT     A32632 18860021
         MVI   READNOOM,X'0F'          SET SWITCH TO STOP OM READ       18880000
         B     CHKOP                   PROCESS SYSIN RECORDS       7811 18920017
*                                                                     * 18940000
*        FINISH OF A MEMBER UPDATE- SET UP SSI AND STOW MEMBER NAME.  * 18960000
*                                                                     * 18980000
STOWNAME CLI   FINICCS,X'0F'      SYSIN FINISHED?              @ZA01682 18984002
         BE    STOW               YES,FINISH THIS MEMBER       @ZA01682 18988002
         CLI   COMDCD2,X'1F'                                   @ZA01690 18990002
         BNE   STOW                                            @ZA01690 18990402
         CLI   ALIASW2,X'0F'      SEVERAL ALIAS STMT?          @ZA01682 18992002
         BE    RESCANIT           YES,GO ON TO SCAN            @ZA01682 18996002
STOW     CLI   FLUSHSW,X'0F'      ENDING UP ON FLUSH?          @ZA01682 19000002
         BE    DONOTSTO                YES- DO NOT STOW                 19020000
         CLI   DELETSW,X'0F'           DELETE STILL IN EFFECT           19040000
         BE    BADDELET                YES- CARDS OUT OF ORDER- ERROR   19060000
         CLI   OPENSW,X'0F'       ARE DCB'S OPEN YET             PTM295 19066017
         BE    NODATAS            NO DATA IN SYSIN               PTM295 19072017
         CLI   NMBUFFR,X'0F'           WAS LAST NM BLOCK WRITTEN        19080000
         BE    WRTLASTB                NO- WRITE LAST NEW MASTER RECORD 19100000
STOW2    CLI   PSSWNM,X'0F'            IS NEW MASTER PARTITIONED        19120000
         BNE   LASTLEG                 NO- SEQUENTIAL-FINISH UP-NO STOW 19140000
         TM    ALIASW2,X'F0'           HAS STOW BEEN DONE          UL0H 19146017
         BO    STOWALAS                YES--ONLY HERE TO STOW      UL0H 19152017
         CLI   INPLCSW,X'0F'           UPDATE IN PLACE                  19160000
         BE    CHKALIAS           YES.. BYPASS STOW                     19180020
         XC    STOWAREA(80),STOWAREA   CLEAR STOW AREA                  19200000
         CLI   NEWNAME,X'00'           IS THIS A NEW PODS FROM PS OM    19220000
         BNE   STOWNEW                 YES- STOW NEW NAME               19240000
         MVC   STOWAREA(8),MEMNAME     MOVE NAME TO STOW AREA           19260000
CHECKSSI CLI   SSISW,X'0F'             PUT REPLACEMENT SSI DATA IN      19280000
         BE    STOWSSI                 YES                              19300000
         CLI   LEVELXX,C'0'            IS THERE A LEVEL CHANGE          19320000
         BNE   LEVELNEW                YES- CHANGE LEVEL                19340000
         CLI   SOURCECD,X'FF'          IS SOURCE CODE CHANGED           19360000
         BNE   NEWSORCE                YES- CHECK NEW SOURCE SETTING    19380000
STORALLS MVC   STOWAREA+11(64),LISTAREA+17   COPY USER DATA             19400000
STOWIT   L     GR1,DCBNM               ADDRESS OF NEW MASTER DCB        19420000
STOWALI  STOW  (GR1),STOWAREA,R                                         19440000
         STC   GR15,SARG               STORE STOW RETURN CODE           19460000
         TM    SARG,X'0C'              IS DIRECTORY FULL (CODE 12)      19480000
         BO    STOWER12                YES- GIVE MESSAGE                19500000
         TM    SARG,X'10'              I/O ERROR FROM STOW (CODE 16)    19520000
         BO    STOWER16                YES- GIVE MESSAGE                19540000
         TM    SARG,X'08'              WAS NAME IN NM DIRECTORY         19560000
         LA    GR11,STOWMSGT           LOAD NOT FOUND MESSAGE CODE      19580000
         BO    STOWOVER                NAME IN DIRECTORY GIVE MESSAGE   19600000
         LA    GR11,STOWMSGN           LOAD MESSAGE FOUND NAME CODE     19620000
STOWOVER LA    GR7,STOWAREA            ADDRESS OF MEMBER NAME           19640000
         BAL   GR9,GIVEMESS            GIVE APPROPRIATE MESSAGE         19660000
CHKALIAS CLI   ALIASW,X'0F'            ALIAS NAME TO BE STOWED          19680000
         BE    STOWALAS                YES- STOW ALIAS NAME             19700000
         TM    ALIASW2,X'0F'           ALIAS PENDING               MA0H 19703017
         BO    STOWADAL           YES,GO TO STOW ADD ALIAS     @ZA01682 19703502
         B     DONOTSTO           NO,THIS MEMBER FINISHED      @ZA01682 19704002
STOWADAL L     GR7,ALIASNM1       POINTER TO LAST ALIAS NAME   @ZA01682 19704502
         L     GR3,ALIASNM2       POINTER OF ALIAS TO MOVE     @ZA01682 19705002
         CR    GR3,GR7            LAST ALIAS ALREADY MOVED?    @ZA01682 19705502
         BE    NOSTOW             YES,FINISH THIS MEMBER       @ZA01682 19706002
         LA    GR3,8(GR3)         POINTER TO NEXT ALIAS NAME   @ZA01682 19706502
         ST    GR3,ALIASNM2       SAVE POINTER                 @ZA01682 19707002
         MVC   STOWAREA(8),0(GR3) MOVE ALIAS NAME              @ZA01682 19707502
         B     STOWALA2           BRANCH TO STOW               @ZA01682 19708002
NOSTOW   NI    COMDCD2,X'0F'      RESET COMMAND PENDING SWITCH @ZA01690 19709002
         MVI   ALIASW2,X'F0'           SHOW STOW HAS BEEN DONE     MA0H 19712017
DONOTSTO TM    FINICCS,X'0F'           ARE CONTROL CARDS DEPLETED       19720000
         BC    1,LASTLEG               YES- ALL FINISHED                19740000
         BAL   GR3,GOONTEST            SEE IF GO ON TO NEXT MEMBER      19760000
         B     TESTLOC                 MUST HAVE PO OM/NM GO ON         19780000
STOWSSI  MVC   LISTAREA+18(4),SSIBUF   INSERT SSI INFORMATION           19800000
STORSTAT SR    GR3,GR3                                                  19820000
         IC    GR3,LISTAREA+17         PICK UP USER DATA COUNT          19840000
         C     GR3,TWO                                             5873 19860017
         BNL   STORALLS                MORE THAN 2,GO STOW         5873 19880017
         OI    LISTAREA+17,X'02'       MAKE COUNT TWO HALFWORDS    5873 19900017
         B     STORALLS                SET UP FOR STOW                  19940000
LEVELNEW MVC   LISTAREA+18(1),LEVELXX  INSERT NEW LEVEL INTO SSI        19960000
         CLI   SOURCECD,X'FF'          IS SOURCE CODE CHANGED           19980000
         BE    STORSTAT                SET UP SSI                       20000000
NEWSORCE CLI   SOURCECD,X'F0'          IS SOURCE USER                   20020000
         BNE   IBMSORCE                NO- IBM CHANGE                   20040000
         OI    LISTAREA+19,X'20'       SET LOCAL FIX SWITCH IN SSI      20060000
         B     STORSTAT                STORE STATUS LISTAREA TO STOW    20080000
IBMSORCE NI    LISTAREA+19,X'DF'       RESET LOCAL FIX SWITCH 0 FOR IBM 20100000
         B     STORSTAT                STORE STATUS LISTAREA TO STOW    20120000
STOWNEW  MVC   STOWAREA(8),MEMBNEW     STOW NEW PO NAME                 20140000
         B     CHECKSSI                SEE IF STATUS INFORMATION        20160000
STOWER12 LA    GR11,ERRDIRF            DIRECTORY FILLED MESSAGE         20180000
         B     FINERRA                 GIVE MESSAGE                     20200000
STOWER16 LA    GR11,ERRDRIO            DIRECTORY I/O ERROR MESSAGE CODE 20220000
         B     FINERRA                 GIVE MESSAGE, SET ERROR CODE 12  20240000
STOWALAS MVI   ALIASW,RESET0           CLEAR ALIAS SWITCH               20260000
         MVC   STOWAREA(8),ALIASNM     MOVE ALIAS NAME TO STOW BUFFER   20280000
STOWALA2 OI    STOWAREA+11,BIT80       FLAG AS ALIAS           @ZA01682 20300002
         CLI   INPLCSW,X'0F'           UPDATE INPLACE                   20320000
         BNE   STOWIT                  NO- STOW NM                      20340000
         L     GR1,DCBOM               ADDRESS OF OM DCB                20360000
         MVC   STOWAREA+8(70),LISTAREA+12   MOVE IN TTR AND DATA        20380000
         OI    STOWAREA+11,BIT80       SET ALIAS BIT                    20400000
         B     STOWALI                 STOW OM ALIAS UPDATE INPLACE     20420000
         EJECT                                                          20800000
*********************************************************************** 20820000
*                        END OF JOB ROUTINE                           * 20840000
*********************************************************************** 20860000
INVALLBL LA    GR11,ERROP               LOAD ERROR MSG CONSTANT    UL0H 20864017
         BAL   GR9,GIVEMESS             GIVE ERROR MESSAGE         UL0H 20868017
         B     DEACTVCT                 PREPARE TO CLOSE           UL0H 20876017
         SPACE 1                                                        20880000
DEACTVCT MVI   TEMPCON,X'08'           RETURN CODE IS 8          A25427 20880618
DEACTV   L     GR6,DCBCT               LOAD ADDR OF C.T. DCB     A25427 20881218
         L      GR6,EXLIST(GR6)         LOAD ADDR OF C.T. EXIT LISTUL0H 20882017
         MVI   0(GR6),RESET0            DEACT. USER HEADER EXIT    UL0H 20883017
         MVI   4(GR6),RESET0            DEACT. USER TRAILER EXIT   UL0H 20884017
DEACTVOM L     GR6,DCBOM                LOAD ADDR OF O.M. DCB      UL0H 20885017
         L     GR6,EXLIST(GR6)          LOAD ADDR OF O.M. EXIT LISTUL0H 20886017
         MVI   0(GR6),RESET0            DEACT. USER HEADER EXIT    UL0H 20887017
         MVI   4(GR6),RESET0            DEACT. USER TRAILER EXIT   UL0H 20888017
        MVI   12(GR6),X'85'            MAKE DCB XIT LAST/ACTIVE    UL0H 20889017
        MVI   16(GR6),X'07'            MAKE JFCB EXIT ACTIVE       UL0H 20890017
DEACTVNM L     GR6,DCBNM                LOAD ADDR OF N.M. DCB      UL0H 20890817
         L     GR6,EXLIST(GR6)          LOAD ADDR OF N.M. EXIT LISTUL0H 20891617
         MVI   0(GR6),RESET0            DEACT. USER HEADER EXIT.   UL0H 20892417
         MVI   4(GR6),RESET0            DEACT. USER TRAILER EXIT.  UL0H 20893217
         MVI   8(GR6),RESET0            DEACT. USER TOTALING EXIT. UL0H 20894017
         MVI   12(GR6),X'85'            MAKE DCB EXIT LAST AND ACTVUL0H 20894817
         MVI   16(GR6),X'07'            ACTIVATE JFCB EXIT.        UL0H 20895617
         CLI   CLOSESW,X'0F'            RETURN FROM CLOSING SYSIN  UL0H 20897617
         BE    CLOSEOMT                 &F SO,CLOSE OM             UL0H 20899617
         CLI   CLOSESW,X'F0'            RETURN FROM CLOSING OM     UL0H 20901617
         BE    CLOSENM                  IF SO,CLOSE NM             UL0H 20903617
         CLI   CLOSESW,X'FF'            RETURN FROM CLOSING NM     UL0H 20905617
         BE    ALMOSTY                  IF SO,PREPARE TO RETURN    UL0H 20907617
         B     CLOSEUP                  IF NOT BEGIN CLOSING       UL0H 20909617
RESTORE  CLI   INPLCSW,X'0F'           UPDATE INPLACE?         @ZA06529 20919699
         BE    LASTLEG                 YES,BRANCH              @ZA06529 20929699
         CLI   STARTMEM,X'0F'          MEMBER UPDATE STARTED   @ZA06529 20939699
         BNE   LASTLEG                 NO,BRANCH               @ZA06529 20949699
         L     GR11,DCBNM              ADDR OF NEW MASTER DCB  @ZA06529 20951699
         MVC   BFDAD(8,GR11),FDADSET  RESTORE TO START OF AREA @ZA06529 20953699
         MVC   TRBAL(2,GR11),TRKBAL RESTORE PREVIOUS TRACK BAL @ZA06529 20955699
LASTLEG  TM    CTONLYSW,X'01'     IS THERE AN OLD MASTER                20959620
         BO    FREENEWM           NO.. FREE UP NM BUFFERS        A30480 21009620
         L     GR11,DCBOM              ADDRESS OF OLD MASTER DCB        21060000
         L     GR1,OMREADP             ADDRESS OF BUFFER                21080000
         LTR   GR1,GR1            IS THERE A BUFFER              PTM223 21086017
         BZ    FREENEWM           NO BRANCH                      PTM223 21092017
         LH    GR0,BBLKSI(GR11)        LOAD BLOCKSIZE FROM DCB          21100000
         FREEMAIN R,LV=(0),A=(1)                                        21120000
FREENEWM CLI   INPLCSW,X'0F'           IS THERE AN NEW MASTER           21140000
         BE    CLOSEUP                 NO- CLOSE DATA SETS              21160000
         L     GR11,DCBNM              ADDRESS OF NEW MASTER DCB        21180000
         L     GR1,NMWRITEP            ADDRESS OF NEW MASTER BUFFER     21200000
         LTR   GR1,GR1            IS THERE A BUFFER              PTM223 21206017
         BZ    CLOSEUP            NO BRANCH                      PTM223 21212017
         LH    GR0,BBLKSI(GR11)        LOAD BLOCKSIZE FROM DCB          21220000
         FREEMAIN R,LV=(0),A=(1)                                        21240000
CLOSEUP  L     GR7,DCBCT               ADDRESS OF SYSIN DCB             21260000
         CLOSE ((GR7),LEAVE)           CLOSE SYSIN- LEAVE IN CASE TAPE  21280000
         FREEPOOL (GR7)                                            BS0H 21290017
         LA    GR9,CLOSEOMT            RETURN FROM TRAILER CHECK        21300000
         MVI   CLOSESW,X'0F'                                       UL0H 21310017
TESTTRAL CLI   LBLRETCD,X'10'                                      UL0H 21330017
         BCR   4,GR9                   OK IF LESS THAN 16          UL0H 21350017
HEADRMSG LA    GR11,USRTRMSG           CODE IS 16, USER LABEL ERROR     21380000
         L     GR15,PRIMEWRT           ADDRESS OF MESSAGE CSECT         21400000
         BALR  GR14,GR15               GIVE MESSAGE                     21420000
         LA    GR15,16                 SET RETURN CODE TO 16            21440000
         STH   GR15,HICONCDE           STORE 16 INTO CONDITION CODE     21460000
         MVI   LBLRETCD,X'00'           RESET RETURN CODE          UL0H 21470017
         B     DEACTVCT                 DEACTIVATE EXITS           UL0H 21480017
CLOSEOMT CLI   NMSYSNLB,X'00'          ANY LABELS TO BE OUTPUT     UL0H 21510017
         BE    CLOSEOM                 IF NOT, CLOSE NEW MASTER    UL0H 21520017
         CLI   INPLCSW,X'0F'            UPDATE=INPLACE             UL0H 21550017
         BE    NOTRLBLI                 IF SO,ERROR                UL0H 21560017
CLOSEOM  L     GR7,DCBOM               ADDRESS OF OLD MASTER DCB        21580000
         CLOSE ((GR7))                 CLOSE OLD MASTER DCB        5200 21600015
         MVI   CLOSESW,X'F0'                                       UL0H 21610017
         BAL   GR9,TESTTRAL            TEST TRAILER RETURN CODE IF ANY  21620000
         CLI   PSSWNM,X'00'             IS NM PHY SEQ              UL0H 21630017
         BE    CLOSENM                  IF SO,CLOSE IT             UL0H 21640017
         CLI   NMSYSNLB,X'00'          ANY LABEL PROCESSING REQUESTUL0H 21650017
         BNE   LABLMESG                IF SO, ITS AN ERROR         UL0H 21660017
CLOSENM  MVI   NMCLSESW,X'1F'           FLAG AS DURING CLOSE       UL0H 21670017
         CLI   LABELSW,X'20'            LABEL CREATION REQUESTED   16/' 21680017
         BNE   PRECLNM                  IF NOT, OPEN               UL0H 21690017
         MVI   NMSYSNLB,X'0F'           FLAG AS TRAILERS TO CREATE UL0H 21700017
PRECLNM  L     GR7,DCBNM                NM  DCB ADDRESS            UL0H 21710017
         CLOSE ((GR7))                 CLOSE NEW MASTER DCB        5200 21740015
         MVI   CLOSESW,X'FF'                                       UL0H 21750017
         BAL   GR9,TESTTRAL            TEST TRAILER RETURN CODE IF ANY  21760000
ALMOSTY  CLC   TEMPCON(1),HICONCDE+1                               UL0H 21780017
         BNH   ALMOSTZ                 HIGH OR EQUAL CODE               21800000
         MVC   HICONCDE+1(1),TEMPCON   NO  SWAP RETURN CODES            21820000
ALMOSTZ  TM    SYNADSW,X'0F'     IS THIS THE END OF A SYNAD EXIT?A27716 21830019
         BCR   1,GR3                   YES, GO BACK TO IEBUPXIT  A27716 21840019
         L     GR15,PRIMEWRT           ADDRESS OF MESSAGE CSECT  A27716 21850019
         MVI   QUITALL,X'0E'           LAST MESSAGE AND CONDITION CODE  21860000
         BR    GR15                    GIVE MESSAGE,CLOSE DCBLOG,RETURN 21880000
OMIOERR  LA    GR11,LBLERMSG            I/O ERROR DURINT LABEL PRO UL0H 21884017
         L     GR15,PRIMEWRT            ADDRESS OF IEBUPLOG        UL0H 21888017
         BALR  GR14,GR15                PRINT MESSAGE              UL0H 21892017
         B     DEACTVCT                 DEACTIVATE EXITS AND CLOSE UL0H 21896017
         EJECT                                                          21900000
*                                                                     * 21920000
*    CONSTANTS FOR IEBUPDT2 CSECT ONLY                                * 21940000
*                                                                     * 21960000
DSORGRTN DC    A(CHKDSORG)    ENTRY POINT FOR CHECK DSORG ROUTINE  3341 21963017
BLANKS8  DC    CL8' '                  DOUBLE WORD OF HEX BLANKS   UL0H 21965017
SAVEPT13 DS    F                       SAVE REGISTER 13            UL0H 21967017
SAVEGR6  DS    F                       SAVE REGISTER 6           A45212 21967421
SIZELIST DC    X'0001004C'             CONSTANT FOR BLDL LIST      UL0H 21969017
REGSAVS  DS    18F                     SAVE REGISTERS              UL0H 21971017
PRIMEWRT DC    V(IEBUPLOG)             ENTRY POINT OF LOG ROUTINE  UL0H 21973017
SCANENTR DC    V(IEBASCAN)             ENTRY POINT OF SCAN ROUTINE UL0H 21975017
MOVEPART MVC   0(1,GR6),0(GR7)         MOVE PARTIAL CARD OM/CT     UL0H 21977017
UPKSN    UNPK  D0(L1,GR7),TEMP(L8)     SET NUMERIC IN SEQ NO    YM07522 21977402
CHKSEQNB CLC   0(1,GR8),BLANKS8        TEST IF SEQUENCE NUMBER IS BUL0H 21979017
LOGMOVE  MVC   0(1,GR7),0(GR6)         MOVE RECORD TO LOG OUT AREA UL0H 21981017
COMPARES CLC   0(1,GR7),0(GR6)         COMPARE SEQUENCE NUMBERS    UL0H 21983017
COMDCLER XC    COMDCD(1),COMDCD        CLEAR CONTROL CARD SWITCHES UL0H 21985017
INITSEQ  DC    X'00480008'             COLUMN 73,SIZE 8 SEQUENCE FIUL0H 21987017
SIXTEEN  DC    H'16'                   CONSTANT                    UL0H 21989017
SARG     DC    H'0'                    WORK AREA                   UL0H 21991017
SYS1RECL DC    H'0'                    LOGICAL RECORD LENGTH SYSUT1UL0H 21993017
VALIDREC DC    H'00'                   NUMBER OF RECORDS IN LAST BLUL0H 21995017
OMDC     DC    C'OM'                   REFERENCE OLD MASTER        UL0H 21997017
NMDC     DC    C'NM'                   REFERENCE NEW MASTSR        UL0H 21999017
SLASHAST DC    C'/*'                   EOF INDICATOR SYSIN         UL0H 22001017
DOTSLASH DC    C'./'                   IDENTIFIES CONTROL CARD     UL0H 22003017
TESTLABL DC    2X'0'                   TEMP STORAGE FOR LABELSW    UL0H 22010017
TMPLBLCT DC    2X'0'                   TEMPORARY STORAGE OF LABEL #UL0H 22017017
MULTI    DC    X'00'                   SET TO X'0F' FOR NEXT MEMBER1796 22026017
NULL     DC    CL8'NULLFILE'                                     A25310 22026518
CLOSESW  DC    X'0'                                                UL0H 22027017
ZERO     DC    H'0'                    COMPARE FOR TOTAL CHANGE    3511 22029017
BLDFNDSW DC    X'00'                   SET TO 00 WHEN BLDL IS DONE 2163 22030018
OLDOMSEQ DC    D'0'                    TO HOLD PREVIOUS OM SEQ   A24812 22031018
         USING CHKDSORG,GR9   SET UP 2ND BASE AREA ADDRESSABILITY  3341 22032017
CHKDSORG DS    0F                                                  3341 22035017
         USING IHADCB,GR3         SET UP BASE FOR OM OR NM DCB     3341 22038017
         L     GR10,DCBEXLST  GET ADDRESS OF DCB EXIT LIST         3341 22041017
         NI    12(GR10),X'05'          FLAG DCB ENTRY AS NOT LAST  UL0H 22044017
STORADDR LA    GR7,JFCBAREA   GET ADDRESS OF AREA INTO WHICH JFCB  3341 22047017
         ST    GR7,16(GR10)            READ AND PUT INTO EXLIT LISTUL0H 22050017
         MVI   16(GR10),X'87'          FLAG AS LAST AND JFCB       UL0H 22053017
*                             READ (X'80' PLUS X'07')              3341 22056017
         LR    GR7,GR3            TRANSFER DCB ADDRESS TO PRESERVE 3341 22059017
*                                 DSECT BASE FOR CONTINUED USE     3341 22062017
         CLI   INPLCSW,X'0F'      UPDATE IN PLACE                  3341 22065017
         BE    UPDTJFCB                                            3341 22068017
*                                                                  3341 22071017
         RDJFCB  ((GR7),OUTPUT)   READ JFCB FOR OUTPUT             3341 22074017
*                                                                  3341 22077017
         CLC   JFCBAREA(8),NULL        IS SYSUT2 A DUMMY SET     A25310 22078018
         BE    DUMMYNM                 YES, GO TO MSG RTN        A25310 22079018
         TM    JFCBAREA+52,X'20'       A SYSIN/SYSOUT D/S ?    @ZA33607 22079399
         BO    YESNEW                  YES,DON'T TEST DISP     @ZA33607 22079599
         TM    JFCBAREA+87,X'C0'       IS NM AN NEW D/S?       @ZA28493 22080099
         BO    YESNEW                  YES,CONTINUE            @ZA28493 22080699
         OI    NMBLKERR,X'80'          NO,INDICATE NM OLD D/S  @ZA28493 22081299
YESNEW   OI    12(GR10),X'85'          REST. DCB ENT LAST/ACTV @ZA28493 22081899
         MVI   16(GR10),X'07'           MAKE JFCB EXIT NOT LAST    UL0H 22083017
         LA    GR11,SYSUT2NM  GET ADDRESS OF SYSUT2 DD NAME        3341 22086017
         B     GETYPE              GO CHECK DEVICE TYPE            3341 22089017
*                                                                  3341 22092017
UPDTJFCB RDJFCB  ((GR7),UPDAT)    READ JFCB FOR UPDATE IN PLACE    3341 22095017
         OI    12(GR10),X'85'          RESTORE DCB ENTRY LAST/ACTV UL0H 22098017
         MVI   16(GR10),X'07'           MAKE JFCB EXIT NOT LAST    UL0H 22101017
         LA    GR11,SYSUT1NM  GET ADDRESS OF SYSUT1 DD NAME        3341 22104017
GETYPE   DEVTYPE (GR11),ADEVTYPE                                   3341 22107017
         LTR   GR15,GR15           TEST RETURN CODE                3341 22110017
         BNZ   DDNOTFND            NOT ZERO, DD NAME NOT FOUND     3341 22113017
         CLI   ADEVTYPE+2,X'20'    IS DEVICE TYPE DIRECT ACCESS    3341 22116017
         BE    GETDSCB             YES, GO OBTAIN AND CHK DSORG    3341 22119017
NOOBTAIN OI    DCBDSORG,PSDSET     NO, SET DSORG AS SEQUENTIAL(PS) 3341 22122017
         NI    DCBMACR+1,X'20'         DELETE POINT MACR       @ZA00637 22124002
         B     TESTUT2            TEST FOR VALID DSORG           A33305 22125020
NOOPEN   CLI   INPLCSW,X'0F'       WAS OBTAIN FOR UPDATE INPLACE   3341 22128017
*                                  I.E., FOR SYSUT1 DSCB           3341 22131017
         BNE   GETADUT2            NO, GET UT2 DDNAME ADDRESS      3341 22134017
         LA    GR7,SYSUT1NM        YES,GET ADDR DDNAME FOR LOG MSG 3341 22137017
         B     GOTOLOG             GO GET MSG CODE & GIVE MESSAGE  3341 22140017
GETADUT2 LA    GR7,SYSUT2NM        OBTAIN WAS FOR SYSUT2 DDNAME    3341 22143017
GOTOLOG  LA    GR11,NTOPMSG        LOAD MESSAGE CODE               3341 22146017
         B     FINERRA             GO PRINT MESSAGE, END JOB       3341 22149017
*                                                                  3341 22152017
DDNOTFND LA    GR11,DDNAMEMG  GET CODE FOR INVALID DDNAME MESSAGE  3341 22155017
         B     FINERRA        GO PRINT MESSAGE AND END JOB         3341 22158017
*                                                                  3341 22161017
GETDSCB  XC    DSCBLIST(16),DSCBLIST  CLEAR LIST AREA FOR OBTAIN   3341 22164017
         OI    DSCBLIST,X'C1'     FLAG 1ST BYTE FOR SEARCH         3341 22167017
*                                 OPERATION REQUESTED              3341 22170017
         LA    GR7,JFCBAREA        PUT ADDRESS OF DATA SET         3341 22173017
         ST    GR7,DSCBLIST+4      NAME INTO LIST FOR OBTAIN       3341 22176017
         LA    GR7,JFCBAREA+118    PUT ADDRESS OF VOLID INTO LIST  3341 22179017
         ST    GR7,DSCBLIST+8      FOR OBTAIN                      3341 22182017
         LA    GR7,DSCBAREA        PUT ADDRESS OF 350 BYTE WORK    3341 22185017
         ST    GR7,DSCBLIST+12     AREA INTO LIST FOR OBTAIN       3341 22188017
         OBTAIN  DSCBLIST                                          3341 22191017
         LTR   GR15,GR15           TEST FOR RETURN CODE OF ZERO    3341 22194017
         BC    7,NOOPEN              NON-ZERO RETURN, END JOB      3341 22197017
         TM    DSCBAREA+38,X'02'   IS DSORG PARTITONED             3341 22200017
         BC    1,CHKPODS           YES, GO CHECK IF UPDATE INPLACE 3341 22203017
         TM    DSCBAREA+38,X'BF'   DSORG ANYTHING BUT SEQUENTIAL   3341 22206017
         BC    7,NOOPEN            YES, ERROR, GO GIVE MESSAGE     3341 22209017
*                                  NO,CHECK FOR UPDATE IN PLACE    3341 22212017
CKINPLCE CLI   INPLCSW,X'0F'       UPDATE IN PLACE(DSORG WAS PS)   3341 22215017
         BE    TESTUT1             YES, GO COMPARE FOR UT1         3341 22218017
TESTUT2  CLI   PSSWNM,X'00'        PSSWNM SWITCH SET FOR PS        3341 22221017
         BNE   BADSORG             NO, MESSAGE FOR INCOMPATIBLE    3341 22224017
*                                  DATA SET ORGANIZATION           3341 22227017
         BR    GR8                 RETURN AND OPEN DATA SET        3341 22230017
TESTUT1  CLI   PSSWOM,X'00'        PSSWOM SWITCH SET FOR PS        3341 22233017
         BNE   BADSORG             NO, INCOMPATIBLE DSORGS         3341 22236017
         BR    GR8                 RETURN, ALL OKAY                3341 22239017
CHKPODS  CLI   INPLCSW,X'0F'                                       3341 22242017
         BE    TESTUT1A                                            3341 22245017
TESTUT2A CLI   PSSWNM,X'0F'                                        3341 22248017
         BNE   BADSORG             INCOMPATIBLE DSORG, GIVE MSG    3341 22251017
         BR    GR8                                                 3341 22254017
TESTUT1A CLI   PSSWOM,X'0F'                                        3341 22257017
         BNE   BADSORG             INCOMPATIBLE DSORG, GIVE MSG    3341 22260017
         BR    GR8                                                 3341 22263017
BADSORG  LA    GR11,DSORGBAD       LOAD CODE FOR DSORG MESSAGE     3341 22266017
         B     FINERRA             GO GIVE MESSAGE AND END JOB     3341 22269017
EXTNTCHK DS    0H                                              @ZA01684 22271002
         CLI   INPLCSW,X'0F'           IS THIS UPDATE INPLACE      5324 22278017
         BE    BACK                    YES--BRANCH                 5324 22281017
         GETMAIN R,LV=176                                          5324 22284017
         L     GR6,DCBOM               OLD MASTER DCB ADDRESS      5324 22287017
         L     GR6,36(GR6)             EXIT LIST FOR DCB           5324 22290017
         NI    12(GR6),X'05'           FLAG DCB AS NOT LAST        UL0H 22293017
         ST    GR1,16(GR6)             AREA TO READ JFCB           UL0H 22296017
         MVI   16(GR6),X'87'           FLAG AS LAST AND READ JFCB  UL0H 22299017
         LR    GR7,GR1                 SAVE ADDRESS OF AREA        5324 22302017
         L     GR6,DCBOM               ADDRESS OF OLD MASTER DCB   5324 22305017
         RDJFCB ((GR6),INPUT)                                      5324 22308017
         L     GR6,36(GR6)             CHANGE FLAGS                5324 22311017
         OI    12(GR6),X'85'       RESTORE DCB ENTRY LAST/ACTV   PTM714 22314017
         NI    16(GR6),X'00'       RESET JFCB ENTRY TO ZERO      PTM714 22317017
         CLC   0(44,GR7),JFCBAREA      ARE DATA SET NAMES THE SAMES5324 22320017
         BNE   FREEUP                  NO--BRANCH                  5324 22323017
         CLC   118(6,GR7),JFCBAREA+118                           A29047 22326019
         BNE   FREEUP                  NO--BRANCH                  5324 22329017
         MVI   EXTNTSW,X'0F'           YES-INDICATE EXTENTS CHECK  5324 22332017
FREEUP   LR    GR1,GR7                 ADRESS OF AREA TO FREE      5324 22335017
         FREEMAIN R,LV=176,A=(1)                                   5324 22338017
BACK     BR    GR8                                                 5324 22341017
TWO      DC    F'2'                                                5873 22344017
FOUR     DC    F'4'                                                UL0H 22344717
EIGHT    DC    H'8'                                                UL0H 22345417
ENDUP    DC    C'ENDUP '                                           UL0H 22346117
REPSW    DC    X'00'                     REPLACE/UPDATE SWITCH  YA01187 22348102
TEMP10   DS    F                                                   UL0H 22356117
LENGTH   DS    F                                                   UL0H 22366117
DELETMSG DC    CL25'     *           DELETED*'                  YA01187 22376102
UPDTMS   DC    CL25'     *    UPDATED RECORD*'                  YA01187 22376502
REPMES   DC    CL25'     *       REPLACEMENT*'                  YA01187 22376902
REPLMSG  DC    CL25'     *          REPLACED*'                  YA01187 22377302
INSERTMS DC    CL25'     *          INSERTED*'                  YA01187 22378102
RENUMMS  DC    CL25'     *RENUMBERING FORCED*'                  YA01187 22378502
         EJECT                                                          22380000
         DCBD  DSORG=PS                                                 22400000
BDSORG   EQU   DCBDSORG-IHADCB         DATA SET ORGANIZATION FIELD DCB  22420000
TRBAL    EQU   DCBTRBAL-IHADCB    DISPLACEMENT FOR DCB TRACK BAL   5666 22430016
BLRECL   EQU   DCBLRECL-IHADCB         LOGICAL RECORD LENGTH FIELD DCB  22440000
BOFLGS   EQU   DCBOFLGS-IHADCB         OPEN ERROR FIELD IN DCB          22460000
BBLKSI   EQU   DCBBLKSI-IHADCB         BLOCKSIZE FIELD IN DCB           22480000
IFLGSEOF EQU   DCBIFLGS-IHADCB         EOF FLAGS IN DCB 'AFTER' OPEN    22500000
BFDAD    EQU   DCBFDAD-IHADCB          TTR IN MBBCCHHR AT START DCB     22520000
EXLIST  EQU   DCBEXLST-IHADCB                                           22530017
PODSET   EQU   2                       SETTING OF DCB DSORG FOR PODS    22540017
PSDSET   EQU   X'40'          DCB SETTING FOR SEQUENTIAL           3341 22550016
RESET0   EQU   X'00'                   CLEARS SWITCH                    22560000
BIT80    EQU   X'80'                                                    22580000
BIT01    EQU   X'01'                                                    22600000
BIT10    EQU   X'10'                                                    22620000
         EJECT                                                          22640000
         IEBUPCON                                                       22660000
         END   IEBUPDT2                                                 22680000
./  ADD  SSI=60090057,NAME=IEBUPLOG
ULOG     TITLE 'IEBUPDTE MESSAGE CSECT- IEBUPLOG'                       00020000
*TITLE- IEBUPDTE MESSAGE CSECT- IEBUPLOG                              * 00040000
*                                                                     * 00060000
*STATUS- CHANGE LEVEL 001                                             * 00080000
*                                                                     * 00100000
*FUNCTION/OPERATION- THIS MODULE IS ABLE TO CREATE AND UPDATE         * 00120000
*   SYMBOLIC LIBRARIES WHICH ARE EITHER PHYSICAL SEQUENTIAL OR        * 00140000
*   PARTITIONED DATA SETS CONTAINED ON DIRECT ACCESS OR TAPE VOLUMES. * 00160000
*                                                                     * 00180000
*   THIS MODULE HANDLES FIXED OR FIXED-BLOCKED RECORDS. IT HAS THE    * 00200000
*   ABITLITY TO HANDLE RECORD OF LOGICAL RECORD LENGTHS UP TO EIGHTY  * 00220000
*   BYTES. IF BLOCKSIZE AND/OR LOGICAL RECORD LENGTH ARE NOT GIVEN    * 00240000
*   BY OPEN TIME, UNBLOCKED RECORDS OF 80 BYTES IS ASSUMED AND A      * 00260000
*   WARNING MESSAGE IS GIVEN ON THE LOG OUT DEVICE.                   * 00280000
*                                                                     * 00300000
*   THIS MODULE CAN-                                                  * 00320000
*                                                                     * 00340000
*   1. CREATE A NEW PARTITIONED OR PHYSICAL SEQUENTIAL DATA SET       * 00360000
*                                                                     * 00380000
*   2. SEQUENCE THE NEW DATA SET OR RESEQUENCE AN OLD ONE             * 00400000
*                                                                     * 00420000
*   3. REPRODUCE OR REPLACE A MEMBER OR A DATA SET                    * 00440000
*                                                                     * 00460000
*   4. PRODUCE A PARTITIONED DATA SET FROM A PHYSICAL SEQUENTIAL      * 00480000
*   MASTER OR THE CONVERSE.                                           * 00500000
*                                                                     * 00520000
*   4. ADD A MEMBER TO A PARTITIONED DATA SET.                        * 00540000
*                                                                     * 00560000
*   5. ASSIGN AN ALIAS NAME TO ANY MEMBER UPDATED                     * 00580000
*                                                                     * 00600000
*   6. CHANGE RECORDS IN A DATA SET                                   * 00620000
*                                                                     * 00640000
*   7. HANDLE RECORDS WITH NON-STANDARD SEQUENCE NUMBER FIELDS AND    * 00660000
*   LENGTHS OF SEQUENCE NUMBERS FROM 1 TO 8 CHARACTERS.               * 00680000
*                                                                     * 00700000
*   8. UPDATE ONLY SPECIFIED PORTION OF DATA SET RECORDS.             * 00720000
*                                                                     * 00740000
*   9. UPDATE INPLACE DATA SETS OR MEMBERS ON DIRECT ACCESS VOLUMES.  * 00760000
*                                                                     * 00780000
*ENTRY POINTS- ENTERED FROM THE OPERATING SYSTEM AT 'IEBUPDTE'.       * 00800000
*                                                                     * 00820000
*INPUT- SYSIN WHICH CONSISTS OF CONTROL CARDS AND LOGICAL DATA        * 00840000
*   RECORDS FOR INSERTION OR REPLACEMENT, THE INPUT DATA SET.         * 00860000
*                                                                     * 00880000
*       SYSUT1 WHICH DEFINES THE 'OLD MASTER' DATA SET WHICH MAY BE   * 00900000
*   PARTITIONED OR PHYSICAL SEQUENTIAL IN ORGANIZATION.               * 00920000
*                                                                     * 00940000
*OUTPUT-SYSPRINT WHICH CONTAINS DIAGNOSTIC MESSAGES, THE CONTENTS OF  * 00960000
*   SYSIN AND-IF THE 'LIST=ALL' CONDITION IS PRIMED- THE ENTIRE       * 00980000
*   'NEW MASTER' IS LISTED ON THE DEVICE DESIGNATED.                  * 01000000
*                                                                     * 01020000
*       SYSUT2 WHICH DEFINES THE 'NEW MASTER' DATA SET. IT WILL BE A  * 01040000
*   COMPOSITE OF THE SYSIN AND SYSUT1 DATA SETS. IT CAN BE EITHER     * 01060000
*   PARTITIONED OR PHYSICAL SEQUENTIAL IN ORGANIZATION.               * 01080000
*                                                                     * 01100000
*EXITS- NORMAL- A RETURN IS GIVEN TO THE SCHEDULAR MODULE OF THE      * 01120000
*   OPERATING SYSTEM. CONDITION CODE RETURNED ON A SUCCESSFUL RUN     * 01140000
*   WILL BE ZERO.                                                     * 01160000
*                                                                     * 01180000
*EXITS- ERROR- IF AN ERROR OCCURS, A CODE IS STORED, A MESSAGE        * 01200000
*   GIVEN TO THE USER EXPLAINING THE ERROR CONDITION AND A            * 01220000
*   RETURN TO THE OPERATING SYSTEM SCHEDULAR MODULE IS GIVEN.         * 01240000
*   RETURN CODE GIVEN ARE-                                            * 01260000
*   00 NORMAL TERMINATION OF A SUCCESSFUL RUN                         * 01280000
*   04 ERROR WITHIN A MEMBER- WILL TRY TO PROCESS NEXT MEMBER IF PODS * 01300000
*   12 UNRECOVERABLE ERROR- TERMINATION OF JOB.                       * 01320000
*   16 ERROR IN LABEL HANDLING IN USERS ROUTINE- TERMINATION OF JOB   * 01340000
*                                                                     * 01360000
*EXTERNAL ROUTINES- I/O HANDLED AT READ/WRITE LEVEL, GETMAIN, LINK,   * 01380000
*   BLDL, FIND, STOW USED.                                            * 01400000
*                                                                     * 01420000
*TABLES/WORK AREAS-                                                   * 01440000
*   -KEYTAB- LIST OF VALID KEY WORDS USED ON CONTROL CARDS            * 01460000
*   -COMDTABL- LIST OF VALID COMMAND WORDS USED ON CONTROL CARDS      * 01480000
*   -SWITCHRD- BUFFER CONTAINING CONTROL CARD AND SWITCHES USED       * 01500000
*   BY CARD SCAN ROUTINE.                                             * 01520000
*   -LOGOUTAR- BUFFER WHICH IS USED BY LOG OUT ROUTINE FOR MESSAGES.  * 01540000
*   -STARTAB- TABLE OF SWITCHES WHICH ARE RESET TO ZERO UPON ENTRY    * 01560000
*   TO MODULE. ALL SWITCHES NEEDING REINITIALIZATION SHOULD BE PUT    * 01580000
*   INTO THIS TABLE.                                                  * 01600000
*                                                                     * 01620000
*ATTRIBUTES- SERIAL REUSABLE, BLOCK LOADS                               01640000
*                                                                     * 01660000
*  THIS CSECT-   1. WRITES MESSAGES OR RECORDS ON SYSPRINT            * 01680000
*                2. PRINTS A TITLE ON THE TOP OF EACH PAGE AND        * 01700000
*        NUMBERS THE PAGES.                                           * 01720000
*                3. MESSAGE TO BE PRINTED IS DETERMINED BY THE CODE   * 01740000
*        IN GR11. THIS CODE CORRESPONDS TO MESSAGE NUMBER. THE        * 01760000
*        ADDRESS OF ANY CONSTANT TO BE INSERTED INTO A MESSAGE IS     * 01780000
*        PASSED IN GR7.                                               * 01800000
*                4. ADDITIONAL MESSAGES MAY BE ADDED BY ASSIGNING     * 01820000
*        THEM A UNIQUE 2 DIGIT CODE, PUTTING THE MESSAGE IN THIS      * 01840000
*        CSECT, PUTTING AN EQUATE FOR THE MESSAGE SIZE IN THIS CSECT, * 01860000
*        PUTTING AN EQUATE FOR THE MESSAGE NUMBER IN THE COMMON       * 01880000
*        DSECT- IEBUPCON, AND ADDING THE MESSAGE CONSTANT CODE AND    * 01900000
*        HANDLER TO 'MSGSTART' TABLE BEFORE LAST ENTRY OF 'FF'.       * 01920000
*                5. SYSPRINT DCB IS CONTAINED IN THIS CSECT. SYSPRINT * 01940000
*        IS OPENED WHEN CSECT1 SETS 'PRIMESW' AND GIVES CONTROL TO    * 01960000
*        THIS CSECT TO OPEN SYSPRINT AND PRINT THE INITIAL HEADER     * 01980000
*        STATEMENT. ANY ERRORS IN OPENING SYSPRINT (USER HAS FORGOTTEN* 02000000
*        THE SYSPRINT DD STATEMENT OR HAS SPECIFIED INCORRECT BLOCK-  * 02020017
*        SIZE) RESULTS IN THIS CSECT SETTING THE 'LOGBADSW' AND       * 02040017
*        RETURNING TO THE INITIAL CSECT WHICH RETURNS CONTROL TO THE  * 02060017
*        OPERATING SYSTEM WITH A CONDITION CODE OF 12 IN REGISTER 15. * 02080017
*                6. FINAL TERMINATION OF THE PROGRAM IS INITIATED BY  * 02100000
*        THIS CSECT. WHEN 'QUITALL' SWITCH IS SET, THIS CSECT GIVES   * 02120000
*        THE LAST INFORMATION MESSAGE, GIVES THE IEBUPDAT END OF JOB  * 02140000
*        MESSAGE, CLOSES THE SYSPRINT DCB, AND RETURNS CONTROL TO THE * 02160000
*        OPERATING SYSTEM.                                            * 02180000
*                                                                     * 02200000
         EJECT                                                          02220000
*     SYMBOLIC REGISTER NOTATION   GR0 - GR15                           02240000
GR0      EQU   0                                                        02260000
GR1      EQU   1                                                        02280000
GR2      EQU   2                                                        02300000
GR3      EQU   3                                                        02320000
GR4      EQU   4                       REGISTER RESERVED FOR CSECT1     02340000
GR5      EQU   5                                                        02360000
GR6      EQU   6                                                        02380000
GR7      EQU   7                                                        02400000
GR8      EQU   8                                                        02420000
GR9      EQU   9                                                        02440000
GR10     EQU   10                                                       02460000
GR11     EQU   11                                                       02480000
GR12     EQU   12                                                       02500000
GR13     EQU   13                                                       02520000
GR14     EQU   14                                                       02540000
GR15     EQU   15                                                       02560000
         ENTRY SYNADMSG                                          A27716 02570019
         SPACE 1                                                        02580000
*********************************************************************   02600000
**       THIS IS THE GENERALIZED MESSAGE WRITER WHICH INCLUDES THE      02620000
**    ABILITY TO PRINT A HEADER ON EACH PAGE WITH ASCENDING PAGE        02640000
**    NUMBERS.                                                          02660000
*********************************************************************   02680000
         SPACE 1                                                        02700000
IEBUPLOG CSECT                                                          02720000
*1101046400,060200-062320,063000-096000                            UL0H 02723017
*1101098800                                                        UL0H 02724017
*1131020200-020800,031600,032600,042200,042800,044800,114000-114200BS0H 02726017
*1131059600-059800,073400,091800-092200,103800                     BS0H 02732017
* 063100,071500-072500,097800-098000,107400-107600,114200        A27716 02732319
* 036000                                                         A31438 02732619
*                                                                A23998 02732719
* 089112                                                         A32057 02732819
* 098800,105930                                                  A34086 02732920
         EXTRN SPSYNAD                 SYSPRINT SYNAD ROUTINE    A27716 02733019
* 105930                                                         A34086 02733520
*C097600                                                       @YA02555 02733702
*C 102800,103000                                               @ZA01692 02733802
*C 035600                                                      @ZA04364 02734040
         ENTRY  CLOSEPRT  ENTRY PT FROM SYSPRINT SYNAD ROUTINE   A27716 02738202
         SAVE  (14,12)                                                  02740000
         BALR  GR2,0                   ESTABLISH BASE ADDRESS REGISTER  02760000
         USING NEXT,GR2                                                 02780000
         USING IEBUPCON,GR12           DSECT POINTER                    02800000
NEXT     ST    GR13,SAVE13X            SAVE REGISTER 13                 02820000
         LA    GR13,REGSAVE            ADDRESS OF LOG REGISTER SAVE     02840000
         CLI   ASISMSW,X'0F'           WRITE RECORD SWITCH              02860000
         BE    LOADZERO                YES- CONTINUE                    02880000
         TM    PRIMESW,X'0F'           INITIAL ENTRY AND/OR HEADER      02900000
         BC    4,HEADIT                WRITE HEADER AND STATEMENT       02920000
         BC    1,PRIMEHD               INITIAL- OPEN DCB,WRITE HEADER   02940000
         TM    QUITALL,X'0F'           LAST ENTRY TO THIS ROUTINE       02960000
         BC    4,GIVECC                YES- GIVE CONDITION CODE MESSAGE 02980000
         B     MSGSTART                SELECT MESSAGE                   03000000
MSGWRTE  MVC   LOGOUTAR(7),IEBCON      MOVE IN CONSTANT IEB5  I         03020000
         MVC   LOGOUTAR+4(2),0(GR5)    MOVE IDENTIFYING NUMBER IN       03040000
         EX    GR6,MOVEMESS            MOVE THE MESSAGE TO PRINT BUFFER 03060000
         SPACE 1                                                        03080000
LOADZERO CLI   LINECNT,LINES           IS PAGE FULL                     03100000
         BE    HEADIT                  YES- WRITE HEADER                03120000
         LA    GR5,TEXTCTL             PRINT BUFFER                     03140000
WRITELOG PUT   DCBLOGR,(GR5)            WRITE MESSAGE OR RECORD    BS0H 03160017
         IC    GR14,LINECNT            OBTAIN LINE COUNT                03180000
         LA    GR14,1(GR14)            ADD 1 TO IT                      03200000
         MVI   ASISMSW,X'00'           CLEAR WRITE RECORD SWITCH        03220000
         STC   GR14,LINECNT            STORE NEW LINE COUNT             03240000
         MVI   TEXTCTL,C' '            SET FOR SINGLE SPACE             03280000
RETURNX  MVI   LOGOUTAR,C' '           CLEAR PRINT BUFFER               03300000
         MVC   LOGOUTAR+1(119),LOGOUTAR                                 03320000
         TM    QUITALL,X'0F'           TEST IF ERROR TERMINATION        03340000
         BC    8,GOBACK                NO- NORMAL RETURN                03360000
         BC    4,CLOSEPRT              HAVE GIVEN EOJ MESSAGE CLOSE DCB 03380000
         MVI   QUITALL,X'0E'           FLAG AS EOJ MESSAGE              03400000
         B     MSG19BLD                SAVE TIME BRANCH DIRECT TO MSG   03420000
GIVECC   LH    GR6,HICONCDE            LOAD CONDITION CODE              03440000
         CVD   GR6,INCREMWA            CONVERT RETURN CODE              03460000
         UNPK  LOGOUTAR+35(8),INCREMWA(8)    UNPACK RETURN CODE         03480000
         OI    LOGOUTAR+42,X'F0'       CLEAR GARBAGE BYTE               03500000
         MVI   QUITALL,X'0F'           SET QUIT FLAG TO FORCE EOJ MSG   03520000
         B     MSG18BLD                SAVE TIME BRANCH DIRECT          03540000
CLOSEPRT CLOSE (DCBLOGR)               CLOSE MESSAGE DCB       @ZA04364 03560040
         FREEPOOL DCBLOGR                                          BS0H 03570017
         LH    GR10,HICONCDE      SAVE CONDITIE CODE             A31438 03572019
         LA    GR0,DSECTSIZ       GET SIZE OF IEBUPCON           A31438 03574019
         LR    GR1,GR12           GET ADDRESS OF IEBUPCON        A31438 03576019
         L     GR13,SAVE13        ADDRESS SUPERVISOR REGISTERS   A37865 03576421
         FREEMAIN R,LV=(0),A=(1)  FREE AREA USED BY IEBUPCON     A31438 03578019
         LR    GR15,GR10          GET CONDITIE CODE              A31438 03600019
         RETURN  (14,12),T,RC=(15)                                      03620000
GOBACK   TM    DFLG,X'10'         TEST FOR BLKSIZE ERROR         A23998 03630018
         BC    1,GIVECC           GIVE LAST MSG AND QUIT         A23998 03640018
         L     GR13,SAVE13X       RESTORE REGS RETURN TO PROG           03650018
         RETURN  (14,12)                                                03660000
         SPACE 1                                                        03680000
RESTORMS LA    GR5,SAVEMESS            BUFFER ADDRESS                   03700000
         B     WRITELOG                WRITE THE MESSAGE                03720000
HEADIT   LA    GR3,RESTORMS            RETURN FROM HEADER PRINT         03740000
         MVC   MESSBUFF(120),LOGOUTAR  SAVE TILL HEADER IS PRINTED      03760000
         B     HDRPRINT                PRINT HEADER                     03780000
PRIMEHD  LA    GR11,DCBLOGR            ADDRESS OF PRINTER DCB           03800000
         ST    GR11,DCBLOG             STORE POINTER TO DCB             03820000
         MVC   BDDNAM(8,GR11),SYSPRNTN MOVE NAME INTO DCB               03840000
         MVI   DFLG,X'00'         INITIALIZE BLKSIZE ERROR FLAG    BS0H 03850017
         OPEN  (DCBLOGR,OUTPUT)        OPEN SYSPRINT DCB                03860000
         TM    BOFLGS(GR11),X'10'      IS OPEN BIT ON                   03880000
         BZ    ANERROR                 ERROR- DCB COULD NOT BE OPENED   03900000
         TM    DFLG,X'10'               TEST FOR BLKSIZE ERROR     BS0H 03906017
         BC    1,BLKSZERR         INVALID BLKSIZE                A23998 03913018
         LA    GR3,RETURNX             RETURN FROM PRINTING HEADER      03920000
HDRPRINT MVI   PRIMESW,X'00'           CLEAR PRIME SWITCH          3628 03930015
         MVI   LOGOUTAR,C' '           CLEAR PRINT BUFFER               04080000
         MVC   LOGOUTAR+1(119),LOGOUTAR                                 04100000
         MVI   TEXTCTL,C'1'            SKIP PAGE                        04120000
         MVC   LOGOUTAR+7(5),SYSINHD   MOVE IN SYSIN REFERENCE          04140000
         MVC   LOGOUTAR+40(10),NEWMASTR MOVE IN NEW MASTER REFERENCE    04160000
         MVC   LOGOUTAR+90(17),HDSAVE  LOG REFERENCE TO IEBUPDAT        04180000
         MVC   LOGOUTAR+108(4),PAGENO  MOVE IN PAGE NUMBER              04200000
         PUT   DCBLOGR,TEXTCTL          WRITE HEADER               BS0H 04220017
         MVI   ASISMSW,X'00'           CLEAR RECORD SWITCH              04240000
         MVI   LINECNT,X'04'           HEADER + 3 SPACES INITIAL LINE 4 04260000
         PACK  PGCONVRT(8),PAGENO(4)   PACK PAGE NUMBER            3628 04262015
         CVB   GR15,PGCONVRT           CONVERT TO BINARY           3628 04264015
         LA    GR15,1(GR15)            ADD ONE TO PAGE NUMBER      3628 04266015
         CVD   GR15,PGCONVRT           CONVERT TO DECIMAL          3628 04268015
         UNPK  PAGENO(4),PGCONVRT(8)   PUT IN UPDATED PAGE NUMBER  3628 04270015
         OI    PAGENO+3,C'0'           CONVERT LAST BYTE           3628 04272015
         MVI   TEXTCTL,C'-'            SET TO TRIPLE SPACE              04300000
         BR    GR3                     RETURN TO WRITE TEXT OR GO BACK  04320000
         SPACE 1                                                        04340000
ANERROR  MVI   LOGBADSW,X'0F'          FLAG AS DCBLOGR NOT OPENED       04360000
         B     GOBACK                  RETURN                           04380000
PRINEXIT L     GR11,DCBLOG              LOAD DCB ADDRESS           BS0H 04381017
         USING IHADCB,GR11                                         BS0H 04382017
         LH    GR5,DCBBLKSI             LOAD BLOCKSIZE             BS0H 04383017
         LTR   GR5,GR5                  IS BLOCKSIZE SPECIFIED     BS0H 04384017
         BC    2,TESTSIZE               IF SO CHECK FOR MODULARITY BS0H 04385017
         MVI   DCBBLKSI+1,X'79'         INSERT BLOCKSIZE           BS0H 04386017
         BCR   15,GR14                                             BS0H 04387017
TESTSIZE SR    GR4,GR4                  TEST FOR CORRECT BLKSIZE   BS0H 04388017
         LA    GR6,121                                             BS0H 04389017
         DR    GR4,GR6                                             BS0H 04390017
         LTR   GR4,GR4                                             BS0H 04391017
         BCR   8,GR14                   IF OK RETURN               BS0H 04392017
         MVI   DFLG,X'10'               SET ERROR FLAG             BS0H 04393017
         MVI   DCBBLKSI,X'00'     CLEAR BLKSIZE                  A23998 04393618
         MVI   DCBBLKSI+1,X'79'   INSERT BLKSIZE FOR ERR MSG     A23998 04394218
         BCR   15,GR14                                             BS0H 04395017
         DROP  GR11                                                BS0H 04396017
BLKSZERR LA    GR7,SYSPRNTN       DD NAME FOR MESSAGE            A23998 04396618
         LA    GR11,NTOPMSG       NOT OPEN MSG CONSTANT          A23998 04397218
         LA    GR15,12            CONDITION CODE                 A23998 04397818
         STH   GR15,HICONCDE      RETURN CON CODE OF 12          A23998 04398418
         B     MSGSTART           SELECT MESSAGE                 A23998 04399018
         SPACE 2                                                        04400000
HDSAVE   DC    C'IEBUPDTE LOG PAGE'                                     04420000
SYSINHD  DC    C'SYSIN'                                                 04440000
NEWMASTR DC    C'NEW MASTER'                                            04460000
         DS    0F                                                       04465018
DCBLST   DC    X'85'                                               BS0H 04470017
         DC    AL3(PRINEXIT)                                       BS0H 04480017
DFLG     DS    X                        BLOCKSIZE ERROR FLAG       BS0H 04490017
PGCONVRT DC    D'0'                    BUFFER FOR CONVERTING PAGE       04500000
SAVEMESS DC    C'-'                    TRIPLE SPACE                     04520000
MESSBUFF DS    CL120                   HOLDS MESSAGE WHILE HEADER PRINT 04540000
REGSAVE  DS    18F                     SAVE REGISTERS ON ENTRY          04560000
SAVE13X  DS    F                       HOLDS REGISTER 13 FOR THIS CSECT 04580000
MOVEMESS MVC   LOGOUTAR+8(1),2(GR5)    MOVE MESSAGE TO BUFFER           04600000
LINECNT  DC    X'00'                   LINES USED                       04620000
IEBCON   DC    C'IEB8  I'                                          UL0H 04628017
TOT      DC    C'TOTALING'                                         UL0H 04633017
USERLABL DC    C'USER LABEL'                                       UL0H 04638017
IHL      DC    C'INPUT HEADER'                                     UL0H 04640017
ITL      DC    C'INPUT TRAILER'                                    UL0H 04642017
OHL      DC    C'OUTPUT HEADER'                                    UL0H 04644017
OTL      DC    C'OUTPUT TRAILER'                                   UL0H 04646017
LBLS     DC    C' LABELS.'             USER LABEL MESSAGE FRAGMENT UL0H 04650017
DUBLWORD DS    D                                                   UL0H 04654017
LINES    EQU   56                      MAXIMUM LINES/PAGE               04660000
         EJECT                                                          04680000
*   DETERMINES MESSAGE TO BE PRINTED                                  * 04700000
*          MESSAGE CODE ADDRESS + OFFSET POINTS TO CORRECT MSGBLD AREA  04720000
*                                                                     * 04740000
MSGTEST  LA    GR5,X'FF'               END OF TEST                      04760000
NEXTCODE SR    GR3,GR3                 CLEAR REGISTER                   04780000
         IC    GR3,0(GR6)              GET MESSAGE NUMBER               04800000
         CR    GR3,GR11                CORRECT MESSAGE NUMBER           04820000
         BE    THATSIT                 YES- PREPARE TO ENTER ROUTINE    04840000
         CR    GR3,GR5                 END OF TEST TABLE                04860000
         BE    GOBACK                  IGNORE- INVALID MESSAGE CODE     04880000
         LA    GR6,2(GR6)              GET NEXT CODE                    04900000
         B     NEXTCODE                TEST THE NEXT CODE               04920000
THATSIT  SR    GR3,GR3                 CLEAR REGISTER                   04940000
         IC    GR3,1(GR6)              GET DISPLACEMENT                 04960000
         B     0(GR3,GR6)              ENTER MESSAGE HANDLER            04980000
         SPACE 1                                                        05000000
MSGSTART BAL   GR6,MSGTEST             LINK TO TEST MESSAGE NUMBER      05020000
         DC    X'01'                   MESSAGE NUMBER                   05040000
         DC    AL1(MSG01-MSGSTART-4)   ADDRESS OF MESSAGE 1             05060000
         DC    X'02'                                                    05080000
         DC    AL1(MSG02-MSGSTART-6)   ADDRESS OF MESSAGE 2  SYSIN I/O  05100000
         DC    X'03'                                                    05120000
         DC    AL1(MSG03-MSGSTART-8)   ADDRESS OF MESSAGE 3 SYSUT1 I/O  05140000
         DC    X'04'                                                    05160000
         DC    AL1(MSG04-MSGSTART-10)  ADDRESS OF MESSAGE 4 SYSUT2 I/O  05180000
         DC    X'05'                                                    05200000
         DC    AL1(MSG05-MSGSTART-12)  ADDRESS OF MESSAGE 5 CONTROL ERR 05220000
         DC    X'06'                                                    05240000
         DC    AL1(MSG06-MSGSTART-14)  ADDRESS OF MESSAGE 6 SEQUENCE ER 05260000
         DC    X'07'                                                    05280000
         DC    AL1(MSG07-MSGSTART-16)  ADDRESS OF MESSAGE 7 INVALID OP  05300000
         DC    X'08'                                                    05320000
         DC    AL1(MSG08-MSGSTART-18)  ADDRESS OF MESSAGE 8 TERMINATION 05340000
         DC    X'09'                                                    05360000
         DC    AL1(MSG09-MSGSTART-20)  ADDRESS OF MESSAGE 9 SCANNING    05380000
         DC    X'10'                                                    05400000
         DC    AL1(MSG10-MSGSTART-22)  ADDRESS OF MESSAGE 10 OUT DELETE 05420000
         DC    X'11'                                                    05440000
         DC    AL1(MSG11-MSGSTART-24)  ADDRESS OF MESSAGE 11 OUT NUMBER 05460000
         DC    X'12'                                                    05480000
         DC    AL1(MSG12-MSGSTART-26)  ADDRESS OF MESSAGE 12 DIRECT WRT 05500000
         DC    X'13'                                                    05520000
         DC    AL1(MSG13-MSGSTART-28)  ADDRESS OF MESSAGE 13 DIRECT FUL 05540000
         DC    X'14'                                                    05560000
         DC    AL1(MSG14-MSGSTART-30)  ADDRESS OF MESSAGE 14 DD NO OPEN 05580000
         DC    X'15'                                                    05600000
         DC    AL1(MSG15-MSGSTART-32)  ADDRESS OF MESSAGE 15 ONLY 1 PS  05620000
         DC    X'16'                                                    05640000
         DC    AL1(MSG16-MSGSTART-34)  ADDRESS OF MESSAGE 16 NAME FOUND 05660000
         DC    X'17'                                                    05680000
         DC    AL1(MSG17-MSGSTART-36)  ADDRESS OF MESSAGE 17 NOT FOUND  05700000
         DC    X'18'                                                    05720000
         DC    AL1(MSG18-MSGSTART-38)  ADDRESS OF MESSAGE 18 CONCODE    05740000
         DC    X'19'                                                    05760000
         DC    AL1(MSG19-MSGSTART-40)  ADDRESS OF MESSAGE 19  EOJ       05780000
         DC    X'20'                                                    05800000
         DC    AL1(MSG20-MSGSTART-42)  ADDRESS OF MESSAGE 20 INPLACE 1  05820000
         DC    X'21'                                                    05840000
         DC    AL1(MSG21-MSGSTART-44)  ADDRESS OF MESSAGE 21 INVALID NM 05860000
         DC    X'22'                                                    05880000
         DC    AL1(MSG22-MSGSTART-46)  ADDRESS OF MESSAGE 22 EXIT CODE  05900000
         DC    X'23'                                                    05920000
         DC    AL1(MSG23-MSGSTART-48)  ADDRESS OF MESSAGE 23 NULL SET   05940000
         DC    X'25'                                                    06000000
         DC    AL1(MSG25-MSGSTART-50)  ADDRESS OF MESSAGE 25 PS IGNUL0H 06020017
         DC    X'26'                                               UL0H 06040017
         DC    AL1(MSG26-MSGSTART-52)  ADDRESS OF MESSAGE 26 NAME AUL0H 06060017
         DC    X'27'                                               UL0H 06080017
         DC    AL1(MSG27-MSGSTART-54)  ADDRESS OF MESSAGE 27 INVALIUL0H 06100017
         DC    X'28'                                               UL0H 06120017
         DC    AL1(MSG28-MSGSTART-56)  ADDRESS OF MESSAGE 28 BAD PAGE   06140017
         DC    X'29'                                               UL0H 06160017
         DC    AL1(MSG29-MSGSTART-58)  ADDRESS OF MESSAGE 29 DDNAMEUL0H 06180017
         DC    X'30'                                               UL0H 06190017
         DC    AL1(MSG30-MSGSTART-60)  ADDRESS OF MESSAGE 30 LRECL UNEQ 06210017
         DC    X'31'                                               3341 06226016
         DC    AL1(MSG31-MSGSTART-62)  ADDRESS OF MSG BAD DSORGS   3341 06233017
         DC    X'32'                                               UL0H 06233217
         DC    AL1(MSG32-MSGSTART-64)                              UL0H 06233417
         DC    X'33'                                               UL0H 06233617
         DC    AL1(MSG33-MSGSTART-66)                              UL0H 06233817
         DC    X'34'                                               UL0H 06234017
         DC    AL1(MSG34-MSGSTART-68)                              UL0H 06234217
         DC    X'35'                                               UL0H 06234417
         DC    AL1(MSG35-MSGSTART-70)                              UL0H 06234617
         DC    X'36'                                               UL0H 06234817
         DC    AL1(MSG36-MSGSTART-72)                              UL0H 06235017
         DC    X'37'                                               UL0H 06235217
         DC    AL1(MSG37-MSGSTART-74)                              UL0H 06235417
         DC    X'38'                                               UL0H 06235617
         DC    AL1(MSG38-MSGSTART-76)                              UL0H 06235817
         DC    X'39'                                               UL0H 06236017
         DC    AL1(MSG39-MSGSTART-78)                              UL0H 06236217
         DC    X'40'                                               UL0H 06236417
         DC    AL1(MSG40-MSGSTART-80)                              UL0H 06236617
         DC    X'41'                                               UL0H 06236817
         DC    AL1(MSG41-MSGSTART-82)                              UL0H 06237017
         DC    X'42'                                               UL0H 06237217
         DC    AL1(MSG42-MSGSTART-84)                              UL0H 06237417
         DC    X'43'                                               UL0H 06237617
         DC    AL1(MSG43-MSGSTART-86)                              UL0H 06237817
         DC    X'44'                                               UL0H 06238217
         DC    AL1(MSG44-MSGSTART-88)                              UL0H 06238617
         DC    X'45'                                               UL0H 06239017
         DC    AL1(MSG45-MSGSTART-90)                              UL0H 06239417
         DC    X'46'                                               UL0H 06239617
         DC    AL1(MSG46-MSGSTART-92)                              UL0H 06239817
         DC    X'FF'                   END OF TABLE                     06240000
         DC    X'FF'                   LAST TABLE ENTRY                 06260000
         SPACE 1                                                        06280000
MSG01    B     MSG01BLD                BLOCKSIZE NOT GIVEN OR WRONGUL0H 06290017
         SPACE 1                                                   UL0H 06300017
MSG02    B     MSG02BLD I/O ERROR ON SYSIN,SYSUT1,SYSUT2 OR SYSPRINT    06306019
*                                                                A27716 06312019
         SPACE 1                                                   UL0H 06320017
MSG03    B     MSG03BLD                I/O ERROR ON SYSUT1         UL0H 06330017
         SPACE 1                                                   UL0H 06340017
MSG04    B     MSG04BLD                I/O ERROR ON SYSUT2         UL0H 06350017
         SPACE 1                                                   UL0H 06360017
MSG05    B     MSG05BLD                CONTROL STATEMENT ERROR     UL0H 06370017
         SPACE 1                                                   UL0H 06380017
MSG06    B     MSG06BLD                STATEMENT SEQUENCE ERROR    UL0H 06390017
         SPACE 1                                                   UL0H 06400017
MSG07    B     MSG07BLD                INVALID OPERATION           UL0H 06410017
         SPACE 1                                                   UL0H 06420017
MSG08    B     MSG08BLD                TERMINATION OF MEMBER UPDATEUL0H 06430017
         SPACE 1                                                   UL0H 06440017
MSG09    B     MSG09BLD                SCANNING FOR NEXT MEMBER    UL0H 06450017
         SPACE 1                                                   UL0H 06460017
MSG10    B     MSG10BLD                NO RECORDS IN DELETE RANGE  UL0H 06470017
         SPACE 1                                                   UL0H 06480017
MSG11    B     MSG11BLD                NO RECORDS IN NUMBER RANGE  UL0H 06490017
         SPACE 1                                                   UL0H 06500017
MSG12    B     MSG12BLD                DIRECTORY WRITE ERROR       UL0H 06510017
         SPACE 1                                                   UL0H 06520017
MSG13    B     MSG13BLD                OUTPUT DIRECTORY FULL       UL0H 06530017
         SPACE 1                                                   UL0H 06540017
MSG14    B     MSG14BLD                DD NAMED CANNOT BE OPENED   UL0H 06550017
         SPACE 1                                                        06560017
MSG15    B     MSG15BLD                CANNOT PROCESS MULTIPLE PS DUL0H 06570017
         SPACE 1                                                        06580017
MSG16    CLI   ASISMSW,X'0E'           SPECIAL BLDL/FIND MESSAGE   UL0H 06590017
         LA    GR5,IEBUPD16            MESSAGE ADDRESS             UL0H 06600017
         BE    SPCMSG16                YES- SET UP MESSAGE         UL0H 06610017
         B     MSG16BLD                NAME FOUND IN DIRECTORY STOWUL0H 06620017
         SPACE 1                                                        06630017
MSG17    CLI   ASISMSW,X'0E'           SPECIAL BLDL/FIND MESSAGE   UL0H 06640017
         LA    GR5,IEBUPD17            MESSAGE ADDRESS             UL0H 06650017
         BE    SPCMSG17                YES- SET UP MESSAGE         UL0H 06660017
         B     MSG17BLD                NAME NOT FOUND STOW MESSAGE UL0H 06670017
         SPACE 1                                                   UL0H 06680017
MSG18    B     MSG18BLD                HIGHEST CONDITION CODE      UL0H 06690017
         SPACE 1                                                   UL0H 06700017
MSG19    B     MSG19BLD                EOJ MESSAGE                 UL0H 06710017
         SPACE 1                                                   UL0H 06720017
MSG20    B     MSG20BLD                ONE UPDATE INPLACE PER PASS UL0H 06730017
         SPACE 1                                                   UL0H 06740017
MSG21    B     MSG21BLD                INVALID EXIT NAME           UL0H 06750017
         SPACE 1                                                        06760017
MSG22    B     MSG22BLD                EXIT RETURN CODE ENDED JOB (UL0H 06770017
         SPACE 1                                                        06780017
MSG23    B     MSG23BLD                NULL DATA SET IDENTIFIED    UL0H 06790017
         SPACE 1                                                        06800017
         SPACE 1                                                        06810017
MSG25    B     MSG25BLD                ALIAS IGNORE SEQUENTIAL DATAUL0H 06820017
         SPACE 1                                                        06830017
MSG26    B     MSG26BLD                MEMBER NAME ALIAS STOWED AS UL0H 06840017
         SPACE 1                                                        06850017
MSG27    B     MSG27BLD                INVALID INPUT PARAMETER     UL0H 06860017
         SPACE 1                                                        06870017
MSG28    B     MSG28BLD                PAGE NUMBER PARAMETER INVALIUL0H 06880017
         SPACE 1                                                        06890017
MSG29    B     MSG29BLD                DDNAME PARAMETER IS INVALID UL0H 06900017
         SPACE 1                                                        06910017
MSG30    B     MSG30BLD                OLD AND NEW MASTER LRECL UNEUL0H 06920017
*                                                                  3341 06930017
MSG31    B     MSG31BLD            OM AND NM INCOMPATIBLE DSORGS   3341 06940017
*                                                                  3341 06950017
MSG32    B     MSG32BLD                                            UL0H 06960017
MSG33    B     MSG33BLD                                            UL0H 06970017
MSG34    B     MSG34BLD                                            UL0H 06980017
MSG35    B     MSG35BLD                                            UL0H 06990017
MSG36    B     MSG36BLD                                            UL0H 07000017
MSG37    B     MSG37BLD                                            UL0H 07010017
MSG38    B     MSG38BLD                                            UL0H 07020017
MSG39    B     MSG39BLD                                            UL0H 07030017
MSG40    B     MSG40BLD                                            UL0H 07040017
MSG41    B     MSG41BLD                                            UL0H 07050017
MSG42    B     MSG42BLD                                            UL0H 07060017
MSG43    B     MSG43BLD                                            UL0H 07070017
MSG44    B     MSG44BLD                                            UL0H 07080017
MSG45    B     MSG45BLD                                            UL0H 07090017
MSG46    B     MSG46BLD                                            UL0H 07095017
         SPACE 1                                                        07100017
MSG01BLD LA    GR5,IEBUPD01            ADDRESS OF MESSAGE          UL0H 07110017
         LA    GR6,MSG01SIZ            SIZE OF MESSAGE             UL0H 07120017
         MVC   2(2,GR5),0(GR7)         MOVE IN CT/0M/NM REFERENCE  UL0H 07130017
         B     MSGWRTE                 GIVE MESSAGE                UL0H 07140017
MSG02BLD LA    GR5,IEBUPD02                                      A27716 07150019
         LA    GR6,MSG02SIZ                                      A27716 07160019
         B     MSGWRTE                                           A27716 07170019
MSG03BLD LA    GR5,IEBUPD03                                      A27716 07180019
         LA    GR6,MSG03SIZ                                      A27716 07190019
         B     MSGWRTE                                           A27716 07200019
MSG04BLD LA    GR5,IEBUPD04                                      A27716 07210019
         LA    GR6,MSG04SIZ                                      A27716 07220019
         B     MSGWRTE                                           A27716 07230019
         B     MSGWRTE                 GIVE MESSAGE                UL0H 07260017
MSG05BLD LA    GR5,IEBUPD05            ADDRESS OF MESSAGE          UL0H 07270017
         LA    GR6,MSG05SIZ            SIZE OF MESSAGE             UL0H 07280017
         B     MSGWRTE                 GIVE MESSAGE                UL0H 07290017
MSG06BLD LA    GR5,IEBUPD06            ADDRESS OF MESSAGE          UL0H 07300017
         LA    GR6,MSG06SIZ            SIZE OF MESSAGE             UL0H 07310017
         B     MSGWRTE                 GIVE MESSAGE                UL0H 07320017
MSG07BLD LA    GR5,IEBUPD07            ADDRESS OF MESSAGE          UL0H 07330017
         LA    GR6,MSG07SIZ            SIZE OF MESSAGE             UL0H 07340017
         B     MSGWRTE                 GIVE MESSAGE                UL0H 07350017
MSG08BLD LA    GR5,IEBUPD08            ADDRESS OF MESSAGE          UL0H 07360017
         LA    GR6,MSG08SIZ            SIZE OF MESSAGE             UL0H 07370017
         B     MSGWRTE                 GIVE MESSAGE                UL0H 07380017
MSG09BLD LA    GR5,IEBUPD09            ADDRESS OF MESSAGE          UL0H 07390017
         LA    GR6,MSG09SIZ            SIZE OF MESSAGE             UL0H 07400017
         B     MSGWRTE                 GIVE MESSAGE                UL0H 07410017
MSG10BLD LA    GR5,IEBUPD10            ADDRESS OF MESSAGE          UL0H 07420017
         LA    GR6,MSG10SIZ            SIZE OF MESSAGE             UL0H 07430017
         B     MSGWRTE                 GIVE MESSAGE                UL0H 07440017
MSG11BLD LA    GR5,IEBUPD11            ADDRESS OF MESSAGE          UL0H 07450017
         LA    GR6,MSG11SIZ            SIZE OF MESSAGE             UL0H 07460017
         B     MSGWRTE                 GIVE MESSAGE                UL0H 07470017
MSG12BLD LA    GR5,IEBUPD12            ADDRESS OF MESSAGE          UL0H 07480017
         LA    GR6,MSG12SIZ            SIZE OF MESSAGE             UL0H 07490017
         B     MSGWRTE                 GIVE MESSAGE                UL0H 07500017
MSG13BLD LA    GR5,IEBUPD13            ADDRESS OF MESSAGE          UL0H 07510017
         LA    GR6,MSG13SIZ            SIZE OF MESSAGE             UL0H 07520017
         B     MSGWRTE                 GIVE MESSAGE                UL0H 07530017
MSG14BLD LA    GR5,IEBUPD14            ADDRESS OF MESSAGE          UL0H 07540017
         MVC   9(8,GR5),0(GR7)         MOVE IN DD NAME             UL0H 07550017
         LA    GR6,MSG14SIZ            SIZE OF MESSAGE             UL0H 07560017
         B     MSGWRTE                 GIVE MESSAGE                UL0H 07570017
MSG15BLD LA    GR5,IEBUPD15            ADDRESS OF MESSAGE          UL0H 07580017
         LA    GR6,MSG15SIZ            SIZE OF MESSAGE             UL0H 07590017
         B     MSGWRTE                 GIVE MESSAGE                UL0H 07600017
MSG16BLD LA    GR6,MSG16SIZ            SIZE OF MESSAGE             UL0H 07610017
         B     INSERTNM                INSERT THE NAME             UL0H 07620017
SPCMSG16 LA    GR6,MSG16ASZ            SPECIAL MESSAGE SIZE        UL0H 07630017
         B     INSERTNM                INSERT THE NAME             UL0H 07640017
SPCMSG17 LA    GR6,MSG17ASZ            SPECIAL MESSAGE SIZE        UL0H 07650017
         B     INSERTNM                INSERT THE NAME             UL0H 07660017
MSG17BLD LA    GR6,MSG17SIZ            SIZE OF MESSAGE             UL0H 07670017
INSERTNM MVC   15(8,GR5),0(GR7)        MOVE MEMBER NAME TO BUFFER  UL0H 07680017
         B     MSGWRTE                 GIVE MESSAGE                UL0H 07690017
MSG18BLD LA    GR5,IEBUPD18            ADDRESS OF MESSAGE          UL0H 07700017
         LA    GR6,MSG18SIZ            SIZE OF MESSAGE             UL0H 07710017
         B     MSGWRTE                 CONDITION CODE ALREADY IN BUUL0H 07720017
MSG19BLD LA    GR5,IEBUPD19            ADDRESS OF MESSAGE          UL0H 07730017
         LA    GR6,MSG19SIZ            SIZE OF MESSAGE             UL0H 07740017
         B     MSGWRTE                 GIVE MESSAGE                UL0H 07750017
MSG20BLD LA    GR5,IEBUPD20            ADDRESS OF MESSAGE          UL0H 07760017
         LA    GR6,MSG20SIZ            SIZE OF MESSAGE             UL0H 07770017
         B     MSGWRTE                 GIVE MESSAGE                UL0H 07780017
MSG21BLD LA    GR5,IEBUPD21            ADDRESS OF MESSAGE          UL0H 07790017
         LA    GR6,MSG21SIZ            SIZE OF MESSAGE             UL0H 07800017
         B     MSGWRTE                 GIVE MESSAGE                UL0H 07810017
MSG22BLD LA    GR5,IEBUPD22            ADDRESS OF MESSAGE          UL0H 07820017
         LA    GR6,MSG22SIZ            SIZE OF MESSAGE             UL0H 07830017
         B     MSGWRTE                 GIVE MESSAGE                UL0H 07840017
MSG23BLD LA    GR5,IEBUPD23            ADDRESS OF MESSAGE          UL0H 07850017
         LA    GR6,MSG23SIZ            SIZE OF MESSAGE             UL0H 07860017
         MVC   2(8,GR5),0(GR7)         MOVE IN DD NAME             UL0H 07870017
         B     MSGWRTE                 GIVE MESSAGE                UL0H 07880017
MSG25BLD LA    GR5,IEBUPD25            ADDRESS OF MESSAGE          UL0H 07890017
         LA    GR6,MSG25SIZ            SIZE OF MESSAGE             UL0H 07900017
         B     MSGWRTE                 GIVE MESSAGE                UL0H 07910017
MSG26BLD LA    GR5,IEBUPD26            ADDRESS OF MESSAGE          UL0H 07920017
         LA    GR6,MSG26SIZ            SIZE OF MESSAGE             UL0H 07930017
         B     MSGWRTE                 GIVE MESSAGE                UL0H 07940017
MSG27BLD LA    GR5,IEBUPD27            ADDRESS OF MESSAGE          UL0H 07950017
         LA    GR6,MSG27SIZ            SIZE OF MESSAGE             UL0H 07960017
         B     MSGWRTE                 GIVE MESSAGE                UL0H 07970017
MSG28BLD LA    GR5,IEBUPD28            ADDRESS OF MESSAGE          UL0H 07980017
         LA    GR6,MSG28SIZ            SIZE OF MESSAGE             UL0H 07990017
         B     MSGWRTE                 GIVE MESSAGE                UL0H 08000017
MSG29BLD LA    GR5,IEBUPD29            ADDRESS OF MESSAGE          UL0H 08010017
         LA    GR6,MSG29SIZ            SIZE OF MESSAGE             UL0H 08020017
         B     MSGWRTE                 GIVE MESSAGE                UL0H 08030017
MSG30BLD LA    GR5,IEBUPD30            ADDRESS OF MESSAGE          UL0H 08040017
         LA    GR6,MSG30SIZ            SIZE OF MESSAGE             UL0H 08050017
         B     MSGWRTE                 GIVE MESSAGE                UL0H 08060017
MSG31BLD LA    GR5,IEBUPD31        ADDRESS OF MESSAGE              3341 08070017
         LA    GR6,MSG31SIZ        SIZE OF MESSAGE                 3341 08080017
         B     MSGWRTE             GIVE MESSAGE                    3341 08090017
MSG32BLD LA    GR5,IEBUPD32             ADDRESS OF MESSAGE         UL0H 08110017
         LA    GR6,MSG32SIZ             SIZE OF MESSAGE            UL0H 08130017
         MVC   2(8,GR5),USERRTN         MOVE USER ROUTINE AND ADDR UL0H 08150017
         MVC   31(22,GR5),30(GR5)      CLEAN UP MESSAGE AREA       UL0H 08188017
         SR    GR10,GR10               CLEAR BRANCH REGISTE        UL0H 08258017
         IC    GR10,USERRTN+8           PICK UP ROUTINE INDICATOR  UL0H 08268017
         B     *(GR10)                  BRANCH ON THAT CONSTANT    UL0H 08278017
         B     CIHL                     INPUT HEADER ROUTINE       UL0H 08288017
         B     CITL                     INPUT TRAILER ROUTINE      UL0H 08298017
         B     COHL                     OUTPUT HEADER ROUTINE      UL0H 08308017
         B     COTL                     OUTPUT TRAILER ROUTINE     UL0H 08318017
CIHL     MVC   31(12,GR5),IHL           BUILD INPUT HEADER         UL0H 08328017
         MVC   43(8,GR5),LBLS           LABELS MESSAGE             UL0H 08338017
         B     MSGWRTE                  GIVE MESSAGE               UL0H 08348017
CITL     MVC   31(13,GR5),ITL          BUILD INPUT TRAILER         UL0H 08358017
         MVC   44(8,GR5),LBLS           LABELS MESSAGE             UL0H 08368017
         B     MSGWRTE                  GIVE MESSAGE               UL0H 08378017
COHL     MVC   31(13,GR5),OHL           BUILD OUTPUT HEADER        UL0H 08388017
         MVC   44(8,GR5),LBLS           LABELS MESSAGE             UL0H 08398017
         B     MSGWRTE                  GIVE MESSAGE               UL0H 08408017
COTL     MVC   31(14,GR5),OTL           BUILD OUTPUT TRAILER       UL0H 08418017
         MVC   45(8,GR5),LBLS           LABELS MESSAGE             UL0H 08428017
         B     MSGWRTE                  GIVE MESSAGE               UL0H 08438017
MSG33BLD LA    GR5,IEBUPD33             ADDRESS OF MESSAGE         UL0H 08448017
         LA    GR6,MSG33SIZ             SIZE OF MESSAGE            UL0H 08458017
         SR    GR7,GR7                                             UL0H 08468017
         IC    GR7,USERCONT             NUMBER OF ENTRANCES TO USERUL0H 08478017
         CVD   GR7,DUBLWORD             CONVERT NO. TO DECIMAL     UL0H 08488017
         UNPK  2(1,GR5),DUBLWORD+7(1)   AND UNPACK IT              UL0H 08498017
         OI    2(GR5),X'F0'             SO THAT IT CAN BE PRINTED  UL0H 08508017
         MVC   17(8,GR5),USERRTN        MOVE USER RTN NAME TO MSG  UL0H 08518017
         B     MSGWRTE                  GIVE MESSAGE               UL0H 08528017
MSG34BLD LA    GR5,IEBUPD34             ADDRESS OF MESSAGE         UL0H 08538017
         LA    GR6,MSG34SIZ             SIZE OF MESSAGE            UL0H 08548017
         MVC   24(8,GR5),USERRTN        MOVE USER RTN NAME TO MSG  UL0H 08558017
         SR    GR7,GR7                                             UL0H 08568017
         IC    GR7,LBLRETCD             PICK UP USER RETURN CODE   UL0H 08578017
         CVD   GR7,DUBLWORD             CONVERT RETURN CODE        UL0H 08588017
         UNPK  37(3,GR5),DUBLWORD+6(2)  TO DECIMAL AND UNPAKE IT   UL0H 08598017
         OI    39(GR5),X'F0'            SO THAT IT CAN BE PRINTED  UL0H 08608017
         B     MSGWRTE                  GIVE MESSAGE               UL0H 08618017
MSG35BLD LA    GR5,IEBUPD35             ADDRESS OF MESSAGE         UL0H 08628017
         LA    GR6,MSG35SIZ             SIZE OF MESSAGE            UL0H 08638017
         B     *(GR7)                   GO TO PROPER BUILD ROUTINE UL0H 08648017
         B     TOTLS                    TOTALING BUILD MESSAGE     UL0H 08658017
         B     USRLBLS                  USER LABEL BUILD MSG       UL0H 08668017
TOTLS    MVC   4(8,GR5),TOT             MOVE IN TOTAL KEYWORD      UL0H 08678017
         B     MSGWRTE                  GIVE  MESSAGE              UL0H 08688017
USRLBLS  MVC   2(10,GR5),USERLABL       USER LABELS KEY WORD       UL0H 08698017
         B     MSGWRTE                  GIVE MESSAGE               UL0H 08708017
MSG36BLD LA    GR5,IEBUPD36             ADDRESS OF MESSAGE         UL0H 08718017
         LA    GR6,MSG36SIZ             MESSAGE SIZE               UL0H 08728017
         B     MSGWRTE                  GIVE MESSAGE               UL0H 08738017
MSG37BLD LA    GR5,IEBUPD37             ADDRESS OF MESSAGE         UL0H 08748017
         LA    GR6,MSG37SIZ             SIZE OF MESSAGE            UL0H 08758017
         B     MSGWRTE                  GIVE MESSAGE               UL0H 08768017
MSG38BLD LA    GR5,IEBUPD38             ADDRESS OF MESSAGE         UL0H 08778017
         LA    GR6,MSG38SIZ             SIZE OF MESSAGE            UL0H 08788017
         SR    GR7,GR7                                             UL0H 08798017
         IC    GR7,USYSNCNT             NUMBER OF LABELS CREATED   UL0H 08808017
         CVD   GR7,DUBLWORD             CONVERT TO DECIMAL         UL0H 08818017
         UNPK  2(1,GR5),DUBLWORD+7(1)   AND UNPAKE FOR PRINTING    UL0H 08828017
         B     MSGWRTE                  GIVE MESSAGE               UL0H 08838017
MSG39BLD LA    GR5,IEBUPD39             ADDRESS OF MESSAGE         UL0H 08848017
         LA    GR6,MSG39SIZ             MESSAGE SIZE               UL0H 08858017
         MVC   2(8,GR5),TOTALRTN        USER TOTAL ROUTINE NAME    UL0H 08868017
         B     MSGWRTE                  GIVE MESSAGE               UL0H 08878017
MSG40BLD LA    GR5,IEBUPD40             ADDRESS OF MESSAGE         UL0H 08888017
         LA    GR6,MSG40SIZ             SIZE OF MESSAGE            UL0H 08898017
         MVC   2(8,GR5),TOTALRTN        USER TOTAL ROUTINE NAME    UL0H 08908017
         SR    GR7,GR7                 PREPARE FOR HALF A LOAD     000H 08908818
         LH    GR7,TOTRTNCD            LOAD TOTAL RETURN CODE      000H 08909618
         CVD   GR7,DUBLWORD            CONVERT IT TO DECIMAL       000H 08910418
         UNPK  DUBLWORD+5(3),DUBLWORD+6(2)   PREPARE CODE        A32057 08910919
         OI    DUBLWORD+7,X'F0'        FIX SIGN TO PRINT OUT     A32057 08911419
         CLI   DUBLWORD+5,X'00'        IS CODE 3 CHARS LONG        000H 08912018
         BNE   RTNCD3L                 IF SO, MOVE TO MESSAGE      000H 08912818
         MVI   DUBLWORD+5,C' '         IF NOT, BLANK OUT THE ZERO  000H 08913618
         CLI   DUBLWORD+6,X'00'        IS CODE 2 CHARS LONG        000H 08914418
         BNE   RTNCD3L                 IF SO, MOVE TO MESSAGE      000H 08915218
         MVI   DUBLWORD+6,C' '         IF NOT, BLANK OUT THE ZERO  000H 08916018
RTNCD3L  MVC   IEBUPD40+71(3),DUBLWORD+5        MOVE RETURN CODE TO000H 08916818
         B     MSGWRTE                  GIVE MESSAGE               UL0H 08918017
MSG41BLD LA    GR5,IEBUPD41             ADDRESS OF MESSAGE         UL0H 08928017
         LA    GR6,MSG41SIZ             SIZE OF MESSAGE            UL0H 08938017
         MVC   27(8,GR5),TOTALRTN      USER TOTAL ROUTINE NAME     ULOH 08948018
         B     MSGWRTE                  GIVE MESSAGE               UL0H 08958017
MSG42BLD LA    GR5,IEBUPD42             ADDRESS OF MESSAGE         UL0H 08968017
         LA    GR6,MSG42SIZ             SIZE OF MESSAGE            UL0H 08978017
         B     MSGWRTE                  GIVE MESSAGE               UL0H 08988017
MSG43BLD LA    GR5,IEBUPD43             ADDRESS OF MESSAGE         UL0H 08998017
         LA    GR6,MSG43SIZ             SIZE OF MESSAGE            UL0H 09008017
         B     MSGWRTE                  GIVE MESSAGE               UL0H 09018017
MSG44BLD LA    GR5,IEBUPD44             ADDRESS OF MESSAGE         UL0H 09028017
         LA    GR6,MSG44SIZ             SIZE OF MESSAGE            UL0H 09038017
         B     COMMONBD                COMMON BUILD ROUTINE FOR 445UL0H 09614117
MSG45BLD LA    GR5,IEBUPD45             ADDRESS OF MESSAGE         UL0H 09614417
         LA    GR6,MSG45SIZ             SIZE OF MESSAGE            UL0H 09614717
COMMONBD SR    GR10,GR10               CLEAR BRANCH REGISTER       UL0H 09615117
         IC    GR10,USERRTN+8          PICK UP BRANCH CONSTANT     UL0H 09615517
         B     *(GR10)                 BRANCH ON CONSTANT          UL0H 09615917
         B     NOHEADER                BUILD NO HEADER LABEL MSG   UL0H 09616317
         B     NOTRALER                BUILD NO TRAILER LABEL MSG  UL0H 09616717
         B     NOHEADER                BUILD NO KEADER LABEL MSG   UL0H 09617117
         B     NOTRALER                BUILD NO TRAILER LABEL MSG  UL0H 09617517
NOHEADER MVC   10(7,GR5),IHL+5         PICK UP 'HEADER'            UL0H 09617917
         B     MSGWRTE                  GIVE MESSAGE               UL0H 09618317
NOTRALER MVC   10(7,GR5),ITL+6         PICK UP 'TRAILER'           UL0H 09618717
         B     MSGWRTE                  GIVE MESSAGE               UL0H 09618917
MSG46BLD LA    GR5,IEBUPD46             ADDRESS OF MESSAGE         UL0H 09619117
         LA    GR6,MSG46SIZ             SIZE OF MESSAGE            UL0H 09619317
         B     MSGWRTE                  GIVE MESSAGE               UL0H 09619517
*                                                                     * 09620000
*                                 IEBUPDTE MESSAGES                   * 09640000
*   ALL MESSAGES ARE PRECEDED BY CONSTANT OF IEB5XXI WHERE XX IS EQUAL* 09660000
*   TO THE FIRST TWO NUMBERS IN EACH MESSAGE LISTED BELOW.  THE LOG   * 09680000
*   ROUTINE 'MSGWRTE' BUILDS THE PROPER CODE FOR EACH MESSAGE.        * 09700000
*                                                                     * 09720000
         SPACE 1                                                        09740000
IEBUPD01 DC    CL36'01CT LRECL AND BLKSIZE ASSUMED 80/80'      @YA02555 09760002
IEBUPD02 DC    CL2'02'  I/O ERROR MESSAGE                        A27716 09768019
         DC    CL10'I/O ERROR '                                  A27716 09776019
SYNADMSG DC    CL80' '      THE PART OF THE I/O ERROR MSG BUILT  A27716 09784019
*                        DYNAMICALLY BY THE SYNADAF ROUTINE      A27716 09792019
IEBUPD03 DC    CL37'03PERMANENT INPUT ERROR - FIND MACRO'        A27716 09800019
IEBUPD04 DC    CL37'04PERMANENT INPUT ERROR - BLDL MACRO'        A27716 09808019
IEBUPD05 DC    CL26'05CONTROL STATEMENT ERROR.'                         09820000
IEBUPD06 DC    CL27'06STATEMENT SEQUENCE ERROR.'                        09840000
IEBUPD07 DC    CL20'07INVALID OPERATION.'                               09860000
IEBUPD08 DC    CL34'08TERMINATED THIS MEMBER. IEBUPDTE'          A34086 09880020
         DC    CL22' WILL TRY NEXT MEMBER.'                             09900000
IEBUPD09 DC    CL26'09SCANNING FOR NEXT MEMBER'                         09920000
IEBUPD10 DC    C'10DELETE RANGE INVALID'                                09940000
IEBUPD11 DC    C'11NUMBER RANGE INVALID'                                09960000
IEBUPD12 DC    CL24'12DIRECTORY WRITE ERROR.'                           09980000
IEBUPD13 DC    CL24'13OUTPUT DIRECTORY FULL.'                           10000000
IEBUPD14 DC    C'14DDNAME         CANNOT BE '                           10020000
         DC    C'OPENED.'                                               10040000
IEBUPD15 DC    CL30'15CANNOT PROCESS MORE THAN ONE'                     10060000
         DC    CL22' PS DATA SET PER PASS.'                             10080000
IEBUPD16 DC    C'16MEMBER NAME (        ) FOUND '                       10100000
IEBUP16A DC    C'IN NM DIRECTORY. '    MEMBER IN OM DIRECTORY BAD 4 ADD 10120000
         DC    C'TTR IS NOW ALTERED.'                                   10140000
IEBUPD17 DC    C'17MEMBER NAME (        ) NOT '                         10160000
         DC    C'FOUND '                                                10180000
IEBUP17A DC    C'IN NM DIRECTORY.  STOWED '  MEMBER NOT FOUND BAD CHANG 10200000
         DC    C'WITH TTR.'                                             10220000
IEBUPD18 DC    CL28'18HIGHEST CONDITION CODE WAS'                       10240000
IEBUPD19 DC    C'19END OF JOB IEBUPDTE.'                                10260000
IEBUPD20 DC    C'20CANNOT PROCESS MORE THAN ONE FUNCTION'      @ZA01692 10280002
         DC    C' STMT WHEN UPDATE INPLACE IS SPECIFIED.'      @ZA01692 10300002
IEBUPD21 DC    CL32'21 INVALID EXIT NAME. JOB ENDED.'                   10320000
IEBUPD22 DC    C'22EXIT RETURN CODE ENDED JOB.'                         10340000
IEBUPD23 DC    CL26'23         HAS NO RECORDS.'                         10360000
IEBUPD25 DC    C'25ALIAS IGNORED- SEQUENTIAL DATA'                      10400000
         DC    C' SET.'                                                 10420000
IEBUPD26 DC    C'26MEMBER NAME FOUND IN OM '                            10440000
         DC    C'DIRECTORY AS AN ALIAS- CHANGED '                       10460000
         DC    C'TO TRUE NAME IN NM DIRECTORY.'                         10480000
IEBUPD27 DC    CL26'27INVALID INPUT PARAMETER.'                         10500000
IEBUPD28 DC    CL32'28PAGE NUMBER PARAMETER INVALID.'                   10520000
IEBUPD29 DC    CL32'29DDNAME PARAMETER IS INVALID.  '                   10540000
IEBUPD30 DC    C'30OLD AND NEW MASTER LRECL '                           10560000
         DC    C'UNEQUAL.'                                              10580000
IEBUPD31 DC    C'31 OLD AND NEW MASTER DSORGS INCOMPATIBLE'        3341 10590016
IEBUPD32 DC    CL31'32          IS PROCESSING USER '               UL0H 10590217
         DC    CL23' '                                             UL0H 10590617
IEBUPD33 DC    CL26'33  ENTRANCES TO         .'                    UL0H 10591017
IEBUPD34 DC    CL32'34LAST RETURN CODE FROM         '              UL0H 10591417
         DC    CL9' WAS    .'                                      UL0H 10591817
IEBUPD35 DC    CL42'35           SUPPORT ONLY ON PS DATA SETS.'    UL0H 10592217
IEBUPD36 DC    CL44'36TRAILER LABEL PROCESSING NOT SUPPORTED FOR'  UL0H 10592617
         DC    CL15' UPDATE=INPLACE'                             A34086 10593120
IEBUPD37 DC    CL41'37I/O ERROR WHILE PROCESSING USER LABELS.'     UL0H 10593717
IEBUPD38 DC    CL40'38  LABELS CREATED FROM INPUT STREAM.'         UL0H 10594117
IEBUPD39 DC    CL36'39         IS TAKING TOTALING EXITS.'          UL0H 10594517
IEBUPD40 DC    CL44'40         REQUESTED TERMINATION OF TOTALING'  UL0H 10594917
         DC    CL31' EXITS WITH RETURN CODE OF    .'               OOOH 10595318
IEBUPD41 DC    CL37'41INVALID RETURN CODE FROM         ,'          UL0H 10595717
         DC    CL28'TOTALING EXITS DISCONTINUED.'                  UL0H 10596117
IEBUPD42 DC    CL34'42TOTALING EXITS NOT SUPPORTED FOR'            UL0H 10596517
         DC    CL24' UPDATE=INPLACE.'                              ULOH 10596918
IEBUPD43 DC    CL20'43INVALID CORE SIZE.'                          UL0H 10597317
IEBUPD44 DC    CL25'44NO USER         LABELS '                     UL0H 10597717
         DC    CL24'EXIST ON INPUT DATA SET.'                      UL0H 10598117
IEBUPD45 DC    CL25'45NO USER         LABELS '                     UL0H 10598517
         DC    CL27'CREATED ON OUTPUT DATA SET.'                   UL0H 10598917
IEBUPD46 DC    CL34'46ALIAS IGNORED FOR UPDATE=INPLACE'            UL0H 10599417
IEBLASTM EQU   *                       KEEP EQUATE AFTER LAST MESSAGE   10600000
         EJECT                                                          10620000
*  TABLE OF SIZES OF MESSAGES                                         * 10640000
*      SIZE IS EQUAL TO TOTAL MESSAGE SIZE - 2 BYTES FOR THE INITIAL  * 10660000
*  MESSAGE NUMBER CODE - 1 BYTE SO COUNT WILL BE CORRECT FOR EXECUTE  * 10680000
*  WHICH MOVES THE MESSAGE TO THE PRINT BUFFER IN 'MSGWRTE' ROUTINE.  * 10700000
         SPACE 1                                                        10720000
MSG01SIZ EQU   IEBUPD02-IEBUPD01-3    SIZE OF MESSAGE 1          A27716 10730019
MSG02SIZ EQU   IEBUPD03-IEBUPD02-3    SIZE OF MESSAGE 2          A27716 10740019
MSG03SIZ EQU   IEBUPD04-IEBUPD03-3    SIZE OF MESSAGE 3          A27716 10750019
MSG04SIZ EQU   IEBUPD05-IEBUPD04-3    SIZE OF MESSAGE 4          A27716 10760019
MSG05SIZ EQU   IEBUPD06-IEBUPD05-3     SIZE OF MESSAGE 5                10780000
MSG06SIZ EQU   IEBUPD07-IEBUPD06-3     SIZE OF MESSAGE 6                10800000
MSG07SIZ EQU   IEBUPD08-IEBUPD07-3     SIZE OF MESSAGE 7                10820000
MSG08SIZ EQU   IEBUPD09-IEBUPD08-3     SIZE OF MESSAGE 8                10840000
MSG09SIZ EQU   IEBUPD10-IEBUPD09-3     SIZE OF MESSAGE 9                10860000
MSG10SIZ EQU   IEBUPD11-IEBUPD10-3     SIZE OF MESSAGE 10               10880000
MSG11SIZ EQU   IEBUPD12-IEBUPD11-3     SIZE OF MESSAGE 11               10900000
MSG12SIZ EQU   IEBUPD13-IEBUPD12-3     SIZE OF MESSAGE 12               10920000
MSG13SIZ EQU   IEBUPD14-IEBUPD13-3     SIZE OF MESSAGE 13               10940000
MSG14SIZ EQU   IEBUPD15-IEBUPD14-3     SIZE OF MESSAGE 14               10960000
MSG15SIZ EQU   IEBUPD16-IEBUPD15-3     SIZE OF MESSAGE 15               10980000
MSG16SIZ EQU   IEBUPD17-IEBUPD16-3     SIZE OF MESSAGE 16               11000000
MSG17SIZ EQU   IEBUPD18-IEBUPD17-3     SIZE OF MESSAGE 17               11020000
MSG18SIZ EQU   IEBUPD19-IEBUPD18-3     SIZE OF MESSAGE 18               11040000
MSG19SIZ EQU   IEBUPD20-IEBUPD19-3     SIZE OF MESSAGE 19               11060000
MSG20SIZ EQU   IEBUPD21-IEBUPD20-3     SIZE OF MESSAGE 20               11080000
MSG21SIZ EQU   IEBUPD22-IEBUPD21-3     SIZE OF MESSAGE 21               11100000
MSG22SIZ EQU   IEBUPD23-IEBUPD22-3     SIZE OF MESSAGE 22               11120000
MSG23SIZ EQU   IEBUPD25-IEBUPD23-3     SIZE OF MESSAGE 23          BS0H 11150017
MSG25SIZ EQU   IEBUPD26-IEBUPD25-3     SIZE OF MESSAGE 25               11180000
MSG26SIZ EQU   IEBUPD27-IEBUPD26-3     SIZE OF MESSAGE 26               11200000
MSG27SIZ EQU   IEBUPD28-IEBUPD27-3     SIZE OF MESSAGE 27               11220000
MSG28SIZ EQU   IEBUPD29-IEBUPD28-3     SIZE OF MESSAGE 28               11240000
MSG29SIZ EQU   IEBUPD30-IEBUPD29-3     SIZE OF MESSAGE 29               11260000
MSG30SIZ EQU   IEBUPD31-IEBUPD30-3      SIZE OF MESSAGE 30         3341 11270016
MSG31SIZ EQU   IEBUPD32-IEBUPD31-3                                 UL0H 11271017
MSG32SIZ EQU   IEBUPD33-IEBUPD32-3                                 UL0H 11272017
MSG33SIZ EQU   IEBUPD34-IEBUPD33-3                                 UL0H 11273017
MSG34SIZ EQU   IEBUPD35-IEBUPD34-3                                 UL0H 11274017
MSG35SIZ EQU   IEBUPD36-IEBUPD35-3                                 UL0H 11275017
MSG36SIZ EQU   IEBUPD37-IEBUPD36-3                                 UL0H 11276017
MSG37SIZ EQU   IEBUPD38-IEBUPD37-3                                 UL0H 11277017
MSG38SIZ EQU   IEBUPD39-IEBUPD38-3                                 UL0H 11278017
MSG39SIZ EQU   IEBUPD40-IEBUPD39-3                                 UL0H 11279017
MSG40SIZ EQU   IEBUPD41-IEBUPD40-3                                 UL0H 11280017
MSG41SIZ EQU   IEBUPD42-IEBUPD41-3                                 UL0H 11281017
MSG42SIZ EQU   IEBUPD43-IEBUPD42-3                                 UL0H 11282017
MSG43SIZ EQU   IEBUPD44-IEBUPD43-3                                 UL0H 11283017
MSG44SIZ EQU   IEBUPD45-IEBUPD44-3                                 UL0H 11284017
MSG45SIZ EQU   IEBUPD46-IEBUPD45-3                                 UL0H 11289017
MSG46SIZ EQU   IEBLASTM-IEBUPD46-3                                 UL0H 11294017
         SPACE 3                                                        11300000
MSG16ASZ EQU   IEBUP16A-IEBUPD16-3     SPECIAL BLDL/FIND ERROR MESSAGE  11320000
MSG17ASZ EQU   IEBUP17A-IEBUPD17-3     SPECIAL BLDL/FIND ERROR MESSAGE  11340000
         EJECT                                                          11360000
*  SYSPRINT DCB    WRITES THE LOG                                       11380000
DCBLOGR  DCB   DSORG=PS,MACRF=(PM),DDNAME=SYSPRINT,RECFM=FBA,      BS0H*11400017
               LRECL=121,EXLST=DCBLST,SYNAD=SPSYNAD              A27716 11420019
         EJECT                                                          11440000
         IEBUPCON                                                       11460000
         EJECT                                                          11480000
         DCBD  DSORG=PS                                                 11500000
BDDNAM   EQU   DCBDDNAM-IHADCB         DD NAME IN DCB 'BEFORE' OPEN     11520000
BOFLGS   EQU   DCBOFLGS-IHADCB         OPEN ERROR FIELD IN DCB          11540000
         END   IEBUPLOG                                                 11560000
./  ADD  SSI=60090058,NAME=IEBUPNIT
*********************************************************************** 00003017
*                   *****        I E B U P N I T       *****          * 00006017
* TITLE.  IEBUPNIT. INITIALIZATION CSECT                              * 00009017
*                                                                     * 00012017
* STATUS. CHANGE LEVEL 000                                            * 00015017
*                                                                     * 00018017
* FUNCTION/OPERATION.                                                 * 00021017
*        THIS CSECT (IEBUPNIT) WILL PERFORM THE FOLLOWING FUNCTIONS   * 00024017
*        IN THE ORDER INDICATED.                                      * 00027017
*                                                                     * 00030017
*        1.    INITIALIZE THE COMMUNICATION REGION IEBUPCON, THE      * 00033017
*              DCB'S AND THE ASSOCIATED EXIT LISTS.                   * 00036017
*                                                                     * 00039017
*        2.    ANALYZE THE INVOCATION OR EXECUTION PARAMETERS.        * 00042017
*                                                                     * 00045017
*        3.    OPEN THE INPUT DATA SET SYSIN.                         * 00048017
*                                                                     * 00051017
* ENTRY POINTS.                                                       * 00054017
*        ENTERED FROM IEBUPDTE AT 'IEBUPNIT'.                         * 00057017
*                                                                     * 00060017
* INPUT.                                                              * 00063017
*        THE INPUT PARAMETERS ASSOCIATED WITH THE INPUT DATA SET      * 00066017
*        SYSIN.                                                       * 00069017
*                                                                     * 00072017
* OUTPUT.                                                             * 00075017
*        CONTROL IS PASSED TO IEBUPLOG TO PRINT THE INITIAL HEADING,  * 00078017
*        THE INITIALIZED COMMUNICATION REGION IEBUPCON.               * 00081017
*                                                                     * 00084017
* EXITS-NORMAL-.                                                      * 00087017
*        1.    DCB AND USER HEADER LABEL EXITS ARE TAKEN WHEN THE     * 00090017
*              SYSIN DATA SET IS OPENNED.                             * 00093017
*                                                                     * 00096017
*        2.    CONTROL IS RETURNED TO IEBUPDTE AFTER SYSIN HAS BEEN   * 00099017
*              OPENNED.                                               * 00102017
*                                                                     * 00105017
* EXITS-ERROR-.                                                       * 00108017
*        IF AN ERROR OCCURRES DURING PARAMETER ANALYSIS OR OPEN A     * 00111017
*        MESSAGE IS GIVEN TO THE USER EXPLAINING THE ERROR AND A      * 00114017
*        RETURN TO THE OPERATING IS GIVEN WITH AN APPROPRIATE         * 00117017
*        RETURN CODE.                                                 * 00120017
*                                                                     * 00123017
*        RETURN CODES ISSUED BY THIS CSECT ARE:                       * 00126017
*              12   UNRECOVERABLE  ERROR-TERMINATION OF JOB.          * 00129017
*              16   ERROR IN LABEL HANDLING INDICATED BY USER-        * 00132017
*                   TERMINATION OF JOB.                               * 00135017
*                                                                     * 00138017
* EXTERNAL ROUTINES.                                                  * 00141017
*        IEBUPLOG- WHICH PRINTS HEADINGS AND ERROR MESSAGES.          * 00144017
*                                                                     * 00147017
*        IEBUPXIT- WHICH CONTAINS THE DCB AND USER HEADER LABEL       * 00150017
*              EXIT ROUTINES.                                         * 00153017
*                                                                     * 00156017
* TABLES/WORK AREAS.                                                  * 00159017
*        IEBUPCON- THE COMMUNICATION REGION.                          * 00162017
*                                                                     * 00165017
* ATTRIBUTES.                                                         * 00168017
*        SERIALLY REUSABLE AND BLOCK LOADS.                           * 00171017
*                                                                     * 00174017
*********************************************************************** 00177017
IEBUPNIT CSECT                                                          00200017
         EXTRN OMERROUT                                                 00400017
         EXTRN NMERROUT                                                 00600017
         EXTRN CTERROUT                                                 00800017
         EXTRN OMEOD                                                    01000017
         EXTRN EODCT                                                    01200017
         EXTRN OMHDREXT                                                 01220017
         EXTRN OMTRLEXT                                                 01240017
         EXTRN OMDCBEX                                                  01260017
         EXTRN NMHDREXT                                                 01280017
         EXTRN NMTRLEXT                                                 01300017
         EXTRN NMDCBEX                                                  01320017
         EXTRN CTHDREXT                                                 01340017
         EXTRN CTTRLEXT                                                 01360017
         EXTRN CTDCBEX                                                  01380017
         EJECT                                                          01400017
*     SYMBOLIC REGISTER NOTATION   GR0 - GR15                           01600017
GR0      EQU   0                                                        01800017
GR1      EQU   1                                                        02000017
GR2      EQU   2                                                        02200017
GR3      EQU   3                                                        02400017
GR4      EQU   4              REGISTER RESERVED FOR IEBUPXIT            02600017
GR5      EQU   5                                                        02800017
GR6      EQU   6                                                        03000017
GR7      EQU   7                                                        03200017
GR8      EQU   8                                                        03400017
GR9      EQU   9                                                        03600017
GR10     EQU   10                                                       03800017
GR11     EQU   11                                                       04000017
GR12     EQU   12             REGISTER RESERVED FOR IEBUPCON            04200017
GR13     EQU   13                                                       04400017
GR14     EQU   14                                                       04600017
GR15     EQU   15                                                       04800017
         SPACE 1                                                        05000017
         SAVE  (14,12)                                                  05200017
         BALR  GR2,0                                                    05400017
         USING *,GR2                                                    05600017
         USING IEBUPCON,GR12           POINTER TO DSECT AREA            05800017
         L     GR4,IEBEXITS   ESTABLISH ADDRESSABILITY FOR              05900017
*                                     IEBUPXIT                          06000017
         SPACE 1                                                        06200017
         ST    GR4,36(13)    STORE FOR PERMANEMT USE FOR IEBUPXIT BASE  06600017
         LR    GR10,GR1                                                 07000017
         ST    GR13,SAVE13X                                             07300017
         LA    GR13,SAVEREG            ADDRESS OF THIS CSECT SAVE AREA  07600017
         MVC   MAXSIZEL(2),EIGHTY      INITIALIZE RECORD SIZE (LRECL)   07800017
         MVI   LOGOUTAR,C' '                                            08000017
         MVC   LOGOUTAR+1(119),LOGOUTAR BLANKS INTO LOG OUT AREA        08200017
*                                                                       08400017
*    RESET SWITCHES AND WORK AREAS, SET FIRST ENTRY SWITCH              08600017
*                                                                       08800017
         LA    GR6,SIZETAB             SIZE OF SWITCH TABLE TO CLEAR    09000017
         MVC   PAGENO(4),ONEHEX        CLEAR PAGE NUMBER           3628 09200017
         EX    GR6,XCINSTR             RESET ALL SWITCHES TO ZERO       09400017
         MVI   FIRSENTR,BIT10          SET FIRST ENTRY SWITCH           09600017
         MVI   SOURCECD,X'FF'          INITIALIZE SOURCE BUFFER         09800017
         MVC   LRECL(2),MAXSIZEL       INITIALIZE LRECL TO 80 IN CASE   10000017
         MVI   LEVELXX,C'0'            INITIALIZE LEVEL BUFFER          10200017
         XC    DELTSEQ1(32),DELTSEQ1   CLEAR DELETE AND NUMBER SEQ      10400017
         XC    NMWRITEP(4),NMWRITEP  CLEAR NM BUFFER ADDRESS     PTM223 10460017
         XC    OMREADP(4),OMREADP  CLEAR OM BUFFER ADDRASS       PTM223 10520017
         LA    GR3,USERHDR             ADDRESS OF USER HEADER BUFFER    10600017
         ST    GR3,USRHDPTR            STORE POINTER IN COMMON AREA     10800017
         LA    GR5,USERTLR             ADDRESS OF USER TRAILER BUFFER   11000017
         ST    GR5,USRTRPTR            STORE POINTER IN COMMON AREA     11200017
         SPACE 1                                                        11400017
*                                                                       11600017
*    ROUTINE TO INITIALIZE DCB'S FOR RE-USABILITY                       11800017
* INCLUDING DDNAMES, SYSIN BLOCKSIZE, DATA SET TYPE AND USER TRLR EXIT  12000017
*                                                                       12200017
         MVC   SYSINNM(32),SYSINDC     MOVE DD NAMES TO BUFFER          12400017
         LA    GR11,DCBCTR             ADDRESS OF SYSIN DCB             12600017
         ST    GR11,DCBCT              POINTER TO SYSIN DCB             12800017
         MVC   BDDNAM(8,GR11),SYSINDC  MOVE DDNAME INTO DCB (SYSIN)     13000017
         MVC   BBLKSI(2,GR11),ZERO     CLEAR BLOCKSIZE IN DCB           13200017
         MVI   CTEXITS,X'00'            DEACTIVATE SYSIN HEADER EXT000I 13400017
         MVI   CTEXITS+4,X'00'          DEACTIVATE SYSIN TRALER EXT000I 13600017
         MVI   CTEXITS+8,X'85'          SYSIN DCB EXIT ALWAYS ACTVE000I 13800017
         LA    GR11,DCBOMR             ADDRESS OF SYSUT1 DCB            14000017
         ST    GR11,DCBOM              POINTER TO SYSUT1 DCB            14200017
         MVC   BBLKSI(2,GR11),ZERO     CLEAR BLOCKSIZE IN DCB           14400017
         MVC   BDSORG(2,GR11),ZERO     CLEAR DATA SET CHARACTERISTICS   14600017
         MVC   BLRECL(2,GR11),ZERO     CLEAR LOGICAL RECORD LENGTH DCB  14800017
         MVC   BDDNAM(8,GR11),SYSUT1DC MOVE DDNAME INTO DCB (SYSUT1)    15000017
         MVI   OMEXITS,X'01'            ACTIVATE SYSUT1 HEADER EXIT000I 15200017
         MVI   OMEXITS+4,X'03'          ACTIVATE SYSUT1 TRALER EXIT000I 15400017
         MVI   OMEXITS+12,X'85'        SYSUT1 DCB EXIT=ACTV/LAST   000I 15600017
         MVI   OMEXITS+16,X'07'        ACTVATE SYSUT1 JFCB EXIT    000I 15800017
         LA    GR11,DCBNMR             ADDRESS OF SYSUT2 DCB            16000017
         ST    GR11,DCBNM              POINTER TO SYSUT2 DCB            16200017
         MVC   BDSORG(2,GR11),ZERO     CLEAR DATA SET CHARACTERISTICS   16400017
         MVC   BLRECL(2,GR11),ZERO     CLEAR LOGICAL RECORD LENGTH DCB  16600017
         MVC   BBLKSI(2,GR11),ZERO     CLEAR BLOCKSIZE IN DCB           16800017
         MVC   BDDNAM(8,GR11),SYSUT2DC MOVE DDNAME INTO DCB (SYSUT2)    17000017
         MVI   NMEXITS,X'02'            ACTIVATE SYSUT2 HEADER EXIT000I 17200017
         MVI   NMEXITS+4,X'04'          ACTIVATE SYSUT2 TRALER EXIT000I 17400017
         MVI   NMEXITS+8,X'00'          DEACTIVATE TOTALING EXIT   000I 17600017
         MVI   NMEXITS+12,X'85'         ACTIVATE/LAST SYSUT2 DCB EX000I 17800017
         MVI   NMEXITS+16,X'07'         ACTIVATE SYSUT2 JFCB EXIT  000I 18000017
         L     GR5,0(GR10)             LOAD ADDRESS OF FIRST POINTER    18200017
         LTR   GR5,GR5                 TEST FOR MORE THAN 1 POINTER     18400017
         BM    OPEN1                   ONLY 1 POINTER                   18600017
         L     GR5,4(GR10)             LOAD ADDRESS DDNAME LENGTH FIELD 18800017
         LH    GR6,0(GR5)              LOAD LENGTH OF LIST              19000017
         LTR   GR6,GR6                 TEST IF ANY DDNAMES              19200017
         BZ    OPEN1                   NO                               19400017
*                                                                       19600017
*    ANALYZE INVOCATION PARAMETERS - DDNAMES                            19800017
*                                                                       20000017
         ST    GR6,STOREG              STORE SIZE OF DDNAME LIST        20200017
         TM    STOREG+3,X'07'          TEST IF MULTIPLE OF 8            20400017
         BZ    IFANYDDS                YES - NAMES ARE 8 CHARACTERS     20600017
         MVI   NOT8SW,1                SET INVALID DDNAME SWITCH        20800017
         B     OPEN1                   OPEN OUTPUT LOG                  21000017
*                                                                       21200017
IFANYDDS CLI   1(GR5),NOUPDD           MORE THAN 8 DDNAMES SPECIFIED    21400017
         BNH   OPEN1                   NO - NONE OVERRIDE UPDATE NAMES  21600017
         CLI   SYINDD(GR5),X'00'       IF SLOT IS ZERO- NO DD NAME      21800017
         BE    DDNAM2                  YES- DUMMY SLOT - CHECK NEXT ONE 22000017
         LA    GR11,DCBCTR             ADDRESS OF SYSIN DCB             22200017
         ST    GR11,DCBCT              POINTER TO SYSIN DCB             22400017
         MVC   BDDNAM(8,GR11),SYINDD(GR5)   OVERRIDE SYSIN NAME         22600017
         MVC   SYSINNM(8),SYINDD(GR5)    SAVE NAME OPEN WILL CLOBBER IT 22800017
DDNAM2   CLI   1(GR5),ONEDD            SECOND DDNAME                    23000017
         BNH   OPEN1                   NO- PROCEED                      23200017
         CLI   SYPRNDD(GR5),X'0'       IF SLOT ZERO - NO DDNAME         23400017
         BE    DDNAM3                  YES- DUMMY SLOT                  23600017
         MVC   SYSPRNTN(8),SYPRNDD(GR5)  SAVE NAME OPEN WILL CLOBBER IT 23800017
DDNAM3   CLI   1(GR5),TWODD            ANOTHER DDNAME                   24000017
         BNH   OPEN1                   NO - PROCEED                     24200017
         CLI   SYUT1DD(GR5),X'0'       IS SLOT ZERO                     24400017
         BE    DDNAM4                  YES - DUMMY SLOT                 24600017
         LA    GR11,DCBOMR             ADDRESS OF SYSUT1 DCB            24800017
         ST    GR11,DCBOM              POINTER TO SYSUT1 DCB            25000017
         MVC   BDDNAM(8,GR11),SYUT1DD(GR5)  OVERRIDE SYSUT1 NAME        25200017
         MVC   SYSUT1NM(8),SYUT1DD(GR5)  SAVE NAME OPEN WILL CLOBBER IT 25400017
DDNAM4   CLI   1(GR5),THREEDD          ANOTHER DD NAME                  25600017
         BNH   OPEN1                   NO - PROCEED                     25800017
         CLI   SYUT2DD(GR5),X'0'       IS SLOT ZERO                     26000017
         BE    OPEN1                   YES - DUMMY SLOT                 26200017
         LA    GR11,DCBNMR             ADDRESS OF SYSUT2 DCB            26400017
         ST    GR11,DCBNM              POINTER TO SYSUT2 DCB            26600017
         MVC   BDDNAM(8,GR11),SYUT2DD(GR5)  OVERRIDE SYSUT2 NAME        26800017
         MVC   SYSUT2NM(8),SYUT2DD(GR5)  SAVE NAME OPEN WILL CLOBBER IT 27000017
OPEN1    L     GR5,0(GR10)             LOAD PARAMETER POINTER           27200017
         LTR   GR5,GR5                 TEST IF LAST POINTER             27400017
         BM    WRTEHEAD                ONLY OPTION PARAMETERS           27600017
         L     GR5,4(GR10)             TEST FOR DDNAME POINTER          27800017
         LTR   GR5,GR5                 IS IT LAST POINTER          3628 28000017
         BM    WRTEHEAD                LAST ACTIVE POINTER              28200017
         L     GR5,8(GR10)             LOAD ADDRESS OF PAGE NUMBER      28400017
         LH    GR6,0(GR5)              LOAD LENGTH OF PAGE NUMBER       28600017
         LTR   GR6,GR6                 TEST IF LENGTH IS ZERO           28800017
         BZ    WRTEHEAD                YES- PAGE NUMBER NOT SPECIFIED   29000017
         C     GR6,FOUR                COUNT GREATER THAN 4             29200017
         BNH   AROUND                  NO- DO NOT HAVE TO TRUNCATE      29400017
INVA     MVI   PAGESW,X'01'                                        3628 29600017
         B     WRTEHEAD                START WITH ONE              3628 29800017
AROUND   LA    GR7,PAGENO+4       LOAD RIGHTMOST ADDRESS OF PAGENO 3628 30000017
         SR    GR7,GR6                 ADJUST ADDRESS BY GIVEN AMOUNT   30200017
         BCTR  GR6,0                   DECREMENT FOR MVC           3628 30400017
MVPAGE   EX    GR6,MOVEPAGE            PUT PAGE NUMBER IN TITLE         30600017
WRTEHEAD MVI   PRIMESW,X'0F'           SET WRITE HEADER SWITCH-OPEN LOG 30800017
         L     GR15,PRIMEWRT           ADDRESS OF MESSAGE WRITER        31000017
         BALR  GR14,GR15               ENTER MESSAGE ROUTINE            31200017
         CLI   LOGBADSW,X'0F'          WAS LOG DCB OPENED               31400017
         BE    ANERROR                 NO- COULD NOT OPEN PRINTER DCB   31600017
         CLI   PAGESW,X'0'             WAS PAGE PARAMETER INVALID       31800017
         BE    CHECK8SW                NO- CONTINUE                     32000017
         LA    GR11,PAGEMSG            ADDRESS OF ERROR MESSAGE         32200017
         LA    GR15,4                  SET UP CONDITION CODE            32400017
         BAL   GR14,SETCNCD            GO SET CONDITION CODE + MESSAGE  32600017
CHECK8SW CLI   NOT8SW,X'00'            WAS THERE AN ERROR IN DDNAMES    32800017
         BE    ANALPARM                NO- CONTINUE                     33000017
         LA    GR11,DDNAMEMG           ADDRESS OF ERROR MESSAGE         33200017
ALMOSTZ  LA    GR15,12                 PUT CONDITION CODE INTO REGISTER 33400017
         LA    GR14,CLOSENOW           RETURN FROM MESSAGE ROUTINE      33600017
SETCNCD  CH    GR15,HICONCDE           COMPARE AGAINST HIGHEST CODE YET 33800017
         BNH   FINERRT                 PREVIOUS CODE HIGH OR EQUAL      34000017
         STH   GR15,HICONCDE           STORE NEW HIGHEST CODE           34200017
FINERRT  L     GR15,PRIMEWRT           ADDRESS OF MESSAGE WRITER        34400017
         BR    GR15                    ENTER MESSAGE ROUTINE RETURN SET 34600017
CLOSENOW MVI   QUITALL,X'0E'           FORCE CONDITION MESSAGE AND EOJ  34800017
         L     GR15,PRIMEWRT           ADDRESS OF MESSAGE WRITER        35000017
         BR    GR15                    EOJ- CLOSE DCBLOGR- NO RETURN    35200017
ANERROR  L     GR13,SAVE13             RESTORE ORIGINAL CONTENTS OF 13  35400017
         LA    GR15,12                 SET CONDITION CODE OF 12         35600017
         RETURN (14,12),T,RC=(15)                                       35800017
         SPACE 1                                                        36000017
ANALPARM L     GR5,0(GR10)             LOAD PARAMETER POINTER           36200017
         LH    GR6,0(GR5)              LOAD PARAMETER COUNT             36400017
         LTR   GR6,GR6                 TEST FOR PARAMETERS              36600017
         BZ    OPENINPT                NO PARAMETERS- ASSUME MOD        36800017
         SR    GR8,GR8                 ZERO COUNT OF CHARACTER REGISTER 37000017
         LA    GR5,2(GR5)              UP TO ADDRESS OF PARAMETER FIELD 37200017
*                                                                     * 37400017
*   ANALYZE INPUT SPECIFICATIONS - CAN BE MOD OR NEW - DEFAULT IS MOD * 37600017
*                                                                     * 37800017
         CLI   0(GR5),COMMAEQ          IS COMMA FIRST CHARACTER         38000017
         BE    ASSUMMOD                YES- ASSUME DEFAULT OPTION MOD   38200017
         C     GR6,THREE               IS THERE ONLY ONE PARAMETER      38400017
         BE    INSPEC                  YES- ANALYZE INPUT SPECIFICATION 38600017
         CLI   3(GR5),COMMAEQ          IS 4TH CHARACTER A COMMA         38800017
         BNE   PMSG12                  NO- INVALID PARAMETER            39000017
INSPEC   CLC   0(3,GR5),NEW            IS PARAMETER 'NEW'               39200017
         BNE   GOON                    NO - CONTINUE TESTS              39400017
         MVI   CTONLYSW,X'01'          SET SWITCH ONLY NEW MASTER       39600017
         B     THRUINSP                DONE WITH PARAMETER ANALYSIS     39800017
ASSUMMOD LA    GR8,1(GR8)              UP COUNT OF CHARACTERS CHECKED   40000017
         LA    GR5,1(GR5)              ADJUST POINTER TO NEXT FIELD     40200017
         B     IFMORE                  TEST IF MORE FIELDS              40400017
GOON     CLC   0(3,GR5),MOD            IS PARAMETER 'MOD'               40600017
         BNE   PMSG12                  IS ERROR- GIVE MESSAGE, QUIT     40800017
THRUINSP LA    GR8,4(GR8)              INCREASE COUNT OF CHARACTERS     41000017
         LA    GR5,4(GR5)              ADJUST POINTER TO NEXT FIELD     41200017
IFMORE   CR    GR8,GR6                 MORE CHARACTERS TO ANALYZE       41400017
         BNL   OPENINPT                NO- COUNT IS FULFILLED           41600017
         ST    GR6,TEMPWA              SAVE COUNT OF CHARACTERS         41800017
*                                                                     * 42000017
*    TEST IF USER HEADER LABEL HANDLER SPECIFIED                      * 42200017
*                                                                     * 42400017
         BAL   GR3,GETNAME             GET SYSIN HEADER EXIT NAME       42600017
         L     GR6,DCBCT                                                42800017
         LA    GR3,CTHDR               ADDRESS OF CT HEADER NAME/AD000I 43000017
         LA    GR7,IFINTLR             RETURN FROM HEADER LABEL SETUP   43200017
         CLI   NONAMESW,X'01'          TEST IF NO NAME OR ERROR         43400017
         BE    NOINHDR                 SEE IF ERROR                     43600017
SETUPHDR C     GR9,EIGHT               TEST IF LABEL EXCEEDS 8 BYTES    43800017
         MVC   0(8,GR3),BLANKS8        CLEAR NAME FIELD                 44000017
         BH    TLRER                   ERROR IF MORE THAN 8             44200017
         BCTR  GR9,0                   DECREMENT FOR MVC COUNT          44400017
         EX    GR9,MVINHDEX            MOVE INHDR NAME TO BUFFER        44600017
         LOAD  EPLOC=(GR3)             LOAD ROUTINE BY NAME        000I 44800017
         ST    GR0,8(GR3)              STORE CORE ADDR AFTER NAME  000I 45000017
         MVI   CTHDRSW,X'0F'           FLAG AS CT HEADER RTN       000I 45200017
         MVI   CTEXITS,X'01'           ACTIVATE CT HEADER EXIT     000I 45400017
         BR    GR7                     RETURN                           45600017
*                                                                     * 45800017
*    TEST IF USER TRAILER LABEL HANDLER SPECIFIED                     * 46000017
*                                                                     * 46200017
IFINTLR  BAL   GR3,GETNAME             GET INTLR EXIT NAME IF GIVEN     46400017
         L     GR6,DCBCT               ADDRESS OF SYSIN DCB             46600017
         LA    GR3,CTTRLR              ADDRESS OF CT TRALER NAME/AD000I 46800017
         LA    GR7,CHECKALL            RETURN ADDRESS                   47000017
         CLI   NONAMESW,X'01'          TEST IF NO NAME OR ERROR         47200017
         BE    NOINTLR                 SEE IF ERROR                     47400017
SETUPTLR C     GR9,EIGHT               TEST IF LABEL EXCEEDS 8 BYTES    47600017
         BH    TLRER                   YES- ERROR IN TRAILER NAME       47800017
         MVC   0(8,GR3),BLANKS8        CLEAR NAME FIELD                 48000017
         BCTR  GR9,0                   DECREMENT FOR EXECUTE MVC        48200017
         EX    GR9,MVINHDEX            MOVE LABEL TO CORRECT BUFFER     48400017
         LOAD  EPLOC=(GR3)             LOAD ROUTINE BY NAME        000I 48600017
         ST    GR0,8(GR3)              STORE CORE ADDR AFTER NAME  000I 48800017
         MVI   CTTRLRSW,X'0F'          FLAG AS CT TRAILER ROUTINE  000I 49000017
         MVI   CTEXITS+4,X'03'         ACTIVATE CT TRALER EXIT     000I 49200017
         BR    GR7                     RETURN                           49400017
*                                                                     * 49600017
*    ALL POSSIBLE FIELDS THRU - ARE THERE CHARACTERS NOT ANALYZED     * 49800017
*                                                                     * 50000017
CHECKALL C     GR8,TEMPWA              ANY MORE CHARACTERS TO ANALYSE   50200017
         BNL   OPENINPT                NO EVERYTHING ANALYSED           50400017
PMSG12   LA    GR11,BADPARMG           LOAD BAD PARAMETER MESSAGE       50600017
         B     ALMOSTZ                 NO NEED TO CONTINUE WILL NOT RUN 50800017
NOINHDR  CLI   ERRNAMSW,X'01'          TEST IF ERROR INHDR LABEL        51000017
         BNE   IFINTLR                 NO- GO TO INTLR ANALYSIS         51200017
         B     TLRER                   GIVE MESSAGE                     51400017
NOINTLR  CLI   ERRNAMSW,X'01'          TEST IF ERROR INTLR LABEL        51600017
         BNE   CHECKALL                NO- GO TO LENGTH ANALYSIS        51800017
TLRER    LA    GR11,PLUS8MSG           ADDRESS OF ERROR MESSAGE         52000017
         B     ALMOSTZ                 GIVE MESSAGE THEN QUIT           52200017
*                                                                     * 52400017
*    SUBROUTINE TO GET THE EXIT NAME SPECIFIED                        * 52600017
*                                                                     * 52800017
GETNAME  MVI   NONAMESW,X'01'          SET SWITCH FOR NO NAME FOUND     53000017
         MVI   ERRNAMSW,X'00'          RESET ERROR SWITCH               53200017
         C     GR8,TEMPWA              HAVE ALL CHARACTERS BEEN CHECKED 53400017
         BCR   8,GR3                   YES- RETURN SHOULD NOT BE HERE   53600017
         CLI   0(GR5),COMMAEQ          IS FIRST CHARACTER A COMMA       53800017
         BNE   LDNAMLOC                NO- PREPARE TO RETURN NAME       54000017
RET1     LA    GR8,1(GR8)              INCREMENT CHARACTER COUNT        54200017
         LA    GR5,1(GR5)              INCREMENT PARAMETER POINTER      54400017
         BR    GR3                     RETURN                           54600017
LDNAMLOC LR    GR10,GR5                LOAD ADDRESS OF NAME FIELD       54800017
         SR    GR9,GR9                 ZERO NAME SIZE REGISTER          55000017
         LA    GR15,CHCKNEXT           RETURN FROM VALIDITY CHECK       55200017
         TM    0(GR5),ALPHA            TEST IF FIRST CHARACTER A LETTER 55400017
         BO    TSLTGTNO                YES- CHECK SOME MORE             55600017
INVALCHR LA    GR11,PLUS8MSG           ADDRESS OF ERROR MESSAGE         55800017
         LR    GR7,GR15                SAVE RETURN REGISTER FOR NOW     56000017
         L     GR15,PRIMEWRT           ADDRESS OF MESSAGE WRITER        56200017
         BALR  GR14,GR15               GIVE MESSAGE                     56400017
         LR    GR15,GR7                RETORE RETURN REGISTER           56600017
         MVI   ERRNAMSW,X'01'          SET ERROR FOUND SWITCH           56800017
         BR    GR15                    RETURN                           57000017
TSLTGTNO TM    0(GR5),X'0F'            TEST IF LOW ORDER FOUR BITS ZERO 57200017
         BZ    INVALCHR                IF SO INVALID                    57400017
         TM    0(GR5),NUMERIC          FIRST CHARACTER CANNOT BE NUMBER 57600017
         BO    INVALCHR                IF SO INVALID                    57800017
         MVI   NONAMESW,X'00'          CLEAR SWITCH VALID NAME FOUND    58000017
         BR    GR15                    RETURN                           58200017
CHCKNEXT LA    GR5,1(GR5)              INCREMENT CHARACTER ADDRESS      58400017
         LA    GR8,1(GR8)              INCREMENT TOTAL ANALYZED COUNT   58600017
         LA    GR9,1(GR9)              INCREMENT NAME CHARACTER COUNT   58800017
         C     GR8,TEMPWA              TOTAL COUNT ANALYSED TEST        59000017
         BCR   8,GR3                   IF COUNT FULFILLED RETURN        59200017
         CLI   0(GR5),COMMAEQ          DELIMITER COMMA AFTER 1ST NAME   59400017
         BE    RET1                    YES- RETURN                      59600017
         B     CHCKNEXT                KEEP SCANNING                    59800017
OPENINPT L     GR13,SAVE13X       LOAD RETURN SAVE AREA ADDRESS    000I 61800017
         LM    14,12,12(13)                                             65600017
         BR    14                                                       65800017
*                                                                       67600017
*    OLD MASTER AND NEW MASTER AND SYSIN DCB EXIT ROUTINES              67800017
*                                                                       68000017
         DS    0F                                                       68200017
OMEXITS  DC    X'01'                                                    68400017
         DC    AL3(OMHDREXT)                                            68600017
         DC    X'03'                                                    68800017
         DC    AL3(OMTRLEXT)                                            69000017
         DC    A(0)                                                     69200017
         DC    X'85'                                                    69400017
         DC    AL3(OMDCBEX)                                             69600017
         DC    X'07'                                                    69800017
         DC    AL3(0)                                                   70000017
NMEXITS  DC    X'02'                                                    70200017
         DC    AL3(NMHDREXT)                                            70400017
         DC    X'04'                                                    70600017
         DC    AL3(NMTRLEXT)                                            70800017
         DC    X'00'                                                    71000017
         DC    AL3(0)                                                   71200017
         DC    X'85'                                                    71400017
         DC    AL3(NMDCBEX)                                             71500017
         DC    X'07'                                                    71600017
         DC    AL3(0)                                                   71800017
CTEXITS  DC    X'00'                                                    72000017
         DC    AL3(CTHDREXT)                                            72200017
         DC    X'00'                                                    72400017
         DC    AL3(CTTRLEXT)                                            72600017
         DC    X'85'                                                    72800017
         DC    AL3(CTDCBEX)                                             73000017
         EJECT                                                          73200017
*   SYSIN DCB   CONTROL CARD INPUT     REFERRED TO AS CT                73400017
         SPACE 1                                                        73600017
DCBCTR   DCB   DSORG=PS,MACRF=(GL),DDNAME=SYSIN,RECFM=FB,LRECL=80, 000H*73800017
               EODAD=EODCT,EXLST=CTEXITS,SYNAD=CTERROUT,BUFNO=1    000H 74000017
         EJECT                                                          74200017
*   SYSUT1 DCB  OLD MASTER             REFERRED TO AS OM                74400017
         SPACE 1                                                        74600017
DCBOMR   DCB   DSORG=PO,MACRF=R,DDNAME=SYSUT1,NCP=1,               2039C74800017
               EXLST=OMEXITS,EODAD=OMEOD,SYNAD=OMERROUT                 75000017
         EJECT                                                          75200017
*   SYSUT2 DCB  NEW MASTER             REFERRED TO AS NM                75400017
         SPACE 1                                                        75600017
DCBNMR   DCB   DSORG=PO,MACRF=W,DDNAME=SYSUT2,NCP=1,               2039C75800017
               EXLST=NMEXITS,SYNAD=NMERROUT                             76000017
         SPACE 1                                                        76200017
         EJECT                                                          76400017
         SPACE 1                                                        76600017
         SPACE 1                                                        76800017
         SPACE 1                                                        77000017
*   CONSTANTS FOR INITIALIZATION ROUTINE                                77200017
ZERO     DC    D'0'                    BUFFER OF ZEROS                  77400017
THREE    DC    F'3'                                                     77600017
FOUR     DC    F'4'                                                     77800017
EIGHT    DC    F'8'                                                     78000017
***   WARNING-- KEEP THE 4 NAMES BELOW IN THIS ORDER                    78200017
**               SYSIN, SYSPRINT, SYSUT1, SYSUT2                     ** 78400017
SYSINDC  DC    CL8'SYSIN'                                               78600017
SYSPRNDC DC    CL8'SYSPRINT'                                            78800017
SYSUT1DC DC    CL8'SYSUT1'                                              79000017
SYSUT2DC DC    CL8'SYSUT2'                                              79200017
         SPACE 1                                                        79400017
USERHDR  DC    CL8' '                  NAME OF USER HEADER LABEL EXIT   79600017
USERTLR  DC    CL8' '                  NAME OF USERTRAILER LABEL EXIT   79800017
ZEROHEX  DC    C'00000000'             DOUBLE WORD HEX ZEROS            80000017
ONEHEX   DC    C'0001'                 DEFAULT PAGE NUMBER         3628 80200017
BLANKS8  DC    CL8' '              DOUBLE WORD OF BLANKS                80400017
SAVE13X  DS    F                                                        80500017
SAVEREG  DS    18F                     SAVE AREA USED BY READ/WRITE     80600017
         SPACE 3                                                        80800017
         DS    0D                                                       81000017
DSECTLOC DC    F'0'                    COMMON AREA ADDRESS JUST IN CASE 81200017
SAVE14   DC    F'0'                    SAVE RETURN ADDRESS FOR OPEN     81400017
         SPACE 1                                                        81600017
PRIMEWRT DC    V(IEBUPLOG)             ENTRY POINT OF LOG ROUTINE       81800017
IEBEXITS  DC    V(IEBUPXIT)                                             81900017
         SPACE 1                                                        82200017
*                                                                       82400017
*                INSTRUCTIONS INVOKED BY EXECUTES                       82600017
*                                                                       82800017
MVINHDEX MVC   0(1,GR3),0(GR10)        MOVE HEADER OR TRAILER TO BUFFER 83000017
MOVEPAGE MVC   0(1,GR7),2(GR5)         MOVE IN PAGE NUMBER              83200017
XCINSTR  XC    STARTAB(1),STARTAB      CLEARS UP TO 256 BYTES SWITCHES  83400017
         SPACE 1                                                        83600017
EIGHTY   DC    H'80'                   DEFAULT LRECL                    83800017
NEW      DC    C'NEW'                  TEST FOR PARM=NEW                84000017
CTDC     DC    C'CT'                   IDENTIFIES SYSIN IN MESSAGE      84200017
MOD      DC    C'MOD'                  PARM SETTING FOR MODIFY          84400017
SIXTEEN  DC    H'16'                   CONSTANT FOR HIGHEST ERROR CODE  84600017
NOT8SW   DC    X'00'                   SET IF INPUT NAME IN ERROR       84800017
PAGESW   DC    X'00'                   SET IF PAGE NUMBER IN ERROR      85000017
NONAMESW DC    X'00'                   SET IF NO NAME OR ERROR          85200017
BIT01    EQU   X'01'                                                    85400017
BIT10    EQU   X'10'                                                    85600017
         EJECT                                                          85800017
         IEBUPCON                                                       86000017
         EJECT                                                          86200017
DDNAMSCT DSECT                                                          86400017
DDLENGTH DS    CL2                                                      86600017
SYSLINDD DS    CL8                                                      86800017
MEMBERDD DS    CL8                                                      87000017
SYSLMODD DS    CL8                                                      87200017
SYSLIBDD DS    CL8                                                      87400017
SYSINDD  DS    CL8                                                      87600017
SYSPRNDD DS    CL8                                                      87800017
SYSPUNDD DS    CL8                                                      88000017
SYSUT1DD DS    CL8                                                      88200017
SYSUT2DD DS    CL8                                                      88400017
SYSUT3DD DS    CL8                                                      88600017
         SPACE 3                                                        88800017
         DCBD  DSORG=PS                                                 89000017
*                             INSERT  EQUATE  STATEMENTS                89200017
NOUPDD   EQU   X'20'                                                    89400017
ONEDD    EQU   X'28'                                                    89600017
TWODD    EQU   X'38'                                                    89800017
THREEDD  EQU   X'40'                                                    90000017
COMMAEQ  EQU   X'6B'                                                    90200017
ALPHA    EQU   X'C0'                                                    90400017
NUMERIC  EQU   X'F0'               BITS 1111 0000                       90600017
BDDNAM   EQU   DCBDDNAM-IHADCB                                          90800017
BBLKSI   EQU   DCBBLKSI-IHADCB                                          91000017
BDSORG   EQU   DCBDSORG-IHADCB                                          91400017
BLRECL   EQU   DCBLRECL-IHADCB         LOGICAL RECORD LENGTH FIELD      91600017
SYUT1DD  EQU   SYSUT1DD-DDNAMSCT                                        92000017
SYUT2DD  EQU   SYSUT2DD-DDNAMSCT                                        92200017
SYPRNDD  EQU   SYSPRNDD-DDNAMSCT                                        92400017
SYINDD   EQU   SYSINDD-DDNAMSCT                                         92600017
         END   IEBUPNIT                                                 92800017
./  ADD  SSI=81980005,NAME=IEBUPXIT
IEBUPXIT CSECT                                                          00100017
*A145500-146632,536500,536600                                   YA00060 00110001
*D140000-141000                                                 YA00060 00120001
* 107000-108000,110000-112600,113800-115000,115700-118000,127000 A27716 00150019
* 501100-501700                                                  A34107 00160021
* 183000                                                         A36139 00170021
*A196900,210400                                                  A41838 00180000
*D200000                                                         A41838 00182000
*C209000                                                         A41838 00184000
*C285500                                                         A41838 00190021
*A116600                                                         A48819 00195000
*A100500                                                        YA01669 00196000
*C101000                                                        YA01669 00197000
*A158500                                                       @ZA01687 00199002
*A 158100                                                      @ZA04376 00199103
*A094200-094600,156100-156400,543500    @XA20587,@YA19906,(ORG)@ZA28493 00200099
*C156000                                @XA20587,@YA19906,(ORG)@ZA28493 00250099
 SPACE 4                                                                00300099
*********************************************************************** 00350099
*                  *****         I E B U P X I T       *****          * 00400099
* STATUS. CHANGE LEVEL 000.                                           * 00500017
*                                                                     * 00600017
* FUNCTION/OPERATION.                                                 * 00700017
*        THIS CSECT CONTAINS ALL ASYNCHRONOUS DCB EXIT SUBROUTINES    * 00800017
*        FOR  SYSIN,SYSUT1 AND SYSUT2. THIS CSECT CONTAINS THE        * 00900017
*        FOLLOWING EXIT ROUTINES FOR EACH DATA SET.                   * 01000017
*                                                                     * 01100017
*        1.    DCB EXIT ROUTINE.                                      * 01200017
*        2.    SYNAD ROUTINE.                                         * 01300017
*        3.    EODAD ROUTINE.      *** EXCEPT SYSUT2 ***              * 01400017
*        4.    USER HEADER LABEL ROUTINE.                             * 01500017
*        5.    USER TRAILER LABEL ROUTINE.                            * 01600017
*                                                                     * 01700017
* ENTRY POINTS.                                                       * 01800017
*        ENTERED FROM QSAM OR BSAM AT ANY ONE OF 14 POINTS.           * 01900017
*                                                                     * 02000017
*        OLD MASTER (SYSUT1) DATA SET ENTRY POINTS ARE:               * 02100017
*        1.    OMDCBEX                                                * 02200017
*        2.    OMERROUT;                                              * 02300017
*        3.    OMEOD;                                                 * 02400017
*        4.    OMHDREXT;                                              * 02500017
*        5.    OMTRLEXT.                                              * 02600017
*                                                                     * 02700017
*        NEW MASTER (SYSUT2) DATA SET ENTRY POINTS ARE:               * 02800017
*        1.    NMDCBEX;                                               * 02900017
*        2.    NMERROUT;                                              * 03000017
*        3.    NMHDREXT;                                              * 03100017
*        4.    NMTRLEXT.                                              * 03200017
*                                                                     * 03300017
*        SYSIN DATA SET ENTRY POINTS ARE:                             * 03400017
*        1.    CTDCBEX;                                               * 03500017
*        2.    CTERROUT;                                              * 03600017
*        3.    EODCT;                                                 * 03700017
*        4.    CTHDREXT;                                              * 03800017
*        5.    CTTRLEXT.                                              * 03900017
*                                                                     * 04000017
*********************************************************************** 04100017
 EJECT                                                                  04200017
         SPACE 4                                                        04300017
*********************************************************************** 04400017
*                                                                     * 04450017
*        THE FOLLOWING NAMES ARE ENTRY POINTS INTO THIS MODULE        * 04500017
*                                                                     * 04550017
*********************************************************************** 04600017
         ENTRY      OMHDREXT                                          * 04700017
         ENTRY      OMTRLEXT                                          * 04800017
         ENTRY      OMDCBEX                                           * 04900017
         ENTRY      OMERROUT                                          * 05000017
         ENTRY      OMEOD                                             * 05100017
         ENTRY      NMHDREXT                                          * 05200017
         ENTRY      NMTRLEXT                                          * 05300017
         ENTRY      NMDCBEX                                           * 05400017
         ENTRY      NMERROUT                                          * 05500017
         ENTRY      CTHDREXT                                          * 05600017
         ENTRY      CTTRLEXT                                          * 05700017
         ENTRY      CTDCBEX                                           * 05800017
         ENTRY      CTERROUT                                          * 05900017
         ENTRY      EODCT                                             * 06000017
         ENTRY     SPSYNAD                                       A27716 06050019
*********************************************************************** 06100017
         SPACE 4                                                        06200017
*********************************************************************** 06300017
*                                                                     * 06350017
*        SYMBOLIC REGISTER NOTATION     GR0--GR15                     * 06400017
*                                                                     * 06450017
*********************************************************************** 06500017
GR0      EQU   0                                                      * 06600017
GR1      EQU   1                                                      * 06700017
GR2      EQU   2                                                      * 06800017
GR3      EQU   3                                                      * 06900017
GR4      EQU   4         BASE REGISTER FOR THIS CSECT                 * 07000017
GR5      EQU   5                                                      * 07100017
GR6      EQU   6                                                      * 07200017
GR7      EQU   7                                                      * 07300017
GR8      EQU   8                                                      * 07400017
GR9      EQU   9                                                      * 07500017
GR10     EQU   10                                                     * 07600017
GR11     EQU   11                                                     * 07700017
GR12     EQU   12        BASE REGISTER FOR IEBUPCON                   * 07800017
GR13     EQU   13                                                     * 07900017
GR14     EQU   14                                                     * 08000017
GR15     EQU   15                                                     * 08100017
*********************************************************************** 08200017
         EJECT                                                          08300017
 SPACE 2                                                                08400017
*********************************************************************** 08500017
*                   *****         W A R N I N G        *****          * 08600017
*        REGISTER  4 CONTAINS THE BASE ADDRESS OF THIS MODULE.        * 08700017
*        REGISTER  12 CONTAINS THE BASE ADDRESS OF IEBUPCON.          * 08800017
*        NO CSECT  SHOULD ALTER THE CONTENTS OF EITHER REGISTER       * 08900017
*                                                                     * 09000017
*********************************************************************** 09100017
 SPACE 4                                                                09200017
         USING *,GR4                                                    09300017
         USING IEBUPCON,GR12                                            09400017
         B     EODCT                    BRANCH AROUND CONSTANT @ZA28493 09420099
         DC    CL8'IEBUPXIT'            MODULE NAME            @ZA28493 09440099
         DC    CL8'-OZ28493'            LAST MODIFICATION      @ZA28493 09460099
*********************************************************************** 09500017
*        END OF DATA ROUTINES FOR SYSIN AND SYSUT1 DATA SETS          * 09600017
*********************************************************************** 09700017
EODCT    MVI   EODCTSW,X'0F'            SET EOF ON SYSIN  SWITCH        09800017
         MVI   LABEL2SW,X'00'          RESET LABEL PROCESSING SWITCH    09850017
         B     ENTRNEXT                 INFORM NEXT CSECT OF EOF        09900017
OMEOD    MVI   OMEND,X'0F'              SET EOF ON SYSUT1 SWITCH        10000017
         MVI   REPROSW,X'00'       RESET REPRO SWITCH AT        YA01669 10050000
*                                  REPRO END                    YA01669 10100000
ENTRNEXT L     GR15,PROCESS                                             10200017
         BR    GR15                     ENTER NEXT STAGE- NO RETURN     10300017
         SPACE 2                                                        10400017
*********************************************************************** 10500017
*        THE FOLLOWING ARE SYNAD ERROR ROUTINES FOR SYSIN,            * 10600017
*        SYSUT1, SYSUT2 AND SYSPRINT DCB'S.  THEY PRINT ERROR         * 10700019
*        MESSAGES PRODUCED DYNAMICALLY BY THE SYNADAF ROUTINE         * 10800019
*********************************************************************** 10900017
CTERROUT STM   GR14,GR1,SYNSAVER       SAVE SYNAD PARAMETERS     A27716 10930019
         SYNADAF    ACSMETH=QSAM                                 A27716 10960019
SYNAD2   L     GR7,MACROMSG    ADDRESS OF AREA FOR SYNADAF MSG   A27716 10990019
         MVC   0(78,GR7),50(GR1)                                 A34086 11000020
SYNAD3   LA    GR11,IOERR              NUMBER OF I/O ERROR MSG   A27716 11020019
         MVI   SYNADSW,X'0F'                                     A27716 11050019
         B     ALMOSTZ                                           A27716 11080019
NMERROUT STM   GR14,GR1,SYNSAVER       SAVE SYNAD PARAMETERS     A27716 11110019
         SYNADAF    ACSMETH=BSAM                                 A27716 11140019
         L     GR7,MACROMSG     ADDRESS OF AREA FOR SYNAD MSG    A27716 11170019
         MVC   0(78,GR7),50(GR1)                                 A27716 11200019
         SYNADRLS                                                A27716 11230019
         LM    GR14,GR1,SYNSAVER       RESTORE SYNAD PARAMETERS  A27716 11260019
         CLI   TOTALSW,X'FE'           IS TOTALING EXIT ACTIVE   A27716 11290019
         BNL   LASTOTAL                 IF SO,ENTER FOR LAST TIME  000I 11320018
         B     SYNAD3                                            A27716 11410019
LASTOTAL ST    GR0,TOTLPARM+8           SAVE STATUS INFO ADDRESS   000I 11510018
         MVI   TOTLPARM+8,X'80'         FLAG AS I/O ERROR          000I 11520018
         LA    GR1,TOTLPARM             ADDRESS OF PARMLIST             11530018
         ST    GR9,TOTLPARM             BUFFER ADDRESS OF I/O ERROR000I 11540018
         L     GR15,TOTALADR            USER TOTAL ROUTINE ADDR    000I 11550018
         BALR  GR14,GR15                GIVE ROUTINE CONTROL       000I 11560018
         B     SYNAD3                                            A27716 11580019
OMERROUT STM   GR14,GR1,SYNSAVER       SAVE SYNAD PARAMETERS     A27716 11600019
         SYNADAF    ACSMETH=BSAM                                 A27716 11620019
         B     SYNAD2                                            A27716 11640019
SPSYNAD  STM   GR14,GR1,SYNSAVER       SAVE SYNAD PARAMETERS     A27716 11660019
         LA    GR15,12            GET RETURN CODE FOR THIS ERROR A48819 11663000
         CH    GR15,HICONCDE      IS THIS THE HIGHEST SO FAR     A48819 11666000
         BNH   SPSYNAD1           NO.. DON'T CHANGE              A48819 11669000
         STH   GR15,HICONCDE      SAVE HIGEST SO FAR             A48819 11672000
SPSYNAD1 EQU   *                                                 A48819 11675000
         SYNADAF    ACSMETH=QSAM                                 A27716 11680019
         MVC   WTOMSG1+23(25),50(GR1)                            A27716 11700019
         MVC   WTOMSG2+12(53),75(GR1)                            A27716 11720019
         SYNADRLS                                                A27716 11740019
         LA    GR1,WTOMSG1                                       A27716 11760019
         WTO   MF=(E,(1))                                        A27716 11780019
         LA    GR1,WTOMSG2                                       A27716 11800019
         WTO   MF=(E,(1))                                        A27716 11820019
         LM    GR14,GR1,SYNSAVER       RESTORE SYNAD PARAMETERS  A27716 11840019
         L     GR15,LOGFINSH                                     A27716 11860019
         BR    GR15                                              A27716 11880019
         SPACE 2                                                        11900017
ALMOSTZ  LA    GR15,12                  PUT RETURN CODE INTO REGISTER   12000017
         LA    GR14,CLOSENOW            RETURN HERE FROM MSG ROUTINE    12100017
SETCNCD  CH    GR15,HICONCDE            COMPARE AGAINST HIGHEST CODE    12200017
         BNH   FINERRT                  PREVIOUS CODE HIGH OR EQUAL     12300017
         STH   GR15,HICONCDE            STORE NEW HIGHEST CODE          12400017
FINERRT  L     GR15,PRIMEWRT            ADDRESS OF MESSAGE WRITER       12500017
         BR    GR15                                                     12600017
CLOSENOW L     GR2,CLOSEALL                                      A27716 12650019
         BALR  GR3,GR2                                           A27716 12700019
         MVI   QUITALL,X'0E'  FORCE CONDITION MSG AND EOJ MSG    A27716 12750019
         L     GR15,PRIMEWRT                                            12800017
         BR    GR15                     ENTER MESSAGE ROUTINE           12900017
         SPACE 4                                                        13000017
         SPACE 2                                                        13100017
*********************************************************************** 13200017
*        DCB EXIT ROUTINES FOR SYSIN, SYSUT1 AND SYSUT2               * 13300017
*********************************************************************** 13400017
         SPACE 2                                                        13500017
OMDCBEX  L     GR11,DCBOM               ADDRESS OF OLD MASTER DCB       13600017
         LA    GR7,OMBLOCKP             BLOCKING FACTOR BUFFER OM       13700017
         LA    GR6,OMBLKERR             INCORRECT BLOCKSIZE SWITCH      13800017
CHKSIZE  LH    GR9,BBLKSI(GR11)         PICK UP BLOCKSIZE FROM DCB      13900017
         SR    GR8,GR8                  SET BLOCKING FACTOR             14200017
         LH    GR3,BLRECL(GR11)         OBTAIN LOGICAL RECORD LENGTH    14300017
         LTR   GR3,GR3                  IS LOGICAL RECORD LENGTH ZERO   14400017
         BZ    NOSIZE                   YES-ASSUME 80                   14500017
         TM    BRECFM(GR11),X'80'       RECFM FIXED, UNDEFINED  YA00060 14550001
         BO    NOTVAR                   YES, MAXSIZE IS 80      YA00060 14560001
         TM    BRECFM(GR11),X'40'       RECORD VARIABLE         YA00060 14570001
         BZ    NOTVAR                   NO, NOT VARIABLE, BRNCH YA00060 14580001
         CH    GR3,MAXSIZEV             VARIABLE LONGER THAN 84 YA00060 14590001
         BH    NOSIZE                   PLUG IN DEFAULTS        YA00060 14592001
         LTR   GR9,GR9                  IS BLOCKSIZE ZEROS      YA00060 14594001
         BZ    NOSIZE                   YES, PICK UP DEFAULTS   YA00060 14596001
         STH   GR3,LRECL                SAVE RECORD LENGTH      YA00060 14598001
         STH   GR9,FLBLK                SAVE ORIGINAL BLOCKSIZE YA00060 14598401
         STH   GR9,SHRTBLK              FOR UPDATE-INPLACE      YA00060 14598801
         SH    GR9,VAR4                 DECREASE BY 4           YA00060 14599201
         DR    GR8,GR3                  OBTAIN BLOCKING FACTOR  YA00060 14599601
         STH   GR9,0(GR7)               BLOCKING FACTOR         YA00060 14599701
         STH   GR9,0(GR7)               LOGICAL RECORD COUNT    YA00060 14599801
         LTR   GR8,GR8                  ANY REMAINDER           YA00060 14599901
         BZ    RRRET                    BLOCKSIZE-LRECL OK      YA00060 14633201
         B     NOSIZE                   CANNOT HANDLE           YA00060 14643201
NOTVAR   LTR   GR9,GR9                  IS BLOCKSIZE ZERO       YA00060 14653201
         BZ    NOSIZE                   YES, SET ERROR FLAG     YA00060 14663201
         CH    GR3,MAXSIZEL             MAXIMUM RECORD SIZE EXCEEDED    14666701
         BH    NOSIZE                   YES-ASSUME 80                   14700017
         STH   GR3,LRECL                SAVE RECORD LENGTH              14800017
         STH   GR9,FLBLK                SAVE ORIGINAL BLOCKSIZE IN CASE 14900017
         STH   GR9,SHRTBLK              UPDATE=INPLACE IS SPECIFIED     15000017
         DR    GR8,GR3                  OBTAIN BLOCKING FACTOR          15100017
         STH   GR9,0(GR7)               BLOCKING FACTOR                 15200017
         STH   GR9,2(GR7)               LOGICAL RECORD COUNT            15300017
         LTR   GR8,GR8                  ANY REMAINDER                   15400017
         BZ    RRRET                    NO-RETURN BLOCKSIZE-LRECL OK    15500017
NOSIZE   TM    0(GR6),NMOLD             TESTING AN OLD NM D/S? @ZA28493 15600099
         BZ    SETDEF                   NO,SET DEFAULT VALUES  @ZA28493 15610099
         OI    0(GR6),X'01'             YES,INDICATE ERROR     @ZA28493 15620099
         B     RETRNS                   RETURN.GIVE MSG + QUIT @ZA28493 15630099
SETDEF   MVI   0(GR6),X'01'             BLKSIZE OR LRECL ERROR @ZA28493 15640099
         MVC   BBLKSI(2,GR11),EIGHTY    MAKE BLOCKSIZE 80               15700017
         MVC   BLRECL(2,GR11),EIGHTY    MAKE LRECL 80                   15800017
         MVI   BRECFM(GR11),FIXED       SET RECFM TO FIXED     @ZA04376 15810003
         B     CHKSIZE                                         @ZA01687 15850002
RRRET    TM    BRECFM(GR11),X'40'       RECFM V OR U             A48750 15900021
         BO    DEFAUL                   YES,DEFAULT RECFM TO F/B A48750 16000021
         TM    BRECFM(GR11),X'80'       RECFM IS FIXED           A48750 16050021
         BO    RETRNS                   YES,RETURN               A48750 16060021
DEFAUL   LH    GR3,BBLKSI(GR11)         BLOCKSIZE IN DCB         A48750 16100021
         MVI   BRECFM(GR11),FIXED       SET RECFM TO FIXED       A48750 16200021
         CH    GR3,LRECL                BLOCKSIZE AND LRECL EQUAL       16300017
         BE    RETRNS                   YES,FIXED RECORDS DCB SET UP OK 16400017
         MVI   BRECFM(GR11),FIXEDBLK    SET RECFM TO FIXED BLOCK A48750 16500000
RETRNS   RETURN                                                         16600017
NMDCBEX  L     GR11,DCBNM               ADDRESS OF NEW MASTER DCB       16700017
         LA    GR7,NMBLOCKP             BLOCKING FACTOR BUFFER          16800017
         LA    GR6,NMBLKERR             INCORRECT BLOCKSIZE SWITCH      16900017
         B     CHKSIZE                  CHECK BLOCKING FACTOR           17000017
CTDCBEX  L     GR11,DCBCT               ADDRESS OF SYSIN DCB            17100017
         USING IHADCB,GR11                                              17200017
         LH    GR7,DCBBLKSI             LOAD BLOCKSIZE                  17300017
         LTR   GR7,GR7                  CHECK FOR MULTIPLE OF 80        17400017
         BC    8,SETBLOK                IF NO BLKSIZ GIVEN,INSERT 80    17500017
         SR    GR6,GR6                  ZERO OUT REMAINDER REGISTER     17600017
         LA    GR5,80                   BLOCK SIZE MUST BE A            17700017
         DR    GR6,GR5                  MULTIPLE OF 80                  17800017
         LTR   GR6,GR6                  IS BLKSIZ A MULTIPLE OF 80      17900017
         BCR   8,GR14                   IF SO,RETURN                    18000017
         MVI   BLOKSW,X'10'             OTHERWISE SET FLAG              18100017
SETBLOK  MVI   DCBBLKSI+1,X'50'         ISNERT BLOCKSIZE                18400017
         BR    GR14                     RETURN                          18500017
         DROP  GR11                                                     18600017
         EJECT                                                          18700017
         SPACE 2                                                        18800017
*********************************************************************** 18900017
*        USER LABEL HEADER EXITS FOR SYSIN                            * 19000017
*********************************************************************** 19100017
CTHDREXT STM   GR0,GR14,LABLSAVE       SAVE ENTRY REGISTERS             19190017
         LA    GR13,USERSAVE            SAVE AREA                       19280017
         CLI   IOBADSW,X'0F'            I/O ERROR                       19370017
         BE    TERMZER0                 IF SO,TERMINATE                 19460017
         CLI   EOVSWTCH,X'0F'           FIRST ENTRY TO EXIT ROUTINE     19550017
         BE    CTENTER                  IF NOT,DO NOT INITCONSTANTS     19640017
         MVI   EOVSWTCH,X'0F'           SET FIRST ENTRY SWITCH   A41838 19690000
         MVC   USERRTN(12),CTHDR        MOVE USER ROUTINE NAME/ADDR     19730017
         MVI   USERRTN+8,X'04'         FLAG AS HEADER ROUTINE      000H 19820017
CTCOMMON MVI   USERCONT,X'00'           RESET NO. OF LABELS COUNT       19910017
         BAL   GR14,PRNTENTM           PRNT 'USER ROUTINE PROCESS'      20090017
CTENTER  BAL   GR14,COMONLBL           PASS CONTROL TO USER RUTINE      20180017
         LM    GR0,GR14,LABLSAVE                                        20270017
         BR    GR14                     RETURN                          20360017
         SPACE 3                                                        20450017
CTTRLEXT STM   GR0,GR14,LABLSAVE       SAVE ENTRY REGISTERS             20540017
         LA    GR13,USERSAVE            SAVE AREA                       20630017
         CLI   IOBADSW,X'0F'            I/O ERROR                       20720017
         BE    TERMZER0                IF SO, TERMINATE            UL0H 20810017
         CLI   EOVSWTCH,X'FF'           FIRST ENTRY TO TRL. RTN  A41838 20900000
         BE    CTENTER                  IF NOT,DO NOT INIT. CONS        20990017
         MVI   EOVSWTCH,X'FF'           SET SW. FIRST TRAILER    A41838 21040000
         MVC   USERRTN(12),CTTRLR       MOVE USER ROUTINE NAME/ADDR     21080017
         MVI   USERRTN+8,X'08'         FLAG AS TRAILER ROUTINE     000H 21170017
         B     CTCOMMON                 INITIALIZE CONSTANTS.           21260017
PRNT#LBL LA   GR11,LBLENTMS                                             21350017
         L     GR15,PRIMEWRT            LOG ROUTINE                     21440017
         BR    GR15                     PRINT MESSAGE                   21530017
PRNTENTM LA    GR11,USRLBLMS            LOAD MESSAGE CONSTANT.          21620017
         L     GR15,PRIMEWRT            ADDRESS OF IEBUPLOG             21710017
         BR    GR15                     PRINT MESSAGE,RETURN TO         21800017
*                                       CALLER VIA REG.14               21890017
   SPACE 4                                                              21980017
*********************************************************************** 22070017
*        USER LABEL SUBROUTINES USED BY ALL LABEL EXIT ROUTINES.      * 22160017
*        THIS ROUTINE GIVES CONTROL TO USER ROUTINES AND  CHECKS      * 22250017
*        FOR MOST TERMINATING CONDITIONS.                             * 22340017
*********************************************************************** 22430017
COMONLBL STM   GR14,GR1,TEMPSAVE        SAVE LINKAGE REGISTERS.         22520017
         L     GR15,USERRTN+8           GET ADDR OF USER LBL RUTINE     22610017
         BALR  GR14,GR15                GIVE CONTROL TO USER RUTINE     22700017
         STC   GR15,LBLRETCD            STORE USER RETURN CODE.         22790017
         L     GR1,TEMPSAVE+12          PICK UP POINTER TO PARM LIS     22880017
         CLI   8(GR1),X'80'             I/O ERROR?                      22970017
         BE    IOERROR                  IF SO,PRINT MSG AND RETURN      23060017
         IC    GR8,USERCONT            LOAD NO. LABELS PROCESSED        23150017
         LA    GR8,1(GR8)              ADD ONE TO THAT COUNT            23240017
         STC   GR8,USERCONT            AND RESTORE IT FOR REFERENC      23330017
         CLI   LBLRETCD,X'10'          IS USER RETURN CODE=16?          23420017
         BE    RETCDE16                 IF SO,PRINT MSG & LET RC=0.     23510017
         CLI   LBLRETCD,X'00'          IS USER RETURN CODE=0?           23600017
         BE    RETCDEND                 IF SO,PRINT MSG&RETURN.         23690017
         CLI   USERCONT,X'08'           HAVE EIGHT LABELS BEEN PROC     23780017
         BE    RETCDEND                 IF SO,TREAT AS RC=0.            23870017
         CLI   LBLRETCD,X'04'          IS RETURN CODE EQU TO 4     000H 23880017
         BE    RETRNLBL                IF SO, IT IS VALID          000H 23890017
         CLI   LBLRETCD,X'08'          IS RETURN CODE EQU TO 4     000H 23900017
         BE    RETRNLBL                IF SO, IT IS VALID          000H 23910017
         CLI   LBLRETCD,X'0C'          IS RETURN CODE EQU TO 4     000H 23920017
         BE    RETRNLBL                IF SO, IT IS VALID          000H 23930017
         B     RETCDEND                ELSE IT DEFAULTS TO ZERO    000H 23940017
RETRNLBL L     GR14,TEMPSAVE            LOAD CALLERS RETURN ADDRESS     23960017
         BR    GR14                     RETURN TO CALLER                24050017
         SPACE                                                          24140017
IOERROR MVI   IOBADSW,X'0F'                                             24230017
         LA    GR11,LBLERMSG            LOAD I/O ERROR MSG CON.         24320017
         L     GR15,PRIMEWRT            ADDRESS OF IEBUPLOG.            24410017
         BALR  GR14,GR15                PRINT I/O ERROR MSG             24500017
         B     RETRNLBL                 PREPARE TO RETURN               24590017
RETCDE16 SR    GR15,GR15                FORCE RETURN CODE TO ZERO.      24680017
RETCDEND STC   GR15,TEMPSAVE+4          SAVE RETURN CODE.               24770017
         LA    GR11,LSTRCMSG            LOAD LAST RET CD MSGCON.        24860017
         L     GR15,PRIMEWRT            ADDRESS OF IEBUPLOG.            24950017
         BALR  GR14,GR15                PRINT LAST RET CD MSG.          25040017
         LA    GR11,LBLENTMS            LOAD NO.OF ENTRANCES MSGCON     25130017
         L     GR15,PRIMEWRT            ADDRESS OF IEBUPLOG.            25220017
         BALR  GR14,GR15                PRINT NO. ENTR. MSG.            25310017
         IC    GR15,TEMPSAVE+4          RELOAD RETURN CODE.             25400017
         B     RETRNLBL                 PREPARE TO RETURN.              25490017
   SPACE 2                                                              25580017
*********************************************************************** 25670017
*        HEADER LABEL EXIT ROUTINE ON SYSUT1 UPDATE=INPLACE           * 25760017
*        IS REQUESTED.                                                  25850017
*********************************************************************** 25940017
UPDATEXT CLI   OMOPENSW,X'0F'          ENTERED DURING OPEN              26030017
         BNE   OMENTER                 IF NOT,PASS CONTROL DIRECT UUL0H 26120017
         CLC   0(4,GR1),ZERO            IS THERE A LABEL                26210017
         BE    OMENTERX                IF NOT,PASS CONTROL DIRECT  UL0H 26300017
         L     GR3,0(GR1)               LOAD POINTER TO USER LABEL      26390017
         CLI   3(GR3),C'1'              IS IT FIRST OF LABEL GROUP      26480017
         BE    INITDOM                  IF SO,INITIALIZE POINTERS       26570017
MVDOMLBL L     GR9,OMLBLPTR             LOAD ADDR OF LABEL SAVE ARA     26660017
         IC    GR5,OMLBLCNT            PICK UP NO. OF LABELS PROCES     26750017
         LA    GR5,1(GR5)              ADD ONE TO THE COUNT             26840017
         STC   GR5,OMLBLCNT            STORE IN IN COMMUN REGION        26930017
         ST    GR9,UPDTPARM             ADDR OF LABEL IN PARM FELD      27020017
         MVC   UPDTPARM+16(4),0(GR1)    MOVE LABEL PTR TO PARMS         27110017
         MVC   UPDTPARM+4(12),4(GR1)    MOVE PARMS TO UPDATE PARMS      27200017
         LA    GR9,80(GR9)              ADDR IN OMLBLPTR NOW POINTS     27290017
         ST    GR9,OMLBLPTR             TO NEXT AVAILABLE LABEL         27380017
         CLI   OMHDRSW,X'0F'            IS THERE A USER HEADER RTN      27470017
         BE    OMENTER                 IF NOT,PASS CONTROL DIRECT  UL0H 27560017
         LM    GR0,GR14,LABLSAVE                                        27650017
         LA    GR15,12                  LOAD RET CD TO PROCESS NEXT     27740017
         BR    GR14                     RETURN CONTROL TO OPEN          27830017
INITDOM  LA    GR5,OMLABELS             LOAD START ADDR OF SAVE BUF     27920017
         ST    GR5,OMLBLPTR             INIT SAVE AREA POINTER          28010017
         MVI   USERCONT,X'00'           INIT NO. ENTRANCES COUNT        28100017
         MVI   OMLBLCNT,X'00'           INIT NO. LABELS PROCESSED       28190017
         MVI   OMSYSNLB,X'F0'          SET LABELS TO BE COPIED SW  000H 28210017
         CLI   LABELSW,X'10'           ARE THERE LABELS IN INPUT   000H 28230017
         BNE   OMHDRDMP                IF NOT,SWITCH IS PROPERLY ST000H 28250017
         MVI   OMSYSNLB,X'0F'          SET TO ACCEPT LABELS IN SYSM000H 28270017
         MVC   OMLBLPTR(4),LABELBUF    MOVE GETMAIN POINTER        000H 28290017
         MVC   OMLBLCNT(1),LABELCNT    MOVE LABEL COUNT TO COUNTER 000H 28310017
OMHDRDMP CLI   OMHDRSW,X'0F'           IS THERE A USER ROUTINE     000H 28330017
         BNE   MVDOMLBL                 IF NOT, PREPARE TO SAVE LBL     28370017
         BAL   GR14,PRNTENTM        PRINT USER RTN PROCESS MSG   A41838 28550021
         B     MVDOMLBL                 PREPARE TO SAVE LABELS          28640017
*********************************************************************** 29360017
*        OLD MASTER (SYSUT1) USER HEADER LABEL ROUTINE.               * 29450017
*********************************************************************** 29540017
OMHDREXT STM   GR0,GR14,LABLSAVE       SAVE ENTRY REGISTERS             29630017
         LA    GR13,USERSAVE                                            29720017
         L     GR3,0(GR1)              ADDRESS OF LABEL BUFFER          29810017
         CLI   IOBADSW,X'0F'           I/O ERROR DURING LABEL PROC UL0H 29900017
         BE    TERMZER0                IF SO, THEN TERMINATE       UL0H 29990017
         MVC   USERRTN(12),OMHDR        MOVE USER ROUTINE NAME/ADDR     30080017
         MVI   USERRTN+8,X'04'         FLAG AS HEADER ROUTINE      000H 30170017
         CLI   INPLCSW,X'0F'            OPEN FOR UPDAT?                 30260017
         BE    UPDATEXT                 IF SO,GO TO UPDATE EXIT.        30350017
         CLI   OMOPENSW,X'0F'           ENTERED DURING OPEN?            30440017
         BNE   OMENTER                  IF NOT,PASS CONTROL DIRECT      30530017
*                                       TO USER LABEL ROUTINE           30620017
         CLC   0(4,GR1),ZERO            IS THERE A LABEL?               30710017
         BE    OMENTERX                IF NONE, CHECK FOR USER ROUTUL0H 30800017
         CLI   3(GR3),C'1'             IS THIS THE FIRST LABEL     UL0H 30890017
         BE    INITOM                   IF SO,INITIALIZE POINTERS       30980017
MVEOMLBL CLI   LABELSW,X'10'           LABELS IN INPUT STREAM           31020017
         BE    LABLUSER                THEN DO NOT SAVE LABELS          31060017
         L     GR9,OMLBLPTR            ADDRESS OF OM LABEL SAVE AREA    31100017
         IC    GR5,OMLBLCNT                                             31160017
         LA    GR5,1(GR5)                                               31250017
         STC   GR5,OMLBLCNT                                             31340017
         MVC   0(80,GR9),0(GR3)        MOVE LABEL TO SAVE AREA          31430017
         LA    GR9,80(GR9)             ADDR IN OMLBLPTR NOW POINTS      31520017
         ST    GR9,OMLBLPTR            TO NEXT AVAILABLE SLOT           31610017
LABLUSER  CLI   OMHDRSW,X'0F'          IS THERE A USER ROUTINE          31700017
         BE    OMENTER                  IF SO,PASS CONTROL DIRECTLY     31790017
         LA    GR15,4                   LOAD RET CD TO PROCESS NEXT     31880017
         LM    GR0,GR14,LABLSAVE                                        31970017
         BR    GR14                     RETURN CONTROL TO OPEN          32060017
         SPACE                                                          32150017
INITOM   LA    GR5,OMLABELS             LOAD START ADDR OF SAVE BUF     32240017
         ST    GR5,OMLBLPTR             INITIALIZE SAVE AREA POINT      32330017
         MVI   USERCONT,X'00'           INIT NO. ENTRANCE CONSTANT      32420017
         MVI   OMLBLCNT,X'00'           INIT NO. LABELS PROCESSED       32510017
         MVI   OMSYSNLB,X'F0'          FLAG FOR LABELS IN OM       UL0H 32610017
         CLI   LABELSW,X'10'           ANY LABELS IN INPUT STREAM  UL0H 32710017
         BNE   OMHDRCMP                IF NOT FLAGS ARE SET        UL0H 32810017
         MVI   OMSYSNLB,X'0F'          FLAGAS LABELS IN INPUT      UL0H 32910017
OMHDRCMP CLI   OMHDRSW,X'0F'           IS THERE A USER ROUTINE     UL0H 33010017
         BNE   MVEOMLBL                 IF NOT,PREPARE TO SAVE A LB     33230017
         BAL   GR14,PRNTENTM           PRINT USER RTN PROCESS MSG       33320017
         B     MVEOMLBL                 PREPARE TO SAVE LABEL.          33410017
         SPACE 2                                                        33500017
OMENTERX BAL   GR14,TERMZER2           PRINT USER ROUTINE MESSAGE  UL0H 33590017
         CLI   OMHDRSW,X'0F'           IS THERE A USER ROUTINE     UL0H 33680017
          BNE   OMENTER                GIVE CONTROL TO USER        UL0H 33770017
         BAL   GR14,PRNTENTM           PRINT USER PROCEE MSG       UL0H 33860017
OMENTER CLI   LBLRETCD,X'10'           IS USER RETURN CODE =16?         33950017
         BNE   OMENTER1                 IF SO,SHOULD TERMINATE NO.      34040017
TERMZER0 LA    GR15,0                  LOAD TERNINATE RETURN CODE.      34130017
         LM    GR0,GR14,LABLSAVE                                        34220017
         BR    GR14                     RETURN TO OPEN                  34310017
         SPACE                                                          34400017
OMENTER1 CLI   OMHDRSW,X'0F'            IS THERE A USER ROUTINE?        34490017
         BNE   TERMZER0                 IF NOT,TERMINATE LABEL PROC     34580017
         BAL   GR14,COMONLBL            PASS CONTROL TO USER ROUTIN     34670017
OMCOMMON CLC   0(4,GR1),ZERO                                       000H 34760017
         BNE   RETOM                   IF SO,IT MAY NOT BE THE LAST000H 34850017
         LA    GR14,RETOM              PICK UP ADDRESS OF EXIT CODE000H 34940017
         ST    GR14,TEMPSAVE           SAVE ADDRESS IN COMMON'S AREA00H 35030017
         LA    GR15,0                  CODE IS SET FOR LAST ENTRY  A00H 35120017
         B     RETCDEND                GO TO MESSAGE ROUTINES      000H 35210017
RETOM    LM    GR0,GR14,LABLSAVE                                   000H 35300017
         BR    GR14                                                000H 35390017
         SPACE 3                                                        35480017
*********************************************************************** 35570017
*        OLD MASTER (SYSUT1) USER TRAILER LABEL ROUTINE.              * 35660017
*********************************************************************** 35750017
OMTRLEXT STM   GR0,GR14,LABLSAVE       SAVE ENTRY REGISTERS             35840017
         LA    GR13,USERSAVE                                            35930017
         L     GR3,0(GR1)              ADDRESS OF LABEL BUFFER          36020017
         CLI   IOBADSW,X'0F'           I/O ERROR DURING LABEL PROC UL0H 36110017
         BE    TERMZER0                IF SO, THEN TERMINATE       UL0H 36200017
         MVC   USERRTN(12),OMTRLR       MOVE USER ROUTINE NAME/ADDR     36290017
         MVI   USERRTN+8,X'08'         FLAG AS TRAILER ROUTINE     000H 36380017
         CLC   0(4,GR1),ZERO           ARE TERE ANY LABELS              36650017
         BE    OMENT1                  IF NONE, CHECK FOR USER     UL0H 36740017
         CLI   3(GR3),C'1'              IS IT THE 1ST LABEL             36830017
         BE    INITOMTR                 IF SO,INITIALIZE CONSTANTS      36920017
MVEOMTRL L     GR9,OMLBLPTR            LOAD ADDR OF LABEL SAVE AREA     37010017
         IC    GR5,OMLBLCNT                                             37100017
         LA    GR5,1(GR5)                                               37190017
         STC   GR5,OMLBLCNT                                             37280017
         MVC   0(80,GR9),0(GR3)        MOVE LABEL TO SAVE AREA          37370017
         LA    GR9,80(GR9)             ADDR IN OMLBLPTR NOW POINTS      37460017
         ST    GR9,OMLBLPTR            TO NEXT AVAILABLE SLOT           37550017
         CLI   OMTRLRSW,X'0F'           IS THERE A USER HEADER RTN?     37640017
         BE    OMENTTRL                 IF SO,PASS CONTROL DIRECTLY     37730017
         LA    GR15,4                   LOAD RET CD TO PROCESS NEXT     37820017
         LM    GR0,GR14,LABLSAVE                                        37910017
         BR    GR14                     RETURN CONTROL TO EOV.          38000017
INITOMTR LA    GR5,OMLABELS             LOAD START ADDR OF SAVE BUF     38090017
         ST    GR5,OMLBLPTR             INITIALIZE SAVE AREA POINTR     38180017
         MVI   USERCONT,X'0'            INIT NO. ENTRANCE CONSTANT      38270017
         MVI   OMLBLCNT,X'0'            INIT # LABELS PROCESSED         38360017
         MVI   NMSYSNLB,X'F0'          FLAG AS COPY OLD MASTER LABEUL0H 38460017
         CLI   LABELSW,X'20'           ARE THERE INPUT LABELS TO PRUL0H 38560017
         BNE   OMTRLCMP                THEN FLAGS ARE SET          UL0H 38660017
         MVI   NMSYSNLB,X'0F'          FLAG AS LABELS IN INPUT     UL0H 38760017
OMTRLCMP CLI   OMTRLRSW,X'0F'          IS THERE A USER ROTINE      UL0H 38860017
         BNE   MVEOMTRL                IF NOT, COPY OM LABELS      UL0H 38960017
         BAL   GR14,PRNTENTM           PRINT USER HEADER MESSAGE   UL0H 39060017
         B     MVEOMTRL                PREPARE TO GENERATE LABELS  UL0H 39160017
OMENT1  BAL    GR14,TERMZER2           GIVE NO LABELS MESSAGE      UL0H 39260017
         CLI   OMTRLRSW,X'0F'          IS THERE A USER ROUTINE     UL0H 39360017
         BNE   OMENTTRL                IF NOT PREPARE TO RETURN    UL0H 39460017
         BAL   GR14,PRNTENTM           I PRINT USER ENETER MESS    UL0H 39560017
OMENTTRL CLI   OMTRLRSW,X'0F'           IS THERE A USER ROUTINE?        39710017
         BNE   TERMZER0                 IF NOT TERMINATE LABEL PROC     39800017
         BAL   GR14,COMONLBL            PASS CONTROL TO USER ROUTIN     39890017
         B     OMCOMMON                PREPARE TO RETURN TO SYSTEM 000H 39980017
         SPACE 2                                                        40880017
*********************************************************************** 40970017
*        NEW MASTER (SYSUT2) USER HEADER LABEL ROUTINE.               * 41060017
*********************************************************************** 41150017
NMHDREXT STM   GR0,GR14,LABLSAVE       SAVE ENTRY REGISTERS             41240017
         LA    GR13,USERSAVE                                            41330017
         L     GR3,0(GR1)              ADDRESS OF LABEL BUFFER          41420017
         CLI   IOBADSW,X'0F'           I/O ERROR DURING LABEL PROC UL0H 41510017
         BE    TERMZER0                IF SO, THEN TERMINATE       UL0H 41600017
         MVC   USERRTN(12),NMHDR        MOVE USER RTN NAME/ADDR         41690017
         MVI   USERRTN+8,X'0C'         FLAG AS TRAEADER OUTINE     000H 41780017
         CLI   NMOPNSWT,X'0F'           ENTERED DURING OPEN?            41870017
         BL    NMVOL2HD                HANDLING MULTIVOLUME D.S.   UL0H 41900017
         CLI   OMSYSNLB,X'00'           HAS A LABLE BEEN SAVED TO       41940017
*                                       OUTPUT TO NEW MASTER            42010017
         BE    NMENTERP                PREPARE TO ENTER USER ROUTINUL0H 42080017
         CLI   NMOPNSWT,X'1F'           IS THIS THE FIRST ENTRY?        42150017
         BE    NMINIT                   IF SO,INITIALIZE POINTERS.      42220017
MVENMLBL L     GR9,OMLBLPTR            LOAD ADDR OF LABEL SAVE AREA     42290017
         MVC   0(80,GR3),0(GR9)        MOVE SAVED LABEL TO BUFFER       42360017
         LA    GR9,80(GR9)             ADDR IN OMLBLPTR NOW POINTS      42430017
         ST    GR9,OMLBLPTR            TO NEXT AVAILABLE SLOT           42500017
         SR    GR8,GR8                 PREPARE FOR LTR INSTRUCTION 000H 42570017
         IC    GR8,OMLBLCNT            LOAD NO. LABELS TO BE PROCES     42640017
         BCTR  GR8,0                   DECREMENT COUNT BY ONE           42710017
         STC   GR8,OMLBLCNT            STORE NO LABELS REMAINING        42780017
         CLI   NMHDRSW,X'0F'            IS THERE A USER ROUTINE?        42850017
         BE    NMENTERS                IF SO,CHECK FOR LABEL GENERATION 42920017
         LTR   GR8,GR8                 HAS LAST LABEL BEEN GENERATD     42990017
         LA    GR15,4             MEANS| PUT THIS LABEL,LAST RETURN000H 43060017
         BE    NMRETN             PREPARE TO RETURN FOR LAST TIME  000H 43130017
         LA    GR15,8                   RET CODE=CONT.PROCESSLABELS     43200017
         LM    GR0,GR14,LABLSAVE                                        43270017
         BR    GR14                     RETURN TO OPEN ROUTINE          43340017
NMENTERP CLI   NMHDRSW,X'0F'                                            43410017
         BNE   NMENTERQ                IF NOT PREPARE TO RETURN    000H 43480017
         CLI   NMOPNSWT,X'1F'          IS THIS THE FIRST ENTRY     000H 43550017
         BNE   NMENTER                 IF SO, PRINT HEADER MESSAGE 000H 43620017
         BAL   GR14,PRNTENTM           IF SO,GO TO PRINT ROUTINR   000H 43690017
         MVI   NMOPNSWT,X'0F'          SET ALREADY ENTERED SWITCH  000H 43720017
         B     NMENTER                 THEN GIVE HIS ROUTINE CNTRL 000H 43760017
NMENTERQ CLI   NMOPNSWT,X'1F'          IS THIS ENTRY DUE TO OPEN   000H 43830017
         BNE   TERMZER0                RETURN WITH CC=0            UL0H 43920017
         B     TERMZER1                PRINT NO LABELS EXIST MSG   UL0H 44010017
NMVOL2HD CLI   VOLSWTCH,X'04'          IS THIS FIRST ENTRY         UL0H 44110017
         BE    NMENTER                 IF NOT,GIVE CONTROL TO USER UL0H 44180017
         CLI   NMHDRSW,X'0F'           IS THERE A USER ROUTINE     UL0H 44250017
         BNE   TERMZER0                IF NOT RETURN TO D.M.       UL0H 44320017
         MVI   VOLSWTCH,X'04'          SET INITIALIZED SWITCH      UL0H 44390017
NMVOLCOM BAL   GR14,PRNTENTM           PRINT ROUTINE HAS BEEN ENTERUL0H 44460017
         MVI   USERCONT,X'00'          RESET NO. OF ENTRANCES SWTCHUL0H 44530017
         B     NMENTER                 PREPARE TO GIVE CONTROL     UL0H 44600017
TERMZER1 LA    GR11,NOULCRTM           PRINT NO USER LABELS EXIST  UL0H 44690017
         LA    GR14,TERMZER0           RETURN TO SET CC=0          UL0H 44780017
         L     GR15,PRIMEWRT           ADDRESS OF LOG MODULE       UL0H 44870017
         BR    GR15                    PRINT MESSAGE               UL0H 44960017
TERMZER2 LA    GR11,NOULXSTM           PRINT NO USER LABELS EXIST MUL0H 45050017
         L     GR15,PRIMEWRT           PRINT ROUTINE ADDRESS      MUL0H 45140017
         BR    GR15                    GO PRINT MESSAGE    S      MUL0H 45230017
NMRET04  LA    GR15,4                   RET CODE=LAST LABEL TO PROC     45320017
         MVC    TEMPSAVE(4),LABLSAVE+56                                 45410017
         B     RETCDEND                 PRINT MESSAGES AND RETURN       45500017
NMRET04X LA    GR15,4                                                   45590017
         MVC   TEMPSAVE(4),LABLSAVE+56                                  45680017
         B     RETRNLBL                PREPARE TO RETURM           UL0H 45770017
NMINIT   MVI   NMOPNSWT,X'0F'           RESET FIRST ENTRY PORTION       45860017
         MVI   USERCONT,X'00'           RESET NO. ENTRANCES COUNT       45950017
         LA    GR5,OMLABELS                                             46040017
         ST    GR5,OMLBLPTR                                             46130017
         CLI   OMSYSNLB,X'0F'          ANY LABELS SAVED FROM INPUT UL0H 46220017
         BNE   NMUSER                  IF NOT TEST FOR USER ROUTINEUL0H 46310017
         MVC   OMLBLCNT(1),LABELCNT    MOVE NO. OF LABELS SAVED    UL0H 46400017
NMUSER   CLI   NMHDRSW,X'0F'            IS THERE A USERLABEL ROUTIN     46890017
         BNE   MVENMLBL                 IF NOT,BEGIN PROCESSING LBL     46980017
         BAL   GR14,PRNTENTM           PRNT 'USER ROUTINE PROCESS'      47070017
         B     MVENMLBL                 BEGIN PROCESSING LABELS.        47160017
NMENTERS LTR   GR8,GR8                 ANY MORE LABELS TO CREATE        47170017
         BNE   NMENTER                 IF MORE, GIVE CONTROL DIRECT     47180017
         MVI   OMSYSNLB,X'00'          IF NO MORE, FLAG AS NO MORE      47190017
         B     NMENTER                 THEN ENTER USER ROUTINE          47200017
NMTNTERS LTR    GR8,GR8                ANY MORE LABELS TO CREATE        47210017
         BNE   NMENTER                 IF MORE,DO NOT FLAG AS LAST      47220017
         MVI   NMSYSNLB,X'00'          IF NO MORE,FLAG AS NONE SAVED    47230017
         B     NMENTER                 THEN ENTER USER ROUTINE          47240017
NMENTER  CLI   LBLRETCD,X'10'          IS USER RETURN CODE=16?          47250017
         BE    TERMZER0                 IF SO, PREPARE TO TERMINATE     47340017
         BAL   GR14,COMONLBL            PASS CONTROL TO USER RUTINE     47430017
         CLI   LBLRETCD,X'04'           IS RETURN CODE,EQUAL TO 4       47520017
         BE    NMRET04                  IF SO,PRINT TERMINATION MSG     47610017
NMRETN   LM    GR0,GR14,LABLSAVE                                        47700017
         BR    GR14                    RETURN CONTROL TO SYSTEM    UL0H 47790017
         SPACE                                                          47880017
*********************************************************************** 47970017
*        NEW MASTER (SYSUT2) USER TRAILER LABEL  ROUTINE              * 48060017
*********************************************************************** 48150017
NMTRLEXT STM   GR0,GR14,LABLSAVE       SAVE ENTRY REGISTERS             48240017
         LA    GR13,USERSAVE                                            48330017
         L     GR3,0(GR1)              ADDRESS OF LABEL BUFFER          48420017
         CLI   IOBADSW,X'0F'           I/O ERROR DURING LABEL PROC UL0H 48510017
         BE    TERMZER0                IF SO, THEN TERMINATE       UL0H 48600017
         MVC   USERRTN(12),NMTRLR       MOVE USER RTN NAME/ADDR         48690017
         MVI   USERRTN+8,X'10'         FLAG AS TRAILERR OUTINE     000H 48780017
         CLI   NMCLSESW,X'0F'           ENTERED DURING OPEN?            48870017
         BL    NMVOL2TR                CHECK FOR USER ROUTINE      UL0H 48970017
         CLI   NMSYSNLB,X'00'           HAS A LABEL BEEN SAVED?         49030017
         BE    NMTENTRP                PREPARE TO RETURN TO USER   UL0H 49090017
         CLI   NMCLSESW,X'1F'           IS THIS THE FIRST ENTRY?        49150017
         BE    NMTINIT                  IF SO,INITIALIZE POINTERS       49210017
MVTNMLBL L     GR9,OMLBLPTR                                             49270017
         MVC   0(80,GR3),0(GR9)        MOVE SAVED LABEL TO BUFFER       49330017
         LA    GR9,80(GR9)              OMLBLPTR NOW POINTS TO NEXT     49390017
         ST    GR9,OMLBLPTR             LABEL TO BE PROCESSED.          49450017
         SR    GR8,GR8                 PREPARE FOR LTR INSTRUCTION 000H 49510017
         IC    GR8,OMLBLCNT             LOAD NO. LABELS TO PROCESS      49570017
         BCTR  GR8,0                    DECREMENT THAT COUNT BY ONE     49630017
         STC   GR8,OMLBLCNT             STORE NO. OF LABELS REMAING     49690017
         CLI   NMTRLRSW,X'0F'           IS THERE A USER ROUTINE?        49750017
         BE    NMTNTERS                IF SO CHECK FOR LABEL GENERATION 49810017
         LTR   GR8,GR8                  HAS LAST LABEL BEEN CREATED     49870017
         LA    GR15,4             MEANS| PUT THIS LABEL,LAST RETURN000H 49930017
         BE    NMRETN             PREPARE TO RETURN FOR LAST TIME  000H 49990017
         LA    GR15,8                   RET CD= CONT PROCESS LABLES     50050017
         B     NMRETN             RETURN                         A34107 50110021
NMTENTRP CLI   NMTRLRSW,X'0F'                                           50230017
         BNE   NMTENTRQ                IF NOT,PREPARE TO RETURN    000H 50290017
         CLI   NMCLSESW,X'1F'           IS THIS THE FIRST ENTRY    000H 50350017
         BNE   NMENTER                 GIVE CONTROL TO USER ROUTINE     50410017
         BAL   GR14,PRNTENTM           IF SO,GO OT PRINT ROUTINE   000H 50470017
         MVI   NMCLSESW,X'0F'          SET ALREADY ENETERED SWITCH 000H 50500017
         B     NMENTER                 GIVE CONTROL TO USER ROUTINE     50540017
NMTENTRQ CLI   NMCLSESW,X'1F'          IS THIS ENTRY DUE TO CLOSE  000H 50590017
         BNE   TERMZER0                RETURN A CC=0               UL0H 50650017
         B     TERMZER1                PRINT NO LABELS EXIST MSG   UL0H 50710017
NMVOL2TR CLI   VOLSWTCH,X'08'          FIRST ENTRY TO THIS ROUTINE UL0H 50770017
         BE    NMENTER                 IF NOT,GO DIRECT TO USER         50830017
         CLI   NMTRLRSW,X'0F'          IS THERE A USER ROUTINE     UL0H 50890017
         BNE   TERMZER0                TERMINATE THIS LABEL PROCESSUL0H 50950017
         MVI   VOLSWTCH,X'08'          SET AS ALREADY ENTERED      UL0H 51010017
         B     NMVOLCOM                COMMON VOLUME SWTCH RTN     UL0H 51070017
NMTINIT  MVI   NMCLSESW,X'0F'           RESET FIRST ENTRY PORTION  000I 51400017
         MVI   USERCONT,X'00'           RESET NO. ENTRANCES COUNT  000I 51500017
         LA    GR5,OMLABELS                                             51600017
         ST    GR5,OMLBLPTR                                             51700017
         CLI   NMSYSNLB,X'0F'           CHECK FOR SYSIN LABELS     000I 51800017
         BNE   NMTUSER                  IF NONE,CHECK FOR USER RTN 000I 51900017
         MVC   OMLBLPTR(4),LABELBUF     MOVE ADDR OF SAVED LABELS  000I 52000017
         MVC   OMLBLCNT(1),LABELCNT     MOVE NO.OF LABELS TO COUNTR000I 52100017
NMTUSER  CLI   NMTRLRSW,X'0F'           IS THERE A USER LBL ROUTINE000I 52200017
         BNE   MVTNMLBL                 IF NOT,BEGIN PROCESS LABELS000I 52300017
         BAL   GR14,PRNTENTM            PRNT 'USER RUTINE NOW PROC'000I 52400017
         B     MVTNMLBL                 BEGIN PROCESSING LABELS    000I 52500017
PROCESS  DC    V(IEBUPDT2)              ENTRY POINT OF MAIN PROCESSOR   53300017
PRIMEWRT DC    V(IEBUPLOG)              ENTRY POINT OF LOG ROUTINE      53400017
CLOSEALL DC    V(DEACTV)  ENTRY PT IN IEBUPDT2 TO CLOSE SYSUT1,  A27716 53408019
*                                      SYSUT2, AND SYSIN         A27716 53416019
MACROMSG DC    V(SYNADMSG)   ADDRESS OF SYNAD ERROR MSG IN IEBUPLOG     53424019
*                                                                A27716 53432019
SYNSAVER DS    4F                                                A27716 53440019
LOGFINSH DC    V(CLOSEPRT)             ENTRY PT IN IEBUPLOG TO CLOSE    53448019
*                                      SYSPRINT AND RETURN       A27716 53456019
WTOMSG1  WTO   'IEB802I  I/O ERROR                            ',MF=L,  X53464019
               ROUTCDE=11,DESC=7                                 A27716 53472019
WTOMSG2  WTO   'IEB802I                                                X53480019
                                   ',MF=L,ROUTCDE=11,DESC=7      A27716 53488019
ZERO     DC    F'0'                                                     53500017
EIGHTY   DC    H'80'                                                    53600017
MAXSIZEV DC    H'84'                                            YA00060 53650001
VAR4     DC    H'4'                                             YA00060 53660001
UPDTPARM DS    5F                                                       53700017
VOLSWTCH DC    X'00'                   USED TO INDICATE MULTIVOLUMEUL0H 53730017
*                                      PROCESSING FOR LABEL ROUTINEUL0H 53760017
LABLSAVE DS    18F                                                      53800017
USERSAVE DS    18F                                                      53900017
TEMPSAVE DS    4F                                                       54000017
BIT80    EQU   X'80'                                                    54100017
FIXED    EQU   X'80'                                                    54200017
FIXEDBLK EQU   X'90'                                                    54300017
NMOLD    EQU   X'80'              DISP=OLD IND. IN INTERNAL SW @ZA28493 54350099
         IEBUPCON                                                       54400017
         DCBD  DSORG=PS                                                 54500017
BLRECL   EQU   DCBLRECL-IHADCB                                          54600017
BBLKSI   EQU   DCBBLKSI-IHADCB                                          54700017
BRECFM   EQU   DCBRECFM-IHADCB                                          54800017
         END   IEBUPXIT                                                 54900099
