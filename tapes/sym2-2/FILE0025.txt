./  ADD  SSI=33090345,NAME=IEBTCRIN
  TITLE 'IEBTCRIN - DRIVER MODULE - INTRODUCTORY COMMENTARY'            00050019
*                                                                     * 00100019
*TITLE 'IEBTCRIN' - TCR DATA SET UTILITY - DRIVER MODULE              * 00150019
*                                                                     * 00200019
*STATUS:  CHANGE LEVEL 000                                            * 00250019
*                                                                     * 00300019
* CHANGE ACTIVITY                                                     * 00310002
* RELEASE VS2/2.0   ADDITIONS/CHANGES/DELETIONS                       * 00320002
*C166000                                                         YM2512 00330002
*                                                                     * 00340002
*FUNCTION/OPERATION:                                                  * 00350019
*                                                                     * 00400019
*   IEBTCRIN IS THE DRIVER MODULE OF THE IEBTCRIN DATA SET UTILITY.   * 00450019
*   IT IS THE FIRST AND ONLY MODULE BROUGHT INTO CORE UPON INVOCATION * 00500019
*   OF THE UTILITY.  IT REMAINS RESIDENT THROUGHOUT OPERATION OF THE  * 00550019
*   UTILITY.  IT CONSISTS OF THREE CSECTS - IEBTCRIN, TCR220, AND     * 00600019
*   TCRCOM.                                                           * 00650019
*                                                                     * 00700019
*   IEBTCRIN IS THE GENERAL PROCESSING ROUTINE.  IT PROCESSES THE     * 00750019
*   USER DDNAME PARAMETER LIST, LOADS THE MESSAGE MODULE (IEBTCR02),  * 00800019
*   LINKS TO THE JFCB ANALYZER (IEBTCR03), OPENS THE SYSPRINT DATA    * 00850019
*   SET AND ALLOCATES PRINT AREA STORAGE, OPENS THE SYSIN DATA SET    * 00900019
*   IF ONE HAS BEEN PROVIDED AND LINKS TO THE CONTROL CARD ANALYZER   * 00950019
*   (IEBTCR04), SETS CONTROL CARD DEFAULTS IF NO SYSIN DATA SET WAS   * 01000019
*   PROVIDED, LOADS THE USER TRANSLATE TABLE AND EXIT ROUTINES, INCRE-* 01050019
*   MENTS DATA CONTROL BLOCK (DCB) DEFAULTS BY MAXLN, OPENS THE       * 01100019
*   SYSUT1 DCB AND ISSUES A MOUNT MESSAGE, LINKS TO THE READ AND      * 01150019
*   EDIT PROCESSOR (IEBTCR05), ISSUES SYNAD MESSAGES TO SYSPRINT FOR  * 01200019
*   PERMANENT I/O ERRORS, AND RETURNS A COMPLETION CODE TO THE CALL-  * 01250019
*   ING TASK.                                                         * 01300019
*                                                                     * 01350019
*   TCR220 IS THE MESSAGE WRITER FOR THE UTILITY.  IT CONTAINS TWO    * 01400019
*   PROCESSING OPTIONS - 1) CONSECUTIVE OUTPUTTING OF ALL IEB9XXX     * 01450019
*   MESSAGES AND  2) SINGLE LINE SYSPRINT OUTPUTTINE OF CONTROL       * 01500019
*   STATEMENT IMAGES, PAGE HEADINGS, SYNAD MESSAGES, ETC.             * 01550019
*                                                                     * 01600019
*   TCRCOM IS THE COMMON COMMUNICATION REGION OF THE UTILITY.  IT     * 01650019
*   CONTAINS TABLES, INDICATORS, STORAGE AREAS, AND CONSTANT DATA     * 01700019
*   AREAS THAT ARE USED BY TWO OR MORE MODULES.                       * 01750019
*                                                                     * 01800019
*ENTRY POINTS:                                                        * 01850019
*                                                                     * 01900019
*        IEBTCRIN - UTILITY ENTRY POINT                               * 01950019
*                                                                     * 02000019
*   MAY BE CALLED BY MEANS OF ATTACH, LINK, OR LOAD AND CALL MACRO-   * 02050019
*   INSTRUCTIONS.  THE ADDRESS OF A PARAMETER LIST COMPLYING WITH     * 02100019
*   STANDARD OS CONVENTIONS MUST BE PASSED IN REGISTER 1. THIS        * 02150019
*   PARAMETER LIST MUST BE OF THE FORM:                               * 02200019
*                                                                     * 02250019
*                   OPTLIST ADDRESS                                   * 02300019
*                   DDNAME LIST ADDRESS                               * 02350019
*                                                                     * 02400019
*   THE SIGN BIT OF THE LAST FULL WORD OF THE LIST MUST BE SET TO     * 02450019
*   ONE TO INDICATE THE END OF THE LIST.  UNUSED ENTRIES MUST BE SET  * 02500019
*   TO ZERO.  POSSIBLE INVOKING OPTIONS:                              * 02550019
*                                                                     * 02600019
*        //       EXEC  PGM=IEBTCRIN                                  * 02650019
*                                                                     * 02700019
*                 ATTACH EP=IEBTCRIN,PARAM=(OPTLIST,DDLIST),VL=1,    X* 02750019
*                                                                     * 02800019
*                 LINK  EP=IEBTCRIN,PARAM=(OPTLIST,DDLIST),VL=1       * 02850019
*                                                                     * 02900019
*                 LOAD  EP=IEBTCRIN                                   * 02950019
*                 CALL  IEBTCRIN,(OPTLIST,DDLIST),VL                  * 03000019
*                                                                     * 03050019
*        TCR220 - MESSAGE WRITER                                      * 03100019
*                                                                     * 03150019
*   PARAMETER DATA IS PASSED BY NAME BY ONE OF TWO OPTIONS:           * 03200019
*                                                                     * 03250019
*   1)  BY MEANS OF THE COMMON COMMUNICATION REGION TABLE MSGPTRS     * 03300019
*       WHICH CONTAINS ONE ENTRY FOR EACH IEB-TYPE MESSAGE (EXCLUDING * 03350019
*       SYNAD MESSAGES).  THIS OPTION IS USED TO SUCCESSIVELY OUTPUT  * 03400019
*       IEBXXXX MESSAGES WHICH HAVE BEEN REQUESTED BY VARIOUS PHASES  * 03450019
*       OF THE UTILITY.                                               * 03500019
*                                                                     * 03550019
*   2)  BY MEANS OF MESSAGE ADDRESS AND MESSAGE LENGTH INDICATORS     * 03600019
*       IN THE COMMON COMMUNICATION REGION (MSGAD AND MSGLN,          * 03650019
*       RESPECTIVELY).                                                * 03700019
*                                                                     * 03750019
*   THE SECOND OPTION IS REQUESTED BY SETTING BIT 6 OF THE COMMON     * 03800019
*   COMMUNICATION REGION INDICATOR PRTRTN TO 1.  BIT 6 SET TO ZERO    * 03850019
*   INDICATES OPTION 1.                                               * 03900019
*                                                                     * 03950019
*   CALLING SEQUENCE IS AS FOLLOWS:                                   * 04000019
*                                                                     * 04050019
*               L     R15,ATCR220                                     * 04100019
*               BALR  R14,R15                                         * 04150019
*               .                                                     * 04200019
*               .                                                     * 04250019
*               .                                                     * 04300019
*      ATCR220  DC    A(TCR220)                                       * 04350019
*                                                                     * 04400019
*INPUT:                                                               * 04450019
*                                                                     * 04500019
*   1)  STANDARD PARAMETER LIST PASSED VIA REGISTER 1.                * 04550019
*                                                                     * 04600019
*   2)  SYSIN DATA SET CONTAINING UTILITY CONTROL STATEMENTS.  THE    * 04650019
*       DATA SET IS OPENED AND CLOSED BY THE DRIVER.  READING AND     * 04700019
*       PROCESSING OF THE STATEMENTS IS PERFORMED BY THE CONTROL      * 04750019
*       CARD ANALYZER MODULE (IEBTCR04).                              * 04800019
*                                                                     * 04850019
*   3)  SYSUT1 TAPE CARTRIDGE READER DATA SET.  THE DATA SET IS       * 04900019
*       OPENED BY THE DRIVER.  READING AND EDITING IS PERFORMED BY    * 04950019
*       THE READ AND EDIT MODULE (IEBTCR05).                          * 05000019
*                                                                     * 05050019
*OUTPUT:                                                              * 05100019
*                                                                     * 05150019
*   1)  SYSPRINT DATA SET.  DATA CONSISTS OF CONTROL STATEMENT        * 05200019
*       IMAGES, UTILITY COMPLETION MESSAGES, AND IEBXXXX MESSAGES.    * 05250019
*       OUTPUT IS PERFORMED BY MEANS OF THE QSAM ACCESS METHOD.       * 05300019
*                                                                     * 05350019
*   2)  CONSOLE MESSAGES.  CONSISTS OF A MOUNT MESSAGE AND CERTAIN    * 05400019
*       IEB9XXX ERROR MESSAGES.                                       * 05450019
*                                                                     * 05500019
*EXTERNAL ROUTINES:                                                   * 05550019
*                                                                     * 05600019
*        IEBTCR02 - MESSAGE MODULE                                    * 05650019
*                                                                     * 05700019
*   CONTAINS IEBXXXX MESSAGES, A SYSPRINT PAGE HEADING, AND A         * 05750019
*   UTILITY COMPLETION MESSAGE.                                       * 05800019
*                                                                     * 05850019
*        IEBTCR03 - JFCB ANALYZER                                     * 05900019
*                                                                     * 05950019
*   ANALYZES AND EXTRACTS INFORMATION FROM THE DATA SET JOB FILE      * 06000019
*   CONTROL BLOCKS AND FROM THE TASK INPUT/OUTPUT TABLE (TIOT).       * 06050019
*   IT ATTEMPTS TO SET DEFAULTS FOR THOSE DCB PARAMETERS THAT HAVE    * 06100019
*   BEEN OMITTED.                                                     * 06150019
*                                                                     * 06200019
*        IEBTCR04 - CONTROL CARD ANALYZER                             * 06250019
*                                                                     * 06300019
*   READS AND ANALYZES CONTROL STATEMENTS PROVIDED BY THE USER. IT    * 06350019
*   VALIDATES THE STATEMENT CONTENT AND FORMAT AND SETS OPTIONS IN THE* 06400019
*   COMMON COMMUNICATION REGION FOR USE OF THE DRIVER (IEBTCRIN)      * 06450019
*   AND THE READ/EDIT MODULE (IEBTCR05).                              * 06500019
*                                                                     * 06550019
*        IEBTCR05 - READ/EDIT MODULE                                  * 06600019
*                                                                     * 06650019
*   THIS MODULE READS DATA FROM THE SYSUT1 TAPE CARTRIDGE READER      * 06700019
*   DATA SET, EDITS IT, AND OUTPUTS IT TO THE SYSUT2 AND SYSUT3       * 06750019
*   DATA SETS.                                                        * 06800019
*                                                                     * 06850019
*EXITS-NORMAL:  TCR720 - DCB EXIT                                     * 06900019
*   A DCB EXIT IS TAKEN FOR EACH DATA SET AT OPEN.  DEFAULTS ARE SET  * 06950019
*   FOR MISSING DCB PARAMETERS AND A COMPARISON IS MADE OF ALL PARA-  * 07000019
*   METERS TO DETERMINE INCONSISTENCIES.                              * 07050019
*                                                                     * 07100019
*     -ERROR:                                                         * 07150019
*                                                                     * 07200019
*   1)  TCR740 - QSAM SYNAD ROUTINE.  THIS ROUTINE IS ENTERED WHENEVER* 07250019
*       A PERMANENT I/O ERROR OCCURS ON THE SYSIN, SYSPRINT, SYSUT2,  * 07300019
*       OR SYSUT3 DATA SET.  THE ROUTINE ISSUES A SYSNADAF MACRO-     * 07350019
*       INSTRUCTION AND OUTPUTS THE RESULTING MESSAGE TO THE SYSPRINT * 07400019
*       DATA SET.  IF THE ERROR OCCURRED ON SYSPRINT, THE SYNAD       * 07450019
*       MESSAGE IS OUTPUT TO THE CONSOLE.  IF THE MESSAGE BEING OUTPUT* 07500019
*       AT THE TIME OF THE ERROR IS AN IEB-TYPE MESSAGE, IT IS ALSO   * 07550019
*       WRITTEN ON THE CONSOLE.  THE ADDRESS OF THE MESSAGE IS STORED * 07600019
*       IN THE COMMON COMMUNICATION REGION FULL-WORD CURMSGAD.        * 07650019
*                                                                     * 07700019
*   2)  TCR800 - STAE EXIT ROUTINE.   THIS ROUTINE IS ENTERED WHENEVER* 07750019
*       AN ABEND OCCURS DURING EXECUTION OF ANY PHASE OF THE UTILITY. * 07800019
*       AT ENTRY THE ABEND COMPLETION CODE IS PRESENT EITHER IN A STAE* 07850019
*       WORK AREA OR IN REGISTER 1, DEPENDING UPON WHETHER OR NOT A   * 07900019
*       WORK AREA WAS PROVIDED.  REGISTER 0 IS SET TO ZERO IF A WORK  * 07950019
*       AREA HAS BEEN PROVIDED; TWELVE, IF ONE HAS NOT.  THE ROUTINES * 08000019
*       DETERMINE WHETHER THE ABEND WAS CAUSED BY A USER ROUTINE LOAD * 08050019
*       ERROR.  IF IT WAS THEY REQUEST THAT A RETRY ROUTINE BE LOADED * 08100019
*       WHICH SETS INDICATORS AND RETURNS TO THE ABEND-ING MODULE     * 08150019
*       AT A POINT SPECIFIED BY MEANS OF THE STORAGE AREA RETPT.      * 08200019
*       IF THE ERROR WAS NOT A USER ROUTINE LOAD ERROR, THE EXIT      * 08250019
*       ROUTINE ALLOWS ABEND PROCESSING TO CONTINUE.                  * 08300019
*                                                                     * 08350019
*TABLES/WORK AREAS:                                                   * 08400019
*                                                                     * 08450019
*   1)  OPTABLE - CONTAINS CONTROL CARD OPTIONS.  IT IS CONSTRUCTED   * 08500019
*       BY THE CONTROL CARD ANALYZER FOR USE BY THE DRIVER AND THE    * 08550019
*       READ/EDIT MODULE.                                             * 08600019
*                                                                     * 08650019
*   2)  ADDRTAB - CONTAINS ADDRESSES OF USER EXIT AND TRANSLATE       * 08700019
*       ROUTINES AND OF THE MESSAGE MODULE.                           * 08750019
*                                                                     * 08800019
*   3)  NAMETAB - CONTAINS DDNAMES AND EXIT NAMES.                    * 08850019
*                                                                     * 08900019
*   4)  MSGPTRS - CONTAINS ONE ENTRY FOR EACH IEB-TYPE MESSAGE CON-   * 08950019
*       TAINED IN THE MESSAGE MODULE.  EACH ENTRY CONTAINS A REQUEST  * 09000019
*       BYTE, A NAME INSERT BYTE, AN INSERT LOCATION BYTE, AND AN     * 09050019
*       OUTPUT LOCATION BYTE.  IT IS USED FOR REQUESTING OUTPUT OF    * 09100019
*       IEB-TYPE MESSAGES.  A DIRECT ONE-TO-ONE CORRESPONDENCE        * 09150019
*       EXISTS BETWEEN THIS TABLE AND THE MESSAGE MODULE TABLE.       * 09200019
*                                                                     * 09250019
*   5)  INLRECL, PRTLRECL, UT2LRECL, UT3LRECL - DCB DEFAULT TABLES    * 09300019
*       USED BY IEBTCRIN AND IEBTCR03 FOR CONSTRUCTING DEFAULTS       * 09350019
*                                                                     * 09400019
*   6)  USERNAME - CONTAINS USER ROUTINE NAMES                        * 09450019
*                                                                     * 09500019
*ATTRIBUTES:  NON-REENTRANT AND NON-REUSABLE.                         * 09550019
*                                                                     * 09600019
*NOTES:  IEBTCR03, IEBTCR04, AND IEBTCR05 ALL USE THE COMMON          * 09650019
*   COMMUNICATION REGION SET UP WITHIN THE DRIVER MODULE.             * 09700019
*                                                                     * 09750019
*   CONTROL PASSES TO THE DRIVER MODULE FOR INSERTION OF DCB          * 09800019
*   PARAMETERS AT OPEN, FOR CONSTRUCTION OF A SYNAD MESSAGE FOLLOWING * 09850019
*   A PERMANENT I/O ERROR, AND DURING ABEND PROCESSING.               * 09900019
*                                                                     * 09950019
*   A DOM MACRO-INSTRUCTION IS ISSUED BY THE READ/EDIT MODULE         * 10000019
*   (IEBTCR05) TO ERASE THE MOUNT MESSAGE ISSUED BY THE DRIVER ROUTINE* 10050019
*   TCR180.                                                           * 10100019
*                                                                     * 10150019
*   THIS MODULE CONTAINS TYPE C CHARACTER CODE DEPENDENCIES.  THE     * 10200019
*   OPERATION OF THIS MODULE DEPENDS UPON AN INTERNAL REPRESENTATION  * 10250019
*   OF THE EXTERNAL CHARACTER SET WHICH IS EQUIVALENT TO THE ONE USED * 10300019
*   AT ASSEMBLY TIME.  THE CODING HAS BEEN ARRANGED SO THAT REDEFINI- * 10350019
*   TION OF CHARACTER CONSTANTS, BY RE-ASSEMBLY, WILL RESULT IN A     * 10400019
*   CORRECT MODULE FOR THE NEW DEFINITIONS.  CHARACTER CONSTANTS      * 10450019
*   INVOLVED ARE AS FOLLOWS:                                          * 10500019
*                                                                     * 10550019
*   1)  COMMA AND HEXSPACE WHICH ARE USED BY ROUTINE TCR180 FOR CON-  * 10600019
*       STRUCTING THE MOUNT MESSAGE                                   * 10650019
*                                                                     * 10700019
*   2)  SYNUR, SYNTA, AND SYNDA WHICH ARE USED FOR DETERMINING THE    * 10750019
*       TYPE OF MESSAGE PROVIDED BY THE QSAM SYNADAF INSTRUCTION      * 10800019
*       (UNIT RECORD, TAPE, OR DIRECT ACCESS).                        * 10850019
*                                                                     * 10900019
*   3)  SYNMSGUR, SYNMSGTA, AND SYNMSGDA WHICH CONTAIN MESSAGE        * 10950019
*       IDENTIFIERS (IEB920I, IEB921I, IEB922I)                       * 11000019
*                                                                     * 11050019
*                                                                     * 11100019
*   IF WORLD TRADE REQUIREMENTS NECESSITATE MODIFICATION OF THE       * 11150019
*   MESSAGE TEXT CONTAINED IN THE MESSAGE MODULE, IT MAY BE NECESSARY * 11200019
*   TO CHANGE THE INSERT LOCATION DISPLACEMENTS CONTAINED IN THE      * 11250019
*   MESSAGE POINTER TABLE MSGPTRS PRESENT IN THE COMMON COMMUNICATION * 11300019
*   REGION CSECT TCRCOM.  INSTRUCTIONS ARE PROVIDED FOR MAKING THIS   * 11350019
*   MODIFICATION.                                                     * 11400019
*                                                                     * 11450019
*   IF CHANGES ARE MADE TO THE MESSAGE IDENTIFIERS CONTAINED IN THE   * 11500019
*   MESSAGE MODULE, IT MAY ALSO BE NECESSARY TO CHANGE THE IDENTIFIERS* 11550019
*   IEB920I, IEB921I, AND IEB922I WHICH ARE DEFINED BY THE DC'S       * 11600019
*   SYNMSGUR, SYNMSGTA, AND SYNMSGDA CONTAINED IN THIS MODULE.        * 11650019
*   COMMENTS ARE PROVIDED.                                            * 11700019
  TITLE 'IEBTCRIN - DRIVER MODULE - REGISTER DEFINITIONS'               11750019
IEBTCRIN START 0                                                        11800019
         SPACE 2                                                        11850019
*        REGISTER DEFINITIONS                                           11900019
         SPACE 2                                                        11950019
LNKREG0  EQU   0                       LOAD MODULE LINKAGE REGISTER     12000019
PARMREG  EQU   1                       PARAMETER LIST REGISTER          12050019
NAMEREG  EQU   3                       USER NAME TABLE PTR              12100019
ADDREG   EQU   4                       USER RTN ADDR TABLE PTR          12150019
DCBREG   EQU   5                       DCB REGISTER                     12200019
INDREG   EQU   5                       INDICATOR MASK REGISTER          12250019
MSGCTR   EQU   6                       MSG INSERT INDICATOR             12300019
COMMREG  EQU   11                      COMMUNICATION REGION             12350019
BASEREG  EQU   12                      BASE REGISTER                    12400019
SAVEREG  EQU   13                      SAVEAREA REGISTER                12450019
RETREG   EQU   14                      RETURN REGISTER                  12500019
LNKREG15 EQU   15                      SUBROUTINE LINKAGE REGISTER      12550019
BASE15   EQU   15                      BASE REGISTER                    12600019
         SPACE 1                                                        12650019
R0       EQU   0                       REGISTER   0                     12700019
R1       EQU   1                       REGISTER   1                     12750019
R2       EQU   2                       REGISTER   2                     12800019
R3       EQU   3                       REGISTER   3                     12850019
R4       EQU   4                       REGISTER   4                     12900019
R5       EQU   5                       REGISTER   5                     12950019
R6       EQU   6                       REGISTER   6                     13000019
R7       EQU   7                       REGISTER   7                     13050019
R8       EQU   8                       REGISTER   8                     13100019
R9       EQU   9                       REGISTER   9                     13150019
R10      EQU   10                      REGISTER  10                     13200019
R12      EQU   12                      REGISTER  12                     13250019
R14      EQU   14                      REGISTER  14                     13300019
R15      EQU   15                      REGISTER  15                     13350019
  TITLE 'IEBTCRIN - DRIVER MODULE - MAINLINE'                           13400019
*        THIS SECTION SAVES THE CALLING MODULE'S BASE REGISTERS,        13450019
*        SETS UP A SAVEAREA ADDRESS, AND ESTABLISHES BASE REGISTERS     13500019
*        FOR THE MAIN CSECT AND FOR THE COMMUNICATION REGION CSECT.     13550019
         SPACE 2                                                        13600019
         SAVE  (14,12),T,IEBTCRIN      SAVE REGISTERS                   13650019
         BALR  BASEREG,R0              ESTABLISH BASE REGISTER          13700019
         USING *,BASEREG               INDICATE BASE REGISTER           13750019
TCR050   LR    R15,SAVEREG             SET UP SAVEAREA POINTERS         13800019
         ST    R15,SAVEAREA+4                                           13850019
         LA    SAVEREG,SAVEAREA                                         13900019
         ST    SAVEREG,8(R15)                                           13950019
         SR    R15,R15                                                  14000019
         ST    R15,0(SAVEREG)                                           14050019
         ST    PARMREG,SAVEPARM        SAVE PARAMETER LIST POINTER      14100019
         ST    BASEREG,DRIVBASE        STORE DRIVER BASE ADDRESS        14150019
         STAE TCR800,CT,PARAM=USERLIST,XCTL=NO  ESTABLISH STAE          14200019
*                                      ENVIRONMENT                      14250019
         LTR   LNKREG15,LNKREG15       SUCCESSFUL CREATION              14300019
         BZ    TCR060                  BR YES                           14350019
         MVI   USERLIST+1,STAEFAIL     INDICATE FAILURE                 14400019
TCR060   L     COMMREG,ATCRCOM         LOAD BASE REG FOR COMMON AREA    14450019
         USING TCRCOM,COMMREG          INDICATE COMM. REGION BASE REG   14500019
         EJECT                                                          14550019
*        DRIVER MAINLINE                                                14600019
         SPACE 1                                                        14650019
*        THIS ROUTINE CONTROLS THE FLOW OF THE ENTIRE UTILITY. IT       14700019
*        CALLS THE FOLLOWING PROCESSING ROUTINES AND MODULES:           14750019
         SPACE 1                                                        14800019
*              TCR120 - PARAMETER LIST PROCESSOR                        14850019
*              TCR130 - MESSAGE MODULE LOADER                           14900019
*            IEBTCR03 - JOB FILE CONTROL BLOCK ANALYZER                 14950019
*              TCR140 - SYSPRINT OPEN AND ALLOCATION                    15000019
*              TCR150 - CONTROL CARD ANALYZER INTERFACE                 15050019
*              TCR160 - USER ROUTINE LOADER                             15100019
*              TCR170 - DCB DEFAULT COMPLETION                          15150019
*              TCR180 - SYSUT1 OPEN ROUTINE                             15200019
*            IEBTCR05 - READ/EDIT MODULE                                15250019
*              TCR190 - SYSUT1 SYNAD ROUTINE                            15300019
*              TCR220 - MESSAGE WRITER                                  15350019
         SPACE 1                                                        15400019
*        FOLLOWING EXECUTION OF EACH CALLED ROUTINE OR MODULE,          15450019
*        THE DRIVER MAINLINE ROUTINE TESTS WHETHER OR NOT EXECUTION     15500019
*        SHOULD CONTINUE.                                               15550019
         SPACE 2                                                        15600019
TCR100   BAL   RETREG,TCR120           LOAD ADDR PARAM PROC ROUTINE     15650019
         BAL   RETREG,TCR130           LOAD ADDR MSG MODULE LOAD RTN    15700019
TCR102   LINK  EP=IEBTCR03,PARAM=TCRCOM  LINK TO JFCB ANALYZER          15750019
         DELETE  EP=IEBTCR03           DELETE JFCB ANALYZER             15800019
         BAL   RETREG,TCR140           OPEN SYSPRINT DCB, ALLOCATE      15850019
*                                        STORAGE                        15900019
         TM    ERRIND,ALLONE           ANY ERROR                        15950019
         BNZ   TCR108                  BR YES                           16000019
         BAL   RETREG,TCR150           CONTROL CARD ANALYZER INTERFACE  16050019
         TM    ERRIND,ALLONE           CONTROL CD ERROR?                16100019
         BNZ   TCR108                  BR - YES                         16150019
         BAL   RETREG,TCR160           LOAD USER EXIT RTN LOADER ADDR   16200019
         TM    ERRIND,LOADERR          ERROR LOADING USER EXIT ROUTINES 16250019
         BO    TCR108                  BR - YES                         16300019
         BAL   RETREG,TCR170           COMPLETE DCB DEFAULTS WITH MAXLN 16350019
*                                        INCREMENT                      16400019
         TM    ERRIND,ALLONE           ANY ERROR                        16450019
         BNZ   TCR108                  BR YES                           16500019
         BAL   RETREG,TCR180           OPEN TCR AND ISSUE MOUNT MSG     16550019
         LOAD  EP=IEBTCR05             LOAD READ/EDIT MODULE     YM2512 16600002
         LA    1,*+8                   LOAD ADDRESS OF TCRCOM    YM2522 16610002
         B     *+8                     BRANCH AROUND CONSTANT    YM2522 16612002
         DC    A(TCRCOM)               ADDRESS OF TCRCOM         YM2522 16614002
         LR    LNKREG15,LNKREG0        LOAD REG 15 WITH ADDRESS  YM2512 16620002
         BALR  RETREG,LNKREG15         BAL TO READ EDIT MODULE   YM2512 16630002
         TM    MSG14+1,UT2             SYSUT2 DCB PARAMETERS MISSING    16650019
         BO    TCR105                  BR NO                            16700019
         PACK  MSG14+1(1),MSG14+1(1)   SWITCH THE TWO INSERT DIGITS     16750019
TCR105   TM    ERRIND,IORDERR          PERMANENT I/O ERROR SYSUT1       16800019
         BNO   TCR107                  BR NO                            16850019
         TM    DUMMYIND,DUMSYSP        SYSPRINT DUMMY                   16900019
         BO    TCR107                  BR YES                           16950019
         BAL   RETREG,TCR190           ISSUE SYNAD MESSAGE FOR SYSUT1   17000019
TCR107   CLOSE  (TCRDCB)               CLOSE SYSUT1 DCB                 17050019
         DELETE  EP=IEBTCR05           DELETE READ/EDIT MODULE          17100019
         TM    ERRIND,RDEDERR          ERROR IN READ & EDIT             17150019
         BO    TCR1073                 BR YES                           17200019
         TM    ERRIND,CONFLERR         INCONSISTENT DCB PARAMETERS      17250019
         BNO   TCR108                  BR NO                            17300019
TCR1073  MVI   RETCODE,CODE16          SET RETURN CODE 16               17350019
TCR108   MVI   CARRCTRL,DOUBLESP       SET DOUBLE SPACE                 17400019
         L     LNKREG15,ATCR220        LOAD MESSAGE WRITER ADDRESS      17450019
         BALR  RETREG,LNKREG15         DISPLAY MESSAGES                 17500019
TCR1083  TM    DUMMYIND,DUMSYSP        SYSPRINT DUMMY                   17550019
         BO    TCR109                  BR YES                           17600019
         MVI   CARRCTRL,DOUBLESP       DOUBLE SPACE                     17650019
         L     R5,MSGADDR              LOAD MSG TABLE ADDRESS           17700019
         L     R6,COMPMSG(R5)          LOAD MSG ADDRESS                 17750019
         LA    R6,0(R6)                CLEAR LENGTH BYTE                17800019
         ST    R6,MSGAD                STORE MSG ADDRESS                17850019
         MVC   MSGLN(1),COMPMSG(R5)    STORE MSG LENGTH                 17900019
         OI    PRTRTN,RTN310           SET SINGLE MSG INDICATOR         17950019
         L     LNKREG15,ATCR220        LOAD MESSAGE WRITER ADDRESS      18000019
         BALR  RETREG,LNKREG15         DISPLAY MESSAGE                  18050019
         CLOSE (SYSPRDCB)              CLOSE SYSPRINT                   18100019
         TM    ERRIND,ALLOCERR         GETMAIN ALLOCATION ERROR         18150019
         BO    TCR109                  BR YES                           18200019
         L     R1,PRTAREA              LOAD ADDR PRINT STORAGE          18250019
         L     R0,PRTLNGTH             LOAD STORAGE LENGTH              18300019
         FREEMAIN  R,LV=(0),A=(1)      FREE SYSPRINT AREA               18350019
TCR109   STAE  0                                                        18400019
         XR    R15,R15                 CLEAR RETURN CODE REGISTER       18450019
         IC    R15,RETCODE             INSERT RETURN CODE               18500019
         L     SAVEREG,4(SAVEREG)                                       18550019
         RETURN (14,12),T,RC=(15)                                       18600019
  TITLE 'IEBTCRIN - DRIVER MODULE - PARAMETER LIST PROCESSOR'           18650019
*        PARAMETER LIST PROCESSOR                                       18700019
         SPACE 1                                                        18750019
*        THIS ROUTINE STORES ANY ALTERNATE DDNAMES THAT MAY HAVE        18800019
*        BEEN PROVIDED BY THE INVOKING MODULE.                          18850019
         SPACE 2                                                        18900019
TCR120   ST    RETREG,SAVE100          SAVE RETURN REGISTER             18950019
         L     R4,SAVEPARM             LOAD ADDR PARAMETER LIST         19000019
         TM    OPTLIST(R4),LASTPARM    PARAMETER LIST VOID?             19050019
         BO    TCR129                  BR IF YES                        19100019
         L     R5,DDLIST(R4)           LOAD ADDR DDLIST                 19150019
         LTR   R5,R5                   LOAD AND TEST DDLIST ADDR        19200019
         BZ    TCR129                  BR IF ADDRESS ZERO               19250019
         LH    R9,0(R5)                LOAD COUNT                       19300019
         LA    R5,DSYSIN-6(R5)         SET AT FIRST DD ENTRY MINUS 8    19350019
         LA    R6,NAMETAB-DDLNGTH      LOAD ZERO ENTRY OF DDTABLE       19400019
         LA    R7,DSYSIN               INITIALIZE REGISTER TO ZERO      19450019
         LA    R8,DDINCR               LOAD INCREMENT                   19500019
         LA    R3,DSYSPRT+DDINCR       SET BYPASS INDICATOR             19550019
TCR122   BXH   R7,R8,TCR126            BR WHEN ALL ENTRIES TESTED       19600019
         LA    R5,DDINCR(R5)           INCREMENT INPUT DDLIST ADDR      19650019
         LA    R6,DDINCR(R6)           INCREMENT OUTPUT DDLIST ADDR     19700019
         CLC   0(DDLNGTH,R5),ZEROES    DDNAME EQUAL TO HEX ZEROES       19750019
         BE    TCR124                  BR IF YES                        19800019
         MVC   0(DDLNGTH,R6),0(R5)     MOVE NEW DDNAME                  19850019
TCR124   CLR   R7,R3                   SECOND DDNAME?                   19900019
         BNE   TCR122                  BR IF NO                         19950019
         LA    R5,DDLNGTH(R5)          BYPASS NEXT TABLE ENTRY          20000019
         LA    R7,DDLNGTH(R7)          BYPASS NEXT TABLE ENTRY          20050019
         B     TCR122                  BR TO LOOP                       20100019
TCR126   OI    MISCIND,DDON            SET DDNAME SWAP IND ON           20150019
TCR129   L     RETREG,SAVE100          LOAD RETURN ADDRESS              20200019
         BR    RETREG                  RETURN                           20250019
  TITLE 'IEBTCRIN - DRIVER MODULE - MESSAGE MODULE LOADER'              20300019
*        MESSAGE MODULE LOADER                                          20350019
         SPACE 2                                                        20400019
TCR130   ST    RETREG,SAVE100          SAVE RETURN ADDRESS              20450019
         MVI   USERLIST,MSGMODL        INDICATE MSG MODULE              20500019
         LOAD  EP=IEBTCR02             LOAD MESSAGE MODULE              20550019
TCR137   ST    LNKREG0,MSGADDR         SAVE MSG MODULE ADDR             20600019
TCR139   L     RETREG,SAVE100          LOAD RETURN ADDRESS              20650019
         BR    RETREG                  RETURN                           20700019
  TITLE 'IEBTCRIN - DRIVER MODULE - SYSPRINT OPEN ROUTINE'              20750019
*        SYSPRINT OPEN AND STORAGE ALLOCATION                           20800019
         SPACE 1                                                        20850019
*        THIS ROUTINE OPENS THE SYSPRINT DATA SET, ALLOCATES            20900019
*        STORAGE FOR A WORKAREA, AND OUTPUTS A SYSPRINT PAGE HEADING.   20950019
         SPACE 2                                                        21000019
TCR140   ST    RETREG,SAVE100          SAVE RETURN ADDRESS              21050019
         TM    DUMMYIND,DUMSYSP        SYSPRINT DUMMY                   21100019
         BO    TCR149                  BR YES                           21150019
         LA    R2,SYSPRDCB             LOAD DCB ADDRESS                 21200019
         USING IHADCB,R2               INDICATE DCB DSECT REGISTER      21250019
         OPEN  (SYSPRDCB,(OUTPUT))     OPEN SYSPRINT                    21300019
         TM    ERRIND,CONFLERR         INCONSISTENT DCB PARAMETERS      21350019
         BO    TCR149                  BR YES                           21400019
         TM    DCBOFLGS,DCBOPEN        OPEN SUCCESSFUL                  21450019
         BO    TCR1403                 BR YES                           21500019
         MVI   MSG15,MSGREQ            SET MSG INDICATOR                21550019
         MVI   MSG15+1,PRT             SET SYSPRINT INSERT              21600019
         MVI   RETCODE,CODE16          SET RETURN CODE 16               21650019
TCR1403  LH    R1,DCBLRECL             LOAD LRECL                       21700019
         LA    R1,8(R1)                ADD 8 BYTES                      21750019
         ST    R1,PRTLNGTH             STORE NEW LENGTH                 21800019
         LR    R0,R1                   SET UP PARAMETER REGISTER        21850019
         BAL   RETREG,TCR420           GETMAIN STORAGE                  21900019
         TM    ERRIND,ALLOCERR         ALLOCATION ERROR                 21950019
         BNO   TCR141                  BR NO                            22000019
         OI    DUMMYIND,DUMSYSP        SET SYSPRINT DUMMY               22050019
         B     TCR149                  BR TO RETURN                     22100019
TCR141   MVC   PRTAREA(8),GETMADD      STORE ADDRESS AND LENGTH         22150019
         L     R1,PRTAREA              LOAD PRINT AREA ADDRESS          22200019
         B     TCR145                  BYPASS CLEAR INSTRUCTION         22250019
         SPACE 1                                                        22300019
TCR142   MVC   1(0,R1),0(R1)           CLEAR PRINT AREA                 22350019
         SPACE 1                                                        22400019
TCR145   LH    R2,DCBLRECL             FIND PRTAREA LENGTH              22450019
         LA    R2,6(R2)                INCREMENT 6 BYTES                22500019
         EX    R2,TCR142               CLEAR PRINT AREA                 22550019
         MVI   CARRCTRL,NEWPAGE        SET NEW PAGE CARRIAGE CONTROL    22600019
         L     R5,MSGADDR              LOAD MSG TABLE ADDRESS           22650019
         L     R6,HDGMSG(R5)           LOAD MSG ADDRESS                 22700019
         LA    R6,0(R6)                CLEAR LENGTH BYTE                22750019
         ST    R6,MSGAD                STORE MSG ADDRESS                22800019
         MVC   MSGLN(1),HDGMSG(R5)     STORE MSG LENGTH                 22850019
         OI    PRTRTN,RTN310           SET SINGLE MSG INDICATOR         22900019
         L     LNKREG15,ATCR220        LOAD MESSAGE WRITER ADDRESS      22950019
         BALR  RETREG,LNKREG15         DISPLAY MESSAGE                  23000019
         MVI   CARRCTRL,DOUBLESP       INDICATE DOUBLESPACING FOR       23050019
*                                      NEXT MESSAGE                     23100019
TCR149   L     RETREG,SAVE100          LOAD RETURN ADDRESS              23150019
         BR    RETREG                  RETURN                           23200019
  TITLE 'IEBTCRIN - DRIVER MODULE - CTRL CARD ANALYZER INTERFACE'       23250019
*        CONTROL CARD ANALYZER INTERFACE                                23300019
         SPACE 1                                                        23350019
*        THIS ROUTINE OPENS THE SYSIN DATA SET IF ONE HAS BEEN          23400019
*        PROVIDED, ALLOCATES CORE FOR A WORK AREA, CALLS THE MESSAGE    23450019
*        WRITER TO OUTPUT ANY ERROR MESSAGES DEVELOPED UP TO THIS       23500019
*        POINT, LINKS TO THE CONTROL CARD ANALYZER, AND CLOSES THE      23550019
*        SYSIN DATA SET.                                                23600019
*        IF NO SYSIN DD STATEMENT WAS PROVIDED, THE ROUTINE SETS        23650019
*        DEFAULT OPTIONS.                                               23700019
         SPACE 2                                                        23750019
TCR150   ST    RETREG,SAVE100          SAVE RETURN ADDRESS              23800019
         TM    DUMMYIND,DUMSYSIN       SYSIN DUMMY                      23850019
         BO    TCR156                  BR TO SET DEFAULTS               23900019
         OPEN  (SYSINDCB,(INPUT))      OPEN SYSIN                       23950019
         TM    ERRIND,CONFLERR         INCONSISTENT DCB PARAMETERS      24000019
         BO    TCR159                  BR YES                           24050019
         LA    R2,SYSINDCB             LOAD SYSIN DCB ADDRESS           24100019
         TM    DCBOFLGS,DCBOPEN        OPEN SUCCESSFUL                  24150019
         BO    TCR151                  BR YES                           24200019
         MVI   MSG15,MSGREQ            SET MSG INDICATOR                24250019
         MVI   MSG15+1,IN              SET SYSIN INSERT                 24300019
         MVI   RETCODE,CODE16          SET RETURN CODE 16               24350019
TCR151   LA    R1,CARDLN(0,0)          LOAD LENGTH 80                   24400019
         BAL   RETREG,TCR420           GET REQUESTED STORAGE            24450019
         TM    ERRIND,ALLOCERR         ALLOCATION ERROR                 24500019
         BO    TCR159                  BR YES                           24550019
         MVI   CARRCTRL,DOUBLESP       SET DOUBLE SPACE                 24600019
         L     LNKREG15,ATCR220        PRINT MESSAGES REQUESTED UP      24650019
         BALR  RETREG,LNKREG15           TO THIS POINT                  24700019
         L     R1,GETMADD              LOAD GETMAINED STORAGE ADDRESS   24750019
TCR152   ST    R1,CARDAREA             STORE WORK AREA ADDRESS          24800019
         LA    R1,8(R1)                SET AT COLUMN 9                  24850019
         ST    R1,COLUMN9              STORE COLUMN 9 ADDRESS           24900019
         LA    R1,INC63(R1)            SET AT COLUMN 72                 24950019
         ST    R1,CARDEND              STORE COLUMN 72 ADDRESS          25000019
         LINK  EP=IEBTCR04,PARAM=TCRCOM   LINK TO CONTROL CD ANALYZER   25050019
         DELETE  EP=IEBTCR04           DELETE CONTROL CD ANALYZER       25100019
         L     R1,CARDAREA             LOAD GETMAINED STORAGE ADDRESS   25150019
         FREEMAIN  R,LV=80,A=(1)       FREE STORAGE                     25200019
         TM    ERRIND,QSAMERR          PERMANENT I/O ERROR SYSIN        25250019
         BO    TCR159                  BR YES                           25300019
         CLOSE (SYSINDCB)              CLOSE SYSIN                      25350019
         B     TCR159                  BR TO RETURN                     25400019
         SPACE 1                                                        25450019
*        SET DEFAULTS                                                   25500019
         SPACE 1                                                        25550019
TCR156   MVC   OPTABLE+1(2),MTDIDEFT   SET PARM1 AND PARM2 OPTIONS      25600019
         MVI   MSG11,MSGREQ            SET MSG INDICATOR                25650019
         MVI   RETCODE,CODE04          SET RETURN CODE                  25700019
TCR159   L     RETREG,SAVE100          LOAD RETURN ADDRESS              25750019
         BR    RETREG                  RETURN                           25800019
  TITLE 'IEBTCRIN - DRIVER MODULE - USER ROUTINE LOADER'                25850019
*        USER ROUTINE LOADER                                            25900019
         SPACE 1                                                        25950019
*        THIS ROUTINE USES THE CONTROL CARD OPTION TABLE (IEXITS)       26000019
*        AND THE USER ROUTINE NAME TABLE (USERNAME) TO LOAD THE         26050019
*        SPECIFIED USER EXIT ROUTINES AND TRANSLATE TABLE.  IT          26100019
*        STORES THE ADDRESSES OF THE LOADED MODULES IN THE COMMON       26150019
*        COMMUNICATION REGION ADDRESS TABLE (USERADDR).                 26200019
*        IF IT FAILS TO FIND A ROUTINE, THE STAE EXIT ROUTINE           26250019
*        (TCR800) IS SCHEDULED DURING THE RESULTING ABEND PROCESSING.   26300019
*        IF THE STAE EXIT ROUTINE DETERMINES THAT THE ABEND WAS         26350019
*        CAUSED BY LOADING A NON-EXISTENT USER MODULE, IT REQUESTS      26400019
*        THAT THE STAE RETRY ROUTINE (TCR810) BE SCHEDULED.  THIS       26450019
*        ROUTINE RESTORES BASE REGISTERS, SETS ERROR AND MESSAGE        26500019
*        INDICATORS, AND RETURNS CONTROL TO THE LOADER AT TCR165.       26550019
         SPACE 2                                                        26600019
TCR160   ST    RETREG,SAVE100          SAVE RETURN ADDRESS              26650019
         LA    MSGCTR,HDR2IND-1        INITIALIZE MSG INDICATOR         26700019
         SR    INDREG,INDREG           ZERO REGISTER                    26750019
         LH    INDREG,INDMSK           LOAD INDICATOR MASK              26800019
         LA    NAMEREG,USERNAME-8      LOAD USER ROUTINE NAME TABLE AD  26850019
         LA    ADDREG,USERADDR-4       LOAD USER ROUT ADDR TABLE ADDR   26900019
TCR162   CLC   TCR164+1(1),LASTROUT    LAST POSS ROUTINE LOADED?        26950019
         BE    TCR168                  BR IF YES                        27000019
         SRL   INDREG,SHIFTLN          SHIFT MASK ONE BIT               27050019
         STC   INDREG,TCR164+1         STORE MASK IN TEST MSK INST      27100019
         LA    NAMEREG,8(NAMEREG)      INCR TO NEXT NAME ENTRY          27150019
         LA    ADDREG,4(ADDREG)        INCR TO NEXT ADDR ENTRY          27200019
         LA    MSGCTR,1(MSGCTR)        INCREMENT MSG INDICATOR          27250019
TCR164   TM    IEXITS,HEXZERO          MUST THIS ROUTINE BE LOADED      27300019
         BZ    TCR162                  BR IF NO                         27350019
         MVC   ENTPT(8),0(NAMEREG)     SET UP ROUTINE NAME              27400019
         STC   MSGCTR,USERLIST         STORE ROUTINE INDICATOR          27450019
         LOAD  EPLOC=ENTPT             LOAD NEXT MODULE                 27500019
         SPACE 1                                                        27550019
*        STAE PROCESSING RETURN POINT                                   27600019
         SPACE 1                                                        27650019
TCR165   TM    ERRIND,LOADERR          ERROR INDICATOR SET              27700019
         BO    TCR169                  BR YES                           27750019
         LTR   LNKREG0,LNKREG0         ADDRESS STORED                   27800019
         BZ    TCR169                  BR NO                            27850019
TCR167   ST    LNKREG0,0(ADDREG)       STORE USER ROUTINE ADDR          27900019
         B     TCR162                  BR TO LOOP                       27950019
         SPACE 1                                                        28000019
*        SET USER TRANSLATE TABLE ADDRESS TO ZERO IF TABLE NOT          28050019
*        PROVIDED BY USER                                               28100019
         SPACE 1                                                        28150019
TCR168   TM    IEXITS,USERTAB          USER TRANSLATE TABLE PRESENT     28200019
         BO    TCR169                  BR YES                           28250019
         MVC   USERADDR+24(4),ZEROES   SET ADDRESS TO ZERO              28300019
TCR169   L     RETREG,SAVE100          LOAD RETURN ADDRESS              28350019
         BR    RETREG                  RETURN                           28400019
  TITLE 'IEBTCRIN - DRIVER MODULE - DCB DEFAULT COMPLETION'             28450019
*        DCB DEFAULT COMPLETION                                         28500019
         SPACE 1                                                        28550019
*        THIS ROUTINE INCREMENTS THE BASIC DEFAULTS DEVELOPED BY        28600019
*        THE JFCB ANALYZER FOR THE SYSUT2 AND SYSUT3 DCB'S BY THE       28650019
*        MAXLN VALUE IF ONE OR MORE PARAMETERS WERE OMITTED BY THE      28700019
*        USER.                                                          28750019
*        IF EDITING WAS SPECIFIED BY THE USER, AN ADDITIONAL FOUR       28800019
*        BYTES ARE ADDED TO THE SYSUT3 DEFAULTS TO ACCOMODATE THE       28850019
*        ERROR DESCRIPTOR WORD.                                         28900019
         SPACE 1                                                        28950019
TCR170   ST    RETREG,SAVE100                                           29000019
         SPACE 1                                                        29050019
*        SET UP MAXLN                                                   29100019
         SPACE 1                                                        29150019
         CLC   MAXLN(2),ZEROES         MAXLN EQUALS ZERO?               29200019
         BNE   TCR172                  BR NO                            29250019
         MVI   MAXLN+1,DEF120          MOVE DEFAULT TO MAXLN            29300019
         SPACE 1                                                        29350019
TCR172   TM    MISCIND,UT2LRLMX        DOES SYSUT2 LRECL REQUIRE MAXLN  29400019
         BNO   TCR173                  BR NO                            29450019
         LH    R2,UT2LRECL             ADD MAXLN TO LRECL               29500019
         AH    R2,MAXLN                                                 29550019
         STH   R2,UT2LRECL             REPLACE LRECL                    29600019
         SPACE 1                                                        29650019
TCR173   TM    MISCIND,UT2BLKMX        SYSUT2 BLKSIZE REQUIRE MAXLN?    29700019
         BNO   TCR174                  BR NO                            29750019
         LH    R2,UT2BLK               ADD MAXLN TO BLKSIZE             29800019
         AH    R2,MAXLN                                                 29850019
         STH   R2,UT2BLK               REPLACE BLKSIZE                  29900019
         SPACE 1                                                        29950019
TCR174   TM    MISCIND,UT3LRLMX        SYSUT3 LRECL REQUIRE MAXLN?      30000019
         BNO   TCR176                  BR NO                            30050019
         LH    R2,UT3LRECL             ADD MAXLN TO LRECL               30100019
         AH    R2,MAXLN                                                 30150019
         TM    IPARM2,EDITSPEC         EDIT SPECIFIED                   30200019
         BZ    TCR175                  BR NO                            30250019
         LA    R2,4(R2)                ADD 4-BYTE ERROR DESCRIPTOR      30300019
TCR175   STH   R2,UT3LRECL             REPLACE LRECL                    30350019
         SPACE 1                                                        30400019
TCR176   TM    MISCIND,UT3BLKMX        DOES SYSUT3 BLKSIZE REQUIRE      30450019
         BNO   TCR179                    MAXLN -  BR NO                 30500019
         LH    R2,UT3BLK               LOAD BLKSIZE                     30550019
         AH    R2,MAXLN                ADD MAXLN TO BLKSIZE             30600019
         TM    IPARM2,EDITSPEC         EDIT SPECIFIED                   30650019
         BZ    TCR178                  BR NO                            30700019
         LA    R2,4(R2)                ADD 4-BYTE ERROR DESCRIPTOR      30750019
TCR178   STH   R2,UT3BLK               REPLACE BLKSIZE                  30800019
TCR179   L     RETREG,SAVE100          LOAD RETURN ADDRESS              30850019
         BR    RETREG                  RETURN TO MAINLINE               30900019
  TITLE 'IEBTCRIN - DRIVER MODULE - SYSUT1 OPEN ROUTINE'                30950019
*        SYSUT1 OPEN ROUTINE                                            31000019
         SPACE 1                                                        31050019
*        THIS ROUTINE OPENS THE SYSUT1 DATA SET, ESTABLISHES THE        31100019
*        BUFFER SIZE, AND ISSUES THE MOUNT MESSAGE.                     31150019
         SPACE 2                                                        31200019
TCR180   ST    RETREG,SAVE100          SAVE RETURN ADDRESS              31250019
         OPEN  (TCRDCB,(INPUT))        OPEN SYSUT1 DATA SET             31300019
         LA    R2,TCRDCB               LOAD DCB ADDRESS                 31350019
         XR    R10,R10                 ZERO WKREG                       31400019
         LH    R10,DCBBUFL             INSERT BUFFER LENGTH             31450019
         LTR   R10,R10                 LENGTH ZERO                      31500019
         BNZ   TCR182                  BR NOT ZERO                      31550019
         LA    R10,DEFBUFL             LOAD DEFAULT BUF LENGTH          31600019
TCR182   STH   R10,TCRBUFL             STORE BUFFER LENGTH              31650019
         L     R10,MSGADDR             LOAD  ADDR OF MSG MODULE         31700019
         L     R9,0(R10)               LOAD  PTR TO MOUNT MSG           31750019
         LA    R9,0(R9)                CLEAR LENGTH                     31800019
         MVC   14(3,R9),TCRDEV         MOVE DEVICE TYPE                 31850019
         MVC   18(6,R9),VOLSER         MOVE DATA SET EXTERNAL NAME      31900019
         MVI   25(R9),HEXSPACE         MOVE SPACE                       31950019
         MVC   26(16,R9),25(R9)        CLEAR MSG AREA                   32000019
         MVC   25(8,R9),JOBNAME        MOVE  JOB NAME                   32050019
         LA    R5,24(R9)               SET POINTER TO JOB START         32100019
         LA    R6,ONE                  LOAD INCREMENT                   32150019
         LA    R7,32(R9)               LOAD ENDING ADDRESS              32200019
TCR184   BXH   R5,R6,TCR186            BR ALL EIGHT CHARACTERS NON-BLK  32250019
         CLI   0(R5),HEXSPACE          SPACE                            32300019
         BNE   TCR184                  BR NO                            32350019
TCR186   MVI   0(R5),COMMA             INSERT COMMA                     32400019
         MVC   1(8,R5),STEPNAME        INSERT STEP NAME                 32450019
         WTO   MF=(E,(R9))             ISSUE MOUNT WTO                  32500019
         ST    R1,MOUNTID              STORE MOUNT MSG ID               32550019
TCR189   L     RETREG,SAVE100          LOAD RETURN ADDRESS              32600019
         BR    RETREG                  RETURN                           32650019
  TITLE 'IEBTCRIN - DRIVER MODULE - SYSUT1 SYNAD ROUTINE'               32700019
*        SYSUT1 SYNAD ROUTINE                                           32750019
         SPACE 1                                                        32800019
*        THIS ROUTINE ISSUES THE SYNADAF MACRO-INSTRUCTION FOR          32850019
*        THE SYSUT1 DATA SET AND OUTPUTS THE MESSAGE CONSTRUCTED        32900019
         SPACE 2                                                        32950019
TCR190   ST    RETREG,SAVE100          SAVE RETURN ADDRESS              33000019
         TM    DUMMYIND,DUMSYSP        SYSPRINT DUMMY                   33050019
         BO    TCR199                  BR YES                           33100019
         L     R2,IOBADDR              LOAD IOB ADDRESS                 33150019
TCR192   SYNADAF  ACSMETH=EXCP,PARM1=(R2)   ISSUE SYNADAF               33200019
         L     R3,PRTAREA              LOAD PRTAREA ADDRESS             33250019
         MVC   SYNIDENT(8,R1),SYNMSGUR MOVE MSG IDENT                   33300019
         LA    R4,SYNLNGTH             STORE MSG LENGTH                 33350019
         STC   R4,MSGLN                STORE LENGTH                     33400019
         LA    R5,SYNIDENT(R1)         STORE MSG ADDRESS                33450019
         ST    R5,MSGAD                STORE MSG LENGTH                 33500019
         OI    PRTRTN,RTN310           SET SINGLE MSG INDICATOR         33550019
         MVI   CARRCTRL,DOUBLESP       INDICATE DOUBLE-SPACING          33600019
         L     LNKREG15,ATCR220        LOAD MESSAGE WRITER ADDR         33650019
         BALR  RETREG,LNKREG15         DISPLAY MESSAGE                  33700019
         SYNADRLS                      RELEASE SYNAD MESSAGE AREA       33750019
TCR199   L     RETREG,SAVE100          LOAD RETURN ADDRESS              33800019
         BR    RETREG                  RETURN                           33850019
  TITLE 'IEBTCRIN - DRIVER MODULE - STORAGE ALLOCATION ROUTINE'         33900019
*        STORAGE ALLOCATION ROUTINE                                     33950019
         SPACE 1                                                        34000019
*        THIS ROUTINE GETMAINS STORAGE FOR ALL DRIVER ROUTINES.         34050019
*        PARAMETERS ARE AS FOLLOWS:                                     34100019
         SPACE 1                                                        34150019
*              REGISTER 1 - NUMBER OF BYTES REQUESTED                   34200019
*                 GETMADD - ADDRESS OF ALLOCATED STORAGE                34250019
*                  ERRIND - ALLOCATION ERROR  (BIT 1 SET TO 1 INDICATES 34300019
*                           ERROR)                                      34350019
         SPACE 1                                                        34400019
TCR420   ST    RETREG,SAVE400          SAVE RETURN REGISTER             34450019
         ST    R1,GETMREQ              STORE MINIMUM LENGTH             34500019
         ST    R1,GETMREQ+4            STORE MAXIMUM LENGTH             34550019
         GETMAIN   VC,LA=GETMREQ,A=GETMADD  GETMAIN STORAGE             34600019
         LTR   R15,R15                 TEST RETURN CODE                 34650019
         BZ    TCR429                  BR IF STORAGE ALLOCATED          34700019
         OI    ERRIND,ALLOCERR         SET ERROR INDICATOR              34750019
         MVI   MSG19,MSGREQ            SET MSG INDICATOR                34800019
         MVC   RETCODE,CODE16          SET RETURN CODE                  34850019
TCR429   L     RETREG,SAVE400          LOAD RETURN ADDRESS              34900019
         BR    RETREG                  RETURN                           34950019
  TITLE 'IEBTCRIN - DRIVER MODULE - DCB DEFAULT INSERTION'              35000019
*        DCB DEFAULT INSERTION                                          35050019
         SPACE 1                                                        35100019
*        THIS ROUTINE INSERTS DEFAULTS FOR ANY DCB PARAMETERS           35150019
*        WHICH WERE NOT SUPPLIED BY THE USER VIA EITHER THE DSCB        35200019
*        OR THE JFCB.                                                   35250019
*        THE ROUTINE CALLS TCR730 FOLLOWING INSERTION OF DEFAULTS       35300019
*        TO TEST FOR CONSISTENCY.                                       35350019
         SPACE 2                                                        35400019
         DROP  BASEREG                  DROP ORIGINAL BASE REG          35450019
         USING *,BASE15                 INDICATE NEW BASE REG           35500019
TCR720   L     BASEREG,DRIVBASE        LOAD BASE REGISTER               35550019
         DROP  BASE15                  DROP NEW BASE REGISTER           35600019
         USING TCR050,BASEREG          INDICATE ORIGINAL BASE REG       35650019
         L     COMMREG,ATCRCOM         LOAD BASE REGISTER               35700019
         ST    R14,SAVE700             SAVE RETURN ADDRESS              35750019
         DROP  R2                      DROP LAST DCB DSECT REG          35800019
         USING IHADCB,R1               INDICATE NEW DCB DSECT REG       35850019
         L     R2,DCBEXLST             LOAD EXIT LIST ADDR              35900019
         LA    R2,0(R2)                CLEAR HIGH-ORDER BYTE            35950019
         L     R3,8(R2)                LOAD DEFAULT TABLE ADDRESS       36000019
         TM    DCBRECFM,ALLONE         TEST RECFM ZERO                  36050019
         BNZ   TCR722                  BR NO                            36100019
         MVC   DCBRECFM,4(R3)          MOVE RECFM DEFAULT               36150019
TCR722   CLC   DCBLRECL(2),ZEROES      TEST LRECL ZERO                  36200019
         BNE   TCR724                  BR NO                            36250019
         MVC   DCBLRECL(2),0(R3)       MOVE LRECL DEFAULT               36300019
         TM    DCBRECFM,UNDEF          TEST UNDEFINED                   36350019
         BO    TCR724                  BR YES                           36400019
         BAL   RETREG,TCR728           SET DEFAULT MSG INDICATORS       36450019
TCR724   CLC   DCBBLKSI(2),ZEROES      TEST BLKSIZE ZERO                36500019
         BNE   TCR726                  BR NO                            36550019
         MVC   DCBBLKSI(2),2(R3)       MOVE BLKSIZE DEFAULT             36600019
         BAL   RETREG,TCR728           SET DEFAULT MSG INDICATORS       36650019
TCR726   BAL   RETREG,TCR730           COMPARE LRECL AND BLKSIZE        36700019
*                                      PARAMETERS                       36750019
         L     R14,SAVE700             LOAD RETURN ADDRESS              36800019
         RETURN  RC=0                  RETURN                           36850019
         SPACE 1                                                        36900019
*        SET DEFAULT MESSAGE INDICATORS IF SYSUT2 OR SYSUT3             36950019
         SPACE 1                                                        37000019
TCR728   CLC   5(1,R3),INIDENT         SYSIN                            37050019
         BE    TCR729                  BR YES                           37100019
         CLC   5(1,R3),PRTIDENT        SYSPRINT                         37150019
         BE    TCR729                  BR YES                           37200019
         MVI   MSG14,MSGREQ            SET REQUEST                      37250019
         MVI   RETCODE,CODE04          SET RETURN CODE 04               37300019
         CLC   5(1,R3),UT2IDENT        SYSUT2                           37350019
         BNE   TCR7283                 BR NO                            37400019
         OI    MSG14+1,UT2             SET SYSUT2 INSERT                37450019
         B     TCR729                  BR TO RETURN                     37500019
TCR7283  OI    MSG14+1,UT32            SET SYSUT3 INSERT                37550019
TCR729   BR    RETREG                  RETURN                           37600019
  TITLE 'IEBTCRIN - DRIVER MODULE - DCB PARAMETER COMPARISON'           37650019
*        DCB PARAMETER COMPARISON                                       37700019
         SPACE 1                                                        37750019
*        THIS ROUTINE TESTS THE DCB PARAMETERS FOR INCONSISTENCIES.     37800019
*        IF IT FINDS ANY INCONSISTENCY, IT SETS MSG AND ERROR           37850019
*        INDICATORS AND INSERTS DUMMY PARAMETERS IN THE FAULTY DCB      37900019
*        TO PREVENT THE OPEN ROUTINE FROM ABEND-ING.                    37950019
         SPACE 2                                                        38000019
TCR730   ST    RETREG,SAVE730          SAVE RETURN ADDRESS              38050019
         TM    DCBRECFM,VARFM          TEST VARIABLE                    38100019
         BO    TCR732                  BR IF NO                         38150019
         LH    R6,DCBLRECL             INCREMENT LRECL BY 4 BYTES       38200019
         LA    R6,4(R6)                                                 38250019
         STH   R6,DCBWORK              STORE IN WORK AREA               38300019
         CLC   DCBBLKSI(2),DCBWORK     COMPARE BLKSIZE WITH LRECL       38350019
         BNL   TCR739                  BR BLKSIZE HIGH OR EQUAL         38400019
         B     TCR734                  SET ERROR INDICATORS             38450019
TCR732   TM    DCBRECFM,UNDEF          TEST UNDEFINED                   38500019
         BO    TCR739                  BR IF YES                        38550019
         LH    R7,DCBBLKSI             LOAD DIVIDEND WITH BLKSIZE       38600019
         XR    R6,R6                                                    38650019
         LH    R8,DCBLRECL             LOAD DIVISOR WITH LRECL          38700019
         DR    R6,R8                   DIVIDE BLKSIZE BY LRECL          38750019
         LTR   R6,R6                   TEST REMAINDER                   38800019
         BZ    TCR739                  BR IF ZERO                       38850019
         SPACE 1                                                        38900019
*        ERROR PROCESSING                                               38950019
         SPACE 1                                                        39000019
TCR734   OI    ERRIND,CONFLERR         SET ERROR INDICATOR              39050019
         MVI   MSG16,MSGREQ            SET INCONSISTENT MSG POINTER     39100019
         MVC   MSG16+1(1),5(R3)        SET MSG INSERT                   39150019
         MVI   RETCODE,CODE16          SET RETURN CODE 16               39200019
TCR736   MVI   DCBRECFM,DUMRECFM       SET DUMMY RECORD FORMAT          39250019
         MVC   DCBBLKSI,DUMLRBLK       SET DUMMY BLKSIZE                39300019
         MVC   DCBLRECL,DUMLRBLK       SET DUMMY LRECL                  39350019
         CLC   5(1,R3),PRTIDENT        SYSPRINT DATASET                 39400019
         BNE   TCR739                  BR NO                            39450019
         OI    DUMMYIND,DUMSYSP        SET SYSPRINT DUMMY INDICATOR     39500019
TCR739   L     RETREG,SAVE730          LOAD RETURN ADDR                 39550019
         BR    RETREG                  RETURN                           39600019
  TITLE 'IEBTCRIN - DRIVER MODULE - QSAM SYNAD ROUTINE'                 39650019
*        QSAM SYNAD ROUTINE                                             39700019
         SPACE 1                                                        39750019
*        THIS ROUTINE ISSUES THE SYNADAF MACRO-INSTRUCTION FOR          39800019
*        THE SYSIN, SYSPRINT, SYSUT2, OR SYSUT3 DATA SET UPON           39850019
*        OCCURRENCE OF A PERMANENT I/O ERROR AND OUTPUTS THE            39900019
*        MESSAGE CONSTRUCTED.                                           39950019
         SPACE 2                                                        40000019
         DROP  BASEREG                 DROP ORIGINAL BASE REG           40050019
         USING *,BASE15                INDICATE NEW BASE REG            40100019
TCR740   L     BASEREG,DRIVBASE        LOAD BASE REGISTER               40150019
         DROP  BASE15                  DROP NEW BASE REG                40200019
         USING TCR050,BASEREG          INDICATE ORIGINAL BASE REG       40250019
         L     COMMREG,ATCRCOM         LOAD COMM REGION ADDRESS         40300019
         ST    RETREG,SAVE740          SAVE RETURN ADDRESS              40350019
         TM    DUMMYIND,DUMSYSP        SYSPRINT DUMMY                   40400019
         BO    TCR749                  BR YES                           40450019
         SYNADAF  ACSMETH=QSAM         REQUEST SYNAD MESSAGE            40500019
         CLC   75(8,R1),NAMETAB+8      SYSPRINT DATA SET                40550019
         BNE   TCR7416                 BR NO                            40600019
         ST    R1,SYNADSAV             SAVE SYNAD AREA ADDRESS          40650019
         OI    DUMMYIND,DUMSYSP        SET SYSPRINT DUMMY               40700019
         TM    PRTRTN,RTN310           SINGLE REQUEST                   40750019
         BO    TCR7413                 BR YES                           40800019
         L     R6,CURMSGAD             LOAD MSG WTO ADDRESS             40850019
         WTO   MF=(E,(R6))                                              40900019
TCR7413  L     R1,SYNADSAV             RESTORE SYNAD AREA POINTER       40950019
TCR7416  L     R3,PRTAREA              LOAD PRINTAREA ADDR              41000019
         CLC   DSUNIT(2,R1),SYNUR      TEST UR                          41050019
         BNE   TCR742                  BR NO                            41100019
         MVC   SYNIDENT(8,R1),SYNMSGUR                                  41150019
TCR742   CLC   DSUNIT(2,R1),SYNTA      TEST TA                          41200019
         BNE   TCR744                  BR NO                            41250019
         MVC   SYNIDENT(8,R1),SYNMSGTA MOVE IDENT                       41300019
TCR744   CLC   DSUNIT(2,R1),SYNDA      TEST DA                          41350019
         BNE   TCR746                  BR NO                            41400019
         MVC   SYNIDENT(8,R1),SYNMSGDA MOVE IDENT                       41450019
TCR746   LA    R4,SYNLNGTH             STORE MSG LENGTH                 41500019
         STC   R4,MSGLN                STORE MSG LENGTH                 41550019
         LA    R5,SYNIDENT(R1)         STORE MSG ADDRESS                41600019
         ST    R5,MSGAD                STORE MSG ADDRESS                41650019
TCR747   CLC   DSNAME(8,R1),NAMETAB+8  SYSPRINT DATA SET                41700019
         BNE   TCR7473                 BR NO                            41750019
         L     R4,MSGADDR              LOAD MSG TABLE ADDRESS           41800019
         L     R6,SYNWTO(R4)           LOAD MSG ADDRESS                 41850019
         LA    R6,0(R6)                CLEAR LENGTH INDICATOR           41900019
         EX    R4,TCR751               MOVE MESSAGE                     41950019
         WTO   MF=(E,(R6))             ISSUE WTO                        42000019
         B     TCR748                  BYPASS SYSPRINT PROC             42050019
TCR7473  OI    PRTRTN,RTN310           SET SINGLE MSG INDICATOR         42100019
         MVI   CARRCTRL,DOUBLESP       INDICATE DOUBLESPACING           42150019
         L     LNKREG15,ATCR220        LOAD MESSAGE WRITER ADDR         42200019
         BALR  RETREG,LNKREG15         DISPLAY MESSAGE                  42250019
TCR748   SYNADRLS                                                       42300019
TCR749   L     RETREG,SAVE740          LOAD RETURN ADDRESS              42350019
         OI    ERRIND,QSAMERR          SET QSAM ERROR INDICATOR         42400019
         MVI   RETCODE,CODE16          SET RETURN CODE 16               42450019
         RETURN  RC=16                                                  42500019
TCR751   MVC   4(0,R6),0(R5)           MOVE MSG                         42550019
  TITLE 'IEBTCRIN - DRIVER MODULE - STAE EXIT ROUTINE'                  42600019
*        STAE EXIT ROUTINE                                              42650019
         SPACE 1                                                        42700019
*        THIS ROUTINE IS SCHEDULED BY THE ABEND/STAE INTERFACE          42750019
*        ROUTINE WHENEVER AN ABEND IS SCHEDULED AND A VALID STAE        42800019
*        ENVIRONMENT IS IN EXISTENCE (WHEN A STAE CONTROL BLOCK         42850019
*        WAS SUCCESSFULLY CREATED).                                     42900019
         SPACE 1                                                        42950019
*        THE ROUTINE CHECKS WHETHER OR NOT THE ABEND WAS CAUSED         43000019
*        BY ATTEMPTING TO LOAD A NON-EXISTENT USER ROUTINE.  IF         43050019
*        IT WAS, IT REQUESTS THAT A STAE RETRY ROUTINE BE SCHEDULED.    43100019
*        IF IT WAS CAUSED BY SOME OTHER ERROR, THE ROUTINE ALLOWS       43150019
*        ABEND PROCESSING TO CONTINUE.                                  43200019
         SPACE 2                                                        43250019
         DROP  BASEREG                 DROP ORIGINAL BASE REG           43300019
         USING *,BASE15                INDICATE NEW BASE REG            43350019
TCR800   L     BASEREG,DRIVBASE        LOAD BASE REGISTER               43400019
         DROP  BASE15                  DROP NEW BASE REGISTER           43450019
         USING TCR050,BASEREG          INDICATE ORIGINAL BASE REG       43500019
         L     COMMREG,ATCRCOM         LOAD ADDR COMMUNICATION REGION   43550019
         LA    R3,CODE12               LOAD RETURN CODE 12              43600019
         ST    LNKREG0,SAVECODE        SAVE I/O ACTIVE CODE             43620001
         CLR   LNKREG0,R3              WORK AREA AVAILABLE              43650019
         BE    TCR802                  BR NO                            43700019
         MVC   COMPCODE(2),5(PARMREG)  SAVE COMPLETION CODE             43750019
         B     TCR803                  BYPASS NO WORK AREA PROCESSING   43800019
TCR802   ST    PARMREG,COMPCODE        STORE COMPLETION CODE            43850019
         MVC   COMPCODE(2),COMPCODE+1  SHIFT CODE                       43900019
TCR803   NI    COMPCODE+1,USERCLR      CLEAR USER CODE                  43950019
         CLC   COMPCODE(2),CODE806     LOAD ERROR                       44000019
         BNE   TCR808                  BR NO                            44050019
TCR804   CLI   USERLIST,MSGMODL        MSG MODULE                       44100019
         BE    TCR808                  BR YES                           44150019
TCR806   LA    LNKREG15,CODE4          REQUEST STAE RETRY ROUTINE       44200019
         LA    LNKREG0,TCR810          LOAD RETRY ROUTINE ADDRESS       44250019
         BR    RETREG                  RETURN                           44300019
TCR808   XR    LNKREG15,LNKREG15       ALLOW ABEND TO CONTINUE          44350019
         BR    RETREG                  RETURN                           44400019
  TITLE 'IEBTCRIN - DRIVER MODULE - STAE RETRY ROUTINE'                 44450019
*        STAE RETRY ROUTINE                                             44500019
         SPACE 2                                                        44550019
*        THIS ROUTINE IS SCHEDULED WHENEVER THE STAE EXIT               44600019
*        ROUTINE DETERMINES THAT AN ABEND WAS CAUSED BY THE             44650019
*        FAILURE TO FIND A USER EXIT ROUTINE OR TRANSLATE TABLE.        44700019
         SPACE 1                                                        44750019
*        IT SETS MESSAGE AND ERROR INDICATORS, RESTORES BASE            44800019
*        REGISTERS, AND RETURNS CONTROL TO THE INSTRUCTION FOLLOW-      44850019
*        ING THE ABEND-ING LOAD INSTRUCTION.  IT FREES THE STAE         44900019
*        WORKAREA IF ONE WAS PROVIDED AND RESTORES I/O USING THE        44950019
*        THE RESTORE MACRO-INSTRUCTION.                                 45000019
         SPACE 2                                                        45050019
         DROP  BASEREG                 DROP ORIGINAL BASE REG           45100019
         USING *,BASE15                INDICATE NEW BASE REG            45150019
TCR810   L     BASEREG,DRIVBASE        LOAD  BASE REGISTER              45200019
         DROP  BASE15                  DROP NEW BASE REG                45250019
         USING TCR050,BASEREG          INDICATE ORIGINAL BASE REG       45300019
         ST    PARMREG,PARMADDR        STORE PARAMETER REG              45350019
         ST    LNKREG0,REG0SAVE        STORE REG 0                      45400019
         LA    SAVEREG,SAVEAREA        LOAD SAVEAREA ADDRESS            45450019
         L     COMMREG,ATCRCOM         LOAD ADDR COMMUNICATION REGION   45500019
         CLI   REG0SAVE+3,CODE12       WORK AREA AVAILABLE              45550019
         BE    TCR8103                 BR NO                            45600019
         L     R2,PARMADDR             LOAD WORKAREA ADDRESS            45650019
         L     PARMREG,IOBREST(R2)     LOAD RESTORE CHAIN POINTER       45700019
         B     TCR8106                 BYPASS NO WORK AREA PROC         45750019
TCR8103  ST    R2,SVRESTOR             SET UP IOB CHAIN POINTER         45800019
         LA    PARMREG,SVRESTOR        SET UP PARAMETER REGISTER        45850019
TCR8106  CLI   SAVECODE+3,CODE4        I/O NOT RESTORABLE               45900001
         BE    TCR8107                 BRANCH YES                       45910001
         CLI   SAVECODE+3,CODE8        I/O NOT ACTIVE                   45920001
         BE    TCR8107                 BRANCH YES                       45930001
         RESTORE   (PARMREG)           RESTORE I/O                      45940001
TCR8107  CLI   REG0SAVE+3,CODE12       WORK AREA AVAILABLE              45950001
         BE    TCR811                  BR NO                            46000019
         L     PARMREG,PARMADDR        LOAD PARAMETER REGISTER          46050019
         FREEMAIN R,LV=104,A=(PARMREG)                                  46100019
TCR811   CLC   COMPCODE(2),CODE806     LOAD ERROR                       46150019
         BE    TCR812                  BR YES                           46200019
         B     TCR819                  BR TO RETURN                     46250019
TCR812   MVI   MSG17,MSGREQ            SET MSGIND                       46300019
         MVC   MSG17+1(1),USERLIST SET INSERT                           46350019
         OI    ERRIND,LOADERR          SET ERROR INDICATOR              46400019
         MVI   RETCODE,CODE16          SET RETURN CODE 16               46450019
         B     TCR819                  BR TO RETURN                     46500019
TCR819   L     RETREG,RETPT            LOAD RETURN POINT ADDRESS        46550019
         L     R12,DRIVBASE            LOAD DRIVER BASE REGISTER        46600019
         BR    RETREG                  RETURN                           46650019
  TITLE 'IEBTCRIN - DRIVER MODULE - LITERALS AND STORAGE AREAS'         46700019
*        LITERALS                                                       46750019
         SPACE 2                                                        46800019
NULL     EQU   *                       NULL LABEL FOR COMPILATION       46850019
*                                      OF DCB'S                         46900019
HEXSPACE EQU   X'40'                   HEX SPACE                        46950019
NAMELN   EQU   8                       INSERT NAME LENGTH               47000019
NEWPAGE  EQU   X'F1'                   SKIP TO CHANNEL 1                47050019
SINGLESP EQU   X'40'                   SINGLE SPACE CONTROL CHARACTER   47100019
DOUBLESP EQU   X'F0'                   DOUBLE SPACE CONTROL CHARACTER   47150019
MSGREQ   EQU   X'FF'                   MESSAGE REQUIRED                 47200019
INSREQ   EQU   X'FF'                   MESSAGE INSERT REQUIRED          47250019
VARFM    EQU   X'80'                   NOT VARIABLE IF ON               47300019
IN       EQU   X'01'                   SYSIN                            47350019
PRT      EQU   X'02'                   SYSPRINT                         47400019
INPRT    EQU   X'03'                   SYSPRINT OR SYSIN                47450019
EDITSPEC EQU   X'C0'                   EDIT SPECIFICATION               47500019
UT32     EQU   X'50'                   SYSUT3 INSERT                    47550019
UT2      EQU   X'04'                   SYSUT2                           47600019
UT3      EQU   X'05'                   SYSUT3                           47650019
ALLONE   EQU   X'FF'                   ANY ERROR INDICATOR              47700019
STAEFAIL EQU   X'FF'                   STAE ENVIRONMENT NOT CREATED     47750019
MSGMODL  EQU   X'0D'                   MESSAGE MODULE                   47800019
USERTAB  EQU   X'02'                   USER TABLE SPECIFIED             47850019
DEF120   EQU   X'78'                   MAXLN DEFAULT                    47900019
SHIFTLN  EQU   1                       SHIFT NO.OF BITS                 47950019
DDINCR   EQU   8                       DDNAME LENGTH                    48000019
TABLNG   EQU   76                      MESSAGE POINTER TABLE LENGTH     48050019
DDLNGTH  EQU   8                       DDNAME TABLE INCREMENT           48100019
DEFBUFL  EQU   2000                    DEFAULT BUFFER LENGTH            48150019
PTRLNG   EQU   4                       MESSAGE POINTER TABLE            48200019
*                                      ENTRY LENGTH                     48250019
DDON     EQU   X'01'                   ALTERNATE DDNAMES                48300019
RTN310   EQU   X'02'                   SINGLE MESSAGE INDICATOR         48350019
UNDEF    EQU   X'C0'                   UNDEFINED RECORD FORMAT          48400019
HDR2IND  EQU   6                       OUTHDR2 MSG INDICATOR            48450019
USERCLR  EQU   X'F0'                   USER COMPLETION CODE CLEAR       48500019
DUMRECFM EQU   X'90'                   DUMMY RECORD FORMAT              48550019
DCBOPEN  EQU   X'10'                   DCBOFLAGS OPEN INDICATOR         48600019
CODE4    EQU   4                       RETRY ROUTINE REQUEST            48650019
CODE8    EQU   8                       I/O NOT ACTIVE CODE              48670001
COMMA    EQU   C','                    COMMA                            48700019
SYNLNGTH EQU   68                      SYNAD MESSAGE LENGTH             48750019
COMPMSG  EQU   84                      COMPLETION MESSAGE               48800019
HDGMSG   EQU   80                      HEADING MESSAGE                  48850019
CARDLN   EQU   80                      CARD AREA LENGTH                 48900019
IOBREST  EQU   100                     IOB RESTORE POINTER              48950019
SYNIDENT EQU   60                      SYNAD MSG IDENT                  49000019
DSUNIT   EQU   72                      DEVICE TYPE                      49050019
DSNAME   EQU   75                      DATA SET NAME                    49100019
SYNWTO   EQU   76                      SYNAD MSG WTO LOCATION           49150019
INC63    EQU   63                      SIXTY-THREE                      49200019
HEXZERO  EQU   X'00'                   HEXADECIMAL 0                    49250019
HEX72    EQU   X'48'                   HEXADECIMAL 72                   49300019
ONE      EQU   1                       ONE                              49350019
THREE    EQU   3                       THREE                            49400019
         EJECT                                                          49450019
*        MESSAGE LOCATION DESCRIPTORS                                   49500019
         SPACE 1                                                        49550019
MSGSYSP  EQU   X'01'                   MESSAGE OUTPUT TO SYSPRINT       49600019
MSGCONS  EQU   X'02'                   MESSAGE OUTPUT TO CONSOLE        49650019
MSGAVAIL EQU   X'04'                   MESSAGE OUTPUT TO SYSPRINT       49700019
*                                      IF AVAILABLE OTHERWISE TO        49750019
*                                      THE CONSOLE                      49800019
         SPACE 1                                                        49850019
*        RETURN CODES                                                   49900019
         SPACE 1                                                        49950019
CODE04   EQU   4                       CODE  04                         50000019
CODE12   EQU   12                      CODE  12                         50050019
CODE16   EQU   16                      CODE  16                         50100019
         SPACE 2                                                        50150019
*        PARM LIST DEFINITION                                           50200019
         SPACE 1                                                        50250019
OPTLIST  EQU   0                       OPTION LIST                      50300019
DDLIST   EQU   4                       DDNAME LIST                      50350019
LASTPARM EQU   X'80'                   SIGN BIT ON                      50400019
         SPACE 2                                                        50450019
*        TERMINAL ERROR INDICATORS                                      50500019
         SPACE 1                                                        50550019
LOADERR  EQU   X'01'                   ERROR IN LOADING USER ROUTINES   50600019
QSAMERR  EQU   X'02'                   PERMANENT QSAM I/O ERROR         50650019
ANALERR  EQU   X'04'                   ERROR IN CONTROL CD ANALYZER     50700019
RDEDERR  EQU   X'08'                   ERROR IN READ AND EDIT MODULE    50750019
JFCBERR  EQU   X'10'                   ERROR IN READING JFCB OR MOUNT   50800019
IORDERR  EQU   X'28'                   SYSUT1 READ ERROR                50850019
ALLOCERR EQU   X'40'                   STORAGE ALLOCATION ERROR         50900019
CONFLERR EQU   X'80'                   CONFLICTING DCB PARAMETERS       50950019
         SPACE 2                                                        51000019
*        DCB MAXLN REQUIREMENTS                                         51050019
         SPACE 1                                                        51100019
UT2LRLMX EQU   X'10'                   SYSUT2 LRECL   REQUIRES MAXLN    51150019
UT2BLKMX EQU   X'08'                   SYSUT2 BLKSIZE REQUIRES MAXLN    51200019
UT3LRLMX EQU   X'04'                   SYSUT3 LRECL   REQUIRES MAXLN    51250019
UT3BLKMX EQU   X'02'                   SYSUT3 BKSIZE  REQUIRES MAXLN    51300019
         SPACE 2                                                        51350019
*        INPUT DDNAME LIST DEFINITION                                   51400019
         SPACE 1                                                        51450019
DSYSIN   EQU   32                      SYSIN                            51500019
DSYSPRT  EQU   40                      SYSPRINT                         51550019
DSYSUT1  EQU   56                      SYSUT1                           51600019
DSYSUT2  EQU   64                      SYSUT2                           51650019
DSYSUT3  EQU   72                      SYSUT3                           51700019
         SPACE 2                                                        51750019
*        MISSING DD STATEMENT INDICATORS                                51800019
         SPACE 1                                                        51850019
DUMSYSIN EQU   X'01'                   SYSIN                            51900019
DUMSYSP  EQU   X'02'                   SYSPRINT                         51950019
         EJECT                                                          52000019
*        CONSTANTS, HOLD AREAS                                          52050019
         SPACE 1                                                        52100019
GETMREQ  DS    D                       MINIMUM & MAXIMUM SIZE REQUIRED  52150019
GETMADD  DS    D                       GETMAINED STORAGE ADDRESS        52200019
*                                        AND LENGTH                     52250019
PARMADDR DC    F'0'                    PARAMETER REGISTER STORE         52300019
RETPT    DC    A(TCR165)               STAE RETRY RETURN POINT          52350019
ENTPT    DC    D'0'                    EXIT ROUTINE NAME                52400019
ATCRCOM  DC    A(TCRCOM)               COMMON COMMUNICATION REGION      52450019
*                                      ADDRESS                          52500019
COMPCODE DC    C'    '                 ABEND COMPLETION CODE            52550019
CODE806  DC    X'8060'                 LOAD ERROR COMPLETION CODE       52600019
INDMSK   DC    X'0100'                 USER INDICATOR TABLE MASK        52650019
USERLIST DC    X'0000'                 STAE NAME TABLE POINTER          52700019
*                                      X'NNFF' INDICATES STAE NOT       52750019
*                                      IN EFFECT                        52800019
DCBWORK  DC    X'0000'                 LRECL WORK AREA                  52850019
LASTROUT DC    X'02'                   ALL USER ROUTINES LOADED         52900019
ZEROES   DC    X'0000000000000000'     ZEROES                           52950019
         SPACE 1                                                        53000019
SYNUR    DC    CL2'UR'                 UNIT RECORD SYNADAF              53050019
SYNTA    DC    CL2'TA'                 TAPE  SYNADAF                    53100019
SYNDA    DC    CL2'DA'                 DIRECT ACCESS SYNADAF            53150019
         SPACE 2                                                        53200019
*        THE FOLLOWING CONSTANTS MAY NEED TO BE REPLACED IF WORLD TRADE 53250019
*        REQUIREMENTS NECESSITATE MODIFICATION OF THE MESSAGE IDEN-     53300019
*        TIFIERS.                                                       53350019
         SPACE 1                                                        53400019
SYNMSGUR DC    CL8'IEB920I '           UNIT RECORD SYNAD MSG IDENT      53450019
SYNMSGTA DC    CL8'IEB921I '           TAPE SYNAD MSG IDENT             53500019
SYNMSGDA DC    CL8'IEB922I '           DIRECT ACCESS SYNAD MSG IDENT    53550019
         SPACE 1                                                        53600019
         DS    0H                      FORCE HALF-WORD ALIGNMENT        53650019
MTDIDEFT DC    X'408C'                 MTDI DEFAULT                     53700019
DUMLRBLK DC    X'0050'                 DUMMY LRECL AND BLKSIZE VALUES   53750019
         SPACE 2                                                        53800019
*        SAVE AREAS                                                     53850019
         SPACE 1                                                        53900019
SAVE100  DS    F                       TCR1XX RETURN ADDRESS            53950019
SAVE400  DS    F                       TCR4XX RETURN ADDRESS            54000019
SAVE700  DS    F                       TCR700 RETURN ADDRESS            54050019
SAVE730  DS    F                       TCR730 RETURN ADDRESS            54100019
SAVE740  DS    F                       TCR740 RETURN ADDRESS            54150019
SYNADSAV DS    F                       SYNAD AREA SAVE ADDRESS          54200019
DRIVBASE DS    F                       DRIVER BASE REGISTER             54250019
REG0SAVE DS    F                       LNKREG0 SAVE AREA                54300019
SVRESTOR DS    F                       IOB RESTORE CHAIN                54350019
SAVEAREA DS    18F                     REGISTER SAVE AREA               54400019
SAVEPARM DC    F'0'                    PARAMETER REGISTER SAVE AREA     54450019
SAVECODE DC    F'0'                    I/O RESTORABLE CODE              54470001
  TITLE 'IEBTCRIN - DRIVER MODULE -- TCR220 - MESSAGE WRITER'           54500019
*        TCR220 - MESSAGE WRITER                                        54550019
         SPACE 3                                                        54600019
*        THE MESSAGE WRITER OUTPUTS ALL MESSAGES FOR THE UTILITY.       54650019
*        IT CONTAINS TWO PROCESSING OPTIONS - 1) CONSECUTIVE            54700019
*        OUTPUTTING OF ALL IEB9XXX MESSAGES AND 2) SINGLE LINE          54750019
*        SYSPRINT OUTPUTTING OF CONTROL STATEMENT IMAGES, PAGE          54800019
*        HEADINGS, SYNAD MESSAGES, ETC.                                 54850019
         SPACE 1                                                        54900019
*        PARAMETERS ARE AS FOLLOWS:                                     54950019
*                                                                       55000019
*        OPTION 1:  COMMON COMMUNICATION REGION TABLE MSGPTRS           55050019
*                                                                       55100019
*                   THIS TABLE CONTAINS ONE FULL-WORD ENTRY FOR         55150019
*                   EACH IEB-TYPE MESSAGE (EXCLUDING SYNAD MESSAGES).   55200019
*                                                                       55250019
*                   BYTE 1 - MESSAGE REQUEST CODE                       55300019
*                                                                       55350019
*                            X'FF' - INDICATES REQUEST                  55400019
*                            X'00' - OTHERWISE                          55450019
*                                                                       55500019
*                   BYTE 2 - INSERT CODE                                55550019
*                                                                       55600019
*                            X'00' - NO INSERT                          55650019
*                            X'01' - SYSIN                              55700019
*                            X'02' - SYSPRINT                           55750019
*                            X'03' - SYSUT1                             55800019
*                            X'04' - SYSUT2                             55850019
*                            X'05' - SYSUT3                             55900019
*                            X'06' - OUTHDR2                            55950019
*                            X'07' - OUTTLR2                            56000019
*                            X'08' - OUTHDR3                            56050019
*                            X'09' - OUTTLR3                            56100019
*                            X'0A' - OUTREC                             56150019
*                            X'0B' - ERROR                              56200019
*                            X'0C' - USERTAB                            56250019
*                            X'54' - BOTH SYSUT2 AND SYSUT3             56300019
*                                                                       56350019
*                      NOTE:  IF X'54' IS SPECIFIED, THE MESSAGE IS     56400019
*                            OUTPUT TWICE, ONCE WITH SYSUT2 AND ONCE    56450019
*                            WITH SYSUT3.                               56500019
*                                                                       56550019
*        OPTION 2:  COMMUNICATION REGION DATA AREAS:                    56600019
*                                                                       56650019
*                       MSGAD - MESSAGE ADDRESS                         56700019
*                       MSGLN - MESSAGE LENGTH                          56750019
*                                                                       56800019
*                   COMMUNICATION REGION INDICATOR:                     56850019
*                                                                       56900019
*                       PRTRTN - BIT 6 SET TO ONE INDICATES OPTION 2    56950019
*                                BIT 6 SET TO ZERO INDICATES OPTION 1   57000019
         SPACE 1                                                        57050019
*        CALLING SEQUENCE:                                              57100019
*                                                                       57150019
*                   L     R15,ATCR220       LOAD CSECT ADDRESS          57200019
*                   BALR  R14,R15           BRANCH AND LINK             57250019
         SPACE 2                                                        57300019
         SPACE 3                                                        57350019
*        THIS SECTION SAVES THE CALLING MODULE'S GENERAL REGISTERS,     57400019
*        SETS UP A SAVEAREA ADDRESS, AND ESTABLISHES BASE REGISTERS     57450019
*        FOR THIS MODULE AND FOR THE COMMON COMMUNICATION REGION.       57500019
         SPACE 2                                                        57550019
IEBTCRMW CSECT                                                          57600019
         ENTRY TCR220                  MESSAGE WRITER ENTRY POINT       57650019
TCR220   SAVE  (14,12),T,TCR220        SAVE REGISTERS                   57700019
         BALR  BASEREG,R0              ESTABLISH BASE REGISTER          57750019
         USING *,BASEREG               INDICATE BASE REGISTER           57800019
         LR    R15,SAVEREG             SET UP SAVEAREA POINTERS         57850019
         ST    R15,SAVEAR2+4                                            57900019
         LA    SAVEREG,SAVEAR2                                          57950019
         ST    SAVEREG,8(R15)                                           58000019
         XR    R15,R15                                                  58050019
         ST    R15,0(SAVEREG)                                           58100019
         L     COMMREG,ATCRCOM1        LOAD COMMUNICATION REGION ADDR   58150019
         USING TCRCOM,COMMREG          INDICATE COMM. REG. BASE REG.    58200019
         EJECT                                                          58250019
*        THIS SECTION LOOPS THROUGH THE MESSAGE POINTER TABLE.          58300019
*        FOR EACH MESSAGE REQUESTED, IT FINDS THE RELATED MESSAGE       58350019
*        TEXT IN THE MESSAGE MODULE, INSERTS ANY NAME REQUESTED,        58400019
*        AND DEVELOPS A MESSAGE LENGTH AND MESSAGE ADDRESS.             58450019
         SPACE 2                                                        58500019
         TM    PRTRTN,RTN310           SINGLE MESSAGE REQUEST           58550019
         BO    TCR330                  BR YES                           58600019
         SR    R3,R3                   CLEAR INSERT LOCATION REG        58650019
         LA    R7,MSGPTRS-PTRLNG       LOAD ADDR MSG PTR TABLE-4        58700019
         L     R4,MSGADDR              LOAD ADDR MSG TABLE              58750019
         S     R4,FOUR                 SET AT MSG TABLE-4               58800019
         LA    R8,PTRLNG               LOAD INCREMENT                   58850019
         LA    R9,MSGPTRS+TABLNG       LOAD ENDING ADDRESS              58900019
TCR222   BXH   R7,R8,TCR228            BR WHEN ALL MSGS OUTPUT          58950019
         LA    R4,4(R4)                INCR VARIABLE TABLE ADDR         59000019
         TM    0(R7),MSGREQ            MESSAGE REQUIRED?                59050019
         MVI   0(R7),HEXZERO           CLEAR INDICATOR                  59100019
         BNO   TCR222                  BR NO                            59150019
         TM    1(R7),INSREQ            MSG INSERT REQUIRED              59200019
         BZ    TCR223                  BR NO                            59250019
         TM    1(R7),TWOINS            TWO INSERTS REQUIRED             59300019
         BNO   TCR2225                 BR NO                            59350019
         MVC   SAVEINS(1),1(R7)        SAVE INSERT                      59400019
TCR2223  NI    1(R7),CLEARLFT          CLEAR LEFT FOUR BITS             59450019
TCR2225  L     R6,0(R4)                LOAD MSG ADDRESS                 59500019
         IC    R3,2(R7)                INSERT MSG INSERT LOCATION       59550019
         AR    R6,R3                   ADD TO STARTING MSG ADDR         59600019
         IC    R3,1(R7)                LOAD INSERT NAME INDICATOR       59650019
         SH    R3,HFONE                DECREMENT BY ONE                 59700019
         SLL   R3,THREE                MULTIPLY BY EIGHT                59750019
         LA    R2,NAMETAB              LOAD ADDR OF NAME TABLE          59800019
         AR    R2,R3                   SET REG AT NAME TO BE INSERTED   59850019
         MVC   4(NAMELN,R6),0(R2)      MOVE NAME TO MSG                 59900019
TCR223   L     R6,0(R4)                LOAD MSG ADDRESS                 59950019
         LA    R6,0(R6)                REMOVE LENGTH INDICATION         60000019
         ST    R6,CURMSGAD             STORE WTO ADDRESS                60050019
         LH    R2,0(R6)                LOAD LENGTH                      60100019
         S     R2,FOUR                 REMOVE LENGTH OF CODES           60150019
         EJECT                                                          60200019
*        THIS SECTION DETERMINES THE OUTPUT LOCATION(S) FOR THE         60250019
*        MESSAGE AND BAL'S TO THE PROPER ROUTINE(S).                    60300019
         SPACE 2                                                        60350019
         TM    3(R7),MSGSYSP           SYSPRINT REQUIRED?               60400019
         BNO   TCR224                  BR IF NO                         60450019
         TM    DUMMYIND,DUMSYSP        SYSPRINT DUMMY?                  60500019
         BO    TCR224                  BR YES                           60550019
         LA    R6,4(R6)                BYPASS CODES                     60600019
         BAL   RETREG,TCR310           DISPLAY ON SYSPRINT              60650019
         S     R6,FOUR                 SET AT WTO START                 60700019
TCR224   TM    3(R7),MSGCONS           CONSOLE REQUIRED?                60750019
         BNO   TCR225                  BR - NO                          60800019
         BAL   RETREG,TCR320           DISPLAY ON CONSOLE               60850019
         SPACE 1                                                        60900019
*        DISPLAY ON CONSOLE IF BIT 5 OF THE LOCATION CODE IS SET TO     60950019
*        ONE AND SYSPRINT IS DUMMY.  DISPLAY ON SYSPRINT IF NOT DUMMY.  61000019
         SPACE 1                                                        61050019
TCR225   TM    3(R7),MSGAVAIL          CONSOLE IF SYSPRINT DUMMY?       61100019
         BNO   TCR227                  BR IF NO                         61150019
TCR2253  TM    DUMMYIND,DUMSYSP        SYSPRINT DUMMY                   61200019
         BO    TCR226                  BR YES                           61250019
         LA    R6,4(R6)                BYPASS CODES                     61300019
         BAL   RETREG,TCR310           DISPLAY ON SYSPRINT              61350019
         S     R6,FOUR                 SET AT WTO START                 61400019
         B     TCR227                  BYPASS CONSOLE ROUTINE           61450019
TCR226   BAL   RETREG,TCR320           DISPLAY ON CONSOLE               61500019
TCR227   CLI   SAVEINS,HEXZERO         TWO INSERTS                      61550019
         BE    TCR222                  BR NO                            61600019
         PACK  SAVEINS(1),SAVEINS      SWITCH INSERT DIGITS             61650019
         MVC   1(1,R7),SAVEINS         SET  IN MSG POINTER              61700019
         MVI   SAVEINS,HEXZERO         CLEAR SAVE AREA                  61750019
         B     TCR2223                 BR TO CONSTRUCT 2ND MSG          61800019
         SPACE 3                                                        61850019
*        THIS SECTION RELOADS THE CALLING MODULE'S REGISTERS            61900019
*        AND RETURNS TO THE CALLER                                      61950019
         SPACE 1                                                        62000019
TCR228   NI    PRTRTN,HEXZERO          CLEAR OPTION INDICATOR           62050019
         L     SAVEREG,4(SAVEREG)      RELOAD SAVEAREA ADDRESS          62100019
         RETURN  (14,12),T,RC=(15)     RELOAD REGISTERS AND RETURN      62150019
         EJECT                                                          62200019
*        SYSPRINT ROUTINE                                               62250019
         SPACE 1                                                        62300019
*        THIS ROUTINE DEVELOPS RECORDS FOR THE SYSPRINT DATA SET.       62350019
*        IF THE MESSAGE IS LONGER THAN THE SPACE AVAILABLE WITH THE     62400019
*        SPECIFIED DCB PARAMETERS, IT IS TRUNCATED TO FIT IN THE        62450019
*        SPACE AVAILABLE.                                               62500019
         SPACE 1                                                        62550019
*        PARAMETERS ARE AS FOLLOWS:                                     62600019
*                                                                       62650019
*                REGISTER 2 - MESSAGE LENGTH                            62700019
*                REGISTER 6 - MESSAGE ADDRESS                           62750019
         SPACE 2                                                        62800019
TCR310   ST    RETREG,SAVE300          SAVE RETURN ADDRESS              62850019
         LA    R1,SYSPRDCB             LOAD SYSPRINT DCB ADDRESS        62900019
         USING IHADCB,R1               INDICATE DCB DSECT REG           62950019
         L     R10,PRTAREA             LOAD ADDR PRTAREA                63000019
         LH    R5,DCBLRECL             LOAD SYSPRINT LRECL              63050019
         TM    DCBRECFM,VARFM          TEST VARIABLE LENGTH RECORDS     63100019
         BO    TCR312                  BR NO                            63150019
         SPACE 1                                                        63200019
*        DEVELOP LENGTH FOR VARIABLE-LENGTH RECORDS                     63250019
         SPACE 1                                                        63300019
         SH    R5,HFIVE                REMOVE COUNT AND CTRL CHAR LNGTH 63350019
         CLR   R5,R2                   COMPARE MAX AVAILABLE TO MSG LNG 63400019
         BH    TCR311                  BR HIGH                          63450019
         SPACE 1                                                        63500019
*        DEVELOP LENGTH FOR THOSE VARIABLE-LENGTH MESSAGES WHICH        63550019
*        ARE LONGER THAN THE SPECIFIED LRECL VALUE                      63600019
         SPACE 1                                                        63650019
         LR    R3,R5                   SET MSG LENGTH EQUAL TO LRECL-5  63700019
         LA    R5,5(R5)                ADD BACK                         63750019
         STH   R5,0(R10)               STORE COUNT IN SYSPRINT AREA     63800019
         SH    R5,HFIVE                REMOVE COUNT AND CTRL CHAR LNGTH 63850019
         B     TCR315                  BR TO OUTPUT THE MSG             63900019
         SPACE 1                                                        63950019
*        THIS SECTION DEVELOPS A LENGTH FOR THOSE VARIABLE-LENGTH       64000019
*        MESSAGES WHICH ARE SHORTER THAN OR EQUAL TO THE ALLOWABLE      64050019
*        LENGTH.                                                        64100019
         SPACE 1                                                        64150019
TCR311   LR    R3,R2                   LOAD MSG LENGTH                  64200019
         LA    R2,5(R2)                ADD 5 BYTES TO MSG LENGTH        64250019
         STH   R2,0(R10)               STORE COUNT IN SYSPRINT AREA     64300019
         B     TCR315                  BR TO OUTPUT THE MSG             64350019
         SPACE 1                                                        64400019
*        DEVELOP ALLOWABLE MESSAGE LENGTH FOR FIXED-LENGTH AND          64450019
*        UNDEFINED RECORDS.                                             64500019
         SPACE 1                                                        64550019
TCR312   SH    R5,HFONE                REMOVE CTRL CHAR COUNT           64600019
         CLR   R5,R2                   COMPARE MAX AVAILABLE TO MSG LNG 64650019
         BH    TCR313                  BR HIGH                          64700019
         LR    R3,R5                   SET MSG LENGTH EQUAL TO LRECL-1  64750019
         B     TCR315                  BR TO OUTPUT THE MSG             64800019
         EJECT                                                          64850019
*        THIS SECTION CLEARS THE PRINT AREA, MOVES THE MESSAGE TO       64900019
*        THE PRINT AREA, ENTERS A CARRIAGE CONTROL CHARACTER, AND,      64950019
*        IF THE DATA SET HAS BEEN SPECIFIED AS VARIABLE-LENGTH,         65000019
*        AFFIXES THE VARIABLE-LENGTH RECORD COUNT.                      65050019
         SPACE 1                                                        65100019
TCR313   LR    R3,R2                   LOAD MSG LENGTH                  65150019
TCR315   MVI   4(R10),HEXSPACE         MOVE SPACE TO PRINT AREA         65200019
         SH    R5,HFONE                DEVELOP CLEAR LENGTH             65250019
         SH    R3,HFONE                DEVELOP MOVE LENGTH              65300019
         EX    R5,TCR3183              CLEAR PRINT AREA                 65350019
         EX    R3,TCR318               LOAD MSG                         65400019
         MVC   4(1,R10),CARRCTRL       MOVE TO PRINT AREA               65450019
         TM    SYSPRDCB+36,VARFM       TEST VARIABLE LENGTH RECORDS     65500019
         BNO   TCR316                  BR YES                           65550019
         LA    R10,4(R10)              BYPASS VARIABLE COUNT            65600019
         SPACE 1                                                        65650019
*        THIS SECTION OUTPUTS THE MESSAGE AND RESTORES THE CARRIAGE     65700019
*        CONTROL TO SINGLE-SPACING.                                     65750019
         SPACE 1                                                        65800019
TCR316   PUT   SYSPRDCB,(R10)          WRITE MSG                        65850019
         MVI   CARRCTRL,SINGLESP       RESET CARRIAGE CONTROL TO        65900019
*                                        SINGLE SPACE                   65950019
         L     RETREG,SAVE300          LOAD RETURN ADDRESS              66000019
         BR    RETREG                  RETURN                           66050019
         SPACE 1                                                        66100019
TCR318   MVC   5(0,R10),0(R6)          MOVE MSG                         66150019
         SPACE 1                                                        66200019
TCR3183  MVC   5(0,R10),4(R10)         CLEAR PRINT AREA                 66250019
         EJECT                                                          66300019
*        CONSOLE DISPLAY ROUTINE                                        66350019
         SPACE 2                                                        66400019
TCR320   ST    RETREG,SAVE300          SAVE RETURN ADDRESS              66450019
         WTO   MF=(E,(R6))             ISSUE WTO                        66500019
TCR329   L     RETREG,SAVE300          LOAD RETURN ADDRESS              66550019
         BR    RETREG                  RETURN                           66600019
         SPACE 5                                                        66650019
*        SINGLE MESSAGE REQUEST INTERFACE                               66700019
         SPACE 2                                                        66750019
TCR330   TM    DUMMYIND,DUMSYSP        SYSPRINT DUMMY                   66800019
         BO    TCR228                  BR YES                           66850019
         XR    R2,R2                   CLEAR WORK REGISTER              66900019
         IC    R2,MSGLN                INSERT MSG LENGTH                66950019
         L     R6,MSGAD                LOAD MSG ADDRESS                 67000019
         BAL   RETREG,TCR310           DISPLAY ON SYSPRINT              67050019
         B     TCR228                  BR TO RETURN                     67100019
         EJECT                                                          67150019
*        LITERALS                                                       67200019
         SPACE 2                                                        67250019
TWOINS   EQU   X'40'                   TWO MSG INSERTS REQUIRED         67300019
CLEARLFT EQU   X'0F'                   INSERT CLEAR                     67350019
         SPACE 2                                                        67400019
*        DATA CONSTANTS AND STORAGE AREAS                               67450019
         SPACE 1                                                        67500019
SAVEAR2  DS    18F                     REGISTER SAVE AREA               67550019
ATCRCOM1 DC    A(TCRCOM)               COMMUNICATION REGION ADDRESS     67600019
SAVE300  DC    F'0'                    TCR3XX SAVE AREA                 67650019
FOUR     DC    F'04'                   BINARY FULL-WORD FOUR            67700019
HFONE    DC    X'0001'                 BINARY HALF-WORD ONE             67750019
HFIVE    DC    X'0005'                 BINARY HALF-WORD FIVE            67800019
SAVEINS  DC    X'00'                   MSG INSERT SAVE AREA             67850019
  TITLE 'IEBTCRIN - DRIVER MODULE -- TCRCOM - COMM. COMMUNICATION REG.' 67900019
*        COMMON COMMUNICATION REGION                                    67950019
         SPACE 1                                                        68000019
*        THIS CSECT CONTAINS TABLES, INDICATORS, CONSTANTS, WORK        68050019
*        AREAS, AND DCB'S THAT ARE USED BY TWO OR MORE MODULES.         68100019
         SPACE 2                                                        68150019
TCRCOM   CSECT                                                          68200019
         SPACE 1                                                        68250019
         DS    0F                      FORCE FULL-WORD ALIGNMENT        68300019
OPTABLE  DS    0CL8                    CONTROL CARD OPTION TABLE        68350019
         SPACE 1                                                        68400019
IEXITS   DC    X'00'                   USER ROUTINE INDICATORS          68450019
         SPACE 1                                                        68500019
*              BIT 0 - OUTHDR2                                          68550019
*                  1 - OUTTLR2                                          68600019
*                  2 - OUTHDR3                                          68650019
*                  3 - OUTTLR3                                          68700019
*                  4 - OUTREC                                           68750019
*                  5 - ERROR                                            68800019
*                  6 - USERTAB                                          68850019
*                  7 - NOT USED                                         68900019
         SPACE 1                                                        68950019
IPARM1   DC    X'00'                   TYPE AND TRANS INDICATORS        69000019
         SPACE 1                                                        69050019
*              BIT 0 - TYPE = MTST                                      69100019
*                  1 - TYPE = MTDI                                      69150019
*                  2 - UNUSED                                           69200019
*                  3 - TRANS = STDUC                                    69250019
*                  4 - TRANS = STDLC                                    69300019
*                  5 - TRANS = USERNAME                                 69350019
*                  6 - TRANS = NOTRAN                                   69400019
*                  7 - NOT USED                                         69450019
         SPACE 1                                                        69500019
IPARM2   DC    X'00'                   EDIT, VERCHK, AND ERROPT         69550019
*                                        INDICATORS                     69600019
         SPACE 1                                                        69650019
*              BIT 0 - EDIT = EDITD                                     69700019
*                  1 - EDIT = EDITR                                     69750019
*                  2 - EDIT = NOEDIT                                    69800019
*                  3 - VERCHK = VOKCHK                                  69850019
*                  4 - VERCHK = NOCHK                                   69900019
*                  5 - ERROPT = NORMAL                                  69950019
*                  6 - ERROPT = NOERR                                   70000019
*                  7 - UNUSED                                           70050019
         SPACE 1                                                        70100019
REPL     DC    X'19'                   REPLACE PARAMETER VALUE          70150019
MINLN    DC    X'0000'                 MINLN PARAMETER VALUE            70200019
MAXLN    DC    X'0000'                 MAXLN PARAMETER VALUE            70250019
         EJECT                                                          70300019
ADDRTAB  DS    0CL28                   USER ROUTINE ADDRESS TABLE       70350019
USERADDR DC    A(0,0,0,0,0,0,0)        TABLE                            70400019
         SPACE 1                                                        70450019
*              WORD 0 - OUTHDR2                                         70500019
*                   1 - OUTTLR2                                         70550019
*                   2 - OUTHDR3                                         70600019
*                   3 - OUTTLR3                                         70650019
*                   4 - OUTREC                                          70700019
*                   5 - ERROR                                           70750019
*                   6 - TRANSLATE TABLE                                 70800019
         SPACE 2                                                        70850019
MSGADDR  DC    A(0)                    MESSAGE MODULE ADDRESS           70900019
         SPACE 2                                                        70950019
*        NAME TABLE                                                     71000019
         SPACE 1                                                        71050019
*        THIS TABLE CONTAINS DDNAMES AND USER EXIT NAMES                71100019
         SPACE 1                                                        71150019
NAMETAB  DC    CL8'SYSIN',CL8'SYSPRINT',CL8'SYSUT1',CL8'SYSUT2'         71200019
         DC    CL8'SYSUT3',CL8'OUTHDR2',CL8'OUTTLR2'                    71250019
         DC    CL8'OUTHDR3',CL8'OUTTLR3',CL8'OUTREC',CL8'ERROR'         71300019
         DC    CL8'TRANS'                                               71350019
         SPACE 1                                                        71400019
*              WORDS 0-1   SYSIN                                        71450019
*                    2-3   SYSPRINT                                     71500019
*                    4-5   SYSUT1                                       71550019
*                    6-7   SYSUT2                                       71600019
*                    8-9   SYSUT3                                       71650019
*                   10-11  OUTHDR2                                      71700019
*                   12-13  OUTTLR2                                      71750019
*                   14-15  OUTHDR3                                      71800019
*                   16-17  OUTTLR3                                      71850019
*                   18-19  OUTREC                                       71900019
*                   20-21  ERROR                                        71950019
*                   22-23  TRANS                                        72000019
         EJECT                                                          72050019
*        MESSAGE POINTER TABLE                                          72100019
         SPACE 2                                                        72150019
*        THIS TABLE CONTAINS ONE FULL-WORD ENTRY FOR EACH IEB-TYPE      72200019
*        MESSAGE (EXCLUDING SYNAD MESSAGES).  MSG01 CORRESPONDS         72250019
*        TO IEB901; MSG02 CORRESPONDS TO IEB902; ETC.                   72300019
         SPACE 1                                                        72350019
*              BYTE  1 - MESSAGE REQUEST CODE                           72400019
*                                                                       72450019
*                        X'FF' = INDICATES REQUEST                      72500019
*                        X'00' = NO REQUEST                             72550019
*                                                                       72600019
*              BYTE  2 - INSERT CODE                                    72650019
*                                                                       72700019
*                        X'00' - NO INSERT                              72750019
*                        X'01' - SYSIN                                  72800019
*                        X'02' - SYSPRINT                               72850019
*                        X'03' - SYSUT1                                 72900019
*                        X'04' - SYSUT2                                 72950019
*                        X'05' - SYSUT3                                 73000019
*                        X'06' - OUTHDR2                                73050019
*                        X'07' - OUTTLR2                                73100019
*                        X'08' - OUTHDR3                                73150019
*                        X'09' - OUTTLR3                                73200019
*                        X'0A' - OUTREC                                 73250019
*                        X'0B' - ERROR                                  73300019
*                        X'0C' - USERTAB                                73350019
*                        X'54' - BOTH SYSUT2 AND SYSUT3                 73400019
*                                                                       73450019
*                    NOTE:  IF X'54' IS SPECIFIED, THE MESSAGE IS       73500019
*                        OUTPUT TWICE, ONCE WITH SYSUT2 AND ONCE        73550019
*                        WITH SYSUT3.                                   73600019
*                                                                       73650019
*              BYTE  3 - INSERT LOCATION  (MESSAGE DISPLACEMENT)        73700019
*                                                                       73750019
*                    NOTE:  IF WORLD TRADE REQUIREMENTS NECESSITATE     73800019
*                        MODIFICATION OF THE MESSAGE TEXT CONTAINED     73850019
*                        IN THE MESSAGE MODULE (IEBTCR02), THESE VALUES 73900019
*                        MAY ALSO REQUIRE MODIFICATION.  THE DISPLACE-  73950019
*                        MENTS ARE GIVEN IN HEXADECIMAL REPRESENTATION  74000019
*                        AND REFERENCE THE START OF THE ACTUAL MESSAGE  74050019
*                        TEXT.                                          74100019
*                                                                       74150019
*                        EXAMPLE:  IF MESSAGE 10 WERE AS FOLLOWS:       74200019
*                        'IEB910I NO SYSUT1   DD CARD - JOB TERMINA-    74250019
*                        TED', THE 'I' OF 'IEB910' WOULD REPRESENT      74300019
*                        DISPLACEMENT 0 AND THE FIRST 'S' OF 'SYSUT1'   74350019
*                        WOULD REPRESENT DISPLACEMENT '11'.             74400019
*                                                                       74450019
*                                                                       74500019
*              BYTE  4 - OUTPUT LOCATION                                74550019
*                                                                       74600019
*                        BIT 0 - UNUSED                                 74650019
*                            1 - UNUSED                                 74700019
*                            2 - UNUSED                                 74750019
*                            3 - UNUSED                                 74800019
*                            4 - UNUSED                                 74850019
*                            5 - SYSPRINT IF AVAILABLE, CONSOLE         74900019
*                                OTHERWISE                              74950019
*                            6 - CONSOLE                                75000019
*                            7 - SYSPRINT                               75050019
*                                                                       75100019
*                        NOTE - BITS 6 AND 7 MAY BE ON SIMULTANEOUSLY   75150019
         SPACE 1                                                        75200019
MSGPTRS  EQU   *                       ASSIGN MSGPTRS NAME TO TABLE     75250019
MSG01    DC    X'00000002'                                              75300019
MSG02    DC    X'00000001'                                              75350019
MSG03    DC    X'00000001'                                              75400019
MSG04    DC    X'00000001'                                              75450019
MSG05    DC    X'00000001'                                              75500019
MSG06    DC    X'00000001'                                              75550019
MSG07    DC    X'00000001'                                              75600019
MSG08    DC    X'00000001'                                              75650019
MSG09    DC    X'00000001'                                              75700019
MSG10    DC    X'00030B01'             INSERT LOC = 11                  75750019
MSG11    DC    X'00010B01'             INSERT LOC = 11                  75800019
MSG12    DC    X'00020B02'             INSERT LOC = 11                  75850019
MSG13    DC    X'00000B01'             INSERT LOC = 11                  75900019
MSG14    DC    X'00002501'             INSERT LOC = 37                  75950019
MSG15    DC    X'00000F04'             INSERT LOC = 15                  76000019
MSG16    DC    X'00001504'             INSERT LOC = 21                  76050019
MSG17    DC    X'00002201'             INSERT LOC = 34                  76100019
MSG18    DC    X'00001D01'             INSERT LOC = 29                  76150019
MSG19    DC    X'00000004'                                              76200019
MSG20    DC    X'00000002'                                              76250019
         SPACE 3                                                        76300019
MOUNTID  DS    F                       MOUNT MSG ID                     76350019
IOBADDR  DS    F                       SYSUT1 IOB ADDRESS               76400019
TCRBUFL  DC    X'0000'                 TCR BUFFER LENGTH                76450019
         SPACE 1                                                        76500019
ERRIND   DC    X'00'                   ABNORMAL TERMINATION INDICATORS  76550019
         SPACE 1                                                        76600019
*              BIT 0 - CONFLICTING DCB PARAMETERS                       76650019
*                  1 - STORAGE ALLOCATION ERROR                         76700019
*                  2 - I/O ERROR IN READ AND EDIT                       76750019
*                  3 - ERROR IN JFCB READ OR MOUNT                      76800019
*                  4 - ERROR DURING READ AND EDIT                       76850019
*                  5 - ERROR IN ANALYZING CONTROL CARDS                 76900019
*                  6 - PERMANENT I/O ERROR ON QSAM GET/PUT              76950019
*                  7 - ERROR IN LOADING UTILITY MODULE                  77000019
         SPACE 1                                                        77050019
DUMMYIND DC    X'00'                   DUMMY FILE INDICATORS            77100019
         SPACE 1                                                        77150019
*              BIT 0 - UNUSED                                           77200019
*                  1 - UNUSED                                           77250019
*                  2 - UNUSED                                           77300019
*                  3 - UNUSED                                           77350019
*                  4 - SYSUT3                                           77400019
*                  5 - SYSUT2                                           77450019
*                  6 - SYSPRINT                                         77500019
*                  7 - SYSIN                                            77550019
         EJECT                                                          77600019
*        DATA CONTROL BLOCK (DCB) EXIT LISTS                            77650019
         SPACE 2                                                        77700019
*        SYSIN EXIT LIST                                                77750019
         SPACE 1                                                        77800019
         DS    0F                      FORCE FULL-WORD ALIGNMENT        77850019
INEXLST  DC    X'07'                   JFCB EXIT                        77900019
         DC    AL3(0)                  WORK AREA ADDRESS                77950019
         DC    X'85'                   DCB EXIT                         78000019
         DC    AL3(TCR720)             DCB EXIT ROUTINE                 78050019
         DC    X'00'                   DUMMY ENTRY                      78100019
         DC    AL3(INLRECL)            DEFAULT TABLE ADDRESS            78150019
         SPACE 2                                                        78200019
*        SYSPRINT EXIT LIST                                             78250019
         SPACE 1                                                        78300019
PREXLST  DC    X'07'                   JFCB EXIT                        78350019
         DC    AL3(0)                  WORK AREA ADDRESS                78400019
         DC    X'05'                   DCB EXIT                         78450019
         DC    AL3(TCR720)             DCB EXIT ROUTINE                 78500019
         DC    X'00'                   DUMMY ENTRY                      78550019
         DC    AL3(PRTLRECL)           DEFAULT TABLE ADDRESS            78600019
         DC    X'00'                   OUTPUT HEADER LABEL (NULL)       78650019
         DC    AL3(0)                  NULL ENTRY                       78700019
         DC    X'80'                   OUTPUT TRAILER LABEL (NULL)      78750019
         DC    AL3(0)                  NULL ADDRESS                     78800019
         SPACE 2                                                        78850019
*        SYSUT1 EXIT LIST                                               78900019
         SPACE 1                                                        78950019
UT1EXLST DC    X'87'                   JFCB EXIT                        79000019
         DC    AL3(0)                  NULL ADDRESS                     79050019
         SPACE 2                                                        79100019
*        SYSUT2 EXIT LIST                                               79150019
         SPACE 1                                                        79200019
         DS    0F                      FORCE FULL-WORD ALIGNMENT        79250019
UT2EXLST DC    X'07'                   JFCB EXIT                        79300019
         DC    AL3(0)                  WORK AREA ADDRESS                79350019
         DC    X'05'                   DCB EXIT                         79400019
         DC    AL3(TCR720)             DCB EXIT ROUTINE                 79450019
         DC    X'00'                   DUMMY ENTRY                      79500019
         DC    AL3(UT2LRECL)           DEFAULT TABLE ADDRESS            79550019
         DC    X'00'                   OUTPUT HEADER LABEL              79600019
         DC    AL3(0)                  NULL ADDRESS                     79650019
         DC    X'80'                   OUTPUT TRAILER LABEL             79700019
         DC    AL3(0)                  NULL ADDRESS                     79750019
         SPACE 2                                                        79800019
*        SYSUT3 EXIT LIST                                               79850019
         SPACE 1                                                        79900019
UT3EXLST DC    X'07'                   JFCB EXIT                        79950019
         DC    AL3(0)                  WORK AREA ADDRESS                80000019
         DC    X'05'                   DCB EXIT                         80050019
         DC    AL3(TCR720)             DCB EXIT ROUTINE ADDR            80100019
         DC    X'00'                   DUMMY ENTRY                      80150019
         DC    AL3(UT3LRECL)           DEFAULT TABLE ADDRESS            80200019
         DC    X'00'                   OUTPUT HEADER LABEL              80250019
         DC    AL3(0)                  NULL ADDRESS                     80300019
         DC    X'80'                   OUTPUT TRAILER LABEL             80350019
         DC    AL3(0)                  NULL ADDRESS                     80400019
         SPACE 2                                                        80450019
*        DCB PARAMETER DEFAULTS                                         80500019
         SPACE 1                                                        80550019
INLRECL  DC    X'0050'                 SYSIN LRECL  - 80                80600019
INBLK    DC    X'0050'                 SYSIN BLKSIZE - 80               80650019
INRECFM  DC    X'90'                   SYSIN - FIXED BLOCKED            80700019
INIDENT  DC    X'01'                   INTERNAL IDENTIFICATION CODE     80750019
         SPACE 1                                                        80800019
PRTLRECL DC    X'0079'                 SYSPRINT LRECL -  121            80850019
PRTBLK   DC    X'0079'                 SYSPRINT BLKSIZE - 121           80900019
PRTRECFM DC    X'94'                   SYSPRINT - FIXED BLOCKED ASA     80950019
PRTIDENT DC    X'02'                   INTERNAL IDENTIFICATION CODE     81000019
         SPACE 1                                                        81050019
UT2LRECL DC    X'0000'                 SYSUT2 LRECL                     81100019
UT2BLK   DC    X'0000'                 SYSUT2 BLKSIZE                   81150019
UT2RECFM DC    X'50'                   SYSUT2 RECFM - VARIABLE BLOCKED  81200019
UT2IDENT DC    X'04'                   INTERNAL IDENTIFICATION CODE     81250019
         SPACE 1                                                        81300019
UT3LRECL DC    X'0000'                 SYSUT3 LRECL                     81350019
UT3BLK   DC    X'0000'                 SYSUT3 BLKSIZE                   81400019
UT3RECFM DC    X'50'                   SYSUT3 RECFM - VARIABLE BLOCKED  81450019
UT3IDENT DC    X'05'                   INTERNAL IDENTIFICATION CODE     81500019
         EJECT                                                          81550019
*        DATA CONTROL BLOCKS (DCB'S)                                    81600019
         SPACE 3                                                        81650019
*        SYSUT1 (TCR) DCB                                               81700019
         SPACE 2                                                        81750019
TCRDCB   DCB   DSORG=PS,MACRF=(E),DDNAME=SYSUT1,DEVD=TA,RECFM=UA,      X81800019
               BFTEK=S,EXLST=UT1EXLST,IOBAD=NULL                        81850019
         EJECT                                                          81900019
*        SYSUT2 DCB                                                     81950019
         SPACE 2                                                        82000019
UT2DCB   DCB   DSORG=PS,DDNAME=SYSUT2,DEVD=DA,EXLST=UT2EXLST,          X82050019
               SYNAD=TCR740,EROPT=ABE,MACRF=(PM)                        82100019
         SPACE 3                                                        82150019
*        SYSUT3 DCB                                                     82200019
         SPACE 2                                                        82250019
UT3DCB   DCB   DSORG=PS,DDNAME=SYSUT3,DEVD=DA,EXLST=UT3EXLST,          X82300019
               EROPT=ABE,SYNAD=TCR740,MACRF=(PM)                        82350019
         SPACE 3                                                        82400019
*        SYSIN DCB                                                      82450019
         SPACE 2                                                        82500019
SYSINDCB DCB   DSORG=PS,DDNAME=SYSIN,DEVD=DA,EODAD=NULL,MACRF=(GM),    X82550019
               EXLST=INEXLST,EROPT=ACC,SYNAD=TCR740                     82600019
         SPACE 3                                                        82650019
*        SYSPRINT DCB                                                   82700019
         SPACE 2                                                        82750019
SYSPRDCB DCB   DSORG=PS,DDNAME=SYSPRINT,DEVD=DA,EXLST=PREXLST,         X82800019
               MACRF=(PM)                                               82850019
         EJECT                                                          82900019
*        GETMAINED STORAGE ADDRESSES                                    82950019
         SPACE 2                                                        83000019
CARDAREA DS    F                       CARD INPUT AREA                  83050019
JFCBAREA DS    F                       JFCB AREA ADDRESS                83100019
PRTAREA  DS    F                       SYSPRINT OUTPUT AREA             83150019
PRTLNGTH DS    F                       PRINT AREA LENGTH                83200019
COLUMN9  DS    F                       CARD INPUT COLUMN 9 ADDRESS      83250019
CARDEND  DS    F                       INPUT AREA ENDING ADDRESS        83300019
         SPACE 2                                                        83350019
USERNAME DC    7XL8'00'                USER ROUTINE NAME TABLE          83400019
           SPACE 1                                                      83450019
*              WORDS 0 & 1  - OUTHDR2 ROUTINE                           83500019
*                    2 & 3  - OUTTLR2 ROUTINE                           83550019
*                    4 & 5  - OUTHDR3 ROUTINE                           83600019
*                    6 & 7  - OUTTLR3 ROUTINE                           83650019
*                    8 & 9  - OUTREC  ROUTINE                           83700019
*                   10 & 11 - ERROR ROUTINE                             83750019
*                   12 & 13 - TRANSLATE TABLE                           83800019
           SPACE 2                                                      83850019
MISCIND  DC    X'00'                   MISCELLANEOUS INDICATORS         83900019
         SPACE 1                                                        83950019
*              BIT 0 - UNUSED                                           84000019
*                  1 - UNUSED                                           84050019
*                  2 - UNUSED                                           84100019
*                  3 - SYSUT2 LRECL REQUIRES MAXLN INCREMENT            84150019
*                  4 - SYSUT2 BLKSIZE REQUIRES MAXLN INCREMENT          84200019
*                  5 - SYSUT3 LRECL REQUIRES MAXLN INCREMENT            84250019
*                  6 - SYSUT3 BLKSIZE REQUIRES MAXLN INCREMENT          84300019
*                  7 - ALTERNATE DDNAMES FOUND                          84350019
             SPACE 2                                                    84400019
         SPACE 1                                                        84450019
RETCODE  DC    X'00'                   RETURN CODE                      84500019
TCRDEV   DC    CL3'000'                TCR DEVICE                       84550019
VOLSER   DC    CL6' '                  VOLUME SERIAL NUMBER             84600019
PRTRTN   DC    X'00'                   MESSAGE WRITER OPTION IND        84650019
CARRCTRL DC    X'40'                   CARRIAGE CONTROL                 84700019
         SPACE 1                                                        84750019
         DS    0F                      FORCE FULL-WORD ALIGNMENT        84800019
ATCR220  DC    A(TCR220)               MESSAGE DISPLAY                  84850019
CURMSGAD DS    F                       CURRENT SYSPRINT MSG ADDRESS     84900019
MSGAD    DS    F                       SINGLE MESSAGE ADDRESS           84950019
MSGLN    DS    F                       SINGLE MSG LENGTH                85000019
JOBNAME  DC    CL8' '                  JOB NAME                         85050019
STEPNAME DC    CL8' '                  STEPNAME                         85100019
  TITLE 'IEBTCRIN - DRIVER MODULE - IHADCB DSECT'                       85150019
         DCBD  DSORG=PS                                                 85200019
         END   IEBTCRIN                                                 85250019
./  ADD  SSI=21040019,NAME=IEBTCR02
         TITLE 'IEBTCR02 - MESSAGE MODULE - INTRODUCTORY COMMENTARY'    00500019
*                                                                     * 01000019
*TITLE 'IEBTCR02' - MESSAGE MODULE                                    * 01500019
*                                                                     * 02000019
*STATUS:  CHANGE LEVEL 000                                            * 02500019
*                                                                     * 03000019
*FUNCTION/OPERATION:  THIS MODULE CONTAINS LIST-FORM WTO MACRO-       * 03500019
*   INSTRUCTIONS FOR ALL IEBXXXX MESSAGES. IN ADDITION IT CONTAINS    * 04000019
*   THE SYSPRINT PAGE HEADING, THE UTILITY COMPLETION MESSAGE, AND    * 04500019
*   A DUMMY WTO FOR OUTPUTTING OF SYNAD MESSAGES.                     * 05000019
*                                                                     * 05500019
*ENTRY POINTS:                                                        * 06000019
*                                                                     * 06500019
*        IEBTCR02 - ADDRESS OF POINTER TABLE                          * 07000019
*                                                                     * 07500019
*   THE MODULE IS BROUGHT IN BY THE DRIVER (IEBTCRIN) BY A LOAD       * 08000019
*   MACRO-INSTRUCTION.                                                * 08500019
*                                                                     * 09000019
*        LOAD EP=IEBTCR02                                             * 09500019
*                                                                     * 10000019
*INPUT:  N/A                                                          * 10500019
*                                                                     * 11000019
*OUTPUT:  N/A                                                         * 11500019
*                                                                     * 12000019
*EXTERNAL ROUTINES:  N/A                                              * 12500019
*                                                                     * 13000019
*EXITS:  N/A                                                          * 13500019
*                                                                     * 14000019
*TABLES/WORK AREAS:                                                   * 14500019
*                                                                     * 15000019
*   1) MSGTAB - THIS TABLE CONTAINS FIXED-LENGTH POINTERS TO THE      * 15500019
*      VARIABLE-LENGTH MESSAGE TABLE.  EACH ENTRY CONSISTS OF A ONE-  * 16000019
*      BYTE MESSAGE LENGTH AND A 3-BYTE MESSAGE ADDRESS.              * 16500019
*                                                                     * 17000019
*   2) MESSAGE - THIS TABLE CONTAINS THE ACTUAL MESSAGES IN THE FORM  * 17500019
*      OF LIST-FORM WTO MACRO-INSTRUCTIONS AND DC'S.                  * 18000019
*                                                                     * 18500019
*ATTRIBUTES:  SERIALLY RE-USABLE. NOT RE-ENTRANT.                     * 19000019
*                                                                     * 19500019
*NOTES:  THIS MODULE IS USED IN CONJUNCTION WITH THE MESSAGE WRITER   * 20000019
*   (TCR220) OF THE DRIVER MODULE (IEBTCRIN). IF A MESSAGE IS TO BE   * 20500019
*   OUTPUT TO SYSPRINT, THE MESSAGE IS EXTRACTED FROM THE WTO AND     * 21000019
*   MOVED TO A GETMAINED DATA AREA.  IF IT IS TO BE OUTPUT TO THE     * 21500019
*   CONSOLE, AN EXECUTE-FORM MACRO-INSTRUCTION IS ISSUED BY THE       * 22000019
*   MESSAGE WRITER.                                                   * 22500019
*                                                                     * 23000019
*   THE OPERATION OF THIS MODULE DOES NOT DEPEND UPON A PARTICULAR    * 23500019
*   INTERNAL REPRESENTATION OF THE EXTERNAL CHARACTER SET.            * 24000019
*                                                                     * 24500019
*   IF THE MESSAGE TEXT IS MODIFIED TO SATISFY WORLD TRADE            * 25000019
*   REQUIREMENTS, IT MAY BE NECESSARY TO MODIFY THE INSERT LOCATIONS  * 25500019
*   SPECIFIED IN THE MESSAGE POINTER TABLE MSGPTRS CONTAINED IN THE   * 26000019
*   IEBTCRIN COMMON COMMUNICATION REGION CSECT TCRCOM.                * 26500019
         TITLE 'IEBTCR02 - MESSAGE MODULE - TABLES'                     27000019
IEBTCR02 START                                                          27500019
         SPACE 2                                                        28000019
*        MESSAGE POINTER TABLE                                          28500019
         SPACE 1                                                        29000019
*        THIS TABLE CONTAINS ONE FOUR-BYTE ENTRY FOR EACH ENTRY OF      29500019
*        THE MESSAGE TABLE.  EACH ENTRY CONSISTS OF A ONE-BYTE          30000019
*        MESSAGE LENGTH AND A THREE-BYTE MESSAGE ADDRESS.               30500019
         SPACE 2                                                        31000019
MSGTAB   DS    0F                      FORCE FULL-WORD ALIGNMENT        31500019
         DC    AL1(B-A-8)              LENGTH MSG 01                    32000019
         DC    AL3(A)                  ADDRESS MSG 01                   32500019
         DC    AL1(C-B-8)              LENGTH MSG 02                    33000019
         DC    AL3(B)                  ADDRESS MSG 02                   33500019
         DC    AL1(D-C-8)              LENGTH MSG 03                    34000019
         DC    AL3(C)                  ADDRESS MSG 03                   34500019
         DC    AL1(E-D-8)              LENGTH MSG 04                    35000019
         DC    AL3(D)                  ADDRESS MSG 04                   35500019
         DC    AL1(F-E-8)              LENGTH MSG 05                    36000019
         DC    AL3(E)                  ADDRESS MSG 05                   36500019
         DC    AL1(G-F-8)              LENGTH MSG 06                    37000019
         DC    AL3(F)                  ADDRESS MSG 06                   37500019
         DC    AL1(H-G-8)              LENGTH MSG 07                    38000019
         DC    AL3(G)                  ADDRESS MSG 07                   38500019
         DC    AL1(I-H-8)              LENGTH MSG 08                    39000019
         DC    AL3(H)                  ADDRESS MSG 08                   39500019
         DC    AL1(J-I-8)              LENGTH MSG 09                    40000019
         DC    AL3(I)                  ADDRESS MSG 09                   40500019
         DC    AL1(K-J-8)              LENGTH MSG 10                    41000019
         DC    AL3(J)                  ADDRESS MSG 10                   41500019
         DC    AL1(L-K-8)              LENGTH MSG 11                    42000019
         DC    AL3(K)                  ADDRESS MSG 11                   42500019
         DC    AL1(M-L-8)              LENGTH MSG 12                    43000019
         DC    AL3(L)                  ADDRESS MSG 12                   43500019
         DC    AL1(N-M-8)              LENGTH MSG 13                    44000019
         DC    AL3(M)                  ADDRESS MSG 13                   44500019
         DC    AL1(O-N-8)              LENGTH MSG 14                    45000019
         DC    AL3(N)                  ADDRESS MSG 14                   45500019
         DC    AL1(P-O-8)              LENGTH MSG 15                    46000019
         DC    AL3(O)                  ADDRESS MSG 15                   46500019
         DC    AL1(Q-P-8)              LENGTH MSG 16                    47000019
         DC    AL3(P)                  ADDRESS MSG 16                   47500019
         DC    AL1(R-Q-8)              LENGTH MSG 17                    48000019
         DC    AL3(Q)                  ADDRESS MSG 17                   48500019
         DC    AL1(S-R-8)              LENGTH MSG 18                    49000019
         DC    AL3(R)                  ADDRESS MSG 18                   49500019
         DC    AL1(T-S-8)              LENGTH MSG 19                    50000019
         DC    AL3(S)                  ADDRESS MSG 19                   50500019
         DC    AL1(U-T-8)              LENGTH MSG 20                    51000019
         DC    AL3(T)                  ADDRESS MSG 20                   51500019
         DC    AL1(V-U)                LENGTH MSG U                     52000019
         DC    AL3(U)                  ADDRESS MSG U                    52500019
         DC    AL1(Z-V)                LENGTH MSG V                     53000019
         DC    AL3(V)                  ADDRESS MSG V                    53500019
         DC    AL4(Z)                  NULL ENTRY LENGTH                54000019
         EJECT                                                          54500019
*        MESSAGE TABLE                                                  55000019
         SPACE 1                                                        55500019
*        THIS TABLE CONTAINS LIST-FORM WTO MACRO-INSTRUCTIONS           56000019
*        FOR ALL IEBXXXX MESSAGES, INCLUDING A DUMMY FOR OUTPUTTING     56500019
*        OF SYNAD MESSAGES.  IN ADDITION IT CONTAINS DC'S FOR THE       57000019
*        SYSPRINT HEADING MESSAGE AND COMPLETION MESSAGE.               57500019
         SPACE 2                                                        58000019
MESSAGE  DS    0F                      FORCE FULL-WORD ALIGNMENT        58500019
         SPACE 1                                                        59000019
A        WTO   'IEB901A M DDD,XXXXXX,JJJJJJJJ,SSSSSSSS',MF=L,          X59500019
               ROUTCDE=3,DESC=2                                         60000019
         SPACE 1                                                        60500019
B        WTO   'IEB902I INVALID NAME FIELD',MF=L,ROUTCDE=11,DESC=7      61000019
        SPACE 1                                                         61500019
C        WTO   'IEB903I INVALID OPERATION',MF=L,ROUTCDE=11,DESC=7       62000019
        SPACE 1                                                         62500019
D        WTO   'IEB904I INVALID KEYWORD',MF=L,ROUTCDE=11,DESC=7         63000019
        EJECT                                                           63500019
E        WTO   'IEB905I INVALID PARAMETER VALUE',MF=L,ROUTCDE=11,      X64000019
               DESC=7                                                   64500019
         SPACE 1                                                        65000019
F        WTO   'IEB906I DUPLICATE OPERATION FIELD',MF=L,ROUTCDE=11,    X65500019
               DESC=7                                                   66000019
         SPACE 1                                                        66500019
G        WTO   'IEB907I INCONSISTENT REPLACE PARAMETER',MF=L,          X67000019
               ROUTCDE=11,DESC=7                                        67500019
         SPACE 1                                                        68000019
H        WTO   'IEB908I CONFLICTING OPTIONS SPECIFIED',MF=L,           X68500019
               ROUTCDE=11,DESC=7                                        69000019
         SPACE 1                                                        69500019
I        WTO   'IEB909I EXPECTED CONTINUATION NOT RECEIVED',MF=L,      X70000019
               ROUTCDE=11,DESC=7                                        70500019
         EJECT                                                          71000019
J        WTO   'IEB910I NO SYSUT1   DD CARD - JOB TERMINATED',         X71500019
               ROUTCDE=11,DESC=7,MF=L                                   72000019
         SPACE 1                                                        72500019
K        WTO   'IEB911I NO SYSIN    DD CARD - ALL DEFAULT OPTIONS ASSUMX73000019
               ED',ROUTCDE=11,DESC=7,MF=L                               73500019
         SPACE 1                                                        74000019
L        WTO   'IEB912I NO SYSPRINT DD CARD - DUMMY ASSUMED',          X74500019
               ROUTCDE=11,DESC=7,MF=L                                   75000019
         SPACE 1                                                        75500019
M        WTO   'IEB913I NO XXXXXXXX DD CARD - DUMMY ASSUMED',          X76000019
               ROUTCDE=11,DESC=7,MF=L                                   76500019
         SPACE 1                                                        77000019
N        WTO   'IEB914I DCB SUBPARAMETERS MISSING IN XXXXXXXX DD CARD -X77500019
                DEFAULTS ASSUMED',ROUTCDE=11,DESC=7,MF=L                78000019
         EJECT                                                          78500019
O        WTO   'IEB915I DDNAME XXXXXXXX CANNOT BE OPENED',ROUTCDE=11,  X79000019
               DESC=7,MF=L                                              79500019
         SPACE 1                                                        80000019
P        WTO   'IEB916I INCONSISTENT XXXXXXXX DCB PARAMETERS',         X80500019
               ROUTCDE=11,DESC=7,MF=L                                   81000019
         SPACE 1                                                        81500019
Q        WTO   'IEB917I LOAD MODULE SPECIFIED FOR XXXXXXXX NOT FOUND', X82000019
               ROUTCDE=11,DESC=7,MF=L                                   82500019
         SPACE 1                                                        83000019
R        WTO   'IEB918I JOB TERMINATED AFTER XXXXXXXX EXIT',           X83500019
               ROUTCDE=11,DESC=7,MF=L                                   84000019
         SPACE 1                                                        84500019
S        WTO   'IEB919I INSUFFICIENT STORAGE AVAILABLE',ROUTCDE=11,    X85000019
               DESC=7,MF=L                                              85500019
         EJECT                                                          86000019
T        WTO   '                                                       X86500019
                                ',ROUTCDE=11,DESC=7,MF=L                87000019
         SPACE 2                                                        87500019
U        DC    C'IEBTCRIN DATA SET UTILITY'                             88000019
V        DC    C'IEBTCRIN COMPLETED'                                    88500019
Z        DS    0C                      NULL ENTRY                       89000019
         END                                                            89500019
./  ADD  SSI=21040020,NAME=IEBTCR03
         TITLE 'IEBTCR03 - JFCB ANALYZER - INTRODUCTORY COMMENTARY'     00100019
*                                                                     * 00200019
*TITLE 'IEBTCR03' - JOB FILE CONTROL BLOCK ANALYZER                   * 00300019
*                                                                     * 00400019
*STATUS: CHANGE LEVEL 000                                             * 00500019
*                                                                     * 00600019
*FUNCTION/OPERATION:  IEBTCR03 PERFORMS FIVE FUNCTIONS:               * 00700019
*                                                                     * 00800019
*   1) INSERTION OF ALTERNATIVE DDNAMES IN DCB'S                      * 00900019
*                                                                     * 01000019
*   2) CHECKING OF THE TIOT FOR MISSING DD STATEMENTS                 * 01100019
*                                                                     * 01200019
*   3) EXTRACTION OF DEVICE, VOLUME, AND JOB IDENTIFICATION FROM      * 01300019
*      SYSTEM CONTROL BLOCKS                                          * 01400019
*                                                                     * 01500019
*   4) ANALYSIS OF JOB FILE CONTROL BLOCKS (JFCB'S) TO DETERMINE      * 01600019
*      MISSING DCB PARAMETERS                                         * 01700019
*                                                                     * 01800019
*   5) ASSIGNMENT OF DEFAULTS TO MISSING PARAMETERS                   * 01900019
*                                                                     * 02000019
*   THE JOB FILE CONTROL BLOCK ANALYZER USES THE TASK INPUT/OUTPUT    * 02100019
*   TABLE (TIOT) AND THE UNIT CONTROL BLOCK (UCB) TABLE TO DETERMINE  * 02200019
*   THE DEVICE ALLOCATED TO THE TASK FOR THE SYSUT1 (TCR INPUT) DATA  * 02300019
*   SET.  IT EXTRACTS FROM THE JOB FILE CONTROL BLOCK (JFCB) ANY      * 02400019
*   EXTERNAL IDENTIFICATION ASSOCIATED WITH THE DATA SET BY MEANS OF  * 02500019
*   THE VOLUME=SER=XXXXXX DD STATEMENT PARAMETER. IT REMOVES JOB      * 02600019
*   AND STEP IDENTIFICATION FROM THE TIOT. IT STORES ALL OF THIS      * 02700019
*   INFORMATION IN THE COMMON COMMUNICATION REGION FOR LATER USE BY   * 02800019
*   THE DRIVER (IEBTCRIN) MOUNT ROUTINE.                              * 02900019
*                                                                     * 03000019
*   IF THE ANALYZER DETECTS A MISSING DD STATEMENT (OTHER THAN SYSUT1), 03100019
*   IT SETS A DUMMY FILE INDICATOR FOR THIS DATA SET, SETS AN APPRO-  * 03200019
*   PRIATE MESSAGE INDICATOR, AND ASSIGNS A RETURN CODE OF 4.  IF THE * 03300019
*   DATA SET IS SYSUT1, THE ANALYZER SETS MESSAGE INDICATORS, ESTA-   * 03400019
*   BLISHES A RETURN CODE OF 12, AND RETURNS CONTROL TO THE DRIVER    * 03500019
*   WITH A REQUEST FOR TERMINATION.                                   * 03600019
*                                                                     * 03700019
*   IF THE ANALYZER DETERMINES THAT DCB PARAMETERS WERE OMITTED,      * 03800019
*   IT DEVELOPS COMPLETE OR PARTIAL DEFAULTS DEPENDING UPON THE       * 03900019
*   DATA SET INVOLVED.   FOR SYSIN AND SYSPRINT, COMPLETE DEFAULTS    * 04000019
*   ARE DEVELOPED.  FOR SYSUT2 AND SYSUT3, A RECORD FORMAT INCREMENT  * 04100019
*   IS ASSIGNED AS A BASIC DEFAULT FOR LRECL AND BLKSIZE WITH AN      * 04200019
*   INDICATION THAT MAXLN MUST BE ADDED BY THE DRIVER. FOR VARIABLE   * 04300019
*   LENGTH RECORDS THE INCREMENTS ARE 4 AND 8 BYTES FOR LRECL AND     * 04400019
*   BLKSIZE. FOR UNDEFINED OR FIXED-LENGTH RECORDS, THE INCREMENT IS  * 04500019
*   ZERO.  THE DEFAULTS ARE INSERTED AT OPEN TIME BY THE DRIVER.      * 04600019
*                                                                     * 04700019
*   IF THE USER INCLUDES SOME PARAMETERS (E.G., RECFM) BUT OMITS      * 04800019
*   OTHERS, THE JFCB ANALYZER ATTEMPTS TO SET DEFAULTS WHICH ARE      * 04900019
*   CONSISTENT WITH THE PARAMETERS THAT HAVE BEEN SUPPLIED.  IF       * 05000019
*   THE USER PROVIDES A PARAMETER WHICH IS NOT CONSISTENT WITH        * 05100019
*   DEFAULTS ESTABLISHED FOR KEYWORDS WHICH ARE MISSING, THE JFCB     * 05200019
*   ANALYZER WILL ISSUE A REQUEST FOR TERMINATION.                    * 05300019
         EJECT                                                          05400019
*ENTRY POINTS:                                                        * 05500019
*                                                                       05600019
*        IEBTCR03 - JOB FILE CONTROL BLOCK ANALYZER                   * 05700019
*                                                                     * 05800019
*   THIS MODULE IS LINKED TO BY THE DRIVER MODULE (IEBTCRIN):         * 05900019
*                                                                     * 06000019
*        LINK  EP=IEBTCR03,PARAM=TCRCOM                               * 06100019
*                                                                     * 06200019
*   PARAMETER DATA IS PASSED BY NAME VIA THE COMMON COMMUNICATION     * 06300019
*   REGION AND CONSISTS OF DCB EXIT LISTS, DCB PARAMETER DEFAULT      * 06400019
*   TABLES, AND MISCELLANEOUS DATA STORAGE AREAS.                     * 06500019
*                                                                     * 06600019
*INPUT:                                                               * 06700019
*                                                                     * 06800019
*   1) THE TASK INPUT/OUTPUT TABLE (TIOT)                             * 06900019
*                                                                     * 07000019
*   2) JOB FILE CONTROL BLOCKS (JFCB'S) FOR ALL DATA SETS             * 07100019
*                                                                     * 07200019
*   3) UNIT CONTROL BLOCK (UCB) ASSOCIATED WITH THE SYSUT1 DEVICE     * 07300019
*                                                                     * 07400019
*   ALL OF THESE CONTROL BLOCKS ARE READ THROUGH USE OF STANDARD      * 07500019
*   SYSTEM MACROS.                                                    * 07600019
*                                                                     * 07700019
*OUTPUT:  DCB PARAMETER DEFAULT TABLES                                * 07800019
*                                                                     * 07900019
*   THESE TABLES ARE CONSTRUCTED IN THE COMMON COMMUNICATION REGION   * 08000019
*                                                                     * 08100019
*EXTERNAL ROUTINES:  NONE                                             * 08200019
*                                                                     * 08300019
*EXITS-NORMAL:  NONE                                                  * 08400019
*     -ERROR:   NONE                                                  * 08500019
*                                                                     * 08600019
*TABLES/WORK AREAS:                                                   * 08700019
*                                                                     * 08800019
*   1) DCB EXIT LIST TABLES - INEXLST, PREXLST, UT1EXLST, UT2EXLST,   * 08900019
*      UT3EXLST - THESE TABLES CONTAIN JFCB WORK AREA ADDRESS ENTRIES * 09000019
*      WHICH ARE USED DURING EXECUTION OF THE RDJFCB MACRO INSTRUC-   * 09100019
*      TION.                                                          * 09200019
*                                                                     * 09300019
*   2) DCB DEFAULT TABLES - INLRECL, PRTLRECL, UT2LRECL, UT3LRECL     * 09400019
*      THESE TABLES ARE USED FOR CONSTRUCTING DEFAULTS FOR THE DCB    * 09500019
*      RECFM, LRECL, AND BLKSIZE PARAMETERS.                          * 09600019
*                                                                     * 09700019
*ATTRIBUTES:  NON-REENTRANT AND NON-REUSABLE.                         * 09800019
*                                                                     * 09900019
*NOTES:  THE OPERATION OF THIS MODULE DOES NOT DEPEND UPON A PARTI-   * 10000019
*   CULAR INTERNAL REPRESENTATION OF THE EXTERNAL CHARACTER SET.      * 10100019
         TITLE 'IEBTCR03 - JFCB ANALYZER - REGISTER DEFINITIONS'        10200019
IEBTCR03 START 0                                                        10300019
         SPACE 2                                                        10400019
*        REGISTER DEFINITIONS                                           10500019
         SPACE 2                                                        10600019
PARMREG  EQU   1                       PARAMETER LIST REGISTER          10700019
COMMREG  EQU   2                       COMMUNICATION REGION             10800019
UCBREG   EQU   6                       UCB REGISTER                     10900019
INCREG   EQU   9                       TIOT INCREMENT                   11000019
TIOTREG  EQU   11                      TIOT REGISTER                    11100019
BASEREG  EQU   12                      BASE REGISTER                    11200019
SAVEREG  EQU   13                      SAVE AREA REGISTER               11300019
RETREG   EQU   14                      RETURN REGISTER                  11400019
LNKREG15 EQU   15                      LINK REGISTER                    11500019
R0       EQU   0                       REGISTER 0                       11600019
R1       EQU   1                       REGISTER 1                       11700019
R3       EQU   3                       REGISTER 3                       11800019
R4       EQU   4                       REGISTER 4                       11900019
R5       EQU   5                       REGISTER 5                       12000019
R6       EQU   6                       REGISTER 6                       12100019
R15      EQU   15                      REGISTER 15                      12200019
         TITLE 'IEBTCR03 - JFCB ANALYZER - PROCESSING ROUTINES'         12300019
*        THIS SECTION SAVES THE CALLING MODULE'S GENERAL REGISTERS,     12400019
*        SETS UP A SAVEAREA ADDRESS, AND ESTABLISHES BASE REGISTERS     12500019
*        FOR THIS MODULE AND FOR THE COMMON COMMUNICATION REGION.       12600019
         SPACE 2                                                        12700019
         SAVE  (14,12),T,IEBTCR03      SAVE REGISTERS                   12800019
         BALR  BASEREG,R0              ESTABLISH BASE REGISTER          12900019
         USING *,BASEREG               INDICATE BASE REGISTER           13000019
         LR    R15,SAVEREG             SET UP SAVE AREA POINTERS        13100019
         ST    R15,SAVEAREA+4                                           13200019
         LA    SAVEREG,SAVEAREA                                         13300019
         ST    SAVEREG,8(R15)                                           13400019
         XR    R15,R15                                                  13500019
         ST    R15,0(SAVEREG)                                           13600019
         L     COMMREG,0(PARMREG)      LOAD COMMUNICATION REGION ADDR   13700019
         USING TCRCOM,COMMREG          INDICATE COMM. REG. BASE REG     13800019
         EJECT                                                          13900019
*        DDNAME INSERTION ROUTINE                                       14000019
         SPACE 1                                                        14100019
*        THIS ROUTINE TESTS AN  INDICATOR IN THE COMMON COMMUNICATION   14200019
*        REGION TO DETERMINE WHETHER OR NOT ALTERNATIVE DDNAMES HAVE    14300019
*        BEEN PROVIDED BY THE USER. IF THEY HAVE BEEN, THIS ROUTINE     14400019
*        INSERTS THEM IN THE RESPECTIVE DCB'S, REPLACING THE STANDARD   14500019
*        NAMES.                                                         14600019
         SPACE 2                                                        14700019
TCR100   TM    MISCIND,DDON            TEST ALTERNATIVE DDNAMES PRESENT 14800019
         BNO   TCR102                  BRANCH NO                        14900019
         USING IHADCB,R3               INDICATE DCB DSECT REG           15000019
         LA    R3,SYSINDCB             LOAD SYSIN DCB ADDRESS           15100019
         MVC   DCBDDNAM(DDLENGTH),NAMETAB  STORE ALTER. SYSIN DDNAME    15200019
         LA    R3,TCRDCB               LOAD SYSUT1 DCB ADDRESS          15300019
         MVC   DCBDDNAM(DDLENGTH),NAMETAB+SYS1DISP  STORE ALTERNATE     15400019
*                                      SYSUT1 DDNAME                    15500019
         LA    R3,SYSPRDCB             LOAD SYSPRINT DCB ADDRESS        15600019
         MVC   DCBDDNAM(DDLENGTH),NAMETAB+SYSPDISP  STORE ALTERNATE     15700019
*                                      SYSPRINT DDNAME                  15800019
         LA    R3,UT2DCB               LOAD SYSUT2 DCB ADDRESS          15900019
         MVC   DCBDDNAM(DDLENGTH),NAMETAB+SYS2DISP  STORE ALTERNATE     16000019
*                                        SYSUT2 DDNAME                  16100019
         LA    R3,UT3DCB               LOAD SYSUT3 DCB ADDRESS          16200019
         MVC   DCBDDNAM(DDLENGTH),NAMETAB+SYS3DISP  STORE ALTERNATE     16300019
*                                      SYSUT3 DDNAME                    16400019
         EJECT                                                          16500019
*        JFCB WORK AREA CORE ALLOCATION ROUTINE                         16600019
         SPACE 1                                                        16700019
*        THIS ROUTINE GETMAINS ONE BLOCK OF CORE FOR ALL OF THE         16800019
*        JFCB WORK AREAS. IT THEN APPORTIONS IT AMONG THE DCB'S         16900019
*        AND STORES THE ADDRESSES IN THE RESPECTIVE EXIT LISTS.         17000019
         SPACE 2                                                        17100019
TCR102   LA    R1,JFCBLN(0,0)          LOAD TOTAL LENGTH - 720 BYTES    17200019
         ST    R1,GETMREQ              STORE MINIMUM LENGTH             17300019
         ST    R1,GETMREQ+4            STORE MAXIMUM LENGTH             17400019
         GETMAIN   VC,LA=GETMREQ,A=GETMADD                              17500019
         L     R1,GETMADD              LOAD STORAGE ADDRESS             17600019
         LTR   R15,R15                 TEST RETURN CODE                 17700019
         BZ    TCR103                  BR IF STORAGE ALLOCATED          17800019
         OI    ERRIND,ALLOCERR         SET ERROR INDICATOR              17900019
         MVI   MSG19,MSGON             SET MSG INDICATOR                18000019
         MVI   RETCODE,CODE16          SET RETURN CODE                  18100019
         B     TCR199                  BR TO RETURN                     18200019
         SPACE 1                                                        18300019
TCR103   ST    R1,JFCBAREA             SAVE STORAGE ADDRESS             18400019
         ST    R1,UT1EXLST             STORE CORE ADDRESS IN SYSUT1     18500019
         MVI   UT1EXLST,UT1JFCB        EXIT LIST                        18600019
         ST    R1,INEXLST              STORE ADDRESS OF CORE IN         18700019
         MVI   INEXLST,JFCBCODE          SYSIN EXLST                    18800019
         LA    R1,JFCBINCR(R1)         INCREMENT TO NEXT STORAGE AREA   18900019
         ST    R1,PREXLST              STORE ADDR OF NEXT AREA IN       19000019
         MVI   PREXLST,JFCBCODE          SYSPRINT EXLST                 19100019
         LA    R1,JFCBINCR(R1)         INCREMENT TO NEXT STORAGE AREA   19200019
         ST    R1,UT2EXLST             STORE ADDR OF NEXT AREA IN       19300019
         MVI   UT2EXLST,JFCBCODE         SYSUT2 EXLST                   19400019
         LA    R1,JFCBINCR(R1)         INCREMENT TO NEXT STORAGE AREA   19500019
         ST    R1,UT3EXLST             STORE ADDR OF NEXT AREA IN       19600019
         MVI   UT3EXLST,JFCBCODE         SYSUT3 EXLST                   19700019
         EJECT                                                          19800019
*        THIS ROUTINE EXTRACTS THE JOB NAME AND STEP NAME FROM THE      19900019
*        TIOT AND STORES IT IN THE COMMON COMMUNICATION REGION FOR      20000019
*        LATER INSERTION IN THE MOUNT MESSAGE BY THE DRIVER. IT ALSO    20100019
*        TESTS WHETHER THE SYSUT1 DD STATEMENT HAS BEEN PROVIDED.       20200019
*        IF IT HAS NOT, IT SETS MSG AND ERROR INDICATORS AND SETS THE   20300019
*        RETURN CODE TO 12. IF IT HAS BEEN, IT EXTRACTS THE DEVICE NAME 20400019
*        FROM THE UCB AND STORES IT IN THE COMMON COMMUNICATION         20500019
*        REGION.                                                        20600019
         SPACE 2                                                        20700019
         EXTRACT  TIOTADR,FIELDS=TIOT  GET TIOT ADDRESS                 20800019
         L     TIOTREG,TIOTADR         LOAD TIOT ADDRESS                20900019
         MVC   JOBNAME(8),TIOCNJOB(TIOTREG)  STORE JOB NAME             21000019
         MVC   STEPNAME(8),TIOCSTP(TIOTREG)  STORE STEP NAME            21100019
         MVC   NAMEHOLD,NAMETAB+16     LOAD SYSUT1 DDNAME               21200019
         MVI   TIOTDDNM,HEXZERO        CLEAR INDICATOR                  21300019
         BAL   RETREG,TCR720           LOAD ADDR COMPARE RTN            21400019
         TM    TIOTDDNM,NAMEFND        SYSUT1 FOUND                     21500019
         BO    TCR105                  BR IF FOUND                      21600019
         OI    ERRIND,JFCBERR          SET ERROR INDICATOR              21700019
         MVI   MSG10,MSGON             SET  MSG INDICATOR               21800019
         MVI   RETCODE,CODE12          SET RETURN CODE  12              21900019
         B     TCR107                  BR TO CONTINUE PROC              22000019
         SPACE 1                                                        22100019
TCR105   L     UCBREG,UCBDISP(TIOTREG) LOAD ADDR OF UCB                 22200019
         LA    UCBREG,0(UCBREG)        CLEAR HIGH-ORDER BYTE            22300019
         MVC   TCRDEV(DEVLNGTH),DEVDISP(UCBREG)  MOVE DEVICE NAME       22400019
         EJECT                                                          22500019
*        THIS ROUTINE TESTS WHETHER OR NOT THE SYSPRINT AND SYSIN       22600019
*        DD STATEMENTS HAVE BEEN PROVIDED.  IF EITHER OR BOTH HAVE      22700019
*        NOT, MESSAGE INDICATORS ARE SET AND THE RETURN CODE IS SET     22800019
*        TO 04.                                                         22900019
         SPACE 2                                                        23000019
TCR107   MVC   NAMEHOLD,NAMETAB+8      LOAD SYSPRINT DDNAME             23100019
         MVI   TIOTDDNM,HEXZERO        CLEAR INDICATOR                  23200019
         BAL   RETREG,TCR720           LOAD ADDR COMPARE RTN            23300019
         TM    TIOTDDNM,NAMEFND        SYSPRINT FOUND                   23400019
         BO    TCR109                  BR IF FOUND                      23500019
         OI    DUMMYIND,DUMSYSP        SET SYSPRINT DUMMY INDICATOR     23600019
         MVI   MSG12,MSGON             SET MSG INDICATOR                23700019
         CLI   RETCODE,CODE04          CURRENT RETURN CODE GREATER      23800019
*                                        THAN 04                        23900019
         BNL   TCR109                  BR HIGH OR EQUAL                 24000019
         MVI   RETCODE,CODE04          SET RETURN CODE 04               24100019
*                                                                       24200019
TCR109   MVC   NAMEHOLD,NAMETAB        LOAD SYSIN DDNAME                24300019
         MVI   TIOTDDNM,HEXZERO        CLEAR INDICATOR                  24400019
         BAL   RETREG,TCR720           LOAD ADDR COMPARE RTN            24500019
         TM    TIOTDDNM,NAMEFND        SYSIN FOUND                      24600019
         BO    TCR111                  BR IF FOUND                      24700019
         OI    DUMMYIND,DUMSYSIN       SET SYSIN DUMMY INDICATOR        24800019
         MVI   MSG11,MSGON             SET MSG INDICATOR                24900019
         CLI   RETCODE,CODE04          CURRENT RETURN CODE GREATER      25000019
*                                        THAN 04                        25100019
         BNL   TCR111                  BR HIGH OR EQUAL                 25200019
         MVI   RETCODE,CODE04          SET RETURN CODE 04               25300019
         EJECT                                                          25400019
*        THIS ROUTINE TESTS WHETHER SYSUT2 AND SYSUT3 DD STATEMENTS     25500019
*        HAVE BEEN PROVIDED. IF THEY HAVE NOT BEEN, MESSAGE INDI-       25600019
*        CATORS ARE SET AND THE RETURN CODE IS SET TO 04.               25700019
         SPACE 2                                                        25800019
*                                                                       25900019
TCR111   MVC   NAMEHOLD,NAMETAB+24     LOAD SYSUT2 DDNAME               26000019
         MVI   TIOTDDNM,HEXZERO        CLEAR INDICATOR                  26100019
         BAL   RETREG,TCR720           LOAD ADDR COMPARE RTN            26200019
         TM    TIOTDDNM,NAMEFND        SYSUT2 FOUND                     26300019
         BO    TCR113                  BR IF FOUND                      26400019
         OI    DUMMYIND,DUMSYS2        SET SYSUT2 DUMMY INDICATOR       26500019
         MVI   MSG13,MSGON             SET MSG INDICATOR                26600019
         MVI   MSG13+1,INSUT2          SET MSG INSERT POINTER           26700019
         CLI   RETCODE,CODE04          CURRENT RETURN CODE GREATER      26800019
*                                        THAN 04                        26900019
         BNL   TCR113                  BR HIGH OR EQUAL                 27000019
         MVI   RETCODE,CODE04          SET RETURN CODE 04               27100019
*                                                                       27200019
TCR113   MVC   NAMEHOLD,NAMETAB+32     LOAD SYSUT3 DDNAME               27300019
         MVI   TIOTDDNM,HEXZERO        CLEAR INDICATOR                  27400019
         BAL   RETREG,TCR720           LOAD ADDR COMPARE RTN            27500019
         TM    TIOTDDNM,NAMEFND        SYSUT3 FOUND                     27600019
         BO    TCR119                  BR IF FOUND                      27700019
         OI    DUMMYIND,DUMSYS3        SET SYSUT3 DUMMY INDICATOR       27800019
         MVI   MSG13,MSGON             SET MSG INDICATOR                27900019
         CLI   RETCODE,CODE04          CURRENT RETURN CODE GREATER      28000019
*                                        THAN 04                        28100019
         BNL   TCR115                  BR HIGH OR EQUAL                 28200019
         MVI   RETCODE,CODE04          SET RETURN CODE 04               28300019
TCR115   CLI   MSG13+1,HEXZERO         SYSUT2 INSERT SET                28400019
         BE    TCR117                  BR  NO                           28500019
         MVI   MSG13+1,INSUT23         SET BOTH INSERTS                 28600019
         B     TCR119                  BR TO CONTINUE PROCESSING        28700019
TCR117   MVI   MSG13+1,INSUT3          SET SYSUT3 INSERT ONLY           28800019
         EJECT                                                          28900019
*        JFCB READ ROUTINE                                              29000019
         SPACE 1                                                        29100019
*        THIS ROUTINE READS THE JFCBS INTO THE GETMAINED STORAGE        29200019
*        AREAS.                                                         29300019
         SPACE 2                                                        29400019
TCR119   LA    R3,SYSINDCB                                              29500019
         LA    R4,SYSPRDCB                                              29600019
         LA    R5,UT2DCB                                                29700019
         LA    R6,UT3DCB                                                29800019
         RDJFCB  ((R3),,(R4),,(R5),,(R6))                               29900019
         EJECT                                                          30000019
*        THE FOLLOWING ROUTINES SET DEFAULTS WHERE REQUIRED.            30100019
*        IN THE CASE OF SYSUT2 AND SYSUT3 ONLY PARTIAL DEFAULTS         30200019
*        ARE CREATED IF LRECL HAS BEEN OMITTED.  THIS DEFAULT           30300019
*        CONSISTS OF 4 AND 8 BYTES FOR LRECL AND BLKSIZE, RESP.,        30400019
*        IF THE RECORD FORMAT IS VARIABLE.  IF THE FORMAT IS            30500019
*        FIXED OR UNDEFINED, THE DEFAULT IS ZERO.                       30600019
         SPACE 2                                                        30700019
*        SYSIN DEFAULT ROUTINE                                          30800019
         SPACE 1                                                        30900019
         TM    DUMMYIND,DUMSYSIN       SYSIN DUMMY                      31000019
         BO    TCR121                  BR IF YES                        31100019
         LA    R4,INLRECL              LOAD SYSIN DEFAULT LIST ADDR     31200019
         L     R5,INEXLST              LOAD JFCB ADDRESS                31300019
         LA    R5,0(R5)                                                 31400019
         BAL   RETREG,TCR210           LOAD ADDR DEFAULT RTN            31500019
         SPACE 1                                                        31600019
*        SYSPRINT DEFAULT ROUTINE                                       31700019
         SPACE 1                                                        31800019
TCR121   TM    DUMMYIND,DUMSYSP        SYSPRINT DUMMY                   31900019
         BO    TCR123                  BR IF YES                        32000019
         LA    R4,PRTLRECL             LOAD SYSPRINT DEFAULT LIST ADDR  32100019
         L     R5,PREXLST              LOAD JFCB ADDRESS                32200019
         LA    R5,0(R5)                                                 32300019
         BAL   RETREG,TCR210           LOAD ADDR DEFAULT RTN            32400019
         SPACE 1                                                        32500019
*        SYSUT2 DEFAULT ROUTINE                                         32600019
         SPACE 1                                                        32700019
TCR123   TM    DUMMYIND,DUMSYS2        SYSUT2 DUMMY                     32800019
         BO    TCR125                  BR YES                           32900019
         LA    R4,UT2LRECL             LOAD SYSUT2   DEFAULT LIST ADDR  33000019
         L     R5,UT2EXLST             LOAD JFCB ADDRESS                33100019
         LA    R5,0(R5)                                                 33200019
         BAL   RETREG,TCR210           LOAD ADDR DEFAULT RTN            33300019
         TM    MAXIND,MAXLRECL         MAXLN REQUIRED                   33400019
         BNO   TCR1235                 BR NO                            33500019
         OI    MISCIND,UT2LRLMX        SET UT2 MAXLN INDICATOR          33600019
TCR1235  TM    MAXIND,MAXBLK           MAXLN REQUIRED                   33700019
         BNO   TCR125                  BR NO                            33800019
         OI    MISCIND,UT2BLKMX        SET UT2 MAXLN INDICATOR          33900019
         SPACE 1                                                        34000019
*        SYSUT3 DEFAULT ROUTINE                                         34100019
         SPACE 1                                                        34200019
TCR125   TM    DUMMYIND,DUMSYS3        SYSUT3 DUMMY                     34300019
         BO    TCR130                  BR YES                           34400019
         LA    R4,UT3LRECL             LOAD SYSUT3  DEFAULT LIST ADDR   34500019
         L     R5,UT3EXLST             LOAD JFCB ADDRESS                34600019
         LA    R5,0(R5)                CLEAR HIGH-ORDER BYTE            34700019
         BAL   RETREG,TCR210           LOAD ADDR DEFAULT RTN            34800019
         TM    MAXIND,MAXLRECL         MAXLN REQUIRED                   34900019
         BNO   TCR127                  BR NO                            35000019
         OI    MISCIND,UT3LRLMX        SET UT3 MAXLN INDICATOR          35100019
TCR127   TM    MAXIND,MAXBLK           MAXLN REQUIRED                   35200019
         BNO   TCR130                  BR NO                            35300019
         OI    MISCIND,UT3BLKMX        SET UT3 MAXLN INDICATOR          35400019
         EJECT                                                          35500019
*        THIS ROUTINE STORES THE VOLUME SERIAL NUMBER IF ONE HAS BEEN   35600019
*        PROVIDED                                                       35700019
         SPACE 2                                                        35800019
TCR130   LA    R3,TCRDCB               LOAD ADDRESS SYSUT1 DCB          35900019
         RDJFCB  ((R3))                READ SYSUT1 JFCB                 36000019
         L     R5,JFCBAREA             LOAD GETMAINED STORAGE ADDRESS   36100019
         USING JFCBD,R5                INDICATE JFCB DSECT REG          36200019
         CLI   JFCBNVOL,HEXZERO        TEST VOLUME SERIALS PRESENT      36300019
         BE    TCR132                  BR IF NO VOLUME SERIALS          36400019
         MVC   VOLSER,JFCBVOLS         STORE FIRST VOLUME SERIAL        36500019
         B     TCR199                  BR TO RETURN                     36600019
*                                                                       36700019
TCR132   MVC   VOLSER,DEFVOL           STORE DEFAULT VOLUME SERIAL      36800019
         SPACE 2                                                        36900019
*        THIS ROUTINE FREES THE JFCB WORK AREAS AND RETURNS CONTROL     37000019
*        TO THE DRIVER AFTER RELOADING THE GENERAL REGISTERS            37100019
         SPACE 2                                                        37200019
TCR199   L     R1,JFCBAREA                                              37300019
         FREEMAIN  R,LV=720,A=(1)                                       37400019
         L     SAVEREG,4(SAVEREG)                                       37500019
         RETURN (14,12),T,RC=(15)      RETURN                           37600019
         EJECT                                                          37700019
*        DCB PARAMETER DEFAULT CONSTRUCTION SUBROUTINE                  37800019
         SPACE 1                                                        37900019
*        PARAMETERS PASSED ARE AS FOLLOWS:                              38000019
         SPACE 1                                                        38100019
*              REG 4 - DCB DEFAULT LIST ADDRESS                         38200019
*              REG 5 - JFCB WORK AREA ADDRESS                           38300019
         SPACE 1                                                        38400019
*        THIS ROUTINE FIRST LOOKS AT THE JFCB RECFM PARAMETER TO        38500019
*        DETERMINE WHETHER OR NOT THIS PARAMETER WAS SUPPLIED BY THE    38600019
*        USER. IF IT WAS SUPPLIED, IT REPLACES THE DEFAULT PARAMETER    38700019
*        IN THE DEFAULT TABLE WITH THE JFCB  PARAMETER.  IT THEN TESTS  38800019
*        WHETHER THE RESULTING RECORD FORMAT IS VARIABLE.  IF IT IS,    38900019
*        IT INCREMENTS THE DEFAULT LRECL PARAMETER BY FOUR BYTES AND    39000019
*        THE BLKSIZE PARAMETER BY EIGHT BYTES.  NO MATTER WHAT RECORD   39100019
*        FORMAT HAS BEEN REQUESTED, IT NEXT TESTS WHETHER THE LRECL     39200019
*        PARAMETER WAS PROVIDED.  IF IT WAS, IT REPLACES THE DEFAULT    39300019
*        LRECL AND BLKSIZE PARAMETERS WITH THIS VALUE AND CLEARS THE    39400019
*        MAXLN REQUIRED INDICATORS.  IF VARIABLE-LENGTH  RECORDS WERE   39500019
*        SPECIFIED, IT INCREMENTS THIS BLKSIZE VALUE BY FOUR BYTES.     39600019
*        IT THEN TESTS WHETHER OR NOT THE BLKSIZE PARAMETER WAS         39700019
*        PROVIDED.  IF IT WAS PROVIDED, IT REPLACES THE DEFAULT         39800019
*        VALUE WITH THE JFCB VALUE AND CLEARS THE MAXLN REQUIRED        39900019
*        INDICATOR.   IT NEXT TESTS WHETHER UNDEFINED RECORDS           40000019
*        WERE SPECIFIED. IF THEY WERE, THE ROUTINE ZEROES OUT THE       40100019
*        LRECL FIELD.                                                   40200019
         SPACE 2                                                        40300019
TCR210   ST    RETREG,SAVE100                                           40400019
         USING JFCBD,R5                INDICATE JFCB DSECT REG          40500019
         MVI   MAXIND,MAXLB            SET MAXLN REQUIRED INDICATOR     40600019
         CLI   JFCRECFM,HEXZERO        TEST JFCB RECFM ZERO             40700019
         BE    TCR211                  BR IF YES                        40800019
         MVC   4(1,R4),JFCRECFM        STORE JFCB RECFM IN DEFAULT TABL 40900019
         SPACE 1                                                        41000019
TCR211   TM    4(R4),VARFM             TEST VARIABLE                    41100019
         BO    TCR213                  BR NOT VARIABLE                  41200019
         LH    R6,0(R4)                INCREMENT LRECL BY FOUR          41300019
         LA    R6,4(R6)                                                 41400019
         STH   R6,0(R4)                                                 41500019
         LA    R6,4(R6)                INCREMENT BLOCKSIZE BY EIGHT     41600019
         STH   R6,2(R4)                                                 41700019
         SPACE 1                                                        41800019
TCR213   CLC   JFCLRECL(2),HEXZEROS    TEST LRECL PRESENT               41900019
         BE    TCR215                  BR IF NO                         42000019
         NI    MAXIND,X'FF'-MAXLRECL-MAXBLK CLEAR MAXLN INDICATORS      42100019
         MVC   0(2,R4),JFCLRECL        MOVE LRECL TO DEFAULT LRECL      42200019
         MVC   2(2,R4),JFCLRECL        MOVE LRECL TO DEFAULT BLKSIZE    42300019
         TM    4(R4),VARFM             TEST VARIABLE                    42400019
         BO    TCR215                  BR NOT VARIABLE                  42500019
         LH    R6,2(R4)                INCREMENT BLOCKSIZE BY FOUR      42600019
         AH    R6,FOUR                                                  42700019
         STH   R6,2(R4)                                                 42800019
         SPACE 1                                                        42900019
TCR215   CLC   JFCBLKSI,HEXZEROS       TEST BLKSIZE PRESENT             43000019
         BE    TCR217                  BR IF NO                         43100019
         MVC   2(2,R4),JFCBLKSI        MOVE BLKSIZE TO DEFAULT BLKSIZE  43200019
         NI    MAXIND,X'FF'-MAXBLK     CLEAR MAXLN INDICATOR            43300019
TCR217   TM    4(R4),UNDEF             TEST UNDEF FORMAT                43400019
         BNO   TCR219                  BR IF NO                         43500019
         MVC   0(2,R4),HEXZEROS        MOVE ZEROES TO LRECL             43600019
         SPACE 1                                                        43700019
TCR219   L     RETREG,SAVE100          LOAD RETURN ADDRESS              43800019
         BR    RETREG                  RETURN                           43900019
         EJECT                                                          44000019
*        TIOT DDNAME CHECKING SUBROUTINE                                44100019
         SPACE 2                                                        44200019
*        PARAMETERS PASSED:                                             44300019
         SPACE 1                                                        44400019
*              1) DDNAME - VIA THE STORAGE AREA NAMEHOLD                44500019
*              2) FOUND/NOT FOUND INDICATOR - VIA THE STORAGE AREA      44600019
*                 TIOTDDNM                                              44700019
         SPACE 1                                                        44800019
*        THIS ROUTINE COMPARES THE DDNAME INDICATED TO EACH ENTRY OF    44900019
*        THE TASK INPUT/OUTPUT TABLE                                    45000019
         SPACE 2                                                        45100019
TCR720   ST    RETREG,SAVE100          SAVE RETURN ADDRESS              45200019
         L     TIOTREG,TIOTADR         LOAD TIOT ADDRESS                45300019
         LA    TIOTREG,24(TIOTREG)     ADDR OF FIRST DD ENTRY           45400019
         XR    INCREG,INCREG           ZERO INCR REGISTER               45500019
TCR722   CLC   NAMEHOLD,4(TIOTREG)     COMPARE DDNAMES                  45600019
         BNE   TCR724                  BR UNEQUAL                       45700019
         OI    TIOTDDNM,NAMEFND        SET FOUND INDICATOR              45800019
         B     TCR729                  BR TO RETURN                     45900019
         SPACE 1                                                        46000019
TCR724   IC    INCREG,0(TIOTREG)       INSERT INCREMENT                 46100019
         LA    TIOTREG,0(TIOTREG,INCREG)  ADDR OF NEXT DD ENTRY         46200019
         CLC   ZERO(ETLNG,TIOTREG),ENDTIOT  END OF TIOT?                46300019
         BNE   TCR722                  BR NO                            46400019
         SPACE 1                                                        46500019
TCR729   L     RETREG,SAVE100          LOAD RETURN ADDRESS              46600019
         BR    RETREG                  RETURN                           46700019
  TITLE 'IEBTCR03 - JFCB ANALYZER - LITERALS AND STORAGE AREAS'         46800019
*        LITERALS                                                       46900019
         SPACE 2                                                        47000019
NULL     EQU   *                       NULL LABEL                       47100019
NAMEFND  EQU   X'01'                   DDNAME FOUND IN TIOT             47200019
HEXZERO  EQU   X'00'                   HEXIDECIMAL ZERO                 47300019
ZERO     EQU   0                       ZERO                             47400019
ETLNG    EQU   4                       END TIOT INDICATOR LENGTH        47500019
MSGON    EQU   X'FF'                   MSG REQUIRED                     47600019
UCBDISP  EQU   16                      UCB DISPLACEMENT                 47700019
MAXLRECL EQU   X'01'                   LRECL MAY REQUIRE MAXLN          47800019
MAXBLK   EQU   X'02'                   BLKSIZE MAY REQUIRE MAXLN        47900019
MAXLB    EQU   X'03'                   BOTH MAY REQUIRE MAXLN           48000019
DDON     EQU   X'01'                   ALTERNATE DDNAMES                48100019
         SPACE 1                                                        48200019
JFCBCODE EQU   X'07'                   EXIT LIST JFCB CODE              48300019
JFCBINCR EQU   180                     JFCB STORAGE INCREMENT           48400019
JFCBLN   EQU   720                     TOTAL JFCB WORK AREA LENGTH      48500019
DDLENGTH EQU   8                       DDNAME LENGTH                    48600019
JFCBERR  EQU   X'10'                   ERROR IN READING JFCB            48700019
         SPACE 1                                                        48800019
UT3BLKMX EQU   X'02'                   UT3 BLKSIZE REQUIRES MAXLN       48900019
UT3LRLMX EQU   X'04'                   UT3 LRECL REQUIRES MAXLN         49000019
UT2BLKMX EQU   X'08'                   UT2 BLKSIZE REQUIRES MAXLN       49100019
UT2LRLMX EQU   X'10'                   UT2 LRECL REQUIRES MAXLN         49200019
         SPACE 1                                                        49300019
DUMSYSIN EQU   X'01'                   DUMMY SYSIN                      49400019
DUMSYSP  EQU   X'02'                   DUMMY SYSPRINT                   49500019
DUMSYS2  EQU   X'04'                   DUMMY SYSUT2                     49600019
DUMSYS3  EQU   X'08'                   DUMMY SYSUT3                     49700019
         SPACE 1                                                        49800019
INSUT2   EQU   X'04'                   INSERT SYSUT2                    49900019
INSUT3   EQU   X'05'                   INSERT SYSUT3                    50000019
INSUT23  EQU   X'54'                   INSERT SYSUT2 & 3                50100019
         SPACE 1                                                        50200019
SYSPDISP EQU   8                       SYSPRINT DDNAME DISPLACEMENT     50300019
SYS1DISP EQU   16                      SYSUT1 DDNAME DISPLACEMENT       50400019
SYS2DISP EQU   24                      SYSUT2 DDNAME DISPLACEMENT       50500019
SYS3DISP EQU   32                      SYSUT3 DDNAME DISPLACEMENT       50600019
         SPACE 1                                                        50700019
UNDEF    EQU   X'C0'                   UNDEFINED RECORD FORMAT          50800019
ALLOCERR EQU   X'40'                   STORAGE ALLOCATION ERROR         50900019
DEVLNGTH EQU   3                       DEVICE LENGTH                    51000019
DEVDISP  EQU   13                      DEVICE DISPLACEMENT              51100019
VARFM    EQU   X'80'                   NOT VARIABLE IF ON               51200019
UT1JFCB  EQU   X'87'                   EXIT LIST CODE                   51300019
TIOCNJOB EQU   0                       TIOT JOB NAME FIELD              51400019
TIOCSTP  EQU   8                       TIOT STEP NAME FIELD             51500019
         SPACE 2                                                        51600019
*        RETURN CODES                                                   51700019
         SPACE 1                                                        51800019
CODE04   EQU   X'04'                   RETURN CODE 04                   51900019
CODE12   EQU   X'0C'                   RETURN CODE 12                   52000019
CODE16   EQU   X'10'                   RETURN CODE 16                   52100019
         SPACE 1                                                        52200019
*        CONSTANTS, WORK AREAS, SAVE AREAS, INDICATORS                  52300019
         SPACE 1                                                        52400019
GETMREQ  DS    D                       MINIMUM AND MAXIMUM LENGTH       52500019
GETMADD  DS    D                       STORAGE ADDRESS AND LENGTH       52600019
ENDTIOT  DC    F'0'                    END OF TIOT INDICATOR            52700019
TIOTADR  DS    F                       TIOT ADDRESS                     52800019
NAMEHOLD DS    CL8                     DDNAME HOLD AREA                 52900019
         SPACE 1                                                        53000019
SAVEAREA DS    18F                     REGISTER SAVE AREA               53100019
SAVE100  DS    F                       SAVE AREA                        53200019
         SPACE 1                                                        53300019
         DS    0H                      FORCE HALF-WORD ALIGNMENT        53400019
HEXZEROS DC    X'0000'                 HEX ZEROES                       53500019
FOUR     DC    X'0004'                 BINARY FOUR                      53600019
TIOTDDNM DC    X'00'                   TIOT DDNAME                      53700019
MAXIND   DC    X'00'                   INCREMENT BY MAXLN INDICATOR     53800019
DEFVOL   DC    CL6'TCRINP'             DEFAULT VOLUME IDENTIFICATION    53900019
  TITLE 'IEBTCR03 - JFCB ANALYZER - COMMON COMMUNICATION REGION DSECT'  54000019
*        COMMON COMMUNICATION REGION                                    54100019
         SPACE 1                                                        54200019
*        THIS CSECT CONTAINS TABLES, INDICATORS, CONSTANTS, WORK        54300019
*        AREAS, AND DCB'S THAT ARE USED BY TWO OR MORE MODULES.         54400019
         SPACE 2                                                        54500019
TCRCOM   DSECT                                                          54600019
         SPACE 1                                                        54700019
         DS    0F                      FORCE FULL-WORD ALIGNMENT        54800019
OPTABLE  DS    0CL8                    CONTROL CARD OPTION TABLE        54900019
         SPACE 1                                                        55000019
IEXITS   DC    X'00'                   USER ROUTINE INDICATORS          55100019
         SPACE 1                                                        55200019
*              BIT 0 - OUTHDR2                                          55300019
*                  1 - OUTTLR2                                          55400019
*                  2 - OUTHDR3                                          55500019
*                  3 - OUTTLR3                                          55600019
*                  4 - OUTREC                                           55700019
*                  5 - ERROR                                            55800019
*                  6 - USERTAB                                          55900019
*                  7 - NOT USED                                         56000019
         SPACE 1                                                        56100019
IPARM1   DC    X'00'                   TYPE AND TRANS INDICATORS        56200019
         SPACE 1                                                        56300019
*              BIT 0 - TYPE = MTST                                      56400019
*                  1 - TYPE = MTDI                                      56500019
*                  2 - UNUSED                                           56600019
*                  3 - TRANS = STDUC                                    56700019
*                  4 - TRANS = STDLC                                    56800019
*                  5 - TRANS = USERNAME                                 56900019
*                  6 - TRANS = NOTRAN                                   57000019
*                  7 - NOT USED                                         57100019
         SPACE 1                                                        57200019
IPARM2   DC    X'00'                   EDIT, VERCHK, AND ERROPT         57300019
*                                        INDICATORS                     57400019
         SPACE 1                                                        57500019
*              BIT 0 - EDIT = EDITD                                     57600019
*                  1 - EDIT = EDITR                                     57700019
*                  2 - EDIT = NOEDIT                                    57800019
*                  3 - VERCHK = VOKCHK                                  57900019
*                  4 - VERCHK = NOCHK                                   58000019
*                  5 - ERROPT = NORMAL                                  58100019
*                  6 - ERROPT = NOERR                                   58200019
*                  7 - UNUSED                                           58300019
         SPACE 1                                                        58400019
REPL     DC    X'19'                   REPLACE PARAMETER VALUE          58500019
MINLN    DC    X'0000'                 MINLN PARAMETER VALUE            58600019
MAXLN    DC    X'0000'                 MAXLN PARAMETER VALUE            58700019
         EJECT                                                          58800019
ADDRTAB  DS    0CL28                   USER ROUTINE ADDRESS TABLE       58900019
USERADDR DC    A(0,0,0,0,0,0,0)        TABLE                            59000019
         SPACE 1                                                        59100019
*              WORD 0 - OUTHDR2                                         59200019
*                   1 - OUTTLR2                                         59300019
*                   2 - OUTHDR3                                         59400019
*                   3 - OUTTLR3                                         59500019
*                   4 - OUTREC                                          59600019
*                   5 - ERROR                                           59700019
*                   6 - TRANSLATE TABLE                                 59800019
         SPACE 2                                                        59900019
MSGADDR  DC    A(0)                    MESSAGE MODULE ADDRESS           60000019
         SPACE 2                                                        60100019
*        NAME TABLE                                                     60200019
         SPACE 1                                                        60300019
*        THIS TABLE CONTAINS DDNAMES AND USER EXIT NAMES                60400019
         SPACE 1                                                        60500019
NAMETAB  DC    CL8'SYSIN',CL8'SYSPRINT',CL8'SYSUT1',CL8'SYSUT2'         60600019
         DC    CL8'SYSUT3',CL8'OUTHDR2',CL8'OUTTLR2'                    60700019
         DC    CL8'OUTHDR3',CL8'OUTTLR3',CL8'OUTREC',CL8'ERROR'         60800019
         DC    CL8'TRANS'                                               60900019
         SPACE 1                                                        61000019
*              WORDS 0-1   SYSIN                                        61100019
*                    2-3   SYSPRINT                                     61200019
*                    4-5   SYSUT1                                       61300019
*                    6-7   SYSUT2                                       61400019
*                    8-9   SYSUT3                                       61500019
*                   10-11  OUTHDR2                                      61600019
*                   12-13  OUTTLR2                                      61700019
*                   14-15  OUTHDR3                                      61800019
*                   16-17  OUTTLR3                                      61900019
*                   18-19  OUTREC                                       62000019
*                   20-21  ERROR                                        62100019
*                   22-23  TRANS                                        62200019
         EJECT                                                          62300019
*        MESSAGE POINTER TABLE                                          62400019
         SPACE 2                                                        62500019
*        THIS TABLE CONTAINS ONE FULL-WORD ENTRY FOR EACH IEB-TYPE      62600019
*        MESSAGE (EXCLUDING SYNAD MESSAGES).   MSG01 CORRESPONDS TO     62700019
*        IEB901; MSG02 CORRESPONDS TO IEB902; ETC.                      62800019
         SPACE 1                                                        62900019
*              BYTE  1 - MESSAGE REQUEST CODE                           63000019
*                                                                       63100019
*                        X'FF' = INDICATES REQUEST                      63200019
*                        X'00' = NO REQUEST                             63300019
*                                                                       63400019
*              BYTE  2 - INSERT CODE                                    63500019
*                                                                       63600019
*                        X'00' - NO INSERT                              63700019
*                        X'01' - SYSIN                                  63800019
*                        X'02' - SYSPRINT                               63900019
*                        X'03' - SYSUT1                                 64000019
*                        X'04' - SYSUT2                                 64100019
*                        X'05' - SYSUT3                                 64200019
*                        X'06' - OUTHDR2                                64300019
*                        X'07' - OUTTLR2                                64400019
*                        X'08' - OUTHDR3                                64500019
*                        X'09' - OUTTLR3                                64600019
*                        X'0A' - OUTREC                                 64700019
*                        X'0B' - ERROR                                  64800019
*                        X'0C' - USERTAB                                64900019
*                        X'54' - BOTH SYSUT2 AND SYSUT3                 65000019
*                                                                       65100019
*                    NOTE:  IF X'54' IS SPECIFIED, THE MESSAGE IS       65200019
*                        OUTPUT TWICE, ONCE WITH SYSUT2 AND ONCE        65300019
*                        WITH SYSUT3.                                   65400019
*                                                                       65500019
*              BYTE  3 - INSERT LOCATION  (MESSAGE DISPLACEMENT)        65600019
*                                                                       65700019
*              BYTE  4 - OUTPUT LOCATION                                65800019
*                                                                       65900019
*                        BIT 0 - UNUSED                                 66000019
*                            1 - UNUSED                                 66100019
*                            2 - UNUSED                                 66200019
*                            3 - UNUSED                                 66300019
*                            4 - UNUSED                                 66400019
*                            5 - SYSPRINT IF AVAILABLE, CONSOLE         66500019
*                                OTHERWISE                              66600019
*                            6 - CONSOLE                                66700019
*                            7 - SYSPRINT                               66800019
*                                                                       66900019
*                        NOTE - BITS 6 AND 7 MAY BE ON SIMULTANEOUSLY   67000019
         SPACE 1                                                        67100019
MSGPTRS  EQU   *                       ASSIGN MSGPTRS NAME TO TABLE     67200019
MSG01    DC    X'00000002'                                              67300019
MSG02    DC    X'00000001'                                              67400019
MSG03    DC    X'00000001'                                              67500019
MSG04    DC    X'00000001'                                              67600019
MSG05    DC    X'00000001'                                              67700019
MSG06    DC    X'00000001'                                              67800019
MSG07    DC    X'00000001'                                              67900019
MSG08    DC    X'00000001'                                              68000019
MSG09    DC    X'00000001'                                              68100019
MSG10    DC    X'00030B01'             INSERT LOC = 11                  68200019
MSG11    DC    X'00010B01'             INSERT LOC = 11                  68300019
MSG12    DC    X'00020B02'             INSERT LOC = 11                  68400019
MSG13    DC    X'00000B01'             INSERT LOC = 11                  68500019
MSG14    DC    X'00002501'             INSERT LOC = 37                  68600019
MSG15    DC    X'00000F04'             INSERT LOC = 15                  68700019
MSG16    DC    X'00001504'             INSERT LOC = 21                  68800019
MSG17    DC    X'00002201'             INSERT LOC = 34                  68900019
MSG18    DC    X'00001D01'             INSERT LOC = 29                  69000019
MSG19    DC    X'00000004'                                              69100019
MSG20    DC    X'00000002'                                              69200019
         SPACE 3                                                        69300019
MOUNTID  DS    F                       MOUNT MSG ID                     69400019
IOBADDR  DS    F                       SYSUT1 IOB ADDRESS               69500019
TCRBUFL  DC    X'0000'                 TCR BUFFER LENGTH                69600019
         SPACE 1                                                        69700019
ERRIND   DC    X'00'                   ABNORMAL TERMINATION INDICATORS  69800019
         SPACE 1                                                        69900019
*              BIT 0 - CONFLICTING DCB PARAMETERS                       70000019
*                  1 - STORAGE ALLOCATION ERROR                         70100019
*                  2 - I/O ERROR IN READ AND EDIT                       70200019
*                  3 - ERROR IN JFCB READ OR MOUNT                      70300019
*                  4 - ERROR DURING READ AND EDIT                       70400019
*                  5 - ERROR IN ANALYZING CONTROL CARDS                 70500019
*                  6 - PERMANENT I/O ERROR ON QSAM GET/PUT              70600019
*                  7 - ERROR IN LOADING UTILITY MODULE                  70700019
         SPACE 1                                                        70800019
DUMMYIND DC    X'00'                   DUMMY FILE INDICATORS            70900019
         SPACE 1                                                        71000019
*              BIT 0 - UNUSED                                           71100019
*                  1 - UNUSED                                           71200019
*                  2 - UNUSED                                           71300019
*                  3 - UNUSED                                           71400019
*                  4 - SYSUT3                                           71500019
*                  5 - SYSUT2                                           71600019
*                  6 - SYSPRINT                                         71700019
*                  7 - SYSIN                                            71800019
         EJECT                                                          71900019
*        DATA CONTROL BLOCK (DCB) EXIT LISTS                            72000019
         SPACE 2                                                        72100019
*        SYSIN EXIT LIST                                                72200019
         SPACE 1                                                        72300019
         DS    0F                      FORCE FULL-WORD ALIGNMENT        72400019
INEXLST  DC    X'07'                   JFCB EXIT                        72500019
         DC    AL3(0)                  WORK AREA ADDRESS                72600019
         DC    X'85'                   DCB EXIT                         72700019
         DC    AL3(0)                  DCB EXIT ROUTINE                 72800019
         DC    X'00'                   DUMMY ENTRY                      72900019
         DC    AL3(INLRECL)            DEFAULT TABLE ADDRESS            73000019
         SPACE 2                                                        73100019
*        SYSPRINT EXIT LIST                                             73200019
         SPACE 1                                                        73300019
PREXLST  DC    X'07'                   JFCB EXIT                        73400019
         DC    AL3(0)                  WORK AREA ADDRESS                73500019
         DC    X'05'                   DCB EXIT                         73600019
         DC    AL3(0)                  DCB EXIT ROUTINE                 73700019
         DC    X'00'                   DUMMY ENTRY                      73800019
         DC    AL3(PRTLRECL)           DEFAULT TABLE ADDRESS            73900019
         DC    X'00'                   OUTPUT HEADER LABEL (NULL)       74000019
         DC    AL3(0)                  NULL ADDRESS                     74100019
         DC    X'80'                   OUTPUT TRAILER LABEL (NULL)      74200019
         DC    AL3(0)                  NULL ADDRESS                     74300019
         SPACE 2                                                        74400019
*        SYSUT1 EXIT LIST                                               74500019
         SPACE 1                                                        74600019
UT1EXLST DC    X'87'                   JFCB EXIT                        74700019
         DC    AL3(0)                  JFCB EXIT ADDRESS                74800019
         SPACE 2                                                        74900019
*        SYSUT2 EXIT LIST                                               75000019
         SPACE 1                                                        75100019
         DS    0F                                                       75200019
UT2EXLST DC    X'07'                   JFCB EXIT                        75300019
         DC    AL3(0)                  WORK AREA ADDRESS                75400019
         DC    X'05'                   DCB EXIT                         75500019
         DC    AL3(0)                  DCB EXIT ROUTINE                 75600019
         DC    X'00'                   DUMMY ENTRY                      75700019
         DC    AL3(UT2LRECL)           DEFAULT TABLE ADDRESS            75800019
         DC    X'00'                   OUTPUT HEADER LABEL              75900019
         DC    AL3(0)                  NULL ADDRESS                     76000019
         DC    X'80'                   OUTPUT TRAILER LABEL             76100019
         DC    AL3(0)                  NULL ADDRESS                     76200019
         SPACE 2                                                        76300019
*        SYSUT3 EXIT LIST                                               76400019
         SPACE 1                                                        76500019
UT3EXLST DC    X'07'                   JFCB EXIT                        76600019
         DC    AL3(0)                  WORK AREA ADDRESS                76700019
         DC    X'05'                   DCB EXIT                         76800019
         DC    AL3(0)                  DCB EXIT ROUTINE                 76900019
         DC    X'00'                   DUMMY ENTRY                      77000019
         DC    AL3(UT3LRECL)           DEFAULT TABLE ADDRESS            77100019
         DC    X'00'                   OUTPUT HEADER LABEL              77200019
         DC    AL3(0)                  NULL ADDRESS                     77300019
         DC    X'80'                   OUTPUT TRAILER LABEL             77400019
         DC    AL3(0)                  NULL ADDRESS                     77500019
         SPACE 2                                                        77600019
*        DCB PARAMETER DEFAULTS                                         77700019
         SPACE 1                                                        77800019
INLRECL  DC    X'0050'                 SYSIN LRECL  - 80                77900019
INBLK    DC    X'0050'                 SYSIN BLKSIZE - 80               78000019
INRECFM  DC    X'90'                   SYSIN - FIXED BLOCKED            78100019
INIDENT  DC    X'01'                   INTERNAL IDENTIFICATION CODE     78200019
         SPACE 1                                                        78300019
PRTLRECL DC    X'0079'                 SYSPRINT LRECL -  121            78400019
PRTBLK   DC    X'0079'                 SYSPRINT BLKSIZE - 121           78500019
PRTRECFM DC    X'94'                   SYSPRINT - FIXED BLOCKED ASA     78600019
PRTIDENT DC    X'02'                   INTERNAL IDENTIFICATION CODE     78700019
         SPACE 1                                                        78800019
UT2LRECL DC    X'0000'                 SYSUT2 LRECL                     78900019
UT2BLK   DC    X'0000'                 SYSUT2 BLKSIZE                   79000019
UT2RECFM DC    X'50'                   SYSUT2 RECFM - VARIABLE BLOCKED  79100019
UT2IDENT DC    X'04'                   INTERNAL IDENTIFICATION CODE     79200019
         SPACE 1                                                        79300019
UT3LRECL DC    X'0000'                 SYSUT3 LRECL                     79400019
UT3BLK   DC    X'0000'                 SYSUT3 BLKSIZE                   79500019
UT3RECFM DC    X'50'                   SYSUT3 RECFM - VARIABLE BLOCKED  79600019
UT3IDENT DC    X'05'                   INTERNAL IDENTIFICATION CODE     79700019
         EJECT                                                          79800019
*        DATA CONTROL BLOCKS (DCB'S)                                    79900019
         SPACE 3                                                        80000019
*        SYSUT1 (TCR) DCB                                               80100019
         SPACE 2                                                        80200019
TCRDCB   DCB   DSORG=PS,MACRF=(E),DDNAME=SYSUT1,DEVD=TA,RECFM=UA,      X80300019
               BFTEK=S,EXLST=UT1EXLST,IOBAD=NULL                        80400019
         EJECT                                                          80500019
*        SYSUT2 DCB                                                     80600019
         SPACE 2                                                        80700019
UT2DCB   DCB   DSORG=PS,DDNAME=SYSUT2,DEVD=DA,EXLST=UT2EXLST,          X80800019
               SYNAD=NULL,EROPT=ABE,MACRF=(PM)                          80900019
         SPACE 3                                                        81000019
*        SYSUT3 DCB                                                     81100019
         SPACE 2                                                        81200019
UT3DCB   DCB   DSORG=PS,DDNAME=SYSUT3,DEVD=DA,EXLST=UT3EXLST,          X81300019
               SYNAD=NULL,EROPT=ABE,MACRF=(PM)                          81400019
         SPACE 3                                                        81500019
*        SYSIN DCB                                                      81600019
         SPACE 2                                                        81700019
SYSINDCB DCB   DSORG=PS,DDNAME=SYSIN,DEVD=DA,EODAD=NULL,MACRF=(GM),    X81800019
               EXLST=INEXLST,EROPT=ACC,SYNAD=NULL                       81900019
         SPACE 3                                                        82000019
*        SYSPRINT DCB                                                   82100019
         SPACE 2                                                        82200019
SYSPRDCB DCB   DSORG=PS,DDNAME=SYSPRINT,DEVD=DA,EXLST=PREXLST,         X82300019
               MACRF=(PM)                                               82400019
         EJECT                                                          82500019
*        GETMAINED STORAGE ADDRESSES                                    82600019
         SPACE 2                                                        82700019
CARDAREA DS    F                       CARD INPUT AREA                  82800019
JFCBAREA DS    F                       JFCB AREA ADDRESS                82900019
PRTAREA  DS    F                       SYSPRINT OUTPUT AREA             83000019
PRTLNGTH DS    F                       PRINT AREA LENGTH                83100019
COLUMN9  DS    F                       CARD INPUT COLUMN 9 ADDRESS      83200019
CARDEND  DS    F                       INPUT AREA ENDING ADDRESS        83300019
         SPACE 2                                                        83400019
USERNAME DC    7XL8'00'                USER ROUTINE NAME TABLE          83500019
           SPACE 1                                                      83600019
*              WORDS 0 & 1  - OUTHDR2 ROUTINE                           83700019
*                    2 & 3  - OUTTLR2 ROUTINE                           83800019
*                    4 & 5  - OUTHDR3 ROUTINE                           83900019
*                    6 & 7  - OUTTLR3 ROUTINE                           84000019
*                    8 & 9  - OUTREC  ROUTINE                           84100019
*                   10 & 11 - ERROR ROUTINE                             84200019
*                   12 & 13 - TRANSLATE TABLE                           84300019
           SPACE 2                                                      84400019
MISCIND  DC    X'00'                   MISCELLANEOUS INDICATORS         84500019
         SPACE 1                                                        84600019
*              BIT 0 - UNUSED                                           84700019
*                  1 - UNUSED                                           84800019
*                  2 - UNUSED                                           84900019
*                  3 - SYSUT2 LRECL REQUIRES MAXLN INCREMENT            85000019
*                  4 - SYSUT2 BLKSIZE REQUIRES MAXLN INCREMENT          85100019
*                  5 - SYSUT3 LRECL REQUIRES MAXLN INCREMENT            85200019
*                  6 - SYSUT3 BLKSIZE REQUIRES MAXLN INCREMENT          85300019
*                  7 - ALTERNATE DDNAMES FOUND                          85400019
             SPACE 2                                                    85500019
         SPACE 1                                                        85600019
RETCODE  DC    X'00'                   RETURN CODE                      85700019
TCRDEV   DC    CL3'000'                TCR DEVICE                       85800019
VOLSER   DC    CL6' '                  VOLUME SERIAL NUMBER             85900019
PRTRTN   DC    X'00'                   MESSAGE WRITER OPTION IND        86000019
CARRCTRL DC    X'40'                   CARRIAGE CONTROL                 86100019
         SPACE 1                                                        86200019
VTCR220  DS    F                       MESSAGE DISPLAY                  86300019
CURMSGAD DS    F                       CURRENT SYSPRINT MSG ADDRESS     86400019
MSGAD    DS    F                       SINGLE MESSAGE ADDRESS           86500019
MSGLN    DS    F                       SINGLE MSG LENGTH                86600019
JOBNAME  DC    CL8' '                  JOB NAME                         86700019
STEPNAME DC    CL8' '                  STEPNAME                         86800019
         EJECT                                                          86900019
         DCBD  DSORG=PS                                                 87000019
         EJECT                                                          87100019
JFCBD    DSECT                                                          87200019
         SPACE 1                                                        87300019
         IEFJFCBN                                                       87400019
*                                                                       87500019
         END   IEBTCR03                                                 87600019
./  ADD  SSI=21040021,NAME=IEBTCR04
  TITLE 'IEBTCR04 - CONTROL CARD ANALYZER - INTRODUCTORY COMMENTARY'  * 00050019
*                                                                     * 00100019
*TITLE 'IEBTCR04' - CONTROL CARD ANALYZER                             * 00150019
*                                                                     * 00200019
*STATUS:  CHANGE LEVEL 000                                            * 00250019
*                                                                     * 00300019
*FUNCTION/OPERATION:  THE CONTROL CARD ANALYZER PERFORMS THE          * 00350019
*   FOLLOWING FUNCTIONS:                                              * 00400019
*                                                                     * 00450019
*   1)  READS UTILITY CONTROL STATEMENTS INPUT VIA THE SYSIN          * 00500019
*       DATA SET                                                      * 00550019
*                                                                     * 00600019
*   2)  SCANS THE CONTROL CARDS FOR FORMAT ERRORS                     * 00650019
*                                                                     * 00700019
*   3)  VALIDATES THE NAME, OPERATION, AND OPERAND FIELDS OF EACH     * 00750019
*       STATEMENT                                                     * 00800019
*                                                                     * 00850019
*   4)  SETS OPTIONS (INCLUDING DEFAULTS FOR MISSING PARAMETERS)      * 00900019
*                                                                     * 00950019
*   5)  TESTS THE CONSISTENCY OF THE OPTIONS THAT IT HAS JUST SET     * 01000019
*                                                                     * 01050019
*   THE CONTROL CARD ANALYZER PROCESSES EACH CONTROL STATEMENT ONE    * 01100019
*   CHARACTER AT A TIME.  IT ASSEMBLES EACH OPERATOR, KEYWORD, OR     * 01150019
*   PARAMETER IN AN 8-POSITION HOLD AREA.  WHEN A COMPLETE WORD HAS   * 01200019
*   BEEN ASSEMBLED, THE ANALYZER PERFORMS ONE OF THE FOLLOWING SETS   * 01250019
*   OF OPERATIONS, DEPENDING UPON THE CLASS IN WHICH THE WORD FALLS:  * 01300019
*                                                                     * 01350019
*   NAME FIELD - CHECKS THAT THE FIRST CHARACTER IS ALPHABETIC        * 01400019
*                                                                     * 01450019
*   OPERATOR - COMPARES THE WORD TO THE IDENTIFIER ATTACHED TO EACH   * 01500019
*        OPERATOR TABLE (TCRGEN OR EXITS). IF A MATCH IS FOUND,       * 01550019
*        POINTERS ARE SET TO EACH OF THE TABLES CORRESPONDING TO THIS * 01600019
*        OPERATOR. (SEE TABLES/WORK AREAS.)                           * 01650019
*                                                                     * 01700019
*   KEYWORD - COMPARES THE WORD TO EACH KEYWORD ENTRY OF THE SELECTED * 01750019
*        OPERATOR TABLE.  IF A MATCH IS FOUND, POINTERS ARE SET TO THE* 01800019
*        LIST OF PARAMETERS CORRESPONDING TO THIS KEYWORD.            * 01850019
*                                                                     * 01900019
*   PARAMETER - COMPARES THE WORD TO EACH ENTRY OF THE PARAMETER LIST * 01950019
*        ASSOCIATED WITH THE PREVIOUSLY IDENTIFIED OPERATOR AND KEY-  * 02000019
*        WORD.  IF A MATCH IS FOUND, THE CORRESPONDING DATA TABLE     * 02050019
*        ENTRIES ARE USED TO SET THE PROPER OPTION BYTES. (SEE        * 02100019
*        TABLES/WORK AREAS.)                                          * 02150019
*                                                                     * 02200019
*   WHEN ALL STATEMENTS HAVE BEEN PROCESSED, THE ANALYZER SETS        * 02250019
*   DEFAULTS FOR THOSE OPTIONS WHICH WERE NOT SPECIFIED AND TESTS     * 02300019
*   THE CONSISTENCY OF ALL APPLICABLE OPTIONS.  IF ANY CONFLICTING    * 02350019
*   OPTIONS ARE DETECTED, THE ANALYZER SETS THE RETURN CODE TO 12     * 02400019
*   AND REQUESTS TERMINATION.                                         * 02450019
*                                                                     * 02500019
         EJECT                                                        * 02550019
*ENTRY POINTS:                                                        * 02600019
*                                                                     * 02650019
*        IEBTCR04 - ANALYZE CONTROL CARDS AND SET OPTION INDICATORS   * 02700019
*                                                                     * 02750019
*   THIS MODULE IS LINKED  TO BY THE DRIVER MODULE (IEBTCRIN):        * 02800019
*                                                                     * 02850019
*        LINK EP=IEBTCR04,PARAM=TCRCOM                                * 02900019
*                                                                     * 02950019
*   PARAMETER DATA IS PASSED BY NAME VIA THE COMMON COMMUNICATION     * 03000019
*   REGION AND CONSISTS OF CONTROL CARD OPTION TABLES, A MESSAGE      * 03050019
*   REQUEST TABLE, DATA CONTROL BLOCKS, ADDRESS CONSTANTS, DATA       * 03100019
*   CONSTANTS, AND INDICATORS.                                        * 03150019
*                                                                     * 03200019
*INPUT:  SYSIN DATA SET.  THIS DATA SET IS OPENED AND CLOSED BY THE   * 03250019
*   DRIVER MODULE (IEBTCRIN).  INPUT IS PERFORMED BY THE CONTROL CARD * 03300019
*   ANALYZER THROUGH USE OF THE QSAM ACCESS METHOD.                   * 03350019
*                                                                     * 03400019
*OUTPUT:                                                              * 03450019
*                                                                     * 03500019
*   1)  UPDATED CONTROL CARD OPTION TABLES (WHICH ARE CONTAINED       * 03550019
*       IN THE COMMON COMMUNICATION REGION).                          * 03600019
*                                                                     * 03650019
*   2)  UPDATED MESSAGE REQUEST TABLE (CONTAINED IN THE COMMON        * 03700019
*       COMMUNICATION REGION).                                        * 03750019
*                                                                     * 03800019
*EXTERNAL ROUTINES:                                                   * 03850019
*                                                                     * 03900019
*        TCR220 - MESSAGE WRITER                                      * 03950019
*                                                                     * 04000019
*   THIS ROUTINE IS A SEPARATE  CSECT WITHIN THE DRIVER MODULE        * 04050019
*   (IEBTCRIN).  IT PERFORMS TWO FUNCTIONS:                           * 04100019
*                                                                     * 04150019
*   1)  OUTPUTTING OF CONTROL STATEMENT IMAGES TO THE SYSPRINT DATA   * 04200019
*       SET (IF PROVIDED)                                             * 04250019
*                                                                     * 04300019
*   2)  OUTPUTTING OF IEBXXXX MESSAGES TO THE SYSPRINT DATA SET       * 04350019
*       AND/OR THE SYSTEM CONSOLE                                     * 04400019
*                                                                     * 04450019
*   OPTION 1 IS REQUESTED BY SETTING BIT 6 OF THE COMMUNICATION       * 04500019
*   REGION INDICATOR PRTRTN TO ONE AND PASSING THE CONTROL STATEMENT  * 04550019
*   ADDRESS AND LENGTH VIA THE COMMUNICATION REGION COMPONENTS MSGAD  * 04600019
*   AND MSGLN.                                                        * 04650019
*                                                                     * 04700019
*   OPTION 2 IS REQUESTED BY SETTING PRTRTN BIT 6 TO ZERO.  THE       * 04750019
*   COMMUNICATION REGION MESSAGE POINTER TABLE MUST INDICATE THE      * 04800019
*   MESSAGES REQUIRED.                                                * 04850019
*                                                                     * 04900019
*   EXITS-NORMAL:  NONE                                               * 04950019
*        -ERROR:   NONE                                               * 05000019
*                                                                     * 05050019
        EJECT                                                         * 05100019
*TABLES/WORK AREAS:                                                   * 05150019
*                                                                     * 05200019
*   1)  TCRGEN TABLE (TCRGENOP)                                       * 05250019
*                                                                     * 05300019
*   *********************                                             * 05350019
*   *TCRGEN  *  *  *    *                                             * 05400019
*   *********************                                             * 05450019
*      |         |    |                                               * 05500019
*   OPERATOR     |   DATA TABLE END ADDRESS                           * 05550019
*                |                                                    * 05600019
*          NAME TABLE ENTRY LENGTH                                    * 05650019
*                                                                     * 05700019
*                                                                     * 05750019
*    KEYWORD  DEFAULT    ALTERNATIVES                                 * 05800019
*   *************************************                             * 05850019
*   *TYPE    *MTDI    *MTST    *        *          NAME TABLE         * 05900019
*   *************************************          **********         * 05950019
*   *TRANS   *STDUC   *STDLC   *NOTRAN  *                             * 06000019
*   *************************************                             * 06050019
*   *EDIT    *EDITD   *EDITR   *NOEDIT  *                             * 06100019
*   *************************************                             * 06150019
*   *VERCHK  *NOCHK   *VOKCHK  *        *                             * 06200019
*   *************************************                             * 06250019
*   *ERROPT  *NORMAL  *NOERR   *        *                             * 06300019
*   *************************************                             * 06350019
*   *MINLN   *        *        *        *                             * 06400019
*   *************************************                             * 06450019
*   *MAXLN   *        *        *        *                             * 06500019
*   *************************************                             * 06550019
*   *REPLACE *X'19'   *        *        *                             * 06600019
*   *************************************                             * 06650019
*       |        |        |        |                                  * 06700019
*       |        |        |        |                                  * 06750019
*   *************************************                             * 06800019
*   *00* 0* 0*  0140  *  0180  *  0000  *         DATA TABLE          * 06850019
*   *************************************         **********          * 06900019
*   *04* 0* 0*  0110  *  0108  *  0102  *                             * 06950019
*   *************************************                             * 07000019
*   *00* 0* 0*  0280  *  0240  *  0220  *                             * 07050019
*   *************************************                             * 07100019
*   *00* 0* 0*  0208  *  0210  *  0000  *                             * 07150019
*   *************************************                             * 07200019
*   *00* 0* 0*  0204  *  0202  *  0000  *                             * 07250019
*   *************************************                             * 07300019
*   *08* 0* 0*  0400  *  0000  *  0000  *                             * 07350019
*   *************************************                             * 07400019
*   *08* 0* 0*  0600  *  0000  *  0000  *                             * 07450019
*   *************************************                             * 07500019
*   *0C* 0* 0*  0300  *  0000  *  0000  *                             * 07550019
*   *************************************                             * 07600019
*    |      |        |-----|-------|                                  * 07650019
*   BRANCH  KEYWORD           OPTION TABLE BYTE                       * 07700019
*   TABLE   PROCESSED              AND                                * 07750019
*   DISP-   INDICATOR         'ON' MASK                               * 07800019
*   PLACEMENT                                                         * 07850019
*                                                                     * 07900019
*   2)  EXITS TABLE (EXITSOP)                                         * 07950019
*                                                                     * 08000019
*                                                                     * 08050019
*   *********************                                             * 08100019
*   *EXITS   *  *  *    *                                             * 08150019
*   *********************                                             * 08200019
*      |         |   |                                                * 08250019
*    OPERATOR    |   NAME TABLE END ADDRESS                           * 08300019
*                |                                                    * 08350019
*           NAME TABLE ENTRY LENGTH                                   * 08400019
*                                                                     * 08450019
*                                                                     * 08500019
*                                                                     * 08550019
*    NAME TABLE                   DATA TABLE                          * 08600019
*                                                                     * 08650019
*    **********               *******************                     * 08700019
*    *OUTHDR2 *  - - - - - -  *04*00*00*80*00*00*                     * 08750019
*    **********               *******************                     * 08800019
*    *OUTTLR2 *  - - - - - -  *04*00*00*40*00*08*                     * 08850019
*    **********               *******************                     * 08900019
*    *OUTHDR3 *  - - - - - -  *04*00*00*20*00*10*                     * 08950019
*    **********               *******************                     * 09000019
*    *OUTTLR3 *  - - - - - -  *04*00*00*10*00*18*                     * 09050019
*    **********               *******************                     * 09100019
*    *OUTREC  *  - - - - - -  *04*00*00*08*00*20*                     * 09150019
*    **********               *******************                     * 09200019
*    *ERROR   *  - - - - - -  *04*00*00*04*00*28*                     * 09250019
*    **********               *******************                     * 09300019
*        |                     |  |  |   | -----                      * 09350019
*     KEYWORD             BRANCH  |OPTION|    |                       * 09400019
*                         TABLE   |TABLE |   NAME                     * 09450019
*                         DISP    | DISP |  TABLE                     * 09500019
*                                 |      |     DISP                   * 09550019
*                           KEYWORD      ON                           * 09600019
*                         PROCESSED     MASK                          * 09650019
*                         INDICATOR                                   * 09700019
*                                                                     * 09750019
*   EACH OPERATOR TABLE IS CONSTRUCTED IN SUCH A WAY THAT A COMMON    * 09800019
*   ROUTINE CAN BE USED TO PROCESS BOTH OF THE TABLES.                * 09850019
*                                                                     * 09900019
*   EACH TABLE CONTAINS THREE SECTIONS:                               * 09950019
*                                                                     * 10000019
*   A)  A 16-BYTE TABLE CONTAINING THE OPERATOR NAME, NAME TABLE      * 10050019
*       ENTRY LENGTH, AND NAME TABLE ENDING ADDRESS                   * 10100019
*                                                                     * 10150019
*   B)  A NAME TABLE CONTAINING ALL POSSIBLE KEYWORDS AND THEIR       * 10200019
*       RELATED PARAMETERS. (IF THE PARAMETERS ARE SPECIAL VALUES     * 10250019
*       WHICH MUST BE INTERPRETED BY A SEPARATE ROUTINE, SUCH AS      * 10300019
*       THE MINLN VALUE, THEY ARE NOT CONTAINED IN THE TABLE.)        * 10350019
*                                                                     * 10400019
*   C)  A DATA TABLE CONTAINING BRANCH TABLE DISPLACEMENTS FOR        * 10450019
*       LOCATING SPECIAL PROCESSING ROUTINES AND OPTION TABLE DIS-    * 10500019
*       PLACEMENTS AND 'ON' MASKS FOR SETTING OPTIONS.                * 10550019
*                                                                     * 10600019
*   THERE IS A ONE-TO-ONE CORRESPONDENCE BETWEEN THE NAME TABLE         10650019
*   AND DATA TABLE ENTRIES.                                             10700019
*                                                                       10750019
*                                                                     * 10800019
*   3)  COMMUNICATION REGION OPTION TABLE                             * 10850019
*                                                                     * 10900019
*                                                                     * 10950019
*                                                                     * 11000019
*   **********************************************************        * 11050019
*   * BYTES  *     BYTE 0    *    BYTE 1     *     BYTE 2    *        * 11100019
*   **********************************************************        * 11150019
*   *        *               *     *         *     *VER*ERR* *        * 11200019
*   *        *     EXITS     *TYPE *  TRANS  *EDIT *CHK*OPT* *        * 11250019
*   *        *************************************************        * 11300019
*   *        *O|O|O|O|O|E|U| *M|M| *S|S|U|N| *E|E|N*V|N*N|N* *        * 11350019
*   *        *U|U|U|U|U|R|S| *T|T| *T|T|S|O| *D|D|O*O|O*O|O* *        * 11400019
*   *        *T|T|T|T|T|R|E| *S|D| *D|D|E|T| *I|I|E*K|C*R|E* *        * 11450019
*   *        *H|T|H|T|R|O|R| *T|I| *U|L|R|R| *T|T|D*C|H*M|R* *        * 11500019
*   *        *D|L|D|L|E|R|T| * | | *C|C|N|A| *D|R|I*H|K*A|R* *        * 11550019
*   *        *R|R|R|R|C| |A| * | | * | |A|N| * | |T*K| *L| * *        * 11600019
*   *        *2|2|3|3| | |B| * | | * | |M| | * | | * | * | * *        * 11650019
*   *        * | | | | | | | * | | * | |E| | * | | * | * | * *        * 11700019
*   **********************************************************        * 11750019
*   *DEFAULT *0|0|0|0|0|0|0| *0|1| *0|0|0|0| *1|0|0*0|1*1|0* *        * 11800019
*   **********************************************************        * 11850019
*                                                                     * 11900019
*                                                                     * 11950019
*                                                                     * 12000019
*   *********************************                                 * 12050019
*   *    BYTE 3     *  4-5  *  6-7  *                                 * 12100019
*   *********************************                                 * 12150019
*   *               *  MIN  *  MAX  *                                 * 12200019
*   *    REPLACE    *  LN   *  LN   *                                 * 12250019
*   *********************************                                 * 12300019
*   *               *       *       *                                 * 12350019
*   *               *       *       *                                 * 12400019
*   *               *       *       *                                 * 12450019
*   *               *       *       *                                 * 12500019
*   *********************************                                 * 12550019
*   *0*0*0*1*1*0*0*1* 0 * 0 *X'0078'*                                 * 12600019
*   *********************************                                 * 12650019
*                                                                     * 12700019
*                                                                     * 12750019
*                                                                     * 12800019
*   4)  OPERATOR, KEYWORD, PARAMETER HOLD AREA (HOLDAREA)             * 12850019
*                                                                     * 12900019
*   THIS WORK AREA IS USED TO ASSEMBLE EACH OPERATOR, KEYWORD,        * 12950019
*   AND PARAMETER PRESENTED IN THE INPUT STREAM.                      * 13000019
*                                                                     * 13050019
*   5)  INVALID TRANSLATE REPLACE PARAMETER CHARACTERS (TRANRPTB)     * 13100019
*                                                                     * 13150019
*   6)  INVALID EDIT REPLACE PARAMETER CHARACTERS (EDITRPTB)          * 13200019
*                                                                     * 13250019
*ATTRIBUTES:  NOT RE-ENTRANT.  NOT RE-USABLE.                         * 13300019
*                                                                     * 13350019
*NOTES:  THIS MODULE USES VARIOUS COMPONENTS OF THE COMMON COMMUNICA- * 13400019
*   TION REGION CONTAINED IN THE DRIVER MODULE (IEBTCRIN).            * 13450019
*                                                                     * 13500019
*   THIS MODULE CONTAINS TYPE C CHARACTER CODE DEPENDENCIES.  THE     * 13550019
*   OPERATION OF THIS MODULE DEPENDS UPON AN INTERNAL REPRESENTATION  * 13600019
*   OF THE EXTERNAL CHARACTER SET WHICH IS EQUIVALENT TO THE ONE USED * 13650019
*   AT ASSEMBLY TIME.  THE CODING HAS BEEN ARRANGED SO THAT REDEFINI- * 13700019
*   TION OF CHARACTER CONSTANTS, BY RE-ASSEMBLY, WILL RESULT IN A     * 13750019
*   CORRECT MODULE FOR THE NEW DEFINITIONS.  CHARACTER CONSTANTS      * 13800019
*   INVOLVED ARE AS FOLLOWS:                                          * 13850019
*                                                                     * 13900019
*   1)  DELIMITERS COMMA, SPACE, EQUALSN, PARENL, AND PARENR USED BY  * 13950019
*       THE OPERAND VALIDATION ROUTINE TCR260                         * 14000019
*                                                                     * 14050019
*   2)  REPLACE PARAMETER CHARACTER X (ALPHAX)                        * 14100019
*                                                                     * 14150019
*   3)  OPERATOR, KEYWORD, AND PARAMETER TABLES TCRGENOP,             * 14200019
*       TCRGENTB, TCRDATA, EXITSOP, EXITSTB, AND EXITDATA             * 14250019
*                                                                     * 14300019
*   THIS MODULE ALSO CONTAINS TYPE E CHARACTER CODE DEPENDENCIES.     * 14350019
*   THE OPERATION OF THIS MODULE DEPENDS UPON THE FOLLOWING PROPER-   * 14400019
*   TIES OF THE INTERNAL REPRESENTATION OF THE EXTERNAL CHARACTER     * 14450019
*   SET:  PARTICULAR BIT PATTERN REPRESENTATION OF EBCDIC CHARACTERS  * 14500019
*   AND A PARTICULAR COLLATING SEQUENCE OF THE INTERNAL REPRESENTATION* 14550019
*   OF THE CHARACTER SET.  THE SPECIFIC INSTRUCTION SEQUENCES, TABLES,* 14600019
*   AND CONSTANTS WHICH REQUIRE MODIFICATION IF THESE PROPERTIES OF   * 14650019
*   THE CHARACTER SET ARE CHANGED MAY BE IDENTIFIED BY:               * 14700019
*                                                                     * 14750019
*   1)  TCR520-TCR528 (MINLN-MAXLN VALIDATION ROUTINE) ASSUMES THAT   * 14800019
*       THE NUMERIC DIGITS 0-9 ARE IN ASCENDING COLLATING SEQUENCE    * 14850019
*       AND HAVE NO INTERSPERSED CONTROL CHARACTERS.                  * 14900019
*                                                                     * 14950019
*   2)  TCR240-TCR249 (NAME VALIDATION ROUTINE) ASSUMES THAT THE ALPHA- 15000019
*       BETIC CHARACTERS A-Z ARE IN ASCENDING COLLATING SEQUENCE AND  * 15050019
*       HAVE NO INTERSPERSED CONTROL CHARACTERS.                      * 15100019
*                                                                     * 15150019
*  3)  TCR530-TCR542 (REPLACE PARAMETER VALIDATION AND CONVERSION)    * 15200019
*      ASSUMES                                                        * 15250019
*                                                                     * 15300019
*      A)  THAT THE EBCDIC CHARACTERS A-F AND 0-9 ARE REPRESENTED     * 15350019
*          INTERNALLY BY X'C1' - X'CF' AND X'F0' - X'F9', RESPECT-    * 15400019
*          IVELY.  THIS PARAMETER IS USED TO SPECIFY THE HEXADECIMAL  * 15450019
*          REPRESENTATION OF THE CHARACTERS TO BE USED FOR REPLACING  * 15500019
*          DATA CHECK BYTES.  FOR EXAMPLE, THE EBCDIC INPUT CHARACTERS* 15550019
*          'D9', REPRESENTED INTERNALLY AS THE TWO BYTES              * 15600019
*          '11000100''11111001', WOULD BE CONVERTED TO THE ONE BYTE   * 15650019
*          '11011001'.                                                * 15700019
*                                                                     * 15750019
*      B)  THAT THE CHARACTERS A-Z AND 0-9 ARE IN ASCENDING COLLATING * 15800019
*          SEQUENCE AND HAVE NO CONTROL CHARACTERS INTERSPERSED AMONG * 15850019
*          EITHER GROUP.                                              * 15900019
*                                                                     * 15950019
*   4)  TCR290 (INVALID REPLACE PARAMETER VALIDATION) ASSUMES THAT THE* 16000019
*       PL CODES ARE REPRESENTED BY '01' TO '08' AND ARE IN ASCENDING * 16050019
*       COLLATING SEQUENCE.  IT ALSO ASSUMES THAT HEXADECIMAL CODES   * 16100019
*       '80' TO 'FF' ARE INVALID WITH TRANSLATION AND ARE IN          * 16150019
*       ASCENDING COLLATING SEQUENCE.                                 * 16200019
*                                                                     * 16250019
*   COMMENTS ARE PROVIDED TO INDICATE THE CONSIDERATIONS INVOLVED AND * 16300019
*   THE MECHANISM FOR CHANGING THE CODE.                              * 16350019
*                                                                     * 16400019
*                                                                     * 16450019
*   TO MEET WORLD TRADE REQUIREMENTS, ALL STANDARD OPERATORS, KEY-    * 16500019
*   WORDS, AND PARAMETER NAMES HAVE BEEN PLACED IN THE TABLES         * 16550019
*   TCRGENOP, TCRGENTB, TCRDATA, EXITSOP, EXITSTB, AND EXITDATA.      * 16600019
*   THESE TABLES MAY BE REPLACED IN ENTIRETY.                         * 16650019
*                                                                     * 16700019
*   IF THE MEANS OF SPECIFYING THE MINLN, MAXLN, OR REPLACE PARA-     * 16750019
*   METER VALUES IS CHANGED, MODIFICATIONS TO THE VALIDATION ROUTINES * 16800019
*   TCR290, TCR520, AND TCR530 MAY BE REQUIRED.                       * 16850019
  TITLE 'IEBTCR04 - CONTROL CARD ANALYZER - REGISTER DEFINITIONS'       16900019
IEBTCR04 START 0                                                        16950019
         SPACE 2                                                        17000019
*              REGISTER DEFINITIONS                                     17050019
         SPACE 1                                                        17100019
PARMREG  EQU   1                       PARAMETER LIST REGISTER          17150019
CHARCT   EQU   4                       PARAMETER CHARACTER COUNT        17200019
COLUMNRG EQU   4                       CARD INPUT AREA                  17250019
HOLDREG  EQU   5                       HOLD AREA                        17300019
PARMTAB1 EQU   6                       PARAMETER TABLE 1                17350019
PARMTAB2 EQU   7                       PARAMETER TABLE 2                17400019
WKREG    EQU   7                       WORK REGISTER                    17450019
KEYRG    EQU   8                       KEYWORD-PARAMETER POINTER        17500019
TABREG   EQU   8                       REPLACE TABLE                    17550019
DATARG   EQU   9                       PARAMETER DATA POINTER           17600019
CNTREG   EQU   9                       COUNT REGISTER                   17650019
COMMREG  EQU   10                      COMMUNICATION REGION             17700019
DATAHOLD EQU   11                      KEYWORD DATA ENTRY POINTER       17750019
BASEREG  EQU   12                      BASE REGISTER                    17800019
SAVEREG  EQU   13                      SAVE REGISTER                    17850019
RETREG   EQU   14                      RETURN REGISTER                  17900019
LNKREG15 EQU   15                      LINK REGISTER                    17950019
R0       EQU   0                       REGISTER 0                       18000019
R1       EQU   1                       REGISTER 1                       18050019
R2       EQU   2                       REGISTER 2                       18100019
R3       EQU   3                       REGISTER 3                       18150019
R4       EQU   4                       REGISTER 4                       18200019
R7       EQU   7                       REGISTER 7                       18250019
R15      EQU   15                      REGISTER 15                      18300019
  TITLE 'IEBTCR04 - CONTROL CARD ANALYZER - MAINLINE'                   18350019
*        THIS SECTION SAVES THE DRIVER'S GENERAL REGISTERS,             18400019
*        SETS UP A SAVEAREA ADDRESS, AND ESTABLISHES BASE REGISTERS     18450019
*        FOR THIS MODULE AND FOR THE COMMON COMMUNICATION REGION.       18500019
         SPACE 2                                                        18550019
         ENTRY IEBTCR04                                                 18600019
         SAVE  (14,12),T,IEBTCR04      SAVE REGISTERS                   18650019
         BALR  BASEREG,R0              ESTABLISH BASE REGISTER          18700019
         USING *,BASEREG               INDICATE BASE REGISTER           18750019
         LR    R15,SAVEREG             ESTABLISH SAVE AREA              18800019
         ST    R15,SAVEAREA+4                                           18850019
         LA    SAVEREG,SAVEAREA                                         18900019
         ST    SAVEREG,8(R15)                                           18950019
         XR    R15,R15                                                  19000019
         ST    R15,0(SAVEREG)                                           19050019
         L     COMMREG,0(PARMREG)      LOAD COMMUNICATION REGION ADDR   19100019
         USING TCRCOM,COMMREG          INDICATE COMM. REG. BASE REG     19150019
         SPACE 3                                                        19200019
*        SYSIN EOF ADDRESS INSERTION                                    19250019
         SPACE 1                                                        19300019
*        THIS ROUTINE COMPLETES THE EODAD PARAMETER OF THE SYSIN DCB    19350019
         SPACE 2                                                        19400019
TCR100   LA    R2,SYSINDCB             LOAD SYSIN DCB ADDRESS           19450019
         USING IHADCB,R2               INDICATE DCB DSECT REG           19500019
         MVC   DCBEODAD+1(3),SYSEODAD  SET EOF ADDRESS TO TCR714        19550019
         EJECT                                                          19600019
*        CONTROL CARD ANALYZER MAINLINE                                 19650019
         SPACE 1                                                        19700019
*        THIS ROUTINE CALLS THE FOLLOWING ROUTINES FOR PROCESSING       19750019
*        OF EACH CONTROL STATEMENT                                      19800019
         SPACE 1                                                        19850019
*              TCR230 - NEW STATEMENT FETCH                             19900019
*              TCR240 - NAME VALIDATION                                 19950019
*              TCR250 - OPERATOR VALIDATION                             20000019
*              TCR250 - OPERAND VALIDATION                              20050019
         SPACE 1                                                        20100019
*        FOLLOWING VALIDATION OF EACH CONTROL STATEMENT, IT             20150019
*        CALLS THE MESSAGE WRITER (TCR220) CONTAINED IN THE             20200019
*        DRIVER.  FOLLOWING VALIDATION OF ALL CONTROL STATEMENTS        20250019
*        IT CALLS ROUTINE TCR270, WHICH TESTS THE CONSISTENCY OF ALL    20300019
*        OPTIONS AND SETS THESE OPTIONS IN THE COMMON COMMUNICATION     20350019
*        REGION OPTION TABLE.  IT ALSO CALLS ROUTINE TCR290 WHICH       20400019
*        TESTS FOR INVALID EDIT AND TRANSLATE REPLACE PARAMETERS.       20450019
         SPACE 2                                                        20500019
TCR101   BAL   RETREG,TCR230           LOAD ADDR NEW STMT FETCH RTN     20550019
         TM    STATUS,EOFSYSIN         EOF SYSIN                        20600019
         BO    TCR107                  BR YES                           20650019
         BAL   RETREG,TCR240           LOAD ADDR NAME VALIDATION RTN    20700019
         TM    STATUS,INVTERM          INVALID STATEMENT TERMINATION    20750019
         BO    TCR103                  BR YES                           20800019
         BAL   RETREG,TCR250           LOAD ADDR OPERATOR VALIDATION    20850019
         TM    STATUS,INVTERM          INVALID TERMINATION              20900019
         BO    TCR103                  BR YES                           20950019
         TM    OPTIND,INVOP            INVALID OPERATOR                 21000019
         BO    TCR103                  BR YES                           21050019
         BAL   RETREG,TCR260           LOAD ADDR OPERAND VALIDATION     21100019
         TM    STATUS,INVTERM+INVSTMT  INVALID STATEMENT                21150019
         BZ    TCR105                  BR NO                            21200019
TCR103   L     LNKREG15,VTCR220        LOAD MESSAGE WRITER ADDR         21250019
         BALR  RETREG,LNKREG15         DISPLAY MESSAGES                 21300019
TCR105   TM    STATUS,EOFSYSIN         EOF SYSIN                        21350019
         BNO   TCR101                  BR NO                            21400019
TCR107   TM    ERRIND,SYSINERR         PERMANENT I/O ERROR SYSIN        21450019
         BO    TCR1085                 BR YES                           21500019
         TM    STATUS,INVSTMT+INVTERM  ALL STATEMENTS VALID             21550019
         BNZ   TCR108                  BR NO                            21600019
         BAL   RETREG,TCR270           SET OPTIONS, TEST CONSISTENCY    21650019
         TM    STATUS,INCONOPT         OPTIONS CONSISTENT               21700019
         BO    TCR1075                 BR NO                            21750019
         BAL   RETREG,TCR290           CHECK FOR DISALLOWED REPLACE     21800019
*                                        PARAMETERS                     21850019
         TM    STATUS,INVSTMT          INVALID REPLACE PARAMETER        21900019
         BNO   TCR109                  BR NO                            21950019
TCR1075  L     LNKREG15,VTCR220        LOAD MESSAGE WRITER ADDRESS      22000019
         BALR  RETREG,LNKREG15         WRITE MESSAGES                   22050019
TCR108   MVC   RETCODE,CODE12          SET RETURN CODE 12               22100019
TCR1085  OI    ERRIND,ANALERR          SET ERROR INDICATOR              22150019
TCR109   L     SAVEREG,4(SAVEREG)                                       22200019
         RETURN (14,12),T,RC=(15)      RETURN                           22250019
  TITLE 'IEBTCR04 - CONTROL CARD ANALYZER - NEW STATEMENT FETCH'        22300019
*        NEW STATEMENT FETCH ROUTINE                                    22350019
         SPACE 1                                                        22400019
*        THIS ROUTINE CALLS THE SYSIN DATA SET READ ROUTINE, CHECKS     22450019
*        WHETHER END OF FILE HAS BEEN PRESENTED, AND INITIALIZES        22500019
*        POINTERS AND INDICATORS.                                       22550019
         SPACE 2                                                        22600019
TCR230   ST    RETREG,SAVE200          SAVE RETURN ADDRESS              22650019
         MVI   CARRCTRL,DOUBLESP       SET DOUBLE SPACE                 22700019
         BAL   RETREG,TCR710           READ SYSIN DATA SET              22750019
         TM    STATUS,EOFSYSIN         END OF SYSIN DATA SET            22800019
         BO    TCR239                  BR YES                           22850019
         NI    STATUS,STATINIT         INITIALIZE STATUS INDICATORS     22900019
         L     COLUMNRG,CARDAREA       SET COLUMN REGISTER AT COL 1     22950019
         L     HOLDREG,AHOLD           INITIALIZE HOLD AREA POINTER     23000019
         NI    OPTIND,OPTINIT          INITIALIZE OPTION INDICATOR      23050019
         MVI   SVCHAR,SPACE            SET SAVE CHAR TO SPACE           23100019
TCR239   L     RETREG,SAVE200          LOAD RETURN ADDRESS              23150019
         BR    RETREG                  RETURN                           23200019
  TITLE 'IEBTCR04 - CONTROL CARD ANALYZER - NAME VALIDATION'            23250019
*        NAME VALIDATION ROUTINE                                        23300019
         SPACE 1                                                        23350019
*        THIS ROUTINE TESTS WHETHER OR NOT A NAME FIELD HAS BEEN        23400019
*        PROVIDED.  IF ONE HAS, THE ROUTINE CHECKS THAT IT IS EIGHT     23450019
*        CHARACTERS OR LESS AND THAT THE FIRST CHARACTER IS ALPHA-      23500019
*        BETIC.  IF THE NAME FIELD IS INVALID, THE ROUTINE SETS         23550019
*        MESSAGE AND ERROR INDICATORS AND CALLS THE CHARACTER FLUSH     23600019
*        ROUTINE (TCR620) TO LOCATE THE FIRST BLANK FOLLOWING THE       23650019
*        NAME FIELD.  IF THE NAME FIELD EXTENDS OVER THE ENTIRE         23700019
*        CARD, THE ROUTINE CALLS THE STATEMENT FLUSH ROUTINE (TCR630)   23750019
*        TO FLUSH ANY RECOGNIZABLE CONTINUATION CARDS.                  23800019
         SPACE 1                                                        23850019
*        THIS ROUTINE ASSUMES THAT THE ALPHABETIC CHARACTERS A-Z        23900019
*        ARE IN ASCENDING COLLATING SEQUENCE AND HAVE NO INTERSPERSED   23950019
*        CHARACTERS.  ANY REDEFINITION OF THESE VALUES MAY NECESSI-     24000019
*        TATE MODIFICATION TO THIS ROUTINE.                             24050019
         SPACE 2                                                        24100019
TCR240   ST    RETREG,SAVE200          SAVE RETURN ADDRESS              24150019
         CLI   0(COLUMNRG),BLANK       COLUMN 1 BLANK                   24200019
         BE    TCR249                  BR YES                           24250019
         CLI   0(COLUMNRG),ALPHAA      TEST ALPHABETIC                  24300019
         BL    TCR244                  BR LOWER THAN A                  24350019
         CLI   0(COLUMNRG),ALPHAZ                                       24400019
         BH    TCR244                  BR HIGHER THAN Z                 24450019
         SPACE 1                                                        24500019
TCR242   LA    COLUMNRG,1(COLUMNRG)    INCREMENT TO NEXT COLUMN         24550019
         CLI   0(COLUMNRG),BLANK       COLUMN BLANK                     24600019
         BE    TCR249                  BR  YES                          24650019
         CL    COLUMNRG,COLUMN9        COLUMN 9                         24700019
         BL    TCR242                  BR NO                            24750019
         SPACE 1                                                        24800019
TCR244   OI    MSG02,MSGREQ            SET MSG INDICATOR                24850019
         OI    STATUS,INVSTMT          SET INVALID STMT INDICATOR       24900019
         MVI   SRCHCHAR,BLANK          SET SEARCH CHARACTER TO BLANK    24950019
         BAL   RETREG,TCR620           FLUSH CHARACTERS TO BLANK        25000019
         TM    STATUS,INVTERM          INVALID STMT TERMINATION         25050019
         BNO   TCR249                  BR NO                            25100019
         BAL   RETREG,TCR630           FLUSH CARDS THIS STMT            25150019
TCR249   L     RETREG,SAVE200          LOAD RETURN ADDRESS              25200019
         BR    RETREG                  RETURN                           25250019
  TITLE 'IEBTCR04 - CONTROL CARD ANALYZER - OPERATOR VALIDATION'        25300019
*        OPERATOR VALIDATION ROUTINE                                    25350019
         SPACE 1                                                        25400019
*        THIS ROUTINE FIRST CALLS THE CHARACTER FLUSH ROUTINE           25450019
*        (TCR620) TO LOCATE THE FIRST CHARACTER OF THE OPERATION        25500019
*        FIELD. IT THEN TRANSFERS EACH CHARACTER OF THE OPERATION       25550019
*        FIELD TO AN 8-CHARACTER HOLD AREA UNTIL IT REACHES EITHER      25600019
*        THE NINTH CHARACTER OR A BLANK.                                25650019
*        IF EIGHT OR FEWER CHARACTERS ARE TRANSFERRED, THE ROUTINE      25700019
*        COMPARES THESE CHARACTERS TO EACH OF THE ALLOWABLE             25750019
*        OPERATORS (TCRGEN  AND EXITS).  IF IT IS ONE OF THESE          25800019
*        OPERATORS AND  THE OPERATOR HAS NOT BEEN PRESENTED PRE-        25850019
*        VIOUSLY, THE ROUTINE SETS INDICATORS AND POINTERS TO THE       25900019
*        KEYWORD AND DATA TABLES.                                       25950019
*        IF THE OPERATOR IS NOT VALID, THE ROUTINE SETS MESSAGE AND     26000019
*        ERROR INDICATORS.                                              26050019
         SPACE 2                                                        26100019
TCR250   ST    RETREG,SAVE200          SAVE RETURN ADDRESS              26150019
         MVC   HOLDAREA(8),BLANKS      CLEAR HOLD AREA                  26200019
         MVI   SRCHCHAR,NONBLANK       SET SEARCH CHARACTER TO NON-BLK  26250019
         BAL   RETREG,TCR620           FLUSH TO NON-BLANK CHARACTER     26300019
         TM    STATUS,INVTERM          INVALID TERMINATION              26350019
         BO    TCR258                  BR YES                           26400019
TCR252   CL    HOLDREG,AHOLD9          9TH POSITION HOLD AREA           26450019
         BNL   TCR258                  BR YES                           26500019
         MVC   0(1,HOLDREG),0(COLUMNRG)  TRANSFER NEXT CHARACTER TO     26550019
*                                          HOLD AREA                    26600019
         LA    HOLDREG,1(HOLDREG)      INCREMENT HOLD AREA POINTER      26650019
         LA    COLUMNRG,1(COLUMNRG)    INCREMENT INPUT AREA POINTER     26700019
         CLI   0(COLUMNRG),BLANK       NEXT INPUT CHAR BLANK            26750019
         BNE   TCR252                  BR NO                            26800019
         L     HOLDREG,AHOLD           LOAD HOLD AREA ADDRESS           26850019
         CLC   0(8,HOLDREG),TCRGENOP   OPERATOR  TCRGEN                 26900019
         BNE   TCR255                  BR NO                            26950019
         TM    OPTIND,TCRGNPR          PREVIOUS TCRGEN STATEMENT        27000019
         BO    TCR254                  BR YES                           27050019
         LA    PARMTAB1,TCRGENOP       LOAD PARAMETER TABLE ADDR        27100019
         LA    PARMTAB2,TCRDATA        LOAD DATA TABLE ADDRESS          27150019
         OI    OPTIND,GEN2             SET TCRGEN INDICATORS            27200019
         B     TCR256                  BR TO CONTINUE PROCESSING        27250019
         SPACE 1                                                        27300019
TCR254   MVI   MSG06,MSGREQ            SET INVALID STMT MSG INDICATOR   27350019
TCR2543  OI    STATUS,INVSTMT          SET INVALID STMT INDICATOR       27400019
         OI    OPTIND,INVOP            SET INVALID OPERATOR INDICATOR   27450019
         BAL   RETREG,TCR630           FLUSH CARDS THIS STMT            27500019
         B     TCR257                  BR TO RETURN                     27550019
         SPACE 1                                                        27600019
TCR255   CLC   0(8,HOLDREG),EXITSOP    OPERATOR EXITS                   27650019
         BNE   TCR258                  BR NO                            27700019
         TM    OPTIND,EXITSPR          PREVIOUS EXITS  STATEMENT        27750019
         BO    TCR254                  BR YES                           27800019
         LA    PARMTAB1,EXITSOP        LOAD KEYWORD TABLE ADDRESS       27850019
         LA    PARMTAB2,EXITDATA       LOAD DATA TABLE ADDRESS          27900019
         OI    OPTIND,EXITS2           SET  EXITS  INDICATORS           27950019
TCR256   MVI   SVCHAR,COMMA            SET SAVE CHARACTER TO COMMA      28000019
         SPACE 1                                                        28050019
TCR257   L     RETREG,SAVE200          LOAD RETURN ADDRESS              28100019
         BR    RETREG                  RETURN                           28150019
TCR258   MVI   MSG03,MSGREQ            SET INVALID OPERATOR MSG IND     28200019
         B     TCR2543                 BR TO CONTINUE PROCESSING        28250019
  TITLE 'IEBTCR04 - CONTROL CARD ANALYZER - OPERAND VALIDATION'         28300019
*        OPERAND VALIDATION                                             28350019
         SPACE 1                                                        28400019
*        THIS ROUTINE FIRST CALLS THE CHARACTER FLUSH ROUTINE           28450019
*        (TCR620) TO LOCATE THE FIRST KEYWORD.  IF IT DOES NOT FIND     28500019
*        ONE ON THE FIRST CARD OF THE STATEMENT, THE ROUTINE CALLS      28550019
*        THE STATEMENT FLUSH ROUTINE (TCR630) TO BYPASS ANY RECOG-      28600019
*        NIZABLE CONTINUATION CARDS.                                    28650019
*        IF IT DOES FIND ONE, IT TRANSFERS EACH CHARACTER OF THE KEY-   28700019
*        WORD TO THE HOLD AREA UNTIL IT REACHES EITHER THE NINTH        28750019
*        CHARACTER,   A VALID DELIMITER (COMMA, SPACE, OR EQUAL SIGN),  28800019
*        OR COLUMN 72.                                                  28850019
*        IF IT REACHES THE NINTH CHARACTER, IT SETS INVALID PARAMETER   28900019
*        AND STATEMENT INDICATORS AND CALLS THE CHARACTER FLUSH ROUTINE 28950019
*        (TCR620) TO FLUSH CHARACTERS TO THE NEXT COMMA (NEXT           29000019
*        PARAMETER) OR THE NEXT BLANK (END OF STATEMENT).  IF THE       29050019
*        FLUSH ROUTINE DOES NOT FIND EITHER OF THESE CHARACTERS, THE    29100019
*        OPERAND VALIDATION ROUTINE CALLS THE STATEMENT FLUSH ROUTINE   29150019
*        TO FLUSH ANY RECOGNIZABLE CONTINUATION CARDS.                  29200019
*        IF IT FINDS A VALID DELIMITER, IT CALLS THE ASSOCIATED         29250019
*        VALIDATION ROUTINE.                                            29300019
*        IF IT REACHES COLUMN 72, IT CALLS THE END OF CARD VALIDA-      29350019
*        TION ROUTINE.  IF THE STATEMENT IS TERMINATED AT THIS POINT,   29400019
*        THE ROUTINE RETURNS TO THE MAINLINE ROUTINE.  IF THE STATE-    29450019
*        MENT IS NOT TERMINATED AT THIS POINT, THE ROUTINE CALLS THE    29500019
*        SYSIN READ ROUTINE TO READ AND VALIDATE THE NEXT CONTINUATION  29550019
*        CARD.  IF ANY ERRORS HAVE OCCURRED UP TO THIS POINT WHICH      29600019
*        ALLOW PROCESSING TO CONTINUE, THE ROUTINE CALLS THE MESSAGE    29650019
*        WRITER TO PRINT ERROR MESSAGES BEFORE CALLING THE READ         29700019
*        ROUTINE.                                                       29750019
         SPACE 2                                                        29800019
TCR260   ST    RETREG,SAVE200          SAVE RETURN ADDRESS              29850019
TCR2601  MVC   HOLDAREA(8),BLANKS      CLEAR HOLD AREA                  29900019
         MVI   SRCHCHAR,NONBLANK       SET SEARCH CHARACTER TO NON-BLK  29950019
         BAL   RETREG,TCR620           FLUSH TO NON-BLANK               30000019
         TM    STATUS,INVTERM          INVALID TERMINATION              30050019
         BNO   TCR261                  BR NO                            30100019
         L     COLUMNRG,CARDEND        SET POINTER TO COLUMN 72         30150019
         MVI   SVCHAR,SPACE            MOVE SPACE TO SAVE CHARACTER     30200019
TCR2603  BAL   RETREG,TCR630           FLUSH CARDS THIS STMT            30250019
         B     TCR262                  BR TO RETURN                     30300019
TCR261   CL    COLUMNRG,CARDEND        COLUMN 72                        30350019
         BL    TCR263                  BR NO                            30400019
         BAL   RETREG,TCR330           VALIDATE END OF CARD             30450019
         TM    STATUS,STMTTERM         STATEMENT TERMINATED             30500019
         BNZ   TCR262                  BR YES                           30550019
         TM    STATUS,INVSTMT          ALL STATEMENTS VALID             30600019
         BNO   TCR2613                 BR YES                           30650019
         L     LNKREG15,VTCR220        LOAD MESSAGE WRITER ADDRESS      30700019
         BALR  RETREG,LNKREG15         DISPLAY MESSAGES                 30750019
TCR2613  BAL   RETREG,TCR610           READ AND VALIDATE NEW CARD       30800019
         TM    STATUS,STMTTERM         STATEMENT TERMINATED             30850019
         BZ    TCR2601                 BR NO                            30900019
TCR262   L     RETREG,SAVE200          LOAD RETURN ADDRESS              30950019
         BR    RETREG                  RETURN                           31000019
         SPACE 1                                                        31050019
*        CHECK FOR DELIMITER                                            31100019
         SPACE 1                                                        31150019
TCR263   CLI   0(COLUMNRG),COMMA       COMMA?                           31200019
         BNE   TCR264                  BR NO                            31250019
         BAL   RETREG,TCR350           PROCESS PRECEDING PARAMETER      31300019
         B     TCR268                  IF ANY                           31350019
TCR264   CLI   0(COLUMNRG),SPACE       SPACE?                           31400019
         BNE   TCR265                  BR NO                            31450019
         BAL   RETREG,TCR360           PROCESS PRECEDING PARAMETER      31500019
         B     TCR261                  IF ANY                           31550019
TCR265   CLI   0(COLUMNRG),EQUALSN     EQUAL SIGN                       31600019
         BNE   TCR266                  BR NO                            31650019
         BAL   RETREG,TCR370           PROCESS PRECEDING KEYWORD IF ANY 31700019
         TM    STATUS,STMTTERM         STATEMENT TERMINATED             31750019
         BZ    TCR2653                 BR NO                            31800019
         MVI   SVCHAR,SPACE            MOVE SPACE TO SAVE CHARACTER     31850019
         B     TCR261                  BR TO CONTINUE PROCESSING        31900019
TCR2653  CLI   0(COLUMNRG),SPACE       LAST CHARACTER SPACE             31950019
         BNE   TCR268                  BR NO                            32000019
         L     COLUMNRG,CARDEND        SET AT COLUMN 72                 32050019
         MVI   SVCHAR,SPACE            MOVE SPACE TO SAVE CHARACTER     32100019
         B     TCR261                  BR TO CONTINUE PROCESSING        32150019
TCR266   CLI   0(COLUMNRG),PARENL                                       32200019
         BE    TCR267                  BYPASS LEFT PAREN                32250019
         CLI   0(COLUMNRG),PARENR                                       32300019
         BE    TCR267                  BYPASS RIGHT PAREN               32350019
         CL    HOLDREG,AHOLD9          9TH POSITION HOLD AREA           32400019
         BNL   TCR269                  BR YES                           32450019
         SPACE 1                                                        32500019
*        TRANSFER CHARACTER TO HOLD AREA                                32550019
         SPACE 1                                                        32600019
         MVC   0(1,HOLDREG),0(COLUMNRG) TRANSFER NEXT CHARACTER         32650019
TCR267   LA    HOLDREG,1(HOLDREG)      INCREMENT HOLD AREA POINTER      32700019
TCR268   MVC   SVCHAR(1),0(COLUMNRG)   TRANSFER CHARACTER TO SAVEAREA   32750019
         LA    COLUMNRG,1(COLUMNRG)    INCREMENT INPUT AREA POINTER     32800019
         B     TCR261                  BR TO CONTINUE PROCESSING        32850019
         SPACE 1                                                        32900019
*        INVALID PARAMETER OR KEYWORD                                   32950019
         SPACE 1                                                        33000019
TCR269   OI    MSG05,MSGREQ            INVALID PARAMETER OR KEYWORD     33050019
         OI    STATUS,INVSTMT          SET INVALID STMT INDICATOR       33100019
         MVI   PARMCNT+1,HEXZERO       CLEAR PARAMETER COUNT            33150019
         MVI   SRCHCHAR,COMMA          SET SEARCH CHARACTER TO COMMA    33200019
         MVI   SRCHCHAR+1,SPACE        SET SECOND SEARCH CHARACTER      33250019
*                                        TO SPACE                       33300019
         OI    OPTIND,TWOCHAR          SET TWO CHARACTER SEARCH IND     33350019
         BAL   RETREG,TCR620           FLUSH TO COMMA                   33400019
         TM    STATUS,STMTTERM         STATEMENT TERMINATED             33450019
         BNZ   TCR2603                 BR YES                           33500019
         B     TCR261                  BR TO CONTINUE PROCESSING        33550019
  TITLE 'IEBTCR04 - CONTROL CARD ANALYZER - TEST FOR CONSISTENCY'       33600019
*        SET OPTIONS - TEST CONSISTENCY                                 33650019
         SPACE 1                                                        33700019
*        THIS ROUTINE SETS OPTIONS IN THE COMMON COMMUNICATION          33750019
*        REGION OPTION TABLES AND TESTS FOR CONSISTENCY.  IF AN         33800019
*        OPTION WAS NOT SPECIFIED BY THE USER, THE ROUTINE SETS         33850019
*        AN APPROPRIATE DEFAULT.                                        33900019
         SPACE 2                                                        33950019
TCR270   ST    RETREG,SAVE200          SAVE RETURN ADDRESS              34000019
         SPACE 1                                                        34050019
*        MAXLN                                                          34100019
         SPACE 1                                                        34150019
         CLC   TEMPOP+6(2),ZEROS       MAXLN SPECIFIED                  34200019
         BE    TCR272                  BR NO                            34250019
         MVC   MAXLN(2),TEMPOP+6       SET MAXLN VALUE                  34300019
         SPACE 1                                                        34350019
*        REPLACE                                                        34400019
         SPACE 1                                                        34450019
TCR272   TM    OPTIND,REPLZERO         REPLACE EQUAL TO X'00'           34500019
         BO    TCR2723                 BR YES                           34550019
         CLC   TEMPOP+3(1),ZEROS       REPLACE SPECIFIED                34600019
         BE    TCR273                  BR NO                            34650019
TCR2723  MVC   REPL(1),TEMPOP+3        SET REPLACE CHARACTER            34700019
         SPACE 1                                                        34750019
*        MINLN                                                          34800019
         SPACE 1                                                        34850019
TCR273   CLC   TEMPOP+4(2),ZEROS       MINLN SPECIFIED                  34900019
         BE    TCR2732                 BR NO                            34950019
         MVC   MINLN(2),TEMPOP+4       SET MINLN                        35000019
         SPACE 1                                                        35050019
*        EDIT, VERCHK, ERROPT                                           35100019
         SPACE 1                                                        35150019
TCR2732  MVC   IPARM2,TEMPOP+2         SET EDIT, VERCHK, ERROPT OPTIONS 35200019
         TM    IEXITS,ERREXIT          ERROR EXIT                       35250019
         BNO   TCR2735                 BR NO                            35300019
         TM    IPARM2,ERROP            ERROPT SPECIFIED                 35350019
         BZ    TCR274                  BR NO                            35400019
         NI    IPARM2,X'FF'-ERROP      CLEAR ERROPT OPTION              35450019
         B     TCR274                  BR TO CONTINUE PROCESSING        35500019
         SPACE 1                                                        35550019
TCR2735  TM    IPARM2,ERROP            ERROPT SPECIFIED                 35600019
         BNZ   TCR274                  BR YES                           35650019
         OI    IPARM2,ERRDEF           SET ERROPT=NORMAL DEFAULT        35700019
         SPACE 1                                                        35750019
*        SET AND TEST MTST OPTIONS                                      35800019
         SPACE 1                                                        35850019
TCR274   TM    TEMPOP+1,MTSTDEF        MTST?                            35900019
         BNO   TCR276                  BR NO                            35950019
         MVC   IPARM1,TEMPOP+1         SET MTST OPTION                  36000019
         TM    TEMPOP+2,NOED           ALL EDIT OPTIONS OFF             36050019
         BNZ   TCR284                  BR NO                            36100019
         CLC   TEMPOP+4(2),ZEROS       MINLN SPECIFIED                  36150019
         BNE   TCR284                  BR YES                           36200019
         TM    TEMPOP+1,USERTAB1       USER TRANSLATE TABLE             36250019
         BO    TCR289                  BR YES                           36300019
         TM    TEMPOP+1,TRANSOP        ANY TRANSLATE OPTION SPECIFIED   36350019
         BNZ   TCR289                  BR YES                           36400019
         OI    IPARM1,TRANDEF          SET TRANS=STDUC DEFAULT          36450019
         B     TCR289                  BR TO RETURN                     36500019
         SPACE 1                                                        36550019
*        SET AND TEST MTDI OPTIONS                                      36600019
         SPACE 1                                                        36650019
TCR276   OI    IPARM1,MTDIDEF          SET MTDI OPTION                  36700019
         TM    TEMPOP+1,TRANSOP        ALL TRANSLATE OPTIONS OFF        36750019
         BNZ   TCR284                  BR NO                            36800019
         TM    TEMPOP+2,NOEDIT         NOEDIT SPECIFIED                 36850019
         BO    TCR279                  BR YES                           36900019
         TM    TEMPOP+2,VEROP          VERCHK SPECIFIED                 36950019
         BNZ   TCR278                  BR YES                           37000019
         OI    IPARM2,VERDEF           SET VERCHK=NOCHK DEFAULT         37050019
TCR278   TM    TEMPOP+2,EDITOP         ANY EDIT OPTION                  37100019
         BNZ   TCR289                  BR YES                           37150019
         OI    IPARM2,EDDEF            SET EDIT=EDITD DEFAULT           37200019
         B     TCR289                  BR TO RETURN                     37250019
TCR279   CLC   TEMPOP+4(2),ZEROS       MINLN SPECIFIED                  37300019
         BNE   TCR284                  BR YES                           37350019
         TM    TEMPOP+2,VEROP          VERCHK SPECIFIED                 37400019
         BZ    TCR289                  BR YES                           37450019
         SPACE 1                                                        37500019
*        SET ERROR INDICATORS                                           37550019
         SPACE 1                                                        37600019
TCR284   MVI   MSG08,MSGREQ            SET INCONSISTENT OPTIONS MSG     37650019
*                                        INDICATOR                      37700019
         OI    STATUS,INCONOPT         SET INVALID STMT INDICATOR       37750019
         MVI   RETCODE,CODE12          SET RETURN CODE 12               37800019
         SPACE 1                                                        37850019
TCR289   L     RETREG,SAVE200          LOAD RETURN ADDRESS              37900019
         BR    RETREG                  RETURN                           37950019
  TITLE 'IEBTCR04 - CONTROL CARD ANALYZER - TEST INVALID REPLACE PARM.' 38000019
*        REPLACE PARAMETER VALIDATION - INVALID SPECIFICATION WITH      38050019
*        EDITING OR TRANSLATION                                         38100019
         SPACE 1                                                        38150019
*        THIS ROUTINE COMPARES THE REPLACE PARAMETER WHICH HAS PREV-    38200019
*        IOUSLY BEEN VALIDATED FOR FORMAT ERRORS TO ONE OF TWO TABLES   38250019
*        (TRANRPTB OR EDITRPTB)  WHICH CONTAIN HEXADECIMAL CHARACTERS   38300019
*        WHICH MAY NOT BE USED WITH TRANSLATION OR EDITING. IT ALSO     38350019
*        DOES A HIGH-LOW COMPARISON ON THE HEXADECIMAL CHARACTERS       38400019
*        '80'-'FF' WITH TRANSLATION AND '71'-'78' WITH EDITING.         38450019
         SPACE 1                                                        38500019
*        THIS ROUTINE ASSUMES THAT THE PL CODES ARE REPRESENTED         38550019
*        BY '01' TO '08' AND ARE IN ASCENDING COLLATING SEQUENCE.       38600019
*        IT ALSO ASSUMES THAT HEXADECIMAL CODES '80' TO 'FF' ARE        38650019
*        INVALID WITH TRANSLATION AND ARE IN ASCENDING COLLATING        38700019
*        SEQUENCE.  ANY REDEFINITION OF THESE VALUES MAY NECESSITATE    38750019
*        MODIFICATION TO THIS ROUTINE.                                  38800019
         SPACE 2                                                        38850019
TCR290   ST    RETREG,SAVE200          SAVE RETURN ADDRESS              38900019
         TM    IPARM1,TRANSPEC         TRANSLATE SPECIFIED              38950019
         BZ    TCR294                  BR NO                            39000019
         SPACE 1                                                        39050019
*        TRANSLATE TEST                                                 39100019
         SPACE 1                                                        39150019
         CLI   REPL,SRC                COMPARE TO SRC CODE              39200019
         BNL   TCR296                  BR HIGH OR EQUAL                 39250019
TCR291   LA    TABREG,TRANRPTB         LOAD ADDRESS OF INVALID          39300019
*                                        TRANSLATE REPLACE CHARACTERS   39350019
         XR    CNTREG,CNTREG                                            39400019
         IC    CNTREG,TRANRPLN         INSERT COUNT                     39450019
         SPACE 1                                                        39500019
*        TABLE COMPARISON                                               39550019
         SPACE 1                                                        39600019
TCR292   CLC   REPL(1),0(TABREG)       INVALID CHARACTER                39650019
         BE    TCR296                  BR YES                           39700019
         LA    TABREG,1(TABREG)        INCREMENT TO NEXT ENTRY          39750019
         BCT   CNTREG,TCR292           BR IF ALL ENTRIES NOT TESTED     39800019
         B     TCR298                  BR TO RETURN                     39850019
         SPACE 1                                                        39900019
*        EDIT TEST                                                      39950019
         SPACE 1                                                        40000019
TCR294   TM    IPARM2,EDITSPEC         EDIT SPECIFIED                   40050019
         BZ    TCR298                  BR NO                            40100019
         CLI   REPL,P1                 COMPARE TO P1 CODE               40150019
         BL    TCR295                  BR LOW                           40200019
         CLI   REPL,P8                 COMPARE TO P8 CODE               40250019
         BNH   TCR296                  BR LOW OR EQ                     40300019
TCR295   LA    TABREG,EDITRPTB         LOAD ADDRESS OF INVALID EDIT     40350019
*                                        REPLACE CHARACTERS             40400019
         XR    CNTREG,CNTREG           CLEAR COUNT REGISTER             40450019
         IC    CNTREG,EDITRPLN         INSERT COUNT                     40500019
         B     TCR292                  BRANCH TO TABLE COMPARISON       40550019
         SPACE 1                                                        40600019
*        SET ERROR INDICATORS                                           40650019
         SPACE 1                                                        40700019
TCR296   MVI   MSG07,MSGREQ            SET INCONSISTENT REPLACE         40750019
*                                        PARAMETER INDICATOR            40800019
         OI    STATUS,INVSTMT          SET INVALID STATEMENT INDICATOR  40850019
TCR298   L     RETREG,SAVE200          LOAD RETURN ADDRESS              40900019
         BR    RETREG                  RETURN                           40950019
  TITLE 'IEBTCR04 - CONTROL CARD ANALYZER - END OF CARD VALIDATION'     41000019
*        END OF CARD VALIDATION ROUTINE                                 41050019
         SPACE 1                                                        41100019
*        THIS ROUTINE VALIDATES THE END OF A CARD.  IT CALLS            41150019
*        VALIDATION ROUTINES FOR ANY PARAMETERS THAT MAY NOT HAVE       41200019
*        HAVE BEEN VALIDATED.   IF THE SAVE CHARACTER WAS A COMMA OR    41250019
*        IF COLUMN 72    CONTAINS A NON-BLANK CHARACTER, THE ROUTINE    41300019
*        SETS CONTINUATION EXPECTED INDICATORS.  IF COLUMN 72 IS        41350019
*        NON-BLANK AND THE LAST SAVE CHARACTER WAS NOT A COMMA,         41400019
*        COMMENTS ARE EXPECTED.                                         41450019
         SPACE 2                                                        41500019
TCR330   ST    RETREG,SAVE300          STORE RETURN ADDRESS             41550019
         CLI   SVCHAR,COMMA            SAVE CHARACTER COMMA             41600019
         BE    TCR334                  BR YES                           41650019
         CLI   0(COLUMNRG),BLANK       COLUMN 72 BLANK                  41700019
         BNE   TCR336                  BR NO                            41750019
         CLI   SVCHAR,SPACE            SAVE CHARACTER SPACE             41800019
         BE    TCR332                  BR YES                           41850019
         LH    R2,PARMCNT              LOAD COUNT                       41900019
         LA    R2,2(R2)                ADD PARAMETER VALUE              41950019
         STH   R2,PARMCNT              REPLACE COUNT                    42000019
         BAL   RETREG,TCR410           VALIDATE LAST PARAMETER          42050019
TCR332   OI    STATUS,VALTERM          SET VALID STMT TERMINATION       42100019
*                                        INDICATOR                      42150019
TCR333   L     RETREG,SAVE300          LOAD RETURN ADDRESS              42200019
         BR    RETREG                  RETURN                           42250019
TCR334   OI    STATUS,CONTCD           SET CONTINUATION EXPECTED        42300019
*                                        INDICATOR - NO COMMENTS        42350019
         B     TCR333                  BR TO RETURN                     42400019
TCR336   CLI   SVCHAR,SPACE            SAVE CHARACTER SPACE             42450019
         BE    TCR337                  BR YES                           42500019
         LH    R2,PARMCNT              LOAD VALIDATION COUNT            42550019
         LA    R2,2(R2)                ADD PARAMETER VALUE              42600019
         STH   R2,PARMCNT              REPLACE COUNT                    42650019
         BAL   RETREG,TCR410           VALIDATE LAST PARAMETER          42700019
TCR337   OI    STATUS,CONTCOMM         SET CONTINUATION EXPECTED        42750019
*                                        INDICATOR - COMMENTS           42800019
         B     TCR333                  BRANCH TO RETURN                 42850019
  TITLE 'IEBTCR04 - CONTROL CARD ANALYZER - COMMA ROUTINE'              42900019
*        COMMA ROUTINE - PARAMETER VALIDATION                           42950019
         SPACE 1                                                        43000019
*        THIS ROUTINE TESTS WHETHER THE LAST PARAMETER HAS BEEN         43050019
*        VALIDATED PREVIOUSLY.  IF IT HAS NOT, IT CALLS THE PARAMETER   43100019
*        VALIDATION ROUTINE (TCR410) AND THEN SETS THE SAVE CHARACTER   43150019
*        TO COMMA.                                                      43200019
         SPACE 1                                                        43250019
TCR350   ST    RETREG,SAVE300          STORE RETURN ADDRESS             43300019
         CLI   SVCHAR,COMMA            PARAMETER FOUND                  43350019
         BE    TCR359                  BR NO                            43400019
         LH    R2,PARMCNT              LOAD VALIDATION COUNT            43450019
         LA    R2,2(R2)                ADD  COMMA INDICATOR VALUE       43500019
         STH   R2,PARMCNT              REPLACE COUNT                    43550019
         BAL   RETREG,TCR410           VALIDATE PARAMETER               43600019
         MVI   SVCHAR,COMMA            TRANSFER COMMA TO SAVE CHARACTER 43650019
TCR359   L     RETREG,SAVE300          LOAD RETURN ADDRESS              43700019
         BR    RETREG                  RETURN                           43750019
  TITLE 'IEBTCR04 - CONTROL CARD ANALYZER - SPACE ROUTINE'              43800019
*        SPACE ROUTINE - PARAMETER VALIDATION                           43850019
         SPACE 1                                                        43900019
*        THIS ROUTINE CALLS THE PARAMETER VALIDATION ROUTINE            43950019
*        (TCR410) IF THE LAST PARAMETER WAS NOT VALIDATED.  IT          44000019
*        SETS THE SAVE CHARACTER TO BLANK AND SETS THE INPUT AREA       44050019
*        POINTER TO COLUMN 72 TO BYPASS ANY INTERVENING COMMENTS.       44100019
         SPACE 2                                                        44150019
TCR360   ST    RETREG,SAVE300          SAVE RETURN ADDRESS              44200019
         CLI   SVCHAR,COMMA            PARAMETER FOUND?                 44250019
         BE    TCR362                  BR NO                            44300019
         LH    R2,PARMCNT              LOAD VALIDATION COUNT            44350019
         LA    R2,2(R2)                ADD COMMA INDICATOR VALUE        44400019
         STH   R2,PARMCNT              STORE COUNT                      44450019
         BAL   RETREG,TCR410           VALIDATE PARAMETER               44500019
         MVI   SVCHAR,SPACE            TRANSFER SPACE TO SAVE CHARACTER 44550019
TCR362   L     COLUMNRG,CARDEND        SET INPUT AREA POINTER TO        44600019
*                                        COLUMN 72                      44650019
         L     RETREG,SAVE300          LOAD RETURN ADDRESS              44700019
         BR    RETREG                  RETURN                           44750019
  TITLE 'IEBTCR04 - CONTROL CARD ANALYZER - EQUAL SIGN ROUTINE'         44800019
*        EQUAL SIGN ROUTINE - KEYWORD VALIDATION                        44850019
         SPACE 1                                                        44900019
*        THIS ROUTINE COMPARES THE KEYWORD WHICH HAS JUST BEEN          44950019
*        ASSEMBLED TO EACH ENTRY OF THE KEYWORD-PARAMETER TABLE         45000019
*        ASSOCIATED WITH THE PREVIOUSLY IDENTIFIED OPERATOR.            45050019
*        IF IT DOES NOT FIND A MATCH, IT SETS MESSAGE AND ERROR         45100019
*        INDICATORS AND FLUSHES ANY PARAMETER FOLLOWING THIS KEYWORD.   45150019
         SPACE 2                                                        45200019
TCR370   ST    RETREG,SAVE300          SAVE RETURN ADDRESS              45250019
         CLI   PARMCNT+1,HEXZERO       COUNT ZERO                       45300019
         BNE   TCR376                  BR NO                            45350019
         MVI   PARMCNT+1,HEXONE        SET COUNT EQUAL TO ONE           45400019
         LR    KEYRG,PARMTAB1          LOAD PARAMETER TABLE ADDRESS     45450019
         LA    KEYRG,16(KEYRG)         SET KEYWORD-PARAMETER TABLE      45500019
*                                        POINTER AT FIRST KEYWORD       45550019
         LR    DATARG,PARMTAB2         LOAD PARAMETER TABLE ADDRESS     45600019
         LA    DATARG,8(DATARG)        SET DATA TABLE POINTER AT FIRST  45650019
*                                        KEYWORD                        45700019
TCR372   CL    KEYRG,12(PARMTAB1)      TABLE END                        45750019
         BNL   TCR376                  BR YES                           45800019
         CLC   HOLDAREA(8),0(KEYRG)    KEYWORD FOUND                    45850019
         BE    TCR374                  BR YES                           45900019
         AH    KEYRG,10(PARMTAB1)      INCREMENT KEYWORD TABLE POINTER  45950019
         AH    DATARG,2(PARMTAB2)      INCREMENT DATA TABLE POINTER     46000019
         B     TCR372                  LOOP                             46050019
TCR374   TM    1(DATARG),KEYFND        KEYWORD PROCESSED PREVIOUSLY?    46100019
         BO    TCR375                  BR YES                           46150019
         OI    1(DATARG),KEYFND        INDICATE KEYWORD FOUND           46200019
         L     HOLDREG,AHOLD           RE-INITIALIZE HOLD AREA POINTER  46250019
         MVC   HOLDAREA(8),BLANKS      CLEAR HOLD AREA                  46300019
         B     TCR379                  BR TO RETURN                     46350019
         SPACE 1                                                        46400019
*        SET ERROR INDICATORS                                           46450019
         SPACE 1                                                        46500019
TCR375   MVI   MSG08,MSGREQ            SET MSG INDICATOR                46550019
         B     TCR377                  BR TO CONTINUE PROCESSING        46600019
TCR376   MVI   MSG04,MSGREQ            SET INCONSISTENT OPTIONS         46650019
*                                        MSG INDICATOR                  46700019
TCR377   OI    STATUS,INVSTMT          SET INVALID STMT INDICATOR       46750019
         L     HOLDREG,AHOLD           RE-INITIALIZE HOLD AREA POINTER  46800019
         MVC   0(8,HOLDREG),BLANKS     CLEAR HOLD AREA                  46850019
         MVI   PARMCNT+1,HEXZERO       CLEAR PARAMETER COUNT            46900019
         MVI   SRCHCHAR,COMMA          TRANSFER COMMA TO SEARCH CHAR    46950019
         MVI   SRCHCHAR+1,SPACE        SET SECOND SEARCH CHARACTER      47000019
*                                        TO SPACE                       47050019
         OI    OPTIND,TWOCHAR          SET TWO CHARACTER SEARCH IND     47100019
         BAL   RETREG,TCR620           FLUSH TO COMMA                   47150019
TCR379   L     RETREG,SAVE300          LOAD RETURN ADDRESS              47200019
         BR    RETREG                  RETURN                           47250019
  TITLE 'IEBTCR04 - CONTROL CARD ANALYZER - PARAMETER VALIDATION'       47300019
*        PARAMETER VALIDATION                                           47350019
         SPACE 1                                                        47400019
*        THIS ROUTINE COMPARES THE PARAMETER WHICH HAS JUST BEEN        47450019
*        ASSEMBLED TO EACH OF THE PARAMETERS ASSOCIATED WITH THE        47500019
*        PREVIOUSLY IDENTIFIED OPERATOR AND KEYWORD.  IF IT FINDS       47550019
*        A MATCH, IT USES INFORMATION CONTAINED IN THE DATA TABLE       47600019
*        TO SET OPTIONS IN THE TEMPORARY OPTION TABLE (TEMPOP).         47650019
*        IF IT DOES NOT FIND A MATCH, IT CHECKS WHETHER OR NOT A        47700019
*        SPECIAL VALIDATION ROUTINE HAS BEEN INDICATED.  IF ONE         47750019
*        HAS, IT CALLS THIS ROUTINE TO CONTINUE VALIDATION.             47800019
         SPACE 2                                                        47850019
TCR410   ST    RETREG,SAVE400          SAVE RETURN ADDRESS              47900019
         CLI   PARMCNT+1,VALNO         ONE KEYWORD AND ONE PARAMETER    47950019
         BNE   TCR418                  BR NO                            48000019
         ST    R7,SAVEREG7             SAVE REGISTER                    48050019
         LR    WKREG,KEYRG             LOAD KEYWORD ADDRESS             48100019
         AH    WKREG,10(PARMTAB1)      DEVELOP ENTRY ENDING ADDRESS     48150019
         LR    DATAHOLD,DATARG         SAVE KEYWORD ADDRESS             48200019
TCR412   LA    KEYRG,8(KEYRG)          INCREMENT TO NEXT PARAMETER      48250019
         LA    DATARG,2(DATARG)        INCREMENT DATA TABLE POINTER     48300019
         CLR   KEYRG,WKREG             END OF TABLE ENTRY?              48350019
         BNL   TCR416                  BR YES                           48400019
         CLC   0(8,KEYRG),BLANKS       NEXT TABLE ENTRY BLANK           48450019
         BE    TCR416                  BR YES                           48500019
         CLC   0(8,KEYRG),HOLDAREA     COMPARE INPUT PARAMETER          48550019
         BNE   TCR412                  BR UNEQUAL                       48600019
         L     R7,SAVEREG7             RESTORE REGISTER                 48650019
         XR    R2,R2                   CLEAR INDEX REGISTER             48700019
         IC    R2,0(DATARG)            INSERT OPTION TABLE POINTER      48750019
         IC    R3,1(DATARG)            INSERT OPTION ON MASK            48800019
         XR    R1,R1                   CLEAR OR-ING REGISTER            48850019
         IC    R1,TEMPOP(R2)           INSERT OPTION TABLE BYTE         48900019
         OR    R3,R1                   OR CURRENT AND PREVIOUS IND'S    48950019
         STC   R3,TEMPOP(R2)           SET OPTION INDICATOR IN TABLE    49000019
TCR414   MVI   PARMCNT+1,HEXZERO       CLEAR PARAMETER COUNT            49050019
         L     HOLDREG,AHOLD           SET HOLD AREA POINTER AT         49100019
*                                        LOCATION 1                     49150019
         MVC   0(8,HOLDREG),BLANKS     CLEAR HOLD AREA                  49200019
         L     RETREG,SAVE400          LOAD RETURN ADDRESS              49250019
         BR    RETREG                  RETURN                           49300019
TCR416   L     R7,SAVEREG7             RESTORE REGISTER                 49350019
         CLI   0(DATAHOLD),HEXZERO     SPECIAL ROUTINE PRESENT          49400019
         BE    TCR418                  BR NO                            49450019
         LA    RETREG,TCR414           LOAD RETURN ADDRESS REGISTER     49500019
         XR    R2,R2                   CLEAR INDEX REGISTER             49550019
         IC    R2,0(DATAHOLD)          INSERT BRANCH TABLE DISP.        49600019
         B     TCR417(R2)              BRANCH TO REQUIRED ROUTINE       49650019
TCR417   B     TCR414                  NULL                             49700019
         B     TCR510                  USER TRANSLATE TABLE             49750019
         B     TCR520                  MINLN-MAXLN                      49800019
         B     TCR530                  REPLACE                          49850019
TCR418   MVI   MSG05,MSGREQ            SET INVALID PARAMETER MSG IND    49900019
         OI    STATUS,INVSTMT          SET INVALID STMT INDICATOR       49950019
         B     TCR414                  BR TO CONTINUE                   50000019
  TITLE 'IEBTCR04 - CONTROL CARD ANALYZER - USER RTN VALIDATION'        50050019
*        USER EXIT ROUTINE OR TRANSLATE TABLE NAME VALIDATION           50100019
         SPACE 1                                                        50150019
*        THIS ROUTINE SETS INDICATORS AND STORES ROUTINE NAMES.         50200019
         SPACE 2                                                        50250019
TCR510   TM    2(DATAHOLD),HEXONE      USER TRANSLATE TABLE             50300019
         BNO   TCR512                  BR NO                            50350019
         SPACE 1                                                        50400019
*        USER TRANSLATE TABLE                                           50450019
         SPACE 1                                                        50500019
         MVC   USERNAME+USERDISP(8),HOLDAREA  STORE ROUTINE NAME        50550019
         OI    OPTABLE,USERTAB         SET OPTION INDICATOR             50600019
         OI    TEMPOP+1,USERTAB1       SET OPTION INDICATOR             50650019
         BR    RETREG                  RETURN                           50700019
         SPACE 1                                                        50750019
*        USER EXIT ROUTINE                                              50800019
         SPACE 1                                                        50850019
TCR512   XR    R2,R2                   CLEAR INDEX REGISTER             50900019
         IC    R2,2(DATAHOLD)          INSERT INDEX VALUE               50950019
         LA    R3,OPTABLE              LOAD OPTION TABLE ADDRESS        51000019
         AR    R3,R2                   ADD INDEX VALUE BASE TABLE ADDR  51050019
         OC    0(1,R3),3(DATAHOLD)     SET INDICATOR ON                 51100019
         LH    R2,4(DATAHOLD)          LOAD USERNAME TABLE ENTRY        51150019
         LA    R3,USERNAME             LOAD NAME TABLE ADDRESS          51200019
         AR    R3,R2                   FIND NAME TABLE ENTRY            51250019
         MVC   0(8,R3),HOLDAREA        STORE ROUTINE NAME               51300019
         BR    RETREG                  RETURN                           51350019
  TITLE 'IEBTCR04 - CONTROL CARD ANALYZER - MINLN-MAXLN VALIDATION'     51400019
*        MINLN - MAXLN VALIDATION ROUTINES                              51450019
         SPACE 1                                                        51500019
*        THIS ROUTINE CHECKS THAT THE MINLN OR MAXLN PARAMETER          51550019
*        IS FIVE OR FEWER CHARACTERS AND IS NUMERIC.  IF IT IS,         51600019
*        IT CONVERTS IT FROM EBCDIC TO PACKED DECIMAL AND THEN          51650019
*        TO BINARY AND STORES IT IN THE OPTION TABLE.                   51700019
         SPACE 1                                                        51750019
*        THIS ROUTINE ASSUMES THAT THE NUMERIC DIGITS 0-9 ARE IN        51800019
*        ASCENDING COLLATING SEQUENCE AND HAVE NO INTERSPERSED          51850019
*        CONTROL CHARACTERS.  ANY REDEFINITION OF THESE VALUES MAY      51900019
*        NECESSITATE MODIFICATION TO THIS ROUTINE.                      51950019
         SPACE 2                                                        52000019
TCR520   ST    R4,SAVEREG4             SAVE REGISTER 4                  52050019
         XR    CHARCT,CHARCT           ZERO CHARACTER COUNT             52100019
         L     HOLDREG,AHOLD           INITIALIZE HOLD AREA POINTER     52150019
TCR522   CLI   0(HOLDREG),BLANK        NEXT CHARACTER BLANK             52200019
         BE    TCR523                  BR YES                           52250019
         CLI   0(HOLDREG),NINE         TEST NUMERIC                     52300019
         BH    TCR528                  BR NO                            52350019
         CLI   0(HOLDREG),ZERO                                          52400019
         BL    TCR528                  BR NO                            52450019
         LA    CHARCT,1(CHARCT)        INCREMENT CHARACTER COUNT        52500019
         CL    CHARCT,HEXSIX           SIXTH CHARACTER                  52550019
         BNL   TCR528                  BR YES                           52600019
         LA    HOLDREG,1(HOLDREG)      INCREMENT HOLD AREA POINTER      52650019
         B     TCR522                  LOOP                             52700019
TCR523   SH    CHARCT,ONE              DEVELOP LENGTH INDICATOR         52750019
         LA    CHARCT,PAKLN7(CHARCT)   INSERT PACKED LENGTH 7           52800019
         EX    CHARCT,TCR525           PACK MAXLN OR MINLN              52850019
         B     TCR526                  BYPASS PACK INSTRUCTION          52900019
         SPACE 1                                                        52950019
TCR525   PACK  WORK1(1),HOLDAREA(1)    PACK MAXLN OR MINLN              53000019
         SPACE 1                                                        53050019
TCR526   NI    WORK1,PLUS              CHANGE SIGN TO PLUS              53100019
         CVB   R2,WORK1                CONVERT MINLN OR MAXLN TO BINARY 53150019
         XR    R3,R3                   CLEAR INDEX REGISTER             53200019
         IC    R3,2(DATAHOLD)          INSERT DISPLACEMENT              53250019
         STH   R2,TEMPOP(R3)           STORE MINLN OR MAXLN IN TABLE    53300019
         L     R4,SAVEREG4             RESTORE REGISTER 4               53350019
         BR    RETREG                  BR TO RETURN                     53400019
TCR528   MVI   MSG05,MSGREQ            SET INVALID PARAMETER MSG        53450019
*                                        INDICATOR                      53500019
         OI    STATUS,INVSTMT          SET INVALID STATEMENT INDICATOR  53550019
         L     R4,SAVEREG4             RESTORE REGISTER 4               53600019
         BR    RETREG                  RETURN                           53650019
  TITLE 'IEBTCR04 - CONTROL CARD ANALYZER - REPLACE PARM. VALIDATION'   53700019
*        REPLACE PARAMETER VALIDATION                                   53750019
         SPACE 1                                                        53800019
*        THIS ROUTINE VERIFIES THAT THE REPLACE PARAMETER IS OF         53850019
*        THE FORM X'CC'  WHERE C IS EITHER 0-9 OR A-F.  IF IT IS, THE   53900019
*        ROUTINE CONVERTS IT FROM EBCDIC TO HEXADECIMAL AND STORES IT   53950019
*        IN THE OPTION TABLE.                                           54000019
         SPACE 1                                                        54050019
*        THIS ROUTINE ASSUMES                                           54100019
*                                                                       54150019
*             A) THAT THE EBCDIC CHARACTERS A-F AND 0-9 ARE REPRE-      54200019
*                SENTED INTERNALLY BY X'C1' - X'CF' AND X'F0' -         54250019
*                X'F9', RESPECTIVELY.  THIS PARAMETER IS USED TO        54300019
*                SPECIFY THE HEXADECIMAL REPRESENTATION OF THE CHAR-    54350019
*                ACTERS TO BE USED FOR REPLACING DATA CHECK BYTES.      54400019
*                FOR EXAMPLE, THE INPUT CHARACTERS 'D9', REPRESENTED    54450019
*                INTERNALLY AS THE TWO BYTES '11000100''11111001'       54500019
*                WOULD BE CONVERTED TO THE ONE BYTE '11011001'.         54550019
*                                                                       54600019
*             B) THAT THE CHARACTERS A-Z AND 0-9 ARE IN ASCENDING       54650019
*                COLLATING SEQUENCE AND HAVE NO CONTROL CHARACTERS      54700019
*                INTERSPERSED AMONG EITHER GROUP.                       54750019
         SPACE 1                                                        54800019
*        ANY REDEFINITION OF THE VALUES SPECIFIED IN A  ABOVE           54850019
*        WILL NECESSITATE DEVELOPMENT OF A DIFFERENT CONVERSION         54900019
*        ALGORITHM.                                                     54950019
*                                                                       55000019
*        REDEFINITION OF B ABOVE MAY REQUIRE DIFFERENT VALIDATION       55050019
*        PROCEDURES.                                                    55100019
         SPACE 2                                                        55150019
TCR530   ST    RETREG,SAVE500          SAVE RETURN ADDRESS              55200019
         L     HOLDREG,AHOLD           INITIALIZE HOLD AREA ADDRESS     55250019
         CLI   0(HOLDREG),ALPHAX       FIRST CHAR X?                    55300019
         BNE   TCR538                  BR NO                            55350019
         CLI   1(HOLDREG),QUOTE        SECOND CHARACTER QUOTE           55400019
         BNE   TCR538                  BR NO                            55450019
         LA    HOLDREG,2(HOLDREG)      SET POINTER TO 3RD CHARACTER     55500019
         BAL   RETREG,TCR540           TEST 0-9 OR A-F                  55550019
TCR532   LA    HOLDREG,1(HOLDREG)      SET POINTER TO 4TH CHARACTER     55600019
         BAL   RETREG,TCR540           TEST 0-9 OR A-F                  55650019
         CLI   1(HOLDREG),QUOTE        FIFTH CHARACTER QUOTE            55700019
         BNE   TCR538                  BR NO                            55750019
         SPACE 1                                                        55800019
*        TRANSLATE AND STORE REPLACE BYTE                               55850019
         SPACE 1                                                        55900019
         TM    HOLDAREA+3,HEXF         NUMERIC                          55950019
         BO    TCR535                  BR YES                           56000019
TCR534   LH    R2,CBASE                DEVELOP HEX VALUE FOR            56050019
         AH    R2,HOLDAREA+2             ALPHABETIC CHARACTER           56100019
         STC   R2,HOLDAREA+3                                            56150019
TCR535   TM    HOLDAREA+2,HEXF         NUMERIC                          56200019
         BO    TCR536                  BR YES                           56250019
         LH    R2,CBASE                DEVELOP HEX VALUE FOR            56300019
*                                        ALPHABETIC CHARACTER           56350019
         MVC   HALFST+1(1),HOLDAREA+2  MOVE TO HALF WORD STORE          56400019
         AH    R2,HALFST                                                56450019
         STC   R2,HOLDAREA+2                                            56500019
TCR536   MVO   HOLDAREA+3(1),HOLDAREA+2(1)  INSERT FIRST DIGIT IN       56550019
*                                      LEFT FOUR BITS OF SECOND DIGIT   56600019
         XR    R2,R2                   CLEAR INDEX REGISTER             56650019
         IC    R2,2(DATAHOLD)          INSERT OPTION TABLE INDEX        56700019
         XR    R3,R3                   CLEAR WORK REGISTER              56750019
         IC    R3,HOLDAREA+3           MOVE REPLACE BYTE TO TEMPORARY   56800019
         STC   R3,TEMPOP(R2)             OPTION TABLE                   56850019
         XR    R2,R2                   SET REGISTER TO ZEROES           56900019
         CLR   R3,R2                   REPLACE EQUAL TO X'00'           56950019
         BNE   TCR539                  BRANCH NO                        57000019
         OI    OPTIND,REPLZERO         SET REPLACE EQUAL TO ZERO IND    57050019
         B     TCR539                  BR TO RETURN                     57100019
TCR538   MVI   MSG05,MSGREQ            SET INVALID PARAMETER MSG        57150019
*                                        INDICATOR                      57200019
         OI    STATUS,INVSTMT          SET INVALID STATEMENT INDICATOR  57250019
TCR539   L     RETREG,SAVE500          RETURN                           57300019
         BR    RETREG                  RETURN                           57350019
         SPACE 2                                                        57400019
*        TEST CHARACTER 0-9 OR A-F                                      57450019
         SPACE 1                                                        57500019
TCR540   CLI   0(HOLDREG),NINE         GREATER THAN 9                   57550019
         BH    TCR538                  BR YES                           57600019
         CLI   0(HOLDREG),ALPHAA       LOWER THAN A                     57650019
         BL    TCR538                  BR YES                           57700019
         CLI   0(HOLDREG),ZERO         LOWER THAN ZERO                  57750019
         BNL   TCR542                  BR NO                            57800019
         CLI   0(HOLDREG),ALPHAF       HIGHER THAN F                    57850019
         BH    TCR538                  BR YES                           57900019
TCR542   BR    RETREG                  RETURN                           57950019
  TITLE 'IEBTCR04 - CONTROL CARD ANALYZER - CONTINUATION CARD VALID.'   58000019
*        CONTINUATION CARD READ AND VALIDATION                          58050019
         SPACE 1                                                        58100019
*        THIS ROUTINE CALLS THE READ ROUTINE TO READ CONTINUATION       58150019
*        CARDS AND VALIDATES THEM FOR FORMAT ERRORS.                    58200019
         SPACE 2                                                        58250019
TCR610   ST    RETREG,SAVE610          SAVE RETURN ADDRESS              58300019
TCR611   BAL   RETREG,TCR710           READ A CARD                      58350019
         TM    STATUS,EOFSYSIN         EOF - SYSIN?                     58400019
         BO    TCR612                  BR YES                           58450019
         CLC   0(3,COLUMNRG),BLANKS    COLUMNS 1-3 BLANK                58500019
         BNE   TCR615                  BR NO                            58550019
         TM    STATUS,COMMIMMA         COMMENTS IMMATERIAL              58600019
         BO    TCR619                  BR YES                           58650019
         TM    STATUS,CONTCOMM         COMMENTS EXPECTED                58700019
         BO    TCR613                  BR YES                           58750019
         CLC   3(13,COLUMNRG),BLANKS   COLUMNS 4-16 BLANK               58800019
         BNE   TCR619                  BR NO                            58850019
         B     TCR615                  BR TO SET ERROR INDICATORS       58900019
TCR612   OI    STATUS,INVTERM          SET INVALID TERMINATION INDICATR 58950019
         MVI   MSG09,MSGREQ            SET INVALID CONTINUATION         59000019
*                                        INDICATOR                      59050019
         B     TCR617                  BR TO RETURN                     59100019
TCR613   CLI   COLUMN72(COLUMNRG),BLANK   COLUMN 72 BLANK               59150019
         BNE   TCR611                  BR NO                            59200019
         OI    STATUS,VALTERM          SET VALID TERMINATION            59250019
*                                        INDICATOR                      59300019
         B     TCR619                  BR TO RETURN                     59350019
TCR615   MVI   MSG09,MSGREQ            SET INVALID CONTINUATION         59400019
*                                        INDICATOR                      59450019
         BAL   RETREG,TCR630           FLUSH CARDS THIS STATEMENT       59500019
TCR617   OI    STATUS,INVSTMT          SET INVALID STMT INDICATOR       59550019
TCR619   L     RETREG,SAVE610          LOAD RETURN ADDRESS              59600019
         BR    RETREG                  RETURN                           59650019
  TITLE 'IEBTCR04 - CONTROL CARD ANALYZER - CHARACTER FLUSH ROUTINE'    59700019
*        CHARACTER FLUSH ROUTINE                                        59750019
         SPACE 1                                                        59800019
*        THIS ROUTINE FLUSHES CHARACTERS UNTIL IT FINDS THE             59850019
*        REQUESTED CHARACTER.  THE FOLLOWING REQUESTS MAY BE MADE:      59900019
         SPACE 1                                                        59950019
*        1)  ANY NON-BLANK  - INDICATED BY SETTING SRCHCHAR TO X'FF'    60000019
*        2)  ONE SEARCH CHARACTER - INDICATED BY SETTING BIT 2 OF       60050019
*            OPTIND TO ZERO AND MOVING THE REQUESTED CHARACTER TO       60100019
*            THE FIRST BYTE OF SRCHCHAR                                 60150019
*        3)  TWO SEARCH CHARACTERS - INDICATED BY SETTING BIT 2 OF      60200019
*            OPTIND TO ONE AND MOVING THE TWO REQUESTED CHARACTERS TO   60250019
*            BYTES ONE AND TWO OF SRCHCHAR.                             60300019
          SPACE 1                                                       60350019
*        IF THE ROUTINE DOES NOT FIND  THE REQUESTED CHARACTER(S), IT   60400019
*        SETS AN INVALID STATEMENT INDICATOR.                           60450019
         SPACE 2                                                        60500019
TCR620   ST    RETREG,SAVE620          SAVE RETURN ADDRESS              60550019
         MVI   PARMCNT+1,HEXZERO       CLEAR VALIDATION COUNT           60600019
         NI    OPTIND,X'FF'-NONBLIND   CLEAR NON-BLANK INDICATOR        60650019
         TM    SRCHCHAR,NONBLANK       SEARCH CHARACTER NON-BLANK       60700019
         BNO   TCR621                  BR NO                            60750019
         OI    OPTIND,NONBLIND         SET NON-BLANK INDICATOR          60800019
TCR621   CL    COLUMNRG,CARDEND        COLUMN 72                        60850019
         BNL   TCR628                  BR YES                           60900019
         TM    OPTIND,NONBLIND         NON-BLANK REQUESTED              60950019
         BO    TCR625                  BR YES                           61000019
         CLC   0(1,COLUMNRG),SRCHCHAR  SEARCH CHARACTER FOUND           61050019
         BE    TCR629                  BR YES                           61100019
         TM    OPTIND,TWOCHAR          TWO SEARCH CHARACTERS REQUESTED  61150019
         BNO   TCR623                  BR NO                            61200019
         CLC   0(1,COLUMNRG),SRCHCHAR+1  COMPARE TO SECOND SEARCH       61250019
*                                          CHARACTER                    61300019
         BE    TCR629                  BR EQUAL                         61350019
TCR623   LA    COLUMNRG,1(COLUMNRG)    INCREMENT TO NEXT CHARACTER      61400019
         B     TCR621                  LOOP                             61450019
TCR625   CLI   0(COLUMNRG),SPACE       CHARACTER NON-BLANK              61500019
         BE    TCR623                  BR NO                            61550019
         B     TCR629                  BR TO RETURN                     61600019
TCR628   OI    STATUS,INVTERM          SET INVALID TERMINATION IND      61650019
TCR629   NI    OPTIND,X'FF'-TWOCHAR    CLEAR TWO CHARACTER INDICATOR    61700019
         L     RETREG,SAVE620          LOAD RETURN ADDRESS              61750019
         BR    RETREG                  RETURN                           61800019
  TITLE 'IEBTCR04 - CONTROL CARD ANALYZER - STATEMENT FLUSH ROUTINE'    61850019
*        STATEMENT FLUSH ROUTINE                                        61900019
         SPACE 1                                                        61950019
*        THIS ROUTINE READS ALL RECOGNIZABLE CONTINUATION CARDS.        62000019
         SPACE 2                                                        62050019
TCR630   ST    RETREG,SAVE630          SAVE RETURN ADDRESS              62100019
         L     LNKREG15,VTCR220        LOAD MESSAGE WRITER ADDRESS      62150019
         BALR  RETREG,LNKREG15         WRITE MESSAGES                   62200019
         OI    STATUS,INVTERM          SET INVALID TERMINATION INDICATR 62250019
         OI    STATUS,INVSTMT          SET INVALID STMT INDICATOR       62300019
         L     COLUMNRG,CARDAREA       INITIALIZE INPUT AREA POINTER    62350019
TCR632   CLI   COLUMN72(COLUMNRG),BLANK   COLUMN 72 BLANK               62400019
         BE    TCR634                  BR YES                           62450019
         BAL   RETREG,TCR710           READ A CARD                      62500019
         TM    STATUS,EOFSYSIN         EOF - SYSIN                      62550019
         BNO   TCR632                  BR NO                            62600019
TCR634   L     RETREG,SAVE630          LOAD RETURN ADDRESS              62650019
         BR    RETREG                  RETURN                           62700019
  TITLE 'IEBTCR04 - CONTROL CARD ANALYZER - SYSIN DATA SET READ RTN'    62750019
*        SYSIN DATA SET READ ROUTINE                                    62800019
         SPACE 1                                                        62850019
*        THIS ROUTINE READS AND PRINTS EACH CONTROL CARD.  IT           62900019
*        CALLS THE MESSAGE WRITER SINGLE MESSAGE ROUTINE TO DO          62950019
*        THE PRINTING.                                                  63000019
*        IF A PERMANENT I/O ERROR OCCURS ON SYSIN, THE ROUTINE SETS     63050019
*        THE END OF FILE INDICATOR.  THIS CAUSES PROCESSING TO STOP     63100019
*        AT ALL CALLING LEVELS.                                         63150019
         SPACE 2                                                        63200019
TCR710   ST    RETREG,SAVE700          SAVE RETURN ADDRESS              63250019
         L     R2,CARDAREA             LOAD CARD AREA ADDRESS           63300019
         GET   SYSINDCB,(2)            READ CONTROL STATEMENT           63350019
         TM    ERRIND,SYSINERR         PERMANENT I/O ERROR SYSIN        63400019
         BO    TCR714                  BR YES                           63450019
         LR    COLUMNRG,R2             SET INPUT AREA POINTER TO        63500019
*                                        COLUMN 1                       63550019
         TM    DUMMYIND,DUMSYSP        SYSPRINT DUMMY                   63600019
         BO    TCR719                  BR YES                           63650019
         LA    R2,CDLENGTH             LOAD  CARD LENGTH                63700019
         STC   R2,MSGLN                STORE MSG LENGTH                 63750019
         MVC   MSGAD,CARDAREA          STORE MSG ADDRESS                63800019
         OI    PRTRTN,RTN310           SET SINGLE MSG INDICATOR         63850019
         L     LNKREG15,VTCR220        LOAD MSG WRITER ADDRESS          63900019
         BALR  RETREG,LNKREG15         PRINT CONTROL STATEMENT          63950019
         B     TCR719                  BR TO RETURN                     64000019
         SPACE 1                                                        64050019
*        END OF FILE                                                    64100019
         SPACE 1                                                        64150019
TCR714   OI    STATUS,EOFSYSIN         SET EOF INDICATOR                64200019
TCR719   L     RETREG,SAVE700          LOAD RETURN ADDRESS              64250019
         BR    RETREG                  RETURN                           64300019
  TITLE 'IEBTCR04 - CONTROL CARD ANALYZER - LITERALS AND WORK AREAS'    64350019
*        LITERALS                                                       64400019
         SPACE 2                                                        64450019
NULL     EQU   *                       NULL LABEL                       64500019
COMMA    EQU   C','                    COMMA                            64550019
SPACE    EQU   C' '                    SPACE                            64600019
EQUALSN  EQU   C'='                    EQUAL SIGN                       64650019
PARENL   EQU   C'('                    LEFT PARENTHESIS                 64700019
PARENR   EQU   C')'                    RIGHT PARENTHESIS                64750019
HEXZERO  EQU   X'00'                   HEXADECIMAL                      64800019
DOUBLESP EQU   X'F0'                   DOUBLE SPACE CONTROL CHARACTER   64850019
HEXONE   EQU   X'01'                   HEXADECIMAL ONE                  64900019
ZERO     EQU   X'F0'                   EBCDIC ZERO                      64950019
NINE     EQU   X'F9'                   EBCDIC NINE                      65000019
BLANK    EQU   X'40'                   BLANK                            65050019
QUOTE    EQU   C''''                   QUOTE                            65100019
ALPHAA   EQU   C'A'                    ALPHABETIC A                     65150019
ALPHAF   EQU   C'F'                    ALPHABETIC F                     65200019
HEXF     EQU   X'F0'                   HEXADECIMAL F                    65250019
PLUS     EQU   X'FC'                   PLUS SIGN                        65300019
ALPHAX   EQU   C'X'                    ALPHABETIC X                     65350019
ALPHAZ   EQU   C'Z'                    ALPHABETIC Z                     65400019
MTDIDEF  EQU   X'40'                   MTDI DEFAULT                     65450019
MTSTDEF  EQU   X'80'                   MTST DEFAULT                     65500019
CDLENGTH EQU   80                      CARD LENGTH                      65550019
KEYFND   EQU   X'01'                   KEY FOUND                        65600019
VALNO    EQU   X'03'                   CORRECT VALIDATION COUNT         65650019
USERTAB1 EQU   X'04'                   USER TRANSLATE TABLE INDICATED   65700019
NOEDIT   EQU   X'20'                   EDIT=NOEDIT                      65750019
EDITOP   EQU   X'E0'                   ALL EDIT OPTIONS                 65800019
VEROP    EQU   X'18'                   ALL VERCHK OPTIONS               65850019
ERREXIT  EQU   X'04'                   ERROR EXIT INDICATED             65900019
ERROP    EQU   X'06'                   ALL ERROPT OPTIONS               65950019
ANALERR  EQU   X'04'                   ERROR IN CONTROL ANALYZER        66000019
SYSINERR EQU   X'02'                   PERMANENT I/O ERROR SYSIN        66050019
DUMSYSP  EQU   X'02'                   DUMMY SYSPRINT                   66100019
MSGREQ   EQU   X'FF'                   MSG REQUIRED                     66150019
CODE12   EQU   X'0C'                   RETURN CODE 12                   66200019
NONBLANK EQU   X'FF'                   SEARCH FOR NON-BLANK CHARACTER   66250019
USERTAB  EQU   X'02'                   USER TRANSLATE TABLE INDICATED   66300019
RTN310   EQU   X'02'                   SINGLE MSG INDICATOR             66350019
EDDEF    EQU   X'80'                   EDIT DEFAULT                     66400019
VERDEF   EQU   X'08'                   VERCHK DEFAULT                   66450019
ERRDEF   EQU   X'04'                   ERROPT DEFAULT                   66500019
TRANDEF  EQU   X'10'                   TRANS DEFAULT                    66550019
NOED     EQU   X'F8'                   NO EDIT                          66600019
TRANSOP  EQU   X'1E'                   ALL TRANS OPTIONS                66650019
TRANSPEC EQU   X'1C'                   TRANSLATE                        66700019
EDITSPEC EQU   X'C0'                   EDIT                             66750019
P1       EQU   X'71'                   PROGRAM LEVEL 1 CODE             66800019
P8       EQU   X'78'                   PROGRAM LEVEL 8 CODE             66850019
SRC      EQU   X'80'                   SEARCH CODE                      66900019
USERDISP EQU   48                      TRANSLATE TABLE NAME DISP        66950019
USERDSP2 EQU   88                      TRANSLATE TABLE NAME DISP        67000019
COLUMN72 EQU   71                      COLUMN 71 POINTER                67050019
PAKLN7   EQU   112                     BINARY 7 IN LEFT HALF OF BYTE    67100019
         SPACE 1                                                        67150019
*        OPTIND INDICATORS                                              67200019
         SPACE 1                                                        67250019
REPLZERO EQU   X'80'                   REPLACE EQUALS ZERO              67300019
INVOP    EQU   X'40'                   INVALID OPERATOR                 67350019
TWOCHAR  EQU   X'20'                   TWO SEARCH CHARACTERS REQUESTED  67400019
NONBLIND EQU   X'10'                   NON-BLANK SEARCH INDICATOR       67450019
TCRGNPR  EQU   X'04'                   TCRGEN PROCESSED                 67500019
EXITSPR  EQU   X'08'                   EXITS PROCESSED                  67550019
GEN2     EQU   X'05'                   BOTH TCRGEN INDICATORS           67600019
EXITS2   EQU   X'0A'                   BOTH EXITS INDICATORS            67650019
OPTINIT  EQU   X'0C'                   OPTIND INITIALIZATION            67700019
         SPACE 1                                                        67750019
*        STATUS INDICATORS                                              67800019
         SPACE 1                                                        67850019
EOFSYSIN EQU   X'01'                   EOF - SYSIN                      67900019
INVTERM  EQU   X'02'                   INVALID STATEMENT END            67950019
CONTCD   EQU   X'08'                   CONTINUATION EXPECTED            68000019
CONTCOMM EQU   X'04'                   CONTINUATION EXPECTED - COMMENTS 68050019
INVSTMT  EQU   X'10'                   INVALID STATEMENT                68100019
INCONOPT EQU   X'20'                   INCONSISTENT OPTIONS             68150019
STATINIT EQU   X'10'                   STATUS BYTE INITIALIZATION       68200019
VALTERM  EQU   X'40'                   VALID STATEMENT TERMINATION      68250019
STMTTERM EQU   X'42'                   STATEMENT TERMINATION            68300019
COMMIMMA EQU   X'80'                   COMMENTS IMMATERIAL              68350019
         SPACE 1                                                        68400019
*        CONSTANTS                                                      68450019
         SPACE 1                                                        68500019
         DS    0H                      FORCE HALF-WORD ALIGNMENT        68550019
ONE      DC    X'0001'                 ONE                              68600019
CBASE    DC    X'0009'                 HEX C BASE                       68650019
ZEROS    DC    X'0000'                 ZEROES                           68700019
HEXSIX   DC    F'6'                    SIX                              68750019
HALFST   DC    X'0000'                 HALF WORD STORE                  68800019
BLANKS   DC    CL13' '                 BLANKS                           68850019
         SPACE 1                                                        68900019
*        SAVE AREAS                                                     68950019
         SPACE 1                                                        69000019
SAVEAREA DS    18F                     REGISTER SAVE AREA               69050019
SAVE200  DS    F                       RETURN ADDRESS SAVE AREA         69100019
SAVE300  DS    F                       RETURN ADDRESS SAVE AREA         69150019
SAVE400  DS    F                       RETURN ADDRESS SAVE AREA         69200019
SAVE500  DS    F                       RETURN ADDRESS SAVE AREA         69250019
SAVE610  DS    F                       RETURN ADDRESS SAVE AREA         69300019
SAVE620  DS    F                       RETURN ADDRESS SAVE AREA         69350019
SAVE630  DS    F                       RETURN ADDRESS SAVE AREA         69400019
SAVE700  DS    F                       RETURN ADDRESS SAVE AREA         69450019
SAVEREG4 DS    F                       REGISTER 4 SAVE AREA             69500019
SAVEREG7 DS    F                       REGISTER 7 SAVE AREA             69550019
         EJECT                                                          69600019
*        WORK AREAS                                                     69650019
         SPACE 1                                                        69700019
TEMPOP   DC    D'0'                    TEMPORARY OPTION TABLE           69750019
WORK1    DC    PL8'0'                  PACKED MINLN-MAXLN               69800019
PARMCNT  DC    X'0000'                 PARAMETER COUNT                  69850019
HOLDAREA DC    CL9' '                  KEYWOR-PARAMETER HOLD AREA       69900019
SRCHCHAR DC    X'0000'                 SEARCH CHARACTER                 69950019
SVCHAR   DC    X'00'                   SAVE CHARACTER                   70000019
         SPACE 2                                                        70050019
*        ADDRESS CONSTANTS                                              70100019
         SPACE 1                                                        70150019
AHOLD    DC    A(HOLDAREA)             HOLD AREA ADDRESS                70200019
AHOLD9   DC    A(HOLDAREA+8)           9TH CHARACTER HOLD AREA          70250019
SYSEODAD DC    AL3(TCR714)             SYSIN DCB EODAD ADDRESS          70300019
         SPACE 1                                                        70350019
*        INDICATORS                                                     70400019
         SPACE 1                                                        70450019
STATUS   DC    X'00'                   STATUS INDICATOR                 70500019
*                                                                       70550019
*              BIT 0 - COMMENTS IMMATERIAL                              70600019
*                  1 - VALID STMT TERMINATION                           70650019
*                  2 - INCONSISTENT OPTIONS                             70700019
*                  3 - INVALID  STATEMENT                               70750019
*                  4 - CONTINUATION EXPECTED - NO COMMENTS              70800019
*                  5 - CONTINUATION EXPECTED - COMMENTS                 70850019
*                  6 - INVALID STMT TERMINATION                         70900019
*                  7 - END OF FILE - SYSIN DATASET                      70950019
*                                                                       71000019
OPTIND   DC    X'00'                   OPTION INDICATORS                71050019
*                                                                       71100019
*              BIT 0 - REPLACE BYTE ZEROES                              71150019
*                  1 - INVALID OPERATOR                                 71200019
*                  2 - TWO SEARCH CHARACTERS                            71250019
*                  3 - NON-BLANK SEARCH INDICATOR                       71300019
*                  4 - EXITS PROCESSED                                  71350019
*                  5 - TCRGEN PROCESSED                                 71400019
*                  6 - EXITS STATEMENT                                  71450019
*                  7 - TCRGEN STATEMENT                                 71500019
  TITLE 'IEBTCR04 - CONTROL CARD ANALYZER - TABLES'                     71550019
*        TCRGEN KEYWORD-PARAMETER NAME TABLE                            71600019
         SPACE 1                                                        71650019
*        TO SATISFY WORLD TRADE REQUIREMENTS THE FOLLOWING TCRGEN       71700019
*        AND EXITS NAME TABLES MAY BE REPLACED IN ENTIRETY.             71750019
*                                                                       71800019
*                                                                       71850019
*                                                                       71900019
*              KEYWORD  DEFAULT    ALTERNATIVES                         71950019
*             *************************************                     72000019
*             *TYPE    *MTDI    *MTST    *        *                     72050019
*             *TRANS   *STDUC   *STDLC   *NOTRAN  *                     72100019
*             *EDIT    *EDITD   *EDITR   *NOEDIT  *                     72150019
*             *VERCHK  *NOCHK   *VOKCHK  *        *                     72200019
*             *ERROPT  *NORMAL  *NOERR   *        *                     72250019
*             *MINLN   *        *        *        *                     72300019
*             *MAXLN   *        *        *        *                     72350019
*             *REPLACE *        *        *        *                     72400019
*             *************************************                     72450019
*                                                                       72500019
*                                                                       72550019
         DS    0F                                                       72600019
TCRGENOP DC    CL8'TCRGEN'             OPERATION                        72650019
         DS    H                       NOT USED                         72700019
         DC    X'0020'                 TABLE ENTRY LENGTH - 32 BYTES    72750019
         DC    A(TAB1D)                TABLE END ADDRESS                72800019
*                                                                       72850019
TCRGENTB DC    CL8'TYPE',CL8'MTDI',CL8'MTST',CL8' '                     72900019
         DC    CL8'TRANS',CL8'STDUC',CL8'STDLC',CL8'NOTRAN'             72950019
         DC    CL8'EDIT',CL8'EDITD',CL8'EDITR',CL8'NOEDIT'              73000019
         DC    CL8'VERCHK',CL8'NOCHK',CL8'VOKCHK',CL8' '                73050019
         DC    CL8'ERROPT',CL8'NORMAL',CL8'NOERR',CL8' '                73100019
         DC    CL8'MINLN',CL24' '                                       73150019
         DC    CL8'MAXLN',CL24' '                                       73200019
         DC    CL8'REPLACE',CL24' '                                     73250019
*                                                                       73300019
TAB1D    EQU   *                       TABLE ENDING ADDRESS             73350019
*                                                                       73400019
*        TCRGEN DATA TABLE - EACH ENTRY CORRESPONDS TO ONE              73450019
*        ENTRY OF THE KEYWORD-PARAMETER TABLE                           73500019
*                                                                       73550019
*                                                                       73600019
*                 HALFWORD 1                                            73650019
*                    BYTE 1  - EXCEPTIONAL VALIDATION ROUTINE           73700019
*                              BRANCH TABLE DISPLACEMENT                73750019
*                                                                       73800019
*                    BYTE 2  - KEYWORD PROCESSED INDICATOR              73850019
*                      X'00' - NOT PROCESSED                            73900019
*                      X'01' - PROCESSED                                73950019
*                                                                       74000019
*                 HALFWORDS 2,3,4                                       74050019
*                    BYTE 1  - OPTION TABLE DISPLACEMENT                74100019
*                    BYTE 2  - 'ON' MASK                                74150019
*                                                                       74200019
TCRDATA  DS    H                       NOT USED                         74250019
         DC    X'0008'                 ENTRY LENGTH                     74300019
         DC    A(TAB2D)                TABLE END ADDRESS                74350019
         SPACE 1                                                        74400019
GENTB2   DC    X'0000',X'0140',X'0180',X'0000'    TYPE                  74450019
         DC    X'0400',X'0110',X'0108',X'0102'    TRANS                 74500019
         DC    X'0000',X'0280',X'0240',X'0220'    EDIT                  74550019
         DC    X'0000',X'0208',X'0210',X'0000'    VERCHK                74600019
         DC    X'0000',X'0204',X'0202',X'0000'    ERROPT                74650019
         DC    X'0800',X'0400',X'0000',X'0000'    MINLN                 74700019
         DC    X'0800',X'0600',X'0000',X'0000'    MAXLN                 74750019
         DC    X'0C00',X'0300',X'0000',X'0000'    REPLACE               74800019
         SPACE 1                                                        74850019
TAB2D    EQU   *                       TABLE ENDING ADDRESS             74900019
         EJECT                                                          74950019
*        EXITS KEYWORD NAME TABLE                                       75000019
         SPACE 1                                                        75050019
         DS    0F                      FORCE FULL-WORD BOUNDARY         75100019
EXITSOP  DC    CL8'EXITS'              OPERATION                        75150019
         DS    H                       NOT USED                         75200019
         DC    X'0008'                 ENTRY LENGTH                     75250019
         DC    A(TAB3D)                TABLE END ADDRESS                75300019
         SPACE 1                                                        75350019
EXITSTB  DC    CL8'OUTHDR2',CL8'OUTTLR2',CL8'OUTHDR3',CL8'OUTTLR3'      75400019
         DC    CL8'OUTREC',CL8'ERROR'                                   75450019
         SPACE 1                                                        75500019
TAB3D    EQU   *                       TABLE END ADDRESS                75550019
*                                                                       75600019
*        EXITS DATA TABLE - EACH ENTRY CORRESPONDS TO ONE               75650019
*        ENTRY OF THE KEYWORD TABLE                                     75700019
*                                                                       75750019
*                                                                       75800019
*                   BYTE 1  - EXCEPTIONAL VALIDATION ROUTINE BRANCH     75850019
*                             TABLE ADDRESS                             75900019
*                                                                       75950019
*                   BYTE 2  - KEYWORD PROCESSED INDICATOR               76000019
*                     X'00' - NOT PROCESSED                             76050019
*                     X'01' - PROCESSED                                 76100019
*                                                                       76150019
*                   BYTE 3  - COMMUNICATION TABLE LOCATION              76200019
*                                                                       76250019
*                   BYTE 4  - ON MASK                                   76300019
*                                                                       76350019
*              BYTES 5 & 6  - NAME TABLE DISPLACEMENT                   76400019
*                                                                       76450019
*                                                                       76500019
EXITDATA DS    H                       NOT USED                         76550019
         DC    X'0006'                 ENTRY LENGTH                     76600019
         DC    A(TAB4D)                TABLE END ADDRESS                76650019
         SPACE 1                                                        76700019
EXITTB   DC    X'0400',X'0080',X'0000'       OUTHDR2                    76750019
         DC    X'0400',X'0040',X'0008'       OUTTLR2                    76800019
         DC    X'0400',X'0020',X'0010'       OUTHDR3                    76850019
         DC    X'0400',X'0010',X'0018'       OUTTLR3                    76900019
         DC    X'0400',X'0008',X'0020'       OUTREC                     76950019
         DC    X'0400',X'0004',X'0028'       ERROR                      77000019
         SPACE 1                                                        77050019
TAB4D    EQU   *                       TABLE END ADDRESS                77100019
         EJECT                                                          77150019
*        INVALID TRANSLATE REPLACE PARAMETER TABLE                      77200019
         SPACE 1                                                        77250019
TRANRPTB DC    X'10'                   CODE 10                          77300019
         DC    X'11'                   CODE 11                          77350019
         DC    X'13'                   CODE 13                          77400019
         DC    X'14'                   CODE 14                          77450019
         DC    X'15'                   CODE 15                          77500019
         DC    X'17'                   CODE 17                          77550019
         DC    X'51'                   CODE 51                          77600019
         DC    X'55'                   CODE 55                          77650019
         SPACE 1                                                        77700019
TRANRPLN DC    AL1(TRANRPLN-TRANRPTB)  TABLE LENGTH                     77750019
         SPACE 1                                                        77800019
*        INVALID EDIT REPLACE PARAMETER TABLE                           77850019
         SPACE 1                                                        77900019
EDITRPTB DC    X'00'                   CODE 00                          77950019
         DC    X'11'                   CODE 11                          78000019
         DC    X'12'                   CODE 12                          78050019
         DC    X'18'                   CODE 18                          78100019
         DC    X'1D'                   CODE 1D                          78150019
         DC    X'1E'                   CODE 1E                          78200019
         DC    X'3C'                   CODE 3C                          78250019
         SPACE 1                                                        78300019
EDITRPLN DC    AL1(EDITRPLN-EDITRPTB)  TABLE LENGTH                     78350019
         SPACE 1                                                        78400019
  TITLE 'IEBTCR04 - CONTROL CARD ANALYZER - COMM. COMMUNICATION REGION' 78450019
*        COMMON COMMUNICATION REGION                                    78500019
         SPACE 1                                                        78550019
*        THIS CSECT CONTAINS TABLES, INDICATORS, CONSTANTS, WORK        78600019
*        AREAS, AND DCB'S THAT ARE USED BY TWO OR MORE MODULES.         78650019
         SPACE 2                                                        78700019
TCRCOM   DSECT                                                          78750019
         SPACE 2                                                        78800019
         DS    0F                      FORCE FULL-WORD ALIGNMENT        78850019
OPTABLE  DS    0CL8                    CONTROL CARD OPTION TABLE        78900019
         SPACE 1                                                        78950019
IEXITS   DC    X'00'                   USER ROUTINE INDICATORS          79000019
         SPACE 1                                                        79050019
*              BIT 0 - OUTHDR2                                          79100019
*                  1 - OUTTLR2                                          79150019
*                  2 - OUTHDR3                                          79200019
*                  3 - OUTTLR3                                          79250019
*                  4 - OUTREC                                           79300019
*                  5 - ERROR                                            79350019
*                  6 - USERTAB                                          79400019
*                  7 - NOT USED                                         79450019
         SPACE 1                                                        79500019
IPARM1   DC    X'00'                   TYPE AND TRANS INDICATORS        79550019
         SPACE 1                                                        79600019
*              BIT 0 - TYPE = MTST                                      79650019
*                  1 - TYPE = MTDI                                      79700019
*                  2 - UNUSED                                           79750019
*                  3 - TRANS = STDUC                                    79800019
*                  4 - TRANS = STDLC                                    79850019
*                  5 - TRANS = USERNAME                                 79900019
*                  6 - TRANS = NOTRAN                                   79950019
*                  7 - NOT USED                                         80000019
         SPACE 1                                                        80050019
IPARM2   DC    X'00'                   EDIT, VERCHK, AND ERROPT         80100019
*                                        INDICATORS                     80150019
         SPACE 1                                                        80200019
*              BIT 0 - EDIT = EDITD                                     80250019
*                  1 - EDIT = EDITR                                     80300019
*                  2 - EDIT = NOEDIT                                    80350019
*                  3 - VERCHK = VOKCHK                                  80400019
*                  4 - VERCHK = NOCHK                                   80450019
*                  5 - ERROPT = NORMAL                                  80500019
*                  6 - ERROPT = NOERR                                   80550019
*                  7 - UNUSED                                           80600019
         SPACE 1                                                        80650019
REPL     DC    X'19'                   REPLACE PARAMETER VALUE          80700019
MINLN    DC    X'0000'                 MINLN PARAMETER VALUE            80750019
MAXLN    DC    X'0000'                 MAXLN PARAMETER VALUE            80800019
         EJECT                                                          80850019
ADDRTAB  DS    0CL28                   USER ROUTINE ADDRESS TABLE       80900019
USERADDR DC    A(0,0,0,0,0,0,0)        TABLE                            80950019
         SPACE 1                                                        81000019
*              WORD 0 - OUTHDR2                                         81050019
*                   1 - OUTTLR2                                         81100019
*                   2 - OUTHDR3                                         81150019
*                   3 - OUTTLR3                                         81200019
*                   4 - OUTREC                                          81250019
*                   5 - ERROR                                           81300019
*                   6 - TRANSLATE TABLE                                 81350019
         SPACE 2                                                        81400019
MSGADDR  DC    A(0)                    MESSAGE MODULE ADDRESS           81450019
         SPACE 2                                                        81500019
*        NAME TABLE                                                     81550019
         SPACE 1                                                        81600019
*        THIS TABLE CONTAINS DDNAMES AND USER EXIT NAMES                81650019
         SPACE 1                                                        81700019
NAMETAB  DC    CL8'SYSIN',CL8'SYSPRINT',CL8'SYSUT1',CL8'SYSUT2'         81750019
         DC    CL8'SYSUT3',CL8'OUTHDR2',CL8'OUTTLR2'                    81800019
         DC    CL8'OUTHDR3',CL8'OUTTLR3',CL8'OUTREC',CL8'ERROR'         81850019
         DC    CL8'TRANS'                                               81900019
         SPACE 1                                                        81950019
*              WORDS 0-1   SYSIN                                        82000019
*                    2-3   SYSPRINT                                     82050019
*                    4-5   SYSUT1                                       82100019
*                    6-7   SYSUT2                                       82150019
*                    8-9   SYSUT3                                       82200019
*                   10-11  OUTHDR2                                      82250019
*                   12-13  OUTTLR2                                      82300019
*                   14-15  OUTHDR3                                      82350019
*                   16-17  OUTTLR3                                      82400019
*                   18-19  OUTREC                                       82450019
*                   20-21  ERROR                                        82500019
*                   22-23  TRANS                                        82550019
         EJECT                                                          82600019
*        MESSAGE POINTER TABLE                                          82650019
         SPACE 2                                                        82700019
*        THIS TABLE CONTAINS ONE FULL-WORD ENTRY FOR EACH IEB-TYPE      82750019
*        MESSAGE (EXCLUDING SYNAD MESSAGES).  MSG01 CORRESPONDS TO      82800019
*        IEB901; MSG02 CORRESPONDS TO IEB902; ETC.                      82850019
         SPACE 1                                                        82900019
*              BYTE  1 - MESSAGE REQUEST CODE                           82950019
*                                                                       83000019
*                        X'FF' = INDICATES REQUEST                      83050019
*                        X'00' = NO REQUEST                             83100019
*                                                                       83150019
*              BYTE  2 - INSERT CODE                                    83200019
*                                                                       83250019
*                        X'00' - NO INSERT                              83300019
*                        X'01' - SYSIN                                  83350019
*                        X'02' - SYSPRINT                               83400019
*                        X'03' - SYSUT1                                 83450019
*                        X'04' - SYSUT2                                 83500019
*                        X'05' - SYSUT3                                 83550019
*                        X'06' - OUTHDR2                                83600019
*                        X'07' - OUTTLR2                                83650019
*                        X'08' - OUTHDR3                                83700019
*                        X'09' - OUTTLR3                                83750019
*                        X'0A' - OUTREC                                 83800019
*                        X'0B' - ERROR                                  83850019
*                        X'0C' - USERTAB                                83900019
*                        X'54' - BOTH SYSUT2 AND SYSUT3                 83950019
*                                                                       84000019
*                    NOTE:  IF X'54' IS SPECIFIED, THE MESSAGE IS       84050019
*                        OUTPUT TWICE, ONCE WITH SYSUT2 AND ONCE        84100019
*                        WITH SYSUT3.                                   84150019
*                                                                       84200019
*              BYTE  3 - INSERT LOCATION  (MESSAGE DISPLACEMENT)        84250019
*                                                                       84300019
*              BYTE  4 - OUTPUT LOCATION                                84350019
*                                                                       84400019
*                        BIT 0 - UNUSED                                 84450019
*                            1 - UNUSED                                 84500019
*                            2 - UNUSED                                 84550019
*                            3 - UNUSED                                 84600019
*                            4 - UNUSED                                 84650019
*                            5 - SYSPRINT IF AVAILABLE, CONSOLE         84700019
*                                OTHERWISE                              84750019
*                            6 - CONSOLE                                84800019
*                            7 - SYSPRINT                               84850019
*                                                                       84900019
*                        NOTE - BITS 6 AND 7 MAY BE ON SIMULTANEOUSLY   84950019
         SPACE 1                                                        85000019
MSGPTRS  EQU   *                       ASSIGN MSGPTRS NAME TO TABLE     85050019
MSG01    DC    X'00000002'                                              85100019
MSG02    DC    X'00000001'                                              85150019
MSG03    DC    X'00000001'                                              85200019
MSG04    DC    X'00000001'                                              85250019
MSG05    DC    X'00000001'                                              85300019
MSG06    DC    X'00000001'                                              85350019
MSG07    DC    X'00000001'                                              85400019
MSG08    DC    X'00000001'                                              85450019
MSG09    DC    X'00000001'                                              85500019
MSG10    DC    X'00030B01'             INSERT LOC = 11                  85550019
MSG11    DC    X'00010B01'             INSERT LOC = 11                  85600019
MSG12    DC    X'00020B02'             INSERT LOC = 11                  85650019
MSG13    DC    X'00000B01'             INSERT LOC = 11                  85700019
MSG14    DC    X'00002501'             INSERT LOC = 37                  85750019
MSG15    DC    X'00000F04'             INSERT LOC = 15                  85800019
MSG16    DC    X'00001504'             INSERT LOC = 21                  85850019
MSG17    DC    X'00002201'             INSERT LOC = 34                  85900019
MSG18    DC    X'00001D01'             INSERT LOC = 29                  85950019
MSG19    DC    X'00000004'                                              86000019
MSG20    DC    X'00000002'                                              86050019
         SPACE 3                                                        86100019
MOUNTID  DS    F                       MOUNT MSG ID                     86150019
IOBADDR  DS    F                       SYSUT1 IOB ADDRESS               86200019
TCRBUFL  DC    X'0000'                 TCR BUFFER LENGTH                86250019
         SPACE 1                                                        86300019
ERRIND   DC    X'00'                   ABNORMAL TERMINATION INDICATORS  86350019
         SPACE 1                                                        86400019
*              BIT 0 - CONFLICTING DCB PARAMETERS                       86450019
*                  1 - STORAGE ALLOCATION ERROR                         86500019
*                  2 - I/O ERROR IN READ AND EDIT                       86550019
*                  3 - ERROR IN JFCB READ OR MOUNT                      86600019
*                  4 - ERROR DURING READ AND EDIT                       86650019
*                  5 - ERROR IN ANALYZING CONTROL CARDS                 86700019
*                  6 - PERMANENT I/O ERROR ON QSAM GET/PUT              86750019
*                  7 - ERROR IN LOADING UTILITY MODULE                  86800019
         SPACE 1                                                        86850019
DUMMYIND DC    X'00'                   DUMMY FILE INDICATORS            86900019
         SPACE 1                                                        86950019
*              BIT 0 - UNUSED                                           87000019
*                  1 - UNUSED                                           87050019
*                  2 - UNUSED                                           87100019
*                  3 - UNUSED                                           87150019
*                  4 - SYSUT3                                           87200019
*                  5 - SYSUT2                                           87250019
*                  6 - SYSPRINT                                         87300019
*                  7 - SYSIN                                            87350019
         EJECT                                                          87400019
*        DATA CONTROL BLOCK (DCB) EXIT LISTS                            87450019
         SPACE 2                                                        87500019
*        SYSIN EXIT LIST                                                87550019
         SPACE 1                                                        87600019
         DS    0F                      FORCE FULL-WORD ALIGNMENT        87650019
INEXLST  DC    X'07'                   JFCB EXIT                        87700019
         DC    AL3(0)                  WORK AREA ADDRESS                87750019
         DC    X'85'                   DCB EXIT                         87800019
         DC    AL3(0)                  DCB EXIT ROUTINE ADDRESS         87850019
         DC    X'00'                   DUMMY ENTRY                      87900019
         DC    AL3(INLRECL)            DEFAULT TABLE ADDRESS            87950019
         SPACE 2                                                        88000019
*        SYSPRINT EXIT LIST                                             88050019
         SPACE 1                                                        88100019
PREXLST  DC    X'07'                   JFCB EXIT                        88150019
         DC    AL3(0)                  WORK AREA ADDRESS                88200019
         DC    X'05'                   DCB EXIT                         88250019
         DC    AL3(0)                  DCB EXIT ROUTINE ADDRESS         88300019
         DC    X'00'                   DUMMY ENTRY                      88350019
         DC    AL3(PRTLRECL)           DEFAULT TABLE ADDRESS            88400019
         DC    X'00'                   OUTPUT HEADER LABEL (NULL)       88450019
         DC    AL3(0)                  NULL ADDRESS                     88500019
         DC    X'80'                   OUTPUT TRAILER LABEL (NULL)      88550019
         DC    AL3(0)                  NULL ADDRESS                     88600019
         SPACE 2                                                        88650019
*        SYSUT1 EXIT LIST                                               88700019
         SPACE 1                                                        88750019
UT1EXLST DC    X'87'                   JFCB EXIT                        88800019
         DC    AL3(0)                  JFCB WORK AREA ADDRESS           88850019
         SPACE 2                                                        88900019
*        SYSUT2 EXIT LIST                                               88950019
         SPACE 1                                                        89000019
         DS    0F                                                       89050019
UT2EXLST DC    X'07'                   JFCB EXIT                        89100019
         DC    AL3(0)                  WORK AREA ADDRESS                89150019
         DC    X'05'                   DCB EXIT                         89200019
         DC    AL3(0)                  DCB EXIT ROUTINE ADDRESS         89250019
         DC    X'00'                   DUMMY ENTRY                      89300019
         DC    AL3(UT2LRECL)           DEFAULT TABLE ADDRESS            89350019
         DC    X'00'                   OUTPUT HEADER LABEL              89400019
         DC    AL3(0)                  NULL ADDRESS                     89450019
         DC    X'80'                   OUTPUT TRAILER LABEL             89500019
         DC    AL3(0)                  NULL ADDRESS                     89550019
         SPACE 2                                                        89600019
*        SYSUT3 EXIT LIST                                               89650019
         SPACE 1                                                        89700019
UT3EXLST DC    X'07'                   JFCB EXIT                        89750019
         DC    AL3(0)                  WORK AREA ADDRESS                89800019
         DC    X'05'                   DCB EXIT                         89850019
         DC    AL3(0)                  DCB EXIT ROUTINE ADDRESS         89900019
         DC    X'00'                   DUMMY ENTRY                      89950019
         DC    AL3(UT3LRECL)           DEFAULT TABLE ADDRESS            90000019
         DC    X'00'                   OUTPUT HEADER LABEL              90050019
         DC    AL3(0)                  NULL ADDRESS                     90100019
         DC    X'80'                   OUTPUT TRAILER LABEL             90150019
         DC    AL3(0)                  NULL ADDRESS                     90200019
         SPACE 2                                                        90250019
*        DCB PARAMETER DEFAULTS                                         90300019
         SPACE 1                                                        90350019
INLRECL  DC    X'0050'                 SYSIN LRECL  - 80                90400019
INBLK    DC    X'0050'                 SYSIN BLKSIZE - 80               90450019
INRECFM  DC    X'90'                   SYSIN - FIXED BLOCKED            90500019
INIDENT  DC    X'01'                   INTERNAL IDENTIFICATION CODE     90550019
         SPACE 1                                                        90600019
PRTLRECL DC    X'0079'                 SYSPRINT LRECL -  121            90650019
PRTBLK   DC    X'0079'                 SYSPRINT BLKSIZE - 121           90700019
PRTRECFM DC    X'94'                   SYSPRINT - FIXED BLOCKED ASA     90750019
PRTIDENT DC    X'02'                   INTERNAL IDENTIFICATION CODE     90800019
         SPACE 1                                                        90850019
UT2LRECL DC    X'0000'                 SYSUT2 LRECL                     90900019
UT2BLK   DC    X'0000'                 SYSUT2 BLKSIZE                   90950019
UT2RECFM DC    X'50'                   SYSUT2 RECFM - VARIABLE BLOCKED  91000019
UT2IDENT DC    X'04'                   INTERNAL IDENTIFICATION CODE     91050019
         SPACE 1                                                        91100019
UT3LRECL DC    X'0000'                 SYSUT3 LRECL                     91150019
UT3BLK   DC    X'0000'                 SYSUT3 BLKSIZE                   91200019
UT3RECFM DC    X'50'                   SYSUT3 RECFM - VARIABLE BLOCKED  91250019
UT3IDENT DC    X'05'                   INTERNAL IDENTIFICATION CODE     91300019
         EJECT                                                          91350019
*        DATA CONTROL BLOCKS (DCB'S)                                    91400019
         SPACE 3                                                        91450019
*        SYSUT1 (TCR) DCB                                               91500019
         SPACE 2                                                        91550019
TCRDCB   DCB   DSORG=PS,MACRF=(E),DDNAME=SYSUT1,DEVD=TA,RECFM=UA,      X91600019
               BFTEK=S,EXLST=UT1EXLST,IOBAD=NULL                        91650019
         EJECT                                                          91700019
*        SYSUT2 DCB                                                     91750019
         SPACE 2                                                        91800019
UT2DCB   DCB   DSORG=PS,DDNAME=SYSUT2,DEVD=DA,EXLST=UT2EXLST,          X91850019
               SYNAD=NULL,EROPT=ABE,MACRF=(PM)                          91900019
         SPACE 3                                                        91950019
*        SYSUT3 DCB                                                     92000019
         SPACE 2                                                        92050019
UT3DCB   DCB   DSORG=PS,DDNAME=SYSUT3,DEVD=DA,EXLST=UT3EXLST,          X92100019
               SYNAD=NULL,EROPT=ABE,MACRF=(PM)                          92150019
         SPACE 3                                                        92200019
*        SYSIN DCB                                                      92250019
         SPACE 2                                                        92300019
SYSINDCB DCB   DSORG=PS,DDNAME=SYSIN,DEVD=DA,EODAD=NULL,MACRF=(GM),    X92350019
               EXLST=INEXLST,EROPT=ACC,SYNAD=NULL                       92400019
         SPACE 3                                                        92450019
*        SYSPRINT DCB                                                   92500019
         SPACE 2                                                        92550019
SYSPRDCB DCB   DSORG=PS,DDNAME=SYSPRINT,DEVD=DA,EXLST=PREXLST,         X92600019
               MACRF=(PM)                                               92650019
         EJECT                                                          92700019
*        GETMAINED STORAGE ADDRESSES                                    92750019
         SPACE 2                                                        92800019
CARDAREA DS    F                       CARD INPUT AREA                  92850019
JFCBAREA DS    F                       JFCB AREA ADDRESS                92900019
PRTAREA  DS    F                       SYSPRINT OUTPUT AREA             92950019
PRTLNGTH DS    F                       PRINT AREA LENGTH                93000019
COLUMN9  DS    F                       CARD INPUT COLUMN 9 ADDRESS      93050019
CARDEND  DS    F                       INPUT AREA ENDING ADDRESS        93100019
         SPACE 2                                                        93150019
USERNAME DC    7XL8'00'                USER ROUTINE NAME TABLE          93200019
           SPACE 1                                                      93250019
*              WORDS 0 & 1  - OUTHDR2 ROUTINE                           93300019
*                    2 & 3  - OUTTLR2 ROUTINE                           93350019
*                    4 & 5  - OUTHDR3 ROUTINE                           93400019
*                    6 & 7  - OUTTLR3 ROUTINE                           93450019
*                    8 & 9  - OUTREC  ROUTINE                           93500019
*                   10 & 11 - ERROR ROUTINE                             93550019
*                   12 & 13 - TRANSLATE TABLE                           93600019
           SPACE 2                                                      93650019
MISCIND  DC    X'00'                   MISCELLANEOUS INDICATORS         93700019
         SPACE 1                                                        93750019
*              BIT 0 - UNUSED                                           93800019
*                  1 - UNUSED                                           93850019
*                  2 - UNUSED                                           93900019
*                  3 - SYSUT2 LRECL REQUIRES MAXLN INCREMENT            93950019
*                  4 - SYSUT2 BLKSIZE REQUIRES MAXLN INCREMENT          94000019
*                  5 - SYSUT3 LRECL REQUIRES MAXLN INCREMENT            94050019
*                  6 - SYSUT3 BLKSIZE REQUIRES MAXLN INCREMENT          94100019
*                  7 - ALTERNATE DDNAMES FOUND                          94150019
             SPACE 2                                                    94200019
         SPACE 1                                                        94250019
RETCODE  DC    X'00'                   RETURN CODE                      94300019
TCRDEV   DC    CL3'000'                TCR DEVICE                       94350019
VOLSER   DC    CL6' '                  VOLUME SERIAL NUMBER             94400019
PRTRTN   DC    X'00'                   MESSAGE WRITER OPTION IND        94450019
CARRCTRL DC    X'40'                   CARRIAGE CONTROL                 94500019
         SPACE 1                                                        94550019
VTCR220  DS    F                       MESSAGE DISPLAY                  94600019
CURMSGAD DS    F                       CURRENT SYSPRINT MSG ADDRESS     94650019
MSGAD    DS    F                       SINGLE MESSAGE ADDRESS           94700019
MSGLN    DS    F                       SINGLE MSG LENGTH                94750019
JOBNAME  DC    CL8' '                  JOB NAME                         94800019
STEPNAME DC    CL8' '                  STEPNAME                         94850019
  TITLE 'IEBTCR04 - CONTROL CARD ANALYZER - IHADCB DSECT'               94900019
         DS    0F                      FORCE FULL-WORD ALIGNMENT        94950019
         DCBD  DSORG=PS                                                 95000019
         END   IEBTCR04                                                 95050019
./  ADD  SSI=80870034,NAME=IEBTCR05
 TITLE ' IEBTCR05 - READ/EDIT MODULE -- INTRODUCTORY NARRATIVE'         00050019
* FUNCTION/OPERATION:  THIS MODULE IS THE READ/EDIT PORTION OF THE      00100019
*   UTILITY. IT CONSISTS OF TWO CSECTS; ONE CONTAINING THE MTST AND     00150019
*   MTDI TRANSLATE & TEST TABLES AND THE MTST TRANSLATE TABLES, THE     00200019
*   OTHER CONTAINING THE REMAINDER OF THE MODULE.                       00250019
*                                                                       00300019
*        CSECT NAME         CSECT USAGE             CSECT SIZE          00350019
*       ------------       -------------           ------------         00400019
*        IEBTCR05           READ AND EDIT              3572             00450019
*        CSECT2             TABLES                      778             00500019
*                                                                       00550019
*   DATA FROM THE 2495 TAPE CARTRIDGE READER IS READ VIA EXCP CODING    00600019
*   INTO ONE OF TWO BUFFERS WHICH ARE GETMAINED AS A RESULT OF THE USER 00650019
*   SPECIFYING THE BUFL = XXXX PARAMETER IN THE SYSUT1 DD STATEMENT.THE 00700019
*   DATA IS PROCESSED FROM ONE BUFFER WHILE MORE DATA IS BEING READ     00750019
*   INTO THE OTHER BUFFER.                                              00800019
*                                                                       00850019
*   THIS MODULE SCANS THE INPUT BUFFERS FOR SPECIAL CHARACTERS, & EDITS 00900019
*   AND/OR TRANSLATES THE DATA AS SPECIFIED BY THE USER. IF NO EDIT-    00950019
*   ING OR TRANSLATING IS REQUESTED, DATA IS SIMPLY PASSED FROM THE     01000019
*   INPUT BUFFERS TO THE OUTPUT AREA. IN EITHER CASE, DATA IS MOVED     01050019
*   EVENTUALLY TO THE OUTPUT AREA UNTIL THE AREA BECOMES FULL OR UNTIL  01100019
*   A LOGICAL END-OF-RECORD IS DETECTED, IN WHICH CASE THE OUTPUT AREA  01150019
*   IS TRANSFERRED TO AN OUTPUT DEVICE (IF REQUESTED) VIA THE QSAM PUT  01200019
*   MACRO (MOVE MODE). THE OUTPUT AREA IS THEN MADE AVAILABLE FOR       01250019
*   ANOTHER GROUP OF BYTES.                                             01300019
*                                                                       01350019
*   THIS CYCLE CONTINUES UNTIL AN END-OF-FILE CONDITION IS DETECTED ON  01400019
*   THE 2495 OR UNTIL A CONDITION ARISES THAT REQUIRES ABNORMAL TERM-   01450019
*   INATION OF THE MODULE.                                              01500019
*                                                                       01550019
*   INSTRUCTION LABELS ARE OF THE FORM TCRXXX OR TSWXXX WHERE XXX IS A  01600019
*   3 DIGIT NUMBER SEQUENCING UPWARD IN THE ORDER OF APPEARANCE IN THE  01650019
*   PROGRAM. THE TCRXXX LABELS INDICATE NORMAL INSTRUCTIONS, WHILE THE  01700019
*   TSWXXX LABELS INDICATE INSTRUCTIONS WHICH ARE MODIFIED DURING PRO-  01750019
*   GRAM EXECUTION. CONSTANTS AND WORKING AREAS ARE LABELLED IN SUCH A  01800019
*   MANNER AS TO BE MEANINGFUL OF THE FUNCTION FOR WHICH THEY WERE DE-  01850019
*   FINED. NO SPECIAL PATTERN IS USED EXCEPT THAT ALL CONTROL BLOCKS    01900019
*   FOR THE SYSUT1 DATA SET ARE LABELLED WITH THE PREFIX 'TCR'. ALSO,   01950019
*   THE TRANSLATE AND TEST TABLE VALUES ARE PREFIXED WITH 'MTST' OR     02000019
*   'MTDI' ACCORDING TO WHICHEVER TYPE VALUE IS BEING DEFINED.          02050019
*                                                                       02100019
* ENTRY POINTS:                                                         02150019
*        IEBTCR05 - READ/EDIT MODULE                                    02200019
*                                                                       02250019
*   PARAMETER DATA IS PASSED 'BY NAME' AND CONSISTS OF A 560 BYTE       02300019
*   TABLE WHICH IS DEFINED AND DESCRIBED IN THE DRIVER MODULE, AND IS   02350019
*   COMMON TO ALL OTHER MODULES. IT CONSISTS OF EDIT PARAMETERS,        02400019
*   EXIT ROUTINE ADDRESSES, THE MTST TRANSLATE TABLE ADDRESS, MESSAGE   02450019
*   INDICATOR WORDS, EXIT LISTS, SPECIAL DCB PARAMETERS, AND THE DCBS   02500019
*   FOR SYSUT1, SYSUT2, AND SYSUT3.                                     02550019
*                                                                       02600019
*   THIS MODULE IS LINKED TO FROM THE DRIVER MODULE (IEBTCRIN) :        02650019
*                                                                       02700019
*                  LINK   EP=IEBTCR05,PARAM=COMMON                      02750019
           EJECT                                                        02800019
* INPUT:  INPUT CONSISTS OF DATA BYTES (READ VIA AN EXCP MACRO) FROM A  02850019
*   MAGNETIC TAPE CARTRIDGE MOUNTED ON A 2495 TAPE CARTRIDGE READER.    02900019
*   THIS TAPE MAY CONTAIN MTST DATA OR MTDI DATA, BOTH OF WHICH WILL    02950019
*   USUALLY REQUIRE EDITTING OF SPECIAL CHARACTERS. MTST DATA WILL      03000019
*   ALSO USUALLY REQUIRE TRANSLATION TO EBCDIC. THESE FUNCTIONS ARE     03050019
*   PERFORMED BY THIS MODULE.                                           03100019
*                                                                       03150019
*   THE FORMAT OF THE INPUT IS A CONTINUOUS STREAM OF CHARACTERS        03200019
*   WITHOUT INTER-RECORD GAPS. A READ COMMAND IS VALIDLY TERMINATED     03250019
*   BY ONE OF TWO CHARACTERS (HEX '19' AND HEX '1D') OR BY THE END-OF-  03300019
*   TAPE MARKER. IT MAY BE INVALIDLY TERMINATED BY A DATA CHECK OR BY   03350019
*   SOME OTHER HARDWARE FAILURE. IT IS THE FUNCTION OF THIS MODULE, BY  03400019
*   USE OF ITS EDITTING CAPABILITIES, TO CONVERT THE STREAM OF DATA     03450019
*   BYTES TO AN INTELLIGIBLE SET OF RECORDS FOR OUTPUT.                 03500019
*                                                                       03550019
* OUTPUT:  OUTPUT CONSISTS OF RECORDS IN SEQUENTIAL MODE DIRECTED TO    03600019
*   ONE OF TWO DATA SETS WHICH MAY BE DEFINED BY THE USER TO EXIST ON   03650019
*   ANY DEVICE SUPPORTED BY THE QSAM ACCESS METHOD. ONE DATA SET        03700019
*   (SYSUT2) CONTAINS VALID RECORDS (AS DETERMINED BY THE MODULE IN     03750019
*   CONJUNCTION WITH THE USER'S SPECIFICATIONS). THE OTHER DATA SET     03800019
*   (SYSUT3) CONTAINS ERROR RECORDS (ALSO DETERMINED BY THIS MODULE IN  03850019
*   CONJUNCTION WITH THE USER'S SPECIFICATIONS). THESE ERROR RECORDS    03900019
*   WILL HAVE A FOUR BYTE ERROR DESCRIPTION WORD (EDW) APPENDED TO THE  03950019
*   FRONT OF THE RECORD (MTDI ONLY).                                    04000019
*                                                                       04050019
*   OUTPUT IS PERFORMED BY USING THE QSAM 'PUT' MACRO IN THE 'MOVE'     04100019
*   MODE OF OPERATION, AND IS DIRECTED TO ANY VALID SEQUENTIAL DATA SET 04150019
*   AS DEFINED BY THE USER EITHER IN THE CURRENT STEP OR ANY PREVIOUS   04200019
*   STEP OR JOB. THE OUTPUT DATA MAY BE FIXED, VARIABLE, OR UNDEFINED   04250019
*   AND MAY BE BLOCKED OR UNBLOCKED. THESE DATA SETS WILL NOT BE OPENED 04300019
*   OPENED UNTIL THE FIRST TIME A RECORD IS TO BE SENT TO THEM.         04350019
*                                                                       04400019
* EXTERNAL ROUTINES:  N/A                                               04450019
           EJECT                                                        04500019
* EXITS - NORMAL:  OUTREC EXIT.                                         04550019
*                  THIS EXIT IS GIVEN CONTROL VIA A BAL INSTRUCTION     04600019
*                  JUST BEFORE THE OUTPUT RECORD IS PASSED TO THE NOR-  04650019
*                  MAL (SYSUT2) DATA SET. AT ENTRY, REG 1 CONTAINS THE  04700019
*                  ADDRESS OF A PARAMETER LIST WHICH CONTAINS THE ADDR  04750019
*                  OF THE OUTPUT RECORD AND THE ADDRESS OF THE RECORD   04800019
*                  LENGTH. IN THIS EXIT,THE  USER MAY PROCESS THE       04850019
*                  RECORD AND/OR PERFORM HIS OWN OUTPUT. UPON RETURN,   04900019
*                  A RETURN CODE OF ZERO WILL CAUSE THE RECORD NOT TO   04950019
*                  BE SENT TO SYSUT2. A RETURN CODE OF FOUR WILL CAUSE  05000019
*                  THE RECORD TO BE SENT TO SYSUT2. ANY OTHER RETURN    05050019
*                  CODE WILL CAUSE THE UTILITY TO TERMINATE.            05100019
*                                                                       05150019
*                  OUTHDR2,OUTHDR3,OUTTLR2, AND OUTTLR3 EXITS.          05200019
*                                                                       05250019
*                  OUTHDR2 AND OUTHDR3 ARE GIVEN CONTROL AT OPEN TIME   05300019
*                  FOR SYSUT2 AND SYSUT3 RESPECTIVELY,FOR THE PURPOSE   05350019
*                  OF CREATING USER OUTPUT HEADER LABELS.               05400019
*                  OUTTLR2 AND OUTTLR3 ARE GIVEN CONTROL AT CLOSE TIME  05450019
*                  FOR SYSUT2 AND SYSUT3 RESPECTIVELY,FOR THE PURPOSE   05500019
*                  OF CREATING USER OUTPUT TRAILER LABELS.              05550019
*                  AT ENTRY, REG 1 CONTAINS THE ADDRESS OF A PARAMETER  05600019
*                  LIST WHICH CONTAINS THE ADDRESS OF THE OUTPUT LABEL  05650019
*                  BUFFER AREA AND THE ADDR OF THE DCB BEING PROCESSED. 05700019
*                  UPON RETURN, A RETURN CODE OF ZERO WILL CAUSE NO     05750019
*                  LABEL TO BE WRITTEN AND NORMAL PROCESSING TO CON-    05800019
*                  TINUE. A RETURN CODE OF FOUR WILL CAUSE A LABEL TO   05850019
*                  BE WRITTEN AND NORMAL PROCESSING TO CONTINUE. A RE-  05900019
*                  TURN CODE OF EIGHT WILL CAUSE A LABEL TO BE WRITTEN  05950019
*                  AND A CHECK MADE FOR A COUNT OF EIGHT LABELS. IF     06000019
*                  EIGHT LABELS HAVE BEEN WRITTEN, NORMAL PROCESSING    06050019
*                  CONTINUES. IF LESS THAN EIGHT LABELS HAVE BEEN       06100019
*                  WRITTEN, CONTROL IS RETURNED TO THE EXIT ROUTINE.    06150019
*                  A RETURN CODE OF SIXTEEN CAUSES THE UTILITY TO       06200019
*                  TERMINATE.                                           06250019
*                                                                       06300019
*          ERROR:  ERROR EXIT.                                          06350019
*                  THIS EXIT IS GIVEN CONTROL VIA A BAL INSTRUCTION     06400019
*                  JUST BEFORE AN ERROR RECORD IS PASSED TO SYSUT3.     06450019
*                  AT ENTRY, REG 1 CONTAINS THE ADDRESS OF A PARAMETER  06500019
*                  LIST WHICH CONTAINS THE ADDRESS OF THE ERROR RECORD  06550019
*                  AND THE ADDRESS OF THE RECORD LENGTH. THE USER MAY   06600019
*                  EXAMINE AND MODIFY ANY BYTE IN THE ERROR RECORD      06650019
*                  AND/OR THE EDW. UPON RETURN, A RETURN CODE OF ZERO   06700019
*                  WILL CAUSE THE RECORD NOT TO BE SENT TO SYSUT3, BUT  06750019
*                  RATHER TO BE TREATED AS A VALID RECORD. THE EDW WILL 06800019
*                  BE REMOVED (AND RESET). A RETURN CODE OF FOUR WILL   06850019
*                  CAUSE THE RECORD TO BE SENT TO SYSUT3. ANY OTHER     06900019
*                  RETURN CODE WILL CAUSE THE UTILITY TO TERMINATE.     06950019
           EJECT                                                        07000019
* TABLES/WORKAREAS:  WORKING STORAGE CONSISTS OF THE I/O CONTROL        07050019
*   BLOCKS AND THE CHANNEL PROGRAM NECESSARY FOR READING THE TCR,       07100019
*   SWITCHES, POINTERS, AND SAVE AREAS FOR VARIOUS EDITTING FUNCTIONS.  07150019
*   THE INPUT BUFFERS AND INTERMEDIATE OUTPUT WORKAREA ARE GETMAINED    07200019
*   FROM OUTSIDE THE PROGRAM AREA.                                      07250019
*   THREE TABLES ARE USED: AN MTDI TRANSLATE & TEST TABLE, AN MTST      07300019
*   TRANSLATE & TEST TABLE, AND AN MTST TRANSLATE TABLE. THE TRT TABLES 07350019
*   TABLES ARE USED TO DETECT SPECIAL CHARACTERS IN THE INPUT STREAM    07400019
*   FOR EDITTING PURPOSES. THE MTST TRANSLATE TABLE IS USED TO TRANS-   07450019
*   LATE THE MTST CHARACTERS TO EBCDIC. AN UPPER CASE TABLE, A LOWER    07500019
*   CASE TABLE, OR A USER DEFINED TABLE MAY BE USED.                    07550019
*                                                                       07600019
* ATTRIBUTES:  THIS MODULE IS AN ONLY-LOADABLE MODULE. IT IS NOT        07650019
*   RE-ENTERABLE NOR RE-USABLE.                                         07700019
*                                                                       07750019
* NOTES:  THIS MODULE CONTAINS TYPE E CHARACTER CODE DEPENDENCIES. THE  07800019
*   THE OPERATION OF THIS MODULE DEPENDS UPON THE FOLLOWING PROPERTIES  07850019
*   OF THE INTERNAL REPRESENTATION OF THE EXTERNAL CHARACTER SET: HEX   07900019
*   REPRESENTATION IN TABLE FORM, AND CHARACTER CODE SEQUENCE. THE      07950019
*   SPECIFIC INSTRUCTION SEQUENCES, TABLES, AND CONSTANTS THAT REQUIRE  08000019
*   MODIFICATION WHEN THESE PROPERTIES OF THE CHARACTER SET ARE         08050019
*   CHANGED MAY BE IDENTIFIED BY:                                       08100019
*                                                                       08150019
*   1) THE INSTRUCTION SEQUENCE TCR320-4 TO TSW328 (SCAN ROUTINE) WHICH 08200019
*      DOES A PROGRAM LEVEL SEARCH, ASSUMES THAT THE PL CODES ARE       08250019
*      SEQUENTIALLY AND SUCCESSIVELY ASSIGNED.                          08300019
*                                                                       08350019
*   2) THE INSTRUCTION SEQUENCE FROM TCR610 TO TCR612 (SCAN ROUTINE     08400019
*      FOR PL CODES) AND AT TCR860 (OUTPUT ROUTINE) WHICH CONVERT THE   08450019
*      PL CODES TO THE FORM '01' THROUGH '08' ALSO ASSUMES THAT THE PL  08500019
*      CODES ARE SEQUENTIALLY AND SUCCESSIVELY ASSIGNED.                08550019
*                                                                       08600019
*   3) THE TRANSLATE TABLES LABELLED 'EDWTT', 'UPPER', AND 'LOWER'      08650019
*      CONTAIN ENTRIES IN HEX NOTATION TO CONVERT DATA TO THE EBCDIC    08700019
*      CHARACTER SET.                                                   08750019
*                                                                       08800019
*   4) THE CONSTANT LABELLED 'HEXEOR' AND THE SET OF EQU INSTRUCTIONS   08850019
*      FROM 'MTDILZF' TO 'MTSTUSRC' DEFINE THE SPECIAL CHARACTERS (IN   08900019
*      CHARACTER FORM) FOR THE INPUT DATA SET.                          08950019
*                                                                       09000019
*   COMMENTS AND REMARKS ARE PROVIDED TO INDICATE THE CONSIDERATIONS    09050019
*   INVOLVED AND THE MECHANISM FOR CHANGING THE CODE.                   09100019
  TITLE  ' IEBTCR05 - READ/EDIT MODULE -- REGISTER DEFINITIONS'         09150019
         SPACE 4                                                        09200019
IEBTCR05 START 0                                                        09250019
R0       EQU   0                   PARAMETER REGISTER                   09300019
R1       EQU   1                   PARAMETER REGISTER                   09350019
R2       EQU   2                   WORK REGISTER                        09400019
R3       EQU   3                   INPUT BUFFER POINTER                 09450019
R4       EQU   4                   WORK REGISTER                        09500019
R5       EQU   5                   WORK REGISTER                        09550019
R6       EQU   6                   WORK REGISTER                        09600019
R7       EQU   7                   WORK REGISTER                        09650019
R8       EQU   8                   WORK REGISTER                        09700019
R9       EQU   9                   OUTPUT RECORD LENGTH                 09750019
R10      EQU   10                  READ/EDIT BASE REGISTER              09800019
R11      EQU   11                  COMMON AREA BASE REGISTER            09850019
R12      EQU   12                  TRANSFER REGISTER                    09900019
R13      EQU   13                  SAVEAREA REGISTER                    09950019
R14      EQU   14                  TRANSFER REGISTER                    10000019
R15      EQU   15                  PARAMETER REGISTER                   10050019
         TITLE ' IEBTCR05 - READ/EDIT MODULE -- ENTRY ROUTINE'          10100019
*        THIS SECTION SAVES THE CALLERS GENERAL REGISTERS,ESTABLISHES   10150019
*        BASE REGISTERS FOR THE MODULE AND THE COMMON AREA,AND          10200019
*        COMPLETES FILLING IN THE COMMON AREA AND THE TCR IOB.          10250019
         SPACE 4                                                        10300019
         SAVE  (14,12)             SAVE REGISTERS                       10350019
         BALR  R10,0               SET UP                               10400019
         USING *,R10                    READ/EDIT BASE                  10450019
         ST    R13,SAVEREG+HSA                                          10500019
         LA    R5,SAVEREG          SET UP                               10550019
         ST    R5,LSA(R13)                REGISTER                      10600019
         LR    R13,R5                              SAVEAREA             10650019
         L     R11,0(R1)           GET ADDRESS OF COMMON AREA           10700019
         USING COMMON,R11          SET UP DSECT BASE                    10750019
         LA    R0,TCRDCB           PUT ADDRESS OF TCR DCB               10800019
         ST    R0,DCBADDR                      IN EXCP IOB              10850019
         LA    R0,TCRIOB           PUT ADDRESS OF TCR IOB               10900019
         ST    R0,IOBADDR                      IN COMMON AREA           10950019
         MVC   EXLST2(DBLWRD),XL2  SET UP EXIT LIST FOR SYSUT2          11000019
         MVC   EXLST3(DBLWRD),XL3  SET UP EXIT LIST FOR SYSUT3          11050019
         LH    R0,BUFL             PICK UP INPUT BUFFER LENGTH          11100019
         EJECT                                                          11150019
*        THIS SECTION DETERMINES THE SIZE OF THE INPUT BUFFERS AND      11200019
*        THE OUTPUT WORKAREA; THEN GETMAINS THESE AREAS. IF THERE IS    11250019
*        INSUFFICIENT CORE FOR THE GETMAIN, THE UTILITY IS TERMINATED.  11300019
         SPACE 4                                                        11350019
         STH   R0,TCRCCW1+CNTFLD   STORE IT IN                          11400019
         STH   R0,TCRCCW2+CNTFLD   BOTH CCWS                            11450019
         SLA   R0,1                MULTIPLY BUFL BY 2                   11500019
         ST    R0,BUFL1            SAVE 2*BUFL FOR FREEMAIN             11550019
         ST    R0,BUFL2                                                 11600019
         GETMAIN VC,LA=BUFL1,A=GM1 GETMAIN INPUT BUFFERS                11650019
         LTR   R15,R15             SUCCESSFUL GETMAIN ?                 11700019
         BZ    TCR015              BRANCH IF YES                        11750019
TCR010   OI    ERRIND,NOCORE       INDICATE NOT ENOUGH CORE AVAILABLE   11800019
         MVI   GMAINERR,MSGFLAG    SET THE GETMAIN ERROR MESSAGE FLAG   11850019
         B     TCR999              BRANCH TO END UTILITY                11900019
TCR015   MVC   TCRCCW1(WORD),GM1   PUT INPUT BUFFER ADDRESS IN CCW1     11950019
         MVI   TCRCCW1,READ        RE-LOAD READ COMMAND                 12000019
         L     R1,GM1                                                   12050019
         AH    R1,TCRCCW1+CNTFLD   COMPUTE SECOND BUFFER ADDRESS        12100019
         ST    R1,TCRCCW2          STORE IT IN CCW2                     12150019
         MVI   TCRCCW2,READ        RE-LOAD READ COMMAND                 12200019
         LH    R0,UT2LRECL         GET SYSUT2 LRECL FOR WORKAREA LENGTH 12250019
         CH    R0,UT3LRECL         IS IT GREATER THAN SYSUT3 LRECL ?    12300019
         BNL   TCR020              BRANCH IF YES                        12350019
         LH    R0,UT3LRECL         IF NO,USE SYSUT3 LRECL INSTEAD       12400019
TCR020   CH    R0,MAXLN            IS IT GREATER THAN MAXLN ?           12450019
         BNL   TCR030              BRANCH IF YES                        12500019
         LH    R0,MAXLN            IF NO,USE MAXLN AS WORKAREA LENGTH   12550019
TCR030   AH    R0,TCON8            ADD 8 FOR EDW AND VAR LNG CTR        12600019
         ST    R0,WORKL1           SAVE IT FOR FREEMAIN                 12650019
         ST    R0,WORKL2                                                12700019
         GETMAIN VC,LA=WORKL1,A=GM2         GETMAIN WORKAREA            12750019
         LTR   R15,R15             SUCCESSFUL GETMAIN ?                 12800019
         BNZ   TCR010              BRANCH IF NO TO INDICATE GETMAIN ERR 12850019
         L     R1,GM2                                                   12900019
         BAL   R14,TCR932          SET UP WORKAREA POINTERS             12950019
         EJECT                                                          13000019
*        THIS SECTION SETS THE NOP SWITCHES WHEN MTDI IS SPECIFIED.     13050019
*        THE SWITCHES ARE ASSEMBLED FOR DEFAULT VALUES AS FOLLOWS:      13100019
*                   TYPE = MTDI                                         13150019
*                   EDIT = EDITD                                        13200019
*                   VERCHK = VOKCHK                                     13250019
         SPACE 4                                                        13300019
         TM    PARM1,MTST          TYPE = MTST ?                        13350019
         BO    TCR055              BRANCH IF YES                        13400019
         L     R1,MTDIADDR         LOAD ADDR OF MTDI TRT TABLE          13450019
         TM    PARM2,NOEDIT        EDIT = NOEDIT ?                      13500019
         BZ    TCR040              BRANCH IF NO                         13550019
         OI    TSW315+1,BRANCH     TURN OFF SOR-EXPECTED SWITCH         13600019
         NI    TSW148+1,NOP        SET NOEDIT SWITCH                    13650019
         B     TCR060              SKIP ALL EDIT SWITCH SETTINGS        13700019
TCR040   TM    PARM2,VOKCHK        VERCHK = VOKCHK ?                    13750019
         BZ    TCR045              BRANCH IF NO                         13800019
         NI    TSW658+1,NOP        SET VOKCHK SWITCH                    13850019
TCR045   CLC   MINLN(2),TCON0      MINLN SPECIFIED ?                    13900019
         BE    TCR050              BRANCH IF NO                         13950019
         NI    TSW857+1,NOP        SET MINLN SWITCH                     14000019
TCR050   TM    PARM2,EDITD         EDIT = EDITD ?                       14050019
         BO    TCR070              BRANCH IF YES                        14100019
         OI    TSW328+1,BRANCH     ELSE                                 14150019
         NI    TSW612+1,NOP            SET                              14200019
         OI    TSW616+1,BRANCH                                          14250019
         OI    TSW625+1,BRANCH            SWITCHES                      14300019
         OI    TSW662+1,BRANCH                    FOR                   14350019
         NI    TSW846+1,NOP                                             14400019
         NI    TSW854+1,NOP                          EDITR              14450019
         NI    TSW888+1,NOP                                             14500019
         NI    TSW911+1,NOP                                             14550019
         B     TCR070              BRANCH TO SKIP MTST SWITCH SETTINGS  14600019
         EJECT                                                          14650019
*        THIS SECTION SETS THE NOP SWITCHES WHEN MTST IS SPECIFIED      14700019
*        OR WHEN NOTRAN OR NOEDIT IS SPECIFIED.                         14750019
         SPACE 4                                                        14800019
TCR055   L     R1,MTSTADDR         LOAD ADDR OF MTST TRT TABLE          14850019
         OI    TSW140+1,BRANCH     AND SET MTST SWITCH                  14900019
         OI    TSW315+1,BRANCH     TURN OFF SOR-EXPECTED SWITCH         14950019
         TM    PARM1,NOTRAN        TRANS = NOTRAN ?                     15000019
         BO    TCR060              BRANCH IF YES                        15050019
         OI    TSW852+1,BRANCH     SET MTST-WITH-TRANSLATE SWITCH       15100019
         TM    PARM1,STDUC         TRANS = STDUC ?                      15150019
         BZ    TCR057              BRANCH IF NO                         15200019
         L     R2,UPPERADR                                              15250019
         B     TCR058              BRANCH AROUND LOWER CASE SETTING     15300019
TCR057   TM    PARM1,STDLC         TRANS = STDLC ?                      15350019
         BZ    TCR065              BRANCH IF NO;  TRANS = 'USERNAME'    15400019
         L     R2,LOWERADR                                              15450019
TCR058   ST    R2,TRANTABL         STORE TRANSLATE TABLE ADDRESS        15500019
         B     TCR065              SKIP NOTRAN-NOEDIT SWITCH            15550019
TCR060   OI    TSW347+1,BRANCH     SET NOTRAN-NOEDIT SWITCH             15600019
TCR065   OI    TSW100+1,BRANCH       AND                                15650019
         OI    TSW114+1,BRANCH          SET                             15700019
         OI    TSW125+1,BRANCH                                          15750019
         NI    TSW815+1,NOP                THE                          15800019
         OI    TSW840+1,BRANCH                                          15850019
         OI    TSW853+1,BRANCH                SWITCHES                  15900019
         OI    TSW863+1,BRANCH                                          15950019
         OI    TSW914+1,BRANCH                        FOR               16000019
         OI    TSW929+1,BRANCH                                          16050019
         OI    TSW931+1,BRANCH                  NOT-MTDI-WITH-EDIT      16100019
         EJECT                                                          16150019
*        THIS SECTION SETS THE NOP SWITCHES WHEN THE ERROPT OPTION      16200019
*        (DEFAULT IS ERROPT = NORMAL) IS SPECIFIED,WHEN OUTREC AND/OR   16250019
*        ERROR EXIT IS SPECIFIED,AND/OR WHEN THE SYSUT2 AND/OR SYSUT3   16300019
*        DD STATEMENTS ARE MISSING.                                     16350019
         SPACE 4                                                        16400019
TCR070   TM    EXITS,ERREXT        ERROR EXIT SPECIFIED ?               16450019
         BZ    TCR075              BRANCH IF NO                         16500019
         NI    TSW862+1,NOP        SET ERROR EXIT SWITCHES              16550019
         NI    TSW992+1,NOP                                             16600019
         B     TCR080              BYPASS THE ERROPT CHECK              16650019
TCR075   TM    PARM2,NOERR         ERROPT = NOERR ?                     16700019
         BZ    TCR080              BRANCH IF NO                         16750019
         OI    TSW878+1,BRANCH     SET NOERR SWITCH                     16800019
TCR080   TM    EXITS,OUTEXT        OUTREC EXIT SPECIFIED ?              16850019
         BZ    TCR085              BRANCH IF NO                         16900019
         NI    TSW880+1,NOP        SET OUTREC EXIT SWITCHES             16950019
         NI    TSW994+1,NOP                                             17000019
TCR085   TM    NODDCARD,NOUT2      SYSUT2 DD CARD MISSING ?             17050019
         BZ    TCR090              BRANCH IF NO                         17100019
         OI    TSW900+1,BRANCH     SET SYSUT2-DD-MISSING SWITCH         17150019
TCR090   TM    NODDCARD,NOUT3      SYSUT3 DD CARD MISSING ?             17200019
         BZ    TCR095              BRANCH IF NO                         17250019
         OI    TSW935+1,BRANCH     SET SYSUT3-DD-MISSING SWITCH         17300019
TCR095   LA    R12,TSW315          SET RETURN ADDRESS FROM READ-ROUTINE 17350019
         ST    R1,TRTTABLE         STORE ADDRESS OF TRT TABLE           17400019
         TITLE ' IEBTCR05 - READ/EDIT MODULE -- READ ROUTINE'           17450019
*        THIS SECTION IS ENTERED (ONLY FOR MTDI WITH EDIT) WHEN THE     17500019
*        INPUT BUFFER IS EMPTY AND AN ED OR GS CODE TERMINATED THE      17550019
*        PREVIOUS READ. IF A START-OF-RECORD IS EXPECTED,NORMAL         17600019
*        PROCESSING CONTINUES;HOWEVER,IF NOT,THEN AN EOR MUST BE        17650019
*        FORCED ON THIS RECORD BEING PROCESSED (UNLESS IT IS TO BE      17700019
*        DELETED).                                                      17750019
         SPACE 4                                                        17800019
TSW100   NOP   TCR102              NOP IF MTDI WITH EDIT,ELSE BRANCH    17850019
TSW101   B     TCR102              NOP IF ED/GS SW IS ON; BR IF NOT ON  17900019
         OI    TSW101+1,BRANCH     TURN OFF ED/GS SW. (MAKE IT A BR)    17950019
         CLI   TSW315+1,NOP        IS SOR EXPECTED                      18000019
         BE    TCR102              BRANCH IF SOR IS EXPECTED            18050019
         TM    SWITCH1,DELETE      IS THIS RECORD BEING DELETED?        18100019
         BZ    TCR615              BRANCH IF NO TO FORCE END OF RECORD  18150019
         NI    TSW315+1,NOP        ELSE SET SOR-EXPECTED SWITCH ON      18200019
         NI    SWITCH1,NORMAL      TURN OFF DELETE SWITCH               18250019
TCR102   L     R5,CCWADDR          GET CCW ADDRESS                      18300019
         EJECT                                                          18350019
*        THIS SECTION IS ENTERED IMMEDIATELY AFTER THE FIRST EXCP       18400019
*        INSTRUCTION FOR EACH TAPE;AND THEREAFTER ONLY WHEN PROCESSING  18450019
*        IS COMPLETED ON THE DATA FROM A PREVIOUS READ (EXCP).          18500019
         SPACE 4                                                        18550019
TCR103   WAIT  ECB=TCRECB          WAIT FOR PREVIOUS READ,IF NEEDED     18600019
         NI    SWITCH2,X'FF'-EXCP  INDICATE EXCP COMPLETED              18650019
         CLI   TCRECB,NORMAL       NORMAL INTERRUPT?                    18700019
         BNE   TCR105              BRANCH IF NO                         18750019
TSW104   NOP   TCR110              NOP FOR FIRST TIME THRU,ELSE BRANCH  18800019
         OI    TSW104+1,BRANCH     CHANGE FIRST-TIME SWITCH TO BRANCH   18850019
         L     R2,MOUNTID                                               18900019
         DOM   MSG=(R2)            DELETE MOUNT MESSAGE (MCS FEATURE)   19000019
         B     TCR110              CONTINUE PROCESSING                  19150019
TCR105   CLI   TCRECB,INTRCEPT     INTERCEPT CONDITION ?                19200019
         BE    TCR106              BRANCH IF YES                        19250019
         CLI   TCRECB,PERMERR      PERMANENT ERROR ?                    19300019
         BE    TCR107              BRANCH IF YES                        19350019
TCR106   OI    ERRIND,TROUBLE      SET READ/EDIT ERR SW FOR TROUBLE     19400019
         B     TCR995              THEN BRANCH TO ABNORMAL END          19450019
TCR107   TM    STATUS+1,CDC+CCC+ICC  CHANNEL ERRORS ?                   19500019
         BNZ   TCR106              BRANCH IF YES TO QUIT                19550019
         TM    STATUS+1,PROGRAM+PROTECT  PROG OR PROTECTION CHECKS ?    19600019
         BNZ   TCR106              BRANCH IF YES TO QUIT                19650019
         TM    STATUS,UNITCHK      UNIT CHECK ?                         19700019
         BZ    TCR108              BRANCH IF NO                         19750019
         TM    SENSE,DATACHK       DATA CHECK ?                         19800019
         BZ    TCR106              BRANCH IF NO                         19850019
         TM    SENSE,MULTERR       ARE THERE MULTIPLE ERRORS ?          19900019
         BNZ   TCR106              BRANCH IF YES                        19950019
         OI    SWITCH2,DATACHK     INDICATE DATA CHECK ON THIS READ     20000019
         B     TCR109              SKIP UNIT EXCEPTION CHECK            20050019
TCR108   TM    STATUS,UNITEXC      UNIT EXCEPTION ?                     20100019
         BZ    TCR106              BRANCH IF NO TO QUIT, ELSE           20150019
         OI    SWITCH2,UNITEXC     INDICATE UNIT EXCEPTION ON THIS READ 20200019
TCR109   MVI   IOBFLG1,TWO         RESET            * THIS IS           20250019
         MVI   IOBFLG2,ZERO            IOB          * NECESSARY         20300019
         MVI   IOBFLG3,ZERO              FLAGS      * TO ALLOW          20350019
         LA    R6,TCRDCB                            * ANOTHER EXCP      20400019
         USING IHADCB,R6                            * INSTRUCTION       20450019
         MVI   DCBIFLGS,ZERO       RESET DCB IFLAGS * TO BE             20500019
         DROP  R6                                   * VALIDLY EXECUTED  20550019
TCR110   MVI   TCRECB,ZERO         ZERO THE ECB COMPLETE BIT            20600019
         EJECT                                                          20650019
*        THIS SECTION IS ENTERED AFTER EVERY WAIT INSTRUCTION. IF EOT   20700019
*        CONDITION IS ON,SOME INITIALIZATION MUST BE DONE FOR MTDI WITH 20750019
*        EDIT. IF UNIT EXCEPTION WAS DETECTED WITH THE EOT CONDITION ON 20800019
*        IT MEANS THAT IT HAPPENED ON A REWIND AND UNLOAD COMMAND.      20850019
*        (THIS RESULTS IN A EOF CONDITION FOR THE 2495). THEREFORE, THE 20900019
*        FINAL BUFFER MUST BE SENT TO THE PROPER OUTPUT DATA SET BEFORE 20950019
*        TERMINATING. IF UNIT EXCEPTION WAS NOT DETECTED ON THE REWIND  21000019
*        AND UNLOAD COMMAND, THEN ANOTHER TAPE IS READY TO BE READ, SO  21050019
*        EXCP IS ISSUED.                                                21100019
         SPACE 4                                                        21150019
TSW113   NOP   TCR120              NOP IF EOT OR 1ST TIME THRU.ELSE BR  21200019
TSW114   NOP   TCR116              NOP IF MTDI WITH EDIT,ELSE BRANCH    21250019
         MVI   PLCNT,ZERO          ZERO THE PROGRAM LEVEL               21300019
         MVC   PLCNT+1(15),PLCNT                LENGTH SAVE AREAS       21350019
         OI    SWITCH1,NODUP       PREVENT DUPING IN FIRST RECORD       21400019
         MVI   SAVELS,LS0          RESET THE PREVIOUS LEVEL STATUS      21450019
TCR116   TM    SWITCH2,UNITEXC     WAS UNIT EXCEPTION POSTED?           21500019
         BZ    TCR118              BRANCH IF NO                         21550019
         L     R5,NXTAVAIL         IF YES,RESET R5 TO 'PUT' FINAL BFR   21600019
         OI    TSW927+1,BRANCH     SET BRANCH TO END-UTILITY            21650019
         C     R5,STARTREC         ANY BYTES IN FINAL BUFFER ?          21700019
         BNE   TCR850              IF YES,BRANCH TO 'PUT' FINAL BUFFER  21750019
         B     TSW992              ELSE, BRANCH TO NORMAL END           21800019
TCR118   OI    TSW113+1,BRANCH     TURN OFF END OF TAPE  (EOT) SWITCH   21850019
         MVI   0(R5),READ          RE-LOAD TCR READ COMMAND             21900019
         OI    SWITCH2,EXCP        INDICATE EXCP ISSUED                 21950019
         EXCP  TCRIOB                                                   22000019
         B     TCR103              BRANCH TO WAIT                       22050019
         EJECT                                                          22100019
*        THIS SECTION IS ENTERED AFTER EVERY NORMAL READ COMMAND.       22150019
*        THE INPUT RECORD LENGTH IS COMPUTED AND THE INPUT POINTERS     22200019
*        ARE SET. IF A DATA CHECK WAS DETECTED,IT IS REPLACED WITH THE  22250019
*        REPLACE CHARACTER,AND A CHECK FOR DOUBLE DATA CHECK IS MADE.   22300019
*        WHEN ALL CHECKING IS DONE, THE CCWS ARE SWAPPED FOR THE NEXT   22350019
*        EXCP INSTRUCTION.                                              22400019
         SPACE 4                                                        22450019
TCR120   LH    R6,CNTFLD(R5)       LOAD CCW COUNT                       22500019
         SH    R6,RESIDUAL         CCW CNT - RESIDUAL CNT = RCD LNG     22550019
         L     R7,0(R5)            LOAD INPUT BUFFER ADDRESS            22600019
         LA    R7,0(R7)            CLEAR HIGH ORDER BYTE                22650019
         BCTR  R7,0                INPUT BUFFER - 1                     22700019
         ST    R7,INPUTPTR         STORE IT FOR SCAN                    22750019
         AR    R7,R6               BUFFER-1  +  LENGTH = END OF BUFFER  22800019
         TM    SWITCH2,DATACHK     WAS READ STOPPED BY A DATA CHECK?    22850019
         BNO   TCR130              BRANCH IF NO                         22900019
         MVC   0(1,R7),REPLACE     INSERT REPLACE CHARACTER             22950019
         NI    SWITCH2,X'FF'-DATACHK                                    23000019
TSW125   NOP   TCR128              NOP IF MTDI WITH EDIT,ELSE BRANCH    23050019
         CH    R6,TCON1            RECORD LENGTH = 1 ?                  23100019
         BH    TCR128              BRANCH IF NO                         23150019
         TM    SWITCH1,DATACHK     WAS LAST READ ALSO TERM BY DATA CHK? 23200019
         BZ    TCR128              BRANCH IF NO                         23250019
         OI    SWITCH1,TWOCHKS     INDICATE 2 SUCCESSIVE DATA CHECKS    23300019
TCR128   OI    SWITCH1,DATACHK     TURN ON DATA CHECK SWITCH            23350019
         B     TCR131              BYPASS NO-DATA-CHECK INDICATION      23400019
TCR130   NI    SWITCH1,NODATCHK    INDICATE NO DATA CHECK               23450019
TCR131   XI    TSW132,SWAP         CHANGE ADD TO SUB  OR  SUB TO ADD    23500019
TSW132   SH    R5,TCON8            CALCULATE NEXT CCW ADDR              23550019
         ST    R5,CCWADDR          STORE IT IN IOB                      23600019
         EJECT                                                          23650019
*        IF UNIT EXCEPTION IS DETECTED AND IT IS CAUSED BY AN ED OR ST  23700019
*        CODE, THEN A REWIND AND UNLOAD COMMAND IS ISSUED. OTHERWISE    23750019
*        ANOTHER READ COMMAND IS ISSUED.                                23800019
         SPACE 4                                                        23850019
         TM    SWITCH2,UNITEXC     WAS UNIT EXCEPTION POSTED?           23900019
         BNO   TCR160              BRANCH IF NO                         23950019
         NI    SWITCH2,X'FF'-UNITEXC    TURN OFF UNIT EXCEPTION SWITCH  24000019
TSW140   NOP   TCR150              NOP IF TYPE=MTDI    BR IF TYPE=MTST  24050019
         NI    TSW101+1,NOP        SET ED/GS SWITCH ON (NOP)            24100019
         CLI   0(R7),MTDIGS        WAS UE CAUSED BY GS CODE?            24150019
         BNE   TCR150              BR IF NO                             24200019
TSW148   B     TCR163              NOP IF EDIT=NOEDIT, ELSE    DROP GS  24250019
         B     TCR160              GO INCLUDE THE GS CODE               24300019
TCR150   NI    TSW113+1,NOP        SET EOT SWITCH ON (SET TO NOP)       24350019
         MVI   0(R5),REWIND        LOAD REWIND/UNLOAD COMMAND IN CCW    24400019
         B     TCR163              BRANCH TO DROP END DATA CODE         24450019
TCR160   LA    R7,1(R7)            ADDR OF BUFFER END + 1               24500019
TCR163   ST    R7,INPUTEND         STORE IT FOR SCAN                    24550019
         OI    SWITCH2,EXCP        INDICATE EXCP ISSUED                 24600019
         EXCP  TCRIOB                                                   24650019
         SPACE 10                                                       24700019
*        THIS SECTION INCREMENTS THE INPUT BUFFER POINTER.              24750019
         SPACE 2                                                        24800019
TCR200   L     R3,INPUTPTR         POINT TO                             24850019
         LA    R3,1(R3)              NEXT BYTE IN                       24900019
         ST    R3,INPUTPTR             INPUT BUFFER                     24950019
         ST    R3,FRSTSCAN         STORE SCAN START ADDRESS             25000019
         C     R3,INPUTEND         ANY BYTES LEFT IN BUFFER?            25050019
         BCR   LOW,R12             BR IF YES TO CALLER                  25100019
         B     TSW100              NO,BRANCH TO READ RTN                25150019
         TITLE ' IEBTCR05 - READ/EDIT MODULE -- SCAN ROUTINE'           25200019
*        THE SCAN ROUTINE IS ALWAYS ENTERED AT TCR310. AFTER SUCESS-    25250019
*        FULLY POINTING TO THE NEXT BYTE IN THE INPUT BUFFER,A CHECK    25300019
*        IS MADE TO SEE IF A SOR IS EXPECTED. IF NOT,NORMAL SCANNING    25350019
*        CONTINUES. IF AN SOR IS EXPECTED,A SPECIAL SCAN IS MADE FOR    25400019
*        THE SOR CHARACTER. THIS IS DONE BY MODIFYING THE IMMEDIATE     25450019
*        OPERAND OF THE CLI INSTRUCTION AT TSW322 TO COMPARE AGAINST    25500019
*        THE 8 PROGRAM LEVEL CODES. IF THE BYTE IS NOT A VALID SOR      25550019
*        CODE,THE PROPER INDICATORS ARE SET AND NORMAL SCANNING         25600019
*        CONTINUES. TSW315 WILL ALWAYS BE A BRANCH IF MTST OR           25650019
*        MTDI WITH NOEDIT IS SPECIFIED. FOR MTDI WITH EDIT, IT IS       25700019
*        INITIALLY A NOP.                                               25750019
         SPACE 4                                                        25800019
TCR310   BAL   R12,TCR200          POINT TO NEXT BYTE IN BUFFER         25850019
TSW315   NOP   TCR340              NOP IF SOR EXPECTED      BR IF NOT   25900019
         OI    TSW315+1,BRANCH     TURN OFF SOR-EXPECTED SWITCH         25950019
         MVI   EDWLS,LS0           RESET LEVEL STATUS                   26000019
         MVI   EDWTS,ZERO          RESET TYPE STATUS                    26050019
         NI    SWITCH1,RESET       RESET LEFT ZERO SWITCHES             26100019
         TM    SWITCH2,FRAGMENT    PROCESSING SHORT RECORD ? (EDITD)    26150019
         BZ    TCR319              BRANCH IF NO                         26200019
         NI    SWITCH2,X'FF'-FRAGMENT                                   26250019
         MVI   SAVELS,LS0          RESET PREVIOUS LEVEL STATUS          26300019
         OI    SWITCH1,NODUP       TURN OFF DUP ALLOW SWITCH            26350019
TCR319   LA    R5,MTDIPL1-1        INITIALIZE SCAN FOR PL CODES         26400019
TCR320   LA    R5,1(R5)                                                 26450019
         STC   R5,TSW322+1         INCREMENT IMMEDIATE OPERAND OF CLI   26500019
TSW322   CLI   0(R3),MTDIPL1       IS THIS BYTE A PL CODE ?             26550019
         BE    TCR610              BRANCH IF YES                        26600019
         CLI   TSW322+1,MTDIPL8    HAS SCAN CHECKED FOR ALL PL CODES ?  26650019
         BNE   TCR320              IF NO, CHECK NEXT PL CODE            26700019
         CLI   0(R3),MTDICAN       IS THIS BYTE A CANCEL CODE ?         26750019
         BE    TCR330              BRANCH IF YES                        26800019
         OI    EDWTS,SOREOR        INDICATE SOR/EOR ERR IN TYPE STATUS  26850019
         MVI   EDWLS,LS1           INDICATE LEVEL STATUS ERROR          26900019
         MVI   EDWSOR,BADSOR       MOVE '0E' TO SOR IN EDW              26950019
TSW328   NOP   TCR810              NOP IF EDITD; ELSE MOVE INVALID SOR  27000019
         B     TCR310              BRANCH TO CONTINUE SCAN              27050019
TCR330   OI    SWITCH1,DELDUP      SET DELETE SW; TURN OFF DUP ALLOW SW 27100019
         MVI   SAVELS,LS0          RESET PREVIOUS LEVEL STATUS          27150019
         B     TCR310              BRANCH TO CONTINUE SCAN              27200019
         EJECT                                                          27250019
*        THIS SECTION DOES THE ACTUAL SCANNING OF THE INPUT BUFFER      27300019
*        BY USE OF A TRT INSTRUCTION (EXCEPT FOR NOEDIT OR NOTRAN).     27350019
*        AFTER THE TRT,REG 2 IS USED IN A BRANCH TABLE TO BRANCH TO     27400019
*        THE PROPER ROUTINE TO PROCESS THE SPECIAL CHARACTER THAT       27450019
*        STOPPED THE TRT.                                               27500019
         SPACE 4                                                        27550019
TCR340   L     R8,INPUTEND         GET BUFFER END + 1                   27600019
         SR    R8,R3               GET LENGTH OF BUFFER REMAINING       27650019
         CH    R8,TCON256          MORE THAN 256 BYTES LEFT?            27700019
         BNH   TCR345              BRANCH IF NO                         27750019
         LH    R8,TCON256          SET LENGTH = 256                     27800019
TCR345   BCTR  R8,0                DECREMENT LENGTH FOR TRT INST        27850019
         LR    R5,R3               GET ADDR OF FIRST BYTE SCANNED       27900019
         AR    R5,R8               ADD SCAN LENGTH - 1                  27950019
         ST    R5,INPUTPTR         STORE AS BFR PTR IF NO SPECIAL CODES 28000019
         ST    R5,LASTSCAN         STORE LAST SCAN BYTE                 28050019
TSW347   NOP   TCR360              BR IF NOTRAN OR NOEDIT,ELSE NOP      28100019
         SR    R2,R2               CLEAR R2 FOR BRANCH CODE FROM TRT    28150019
         L     R7,TRTTABLE         GET TRT TABLE ADDRESS                28200019
         EX    R8,TCR350           EXECUTE TRT                          28250019
         BZ    TCR360              BRANCH IF NO SPECIAL CODES FOUND     28300019
         ST    R1,INPUTPTR         STORE SCAN END AS INPUT BUFFER PTR   28350019
         LR    R3,R1               SET R3 LIKEWISE                      28400019
         TM    SWITCH1,DELETE      IS THIS RECORD BEING DELETED ?       28450019
         BZ    TCR349              BRANCH IF NO                         28500019
         CH    R2,HEXEOR           ELSE,IS THIS END OF DELETED RECORD?  28550019
         BL    TCR310              BR TO SCAN IF VOK,RM,OR SOR          28600019
TCR349   B     TCR349(R2)          BR TO BRANCH TABLE FOR SPECIAL CODES 28650019
         B     TCR420              LEFT ZERO FILL                       28700019
         B     TCR500              DUP                                  28750019
         B     TCR400              LEFT ZERO START                      28800019
         B     TCR620              CANCEL                               28850019
         B     TCR650              VERIFY OK OR RECORD MARK             28900019
         B     TCR600              PROGRAM LEVEL CODE                   28950019
         B     TCR390              FD,AS,SW                             29000019
         B     TCR370              SRC                                  29050019
         SPACE 2                                                        29100019
TCR350   TRT   0(0,R3),0(R7)                                            29150019
         EJECT                                                          29200019
*        THIS SECTION IS ENTERED WHEN NO SPECIAL CODES ARE DETECTED BY  29250019
*        THE SCAN TRT OR WHEN EITHER NOTRAN OR NOEDIT IS SPECIFIED.     29300019
         SPACE 2                                                        29350019
TCR360   TM    SWITCH1,DELETE      IS THIS RECORD BEING DELETED ?       29400019
         BO    TCR310              BRANCH IF YES TO CONTINUE SCAN       29450019
         L     R3,LASTSCAN         GET ADDR OF LAST SCAN BYTE           29500019
         L     R6,INPUTEND         IS LAST SCAN BYTE                    29550019
         BCTR  R6,0                     ALSO THE LAST BYTE              29600019
         CR    R6,R3                      IN THE INPUT BUFFER?          29650019
         BNE   TCR810              BR IF NO TO MOVE RTN                 29700019
         TM    SWITCH1,DATACHK     YES,WAS IT A DATA CHECK?             29750019
         BZ    TCR810              BR IF NO TO MOVE RTN                 29800019
         OI    SWITCH1,MOVEDC      INDICATE DATA CHECK TO BE MOVED      29850019
         B     TCR810              BR TO MOVE RTN                       29900019
         SPACE 2                                                        29950019
*        THIS SECTION REDUCES AN MTST REFERENCE CODE TO A SINGLE SRC    30000019
*        CODE. IT IS ENTERED (AT TCR370) WHEN A SRC CODE IS DETECTED    30050019
*        BY THE SCAN TRT. IT IS NOT ENTERED IF NOTRAN IS SPECIFIED.     30100019
         SPACE 2                                                        30150019
TCR370   BAL   R12,TCR811          CALL MOVE RTN TO MOVE TO INCLUDE SRC 30200019
         LH    R7,ENDREF           SET MAX LNG  TO END OF REF CODE      30250019
TCR375   BAL   R12,TCR200          POINT TO NEXT BYTE IN BUFFER         30300019
         L     R6,INPUTEND         IS LAST SCAN BYTE                    30350019
         BCTR  R6,0                     ALSO THE LAST BYTE              30400019
         CR    R6,R3                      IN THE INPUT BUFFER?          30450019
         BNE   TCR380              BR IF NO                             30500019
         TM    SWITCH1,DATACHK     YES,WAS IT A DATA CHECK?             30550019
         BO    TCR385              BR IF YES TO CHECK NEXT BYTE         30600019
TCR380   CLI   0(R3),MTSTREF       NO,WAS IT A REFERENCE FILL CODE?     30650019
         BE    TCR385              BR IF YES                            30700019
         CLI   0(R3),MTSTLSRC      NO,WAS IT A LOWER CASE SRC ?         30750019
         BE    TCR385              BR IF YES                            30800019
         CLI   0(R3),MTSTUSRC      NO,WAS IT AN UPPER CASE SRC ?        30850019
         BE    TCR385              BR IF YES                            30900019
         CLI   0(R3),MTSTLCR       NO,WAS IT A LOWER CASE CARRIER RET?  30950019
         BE    TCR310              BR IF YES  (END OF REF CODE)         31000019
         CLI   0(R3),MTSTUCR       NO,WAS IT AN UPPER CASE CARRIER RET? 31050019
         BE    TCR310              BR IF YES  (END OF REF CODE)         31100019
         BCTR  R3,0                DECREMENT BUFFER PTR  FOR RE-SCAN    31150019
         ST    R3,INPUTPTR         STORE IT AS INPUT BUFFER PTR         31200019
         B     TCR310              BR TO SCAN                           31250019
TCR385   BCT   R7,TCR375           BR IF NOT END OF REF CODE            31300019
         B     TCR310              BR TO SCAN                           31350019
         SPACE 2                                                        31400019
*        THIS SECTION DROPS A FD,SW,OR AS CODE WHEN DETECTED BY THE     31450019
*        SCAN TRT. IT IS NOT ENTERED IF NOTRAN IS SPECIFIED.            31500019
         SPACE 2                                                        31550019
TCR390   BCTR  R3,0                DECREMENT BUFFER PTR TO DROP CODE    31600019
         B     TCR810              BR TO MOVE RTN                       31650019
         EJECT                                                          31700019
*        THIS SECTION PROCESSES A LEFT ZERO START CODE. IT IS ENTERED   31750019
*        (AT TCR400) WHEN A LZS CODE IS DETECTED BY THE SCAN TRT.       31800019
         SPACE 2                                                        31850019
TCR400   BCTR  R3,0                DECR BUFFER PTR TO SKIP LZS CODE     31900019
         MVI   LZCNT+1,ZERO        RESET LEFT ZERO FILL COUNT           31950019
         BAL   R12,TCR811          MOVE ALL BYTES UP TO LZS CODE        32000019
         L     R8,NXTAVAIL         SAVE LOCATION                        32050019
         ST    R8,LZFLD                          FOR LZ FIELD           32100019
         OI    SWITCH1,LZSTART     SET LZS SWITCH                       32150019
         B     TCR310              BRANCH TO CONTINUE SCAN              32200019
         SPACE 10                                                       32250019
*        THIS SECTION PROCESSES A LEFT ZERO FILL CODE. IT IS ENTERED    32300019
*        (AT TCR420) WHEN A LZF CODE IS DETECTED BY THE SCAN TRT.       32350019
         SPACE 2                                                        32400019
TCR420   TM    SWITCH1,LZSTART     LZS SWITCH ON ?                      32450019
         BZ    TCR450              BRANCH IF NO                         32500019
TCR422   LH    R2,LZCNT            INCREMENT                            32550019
         LA    R2,1(R2)                      LZ FILL                    32600019
         STH   R2,LZCNT                              COUNT              32650019
         MVC   0(1,R3),REPLACE     REPLACE LZ FILL; INDICATE LZ FLD ERR 32700019
         OI    SWITCH1,LZERR       IN CASE JUSTIFICATION FAILS          32750019
         BAL   R12,TCR811          MOVE ALL SCANNED INCLUDING LZ FILL   32800019
         TM    SWITCH1,LZSTART     LZS SWITCH ON ?                      32850019
         BZ    TCR310              BRANCH IF NO TO RESCAN               32900019
         BAL   R12,TCR200          POINT TO NEXT BYTE IN INPUT BUFFER   32950019
         CLI   0(R3),MTDILZF       IS THIS BYTE ALSO A LZ FILL          33000019
         BE    TCR422              BR IF YES TO CONTINUE LZ FILL SCAN   33050019
         BCTR  R3,0                DECR BUFFER PTR TO RE-SCAN IT        33100019
         ST    R3,INPUTPTR         STORE IT                             33150019
         NI    SWITCH1,RESET       RESET LEFT ZERO SWITCHES             33200019
         L     R5,NXTAVAIL         GET ADDR OF END OF LZ FIELD + 1      33250019
         L     R2,LZFLD            GET ADDR OF START OF LZ FIELD        33300019
         SR    R5,R2               GET FIELD LENGTH                     33350019
         CH    R5,LZMAX            FIELD LENGTH GREATER THAN 15 ?       33400019
         BNH   TCR430              BRANCH IF NO TO JUSTIFY              33450019
         OI    EDWTS,FIELD         SET FIELD ERROR IN TYPE STATUS       33500019
         B     TCR310              BRANCH TO CONTINUE SCAN              33550019
         EJECT                                                          33600019
*        THIS SECTION PERFORMS LEFT ZERO JUSTIFICATION. IT IS ENTERED   33650019
*        (AT TCR430) AT THE COMPLETION OF A LEFT ZERO FIELD,PROVIDED    33700019
*        THE FIELD IS NOT LONGER THAN 15 CHARACTERS.                    33750019
         SPACE 2                                                        33800019
TCR430   LH    R4,LZCNT            GET COUNT OF LEFT ZERO FILL CODES    33850019
         BCTR  R5,0                DECREMENT COUNT FOR MVC INST         33900019
         SR    R5,R4               GET NO. OF SIGNIFICANT DIGITS        33950019
         LR    R6,R2               GET ADDRESS OF START OF LZ FIELD     34000019
         AR    R6,R4               ADD SPACE FOR LZ FILLS               34050019
         EX    R5,TCR440           MOVE SIGNIFICANT DIGITS TO HOLDAREA  34100019
         EX    R5,TCR442           MOVE THEM BACK RIGHT JUSTIFIED       34150019
TCR435   MVI   0(R2),LS0           INSERT A LEADING ZERO                34200019
         LA    R2,1(R2)            INCREMENT THRU LZ FIELD              34250019
         BCT   R4,TCR435                UNTIL FIRST SIGNIFICANT DIGIT   34300019
         STH   R4,LZCNT            RESET LZ FILL COUNTER                34350019
         B     TCR310              BRANCH TO CONTINUE SCAN              34400019
         SPACE 2                                                        34450019
TCR440   MVC   LZSAVE(0),0(R2)                                          34500019
TCR442   MVC   0(0,R6),LZSAVE                                           34550019
         SPACE 10                                                       34600019
*        THIS SECTION SETS FIELD ERROR IN THE TYPE STATUS (OF EDW)      34650019
*        IF DUPLICATION OR LEFT ZERO JUSTIFICATION DOES NOT OCCUR.      34700019
*        IT IS ENTERED (AT TCR450) FROM THE LZF SECTION (NEAR TCR420),  34750019
*        AND FROM THE DUP SECTION (NEAR TCR500).                        34800019
         SPACE 2                                                        34850019
TCR450   MVC   0(1,R3),REPLACE     REPLACE FIELD ERROR BYTE             34900019
         OI    EDWTS,FIELD         SET FIELD ERROR IN TYPE STATUS       34950019
         B     TCR810              MOVE ALL BYTES UP TO & INCL ERR BYTE 35000019
         EJECT                                                          35050019
*        THIS SECTION PROCESSES DUP CODES. IT IS ENTERED (AT TCR500)    35100019
*        WHEN A DUP CODE IS DETECTED BY THE SCAN TRT.                   35150019
         SPACE 2                                                        35200019
TCR500   NI    SWITCH1,RESET       RESET LEFT ZERO SWITCHES             35250019
         BCTR  R3,0                DECR INPUT PTR  TO RE-SCAN DUP CODE  35300019
         ST    R3,INPUTPTR         STORE IT                             35350019
         BAL   R12,TCR811          MOVE ALL BYTES UP TO DUP CODE        35400019
         CLI   TSW315+1,NOP        SOR EXPECTED NOW ?                   35450019
         BE    TCR310              IF YES, BR TO RE-SCAN SOR POSITION   35500019
         BAL   R12,TCR200          POINT TO DUP CODE AGAIN              35550019
         OI    SWITCH1,DUPCODE     SET DUP-ENCOUNTERED SWITCH           35600019
         TM    SWITCH1,NODUP       IS DUP ALLOWED ?                     35650019
         BO    TCR450              BRANCH IF NO                         35700019
         L     R5,NXTAVAIL         GET POSITION OF DUP CODE             35750019
         C     R5,PREVLB           IS DUP BEYOND END OF PREV RCD        35800019
         BNL   TCR450              BRANCH IF YES                        35850019
         CLC   0(1,R5),REPLACE     IS BYTE TO BE DUPED A REPLACE CHAR ? 35900019
         BE    TCR450              BRANCH IF YES                        35950019
         MVC   0(1,R3),0(R5)       PERFORM DUPLICATION                  36000019
         B     TCR810              GO MOVE THE DUPED CHARACTER          36050019
         EJECT                                                          36100019
*        THIS SECTION PROCESSES SOR POSITIONS. IT IS ENTERED AT         36150019
*        ONE OF FOUR PLACES:                                            36200019
*              TCR600 - IF A PL CODE IS DETECTED BY THE SCAN TRT. THIS  36250019
*                       WILL OCCUR ONLY WHEN THE PREVIOUS RECORD DOES   36300019
*                       NOT HAVE A VALID END-OF-RECORD CHARACTER.       36350019
*                                                                       36400019
*              TCR610 - IF A PL CODE IS FOUND WHEN IT IS EXPECTED.      36450019
*                       SEE CODE AT TSW322.                             36500019
*                                                                       36550019
*              TCR615 - IF A RECORD ENDS WITH A GS OR ED CODE WITHOUT   36600019
*                       A VALID END-OF-RECORD. SEE CODE NEAR TSW101.    36650019
*                                                                       36700019
*              TCR620 - IF A CAN CODE IS DETECTED BY THE SCAN TRT. THIS 36750019
*                       WILL OCCUR ONLY WHEN THE PREVIOUS RECORD DOES   36800019
*                       NOT HAVE A VALID END-OF-RECORD.                 36850019
         SPACE 4                                                        36900019
TCR600   TM    SWITCH1,DELETE      IS THIS RECORD BEING DELETED ?       36950019
         BO    TCR608              BRANCH IF YES                        37000019
         L     R5,INPUTPTR         IF NO, ARE THERE                     37050019
         C     R5,FRSTSCAN         ANY BYTES TO MOVE ?                  37100019
         BE    TCR618              IF NO,DROP BAD EOR FROM WORKAREA     37150019
         B     TCR620              IF YES,DONT MOVE BAD EOR TO WORKAREA 37200019
TCR608   NI    SWITCH1,NORMAL      TURN OFF DELETE SWITCH               37250019
TCR610   MVC   EDWSOR(1),0(R3)     STORE PL CODE IN SOR OF EDW          37300019
         NI    EDWSOR,HEXSOR       PUT SOR IN FORM OF HEX '0X'          37350019
TSW612   B     TCR310              NOP IF EDITR,ELSE BR TO CONT SCAN    37400019
         ST    R3,FRSTSCAN         STORE AS START OF SCAN               37450019
         B     TCR810              GO MOVE THE PL CODE                  37500019
TCR615   NI    TSW845+1,NOP        SET EOR FORCED SWITCH                37550019
TSW616   NOP   TCR640              NOP IF EDITD, BRANCH IF EDITR        37600019
TCR618   L     R5,NXTAVAIL                                              37650019
         C     R5,STARTREC         ANY BYTES TO OUTPUT ?                37700019
         BE    TCR620              BRANCH IF NO, ELSE                   37750019
         BCTR  R5,0                DECR WORKAREA ADDR SO THE BAD EOR    37800019
         ST    R5,NXTAVAIL         WONT BE RETAINED AS PART OF THE RCD. 37850019
TCR620   BCTR  R3,0                DECR INPUT PTR                       37900019
         ST    R3,INPUTPTR         STORE IT FOR RE-SCAN                 37950019
TSW625   NOP   TCR640              NOP IF EDITD,ELSE MOVE TO INCL EOR   38000019
         BCTR  R3,0                DECR INPUT PTR TO AVOID MOVING EOR   38050019
TCR640   NI    TSW315+1,NOP        SET SOR SWITCH TO EXPECT SOR (NOP)   38100019
         NI    SWITCH1,RESET       RESET LEFT ZERO SWITCHES             38150019
         OI    EDWTS,SOREOR        SET SOR/EOR ERROR IN TYPE STATUS     38200019
         MVI   EDWEOR,BADEOR       MOVE 'E' TO EOR IN EDW               38250019
         B     TCR810              GO MOVE PROPER NO. OF BYTES          38300019
         EJECT                                                          38350019
*        THIS SECTION PROCESSES VOK AND/OR RM CODES. IT IS ENTERED      38400019
*        (AT TCR650) WHEN A VOK OR RM CODE IS DETECTED BY THE SCAN TRT. 38450019
         SPACE 2                                                        38500019
TCR650   NI    SWITCH1,RESET       RESET LEFT ZERO SWITCHES             38550019
         NI    TSW315+1,NOP        SET SOR SWITCH TO EXPECT SOR  (NOP)  38600019
         TM    SWITCH1,DELETE      IS THIS RECORD BEING DELETED ?       38650019
         BZ    TCR655              BRANCH IF NO                         38700019
         NI    SWITCH1,NORMAL      TURN OFF DELETE SWITCH               38750019
         B     TCR310              BRANCH TO CONTINUE SCAN              38800019
TCR655   MVI   EDWEOR,VOK          MOVE 'V' TO EOR IN EDW  (FOR VOK)    38850019
         CLI   0(R3),MTDIVOK       IS EOR A VOK ?                       38900019
         BE    TSW662              BRANCH IF YES                        38950019
         MVI   EDWEOR,RM           MOVE 'U' TO EOR IN EDW  (FOR RM)     39000019
TSW658   B     TSW662              NOP IF VERCHK = VOKCHK,BR IF NOCHK   39050019
         OI    EDWTS,SOREOR        SET SOR/EOR ERROR IN TYPE STATUS     39100019
TSW662   NOP   TCR810              BR IF EDITR TO INCL EOR, ELSE        39150019
         BCTR  R3,0                DECR INPUT PTR TO AVOID MOVING EOR   39200019
         B     TCR810              GO MOVE PROPER NO. OF BYTES          39250019
         TITLE ' IEBTCR05 - READ/EDIT MODULE -- MOVE ROUTINE'           39300019
*        THIS ROUTINE IS ENTERED ANY TIME A SPECIAL CHARACTER IS DE-    39350019
*        TECTED,OR THE END OF SCAN AREA IS REACHED. IF AN EOR WAS       39400019
*        FORCED, CONTROL PASSES DIRECTLY TO THE OUTPUT ROUTINE. OTHER-  39450019
*        WISE THE NUMBER OF BYTES TO MOVE AND THE NUMBER OF BYTES TO    39500019
*        OUTPUT ARE CALCULATED. IF THERE ARE NO BYTES TO MOVE AND:      39550019
*           1) NO BYTES TO OUTPUT, CONTROL RETURNS TO THE CALLER.       39600019
*           2) SOME BYTES TO OUTPUT, THEN:                              39650019
*              A) IF SOR IS EXPECTED, CONTROL PASSES TO THE OUTPUT RTN. 39700019
*              B) IF SOR IS NOT EXPECTED, CONTROL RETURNS TO CALLER.    39750019
*        IF THERE ARE BYTES TO MOVE, THE SPACE AVAILABLE TO RECEIVE     39800019
*        THEM IS CALCULATED. IF ALL THE BYTES WILL FIT, ALL WILL BE     39850019
*        MOVED, ELSE ONLY ENOUGH WILL BE MOVED TO FILL THE AREA.        39900019
*                                                                       39950019
*        THIS ROUTINE IS ENTERED AT ONE OF TWO PLACES:                  40000019
*                                                                       40050019
*              TCR810 - WHEN CONTROL MUST RETURN TO THE SCAN ROUTINE.   40100019
*              TCR811 - WHEN CONTROL MUST RETURN TO THE CALLING ROUTINE 40150019
         SPACE 4                                                        40200019
TCR810   LA    R12,TCR310          SET RETURN TO SCAN RTN               40250019
TCR811   L     R5,NXTAVAIL         GET ADDR OF NEXT AVAIL IN WORKAREA   40300019
         CLI   TSW845+1,NOP        WAS EOR FORCED ?                     40350019
         BE    TCR850              BRANCH IF YES TO OUTPUT              40400019
         L     R7,FRSTSCAN         GET ADDR OF FIRST BYTE SCANNED       40450019
         LA    R4,1(R3)            GET ADDRESS OF LAST SCANNED + 1      40500019
         SR    R4,R7               GET LENGTH OF SCANNED AREA           40550019
         BP    TCR814              BRANCH IF WE HAVE BYTES TO MOVE      40600019
         C     R5,STARTREC         ELSE, CHECK FOR BYTES TO OUTPUT      40650019
         BNE   TCR813              BRANCH IF WE'VE GOT SOME             40700019
         OI    SWITCH2,FRAGMENT    IF NONE, SET POSSIBLE SHORT RCD SW   40750019
         BR    R12                 AND RETURN TO CALLER                 40800019
TCR813   CLI   TSW315+1,NOP        IF SOME, IS SOR EXPECTED ?           40850019
         BE    TCR850              BRANCH IF YES TO OUTPUT              40900019
         BR    R12                 ELSE RETURN TO CALLER                40950019
TCR814   L     R6,ENDREC           GET END OF RECORD + 1                41000019
         SR    R6,R5               NO. OF BYTES LEFT IN WORKAREA        41050019
TSW815   B     TCR816              BRANCH IF MTDI WITH EDIT, ELSE NOP   41100019
         BZ    TCR850              BRANCH TO OUTPUT IF WORKAREA FULL    41150019
TCR816   CR    R4,R6               WILL ALL SCANNED BYTES FIT?          41200019
         BNH   TCR820              BRANCH IF YES                        41250019
         LR    R4,R6               ELSE                                 41300019
         B     TSW840                   GO MOVE WHAT WE CAN             41350019
         EJECT                                                          41400019
*        THIS SECTION IS ENTERED ONLY IF ALL THE SCANNED BYTES WILL FIT 41450019
*        IN THE OUTPUT WORKAREA.                                        41500019
         SPACE 1                                                        41550019
TCR820   TM    SWITCH1,MOVEDC      DATA CHECK TO BE MOVED?              41600019
         BZ    TCR844              BRANCH IF NO                         41650019
         NI    SWITCH1,X'FF'-MOVEDC  INDICATE DC HAS BEEN MOVED         41700019
         OI    EDWTS,DATACHK       SET DATA CHECK SWITCH IN EDW         41750019
         TM    SWITCH1,TWOCHKS     TWO SUCCESSIVE DATA CHECKS ?         41800019
         BZ    TCR844              BRANCH IF NO                         41850019
         NI    SWITCH1,NODATCHK    INDICATE DBL D.C. HANDLING COMPLETE  41900019
         MVI   EDWLS,LS1           INDICATE LEVEL STATUS ERROR          41950019
         B     TCR844              GO MOVE THE SECOND DATA CHECK BYTE   42000019
         SPACE 4                                                        42050019
*        THIS SECTION IS ENTERED WHEN THERE ARE MORE BYTES TO MOVE THAN 42100019
*        SPACE REMAINING IN THE OUTPUT WORKAREA. THIS MEANS THE RECORD  42150019
*        EXCEEDED MAXLN BEFORE A VALID EOR WAS ENCOUNTERED.             42200019
         SPACE 1                                                        42250019
TSW840   NOP   TCR844              NOP IF MTDI WITH EDIT,ELSE BRANCH    42300019
         OI    EDWTS,SOREOR+LNGERR SET SOR/EOR & INCORRECT LNG IN EDW   42350019
         MVI   EDWEOR,BADEOR       MOVE 'E' TO EOR IN EDW               42400019
         NI    TSW315+1,NOP        SET SOR EXPECTED SWITCH              42450019
         NI    TSW845+1,NOP        SET EOR FORCED SWITCH                42500019
         MVI   EDWLS,LS1           INDICATE LEVEL STATUS ERROR          42550019
         TM    SWITCH1,LZERR       INCOMPLETE LEFT ZERO FIELD ?         42600019
         BZ    TCR842              BRANCH IF NO                         42650019
         OI    EDWTS,FIELD         SET FIELD ERROR IN TYPE STATUS       42700019
TCR842   NI    SWITCH1,RESET       TURN OFF LEFT ZERO SWITCHES          42750019
         SPACE 4                                                        42800019
*        THIS SECTION DOES THE ACTUAL MOVING OF DATA BYTES FROM THE     42850019
*        INPUT BUFFER TO THE OUTPUT WORKAREA,AND UPDATES THE POINTERS.  42900019
         SPACE 1                                                        42950019
TCR844   LTR   R4,R4               ANY BYTES TO MOVE ?                  43000019
         BZ    TSW845              IF NO, SKIP MOVE CODE                43050019
         BCTR  R4,0                DECREMENT LENGTH FOR MVC INST        43100019
         EX    R4,TCR848           MOVE SOME BYTES                      43150019
         LA    R4,1(R4)            RESTORE LENGTH                       43200019
         AR    R5,R4               COMPUTE NEXT AVAIL BYTE IN WORKAREA  43250019
         ST    R5,NXTAVAIL         SAVE IT                              43300019
         AR    R7,R4               COMPUTE NEXT BYTE TO BE MOVED        43350019
         ST    R7,FRSTSCAN         SAVE IT                              43400019
TSW845   B     TCR811              NOP IF EOR FORCED, ELSE BR TO MOVE   43450019
TSW846   B     TCR847              BR IF EDITD TO SKIP NEXT SCAN POS    43500019
         BCTR  R7,0                IF EDITR, SCAN NEXT POS FOR EOR      43550019
TCR847   ST    R7,INPUTPTR         RESET SCAN POINTER ACCORDINGLY       43600019
         B     TCR811              GO MOVE SOME MORE                    43650019
         SPACE 2                                                        43700019
TCR848   MVC   0(0,R5),0(R7)                                            43750019
 TITLE ' IEBTCR05 - READ/EDIT MODULE -- OUTPUT PROCESSOR ROUTINE'       43800019
*        THIS ROUTINE IS CALLED BY THE MOVE ROUTINE ANY TIME THE OUT-   43850019
*        PUT WORKAREA BECOMES FULL,OR AN EOR IS DETECTED. FOR MTDI WITH 43900019
*        EDIT,CHECKS ARE MADE FOR PROGRAM LEVEL LENGTHS,MINLN, AND      43950019
*        DUP CODES. THE EDW IS PROPERLY UPDATED AND MOVED TO THE RCD.   44000019
         SPACE 2                                                        44050019
TCR850   OI    TSW845+1,BRANCH     TURN OFF EOR FORCED SWITCH           44100019
         SR    R7,R7               ZERO OUT REG 7                       44150019
         SR    R8,R8                              AND REG 8             44200019
         L     R9,NXTAVAIL         COMPUTE                              44250019
         S     R9,STARTREC                RECORD LENGTH                 44300019
         BNZ   TSW852              IF POSITIVE, GO PROCESS OUTPUT       44350019
         OI    SWITCH2,CANCEL      ELSE SET SHORT RECORD SWITCH         44400019
         B     TSW927              AND BYPASS OUTPUT                    44450019
TSW852   NOP   TCR940              BR IF MTST WITH TRANS, ELSE NOP      44500019
TSW853   NOP   TCR861              NOP IF MTDI WITH EDIT,ELSE BRANCH    44550019
TSW854   B     TCR855              NOP IF EDITR   BRANCH IF EDITD       44600019
         CH    R9,TCON3            IS RECORD LESS THAN 3 BYTES ?        44650019
         BNL   TCR855              BRANCH IF NO                         44700019
         OI    SWITCH2,CANCEL      SET SWITCH FOR RCD LESS THAN 3 BYTES 44750019
         B     TSW927              TREAT RCD AS BEING DELETED           44800019
TCR855   CLI   EDWSOR,BADSOR       WAS SOR IN ERROR ?                   44850019
         BE    TSW857              BRANCH IF YES                        44900019
         IC    R8,EDWSOR           GET SOR VALUE                        44950019
         AR    R8,R8               DOUBLE IT TO POINT TO TABLE ENTRY    45000019
         CH    R7,PLCNT-2(R8)      IS PL LENGTH COUNT SET ?             45050019
         BNE   TCR856              BRANCH IF YES                        45100019
         TM    EDWTS,TSERR         DOES RECORD HAVE AN ERROR ?          45150019
         BNZ   TSW857              BRANCH IF YES                        45200019
         STH   R9,PLCNT-2(R8)      SET LENGTH FOR THIS PL CODE          45250019
         B     TSW857              SKIP LENGTH CHECK                    45300019
TCR856   CH    R9,PLCNT-2(R8)      RECORD LENGTH = PL LENGTH ?          45350019
         BE    TSW857              BRANCH IF YES                        45400019
         OI    EDWTS,LNGERR        SET INCORRECT LENGTH IN TYPE STATUS  45450019
         MVI   EDWLS,LS1           INDICATE LEVEL STATUS ERROR          45500019
TSW857   B     TCR858              NOP IF MINLN SPECIFIED, BR IF NOT    45550019
         CH    R9,MINLN            RECORD LENGTH LESS THAN MINLN ?      45600019
         BNL   TCR858              BRANCH IF NO, ELSE                   45650019
         OI    EDWTS,LNGERR        SET INCORRECT LENGTH IN TYPE STATUS  45700019
TCR858   TM    SAVELS,LSERR        PREVIOUS LEVEL STATUS = 0 ?          45750019
         BZ    TCR860              BRANCH IF YES                        45800019
         TM    EDWLS,LSERR         PRESENT LEVEL STATUS = 0 ?           45850019
         BNZ   TCR859              BRANCH IF NO                         45900019
         TM    SWITCH1,DUPCODE     ANY DUP CODES IN THIS RECORD ?       45950019
         BZ    TCR860              BRANCH IF NO                         46000019
TCR859   MVI   EDWLS,LS2           SET LEVEL STATUS = 2                 46050019
TCR860   TR    EDWTS(2),EDWTT      TRANSLATE TYPE STAT & SOR TO EBCDIC  46100019
         L     R8,EDWADDR                                               46150019
         MVC   0(WORD,R8),EDW      MOVE EDW INTO OUTPUT RECORD          46200019
         TM    EDWLS,LSERR         LEVEL STATUS ERROR ?                 46250019
         BM    TSW862              IF YES, CHECK FOR ERROR EXIT         46300019
TCR861   TM    EDWTS,TSERR         TYPE STATUS ERROR ?                  46350019
         BZ    TSW880              IF NO, CHECK FOR OUTREC EXIT         46400019
         EJECT                                                          46450019
*        THIS SECTION HANDLES THE ERROR EXIT. THE RECORD PLUS THE EDW   46500019
*        ARE ALWAYS PASSED TO THE EXIT. IF SYSUT2 SPECIFIES VARIABLE    46550019
*        LENGTH RECORDS, THE RDW IS ALSO APPENDED. UPON RETURN, THE NEW 46600019
*        EDW AND RECORD LENGTH ARE USED. IF THE RECORD HAS BEEN FIXED:  46650019
*            1) MTDI WITH EDIT --- PL LENGTH CHECKING IS PERFORMED AND  46700019
*                                  WE GO CHECK FOR OUTREC EXIT.         46750019
*            2) MTST OR NOEDIT --- DIRECTLY GO CHECK FOR OUTREC EXIT.   46800019
*        IF THE RECORD IS STILL INCORRECT, IT IS SENT TO SYSUT3.        46850019
*        IF RETURN CODE DOES NOT = 0 OR 4, THE UTILITY IS TERMINATED    46900019
*        WITH A MESSAGE.                                                46950019
         SPACE 2                                                        47000019
TSW862   B     TSW878              NOP IF ERROR EXIT SPECIFIED,BR IF NO 47050019
         L     R6,STARTREC         SET POINTER FOR OUTPUT RECORD        47100019
TSW863   NOP   TCR864              NOP IF MTDI WITH EDIT, ELSE BRANCH   47150019
         AH    R9,TCON4            INCLUDE EDW IN RECORD LENGTH         47200019
         SH    R6,TCON4            SET POINTER TO INCLUDE EDW           47250019
TCR864   TM    UT3RECFM,NOTVAR     FIXED OR UNDEFINED RECORDS ?         47300019
         BO    TCR868              BRANCH IF YES                        47350019
         AH    R9,TCON4            INCLUDE VAR FIELD IN RECORD LENGTH   47400019
         STH   R9,RDW              SET UP VARIABLE FIELD                47450019
         SH    R6,TCON4            SET POINTER TO INCLUDE VAR FIELD     47500019
         MVC   0(WORD,R6),RDW      MOVE THE VAR FIELD INTO THE RECORD   47550019
TCR868   ST    R6,PARMLIST              SET UP PARAMETER LIST           47600019
         ST    R9,RECLEN                FOR ERROR EXIT                  47650019
         LA    R1,PARMLIST         SET UP REG 1 FOR USER ERROR EXIT     47700019
         L     R15,ERROR           LOAD ADDRESS OF USER ERROR EXIT      47750019
         BALR  R14,R15             BRANCH TO USER ERROR EXIT            47800019
         L     R1,EDWADDR                                               47850019
         MVC   EDW(WORD),0(R1)     USE NEW EDW (IF MODIFIED)            47900019
         L     R9,RECLEN           ALSO USE NEW RCD LGN (IF MODIFIED)   47950019
         L     R8,STARTREC         RESTORE R9 TO                        48000019
         S     R8,PARMLIST             LOGICAL RECORD LENGTH            48050019
         SR    R9,R8                       FOR IEBTCRIN                 48100019
         L     R5,STARTREC         COMPUTE                              48150019
         AR    R5,R9                       EOR + 1  FOR BLANK-OUT RTN   48200019
         CH    R15,TCON8           SHOULD RCD GO TO NORMAL DATA SET ?   48250019
         BE    TSW880              BRANCH IF YES TO CHECK FOR OUTREC    48300019
         CH    R15,TCON4           SHOULD RCD GO TO ERROR DATA SET ?    48350019
         BE    TCR879              BRANCH IF YES TO OUTPUT IT           48400019
         CH    R15,TCON0           SHOULD RECORD GO NOPLACE ?           48450019
         BE    TCR887              BRANCH IF YES TO SKIP OUTPUT         48500019
         MVI   EXITERR+1,ERRABORT  ELSE SET MESSAGE TABLE AND           48550019
         B     TCR990              BRANCH TO ABNORMAL END               48600019
         EJECT                                                          48650019
         SPACE 2                                                        48700019
*        THIS SECTION HANDLES THE ERROPT OPTION.                        48750019
         SPACE 2                                                        48800019
TSW878   NOP   TSW880              NOP IF ERROPT = NORMAL, BR IF NOERR  48850019
TCR879   OI    SWITCH2,SYSUT3      INDICATE SYSUT3 RECORD               48900019
         B     TSW935               AND BRANCH TO OUTPUT SYSUT3         48950019
         SPACE 6                                                        49000019
*        THIS SECTION HANDLES THE OUTREC EXIT. IF SYSUT2 SPECIFIES      49050019
*        VARIABLE LENGTH RECORDS, THE RDW IS APPENDED TO THE RECORD.    49100019
*        UPON RETURN, THE NEW RECORD LENGTH IS USED. THE RECORD IS      49150019
*        THEN SENT TO SYSUT2 UNLESS THE USER INDICATES NOT TO DO SO.    49200019
*        IF THE RETURN CODE DOES NOT = 0 OR 4, THE UTILITY IS           49250019
*        TERMINATED WITH A MESSAGE.                                     49300019
         SPACE 2                                                        49350019
TSW880   B     TSW900              NOP IF OUTREC SPECIFIED,BR IF NOT    49400019
         L     R6,STARTREC         SET POINTER FOR OUTPUT RECORD        49450019
         TM    UT2RECFM,NOTVAR     FIXED OR UNDEFINED RECORDS ?         49500019
         BO    TCR883              BRANCH IF YES                        49550019
         AH    R9,TCON4            INCLUDE VAR FIELD IN RECORD LENGTH   49600019
         STH   R9,RDW              SET UP VARIABLE FIELD                49650019
         SH    R6,TCON4            SET POINTER TO INCLUDE VAR FIELD     49700019
         MVC   0(WORD,R6),RDW      MOVE THE VAR FIELD INTO THE RECORD   49750019
TCR883   ST    R6,PARMLIST              SET UP PARAMETER LIST           49800019
         ST    R9,RECLEN                FOR OUTREC EXIT                 49850019
         LA    R1,PARMLIST         SET UP REG1 FOR USER OUTREC EXIT     49900019
         L     R15,OUTREC          LOAD ADDRESS OF USER OUTREC EXIT     49950019
         BALR  R14,R15             BRANCH TO USER OUTREC EXIT           50000019
         L     R9,RECLEN           USE NEW RCD LNG (IF MODIFIED)        50050019
         L     R8,STARTREC         RESTORE R9 TO                        50100019
         S     R8,PARMLIST             LOGICAL RECORD LENGTH            50150019
         SR    R9,R8                       FOR IEBTCRIN                 50200019
         L     R5,STARTREC         COMPUTE                              50250019
         AR    R5,R9                       EOR + 1  FOR BLANK-OUT RTN   50300019
         CH    R15,TCON4           SHOULD RCD GO TO NORMAL DATA SET ?   50350019
         BE    TSW900              BRANCH IF YES TO OUTPUT SYSUT2       50400019
         CH    R15,TCON0           SHOULD RECORD GO NOPLACE ?           50450019
         BNE   TCR890              IF NOT, THE GAME'S OVER,CHARLIE      50500019
TCR887   ST    R5,PREVLB           SAVE ADDR FOR END OF PREV RCD        50550019
TSW888   B     TSW927              BRANCH IF EDITD, ELSE                50600019
         LR    R8,R5               DECREMENT POINTER TO                 50650019
         BCTR  R8,0                AVOID POSSIBILITY OF                 50700019
         ST    R8,PREVLB           DUPING THE EOR CODE (FOR EDITR)      50750019
         B     TSW927              GO CLEAN UP                          50800019
TCR890   MVI   EXITERR+1,OUTABORT  SET MESSAGE TABLE AND                50850019
         B     TCR990              BRANCH TO ABNORMAL END               50900019
         EJECT                                                          50950019
*        THIS SECTION OPENS THE SYSUT2 (OR SYSUT3) DATA SET AND         51000019
*        CHECKS FOR ANY ADVERSE RESULTS FROM THE OPEN PROCESS.          51050019
*        IT IS ENTERED AT TSW900 FOR SYSUT2 RECORDS, AND AT             51100019
*        TSW903 (FROM TSW935) FOR SYSUT3 RECORDS.                       51150019
         SPACE 2                                                        51200019
TSW900   NOP   TSW927              BRANCH IF SYSUT2 DD MISSING,ELSE NOP 51250019
         LA    R4,UT2DCB           GET ADDRESS OF SYSUT2 DCB            51300019
         MVI   OPENERR+1,UT2OPERR  SET UP MESSAGE TABLE (JUST IN CASE)  51350019
         MVI   DCBERR+1,UT2OPERR                                        51400019
         USING IHADCB,R4           ESTABLISH DCB BASE                   51450019
TCR903   TM    DCBOFLGS,DCBOPEN    IS DCB ALREADY OPEN?                 51500019
         BO    TCR910              BRANCH IF YES                        51550019
         OPEN  ((R4),(OUTPUT))     OPEN THE DCB                         51600019
         TM    DCBOFLGS,DCBOPEN    DID DCB OPEN OK?                     51650019
         BO    TCR904              BRANCH IF YES                        51700019
         MVI   OPENERR,MSGFLAG     SET THE OPEN ERROR MESSAGE FLAG      51750019
         B     TCR991              BRANCH TO ABNORMAL END               51800019
TCR904   TM    ERRIND,BADDCB       INCONSISTENT DCB PARAMETERS ?        51850019
         BZ    TCR905              BRANCH IF NO  -  ALL OK              51900019
         MVI   DCBERR,MSGFLAG      SET DCB ERROR MESSAGE FLAG           51950019
         B     TCR991              BRANCH TO ABNORMAL END               52000019
TCR905   TM    ERRIND,DCBBIT4      PERMANENT HEADER ERROR ?    @ZA29418 52050003
         BZ    TCR907              BRANCH IF NO                         52100019
         CLI   OPENERR+1,UT3OPERR  PROCESSING SYSUT3 ?                  52150019
         BE    TCR906              BRANCH IF YES, ELSE WE HAVE SYSUT2   52200019
         MVI   EXLST2,DELETE       DELETE TLR2 EXIT REQUEST             52250019
         B     TCR995              BRANCH TO ABNORMAL END               52300019
TCR906   MVI   EXLST3,DELETE       DELETE TLR3 EXIT REQUEST             52350019
         B     TCR995              ELSE BRANCH TO ABNORMAL END          52400019
TCR907   LH    R0,DCBLRECL                                              52450019
         AH    R0,TCON8                                                 52500019
         C     R0,WORKL1           LRECL GREATER THAN CURRENT WORKAREA  52550019
         BH    TCR923              BRANCH IF YES                        52600019
TCR908   CLI   OPENERR+1,UT3OPERR  PROCESSING SYSUT3 ?                  52650019
         BE    TCR909              BRANCH IF YES, ELSE WE'RE ON SYSUT2  52700019
         MVC   UT2RECFM(1),DCBRECFM    SET RECFM FOR SYSUT2             52750019
         B     TCR910               BRANCH TO CONTINUE                  52800019
TCR909   MVC   UT3RECFM(1),DCBRECFM    SET RECFM FOR SYSUT3             52850019
TCR910   ST    R5,PREVLB               SAVE ADDR FOR END OF PREV RCD    52900019
TSW911   B     TCR912              BRANCH IF EDITD, ELSE                52950019
         LR    R2,R5               DECREMENT POINTER TO                 53000019
         BCTR  R2,0                AVOID POSSIBILITY OF                 53050019
         ST    R2,PREVLB           DUPING THE EOR CODE (FOR EDITR)      53100019
         EJECT                                                          53150019
*        THIS SECTION DOES THE ACTUAL 'PUT' FOR THE RECORD. THE         53200019
*        RECORD DESCRIPTOR WORD IS CONSTRUCTED AND INCLUDED FOR         53250019
*        VARIABLE LENGTH RECORDS. IF A PERMANENT I/O ERROR OCCURS,      53300019
*        THE UTILITY IS TERMINATED WITH A MESSAGE.                      53350019
         SPACE 2                                                        53400019
TCR912   L     R6,STARTREC         SET POINTER FOR OUTPUT RECORD        53450019
TSW914   NOP   TCR915              NOP IF MTDI WITH EDIT, ELSE BRANCH   53500019
         TM    SWITCH2,SYSUT3      IS THIS A SYSUT3 RECORD ?            53550019
         BZ    TCR915              BRANCH IF NO                         53600019
         AH    R9,TCON4            INCLUDE EDW IN RECORD LENGTH         53650019
         SH    R6,TCON4            SET POINTER TO INCLUDE EDW           53700019
TCR915   TM    DCBRECFM,NOTVAR     FIXED OR UNDEFINED RECORDS ?         53750019
         BZ    TCR918              BRANCH IF VARIABLE                   53800019
         TM    DCBRECFM,UNDEF      UNDEFINED ?                          53850019
         BZ    TCR917              BRANCH IF NO                         53900019
         CH    R9,DCBBLKSI         OUTPUT RCD GREATER THAN BLKSIZE ?    53950019
         BNH   TCR916              BRANCH IF NO  -  WE'RE OK            54000019
         LH    R9,DCBBLKSI         ELSE USE BLKSIZE FOR OUTPUT RCD LNG  54050019
TCR916   STH   R9,DCBLRECL         PUT RECORD LENGTH IN LRECL           54100019
         B     TCR922              GO OUTPUT THE RECORD                 54150019
TCR917   BAL   R14,TCR936          ELSE GO BLANK OUT REMAINING RECORD   54200019
         B     TCR922              CONTINUE                             54250019
TCR918   AH    R9,TCON4            INCLUDE VAR FIELD IN RECORD LENGTH   54300019
         CH    R9,DCBLRECL         OUTPUT RECORD GREATER THAN LRECL ?   54350019
         BL    TCR920              BRANCH IF NO.  WE'RE OK              54400019
         LH    R9,DCBLRECL         ELSE USE LRECL FOR OUTPUT RCD LNG    54450019
TCR920   STH   R9,RDW              SET UP VARIABLE FIELD                54500019
         SH    R6,TCON4            SET POINTER TO INCLUDE VAR FIELD     54550019
         MVC   0(WORD,R6),RDW      MOVE THE VAR FIELD INTO THE RECORD   54600019
TCR922   PUT   (R4),(R6)           WRITE A RECORD FROM WORKAREA         54650019
         TM    ERRIND,DCBBIT6      PERMANENT I/O ERROR ?       @ZA29418 54700003
         BZ    TSW927              IF NO, GO CLEAN UP AFTER OUTPUT      54730003
         OI    ERRIND,DCBBIT4      SET READ/EDIT ERROR SWITCH  @ZA29418 54760003
         B     TCR998              RETURN TO DRIVER MODULE              54850019
         EJECT                                                          54900019
*        THIS SECTION IS ENTERED ONLY WHEN LRECL ON THE DATA SET LABEL  54950019
*        IS GREATER THAN THE OUTPUT WORKAREA SIZE,THUS NECESSITATING A  55000019
*        GETMAIN FOR A LARGER WORKAREA. THE OLD WORKAREA IS THEN FREED  55050019
*        AFTER THE NEW POINTERS ARE SET UP.                             55100019
         SPACE 2                                                        55150019
TCR923   MVC   OLDLGTH,WORKL1      SAVE OLD WORKAREA LNG  FOR FREEMAIN  55200019
         MVC   OLDAREA,STRTWORK    SAVE OLD WORKAREA ADDR FOR FREEMAIN  55250019
         L     R5,STRTWORK         SET REG 5 = FROM-AREA                55300019
         ST    R0,WORKL1                                                55350019
         ST    R0,WORKL2                                                55400019
         GETMAIN VC,LA=WORKL1,A=GM2         GETMAIN NEW WORKAREA        55450019
         LTR   R15,R15             GETMAIN SUCCESSFUL ?                 55500019
         BNZ   TCR010              BRANCH IF NO TO INDICATE GETMAIN ERR 55550019
         L     R1,GM2                                                   55600019
         BAL   R14,TCR932          SET UP NEW WORKAREA POINTERS         55650019
         LH    R0,TCON256                                               55700019
         L     R1,STRTWORK         SET REG 1 = TO-AREA                  55750019
         LR    R6,R9               GET LENGTH OF RECORD TO MOVE         55800019
         LA    R6,8(R6)            ADD 8 TO ALLOW FOR RDW & EDW         55850019
         B     TCR926              GO SET UP FOR MOVE                   55900019
TCR924   MVC   0(0,R1),0(R5)                                            55950019
TCR925   MVC   0(256,R1),0(R5)     MOVE 256 BYTES                       56000019
         AR    R1,R0               UPDATE THE TO-POINTER                56050019
         AR    R5,R0                AND THE FROM-POINTER                56100019
TCR926   SR    R6,R0               IS LENGTH GREATER THAN 256 ?         56150019
         BP    TCR925              BRANCH IF YES                        56200019
         AR    R6,R0               RESTORE LENGTH IF LESS THAN 256      56250019
         BCTR  R6,0                DECREMENT COUNT FOR MVC INST         56300019
         EX    R6,TCR924           MOVE THE REST OF THE RECORD          56350019
         L     R5,STARTREC                                              56400019
         AR    R5,R9               COMPUTE NEXT AVAIL BYTE IN NEW AREA  56450019
         L     R0,OLDLGTH                                               56500019
         L     R1,OLDAREA                                               56550019
         FREEMAIN R,LV=(0),A=(1)   FREE THE OLD WORKAREA                56600019
         B     TCR908              CONTINUE NORMAL PROCESSING           56650019
         EJECT                                                          56700019
*        THIS SECTION RE-INITIALIZES VARIOUS POINTERS AND THE EDW FOR   56750019
*        THE NEXT RECORD. IT IS ENTERED AFTER EVERY RECORD IS OUTPUT.   56800019
*        REG 7 = ZERO AT ENTRY.                                         56850019
         SPACE 2                                                        56900019
TSW927   NOP   TSW992              NOP UNTIL EOF HAS BEEN REACHED       56950019
         NI    SWITCH1,DATACHK+MOVEDC  RE-SET READ/EDIT SWITCH1         57000019
         TM    SWITCH2,CANCEL      IS THIS A CANCELLED SHORT RECORD ?   57050019
         BZ    TCR928              BRANCH IF NO                         57100019
         OI    SWITCH1,NODUP       ELSE SET SWITCH TO PREVENT DUPING    57150019
         MVI   EDWLS,LS0           RESET LS FOR RCDS LESS THAN 3 BYTES  57200019
TCR928   NI    SWITCH2,EXCP        RESET READ/EDIT SWITCH2              57250019
         L     R2,STARTREC         RESET POINTER TO                     57300019
         ST    R2,NXTAVAIL         NEXT AVAILABLE BYTE IN WORKAREA      57350019
TSW929   NOP   TCR930              NOP IF MTDI WITH EDIT,ELSE BRANCH    57400019
         MVC   SAVELS(1),EDWLS     SAVE LEVEL STATUS                    57450019
TCR930   ST    R7,EDW                                                   57500019
         MVI   EDW,LS0             RE-INITIALIZE EDW                    57550019
TSW931   NOP   TCR811              NOP IF MTDI WITH EDIT,ELSE GO MOVE   57600019
         BR    R12                 RETURN TO CALLER                     57650019
         SPACE 2                                                        57700019
*        THIS SECTION SETS UP THE OUTPUT WORKAREA POINTERS AFTER THE    57750019
*        AREA IS GETMAINED. IT NEED ONLY BE DONE ONCE UNLESS A NEW      57800019
*        WORKAREA IS GETMAINED. AT ENTRY,REG 1 CONTAINS THE ADDRESS     57850019
*        OF THE GETMAINED WORKAREA. REG 14 HAS THE ADDRESS OF THE       57900019
*        CALLING ROUTINE.                                               57950019
         SPACE 2                                                        58000019
TCR932   ST    R1,STRTWORK         SAVE START OF WORKAREA               58050019
         AH    R1,TCON4                                                 58100019
         ST    R1,EDWADDR          SET POINTER FOR ERROR RECORD         58150019
         AH    R1,TCON4                                                 58200019
         ST    R1,NXTAVAIL         SAVE AS NEXT AVAIL RECORD AREA BYTE  58250019
         ST    R1,STARTREC         SAVE AS START OF RECORD              58300019
         AH    R1,MAXLN            ADD MAXLN                            58350019
         ST    R1,ENDREC           SAVE AS ADDRESS OF SOR + MAXLN + 1   58400019
         L     R1,STRTWORK         GET START OF WORKAREA                58450019
         A     R1,WORKL1           ADD TOTAL WORKAREA LENGTH            58500019
         ST    R1,ENDWORK          SAVE AS END OF WORKAREA + 1          58550019
         BR    R14                 RETURN TO CALLER                     58600019
         SPACE 2                                                        58650019
*        THIS SECTION IS ENTERED INITIALLY FOR ALL SYSUT3 (ERROR)       58700019
*        RECORDS. THE DCB ADDRESS IS PICKED UP AND CONTROL IS PASSED    58750019
*        TO THE GENERAL OUTPUT SECTION (TSW902).                        58800019
         SPACE 2                                                        58850019
TSW935   NOP   TSW927              BRANCH IF SYSUT3 DD MISSING,ELSE NOP 58900019
         LA    R4,UT3DCB           GET ADDRESS OF SYSUT3 DCB            58950019
         MVI   OPENERR+1,UT3OPERR  SET UP MESSAGE TABLE  (JUST IN CASE) 59000019
         MVI   DCBERR+1,UT3OPERR                                        59050019
         B     TCR903              BR TO COMMON OUTPUT PROCESSOR        59100019
         EJECT                                                          59150019
*        THIS SECTION BLANKS OUT THE REMAINDER OF THE OUTPUT WORKAREA   59200019
*        (FROM 'NXTAVAIL' TO 'ENDWORK') FOR FIXED LENGTH RECORDS.       59250019
         SPACE 2                                                        59300019
TCR936   L     R2,ENDWORK          GET ADDRESS OF END OF WORKAREA       59350019
         SR    R2,R5               GET LENGTH IF AREA TO BLANK OUT      59400019
         BCR   NOTPLUS,R14         RETURN IF ZERO OR NEGATIVE           59450019
         MVI   0(R5),BLANK         BLANK OUT FIRST BYTE                 59500019
         BCTR  R2,0                SO, DECREMENT COUNT BY ONE           59550019
         LH    R0,TCON256                                               59600019
         B     TCR939              GO SET UP FOR MOVE                   59650019
TCR937   MVC   1(0,R5),0(R5)       BLANK OUT REST OF WORKAREA           59700019
TCR938   MVC   1(256,R5),0(R5)     BLANK OUT 256 BYTES OF WORKAREA      59750019
         AR    R5,R0               ADJUST WORKAREA POINTER              59800019
TCR939   SR    R2,R0               IS LENGTH GREATER THAN 256 ?         59850019
         BP    TCR938              BRANCH IF YES                        59900019
         AR    R2,R0               RESTORE LENGTH IF LESS THAN 256      59950019
         BCTR  R2,0                DECREMENT COUNT FOR MVC INST         60000019
         EX    R2,TCR937           BLANK OUT REST OF WORKAREA           60050019
         BR    R14                 RETURN                               60100019
         SPACE 2                                                        60150019
*        THIS SECTION TRANSLATES MTST CODE IN THE OUTPUT WORKAREA TO    60200019
*        STANDARD UPPER CASE EBCDIC,STANDARD LOWER CASE EBCDIC,OR ANY   60250019
*        USER SUPPLIED CHARACTER SET. IT IS CALLED JUST PRIOR TO OUT-   60300019
*        PUTTING THE RECORD (TSW852).                                   60350019
         SPACE 2                                                        60400019
TCR940   L     R2,STARTREC         GET START OF RECORD TO TRANSLATE     60450019
         L     R8,NXTAVAIL         GET ADDR OF NEXT AVAIL IN WORKAREA   60500019
         SR    R8,R2               GET LENGTH OF RECORD TO TRANSLATE    60550019
         L     R6,TRANTABL         GET TRANSLATE TABLE ADDRESS          60600019
         LH    R0,TCON256                                               60650019
         B     TCR948              GO SET UP FOR TRANSLATE              60700019
TCR944   TR    0(0,R2),0(R6)       TRANSLATE REST OF BUFFER             60750019
TCR946   TR    0(256,R2),0(R6)     TRANSLATE 256 BYTES                  60800019
         AR    R2,R0               ADJUST RECORD POINTER                60850019
TCR948   SR    R8,R0               IS LENGTH GREATER THAN 256?          60900019
         BP    TCR946              BRANCH IF YES                        60950019
         AR    R8,R0               RESTORE LENGTH IF LESS THAN 256      61000019
         BCTR  R8,0                DECREMENT COUNT FOR TR INST          61050019
         EX    R8,TCR944           TRANSLATE REST OF BUFFER             61100019
         B     TCR861              RETURN TO OUTPUT ROUTINE             61150019
 TITLE ' IEBTCR05 - READ/EDIT MODULE -- OUTHDR,OUTTLR EXITS'            61200019
*        THIS SECTION PROCESSES THE OUTHDR AND OUTTLR EXIT ROUTINES.    61250019
*        AT ENTRY, REG 0 IS UNPREDICTABLE, REG 2 - REG 13 ARE THE SAME  61300019
*        AS BEFORE. REG 1 CONTAINS THE ADDRESS OF A PARAMETER LIST      61350019
*        CREATED BY IOS AS FOLLOWS:                                     61400019
*              WORD 1 - POINTER TO 80 BYTE LABEL BUFFER AREA            61450019
*              WORD 2 - POINTER TO DCB BEING PROCESSED                  61500019
*              WORD 3 - POINTER TO STATUS INFO (SEE SRL C28-6646)       61550019
*              WORD 4 - RESERVED                                        61600019
         SPACE 2                                                        61650019
TCR950   MVI   TSW975+1,HDR2       SET TM INST  TO CHECK FOR OUTHDR2    61700019
         CLI   EXITERR,MSGFLAG     ERROR FLAG ALREADY ON ?              61750019
         BE    TCR953              IF YES, LEAVE IT ALONE               61800019
         MVI   EXITERR+1,HDR2BORT    SET MESSAGE                        61850019
TCR953   L     R15,OUTHDR2                    AND EXIT ADDR FOR OUTHDR2 61900019
         B     TSW975              GO CHECK FOR OUTHDR2                 61950019
         SPACE 2                                                        62000019
TCR955   MVI   TSW975+1,TLR2       SET TM INST  TO CHECK FOR OUTTLR2    62050019
         CLI   EXITERR,MSGFLAG     ERROR FLAG ALREADY ON ?              62100019
         BE    TCR958              IF YES, LEAVE IT ALONE               62150019
         MVI   EXITERR+1,TLR2BORT      SET MESSAGE                      62200019
TCR958   L     R15,OUTTLR2                    AND EXIT ADDR FOR OUTTLR2 62250019
         B     TSW975              GO CHECK FOR OUTTLR2                 62300019
         SPACE 2                                                        62350019
TCR960   MVI   TSW975+1,HDR3       SET TM INST  TO CHECK FOR OUTHDR3    62400019
         CLI   EXITERR,MSGFLAG     ERROR FLAG ALREADY ON ?              62450019
         BE    TCR963              IF YES, LEAVE IT ALONE               62500019
         MVI   EXITERR+1,HDR3BORT      SET MESSAGE                      62550019
TCR963   L     R15,OUTHDR3                    AND EXIT ADDR FOR OUTHDR3 62600019
         B     TSW975              GO CHECK FOR OUTHDR3                 62650019
         SPACE 2                                                        62700019
TCR965   MVI   TSW975+1,TLR3       SET TM INST  TO CHECK FOR OUTTLR3    62750019
         CLI   EXITERR,MSGFLAG     ERROR FLAG ALREADY ON ?              62800019
         BE    TCR968              IF YES, LEAVE IT ALONE               62850019
         MVI   EXITERR+1,TLR3BORT      SET MESSAGE                      62900019
TCR968   L     R15,OUTTLR3                    AND EXIT ADDR FOR OUTTLR3 62950019
         SPACE 2                                                        63000019
TSW975   TM    EXITS,ZERO          EXIT REQUESTED ?                     63050019
         BZ    TCR979              IF NOT,RETURN TO OPEN/CLOSE ROUTINE  63100019
         ST    R14,SAVE14                                               63150019
         BALR  R14,R15             BRANCH TO USER LABEL EXIT            63200019
         CH    R15,TCON16          TERMINATION REQUESTED ?              63250019
         L     R14,SAVE14                                               63300019
         BNE   TCR980              BRANCH IF NO                         63350019
         MVI   EXITERR,MSGFLAG     ELSE SET PROPER                      63400019
         OI    ERRIND,DCBBIT4      ERROR INDICATORS            @ZA29418 63450003
TCR979   SR    R15,R15             SET RETURN CODE TO ZERO              63500019
TCR980   BR    R14                 RETURN TO OPEN/CLOSE ROUTINE         63550019
 TITLE ' IEBTCR05 - READ/EDIT MODULE -- END OF MODULE PROCESSOR'        63600019
*        THIS SECTION SETS PROPER ERROR SWITCHES (IF NEEDED),           63650019
*        BRANCHES TO ERROR AND OUTREC ROUTINES (IF SPECIFIED) TO INDI-  63700019
*        CATE END-OF-FILE,CLOSES SYSUT2 AND SYSUT3 (IF OPENED),FREES    63750019
*        THE INPUT BUFFERS AND OUTPUT WORKAREA,AND RETURNS TO DRIVER.   63800019
         SPACE 1                                                        63850019
TCR990   MVI   EXITERR,MSGFLAG     SET EXIT ERROR MESSAGE FLAG          63900019
TCR991   OI    ERRIND,DCBBIT4      SET READ/EDIT ERROR FLAG    @ZA29418 63950003
         B     TCR995              SKIP USER EXITS                      64000019
TSW992   B     TSW994              NOP IF ERROR EXIT SPECIFIED,ELSE BR  64050019
         SR    R1,R1               SET PARAM REG = 0 TO DENOTE EOF      64100019
         L     R15,ERROR                                                64150019
         BALR  R14,R15             BRANCH TO ERROR EXIT ROUTINE         64200019
TSW994   B     TCR995              NOP IF OUTREC EXIT SPECIFIED,ELSE BR 64250019
         SR    R1,R1               SET PARAM REG = 0  TO DENOTE EOF     64300019
         L     R15,OUTREC                                               64350019
         BALR  R14,R15             BRANCH TO OUTREC EXIT ROUTINE        64400019
TCR995   LA    R4,UT2DCB           GET ADDRESS OF SYSUT2 DCB            64450019
         TM    DCBOFLGS,DCBOPEN    HAS SYSUT2 BEEN OPENED?              64500019
         BZ    TCR996              BRANCH IF NO TO AVOID CLOSE          64550019
         CLOSE ((R4))              CLOSE SYSUT2                         64600019
TCR996   LA    R4,UT3DCB           GET ADDRESS OF SYSUT3 DCB            64650019
         TM    DCBOFLGS,DCBOPEN    HAS SYSUT3 BEEN OPENED?              64700019
         BZ    TCR998              BRANCH IF NO TO AVOID CLOSE          64750019
         CLOSE ((R4))              CLOSE SYSUT3                         64800019
TCR998   TM    SWITCH2,EXCP        EXCP BEEN ISSUED           @ZA29418  64850003
         BZ    TCR997              BR IF NO                   @ZA29418  64857003
         WAIT  ECB=TCRECB          WAIT FORFINAL EXCP         @ZA29418  64864003
TCR997   L     R0,BUFL1                                       @ZA29418  64880003
         L     R1,TCRCCW1                                               64900019
         FREEMAIN R,LV=(0),A=(1)   FREE THE INPUT BUFFERS               64950019
         L     R0,WORKL1                                                65000019
         L     R1,STRTWORK                                              65050019
         FREEMAIN R,LV=(0),A=(1)   FREE THE WORKAREA                    65100019
TCR999   L     R13,SAVEREG+HSA     RESTORE SAVE REGISTER                65300019
         RETURN (14,12),RC=(15)    RETURN TO DRIVER ROUTINE             65350019
  TITLE ' IEBTCR05 - READ/EDIT MODULE -- CONSTANTS SECTION'             65400019
*                   * * * * * * * * * * *                               65450019
* * * * * * * * * * * CONSTANTS SECTION * * * * * * * * * * * * *       65500019
*                   * * * * * * * * * * *                               65550019
           SPACE 2                                                      65600019
LZMAX    DC    H'15'               MAXIMUM LEFT ZERO FIELD LENGTH       65650019
         SPACE 2                                                        65700019
*                  MISCELLANEOUS COMPARE CONSTANTS                      65750019
         SPACE 1                                                        65800019
TCON0    DC    H'0'                ZERO                                 65850019
TCON1    DC    H'1'                ONE                                  65900019
TCON3    DC    H'3'                THREE                                65950019
TCON4    DC    H'4'                FOUR                                 66000019
TCON8    DC    H'8'                EIGHT                                66050019
TCON16   DC    H'16'               SIXTEEN                              66100019
ENDREF   DC    H'45'               END OF REFERENCE CODE (MTST)         66150019
TCON256  DC    H'256'              TWO-FIFTY-SIX                        66200019
         SPACE 6                                                        66250019
*                  TR  &  TRT  TABLE ADDRESSES                          66300019
         SPACE 1                                                        66350019
MTDIADDR DC    A(TRTMTDI)          ADDRESS OF MTDI TRT TABLE            66400019
MTSTADDR DC    A(TRTMTST)          ADDRESS OF MTST TRT TABLE            66450019
UPPERADR DC    A(UPPER)            ADDR OF UPPER CASE TR TABLE (MTST)   66500019
LOWERADR DC    A(LOWER)            ADDR OF LOWER CASE TR TABLE (MTST)   66550019
         SPACE 6                                                        66600019
*                  EXIT LIST ADDRESSES FOR HDR & TLR EXITS              66650019
         SPACE 1                                                        66700019
XL2      DC    X'02'               CODE                                 66750019
         DC    AL3(TCR950)         A(OUTHDR2 EXIT)                      66800019
         DC    X'84'               CODE                                 66850019
         DC    AL3(TCR955)         A(OUTTLR2 EXIT)                      66900019
XL3      DC    X'02'               CODE                                 66950019
         DC    AL3(TCR960)         A(OUTHDR3 EXIT)                      67000019
         DC    X'84'               CODE                                 67050019
         DC    AL3(TCR965)         A(OUTTLR3 EXIT)                      67100019
         EJECT                                                          67150019
*        THIS PAGE OF CONSTANTS DEFINES CHARACTER CODE DEPENDENT        67200019
*        VALUES. THE SHORT TR TABLE LABELLED EDWTT IS USED TO TRANSLATE 67250019
*        THE TYPE STATUS AND SOR VALUE IN THE EDW TO EBCDIC. IT MUST BE 67300019
*        CHANGED ACCORDINGLY, IF ANY OTHER CHARACTER SET IS TO BE USED. 67350019
*        THE LEVEL STATUS (EDWLS) AND THE EOR VALUE (EDWEOR) OF THE EDW 67400019
*        RECEIVE EBCDIC CODES DIRECTLY,SO THESE VALUES MUST BE CHANGED  67450019
*        IN THE CODING WHEREVER THEY ARE REFERENCED.                    67500019
*                                                                       67550019
*        THE REMAINING VALUES ON THE PAGE ARE CHARACTER DEFINITIONS     67600019
*        FOR TCR INPUT (SYSUT1). IF THIS INPUT EVER CHANGES ITS CHAR-   67650019
*        ACTER SET,THESE VALUES WILL HAVE TO BE CHANGED ACCORDINGLY.    67700019
         SPACE 2                                                        67750019
EDWTT    DC    C'01234567'         TRANSLATE TABLE FOR TYPE STATUS  &   67800019
         DC    C'89ABCDEF'         SOR IN ERROR DESCRIPTION WORD        67850019
         SPACE 1                                                        67900019
HEXEOR   DC    H'20'               TRT TABLE ENTRIES FOR EOR (HEX 20)   67950019
         SPACE 2                                                        68000019
MTDILZF  EQU   X'00'               LEFT ZERO FILL                       68050019
MTDIDUP  EQU   X'11'               DUP                                  68100019
MTDILZS  EQU   X'12'               LEFT ZERO START                      68150019
MTDICAN  EQU   X'18'               CANCEL                               68200019
MTDIVOK  EQU   X'1E'               VERIFY OK                            68250019
MTDIRM   EQU   X'3C'               RECORD MARK                          68300019
MTDIPL1  EQU   X'71'               PROGRAM LEVEL 1                      68350019
MTDIPL8  EQU   X'78'               PROGRAM LEVEL 8                      68400019
MTDIGS   EQU   X'1D'               GROUP SEPARATOR                      68450019
         SPACE 2                                                        68500019
MTSTREF  EQU   X'00'               REFERENCE CODE FILLER                68550019
MTSTLCR  EQU   X'10'               LOWER CASE CARRIER RETURN            68600019
MTSTLSW  EQU   X'11'               LOWER CASE SWITCH CODE               68650019
MTSTLFD  EQU   X'13'               LOWER CASE FEED CODE                 68700019
MTSTUCR  EQU   X'14'               UPPER CASE CARRIER RETURN            68750019
MTSTUSW  EQU   X'15'               UPPER CASE SWITCH CODE               68800019
MTSTUFD  EQU   X'17'               UPPER CASE FEED CODE                 68850019
MTSTLAS  EQU   X'51'               LOWER CASE AUTOSEARCH CODE           68900019
MTSTUAS  EQU   X'55'               UPPER CASE AUTOSEARCH CODE           68950019
MTSTLSRC EQU   X'80'               LOWER CASE SEARCH CODE               69000019
MTSTUSRC EQU   X'84'               UPPER CASE SEARCH CODE               69050019
         EJECT                                                          69100019
*                  CHANNEL COMMANDS FOR THE 2495 TAPE CARTRIDGE READER  69150019
         SPACE 1                                                        69200019
READ     EQU   X'02'               READ COMMAND CODE FOR TCR            69250019
REWIND   EQU   X'0F'               REWIND/UNLOAD COMMAND CODE FOR TCR   69300019
         SPACE 2                                                        69350019
*                  MESSAGE CODES TO BE INSERTED INTO THE MESSAGE        69400019
*                  INDICATOR WORDS IN THE COMMON REGION                 69450019
         SPACE 1                                                        69500019
UT2OPERR EQU   X'04'               * * * * * * * *                      69550019
UT3OPERR EQU   X'05'               *             *                      69600019
HDR2BORT EQU   X'06'               *   MESSAGE   *                      69650019
TLR2BORT EQU   X'07'               *             *                      69700019
HDR3BORT EQU   X'08'               *    CODES    *                      69750019
TLR3BORT EQU   X'09'               *             *                      69800019
OUTABORT EQU   X'0A'               *             *                      69850019
ERRABORT EQU   X'0B'               * * * * * * * *                      69900019
         SPACE 1                                                        69950019
MSGFLAG  EQU   X'FF'               FLAG TO INDICATE MSG IS REQUIRED     70000019
         SPACE 2                                                        70050019
*                  CSW STATUS BYTE MASKS                                70100019
         SPACE 1                                                        70150019
CDC      EQU   X'08'               CHANNEL DATA CHECK                   70200019
CCC      EQU   X'04'               CHANNEL CONTROL CHECK                70250019
ICC      EQU   X'02'               INTERFACE CONTROL CHECK              70300019
PROGRAM  EQU   X'20'               PROGRAM CHECK                        70350019
PROTECT  EQU   X'10'               PROTECTION CHECK                     70400019
UNITCHK  EQU   X'02'               UNIT CHECK                           70450019
UNITEXC  EQU   X'01'               UNIT EXCEPTION                       70500019
         SPACE 2                                                        70550019
*                  DATA CHECK MASKS                                     70600019
         SPACE 1                                                        70650019
DATACHK  EQU   X'08'               ONE DATA CHECK FOUND                 70700019
TWOCHKS  EQU   X'04'               TWO CONSECUTIVE DATA CHECKS FOUND    70750019
NODATCHK EQU   X'E3'               NO DATA CHECKS FOUND                 70800019
MOVEDC   EQU   X'10'               DATA CHECK TO BE MOVED               70850019
         SPACE 2                                                        70950019
*                  ECB CONDITION CODES                                  71000019
         SPACE 1                                                        71050019
NORMAL   EQU   X'7F'               NORMAL INTERRUPT CONDITION           71100019
PERMERR  EQU   X'41'               PERMANENT I/O ERROR CONDITION        71150019
INTRCEPT EQU   X'44'               INTERCEPT CONDITION                  71200019
         SPACE 2                                                        71250019
*                  BRANCH-ON-CONDITION CODES                            71300019
         SPACE 1                                                        71350019
LOW      EQU   X'04'               CONDITION CODE 4                     71400019
NOTPLUS  EQU   X'0D'               CONDITION CODE 13                    71500019
         EJECT                                                          71550019
*                  MISCELLANEOUS EQU CONSTANTS -- THE LABELS AND        71600019
*                  REMARKS SERVE TO EXPLAIN THEIR FUNCTION              71650019
         SPACE 1                                                        71700019
NOP      EQU   X'00'               INSTRUCTION                          71750019
BRANCH   EQU   X'F0'                      MODIFIER BYTES                71800019
         SPACE 2                                                        71850019
MTST     EQU   X'80'               * * * * * * * * * *                  71900019
NOTRAN   EQU   X'02'               *                 *                  71950019
STDLC    EQU   X'08'               *   KEYWORD       *                  72000019
STDUC    EQU   X'10'               *     PARAMETER   *                  72050019
NOERR    EQU   X'02'               *       SWITCHES  *                  72100019
VOKCHK   EQU   X'10'               *                 *                  72150019
NOEDIT   EQU   X'20'               *                 *                  72200019
EDITD    EQU   X'80'               * * * * * * * * * *                  72250019
         SPACE 2                                                        72300019
DUPCODE  EQU   X'01'               DUP CODE ENCOUNTERED                 72350019
NODUP    EQU   X'02'               DUPLICATION NOT ALLOWED              72400019
DELETE   EQU   X'80'               RECORD IS TO BE DELETED              72450019
DELDUP   EQU   X'82'               COMBINATION OF NODUP AND DELETE      72500019
RESET    EQU   X'9F'               RESET LEFT ZERO SWITCHES             72550019
SOREOR   EQU   X'01'               SOR  OR  EOR ERROR                   72600019
LNGERR   EQU   X'02'               LENGTH ERROR                         72650019
FRAGMENT EQU   X'10'               CANCELLED SHORT RECORD  (EDITD)      72700019
CANCEL   EQU   X'20'               CANCELLED SHORT RECORD  (EDITR)      72750019
FIELD    EQU   X'04'               FIELD ERROR                          72800019
LZSTART  EQU   X'40'               LEFT ZERO START CODE ENCOUNTERED     72850019
LZERR    EQU   X'20'               LEFT ZERO JUSTIFICATION ERROR        72900019
         SPACE 2                                                        72950019
ERREXT   EQU   X'04'               ERROR EXIT REQUESTED                 73000019
OUTEXT   EQU   X'08'               OUTREC EXIT REQUESTED                73050019
         SPACE 2                                                        73100019
LSERR    EQU   X'03'               LEVEL STATUS ERROR MASK              73150019
TSERR    EQU   X'0F'               TYPE STATUS ERROR MASK               73200019
         SPACE 2                                                        73250019
VOK      EQU   X'E5'               VOK INDICATION IN EDW                73300019
RM       EQU   X'E4'               RM  INDICATION IN EDW                73350019
BADSOR   EQU   X'0E'               BAD SOR INDICATION IN EDW            73400019
BADEOR   EQU   X'C5'               BAD EOR INDICATION IN EDW            73450019
HEXSOR   EQU   X'0F'               HEX MASK FOR SOR CONVERSION          73500019
         SPACE 2                                                        73550019
TROUBLE  EQU   X'28'               TROUBLE FLAG (PERM I/O ERROR ON UT1) 73750019
MULTERR  EQU   X'37'               MULTIPLE ERROR MASK (SYSUT1)         73800019
NOCORE   EQU   X'48'               NO CORE AVAILABLE FOR GETMAIN        73850019
         EJECT                                                          73900019
ZERO     EQU   0                   ZERO                                 73950019
TWO      EQU   2                   TWO                                  74000019
BLANK    EQU   X'40'               BLANK                                74050019
         SPACE 2                                                        74100019
NOUT2    EQU   X'04'               SYSUT2 DD STATEMENT MISSING          74150019
NOUT3    EQU   X'08'               SYSUT3 DD STATEMENT MISSING          74200019
BADDCB   EQU   X'80'               INCONSISTENT DCB PARAMETERS          74250019
SYSUT3   EQU   X'40'               SYSUT3 RECORD  ( ERROR RECORD )      74300019
         SPACE 2                                                        74350019
LS0      EQU   X'F0'               LEVEL                                74400019
LS1      EQU   X'F1'                    STATUS                          74450019
LS2      EQU   X'F2'                          VALUES                    74500019
         SPACE 2                                                        74550019
HDR2     EQU   X'80'               HEADER                               74600019
TLR2     EQU   X'40'                     TRAILER                        74650019
HDR3     EQU   X'20'                            EXIT                    74700019
TLR3     EQU   X'10'                                INDICATORS          74750019
         SPACE 2                                                        74800019
HSA      EQU   4                   NEXT HIGHER LEVEL SAVEAREA           74850019
LSA      EQU   8                   NEXT LOWER LEVEL SAVEAREA            74900019
         SPACE 2                                                        74950019
CNTFLD   EQU   X'06'               COUNT FIELD IN CCW                   75000019
SWAP     EQU   X'01'               SWITCH FOR SWAPPING CCW'S            75050019
WORD     EQU   X'04'               FULL WORD LENGTH                     75100019
DBLWRD   EQU   X'08'               DOUBLE WORD LENGTH                   75150019
         SPACE 2                                                        75200019
DCBOPEN  EQU   X'10'               DCB IS PROPERLY OPENED               75250019
EXCP     EQU   X'80'               EXCP HAS BEEN ISSUED                 75300019
         SPACE 2                                                        75350019
NOTVAR   EQU   X'80'               NOT VARIABLE LENGTH RCDS  ( F OR U ) 75400019
UNDEF    EQU   X'40'               UNDEFINED RECORD (RECFM=U)           75450019
 TITLE ' IEBTCR05 - READ/EDIT MODULE -- WORKING STORAGE SECTION'        75500019
*                   * * * * * * * * * * * * * *                         75550019
* * * * * * * * * * * WORKING STORAGE SECTION * * * * * * * * * *       75600019
*                   * * * * * * * * * * * * * *                         75650019
           SPACE 2                                                      75700019
SAVELS   DC    X'F0'               LEVEL STATUS FOR PREVIOUS RECORD     75750019
SAVEREG  DS    18F                 REGISTER SAVE AREA                   75800019
SAVE14   DS    F                   SAVEWORD FOR R14 AT HDR,TLR TIME     75850019
         SPACE 4                                                        75900019
TCRECB   DC    X'7F000000'         TCR EVENT CONTROL BLOCK              75950019
         SPACE 4                                                        76000019
TCRIOB   EQU   *                   TCR INPUT/OUTPUT BLOCK               76050019
         SPACE 1                                                        76100019
IOBFLG1  DC    X'02'               I/O FLAGS 1                          76150019
IOBFLG2  DC    X'00'               I/O FLAGS 2                          76200019
SENSE    DC    X'00'               TCR SENSE BYTE                       76250019
         DC    X'00'               NOT USED (SECOND SENSE BYTE)         76300019
         DC    X'00'               TCR ECB COMPLETION CODE              76350019
         DC    AL3(TCRECB)         TCR ECB ADDRESS                      76400019
IOBFLG3  DC    X'00'               I/O FLAGS 3                          76450019
         DC    XL3'00'             LAST SEVEN    -     COMMAND ADDR     76500019
STATUS   DC    XL2'00'             BYTES OF      -     STATUS           76550019
RESIDUAL DC    XL2'00'             PREV CSW      -     RESIDUAL COUNT   76600019
CCWADDR  DC    X'00'               SIO CONDITION CODE                   76650019
         DC    AL3(TCRCCW1)        CHANNEL PROGRAM ADDRESS              76700019
DCBADDR  DC    X'00'               RESERVED                             76750019
         DC    XL3'00'             TCR DCB ADDRESS                      76800019
         DC    2F'0'               USED BY IOS                          76850019
         SPACE 4                                                        76900019
TCRCCW1  CCW   02,X'00',X'20',2000               TCR INPUT              76950019
TCRCCW2  CCW   02,X'00',X'20',2000               CHANNEL PROGRAM        77000019
         SPACE 4                                                        77050019
RDW      DC    F'0'                RECORD DESCRIPTOR WORD               77100019
         SPACE 2                                                        77150019
LZCNT    DC    H'0'                COUNT OF LEFT ZERO FILL CODES        77200019
         EJECT                                                          77250019
SWITCH1  DC    B'00000010'     READ/EDIT SWITCHES    AS FOLLOWS:        77300019
*                                                                       77350019
*              BIT 0  SET TO 1 INDICATES RECORD TO BE DELETED           77400019
*              BIT 1  SET TO 1 INDICATES FIELD IN LZ MODE               77450019
*              BIT 2  SET TO 1 INDICATES LZ FIELD ERROR                 77500019
*              BIT 3  SET TO 1 INDICATES DATA CK TO BE MOVED            77550019
*              BIT 4  SET TO 1 INDICATES DATA CHECK                     77600019
*              BIT 5  SET TO 1 INDICATES TWO SUCCESSIVE DATA CHECKS     77650019
*              BIT 6  SET TO 1 INDICATES DUP NOT ALLOWED                77700019
*              BIT 7  SET TO 1 INDICATES DUP ENCOUNTERED                77750019
         SPACE 1                                                        77800019
SWITCH2  DC    B'00000000'                                              77850019
*              BIT 0  SET TO 1 INDICATES EXCP HAS BEEN ISSUED           77900019
*              BIT 1  SET TO 1 INDICATES SYSUT3 RECORD                  77950019
*              BIT 2  SET TO 1 INDICATES RCD LESS THAN 3 BYTES (EDITR)  78000019
*              BIT 3  SET TO 1 INDICATES POSSIBLE SHORT RECORD (EDITD)  78050019
*              BIT 4  SET TO 1 INDICATES DATA CHECK                     78100019
*              BIT 5  NOT USED                                          78150019
*              BIT 6  NOT USED                                          78200019
*              BIT 7  SET TO 1 INDICATES UNIT EXCEPTION                 78250019
         SPACE 2                                                        78300019
EDW      EQU   *         ERROR DESCRIPTION WORD   AS FOLLOWS:           78350019
*                                                                       78400019
*                   THE 4 BYTE EDW IS APPENDED TO AN ERROR RECORD       78450019
*                   TO BE PASSED TO THE ERROR EXIT OR TO SYSUT3         78500019
*                   THE FIRST BYTE IS USED TO STORE LEVEL STATUS        78550019
*        IF IT = 0, ERROR WONT CAUSE QUESTIONABLE DATA IN NEXT RECORD   78600019
*        IF IT = 1, ERROR MAY CAUSE QUESTIONABLE DATA IN NEXT RECORD    78650019
*        IF IT = 2, RECORD HAS QUESTIONABLE DATA DUE TO PREVIOUS RECORD 78700019
*                   AND MAY CAUSE QUESTIONABLE DATA IN NEXT RECORD      78750019
*                                                                       78800019
EDWLS    DC    X'F0'     LEVEL STATUS                                   78850019
         SPACE 2                                                        78900019
*                   THE SECOND BYTE IS USED TO STORE TYPE STATUS        78950019
*        IF ALL BITS ARE 0, THIS RECORD CONTAINS NO IDENTIFIABLE ERROR  79000019
*        BITS 0,1,2 3  ARE UNUSED AND MUST BE 0                         79050019
*        IF BIT 4 = 1, RECORD CONTAINS A CHARACTER ERROR                79100019
*        IF BIT 5 = 1, RECORD CONTAINS A FIELD ERROR                    79150019
*        IF BIT 6 = 1, RECORD CONTAINS A LENGTH ERROR                   79200019
*        IF BIT 7 = 1, RECORD CONTAINS A FIELD (SOR/EOR) ERROR          79250019
*                                                                       79300019
EDWTS    DC    X'00'     TYPE STATUS                                    79350019
         SPACE 2                                                        79400019
*                   THE THIRD BYTE IS USED TO STORE THE SOR CHARACTER   79450019
*                                                                       79500019
EDWSOR   DC    X'00'     SOR                                            79550019
         SPACE 2                                                        79600019
*                   THE FOURTH BYTE IS USED TO STORE THE EOR CHARACTER  79650019
*                                                                       79700019
EDWEOR   DC    X'00'     EOR                                            79750019
         EJECT                                                          79800019
*                  POINTERS WITHIN THE INPUT BUFFER                     79850019
         SPACE 1                                                        79900019
INPUTPTR DC    F'0'      ADDR OF NEXT AVAILABLE BYTE IN INPUT BUFFER    79950019
INPUTEND DC    F'0'      ADDR OF LAST BYTE + 1  IN INPUT BUFFER         80000019
FRSTSCAN DC    F'0'      ADDR OF FIRST BYTE SCANNED                     80050019
LASTSCAN DC    F'0'      ADDR OF LAST BYTE SCANNED                      80100019
         SPACE 2                                                        80150019
*                  POINTERS WITHIN THE OUTPUT WORKAREA                  80200019
         SPACE 1                                                        80250019
STRTWORK DC    F'0'      ADDRESS OF WORKAREA                            80300019
EDWADDR  DC    F'0'      ADDRESS OF ERROR DESCRIPTION WORD              80350019
STARTREC DC    F'0'      ADDRESS OF OUTPUT RECORD                       80400019
NXTAVAIL DC    F'0'      ADDRESS OF NEXT AVAILABLE BYTE IN WORKAREA     80450019
LZFLD    DC    F'0'      ADDR OF FIRST BYTE OF LZ FIELD IN WORKAREA     80500019
PREVLB   DC    F'0'      ADDR OF LAST BYTE + 1 OF PREVIOUS RECORD       80550019
ENDREC   DC    F'0'      ADDRESS OF STARTREC + MAXLN + 1 IN WORKAREA    80600019
ENDWORK  DC    F'0'      ADDRESS OF END OF WORKAREA                     80650019
         SPACE 2                                                        80700019
GM1      DC    F'0'      WORKWORDS                                      80750019
BUFL1    DC    F'0'               USED                                  80800019
BUFL2    DC    F'0'                   FOR                               80850019
GM2      DC    F'0'                      GETMAIN                        80900019
WORKL1   DC    F'0'                             AND                     80950019
WORKL2   DC    F'0'                                FREEMAIN             81000019
         SPACE 2                                                        81050019
OLDLGTH  DC    F'0'      LENGTH OF DISCARDED WORKAREA                   81100019
OLDAREA  DC    F'0'      ADDRESS OF DISCARDED WORKAREA                  81150019
         SPACE 4                                                        81200019
PARMLIST DC    F'0'      PARAMETER LIST FOR USER EXITS                  81250019
         DC    A(RECLEN) PTR TO RCD LNG FOR ERROR,OUTREC EXITS          81300019
         SPACE 2                                                        81350019
RECLEN   DC    F'0'      RECORD LENGTH FOR ERROR,OUTREC EXITS           81400019
         SPACE 4                                                        81450019
TRTTABLE DC    F'0'      ADDRESS OF TRT TABLE                           81500019
LZSAVE   DC    4F'0'     SAVE AREA FOR LZ JUSTIFICATION                 81550019
PLCNT    DC    8H'0'     RECORD LENGTHS FOR PROGRAM LEVELS              81600019
 TITLE ' IEBTCR05 - READ/EDIT MODULE -- TRANSLATE AND TEST TABLES'      81650019
*                   * * * * * * * * * * * * * * *                       81700019
* * * * * * * * * * * TRANSLATE AND TEST TABLES * * * * * * * * * *     81750019
*                   * * * * * * * * * * * * * * *                       81800019
         SPACE 2                                                        81850019
IEBTCRTB CSECT                                                          81900019
         DS    0F                  TABLE ALIGNMENT                      81950019
         SPACE 2                                                        82000019
TRTMTDI  DC    256X'00'            START OF MTDI TRANSLATE TABLE        82050019
         SPACE 1                                                        82100019
         ORG   TRTMTDI+MTDILZF     LEFT ZERO FILL                       82150019
         DC    X'04'                              CODE                  82200019
         ORG   TRTMTDI+MTDIDUP     DUP                                  82250019
         DC    X'08'                              CODE                  82300019
         ORG   TRTMTDI+MTDILZS     LEFT ZERO START                      82350019
         DC    X'0C'                              CODE                  82400019
         ORG   TRTMTDI+MTDICAN     CANCEL                               82450019
         DC    X'10'                              CODE                  82500019
         ORG   TRTMTDI+MTDIVOK     VERIFY OK                            82550019
         DC    X'14'                              CODE                  82600019
         ORG   TRTMTDI+MTDIRM      RECORD MARK                          82650019
         DC    X'14'                              CODE                  82700019
         ORG   TRTMTDI+MTDIPL1     PROGRAM LEVEL                        82750019
         DC    8X'18'                             CODES                 82800019
         SPACE 1                                                        82850019
         ORG   TRTMTDI+256         END OF MTDI TRANSLATE TABLE          82900019
         SPACE 4                                                        82950019
TRTMTST  DC    256X'00'            START OF MTST TRANSLATE TABLE        83000019
         SPACE 1                                                        83050019
         ORG   TRTMTST+MTSTLSW     LOWER CASE                           83100019
         DC    X'1C'                          SWITCH CODE               83150019
         ORG   TRTMTST+MTSTLFD     LOWER CASE                           83200019
         DC    X'1C'                          FEED CODE                 83250019
         ORG   TRTMTST+MTSTUSW     UPPER CASE                           83300019
         DC    X'1C'                          SWITCH CODE               83350019
         ORG   TRTMTST+MTSTUFD     UPPER CASE                           83400019
         DC    X'1C'                          FEED CODE                 83450019
         ORG   TRTMTST+MTSTLAS     LOWER CASE                           83500019
         DC    X'1C'                          AUTOSEARCH CODE           83550019
         ORG   TRTMTST+MTSTUAS     UPPER CASE                           83600019
         DC    X'1C'                          AUTOSEARCH CODE           83650019
         ORG   TRTMTST+MTSTLSRC    LOWER CASE                           83700019
         DC    X'20'                          SEARCH CODE               83750019
         ORG   TRTMTST+MTSTUSRC    UPPER CASE                           83800019
         DC    X'20'                          SEARCH CODE               83850019
         SPACE 1                                                        83900019
         ORG   TRTMTST+256         END OF MTST TRANSLATE TABLE          83950019
 TITLE ' IEBTCR05 - READ/EDIT MODULE -- MTST TRANSLATE TABLES'          84000019
*                   * * * * * * * * * * * * *                           84050019
* * * * * * * * * * * MTST TRANSLATE TABLES * * * * * * * * * * *       84100019
*                   * * * * * * * * * * * * *                           84150019
         SPACE 2                                                        84200019
UPPER    DC    X'E9F2E3D5E97CE3D5'     *********************            84250019
         DC    X'F1F3E7E49E7BE7E4'     *                   *            84300019
         DC    X'0D4040400D404040'     *                   *            84350019
         DC    X'4019404040194040'     *                   *            84400019
         DC    X'F5F6C5D26C4AC5D2'     *      UPPER        *            84450019
         DC    X'F7F8C4C3505CC4C3'     *                   *            84500019
         DC    X'F0F9C8C25D4DC8C2'     *      CASE         *            84550019
         DC    X'F440D3405B40D340'     *                   *            84600019
         DC    X'5A4BD17EA14BD14E'     *      MTST         *            84650019
         DC    X'D4E5C7C6D4E5C7C6'     *                   *            84700019
         DC    X'0540404005404040'     *      TRANSLATE    *            84750019
         DC    X'1640402216404022'     *                   *            84800019
         DC    X'7DC9D7D87FC9D7D8'     *      TABLE        *            84850019
         DC    X'D9C15E6BD9C17A6B'     *                   *            84900019
         DC    X'E2E6E860E2E6E86D'     *                   *            84950019
         DC    X'D6406140D6406F40'     *                   *            85000019
         DC    X'1E4040401E'           *********************            85050019
         SPACE 4                                                        85100019
LOWER    DC    X'A9F2A395E97CE3D5'     *********************            85150019
         DC    X'F1F3A7A49E7BE7E4'     *                   *            85200019
         DC    X'0D4040400D404040'     *                   *            85250019
         DC    X'4019404040194040'     *                   *            85300019
         DC    X'F5F685926C4AC5D2'     *      LOWER        *            85350019
         DC    X'F7F88483505CC4C3'     *                   *            85400019
         DC    X'F0F988825D4DC8C2'     *      CASE         *            85450019
         DC    X'F44093405B40D340'     *                   *            85500019
         DC    X'5A4B917EA14BD14E'     *      MTST         *            85550019
         DC    X'94A58786D4E5C7C6'     *                   *            85600019
         DC    X'0540404005404040'     *      TRANSLATE    *            85650019
         DC    X'1640402216404022'     *                   *            85700019
         DC    X'7D8997987FC9D7D8'     *      TABLE        *            85750019
         DC    X'99815E6BD9C17A6B'     *                   *            85800019
         DC    X'A2A6A860E2E6E86D'     *                   *            85850019
         DC    X'96406140D6406F40'     *                   *            85900019
         DC    X'1E4040401E'           *********************            85950019
 TITLE ' IEBTCR05 - READ/EDIT MODULE -- COMMON TABLE AREA'              86000019
COMMON   DSECT                     COMMON TABLE                         86050019
         SPACE 2                                                        86100019
EXITS    DS    1C                  EXIT ROUTINE INDICATORS              86150019
         SPACE 1                                                        86200019
*                   BIT 0     SET TO 1 INDICATES OUTHDR2 EXIT REQUESTED 86250019
*                   BIT 1     SET TO 1 INDICATES OUTTLR2 EXIT REQUESTED 86300019
*                   BIT 2     SET TO 1 INDICATES OUTHDR3 EXIT REQUESTED 86350019
*                   BIT 3     SET TO 1 INDICATES OUTTLR3 EXIT REQUESTED 86400019
*                   BIT 4     SET TO 1 INDICATES OUTREC  EXIT REQUESTED 86450019
*                   BIT 5     SET TO 1 INDICATES ERROR   EXIT REQUESTED 86500019
*                   BIT 6-7   NOT USED                                  86550019
         SPACE 3                                                        86600019
PARM1    DS    1C                  TYPE AND TRANS INDICATORS            86650019
         SPACE 1                                                        86700019
*                   BIT 0     SET TO 1 INDICATES  TYPE = MTST           86750019
*                   BIT 1     SET TO 1 INDICATES  TYPE = MTDI           86800019
*                   BIT 2     NOT USED                                  86850019
*                   BIT 3     SET TO 1 INDICATES  TRANS = STDUC         86900019
*                   BIT 4     SET TO 1 INDICATES  TRANS = STDLC         86950019
*                   BIT 5     SET TO 1 INDICATES  TRANS = 'USERNAME'    87000019
*                   BIT 6     SET TO 1 INDICATES  TRANS = NOTRAN        87050019
*                   BIT 7     NOT USED                                  87100019
         SPACE 3                                                        87150019
PARM2    DS    1C                  EDIT,VERCHK,AND ERROPT INDICATORS    87200019
         SPACE 1                                                        87250019
*                   BIT 0     SET TO 1 INDICATES  EDIT = EDITD          87300019
*                   BIT 1     SET TO 1 INDICATES  EDIT = EDITR          87350019
*                   BIT 2     SET TO 1 INDICATES  EDIT = NOEDIT         87400019
*                   BIT 3     SET TO 1 INDICATES  VERCHK = VOKCHK       87450019
*                   BIT 4     SET TO 1 INDICATES  VERCHK = NOCHK        87500019
*                   BIT 5     SET TO 1 INDICATES  ERROPT = NORMAL       87550019
*                   BIT 6     SET TO 1 INDICATES  ERROPT = NOERR        87600019
*                   BIT 7     NOT USED                                  87650019
         SPACE 3                                                        87700019
REPLACE  DS    1C                  DATA CHECK REPLACE CHARACTER         87750019
         SPACE 3                                                        87800019
MINLN    DS    2C                  MINLN VALUE                          87850019
         SPACE 3                                                        87900019
MAXLN    DS    2C                  MAXLN VALUE                          87950019
         EJECT                                                          88000019
OUTHDR2  DS    F                   A(OUTHDR2 EXIT)                      88050019
OUTTLR2  DS    F                   A(OUTTLR2 EXIT)                      88100019
OUTHDR3  DS    F                   A(OUTHDR3 EXIT)                      88150019
OUTTLR3  DS    F                   A(OUTTLR3 EXIT)                      88200019
OUTREC   DS    F                   A(OUTREC EXIT)                       88250019
ERROR    DS    F                   A(ERROR  EXIT)                       88300019
TRANTABL DS    F                   A(TRANSLATE TABLE)                   88350019
         DS    F                   A(MESSAGE MODULE)                    88400019
         SPACE 3                                                        88450019
         DS    24F                 NOT USED BY R/E                      88500019
         SPACE 3                                                        88550019
*              THE FOLLOWING TABLE CONTAINS MESSAGE INDICATORS          88600019
*              EACH ENTRY CONSISTS OF 4 BYTES                           88650019
*              A LITERAL WILL BE INSERTED IN MSG VIA A CODE IN BYTE 2   88700019
         SPACE 2                                                        88750019
         DS    14F       *                                              88800019
OPENERR  DS    F         *                                              88850019
DCBERR   DS    F         *    BYTE 1  = X'00'     DO NOT DISPLAY MSG    88900019
         DS    F         *            = X'FF'     DISPLAY THE MSG       88950019
EXITERR  DS    F         *                                              89000019
GMAINERR DS    F         *    BYTE 2  = X'03'     INSERT X'SYSUT1  '    89050019
         DS    F         *            = X'04'            X'SYSUT2  '    89100019
*                        *            = X'05'            X'SYSUT3  '    89150019
*                        *            = X'06'            X'OUTHDR2 '    89200019
*                        *            = X'07'            X'OUTTLR2 '    89250019
*                        *            = X'08'            X'OUTHDR3 '    89300019
*                        *            = X'09'            X'OUTTLR3 '    89350019
*                        *            = X'10'            X'OUTREC  '    89400019
*                        *            = X'11'            X'ERROR   '    89450019
*                        *                                              89500019
*                        *    BYTES 3,4           NOT USED              89550019
         SPACE 2                                                        89600019
MOUNTID  DS    F                   MOUNT MESSAGE ID                     89650019
         SPACE 2                                                        89700019
IOBADDR  DS    F                   IOB ADDRESS                          89750019
         SPACE 2                                                        89800019
BUFL     DS    2C                  BUFFER LENGTH                        89850019
         SPACE 2                                                        89900019
ERRIND   DS    C                   BIT 4 ON INDICATES READ/EDIT ERROR   89950019
*                                  BIT 2 ON INDICATES PERM I/O ERROR    90000019
*                                  BIT 1 ON INDICATES NO CORE AVAILABLE 90050019
*                                  BIT 0 ON INDICATES INCONSISTENT      90100019
*                                                       DCB PARAMETERS  90150019
         SPACE 1                                                        90200019
NODDCARD DS    C                   BIT 5 INDICATES SYSUT2 DD MISSING    90250019
*                                  BIT 4 INDICATES SYSUT3 DD MISSING    90300019
         EJECT                                                          90350019
         DS    3F                  EXIT LIST FOR SYSIN                  90400019
         DS    5F                  EXIT LIST FOR SYSPRINT               90450019
         DS    F                   EXIT LIST FOR SYSUT1                 90500019
         DS    3F                  EXIT LIST                            90550019
EXLST2   DS    2F                            FOR SYSUT2                 90600019
         DS    3F                  EXIT LIST                            90650019
EXLST3   DS    2F                            FOR SYSUT3                 90700019
         SPACE 3                                                        90750019
         DS    3F                  NOT USED BY R/E                      90800019
         SPACE 3                                                        90850019
UT2LRECL DS    2C                  SYSUT2 LRECL                         90900019
UT2BLKSI DS    2C                  SYSUT2 BLKSIZE                       90950019
UT2RECFM DS    2C                  SYSUT2 RECFM                         91000019
UT3LRECL DS    2C                  SYSUT3 LRECL                         91050019
UT3BLKSI DS    2C                  SYSUT3 BLKSIZE                       91100019
UT3RECFM DS    2C                  SYSUT3 RECFM                         91150019
         SPACE 3                                                        91200019
TCRDCB   DS    13F                 DCB FOR SYSUT1                       91250019
UT2DCB   DS    24F                 DCB FOR SYSUT2                       91300019
UT3DCB   DS    24F                 DCB FOR SYSUT3                       91350019
 TITLE ' IEBTCR05 - READ/EDIT MODULE -- DCB TEMPLATE'                   91400019
         DCBD  DSORG=PS                                                 91450019
         END                                                            91500019
./  ADD  SSI=32750241,NAME=IGE0011A
          TITLE 'IGE0011A - 2495 ERROR RECOVERY PROCEDURES'             00100019
* RELEASE VS2/ 2.0      ADDITION/CHANGES/DELETIONS               Y02992 00200002
*A306000,810000                                                  Y02992 00205002
*C087000,116000,156000,161000,165000,167000,169000,171000,179000 Y02992 00210002
*C189000,199000,232000,248000,333000-336000,347000,352000,356000 Y02992 00215002
*C359000,362000,365000-367000,374000,376000,388000-390000,       Y02992 00220002
*C392000-393000,400000,437000,468000,470000,472000-473000,481000 Y02992 00225002
*C483000-484000,486000-487000,490000,517000,523000-524000,533000 Y02992 00230002
*C553000-554000,558000,560000,565000,567000,569000-571000,573000 Y02992 00235002
*C574000-575000,579000-589000,600000,604000,638000,640000        Y02922 00240002
*C642000-645000,648000,650000,654000-659000,663000,666000,670000 Y02992 00245002
*C672000-675000,681000-682000,690000,719000,721000,723000,       Y02992 00250002
*C725000-726000,729000,731000,745000,752000-753000,759000-760000 Y02992 00255002
*C763000,765000-766000,777000,780000-789000,796000,798000,       Y02992 00260002
*C80000,801000,                                                  Y02992 00265002
*C352000,365000,470000,472000-473000,524000,558000,560000,567000 YM2509 00266002
*C589000,640000,666000,721000,745000,765600                      YM2509 00267002
*D117000-138000,208000-220000,235000-236000,238000-244000,       Y02992 00270002
*D250000-257000,378000-387000,700000,140000-160000               Y02922 00275002
*                                                                     * 00280002
*TITLE 'IGE0011A' - 2495 ERROR RECOVERY PROCEDURES                    * 00300019
*                                                                     * 00400019
*STATUS:  VS2/ RELEASE 2.0   CHANGE LEVEL 000                    Y02922 00500002
*                                                                     * 00600019
*FUNCTION/OPERATION:  IGE0011A IS SCHEDULED FOR EXECUTION WHENEVER THE* 00700019
*   I/O SUPERVISOR DETECTS AN ERROR ASSOCIATED WITH THE 2495 TAPE     * 00800019
*   CARTRIDGE READER THAT REQUIRES ERROR RECOVERY PROCEDURES.  THE    * 00900019
*   ROUTINES ARE NORMALLY SCHEDULED FOR THE FOLLOWING ERRORS:         * 01000019
*                                                                     * 01100019
*                 PROGRAM CHECK                                       * 01200019
*                 PROTECTION CHECK                                    * 01300019
*                 UNIT CHECK                                          * 01400019
*                 CHANNEL DATA CHECK                                  * 01500019
*                 UNIT EXCEPTION                                      * 01600019
*                 INCORRECT LENGTH                                    * 01700019
*                                                                     * 01800019
*   IF THE CHANNEL CHECK HANDLER (CCH) IS IN THE SYSTEM, THE ERROR    * 01900019
*   RECOVERY PROCEDURE IS ALSO ENTERED FOR CHANNEL CONTROL CHECKS AND * 02000019
*   INTERFACE CONTROL CHECKS.                                         * 02100019
*                                                                     * 02200019
*   THE ROUTINES MAY ALSO BE ENTERED WITH THE FOLLOWING CONDITIONS    * 02300019
*   FOLLOWING SUCCESSFUL RE-TRY OF A RECOVERABLE ERROR.  THESE        * 02400019
*   CONDITIONS ARE CONSIDERED NORMAL AND ARE TREATED ACCORDINGLY.     * 02500019
*                                                                     * 02600019
*                 BUSY                                                * 02700019
*                 CHANNEL END                                         * 02800019
*                 DEVICE END                                          * 02900019
*                                                                     * 03000019
*   THE ERROR ROUTINES USE THE STANDARD ERROR INTERPRETER ROUTINE     * 03100019
*   FOR TESTING OF SENSE BITS AND CSW STATUS BITS.  THE FOLLOWING     * 03200019
*   ACTIONS ARE TAKEN DEPENDING UPON THE NATURE OF THE ERROR:         * 03300019
*                                                                     * 03400019
*   1)  NORMAL CONDITION OR SUCCESSFUL RE-TRY OF RECOVERABLE ERROR    * 03500019
*       CONDITION                                                     * 03600019
*                                                                     * 03700019
*       IOB EXCEPTION AND ERROR FLAGS ARE CLEARED AND CONTROL IS      * 03800019
*       TRANSFERRED TO THE STATISTICS UPDATE ROUTINE.                 * 03900019
*                                                                     * 04000019
*   2)  RECOVERABLE ERROR                                             * 04100019
*                                                                     * 04200019
*       IOB ERROR FLAG IS SET.                                        * 04300019
*       IOB EXCEPTION FLAG IS CLEARED.                                * 04400019
*       ERROR COUNTS ARE UPDATED.                                     * 04500019
*       REPOSITION AND RESIDUAL READ CCW'S MAY BE CONSTRUCTED IN THE  * 04600019
*       UCB EXTENSION.                                                * 04700019
*       CONTROL IS PASSED TO THE I/O SUPERVISOR VIA SVC 15 AND SVC 3  * 04800019
*       TO RE-TRY THE CHANNEL PROGRAM.                                * 04900019
*                                                                     * 05000019
*   3)  PERMANENT ERROR                                               * 05100019
*                                                                     * 05200019
*   IOB ERROR AND EXCEPTION FLAGS ARE SET.                            * 05300019
*   IOB MESSAGE AND LOGOUT FLAGS MAY BE SET.                          * 05400019
*   CONTROL IS RETURNED TO THE I/O SUPERVISOR EITHER DIRECTLY         * 05500019
*   THROUGH ISSUANCE OF AN SVC 15 AND AN SVC 3 OR INDIRECTLY BY       * 05600019
*   FIRST PASSING CONTROL TO THE WTO ROUTINE WHICH IN TURN PASSES     * 05700019
*   CONTROL TO THE STATISTICS UPDATE ROUTINE AND THE I/O OUTBOARD     * 05800019
*   RECORDING ROUTINE, IF REQUIRED, AND EVENTUALLY TO THE I/O         * 05900019
*   SUPERVISOR.                                                       * 06000019
*                                                                     * 06100019
*   IF THE CHANNEL CHECK HANDLER (CCH) IS IN THE SYSTEM AND THE       * 06200019
*   ERROR RECOVERY PROCEDURE IS ENTERED FOR A CHANNEL CONTROL         * 06300019
*   CHECK OR AN INTERFACE CONTROL CHECK, THE ROUTINES ZERO OUT        * 06400019
*   THE ERROR RECOVERY PROCEDURE INTERFACE BYTES (ERPIB) CREATED      * 06500019
*   BY THE CCH AND HANDLE THE ERROR AS A PERMANENT ERROR.             * 06600019
*                                                                     * 06700019
*   STATISTICS ARE KEPT FOR THE FOLLOWING ERROR CONDITIONS:           * 06800019
*                                                                     * 06900019
*            INTERVENTION REQUIRED                                    * 07000019
*            EQUIPMENT CHECK                                          * 07100019
*            DATA CHECK                                               * 07200019
*            POSITION CHECK                                           * 07300019
*            CHANNEL DATA CHECK                                       * 07400019
*                                                                     * 07500019
*ENTRY POINTS:                                                        * 07600019
*                                                                     * 07700019
*        IGE0011A - ERROR RECOVERY PROCEDURE ENTRY POINT              * 07800019
*                                                                     * 07900019
*   THE ROUTINES ARE ENTERED INTO THE I/O SUPERVISOR TRANSIENT        * 08000019
*   AREA AND SCHEDULED FOR EXECUTION BY THE I/O INTERRUPTION          * 08100019
*   SUPERVISOR.                                                       * 08200019
*                                                                     * 08300019
*   DATA PASSED TO THE ROUTINES CONSISTS OF STANDARD SYSTEM CONTROL   * 08400019
*   BLOCKS.                                                           * 08500019
*                                                                     * 08600019
*INPUT:  IOSB POINTER IN REGISTER ONE                            Y02922 08700002
*                                                                     * 08800019
*OUTPUT:  I/O ERROR AND INTERVENTION REQUIRED MESSAGES IN SOME        * 08900019
*   INSTANCES                                                         * 09000019
*                                                                     * 09100019
*EXTERNAL ROUTINES:  NONE                                             * 09200019
*                                                                     * 09300019
*EXITS-NORMAL:  XCTL TO STATISTICS UPDATE ROUTINE FOLLOWING           * 09400019
*   SUCCESSFUL RECOVERY OF A RE-TRYABLE ERROR OR UPON DETECTION OF    * 09500019
*   A NORMAL CONDITION                                                * 09600019
*                                                                     * 09700019
*     -ERROR:                                                         * 09800019
*                                                                     * 09900019
*   1)  SVC 15 AND SVC 3 EXIT TO I/O SUPERVISOR FOR RE-EXECUTION      * 10000019
*   OF THE CHANNEL PROGRAM UPON DETECTION OF A RE-TRYABLE ERROR       * 10100019
*                                                                     * 10200019
*   2)  XCTL TO WTO ROUTINE FOR ISSUANCE OF AN INTERVENTION           * 10300019
*   REQUIRED MESSAGE AND QUEUEING OF THE I/O REQUEST IN THE CASE OF   * 10400019
*   INTERVENTION REQUIRED                                             * 10500019
*                                                                     * 10600019
*   3)  XCTL TO WTO ROUTINE FOR ISSUANCE OF A PERMANENT I/O ERROR     * 10700019
*   MESSAGE AND UPDATING OF STATISTICS AND LOGREC IN THE CASE OF      * 10800019
*   SOME PERMANENT ERRORS.                                            * 10900019
*                                                                     * 11000019
*   4)  SVC 15 AND SVC 3 EXIT TO I/O SUPERVISOR IN THE CASE OF SOME   * 11100019
*   PERMANENT I/O ERRORS.                                             * 11200019
*                                                                     * 11300019
*TABLES/WORK AREAS:                                                   * 11400019
*                                                                     * 11500019
*   1)   INPUT/OUTPUT SYSTEM BLOCK(IOSB)                         Y02922 11600002
*                                                                     * 13900019
*   2)   ERP WORK AREA                                           Y02922 16100002
*                                                                     * 16200019
*                                                                     * 16300019
*       *****************************************************         * 16400019
*   +40 *         BACKSPACE OR REPOSITION CCW                    Y02922 16500002
*       *****************************************************         * 16600019
*   +48 *         RESIDUAL READ CCW OR TIC CCW                   Y02922 16700002
*       *****************************************************         * 16800019
*   +56 *                   TIC CCW                              Y02922 16900002
*       *****************************************************         * 17000019
*   +64 *               IOSB CSW STORE                           Y02922 17100002
*       *****************************************************         * 17200019
*                                                                     * 17300019
*                                                                     * 17400019
*   3)      STATISTICS UPDATE TABLE                                   * 17500002
*                                                                     * 17600019
*ATTRIBUTES:  RE-ENTRANT                                              * 17700019
*                                                                     * 17800019
*NOTES:  32 BYTES IN THE ERP WORK AREA IS USED FOR CONSTRUCTION  Y02922 17900002
*   A BACKSPACE OR REPOSITION CCW, A RESIDUAL READ CCW, A TIC         * 18000019
*   COMMAND, AND A CSW STORAGE AREA FOR RE-TRYING OF POSITION CHECK,  * 18100019
*   DATA CHECK, AND CHANNEL DATA CHECK ERRORS.                        * 18200019
*                                                                     * 18300019
         EJECT                                                          18400019
IGE0011A START 0                                                        18500019
         SPACE 3                                                        18600019
*        REGISTER DEFINITIONS                                           18700019
         SPACE 2                                                        18800019
IOBREG   EQU   1                       IOSB REGISTER             Y02922 18900002
UCBEXT   EQU   2                       UCB EXTENSION                    19000019
CRBREG   EQU   3                       CURRENT RB REG                   19100019
CCWREG   EQU   4                       CCW ADDRESS REGISTER             19200019
LOGRCREG EQU   5                       LOGREC DCB ADDRESS               19300019
WKREG1   EQU   5                       WORK REGISTER                    19400019
WKREG2   EQU   6                       WORK REGISTER                    19500019
UCBREG   EQU   7                       UCB REG                          19600019
CVTREG   EQU   8                       CVT REG                          19700019
SAVEREG  EQU   9                       SAVE REG                         19800019
ERPREG   EQU   10                      ERP WORK AREA REGISTER    Y02922 19900002
LNKREG   EQU   12                      LINK REG                         20000019
WKREG3   EQU   13                      WORK REGISTER                    20100019
RETREG   EQU   14                      RETURN REG                       20200019
BASEREG  EQU   15                      BASE REG                         20300019
         SPACE 2                                                        20400019
*        IOB DEFINITION                                                 20500019
         SPACE 1                                                        20600019
IOBFLAG1 EQU   0                       FLAGS 1                          20700019
         SPACE 1                                                        22100019
*        IOBFLAG1 INDICATORS                                            22200019
         SPACE 1                                                        22300019
IOBCP1   EQU   X'80'                   DATA CHAINING                    22400019
IOBCP2   EQU   X'40'                   COMMAND CHAINING                 22500019
IOBERR   EQU   X'20'                   IOB ERROR FLAG                   22600019
IOBEX    EQU   X'04'                   IOB EXCEPTION FLAG               22700019
         EJECT                                                          22900019
*        IOBFLAG3 INDICATORS                                            23000019
         SPACE 2                                                        23100019
IOBCDCK  EQU   X'20'                   CHANNEL DATA CHECK COUNT         23300019
IOBBUS   EQU   X'10'                   BUS-OUT ERROR COUNT              23400019
IOBENT   EQU   X'04'                   IOB ENTRY BIT             Y02922 23500002
         SPACE 2                                                        23700019
*        UCB DEFINITION                                                 24500019
         SPACE 1                                                        24600019
UCBSTI   EQU   9                       STATISTICS POINTER               24700019
         SPACE 2                                                        24900019
         SPACE 2                                                        25800019
*        CSW INDICATORS                                                 25900019
         SPACE 1                                                        26000019
CSWUCK   EQU   X'02'                   UNIT CHECK                       26100019
CSWCHE   EQU   X'08'                   CHANNEL END                      26200019
CSWDVE   EQU   X'04'                   DEVICE END                       26300019
CSWCEDE  EQU   X'0C'                   CHANNEL OR DEVICE END            26400019
CSWCDK   EQU   X'08'                   CHANNEL DATA CHECK               26500019
         SPACE 2                                                        26600019
*        CCW FLAGS AND COMMANDS                                         26700019
         SPACE 1                                                        26800019
CCFLAG   EQU   X'40'                   COMMAND CHAINING CCW FLAG        26900019
CCWFLAGS EQU   X'30'                   CCW SLI AND SKIP MASK            27000019
CTRLCMD  EQU   X'03'                   CONTROL COMMAND                  27100019
REPOCMD  EQU   X'27'                   CONTROL BACKSPACE                27200019
READCMD  EQU   X'02'                   READ                             27300019
TICCMD   EQU   X'08'                   TIC                              27400019
         EJECT                                                          27500019
*        MISCELLANEOUS DEFINITIONS                                      27600019
         SPACE 1                                                        27700019
FOUR     EQU   4                       FOUR                             27800019
TEN      EQU   10                      TEN                              27900019
HEXTEN   EQU   X'0A'                   HEXADECIMAL TEN                  28000019
POSCLR   EQU   X'0F'                   POSITION CHECK COUNT CLEAR       28100019
DCKCLR   EQU   X'F0'                   DATA CHECK COUNT CLEAR           28200019
EXCPER   EQU   15                      ERROR EXCP                       28300019
RETURN   EQU   3                       SVC RETURN                       28400019
IOBCC1   EQU   X'10'                   CONDITION CODE OF SIO            28500019
LOC016   EQU   16                      COMMUNICATION TABLE              28600019
VECTXL   EQU   44                      VECTOR TO XCTL ROUTINE           28700019
VECINT   EQU   68                      VECTOR TO INTERPRETER ROUTINE    28800019
VECWTO   EQU   72                      VECTOR TO WTO ROUTINE            28900019
STATAB   EQU   112                     INDEX TO STATISTICS TABLE        29000019
WTORTN   EQU   253                     LOAD NAME TO WTO RTN             29100019
STATUP   EQU   254                     LOAD NAME TO STAT. UPDATE RTN    29200019
IOBEXER  EQU   IOBEX+IOBERR            IOB EX + IOB ERR FLAG            29300019
IOBINCPT EQU   X'7E'                   INTERCEPT CONDITION              29400019
ZERO     EQU   X'00'                   ZERO                             29500019
STABIT   EQU   X'7A'                   SENSE BITS REQUIRING STATISTICS  29600019
INTREQ   EQU   X'40'                   INT. REQ. BIT IN SENSE BYTE      29700019
ERRORECB EQU   X'7F'                   IOB ECB ERROR COMPLETION CODE    29800019
SNSDCK   EQU   X'08'                   DATACHECK                        29900019
CVTDCB   EQU   116                     LOGREC DCB POINTER               30000019
LASTERIB EQU   X'FF'                   LAST ERIB TABLE ENTRY            30100019
TICTEST1 EQU   X'07'                   TIC COMMAND TEST 1               30200019
TICTEST2 EQU   X'08'                   TIC COMMAND TEST 2               30300019
CHADCK   EQU   X'01'                   STAT TABLE CHAN DATA CHK ENTRY   30400019
LEFTTEN  EQU   X'A0'                   HEXIDECIMAL TEN                  30500019
CCCICC   EQU   X'06'                   CHANNEL CTRL CHK OR INT CTRL CHK 30600019
MASK1    EQU   X'C0'                   MASK OUT IOSFLC           Y02922 30650002
         EJECT                                                          30700019
*        2495 ERROR RECOVERY PROCEDURES                                 30800019
         SPACE 1                                                        30900019
*        THE FOLLOWING IS A LIST OF ERRORS HANDLED BY THIS ERROR        31000019
*        RECOVERY PROCEDURE AND THE MAIN PROCESSING ROUTINE ENTRY       31100019
*        POINT ASSOCIATED WITH EACH.                                    31200019
*                                                                       31300019
*                 CHANNEL CONTROL CHECK - ERR130                        31400019
*               INTERFACE CONTROL CHECK - ERR130                        31500019
*                         PROGRAM CHECK - ERR040                        31600019
*                      PROTECTION CHECK - ERR040                        31700019
*                            UNIT CHECK - ERR045                        31800019
*                    CHANNEL DATA CHECK - ERR070                        31900019
*                        UNIT EXCEPTION - ERR120                        32000019
*                      INCORRECT LENGTH - ERR120                        32100019
*                       EQUIPMENT CHECK - ERR055                        32200019
*                         BUS-OUT CHECK - ERR050                        32300019
*                 INTERVENTION REQUIRED - ERR065                        32400019
*                        POSITION CHECK - ERR080                        32500019
*                            DATA CHECK - ERR100                        32600019
*                        COMMAND REJECT - ERR060                        32700019
         SPACE 2                                                        32800019
*        THIS SECTION SETS UP CONTROL BLOCK POINTERS AND TESTS FOR      32900019
*        DATA CHAINING AND MIXED CHAINING.                              33000019
         SPACE 2                                                        33100019
         USING ER2495,BASEREG          INDICATE BASE REGISTER           33200019
         USING IOSB,IOBREG             BASE REG FOR IOSB         Y02922 33300002
         USING EWA,ERPREG              BASE REG FOR ERP WORK AREAY02922 33380002
ER2495   L     ERPREG,IOSERP           LOAD ERP WORKAREA ADDR    Y02922 33460002
         L     UCBREG,IOSUCB           LOAD UCB ADDRESS          Y02922 33540002
         L     CVTREG,LOC016           LOAD CVT ADDRESS          Y02922 33620002
         OI    IOBFLAG1(IOBREG),IOBEXER  SET IOB EX AND ERROR FLAGS     33700019
         TM    IOBFLAG1(IOBREG),IOBCP1 DATA CHAINING OR MIXED CHAINING  33800019
         BO    ERR130                  BR YES                           33900019
         SPACE 2                                                        34000019
*        THIS SECTION DEVELOPS THE FAILING CCW ADDRESS, TESTS           34100019
*        WHETHER OR IT IS ZERO OR NEGATIVE, AND TESTS FOR THE SAME      34200019
*        ERROR IF THIS IS NOT THE FIRST ENTRY TO THE ERP.  IF IT        34300019
*        IS NOT THE SAME ERROR, THIS SECTION ZEROES ALL RECOVERABLE     34400019
*        ERROR COUNTS AND STORES THE NEW CSW                            34500019
         SPACE 2                                                        34600019
ERR015   L     CCWREG,IOSCSW-1         LOAD CCW ADDRESS          Y02922 34700002
         LA    CCWREG,0(CCWREG)        ZERO HIGH-ORDER BYTE             34800019
         SH    CCWREG,CCWLNG           BACK UP ONE CCW                  34900019
         LTR   CCWREG,CCWREG           CCW ADDRESS ZERO OR NEGATIVE     35000019
         BNP   ERR150                  BR YES, INTERCEPT CONDITION      35100019
         TM    EWAFLG3,IOBENT          ENTRY BIT ON              YM2509 35200002
         BZ    ERR020                  BR NO                            35300019
         TM    IOBFLAG1(IOBREG),IOBCP2  COMMAND CHAINING SPECIFIED      35400019
         BZ    ERR025                  BR NO                            35500019
         LA    WKREG1,EWCCCW1          TEST CURRENT CCW WITHIN   Y02922 35600002
         CLR   WKREG1,CCWREG             EXTENSION                      35700019
         BE    ERR025                  BR YES                           35800019
         LA    WKREG1,EWCCCW2          2ND CCW                   Y02922 35900002
         CLR   WKREG1,CCWREG                                            36000019
         BE    ERR025                  BR YES                           36100019
         CLC   EWCCSW+1(3),IOSCSW      SAME CCW WITHIN           Y02922 36200002
*                                        CHAIN                          36300019
         BE    ERR025                  BR YES                           36400019
         MVI   EWAFLG3,ZERO            CLEAR COUNTERS            YM2509 36500002
         MVI   EWACNTR4,ZERO           CLEAR COUNTERS            Y02922 36600002
ERR020   MVC   EWCCSW+1(7),IOSCSW      STORE NEW CSW             Y02922 36700002
         SPACE 2                                                        36800019
*        IF UNIT CHECK IS ON, THIS SECTION OR'S THE SENSE BYTE INTO     36900019
*        THE FIRST BYTE OF THE STATISTICS TABLE WORK AREA.  IF          37000019
*        CHANNEL DATA CHECK IS ON, IT SETS BIT 7 OF BYTE TWO OF THE     37100019
*        STATISTICS TABLE WORK AREA TO ONE.                             37200019
         SPACE 2                                                        37300019
ERR025   TM    IOSTSB,CSWCDK           CHANNEL DATA CHECK        Y02922 37400002
         BO    ERR026                  BRANCH IF YES                    37500019
         TM    IOSTSA,CSWUCK           TEST IF UNIT CHECK        Y02922 37600002
         BZ    ERR030                  BR IF NO                         37700019
ERR026   OC    EWASTUP(1),IOSSNS       OR SENSE BYTE INTO TABLE  Y02922 38800002
         NI    EWASTUP,STABIT          MASK OUT UNWANTED BITS    Y02922 38900002
         TM    IOSTSB,CSWCDK           CHANNEL DATA CHECK        Y02922 39000002
         BZ    ERR030                  BRANCH IF NO                     39100019
         OI    EWASTUP+1,CHADCK        SET BIT 7 OF STATISTICS   Y02922 39200002
*                                      TABLE WORKAREA BYTE 2 TO 1Y02922 39300002
         EJECT                                                          39400019
*        THIS SECTION USES THE COMMON INTERPRETER ROUTINE TO ANALYZE    39500019
*        CSW STATUS BITS.                                               39600019
         SPACE 2                                                        39700019
ERR030   LR    SAVEREG,BASEREG         SAVE BASE ADDRESS                39800019
         L     BASEREG,VECINT(CVTREG)  LOAD ADDR INTERPRETER RTN        39900019
ERR033   BALR  RETREG,BASEREG          LINK TO INTERPRETER RTN   Y02922 40000002
         SPACE 1                                                        40100019
         DC    X'1D'                   CHANNEL CONTROL CHECK ID         40200019
         DC    AL1(ERR034-ERR033-2)    CHANNEL CONTROL CHECK DISP       40300019
         DC    X'1E'                   INTERFACE CONTROL CHECK ID       40400019
         DC    AL1(ERR034-ERR033-4)    INTERFACE CONTROL CHECK DISP     40500019
         DC    X'1A'                   PROGRAM CHECK ID                 40600019
         DC    AL1(ERR040-ERR033-6)    PROGRAM CHECK DISPLACEMENT       40700019
         DC    X'1B'                   PROTECTION CHECK IDENT           40800019
         DC    AL1(ERR040-ERR033-8)    PROTECTION CHECK DISPLACEMENT    40900019
         DC    X'16'                   UNIT CHECK ID                    41000019
         DC    AL1(ERR045-ERR033-10)   UNIT CHECK DISPLACEMENT          41100019
         DC    X'1C'                   CHANNEL DATA CHECK ID            41200019
         DC    AL1(ERR035-ERR033-12)   CHANNEL DATA CHECK DISP          41300019
         DC    X'17'                   UNIT EXCEPTION ID                41400019
         DC    AL1(ERR036-ERR033-14)   UNIT EXCEPTION DISPLACEMENT      41500019
         DC    X'19'                   INCORRECT LENGTH ID              41600019
         DC    AL1(ERR036-ERR033-16)   INCORRECT LENGTH DISPL           41700019
         DC    X'2F'                   END OF TEST ID                   41800019
         DC    AL1(ERR037-ERR033-18)   END OF TEST DISPLACEMENT         41900019
         SPACE 1                                                        42000019
ERR034   B     ERR130                  CCC AND ICC PROCESSING           42100019
ERR035   B     ERR070                  CHANNEL DATA CHECK PROCESSING    42200019
ERR036   B     ERR120                  U.E. AND I.L. PROCESSING         42300019
ERR037   B     ERR125                  CORRECTED ERROR PROCESSING       42400019
         SPACE 2                                                        42500019
*        PERMANENT ERROR EXIT - NO LOGOUT OR MESSAGE OUTPUT             42600019
         SPACE 1                                                        42700019
ERR040   NI    IOBFLAG1(IOBREG),X'FF'-IOBERR  CLEAR ERROR FLAG          42800019
         SVC   EXCPER                  ERROR EXCP                       42900019
         SVC   RETURN                  RETURN                           43000019
         EJECT                                                          43100019
*        THIS SECTION USES THE COMMON INTERPRETER ROUTINE TO ANALYZE    43200019
*        CSW STATUS BITS AND SENSE BITS ON A UNIT CHECK CONDITION.      43300019
         SPACE 1                                                        43400019
ERR045   LR    SAVEREG,BASEREG         SAVE BASE ADDRESS                43500019
         L     BASEREG,VECINT(CVTREG)  LOAD ADDR INTERPRETER RTN        43600019
ERR046   BALR  RETREG,BASEREG          LINK TO INTERPRETER RTN   Y02922 43700002
         SPACE 1                                                        43800019
         DC    X'05'                   SENSE BIT 5 (NOT USED)           43900019
         DC    AL1(ERR060-ERR046-2)    SENSE BIT 5 DISPLACEMENT         44000019
         DC    X'07'                   SENSE BIT 7 (NOT USED)           44100019
         DC    AL1(ERR060-ERR046-4)    SENSE BIT 7 DISPLACEMENT         44200019
         DC    X'03'                   EQUIPMENT CHECK ID               44300019
         DC    AL1(ERR055-ERR046-6)    EQUIPMENT CHECK DISP             44400019
         DC    X'1C'                   CHANNEL DATA CHECK ID            44500019
         DC    AL1(ERR070-ERR046-8)    CHANNEL DATA CHECK DISP          44600019
         DC    X'02'                   BUS-OUT CHECK ID                 44700019
         DC    AL1(ERR050-ERR046-10)   BUS-OUT CHECK DISP               44800019
         DC    X'01'                   INTERVENTION REQUIRED ID         44900019
         DC    AL1(ERR065-ERR046-12)   INTERVENTION REQ'D DISP          45000019
         DC    X'06'                   POSITION CHECK ID                45100019
         DC    AL1(ERR047-ERR046-14)   POSITION CHECK DISP              45200019
         DC    X'04'                   DATA CHECK ID                    45300019
         DC    AL1(ERR048-ERR046-16)   DATA CHECK DISP                  45400019
         DC    X'00'                   COMMAND REJECT ID                45500019
         DC    AL1(ERR060-ERR046-18)   COMMAND REJECT DISP              45600019
         DC    X'2F'                   END OF TEST ID                   45700019
         DC    AL1(ERR060-ERR046-20)   PERMANENT ERROR PROCESSING       45800019
         SPACE 1                                                        45900019
ERR047   B     ERR080                  POSITION CHECK PROCESSING        46000019
ERR048   B     ERR100                  DATA CHECK PROCESSING            46100019
         SPACE 2                                                        46200019
*        BUS-OUT CHECK PROCESSING                                       46300019
         SPACE 1                                                        46400019
*        IF THE BUS-OUT ERROR OCCURS AT INITIAL SELECTION, THE          46500019
*        THE FAILING CCW IS RE-EXECUTED ONE TIME.                       46600019
         SPACE 2                                                        46700019
ERR050   TM    IOSTSA,CSWCEDE          CHANNEL OR DEVICE END     Y02922 46800002
         BNZ   ERR055                  BR-YES  (NOT INITIAL SELECTION)  46900019
         TM    EWAFLG3,IOBBUS          ERROR COUNT EQUAL TO ONE  YM2509 47000002
         BO    ERR055                  BR-YES                           47100019
         OI    EWAFLG3,IOBBUS          SET ERROR CNT EQUAL TO 1  YM2509 47200002
ERR053   OI    EWAFLG3,IOBENT          SET ENTRY BIT ON          YM2509 47300002
         SVC   EXCPER                  ERROR EXCP                       47400019
         SVC   RETURN                  RETURN                           47500019
         EJECT                                                          47600019
*        PERMANENT ERROR EXIT - WITH WTO MESSAGE AND LOGOUT             47700019
         SPACE 1                                                        47800019
*        IF THE FAILING CCW IS THE READ CCW WITHIN THE EXTENSION,       47900019
*        THE IOB CSW ADDRESS IS REPLACED BY THE ORIGINAL FAILING CCW    48000019
*        ADDRESS WHICH HAS BEEN STORED IN THE ERP WORK AREA      Y02922 48100002
         SPACE 2                                                        48200019
ERR055   OI    IOSFLB,IOSLOG           SET LOG OUT BIT           Y02922 48300002
ERR060   OI    IOSFLB,IOSMSG           SET MESSAGE BIT           Y02922 48400002
         NI    IOBFLAG1(IOBREG),X'FF'-IOBERR  CLEAR ERROR FLAG          48500019
         LA    WKREG1,EWCCCW2          SET POINTER TO READ CCW   Y02922 48600002
*                                      WITHIN WORK AREA          Y02922 48700002
         CLR   CCWREG,WKREG1           IS IT READ CCW                   48800019
         BNE   ERR062                  BR NO                            48900019
         MVC   IOSCSW(3),EWCCSW+1      RESTORE ORGINAL CSW       Y02922 49000002
ERR062   LA    WKREG3,WTORTN           GET LOAD NAME TO WTO RTN         49100019
ERR064   L     RETREG,VECTXL(CVTREG)   GET ADDRESS XCTL ROUTINE         49200019
         BR    RETREG                  XCTL TO WTO RTN                  49300019
         EJECT                                                          49400019
*        INTERVENTION REQUIRED                                          49500019
         SPACE 2                                                        49600019
*        ONE OF FOUR  SITUATIONS IS POSSIBLE:                           49700019
*                                                                       49800019
*        1)  THE INTERVENTION REQUIRED OCCURRED AT INITIAL SELECTION    49900019
*            (NO CHANNEL OR DEVICE END)                                 50000019
*                                                                       50100019
*        2)  THE INTERVENTION REQUIRED OCCURRED DURING TRANSFER         50200019
*            OF DATA.  (INDICATED BY CHANNEL END ALONE OR BY CHANNEL    50300019
*            END AND DEVICE END IF COMMAND CHAINING WAS USED)           50400019
*                                                                       50500019
*        3)  INTERVENTION REQUIRED OCCURRED FOLLOWING A TRANSFER        50600019
*            OF DATA DURING WHICH A UNIT CHECK CONDITION OCCURRED       50700019
*            BUT PRIOR TO ISSUANCE OF THE SENSE COMMAND (INDICATED      50800019
*            BY CHANNEL END, UNIT CHECK, AND SOME OTHER ERROR)          50900019
*                                                                       51000019
*        4)  INTERVENTION REQUIRED OCCURRED AT DEVICE END.  IN THIS     51100019
*            CASE, THE STATUS IS STORED IN THE UCB UNTIL THE NEXT       51200019
*            SIO IS ISSUED.  AT THAT TIME THE CSW IS TRANSFERRED TO     51300019
*            THE IOB AND AN INTERCEPT CONDITION IS INDICATED. (THE      51400019
*            IOB ECB CONDITION CODE IS SET TO '7E'.)                    51500019
           SPACE 2                                                      51600019
ERR065   TM    IOSTSA,CSWCEDE          CHANNEL OR DEVICE END     Y02922 51700002
         BNZ   ERR067                  BR YES                           51800019
         SPACE 1                                                        51900019
*        ON INITIAL SELECTION XCTL TO THE WTO ROUTINE TO ISSUE THE      52000019
*        INTERVENTION REQUIRED MESSAGE AND RETRY THE COMMAND            52100019
         SPACE 1                                                        52200019
ERR066   NI    IOSFLC,X'FF'-IOSMSG     SET IOSB MSG BIT TO ZERO  Y02922 52300002
         OI    EWAFLG3,IOBENT          SET ENTRY BIT ON          YM2509 52400002
         B     ERR062                  BRANCH TO XCTL TO WTO ROUTINE    52500019
         SPACE 1                                                        52600019
*        ON A COMPLETED READ (CHANNEL END OR DEVICE END PRESENT)        52700019
*        IGNORE THE INTERVENTION REQUIRED AND CONTINUE CHECKING AS      52800019
*        INDICATED IN THE STANDARDS CHART                               52900019
         SPACE 1                                                        53000019
ERR067   LR    SAVEREG,BASEREG         SAVE BASE ADDRESS                53100019
         L     BASEREG,VECINT(CVTREG)  LOAD ADDR INTERPRETER RTN        53200019
ERR068   BALR  RETREG,BASEREG          LINK TO INTERPRET RTN     Y02922 53300002
         SPACE 1                                                        53400019
         DC    X'06'                   POSITION CHECK ID                53500019
         DC    AL1(ERR080-ERR068-2)    POSITION CHECK DISP              53600019
         DC    X'04'                   DATA CHECK ID                    53700019
         DC    AL1(ERR0683-ERR068-4)   DATA CHECK DISP                  53800019
         DC    X'00'                   COMMAND REJECT ID                53900019
         DC    AL1(ERR0684-ERR068-6)   COMMAND REJECT DISP              54000019
         DC    X'2F'                   END OF TEST                      54100019
         DC    AL1(ERR0685-ERR068-8)   CORRECTED ERROR PROCESSING       54200019
         SPACE 1                                                        54300019
ERR0683  B     ERR100                  DATA CHECK                       54400019
ERR0684  B     ERR060                  PERMANENT ERROR                  54500019
ERR0685  B     ERR125                  CORRECTED ERROR                  54600019
         SPACE 1                                                        54700019
         EJECT                                                          54800019
*        CHANNEL DATA CHECK PROCESSING                                  54900019
         SPACE 1                                                        55000019
*        IF THE CHANNEL DATA CHECK OCCURRED ON A READ COMMAND,          55100019
*        A REPOSITION CCW AND A TIC TO THE FAILING CCW ARE CONSTRUCTED  55200019
*        IN THE ERP WORKAREA. SVC 15 AND SVC 3 ARE ISSUED TO     Y02922 55300002
*        RETRY THE OPERATION ONE TIME.                           Y02922 55400002
         SPACE 2                                                        55500019
ERR070   TM    0(CCWREG),CTRLCMD       CONTROL COMMAND                  55600019
         BO    ERR075                  BR-YES                           55700019
         TM    EWAFLG3,IOBCDCK         ERROR COUNT EQUAL TO ONE  YM2509 55800002
         BO    ERR055                  BR-YES                           55900019
         OI    EWAFLG3,IOBCDCK         SET COUNT EQUAL TO ONE    YM2509 56000002
         SPACE 1                                                        56100019
*        IF THE CURRENT ERROR OCCURRED ON A RETRY OPERATION AND THE     56200019
*        PREVIOUS ERROR WAS DIFFERENT, CLEAR ALL OTHER COUNTS.          56300019
         SPACE 1                                                        56400019
         CLC   EWCCSW+6(2),IOSCSWRC    COMPARE RESIDUAL COUNT    Y02922 56500002
         BE    ERR071                  BR EQUAL                         56600019
         NI    EWAFLG3,X'FF'-IOBBUS-IOBCDCK                      YM2509 56700002
*                                      AND CHANNEL DATA CHECK COUNTS    56800019
         MVI   EWACNTR3,ZERO           CLEAR POSITION AND DATA   Y02922 56900002
*                                      CHECK COUNTS              Y02922 57000002
         MVC   EWCCSW+6(2),IOSCSWRC    STORE NOW COUNT           Y02922 57100002
ERR071   LH    WKREG2,6(CCWREG)        LOAD ORIGINAL COUNT              57200019
         SH    WKREG2,IOSCSWRC         SUBTRACT RESIDUAL COUNT   Y02922 57300002
         STH   WKREG2,EWCCCW1+6        STORE REPOSITION COUNT    Y02922 57400002
         LA    WKREG1,EWCCCW2          SET PTR TO 2ND CCW WITHIN Y02922 57500002
*                                        EXTENSION                      57600019
         CLR   CCWREG,WKREG1           CURRENT CCW WITHIN EXTENSION     57700019
         BE    ERR073                  BR YES                           57800019
         MVI   EWCCCW1,REPOCMD         SET UP REPOSTION CMND     Y02922 57900002
         MVC   EWCCCW1+1(3),1(CCWREG)  SET DUMMY ADDRESS         Y02922 58000002
         MVI   EWCCCW1+4,CCWFLAGS      SET SLI AND SKIP MASK     Y02922 58100002
         NC    EWCCCW1+4(1),4(CCWREG)  SET FLAGS IF REQUIRED     Y02922 58200002
         OI    EWCCCW1+4,CCFLAG        SET COMMAND CHAINING FLAG Y02922 58300002
         LRA   WKREG2,0(CCWREG)        LOAD REAL CCW ADDRESS     Y02922 58400002
         ST    WKREG2,EWCCCW2          STORE CCW ADDRESS IN TIC  Y02922 58500002
         MVI   EWCCCW2,TICCMD          SET UP TIC COMMAND        Y02922 58600002
ERR072   LRA   WKREG1,EWCCCW1          LOAD REAL ADDRESS REPO CCWY02922 58700002
         ST    WKREG1,IOSRST           STORE ADDRESS IN RESTART  Y02922 58800002
         OI    EWAFLG3,IOBENT          SET ENTRY BIT ON          YM2509 58900002
ERR073   SVC   EXCPER                  ERROR EXCP                       59000019
         SVC   RETURN                  RETURN                           59100019
         EJECT                                                          59200019
*        CHANNEL DATA CHECK - CONTROL COMMAND                           59300019
         SPACE 1                                                        59400019
*        IF THE CHANNEL DATA CHECK OCCURRED ON A CONTROL COMMAND,       59500019
*        CONTINUE TESTING THE REMAINING SENSE BITS.  IF NO OTHER        59600019
*        ERROR IS FOUND, IGNORE THE CHANNEL DATA CHECK AND              59700019
*        CONTINUE.                                                      59800019
         SPACE 2                                                        59900019
ERR075   TM    IOSTSA,CSWUCK           TEST IF UNIT CHECK        Y02922 60000002
         BZ    ERR125                  BR NO                            60100019
         LR    SAVEREG,BASEREG         SAVE BASE ADDRESS                60200019
         L     BASEREG,VECINT(CVTREG)  LOAD ADDR INTERPRETER RTN        60300019
ERR077   BALR  RETREG,BASEREG          LINK TO INTERPRETER RTN   Y02922 60400002
         SPACE 1                                                        60500019
         DC    X'02'                   BUS OUT IDENT                    60600019
         DC    AL1(ERR078-ERR077-2)    BUS-OUT DISPLACEMENT             60700019
         DC    X'01'                   INTERVENTION REQUIRED ID         60800019
         DC    AL1(ERR0783-ERR077-4)   INTERVENTION REQ'D DISP          60900019
         DC    X'06'                   POSITION CHECK ID                61000019
         DC    AL1(ERR080-ERR077-6)    POSITION CHECK DISP              61100019
         DC    X'04'                   DATA CHECK ID                    61200019
         DC    AL1(ERR100-ERR077-8)    DATA CHECK DISPLACEMENT          61300019
         DC    X'00'                   COMMAND REJECT ID                61400019
         DC    AL1(ERR0785-ERR077-10)  COMMAND REJECT DISPLACEMENT      61500019
         DC    X'2F'                   END OF TEST                      61600019
         DC    AL1(ERR125-ERR077-12)   CORRECTED ERROR PROCESSING       61700019
         SPACE 1                                                        61800019
ERR078   B     ERR050                  BUS-OUT                          61900019
ERR0783  B     ERR065                  INTERVENTION REQ'D PROCESSING    62000019
ERR0785  B     ERR060                  COMMAND REJECT PROCESSING        62100019
         EJECT                                                          62200019
*        POSITION CHECK PROCESSING                                      62300019
         SPACE 1                                                        62400019
*        IF THE POSITION CHECK OCCURRED ON A READ COMMAND,              62500019
*        BACKSPACE CCW AND A RESIDUAL READ CCW ARE CONSTRUCTED          62600019
*        IN THE UCB EXTENSION AND SVC 15 AND SVC 3 ARE ISSUED TO        62700019
*        RE-TRY THE OPERATION.  IF COMMAND CHAINING WAS SPECIFIED,      62800019
*        A TIC COMMAND WHICH BRANCHES TO THE NEXT COMMAND IN THE        62900019
*        CHAIN IS ALSO CONSTRUCTED.                                     63000019
         SPACE 2                                                        63100019
ERR080   TM    0(CCWREG),CTRLCMD       CONTROL COMMAND                  63200019
         BO    ERR055                  BR-YES                           63300019
         SPACE 1                                                        63400019
*        IF THE CURRENT ERROR OCCURRED ON A RETRY OPERATION AND IS      63500019
*        DIFFERENT FROM THE ORIGINAL ERROR, CLEAR ALL OTHER COUNTS.     63600019
         SPACE 1                                                        63700019
         CLC   EWCCSW+6(2),IOSCSWRC    COMPARE RESIDUAL COUNT    Y02922 63800002
         BE    ERR082                  BR EQUAL                         63900019
         NI    EWAFLG3,X'FF'-IOBCDCK-IOBBUS CLEAR BUSOUT         YM2509 64000002
*                                        AND CHANNEL DATA CHECK COUNTS  64100019
         MVI   EWACNTR3,ZERO           CLEAR DATA CHECK AND      Y02922 64200002
*                                      POSTION CHECK COUNTS      Y02922 64300002
         MVC   EWCCSW+6(2),IOSCSWRC    STORE NEW COUNT           Y02922 64400002
ERR082   TM    EWACNTR3,LEFTTEN        COUNT EQUAL TEN           Y02922 64500002
         BO    ERR055                  BR YES                           64600019
         XR    WKREG1,WKREG1           CLEAR REGISTER                   64700019
         IC    WKREG1,EWACNTR3         INSERT ERROR COUNT        Y02922 64800002
         LA    WKREG1,16(WKREG1)       INCREMENT POSITION CHECK COUNT   64900019
         STC   WKREG1,EWACNTR3         STORE NEW COUNT           Y02922 65000002
         SPACE 1                                                        65100019
*        CONSTRUCT BACKSPACE CCW                                        65200019
         SPACE 1                                                        65300019
ERR085   MVI   EWCCCW1,REPOCMD         SET UP BACKSPACE COMMAND  Y02922 65400002
         MVC   EWCCCW1+1(3),1(CCWREG)  SET UP DUMMY ADDRESS      Y02922 65500002
         MVI   EWCCCW1+4,CCWFLAGS      SET SLI AND SKIP MASK     Y02922 65600002
         NC    EWCCCW1+4(1),4(CCWREG)  SET FLAGS IF REQUIRED     Y02922 65700002
         OI    EWCCCW1+4,CCFLAG        SET COMMAND CHAINING FLAG Y02922 65800002
         MVC   EWCCCW1+6(2),BACKCNT    SET COUNT EQUAL TO ONE    Y02922 65900002
         SPACE 1                                                        66000019
*        CONSTRUCT RESIDUAL READ CCW                                    66100019
         SPACE 1                                                        66200019
         LH    WKREG2,IOSCSWRC         LOAD RESIDUAL COUNT       Y02922 66300002
         LA    WKREG2,1(WKREG2)        INCREMENT BY ONE                 66400019
         LH    WKREG1,6(CCWREG)        LOAD ORIGINAL COUNT              66500019
         STH   WKREG2,EWCCCW2+6        STORE RESIDUAL READ COUNT YM2509 66600002
         SR    WKREG1,WKREG2           SUBTRACT RESIDUAL COUNT FROM     66700019
*                                        ORIGINAL COUNT                 66800019
         L     WKREG2,0(CCWREG)        LOAD ORIGINAL DATA ADDRESS       66900019
         N     WKREG2,MASK2            MASK OUT HIGH ORDER BYTE  Y02922 67000002
         AR    WKREG2,WKREG1           INCREMENT TO LAST BYTE FILLED    67100019
         ST    WKREG2,EWCCCW2          STORE NEW DATA ADDRESS    Y02922 67200002
         MVI   EWCCCW2,READCMD         SET UP READ COMMAND       Y02922 67300002
         LA    WKREG1,EWCCCW2          SET POINTER TO READ CCW   Y02922 67400002
*                                      WITHIN EXTENSION          Y02922 67500002
         CLR   CCWREG,WKREG1           CURRENT CCW WITHIN EXTENSION     67600019
         BE    ERR073                  BR YES                           67700019
         SPACE 1                                                        67800019
*        SET UP CCW FLAGS                                               67900019
         SPACE 1                                                        68000019
         MVI   EWCCCW2+4,CCWFLAGS      SET SLI MASK              Y02922 68100002
         NC    EWCCCW2+4(1),4(CCWREG)  SET SLI FLAG IF REQUIRED  Y02922 68200002
         SPACE 1                                                        68300019
*        ON COMMAND CHAINING CONSTRUCT TIC TO NEXT CCW                  68400019
         SPACE 1                                                        68500019
         TM    IOBFLAG1(IOBREG),IOBCP2  COMMAND CHAINING SPECIFIED      68600019
         BZ    ERR072                  BR NO                            68700019
         TM    4(CCWREG),IOBCP2        COMMAND CHAINING THIS CCW        68800019
         BZ    ERR072                  BR-NO                            68900019
         OI    EWCCCW2+4,CCFLAG        SET COMMAND CHAINING FLAG Y02922 69000002
         SPACE 1                                                        69100019
*        IF NEXT INSTRUCTION IS TIC, REMOVE ADDRESS AND INSERT IN       69200019
*        TRANSFERRING TIC                                               69300019
         SPACE 1                                                        69400019
         TM    8(CCWREG),TICTEST1      COMMAND CODE BITS 5,6,7 ALL ZERO 69500019
         BNZ   ERR090                  BRANCH NO                        69600019
         TM    8(CCWREG),TICTEST2      COMMAND CODE BIT 4 SET           69700019
         BZ    ERR090                  BRANCH NO                        69800019
         L     WKREG2,8(CCWREG)        LOAD ADDR OF NEXT CCW     Y02922 69900002
         N     WKREG2,MASK2            CLEAR HIGH ORDER BYTE     Y02922 70000002
         B     ERR092                                                   70100019
ERR090   LRA   WKREG2,8(CCWREG)        LOAD FAILING CCW REAL ADDRY02922 70200002
ERR092   ST    WKREG2,EWCTIC           STORE NEXT CCW ADDR IN TICY02922 70300002
         MVI   EWCTIC,TICCMD           SET UP TIC COMMAND        Y02922 70400002
         B     ERR072                  BR TO CONTINUE PROCESSING        70500019
         EJECT                                                          70600019
*        DATA CHECK PROCESSING                                          70700019
         SPACE 1                                                        70800019
*        IF THE DATA CHECK OCCURRED ON A READ COMMAND, CONSTRUCT        70900019
*        A BACKSPACE CCW AND A RESIDUAL READ CCW IN THE UCB EXTENSION   71000019
*        AND RETRY THE OPERATION.                                       71100019
         SPACE 2                                                        71200019
ERR100   TM    0(CCWREG),CTRLCMD        CONTROL COMMAND                 71300019
         BO    ERR055                     BR - YES                      71400019
         SPACE 1                                                        71500019
*        IF THIS ERROR OCCURRED ON A RETRY OPERATION AND IS DIFFERENT   71600019
*        FROM THE ORIGINAL ERROR, CLEAR ALL OTHER COUNTS.               71700019
         SPACE 1                                                        71800019
         CLC   EWCCSW+6(2),IOSCSWRC    COMPARE RESIDUAL COUNT    Y02992 71900002
         BE    ERR110                  BR EQUAL                         72000019
         NI    EWAFLG3,X'FF'-IOBCDCK-IOBBUS  CLEAR BUSOUT        YM2509 72100002
*                                      AND CHANNEL DATA CHECK COUNTS    72200019
         MVI   EWACNTR3,ZERO           CLEAR POSITION CHECK+DATA Y02922 72300002
*                                      CHECK COUNTS                     72400019
         MVC   EWCCSW+6(2),IOSCSWRC    STORE NEW COUNT           Y02922 72500002
ERR110   TM    EWACNTR3,HEXTEN         COUNT EQUAL TO TEN        Y02922 72600002
         BO    ERR055                  BR YES                           72700019
         XR    WKREG1,WKREG1                                            72800019
         IC    WKREG1,EWACNTR3         INSERT ERROR COUNT        Y02922 72900002
         LA    WKREG1,1(WKREG1)        INCREMENT DATA CHECK COUNT       73000019
         STC   WKREG1,EWACNTR3         REPLACE OLD COUNT         Y02922 73100002
         B     ERR085                  BR TO SET UP BACKSPACE           73200019
*                                      AND RESIDUAL READ CCW'S          73300019
         SPACE 3                                                        73400019
*        UNIT EXCEPTION OR INCORRECT LENGTH                             73500019
         SPACE 1                                                        73600019
*        IF UNIT EXCEPTION OR INCORRECT LENGTH OCCURS ON THE FIRST      73700019
*        ENTRY TO THE ERP, IT SET AS A PERMANENT ERROR.  IF IT OCCURS   73800019
*        FOLLOWING THE RETRY OF ANOTHER ERROR, IT IS SET AS A           73900019
*        CORRECTED ERROR TO FORCE THE I/O SUPERVISOR TO SCHEDULE        74000019
*        NORMAL UNIT EXCEPTION AND INCORRECT LENGTH PROCESSING (SUCH    74100019
*        AS ENTERING APPENDAGES).   WHEN THE ERP IS RE-SCHEDULED, THE   74200019
*        ERROR IS THEN INDICATED AS A PERMANENT ERROR.                  74300019
         SPACE 2                                                        74400019
ERR120   TM    EWAFLG3,IOBENT          ENTRY BIT ON              YM2509 74500002
         BZ    ERR040                  BR NO                            74600019
         EJECT                                                          74700019
*        SUCCESSFUL RECOVERY - RESET ALL ERROR INDICATORS AND COUNTS    74800019
         SPACE 1                                                        74900019
ERR125   NI    IOBFLAG1(IOBREG),X'FF'-IOBEXER CLEAR IOB EXCEPTION AND   75000019
*                                      ERROR FLAGS                      75100019
         MVI   EWACNTR3,ZERO           CLEAR OTHER ERROR COUNTS  Y02922 75200002
         SPACE 1                                                        75400019
*        IF THE ERROR OCCURRED ON THE READ CCW WITHIN THE UCB EXTEN-    75500019
*        SION, REPLACE THE CURRENT IOB CSW ADDRESS WITH THE ORIGINAL    75600019
*        CSW ADDRESS WHICH WAS STORED IN THE UCB EXTENSION.             75700019
         SPACE 1                                                        75800019
        LA     WKREG1,EWCCCW2          SET POINTER TO READ CCW   Y02922 75900002
*                                      WITHIN EXTENSION          Y02922 76000002
         CLR   CCWREG,WKREG1           CURRENT CCW READ CCW             76100019
         BNE   ERR127                  BR NO                            76200019
         MVC   IOSCSW(3),EWCCSW+1      RESTORE ORIGINAL CSW      Y02922 76300002
*                                      ADDRESS                          76400019
ERR127   NC    IOSTATUS(2),CSWMASK     CLEAR ABNORMAL CSW BITS   Y02922 76500002
ERR128   NI    EWAFLG3,X'FF'-IOBENT    CLEAR ENTRY ,LOGOUT,AND   YM2509 76560002
         NI    IOSFLB,X'FA'                                      Y02922 76620002
*                                      MSG BITS AND ERROR COUNTS        76700019
         LA    WKREG3,STATUP           GET LOAD NAME TO STATISTICS      76800019
*                                      UPDATE                           76900019
         L     RETREG,VECTXL(CVTREG)   GET ADDRESS XCTL ROUTINE         77000019
         BR    RETREG                  XCTL TO STATISTICS UPDATE RTN    77100019
         EJECT                                                          77200019
*        CLEAR ERPIB ON CHANNEL CONTROL CHECK, INTERFACE CONTROL        77300019
*        CHECK, DATA CHAINING, MIXED CHAINING, OR UNRECOVERABLE         77400019
*        INTERCEPT CONDITION                                            77500019
         SPACE 2                                                        77600019
ERR130   TM    IOSTSB,CCCICC           CHANNEL CONTROL CHECK OR  Y02922 77700002
*                                      INTERFACE CONTROL CHECK          77800019
         BZ    ERR055                  BR NO                            77900019
         LA    WKREG2,EWAERPIB         LOAD ADDR OF ERPIB        Y02922 78000002
ERR135   XC    0(8,WKREG2),0(WKREG2)   CLEAR ERPIB                      79000019
ERR140   B     ERR060                  BR TO PERMANENT ERROR PROC       79100019
         SPACE 4                                                        79200019
*        INTERCEPT CONDITION --- IF INTERVENTION REQUIRED IS ON,        79300019
*        HANDLE IT NORMALLY.  OTHERWISE, UNRECOVERABLE INTERCEPT        79400019
         SPACE 2                                                        79500019
ERR150   TM    IOSTSA,CSWUCK           UNIT CHECK?               Y02922 79600002
         BZ    ERR130                      BRANCH IF NO                 79700019
        CLI    IOSSNS,INTREQ           INT. REG.?                Y02922 79800002
         BNE   ERR130                      BRANCH IF NO                 79900019
         MVI   IOSCOD,ERRORECB         RESET ECB CODE TO '7F'    Y02922 80000002
         B     ERR066                      BRANCH TO NORMAL INT REQ RTN 80200019
         EJECT                                                          80300019
*        CONSTANTS                                                      80400019
         SPACE 1                                                        80500019
CCWLNG   DC    H'8'                    CCW LENGTH                       80600019
STALNG   DC    H'10'                   STATISTICS TABLE ENTRY LENGTH    80700019
BACKCNT  DC    H'1'                    BACKSPACE COUNT                  80800019
CSWMASK  DC    X'FDC0'                 CSW ABNORMAL INDICATOR           80900019
*                                        RESET MASK                     81000019
         DS    0F                                                Y02922 81009002
MASK2    DC    X'00FFFFFF'             MASK OUT HIGH ORDER BYTE  Y02922 81018002
         IECDIOSB                                                Y02922 81027002
         IECDERWA                                                       81036002
         ORG   EWAIERP                                           Y02922 81045002
EWCSNS   DS    CL8                     EXTENDED SENSE BYTES      Y02922 81054002
EWCCCW1  DS    XL8                     BACKSPACE - REPOSITION CCWY02922 81063002
EWCCCW2  DS    XL8                     RESIDUAL READ CCW-TIC CCW Y02922 81072002
EWCTIC   DS    XL8                     TIC CCW                   Y02922 81081002
EWCCSW   DS    XL8                     IOSB CSW STORE            Y02922 81090002
         END                                                            81100019
