./  ADD  SSI=70730120,NAME=IEHPROG1
* /* START OF SPECIFICATIONS ***                                      * 00010002
*01* PROCESSOR = ASSEM;                                               * 00012002
**** END OF SPECIFICATIONS ***/                                       * 00014002
 TITLE 'IEHPROG1-IEHPROGM ROOT, PARAM LIST BUILDER, VOL LOOKUP'         00020002
*********************************************************************** 00040002
*                                                              YL026VC* 00050002
*  MODULE NAME -- IEHPROG1                                     YL026VC* 00052002
*                                                              YL026VC* 00054002
*  DESCRIPTIVE NAME -- IEHPROGM ROOT, PARAM LIST BUILDER, VOL  YL026VC* 00056002
*     LOOKUP                                                   YL026VC* 00056402
*                                                              YL026VC* 00058002
*  COPYRIGHT -- NONE                                           YL026VC* 00058402
*                                                              YL026VC* 00058802
*  STATUS -- 'IEHPROG1'  OS/VS2 PROLOGUE  MODIFICATION         YL026VC* 00060002
*     SEPTEMBER 1975                                          @Z40CSJH* 00100004
*                                                              YL026VC* 00110002
*  FUNCTION -- THIS MODULE IS THE FIRST LOAD OF 'MODIFY'.             * 00120002
*     IT SAVES THE SYSTEMS REGISTERS, AND ISSUES A GETMAIN            * 00140002
*     FOR 2048 BYTES WHICH WILL SERVE AS A WORK AREA FOR              * 00160002
*     THE PROGRAM.  ON INITIAL ENTRY IT WILL CALL ON IEHPROG4         * 00180002
*     A SEPARATE CSECT THAT WILL ANALYZE THE PARAMETER LIST           * 00200002
*     PASSED BY THE INVOCER AND RETURN WITH DCB'S OPENED              * 00220002
*     FOR SYSIN AND SYSPRINT.  IT WILL THEN READ SYSIN FOR            * 00240002
*     THE UTILITY CONTROL STATEMENTS, ANALYZE THE CONTENTS            * 00260002
*     OF THESE STATEMENTS, BUILD REQUIRED PARAMETER LIST              * 00280002
*     AND CALL ON IEHPROG5 TO MOUNT REQUIRED VOLUMES.  IF THE         * 00300002
*     INPUT CONTROL STATEMENT IS IN ERROR OR IF THE REQUIRED          * 00320002
*     VOLUMES CANNOT BE MOUNTED A DIAGNOSTIC MESSAGE WILL BE          * 00340002
*     WRITTEN ON 'SYSPRINT' AND THE PROGRAM WILL CONTINUE BY          * 00360002
*     READING THE NEXT CONTROL STATEMENT.  IF THE STATEMENT           * 00380002
*     IS VALID AND THE VOLUMES ARE (OR CAN BE) MOUNTED THEN           * 00400002
*     THIS MODULE WILL XCTL TO IEHPROG2, A MODULE WHICH WILL          * 00420002
*     ISSUE THE APPROPRIATE SVC'S AND ANALYZE THEIR RETURNS.          * 00440002
*                                                                     * 00450004
*     THE FOLLOWING OS CVOL (CONTROL VOLUME) FUNCTIONS        @Z40CSJH* 00452004
*     HAVE BEEN REACTIVATED FOR MVS EXTENDED CVOL SUPPORT     @Z40CSJH* 00454004
*         BLDG,BLDX,DLTX,BLDA,DLTA                            @Z40CSJH* 00456004
*         CONNECT AND RELEASE                                 @Z40CSJH* 00458004
*     ALSO REACTIVATED FOR ARE THE FOLLOWING                  @Z40CSJH* 00458404
*     KEYWORD PARAMETERS ASSOCIATED WITH THE ABOVE FUNCTIONS  @Z40CSJH* 00458804
*         INDEX,ALIAS,DELETE,ENTRIES,EMPTY                    @Z40CSJH* 00459204
*                                                                     * 00460002
*  ENTRY POINTS --                                                    * 00480002
*          IEHPROG6 IS ALWAYS THE INITIAL ENTRY POINT FOR THIS        * 00500002
*     MODULE.  ENTRY IS FROM THE SUPERVISOR AS A RESULT OF AN         * 00520002
*     EXECUTE CARD IN THE JOB STREAM OR AN XCTL OR LINK FROM          * 00540002
*     ANY OTHER PROGRAM.                                              * 00560002
*          IEHPROG9 IS THE SECOND ENTRY POINT AND IS ENTERED          * 00580002
*     ONLY BY A RETURN FROM THE SECOND LOAD OF MODIFY.                * 00600002
*                                                                     * 00620002
*  INPUT -- INPUT DATA TO THIS MODULE IS 80 CHARACTER BLOCKED         * 00640002
*     CARD IMAGES READ FROM 'SYSIN'.  THE FORMAT OF THESE             * 00660002
*     CONTROL STATEMENTS IS DESCRIBED IN THE FORM 'OPERATING          * 00680002
*     SYSTEM / 360 UTILITIES'.                                        * 00700002
*                                                                     * 00720002
*  OUTPUT -- OUTPUT TO 'SYSPRINT' CONSISTS OF MESSAGES WHICH          * 00740002
*     IDENTIFY PARTICULAR CONTROL STATEMENT ERRORS PLUS A LIST        * 00760002
*     OF CONTROL STATEMENTS.  OUTPUT TO THE SECOND LOAD OF            * 00780002
*     MODIFY CONSISTS OF THE ADDRESS OF THE COMMON WORK AREA          * 00800002
*     CONTAINED IN REGISTER 12.                                       * 00820002
*                                                                     * 00840002
*  EXTERNAL REFERENCES --                                             * 00860002
*          IEHPROG4 IS CALLED UPON TO INTERPRET THE PARAMETERS        * 00880002
*     PASSED BY AN INVOKER.                                           * 00900002
*          IEHPROG5 IS CALLED UPON TO MOUNT THE REQUIRED VOLUMES.     * 00920002
*          IEHPROG3 IS CALLED UPON TO WRITE ALL MESSAGES.             * 00940002
*          IEHPROG2 IS CALLED UPON TO PERFORM THE SECOND LOAD         * 00960002
*     OF MODIFY.                                                      * 00980002
*                                                                     * 01000002
*  EXITS,NORMAL -- THIS ROUTINE RESTORES THE SYSTEMS REGISTERS        * 01020002
*     AND EXITS THROUGH REGISTER 14.  REGISTER 15 WILL EQUAL 0        * 01040002
*     INDICATING THAT ALL REQUESTS WERE SERVICED AND NO ERROR         * 01060002
*     WAS ENCOUNTERED.                                                * 01080002
*                                                                     * 01100002
*  EXITS,ERROR -- THIS ROUTINE RESTORES THE SYSTEMS REGISTERS         * 01120002
*     AND EXITS THROUGH REGISTER 14.  REGISTER 15 CONTAINS THE        * 01140002
*     ERROR CODE AS FOLLOWS:                                          * 01160002
*     REGISTER 15 = 8         SOME REQUEST(S) NOT SERVICED            * 01180002
*     REGISTER 15 = 12        PERMANENT ERROR ON SYSIN                * 01200002
*     REGISTER 15 = 12        PERMANENT ERROR ON SYSPRINT             * 01220002
*     REGISTER 15 = 16        PROGRAM INTERRUPT                       * 01240002
*                                                                     * 01260002
*  TABLES/WORK AREAS --                                               * 01280002
*     VCONLIST - A LIST OF ADDRESS CONSTANTS USED TO PROVIDE          * 01300002
*     LINKAGE TO MODULES WHEN THE PROGRAM IS USED IN OVERLAY          * 01320002
*     MODE.                                                           * 01340002
*     PPARAMSW - A TWO BYTE BIT STRING FOR EACH OPTION WITH           * 01360002
*     BITS SET TO ONE TO INDICATE THE VALID PARAMETERS.               * 01380002
*     TABLEN1 THRU TABLEN9 - TABLES USED FOR CHECKING THE             * 01400002
*     VALIDITY OF OPERATIONS AND OPERANDS AND CONTAINING THE          * 01420002
*     ADDRESS OF CODE TO PROCESS THE SAME.                            * 01440002
*     NAMEX - DSECT OF THE WORK AREA OBTAINED BY GETMAIN AND          * 01460002
*     USED BY ALL MODULES OF THE PROGRAM.                             * 01480002
*                                                                     * 01500002
*  ATTRIBUTES -- READ ONLY, REENTRANT, REUSABLE, PROBLEM PROGRAM,     * 01520002
*     ENABLED.                                                        * 01540002
*                                                                     * 01560002
*  CHARACTER CODE DEPENDENCY -- THIS MODULE MUST BE ASSEMBLED         * 01580002
*     IN EBCDIC AND RUN IN EBCDIC TO INSURE COLLATING SEQUENCE        * 01600002
*     AND INTERNAL REPRESENTATION OF CERTAIN CHARACTERS.              * 01620002
*                                                                     * 01640002
*  NOTES -- STORAGE OF APPROXIMATELY 6000 BYTES FOR CODE AND          * 01660002
*    ANOTHER 5390 BYTE WORK AREA.                                     * 01680002
*                                                                     * 01700002
*  CHANGE ACTIVITY -- FOLLOWS PROLOGUE                         YL026VC* 01710002
*                                                              YL026VC* 01712002
*********************************************************************** 01720002
*                                                                       01740002
*                                                                       01760002
********************************************************************    01780002
*                                                                  *    01800002
*                                                                  *    01820002
*              -----IEHPROG1 THE STEM OF MODIFY-----              M2838 01840002
*                                                                  *    01860002
IEHPROG1 CSECT                                                    M2838 01880002
*A500-588,1100,17100-17200                                      YL026VC 01882002
*C600-1000                                                      YL026VC 01884002
*C313600,315600-316000,317400-322200,323000,324400-324800       YL026VC 01890002
*C327000-329200                                                 YL026VC 01894002
*A295240                                                         YM5077 01900002
*A278900                                                        YA01672 01910002
*C400,13200                                                       M2838 01920002
*277200,277400                                                     I276 01940002
*2480068000,265600                                                 8429 01960002
*0233171600,276600                                                 DT0I 01980002
*2359047000                                                     PTM1623 02000002
* 082800,083200,262400,262600                                    A23466 02020002
*                                                                A24144 02040002
*                                                                A24020 02060002
*                                                                A25564 02080002
*                                                                A28552 02100002
*                                                                A31430 02120002
*A 073100-073120,073701-073703,073728-073732,073773-073775      YA01678 02122002
*C 073618,073699,073753                                         YA01678 02124002
*D 073627                                                       YA01678 02126002
*C 145060                                                       YA01707 02130002
*A 202700,202720,205601-205740                                 @ZA01655 02130102
*C 145000,203600,224200                                        @ZA01655 02130202
*C 437800                                                      @30AAAG  02132003
*C 145000                                                      @ZM33351 02132203
*A 437920,940                                                  @30AAAG  02134003
*C 1000,4520-4592,313600,315600-316000                         @Z40CSJH 02136004
*C 317400-320400,321200-322200                                 @Z40CSJH 02138004
*C 323100,324400-324800,325600                                 @Z40CSJH 02138404
*C 327000-327400,328200-329200                                 @Z40CSJH 02138804
*A 422300                                                      @ZA11944 02139299
*C 415400                                                      @ZA13755 02139699
         USING *,15                                                *    02140002
         SAVE  (14,12)    THIS SAVE INCLUDES R9                         02160002
         L     9,VCONLIST                                          *    02180002
         L     15,VCON1                                            *    02200002
         BR    15                                                  *    02220002
VCON1    DC    V(IEHPROG6)        THIS LIST OF ADCONS             M2838 02240002
VCON2    DC    V(IEHPROG9)        IS USED THROUGHOUT THE          M2838 02260002
VCON3    DC    V(IEHPROG3)        PROGRAM TO PROVIDE THE          M2838 02280002
VCON4    DC    V(IEHPROG5)        LINKAGE REQUIREMENTS OF         M2838 02300002
VCON5    DC    V(IEHPROG4)        MODIFY IN AN OVERLAY            M2838 02320002
VCON6    DC    V(IEHPROG8)        STRUCTURE.                      M2838 02340002
VCON7    DC    V(IEHPROG7)        THROUGHOUT EXECUTION OF         M2838 02360002
VCON8    DC    V(IEHPROG2)        THE PROGRAM THE ADDRESS         M2838 02380002
VCON9    DC    V(IEHPROGA)        OF THIS LIST IS MAINTAINED      M2838 02400002
VCONLIST DC    A(VCON1)                 IN THE WORKAREA AT A       *    02420002
*                                       LOCATION KNOWN AS DECB2    *    02440002
*                                       FOR USE BY THE ENTIRE      *    02460002
*                                       PROGRAM AS REQUIRED.       *    02480002
*                                                                  *    02500002
********************************************************************    02520002
*                                                                       02540002
*                                                                       02560002
IEHPROG6 CSECT                                                    M2838 02580002
*                   *****     REGISTER  USAGE     *****                 02600002
ZERO     EQU   0        ----------------------------------------        02620002
R1       EQU   12                                                       02640002
ARGREG   EQU   1                       ARGUMENT ADDRESS FROM TRT A28552 02660002
R2       EQU   2                                                        02680002
R3       EQU   3             REGISTERS ZERO THROUGH                     02700002
R4       EQU   4             TEN ARE WORK REGISTERS                     02720002
R5       EQU   5                                                        02740002
R6       EQU   6             REGESTERS ELEVEN AND                       02760002
R7       EQU   7             TWELVE ARE BASE REGISTERS                  02780002
R8       EQU   8             FOR THE PROGRAN AND THE                    02800002
R9       EQU   9             DUMMY SECTION RESPECTIVELY                 02820002
NAMEPTR  EQU   9                       POINTS TO NAME TO CHECK   A28552 02840002
*                                      INDEX LENGTH , ALPHA 1ST  A28552 02860002
*                                      AND ALPHAMERIC CHARACTERS A28552 02880002
RB2      EQU   10                 SECONDARY BASE REGISTER        S21046 02900002
OFFSET1K EQU   4095               OFFSET FOR BASE REG 2          S21046 02920002
KPLUS2   EQU   4097               2ND BASE OFFSET FROM IEHESCAN  S21046 02940002
QUOTECHR EQU   X'7D'              QUOTE CHARACTER                S21046 02960002
TWO      EQU   2                  CONSTANT 2                     S21046 02980002
OFFSET2  EQU   4097               OFFSET 2 FOR BASE REG 2        S21046 03000002
DSECTSZE EQU   2695               HALF DSECT SIZE FOR GETMAIN     M2838 03020002
MULTPBY2 EQU   1                  SHIFT TO MULT BY 2             S21046 03040002
ONEBYTE  EQU   1                  ONE BYTE                       S21046 03060002
CNTTOTAL EQU   6                  TOTAL COUNT FOR ALL WTOR'S     S21046 03080002
CNT1PAS  EQU   3                  TOTAL WTOR'S ALLOWED FOR PSWD  S21046 03100002
SIXTEEN  EQU   16                 RETURN CODE OF 16 COMPARE      S21046 03120002
INCRMNT1 EQU   1                  INCREMENT OF 1                 S21046 03140002
MOVE55   EQU   55                 BLANK OUT MESSAGE AFTER PARM   S21046 03160002
*                                 ERROR MESSAGE PRINTED          S21046 03180002
PRORTNCD EQU   X'FF'              MASK TO SHOW PROTECT RETURN    S21046 03200002
NUMFLD   EQU   X'F0'              F FIELD OF EBCDIC NUMERALS     S21046 03220002
TWELVE   EQU   X'12'              RETURN CODE OF 12              S21046 03240002
ZERORTN  EQU   0                  ZERO RETURN CODE               S21046 03260002
PRNTBIT  EQU   X'80'              MASK TO TEST PRINT OR NOPRINT  S21046 03280002
CVOLBIT  EQU   X'08'              TURN ON THE CVOL BIT           S21046 03300002
CVOLOFF  EQU   X'F7'              TURN OFF THE CVOL BIT          S21046 03320002
SKIP3    EQU   49                 FORCE THREE SPACES             S21046 03340002
BLANKBYT EQU   X'40'              BLANK CHAR IN HEX              S21046 03360002
SEVEN    EQU   7                  CONSTANT OF 7                  S21046 03380002
ONEWORD  EQU   4                  FOUR BYTE CONSTANT             S21046 03400002
ZEROBYTE EQU   0                  CONSTANT OF 0                  S21046 03420002
MNTVOL   EQU   X'40'              IEHESW2 MASK TO CAUSE VOL MNT  S21046 03440002
VOLMNT   EQU   X'01'              IEHEMAC1 VOL MOUNT             S21046 03460002
EIGHT    EQU   8                  CONSTANT OF 8                  S21046 03480002
PSWD1MSK EQU   X'20'              PPARMSW MASK FOR PASWORD1      S21046 03500002
PSWD1DUP EQU   X'20'              DUP MASK TEST FOR PASWORD1     S21046 03520002
PSWD1PRM EQU   8                  DISPLACEMENT FOR PASWORD1      S21046 03540002
PSWD2MSK EQU   X'40'              PPARMSW MASK FOR PASWORD2      S21046 03560002
PSWD2DUP EQU   X'04'              DUP MASK TEST FOR PASWORD2     S21046 03580002
PSWD2PRM EQU   21                 DISPLACEMENT FOR PASWORD2      S21046 03600002
CPSWDMSK EQU   X'04'              PPARMSW MASK FOR CPASWORD      S21046 03620002
CPSWDDUP EQU   X'10'              DUP MASK TEST FOR CPASWORD     S21046 03640002
CODE4    EQU   4                  RETURN CODE OF 4               S21046 03660002
MSG67    EQU   67                 PRINT PARM ERROR MESSAGE       S21046 03680002
MSGPRINT EQU   X'02'              CHECK FOR PARMFIELD ERROR      S21046 03700002
CPSWDPRM EQU   12                 DISPLACEMENT FOR CPASWORD      S21046 03720002
TYPEMSK  EQU   X'10'              PPARAMSW MASK FOR TYPE         S21046 03740002
TYPEDUP  EQU   X'08'              DUP MASK TEST FOR TYPE         S21046 03760002
TYPEPRM  EQU   20                 DISPLACEMENT FOR TYPE          S21046 03780002
UCBADDR  EQU   X'02'              ARG LENGTH OF UCB ADDRESS      A35899 03800002
TYPECODE EQU   X'03'              HIGHEST TYPE CODE PERMISSIBLE  S21046 03820002
DATAMSK  EQU   X'08'              PPARMSW MASK FOR DATA          S21046 03840002
DATADUP  EQU   X'02'              DUP MASK TEST FOR DATA         S21046 03860002
DATAPRM  EQU   24                 DISPLACEMENT FOR DATA          S21046 03880002
THREEBYT EQU   3                  3 BYTE DISPLACEMENT            S21046 03900002
ZERODSP  EQU   0                  DISPLACEMENT OF 0              S21046 03920002
DROPZONE EQU   X'0F'              MASK TO DROP ZONE              S21046 03940002
HALFWD   EQU   2                  ONE HALF WORD                  S21046 03960002
QUOTEMSK EQU   X'01'              CODE FOR QUOTE FROM SCAN       S21046 03980002
ONEQUOTE EQU   X'20'              ONE QUOTE HAS BEEN FOUND       S21046 04000002
LNGTHCHK EQU   X'07'              LENGTH COMPARE                 S21046 04020002
MULTBY4  EQU   2                  SHIFT TO MULT BY 4             S21046 04040002
VOLPRM   EQU   16                 DISPLACEMENT FOR VOL           S21046 04060002
SIX      EQU   6                  CONSTANT OF 6                  S21046 04080002
NINETEEN EQU   19                 ZERO OUT PARAMETER LIST        S21046 04100002
DATALGTH EQU   76                 MAX LENGTH OF DATA FIELD       S21046 04120002
RB       EQU   11            THIRTEEN POINTS TO A REGISTER              04140002
RBD      EQU   12                                                       04160002
SAVEREG  EQU   13            SAVE AREA                                  04180002
RETURN   EQU   14                                                       04200002
LINKREG  EQU   15            FIFTEEN AND FOURTEEN ARE LINK              04220002
PARAMREG EQU   0             AND RETURN REGISTERS RESPECTIVELY          04240002
LISTREG  EQU   1        -----------------------------------------       04260002
*                                                                       04280002
*                   *****     SWITCH USAGE        *****                 04300002
NDSWMSK  EQU   128       END SWITCH  BIT POS ZERO  SWITCH 1             04320002
COMMENTS EQU   64                                                       04340002
CONTINUE EQU   32                                                       04360002
FIRSTONE EQU   16                                                       04380002
BIGSHIFT EQU   8                                                        04400002
SHIFTLOC EQU   4                                                        04420002
VOLSW    EQU   2                                                        04440002
CLEAROUT EQU   253                     AFFECTS THE 7TH BIT OF    A23466 04460002
*                                      MOUNTSW                   A23466 04480002
ERRSW    EQU   2                       USED TO TEST FOR ERROR    A23466 04500002
*                                      IN CONTINUATION           A23466 04520002
ERRSW2   EQU   4                       USED TO TEST FOR ERROR    A24020 04540002
*                                      ENCOUNTERED IN NAME FIELD A24020 04560002
CLEARSW  EQU   251                     AFFECTS THE 6TH BIT OF    A24020 04580002
*                                      MOUNTSW                   A24020 04600002
COMMENCE SAVE  (14,8),T,MODIFY   THIS SAVE DOES NOT INCLUDE R9          04620002
         STM   10,12,60(13)   SAVE R 10 THRU R 12                       04640002
         BALR  RB,0                                                     04660002
         USING *,RB                                              S21046 04680002
         USING *+OFFSET1K,RB2                                    S21046 04700002
         LA    RB2,OFFSET1K(RB)   SET UP BASE REG DISPLACEMENT   S21046 04720002
         B     IEHEREAD                                                 04740002
IEHESCAN BALR  RB,0                                                     04760002
         USING *,RB                                              S21046 04780002
         USING *+OFFSET1K,RB2                                    S21046 04800002
         LA    RB2,OFFSET1K(RB)   SET UP BASE REG DISPLACEMENT   S21046 04820002
         USING IEHECHAR,R1                                              04840002
*                                                                       04860002
         TM    IEHESW1,NDSWMSK     TEST FOR END OF PARAMETERS           04880002
         BZ    NOTEND                                                   04900002
         OI    IEHESW1,COMMENTS        TURN ON THE COMMENTS SWITCH      04920002
         TM    IEHESW1,CONTINUE        CONTINUE CARDS PRESENT           04940002
         BZ    GETMORE                 YES     BRANCH                   04960002
ENDCALL  L     R2,IEHECALL         GET ADDRESS OF CALLING SEQUENCE      04980002
         CLI   VOLPAREN+1,X'00'         IF PAREN COUNT IS ZERO          05000002
         BCR   8,2                      GO HONOR THE REQUEST            05020002
         MVI   VOLPAREN+1,X'00'         OTHERWISE GO TO                 05040002
         B     BADSYN                   THE ERROR ROUTINE               05060002
NOTEND   LM    R2,R3,IEHESTT       AREA TO BE SCANNED DEFINED BY        05080002
         SR    R5,R5               THE ADDRESSES IN REGISTERS TWO,THREE 05100002
         ST    RETURN,SCANRET          SAVE RETURN ADDRESS              05120002
         LR    R4,R5                   CLEAR  REG 4                     05140002
         CR    R2,R3                                                    05160002
         BH    DOWNLNTH-2                                               05180002
         IC    R4,IEHECOND        LOAD MASK FOR THE BRANCH CONDITION    05200002
         LA    R6,MIDDLE                                                05220002
         CR    R2,R6         TEST IF WE ARE SCANNING THE READ IN ARED   05240002
         BNH   COMPAGN            BRANCH IF WE ARE NOT                  05260002
         TM    IEHESW1,CONTINUE+SHIFTLOC    CAN WE SHIFT                05280002
         BNE   COMPAGN                      NO    BRANCH                05300002
         TM    IEHESW1,BIGSHIFT   TEST FOR A LONG SHIFT                 05320002
         BZ    LONGONE                                                  05340002
         MVC   INPUT+15(57),MIDDLE       TAKE A SHORT SHIFT             05360002
         LA    R6,56                                                    05380002
         SR    R2,R6              RESET THE START ADDRESS               05400002
         ST    R2,IEHESTT                                               05420002
         B     GETMORE                                                  05440002
LONGONE  OI    IEHESW1,BIGSHIFT     TURN OFF THE BIG SHIFT SWITCH       05460002
         MVC   INPUT(72),READTOO                                        05480002
         LA    R6,72                                                    05500002
         SR    R2,R6                                                    05520002
         ST    R2,IEHESTT                                               05540002
         B     GETMORE                                                  05560002
COMPAGN  EQU   *                                                 A25564 05580002
         L     RETURN,SCANRET          RESTORE THE RETURN ADDRESSA25564 05600002
TRYAGAIN EQU   *                                                 A25564 05620002
         LTR   R2,R2                   IF REG 2 IS ZERO          A42333 05640002
         BZ    BADSYN                  INVALID SYNTAX            A42333 05660002
         CLC   0(1,R2),IEHECHAR        CHARACTER BEING SCANNED   A25564 05680002
*                                      FOR IS COMPARED TO A      A25564 05700002
*                                      CHARACTER IN THE AREA     A25564 05720002
*                                      BEING SCANNED             A25564 05740002
         NOP   CKBLANK                SCAN IS TERMINATED IF THE         05760002
         EX    R4,*-4              CONDITION SPECIFIED IS MET           05780002
ENTAGN   LA    R5,1(R5)                                                 05800002
         LA    R2,1(R2)            UPDATE POINTER TO SCAN AREA          05820002
         CR    R2,R3               COMPARE START TO STOP ADDRESS        05840002
         BNH   TRYAGAIN                NO FIND--THEN LOOK AGAIN  A25564 05860002
*                                                                       05880002
*                                  ARRIVING HERE MEANS NO FIND          05900002
*                                  IN THE AREA THAT WAS SCANNED         05920002
*                                     THE POINTER TO THE FOUND          05940002
*                                  CHARACTER IS SET TO ZERO             05960002
         SR    R2,R2                                                    05980002
*                                  ***LENGTH OF SCAN AND FOUND          06000002
DOWNLNTH BCTR  R5,0                ***ADDRESS STORED IN SCANLIST        06020002
         STC   R5,IEHEARGL         STORE LENGTH                         06040002
         ST    R2,IEHEFND          STORE ADDRESS                        06060002
*                                                                       06080002
*                                  CHECK TO SEE IF THERE WAS A FIND     06100002
*                                  BY TESTING THE 'FOUND'ADDRESS        06120002
         LTR   R2,R2               FOR A NOT ZERO                       06140002
         BNE   GETCODE                                                  06160002
         STC   R2,IEHECODE         NOFIND- ZERO THE CODE IN SCANLIST    06180002
         ST    R2,IEHEFUN          ZERO THE FUNCTION ADDRESS            06200002
         BR    RETURN              SCRAMETH BACK.                       06220002
*                                                                       06240002
*                                 AT THIS POINT SCAN HAS STOPED FOR     06260002
*                                 A FIND CONDITION.  AND WE WILL PLACE  06280002
*                                 A CODE INTO SCANLIST  DESCRIBING THE  06300002
*                                 CHARACTER FOUND AS FOLLOWS            06320002
*                                                                       06340002
*                                 TYPE OF CHARACTER         CODE        06360002
*                                       .                     1         06380002
*                                       ,                     2         06400002
*                                       =                     3         06420002
*                                       (                     4         06440002
*                                       )                     5         06460002
*                                       BLANK                 6         06480002
*                                       ALL OTHERS            0         06500002
*                                                                       06520002
*                                                                       06540002
*                                                                       06560002
GETCODE  LA    R3,CODELIST+5       CHARACTER THAT STOPED THE SCAN       06580002
         LA    R4,6                IS COMPARED TO A CHARACTER           06600002
NEXTCODE CLC   0(1,R2),0(R3)       IN THE CODELIST.                     06620002
         BE    PUTCODE                                                  06640002
         BCTR  R3,0                GET NEXT CHARACTER                   06660002
         BCT   R4,NEXTCODE         CHECK FOR LAST AND MODIFY CODE       06680002
         CLC   NOTBLANK(2),IEHECHAR                                     06700002
         BE    PUTCODE                                                  06720002
         LM    2,5,MARESAR        RESTORE THE REGISTERS                 06740002
         B     ENTAGN             AND SCAN SOME MORE                    06760002
CHKBLNK  BCTR  R2,0                    BACK UP                  PTM1623 06780002
         CLI   0(R2),X'4B'             CHECK FOR PERIOD         PTM1623 06800002
         LA    R2,1(R2)                                         PTM1623 06820002
         BE    BADSYN                  BRANCH ON YES            PTM1623 06840002
         B     CONSCAN                                          PTM1623 06860002
PUTCODE  STC   R4,IEHECODE         PUT CODE INTO SCANLIST               06880002
*                                                                       06900002
*                                                                       06920002
*                                  AT THIS POINT  SCAN IS COMPLETE      06940002
*                                  AND THE FOUND ADDRESS,LENGTH OF      06960002
*                                  THE SCAN, AND CODE HAVE BEEN         06980002
*                                  PLACED INTO THE SCANLIST             07000002
*                                  NOW WE WILL TEST THE TLU SW.         07020002
         CLI   IEHECODE,X'06'          WAS DELIMITER A BLANK    PTM1623 07040002
         BE    CHKBLNK                 BRANCH ON YES            PTM1623 07060002
         CLI   IEHECODE,X'02'          CHECK FOR COMMA          PTM1623 07080002
         BE    CHKBLNK                 BRANCH ON YES            PTM1623 07100002
CONSCAN  L     R2,IEHETBL                                       PTM1623 07120002
         LTR   R2,R2                                                    07140002
         BCR   8,RETURN            RETURN IF NO TLU IS REQUESTED        07160002
*                                                                       07180002
*                                  A TLU IS REQUIRED.  WE WILL          07200002
*                                  NOW SELECT THE ADDRESS OF THE        07220002
*                                  PROPER TABLE TO BE SEARCHED          07240002
*                                  BY USING THE LENGTH IN SCANLIST      07260002
*                                                                       07280002
SPTABAD  CLI   IEHEARGL,X'08'     TESTING FOR MAX AND MIN VALUES        07300002
         BH    NOTABLE            OF ARGUMENT LENGTH TO INSURE          07320002
         CLI   IEHEARGL,X'01'     COMPATIBILITY WITH OUR TABLES         07340002
         BNH   NOTABLE            BRANCH IF NOT COMPATIBLE              07360002
         SR    R2,R2                                                    07380002
         IC    R2,IEHEARGL         PUT LENGTH INTO REG.                 07400002
         SLA   R2,2                MULTIPLY BY FOUR                     07420002
         LA    R2,TABLEADS(R2)     ADD TO TABLE ADDRESS                 07440002
         MVC   IEHETBL(4),0(R2)    PUT TABLE ADDRESS INTO SCANLIST      07460002
         B     IEHETLU             GO TO TABLE LOOK UP ROUTINE          07480002
NOTABLE  SR    R2,R2               ARGUMENT LENGTH IS ZERO              07500002
         ST    R2,IEHEFUN          ZERO THE FUNCTION                    07520002
         BR    RETURN              RETURN                               07540002
CKBLANK  CLI   0(R2),C' '          SEE IF A BLANK STORE THE SCAN        07560002
         STM   2,5,MARESAR                                              07580002
         BNE   DOWNLNTH            IF NOT; FORGET IT                    07600002
         LTR   R5,R5                   *  CHECK LENGTH OF               07620002
         BZ    ZEROLNTH                *  SCAN FOR ZERO                 07640002
         OI    IEHESW1,NDSWMSK     NOT ZERO TURN ON END SWITCH          07660002
         B     DOWNLNTH                                                 07680002
*                                                                       07700002
*                                  SCAN HAS STOPED FOR A BLANK          07720002
*                                  LENGTH OF SCAN WAS ZERO              07740002
*                                  CHECK FOR ') ' OR ', '               07760002
*                                                                       07780002
ZEROLNTH LR    R6,R2               GET ADDRESS OF PRECEEDING CHARACTER  07800002
         BCTR  R6,0                BY DECREASING FOUND ADDRESS BY ONE   07820002
         CLI   0(R6),C','          CHECK FOR COMMA                      07840002
         BE    SKIPCARD                                                 07860002
         CLI   0(R6),C')'          CHECK FOR RIGHT PARENTHESIS          07880002
         BE    ENDCALL             IF EQUAL GO GET THE MACRO REQUIRED   07900002
         CLI   0(R6),QUOTECHR     CHECK FOR QUOTE                S21046 07920002
         BE    ENDCALL            IF EQUAL GET THE MACRO REQUIRE S21046 07940002
         LA    PARAMREG,1                                               07960002
         L     LINKREG,SEVER8          GO TO CONDITION           A25564 07980002
         BALR  RETURN,LINKREG          CODE HANDLER              A25564 08000002
         B     GOAGAIN                                                  08020002
*                                                                       08040002
SKIPCARD LA    R6,MIDDLE               --------------------------       08060002
         ST    R6,IEHESTT              SKIP OVER COMMENTS IN THIS       08080002
         CR    R6,R2                   CARD... IF THIS IS LAST          08100002
         BH    NOTEND                  CARD GGO CALL THE MACRO          08120002
         B     BADSYN   HAVE FOUND ', ' WITH NO CONTIN PUNCH      10859 08140002
*                                                                       08160002
*                                                                       08180002
*                                                                       08200002
*                                                                       08220002
*                        ***** USE OF REGISTERS FOR TLU *****           08240002
*                                                                       08260002
*                        REGISTER NO.              CONTENTS.            08280002
*                            2                 ADDRESS OF SEARCH ARG    08300002
*                            3                 LENGTH -1 OF THE ARG     08320002
*                            4                 ADDRESS OF THE TABLE ARG 08340002
*                            5                 NUMBER OF ELEMENTS       08360002
*                            6                 LENGTH OF ELEMENTS       08380002
*                            7--10             VARIOUS WORK             08400002
*                                                                       08420002
*                                                                       08440002
*                                                                       08460002
IEHETLU  L     R2,IEHESTT                                               08480002
         L     R4,IEHETBL                                               08500002
         SR    R3,R3                                                    08520002
         LR    R5,R3                  SET UP REGISTERS                  08540002
         LR    R6,R3                     AS SPECIFIED                   08560002
         IC    R3,IEHEARGL                 ABOVE                        08580002
         IC    R5,0(R4)                                                 08600002
         IC    R6,1(R4)                                                 08620002
         LA    R4,2(R4)                                                 08640002
*                                                                       08660002
*                                  COMPARISON OF ARGUMENTS MADE BY      08680002
*                                  EXECUTE 'CLC' TO USE THE             08700002
*                                  LENGTH IS REG 3                      08720002
*                                                                       08740002
*                                                                       08760002
EXCLC    EX    R3,TLUCLC           COMPARE  ARGUMENTS                   08780002
         BE    ARGFOUND            BRANCH ON FIND                       08800002
         BCT   R5,ARG              DECREASE ARG COUNT --EXIT IF ZERO    08820002
         ST    R5,IEHEFUN          STORE ZEROS FOR NO FIND              08840002
         BR    RETURN                                                   08860002
ARG      AR    R4,R6               GET NEXT TABLE ARGUMENT.             08880002
         B     EXCLC               REPEAT                               08900002
ARGFOUND LA    R4,1(R4,R3)         FUNCTION ADDRESS =ARG LENTH + 1      08920002
         ST    R4,IEHEFUN          +TABLE POINTER,  STORE IT            08940002
         BR    RETURN                                                   08960002
TLUCLC   CLC   0(1,R2),0(R4)                                            08980002
GOAGAIN  ST    PARAMREG,IEHESPC        SAVE MESSAGE NUMBER              09000002
         OI    IEHESW1,NDSWMSK         SET END SW. ON                   09020002
         LA    R2,GORETURN                                              09040002
         ST    R2,IEHECALL        GIVE SCAN A WAY BACK                  09060002
         BALR  RETURN,RB          READ ANY COMMENTS CARDS               09080002
GORETURN L     PARAMREG,IEHESPC                                         09100002
         L     LINKREG,MSGRTNAD        GO WRITE THE SAVED MESSAGE       09120002
         BALR  RETURN,LINKREG                                           09140002
         B     STTRESET                                                 09160002
IEHPROG8 BR    RETURN             RETURN TO CALLING POINT         M2838 09180002
         ENTRY IEHPROG8                                           M2838 09200002
IEHEREAD BALR  RB,0                --------------------                 09220002
         USING *,RB                                              S21046 09240002
         USING *+OFFSET1K,RB2                                    S21046 09260002
         LA    RB2,OFFSET1K(RB)   SET UP BASE REG DISPLACEMENT   S21046 09280002
         L     RB,SCANBASE                                              09300002
         LA    RB2,OFFSET1K(RB)   SET UP BASE REG DISPLACEMENT   S21046 09320002
         USING IEHESCAN+TWO,RB                                   S21046 09340002
         USING IEHESCAN+OFFSET2,RB2                              S21046 09360002
         LA    ZERO,DSECTSZE      SET UP REG 0 TO GET            S21046 09380002
         SLL   ZERO,MULTPBY2      5390 BYTES OF MAIN STORAGE      M2838 09400002
         GETMAIN R,LV=(0)                                          8429 09420002
         LR    RBD,LISTREG                                              09440002
         USING IEHECHAR,RBD                                             09460002
         ST    R9,DECB2                 SAVE ADDRESS OF THE VCONS       09480002
         LOAD  EP=DEVNAMET              LOAD DEVICE NAME TABLE     I276 09500002
         ST    ZERO,TABLEAD       SAVE ADDRESS OF TABLE            I276 09520002
         L     0,20(R9)                 GET ADDRESS OF IEHRET01         09540002
         ST    0,DECB2+4                SAVE IT                         09560002
         L     LISTREG,24(13)      RESTORE REG 1                        09580002
         ST    13,IEHESAT          SAVE  13                             09600002
         XC    MOUNTSW(1),MOUNTSW      CLEAR MOUNTSW             A23466 09620002
         XC    IEHESW2(ONEBYTE),IEHESW2     ZERO IEHESW2         S21046 09640002
         LA    R3,CNTTOTAL        LOAD DECREMENT FOR TOTAL WTOR  S21046 09660002
         STC   R3,TOTALPS         STORE DECREMENT FOR TOTAL WTOR S21046 09680002
         ST    SAVEREG,MARESAR+4  SAVE OLD SAVE AREA LOCATION     M2838 09700002
         LA    13,MARESAR          POINT AT NEW SAVE AREA               09720002
         L     LINKREG,INVOCRTN    GO TO THE                            09740002
         BALR  RETURN,LINKREG      INVOKE ROUTINE                       09760002
*                                                                       09780002
*                        ----- AT THIS POINT -----                      09800002
*        CONTROL HAS JUST PASSED TO 'IEHINVOC' A ROUTIN USED TO         09820002
*        SCAN THE PARAMETER LIST THAT THE PROGRAM RECEIVES UPON         09840002
*        INVOCATION. UPON RETURN THERE WILL BE A DCB OPENED FOR         09860002
*        INPUT AT 'UTINDCB' AND A DCB OPEN FOR OUTPUT AT 'UTOUTDCB'     09880002
*        SWITCHES WILL BE SET AT 'IEHESAT' TO INDICATE WHETHER OR       09900002
*        NOT A LIST OF DDNAMES WAS PASSED AND WHETHER OR NOT IT         09920002
*        INCLUDED REPLACEMENT NAMES FOR SYSIN AND SYSPRINT.             09940002
*        THIS INFORMATION WILL BE USED LATER BY THE VOLUME MOUNTING     09960002
*        ROUTINE TO INSURE THAT REQUIRED VOLUMES ARE NOT DISMOUNTED     09980002
*                                                                       10000002
*                                                                       10020002
         TM    UTOUTDCB+48,X'10'       TEST IF SYSPRINT IS OPEN    8687 10040002
         BO    TESTFLG                  YES IT IS OPEN             BS0H 10060002
         OI    DFLG,X'01'                                       YA01678 10066002
         B     ERCLOS2                                          YA01678 10072002
CODERTN  LA    LINKREG,16               RETURN CODE OF 16          BS0H 10080002
         STC   LINKREG,ERRFLD+2        SAVE RETURN CODE            8687 10100002
         B     FREEMAIN                QUIT                        8687 10120002
TESTFLG  TM    DFLG,X'10'               CHECK FOR BLKSIZE ERROR    BS0H 10140002
         BO    ERCLOS2                 YES BRANCH               YA01678 10160002
TESTIN   TM    UTINDCB+48,X'10'         TEST IF SYSIN IS OPEN      BS0H 10200002
         BO    TESTFLAG                 YES IT IS OPEN             BS0H 10220002
         LA    PARAMREG,56                                         BS0H 10240002
ERMESG   MVI   MSGOUT,C' '              CLEAR MESSAGE AREA         BS0H 10260002
         MVC   MSGOUT+1(119),MSGOUT                                BS0H 10280002
         L     LINKREG,MSGRTNAD                                    BS0H 10300002
ERCLOS1  TM    DFLG,X'01'                                       YA01678 10320002
         BO    CODERTN                                          YA01678 10326002
         LA    R5,CLOSE                                         YA01678 10332002
         LA    R2,UTOUTDCB                                         BS0H 10360002
         BALR  R4,R5                    GO TO CLOSE ROUTINE        BS0H 10380002
         B     CODERTN                  SET ERROR CODE             BS0H 10400002
ERCLOS2  TM    UTINDCB+48,X'10'        TEST  IF SYSIN OPEN      YA01678 10405002
         BO    ERCLOS3                 YES                      YA01678 10410002
         B     ERCLOS1                 NO                       YA01678 10415002
TESTFLAG TM    DFLAG,X'10'                                         BS0H 10420002
         BC    8,MESSAGE                PUT OUT HEADER             BS0H 10440002
ERCLOS3  LA    R5,CLOSE                                         YA01678 10440102
         LA    R2,UTINDCB                                          BS0H 10480002
         BALR  R4,R5                    CLOSE SYSIN DCB            BS0H 10500002
         TM    DFLG,X'11'              TEST IF BLKSIZE ERROR    YA01678 10506002
         BNZ   ERCLOS1                 YES GO TO SYSPRINT CLOSE YA01678 10512002
         LA    PARAMREG,55              WRITE ERROR MESSAGE --     BS0H 10520002
         B     ERMESG                   INVALID BLOCKSIZE          BS0H 10540002
MESSAGE  MVI   MSGOUT,C' '             CLEAR MESSAGE OUTPUT AREA   8687 10560002
         MVC   MSGOUT+1(119),MSGOUT                                     10580002
         LA    PARAMREG,48                                              10600002
         L     LINKREG,MSGRTNAD        SKIP TO ONE                      10620002
         BALR  RETURN,LINKREG          AND WRITE A HEADER               10640002
         XC    ERRFLD(8),ERRFLD    RESET ERROR RETURN CODES             10660002
         TM    IEHESW2,MSGPRINT   IS PARM ERROR MSG TO BE PRINT  S21046 10680002
         BC    1,PARMERR          IF YES GO PRINT IT             S21046 10700002
         B     STARTAGN                                                 10720002
*                                                                S21046 10740002
*   AN ERROR WAS ENCOUNTERED IN THE PARM FIELD OF THE            S21046 10760002
*   EXEC CARD , PRINT MESSAGE 67 AND SET A RETURN CODE OF 4      S21046 10780002
*                                                                S21046 10800002
PARMERR  EQU   *                  PRINT PARM ERROR MESSAGE       S21046 10820002
         LA    PARAMREG,MSG67     MESSAGE 67                     S21046 10840002
         L     LINKREG,MSGRTNAD   ADDRESS OF MESSAGE ROUTINE     S21046 10860002
         BALR  RETURN,LINKREG     GO TO MESSAGE ROUTINE          S21046 10880002
         MVI   ERRFLD+TWO,CODE4   SET RETURN CODE OF 4           S21046 10900002
         MVI   MSGOUT,BLANK       BLANK OUT THE MESSAGE AREA     S21046 10920002
         MVC   MSGOUT+INCRMNT1(MOVE55),MSGOUT                    S21046 10940002
         LA    PARAMREG,SKIP3     FORCE THREE SPACES             S21046 10960002
         L     LINKREG,MSGRTNAD        ADDR OF MESSAGE ROUTINE   S21046 10980002
         BALR  RETURN,LINKREG     GO SPACE THREE LINES           S21046 11000002
         B     STARTAGN           BEGIN ANEW                     S21046 11020002
IEHPROG9 EQU   *                                                  M2838 11040002
         ENTRY IEHPROG9                                           M2838 11060002
         BALR  15,0                                                     11080002
         USING *,15                                                     11100002
         DROP  RB2                DON'T WANT RB2 USED AS BASE    S21046 11120002
*                                 REG ON THE LOAD OF SCANBASE    S21046 11140002
         L     RB,SCANBASE        RESET OUR BASE REGISTR                11160002
         LA    RB2,OFFSET1K(RB)   SET UP BASE REG DISPLACEMENT   S21046 11180002
         L     15,DECB2                                                 11200002
         L     15,20(15)                                                11220002
         ST    15,DECB2+4               STORE RETURN ADDRESS            11240002
         DROP  15                                                       11260002
         USING IEHESCAN+OFFSET2,RB2                              S21046 11280002
         CLI   ERRFLD+TWO,SIXTEEN IS RETURN CODE 16              S21046 11300002
         BE    IEHPROGD           YES BRANCH TO SYSIN END         M2838 11320002
STTRESET LA    PARAMREG,49        FORCE A TRIPLE SPACE                  11340002
         L     LINKREG,MSGRTNAD        EXIT TO THE                      11360002
         BALR  RETURN,LINKREG          MESSAGE WRITER                   11380002
         CLI   ERRFLD,PRORTNCD    IS THIS RETURN FOR PROTECT     S21046 11400002
         BE    PRORETRN           YES BRANCH                     S21046 11420002
         OC    ERRFLD+1(1),ERRFLD  POST THE RETURN CODE                 11440002
         BZ    STARTAGN                NO ERROR--RESET SWITCHES  A25564 11460002
         CLI   ERRFLD,X'12'            WAS IO ERROR ENCOUNTERED  A25564 11480002
         BNE   SVCERROR                NO, GO POST ERROR FOR SVC A25564 11500002
SVR12    L     LINKREG,SEVER12    GO TO CONDITION CODE           S21046 11520002
         BALR  RETURN,LINKREG          HANDLER                   A25564 11540002
         B     STARTAGN                GO TO CLEAR SWITCHES      A25564 11560002
PRORETRN CLI   ERRFLD+ONEBYTE,TWELVE   IS RETURN I/O ERROR       S21046 11580002
         BE    SVR12              YES GO TO SEVERITY 12 RETURN   S21046 11600002
         CLI   ERRFLD+ONEBYTE,ZERORTN  IS RETURN CODE 0          S21046 11620002
         BE    STARTAGN           YES THEN START AGAIN           S21046 11640002
         B     SVCERROR           POST RETURN FOR SEVERITY 8     S21046 11660002
SVCERROR EQU   *                                                 A25564 11680002
         L     LINKREG,SEVER8          GO TO CONDITION CODE      A25564 11700002
         BALR  RETURN,LINKREG          HANDLER TO POST CODE OF 8 A25564 11720002
STARTAGN XC    IEHECHAR(DECB1-IEHECHAR),IEHECHAR     CLEAR SWITCHES     11740002
         XC    VOLISTAD(IEHERSAV-VOLISTAD),VOLISTAD    AND WORK AREA    11760002
         XC    ERRFLD(2),ERRFLD        CLEAR 1ST TWO BYTES OF    A25564 11780002
*                                      ERRFLD                    A25564 11800002
         MVC   CODELIST(8),SPECIALS  RESET SPECIAL CHARACTERS      9660 11820002
         NI    IEHESW2,PRNTBIT    INITIALIZE IEHESW2             S21046 11840002
*                                                                       11860002
*              THE MACRO PARAMETER LIST IS PARTIALLY CONSTRUCTED        11880002
*              HERE BY STORING INTO IT THE ADDRESSES THAT WILL          11900002
*              EVENTUALLY CONTAIN THE PARAMETERS THAT THE MACRO         11920002
*              REQUIRES FOR PROPER OPERATION                            11940002
*                                                                       11960002
         LA    R2,PARAM2                                                11980002
         LA    R3,PARAM3                                                12000002
         LA    R4,PARAM4                                                12020002
         STM   R2,R4,IEHEMAC1+4                                         12040002
         LA    SAVEREG,MARESAR                                          12060002
GETMORE  GET   UTINDCB,READTOO                                          12080002
         TM    IEHESW2,PRNTBIT    ARE WE TO PRINT CONTROL CARDS  S21046 12100002
         BC    8,CHECKPRT         NO THEN BRANCH                 S21046 12120002
         MVC   MSGOUT(80),READTOO                                       12140002
         SR    ZERO,ZERO          GO TO MSG WRITER                      12160002
         L     LINKREG,MSGRTNAD   WITH A REQUEST TO WRITE               12180002
         BALR  RETURN,LINKREG     FROM THE OUTPUT  AREA                 12200002
CHECKPRT CLC   READTOO(TWO),SLASHAST   CHECK INPUT STREAM FOR    S21046 12220002
         BNE   *+10                     A '/*' IN COLUMN 1 AND 2        12240002
         L     LINKREG,UTINDCB+32       EXIT ON A FIND                  12260002
         BR    LINKREG                                                  12280002
         CLI   COL72,BLANK        CHECK IF CONTINUE CARD                12300002
         BC    7,TURNSW                BRANCH IF CONTINUATION IS A23466 12320002
*                                      EXPECTED                  A23466 12340002
         OI    IEHESW1,CONTINUE    END OF CONTINUE CARDS SET BIT 2 SW 1 12360002
         NI    MOUNTSW,CLEAROUT        TURN ERROR SWITCH         A23466 12380002
*                                      INDICATOR OFF             A23466 12400002
         BC    15,COMMENT              BRANCH TO TEST FOR COMMENTA23466 12420002
*                                      IS ON                     A23466 12440002
TURNSW   EQU   *                                                 A23466 12460002
         OI    MOUNTSW,X'02'           TURN ERROR SWITCH         A23466 12480002
*                                      INDICATOR ON              A23466 12500002
COMMENT  EQU   *                                                 A23466 12520002
         TM    IEHESW1,COMMENTS        TEST IF COMMENT SWITCH    A23466 12540002
         BZ    CARDONE                                                  12560002
         TM    IEHESW1,CONTINUE    CHECK IF CONTINUE CARD               12580002
         BZ    GETMORE           BRANCH IF A COMMENT AND CONTINUE CARD  12600002
         TM    IEHESW1,NDSWMSK         TEST FOR END OF SCAN             12620002
         BO    ENDCALL                 BRANCH IF END                    12640002
         B     COMPAGN           GO BACK TO THE SCAN ROUTINE            12660002
CHECK16  CLI   COL16,BLANK        TEST IF COL 16 IS BLANK               12680002
         BNE   *+8                BRANCH IF IT IS NOT                   12700002
         OI    IEHESW1,COMMENTS    TURN ON THE COMMENTS SWITCH          12720002
         MVC   MIDDLE(57),COL16   BUTT THIS CARD TO PREVIOUS CARD       12740002
         B     COMPAGN            GO BACK TO THE SCAN ROUTINE           12760002
CARDONE  TM    IEHESW1,FIRSTONE    TEST IF THIS IS FIRST CARD           12780002
         BNE   CHECK16           BRANCH IF IT IS NOT                    12800002
         OI    IEHESW1,FIRSTONE     TURN OFF THE FIRST CARD SW.         12820002
         LA    R2,READTOO                                               12840002
         LA    R3,71(R2)                                                12860002
         STM   R2,R3,IEHESTIN     STORE STT AND STP FOR SCAN            12880002
         B     FNDECODE                                                 12900002
ENDATA   DC    F'0'                                                     12920002
*              THIS ROUTINE SCANS OFF A KEYWORD OR AN OPTION,           12940002
*              PERFORMS A TABLE LOOK UP ON THE FIELD SCANNED            12960002
*              OUT, AND FROM THE TABLE SELECTS THE ADDRESS              12980002
*              OF A ROUTINE TO WHICH IT THEN PASSES CONTROL             13000002
KODECODE BALR  RB,0                                                     13020002
         USING *,RB                                              S21046 13040002
         USING *+OFFSET1K,RB2                                    S21046 13060002
         LA    RB2,OFFSET1K(RB)   SET UP BASE REG DISPLACEMENT   S21046 13080002
         L     RB,SCANBASE                                              13100002
         LA    RB2,OFFSET1K(RB)   SET UP BASE REG DISPLACEMENT   S21046 13120002
         USING IEHESCAN+TWO,RB                                   S21046 13140002
         USING IEHESCAN+OFFSET2,RB2                              S21046 13160002
         MVC   IEHECHAR(2),ANYSPEC      STOP ON ANY SPECIAL CHARACTER   13180002
         MVI   IEHETBL,X'F0'            REQUEST A TLU.                  13200002
         BALR  RETURN,RB               ROUTINE                          13220002
         NI    IEHEARGL,X'07'                                           13240002
         LM    R2,R3,0(RBD)        PLACE THE KEYWORD                    13260002
         STC   R2,KWSA             AND ITS LENGTH                       13280002
         EX    R2,MOVEKEY          INTO KEYWORD SAVE AREA               13300002
         L     R7,IEHEFUN          ADDRESS OF FUNCTION TO REG 7         13320002
         LTR   R7,R7               TEST FOR A FIND IN THE TLU           13340002
         BZ    BADSYN              BRANCH IF NO FIND                    13360002
         SR    R8,R8                                                    13380002
         IC    R8,IEHECODE         GET THE DELIMITER CODE               13400002
         SLL   R8,2                4 TIMES THE CODE FOR INDEXING        13420002
         EX    0,DOSMTHIN(R8)                                           13440002
         BNE   BADSYN         BRANCH IF ERROR IN STATEMENT SYNTAX       13460002
*                   IF WE HAVE NOT BRANCHED AS A RESULT OF THE          13480002
*              PREVIOUS EXECUTE AND BNE INSTRUCTIONS THEN IT IS         13500002
*              ESTABLISHED THAT A COMMA OR BLANK DELIMITED A VALID      13520002
*              OPTION. OR  A AN EQUAL SIGN DELIMITED A VALID KEYWORD    13540002
*                   WE WILL THERFORE SELECT THE ADDRESS OF THE ROUTINE  13560002
*              WHICH HANDLES THIS KEYWORD OR OPTION AND GO TO IT.       13580002
*                   FIRST WE MUST UPDATE  THE START ADDRESS FOR SCAN.   13600002
         L     R4,IEHEFND                                               13620002
         LA    R4,1(R4)            UPDATE THE START                     13640002
         ST    R4,IEHESTT          ADDRESS FOR SCAN                     13660002
         SPACE 2                                                        13680002
         MVC   FULLWORD(4),2(R7)   ALLIGN THE REQUIRED ADDRESS          13700002
         L     R4,FULLWORD         PUT IT IN A REGISTER                 13720002
         BR    R4                  GO THERE                             13740002
MOVEKEY  MVC   KWSA+1(1),0(R3)                                          13760002
BADSYN   EQU   *                                                 A25564 13780002
         L     LINKREG,SEVER8          GO TO CONDITION CODE      A25564 13800002
         BALR  RETURN,LINKREG          HANDLER                   A25564 13820002
         LA    PARAMREG,3              PUT MSG# INTO REGISTER    A25564 13840002
         B     GOAGAIN                                                  13860002
DOSMTHIN B     BADSYN                                                   13880002
         B     BADSYN              ONE OF THESE INSTRUCTIONS IS         13900002
         CLI   0(R7),X'02'         EXECUTED TO PROVIDE A CHECK          13920002
         CLI   0(R7),X'01'        ON CONTROL CARD SYNTAX WHICH          13940002
         B     BADSYN              ONE IS DETERMINED BY THE DELIMITER   13960002
         B     BADSYN              FOUND BY THE LAST SCAN.              13980002
         CLI   0(R7),X'02'                                              14000002
         SPACE 2                                                        14020002
****     ****       FUNCTION  NAME  DECODING       ****    ****    **** 14040002
         SPACE 2                                                        14060002
*        THE PURPOSE OF THIS ROUTINE IS TO OBTAIN THE ADDRESS OF        14080002
*        ANOTHER ROUTINE WHICH WILL BE USED LATER TO CALL THE MACRO     14100002
*        WHICH WILL PROVIDE THE REQUESTED FUNCTION.                     14120002
         SPACE 1                                                        14140002
*             TO THIS END IT WILL TEST CONTROL STATEMENT FOR THE        14160002
*        PRESENCE OF A NAME FIELD.  IF ONE IS PRESENT IT WILL    A24020 14180002
*        SCAN OVER IT FOR SYNTAX ERRORS.  BLANKS PRECEEDING THE  A24020 14200002
*        OPERAND FIELD WILL BE SKIPPED.  THE ROUTINE WILL THEN   A24020 14220002
*        SCAN OUT THE FUNCTIONS NAME, PERFORM A TABLE LOOK UP    A24020 14240002
*        WITH IT AND MOVE THE ASSOCIATED ADDRESS TO A KNOWN      A24020 14260002
*        LOCATION FOR FUTURE REFERENCE.                          A24020 14280002
FNDECODE LA    R3,IEHESTIN         START AND STOP ADDRESSES             14300002
         LM    R3,R4,0(R3)         ARE PLACED IN THE                    14320002
         STM   R3,R4,IEHESTT       SCANLIST                             14340002
         MVI   CCNAME,BLANKBYT    BLANK OUT CCNAME IN DSECT      S21046 14360002
         MVC   CCNAME+ONEBYTE(SEVEN),CCNAME                      S21046 14380002
         CLI   0(R3),C' '     TEST FOR A BLANK NAME FIELD               14400002
         BE    NONAME                                                   14420002
         CLI   0(R3),C'A'              TEST TO SEE IF 1ST CHAR   A24020 14440002
*                                      IS AN ALPHABETIC          A24020 14460002
         BC    4,SETERROR              IF LOW GO SET ERROR SWITCHA24020 14480002
         CLI   0(R3),C'Z'              TEST TO SEE IF 1ST CHAR @ZM33351 14500003
*                                      IS AN ALPHABETIC          A24020 14520002
         BC    2,SETERROR              IF HIGH GO TO SET ERROR SWA24020 14540002
CONTSCAN EQU   *                                                 A24020 14560002
         LA    R3,1(R3)                GO TO NEXT BYTE           A24020 14580002
         ST    LISTREG,AREAONE         SAVE REGISTER 1           A24020 14600002
         ST    R2,AREATWO              SAVE REGISTER 2           A24020 14620002
         ST    R5,AREAFIVE             SAVE REGISTER 5           A24020 14640002
         ST    R6,AREASIX              SAVE REGISTER 6           A24020 14660002
         XR    LISTREG,LISTREG         CLEAR OUT REGISTER 1      A24020 14680002
         XR    R2,R2                   CLEAR OUT REGISTER 2      A24020 14700002
         TRT   0(8,R3),TRTTABLE        SCAN NAME FIELD OF        A24020 14720002
*                                      CONTROL STATEMENT         A24020 14740002
SCAN     EQU   *                                                 A24020 14760002
         LR    R6,LISTREG              PUT ADDRESS OF LAST BYTE  A24020 14780002
*                                      SCANNED INTO REGISTER 6   A24020 14800002
         BC    8,TOOLONG               BRANCH IF NAME IS TOO LONGA24020 14820002
BRNCHTAB BC    15,BRNCHTAB(R2)         TAKE BRANCH DEPENDENT UPONA24020 14840002
*                                      CONTENTS OF REGISTER 2    A24020 14860002
         BC    15,INVALID              CC=4 BRANCH TO INVALID RTNA24020 14880002
ENDSCAN  EQU   *                                                 A24020 14900002
         ST    R6,IEHEFND              PUT ADDRESS OF BLANK      A24020 14920002
*                                      FOUND INTO IEHEFND        A24020 14940002
         L     R2,IEHESTT         LOAD ADDRESS OF CONTROL CARD N S21046 14960002
         SR    R6,R2              GET NAME FIELD LENGTH          S21046 14980002
         EX    R6,CCMOVE          MOVE THE NAME TO SAVE IT       S21046 15000002
         L     LISTREG,AREAONE         RESTORE                   A24020 15020002
         L     R2,AREATWO                REGISTERS               A24020 15040002
         L     R5,AREAFIVE                 TO ORGINAL            A24020 15060002
         L     R6,AREASIX                    STATUS              A24020 15080002
         TM    MOUNTSW,ERRSW2     WAS SYNTAX ERROR FOUND         S21046 15100002
         BC    8,SCANOPRD              NO, SYNTAX ERROR WAS NOT  A24020 15120002
*                                      FOUND, GO TO CONTINUE SCANA24020 15140002
*                                      OF CONTROL STATEMENT      A24020 15160002
         NI    MOUNTSW,CLEARSW         TURN ERROR SWITCH OFF     A24020 15180002
         LA    PARAMREG,58             PUT ERROR MESG NUMBER     A24020 15200002
*                                      INTO REG 0                A24020 15220002
         MVI   MSGOUT,C' '             CLEAR                     A24020 15240002
         MVC   MSGOUT+1(119),MSGOUT    MESSAGE AREA              A24020 15260002
         L     LINKREG,MSGRTNAD        PUT ADDRESS OF MSG RTN    A24020 15280002
*                                      INTO REG 15               A24020 15300002
         BALR  RETURN,LINKREG          GO WRITE MESSAGE          A24020 15320002
         L     LINKREG,SEVER4          GO TO CONDITION CODE      A24020 15340002
         BALR  RETURN,LINKREG          HANDLER                   A24020 15360002
         BC    15,SCANOPRD             CONTINUE TO SCAN CONTROL  A24020 15380002
*                                      STATEMENT                 A24020 15400002
SETERROR EQU   *                                                 A24020 15420002
         OI    MOUNTSW,X'04'           NO, POST ERROR CODE OF 4  A24020 15440002
         BC    15,CONTSCAN             BRANCH TO CONTINUE SCAN OFA24020 15460002
*                                      NAME FIELD                A24020 15480002
TOOLONG  EQU   *                                                 A24020 15500002
         OI    MOUNTSW,X'04'           POST ERROR CODE OF 4      A24020 15520002
         LA    R6,8(R3)                GO TO NEXT BYTE           A24020 15540002
TESTAGAN EQU   *                                                 A24020 15560002
         CLI   0(R6),X'40'             IS THIS BYTE BLANK        A24020 15580002
         BC    8,ENDSCAN               YES, GO TO END OF SCAN    A24020 15600002
         LA    R6,1(R6)                GO TO NEXT BYTE           A24020 15620002
         BC    15,TESTAGAN             NO, TEST NEXT BYTE        A24020 15640002
INVALID  EQU   *                                                 A24020 15660002
         OI    MOUNTSW,X'04'           POST ERROR CODE OF 4      A24020 15680002
         LA    R5,7(R3)                PUT ADDRESS OF LAST BYTE  A24020 15700002
*                                      TO BE SCANNED INTO REG 5  A24020 15720002
         SR    R5,R6                   FIND OUT HOW MANY BYTES   A24020 15740002
*                                      ARE LEFT TO BE SCANNED    A24020 15760002
         LA    R8,1(R6)                GO TO NEXT BYTE           A24020 15780002
         BCTR  R5,0                    TAKE ONE FROM REGISTER 5  A24020 15800002
         XR    LISTREG,LISTREG         CLEAR REGISTER 1          A24020 15820002
         XR    R2,R2                   CLEAR REGISTER 2          A24020 15840002
         EX    R5,NEXTTEST             INSERT NUMBER OF BYTES TO A24020 15860002
*                                      BE SCANNED INTO TRT INSTR A24020 15880002
         BC    15,SCAN                 GO TO SCAN ANALYSIS RTN   A24020 15900002
CCMOVE   MVC   CCNAME(ONEBYTE),ZERODSP(R2)                       S21046 15920002
*                                 MOVE FOR NAME FIELD            S21046 15940002
NEXTTEST TRT   0(0,R8),TRTTABLE        USED FOR SCAN OF NAME     A24020 15960002
*                                      FIELD                     A24020 15980002
SCANOPRD EQU   *                                                 A24020 16000002
         NI    IEHESW1,ENDSWOFF                                         16020002
*        AT THIS POINT THE NAME FIELD HAS BEEN SCANNED FOR THESE A24020 16040002
*        SYNTAX ERRORS:                                          A24020 16060002
*        1.  THE FIRST CHARACTER NOT BEING AN ALPHABETIC.        A24020 16080002
*        2.  THE NAME FIELD BEING LONGER THAN 8 CHARACTERS.      A24020 16100002
*        3.  CHARACTERS 2-8 CONTAINING ANYTHING OTHER THAN       A24020 16120002
*            ALPHAMERIC OR NATIONAL CHARACTERS                   A24020 16140002
*        IF ANY OF THE ABOVE CONDITIONS ARE FOUND AN ERROR       A24020 16160002
*        MESSAGE IS WRITTEN AND A CONDITION CODE OF 4 IS         A24020 16180002
*        POSTED.  THE SEARCH IS NOW CONTINUED FROM THE FIRST     A24020 16200002
*        BLANK COLUMN TO THE FIRST NONBLANK COLUMN (THE START OF A24020 16220002
*        THE OPERATION FIELD.)                                   A24020 16240002
         MVC   IEHESTT(4),IEHEFND       START ADDRESS ALONG WITH        16260002
NONAME   MVC   IEHECHAR(2),NOTBLANK     CHARACTER AND CODE ARE          16280002
*                                       INSERTED INTO THE SCANLIST      16300002
         L     RB,SCANAD          GO TO THE SCAN                        16320002
         LA    RB2,OFFSET1K(RB)   SET UP BASE REG DISPLACEMENT   S21046 16340002
         BALR  RETURN,RB               ROUTINE                          16360002
         USING *,RETURN            SCAN RETURNS WITH THE ADDRESS        16380002
         DROP  RB2                DON'T WANT RB2 USED AS BASE    S21046 16400002
*                                 REG ON THE LOAD OF SCANBASE    S21046 16420002
         L     RB,SCANBASE         OF THE BEGINING OF THE OPERATION     16440002
         LA    RB2,OFFSET1K(RB)   SET UP BASE REG                S21046 16460002
         DROP  RETURN              FIELD                                16480002
         USING IEHESCAN+OFFSET2,RB2                              S21046 16500002
*             I WILL NOW SCAN ACROSS THE OPERATION FIELD AND HAVE       16520002
*        A TABLE LOOK UP PERFORMED ON THE OPERATION SCANNED OUT.        16540002
*        IF THE OPERATION IS NOT FOUND IN THE TABLE OR IS FOUND BUT     16560002
*        IS NOT A FUNCTION NAME A DIAGNOSTIC MESSAGE WILL BE            16580002
*        WRITTEN AND THE REQUEST IGNORED                                16600002
         MVC   IEHESTT(4),IEHEFND       RESET START ADDRESS             16620002
         MVC   IEHECHAR(2),BLANKEQU     RESET CHARACTER AND CODE        16640002
         MVI   IEHETBL,X'FF'            ISSUE REQUEST FOR TLU           16660002
         L     RB,SCANAD          GO TO THE SCAN                        16680002
         BALR  RETURN,RB               ROUTINE                          16700002
         NI    IEHEARGL,X'07'      PLACE FUNCTION NAME                  16720002
         LM    R2,R3,0(RBD)        AND ITS LENGTH                       16740002
         STC   R2,FNSA             INTO FUNCTION NAME                   16760002
         EX    R2,*+8              SAVE AREA                            16780002
         B     *+10                                                     16800002
         MVC   FNSA+1(1),0(R3)                                          16820002
         NI    IEHESW1,ENDSWOFF                                         16840002
         L     R4,IEHEFUN          R4 GETS ADDRESS OF TABLE FUNCTION    16860002
         LTR   R4,R4                                                    16880002
         BZ    NOTINTAB            BRANCH IF NO FIND FROM TLU ROUTINE   16900002
         CLI   0(R4),X'03'         TEST FOR A VALID REQUEST NAME.       16920002
         BNE   NOTINTAB            BRANCH IF NOT VALID                  16940002
         MVC   FINUSE(4),2(R4)         ----------FDLD INSERT-------     16960002
*             AT THIS POINT THE ADDRESS OF THE ROUTINE WHICH PROVIDES   16980002
*        THE REQUESTED FUNCTION HAS BEEN STORED. WE WILL NOW SCAN OVER  17000002
*        BLANKS WHICH PRECEED THE OPERAND FIELD, AND SET UP SCANLIST    17020002
*        BEFORE GOING TO THE KEYWORD AND OPTION DECODER.                17040002
         MVC   IEHESTT(4),IEHEFND      RESET THE START ADDRESS          17060002
         MVC   IEHECHAR(2),NOTBLANK    RESET CHARACTERS AND CODE        17080002
         SR    R6,R6                                                    17100002
         ST    R6,IEHETBL               NO TLU WANTED                   17120002
         L     RB,SCANAD          GO TO THE SCAN                        17140002
         BALR  RETURN,RB               ROUTINE                          17160002
         MVC   IEHESTT(4),IEHEFND       RESET START ADDRESS             17180002
*-----------------GENERAL FUNCTION ROUTINE-----------------             17200002
FDLD     L     R9,FINUSE           GET ADDRESS OF LIST IN USE           17220002
         LA    R5,ONEWORD(R9)                                    S21046 17240002
         ST    R5,FINUSE          UPDATE THE ADDRESS OF LIST     S21046 17260002
         SR    R2,R2                                                    17280002
         IC    R2,0(R9)                                                 17300002
         SLL   R2,2                SELECT THE ROUTINE TO BE PERFORMED   17320002
         LA    RETURN,FDLD              PROVIDE A RETURN                17340002
         EX    0,*+4(R2)           GO THERE                             17360002
*                                                                       17380002
* ONE OF THESE BRANCH INSTRUCTIONS ARE EXECUTED AS DETERMINED FROM      17400002
*        THE FIRST BYTE OF THE  DATA LIST  FOR THE FUNCTION IN USE      17420002
         B     XCONTROL           EXECUTE FOR A ZERO OP                 17440002
         B     LISTECII           EXECUTE FOR A ONE  OP                 17460002
         B     TESTDUP            EXECUTE FOR A TWO  OP                 17480002
         B     SETDUP                                                   17500002
         B     LINKSAVE                                                 17520002
         B     DCRETURN                                                 17540002
         B     GETAMSG                                                  17560002
         B     EXECUTE                                                  17580002
         B     READALL                                                  17600002
         B     STTRESET                                                 17620002
         B     XCTL                                                     17640002
         B     SETCCODE                GO SET CONDITION CODE     A25564 17660002
         B     INIT               INITIALIZE PARAMETER LIST      S21046 17680002
         B     DSLNGTH            PUT DSNAME LENGTH IN PARAMETER S21046 17700002
*                                 LIST FOR PROTECT               S21046 17720002
*                                 FOR LIST OPERATION             S21046 17740002
FRECOVER MVC   FINUSE(4),FLSTADDR                                       17760002
         B     FDLD                                                     17780002
*    ZERO IN FIRST BYTE WE WILL PASS CONTROL TO THE LOCATION SPECIFIED  17800002
XCONTROL L     R2,0(R9)                                                 17820002
         BR    R2             GO TO LOCATION IN THE DATA LIST           17840002
*    A ONE  OP CODE CAUSES SETTING OF PAIAMSW, MAC1, CALL,ETC.          17860002
*        INITIALIZE  THE FUNCTION ---A ONE IN FIRST BYTE----            17880002
*                                                                S21046 17900002
*   SET UP TO ANALYZE OPERANDS                                   S21046 17920002
*                                                                S21046 17940002
LISTECII MVC   PPARAMSW(2),2(R9)                                        17960002
         MVC   IEHEMAC1(4),4(R9)                                        17980002
         LA    R2,FRECOVER                                              18000002
         ST    R2,IEHECALL                                              18020002
         LA    R5,ONEWORD(R5)                                    S21046 18040002
         ST    R5,FLSTADDR                                       S21046 18060002
         B     KODECODE                                                 18080002
*                                                                S21046 18100002
*   TEST FOR MINIMUM PARAMETERS                                  S21046 18120002
*                                                                S21046 18140002
TESTDUP  IC    R2,3(R9)           2 OP  TEST A SWITCH                   18160002
         SLL   R2,4                                                     18180002
         IC    R3,2(R9)                                                 18200002
         SR    R4,R4                                                    18220002
         IC    R4,1(R9)                                                 18240002
         LA    R4,DUPSW(R4)                                             18260002
         EX    R3,TESTSW                                                18280002
         EX    R2,BOC                                                   18300002
         LA    R5,ONEWORD(R5)                                    S21046 18320002
        ST    R5,FINUSE                                          S21046 18340002
         B     FDLD                                                     18360002
TESTSW   TM    0(R4),ZERO                                               18380002
BOC      BC    0,FDLD                                                   18400002
*   SET THE DUPSW  A 3 OP    MASK IS LAST BYTE                          18420002
SETDUP   L     R2,0(R9)                                                 18440002
         EX    R2,DUPSET                                                18460002
         B     FDLD                                                     18480002
DUPSET   OI    DUPSW,ZERO                                               18500002
*                                                                S21046 18520002
*   PICK UP ROUTING TABLE FOR MESSAGES TO BE PRINTED             S21046 18540002
*                                                                S21046 18560002
LINKSAVE L     R2,0(R9)                                                 18580002
         ST    R2,FINUSE                                                18600002
         ST    R5,DCSAVEAD                                       S21046 18620002
         B     FDLD                                                     18640002
*        5 OP   RETURN TO OLD DC LIST IN DCSAVEAD                       18660002
DCRETURN MVC   FINUSE(4),DCSAVEAD                                       18680002
         B     FDLD                                                     18700002
*        6 OP  SET REG ZERO AND GO TO THE MSG WRITER                    18720002
GETAMSG  L     PARAMREG,0(R9)                                           18740002
         L     LINKREG,MSGRTNAD                                         18760002
         BR    LINKREG                                                  18780002
*        7  OP  EXECUTE A REMOTE INSTRUCTION  OP  ADDR                  18800002
EXECUTE  L     LINKREG,0(R9)                                            18820002
         EX    0,0(LINKREG)                                             18840002
         B     FDLD                                                     18860002
SETCCODE EQU   *                       SET CONDITION CODE        A25564 18880002
         ST    RETURN,IEHECALL                                   A25564 18900002
         L     LINKREG,SEVER8          GO TO CONDITION           A25564 18920002
         BALR  RETURN,LINKREG          CODE HANDLER              A25564 18940002
         L     RETURN,IEHECALL         RESTORE REGISTER 14       A25564 18960002
         OI    IEHESW1,NDSWMSK                                   A25564 18980002
         BR    RB                      GO BACK TO IEHESCAN       A25564 19000002
*                                                                S21046 19020002
*       12 OP     INITIALIZE FOR PROTECT COMMANDS                S21046 19040002
*                                                                S21046 19060002
INIT     XC    IEHEMAC1+EIGHT(NINETEEN),IEHEMAC1+EIGHT ZERO OUT  S21046 19080002
*                                 MOVE ZEROES TO PARAMETER LIST  S21046 19100002
         LA    R3,CNT1PAS         LOAD DECREMENT FOR ONE WTOR    S21046 19120002
         STC   R3,PASWDCT1        STORE DECREMENT FOR PASWORD1   S21046 19140002
         STC   R3,PASWDCT3        STORE DECREMENT FOR CPASWORD   S21046 19160002
         B     FDLD               GO TO NEXT ENTRY OF TABLE      S21046 19180002
*                                                                S21046 19200002
*        13 OP PUT DSNAME LENGTH INTO PARAMETER FOR PROTECT      S21046 19220002
*                                                                S21046 19240002
DSLNGTH  IC    R2,PARAM2-ONEBYTE  PUT THE DSNAME LNGTH IN PARM   S21046 19260002
         LA    R2,ONEBYTE(R2)                                    S21046 19280002
         STC   R2,IEHEMAC1+ONEWORD                               S21046 19300002
         B     FDLD               GO TO NEXT ENTRY OF TABLE      S21046 19320002
*        8 OP  READ ALL CARD ASSOCIATED WITH THIS JOB NOW               19340002
READALL  OI    IEHESW1,NDSWMSK                                          19360002
         ST    RETURN,IEHECALL                                          19380002
         BR    RB                      GO BACK TO IEHESCAN       A25564 19400002
XCTL     L     R2,0(R9)                GET NUMBER OF THE LIST IN USE    19420002
         TM    DUPSW,X'08'        WAS MEMBER SPECIFIED                  19440002
         BZ    NOMEMBER           NO ..... BRANCH                       19460002
         OI    PPARAMSW,X'01'     SO VOL MOUNT WILL MOVE A DCB          19480002
         MVC   IEHEMAC1+8(4),IEHEMAC1+4                                 19500002
         MVI   IEHEMAC1,X'C1'                                           19520002
         MVI   IEHEMAC1+2,X'20'   SET UP A MEMBER OPERATOON             19540002
         CLI   PARAM4+1,X'01'     IS THERE MORE THAN 1 VOLUME           19560002
         BNE   XTRAKEY            YES .... BRANCH   (ERROR)             19580002
         LA    R2,13              POINT TO THE MEMBER LIST              19600002
NOMEMBER EQU   *                                                        19620002
         ST    R2,FINUSE               STORE IT FOR THE SECOND LOAD     19640002
         TM    IEHESW2,MNTVOL     IS VOL PRESENT FOR PROTECT     S21046 19660002
         BZ    NOPROTCT           NO BRANCH                      S21046 19680002
         OI    IEHEMAC1,VOLMNT    CAUSE VOL MOUNTING             S21046 19700002
NOPROTCT EX    ZERO,GETAVOL       HAVE REQUIRED VOLUMES MOUNTED  S21046 19720002
         L     15,DECB2                GET ADDRESS OF V ADCONS          19740002
         L     15,28(15)               GET V ADCON OF SECOND LOAD       19760002
         BR    15                      GO THERE                         19780002
NOTINTAB EQU   *                                                 A25564 19800002
         L     LINKREG,SEVER8          GO TO CONDITION CODE      A25564 19820002
         BALR  RETURN,LINKREG          HANDLER                   A25564 19840002
         LA    PARAMREG,2                                        A25564 19860002
         B     GOAGAIN                                                  19880002
*        THIS ROUTINE WILL HANDLE THE MOVING OF PARAMETERS THAT         19900002
*        DO NOT REQUIRE ANY THING OTHER THAN MOVING  THAT IS            19920002
*        THEY DO NOT NEED ANY CONVERSTION OR UNPACKING ETC.             19940002
JUSTMOVE EQU   *                                                        19960002
         MVC   CODELIST(8),COMBLANK    SET SCAN FOR A COMMA OR BLANK    19980002
         XC    IEHETBL(4),IEHETBL      REQUEST NO TQBLE LOOK UP         20000002
         BALR  RETURN,RB                GO TO SCAN ROUTINE              20020002
         MVC   CODELIST(8),SPECIALS     RESET SPECIAL CHARACTERS        20040002
         SPACE 1                                                        20060002
*              ON RETURNING FROM SCAN WE HAVE ALL THE INFO NEEDED       20080002
*          TO MOVE THE ITEM JUST SCANNED OFF. THE ADDRESS AND LENGTH    20100002
*          OF THE ITEM ARE IN THE SCANLIST. THE RECEIVE LOCATION CAN    20120002
*          BE DETERMINED FROM THE 2ND BYTE OF THE FUNCTION POINTED TO   20140002
*          BY THE SCANLIST THIS FUNCTION IS ASSOCIATED  WITH THE        20160002
*          KEYWORD WHICH CAUSED ENTRY TO THIS ROUTINE.                  20180002
         SPACE 1                                                        20200002
         CLI   IEHEARGL,X'2B'           CHECK LENGTH OF THE SCAN        20220002
         BH    CODERR                  BRANCH IF DSNAME IS LONGER M1607 20240002
*                                      THAN 44 CHARACTERS         M1607 20260002
         TM    PPARAMSW+1,X'02'        MEMBERNAME SCANNED?     @ZA01655 20270002
         BO    MEMBLNG            YES.CHECK LGTH OF MEMBERNAME @ZA01655 20272002
*                                                                A28552 20280002
*     CHECK NAME , ALIAS , OR INDEX GIVEN FOR INDEX LEVEL <= 8 CHARS    20300002
*  ALPHABETIC FIRST CHARACTERS , AND ALPHAMERIC CHARACTERS .     A28552 20320002
*                                                                A28552 20340002
CHECKS   TM    PPARAMSW+1,X'01'        CHECK 1ST CHARS ?       @ZA01655 20360002
         BZ    DONTCHCK                NO CHECK REQUIRED         A28552 20380002
         L     NAMEPTR,IEHESTT         GET ADDRESS OF NAME       A28552 20400002
         STM   LISTREG,R2,AREAONE      SAVE REGISTERS            A28552 20420002
         XR    LISTREG,LISTREG         ZERO OUT REGISTERS USED   A28552 20440002
*                                      IN TRT INSTRUCTION        A28552 20460002
         TM    PPARAMSW+1,X'02'        IS THIS A MEMBER NAME ?   A28552 20480002
         BZ    NXTFRST                 IF NOT BRANCH             A28552 20500002
         NI    PPARAMSW+1,X'FD'        TURN OFF THE MEMBER BIT   A28552 20520002
         B    CHCKLNG                  DON'T CHECK FOR ALPHABETICA28552 20540002
*                                      FIRST CHARACTER           A28552 20560002
MEMBLNG  NI    PPARAMSW+1,X'FD'        TURN OFF THE MEMBER BIT @ZA01655 20560102
         CLI   IEHEARGL,X'07'          MEMBERNAME > 8.         @ZA01655 20570002
         BH    CODERR                  YES... ERROR MSG        @ZA01655 20572002
         B     CHECKS                  NO.. GO ON TESTING      @ZA01655 20574002
NXTFRST  EQU   *                       CHECK FIRST CHARACTER OF  A28552 20580002
*                                      INDEX LEVEL TO BE SURE    A28552 20600002
         CLI   0(NAMEPTR),C'$'         IT IS BETWEEN $ AND Z     A28552 20620002
         BL    CODERR                                            A28552 20640002
         CLI   0(NAMEPTR),C'Z'                                   A28552 20660002
         BH    CODERR                                            A28552 20680002
CHCKLNG  EQU   *                                                 A28552 20700002
         TRT   0(9,NAMEPTR),TRTTABLE   CHECK CHAR VALIDITY       A28552 20720002
         BC    8,CODERR                BRANCH IF TOO LONG        A28552 20740002
         CLC   0(1,ARGREG),SPECIALS+1  DELIMITED BY A COMMA ?    A28552 20760002
         BE    LOADREG                 IF SO MOVE ON             A28552 20780002
         CLC   0(1,ARGREG),SPECIALS+6  DELIMITED BY A BLANK ?    A28552 20800002
         BE    LOADREG                 IF SO MOVE ON             A28552 20820002
         CLC   0(1,ARGREG),SPECIALS    DELIMITED BY A PERIOD ?   A28552 20840002
         BNE   CODERR                  IF NOT BRANCH TO ERROR RTNA28552 20860002
         LA    NAMEPTR,1(ARGREG)       UPDATE POINTER            A28552 20880002
         B     NXTFRST                 CHECK 1ST CHAR OF NEXT    A28552 20900002
*                                      INDEX LEVEL               A28552 20920002
CODERR   EQU   *                                                 A28552 20940002
         L     LINKREG,SEVER8          GO SET CONDITION CODE     A28552 20960002
         BALR  RETURN,LINKREG                                    A28552 20980002
         LA    PARAMREG,59             MESSAGE NUMBER 59         A28552 21000002
         B     GOAGAIN                 BRANCH TO LINK ROUTINE    A28552 21020002
LOADREG  EQU   *                                                 A28552 21040002
         LM    LISTREG,R2,AREAONE      RESTORE REGISTERS         A28552 21060002
         TM    IEHEMAC1+2,X'20'         IS THIS RENAME           A42349 21080002
         BZ    DONTCHCK                IF NOT DONT TURN OFF BIT  A42349 21100002
         NI    PPARAMSW+1,X'FE'        TURN OFF TEST BIT         A42349 21120002
DONTCHCK EQU   *                                                 A28552 21140002
         L     R2,IEHEFUN              FUNCTION ADDRESS TO R2           21160002
         SR    R3,R3                                                    21180002
         IC    R3,1(R2)       NUMBER OF RECEIVE AREA TO REG 3           21200002
         LA    R4,256             PUT A BIT IN REG FOUR                 21220002
         SRL   R4,0(R3)           BUILD A MASK WITH IT                  21240002
         EX    R4,DUPTEST         TEST FOR DUPLICATE PARAMETERS         21260002
         BO    XTRAKEY                 BRANCH IF DUPLICATED      A25564 21280002
         EX    R4,SETDUPSW        NO DUPLICATE   THEN TURN ON SWITCH    21300002
         SLL   R3,2           4 TIME THE NUMBER FOR INDEXING            21320002
         L     R4,WARE2PUT(R3)     ADDR OF RECEIVE AREA TO REG 4        21340002
         MVI   0(R4),C' '                                               21360002
         MVC   1(43,R4),0(R4)           CLEAR RECEIVE AREA TO BLANKS    21380002
         L     R5,IEHESTT               ADDRESS OF DATA TO REG 5        21400002
         IC    R3,IEHEARGL              LENGTH OF DATA TO REG 3         21420002
         EX    R3,MOVEDATA    MOVE THE PARAMETER TO ITS AREA            21440002
         BCTR  R4,0                INTO THE RECEIVE AREA -1             21460002
         STC   R3,0(R4)            STORE THE LENGTH                     21480002
         L     R6,IEHEFND                                               21500002
         LA    R6,1(R6)           1 UP START ADDRESS FOR SCAN           21520002
         ST    R6,IEHESTT                                               21540002
         B     KODECODE                                                 21560002
MOVEDATA MVC   0(1,R4),0(R5)  MOVES DATA TO RECEIVE AREA WHEN EXECUTED  21580002
DUPTEST  TM    DUPSW,X'00'        TESTS FOR DUPLICATE PARAMETERS        21600002
SETDUPSW OI    DUPSW,X'00'        RECORDS PARAMETERS PRESENCE           21620002
INDEX    TM    PPARAMSW,X'80'          TEST TO SEE IF INDEX SHOULD BE   21640002
         BO    JUSTMOVE                PRESENTIF YES GO MOVE IT         21660002
XTRAKEY  EQU   *                                                 A25564 21680002
         LA    LISTREG,XTRADATA                                  A25564 21700002
ENT2FDLD ST    LISTREG,FINUSE                                           21720002
         B     FDLD                                                     21740002
EMPTY    TM    PPARAMSW+1,X'80'   IS EMPTY ALLOWED                      21760002
         BZ    XTRAKEY            NO ..... BRANCH                       21780002
         OI    IEHEMAC1+2,X'08'   RECORD THE PRESENCE OF EMPTY          21800002
         B     KODECODE                                                 21820002
DELETE   TM    PPARAMSW+1,X'80'   IS DELETE ALLOWED                     21840002
         BZ    XTRAKEY            NO ..... BRANCH                       21860002
         OI    IEHEMAC1+2,X'40'   RECORD DELETE                         21880002
         B     KODECODE                                                 21900002
ENTRIES  TM    PPARAMSW+1,X'80'   IS ENTRIES ALLOWED                    21920002
         BZ    XTRAKEY            NO ..... BRANCH                       21940002
         TM    DUPSW,X'02'                                              21960002
         BO    XTRAKEY       BRANCH IF ENTRIES IS SPECIFIED TWICE       21980002
         OI    DUPSW,X'02'        RECORD ENTRIES                        22000002
         XC    IEHETBL(4),IEHETBL   PREVENT A TLU                       22020002
         BALR  RETURN,RB          SCAN OFF THE NUMBER                   22040002
         MVC   VOLISTAD(4),IEHEMAC1+12                                  22060002
         B     DSSEQ              UNPACK,CONVERT,STORE AT PARAM4+1      22080002
CVOL     TM    PPARAMSW,X'40'          TEST TO SEE IF CVOL SHOULD BE    22100002
         BZ    XTRAKEY                                                  22120002
         OI    IEHEMAC1,X'80'                                           22140002
         TM    DUPSW,X'20'                                              22160002
         BO    XTRAKEY            BRANCH IF DUPLICATE ENTRY             22180002
         OI    DUPSW,X'20'                                              22200002
         LA    R3,PARAM3                                                22220002
         ST    R3,VOLISTAD                                              22240002
         LA    R4,VMATRIX1                                              22260002
         ST    R4,MATRIXIU                                              22280002
         LA    R3,PARAM3+4                                              22300002
         ST    R3,IEHEMAC1+8                                            22320002
         OI    IEHESW2,CVOLBIT    TURN ON THE CVOL BIT           S21046 22340002
         B     VOLSCAN                                                  22360002
MEMBER   TM    IEHEMAC1,X'01'     SHOLUD MEMBER BE PRESENT              22380002
         BZ    XTRAKEY            NO ..... BRANCH                       22400002
         OI    PPARAMSW+1,X'02'        TURN ON BIT TO HAVE     @ZA01655 22420002
*                                      MEMBER CHECKED FOR        A28552 22440002
*                                      LENGTH AND ALPHAMERICS    A28552 22460002
         LA    0,EOCORE                                                 22480002
         ST    0,IEHEMAC1+16                                            22500002
DSNAME   TM    PPARAMSW,X'10'     SHOULD DSNAME BE HERE ?               22520002
         BZ    XTRAKEY             NO... BRANCH                         22540002
         NI    PPARAMSW,X'FE'                                           22560002
         B     JUSTMOVE                                                 22580002
*                                                                S21046 22600002
*      CHECK TO BE SURE PASWORD1 IS VALID HERE, IF IT IS A       S21046 22620002
*      DUPLICATE, AND INITIALIZE TO MOVE IT TO THE PROTECT       S21046 22640002
*      PARAMETER LIST                                            S21046 22660002
*                                                                S21046 22680002
PASWORD1 TM    PPARAMSW+ONEBYTE,PSWD1MSK SHOULD PASWORD1 BE HERE S21046 22700002
         BZ    XTRAKEY            NO IT IS REDUNDANT             S21046 22720002
         TM    DUPSW+ONEBYTE,PSWD1DUP  HAS PASWORD1 BEEN HERE    S21046 22740002
         BO    XTRAKEY            YES IT IS A DUPLICATE          S21046 22760002
         OI    DUPSW+ONEBYTE,PSWD1DUP  INDICATE PASWORD1 PRESENT S21046 22780002
         LA    R3,PARAM3          GET ADDRESS FOR PASWORD1       S21046 22800002
         ST    R3,IEHEMAC1+PSWD1PRM    STORE AD IN PARAMETERS    S21046 22820002
         B     MOVPASWD           GO MOVE PASWORD1 TO ITS AREA   S21046 22840002
*                                                                S21046 22860002
*      CHECK TO BE SURE PASWORD2 IS VALID HERE, IF IT IS A       S21046 22880002
*      DUPLICATE, AND INITIALIZE TO MOVE IT TO THE PROTECT       S21046 22900002
*      PARAMETER LIST.                                           S21046 22920002
*                                                                S21046 22940002
PASWORD2 TM    PPARAMSW+ONEBYTE,PSWD2MSK SHOULD PASWORD2 BE HERE S21046 22960002
         BZ    XTRAKEY            NO IT IS REDUNDANT             S21046 22980002
         TM    DUPSW+ONEBYTE,PSWD2DUP  HAS PASWORD2 BEEN HERE    S21046 23000002
         BO    XTRAKEY            YES IT IS A DUPLICATE          S21046 23020002
         OI    DUPSW+ONEBYTE,PSWD2DUP  INDICATE PASWORD2 PRESENT S21046 23040002
         LA    R3,PARAM7          GET ADDRESS FOR PASWORD2       S21046 23060002
         ST    R3,DUMMY           STORE ADDRESS IN TEMPORARY     S21046 23080002
         MVC   IEHEMAC1+PSWD2PRM(THREEBYT),DUMMY+ONEBYTE         S21046 23100002
*                                 MOVE PASWORD2 TO PARAM LIST    S21046 23120002
         B     MOVPASWD                 GO MOVE PASWORD2         S21046 23140002
*                                                                S21046 23160002
*      CHECK TO BE SURE CPASWORD IS VALID HERE, IF IT IS A       S21046 23180002
*      DUPLICATE, AND INITIALIZE TO MOVE IT TO THE PROTECT       S21046 23200002
*      PARAMETER LIST.                                           S21046 23220002
*                                                                S21046 23240002
CPASWORD TM    PPARAMSW+ONEBYTE,CPSWDMSK SHOULD CPASWORD BE HERE S21046 23260002
         BZ    XTRAKEY            NO IT IS REDUNDANT             S21046 23280002
         TM    DUPSW+ONEBYTE,CPSWDDUP  HAS CPASWORD BEEN HERE    S21046 23300002
         BO    XTRAKEY            YES IT IS A DUPLICATE          S21046 23320002
         OI    DUPSW+ONEBYTE,CPSWDDUP  INDICATE CPASWORD PRESENT S21046 23340002
         LA    R3,PARAM5          GET ADDRESS FOR CPASWORD       S21046 23360002
         ST    R3,IEHEMAC1+CPSWDPRM    STORE AD IN PARAMETERS    S21046 23380002
         B     MOVPASWD           GO MOVE CPASWORD TO ITS AREA   S21046 23400002
*                                                                S21046 23420002
*      CHECK TO BE SURE TYPE SHOULD BE HERE, CHECK FOR DUPLICATE S21046 23440002
*      SCAN FOR THE NUMERIC TYPE, AND MOVE NUMBER SCANNED        S21046 23460002
*      TO THE PROTECT PARAMETER LIST.                            S21046 23480002
*                                                                S21046 23500002
TYPE     TM    PPARAMSW+ONEBYTE,TYPEMSK SHOULD TYPE BE HERE      S21046 23520002
         BZ    XTRAKEY            NO IT IS REDUNDANT             S21046 23540002
         TM    DUPSW+ONEBYTE,TYPEDUP   HAS TYPE BEEN HERE        S21046 23560002
         BO    XTRAKEY            YES IT IS A DUPLICATE          S21046 23580002
         OI    DUPSW+ONEBYTE,TYPEDUP   INDICATE TYPE PRESENT     S21046 23600002
         MVC   CODELIST(EIGHT),COMBLANK SCAN FOR , OR BLANK      S21046 23620002
         XC    IEHETBL(ONEWORD),IEHETBL NO TABLE LOOKUP WANTED   S21046 23640002
         BALR  RETURN,RB                GO TO SCAN ROUTINE       S21046 23660002
         MVC   CODELIST(EIGHT),SPECIALS RESET CODELIST           S21046 23680002
         CLI   IEHEARGL,ZEROBYTE  CHECK LENGTH OF SCAN           S21046 23700002
         BH    BADSYN             BRANCH IF LENGTH GREATER TWO   S21046 23720002
         L     R3,IEHESTT         LOAD ADDRESS OF TYPE FIELD     S21046 23740002
         TM    ZERODSP(R3),NUMFLD EBCDIC CHARACTER               S21046 23760002
         BNO   BADSYN             BRANCH IF NOT NUMERAL          S21046 23780002
         NI    ZERODSP(R3),DROPZONE    DROP THE ZONE             S21046 23800002
         CLI   ZERODSP(R3),TYPECODE   IS TYPE GREATER THAN 3     S21046 23820002
         BH    BADSYN             IF SO IT IS INVALID            S21046 23840002
         MVC   IEHEMAC1+TYPEPRM(ONEBYTE),ZERODSP(R3)             S21046 23860002
*                                 MOVE TYPE TO PARAMETER LIST    S21046 23880002
         L     R6,IEHEFND         UP THE START                   S21046 23900002
         LA    R6,ONEBYTE(R6)     ADDRESS                        S21046 23920002
         ST    R6,IEHESTT         BY ONE FOR NEXT SCAN AND       S21046 23940002
         B     KODECODE           GO GET ANOTHER KEYWORD         S21046 23960002
*                                                                S21046 23980002
*      CHECK TO BE SURE 'DATA' SHOULD BE HERE, CHECK FOR         S21046 24000002
*      DUPLICATES, PUT ADDRESS OF DATA INTO PROTECT              S21046 24020002
*      PARAMETER LIST, AND GO SCAN FOR BEGINNING AND END         S21046 24040002
*      OF THE CHARACTER STRING.                                  S21046 24060002
*                                                                S21046 24080002
DATA     TM    PPARAMSW+ONEBYTE,DATAMSK SHOULD DATA BE HERE      S21046 24100002
         BZ    XTRAKEY            NO IT IS REDUNDANT             S21046 24120002
         TM    DUPSW+ONEBYTE,DATADUP   HAS DATA BEEN HERE        S21046 24140002
         BO    XTRAKEY            YES IT IS A DUPLICATE          S21046 24160002
         OI    DUPSW+ONEBYTE,DATADUP   INDICATE DATA IS PRESENT  S21046 24180002
         LA    R3,PARAM8          LOAD ADDRESS FOR DATA          S21046 24200002
         ST    R3,IEHEMAC1+DATAPRM     STORE AD IN PARAMETER     S21046 24220002
         MVC   CODELIST(EIGHT),QUOTE   SET CODE LIST FIND QUOTE  S21046 24240002
         MVC   IEHECHAR(HALFWD),AQUOTE SCAN FOR ONLY A QUOTE     S21046 24260002
         XC    IEHETBL(ONEWORD),IEHETBL NO TABLE LOOKUP          S21046 24280002
AGN      BALR  RETURN,RB          GO TO SCAN                     S21046 24300002
         CLI   IEHECODE,QUOTEMSK  WAS A QUOTE FOUND              S21046 24320002
         BNE   BADSYN             NO BRANCH                      S21046 24340002
         L     R6,IEHEFND         SET UP SCAN TO FIND QUOTE      S21046 24360002
         LA    R6,ONEBYTE(R6)     UP THE START ADDRESS FOR SCAN  S21046 24380002
         L     R5,IEHESTT         THE START FOR THE DATA AREA    S21046 24400002
         ST    R6,IEHESTT         STORE NEW START FOR SCAN       S21046 24420002
         TM    IEHESW2,ONEQUOTE   WAS ONE QUOTE FOUND BEFORE     S21046 24440002
         BO    MOVE               YES BRANCH                     S21046 24460002
         OI    IEHESW2,ONEQUOTE   INDICATE ONE QUOTE IS FOUND    S21046 24480002
         B     AGN                GO FIND SECOND QUOTE           S21046 24500002
*                                                                S21046 24520002
*      CHECK DATA CHARACTER STRING LENGTH FOR GREATER THAN       S21046 24540002
*      77 CHARACTERS, IF LEGAL PUT DATA LENGTH INTO PROTECT      S21046 24560002
*      PARAMETER LIST, IF NOT LEGAL INITIALIZE TO PRINT          S21046 24580002
*      ERROR MESSAGE                                             S21046 24600002
*                                                                S21046 24620002
MOVE     IC    R4,IEHEARGL        GET LENGTH OF ARGUMENT         S21046 24640002
         LA    R4,ONEBYTE(R4)     LENGTH IS ONE GREATER          S21046 24660002
         CLI   IEHEARGL,DATALGTH  DATA LENGTH GREATER THAN 77    S21046 24680002
         BH    BADSYN             IF YES, BAD SYNTAX             S21046 24700002
         STC   R4,IEHEMAC1+DATAPRM     STOR DATA LENGTH          S21046 24720002
         LA    R3,PARAM8          LOAD ADDRESS FOR PARAMETER     S21046 24740002
         EX    R4,PROTCTMV        MOVE THE PARAMETER TO AREA     S21046 24760002
         MVC   IEHECHAR(HALFWD),ANYSPEC                          S21046 24780002
*                                 SCAN FOR ANY SPECIAL CHAR      S21046 24800002
         MVC   CODELIST(EIGHT),COMBLANK                          S21046 24820002
*                                 SEARCH FOR COMMA OR BLANK      S21046 24840002
         BALR  RETURN,RB          GO TO SCAN ROUTINE             S21046 24860002
         MVC   CODELIST(EIGHT),SPECIALS                          S21046 24880002
*                                 RESTORE THE CODELIST           S21046 24900002
         L     R6,IEHEFND         UP THE START ADDRESS           S21046 24920002
         LA    R6,ONEBYTE(R6)                                    S21046 24940002
         ST    R6,IEHESTT         STORE THE NEW START ADDRESS    S21046 24960002
         B     KODECODE           GO GET ANOTHE KEYWORD          S21046 24980002
*                                                                S21046 25000002
*      SCAN FOR A PASSWORD, CHECK LENGTH FOR GREATER THAN 8      S21046 25020002
*      CHARACTERS AND MOVE THE PASSWORD TO THE PROTECT           S21046 25040002
*      PARAMETER LIST IF IT IS LEGAL. IF THE PASSWORD IS LONGER  S21046 25060002
*      THAN EIGHT INITIALIZE TO PRINT ERROR MESSAGE              S21046 25080002
*                                                                S21046 25100002
MOVPASWD MVC   CODELIST(EIGHT),COMBLANK                          S21046 25120002
*                                 SEARCH FOR COMMA OR BLANK      S21046 25140002
         XC    IEHETBL(ONEWORD),IEHETBL                          S21046 25160002
*                                 NO TABLE LOOKUP WANTED         S21046 25180002
         BALR  RETURN,RB          GO TO SCAN ROUTINE             S21046 25200002
         MVC   CODELIST(EIGHT),SPECIALS                          S21046 25220002
*                                 RESTORE THE CODELIST           S21046 25240002
         CLI   IEHEARGL,LNGTHCHK  IS LENGTH GREATER THAN 8       S21046 25260002
         BH    BADSYN             GO PRINT MESSAGE               S21046 25280002
         L     R2,IEHEFUN         LOAD FUNCTION TABLE            S21046 25300002
         IC    R5,ONEBYTE(R2)     LOAD PARAMETER WORD NUMBER     S21046 25320002
         SLL   R5,MULTBY4         MULT BY 4 TO GET WORD          S21046 25340002
         L     R3,WARE2PUT(R5)    LOAD ADDRESS TO PUT PAR&M      S21046 25360002
         MVI   ZERODSP(R3),BLANKBYT    BLANK OUT RECIEVE AREA    S21046 25380002
         MVC   ONEBYTE(SEVEN,R3),ZERODSP(R3)                     S21046 25400002
         LM    R4,R5,IEHECHAR     GET LENGTH AND START FOR MVC   S21046 25420002
         EX    R4,PROTCTMV        MOVE THE PARAMETER TO ITS AREA S21046 25440002
         L     R6,IEHEFND         UP THE START ADDRESS           S21046 25460002
         LA    R6,ONEBYTE(R6)                                    S21046 25480002
         ST    R6,IEHESTT         STORE THE NEW START ADDRESS    S21046 25500002
         B     KODECODE           GO GET ANOTHER KEYWORD         S21046 25520002
PROTCTMV MVC   ZERODSP(ONEBYTE,R3),ZERODSP(R5)                   S21046 25540002
*                                 MOVE FOR PROTECT OPERATIONS    S21046 25560002
SYS      TM    PPARAMSW,X'01'      SHOULD 'SYS' BE PRESANT              25580002
         BZ    XTRAKEY              NO---                               25600002
         NI    PPARAMSW,X'EF'      TURN OF DSNAME SW                    25620002
         OI    IEHESW5,X'02'       TURN ON 'SYS' SWITCH                 25640002
         B     KODECODE                                                 25660002
VTOC     TM    PPARAMSW,X'01'      SHOULD  VTOC   BE  PRESENT           25680002
         BZ    XTRAKEY             NO .....BRANCH                       25700002
         NI    PPARAMSW,X'EF'      TURN OFF DSNAME BIT                  25720002
         MVC   FLSTADDR(4),ADVTOCDC                                     25740002
         MVC   PARAM2-1(5),KWSA                                         25760002
         B     STT1UP                                                   25780002
NEWNAME  TM    PPARAMSW,X'08'                                           25800002
         BZ    XTRAKEY                                                  25820002
         OI    IEHEMAC1,X'80'                                           25840002
         OI    PPARAMSW+1,X'01'        TURN ON NAME TEST BIT     A42349 25860002
         B     JUSTMOVE                                                 25880002
ALIAS    TM    PPARAMSW,X'02'      SHOULD ALIAS BE HERE                 25900002
         BZ    XTRAKEY             NO.....BRANCH                        25920002
         B     JUSTMOVE                                                 25940002
PURGE    TM    PPARAMSW,X'04'                                           25960002
         BZ    XTRAKEY                                                  25980002
         OI    IEHEMAC1+2,X'10'                                         26000002
         B     KODECODE                                                 26020002
*                                                                       26040002
*  THIS ROUTINE TESTS TO SEE IF THE VOLUME STATEMENT IS PERMITTED       26060002
*  UNDER THE PRESENT FUNCTION  INSURES THAT IT IA NOT ENCOUNTERED       26080002
*  MORE THAN ONCE. AND SETS UP MATRIX ONE TO CONTROLTHE SCAN OPERATION  26100002
*                                                                       26120002
*                                                                       26140002
VOL      TM    PPARAMSW,X'20'                                           26160002
         BZ    XTRAKEY                 BRANCH IF VOL SHOULD NOT  A25564 26180002
*                                      BE PRESENT                A25564 26200002
         TM    DUPSW,X'10'                                              26220002
         BO    XTRAKEY                 BRANCH IF DUPLICATE ENTRY A25564 26240002
         OI    DUPSW,X'10'                                              26260002
         TM    IEHEMAC1,PRORTNCD  IS THIS PROTECT OPERATION      S21046 26280002
         BC    7,NOTPRO           NO BRANCH                      S21046 26300002
         OI    IEHESW2,MNTVOL     CAUSE VOL TO BE MOUNTED        S21046 26320002
NOTPRO   OI    IEHEMAC1,BLANKBYT  RECORD THE PRESENCE OF VOL     S21046 26340002
         LA    R4,VMATRIX1                                              26360002
         ST    R4,MATRIXIU                                              26380002
         LA    R3,PARAM4+2                                              26400002
         ST    R3,VOLISTAD        SETADDRESS OF THE VOL LIST            26420002
         LA    R8,PARAM6          LOAD ADDRESS OF VOL PARAMETER  S21046 26440002
         ST    R8,IEHEMAC1+VOLPRM STORE ADDRESS IN PARM LIST     S21046 26460002
         ST    R8,PROTCTAD        STORE ADDRESS OF VOL FOR       S21046 26480002
*                                 CURRENT VOL ID STORE           S21046 26500002
         XC    PARAM4(2),PARAM4                                         26520002
         OI    IEHESW1,VOLSW      SET VOL SWITCH ON                     26540002
*                                                                       26560002
*  HERE WE HAVE A SCAN PERFORMED AND DECODE THE RETURNSFROM SCAN        26580002
*  BY REFERANCING THE MATRIX IN USE...THIS WILL BE MATRIX ONE FOR       26600002
*  THE INITIAL ENTRY AND WILL BECOME MATRIX TWO ONLY AFTER A DEVICE     26620002
*  TYPE HAS BEEN FOUND...............................................   26640002
*                                                                       26660002
*                                                                       26680002
VOLSCAN  XC    IEHETBL(4),IEHETBL                                       26700002
         BALR  RETURN,RB          NO TLU AND GO TO SCAN                 26720002
         CLI   IEHECODE,X'02'     CHECK TYPE OF DELIMITER FOUND         26740002
         BL    VLISTERR           BRANCH IF PERIOD OR INVALID           26760002
         SR    R3,R3              ------------------------------------  26780002
         IC    R3,IEHECODE                                              26800002
         CLI   IEHEARGL,X'FF'     THE TYPE OF DELIMITER AND THE LENGTH  26820002
         BE    *+8                OF SCAN IS TRANSLATED TO THE ADDRESS  26840002
         LA    R3,5(R3)           OF A ROUTINE BY CROSS REFERANCE OF    26860002
         L     R4,MATRIXIU        A MATRIX AND AN ADDRESS TEBLE         26880002
         IC    R3,0(R3,R4)                                              26900002
         SLL   R3,2                                                     26920002
         L     R3,VOLDECAD(R3)    SELECT THE ADDRESS NEEDED             26940002
         BR    R3                 --------------GO THERE -------------- 26960002
*                                                                       26980002
*                                                                       27000002
SELECTOR XC    VSRCM+1,VSRCM                                            27020002
         BZ    VOLID                                                    27040002
*                                                                       27060002
DSSEQ    XC    DBLWORD(8),DBLWORD                                       27080002
         CLI   IEHEARGL,X'03'      IS VOL SEQ NUMBER TO LONG       9760 27100002
         BH    BADSYN              IF SO PUT OUT THE MESSAGE       9760 27120002
         L     R5,IEHESTT          GET THE ADDRESS OF THE ARGUMENT 9760 27140002
         SR    R4,R4                 AND THE LENGTH OF THE ARGUMENT9760 27160002
         IC    R4,IEHEARGL             INTO REGISTERS R5 AND R4    9760 27180002
         LA    R3,1(R4)            --SET UP THE                    9760 27200002
         AR    R5,R3                    LOOP CONTROL--             9760 27220002
TESTZONE BCTR  R5,0                THIS LOOP CHECKS EACH           9760 27240002
         TM    0(R5),X'F0'            BYTE OF THE VOL SEQ NUMBER   9760 27260002
         BNO   BADSYN                    FOR A NUMERIC ZONE,       9760 27280002
         BCT   R3,TESTZONE                 THAT IS, AN 'F'         9760 27300002
         LA    R3,1(R4)            IF THE ZONES WERE VALID, SET    9760 27320002
         AR    R5,R3                 UP LOOP CONTROL AGAIN         9760 27340002
TESTNMRC BCTR  R5,0                ---AND TEST FOR VALID DECIMAL   9760 27360002
         CLI   0(R5),X'F9'             DIGITS BY COMPARING BYTES   9760 27380002
         BH    BADSYN                    OF VOL SEQ NUMBER TO AN   9760 27400002
         BCT   R3,TESTNMRC                'F9'.  IF SEQ NO'S.  OK, 9760 27420002
         LA    R3,DBLWORD+7        SET UP POINTER FOR MVC, RIGHT   9760 27440002
         SR    R3,R4                 JUSTIFIED, INTO WORK AREA     9760 27460002
         EX    R4,MVCSEQ          PUT SEQ NO. IN THE DOUBLE WORD        27480002
         PACK  DBLWORD(8),DBLWORD(8)        PACK IT                     27500002
         CVB   R6,DBLWORD         CONVERT IT TO BINARY                  27520002
SEQ2LIST ST    R6,FULLWORD         STORE IT                             27540002
         L     R3,VOLISTAD                                              27560002
         MVC   0(2,R3),FULLWORD+2      PUT IT IN THE VOL LIST           27580002
         LA    R3,2(R3)                                                 27600002
         ST    R3,VOLISTAD        SET POINTER TO NEXT VOL I.D.          27620002
         B     EOVLTEST                                                 27640002
*                                                                       27660002
*                                                                       27680002
VOLID    L     R3,VOLISTAD                                              27700002
         CLI   IEHEARGL,X'05'      IS VOLUME ID TO LONG            9760 27720002
         BH    BADSYN              IF SO, PUT OUT MESSAGE          9760 27740002
         MVC   0(4,R3),VDTIU      PUT DEVICE CODE INTO VOL LIST         27760002
         MVC   4(8,R3),VCBPAD     FORMAT THE ENTRY                      27780002
         LM    R4,R5,IEHECHAR                                           27800002
         EX    R4,MVCVOL          PUT VOLUME I.D. INTO VOL LIST         27820002
         TM    IEHESW2,CVOLBIT    IS THIS A CVOL                 S21046 27840002
         BC    1,NOTVOL           IF SO SKIP NEXT                S21046 27860002
         L     R8,PROTCTAD        LOAD ADDRESS OF VOL ID LIST    S21046 27880002
         MVC   0(6,R8),VCBPAD     MOVE BLANKS TO VOL ID LIST    YA01672 27890002
         EX    R4,PRTCTVOL        MOVE VOL ID TO THIS AREA       S21046 27900002
         LA    R8,SIX(R8)         UPDATE ADDRESS FOR             S21046 27920002
         ST    R8,PROTCTAD        NEXT VOL ID                    S21046 27940002
         IC    R7,IEHEMAC1+VOLPRM UPDATE THE COUNT               S21046 27960002
         LA    R7,ONEBYTE(R7)     OF THE                         S21046 27980002
         STC   R7,IEHEMAC1+VOLPRM NUMBER OF VOL ID'S             S21046 28000002
NOTVOL   EQU   *                  ENTER IF NOT VOL               S21046 28020002
         NI    IEHESW2,CVOLOFF    TURN OFF THE CVOL SWITCH       S21046 28040002
         TM    IEHESW1,VOLSW                                            28060002
        BZ    CVOLTEST                                                  28080002
         LH    R7,PARAM4                                                28100002
         LA    R7,1(R7)           COUNT THE ENTRIES IN THE LIST         28120002
         STH   R7,PARAM4                                                28140002
         CLI   VSRCM,X'00'        DIRECT ACCESS DEVICE?                 28160002
         BE    DATYPE             YES....BRANCH                         28180002
         LA    R3,10(R3)                                                28200002
         ST    R3,VOLISTAD        SET POINTER TO DS SEQ NO.             28220002
         B     EOVLTEST                                                 28240002
CVOLTEST TM   VSRCM,X'01'                                               28260002
        BZ    STT1UP                                                    28280002
        LA    LISTREG,BADCVOL                                           28300002
        B     ENT2FDLD                                                  28320002
DATYPE  MVI   11(R3),X'00'                                              28340002
        LA    R3,12(R3)                                                 28360002
         ST    R3,VOLISTAD        SET POINTER TOO NEXT VOL I.D.         28380002
*                                                                       28400002
EOVLTEST LH    R5,VOLPAREN                                              28420002
         LTR   R5,R5              TEST FOR END OF VOLUME LIST           28440002
         BNE   UPSTART            NOT END...BRANCH                      28460002
         NI    IEHESW1,X'FD'       RESET THE VOL SWITCH                 28480002
        L     R2,IEHEFND                                                28500002
        CLI   1(R2),C','                                                28520002
        BNE   STT1UP                                                    28540002
        LA    R2,2(R2)                                                  28560002
         ST    R2,IEHESTT                                               28580002
        B     KODECODE                                                  28600002
STT1UP   L     R5,IEHEFND                                               28620002
         LA    R5,1(R5)           UP THE START ADDRESS FOR SCAN         28640002
         ST    R5,IEHESTT                                               28660002
         B     KODECODE           GO GET A KEYWORD                      28680002
*                                                                       28700002
VOLDTTLU LM    R2,R3,IEHECHAR                                           28720002
         EX    R2,MVCTYPE          PAD DEVICE TYPE WITH BLANKS          28740002
         LA    R2,MSGOUT+4              POINT AT WORK AREA FOR TLU      28760002
         MVC   20(4,R2),DECB2+4        SET UP RETURN V ADCON       DT0I 28780002
         L     15,TLUADDR               GET ADDRESS OF TLU ROUTINE      28800002
         BALR  14,15                    BE GONE                         28820002
         OC    8(4,R2),8(R2)            TEST FOR A FIND                 28840002
         BZ    BADTYPE                 BAD GENERIC TYPE CODE     A35899 28860002
         MVC   PASSUNIT(5),12(R2)      PASS SPECIFIC UNIT TO       DT0I 28880002
*                                      VOLUME MOUNTING ROUTINE     DT0I 28900002
VOLDTFND MVC   VDTIU(4),8(R2)      SAVE THE DEVICE CODE                 28920002
         LA    R2,VMATRIX2                                              28940002
         ST    R2,MATRIXIU         SWITCH THE CONTROLLING MATRIX        28960002
         MVI   VSRCM,X'01'        SET CONTROL BYTE TO                   28980002
         MVI   VSRCM+1,X'01'      INDICATE A SEQUENTIAL DEVICE          29000002
         TM    VDTIU+2,X'20'      IS IT DIRECT ACCESS                   29020002
         BZ    *+10               NO.....BRANCH                         29040002
         XC    VSRCM(2),VSRCM     SET CONTROL TO DIRECT ACCESS          29060002
         MVC   MSGOUT+1(119),MSGOUT     CLEAR THE PRINT AREA            29080002
UPSTART  L     R2,IEHEFND                   GENERSTE                    29100002
         LA    R2,1(R2)           A NEW START ADDRESS FOR SCAN          29120002
         ST    R2,IEHESTT                   PASS IT                     29140002
         MVC   VDSA(1),IEHECODE                                         29160002
         B     VOLSCAN                                                  29180002
*                                                                       29200002
VRPAREN  LH    R4,VOLPAREN                                              29220002
         BCTR  R4,0               DECREASE PAREN COUNT                  29240002
         STH   R4,VOLPAREN                                              29260002
         LTR   R4,R4                                                    29280002
         BM    VLISTERR           ERROR IF COUNT IS NEGATIVE            29300002
         CLI   IEHEARGL,X'FF'                                           29320002
         BE    VRPARZL            BRANCH IF LENGTH IS ZERO              29340002
         CLI   VDSA,X'04'   WAS THE LAST DELIMITER A (                  29360002
         BE    SELECTOR                                                 29380002
         CLI   VDSA,X'02'         WAS PREVIOUS DELIMITER A ,            29400002
         BNE   VLISTERR           NO.....BRANCH                         29420002
         B     SELECTOR                                                 29440002
VRPARZL  CLI   VDSA,X'05'         WAS PREVIOUS DELIMITER A )            29460002
         BE    EOVLTEST           YES....BRANCH                         29480002
         CLI   VDSA,X'02'         WAS PREVIOUS DELIMITER A COMMA        29500002
         BNE   VLISTERR           NO.....BRANCH                         29520002
         B     SEQNUM1                                                  29540002
VCOMZL   CLI   VDSA,X'05'         WAS PREVIOUS DELIMITER A )            29560002
         BE    UPSTART            YES....BRANCH                         29580002
         CLI   VDSA,X'02'         WAS PREVIOUS DELIMITER A ,            29600002
         BNE   VLISTERR                 NO.....BRANCH                   29620002
SEQNUM1  EX    0,SELECTOR         IS IT A VOLUME ID MISSING             29640002
         BZ    VLISTERR            YES....BRANCH                        29660002
         LA    R6,1                ASSUME A SEQUENCE NO. OF 1           29680002
         B     SEQ2LIST            GO PUT IT INTO THE LIST              29700002
*                                                                       29720002
*                                                                       29740002
AD2PAREN LH    R4,VOLPAREN                                              29760002
         LA    R4,1(R4)           ADD ONE TO PAREN COUNT                29780002
         STH   R4,VOLPAREN                                              29800002
         B     UPSTART                                                  29820002
*                                                                       29840002
*                                                                       29860002
VLISTERR LA    PARAMREG,10                                              29880002
         L     LINKREG,SEVER8          GO TO CONDITION CODE      A25564 29900002
         BALR  RETURN,LINKREG          HANDLER                   A25564 29920002
         B     GOAGAIN                                                  29940002
GETAVOL  BAL   R8,*+4                                                   29960002
         TM    IEHESW5,X'01'       TEST SW5 FOR PREVIOUS                29980002
         BCR   1,R8                ENTRY TO THIS ROUTINE                30000002
         OI    IEHESW5,X'01'       TO PREVENT MULTIPLE OVERLAYS         30020002
         L     LINKREG,MOUNTRTN    GO GET REQUIRED                      30040002
         BALR  RETURN,LINKREG      VOLUMES MOUNTED                      30060002
BADTYPE  EQU   *                       ENTER FOR BAD GENERIC TYPEA35899 30080002
         L     LINKREG,SEVER8          GO TO CONDITION CODE      A25564 30100002
         BALR  RETURN,LINKREG          HANDLER                   A25564 30120002
         CNOP  0,4                                                      30140002
         BAL   LISTREG,ENT2FDLD                                         30160002
         DC    FL1'6'                                                   30180002
         DC    FL3'37'             INFORM THE USER                      30200002
         DC    FL1'6'              THAT THE REQUIRED                    30220002
         DC    FL1'1'              VOLUMES COULD NOT                    30240002
         DC    FL2'50'             BE MOUNTED                           30260002
         DC    FL1'4'                                                   30280002
         DC    AL3(ABEOJ+4)        EXIT                                 30300002
         DS    0F                                                       30320002
VOLDECAD EQU   *-4                                                      30340002
         DC    A(VLISTERR)                                              30360002
         DC    A(VOLDTTLU)                                              30380002
         DC    A(AD2PAREN)                                              30400002
         DC    A(VRPAREN)                                               30420002
         DC    A(SELECTOR)                                              30440002
         DC    A(VCOMZL)                                                30460002
MVCVOL   MVC   4(1,R3),0(R5)                                            30480002
PRTCTVOL MVC   ZERODSP(ONEBYTE,R8),ZERODSP(R5)                   S21046 30500002
*                                 MOVE FOR PROTECT VOL ID        S21046 30520002
MVCSEQ   MVC   0(1,R3),0(R5)                                            30540002
MVCTYPE  MVC   MSGOUT+4(1),0(R3)        PUT NAME IN WORK AREA           30560002
VCBPAD   DC    CL6' '                                                   30580002
        DC    FL2'1'                                                    30600002
VMATRIX1 EQU   *-2                                                      30620002
         DC    X'01010301010102010101'                                  30640002
VMATRIX2 EQU   *-2                                                      30660002
         DC    X'06010304010502010405'                                  30680002
COMBLANK DC    CL8' ,      '                                            30700002
QUOTE    DC    X'7D40404040404040'      CODELIST FOR QUOTE       S21046 30720002
AQUOTE   DC    XL2'7D80'          SCAN FOR ONLY A QUOTE          S21046 30740002
SLASHAST DC    CL2'/*'                  '...SLASH ASTERICK...'          30760002
BLDXBITS DC    XL4'04400000'                                            30780002
BLANKEQU DC    XL2'4080'                                                30800002
NOTBLANK DC    XL2'4070'                                                30820002
ANYSPEC  DC    XL2'7FD0'                                                30840002
ENDSWOFF EQU   127                                                      30860002
         DS    0F                                                       30880002
TABLEADS EQU   *-8                                                      30900002
         DC    A(TABLEN3)          ADDRESSES OF TABLES USED             30920002
         DC    A(TABLEN4)          BY THE TLU ROUTINE                   30940002
         DC    A(TABLEN5)                                               30960002
         DC    A(TABLEN6)                                               30980002
         DC    A(TABLEN7)                                               31000002
         DC    A(TABLEN8)                                               31020002
         DC    A(TABLEN9)                                               31040002
TLUADDR  DC    V(IEHPROGA)        ADDRESS OF TLU ROUTINE          M2838 31060002
DLTASWAP MVC   PARAM2-1(45),PARAM4-1   CORRECT POSITION OF ALIAS NAME   31080002
IEHPROGB CSECT                                                    M2838 31100002
TABLEN1  DS    0F                  THIS TABLE FOR TESTING ONLY          31120002
TABLEN2  DS    0F                                                       31140002
TABLEN3  DC    X'0309'            THREE ENTRIES IN TABLE         S21046 31160002
         DC    C'ADD'             ADD OPERATION                  S21046 31180002
         DC    X'0300'            INDICATES OPERATION            S21046 31200002
         DC    AL4(ADD)           ADDRESS OF ADD CODE            S21046 31220002
         DC    C'VOL'                                                   31240002
         DC    X'0104'                                                  31260002
         DC    AL4(VOL)                                                 31280002
         DC    C'SYS'                                                   31300002
         DC    X'0200'                                                  31320002
         DC    AL4(SYS)                                                 31340002
TABLEN4  DC    X'0A0A'            TEN ENTRIES IN TABLE         @Z40CSJH 31360004
         DC    C'LIST'            SEARCH ARGUMENT FOR LIST       S21046 31380002
         DC    X'0300'            INDICATES OPERATION            S21046 31400002
         DC    AL4(LIST)          ADDRESS OF THE LIST CODE       S21046 31420002
         DC    C'TYPE'            SEARCH ARGUMENT FOR TYPE       S21046 31440002
         DC    X'0100'            INDICATES OPERAND              S21046 31460002
         DC    AL4(TYPE)          ADDRESS OF TYPE CODE           S21046 31480002
         DC    C'DATA'            SEARCH ARGUMENT FOR DATA       S21046 31500002
         DC    X'0100'            INDICATES OPERAND              S21046 31520002
         DC    AL4(DATA)          ADDRESS OF DATA CODE           S21046 31540002
         DC    C'BLDG'                                         @Z40CSJH 31560004
         DC    X'0300'                                         @Z40CSJH 31580004
         DC    AL4(BLDG)                                       @Z40CSJH 31600004
         DC    C'CVOL'                                                  31620002
         DC    X'0103'                                                  31640002
         DC    AL4(CVOL)                                                31660002
         DC    C'VTOC'                                                  31680002
         DC    X'0202'                                                  31700002
         DC    AL4(VTOC)                                                31720002
         DC    C'BLDX'                                         @Z40CSJH 31740004
         DC    X'0300'                                         @Z40CSJH 31760004
         DC    AL4(BUILDX)                                     @Z40CSJH 31780004
         DC    C'DLTX'                                         @Z40CSJH 31800004
         DC    X'0300'                                         @Z40CSJH 31820004
         DC    AL4(DELETEX)                                    @Z40CSJH 31840004
         DC    C'BLDA'                                         @Z40CSJH 31860004
         DC    X'0300'                                         @Z40CSJH 31880004
         DC    AL4(BUILDA)                                     @Z40CSJH 31900004
         DC    C'DLTA'                                         @Z40CSJH 31920004
         DC    X'0300'                                         @Z40CSJH 31940004
         DC    AL4(DELETEA)                                    @Z40CSJH 31960004
TABLEN5  DC    X'050B'             FIVE ENTRIES IN TABLE       @Z40CSJH 31980004
         DC    C'EMPTY'                                        @Z40CSJH 32000004
         DC    X'0200'                                         @Z40CSJH 32020004
         DC    AL4(EMPTY)                                      @Z40CSJH 32040004
         DC    C'CATLG'                                         YL026VC 32060002
         DC    X'0300'                                          YL026VC 32080002
         DC    AL4(CATALOG)                                     YL026VC 32100002
         DC    C'INDEX'                                        @Z40CSJH 32120004
         DC    X'0102'                                         @Z40CSJH 32140004
         DC    AL4(INDEX)                                      @Z40CSJH 32160004
         DC    C'ALIAS'                                        @Z40CSJH 32180004
         DC    X'0104'                                         @Z40CSJH 32200004
         DC    AL4(ALIAS)                                      @Z40CSJH 32220004
         DC    C'PURGE'                                                 32240002
         DC    X'0200'                                                  32260002
         DC    AL4(PURGE)                                               32280002
TABLEN6  DC    X'040C'            FOUR  ENTRIES IN TABLE       @Z40CSJH 32310004
         DC    C'MEMBER'                                                32320002
         DC    X'0105'                                                  32340002
         DC    AL4(MEMBER)                                              32360002
         DC    C'DSNAME'                                                32380002
         DC    X'0102'                                                  32400002
         DC    AL4(DSNAME)                                              32420002
         DC    C'DELETE'                                       @Z40CSJH 32440004
         DC    X'0200'                                         @Z40CSJH 32460004
         DC    AL4(DELETE)                                     @Z40CSJH 32480004
         DC    C'RENAME'                                                32500002
         DC    X'0300'                                                  32520002
         DC    AL4(RENAME)                                              32540002
TABLEN7  DC    X'080D'            EIGHT ENTRIES IN TABLE       @Z40CSJH 32560004
         DC    C'REPLACE'         SEARCH ARGUMENT FOR REPLACE    S21046 32580002
         DC    X'0300'            INDICATES OPERATION            S21046 32600002
         DC    AL4(REPLACE)       ADDRESS OF REPLACE CODE        S21046 32620002
         DC    C'DELETEP'         SEARCH ARGUMENT FOR DELETEP    S21046 32640002
         DC    X'0300'            INDICATES OPERATION            S21046 32660002
         DC    AL4(DELETEP)       ADDRESS OF DELETEP CODE        S21046 32680002
         DC    C'ENTRIES'                                      @Z40CSJH 32700004
         DC    X'0104'                                         @Z40CSJH 32720004
         DC    AL4(ENTRIES)                                    @Z40CSJH 32740004
         DC    C'UNCATLG'                                       YL026VC 32760002
         DC    X'0300'                                          YL026VC 32780002
         DC    AL4(UNCATLG)                                     YL026VC 32800002
         DC    C'CONNECT'                                      @Z40CSJH 32820004
         DC    X'0300'                                         @Z40CSJH 32840004
         DC    AL4(CONNECT)                                    @Z40CSJH 32860004
         DC    C'RELEASE'                                      @Z40CSJH 32880004
         DC    X'0300'                                         @Z40CSJH 32900004
         DC    AL4(RELEASE)                                    @Z40CSJH 32920004
         DC    C'SCRATCH'                                               32940002
         DC    X'0300'                                                  32960002
         DC    AL4(SCRATCH)                                             32980002
         DC    C'NEWNAME'                                               33000002
         DC    X'0103'                                                  33020002
         DC    AL4(NEWNAME)                                             33040002
TABLEN8  DC    X'030E'            THREE ENTRIES                  S21046 33060002
         DC    C'PASWORD1'        SEARCH ARGUMENT FOR PASWORD1   S21046 33080002
         DC    X'0103'            INDICATES OPERAND              S21046 33100002
         DC    AL4(PASWORD1)      ADDRESS OF PASWORD1 CODE       S21046 33120002
         DC    C'PASWORD2'        SEARCH ARGUMENT FOR PASWORD2   S21046 33140002
         DC    X'0106'            INDICATES OPERAND              S21046 33160002
         DC    AL4(PASWORD2)      ADDRESS OF PASWORD2 CODE       S21046 33180002
         DC    C'CPASWORD'        SEARCH ARGUMENT FOR CPASWORD   S21046 33200002
         DC    X'0104'            INDICATES OPERAND              S21046 33220002
         DC    AL4(CPASWORD)      ADDRESS OF CPASWORD CODE       S21046 33240002
TABLEN9  EQU   TABLEN1                                                  33260002
CATALOG DS    0F                                                        33280002
        DC    FL2'256'           LIST INITIALIZE                        33300002
         DC    BL2'0111000000000001'   CVOL,VOL,DSNAME,ALPHABET  A28552 33320002
        DC    BL4'00100100000000000000000000000000'      CATALOG        33340002
*                                                                       33360002
*             THIS IS FOR TEST BEFORE WE CALL THE MACRO                 33380002
*                                                                       33400002
        DC    FL1'2'             TEST DUP SWITCH FOR                    33420002
         DC    FL1'0'                                                   33440002
        DC    BL1'01010000'      DSNAME - VOLUME LIST                   33460002
         DC    FL1'12'            BRANCH CONDITION ZERO OR ONE          33480002
         DC    FL1'4'                                                   33500002
         DC    AL3(BADCAT)                                              33520002
         DC    X'08000000'        READ ALL CONTINUE CARDS               33540002
         DC    FL1'10'                                                  33560002
         DC    FL3'1'                                                   33580002
*                                                                       33600002
*                        -----UNCATALOG-----                            33620002
*                                                                       33640002
UNCATLG  DS    0F                                                       33660002
         DC    FL1'1'                                                   33680002
         DC    FL1'0'                                                   33700002
         DC    BL2'0101000000000000'    ALLOW DSNAME AND CVOL           33720002
         DC    BL4'00001100000000000000000000000000'                    33740002
         DC    FL1'2'                                                   33760002
         DC    FL1'0'                                                   33780002
         DC    BL1'01000000'                                            33800002
         DC    FL1'8'                                                   33820002
         DC    FL1'4'                                                   33840002
         DC    AL3(BADCAT)                                              33860002
         DC    X'08000000'        READ ALL CONTINUE CARDS               33880002
         DC    FL1'10'                                                  33900002
         DC    FL3'2'                                                   33920002
IEHPROGC CSECT                                                    M2838 33940002
*                                                                       33960002
*                           -----DELETE INDEX-----                      33980002
*                                                                       34000002
DELETEX  DS    0F                                                       34020002
         DC    FL1'1'                                                   34040002
         DC    FL1'0'                                                   34060002
         DC    BL2'1100000000000000'                                    34080002
         DC    BL4'00000100000001000000000000000000'                    34100002
         DC    FL1'2'              TEST DUP SWITCH                      34120002
         DC    FL1'0'                                                   34140002
         DC    BL1'01000000'       FOR INDEX                            34160002
         DC    FL1'8'                                                   34180002
         DC    FL1'4'                                                   34200002
         DC    AL3(BADINDX)        EXIT IF INDEX NOT SUPPLIED           34220002
         DC    X'08000000'        READ ALL CONTINUE CARDS               34240002
         DC    FL1'10'                                                  34260002
         DC    FL3'3'                                                   34280002
*                                                                       34300002
*                            -----CONNECT -----                         34320002
*                                                                       34340002
CONNECT  DS    0F                                                       34360002
         DC    FL1'1'                                                   34380002
         DC    FL1'0'                                                   34400002
         DC    BL2'1110000000000000'                                    34420002
         DC    BL4'00000100000010000000000000000000'                    34440002
         DC    FL1'2'                                                   34460002
         DC    FL1'0'                                                   34480002
         DC    BL1'01010000'                                            34500002
         DC    FL1'12'                                                  34520002
         DC    FL1'4'                                                   34540002
         DC    AL3(BADINDX)                                             34560002
         DC    X'08000000'        READ ALL CONTINUE CARDS               34580002
         DC    FL1'10'                                                  34600002
         DC    FL3'4'                                                   34620002
*                                                                       34640002
*                            ------ RELEASE ------                      34660002
*                                                                       34680002
RELEASE  DS    0F                                                       34700002
         DC    FL1'1'                                                   34720002
         DC    FL1'0'                                                   34740002
         DC    BL2'1100000000000000'                                    34760002
         DC    BL4'00000100000000001000000000000000'                    34780002
         DC    FL1'2'                                                   34800002
         DC    FL1'0'                                                   34820002
         DC    BL1'01000000'            TEST FOR INDEX                  34840002
         DC    FL1'12'                                                  34860002
         DC    FL1'4'                                                   34880002
         DC    AL3(BADINDX)                                             34900002
         DC    X'08000000'        READ ALL CONTINUE CARDS               34920002
         DC    FL1'10'                                                  34940002
         DC    FL3'5'                                                   34960002
*                                                                       34980002
*                                 ----- BUILD ALIAS -----               35000002
*                                                                       35020002
BUILDA   DS    0F                                                       35040002
         DC    FL1'1'                                                   35060002
         DC    FL1'0'                                                   35080002
         DC    BL2'1100001000000001'   INDEX,CVOL,ALIAS,ALPHABET A28552 35100002
         DC    BL4'01000100000100000000000000000000'                    35120002
         DC    FL1'2'                                                   35140002
         DC    FL1'0'                                                   35160002
         DC    BL1'01010000'                                            35180002
         DC    FL1'12'                                                  35200002
         DC    FL1'4'                                                   35220002
         DC    AL3(BADINDX)                                             35240002
         DC    X'08000000'        READ ALL CONTINUE CARDS               35260002
         DC    FL1'10'                                                  35280002
         DC    FL3'6'                                                   35300002
*                                                                       35320002
*                                 ----- DELETE ALIAS -----              35340002
*                                                                       35360002
DELETEA  DS    0F                                                       35380002
         DC    FL1'1'                                                   35400002
         DC    FL1'0'                                                   35420002
         DC    BL2'0100001000000000'                                    35440002
         DC    BL4'00000100000000010000000000000000'                    35460002
         DC    FL1'7'                                                   35480002
         DC    AL3(DLTASWAP)                                            35500002
         DC    FL1'2'                                                   35520002
         DC    FL1'0'                                                   35540002
         DC    BL1'00010000'                                            35560002
         DC    FL1'8'                                                   35580002
         DC    FL1'4'                                                   35600002
         DC    AL3(BADINDX)                                             35620002
         DC    X'08000000'        READ ALL CONTINUE CARDS               35640002
         DC    FL1'10'                                                  35660002
         DC    FL3'7'                                                   35680002
*                                                                       35700002
*                            ----- SCRATCH -----                        35720002
*                                                                       35740002
SCRATCH  DS    0F                                                       35760002
         DC    FL2'256'            ONE OP                               35780002
         DC    BL2'0011010100000000'    DSNAME VTOC VOL PURGE           35800002
         DC    BL4'00000001000000000100000000000000'        SET SCRATCH 35820002
         DC    FL1'2'                                                   35840002
         DC    FL1'0'                                                   35860002
         DC    BL1'01010000'       TEST 4  DSNAME & VOLUME              35880002
         DC    FL1'12'                                                  35900002
         DC    FL1'4'                                                   35920002
         DC    AL3(BADSCR)                                              35940002
         DC    X'08000000'        READ ALL CONTINUE CARDS               35960002
         DC    FL1'10'                                                  35980002
         DC    FL3'8'                                                   36000002
*                                                                       36020002
*                            ----- BUILDX -----                         36040002
*                                                                       36060002
BUILDX   DS    0F                                                       36080002
         DC    FL2'256'            OP CODE 1                            36100002
         DC    BL2'1100000000000001'   INDEX,CVOL,CHECK ALPHA    A28552 36120002
         DC    BL4'00000100010000000000000000000000'   SET BUILDX       36140002
         DC    FL1'2'              TEST DUP SWITCH                      36160002
         DC    FL1'0'                                                   36180002
         DC    BL1'01000000'       FOR INDEX                            36200002
         DC    FL1'8'                                                   36220002
         DC    FL1'4'                                                   36240002
         DC    AL3(BADINDX)                                             36260002
         DC    X'08000000'        READ ALL CONTINUE CARDS               36280002
         DC    FL1'10'                                                  36300002
         DC    FL3'9'                                                   36320002
*                                                                       36340002
*                            ----- RENAME -----                         36360002
*                                                                       36380002
RENAME   DS    0F                                                       36400002
         DC    FL1'1'                                                   36420002
         DC    FL1'0'                                                   36440002
         DC    BL2'0011100000000000'   DSNAME, NEWNAME, VOL      A42349 36460002
         DC    BL4'00000001000000000010000000000000'       RENAME       36480002
         DC    FL1'2'                                                   36500002
         DC    FL1'0'                                                   36520002
         DC    BL1'01110000'                                            36540002
         DC    FL1'12'                                                  36560002
         DC    FL1'4'                                                   36580002
         DC    AL3(BADRENAM)                                            36600002
         DC    X'08000000'        READ ALL CONTINUE CARDS               36620002
         DC    FL1'10'                                                  36640002
         DC    FL3'10'                                                  36660002
*                                                                S21046 36680002
*        ---- ADD ----                                           S21046 36700002
*                                                                S21046 36720002
ADD      DS    0F                                                S21046 36740002
         DC    FL1'12'            INITIALIZE PARAMETER LIST      S21046 36760002
         DC    FL3'0'             FILLER                         S21046 36780002
         DC    FL2'256'           SET PPARAMSW AND IEHEMAC1      S21046 36800002
*   ALLOW TYPE, DATA, VOL, DSNAME, PASWORD2, CPASWORD            S21046 36820002
         DC    BL2'0011000001011101'                             S21046 36840002
         DC    BL4'00000000000000000000000000000000' IEHEMAC1    S21046 36860002
         DC    FL1'13'            PUT DSNAME LENGTH IN PARM      S21046 36880002
         DC    FL3'0'             FILLER                         S21046 36900002
         DC    FL1'2'             TEST FOR DUPLICATE PARMS       S21046 36920002
         DC    FL1'0'             FILLER                         S21046 36940002
         DC    BL1'01000000'      MASK FIELD                     S21046 36960002
         DC    FL1'12'            SET CONDITION CODE             S21046 36980002
         DC    FL1'4'             FOR BAD ADD OPERATION          S21046 37000002
         DC    AL3(BADADD)        ADDRESS OF ERROR ROUTINE       S21046 37020002
         DC    X'08000000'        READ ALL CONTINUE CARDS        S21046 37040002
         DC    FL1'10'            BRANCH TO CALL PROPER ROUTINE  S21046 37060002
         DC    FL3'14'            TABLE NUMBER 14                S21046 37080002
*                                                                S21046 37100002
*        ---- DELETEP ----                                       S21046 37120002
*                                                                S21046 37140002
DELETEP  DS    0F                                                S21046 37160002
         DC    FL1'12'            INITIALIZE PARAMETER LIST      S21046 37180002
         DC    FL3'0'             FILLER                         S21046 37200002
         DC    FL2'256'           SET PPARAMSW AND IEHEM&C       S21046 37220002
*  ALLOW PASWORD1, CPASWORD, VOL AND DSNAME                      S21046 37240002
         DC    BL2'0011000000100100'   PPARAMSW                  S21046 37260002
         DC    BL4'00000000000000000000000000000000' IEHEMAC1    S21046 37280002
         DC    FL1'13'            PUT DSNAME LENGTH IN PARM      S21046 37300002
         DC    FL3'0'             FILLER                         S21046 37320002
         DC    FL1'2'             TEST FOR DUPLICATE PARMS       S21046 37340002
         DC    FL1'0'             FILLER                         S21046 37360002
         DC    BL1'01000000'      MASK FIELD                     S21046 37380002
         DC    FL1'12'            SET CONDITION CODE             S21046 37400002
         DC    FL1'4'             FOR BAD DELETEP OPERATION      S21046 37420002
         DC    AL3(BADDEL)        BAD DELETEP OPERATION          S21046 37440002
         DC    X'08000000'        READ ALL CONTINUE CARDS        S21046 37460002
         DC    FL1'10'            BRANCH TO CALL PROPER ROUTINE  S21046 37480002
         DC    FL3'15'            TABLE NUMBER 15                S21046 37500002
*                                                                S21046 37520002
*        ---- REPLACE ----                                       S21046 37540002
*                                                                S21046 37560002
REPLACE  DS    0F                                                S21046 37580002
         DC    FL1'12'            INITIALIZE PARAMETER LIST      S21046 37600002
         DC    FL3'0'             FILLER                         S21046 37620002
         DC    FL2'256'           SET PPARAMSW AND IEHEM&C       S21046 37640002
*   ALLOW TYPE, DATA, VOL, DSNAME, PASWORD2, CPASWORD, AND PASWO S21046 37660002
*   AND DSNAME                                                   S21046 37680002
         DC    BL2'0011000001111101'                             S21046 37700002
         DC    BL4'00000000000000000000000000000000' IEHEMAC1    S21046 37720002
         DC    FL1'13'            PUT DSNAME LENGTH IN PARM      S21046 37740002
         DC    FL3'0'             FILLER                         S21046 37760002
         DC    FL1'2'             TEST FOR DUPLICATE PARMS       S21046 37780002
         DC    FL1'0'             FILLER                         S21046 37800002
         DC    BL1'01000000'      MASK FIELD                     S21046 37820002
         DC    FL1'12'            SET THE CONDITION CODE         S21046 37840002
         DC    FL1'4'             CODE WILL BE FOUR              S21046 37860002
         DC    AL3(BADREP)        BAD REPLACE OPERATION          S21046 37880002
         DC    X'08000000'        READ ALL CONTINUE CARDS        S21046 37900002
         DC    FL1'10'            BRANCH TO CALL PROPER ROUTINE  S21046 37920002
         DC    FL3'16'            TABLE NUMBER 16                S21046 37940002
*                                                                S21046 37960002
*        ---- LIST ----                                          S21046 37980002
*                                                                S21046 38000002
LIST     DS    0F                                                S21046 38020002
         DC    FL1'12'            INITIALIZE PARAMETER LIST      S21046 38040002
         DC    FL3'0'             FILLER                         S21046 38060002
         DC    FL2'256'           SET PPARAMSW AND IEHEM&C       S21046 38080002
*  ALLOW  PASWORD1, DSNAME                                       S21046 38100002
         DC    BL2'0001000000100000'   PPARAMSW                  S21046 38120002
         DC    BL4'00000000000000000000000000000000' IEHEMAC1    S21046 38140002
         DC    FL1'13'            PUT DSNAME LENGTH IN PARM      S21046 38160002
         DC    FL3'0'             FILLER                         S21046 38180002
         DC    FL1'2'             TEST FOR DUPLICATE PARMS       S21046 38200002
         DC    FL1'0'             FILLER                         S21046 38220002
         DC    BL1'01000000'      MASK FIELD                     S21046 38240002
         DC    FL1'12'            GO SET THE CONDITION CODE      S21046 38260002
         DC    FL1'4'             CODE WILL BE FOUR FOR A        S21046 38280002
         DC    AL3(BADLIST)       BAD LIST OPERATION             S21046 38300002
         DC    X'08000000'        READ ALL CONTINUE CARDS        S21046 38320002
         DC    FL1'10'            BRANCH TO CALL PROPER ROUTINE  S21046 38340002
         DC    FL3'17'            TABLE NUMBER 17                S21046 38360002
*                                                                       38380002
IEHPROG6 CSECT                                                    M2838 38400002
XTRADATA DS    0F                                                       38420002
         DC    X'0B000000'             SET CONDITION CODE AND    A25564 38440002
*                                      READ ALL CONTINUE CARDS   A25564 38460002
         DC    FL1'6'             WRITE REDUNDANT INFO MSG              38480002
         DC    FL3'14'                                                  38500002
         DC    FL1'4'                                                   38520002
         DC    AL3(ABEOJ)                                               38540002
*                                                                       38560002
TRTTABLE EQU   *                                                 A24020 38580002
         DC    64X'04'                                           A24020 38600002
BLANKS   DC      X'08'                                           A24020 38620002
         DC    15X'04'                                           A24020 38640002
ANDSIGN  DC      X'00'                                           A24020 38660002
         DC    10X'04'                                           A24020 38680002
DOLLAR   DC      X'00'                                           A24020 38700002
         DC     4X'04'                                           A24020 38720002
DASH     DC      X'00'                                           A24020 38740002
         DC    26X'04'                                           A24020 38760002
LBSIGN   DC      X'00'                                           A24020 38780002
ATSIGN   DC      X'00'                                           A24020 38800002
         DC    67X'04'                                                  38820002
TWLVZERO DC      X'00'                                                  38840002
ALPHA1   DC     9X'00'                                           A24020 38860002
         DC     7X'04'                                           A24020 38880002
ALPHA2   DC     9X'00'                                           A24020 38900002
         DC     8X'04'                                           A24020 38920002
ALPHA3   DC     8X'00'                                           A24020 38940002
         DC     6X'04'                                           A24020 38960002
NUMBERS  DC    10X'00'                                           A24020 38980002
         DC     6X'04'                                           A24020 39000002
VOLTEST  TM    IEHEMAC1,X'40'     TEST IF VOL PARM IS PRESENT           39020002
         BO    FDLD               YES, GO GET NEXT PARM                 39040002
         BAL   LISTREG,ENT2FDLD                                         39060002
BADINDX  DS    0F                                                       39080002
BADCAT   DS    0F                                                       39100002
BADSCR   DS    0F                                                       39120002
BADRENAM DS    0F                                                       39140002
BADADD   DS    0F                 BAD ADD TABLE                  S21046 39160002
BADDEL   DS    0F                 BAD DELETE TABLE               S21046 39180002
BADREP   DS    0F                 BAD REPLACE TABLE              S21046 39200002
BADLIST  DS    0F                 BAD LIST TABLE                 S21046 39220002
         DC    X'0B000000'             SET CONDITION CODE AND    A25564 39240002
*                                      READ ALL CONTINUE CARDS   A25564 39260002
         DC    FL1'6'                                                   39280002
         DC    FL1'1'                                                   39300002
         DC    FL2'14'                                                  39320002
         DC    FL1'6'                                                   39340002
         DC    FL2'45'                                                  39360002
         DC    FL1'15'                                                  39380002
ABEOJ    DC    FL1'6'                                                   39400002
         DC    FL1'1'                                                   39420002
         DC    FL2'16'                                                  39440002
         DC    FL1'6'                                                   39460002
         DC    FL1'2'                                                   39480002
         DC    FL2'17'                                                  39500002
         DC    X'09000000'                                              39520002
BADCVOL  EQU   *                                                 A25564 39540002
         DC    X'0B000000'             SET CONDITION CODE AND    A25564 39560002
*                                      READ ALL CONTINUE CARDS   A25564 39580002
        DC    FL1'6'                                                    39600002
        DC    FL2'0'                                                    39620002
        DC    FL1'19'                                                   39640002
        DC    FL1'4'                                                    39660002
        DC    AL3(ABEOJ)                                                39680002
         DS    0F                                                       39700002
OKEND    BAL   LISTREG,ENT2FDLD                                         39720002
NORMEND  EQU   *                                                        39740002
         DC    FL1'6'              SELECT A MESSAGE                     39760002
         DC    FL1'1'              SUPPRESS PRINT                       39780002
         DC    FL2'9'              MSG NUM   = 9                        39800002
         DC    FL1'6'                                                   39820002
         DC    FL2'33'             INSERT FUNCTION NAME                 39840002
         DC    FL1'5'              AND WRITE THE MSG                    39860002
         DC    X'09000000'                                              39880002
         DS    0F                                                       39900002
NOVOL    BAL   LISTREG,ENT2FDLD                                         39920002
VOLREM   EQU   *                                                        39940002
         DC    X'0B000000'             SET CONDITION CODE AND    A25564 39960002
*                                      READ ALL CONTINUE CARDS   A25564 39980002
         DC    FL1'6'                                                   40000002
         DC    FL1'1'              SELECT AND SUPPRESS                  40020002
         DC    FL2'11'             MESSAGE 11                           40040002
         DC    FL1'6'                                                   40060002
         DC    FL2'54'             ADD MSG 17 AND WRITE                 40080002
         DC    FL1'17'                                                  40100002
         DC    X'09000000'                                              40120002
*                                                                       40140002
*        FOR THE HANDLING OF UNKNOWN ERRORS......                       40160002
*                                                                       40180002
         DS    0F                                                       40200002
UNKERR   BAL   LISTREG,ENT2FDLD                                         40220002
OVERSIZE EQU   *                                                        40240002
         DC    X'0B000000'             SET CONDITION CODE AND    A25564 40260002
*                                      READ ALL CONTINUE CARDS   A25564 40280002
         DC    FL1'6'                                                   40300002
         DC    FL3'12'            INFORM THE USER OF AN ERROR           40320002
         DC    FL1'6'             AND THE UNDEFINED CODE                40340002
         DC    FL1'1'                                                   40360002
         DC    FL2'4'                                                   40380002
         DC    FL1'4'                                                   40400002
         DC    AL3(ABEOJ+4)                                             40420002
IEHPROGE EQU   *                                                  M2838 40440002
         BALR  R2,0                                                     40460002
         USING *,R2                                                     40480002
         DROP  RB2                DON'T WANT RB2 USED AS BASE    S21046 40500002
*                                 REG ON THE LOAD OF SCANBASE    S21046 40520002
         L     RB,SCANBASE             RESET THE BASE REGISTER          40540002
         LA    RB2,OFFSET1K(RB)   SET UP BASE REGISTER           S21046 40560002
         DROP  R2                                                       40580002
         USING IEHESCAN+KPLUS2,RB2 SET UP ADDRESSABILITY         S21046 40600002
         LA    R2,UTOUTDCB        TEST FOR THE DCB THAT                 40620002
         CR    1,R2               CAUSED THIS ENTRY                     40640002
         BL    SYNAD002           SYNAD FROM SYSIN                      40660002
         BE    SYNAD003           SYNAD FROM SYSPRINT                   40680002
         BH    SYNAD004           SYNAD FROM THE VTOC                   40700002
SYNAD002 EQU   *                                                 A25564 40720002
         L     LINKREG,SEVER12         GO TO CONDITION CODE      A25564 40740002
         BALR  RETURN,LINKREG          HANDLER                   A25564 40760002
         LA    PARAMREG,53        WRITE SYSIN ERROR MSG                 40780002
         B     EOJ                                                      40800002
SYNAD003 EQU   *                                                 A25564 40820002
         L     LINKREG,SEVER12         GO TO CONDITION CODE      A25564 40840002
         BALR  RETURN,LINKREG          HANDLER                   A25564 40860002
         LA    PARAMREG,51        WTO SYSPRINT ERROR MSG                40880002
         B     EOJ                                                      40900002
SYNAD004 CLOSE ((R2))             CLOSE THE VTOC                        40920002
         ORG   *-18                                                     40940002
         LR    R2,1               R2 POINT AT THE DCB                   40960002
         LA    1,DBLWORD          REG 1 POINT AT A WORD                 40980002
         NOPR  0                                                        41000002
         ORG                                                            41020002
         NI    CTRLWORD,X'EF'     RESET OPEN VTOC SWITCH                41040002
         L     LINKREG,SEVER12         GO TO CONDITION CODE      A25564 41060002
         BALR  RETURN,LINKREG          HANDLER                   A25564 41080002
         LA    PARAMREG,54        WRITE SYNAD ON VTOC            A25564 41100002
         B     GOAGAIN            GET THE NEXT REQUEST           A25564 41120002
*THE FOLLOWING CODE DEALS WITH ERROR CONDITION CODES.  THE CODE  A25564 41140002
*INSURES THAT A HIGHER CONDITION CODE WILL NOT BE OVERRIDDEN BY  A25564 41160002
* LOWER CONDITION CODE.                                          A25564 41180002
CODEOF4  EQU   *                                                 A25564 41200002
         CLI   ERRFLD+2,X'04'          PRESENT CONDITION CODE    A25564 41220002
*                                      HIGHER THAN OR EQUAL TO 4 A25564 41240002
         BC    11,EXIT                 YES, RETURN               A25564 41260002
         MVI   ERRFLD+2,X'04'          NO, POST ERROR CODE OF 4  A25564 41280002
         BR    RETURN                                            A25564 41300002
CODEOF8  EQU   *                                                 A25564 41320002
         CLI   ERRFLD+2,X'08'          PRESENT CONDITION CODE    A25564 41340002
*                                      HIGHER THAN OR EQUAL TO 8?A25564 41360002
         BC    11,EXIT                 YES, RETURN               A25564 41380002
         MVI   ERRFLD+2,X'08'          NO, POST ERROR CODE OF 8  A25564 41400002
EXIT     EQU   *                                                 A25564 41420002
         BR    RETURN                                            A25564 41440002
CODEOF12 EQU   *                                                 A25564 41460002
         CLI   ERRFLD+2,X'12'          PRESENT CONDITION CODE    A25564 41480002
*                                      HIGHER THAN OR EQUAL TO 12A25564 41500002
         BC    11,EXIT                 YES, RETURN               A25564 41520002
         MVI   ERRFLD+2,X'0C'       NO, POST ERROR CODE OF 12  @ZA13755 41540099
         BR    RETURN                                            A25564 41560002
         B     GOAGAIN            GET THE NEXT REQUEST                  41580002
IEHPROGD EQU   *                                                  M2838 41600002
         TM    MOUNTSW,ERRSW           IS CONTINUATION CARD      A23466 41620002
*                                      EXPECTED                  A23466 41640002
         BC    8,VALIDEND              NO, GO WRITE FINAL        A23466 41660002
*                                      MESSAGE                   A23466 41680002
         NI    MOUNTSW,CLEAROUT        TURN ERROR INDICATION     A23466 41700002
*                                      OFF                       A23466 41720002
         LA    PARAMREG,57             PUT MESSAGE NUMBER INTO   A23466 41740002
*                                      REGISTER 0                A23466 41760002
         MVI   MSGOUT,C' '             CLEAR MESSAGE AREA        A23466 41780002
         MVC   MSGOUT+1(119),MSGOUT                              A23466 41800002
         L     LINKREG,MSGRTNAD                                  A23466 41820002
         BALR  RETURN,LINKREG          WRITE ERROR MESSAGE       A23466 41840002
         L     LINKREG,SEVER8          GO TO CONDITION CODE      A25564 41860002
         BALR  RETURN,LINKREG          HANDLER                   A25564 41880002
VALIDEND EQU   *                                                 A23466 41900002
         LA    PARAMREG,31             WRITE UTILITY END         A23466 41920002
EOJ      EQU   *                                                 A23466 41940002
         L     LINKREG,MSGRTNAD                                  A23466 41960002
         BALR  RETURN,LINKREG     GO WRITE OUR FINAL MSG                41980002
         DELETE EP=DEVNAMET       DELETE DEVICE NAME TABLE         I276 42000002
         LA    R5,CLOSE                                                 42020002
         LA    R2,UTINDCB         CLOSE SYSIN                           42040002
         BALR  R4,R5                                                    42060002
         LA    R2,UTOUTDCB        CLOSE SYSPRINT                        42080002
         BALR  R4,R5                                                    42100002
         FREEPOOL UTOUTDCB             FREE UNUSED BUFFER SPACE  A34996 42120002
         TM    CTRLWORD,X'10'     IS THE VTOC OPEN                      42140002
         BZ    FREEMAIN           NO .... BRANCH                        42160002
         LA    R2,DCB4VTOC                                              42180002
         BALR  R4,R5              CLOSE THE VTOC                        42200002
FREEMAIN L     13,CTRLWORD        POINT TO ORIGINAL SAVE AREA           42220002
         LA    13,0(13)            CLEAR HIGH ORDER BYTE       @ZA11944 42230099
         SR    R2,R2                                                    42240002
         IC    R2,ERRFLD+2                                              42260002
         LR    1,RBD                                                    42280002
         LA    ZERO,DSECTSZE                                     S21046 42300002
         SLL   ZERO,1                                              8429 42320002
       FREEMAIN R,LV=(0),A=(1)  RETURN OUR CORE TO THE SUPERVISOR  8429 42340002
         LR    15,R2                                                    42360002
         RETURN (14,12),RC=(15)   BACK TO THE CALLING PROGRAM           42380002
CLOSE    CLOSE ((R2))                                                   42400002
         ORG   *-18                                                     42420002
         LA    1,DBLWORD          CLOSE THE DCB IN R2                   42440002
         NOP   0                                                        42460002
         ORG                                                            42480002
         BR    R4                 RETURN                                42500002
*                                                                       42520002
AREAONE  DS    F                       SAVEAREA OF REGISTER 1    A24020 42540002
AREATWO  DS    F                       SAVEAREA OF REGISTER 2    A24020 42560002
AREAFIVE DS    F                       SAVEAREA OF REGISTER 5    A24020 42580002
AREASIX  DS    F                       SAVEAREA OF REGISTER 6    A24020 42600002
SCANAD   DC    A(IEHESCAN)                                              42620002
SEVER4   DC    A(CODEOF4)              ADCON TO RET CODE OF 4    A25564 42640002
*                                      HANDLING ROUTINE          A25564 42660002
SEVER8   DC    A(CODEOF8)              ADCON TO RET CODE OF 8    A25564 42680002
*                                      HANDLING ROUTINE          A25564 42700002
SEVER12  DC    A(CODEOF12)             ADCON TO RET CODE OF 12   A25564 42720002
*                                      HANDLING ROUTINE          A25564 42740002
SCANBASE DC    A(IEHESCAN+2)                                            42760002
ADVTOCDC DC    A(VTOCDCS)                                               42780002
NOTVALID EQU   5                                                        42800002
MSGRTNAD DC    V(IEHPROG3)        LOC OF MESSAGE ROUTINE          M2838 42820002
INVOCRTN DC    V(IEHPROG4)        LOC OF RTN TO OPEN INPUT/OUTPUT M2838 42840002
MOUNTRTN DC    V(IEHPROG5)        LOC OF VOLUME MOUNTING RTN      M2838 42860002
SPECIALS DC    C'.,=()   '                                              42880002
*                                                                       42900002
*                                                                       42920002
VTOCDCS  DS    0F                 ALLIGN THE LIST                       42940002
         DC    X'08000000'        READ ALL CONTINUE CARDS               42960002
         DC    A(VOLTEST)         GO TEST IF VOL PARM IS PRESENT        42980002
         DC    FL1'10'                                                  43000002
         DC    FL3'11'                                                  43020002
BLDG     DS    0F                                                       43040002
         DC    FL1'1'                                                   43060002
         DC    FL1'0'                                                   43080002
         DC    BL2'1100000010000001'   INDEX,CVOL,CHECK ALPHA    A28552 43100002
         DC    BL4'00000100001000000000000000000000'                    43120002
         DC    X'08000000'        READ ALL CONTINUE CARDS               43140002
         DC    FL1'2'                                                   43160002
         DC    FL1'0'             TEST FOR MINIMUM REQUIREMENTS         43180002
         DC    BL1'01000010'      INDEX AND ENTRIES                     43200002
         DC    FL1'12'                                                  43220002
         DC    FL1'4'             IF NOT BOTH PRESENT                   43240002
         DC    AL3(BADINDX)       GO TO BAD INDX                        43260002
         DC    FL1'10'                                                  43280002
         DC    FL3'12'                                                  43300002
         ENTRY IEHPROGD                                           M2838 43320002
         ENTRY IEHPROGE                                           M2838 43340002
IEHPROGA CSECT                                                    M2838 43360002
         USING *,15                                                     43380002
         USING NAME,2                                                   43400002
         STM   3,5,REGSAVE              SAVE THE REGISTERS              43420002
         L     3,TABLEAD                GET ADDRESS OF TABLE            43440002
         L     4,0(3)                   GET NUMBER OF TABLE ENTRIES     43460002
         LA    3,4(3)                   POINT AT THE FIRST ENTRY        43480002
         XC    DEVICE(4),DEVICE         INDICATE A NO FIND CONDITION    43500002
         XC    UNIT(5),UNIT            CLEAR SPECIFIC UNIT NAME    DT0I 43520002
LOOKUP   CLC   NAME(8),0(3)             COMPARE THE NAMES               43540002
         BNE   CHECKEND                 BRANCH .... NO FIND             43560002
         MVC   DEVICE(4),8(3)           POST THE FOUND DEVICE CODE      43580002
         LA    4,1                      FORCE AN END OF LOOP            43600002
CHECKEND LA    3,12(3)                 POINT AT THE NEXT ENTRY          43620002
         BCT   4,LOOKUP                                                 43640002
         CLC   DEVICE(4),ZEROCON       HAS DEVICE BEEN FOUND       DT0I 43660002
         BC    7,DEVFOUND                 BRANCH ON YES            DT0I 43680002
         CLI   IEHEARGL,UCBADDR         IS ARG LENGTH EQUAL 3    A35899 43700002
         BNE   DEVFOUND                IF NOT GET OUT            A35899 43720002
         L     R3,16                   GET UCBLUT PTR              DT0I 43740002
         L     R3,40(R3)                                           DT0I 43760002
UCB      EQU   *                                               @30AAAG  43780003
         SR    R4,R4                   ZERO WORK REG           @30AAAG  43792003
         ICM   R4,3,0(R3)              GET UCB PTR             @30AAAG  43794003
         TM    0(R3),X'FF'             TEST FOR END OF TABLE       DT0I 43800002
         BC    14,NXTENTRY               GO TO NXTENTRY IF NOT END DT0I 43820002
         TM    1(R3),X'FF'                                         DT0I 43840002
         BC    1,DEVFOUND               SET UP AND RETURN TO CALLERDT0I 43860002
NXTENTRY LTR   R4,R4                   IS THIS A ZERO ENTRY        DT0I 43880002
         BZ    UP                         BRANCH ON YES            DT0I 43900002
         CLC   13(3,R4),NAME           IS THIS THE SPECIFIC NAME   DT0I 43920002
         BE    FOUND                      BRANCH ON YES            DT0I 43940002
UP       LA    R3,2(R3)                POINT TO NEXT UCBLUT ENTRY  DT0I 43960002
         B     UCB                     BRANCH TO CHECK NEXT ENTRY  DT0I 43980002
FOUND    MVC   DEVICE(4),16(R4)        MOVE IN DEVICE TYPE FROM UCBDT0I 44000002
         MVC   UNIT(5),NAME            SAVE SPECIFIC DEVICE NAME   DT0I 44020002
DEVFOUND LM    R3,R5,REGSAVE           RESTORE THE REGISTERS       DT0I 44040002
         L     15,GOBACK2               PICK UP THE RETURN ADDRESS      44060002
         BR    15                       RETURN                          44080002
ZEROCON  DC    F'0'                                                DT0I 44100002
NAMEX    DSECT                                                          44120002
NAME     DC    CL8'-DEVICE-'            NAME OF REQUIRED DEVICE         44140002
DEVICE   DC    CL4'TYPE'                4 BYTE DEVICE TYPE CODE         44160002
UNIT     DC    XL5'00'                 SPEC UNIT NAME IF SPECIFIED DT0I 44180002
GOBACK2  DC    A(0)                     RETURN ADDRESS                  44200002
REGSAVE  DC    3F'0'                    USED TO SAVE THE REGISTERS      44220002
DSECT    DSECT                                                          44240002
IEHECHAR DS    C         CHARACTER TO BE SCANNED FOR                    44260002
IEHECOND DS    C         CONDITION CODE TO STOP ON                      44280002
IEHECODE DS    C                                                        44300002
IEHEARGL DS    C                                                        44320002
IEHESTT  DS    F                                                        44340002
IEHESTP  DS    F                                                        44360002
IEHEFND  DS    F                                                        44380002
IEHETBL  DS    F                                                        44400002
IEHEFUN  DS    F                                                        44420002
IEHESCNX DS    3F                                                       44440002
IEHEMAC1 DS    7F                 PARAMETER LIST                 S21046 44460002
IEHEMAC2 DS    6F                                                       44480002
IEHESTIN DS    F                                                        44500002
IEHENDIN DS    F                                                        44520002
IEHECCNT DS    2C                                                       44540002
IEHESW1  DS    C                                                        44560002
DUPSW    DS    2C                 SWITCHES FOR TEST OF DUPLICATE S21046 44580002
*                                 PARAMETERS                     S21046 44600002
PPARAMSW DS    CL2                                                      44620002
IEHESW5  DS    C                                                        44640002
IEHESW6  DS    C                                                        44660002
IEHECALL DS    F                                                        44680002
         DS    0D                                                       44700002
DBLWORD  DS    F                                                        44720002
FULLWORD DS    F                                                        44740002
         DS    0D                                                       44760002
DECB1    DS    24X                                                      44780002
DECB2    DS    24X                                                      44800002
VOLISTAD DS    F                                                        44820002
MATRIXIU DS    F                                                        44840002
VDTIU    DS    F                                                        44860002
VOLPAREN DS    FL2                                                      44880002
VSRCM    DS    2X                                                       44900002
VDSA     DS    X                                                        44920002
DFLG     DS    X                                                   BS0H 44940002
DFLAG    DS    X                                                   BS0H 44960002
         DS    0F                                                       44980002
FLSTADDR DS    F                                                        45000002
FNSA     DS    12X                                                      45020002
KWSA     DS    12X                                                      45040002
SCANRET  DS    F                                                        45060002
MARESAR  DS    72X                                                      45080002
IEHESPC  DS    XL20                                                     45100002
         DS    XL20                                                     45120002
IEHERSAV DS    64X                                                      45140002
PASSUNIT DS    5X                                                  DT0I 45160002
MOUNTSW  DS    X                                                   DT0I 45180002
TABLEAD  DS    F                  ADDRESS OF DEVICE NAME TABLE     I276 45200002
IEHESW2  DS    X                  PROTECT SWITCHES               S21046 45220002
*                                 BIT 1=1 IF WE ARE TO PRINT     S21046 45240002
*                                        CONTROL CARDS           S21046 45260002
*                                 BIT 3=1 INDICATES FIRST QUOTE  S21046 45280002
*                                        IN SCAN FOR DATA        S21046 45300002
*                                        OPERATION IS FOUND      S21046 45320002
*                                 BIT 4= 1 IF WTOR SETUP IS DONE S21046 45340002
*                                 BIT 6=1 IF FIRST PARM ENTRY    S21046 45360002
*                                 WAS VALID                      S21046 45380002
*                                 BIT 7=1 IF INVALID PARM ENTRY  S21046 45400002
*                                 MSG HAS BEEN PRINTED           S21046 45420002
PASWDCT1 DS    1X                 NUMBER OF PROMPTS FOR PASWORD1 S21046 45440002
PASWDCT3 DS    1X                 NUMBER OF PROMPTS FOR CPASWORD S21046 45460002
TOTALPS  DS    1X                 TOTAL NUMBER OF INVALID PWS    S21046 45480002
WTORECB  DS    1F                 EVENT CONTROL BLOCK FOR WTOR   S21046 45500002
TIOTADRS DS    1F                 TIOT ADDRESS FOR WTOR          S21046 45520002
CCNAME   DS    8C                 NAME OFF CONTROL CARD          S21046 45540002
WTORLIST WTOR  'IEH220A JOBNAMES, STEPNAME, CARDNAME, REPLY WITH PASSWOX45560002
               RD',,8,WTORECB,ROUTCDE=(9),DESC=2,MF=L            S21046 45580002
EXTRACTO EXTRACT ,'S',FIELDS=(TIOT),MF=L                         S21046 45600002
DCBAREA  DS    0F                                                       45620002
UTINDCB  DCB   DSORG=PS,MACRF=(GM)                                      45640002
CODELIST DC    C'.,=()   '        SPECIAL CHARACTERS CODED BY SCAN      45660002
MAXLINES DC    FL2'45'             MAXIMUM LINES PER PAGE               45680002
LINECNT  DC    FL2'0'              LINE COUNT FIELD                     45700002
SKIP21   DC    X'8B'               SKIP TO 1 COMMAND                    45720002
WRITEHDR DC    X'19'               SPACE 3 AFTER PRINT                  45740002
HEADER   DC    CL30'MODIFY....VERSION BETA-1......'                     45760002
         DC    CL30'LAST UPDATED....JULY 11  10 PM'                     45780002
         DC    CL30'                              '                     45800002
         DC    CL30'               PAGE 001       '                     45820002
PAGENUM  EQU   HEADER+110                                               45840002
DDNAMES  DS    3CL8                     FOR THREE DD NAMES              45860002
UTOUTDCB DCB   DSORG=PS,MACRF=(PM)                                      45880002
         DS    2F                                                       45900002
CTRLWORD DS    0F       REG 13 SAVED, SWITCHES FOR VOLUME MOUNTING      45920002
IEHESAT  DS    150X                                                     45940002
READBASE DC    F'0'                                                     45960002
ERRFLD   DS    0CL8          FOR POSTING OF ERROR RETURN CODES          45980002
PARAM1   DS    44X                                                      46000002
         DS    F              FOR  LENGTH OF  PARAM2                    46020002
PARAM2   DS    44X                                                      46040002
         DS    F                   FOR LENGTH OF PARAM3                 46060002
PARAM3   DS    44X                                                      46080002
PARAM5   DS    2F                 CPASWORD PARAMETER             S21046 46100002
PARAM6   DS    151F               VOL IDS PARAMETER              S21046 46120002
PARAM7   DS    2F                 PASSWORD2 PARAMETER            S21046 46140002
PARAM8   DS    80X                DATA PARAMETER                 S21046 46160002
DUMMY    DS    1F                 TEMPORARY STORAGE FIELD        S21046 46180002
PROTCTAD DS    1F                 ADDRESS OF WHERE TO PUT NEXT   S21046 46200002
*                                 VOL ID IN PARAM6 FOR PROTECT   S21046 46220002
FINUSE   DS    F                   ADDR OF DC LIST IN USE               46240002
DCSAVEAD DS    F                   SAVE AREA FOR ADDR OF DC LIST        46260002
INPUT    DS    40F                 TWO CARD INPUT AREA                  46280002
MSGOUT   DS    30F                 MSG OUTPUT AREA                      46300002
         DS    F                                                        46320002
         DS    0D                                                       46340002
PARAM4   DS    151F                FOR A VOLUME LIST                    46360002
EOCORE   EQU   *-12                                                     46380002
         ORG   PARAM4+20                                                46400002
VTOCDCB2 DS    0F                                                       46420002
DCB4VTOC DCB   DDNAME=VTOC,                                            .46440002
               DSORG=PS,                                               .46460002
               MACRF=R,                                                .46480002
               KEYLEN=44,                                              .46500002
               BLKSIZE=1,                                              .46520002
               RECFM=U                                                  46540002
JFCB     DS    24D                                                      46560002
*        THE FOLLOWING ORG STATEMENT IS FLAGGED                  YM5077 46580002
         ORG                                                            46600002
SAVEREG2 DS    72X                SECONDARY SAVE AREA             M2838 46620002
SAVEREG3 DS    72X                THIRD LEVEL SAVE AREA           M2838 46640002
         ORG                                                            46660002
VTOCSW   EQU   JFCB+50                                                  46680002
VTOCDECB EQU   JFCB+60                                                  46700002
JFCBVOL  EQU   JFCB+118                                                 46720002
EXLST2   EQU   DCB4VTOC+36                                              46740002
FORMATID EQU   PARAM2+44                                                46760002
BLANK    EQU   64                                                       46780002
READTOO  EQU   INPUT+72                                                 46800002
COL16    EQU   READTOO+15                                               46820002
COL72    EQU   READTOO+71                                               46840002
MIDDLE   EQU   READTOO-1                                                46860002
WARE2PUT EQU   IEHEMAC1-4                                               46880002
UCBAD1   EQU   IEHESAT+16                                               46900002
         END   COMMENCE                                                 46920002
./  ADD  SSI=71450098,NAME=IEHPROG2
 TITLE  'IEHPROG2-IEHPROGM ISSUE SVC, ANALYZE RETURN'             11482 00020002
**********************************************************************  00040002
*                                                                     * 00060002
* MODULE NAME -- IEHPROG2                                      YL026VC* 00070002
*                                                              YL026VC* 00072002
* DESCRIPTIVE NAME -- IEHPROGM ISSUE SVC, ANALYZE RETURN       YL026VC* 00074002
*                                                              YL026VC* 00076002
* COPYRIGHT -- NONE                                            YL026VC* 00078002
*                                                              YL026VC* 00078402
* STATUS -- 'IEHPROG2' OS/VS2 PROLOGUE MODIFICATION            YL026VC* 00080002
*    NOVEMBER 1972                                             YL026VC* 00100002
*                                                              YL026VC* 00110002
* FUNCTION -- THIS MODULE ISSUES ALL THE SVC'S FOR THE IEHPROGM       * 00120002
*    PROGRAM.  IT IS THE INTERFACING MODULE TO THE DATA MANAGEMENT    * 00140002
*    FUNCTIONS:                                                       * 00160002
*                                                                     * 00180002
*    SCRATCH                                                          * 00340002
*    RENAME                                                           * 00380002
*    ADD                                                              * 00400002
*    DELETEP                                                          * 00420002
*    REPLACE                                                          * 00440002
*    LIST                                                             * 00460002
*    IT ALSO CHECKS ALL OF THE RETURN CODES FROM THE ABOVE            * 00480002
*    INTERFACES AND INITIATES ERROR OR DIAGNOSTIC MESSAGES            * 00500002
*    WHERE APPLICABLE.                                                * 00520002
*                                                                     * 00540002
* ENTRY POINTS --                                                     * 00560002
*         IEHPROG2 IS THE INITIAL ENTRY POINT OF THE MODULE           * 00580002
*    'IEHPROG2' AND IS ENTERED FROM THE MODULE 'IEHPROG5' IF ALL      * 00600002
*    VOLUME MOUNTING WAS RESOLVED NORMALLY.                           * 00620002
*         IEHPROG7 IS A SECONDARY ENTRY POINT TO THE MODULE           * 00640002
*    'IEHPROG2' AND IS USED IF THE VOLUME MOUNTING ROUTINE 'IEHPROG5' * 00660002
*    ENCOUNTERED A PROBLEM.  IT PROVIDES AN IMMEDIATE RETURN TO       * 00680002
*    THE MODULE 'IEHPROG1' TO THE POINT WHERE 'IEHPROG1' CALLED       * 00700002
*    'IEHPROG5'.                                                      * 00720002
*                                                                     * 00740002
* INPUT -- ALL INPUT INFORMATION IS CONTAINED IN THE COMMUNICATIONS   * 00760002
*    AND WORK AREA POINTED TO BY REGISTER 12 AND DESCRIBED BY THE     * 00780002
*    DSECT NAMED DSECT AND BEGINNING IEHECHAR.                        * 00800002
*                                                                     * 00820002
* OUTPUT -- THIS MODULE INITIATES THE OUTPUT OF ERROR AND             * 00840002
*    DIAGNOSTIC MESSAGES BY CALLING 'IEHPROG3'.  OTHER OUTPUT         * 00860002
*    IS THE RETURN CODE INFORMATION PASSED BACK FROM THE SVC          * 00880002
*    ROUTINES.                                                        * 00900002
*                                                                     * 00920002
* EXTERNAL REFERENCES --                                              * 00940002
*         IEHPROG3 IS CALLED UPON TO PRINT ANY ERROR OR DIAGNOSTIC    * 00960002
*    MESSAGES NECESSARY.                                              * 00980002
*         IEHPROG1 IS THE RETURN POINT FOR BOTH NORMAL AND ERROR      * 01000002
*    CONDITION RETURNS FROM THE MODULE 'IEHPROG2'.                    * 01020002
*         IEHPROG5 CALLS THIS MODULE AFTER IT HAS PROCESSED THE       * 01040002
*    VOLUME MOUNTING INFORMATION.                                     * 01060002
*                                                                     * 01080002
* EXITS, NORMAL -- 'IEHPROG2' RETURNS TO 'IEHPROG1' VIA A BRANCH      * 01100002
*    ON REGISTER 15 WHICH CONTAINS THE ADDRESS OF ENTRY IEHPROG9.     * 01120002
*                                                                     * 01140002
* EXITS,ERROR -- AN ERROR RETURN IS EXECUTED EXACTLY AS A NORMAL      * 01160002
*    EXIT, HOWEVER 'IEHPROG3' WILL HAVE ALREADY BEEN CALLED UPON      * 01180002
*    TO ISSUE ANY MESSAGES NECESSARY TO INDICATE THE ERROR(S).        * 01200002
*                                                                     * 01220002
* TABLES/WORK AREAS--                                                 * 01240002
*    DSECT IS THE COMMON COMMUNICATIONS AND WORK AREA POINTED TO BY   * 01260002
*    REGISTER 12 AND DESCRIBED BY THE DSECT NAMED DSECT AND           * 01280002
*    BEGINNING IEHECHAR.                                              * 01300002
*    BRANTAB IS A BRANCH TABLE USED TO CONTROL PROGRAM FLOW BY        * 01320002
*    INTERPRETING THE RETURN CODES FROM THE DATA MANAGEMENT           * 01340002
*    ROUTINES.                                                        * 01360002
*    LISTS OF 'DC'S STARTING AT MEMBER WHICH ACT AS A CONTROL         * 01380002
*    FOR BUILDING THE APPROPRIATE MESSAGES.                           * 01400002
*                                                                     * 01420002
* ATTRIBUTES -- THIS MODULE OPERATES AS ONE LEG OF AN OVERLAY         * 01440002
*    STRUCTURE.                                                       * 01460002
*                                                                     * 01480002
* CHARACTER CODE DEPENDENCY -- THIS MODULE MUST BE ASSEMBLED IN       * 01500002
*    EBCDIC AND RUN IN EBCDIC TO INSURE COLLATING SEQUENCE AND        * 01520002
*    INTERNAL REPRESENTATION OF CERTAIN CHARACTERS.                   * 01540002
*                                                                     * 01560002
* NOTES -- APPROXIMATELY 4000 BYTES OF STORAGE ARE NEEDED     @Z40RSDS* 01580008
*    FOR CODE.                                                @Z40RSDS* 01590008
*                                                                     * 01600002
* CHANGE ACTIVITY -- FOLLOWS PROLOGUE                          YL026VC* 01610002
*                                                              YL026VC* 01612002
*********************************************************************** 01620002
         EJECT                                                          01640002
IEHPROG2 CSECT                                                    M2838 01660002
*            VS2 SU32 DELETIONS                                @G32DSFS 01664032
*D041942-041944,194610-194710,239520,241850-242700,            @G32DSFS 01668032
*D253970-254070                                                @G32DSFS 01672032
*                                                              @G32DSFS 01676032
*A195240                                                         YM5077 01680002
*A140320,168300-168799,C55000,57800                              A57261 01700002
*A72570,88385-88530,C177000                                      YM5076 01720002
*C1800-13000                                                      M2838 01740002
*A120000-120100,123810-123910                                    A50977 01760002
*                                                                  I276 01780002
*2764                                                              BS0H 01800002
*2764                                                              3520 01820002
*2359                                                              DT0I 01840002
*2359117420                                                        WG0I 01860002
*                                                                  M737 01880002
*                                                                M2422  01900002
*                                                                A25564 01920002
*                                                                A28547 01940002
*                                                                A29705 01960002
*A700-784,1100,16100-16200                                      YL026VC 01970002
*C800-1000                                                      YL026VC 01972002
*D200-320,360                                                   YL026VC 01974002
*A 030602-030604                                                YA01695 01976002
*C 031300,041560                                                YA01695 01978002
*A90420-90500                                                   YM07026 01978402
*C106800                                                        YM07026 01978802
*A123995,124145                                                 YM04431 01979202
*C086800-087000,090420-090500,106800,115800,121600-121800,     @VS30028 01979303
*C122800-123200,124175-125000,176200,236200,239200-239600,     @VS30028 01979403
*C240800-241200,241800-242600,249600,251800,311200,311800      @VS30028 01979603
*C015800,176400-176600,239520,241840-241860,254000,254600,     @Z40RSDS 01979808
*C311450,311530,311560,311800                                  @Z40RSDS 01979908
*C114200                                                       @Z30AAAG 01980603
*D115000                                                       @Z30AAAG 01981603
*A114210,810,820                                               @Z30AAAG 01982603
*C128160                                                       @ZM30018 01992603
*D123995                                                       @ZM30018 01994603
*A123995,123999,124045                                         @ZM32753 01996603
*A 219900                                                      @ZA01695 01996808
*A 114100,114804,115700,117201-117345                          @ZA06552 01996908
*A123600-124100,121820-121840                                  @Z40CSJH 01998808
*D 120000,120200                                               @ZA07322 01998908
*C139000,141000,143000,145000                                  @Z40CSJH 02000808
*C147000,149000,152200,259400                                  @Z40CSJH 02000908
*A 044300,044520,047100-047140,223300,223320                   @ZA13801 02002008
*A 226900-226992,312740                                        @ZA13801 02003008
*C 044600,223200,223600                                        @ZA13801 02004008
*D 312400,312600                                               @ZA13801 02005008
*                   *****     REGISTER  USAGE     *****                 02006008
ZERO     EQU   0        ----------------------------------------        02010008
R0       EQU   0                       EQUATE FOR REGISTER 0   @VS30028 02015008
R1       EQU   12                                                       02020002
R2       EQU   2                                                        02040002
R3       EQU   3             REGISTERS ZERO THROUGH                     02060002
R4       EQU   4             TEN ARE WORK REGISTERS                     02080002
R5       EQU   5                                                        02100002
R6       EQU   6             REGESTERS ELEVEN AND                       02120002
S        EQU   6                                                   WG0I 02140002
R7       EQU   7             TWELVE ARE BASE REGISTERS                  02160002
R8       EQU   8             FOR THE PROGRAN AND THE                    02180002
R        EQU   8                                                   WG0I 02200002
R9       EQU   9             DUMMY SECTION RESPECTIVELY                 02220002
R10      EQU   10                                                       02240002
RB       EQU   11            THIRTEEN POINTS TO A REGISTER              02260002
RBD      EQU   12                                                       02280002
SAVEREG  EQU   13            SAVE AREA                                  02300002
RETURN   EQU   14                                                       02320002
LINKREG  EQU   15            FIFTEEN AND FOURTEEN ARE LINK              02340002
PARAMREG EQU   0             AND RETURN REGISTERS RESPECTIVELY          02360002
LISTREG  EQU   1        -----------------------------------------       02380002
FOUR     EQU   4                  DECREMENT FOR TABLE            S21046 02400002
EIGHT    EQU   8                  CONDITION CODE OF 8            S21046 02420002
CODE12   EQU   12                 RETURN CODE OF 12              S21046 02440002
CODE16   EQU   16                 RETURN CODE OF 16              S21046 02460002
LISTMASK EQU   X'04'              LIST OPERATION MASK            S21046 02480002
WTORMASK EQU   X'10'              MASK FOR WTOR                  S21046 02500002
PW2MASK  EQU   X'04'              CHECKS FOR PASWORD2            S21046 02520002
PW1MASK  EQU   X'20'              CHECKS FOR PASWORD1            S21046 02540002
CONTROL  EQU   X'80'              CHECK FOR CONTROL PASSWORD     S21046 02560002
RW       EQU   X'01'              CHECK FOR READ/WRITE PROTECTIONS21046 02580002
FIXBYTE  EQU   X'F0'              FIX HIGH ORDER BYTE AFTER      S21046 02600002
*                                 UNPACK OPERATION               S21046 02620002
PROMASK  EQU   X'FF'              PROTECT INDICATION MASK        S21046 02640002
RTNREG   EQU   15                 RETURN CODE REGISTER           S21046 02660002
MSG60    EQU   60                 PRINT MESSAGE 60               S21046 02680002
*                                 MPDS DOES NOT EXIST            S21046 02700002
MSG61    EQU   61                 PRINT MESSAGE 61               S21046 02720002
*                                 TAPE DATA SET NOT PROTECTED    S21046 02740002
MSG62    EQU   62                 PRINT MESSAGE 62               S21046 02760002
*                                 DUPLICATE ENTRIES IN MPDS      S21046 02780002
MSG63    EQU   63                 PRINT MESSAGE 63               S21046 02800002
*                                 FIVE INVALID PASSWORDS         S21046 02820002
MSG64    EQU   64                 PRINT MESSGE 64                S21046 02840002
*                                 DSCB NOT UPDATED               S21046 02860002
MSG65    EQU   65                 PRINT MESSGE 65                S21046 02880002
*                                 I/O ERROR IN MPDS              S21046 02900002
MSG66    EQU   66                 PRINT MESSGE 66                S21046 02920002
*                                 MPDS FULL                      S21046 02940002
MOVE1    EQU   1                  MOVE CALL CODE                 S21046 02960002
MOVE2    EQU   2                  MOVE 2 CHAR. FOR UNPACK        S21046 02980002
MOVE3    EQU   3                  FOR UNPACK AND ADDR MOVES      S21046 03000002
MOVE4    EQU   4                  MOVE FOUR CHARACTERS           S21046 03020002
MOVE6    EQU   6                  MOVE ACCESS COUNT              S21046 03040002
MOVE8    EQU   8                  MOVE PASSWORDS, AND JOB, STEP, S21046 03060002
*                                 AND CARD NAMES                 S21046 03080002
MOVE9    EQU   9                  MOVE READ ONLY                 S21046 03100002
MOVE10   EQU   10                 MOVE READ/WRITE                S21046 03120002
MOVE12   EQU   12                 MOVE TYPE OF PASSWORD          S21046 03140002
MOVE19   EQU   19                 MOVE DATA FIELD HEADER         S21046 03160002
MOVE21   EQU   21                 MOVE MODE BYTE HEADER          S21046 03180002
MOVE24   EQU   24                 MOVE ACCESS COUNT HEADER       S21046 03200002
MOVE27   EQU   27                 MOVE MODE BYTE HEADER          S21046 03220002
MOVE36   EQU   36                 MOVE OPERATOR FAILURE MESSAGE  S21046 03240002
MOVE54   EQU   54                 MOVE OBTAIN FAILURE MESSAGE    S21046 03260002
MOVE77   EQU   77                 MOVE DATA FIELD AND LOCATE     S21046 03280002
*                                 FAILURE MESSAGE                S21046 03300002
OFFSET1  EQU   1                  OFFSET TO PW1MASK, UPDATE      S21046 03320002
*                                 POINTER TO TABLE, AND STEP     S21046 03340002
*                                 UP ONE BYTE IN PARAMETER LIST  S21046 03360002
OFFSET2  EQU   2                  OFFSET FOR ERROR CODE IN ERRFLDS21046 03380002
*                                 AND INTO PARMFLD               S21046 03400002
OFFSET3  EQU   3                  OFFSET TO CALL CODE AND OFFSET S21046 03420002
*                                 TO DATA FIELD IN MPDS RECORD   S21046 03440002
OFFSET4  EQU   4                  OFFSET TO ECB IN WTORLIST      S21046 03460002
OFFSET5  EQU   5                  OFFSET TO ACCESS COUNT         S21046 03480002
OFFSET6  EQU   6                  OFFSET TO LOCATE AND OBTAIN    S21046 03500002
*                                 RETURN CODES IN DBLWORD        S21046 03520002
OFFSET8  EQU   8                  OFFSET TO STEPNAME, AND        S21046 03540002
*                                 PARAM3 IN IEHEMAC1             S21046 03560002
OFFSET12 EQU   12                 OFFSET TO PARAM5 IN IEHEMAC1   S21046 03580002
*                                 FOR CPASWORD                   S21046 03600002
OFFSET16 EQU   16                 OFFSET INTO TIOT FOR STEPNAME  S21046 03620002
OFFSET19 EQU   19                 OFFSET FOR DATA IN MESSAGE     S21046 03640002
OFFSET20 EQU   20                 OFFSET INTO WTORLIST FOR       S21046 03660002
*                                 JOBNAME                        S21046 03680002
OFFSET21 EQU   21                 OFFSET INTO IEHEMAC1 FOR       S21046 03700002
*                                 PASSWORD ADDRESS               S21046 03720002
OFFSET24 EQU   24                 OFFSET TO ACCESS COUNT IN MSG  S21046 03740002
OFFSET27 EQU   27                 OFFSET INTO MSG TO PROTECT     S21046 03760002
*                                 MODE BYTE                      S21046 03780002
OFFSET29 EQU   29                 OFFSET TO FIX HIGH ORDER BYTE  S21046 03800002
*                                 OF PROTECT MODE                S21046 03820002
OFFSET30 EQU   30                 OFFSET INTO WTORLIST OF STEP   S21046 03840002
*                                 NAME                           S21046 03860002
OFFSET33 EQU   33                  OFFSET FOR PROTECT TYPE       S21046 03880002
OFFSET36 EQU   36                 OFFSET INTO MSG FOR PASSWORD   S21046 03900002
OFFSET40 EQU   40                 OFFSET INTO WTORLIST FOR CARD  S21046 03920002
*                                 NAME                           S21046 03940002
OFFSET51 EQU   51                 OFFSET TO LOCATE RETURN CODE   S21046 03960002
*                                 IN MESSAGE                     S21046 03980002
OFFSET52 EQU   52                 OFFSET TO HIGH ORDER BYTE      S21046 04000002
OFFSET61 EQU   61                 OFFSET INTO WTORLIST FOR       S21046 04020002
*                                 PASSWORD                       S21046 04040002
OFFSET74 EQU   74                 OFFSET INTO MSG FOR INDICES    S21046 04060002
OFFSET75 EQU   75                 OFFSET TO HIGH ORDER BYTE      S21046 04080002
OFFSET80 EQU   80                 OFFSET TO LOCATE CODES         A31333 04100002
ZERO4    EQU   4                  ZERO OUT FOUR BYTES OF IEHEMAC1S21046 04120002
DNWBBIT  EQU   X'08'              TURN ON THE DO NOT WRITE BACK  A38610 04140002
*                                 BIT IN THE JFCB                A38610 04160002
DWOFFSET EQU   52                 OFFSET TO DON'T WRITE BACK BIT A38610 04180002
CODEA    EQU   X'0A'              RENAME ERROR HANDLER RETURN  @VS30028X04182003
                                  CODE CORRESPONDING TO STOW   @VS30028X04184003
                                  ERROR X'14' (DCB NOT OPEN)   @VS30028 04186003
STATUS   EQU   13                 OFFSET TO STATUS CODE BYTE   @VS30028X04188003
                                  IN SCRATCH/RENAME VOL LIST   @VS30028 04188403
PSWDERR  EQU   X'02'              SCRATCH/RENAME PASSWORD ERR  @VS30028 04190003
IOERROR  EQU   X'04'              SCRATCH/RENAME I/O ERROR     @VS30028 04192003
OPENDS   EQU   X'07'              SCRATCH/RENAME OPEN D/S ERR  @VS30028 04194003
SCRMASK  EQU   X'40'              SCRATCH OPTION BYTE 2 MASK   @Z40RSDS 04195008
*                                                                       04200002
*                   *****     SWITCH USAGE        *****                 04220002
NDSWMSK  EQU   128       END SWITCH  BIT POS ZERO  SWITCH 1             04240002
COMMENTS EQU   64                                                       04260002
CONTINUE EQU   32                                                       04280002
FIRSTONE EQU   16                                                       04300002
BIGSHIFT EQU   8                                                        04320002
SHIFTLOC EQU   4                                                        04340002
VOLSW    EQU   2                                                        04360002
         SAVE  (14,12)            SAVE OLD REGS                   M2838 04380002
         BALR  R10,0                                                    04400002
         USING *,R10                                                    04420002
         L     RB,SCNDBASE                                     @ZA13801 04430008
         L     R10,CSECT2AD                                             04440002
         AR    RB,R10                                          @ZA13801 04450008
         USING IEHPROG2,R10,RB    ESTABLISH ADDRESSABILITY     @ZA13801 04460008
         USING IEHECHAR,RBD                                             04480002
         ST    SAVEREG,SAVEREG2+4 KEEP OLD SAVE REG               M2838 04500002
         LA    SAVEREG,SAVEREG2   ESTABLISH NEW SAVE AREA         M2838 04520002
         L     R3,DECB2                 GET ADDRESS OF ADCONS           04540002
         L     R3,24(R3)                GET RETURN ADDRESS              04560002
         ST    R3,DECB2+4               POST IT                         04580002
         SR    R3,R3                                                    04600002
         IC    R3,FINUSE+3        GET NUMBER OF REQUIRED TABLE          04620002
         SLL   R3,2                                                     04640002
         EX    0,LATAB-4(R3)      GET ADDRESS OF THE TABLE              04660002
         ST    R3,FINUSE                                                04680002
         B     FDLD                    TABLE NUMBER                     04700002
SCNDBASE DC    F'4096'               CONSTANT FOR SECOND BASE  @ZA13801 04705008
CSECT2AD DC    A(IEHPROG2)           ADDR OF MAIN ENTRY POINT  @ZA13801 04710008
MSGRTNAD DC    V(IEHPROG3)           ADDR OF MESSAGE ROUTINE   @ZA13801 04715008
IEHPROG7 BR    RETURN             RETURN TO POINT OF CALL         M2838 04720002
         ENTRY IEHPROG7                                           M2838 04740002
*   THE FOLLOWING INSTRUCTIONS LOAD THE ADDRESS OF THE CODE      S21046 04760002
*   TO BE EXECUTED DEPENDING UPON THE OPERATION SCANNED IN THE   S21046 04780002
*   FIRST MODULE. THE NUMBER TO THE RIGHT OF THE INSTRUCTION     S21046 04800002
*   REFERS TO THE CODE THAT CAUSES THAT LA TO BE EXECUTED.       S21046 04820002
*                                                                S21046 04840002
LATAB    LA    R3,CATALOG                    1                          04860002
         LA    R3,UNCATLG                    2                          04880002
         LA    R3,DELETEX                    3                          04900002
         LA    R3,CONNECT                    4                          04920002
         LA    R3,RELEASE                    5                          04940002
         LA    R3,BUILDA                     6                          04960002
         LA    R3,DELETEA                    7                          04980002
         LA    R3,SCRATCH                    8                          05000002
         LA    R3,BUILDX                     9                          05020002
         LA    R3,RENAME                     10                         05040002
         LA    R3,VTOCDCS                    11                         05060002
         LA    R3,BLDG                       12                         05080002
         LA    R3,MEMBER                     13                         05100002
         LA    R3,ADD                        14                  S21046 05120002
         LA    R3,DELETEP                    15                  S21046 05140002
         LA    R3,REPLACE                    16                  S21046 05160002
         LA    R3,LIST                       17                  S21046 05180002
*                                                                       05200002
*                                                                       05220002
ENT2FDLD ST    LISTREG,FINUSE          SAVE ADDRESS OF LIST    @VS30028 05230003
FDLD     L     R9,FINUSE           GET ADDRESS OF LIST IN USE           05240002
         LA    R6,4(R9)                                                 05260002
         ST    R6,FINUSE           UPDATE THE LIST ADDRESS              05280002
         SR    R2,R2                                                    05300002
         IC    R2,0(R9)                                                 05320002
         SLL   R2,2                SELECT THE ROUTINE TO BE PERFORMED   05340002
         LA    RETURN,FDLD              PROVIDE A RETURN                05360002
         EX    0,*+4(R2)           GO THERE                             05380002
*                                                                       05400002
* ONE OF THESE BRANCH INSTRUCTIONS ARE EXECUTED AS DETERMINED FROM      05420002
*        THE FIRST BYTE OF THE  DATA LIST  FOR THE FUNCTION IN USE      05440002
         B     XCONTROL           EXECUTE FOR A ZERO OP                 05460002
         B     *                                                        05480002
         B     *                                                        05500002
         B     *                   B TO *  ONLY TAKE UP SPACE           05520002
         B     LINKSAVE                                                 05540002
         B     DCRETURN                                                 05560002
         B     GETAMSG                                                  05580002
         B     EXECUTE                                                  05600002
         B     CLOSVTOC                                                 05620002
         B     STTRESET                                                 05640002
         B     WTORPAS1           BRANCH TO WTOR FOR PASWORD1    S21046 05660002
         B     WTORPAS2           BRANCH TO WTOR FOR PASWORD2    S21046 05680002
         B     PASSETUP           PUT CALL CODE IN IEHEMAC1      S21046 05700002
         B     LISTPARM           PUT ADDRESS OF RECIEVE AREA    S21046 05720002
FRECOVER MVC   FINUSE(4),FLSTADDR                                       05740002
         B     FDLD                                                     05760002
XCONTROL L     R2,0(R9)                                                 05780002
         BR    R2             GO TO LOCATION IN THE DATA LIST           05800002
LINKSAVE MVC   DCSAVEAD(4),FINUSE       SAVE LIST ADDRESS               05820002
         MVC   FINUSE(4),0(R9)          GET NEW LIST ADDRESS            05840002
         B     FDLD                                                     05860002
DCRETURN MVC   FINUSE(4),DCSAVEAD                                       05880002
         B     FDLD                                                     05900002
GETAMSG  L     PARAMREG,0(R9)                                           05920002
         L     LINKREG,MSGRTNAD                                         05940002
         BR    LINKREG                                                  05960002
PASSETUP XC    IEHEMAC1(ZERO4),IEHEMAC1 ZERO OUT IEHEMAC1        S21046 05980002
         MVC   IEHEMAC1(MOVE1),OFFSET3(R9)  MOVE CALL CODE TO    S21046 06000002
*                                           IEHEMAC1             S21046 06020002
         B     FDLD               GO TO NEXT TABLE ENTRY         S21046 06040002
*                                                                S21046 06060002
*        13 OP PUT ADDRESS OF BUFFER IN THE PARAMETER FOR LIST   S21046 06080002
*                                                                S21046 06100002
LISTPARM LA    R6,PARAM4                LOAD ADDRESS OF BUFFER   S21046 06120002
         ST    R6,DUMMY                 STORE THE ADDRESS        S21046 06140002
         MVC   IEHEMAC1+OFFSET1(MOVE3),DUMMY+OFFSET1             S21046 06160002
*                                       MOVE ADDRESS TO PARAM    S21046 06180002
         B     FDLD                     GO TO NEXT ENTRY IN TAB  S21046 06200002
*                                                                S21046 06220002
*      FIRST PASS FOR WTOR FOR PASWORD1, IF SPECIFIED ON CARD    S21046 06240002
*      MOVE ON IF NOTINITIALIZE TO PROMPT OPERATOR FOR PASWORD1  S21046 06260002
*                                                                S21046 06280002
WTORPAS1 TM    DUPSW+OFFSET1,PW1MASK   WAS PASWORD1 SPECIFIED    S21046 06300002
*                                       ON CARD                  S21046 06320002
         BO    FDLD               THEN DO NOT NEED TO PROMPT     S21046 06340002
         IC    R4,TOTALPS         GET TOTAL WTOR COUNT           S21046 06360002
         LA    R4,OFFSET1(R4)           UP THE COUNT BY 1        S21046 06380002
         STC   R4,TOTALPS         STORE THE NEW COUNT            S21046 06400002
*                                                                S21046 06420002
*      RETURN CODE OF 8 FROM PROTECT. PASWORD1 GIVEN WAS         S21046 06440002
*      INVALID, INITIALIZE FOR WTOR                              S21046 06460002
*                                                                S21046 06480002
RTNCODE8 LA    R2,PARAM3          LOAD ADDRESS FOR PASWORD1      S21046 06500002
         ST    R2,IEHEMAC1+OFFSET8     STORE ADDR IN PARAM LIST  S21046 06520002
         LA    R6,PASWDCT1        LOAD ADDRESS FOR PASWORD1 CNT  S21046 06540002
         LA    R7,MSGE1           ADDRESS OF WTOR MESSAGE        S21046 06560002
         TM    DUPSW+OFFSET1,PW1MASK   WAS PSW SPECIF IN CARD   YA01695 06570002
         BO    BLNKPSWD              YES BRANCH TO MESSAGE      YA01695 06572002
         B     OPSETUP            GO SET UP THE WTOR             S21046 06580002
*                                                                S21046 06600002
*      IF PASWORD2 WAS NOT SPECIFIED ON CARD INITIALIZE FOR WTOR S21046 06620002
*                                                                S21046 06640002
WTORPAS2 TM    DUPSW+OFFSET1,PW2MASK  IS PASWORD2 IN PARAM LIST  S21046 06660002
         BO    FDLD               THEN DO NOT NEED TO PROMPT     S21046 06680002
         LA    R2,PARAM7          LOAD ADDRESS FOR PASWORD2      S21046 06700002
         ST    R2,DUMMY           STORE ADDRESS TO BE MOVED      S21046 06720002
         MVC   IEHEMAC1+OFFSET21(MOVE3),DUMMY+OFFSET1            S21046 06740002
*                                 MOVE THE ADDRESS TO PARM       S21046 06760002
         LA    R7,MSGE2           ADDRESS OF WTOR MESSAGE        S21046 06780002
         B     WRITE              GO WRITE TO OPERATOR           S21046 06800002
*                                                                S21046 06820002
*      EITHER CPASWORD WAS NOT SPECIFIED ON CARD OR IT WAS       S21046 06840002
*      INVALID, INITIALIZE FOR WTOR                              S21046 06860002
*                                                                S21046 06880002
RTNCOD12 LA    R2,PARAM5          LOAD ADDRESS FOR CPASWORD      S21046 06900002
         ST    R2,IEHEMAC1+OFFSET12 STORE ADDRESS IN PARM LIST   S21046 06920002
         LA    R6,PASWDCT3        LOAD ADDRESS OF CPASWORD CNT   S21046 06940002
         LA    R7,MSGE3           ADDRESS OF WTOR MESSAGE        S21046 06960002
*                                                                S21046 06980002
*      RETRIEVE THE COUNTER FOR THE PASSWORD TO BE PROMPTED FOR  S21046 07000002
*                                                                S21046 07020002
OPSETUP  SR    R3,R3              ZERO OUT REG 3                 S21046 07040002
         IC    R3,ZERO(R6)        GET THE COUNTER TO BE UPDATED  S21046 07060002
         BCT   R3,GOWTOR          UPDATE COUNTER BRANCH NOT 0    S21046 07080002
*                                                                S21046 07100002
*      IF THE OPERATOR DID NOT SUPPLY A PASSWORD OR IF THE       S21046 07120002
*      NUMBER OF ATTEMPTS FOR A PARTICULAR PASSWORD EXCEEDED THE S21046 07140002
*      MAXIMUM PERMISSIBLE INITIALIZE TO PRINT ERROR MESSAGE     S21046 07160002
*                                                                S21046 07180002
BLNKPSWD EQU   *                  OPERATOR DID NOT SUPPLY A      S21046 07200002
*                                 PASSWORD                       S21046 07220002
         MVC   MSGOUT(MOVE36),OPFAIL MOVE FIRST PART OF MSG      S21046 07240002
         MVC   MSGOUT+OFFSET16(MOVE8),ZERO(R7)                  YA01695 07250002
*                                 WHICH PASSWORD TO MSG AREA     S21046 07280002
         SR    PARAMREG,PARAMREG  ZERO REG 0                     S21046 07300002
         B     MSGRTN             WRITE MSG FOR OPERATOR FAILURE S21046 07320002
*                                                                S21046 07340002
*      IF MORE THAN FIVE INVALID PASSWORDS WRER GIVEN IN THIS    S21046 07360002
*      JOB INITIALIZE TO PRINT ERROR MESSAGE AND TERMINATE       S21046 07380002
*                                                                S21046 07400002
GOWTOR   STC   R3,ZERO(R6)        STORE THE UPDATED COUNTER      S21046 07420002
         IC    R3,TOTALPS         UPDATE TOTAL WTOR COUNT        S21046 07440002
         BCT   R3,NXTWTOR         HAS COUNTER REACHED ZERO       S21046 07460002
         LA    PARAMREG,MSG63     MESSAGE 63 FOR TOO AMNY        S21046 07480002
         MVI   ERRFLD+OFFSET2,CODE16 OPERATOR FAILED MAX TIMES   S21046 07500002
         B     MSGRTN             PRINT MESSAGE                  S21046 07520002
*                                                                S21046 07540002
*      STORE UPDATED TOTAL WTOR COUNT, CHECK TO SEE IF           S21046 07560002
*      LIST FORM OF WTOR HAS BEEN MOVED, INITIALIZE FOR AND ISSUES21046 07580002
*      PROTECT MACRO                                             S21046 07600002
*                                                                S21046 07620002
NXTWTOR  STC   R3,TOTALPS         NO STORE NEW COUNT             S21046 07640002
WRITE    TM    IEHESW2,WTORMASK   IS WTOR LIST MOVED             S21046 07660002
         BC    EIGHT,WTORINIT     GO MOVE WTOR LIST              S21046 07680002
WTORFNSH MVC   ZERO(MOVE8,R2),UPPERFLD                           S21046 07700002
*                                 BLANK OUT OPERATOR REPLY FIELD S21046 07720002
         MVC   WTORLIST+OFFSET61(MOVE8),ZERO(R7)                 S21046 07740002
*                                 MOVE THE PROPER PASSWORD       S21046 07760002
         MVC   WTORLIST+OFFSET40(MOVE8),CCNAME                   S21046 07780002
*                                 MOVE CONTROL CARD NAME         S21046 07800002
         MVI   WTORECB,ZERO       ZERO OUT ECB                   S21046 07820002
         WTOR  ,(R2),8,WTORECB,MF=(E,WTORLIST)                   S21046 07840002
         WAIT  ECB=WTORECB        WAIT FOR OPERATOR RESPONSE     S21046 07860002
         CLC   ZERO(MOVE8,R2),UPPERFLD                           S21046 07880002
*                                 DID OPERATOR REPLY WITH BLANKS S21046 07900002
         BE    BLNKPSWD           IF SO PRINT MESSAGE            S21046 07920002
         OC    ZERO(MOVE8,R2),UPPERFLD FOLD ALL OF REPLY TO CAPS S21046 07940002
         B     FDLD               GO TO NEXT ENTRY IN TABLE      S21046 07960002
*                                                                S21046 07980002
*      MOVE IN THE LIST FORM OF WTOR AND GET THE JOBNAME AND     S21046 08000002
*      STEPNAME WITH THE EXTRACT MACRO                           S21046 08020002
*                                                                S21046 08040002
WTORINIT MVC   WTORLIST(WTORSTOP-WTORLFRM),WTORLFRM              S21046 08060002
*                                 MOVE THE LIST FOR WTOR         S21046 08080002
         LA    R3,WTORECB         LOAD ADDRESS OF ECB FOR WTOR   S21046 08100002
         ST    R3,WTORLIST+OFFSET4 STORE THE ADDRESS OF THE ECB  S21046 08120002
         MVC   EXTRACTO(EXSTP-EXTRACT1),EXTRACT1                 S21046 08140002
         LA    R8,TIOTADRS        ADDRESS TO RETURN TIOT ADDRESS S21046 08160002
*  MOVE THE EXTRACT PARAMETER LIST TO GET MAIN AREA              S21046 08180002
         EXTRACT (8),'S',FIELDS=(TIOT),MF=(E,EXTRACTO)           S21046 08200002
*   GET ADDRESS OF TIOT TO GET JOBNAME AND STEP NAME             S21046 08220002
         L     R8,TIOTADRS        GET ADDRESS OF TIOT            S21046 08240002
         CLC   UPPERFLD(MOVE8),OFFSET16(R8)                      S21046 08260002
*                                 IS THIS A PROCEDURE            S21046 08280002
         BE    ALLBLANK           NO  BRANCH                     S21046 08300002
         MVC   WTORLIST+OFFSET30(MOVE8),OFFSET16(R8)             S21046 08320002
*                                 MOVE THE STEP NAME FOR THE JOB S21046 08340002
         B     MVCMSG             SET UP REST OF MESSAGE         S21046 08360002
ALLBLANK MVC   WTORLIST+OFFSET30(MOVE8),OFFSET8(R8)              S21046 08380002
*                                 MOVE THE STEP NAME FOR JOB     S21046 08400002
MVCMSG   MVC   WTORLIST+OFFSET20(MOVE8),ZERO(R8)                 S21046 08420002
*                                 MOVE THE JOBNAME FOR MSG       S21046 08440002
         B     WTORFNSH           GO FINISH WTOR SETUP           S21046 08460002
EXECUTE  L     LINKREG,0(R9)                                            08480002
         EX    0,0(LINKREG)                                             08500002
         B     FDLD                                                     08520002
MVECT    MVC   IEHEMAC1+3(1),PARAM4+1  NUMBER OF ENTRIES TO LST    4621 08540002
CLOSVTOC CLOSE ((R3))             CLOSE THE VTOC HERE                   08560002
         ORG   *-18                                                     08580002
         LA    1,FULLWORD                                               08600002
         LA    R3,DCB4VTOC                                              08620002
         ORG                                                            08640002
         B     FDLD                                                     08660002
STTRESET EQU   *                                                        08720002
         L     SAVEREG,SAVEREG2+4 GET OLD SAVE AREA ADDRESS       M2838 08740002
         LM    14,12,12(13)       RESTORE REGS                    M2838 08760002
         L     15,DECB2                                                 08780002
         L     15,4(15)                 GET ADDRESS OF IEHRESET         08800002
         BR    15                       RETURN TO THE FIRST LOAD        08820002
*                                                                S21046 08840002
*      INITIALIZE FOR AND ISSUE THE PROTECT MACRO                S21046 08860002
*                                                                S21046 08880002
SVCPRO   EQU   *                                                 S21046 08900002
         PROTECT  IEHEMAC1        ISSUE THE PROTECT SVC          S21046 08920002
         MVI   ERRFLD,PROMASK     INDICATE PROTECT RETURN        S21046 08940002
         STC    RTNREG,ERRFLD+OFFSET1 STORE RETURN CODE          S21046 08960002
DECODE   EX    ZERO,PROTAB(RTNREG) INTERPRET THE RETURN CODE     S21046 08980002
MSGRTN   L     LINKREG,MSGRTNAD   LOAD ADDRESS OF MESSAGE WRITER S21046 09000002
         BALR  RETURN,LINKREG     GO TO MSG WRITER               S21046 09020002
         B     STTRESET           RETURN                         S21046 09040002
*                                                                S21046 09060002
*      THIS BRANCH TABLE IS USED TO INTERPRET THE RETURN CODE    S21046 09080002
*      FROM THE PROTECT MACRO                                    S21046 09100002
*                                                                S21046 09120002
PROTAB   B     OKPROTCT           NORMAL END FOR PROTECT         S21046 09140002
         LA    PARAMREG,MSG62     DUPLICATE KEYS IN MPDS         S21046 09160002
         B     DSNOTFD            PASWORD1 NOT FOUND IN MPDS     S21046 09180002
         B     CPASWD             NEED A CONTROL PASSWORD        S21046 09200002
         B     UNKERR             PRINT UNKNOWN ERROR MESSAGE    S21046 09220002
*                                 AN INVALID PARAMETER LIST WAS  S21046 09240002
*                                 PASSED TO PROTECT              S21046 09260002
         B     IOMPDS             I/O ERROR IN MPDS              S21046 09280002
         LA    PARAMREG,MSG66     THE MPDS IS FULL               S21046 09300002
         B     UNKERR             PRINT UNKNOWN ERROR MESSAGE    S21046 09320002
*                                 VALIDITY CHECK FOR BUFFER AREA S21046 09340002
*                                 FAILED                         S21046 09360002
         B     LOCATFAL           LOCATE MACRO FAILED            S21046 09380002
         B     OBTANFAL           OBTAIN MACRO FAILED            S21046 09400002
         LA    PARAMREG,MSG64     UNABLE TO UPDATE DSCB          S21046 09420002
         LA    PARAMREG,MSG60     MPDS DOES NOT EXIST            S21046 09440002
         LA    PARAMREG,MSG61     TAPE DATA SET NOT PROTECTED    S21046 09460002
         LA    PARAMREG,MSG64     ENQ FAILURE IN SCV98           S21046 09480002
*                                                                S21046 09500002
*      PROTECT WORKED, IF THE REQUEST WAS A LIST MOVE THE DATA   S21046 09520002
*      RECIEVED TO THE PROPER MESSAGE AND HAVE THE MESSAGES      S21046 09540002
*      PRINTED.                                                  S21046 09560002
*                                                                S21046 09580002
OKPROTCT CLI   IEHEMAC1,LISTMASK  IS THIS RETURN FOR LIST OP     S21046 09600002
         BNE   OKEND              DO NOT PRINT LISTING           S21046 09620002
         SR    R5,R5              ZERO REGISTER 5                S21046 09640002
         LH    R5,PARAM4          LOAD THE ACCESS COUNT          S21046 09660002
         CVD   R5,DBLWORD         CONVERT IT TO PACKED DECIMAL   S21046 09680002
         MVC   MSGOUT(MOVE24),ACCESSCT                           S21046 09700002
*                                 MOVE HEADING FOR ACCESS CNT    S21046 09720002
         UNPK  MSGOUT+OFFSET24(MOVE6),DBLWORD+OFFSET5(MOVE3)     S21046 09740002
*                                 UNPACK THE ACCESS COUNT        S21046 09760002
         OI    MSGOUT+OFFSET29,FIXBYTE FIX LAST BYTE OF COUNT    S21046 09780002
         SR    PARAMREG,PARAMREG  ZERO OUT REGISTER 0            S21046 09800002
         L     LINKREG,MSGRTNAD   ADDRESS OF MESSAGE WRITER      S21046 09820002
         BALR  RETURN,LINKREG     BRANCH TO THE MESSAGE WRITER   S21046 09840002
         MVC   MSGOUT(MOVE21),MODEBYTE MOVE HEADER FOR MOBE BYTE S21046 09860002
         TM    PARAM4+OFFSET2,CONTROL                            S21046 09880002
*                                 IS THIS A CONTROL PASSWORD     S21046 09900002
         BC    1,CONBIT           GO PUT IN CONTROL              S21046 09920002
         MVC   MSGOUT+OFFSET21(MOVE12),SECNDRY                   S21046 09940002
*                                 MOVE SECONDARY TO MESSAGE      S21046 09960002
         B     TESTNEXT           SKIP NEXT INSTRUCTION          S21046 09980002
CONBIT   MVC   MSGOUT+OFFSET21(MOVE12),CONTRL                    S21046 10000002
*                                 MOVE CONTROL TO MESSAGE        S21046 10020002
TESTNEXT TM    PARAM4+OFFSET2,RW  READ WRITE PROTECTION          S21046 10040002
         BC    1,RWBIT            IF SO GO MOVE READ/WRITE       S21046 10060002
         MVC   MSGOUT+OFFSET33(MOVE9),READ                       S21046 10080002
*                                 MOVE READ TO MESSAGE           S21046 10100002
         B     SR                 SKIP NEXT INSTRUCTION          S21046 10120002
RWBIT    MVC   MSGOUT+OFFSET33(MOVE10),READWRT                   S21046 10140002
*                                 MOVE READ/WRITE TO MESSAGE     S21046 10160002
SR       EQU   *                                                 S21046 10180002
         SR    PARAMREG,PARAMREG  ZERO OUT REGISTER 0            S21046 10200002
         L     LINKREG,MSGRTNAD   ADDRESS OF MESSAGE WRITER      S21046 10220002
         BALR  RETURN,LINKREG     BRANCH TO THE MESSAGE WRITER   S21046 10240002
         MVC   MSGOUT(MOVE19),DATAFILD MOVE DATA AREA HEADER     S21046 10260002
         MVC   MSGOUT+OFFSET19(MOVE77),PARAM4+OFFSET3            S21046 10280002
*                                 MOVE THE DATA TO MSGOUT        S21046 10300002
         SR    PARAMREG,PARAMREG  ZERO OUT REGISTER 0            S21046 10320002
         L     LINKREG,MSGRTNAD   ADDRESS OF MESSAGE WRITER      S21046 10340002
         BALR  RETURN,LINKREG     BRANCH TO THE MESSAGE WRITER   S21046 10360002
         B     OKEND              GO TO NORMAL END ROUTINE       S21046 10380002
*                                                                S21046 10400002
*      LOCATE MACRO FAILED DURING PROTECT, MOVE THE RETURN CODES S21046 10420002
*      TO THE ERROR MESSAGE AND HAVE MESSAGE PRINTED             S21046 10440002
*                                                                S21046 10460002
LOCATFAL MVC   MSGOUT(MOVE77),LOCATMSG MOVE THE LOCATE FAILMSG   S21046 10480002
         CVD   LISTREG,DBLWORD    CONVERT THE RETURN CODE TO DEC S21046 10500002
         UNPK  MSGOUT+OFFSET51(MOVE2),DBLWORD+OFFSET6(MOVE2)     S21046 10520002
*                                 UNPACK CODE TO BE PRINTED      S21046 10540002
         OI    MSGOUT+OFFSET52,FIXBYTE FIX LAST BYTE FOR PRINT   S21046 10560002
         CVD   ZERO,DBLWORD       CONVERT NUMBER INDEX SEARCHED  S21046 10580002
         UNPK  MSGOUT+OFFSET74(MOVE2),DBLWORD+OFFSET6(MOVE2)     S21046 10600002
*                                 UNPACK INDICES TO PRINT        S21046 10620002
         OI    MSGOUT+OFFSET75,FIXBYTE FIX NUMBER TO PRINT       S21046 10640002
MSGWRT   SR    PARAMREG,PARAMREG  ZERO OUT REG 0                 S21046 10660002
MSGRTNA  L     LINKREG,MSGRTNAD   LOAD ADDR OF MESSAGE WRITER  @VS30028 10670003
         BALR  RETURN,LINKREG     GO TO MESSAGE WRITER         @VS30028 10680003
         LA    PARAMREG,MSG64     UNABLE TO UPDATE DSCB        @VS30028 10690003
         B     MSGRTN             ISSUE MESSAGE                 YM07026 10692003
*                                                                S21046 10700002
*      OBTAIN MACRO FAILED DURING PROTECT, MOVE RETURN CODE TO   S21046 10720002
*      ERROR MESSAGE AND HAVE MESSAGE PRINTED                    S21046 10740002
*                                                                S21046 10760002
OBTANFAL MVC   MSGOUT(MOVE54),OBTANMSG MOVE MSG FOR OBTAIN FAILU S21046 10780002
         CVD   LISTREG,DBLWORD    CONVERT THE RETURN CODE TO DEC S21046 10800002
         UNPK  MSGOUT+OFFSET51(MOVE2),DBLWORD+OFFSET6(MOVE2)     S21046 10820002
*                                 UNPACK CODE TO BE PRINTED      S21046 10840002
         OI    MSGOUT+OFFSET52,FIXBYTE  SET UP LAST BYTE TO PRIN S21046 10860002
         B     MSGWRT             GET READY FOR WRITING OF MSG   S21046 10880002
*                                                                S21046 10900002
*      AN I/O ERROR OCCURRED WHILE ACCESSING PASSWORD DATA SET   S21046 10920002
*      ISSUE ERROR MESSAGE                                       S21046 10940002
*                                                                S21046 10960002
IOMPDS   LA    PARAMREG,MSG65     PRINT I/O ERROR MPDS MESSAGE   S21046 10980002
         MVI   ERRFLD+OFFSET1,CODE12  RETURN CODE OF 12          S21046 11000002
         B     MSGRTN             GO ISSUE MESSAGE               S21046 11020002
*                                                                S21046 11040002
*   KEY NOT FOUND IN PASSWORD DATA SET , INITIALIZE TO REISSUE   S21046 11060002
*   WTOR IF MAX ATTEMPTS NOT YET REACHED                         S21046 11080002
*                                                                S21046 11100002
DSNOTFD  LA    R5,RTNCODE8        WTOR FOR PASWORD2              S21046 11120002
         B     DOWNTABL           SET ADDRESS IN TABLE CORRECT   S21046 11140002
*                                                                S21046 11160002
*      EITHER THE CONTROL PASSWORD WAS NOT GIVEN WHEN REQUIRED   S21046 11180002
*      OR WAS INVALID, PREPARE TO ISSUE WTOR                     S21046 11200002
*                                                                S21046 11220002
CPASWD   LA    R5,RTNCOD12        WTOR FOR CPASWORD              S21046 11240002
DOWNTABL L     R9,FINUSE          LOAD ADDRESS IN TABLE          S21046 11260002
         LA    R6,FOUR            AMOUNT TO DECREMENT TABLE ADD  S21046 11280002
         SR    R9,R6              DECREMENT TABLE TO CALL SVC    S21046 11300002
*                                 WHEN WE ARE AT FDLD            S21046 11320002
         ST    R9,FINUSE          STORE THE NEW ADD IN FINUSE    S21046 11340002
         BR    R5                 GO WTOR FOR THE NECESSARY PASW S21046 11360002
*                                                                       11380002
SVCSCR   EQU   *                                                        11400002
         BAL   RETURN,DEVCHECK         GO TO ADJUST DEVICETYPE @ZA06552 11410008
         SR    R0,R0                   ZERO WORK REG           @Z30AAAG 11420003
         ICM   R0,3,UCBAD1             GET UCB ADDR            @Z30AAAG 11421003
         SCRATCH  IEHEMAC1        SCRATCH A DATA SET                    11440002
         B     SVCRET                                                   11460002
SVCRENAM EQU   *                                                        11480002
         BAL   RETURN,DEVCHECK         GO TO ADJUST DEVICETYPE @ZA06552 11480408
         SR    R0,R0                   ZERO WORK REG           @Z30AAAG 11481003
         ICM   R0,3,UCBAD1             GET UCB ADDR            @Z30AAAG 11482003
         RENAME  IEHEMAC1         RENAME A DATA SET                     11520002
         B     SVCRET                                                   11540002
SVCMEMB  EQU   *                  VERIFY THAT DATA SET EXISTS      1513 11560002
         BAL   RETURN,DEVCHECK         GO TO ADJUST DEVICETYPE @ZA06552 11570008
         SR    R0,R0                   CLEAR THE UCB REGISTER  @VS30028X11580003
                                       SINCE NO VOL TO MOUNT   @VS30028 11590003
         RENAME IEHEMAC1          ISSUE RENAME TO SEE IF DATA SET  1513 11600002
         LA    R2,8               EXISTS                           1513 11620002
         CR    R2,15              IS RETURN CODE 8                 1513 11640002
         BNE   SVCRET             NO,BR TO STORE ERROR CODE        1513 11660002
         CLI   PARAM4+13,X'03'    DOES DATA SET EXIST              1513 11680002
         BNE   SVCRET             NO,BR TO STORE ERROR CODE        1513 11700002
         B     MEMBERET           BYPASS STORING ERROR CODE        1513 11720002
DEVCHECK STM   R3,R5,REGSAVE           SAVE REGISTERS          @ZA06552 11720108
         L     R2,IEHEMAC1+12          GET ADDR OF VOLLIST     @ZA06552 11720508
         SR    R3,R3                   ZERO REG 3              @ZA06552 11721008
         LH    R3,0(R2)                NUMBER OF VOLUMES       @ZA06552 11721508
         LTR   R3,R3                   ANY VOLUMES?            @ZA06552 11722008
         BZ    GG                      NO, RETURN              @ZA06552 11722508
         LA    R2,2(R2)         GET ADDR OF FIRST VOLUME ENTRY @ZA06552 11723008
AA       CLC   2(2,R2),USERASS   DIRECT ACC, USER ASSIGN NAME? @ZA06552 11723508
         BNE   FF                  NO, TEST NEXT VOLUME ENTRY  @ZA06552 11724008
         L     R4,16               GET ADDR TO CVT             @ZA06552 11724508
         L     R4,40(R4)           GET ADDR OF UCB LOOKUP TBL  @ZA06552 11725008
BB       SR    R5,R5               ZERO REG 5                  @ZA06552 11725508
         ICM   R5,3,0(R4)          GET UCB ADDR                @ZA06552 11726008
         TM    0(R4),X'FF'         END OF UCB LOOKUP TBL       @ZA06552 11726508
         BNO   CC                  NO, BRANCH                  @ZA06552 11727008
         TM    1(R4),X'FF'       REAL END OF UCB LOOKUP TBL?   @ZA06552 11727508
         BO    FF                  YES, TEST NEXT VOLUME ENTRY @ZA06552 11728008
CC       LTR   R5,R5               IS THIS A ZERO ENTRY        @ZA06552 11728508
         BZ    DD                  YES, BRANCH TO NEXT ENTRY   @ZA06552 11729008
         CLI   18(R5),X'20'        UCB A DIRECT ACCESS ?       @ZA06552 11729508
         BNE   DD                 NO, BRANCH TO NEXT UCB ENTRY @ZA06552 11730008
         CLC   28(6,R5),4(R2)     THE RIGHT VOLUME ?           @ZA06552 11730508
         BE    EE                  YES,BRANCH                  @ZA06552 11731008
DD       LA    R4,2(R4)            UPDATE TO NEXT UCB ENTRY    @ZA06552 11731508
         B     BB                  GO TO CHECK THIS UCB        @ZA06552 11732008
EE       MVC   0(4,R2),16(R5)  MOVE DEVICETYPE TO VOLUME ENTRY @ZA06552 11732508
FF       LA    R2,12(R2)           UPDATE TO NEXT VOLUME ENTRY @ZA06552 11733008
         BCT   R3,AA    BRANCH IF NOT ALL VOLUME ENTRY CHECKED @ZA06552 11733508
GG       LM    R3,R5,REGSAVE       RESTORE REGISTERS           @ZA06552 11733608
         BCR   15,RETURN           RETURN                      @ZA06552 11734008
REGSAVE  DS    3F                  SAVE AREA                   @ZA06552 11734108
USERASS  DC    X'2000'           LAST TWO BYTES OF DEVICETYPE  @ZA06552 11734508
SVCLNKX  LA    R3,PARAM4+2                                         UC0H 11740002
         ST    R3,IEHEMAC1+12                                           11760002
SVCCAT   EQU   *                                                        11780002
         MVI   PARAM2+44,X'40'     PROVIDE BLANK DELIM FOR CATLG   3520 11800002
SVCINDX  EQU   *                                                        11820002
         MVC   IEHERSAV(44),PARAM2  SAVE INDEX OR DSNAME                11840002
      CATALOG  IEHEMAC1     SVC TO BUILDX OR CATALOG                    11860002
         MVC   PARAM2(44),IEHERSAV  RESTORE THE INDEX OR DSNAME         11880002
AFTERCAT EQU   *                                                 A25564 11900002
         CLC   FNSA+1(7),UNCATCON      IS REQUEST UNCATLG?       A25564 11920002
         BNE   SVC26RET                NO, STORE RETURN CODE FROMA25564 11940002
*                                      CATALOG SVC               A25564 11960002
         LA    R2,8                                              A25564 11980002
         CR    R2,15                   RETURN CODE FROM CATALOG  A25564 12040002
*                                      AN 8?                     A25564 12060002
         BE    MEMBERET                YES, BYPASS STORING CODE  A25564 12080002
         LA    R2,16                                             A25564 12100002
         CR    R2,15                   RETURN CODE FROM CATALOG  A25564 12120002
*                                      16?                       A25564 12140002
         BE    MEMBERET                YES,BYPASS STORING CODE @VS30028 12160003
SVC26RET EQU   *                                               @VS30028 12164003
         STC   RTNREG,ERRFLD           SAVE SVC RETURN CODE    @VS30028 12168003
MEMBERET SRL   RTNREG,2                XLATE ERROR RETURN CODE @VS30028 12172003
         L     R2,FINUSE               FROM CATALOG AND INDEX  @VS30028 12176003
         IC    RTNREG,0(RTNREG,R2)     TO MORE SPECIFIC CODES  @VS30028 12180003
         C     RTNREG,=F'9'             IS CATLGD D/S MISSNG   @Z40CSJH 12182008
         BNE   SHIFT                    BR IF NOT              @Z40CSJH 12182408
         C     R0,=F'56'                A SECURITY FAILURE?    @Z40CSJH 12182808
         BNE   SHIFT                    NO,BRANCH              @Z40CSJH 12183608
         LA    RTNREG,X'13'             PRINT MORE APPROP MSG  @Z40CSJH 12183708
SHIFT    SLL   RTNREG,2                FOR THIS OPERATION      @Z40CSJH 12184008
         EX    0,BRANTAB(RTNREG)       TAKE THE PROPER BRANCH  @VS30028 12188003
*                                                              @VS30028 12192003
SVCRET   EQU   *                                                 A25564 12200002
         EX    15,*+4                  POST THE ERROR RETURN     A25564 12220002
         OI    ERRFLD,X'00'            FROM THE SVC              A25564 12240002
         B     MEMBERET                CONTINUE PROCESSING       A25564 12260002
INDEX8   EQU   *                                                 A25564 12340002
         LA    RTNREG,OFFSET80(LISTREG) REG 15 = (REG 1) + 80  @Z40CSJH 12360008
         B     MEMBERET                 GO TRANSLATE CODE      @Z40CSJH 12410008
EXTRACT1 EXTRACT ,'S',FIELDS=(TIOT),MF=L                         S21046 12520002
EXSTP    EQU   *                  ADDRESSABILITY FOR END OF LIST S21046 12540002
*                                                                S21046 12560002
*      PROTECT MESSAGES                                          S21046 12580002
*                                                                S21046 12600002
*   THE FOLLOWING SEVEN MESSAGES ARE PARTS OF THE FORMATTED      S21046 12620002
*   LISTING OF THE USER DATA FIELD OF THE PASSWORD DATA SET      S21046 12640002
*                                                                S21046 12660002
ACCESSCT DC    CL24' DECIMAL ACCESS COUNT = '                    S21046 12680002
MODEBYTE DC    CL21' PROTECT MODE BYTE = '                       S21046 12700002
CONTRL   DC    CL12'CONTROL   , '                                S21046 12720002
SECNDRY  DC    CL12'SECONDARY , '                                S21046 12740002
READWRT  DC    CL10'READ/WRITE'                                  S21046 12760002
READ     DC    CL9'READ ONLY'                                    S21046 12780002
DATAFILD DC    CL19' USER DATA FIELD = '                         S21046 12800002
*   THIS WTOR IS ISSUED WHEN EITHER A PASSWORD IS FOUND TO BE    S21046 12840002
*   INCORRECT OR WAS NOT SUPPLIED ON A CONTROL CARD              S21046 12860002
*                                                                S21046 12880002
WTORLFRM WTOR  'IEH220A JOBNAMES, STEPNAME, CARDNAME, REPLY WITH PASSWOR12900002
               RD',,8,ROUTCDE=(9),DESC=2,MF=L                    S21046 12920002
WTORSTOP EQU   *                                                 S21046 12940002
*                                                                S21046 12960002
*   THE FOLLOWING THREE MESSAGE PARTS ARE USED IN MESSAGES       S21046 12980002
*   IEH228I AND IEH220A TO INDICATE WHICH PASSWORD IS EITHER     S21046 13000002
*   INCORRECT OR WAS NOT SUPPLIED                                S21046 13020002
MSGE1    DC    C'PASWORD1'                                       S21046 13040002
MSGE2    DC    C'PASWORD2'                                       S21046 13060002
MSGE3    DC    C'CPASWORD'                                       S21046 13080002
*                                                                S21046 13100002
*   THIS DATA AREA IS USED TO FOLD ALL OPERATOR REPLIES TO       S21046 13120002
*   CAPITAL LETTERS                                              S21046 13140002
*                                                                S21046 13160002
UPPERFLD DC    X'4040404040404040'                               S21046 13180002
*                                                                S21046 13200002
*   THE FOLLOWING THREE MESSAGES ARE ISSUED WHEN THE OPERATOR    S21046 13220002
*   FAILS TO SUPPLY A CORRECT PASSWORD, THE LOCATE MACRO FAILS , S21046 13240002
*   OR THE OBTAIN MACRO FAILS RESPECTIVELY                       S21046 13260002
*                                                                S21046 13280002
OPFAIL   DC    C'IEH228I INVALID PASSWORD SPECIFIED  '          YA01695 13290002
LOCATMSG DC    C' IEH226I LOCATE MACRO FAILED.  LOCATE RETURN CODE'     13320002
         DC    C' =XX.  INDEXES SEARCHED =XX.'                   S21046 13340002
OBTANMSG DC    C' IEH227I OBTAIN MACRO FAILED.  OBTAIN RETURN CODE'     13360002
         DC    C' =XX.'                                          S21046 13380002
*                                                                       13400002
*                                 ----- MEMBER -----                    13420002
*                                                                       13440002
MEMBER   DS    0F                                                       13460002
         DC    A(SVCMEMB)                                          1513 13480002
         DC    X'00101200'                                         1513 13500002
*                                                                       13520002
*                                 ----- CATALOG -----                   13540002
*                                                                       13560002
CATALOG  DS    0F                                                       13580002
         DC    A(SVCCAT)                                                13600002
         DC    X'0102030005060708'                                      13620002
         DC    FL4'0'                                                   13640002
         DC    FL4'0'                                            A31333 13660002
         DC    X'00001400'                                              13680002
         DC    X'0902050A0B0C0800'                                      13700002
*                                                                       13720002
*                        -----UNCATALOG-----                            13740002
*                                                                       13760002
UNCATLG  DS    0F                                                       13780002
         DC    A(SVCCAT)                                                13800002
         DC    X'010203000E000008'                                      13820002
         DC    FL4'0'                                                   13840002
         DC    FL4'0'                                            A31333 13860002
         DC    X'00001400'                                       A31333 13880002
         DC    X'13020E0A0E0C0800'                             @Z40CSJH 13900008
*                                                                       13920002
*                           -----DELETE INDEX-----                      13940002
*                                                                       13960002
DELETEX  DS    0F                                                       13980002
         DC    A(SVCINDX)                                               14000002
         DC    X'010203040F060008'                                      14020002
         DC    FL4'0'                                                   14040002
         DC    FL4'0'                                            A31333 14060002
         DC    X'00001400'                                       A31333 14080002
         DC    X'13020F000B0C0800'                             @Z40CSJH 14100008
*                                                                       14120002
*                            -----CONNECT -----                         14140002
*                                                                       14160002
CONNECT  DS    0F                                                       14180002
         DC    AL4(SVCLNKX)                                             14200002
         DC    X'0102030000060008'                                      14220002
         DC    FL4'0'                                                   14240002
         DC    FL4'0'                                            A31333 14260002
         DC    X'00001400'                                       A31333 14280002
         DC    X'1302000A0B0C0800'                             @Z40CSJH 14300008
*                                                                       14320002
*                            ------ RELEASE ------                      14340002
*                                                                       14360002
RELEASE  DS    0F                                                       14380002
         DC    AL4(SVCINDX)                                             14400002
         DC    X'010203000F000008'                                      14420002
         DC    FL4'0'                                                   14440002
         DC    FL4'0'                                            A31333 14460002
         DC    X'00001400'                                       A31333 14480002
         DC    X'13020F0A0C0C0800'                             @Z40CSJH 14500008
*                                                                       14520002
*                                 ----- BUILD ALIAS -----               14540002
*                                                                       14560002
BUILDA   DS    0F                                                       14580002
         DC    AL4(SVCINDX)                                             14600002
         DC    X'010203000F060008'                                      14620002
         DC    FL4'0'                                                   14640002
         DC    FL4'0'                                            A31333 14660002
         DC    X'00001400'                                       A31333 14680002
         DC    X'13020F130C0C0800'                             @Z40CSJH 14700008
*                                                                       14720002
*                                 ----- DELETE ALIAS -----              14740002
*                                                                       14760002
DELETEA  DS    0F                                                       14780002
         DC    AL4(SVCINDX)                                             14800002
         DC    X'010203000F060008'                                      14820002
         DC    FL4'0'                                                   14840002
         DC    FL4'0'                                            A31333 14860002
         DC    X'00001400'                                       A31333 14880002
         DC    X'13020F0A0C0C0800'                             @Z40CSJH 14900008
*                                                                       14920002
*                            ----- SCRATCH -----                        14940002
*                                                                       14960002
SCRATCH  DS    0F                                                       14980002
         DC    AL4(SVCSCR)                                              15000002
         DC    X'0110101500'                                     A57261 15020002
*                                                                       15040002
*                            ----- BUILDX -----                         15060002
*                                                                       15080002
BUILDX   DS    0F                                                       15100002
         DC    AL4(SVCINDX)                                             15120002
BLDXERRS DC    X'0102030005060008'                                      15140002
         DC    FL4'0'             RESERVED FOR EXPANSION                15160002
         DC    FL4'0'                                            A31333 15180002
         DC    X'00001400'        ENTRY NUMBER 14 IN BRANTAB     A31333 15200002
         DC    X'1302050A0B0C0800'                             @Z40CSJH 15220008
*                                                                       15240002
*                            ----- RENAME -----                         15260002
*                                                                       15280002
RENAME   DS    0F                                                       15300002
         DC    AL4(SVCRENAM)                                            15320002
         DC    X'0110101500'                                     A57261 15340002
*                                                                       15360002
*                                                                S21046 15380002
*                            ----- ADD -----                     S21046 15400002
*                                                                S21046 15420002
ADD      DS    0F                                                S21046 15440002
         DC    FL1'12'            PUT CODE IN PARM               S21046 15460002
         DC    FL3'1'             ADD CODE                       S21046 15480002
         DC    X'0B'              IS PASWORD2 IN PARAM LIST      S21046 15500002
         DC    FL3'0'             FILLER                         S21046 15520002
         DC    A(SVCPRO)          ISSUE PROTECT SVC (SVC 98)     S21046 15540002
*                                                                S21046 15560002
*                            ----- DELETEP -----                 S21046 15580002
*                                                                S21046 15600002
DELETEP  DS    0F                                                S21046 15620002
         DC    FL1'12'            PUT CODE IN PARM               S21046 15640002
         DC    FL3'3'             DELETEP CODE                   S21046 15660002
         DC    X'0A'              IS PASWORD1 IN PARAM LIST      S21046 15680002
         DC    FL3'0'             FILLER                         S21046 15700002
         DC    A(SVCPRO)          ISSUE PROTECT SVC (SVC 98)     S21046 15720002
*                                                                S21046 15740002
*                            ----- REPLACE -----                 S21046 15760002
*                                                                S21046 15780002
REPLACE  DS    0F                                                S21046 15800002
         DC    FL1'12'            PUT CODE IN PARM               S21046 15820002
         DC    FL3'2'             REPLACE CODE                   S21046 15840002
         DC    X'0A'              IS PASWORD1 IN PARAM LIST      S21046 15860002
         DC    FL3'0'             FILLER                         S21046 15880002
         DC    X'0B'              IS PASWORD2 IN PARAM LIST      S21046 15900002
         DC    FL3'0'             FILLER                         S21046 15920002
         DC    A(SVCPRO)          ISSUE PROTECT SVC (SVC 98)     S21046 15940002
*                                                                S21046 15960002
*                            ----- LIST -----                    S21046 15980002
*                                                                S21046 16000002
LIST     DS    0F                                                S21046 16020002
         DC    FL1'12'            PUT CODE IN PARM               S21046 16040002
         DC    FL3'4'             LIST CODE                      S21046 16060002
         DC    FL1'13'            FILL IN ADDRESS FOR LIST BUFF  S21046 16080002
         DC    FL3'0'             FILLER                         S21046 16100002
         DC    X'0A'              IS PASWORD1 IN PARAM LIST      S21046 16120002
         DC    FL3'0'             FILLER                         S21046 16140002
         DC    A(SVCPRO)          ISSUE PROTECT SVC (SVC 98)     S21046 16160002
BADSCR   EQU   *                                                        16180002
         DC    FL1'6'                                                   16200002
         DC    FL1'1'                                                   16220002
         DC    FL2'14'                                                  16240002
         DC    FL1'6'                                                   16260002
         DC    FL2'35'                                                  16280002
         DC    FL1'15'                                                  16300002
ABEOJ    DC    FL1'6'                                                   16320002
         DC    FL1'1'                                                   16340002
         DC    FL2'16'                                                  16360002
         DC    FL1'6'                                                   16380002
         DC    FL1'2'                                                   16400002
         DC    FL2'17'                                                  16420002
         DC    X'09000000'                                              16440002
OKEND    BAL   LISTREG,ENT2FDLD                                         16460002
NORMEND  EQU   *                                                        16480002
         DC    FL1'6'              SELECT A MESSAGE                     16500002
         DC    FL1'1'              SUPPRESS PRINT                       16520002
         DC    FL2'9'              MSG NUM   = 9                        16540002
         DC    FL1'6'                                                   16560002
         DC    FL2'33'             INSERT FUNCTION NAME                 16580002
         DC    FL1'5'              AND WRITE THE MSG                    16600002
         DC    X'09000000'                                              16620002
         DS    0F                                                       16640002
NOVOL    BAL   LISTREG,ENT2FDLD                                         16660002
VOLREM   EQU   *                                                        16680002
         DC    FL1'6'                                                   16700002
         DC    FL1'1'              SELECT AND SUPPRESS                  16720002
         DC    FL2'11'             MESSAGE 11                           16740002
         DC    FL1'6'                                                   16760002
         DC    X'0200'             TACK ON MSG 17 AND  WRITE IT         16780002
         DC    FL1'17'                                                  16800002
         DC    X'09000000'                                              16820002
*                                                                       16840002
*        FOR THE HANDLING OF UNKNOWN ERRORS......                       16860002
*                                                                       16880002
         DS    0F                                                       16900002
UNKERR   BAL   LISTREG,ENT2FDLD                                         16920002
OVERSIZE EQU   *                                                        16940002
         DC    FL1'6'                                                   16960002
         DC    FL3'12'            INFORM THE USER OF AN ERROR           16980002
         DC    FL1'6'             AND THE UNDEFINED CODE                17000002
         DC    FL1'1'                                                   17020002
         DC    FL2'4'                                                   17040002
         DC    FL1'4'                                                   17060002
         DC    AL3(ABEOJ+4)                                             17080002
INTERR8  EQU   *                                                        17100002
         BALR  R7,0                                                     17120002
         USING *,R7                                                     17140002
         L     R10,CSECT2AD                                             17160002
         DROP  R7                                                       17180002
         NC    PARAM4(2),PARAM4                                         17200002
         BZ    ENDERR                                                   17220002
         LA    R3,12                                                    17240002
         LH    R4,PARAM4          NUMBER OF VOLUMES                     17260002
         MR    R2,R4              MULTIPLIED BY TWELVE                  17280002
         BCTR  R4,ZERO                                                  17300002
         STH   R4,PARAM4          DECREASE THE VOLUME COUNT             17320002
         LA    R3,PARAM4-6(R3)    POINT AT A VOLUME I.D.                17340002
         MVC   MSGOUT+12(6),0(R3) PUT THE VOL I.D. INTO MESSAGE         17360002
         MVI   MSGOUT+93,C'*'                                           17380002
         MVC   MSGOUT+94(2),MSGOUT+93                                   17400002
         IC    R2,7(R3)                                                 17420002
         SLL   R2,2                                                     17440002
         EX    0,*+4(R2)          GO TO THE PROPER ERROR ROUTINE        17460002
*                                                              @VS30028 17462003
* THE FOLLOWING BRANCH TABLE IS USED TO HANDLE VOLUME LIST     @VS30028 17464003
* RETURN CODES FROM RENAME AND SCRATCH AND THE INTERPRETED     @VS30028 17466003
* (VIA THE TABLE LABELED 'STOWTAB') STOW ERROR RETURN CODES.   @VS30028 17468003
*                                                              @VS30028 17470003
SCRESTBL EQU   *                       SCRATCH/RENAME/STOW     @VS30028X17472003
                                       BRANCH TABLE            @VS30028 17474003
         B     NOERR                                                    17480002
         B     ERR1                                                     17500002
         B     ERR2                                                     17520002
         B     ERR3                                                     17540002
         B     IOERR                                                    17560002
         B     NOVOLUME                                                 17580002
         B     NOVOLUME                                                 17600002
         B     DSOPEN                  SCRATCH/RENAME ISSUED   @VS30028X17620003
                                       WHILE DATA SET WAS OPEN @VS30028 17630003
         B     RC8TEST                 GO TEST RETURN CODE     @Z40RSDSX17640008
                                       FROM SCRATCH OR RENAME  @Z40RSDS 17650008
         DC    F'0'                    RESERVED FOR CODE X'09' @G32DSFS 17660032
         B     DSNOTOP                 DATA SET NOT OPENED     @VS30028 17665003
         B     PDSFULL                 DIRECTORY IS FULL       @Z40RSDS 17666008
         B     NOCORE                  GETMAIN FAILED IN STOW  @Z40RSDS 17670008
*                                                              @VS30028 17675003
NOERR    MVC   MSGOUT+91(6),MSGOUT+90                                   17680002
         CNOP  0,4                                                      17700002
         BAL   LISTREG,ENT2FDLD                                         17720002
         DC    FL1'6'                                                   17740002
         DC    FL1'1'                                                   17760002
         DC    FL1'28'                                                  17780002
         DC    FL1'5'                                                   17800002
         DC    FL1'6'                                                   17820002
         DC    FL2'43'                                                  17840002
         DC    FL1'23'                                                  17860002
         DC    A(INTERR8)                                               17880002
         DS    0F                                                       17900002
ERR1     EQU   *                                                        17920002
         BAL   LISTREG,ENT2FDLD                                         17940002
         DC    FL1'6'                                                   17960002
         DC    FL1'1'                                                   17980002
         DC    FL1'28'                                                  18000002
         DC    FL1'28'                                                  18020002
         DC    FL1'6'                                                   18040002
         DC    FL2'43'                                                  18060002
         DC    FL1'24'                                                  18080002
         DC    A(INTERR8)                                               18100002
         DS    0F                                                       18120002
ERR2     EQU   *                                                        18140002
         BAL   LISTREG,ENT2FDLD                                         18160002
         DC    FL1'6'                                                   18180002
         DC    FL1'1'                                                   18200002
         DC    FL1'28'                                                  18220002
         DC    FL1'28'                                                  18240002
         DC    FL1'6'                                                   18260002
         DC    FL2'43'                                                  18280002
         DC    FL1'25'                                                  18300002
         DC    A(INTERR8)                                               18320002
         DS    0F                                                       18340002
ERR3     EQU   *                                                        18360002
         TM    IEHEMAC1+2,X'40'                                         18380002
         BO    SCR4                                                     18400002
REN4     BAL   LISTREG,ENT2FDLD                                         18420002
         DC    FL1'6'                                                   18440002
         DC    FL1'1'                                                   18460002
         DC    FL1'28'                                                  18480002
         DC    FL1'28'                                                  18500002
         DC    FL1'6'                                                   18520002
         DC    FL2'43'                                                  18540002
         DC    FL1'27'                                                  18560002
         DC    A(INTERR8)                                               18580002
         DS    0F                                                       18600002
SCR4     EQU   *                                                        18620002
         BAL   LISTREG,ENT2FDLD                                         18640002
         DC    FL1'6'                                                   18660002
         DC    FL1'1'                                                   18680002
         DC    FL1'28'                                                  18700002
         DC    FL1'28'                                                  18720002
         DC    FL1'6'                                                   18740002
         DC    FL2'43'                                                  18760002
         DC    FL1'26'                                                  18780002
         DC    A(INTERR8)                                               18800002
         DS    0F                                                       18820002
IOERR    BAL   LISTREG,ENT2FDLD                                         18840002
         DC    FL1'6'                                                   18860002
         DC    FL1'1'                                                   18880002
         DC    FL1'28'                                                  18900002
         DC    FL1'28'                                                  18920002
         DC    FL1'6'                                                   18940002
         DC    FL2'43'                                                  18960002
         DC    FL1'29'                                                  18980002
         DC    A(INTERR8)                                               19000002
         DS    0F                                                       19020002
NOVOLUME EQU   *                                                        19040002
         BAL   LISTREG,ENT2FDLD                                         19060002
         DC    FL1'6'                                                   19080002
         DC    FL1'1'                                                   19100002
         DC    FL1'28'                                                  19120002
         DC    FL1'28'                                                  19140002
         DC    FL1'6'                                                   19160002
         DC    FL2'43'                                                  19180002
         DC    FL1'50'                                                  19200002
         DC    A(INTERR8)                                               19220002
         DS    0F                                                       19240002
DSOPEN   EQU   *                       SCR/RENAME RTN CODE 7   @VS30028 19241003
         BAL   LISTREG,ENT2FDLD        GET NEXT ENTRY IN TABLE @VS30028 19242003
         DC    FL1'6'                  PRINT A MESSAGE         @VS30028 19243003
         DC    FL1'1'                  SUPRESS PRINT           @VS30028 19244003
         DC    FL1'28'                 PRINT POSITION 28       @VS30028 19245003
         DC    FL1'28'                 MESSAGE NUMBER 28       @VS30028 19246003
         DC    FL1'6'                  PRINT A MESSAGE         @VS30028 19247003
         DC    FL2'43'                 PRINT POSITION 43       @VS30028 19248003
         DC    FL1'75'                 MESSAGE NUMBER 75       @VS30028 19249003
         DC    A(INTERR8)              ROUTINE ADDRESS         @VS30028 19250003
         DS    0F                      ALIGN TO FULLWORD       @VS30028 19251003
DSNOTOP  EQU   *                                                 A33374 19260002
         BAL   LISTREG,ENT2FDLD                                  A33374 19280002
         DC    FL1'6'                  PRINT A MESSAGE           A33374 19300002
         DC    FL1'1'                  SUPRESS PRINT             A33374 19320002
         DC    FL1'28'                 PRINT POSITION 28         A33374 19340002
         DC    FL1'28'                 MESSAGE NUMBER 28         A33374 19360002
         DC    FL1'6'                  PRINT A MESSAGE           A33374 19380002
         DC    FL2'43'                 PRINT POSITION 43         A33374 19400002
         DC    FL1'70'                 MESSAGE NO 70             A33374 19420002
         DC    A(INTERR8)                                        A33374 19440002
         DS    0F                      GET BOUNDRY ALIGNMENT     A33374 19460002
NOCORE   EQU   *                                                 A33374 19480002
         BAL   LISTREG,ENT2FDLD                                  A33374 19500002
         DC    FL1'6'                  PRINT A MESSAGE           A33374 19520002
         DC    FL1'1'                  SUPRESS PRINT             A33374 19540002
         DC    FL1'28'                 PRINT POSITION 28         A33374 19560002
         DC    FL1'28'                 MESSAGE NUMBER 28         A33374 19580002
         DC    FL1'6'                  PRINT A MESSAGE           A33374 19600002
         DC    FL2'43'                 PRINT POSITION 43         A33374 19620002
         DC    FL1'71'                 MESSAGE NO 71             A33374 19640002
         DC    A(INTERR8)                                        A33374 19660002
         DS    0F                      GET BOUNDRY ALIGNMENT     A33374 19680002
SCRERR8  EQU   *                       SCRATCH RAC ERROR       @Z40RSDS 19681008
         BAL   LISTREG,ENT2FDLD        GET NEXT ENTRY IN TABLE @Z40RSDS 19682008
         DC    FL1'6'                  PRINT A MESSAGE         @Z40RSDS 19683008
         DC    FL1'1'                  SUPRESS PRINT           @Z40RSDS 19684008
         DC    FL1'28'                 PRINT POSITION 28       @Z40RSDS 19685008
         DC    FL1'28'                 MESSAGE NUMBER 28       @Z40RSDS 19686008
         DC    FL1'6'                  PRINT A MESSAGE         @Z40RSDS 19687008
         DC    FL2'43'                 PRINT POSITION 43       @Z40RSDS 19688008
         DC    FL1'77'                 MESSAGE NUMBER 77       @Z40RSDS 19689008
         DC    A(INTERR8)              ROUTINE ADDRESS         @Z40RSDS 19690008
         DS    0F                      ALIGN TO FULLWORD       @Z40RSDS 19691008
PDSFULL  EQU   *                                                 YM5076 19700002
         BAL   LISTREG,ENT2FDLD                                  YM5076 19720002
         DC    FL1'6'                  PRINT A MESSAGE           YM5076 19740002
         DC    FL1'1'                  SUPRESS PRINT             YM5076 19760002
         DC    FL1'28'                 PRINT POSITION 28         YM5076 19780002
         DC    FL1'28'                 MESSAGE NUMBER 28         YM5076 19800002
         DC    FL1'6'                  PRINT A MESSAGE           YM5076 19820002
         DC    FL2'43'                 PRINT POSITION 43         YM5076 19840002
         DC    FL1'73'                 MESSAGE NUMBER 73         YM5076 19860002
         DC    A(INTERR8)                                        YM5076 19880002
         DS    0F                                                YM5076 19900002
*                                                              @Z40RSDS 19901008
* THE FOLLOWING CODE TRIES TO DETERMINE IF THE RETURN CODE OF  @Z40RSDS 19902008
* 8 WAS RETURNED BY SCRATCH OR RENAME.  IF THE FIRST 3 BYTES   @Z40RSDS 19903008
* OF IEHEMAC1 ARE EITHER X'410040' OR X'410050', THEN THE 8    @Z40RSDS 19904008
* WAS RETURNED BY SCRATCH.  IF THE FIRST 3 BYTES OF IEHEMAC1   @Z40RSDS 19905008
* ARE X'C10020', THEN THE 8 WAS RETURNED BY RENAME.            @Z40RSDS 19906008
*                                                              @Z40RSDS 19907008
RC8TEST  EQU   *                       TEST RETURN CODE OF 8   @Z40RSDS 19908008
         TM    IEHEMAC1+D2,SCRMASK     TEST IF SCRATCH OPTION  @Z40RSDS 19909008
         BO    SCRERR8                 BRANCH IF SCRATCH       @Z40RSDS 19910008
         CNOP  0,4                     ALIGN TO FULLWORD       @Z40RSDS 19911008
RENERR8  EQU   *                       RENAME RAC ERROR        @Z40RSDS 19912008
         BAL   LISTREG,ENT2FDLD        GET NEXT ENTRY IN TABLE @Z40RSDS 19913008
         DC    FL1'6'                  PRINT A MESSAGE         @Z40RSDS 19914008
         DC    FL1'1'                  SUPRESS PRINT           @Z40RSDS 19915008
         DC    FL1'28'                 PRINT POSITION 28       @Z40RSDS 19916008
         DC    FL1'28'                 MESSAGE NUMBER 28       @Z40RSDS 19917008
         DC    FL1'6'                  PRINT A MESSAGE         @Z40RSDS 19918008
         DC    FL2'43'                 PRINT POSITION 43       @Z40RSDS 19919008
         DC    FL1'78'                 MESSAGE NUMBER 78       @Z40RSDS 19919208
         DC    A(INTERR8)              ROUTINE ADDRESS         @Z40RSDS 19919408
         DS    0F                      ALIGN TO FULLWORD       @Z40RSDS 19919608
ENDERR   EQU   *                                                        19920002
         BAL   LISTREG,ENT2FDLD                                         19940002
         DC    FL1'6'                                                   19960002
         DC    FL1'1'                                                   19980002
         DC    FL2'30'                                                  20000002
         DC    FL1'4'                                                   20020002
         DC    AL3(ABEOJ+4)                                             20040002
         DS    0F                                                       20060002
RESCR8   EQU   *                                                        20080002
         BAL   LISTREG,ENT2FDLD                                         20100002
         DC    FL1'6'                                                   20120002
         DC    FL1'1'                                                   20140002
         DC    FL2'20'                                                  20160002
         DC    FL1'6'                                                   20180002
         DC    FL1'3'                                                   20200002
         DC    FL2'5'                                                   20220002
         DC    FL1'6'                                                   20240002
         DC    FL1'3'                                                   20260002
         DC    FL2'21'                                                  20280002
         DC    FL1'6'                                                   20300002
         DC    FL1'2'                                                   20320002
         DC    FL2'7'                                                   20340002
         DC    FL1'6'                                                   20360002
         DC    FL2'10'                                                  20380002
         DC    FL1'22'                                                  20400002
         DC    A(INTERR8)                                               20420002
VTOCDCS  DS    0F                 ALLIGN THE LIST                       20440002
         DC    A(TST4VTOC)                                              20460002
         DC    A(OPENVTOC)                                              20480002
         DC    FL1'6'                                                   20500002
         DC    FL1'1'                                                   20520002
         DC    FL2'36'                 PRINT MSG36                      20540002
         DC    FL1'6'                                                   20560002
         DC    FL1'2'                                                   20580002
         DC    FL2'33'                                                  20600002
         DC    FL1'6'                                                   20620002
         DC    FL1'1'                                                   20640002
         DC    FL1'30'                                                  20660002
         DC    FL1'22'                                                  20680002
         DC    FL1'6'                                                   20700002
         DC    FL2'17'                                                  20720002
         DC    FL1'32'                                                  20740002
RPTVTOC  DC    A(GETADSCB)        GO GET A DSNAME                       20760002
         DC    FL1'6'              PUT THE DATA SET                     20780002
         DC    FL1'1'              NAME INTO THE                        20800002
         DC    FL2'7'              MSG OUTPUT AREA                      20820002
         DC    A(SVCSCR)          GO SCRATCH THE DATA SET               20840002
         DC    X'11001100'                                              20860002
TST4VTOC EQU   *                                                        20880002
         BALR  R7,0                                                     20900002
         USING *,R7                                                     20920002
         L     R10,CSECT2AD                                             20940002
         DROP  R7                                                       20960002
         TM    IEHEMAC1,X'40'      VOLUME PRESENT                       20980002
         BZ    *+16                NO... BRANCH                         21000002
         CLI   PARAM4+1,X'01'                                           21020002
         BH    TRUNCVOL            TOO MANY VOLUMES TRUNCATE THE LIST   21040002
         BE    VOLOK                                                    21060002
         LA    LISTREG,BADSCR      NO VOLUME --- TERMINATE              21080002
         B     ENT2FDLD                                                 21100002
TRUNCVOL LA    R3,1                                                     21120002
         STH   R3,PARAM4                                                21140002
         LA    ZERO,35             INFORM THE USER                      21160002
         L     LINKREG,MSGRTNAD    THAT THE VOLUME LIST                 21180002
         BALR  RETURN,LINKREG      IS TRUNCATED                         21200002
         OI    ERRFLD,X'08'            STORE RETURN CODE OF 8    A25564 21220002
VOLOK    B     FDLD                                                     21240002
MEMBEROK CLI   PARAM4+13,X'03'    DOES THE DATA SET EXIST               21260002
         BNE   RESCR8             NO ..... BRANCH                       21280002
OPENVTOC EQU   *                                                        21300002
         BALR  R7,0                                                     21320002
         USING *,R7                                                     21340002
         L     R10,CSECT2AD                                             21360002
         DROP  R7                                                       21380002
         MVI   JFCB,X'04'                                               21400002
         MVC   JFCB+1(43),JFCB    VTOC NAME TO THE JFCB                 21420002
         MVI   JFCB+44,C' '                                             21440002
         MVI   JFCB+45,X'00'                                            21460002
         MVC   JFCB+46(147),JFCB+45         BUILD A JFCB                21480002
         MVC   JFCBVOL(6),PARAM4+6      PUT VOLUME ID IN JFCB           21500002
         MVI   JFCBVOL+6,C' '      BLANK IN THE NEXT VOL I.D.           21520002
         MVC   JFCBVOL-1(1),PARAM4+1    PUT VOLUME COUNT IN JFCB        21540002
         OI    JFCB+DWOFFSET,DNWBBIT   TURN ON THE 'DO NOT WRITE A38610 21560002
*                                      BACK' BIT IN THE JFCB     A38610 21580002
         LA    R3,DBLWORD                                               21600002
         IC    R4,EXLST2                                                21620002
         ST    R3,EXLST2                                                21640002
         STC   R4,EXLST2                                                21660002
         LA    R3,JFCB            FOR OPENJ                             21680002
         ST    R3,DBLWORD                                               21700002
         MVI   DBLWORD,X'87'      MAKE IT THE LAST ENTRY                21720002
         TM    DUPSW,X'08'        WAS MEMBER SPECIFIED                  21740002
         BZ    DOOPEN             NO ..... BRANCH                       21760002
         MVC   JFCB(44),PARAM2    PUT DATA SET NAME IN THE JFCB         21780002
DOOPEN   OPEN  ((R3),INOUT),TYPE=J     OPEN VTOC OR DATA SET            21800002
         ORG   *-18                                                     21820002
         LA    1,FULLWORD                                               21840002
         LA    R3,DCB4VTOC                                              21860002
         ORG                                                            21880002
         TM    DCB4VTOC+48,X'10'       IS DCB OPEN               A43352 21900002
         BNZ   GOODOPEN                BRANCH AROUND ERROR       A43352 21920002
         LA    RTNREG,CODEA            SET  CODE TO X'0A' TO   @VS30028X21940003
                                       CORRESPOND TO STOWTAB   @VS30028 21950003
         B     STOWCODE                GO TO ERROR ROUTINE       A43352 21960002
GOODOPEN EQU   *                                                 A43352 21980002
         OI    CTRLWORD,X'10'          INDICATE VTOC OPENED    @ZA01695 21990008
         LA    R2,VTOCERR                                               22000002
         XC    57(3,R3),57(R3)         PRESERVE                  M2422  22020002
*                                         IOB LENGTH BYTE WHEN   M2422  22040002
         O     R2,56(R3)                 RESETING                M2422  22060002
*                                          SYNAD IN THE DCB      M2422  22080002
         ST    R2,56(R3)               STORE SYNAD                      22100002
         LA    R2,VTOCEND                                               22120002
         ST    R2,FULLWORD                                              22140002
         MVC   33(3,R3),FULLWORD+1     STORE EODAD                      22160002
         TM    DUPSW,X'08'        WAS A MEMBER SPECIFIED                22180002
         BZ    FDLD               NO ..... BRANCH                       22200002
DOSTOW   MVC   EOCORE+8(8),PARAM3  PUT NEWNAME IN PARAMETER LIST        22220002
         LA    1,DCB4VTOC         SET THE DCB ADDRESS                   22240002
         LA    0,EOCORE           SET THE PARAMETER LIST ADDRESS        22260002
         LCR   0,0                SET DELETE ON                         22280002
         TM    DUPSW,X'20'        WAS NEWNAME SPECIFIED                 22300002
         BZ    STOW               NO ..... BRANCH              @ZA13801 22320008
         CLI   PARAM3-1,X'07'          NEWNAME EXCEEDS 8 CHAR  @ZA13801 22326008
         BH    INVALID                 YES, GIVE ERROR MSG     @ZA13801 22332008
         LCR   1,1                SET RENAME ON                         22340008
STOW     STOW  (1),(0),A          STOW WITH DELETE OR CHANGE            22360008
         ST    15,DBLWORD         SAVE THE RETURN FROM STOW             22380002
         CLOSE ((R3))                                                   22400002
         ORG   *-18                                                     22420002
         LA    1,FULLWORD                                               22440002
         LA    R3,DCB4VTOC                                              22460002
         ORG                                                            22480002
         L     15,DBLWORD          RESTORE THE ERROR CODE               22500002
         SRA   15,2               DID THE OPERATION COMPLETE OK         22520002
         BZ    OKEND              YES ..... BRANCH                      22540002
         IC    15,STOWTAB(15)     TRANSLATE THE ERROR TO BE             22560002
STOWCODE EQU   *                                                 A33374 22580002
         STC   15,PARAM4+13       COMPATIBLE WITH RENAME RETURNS        22600002
         STC   15,ERRFLD               STORE RETURN CODE FOR       M737 22620002
*                                      PROG1 ANALYSIS ROUTINE      M737 22640002
         B     RESCR8             GO TO RENAME ERROR HANDLER            22660002
*                                                                       22680002
INVALID  CLOSE ((R3))                                          @ZA13801 22682008
         CLI   ERRFLD+2,X'08'          CC HIGHER OR EQUAL 8 ?  @ZA13801 22684008
         BNL   EQMORE                  WES,BRANCH              @ZA13801 22686008
         MVI   ERRFLD+2,X'08'          SET COND CODE TO 8.     @ZA13801 22688008
EQMORE   BAL   LISTREG,ENT2FDLD        PRINT MSG               @ZA13801 22690008
         DC    FL1'6'                                          @ZA13801 22692008
         DC    FL3'59'                 MSG 59.                 @ZA13801 22694008
         DC    X'09000000'                                     @ZA13801 22696008
*                                                                       22700002
*                                                                       22720002
GETADSCB EQU   *                                                        22740002
         BALR  R7,0                                                     22760002
         USING *,R7                                                     22780002
         L     R10,CSECT2AD                                             22800002
         DROP  R7                                                       22820002
         READ  VTOCDECB,SF,DCB4VTOC,PARAM2,'S',MF=E                     22840002
         CHECK VTOCDECB                                                 22860002
         OI    FORMATID,X'F0'                                           22880002
         TM    VTOCSW,X'01'                                             22900002
         BO    PAST4                                                    22920002
         CLC   PARAM2(44),JFCB    SEARCH FOR 44HEX' 04'S '              22940002
         BNE   GETADSCB                                                 22960002
         OI    VTOCSW,X'01'       SET VTOC SW                           22980002
         B     GETADSCB                                                 23000002
PAST4    CLI   FORMATID,X'F1'     CHECK FOR  A FORMAT 1                 23020002
         BNE   GETADSCB                                                 23040002
         TM    IEHESW5,X'02'       IS THIS A 'SYS' OPTION REQUEST       23060002
         BZ    NOTSYS                IF NOT---                          23080002
         CLC   PARAM2(36),BADNAME  CHECK FOR NAME TO SCRATCH            23100002
         BE    NOTSYS                                              000E 23120002
         CLC   PARAM2(3),SYSNAME       DOES DSNAME BEGIN WITH SYS. 000E 23140002
         BNE   GETADSCB             IF NOT---                           23160002
         CLI   PARAM2+D25,BLANK        IS COL 26 BLANK             WG0I 23180002
         BE    GETADSCB                BRANCHH IF YES.             000E 23200002
*                                                                  WG0I 23220002
*        CHECK FOR NUMERICS IN NNNNN AND .T OF SYSNNNNN.T          WG0I 23240002
*                                                                  WG0I 23260002
         LA    R,5                     INDEX THRU NNNNN FIELD      WG0I 23280002
NUMCHK   LA    S,PARAM2+2(R)           S PTS TO LAST IN FIELD      WG0I 23300002
         CLI   D0(S),CZERO             CHECK FOR LOW FOR NUMERIC   WG0I 23320002
         BL    GETADSCB                TOO LOW FOR NUMERIC         WG0I 23340002
         CLI   D0(S),C9                CHECK FOR HIGH FOR NUMERIC  WG0I 23360002
         BH    GETADSCB                TOO HIGH FOR NUMERIC        WG0I 23380002
         BCT   R,NUMCHK                LOOP THRU FIVE TIMES        WG0I 23400002
*                                                                  WG0I 23420002
         CLC   PARAM2+D8(L2),DOTTEE                                WG0I 23440002
         BNE   GETADSCB                NOT SYSTEM NAME             WG0I 23460002
*                                                                  WG0I 23480002
         CLI   PARAM2+18,C'A'          WAS DSCB CREATED BY VS2. YL026VC 23500002
         BE    NOTSYS                 NEW SYSTEM GENERATED NAME.   000E 23520002
         CLI   PARAM2+18,C'F'         WAS DSCB CREATED BY MFT.     000E 23540002
         BE    NOTSYS                  NEW SYSTEM GENERATED NAME   WG0I 23560002
         CLI   PARAM2+D18,VEE          WAS DSCB CREATED BY MVT     WG0I 23580002
         BNE   GETADSCB                BRANCH IF NOT.              000E 23600002
NOTSYS   EQU   *                       SYSTEM GENERATED NAME   @VS30028 23610003
         MVI   PARAM2-1,L43            SET THE LENGTH TO 43    @VS30028 23620003
         B     FDLD                    GO SCRATCH THE DATA SET @VS30028 23630003
DOTTEE   DC    C'.T  '                 TEMPORARY DS NAME           WG0I 23640002
D0       EQU   0                                                   WG0I 23660002
D2       EQU   2                                                   WG0I 23680002
D8       EQU   8                                                   WG0I 23700002
D18      EQU   18                                                  WG0I 23720002
D25      EQU   25                                                  WG0I 23740002
FIVE     EQU   5                                                   WG0I 23760002
CZERO    EQU   X'F0'                                               WG0I 23780002
C9       EQU   X'F9'                                               WG0I 23800002
L2       EQU   2                                                   WG0I 23820002
L43      EQU   43                      LENGTH OF 43            @VS30028 23830003
VEE      EQU   C'V'                                                WG0I 23840002
SYSNAME  DC    C'SYS '                                             000E 23860002
BADNAME  DC    CL18'AAAAAAAA.AAAAAAAA.'                                 23880002
         DC    CL18'AAAAAAAA.AAAAAAAA.'                                 23900002
*                                                              @VS30028 23904003
* THE FOLLOWING ROUTINE ANALYZES THE RETURN CODE IN THE        @VS30028 23908003
* SCRATCH VOLUME LIST.  THE POSSIBLE RETURN CODES ARE -        @VS30028 23912003
*                                                              @VS30028 23916003
*        X'01' - DATA SET NOT FOUND                            @VS30028 23920003
*        X'02' - PASSWORD ERROR OR                             @VS30028 23924003
*                TRIED TO SCRATCH A VSAM DATA SPACE            @VS30028 23928003
*        X'03' - PURGE DATE NOT PAST                           @VS30028 23932003
*        X'04' - I/O ERROR                                     @VS30028 23936003
*        X'05' - VOLUME NOT VERIFIED AS MOUNTED                @VS30028 23940003
*        X'06' - OPERATOR UNABLE TO MOUNT THE VOLUME           @VS30028 23944003
*        X'07' - DATA SET WAS OPEN                             @VS30028 23948003
*        X'08' - INVALID RAC AUTHORIZATION                     @Z40RSDS 23950008
*                                                              @Z40RSDS 23954008
VTOCRET  EQU   *                                                        23980002
         BALR  R7,0                                                     24000002
         USING *,R7                                                     24020002
         L     R10,CSECT2AD                                             24040002
         DROP  R7                                                       24060002
         CLI   PARAM4+STATUS,ZERO      TEST IF SUCCESSFUL      @VS30028 24080003
         BE    DSCBGONE                BRANCH IF SUCCESSFUL    @VS30028 24100003
         MVI   MSGOUT+113,C'*'                                          24140002
         MVC   MSGOUT+114(2),MSGOUT+113                                 24160002
         CLI   PARAM4+STATUS,PSWDERR   TEST IF D/S NOT FOUND   @VS30028X24162003
                                       OR WRONG PASSWORD ERROR @VS30028 24164003
         BL    NOTFNDDS                BRANCH IF D/S NOT FOUND @VS30028 24166003
         BE    VTOC2                   BRANCH IF BAD PASSWORD  @VS30028 24168003
         CLI   PARAM4+STATUS,IOERROR   TEST IF PURGE DATE NOT  @VS30028X24170003
                                       PAST OR I/O ERROR       @VS30028 24172003
         BL    VTOC3                   BR IF PURGE DATE ERROR  @VS30028 24174003
         BE    VTOC4                   BRANCH IF I/O ERROR     @VS30028 24176003
         CLI   PARAM4+STATUS,OPENDS    TEST IF NO DEVICE ERROR @VS30028X24178003
                                       OR DATA SET WAS OPEN    @VS30028 24180003
         BL    VTOC56                  BRANCH IF NO DEVICE ERR @VS30028 24182003
         BE    VTOC7                   BRANCH IF DATA SET OPEN @Z40RSDS 24184008
         B     VTOC8                   INVALID RACF AUTHORITY  @G32DSFS 24185032
         DS    0F                                                       24280002
DSCBGONE EQU   *                                                        24300002
         BAL   LISTREG,ENT2FDLD                                         24320002
         DC    FL1'6'             SELECT A MESSAGE                      24340002
         DC    FL1'1'             SUPPRESS THE WRITE                    24360002
         DC    FL1'48'            PLACE IT IN PRINT POS. 48             24380002
         DC    FL1'5'             MESSAGE NUMBER 5                      24400002
         DC    FL1'6'             SELECT A MESSAGE                      24420002
         DC    FL2'63'            PLACE IT IN PRINT POS. 63             24440002
         DC    FL1'23'            MESSAGE NUMBER 23                     24460002
         DC    FL1'4'                                                   24480002
         DC    AL3(RPTVTOC)                                             24500002
NOTFNDDS EQU   *                                                 A50977 24520002
         BAL   LISTREG,ENT2FDLD                                  A50977 24540002
         DC    FL1'6'             SELECT A MESSAGE               A50977 24560002
         DC    FL1'1'             SUPPRESS THE WRITE             A50977 24580002
         DC    FL1'48'            PLACE IT IN PRINT POS 48       A50977 24600002
         DC    FL1'28'            USE MESSAGE NUMBER 28          A50977 24620002
         DC    FL1'6'             SELECT A MESSAGE               A50977 24640002
         DC    FL2'63'            PLACE IT IN PRINT POS 63       A50977 24660002
         DC    FL1'72'            USE MESSAGE NUMBER 72          A50977 24680002
         DC    FL1'4'                                            A50977 24700002
         DC    AL3(RPTVTOC)                                      A50977 24720002
VTOC2    EQU   *                                                        24740002
         BAL   LISTREG,ENT2FDLD                                         24760002
         DC    FL1'6'             SELECT A MESSAGE                      24780002
         DC    FL1'1'             SUPPRESS THE WRITE                    24800002
         DC    FL1'48'            PLACE IT IN PRINT POS. 48             24820002
         DC    FL1'28'            WE ARE AFTER MSG NUMBER 28            24840002
         DC    FL1'6'             SELECT A MESSAGE                      24860002
         DC    FL2'63'            PLACE IT IN PRINT POS. 63             24880002
         DC    FL1'25'            MSG NUMBER 25                         24900002
         DC    FL1'4'                                                   24920002
         DC    AL3(RPTVTOC)                                             24940002
VTOC3    EQU   *                       RETURN CODE OF X'03'    @VS30028 24960003
         BAL   LISTREG,ENT2FDLD                                         24980002
         DC    FL1'6'             SELECT A MESSAGE                      25000002
         DC    FL1'1'             SUPPRESS THE WRITE                    25020002
         DC    FL1'48'            PLACE IT IN PRINT POS. 48             25040002
         DC    FL1'28'            WE ARE AFTER MSG NUMBER 28            25060002
         DC    FL1'6'             SELECT A MESSAGE                      25080002
         DC    FL2'63'            PLACE IT IN PRINT POS. 63             25100002
         DC    FL1'26'            MSG NUMBER 26                         25120002
         DC    FL1'4'                                                   25140002
         DC    AL3(RPTVTOC)                                             25160002
VTOC4    EQU   *                       RETURN CODE OF X'04'    @VS30028 25180003
         BAL   LISTREG,ENT2FDLD                                         25200002
         DC    FL1'6'             SELECT A MESSAGE                      25220002
         DC    FL1'1'             SUPPRESS THE WRITE                    25240002
         DC    FL1'48'            PLACE IT IN PRINT POS. 48             25260002
         DC    FL1'28'            WE ARE AFTER MSG NUMBER 28            25280002
         DC    FL1'6'             SELECT A MESSAGE                      25300002
         DC    FL2'63'            PLACE IT IN PRINT POS. 63             25320002
         DC    FL1'29'            MSG NUMBER 29                         25340002
         DC    FL1'4'                                                   25360002
         DC    AL3(RPTVTOC)                                             25380002
VTOC56   EQU   *                       CODE OF X'05' OR X'06'  @VS30028 25380203
         BAL   LISTREG,ENT2FDLD        GET NEXT ENTRY IN TABLE @VS30028 25380403
         DC    FL1'6'                  SELECT A MESSAGE        @VS30028 25380603
         DC    FL1'1'                  SUPPRESS THE WRITE      @VS30028 25380803
         DC    FL1'48'                 PRINT POSITION 48       @VS30028 25381003
         DC    FL1'28'                 MESSAGE NUMBER 28       @VS30028 25381203
         DC    FL1'6'                  SELECT A MESSAGE        @VS30028 25381403
         DC    FL2'63'                 PRINT POSITION 63       @VS30028 25381603
         DC    FL1'76'                 MESSAGE NUMBER 76       @VS30028 25381803
         DC    FL1'4'                  FLAG BYTE               @VS30028 25382003
         DC    AL3(RPTVTOC)            ROUTINE ADDRESS         @VS30028 25382203
VTOC7    EQU   *                       RETURN CODE OF X'07'    @VS30028 25382403
         BAL   LISTREG,ENT2FDLD        GET NEXT ENTRY IN TABLE @VS30028 25382603
         DC    FL1'6'                  SELECT A MESSAGE        @VS30028 25382803
         DC    FL1'1'                  SUPPRESS THE WRITE      @VS30028 25383003
         DC    FL1'48'                 PRINT POSITION 48       @VS30028 25383203
         DC    FL1'28'                 MESSAGE NUMBER 28       @VS30028 25383403
         DC    FL1'6'                  SELECT A MESSAGE        @VS30028 25383603
         DC    FL2'63'                 PRINT POSITION 63       @VS30028 25383803
         DC    FL1'75'                 MESSAGE NUMBER 75       @VS30028 25384603
         DC    FL1'4'                  FLAG BYTE               @VS30028 25384803
         DC    AL3(RPTVTOC)            ROUTINE ADDRESS         @VS30028 25385003
VTOC8    EQU   *                       RETURN CODE OF X'08'    @Z40RSDS 25386008
         BAL   LISTREG,ENT2FDLD        GET NEXT ENTRY IN TABLE @Z40RSDS 25387008
         DC    FL1'6'                  SELECT A MESSAGE        @Z40RSDS 25388008
         DC    FL1'1'                  SUPPRESS THE WRITE      @Z40RSDS 25389008
         DC    FL1'48'                 PRINT POSITION 48       @Z40RSDS 25390008
         DC    FL1'28'                 MESSAGE NUMBER 28       @Z40RSDS 25391008
         DC    FL1'6'                  SELECT A MESSAGE        @Z40RSDS 25392008
         DC    FL2'63'                 PRINT POSITION 63       @Z40RSDS 25393008
         DC    FL1'77'                 MESSAGE NUMBER 77       @Z40RSDS 25394008
         DC    FL1'4'                  FLAG BYTE               @Z40RSDS 25395008
         DC    AL3(RPTVTOC)            ROUTINE ADDRESS         @Z40RSDS 25396008
VTOCERR  EQU   *                                                 A25564 25420002
         OI    ERRFLD,X'12'            STORE RETURN CODE OF 12   A25564 25440002
         CNOP  0,4                     ALIGN TO FULLWORD       @Z40RSDS 25460008
         BAL   LISTREG,ENT2FDLD                                         25480002
         DC    X'08000000'                                              25500002
         DC    FL1'6'                                                   25520002
         DC    FL1'1'                                                   25540002
         DC    FL2'29'                                                  25560002
         DC    FL1'4'                                                   25580002
         DC    AL3(ABEOJ+4)                                             25600002
VTOCEND  BAL   LISTREG,ENT2FDLD                                         25620002
         DC    X'08000000'                                              25640002
         DC    FL1'6'             SELECT A MESSAGE                      25660002
         DC    FL3'34'            EXIT THROUGH HERE                     25680002
*                                                                       25700002
*        WE NEED AN INSERT HERE TO CLOSE THE DCB FOR THE VTOC           25720002
*                                                                       25740002
         DC    X'09000000'                                              25760002
BLDG     DS    0F                                                       25780002
         DC    FL1'7'                  BRANCH TO EXECUTE           4621 25800002
         DC    AL3(MVECT)              MOVE ENTRIES TO LST         4621 25820002
         DC    A(SVCINDX)                                               25840002
         DC    X'0102030005060008'                                      25860002
         DC    FL4'0'                                                   25880002
         DC    FL4'0'                                            A31333 25900002
         DC    X'00001400'                                       A31333 25920002
         DC    X'1302050A0B0C0800'                             @Z40CSJH 25940008
*                                                                       25960002
*        THE FOLLOWING BRANCH TABLE IS USED TO INTERPRET THE            25980002
*        ERROR RETURNS FROM CATALOG AND INDEX  BY CONTROLLING           26000002
*        THE PROGRAM FLOW UPON RETURN FROM THE SUPERVISOR               26020002
*                                 CODE      AFTER TRANSLATION           26040002
BRANTAB  B     UNKERR              00       UNDEFINED ERROR             26060002
         B     OKEND               01       NORMAL E.O.J.               26080002
         B     NOVOL               02       CVOL IS NOT AVAILIBLE       26100002
         B     INDEX8              03       CHECK CODE IN REG 1         26120002
         B     IXNOTMT             04       INDEX NOT EMPTY             26140002
         B     NEEDINDX            05       HAVE TO BUILD AN INDEX      26160002
         B     NOSPACE             06       RAN OUT OF SPACE            26180002
         B     GDGNAME             07       BAD NAME FOR A GENERATION   26200002
         B     IOERRCAT            08       I/O ERROR IN SYSCATLG       26220002
         B     DSFOUNDX            09       NAME IS A DATA SET          26240002
         B     IXFOUNDX            0A       WE FOUND AN INDEX           26260002
         B     NOTIXSTR            0B       NOT AN INDEX STRUCTURE      26280002
         B     SYNTAX              0C       ERROR IN SYNTAX             26300002
         B     SCANIT              0D       BUILD ANOTHER INDEX         26320002
         B     DSNOTCAT            0E       DATA SET NOT CATALOGED      26340002
         B     XNOTHERE            0F       INDEX DOES NOT EXIST        26360002
         B     RESCR8              10       ERROR FROM SVC 29 OR 30     26380002
         B     VTOCRET             11       RETURN FROM SCRATCH VTOC    26400002
         B     MEMBEROK            12       OK TO PROCESS MEMBER        26420002
         B     APROBLEM            13       UNDETERMINABLE ERROR        26440002
         B     VTOCDOS             14       VTOC IS DOS          A31333 26460002
         B     BADVOLST            15       RC=12 FROM SVC29,30  A57261 26480002
*                                                                       26500002
*                                                                       26520002
APROBLEM DS    0F                                                       26540002
         BAL   LISTREG,ENT2FDLD                                         26560002
         DC    FL1'6'              INFORM THE USER THAT                 26580002
         DC    FL3'37'             EITHER HIS REQUEST IS NOT            26600002
         DC    FL1'6'              PROPER OR THAT IT CANNOT             26620002
         DC    FL1'1'              BE SERVICED WITHIN THE               26640002
         DC    FL2'54'             PRESENT CATALOG STRUCTURE            26660002
         DC    FL1'4'                                                   26680002
         DC    AL3(ABEOJ+4)        TAKE THE ABNORMAL EXIT               26700002
*                                                                       26720002
*                                                                       26740002
DSFOUNDX DS    0F                 FOR ALLIGNMENT                        26760002
         BAL   LISTREG,ENT2FDLD     BEGONE...TO DECODE THIS LIST        26780002
         DC    FL1'6'                                                   26800002
         DC    FL3'37'            INFORM THE USER THAT                  26820002
         DC    FL1'6'             A DATA SET HAVING                     26840002
         DC    FL1'1'             THIS NAME IS CATALOGED                26860002
         DC    FL2'7'             AND THIS INDEX CANNOT                 26880002
         DC    FL1'6'             BE BUILT FOR HIM                      26900002
         DC    FL1'3'                                                   26920002
         DC    FL2'38'                                                  26940002
         DC    FL1'4'                                                   26960002
         DC    AL3(ABEOJ+4)       TAKE THE ABNORMAL EXIT                26980002
*                                                                       27000002
*                                                                       27020002
IXNOTMT  DS    0F                  FOR ALLIGNMENT                       27040002
         BAL   LISTREG,ENT2FDLD    BE GONE.....TO DECODE THIS LIST      27060002
         DC    FL1'6'                                                   27080002
         DC    FL3'37'             INFORM THE USER THAT                 27100002
         DC    FL1'6'              THE SPECIFIED INDEX                  27120002
         DC    FL1'1'              IS NOT EMPTY OR HAS                  27140002
         DC    FL2'39'             AN ALIAS.                            27160002
         DC    FL1'4'                                                   27180002
         DC    AL3(ABEOJ+4)        TAKE THE ABNORMAL EXIT               27200002
*                                                                       27220002
*                                                                       27240002
NOSPACE  DS    0F                                                       27260002
         BAL   LISTREG,ENT2FDLD                                         27280002
         DC    FL1'6'                                                   27300002
         DC    FL3'37'             INFORM THE USER THAT                 27320002
         DC    FL1'6'              SYSCATLG DATA SET                    27340002
         DC    FL1'1'              HAS RUN OUT OF SPACE                 27360002
         DC    FL2'40'                                                  27380002
         DC    FL1'4'                                                   27400002
         DC    AL3(ABEOJ+4)        TAKE THE ABNORMAL EXIT               27420002
*                                                                       27440002
*                                                                       27460002
IXFOUNDX DS    0F                                                       27480002
         BAL   LISTREG,ENT2FDLD                                         27500002
         DC    FL1'6'                                                   27520002
         DC    FL3'37'             INFORM THE USER THAT                 27540002
         DC    FL1'6'              THE NAME THAT IS                     27560002
         DC    FL1'1'              SPECIFIED IS CURRENTLY               27580002
         DC    FL2'7'              AN EXISTING INDEX LEVEL              27600002
         DC    FL1'6'                                                   27620002
         DC    FL1'3'                                                   27640002
         DC    FL2'43'                                                  27660002
         DC    FL1'4'                                                   27680002
         DC    AL3(ABEOJ+4)        ABNORMAL EXIT                        27700002
*                                                                       27720002
*                                                                       27740002
SYNTAX   DS    0F                                                       27760002
         BAL   LISTREG,ENT2FDLD                                         27780002
         DC    FL1'6'                                                   27800002
         DC    FL3'37'             INFORM THE USER THAT A               27820002
         DC    FL1'6'              SYNTAX ERROR EXISTS IN               27840002
         DC    FL1'1'              THE SPECIFIED NAME                   27860002
         DC    FL2'46'                                                  27880002
         DC    XL4'06030007'                                            27900002
         DC    FL1'4'                                                   27920002
         DC    AL3(ABEOJ+4)        ABNORMAL EXIT                        27940002
*                                                                       27960002
*                                                                       27980002
GDGNAME  DS    0F                       ALLIGN THE LIST                 28000002
         BAL   LISTREG,ENT2FDLD                                         28020002
         DC    FL1'6'              INFORM THE USER THAT                 28040002
         DC    FL3'37'                                                  28060002
         DC    FL1'6'              HE HAS ATTEMPTED TO                  28080002
         DC    FL1'1'              CATALOG A DATA SET                   28100002
         DC    FL2'7'              NAME THAT IS NOT                     28120002
         DC    FL1'6'              VALID...                             28140002
         DC    FL1'3'                                                   28160002
         DC    FL2'41'                                                  28180002
         DC    FL1'4'                                                   28200002
         DC    AL3(ABEOJ+4)        TAKE THE ABNORMAL EXIT               28220002
*                                                                       28240002
*                                                                       28260002
IOERRCAT DS    0F                                                       28280002
         BAL   LISTREG,ENT2FDLD                                         28300002
         DC    FL1'6'              INFORM THE USER THAT                 28320002
         DC    FL3'37'                                                  28340002
         DC    FL1'6'              A PERMANENT ERROR                    28360002
         DC    FL1'1'              WAS ENCOUNTERED IN                   28380002
         DC    FL2'29'             THE SYSCTLG DATA SET                 28400002
         DC    FL1'6'                                                   28420002
         DC    FL1'3'                                                   28440002
         DC    FL2'42'                                                  28460002
         DC    FL1'4'                                                   28480002
         DC    AL3(ABEOJ+4)        ABNORMAL EXIT                        28500002
*                                                                       28520002
*                                                                       28540002
DSNOTCAT DS    0F                                                       28560002
         BAL   LISTREG,ENT2FDLD                                         28580002
         DC    FL1'6'                                                   28600002
         DC    FL3'37'             INFORM THE USER THAT                 28620002
         DC    FL1'6'              THE SPECIFIED DATA                   28640002
         DC    FL1'1'              SET NAME IS NOT                      28660002
         DC    FL2'7'              CATALOGED.                           28680002
         DC    FL1'6'                                                   28700002
         DC    FL1'3'                                                   28720002
         DC    FL2'47'                                                  28740002
         DC    FL1'4'              TAKE THE ABNORMAL EXIT               28760002
         DC    AL3(ABEOJ+4)                                             28780002
*                                                                       28800002
*                                                                       28820002
XNOTHERE DS    0F                  INFORM THE USER THAT                 28840002
         BAL   LISTREG,ENT2FDLD                                         28860002
         DC    FL1'6'              THE INDEX THAT HE                    28880002
         DC    FL3'37'             HAS SPECIFIED DOES                   28900002
         DC    FL1'6'              NOT EXIST.                           28920002
         DC    FL1'1'                                                   28940002
         DC    FL2'44'                                                  28960002
         DC    FL1'4'                                                   28980002
         DC    AL3(ABEOJ+4)        ABNORMAL EXIT                        29000002
*                                                                       29020002
*                                                                       29040002
NOTIXSTR DS    0F                                                       29060002
         BAL   LISTREG,ENT2FDLD                                         29080002
         DC    FL1'6'                                                   29100002
         DC    FL3'37'                                                  29120002
         DC    FL1'6'              NO SUCH INDEX CAN                    29140002
         DC    FL3'44'             EXIST  THE  NECESSARY                29160002
         DC    FL1'6'              INDEX STRUCTURE  IS                  29180002
         DC    FL1'1'              TERMINATED WITH A DATA               29200002
         DC    FL2'45'             SET.                                 29220002
         DC    FL1'4'                                                   29240002
         DC    AL3(ABEOJ+4)        ABNORMAL EXIT                        29260002
*                                                                A31333 29280002
*     VTOC NOT CONVERTED FROM DOS TO OS , ISSUE MESSAGE IEH230I  A31333 29300002
*                                                                A31333 29320002
VTOCDOS  DS    0F                                                A31333 29340002
         BAL   LISTREG,ENT2FDLD                                  A31333 29360002
         DC    FL1'6'                                            A31333 29380002
         DC    FL3'37'            PRINT MESSAGE 37               A31333 29400002
         DC    FL1'6'                                            A31333 29420002
         DC    FL3'68'            PRINT MESSAGE 68               A31333 29440002
         DC    FL1'6'                                            A31333 29460002
         DC    FL1'1'             SUPRESS PRINT                  A31333 29480002
         DC    FL2'69'            PRINT MESSAGE 69               A31333 29500002
         DC    FL1'4'                                            A31333 29520002
         DC    AL3(ABEOJ+4)                                      A31333 29540002
*                                                                       29560002
BADVOLST EQU   *                                                 A57261 29580002
         BAL   LISTREG,ENT2FDLD                                  A57261 29600002
         DC    FL1'6'             PRINT A MESSAGE                A57261 29620002
         DC    FL1'1'             SUPRESS THE PRINT              A57261 29640002
         DC    FL2'20'            MESSAGE NUMBER 20              A57261 29660002
         DC    FL1'6'             PRINT A MESSAGE                A57261 29680002
         DC    FL1'3'                                            A57261 29700002
         DC    FL2'5'             MESSAGE NUMBER 5               A57261 29720002
         DC    FL1'6'             PRINT A MESSAGE                A57261 29740002
         DC    FL1'3'                                            A57261 29760002
         DC    FL2'21'            MESSAGE NUMBER 21              A57261 29780002
         DC    FL1'6'             PRINT A MESSAGE                A57261 29800002
         DC    FL1'2'                                            A57261 29820002
         DC    FL2'7'             MESSAGE NUMBER 7               A57261 29840002
         DC    FL1'6'             PRINT A MESSAGE                A57261 29860002
         DC    FL2'10'            PRINT POSITION                 A57261 29880002
         DC    FL1'22'            MESSAGE NUMBER 22              A57261 29900002
         DC    A(VOLERMSG)                                       A57261 29920002
VOLERMSG EQU   *                                                 A57261 29972402
         BALR  R7,0                                              A57261 29976202
         USING *,R7                                              A57261 29980002
         L     R10,CSECT2AD                                      A57261 30000002
         DROP  R7                                                A57261 30020002
         MVI   MSGOUT+93,C'*'                                    A57261 30040002
         MVC   MSGOUT+94(2),MSGOUT+93                            A57261 30060002
         BAL   LISTREG,ENT2FDLD                                  A57261 30080002
         DC    FL1'6'             PRINT A MESSAGE                A57261 30100002
         DC    FL1'1'             SUPRESS PRINT                  A57261 30120002
         DC    FL1'28'            PRINT POSITION 28              A57261 30140002
         DC    FL1'28'            MESSAGE NUMBER 28              A57261 30160002
         DC    FL1'6'             PRINT A MESSAGE                A57261 30180002
         DC    FL2'43'            PRINT POSITION 43              A57261 30200002
         DC    FL1'74'            MESSAGE NUMBER 74              A57261 30220002
         DC    A(ENDERR)                                         A57261 30240002
*                                                                       30260002
*        THIS ROUTINE IS USED TO BUILD THE NECCESSARY INDECIES          30280002
*        THAT ARE REQUIRED TO SERVICE A REQUEST FOR CATALOGING          30300002
*        A DATA SET UNDER AN INDEX STRUCTURE THAT DOES NOT PRESENTLY    30320002
*        EXIST ON THE CONTROL VOLUME BEING ACTED UPON.                  30340002
*                                                                       30360002
NEEDINDX ST    R9,FLSTADDR        SAVE THE ORIGINAL SVC LOCATION        30380002
         LA    R3,PARAM2          START ADDRESS                         30400002
         LA    R4,1               INCREMENT                             30420002
         LA    R5,PARAM2+43       STOPADDRESS                           30440002
         STM   R3,R5,IEHESTT      STORE SEARCH DATA                     30460002
SCANIT   LM    R3,R5,IEHESTT      RETRIEVE SEARCH DATA                  30480002
         BXH   R3,R4,FRECOVER     TEST FOR END OF SEARCH                30500002
         ST    R3,IEHESTT         STORE SEARCH DATA                     30520002
         MVC   IEHECODE(1),0(R3)  SAVE THE CHARACTER                    30540002
         CLI   0(R3),C'.'         IS IT A PERIOD                        30560002
         BNE   CHKPAREN           NO .... BRANCH                        30580002
         MVI   0(R3),C' '         REPLACE WITH A BLANK                  30600002
         MVC   IEHEMAC2(4),BLDXBITS                                     30620002
         B     BUILDIT            GO BUILD THE INDEX                    30640002
CHKPAREN CLI   0(R3),C'('         IS IT A LEFT PARENTHESIS              30660002
         BNE   SCANIT             NO .... BRANCH                        30680002
         B     GDGNAME       DO NOT BUILD A GENERATION INDEX            30700002
         MVC   IEHEMAC2(4),BLDGBITS                                     30720002
BUILDIT  EQU   *                                                        30740002
         MVC   IEHEMAC2+4(12),IEHEMAC1+4                                30760002
         TM    IEHEMAC1,X'80'     ARE WE USING A CONTROL VOLUME         30780002
         BZ    *+8                NO ..... BRANCH                       30800002
         OI    IEHEMAC2,X'80'     BUILDX ON A CONTROL VOLUME            30820002
         MVC   IEHERSAV(44),PARAM2      SAVE THE INDEX NAME             30840002
      CATALOG  IEHEMAC2                 SVC TO BUILD THE INDEX          30860002
         MVC   PARAM2(44),IEHERSAV      RESTORE THE INDEX NAME          30880002
         MVC   0(1,R3),IEHECODE    RESTORE THE DELIMITER                30900002
         LA    R3,BXMATRIX                                              30920002
         ST    R3,FINUSE          POINT AT THE MATRIX TO BE USED        30940002
         B     AFTERCAT                FOR ERROR ANALYSIS..BEGONEA25564 30960002
UNCATCON DC    C'UNCATLG'                                        A25564 30980002
BXMATRIX DC    X'0D02030000060008'                                      31000002
         DC    FL4'0'             RESERVED FOR EXPANSION                31020002
         DC    FL4'0'                                            A31333 31040002
         DC    X'00001400'                                       A31333 31060002
         DC    X'0902050D0B0C0800'                                      31080002
*                                                                       31100002
* CONSTANTS AND ADDRESSES                                      @VS30028 31120003
*                                                                       31140003
*                                                              @VS30028 31141003
*        THE FOLLOWING TABLE INTERPRETS THE STOW ERROR RETURN  @VS30028 31142003
*        CODES TO CORRESPOND TO THE SCRATCH/RENAME ERROR CODE  @VS30028 31143003
*        BRANCH TABLE LABELED 'SCRESTBL'. THE INTERPRETED      @VS30028 31144003
*        CODES X'0A' - X'0C' ARE USED BY STOW ALONE.           @Z40RSDS 31145008
*                                                              @VS30028 31146003
*        STOW                              CORRESPONDING       @VS30028 31147003
*        RETURN                            ERROR CODE IN       @VS30028 31148003
*        CODE    EXPLANATION               COMMON TABLE        @VS30028 31149003
*                                                              @VS30028 31150003
*        X'04'   NEW NAME ALREADY EXISTS   X'03'               @VS30028 31151003
*        X'08'   NAME NOT FOUND            X'01'               @VS30028 31152003
*        X'0C'   DIRECTORY IS FULL         X'0B'               @Z40RSDS 31153008
*        X'10'   I/O ERROR OCCURRED        X'04'               @VS30028 31154003
*        X'14'   DCB NOT OPENED            X'0A'               @VS30028 31155003
*        X'18'   GETMAIN UNSUCCESSFUL      X'0C'               @Z40RSDS 31156008
*                                                              @VS30028 31157003
STOWTAB  EQU   *-1                                                      31160002
         DC    X'03010B040A0C'    INTERPRET STOW RETURN CODE   @Z40RSDS 31180008
BLDXBITS DC    X'04400000'        BUILD INDEX                           31200002
BLDGBITS DC    X'04200005'        BUILD GENERATION - FIVE ENTRIES       31220002
DUMP     DCB   DDNAME=DUMPIT,DSORG=PS,RECFM=VBA,BLKSIZE=1632,          X31270002
               LRECL=125,MACRF=(W)                                      31272002
         LTORG                                                 @ZA13801 31275008
         EJECT                                                 @VS30028 31278003
DSECT    DSECT                                                          31280002
IEHECHAR DS    C         CHARACTER TO BE SCANNED FOR                    31300002
IEHECOND DS    C         CONDITION CODE TO STOP ON                      31320002
IEHECODE DS    C                                                        31340002
IEHEARGL DS    C                                                        31360002
IEHESTT  DS    F                                                        31380002
IEHESTP  DS    F                                                        31400002
IEHEFND  DS    F                                                        31420002
IEHETBL  DS    F                                                        31440002
IEHEFUN  DS    F                                                        31460002
IEHESCNX DS    3F                                                       31480002
IEHEMAC1 DS    7F                 PARAMETER LIST                 S21046 31500002
IEHEMAC2 DS    6F                                                       31520002
IEHESTIN DS    F                                                        31540002
IEHENDIN DS    F                                                        31560002
IEHECCNT DS    2C                                                       31580002
IEHESW1  DS    C                                                        31600002
DUPSW    DS    2C                 SWITCHES FOR TEST OF DUPLICATE S21046 31620002
*                                 PARAMETERS                     S21046 31640002
PPARAMSW DS    CL2                                                      31660002
IEHESW5  DS    C                                                        31680002
IEHESW6  DS    C                                                        31700002
IEHECALL DS    F                                                        31720002
         DS    0D                                                       31740002
DBLWORD  DS    F                                                        31760002
FULLWORD DS    F                                                        31780002
         DS    0D                                                       31800002
DECB1    DS    24X                                                      31820002
DECB2    DS    24X                                                      31840002
VOLISTAD DS    F                                                        31860002
MATRIXIU DS    F                                                        31880002
VDTIU    DS    F                                                        31900002
VOLPAREN DS    FL2                                                      31920002
VSRCM    DS    2X                                                       31940002
VDSA     DS    X                                                        31960002
DFLG     DS    X                                                   BS0H 31980002
DFLAG    DS    X                                                   BS0H 32000002
         DS    0F                                                       32020002
FLSTADDR DS    F                                                        32040002
FNSA     DS    12X                                                      32060002
KWSA     DS    12X                                                      32080002
SCANRET  DS    F                                                        32100002
MARESAR  DS    72X                                                      32120002
IEHESPC  DS    XL20                                                     32140002
         DS    XL20                                                     32160002
IEHERSAV DS    64X                                                      32180002
PASSUNIT DS    5X                                                  DT0I 32200002
MOUNTSW  DS    X                                                   DT0I 32220002
TABLEAD  DS    F                  ADDRESS OF DEVICE NAME TABLE     I276 32240002
IEHESW2  DS    X                  PROTECT SWITCHES               S21046 32260002
*                                 BIT 1=1 IF WE ARE TO PRINT     S21046 32280002
*                                        CONTROL CARDS           S21046 32300002
*                                 BIT 3=1 INDICATES FIRST QUOTE  S21046 32320002
*                                        IN SCAN FOR DATA        S21046 32340002
*                                        OPERATION IS FOUND      S21046 32360002
*                                 BIT 4= 1 IF WTOR SETUP IS DONE S21046 32380002
*                                 BIT 6 =1 IF FIRST PARM ENTRY   S21046 32400002
*                                 WAS VALID                      S21046 32420002
*                                 BIT 7 =1 IF INVALID ENTRY MSG  S21046 32440002
*                                 HAS BEEN PRINTED               S21046 32460002
PASWDCT1 DS    1X                 NUMBER OF PROMPTS FOR PASWORD1 S21046 32480002
PASWDCT3 DS    1X                 NUMBER OF PROMPTS FOR CPASWORD S21046 32500002
TOTALPS  DS    1X                 TOTAL NO OF OPERATOR REPLIES   S21046 32520002
WTORECB  DS    1F                 EVENT CONTROL BLOCK FOR WTOR   S21046 32540002
TIOTADRS DS    1F                 TIOT ADDRESS FOR WTOR          S21046 32560002
CCNAME   DS    8C                 NAME OFF CONTROL CARD          S21046 32580002
WTORLIST WTOR  'IEH220A JOBNAMES, STEPNAME, CARDNAME, REPLY WITH PASSWOX32600002
               RD',,8,WTORECB,ROUTCDE=(9),DESC=2,MF=L            S21046 32620002
EXTRACTO EXTRACT ,'S',FIELDS=(TIOT),MF=L                         S21046 32640002
DCBAREA  DS    0F                                                       32660002
UTINDCB  DCB   DSORG=PS,MACRF=(GM)                                      32680002
CODELIST DC    C'.,=()   '        SPECIAL CHARACTERS CODED BY SCAN      32700002
MAXLINES DC    FL2'45'             MAXIMUM LINES PER PAGE               32720002
LINECNT  DC    FL2'0'              LINE COUNT FIELD                     32740002
SKIP21   DC    X'8B'               SKIP TO 1 COMMAND                    32760002
WRITEHDR DC    X'19'               SPACE 3 AFTER PRINT                  32780002
HEADER   DC    CL30'MODIFY....VERSION BETA-1......'                     32800002
         DC    CL30'LAST UPDATED....JULY 11  10 PM'                     32820002
         DC    CL30'                              '                     32840002
         DC    CL30'               PAGE 001       '                     32860002
PAGENUM  EQU   HEADER+110                                               32880002
DDNAMES  DS    3CL8                     FOR THREE DD NAMES              32900002
UTOUTDCB DCB   DSORG=PS,MACRF=(PM)                                      32920002
         DS    2F                                                       32940002
CTRLWORD DS    0F       REG 13 SAVED, SWITCHES FOR VOLUME MOUNTING      32960002
IEHESAT  DS    150X                                                     32980002
READBASE DC    F'0'                                                     33000002
ERRFLD   DS    0CL8          FOR POSTING OF ERROR RETURN CODES          33020002
PARAM1   DS    44X                                                      33040002
         DS    F              FOR  LENGTH OF  PARAM2                    33060002
PARAM2   DS    44X                                                      33080002
         DS    F                   FOR LENGTH OF PARAM3                 33100002
PARAM3   DS    44X                                                      33120002
PARAM5   DS    2F                 CPASWORD PARAMETER             S21046 33140002
PARAM6   DS    151F               VOL IDS PARAMETER              S21046 33160002
PARAM7   DS    2F                 PASSWORD2 PARAMETER            S21046 33180002
PARAM8   DS    80X                DATA PARAMETER                 S21046 33200002
DUMMY    DS    1F                 TEMPORARY STORAGE FIELD        S21046 33220002
PROTCTAD DS    1F                 ADDRESS OF WHERE TO PUT NEXT   S21046 33240002
*                                 VOL ID IN PARAM6 FOR PROTECT   S21046 33260002
FINUSE   DS    F                   ADDR OF DC LIST IN USE               33280002
DCSAVEAD DS    F                   SAVE AREA FOR ADDR OF DC LIST        33300002
INPUT    DS    40F                 TWO CARD INPUT AREA                  33320002
MSGOUT   DS    30F                 MSG OUTPUT AREA                      33340002
         DS    F                                                        33360002
         DS    0D                                                       33380002
PARAM4   DS    151F                FOR A VOLUME LIST                    33400002
EOCORE   EQU   *-12                                                     33420002
         ORG   PARAM4+20                                                33440002
VTOCDCB2 DS    0F                                                       33460002
DCB4VTOC DCB   DDNAME=VTOC,                                            .33480002
               DSORG=PS,                                               .33500002
               MACRF=R,                                                .33520002
               KEYLEN=44,                                              .33540002
               BLKSIZE=1,                                              .33560002
               RECFM=U,                                                .33580002
               EODAD=VTOCEND,                                          .33600002
               SYNAD=VTOCERR,                                          .33620002
               EXLST=VTOCEND                                            33640002
JFCB     DS    24D                                                      33660002
*        THE FOLLOWING ORG STATEMENT IS FLAGGED                  YM5077 33680002
         ORG                                                            33700002
SAVEREG2 DS    72X                SECONDARY SAVE AREA             M2838 33720002
SAVEREG3 DS    72X                THIRD LEVEL SAVE AREA           M2838 33740002
         ORG                                                            33760002
VTOCSW   EQU   JFCB+50                                                  33780002
VTOCDECB EQU   JFCB+60                                                  33800002
JFCBVOL  EQU   JFCB+118                                                 33820002
EXLST2   EQU   DCB4VTOC+36                                              33840002
FORMATID EQU   PARAM2+44                                                33860002
BLANK    EQU   64                                                       33880002
READTOO  EQU   INPUT+72                                                 33900002
COL16    EQU   READTOO+15                                               33920002
COL72    EQU   READTOO+71                                               33940002
MIDDLE   EQU   READTOO-1                                                33960002
WARE2PUT EQU   IEHEMAC1-4                                               33980002
UCBAD1   EQU   IEHESAT+16                                               34000002
         END                                                            34020002
./  ADD  SSI=71450099,NAME=IEHPROG3
   TITLE  'IEHPROGM - IEHPROG3  MESSAGE WRITER MODULE'                  00050002
*********************************************************************** 00100002
*                                                                     * 00150002
* MODULE NAME -- IEHPROG3                                      YL026VC* 00160002
*                                                              YL026VC* 00170002
* DESCRIPTIVE NAME -- IEHPROGM MESSAGE WRITER MODULE           YL026VC* 00180002
*                                                              YL026VC* 00190002
* COPYRIGHT -- NONE                                            YL026VC* 00192002
*                                                              YL026VC* 00194002
* STATUS -- 'IEHPROG3'  OS/VS2 PROLOGUE MODIFICATION           YL026VC* 00200002
*    NOVEMBER 1972                                             YL026VC* 00250002
*                                                              YL026VC* 00260002
* FUNCTION -- THIS MODULE IS THE GENERALIZED MESSAGE WRITER FOR       * 00300002
*    IEHPROGM.                                                        * 00350002
*                                                                     * 00400002
* ENTRY POINTS --                                                     * 00450002
*         IEHPROG3 IS THE ONLY ENTRY POINT FOR THIS MODULE.  IT IS    * 00500002
*    USED WHETHER DIAGNOSTIC MESSAGES OR INFORMATIONAL MESSAGES       * 00550002
*    ARE TO BE PRINTED.                                               * 00600002
*                                                                     * 00650002
* INPUT --INPUT TO IEHPROG3 IS TWOFOLD.  FIRST, REGISTER 0 WILL       * 00700002
*    CONTAIN ALL INFORMATION AS TO WHETHER THE MESSAGE TO BE          * 00750002
*    PRINTED IS AN INFORMATIONAL MESSAGE OR A DIAGNOSTIC MESSAGE,     * 00800002
*    AND SECONDLY, IF THE MESSAGE IS INFORMATIONAL THE MESSAGE        * 00850002
*    TEXT WILL RESIDE IN AN AREA IN A COMMUNICATION REGION.  IF THE   * 00900002
*    MESSAGE IS IN THIS COMMUNICATION AREA, REGISTER 0 WILL CONTAIN   * 00950002
*    INFORMATION TO DETERMINE WHERE THE MESSAGE IS LOCATED.           * 01000002
*                                                                     * 01050002
* OUTPUT -- THE OUTPUT FROM THIS PART OF IEHPROGM IS THE WRITING      * 01100002
*    OR PRINTING OF THE MESSAGE REQUESTS FROM THE OTHER MODULES       * 01150002
*    OF IEHPROGM.                                                     * 01200002
*                                                                     * 01250002
* EXTERNAL REFERENCES -- THIS ROUTINE HAS NO EXTERNAL ROUTINES.       * 01300002
*                                                                     * 01350002
* EXITS, NORMAL -- THIS MODULE DOES A BRANCH ON REGISTER 15 TO        * 01400002
*    RETURN TO ITS CALLING MODULE.                                    * 01450002
*                                                                     * 01500002
* EXITS, ERROR -- THIS MODULE DOES A BRANCH ON REGISTER 15 TO         * 01550002
*    RETURN TO ITS CALLING MODULE.                                    * 01600002
*                                                                     * 01650002
* TABLES/WORK AREA --                                                 * 01700002
*    DSECT IS A COMMON COMMUNICATIONS AND WORK AREA POINTED TO BY     * 01750002
*    REGISTER 12 AND DESCRIBED BY A DSECT NAMED DSECT AND BEGINNING   * 01800002
*    IEHECHAR.                                                        * 01850002
*    MSGADS IS A TABLE THAT IS SPLIT INTO TWO GENERAL PARTS.  THE     * 01900002
*    FIRST PART IS A TABLE OF ADDRESS CONSTANTS OF THE MESSAGES       * 01950002
*    THEMSELVES.  THE MESSAGES THEN MAKE UP THE SECOND PART OF THE    * 02000002
*    TABLE.  ALSO INTEGRATED WITHIN THE TABLE OF ADCONS ARE           * 02050002
*    INSTRUCTIONS WHICH ARE EXECUTED IF THE MESSAGE REQUESTS          * 02100002
*    ARE FOR INFORMATIONAL MESSAGES.                                  * 02150002
*                                                                     * 02200002
* ATTRIBUTES -- THIS MODULE OPERATES AS ONE LEG OF AN OVERLAY         * 02250002
*    STRUCTURE.                                                       * 02300002
*                                                                     * 02350002
* CHARACTER CODE DEPENDENCY -- THIS MODULE MUST BE ASSEMBLED IN       * 02400002
*    EBCDIC AND RUN IN EBCDIC TO INSURE COLLATING SEQUENCE AND        * 02450002
*    INTERNAL REPRESENTATION OF CERTAIN CHARACTERS.                   * 02500002
*                                                                     * 02550002
* NOTES -- APPROXIMATELY 3400 BYTES OF STORAGE ARE REQUIRED FOR       * 02600002
*    CODE.                                                            * 02650002
*                                                                     * 02700002
* CHANGE ACTIVITY -- FOLLOWS PROLOGUE                          YL026VC* 02710002
*                                                              YL026VC* 02720002
*********************************************************************** 02750002
IEHPROG3 CSECT                                                    M2838 02800002
*             VS2 SU32 DELETIONS                               @G32DSFS 02802032
*D129740,241890-241910,241930-241960                           @G32DSFS 02804032
*                                                              @G32DSFS 02806032
*C234000-234100                                                 YL026VC 02810002
*A87240                                                          YM5077 02850002
*A45000,70366-70426                                              A57261 02900002
*A44500,70354-70370                                              YM5076 02950002
*C400,14800                                                       M2838 03000002
*A44000,70310-70370                                              A50977 03050002
*                                                                  I276 03100002
*1051070200                                                        BS0H 03150002
*2353                                                              DT0I 03200002
*                                                                A23466 03250002
*                                                                A25564 03300002
*                                                                A24020 03350002
*                                                                A28562 03400002
*                                                                A28552 03450002
*A1600-1940,2600,27100-27200                                    YL026VC 03460002
*C2000-2500                                                     YL026VC 03470002
*A 198500                                                       YA01707 03480002
*C 198500,199500                                                YA01707 03490002
*A 1981000                                                     @ZA01675 03491002
*D 199000                                                      @ZA01675 03491102
*C234000-234100                                                @VS30028 03492003
*                                                              @Z40RSDS 03494032
*                   *****     REGISTER  USAGE     *****                 03500002
ZERO     EQU   0        ----------------------------------------        03550002
R1       EQU   12                                                       03600002
R2       EQU   2                                                        03650002
R3       EQU   3             REGISTERS ZERO THROUGH                     03700002
R4       EQU   4             TEN ARE WORK REGISTERS                     03750002
R5       EQU   5                                                        03800002
R6       EQU   6             REGESTERS ELEVEN AND                       03850002
R7       EQU   7             TWELVE ARE BASE REGISTERS                  03900002
R8       EQU   8             FOR THE PROGRAN AND THE                    03950002
R9       EQU   9             DUMMY SECTION RESPECTIVELY                 04000002
R10      EQU   10                                                       04050002
RB       EQU   11            THIRTEEN POINTS TO A REGISTER              04100002
RBD      EQU   12                                                       04150002
SAVEREG  EQU   13            SAVE AREA                                  04200002
RETURN   EQU   14                                                       04250002
LINKREG  EQU   15            FIFTEEN AND FOURTEEN ARE LINK              04300002
PARAMREG EQU   0             AND RETURN REGISTERS RESPECTIVELY          04350002
LISTREG  EQU   1        -----------------------------------------       04400002
*                                                                       04450002
         USING IEHECHAR,R1                                              04500002
         SAVE  (14,12)            SAVE REGISTERS                  M2838 04550002
         ST    PARAMREG,IEHERSAV  SAVE PARAMETER LIST             M2838 04600002
         BALR  RB,0                ESTABLISH ADDRESSABILITY             04650002
         USING *,RB                                                     04700002
         ST    SAVEREG,SAVEREG3+4 KEEP OLD SAVE AREA              M2838 04750002
         LA    SAVEREG,SAVEREG3   ESTABLISH NEW SAVE AREA         M2838 04800002
         TM    IEHERSAV+1,X'02'                                         04850002
         BZ    NOSEARCH                                                 04900002
         LA    R2,MSGOUT+110       FIND  DISPLACEMENT NEEDED            04950002
         LA    R3,112                                                   05000002
         CLI   0(R2),C' '          TO  PLACE THIS MESSAGE               05050002
         BNE   *+10                                                     05100002
         BCTR  R2,0                2 BYTES ABOVE THE LAST               05150002
         BCT   R3,*-10                                                  05200002
         STC   R3,IEHERSAV+2       CHARACTER IN THE OUTPUT AREA         05250002
NOSEARCH EQU   *                                                        05300002
         LA    R4,255                                                   05350002
         NR    R4,PARAMREG                                              05400002
         LA    R5,MSGADS                                                05450002
        SLA   R4,2          MSG NUM. TIMES 4 AND SET CONDITION CODE     05500002
         BZ    WRITENOW                MSG IS IN OUT AREA WRITE IT      05550002
         AR    R4,R5                                                    05600002
         LA    R8,WTO              BE PREPARED FOR A WTO                05650002
         L     6,0(R4)             IF WE DO NOT HAVE AN ADCON           05700002
         TM    0(R4),X'41'         FOR THE MESSAGE                      05750002
         BZ    *+8                 EXECUTE THE LOAD ADDRESS             05800002
         EX    0,0(R4)             TO GET IT.                           05850002
         SR    R4,R4               CLEAR REGISTER 4                     05900002
         IC    R4,0(R6)            PUT MESSAGE LENGTH INTO IT           05950002
         SR    R7,R7                                                    06000002
         IC    R7,IEHERSAV+2                                            06050002
         LA    R7,MSGOUT(R7)                                            06100002
         EX    R4,MOVEMSG                                               06150002
         TM    IEHERSAV+1,X'01'   SHOULD WE WRITE THIS MESSAGE ?        06200002
         BO    MSGEXIT            NO --- BRANCH                         06250002
WRITENOW LA    R2,MSGOUT-1                                              06300002
         MVI   MSGOUT-1,C' '       SET ASA FOR SINGLE SPACE             06350002
         EX    0,WRITEIT                                                06400002
         MVC   MSGOUT(121),MSGOUT-1     CLEAR THE BUFFER                06450002
         LH    R3,LINECNT                                               06500002
         LA    R3,1(R3)                                                 06550002
         CH    R3,MAXLINES                                              06600002
         BH    EJECT                                                    06650002
         STH   R3,LINECNT                                               06700002
         B     CLEARMSG                                                 06750002
WRITEIT  BAL   R5,*+4                                                   06800002
         PUT   UTOUTDCB,(R2)                                            06850002
         BR    R5                                                       06900002
EJECT    EQU   *                                                        06950002
         LA    R2,WRITEHDR                                              07000002
         EX    0,WRITEIT           WRITE HEADER AND SPACE FORMS         07050002
         MVI   LINECNT+1,X'04'     RESET LINE COUNT TO 4                07100002
         PACK  DBLWORD(8),PAGENUM(4)                                    07150002
         CVB   R5,DBLWORD                                               07200002
         LA    R5,1(R5)                                                 07250002
         CVD   R5,DBLWORD                                               07300002
         UNPK  PAGENUM(4),DBLWORD(8)                                    07350002
         OI    PAGENUM+3,X'F0'                                          07400002
         B     UPTHREE             GO SPACE THE FORMS                   07450002
SPACE    LH    R3,LINECNT                                               07500002
         LA    R3,3(R3)            IF A TRIPPLE SPACE WILL              07550002
         CH    R3,MAXLINES         CAUSE AN OVERFLOW                    07600002
         BNL   EJECT               GO TO THE EJECT ROUTINE              07650002
         STH   R3,LINECNT               --OTHERWIZE--                   07700002
UPTHREE  MVI   MSGOUT-1,C'-'       SET ASA FOR TRIPLE SPACE             07750002
         LA    R2,MSGOUT-1                                              07800002
         EX    0,WRITEIT           GIVE THE SPACE COMMAND               07850002
         B     CLEARMSG            TAKE THE EXIT                        07900002
WTO      LH    LISTREG,0(LISTREG)  GET DISPLACEMENT TO PROPER WTO       07950002
         LA    LISTREG,MSGADS(LISTREG)  GET ADDRESS OF PROPER WTO       08000002
         WTO   MF=(E,(1))               WRITE TO THE OPERATOR           08050002
         B     MSGEXIT                  ......EXIT......                08100002
CLEARMSG MVI   MSGOUT,C' '                                              08150002
         MVC   MSGOUT+1(119),MSGOUT    CLEAR THE OUTPUT AREA            08200002
MSGEXIT  L     SAVEREG,SAVEREG3+4 RETRIEVE OLD SAVE AREA          M2838 08250002
         LM    14,12,12(13)       RESTORE REGS                    M2838 08300002
         L     PARAMREG,IEHERSAV  RESTORE PARAMETERS              M2838 08350002
         L     15,DECB2+4               GET RETURN ADDRESS              08400002
         BR    15                                                       08450002
MOVEMSG  MVC   0(1,R7),1(R6)                                            08500002
         DS    0F                                                       08550002
MSGADS   EQU   *-4                                                      08600002
         DC    A(MSG3)        FOR A 1 WRITE MSG 3                       08650002
         DC    A(MSG2)                                                  08700002
         DC    A(MSG3)                                                  08750002
         DC    A(MSG4)                                                  08800002
*              THESE INSERTS TO ALLOW GETTING DYNAMIC MESSAGES          08850002
         LA    R6,FNSA                                                  08900002
         LA    R6,KWSA                                                  08950002
         LA    R6,PARAM2-1                                              09000002
         LA    R6,PARAM4-1                                              09050002
         DC    A(MSG9)                                                  09100002
         DC    A(MSG3)        FOR A10 WRITE MSG 3                       09150002
         DC    A(MSG11)                                                 09200002
         DC    A(MSG12)                                                 09250002
         DC    A(0)           NO SUCH MESSAGE                           09300002
         DC    AL4(MSG14)                                               09350002
         DC    AL4(MSG15)                                               09400002
         DC    AL4(MSG16)                                               09450002
         DC    AL4(MSG17)                                               09500002
         DC    A(0)           NO SUCH MESSAGE                           09550002
        DC    AL4(MSG19)                                                09600002
         DC    A(MSG20)                                                 09650002
         DC    A(MSG21)                                                 09700002
         DC    A(MSG22)                                                 09750002
         DC    A(MSG23)                                                 09800002
         DC    A(MSG24)                                                 09850002
         DC    A(MSG25)                                                 09900002
         DC    A(MSG26)                                                 09950002
         DC    A(MSG27)                                                 10000002
         DC    A(MSG28)                                                 10050002
         DC    A(MSG29)                                                 10100002
         DC    A(MSG30)                                                 10150002
         DC    A(MSG31)                                                 10200002
         DC    A(MSG32)                                                 10250002
         DC    A(MSG33)                                                 10300002
         DC    A(MSG34)                                                 10350002
         DC    A(MSG35)                                                 10400002
         DC    A(MSG36)                                                 10450002
         DC    A(MSG37)                                                 10500002
         DC    A(MSG38)                                                 10550002
         DC    A(MSG39)                                                 10600002
         DC    A(MSG40)                                                 10650002
         DC    A(MSG41)                                                 10700002
         DC    A(MSG42)                                                 10750002
         DC    A(MSG43)                                                 10800002
         DC    A(MSG44)                                                 10850002
         DC    A(MSG45)                                                 10900002
         DC    A(MSG46)                                                 10950002
         DC    A(MSG47)                                                 11000002
         BAL   6,EJECT                 FORCE A SKIP TO ONE              11050002
         BAL   6,SPACE                 TRIPLE SPACE                     11100002
         DC    A(MSG50)                                                 11150002
         BALR  LISTREG,R8          51 WRITE ON CONSOLE....WTO1          11200002
         DC    AL2(WTO1-MSGADS)                                         11250002
         BALR  LISTREG,R8          52 WRITE ON CONSOLE....WTO2          11300002
         DC    AL2(WTO2-MSGADS)                                         11350002
         DC    A(MSG53)                 I/O ERROR ON SYSIN              11400002
         DC    A(MSG54)                                                 11450002
         DC    A(MSG55)                                            BS0H 11500002
         DC    A(MSG56)                                            BS0H 11550002
         DC    A(MSG57)                                          A23466 11600002
         DC    A(MSG58)                                          A24020 11650002
         DC    A(MSG59)                                          A28552 11700002
*                                                                S21046 11750002
*   THE FOLLOWING ADDRESSES REFER TO THE DIAGNOSTIC MESSAGES     S21046 11800002
*   PRODUCED THROUGH ERROR CONDITIONS OCCURING IN PROTECT        S21046 11850002
*                                                                S21046 11900002
         DC    A(MSG60)                                          S21046 11950002
         DC    A(MSG61)                                          S21046 12000002
         DC    A(MSG62)                                          S21046 12050002
         DC    A(MSG63)                                          S21046 12100002
         DC    A(MSG64)                                          S21046 12150002
         DC    A(MSG65)                                          S21046 12200002
         DC    A(MSG66)                                          S21046 12250002
         DC    A(MSG67)                                          S21046 12300002
*                                                                A31333 12350002
*   THE FOLLOWING MESSAGE NUMBERS REFER TO A DIAGNOSTIC MESSAGE  A31333 12400002
*   PRODUCED BY A RETURN CODE FROM CATALOG                       A31333 12450002
*                                                                A31333 12500002
         DC    A(MSG68)                                          A31333 12550002
         DC    A(MSG69)                                          A31333 12600002
*  THE FOLLOWING TWO MESSAGES ARE A RESULT OF ERROR CONDITIONS   A33374 12650002
* IN THE STOW ROUTINE.                                           A33374 12700002
         DC    A(MSG70)                DATA SET NOT OPEN         A33374 12750002
         DC    A(MSG71)                GETMAIN FAILED IN STOW    A33374 12800002
         DC    A(MSG72)           SCRATCH VTOC FAILED TO FIND DS A50977 12850002
         DC    A(MSG73)           PDS DIRECTORY FULL             YM5076 12900002
         DC    A(MSG74)           ZERO VOL CNT OR BAD LIST       A57261 12950002
*                                                              @VS30028 12952003
* THE FOLLOWING MESSAGES ARE A RESULT OF ERROR CONDITIONS      @VS30028 12954003
* IN SCRATCH OR RENAME.                                        @VS30028 12956003
*                                                              @VS30028 12958003
         DC    A(MSG75)                DATA SET OPEN           @VS30028 12960003
         DC    A(MSG76)                VOLUME NOT MOUNTED      @VS30028 12970003
         DC    A(MSG77)                INVALID AUTHORIZATION   @Z40RSDS*12971032
                                       TO SECURITY PROFILE     @Z40RSRJ 12971232
         DC    A(MSG78)                UNABLE TO RENAME        @Z40RSRJ*12972032
                                       SECURITY PROFILE        @Z40RSRJ 12972232
         EJECT                                                 @VS30028 12998003
MSG2     DC    AL1(MSG3-MSG2-2)                                         13000002
         DC    C' IEH201I  INVALID REQUEST..'                           13050002
         DC    CL19'. STATEMENT IGNORED'                                13100002
MSG3     DC    AL1(MSG4-MSG3-2)                                         13150002
         DC    C'IEH202I  INVALID KEYWORD '                             13200002
         DC    CL27'OR CONTROL STATEMENT SYNTAX'                        13250002
MSG4     DC    AL1(MSG5-MSG4-2)                                         13300002
         DC    CL30'AN UNDEFINED ERROR CODE HAS BE'                     13350002
         DC    CL11'EN RETURNED'                                        13400002
MSG5     EQU   *                                                        13450002
MSG9     DC    AL1(MSG10-MSG9-2)                                        13500002
         DC    CL32'NORMAL END OF TASK RETURNED FROM'                   13550002
MSG10    EQU   *                                                        13600002
MSG11    DC    AL1(MSG12-MSG11-2)                                       13650002
         DC    C' IEH203I  '                                            13700002
         DC    CL30'THE SYSCTLG DATA SET IS NOT AV'                     13750002
         DC    CL23'AILABLE OR FORMS A LOOP'                            13800002
MSG12    DC    AL1(MSG13-MSG12-2)                                       13850002
         DC    C' IEH204I  '                                            13900002
         DC    CL31'STATUS OF THE REQUESTED TASK CA'                    13950002
         DC    CL19'N NOT BE DETERMINED'                                14000002
MSG13    EQU   *                                                        14050002
MSG14    DC    AL1(MSG15-MSG14-2)                                       14100002
         DC    C' IEH205I  '                                            14150002
         DC    CL30'INFORMATION IN CONTROL STATMEN'                     14200002
         DC    CL14'T IS REDUNDANT'                                     14250002
MSG15    DC    AL1(MSG16-MSG15-2)                                       14300002
         DC    CL14'NOT SUFFICIENT'                                     14350002
MSG16    DC    AL1(MSG17-MSG16-2)                                       14400002
         DC    CL30'THE REQUESTED PROGRAM FUNCTION'                     14450002
         DC    CL20' HAS NOT BEEN CALLED'                               14500002
MSG17    DC    AL1(MSG18-MSG17-2)                                       14550002
         DC    C' ... UNUSUAL END'                                      14600002
MSG18    EQU   *                                                        14650002
MSG19    DC    AL1(MSG20-MSG19-2)                                       14700002
         DC    C' IEH206I  '                                            14750002
         DC    C'CVOL IS NOT DIRECT ACCESS'                             14800002
MSG20    DC    AL1(MSG21-MSG20-2)                                       14850002
         DC    C' IEH207I  '                                            14900002
         DC    CL26'STATUS OF USERS REQUEST TO'                         14950002
MSG21    DC    AL1(MSG22-MSG21-2)                                       15000002
         DC    CL10'DATA SET'                                           15050002
MSG22    DC    AL1(MSG23-MSG22-2)                                       15100002
         DC    CL30'VOLUME I.D.     ACTION TAKEN  '                     15150002
         DC    CL32'   REASON FOR TAKING THIS ACTION'                   15200002
         DC    CL25'                    ERROR'                          15250002
MSG23    DC    AL1(MSG24-MSG23-2)                                       15300002
         DC    CL13'USERS REQUEST'                                      15350002
MSG24    DC    AL1(MSG25-MSG24-2)                                       15400002
         DC    C'DATA SET OR MEMBER NOT FOUND'                          15450002
MSG25    DC    AL1(MSG26-MSG25-2)                                       15500002
         DC    CL30'CORRECT PASSWORD NOT AVAILABLE'                     15550002
MSG26    DC    AL1(MSG27-MSG26-2)                                       15600002
         DC    CL26'PURGE DATE HAS NOT EXPIRED'                         15650002
MSG27    DC    AL1(MSG28-MSG27-2)                                       15700002
         DC    CL25'THE SPECIFIED NEW NAME IS'                          15750002
         DC    CL16' ALREADY PRESENT'                                   15800002
MSG28    DC    AL1(MSG29-MSG28-2)                                       15850002
         DC    CL4'NONE'                                                15900002
MSG29    DC    AL1(MSG30-MSG29-2)                                       15950002
         DC    CL31'PERMANENT I/O ERROR ENCOUNTERED'                    16000002
MSG30    DC    AL1(MSG31-MSG30-2)                                       16050002
         DC    CL43'END OF LISTING OF DATA SETS TO BE SCRATCHED' A25564 16100002
         DC    CL11' OR RENAMED'                                 A25564 16150002
MSG31    DC    AL1(MSG32-MSG31-2)                                       16200002
         DC    CL11'UTILITY END'                                        16250002
MSG32    DC    AL1(MSG33-MSG32-2)                                       16300002
         DC    CL27'DATA SET NAME'                                      16350002
MSG33    DC    AL1(MSG34-MSG33-2)                                       16400002
         DC    CL30'SCRATCH THE VOLUME TABLE OF CO'                     16450002
         DC    CL6'NTENTS'                                              16500002
MSG34    DC    AL1(MSG35-MSG34-2)                                       16550002
         DC    CL19'END OF SCRATCH VTOC'                                16600002
MSG35    DC    AL1(MSG36-MSG35-2)                                       16650002
         DC    C' IEH208I  LIST TRUNCATED TO '                          16700002
         DC    CL25'1 VOLUME FOR SCRATCH VTOC'                          16750002
MSG36    DC    AL1(MSG37-MSG36-2)                                       16800002
         DC    C' IEH209I  '                                            16850002
         DC    CL26'STATUS OF USERS REQUEST TO'                         16900002
MSG37    DC    AL1(MSG38-MSG37-2)                                       16950002
         DC    C' IEH210I  YOUR REQUEST CANNOT'                         17000002
         DC    CL16' BE SERVICED....'                                   17050002
MSG38    DC    AL1(MSG39-MSG38-2)                                       17100002
         DC    CL23'IS A CATALOGED DATA SET'                            17150002
MSG39    DC    AL1(MSG40-MSG39-2)                                       17200002
         DC    CL32'THE INDEX SPECIFIED IS NOT EMPTY'                   17250002
         DC    CL16' OR HAS AN ALIAS'                                   17300002
MSG40    DC    AL1(MSG41-MSG40-2)                                       17350002
         DC    CL29'NO SPACE AVAILIBLE TO SYSCTLG'                      17400002
MSG41    DC    AL1(MSG42-MSG41-2)                                       17450002
         DC    CL28'IS NOT A VALID DATA SET NAME'                       17500002
MSG42    DC    AL1(MSG43-MSG42-2)                                       17550002
         DC    CL27'WITHIN THE SYSCTLG DATA SET'                        17600002
MSG43    DC    AL1(MSG44-MSG43-2)                                       17650002
         DC    CL27'IS CURRENTLY AN INDEX LEVEL'                        17700002
MSG44    DC    AL1(MSG45-MSG44-2)                                       17750002
         DC    CL32'THE IMPLIED INDEX STRUCTURE DOES'                   17800002
         DC    CL10' NOT EXIST'                                         17850002
MSG45    DC    AL1(MSG46-MSG45-2)                                       17900002
         DC    CL29'A DATA SET EXISTS WITHIN THE '                      17950002
         DC    CL29'SPECIFIED LIST OF INDEX NAMES'                      18000002
MSG46    DC    AL1(MSG47-MSG46-2)                                       18050002
         DC    CL24'A SYNTAX ERROR EXISTS IN'                           18100002
MSG47    DC    AL1(MSG48-MSG47-2)                                       18150002
         DC    CL27'IS NOT A CATALOGED DATA SET'                        18200002
MSG48    EQU   *                                                        18250002
MSG50    DC    AL1(MSG51-MSG50-2)                                       18300002
         DC    C' IEH211I  '                                            18350002
         DC    CL30'REQUIRED VOLUME COULD NOT BE M'                     18400002
         DC    CL6'OUNTED'                                              18450002
MSG51    EQU   *                                                        18500002
WTO1     WTO  'IEH002I SYNAD EXIT FROM SYSPRINT- TASK TERMINATED',MF=L  18550002
WTO2     WTO  'IEH005I PROGRAM INTERRUPT ... TASK TERMINATED',MF=L      18600002
MSG53    DC    AL1(MSG54-MSG53-2)                                       18650002
         DC    C' IEH212I  I/O ERROR ON THE SY'                         18700002
         DC    C'SIN DATA SET --- JOB TERMINATED'                       18750002
MSG54    DC    AL1(MSG55-MSG54-2)                                       18800002
         DC    CL30'IT IS INVALID --OR-- IT IS NOT'                     18850002
         DC    CL28' PROPER WITHIN YOUR PRESENT '                       18900002
         DC    CL17'CATALOG STRUCTURE'                                  18950002
MSG55    DC    AL1(MSG56-MSG55-2)                                  BS0H 19000002
         DC    C' IEH213I  '                                       BS0H 19050002
         DC    CL32' JOB TERMINATED -- INVALID BLOCK'              BS0H 19100002
         DC    CL28'SIZE SPECIFIED IN SYSIN DCB '                  BS0H 19150002
MSG56    DC    AL1(MSG57-MSG56-2)                                  BS0H 19200002
         DC    C' IEH216I  '                                     A28562 19250002
         DC    CL32' SYSIN CANNOT BE OPENED -- CHECK'              BS0H 19300002
         DC    CL14' SYSIN DD CARD'                                BS0H 19350002
MSG57    DC    AL1(MSG58-MSG57-2)                                A23466 19400002
         DC    C' IEH214I  '                                     A23466 19450002
         DC    CL38' CONTINUATION CARD EXPECTED---REQUESTS'      A23466 19500002
         DC    CL19' CANNOT BE SERVICED'                         A23466 19550002
MSG58    DC    AL1(MSG59-MSG58-2)                                A24020 19600002
         DC    C' IEH215I  '                                     A24020 19650002
         DC    CL42' SYNTAX ERROR ENCOUNTERED IN NAME FIELD OF'  A24020 19700002
         DC    CL42' CONTROL STATEMENT-PROCESSING IS CONTINUED'  A24020 19750002
MSG59    DC    AL1(MSG60-MSG59-2)      LENGTH OF ENTRY           A28552 19800002
         DC    C' IEH217I  '                                   @ZA01675 19810002
         DC    CL42'ERROR ENCOUNTERED IN A NAME, INDEX, ALIAS,' YA01707 19850002
         DC    CL42' OR MEMBER FIELD OF THE CONTROL STATEMENT ' YA01707 19870002
         DC    CL18'.. REQUEST IGNORED'                         YA01707 19950002
*                                                                S21046 20000002
*   MESSAGE 60 IS PRODUCED BY A RETURN CODE FROM PROTECT         S21046 20050002
*                                                                S21046 20100002
MSG60    DC    AL1(MSG61-MSG60-2)                                S21046 20150002
         DC    C' IEH223I '                                      S21046 20200002
         DC    CL37' THE PASSWORD DATA SET DOES NOT EXIST'       S21046 20250002
*                                                                S21046 20300002
*   MESSAGE 61 IS PRODUCED BY A RETURN CODE FROM PROTECT         S21046 20350002
*                                                                S21046 20400002
MSG61    DC    AL1(MSG62-MSG61-2)                                S21046 20450002
         DC    C' IEH224I '                                      S21046 20500002
         DC    CL39'WARNING ... UNABLE TO ALTER PROTECTION '     S21046 20550002
         DC    CL24'STATUS OF TAPE DATA SETS'                    S21046 20600002
*                                                                S21046 20650002
*   MESSAGE 62 IS PRODUCED BY A RETURN CODE FROM PROTECT         S21046 20700002
*                                                                S21046 20750002
MSG62    DC    AL1(MSG63-MSG62-2)                                S21046 20800002
         DC    C' IEH225I '                                      S21046 20850002
         DC    CL31' DUPLICATE ENTRY EXISTS IN THE '             S21046 20900002
         DC    CL17'PASSWORD DATA SET'                           S21046 20950002
*                                                                S21046 21000002
*   MESSAGE 63 IS PRODUCED BY A RETURN CODE FROM PROTECT         S21046 21050002
*                                                                S21046 21100002
MSG63    DC    AL1(MSG64-MSG63-2)                                S21046 21150002
         DC    C' IEH218I '                                      S21046 21200002
         DC    CL41' JOB TERMINATED --- FIVE INVALID PASSWORD'   S21046 21250002
         DC    CL15'S WERE SUPPLIED'                             S21046 21300002
*                                                                S21046 21350002
*   MESSAGE 64 IS PRODUCED BY A RETURN CODE FROM PROTECT         S21046 21400002
*                                                                S21046 21450002
MSG64    DC    AL1(MSG65-MSG64-2)                                S21046 21500002
         DC    C' IEH222I '                                      S21046 21550002
         DC    CL37'UNABLE TO ALTER PROTECTION STATUS OF '       S21046 21600002
         DC    CL8'DATA SET'                                     S21046 21650002
*                                                                S21046 21700002
*   MESSAGE 65 IS PRODUCED BY A RETURN CODE FROM PROTECT         S21046 21750002
*                                                                S21046 21800002
MSG65    DC    AL1(MSG66-MSG65-2)                                S21046 21850002
         DC    C' IEH219I '                                      S21046 21900002
         DC    CL31' I/O ERROR IN PASSWORD DATA SET'             S21046 21950002
*                                                                S21046 22000002
*   MESSAGE 66 IS PRODUCED BY A RETURN CODE FROM PROTECT         S21046 22050002
*                                                                S21046 22100002
MSG66    DC    AL1(MSG67-MSG66-2)                                S21046 22150002
         DC    C' IEH221I '                                      S21046 22200002
         DC    CL31' THE PASSWORD DATA SET IS FULL'              S21046 22250002
*                                                                S21046 22300002
*   MESSAGE 67 IS PRODUCED BY A RETURN CODE FROM PROTECT         S21046 22350002
*                                                                S21046 22400002
MSG67    DC    AL1(MSG68-MSG67-2)                                S21046 22450002
         DC    C' IEH229I '                                      S21046 22500002
         DC    CL32' INVALID PARAMETER IN PARM FIELD'            S21046 22550002
         DC    CL13' OF EXEC CARD'                               S21046 22600002
*                                                                A31333 22650002
*   MESSAGE 68 IS PRODUCED BY A RETURN CODE FROM CATALOG         A31333 22700002
*                                                                A31333 22750002
MSG68    DC   AL1(MSG69-MSG68-2)                                 A31333 22800002
         DC    C' IEH230I '                                      A31333 22850002
*                                                                A31333 22900002
*   MESSAGE 69 IS PRODUCED BY A RETURN CODE FROM CATALOG         A31333 22950002
*                                                                A31333 23000002
         DC    C' VTOC NOT CONVERTED FROM DOS TO OS '            A31333 23050002
MSG69    DC    AL1(MSG70-MSG69-2)                                A31333 23100002
         DC    C'          DATA SET NOT CATALOGUED OR INDEX'     A31333 23150002
         DC    C' NOT BUILT'                                     A31333 23200002
*  VTOC OR DIRECTORY OF PDS COULD NOT BE OPENED                  A33374 23250002
MSG70    EQU   *                                                 A33374 23300002
         DC    AL1(MSG71-MSG70-2)                                A33374 23350002
         DC    C'VTOC OR DIRECTORY OPEN FAILED'                @VS30028 23400003
*  CONDITIONAL GETMAIN FAILED IN STOW                            A33374 23450002
MSG71    EQU   *                                                 A33374 23500002
         DC    AL1(MSG72-MSG71-2)                                A33374 23550002
         DC    C'INSUFFICIENT CORE, CONDITIONAL GETMAIN FAILED'  A33374 23600002
*     SCRATCH FAILED TO FIND A VTOC ENTRY DURING SCRATCH  VTOC   A50977 23650002
MSG72    DC    AL1(MSG73-MSG72-2)                                A50977 23700002
         DC    CL37'ERROR IN VTOC ENTRY-UNABLE TO SCRATCH'       A50977 23750002
*     STOW FOUND A FULL PDS DIRECTORY                            YM5076 23800002
MSG73    DC    AL1(MSG74-MSG73-2)                                YM5076 23850002
         DC    CL21'PDS DIRECTORY IS FULL'                       YM5076 23900002
*        VOLUME COUNT IS ZERO OR LIST NOT IN REGION              A57261 23950002
MSG74    EQU   *                                                 A57261 24000002
         DC    AL1(MSG75-MSG74-2)                                A57261 24050002
         DC    C'VOL COUNT IS ZERO OR LIST NOT IN REGION'        A57261 24100002
*                                                              @VS30028 24110003
*   MESSAGE 75 IS PRODUCED BY A RETURN CODE FROM SCRATCH OR    @VS30028 24120003
*   RENAME (IF THE DATA SET TO BE SCRATCHED/RENAMED WAS OPEN)  @VS30028 24130003
*   AND IS PRINTED AS PART OF MESSAGE IEH207I OR IEH209I.      @VS30028 24132003
*                                                              @VS30028 24140003
MSG75    EQU   *                                                 A57261 24150002
         DC    AL1(MSG76-MSG75-2)      MESSAGE LENGTH - 1      @VS30028 24152003
         DC    C'DATA SET WAS OPEN'    MESSAGE TEXT            @VS30028 24154003
*                                                              @VS30028 24156003
*   MESSAGE 76 IS PRODUCED BY A RETURN CODE FROM SCRATCH       @VS30028 24158003
*   WHEN THE VOLUME COULD NOT BE VERIFIED AS MOUNTED AND       @VS30028 24160003
*   IS PRINTED AS PART OF MESSAGE IEH209I.                     @VS30028 24161003
*                                                              @VS30028 24162003
MSG76    EQU   *                       MESSAGE NUMBER 76       @VS30028 24164003
         DC    AL1(MSG77-MSG76-2)      MESSAGE LENGTH - 1      @VS30028 24166003
         DC    C'VOLUME NOT MOUNTED'   MESSAGE TEXT            @VS30028 24168003
*                                                              @Z40RSDS 24170032
*   MESSAGE 77 IS PRODUCED BY A RETURN CODE FROM SCRATCH       @Z40RSDS 24172032
*   AND IS PRINTED AS PART OF MESSAGE IEH207I OR IEH209I.      @Z40RSDS 24173032
*                                                              @Z40RSDS 24174032
MSG77    EQU   *                       MESSAGE NUMBER 77       @VS30028 24178003
         DC    AL1(MSG78-MSG77-2)      MESSAGE LENGTH - 1      @Z40RSDS 24179032
         DC    C'INVALID AUTHORIZATION TO SECURITY PROFILE'    @Z40RSRJ 24180032
*                                                              @Z40RSDS 24181032
*   MESSAGE 78 IS PRODUCED BY A RETURN CODE FROM RENAME        @Z40RSDS 24182032
*   AND IS PRINTED AS PART OF MESSAGE IEH207I.                 @Z40RSDS 24183032
*                                                              @Z40RSDS 24184032
MSG78    EQU   *                       MESSAGE NUMBER 78       @Z40RSDS 24185032
         DC    AL1(MSG80-MSG78-2)      MESSAGE LENGTH - 1      @G32DSFS 24186032
         DC    C'UNABLE TO RENAME SECURITY PROFILE'  MSG TEXT  @Z40RSRJ 24188032
*                                                              @Z40RSDS 24190032
*   MESSAGE 79 HAS BEEN DELETED                                @G32DSFS 24192032
*                                                              @G32DSFS 24194032
MSG80    EQU   *                       MESSAGE NUMBER 80       @G32DSFS 24196032
         EJECT                                                 @VS30028 24198003
DSECT    DSECT                                                          24200002
IEHECHAR DS    C         CHARACTER TO BE SCANNED FOR                    24250002
IEHECOND DS    C         CONDITION CODE TO STOP ON                      24300002
IEHECODE DS    C                                                        24350002
IEHEARGL DS    C                                                        24400002
IEHESTT  DS    F                                                        24450002
IEHESTP  DS    F                                                        24500002
IEHEFND  DS    F                                                        24550002
IEHETBL  DS    F                                                        24600002
IEHEFUN  DS    F                                                        24650002
IEHESCNX DS    3F                                                       24700002
IEHEMAC1 DS    7F                 PARAMETER LIST                 S21046 24750002
IEHEMAC2 DS    6F                                                       24800002
IEHESTIN DS    F                                                        24850002
IEHENDIN DS    F                                                        24900002
IEHECCNT DS    2C                                                       24950002
IEHESW1  DS    C                                                        25000002
DUPSW    DS    2C                 SWITCHES FOR TEST OF DUPLICATE S21046 25050002
*                                 PARAMETERS                     S21046 25100002
PPARAMSW DS    CL2                                                      25150002
IEHESW5  DS    C                                                        25200002
IEHESW6  DS    C                                                        25250002
IEHECALL DS    F                                                        25300002
         DS    0D                                                       25350002
DBLWORD  DS    F                                                        25400002
FULLWORD DS    F                                                        25450002
         DS    0D                                                       25500002
DECB1    DS    24X                                                      25550002
DECB2    DS    24X                                                      25600002
VOLISTAD DS    F                                                        25650002
MATRIXIU DS    F                                                        25700002
VDTIU    DS    F                                                        25750002
VOLPAREN DS    FL2                                                      25800002
VSRCM    DS    2X                                                       25850002
VDSA     DS    X                                                        25900002
DFLG     DS    X                                                   BS0H 25950002
DFLAG    DS    X                                                   BS0H 26000002
         DS    0F                                                       26050002
FLSTADDR DS    F                                                        26100002
FNSA     DS    12X                                                      26150002
KWSA     DS    12X                                                      26200002
SCANRET  DS    F                                                        26250002
MARESAR  DS    72X                                                      26300002
IEHESPC  DS    XL20                                                     26350002
         DS    XL20                                                     26400002
IEHERSAV DS    64X                                                      26450002
PASSUNIT DS    5X                                                  DT0I 26500002
MOUNTSW  DS    X                                                   DT0I 26550002
TABLEAD  DS    F                  ADDRESS OF DEVICE NAME TABLE     I276 26600002
IEHESW2  DS    X                  PROTECT SWITCHES               S21046 26650002
*                                 BIT 1=1 IF WE ARE TO PRINT     S21046 26700002
*                                        CONTROL CARDS           S21046 26750002
*                                 BIT 3=1 INDICATES FIRST QUOTE  S21046 26800002
*                                        IN SCAN FOR DATA        S21046 26850002
*                                        OPERATION IS FOUND      S21046 26900002
*                                 BIT 4= 1 IF WTOR SETUP IS DONE S21046 26950002
*                                 BIT 6=1 IF FIRST PARM ENTRY    S21046 27000002
*                                 WAS VALID                      S21046 27050002
*                                 BIT 7=1 IF INVALID PARM ENTRY  S21046 27100002
*                                 MSG HAS BEEN PRINTED           S21046 27150002
PASWDCT1 DS    1X                 NUMBER OF PROMPTS FOR PASWORD1 S21046 27200002
PASWDCT3 DS    1X                 NUMBER OF PROMPTS FOR CPASWORD S21046 27250002
TOTALPS  DS    1X                 TOTAL NO OF OPERATOR REPLIES   S21046 27300002
WTORECB  DS   1F                  EVENT CONTROL BLOCK FOR WTOR   S21046 27350002
TIOTADRS DS    1F                 TIOT ADDRESS FOR WTOR          S21046 27400002
CCNAME   DS    8C                 NAME OFF CONTROL CARD          S21046 27450002
WTORLIST WTOR  'IEH220A JOBNAMES, STEPNAME, CARDNAME, REPLY WITH PASSWOX27500002
               RD',,8,WTORECB,ROUTCDE=(9),DESC=2,MF=L            S21046 27550002
EXTRACTO EXTRACT ,'S',FIELDS=(TIOT),MF=L                         S21046 27600002
DCBAREA  DS    0F                                                       27650002
UTINDCB  DCB   DSORG=PS,MACRF=(GM)                                      27700002
CODELIST DC    C'.,=()   '        SPECIAL CHARACTERS CODED BY SCAN      27750002
MAXLINES DC    FL2'45'             MAXIMUM LINES PER PAGE               27800002
LINECNT  DC    FL2'0'              LINE COUNT FIELD                     27850002
SKIP21   DC    X'8B'               SKIP TO 1 COMMAND                    27900002
WRITEHDR DC    X'19'               SPACE 3 AFTER PRINT                  27950002
HEADER   DC    CL30'MODIFY....VERSION BETA-1......'                     28000002
         DC    CL30'LAST UPDATED....JULY 11  10 PM'                     28050002
         DC    CL30'                              '                     28100002
         DC    CL30'               PAGE 001       '                     28150002
PAGENUM  EQU   HEADER+110                                               28200002
DDNAMES  DS    3CL8                     FOR THREE DD NAMES              28250002
UTOUTDCB DCB   DSORG=PS,MACRF=(PM)                                      28300002
         DS    2F                                                       28350002
IEHESAT  DS    150X                                                     28400002
READBASE DC    F'0'                                                     28450002
PARAM1   DS    44X                                                      28500002
         DS    F              FOR  LENGTH OF  PARAM2                    28550002
PARAM2   DS    44X                                                      28600002
         DS    F                   FOR LENGTH OF PARAM3                 28650002
PARAM3   DS    44X                                                      28700002
PARAM5   DS    2F                 CPASWORD PARAMETER             S21046 28750002
PARAM6   DS    151F               VOL IDS PARAMETER              S21046 28800002
PARAM7   DS    2F                 PASSWORD2 PARAMETER            S21046 28850002
PARAM8   DS    80X                DATA PARAMETER                 S21046 28900002
DUMMY    DS    1F                 TEMPORARY STORAGE FIELD        S21046 28950002
PROTCTAD DS    1F                 ADDRESS OF WHERE TO PUT NEXT   S21046 29000002
*                                 VOL ID IN PARAM6 FOR PROTECT   S21046 29050002
FINUSE   DS    F                   ADDR OF DC LIST IN USE               29100002
DCSAVEAD DS    F                   SAVE AREA FOR ADDR OF DC LIST        29150002
INPUT    DS    40F                 TWO CARD INPUT AREA                  29200002
MSGOUT   DS    30F                 MSG OUTPUT AREA                      29250002
         DS    F                                                        29300002
         DS    0D                                                       29350002
PARAM4   DS    151F                FOR A VOLUME LIST                    29400002
EOCORE   EQU   *-12                                                     29450002
         ORG   PARAM4+20                                                29500002
VTOCDCB2 DS    0F                                                       29550002
DCB4VTOC DCB   DDNAME=VTOC,                                            .29600002
               DSORG=PS,                                               .29650002
               MACRF=R,                                                .29700002
               KEYLEN=44,                                              .29750002
               BLKSIZE=1,                                              .29800002
               RECFM=U,                                                .29850002
               EODAD=VTOCEND,                                          .29900002
               SYNAD=VTOCERR,                                          .29950002
               EXLST=VTOCEND                                            30000002
JFCB     DS    24D                                                      30050002
*        THE FOLLOWING ORG STATEMENT IS FLAGGED                  YM5077 30100002
         ORG                                                            30150002
SAVEREG2 DS    72X                SECONDARY SAVE AREA             M2838 30200002
SAVEREG3 DS    72X                THIRD LEVEL SAVE AREA           M2838 30250002
         ORG                                                            30300002
VTOCSW   EQU   JFCB+50                                                  30350002
VTOCDECB EQU   JFCB+60                                                  30400002
JFCBVOL  EQU   JFCB+118                                                 30450002
EXLST2   EQU   DCB4VTOC+36                                              30500002
FORMATID EQU   PARAM2+44                                                30550002
BLANK    EQU   64                                                       30600002
READTOO  EQU   INPUT+72                                                 30650002
COL16    EQU   READTOO+15                                               30700002
COL72    EQU   READTOO+71                                               30750002
MIDDLE   EQU   READTOO-1                                                30800002
WARE2PUT EQU   IEHEMAC1-4                                               30850002
SYSINEND EQU   *                                                        30900002
VTOCEND  EQU   *                                                        30950002
VTOCERR  EQU   *                                                        31000002
         END                                                            31050002
./  ADD  SSI=63380434,NAME=IEHPROG4
   TITLE  'IEHPROGM  -  IEHPROG4  AUXILIARY PARAMETER ANALYZER'         00020002
**********************************************************************  00040002
*                                                                     * 00060002
* MODULE NAME -- IEHPROG4                                      YL026VC* 00070002
*                                                              YL026VC* 00072002
* DESCRIPTIVE NAME -- IEHPROGM AUXILIARY PARAMETER ANALYZER    YL026VC* 00074002
*                                                              YL026VC* 00076002
* COPYRIGHT -- NONE                                            YL026VC* 00078002
*                                                              YL026VC* 00078402
* STATUS -- 'IEHPROG4' OS/VS2 PROLOGUE MODIFICATION            YL026VC* 00080002
*    NOVEMBER 1972                                             YL026VC* 00090002
*                                                              YL026VC* 00100002
* FUNCTION -- THIS MODULE TESTS THE INVOKER PARAMETER LISTS AND       * 00120002
*    OPENS THE INPUT AND OUTPUT DCB'S USED BY IEHPROGM.               * 00140002
*                                                                     * 00160002
* ENTRY POINTS --                                                     * 00180002
*         IEHPROG4 IS THE ONLY ENTRY POINT TO THE MODULE 'IEHPROG4'.  * 00200002
*                                                                     * 00220002
* INPUT -- INPUT TO IEHPROG4 CONSISTS OF THE STANDARD INVOKER LIST    * 00240002
*    POINTED TO BY REGISTER 1 AND THE COMMON COMMUNICATIONS AND WORK  * 00260002
*    AREA POINTED TO BY REGISTER 12 AND DESCRIBED BY THE DSECT        * 00280002
*    NAMED DSECT.                                                     * 00300002
*                                                                     * 00320002
* OUTPUT -- OUTPUT OF IEHPROG4 CONSISTS OF MODIFICATIONS TO THE       * 00340002
*    COMMUNICATIONS AREA THAT WAS INPUT TO THE MODULE.                * 00360002
*                                                                     * 00380002
* EXTERNAL REFERENCES -- THIS ROUTINE HAS NO EXTERNAL ROUTINES.       * 00400002
*                                                                     * 00420002
* EXITS, NORMAL -- THIS MODULE DOES A BRANCH ON REGISTER 15 TO THE    * 00440002
*    POINT OF CALL IN 'IEHPROG1'.                                     * 00460002
*                                                                     * 00480002
* EXITS, ERROR -- THIS MODULE DOES A BRANCH ON REGISTER 15 TO THE     * 00500002
*    POINT OF CALL IN 'IEHPROG1'.                                     * 00520002
*                                                                     * 00540002
* TABLES/WORK AREA --                                                 * 00560002
*    DSECT IS A COMMON COMMUNICATIONS AND WORK AREA POINTED TO BY     * 00580002
*    REGISTER 12 AND DESCRIBED BY A DSECT NAMED DSECT AND BEGINNING   * 00600002
*    IEHECHAR.                                                        * 00620002
*                                                                     * 00640002
* ATTRIBUTES -- THIS MODULE OPERATES AS ONE LEG OF AN OVERLAY         * 00660002
*    STRUCTURE.                                                       * 00680002
*                                                                     * 00700002
* CHARACTER CODE DEPENDENCY -- THIS MODULE MUST BE ASSEMBLED IN       * 00720002
*    EBCDIC AND RUN IN EBCDIC TO INSURE COLLATING SEQUENCE AND        * 00740002
*    INTERNAL REPRESENTATION OF CERTAIN CHARACTERS.                   * 00760002
*                                                                     * 00780002
* NOTES -- APPROXIMATELY 1000 BYTES OF STORAGE ARE REQUIRED FOR       * 00800002
*    CODE.                                                            * 00820002
*                                                                     * 00840002
* CHANGE ACTIVITY -- FOLLOWS PROLOGUE                          YL026VC* 00850002
*                                                              YL026VC* 00852002
**********************************************************************  00860002
IEHPROG4 CSECT                                                    M2838 00880002
*A49220                                                          YM5077 00900002
*C200,10600                                                       M2838 00920002
*                                                                  I276 00940002
*1056029000-029200,031800-032000                                   BS0H 00960002
*7064018200,018600                                               PTM732 00980002
*2480                                                              DT0I 01000002
*A700-784,1000,8500-8520                                        YL026VC 01010002
*C800-900                                                       YL026VC 01012002
*C57800                                                                 01016002
REG1     EQU   1                                                        01020002
REG2     EQU   2                                                        01040002
REG3     EQU   3                                                        01060002
REG4     EQU   4                                                        01080002
REG5     EQU   5                                                        01100002
REG6     EQU   6                                                        01120002
REG7     EQU   7                                                        01140002
GOTO     EQU   8                                                        01160002
MOCANAR  EQU   9                                                        01180002
REG10    EQU   10                                                       01200002
NULL     EQU   0                  USED AS NULL REGISTER IN BCTR  S21046 01220002
BASE     EQU   11                 BASE REGISTER                  S21046 01240002
DBASE    EQU   12                 DSECT BASE REGISTER            S21046 01260002
SAVEREG  EQU   13                 SAVE AREA POINTER               M2838 01280002
RETURN   EQU   14                                                       01300002
REG15    EQU   15                                                  BS0H 01320002
BITON    EQU   X'80'              TURNS ON THE PRINT BIT         S21046 01340002
BITOFF   EQU   X'7F'              TURNS OFF THE PRINT BIT        S21046 01360002
ONEGOOD  EQU   X'04'              1ST PARAMETER GOOD             S21046 01380002
MSGPRINT EQU   X'02'              INDICATES TO IEHPROG1 THAT THE S21046 01400002
*                                 PARM ERROR MSG IS TO BE        S21046 01420002
*                                 PRINTED. MSG NUMBER 67         S21046 01440002
MSGOFF   EQU   X'FD'              USED TO TURN OFF THE MSG BIT   S21046 01460002
ZERO     EQU   C'0'               CHARACTER ZERO                 S21046 01480002
NINE     EQU   C'9'               CHARACTER NINE                 S21046 01500002
PRINTLNG EQU   5                  LENGTH OF 'PRINT'              S21046 01520002
NPRNTLNG EQU   7                  LENGTH OF 'NOPRINT'            S21046 01540002
NAMLNGTH EQU   8                  LENGTH OF 'LINECNT='           S21046 01560002
MOVE8    EQU   8                  MOVE THE OPEN LIST             S21046 01580002
CNTLNGTH EQU   10                 LENGTH OF LINE COUNT PARM      S21046 01600002
OFFSET0  EQU   0                  OFFSET OF 0                    S21046 01620002
OFFSET1  EQU   1                  OFFSET FOR MSGOUT              S21046 01640002
OFFSET2  EQU   2                  OFFSET FOR RETURN CODE         S21046 01660002
INCRMNT1 EQU   1                  MOVE POINTER UP ONE            S21046 01680002
INCRMNT2 EQU   2                  MOVE POINTER UP TWO            S21046 01700002
INCRMNT3 EQU   3                  INCREMENT OF THREE             S21046 01720002
COMMA    EQU   C','               CHECK FOR COMMA                S21046 01740002
AA       EQU   34                                                       01760002
         SAVE  (14,12)        SAVE REGS FOR MAIN PROG                   01780002
         BALR  BASE,0             SET UP ADDRESSABILITY          S21046 01800002
         USING *,BASE                                            S21046 01820002
         USING IEHECHAR,DBASE                                    S21046 01840002
         ST    SAVEREG,SAVEREG2+4 KEEP OLD SAVE AREA              M2838 01860002
         LA    SAVEREG,SAVEREG2   ESTABLISH NEW SAVE AREA         M2838 01880002
         MVI   CTRLWORD,X'00'     RESET SWITCHES FOR VOLUME MOUNTING    01900002
         MVC   DCBAREA(256),DCBSTART    PUT THE DCB'S                   01920002
         MVC   DCBAREA+250(DCBSTOP-DCBSTART-250),DCBSTART+250           01940002
         OI    IEHESW2,BITON      TURN ON THE PRINT BIT          S21046 01960002
         NI    IEHESW2,MSGOFF     TURN OFF THE MSG BIT           S21046 01980002
         LTR   REG10,REG1    DOES A PARAMETER LIST EXIST                02000002
         L     REG1,0(REG10)                                            02020002
         BZ    FLEE               NO .... BRANCH                        02040002
         LA    GOTO,GOTOTAB   SET ADDRESS OF ROUTINE TO BE ENTERED      02060002
TSTCOUNT LH    REG2,0(REG1)                                             02080002
         LTR   REG2,REG2      TEST COUNT FIELD FOR ZERO COUNT           02100002
         BCR   7,GOTO         BRANCH IF NOT ZERO                        02120002
TST4LAST TM   0(REG10),X'80'  IS THIS THE LAST ITEM                     02140002
        BO    FLEE   GO BACK TO CALLING RTN                             02160002
         LA    REG10,4(REG10)    POINT AT NEXT ENTRY IN THE LIST        02180002
         L     REG1,0(REG10)                                            02200002
         LA    GOTO,4(GOTO)   POINT TO NEXT ENTRY IN GOTOTAB            02220002
         B     TSTCOUNT                                                 02240002
GOTOTAB  B     PARAMFLD       PROCESS THE PARAMETER FIELD               02260002
         B     DD             PROCESS THE DD FIELD                      02280002
         B     HEADLINE       PROCESS THE HEADER                        02300002
         B     FLEE           RETURN ... WE SHOULD HAVE STOPED. BEFORE  02320002
*                                                                S21046 02340002
*      INTERPRET THE PARM FIELD OF THE EXEC CARD OR THE          S21046 02360002
*      PARAM FIELD OF THE LINK OR ATTACH MACRO. 'PRINT',         S21046 02380002
*      'NOPRINT' AND 'LINECNT=XX' ARE THE ONLY LEGAL PARAMETERS  S21046 02400002
*      IF ANYTHING ELSE IS PRESENT OR IF THESE ARE INVALID       S21046 02420002
*      DEFAULT TO 'PRINT' AND 'LINECNT=45' RESPECTIVLY AND ISSUE S21046 02440002
*      AN ERROR MESSAGE WITH A RETURN CODE OF 4, DO NOT          S21046 02460002
*      TERMINATE THE PROGRAM.                                    S21046 02480002
*                                                                S21046 02500002
PARAMFLD EQU   *                  CHECK PARAMETER FIELD          S21046 02520002
         LA    REG1,INCRMNT2(REG1) STEP UP PARM ADDRESS          S21046 02540002
CHCKLNGH CLC   OFFSET0(NAMLNGTH,REG1),COUNTFLD                   S21046 02560002
*                                 IS 'LINECNT=' PRESENT          S21046 02580002
         BE    COUNTFND           GO CHECK NUMBERS GIVEN         S21046 02600002
CHCKPRNT CLC   OFFSET0(PRINTLNG,REG1),PRINT                      S21046 02620002
*                                 IS 'PRINT' PRESENT             S21046 02640002
         BE    NEXTONE            GO SET PRINT LENGTH            S21046 02660002
CHCKNPRT CLC   OFFSET0(NPRNTLNG,REG1),NOPRINT                    S21046 02680002
*                                 IS 'NOPRINT' PRESENT           S21046 02700002
         BNE   PRINTERR           1ST PARAMETER INVALID          S21046 02720002
         NI    IEHESW2,BITOFF     TURN OFF THE PRINT BIT         S21046 02740002
         LA    REG4,NPRNTLNG      GET LENGTH OF 'NOPRINT'        S21046 02760002
CHCKNEXT SR    REG2,REG4          UPDATE LENGTH COUNT OF PARM    S21046 02780002
         BC    8,TST4LAST         IF COUNT IS NOW ZERO GO CHECK  S21046 02800002
*                                 ALTERNATE DD ENTRIES           S21046 02820002
         OI    IEHESW2,ONEGOOD    INDICATE ONE GOOD PARAMETER    S21046 02840002
         LA    REG1,OFFSET0(REG4,REG1)                           S21046 02860002
*                                 UPDATE POINTER TO DELIMITER    S21046 02880002
         CLI   OFFSET0(REG1),COMMA                               S21046 02900002
*                                 IS IT DELIMITED BY A COMMA     S21046 02920002
         BNE   PRINTERR           IF NOT PRINT MESSAGE           S21046 02940002
         BCTR  REG2,NULL          DECREMENT COUNT BY ONE         S21046 02960002
         LA    REG1,INCRMNT1(REG1)                               S21046 02980002
*                                 UPDATE PARAMETER ADDRESS       S21046 03000002
         B     CHCKLNGH           GO CHECK FOR 'LINECNT=XX'      S21046 03020002
*                                                                S21046 03040002
*         TURN ON THE PARM ERROR SWITCH                          S21046 03060002
*                                                                S21046 03080002
PRINTERR TM    IEHESW2,MSGPRINT   IS THE BIT ALREADY ON          S21046 03100002
         BC    1,TST4LAST         GO CHECK DD                    S21046 03120002
         OI    IEHESW2,MSGPRINT   TURN ON THE PRINT BIT          S21046 03140002
         TM    IEHESW2,ONEGOOD    IS THIS 2ND PARAMETER          S21046 03160002
         BC    1,TST4LAST         GO CHECK DD                    S21046 03180002
CHCKCOMA CLI   OFFSET0(REG1),COMMA IS A COMMA PRESENT            S21046 03200002
         BE    UPONE              SET UP TO CHECK NEXT PARM      S21046 03220002
         LA    REG1,INCRMNT1(REG1) UP ADDRESS BY ONE             S21046 03240002
         BCT   REG2,CHCKCOMA      DECREMENT COUNT                S21046 03260002
         B     TST4LAST           SECOND PARAMETER IS INVALID    S21046 03280002
*                                 BUT THE MESSGE BIT IS ON       S21046 03300002
UPONE    LA    REG1,INCRMNT1(REG1) POINT AT 1ST CHARACTER        S21046 03320002
         B     CHCKLNGH           REPEAT SCAN                    S21046 03340002
NEXTONE  LA    REG4,PRINTLNG      GET LENGTH OF 'PRINT'          S21046 03360002
         B     CHCKNEXT           GO CHECK NEXT PARAMETER        S21046 03380002
*                                                                S21046 03400002
*      'LINECNT=XX' IS PRESENT                                   S21046 03420002
*                                                                S21046 03440002
COUNTFND EQU   *                                                 S21046 03460002
         LA    REG1,NAMLNGTH(REG1) POINT TO LINECNT NUMBER       S21046 03480002
*                                                                S21046 03500002
*        CHECK TO BE SURE THESE ARE EBCDIC NUMERALS              S21046 03520002
*                                                                S21046 03540002
         CLI   OFFSET0(REG1),ZERO IS NUMBER LESS THAN ZERO       S21046 03560002
         BL    PRINTERR           INVALID ENTRY                  S21046 03580002
         CLI   INCRMNT1(REG1),ZERO IS 2ND NUMBER LESS THAN 0     S21046 03600002
         BL    PRINTERR           INVALID ENTRY                  S21046 03620002
         CLI   OFFSET0(REG1),NINE IS NUMBER GREATER THAN 9       S21046 03640002
         BH    PRINTERR           INVALID ENTRY                  S21046 03660002
         CLI   INCRMNT1(REG1),NINE IS NUMBER GREATER THAN 9      S21046 03680002
         BH    PRINTERR           INVALID ENTRY                  S21046 03700002
         LA    REG3,INCRMNT1      PREPARE FOR EXECUTE            S21046 03720002
         EX    REG3,PACK          PACK THE LINE COUNT            S21046 03740002
         CVB   REG4,DBLWORD                                      S21046 03760002
         STH   REG4,MAXLINES      MOVE NUMBER OF LINES           S21046 03780002
         LA    REG4,CNTLNGTH      TOTAL LENGTH OF LINE COUNT     S21046 03800002
         SR    REG2,REG4          DECREASE PARM COUNT            S21046 03820002
         BC    8,TST4LAST         IF ZERO GO CHECK DD ENTRIES    S21046 03840002
         BCTR  REG2,NULL          DECREMENT COUNT BY 1           S21046 03860002
         OI    IEHESW2,ONEGOOD    INDICATE ONE GOOD PARAMETER    S21046 03880002
         CLI   INCRMNT2(REG1),COMMA                              S21046 03900002
*                                 IS IT DELIMITED BY A COMMA     S21046 03920002
         BNE   PRINTERR           IF NOT GO PRINT ERROR MESSAGE  S21046 03940002
         LA    REG1,INCRMNT3(REG1) POINT AT FIRST CHARACTER      S21046 03960002
         B     CHCKPRNT           GO CHECK FOR 'PRINT','NOPRINT' S21046 03980002
PACK     PACK  DBLWORD(NAMLNGTH),OFFSET0(INCRMNT1,REG1)          S21046 04000002
*                                                                S21046 04020002
*    PICK UP ALTERNATE NAMES FOR SYSIN AND SYSPRINT ,IF GIVEN    S21046 04040002
*                                                                S21046 04060002
DD       EQU   *                                                        04080002
         MVC   DBLWORD(16),AA(REG1)     INSURING ALLIGNMENT             04100002
         LM    REG3,REG6,DBLWORD    REGS 3 - 6 GET SYSIN, SYSPRINT      04120002
         LA    REG7,AA                                                  04140002
         CR    REG2,REG7           LENGTH INCLUDE SYSIN  ?              04160002
         BNH   NODD                NO .... BRANCH                       04180002
         LTR   REG3,REG3           SYSIN PRESENT  ?                     04200002
         BZ    *+12                NO .... BRANCH                       04220002
         STM   REG3,REG4,UTINDCB+40                                     04240002
         OI    CTRLWORD,X'02'      INDICATE SYSIN  WAS PRESENT          04260002
         LA    REG7,AA+8                                                04280002
         CR    REG2,REG7           LENGTH INCLUDE SYSOUT ?              04300002
         BNH   NODD                NO .... BRANCH                       04320002
         LTR   REG5,REG5           SYSOUT PRESENT  ?                    04340002
         BZ    *+12                NO .... BRANCH                       04360002
         STM   REG5,REG6,UTOUTDCB+40                                    04380002
         OI    CTRLWORD,X'01'      INDICATE SYSPRINT WAS PRESENT        04400002
NODD     OI    CTRLWORD,X'04'      INFORM VOLMOUNT OF NEW DD LIST       04420002
         B     TST4LAST            GO LOOK FOR HEADER                   04440002
*                                                                S21046 04460002
*   PICK UP STARTING PAGE NUMBER IF GIVEN                        S21046 04480002
*                                                                S21046 04500002
HEADLINE EQU   *                                                        04520002
         MVC   PAGENUM(4),2(REG1)  PICK UP PAGE NUMBER                  04540002
         B     TST4LAST                                                 04560002
*                                                                S21046 04580002
*   INITIALIZE BLOCKSIZE ERROR FLAGS , OPEN IN AND OUT DCB'S     S21046 04600002
*  AND RETURN TO PROG1                                           S21046 04620002
*                                                                S21046 04640002
FLEE     EQU   *                  RETURN TO PROG1                       04660002
         MVC   DBLWORD(MOVE8),OPENLIST                                  04680002
         MVI   DFLG,X'00'               INITIALIZE BLKSIZE         BS0H 04700002
         MVI   DFLAG,X'00'              ERROR FLAGS                BS0H 04720002
         OPEN  (UTINDCB,(INPUT),UTOUTDCB,(OUTPUT)),MF=(E,DBLWORD)       04740002
         L     SAVEREG,SAVEREG2+4 RETRIEVE OLD SAVE AREA          M2838 04760002
         LM    14,12,12(13)             RESTORE THE REGISTERS           04780002
         L     15,DECB2+4               GET RETURN V TYPE ADCON         04800002
         BR    15                       BE GONE                         04820002
*                                                                  BS0H 04840002
*                   DCB  EXIT  ROUTINES                            BS0H 04860002
*                                                                  BS0H 04880002
DCBEXIT1 EQU   *                  CHECK LRECL AND BLKSIZE               04900002
         LH    REG5,UTINDCB+62          LOAD BLKSIZE               BS0H 04920002
         LTR   REG5,REG5                                           BS0H 04940002
         BC    8,BLKSZ                  IF NONE SPECIFIED --       BS0H 04960002
         SR    REG4,REG4                                           BS0H 04980002
         LA    REG3,80                  CHECK FOR MODULAR BLKSIZE  BS0H 05000002
         DR    REG4,REG3                                           BS0H 05020002
         LTR   REG4,REG4                                           BS0H 05040002
         BCR   8,RETURN           IF OK RETURN TO CALLER - OPEN    BS0H 05060002
         MVI   DFLAG,X'10'             IF NOT MODULAR - SET FLAG   BS0H 05080002
         MVC   UTINDCB+62(2),UTINDCB+82    MOVE LRECL TO BLKSIZE   BS0H 05100002
         RETURN                                                         05120002
BLKSZ    MVI   UTINDCB+63,X'50'         INSERT BLKSIZE -- 80       BS0H 05140002
         RETURN                                                         05160002
DCBEXIT2 EQU   *                  CHECK LRECL AND BLKSIZE               05180002
         LH    REG5,UTOUTDCB+62         LOAD BLKSIZE               BS0H 05200002
         LTR   REG5,REG5                                           BS0H 05220002
         BC    8,BLKSIZ                 IF NONE SPECIFIED --       BS0H 05240002
         SR    REG4,REG4                                           BS0H 05260002
         LA    REG3,121                                            BS0H 05280002
         DR    REG4,REG3                CHECK FOR MODULAR BLKSIZE  BS0H 05300002
         LTR   REG4,REG4                                           BS0H 05320002
         BCR   8,RETURN           IF OK RETURN TO CALLER - OPEN    BS0H 05340002
         MVI   DFLG,X'10'               IF NOT MODULAR - SET FLAG  BS0H 05360002
         MVC   UTOUTDCB+62(2),UTOUTDCB+82  MOVE LRECL TO BLKSIZE   BS0H 05380002
         RETURN                                                         05400002
BLKSIZ   MVI   UTOUTDCB+63,X'79'        INSERT BLKSIZE -- 121      BS0H 05420002
         RETURN                                                         05440002
OPENLIST OPEN  (,(INPUT),,(OUTPUT)),MF=L                                05460002
COUNTFLD DC    CL8'LINECNT='                                            05480002
PRINT    DC    CL5'PRINT'              SHOULD INPUT BE PRINTED   S21046 05500002
NOPRINT  DC    CL7'NOPRINT'       SUPPRESS PRINTING CONTROL CARD S21046 05520002
INEXIT   DC    X'85'                                               BS0H 05540002
         DC    AL3(DCBEXIT1)                                       BS0H 05560002
OUTEXIT  DC    X'85'                                               BS0H 05580002
         DC    AL3(DCBEXIT2)                                       BS0H 05600002
         EXTRN IEHPROGD           SYSIN END ROUTINE               M2838 05620002
         EXTRN IEHPROGE           SYNAD ROUTINE                   M2838 05640002
DCBSTART DS    0F            LABLE FIRST ITEM IN THE DCB                05660002
         DCB   DSORG=PS,MACRF=(GM),                                    .05680002
               DDNAME=SYSIN,RECFM=FB,                                  .05700002
               LRECL=80,EXLST=INEXIT,BUFNO=1,                      BS0H*05720002
               EODAD=IEHPROGD,SYNAD=IEHPROGE                      M2838 05740002
SPECIALS DC    C'.,=()   '                                              05760002
         DC    FL2'45'             MAXIMUM LINES PER PAGE      @YA02534 05780002
         DC    FL2'0'              LINE COUNT FIELD                     05800002
         DC    C'01'               SKIP TO ONE COMMAND IN ASA           05820002
         DC    CL30'SYSTEM SUPPORT UTILITIES ---- '                     05840002
         DC    CL30'IEHPROGM                      '                     05860002
         DC    CL30'                              '                     05880002
         DC    CL30'               PAGE 0001      '                     05900002
         DC    CL8'SYSIN'                                               05920002
         DC    CL8'SYSPRINT'                                            05940002
         DC    CL8'SYSUT1'                                              05960002
         DCB   DSORG=PS,MACRF=(PM),                                    .05980002
               DDNAME=SYSPRINT,RECFM=FBA,LRECL=121,EXLST=OUTEXIT,  BS0H*06000002
               EODAD=IEHPROGE,SYNAD=IEHPROGE,BUFNO=1              M2838 06020002
DCBSTOP  EQU   *-1                LABLE LAST ITEM IN THE DCB            06040002
DSECT    DSECT                                                          06060002
IEHECHAR DS    C         CHARACTER TO BE SCANNED FOR                    06080002
IEHECOND DS    C         CONDITION CODE TO STOP ON                      06100002
IEHECODE DS    C                                                        06120002
IEHEARGL DS    C                                                        06140002
IEHESTT  DS    F                                                        06160002
IEHESTP  DS    F                                                        06180002
IEHEFND  DS    F                                                        06200002
IEHETBL  DS    F                                                        06220002
IEHEFUN  DS    F                                                        06240002
IEHESCNX DS    3F                                                       06260002
IEHEMAC1 DS    7F                 PARAMETER LIST                 S21046 06280002
IEHEMAC2 DS    6F                                                       06300002
IEHESTIN DS    F                                                        06320002
IEHENDIN DS    F                                                        06340002
IEHECCNT DS    2C                                                       06360002
IEHESW1  DS    C                                                        06380002
DUPSW    DS    2C                 SWITCHES FOR TEST OF DUPLICATE S21046 06400002
*                                 PARAMETERS                     S21046 06420002
PPARAMSW DS    CL2                                                      06440002
IEHESW5  DS    C                                                        06460002
IEHESW6  DS    C                                                        06480002
IEHECALL DS    F                                                        06500002
         DS    0D                                                       06520002
DBLWORD  DS    F                                                        06540002
FULLWORD DS    F                                                        06560002
         DS    0D                                                       06580002
DECB1    DS    24X                                                      06600002
DECB2    DS    24X                                                      06620002
VOLISTAD DS    F                                                        06640002
MATRIXIU DS    F                                                        06660002
VDTIU    DS    F                                                        06680002
VOLPAREN DS    FL2                                                      06700002
VSRCM    DS    2X                                                       06720002
VDSA     DS    X                                                        06740002
DFLG     DS    X                                                   BS0H 06760002
DFLAG    DS    X                                                   BS0H 06780002
         DS    0F                                                       06800002
FLSTADDR DS    F                                                        06820002
FNSA     DS    12X                                                      06840002
KWSA     DS    12X                                                      06860002
SCANRET  DS    F                                                        06880002
MARESAR  DS    72X                                                      06900002
IEHESPC  DS    XL20                                                     06920002
         DS    XL20                                                     06940002
IEHERSAV DS    64X                                                      06960002
PASSUNIT DS    5X                                                  DT0I 06980002
MOUNTSW  DS    X                                                   DT0I 07000002
TABLEAD  DS    F                  ADDRESS OF DEVICE NAME TABLE     I276 07020002
IEHESW2  DS    X                  PROTECT SWITCHES               S21046 07040002
*                                 BIT 1=1 IF WE ARE TO PRINT     S21046 07060002
*                                        CONTROL CARDS           S21046 07080002
*                                 BIT 2=1 IF THE DCB'S ARE       S21046 07100002
*                                         OPENED DUE TO PARM     S21046 07120002
*                                 BIT 3=1 INDICATES FIRST QUOTE  S21046 07140002
*                                        IN SCAN FOR DATA        S21046 07160002
*                                        OPERATION IS FOUND      S21046 07180002
*                                 BIT 4= 1 IF WTOR SETUP IS DONE S21046 07200002
*                                 BIT 6=1 IF FIRST PARM ENTRY    S21046 07220002
*                                 WAS VALID                      S21046 07240002
*                                 BIT 7=1 IF INVALID PARM ENTRY  S21046 07260002
*                                 MSG HAS BEEN PRINTED           S21046 07280002
PASWDCT1 DS    1X                 NUMBER OF PROMPTS FOR PASWORD1 S21046 07300002
PASWDCT3 DS    1X                 NUMBER OF PROMPTS FOR CPASWORD S21046 07320002
TOTALPS  DS    1X                 TOTAL NO OF OPERATOR REPLIES   S21046 07340002
WTORECB  DS    1F                 EVENT CONTROL BLOCK FOR WTOR   S21046 07360002
TIOTADRS DS    1F                 TIOT ADDRESS FOR WTOR          S21046 07380002
CCNAME   DS    8C                 NAME OFF CONTROL CARD          S21046 07400002
WTORLIST WTOR  'IEH220A JOBNAMES, STEPNAME, CARDNAME, REPLY WITH PASSWOX07420002
               RD',,8,WTORECB,ROUTCDE=(9),DESC=2,MF=L            S21046 07440002
EXTRACTO EXTRACT ,'S',FIELDS=(TIOT),MF=L                         S21046 07460002
DCBAREA  DS    0F                                                       07480002
UTINDCB  DCB   DSORG=PS,MACRF=(GM)                                      07500002
CODELIST DC    C'.,=()   '        SPECIAL CHARACTERS CODED BY SCAN      07520002
MAXLINES DC    FL2'45'             MAXIMUM LINES PER PAGE               07540002
LINECNT  DC    FL2'0'              LINE COUNT FIELD                     07560002
SKIP21   DC    X'8B'               SKIP TO 1 COMMAND                    07580002
WRITEHDR DC    X'19'               SPACE 3 AFTER PRINT                  07600002
HEADER   DC    CL30'MODIFY....VERSION BETA-1......'                     07620002
         DC    CL30'LAST UPDATED....JULY 11  10 PM'                     07640002
         DC    CL30'                              '                     07660002
         DC    CL30'               PAGE 001       '                     07680002
PAGENUM  EQU   HEADER+110                                               07700002
DDNAMES  DS    3CL8                     FOR THREE DD NAMES              07720002
UTOUTDCB DCB   DSORG=PS,MACRF=(PM)                                      07740002
         DS    2F                                                       07760002
IEHESAT  DS    150X                                                     07780002
READBASE DC    F'0'                                                     07800002
ERRFLD   DS    0CL8               FOR POSTING OF ERROR CODES     S21046 07820002
PARAM1   DS    44X                                                      07840002
         DS    F              FOR  LENGTH OF  PARAM2                    07860002
PARAM2   DS    44X                                                      07880002
         DS    F                   FOR LENGTH OF PARAM3                 07900002
PARAM3   DS    44X                                                      07920002
PARAM5   DS    2F                 CPASWORD PARAMETER             S21046 07940002
PARAM6   DS    151F               VOL IDS PARAMETER              S21046 07960002
PARAM7   DS    2F                 PASSWORD2 PARAMETER            S21046 07980002
PARAM8   DS    80X                DATA PARAMETER                 S21046 08000002
DUMMY    DS    1F                 TEMPORARY STORAGE FIELD        S21046 08020002
PROTCTAD DS    1F                 ADDRESS OF WHERE TO PUT NEXT   S21046 08040002
*                                 VOL ID IN PARAM6 FOR PROTECT   S21046 08060002
FINUSE   DS    F                   ADDR OF DC LIST IN USE               08080002
DCSAVEAD DS    F                   SAVE AREA FOR ADDR OF DC LIST        08100002
INPUT    DS    40F                 TWO CARD INPUT AREA                  08120002
MSGOUT   DS    30F                 MSG OUTPUT AREA                      08140002
         DS    F                                                        08160002
         DS    0D                                                       08180002
PARAM4   DS    151F                FOR A VOLUME LIST                    08200002
EOCORE   EQU   *-12                                                     08220002
         ORG   PARAM4+20                                                08240002
VTOCDCB2 DS    0F                                                       08260002
DCB4VTOC DCB   DDNAME=VTOC,                                            .08280002
               DSORG=PS,                                               .08300002
               MACRF=R,                                                .08320002
               KEYLEN=44,                                              .08340002
               BLKSIZE=1,                                              .08360002
               RECFM=U,                                                .08380002
               EODAD=VTOCEND,                                          .08400002
               SYNAD=VTOCERR,                                          .08420002
               EXLST=VTOCEND                                            08440002
JFCB     DS    24D                                                      08460002
*        THE FOLLOWING ORG STATEMENT IF FLAGGED                  YM5077 08480002
         ORG                                                            08500002
SAVEREG2 DS    72X                SECONDARY SAVE AREA             M2838 08520002
SAVEREG3 DS    72X                THIRD LEVEL SAVE AREA           M2838 08540002
         ORG                                                            08560002
VTOCSW   EQU   JFCB+50                                                  08580002
VTOCDECB EQU   JFCB+60                                                  08600002
JFCBVOL  EQU   JFCB+118                                                 08620002
EXLST2   EQU   DCB4VTOC+36                                              08640002
FORMATID EQU   PARAM2+44                                                08660002
BLANK    EQU   64                                                       08680002
READTOO  EQU   INPUT+72                                                 08700002
COL16    EQU   READTOO+15                                               08720002
COL72    EQU   READTOO+71                                               08740002
MIDDLE   EQU   READTOO-1                                                08760002
WARE2PUT EQU   IEHEMAC1-4                                               08780002
CTRLWORD EQU   IEHESAT                                                  08800002
VTOCEND  EQU   *                                                        08820002
VTOCERR  EQU   *                                                        08840002
VTOCDCB  EQU   *                                                        08860002
         END                                                            08880002
./  ADD  SSI=70610328,NAME=IEHPROG5
* /* START OF SPECIFICATIONS ***                                      * 00010002
*01* PROCESSOR = ASSEM;                                               * 00012002
**** END OF SPECIFICATIONS ***/                                       * 00014002
   TITLE  'IEHPROGM - IEHPROG5  VOLUME MOUNTING INTERFACE'              00020002
**********************************************************************  00040002
*                                                                     * 00060002
* MODULE NAME -- IEHPROG5                                      YL026VC* 00070002
*                                                              YL026VC* 00072002
* DESCRIPTIVE NAME -- IEHPROGM VOLUME MOUNTING INTERFACE       YL026VC* 00074002
*                                                              YL026VC* 00076002
* COPYRIGHT -- NONE                                            YL026VC* 00078002
*                                                              YL026VC* 00078402
* STATUS -- 'IEHPROG5' OS/VS2 PROLOGUE MODIFICATION            YL026VC* 00080002
*    NOVEMBER 1972                                             YL026VC* 00100002
*                                                              YL026VC* 00110002
* FUNCTION -- THIS MODULE INTERFACES THE ROOT SEGMENT 'IEHPROG1'      * 00120002
*    WITH THE VOLUME MOUNTING ROUTINE 'IEHMVSSF'.  IT CREATES THE     * 00140002
*    DCB THAT IS USED TO READ THE VTOC WHEN APPLICABLE OR THE         * 00160002
*    DCB TO READ THE DIRECTORY OF A PDS WHEN 'SCRATCH' OR 'RENAME'    * 00180002
*    MEMBER HAS BEEN SPECIFIED.  THIS MODULE PASSES CONTROL TO THE    * 00200002
*    MODULE 'IEHPROG2'.  IF THE VOLUME MOUNTING ROUTINE HAS           * 00220002
*    ENCOUNTERED NO PROBLEMS CONTROL GOES TO ENTRY POINT IEHPROG2     * 00240002
*    OTHERWISE CONTROL GOES TO IEHPROG7.  IEHPROG7 BRANCHES           * 00260002
*    IMMEDIATELY TO THE POINT OF CALL IN 'IEHPROG1'.                  * 00280002
*                                                                     * 00300002
* ENTRY POINTS --                                                     * 00320002
*         IEHPROG5 IS THE ENTRY TO THIS MODULE FROM 'IEHPROG1'.       * 00340002
*         RETURNAD IS THE ENTRY POINT BACK FROM A BRANCH TO THE       * 00360002
*    MODULE 'IEHMVSSF'.                                               * 00380002
*                                                                     * 00400002
* INPUT -- INPUT TO 'IEHPROG5' CONSISTS OF A COMMON COMMUNICATIONS    * 00420002
*    AND WORK AREA POINTED TO BY REGISTER 12 AND DESCRIBED BY THE     * 00440002
*    DSECT NAMED DSECT.                                               * 00460002
*                                                                     * 00480002
* OUTPUT -- OUTPUT OF IEHPROG5 CONSISTS OF MODIFICATIONS TO THE       * 00500002
*    COMMUNICATIONS AREA THAT WAS INPUT TO THE MODULE.                * 00520002
*                                                                     * 00540002
* EXTERNAL REFERENCES --                                              * 00560002
*         IEHMVSSF IS CALLED TO MOUNT THE REQUIRED VOLUMES.           * 00580002
*         IEHPROG2 IS THE ENTRY REFERENCED IN 'IEHPROG2' IF THE       * 00600002
*    VOLUME MOUNTING ROUTINE HAS ENCOUNTERED NO PROBLEMS.             * 00620002
*         IEHPROG7 IS THE ENTRY REFERENCED IN 'IEHPROG2' IF THE       * 00640002
*    VOLUME MOUNTING ROUTINE ENCOUNTERED PROBLEMS.                    * 00660002
*                                                                     * 00680002
* EXITS, NORMAL -- 'IEHPROG5' BRANCHES TO 'IEHPROG2' VIA A BRANCH     * 00700002
*    ON REGISTER 15 WHCIH CONTAINS THE ADDRESS OF ENTRY IEHPROG2.     * 00720002
*                                                                     * 00740002
* EXITS, ERROR -- 'IEHPROG5' BRANCHES TO 'IEHPROG2' VIA A BRANCH      * 00760002
*    ON REGISTER 15 WHICH CONTAINS THE ADDRESS OF ENTRY IEHPROG7.     * 00780002
*                                                                     * 00800002
* TABLES/WORK AREA --                                                 * 00820002
*    DSECT IS THE COMMON COMMUNICATIONS AND WORK AREA POINTED         * 00840002
*    TO BY REGISTER 12.                                               * 00860002
*                                                                     * 00880002
* ATTRIBUTES -- THIS MODULE OPERATES AS ONE LEG OF AN OVERLAY         * 00900002
*    STRUCTURE.                                                       * 00920002
*                                                                     * 00940002
* CHARACTER CODE DEPENDENCY -- THIS MODULE MUST BE ASSEMBLED IN       * 00960002
*    EBCDIC AND RUN IN EBCDIC TO INSURE COLLATING SEQUENCE AND        * 00980002
*    INTERNAL REPRESENTATION OF CERTAIN CHARACTERS.                   * 01000002
*                                                                     * 01020002
* NOTES -- APPROXIMATELY 500 BYTES OF STORAGE ARE REQUIRED            * 01040002
*    FOR CODE.                                                        * 01060002
*                                                                     * 01080002
* CHANGE ACTIVITY -- FOLLOWS PROLOGUE                          YL026VC* 01090002
*                                                              YL026VC* 01092002
*********************************************************************** 01100002
IEHPROG5 CSECT                                                    M2838 01120002
*A50820                                                          YM5077 01140002
*C200,10800                                                       M2838 01160002
*                                                                  I276 01180002
*0052                                                              BS0H 01200002
*2349025000,025600,026700                                          DT0I 01220002
* 016700                                                         A23466 01240002
*A700-784,1100,10900-10920                                      YL026VC 01250002
*C800-1000                                                      YL026VC 01252002
*C 031600                                                      @ZA01241 01254002
*A029020-029160                         (ORG)@YA14026-@XA16033-@ZA13784 01254199
*C028600-029000                         (ORG)@YA14026-@XA16033-@ZA13784 01254299
*                   *****     REGISTER  USAGE     *****                 01260002
ZERO     EQU   0        ----------------------------------------        01280002
R1       EQU   12                                                       01300002
R2       EQU   2                                                        01320002
R3       EQU   3             REGISTERS ZERO THROUGH                     01340002
R4       EQU   4             TEN ARE WORK REGISTERS                     01360002
R5       EQU   5                                                        01380002
R6       EQU   6             REGESTERS ELEVEN AND                       01400002
R7       EQU   7             TWELVE ARE BASE REGISTERS                  01420002
R8       EQU   8             FOR THE PROGRAN AND THE                    01440002
R9       EQU   9             DUMMY SECTION RESPECTIVELY                 01460002
R10      EQU   10                                                       01480002
RB       EQU   11            THIRTEEN POINTS TO A REGISTER              01500002
RBD      EQU   12                                                       01520002
SAVEREG  EQU   13            SAVE AREA                                  01540002
RETURN   EQU   14                                                       01560002
LINKREG  EQU   15            FIFTEEN AND FOURTEEN ARE LINK              01580002
PARAMREG EQU   0             AND RETURN REGISTERS RESPECTIVELY          01600002
LISTREG  EQU   1        -----------------------------------------       01620002
AA       EQU   34                                                       01640002
ZEROOUT  EQU   254                                               A23466 01660002
*                                                                       01680002
         USING IEHECHAR,R1                                              01700002
         SAVE  (14,12)            SAVE REGISTERS                  M2838 01720002
         BALR  RB,0                ESTABLISH ADDRESSABILITY             01740002
         USING *,RB                                                     01760002
         ST    SAVEREG,SAVEREG2+4 KEEP OLD SAVE AREA              M2838 01780002
      GETMAIN  R,LV=176                GET CORE FOR VOLUME MOUNT        01800002
         LR    13,1                                                     01820002
         LA    RETURN,RETURNAD     ESTABLISH A POINT OF RETURN          01840002
         L     LINKREG,MOUNTRTN    GET ADDRESS OF THE MOUNT ROUTINE     01860002
         NI    MOUNTSW,ZEROOUT         RESET SWITCH TO ZERO      A23466 01880002
         TM    CTRLWORD,X'08'      FIRST ENTRY TO ROUTINE               01900002
         BO    DDOK                NO .... BRANCH                       01920002
         OI    CTRLWORD,X'08'      POST FIRST ENTRY                     01940002
         TM    CTRLWORD,X'04'      WERE DDNAMES PASSED TO THIS JOB      01960002
         BO    PICKUPDD            YES ... BRANCH                       01980002
         LA    R2,DDNAMES          SET ADDRESS OF DD NAMES              02000002
         ST    R2,DDNAMEAD         INTO THE TABLE                       02020002
         MVI   DDNUMBER,X'02'      SET NUMBER OF DD NAMES               02040002
         B     DDOK                                                     02060002
PICKUPDD L     R3,CTRLWORD         POINT AT ORIGINAL SAVE AREA          02080002
         L     R2,24(R3)           PICK UP REGISTER1                    02100002
         L     R2,4(R2)            PICK UP LIST OF DDNAMES              02120002
         LH    R3,0(R2)            PICK UP LENGTH OF DD FIELD           02140002
         CH    R3,EIGHTY           TEN OR LESS DDNAMES                  02160002
         BNH   TINYLIST            YES .... BRANCH                      02180002
INSERTDD TM    CTRLWORD,X'02'      WAS SYSIN PASSED IN LIST             02200002
         BO    *+10                YES .... BRANCH                      02220002
         MVC   AA(8,R2),DDNAMES    PUT SYSIN IN THE LIST                02240002
         TM    CTRLWORD,X'01'      WAS SYSOUT PASSED IN LIST            02260002
         BO    *+10                YES .... BRANCH                      02280002
         MVC   AA+8(8,R2),DDNAMES+8     &UT SYSOUT IN LIST              02300002
         LA    R2,2(R2)            POINT PAST COUNT FIELD               02320002
         ST    R2,DDNAMEAD         ADDRESS OF LIST TO TABLE             02340002
         SRL   R3,3                DEVIDE BY EIGHT...LENGTH OF NAME     02360002
         STC   R3,DDNUMBER         STORE COUNT OF DDNAMES               02380002
         B     DDOK                                                     02400002
TINYLIST EQU   *                                                        02420002
         XC    DDLIST(80),DDLIST   CLEAR LIST AREA                      02440002
         BCT   R3,*+10             DECREMENT LENGTH FIELD               02460002
         MVC   DDLIST(1),2(R2)     MOVE DDNAMES TO NORMAL LIST          02480002
         EX    R3,*-6              WITH THIS EXECUTE                    02500002
         LA    R2,DDLIST-2         RESET REG 2                          02520002
         LA    R3,80               SET COUNT FIELD FOR TEN              02540002
         B     INSERTDD                                                 02560002
EIGHTY   DC    FL2'80'                                                  02580002
DDOK     EQU   *                                                        02600002
         LA    LISTREG,DDNUMBER   POINT TO NUMBER OF DD NAMES           02620002
         MVI   MOUNTNUM,X'01'      REQUEST 1 VOLUME MOUNT               02640002
         TM    IEHEMAC1,X'01'      TEST FOR TYPE OF OPERATION           02660002
         BO    MNTAVOL             BRANCH IF SCRATCH OR RENAME          02680002
         TM    IEHEMAC1,X'80'     WAS A CONTROL VOLUME PASSED           02700002
         BZ    NORMAL   NO...........BRANCH                             02720002
         MVC   DEVTYPE1(10),PARAM3      SET CVOL INTO THE TABLE         02740002
         MVC   UNIT(5),PASSUNIT        MOVE IN SPECIFIC UNIT NAME  DT0I 02760002
*                                        IF SPECIFIED              DT0I 02780002
         MVI   REQUEST,X'80'       ASK FOR A MOUNT TO BE PERFORMED      02800002
         OI    MOUNTSW,X'01'           INDICATE CTLG SPECIFIED     DT0I 02820002
NOCTLG   BR    LINKREG                 GO TO VOLUME MOUNT RTN      DT0I 02840002
MNTAVOL  LA    R2,DEVTYPE1         ADDR OF VOL LIST DATA MGMT  @ZA13784 02860099
         LA    R3,PARAM4+2         ADDR OF VOL REQ LIST        @ZA13784 02880099
         LA    R4,UNIT             UNIT INFO IN VOL REQ LIST   @ZA13784 02900099
         LH    R5,PARAM4           NO OF ENTRIES AS LOOP COUNT @ZA13784 02902099
         STC   R5,MOUNTNUM         STORE NO INTO VOL REQ LIST  @ZA13784 02904099
MOVELOOP MVC   ZERO(10,R2),ZERO(R3) MOVE DEVTYPE, VOLSER AND   @ZA13784 02906099
         MVC   ZERO(5,R4),PASSUNIT UNIT TO VOL REQ LIST        @ZA13784 02908099
         LA    R2,17(R2)           NEXT ENTRY VOL REQ LIST     @ZA13784 02910099
         LA    R3,12(R3)           NXT ENT. VOL LST DATA MGMT  @ZA13784 02912099
         LA    R4,17(R4)           UNIT FIELD NEXT ENTRY       @ZA13784 02914099
         BCT   R5,MOVELOOP         BRANCH IF MORE ENTRIES      @ZA13784 02916099
         MVI   REQUEST,X'00'       ASK FOR NO MOUNTING                  02920002
         BR    LINKREG                                                  02940002
RETURNAD TM    REQUEST,X'02'       WAS THE VOLUME MOUNTED               02960002
         BO    NOMOUNT             NO BRANCH                            02980002
         L     R2,DECB2                 GET SDDRESS OF ADCONS           03000002
         MVC   DECB2+4(4),28(R2)        SWITCH RETURN TO THE SECOND     03020002
         L     R2,TABADDR          POINT TO TABLE                       03040002
         AH    R2,RTA1             ADD DISPLACEMENT                     03060002
         L     R2,0(R2)            POINT TO DDNAME IN TIOT              03080002
         MVC   UCBAD1(2),14(R2)    PICK UP ADDR OF UCB                  03100002
         TM    PPARAMSW,X'01'      TEST IF SCRATCH VTOC                 03120002
         BZ    *+16               NO .... BRANCH                        03140002
         MVC   VTOCDCB2(88),VTOCDCB       MOVE THE DCB         @ZA01241 03160002
         MVC   DCB4VTOC+40(8),0(R2)   PUT DD NAME IN DCB                03180002
NOMOUNT  L     1,TABADDR               GET ADDRESS OF CORE TO FREE      03200002
         LA    1,0(1)              CLEAR HIGH ORDER BYTE                03220002
         LH    0,0(1)              GET LENGTH TO BE FREED               03240002
         FREEMAIN  R,LV=(0),A=(1)  FREE CORE                            03260002
         DELETE EP=DEVMASKT             DELETE DEVICE MASK TABLE   I276 03280002
         B     FREECORE                                                 03300002
NORMAL   L     15,DECB2                NO MOUNTING NEEDED NOW           03320002
         MVC   DECB2+4(4),28(15)       SET RETURN ADDRESS TO UP1A       03340002
FREECORE LR    1,13                                                     03360002
         FREEMAIN  R,LV=176,A=(1)      RELEASE THE SAVE AREA            03380002
         L     SAVEREG,SAVEREG2+4 RESTORE OLD SAVE AREA           M2838 03400002
         LM    14,12,12(13)       RESTORE REGISTERS               M2838 03420002
         L     15,DECB2+4              GET V ADCON OF RETURN            03440002
         BR    15                      RETURN OR GO TO SECOND LOAD      03460002
VTOCDCB  DS    0F                 NAME THE FIRST ITEM IN DCB            03480002
         DCB   DSORG=PS,MACRF=R,KEYLEN=44,BLKSIZE=1,RECFM=U             03500002
MOUNTRTN DC    V(IEHMVESF)         ADCON OF VOLUME MOUNTING ROUTINE     03520002
DSECT    DSECT                                                          03540002
IEHECHAR DS    C         CHARACTER TO BE SCANNED FOR                    03560002
IEHECOND DS    C         CONDITION CODE TO STOP ON                      03580002
IEHECODE DS    C                                                        03600002
IEHEARGL DS    C                                                        03620002
IEHESTT  DS    F                                                        03640002
IEHESTP  DS    F                                                        03660002
IEHEFND  DS    F                                                        03680002
IEHETBL  DS    F                                                        03700002
IEHEFUN  DS    F                                                        03720002
IEHESCNX DS    3F                                                       03740002
IEHEMAC1 DS    7F                 PARAMETER LIST                 S21046 03760002
IEHEMAC2 DS    6F                                                       03780002
IEHESTIN DS    F                                                        03800002
IEHENDIN DS    F                                                        03820002
IEHECCNT DS    2C                                                       03840002
IEHESW1  DS    C                                                        03860002
DUPSW    DS    2C                 SWITCHES FOR TEST OF DUPLICATE S21046 03880002
*                                 PARAMETERS                     S21046 03900002
PPARAMSW DS    CL2                                                      03920002
IEHESW5  DS    C                                                        03940002
IEHESW6  DS    C                                                        03960002
IEHECALL DS    F                                                        03980002
         DS    0D                                                       04000002
DBLWORD  DS    F                                                        04020002
FULLWORD DS    F                                                        04040002
         DS    0D                                                       04060002
DECB1    DS    24X                                                      04080002
DECB2    DS    24X                                                      04100002
VOLISTAD DS    F                                                        04120002
MATRIXIU DS    F                                                        04140002
VDTIU    DS    F                                                        04160002
VOLPAREN DS    FL2                                                      04180002
VSRCM    DS    2X                                                       04200002
VDSA     DS    X                                                        04220002
DFLG     DS    X                                                   BS0H 04240002
DFLAG    DS    X                                                   BS0H 04260002
         DS    0F                                                       04280002
FLSTADDR DS    F                                                        04300002
FNSA     DS    12X                                                      04320002
KWSA     DS    12X                                                      04340002
SCANRET  DS    F                                                        04360002
MARESAR  DS    72X                                                      04380002
IEHESPC  DS    XL20                                                     04400002
         DS    XL20                                                     04420002
IEHERSAV DS    64X                                                      04440002
PASSUNIT DS    5X                                                  DT0I 04460002
MOUNTSW  DS    X                                                   DT0I 04480002
TABLEAD  DS    F                  ADDRESS OF DEVICE NAME TABLE     I276 04500002
IEHESW2  DS    X                  PROTECT SWITCHES               S21046 04520002
*                                 BIT 1=1 IF WE ARE TO PRINT     S21046 04540002
*                                        CONTROL CARDS           S21046 04560002
*                                 BIT 3=1 INDICATES FIRST QUOTE  S21046 04580002
*                                        IN SCAN FOR DATA        S21046 04600002
*                                        OPERATION IS FOUND      S21046 04620002
*                                 BIT 4= 1 IF WTOR SETUP IS DONE S21046 04640002
*                                 BIT 6=1 IF FIRST PARM ENTRY    S21046 04660002
*                                 WAS VALID                      S21046 04680002
*                                 BIT 7=1 IF INVALID PARM ENTRY  S21046 04700002
*                                 MSG HAS BEEN PRINTED           S21046 04720002
PASWDCT1 DS    1X                 NUMBER OF PROMPTS FOR PASWORD1 S21046 04740002
PASWDCT3 DS    1X                 NUMBER OF PROMPTS FOR CPASWORD S21046 04760002
TOTALPS  DS    1X                 TOTAL NO OF OPERATOR REPLIES   S21046 04780002
WTORECB  DS    1F                 EVENT CONTROL BLOCK FOR WTOR   S21046 04800002
TIOTADRS DS    1F                 TIOT ADDRESS FOR WTOR          S21046 04820002
CCNAME   DS    8C                 NAME OFF CONTROL CARD          S21046 04840002
WTORLIST WTOR  'IEH220A JOBNAMES, STEPNAME, CARDNAME, REPLY WITH PASSWOX04860002
               RD',,8,WTORECB,ROUTCDE=(9),DESC=2,MF=L            S21046 04880002
EXTRACTO EXTRACT ,'S',FIELDS=(TIOT),MF=L                         S21046 04900002
DCBAREA  DS    0F                                                       04920002
UTINDCB  DCB   DSORG=PS,MACRF=(GM)                                      04940002
CODELIST DC    C'.,=()   '        SPECIAL CHARACTERS CODED BY SCAN      04960002
MAXLINES DC    FL2'45'             MAXIMUM LINES PER PAGE               04980002
LINECNT  DC    FL2'0'              LINE COUNT FIELD                     05000002
SKIP21   DC    X'8B'               SKIP TO 1 COMMAND                    05020002
WRITEHDR DC    X'19'               SPACE 3 AFTER PRINT                  05040002
HEADER   DC    CL30'MODIFY....VERSION BETA-1......'                     05060002
         DC    CL30'LAST UPDATED....JULY 11  10 PM'                     05080002
         DC    CL30'                              '                     05100002
         DC    CL30'               PAGE 001       '                     05120002
PAGENUM  EQU   HEADER+110                                               05140002
DDNAMES  DS    3CL8                FOR THREE  8 BYTE DDNAMES            05160002
UTOUTDCB DCB   DSORG=PS,MACRF=(PM)                                      05180002
         DS    2F                                                       05200002
IEHESAT  DS    150X                                                     05220002
         ORG   IEHESAT                                                  05240002
CTRLWORD DS    F                   SWITCHES AND SAVE REG 13             05260002
DDNUMBER EQU   *                   NUMBER OF DDNAMES                    05280002
DDNAMEAD DS    F                   ADDRESS OF DDNAMES                   05300002
REQUEST  EQU   *                   REQUEST SWITCH                       05320002
TABADDR  DS    F                   ADDRESS OF TABLE BUILT               05340002
         DS    XL3                 BY THE VOLUME MOUNTING ROUTINE       05360002
MOUNTNUM DS    X                   NUMBER OF MOUNT REQUESTS             05380002
UCBAD1   EQU   *                   ADDRESS OF A UCB                     05400002
DEVTYPE1 DS    F                   DEVICE CODE                          05420002
VOLSER1  DS    CL6                 VOLUME SERIAL NUMBER                 05440002
RTA1     DS    XL2                 TABLE DISPLACEMENT TO DDNAME ADDR    05460002
UNIT     DS    XL5                                                 DT0I 05480002
DDLIST   DS    20F                 FOR TEN DDNAMES                      05500002
         ORG                                                            05520002
READBASE DC    F'0'                                                     05540002
PARAM1   DS    44X                                                      05560002
         DS    F              FOR  LENGTH OF  PARAM2                    05580002
PARAM2   DS    44X                                                      05600002
         DS    F                   FOR LENGTH OF PARAM3                 05620002
PARAM3   DS    44X                                                      05640002
PARAM5   DS    2F                 CPASWORD PARAMETER             S21046 05660002
PARAM6   DS    151F               VOL IDS PARAMETER              S21046 05680002
PARAM7   DS    2F                 PASSWORD2 PARAMETER            S21046 05700002
PARAM8   DS    80X                DATA PARAMETER                 S21046 05720002
DUMMY    DS    1F                 TEMPORARY STORAGE FIELD        S21046 05740002
PROTCTAD DS    1F                 ADDRESS OF WHERE TO PUT NEXT   S21046 05760002
*                                 VOL ID IN PARAM6 FOR PROTECT   S21046 05780002
FINUSE   DS    F                   ADDR OF DC LIST IN USE               05800002
DCSAVEAD DS    F                   SAVE AREA FOR ADDR OF DC LIST        05820002
INPUT    DS    40F                 TWO CARD INPUT AREA                  05840002
MSGOUT   DS    30F                 MSG OUTPUT AREA                      05860002
         DS    F                                                        05880002
         DS    0D                                                       05900002
PARAM4   DS    151F                FOR A VOLUME LIST                    05920002
EOCORE   EQU   *-12                                                     05940002
         ORG   PARAM4+20                                                05960002
VTOCDCB2 DS    0F                                                       05980002
DCB4VTOC DCB   DDNAME=VTOC,                                            .06000002
               DSORG=PS,                                               .06020002
               MACRF=R,                                                .06040002
               KEYLEN=44,                                              .06060002
               BLKSIZE=1,                                              .06080002
               RECFM=U                                                  06100002
JFCB     DS    24D                                                      06120002
*        THE FOLLOWING ORG STATEMENT IS FLAGGED                  YM5077 06140002
         ORG                                                            06160002
SAVEREG2 DS    72X                SECONDARY SAVE AREA             M2838 06180002
SAVEREG3 DS    72X                THIRD LEVEL SAVE AREA           M2838 06200002
         ORG                                                            06220002
VTOCSW   EQU   JFCB+50                                                  06240002
VTOCDECB EQU   JFCB+60                                                  06260002
JFCBVOL  EQU   JFCB+118                                                 06280002
EXLST2   EQU   DCB4VTOC+36                                              06300002
FORMATID EQU   PARAM2+44                                                06320002
BLANK    EQU   64                                                       06340002
READTOO  EQU   INPUT+72                                                 06360002
COL16    EQU   READTOO+15                                               06380002
COL72    EQU   READTOO+71                                               06400002
MIDDLE   EQU   READTOO-1                                                06420002
WARE2PUT EQU   IEHEMAC1-4                                               06440002
SYSINEND EQU   *                                                        06460002
         END                                                            06480002
